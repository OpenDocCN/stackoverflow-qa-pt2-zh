# StackOverflow 问答 16026000-16026999

# android - 如何实现 Spotify API

> ID：16026000
> 
> 赞同：0
> 
> 时间：2013-04-15T22:57:43.683
> 
> 标签：android, eclipse, api, sdk, spotify

我正在为 android 构建一个音乐应用程序。我已将 C 库与我的应用程序一起添加到 eclipse 中。该库是为 android 制作的，但它是用 C 编写的。我不确定如何将 C 代码转换为原生 Android 代码。如果有人可以帮助我将图书馆的代码输入到我的应用程序中，我们将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-15T13:01:15.903

我认为 Spotify 发布此 API 的主要目标是识别人才。最擅长表达兴趣和取得成果的人会引起他们的注意。

例如，对于 Android，您可以编译自己的 Android OS 构建，在 Android 和本机库之间创建 JNI 调用，并为 Spotify 提供音乐使用的展示场景以供考虑。如果他们喜欢他们看到/听到的东西，他们可能想以某种方式吸引你。

作为样本；我建议 Spotify 做的一件大事是允许最终用户贡献类似于维基百科的关于艺术家/歌曲的注释。那里的人们对 Spotify 上代表的各种音乐非常了解，并且可以贡献大量艺术家/歌曲信息，如果巧妙地编译这些信息，可能会成为 Spotify 及其供应商的一项了不起的资产。

一个问题是如何向这些贡献者提供激励，因为 Spotify 或歌曲背后的音乐公司很可能必须承担贡献信息的所有权。

关于如何开发使 Spotify 成为更丰富的服务的服务，有很多想法是可能的。

# android - 进行自定义动画时如何调整进度条中的可绘制项目（图像）的大小？

> ID：16026001
> 
> 赞同：0
> 
> 时间：2013-04-15T22:57:43.883
> 
> 标签：android, android-widget, android-listview, android-animation, android-progressbar

我有一个列表视图，其中包含一个图标、一个标题和一个副标题。

我的老板问我他想把那个图标改成动画。当他的意思是动画时，它只是显示三个图像继续，使它看起来像动画。

我已经通过在 res/anim 文件夹中编写一个 xml 来制作动画：

```
<?xml version="1.0" encoding="UTF-8"?>
<animation-list android:oneshot="false"
    xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:duration="150" android:drawable="@drawable/icon_anmi_1"/>
    <item android:duration="150" android:drawable="@drawable/icon_anmi_2" />
    <item android:duration="150" android:drawable="@drawable/icon_anmi_3" />
</animation-list> 
```

并通过在 value 文件夹中编写另一个进度条样式：

```
<?xml version="1.0" encoding="UTF-8"?>
<resources>
    <style name="animStyle" parent="@android:style/Widget.ProgressBar.Small">
        <item name="android:indeterminateDrawable">@anim/icon_anim</item>
    </style>
</resources> 
```

我使用进度条，因为图标应该自动启动动画。它确实如此。此外，在我的列表适配器的 xml 布局中：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
 android:layout_height="60dip"
 android:padding="10dip"
 >

<ProgressBar android:id="@+id/itemIcon" style="@style/animStyle"
        android:layout_width="60px" 
        android:layout_height="60px"
         android:layout_marginRight="10dip"
    android:layout_alignParentLeft="true" />
 <TextView
 android:id="@+id/itemInfo"
 android:layout_width="240dp"
 android:layout_height="wrap_content"
 android:layout_toRightOf="@+id/itemIcon"
 android:gravity="center_vertical"
 android:textSize="18sp"
 android:textStyle="bold"
 android:ellipsize="marquee" android:singleLine="true"/>
 <TextView
 android:id="@+id/subtitle"
 android:layout_width="240dp"
 android:layout_height="wrap_content"
 android:layout_toRightOf="@+id/itemIcon"
 android:gravity="center_vertical"
 android:textSize="10sp"
 android:ellipsize="marquee" android:singleLine="true" android:layout_below="@+id/itemInfo"/>
</RelativeLayout> 
```

在将适配器绑定到列表项时，我还对代码进行了更改：

```
adapterForList= new SimpleAdapter(this, hashMapListForListView, R.layout.s_item, new String[]{"imageUri","title","subtitle"},new int[]{R.id.itemIcon,R.id.itemInfo,R.id.subtitle});
        adapterForList.setViewBinder(new SimpleAdapter.ViewBinder() {
            public boolean setViewValue(View view, Object data,
                    String textRepresentation) {
                if (view.getId() == R.id.itemIcon) {
                    //Not need progress
                    //int value = Integer.parseInt(data.toString());
                    //((ProgressBar) view).setProgress(value);
                    return true;
                }
                return false;
            }
        });

        lv.setAdapter(adapterForList); 
```

动画效果很好。我现在面临的唯一问题是我为动画放置的图像无法调整为正确的大小。它只能显示它的一部分。我想知道是否有办法让我定义要显示的图像的大小，以便它可以像图像视图一样工作。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:51:04.213

这可以通过各种技术来解决，具体取决于目标平台。如果您的目标是 API 11 或更高版本，ViewFlipper 可以改为执行动画。

但是，当您尝试对动画使用 ProgressBar 解决方案时，我想您也针对的是旧版本的 Android。在这些情况下，可以通过恢复到 ImageView 并从计时器设置图像的可绘制来解决问题。

该技术在[https://stackoverflow.com/a/14991972/1950496](https://stackoverflow.com/a/14991972/1950496)中进行了描述，并且可以进行修改以适应 RemoteViews 问题。

# jquery - Twitter Bootstrap 手风琴背景项目符号

> ID：16026003
> 
> 赞同：0
> 
> 时间：2013-04-15T22:57:49.793
> 
> 标签：jquery, twitter-bootstrap

当 Twitter Bootstrap 的手风琴折叠和展开时，我想进行项目符号更改/交换。我为子弹使用了背景图像。

现在，在这个 jsfiddle [http://jsfiddle.net/fBd4a/10/](http://jsfiddle.net/fBd4a/10/)中，当页面加载时，应用的项目符号是'-'。但在项目展开和折叠后，它会保留“+”项目符号。我想从一开始就使用'+'项目符号。

谢谢。

```
@import url('http://twitter.github.com/bootstrap/assets/css/bootstrap.css');

.container {
    margin-top: 10px;
}
.accordion .accordion-group .accordion-heading a.accordion-toggle.collapsed {background: #e9e8e8 url(http://i.imgur.com/pdB4oDz.png) no-repeat 0 11px;} 
.accordion .accordion-group .accordion-heading a.accordion-toggle {background: #e9e8e8 url(http://i.imgur.com/9zfyr43.png) no-repeat 0 20px;}

<div class="accordion" id="accordion2">
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
        Collapsible Group Item #1
      </a>
    </div>
    <div id="collapseOne" class="accordion-body collapse">
      <div class="accordion-inner">
        Anim pariatur cliche...
      </div>
    </div>
  </div>
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
        Collapsible Group Item #2
      </a>
    </div>
    <div id="collapseTwo" class="accordion-body collapse">
      <div class="accordion-inner">
        Anim pariatur cliche...
      </div>
    </div>
  </div>
</div>
<script src="http://twitter.github.io/bootstrap/assets/js/bootstrap-collapse.js"></script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:16:41.663

如果您需要代码以加号开头，则将`collapsed`类添加到`a`具有`accordion-toggle`.

见[小提琴](http://jsfiddle.net/fBd4a/12/)

# android - 在 Android 4.0+ 上删除操作栏左侧图标周围的填充

> ID：16026007
> 
> 赞同：26
> 
> 时间：2013-04-15T22:58:11.333
> 
> 标签：android, android-layout, android-actionbar

我想删除标准 android 4.0+ 操作栏中左侧图标周围的填充。我正在设置图标：

```
getActionBar().setIcon(getResources().getDrawable(R.drawable.ic_action_myapp)); 
```

我希望图标垂直填充空间，触摸顶部和底部，类似于 soundcloud 应用程序的功能：

![](https://i.stack.imgur.com/inynO.png)

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-23T09:01:35.057

深入研究 AOSP 源代码，似乎涉及的代码位于[`com.android.internal.widget.ActionBarView.java`](https://github.com/android/platform_frameworks_base/blob/master/core/java/com/android/internal/widget/ActionBarView.java). 特别是相关部分是`onLayout()`内部类的方法`ActionBarView$HomeView`，部分报告如下（第 1433-1478 行）：

```
 @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        ...
        final LayoutParams iconLp = (LayoutParams) mIconView.getLayoutParams();
        final int iconHeight = mIconView.getMeasuredHeight();
        final int iconWidth = mIconView.getMeasuredWidth();
        final int hCenter = (r - l) / 2;
        final int iconTop = Math.max(iconLp.topMargin, vCenter - iconHeight / 2);
        final int iconBottom = iconTop + iconHeight;
        final int iconLeft;
        final int iconRight;
        int marginStart = iconLp.getMarginStart();
        final int delta = Math.max(marginStart, hCenter - iconWidth / 2);
        if (isLayoutRtl) {
            iconRight = width - upOffset - delta;
            iconLeft = iconRight - iconWidth;
        } else {
            iconLeft = upOffset + delta;
            iconRight = iconLeft + iconWidth;
        }
        mIconView.layout(iconLeft, iconTop, iconRight, iconBottom);
    } 
```

相同的小部件使用此布局，定义在[`res/layout/action_bar_home.xml`](https://github.com/android/platform_frameworks_base/blob/master/core/res/res/layout/action_bar_home.xml)：

```
<view xmlns:android="http://schemas.android.com/apk/res/android"
  class="com.android.internal.widget.ActionBarView$HomeView"
  android:layout_width="wrap_content"
  android:layout_height="match_parent">
<ImageView android:id="@android:id/up"
           android:src="?android:attr/homeAsUpIndicator"
           android:layout_gravity="center_vertical|start"
           android:visibility="gone"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_marginEnd="-8dip" />
<ImageView android:id="@android:id/home"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_marginEnd="8dip"
           android:layout_marginTop="@android:dimen/action_bar_icon_vertical_padding"
           android:layout_marginBottom="@android:dimen/action_bar_icon_vertical_padding"
           android:layout_gravity="center"
           android:adjustViewBounds="true"
           android:scaleType="fitCenter" />
</view> 
```

根据消息来源，图标显示在`Imageview`id=`android.R.id.home`中。上面报告的`onLayout()`方法考虑`ImageView`了布局中定义的边距，不能通过主题/样式覆盖设置，因为它们使用 value `@android:dimen/action_bar_icon_vertical_padding`。

您所能做的就是在运行时摆脱这些值，并根据您的需要设置它们：只需检索`ImageView`并将其顶部和底部边距设置为`0`. 像这样的东西：

```
ImageView icon = (ImageView) findViewById(android.R.id.home);
FrameLayout.LayoutParams iconLp = (FrameLayout.LayoutParams) icon.getLayoutParams();
iconLp.topMargin = iconLp.bottomMargin = 0;
icon.setLayoutParams( iconLp ); 
```

**编辑：我刚刚意识到我没有涵盖如何摆脱左填充。下面的解决方案。**

操作栏上的左填充受操作栏图标的*[向上导航行为的影响。](http://developer.android.com/guide/topics/ui/actionbar.html)*当它被禁用（通过`ActionBar.setDisplayHomeAsUpEnabled(false)`）时，左/上指示器消失了，但也使用了左填充。一个简单的解决方案：

1.  启用操作栏向上导航`ActionBar.setDisplayHomeAsUpEnabled(true)`，以便在布局过程中考虑指示器视图
2.  `res/values-v14/styles.xml`强制在您的to中用作向上指示器的可绘制对象`null`

例如：

```
<style name="AppBaseTheme" parent="android:Theme.Holo.Light.DarkActionBar">
    <!-- API 14 theme customizations can go here. -->
    <item name="android:homeAsUpIndicator">@null</item>
</style> 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-12-29T09:41:35.063

I found an other resolution (reference appcompat-v7 ) that change the toolbarStyle ,following code:

```
<item name="toolbarStyle">@style/Widget.Toolbar</item>

<style name="Widget.Toolbar" parent="@style/Widget.AppCompat.Toolbar">
    <item name="contentInsetStart">0dp</item>
</style> 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-23T09:41:51.150

为 ActionBar 使用自定义布局

![在此处输入图像描述](https://i.stack.imgur.com/IKCSk.png)

```
public class TestActivity extends Activity {

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        final ActionBar actionBar = getActionBar();
        actionBar.setCustomView(R.layout.actionbar_custom_view_home);
        actionBar.setDisplayShowTitleEnabled(false);
        actionBar.setDisplayShowCustomEnabled(true);
        actionBar.setDisplayUseLogoEnabled(false);
        actionBar.setDisplayShowHomeEnabled(false);

        setContentView(R.layout.main);

    }

    public void Click(View v) {
        if (v.getId() == R.id.imageIcon) {
            Log.e("click on-->  ", "Action icon");
        }
    }
} 
```

actionbar_custom_view_home.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/linearLayout1"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center" >

    <ImageView
        android:id="@+id/imageIcon"
        android:onClick="Click"
        android:layout_width="wrap_content"
        android:layout_height="match_parent"
        android:src="@drawable/ic_launcher" />

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Large Icon With Title"
        android:textAppearance="?android:attr/textAppearanceLarge" />

</LinearLayout> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-14T16:58:59.557

[在 Android 4.0+ 上删除操作栏左侧图标周围的填充时](https://stackoverflow.com/questions/16026007/remove-padding-around-action-bar-left-icon-on-android-4-0/25875412#25875412)增强**了 parrzhang**回复

```
 private void adjustHomeButtonLayout(){
        ImageView view = (ImageView)findViewById(android.R.id.home);
        if(view.getParent() instanceof ViewGroup){
            ViewGroup viewGroup = (ViewGroup)view.getParent();
            View upView = viewGroup.getChildAt(0);
            if(upView != null && upView.getLayoutParams() instanceof FrameLayout.LayoutParams){
                FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) upView.getLayoutParams();
                layoutParams.width = 20;// **can give your own width**
                upView.setLayoutParams(layoutParams);
            }
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-22T03:23:09.930

要设置 ActionBar 的高度，您可以像这样创建新主题：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>   
    <style name="Theme.BarSize" parent="Theme.Sherlock.Light.DarkActionBar">
        <item name="actionBarSize">48dip</item>
        <item name="android:actionBarSize">48dip</item> 
    </style> 
 </resources> 
```

并将此主题设置为您的活动：

android:theme="@style/Theme.BarSize"

现在，将图标的高度设置为`"match_parent"`。

这将删除顶部和底部填充。

现在，左侧的箭头已内置到框架中，因此您有两种解决方法：

1.  使用 ActionBarSherlock。它使用自己的 drwables 和资源，因此您可以将箭头图标修改为 emty png，以便您的向上图标移动到最左侧。

2.  上/后图标来自：

> ```
> public boolean onOptionsItemSelected(MenuItem item) 
>                {
>           switch (item.getItemId()) 
>                 {
>                 case android.R.id.home:
>                             NavUtils.navigateUpFromSameTask(this);
>               return true;
>                 }      
>                } 
> ```

因此，您可以创建另一个操作栏选项，而不是将此选项用于向上按钮，该选项具有上一个活动的意图，然后将该图标放在您的操作栏上。

不过，这将是一个更大的解决方法。

希望有帮助.. :)

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2014-09-16T17:52:22.860

您可以在 actionbarview 中找到 homeview 定义如下：

```
<view xmlns:android="http://schemas.android.com/apk/res/android"
  class="com.android.internal.widget.ActionBarView$HomeView"
  android:layout_width="wrap_content"
  android:layout_height="match_parent">
<ImageView android:id="@android:id/up"
           android:src="?android:attr/homeAsUpIndicator"
           android:layout_gravity="center_vertical|start"
           android:visibility="gone"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_marginEnd="-8dip" />
<ImageView android:id="@android:id/home"
           android:layout_width="wrap_content"
           android:layout_height="wrap_content"
           android:layout_marginEnd="8dip"
           android:layout_marginTop="@android:dimen/action_bar_icon_vertical_padding"
           android:layout_marginBottom="@android:dimen/action_bar_icon_vertical_padding"
           android:layout_gravity="center"
           android:adjustViewBounds="true"
           android:scaleType="fitCenter" /> 
```

但您无法通过`findViewById(android.R.id.up)`.

这样您就可以获取 homeView 并获取其父视图，将 upview 宽度设置为 0

```
 ImageView view = (ImageView)findViewById(android.R.id.home);
    if(view.getParent() instanceof ViewGroup){
        ViewGroup viewGroup = (ViewGroup)view.getParent();
        View upView = viewGroup.getChildAt(0);
        FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) upView.getLayoutParams();
        layoutParams.width = 0;
        upView.setLayoutParams(layoutParams);
    } 
```

# wordpress - 集成（wp）博客不扩展它的 100% 高度容器

> ID：16026008
> 
> 赞同：1
> 
> 时间：2013-04-15T22:58:16.593
> 
> 标签：wordpress, html, height, integration

**简介：** 我有一个简单地用 html 和 css 设计的页面，主要是 div 和 css 来塑造 div 框。

我只想将 wordpress 博客站点的博客文章集成到此页面中。除了包含“导入”帖子的一个（大）div 之外，设计中的所有内容都相同。我不希望这个 div 包含它自己的滚动条，就好像它是 wp 站点的窗口一样。我希望整个站点垂直扩展，由 wp 博客文章的高度决定，无论它们是什么。

我使用了这里提供的方法：http: [//moshublog.com/2005/07/05/integrate/2/](http://moshublog.com/2005/07/05/integrate/2/) 来合并博客，这已经奏效了。

**问题：** 包含此博客文章（“循环”）的 div 没有垂直扩展。它只是将博客文章切断，就好像它们没有被检测到一样。高度在包含它的 div 和任何 div 的父级上设置为 100%。

**问题：** 包含 wp 博客文章的 div 如何根据这些博客文章的高度垂直扩展？

**我试过的：** - - - 溢出：隐藏；我在页面上有浮动元素。我已经尝试了溢出的所有可能性：隐藏；，这是在我能找到的任何其他问题中提出的。这并没有改变什么。- - - 使 body 和 html height=100%。这并没有改变什么。- - - 将包含它的 div 和任何父 div 的高度更改为固定高度。这改变了高度。如果它更大，则可以看到更多的博客文章。帖子在那里，只是被切断了。

这是代码：

```
<!-- Main Body Start -->
<div class="clean" style="width:1200px; height:100%; border:0px; margin:0 auto;">

<!-- Body Column One Start -->
<div class="clean" style="width:950px; height:100%; float:left;">
    <!-- Blog Integration Start -->
    <div class="clean" style="width:946px; height:100%; max-width:946px; border-style:none solid; border-color:#99AAFF; 
    border-width:0px 2px; float:left; overflow:hidden; background-color:#ffff77;">

        <div class="clean" style="width:926px; height:100%; margin:0px 10px;">
    <!-- WP Blog code goes in here -->
            <?php if (have_posts()) : ?>
            <?php while (have_posts()) : the_post(); ?>
            <div class="post" id="post-<?php the_ID(); ?>">     
            <h2>
            <a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?php    
            the_title_attribute(); ?>">
            <?php the_title(); ?>
            </a>
            </h2>   
            <small>Posted in <?php the_category(', ') ?> on <?php the_time('F jS, Y') ?>  by <?php the_author() ?> &ndash; 
            <?php comments_popup_link('Be the first to comment', '1 Comment', '% Comments'); ?> 
            <?php edit_post_link('Edit', ' | ', ''); ?> </small>
            <div class="entry">
            <?php the_content('<span class="more">read more &raquo;</span>') ?>
            </div>
            <?php if(is_single()) {?><p class="postmetadata"><?php the_tags('Tags: ', ', ', '<br />'); ?></p><?php } ?>
            </div>
            <?php endwhile; ?>
            <div class="navigation">
            <div class="alignleft">
            <?php next_posts_link('&laquo; Older Entries') ?>
            </div>
            <div class="alignright">
            <?php previous_posts_link('Newer Entries &raquo;') ?></div>
            </div>
            <?php else : ?>                 
            <?php include (TEMPLATEPATH . "/searchform.php"); ?>
            <?php endif; ?>
        </div>

    </div> 
```

“wp blog code goes here”下面的所有内容到“?php endif;?” 来自 wp 博客网站，是“循环”。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:07:29.240

不要设置 div 的高度，这样做会将它们限制为您设置的高度，话虽如此，如果您将高度设置为 100%，则 div 将填充其容器区域的 100%，而不是 100 % 的内容，所以对于最外层的 div，这将是窗口的 100%。

# python - 使用 python Popen 和 pandoc 解析 html 的不需要的新行？

> ID：16026013
> 
> 赞同：1
> 
> 时间：2013-04-15T22:58:54.063
> 
> 标签：python, latex, html-parsing, popen, pandoc

我正在尝试使用 python 和 pandoc 将几段 html 转换为乳胶，但我遇到了几个问题。

为了将我的 python 脚本与我使用的 pandoc 通信`subprocess.Popen`，重定向`stdout`到我保存的文件，以便将其包含在乳胶模板中。

如果我使用经典的实现方式`Popen`

```
from subprocess import Popen, PIPE, STDOUT

filedesc = open('myfile.tex','w')
args = ['pandoc', '-f', 'html', '-t', 'latex']
p = Popen(args, stdout=PIPE, stdin=PIPE, stderr=STDOUT)
outp, err = p.communicate(input=html)
filedesc.write(outp) 
```

我得到了一个额外的新行，其中不应该有：

> > \textbf{M. John Harrison}（橄榄球，沃克威克郡，1945 年）是当代的
> 
> >
> 
> > 英文作家。

这（神秘？）很容易通过更改`stdout=PIPE`文件描述符来解决：

```
from subprocess import Popen, PIPE, STDOUT

filedesc = open('myfile.tex','w')
args = ['pandoc', '-f', 'html', '-t', 'latex']
p = Popen(args, stdout=filedesc, stdin=PIPE, stderr=STDOUT)
outp, err = p.communicate(input=html)
# not needed
# filedesc.write(outp) 
```

但是如果我想使用字符串缓冲区，就会出现同样的问题，因为我不能将它用作 stdout 参数。

关于如何阻止 Popen/pandoc 这样做的任何想法？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:58:37.537

好吧，这似乎是python PIPE（???）中的一种“错误”。

**我正在 Windows 系统中执行此代码。**这意味着当输入一个新行时，它们是 CR+LF (\r\n) 样式，而不是 (cleaner) LF (\n) unix 样式的新行。

当时我介绍了一个大的html文本要通过pandoc进行转换，输出通过管道返回到命令行。因此，每次达到标准列宽时，都会引入一个丑陋的“换行”字符。就我而言，是 CR+LF。这让我的输出看起来很奇怪。

我实施的肮脏解决方案是`replace('\r\n','\n')`在编写输出之前添加一个，但我不确定它是否是最优雅的。

```
from subprocess import Popen, PIPE, STDOUT

html = '<p><b>Some random html code</b> longer than 80 columns ... </p>'
filedesc = open('myfile.tex','w')
args = ['pandoc', '-f', 'html', '-t', 'latex']
p = Popen(args, stdout=PIPE, stdin=PIPE, stderr=STDOUT)
outp, err = p.communicate(input=html)
filedesc.write(outp.replace('\r\n','\n'))**strong text** 
```

# c++ - 我的计算函数没有返回任何东西？

> ID：16026014
> 
> 赞同：0
> 
> 时间：2013-04-15T22:58:59.443
> 
> 标签：c++

我的函数返回 0？

```
int ResizeLockRatio( int width, int height, int desired )
{
    int returnValue = ( height / width ) * desired;
    return returnValue; // returns 0?
}

int lockedRatioHeight = ResizeLockRatio( 1920, 1200, 1440 ); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T22:59:28.060

```
 int returnValue = ( height / width ) * desired; 
```

你正在做整数除法，有时会被截断为 0。

您正在传递`width = 1920, height = 1200`，因此`height/widht =1200/1920`在这种情况下，整数除法将截断为 0。

**编辑：**您可以尝试先进行乘法运算，然后根据“Caption Obvlious”进行除法运算：

```
int returnValue = ( height * desired ) /width ; 
```

# android - OpenGL ES 1.1 对象在屏幕刷新之前不显示（通过倾斜设备）

> ID：16026020
> 
> 赞同：0
> 
> 时间：2013-04-15T22:59:51.760
> 
> 标签：android, refresh, opengl-es-1.1

我有一些代码，这是其中的大部分：

```
class Cube {
    public Cube()
    {
    ...

        ByteBuffer vbb = ByteBuffer.allocateDirect(vertices.length * 4);
        vbb.order(ByteOrder.nativeOrder());
        mFVertexBuffer = vbb.asFloatBuffer();
        mFVertexBuffer.put(vertices);
        mFVertexBuffer.position(0);

        mColorBuffer = ByteBuffer.allocateDirect(colors.length);
        mColorBuffer.put(colors);
        mColorBuffer.position(0);

        mTfan1 = ByteBuffer.allocateDirect(tfan1.length);
        mTfan1.put(tfan1);
        mTfan1.position(0);

        mTfan2 = ByteBuffer.allocateDirect(tfan2.length);
        mTfan2.put(tfan2);
        mTfan2.position(0);
    }

    public void draw(GL10 gl)
    {
        gl.glVertexPointer(3,  GL11.GL_FLOAT, 0, mFVertexBuffer);
        gl.glColorPointer(4,  GL11.GL_UNSIGNED_BYTE, 0, mColorBuffer);

        gl.glDrawElements(GL10.GL_TRIANGLE_FAN, 6 * 3, GL10.GL_UNSIGNED_BYTE, mTfan1);
        gl.glDrawElements(GL10.GL_TRIANGLE_FAN, 6 * 3, GL10.GL_UNSIGNED_BYTE, mTfan2);
    }

    private FloatBuffer mFVertexBuffer;
    private ByteBuffer mColorBuffer;
    private ByteBuffer mTfan1;
    private ByteBuffer mTfan2;

} 
```

和渲染器：

```
public class CubeRenderer implements GLSurfaceView.Renderer 
{
    public CubeRenderer(boolean useTranslucentBackground)
    {
        mTranslucentBackground = useTranslucentBackground;
        mCube = new Cube();
    }

    public void onDrawFrame(GL10 gl)
    {
        gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
        gl.glClearColor(0.0f, 0.5f, 0.5f, 1.0f);

        gl.glMatrixMode(GL10.GL_MODELVIEW);
        gl.glLoadIdentity();
        gl.glTranslatef(0.0f,(float)Math.sin(mTransY), -7.0f);
        gl.glEnableClientState(GL10.GL_VERTEX_ARRAY);
        gl.glEnableClientState(GL10.GL_COLOR_ARRAY);

        mCube.draw(gl);

        mTransY += 0.075f;
    }

    @Override
    public void onSurfaceChanged(GL10 gl, int width, int height) 
    { 
        gl.glViewport(0,0,width,height);

        float aspectRatio;
        float zNear = 0.1f;
        float zFar = 1000;
        float fieldOfView = 30.0f/57.3f;
        float size;

        gl.glEnable(GL10.GL_NORMALIZE);

        aspectRatio = (float)width/(float)height;

        gl.glMatrixMode(GL10.GL_PROJECTION);

        size = zNear * (float)(Math.tan((double)(fieldOfView/2.0f)));

        gl.glFrustumf(-size, size, -size / aspectRatio, 
                                    size / aspectRatio, zNear, zFar);

        gl.glMatrixMode(GL10.GL_MODELVIEW);
    }

    @Override
    public void onSurfaceCreated(GL10 gl, EGLConfig config) 
    {
        gl.glDisable(GL10.GL_DITHER);

        gl.glHint(GL10.GL_PERSPECTIVE_CORRECTION_HINT, GL10.GL_FASTEST);

        if (mTranslucentBackground)
        {
            gl.glClearColor(0, 0, 0, 0);
        } else {
            gl.glClearColor(1, 1, 1, 1);
        }
        gl.glEnable(GL10.GL_CULL_FACE);
        gl.glShadeModel(GL10.GL_SMOOTH);
        gl.glEnable(GL10.GL_DEPTH_TEST);
    }

    private boolean mTranslucentBackground;
    private Cube mCube;
    private float mTransY;
} 
```

它不显示 3D 立方体对象，除非我通过将设备侧向倾斜以强制刷新来刷新屏幕，然后它工作正常，

所以我正在寻找一种简单的方法来刷新屏幕一次以及将初始刷新放在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T21:41:31.693

忘记使用

在 SurfaceChanged 函数中的 gl.glLoadIdentity()

```
// In OnSurfaceChanged put this:
aspectRatio = (float)width/(float)height;
gl.glMatrixMode(GL10.GL_PROJECTION);

gl.glLoadIdentity(); 
```

# java - Neo4j：Cypher 中的全文索引和自动索引

> ID：16026027
> 
> 赞同：1
> 
> 时间：2013-04-15T23:00:20.850
> 
> 标签：java, neo4j, cypher

我目前正在努力使用 Cypher 中的全文索引和自动索引。

我正在使用嵌入式 Java，Neo4j v 1.8.2。

我的基本问题是：如何使用 Cypher 查询全文索引？

当我创建以下索引时：

```
Index<Node> fulltextIndex = index.forNodes( "fulltextIndex",
            MapUtil.stringMap( IndexManager.PROVIDER, "lucene",
            "type", "fulltext" ) ); 
```

以下 Cypher 语句不返回任何内容：

```
START n=node:fulltextIndex(name='*er*') RETURN n; 
```

以下一段 java 代码虽然返回了所需的节点：

```
Node found = fulltextIndex.query("name", "*er*").getSingle();
id= found.getId();
String cypherQuery="START n=node("+id+") RETURN n"; 
```

那么实际上区别在哪里呢？为什么 Cypher 语句不起作用？

另外我想是否有任何方法可以将全文索引与自动索引结合起来？以下（见[http://docs.neo4j.org/chunked/milestone/auto-indexing.html](http://docs.neo4j.org/chunked/milestone/auto-indexing.html)）似乎不起作用：

```
Index<Node> fulltextIndex = index.forNodes("node_auto_index", "fulltextIndex",
            MapUtil.stringMap( IndexManager.PROVIDER, "lucene",
            "type", "fulltext" ) ); 
```

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T07:37:03.167

尝试以下 Cypher 语句，因为您的 Lucene 查询似乎是错误的：

```
START n=node:fulltextIndex("name:*er*") RETURN n; 
```

# visual-studio-2010 - 在 Visual Studio 2010 中逐步执行汇编语言函数

> ID：16026030
> 
> 赞同：0
> 
> 时间：2013-04-15T23:00:51.447
> 
> 标签：visual-studio-2010, masm

我正在尝试逐步执行 Visual Studio 2010 中的汇编函数，但每当调试器到达该`ret`语句时，就会显示一个带有文本“无可用源”的窗口，然后调试器简单地退出程序。当包含函数调用时，甚至可以在 Visual Studio 调试器中运行 x86 汇编语言程序吗？

```
.686p
.model flat,stdcall
.stack 2048
.data
ExitProcess proto, exitcode:dword
.code

start:

jumpIfEqual PROC var1:DWORD, var2:DWORD, jmpAddress:DWORD
    mov eax,var1
    cmp eax,var2
    jne skip
    pop eax
    push jmpAddress
    skip:
    ret ;this statement opens up a window in Visual Studio with the text "no source available", and then the program simply exits
jumpIfEqual ENDP

push OFFSET jumpIfEqual ;call the function
mov eax, 5 ;set the parameters for the function
push eax
push eax
call jumpIfEqual

invoke  ExitProcess, 0
end start 
```

# ios5 - MKAnnotationView 不显示自定义图钉

> ID：16026039
> 
> 赞同：0
> 
> 时间：2013-04-15T23:01:21.380
> 
> 标签：ios5, ios6, mapkit

我正在为地图实现自定义图钉，图像位于项目文件夹中但未显示。也许（而且很可能）我做错了什么。

地图显示并显示引脚（默认红色引脚），但不显示自定义图像或`UIButtonTypeDetailDisclosure`

这是我正在使用的代码：

```
- (MKAnnotationView *)mapView:(MKMapView *)theMapView viewForAnnotation:(id<MKAnnotation>)annotation
{

// in case it's the user location, we already have an annotation, so just return nil
if ([annotation isKindOfClass:[MKUserLocation class]])
{
    return nil;
}
 static NSString *TheAnnotationIdentifier = @"theAnnotationIdentifier";

MKAnnotationView *shoppeAnnotationView =
[self.mapView dequeueReusableAnnotationViewWithIdentifier:TheAnnotationIdentifier];
if (shoppeAnnotationView == nil)
{
    MKAnnotationView *annotationView = [[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:TheAnnotationIdentifier];

    annotationView.canShowCallout = YES;

    annotationView.image = [UIImage imageNamed:@"pin.png"];
    annotationView.rightCalloutAccessoryView = [ UIButton buttonWithType:UIButtonTypeDetailDisclosure ];
    annotationView.opaque = NO;

    return annotationView; 
}
    return nil;
} 
```

有什么提示吗？

谢谢！

# ruby - Ruby 中漂亮的文件大小？

> ID：16026048
> 
> 赞同：24
> 
> 时间：2013-04-15T23:02:35.127
> 
> 标签：ruby, integer, byte, filesize

我正在尝试制作一种方法，将表示字节的整数转换为具有“美化”格式的字符串。

这是我的一半工作尝试：

```
class Integer
  def to_filesize
    {
      'B'  => 1024,
      'KB' => 1024 * 1024,
      'MB' => 1024 * 1024 * 1024,
      'GB' => 1024 * 1024 * 1024 * 1024,
      'TB' => 1024 * 1024 * 1024 * 1024 * 1024
    }.each_pair { |e, s| return "#{s / self}#{e}" if self < s }
  end
end 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-01-31T00:34:04.107

如果您将它与 Rails 一起使用 - 标准 Rails 编号助手呢？

[http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html#method-i-number_to_human_size](http://api.rubyonrails.org/classes/ActionView/Helpers/NumberHelper.html#method-i-number_to_human_size)

`number_to_human_size(number, options = {})`

?

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-04-15T23:09:08.780

文件大小宝石怎么样？它似乎能够从字节（和其他格式）转换为漂亮的打印值：

例子：

```
Filesize.from("12502343 B").pretty      # => "11.92 MiB" 
```

[http://rubygems.org/gems/filesize](http://rubygems.org/gems/filesize)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-04-15T23:18:32.330

我同意@David 的观点，最好使用现有的解决方案，但要回答您关于您做错了什么的问题：

1.  主要错误是除以`s`而`self`不是相反。
2.  你真的想除以前一个`s`，所以除以`s`1024。
3.  进行整数运算会给您带来令人困惑的结果，因此请转换为浮点数。
4.  也许可以回答。

所以：

```
class Integer
  def to_filesize
    {
      'B'  => 1024,
      'KB' => 1024 * 1024,
      'MB' => 1024 * 1024 * 1024,
      'GB' => 1024 * 1024 * 1024 * 1024,
      'TB' => 1024 * 1024 * 1024 * 1024 * 1024
    }.each_pair { |e, s| return "#{(self.to_f / (s / 1024)).round(2)}#{e}" if self < s }
  end
end 
```

让你：

```
1.to_filesize
# => "1.0B"
1020.to_filesize
# => "1020.0B"
1024.to_filesize
# => "1.0KB"
1048576.to_filesize
# => "1.0MB"

```

同样，我不建议实际这样做，但似乎值得纠正错误。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-11-25T14:02:17.657

这是我的解决方案：

```
def filesize(size)
  units = %w[B KiB MiB GiB TiB Pib EiB ZiB]

  return '0.0 B' if size == 0
  exp = (Math.log(size) / Math.log(1024)).to_i
  exp += 1 if (size.to_f / 1024 ** exp >= 1024 - 0.05)
  exp = units.size - 1 if exp > units.size - 1

  '%.1f %s' % [size.to_f / 1024 ** exp, units[exp]]
end 
```

与其他解决方案相比，它更简单、更高效，并产生更合适的输出。

## 格式

所有其他方法都有报错的`1023.95 bytes`问题。此外`to_filesize`，只是用大数字出错（它返回一个数组）。

```
 -       method: [     filesize,     Filesize,  number_to_human,  to_filesize ]
 -          0 B: [        0.0 B,       0.00 B,          0 Bytes,         0.0B ]
 -          1 B: [        1.0 B,       1.00 B,           1 Byte,         1.0B ]
 -         10 B: [       10.0 B,      10.00 B,         10 Bytes,        10.0B ]
 -       1000 B: [     1000.0 B,    1000.00 B,       1000 Bytes,      1000.0B ]
 -        1 KiB: [      1.0 KiB,     1.00 KiB,             1 KB,        1.0KB ]
 -      1.5 KiB: [      1.5 KiB,     1.50 KiB,           1.5 KB,        1.5KB ]
 -       10 KiB: [     10.0 KiB,    10.00 KiB,            10 KB,       10.0KB ]
 -     1000 KiB: [   1000.0 KiB,  1000.00 KiB,          1000 KB,     1000.0KB ]
 -        1 MiB: [      1.0 MiB,     1.00 MiB,             1 MB,        1.0MB ]
 -        1 GiB: [      1.0 GiB,     1.00 GiB,             1 GB,        1.0GB ]
 -  1023.95 GiB: [      1.0 TiB,  1023.95 GiB,          1020 GB,    1023.95GB ]
 -        1 TiB: [      1.0 TiB,     1.00 TiB,             1 TB,        1.0TB ]
 -        1 EiB: [      1.0 EiB,     1.00 EiB,             1 EB,        ERROR ]
 -        1 ZiB: [      1.0 ZiB,     1.00 ZiB,          1020 EB,        ERROR ]
 -        1 YiB: [   1024.0 ZiB,  1024.00 ZiB,       1050000 EB,        ERROR ] 
```

## 表现

此外，它具有最佳性能（处理 100 万个数字的秒数）：

```
 - filesize:           2.15
 - Filesize:          15.53
 - number_to_human:  139.63
 - to_filesize:        2.41 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-11-17T19:37:49.930

这是一种使用方法`log10`：

```
def number_format(d)
   e = Math.log10(d).to_i / 3
   return '%.3f' % (d / 1000 ** e) + ['', ' k', ' M', ' G'][e]
end

s = number_format(9012345678.0)
puts s == '9.012 G' 
```

[https://ruby-doc.org/core/Math.html#method-c-log10](https://ruby-doc.org/core/Math.html#method-c-log10)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-05-22T20:53:49.033

您可以通过向 Integer 添加方法来获得积分，但这似乎更特定于文件，所以我建议使用 File 来玩弄，比如向 File 添加一个名为 .prettysize() 的方法。

但这是一个使用迭代的替代解决方案，并避免将单个字节打印为浮点数:-)

```
def format_mb(size)
  conv = [ 'b', 'kb', 'mb', 'gb', 'tb', 'pb', 'eb' ];
  scale = 1024;

  ndx=1
  if( size < 2*(scale**ndx)  ) then
    return "#{(size)} #{conv[ndx-1]}"
  end
  size=size.to_f
  [2,3,4,5,6,7].each do |ndx|
    if( size < 2*(scale**ndx)  ) then
      return "#{'%.3f' % (size/(scale**(ndx-1)))} #{conv[ndx-1]}"
    end
  end
  ndx=7
  return "#{'%.3f' % (size/(scale**(ndx-1)))} #{conv[ndx-1]}"
end 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-10-01T17:29:46.540

@Darshan Computing 的解决方案在这里只是部分的。由于不保证哈希键是有序的，这种方法不能可靠地工作。您可以通过在 to_filesize 方法中执行类似的操作来解决此问题，

```
 conv={
      1024=>'B',
      1024*1024=>'KB',
      ...
 }
 conv.keys.sort.each { |s|
     next if self >= s
     e=conv[s]
     return "#{(self.to_f / (s / 1024)).round(2)}#{e}" if self < s }
 } 
```

这就是我最终在 Float 中为类似方法所做的事情，

```
 class Float
   def to_human
     conv={
       1024=>'B',
       1024*1024=>'KB',
       1024*1024*1024=>'MB',
       1024*1024*1024*1024=>'GB',
       1024*1024*1024*1024*1024=>'TB',
       1024*1024*1024*1024*1024*1024=>'PB',
       1024*1024*1024*1024*1024*1024*1024=>'EB'
     }
     conv.keys.sort.each { |mult|
        next if self >= mult
        suffix=conv[mult]
        return "%.2f %s" % [ self / (mult / 1024), suffix ]
     }
   end
 end 
```

# c++ - 在 xcode 中将命令行工具转换为 .app

> ID：16026051
> 
> 赞同：0
> 
> 时间：2013-04-15T23:02:48.083
> 
> 标签：c++, c, xcode

所以我刚开始 c/c++ 编码，我正在制作一个带有 .c 和 .h 文件的命令行工具，可以将文本输出到屏幕上。我想知道是否有任何方法可以将其转换为用户可以下载和运行的可执行文件，而无需编译或从终端手动启动。否则，他们将不得不下载一个 .c 和一个 .h 文件，并在他们的终端中编译它。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:09:02.660

你不需要“转换”任何东西。可执行文件已经是 Xcode 项目构建结果的一部分。右键单击 Xcode 窗口中的可执行产品并选择“在 Finder 中显示”，它就在那里。

如果您的用户对命令行不满意，只需在 finder 中双击可执行文件即可启动终端并运行程序。

# c - C - exec() 位于另一个目录中的文件

> ID：16026052
> 
> 赞同：0
> 
> 时间：2013-04-15T23:03:09.967
> 
> 标签：c, linux, unix, exec

如何使用 exec() 函数之一执行位于另一个目录中的二进制文件（从 ac 源代码编译）？我正在使用 inotify API，并且我想执行位于另一个目录中的文件。这是作业：在创建文件时通知；如果此文件是可执行文件，则执行它。

这是代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/inotify.h>
#include <sys/wait.h>

#define EVENT_SIZE      (sizeof(struct inotify_event))
#define EVENT_BUF_LEN   (1024 * (EVENT_SIZE + 16))

int main(int argc, char *argv[]) {

int fd, wd, length = 0;
char buffer[EVENT_BUF_LEN];
struct stat sb;

if(argc != 2) {
    printf("Usage: ./spy dirpath\n");
    exit(EXIT_FAILURE);
}

if( (fd = inotify_init()) == -1 )
    perror("inotify_init()");
if( (wd = inotify_add_watch(fd, argv[1], IN_CREATE)) == -1 )
    perror("inotify_add_watch");
while(1) {  
    if( (length = read(fd, buffer, EVENT_BUF_LEN)) < 0 )
        perror("read()");
    struct inotify_event *event = (struct inotify_event *)&buffer;
    if(event->len) {
        if(event->mask & IN_CREATE) {
            if(event->mask & IN_ISDIR)
                continue;
            else {
                if(access(event->name, X_OK)) {
                    printf("New executable file created\n");                
                    pid_t child;
                        int cstatus;
                        child = fork();
                        if(child > 0) { /* father */
                wait(&cstatus);
                }
    else { /* child */
        chdir(argv[1]);
        /* This time, I try to tell it directly the filename*/
        char *args[2] = { "./helloworld" ,NULL };
        execvp(args[0], args);
        printf("execvp failed\n");
                    exit(EXIT_FAILURE);
    }

            }
        }
    }
}

inotify_rm_watch(fd, wd);
close(fd);

return(0);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:25:19.787

您的问题之一是：

```
 char *args[0]; args[1] = NULL; 
```

您正在践踏您的阵列范围。实际上，在标准 C 中，您根本不能拥有维度为 0 的数组。分配给（不存在的）`args[1]`损坏或覆盖指针`event`的可能性很大（尽管您可能期望核心转储而不仅仅是“execvp（）失败”消息）。你需要：

```
 char *args[2] = { event->name, NULL }; 
```

`exit()`失败后不要忘记这样`execvp()`做，否则最终会导致两个进程读取数据，这会变得非常混乱。您还应该报告“stderr”上的错误；它是报告错误的标准流。

# android - Android 应用程序中的 Google 地图崩溃

> ID：16026053
> 
> 赞同：0
> 
> 时间：2013-04-15T23:03:12.130
> 
> 标签：android, google-maps

在尝试将地图添加到 Android 应用程序时，我遇到了以下错误：

> 04-15 17:36:42.036: E/AndroidRuntime(28534): java.lang.RuntimeException: Unable to start activity ComponentInfo{xxx}: android.view.InflateException: Binary XML file line #7: Error inflating class fragment

我已经阅读了许多关于问题可能是什么的帖子和文章，并尝试了来自以下方面的任何建议：

*   [验证清单中的使用库](https://stackoverflow.com/a/4957117/27860)
*   添加 Google SDK（相对于 Android SDK）。
*   扩展 FragmentActivity（相对于 Activity）。
*   设置 API 密钥并将它们添加到清单中。

但是，没有什么能改变结果。尝试启动该活动时，该应用程序仍然崩溃，并显示相同的错误消息。

为了缩小范围，我从[这里](http://wptrafficanalyzer.in/blog/google-maps-in-android-application-with-new-google-maps-android-api-v2-using-supportmapfragment/)下载了示例应用程序，但它崩溃并显示完全相同的错误消息。

作为对 Android 来说相对较新的示例，上面的示例看起来不错，但是随着它的崩溃，很难判断错误在哪里。可以在[此处](https://gist.github.com/jwhitehorn/5391998)找到完整的堆栈跟踪。

我正在运行 Android 4.2 的 Nexus 4 上开发它。

我会假设引用的示例应用程序至少可以工作。我错了吗？我一直在参考的样本有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T02:24:35.480

看看我在 Android 虚拟设备（模拟器）Android 4.2 上使用 google android Map v2 的详细分步教程[http://umut.tekguc.info/en/content/google-android-map-v2-step-step](http://umut.tekguc.info/en/content/google-android-map-v2-step-step)

具体来说，确保`google-play-services_lib`可以解析对的引用。如果无法解决，应用程序将成功编译并启动，直到它实际需要显示地图。然后它会崩溃。

*   右键单击 Eclipse 中的项目，然后选择 Properties。
*   在左侧选择“Android”
*   确保`google-play-services_lib`在图书馆右侧的旁边有一个绿色复选标记。

如果它有一个红色的“X”或完全缺失，则需要重新添加该参考。

# java - 如何判断 cgywin 使用哪个 java 版本？

> ID：16026054
> 
> 赞同：1
> 
> 时间：2013-04-15T23:03:12.773
> 
> 标签：java, cygwin

我在window 7上安装了cgywin和java 7，还更新了系统环境变量以指向正确的java版本，但是当我在cgywin中运行命令时，我不确定它使用的是哪个java，这里是命令和结果：

```
$ java -version
java version "1.7.0_09"
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)
Java HotSpot(TM) Client VM (build 23.5-b02, mixed mode)

$ javac -version
javac 1.7.0_17

$ which java
/cygdrive/c/Windows/system32/java

export 
declare -x JAVA_HOME="C:\\Program Files\\Java\\jdk1.7.0_17" 
```

为什么所有版本都不一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:41:10.250

您的 PATH 有两个目录，它可以在其中找到`java`一个在 windows 下选择安装的版本（我想使用注册表），另一个在您的 JDK 中。您的 Windows 目录中没有`javac`，因此它会在您的 JDK 中找到 on。

为简单起见，除非您确实需要多个版本，否则我只会安装一个版本的 Java 7 JDK。我会改变你的路径，让它首先拥有你想要的 Java 版本，而不是接近尾声。

# lua - lua 在表中打印特定的键/值对

> ID：16026055
> 
> 赞同：6
> 
> 时间：2013-04-15T23:03:15.490
> 
> 标签：lua

我有一个外部 lua 表，其结构如下：

```
sgeT = {
  [2535047] = {
  {
      ["account"] = "TG-MCB110105",
      ["exec"] = "/share/home/00288/tg455591/NAMD_2.8b3/NAMD_2.8b3_Linux-x86_64-MVAPICH-Intel-Ranger/namd2",
      ["execEpoch"] = 1305825864,
      ["execModify"] = "Thu May 19 12:24:24 2011",
      ["execType"] = "user:binary",
      ["jobID"] = "2535047",
      ["numCores"] = "128",
      ["numNodes"] = "8",
      pkgT = {
      },
      ["runTime"] = "65125",
      ["sha1"] = "e157dd510a7be4d775d6ceb271373ea24e7f9559",
      sizeT = {
         ["bss"] = "104552",
         ["data"] = "192168",
         ["text"] = "10650813",
      },
      ["startEpoch"] = "1335843433",
      ["startTime"] = "Mon Apr 30 22:37:13 2012",
      ["user"] = "guo",
      },
  },
  [2535094] = {
  {
     ["account"] = "TG-MCB110105",
     ["exec"] = "/share/home/00288/tg455591/NAMD_2.8b3/NAMD_2.8b3_Linux-x86_64-MVAPICH-Intel-Ranger/namd2",
     ["execEpoch"] = 1305825864,
     ["execModify"] = "Thu May 19 12:24:24 2011",
     ["execType"] = "user:binary",
     ["jobID"] = "2535094",
     ["numCores"] = "128",
     ["numNodes"] = "8",
     pkgT = {
     },
     ["runTime"] = "81635",
     ["sha1"] = "e157dd510a7be4d775d6ceb271373ea24e7f9559",
     sizeT = {
        ["bss"] = "104552",
        ["data"] = "192168",
        ["text"] = "10650813",
     },
     ["startEpoch"] = "1335823028",
     ["startTime"] = "Mon Apr 30 16:57:08 2012",
     ["user"] = "guo",
     },
  }, 
```

我正在尝试使用以下 lua 脚本来打印 exec 键/值对，如下所示：

```
function DeepPrint (e)
   if type(e) == "table" then
       for k,v in pairs(e) do 
          if k == "exec" then
            print(k)
            DeepPrint(v)       
          end
       end
   else 
    print(e)
   end
 end

FileStr = "lariatData-sgeT-2012-05-01_2.lua"
Hnd, ErrStr = io.open(FileStr, "r")
if Hnd then
    dofile(FileStr)
    for Str in Hnd:lines() do       
        DeepPrint(sgeT)            
    end
Hnd.close()
else
    print(ErrStr, "\n")
end 
```

理想情况下，我想打印数字索引和执行值，例如：

```
2535047 execVal 
```

但是，当我运行代码时，什么都没有返回。最初数字索引没有括在方括号中，但我添加了它们以使文件能够被读取。但是，鉴于它们不是连续的，我不能像数组一样循环遍历它们，但我相信这些数字索引可能是我的问题的根源。我不确定我的代码有什么问题，但它什么也没返回。谁能推荐我如何修复代码，以便我可以获得适当的键和值来返回？提前致谢！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T03:47:32.463

由于您的表具有固定的结构，您可以简单地使用语法糖`sgeT[key1][key2]`来访问`exec`键。

```
for i, v in pairs( sgeT ) do
  print( i, v[1].exec )
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T04:58:57.990

您正在遍历文件中的行，但您已经处理并加载了该文件（作为 Lua 块），因此不再需要它。只需这样做：

```
dofile(FileStr)
DeepPrint(sgeT) 
```

主要问题是你只`DeepPrint`递归地调用那些具有 value`exec`的键，但第一级的键都没有（所以没有任何东西被打印，因为你没有超出第一级）。您可能需要`if`在调用之前关闭`DeepPrint`：

```
function DeepPrint (e)
   if type(e) == "table" then
       for k,v in pairs(e) do 
          if k == "exec" then
            print(k)
          end
          DeepPrint(v)       
       end
   else 
    print(e)
   end
 end 
```

# php - 计数器变量不递增

> ID：16026060
> 
> 赞同：0
> 
> 时间：2013-04-15T23:03:48.527
> 
> 标签：php

我有一个计数器变量，用于数组中项目的 id 或编号。那和要添加到数组中的内容在另一个数组中占据一个位置。因此，该另一个阵列是二维阵列。

基本上我正在做的是从一个数组中获取内容，最终将动态创建并添加到另一个数组中。然后将该阵列放入存储阵列中。对于我正在做的事情，我必须这样做。道歉。

我想知道为什么我的计数器变量只增加一次，因为当我 print_r 它的数组和我添加的内容是其中的一部分时，它等于 1。

当我运行这段代码时，我应该看到的结构是：

```
1, 1's content
2, 2's content
3, 3's content 
```

但我看到的是：

```
1, 1's content
1, 2's content
1, 3's content 
```

为什么不是我的计数器变量谁的值后来被赋予 $id 不递增，我怎样才能让它递增。从一个数组中获取，构建另一个数组，然后将其放入另一个数组，然后递归添加其余内容的结构几乎必须保留。我没有太多的自由来更改代码。我只是无法弄清楚为什么计数器变量没有增加。

这是代码：

```
$counter = 0;
$added_text = array();
$addMe = array("orange is the keyword of the day. Tomorrows is mop.", "I do not think you understnad how much I want it. I need it and it will happen.", "I love all sorts of music. Do I consider it a gift, I am not sure. That is all I know.");

function thing($contents, $addMe)
{
    $counter++;
    $text = strip_tags($contents);

    $id = $counter;
    $content = array(
        'id'      => $id,
        'content'     => $text
    );

    print_r($content);
    echo "<br /><br />";
    array_push($added_text, $content);

        foreach($addMe as $text){
            if(!in_array($added_text, $text)){
                sleep( 1 );
                thing($text, $addMe);
            }
        }
}

thing('hello i am the text 1 as in the text of the first document', $toAdd); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:08:25.743

您必须将 $counter 保持在范围内，每次调用 $counter 时都未初始化，“0”也是如此，然后您调用 counter++，将其设置为 1。

```
function thing($contents, $addMe, $counter=0)
{
 $counter++;

...

foreach($addMe as $text){
        if(!in_array($added_text, $text)){
            sleep( 1 );
            thing($text, $addMe, $counter);
        }
    } 
```

# c# - 多租户应用程序允许一个用户访问多个租户帐户？

> ID：16026067
> 
> 赞同：7
> 
> 时间：2013-04-15T23:04:12.283
> 
> 标签：c#, ajax, asp.net-mvc, multi-tenant, jsonresult

我正在编写一个多租户应用程序，每个租户模型使用一个数据库。我已允许每个用户帐户访问多个租户（只要该租户授予他们访问权限）

发送到浏览器的每个页面都包含 Site.Master 中的当前 TenantId

```
<%= Html.Hidden("TenantId") %> 
```

但是，当浏览器发出任何请求（提交按钮、AJAX GET 或 AJAX POST）时，实际上不会检查此 TenantId 是否与用户当前的 TenantId 匹配。

现在，如果用户打开一个 TenantId = 1 的选项卡，然后连接到另一个 TenantId = 2 的选项卡中的另一个租户，然后切换回第一个选项卡，它就可以访问来自租户 2 的数据。

我能做些什么来解决这个问题？我有大量现有的 ActionResult 和 JsonResult 方法，我不想遍历它们中的每一个并添加

```
if (request.TenantId != user.CurrentTenantId) return false 
```

因为那将是大量的重复工作

我可以更改我的基本控制器以始终读取 TenantId 的值吗？这可能适用于提交的请求（ActionResult），但是 AJAX 请求呢？

如何在不更改每个现有 AJAX 方法（有很多）的情况下检查 JsonResult 操作中页面的 TenantId？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:42:41.997

您可以检查 Global.asax.cs 文件中的 Application_Request 事件。如果您需要通过 MVC 模型绑定填充，那么可以编写一个自定义 ActionFilter 来检查它并通过 GlobalFilter 将其注册到所有操作中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-23T20:30:10.500

如果我理解正确，用户可以同时打开 2 个不同的选项卡，每个选项卡都有不同的租户。每个页面都应该显示与每个租户相关的数据。

因此，这意味着需要丢弃涉及 cookie 或会话的解决方案，因为租户特定于每个浏览器选项卡。

并阅读您对 Cyril Gupta 建议的回答，我了解每个页面上隐藏的tenantId 可能不会在每个 AJAX 请求上提交。当然，一种解决方案可能是修改您的应用程序并确保每个 AJAX 请求始终如此。否则，这也会丢弃基于请求参数的全局过滤器，因为可能并不总是存在租户 ID。

我认为最好的选择是在包含tenantId的URL中添加一个段。例如，将默认路由替换为以下路由（如果您有许多不同的路由，则需要非常小心以避免路由冲突）：

```
routes.MapRoute(
            name: "Default",
            url: "{tenant}/{controller}/{action}/{id}",
            defaults: new { tenant = "defaultTenant", controller = "Home", action = "Index", id = UrlParameter.Optional }
        ); 
```

通过这种方式，您可以确保在每个请求中始终提交租户，并且您还可以有 2 个不同的选项卡，其中不同的租户显示每个相应的数据。

关于如何恢复路线段的价值有不同的选择。

绑定将自动填充操作方法上任何名为“租户”的参数的值，或作为操作方法参数的模型类中的任何名为“租户”的参数： public ActionResult Foo(FooModel model, string tenant) { //tenant 和 model.tenant 都将包含 URL 段的值 return View(); }

您还可以编写一个过滤器来访问路由参数的值（RouteData 是作为过滤器方法的参数接收的`ActionExecutingContext`和`ActionExecutedContext`类的属性），并执行一些逻辑。然后过滤器将在您的应用程序或您的基本控制器中设置为全局过滤器：

```
public class FooFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        var tenant = filterContext.RouteData.Values["tenant"]
        //do whatever you need to do before executing the action, based on the tenant 
    }

    public override void OnActionExecuted(ActionExecutedContext filterContext)
    {
        var tenant = filterContext.RouteData.Values["tenant"]
        //do whatever you need to do after executing the action, based on the tenant
    }
} 
```

最后一个选项是直接访问基础控制器类上的 RouteData 参数。（因为 RouteData 是基础 MVC`Controller`类的属性）

只要您使用 Html 和 Ajax 帮助器生成 URL，URL 的租户段就会保留在您的链接中。但是，如果您有 jquery 代码直接发送带有硬编码 URL 的 AJAX 调用，那么您需要更新该代码以便考虑新的 url 段。

最后，如果tenantId 值不是非常用户友好的值（例如整数），您可以为每个租户设置唯一名称并使用URL 中的名称。然后，您将添加一些逻辑，将其映射到您的应用程序需要的整数值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T13:37:25.707

您可以编写自己的过滤器：

[如何在 ASP.NET MVC 2 中的每个控制器操作之前执行某些代码？](https://stackoverflow.com/questions/2650269/how-do-i-get-certain-code-to-execute-before-every-single-controller-action-in-as) [在任何操作之前执行代码](https://stackoverflow.com/questions/8709174/executing-code-before-any-action)

当然，您的问题没有现成的答案。您需要编写自己的逻辑，如何处理tenantId。例如，在每个操作上，检查它是否不等于当前会话租户 ID 进行重定向。或者把它放在 cookie 中，每次在过滤器中检查 id 是否相等。由你决定。从我的角度来看，cookie 更可取。但它吃交通。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-16T01:35:53.193

您可以在控制器级别应用过滤器并检查正在发送的租户 ID。控制器级别的过滤器不应该比操作过滤器更难。对于我的项目，我需要以类似的方式检查授权，但我覆盖了控制器类，然后从我自己的控制器类继承，因为我有一些非常特殊的需求。

您打算在客户端将租户 ID 存储在哪里？在我看来，您应该使用会话对象来执行此操作。

# database - Spring MVC - 显示数据库中的 Blob 图像

> ID：16026070
> 
> 赞同：1
> 
> 时间：2013-04-15T23:04:22.697
> 
> 标签：database, image, jsp, blob, apache-commons

首先，我是 Spring MVC 的新手，如果这似乎是一个重复的问题，我真的很抱歉，但是我正在努力寻找关于如何在 JSP 页面上显示图像的分解指南/教程。我读过的大多数回复只是给你一些小片段，这让我更加困惑。

我有一个 MySQL 数据库，它有一个完整的表，其中包含存储为 blob 的图像。我有一个服务，它从数据库中检索 blob 图像并填充**CommonsMultipartFile**数组。我还有一个控制器，它将数组传递给 JSP 页面，在该页面中循环迭代我试图显示的每个图像。

**控制器**

```
@RequestMapping(value = { "/my/images" }, method = RequestMethod.GET)
public String getAllImages(HttpServletRequest request, HttpServletResponse response, ModelMap model) {

    final List<CommonsMultipartFile> images = new ArrayList<CommonsMultipartFile>();

    myService.getAllImages(images);
    model.addAttribute("myImages", images );

    return getUrl(request);

} 
```

**JSP**

```
<c:forEach items="${myImages}" var="image">
    <img src="${image}">        
</c:forEach> 
```

这是我得到的。图像不显示。请问有人可以帮忙吗？

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T06:37:55.267

最好的办法是将这些二进制文件保存到硬盘（使用 pk 作为文件名）并直接将它们提供给浏览器。

您也可以编写一个 Servlet，但编写异步 Servlet 非常困难。

# php - reddit 发布链接的图片消失了

> ID：16026071
> 
> 赞同：-2
> 
> 时间：2013-04-15T23:04:24.993
> 
> 标签：php, html, hyperlink, image, reddit

当我在 Reddit 上提交链接时，它的图片（左侧的那个）会在一段时间后消失，并且图片会变成带有相机和问号的 reddit 徽标。任何人都知道如何解决这个问题？你可以在这里找到例子： [http ://www.reddit.com/user/MemeAvenue/](http://www.reddit.com/user/MemeAvenue/)

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:23:21.350

该用户帐户被屏蔽，这可能解释了该帐户发布的提交的缩略图消失的原因。帐户被屏蔽的典型​​原因是垃圾邮件。

总的来说，我相信这个问题对于 SO 来说是题外话。

# r - 从 aov() 中提取残差

> ID：16026072
> 
> 赞同：2
> 
> 时间：2013-04-15T23:04:35.227
> 
> 标签：r

我使用以下代码运行了方差分析：

```
aov2 <- aov(amt.eaten ~ salt + Error(bird / salt),data) 
```

如果我使用`view(aov2)`，我可以看到 aov2 结构中的残差，但我想以不涉及剪切和粘贴的方式提取它们。有人可以帮我解决语法吗？

`residuals(aov2)`我一直在使用的各种版本只生产`NULL`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-25T22:47:52.750

我刚刚了解到您可以使用[proj](https://stackoverflow.com/questions/26169153/how-to-get-residuals-from-repeated-measures-anova-model-in-r)：

```
x1 <- gl(8, 4)             
block <- gl(2, 16)    
y <- as.numeric(x1) + rnorm(length(x1))        
d <- data.frame(block, x1, y)       

m <- aov(y ~ x1 + Error(block), d)         
m.pr <- proj(m)          
m.pr[['Within']][,'Residuals'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:12:33.470

您无法从该模型中提取残差的原因是您指定了由于鸟盐比 (???) 而产生的随机效应。在这里，鸟和盐的每个独特组合都被视为具有唯一截距值的随机簇，但具有与盐的单位差异和食用量相关的共同加性效应。

我无法理解为什么我们要在这个模型中指定这个值作为随机效应。但为了明智地分析残差，您可能需要根据拟合模型和最佳截距计算每个层中的拟合差异。然而，我认为这是一项乏味的工作，而且信息量不大。

# c - 使用 C 编程交换字符串中的两个单词

> ID：16026076
> 
> 赞同：0
> 
> 时间：2013-04-15T23:04:55.093
> 
> 标签：c, string

我即将完成编写一个程序来交换输入到程序中的两个单词。如果我输入“Billy Bob”，则输出将是“@\300_\377” 有点奇怪……我相信我的 scanf 有问题，但不太确定。这是我到目前为止所拥有的..

```
{ int i,j,l;
char str[59];
printf("Enter the string\n");
scanf("%s", &str[59]);
l=strlen(str);
for(i=l-1; i>=0; i--)
{ if(str[i]==' ')
{ for(j=i+1; j<l; j++)
    printf("%c",str[j]);
    printf(" ");
    l=i;
    }
    if(i==0) 
    { printf(" "); 
        for(j=0; j<l; j++) 
            printf("%c",str[j]); 
    } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T23:06:56.250

```
scanf("%s", &str[59]); 
```

将输入写入分配空间的末尾。使用第一个元素的地址：

```
scanf("%s", str); 
```

但这会给你第一个词，所以要么这样做：

```
scanf("%s %s", str1, str2); // str1, str2 are arrays 
```

或使用 fgets：

```
fgets(str, 59, stdin); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-15T18:04:59.743

而不是使用`scanf("%s", &str[59]);`，你可以使用`gets(str);`。

它工作得很好......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:12:09.633

这种编写函数的方式有点难以阅读。我不确定您在什么情况下编写它，但另一种解决方案是用一个标记（在这种情况下是一个空格）分割输入字符串，然后以相反的顺序打印出两个字符串。`strtok()`可以在[此处](http://www.cplusplus.com/reference/cstring/strtok/)找到该函数的示例。

像这样的东西：

```
char str[] ="billy bob";
char * firstToken;
char * secondToken
firstToken = strtok(str, " ");
secondToken = strtok(NULL, " ");
printf("%s %s", secondToken, firstToken); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T23:06:18.653

这是错误的：

```
 scanf("%s", &str[59]);  
 //^not reading the str, str[59] is even out of bound 
```

应该：

```
scanf("%s", str); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-15T23:06:28.440

您将第一个地址传递`str`给scanf。更改`&str[59]`为`str`。

# java - 使用 300dpi 在 Java 中打印到硬打印机

> ID：16026077
> 
> 赞同：1
> 
> 时间：2013-04-15T23:05:00.567
> 
> 标签：java, graphics, printing, hardware

好的，所以我刚刚开始研究一个可以打印出其图形的程序。我的几乎与位于此处 [http://docs.oracle.com/javase/tutorial/2d/printing/examples/HelloWorldPrinter.java的 Oracle 的版权相同](http://docs.oracle.com/javase/tutorial/2d/printing/examples/HelloWorldPrinter.java)

* * *

所以基本上我是一个完整的菜鸟，并试图弄清楚如何将我的页面设置为 8.5x11in 和 300dpi 但无济于事:( 在我所有失败的尝试之后，我什至没有关于这个主题的工作代码。我知道它有一些东西与`Paper.setSize()`and`PrinterResolution`但我无法从 javadocs 中收集到足够的信息来理解这些。请帮助。

编辑：我相信我发现`Paper.setSize(72*8.5,72*11);`将页面大小设置为 8.5x11 但 dpi 仍然是 72。这是我到目前为止的代码。

```
public int print(Graphics g, PageFormat pf, int page) throws
                                PrinterException {
        Graphics2D g2d = (Graphics2D)g;
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING,
                        RenderingHints.VALUE_ANTIALIAS_ON);
         Paper pg = new Paper();
        pg.setSize(72*8.5,72*11);
        pf.setPaper(pg);
        if (page > 0) { /* We have only one page, and 'page' is zero-based */
            return NO_SUCH_PAGE;
        }

     /* User (0,0) is typically outside the imageable area, so we must
     * translate by the X and Y values in the PageFormat to avoid clipping
     */
    //Graphics2D g2d = (Graphics2D)g;
    g2d.translate(pf.getImageableX(), pf.getImageableY());

    /* Now we perform our rendering */
    g.drawString("Hello world! :D", 100, 100);

    /* tell the caller that this page is part of the printed document */
    return PAGE_EXISTS;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T23:20:21.470

您需要使用打印服务 API。这允许您请求 a 的某些属性`PrintJob`，包括 DPI。

这是一个**RELLAY**的基本示例...

```
PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();
aset.add(MediaSizeName.ISO_A4);
aset.add(new PrinterResolution(300, 300, PrinterResolution.DPI));
aset.add(new MediaPrintableArea(2, 2, 210 - 4, 297 - 4, MediaPrintableArea.MM));

PrinterJob pj = PrinterJob.getPrinterJob();
pj.setPrintable(new PrintTask());

if (pj.printDialog(aset)) {
    try {
        pj.print(aset);
    } catch (PrinterException ex) {
        ex.printStackTrace();
    }
} 
```

查看[使用打印服务和属性](http://docs.oracle.com/javase/tutorial/2d/printing/services.html)了解更多详细信息

# javascript - 返回 html 选择菜单的查找表

> ID：16026079
> 
> 赞同：1
> 
> 时间：2013-04-15T23:05:11.057
> 
> 标签：javascript, jquery, html-select

假设在 HTML 中有一个选择菜单，我想要一个表示菜单中的值和描述的查找表。

```
<select id="carMenu">
    <option value="P">Park</option>
    <option value="R">Reverse</option>
    <option value="N">Neutral</option>
    <option value="D">Drive</option>
</select> 
```

现在在 Javascript/JQuery 中构造查找表的一种方法如下：

```
var lookup = {}; $('#carMenu>option').map(function()
{ 
    lookup[this.value]=this.innerHTML; 
}) 
```

获得

```
{
    P: "Park", 
    R: "Reverse", 
    N: "Neutral", 
    D: "Drive"
} 
```

是否有 jQuery 方法可以直接生成这个对象——而不是迭代外部提供的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:26:48.963

`map`不是您想要实现的功能的正确功能，我认为没有`jQuery`提供这样做的方法。但是，您可以轻松地为此创建自己的函数作为`jQuery`插件或不作为插件。

[http://jsfiddle.net/scarsick/qG5Dc/1/](http://jsfiddle.net/scarsick/qG5Dc/1/)（以你的例子）

```
function makeMap(o, fn) {
    var map = {}, r;

    if (typeof o.length === 'number') {
        for (var i = 0, len = o.length; i < len; i++) {
            map[(r = fn(i, o[i]))[0]] = r[1];
        }
        return map;
    }

    for (var k in o) {
        if (o.hasOwnProperty(k)) {
            map[(r = fn(k, o[k]))[0]] = r[1];
        }
    }

    return map;
} 
```

**带着`array`**

```
var map = makeMap([1, 2, 3, 4], function (i, v) { return ['item' + i, v]; });
console.log(map); // {item0: 1, item1: 2, item2: 3, item3: 4} 
```

**有一个`jQuery`对象**

HTML

```
<ul>
    <li>first item</li>
    <li>second item</li>
    <li>third item</li>
</ul> 
```

JS

```
var map = makeMap($('ul li'), function (i, v) {
    return ['li' + i, v.innerHTML];
});

console.log(map); // {li0: "first item", li1: "second item", li2: "third item"} 
```

**带着朴素`object`**

```
var map = makeMap({prop1: 'test', prop2: 'test'}, function (k, v) {
    return [k.toUpperCase(), v];
});
console.log(map); // {PROP1: "test", PROP2: "test"} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:10:42.630

不，没有这样的 jQuery 函数可以为您提供对象而不是数组。不过，自己写一个非常简单。只需将您已经编写的内容封装在 jQuery 函数中即可：

```
$.fn.mapToObject = function (callback) {
    var output = {};

    this.each(function (index, element) {
        var toAdd = callback.call(this, index, element);
        output[toAdd.key] = toAdd.value;
    });

    return output;
}; 
```

...然后你可以这样调用：

```
var lookup = $('#carMenu>option').mapToObject(function (index, element) {
    return {
        key: this.value,
        value: this.innerHTML
    };
}); 
```

[http://jsfiddle.net/mattball/nQXL2](http://jsfiddle.net/mattball/nQXL2)

# authentication - 如何让自定义 Spring 2 身份验证提供程序接受 UsernamePasswordAuthenticationToken？

> ID：16026080
> 
> 赞同：0
> 
> 时间：2013-04-15T23:05:35.760
> 
> 标签：authentication, spring2.x

在 Spring 2 中，我创建了一个自定义身份验证提供程序，因为我无法像 Spring 似乎更喜欢的那样从数据库中获取密码，因为有一个黑匣子。当我尝试进行身份验证时，我得到：

> 未找到 org.springframework.security.providers.UsernamePasswordAuthenticationToken 的 AuthenticationProvider

我把这个bean放在我的security.xml中：

```
<bean id="imsAuthProvider" class="com.terrapages.mokbeecds.ims.IMSAuthenticationProvider">
    <security:custom-authentication-provider />
</bean> 
```

我相信，这就是我所需要的。它应该只从表单中获取用户名和密码，然后将其传递给我的提供商，以便在它认为合适的时候进行处理。我的 customAuthenticationProvider 中也有这个：

```
public boolean supports(@SuppressWarnings("rawtypes") Class authentication) {
    return (UsernamePasswordAuthenticationToken.class.isAssignableFrom(authentication));
} 
```

据我了解，在将身份验证令牌提供给自定义身份验证提供程序之前会对其进行检查。如果它返回 false，则 Spring 检查下一个身份验证提供程序。

main`authenticate(Authentication)`方法只能抛出 a`BadCredentialsException`或 an `AuthenticationServiceException`，据我了解，这不应该导致上面的输出。

关于 Spring 2 的信息有点难找，目前 Spring 3 无处不在。

如何让我的提供者接受`UsernamePasswordAuthenticationToken`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T05:55:36.883

Spring Security 2 的文档也很好：[http](http://static.springsource.org/spring-security/site/docs/2.0.x/reference/html/springsecurity.html) ://static.springsource.org/spring-security/site/docs/2.0.x/reference/html/springsecurity.html 请使用以下支持方法：

```
public boolean supports(Class authentication) {
    return (UsernamePasswordAuthenticationToken.class.isAssignableFrom(authentication));
} 
```

**已编辑**

建议：

1.  删除您的提供商 - 身份验证应该可以工作。如果不是 - 解决问题。
2.  调试身份验证和支持方法，看看是什么问题

# jquery-mobile - jquery Mobile滚动和活动状态

> ID：16026081
> 
> 赞同：0
> 
> 时间：2013-04-15T23:05:40.237
> 
> 标签：jquery-mobile

我有一组可以在我的 jquery 移动页面上滚动的 div。每个 div 在 CSS 中都有一个活动类，因此当它们被点击时它们会改变颜色。出于某种原因，当我尝试滚动列表时，这些项目会变为活动状态，因为我正在“单击”它们。

这不是太严重，看起来不错，但还有另一个小故障。如果页面是内部滚动的，所以我只是轻弹它并且它没有停止移动，在屏幕上点击会激活我第一次滚动时按下的 div。

知道是什么导致了这个/如何阻止它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:10:09.380

你可以试试[stopPropagation](http://api.jquery.com/event.stopPropagation/)

HTML：

```
<div id='someID'>
    <someElement />
</div> 
```

JS：

```
$('#someID').click(function(e){
    e.stopPropagation(); //stops default behaviour
    //check to make active/inactive
    if( $('#someID').hasClass('active') ){
        $('#someID').removeClass('active');

        //do what needs to be done when it becomes activated
    } else {
        $('#someID').addClass('active');
        //do what needs to be done when disabled
    }

    //do whatever you always want to here

}); 
```

注意：任何需要点击事件工作的东西都必须在之后重新启用，但如果您使用链接/按钮/等。在`div`有点击事件的情况下，它仍然会起作用。

# hadoop - 对多达 200 列的行进行交互式查询的最佳大数据解决方案是什么？

> ID：16026085
> 
> 赞同：1
> 
> 时间：2013-04-15T23:05:56.860
> 
> 标签：hadoop, cassandra, hbase, bigdata, apache-storm

我们有一个简单的表格，如下所示：

```
------------------------------------------------------------------------
|   Name   | Attribute1 | Attribute2 | Attribute3 | ... | Attribute200 |
------------------------------------------------------------------------
| Name1    | Value1     | Value2     | null       | ... | Value3       |
| Name2    | null       | Value4     | null       | ... | Value5       |
| Name3    | Value6     | null       | Value7     | ... | null         |
| ...                                                                  |
------------------------------------------------------------------------ 
```

但可能有数亿行/名称。数据将每隔一小时左右填充一次。

目标是在几秒钟内获得对数据进行交互式查询的结果。

大多数查询看起来像：

```
select count(*) from table
where Attribute1 = Value1 and Attribute3 = Value3 and Attribute113 = Value113; 
```

where 子句包含任意数量的属性名称-值对。

我是大数据方面的新手，想知道在数据存储（MySQL、HBase、Cassandra 等）和处理引擎（Hadoop、Drill、Storm 等）方面，用于上述交互式查询的最佳选择是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T12:45:20.670

Playorm for Cassandra 为包括联接在内的 SQL 提供了不错的支持。[在http://buffalosw.com/wiki/SJQL-Support/](http://buffalosw.com/wiki/SJQL-Support/)上阅读更多信息，示例参见[http://buffalosw.com/wiki/Command-Line-Tool/](http://buffalosw.com/wiki/Command-Line-Tool/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:24:32.690

像 Vertica（封闭源代码）或 MonetDB（开源 - 但我没有使用过）这样的柱状数据库将有效地处理您提到的查询。在 50000 英尺视图中，原因是它们分别存储每一列，因此在需要查询数据时不会读取任何不需要的列 - 对于您的示例，将读取 3 个属性，而不会读取其他 197 个属性

# bash - 人们如何在 bash 脚本运行时显示精美的标题

> ID：16026091
> 
> 赞同：6
> 
> 时间：2013-04-15T23:06:28.673
> 
> 标签：bash, title

如何让 bash 脚本有一个很酷的标题

目前我只是使用 echo 将名称 arg clicker 赋予我的脚本

我如何制作 fnacy bash sript 徽标而不是一条无聊的线

像下面这样：

![就像这个外壳顶部的标志一样](https://i.stack.imgur.com/fcTZ0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:16:25.450

看看`tput`命令。`tput`用于改变终端特性。

例如

```
tput bold
tput setaf 3
tput setab 4
tput reset 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-13T16:46:38.603

尝试安装 'boxes' - 从手册页：

> 描述 Boxes 是一个文本过滤器，可以在其输入文本周围绘制任何类型的框。盒子设计选择范围从简单的盒子到复杂的 ASCII 艺术。一个盒子也可以被移除和修复，即使它因编辑里面的文本而被严重损坏。由于框可以在任何一侧打开，因此框也可用于以任何编程语言创建区域注释。通过附加到自由格式的配置文件，可以轻松添加和共享各种新的盒子设计。box 最初打算与 vim(1) 文本编辑器一起使用，但它可以绑定到任何支持过滤器的文本编辑器，也可以作为独立工具从命令行调用。

```
$ boxes -h
boxes - draws any kind of box around your text (and removes it)
        (c) Thomas Jensen <boxes@thomasjensen.com>
        Web page: http://boxes.thomasjensen.com/
Usage:  boxes [options] [infile [outfile]]
        -a fmt   alignment/positioning of text inside box [default: hlvt]
        -c str   use single shape box design where str is the W shape
        -d name  box design [default: first one in file]
        -f file  configuration file
        -h       print usage information
        -i mode  indentation mode [default: box]
        -k bool  leading/trailing blank line retention on removal
        -l       list available box designs w/ samples
        -m       mend box, i.e. remove it and redraw it afterwards
        -p fmt   padding [default: none]
        -r       remove box
        -s wxh   box size (width w and/or height h)
        -t str   tab stop distance and expansion [default: 8e]
        -v       print version information 
```

:)
戴尔

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-12T21:28:27.097

有一些网站可以做到。看看这个网站： [http ://www.kammerl.de/ascii/AsciiSignature.php](http://www.kammerl.de/ascii/AsciiSignature.php)

# ruby-on-rails - 运行“rvm rvmrc trust”时，Cap 部署失败

> ID：16026095
> 
> 赞同：1
> 
> 时间：2013-04-15T23:06:56.610
> 
> 标签：ruby-on-rails, deployment, rvm, capistrano, rvm-capistrano

使用 Capistrano 首次成功部署后，运行 cap deploy 失败：

没有要清理的旧版本

在“部署”回调后触发

> 2013-04-16 10:59:15 执行“rvm:trust_rvmrc”
> 执行“rvm rvmrc 信任/home/app/xxxx/releases/20130415225133”
> 
> ```
> servers: ["191.199.74.146"]
> [191.199.74.146] executing command 
> ```
> 
> **[err :: 191.199.74.146] 将 /home/app/xxxx/releases/20130415225133/.rvmrc 标记为受信任 - 失败**

将以下代码放入 deploy.rb 时发生错误：

```
namespace :assets do
  desc "Precompile assets locally and then rsync to app servers"
  task :precompile, :only => { :primary => true } do
    run_locally "mkdir -p public/__assets; mv public/__assets public/assets;"
    run_locally "bundle exec rake assets:clean_expired; bundle exec rake assets:precompile;"
    servers = find_servers :roles => [:app], :except => { :no_release => true }
    servers.each do |server|
      run_locally "rsync -av ./public/assets/ #{user}@#{server}:#{current_path}/public/assets/;"
    end
    run_locally "mv public/assets public/__assets"
  end
end 
```

**更新**

我在本地执行了 rvm rvmrc trust，也失败了..

> xxxx-iMac:iv Owner$ rvm rvmrc trust 标记为 /Users/Owner/Documents/workspace/iv/.rvmrc 为受信任 - 失败

# angularjs - angularjs 值与工厂

> ID：16026096
> 
> 赞同：12
> 
> 时间：2013-04-15T23:07:00.130
> 
> 标签：angularjs

我是 angularjs 的新手。我试图找出何时使用价值与工厂即服务。这是我在 egghead.io 教程中的简单代码：

```
.value('Data', function(){
    return {message:"I am data from a service"};
  }) 
```

Data.message 绑定到输入字段。当我启动页面时，输入字段中没有任何内容。如果我将值更改为工厂，则默认消息会出现在输入字段中。

这是控制器：

```
controller('FirstCtrl', ['$scope','Data',function($scope, Data) {
    $scope.data = Data;
    console.log('exiting first controller');
  }]) 
```

和索引文件：

```
<div ng-controller="FirstCtrl">
   <input type="text" ng-model="data.message">
   <h1>{{data.message}}</h1>
</div> 
```

为什么使用值时页面空白？我的假设是应用程序启动时不计算或计算值，而工厂是？

另外，我在哪里可以找到有关 $provide 的一些文档？谢谢你们。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-16T01:29:49.117

将值设置为对象，而不是函数：

```
app.value('Data', {message:"I am data from a service"}); 
```

[普朗克](http://plnkr.co/edit/WMGANf?p=preview)

另请参阅[provide.value()](http://docs.angularjs.org/api/auto/object/$provide#value)，以及[有关 $provide](http://www.youtube.com/watch?v=VxuN6WO3tIA&t=10m30s) (value, constant, service, factory, decorator, provider) 的视频

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-17T15:38:03.457

您应该将控制器声明为

```
 app.controller('DataController', ['Data', function DataController(Data){
      this.data = Data;
   }]); 
```

然后像在我的代码中一样在您的页面中使用它

```
<div ng-controller='DataController as dataController'>
      {{dataController.data()}}
   </div> 
```

# checkstyle - 如何创建 CheckStyle 检查以验证注释字段

> ID：16026097
> 
> 赞同：2
> 
> 时间：2013-04-15T23:07:00.287
> 
> 标签：checkstyle

```
@WebService(serviceName="TestImpl",
targetNamespace = "http://example.org"
)
public class TestImpl implements Test{ 
```

如果我的测试类与上面类似，我的检查应该验证 targetNamespace 值是否总是以“http://”开头

如果没有现有的检查可以做到这一点，我的自定义检查应该如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:36:31.660

您可以使用 Checkstyle 开箱即用地执行此操作，方法是应用[RegexpMultiline](http://checkstyle.sourceforge.net/config_regexp.html#RegexpMultiline)检查，如下所示：

```
<module name="RegexpMultiline">
    <property name="format"
        value="(?s)@WebService\s*\(.*?targetNamespace\s*=\s*&quot;(?!http:\/\/).{7}"/>
    <property name="message"
        value="Target namespace must start with &quot;http://&quot;"/>
</module> 
```

这是[regex 的解释](http://regex101.com/r/wL9gP1)。

# windows - Perl diruse 无法识别

> ID：16026099
> 
> 赞同：0
> 
> 时间：2013-04-15T23:07:06.813
> 
> 标签：windows, perl, user-interface

我的程序通过 windows 中的命令行从文件目录的用户那里获取输入，然后在指定路径上运行 diruse 以收集有关可用磁盘空间的信息。由于某种原因，错误一直说“diruse.exe 未被识别为内部或外部命令”。下面是我的一段代码，要完整查看，请到[这里](http://pastebin.com/qmtV2gd2)。我把代码从它的 sub 中取出来看看它是否可以工作，但它没有。

```
&argument_checking; #calling sub checking user arguements.

#&reading_directory; # reads user given directory.
chdir($user_directory), or die " Directory $user_directory does not exist"; #change to user directory or exit.  
open(DIRUSE, "diruse.exe /* . |"); #opening user given directory path.

foreach my $directory_lines(<DIRUSE>)
{
    chomp $directory_lines;
    push(@directory_lines, $directory_lines); #pushing directory lines from     file into an array
}

close(DIRUSE); #closing

shift(@directory_lines);
shift(@directory_lines);

pop(@directory_lines);

&chop_and_save;
&gui_creator; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:26:04.343

该消息来自命令外壳，这意味着它无法`diruse.exe`在当前目录或该进程的 PATH 中的任何目录中找到。

# yii - 键值表的 Yii 形式和模型

> ID：16026101
> 
> 赞同：1
> 
> 时间：2013-04-15T23:07:17.690
> 
> 标签：yii

![在此处输入图像描述](https://i.stack.imgur.com/gwOZ8.png)

我有一个只有两列键值的表。我想创建一个允许用户插入 3 对键值设置的表单。

我需要将 3 个不同的模型传递给视图吗？或者有什么可能的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:40:21.480

查看此链接： [http ://www.yiiframework.com/doc/guide/1.1/en/form.table](http://www.yiiframework.com/doc/guide/1.1/en/form.table)

这被认为是 Yii 中用于更新以创建多个模型的最佳形式。

本质上，对于创建，您可以创建一个 for 循环，生成尽可能多的输入，并在您的控制器中循环输入以创建新模型。

**查看文件：**

```
for ( $settings as $i=>$setting ) //Settings would be an array of Models (new or otherwise)
{
    echo CHtml::activeLabelEx($setting, "[$i]key");
    echo CHtml::activeLabelEx($setting, "[$i]key");
    echo CHtml::error($setting, "[$i]key");

    echo CHtml::activeTextField($setting, "[$i]value");
    echo CHtml::activeTextField($setting, "[$i]value");
    echo CHtml::error($setting, "[$i]value");
} 
```

**控制器动作创建：**

```
$settings = array(new Setting, new Setting, new Setting);
if ( isset( $_POST['Settings'] ) )
    foreach ( $settings as $i=>$setting )
        if ( isset( $_POST['Setttings'][$i] ) )
        {
            $setting->attributes = $_POST['Settings'][$i];
            $setting->save();
        }
//Render View 
```

要更新现有模型，您可以使用相同的方法，但您可以根据 $_POST['Settings'] 数组中的键加载模型，而不是创建新模型。

要回答您关于将 3 个模型传递给视图的问题，可以在不传递它们的情况下完成，但要验证数据并将正确的错误消息发送到视图，您应该将放置在数组中的三个模型传递给数组中的视图.

*注意：上面的示例应该按原样工作，但不提供模型有效或正确保存的任何验证*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:27:24.673

我要提醒你，让你知道你可能会因此而让你的生活变得非常复杂。

我目前正在使用`EAV`类似于此键值的模式表，这里列出了您可能会发现困难或不可能的事情：

*   使用`CDbCriteria`mergeWith() 在 search() （或其他）事件中过滤“值”上的相关元素
*   过滤`CGridView`或`CListView`

如果这只是非常直接的键值，没有相关的实体方面（我猜是因为它看起来像设置），那么一种方法是：

*   为您的设置表创建一个普通的“设置” `CActiveRecord`（您将使用它来将条目保存到您的设置表）
*   通过扩展创建表单模型`CFormModel`并将其用作表单中的 $model。
*   向您的 Form 模型添加一个 save() 方法，该方法将使用“设置”模型单独插入键值对。最好使用事务以防键值对未通过 Settings->validate() （如果适用）
*   `getAttributes()`如果用户想要编辑条目，您可能希望覆盖 Form 模型以返回 db 数据。

我希望这已经足够清楚了。让我给你一些基本的代码设置。请注意，**我没有对此进行测试**。它应该给你一个粗略的想法。：

**设定型号：**

```
class Setting extends CActiveRecord
{
   public function tableName()
   {
      return 'settings';
   }
} 
```

**设置表单模型：**

```
class SettingsForm extends CFormModel
{
   /**
    * Load attributes from DB
    */
   public function loadAttributes()
   {
      $settings = Setting::model()->findAll();
      $this->setAttributes(CHtml::listData($settings,'key','value'));
   }

   /*
    * Save to database
    */
   public function save()
   {
      foreach($this->attributes as $key => $value)
      {
         $setting = Setting::model()->find(array('condition'=>'key = :key',
                                                 'params'=>array(':key'=>$key)));
         if($setting==null)
         {
            $setting = new Setting;
            $setting->key = $key;
         }
         $setting->value = $value;
         if(!$setting->save(false))
            return false;
      }
      return true;
   }
} 
```

**控制器：**

```
public function actionSettingsForm()
{
   $model = new Setting;
   $model->loadAttributes();

   if(isset($_POST['SettingsForm']))
   {
      $model->attributes = $_POST['SettingsForm'];
      if($model->validate() && $model->save())
      {
         //success code here, with redirect etc..
      }
   }
   $this->render('form',array('model'=>$model));
} 
```

**表单视图：**

```
$form=$this->beginWidget('CActiveForm', array(
        'id'=>'SettingsForm'));

//all your form element here + submit 
//(you could loop on model attributes but lets set it up static for now)
//ex:
echo $form->textField($model,'fieldName'); //fieldName = db key

$this->endWidget($form); 
```

如果您想进一步澄清某一点（代码等），请告诉我。

PS：对于后代，如果其他人对此和 EAV 有疑问，他们可以检查[EAV 行为扩展](http://yiiext.github.io/extensions/eav-behavior/index.html)或选择更合适的数据库系统，例如[MongoDb](http://www.mongodb.org/)（那里有一些扩展）或[HyperDex](http://hyperdex.org/)

# jquery - 循环一个 jquery 函数会更好吗？

> ID：16026102
> 
> 赞同：0
> 
> 时间：2013-04-15T23:07:18.600
> 
> 标签：jquery, performance, for-loop, show-hide

我试图更多地了解 jQuery 以及它是如何工作的。 [在我的上一个问题](https://stackoverflow.com/questions/15993134/how-to-show-2-or-more-div-based-of-radio-selection-with-jquery/)中，用户 Zachary Kniebel 帮助我弄清楚如何根据“RADIO”表单显示/隐藏一些值，现在我修改了他的代码，我想使用循环来改进它（也许是他建议的 FOR 循环大部头书）。实际上我没有运气所以这是我的问题：

**

## 我忘了说我不能更改 HTML，因为它是由 wordpress 选项框架自动生成的......

**

如何在不更改 HTML 部分的情况下为此功能使用 LOOP？

**[对于 jsfiddle 爱好者来说，这是一个非常长的 js 代码的工作示例](http://jsfiddle.net/downloadtaky/4aCtP/9/)**

> JS

--

```
jQuery(document).ready(function ($) {
    $types = $('.of-radio');
    $types.change(function () {
        $this = $(this).val();
        if ($this == "0") {
            /* zone 1 */
            $('#section-custom_posts_name_s_n1').hide();
            $('#section-custom_posts_name_p_n1').hide();
            $('#section-custom_posts_name_i_n1').hide();
            $('#section-custom_posts_name_d_n1').hide();
            /* end zone 1 start zone 2*/
            $('#section-custom_posts_name_s_n2').hide();
            $('#section-custom_posts_name_p_n2').hide();
            $('#section-custom_posts_name_i_n2').hide();
            $('#section-custom_posts_name_d_n2').hide();
            /* end zone 2 start zone 3 */
            $('#section-custom_posts_name_s_n3').hide();
            $('#section-custom_posts_name_p_n3').hide();
            $('#section-custom_posts_name_i_n3').hide();
            $('#section-custom_posts_name_d_n3').hide();
            /* end zone 3 start zone 4 */
            $('#section-custom_posts_name_s_n4').hide();
            $('#section-custom_posts_name_p_n4').hide();
            $('#section-custom_posts_name_i_n4').hide();
            $('#section-custom_posts_name_d_n4').hide();
            /* end zone 4 start zone 5 */
            $('#section-custom_posts_name_s_n5').hide();
            $('#section-custom_posts_name_p_n5').hide();
            $('#section-custom_posts_name_i_n5').hide();            
            $('#section-custom_posts_name_d_n5').hide();
            /* end zone 5 */
        } else if ($this == "1") {
            /* start zone 1 */
            $('#section-custom_posts_name_s_n1').show();
            $('#section-custom_posts_name_p_n1').show();
            $('#section-custom_posts_name_i_n1').show();
            $('#section-custom_posts_name_d_n1').show();
            /* end zone 1 start zone 2 */
            $('#section-custom_posts_name_s_n2').hide();
            $('#section-custom_posts_name_p_n2').hide();
            $('#section-custom_posts_name_i_n2').hide();
            $('#section-custom_posts_name_d_n2').hide();
            /* end zone 2 start zone 3 */
            $('#section-custom_posts_name_s_n3').hide();
            $('#section-custom_posts_name_p_n3').hide();
            $('#section-custom_posts_name_i_n3').hide();
            $('#section-custom_posts_name_d_n3').hide();
            /* end zone 3 start zone 4 */
            $('#section-custom_posts_name_s_n4').hide();
            $('#section-custom_posts_name_p_n4').hide();
            $('#section-custom_posts_name_i_n4').hide();
            $('#section-custom_posts_name_d_n4').hide();
            /* end zone 4 start zone 5 */
            $('#section-custom_posts_name_s_n5').hide();
            $('#section-custom_posts_name_p_n5').hide();
            $('#section-custom_posts_name_i_n5').hide();            
            $('#section-custom_posts_name_d_n5').hide();
            /* end zone 5 */
        } else if ($this == "2") {
            /* start zone 1 */
            $('#section-custom_posts_name_s_n1').show();
            $('#section-custom_posts_name_p_n1').show();
            $('#section-custom_posts_name_i_n1').show();
            $('#section-custom_posts_name_d_n1').show();
            /* end zone 1 start zone 2 */
            $('#section-custom_posts_name_s_n2').show();
            $('#section-custom_posts_name_p_n2').show();
            $('#section-custom_posts_name_i_n2').show();
            $('#section-custom_posts_name_d_n2').show();
            /* end zone 2 start zone 3 */
            $('#section-custom_posts_name_s_n3').hide();
            $('#section-custom_posts_name_p_n3').hide();
            $('#section-custom_posts_name_i_n3').hide();
            $('#section-custom_posts_name_d_n3').hide();
            /* end zone 3 start zone 4 */
            $('#section-custom_posts_name_s_n4').hide();
            $('#section-custom_posts_name_p_n4').hide();
            $('#section-custom_posts_name_i_n4').hide();
            $('#section-custom_posts_name_d_n4').hide();
            /* end zone 4 start zone 5 */
            $('#section-custom_posts_name_s_n5').hide();
            $('#section-custom_posts_name_p_n5').hide();
            $('#section-custom_posts_name_i_n5').hide();
            $('#section-custom_posts_name_d_n4').hide();
            /* end zone 5 */
        } else if ($this == "3") {
            /*start zone 1 */
            $('#section-custom_posts_name_s_n1').show();
            $('#section-custom_posts_name_p_n1').show();
            $('#section-custom_posts_name_i_n1').show();
            $('#section-custom_posts_name_d_n1').show();
            /* end zone 1 start zone 2 */
            $('#section-custom_posts_name_s_n2').show();
            $('#section-custom_posts_name_p_n2').show();
            $('#section-custom_posts_name_i_n2').show();
            $('#section-custom_posts_name_d_n2').show();
            /* end zone 2 start zone 3 */
            $('#section-custom_posts_name_s_n3').show();
            $('#section-custom_posts_name_p_n3').show();
            $('#section-custom_posts_name_i_n3').show();
            $('#section-custom_posts_name_d_n3').show();
            /* end zone 3 start zone 4 */
            $('#section-custom_posts_name_s_n4').hide();
            $('#section-custom_posts_name_p_n4').hide();
            $('#section-custom_posts_name_i_n4').hide();
            $('#section-custom_posts_name_d_n4').hide();
            /* end zone 4 start zone 5 */
            $('#section-custom_posts_name_s_n5').hide();
            $('#section-custom_posts_name_p_n5').hide();
            $('#section-custom_posts_name_i_n5').hide();
            $('#section-custom_posts_name_d_n5').hide();
            /* end zone 5 */
        } else if ($this == "4") {
            /* start zone 1 */
            $('#section-custom_posts_name_s_n1').show();
            $('#section-custom_posts_name_p_n1').show();
            $('#section-custom_posts_name_i_n1').show();
            $('#section-custom_posts_name_d_n1').show();
            /* end zone 1 start zone 2 */
            $('#section-custom_posts_name_s_n2').show();
            $('#section-custom_posts_name_p_n2').show();
            $('#section-custom_posts_name_i_n2').show();
            $('#section-custom_posts_name_d_n2').show();
            /* end zone 2 start zone 3 */
            $('#section-custom_posts_name_s_n3').show();
            $('#section-custom_posts_name_p_n3').show();
            $('#section-custom_posts_name_i_n3').show();
            $('#section-custom_posts_name_d_n3').show();
            /* end zone 3 start zone 4 */
            $('#section-custom_posts_name_s_n4').show();
            $('#section-custom_posts_name_p_n4').show();
            $('#section-custom_posts_name_i_n4').show();
            $('#section-custom_posts_name_d_n4').show();
            /* end zone 4 start zone 5 */
            $('#section-custom_posts_name_s_n5').hide();
            $('#section-custom_posts_name_p_n5').hide();
            $('#section-custom_posts_name_i_n5').hide();
            $('#section-custom_posts_name_d_n5').hide();
            /* end zone 5 */
        } else if ($this == "5") {
            /* start zone 1 */
            $('#section-custom_posts_name_s_n1').show();
            $('#section-custom_posts_name_p_n1').show();
            $('#section-custom_posts_name_i_n1').show();
            $('#section-custom_posts_name_d_n1').show();
            /* end zone 1 start zone 2 */
            $('#section-custom_posts_name_s_n2').show();
            $('#section-custom_posts_name_p_n2').show();
            $('#section-custom_posts_name_i_n2').show();
            $('#section-custom_posts_name_d_n2').show();
            /* end zone 2 start zone 3 */
            $('#section-custom_posts_name_s_n3').show();
            $('#section-custom_posts_name_p_n3').show();
            $('#section-custom_posts_name_i_n3').show();
            $('#section-custom_posts_name_d_n3').show();
            /* end zone 3 start zone 4 */
            $('#section-custom_posts_name_s_n4').show();
            $('#section-custom_posts_name_p_n4').show();
            $('#section-custom_posts_name_i_n4').show();
            $('#section-custom_posts_name_d_n4').show();
            /* end zone 4 start zone 5 */
            $('#section-custom_posts_name_s_n5').show();
            $('#section-custom_posts_name_p_n5').show();
            $('#section-custom_posts_name_i_n5').show();
            $('#section-custom_posts_name_d_n5').show();
            /* end zone 5 */
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:15:49.780

**首先**要简化的是在每组相关的 div 周围放置另一个 div。

```
<div id="section-custom_posts_name_all_n1">
    ... existing set of 4 divs for s, n, i and p and related text for n1 ...
</div> 
```

然后代替

```
$('#section-custom_posts_name_s_n1').hide();
$('#section-custom_posts_name_p_n1').hide();
$('#section-custom_posts_name_i_n1').hide();
$('#section-custom_posts_name_d_n1').hide(); 
```

你只是把：

```
$('#section-custom_posts_name_all_n1').hide(); 
```

**要简化的第二件事**是您可以使用串联构建字符串：

```
for (int i=1; i <= last  ; ++i) {
    $("#section-custom_posts_name_all_n" + i).hide();
} 
```

这会将它们全部隐藏到由 定义的点`last`。

**第三件事**是把它转过来这样做（加上使用循环）：

```
$this = parseInt($(this).val())
for (var i=1; i < 6 ; ++i) {
            fixDisplay($('#section-custom_posts_name_s_n'+i), $this, i);
            fixDisplay($('#section-custom_posts_name_p_n'+i), $this, i);
            fixDisplay($('#section-custom_posts_name_i_n'+i), $this, i);
            fixDisplay($('#section-custom_posts_name_d_n'+i), $this, i);
}

function fixDisplay($el, val, section) {
    if (section <= val) {
        $el.show();
    } else {
        $el.hide();
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:15:56.430

你可能的意思是`loop`，不是`cicle`。

但是您甚至不需要循环，您可以在 CSS 中处理所有内容，只需`class`在元素上使用名称并将此代码简化为：

HTML：

```
<div id="myParentDiv" class="show_0">
    <div class="block_1">...</div>
    <div class="block_2">...</div>
    <div class="block_3">...</div>
    <div class="block_4">...</div>
    <div class="block_5">...</div>
</div> 
```

JS：

```
jQuery(document).ready(function ($) {
    $types = $('.of-radio');
    $types.change(function () {
        $this = $(this).val();

        $('#myParentDiv').removeClass('show_0 show_1 show_2 show_3 show_4 show_5');

        if ($this == "0") {
            $('#myParentDiv').addClass('show_0');
        } else if ($this == "1") {
            $('#myParentDiv').addClass('show_1');
        } else if ($this == "2") {
            $('#myParentDiv').addClass('show_2');
        } else if ($this == "3") {
            $('#myParentDiv').addClass('show_3');
        } else if ($this == "4") {
            $('#myParentDiv').addClass('show_4');
        } else if ($this == "5") {
            $('#myParentDiv').addClass('show_5');
        }
    });
}); 
```

CSS：

```
.block_1,
.block_2,
.block_3,
.block_4,
.block_5 {
    display: none;
}

.show_1 .block_1 {
    display: block;
}
.show_2 .block_1,
.show_2 .block_2 {
    display: block;
}
.show_3 .block_1,
.show_3 .block_2,
.show_3 .block_3 {
    display: block;
}
.show_4 .block_1,
.show_4 .block_2,
.show_4 .block_3,
.show_4 .block_4 {
    display: block;
}
.show_5 .block_1,
.show_5 .block_2,
.show_5 .block_3,
.show_5 .block_4,
.show_5 .block_5 {
    display: block;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:54:18.803

我不确定这有多有效，但这是我能够得到代码的最短时间。我不确定您是否正在寻找效率或最短的方法。像其他人一样，我使用 jQuery 内置的循环和链接。

```
jQuery(document).ready(function ($) {
    $types = $('.of-radio');
    $types.change(function () {
       /* $(".section").not("#section-how_many_custom_posts").hide();*/
        $this = $(this).val();
        $('[id^="section-custom_posts_name_"]').hide().each(function(i, val)
                  {
                      if($this > 0 && i < ($this * 4) && $(val).attr('id').replace( /^\D+/g, '') <= $this)
                          $(val).show();
                  });
    });
}); 
```

[JSFiddle](http://jsfiddle.net/downloadtaky/4aCtP/9/)

# django - Django：从添加视图中获取类别

> ID：16026104
> 
> 赞同：0
> 
> 时间：2013-04-15T23:07:24.673
> 
> 标签：django, django-views

我有这样的看法，对吧：

```
def thisviewright(request,pk):
   theadd = adds.objects.filter(id=pk)
   theaddlist = adds.objects.filter(category=add.category)
   return render_to_response.. 
```

我正在尝试获取类别，以便显示具有相同类别的所有其他添加。因为我没有从 URL 传递类别，所以我必须从 add 中获取它，我正在传递谁的 ID。

但我收到一个错误：查询集没有属性类别

模型如下：

```
class adds(models.Model):
title = models.CharField(max_length=255)
category = models.ForeignKey('categories')
...

class categories(models.Model):
title = models.CharField(max_length=255) 
```

这么长的问题，我如何通过使用我传递的对象的类别从同一类别中获取相关的添加？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:14:33.987

在视图的第一行，您返回的是一个查询集，而不是一个对象。虽然此查询集将仅包含一个对象，但使用过滤器构造的其他查询集将具有多个成员。

要使用该行返回一个对象而不是查询集，请使用以下任一行：

```
theadd = adds.objects.get(id=pk)
theadd = adds.objects.filter(id=pk)[0] 
```

您应该只在唯一索引属性（即 id）上使用第一个，因为如果有多个对象与条件匹配，它将失败并出现错误。

# delphi - 要安装哪些更新以达到最新版本的 Delphi 2007？

> ID：16026105
> 
> 赞同：8
> 
> 时间：2013-04-15T23:07:28.260
> 
> 标签：delphi, delphi-2007

在我的注册用户下载页面中有一些 Delphi 2007 补丁。（如果您有多个注册版本，则此页面相当笨拙。）我不再记得安装最新版本的 Delphi 2007 的正确组合是什么。

是否有适用于所有补丁的 ISO，或者推荐的获取最新完整补丁的 Delphi 2007 的方法是什么？唯一的 ISO 似乎是**CodeGear RAD Studio 2007 ISO（2007 年 12 月）**，由于 2007 年 12 月的标签，我认为这不是最新的完整补丁版本。

似乎正确的组合是：

*   从网络安装 R2 ( [http://cc.embarcadero.com/item/26910](http://cc.embarcadero.com/item/26910) )
*   4 月 8 日修补程序 ( [http://cc.embarcadero.com/item/25495](http://cc.embarcadero.com/item/25495) )
*   6 月 8 日链接器修补程序（仅适用于 C++ Builder）（[http://cc.embarcadero.com/item/25694](http://cc.embarcadero.com/item/25694)）
*   5 月/6 月 08 日帮助更新 4 ( [http://cc.embarcadero.com/item/25688](http://cc.embarcadero.com/item/25688) )
*   Windows 7 的调试器修复 ( [http://cc.embarcadero.com/item/27521](http://cc.embarcadero.com/item/27521) )

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T00:01:35.347

AFAIK，您唯一需要的是：

*   R2，它是一个累积更新，包含它之前的所有更新。
*   帮助更新 4
*   Win7调试器补丁

`Help->About`这是我的 Delphi 2007 副本中对话框的相关部分：

![Delphi 2007 帮助关于对话框的一部分](https://i.stack.imgur.com/X4xdJ.png)

# algorithm - 在单词出现上使用 trie 数据结构

> ID：16026107
> 
> 赞同：0
> 
> 时间：2013-04-15T23:07:29.540
> 
> 标签：algorithm, count, frequency, trie

*这个问题与语言无关，更多的是关于了解如何实现 trie 或尝试是否适合我的程序应该做的事情*。假设我有一串这样的文本。

```
string= "a tale about an ant and an android"; 
```

“a”对应的 trie 看起来像这样

```
 a(7)      
     /    \     
    b(1)  n(4)
    /     /   \
  o(1)  t(1)  d(2)
  /              \
 u(1)            r(1)
 /                 \
t(1)               o(1)
                     \
                     i(1)
                       \
                        d(1) 
```

我想找到每个单词的出现次数。尽管“a”在文本中出现了 6 次，但只有一个实例将其用作单词。相同的规则适用于“an”和“and”。

我希望我的最终频率计数器看起来像这样：

a：发生 1 次而不是 7 次：2 和：1 等等..

我怎么可能记录完整的字数？

我在 php 中工作，试图处理大量文本并访问过[这个问题](https://stackoverflow.com/questions/4670417/count-word-frequency-in-a-text)，这不是我想要的。性能很重要，但内存效率更可取，因为我正在解析一万亿个单词。谢谢，我很感激你的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:17:58.957

我建议使用三元树，然后在第三条边存储单词。然后你可以在其中实现一个单词计数器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:48:56.193

你可以通过两种方式做到这一点：

1.  不是每次单词通过时都增加一个节点，而是仅在它结束时才增加

2.  在单词的末尾有一个伪字母（比如空白），只有当单词在那里结束时才会增加。

# c++ - 使用 IO_Service 已经创建的线程更有效

> ID：16026113
> 
> 赞同：0
> 
> 时间：2013-04-15T23:08:09.890
> 
> 标签：c++, multithreading, boost-asio

在下面的例子中，我使用的是 boost ASIO，这里有一个线程准备好并且总是在等待一个作业去做。它总是线性地做作业（就像我理解的作业存储在一个队列中一样）下面的代码片段解释了我的观点.

```
void WorkerThread( boost::shared_ptr< boost::asio::io_service > io_service )
{
    io_service->run();
}

void PrintNum( int x )
{
  //Do somejon
}

boost::shared_ptr< boost::asio::io_service > io_service( new boost::asio::io_service);
boost::shared_ptr< boost::asio::io_service::work > work(new boost::asio::io_service::work( *io_service ));
boost::asio::io_service::strand strand( *io_service );
worker_threads.create_thread( boost::bind( &WorkerThread, io_service ) );
//Give the thread (which is already active) some work to do
for(int i=0;i<2;i++)
{
  strand.post( boost::bind( &PrintNum, i ) );
} 
```

**问题 1**

现在我的问题是，上述方法是否比启动独立线程（例如通过使用`boost::thread`）更快、更有效我知道在独立线程的情况下，例如通过`boost::thread`启动线程可能不是线性的（线程 2 可能在线程 1 之前运行）我的问题是如果只涉及一个线程，哪种机制会更快？是否有任何开销因为 eof boost::bind

**问题 2** 在上面的示例中，启动了 2 个等待工作的线程（线程 1 和线程 2）。现在我想知道当连续给出 2 个工作时究竟会发生什么

```
for(int i=0;i<2;i++)
{
  strand.post( boost::bind( &PrintNum, i ) );
} 
```

每个线程都有一项工作，但是线程 2 不会在线程 1 之前完成。我的问题是线程 2 在线程 1 启动时会发生什么，它甚至`PrintNum`在线程 1 启动时进入方法。那么在这种情况下，就性能而言，拥有多个线程有什么意义呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:12:55.940

线程和异步 i/o 不是性能优化。它们是用于隐藏延迟的技术。

问题1： boost::bind 相对便宜。它只是创建一个函数对象。启动线程非常昂贵。线程之间的同步有些昂贵（不像创建一个新线程那么昂贵，但比创建一个函数对象更昂贵）。strand.post() 之类的操作可能会进行大量同步（在线程之间传递值，确保事情以特定的顺序发生）。

问题 2：线程 2（假设库创建它而不是以某种方式对其进行优化）将阻塞等待线程 1 在线程 2 甚至调用 PrintNum 之前完成其处理。

如果两个线程要花费大部分时间互相阻塞，那么拥有两个线程是没有意义的。

依赖操作的序列大部分应该映射到同一个线程。（就像您的情况下的 PrintNum(0); PrintNum(1) 一样：您希望它们按顺序运行，因此将它们放在同一个线程中。）

仅当您有几乎完全独立于您当前正在做的事情的事情要做时，才开始一个新线程。一个例子是：你正在编写一个与多个用户或设备建立连接的服务器。由于每个用户或设备都以自己的速度工作，请求服务或响应来自服务器的问题，因此您可能希望创建一个线程来与每个用户或设备进行交互。这样，如果一个用户离开几分钟，所有其他用户都可以继续与他们的线程交互，而不会阻塞等待离开的用户。但是您为单个用户执行的服务按特定顺序进行（“用户要求 A，所以我查找 A，对其进行一些处理然后将其发送回用户”）所以不要分割您的服务为一个用户执行不同的线程。

# sql - 插入时，表上的 Sql 选择很慢

> ID：16026117
> 
> 赞同：3
> 
> 时间：2013-04-15T23:08:41.477
> 
> 标签：sql, select, indexing

我有一个后台作业（C# 控制台应用程序），它在 product_titleParts 表中连续插入数据。只需此作业从 products 表中选择前 100 个产品，将标题拆分为部分并插入到 product_titleParts 表中。

此表有一个名为“TitlePart”的索引列

另一方面，当我尝试从此表中进行选择时，SQL 查询需要很长时间。如果我在一段时间后停止控制台应用程序，查询需要 0 秒。一旦我再次启动控制台应用程序，再次选择查询无响应。

在插入另一个作业时从表中选择会导致任何缓慢？我在选择上使用 nolock 但没有帮助。

任何想法？

我在控制台应用程序上的代码：

```
if not exists(select 1 from product_titleParts where productid = @productid
and UserId = @userid and titlePart = @titlePart)
begin
insert into product_titleParts (userid, productid, titlePart)
VALUES (@userid, @productid, @titlePart)
end 
```

我的选择代码：

```
select productid from product_titleParts 
inner join products
on products.productid = product_titleParts.productid
where titlePart = @titlePart 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-18T22:29:19.910

另一方面，我在选择时插入“大量数据”时遇到了类似的问题（DB/2）

我的解决方案是什么：

插入物很昂贵，所以我把它们绑在一个块上，比如：

```
 insert into ...
 values ((a,b,c),(x,y,z), ... ) 
```

例如只锁定一次表。100 个插入和索引只重建一次

还有一点：当您插入（更新）许多行时，尝试以独占模式锁定表（取决于 DBMS）。您可以防止所谓的“锁定升级”

在 DB2 中你会使用

```
 lock table xyz in exclusive mode
   update/insert many rows
   unlock table xyz 
```

# windows - 如何决定是否在 Windows 中显示虚拟键盘？

> ID：16026124
> 
> 赞同：1
> 
> 时间：2013-04-15T23:09:10.303
> 
> 标签：windows, delphi, winapi, touch

如何自动决定是否在 Windows 中显示虚拟键盘？

我们正在我们的应用程序中添加对手势和虚拟键盘的支持，但是当我连接了真实键盘时不想看到虚拟键盘......

谢谢！

更新：RRUZ（他没有 win8 平板电脑）有一个有用的建议，但没有奏效，因为 win8 平板电脑的行为不符合预期。

```
To get the number of keyboards present in the system you can use the Win32_Keyboard WMI class.

Try this sample

{$APPTYPE CONSOLE}

uses
  SysUtils,
  ActiveX,
  ComObj,
  Variants;

function  GetKeyboardCount : integer;
var
  FSWbemLocator : OLEVariant;
  FWMIService   : OLEVariant;
  FWbemObjectSet: OLEVariant;
  FWbemObject   : OLEVariant;
  oEnum         : IEnumvariant;
  iValue        : LongWord;
begin;
  Result:=0;
  FSWbemLocator := CreateOleObject('WbemScripting.SWbemLocator');
  FWMIService   := FSWbemLocator.ConnectServer('localhost', 'root\CIMV2', '', '');
  FWbemObjectSet:= FWMIService.ExecQuery('SELECT DeviceID FROM Win32_Keyboard','WQL', $00000020);
  oEnum         := IUnknown(FWbemObjectSet._NewEnum) as IEnumVariant;
  while oEnum.Next(1, FWbemObject, iValue) = 0 do
  begin
    Inc(Result);
    FWbemObject:=Unassigned;
  end;
end;

begin
 try
    CoInitialize(nil);
    try
      Writeln(Format('Keyboards %d', [GetKeyboardCount]));
    finally
      CoUninitialize;
    end;
 except
    on E:EOleException do
        Writeln(Format('EOleException %s %x', [E.Message,E.ErrorCode]));
    on E:Exception do
        Writeln(E.Classname, ':', E.Message);
 end;
 Writeln('Press Enter to exit');
 Readln;
end. 
```

以我的经验，这在现实世界中无济于事：在我的 Win8 平板电脑上，设备管理器报告了一个 PS/2 键盘（！！），所以像这样的函数永远不会告诉你没有键盘。– 吉尔 9 小时前

# python - 维护大量电影/收视率列表中的顺序

> ID：16026128
> 
> 赞同：0
> 
> 时间：2013-04-15T23:09:25.687
> 
> 标签：python, bigdata

我有一个包含数十万学生的文本文件，以及他们对某些电影的评分，第一个词是学生编号，第二个是电影的名称（没有空格），第三个是他们给出的评分电影：

```
student1000 Thor 1
student1001 Superbad -3
student1002 Prince_of_Persia:_The_Sands_of_Time 5
student1003 Old_School 3
student1004 Inception 5
student1005 Finding_Nemo 3
student1006 Tangled 5 
```

我想将它们排列在字典中，以便将每个学生映射到他们的电影收视率列表，其中每个学生的收视率顺序相同。换句话说，我希望它是这样的：

```
{student1000 : [1, 3, -5, 0, 0, 3, 0,...]}
{student1001 : [0, 1, 0, 0, -3, 0, 1,...]} 
```

这样每个学生的第一、第二、第三等评级对应于相同的电影。电影和学生编号的顺序是完全随机的，我很难有效地做到这一点。想出一些可以最小化这个问题的大 O 复杂性的东西的任何帮助都会很棒。

**我最终弄清楚了。这是我为任何想知道的人使用的代码：**

```
def get_movie_data(fileLoc):
    movieDic = {}
    movieList = set()

    f = open(fileLoc)
    setHold = set()
    for line in f:
        setHold.add(line.split()[1])
    f.close()
    movieList = sorted(setHold)

    f = open(fileLoc)
    for line in f:
        hold = line.strip().split()
        student = hold[0]
        movie = hold[1]
        rating = int(hold[2])
        if student not in movieDic:
            lst = [0]*len(movieList)
            movieDic[student] = lst
        hold2 = movieList.index(movie)
        rate = movieDic[student]
        rate[hold2] = rating
    f.close()
    return movieList, movieDic 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:29:22.633

你可以先建立一个字典字典：

```
{
 'student1000' : {'Thor': 1, 'Superbad': 3, ...}, 
 'student1001' : {'Thor': 0, 'Superbad': 1, ...},
 ...
} 
```

然后你可以通过它得到所有电影的主列表，为它们建立一个顺序（对应于每个学生评分列表中的顺序），最后遍历字典中的每个学生，将字典转换为你的列表想。或者，就像另一个答案所说的那样，将其保存为字典。

[defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)可能会派上用场。它允许您说每个学生的默认值是一个空列表（或字典），因此您不必在开始附加值（或设置键值对）之前对其进行初始化。

```
from collections import defaultdict

students = defaultdict(dict)
with open(filename, 'r') as f:
    for line in f.readlines():
        elts = line.split()
        student = elts[0]
        movie = elts[1]
        rating = int(elts[2])
        students[student][movie] = rating 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:51:59.530

因此，这里的答案在功能上与您正在寻找的内容相同，但就直接构建您正在寻找的列表而言，它们似乎在回答略有不同的问题。就我个人而言，我更愿意以更动态的方式做到这一点。由于在我看来，您实际上并不知道将要提前评分的电影，因此您必须保持某种运行记录。

```
ratings = {}   
allMovies = [] 
    for line in file:
        info = line.split(" ")
        movie = info[1].strip().lower()
        student = info[0].strip().lower()
        rating = float(info[2].strip().lower())
        if movie not in allMovies:
            allMovies.append(movie)
        movieIndex = allMovies.index(movie)
        if student not in ratings:
            ratings[student] = ([0]*(len(allMovies)-1)).append(rating)
        else:
            if len(allMovies) > len(ratings[student]):
                ratings[student] = ratings[student].extend([0]*(len(allMovies)-len(ratings[student]))
            ratings[student][movieIndex] = rating 
```

这不是我解决这个问题的方式，但我认为这个解决方案最接近问题的初衷，如果存在内存问题，您可以使用缓冲区来输入行，但除非您的文件是多个千兆字节，否则应该这不是问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:21:29.473

只需将分数放入字典而不是列表即可。阅读完所有数据后，您可以提取电影名称并将它们按您想要的任何顺序排列。假设学生可以对不同的电影进行评分，在阅读文件时保持某种一致的顺序，而不知道电影开始的顺序，似乎需要做很多工作。

如果您担心键占用大量内存，`intern()`请在键上使用以确保您只存储每个字符串的一个副本。

# ipython - Windows 上的 Ipython 和 Curses

> ID：16026129
> 
> 赞同：0
> 
> 时间：2013-04-15T23:09:39.393
> 
> 标签：ipython, qtconsole

我一直在尝试各种试图将 GNU 功能移植到 Windows 的 sourceforge 项目，目的是创建一个非常了解 GNU 的 Ipython 配置文件，提供我所知道的最佳终端环境（在 Windows 上）。

QtConsole 与通过 IpyQt 前端运行类似 Curses 的能力有多接近？

（这里的关键是，我想要 QtConsole 的 DPI 感知富文本。将击败大多数 Windows 终端替代品。）

这种可能性甚至在眼前，还是那场比赛可能不会发生？我从来没有在业余时间模拟过 VT100，QtConsole 看起来有多像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T17:18:15.883

不，它不是真的在眼前。Qt 控制台对控制字符有一些支持，所以它可以做彩色文本之类的事情，但绝对不足以支持诅咒，而且我们对沿着这条路走下去并不真正感兴趣。

如果您想尝试将其变成完整的终端仿真器，则代码全部公开。但我更希望 Windows 中的终端仿真器有更好的起点。

# java - 填充数组时出现 NullPointerException

> ID：16026133
> 
> 赞同：3
> 
> 时间：2013-04-15T23:10:08.963
> 
> 标签：java, arrays, nullpointerexception

这是一个关于的问题`NullPointerException`，我想做的是为我的“pieces”数组中的每一块设置一个符号（该方法`setSymbol`存在，并且是一个`char`值）我知道默认情况下这是 null，但我该如何设置我的数组，如果我的“设置方法”不起作用？

我的代码尽可能简短

```
 Pieces[][] pzs = new Pieces[7][7];
    int i, j;

    for(i=0;i<8;i++){
        for(j=0;j<8;j++){
            pzs[i][j].setSymbol('X')
        }
    } 
```

我得到这个例外：

> 线程“主”java.lang.NullPointerException 中的异常

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T23:13:59.180

`Pieces[][] pzs = new Pieces[7][7]`制作一个 7 x 7 的数组，其中填充了空值：

```
{{null,null,null,null,null,null,null},
 {null,null,null,null,null,null,null},
 {null,null,null,null,null,null,null},
 {null,null,null,null,null,null,null},
 {null,null,null,null,null,null,null},
 {null,null,null,null,null,null,null},
 {null,null,null,null,null,null,null}} 
```

你想要做的是：

```
Pieces[][] pzs = new Pieces[7][7];
//no need for int i, j
for(int i = 0; i < pzs.length; i++){     //pzs.length guarantees you won't get an 
    for(int j = 0; j < pzs[i].length; j++){ //ArrayIndexOutOfBoundsException even if pzs is something different
        pzs[i][j] = new Pieces();
        pzs[i][j].setSymbol('X')
    }
} 
```

**编辑：**感谢 Vulpix 建议使用`pzs.length`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T23:12:44.127

您需要初始化每个`Pieces`. 在您的内部`for`循环中添加一行：

```
pzs[i][j] = new Pieces(); 
```

此外，您的数组将超出界限，要么声明更多，要么`Pieces`削减两个循环的 1 次迭代`for`。

# java - 为什么以 2 为底的值取模等于 &？

> ID：16026135
> 
> 赞同：-3
> 
> 时间：2013-04-15T23:10:21.823
> 
> 标签：java, algorithm, hashmap, bit-manipulation

它通常用于`java.util.HashMap`

```
/**
 * Returns index for hash code h.
 */
static int indexFor(int h, int length) {
    return h & (length-1);
} 
```

其中长度以 2 为底。

或者 Lucene 布隆过滤器代码 (org.apache.lucene.codecs.bloom.FuzzySet)

```
// Bloom sizes are always base 2 and so can be ANDed for a fast modulo
int pos = positiveHash & bloomSize; 
```

这对我来说没有意义，因为例如 8 和之间的差异`i % 8`不`i & 8`为零！

```
 scala> (0 to 20).map(i => (i & 8) - (i % 8))
res33: scala.collection.immutable.IndexedSeq[Int] = Vector(0, -1, -2, -3, -4, -5, -6, -7, 8, 7, 6, 5, 4, 3, 2, 1, 0, -1, -2, -3, -4) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:21:07.817

HashMap 和 FuzzySet 都不是精确的 2 次幂 - 它们使用的是整数形式`2^n - 1`。不幸的是，您从 FuzzySet 引用的评论在这方面具有误导性，但是如果您稍微挖掘一下，您可以找到以下代码块：

```
//The sizes of BitSet used are all numbers that, when expressed in binary form,
//are all ones. This is to enable fast downsizing from one bitset to another
//by simply ANDing each set index in one bitset with the size of the target bitset
// - this provides a fast modulo of the number. Values previously accumulated in
// a large bitset and then mapped to a smaller set can be looked up using a single
// AND operation of the query term's hash rather than needing to perform a 2-step
// translation of the query term that mirrors the stored content's reprojections.
static final int usableBitSetSizes[];
static
{
  usableBitSetSizes=new int[30];
  int mask=1;
  int size=mask;
  for (int i = 0; i < usableBitSetSizes.length; i++) {
      size=(size<<1)|mask;
      usableBitSetSizes[i]=size;
  }    
} 
```

FuzzySet 中的 bitsize 变量总是最终从这个数组中赋值的。这里的评论也准确地描述了正在发生的事情。

计算`X % 8 (1000)`就是计算`X & 7 (0111)`。这适用于 2 的所有幂。

# mysql - 根据 2 列（meta_key 和 meta_value）过滤 MySQL 语句

> ID：16026136
> 
> 赞同：0
> 
> 时间：2013-04-15T23:10:23.147
> 
> 标签：mysql, wordpress

我有以下 SQL 语句来计算基于 wp_postmeta、wp_post 和 wp_user 表的几个字段。我需要的是只包含结果，其中所有帖子都有 meta_key='key1' 和 meta_value >= '1.5'。我在下面的语句中尝试过，但它没有过滤，仍然显示每条记录。

任何帮助深表感谢！

```
SELECT (display_name) AS 'user',
    SUM(Case When meta_key = 'status' Then meta_value = 'won' else Null End) AS 'Won',
    SUM(Case When meta_key = 'status' Then meta_value = 'lost' else Null End) AS 'Lost',
    COUNT(Case When meta_key = 'odd' Then meta_value else Null End) AS 'Total',
    ROUND (AVG(Case When meta_key = 'odd' Then meta_value else Null End), 2) AS 'Avg odd',
    ROUND (AVG(Case When meta_key = 'bet' Then meta_value else Null End), 2) AS 'Avg bet',
    ROUND (SUM(Case When meta_key = 'balance' Then meta_value else Null End), 2) AS 'Balance'
FROM wp_postmeta pm
INNER JOIN wp_posts p ON pm.post_id = p.ID 
INNER JOIN wp_users u ON p.post_author = u.ID
WHERE Month(post_date) = MONTH(CURRENT_DATE) AND p.post_status='publish' 
GROUP BY (display_name)
HAVING SUM(CASE WHEN pm.meta_key='key1' AND pm.meta_value >='1.5' THEN 1 ELSE 0 END) > 0
ORDER BY Balance DESC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:17:40.730

我会多次加入帖子元表。这也应该利用索引来更快地返回查询。如果`u.ID`两个用户具有相同的`display_name`. 使用`$wpdb->posts`and`$wpdb->postmeta`是一个好主意，以防您更改数据库前缀，这对安全性来说是个好主意。

*请注意，这是未经测试的。*

```
SELECT 
    display_name user,
    IFNULL(SUM(won.meta_value),0) won,
    IFNULL(SUM(lost.meta_value),0) lost,
    IFNULL(COUNT(odd.meta_value),0) total,
    IFNULL(ROUND(AVG(odd.meta_value),2),0) avg_odd,
    IFNULL(ROUND(AVG(bet.meta_value),2),0) avg_bet,
    IFNULL(ROUND(SUM(balance.meta_value),2),0) balance
FROM {$wpdb->posts} p
JOIN {$wpdb->users} u 
    ON p.post_author = u.ID
JOIN {$wpdb->postmeta} odd 
    ON p.ID = odd.post_id AND odd.meta_key = 'odd'
LEFT JOIN {$wpdb->postmeta} won 
    ON p.ID = won.post_id AND won.meta_key = 'status' AND won.meta_value = 'won'
LEFT JOIN {$wpdb->postmeta} lost 
    ON p.ID = lost.post_id AND lost.meta_key = 'status' AND lost.meta_value = 'lost'
LEFT JOIN {$wpdb->postmeta} bet 
    ON p.ID = bet.post_id AND bet.meta_key = 'bet'
LEFT JOIN {$wpdb->postmeta} balance 
    ON p.ID = balance.post_id AND balance.meta_key = 'balance'
WHERE 
    MONTH(p.post_date) = MONTH(CURRENT_DATE) 
    AND p.post_status = 'publish'
GROUP BY u.ID
HAVING SUM(odd.meta_value) >= 1.5
ORDER BY balance DESC 
```

# java - 如何计算延迟

> ID：16026137
> 
> 赞同：6
> 
> 时间：2013-04-15T23:10:35.980
> 
> 标签：java, networking

我创建了一些 Java 代码来测量延迟、数据包大小和带宽。

计算延迟所需的方程式是什么？

这是我目前正在使用的，但不确定它是否正确：

```
//latency = packetsize / delay + bandwidth 
System.out.println("latency is " + (len*2) / (duration + transferRateMb)); 
```

编辑长度乘以 2 以给出正确的字节值

持续时间是 ping 完成所用的时间

传输率通过以下方式找到：

```
double transferRateMb = ((len*524288.0) / (duration/ 1000000000.0) ) ; //amount of data in megabytes transferred in 1 second. 
```

看了各种指南，没看懂，这只是一个项目的简单需求

这也将运行 20 次并取平均值

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T07:36:42.250

我总是测量延迟。平均延迟通常不是很有趣，您真正需要知道的是延迟有多糟糕，例如 100 分之一、1000 分之一或更糟的情况。为此，您需要测量每个单独的延迟并对其进行采样（或保持最大值）这将远远高于您的计算，例如它可能很容易达到 10 倍

简而言之，你无法计算你应该关心的延迟，你必须测量它。

# ssl - Io：不支持协议“https”

> ID：16026140
> 
> 赞同：5
> 
> 时间：2013-04-15T23:10:48.337
> 
> 标签：ssl, binding, openssl, cmake, iolanguage

我正在尝试通过 HTTPS 以[Io 语言](http://iolanguage.org/)获取文件：

```
url := URL with("https://api.example.com")
url fetch println 
```

我明白了：

```
 Error_0x7f97e1509a80:
  location         = "/opt/local/lib/io/addons/Socket/io/URL.io:232"
  message          = "Protocol 'https' unsupported" 
```

我试图在网上找到一些东西，但是众所周知，这并不容易，因为它的名字。我只找到了这个线程[http://tech.groups.yahoo.com/group/iolanguage/message/10898](http://tech.groups.yahoo.com/group/iolanguage/message/10898)但这已经很老了。

如何在 Io 中获得 HTTPS 支持？

**编辑**

我发现在 Io 的源代码中有一个 SecureSocket 插件，它是 OpenSSL 的包装器。不过，当我`sudo port io install`在装有 Mountain Lion 的 MacBook 上安装它时，它并没有安装。我尝试从源代码构建它，但没有运气。它也不是在 Linux 机器上为我构建的。

**编辑2**

我刚刚尝试`git clone https://github.com/stevedekorte/io.git`再次从源代码 () 构建 Io（使用包含的脚本`build.sh`），结果发现 cmake 确实检测到了 OpenSSL：

```
 -- Found OpenSSL: /usr/lib/libssl.dylib;/usr/lib/libcrypto.dylib 
```

但是没有构建 SecureSocket 插件。它的自述文件：[https](https://github.com/stevedekorte/io/tree/master/addons/SecureSocket) ://github.com/stevedekorte/io/tree/master/addons/SecureSocket说：

> 除非将此文件中的补丁应用于 OpenSSL 0.9.8e，否则 DTLS1 绑定不可用。但是，此补丁包括停用 d1_both.c 中的握手重传代码，使其不适合生产环境。我不承担任何责任，等等。如果你想使用它，请应用补丁（从各种新闻组和我自己的实验中收集）并取消注释 build.io 的注释掉的块。值得一提的是，OpenSSL 中的 DTLS 支持从 0.9.8 开始是新的，并且从一开始就非常错误。这是一个好主意，但它似乎还没有准备好生产。这些绑定也不例外。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T01:04:35.087

如果你不能让 io 去做，你最好的选择是调用一个外部工具，比如`wget`or `curl`which can 然后在本地加载文件/结果或通过管道返回它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T12:37:44.940

对于其他对另一种解决方法感兴趣的人，应该可以将[stud](https://github.com/bumptech/stud)放在将执行 SSL 工作的 Io 程序前面。我自己还没有测试过。

> stud - Scalable TLS Unwrapping Daemon stud 是一个网络代理，它终止 TLS/SSL 连接并将未加密的流量转发到某个后端。它的设计目的是在多核机器上有效地处理成千上万的连接。

# azure - Windows Azure 网站 maxQueryStringLength

> ID：16026142
> 
> 赞同：0
> 
> 时间：2013-04-15T23:10:57.113
> 
> 标签：azure, datatables

我正在尝试在 Azure 网站上使用带有一些附加功能的 jquery dataTables。它会生成一个相当大的查询字符串（测试中的 2121 个字符）。这会在 Azure 网站上返回错误代码（您要查找的资源已被删除、名称已更改或暂时不可用。）。

为了让它在本地工作，我用这个编辑了 web.config：

```
<httpRuntime maxQueryStringLength="4000" maxUrlLength="4000"/> 
```

（我相信只有 maxQueryStringLength 是真正需要的）。

无论如何，在本地和另一台服务器上一切都很好，但在 WA 网站上我无法让它工作。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-20T19:16:03.293

尝试自定义[IIS 请求过滤参数](http://www.iis.net/configreference/system.webserver/security/requestfiltering)。我怀疑您正在使用*Cassini*（Visual Studio 开发服务器）进行本地开发。

与查询字符串和/或 URL 最大长度相关的限制出现在 Azure 网站（或任何 IIS 环境）的两个级别：

*   *ASP.NET 运行时*`httpRuntime`：使用节点及其关联属性解除了这些限制
*   *IIS 请求过滤*模块：IIS 还应用自己的关于 URL 和查询字符串长度的过滤规则，甚至在 ASP.NET 运行时处理请求之前。默认情况下，查询字符串的最大允许长度为 2048（请参阅[此处](http://www.iis.net/configreference/system.webserver/security/requestfiltering/requestlimits)）。您应该在子节点`Web.config`下的, 中设置适当的值，例如：`requestLimits`

    ```
    <system.webServer>
      <security>
        <requestFiltering>
          <requestLimits maxQueryString="4096"/>
        </requestFiltering>
      </security>
    </system.webServer> 
    ```

另请参阅[此问题](https://stackoverflow.com/questions/11636386/how-to-configure-the-web-config-to-allow-requests-of-any-length)

# jquery - Pikachoose/Fancybox 集成 - 灯箱上的导航箭头

> ID：16026145
> 
> 赞同：6
> 
> 时间：2013-04-15T23:11:30.163
> 
> 标签：jquery, navigation, fancybox, integration, arrows

我正在使用 Fancybox 与 Pikachoose 的集成，如下所述： [http ://www.pikachoose.com/how-to-fancybox/](http://www.pikachoose.com/how-to-fancybox/)

我试图让灯箱显示下一个和上一个箭头，但不在 pikachoose 舞台上，我遇到了一些麻烦。我试图`showNavArrows: true`在脚本的 fancybox 部分添加选项，但它不起作用。所以然后我尝试了 pikachoose 上的导航选项来显示使用`this: {text: {previous: "Previous", next: "Next" }}` ，但我不断收到错误，可能我的语法没有放在正确的位置？有人可以帮忙吗？

这是我正在使用的代码：

```
$(document).ready(function () {
    var a = function (self) {
        self.anchor.fancybox({
            transitionIn: elastic,
            transitionOut: elastic,
            speedIn: 600,
            speedOut: 200,
            overlayShow: false
        });
    };
    $("#pikame").PikaChoose({
        showCaption: false,
        buildFinished: a,
        autoPlay: false,
        transition: [0],
        speed: 500,
        showCaption: false
    });
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T21:39:40.483

[http://www.pikachoose.com/how-to-fancybox/](http://www.pikachoose.com/how-to-fancybox/)中解释的方法的问题是您将 fancybox 绑定到当前*pikachoose*元素`self.anchor`。

使用这种方法，没有办法知道哪组图像将属于一个 fancybox 画廊（您需要多个元素共享相同的`rel`属性），因为只有一个*pikachoose*图像：每个图像都显示动态切换它`href`和容器内的`src`属性（`<a>`和`<img>`标签） 。`.pika-stage`

作为一种解决方法，您需要在将 html 结构绑定到*pikachoose***之前**构建 fancybox 元素组（*pikachoose*将修改 DOM 结构）

 **1）。所以有这个html结构：

```
 <div class="pikachoose">
    <ul id="pikame">
        <li>
           <a title="one" href="image01.jpg" id="single_1"><img alt="" src="thumb01.jpg" /></a>
        </li>
        <li>
           <a title="two" href="image02.jpg" id="single_2"><img alt="" src="thumb02.jpg" /></a>
        </li>
        <li>
           <a title="three" href="image03.jpg" id="single_3"><img alt="" src="thumb03.jpg" /></a>
        </li>
    </ul>
 </div> 
```

2）。使用此脚本创建遍历每个锚点的 fancybox 元素组：

```
var fancyGallery = []; // fancybox gallery group
$(document).ready(function () {

  $("#pikame").find("a").each(function(i){
    // buidl fancybox gallery group
    fancyGallery[i] = {"href" : this.href, "title" : this.title};
  });

}); // ready 
```

3）。然后将*pikachoose*绑定到同一个选择器`#pikame`。您可以使用该`.end()`方法在第一个减速选择器上执行此操作，而无需复制它；）

```
var fancyGallery = []; // fancybox gallery group
$(document).ready(function () {
  // build fancybox group
  $("#pikame").find("a").each(function(i){
      // buidl fancybox gallery
      fancyGallery[i] = {"href" : this.href, "title" : this.title};
  }).end().PikaChoose({
      autoPlay : false, // optional
      // bind fancybox to big images element after pikachoose is built
      buildFinished: fancy
   }); // PikaChoose
}); // ready 
```

**请注意**，我们使用了*pikachoose*选项`buildFinished: fancy`，当我们单击大图像时，它实际上会触发 fancybox 库。

4）。这是功能：

```
 var fancy = function (self) {
    // bind click event to big image
    self.anchor.on("click", function(e){
      // find index of corresponding thumbnail
      var pikaindex = $("#pikame").find("li.active").index();
      // open fancybox gallery starting from corresponding index
      $.fancybox(fancyGallery,{
        // fancybox options
        "cyclic": true, // optional for fancybox v1.3.4 ONLY, use "loop" for v2.x
        "index": pikaindex // start with the corresponding thumb index
      });
      return false; // prevent default and stop propagation
     }); // on click
  } 
```

**请注意**，我们`click`使用`.on()`（需要 jQuery v1.7+）将事件绑定到*pikachoose*元素`self.anchor`，以使用手动方法触发 fancybox 库`$.fancybox([group])`。

此解决方法同样适用于 fancybox v1.3.4 或 v2.x。请参阅使用 v1.3.4 的**[演示](http://www.picssel.com/playground/jquery/fancyboxPikaChoose_16apr13.html)**，即使使用 IE7 似乎也可以正常工作；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-23T10:41:40.957

JFK 的反应很好，但有一些地方需要纠正：

如果在 Pikachoose 中启用了轮播，使用此方法计算的索引会给您一个无效的索引，因为 pikachoose 将通过附加现有`li`的 in来操作 DOM `ul`：

```
var pikaindex = $("#pikame").find("li.active").index(); 
```

解决方案 ：

```
function getCurrentIndex(fancyGallery) {
    var activeLi = $(""#pikame").find("li.active");
    if (activeLi.length != 1) {
        console.error('(getCurrentIndex) - only one image must have an active class set by Pikachoose');
        return -1;
    }

    var activeLiHtml0   = activeLi[0];
    var activeHref      = $(activeLiHtml0).find('img').attr('src');                 // do not look for <a> tags, PikaChoose will remove them
    if (activeHref === null || activeHref.length == 0) {
        console.error('(getCurrentIndex) - can not get href attribute from selected image');
        return -1;
    }

    for (var i=0 ; i<fancyGallery.length ;i++) {
        var obj = fancyGallery[i];
        if (obj.href.indexOf(activeHref) >= 0){
            console.debug('(getCurrentIndex) - found index: ' + i);
            return i;
        }
    }

    console.error('(getCurrentIndex) - this href: <' + activeHref + '> was not found in configured table');
    return -1;
}; 
```**

# java - 如何生成 -1/2 到 1/2 之间的随机值

> ID：16026149
> 
> 赞同：3
> 
> 时间：2013-04-15T23:11:51.283
> 
> 标签：java, math, random

我试图找出一种方法来生成 1/2 和 -1/2 之间的随机值。

我尝试了以下方法，但不确定这是否是正确的方法......

有人可以让我知道实现这一点的好方法吗？

```
public static void main(String args[]) {
        double Max = .5;
        double Min = -0.5;
        for (int i = 0; i < 10000; i++) {
            double value = Min + ((Math.random()) * (Max - Min));
            System.out.println(value);
        }
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T23:13:16.397

Well返回and[`Math.random()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Math.html#random%28%29)之间的随机双精度数，因此要将范围更改为to ，我们可以减去（因为and ）：`0``1``-1/2``1/2``1/2``0 - 1/2 = -1/2``1 - 1/2 = 1/2`

```
Math.random() - 0.5 
```

* * *

你现在所做的更一般，即如果你想要一个 double between`min`并且`max`适当的表达式是

```
min + Math.random() * (max - min) 
```

在这种情况下，插入，`min = -0.5`我们`max = 0.5`有

```
-0.5 + Math.random() * (0.5 - -0.5) 
```

这简化为

```
Math.random() - 0.5 
```

* * *

我还应该提到，如果您阅读该`random()`方法的文档，您会发现它返回一个*大于或等于*0.0 且*小于*1.0 的 double。这意味着上面的表达式应该产生一个范围内的数字`[-0.5, 0.5)`，这意味着`-0.5`可能会返回但`0.5`不能。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-15T23:12:47.393

你可以这样做：

```
Math.random() - 0.5 
```

这是因为 的最小值`Math.random()`为 0，最大值为 1。如果减去一半，则最小值为`0 - 0.5 == -0.5`，最大值为`1 - 0.5 == 0.5`。

因此，您的原始代码可以缩短为：

```
public static void main(String args[]) {
    for (int i = 0; i < 10000; i++) {
        double value = Math.random() - 0.5; // no need for a "double" cast,
                                            // Math.random() returns a double
        System.out.println(value);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T23:17:27.060

请记住，Math.Random() 类将返回一个介于 0 和 1 之间的值，不包括 1。

在这种情况下，`Math.Random()-0.5`会很好地工作

# vba - 删除 VBA 中的所有重复行

> ID：16026152
> 
> 赞同：0
> 
> 时间：2013-04-15T23:12:13.760
> 
> 标签：vba, excel, duplicates

我正在寻找如何使用 VBA 宏删除所有重复的行（当第一列中存在重复时）。

目前 Excel 宏会删除除第一个实例之外的所有重复实例，这完全不是我想要的。我要绝对删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T05:38:13.810

为快速晨练做了一个更短的解决方案：

```
Sub quicker_Option()

    Dim toDel(), i As Long
    Dim RNG As Range, Cell As Long
    Set RNG = Range("a1:a19") 'set your range here

    For Cell = 1 To RNG.Cells.Count
        If Application.CountIf(RNG, RNG(Cell)) > 1 Then
            ReDim Preserve toDel(i)
            toDel(i) = RNG(Cell).Address
            i = i + 1
        End If
    Next
    For i = UBound(toDel) To LBound(toDel) Step -1
        Range(toDel(i)).EntireRow.Delete

    Next i

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:01:33.767

存储第一个实例的单元格以供以后删除。然后去删除重复直到结束。

```
Dim F as integer, S as integer   'indices for First and Second cells to be compared
Dim Deleted as boolean         'indicates if second line was deleted
Dim First as Range, Second as Range   'First and second cells to be compared
Dim Start as string                   'Indicates the position of the first cell's start

Start = "A1"   'can be as you like
Set First = Sheet1.Range(Start)  'Sets the start cell

F = 0          '
Do While First.Value <> ""    'loop while sheet contains data in the column 
    S = F + 1                 'second cell is at least 1 cell below first cell
    Deleted = false           'no second cell was deleted yet
    Set Second = First.Offset(S,0)      'second cell is an offset of the first cell

    Do While Second.Value <> ""       'loop while second cell is in sheet's range with data
        if Second.Value = First.Value then    'if values are duplicade
            Second.EntreRow.Delete              'delete second cell
            Deleted = true                       'stores deleted information
        else                                'if not, second cell index goes next
            S = S + 1;
        end if

        Set Second = First.Offset(S, 0)      'sets second cell again (if deleted, same position, if not deleted, next position
    Loop

    if Deleted then         'if deleted, should delete first cell as well
        First.EntireRow.Delete
    else
        F = F + 1           'if no duplicates found, first cell goes next
    end if

    Set First = Sheet1.Range(Start).Offset(F,0)     'sets first cell again (if deleted, same position, if not, next)
Loop 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T12:57:52.650

我正在使用此代码创建总帐控制帐户的自动对帐，如果任何具有相同值但符号相反的单元格被剪切到表 2；因此只剩下对帐项目。

编码：

```
sub    autoRecs()
dim i as long
Application.ScreenUpdating = False
Application.StatusBar = True
Dim i As Long
Cells(5, 6).Select
Dim x As Long
Dim y As Long
x = ActiveCell.Row
y = x + 1
Do Until Cells(x, 6) = 0
Do Until Cells(y, 6) = 0
Application.StatusBar = "Hey Relax! You can rely on me......"
If Cells(x, 6) = Cells(y, 6) * -1 Then
Cells(x, 6).EntireRow.Cut (Worksheets(2).Cells(x, 6).EntireRow)
Cells(y, 6).EntireRow.Cut (Worksheets(2).Cells(y, 6).EntireRow)
Cells(x, 6).Value = "=today()"
Cells(y, 6).Value = "=today()"
Else
y = y + 1
End If
Loop
x = x + 1
y = x + 1
Loop
Application.StatusBar = False
End Sub

Sub deleteBlankCells()`this is to delete unnecessary cells after run the above macro`
Range(Cells(5, 1), Cells(Rows.Count, 1).End(xlUp)).Select
For i = Selection.Rows.Count To 1 Step -1 
Application.StatusBar = "OOH! I'm cleaning all the blanks for you....."
If WorksheetFunction.CountA(Selection.Rows(i)) = 0 Then
Selection.Rows(i).EntireRow.Delete
End If
Next i
Application.StatusBar = False
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-07-21T02:08:23.243

我喜欢在 VBA 中使用数组，所以这里有一个例子。

*   假设数据代表 A1 周围的当前区域，但这很容易改变
*   将源数据读入数组
*   检查第一列中的每个项目以确保它是唯一的（该项目的计数 = 1）
*   如果唯一，则将相应的行号添加到 Collection
*   使用集合的大小和列数对结果数组进行调暗。
*   循环遍历集合，将相应的行写入结果数组。
*   将结果数组写入工作表。

如所写，结果放置在源数据的右侧，但也可以替换它，或放置在不同的工作表上。

```
Option Explicit
Sub RemoveDuplicatedRows()
    Dim vSrc As Variant, vRes() As Variant
    Dim rSrc As Range, rRes As Range
    Dim colUniqueRows As Collection
    Dim I As Long, J As Long

'assume data starts in A1 and represented by currentregion
Set rSrc = Range("a1").CurrentRegion
vSrc = rSrc

Set rRes = rSrc.Offset(0, UBound(vSrc, 2) + 2)

'get collection of non-duplicated rows
Set colUniqueRows = New Collection
For I = 1 To UBound(vSrc)
    If WorksheetFunction.CountIf(rSrc.Columns(1), vSrc(I, 1)) = 1 Then _
        colUniqueRows.Add I
Next I

'Make up results array
ReDim vRes(1 To colUniqueRows.Count, 1 To UBound(vSrc, 2))
For I = 1 To UBound(vRes, 1)
    For J = 1 To UBound(vSrc, 2)
        vRes(I, J) = vSrc(colUniqueRows(I), J)
    Next J
Next I

rRes.EntireColumn.Clear
rRes.Resize(UBound(vRes)) = vRes

End Sub 
```

# c++ - 如何在 Visual Studio 2012 C++ 中暂时隐藏和取消隐藏大量评论？

> ID：16026161
> 
> 赞同：5
> 
> 时间：2013-04-15T23:12:52.247
> 
> 标签：c++, visual-studio-2012, comments

有时我需要在 Visual Studio 2012 中隐藏很多显示代码 C++ 的注释。是否可以通过单击一两次来完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:16:24.747

如果你有一个注释*块*，那么块的左上角应该有一个“-”（减号）符号，可以让你折叠它：

```
/*        <---- Collapse button to the left of this
Comment
block.
*/ 
```

如果你想做更多的事情（例如隐藏所有评论），那么我不知道有任何内置方法可以做到这一点，但你可能想看看这个声称可以做到这[一点的附加组件](http://holyhoehle.wordpress.com/2010/01/17/hide-comments-in-visual-studio/).

根据[this answer](https://stackoverflow.com/a/8696645/1227469)所有插件所做的就是将评论的颜色更改为与您的背景颜色相同，因此手动或通过您自己的宏/插件应该很容易实现结果（如果您无法获得该链接上的一个适用于您的VS版本）。这让我觉得这是一个相当不雅的解决方案（您将在评论所在的地方拥有*看似*（但不是）空白，这可能很容易意外删除它们），但它可能适合您的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:16:52.323

在评论部分的顶部附近应该有一个减号按钮，它将代码缩小到一行。单击出现的加号图标将再次显示评论。

同样，这可用于大括号中的函数或代码段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-11T16:31:05.210

我遇到了同样的问题，但在 VS Code 中。对不起，不相关的答案，但我希望它为某人提供价值。

VS Code 具有折叠所有块注释的选项。在 Ubuntu 中，键盘快捷键是 Ctrl + K、Ctrl + /。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-06-08T22:12:08.417

[http://visualstudiogallery.msdn.microsoft.com/03141ea7-c35e-4533-b05b-9e60545e93eb](http://visualstudiogallery.msdn.microsoft.com/03141ea7-c35e-4533-b05b-9e60545e93eb)

这个插件似乎在评论显示方面做得很好。

# java - 寻找 Java 7 本机代理演示，专门用于 Mac 或 Linux

> ID：16026165
> 
> 赞同：0
> 
> 时间：2013-04-15T23:13:08.193
> 
> 标签：java, native, agents

几年前我曾经使用 Java 本地代理，现在我又回到了这个问题上。我在想……他们怎么了？

在 jdk1.6/demo/jvmti 目录中有示例，但是在 Java 7 中，似乎没有演示目录。他们发生了什么？

无论如何，我找到了 1.6 演示（在 windows 上），我正在尝试使用 jdk 1.6 在 linux 和 mac 上编译它们。mac 没有示例 makefile 示例，因此这是我最需要帮助的示例。有没有办法使用 jdk 1.6 编译本机代理？jdk 1.7怎么样？

在 linux 上，我以某种方式让代理使用 jdk 1.6 进行编译，但依赖于 java_crw_demo 代码的代理似乎不起作用。我想我可能错误地编译了它们。

有问题的演示是：

*   代理工具
*   gctest
*   堆跟踪器
*   堆查看器
*   教授
*   java_crw_demo
*   部长
*   跟踪
*   版本检查
*   服务员

无论如何，关于代理的谷歌搜索似乎暗示代理仍在与 jdk 1.7 一起使用，但似乎没有曾经的示例支持。Oracle 是否试图限制（或终止）代理？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:13:47.910

JVMTI 演示可能会或可能不会与您的 JDK 安装捆绑在一起，这取决于您从哪里获得它。它们在 OpenJDK 安装中不存在（afaict）。但无论如何，在所有情况下都可以从[Oracle 下载页面](http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html)获得演示。下载[Mac 的压缩包](http://download.oracle.com/otn-pub/java/jdk/7u17-b02-demos/jdk-7u17-macosx-x86_64-demos.tar.gz)，将其展开到一个目录，然后浏览它。

在相关文件夹`jdk1.7.0_10/demo/jvmti`中，您将找到以下演示：

> drwxr-xr-x@ 5 tuoyo 员工 170 Nov 29 19:30 compiledMethodLoad
> drwxr-xr-x@ 5 tuoyo 员工 170 Nov 29 19:30 gctest
> drwxr-xr-x@ 6 tuoyo 员工 204 Nov 29 19:30 heapTracker
> drwxr- xr-x@ 5 tuoyo 员工 170 Nov 29 19:30 heapViewer
> drwxr-xr-x@ 5 tuoyo 员工 170 Nov 29 19:30 hprof
> drwxr-xr-x@ 6 tuoyo 员工 204 Nov 29 19:30 minst
> drwxr-xr- x@ 6 tuoyo 员工 204 Nov 29 19:30 mtrace
> drwxr-xr-x@ 5 tuoyo 员工 170 Nov 29 19:30 versionCheck
> drwxr-xr-x@ 5 tuoyo 员工 170 Nov 29 19:30 服务员

每个单独的演示都有一个包含代码的源 ZIP 文件和一个示例生成文件。您很可能需要调整 makefile 以使构建在您的目标系统上工作。

附带说明一下，您可能想查看[Java Instrumentation API](http://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html)，因为它包装了 JVMTI 并提供了更方便的接口。

# python - 如何使用 python 将大型数据集解析为 CSV 文件？

> ID：16026166
> 
> 赞同：0
> 
> 时间：2013-04-15T23:13:08.600
> 
> 标签：python, csv, space, delimited

我有一个大的 .dat 文件（3gigs），其中包含用空格分隔的值。这是第一行的样子：

```
 S       201001        7            2                2                             30105                                            2  011    06   1  123                         3405   1   06  01           2    2                                      0321          1006  314           2000                                     2   222                   2 2               2     2  2          122222 11      3    094     1            M 04  200940   39072       3941    083                              22       2    2  2 2                                             110 110 00   0000000    00      000000000 000000  000      000000000000000000011                  101              1   111            1 0      1     1  1        111111                11       1    1  1 1 
```

我有一个备忘单，其中提到了列名和它们的值的位置。例如：姓名 15-18、年龄 55-56 等。

所以，我是 python 的新手，我的问题是如何使用 python 解析这个大型数据集并将其保存到一个 CSV 文件中，顶部是列名，下面是值。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:19:50.833

I would advise you against doing it in Python. I needed to perform similar operations for a migration and I eventually ran Sed from my Python scripts. I can assure you that investing a little time learning how to use Sed will pay off. [http://www.grymoire.com/Unix/Sed.html](http://www.grymoire.com/Unix/Sed.html) If you are on Unix it's probably already there, if you are on Windows, you can get Cygwin.

# javascript - 使用 localStorage 保存 ajax 响应，然后用作对象

> ID：16026167
> 
> 赞同：2
> 
> 时间：2013-04-15T23:13:10.490
> 
> 标签：javascript, jquery, ajax, json, local-storage

您好有以下 Ajax 请求，该请求从服务器获取 JSON 并将 json 存储在我可以在我的应用程序中使用的 localStorage 中。看起来我的代码实现这一点根本没有效率，但我无法让它以任何其他方式工作。我曾尝试存储为一个对象，但它似乎想要存储为一个字符串。

有一个更好的方法吗？

```
//GET Users List from Server
function getUsersList() {
    $.ajax({
        url: "api/ListUsers",
        dataType: "json",
        success: function (e) {

            localStorage.UsersList = (JSON.stringify(e));
            var usersList = localStorage.UsersList;
            var usersList = $.parseJSON(usersList)
            console.log(usersList[0])
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:35:57.083

您只能将字符串存储在 中`localStorage`，但是您可以在可重用函数中创建序列化/反序列化过程的抽象。

看看[在 HTML5 localStorage 中存储对象](https://stackoverflow.com/questions/2010892/storing-objects-in-html5-localstorage)

另外，推荐使用`setItem`and`getItem`方法。

# android - android的多个标记错误：提示

> ID：16026170
> 
> 赞同：0
> 
> 时间：2013-04-15T23:13:34.880
> 
> 标签：android, android-edittext

我正在尝试学习android，我在用户输入方面遇到问题我使用editText让用户输入日期和电子邮件，这一切都很好，然后我为这些字段添加了一个提示，如下所示：android：hint = "@+字符串/DD/MM/YY"

```
android:hint="@+string/example@example.co.uk" 
```

我在生成的文件中遇到多个标记错误：/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:16:53.627

我认为您不能在字符串名称中使用特殊字符。给它一个有意义的名字，比如`support_email`. [您可以在此处](http://developer.android.com/guide/topics/resources/string-resource.html)找到更多信息。

# java - 返回以特定字母开头的单词

> ID：16026171
> 
> 赞同：0
> 
> 时间：2013-04-15T23:13:35.983
> 
> 标签：java

我被分配从一个以特定字母开头的数组列表中返回单词，但是我选择了字母 c；有人告诉我，我可以用另一种方式做到这一点，除了专门返回以带有许多 println 的字母开头的每个元素之外，我不知道除了使用 ArrayList 的startswith 方法之外还能如何做到这一点，有人愿意启发我吗？

```
public static ArrayList<String> letterC(ArrayList<String> list)
{
    ArrayList<String> animals = new ArrayList<String>();
    ArrayList<String> letterC = new ArrayList<String>();
    String sweet = "c"; 
    animals.add("cape");
    animals.add("dog");
    animals.add("cougar");
    animals.add("moon");
    animals.add("conor");
    animals.add("bob");
    animals.add("tiger");
    animals.add("sun");
    for(int i = 0; i<animals.size(); i++) {
        if(animals.get(i).startsWith(sweet.toUpperCase())) {
            letterC.add(animals.get(i));
        }
        if(animals.get(i).startsWith(sweet)) {
            letterC.add(animals.get(i));
        }
    }
    if(letterC.size() >= 1) {
        letterC.remove(1);
        letterC.remove(letterC.size() - 1);
    }
    return letterC;
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:30:54.407

这应该适合你。

```
 for(int i = 0; i<animals.size(); i++) {
    if(animals.get(i).substring(0,1).equalsIgnoreCase(sweet)) {
        letterC.add(animals.get(i));
    } 
```

# c# - 替换正在添加到字符串的末尾

> ID：16026172
> 
> 赞同：-2
> 
> 时间：2013-04-15T23:13:45.267
> 
> 标签：c#, replace

我正在尝试做一个简单的替换。我的问题是，它似乎没有替换字符串，而是抓住了最后几个字符并将它们附加到末尾。

```
public static Dictionary<string, string> dict = new Dictionary<string, string> {
{"1", @"\\id 1ch\n fjdsbfjdshfd"},
{"2", @"\\id 1co\n fjdsbfjdshfd"},
{"3", @"\\id 1th\n fjdsbfjdshfd"}
};

public static string bookNameFn(string line)
{
    return line.Split(' ')[1].ToLower().Replace("1ch", "1Chr").Replace("1co", "1Cor").Replace("1th", "1Thess");
}

foreach (KeyValuePair<String, String> usfm in dict)
{
    foreach (var line in usfm.Value.Split('\n'))
    {
        if (line.StartsWith("\\id "))
        {
            Console.WriteLine(bookNameFn(line));
        }
    }
} 
```

输出

```
1Chrr
1Corr
1Thessess 
```

期望的输出

```
1Chr
1Cor
1Thess 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:22:29.953

使用文字符号，例如

```
@"\id 1th\n fjdsbfjdshfd"; 
```

它会起作用，问题是通过字符串构造函数解释值的方式。

# jquery - 多次执行淡入淡出回调中的jQuery ajax请求

> ID：16026174
> 
> 赞同：0
> 
> 时间：2013-04-15T23:13:56.983
> 
> 标签：jquery, jquery-callback, fadeout

这是我的 HTML 的外观：

```
 <ul id="list">
            <li><a href="#one">One</a></li>
            <li><a href="#two">Two</a></li>
            <li><a href="#three">Three</a></li>
    <ul> 
```

这是我的 jQuery：

```
 $("#list li").fadeOut(600, function(){
        $.ajax({
            type: "POST",
            url: "includes/functions/ajax.php",
            data: { id: id },
            dataType: "json",
            })
        .done(function(data){
            otherFunction(data);
        });         
    }); 
```

所以，我试图隐藏列表元素，然后运行 ​​ajax 请求。但问题是由于某种原因，ajax 请求执行了 3 次。如果我删除淡入淡出功能，请求会正确执行（仅一次），因此可能运行的次数与列表中的项目一样多，我觉得这很奇怪。那可能吗？你能帮我找出解决办法吗？我真的需要仅在fadeOut 函数完成时才执行该ajax 请求。

我希望我说清楚了，如果我弄乱了我的英语，我深表歉意。

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T23:21:47.037

`complete`为集合中的每个元素调用标准动画回调。

如果您使用[`.promise()`](http://api.jquery.com/promise/)，您可以排队一个回调，该回调将等待给定集合上的*所有*动画完成：

```
$('#myList li').fadeOut('slow', function() {
    console.log('per element');
}).promise().done(function() {
    console.log('all elements');
}); 
```

[http://jsfiddle.net/alnitak/cLv8X/](http://jsfiddle.net/alnitak/cLv8X/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:18:11.537

问题是你的选择器引用了 3 个元素，所以回调被执行了 3 次（每个元素淡出一个） 这是一个[演示](http://jsfiddle.net/55XTq/)来看看这个

```
<ul>
  <li>One
  <li>Two
  <li>Three
<script>
 $('li').fadeOut(600, function() {
   console.log('Faded');
 });
</script> 
```

您可以尝试在整个列表上调用淡出，如下所示：

```
$("#list") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T23:19:23.260

它执行 3 次是正常的，因为它会`fade-out`为每个`li`已淡出的处理程序调用处理程序。你可以做的是跟踪有多少`li`必须淡出，一旦它们全部淡出，就可以进行 ajax 调用。

```
var $listEls = $("#list li"),
    listElsCount = $listEls.length,
    fadedListElsCount = 0;

$listEls.fadeOut(600, function(){
    if (++fadedListElsCount !== listElsCount) {
         return;
    }
    $.ajax({
        type: "POST",
        url: "includes/functions/ajax.php",
        data: { id: id },
        dataType: "json",
    }).done(function(data){
        otherFunction(data);
    });         
}); 
```

您也可以简单地淡出整个列表。

```
$("#list").fadeOut(600, ...); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-22T22:37:50.797

这是一个非常好的方法，可以将其修补为仅使用多个 jQuery 调用运行一次

```
$('#1stID, #2ndID').fadeOut(350).promise().done(() => {
   //Do your thing that you only want to run once.
}); 
```

# custom-fields - 在精细上传器中为每个文件添加字段

> ID：16026176
> 
> 赞同：0
> 
> 时间：2013-04-15T23:14:07.877
> 
> 标签：custom-fields, fine-uploader

第一次尝试实现 Fine-Uploader。

有一种方法可以为每个待上传的文件添加一个文本字段？我希望用户评论每个文件的内容，然后保存这些信息。

感谢您的解释。达里奥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T02:20:15.043

如果您想在 UI 中表示的每个文件旁边添加一个输入文本字段（我假设您使用的是 FineUploader 模式），您可以执行以下操作：

1.  将[`autoUpload`选项](http://docs.fineuploader.com/integrating/options/fineuploaderbasic.html#fineuploaderbasic-mode-options)设置为 false。这似乎很明显，但我想我还是应该列出它。如果您不将此设置为 false，则文件将在用户选择后立即上传。我猜这不适合您的工作流程。

2.  定义一个[`onSubmitted`回调处理程序](http://docs.fineuploader.com/api/callbacks.html#list-of-callbacks)。在此处理程序中，您可以使用`id`参数获取相关[`getItemByFileId`API 方法](http://docs.fineuploader.com/api/fineuploader.html#fineuploader-mode-api-functions)上的处理程序。

3.  在 UI 中拥有代表文件的元素后，您可以在其旁边添加一个输入字段。也许您应该添加一个数据属性或一个 css 类，以后可以使用它们将该字段与文件相关联。

4.  我假设您打算创建一个按钮，用户在准备开始上传所有选定文件时单击该按钮，大概是在他们填写了与这些文件关联的任何文本字段之后。因此，您可以向此按钮添加一个调用[`uploadStoredFiles`API 方法](http://docs.fineuploader.com/api/fineuploaderbasic.html#fineuploaderbasic-mode-api-functions)的单击处理程序。

5.  您还需要提供一个[`onUpload`回调处理程序](http://docs.fineuploader.com/api/callbacks.html#list-of-callbacks)。当您的处理程序被调用时（每个文件一次，在上传之前），从关联的文本字段中获取值，然后使用[`setParams`API 方法](http://docs.fineuploader.com/api/fineuploaderbasic.html#fineuploaderbasic-mode-api-functions)将该值与该文件的上传 (POST) 请求作为参数一起发送。调用时不要忘记将文件 ID 作为最后一个参数包含在内`setParams`。

# python - 使用 Pandas read_csv 下载国库数据

> ID：16026181
> 
> 赞同：0
> 
> 时间：2013-04-15T23:14:34.793
> 
> 标签：python, csv, pandas

我正在尝试使用 Pandas read_csv从此[页面下载国库数据。](http://www.federalreserve.gov/releases/h15/data.htm)

```
url = "http://www.federalreserve.gov/datadownload/Output.aspx?rel=H15&series=bcb44e57fb57efbe90002369321bfb3f&lastObs=&from=&to=&filetype=csv&label=include&layout=seriescolumn"
res = requests.get(url)
csvio = StringIO(res.content)
dataframe = pd.read_csv(csvio, header=5, index_col=0, parse_dates=True)

columns_dic = {"RIFLGFCY10_N.B":'BC_10YEAR'}
dataframe = dataframe.rename(columns=columns_dic)

print (dataframe.head()) 
```

输出对我来说有点奇怪：

```
 BC_10YEAR
Time Period          
1962-01-02       4.06
1962-01-03       4.03
1962-01-04       3.99
1962-01-05       4.02
1962-01-08       4.03 
```

我不明白为什么在打印时标题会分成两行。另外，我不清楚日期是否被正确解析。有没有办法可以修复我对 read_csv 的调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:36:08.613

由于您的`index_col=0`论点，标题被拆分。尝试不使用索引列

```
In [20]: dataframe = read_csv(csvio, header=5, index_col=None, parse_dates=True)

In [21]: dataframe
Out[21]: 
<class 'pandas.core.frame.DataFrame'>
Int64Index: 13379 entries, 0 to 13378
Data columns:
Time Period       13379  non-null values
RIFLGFCY10_N.B    13379  non-null values
dtypes: object(2)

In [22]: dataframe.head()
Out[22]: 
  Time Period RIFLGFCY10_N.B
0  1962-01-02           4.06
1  1962-01-03           4.03
2  1962-01-04           3.99
3  1962-01-05           4.02
4  1962-01-08           4.03 
```

并且来自 StringIO 对象的第一列数据成为 DataFrame 中的一列，而不是成为索引。

# c++ - GCC 警告函数指针指向对象指针转换

> ID：16026183
> 
> 赞同：11
> 
> 时间：2013-04-15T23:14:36.037
> 
> 标签：c++, gcc, c++11, mingw, gcc-pedantic

在一般意义上，函数指针和对象指针之间的明确转换是未定义的行为，但 POSIX（参见：[*dlsym*](http://pubs.opengroup.org/onlinepubs/009695399/functions/dlsym.html)）和 WinAPI（参见：[*GetProcAddress*](http://msdn.microsoft.com/en-ca/library/windows/desktop/ms683212(v=vs.85).aspx)）需要这样做。

鉴于此，并且鉴于此类代码无论如何都针对特定于平台的 API 的事实，它对函数指针和对象指针不兼容的平台的可移植性实际上是无关紧要的。

但是*-Wpedantic*无论如何都会警告它，并且`#pragma GCC diagnostic ignored "-Wpedantic"`没有效果：

```
warning: ISO C++ forbids casting between pointer-to-function and pointer-to-object [enabled by default] 
```

我想保持启用*-Wpedantic*，因为它确实给出了很好的警告，但我不想让真正的警告和错误丢失在关于函数指针到对象指针转换的不相关警告的海洋中。

有没有办法做到这一点？

在 Windows (MinGW) 上运行 GCC 4.8.0：

```
gcc (rubenvb-4.8.0) 4.8.0 
```

**代码示例**

```
#include <windows.h>
#include <iostream>

int main (void) {

    std::cout << *reinterpret_cast<int *>(GetProcAddress(LoadLibraryA("test.dll"),"five")) << std::endl;

} 
```

发射（使用*-Wpedantic*）：

```
warning_demo.cpp: In function 'int main()':
warning_demo.cpp:7:87: warning: ISO C++ forbids casting between pointer-to-funct
ion and pointer-to-object [enabled by default]
  std::cout << *reinterpret_cast<int *>(GetProcAddress(LoadLibraryA("test.dll"),
"five")) << std::endl;

       ^ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T23:49:15.700

我想你可以在这里使用 g++ 的`system_header`指令：

wrap_GetProcAddress.h：

```
#ifndef wrap_GetProcAddress_included
#define wrap_GetProcAddress_included

#pragma GCC system_header

template <typename Result>
Result GetProcAddressAs( [normal parameters] )
{
    return reinterpret_cast<Result>(GetProcAddressAs( [normal parameters] ));
}

#endif 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T00:07:07.970

这工作正常。

```
template <typename RESULT, typename ...ARGS>
void * make_void_ptr(RESULT (*p)(ARGS...)) {
    static_assert(sizeof(void *) == sizeof(void (*)(void)),
                  "object pointer and function pointer sizes must equal");
    void *q = &p;
    return *static_cast<void **>(q);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T23:27:08.330

总有你可以使用的 memcpy 技巧：

```
int (*f)() = 0;
int *o;
memcpy(&o, &f, sizeof(int*)); 
```

您可以在 ideone: [`m`is generate warnings, while `g`is OK](http://ideone.com/rYa2r5)上看到它。

至于您可能想要采取的其他措施：一种明显的可能性是“修复”定义`dlsym`为实际返回函数指针（如`void (*)()`）的标头。祝你好运。

# android - 在另一个方法中调用方法？

> ID：16026184
> 
> 赞同：0
> 
> 时间：2013-04-15T23:14:40.093
> 
> 标签：android, class, methods

嗨，我试图从 ScreenReceiver 类调用我的 mainactivity 中的方法。我发现了这一点并将其实现到我的代码中。

主要活动：

```
public class MainActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        // ScreenRecv
        IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);
        filter.addAction(Intent.ACTION_SCREEN_OFF);
        BroadcastReceiver mReceiver = new ScreenReceiver();
        registerReceiver(mReceiver, filter);
    }

    // Toast(String)
    public void Toast(String text) {
        Toast.makeText(MainActivity.this, "" + text, Toast.LENGTH_SHORT).show();
    }
} 
```

屏幕接收器：

```
package com.wifitimer;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class ScreenReceiver extends BroadcastReceiver {
    public static boolean wasScreenOn = true;

    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(Intent.ACTION_SCREEN_OFF)) {
            new MainActivity().Toast("Screen Off");
            wasScreenOn = false;
        } else if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)) {
            new MainActivity().Toast("Screen On");
            wasScreenOn = true;
        }
    }
} 
```

我没有收到任何错误，但 Toast 也没有显示。有任何想法吗？

日志猫：

```
04-16 00:53:35.470: I/WifiManager(19123): setWifiEnabled : true
04-16 00:53:57.135: D/AndroidRuntime(19123): Shutting down VM
04-16 00:53:57.135: W/dalvikvm(19123): threadid=1: thread exiting with uncaught exception (group=0x416922a0)
04-16 00:53:57.140: E/AndroidRuntime(19123): FATAL EXCEPTION: main
04-16 00:53:57.140: E/AndroidRuntime(19123): java.lang.RuntimeException: Error receiving broadcast Intent { act=android.intent.action.SCREEN_OFF flg=0x50000010 } in com.wifitimer.ScreenReceiver@42312238
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:765)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.os.Handler.handleCallback(Handler.java:615)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.os.Looper.loop(Looper.java:137)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.app.ActivityThread.main(ActivityThread.java:4898)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at java.lang.reflect.Method.invokeNative(Native Method)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at java.lang.reflect.Method.invoke(Method.java:511)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at dalvik.system.NativeStart.main(Native Method)
04-16 00:53:57.140: E/AndroidRuntime(19123): Caused by: java.lang.NullPointerException
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.content.ContextWrapper.getApplicationContext(ContextWrapper.java:101)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at com.wifitimer.MainActivity.Toast(MainActivity.java:107)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at com.wifitimer.ScreenReceiver.onReceive(ScreenReceiver.java:13)
04-16 00:53:57.140: E/AndroidRuntime(19123):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:755)
04-16 00:53:57.140: E/AndroidRuntime(19123):    ... 9 more
04-16 00:53:57.445: I/Process(19123): Sending signal. PID: 19123 SIG: 9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T23:30:51.177

你的调用实际上不应该工作，因为你需要`Context`作为第一个参数提供给`makeText`. 而且由于您的类不是从 Context 或 Activity 或类似的东西派生的，它甚至不应该编译。

查看[文档](http://developer.android.com/reference/android/widget/Toast.html#makeText%28android.content.Context,%20java.lang.CharSequence,%20int%29)。

现在显示您的代码，您当前遇到的问题是：

```
 new MainActivity().Toast("Screen Off"); 
```

你已经有一个实例化的 MainActivity，你不需要实例化一个新的。现在，如果你想使用第一个类的方法，你可以做的一件事是为你的 ScreenReceiver 添加一个构造函数

```
MainActivity myContext;
public ScreenReceiver(MainActivity context){
    myContext = context;
} 
```

并在 onReceive 方法中将该行更改为

```
myContext.Toast("Screen Off"); 
```

并实例化您更改的类，您需要将该行更改为

```
BroadcastReceiver mReceiver = new ScreenReceiver(this); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:38:29.810

~~您不能直接实例化活动。`startActivity(this, B.class);`在 A 内部使用并从 B 生命周期方法内部调用 methodB 。~~

**编辑以匹配已编辑的问题：**

如果你只想显示 Toast，`BroadcastReceiver`直接在里面做：

```
Toast.makeText(context, "Screen On/Off", Toast.LENGTH_SHORT).show(); 
```

如果您想在`Activity`创建您的组件（）上调用一个函数`BroadcastReceiver`，最好添加回调接口并在其中实现，`Activity`通过构造函数发送（如 DigCamara 在他的回答中所说）或设置器发送到`BroadcastReceiver`并在需要时调用。

笔记：

1.  你不直接实例`Activities`化`Services`。它根本行不通。
2.  您需要`BroadcastReceiver`在匹配功能中取消注册（在您的情况下`onDestroy`）。
3.  不要将数据保存在静态变量中：`public static boolean wasScreenOn = true;`. 进程被杀死并重新启动后，您将丢失此数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:31:34.740

创建 Toast 时，第一个参数需要是 Context。因此，要么 B 需要是活动/服务/应用程序的子类，要么您需要将 B 的构造函数中的引用传递给有效的上下文。或者，您可以继承 Application 并提供静态 getContext 方法。

# c# - 为什么这个被覆盖的方法是灰色的？

> ID：16026185
> 
> 赞同：3
> 
> 时间：2013-04-15T23:14:40.277
> 
> 标签：c#, visual-studio, overriding, resharper, dispose

在我必须维护的代码中（ELP 的“Lucky Man”绝对不适合这个配乐），我看到这个，变灰了（没有注释掉 - 由编译器或 Resharper 变灰）：

```
protected override void Dispose( bool disposing )
{
    base.Dispose( disposing );
} 
```

一个橙色灯泡字形（Resharper？）消息说，“删除冗余方法覆盖”

内部带有“0”的天蓝色圆形字形表示：

*“覆盖类 'System.ComponentModel.Component 的方法”* - 和： *“覆盖类 'System.Windows.Forms.Control 的方法”*

我认为它的意思是这个覆盖除了它覆盖的方法之外没有任何作用，因此我可以完全删除它。我对吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T23:24:02.577

由于您只是调用基本方法，因此该代码没有理由存在，因此可以将其删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-08T09:36:29.303

我意识到这是一个老问题，但只是想在这里添加一个小细节。如果您从派生类派生另一个类，您将无法从该派生类调用 base.Dispose，除非您保留“冗余”函数。

# javascript - javascript中的简单悬停和悬停问题

> ID：16026186
> 
> 赞同：0
> 
> 时间：2013-04-15T23:14:47.510
> 
> 标签：javascript

我正在尝试通过 javascript创建`hover`和输出。`hover`

我有

```
test.prototype.build = function(){
   other codes...

    link.href         = '#';
    link.innerHTML   += 'test'
    link.onmouseover  = hover
    link.onmouseout   = hoverOut

   other codes...
}

function hover(){
    var div = document.createElement('div');
        div.class='testDiv';
        div.innerHTML = 'test';
        $(this).prepend(div);

}

function hoverOut(){
    var div = document.getElementsByClassName('testDiv');
        div.style.display='none';

} 
```

我的任务是创建一个`hover`和`hover out`函数。我的问题是我不确定`testDiv`当用户将鼠标悬停在链接之外时如何隐藏。 `getElementsByClassName`在我的情况下似乎不起作用。在javascript中有更好的方法吗？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:20:02.803

`document.getElementsByClassName('testDiv')`返回一个集合，而不是单个对象，但您可能只是`this`用来引用当前对象。由于您在原始代码中显示了一些 jQuery，因此我认为这里没问题。

```
function hoverOut(){
    $(this).find(".testDiv").hide();
} 
```

或者，在普通的 javascript 中，它可能是：

```
function hoverOut(){
    var elems = this.getElementsByClassName("testDiv");
    for (var i = 0; i < elems.length; i++) {
        elems[i].style.display = "none";
    }
} 
```

但是，您的 hover 和 hoverOut 代码不匹配，因为您每次在悬停时都会在悬停时创建一个新的 div，然后只将其隐藏在 hoverOut 中，这样它们就会累积。

如果你想删除你在 hoverOut() 中添加的 div，你可以这样做：

```
function hoverOut(){
    $(this).find(".testDiv").remove();
} 
```

或者在普通的 javascript 中：

```
function hoverOut(){
    var elems = this.getElementsByClassName("testDiv");
    for (var i = 0; i < elems.length; i++) {
        elems[i].parentNode.removeChild(elems[i]);
    }
} 
```

# php - 解析错误：解析错误，意外的 T_OBJECT_OPERATOR，期待 ')'

> ID：16026189
> 
> 赞同：-3
> 
> 时间：2013-04-15T23:15:03.897
> 
> 标签：php

有人可以帮助我吗，现在尝试修复此错误几个小时，但似乎不知道如何解决

解析错误：解析错误，意外的 T_OBJECT_OPERATOR，期待 ')'

```
oreach ($doc->getElementsByTagName('item') as $node) {

    if  ($counter <= $limit)
    {
    $items = array ('title' => $node->getElementsByTagName('title')->item(0)->nodeValue,'link' => $node->getElementsByTagName('link')->item(0)->nodeValue,'description' => $node->getElementsByTagName('description')->item(0)->nodeValue,'pubDate' => $node->getElementsByTagName('pubDate')->item(0)->nodeValue);
    array_push($feeds, $items);
    }
    $counter++;
}
        echo '
            <ul id="facebook">';

                foreach ($feeds as $feed)
                    {
                        $date = strtotime($feed['pubDate']);

                            echo '
                            <li>';
                            echo '<div class="blog_box">
                                            <div class="grid_2">
                                <h4>'. date('jS F Y G:H' ,$date) .'</h4>

                            </div>
                        <div class="grid_6">
                            <h1><a href="'. $feed['link'] .'" title="'.$feed['title'].'">'.$feed['title'].'</a></h1>
                            <p>'.$feed['description'].'</p>
                        </div>
                        <div align="right">
                        <a href="'. $feed['link'] .'" class="button minimal small" title="News link">Read More</a>
                        </div>
                        <div class="clearnospacing"></div>                              
                </div>                       
                        ';
                            echo '</li>
                    ';
                }

            echo '</ul>
        '; 
```

我得到的错误是

```
$items = array ('title' => $node->getElementsByTagName('title')->item(0)->nodeValue,'link' => $node->getElementsByTagName('link')->item(0)->nodeValue,'description' => $node->getElementsByTagName('description')->item(0)->nodeValue,'pubDate' => $node->getElementsByTagName('pubDate')->item(0)->nodeValue); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:19:56.527

您使用的是什么版本的 PHP？

旧版本 (PHP 4.x) 不允许链接对象方法调用。

不允许：

```
$node->getElementsByTagName('pubDate')->item(0)->nodeValue 
```

允许：

```
$temp = $node->getElementsByTagName('pubDate');
$temp = $temp->item(0);
$temp = $temp->nodeValue; 
```

**更新**

要将您的问题行翻译成 PHP4：

```
$items = array(
    'title'       => get_tag_value($node, 'title'),
    'link'        => get_tag_value($node, 'link'),
    'description' => get_tag_value($node, 'description'),
    'pubDate'     => get_tag_value($node, 'pubDate'),
); 
```

然后在代码中的某处添加此函数：

```
function get_tag_value($node, $tag){
    $tags = $node->getElementsByTagName($tag);
    $tag = $tags->item(0);
    return $tag->nodeValue;
} 
```

# asp.net - asp.net 应用程序对象锁定

> ID：16026194
> 
> 赞同：0
> 
> 时间：2013-04-15T23:15:45.097
> 
> 标签：asp.net, locking

我正在将应用程序从一个框架转换为另一个框架，并且对 Application 对象有疑问。

我有一些数据（< 1MB）在应用程序启动时被读取，并且几乎从未在磁盘上更新。（例如更改之间的年数） 数据被*非常*频繁地访问——每次页面加载至少一次，但通常多次，并且总是*只读*的。

我认为在启动时将这些数据推送到 Application 对象中（在 Application_Start 中的 Global.asax 中）可能是正确的做法。我的问题是，我需要锁定对象吗？( `Application.Lock`/ `Application.Unlock`) 由于该`Application_Start`方法只触发一次，并且所有其他访问都在读取，所以我可以在没有锁的情况下逃脱吗？

[为什么不使用 web.config？数据相当不适合 web.config 文件，我希望数据保持原样，因为它也与其他非 ASP.NET 应用程序共享。]

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-15T23:26:02.330

锁适用于您同时读取和写入的应用程序，因此如果您打算只读，则不需要锁。

# android - 在 Android 中嵌入包含视频流的 Html 代码

> ID：16026199
> 
> 赞同：0
> 
> 时间：2013-04-15T23:16:08.297
> 
> 标签：android, html, video

我正在尝试开发一个 Android 应用程序，它只显示嵌入的视频流，如下所示：

```
<html>
<embed width="650" height="377 "flashvars="backcolor=111111&amp;frontcolor=CCCCCC&amp;lightcolor=66CC00&amp;autostart=true&amp;skin=http://manage.streamcyclone.com/skins/snel.zip&amp;streamer=rtmp://sc-lb1.streamcyclone.com/janakles_live&amp;file=janakles&amp;plugins=http://manage.streamcyclone.com/plugins/qualitymonitor,gapro-1&amp;abouttext=StreamCyclone Player&amp;aboutlink=http://www.streamcyclone.com/&amp;gapro.accountid=UA-679067-4&amp;gapro.trackpercentage=true&amp;gapro.tracktime=true" wmode="opaque" allowscriptaccess="always" allowfullscreen="true" quality="high" name="mpl" id="mpl" style="undefined" src="http://manage.streamcyclone.com/player/player.swf" type="application/x-shockwave-flash"></embed>
</html> 
```

我已将此 html 文件作为“broad.html”放在资产文件夹中，这是我的代码：

```
public class BroadcastingActivity extends Activity {
WebView engine;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    engine = (WebView) findViewById(R.id.web_engine);
    engine.getSettings().setJavaScriptEnabled(true);
    engine.getSettings().setAllowFileAccess(true); 
    engine.getSettings().setPluginsEnabled(true); 
    engine.getSettings().setSupportZoom(false); 
    engine.getSettings().setAppCacheEnabled(false); 
    engine.getSettings().setCacheMode(engine.getSettings().LOAD_NO_CACHE);
    engine.loadUrl("file:///android_asset/broad.html");
}
} 
```

我还在清单文件中设置了 Internet 的权限。但是跑步的时候。没有任何作用！请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:23:47.653

您需要 Flash 才能播放此视频，有关更多解决方案，您可以在此处阅读：[使用 Flash 和 android webview](https://stackoverflow.com/questions/5500121/using-flash-with-android-webview)

# asp.net-mvc - MVC GlobalFilters 未触发

> ID：16026203
> 
> 赞同：2
> 
> 时间：2013-04-15T23:16:34.733
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我有这个

```
public class ExceptionFilter : IExceptionFilter
{
    public void OnException(ExceptionContext context)
    {
        Exception exception = context.Exception;
        if (!(exception is HttpException))
        {
           Trace.TraceError("ExceptionFilter: " + ExceptionUtilities.GetFullExceptionMessage(exception));
           Trace.Flush();
        }
    }
} 
```

这在 global.asax

```
public static void RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(new Filters.ExceptionFilter());
    filters.Add(new HandleErrorAttribute());
} 
```

但是当我通过创建这样的危险请求来触发错误时

> example.com/dsfgds:dfgd

我得到一个例外：

> 从客户端检测到潜在危险的 Request.Path 值 (:)

并且过滤器不会触发并且内部的断点不会被击中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:36:55.033

那是因为您正在`IExceptionFilter`使用 MVC 注册一个，因此它只会捕获在 MVC 操作中引发的未处理异常（我认为可能还有其他 MVC 过滤器？不要引用我的话）。但是关于潜在危险请求的错误是 ASP.NET 错误，该请求从未到达 MVC，因此从未调用 MVC 错误过滤器。同样，任何 IIS 级别错误也不会由此处理。对于非 MVC 错误，您仍然需要监视`Application_OnError`事件。或者在 Elmah 等异常处理程序的情况下，让它为您监视事件。

# c# - 按键从字典中删除并检索值

> ID：16026205
> 
> 赞同：11
> 
> 时间：2013-04-15T23:16:38.143
> 
> 标签：c#, .net, dictionary

有没有办法从`Dictionary`(by ) 中删除一个条目**并在同一步骤中**`Key`检索它？`Value`

 **例如，我打电话

```
Dictionary.Remove(Key); 
```

但我也希望它同时返回值。该函数仅返回一个`bool`.

我知道我可以做类似的事情

```
Value = Dictionary[Key];
Dictionary.Remove(Key); 
```

但似乎这将搜索字典两次（一次获取值，另一次从字典中删除它）。我怎么能（如果可能的话）在不搜索字典两次的情况下两者都做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2017-10-15T15:46:41.510

从 .NET Core 2.0 开始，我们有：

> public bool Remove (TKey key, out TValue value);

[https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.remove?view=netcore-2.0#System_Collections_Generic_Dictionary_2_Remove__0__1__](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.remove?view=netcore-2.0#System_Collections_Generic_Dictionary_2_Remove__0__1__)

请注意，此 API 尚未包含[在 .NET Standard 2.0](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.remove?view=netstandard-2.0)和[.NET Framework 4.7](https://docs.microsoft.com/en-us/dotnet/api/system.collections.generic.dictionary-2.remove?view=netframework-4.7)中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-12-09T18:45:01.393

因为它们都有所需的缺失方法，所以我尝试了哥本哈根大学[http://www.itu.dk/research/c5/的 Microsoft 的](http://www.itu.dk/research/c5/)[ConcurrentDictionary](https://msdn.microsoft.com/en-us/library/dd287191(v=vs.110).aspx)和 C5 ，我可以说，至少在我的用例中它非常慢（我与 Dictionary 相比，平均慢 5 倍 - 10 倍。我认为 C5 一直在对键和值进行排序，并发字典对调用线程“太担心”了。我不是在这里讨论为什么字典的这两个化身很慢。我的算法正在寻找和替换一些条目，而第一个键将被删除并添加新键（某种队列）......唯一要做的就是修改原始.Net mscorelib 的字典。我从微软下载了源代码并包含了[字典](http://referencesource.microsoft.com/#mscorlib/system/collections/generic/dictionary.cs,d3599058f8d79be0)我的源代码中的类。要编译，我还需要拖动[HashHelpers](http://referencesource.microsoft.com/#mscorlib/system/collections/hashtable.cs,de3ba4873d4ad06a)类和[ThrowHelper](http://referencesource.microsoft.com/#mscorlib/system/throwhelper.cs,73669ffe9b1ee4f4,references)类。剩下的就是注释掉一些行（例如`[DebuggerTypeProxy(typeof(Mscorlib_DictionaryDebugView<,>))]`和一些资源获取）。显然我必须将缺少的方法添加到复制的类中。也不要尝试编译 Microsoft 源代码，你将这样做几个小时，我很幸运能够让它继续下去。

```
 public bool Remove(TKey key, out TValue value)
    {
        if (key == null)
        {
            ThrowHelper.ThrowArgumentNullException(ExceptionArgument.key);
        }

        if (buckets != null)
        {
            int hashCode = comparer.GetHashCode(key) & 0x7FFFFFFF;
            int bucket = hashCode % buckets.Length;
            int last = -1;
            for (int i = buckets[bucket]; i >= 0; last = i, i = entries[i].next)
            {
                if (entries[i].hashCode == hashCode && comparer.Equals(entries[i].key, key))
                {
                    if (last < 0)
                    {
                        buckets[bucket] = entries[i].next;
                    }
                    else
                    {
                        entries[last].next = entries[i].next;
                    }
                    entries[i].hashCode = -1;
                    entries[i].next = freeList;
                    entries[i].key = default(TKey);
                    value = entries[i].value;
                    entries[i].value = default(TValue);
                    freeList = i;
                    freeCount++;
                    version++;
                    return true;
                }
            }
        }
        value = default(TValue);
        return false;
    } 
```

最后，我将命名空间修改为`System.Collection.Generic.My` 在我的算法中，我只有两行获取值而不是在下一行中删除它。用*新*方法替换它并获得了 7%-10% 的稳定性能增益。希望它对这个用例和从头重新实现字典不是应该做的任何其他情况有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-26T19:24:53.290

尽管这不是 OP 所要求的，但我还是忍不住发布了一个更正的扩展方法：

```
public static bool Remove<TKey, TValue>(this Dictionary<TKey, TValue> self, TKey key, out TValue target)
{
    self.TryGetValue(key, out target);
    return self.Remove(key);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-05T01:39:18.610

有`concurrentDictionary`一个`TryRemove`方法尝试从 中删除并返回具有指定键的值，如果键不存在，则`System.Collections.Concurrent.ConcurrentDictionary<TKey, TValue>.` 返回该类型的默认值。`TValue`

[https://msdn.microsoft.com/en-us/library/dd287129(v=vs.110).aspx](https://msdn.microsoft.com/en-us/library/dd287129(v=vs.110).aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-15T23:30:50.843

您可以使用扩展方法来做到这一点：

```
public static string GetValueAndRemove<TKey, TValue>(this Dictionary<int, string> dict, int key)
{
    string val = dict[key];
    dict.Remove(key);
    return val;    
}

static void Main(string[] args)
{
    Dictionary<int, string> a = new Dictionary<int, string>();
    a.Add(1, "sdfg");
    a.Add(2, "sdsdfgadfhfg");
    string value = a.GetValueAndRemove<int, string>(1);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T23:35:21.577

您可以扩展该类以添加该功能：

```
public class PoppableDictionary<T, V> : Dictionary<T, V>
{
    public V Pop(T key)
    {
        V value = this[key];
        this.Remove(key);
        return value;
    }
} 
```**

# ruby-on-rails - heroku 在我 git push 后没有更新

> ID：16026209
> 
> 赞同：2
> 
> 时间：2013-04-15T23:17:00.100
> 
> 标签：ruby-on-rails, heroku

`git push heroku`那么一切都很好`heroku open`- 但它只是显示的 rails 登录页面。当我尝试时，`rails s`我的主页已完美加载。我删除了 public/index.html 并将更改提交/推送到 github。这可能是什么原因造成的？

路线.rb：

```
Oxenblog::Application.routes.draw do
root :to => 'static_pages#about'

match '/about',    to: 'static_pages#about'
match '/contact',  to: 'static_pages#contact'
match '/projects', to: 'static_pages#projects' 
```

我认为这是我对 heroku 所做的事情的问题，因为它在 localhost 中看起来不错......

它与 git 分支有关。我添加了 commited 并推送到 github 和 heroku ，并且`Everything is up to date`. 但是`heroku open`仍然显示rails登录页面，非常令人沮丧。我在 master 分支上，这是一个新项目，所以我还没有创建任何新分支。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:21:01.193

删除默认的 Rails 主页是不够的，您必须指示 git 删除所有已删除的文件。这是我使用的命令：

```
git add .
git commit -am "save all changed files & remove deleted ones"
git push heroku master 
```

其他应该起作用的命令：

```
git add . -A
git commit -m "..."

git add -u
git commit -m "..." 
```

请注意，如果您在进行任何提交之前删除文件，则 git 无法添加它们。

# java - 用于摇摆建议的开源 java 浏览器组件

> ID：16026213
> 
> 赞同：1
> 
> 时间：2013-04-15T23:17:26.900
> 
> 标签：java, swing, browser, jcomponent

我正在为 SWING寻找像 DJ Project ( [http://djproject.sourceforge.net/ns/index.html](http://djproject.sourceforge.net/ns/index.html) )中的开源浏览器组件。我尝试使用 DJ Project（我从[Best Java/Swing 浏览器组件中了解到的？](https://stackoverflow.com/questions/145863/best-java-swing-browser-component)），但我注意到它最近几个月没有更新。

如果有一种使用 JInternalFrame 制作 Web 浏览器的简单方法，那也很棒。

先感谢您！

# r - 为多个组生成具有不同颜色的 ggplot2 箱线图

> ID：16026215
> 
> 赞同：8
> 
> 时间：2013-04-15T23:17:27.377
> 
> 标签：r, ggplot2, boxplot

我对 R 和 ggplot 还很陌生。

我正在尝试生成按两个变量排序的箱线图。就我而言，物种和实验。到目前为止我得到了什么

```
ggplot(DF, aes(Species, Protein, fill=Experiment, dodge=Experiment)) +
    stat_boxplot(geom ='errorbar')+
    geom_boxplot() 
```

是我的物种的箱线图，每个物种都有 2 个条形图，每个实验一个。

我现在的问题是，是否有可能以这种方式改变颜色，每个物种都有不同的颜色，可以说，这些颜色的不同阴影用于实验？

可以说，第一个物种会有一个深蓝色和浅蓝色条，第二个物种会有一个深绿色和浅绿色条，依此类推。

数据采用 csv 文件的形式，如下所示：

```
Experiment,Species,Protein
Spring,D_strigosa,5.107767364
Spring,D_strigosa,8.288980741
Spring,D_strigosa,7.537376567
Spring,D_strigosa,4.811744241
Spring,D_strigosa,9.559043454
Spring,M_cavernosa,13.66759289
Spring,M_cavernosa,23.54880195
Spring,M_cavernosa,11.00790037
Spring,M_cavernosa,13.70597973
Spring,M_cavernosa,12.26970906
Spring,M_faveolata,9.559043454
Spring,M_faveolata,4.135860474
Spring,M_faveolata,4.557306615
Spring,M_faveolata,7.621872315
Spring,M_faveolata,6.016859956
Spring,M_annularis,6.294920733
Spring,M_annularis,5.163371831
Spring,M_annularis,2.177243143
Spring,M_annularis,3.55966551
Autumn,D_strigosa,3.709978392
Autumn,D_strigosa,7.192777836
Autumn,D_strigosa,5.31544441
Autumn,D_strigosa,6.578602058
Autumn,D_strigosa,5.610085559
Autumn,M_cavernosa,11.64182554
Autumn,M_cavernosa,10.44968102
Autumn,M_cavernosa,9.377389318
Autumn,M_cavernosa,10.99346107
Autumn,M_cavernosa,11.5676896
Autumn,M_faveolata,4.638054165
Autumn,M_faveolata,7.191664953
Autumn,M_faveolata,6.981827102
Autumn,M_faveolata,6.386452477
Autumn,M_annularis,4.709770404
Autumn,M_annularis,3.554071459
Autumn,M_annularis,4.596686351
Autumn,M_annularis,3.530585628 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-16T05:11:14.953

您应该使用`interaction()`for`fill=`并同时提供`Species`和`Experiment`inside `interaction()`。然后`scale_fill_manual()`你可以设置`values=`你需要的颜色（颜色的数量对应于箱线图的数量）。颜色的顺序首先是 in 的颜色`Species`，`Autumn`然后是`Species`in的颜色`Spring`。

```
ggplot(DF, aes(Species, Protein, fill=interaction(Species,Experiment), dodge=Experiment)) +
  stat_boxplot(geom ='errorbar')+
  geom_boxplot()+
  scale_fill_manual(values=c("blue","green","red","cyan",
             + "darkblue","darkgreen","darkred","darkcyan")) 
```

![在此处输入图像描述](https://i.stack.imgur.com/17OIk.png)

# python - 生成新列作为其他列的组合

> ID：16026216
> 
> 赞同：4
> 
> 时间：2013-04-15T23:17:27.923
> 
> 标签：python, pandas

我有一个 DataFrame，它在列中具有标识符的多个组件，并且在另一列中具有与标识符关联的值。我希望能够创建 n 列，以便每一列都是标识参数。

```
 foo    Type      ID     Index    Value  
25090        x       A        0       0     23272000
25090        x       A        0       0     23272000
25091        x       A        1       0     22896000
25092        x       B        0       1     20048000
25093        y       A        0       0     19760000
25092        y       B        0       1     20823342 
```

我想让它有 n 列`Type_ID_Index`分组（我可以通过 groupby 获得）并且每一列都有各自的值。我希望该值与 foo 相关联。

IE

```
 foo          A_0_0     A_1_0     B_0_1      
25090        x         23272000  22896000  20048000
25090        x         23272000  22896000  20048000
25091        x         23272000  22896000  20048000
25092        x         23272000  22896000  20048000
25093        y         19760000  21568000  20823342
25092        y         19760000  21568000  20823342 
```

我该如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T03:49:54.553

从您的示例数据开始

```
In [3]: df
Out[3]: 
      foo  bar Type  ID  Index     Value

25090   x    9    A   0      0  23272000
25090   x    5    A   0      0  23272000
25091   x    3    A   1      0  22896000
25092   x    3    B   0      1  20048000
25093   y    6    A   0      0  19760000
25092   y    4    B   0      1  20823342 
```

通过逐行应用来连接每一行的标识符`join`。

```
In [4]: identifier = df[['Type', 'ID', 'Index']].apply(
             lambda x: '_'.join(map(str, x)), axis=1) 
```

从您的值列中创建一个系列，并按标识符和 foo 对其进行索引。

```
In [5]: v = df['Value']

In [6]: v.index = pd.MultiIndex.from_arrays([df['foo'], identifier])

In [7]: v
Out[7]: 
foo       
x    A_0_0    23272000
     A_0_0    23272000
     A_1_0    22896000
     B_0_1    20048000
y    A_0_0    19760000
     B_0_1    20823342
Name: Value, dtype: int64 
```

将其拆开，并将其加入到 'foo' 上的原始 DataFrame 中。

```
In [8]: df[['foo', 'bar']].join(v.drop_duplicates().unstack(), on='foo')
Out[8]: 
      foo  bar     A_0_0     A_1_0     B_0_1

25090   x    9  23272000  22896000  20048000
25090   x    5  23272000  22896000  20048000
25091   x    3  23272000  22896000  20048000
25092   x    3  23272000  22896000  20048000
25093   y    6  19760000       NaN  20823342
25092   y    4  19760000       NaN  20823342 
```

请注意，我在取消堆叠之前将重复项放入`v`其中。这是必不可少的。如果数据集中任何地方的同一个标识符有不同的值，你就会遇到麻烦。

次要点：您的示例输出中有一行 (25094) 从您的示例输入中丢失。此外，我的输出中的 NaN 是有意义的：当 foo='y' 时，A_1_0 没有指定任何值。

# java - 从java字节码构造解析树/ AST

> ID：16026217
> 
> 赞同：2
> 
> 时间：2013-04-15T23:17:37.077
> 
> 标签：java, parsing, programming-languages, bytecode

是否有任何可用的方法或库可用于从 java 字节码构建解析树？我的实际目标是创建一个 AST。我知道有可用于从源代码构建 AST 的库，只是想知道仅从字节码构建 AST 的方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T23:37:01.210

一旦将其编译为字节码，您就不再拥有语法树。如果您尝试使用字节码构建 Java 语法树，那么您实际上是在尝试编写反编译器。

（字节码本身与其说是一棵树，不如说是一个指令序列；它并不是真正的树形，就像您期望的 AST 那样。）

# mysql - 选择结果数高于 x 的位置

> ID：16026219
> 
> 赞同：0
> 
> 时间：2013-04-15T23:18:00.193
> 
> 标签：mysql, date, group-by, limit

我有一个这样的查询：

```
SELECT 
  oh.date_added AS date_shipped, 
  o.date_added 
FROM 
  ".DB_PREFIX."order o , ".DB_PREFIX."order_history oh 
WHERE 
  o.order_id = oh.order_id 
  AND oh.order_status_id = 3 
```

`X`我想要做的只是在特定日期有或更多行时才显示结果。

因此，如果1`X=5`中有 3 个条目`2013-04-0`，则它们不会显示，但如果有 9 个条目（或任何内容`>= 5`），`2013-04-02`则这些结果将包含在查询中。

一旦满足要求，我希望查询限制为匹配日期的那一组行。

有谁知道我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:24:46.030

您可以添加嵌套`SELECT`来计算这些：

```
SELECT 
  oh.date_added AS date_shipped, 
  o.date_added 
FROM 
  ".DB_PREFIX."order o , ".DB_PREFIX."order_history oh 
WHERE 
  o.order_id = oh.order_id 
  AND oh.order_status_id = 3
  AND (SELECT COUNT(*) FROM ".DB_PREFIX."order o2 
              WHERE o2.date_added>"2013-04-01") > 5 
```

或者按照线条加入一个单独的表

```
SELECT 
  o.date,
  COUNT(*) cnt
FROM 
  order o
  JOIN order o2 ON o2.date = o.date AND o2.id != o.id
WHERE 
  your conditions
GROUP BY o2.id
HAVING cnt > 5 
```

# vim - 多行 fortran openmp 指令的 Vim 语法高亮显示

> ID：16026223
> 
> 赞同：2
> 
> 时间：2013-04-15T23:18:40.420
> 
> 标签：vim, openmp, fortran90, vim-syntax-highlighting

我正在使用现代 fortran 进行并行编程。我正在使用 vim，fortran.vim 语法文件似乎无法处理像 !$omp 或 !dir$ 这样的编译器指令，这让我非常恼火。这些只是在 vim 中呈现为注释，因此它们不会突出。在 c/c++ 中，这些编译器指令是使用#pragma's 完成的，所以一切都像预处理器代码而不是注释代码一样突出。所以我想在我的 fortran 语法中进行类似的处理。这是我要着色的多行指令的示例：

```
!$omp parallel do reduction(+: sum0) reduction(+: sum1) &
     private( nn, S1, S2, Y1, Y2, rvec0, rvec1, iThreadNum) 
```

到目前为止，我有一个位于 $HOME/.vim/after/syntax 中的新 fortran.vim 文件。我已经得到它来识别行开头的'！$ omp'并为该行着色并正确着色多行。我的语法文件包含以下内容：

```
syn region fortranDirective start=/!$omp.*/ end=/[^\&]$/
hi def link fortranDirective PreProc 
```

我的问题是它现在不能处理只有一行的简单情况。IE：

```
!$omp parallel do blah blah
call foobar   <-- this is coloured the same as the line above 
```

我的语法文件中需要某种正则表达式规则才能正确匹配单行和续行。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T12:46:20.147

据我所知，问题在于您的开始正则表达式太贪婪了。

这应该有效：

```
syn region fortranDirective start=/!$omp.\{-}/ end=/[^\&]$/ 
```

# mysql - MySQL：长表与宽表

> ID：16026226
> 
> 赞同：10
> 
> 时间：2013-04-15T23:19:28.263
> 
> 标签：mysql, database-design

什么是更有效的（就查询性能而言）数据库表设计——长的还是宽的？

即，这

```
id size price
1  S    12.4  
1  M    23.1
1  L    33.3
2  S    3.3
2  M    5.3
2  L    11.0 
```

与此相比

```
id  S     M     L
1   12.4  23.1  33.3
2   3.3   5.3   11.0 
```

通常（我认为）它归结为`GROUP BY`直接选择列之间的性能比较：

```
SELECT AVG(price) FROM table GROUP BY size 
```

或者

```
SELECT AVG(S), AVG(M), AVG(L) FROM table 
```

第二个写的有点长（就很多列而言），但是两者的性能呢？如果可能，这些表格格式的一般优点/缺点是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T12:08:58.397

首先，这是两种不同的数据模型，适用于不同的目的。

话虽如此，我希望¹第二个模型的聚合速度更快，这仅仅是因为数据打包得更紧凑，因此需要更少的 I/O：

*   第一个模型中的 GROUP BY 可以通过对索引的**全**`{size, price}`扫描来满足。当数据太大而无法放入 RAM 时，索引的替代方法太慢了。
*   第二种模型中的查询可以通过全表扫描来满足。不需要索引²。

由于第一种方法需要表 + 索引，而第二种方法只需要表，因此在第二种情况下缓存利用率更好。即使我们忽略缓存并将第一个模型中的索引（没有表）与第二个模型中的表进行比较，我怀疑索引会比表大，仅仅是因为它在物理上记录了`size`并且具有未使用的“洞”，典型的B-Trees（尽管如果表是[聚集](http://use-the-index-luke.com/sql/clustering/index-organized-clustered-index)的，则表也是如此）。

最后，第二种模型没有索引维护开销，这可能会影响 INSERT/UPDATE/DELETE 性能。

除此之外，您可以考虑将 SUM 和 COUNT 缓存在仅包含一行的单独表中。每当在主表中插入、更新或删除行时，都会通过触发器更新 SUM 和 COUNT。然后，您可以轻松地获得当前的 AVG，只需将 SUM 和 COUNT 相除。

* * *

*¹但您确实应该**测量**具有代表性的数据量，以确保这一点。*

*²由于您的查询中没有 WHERE 子句，因此将扫描所有行。索引仅用于获取相对较小的表行子集（有时用于[仅索引扫描](http://use-the-index-luke.com/sql/glossary/index-only-scan)）。作为一个粗略的经验法则，如果需要表中超过 10% 的行，索引将无济于事，即使索引可用，DBMS 通常也会选择全表扫描。*

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T23:38:00.253

第一个选项会产生更多行，并且通常会比第二个选项慢。

然而，正如 Deltalima 也指出的那样，第一种选择更灵活。不仅涉及不同的查询选项，而且如果/当您有一天需要用其他尺寸、颜色等扩展表格时。

除非您有一个非常大的数据集或需要超快速的查找时间，否则您可能会更好地使用第一个选项。

如果您确实拥有或需要非常大的数据集，则最好创建一个包含预先计算的汇总值的表。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T23:26:41.433

长的使用起来更灵活。`size`例如，它允许您过滤

```
SELECT MAX(price) where size='L' 
```

它还允许在`size`和 上建立索引`id`。这加快了`GROUP BY`连接其他表`id`和/或`size`此类产品库存表的任何查询。

# apache - Mod_Rewrite 仅用于一个文件夹

> ID：16026232
> 
> 赞同：0
> 
> 时间：2013-04-15T23:20:08.773
> 
> 标签：apache, mod-rewrite

我希望 top 能够键入`http://website.com/new`将重写为`http://website.com/index.php?view=new`，但我只希望`new`目录被“重写”。

我试过这个，但它似乎不起作用......

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^new/ /index.php?view=new [L]
</IfModule> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:02:00.177

它应该是这样的：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /
RewriteRule ^new/?$    /index.php?view=new [L,NC] 
```

# svn - SVN - 添加忽略规则而不覆盖现有规则

> ID：16026236
> 
> 赞同：3
> 
> 时间：2013-04-15T23:20:45.467
> 
> 标签：svn, tortoisesvn

我们正在使用 TortoiseSVN。我们一直通过手动将每个文件夹/文件添加到忽略列表中来管理忽略属性。

我刚刚看到 TortoiseSVN 可以选择递归地添加忽略规则 - 但它似乎覆盖了现有的忽略规则（我发现这一点很难）。

当然有办法解决这个问题吗？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T15:52:07.177

这是一些奇怪的行为。您可以尝试手动设置 ignore 和 global-ignores 属性：

转到包含要忽略的内容的文件夹上的 TortoiseSVN -> 属性，您可以设置 svn:global-ignores （递归忽略，这是忽略（递归）功能集），以及要保留的常规 svn:ignore 功能您当前忽略的文件。

# php - Symfony2 在运行时包含 Zepto 或 jQuery

> ID：16026242
> 
> 赞同：2
> 
> 时间：2013-04-15T23:21:29.927
> 
> 标签：php, javascript, symfony, zurb-foundation

我正在尝试将 Foundation 框架合并到 Symfony2 中。

我复制了 app/Resources 文件夹中的所有 css/js 资产，并且能够引用它们。但是，有一部分没有正确包含：

```
 <script>
  document.write('<script src=' +
  ('__proto__' in {} ? '../app/Resources/public/js/vendor/zepto' : '../app/Resources/public/js/vendor/jquery') +
  '.js><\/script>')
  </script> 
```

那就是我无法加载 jQuery 或 Zepto。如何转换上述语句，使其使用 Symfony 2 资产语法。

就像是：

```
 <script>
if ('__proto__' in {})
{
  {% javascripts '../app/Resources/public/js/vendor/zepto.js' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>      
{% endjavascripts %}
}

Else
{
  {% javascripts '../app/Resources/public/js/vendor/jquery.js' %}
    <script type="text/javascript" src="{{ asset_url }}"></script>      
{% endjavascripts %}
} 
```

我知道我可以轻松地将基础资产复制到 web 文件夹并完成它，但我希望我能保持标准并能够隐藏库。

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T05:23:46.973

这可能会奏效。

```
<script>
var zeptoSrc = "{% javascripts '../app/Resources/public/js/vendor/zepto.js' %}{{ asset_url|e('js') }}{% endjavascripts %}";
var jquerySrc = "{% javascripts '../app/Resources/public/js/vendor/jquery.js' %}{{ asset_url|e('js') }}{% endjavascripts %}";

document.write('<script src="' + ('__proto__' in {} ? zeptoSrc : jquerySrc) + '"><\/script>');
</script> 
```

# regex - 删除 Number X Number 前后的所有内容

> ID：16026244
> 
> 赞同：1
> 
> 时间：2013-04-15T23:21:45.667
> 
> 标签：regex, numbers, expression, character, ranorex

我在这里问我的第一个问题，因为我需要隔离一些字符

```
Fri  2 Mar 2012  11:14:25
JPEG **960x640** 960x640+0+0 8-bit sRGB 64.7KB 0.016u 0:00.017 
```

我想要隔离`960X640`，但这个变量每次都会改变:(而且我得到的结果就像例子一样在很多行上。

所以我需要一个正则表达式来删除 960X640 之前和之后的所有内容。

如果您尝试帮助我，非常感谢您:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:29:16.760

这必须解决您的问题：

```
/\d+x\d+/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:36:28.547

Sed 会使用如下语法：

`s/^[^0-9]+[[:space:]]([0-9]+x[0-9]+)[[:space:]].*$/\1/`

Perl 看起来像：

`s/^\D+\s([0-9]+x[0-9]+)\s.*$/$1/`

例如：

```
$ echo 'JPEG 960x640 960x640+0+0 8-bit sRGB 64.7KB 0.016u 0:00.017' | sed -r 's/^[^0-9]+[[:space:]]([0-9]+x[0-9]+)[[:space:]].*$/\1/'
960x640 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:40:37.883

此正则表达式应与目标匹配：

```
[0-9]+x[0-9]+ 
```

因此，这应该可以删除其他所有内容：

```
Search: .*[0-9]+x[0-9]+.*
Replace (perl etc): \1 
Replace (java): $1 
```

# python - 反正有没有用python拍快照

> ID：16026246
> 
> 赞同：1
> 
> 时间：2013-04-15T23:21:53.980
> 
> 标签：python, screen, snapshot

我正在开发一个程序，我想知道是否可以使用 python 来快照我的屏幕并可能将其保存在我的计算机上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:23:42.293

如果您使用的是 Windows，ImageGrab 看起来可以工作 ( [http://effbot.org/imagingbook/imagegrab.htm](http://effbot.org/imagingbook/imagegrab.htm) )。

# mysql - 来自 2 个表的 SQL 联接，按来自第三个表的联接数据分组

> ID：16026249
> 
> 赞同：0
> 
> 时间：2013-04-15T23:22:02.670
> 
> 标签：mysql, join

标题混乱？:)

我正在尝试从我的购物车数据库中生成有用的报告。

有一个表`orders`包含“date_ordered”（以及一堆我不关心的其他东西）和一个键“orders_id”

第二个表`orders_products`具有相同的“orders_id”键并包含有关订购内容的信息。特别是，我对“products_id”、“products_quantity”和“final_price”感兴趣

我想要做的是生成一个销售报告，显示数量*价格的总和，并在 date_ordered 介于两个日期之间时按 products_id 分组。我可以这样做：

```
SELECT op.products_id AS 'PID',
    SUM(op.products_quantity) AS 'sales Q',
    SUM(op.final_price * op.products_quantity) AS 'sales $'
FROM orders o
JOIN orders_products op
ON o.orders_id = op.orders_id
WHERE o.date_purchased
BETWEEN '2012-01-01' AND '2012-12-31'
GROUP BY op.products_id 
```

这似乎工作正常。但现在我“只是”想在显示产品名称的报告中添加另一列。该数据在另一个表中，`products_description`在“products_name”列中。所以我尝试了这个：

```
SELECT pd.products_name AS 'Product',
    op.products_id AS 'PID',
    SUM(op.products_quantity) AS 'sales Q',
    SUM(op.final_price * op.products_quantity) AS 'sales $'
FROM orders o
JOIN orders_products op
ON o.orders_id = op.orders_id
JOIN products_description pd
ON op.products_id = pd.products_id
WHERE o.date_purchased
BETWEEN '2012-01-01' and '2012-12-31'
GROUP BY op.products_id 
```

起初它似乎有效，直到我注意到所有销售 Q 和销售 $ 数字都是应有的 3 倍。

它超出了我的掌握能力:) 帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:42:59.200

另一件事......正如其他人所说的将产品名称添加到 group by 子句中，您似乎仍然有某种笛卡尔结果。在不知道实际数据的情况下，您可能希望将查询包装起来，例如...

```
select
      pd.products_name AS 'Product',
      PreQuery.*
   from
      ( SELECT 
              op.products_id AS 'PID',
              SUM(op.products_quantity) AS 'sales Q',
              SUM(op.final_price * op.products_quantity) AS 'sales $'
           FROM 
              orders o
                 JOIN orders_products op
                    ON o.orders_id = op.orders_id
           WHERE 
              o.date_purchased BETWEEN '2012-01-01' and '2012-12-31'
           GROUP BY 
              op.products_id ) PreQuery
      JOIN products_description pd
         ON PreQuery.PID = pd.products_id 
```

这应该可以工作，因为内部查询会将结果全部汇总在 PID 上。然后，获取该结果并加入产品描述表。

如果您仍然获得每个项目的重复项，那么您的产品描述表似乎有多个相同产品 ID 的记录......例如有更高的唯一键，但可能有相同的产品具有多种状态、类型等导致问题。

# php - Ajax、PHP、MySQL 不更新服务器或 webapge

> ID：16026253
> 
> 赞同：0
> 
> 时间：2013-04-15T23:22:17.597
> 
> 标签：php, mysql

我的 AJAX 和 MySQL/PHP 脚本有问题。

下面的第一个文件是我用来测试访问服务器的 javascript 文件。据我所知并经过测试，该文件有效。

```
Game = function() {};

var timer;
Game.EncodeURI = function (text) {
    return encodeURIComponent(text);
}

Game.DecodeURI = function (text) {
return decodeURIComponent(text);
}
Game.AlterDiv = function(div,data) {
if (Game.ID(div)) {
    Game.ID(div).innerHTML = data;
}
   }
Game.ID = function(value) {
return document.getElementById(value);
}
 Game.ServerRequest = function (url, data) {
var xmlhttp;
    if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest(); // code for IE7+, Firefox, Chrome, Opera, Safari
    } else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP"); // code for IE6, IE5
    }   
    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            data = xmlhttp.responseText.split("|");                 
                for (i = 0; i < data.length; i++){
                    var one = Game.DecodeURI(data[parseInt(i)]);
                    var two = Game.DecodeURI(data[parseInt(i) + 1]);
                    var three = Game.DecodeURI(data[parseInt(i) + 2]);
                    var four = Game.DecodeURI(data[parseInt(i) + 3]);
                    var five = Game.DecodeURI(data[parseInt(i) + 4]);
                }

        } else {
            return false;
        }
    }
    if (!data) {
        data = "";
    }
    data = data.replace(/: /gi, "=");
    data = data.replace(/:/gi, "=");
    data = data.replace(/, /gi, "&");
    data = data.replace(/,/gi, "&");

xmlhttp.open("POST",url,true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send(data);
 }
Game.Action = function (id, seconds) {
clearTimeout(timer);

    if (id) {
        if (!seconds) {
            Game.AlterDiv('message', 'You begin working.');
            Game.ServerRequest("action.php", "id: " + id);  
        } else {        
            Game.AlterDiv('message', 'You begin working.');
            Game.ID('timer').innerHTML = seconds;   

                    if (seconds >= 2) {
                        seconds -= 1;
                        Game.ID('timer').innerHTML = seconds;           
                        timer = setTimeout(function(){          
                                Game.Action(id, seconds);                       
                            },1000);
                    } else { 
                        Game.ID('timer').innerHTML = "Finished";
                        Game.ServerRequest("action.php", "id: " + id + ", x: x");   // Request it, then POST "x" to say timer has counted down.
                    }
        }
    } else {
        alert("There was an error with your request.\n Please try again.");
    }
} 
```

第二个文件是我用来测试上述功能的基本 PHP 网页。

```
<html>
<head>
<title>Test</title>
</head>
<body>

<span onClick="Game.Action('1','5');">Start Work</span><br /><br />

<div id="message"></div>

<div id="timer"></div>

</body>
</html>
<script type="text/javascript" src="game.js?<?php echo time(); ?>"></script><!-- the time() stops it cache-ing --> 
```

第三个文件是我用来连接数据库的 PHP/MYSQL 文件。

```
<?php
$mysqli = new mysqli_connect("127.0.0.1", "root", "", "gurstang");

$id = $_POST['id'];

if(isset($_POST['x'])) {
$x = true;
}else{
$x = false;
}
$userid = 1;

$query = "SELECT * FROM `action_info` WHERE `actionid` = '$id'";
if($result = $mysqli->query($query)){
     while ($row = $result->fetch_assoc()) {
        $action_name = $row['name'];
    $basetimer = $row['time'];
    $gaineditem = $row['itemid'];
}
$result->free();
}
$query = "SELECT `item`,`plural` FROM `items` WHERE `itemid` = '$gaineditem' LIMIT 0,1";
if($result = $mysqli->query($query)){
    while($row = $result->fetch_assoc()){
        $gained_item = $row['item'];
    $gained_plural = $row['plural'];
    }
    $result->free();
}

if($x == false){
echo "Action|$id|"5"";
$message = "You have begun working.";
echo "AlterDiv|message|$message";

}
if($x == true){
echo "Action|$id|"5"";

$itemnumber = mt_rand(1,2);
$gainedmessage = "You have gained $itemnumner $gained_item.";
echo "AlterDiv|message|$gainedmessage";
$query = "SELECT `count` FROM inventory WHERE userid = '$userid' AND itemid = '$gaineditem' LIMIT 0,1";

if($result = $mysqli->query($query)){
    while($row = $result->fetch_assoc()){
        $count = $row['count'];
        $add = $count + $itemnumber;

        $updatequery = "UPDATE `inventory` SET `count` = '$add' WHERE `userid` = '$userid' AND `itemid` = '$gaineditem'";
        $mysqli->query($updatequery);
    }
    }
    else{
        $insertquery = "INSERT INTO `inventory` (`userid`, `itemid` ,`count`) VALUES ('$userid', '$gaineditem', '1')";
        $mysqli->query($insertquery);  
    }
}
?> 
```

这些是当前运行我的脚本的所有 3 个文件。我在 php 网页中有一个 onclick 事件，它将值发送到我的 Game.Action 的 Javascript 函数。经过测试，我得出结论或至少假设我的 Game.Action Javascript 函数有效。在测试了我的 Game.ServerRequest 函数后，我得出的结论是某处发生了变化。虽然，当我检查我的服务器以查看更新是否真的发生时，什么也没有发生。它不会正确更新计时器 div 或消息 div。

所以基本上我的问题是，我的问题是 PHP/MYSQL 还是 AJAX？

谢谢你的帮助。

# c++ - 如何更改 Visual Studio 2012 (C++) 中的默认 .exe 图标

> ID：16026262
> 
> 赞同：4
> 
> 时间：2013-04-15T23:23:32.883
> 
> 标签：c++, windows, file, icons, executable

我想知道在我编译我的应用程序时是否有办法更改 VS2012 制作的默认图标。只是对于那些想知道的人，我正在尝试更改 .exe 程序的图标，而不是窗口左上角和开始菜单上的窗口图标。我已经知道该怎么做。我一直在用谷歌搜索它，它总是显示如何更改窗口图标，而不是实际文件的图标。提前致谢！！！

编辑：这就是我想要做的......

我想换这个...

![在此处输入图像描述](https://i.stack.imgur.com/vY5dQ.png)

有了这个...

![在此处输入图像描述](https://i.stack.imgur.com/9HNDs.png)]

谢谢，希望这可以澄清。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-07T14:07:21.443

## 将图标添加到可执行文件

*已针对 VS2012 Express 测试*

`icon.rc file`在您的文件旁边创建一个`.vcxproj`并用以下文本填充它：

```
// Icon Resource Definition
#define MAIN_ICON                       102
MAIN_ICON               ICON                    "your_icon.ico" 
```

然后将以下内容添加到标签`.vcxproj`内的任意位置：`Project`

```
<ItemGroup>
    <ResourceCompile Include="icon.rc">
    </ResourceCompile>
</ItemGroup> 
```

* * *

## 附加选项

如果您愿意，您可以将定义转发到您的`icon.rc`文件，如下所示：

```
<ItemGroup>
    <ResourceCompile Include="icon.rc">
        <AdditionalOptions Condition="'$(Configuration)|$(Platform)'=='Debug|Win32'">/D_DEBUG %(AdditionalOptions)</AdditionalOptions>
    </ResourceCompile>
</ItemGroup> 
```

注意`/D_DEBUG`定义，它`_DEBUG`为您的资源文件定义。然后在您的`icon.rc`文件中正常检查定义：

```
#define MAIN_ICON 102
#if defined(_DEBUG)
MAIN_ICON               ICON                    "debug_icon.ico"
#else
MAIN_ICON               ICON                    "release_icon.ico"
#endif 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T07:08:09.160

1.  在 C++ 项目的资源部分添加一个图标。此图标将显示为可执行文件的应用程序图标。[注意：确保您在资源视图窗口中，而不是在解决方案资源管理器窗口中。然后右键单击rc文件夹添加资源...]

2.  我已经使用 Win32 控制台应用程序进行了尝试，它在资源管理器中将图标显示为应用程序图标。这也适用于其他类型的应用程序。

3.  另请注意，在添加图标时，您需要为图标添加不同尺寸的图像，例如 16*16、32*32。Windows 资源管理器将使用这些不同的图标图像以不同的视图模式显示应用程序图标（小图标、中图标、大图标、超大图标等）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T12:16:46.887

这不是它的工作原理。Windows显示的程序图标的大小不是由您决定的，用户选择它。这是用户偏好，只需在桌面上滚动鼠标滚动按钮即可在更高版本的 Windows 上轻松更改。并且一个图标不只有一个大小，它能够存储多个图像。Windows 会选择最适合的那个。而你在开始一个新项目时得到的只是一个存储在项目模板中的库存。您可以通过修改项目模板 .zip 文件来更改它，但这有点没有意义，您想为您的程序提供一个自定义图标来个性化它。

最好的办法是偷、乞或借，做一个好看的偶像是一门艺术。有很多网站可以免费下载。如果您想尝试创建自己的内容，那么这也是受支持的。只需双击项目的 .rc 文件即可打开资源视图，打开 Icon 节点并双击默认图标即可打开图标编辑器。您使用 Image + New Image Type 添加新尺寸。还提供大量免费软件图标编辑器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-19T14:08:51.597

如果它是一个 Win32 应用程序，那么您可以将资源添加到您的项目中，然后将图标放在那里。然后，您可以通过发送 WM_SETICON 方法将图标分配给您的应用程序。对于 MFC 应用程序，资源已经存在，并且您可以更改指定的图标资源。

您也可以按照此处的建议直接从外部文件加载它：

[使用 WIN32 API 设置没有资源的程序图标](https://stackoverflow.com/questions/18314659/setting-program-icon-without-resources-using-the-win32-api)

我会推荐资源路线。资源嵌入到您的可执行文件中，这是在 Win32 和 MFC 中执行此类操作的推荐方法。

# installation - 卸载时出现错误 1001

> ID：16026273
> 
> 赞同：9
> 
> 时间：2013-04-15T23:24:56.757
> 
> 标签：installation, windows-installer

> 错误 1001。卸载时发生异常。此异常将被忽略，卸载将继续。但是，卸载完成后应用程序可能无法完全卸载

我无法卸载或安装该应用程序。这个特定的盒子无法访问互联网，我也没有物理访问权限，因此大多数可谷歌搜索的结果都没有用，因为它们建议运行 Microsoft 的 exe。

解决此问题的手动步骤是什么。我无法实际接触到这台机器，也没有办法让我将文件放到它上面。这是我正在开发和测试的代码。我试过修复和删除失败的。我已经搜索了注册表，但我必须在这里遗漏一些东西。

如果这对超级用户更好，我很乐意移动它。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-07-17T17:05:42.980

我在删除我编写的包含两个 Windows 服务的应用程序时遇到了同样的卸载问题，因此无法避免自定义操作。我解决了它正在运行 PC Tools Registry Mechanic。不幸的是，赛门铁克已经淘汰了该产品。但是，众所周知，Microsoft Fixit 可以帮助解决与注册表相关的问题。[http://support.microsoft.com/mats/Program_Install_and_Uninstall](http://support.microsoft.com/mats/Program_Install_and_Uninstall)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-16T00:16:49.043

1001 始终意味着 InstallUtil（安装程序类）自定义操作失败。不可能给你一个更详细的答案，因为，嗯，这是一个“自定义”操作。不知道是什么代码引发了异常。

如果您想保存这台机器而不需要重建它，您必须记录卸载以获取失败的自定义操作的名称，使用 ORCA 调整 MSI 以删除自定义操作，重新缓存 MSI 并执行卸载。

您现在已经了解了为什么要：

1) 在开发/测试生命周期中始终使用 VM 来测试您的 MSI

2) 尽可能避免使用自定义操作

3) 切勿使用 InstallUtil 自定义操作。它们不是一个好的模式或实践。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-11-26T18:47:48.433

1.转到控制面板，然后右键单击以获取修复选项。2.修复它，修复后再次卸载。到这里，软件卸载了。。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-17T20:37:47.197

制作一个**详细的日志文件**：

```
msiexec.exe /I "File.msi" /QN /L*V "C:\Temp\msilog.log" 
```

> ```
> /I = run installation sequence
> /L*V "C:\Temp\msilog.log"= verbose logging
> /QN = run completely silently 
> ```

在记事本中打开它，然后[**搜索值 3**](http://robmensching.com/blog/posts/2010/8/2/the-first-thing-i-do-with-an-msi-log/)。还要检查**[系统的事件日志](http://en.wikipedia.org/wiki/Event_Viewer)**以获取任何线索。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-07-18T16:33:33.603

**像这样的大多数 MSI 错误可能涉及自定义操作，或者像 Chris 所说的服务配置**。

如果这真的很重要，你应该掌握 Orca - 用于检查 MSI 文件的 SDK 工具。[您可以在此答案](https://stackoverflow.com/a/24793670/129130)中看到一些正在运行的工具的屏幕截图。然后检查**Custom Action 表**和**InstallExecuteSequence 表**的末尾（按序列号排序）并报告您在那里找到的条目。

[**不幸的是，获得Orca**](http://msdn.microsoft.com/en-us/library/aa370557(v=vs.85).aspx)的唯一方法似乎是安装[Windows SDK](http://msdn.microsoft.com/en-us/windows/desktop/bg162891.aspx)。[**或者，您可以下载第三方安装工具**](https://stackoverflow.com/a/1546941/129130)之一的试用版。

**我的猜测**是在 InstallFinalize 之后有一个即时模式自定义操作返回某种错误代码。简而言之，您可以在 InstallExecuteSequence 中报告 InstallFinalize 之后的所有项目，我们可能可以缩小范围。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-08-07T22:18:04.280

这解决了我在 Windows Server 2012 R2 中卸载 Windows 服务的 1001 问题：

*   转到程序并选择修改服务
*   选择维修服务

*   关闭小程序，再次选择修改服务

*   现在选择卸载。

    我希望这有帮助

# automation - Arduino 自动灯开关 2

> ID：16026276
> 
> 赞同：0
> 
> 时间：2013-04-15T23:25:21.560
> 
> 标签：automation, arduino

我目前正在研究自动电灯开关。这是我的代码：

```
#include <Servo.h>

boolean time = false;
const int timeLim = 10000;
const int delLen = 5000;
int pirVal = 0;

const int pirPin = 2;
const int sensePin = 5;
boolean timeRet = false;
int lightVal;
Servo  myServo;
unsigned long limit;

void setup() {

  Serial.begin(9600);
  pinMode(pirPin, INPUT);
  myServo.attach(11);
  myServo.write(40);

}

void loop() {
  unsigned long Timer = millis(); 

  pirVal = digitalRead(pirPin); 
  int lightVal = analogRead(sensePin);

  Serial.print(pirVal);
  Serial.print(' ');
  Serial.print(lightVal);
  Serial.print(' ');
  Serial.print(Timer);
  Serial.print(' ');
  Serial.print(time);
  Serial.print(' ');
  Serial.print(limit);
  Serial.print(' ');
  Serial.println(timeRet);

  if ( lightVal < 400 ) {
    time = false;
    limit = 0;
    timeRet = false;
  } if ( lightVal < 400 && pirVal == 1 ) {
    unsigned long time = false;
    pirVal = 0;
    myServo.write(160);
  } if ( lightVal > 400 && pirVal == 0 && timeRet == false){
    limit = getTimeLim( timeLim, Timer );
    pirVal = 0;
    timeRet = true;
  } if ( lightVal > 400 && pirVal == 0 && timeRet == true ) {
    time = timeStat ( limit, Timer );
  } if ( lightVal > 400 && time == true ) {
    myServo.write(40);
  }
}

int getTimeLim( const int timeLim, unsigned long Timer ) {
  unsigned long limit = Timer + timeLim;
  return limit;
}

boolean timeStat( unsigned long limit, unsigned long Timer ) {

  if ( Timer < limit ) {
    time = false;
  } else if ( Timer > limit ) {
    time = true;
  }
  return time;
} 
```

问题是，当您第一次查看序列时，getTimeLim 函数它可以工作，但第二次总是一些离谱的数字（例如 4294937965）。我不知道为什么它会给我这么大的数字。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:36:28.757

由于您的代码现在可以工作并且您想要优化它，我建议这样做：

```
// ( pseudo code since i'm not familiar with arduino )

void loop( ){

    if( ( analogRead( sensePin ) < 400 ) 
    &&  ( digitalRead( pirPin ) ) ){

        myServo.write( 160 );               // turn on light

        int time_end = millis( ) + 60,000;  // initiate timer value

        while( millis( ) < time_end );      // poll time until at 60s

        myServo.write( 40 );                // turn off light
    }
} 
```

# tcp - 为什么 HAProxy 建议将超时设置为 3 秒的倍数？

> ID：16026277
> 
> 赞同：1
> 
> 时间：2013-04-15T23:25:27.807
> 
> 标签：tcp, haproxy

从[关于客户端超时的 HAProxy 文档中](http://cbonte.github.io/haproxy-dconv/configuration-1.4.html#4-timeout%20connect)：

> 通过指定略高于 3 秒的倍数（例如：4 或 5 秒）的超时来覆盖一个或多个 TCP 数据包丢失是一种很好的做法。

这似乎是一个任意数字。3秒的数字有什么意义？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:19:00.770

It appears this is the default TCP retransmission timeout. From [this Microsoft KB article](http://support.microsoft.com/kb/169292):

> TCP starts a re-transmission timer when each outbound segment is handed down to IP. If no acknowledgment has been received for the data in a given segment before the timer expires, then the segment is retransmitted, up to the TcpMaxDataRetransmissions times. The default value for this parameter is 5\.
> 
> The re-transmission timer is initialized to 3 seconds when a TCP connection is established; however it is adjusted "on the fly" to match the characteristics of the connection using Smoothed Round Trip Time (SRTT) calculations as described in RFC793\. The timer for a given segment is doubled after each re-transmission of that segment. Using this algorithm, TCP tunes itself to the "normal" delay of a connection. TCP connections over high-delay links will take much longer to time out than those over low- delay links.

# jquery - jquery 中是否有“元素就绪”功能？

> ID：16026278
> 
> 赞同：8
> 
> 时间：2013-04-15T23:25:37.900
> 
> 标签：jquery, css

我有一个具有 CSS 边框的元素，问题是元素是空的，直到内容被 jQuery 填充，但边框从一开始就由 CSS 绘制。我希望能够做一些事情，比如 **隐藏元素可见性，直到它准备好显示，然后一次性显示元素和边框。**

有没有办法做到这一点？

编辑：显示内容的代码包含在里面

```
$(window).load(function() {

} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T23:27:52.930

# 方法一

您可以尝试的一种方法是将元素的 CSS 设置为`display:none;`. 这将隐藏元素，调用以下函数将导致元素在 DOM 加载时显示。

```
$(document).ready(function () {
  // Put all of jQuery code in here
  $("element").show(); // substitute element for whatever is needed
}); 
```

不过我不建议使用这种方法，因为一旦jQuery执行就会出现内容的突然跳转，因为`display:none;`意味着页面上不会有元素的踪迹

# 方法二

我认为最好的方法是使用`visibility:hidden`. 这将导致元素通常仍然出现的空间，但将有空白代替元素。这样，当页面加载时，内容不会突然跳转。如果你使用这个方法，你将需要使用该`.css()`方法，因为`.show()`本质上是将元素的 CSS 设置为`display:block;`所以代码看起来像这样

```
$(document).ready(function () {
  // Put all of jQuery code in here
  $("element").css("visibility", "visible") // substitute element for whatever is needed
}); 
```

对于这两种方法，CSS 都会隐藏元素，并且该函数会等到整个 DOM 加载完毕后再执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T23:36:27.957

最初隐藏您的项目。

```
 $(function(){
    $('selector').hide(); // Or you can just have display:none
    }); 
```

在其他一些部分，一些事件用一些内容填充你的 div

```
....
....//some code that fills in your content
...
$('selector').show();
....
.... 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T23:28:03.400

您可以使用 jQuery[`addClass`](http://api.jquery.com/addClass/)添加获取边框的样式，或者[`removeClass`](http://api.jquery.com/removeClass/)删除隐藏的类`display:none;`

并回答您的标题问题，这[`document.ready`](http://api.jquery.com/ready/)就是您要寻找的！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-11-07T19:30:32.030

准备好元素将起作用：

```
$(document.getElementsByTagName('div')[0]).ready(function() {
// do stuff when div is ready 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-26T13:09:05.897

Try this:

```
$('#element').bind("DOMSubtreeModified", function () {
    //do stuff
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-15T23:28:03.340

你可以使用

```
$(function(){
  // your code here
}); 
```

所以上面的内容会在加载 DOM 时执行。现在您需要做的就是显示您`visibility:hidden`在 css 中设置的元素。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-04-15T23:28:45.417

你试过`.css()`吗？您可以更改元素的 css。[在这里](http://api.jquery.com/css/)阅读更多。

最初，将其设置为隐藏，然后将其删除。

# ruby-on-rails - 活动管理员：视图没有内容

> ID：16026283
> 
> 赞同：1
> 
> 时间：2013-04-15T23:26:07.017
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activeadmin

我偶尔会在 ActiveAdmin 中看到空白的视图（可能除了标题）。例如，最近在经常使用的表格的“显示”视图中发生了这种情况（但过去也发生在“编辑”和其他视图中）。

在过去，我刚刚重命名了这些表，并发现这往往会奏效。但我认为必须有更好的方法。

具体来说，我有以下两个问题：

1.  鉴于大多数视图逻辑都隐藏在“幕后”的某个地方，在 ActiveAdmin 中调试这种一般问题的最佳方法是什么？
2.  这个特定问题（除了应该包含更多内容的视图的标题之外不显示任何内容）是已知问题吗？有已知的解决方法吗？

# google-app-engine - 在 python 中的 gdata 上使用 OAuth2 和服务帐户

> ID：16026286
> 
> 赞同：8
> 
> 时间：2013-04-15T23:26:37.037
> 
> 标签：google-app-engine, oauth-2.0, gdata, picasa, google-api-client

我想用来`data.photos.service.PhotosService`从 Picasa 推送和拉取照片。我从 Google 控制台获得了一个服务密钥文件 XXXXXXXX-privatekey.p12，现在我正在尝试使用该密钥与 google 进行身份验证。

使用 appengine 的 OAUTH2 文档让我相信使用以下内容会很有用：

```
f = file(settings.SITE_ROOT + '/aurora/' + settings.PRIVATE_KEY, 'rb')
key = f.read()
f.close()

credentials = SignedJwtAssertionCredentials(settings.SERVICE_ACCOUNT_NAME, key, scope = 'http://picasaweb.google.com/data https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile')
http = httplib2.Http()
http = credentials.authorize(http)
service = build("oauth2", "v2", http=http)
user_info = None
try:
  user_info = service.userinfo().get().execute()
  # neither of these two methods work
  #gd_client.SetOAuthInputParameters(signature_method = gdata.auth.OAuthSignatureMethod.RSA_SHA1, consumer_key = "asdfasdfasdf.apps.googleusercontent.com", rsa_key = key, two_legged_oauth = True, requestor_id = user_info.get('email'))
  #gd_client.auth_token = gdata.gauth.TwoLeggedOAuthRsaToken(consumer_key = user_info.get('email'), rsa_private_key = key, requestor_id = user_info.get('email'))
except errors.HttpError, e:
  logging.error('An error occurred: %s', e)

user_inf0 = {u'verified_email': True, u'id': u'1234', u'name': u'asdfasdfasdf@developer.gserviceaccount.com', u'email': u'asdfasdfasdf@developer.gserviceaccount.com'} 
```

问题是方法 1 using`SetOAuthInputParameters`返回一个无效的令牌，或者方法 2 返回一个`403 restricted`.

当我真的真的不想那样做时，我正在阅读大量的代码，这些代码都执行常规的 3 legged oauth。我还没有看到任何想法/文章？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-08-22T15:01:55.497

使用 gdata.gauth.OAuth2TokenFromCredentials。

```
auth2token = gdata.gauth.OAuth2TokenFromCredentials(credentials)
gd_client = auth2token.authorize(gd_client) 
```

OAuth2TokenFromCredentials 旨在帮助您同时使用 apiclient 和 gdata。在幕后，它使用凭据来确保它拥有执行 gdata 调用所需的身份验证信息。

请注意，如果您仍然得到 403，则可能完全是另外一回事。我正在使用服务帐户访问用户的数据并得到 403，因为我没有在 SignedJwtAssertionCredentials 调用中正确指定用户。

更新：这是我使用的基本模式：

```
from oauth2client.client import SignedJwtAssertionCredentials
credentials = SignedJwtAssertionCredentials(
    "XXXXXXXXXXX@developer.gserviceaccount.com",
    open("keyfile").read(),
    scope=(
        "https://www.googleapis.com/auth/drive",
        "https://spreadsheets.google.com/feeds",
        "https://docs.google.com/feeds"
    ), # For example.
    sub="user@gmail.com"
)
http = httplib2.Http()
http = credentials.authorize(http) # Not needed? See comment below.
auth2token = gdata.gauth.OAuth2TokenFromCredentials(credentials)
gd_client = gdata.photos.service.PhotosService() # For example.
gd_client = auth2token.authorize(gd_client) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-08T20:55:34.827

如果您在您的 google 帐户上使用 MFA，则需要使用同意屏幕身份验证方法。使用 Picassa API，它不能按原样工作，因为请求 API 略有不同。

```
import gdata.gauth
import os
import pickle
import gdata.photos.service

clientid='xxx'  # https://console.developers.google.com/apis/credentials
clientsecret='xxx'
Scope='https://picasaweb.google.com/data/'
User_agent='myself'

def GetAuthToken():
    if os.path.exists(".token"):
        with open(".token") as f:
            token = pickle.load(f)
    else:
        token = gdata.gauth.OAuth2Token(client_id=clientid,client_secret=clientsecret,scope=Scope,user_agent=User_agent)
        print token.generate_authorize_url(redirect_uri='urn:ietf:wg:oauth:2.0:oob')
        code = raw_input('What is the verification code? ').strip()
        token.get_access_token(code)
        with open(".token", 'w') as f:
            pickle.dump(token, f)
    return token

token = GetAuthToken()

gd_client = gdata.photos.service.PhotosService()
old_request = gd_client.request

def request(operation, url, data=None, headers=None):
    headers = headers or {}
    headers['Authorization'] = 'Bearer ' + token.access_token
    return old_request(operation, url, data=data, headers=headers)

gd_client.request = request
photos = gd_client.GetUserFeed(kind='photo', limit='10')
for photo in photos.entry:
    print 'Recently added photo title:', photo.title.text 
```

# php - 使用 date() 从 SQL 数据库格式化 PHP 年份？

> ID：16026288
> 
> 赞同：0
> 
> 时间：2013-04-15T23:27:02.447
> 
> 标签：php, mysql, date, datetime

我已将存储在 MySQL 数据库中的图像的日期上传为“日期时间”类型。

例如 2013-04-16 00:20:00

但无论我做什么，我似乎都无法在我的 PHP 代码中正确回显日期。这是我目前拥有的：

```
$session_query = mysql_query($sql);
$upload_date_formatted = date('M jS, Y', $session_query['upload_date']);
echo '<h6> Uploaded on '.$upload_date_formatted.' .</h6>'; 
```

使用上面的例子，这总是给出：'Uploaded on Jan 1st, 1970.'。

有任何想法吗？我已经尝试了很多东西，但我似乎无法让这个日期正确显示。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T23:29:45.793

[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

您需要调用[`mysql_fetch_assoc()`](http://php.net/mysql-fetch-assoc)以`$session_query`将其转换为可用数组。

您还需要`$session_query['upload_date']`通过将其转换为预期[`strtotime()`](http://php.net/strtotime)的整数。`date()`

```
$session_query = mysql_query($sql);
$row = mysql_fetch_assoc($session_query);
$upload_date_formatted = date('M jS, Y', strtotime($row['upload_date']));
echo '<h6> Uploaded on '.$upload_date_formatted.' .</h6>'; 
```

因为您正在尝试从非数组传递一个数组键，这将是`null`，当转换为整数时`date()`将为零，从而导致您看到 01/01/1970 日期。这也会引发一些错误 - 您应该打开错误报告，因为它可以帮助您更快地跟踪开发环境中的错误：

```
error_reporting(-1);
ini_set('display_errors', 1); 
```

* * *

或者，您可以使用[`DateTime`](http://php.net/manual/en/class.datetime.php)对象和[`createFromFormat()`](http://php.net/datetime.createfromformat)方法：

```
$session_query = mysql_query($sql);
$row = mysql_fetch_assoc($session_query);
$date = DateTime::createFromFormat('Y-m-d H:i:s', $row['upload_date']);
$upload_date_formatted = $date->format('M jS, Y'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:29:10.120

您需要先将其转换为 Unix 时间戳[`strtotime()`](http://php.net/manual/en/function.strtotime.php)，然后您可以使用`date()`.

```
$session_query = mysql_query($sql);
$upload_date_formatted = date( 'M jS, Y', strtotime( $session_query['upload_date'] ) );
echo '<h6> Uploaded on '.$upload_date_formatted.' .</h6>'; 
```

*作为旁注，* [mysql_](http://news.php.net/php.internals/53799) **扩展已被弃用。改用[PDO](http://php.net/manual/en/book.pdo.php)。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:30:34.330

使用 MySQL [Date_Format](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)函数而不是[PHP](http://www.php.net)，格式为 '%b %e, %Y'

# r - Mac OS X Mountain Lion 上 R 的 Vim 语法高亮显示

> ID：16026304
> 
> 赞同：2
> 
> 时间：2013-04-15T23:28:34.307
> 
> 标签：r, vim, syntax-highlighting, osx-mountain-lion, vim-plugin

我试过下载很多 R 语法高亮插件都无济于事。似乎没有一个工作......但是，当我将[sourthernlights.vim](http://www.vim.org/scripts/script.php?script_id=3292)放入`~/.vim/plugin`这个新的颜色配置文件时，对我在 Vim 中打开的所有文件都有效。

以 iterm2 的颜色配置文件结尾`*.R`或`*.r`默认为 iterm2 的文件（如果我没有更改文件类型，则为 southlights.vim）

我检查过

```
:set ft? 
```

和

```
:filetype 
```

我的 .vimrc 有

```
syntax on
filetype plugin on 
```

任何建议都会很棒！

非常感谢，bfb

```
:version

VIM - Vi IMproved 7.3 (2010 Aug 15, compiled Mar 26 2013 14:04:37)
MacOS X (unix) version
Compiled by kevin schiesser@primalscream.corp.xoom.com
Normal version without GUI.  Features included (+) or not (-):
-arabic +autocmd -balloon_eval -browse +builtin_terms +byte_offset +cindent 
-clientserver +clipboard +cmdline_compl +cmdline_hist +cmdline_info +comments 
-conceal +cryptv -cscope +cursorbind +cursorshape +dialog_con +diff +digraphs 
-dnd -ebcdic -emacs_tags +eval +ex_extra +extra_search -farsi +file_in_path 
+find_in_path +float +folding -footer +fork() -gettext -hangul_input -iconv 
+insert_expand +jumplist -keymap -langmap +libcall +linebreak +lispindent 
+listcmds +localmap -lua +menu +mksession +modify_fname +mouse -mouseshape
-mouse_dec -mouse_gpm -mouse_jsbterm -mouse_netterm -mouse_sysmouse +mouse_xterm 
-multi_byte +multi_lang -mzscheme +netbeans_intg -osfiletype +path_extra -perl 
+persistent_undo +postscript +printer -profile -python -python3 +quickfix +reltime 
-rightleft -ruby +scrollbind +signs +smartindent -sniff +startuptime +statusline 
-sun_workshop +syntax +tag_binary +tag_old_static -tag_any_white -tcl +terminfo 
+termresponse +textobjects +title -toolbar +user_commands +vertsplit +virtualedit 
+visual +visualextra +viminfo +vreplace +wildignore +wildmenu +windows +writebackup 
-X11 -xfontset -xim -xsmp -xterm_clipboard -xterm_save
    system vimrc file: "$VIM/vimrc"
    user vimrc file: "$HOME/.vimrc"
    user exrc file: "$HOME/.exrc"
    fall-back for $VIM: "/usr/local/share/vim"
Compilation: gcc -c -I. -Iproto -DHAVE_CONFIG_H   -DMACOS_X_UNIX -no-cpp-precomp  
-g -O2 -D_FORTIFY_SOURCE=1
Linking: gcc    -o vim       -lm -lncurses  -framework Cocoa 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T04:54:38.750

配色方案必须安装在`~/.vim/colors`.

从您的问题来看，尚不清楚您是否有颜色方案或 R 语法突出显示的问题。

另外，在没有 Python/Ruby 支持或任何补丁的情况下在 Mac OS X 上构建自己的 Vim 有什么意义？MacVim 是要走*的路。*

# apache-pig - 如何动态计算 pig LOAD 命令的输入

> ID：16026311
> 
> 赞同：0
> 
> 时间：2013-04-15T23:29:20.917
> 
> 标签：apache-pig

有没有办法动态计算猪中 LOAD 语句的输入值？从概念上讲，我想做这样的事情：

```
%declare MYINPUT com.foo.myMethod('2013-04-15');
raw = LOAD '$MYINPUT' ... 
```

myMethod() 是一个 UDF，它接受日期作为输入并以字符串形式返回（逗号分隔的）目录列表。然后将该字符串作为 LOAD 语句的输入给出。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:32:43.487

在我看来，myMethod() 不需要是 UDF。假设这个目录列表不需要在 map reduce 中计算，您可以运行该函数首先获取字符串，然后将其作为传递给 pig 的属性。如果您的驱动程序是在下面提供的 java 中的示例：

```
String myInput = myMethod("2013-04-15");
PigServer pig = new PigServer(ExecType.MAPREDUCE);
Map<String,String> myProperties = new HashMap<String,String>();
myProperties.put("myInput",myInput);
pig.registerScript("myScriptLocation.pig"); 
```

然后你的脚本将从

```
raw = LOAD '$myInput' USING... 
```

这是假设您的 myInput 字符串是 PigStorage 可以读取的 glob 格式，或者您有一个不同的 LoadFunc 可以处理您的逗号分隔字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T14:21:03.910

[我遇到了类似的问题，并选择了 Java LoadFunc 实现而不是 pre-processor](https://stackoverflow.com/questions/14885333/restricting-loading-of-log-files-in-pig-latin-based-on-interested-date-range-as)。使用自定义 LoadFunc 意味着分析师仍然可以使用 stock pig 可执行文件运行脚本，并且不需要其他依赖项。

# java - 在 pong 中遇到 java keyPressed 和 keyReleased 问题

> ID：16026313
> 
> 赞同：-1
> 
> 时间：2013-04-15T23:29:23.723
> 
> 标签：java, swing, pong, keyrelease

所以我试图通过在按下某个键时增加它们来移动桨。我这样做是因为当我不使用 keyrelease 时，你不能同时移动它们。

我现在遇到的问题是如果我按一个方向它会走（他们两个可以同时走，这很好），但是一旦我按下相反的键它就会停止，并且无法再次移动. 有小费吗？

这是我正在谈论的所有内容

```
public void paddleMove(){
            if(leftDown==true){
                y-=10;
            }
            if(leftUp ==true){
                y+=10;
            }
            if(rightDown ==true){
                ytwo-=10;
            }
            if(rightUp ==true){
                ytwo+=10;
            }
        }

        public void keyPressed(KeyEvent e) {

        if(e.getKeyCode() == KeyEvent.VK_A || e.getKeyCode() == KeyEvent.VK_S || e.getKeyCode() == KeyEvent.VK_QUOTE || e.getKeyCode() == KeyEvent.VK_SEMICOLON){
               if(e.getKeyCode() == KeyEvent.VK_A){
                  // y-=10;
                   leftDown = true;
               }

         if(e.getKeyCode() == KeyEvent.VK_S){
                       // y+=10;
             leftUp = true;
                }

        if(e.getKeyCode() == KeyEvent.VK_QUOTE){
               // ytwo-=10;
            rightDown = true;
        }
         if(e.getKeyCode() == KeyEvent.VK_SEMICOLON){
                        //ytwo+=10;
             rightUp = true;
                }

        }
        }
        public void keyRelease(KeyEvent r){
            if(r.getKeyCode() == KeyEvent.VK_A){
                leftDown = false;
            }
            if(r.getKeyCode() == KeyEvent.VK_S){
                leftUp = false;
            }
            if(r.getKeyCode() == KeyEvent.VK_QUOTE){
                rightDown = false;
            }
            if(r.getKeyCode() == KeyEvent.VK_SEMICOLON){
                rightUp = false;
            }
        } 
```

这是完整的代码

```
import java.awt.Color;
import java.awt.Event;
import java.awt.Graphics;
import java.util.Random;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class Pong extends JFrame implements ActionListener{

        //implement constants

        PongPanel pongPanel = new PongPanel();  

        //JFrame pong x and y coordinates 
        static final int jfpX = 150;
        static final int jfpY = 20;

        // JFrame pong width and height
        static final int jfpW = 800;
        static final int jfpH = 600;

        Thread thrd;

        public static void main(String[] args) {
                Pong jfp = new Pong();
                jfp.setVisible(true);

        }

        public Pong(){
                setBounds(jfpX,jfpY,jfpW,jfpH); 
                setTitle("Pong");
                setResizable(false);
                setDefaultCloseOperation(EXIT_ON_CLOSE);
                setBackground(Color.black);

                add(pongPanel);
                addKeyListener(pongPanel);
                thrd = new Thread (pongPanel);
        thrd.start();
        }

        public void actionPerformed(ActionEvent e) {

        }

}

class PongPanel extends JPanel implements Runnable, KeyListener{
        Random random = new Random();
        static final int jpW = 800;
        static final int jpH = 600;
        int paddleStart = (jpH/2)-35;
        int paddleStarttwo = (jpH/2)-35;
        int ballStartX = (jpW/2)-20;
        int ballStartY = (jpH/2)-20;
        int ytwo,x,y;
        int ballD = 30;
        int paddleW1 = 20;
        int paddleH1 = 100;
        int paddleW2 = 20;
        int paddleH2 = 100;
        int min = -2;
        int max = 2;
        int randomBallx, randomBally;

        boolean leftUp = false;
        boolean leftDown = false;
        boolean rightUp = false;
        boolean rightDown = false;

//        int randomBallx = random.nextInt(max-min+1)+min;
//        int randomBally = random.nextInt(max-min+1)+min;

        int rand1 = random.nextInt(2-1 + 1)+1; // random for function to determine ballx and bally
        int rand2 = random.nextInt(2-1+2)+1;
        int dx = 4;
        int dy = 4; //direction of y

        public void ballNotZero(){// makes sure the ball doesnt go straight up and down
        if (randomBallx ==0){
              randomBallx = random.nextInt(max-min+1)+min;
             }
             if(randomBally == 0){
              randomBally=random.nextInt(max-min+1)+min;
             }
//         if(rand1 ==1){
//         randomBallx=-1;
//         }
//         if(rand1 ==2){
//         randomBallx=1;
//         }
//         if(rand2 ==1){
//         randomBally =-1;
//         }
//         if(rand2==2){
//         randomBally = 1;
//         }

        }

        public PongPanel(){

        }

        protected void paintComponent(Graphics g) 
        {
        super.paintComponent(g);

        Color ball;
        Color paddleOne;
        Color paddleTwo;
        ball = new Color(255,0,255);
        paddleOne = new Color(255,0,0);
        paddleTwo = new Color(0,0,255);

        g.setColor(ball);
        g.fillOval(ballStartX+randomBallx,ballStartY+randomBally,ballD,ballD);

        g.setColor(paddleOne);
        g.fillRect(20,paddleStart+y,paddleW1,paddleH1);

        g.setColor(paddleTwo);
        g.fillRect(760,paddleStarttwo+ytwo,paddleW2,paddleH2);

        }
        public void run() {
                while(true){
                ballNotZero(); 
                detectPaddle();
                paddleMove();
                randomBall();
                ballMove();
                repaint();
        try {Thread.sleep(75); } catch(Exception e){

        }

                }
        }
        public static boolean intervallContains(int low, int high, int n) { //determines if something is in a certain range
            return n >= low && n <= high;
        }
        public void detectPaddle(){  //determines if ball is close enough to paddle for detection
        int withinY = (paddleStart+y) -(ballStartY+randomBally);
        int withinY1 = (paddleStarttwo+ytwo)-(ballStartY+randomBally);

        if (ballStartX+randomBallx <=20  &&  intervallContains(-50,50,withinY)){
        dx = -dx;
        }
        if(ballStartX+randomBallx >=760 && intervallContains(-50,50,withinY1)){
        dx = -dx;
        }
        }

        public void randomBall(){
        if(randomBallx >=0 ){
        randomBallx+=dx;
        }
        if(randomBallx<0){
        randomBallx-=dx;
        }
        if(randomBally>=0){
        randomBally+=dy;
        }
        if(randomBally<0){
        randomBally-=dy;
        }
//                randomBallx+=randomBallx;
//                randomBally+=randomBally;
        }
        public void ballMove(){
        if(ballStartY+randomBally > jpH-60){
        dy= -dy;

        }
        if(ballStartY+randomBally <0){
        dy = -dy;
        }
        }
        public void paddleMove(){
            if(leftDown==true){
                y-=10;
            }
            if(leftUp ==true){
                y+=10;
            }
            if(rightDown ==true){
                ytwo-=10;
            }
            if(rightUp ==true){
                ytwo+=10;
            }
        }

        public void keyPressed(KeyEvent e) {

        if(e.getKeyCode() == KeyEvent.VK_A || e.getKeyCode() == KeyEvent.VK_S || e.getKeyCode() == KeyEvent.VK_QUOTE || e.getKeyCode() == KeyEvent.VK_SEMICOLON){
               if(e.getKeyCode() == KeyEvent.VK_A){
                  // y-=10;
                   leftDown = true;
               }

         if(e.getKeyCode() == KeyEvent.VK_S){
                       // y+=10;
             leftUp = true;
                }

        if(e.getKeyCode() == KeyEvent.VK_QUOTE){
               // ytwo-=10;
            rightDown = true;
        }
         if(e.getKeyCode() == KeyEvent.VK_SEMICOLON){
                        //ytwo+=10;
             rightUp = true;
                }

        }
        }
        public void keyRelease(KeyEvent r){
            if(r.getKeyCode() == KeyEvent.VK_A){
                leftDown = false;
            }
            if(r.getKeyCode() == KeyEvent.VK_S){
                leftUp = false;
            }
            if(r.getKeyCode() == KeyEvent.VK_QUOTE){
                rightDown = false;
            }
            if(r.getKeyCode() == KeyEvent.VK_SEMICOLON){
                rightUp = false;
            }
        }

        public void keyTyped(KeyEvent e) {

       }

        @Override
        public void keyReleased(KeyEvent e) {
                // TODO Auto-generated method stub

        }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:32:06.877

看看你的逻辑...

```
if (e.getKeyCode() == KeyEvent.VK_A) {
    // y-=10;
    leftDown = true;
}

if (e.getKeyCode() == KeyEvent.VK_S) {
    // y+=10;
    leftUp = true;
} 
```

这基本上是说，如果我按`A`AND`S`然后可以`leftDown`同时进行，这显然是不可能的（对于您想要做的），它们需要相互抵消......`leftUp``true`

它应该更像...

```
if (e.getKeyCode() == KeyEvent.VK_A) {
    // y-=10;
    leftDown = true;
    leftUp = false;
}

if (e.getKeyCode() == KeyEvent.VK_S) {
    // y+=10;
    leftUp = true;
    leftDown = false
} 
```

反而。这意味着如果我按`A`, `leftDown`is`true`和`leftUp`is `false`，但如果我同时按`S`, 那么`leftDown`is`false`和`leftUp`is `true`。这意味着玩家只能在一个方向上移动，而不管他们按什么顺序按键。

当我在这里...

这`if (e.getKeyCode() == KeyEvent.VK_A || e.getKeyCode() == KeyEvent.VK_S || e.getKeyCode() == KeyEvent.VK_QUOTE || e.getKeyCode() == KeyEvent.VK_SEMICOLON) {`是多余的，不会为您的代码增加任何价值，您将以任何方式检查这些状态...

而不是使用一堆不连贯的`if`语句，比如......

```
if (e.getKeyCode() == KeyEvent.VK_A) {
    //...
}
if (e.getKeyCode() == KeyEvent.VK_S) {
    //...
}
if (e.getKeyCode() == KeyEvent.VK_QUOTE) {
    //...
}
if (e.getKeyCode() == KeyEvent.VK_SEMICOLON) {
    //...
} 
```

你应该使用`if-else`语句....

```
if (e.getKeyCode() == KeyEvent.VK_A) {
    //...
} else if (e.getKeyCode() == KeyEvent.VK_S) {
    //...
} else if (e.getKeyCode() == KeyEvent.VK_QUOTE) {
    //...
} else if (e.getKeyCode() == KeyEvent.VK_SEMICOLON) {
    //...
} 
```

这真的，真的，次要的，但更明显的是你打算检查一个状态，因为`KeyEvent`它只会用于一个键......

哦，我还应该补充一点，使用[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)而不是`KeyListener`s。 `KeyListener`遭受许多您不想处理的与焦点相关的问题...

# ruby-on-rails - Ajax 返回不触发回调

> ID：16026319
> 
> 赞同：1
> 
> 时间：2013-04-15T23:30:07.377
> 
> 标签：ruby-on-rails, ajax, jquery, coffeescript

我正在尝试对一些我没有编写的代码进行故障排除，并且在试图弄清楚为什么 Ajax 返回没有触发回调时遇到了很多困难。以下是将行为附加到 ajax 函数的代码：

```
 # Callback before AJAX request sends
cbBeforeSend = (jqXHR, settings) ->
  console.log jqXHR
  # initialize message/status elements
  $flashIcon.attr 'class', 'icon icon-refresh icon-spin'
  $flashError.html ''
  $flashNotice.html ''

# Callback when AJAX returns with success
cbSuccess = (data, textStatus, jqXHR) ->
  console.log 'success'
  $flashIcon.attr 'class', 'icon icon-ok-sign'
  window.globalLoadCallback()

# Callback when AJAX returns with error
cbError = (jqXHR, textStatus, errorThrown) ->
  console.log 'error'
  $flashIcon.attr 'class', 'icon icon-remove-circle'
  # Run the response javascript, even when the status indicates an error
  if /text\/javascript/.test jqXHR.getResponseHeader('Content-Type') 
    eval jqXHR.responseText

# Callback when AJAX returns
cbComplete = (jqXHR, textStatus) ->
  console.log 'cbComplete'
  if $flashIcon.is('.icon-refresh')
    $flashIcon.attr 'class', 'icon icon-warning-sign' 
```

我们的应用程序有两个指向报价/报价路径的链接：

新的报价链接有效并触发了我上面显示的“成功”和“cbComplete”回调。这是该链接的代码：

```
<li>
  <%= link_to new_quoting_quote_path, remote:true do %>
    <i class="icon icon-plus-sign"></i>
    <span>New Quote</span>
  <% end %>
</li> 
```

编辑报价链接有效，它将您带到正确的部分并且对象在控制台中返回，但“成功”和“cbComplete”回调没有触发（错误也没有）。只有“cbBeforeSend”回调被触发，因为 flashIcon 上的类仍然是“icon icon-refresh icon-spin”。我不认为 crm_connection 有问题，因为在浏览器中链接呈现为“/quoting/quotes/183/edit”。似乎提供了正确的 ID。这是该链接的代码：

```
<%= client_management_tab 'Health', edit_quoting_quote_path(@crm_connection) %> 
```

抱歉，我无法提供更多细节。不幸的是，我没有编写这段代码，只是负责修复它。感谢您提供任何帮助。

我相信这是附加请求的代码：

```
 $flashInfo   = $('div.flash-info')
  $flashIcon   = $flashInfo.find('i#ajax-status')
  $flashError  = $flashInfo.find('#flash-error')
  $flashNotice = $flashInfo.find('#flash-notice')
  $(document).bind 'ajax:beforeSend', cbBeforeSendBound
  $(document).bind 'ajax:success', cbSuccessBound
  $(document).bind 'ajax:error', cbErrorBound
  $(document).bind 'ajax:complete', cbCompleteBound

$.ajaxSetup(
  beforeSend: cbBeforeSend
  success: cbSuccess
  error: cbError
  complete: cbComplete
  ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T09:17:47.250

如果对 jQuery.ajax 的实际调用设置了它自己的回调，那么我相当肯定它会忽略 ajaxSetup 提供的那些。这使得它们除了设置默认值之外的任何事情都非常不可靠，正如 Ricardo 在他的回答中指出的那样，jQuery 开发人员建议不要使用这种机制。

在我看来，你有几个选择。jQuery 还提供了一系列其他用于全局 ajax 事件绑定的 ajax 函数：

jQuery.ajaxStart、jQuery.ajaxStop、jQuery.ajaxComplete、jQuery.ajaxError、jQuery.ajaxSuccess、jQuery.ajaxSend

如果您使用这些函数绑定事件，那么它们将始终由 ajax 调用通过 jQuery 调用，**但是**这也可以通过在实际 ajax 请求中设置选项“global:false”来覆盖。

如果您是这种情况，那么您几乎被 Ricardo 的回答所困扰：修改对 jQuery.ajax 的实际调用以进行绑定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T19:53:28.677

来自 ajaxSetup 的 jQuery 文档：

`Description: Set default values for future Ajax requests. Its use is not recommended.`

我建议您更改呼叫并将回调分配给您的特定 ajax 请求：

```
jQuery.ajax
    url: 'blah/blah',
    success: cbSuccess,
    error: cbError,
    etc 
```

# c# - ASP.NET MVC 中的自定义授权过滤器

> ID：16026320
> 
> 赞同：1
> 
> 时间：2013-04-15T23:30:27.940
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我有一个绑定到站点地图的 Telerik mvc 菜单。所有链接都已正确设置并成功绑定。但是在 post 方法中，如果使用 将模型发布回无效模型的视图`View(model)`，它会因以下错误而中断。它适用于 PRG 模式，即，如果我重定向到视图。

> INFO [System.NullReferenceException：对象引用未设置为对象的实例。在 Telerik.Web.Mvc.Infrastructure.Implementation.ControllerAuthorization.IsAccessibleToUser(RequestContext requestContext, String controllerName, String actionName, RouteValueDictionary routeValues) 在 f:\109\Griffin\Trunk Full\Sources\Source\Telerik.Web.Mvc\Infrastructure\ Implementation\ControllerAuthorization.cs：Telerik.Web.Mvc.Infrastructure.Implementation.NavigationItemAuthorization.IsAccessibleToUser(RequestContext requestContext, Inavigable navigationItem) 中的第 75 行：\109\Griffin\Trunk Full\Sources\Source\Telerik.Web.Mvc\ Infrastructure\Implementation\NavigationItemAuthorization.cs：第 38 行

通过代码调试，我发现它在内部调用 System.Web.MVC 类来检索节点的授权信息。下面是为无效模型返回 null 的行，否则如果它是重定向或正常 GET 操作，它可以正常工作。

```
ActionDescriptor actionDescriptor = controllerDescriptor.FindAction(controllerContext, actionName);
if (actionDescriptor == null) 
{
     return null; **//it returns null for View(model)**
}
return new AuthorizationContext(controllerContext, actionDescriptor) { Controller = { ControllerContext = controllerContext } }; 
```

**System.Web.Mvc 中的 FindAction 方法**。`RunSelectionFilters`正在从此方法中调用，该方法为正常和异常情况产生不同的输出。

```
 public MethodInfo FindActionMethod(ControllerContext controllerContext, string actionName)
        {
            List<MethodInfo> matchingAliasedMethods = this.GetMatchingAliasedMethods(controllerContext, actionName);
            matchingAliasedMethods.AddRange(this.NonAliasedMethods[actionName]);
            List<MethodInfo> ambiguousMethods = RunSelectionFilters(controllerContext, matchingAliasedMethods);
            switch (ambiguousMethods.Count)
            {
                case 0:
                    return null;

                case 1:
                    return ambiguousMethods[0];
            }
            throw this.CreateAmbiguousMatchException(ambiguousMethods, actionName);
        } 
```

RunSelectionFilters 方法`list2`为正常操作和`list`异常情况返回。

```
private static List<MethodInfo> RunSelectionFilters(ControllerContext controllerContext, List<MethodInfo> methodInfos)
        {
            List<MethodInfo> list = new List<MethodInfo>();
            List<MethodInfo> list2 = new List<MethodInfo>();
            using (List<MethodInfo>.Enumerator enumerator = methodInfos.GetEnumerator())
            {
                Func<ActionMethodSelectorAttribute, bool> predicate = null;
                MethodInfo methodInfo;
                while (enumerator.MoveNext())
                {
                    methodInfo = enumerator.Current;
                    ICollection<ActionMethodSelectorAttribute> actionMethodSelectorAttributes = ReflectedAttributeCache.GetActionMethodSelectorAttributes(methodInfo);
                    if (actionMethodSelectorAttributes.Count == 0)
                    {
                        list2.Add(methodInfo);
                    }
                    else
                    {
                        if (predicate == null)
                        {
                            predicate = attr => attr.IsValidForRequest(controllerContext, methodInfo);
                        }
                        if (actionMethodSelectorAttributes.All<ActionMethodSelectorAttribute>(predicate))
                        {
                            list.Add(methodInfo);
                        }
                    }
                }
            }
            if (list.Count <= 0)
            {
                return list2;
            }
            return list;
        } 
```

下面是自定义授权属性。此属性应用于 BaseController。

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method, AllowMultiple = false, Inherited = true)]
    public class AppActionAuthorizeAttribute : FilterAttribute, IAuthorizationFilter
    {       

        protected virtual bool AuthorizeCore(HttpContextBase httpContext)
        {
           return DBService.IsAuthorized(httpContext.RequestContext().RouteData.Values);
        }

        public virtual void OnAuthorization(AuthorizationContext filterContext)
        {
            if (filterContext == null)
            {
                throw new ArgumentNullException("filterContext");
            }
            if (OutputCacheAttribute.IsChildActionCacheActive(filterContext))
            {
                throw new InvalidOperationException("AuthorizeAttribute cannot be used within a child action caching block.");
            }

            if (this.AuthorizeCore(filterContext.HttpContext))
            {
                HttpCachePolicyBase cache = filterContext.HttpContext.Response.Cache;
                cache.SetProxyMaxAge(new TimeSpan(0L));
                cache.AddValidationCallback(new HttpCacheValidateHandler(this.CacheValidateHandler), null);
            }
            else
            {
                this.HandleUnauthorizedRequest(filterContext);
            }
        }

        private void CacheValidateHandler(HttpContext context, object data, ref HttpValidationStatus validationStatus)
        {
            validationStatus = this.OnCacheAuthorization(new HttpContextWrapper(context));
        }

        protected virtual HttpValidationStatus OnCacheAuthorization(HttpContextBase httpContext)
        {
            if (httpContext == null)
            {
                throw new ArgumentNullException("httpContext");
            }

            if (!this.AuthorizeCore(httpContext))
            {
                return HttpValidationStatus.IgnoreThisRequest;
            }
            return HttpValidationStatus.Valid;
        }
    } 
```

# c - 使用递归反转c中的字符串

> ID：16026321
> 
> 赞同：-6
> 
> 时间：2013-04-15T23:30:30.597
> 
> 标签：c, function, recursion

所以，我想要求用户输入一个单词，然后程序会反转它。这是我的代码，但无法正常运行。怎么了？

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char anadr(int, int, char pin[]);

main()
{
      char pin[100];
      int l;
      int i=0;
      char res;
      printf("Give word: ");
      scanf("%s", pin);
      l=strlen(pin);
      res=anadr(i,l,pin);
      system("pause");
}

char anadr(int i, int l, char pin[])
{
     if(i<l)
        anadr(i++,l,pin);
     printf("%c", pin[i]);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:35:27.113

为什么不

```
void anadr(int l, char pin[])
{
     if(l == 0)
          return;

     printf("%c", pin[l - 1]);
     anadr(l - 1, pin);
}

anadr(5, "abcde"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:40:16.553

您的所有代码似乎都试图做的是反向打印字符串。只需递归到终结器并在退出的路上转储字符。

```
void anadr(const char *p)
{
    if (!*p)
        return;
    anadr(p+1);
    putchar(*p); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:36:13.643

这里至少有一个问题：

```
if(i<l)
    anadr(i++,l,pin); 
```

这会导致无休止的递归，因为只有*在*其当前值作为参数传递后才会`i++`递增。尝试替换为.`i`*`i++``i + 1`*

 *此外，即使使用上述修复，比较也会导致额外的调用；处的字符`pin[l]`是终止 NUL，您几乎肯定不想打印它。所以比较应该是`if (i+1 < l)`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-15T23:40:23.037

你有一个错误，你不应该使用++。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void anadr(int, int, char pin[]);

int main()
{
      char pin[100];
      int l;
      int i=0;
      //char res;
      printf("Give word: ");
      scanf("%s", pin);
      l=strlen(pin);
      anadr(i,l,pin);
      //system("pause");
}

void anadr(int i, int l, char pin[])
{
     if(i<l-1)
        anadr(i+1,l,pin);
     printf("%c", pin[i]);
} 
```*

# c# - 如何发布包含 ICollection 的编辑器模板的表单？

> ID：16026323
> 
> 赞同：1
> 
> 时间：2013-04-15T23:30:36.353
> 
> 标签：c#, asp.net-mvc

我正在使用 ASP.NET MVC 4，我有以下模型：

```
public class MultiLanguageText
{
    [Key] public int Id { get; set; }
    [Required] public string Name { get; set; }
    public virtual ICollection<LocalizedText> LocalizedTexts { get; set; }
}

public class LocalizedText
{
    [Key] public int Id { get; set; }
    [ForeignKey("Language")] public int LanguageId { get; set; }
    public virtual Language Language { get; set; }
    [ForeignKey("MultiLanguageText")] public int MultiLanguageTextId { get; set; }
    public virtual MultiLanguageText MultiLanguageText { get; set; }
    public string Text { get; set; }
} 
```

我正在尝试创建一个编辑视图，`MultiLanguageText`该视图还将包含`LocalizedTexts`属性中每个项目的编辑器。表格是这样的：

```
@using (Html.BeginForm("Edit", "MultiLanguageText", FormMethod.Post)) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>MultiLanguageText</legend>
        @Html.HiddenFor(model => model.Id)
        <div class="editor-label">
            @Html.LabelFor(model => model.Name)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Name)
            @Html.ValidationMessageFor(model => model.Name)
        </div>
        @Html.EditorFor(model => model.LocalizedTexts)
        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
} 
```

我创建的编辑器模板（在文件中`~/Views/Shared/EditorTemplates/LocalizedText.cshtml`）如下：

```
<fieldset>
    <legend>LocalizedText</legend>
    @Html.HiddenFor(model => model.Id)
    <div class="editor-label">
        @Html.LabelFor(model => model.LanguageId)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.LanguageId)
        @Html.ValidationMessageFor(model => model.LanguageId)
    </div>
    <div class="editor-label">
        @Html.LabelFor(model => model.MultiLanguageTextId)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.MultiLanguageTextId)
        @Html.ValidationMessageFor(model => model.MultiLanguageTextId)
    </div>
    <div class="editor-label">
        @Html.LabelFor(model => model.Text)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Text)
        @Html.ValidationMessageFor(model => model.Text)
    </div>
</fieldset> 
```

我正在使用一些预先存在的值进行测试，当页面显示时，所有数据都正确显示在父编辑器和子编辑器中。但是，当我提交表单时，在任何子编辑器中所做的所有更改都将被忽略。

我的`HttpPost`方法是这样的：

```
 [HttpPost]
    public ActionResult Edit(MultiLanguageText multilanguagetext)
    {
        if (ModelState.IsValid)
        {
            db.Entry(multilanguagetext).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(multilanguagetext);
    } 
```

我的问题是：**如何从父模型及其子模型编辑器中发布所有值？**（我已经看到存在其他类似的问题，但我已经尝试了他们的解决方案，但他们似乎没有解决我的问题。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T07:11:16.347

我正在测试你的问题。我认为它已经完成并且所有值都已发布。但我认为您需要提供更多信息来解决您的问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T23:42:26.550

经过一番尝试，这是我发现可行的解决方案：

```
 [HttpPost]
    public ActionResult Edit(MultiLanguageText multilanguagetext)
    {
        if (ModelState.IsValid)
        {
            db.Entry(multilanguagetext).State = EntityState.Modified;
            foreach (var local in multilanguagetext.LocalizedTexts) db.Entry(local).State = EntityState.Modified;
            db.SaveChanges();
            return RedirectToAction("Index");
        }
        return View(multilanguagetext);
    } 
```

# r - 将时间序列合并为一个 xts

> ID：16026324
> 
> 赞同：0
> 
> 时间：2013-04-15T23:30:46.897
> 
> 标签：r, xts

我正在编写一个给定路径的函数，它将找到文件夹中的所有文件，并将所有 csv 读入一个 xts 对象。这些文件都有相同的日期，我希望每个文件成为 xts 中的另一列。我得到了以下函数，但在 temp[, 1] 中出现错误：维数不正确。我究竟做错了什么？

```
make.libor.xts <- function(folder){
  filenames <- list.files(path=folder, full.names=TRUE)
  tables <- lapply(filenames, function(x){as.xts(read.zoo(x, sep=",", format="%Y-%m-%d", header=TRUE))})
  cnames <- lapply(filenames, function(x){basename(x)})
  myxts <- tables[1]
  names(myxts) <- cnames[1]
  if(length(filenames)>1){
    for(i in 2:length(filenames)){
      temp <- tables[i]
      myxts$cnames[i] <- temp[,1]
    }
  }
  return(myxts)
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:39:02.893

您的代码可以简化如下。使用`Reduce`函数调用`merge.xts`xts 对象列表。

```
dir("temp")
## [1] "AAPL.csv" "IBM.csv"  "MSFT.csv"

READ.ALL.XTS <- function(folder) {
    filenames <- list.files(path = folder, full.names = TRUE)
    tables <- lapply(filenames, function(x) {
        as.xts(read.zoo(x, sep = ",", format = "%Y-%m-%d", header = TRUE))
    })

    # Lets see contents of tables
    cat("Calling from inside function begin...\n")
    print(head(tables[[1]]))
    print(head(tables[[2]]))
    print(head(tables[[3]]))
    cat("Calling from inside function end...\n")
    cnames <- sapply(filenames, function(x) {
        basename(x)
    })
    combinedxts <- Reduce(f = merge.xts, tables)
    names(combinedxts) <- cnames
    return(combinedxts)
}

result <- READ.ALL.XTS("temp")
## Calling from inside function begin...
##              [,1]
## 2013-01-03 542.10
## 2013-01-04 527.00
## 2013-01-07 523.90
## 2013-01-08 525.31
## 2013-01-09 517.10
## 2013-01-10 523.51
##              [,1]
## 2013-01-03 195.27
## 2013-01-04 193.99
## 2013-01-07 193.14
## 2013-01-08 192.87
## 2013-01-09 192.32
## 2013-01-10 192.88
##             [,1]
## 2013-01-03 27.25
## 2013-01-04 26.74
## 2013-01-07 26.69
## 2013-01-08 26.55
## 2013-01-09 26.70
## 2013-01-10 26.46
## Calling from inside function end...

head(result)
##            AAPL.csv IBM.csv MSFT.csv
## 2013-01-03   542.10  195.27    27.25
## 2013-01-04   527.00  193.99    26.74
## 2013-01-07   523.90  193.14    26.69
## 2013-01-08   525.31  192.87    26.55
## 2013-01-09   517.10  192.32    26.70
## 2013-01-10   523.51  192.88    26.46 
```

# vb.net - 将图像设置为 Itextsharp.text.cell 会引发错误

> ID：16026325
> 
> 赞同：0
> 
> 时间：2013-04-15T23:30:47.453
> 
> 标签：vb.net, itextsharp

将图像设置为单元格时出现问题

```
Dim CellAux As PdfPCell
CellAux = New PdfPCell(Image.GetInstance("../../Common/Images/image_logo.gif")) 
```

并引发下一个错误：`cant find path c:\windows\Common\Images\image_logo.gif`

为什么要在那里寻找图像？

我该怎么做才能在正确的目录中搜索图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:01:02.127

当你运行一个应用程序时，你总是从一个工作目录运行它。这不一定是您期望的目录。在任何情况下，您都在代码中使用相对路径，并且绝对路径将使用该相对路径与您的工作目录相结合来构建。这种情况下的结果是 c:\windows\Common\Images\image_logo.gif

# perl - 文件打开时出现 Win32::OLE 错误

> ID：16026330
> 
> 赞同：1
> 
> 时间：2013-04-15T23:30:54.593
> 
> 标签：perl, apache, excel, win32ole

我正在尝试使用 Win32::OLE 从我的网页中的 perl 在 windows/apache 服务器上打开一个 .xlsm 文件。

在研究这个问题时，遇到了以下可能的解决方案：

1.  很少有人通过将路径设置为绝对路径来解决它。这对我没有用。

2.  将脚本的权限设置为有权访问服务器上的文件。我不知道该怎么做。但是，我正在通过 Windows sspi 对我的用户进行身份验证，并且会有一个用户 ID。是否会验证该用户 ID 以在 Win32::OLE 上进行文件访问？

但是，我可以使用文件句柄打开文件。我之前已经使用文件句柄从我的网页中读取/写入了此服务器位置上的文件。win32::OLE 权限与此不同吗？

错误是：

```
Microsoft Excel cannot access the file 'C:\test.xlsm'. There are several
possible reasons:

• The file name or path does not exist.
• The file is being used by another program.
• The workbook you are trying to save has the same name as a currently open
workbook.

Win32::OLE(0.1709) error 0x800a03ec
    in METHOD/PROPERTYGET "Open" 
```

感谢任何输入。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-23T22:06:05.297

好的，在多次尝试修改权限并将apache作为具有所有必需权限的单独用户运行后，终于摆脱了错误，方法是在下为桌面创建一个配置文件文件夹

C:\Windows\SysWOW64\config\systemprofile\Desktop

在 msdn 论坛[http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required](http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required)中找到了这个解决方案 希望这将有助于使用这些模块的人未来

# c# - SecurityException 使用 RegistryKey.OpenSubKey()

> ID：16026331
> 
> 赞同：1
> 
> 时间：2013-04-15T23:31:02.957
> 
> 标签：c#, .net

这条线有效：

```
RegistryKey registryKey = Registry.LocalMachine.OpenSubKey(
    baseKeyName + subKey, RegistryKeyPermissionCheck.ReadWriteSubTree); 
```

虽然这些行产生`SecurityException - Requested registry access is not allowed on the OpenSubKey`一行：

```
RegistryKey baseKey = RegistryKey.OpenBaseKey(
   RegistryHive.LocalMachine, RegistryView.Registry32);
RegistryKey registryKey = baseKey.OpenSubKey(
   baseKeyName + subKey, RegistryKeyPermissionCheck.ReadWriteSubTree); 
```

在同一台Win7机器上。

我这样做是因为在“真实”代码中有一个条件将在 64 位机器上使用 Registry64 RegistryView。

有人有任何想法或解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:06:18.433

除非应用程序以管理员身份运行，否则不允许写入 LocalMachine 注册表区域。

# css - textarea中的CSS空白属性？

> ID：16026332
> 
> 赞同：4
> 
> 时间：2013-04-15T23:31:24.470
> 
> 标签：css, textarea

我想`white-space`在 HTML 中使用 CSS 属性`textarea`。

基本上，如果有人在 a 中键入一堆带有换行符的文本`textarea`，然后将此数据提交存储在 MySQL 中，我想使用`white-space`CSS 属性在 textarea 中显示这些换行符。但是当我尝试它时，它不起作用，只是将文本全部显示在一个大段落中，没有任何中断或任何东西。有没有办法做到这一点？

```
<form action="includes/changebio.php" method="post" id="form1">         
 <textarea id="bio" style="width: 440px; 
    margin-top:3px;
    text-align:left;
    margin-left:-2px;
    height: 120px;
    resize: none; 
  outline:none;
  overflow:scroll;

  **white-space:pre-line;**

    border: #ccc 1px solid;" textarea name="bio" data-id="bio" maxlength="710" placeholder="<?php echo stripslashes($profile['bio']); ?>"></textarea>
<input type="image" src="assets/img/icons/save-edit.png"class="bio-submit" name="submit" value="submit" id="submit"/>
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-04-19T17:46:36.897

```
textarea{white-space:pre} 
```

当我看到这个时，这是因为您的 textarea 正在从某些东西继承一个 white-space:nowrap 。它也可以通过 textareas 上的 wrap="no" 来复杂化，这有时会很有用。

textarea nowrap 的默认行为是 pre，因此只需在样式底部设置上述 CSS 即可覆盖设置空白的任何位置。

如果您检查您的 textarea 元素，您肯定会发现在层次结构中的某处，您在某些类型的元素上设置了 nowrap 属性，该属性覆盖了默认的 textarea 行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:36:12.080

不。

`<textarea>`元素已经从字面上处理了空格。没有必要尝试将事情掌握在自己手中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-16T03:32:06.103

事情对我来说似乎一切正常......把它扔进一个codepen只是为了测试它。直接添加时，换行符在文本区域内看起来很好。

不知道怎么回事。PHP是否剥离换行符？您是否在通过 $profile['bio'] 传递的任何内容周围使用双引号？

这是一个可能对您有所帮助的答案：[textarea 的 .val() 不考虑换行](https://stackoverflow.com/questions/8481025/the-val-of-a-textarea-doesnt-take-new-lines-into-account)

尤其是最后一个回应。根据您的代码，听起来 .replace() 方法不是您所需要的（但我可能是错的......也许我不明白您在做什么）。

# java - Camel + Jackson：为所有反序列化注册一个模块

> ID：16026333
> 
> 赞同：2
> 
> 时间：2013-04-15T23:31:27.020
> 
> 标签：java, jackson, apache-camel

我在我的应用程序中使用 Camel，消息以 JSON 形式进入路由。我使用 JACKSON 作为我的反序列化器。我有一个案例，我需要一个自定义序列化器/反序列化器来处理我的一条消息。

我想要做的是为键注册自定义序列化器/反序列化器。在 Camel 中，我如何确保在我的路由中编组/解组时序列化器/反序列化器可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-16T12:45:31.403

您可以定义要使用的数据格式

```
.unmarshal(<dataFormatComponent>) 
```

[http://camel.apache.org/data-format.html](http://camel.apache.org/data-format.html)

[http://camel.apache.org/json.html](http://camel.apache.org/json.html)

# android - 翻译文件支持

> ID：16026335
> 
> 赞同：0
> 
> 时间：2013-04-15T23:31:32.890
> 
> 标签：android, string, translation

这不是一个**编码**问题，而是一个理论问题。我知道 SO 坚持编码，但后来我找不到任何与我的问题相关的答案。

我正在开发一个应用程序 (Android)，*以提供对新语言的支持并为现有语言的新功能快速添加翻译*。我想了解一些研究它的资源，了解需要在应用程序中实现的各种常见选项。

**基本上，我怀疑应用程序中必须**实施哪些不同选项才能*为新语言提供支持并为现有语言的新功能快速添加翻译*。

请张贴任何有用的链接到帖子/博客/学术文章/书籍/或任何相关内容。

假设用户必须将字符串从语言转换为标准`X`语言`Y`包中可能不包含的语言。为此，使用了可翻译的字符串。两个强制性选项（在应用程序中）将是：

1.  用户 从语言中选择要翻译的字符串`X`。
2.  选择必须翻译成的语言`Y`（从弹出窗口中）。

像这样，我应该为一个像样的应用程序实现多少不同的选项。

# c++ - boost::asio::deadline_timer::async_wait 内部的段错误

> ID：16026339
> 
> 赞同：2
> 
> 时间：2013-04-15T23:32:00.023
> 
> 标签：c++, boost, asynchronous, segmentation-fault, boost-asio

`deadline_timer::async_wait`当我调用我的方法时，偶尔会抛出一个段错误`SendMessageAgain`。它可以以两种方式之一发生；我在下面包含了回溯。它似乎是随机的，这让我觉得某种程度上涉及到一个竞争条件。我有一个带有`io_service`对象的类`ioService`和多个线程，每个线程都有定时器挂钩`ioService`。`ioService`打电话之前我可能需要锁定`async_wait`吗？我认为它处理了那个。

也许它与计时器滴答时任何代码被中断有关。当其他代码也在执行时，设置截止时间计时器的正确方法是什么？

我使用的代码`SendMessageAgain`是

```
void Node::SendMessageAgain(unsigned long seqNum) {
  // figure out if and what to send (using object fields)
  if (should_send_again) {
    Send(...);
    timer->expires_from_now(INTERVAL);
    timer->async_wait(bind(&Node::SendMessageAgain, this, seqNum));
  }
} 
```

```
#0 0x08060609 in boost::asio::detail::deadline_timer_service<boost::asio::time_traits<boost::posix_time::ptime> >::async_wait<boost::_bi::bind_t<void, boost::_mfi ::mf1<void, Node, unsigned long>, boost::_bi::list2<boost::_bi::value<Node*>, boost::_bi::value<unsigned long> > > > (this=0x14 , impl=..., 处理程序=...)
    在 /usr/include/boost/asio/detail/deadline_timer_service.hpp:170
#1 0x0805e2e7 in boost::asio::deadline_timer_service<boost::posix_time::ptime, boost::asio::time_traits<boost::posix_time::ptime> >::async_wait<boost::_bi::bind_t<void , boost::_mfi::mf1<void, Node, unsigned long>, boost::_bi::list2<boost::_bi::value<Node*>, boost::_bi::value<unsigned long> > > > (this=0x0, impl=...,
    handler=...) 在/usr/include/boost/asio/deadline_timer_service.hpp:135
#2 0x0805bcbb in boost::asio::basic_deadline_timer<boost::posix_time::ptime, boost::asio::time_traits<boost::posix_time::ptime>, boost::asio::deadline_timer_service<boost::posix_time: :ptime, boost::asio::time_traits<boost::posix_time::ptime> >::async_wait<boost::_bi::bind_t<void, boost::_mfi::mf1<void, Node, unsigned long> , boost::_bi::list2<boost::_bi::value<Node*>, boost::_bi::value<unsigned long> > > > (this=0x807fc50, handler=...)
    在 /usr/include/boost/asio/basic_deadline_timer.hpp:435
#3 0x080555a2 在 Node::SendMessageAgain (this=0xbffeffdc, seqNum=8)
    在 node.cpp:147

```

```
#0 __pthread_mutex_lock (mutex=0x2f200c4) 在 pthread_mutex_lock.c:50
#1 0x08056c79 in boost::asio::detail::posix_mutex::lock (this=0x2f200c4)
    在 /usr/include/boost/asio/detail/posix_mutex.hpp:52
#2 0x0805a036 in boost::asio::detail::scoped_lock<boost::asio::detail::posix_mutex>::scoped_lock (this=0xbfffeb04, m=...)
    在 /usr/include/boost/asio/detail/scoped_lock.hpp:36
#3 0x08061dd0 in boost::asio::detail::epoll_reactor::schedule_timer<boost::asio::time_traits<boost::posix_time::ptime> > (this=0x2f200ac, queue=...,
    时间=...，计时器=...，操作=0x807fca0)
    在 /usr/include/boost/asio/detail/impl/epoll_reactor.hpp:43
#4 0x0806063a 在 boost::asio::detail::deadline_timer_service<boost::asio::time_traits<boost::posix_time::ptime> >::async_wait<boost::_bi::bind_t<void, boost::_mfi ::mf1<void, Node, unsigned long>, boost::_bi::list2<boost::_bi::value<Node*>, boost::_bi::value<unsigned long> > > > (this=0xb6b005fc , 暗示=...,
    处理程序=...)
    在 /usr/include/boost/asio/detail/deadline_timer_service.hpp:170
#5 0x0805e2fd in boost::asio::deadline_timer_service<boost::posix_time::ptime, boost::asio::time_traits<boost::posix_time::ptime> >::async_wait<boost::_bi::bind_t<void , boost::_mfi::mf1<void, Node, unsigned long>, boost::_bi::list2<boost::_bi::value<Node*>, boost::_bi::value<unsigned long> > > > (这=0xb6b005e8,
    实现=...，处理程序=...）
    在 /usr/include/boost/asio/deadline_timer_service.hpp:135
#6 0x0805bcd1 in boost::asio::basic_deadline_timer<boost::posix_time::ptime, bo---键入 <return> 继续，或 q <return> 退出---
ost::asio::time_traits<boost::posix_time::ptime>, boost::asio::deadline_timer_service<boost::posix_time::ptime, boost::asio::time_traits<boost::posix_time::ptime> > >::async_wait<boost::_bi::bind_t<void, boost::_mfi::mf1<void, Node, unsigned long>, boost::_bi::list2<boost::_bi::value<Node*> , boost::_bi::value<unsigned long> > > > (this=0xb6b005a0, handler=...)
    在 /usr/include/boost/asio/basic_deadline_timer.hpp:435
#7 0x080555a7 在 Node::SendMessageAgain (this=0xbffeffdc, seqNum=9)
    在 node.cpp:148

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T04:18:57.017

好吧，已经修好了。正如 Sam 所建议的，这是一个对象生命周期问题，尽管`Node`. 我在拥有的对象中有一个计时器`Node`。我的代码中有一个竞争条件，我在临界区之外重置计时器，并且它的所有者在临界区结束和计时器重置之间被破坏。我只是扩展了关键部分并修复了它。

我不确定为什么段错误会在这么远的地方表现出来`async_wait`，因为回调（和关联的`this`指针）属于`Node`，它仍然存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:17:39.290

坏的：

```
timer->async_wait(bind(&Node::SendMessageAgain, this, seqNum, _1)); 
```

好的：

```
timer->async_wait(bind(&Node::SendMessageAgain, shared_from_this(), seqNum, _1)); 
```

让节点扩展 enable_shared_from_this

```
class Node : public boost::enable_shared_from_this<Node> 
```

如果它是由于您的节点被销毁而仍在为其安排回调而导致的，这可以解决问题。

# android - Android 操作栏导航

> ID：16026341
> 
> 赞同：0
> 
> 时间：2013-04-15T23:32:12.033
> 
> 标签：android, android-actionbar

我的操作栏上有微调导航，并为此设置了导航监听器。创建活动时，侦听器（如下）选择默认微调器项目，这意味着案例 0 在创建时运行，打开另一个活动。创建活动时如何停止它注册导航更改？

```
 ActionBar.OnNavigationListener navigationListener = new OnNavigationListener() {
        public boolean onNavigationItemSelected(int itemPosition, long itemId) {
            switch(itemPosition) {
            case 0:

                Intent i = new Intent(Main.this, Example.class);
                startActivity(i);
                break;
            case 1:
                Intent i2 = new Intent(Main.this, Example.class);
                startActivity(i2);
                break;
            case 2:
                Intent i3 = new Intent(Main.this, Example.class);
                startActivity(i3);
                break;
            case 3:
                Intent i4 = new Intent(Main.this, Example.class);
                startActivity(i4);
                break;
            }
        return false;
    }
    }; 
```

**更新：** 认为我解决了这个问题，我声明了一个布尔标志，将其更改为 false oncreate。

```
ActionBar.OnNavigationListener navigationListener = new OnNavigationListener() {
    public boolean onNavigationItemSelected(int itemPosition, long itemId) {
        switch(itemPosition) {
        case 0:
            if(flag == true) {
                if(Main.class == Main.class) {

                } else {
            Intent i = new Intent(Main.this, Main.class);
            startActivity(i);   
                }
            }
            if(flag == false) {
                flag = true;
            }
            break;
        case 1:
            Intent i2 = new Intent(Main.this, Example.class);
            startActivity(i2);
            break;
        case 2:
            Intent i3 = new Intent(Main.this, Example.class);
            startActivity(i3);
            break;
        case 3:
            Intent i4 = new Intent(Main.this, Example.class);
            startActivity(i4);
            break;
        }
        return false;
    }
    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:18:49.817

可能有一种更简单的方法，但您可以将`boolean`标志设置为 false 并在侦听器中检查该标志，然后在第一次设置后将其设置为 true，以便在您第一次运行代码时`onCreate()`不会运行代码。`Intent`根据您的需要，您可能需要将其放入，`onResume()`这样如果您重新放入它就不会运行`Activity`

# c# - 如何在 Linq 中从逗号分隔的字符串中选择标记和索引

> ID：16026342
> 
> 赞同：3
> 
> 时间：2013-04-15T23:32:17.137
> 
> 标签：c#, linq, data-structures

给定一个逗号分隔的字符串“a,b,c”，我想拆分字符串并将标记及其各自的索引选择到一个列表中。

换句话说，我想`"a,b,c".Split(',')`返回一个列表：

```
a, 1
b, 2
c, 3 
```

我自己尝试了解决方案，但这与我得到的一样接近。当然，我只`a.Index()`在最后一行使用来表明我正在尝试做什么。

```
public class var
{
    public string Token;
    public int Index;
}

List<var> varList = "a,b,c"
                       .Split(',')
                       .Select(a => new var { Token = a, Index = a.Index() }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:37:12.773

您可以使用 的另一个重载`Select`，[`.Select(Func<string, int, TResult>)`](http://msdn.microsoft.com/en-us/library/bb534869.aspx)它为我们提供了值的索引。

```
List<Var> varList = "a,b,c".Split(',')
    .Select((a, i) => new Var { Token = a, Index = i + 1 })
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T23:37:23.120

您可以使用提供索引的[Select的重载：](http://msdn.microsoft.com/en-us/library/bb534869.aspx)

```
var list = "a,b,c".Split(',').Select((a,i) => new { Token = a, Index = i+1 }).ToList(); 
```

附带说明 - 我建议不要`var`用作类名，因为它会与[C#`var`关键字](http://msdn.microsoft.com/en-us/library/bb383973.aspx)冲突。

# php - 使用个人验证重置密码

> ID：16026343
> 
> 赞同：0
> 
> 时间：2013-04-15T23:32:19.350
> 
> 标签：php, javascript, mysql

我是 php 新手，试图学习一些东西。我正在尝试编写一个脚本，允许用户在验证个人信息后重置密码。除了这个 php 脚本之外，一切都运行良好。此脚本从表单输入字段接收数据。该程序应该输出：

```
echo $e.'&u='. $us .'&er='.$err.'&o='. $bulls3 .'&r='.$bulls4;

            exit(); 
```

可以作为respondText发送到ajax。问题是这个 php 脚本没有按预期工作，并给我以下错误消息。有没有人可以帮助我。任何帮助将不胜感激。提前谢谢你的帮助..

错误输出消息：

警告：mysqli_num_rows() 期望参数 1 为 mysqli_result，布尔值在 C:\xampp\htdocs\myGenius\identityverify.php 第 119 行联系方式中给出

```
<?php
// AJAX CALLS THIS CODE TO EXECUTE
if(isset($_POST["bd"])){
    $bad= preg_replace('#[^0-9-]#i', '', $_POST['bd']);
    //Connect to database
    include_once("php_includes/connect_to_mysqli.php");
    $e = mysqli_real_escape_string($db_conx,$_POST['e']);
    $c= preg_replace('#[^a-z ]#i', '', $_POST['c']);
    $post= preg_replace('#[^a-z0-9]#i', '', $_POST['pst']);
    $user= preg_replace('#[^a-z0-9]#i', '', $_POST['us']);
    $odd= preg_replace('#[^a-z0-9]#i', '', $_POST['od']);

    if($e =="" || $bad =="" || $c=="" ||$post==""){
        echo "empty";
        exit();
        }else if($user=="" || $odd==""){
            echo "no_exist";
            exit();
        }else{

    $sql = "SELECT id, username FROM user WHERE email='$e' AND activated='1' LIMIT 1";
    $query = mysqli_query($db_conx, $sql);
    $numrows = mysqli_num_rows($query);
    if($numrows > 0){
        while($row = mysqli_fetch_array($query, MYSQLI_ASSOC)){
            $id = $row["id"];
            $u = $row["username"];  

//Encrypted values to check with user input passed from hidden fields           
                    //Check codes
            $bull= value1;
            $bull2= value2;
            $bull3= value3;
            $bull3=value4;
            $us= value5;
            $err= value6;

        }
        if($user==$us && $odd==$err){   

    $sql = "SELECT country, birthday, postal FROM useroptions WHERE email='$e' AND username='$u' LIMIT 1";
    $query = mysqli_query($db_conx, $sql);
    $numrows = mysqli_num_rows($query);
    if($numrows > 0){
        while($row = mysqli_fetch_array($query, MYSQLI_ASSOC)){
            $con = $row["country"];
            $bday = $row["birthday"];
            $poost = $row["postal"];

        }

if($c == $con && $bad == $bday && $post==$poost){
// encoded value using some type of encryption for passing data to another web page based on user information data
                $bulls= value1;
                $bulls2= value2;
                $bulls1=value3;
                $bulls3= value4;
                $bulls4= value5;
                $bulls3=value6;
                $bulls4=value7;

            echo $e.'&u='. $us .'&er='.$err.'&o='. $bulls3 .'&r='.$bulls4;

            exit();
        }else{
            echo "wrong";
            exit();
            }

        }else {
        echo "contact";
        exit();
    }//user option not set
    }else{
        echo "no_exist";
        exit();
        }//end code comparison and send to error page
    }else{
        echo "no_exist";
        exit();
        }
        exit();
}}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:41:33.827

我总是使用两个查询，而不是让服务器返回匹配的所有内容

1.  `select count(*) from database where condition='expected';`
2.  根据`if()`验证初始结果的子句执行第二个查询。

由于我的主要查询尚未执行，因此可以防止注入。

尝试更换

```
if(isset($_POST["bd"])){ 
```

和

```
if(!empty($_POST["bd"])){ 
```

# python - 为 Python 安装准备 _tkinter 和 sqlite3（无管理员权限）

> ID：16026348
> 
> 赞同：5
> 
> 时间：2013-04-15T23:32:38.790
> 
> 标签：python, tkinter

我正在尝试直接从源代码构建 Python，没有管理员权限，运行后：

> export CPPFLAGS='-I/opt/sqlite-3.7.16.2/include -I/opt/tk8.6.0/include
> -I/opt/tcl8.6.0/include/'
> 
> 导出 LDFLAGS='-L/opt/sqlite-3.7.16.2/lib -L/opt/tk8.6.0/lib/
> -L/opt/tcl8.6.0/lib/ ./configure --prefix=/path_to_python-2.7。 4 --启用共享'

进而

```
make 
```

我得到以下信息：

> 构建“_tkinter”扩展
> 
> gcc -pthread -fPIC -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -DWITH_APPINIT=1 -I/usr/X11/include -I。-IInclude -I./Include -I/opt/sqlite/sqlite-3.7.16.2/include -I/opt/tk8.6.0/include -I/opt/tcl8.6.0/include -I/usr/local/include - I/opt/python/src/Python-2.7.4/Include -I/opt/python/src/Python-2.7.4 -c /opt/python/src/Python-2.7.4/Modules/_tkinter.c - o build/temp.linux-x86_64-2.7/opt/python/src/Python-2.7.4/Modules/_tkinter.o
> 
> gcc -pthread -fPIC -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -DWITH_APPINIT=1 -I/usr/X11/include -I。-IInclude -I./Include -I/opt/sqlite/sqlite-3.7.16.2/include -I/opt/tk8.6.0/include -I/opt/tcl8.6.0/include -I/usr/local/include - I/opt/python/src/Python-2.7.4/Include -I/opt/python/src/Python-2.7.4 -c /opt/python/src/Python-2.7.4/Modules/tkappinit.c - o build/temp.linux-x86_64-2.7/opt/python/src/Python-2.7.4/Modules/tkappinit.o
> 
> gcc -pthread -shared -L/opt/sqlite/sqlite-3.7.16.2/lib -L/opt/tk8.6.0/lib/ -L/opt/tcl8.6.0/lib/ -L/opt/sqlite/sqlite- 3.7.16.2/lib-L/opt/tk8.6.0/lib/-L/opt/tcl8.6.0/lib/-I。-IInclude -I./Include -I/opt/sqlite/sqlite-3.7.16.2/include -I/opt/tk8.6.0/include -I/opt/tcl8.6.0/include build/temp.linux-x86_64-2.7 /opt/python/src/Python-2.7.4/Modules/_tkinter.o build/temp.linux-x86_64-2.7/opt/python/src/Python-2.7.4/Modules/tkappinit.o -L/usr/ X11/lib -L/opt/sqlite/sqlite-3.7.16.2/lib -L/opt/tk8.6.0/lib/ -L/opt/tcl8.6.0/lib/ -L/usr/local/lib -L。-ltk8.6 -ltcl8.6 -lX11 -lpython2.7 -o build/lib.linux-x86_64-2.7/_tkinter.so
> 
> ***警告：重命名“_tkinter”，因为导入失败：libtk8.6.so：无法打开共享对象文件：没有这样的文件或目录

奇怪的是，我可以看到`libtk8.6.so`。它实际上就在`/opt/tcl8.6.0/lib`我指定的下方`LDFLAGS`。

为什么编译失败？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T18:00:08.790

这个问题发生在安装过程中`setup.py`，当 Python 尝试导入时`_tkinter`。如果你看一下 function `build_extension`，有一个块说：

```
imp.load_dynamic(ext.name, ext_filename) 
```

这一行尝试动态加载`_tkinter` （使用动态共享库`libtk8.6.so`）。因此，即使编译/链接工作正常，当 Python 测试模块时，它也会使用动态库，而且我在`LD_LIBRARY_PATH`. 一旦我添加了这些，一切都很好。

总之：我必须添加以下包含路径`CPPFLAGS`

*   `/path_to/sqlite3/include`
*   `/path_to/tcl/include`
*   `/path_to/tk/include`

以下lib路径通过`LDFLAGS`

*   `/path_to/sqlite3/lib`
*   `/path_to/tcl/lib`
*   `/path_to/tk/lib`

以及以下通过的库路径`LD_LIBRARY_PATH`：

*   `/path_to/sqlite3/lib`
*   `/path_to/tcl/lib`
*   `/path_to/tk/lib`

有了这一切，一切正常。

# ruby-on-rails - 重新创建版本 -carrierwave-fog-aws

> ID：16026350
> 
> 赞同：12
> 
> 时间：2013-04-15T23:32:54.890
> 
> 标签：ruby-on-rails, amazon-s3, carrierwave, fog, recreate

我正在尝试在我的模型中使用以下内容重新创建我上传的图像......

```
 Post.all.each do |ym| 
      ym.avatar.cache_stored_file! 
      ym.avatar.retrieve_from_cache!(ym.avatar.cache_name) 
      ym.avatar.recreate_versions! 
      ym.save! 
  end 
```

不幸的是，我收到以下错误....

```
(undefined method `body' for nil:NilClass): 
```

我的上传器名为 AvatarUploader，适用于我的 Post 模型。关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-02-15T15:44:41.110

在只读服务器（Heroku）上使用异步处理时，我遇到了类似的问题。就我而言，在定义文件大小时出现问题，我`def size`从雾文件类中解决了猴子修补问题：

```
module CarrierWave
  module Storage
    class Fog < Abstract
      class File
        def size
          file.nil? ? 0 : file.content_length
        end
      end
    end
  end
end 
```

如果问题仍然存在并且当您从回溯和 gems 配置中发布更多详细信息时，我可以为您提供更多帮助。

# php - 任务（父）和任务实例（子）：使用 PHP 和 MySQL 从 6 个图像中选择 1 个？

> ID：16026352
> 
> 赞同：0
> 
> 时间：2013-04-15T23:33:09.293
> 
> 标签：php, mysql

我正在为一个显示页面编译一个带有 HTML 输出的 MySQL 查询，但希望能得到一些指导。任何帮助将非常感激！

**背景：** TaskInstance 是孩子，而 Tasks 和 Student 都是父母。每次学生注册任务时，TaskInstance 表都会不断增长，但 Tasks 表的数量是有限的，例如 20。每个任务都位于 Tasks 表中，并具有一些通用特性。用户可以注册一项任务，然后可以使用 TaskInstance 表将独特的品质分配给该任务。TaskInstance 变量包括：

*   TkInstanceInfoA、TkInstanceInfoB、TkInstanceInfoC、TkInstanceInfoD 允许各种描述等。
*   TkInstanceSide 指示任务是在右侧、左侧完成还是没有边（L、R 或 null）
*   fkTkID 告诉我们哪个 Task 是 TaskInstance 的父级
*   fkStID 告诉我们哪个 Student 是 TaskInstance 的父级

**数据库：**

```
Students
1.) StID
2.) StNameFirst
3.) StNameLast
4.) StGender
5.) StPasscode
6.) fkProID

Tasks
1.) TkID
2.) TkSide (the task by nature has a side?: Y or N) 
3.) TkImgML
4.) TkImgMR 
5.) TkImgMC 
6.) TkImgFL 
7.) TkImgFR
8.) TkImgFC
9.) TkTitleSci
10.) TkTitleCom
11.) TkDesc

TaskInstance
1.) TkInstID
2.) TkInstSide (which side is the task?: L, R or null)
3.) TkInstInfoA
4.) TkInstInfoB
5.) TkInstInfoC
6.) TkInstInfoD
7.) TkInstCustomTitleSci
8.) TkInstCustomTitleCom
9.) TkInstCustomDesc
10.) TkInstOrder
11.) fkTkID
12.) fkStID 
```

**MySQL：**

*更新：美国东部时间 2013 年 4 月 16 日下午 12:03：*我将 SELECT AND SELECT CASE 颠倒了，并且缺少逗号。现在更正了，但仍然中断：

```
$CurrentStID = 1; // known previously
$CurrentStGender = M; // known previously

SELECT *, 
   CASE StGender
       WHEN 'M' THEN
           CASE IFNULL(TkInstSide, 'C')
                WHEN 'L' THEN TkImgML
                WHEN 'R' THEN TkImgMR
                ELSE TkImgMC
           END
       WHEN 'F' THEN
           CASE IFNULL(TkInstSide, 'C')
                WHEN 'L' THEN TkImgFL
                WHEN 'R' THEN TkImgFR
                ELSE TkImgFC
           END
   END TkImgCase,
   CASE StTitlePref
       WHEN 'Common' THEN
           CASE WHEN TkInstCustomTitleCom IS NULL 
                THEN TkTitleCom 
                ELSE TkInstCustomTitleCom
           END
       WHEN 'Scientific' THEN
           CASE WHEN TkInstCustomTitleSci IS NULL 
                THEN TkTitleSci 
                ELSE TkInstCustomTitleSci
           END
   END TkTitleCase
FROM TaskInstance 
LEFT JOIN Tasks ON fkTkID = TkID 
LEFT JOIN Students ON fkStID = StID
WHERE fkStID = $CurrentStID 
ORDER BY TkInstOrder 
```

**打印：**

**1.）检查自定义标题和描述，否则使用标准：**

*更新：2013 年 4 月 16 日美国东部标准时间上午 11:52：*我一直在挂断自定义标题。我的调整应该起作用吗？它似乎失败了。

```
if ($row['StTitlePref'] == "Common") && (strlen(trim($row['TkInstCustomTitleCom'])) > 0) { $TkTitle = $row['TkInstCustomTitleCom'] } // will be default or custom
else if ($row['StTitlePref'] == "Scientific") && (strlen(trim($row['TkInstCustomTitleSci']) > 0) { $TkTitle = $row['TkInstCustomTitleSci'] } // will be default or custom 
```

**2.) 从六张图片中选择一张：**

使用 MySQL 使用性别消除 6 张图像中的 3 张，然后使用 PHP if/then 选择剩余 3 张图像中的 1 张是否很好？

> 如果Student的性别（StGender）是男性，并且Task有一面（TkSide），则显示正确的图像：如果是L面（TkInstanceSide），则显示L男性图像（TkImgML）；如果是 R 端 (TkInstanceSide)，则显示 R 男性图像 (TkImgMR)。如果学生的性别（StGender）是男性，并且任务没有侧面（TkSide）[也 TkInstanceSide 为空]，则显示中心男性图像（TkImgMC）。
> 
> 如果Student的性别（StGender）是女性，并且Task有一面（TkSide），则显示正确的图像：如果是L-side（TkInstanceSide），则显示L个女性图像（TkImgFL）；如果是 R 侧 (TkInstanceSide)，则显示 R 女性图像 (TkImgFR)。如果学生的性别（StGender）是女性，并且任务没有侧面（TkSide）[也 TkInstanceSide 为空]，则显示中心女性图像（TkImgFC）。

**3.) 显示与此实例相关的附加信息：**

显示这 4 个变量：TkInstanceInfoA、TkInstanceInfoB、TkInstanceInfoC、TkInstanceInfoD。

**所以，最终是这样的：**

```
echo ‘&lt;p>’ . $TkTitleCom . ‘&lt;br>’;  // show either standard title or custom title
echo $TkDesc . ‘&lt;br>’; // show either standard description or custom description
echo $TkInstanceInfoA . ‘&lt;br>’;
echo $TkInstanceInfoB . ‘&lt;br>’;
echo $TkInstanceInfoC . ‘&lt;br>’;
echo $TkInstanceInfoD . ‘&lt;br>’;
echo $CorrectImg  . ‘&lt;/p>’;  // show either TkImgML, TkImgMR, TkImgMC, TkImgFL, TkImgFR or TkImgFC 
```

***2013 年 4 月 18 日：后续问题（类似）***

亲爱的巴尔玛：非常感谢您的帮助。如果你有时间，我有一个后续问题。我有一个显示页面，我只是想从 Tasks 表中提取（而不是像以前那样从 TaskInstance 表中提取）。

我从上一个查询中知道 $CurrentStGender 和 $CurrentStTitlePref。我仍然想使用 CASE 语句来选择正确的图像（1 of 6）和正确的标题偏好。我很难弄清楚如何将我的两个已知变量提供给 SQL。你能帮我吗？

```
// echo $CurrentStGender . ', ' . $CurrentStTitlePref;

if ($result = $mysqli->query("
SELECT *, 
   CASE CurrentStGender
       WHEN 'M' THEN
           CASE WHEN TkSide == 'Y' THEN TkImgML /* if task can be done on a side, show just the L-side
                ELSE TkImgMC
           END
       WHEN 'F' THEN
           CASE WHEN TkSide == 'Y' THEN TkImgFL /* if task can be done on a side, show just the L-side
                ELSE TkImgFC
           END
   END TkImgCase,
   CASE StTitlePref
       WHEN 'Common' THEN TkTitleCom 
           END
       WHEN 'Scientific' THEN TkTitleSci 
           END
   END TkTitleCase
FROM Tasks 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:16:03.990

**(1) 打印**

```
if (strlen(trim($TkInstCustomTitleCom)) > 0) $tkTitleCom = $tkInstCustomTitleCom;
echo $tkTitleCom; // will be default or custom 
```

**(2) 打印**

试试这个而不是`if ... else`; （括号）内的表达式称为 a `ternary operator`，第 2 行中的表达式是 a `variable variable`：

```
$image = "TkImg" . $StGender . ($TkSide=='Y'?$TkInstanceSide:'C');
$imagename = $$image; // now $imagename contains the content of e.g. $TkImgMC 
```

看到它工作：[http ://codepad.viper-7.com/abpxbU](http://codepad.viper-7.com/abpxbU)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:22:47.780

您可以在 SQL 中根据性别和侧面选择图像：

```
SELECT *, 
       CASE StGender
           WHEN 'M' THEN
               CASE IFNULL(TkSide, 'C')
                    WHEN 'L' THEN TkImgML
                    WHEN 'R' THEN TkImgMR
                    ELSE TkImgMC
               END
           WHEN 'F' THEN
               CASE IFNULL(TkSide, 'C')
                    WHEN 'L' THEN TkImgFL
                    WHEN 'R' THEN TkImgFR
                    ELSE TkImgFC
               END
       END TkImg
FROM TaskInstance 
LEFT JOIN Tasks ON fkTkID = TkID 
LEFT JOIN Students ON fkStID = StID
WHERE fkStID = $CurrentStID 
ORDER BY TkInstOrder 
```

后续回复：

有两种方法可以做到这一点。一种是保留当前的两级 CASE 结构，但将列名替换为您用 PHP 变量填充的文字（CASE 语句中允许使用任何表达式，因此文字与列名一样好） ：

```
CASE '$CurrentStGender'
   WHEN 'M' THEN ...
   WHEN 'F' THEN ...
END TkImgCase,
CASE '$CurrentStTitlePref'
    WHEN 'Common' THEN TkTitleCom 
        END
    WHEN 'Scientific' THEN TkTitleSci 
        END
END TkTitleCase 
```

另一个利用了您的列遵循命名约定这一事实，因此您可以直接插入列名：

```
$titleAbbrev = substr($CurrentStTitlePref, 0, 3);
if ($result = $mysqli->query("
  SELECT *,     
     CASE WHEN TkSide == 'Y' THEN TkImg{$CurrentStGender}L
          ELSE TkImg{$CurrentStGender}C
     END TkImgCase,
     TkTitle{$titleAbbrev} TkTitleCase
  FROM Tasks"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T00:37:44.610

**SQL**

```
$sql = <<<SQL
SELECT *
FROM TaskInstance
LEFT JOIN Tasks ON fkTkID = TkID
WHERE fkStID = :stID
ORDER BY TkInstOrder 
SQL; 
```

相同但不同：

```
$sql = "SELECT * FROM TaskInstance LEFT JOIN Tasks ON fkTkID = TkID WHERE fkStID = :stID ORDER BY TkInstOrder"; 
```

`:stID`是参数，查询是参数化查询。它对 SQL 注入是安全的。您将使用 PDO 函数而不是 mysql_* （已弃用）。

我认为这应该可以解决问题。

# android - 将外部 jars 添加到 Android UIautomator 项目

> ID：16026355
> 
> 赞同：4
> 
> 时间：2013-04-15T23:33:36.670
> 
> 标签：android, jsch, android-uiautomator

似乎有很多关于向 android 项目和 ant 项目添加外部 jar 的问题，但我没有找到适用于这种情况的解决方案。我对 Ant 不太熟悉，这可能会激怒这个问题。

问题是：我正在尝试将 JSch 库添加到我的 uiautomator 项目中。我将 jsch.jar 文件放入 /libs 文件夹中，希望它会被“android create uitest-project”找到。但是，事实并非如此-所以看来我需要修改 build.xml/ant.properties/build.properties 或其他东西才能让 ant 找到 jar

具体错误是：

```
[javac] Compiling 5 source files to /Users/.../KeyEvents/bin/classes
[javac] /Users/.../KeyEvents/src/com/proj/automation/core/coreSSH.java:9: error: package com.jcraft.jsch does not exist 
```

build.xml 是由 android 脚本创建的，Ant 是开箱即用的——所以我认为我对 ant 的清理知识是问题所在：P。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-02-21T09:22:32.540

嗨，我遇到了同样的问题。我按照以下步骤修复它：

*   1 在项目目录中创建“libs”目录，将所有外部 jar 文件放在 libs 目录中。
*   2 在项目目录中添加一个 custom_rules.xml 文件，内容如下。

[https://github.com/xiaocong/android-uiautomator-jsonrpcserver/blob/master/custom_rules.xml](https://github.com/xiaocong/android-uiautomator-jsonrpcserver/blob/master/custom_rules.xml)

```
<!-- Include external libs -->
<property name="jar.libs.dir" value="libs" />
<property name="jar.libs.absolute.dir" location="${jar.libs.dir}" />
<path id="classpath">
    <fileset dir="${jar.libs.absolute.dir}">
        <include name="**/*.jar"/>
    </fileset>
</path>

<property name="dex.file.name" value="classes.dex" />
<property name="out.dir" value="bin" />
<property name="out.absolute.dir" location="${out.dir}" />
<property name="out.absolute.bundle.dir" location="${out.absolute.dir}/bundle" />
<property name="intermediate.dex.bundle.file" location="${out.absolute.bundle.dir}/${dex.file.name}" />

<property name="out.bundle.file" value="${out.absolute.dir}/bundle.jar" />

<target name="-pre-compile">
    <mkdir dir="${out.absolute.bundle.dir}" />
</target>

<!-- overwrite the compile target in uibuild.xml to include to external jars -->
<target name="compile" depends="-build-setup, -pre-compile">
    <javac encoding="${java.encoding}"
            source="${java.source}" target="${java.target}"
            debug="true" extdirs="" includeantruntime="false"
            destdir="${out.classes.absolute.dir}"
            bootclasspathref="project.target.class.path"
            verbose="${verbose}"
            fork="${need.javac.fork}">
        <src path="${source.absolute.dir}" />
        <classpath refid="classpath"/>
        <compilerarg line="${java.compilerargs}" />
    </javac>
</target>

<!-- empty default post-dex target. Create a similar target in
     your build.xml and it'll be called instead of this one. -->
<target name="-post-dex">
    <dex executable="${dx}"
            output="${intermediate.dex.bundle.file}"
            nolocals="@{nolocals}"
            verbose="${verbose}">
        <fileset dir="${jar.libs.absolute.dir}">
             <include name="**/*.jar"/>
        </fileset>
    </dex>
</target>

<!-- empty default post-jar target. Create a similar target in
     your build.xml and it'll be called instead of this one. -->
<target name="-post-jar">
    <jar destfile="${out.bundle.file}">
        <fileset file="${intermediate.dex.bundle.file}" />
    </jar>
</target>

<target name="install" description="Install the test package">
     <exec executable="${adb}" failonerror="true">
        <arg line="${adb.device.arg}" />
        <arg value="push" />
        <arg value="${out.file}" />
        <arg value="/data/local/tmp" />
    </exec>
     <exec executable="${adb}" failonerror="true">
        <arg line="${adb.device.arg}" />
        <arg value="push" />
        <arg value="${out.bundle.file}" />
        <arg value="/data/local/tmp" />
    </exec>
</target> 
```

*   3 选择“build.xml”作为“Ant Build”运行每个都可以。

*   4 会生成两个jar文件，额外的jar文件命名为“bundle.jar”

*   5 将 bundle.jar 推送到 /data/local/tmp/

*   6 adb shell uiautomator xxxTestCast.jar bunder.jar -c com.xxx.MainClass

有用！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-21T16:59:45.557

看看这里 [1]。只需复制此文件并将所需的 jar 放入目录 libs 中，然后运行 ​​ant build、ant install 和最后：：

adb shell uiautomator runtest YourTest.jar bundle.jar -c your.test

[1] - [https://github.com/xiaocong/android-uiautomator-jsonrpcserver/blob/master/custom_rules.xml](https://github.com/xiaocong/android-uiautomator-jsonrpcserver/blob/master/custom_rules.xml)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-06T08:39:28.033

在项目中创建 lib 目录，将所有需要的 jar 保存在那里，然后创建新的 custom_rule.xml 并复制下面编写的代码，然后它将工作文件或者您也可以将此代码粘贴到 build.xml 的最后。

```
<property name="jar.libs.dir" value="libs" />
<property name="jar.libs.absolute.dir" location="${jar.libs.dir}" />
<path id="classpath">
    <fileset dir="${jar.libs.absolute.dir}">
        <include name="your-helping-version.jar" />
        <include name="gson-2.2.2.jar" />
    </fileset>
</path>

<!-- version-tag: VERSION_TAG -->
<import file="${sdk.dir}/tools/ant/uibuild.xml" />

<!-- overwrite the compile target in uibuild.xml to include to external 
    jars -->
<target name="compile" depends="-build-setup, -pre-compile">
    <javac encoding="${java.encoding}" source="${java.source}"
        target="${java.target}" debug="true" extdirs="" includeantruntime="false"
        destdir="${out.classes.absolute.dir}" bootclasspathref="project.target.class.path"
        verbose="${verbose}" fork="${need.javac.fork}">
        <src path="${source.absolute.dir}" />
        <classpath refid="classpath" />
        <compilerarg line="${java.compilerargs}" />
    </javac>
</target>

<!-- overwrite the -dex target in uibuild.xml to include external jar files 
    into the target dex file. -->
<target name="-dex" depends="compile, -post-compile">
    <dex executable="${dx}" output="${intermediate.dex.file}"
        nolocals="@{nolocals}" verbose="${verbose}">
        <fileset dir="${jar.libs.absolute.dir}">
            <include name="your-helping-version.jar" />
            <include name="gson-2.2.2.jar" /> 
        </fileset>
        <path path="${out.classes.absolute.dir}" />
    </dex>
</target> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-14T04:39:03.563

如果您使用的是日食

在 Project Explorer 中，右键单击您创建的新项目，然后选择 Properties > Java Build Path，然后执行以下操作：单击 Add External JARs... 并导航到目录并添加 jar 文件

# python - 为什么第二次函数调用的次数不同？

> ID：16026356
> 
> 赞同：3
> 
> 时间：2013-04-15T23:33:52.743
> 
> 标签：python, profile

我正在编写一个界面来帮助我分析 python 脚本。[我从profile.py 源代码](http://hg.python.org/cpython/file/3.2/Lib/profile.py)中借用代码来执行 python 脚本。我意识到，当我连续两次分析相同的代码时，它第二次返回给我不同数量的函数调用。例如，在 上执行以下代码`myscript.py`：

```
from cProfile import Profile
import sys
import os.path

for i in range(3):
    prof = Profile()

    progname = 'myscript.py'
    sys.path.insert(0, os.path.dirname(progname))
    with open(progname, 'rb') as fp:
        code = compile(fp.read(), progname, 'exec')
    globs = {
            '__file__': progname,
            '__name__': '__main__',
            '__package__': None,
            '__cached__': None,
            }
    prof.runctx(code, globs, None)
    prof.create_stats()
    print(len(prof.stats)) 
```

给我

```
511
30
30 
```

作为输出。为什么第二次调用函数的数量变少了？哪个数字是*正确*的数字？我该怎么做才能得到相同的结果？

* * *

`myscript.py`好像：

```
import numpy
import numpy.linalg

if __name__ == '__main__':

    r = numpy.random.rand(1000, 1000)
    numpy.linalg.inv(r) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:49:40.727

函数调用计数不同的原因似乎是因为`myscript.py`我第二次运行代码时导入的模块没有再次导入。

获得一致结果的第一种方法是`myscript.py`在执行分析之前导入。但是，这意味着如果我导入的模块在导入时执行某些任务，则不会对其进行分析。

```
prof = Profile()

progname = 'myscript.py'
sys.path.insert(0, os.path.dirname(progname))
modname, _ = os.path.splitext(os.path.basename(progname))
__import__(modname, globals(), locals(), [], 0)
with open(progname, 'rb') as fp:
    code = compile(fp.read(), progname, 'exec')
globs = {
        '__file__': progname,
        '__name__': '__main__',
        '__package__': None,
        '__cached__': None,
        }
prof.runctx(code, globs, None)
prof.create_stats()
print(len(prof.stats)) 
```

我发现的第二种方法是删除执行脚本时注册的所有模块。好处是，如果我在 GUI 运行时修改源代码，它将重新加载所做的更改。我现在的缺点是一些 atexit 注册的处理程序现在崩溃，因为之前删除了所需的模块：

```
prof = Profile()

progname = 'myscript.py'
sys.path.insert(0, os.path.dirname(progname))
with open(progname, 'rb') as fp:
    code = compile(fp.read(), progname, 'exec')
globs = {
        '__file__': progname,
        '__name__': '__main__',
        '__package__': None,
        '__cached__': None,
        }
modules = sys.modules.copy()
prof.runctx(code, globs, None)
newmodes = [modname for modname in sys.modules if modname not in modules]
for modname in newmodes:
    del sys.modules[modname]
prof.create_stats()
print(len(prof.stats)) 
```

最后，我发现最好的方法是在单独的进程中执行分析：

```
import concurrent.futures
import marshal
from cProfile import Profile
from pstats import Stats
import sys

progname = 'myscript.py'
with concurrent.futures.ProcessPoolExecutor() as executor:
    future = executor.submit(_run, progname)
    stats = Stats()
    stats.stats = marshal.loads(future.result())
    stats.get_top_level_stats()

def _run(progname):
    sys.path.insert(0, os.path.dirname(progname))

    with open(progname, 'rb') as fp:
        code = compile(fp.read(), progname, 'exec')
    globs = {
        '__file__': progname,
        '__name__': '__main__',
        '__package__': None,
    }
    prof = Profile()
    prof.runctx(code, globs, None)
    prof.create_stats()
    return marshal.dumps(prof.stats) 
```

# parsing - 如何使 lex/flex 识别不被空格分隔的标记？

> ID：16026358
> 
> 赞同：5
> 
> 时间：2013-04-15T23:33:59.983
> 
> 标签：parsing, compiler-construction, lex, lexer

我正在学习编译器构造课程，我目前的任务是为我们正在实现的语言编写词法分析器。我不知道如何满足词法分析器必须识别连接标记的要求。也就是说，没有用空格分隔的标记。例如：字符串`39if`应该被识别为数字`39`和关键字`if`。同时，词法分析器`exit(1)`在遇到无效输入时也必须这样做。

我拥有的代码的简化版本：

```
%{
#include <stdio.h>
%}

%option main warn debug

%%

if      |
then    |
else    printf("keyword: %s\n", yytext);

[[:digit:]]+    printf("number: %s\n", yytext);

[[:alpha:]][[:alnum:]]*     printf("identifier: %s\n", yytext);

[[:space:]]+    // skip whitespace
[[:^space:]]+   { printf("ERROR: %s\n", yytext); exit(1); }

%% 
```

当我运行它（或我的完整版本）并将其传递给 input`39if`时，错误规则匹配并且输出为`ERROR: 39if`，当我希望它是：

```
number: 39
keyword: if 
```

（即，就像我`39 if`作为输入输入一样。）

[根据手册](http://westes.github.io/flex/manual/Matching.html)，我有一种预感，原因是错误规则匹配的可能输入比数字和关键字规则更长，而 flex 会更喜欢它。也就是说，我不知道如何解决这种情况。编写一个将拒绝所有非错误输入的显式正则表达式似乎是不可行的，而且我不知道如何编写“catch-all”规则来处理词法分析器错误。

**更新：**我想我可以制定包罗万象的规则，`. { exit(1); }`但我想获得一些比“我在第 1 行感到困惑”更好的调试输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T03:22:06.683

你是对的，你应该只匹配一个“任何”字符作为后备。获取有关解析所在行的信息的“标准”方法是使用该`--bison-bridge`选项，但这可能有点痛苦，特别是如果您不使用`bison`. 还有很多其他方法——例如，在手册中查看指定你自己的 i/o 函数的方法——但最简单的恕我直言是使用开始条件：

```
%x LEXING_ERROR
%%
// all your rules; the following *must* be at the end
.                 { BEGIN(LEXING_ERROR); yyless(1); }
<LEXING_ERROR>.+  { fprintf(stderr,
                            "Invalid character '%c' found at line %d,"
                            " just before '%s'\n",
                            *yytext, yylineno, yytext+1);
                    exit(1);
                  } 
```

注意：确保您在规则中忽略了空格。该模式`.+`匹配任何数字，但至少匹配一个非换行符，或者换句话说，直到当前行的末尾（它将强制 flex 读取那么远，这应该不是问题）。`yyless(n)`按字符备份读取指针`n`，因此在`.`规则匹配后，它将重新扫描该字符，从而产生（希望）半合理的错误消息。（如果您的输入是多字节的，或者有奇怪的控制字符，这将是不合理的，因此您可以编写更仔细的代码。取决于您。如果错误位于行尾，也可能不合理，所以您可能还想编写一个更仔细的正则表达式来获取更多上下文，甚至可能限制读取的转发字符的数量。这里有很多选项。）

在 flex 手册中查找[开始条件](http://westes.github.io/flex/manual/Start-Conditions.html)以获取有关`%x`和`BEGIN`

# php - CakePHP 查找条件破坏提交

> ID：16026363
> 
> 赞同：0
> 
> 时间：2013-04-15T23:35:18.327
> 
> 标签：php, cakephp

使用 find 的条件参数时，用户 id 不会与其他字段一起提交。

```
public function add() {
        if ($this->request->is('post')) {
            $this->Thing->create();
            if ($this->Thing->save($this->request->data)) {
                $this->Session->setFlash(__('The Thing has been saved'));
                $this->redirect(array('action' => 'index'));
            } else {
                $this->Session->setFlash(__('The Thing could not be saved. Please, try again.'));
            }
        }

$users = $this->Thing->User->find('list', array(
            'fields' => array('User.username'),
            'conditions' => array('User.ownedby' => '3')
            ));
    $this->set(compact('users'));} 
```

这是我的看法：

```
<div class="things form">
<?php echo $this->Form->create('Thing'); ?>
    <fieldset>
        <legend><?php echo __('Add Thing'); ?></legend>
    <?php
        echo $this->Form->input('user_id');
    ?>

    <div id="user-info">
    </div>

    </fieldset>

    <?php echo $this->Form->end(__('Submit'
    )); ?>

</div> 
```

但是，当我省略条件参数时，它提交就好了。有任何想法吗？如果您想知道，我正在使用条件参数对用户列表进行排序，从而产生由此创建的选择下拉列表。

谢谢。

# ruby-on-rails - 使用 factory_girl 进行 rspec 私有方法测试

> ID：16026367
> 
> 赞同：0
> 
> 时间：2013-04-15T23:35:27.140
> 
> 标签：ruby-on-rails, rspec, factory-bot

**提现.rb**

```
class Cashout < ActiveRecord::Base
  belongs_to :partner
private
  def partner_exist?
    if self.partner.nil?
      errors.add(:base, "There is no partner! ")
      return false;
    end
    return true
  end
end 
```

**Cashout_spec.rb**

```
context 'should check partner existence' do 
    it 'if partner is not nil' do 
      @company = Factory(:company) 
      @partner = Factory(:partner, :company => @company)
      @cashout = Factory.build(:cashout, :partner => @partner)
      @cashout.save
      @cashout.partner_exist?.should eql(true)
    end
end 
```

这些是我的模型文件和测试文件。测试结果是

```
1) Cashout should check partner existence if partner is nil
     Failure/Error: @cashout3.partner_exist?.should eql(false)
     NoMethodError:
       private method `partner_exist?' called for #<Cashout:0x007f822189dfa0>
     # ./spec/models/cashout_spec.rb:47:in `block (3 levels) in <top (required)>' 
```

你知道我如何测试私有方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T00:02:45.443

您可以通过以下方式调用私有方法`send`：

```
@cashout3.send(:partner_exist?).should eql(false) 
```

# javascript - iframe 中的 Intro.js

> ID：16026370
> 
> 赞同：3
> 
> 时间：2013-04-15T23:35:45.670
> 
> 标签：javascript, html, intro.js

我希望它在 iframe 中工作，但如果我定义 js. 在父文档中，它无法识别应该在 iframe 中“引入”的元素。如果我在 iframe 中使用它，效果不是我所期望的（覆盖仅覆盖 iframe）。

[Intro.js 在 iframe.png 中使用] [https://dl.dropboxusercontent.com/u/6421243/Intro.js%20being%20used%20inside%20an%20iframe.png](https://dl.dropboxusercontent.com/u/6421243/Intro.js%20being%20used%20inside%20an%20iframe.png)

我可以用插件代码做些什么，以便它搜索 iframe 内的元素但仍显示父级上的覆盖？

更新：我想在整个页面上覆盖黑色（因此 iframe 的边框也会被它覆盖）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-08-11T12:43:40.610

在 iFrame 和父级中运行 intro.js。

在父级中，删除工具提示并突出显示 iframe

在 iframe 中，运行您需要的任何工具提示

两者之间的通信，看看这个： [如何在 iframe 和父站点之间进行通信？](https://stackoverflow.com/questions/9153445/how-to-communicate-between-iframe-and-the-parent-site)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T06:02:44.310

首先，您应该知道，如果您在 iframe 之外定义 JavaScript 代码，则它在内部 iframe 中不再可用，因为您无权访问它们。

因此，您应该只将代码放在 iframe 中。

更新：所以我认为你错误地放置了容器元素，所以 IntroJs 也错误地定义了覆盖。更新和更改您的元素容器，然后您将不会有任何问题。

# css - Sass祖先类

> ID：16026371
> 
> 赞同：0
> 
> 时间：2013-04-15T23:35:51.887
> 
> 标签：css, sass

我有一堂课 .red

我想对红色类的标签应用更多规则。

我知道我可以这样做：

```
label {
   ...stuff...
   &.red {
     color: red;
   }
} 
```

但对于组织我宁愿是这样的：

```
.red {
   color: red;
   label & {
    font-weight: normal;
   }
 } 
```

但这当然没有给`label .red`我`label.red`

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:40:52.587

没有。不允许。您必须像第一个示例一样编写它，或者根本不嵌套它。

# c - 打印字符串数组

> ID：16026372
> 
> 赞同：0
> 
> 时间：2013-04-15T23:35:54.387
> 
> 标签：c, arrays, parsing

我正在解析一个文本文件：

```
Hello, this is a text file. 
```

并通过将文件转换为 char[] 来创建。现在我想获取数组，遍历它，并创建一个数组数组，将文件拆分为单词：

```
 string[0] = Hello
 string[1] = this
 string[2] = is 
```

这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include "TextReader.h"
#include <ctype.h>

void printWord(char *string) {
int i;
for (i = 0; i < strlen(string); i ++)
    printf("%c", string[i]);
printf("\n");
}

void getWord(char *string) {
char sentences[5][4];
int i;
int letter_counter = 0;
int word_counter = 0;

    for (i = 0; i < strlen(string); i ++) {
            // Checks if the character is a letter
    if (isalpha(string[i])) {
        sentences[word_counter][letter_counter] = string[i];
        letter_counter++;
    } else {
        sentences[word_counter][letter_counter + 1] = '\0';
        word_counter++;
        letter_counter = 0;
    }
}

// This is the code to see what it returns:
i = 0;
for (i; i < 5; i ++) {
    int a = 0;
    for (a; a < 4; a++) {
        printf("%c", sentences[i][a]);
    }
    printf("\n");
}
}

int main() {
    // This just returns the character array. No errors or problems here.
char *string = readFile("test.txt");

getWord(string);

return 0;
} 
```

这是它返回的内容：

```
Hell
o
this
is
a) w 
```

我怀疑这与指针和东西有关。我来自强大的 Java 背景，所以我仍然习惯于 C。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T23:43:38.987

随着`sentences[5][4]`您将数量限制`sentences`为 5，每个单词的长度限制为 4。您需要将其变大以处理更多和更长的单词。试试`sentences[10][10]`。您也没有检查您输入的单词是否不超过`sentences`可以处理的长度。使用更大的输入，这可能导致堆溢出和访问冲突，请记住 C 不会为您检查指针！

当然，如果你打算用这个方法来处理更大的文件和更大的单词，你需要把它变大[或者动态分配它](http://www.cplusplus.com/reference/cstdlib/malloc/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T09:28:29.880

不使用 strtok 的示例：

```
void getWord(char *string){
    char buff[32];
    int letter_counter = 0;
    int word_counter = 0;
    int i=0;
    char ch;

    while(!isalpha(string[i]))++i;//skip
    while(ch=string[i]){
        if(isalpha(ch)){
            buff[letter_counter++] = ch;
            ++i;
        } else {
            buff[letter_counter] = '\0';
            printf("string[%d] = %s\n", word_counter++, buff);//copy to dynamic allocate array
            letter_counter = 0;
            while(string[++i] && !isalpha(string[i]));//skip
        }
    }
} 
```

使用 strtok 版本：

```
void getWord(const char *string){
    char buff[1024];//Unnecessary if possible change
    char *p;
    int word_counter = 0;

    strcpy(buff, string);
    for(p=buff;NULL!=(p=strtok(p, " ,."));p=NULL){//delimiter != (not isaplha(ch))
        printf("string[%d] = %s\n", word_counter++, p);//copy to dynamic allocate array
    }
} 
```

# java - jflashplayer 中的 java.lang.UnsatisfiedLinkError -- getOSVersion

> ID：16026375
> 
> 赞同：1
> 
> 时间：2013-04-15T23:35:59.647
> 
> 标签：java, flash

我正在尝试编译和运行[JFlashPlayer 2.1.1](http://java-flash-player-jflashplayer.soft32.com/)试用版附带的示例代码。（抱歉下载链接，看来[VersaEdge](http://www.versaedge.com/)已经[停止了 JFlashPlayer](http://www.jpackages.com/)）

我能够在 2009 年获得运行演示，但`java.lang.UnsatisfiedLinkError`由于`com.jpackages.jflashplayer.FlashPanel.getOSVersion`. 我正在运行 Windows 7 64 位，并且我*不*使用 Internet Explorer。我猜 VersaEdge 没有更新 JFlashPlayer 以支持 Windows 7，或者 IE 中的某些组件丢失了。

此外，我是一位经验丰富的 C# 开发人员，但在编译 Java 时，我是一个彻头彻尾的喋喋不休的白痴。也许我错过了类路径或其他明显的命令行开关。

我已经使用它们的批处理文件编译了这些类`buildClasses.bat`，即：

```
javac -d classes -classpath ..\jflashplayer.jar Example.java 
```

然后我使用

```
java -cp classes;..\jflashplayer.jar Example 
```

. 异常的全文：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: com.jpackages.jflashplayer.FlashPanel.getOSVersion(I)I
    at com.jpackages.jflashplayer.FlashPanel.getOSVersion(Native Method)
    at com.jpackages.jflashplayer.FlashPanel.n(Unknown Source)
    at com.jpackages.jflashplayer.FlashPanel.installFlash(Unknown Source)
    at Example.createFlashPanel(Example.java:94)
    at Example.<init>(Example.java:141)
    at Example.main(Example.java:425) 
```

任何帮助表示赞赏！感谢 Java 大师！

**编辑**

`runExample.bat`试用文件夹的根目录中有几个 DLL 和一个。批处理文件运行

```
java -classpath jflashplayer.jar;example/classes Example 
```

并给我同样的`UnsatisfiedLinkError`。我尝试[在路径中包含当前目录](https://stackoverflow.com/questions/2535700/loading-dll-in-java-eclipse-jni)以协助 JNI 搜索，但这并没有改变任何东西。我不确定它在寻找什么 DLL。

**编辑 2**

从 2006 年找到一篇[很棒的（但很古老的）文章](http://www.adobepress.com/articles/article.asp?p=444218&seqNum=2)，描述了让示例运行的所有复杂性。没运气。上一次 JFlashPlayer 发布是在 2009 年的某个时候`readme.txt`，而[Windows7 是在 2009 年 10 月 22 日发布](http://en.wikipedia.org/wiki/Windows_7)的。所以我相当肯定这是一个不受平台支持的问题。

那么，接下来的问题是，如何在 Java 中托管 SWF？但我会将其留作后续问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T03:01:45.247

在寻找替代解决方案数小时后，我遇到了[QT-Jambi](http://qt-jambi.org/)，它有一个[应该支持 Flash](http://lists.qt.nokia.com/public/qt-jambi-interest/2010-November/002542.html)的 WebKit 组件。它也是积极开发和真正跨平台的，而 JFlashPlayer 既死了又绑定到 Windows/IE/ActiveX 插件。

奇怪的是，在安装 QTJambi 之后，我遇到了与 JFlashPlayer 相同的问题，并发现我最初的错误是尝试在 64 位 JRE 中运行 32 位应用程序。所以，确保我安装了 32 位 JRE，我将它的位置添加到我的路径的前面

```
> set path=c:\Program Files (x86)\Java\jre7\bin;%path%

> where java
c:\Program Files (x86)\Java\jre7\bin\java.exe
C:\Windows\System32\java.exe
C:\Program Files\Java\jdk1.6.0_31\bin\java.exe 
```

并从命令行执行批处理文件，示例运行良好。

最终，像 QTJambi（或[QtWebKit](http://trac.webkit.org/wiki/QtWebKit)）这样的 WebKit 解决方案对我来说更好，我感谢我缺乏对 java 的了解，因为我用这种迂回的方式来寻找更绿色的牧场。

其他不太方便的解决方案是[用于 SWT 的 WebKit](http://www.genuitec.com/about/labs-webkit-for-swt/WebKit%20For%20SWT%20Developer%20Guide.html)（仅限 Windows）和[JWebPane](http://weblogs.java.net/blog/alex2d/archive/2008/12/jwebpane_projec_1.html)（[vaporware](http://blog.macrominds.de/2011/04/jwebpane-reloaded-thoughts-on-a-swing-based-browser-component/)）。

# c# - 如何从 SharePoint 获取数字列表的总和？

> ID：16026384
> 
> 赞同：0
> 
> 时间：2013-04-15T23:36:35.510
> 
> 标签：c#, sharepoint

**我正在从SharePoint**检索数值。我想要做的是从列表中添加值。但是，当我从 SharePoint 调用该列时，我不确定如何获取它。

到目前为止，我有这个：

```
//Column List from SharePoint which has a numeric value

if (item["ows_Amount_x0020__x0028_LC_x0029_"] != null)
{
  str.AppendLine("<td bgcolor='#FFFFFF';align='right';> " + Convert.ToDecimal(item["ows_Amount_x0020__x0028_LC_x0029_"]).ToString("N0") + "</td>");
}

//Location where I want to put in the Sum
str.AppendLine(" <tr style='color:#ffffff; font-weight:bold'><td bgcolor='#0096D6'>Forecast USD</td></tr>"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:52:30.187

假设您正在遍历列表中的每个项目，它将看起来像这样，因为不支持像 SUM 和 SPQuery 这样的聚合函数。

```
double total = 0;
foreach(item in list){
  if(item["field"] == null)
     continue;

  total += item["field"];
  str.AppendLine("<td bgcolor='#FFFFFF';align='right';> " + Convert.ToDecimal(item["field"]).ToString("N0") + "</td>");
}
str.AppendLine(" <tr style='color:#ffffff; font-weight:bold'><td bgcolor='#0096D6'>Forecast USD:" + total.toString() + "</td></tr>"); 
```

# forms - Spring MVC - 提交时没有发生任何事情

> ID：16026385
> 
> 赞同：1
> 
> 时间：2013-04-15T23:36:38.607
> 
> 标签：forms, spring-mvc, controller

我的 Spring 3.2 MVC 应用程序中有以下表单。控制器方法没有被调用。这是我的表格。

```
<form:form commandName="bulletin" method="post" value="/processBulletin">
    <table>
        <tr>
            <td>Name:</td>
            <td><form:input path="name" maxlength="30" /></td>
        </tr>
        <tr>
            <td>Subject:</td>
            <td><form:input path="subject" maxlength="50" /></td>
        </tr>
        <tr>
            <td valign="top">Message:</td>
            <td><form:textarea path="note" cols="70" rows="20" /></td>
        </tr>
        <tr>
            <td><input type="button" value="Submit bulletin" name="submit" /></td>
            <td>&nbsp;</td>
        </tr>
    </table>
</form:form> 
```

这是我的控制器方法。

```
@RequestMapping(value = "/processBulletin", method = RequestMethod.POST)
@ModelAttribute("bulletin") Bulletin bulletin, Model model,
        BindingResult result) {
    final BindException errors = new BindException(bulletin, "bulletin");

    bulletinValidator.validate(bulletin, errors);
    if (errors.hasErrors()) {
        return "redirect:/approvedBulletins";
    } else {
        try {
            bulletin.setSubject(bulletin.getSubject().trim());
            bulletin.setName(bulletin.getName().trim());
            bulletin.setNote(bulletin.getNote().trim());
            long now = System.currentTimeMillis();
            Calendar date = Calendar.getInstance();
            date.setTimeInMillis(now);
            bulletin.setDay((date.get(Calendar.MONTH) + 1) + "/"
                    + date.get(Calendar.DATE) + "/"
                    + date.get(Calendar.YEAR));

            bulletinDAO.writeBulletin(bulletin.getName(),
                    bulletin.getSubject(), bulletin.getDay(),
                    bulletin.getNote());
        } catch (Exception e) {
            System.out.println(e.getMessage());
            return "FailurePage";
        }
    }

    return "redirect:/approvedBulletins";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:14:18.697

更改按钮以提交。：

```
input type = "submit" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T14:04:44.450

您正在使用`<input type="button" value="Submit bulletin" name="submit" />`此标签将不会提交表单 - 默认情况下它不会执行任何操作。它的主要用途是与 JavaScript 结合作为 AJAX 应用程序或非 ajax 处理 (UI/UX) 的一部分。

`<input type="submit" value="Submit bulletin" name="submit" />`标签将在用户单击它们时提交表单，除非您使用 JavaScript 另有指定。

# php - 合并 facebook、twitter 和foursquare 好友PHP，有什么建议吗？

> ID：16026396
> 
> 赞同：1
> 
> 时间：2013-04-15T23:37:37.990
> 
> 标签：php, facebook-graph-api, twitter, twitter-oauth, facebook-oauth

大约三个月以来，我一直在使用 PHP 及其各自的 SDK 从 facebook、twitter 和foursquare 获取用户的朋友。我成功地获取了朋友列表，并将每个列表存储在一个关联数组中。我正在寻找将这些朋友组合在一起并获得相似度分数的想法？

问题是我只有朋友的名字，没有其他信息。Facebook 和 twitter 不会提供任何其他详细信息，即使是它们各自的电子邮件 ID。我想知道是否有人对如何设计分数函数有一些了解？
谢谢你的帮助 ！

# c# - File.WriteAllText 问题

> ID：16026397
> 
> 赞同：1
> 
> 时间：2013-04-15T23:37:52.063
> 
> 标签：c#, file, save, writealltext

我正在尝试将许多不同的表单保存到文本文件中，目前我有：

*   温度
*   风
*   雨
*   云

我遇到的问题是它只保存“云”数据。有没有一种方法可以保存提交时的所有信息，并用逗号、破折号或空格分隔？

这是我目前正在使用的代码：

```
 private void button2_Click(object sender, RoutedEventArgs e)
    {

        File.WriteAllText("C:\\WeatherSpotter.txt", tempC.Text);
        File.WriteAllText("C:\\WeatherSpotter.txt", tempF.Text);
        File.WriteAllText("C:\\WeatherSpotter.txt", windMPH.Text);
        File.WriteAllText("C:\\WeatherSpotter.txt", windKM_Textbox.Text);
        File.WriteAllText("C:\\WeatherSpotter.txt", Cloud_ComboBox.Text);

    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T23:39:12.800

`File.WriteAllText`替换文件的内容。

你想要`File.AppendText()`的，这[正是它在锡上所说的](http://tvtropes.org/pmwiki/pmwiki.php/Main/ExactlyWhatItSaysOnTheTin)。
请注意，您可能希望也可能不希望第一次调用仍然是`WriteAllText()`.

或者，更好的是，将所有这些连接成一个字符串并且`WriteAllText()`只调用一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:43:14.393

每次调用`File.WriteAllText`时都会覆盖现有文件。相反，您应该使用附加功能，例如`File.AppendText()`或打开文件，写入每一行，然后关闭它。您还可以使用`StringBuilder`或其他东西来构建整个文件内容。

有很多选项，请务必检查您选择的方法如何处理文件（它使用什么模式/权限）。

# c++ - 将数组拆分为两个单独的数组

> ID：16026401
> 
> 赞同：-1
> 
> 时间：2013-04-15T23:38:23.567
> 
> 标签：c++, arrays

我读过一个文件，其中男孩和女孩用 1 和 0 分隔。我希望男孩在一个阵列中，而女孩在另一个阵列中。当我尝试这样做时，我得到了原始数组的 2 个副本，男孩从索引 0 开始直到某个数字，女孩从男孩离开的索引开始，直到数组结束。如何正确拆分两者？

代码：

```
double boys[100];
double girls[100];
boys[0] = 0;
girls[0] = 0;

for (int x = 0; x < fun; x++){
if (gender[x] == 1)
    boys[x] = array[x];
else
    girls[x] = array[x];
} 
```

我想要两个新的数组男孩和女孩，它们从一个来自我“有趣”的函数的数组中分离出来。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:42:05.870

“当我尝试这样做时，我最终得到了原始数组的 2 个副本，男孩从索引 0 开始直到某个数字**，女孩从男孩离开的索引开始，直到数组结束。**如何我可以把两者分开吗？”

粗体部分告诉我，您需要做的就是在填充完男孩数组并开始填充女孩数组后将索引重置为 0。

编辑：您发布的代码表明您的问题不是您所说的那样（至少在可能混合男孩和女孩的一般情况下不是）。你想要这样的东西

```
int boysidx = 0;
int girlsidx = 0;
for (int x = 0; x < fun; x++){
    if (gender[x] == 1)
        boys[boysidx++] = array[x];
    else
        girls[girlsidx++] = array[x];
} 
```

# modx - 如何在 ModX 中重新排序网络链接

> ID：16026402
> 
> 赞同：0
> 
> 时间：2013-04-15T23:38:28.077
> 
> 标签：modx, modx-resources

目前在我们的网站上，我们有 4 个网络链接资源以正确的顺序（按标题上的日期）显示在页面上，但是在添加了一个网络链接资源后，它被添加到页面中，但出现在第一个链接下方，当它应该在顶部。

我不确定在哪里手动重新排序这些，并且似乎没有任何选项可以从 ModX 界面或资源编辑菜单中执行此操作（设置“索引”没有任何作用）。

有没有办法做到这一点？这是否可能是自定义的，我需要找到订购的地点？我查看了此页面的 Snippets 文件夹，但找不到任何看起来像是在订购的东西。

可能相关的菜鸟问题：如果我们只想通过 html 手动重新排序链接，我们如何通过 ModX 直接修改源代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:05:25.823

如果您使用自定义片段来提取链接，那么 modx 根本不会为您进行任何排序，这需要写入片段本身。

如果您使用 getResources，[ [http://rtfm.modx.com/display/ADDON/getResources](http://rtfm.modx.com/display/ADDON/getResources) ] 在文档中查找 sortby 选项。我不是 100% 确定默认值是什么。

如果您使用 WayFinder [ [http://rtfm.modx.com/display/ADDON/Wayfinder](http://rtfm.modx.com/display/ADDON/Wayfinder) ]，默认排序顺序将是它们出现在资源树中的顺序，我相信是 menuindex。我相信 WayFinder 也有一个排序选项。[查看文档]

如果在资源树中移动内容时没有看到更改，请务必清除缓存，因为资源树中的更改不会自动刷新缓存。

要手动将链接添加到页面/资源中，您需要找到显示链接的块/片段/模板并相应地进行修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T09:45:35.040

要在“资源树”中手动重新排序资源，您只需要通过鼠标“拖放”来更改资源位置。

# json.net - Windows Store SDK中StreamingContext为空，如何使用json.net传递反序列化上下文？

> ID：16026405
> 
> 赞同：0
> 
> 时间：2013-04-15T23:38:40.827
> 
> 标签：json.net, windows-store-apps

在 Json.Net 中，我在 JsonSerializerSettings 上设置 Context（类型 StreamingContext）对象，以传递对象在 [OnDeserialized] 方法中反序列化期间使用的信息。我通过创建一个新的 StreamingContext 对象并设置附加对象参数来做到这一点。这一切都在非 Windows 商店构建中完美运行：

```
 public static T Deserialize<T>(string jsonString, DeserializationContext context = null)
    {
        JsonSerializerSettings settings = new JsonSerializerSettings()
        {
            // Win store builds fail on this line:
            Context = new StreamingContext(StreamingContextStates.Other, context),
            TypeNameHandling = TypeNameHandling.Auto
        };
        return JsonConvert.DeserializeObject<T>(jsonString, settings); 
```

在 Windows Store SDK 中，[StreamingContext](http://msdn.microsoft.com/en-us/library/windows/apps/system.runtime.serialization.streamingcontext.aspx)对象存在但为空（Context 和 State 都不存在，并且它没有非默认构造函数）。看起来这个对象现在完全没用了，因为它现在只是一个空结构！

有谁知道绕过这个新限制并像在非 Windows 商店构建中那样传递上下文的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:01:24.487

我最终修改了 json.net 源代码。我将 JsonSerializer 上的 Context 对象更改为 object 类型，而不是 StreamingContext 并将这些更改冒泡到源的其余部分。这让我避免了 .NET for Windows Store 中的空白 StreamingContext 结构。不相信这是最好的解决方案，但它现在肯定对我有用。

# javascript - 使用 JavaScript 强制 FireFox 使用 background-position-y

> ID：16026406
> 
> 赞同：-2
> 
> 时间：2013-04-15T23:38:44.980
> 
> 标签：javascript, css, firefox, background-position

有没有人知道一点 JavaScript 可以在 Firefox 中正确显示 background-position-y（和 background-position-x）？这将在 CSS 中节省很多东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:42:57.293

`background-position-x`并且`background-position-y`是特定于 Internet Explorer 的属性。虽然它们非常明显并且应该由所有浏览器实现，但 Firefox 往往以这种方式很愚蠢（例如不支持 MP3，尽管它是有史以来最常用的声音格式......）

所以回答你的问题，不，没有。你只需要使用`background-position`. 这肯定不是什么大问题，对吧？

# django - Django 南迁

> ID：16026411
> 
> 赞同：-1
> 
> 时间：2013-04-15T23:39:17.517
> 
> 标签：django, django-south

我在我的模型中添加了以下行

```
room = models.ForeignKey(Room) 
```

之后我尝试使用南迁移：

```
./manage.py migrate myapp 
```

但我收到以下错误：

```
Running migrations for myapp:
- Nothing to migrate.
- Loading initial data for myapp.
Installed 0 object(s) from 0 fixture(s) 
```

你能告诉我我能在这里做什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:51:10.067

阅读教程的相关部分：http: [//south.readthedocs.org/en/latest/tutorial/part1.html#chang-the-model](http://south.readthedocs.org/en/latest/tutorial/part1.html#changing-the-model)

（提示：教程说有 3 个步骤。你只做其中的 2 个）。

# django - 是否可以根据权限检查隐藏/制作只读表单字段

> ID：16026415
> 
> 赞同：2
> 
> 时间：2013-04-15T23:39:34.580
> 
> 标签：django, django-forms

基本思想是能够基于模型权限检查（使用基于类的通用视图）隐藏一些表单字段。很明显，我可以覆盖视图`get`并`post`检查表单权限并构造表单，但是没有更简洁的方法来实现这一点吗？

到目前为止，视图和形式都非常简单

```
class UserProfileUpdateView(UpdateView):
    model = UserProfile
    template_name = "profile/update.html"
    form_class = UserProfileForm

class UserProfileForm(forms.ModelForm):
def __init__(self, can_change_position=False, can_change_manager=False, *args, **kwargs):
    super(UserProfileForm, self).__init__(*args, **kwargs)
    self._process_permission('position', can_change_position)
    self._process_permission('manager', can_change_manager)

def _process_permission(self, field, permitted):
    if permitted:
        self.fields.append(field)

class Meta:
    model = UserProfile
    fields = ['field1', 'field2', 'field3', ...] 
```

我是否遗漏了一些明显的东西，或者只是按照错误的方式？

**更新**看起来我的意图并不明确。我发布的代码中有一个错误，所以到目前为止给出的答案是如何修复错误。我已经修复了它，但问题不在于如何在运行时在表单上添加/删除字段（很明显）。问题是，是否有任何方法可以使用基于类的通用视图基于`request`值（例如）添加/删除字段。`request.user`

因此，再一次，直接的方法是重载`get`并`post`在视图上执行检查并实例化表单。但它在某种程度上重复了现有的 django 行为（即管理​​视图传递`request`给`get_form`）。那么，没有更清洁的方法来实现它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:39:58.273

是的，您的`__init__`方法是在`__new__`方法之后调用的，该方法实际上使用了“Meta.exclude”属性。（当这种动态类魔术的声明性属性发生时）

看看[django 源代码](https://github.com/django/django/blob/master/django/forms/models.py)第 198 行。所以在运行时你已经拥有了所有的实例变量。

类似问题的解决方案，我在这里发布：

[上传前未设置格式的 CSV 上传](https://stackoverflow.com/questions/15978503/csv-upload-with-no-set-format-before-upload/15980465#15980465)

希望有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T07:35:44.723

命名的属性`base_fields`是在表单类本身上设置的，在您的情况下是`UserProfileForm`. 当您创建此表单的实例时，即在表单实例上设置`UserProfileForm()`一个名为的属性，该属性是表单类上可用`fields`的副本。`base_fields`

并且`base_fields`设置在元类中，通常您不想更改元类。此外，`Meta.exclude`并且`Meta.fields`在元类中使用`__new__`，因此以形式更改它们`__init__`不会有任何效果。

因此，您可以做的是`fields`从`__init__`.

代码：

```
class UserProfileForm(forms.ModelForm):
    def __init__(self, can_change_position=False, can_change_manager=False, *args, **kwargs):
        super(UserProfileForm, self).__init__(*args, **kwargs)
        self._process_permission('position', can_change_position)
        self._process_permission('manager', can_change_manager)         

    def _process_permission(self, field, permitted):
        if not permitted and field in self.fields:
            del self.fields[field] 
```

# batch-file - 如何在批处理文件中打开自定义文件

> ID：16026422
> 
> 赞同：1
> 
> 时间：2013-04-15T23:40:35.743
> 
> 标签：batch-file

我有一个批处理文件，我想打开我的自定义文件 (.CMF)。我将这些文件放在一个文件夹中，我想让它，如果有人键入数字 1，它将显示该 .cmf 文件中的文本。我记得它类似于 >C:\blahblah。任何帮助

我试过了：

```
echo >C:\CMFfiles\ThankYou 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:02:04.817

```
@ECHO OFF
SETLOCAL
:loop
SET "file="
SET /p file="Which file to show ? "
IF NOT DEFINED file ECHO Goodbye&GOTO :EOF
IF NOT EXIST "%file%.cmf" ECHO %file% seems to be missing&GOTO loop
CLS
ECHO TYPE "%file%.cmf"
TYPE "%file%.cmf"
ECHO ======== This is %file% ===========
GOTO loop 
```

这应该适合你。

从用户那里获取一个名字 - 如果没有输入任何内容，则终止。检查文件是否存在，如果不存在，说出来并再次询问，否则清除屏幕，键入文件，报告输入的名称并询问另一个文件。

# ios - 试图在图像按钮上显示文本

> ID：16026424
> 
> 赞同：1
> 
> 时间：2013-04-15T23:40:38.210
> 
> 标签：ios

我正在尝试在按钮上显示文本，但没有任何显示。

```
 LocationButton = [[UIButton alloc] init];

 UIImage * Location_buttonImages = [UIImage imageNamed:@"button~iphone.png"];

 [LocationButton setTitle:@"Loca" forState:UIControlStateNormal];
 [LocationButton setTitleColor:[UIColor whiteColor] forState:UIControlStateNormal];

 [LocationButton setImage:Location_buttonImages forState:UIControlStateNormal];
 [LocationButton setImage:[UIImage imageNamed:
 @"button_select~iphone.png"]  
 forState:UIControlStateSelected];

  LocationButton.frame =  CGRectMake(20,212,90,40);

 [LocationButton addTarget:self action:
 @selector(action:) forControlEvents:UIControlEventTouchUpInside];

  [self.view addSubview:LocationButton]; 
```

我可以看到图像，但看不到文字。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:49:28.100

```
 [LocationButton setImage:Location_buttonImages forState:UIControlStateNormal];
 [LocationButton setImage:[UIImage imageNamed:@"button_select~iphone.png"]  forState:UIControlStateSelected]; 
```

您在标题上叠加图像，以便没有标题显示。更改为 setBackgroundImage:forState

```
 [LocationButton setBackgroundImage:Location_buttonImages forState:UIControlStateNormal];
 [LocationButton setBackgroundImage:[UIImage imageNamed:@"button_select~iphone.png" forState:UIControlStateSelected]; 
```

# javascript - 如何使用 jQuery 或 JavaScript 重复 div？

> ID：16026425
> 
> 赞同：2
> 
> 时间：2013-04-15T23:40:43.943
> 
> 标签：javascript, jquery, json, jquery-mobile

我有一个带有以下 div 标签的 HTML 页面

```
<div data-role="page" id="pageHome" data-theme="a">
  <div data-role="content">
    <center>
      <h3><a href="#pageHome" data-role="none"><img src="images/logo.png" /></a></h3>
    </center>
    <div class="dydivarr0"> </div>
    <br />
    <div data-role="controlgroup" class="ui-btn-right"> <a href="#page1" data-role="button">Next</a> </div>
  </div>
</div>

<div data-role="page" id="page1" data-theme="a">
  <div data-role="content">
    <center>
      <h3><a href="#pageHome" data-role="none"><img src="images/logo.png" /></a></h3>
    </center>
    <div class="dydivarr1"> </div>
    <br />
    <div data-role="controlgroup" class="ui-btn-right"> <a href="#page2" data-role="button">Next</a> </div>
  </div>
</div>

<div data-role="page" id="page2" data-theme="a">
  <div data-role="content">
    <center>
      <h3><a href="#pageHome" data-role="none"><img src="images/logo.png" /></a></h3>
    </center>
    <div class="dydivarr2"> </div>
    <br />
    <div data-role="controlgroup" class="ui-btn-right"> <a href="#page3" data-role="button">Next</a> </div>
  </div> 
```

dydivarr 是使用 JSON 从 Web 响应动态生成的。使用该响应创建动态 div 内容，接下来我想重复该 div，如上所示。有没有比重复静态 html 代码更好的方法？我想肯定有一些 jQuery 或 JavaScript 技巧。

任何帮助都会得到帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T23:43:49.103

所以你想要你的div的[cloneNode](https://developer.mozilla.org/en-US/docs/DOM/Node.cloneNode)，所以试试这样的

```
var div = document.getElementById('myDiv'),
clone = div.cloneNode(true);
clone.id = "some_id";
document.body.appendChild(clone); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T01:28:13.317

更新 ：

简单代码有效。这只是我的错误方法

```
<script type="text/javascript">

for(var lp=0; lp < 10; lp++)
{
document.write('<div data-role="page" id="page'+lp+'" data-theme="a">');
document.write('  <div data-role="content">');
document.write('    <center>');
document.write('      <h3><a href="#page0" data-role="none"><img src="images/logo.png" /></a></h3>');
document.write('     </center>');
document.write('     <div class="dydivarr+lp+'"> </div>');
document.write('     <br /> ');
document.write('     <div data-role="controlgroup" class="ui-btn-left"> <a href="#page'+(lp-1)+'"     data-role="button">Previous</a> </div>');
document.write('     <div data-role="controlgroup" class="ui-btn-right"> <a href="#page'+(lp+1)+'" data-role="button">Next</a> </div>');
document.write('   </div>');
document.write(' </div>');

}

</script> 
```

谢谢

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T23:52:38.247

像这样的东西？ [样品小提琴](http://jsfiddle.net/YmJ6F/)

```
var lastSection = $('[data-role="page"]:last'); //get the last page probably you can use this to increment the id based on last id
var newSection = lastSection.clone(false);//default is false anyways, if you want to carry over data and events you can use true.
newSection.attr('id','setthenewid');//set the new id
$('div[class^=dydivarr]',newSection).attr('class','newclass'); //set the new class for your divarr
$('.ui-btn-right a',newSection).attr('href','newurlmap');//set the new url map 
lastSection.after(newSection); //place the entire page section in the end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-29T08:09:26.837

[如何根据选择框值复制 div 一定次数？](https://stackoverflow.com/a/6309453/760661)

Roko C. Buljan

和

维文·帕利亚斯

的答案

# typescript - 访问同一模块但在不同文件中的类

> ID：16026426
> 
> 赞同：5
> 
> 时间：2013-04-15T23:40:50.073
> 
> 标签：typescript

假设我在以下两个文件中有以下代码：

**类A.ts**

```
module App {
    class ClassA{
    }
} 
```

**B类.ts**

```
module App {
    export class ClassB{
        constructor(public ClassA) {}
    }
} 
```

有没有办法让 ClassB 可以访问 ClassA***而无需***添加`export`ClassA？换句话说，我希望 ClassA 只能在`App`模块内访问，但我也希望将我的类保存在单独的文件中。

即使将编译输出到单个文件 ClassA 也无法在没有导出的情况下访问 ClassB。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T23:57:25.280

没有办法做到这一点。模块中的非导出变量在模块闭包中作为局部变量生成，因此它们在模块块本身之外根本不可见。

# android - 谷歌地图片段 - 当我启动我的应用程序时出现空白屏幕

> ID：16026427
> 
> 赞同：2
> 
> 时间：2013-04-15T23:40:51.057
> 
> 标签：android, google-maps, google-play, android-support-library

我已经配置和设置了谷歌地图（或者我认为），但是当我启动应用程序时，我的设备出现了一个空白屏幕。

我相信我拥有使用谷歌地图应用程序的所有正确设置和要求。如果我遗漏了什么，请告诉我。

```
Activity is here:

    package com.example.maptesting;

    import android.os.Bundle;
    import android.app.Activity;
    import android.app.Fragment;
    import android.support.v4.app.FragmentActivity;
    import android.view.Menu;

    public class MainActivity extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    }

XML layout here:

    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <fragment

        android:id="@+id/map"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

</RelativeLayout>

and Manifest here:

  <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.maptesting"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <permission
        android:name="com.example.maptesting.permission.MAPS_RECEIVE"
        android:protectionLevel="signature" >
    </permission>

    <uses-permission android:name="com.example.maptesting.permission.MAPS_RECEIVE" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES" />
    <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

    <uses-feature
        android:glEsVersion="0x00020000"
        android:required="true" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.maptesting.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <meta-data
            android:name="com.google.android.maps.v2.API_KEY"
            android:value="     
I know this isn't the key but rest assured I have it correctly configured" />
    </application>

</manifest> 
```

感谢大家的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:37:14.737

一周前我遇到了同样的问题。我改变了一点地图的加载方式（也出于其他原因），现在一切正常。

这里我的解决方案：

布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

    <FrameLayout
        android:id="@+id/map_container"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" >
    </FrameLayout>

</RelativeLayout> 
```

活动

```
package com.example.maptesting;

import android.os.Bundle;
import android.app.Activity;
import android.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.view.Menu;

public class MainActivity extends FragmentActivity {

private MapFragment mMapFragment;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    mMapFragment = MapFragment.newInstance();
     FragmentTransaction fragmentTransaction =
             getFragmentManager().beginTransaction();
     fragmentTransaction.add(R.id.map_container, mMapFragment);
     fragmentTransaction.commit();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

} 
```

稍后您可以使用检索地图对象

```
GoogleMap mMap = mMapFragment.getMap(); 
```

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T02:38:06.383

很长一段时间我都有同样的问题。原来我在 API 控制台中错误地选择了选项。请打开 Google **Android** Map API v2 而不是 Google Maps API v2！希望能解决问题~

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-26T08:49:44.767

Android Map Api 提供了两个授权密钥。一键调试应用，一键发布。每次应用程序即将签署生产时 - 必须将调试授权密钥替换为发布密钥。否则会出现黑屏。希望这可以帮助

# c++ - 如何创建指向向量的指针向量

> ID：16026428
> 
> 赞同：5
> 
> 时间：2013-04-15T23:40:52.213
> 
> 标签：c++, pointers, vector

我有一个指向向量的指针：

```
vector<double> mv;
mv.push_back(233);
mv.push_back(234);
mv.push_back(654);
vector<double>* new_mv_pt = new vector<double> (3);
new_mv_pt = &mv;    

cout << (*new_mv_pt)[1] << endl; 
```

我怎样才能制作另一个向量来存储这个指向向量的指针？我正在尝试这个...

```
 vector<double*> vop = new vector<double> (3);

vop.push_back(*new_mv_pt);

cout << (*vop)[1] << endl; 
```

但它没有用。我正在尝试的甚至可能吗？：

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T01:01:14.880

哇，慢点！

你正在用你的记忆做一些非常疯狂的事情，所以让我们从头开始吧。

您有一个包含 3 个元素的向量。您想使用指针引用该向量。让我们看看它的外观：

```
vector<double> mv;
mv.push_back(233);
mv.push_back(234);
mv.push_back(654);
// No no no no! You don't have to `new` a pointer that 
// you're going to assign to something else!
// This is called a memory leak, and it means you've just wasted (!!!)
// C++ memory! Don't do it 
// vector<double>* new_mv_pt = new vector<double> (3);
// Instead, do this:
vector<double>* ptr_to_mv = &mv; // No leak, immediately points to a vector<double> mv; 
```

这会照顾到第一位。现在，让我们更深入地了解它。您想要存储对向量的引用向量。好吧，这听起来很公平。有几种方法可以解决。让我们回到例子`mv`和其他事情：

```
vector<double> mv;
mv.push_back(233);
mv.push_back(234);
mv.push_back(654);
vector<double>* ptr_to_mv = &mv;
// So far so good. Now, based on your question, you want
// to have a list of these to point to. So:
vector<vector<double>*> vop;
vop.push_back( ptr_to_mv ); // All clean. 
```

此时，在您的代码中，您必须访问`vop`with`.at()`或才能访问`operator[]`a `vector<double>*`，然后使用取消引用它`*`或`->`直接使用它来处理它：

```
std::vector<double>* ptr_to_vector = vop[0]; // Got my pointer
std::cout << ptr_to_vector->at( 0 ) << std::endl; // Prints '233' 
```

这将打印 233 因为所有这些都是您引用的`mv`。在另一个答案的评论中，您说当您删除这些指针时，您会得到一个断言。*这应该会发生，因为您要删除两次！*

还记得`mv`，你很久以前就宣布过吗？好吧，你没有让它成为一个动态向量。你没有`new`，它不是指针。所以当函数退出时，它会自动删除自己——它会调用它的析构函数并***死在堆栈上***。如果您查看`ptr_to_vector`or `ptr_to_mv`，它们都在引用`mv`，它会自行清理。

***如果您对其调用 delete ，则您正在尝试调用 delete `mv`（这就是您所指向的）并且您正在双重删除！***

所以，当你有一个指向 的指针时`mv`，不要删除它。它是一个基于堆栈的变量。它会自己清理。

***还在追？太好了，让我们再深入一点：***

现在，如果出于某种*原因*需要添加`new`向量，则不要用旧指针指定覆盖它（正如我之前告诉过的，你会留下内存）。您制作了一个全新的指针：

```
// Our vector of double vector pointers
vector<vector<double>*> vop;

vector<double> mv;
mv.push_back(233);
mv.push_back(234);
mv.push_back(654);

// References a stack variable: don't delete
vector<double>* ptr_to_mv = &mv;
vop.push_back( ptr_to_mv );

// Makes a fresh copy of mv. You must delete this
// manually
vector<double>* fresh_ptr = new vector<double>( mv );
(*fresh_ptr)[0] = 1337;
// changes only data in fresh_ptr, not `mv`
vop.push_back( fresh_ptr );

/* Blah blah blah, work */
// Functions about to exit, gotta clean up!
delete fresh_ptr;
//delete ptr_to_mv; // NO.
//delete vop[0]; // NO!
//delete vop[1]; // ... Already deleted from fresh_ptr
// ... This is going to get tedious if we don't have a fresh_ptr
// for every vector we need! 
```

上面显示了问题：我们有两个指针，都在里面`vop`，一个需要通过调用 delete 来清理，另一个不需要，因为它只是对 的引用`mv`，它会自动清理！循环遍历向量并删除所有内容将导致该讨厌的断言发生。我们如何处理它并且仍然得到我们需要的清理？

肮脏而快速的解决方案 1 就是`delete vop[1]`/`fresh_ptr`并完成它。更好的解决方案是，每当你`new`获得一个资源时，你将它包装在一个叫做[`std::unique_ptr`](http://en.cppreference.com/w/cpp/memory/unique_ptr). 代码将如下所示：

```
// Our vector of double vector pointers. Non-owning
vector<vector<double>*> vop;

vector<double> mv;
mv.push_back(233);
mv.push_back(234);
mv.push_back(654);

// References a stack variable: don't delete
vector<double>* ptr_to_mv = &mv;
vop.push_back( ptr_to_mv );

// Makes a fresh copy of mv
// puts it inside a std::unique_ptr,
// which, like a stack-based vector,
// can clean itself up
std::unique_ptr<vector<double>> fresh_ptr( new vector<double>( mv ) );
vop.push_back( fresh_ptr.get() );

/* Blah blah blah, work */
// Functions about to exit, gotta clean up!
//delete fresh_ptr; // Not necessary
//delete ptr_to_mv; // Nope.jpg 
```

你去那里，删除所有注释掉的代码，突然间，你的东西就像口哨一样干净！

当然，现在，我要问你的最后一个问题是： ***你到底在做什么，需要所有这些指向向量指针引用的指针？***

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-15T23:42:59.677

是的，但您需要这样做：

```
vector<vector<double>*> vop; 
```

因为您正在寻找向量指针列表。

你在这里有什么：

```
vector<double *> vop 
```

只是一个`double`指针向量。

你也只想要这个：

```
vop.push_back(new_mv_pt); //  <- No asterisk (you don't want to de-reference it) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T00:22:57.820

You have a memory leak here:

```
vector<double>* new_mv_pt = new vector<double> (3);
new_mv_pt = &mv; 
```

You're creating a `vector<double>` on the heap, storing it's address in `new_mv_pt`, and then *overwriting* that address with the address of `mv`. The `vector<double>` still exists on the heap, but you have permanently lost its address (and therefore have no way to `delete` it or do anything else with it).

This code:

```
vector<double*> vop = new vector<double> (3);
vop.push_back(*new_mv_pt);
cout << (*vop)[1] << endl; 
```

Does not work because `vop` is a vector of `double*`s, and you are trying to insert a `vector<double>` into it. See [Ben's answer](https://stackoverflow.com/a/16026445/1227469) for the correct approach.

# python - 使用剪辑的模棱两可的错误，在哪里用零替换负数

> ID：16026430
> 
> 赞同：0
> 
> 时间：2013-04-15T23:40:57.397
> 
> 标签：python, numpy

我想用零替换多维数组中的负值。

我一直在这里尝试建议：[如何在没有循环的情况下将负元素转换为零？](https://stackoverflow.com/questions/3391843/how-to-transform-negative-elements-to-zero-without-a-loop)

我得到“具有多个元素的数组的真值是模棱两可的错误。”

这是数组（a）：

```
[ [  77.23262142  111.08317492  105.03704946   29.28612695   29.11454024
   10.07763987  -28.43527526  -41.68250773  -60.18250773  -73.61424205
-71.9592605   -74.25815349  -72.67697268  -61.01276604]
[ 346.32487234  346.35439263  332.45955869  305.13299042  253.4706288
 254.19387603  174.91896828  162.73446644  111.50014909   76.9614037
34.36361773  -25.55151142  -47.37254463  -57.63638227  -63.009076
-78.0385963   -56.38361475]
[ 217.45402363  172.89867308  158.19756607  159.74184651  142.31195721
153.54258452  158.28612695  133.56841478  159.88391293  131.50383913
152.97800887   60.40789817   93.2104812    71.13852548    2.02782437
-20.78398375  -52.2692236   -70.02752618  -76.46110552  -79.26184353
-68.36516456]
[ 268.77690186  246.15144061  199.3211823   229.61269522  175.28797197
219.35992769  194.95771367  197.6809609   202.8008871   194.34332252
201.19018599  140.29719706  164.36177271  100.68280592   96.90789817
62.38944799   19.59424503  -20.86700958  -47.14745238  -69.58472176
-74.28767379  -78.07365165  -89.37254463  -92.21387305]
[ 223.63668046  220.66804577  238.79535204  217.27690186  198.98723396
197.60162511  164.90605315  146.49461404  153.33225241  142.98538894
130.63852548  179.9706288   149.22708636  162.03704946  169.48723396
136.3008871   110.43926348   57.75845168   31.57579485  -25.19173283
-24.65667748  -56.25077342  -74.39652987  -78.69173283  -73.14745238
-71.89468486]
[ 205.54442954  236.53335942  220.39682806  210.16989079  163.2307764
177.45955869  161.84516754  161.58501994  186.19941109  174.29535204
201.33225241  211.2805919   193.33040739  206.32671736  190.24369153
160.91158821  164.12007529  125.9411085   113.82487234   83.49461404
35.88760297   -3.9795557   -21.52014611  -42.49800589  -62.73232323
-92.21387305  -78.48509076  -92.409445  ]
[ 269.6606657   280.96509374  273.66620075  272.83040739  252.07579485
263.64406053  272.48723396  257.49645906  240.12561035  250.14406053
241.07579485  237.02597935  226.8507026   206.71417123  173.3507026
174.34332252  188.71601625  149.40974319  191.18834097  153.50937418
113.72155131  131.25291662   89.53889448   68.59609005   41.67727086
10.68280592  -26.89283984  -35.4389653   -53.76368855  -61.76553356
-50.72494316]] 
```

我试过了：

```
b = np.clip(a,0, 5000)
b = a.clip(min=0) 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:33:31.150

首先，当您提出问题时，如果您可以发布一个演示您的问题的工作示例，这真的很有帮助。没有它，我们只能猜测。

似乎您使用的是数组数组而不是多维数组。例如：

```
import numpy as np
data = np.arange(3)

# Make an array of arrays
arrayOfArrays = np.empty(4, dtype=object)
arrayOfArrays.fill(data)
print arrayOfArrays
# [[0 1 2] [0 1 2] [0 1 2] [0 1 2]]

# Make a 2d array
array2d = np.empty((4, 3), dtype=int)
array2d[:] = data
print array2d
# [[0 1 2]
#  [0 1 2]
#  [0 1 2]
#  [0 1 2]]

# You can clip an ndarray of any dimenssion
array2d.clip(1)

# But clipping an array of arrays gives the error you describe
arrayOfArrays.clip(1)
# ValueError                                
# Traceback (most recent call last) <module>()
#      17 
#      18 # This will fail
#
# ---> 19 arrayOfArrays.clip(1)
#
# ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all() 
```

如果您实际上使用的是数组数组，即具有 dtype 对象的数组，那么请尝试使用多维数组。dtype 对象的数组容易出现所有类型的问题，我通常会尽量避免它们。您可以通过检查形状和 dtype 来判断您是否正在使用带有 dtype 对象的数组，如下所示：

```
print array2d.dtype
print array2d.shape
# int32
# (4, 3)

print arrayOfArrays.dtype
print arrayOfArrays.shape
# object
# (4,) 
```

当然，在这种情况下，您可以只遍历外部数组并在每个内部数组上调用 clip。

```
for i in range(len(arrayOfArrays)):
    arrayOfArrays[i].clip(1) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:01:08.093

尝试将负值设置为零：

```
a[a<0] = 0 
```

# php - 使用php将数据插入mysql时记录丢失

> ID：16026435
> 
> 赞同：0
> 
> 时间：2013-04-15T23:41:49.980
> 
> 标签：php, mysql, sql, database

我想填充一个数据库。下面的代码在循环中执行以填充一些相关的表。当循环运行 17 次时，“pubmedarticle”和“pubmedarticle_belongsto_user”表将填充 17 条记录。然而，“抽象”表填充了 10 条记录，而其他表填充了 16 条记录！运行循环没有限制，它运行了 17 次，循环后所有表都应包含 17 条记录。我找不到为什么在插入数据库时​​缺少一些内容。我很欣赏你的想法。

以下是主键：

```
pubmedarticle: pubmedArticleId
pubmedarticle_belongsto_user: userId, pubmedArticleId   
article: articleId, pubmedArticleId
abstract: abstractId, articleId , pubmedArticleId
pagination: paginationId, articleId, pubmedArticleId 
```

我检查了 mysqli_error 并且收到了 6 次这个结果（缺少 6 个！）： 错误描述：您的 SQL 语法有错误；查看与您的 MySQL 服务器版本相对应的手册，了解正确的语法，以使用 near 迄今为止最全面的地震灾害演习。第 1 行的半结构化面试

这是代码：

```
 mysqli_query($con,"INSERT INTO pubmedarticle (pubmedId) VALUES ('$pmid')");
//------------
$result_last_row = mysqli_query($con, "SELECT pubmedArticleId from pubmedarticle order by pubmedArticleId desc limit 1");
while($row2 = mysqli_fetch_array($result_last_row)) {
    $last_userID = $row2['pubmedArticleId'];
    }
mysqli_query($con,"INSERT INTO pubmedarticle_belongsto_user (userId, pubmedArticleId) VALUES ('$userId','$last_userID')");
//------------
mysqli_query($con,"INSERT INTO article (pubmedArticleId, articleTitle, articleDate) VALUES ('$last_userID', '$title', '$year_final')");
$result_last_row2 = mysqli_query($con, "SELECT articleId from article order by articleId desc limit 1");
while($row3 = mysqli_fetch_array($result_last_row2)) {
    $last_userID_article = $row3['articleId'];
    }
if (!mysqli_query($con,"INSERT INTO abstract (articleId, pubmedArticleId, abstractText) VALUES ('$last_userID_article','$last_userID', '$abstract')")){

        echo("Error description: " . mysqli_error($con));
        echo "</br>";
        }

mysqli_query($con,"INSERT INTO pagination (articleId, pubmedArticleId, medlinePgn) VALUES ('$last_userID_article','$last_userID', '$medlinepgn')");
mysqli_query($con,"INSERT INTO publicationtype (articleId, pubmedArticleId, publicationType) VALUES ('$last_userID_article','$last_userID', '$publicationtype')");
mysqli_query($con,"INSERT INTO journal (articleId, pubmedArticleId, issn, journalIssuePubDate, volume, issue, journalTitle, isoAbbreviation) 
    VALUES ('$last_userID_article','$last_userID', '$issn', '$year_final','$volume', '$issue', '$journalTitle', '$isoAbbreviation')"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:09:58.190

从您提到此错误的评论的声音中：

```
You have an error in your SQL syntax; 
check the manual that corresponds to your MySQL server version for the right syntax to use   
near 's most comprehensive earthquake disaster drill to date. Semistructured interview' at  
line 1 
```

听起来您的数据中有撇号破坏了 SQL。

这是使用参数化查询的一个很好的理由（参见[此处](http://www.php.net/manual/en/mysqli.prepare.php)）（这也将防止 SQL 注入）。

# backbone.js - 主干视图渲染方法默认参数

> ID：16026436
> 
> 赞同：2
> 
> 时间：2013-04-15T23:41:55.387
> 
> 标签：backbone.js, backbone-views, backbone-events

我有一个与模型相关联的主干视图。View 正在侦听 change 方法，如果模型发生更改，它会调用 render。

```
this.listenTo(this.model, 'change', this.render); 
```

我有一个问题，我的主干视图的渲染方法被多次调用。我正在尝试调试这个问题。为此，我在 render 方法中添加了 console.log 语句：

```
render: function(data) {
    if(this.model){
        console.log("Render Method:",data," For model:",this.model.cid);
    }
} 
```

现在这个数据值有时会被打印为未定义或类似模型的东西。有谁知道传递给模型更改侦听器的参数是什么？

请注意：我没有将任何内容传递给渲染方法。

和骨干文档没有提到这一点：[http ://documentcloud.github.io/backbone/#View-render](http://documentcloud.github.io/backbone/#View-render)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T14:37:33.450

The change event passes the `model` and a hash of `options`

In backbone [sources](http://documentcloud.github.io/backbone/docs/backbone.html#section-48):

```
 this.trigger('change', this, options); 
```

And so in the [documentation](http://documentcloud.github.io/backbone/#Events-catalog) as *mu is too short* has commented:

> "**change**" (model, options) — when a model's attributes have changed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T10:37:17.903

如果绑定发生多次，则事件回调会被多次调用，即

```
this.listenTo(this.model, 'change', this.render); 
```

正在执行多次。

`change`如果多次触发，也会发生这种情况。例如。您在 for 循环中而不是一次设置模型的每个属性。

任何回调都会接收一个事件作为参数。在你的情况下

```
render: function(data) {
    if(this.model){
        console.log("Render Method:",data," For model:",this.model.cid);
    }
} 
```

调用时，数据将被记录为未定义`view.render()`。当被事件触发时，数据将是一个事件`change`对象

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:57:04.933

据我所知，渲染函数不应该有任何参数传递给它

```
 Event.Listen=Backbone.View.extend({
          model: 'something'
        initialize:function(){
           this.listenTo(this.model,'change',this.render);

      }
        render:function(){
          //is called when the listen to event is triggered
          //if(this.model) does not make a lot of sense?? Does it need to be 
             //true ornull
           //call another object
           new Event.DoSomething();

        }
   }); 
```

来自 Backbone 站点“告诉一个对象监听**“其他”**对象上的特定事件”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T01:02:40.590

看起来在视图外部还有其他对渲染的调用（除了事件侦听器之外）。

如果你尝试这个（听其他方法而不是渲染）：

```
this.listenTo(this.model, 'change', this.customMethod); 
```

然后在下面的渲染视图中声明：

```
customMethod: function() {
    console.log(arguments, '<==== is there arguments?');
    if(this.model){
        console.log("Custom Render Method For model:",this.model.cid);
    }
} 
```

因此，请查看您的代码，除了 model.change 侦听器之外，您还在视图之外调用渲染方法。

# python - 错误 - 在 python 中计算 PCA 的欧几里得距离

> ID：16026437
> 
> 赞同：4
> 
> 时间：2013-04-15T23:41:57.357
> 
> 标签：python, numpy, face-recognition, pca, euclidean-distance

我正在尝试使用 python 通过主成分分析 (PCA) 实现人脸识别。我正在按照本教程中的步骤操作：http: [//onionesquereality.wordpress.com/2009/02/11/face-recognition-using-eigenfaces-and-distance-classifiers-a-tutorial/](http://onionesquereality.wordpress.com/2009/02/11/face-recognition-using-eigenfaces-and-distance-classifiers-a-tutorial/)

这是我的代码：

```
import os
from PIL import Image
import numpy as np
import glob
import numpy.linalg as linalg

#Step1: put database images into a 2D array
filenames = glob.glob('C:\\Users\\Karim\\Downloads\\att_faces\\New folder/*.pgm')
filenames.sort()
img = [Image.open(fn).convert('L').resize((90, 90)) for fn in filenames]
images = np.asarray([np.array(im).flatten() for im in img])

#Step 2: find the mean image and the mean-shifted input images
mean_image = images.mean(axis=0)
shifted_images = images - mean_image

#Step 3: Covariance
c = np.cov(shifted_images)

#Step 4: Sorted eigenvalues and eigenvectors
eigenvalues,eigenvectors = linalg.eig(c)
idx = np.argsort(-eigenvalues)
eigenvalues = eigenvalues[idx]
eigenvectors = eigenvectors[:, idx]

#Step 5: Only keep the top 'num_eigenfaces' eigenvectors
num_components = 20
eigenvalues = eigenvalues[0:num_components].copy()
eigenvectors = eigenvectors[:, 0:num_components].copy()

#Step 6: Finding weights
w = eigenvectors.T * np.asmatrix(shifted_images)

#Step 7: Input image
input_image = Image.open('C:\\Users\\Karim\\Downloads\\att_faces\\1.pgm').convert('L').resize((90, 90))
input_image = np.asarray(input_image).flatten()

#Step 8: get the normalized image, covariance, eigenvalues and eigenvectors for input image
shifted_in = input_image - mean_image
c = np.cov(input_image)
cmat = c.reshape(1,1)
eigenvalues_in, eigenvectors_in = linalg.eig(cmat)

#Step 9: Fing weights of input image
w_in = eigenvectors_in.T * np.asmatrix(shifted_in)
print w_in
print w_in.shape

#Step 10: Euclidean distance
d = np.sqrt(np.sum((w - w_in)**2))
idx = np.argmin(d)
match = images[idx] 
```

当我收到此错误时，我在步骤 10 中遇到了问题： `Traceback (most recent call last): File "C:/Users/Karim/Desktop/Bachelor 2/New folder/new3.py", line 59, in <module> d = np.sqrt(np.sum((w - w_in)**2)) File "C:\Python27\lib\site-packages\numpy\matrixlib\defmatrix.py", line 343, in __pow__ return matrix_power(self, other) File "C:\Python27\lib\site-packages\numpy\matrixlib\defmatrix.py", line 160, in matrix_power raise ValueError("input must be a square array") ValueError: input must be a square array`

有人可以帮忙吗？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T03:33:30.577

我认为您想将计算的行更改为以下内容`d`：

```
#Step 10: Euclidean distance
d = np.sqrt(np.sum(np.asarray(w - w_in)**2, axis=1) 
```

`M`这为您提供了每个图像像素之间的平方、求和、有根距离的长度（训练图像数量）列表。我相信你不想要矩阵产品，你想要每个值的元素平方，因此`np.asarray`使它*不是*矩阵。`w_in`这为您提供了每个`w`矩阵之间的“欧几里得”差异。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:49:48.697

当你去`(w - w_in)`的时候，结果不是一个方阵。要将矩阵自身相乘，它必须是正方形（这只是矩阵乘法的一个属性）。因此，要么你构造了你的`w`和`w_in`矩阵错误，要么你实际上想要做的是平方矩阵中的每个元素，`(w - w_in)`这是一个不同的操作。搜索元素乘法以找到 numpy 语法。

# php - PHP/SQL:: SQL 语句中的变量索引

> ID：16026439
> 
> 赞同：0
> 
> 时间：2013-04-15T23:42:32.907
> 
> 标签：php, indexing, string-interpolation

我把它放在一个 SQL 语句中：

```
WHERE course_num = '$course_details['course_num']'
      term_cd = '$course_details['term_cd']'
      term_year = '$course_details['term_year']'
      course_title = '$course_details['course_title']'
      units = '$course_details['units']' 
```

并得到一个错误。因为这显然行不通，如何在 SQL 语句中索引变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T23:44:43.143

使用 {$arrayvar['index']}

您也可以省略单引号，但我认为最好有它们。

# c# - 来自 ASP.NET MVC CMS 数据库的动态路由

> ID：16026441
> 
> 赞同：69
> 
> 时间：2013-04-15T23:42:56.577
> 
> 标签：c#, asp.net-mvc-4, routes

基本上我有一个使用 ASP.NET MVC 构建的 CMS 后端，现在我正在转到前端站点，需要能够根据输入的路由从我的 cms 数据库加载页面。

因此，如果用户输入 domain.com/students/information，MVC 将在 pages 表中查看是否存在具有与学生/信息匹配的永久链接的页面，如果存在，它将重定向到页面控制器，然后加载页面数据库中的数据并将其返回到视图以进行显示。

到目前为止，我已经尝试了一条全部路线，但它只适用于两个 URL 段，因此 /students/information，但不适用于 /students/information/fall。我在网上找不到任何关于如何实现这一点的信息，所以在我找到并开源 ASP.NET MVC cms 并剖析代码之前，我会在这里询问。

这是我到目前为止的路线配置，但我觉得有更好的方法可以做到这一点。

```
 public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        // Default route to handle core pages
        routes.MapRoute(null,"{controller}/{action}/{id}",
                        new { action = "Index", id = UrlParameter.Optional },                  
                        new { controller = "Index" }
        );

        // CMS route to handle routing to the PageController to check the database for the route.

        var db = new MvcCMS.Models.MvcCMSContext();
        //var page = db.CMSPages.Where(p => p.Permalink == )
        routes.MapRoute(
            null,
            "{*.}",
            new { controller = "Page", action = "Index" }
        );          
    } 
```

如果有人能指出我将如何从数据库中加载 CMS 页面的正确方向，最多三个 URL 段，并且仍然能够加载具有预定义控制器和操作的核心页面。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-04-16T07:13:00.500

您可以使用约束来决定是否覆盖默认路由逻辑。

```
public class CmsUrlConstraint : IRouteConstraint
{
    public bool Match(HttpContextBase httpContext, Route route, string parameterName, RouteValueDictionary values, RouteDirection routeDirection)
    {
        var db = new MvcCMS.Models.MvcCMSContext();
        if (values[parameterName] != null)
        {
            var permalink = values[parameterName].ToString();
            return db.CMSPages.Any(p => p.Permalink == permalink);
        }
        return false;
    }
} 
```

在路由定义中使用它，例如，

```
routes.MapRoute(
    name: "CmsRoute",
    url: "{*permalink}",
    defaults: new {controller = "Page", action = "Index"},
    constraints: new { permalink = new CmsUrlConstraint() }
);

routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
); 
```

现在，如果您在“页面”控制器中有一个“索引”操作，例如，

```
public ActionResult Index(string permalink)
{
    //load the content from db with permalink
    //show the content with view
} 
```

1.  所有 url 都将被第一条路由捕获并由约束进行验证。
2.  如果永久链接存在于 db 中，则 url 将由页面控制器中的 Index 操作处理。
3.  如果不是，约束将失败，并且 url 将回退到默认路由（我不知道您在项目中是否有任何其他控制器以及您将如何决定您的 404 逻辑）。

**编辑**

为了避免`Index`在控制器的动作中重新查询cms页面`Page`，可以使用`HttpContext.Items`字典，比如

在约束

```
var db = new MvcCMS.Models.MvcCMSContext();
if (values[parameterName] != null)
{
    var permalink = values[parameterName].ToString();
    var page =  db.CMSPages.Where(p => p.Permalink == permalink).FirstOrDefault();
    if(page != null)
    {
        HttpContext.Items["cmspage"] = page;
        return true;
    }
    return false;
}
return false; 
```

然后在行动中，

```
public ActionResult Index(string permalink)
{
    var page = HttpContext.Items["cmspage"] as CMSPage;
    //show the content with view
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-03T19:59:49.723

我使用不需要任何自定义路由器处理的更简单的方法。只需创建一个处理一些可选参数的单个/全局控制器，然后根据需要处理这些参数：

```
//Route all traffic through this controller with the base URL being the domain 
[Route("")]
[ApiController]
public class ValuesController : ControllerBase
{
    //GET api/values
    [HttpGet("{a1?}/{a2?}/{a3?}/{a4?}/{a5?}")]
    public ActionResult<IEnumerable<string>> Get(string a1 = "", string a2 = "", string a3 = "", string a4 = "", string a5 = "")
    {
        //Custom logic processing each of the route values
        return new string[] { a1, a2, a3, a4, a5 };
    }
} 
```

domain.com/test1/test2/test3 上的示例输出

```
["test1","test2","test3","",""] 
```

# c# - 实体框架代码首先更新复杂类型的单个属性

> ID：16026452
> 
> 赞同：2
> 
> 时间：2013-04-15T23:43:37.540
> 
> 标签：c#, entity-framework, ef-code-first, entity-framework-5, complextype

我有一个奇怪的行为。我想更新复杂类型的单个属性。当我指定要使用 IsModified 更新的属性时（有些属性为真，有些为假），我没有任何更新。如果我没有指定复杂类型的属性，则会更新复杂属性的每个字段。

```
public class MyEntity
{
    public MyComplexClass Property1 { get; set; }
}

//... The code below doesn't work, in fact it update nothing
var entityLocal = this.Set<MyEntity>().Local.SingleOrDefault(d => d.Id == entity.Id);
if (entityLocal == null)
{
   entityLocal = this.Set<MyEntity>().Attach(entity);
}
this.ChangeTracker.Entries<MyEntity>().Single(d => d.Entity == entityLocal).State = EntityState.Modified;
this.Entry(entity).Property(s => s.Property1.SubProperty1).IsModified = true;
this.Entry(entity).Property(s => s.Property1.SubProperty2).IsModified = false;//This seam to remove all update of the complex type...?
this.SaveChanges(); 
```

本产品：

```
update [dbo].[MyEntity]
set @p = 0
where (([Id] = @0)) 
```

如果我没有将 SubProperty2 的 IsModified 指定为 false，我在 SQL 探查器中有以下内容：

```
update [dbo].[MyEntity]
set [Property1_SubProperty1] = @0, [Property1_SubProperty2] = null
where (([Id] = @1)) 
```

当我在某些属性上指定“IsModified”时，怎么会没有更新？

## 编辑

经过几次尝试，我可以确认，如果我检查这两行，当复杂类型的 1 个属性设置为 IsModified 为 False 时，整个复杂类型没有更新。

```
var entry = DatabaseContext.Entry(entity);
var namesOfChangedProperties = entry.CurrentValues.PropertyNames.Where(p => entry.Property(p).IsModified).ToArray(); 
```

如果我将任何属性设置为 True，则没有问题，但是当 1 属性设置为 false (IsModified) 时，整个 SubProperty 不在 namesOfChangedProperties 变量内。

## 编辑 2

我尝试使用具有相同结果的 ComplexProperty。

```
this.ChangeTracker.Entries<MyEntity>().Single(d => d.Entity == entityLocal).State = EntityState.Modified;
this.Entry(entity).ComplexProperty(s => s.Property1).Property(d => d.SubProperty1).IsModified = true;
this.Entry(entity).ComplexProperty(s => s.Property1).Property(d => d.SubProperty2).IsModified = false;
this.SaveChanges(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T02:37:53.180

这是 EF 对复杂类型进行更改跟踪的方式的限制。EF 不会跟踪属性级别的更改，而只会跟踪整个对象是否被修改。这是作为 EF1 的一部分内置的限制，尚未删除。一方面，对于那些确实想要更精细的更改跟踪的人来说，消除这个限制会很好。然而，另一方面，将复杂对象视为不可变的“值类型”通常被认为是最佳实践。对于此类值类型，始终设置整个对象，这使得更精细的更改跟踪不太有用。此外，更精细的变更跟踪并不是一个非常普遍要求的功能，因此 EF 团队不太可能很快着手处理它。

# bash - 使用bash循环遍历csv文件中的行

> ID：16026455
> 
> 赞同：-1
> 
> 时间：2013-04-15T23:43:44.283
> 
> 标签：bash, csv, while-loop

即使 .csv 文件中有 2 个条目（行），为什么这个 while 循环只执行一次？
当没有文件/目录与表达式匹配时，字符串'ls：/root/ *heapdump*：没有这样的文件或目录'怎么会输出到控制台？

```
#!/bin/bash

INPUT=targets.csv

[ ! -f $INPUT ] && { echo "$INPUT file not found"; exit 99; }
while IFS=, read target user password path
do
    result=$(sshpass -p "$password" ssh "$user"@"$target" ls "$path"*heapdump*)

    if [ $? -ne 0 ]
    then
            echo "No Heap dumps detected."
    else
            echo "Found a Heap dump! Possible OOM issue detected"
    fi

done < $INPUT 
```

.csv 内容..

```
rob@laptop:~/scripts$ cat targets.csv 
server.com,root,passw0rd,/root/
server.com,root,passw0rd,/root/ 
```

输出 ..

```
rob@laptop:~/scripts$ ./checkForHeapdump.sh 
ls: /root/*heapdump*: No such file or directory
No Heap dumps detected. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:03:06.760

`ssh`正在从标准输入读取，因此在第一次迭代期间它会吞噬 CSV 文件的其余部分。改成：

```
result=$(sshpass -p "$password" ssh -n "$user"@"$target" ls "$path"*heapdump*) 
```

该`-n`选项将标准输入重定向`ssh`到`/dev/null`.

关于错误消息，这是您执行此操作时的正常错误输出：

```
ls filename-or-wildcard 
```

并且没有匹配项。如果您不想看到，请重定向 stderr：

```
result=$(sshpass -p "$password" ssh -n "$user"@"$target" ls "$path"*heapdump* 2>/dev/null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:11:29.633

我猜您的 CSV 文件的最后一行不会以回车符终止。

发生这种情况时，`read`将填充变量，但没有回车终止该行，它将到达文件末尾，因此循环不会执行。

如果您无法确认最后一行将以回车结束，并且无法通过`echo >> targets.csv`在脚本开头添加一个来编辑文件，那么您可以检查循环后的变量以对其进行操作。为此，我将在循环结束时清除其中一个变量，这样您就可以简单地测试它是否是非零长度，以了解最后一个未处理的行。

# c - 小写到大写函数 - C

> ID：16026457
> 
> 赞同：2
> 
> 时间：2013-04-15T23:44:01.680
> 
> 标签：c, function

我编写了这个函数来将预设的小写 str 转换为它的大写变体。我已经尝试了所有我知道的将小写转换为大写的不同配置，但是当我打印它时。它仍然以小写形式结束。所以我有点卡住了。

```
char* stoupper(char str[]);

char str[100]= "uppercase";

printf("%s" , stoupper(str)); // Test to make sure it is working 

char* stoupper(char str[])
{ 
      int i = 0; 

      while(str[i] != '\0') 
      { 
                   if(str[i] >= 'A' && str[i] <= 'Z') 
                   str[i] = str[i] + ('A' - 'a'); 
                   i++; 
      }
      return str;
}  

/* I've tried various variations of this function this is just the one i had first */ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T23:48:53.567

您的代码只修改了已经大写的字母，并将它们变成了谁知道什么（好吧，我相信您可以使用 ASCII 表弄清楚）。如果要对小写字母进行操作，则需要更改`if`条件：

```
if (str[i] >= 'a' && str[i] <= 'z') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T23:49:48.700

你为什么要重新发明轮子？ctype.h 是你的朋友

使用 toupper(int) 方法。就像是

```
char* stoupper(char str[]);

char str[100]= "uppercase";

printf("%s" , stoupper(str)); // Test to make sure it is working 

char* stoupper(char str[])
{ 
      int i = 0; 

      while(str[i]) 
      { 
          str[i]=toupper(str[i]);
          i++; 
      }
      return str;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T23:50:15.633

我认为你的 if 条件应该是：

```
if(str[i] >= 'a' && str[i] <= 'z') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-16T14:18:03.317

if 语句中的条件需要更改

> if(str[i] >= 'A' && str[i] <= 'Z')

我可以建议另一种将大写字母更改为小写字母的方法，反之亦然

```
char* stoupper(char str[])
{ 
      for(int i=0;i<strlen(str);i++)
          if(!(str[i]>='A'&&str[i]<='Z')){
              str[i]=str[i]^' ';
          }

      return str;
} 
```

这种方法有效，因为

[小写字符的 ASCII 值] XOR [' ' 的 ASCII 值] =[大写相同字符的 ASCII 值]

# bash - 执行使用混合引号和 asterix 的动态 shell 脚本命令

> ID：16026458
> 
> 赞同：4
> 
> 时间：2013-04-15T23:44:19.740
> 
> 标签：bash, shell, quotes

我有以下我正在尝试编写脚本的内容。我试图迎合混合报价以及 asterix 的需求而碰壁了。

这就是我所拥有的

```
cmd_1="/usr/local/nz/bin/nzsql -d ${SOURCE_DB} -c "
cmd_2="\"create external table '${EXTERNAL_PATH}${EXTERNAL_FILE}'"
cmd_3=" USING (QUOTEDVALUE 'DOUBLE' ESCAPECHAR '\' DELIM ',' TIMESTYLE '24HOUR' LOGDIR '${EXTERNAL_PATH}' ENCODING 'INTERNAL')"
cmd_4=" as select * from ${SOURCE_TABLE}\""
cmd=${cmd_1}${cmd_2}${cmd_3}${cmd_4} 
```

当 echo'd 看起来不错并且实际上运行时复制并粘贴到命令行。

```
/usr/local/nz/bin/nzsql -d mydatDba -c "create external table '/datawarehouse/development/externaldata/output/EXT_mytable.csv' USING (QUOTEDVALUE 'DOUBLE' ESCAPECHAR '\' DELIM ',' TIMESTYLE '24HOUR' LOGDIR '/datawarehouse/development/externaldata/output/' ENCODING 'INTERNAL') as select * from mytable" 
```

为了让它正确回显，我确实必须将 ${cmd} 用双引号括起来，对于看起来像这样的执行也是如此。

```
"${cmd}" 
```

但是，当从 shell 脚本运行时，我收到：没有这样的文件或目录。我已经验证了所涉及的目录，正如我所提到的，实际上可以将生成的内容复制并粘贴到命令行，并且工作正常。

我只能假设在我的 echo 命令和错误中回显的内容实际上并不是正在执行的内容。

非常感谢您就如何获得“真实”命令的回显和/或我对引号的使用提出建议。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-15T23:50:46.247

使用内置`eval`命令：

```
eval "$cmd" 
```

# hadoop - 自定义映射器为 jar 文件

> ID：16026461
> 
> 赞同：0
> 
> 时间：2013-04-15T23:44:49.363
> 
> 标签：hadoop, hive

我想为 Hive 编写一个自定义映射器，它是一个 jar 文件。我将如何在查询中使用它？

使用常规语法：

```
add file myfile.jar

...

map using myfile.jar 
```

似乎不起作用。我得到的错误是：

> 2013-04-15 22:52:26,207 INFO org.apache.hadoop.hive.ql.exec.ScriptOperator：脚本没有消耗所有输入数据。这被视为错误。2013-04-15 22:52:26,207 信息 org.apache.hadoop.hive.ql.exec.ScriptOperator：设置 hive.exec.script.allow.partial.consumption=true；忽略它。2013-04-15 22:52:26,207 致命的 ExecReducer: org.apache.hadoop.hive.ql.metadata.HiveException: java.io.IOException: Broken pipe

注意：我的 jar 是一个 jruby 文件，用[warbler](https://github.com/jruby/warbler)编译成一个 jar 。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T02:40:04.310

Hive 使用“流式”自定义映射器和缩减器 - 一个简单的程序，从标准输入读取并在标准输出中写入。所以通常有用于此的脚本语言：Python、Perl、PHP 甚至 Bash。当然，还有 Ruby。

但是，如果您想为此使用 java 程序，则应该使该程序可执行。你真的需要使用 Java 来进行普通的标准输入/标准输出工作吗？

UPD：所以 JRuby 只使用普通的 Ruby。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T00:34:02.920

如果您需要完全使用 Java，请尝试编写自己的 UDF 而不是映射器。实际上，HiveQL 函数和 UDF 的作用与映射器相同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T20:18:31.760

Hive 只会执行任何映射器脚本。在这种情况下，它需要像运行 jar 文件一样`java -jar myfile.jar`，但它试图以`./myfile.jar`. 我的解决方案是添加一个名为`myfile.sh`. shell脚本运行jar，我用作`myfile.sh`映射器。这样我就可以将`.jar`文件用作映射器。

# java - 使用 Java Netbeans 发送电子邮件

> ID：16026462
> 
> 赞同：0
> 
> 时间：2013-04-15T23:44:51.430
> 
> 标签：java, web-applications, sendmail

最近，我在Java netbeans 中制作了Web 应用程序，并制作了注册和登录系统，你能告诉我如何使用Java 发送电子邮件，这样当用户注册时，他会在他的电子邮件中收到欢迎消息。我只想要发送电子邮件的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:47:59.757

从[这里](http://www.jvmhost.com/articles/how-to-send-mail-with-javamail-and-tomcat)抄袭：

```
import javax.mail.*;
import javax.mail.internet.*;
import java.util.*;
import java.io.*;

public class SendMailUsingAuthentication
{
  private static final String SMTP_HOST_NAME = "gemini.jvmhost.com"; //or simply "localhost"
  private static final String SMTP_AUTH_USER = "me@domain.com";
  private static final String SMTP_AUTH_PWD  = "secret";
  private static final String emailMsgTxt      = "Body";
  private static final String emailSubjectTxt  = "Subject";
  private static final String emailFromAddress = "me@domain.com";

  // Add List of Email address to who email needs to be sent to
  private static final String[] emailList = {"he@domain.net"};

  public static void main(String args[]) throws Exception
  {
    SendMailUsingAuthentication smtpMailSender = new SendMailUsingAuthentication();
    smtpMailSender.postMail( emailList, emailSubjectTxt, emailMsgTxt, emailFromAddress);
    System.out.println("Sucessfully Sent mail to All Users");
  }

  public void postMail( String recipients[ ], String subject,
    String message , String from) throws MessagingException, AuthenticationFailedException
  {
    boolean debug = false;

    //Set the host smtp address
    Properties props = new Properties();
    props.put("mail.smtp.host", SMTP_HOST_NAME);
    props.put("mail.smtp.auth", "true");
    Authenticator auth = new SMTPAuthenticator();
    Session session = Session.getDefaultInstance(props, auth);

    session.setDebug(debug);

    // create a message
    Message msg = new MimeMessage(session);

    // set the from and to address
    InternetAddress addressFrom = new InternetAddress(from);
    msg.setFrom(addressFrom);

    InternetAddress[] addressTo = new InternetAddress[recipients.length];
    for (int i = 0; i < recipients.length; i++)
    {
        addressTo[i] = new InternetAddress(recipients[i]);
    }
    msg.setRecipients(Message.RecipientType.TO, addressTo);

    // Setting the Subject and Content Type
    msg.setSubject(subject);
    msg.setContent(message, "text/plain");
    Transport.send(msg);
 }

private class SMTPAuthenticator extends javax.mail.Authenticator
{
    public PasswordAuthentication getPasswordAuthentication()
    {
        String username = SMTP_AUTH_USER;
        String password = SMTP_AUTH_PWD;
        return new PasswordAuthentication(username, password);
    }
}
} 
```

如果您需要进一步的帮助，请告诉我，我会提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-01-27T13:01:26.997

```
 public static void main(String[] args){
        final String fromEmail = "from Emailid";//user.getFromEmail(); //requires valid gmail id
        final String password = " password of from emailid";//user.getPassword(); // correct password for gmail id
         final String toEmail = "to emailid"; // can be any email id 

        Properties props = new Properties();
        props.put("mail.smtp.host", "smtp.gmail.com"); //SMTP Host
        props.put("mail.smtp.port", "587"); //TLS Port
        props.put("mail.smtp.auth", "true"); //enable authentication
        props.put("mail.smtp.starttls.enable", "true"); //enable STARTTLS
         //enable authentication
               try
        {
                Authenticator auth = new Authenticator() {
            //override the getPasswordAuthentication method
                        @Override
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(fromEmail, password.toCharArray());
            }
        };
                Session session = Session.getDefaultInstance(props,null);
          MimeMessage msg = new MimeMessage(session);
          //set message headers
          msg.addHeader("Content-type", "text/HTML; charset=UTF-8");
          msg.addHeader("format", "flowed");
          msg.addHeader("Content-Transfer-Encoding", "8bit");

          msg.setFrom(new InternetAddress(fromEmail, "Rameshwar Agarwal"));

          msg.setReplyTo(InternetAddress.parse(fromEmail, false));

          msg.setSubject("app test email", "UTF-8");

          msg.setText("hello Rameshwar", "UTF-8");

          msg.setSentDate(new Date());

          msg.setRecipients(Message.RecipientType.TO, InternetAddress.parse(toEmail, false));
          System.out.println("Message is ready");
              Transport trans=session.getTransport("smtp");
              trans.connect("smtp.gmail.com",fromEmail,password);
              trans.sendMessage(msg,msg.getAllRecipients());

          System.out.println("EMail Sent Successfully!!");
        }
        catch (Exception e) {
          e.printStackTrace();
        }
} 
```

[不要忘记从下载 java mail api](https://javaee.github.io/javamail/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:47:27.017

从[这个问题](https://stackoverflow.com/questions/3649014/send-email-using-java)：

以下代码在 Google SMTP 服务器上运行良好。您需要提供您的 Google 用户名和密码。（别忘了下载[JavaMail API](http://www.oracle.com/technetwork/java/javamail/index.html)）

```
import com.sun.mail.smtp.SMTPTransport;
import java.security.Security;
import java.util.Date;
import java.util.Properties;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.Session;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

public class GoogleMail {
    private GoogleMail() {
    }

    /**
     * Send email using GMail SMTP server.
     *
     * @param username GMail username
     * @param password GMail password
     * @param recipientEmail TO recipient
     * @param title title of the message
     * @param message message to be sent
     * @throws AddressException if the email address parse failed
     * @throws MessagingException if the connection is dead or not in the connected state or if the message is not a MimeMessage
     */
    public static void Send(final String username, final String password, String recipientEmail, String title, String message) throws AddressException, MessagingException {
        GoogleMail.Send(username, password, recipientEmail, "", title, message);
    }

    /**
     * Send email using GMail SMTP server.
     *
     * @param username GMail username
     * @param password GMail password
     * @param recipientEmail TO recipient
     * @param ccEmail CC recipient. Can be empty if there is no CC recipient
     * @param title title of the message
     * @param message message to be sent
     * @throws AddressException if the email address parse failed
     * @throws MessagingException if the connection is dead or not in the connected state or if the message is not a MimeMessage
     */
    public static void Send(final String username, final String password, String recipientEmail, String ccEmail, String title, String message) throws AddressException, MessagingException {
        Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());
        final String SSL_FACTORY = "javax.net.ssl.SSLSocketFactory";

        // Get a Properties object
        Properties props = System.getProperties();
        props.setProperty("mail.smtps.host", "smtp.gmail.com");
        props.setProperty("mail.smtp.socketFactory.class", SSL_FACTORY);
        props.setProperty("mail.smtp.socketFactory.fallback", "false");
        props.setProperty("mail.smtp.port", "465");
        props.setProperty("mail.smtp.socketFactory.port", "465");
        props.setProperty("mail.smtps.auth", "true");

        /*
        If set to false, the QUIT command is sent and the connection is immediately closed. If set 
        to true (the default), causes the transport to wait for the response to the QUIT command.

        ref :   http://java.sun.com/products/javamail/javadocs/com/sun/mail/smtp/package-summary.html
                http://forum.java.sun.com/thread.jspa?threadID=5205249
                smtpsend.java - demo program from javamail
        */
        props.put("mail.smtps.quitwait", "false");

        Session session = Session.getInstance(props, null);

        // -- Create a new message --
        final MimeMessage msg = new MimeMessage(session);

        // -- Set the FROM and TO fields --
        msg.setFrom(new InternetAddress(username + "@gmail.com"));
        msg.setRecipients(Message.RecipientType.TO, InternetAddress.parse(recipientEmail, false));

        if (ccEmail.length() > 0) {
            msg.setRecipients(Message.RecipientType.CC, InternetAddress.parse(ccEmail, false));
        }

        msg.setSubject(title);
        msg.setText(message, "utf-8");
        msg.setSentDate(new Date());

        SMTPTransport t = (SMTPTransport)session.getTransport("smtps");

        t.connect("smtp.gmail.com", username, password);
        t.sendMessage(msg, msg.getAllRecipients());      
        t.close();
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-21T13:32:38.300

在这里，您可以找到为使用 Google 帐户发送电子邮件而编写的示例 java 类。请按照以下[链接](http://lasanthals.blogspot.com/2013/09/send-email-using-java-and-google-account.html)

它使用以下属性

```
Properties props = new Properties();
     props.put("mail.smtp.auth", "true");
     props.put("mail.smtp.starttls.enable", "true");
     props.put("mail.smtp.host", "smtp.gmail.com");
     props.put("mail.smtp.port", "587"); 
```

# c# - 如何使用 XSD 生成的 C# 类来序列化/反序列化 XML 的各个元素

> ID：16026463
> 
> 赞同：1
> 
> 时间：2013-04-15T23:44:56.163
> 
> 标签：c#, xml, serialization, deserialization

我目前有一个从 XML 模式生成的 C# 类，它用于获取 XML 文件并更新数据库中的值。

我卡住的地方是这些值之一（由于复杂性和可变性）需要作为独立的 xml 存储在数据库中，然后我需要在运行时对其进行反序列化。

是否可以定义第二个 C# 类来处理这一元素而不干扰主类。

或者在重新序列化以保存时更改此节点的名称会更容易吗？

编辑：我为缺乏背景而道歉，已经很晚了，我已经出门了。XML 文件用于为不同的客户端设置 Web 表单验证和自定义，至少 80% 的模式是非常简单的数据（强制字段、应用正则表达式、隐藏和显示字段是一些示例）

我提到的复杂部分与多个字段之间的条件验证有关。下面是 XML 的样例：

```
<?xml version="1.0"?> 
```

```
<Relationships>
    <Relationship xsi:type="MutuallyExclusiveRelationship">
        <Fields>
            <Field Id="lineItemAfeNumber" IsInGrid="true"/>
            <Field Id="lineItemCostCenter" IsInGrid="true"/>
        </Fields>
    </Relationship>     
</Relationships>

<Fields>

    <Field xsi:type="TextField" Id="invoiceNumber">
        <ValidationRegex Value="^[0-9a-zA-Z\-]*$"/>
        <ValidationRegexMessage Value="{0} must be alpha-numeric and can contain dashes."/>
        <MaxLength Value="20"/>
    </Field>

    <Field xsi:type="TextField" Id="afeNumber">
        <InputMask Value="aa999999"/>
        <ValidationRegex Value="^[A-Za-z]{2}[0-9]{6}$"/>
        <ValidationRegexMessage Value="{0} must be in the format AA999999."/>
    </Field>

    <Field xsi:type="TextField" Id="costCenter">
        <ValidationRegex Value="^[a-zA-Z0-9]*$"/>
        <ValidationRegexMessage Value="{0} must be alpha-numeric."/>
        <MinLength Value="8"/>
        <MaxLength Value="9"/>
    </Field>

    <Field xsi:type="TextField" Id="orderNumber">
        <MinLength Value="1"/>
        <MaxLength Value="12"/>
    </Field>

    <Field xsi:type="TextField" Id="generalLedgerCode">
        <InputMask Value="9999.999"/>
        <ValidationRegex Value="^[0-9]{4}\.[0-9]{3}$"/>
        <ValidationRegexMessage Value="{0} must be in the format 0000.000."/>
    </Field>

    <Field xsi:type="TextField" Id="approverId">
        <Label Value="Approver Code"/>
        <MaxLength Value="10"/>
    </Field>

    <Field xsi:type="TextField" Id="leaseWell">
        <Label Value="Location/UWI"/>
    </Field>

    <Field xsi:type="TextField" Id="poNumber">
        <ValidationRegex Value="^[a-zA-Z0-9/-]*$"/>
        <ValidationRegexMessage Value="{0} must be alpha-numeric and can contain '-'."/>
        <MaxLength Value="12"/>
    </Field>

    <Field xsi:type="DropDownField" Id="currency">
        <Label Value="Currency"/>
        <DefaultValue Value="CAD"/>
        <Values>
            <DropDownValue Value="USD"/>
            <DropDownValue Value="CAD"/>
        </Values>
    </Field>    

    <Field xsi:type="TextField" Id="remitToTax">
        <Label Value="GST/HST #"/>
    </Field>

    <Field xsi:type="TextField" Id="detailsComment">
        <Mandatory Value="false"/>
        <MaxLength Value="40"/>
    </Field>    

    <Field xsi:type="TextField" Id="newComment">
        <MaxLength Value="40"/>
    </Field>

    <!-- Attachments -->
    <Field xsi:type="TextField" Id="attachmentFileName">
        <MandatoryMessage Value="Attachments are required."/>
    </Field>

    <Field xsi:type="DropDownField" Id="approverCompanyCode">
        <Mandatory Value="true"/>
    </Field>

    <Field xsi:type="TextField" Id="recipientName">
      <Mandatory Value="true"/>
    </Field>        
</Fields>

<Grids>
    <Grid Id="invoiceDetailsTable">
        <Fields>
            <Field xsi:type="TextField" Id="lineItemDescription">
                <MaxLength Value="40"/>
            </Field>                

            <Field xsi:type="TextField" Id="lineItemAfeNumber">
                <InputMask Value="aa999999"/>
                <ValidationRegex Value="^[A-Za-z]{2}[0-9]{6}$"/>
                <ValidationRegexMessage Value="{0} must be in the format AA999999."/>
            </Field>

            <Field xsi:type="TextField" Id="lineItemCostCenter">
                <ValidationRegex Value="^[a-zA-Z0-9]*$"/>
                <ValidationRegexMessage Value="{0} must be alpha-numeric."/>
                <MinLength Value="8"/>
                <MaxLength Value="9"/>
            </Field>

            <Field xsi:type="TextField" Id="lineItemOrderNumber">
                <MinLength Value="1"/>
                <MaxLength Value="12"/>
            </Field>

            <Field xsi:type="TextField" Id="lineItemLeaseWell">
                <Label Value="Location/UWI"/>
                <Mandatory Value="true"/>
            </Field>

            <Field xsi:type="TextField" Id="lineItemGlAccount">
                <InputMask Value="9999.999"/>
                <ValidationRegex Value="^[0-9]{4}\.[0-9]{3}$"/>
                <ValidationRegexMessage Value="{0} must be in the format 0000.000."/>
            </Field>

            <Field xsi:type="TextField" Id="lineItemPoNumber">
                <ValidationRegex Value="^[a-zA-Z0-9/-]*$"/>
                <ValidationRegexMessage Value="{0} must be alpha-numeric and can contain '-'."/>
                <MaxLength Value="12"/>
            </Field>
        </Fields>
    </Grid>
</Grids> 
```

这里的关系部分是我想要重新序列化的部分，这显然是该部分的一个简单示例，还有更多未显示的子元素。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:16:50.143

将主类保存到数据库时，为什么不序列化这个复杂的元素？例如，如果您的课程是这样的：

```
public class Master
{
    public string simple;
    public Complex complex;
} 
```

您可以在 db 中将复杂元素另存为 xml：

```
void SaveToDB(Stream file)
{
    XmlSerializer masterSerializer = new XmlSerializer(typeof(Master));
    Master m = (Master)masterSerializer.Deserialize(file);
    //save m.simple to db
    XmlSerializer complexSerializer = new XmlSerializer(typeof(Complex));
    StringWriter complexXmlWriter = new StringWriter();
    complexSerializer.Serialize(complexXmlWriter, m.complex);
    string complexXml = complexXmlWriter.ToString();
    //save complexXml to db
} 
```

这样您就不需要更改您的大师班，您可以将复杂的元素保存在 xml 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T16:03:40.367

经过一些进一步的调查和头脑风暴，我们确定这两个不同的序列化类实际上可以存在于不同的范围内，这消除了我遇到的冲突。

# javascript - “返回值”的控制台符号

> ID：16026464
> 
> 赞同：1
> 
> 时间：2013-04-15T23:45:20.620
> 
> 标签：javascript, google-chrome, console, undefined

我正在使用 Chrome 的 Javascript 控制台。有时我会看到`undefined`前面有一个特殊符号（我在下面的示例中将其显示为 *，但它实际上看起来像一个指向左侧的小箭头）。有时`undefined`前面没有任何东西。这是为什么？

```
> var number = 5;
undefined
> console.log("something")
something
*undefined 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T23:49:32.973

我认为它只是为了将控制台输出与表达式返回的值区分开来。它显然只在表达式导致控制台输出时使用，因为那是需要区分的时候。

# c++ - 如何将 boost::string_ref 与 std::string 进行比较

> ID：16026467
> 
> 赞同：3
> 
> 时间：2013-04-15T23:45:30.777
> 
> 标签：c++, string, boost, stl

我正在尝试`boost::string_ref`按我的意愿工作，但我现在面临一个问题 - 以下代码无法编译：

```
 #include <boost/utility/string_ref.hpp> 
 #include <iostream> 
 #include <string> 

 using namespace std;

int main() {
   string test = "test";
   boost::string_ref rtest(test);
   cout << (rtest == "test")<<endl;
} 
```

并且 gcc 抛出 30kB 错误日志，从

```
source.cpp: In function 'int main()':
source.cpp:10:19: error: no match for 'operator==' (operand types are 'boost::string_ref {aka boost::basic_string_ref<char, std::char_traits<char> >}' and 'const char [5]')
    cout << (rtest == "test")<<endl;
                   ^ 
```

如何`boost::string_ref`比较`std::string`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T13:17:01.770

`string_ref`老实说，在它成熟之前，我会完全避免使用。您无法将 a`string_ref`与 a`std::string`或 a`const char *`进行开箱即用的比较这一事实应该会敲响警钟（看起来他们忘了写一堆比较运算符），更糟糕的是，看起来库似乎没有接受足够的测试（例如[错误 8067](https://svn.boost.org/trac/boost/ticket/8067)！）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:51:59.530

只需`string_ref`从字符串中取出。它们的建造成本非常低。尽管针对字符串文字，您可能希望包含长度。否则它将迭代一次以找到字符串的结尾，然后再次迭代以比较它们。只要确保如果您更改字符串，您就会保持计数是最新的。

```
cout << (rtest == boost::string_ref("test",4)) << endl; 
```

有了 a `std::string`，你就不用担心计数了，因为`string_ref`只会调用`size()`成员函数，这也很便宜。

# c# - C#中的直角三角形计算

> ID：16026469
> 
> 赞同：0
> 
> 时间：2013-04-15T23:45:37.573
> 
> 标签：c#, math, trigonometry

高中毕业很久了。如果我有一个直角三角形，并且知道角度 A，我想计算出它对面的长度。这个 c# 食谱页面 ( [http://www.gibmonks.com/c_sharp/csharpckbk2-CHP-1-SECT-14.html](http://www.gibmonks.com/c_sharp/csharpckbk2-CHP-1-SECT-14.html) ) 建议：

对面 = Math.Sin(theta) * 斜边；

假设角度 A (theta) 是 45，斜边长 10 个单位，这段代码给我的结果是 8.51。至少 4 个在线三角形求解器给了我 7.07 的答案（例如[http://www.cleavebooks.co.uk/scol/calrtri.htm](http://www.cleavebooks.co.uk/scol/calrtri.htm)和[http://www.endmemo.com/geometry/triangle.php](http://www.endmemo.com/geometry/triangle.php)） . 这让我产生了严重的疑问！

我在 trig 方面还不够成熟，无法确定哪个是准确的，但我可能更喜欢互联网计算器。

任何人都可以协助正确的公式来做到这一点，或者指向一个有用的 c# 直角三角形求解器类？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-15T23:50:22.683

从[文档](http://msdn.microsoft.com/en-us/library/system.math.sin.aspx)中， 的值`theta`必须以弧度为单位。看起来您正在使用的在线求解器正在以`theta`度数进行解释。

您可以将度数转换为弧度，如下所示：

```
theta = theta * Math.PI/180 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:57:30.110

您以度为单位指定角度，但该`Math.Sin`方法采用弧度。

您可以使用以下方法将度数转换为弧度`theta * 2 * PI / 360`：

```
oppositeSide = Math.Sin(theta * 2.0 * Math.PI / 360.0) * hypotenuse; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:56:35.333

顺便说一句，对于一个已知另一个角为 45 度的直角三角形，其余 2 条边的长度相等，您也可以使用此公式计算它们的长度；

```
(a*a) + (b*b) = (c*c) 
```

所以，在这种情况下；

```
(a*a) * (a*a) = (10*10)

(a*a) * (a*a) = 100

(a*a) = 100 / 2

a = sqrt(50) 
```

就像另一种方法可以帮助您验证这种独特情况下的结果，并证明 ~7.07 是正确答案。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-15T23:50:09.323

45 度的正弦是 0.707。你的计算不正确。

# python - python快照程序错误

> ID：16026475
> 
> 赞同：1
> 
> 时间：2013-04-15T23:46:28.603
> 
> 标签：python, message, screenshot

我运行这个程序来拍摄我的屏幕快照并保存它但收到一条错误消息

```
import os
import sys
import time
import Image
import ImageGrab

SaveDirectory=r'C:\Documents and Settings\User\My Documents\My Pictures'
ImageEditorPath=r'C:\WINDOWS\system32\mspaint.exe'
img=ImageGrab.grab()
saveas=os.path.join(SaveDirectory,'ScreenShot_'+time.strftime('%Y_%m_%d%_%H_%M_%S')+'.png')
img.save(saveas)
editorstring='""%s" "%s"'% (ImageEditorPath,saveas) 
os.system(editorstring) 
```

这是错误消息：

```
Traceback (most recent call last):
  File "C:/Python27/butt", line 10, in <module>
    saveas=os.path.join(SaveDirectory,'ScreenShot_'+time.strftime('%Y_%m_%d%_%H_%M_%S')+'.png')
ValueError: Invalid format string 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T23:50:29.040

您的问题是`%_`格式字符串中的`strftime`- 它不是有效值。用以下内容替换格式字符串，你应该没问题：

`'%Y_%m_%d_%H_%M_%S'`

您可以判断格式字符串有问题，因为引发的错误 ( `ValueError: Invalid format string`) 指的是格式字符串，而第 10 行中唯一的格式字符串就是这个。您可以查看[文档](http://docs.python.org/2/library/time.html)以查看哪些字符是有效实体。 `%_`不是其中之一，我猜这只是一个印刷错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:51:12.170

时间上缺少一些东西：

```
str_time = time.strftime(your_real_date,'%Y_%m_%d_%H_%M_%S')
saveas=os.path.join(SaveDirectory,'ScreenShot_'+ str_time +'.png') 
```

And each time, a little checking at Python Docs: [8.1.7\. strftime() and strptime() Behavior](http://docs.python.org/2/library/datetime.html) to ensure the use of any string/date convertion

# django - django forms: 绑定表单的默认值

> ID：16026479
> 
> 赞同：11
> 
> 时间：2013-04-15T23:47:24.047
> 
> 标签：django, forms

使用这种形式：

```
class Form(forms.Form):
    name = forms.CharField(required=False, initial='Hello world') 
```

如果我在视图中做这样的事情：

```
form = Form(request.GET)
if form.is_valid():
    name = form.cleaned_data['name'] 
```

即使 request.GET 不包含`name`作为键，名称的初始值也会丢失。有什么解决方法吗？我希望初始值能够将表单绑定为“默认值”。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-06-22T12:14:55.723

通过稍微修改 Gonzalo 的解决方案，这是正确的方法：

```
class Form(forms.Form):
    name = forms.CharField(required=False, initial='Hello world')

    def clean_name(self):
        if not self['name'].html_name in self.data:
            return self.fields['name'].initial
        return self.cleaned_data['name'] 
```

* * *

如果你需要这个，你可以看看 django-filter app。我最近才发现它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-16T00:39:26.337

`initial`并不是真的用来设置表单字段的*默认*值。相反，在向用户显示表单时，它实际上更像是一个占位符实用程序，如果不需要该字段（如您的示例中），它将无法正常工作。

您可以做的是[定义一个`clean_<fieldname>`](https://docs.djangoproject.com/en/1.5/ref/forms/validation/#cleaning-a-specific-field-attribute)方法来检查该字段是否有空值并返回默认值：

```
class Form(forms.Form):
    name = forms.CharField(required=False, initial='Hello world')

    def clean_name(self):
        name = self.cleaned_data['name']
        if name is None:
            return self.fields['name'].initial
        return name 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-01T07:21:58.777

我使用以下模式将默认值设置为表单给出的初始值 -

```
class InitialDefaultForm(forms.Form):
    def clean(self):
        cleaned_data = super(InitialDefaultForm, self).clean()
        # if data is not provided for some fields and those fields have an
        # initial value, then set the values to initial value
        for name in self.fields:
            if not self[name].html_name in self.data and self.fields[name].initial is not None:
                cleaned_data[name] = self.fields[name].initial
        return cleaned_data 
```

这可确保所有具有初始值且未从用户获取值的字段都由其初始值填充。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T11:38:06.553

这会起作用吗：

```
initial_form_data = {'name': 'Hello World'}   #put all the initial for fields in this dict
initial_form_data.update(request.GET)  #any field available in request.GET will override that field in initial_form_data
form = Form(initial_form_data)
if form.is_valid():
    name = form.cleaned_data['name'] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-16T06:55:58.803

`request.GET`是像字典一样的对象。

`initial`仅在未绑定形式的情况下有效。

表单有一个名为 的属性`data`。`data`此属性在表单初始化期间作为第一个位置参数或关键字参数提供。

绑定表单是您将一些数据作为表单的第一个参数提供的表单，而未绑定表单的`data`属性设置为无。

在这里，在 form 的初始化中`form=Form(request.GET)`，您提供了第一个位置参数，因此`data`在表单上设置了属性，它变成了绑定表单。即使`request.GET`是空字典也会发生这种情况。而且由于您的表单成为绑定表单，因此`initial`字段`name`对其没有影响。

因此，在您的 GET 请求中，您应该执行以下操作：

```
form = Form() 
```

你`initial`的`name`领域将受到尊重。

或者，如果您想`name`从 request.GET 中读取并且如果它在那里然后想要使用它而不是字段的初始值，那么在您的视图中具有以下内容。

```
name = request.GET.get(name)
form_level_initial = {}
if name:
    form_level_initial['name'] = name
form = Form(initial=form_level_initial) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-09-02T05:31:58.303

提议的解决方案要么对我不起作用，要么看起来不是很优雅。该文档指定 initial 不适用于绑定表单，这似乎是原始提问者（和我的）用例：

> 这就是为什么只为未绑定的表单显示**初始值的原因。**对于绑定表单，HTML 输出将使用绑定数据。
> 
> [https://docs.djangoproject.com/en/1.10/ref/forms/fields/#initial](https://docs.djangoproject.com/en/1.10/ref/forms/fields/#initial)

我的解决方案是查看表单是否应该绑定：

```
initial = {'status': [Listing.ACTIVE], 'min_price': 123}     # Create default options

if request.method == 'GET':
    # create a form instance and populate it with data from the request:
    if len(request.GET):
        form = ListingSearchForm(request.GET)       # bind the form
    else:
        form = ListingSearchForm(initial=initial)   # if GET is empty, use default form 
```

您还可以使用其他方式来初始化表单（如上所述）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-04-02T06:19:38.207

没有一个答案实际上完全符合 clime 的要求。所以这是我对同样问题的解决方案：

```
class LeadsFiltersForm(forms.Form):
    TYPE_CHOICES = Lead.TYPES
    SITE_CHOICES = [(site.id, site.name) for site in Site.objects.all()]

    type = forms.MultipleChoiceField(
        choices=TYPE_CHOICES, widget=forms.CheckboxSelectMultiple(),
        required=False
    )
    site = forms.MultipleChoiceField(
        widget=forms.CheckboxSelectMultiple(), required=False,
        choices=SITE_CHOICES
    )
    date_from = forms.DateField(input_formats=['%m-%d-%Y',], required=False,
                                widget=forms.TextInput(attrs={'placeholder': 'Date From'}),
                                initial=timezone.now() - datetime.timedelta(days=30))
    date_to = forms.DateField(input_formats=['%m-%d-%Y',], required=False,
                                widget=forms.TextInput(attrs={'placeholder': 'Date To'}))

    defaults = {
        'type': [val[0] for val in TYPE_CHOICES],
        'site': [val[0] for val in SITE_CHOICES],
        'date_from': (timezone.now() - datetime.timedelta(days=30)).strftime('%m-%d-%Y'),
        'date_to': timezone.now().strftime('%m-%d-%Y')
    }

    def __init__(self, data, *args, **kwargs):
        super(LeadsFiltersForm, self).__init__(data, *args, **kwargs)
        self.data = self.defaults.copy()
        for key, val in data.iteritems():
            if not data.get(key):
                continue
            field = self.fields.get(key)
            if field and getattr(field.widget, 'allow_multiple_selected', False):
                self.data[key] = data.getlist(key)
            else:
                self.data[key] = data.get(key) 
```

# mysql - MySql 有序关键字搜索

> ID：16026481
> 
> 赞同：0
> 
> 时间：2013-04-15T23:47:33.783
> 
> 标签：mysql, search, join

我目前有两张桌子：

搜索匹配：

```
match_id (int) <-- primary key
parent_id (int) <-- foreign-key
word_id (int) <-- foreign-key (to a table filled with words that are unique and have an id)
pos (int) <-- the position of the word in the block of text it comes from 
```

search_words：（更新）

```
word_id (int) <-- primary key
word (varchar ...) <-- the word 
```

（我用的是innodb，我的主机不会升级mysql，所以全文出）

我希望我的用户能够使用“搜索”。这样他们就可以搜索“foo bar”。

我已经想到了几种方法，但最不密集的似乎是添加另一列：

```
next_pos (int) 
```

然后我可以做

```
(SELECT * FROM table WHERE word_id='foo') as foo
INNER JOIN (SELECT * FROM table WHERE word_id='bar') AS bar 
ON (
  foo.parent_id=bar.parent_id AND
  foo.next_pos=bar.next_pos
) 
```

它的代价是为第一个单词之外的每个单词存储一个额外的列和一个内部连接，但它是迄今为止我想出的最佳选择。（之前的想法是减少一列，但需要在 ON 块内进行加法操作，我认为随着网站的增长，这可能太昂贵了。

这是我最好的选择，还是有其他选择？我仍然只是在舞台上玩，所以现在是时候做出改变了。

* * *

更新1：

我现在正在考虑使用关键字表来缩小搜索范围，然后使用 like 代替多个连接，因为这可能更快，并且大大消除了连接的需要。对我的整个数据库进行点赞是没有效率的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:31:55.847

我真的不明白你为什么要做所有这些手工工作。有一些工具可以简化它。从我读到的内容来看，您想要做的与全文搜索有关。您不需要自己构建索引。

您是否考虑过使用 SolR 之类的东西？只要您创建索引，它就适用于任何类型的数据库。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-15T23:57:58.673

我不知道您将如何使用当前设置进行搜索。如果如您所说，您有一个仅包含文本块中唯一单词的表，您希望如何将这个唯一单词列表与完整内容中的实际单词位置相关联？例如，假设原始内容如下所示：

```
some text with foo and also with foo bar 
```

你的独特词表会是这样吗？

```
word_id   word
--------------
1         some
2         text
3         with
4         foo
5         and
6         also
7         bar 
```

如果是这样，您将如何找到`foo`并`bar`作为相邻记录？

我假设您的数据库在某处也有完整的内容，那么为什么不直接使用搜索内容`LIKE`呢？

# selenium-webdriver - 减少 RemoteWebDriver 的日志记录

> ID：16026485
> 
> 赞同：2
> 
> 时间：2013-04-15T23:47:50.880
> 
> 标签：selenium-webdriver

RemoteWebDriver 将大量消息记录到控制台上，这些消息非常健谈，并且这些消息被写入已发布的 SmokeTest 日志文件。我想将日志记录级别降低到 SEVERE 或 ERROR 甚至关闭（如果关闭），以便轻松调试问题。有谁知道如何完成上述任务？提前感谢您提供建议。我尝试了以下 2 个选项，但它不起作用：

```
if(webdriver1 instanceof RemoteWebDriver) {
   ((RemoteWebDriver) webdriver1).setLogLevel(Level.OFF);
} 

((RemoteWebDriver) webdriver1).setLogLevel(Level.OFF); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T07:33:56.763

在声明 logger 变量后立即放置以下静态块：

```
static{
        System.setProperty("org.apache.commons.logging.Log", "org.apache.commons.logging.impl.SimpleLog");
        System.setProperty("org.apache.commons.logging.simplelog.log.org.apache.http", "info"); 
        } 
```

第一个属性告诉`RemoteWebDriver`API 使用哪个记录器。第二个属性将日志记录级别设置为 INFO，以便`RemoteWebDriver`API 仅报告 INFO 及更高级别。

我正在使用`RemoteWebDriver`Java，对我来说这是解决上述问题的唯一解决方案。

# javascript - 使用 Kendo Mobile 按钮而不是处理点击有什么好处？

> ID：16026490
> 
> 赞同：1
> 
> 时间：2013-04-15T23:48:28.780
> 
> 标签：javascript, jquery, jquery-events, kendo-mobile

我正在开发 Kendo Mobile 应用程序并想知道使用 Kendo Mobile 按钮而不是使用常规 jQuery 单击处理程序处理相同事件的优势是什么？

有些元素我不想像原生 Kendo 按钮那样设计，但仍想处理点击。`$("#button").kendoMobileButton();`此外，如果以编程方式添加按钮功能，您必须在处理点击之前进行额外的调用。

[该文档](http://docs.kendoui.com/api/mobile/button)没有提供关于为什么要使用 Kendo Mobile 按钮的太多信息，除了已经在视图中填充时的自动绑定和样式，这在我的大多数情况下都非常罕见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:27:04.137

Kendo 小部件经过高度触控优化。如果您创建一个绑定了 onclick 事件的 HTML 元素，并在触摸设备上与 Kendo 按钮一起使用（在设备上执行此操作。而不是在浏览器或模拟器上），您将看到不同之处。'Click' 是桌面事件，Tap 是移动事件... Kendo 按钮提供了跨平台兼容的解决方案，用于处理用户发起的触摸事件，当您将点击事件绑定到普通 html 元素时，这些事件将不可用。

如果您使用 Kendo 框架并希望 HTML 元素捕获点击，您可以捕获[Tap 事件](http://demos.kendoui.com/mobile/touch/index.html#/)。您可以在此处查看更多[文档](http://docs.kendoui.com/getting-started/mobile/touch)

# excel - 看似毫无意义的excel公式

> ID：16026491
> 
> 赞同：2
> 
> 时间：2013-04-15T23:48:46.650
> 
> 标签：excel, excel-2007, excel-formula, spreadsheet, reactive-programming

我正在调试一个庞大的电子表格，我在多个地方遇到了这个奇怪的小公式：

```
=IF(P6="", "", P6) 
```

无论如何，该单元格将等于 P6。任何关于为什么原作者从很久以前就没有离开的指示

```
=P6 
```

反而？

我已经确保幕后没有宏观魔术，投掷和捕捉事件等等。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-15T23:58:01.987

实际上（我必须尝试这样做才能确定），`=P6`并且`=IF(P6="", "", P6)`有不同的行为。如果`P6`为空，则`=P6`返回 0，而公式将返回一个空单元格。这看起来像是出于格式化目的，因为空单元格和 0 在聚合函数（如`SUM`. 就我个人而言，我发现数字的“会计格式”更清晰，其中零表示为离散的`-`.

# r - 应用一系列命令来拆分数据帧

> ID：16026493
> 
> 赞同：0
> 
> 时间：2013-04-15T23:48:50.960
> 
> 标签：r, split, lapply

我在弄清楚如何解决这个问题时遇到了一些困难。我有一个数据框，我将其拆分为不同的站点（link5）。一旦拆分，我基本上想对子集运行线性回归模型。这是我正在使用的代码，但它绝对不正确。此外，如果我可以将模型结果输出到一个新的数据框，这样每个站点都会有一行带有模型参数估计值，那就太好了——这只是一个愿望，而不是现在的必需品。感谢您的任何帮助！

```
 les_events <- split(les, les$link5)

 result <- lapply(les_events) {

   lm1 <-lm(cpe~K,data=les_events)
   coef <- coef(lm1)
   q.hat <- -coef(lm1)[2] 
   les_events$N0.hat <- coef(lm1[1]/q.hat)
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:03:25.370

你有很多问题。

*   您尚未将函数（`FUN`参数）传递给`lapply`
*   你的闭包（里面的位`{}`几乎是你想要的功能，但不是你想要的身体）

像下面这样的东西会从你的模型中返回系数

```
 result <- lapply(les_events, function(DD){
   lm1 <-lm(cpe~K,data=DD)
   coef <- coef(lm1)

   data.frame(as.list(coef))
  }) 
```

这将返回一个 data.frames 列表，其中包含每个系数的列。

```
lapply(les_events, lm, formula = 'cpe~K') 
```

将返回一个线性模型对象列表，这可能更有用。

对于更通用的`split / apply / combine`方法，请使用`plyr`或`data.table`

## 数据表

```
library(data.table)
DT <- data.table(les)

result <- les[, {lm1 <- lm(cpe ~ K, data = .SD)
                 as.list(lm1)}, by = link5] 
```

## plyr

```
library(plyr)

result <- ddply(les, .(link5), function(DD){
   lm1 <-lm(cpe~K,data=DD)
   coef <- coef(lm1)

   data.frame(as.list(coef))
  })

# or to return a list of linear model objects
dlply(les, link5, function(DD){ lm(cpe ~K, data =DD)}) 
```

# c++ - 我的代码片段有什么问题？

> ID：16026503
> 
> 赞同：-1
> 
> 时间：2013-04-15T23:49:40.697
> 
> 标签：c++, code-snippets

```
 int myArray[8];
         for (int i = 0; i <= 8; i++)
            myArray [i] = 0; 
```

我很确定这是一个越界错误。i <= 8 应该是 i < 8。

如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T23:50:47.810

您正在分配 8 个块，0-7，并且您正在尝试引用 myArray[8]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T23:50:25.107

```
for (int i = 0; i <= 8; i++)
                ///^^^ 
```

索引越界，数组索引从 0 开始

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T23:52:28.433

int myArray[8] 表示您有 8 个变量：

我的数组[0]

我的数组[1]

我的数组[2]

我的数组[3]

我的数组[4]

我的数组[5]

我的数组[6]

我的数组[7]

# php - 函数名称的 PHP 变量数组

> ID：16026507
> 
> 赞同：0
> 
> 时间：2013-04-15T23:49:59.257
> 
> 标签：php, wordpress, function, variables, foreach

我正在尝试在 WordPress 主题中实现一些挂钩，但不是用重复的代码写出每个函数，我想知道是否可以使用数组来声明函数。

例如，通常我会使用类似的东西：

```
function hook_name_1() {
    do_action( 'hook_name_1' );
}

function hook_name_2() {
    do_action( 'hook_name_2' );
} 
```

有没有办法将钩子/函数名称放入一个数组中，然后用一个 foreach 循环或类似的东西调用它们？类似于以下内容：

```
$hook_array = array(
home_name_1,
hook_name_2
);

foreach ($hook_array as $hook) {
    function $hook() {
        do_action( $GLOBALS['hook'] );
}
} 
```

函数中的 do_action do_action 部分可以像这样正常工作，但是我无法弄清楚的是变量函数名称。

是否可以设置这样的数组，然后从数组值创建函数名称？

# html - 如何确保 Vimeo 嵌入式视频可以在所有浏览器中播放？

> ID：16026509
> 
> 赞同：0
> 
> 时间：2013-04-15T23:50:12.297
> 
> 标签：html, vimeo, video-embedding

Vimeo 视频是 Flash，有没有办法根据浏览器/设备以不同方式呈现视频？

这是 Vimeo 给我的嵌入代码：

```
<div class="video-holder">&nbsp;<iframe src="http://player.vimeo.com/video/#####"     
width="561" height="316" frameborder="0" webkitAllowFullScreen mozallowfullscreen 
allowFullScreen></iframe></p> 
```

我需要使用什么 HTML/CSS 来确保在多个浏览器中的可呈现性？还是从源代码转换更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:01:31.110

您正在嵌入 iframe 中。因此，如果 Vimeo 支持您定位的设备，它将为这些设备显示适当的内容。Vimeo 支持 iOS 和 Android 设备，可能还有其他设备。我认为默认情况下，如果不支持 Flash，则默认为其 H264 播放器，这意味着您是安全的。

顺便说一句，请注意您尚未关闭`div`.

# sqlite - SQLite3 中的日期，有一个扭曲（不准确的日期）

> ID：16026517
> 
> 赞同：2
> 
> 时间：2013-04-15T23:50:49.480
> 
> 标签：sqlite, database-schema

我正在研究以 SQLite3 格式存储其数据的系谱软件。一切正常，除了一个小细节。并非在所有情况下，出生日期或死亡日期（等）的准确性都可用于*确切的*日期。所以我有以下准确性：

*   准确 (YYYY-MM-DD)
*   月 (YYYY-MM)
*   年份 (YYYY)
*   年 (YYYY+/-5)
*   年 (YYYY+/-10)
*   年 (YYYY+/-50)
*   十年
*   世纪

现在，假设我将所有内容存储在一个列中，我最终会遇到问题。由于 SQLite3 具有[Julian Day 函数](http://www.sqlite.org/lang_datefunc.html)，我想在`REAL`Julian Day 的小数部分编码准确性（无论如何我不需要小时数）。这很好，但它使`SELECT`工作方式复杂化，实际上这意味着我可以卸载到 SQLite3 的东西必须在应用程序代码中实现。

**存储不准确日期并**能够快速查询它们的合理方法是什么？

注意：如果对任何回答的人都很重要，那么使用的语言是 Python，但我一般都在问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T07:35:29.190

在对这些日期值进行查询时，最常见的操作可能是检查一个日期是否可能与另一个日期匹配。为此，您始终需要间隔的开始和结束，因此将这两个值存储在数据库中是有意义的。（打电话给他们`Start`/`End`或`Min`/`Max`或`Earliest`/`Latest`或任何有意义的东西。）

例如，要查找可能出生于一个世纪前的人：

```
... WHERE '1913-04-16' BETWEEN BirthDateMin AND BirthDateMax 
```

可以使用区间边界之一进行不等式比较。例如，要查找可能出生于一个多世纪前的人：

```
... WHERE BirthDateMin < '1913-04-16' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:56:28.720

仅仅因为您正在存储日期信息，并不意味着内置日期类型适合您。您的数据要求（日期不准确）意味着执行一些自定义日期处理工作并避免使用内置日期数据类型可能更准确、更长期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T03:00:24.973

使用两列。一列是大致日期，尽可能准确，采用 SQLite 格式。第二列是以天为单位的日期的准确性。如果日期绝对准确，则第二列为零。如果只知道月份，则日期为月中，第二列为 15 天。等等。可以通过与日期 +/- 精度列进行比较来进行日期比较。

# ios - 编辑和滚动时 UITableViewCell 内容不正确

> ID：16026521
> 
> 赞同：1
> 
> 时间：2013-04-15T23:51:10.730
> 
> 标签：ios, objective-c, xcode, uitableview

不处于编辑模式时，我的 tableview 工作得很好。所有单元格都按预期显示，但如果我进入编辑模式并滚动，在编辑模式下重绘的单元格的内容不正确。在我关闭编辑的函数中，我重新加载表数据，它再次正确显示。

这里是相关代码。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:    (NSIndexPath *)indexPath
{    
static NSString *CellIdentifier = @"Cell";
UITableViewCell *cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:nil];

cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

FieldItemDecrypted *theField = [decryptedArray objectAtIndex:indexPath.row];

    // Configure the cell...

      cell.textLabel.text = [[NSString alloc] initWithData:theField.field encoding:NSUTF8StringEncoding];
      cell.detailTextLabel.text = [[NSString alloc] initWithData:theField.type encoding:NSUTF8StringEncoding];    

return cell;
} 
```

还有我的编辑代码：

```
- (IBAction)editRows:(id)sender
{

if ([self.tableView isEditing])
{
    [self.tableView setEditing:NO animated:YES];
    [self.tableView reloadData];
}
else
{
    [self.tableView setEditing:YES animated:YES];
}

} 
```

应该是这样的：

![在此处输入图像描述](https://i.stack.imgur.com/caGST.png)

但在编辑时滚动后看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/t0QCF.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:18:29.077

您`UITableViewCell`首先初始化一个对象，然后从表视图中出列？这是不正确的。

尝试：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

if(cell == nil)
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
} 
```

我刚刚在一个演示项目上试过这个，它的行为符合预期。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T05:15:11.077

我更熟悉这种类型的单元重用：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:    (NSIndexPath *)indexPath
{    
  static NSString *CellIdentifier = @"Cell";   
  UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

  if (!cell) {
      cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle 
                                      reuseIdentifier:nil];
  }
  FieldItemDecrypted *theField = [decryptedArray objectAtIndex:indexPath.row];
  // Configure the cell...

  cell.textLabel.text = [[NSString alloc] initWithData:theField.field encoding:NSUTF8StringEncoding];
  cell.detailTextLabel.text = [[NSString alloc] initWithData:theField.type encoding:NSUTF8StringEncoding];    

  return cell;
} 
```

# django - Django 查询集排除值

> ID：16026524
> 
> 赞同：4
> 
> 时间：2013-04-15T23:51:48.047
> 
> 标签：django, django-admin, django-queryset

模型.py

```
class ChatMessage(models.Model):
    ip=models.IPAddressField()
    message=models.CharField(max_length=200)

class BlockIp(models.Model):
    ip=models.IPAddressField() 
```

管理员.py

```
class ChatMessageAdmin(admin.ModelAdmin):
    def queryset(self, request):
        qs = super(ChatMessageAdmin, self).queryset(request)
        #block=BlockIp.objects.all()
        return qs.exclude(ip='1.1.1.1') 
```

我已经重写了 ChatMessage 类的查询集方法。我试图返回类似的东西：

```
SELECT * FROM chatmessage as v1 JOIN blockip as v2 on v1.ip!=v2.ip 
```

因此用户只能看到具有不在 blockip 条目中的 ip 的消息

`return qs.exclude(ip=BlockIp.objects.all().ip)`语法不正确:(

有什么建议吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-15T23:55:31.043

Django 提供了一些可以在过滤值时使用的运算符。特别是，您需要[`__in`](https://docs.djangoproject.com/en/1.4/ref/models/querysets/#in)操作员。你可以这样做：

```
blocked = BlockIp.objects.all().values_list('ip', flat=True)
messages = ChatMessage.objects.exclude(ip__in=blocked) 
```

`values_list`将给定的值（在这种情况下，只是`ip`字段）作为列表返回。

# excel - How to convert the actual excel formula (not the result) to a text string

> ID：16026525
> 
> 赞同：5
> 
> 时间：2013-04-15T23:51:48.633
> 
> 标签：excel, vba

I have been searching all over for a solution and I couldn't find one.

Let's say I type into cell A1: =if(A2>1,1,0)

Excel will interpret that and either return 1 or 0.

However, what I would like to do is literally convert that formula into the string: '=if(A2>1,1,0)'

If you press Ctrl+~ into Excel, you will see all the formulas. Basically what I want to do, in conclusion, is take all those formulas and make them strings.

(The purpose, if you care, is to compare these strings with another workbook to make sure I didn't delete anything)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-16T00:35:57.580

You can make a user defined function for this.

Put this code into a `Module` (not a worksheet code sheet, class, or form)

```
Function GetFormula(rng As range, Optional asR1C1 As Boolean = False) As String
    If asR1C1 Then
        getFormula = rng.FormulaR1C1
    Else
        getFormula = rng.Formula
    End If
End Function 
```

and call it in your worksheet like so

```
=GetFormula(A1) 
```

or if you want the results as `R1C1`

```
=GetFormula(A1,TRUE) 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2015-02-26T16:07:39.253

Use the FORMULATEXT function. It's built into Excel.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-15T23:55:34.990

> what I would like to do is literally convert that formula into the string: '=if(A2>1,1,0)'

Simply use the Formula Property of the cell, here is a code example:

```
Range("A1").Select
Dim strFormula As String
strFormula  = ActiveCell.Formula
MsgBox (strFormula) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-03-17T21:29:16.787

You can also replace the equal sign with blank using find and replace. In effect removing the equal sign and leaving only the text of the formula as a string.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-27T04:14:03.117

Just follow this way.

1.  Select the range (contain formula) you want to convert to text, also you can select All range on your sheet.

2.  Use Find and Replace command by pressing Control-F then replace "=" with "^" press replace All.. All done....

3.  If you want to use it again as formula... Just use Find and Replace, then replace "^" with "=" just look....All formula in text format converted to formula...

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-11-13T16:04:34.737

Just right-click on the column header (i.e. A) and select "Format Cells" then under the "Number" tab select "Text". Then at each cell press enter and the formula will be displayed instead of the result.

# javascript - 在 javascript 中：为新创建的脚本元素更改“src”不起作用..？

> ID：16026535
> 
> 赞同：0
> 
> 时间：2013-04-15T23:52:59.967
> 
> 标签：javascript, src

我对 javascript*很*陌生，但我已经设法将不同的代码片段和论坛帖子中的以下内容拼接在一起：

```
var s = document.createElement("script");
s.src = "http://service.somewebsite.com/?api-key=4P1k3y5R4w50m3";
document.getElementsByTagName("body")[0].appendChild(s); 
```

但是 - 它不起作用。

源属性显然不是真实的（服务要求我不要共享 API 密钥），但是将实际的属性粘贴到浏览器中，我得到了我想要的精确脚本 - 带有正确的回调和一切。

我觉得奇怪的是这段代码不起作用，因为非常相似

```
var i = document.createElement("img");
i.src = "http://i.imgur.com/TsCGbsy.jpg";
document.getElementsByTagName("body")[0].appendChild(i); 
```

...执行得很好，当它取代它时。关于更改脚本元素的来源，有什么我不知道的，还是我忽略了其他什么？

附带说明：我希望最终让“s.src”依赖于一些变量，如方法、api-key 等（这就是我这样定义它的原因）。如果有人对此有其他优雅的解决方案，我也将不胜感激。任何关于语法等的提示也非常受欢迎。

提前感谢您对此提供的任何帮助！

编辑：我可能应该提到我正在尝试从包含在回调函数中的 JSON 对象组成的源中执行代码。链接本身工作正常，使用时功能正常执行

```
<script src = "http://service.somewebsite.com/?api-key=
k3y&callback=myFunction">
</script> 
```

我基本上是在尝试做同样的事情，只是将 (src) 从一个字符串和一个或多个变量拼接在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:19:53.027

Try using setAttribute:

```
var s = document.createElement('script');
s.setAttribute("type","text/javascript");
s.setAttribute("src", "http://service.somewebsite.com/?api-key=4P1k3y5R4w50m3"); 
```

# c# - 将网格内容转换为 ListView 或其他以在 MVVM 模式中使用

> ID：16026539
> 
> 赞同：0
> 
> 时间：2013-04-15T23:54:08.563
> 
> 标签：c#, listview, grid, dataset, datatable.select

我有一个 5 X 4 网格（下面的代码），它可以根据我的数据形状工作。我最近发现几乎不可能将网格从视图模型传递到视图并将其绑定到 XAML 中的另一个网格并仍然保持 MVVM 模式——这是我的目标。

这里的挑战是我的演示文稿要求将孩子分组在单个单元格中，每个单元格具有 1 个图像和两个文本块 UI 元素。

DataTable、DataSet、GridView、List 等似乎都缺乏将多个子元素添加到单个行/列单元格以进行显示的能力。不幸的是，这不仅仅是在列标题中粘贴图像。

有没有人找到做类似的另一种选择？

谢谢，

格伦

下面是示例网格和结果视图的图像。

```
public void FormatGridCell()
{
   Random random = new Random();
   List<int> randomNumList = new List<int>();
   for (int i = 0; i < 50; i++)
      randomNumList.Add(random.Next(50));

   List<string> columHeader = new List<string>();
   columHeader.Add("Pitts");
   columHeader.Add("Vans");
   columHeader.Add("Lancair");
   columHeader.Add("Epic");

   List<string> rowHeader = new List<string>();
   rowHeader.Add("NORTH");
   rowHeader.Add("SOUTH");
   rowHeader.Add("EAST");
   rowHeader.Add("WEST");
   rowHeader.Add("CANADA");

   for (int x = 1; x < 5; x++)
   {
      var engineType= new TextBlock { Text = columHeader[x - 1] };
      engineType.SetValue(Grid.RowProperty, 0);
      engineType.SetValue(Grid.ColumnProperty, x);
      engineType.HorizontalAlignment = HorizontalAlignment.Center;
      this.airplaneGrid.Children.Add(engineType);

      for (int r = 1; r < 6; r++)
      {
         var dealerService = new TextBlock { Text = rowHeader[r - 1] };
         dealerService.SetValue(Grid.RowProperty, r);
         dealerService.SetValue(Grid.ColumnProperty, 0);
         dealerService.HorizontalAlignment = HorizontalAlignment.Center;
         this.airplaneGrid.Children.Add(dealerService);

         for (int i = 1; i < 6; i++)
         {
            // Bitmap path will be based on Type
            var modelImage = new Image { Width = 20, Height = 20 };
            var bitmapImage = new BitmapImage(new Uri(@"c:\personal\temp\dog.jpg"));
            modelImage.Source = bitmapImage;
            modelImage.SetValue(Grid.RowProperty, r);
            modelImage.SetValue(Grid.ColumnProperty, i);
            modelImage.HorizontalAlignment = HorizontalAlignment.Left;
            modelImage.VerticalAlignment = VerticalAlignment.Top;

            var mfgName = new TextBlock { Text = "Lancair IV" };
            mfgName.SetValue(Grid.RowProperty, r);
            mfgName.SetValue(Grid.ColumnProperty, i);
            mfgName.HorizontalAlignment = HorizontalAlignment.Center;

            var price = new TextBlock { Text = "$" + randomNumList[r + i] };
            price.SetValue(Grid.RowProperty, r);
            price.SetValue(Grid.ColumnProperty, i);
            price.HorizontalAlignment = HorizontalAlignment.Left;
            price.VerticalAlignment = VerticalAlignment.Center;
            price.Margin = new Thickness(30, 0, 0, 0);

            this.airplaneGrid.Children.Add(modelImage);
            this.airplaneGrid.Children.Add(mfgName);
            this.airplaneGrid.Children.Add(price);
          }
       }
    }
 } 
```

这个功能不是我的。对不起，忘记了命名的信用，但是提供给这个论坛的一个 stackoverflow 小伙子。

```
 public static class RandomExtensions
 {
    public static int NextDouble(
                    Random random,
                    double minValue,
                    double maxValue)
    {
       return random.Next(10, 50);
    }
 } 
```

抱歉，我的图腾柱太低了，无法提交图像，但运行它以全面了解预期的布局。

这是支持上述内容的 XAML。

```
 <Grid x:Name="airplaneGrid" ShowGridLines="True">
        <Grid.RowDefinitions>
            <RowDefinition Height="60" />
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
            <RowDefinition Height="60"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="175"/>
            <ColumnDefinition Width="175"/>
            <ColumnDefinition Width="175"/>
            <ColumnDefinition Width="175"/>
            <ColumnDefinition Width="175"/>
        </Grid.ColumnDefinitions>
    </Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T02:24:53.847

好的。我将您的解决方案和我的解决方案并排放置。它看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/ogIJe.png)

诚然，它需要更多的调整，但你明白了主要思想。

```
 <ListView ItemsSource="{Binding}" Grid.Column="1">
            <ListView.Resources>
                <DataTemplate x:Key="CellContentTemplate">
                    <Border BorderBrush="LightGray" BorderThickness="1">
                        <DockPanel>
                            <Image Height="20" Width="20" Source="{Binding ImageSource}" Margin="2"
                               DockPanel.Dock="Left"/>
                            <StackPanel>
                                <TextBlock Text="{Binding Value, StringFormat='${0}'}" Margin="2"/>
                                <TextBlock Text="{Binding Name}" Margin="2"/>
                            </StackPanel>
                        </DockPanel>
                    </Border>

                </DataTemplate>
            </ListView.Resources>
            <ListView.View>
                <GridView>
                    <GridViewColumn Header=""  DisplayMemberBinding="{Binding Name}"/>
                    <GridViewColumn Header="Pitts">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ContentPresenter Content="{Binding Pitts}" ContentTemplate="{StaticResource CellContentTemplate}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Vans">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ContentPresenter Content="{Binding Vans}" ContentTemplate="{StaticResource CellContentTemplate}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Lancair">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ContentPresenter Content="{Binding Lancair}" ContentTemplate="{StaticResource CellContentTemplate}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Epic">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ContentPresenter Content="{Binding Epic}" ContentTemplate="{StaticResource CellContentTemplate}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView> 
```

后面的代码（只是随机数据）：

```
 Random random = new Random();

        public GridSample() //Window Constructor
        {
            InitializeComponent();

            var names = new[] {"NORTH","SOUTH","EAST","WEST"};

            DataContext = names.Select(x => new GridViewModel()
                                                {
                                                    Name = x,
                                                    Epic = CreateRandomCell(),
                                                    Lancair = CreateRandomCell(),
                                                    Pitts = CreateRandomCell(),
                                                    Vans = CreateRandomCell()
                                                });
        }

        private CellViewModel CreateRandomCell()
        {
            return new CellViewModel
                       {
                           Name = "Cell" + random.Next(0, 100),
                           ImageSource = "/ChessPieces/BlackBishop.png",
                           Value = (decimal) random.Next(0, 100)
                       };
        } 
```

视图模型：

```
 public class GridViewModel
    {
        public string Name { get; set; }

        public CellViewModel Pitts { get; set; }

        public CellViewModel Vans { get; set; }

        public CellViewModel Lancair { get; set; }

        public CellViewModel Epic { get; set; }
    }

    public class CellViewModel
    {
        public string Name { get; set; }

        public string ImageSource { get; set; }

        public decimal Value { get; set; }
    } 
```

看？纯 MVVM，干净，漂亮的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T23:55:51.493

您可以使用另一个 Grid（或 stackpanel，或任何类型的面板）作为每个单元格中的子元素，然后将子元素添加到该面板

# json - 通过 db2 函数来自 db2 触发器的整个表行的 json 字符串

> ID：16026544
> 
> 赞同：0
> 
> 时间：2013-04-15T23:54:40.367
> 
> 标签：json, function, triggers, db2

我有这种形式的触发器：

```
创建触发器 TBP701_UPDATE
TBP701 更新后
将旧引用为 OLD_ROW
新作为 NEW_ROW
每一行
模式 DB2SQL
插入 TBP702（ID、IRN、事件、旧值、新值、用户、进入时间）
值（默认值，NEW_ROW。COLUMN1，'BUYBACK_ADD'，
'{"column1":"' CONCAT OLD_ROW . COLUMN1 CONCAT '","column2":"' CONCAT OLD_ROW . COLUMN2 CONCAT '","column3":"' CONCAT OLD_ROW . COLUMN3 CONCAT '"}' ,
'{"column1":"' CONCAT NEW_ROW . COLUMN1 CONCAT '","column2":"' CONCAT NEW_ROW . COLUMN2 CONCAT '","column3":"' CONCAT NEW_ROW . COLUMN3 CONCAT '"}' ,
用户，CURRENT_TIMESTAMP）；
```

我需要将 tbp701 中的旧值和新值以 json 格式插入到新表中。在上面的查询中，我对 JSON 字符串进行了硬编码；但我需要在 100 多个表上编写这样的触发器。所以我需要一个可以接受以下两个参数的sql函数

1.  来自触发器的 NEW_ROW/OLD_ROW 引用和
2.  表名

它应该返回 json 字符串，其中包含触发触发器的特定表和行的所有列。然后我可以为我的所有触发器重用该函数。

我是 db2 概念中这些高级特性的新手。所以一个描述性的答案将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:35:36.833

采用这种设计将是一个可怕的错误。

创建完整的第二个模式来保存 JSON 格式的关系数据将是一场巨大的噩梦。确保一致性（即通过这些触发器）会增加大量开销。

为什么不让您的应用程序层解析关系数据并将其放入 JSON 格式？

或者，您也可以考虑以 XML 格式存储数据（并利用 DB2 中的 pureXML 特性）。有一篇关于此主题的[developerWorks 文章。](http://www.ibm.com/developerworks/xml/library/x-db2JSONpt1/)

# android - Android：使用AlarmManager重复调用有时持续时间超过重复间隔的服务

> ID：16026545
> 
> 赞同：0
> 
> 时间：2013-04-15T23:54:50.833
> 
> 标签：android, service, alarmmanager

我想每 15 分钟启动一次服务。大多数情况下它会在大约 30 秒内退出，但有时服务会持续超过 15 分钟。如果之前的服务调用仍在运行，我认为警报管理器启动服务并不好。我正在考虑在 onStartCommand 中设置一个标志，让它在服务正在运行时简单地返回而不做任何事情。但我不确定这是否是处理它的最佳方式，因为 onStartCommand 返回一个 int 并且我不知道系统需要这个值。有没有最好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:09:15.930

> 但是我从 CommonsWare 那里听到：“不，它不会创建新服务。如果服务已经在运行，它将再次使用 onStartCommand() 调用它，以传递新的 Intent，但不会创建第二个副本。”

是的，那个 CommonsWare 家伙，他确实写了很多... :-)

> 如果之前的服务调用仍在运行，我认为警报管理器启动服务并不好。

如果您正在使用`IntentService`，这将不是问题。您的第二个警报的命令将被排队，等待`onHandleIntent()`从第一个警报结束。

如果您不使用`IntentService`，则需要聪明`onStartCommand()`地确定您自己的线程仍在运行，因此您想跳过该命令。

> 但我不确定这是否是处理它的最佳方式，因为 onStartCommand 返回一个 int 并且我不知道系统需要这个值。

这与你的问题没有任何关系。只需 return `super.onStartCommand()`，或者您当前`onStartCommand()`返回的任何方法。

> 但是，如果我不希望该服务在下一次应该被调用之前重新启动怎么办？

好吧，您可以将重复的警报替换为一次性警报（使用`set()`），然后设置下一个警报，作为结束前一个警报的工作的一部分。

# sql - SSRS 报告中包含相乘行的结果集

> ID：16026546
> 
> 赞同：2
> 
> 时间：2013-04-15T23:54:53.237
> 
> 标签：sql, tsql, reporting-services, ssrs-2008

我需要将此查询放入 SSRS 报告中。

```
SELECT  s.SR_Service_RecID    -- will have 1 result
     ,  p.Description         -- will have 8 results 
     ,  t.notes               -- will have 5 results

FROM SR_Service s
     LEFT JOIN IV_Product p
            ON p.SR_Service_RecID = s.SR_Service_RecID
     LEFT JOIN Time_Entry t
            ON t.SR_Service_RecID = s.SR_Service_RecID 
```

此查询将 p.Description 乘以 t.Notes 以获得预期的总行数。

结果集：

```
SR_RecID    Description    Notes
12345       Product 1      Note 1
12345       Product 1      Note 2
12345       Product 1      Note 3
12345       Product 1      Note 4
12345       Product 1      Note 5
12345       Product 2      Note 1
12345       Product 2      Note 2
12345       Product 2      Note 3
12345       Product 2      Note 4
12345       Product 2      Note 5
Etc.. 
```

如何将其放入 SSRS 报告中，使其仅显示实际结果，而不是相乘的金额？

```
SR_RecID
12345

Description
Product 1
Product 2
Product 3
Product 4
Product 5
Product 6
Product 7
Product 8

Notes 1
Notes 2
Notes 3
Notes 4
Notes 5 
```

我是否需要重新处理查询，或者这可以在 SSRS 结束时完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T10:05:10.297

是的，您可以通过添加 tablix 来实现：

![图像1](https://i.stack.imgur.com/BDL2J.png)

并使用 3 个相邻组（按每个字段分组），如下所示：

![图2](https://i.stack.imgur.com/Oy4cq.png)

你会得到这样的结果：

![图3](https://i.stack.imgur.com/RaMFE.png)

# weblogic-10.x - 生成的 web.xml 中缺少过滤器名称元素

> ID：16026548
> 
> 赞同：0
> 
> 时间：2013-04-15T23:55:03.770
> 
> 标签：weblogic-10.x, struts-1, java-6, ejb-2.x

我们的一个旧应用程序使用`Struts-1.2`和`EJB-2`生成`xdoclet 1.2.3`。`Maven 1`用于使用`java 1.4`. 该应用程序一直在运行，`weblogic 8.1`没有任何问题。

现在我们正在升级到`Weblogic 10.3.6`哪个运行在`java 6`. 当应用程序部署到`Weblogic 10.3.6`我们遇到以下错误。

```
The error is weblogic.descriptor.DescriptorException: VALIDATION PROBLEMS WERE FOUND problem: 
cvc-minLength-valid.1.1: string length (0) is less than minLength facet (1) for filter-nameType 
in namespace http://java.sun.com/xml/ns/javaee:<null> 
```

我了解此错误是因为`web.xml`文件缺少`filter-name`过滤器类的元素。

问题是`web.xml`作为构建过程的一部分由应用程序生成的，我不知道在哪里或如何添加`filter-name`元素值。我应该怎么做才能将`filter-name`元素添加到生成的元素中`web.xml`？

（注意：部署到 时没有问题`Weblogic8.1`。仅在尝试部署时才会发生这种情况`weblogic10.3.6`。）

任何帮助都感激不尽。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:08:39.040

搞定了

我必须在过滤器类中添加以下注释......

```
@web.filter name="FilterClassName" 
```

`web.xml`添加上述注释后生成过滤器名称元素。

# php - 这个功能有什么问题？

> ID：16026554
> 
> 赞同：0
> 
> 时间：2013-04-15T23:55:37.073
> 
> 标签：php, mysql, sql, function, return

我创建了一个函数来调用论坛中某个类别的帖子数量。这是该函数的代码：

```
function num_posts_evedisc() {
    $sql3 = "SELECT COUNT(category) FROM forum_question WHERE category=3";
    $query3 = mysql_query($sql3);
    return($query3);
} 
```

这是我得到的回应，回应它：

```
Resource id #14 
```

（在我的数据库中，我有表 forum_question 和列类别。我尝试将 (category) 替换为 (id) ，但这也不起作用。）

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:00:01.450

`mysql_query`返回一个[*资源*](http://www.php.net/manual/en/language.types.resource.php)，这反过来使您可以访问结果。要访问结果，您必须使用某些东西从资源中获取信息，例如：

```
if ($row = mysql_fetch_row($query3)) {
    return $row[0];
} 
```

（您也可以使用其他功能，例如[`mysql_fetch_array`](http://www.php.net/manual/en/function.mysql-fetch-array.php)或[`mysql_result`](http://www.php.net/manual/en/function.mysql-result.php)。）

但请注意，这些`mysql_*`函数已被弃用，并将在 PHP 的未来版本中删除。查看[Mysql 改进扩展](http://www.php.net/manual/en/book.mysqli.php)或[PDO_MYSQL](http://www.php.net/manual/en/ref.pdo-mysql.php)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T23:57:51.860

```
return mysql_result($query3, 0) 
```

是你需要返回的

# c# - 使用 Nancy Async Beta 进行长轮询

> ID：16026564
> 
> 赞同：6
> 
> 时间：2013-04-15T23:56:36.693
> 
> 标签：c#, async-await, long-polling, nancy

通常我会使用 SignalR 来处理任何数据推送，但在这种情况下，我在服务器端使用 Nancy Async Beta 的自托管实例。我听说在这种情况下仍然可以使用 SignalR，但在这种情况下我仍然更愿意自己处理长轮询。这是我正在编写的一个简单实验应用程序的代码，它会产生如下所述的问题：

```
 Get["/receivechat", true] = async (x, ct) =>
            {
                string result = await _massPublisher.WaitForResult("test");
                return result;
            }; 
```

这处理实际的长轮询请求。请求似乎以 4 或 5 个块的形式输入此 lambda。例如，如果我在 lambda 的第一行放置一个断点，我不会看到断点被击中，直到我再发送 4 或 5 个请求然后突然所有请求一次全部进入 lambda。显然，我需要他们按照要求全部输入，以便他们都可以等待我的 WaitForResult 方法。WaitForResult 方法只是等待一个普通的TaskCompletionSource。如有必要，我可以发布该代码和客户端代码。据我所知，这似乎是我如何使用 Nancy Async Beta 的问题，因为请求是并行处理的，并且在发出其他一些请求之前，请求甚至不会进入 lambda。

值得注意的是，此应用程序在此期间仍响应所有其他请求。

我已经阅读了我可以在 Nancy Async Beta 上找到的[文档](https://github.com/NancyFx/Nancy/wiki/Async-Beta)，看起来这个示例应该可以工作......但它不是 - 无论如何对我来说。如果有人可以就为什么这不起作用提供一些见解，将不胜感激。就像我说的那样，我可以从这个实验中发布更多代码，但现在看来它只会让问题变得混乱。

**更新：** 由于我对 TPL 和 Nancy 比较陌生，因此我已将我的代码从实验中取出，以便隔离问题并进行更多故障排除。这是我更新的代码。它只是等待 5 秒的任务延迟，然后将当前时间发送给客户端。

```
 Get["/receivechat", true] = async (x, ct) =>
            {
                //string result = await _massPublisher.WaitForResult("test");
                //return result;
                await Task.Delay(5000);
                return DateTime.Now.ToString();
            }; 
```

我的理解是每个请求都将并行处理并且彼此独立。现在有了这种理解，我认为每个客户端应该每 5 秒看到一次回复，无论有多少其他客户端正在轮询这些请求。但是，结果如下：

## ![异步插图](https://i.stack.imgur.com/97tw3.png)

换句话说，每 5 秒发送一次响应，但一次只发送给一个客户端。因此，对于 3 个客户端，每个客户端需要 15 秒才能收到其响应。对于 2 = 10 秒等...

到目前为止，我看不出我做错了什么。这就是我在这里的原因。我喜欢发现我错了！:) 我会学到一些新东西。因此，如果您知道或可能知道我哪里出错了，请告诉我。我可能错过了一些我在多次寻找时忽略的小而愚蠢的东西，希望这是一个其他人会发现有用的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T15:38:25.820

在 Steven Robbins 非常感谢的帮助下找出了问题所在。这是浏览器一次不发送多个待处理请求，但我之前已经在所有浏览器（包括我用来测试的 Chrome）上看到了这项工作。浏览器将与服务器建立多个并发连接，但这些请求必须是唯一的（显然）。如果 Chrome 看到与即将发送的请求完全匹配的待处理请求，它将等待待处理请求完成，从而导致问题中所示的确切输出，因为其他客户端是同一浏览器的更多窗口（请参见问题中的图像和说明）。

因此，通过将 JS 的注释行（下面）更改为上面的行（主要是为了解决缓存问题），它也解决了长轮询问题，突然我在问题中的两个示例都很好用。

```
 $.get("/receivechat?_=" + new Date().getTime(), null, function (data)
            //$.get("/receivechat", null, function (data)
            {
                self.viewModel.chatLines.push(data);
                self.update();
            }).error(function ()
            {
                setTimeout(self.update, 2000);
            }); 
```

# php - php计数并获取foreach循环中的最后一条记录

> ID：16026572
> 
> 赞同：0
> 
> 时间：2013-04-15T23:57:36.550
> 
> 标签：php, foreach, count, cakephp-1.3

我试图能够计算给定日期（今天）特定场地的总事件。使用 24 小时时间，我尝试在 foreach 循环中查找当天的最后一个事件，然后当当天最后一个事件的 end_time 小于现在时，显示文本“今天所有预定的事件都已结束”。

我的问题是 xml 数据包括 14 天内所有房间中的所有事件，我没有得到正确的计数。我在 foreach 中有一些 if 语句来减少它....

如果 xml 空间 id == 房间 id，那么如果 xml 事件 start_date 等于今天，那么如果 ($i < $numItems) 如果事件结束时间大于现在，则显示这些事件

当满足这些条件时，我需要记录的计数......当事件发生在今天的日期并且与通过 url 传递的 roomID 位于同一个房间时。将我的 $numItems = $count($arr) 放在 foreach 计数太多记录之前并将计数放在 foreach 中总是只返回 1 的计数。

```
$arr = $this->data['events'];
$numItems = count($arr);
$i = 1;
foreach ($arr as $key => $reservation){
if ((int)$reservation->space_reservation->space_id == $roomID) 
{
//test today's date
        $resDT = date('m/d/y',strtotime($reservation->reservation_start_dt));
        if ($resDT == date('m/d/y'))
            {
            if ($i < $numItems)
            {
            $repst = substr($reservation->event_start_dt,11,5);
            $repet = substr($reservation->event_end_dt,11,5);

                if ( (date('H:i',strtotime($repet))) > (date('H:i')) )
                    {
                    echo '<h2>' .$reservation->event_name. '</h2> ';
                    echo '<span class="dates">' .date('m/d/y',strtotime($reservation->event_start_dt)). ' </span> ';
                    echo '<span class="times">' .date('g:i a',strtotime($repst)). ' - ';
                    echo date('g:i a',strtotime($repet)). '</span> ';
                    echo '<br />';
                    } // ends if event end date has passed

            //echo '<span style="color:#FFF200;">'.$i.'</span>';
            echo '<br />';
            }
//if $i equals last record
            elseif ($i === $numItems) {
                // test if last event ends show
                if ( (date('g:i a',strtotime($repet))) < (date('g:i: a')) ){
                echo '<span style="color:#FFF200;">All scheduled meetings/events have concluded for today. </span><br /><br />';
                }
            }
            $i++;
            } // ends if

    } // ends if
} // ends for each 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T15:56:43.447

以下代码将打印其中之一：

1.  仅限给定房间的今天所有未完成的事件；
2.  “今天所有预定的活动都已结束。” 如果没有了。

我添加了两个计数器供您根据需要使用：

*   **$totalEventsToday** - 计算给定房间今天安排的所有事件；
*   **$unfinishedEventsToday** - 计算给定房间今天安排的事件，其结束日期/时间尚未过去。

所以这里是代码：

```
$today                 = date('m/d/y');
$events                = $this->data['events'];
$totalEventsToday      = 0;
$unfinishedEventsToday = 0;

// Check all reservations/events
foreach ($events as $reservation) {

    // Process reservation/events for the given room only
    if ((int) $reservation->space_reservation->space_id == $roomID) 
    {
        // Process reservation/events for today only
        $resDT = date('m/d/y', strtotime($reservation->reservation_start_dt));
        if ($resDT == $today)
        {
            $totalEventsToday++;

            $repst = substr($reservation->event_start_dt,11,5);
            $repet = substr($reservation->event_end_dt,11,5);

            // Process unfinished event
            if ((date('H:i',strtotime($repet))) > (date('H:i')))
            {
                $unfinishedEventsToday++;

                echo '<h2>' .$reservation->event_name. '</h2> ';
                echo '<span class="dates">' .date('m/d/y',strtotime($reservation->event_start_dt)). ' </span> ';
                echo '<span class="times">' .date('g:i a',strtotime($repst)). ' - ';
                echo date('g:i a',strtotime($repet)). '</span> ';
                echo '<br />';
            } // ends if unfinished event
         } // ends if today
    } // ends if room
} // ends for each

// Test if there aren't any unfinished events left for today
if (!$unfinishedEvents){
    echo '<span style="color:#FFF200;">All scheduled meetings/events have concluded for today. </span><br /><br />';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:04:36.263

我想我不确定你的问题出在哪里。您可以像我在下面所做的那样简单地添加一个计数器`$currentEvents`。

```
$arr = $this->data['events'];
$numItems = count($arr);
$currentEvents = 0;
$i = 1;
foreach ($arr as $key => $reservation){
if ((int)$reservation->space_reservation->space_id == $roomID) 
{
//test today's date
        $resDT = date('m/d/y',strtotime($reservation->reservation_start_dt));
        if ($resDT == date('m/d/y'))
            {
            if ($i < $numItems)
            {
            $repst = substr($reservation->event_start_dt,11,5);
            $repet = substr($reservation->event_end_dt,11,5);

                if ( (date('H:i',strtotime($repet))) > (date('H:i')) )
                    {
                    $currentEvents++;
                    echo '<h2>' .$reservation->event_name. '</h2> ';
                    echo '<span class="dates">' .date('m/d/y',strtotime($reservation->event_start_dt)). ' </span> ';
                    echo '<span class="times">' .date('g:i a',strtotime($repst)). ' - ';
                    echo date('g:i a',strtotime($repet)). '</span> ';
                    echo '<br />';
                    } // ends if event end date has passed

            //echo '<span style="color:#FFF200;">'.$i.'</span>';
            echo '<br />';
            }
//if $i equals last record
            elseif ($i === $numItems) {
                // test if last event ends show
                if ( (date('g:i a',strtotime($repet))) < (date('g:i: a')) ){
                echo '<span style="color:#FFF200;">All scheduled meetings/events have concluded for today. </span><br /><br />';
                }
            }
            $i++;
            } // ends if

    } // ends if
} // ends for each 
```

# android - SpannableString 中可点击对象的边框

> ID：16026577
> 
> 赞同：5
> 
> 时间：2013-04-15T23:57:52.810
> 
> 标签：android

目前我有一个 SpannableString 对象，其中设置了多个 Clickable 对象。因此，一个字符串有许多 Clickable 对象，并且根据用户单击的单词/部分，应用程序将继续处理该单击事件。前几天，我在 stackoverflow 上询问了关于摆脱 SpannableString 中部分单词的蓝色下划线的问题，答案是对 ClickableSpan 类进行子类化，并覆盖 updateDrawState 方法并将 underlineText 设置为 false，这很有效。

我的问题：是否可以在 SpannableString 中的 Clickable 对象周围放置边框？所以基本上每个可点击对象/字符串都必须有自己的边框。

我想也许 updateDrawState 方法可能会有所帮助，但它没有。有人知道如何实现吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-03-31T16:24:38.237

我扩展`ReplacementSpan`了一个概述的跨度。不幸的是，[我无法让它们 wrap](https://stackoverflow.com/questions/29350232/how-can-i-make-my-custom-replacementspan-wrap)，但如果您只想将大纲应用于几个单词，它应该可以正常工作。要使其可点击，您只需使用您`setSpan(ClickableSpanWithoutUnderline...)`在设置此之前提到的子类。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_replacement_span);

    final Context context = this;
    final TextView tv = (TextView) findViewById(R.id.tv);

    Spannable span = Spannable.Factory.getInstance().newSpannable("Some string");
    span.setSpan(new BorderedSpan(context), 0, span.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE); 

    tv.setText(span, TextView.BufferType.SPANNABLE);
}

public static class BorderedSpan extends ReplacementSpan {
    final Paint mPaintBorder, mPaintBackground;
    int mWidth;
    Resources r;
    int mTextColor;

    public BorderedSpan(Context context) {
        mPaintBorder = new Paint();
        mPaintBorder.setStyle(Paint.Style.STROKE);
        mPaintBorder.setAntiAlias(true);

        mPaintBackground = new Paint();
        mPaintBackground.setStyle(Paint.Style.FILL);
        mPaintBackground.setAntiAlias(true);

        r = context.getResources();

        mPaintBorder.setColor(Color.RED);
        mPaintBackground.setColor(Color.GREEN);
        mTextColor = Color.BLACK;
    }

    @Override
    public int getSize(Paint paint, CharSequence text, int start, int end, Paint.FontMetricsInt fm) {
        //return text with relative to the Paint
        mWidth = (int) paint.measureText(text, start, end);
        return mWidth;
    }

    @Override
    public void draw(Canvas canvas, CharSequence text, int start, int end, float x, int top, int y, int bottom, Paint paint) {
        canvas.drawRect(x, top, x + mWidth, bottom, mPaintBackground);
        canvas.drawRect(x, top, x + mWidth, bottom, mPaintBorder);
        paint.setColor(mTextColor); //use the default text paint to preserve font size/style
        canvas.drawText(text, start, end, x, y, paint);
    }
} 
```

# hibernate - hibernate：记录最终生成 SQL 调用的函数

> ID：16026580
> 
> 赞同：0
> 
> 时间：2013-04-15T23:58:04.427
> 
> 标签：hibernate, logging

我遇到了关于登录 Hibernate 的问题，我在网上找不到解决方案。

我想记录最终生成 SQL 语句的函数名称。

例如，我有一个函数`myFunction()`调用

`Person.setAddress()`

，这会产生一个 SQL：

`insert into Person (address) values (X street)`.

我可以使用一些日志库来记录函数（`myFunction()`）的名称，因为它会导致生成 SQL 调用吗？

我正在尝试将 log4j appender 添加到 org.hibernate.SQL，但它没有给我想要的结果。

非常感谢您提前。

# java - 是否在方法签名之前放置空格？

> ID：16026581
> 
> 赞同：5
> 
> 时间：2013-04-15T23:58:24.800
> 
> 标签：java, naming-conventions

我想知道对于方法名称及其参数之间的空白的总体建议是什么。

也就是说，以下两行之间的一般偏好：

```
public static void main (String[] args) {} // (We'll ignore the question of spaces between the `String` and `[]` .)
public static void main(String[] args) {} 
```

我最近开始觉得前者更好，特别是考虑到方法声明中的其他所有内容（例如该`throws Exception(s)`部分）也是空格分隔的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T00:53:40.087

正如@chris 在评论中提到的那样，[官方 Java 代码约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141388.html#682)特别指出：

> 请注意，方法名称与其左括号之间不应使用空格。这有助于区分关键字和方法调用。

正如您在问题中可疑地考虑的那样，方法是故意不同的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-05T15:31:01.753

**2018 年更新**：由于几乎所有 IDE 都允许轻松调用/声明查找，因此在此处切换约定的主要好处是没有实际意义的；3 年后，我已经切换回“方法名称后没有空格”规则，只是因为*大多数语言中的大多数样式指南都使用它*......当收益超过“WTF 因素”时，对现有代码样式进行例外处理是 IMVHO 可行的变化；在这种情况下，使用最新的工具，没有实际的收益，所以我个人建议*反对*下面提出的替代方案。

* * *

我不同意对[1999 年未维护的 White Space Java 约定](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141388.html#682)的解释。它只是说不应该使用空格来帮助区分*关键字和方法调用*。因此，没有关于是否在方法调用不能出现的上下文中使用空间的官方规则（因此不需要这样的帮助）——因此，该规则显然*适用*于调用上下文（调用可以出现以及它有帮助的地方）并且*不适*用于声明性上下文（调用不能出现并且没有任何用途的地方）。甚至更多 - 因为约定指出空格的使用应该*有助于区分使用上下文*，在声明上使用空格实际上符合规则的精神 - 它实际上允许您区分方法调用和方法声明，即使使用简单的文本搜索（只需搜索方法名称后跟空格）。

切换到它之后，将调用与声明区分开来变得更容易了。它还强调了这样一个事实，即名称后面的括号不是调用性的——并且它们的语法与调用语法不同（即，在变量名之前需要类型声明等），正如您已经注意到的那样。

**tl;博士**你可以使用

```
void method () { } // declaration
void method2 () { // declaration
    method(); // invocation
} 
```

能够仅对声明/调用进行快速搜索*并*同时满足约定。

[请注意，所有官方 Java 代码，以及大多数常见的代码样式，*都不*使用声明中的空格。]

# bash - 检索 bash/shell 编程的文件名

> ID：16026582
> 
> 赞同：2
> 
> 时间：2013-04-15T23:58:30.727
> 
> 标签：bash, shell, unix

我需要访问我的 shell 脚本中的两个文件。唯一的问题是，我不确定文件名将是什么，因为它是系统生成的。文件名的一部分始终是不变的，但其余部分是系统生成的，因此可能会有所不同。我不确定如何访问这些文件？

**示例文件名**

*类型 1*

`MyFile1.yyyy-mm-dd_xx:yy:zz.log`

在这种情况下，我知道 MyFile1 部分​​是所有文件的常量，其他部分根据日期和时间而变化。我可以使用`date +%Y-%m-%d`直到，`MyFile1.yyyy-mm-dd_`但我不确定如何选择正确的文件。请注意，每天只有一个此类文件。在 unix 中，下面的命令给了我正确的文件。

`unix> ls MyFile1.yyyy-mm-dd*`

*类型 2*

`MyFile2.yyyymmddxxyyxx.RandomText.SomeNumber.txt`

在这个文件中，您可以看到 Myfile2 部分很常见，我可以让用户 `Date +%Y%m%d`获取到（当前日期）`MyFile2.yyyymmdd`，再次不太清楚如何从那里继续。在 unix 中，下面的命令给了我正确的文件。我还需要在文件 2 的 dd 列中有上一个日期。

`unix> ls MyFile2.yyyymmdd*`

基本上在我的shell脚本中寻找以下行

```
#!/bin/ksh
timeA=$(date +%Y-%m-%d)
timeB=$(date +%Y%m)
sysD=$(date +%d)
sysD=$((sysD-1))
filename1=($Home/folder/MyFile1.$timeA*)
filename2=($Home/folder/MyFile2.$timeB$sysD*) 
```

只是不确定如何获取这两个文件的 RHS。

运行上述脚本时的结果如下

```
Script.ksh[8]: syntax error at line 8 : `(' unexpected 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:30:15.947

或许这

```
$ file=(MyFile1.yyyy-mm-dd*)

$ echo $file
MyFile1.yyyy-mm-dd_xx:yy:zz.log 
```

需要注意的是，必须以这种方式声明变量

```
foo=123 
```

不是

```
foo = 123 
```

仔细注意，不好

```
filename1=$($HOME/folder/MyFile1.$timeA*) 
```

好的

```
filename1=($HOME/folder/MyFile1.$timeA*) 
```

# matlab - 向量化矩阵乘法

> ID：16026585
> 
> 赞同：1
> 
> 时间：2013-04-15T23:59:05.943
> 
> 标签：matlab, matrix, octave, vectorization

我有一个关于在 Octave 上运行 SOR 算法的学校项目，但我的效率非常低。所以我有这段代码：

```
for ii=1:n
    r = 1/A(ii,ii);
    for jj=1:n
        if (ii!=jj)
            A(ii,jj) = A(ii,jj)*r;
        end;
    end;
    b(ii,1) = b(ii,1)*r;
    x(ii,1) = b(ii,1);
end; 
```

我怎样才能矢量化这个？我的第一次尝试是这样的：

```
for ii=1:n
    r = 1/A(ii,ii);
    A(find(eye(length(A))!=1)) = A(find(eye(length(A))!=1))*r;
    b(ii,1) = b(ii,1)*r;
    x(ii,1) = b(ii,1);
end; 
```

但我不确定它有多大帮助。有没有更好和/或更有效的方法来做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T00:35:44.083

我相信你可以完全避免循环。您必须看到您将 的对角线元素视为 的倒数`A`，那么您为什么要使用循环。直接做。这是第一步。删除`Inf`，现在您想乘以`r`相应行的相应非对角元素，对吗？

因此，请使用`repmat`构造这样的矩阵，该矩阵将沿列复制元素，因为您将相同的乘以`r`(1,2)、(1,3)、...、(1,n)。但`R`具有非零对角元素。因此使它们为零。现在你会得到你的 A 除了对角线元素将为零。因此，您只需将它们从 original 添加回来`A`。这可以通过`A=A.*R+A.*eye(size(A,1))`.

矢量化来自经验，最重要的是分析您的代码。在每个步骤中考虑是否要使用循环，如果不使用等效命令替换该步骤，则将遵循其他代码（例如，我构造了一个矩阵`R`，而您正在构造单个元素`r`。所以我只考虑转换`r`->`R`然后其余的代码将就位）。

代码如下：

```
R=1./(A.*eye(size(A,1))); %assuming matrix A is square and it does not contain 0 on the main diagonal
R=R(~isinf(R));
R=R(:);
R1=R;
R=repmat(R,[1,size(A,2)]);
R=R.*(true(size(A,1))-eye(size(A,1)));
A=A.*R+A.*eye(size(A,1)); %code verified till here since A comes out to be the same

b = b.*R1;
x=b; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:58:27.440

我想有矩阵：

```
A (NxN)
b (Nx1) 
```

编码：

```
d = diag(A);
A = diag(1 ./ d) * A + diag(d - 1);
b = b ./ d;
x = b; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-30T19:47:04.753

随机碰到这个问题，乍一看看起来很有趣，因为这个问题被标记为`vectorization`问题。

我能够提出一个`bsxfun`基于矢量化的解决方案，该解决方案也使用`diagonal indexing`. 这个解决方案似乎让我`3-4x`加快了具有适当大小输入的循环代码。

假设你仍然有兴趣看到这个问题的加速改进，我很想知道你会得到什么样的加速。这是代码 -

```
diag_ind = 1:size(A,1)+1:numel(A);
diag_A = A(diag_ind(:));
A = bsxfun(@rdivide,A,diag_A);
A(diag_ind) = diag_A;
b(:,1) = b(:,1)./diag_A;
x(:,1) = b(:,1); 
```

让我知道！

# java - 标准错误输出上的 Eclipse 中断

> ID：16026586
> 
> 赞同：2
> 
> 时间：2013-04-15T23:59:06.283
> 
> 标签：java, eclipse, debugging

使用 eclipse 调试器，是否可以在将某些内容打印到标准错误输出（例如`System.err.println("error")`）时中断？我需要这个，因为我有一个打印错误的程序，我想知道它们在代码中的打印位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T06:19:14.093

您可以在程序一开始就将自写的流类设置[为错误流](http://docs.oracle.com/javase/6/docs/api/java/lang/System.html#setErr%28java.io.PrintStream%29)，并轻松地将断点放入该类中。

看看[这个实现](http://jeeeyul.wordpress.com/2012/10/18/make-system-out-println-rocks/)，它甚至可以为您节省断点，因为它会在出现某些输出时自动打印出代码位置。

# java - 多线程/并发问题

> ID：16026590
> 
> 赞同：0
> 
> 时间：2013-04-16T00:00:00.853
> 
> 标签：java, multithreading, concurrency, locking

我正在使用线程编写一个理发店程序。目前我有一个理发师和多个客户同时进来。然而，在第一次运行程序之后，其余的客户都搞砸了。他们都同时坐下。有什么我错过的吗？我的代码是：

```
public synchronized void enter(Customer cust) {
    custList.add(cust);
       getCut(cust);
     }
      public synchronized void getCut(Customer cust) {    
    try {    
      notify(); 
      wait(); 

      System.out.println("sit down");
      notify();
      if (cashier==0) {
        cashier++;
        wait();
        System.out.println("waiting to pay");
        notify();     
        wait();
        System.out.println("left the room"); 
        chairs++; 
        cust.terminate(); 
      }

    } catch (InterruptedException ie) {}

  } 
```

这是我的理发师部分：

```
 public synchronized void cut(Barber barb) {

    cashier=0;

    try { 
     if(temp){
       System.out.println(temp);
        temp = false;
        notify();
        wait(); //wait for the customer to be settled in
        System.out.println("go to cus");
        notify(); 
        wait();

        System.out.println("cut cus hair");
        notify(); 

        wait();
        if (cashier==1) {

          System.out.println("got money");
          notify();
          cashier--;

          barbers++;

        }
     }      
    } catch (InterruptedException ie) {}

  }
}
 public synchronized void goCut(Barber barb) {

cashier=0;

try { 
 if(temp){
   System.out.println(temp);
    temp = false;
    notify();
    wait(); 
    System.out.println("walks to cus");
    notify(); 
    wait();

    System.out.println("cut hair");
    notify()

    wait();
    if (cashier==1) {

      System.out.println("got the money");
      notify();
      cashier--;
      barbers++;

    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T04:23:29.350

看起来您正在`notify`随机`wait`使用。

你有

```
notify();
wait(); 
```

在`getCut`方法的开头，它的作用是：

*   第一个客户端进来，它调用通知，然后等待
*   第二个客户端进来，它调用通知 - 因此它唤醒第一个客户端，然后等待
*   第三个客户端进来，它调用通知 - 结果第二个客户端唤醒，依此类推

相反，您应该使用通知和唤醒来阻止特定资源（椅子）。

```
private final Object pChairLock = new Object();
private int pAvaliableChairs = 3;

...

// take the resource
synchronized(pChairLock)
{
    // wait until a chair is avaliable
    while(pAvaliableChairs == 0)
    { 
        pChairLock.wait();
    }

    // take sit
    pAvaliableChairs--;
}

// now the current thread 'is sitting'
//  - it can do some work using the resource

// after finishing, release the resource
synchronized(pChairLock)
{
    pAvaliableChairs--;

    // notify all waiting thread that resource is available
    pChairLock.notifyAll();
} 
```

在这种情况下，您可以只使用 notify()，但如果不同的线程正在等待释放资源并获取它，那么调用 notify 可能会唤醒错误的线程。不要担心同时唤醒太多线程，因为每个线程都会检查资源是否可用，只有第一个线程能够获取它 - 其余线程将继续等待。

此示例使用三把椅子，但您可以只使用一个（布尔值）或任何其他数字。你可以对收银员做同样的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:05:43.027

从甲骨文网站

> 注意：始终在测试等待条件的循环内调用等待。不要假设中断是针对您正在等待的特定条件，或者条件仍然为真。

请参考[Guarded blocks multithreading](http://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T22:43:16.760

使用下面的代码作为模板（来自 Magee & Kramer 的教科书）......

*   生产者消费者 = 理发店
*   创建大小为 1 的 BarberShop
*   get = giveCut（理发师“得到”一位顾客并给顾客理发）
*   put = getCut（客户要求理发 - 即“提出”客户要求理发）

代码：

```
public class ProducerConsumer {
  protected Object[] buf;
  protected int count = 0;
  protected int size;

  public ProducerConsumer(int size) {
    this.size = size;
    buf = new Object[size];
  }

  public synchronized void put(Object o) throws InterruptedException {
    while (count == size) wait();
    buf[count] = o;
    ++count;
    notifyAll();
  }

  public synchronized Object get() throws InterruptedException {
    while (count == 0) wait();
    --count;
    Object o = buf[count];
    buf[count] = null;
    notifyAll();
    return (o);
  }
} 
```

# javascript - 如何消除由相对路径引起的重复需求？

> ID：16026592
> 
> 赞同：15
> 
> 时间：2013-04-16T00:00:13.090
> 
> 标签：javascript, requirejs, gruntjs

使用该`grunt-contrib-requirejs`任务优化我的 require.js 项目时，由于相对路径，需要多次使用许多脚本。以下是构建期间输出的依赖项列表：

```
components/requirejs/require.js
.tmp/scripts/../../components/flight/lib/././utils.js
.tmp/scripts/../../components/flight/lib/./././utils.js
.tmp/scripts/../../components/flight/lib/././../tools/debug/../../lib/./utils.js
.tmp/scripts/../../components/flight/lib/././../tools/debug/../../lib/registry.js
.tmp/scripts/../../components/flight/lib/././../tools/debug/../../lib/utils.js
.tmp/scripts/../../components/flight/lib/././../tools/debug/debug.js
.tmp/scripts/../../components/flight/lib/././compose.js
.tmp/scripts/../../components/flight/lib/./advice.js
.tmp/scripts/../../components/flight/lib/./utils.js
.tmp/scripts/../../components/flight/lib/./../tools/debug/../../lib/./utils.js
.tmp/scripts/../../components/flight/lib/./../tools/debug/../../lib/registry.js
.tmp/scripts/../../components/flight/lib/./../tools/debug/../../lib/utils.js
.tmp/scripts/../../components/flight/lib/./../tools/debug/debug.js
.tmp/scripts/../../components/flight/lib/./compose.js
.tmp/scripts/../../components/flight/lib/./registry.js
.tmp/scripts/../../components/flight/lib/component.js 
```

注意如何`utils.js`包含 7 次：

```
.tmp/scripts/../../components/flight/lib/./utils.js
.tmp/scripts/../../components/flight/lib/././utils.js
.tmp/scripts/../../components/flight/lib/./././utils.js
.tmp/scripts/../../components/flight/lib/./../tools/debug/../../lib/utils.js
.tmp/scripts/../../components/flight/lib/./../tools/debug/../../lib/./utils.js
.tmp/scripts/../../components/flight/lib/././../tools/debug/../../lib/utils.js
.tmp/scripts/../../components/flight/lib/././../tools/debug/../../lib/./utils.js 
```

[Flight](https://github.com/twitter/flight)需要`utils.js`在其`lib`路径中的每个脚本中`./util`，有时还需要其他依赖项，然后`./util`再次需要。

[`grunt-contrib-requirejs`](https://github.com/gruntjs/grunt-contrib-requirejs)将他们的选项直接传递给[requirejs](https://github.com/jrburke/requirejs)，其中包含一个[`trimDots`](https://github.com/jrburke/requirejs/blob/master/require.js#L225)应该“[修剪] . 和 .. 从路径段数组中的函数。”

为什么不处理一些明显的重复项？

我该怎么做才能消除相对路径等于相同绝对路径的其他重复项？

如果相对路径将规范化为绝对路径，一切都会好的。

**更新：**

这就是我的项目的结构：

```
.tmp/scripts/ (where coffeescript is compiled)
app/scripts/ (coffeescript source)
components/ (bower components)
dist/ (where optimized code is output)
Gruntfile.coffee (requirejs config) 
```

这是我的 Gruntfile 中的 requirejs 配置：

```
requirejs:
  dist:
    options:
      baseUrl: '.tmp/scripts'
      # paths relative to baseUrl
      paths:
        requireLib: '../../components/requirejs/require'
      include: 'requireLib'
      optimize: 'uglify2'
      generateSourceMaps: true
      preserveLicenseComments: false
      useStrict: true
      wrap: true
      name: 'main'
      out: 'dist/main.js'
      mainConfigFile: '.tmp/scripts/main.js' 
```

这是里面的内容`app/scripts/main.coffee`：

```
require.config
  paths:
    # required dependencies
    jquery: '../../components/jquery/jquery'
    es5shim: '../../components/es5-shim/es5-shim'
    es5sham: '../../components/es5-shim/es5-sham'
    # plugins
    text: '../../components/requirejs-text/text'
    pickadate: '../../components/pickadate/source/pickadate.legacy'
  map:
    '*':
      'flight/component': '../../components/flight/lib/component'
  shim:
    '../../components/flight/lib/index':
      deps: ['jquery', 'es5shim', 'es5sham']
    'app':
      deps: ['../../components/flight/lib/index']

require ['app'], (App) ->
  App.initialize() 
```

这是里面的内容`app/scripts/app.coffee`：

```
define [
  'ui/apple',
  'ui/orange'
], (Apple, Orange) ->
  initialize = ->
    Apple.attachTo document
    Orange.attachTo document
    return

  initialize: initialize 
```

两者`app/scripts/ui/apple.coffee`和`app/scripts/ui/orange.coffee`都很简单：

```
"use strict"
define ['flight/component'], (defineComponent) ->
  apple = ->
    # stuff
  defineComponent apple 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T07:44:21.633

尝试在 grunt-contrib-requirejs 选项中设置 baseUrl：

```
requirejs: {
    compile: {
        options: {
            baseUrl: "path/to/base"
        }
    }
} 
```

记录[在这里](https://github.com/jrburke/r.js/blob/master/build/example.build.js)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-22T22:32:32.250

我在您的代码中看到了一些引起问题的东西。我知道这个问题是在三年前提出的，所以其中一些问题在当时可能并不适用。但是我[及时回过头](https://github.com/flightjs/flight/tree/e5fc35d9d8d6ae0431be4fd6052ce151bb2c0c66)来看了三年前的航班代码，然后才回答。

1.  你为什么要提供`requireLib`grunt 插件？您不需要这样做，因为 grunt 插件应该加载它自己的。结果将是两个需要加载的库，这令人困惑。

2.  Shim 配置仅适用于[非 AMD 模块](http://requirejs.org/docs/api.html#config-shim)，但是您正在填充“app”和 flight“index”，它们都是 AMD 模块。我会期待一些奇怪的行为。

3.  为了修复 #2 并使您的代码更简单，您可以完全移除 shim 并简单地映射所有与“飞行”相关的内容：

    ```
    # main.coffee
    require.config
      paths:
        # required dependencies
        jquery: '../../components/jquery/jquery'
        es5shim: '../../components/es5-shim/es5-shim'
        es5sham: '../../components/es5-shim/es5-sham'
        # plugins
        text: '../../components/requirejs-text/text'
        pickadate: '../../components/pickadate/source/pickadate.legacy'
      map
        '*':
          'flight': '../../components/flight/lib'

    require ['jquery', 'es5shim', 'es5sham'], (App) ->
      require ['app'], (App) ->
        App.initialize()

    # app.coffee
    define [
      'flight/index',
      'ui/apple',
      'ui/orange'
    ], (Apple, Orange) ->
      initialize = ->
        Apple.attachTo document
        Orange.attachTo document
        return

      initialize: initialize 
    ```

我不确定这是否能解决你的问题，所以如果你可以上传一个带有相关代码的小 zip 文件，那将有很大帮助。

# wolfram-mathematica - 将 2 个单暗列表交错成列表列表

> ID：16026593
> 
> 赞同：0
> 
> 时间：2013-04-16T00:00:13.310
> 
> 标签：wolfram-mathematica

我有 2 个列表，`{1,2,3,4,5}`并且`{a,b,c,d,e}`. 我想结束`{{1,a},{2,b},{3,c},{4,d},{5,e}}`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:06:32.143

这个怎么样：

```
l1 = {1, 2, 3, 4, 5};
l2 = {a, b, c, d, e};

Partition[Riffle[l1, l2], 2] 
```

```
{{1, a}, {2, b}, {3, c}, {4, d}, {5, e}}

```

或者，您可以尝试

```
l1 = {1, 2, 3, 4, 5};
l2 = {a, b, c, d, e};

Transpose[{l1, l2}] 
```

```
{{1, a}, {2, b}, {3, c}, {4, d}, {5, e}}

```

# python - Unicode 编码错误 Python - 解析 XML 无法编码字符（星号）

> ID：16026594
> 
> 赞同：2
> 
> 时间：2013-04-16T00:00:19.997
> 
> 标签：python, unicode, xml-parsing

我是 Python 的初学者，目前正在从 eventful.com API 解析基于 Web 的 XML 文件，但是在检索数据的某些元素时收到一些 unicode 错误。

我能够从 xml 文件中检索 5 个数据元素而没有任何我想要的问题，但是它会终止并在 GAE 错误控制台中产生以下错误：

```
UnicodeEncodeError: 'ascii' codec can't encode character u'\u2605' in position 0: ordinal not in range(128) 
```

我知道抛出我的解析器的字符是“★”字符，无论如何我都不想从 xml 文件中检索它。

我的代码如下：

```
class XMLParser(webapp2.RequestHandler):
        def get(self):
        base_url = 'my xml file'
        #downloads data from xml file
        response = urllib.urlopen(base_url)
        #converts data to string:
        data = response.read()

        #closes file
        response.close()

        #parses xml downloaded
        dom = mdom.parseString(data)
        node = dom.documentElement  
        #print out all event names (titles) found in the eventful xml
        event_main = dom.getElementsByTagName('event')

        event_names = []
        for event in event_main:
            eventObj = event.getElementsByTagName("title")[0]
            event_names.append(eventObj)

        for ev in event_names:
            nodes = ev.childNodes
            for node in nodes:
                if node.nodeType == node.TEXT_NODE:
                    print node.data 
```

有什么方法可以检索“标题”元素并忽略这里的 ★ 字符等有趣的字符？我真的很感激在这件事上的任何帮助。我已经尝试过使用 word.encode('us-ascii', 'ignore') 的解决方案，但这并不能解决问题。

------------我找到了解决方案：

因此，当我遇到这个问题时，在与该主题的讲师交谈后，我发现只需要两行代码来编码和解码解析的 xml 文件（在它被读入程序之后）。希望这可以帮助其他有同样问题的人！

```
unicode_data = data.decode('utf-8')
data = unicode_data.encode('ascii','ignore') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T03:28:44.403

你在哪里使用你的解码方法？

我过去遇到过这个错误，不得不解码原始数据。换句话说，我会尝试做

```
data = response.read()
#closes file
response.close()
#decode
data.encode("us-ascii") 
```

那就是如果它实际上是ascii。我的意思是在调用 parseString 之前，确保在原始结果仍为字符串格式时对其进行编码/解码。

# java - 为 URLConnection 设置“用户代理”参数以从 Java 应用程序查询 Google

> ID：16026596
> 
> 赞同：4
> 
> 时间：2013-04-16T00:00:35.793
> 
> 标签：java, httpurlconnection, urlconnection, google-search

我正在尝试从 Google 查询中获取结果，使用 Java 如下：

```
String urlquery = "https://www.google.com/search?hl=en&gl=us&tbm=nws&q=apples&oq=apples";
URL url = new URL(urlquery);
URLConnection connection = url.openConnection();
URLConnection.setRequestProperty("User-Agent", "Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_5_8; en-US) AppleWebKit/532.5 (KHTML, like Gecko) Chrome/4.0.249.0 Safari/532.5"); 
```

但是，我不知道如何设置上面的“User-Agent”参数。我从哪里获得系统的值？我只是从网上找到的一些代码中复制了这些值。

我的系统配置如下： Mac OSX 10.8.3 Intel i7 Safari 6.0.3(8536.28.10)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T00:19:46.947

If you just want to know what to set your user agent to so you can mimic the response that browser will get you can use this site.

[http://www.whatsmyuseragent.com/](http://www.whatsmyuseragent.com/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-27T01:53:35.370

步骤打击可以帮助您获得“用户代理”：

1.  打开chrome，按F12。
2.  输入任何可用的网站，然后按 Enter。
3.  点击 DevTools 上的“NetWork”，然后点击刚才输入的网站。
4.  所以你可以找到“User-Agent”，就像下图一样。 [像这样](http://i.stack.imgur.com/l9k7Y.png)

# intro.js - Intro.js 不适用于特定类

> ID：16026600
> 
> 赞同：3
> 
> 时间：2013-04-16T00:01:05.783
> 
> 标签：intro.js

我无法仅使用类“case_event_intro”开始元素的介绍，但是当我不做`introJs(".case_event_intro").start();`任何事情时，即使有该类和介绍 att 的元素。定义（数据介绍和数据步骤）。除了 case_event_intro 之外，这些元素还有其他类。这可能是问题吗？是否有任何其他条件可以使介绍仅适用于给定类的某些元素？

请参阅此[屏幕截图](https://dl.dropboxusercontent.com/u/6421243/Intro.js%20not%20working%20for%20specific%20class.png)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T06:24:01.407

在当前版本的 IntroJs (v0.3.0) 中，您无法开始介绍具有类或其他内容的特定元素。

您应该创建一个容器元素，然后开始介绍这些元素，如下所示：

```
<div class="case_event_intro">
    <div data-intro="Hello world" data-step="1">
        ...
    </div>
</div> 
```

然后调用：

```
introJs(".case_event_intro").start(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-09T21:25:56.450

切换添加类的位置。

```
introJs().start('.case_event_intro'); 
```

# actionscript-3 - 主策略文件与子目录中的 crossdomain.xml

> ID：16026608
> 
> 赞同：0
> 
> 时间：2013-04-16T00:02:16.487
> 
> 标签：actionscript-3, flash, cross-domain, crossdomain.xml, cross-domain-policy

我在 localhost 上有一个 swf，它试图从另一台服务器（example.com）读取文本文件。文本文件位于如下子目录中：example.com/test/example.txt

首先这里是根目录和子目录的内容：

www.example.com：

/crossdomain.xml

```
<?xml version="1.0"?>   
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
    <site-control permitted-cross-domain-policies="master-only"/> 
    <allow-access-from domain="*" secure="false" />
</cross-domain-policy> 
```

/test/crossdomain.xml

```
<?xml version="1.0"?>   
<!DOCTYPE cross-domain-policy SYSTEM "http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">
<cross-domain-policy>
    <allow-access-from domain="*"/>
</cross-domain-policy> 
```

/test/example.txt

现在，如果我在我的动作脚本中明确提及如下：

```
Security.loadPolicyFile("http://example.com/test/crossdomain.xml"); 
```

然后在 actionscript 中加载：[http ://example.com/test/example.txt。](http://example.com/test/example.txt)现在第一个操作应该是检查根目录下的主策略文件，以检查其元策略是否允许从测试文件夹加载 crossdomain.xml。由于这里的元策略指定“仅主”，我假设 security.loadpolicyfile() 指定的策略文件不会被加载。但我的问题是，在此检查之后，主策略文件是否会因为主策略文件中指定的策略而允许来自测试文件夹的文本文件的访问请求`<allow-access-from domain="*" secure="false" />`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T22:40:55.530

根据 Adob​​e 跨域策略规范，

1.  swf 看到指定了跨域策略。
2.  它检查主策略文件以查看是否允许指定的策略文件。
3.  Since the specified master policy file is not permitted, it DEFAULTS to load the master policy file and grant permission accordingly.

# r - 使用 scatterplot3d 绘制球体

> ID：16026610
> 
> 赞同：1
> 
> 时间：2013-04-16T00:02:30.793
> 
> 标签：r, plot

我有一个所有氨基酸的 x,y,z 坐标矩阵。我使用以下函数在 3D 空间中绘制蛋白质：

```
make.Plot <- function(position.matrix, center, radius){
  scatterplot3d(x = position.matrix[,4], y = position.matrix[,5], z = position.matrix[,6], type = 'o', color = 'blue')
} 
```

position.matrix 中的每一行代表不同的氨基酸。我想做的是修改函数，所以如果我传递一个“中心”，它对应于位置矩阵第 2 列中的数字（列出氨基酸编号）以及半径，我想要一个球体以该氨基酸为中心。

例如，如果我通过它 (position.matrix, 9, 3)，我希望它在氨基酸 9 周围绘制一个半径为 3 的球体。我在此处上传了位置数据的副本： [http://temp-share .com/show/YgFHv2J7y](http://temp-share.com/show/YgFHv2J7y)

请注意，行计数并不总是规范计数，因为跳过了一些残基。我将始终将其传递给“规范”计数...

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T00:50:18.210

这是您的代码的经过测试的修改。它为 cex.symbols 添加一个长度为 2 的大小向量，通过将 1 添加到逻辑向量来选择该向量：

```
make.Plot <- function(position.matrix, center, radius){
    scatterplot3d(x = position.matrix[,4], y = position.matrix[,5], 
                  z = position.matrix[,6], type = 'o', 
          cex.symbols=c(1,radius)[1+(position.matrix[,2]==center)],  color = 'blue')
          } 
```

![在此处输入图像描述](https://i.stack.imgur.com/ePRG6.png)

我想知道你真正想要的是 rgl 包。它具有形状和交互式绘图环境。使用 scatterplot3d，您可以使用以下代码将选择的点设为红色：

```
myplot <- make.Plot(position.matrix, 3, 9)
myplot$points3d(position.matrix[3 , 4:6],  col="red", cex=10) 
```

我还找到了一些代码来绘制一个“参数球体”，它可以适应创建一个突出显示的指标：

```
myplot <- make.Plot(position.matrix, 3, 9)
a=seq(-pi,pi, length=10);
myplot$points3d(x=2*c(rep(1, 10) %*% t(cos(a)))+position.matrix[3 , 4] , 
 y=2*c(cos(a) %*% t(sin(a)))+position.matrix[3 , 5],
 z=2*c(sin(a) %*% t(sin(a)))+position.matrix[3 , 6],
 col="red", cex=.2) 
```

![在此处输入图像描述](https://i.stack.imgur.com/LnKht.png)

# php - IF/ELSE PHP 速记

> ID：16026612
> 
> 赞同：0
> 
> 时间：2013-04-16T00:02:44.790
> 
> 标签：php, shorthand-if

在过去的几个小时里，我一直在努力写下下面的 PHP 条件语句的**速记：**

```
public static $url = $_SERVER['HTTP_REFERER'];

if (false !== strpos($url,'en')) {
    $currlang = 'en';
} else {
    $currlang = 'fr';
} 
```

尽管我尝试了许多变体并且我还阅读了在线示例，但我无法弄清楚如何做到这一点。你能帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T00:03:43.570

```
$currlang = false !== strpos($url, 'en') ? 'en' : 'fr'; 
```

[PHP手册：三元运算符](http://php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary)

# mysql - 如何在 MySQL 中使用没有 GROUP BY 的 GROUP_CONCAT 功能？

> ID：16026614
> 
> 赞同：0
> 
> 时间：2013-04-16T00:02:59.820
> 
> 标签：mysql, sql, concatenation, group-concat

这是检索课程数据的原始 SQL 语句：

```
SELECT
    `courses`.`id` AS `id`,
    `courses`.`title` AS `title`,
    `courses`.`description` AS `description`,
    MATCH (coursedata.title) AGAINST ('Salsa') * 5 + MATCH (coursedata.description) AGAINST ('Salsa') * 2 AS `relevance`,
    GROUP_CONCAT(trainers.name SEPARATOR '|||') AS `trainers`
FROM `courses`
INNER JOIN `coursedata` ON `courses`.`id` = `coursedata`.`id`
        INNER JOIN `courses_trainers` ON `courses`.`id` = `courses_trainers`.`course_id`
INNER JOIN `trainers` ON `trainer_id` = `trainers`.`id`
GROUP BY `courses`.`id`
HAVING `relevance` >= '3' 
```

由于它使用[`MySQL Extensions to GROUP BY`](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)and 无法执行，如果`sql_mode`设置为`ONLY_FULL_GROUP_BY`，我必须使其符合标准 SQL：

```
SELECT * FROM (
    SELECT
        `courses`.`id` AS `id`,
        `courses`.`title` AS `title`,
        `courses`.`description` AS `description`,
        MATCH (coursedata.title) AGAINST ('Salsa') * 5 + MATCH (coursedata.description) AGAINST ('Salsa') * 2 AS `relevance`
        -- , GROUP_CONCAT(trainers.name SEPARATOR '|||') AS `trainers`
    FROM `courses`
    INNER JOIN `coursedata` ON `courses`.`id` = `coursedata`.`id`
    LEFT JOIN `courses_trainers` ON `courses`.`id` = `courses_trainers`.`course_id`
    LEFT JOIN `trainers` ON `trainer_id` = `trainers`.`id`
) AS subselect
WHERE `relevance` >= '3' 
```

这个很糟糕，但我不能再使用这个`GROUP_CONCAT`函数（为了将多个`trainer`字段连接到一个字段/字符串）。

```
Error Code: 1064
You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'GROUP_CONCAT(trainers.name SEPARATOR '|||') AS `trainers`
    FROM `courses`
    INNER' at line 7 
```

还有其他方法可以使用该`GROUP_CONCAT`功能吗？

# c# - 单个布尔值返回 true，但在检查两者是否为 true 时返回 false

> ID：16026618
> 
> 赞同：-1
> 
> 时间：2013-04-16T00:03:26.273
> 
> 标签：c#, boolean, unity3d

所以我有两个布尔值：`Player1Finish`和`Player2Finish`. `true`当玩家专门进入某个点时，它们都会转向。代码中的所有内容都正常工作，我对其进行了测试，如果布尔值返回`true`用于测试目的，它会打印某些内容：

```
if(Player1Finish == true){
    print("One");
}
if(Player2Finish == true){
    print("Two");
}
if(Player2Finish && Player1Finish){
    print("Both");
} 
```

但这些是我得到的结果：我的控制台正在打印`"One"`，`"Two"`但不是`"Both"`. 我很困惑；我在搞砸什么？我找不到任何基本的布尔问题来回答这个问题，所以如果有答案，如果你指出我正确的方向，我会非常乐意阅读它。

除了这个小循环之外，代码中没有其他错误，这是唯一让我无法完成的事情。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-16T00:12:47.893

根据我们在您的代码片段中看到的内容，您应该得到“One”、“Two”和“Both”的输出。既然您不是，我们唯一可以得出的结论是该片段之外的某些东西正在影响它。

如果您直接在代码片段之前添加这些代码行，您会得到所有三个输出吗？

```
Player1Finish = true;
Player2Finish = true; 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-16T02:36:27.140

以下应该工作。

```
 if (Player1Finish == true && Player2Finish == true) {
            Console.Write("Both");
        } else if (Player1Finish == true) {
            Console.Write("One");
        } else {
            Console.Write("Two");
        } 
```

# php - 何时使用 ftp_pasv？

> ID：16026619
> 
> 赞同：4
> 
> 时间：2013-04-16T00:03:31.530
> 
> 标签：php, ftp

什么时候应该将 ftp_pasv 设置为 TRUE？我可以一直这样做吗？如果没有，我有没有办法以编程方式确定服务器是否需要它？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T00:22:24.183

`passive mode`并且`active mode`是初始化与 FTP 服务器的数据连接的 2 种方法。

在 中时`passive mode`，您的 FTP 客户端使用命令询问`PASV`连接到 FTP 服务器的端口。服务器回复一个大数字，即 IP 和 PORT，可以建立连接（FTP 客户端 - 你 - 初始化连接）

在 中时`active mode`，您的 FTP 客户端使用命令告诉 FTP 服务器`PORT`它应该连接哪个端口（服务器初始化连接）。

因此，没有“方法”来确定要使用的方法。这取决于您的 FTP 服务器功能和您的情况。

首先，您必须检查您的 FTP 服务器是否接受这两种模式，`active`以及`passive`.

其次，您必须检查您作为客户端是否位于 NAT 路由器后面。如果是这种情况，那么使用被动模式会更容易（因为这是您的 FTP 客户端，它将初始化连接）。在其他情况下，您将需要进行一些路由器配置...

以编程方式，您可以尝试初始化数据连接`PASV`并检查服务器响应。取决于响应代码，您应该能够知道是否必须切换模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:50:17.460

被动模式比主动模式更常见。您可以向 FTP 服务器发出 FEAT 命令以查看是否支持 PASV（只要支持 FEAT 命令本身就可以使用）。

通常，您必须预先知道服务器是否“需要”被动模式。（联系服务器管理员了解是否支持被动模式）。

# cocoa - NSTabView 自动布局问题（选项卡内基于视图的 NSTableViews）

> ID：16026620
> 
> 赞同：1
> 
> 时间：2013-04-16T00:03:40.550
> 
> 标签：cocoa, autolayout

我有一个 NSTabView，它有 5 个标签。每个选项卡都包含一个 NSTableView（默认情况下，它嵌套在 NSScrollView 中）。这都是从打开自动布局的 xib 文件加载的。我希望每张桌子都能完全占据它各自的标签。使用自动布局，我选择每个选项卡并仔细设置 NSScrollView，以便它的顶部、底部、前导和后沿捕捉到超级视图。在对 5 个选项卡执行此操作后，我将调整 xib 的大小以对其进行测试。当我循环浏览选项卡时，有些保持捕捉到超级视图，有些则没有。这似乎有某种顺序，但这超出了我的解释范围。

真正令人沮丧的是，有时它会运行良好，有时会因为无法满足的约束而崩溃。现在我正在使用弹簧/支柱，但我喜欢自动布局并想让它工作。

恐怕是滚动视图中的表格嵌套导致了问题。

如果你把它放在你自己的笔尖上，你应该能够复制它。

如果 OSX 类似于 iOS 的自动布局，我希望可以通过在运行时添加 NSLayoutConstraints 来解决这个问题。使用 IB，除了超级和兄弟（没有堂兄弟）之外，您不能对任何东西施加约束。这可以在运行时完成。

我希望有人遇到这个问题并有解决方案。

![在此处输入图像描述](https://i.stack.imgur.com/uwuCm.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T04:38:12.850

为什么布局中的约束显示固定常量而不是自动？会是这样吗？

您提到了表弟约束，如果您在左侧的文档大纲中选择两个视图然后添加一个约束，我相信您可以在 IB 中添加。如果我使用主窗口，我无法在 IB 中选择任何两个视图，但我可以在文档大纲中进行。

最后，您提到它有时会运行良好，但有时会运行良好 - 如果是这种情况，听起来像是其他东西正在增加约束。Instruments 应该有一个用于跟踪约束的模板，如果你可以重现它，你可能会知道是什么引入了不兼容的约束。

# java - Java 编程：数组和随机生成

> ID：16026623
> 
> 赞同：-1
> 
> 时间：2013-04-16T00:03:45.297
> 
> 标签：java, arrays, random

我有一个任务是创建一个生成随机“诗歌”的程序。这是我的代码：

```
package poem;

import java.util.Random;

public class Poem {

    public static void main(String[] args) {
        String rhyme1[] = {"ball", "call", "mall", "hall", "guy named Paul"};
        String rhyme2[] = {"cat","hat", "bat", "rat", "mat", "guy named Pat"};
        String nouns[] = {"you", "I", "girl", "boy", "man", "woman"};
        String verbs[] = {"run", "jump", "dive", "sink", "fall", "collapse", "swim", "love"};
        String others[] = {"like a", "into a", "nothing like a"};

        Random gen = new Random();

        String currentNoun = nouns[gen.nextInt(nouns.length)];
        String currentVerb = verbs[gen.nextInt(verbs.length)];
        String currentRhyme1 = rhyme1[gen.nextInt(rhyme1.length)];
        String currentRhyme2 = rhyme2[gen.nextInt(rhyme2.length)];
        String currentOther = others[gen.nextInt(others.length)];

        System.out.printf("%s %s %s %s \n", currentNoun, currentVerb, currentOther, currentRhyme1);
        System.out.printf("%s %s %s %s \n", currentNoun, currentVerb, currentOther, currentRhyme1);}} 
```

我的问题是，当我运行它时，我两次都得到完全相同的行。如何每次获得不同的随机生成的行？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:07:49.407

问题是每个变量只调用一次 gen.nextInt 。当您生成随机数并将其分配给 currentX 时，这是您分配它的唯一时间。您应该将字符串赋值和 sysout 放在一个循环中，以生成新的随机值并打印它们。

即类似的东西

```
while (true) {
     int i = gen.nextInt(10);
     System.out.println("foo " + i);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:09:49.197

您分配`currentNoun`,`currentVerb`等一次，然后将它们打印两次。除非您在再次打印之前重新分配它们，否则它们的值不会改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:11:42.570

从你第一次调用到第二次，变量没有改变`System.out.printf()`，所以你只是打印了两次。一种解决方法是创建一个 generatePoems 方法，该方法将打印任意数量的诗歌，然后从 main 方法调用它。这样一来，整个事情就会更干净，代码也相对可重用。

```
void generatePoems(int numberOfPoems){ //This block should be outside of the main method
  for (int i = 0; i<numberOfPoems;i++){

  String rhyme1[] = {"ball", "call", "mall", "hall", "guy named Paul"};
  String rhyme2[] = {"cat","hat", "bat", "rat", "mat", "guy named Pat"};
  String nouns[] = {"you", "I", "girl", "boy", "man", "woman"};
  String verbs[] = {"run", "jump", "dive", "sink", "fall", "collapse", "swim", "love"};
  String others[] = {"like a", "into a", "nothing like a"};

  Random gen = new Random();

  String currentNoun = nouns[gen.nextInt(nouns.length)];
  String currentVerb = verbs[gen.nextInt(verbs.length)];
  String currentRhyme1 = rhyme1[gen.nextInt(rhyme1.length)];
  String currentRhyme2 = rhyme2[gen.nextInt(rhyme2.length)];
  String currentOther = others[gen.nextInt(others.length)];
  System.out.printf("%s %s %s %s \n", currentNoun, currentVerb, currentOther, currentRhyme1);
  }
} 
```

您的主要方法应如下所示：

```
public static void main(String[] args) {
  generatePoems(2);
  /* 2 is the number of poems you want to generate. Can be anything as long as its
  under 2147483647 */
} 
```

# loops - 装配中的循环

> ID：16026625
> 
> 赞同：1
> 
> 时间：2013-04-16T00:03:55.587
> 
> 标签：loops, assembly, x86

我是汇编编程的菜鸟，我需要对以下类型的循环（@@、@B、@F）进行一些澄清。

当你有这样的例程时：

```
Routine: PROC  Value: Byte
         MOV   ECX, 3
         MOVZX EDX, Value
         MOV   EAX, EDX
     @@: SHL   EAX, 8
         OR    EAX, EDX
         LOOP @B
         RET
Routine: ENDP 
```

，@@、@B 是什么意思？

正如我被告知的那样，这些循环有一些特殊性。@B 指向例程中的第一个@@，@F 指向例程中的最后一个@@，对吗？关于这些循环还有什么我应该知道的吗？（我还被告知，每当它们出现时，循环就会进行 3 次，但我不确定）。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:00:10.610

@@ 是本地标签。您可以将它放在程序中的任何代码行上。在您定义下一个@@ 标签之前它是有效的。（不是“第一个”或“最后一个”，只是上一个和下一个）。

@b 表示“先前（早期源代码行）定义的@@ 标签”。@f 表示“下一个定义的@@ 标签”。

循环执行三次，因为“LOOP”指令在每次迭代时（隐式）递减 ECX，如果 ECX 中的剩余值不为零，则分支......并且您最初使用 3 的值加载 ECX。

如果你想了解代码是如何工作的，你应该使用 MS Assembler 来组装它，然后单步执行它，边看边看寄存器。或者，非常仔细地手动阅读英特尔指令集。（当我第一次开始为 x86 编程时，我做了很多这样的事情，即使是对于那个巨大的文档，每一分钟都是值得的）。

# php - PHP Web 应用程序将占用大量内存。如何设置限制或存储该内存？

> ID：16026627
> 
> 赞同：-4
> 
> 时间：2013-04-16T00:04:02.177
> 
> 标签：php, memory

我即将启动的 PHP Web 应用程序将占用大量内存。

如何设置限制以告诉它在达到某个点时停止？什么是好的限制？

它占用大量内存，因为它是递归的，但我限制了它可以从初始调用之一进行多少递归调用。

但是，我仍然想要一个内存上限。我怎样才能做到这一点？

我可以在用户机器上而不是在服务器上使用任何类型的本地存储吗？还是这样做不合适？

**更新：我的大部分问题都在第一个答案中得到了解答，但我仍然想知道如何在 PHP 中设置内存限制。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:09:13.460

这个问题的正确答案取决于您对需求的描述。说你的应用程序是递归的是非常通用的，并没有告诉我们很多关于你想要实现的目标。

就个人而言，我会接收用户输入，如果我知道对用户的响应将是大量数据，我会确保我的服务器在独立于 API 请求的处理队列中完成所有繁重的工作。用户不必等待很长时间才能得到响应。因此，您让后端处理此递归方法并将结果存储到缓存文件中，或缓存块并将它们以块的形式提供给用户。

这是非常通用的，但由于我们并不真正知道您的实际目标是什么，所以我只能说它。

随时更新您的问题的具体细节，也许我会更新我的答案以更好地满足您的需求。

是的，您可以为用户存储在本地。查看 html5 本地存储。请参阅此答案：[localstorage 是否是此 webapp 的正确选择？](https://stackoverflow.com/questions/11217313/is-localstorage-the-right-choice-for-this-webapp) 将网络应用程序存储在本地是很常见的，这样应用程序就可以离线运行或在服务质量差的地区运行。想想服务通常很差或不可用的会议中心或大型结构。仅当您愚蠢地尝试以易于访问的方式存储私人数据时，不适当才适用。否则，这只是使用您的应用程序所带来的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T00:09:21.213

首先，PHP*只*在服务器上执行。因此，关于“在用户机器上”的最后一段与 PHP 内存问题完全无关。

其次，您应该知道递归算法的局限性！它应该停止，当它*应该*停止时 - 也就是。当它达到递归算法的[**基本情况时。**](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29#Recursive_functions_and_algorithms)您实际上并不是在询问设置 PHP 的内存限制以控制程序的运行方式，对吗？仅仅因为您正在调用递归函数并不意味着您的应用程序可以保证使用大量内存。

最后，如果您确信您的 PHP 脚本的行为符合您的预期，但它只是需要比允许的更多的内存，您可以增加限制。有很多[很多](https://stackoverflow.com/search?q=php%20memory%20limit)关于如何做到这一点的问题。

# c++ - 这个继承的类会调用哪个方法（虚函数）？C++

> ID：16026629
> 
> 赞同：2
> 
> 时间：2013-04-16T00:04:20.343
> 
> 标签：c++, inheritance, virtual

说我有一个基类

```
class Base
{

public:
void A() {do stuff};
void B() {A(); do stuff};
}; 
```

和一个派生类

```
class Derived : public Base
{
public:
void A() {do things}
};

Derived derived1;
derived1.B(); 
```

B会调用基类的A还是派生类的A？

我怀疑 B 会调用基类的 A，为了让它使用新的重新定义的 A，我必须使它成为虚拟的：

```
class Base
{

public:
virtual void A() {do stuff};
void B() {A(); do stuff};
}; 
```

那是对的吗？这就是虚函数的用途吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:06:48.653

是的，在这两个方面都正确...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:11:06.180

尝试这个

```
class Base
{
public:
virtual void A() {do stuff};
void B() { do stuff};
};

class Derived : public Base
{
public:
void A() {do things}
void B() {do things}
}; 
```

和

```
Derived d;
Base *p = &d;
p->A();
p->B(); 
```

函数 B 不会被覆盖

# java - 谷歌静态地图 API - 创建具有 1000 个点的图像

> ID：16026632
> 
> 赞同：1
> 
> 时间：2013-04-16T00:04:41.547
> 
> 标签：java, google-maps

我想生成一个绘制了数千个点的静态谷歌地图。

静态地图：[https ://developers.google.com/maps/documentation/staticmaps/](https://developers.google.com/maps/documentation/staticmaps/)

url 格式将很快达到 URL 长度限制。所以这行不通。有什么方法可以发送 XML 文档或具有所有要点的东西？

可以这样做吗？

我的主要愿望是获得可以在 PDF 报告中使用的图像文件。但我不知道如何从**服务器端**的动态报告生成图像。静态地图 API 的美妙之处在于我可以从 Web 服务器生成图像。

任何解决方案都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:30:10.650

尽管可能存在，但我还没有看到让您发送带有静态地图请求的随附文件的方法。

您可以使用动态地图吗？javascript API 易于获取，并且可以非常简单地在地图上添加标记/点。根据我的经验，这将允许您添加任意数量的积分，但在进入 1000 时可能会变得很慢。

# google-maps-api-3 - 如何在不提示用户允许或拒绝使用其位置的请求的情况下使用 Google 地图查找用户的位置

> ID：16026634
> 
> 赞同：0
> 
> 时间：2013-04-16T00:05:21.577
> 
> 标签：google-maps-api-3

我正在尝试找出查找用户位置的最佳方法，而不提示他们访问我的网站以允许或拒绝我查找其位置的请求。

这方面的一个例子是访问 google.com/maps，它会立即提取您的位置而不提示您。

另一个示例是foursquare.com，它无需提示用户访问即可找到您的位置。

我相信这是严格基于 IP 的，但是我在为此找到合适的代码时遇到了问题，而且地理位置并没有起到作用。

有人有建议吗？这将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:09:18.600

您可以使用`google.loader.ClientLocation`Google [API Loader](https://developers.google.com/loader/)获取大致位置而无需提示。但是，[不能保证这将](https://code.google.com/p/google-ajax-apis/issues/detail?id=586#c6)长期有效。

这是一个演示它的[小提琴](http://jsfiddle.net/geary/X8yTL/2/)。

# python - Python删除分隔空格

> ID：16026640
> 
> 赞同：2
> 
> 时间：2013-04-16T00:06:29.867
> 
> 标签：python

你可能听说过，也可能没有听说过 Python IRC 机器人 Willie。

我有一个 trigger.group(2) 对象：

```
'J O I N   : # S t a f f' 
```

我如何使它成为：

```
'JOIN :#Staff' 
```

编辑：基本上我想删除字符之间的空格而不删除“真实”空格`N :`。请注意，该命令可以是具有任意数量参数的任何内容：`PRIVMSG`、`OPER`等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T00:08:41.650

由于您有交替的空格和非空格，请尝试每隔一个字符：

```
s = s[::2] 
```

例子：

```
>>> 'J O I N   : # S t a f f'[::2]
'JOIN :#Staff' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T02:35:18.830

```
>>> import re
>>> text = 'J O I N   : # S t a f f'
>>> re.sub(r'(?<=\S)\s|\s(?=\S)', '', text)
'JOIN :#Staff' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:11:12.020

```
def rmspace_separate(string, spacelimiter=' '*2):
    return ' '.join(s.replace(' ', '') for s in s.split(spacelimiter)) 
```

会工作。更改`spacelimiter`以满足您的需求。

# c++ - 将数据从向量写入文件。C++

> ID：16026646
> 
> 赞同：0
> 
> 时间：2013-04-16T00:07:18.953
> 
> 标签：c++

我有 Shapes 类和 gShapes 向量。我正在像这样将对象形式向量写入文件。

```
char* str;
vector<Shape*>::iterator it;
for( it = gShapes.begin(); it != gShapes.end(); it++ )
{       
    str = reinterpret_cast<char*>(reinterpret_cast<void*>(*it));
    saveFile.write(str, sz);
} 
```

在我在我的类中添加动态内存之前它工作得很好，现在这段代码将指针写入文件而不是数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T00:10:32.060

总是[除了在极其罕见的情况下，只是为了满足那些会指出那些极其罕见的情况存在的学究]，当将数据存储到文件时，需要“序列化”数据 - 换句话说，存储在“平面”中格式 - 不是指针、引用或其他间接形式。

因此，如果您的 中有一个指针`Shape`，那么您需要“解开”该指针，就像您使用 a`operator <<`为您的对象打印内容一样。

# windows - 如何在不冻结 GUI 的情况下执行 For 循环？

> ID：16026648
> 
> 赞同：0
> 
> 时间：2013-04-16T00:07:46.350
> 
> 标签：windows, vb.net, for-loop

我想知道如何以不冻结 GUI 的方式运行以下循环，因为循环可能需要几分钟才能完成。谢谢你。

```
For i = 0 To imageCount
         'code
Next 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:13:41.637

简短的回答是你在另一个线程上运行循环。长的答案是一整本书和几个学期的大学，因为它需要资源访问冲突以及解决它们的各种方法，例如锁定和排队。

由于您似乎在使用 VB.NET，我建议您使用最新版本的 .NET 框架并利用 Async 和 Await，您可以从 MSDN 中了解这些信息。

这些关键字实现了一个非常复杂的罐头解决方案，可以让您在无知背后的噩梦中实现您的目标:)

* * *

**为什么有经验的并行编码人员会为 async/await 烦恼**

async/await 的突出特点是

*   根据需要自动临时编组回 UI 线程
*   异常处理程序的范围（try/catch/finally）可以跨越设置和回调代码
*   你在 UI 线程上编写了带有阻塞调用的概念上的线性代码，但是因为你使用“await”声明了阻塞的调用，编译器将你的代码重写为状态机，使前面的观点成立

带有阻塞调用的线性代码易于编写和阅读。因此，从维护的角度来看，它要好得多。但它提供了一个糟糕的用户体验。异步/等待意味着你可以同时拥有它。

这一切都建立在 TPL 之上；在非常真实的意义上，它只不过是编译器支持的 TPL 设计模式，这就是为什么标记为 async 的方法需要返回一个`Task<>`. 有很多值得喜欢的地方，而且我没有看到任何技术上的缺点。

我唯一担心的是它*太好了*，所以整整一代人都不知道他们站在谁的肩膀上的巨人有多高，就像大多数现代程序员对调用堆栈中堆栈帧的机制只有模糊的认识（背后的魔力）局部变量）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T00:18:06.253

您可以在单独的线程上运行循环。`BackgroundWorker`在此处阅读有关使用[http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

# java - 跳过 fqdn 的 url 编码

> ID：16026654
> 
> 赞同：0
> 
> 时间：2013-04-16T00:08:38.723
> 
> 标签：java, url, url-encoding

我有一个关于 url 编码的问题。尝试对 url 进行编码，但无法使其正常工作。试过 java.net.URLEncode。

我有网址[http://msnbcmedia4.msn.com/i/MSNBC/Components/Photo/_new/130409_luke](http://msnbcmedia4.msn.com/i/MSNBC/Components/Photo/_new/130409_luke) hancock.jpg 我需要对其进行编码。从在线论坛我的理解是，我应该只编码查询参数和 url 路径，不包括 fqdn（[http://msnbcmedia4.msn.com](http://msnbcmedia4.msn.com)）。我是否需要编码（/ 在 url 路径中，? 和 & 在参数中）或跳过编码这些。我正在尝试使用 java 从这个特定位置下载内容。任何信息，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T01:07:26.443

`URLEncoder`是正确的选择。您只需编码单个查询字符串参数名称/值，而不是整个 URL。如果您对整个 URL 进行编码，那么它将对 Http 和其他我们不想要的 URL 部分进行编码。

看看这个很棒的答案>> [https://stackoverflow.com/a/10786112/2093375](https://stackoverflow.com/a/10786112/2093375)

问候，

# javascript - 如何在 JSPerf 中对缓存的 jQuery DOM 选择进行基准测试？

> ID：16026659
> 
> 赞同：2
> 
> 时间：2013-04-16T00:08:55.633
> 
> 标签：javascript, jquery, html

我正在尝试测试缓存我的 DOM 选择（将选择分配给 var）在我的旧 JS 代码上的执行情况。我尝试使用 JSPerf，但它似乎只是在循环中运行所有内容，这意味着我的 var 分配被重复了数千次。我怎样才能解决这个问题？

[JSFiddle](http://jsfiddle.net/for3v3rforgott3n/Y5w5r/6/)用于我更新的代码

基准测试脚本（旧代码）#1：

```
$('.projectscontainer').on("click", "span.destproject", function () {
    $(this).siblings('.projectschildren').toggle().end().siblings('div.destarrow').toggleClass("arrow-right arrow-down");
}).on("click", "div.destarrow", function () {
    $(this).parent().find("span.destproject").trigger("click");
});

$('body').on("click", "span#expandcollapse", function () {
    if ($(this).text() === 'Expand All') { //Currently collapsed
        var startTime = new Date().getTime();
        $('.projectscontainer').find("div.destarrow").filter('.arrow-right').toggleClass("arrow-right arrow-down");
        $('.projectscontainer').find(".projectschildren").toggle(true);
        var endTime = new Date().getTime();
        console.log('Action took: ' + (endTime - startTime) + 'ms');
    } else { //Currently expanded            
        var startTime = new Date().getTime();
        $('.projectscontainer').find("div.destarrow").filter('.arrow-down').toggleClass("arrow-down arrow-right");
        $('.projectscontainer').find(".projectschildren").toggle(false);
        var endTime = new Date().getTime();
        console.log('Action took: ' + (endTime - startTime) + 'ms');
    }
    $(this).text(function (i, currentText) {
        return currentText === 'Expand All' ? 'Collapse All' : 'Expand All';
    });
}); 
```

基准测试脚本（新代码）#2：

```
var projectscontainer = $('body').find('div.projectscontainer');
var projectschildren  = projectscontainer.find("div.projectschildren");
var destarrows        = projectscontainer.find("div.destarrow");
var srcprojects       = projectscontainer.find("div.srcprojects");

projectscontainer.on("click", "span.destproject", function (){
    $(this).siblings('div.projectschildren').toggle().end().siblings('div.destarrow').toggleClass("arrow-right arrow-down");
}).on("click", "div.destarrow", function (){
    $(this).parent().find("span.destproject").trigger("click");
});

$('body').on("click", "#expandcollapse", function (){
    if($(this).text() === 'Expand All'){//Currently collapsed
        var startTime = new Date().getTime();
        destarrows.filter('div.arrow-right').toggleClass("arrow-right arrow-down");
        projectschildren.toggle(true);
        var endTime = new Date().getTime();
        console.log('Action took: ' + (endTime - startTime) + 'ms');
    } else {//Currently expanded            
        var startTime = new Date().getTime();
        destarrows.filter('div.arrow-down').toggleClass("arrow-down arrow-right");            
        projectschildren.toggle(false);
        var endTime = new Date().getTime();
        console.log('Action took: ' + (endTime - startTime) + 'ms');
    }
    $(this).text(function(i, currentText){
        return currentText === 'Expand All' ? 'Collapse All' : 'Expand All';
    });
}); 
```

JSPerf 基准测试最终会运行这些行

```
var projectscontainer = $('body').find('div.projectscontainer');
var projectschildren  = projectscontainer.find("div.projectschildren");
var destarrows        = projectscontainer.find("div.destarrow");
var srcprojects       = projectscontainer.find("div.srcprojects"); 
```

一遍又一遍（连同所有其他代码），而在我的原始代码中，它只运行一次。如何让它只运行一次而不是重复运行？

# java - 如何使用 ant 命令在 Eclipse 中执行现有的构建文件？

> ID：16026663
> 
> 赞同：0
> 
> 时间：2013-04-16T00:09:03.673
> 
> 标签：java, eclipse, ant, build

我是 StackOverflow 的初学者和新手。

在包含一个包的根文件夹中，我有一个构建文件“build.xml”。我希望在 Eclipse 中使用命令“ant”执行构建文件。文件夹中的示例：

lklk>src>11>"Insert.java","Sort.java","build.xml"

现在，在终端中，我们只需键入“ant”，项目就会内置到 jar 文件中。

我如何在 Eclipse 中做同样的事情？

请注意：下面的答案可能是正确的，但构建文件没有显示在那里！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:42:12.067

右键单击 build.xml 文件。选择：运行方式 > Ant 构建。

另请注意，您不应将构建文件放在 src 包中。我觉得`build.xml`应该是同级的`src`，不在里面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:12:23.537

> 窗口 > 显示视图 > ant > 添加 build.xml > 点击播放按钮

# javascript - 如何从 writeStream 中获取文件名？

> ID：16026669
> 
> 赞同：5
> 
> 时间：2013-04-16T00:09:32.500
> 
> 标签：javascript, node.js, stream

这是我想做的事情：

```
stream = fs.WriteStream('crap.txt',{flags:'w'};
// more code
response.on('close',function() {
      // is the below line possible?
      fs.stat(stream.name, function(stats) {
            console.log(stats.size);
      });
      stream.end();
}); 
```

那么我可以从流对象中获取文件名吗？一个有插图的例子会很好，参考关于可写流的好的教程/文档（包含例子）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T00:16:36.763

这是`fs.createWriteStream`和`stream.path`

你可以`console.dir(stream)`找到它的所有属性

# jquery - JSON - 通过 soundcloud 动态使用 oembed

> ID：16026672
> 
> 赞同：0
> 
> 时间：2013-04-16T00:09:57.527
> 
> 标签：jquery, ajax, json, soundcloud, oembed

我希望能够不断获得使用 json 的 oembed 的用户的最后 10 首曲目。

```
$.getJSON("http://soundcloud.com/oembed", 
          {url: "https://soundcloud.com/aviciiofficial", format: "json"},
function(data)
{
    console.log(data.html);
}) 
```

Data.html 返回 soundcloud 播放器的 html 代码，但该播放器包含一个包含所有用户曲目的曲目集。我希望能够单独获取曲目（例如：data[0].html）。如何获取所有最新曲目的数组？

控制台输出：

```
<iframe width="100%" height="450" scrolling="no" frameborder="no" src="https://w.soundcloud.com/player/?url=http%3A%2F%2Fapi.soundcloud.com%2Fusers%2F1861068"></iframe> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T08:49:21.240

您需要做的是发出 API 请求来检索用户的曲目，没有`oembed`端点会返回嵌入列表。

**升级版**。

因此，为了显示艺术品小部件，您需要遍历数组，并将 API_URL 和 COLOR 替换为每个项目的 API url 和您想要的颜色（也许您实际上可以为所有这些小部件设置一次颜色）。

```
'<object height="300" width="300">' + 
  '<param name="movie" value="https://player.soundcloud.com/player.swf?url={{API_URL}}&amp;color={{COLOR}}&amp;auto_play=false&amp;player_type=artwork">' +      
  '</param>' +
  '<param name="allowscriptaccess" value="always"></param>' +
  '<embed allowscriptaccess="always" width="300" height="300" ' + 
    'src="https://player.soundcloud.com/player.swf?url={{API_URL}}&amp;color={{COLOR}}&amp;auto_play=false&amp;player_type=artwork" ' +
    'type="application/x-shockwave-flash">' + 
  '</embed>' + 
'</object>'; 
```

我之前在以下答案中对此进行了描述 - <a href="https://stackoverflow.com/questions/15398646/retrieve-soundcloud-search-results-and-embed-results/15417219#15417219">检索 Soundcloud 搜索结果并嵌入结果，仅在 HTML5 小部件的上下文中。

# textarea - 内容未显示在文本区域中？

> ID：16026675
> 
> 赞同：2
> 
> 时间：2013-04-16T00:10:32.333
> 
> 标签：textarea

我有一个 textarea，由于某种原因，当我尝试在我的 textarea 的左括号和右括号之间添加文本时，无论我使用 html 内容还是 php 回显内容，它都不会显示。

如果我将内容放在占位符中，它会起作用，有人知道为什么会这样吗？

```
<form action="includes/changebio.php" method="post" id="form1">         
 <textarea id="bio" style="width: 440px; 
    margin-top:3px;
    text-align:left;
    margin-left:-2px;
    height: 120px;
    resize: none; 
    outline:none;
    overflow:scroll;
    border: #ccc 1px solid;"
    textarea name="bio" data-id="bio" 
    maxlength="710" 
    placeholder="<?php echo stripslashes($profile['bio']); ?>" rows="10">
 </textarea>
<input type="image" src="assets/img/icons/save-edit.png"
       class="bio-submit" name="submit" value="submit" id="submit"/>
</form> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-06T10:18:17.077

尝试向`name="textarea-name"`textarea 添加一个属性（即使你没有用它）

**编辑**：

我已经测试了`<textarea name="bio">textarea content</textarea>`一段代码并得出结论（尽管看起来很奇怪），如果 textarea 名称是`bio`，则内容不会在 Firefox 中显示，尽管如果使用 Firebug 或类似工具检查该元素，它就会出现。

这似乎是由我的一个附加组件引起的，因为它是由其他浏览器正确显示的 textarea 内容，并且在使用全新的 Firefox 配置文件时。

不过我还没有进一步调查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-06-24T00:25:04.110

对我有用的最简单的方法：

**而不是这样做： -**

```
<textarea name="scenario" value="<?php echo $scenario?>"> </textarea> 
```

**像这样做：-**

```
<textarea name="scenario"> <?php echo $scenario?> </textarea> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-28T08:45:05.857

我有类似的问题！当我使用 ajax 更改内容时，Chrome 和 Firefox 什么也没显示，但 IE 显示正确。如果使用 Firebug 或类似工具检查元素，会出现什么奇怪的内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T00:32:19.940

你有额外的`textarea`样式标签。这是代码。

```
<form action="includes/changebio.php" method="post" id="form1">         
<textarea id="bio" style="width: 440px; 
 margin-top:3px;
 text-align:left;
 margin-left:-2px;
 height: 120px;
 resize: none; 
 outline:none;
 overflow:scroll;
 border: #ccc 1px solid;" name="bio" data-id="bio" maxlength="710"
placeholder="<?php   echo stripslashes($profile['bio']); ?>" rows="10"><?php echo stripslashes($profile['bio']); ?></textarea>
<input type="image" src="assets/img/icons/save-edit.png"class="bio-submit" name="submit"  value="submit" id="submit"/>
</form> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-23T12:33:05.927

我也遇到了类似的问题并通过这样做解决了**它**：

{{\App\ArtObject::find($id)->description}}

早些时候我有：描述}}">

后一种情况没有**按**预期显示值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-07T04:33:27.957

如果您的问题与我的问题相同，我在两个标签之间放置了一个包含 1500 个字符的字符串变量作为 Web 内容，并且仅部分出现在页面的 Textarea 内。只显示了大约 900 个字符。最后的很大一部分丢失了。然后，您可以尝试对我有用的方法，我使用了 htmlspecialchars() 函数，如下所示：

```
<TEXTAREA><?php echo htmlspecialchars($pgCont); ?></TEXTAREA> 
```

我仍然不知道为什么可能需要这个函数来显示字符串变量的全部内容。也许，出于安全原因。

# c# - 在表达式树/迭代表达式树中查找方法调用

> ID：16026681
> 
> 赞同：1
> 
> 时间：2013-04-16T00:11:19.077
> 
> 标签：c#, .net, linq, expression-trees

我需要在表达式树中找到对特定方法的所有调用，这可能非常复杂。目前我有简单的递归代码来检查 BinaryExpression、ConditionalExpression 等，当然还有 MethodCallExpression。它有效，但我想知道是否有更简单的方法？

我需要的是复杂表达式中所有 MethodCallExpression 的迭代器，因此我可以只检查 MethodCallExpression 而不必关心树中的其他类型的表达式。例如在 System.Linq.Expressions 中的某个地方有类似这样的内置功能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:26:25.553

正如 svick 正确指出的那样：使用 ExpressionVisitor 基类：

[http://msdn.microsoft.com/en-us/library/system.linq.expressions.expressionvisitor.aspx](http://msdn.microsoft.com/en-us/library/system.linq.expressions.expressionvisitor.aspx)

如果您想自己动手或看看 ExpressionVisitor 是如何工作的，在这篇文章中，Matt Warren 向您展示了如何通过访问每个节点来*重建*表达式树。

[http://blogs.msdn.com/b/mattwar/archive/2007/07/31/linq-building-an-iqueryable-provider-part-ii.aspx](http://blogs.msdn.com/b/mattwar/archive/2007/07/31/linq-building-an-iqueryable-provider-part-ii.aspx)

你不需要*重建*它，你只需要*搜索*它。您可以修改 Matt 的代码，使其不返回新的重建表达式，它只是递归搜索每个子节点。

# python - 试图为 python 程序的桌面背景找到我的目录

> ID：16026684
> 
> 赞同：0
> 
> 时间：2013-04-16T00:11:32.460
> 
> 标签：python, background, directory, desktop

现在有没有人如何找到存储我的桌面背景的目录，或者它只是存储在我用于我的 BG 的实际图像的位置

这是我希望保存图像并成为运行 Windows XP 的我的桌面 BG 的代码

```
import os
import sys
import time
import Image
import ImageGrab

import webbrowser
webbrowser.open_new(input("Gimme URL: "))

SaveDirectory=r'C:\Documents and Settings\User\My Documents\My Pictures'
ImageEditorPath=r'C:\WINDOWS\system32\mspaint.exe'
img=ImageGrab.grab()
box = (100, 100, 400, 400)
region = img.crop(box)
saveas=os.path.join(SaveDirectory,'ScreenShot_'+time.strftime('%Y_%m_%d_%H_%M_%S')+'.png')
img.save(saveas)
editorstring='""%s" "%s"'% (ImageEditorPath,saveas) 
os.system(editorstring) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T03:28:55.517

请参阅[此食谱](http://code.activestate.com/recipes/435877-change-the-wallpaper-under-windows/)及其评论。您可以通过 Windows API 使用 Python 设置桌面背景，但有一些注意事项。

# c# - 在 Visual Studio 中：尝试删除注册表项但“不允许请求的注册表访问”

> ID：16026685
> 
> 赞同：0
> 
> 时间：2013-04-16T00:11:32.467
> 
> 标签：c#, registry

我已经搜索了很长一段时间来解决这个问题。至少我认为我理解这个问题，但我还没有找到任何解决方案。

我需要的是某种可执行文件或删除某些注册表项的脚本。问题是有问题的注册表项仅授予对 SYSTEM 的读/写访问权限，而没有其他人。我可以删除它们的唯一方法是进入 regedit，将自己设置为所有者，最后将完全控制权设置给每个人。只有这样才能删除密钥。我需要这个过程在某种脚本中！

所以在 C# 中，我首先要确保软件具有管理权限。然后我尝试执行以下操作。

```
 RegistryKey reg_localmachine = RegistryKey.OpenRemoteBaseKey(Microsoft.Win32.RegistryHive.LocalMachine, "");
    RegistryKey key = reg_localmachine.OpenSubKey(@"SYSTEM\path to subkey", true); 
```

在第二行，当我尝试使用写访问权限访问子键时，我收到异常“请求的注册表访问权限不被允许”。为了让我更改所有者或授予权限，我需要在 RegistryKey 上执行 SetAccessControl()。为了设置访问控制，我需要密钥的写入权限。所以我陷入了这个悖论。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:57:03.883

安全是有原因的。

您不希望任何旧程序能够进入并开始在注册表中进行黑客攻击。

注册表中的每个条目都有自己的一组[DACLS](http://msdn.microsoft.com/en-au/library/windows/desktop/aa446597%28v=vs.85%29.aspx)。只有两种解决方案：-

1.  将运行程序的帐户更改为有权删除注册表项的帐户。

2.  更改注册表项上的[DACLS](http://msdn.microsoft.com/en-au/library/windows/desktop/aa446597%28v=vs.85%29.aspx)以包括您的程序正在运行的帐户。

# java - 如何实现 epsilon 转换？

> ID：16026687
> 
> 赞同：1
> 
> 时间：2013-04-16T00:11:43.170
> 
> 标签：java, parsing, cyk

我目前正在尝试使用 epsilon 转换[实现 CYK 。](http://en.wikipedia.org/wiki/CYK_algorithm)提供的算法如何处理 epsilon 转换？如果不是，您将如何实施它？（我正在使用 Java）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:59:50.427

您正在寻找的答案在[这里](http://www.cs.nyu.edu/courses/fall07/V22.0453-001/cnf.pdf) 它所说的是任何 epsilon 转换都可以表示为更少的简单转换。epsilon 转换是模棱两可的。为了在计算上覆盖这种模糊性，您需要从给定的转换中生成所有可能的结果。

示例 1：

```
A -> aA | e 
```

是

```
A-> a
A-> aA 
```

示例 2：

```
B->A b A
A->a | e 
```

是

```
B -> z | A z | z A | A z A
A -> a 
```

其中 e 代表 ε (epsilon) 跃迁

您可以看到，您必须从 epsilon 转换中生成所有可能的结果才能覆盖歧义。我认为如何通过计算来表达歧义是很有趣的。

来源例如 2[这里](http://eli.thegreenplace.net/2010/02/08/removing-epsilon-productions-from-context-free-grammars/)

# php - 如何用PHP计算一个单词在网页上出现的次数

> ID：16026690
> 
> 赞同：0
> 
> 时间：2013-04-16T00:12:07.250
> 
> 标签：php

我需要一个脚本来返回指定单词出现在网页上的次数。有谁知道如何用 PHP 做到这一点？代码将是这样的：

```
<?php
$url="watever.com";
the script here
echo(result);
?> 
```

我确实有一点点，它只是计算网页上每个单词出现了多少次，但我不太确定如何只为一个单词修改它。

```
$str = file_get_contents('http://www.example.com/');
print_r(array_count_values(str_word_count(strip_tags(strtolower($str)), 1))); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:17:51.010

我认为您正在寻找[**substr_count**](http://de3.php.net/manual/en/function.substr-count.php)。

> substr_count - 计算子字符串出现的次数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:18:24.980

尝试使用[substr_count](http://php.net/manual/en/function.substr-count.php)：

```
$result = (substr_count(strip_tags($str),"mycoolword")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:18:33.033

研究使用 preg_match - [http://php.net/manual/en/function.preg-match.php](http://php.net/manual/en/function.preg-match.php)

其中一个参数是 $matches，如果传递了它会将所有匹配项放入该数组中，因此您可以通过执行 count($matches) 来获得计数。

php页面有很好的例子，这里有一个：

```
<?php
$subject = "abcdef";
$pattern = '/^def/';
preg_match($pattern, $subject, $matches, PREG_OFFSET_CAPTURE, 3);
print_r($matches);
?> 
```

# python - 用于 Google 应用引擎前瞻性搜索的测试平台存根

> ID：16026703
> 
> 赞同：0
> 
> 时间：2013-04-16T00:13:36.683
> 
> 标签：python, google-app-engine

[我的问题与Google App Engine 'search' 的 Testbed 存根](https://stackoverflow.com/questions/10872009/testbed-stub-for-google-app-engine-search)基本相同，但对于 'prospective search' 服务。

我正在尝试对使用前瞻性搜索的应用程序进行一些单元测试，我得到：

```
AssertionError: No api proxy found for service "matcher" 
```

我查看[了支持的存根列表](https://code.google.com/p/googleappengine/source/browse/trunk/python/google/appengine/ext/testbed/__init__.py#172)、[文档](https://developers.google.com/appengine/docs/python/tools/localunittesting)和[问题跟踪器](https://code.google.com/p/googleappengine/issues/list?can=2&q=testbed&colspec=ID%20Type%20Component%20Status%20Stars%20Summary%20Language%20Priority%20Owner%20Log&cells=tiles)，但我没有发现任何有用的参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T23:26:03.403

一旦您找到预期搜索的[存根，Google App Engine“搜索”的测试床存根](https://stackoverflow.com/questions/10872009/testbed-stub-for-google-app-engine-search)上的公认答案已经指向正确的方向。

这样的存根可以在`google.appengine.api.prospective_search.prospective_search_stub`

我选择`SUPPORTED_SERVICES`在我的代码中修改列表，以便以后对 SDK 的更新不会破坏这一点。尽管我同意任何解决方案无论如何都是黑客攻击。

所以这一切就这样结束了。

在测试模块中：

```
from google.appengine.ext import testbed
    #Workaround to avoid prospective search complain until there is a proper
    #testbed stub
from google.appengine.api.prospective_search.prospective_search_stub \
    import ProspectiveSearchStub
PROSPECTIVE_SEARCH_SERVICE_NAME = "matcher"
testbed.SUPPORTED_SERVICES.append(PROSPECTIVE_SEARCH_SERVICE_NAME) 
```

而在`def setUp(self):`

```
ps_stub = ProspectiveSearchStub('./ps.txt', None)
self.testbed._register_stub(PROSPECTIVE_SEARCH_SERVICE_NAME, ps_stub) 
```

# python - 在 Windows XP 中使用 PyParallel

> ID：16026706
> 
> 赞同：0
> 
> 时间：2013-04-16T00:13:44.587
> 
> 标签：python, python-2.7, windows-xp, parallel-port

我已经在 Linux 和 Mac OSX 中成功实现了 PyParallel 模块，作为与我正在开发的传感器接口的大型应用程序的一部分。我现在正尝试在 Windows XP 实例上使用这个应用程序。我发现了几个参考资料（包括来自 PySerial/PyParallel 组的资料）：

> windows 版本需要一个已编译的扩展和用于 Windows NT/2k/XP 的 giveio.sys 驱动程序。它使用 ctypes 来访问预构建的 DLL 中的函数。

但是，我不知道什么是“编译扩展”要求。而且，我似乎无法让 givio.sys 工作。[我在这里](http://www.cs.ucr.edu/~eblock/pages/pictools/giveio.html)获得了 giveio.sys并遵循了建议，但是 LoadDrv.exe 无法“启动”该服务（但是它确实“安装”了）。

我无法在网上找到让 PyParallel 在 Windows XP 上运行的具体示例。由于 PyParallel 已“彻底”集成到应用程序中，并且可以在 Linux 和 Mac OSX 上运行，因此我不希望使用不同的模块——特别是因为 PyParallel 非常棒，不需要 root/管理员权限即可使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-05T18:00:32.073

我也遇到了 giveio.sys 和 LoadDrv.exe 的问题。

有一个方便的安装程序可以自动完成所有操作：

[http://sourceforge.net/projects/pyserial/files/pyparallel/giveio/](http://sourceforge.net/projects/pyserial/files/pyparallel/giveio/)

# jquery - 删除 div 之间的多余空间

> ID：16026712
> 
> 赞同：-4
> 
> 时间：2013-04-16T00:14:29.297
> 
> 标签：jquery, html, css

我有一组来自数据库（php和mysql）的图像（图像的高度不同），在输出中，每行下方都有一些额外的空间。我需要删除多余的空间。您可以查看此[http://screencast.com/t/khkvThvsgKR7](http://screencast.com/t/khkvThvsgKR7)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:20:52.573

Please provide next time your code. Don't post some link to image or site. Content of that link may change. Because of that your question is downvoted.

Here you can see CSS3 solution: [http://cssdeck.com/labs/css-only-pinterest-style-columns-layout](http://cssdeck.com/labs/css-only-pinterest-style-columns-layout)

And here is jQuery Masonry: [http://masonry.desandro.com/demos/images.html](http://masonry.desandro.com/demos/images.html)

P.S. Before everything, use Google. Try to find something, to learn, to understand. I can explain to you these examples, but I will leave that to you.

# c# - 在 C# 中，如何从另一个类中获取变量

> ID：16026714
> 
> 赞同：0
> 
> 时间：2013-04-16T00:15:03.220
> 
> 标签：c#, class, variables, get

我有一个包含几个类的 API。在一个类中，我想使用其他类的变量。我该怎么做呢？

谢谢！

```
public class Rain
{
    public decimal rainValueInCM;
    public decimal rainValueInMM;
   // public Dictionary<decimal, Temperature> Temperature = new Dictionary<decimal, Temperature>();

    public Rain(decimal cm)
    {
        rainValueInCM = cm;
    }

    public  decimal ConvertToCM(decimal mm)
    {   
        rainValueInCM = (mm / 10);
        return rainValueInCM;  
    } 
```

例如，在另一个类中，我想使用该类中的变量“rainValueInCM”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:25:49.380

Simply you have to create an instance of the class `Rain` and access it values this way:

```
public class Rain
{
    public decimal rainValueInCM;
    public decimal rainValueInMM;
   // public Dictionary<decimal, Temperature> Temperature = new Dictionary<decimal, Temperature>();

    public Rain(decimal cm)
    {
        rainValueInCM = cm;
    }

    public  decimal ConvertToCM(decimal mm)
    {   
        rainValueInCM = (mm / 10);
        return rainValueInCM;  
    }
}

public class AnotherClass
{
     public void SomeMethod() 
     {
         Rain myRain = new Rain(5); // create the instance
         // use the value
         decimal theValue = myRain.rainValueInCM;
     }
} 
```

Anyway I recommend you to read about [C# properties](http://msdn.microsoft.com/en-us/library/x9fsa0sw.aspx), since there isn't a good practice to expose as public your class value members. Gook luck!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:25:43.257

First you need a `getter` and `setter` for the `property`

```
public class Rain
{
    public decimal rainValueInCM { get; set; }
    ...
} 
```

Then instantiate an `object` of `type` `Rain` in the other `class` and get the `property`

```
public class MyOtherClass
{
    public void MyMethod() {
         Rain rain = new Rain();
         decimal cm = rain.rainValueInCM;
    }

} 
```

# mongoid - Mongoid，after_create钩子不能修改self

> ID：16026717
> 
> 赞同：3
> 
> 时间：2013-04-16T00:15:47.327
> 
> 标签：mongoid

下面的创建钩子没有成功设置 gdoc 键。我们必须`self.write_attribute`改用。我是在尝试做一些愚蠢的事情吗？

```
class GoogleDoc
  field :gdoc_key, type: String
  field :filename, type: String

  after_create :after_create_hook
  def after_create_hook
    self.gdoc_key =  "qwerty"
    self.save
  end
end 
```

谢谢！乔纳森

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T13:19:12.867

从[杜兰](https://github.com/durran)

您不能在`after_`挂钩中调用 save ，因为您将导致文档在无限循环中触发回调。您需要使用不会触发回调的东西，例如 update_attribute。

[https://github.com/mongoid/mongoid/issues/2974](https://github.com/mongoid/mongoid/issues/2974)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-10T22:31:04.667

你应该`gdoc_key`设置`before_create`

```
before_create :set_gdoc_key
def set_gdoc_key
  self.gdoc_key = 'qwerty'
end 
```

# ios - 如何将少量数据发送到大量 iPhone

> ID：16026728
> 
> 赞同：0
> 
> 时间：2013-04-16T00:17:24.870
> 
> 标签：ios, tcp, udp

我可以使用哪种协议将数据从服务器 (php) 发送到 iPhone？

我排除了 UDP，因为在蜂窝网络上，iPhone 不会为外部通信打开任何端口（出于显而易见的原因）。而且 TCP 数据量太大。我正在尝试找到一个使用最少数据且不对基础设施征税的中间产品。

我首先进行 API 调用以获取信息——然后在这一点上，我希望 iPhone 能够“监听”数据。然后我的服务器会将数据发送到所有正在监听的电话。

关于如何去做这件事的任何想法？或者这种联系是不可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:47:13.050

正如评论中所讨论的，一种解决方案是使用 Apple Push Notifications Service。

更多信息在这里： http: [//developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/ApplePushService/ApplePushService.html) [http://developer.apple.com/library/mac/#documentation/NetworkingInternet /Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingWIthAPS/CommunicatingWIthAPS.html)

# ios - 在 PhoneGap BarcodeScanner 上显示应用程序

> ID：16026729
> 
> 赞同：1
> 
> 时间：2013-04-16T00:17:29.470
> 
> 标签：ios, objective-c, cordova, phonegap-plugins, cordova-2.0.0

我希望将 PhoneGap 的 BarcodeScanner 插件与我的应用程序集成，但希望将其与现有的 HTML/JS（WebView 内部）集成得比目前允许的更紧密。

理想情况下，我希望看到 BarcodeScanner 的“相机捕获”视图出现在 PhoneGap 的主 WebView*下方*，这样我就可以将应用程序的控件分层（工具栏等）。

我遇到了来自 Moodstocks 的类似插件（[http://www.moodstocks.com/2013/04/03/augmented-reality-with-phonegap-sencha-touch/](http://www.moodstocks.com/2013/04/03/augmented-reality-with-phonegap-sencha-touch/)），它似乎通过给 WebView 一个透明背景并将其显示在相机视图上方。这个插件的源代码可以在这里找到（[https://github.com/Moodstocks/moodstocks-phonegap-plugin](https://github.com/Moodstocks/moodstocks-phonegap-plugin)），更具体地说（基于我用非常不了解的眼睛阅读代码！）在第 74-80 行MSScannerController.m ( [https://github.com/Moodstocks/moodstocks-phonegap-plugin/blob/master/ios/MSScannerController.m](https://github.com/Moodstocks/moodstocks-phonegap-plugin/blob/master/ios/MSScannerController.m) )。

所以我的问题是，首先，这可以实现吗？其次，我该如何修改PhoneGap插件来做到这一点？

任何指示或方向都会非常有帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T16:54:15.067

对于第一个问题，答案是肯定的——是的。

对于第二个问题，我们（我为 Moodstocks 工作）所做的是：

*   从 中分离 webview `MainViewController`，知道您可以通过插件检索 webview。在[MoodstocksPlugin.m 中，第 99-100 行](https://github.com/Moodstocks/moodstocks-phonegap-plugin/blob/2a90bbbc0a3ef6dcef562b32037a588bdaccb94d/ios/MoodstocksPlugin.m#L99-L100)显示了我们如何传递插件的引用：

*   将 webview 附加到当前视图控制器，这是我们的扫描仪控制器。[MSScannerController.m，第 46 行](https://github.com/Moodstocks/moodstocks-phonegap-plugin/blob/2a90bbbc0a3ef6dcef562b32037a588bdaccb94d/ios/MSScannerController.m#L46)显示了我们如何接管 web 视图：

我希望这能给你一些关于如何修改原始PhoneGap BarcodeScanner插件的想法，只是出于好奇，为什么不直接使用MoodstocksPlugin呢？;)

ps 这是一个[视频](http://www.moodstocks.com/2013/04/12/moodstocks-on-device-image-recognition-phonegap-plugin-sencha-touch-demo/)，展示了使用我们的插件制作的[Sencha Touch 演示](https://github.com/Moodstocks/moodstocks-sencha-demo-app)动画。

# android - 每天使用 alarmManager 设置不规则的闹钟

> ID：16026730
> 
> 赞同：0
> 
> 时间：2013-04-16T00:17:35.880
> 
> 标签：android, alarm

我想每天在特定时间设置通知/警报。请注意，这些时间可能每天都不同。例如，我有一个数据库，我每天可以从中获得 5 个不同的条目/时间，例如早上 6 点、下午 1.30 点、下午 4.30 点、晚上 7.30 点、晚上 10 点。我想为这些时间设置闹钟。第二天，这些时间可能会有所不同。它们可能会关闭 2-5 分钟或更长时间。基本上我不能每天在同一时间设置重复警报。我需要检查我的数据库中的条目，以了解我应该安排什么时间。

有什么好的和有效的方法来做到这一点。我查看了一些设置多个警报的堆栈溢出问题。但是在这里我该怎么做呢？我应该只阅读整个星期的数据库条目，即 5 次/天，共 7 天..并一起设置大约 35 个警报吗？或者我应该一次只设置一个闹钟。当该警报被触发时，只需从数据库中读取下一个条目并为该时间安排一个警报？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T06:39:10.877

编写一个服务，它将每天在特定时间从数据库中获取 5 个值。

然后在 AlarmManger 中添加多个具有不同唯一 ID 的条目。

**在特定时间添加警报：**

```
Calendar calendar = Calendar.getInstance();

//9 AM 
calendar.set(Calendar.HOUR_OF_DAY, 9);
calendar.set(Calendar.MINUTE, 0);
calendar.set(Calendar.SECOND, 0);
AlarmManager am = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);
PendingIntent pi = PendingIntent.getService(context, 0, new Intent(context, YourClass.class), PendingIntent.FLAG_UPDATE_CURRENT);
am.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), AlarmManager.INTERVAL_DAY, pi); 
```

**设置多个警报：**

```
AlarmManager[] alarmManager=new AlarmManager[24];
intentArray = new ArrayList<PendingIntent>();
for(f=0;f<arr2.length;f++){
   Intent intent = new Intent(AlarmR.this, Riciving.class);
   pi=PendingIntent.getBroadcast(AlarmR.this, f,intent, 0);

   alarmManager[f] = (AlarmManager) getSystemService(ALARM_SERVICE);
   alarmManager[f].set(AlarmManager.RTC_WAKEUP,arr2[f] ,pi);

   intentArray.add(pi);

} 
```

希望这应该有效。

# tfs - 可以将 Karma 与 TFS 构建一起使用

> ID：16026731
> 
> 赞同：19
> 
> 时间：2013-04-16T00:17:39.150
> 
> 标签：tfs, karma-runner

我是 Testacular（现在是 Karma）的新手。但我发现它非常强大，非常适合自动跨浏览器 JS 测试。所以我想知道是否可以将它用作 TFS 构建过程的一部分来进行自动 JS 代码单元测试？如果有人有以前的经验，请告诉我们要注意什么，以免我们走错路。

问候，君

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-03T01:31:39.690

Here is my pseudo code to run the karma in TFS using C# helper class. The basic idea is:

1.  Use C# unit test to test your js files using Karma.
2.  Capture the output of Karma to show that in your build log.
3.  Use separate process to run Karma.
4.  Pack all Karma files into a zip file, extract that into temporary folder for each build, so that builds with different version of karma wouldn't conflict with each other.
5.  Clean the temp folder after build.

-

```
namespace Test.Javascript.CrossBrowserTests
{
    public class KarmaTestRunner : IDisposable
    {
        private const string KarmaPath = @".\node_modules\karma\bin\karma";

        private string NodeBasePath { get; set; }
        private string NodeFullPath { get { return NodeBasePath + @"\node\node.exe"; } }
        private string NpmFullPath { get { return NodeBasePath + @"\node\npm.cmd"; } }

        public KarmaTestRunner()
        {
            ExtractKarmaZip();
            LinkGlobalKarma();
        }

        public int Execute(params string[] arguments)
        {
            Process consoleProcess = RunKarma(arguments);
            return consoleProcess.ExitCode;
        }

        public void Dispose()
        {
            UnlinkGlobalKarma();
            RemoveTempKarmaFiles();
        }

        private void ExtractKarmaZip()
        {
            NodeBasePath = Path.GetTempPath() + Path.GetRandomFileName();
            byte[] resourceBytes = Assembly.GetExecutingAssembly().GetEmbeddedResourceBytes(typeof(KarmaTestRunner).Namespace + "." + "karma0.9.4.zip");

            ZipFile file = ZipFile.Read(resourceBytes);
            file.ExtractAll(NodeBasePath);
        }

        private void LinkGlobalKarma()
        {
            ExecuteConsoleProcess(NpmFullPath, "link", "karma");
        }

        private Process RunKarma(IEnumerable<string> arguments)
        {
            return ExecuteConsoleProcess(NodeFullPath, new[] { KarmaPath }.Concat(arguments).ToArray());
        }

        private static Process ExecuteConsoleProcess(string path, params string[] arguments)
        {
            //Create a process to run karma with arguments
            //Hook up the OutputDataReceived envent handler on the process
        }

        static void OnOutputLineReceived(string message)
        {
            if (message != null)
                Console.WriteLine(message);
        }

        private void UnlinkGlobalKarma()
        {
            ExecuteConsoleProcess(NpmFullPath, "uninstall", "karma");
        }

        private void RemoveTempKarmaFiles()
        {
            Directory.Delete(NodeBasePath, true);
        }
    }
} 
```

Then use it like this:

```
namespace Test.Javascript.CrossBrowserTests
{
    [TestClass]
    public class CrossBrowserJSUnitTests
    {
        [TestMethod]
        public void JavascriptTestsPassForAllBrowsers()
        {
            using (KarmaTestRunner karmaRunner = new KarmaTestRunner())
            {
                int exitCode = karmaRunner.Execute("start", @".\Test.Project\Javascript\Karma\karma.conf.js");
                exitCode.ShouldBe(0);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-20T21:36:40.567

与最初的问答相比，发生了很多变化。

然而，我们已经通过运行 Grunt 任务让 Karma 在我们的 TFS 构建中运行（我相信 Gulp/无论你拥有什么任务运行器都可以做到这一点）。我们以前使用 C#，但最近发生了变化。

1.  运行`grunt build`任务。
2.  之后添加一个 Grunt 任务
3.  将文件路径指向您`gruntfile.js`并运行您的`test`任务。此任务将运行`karma:single`。grunt-cli 的位置可能是`node_modules/grunt-cli/bin/grunt`.

    `grunt.registerTask('test', [ 'karma:single' ]);`

4.  添加发布测试结果步骤。测试结果文件 =`**/*.trx`

[有关发布业力测试结果的更多信息](https://gooroo.io/GoorooTHINK/Article/17028/Karma-Test-Results-with-TFS-Build/25020#.WKtf0YbluUl)

# android - GCM 卡在 2.3.3 Gingerbread 设备上的寄存器上

> ID：16026736
> 
> 赞同：2
> 
> 时间：2013-04-16T00:17:58.057
> 
> 标签：android, google-cloud-messaging, android-2.3-gingerbread

出于某种原因，使用“GCMRegistrar.register(this, SENDER_ID);” 适用于 4.0 + 设备。但是，它停留在以下消息上，而没有收到来自 Google 的 GCM 通知。

“**注册发件人的应用程序（我的包）（我的api＃）** ”

1）清单和接收器应该是正确的，因为它在 4.2.1 上工作。

2) 我有 google play 并与 2.3.3 设备上的 google 帐户关联

我已经搜索了几天，找不到答案。任何人都知道出了什么问题或有同样的问题吗？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T22:22:42.493

我发现这只是因为我没有正确设置接收器的类别。

由于我将所有源代码放在一个库项目中并在每个单独的应用程序中引用它，因此我需要重命名清单中的 3 个不同位置。

1)

```
<permission
        android:name="digital.dispatch.mobilebooker.base.permission.C2D_MESSAGE"
        android:protectionLevel="signature" /> 
```

到

```
 <permission
        android:name="digital.dispatch.mobilebooker.(my app name).permission.C2D_MESSAGE"
        android:protectionLevel="signature" /> 
```

2)

```
<uses-permission
        android:name="digital.dispatch.mobilebooker.base.permission.C2D_MESSAGE" /> 
```

到

3)

```
<category android:name="digital.dispatch.mobilebooker.base" /> 
```

到

```
 <category android:name="digital.dispatch.mobilebooker.(my app name)" /> 
```

它在 4.0 + 设备中工作的原因是因为我只做了前两个而不是 3)。由于 4.0+ 设备不关心接收器的类别，因此它起作用了。但是，当我在 2.3.3 设备上进行测试时，该类别实际上很重要，导致它没有收到任何响应。

希望这会帮助遇到相同情况的任何其他人。

# c++ - cppreference 中 atomic_compare_exchange_weak 的示例代码是否正确？

> ID：16026740
> 
> 赞同：8
> 
> 时间：2013-04-16T00:18:15.847
> 
> 标签：c++, c++11

在[http://en.cppreference.com/w/cpp/atomic/atomic_compare_exchange](http://en.cppreference.com/w/cpp/atomic/atomic_compare_exchange)，以下示例代码作为示例使用`std::atomic_compare_exchange_weak`：

```
void append(list* s, node* n)
{
    node* head;
    do {
        head = s->head;
        n->next = head;
    } while(! std::atomic_compare_exchange_weak(s->head, head, n));
} 
```

我的理解是，这具有比较的效果，`*(s->head)`而`head`我认为需要的是`s->head`比较`head`。`std::atomic_compare_exchange_weak`这个例子中的第一个参数应该是`&(s->head)`，还是我错过了什么？

更新：规范`std::atomic_compare_exchange_weak`说：

```
bool atomic_compare_exchange_weak(volatile A* object, C * expected, C desired) noexcept;
bool atomic_compare_exchange_weak(A* object, C * expected, C desired) noexcept; 
```

> *效果*：以原子方式比较对象指向的内存内容...与预期的相等...

我认为这意味着与`*object`进行比较`expected`，但进一步的研究表明，实际含义是`*object`与进行比较`*expected`（即，“in `expected`”表示“指向`expected`”）。这意味着我最初问题的答案是“不，没有必要`s->head`在 cppreference 的示例代码中获取地址”。但是`object`必须指向 a`std::atomic<T>`并且预期必须指向 a的事实`T`使我很难弄清楚如何更正 cppreference 处的代码以便编译。我们想将列表的头部与列表头部的副本进行比较，但是如果列表的头部是 type `std::atomic<T>*`，那么`T*`如果调用`std::atomic_compare_exchange_weak`是编译，我找不到将 a 分配`std::atomic<T>*`给`T*`没有 a 的方法`reinterpret_cast`。即使这样，第三个参数 to`std::atomic_compare_exchange_weak`也需要是 type `T`，但是 cppreference 的示例显示第二个和第三个参数是相同的类型。这向我表明 cppreference 的示例已损坏。我试图修复它，但我被需要使用一个`reinterpret_cast`感觉不对的东西所阻碍。

有趣的是，在我试图弄清楚这些东西的过程中，我查看了[msdn 页面`std::atomic_compare_exchange_weak`](http://msdn.microsoft.com/en-us/library/vstudio/hh874646.aspx)，我很沮丧地看到该页面显示了`std::atomic_compare_exchange_*strong*`！

有人可以发布用于`std::atomic_compare_exchange_weak`在单链表前面插入节点的合理代码吗？无需担心 ABA 问题或做任何花哨的事情。我只想看看可以编译的骨架代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T10:18:37.937

一个正确的例子是：

```
struct list {
    std::atomic<node*> head;
};

...

void append(list* s, node* n)
{
    node* head;
    do {
        head = s->head;
        n->next = head;
    } while (!std::atomic_compare_exchange_weak(&(s->head), &head, n));
    // or while (!s->head.compare_exchange_weak(head, n));
} 
```

The`list::head`需要是一个`std::atomic`对象，除非您想处理未定义的行为。`std::atomic`有问题的平台可能需要使用锁来实现部分或全部内容。因此，`std::atomic<T*>`可能包括其他成员，并且`reinterpret_cast<std::atomic<T*>*>`UB 意味着您的程序崩溃。

# python - 在 Cython 函数中使用多种类型的 numpy 数组？

> ID：16026748
> 
> 赞同：2
> 
> 时间：2013-04-16T00:18:57.487
> 
> 标签：python, numpy, scipy, cython

Cython 中的函数如何将两个不同类型的 numpy 数组（例如一个整数数组，另一个浮点数组）作为参数？此处的示例[http://docs.cython.org/src/userguide/numpy_tutorial.html?highlight=numpy#adding-types](http://docs.cython.org/src/userguide/numpy_tutorial.html?highlight=numpy#adding-types)展示了如何为 int 数组执行此操作，但我想要一个类似的函数：

```
import numpy as np
cimport numpy as np
## how do define array types here?
DTYPE = ???
ctypedef np.int_t DTYPE_t
def foo(np.array arr_of_ints, np.array arr_of_floats):
  # divide integers by floats
  result = arr_of_ints / arr_of_floats 
```

如何才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T01:38:04.473

这是一个我很快就完成的例子。

```
import cython
import numpy as np
cimport numpy as np

@cython.boundscheck(False)
def divide(np.ndarray[np.float_t, ndim=1] numer,
           np.ndarray[np.int_t, ndim=1] denom):
    cdef:
        int n = min(numer.shape[0], denom.shape[1])
        np.ndarray[np.float_t, ndim=1] result = np.empty(n, dtype=float)

    for i in range(n):
        result[i] = numer[i] / denom[i]

    return result 
```

我相信上面的大部分内容都包含在您问题的链接中，但如果您不明白其中任何内容，请询问。

# c# - Move all lines until a blank line is found

> ID：16026751
> 
> 赞同：-2
> 
> 时间：2013-04-16T00:19:05.577
> 
> 标签：c#, .net, regex

I want to move all lines from `String apa1;` to `String apa2;` until we find the first blank line.

* * *

**apa1 can look like this:**

```
texttest: text test
test text test text

Lorem ipsum dolor sit
amet, consectetur 
adipiscing: elit. 
Curabitur dolor lectus, 
cursus ac placerat vitae, 
volutpat sit: amet lacus. 
```

* * *

**I want apa1 to look like this:**

```
Lorem ipsum dolor sit
amet, consectetur 
adipiscing: elit. 
Curabitur dolor lectus, 
cursus ac placerat vitae, 
volutpat sit: amet lacus. 
```

* * *

**And apa2 to look like this:**

```
texttest: text test
test text test text 
```

How do you solve this problem?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:31:39.153

它应该是这样的。只需继续将第一个字符串复制到第二个字符串，直到遇到空行

```
String apa1 = @"texttest: text test
                test text test text

                Lorem ipsum dolor sit
                amet, consectetur 
                adipiscing: elit. 
                Curabitur dolor lectus, 
                cursus ac placerat vitae, 
                volutpat sit: amet lacus.";
String apa2 = string.Empty;

String tmp = String.Copy(apa1);
StringReader strReader = new StringReader(tmp );
String line = strReader.ReadLine();

while(!string.IsNullOrEmpty(line))
{
    apa2 += line;
    line = strReader.ReadLine();
}

apa1 = strReader.ReadToEnd(); 
```

# ruby-on-rails - How to change where to point for Rails binary?

> ID：16026754
> 
> 赞同：0
> 
> 时间：2013-04-16T00:19:31.017
> 
> 标签：ruby-on-rails, unix, command-line

I'm attempting to set up a hosting server for my rails app. They have a tutorial and very specific way of setting up the environment. I've followed it to the best of my ability and either I've made a mistake or they have. I've substituted the appropriate username for USERNAME

I've set up my .bash_profile like they state:

```
# START
if [ -f ~/.bashrc ]; then
. ~/.bashrc
fi

PATH=$HOME/.gems/bin:$HOME/bin:$PATH

GEM_HOME=$HOME/.gems
GEM_PATH=$HOME/.gems:/usr/lib/ruby/gems/1.8

export PATH GEM_HOME GEM_PATH
# END 
```

Then I'm instructed to run: `source ~/.bash_profile`

Then `gem install rails`

Then they say to add this line to .bash_profile before the export statement, which I don't understand because it's already in there leading me to believe it's a typo:

```
PATH=$HOME/.gems/bin/:$HOME/bin:$PATH 
```

Then again run `source ~/.bash_profile`

Then when I run which rails I should get: `/home/USERNAME/.gems/bin/rails` but I get `/usr/bin/rails`

Can anyone help me point to the right direction? Thanks.

Also here's the output of `gem env`:

```
RubyGems Environment:
  - RUBYGEMS VERSION: 1.6.2
  - RUBY VERSION: 1.8.7 (2012-06-29 patchlevel 370) [x86_64-linux]
  - INSTALLATION DIRECTORY: /home/USERNAME/.gems
  - RUBY EXECUTABLE: /usr/bin/ruby
  - EXECUTABLE DIRECTORY: /home/USERNAME/.gems/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86_64-linux
  - GEM PATHS:
     - /home/USERNAME/.gems
     - /usr/lib/ruby/gems/1.8
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => false
     - :benchmark => false
     - :backtrace => false
     - :bulk_threshold => 1000
     - "gem" => "-no-ri --no-rdoc"
     - :sources => ["http://gems.rubyforge.org/", "http://rubygems.org"]
     - "gempath" => ["/home/USERNAME/.gems", "/usr/lib/ruby/gems/1.8"]
     - "gemhome" => "/home/USERNAME/.gems"
  - REMOTE SOURCES:
     - http://gems.rubyforge.org/
     - http://rubygems.org 
```

# javascript - 我们应该如何防止*仅*破坏页面渲染的 XSS 攻击？

> ID：16026755
> 
> 赞同：0
> 
> 时间：2013-04-16T00:19:34.133
> 
> 标签：javascript, html, asp.net-mvc, json, xss

假设我们有一个允许输入一段降价作为消息正文的表单。然后该文本在 HTML 中呈现为另一个页面上的*JSON ：*

```
<html>
   <body>
       <script type="text/javascript">
       loadMessage({
           name: 'John Doe',
           message: '**Hello** World'
       });
       </script>
   </body>
</html> 
```

假装`loadMessage`使用降价解析器（例如[标记](https://github.com/chjj/marked)）并在运行时输出 HTML。

我发现了一个恶意用户可能导致页面错误的情况：

```
<html>
   <body>
       <script type="text/javascript">
       loadMessage({
           name: 'John Doe',
           message: '</script>'
       });
       </script>
   </body>
</html> 
```

因为`</script>`导致浏览器关闭脚本块，所以`Unexpected token ILLEGAL`抛出异常。Marked 能够清除这种攻击，但这种攻击甚至在 JavaScript 执行之前。

1.  在提交初始表单时`<script>`删除所有内容。`</script>`这意味着更新我们的很多框架代码（使用 ASP.NET MVC - 所以我们必须扩展默认的 ModelBinder）。
2.  `'</' + 'script>'`为此利用 JSON 格式化程序 -在编写 JSON 时转换为。我们会保持源的完整——但也许这是*一件坏事*。

我们应该如何减轻这种攻击？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T04:59:27.350

我个人可能会同意剥离任何类似于脚本标签的东西，因为这种方法会为你的 Markdown 解析器中的验证错误提供额外的安全层。但是您的里程可能会因您的应用程序而异。

如果您确实需要编码，请参阅[https://stackoverflow.com/a/236106/131903](https://stackoverflow.com/a/236106/131903)了解合理的编码方法（即使用 \x3c 替换小于号）。这将起作用：

```
<html>
  <script>
    alert("1 \x3c/script> 2");
  </script>
</html> 
```

# java - Why is my onResume being called twice?

> ID：16026756
> 
> 赞同：61
> 
> 时间：2013-04-16T00:19:40.753
> 
> 标签：java, android, android-activity, android-lifecycle

Basically, this is what I'm doing

1) Set AlarmManager to execute BroadcastReceiver (BCR)

```
Intent intent = new Intent(m_Context, BCR.class);  
intent.putExtras(extras);  
PendingIntent pendingIntent = PendingIntent.getBroadcast(m_Context, 0, intent, PendingIntent.FLAG_UPDATE_CURRENT);  
AlarmManager am = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
am.set(AlarmManager.RTC_WAKEUP, StartTime, pendingIntent) 
```

2) Start MyActivity from BCR

```
@Override  
public void onReceive(Context context, Intent intent) {  
    Intent newIntent = new Intent(context, MyActivity.class);
    newIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);  
    context.startActivity(newIntent);  
} 
```

3) Have MyActivity turn on the screen if its not on

```
@Override  
public void onCreate(Bundle savedInstanceState) {  
    super.onCreate(savedInstanceState); 
    getWindow().addFlags(LayoutParams.FLAG_DISMISS_KEYGUARD);
    getWindow().addFlags(LayoutParams.FLAG_SHOW_WHEN_LOCKED);
    getWindow().addFlags(LayoutParams.FLAG_TURN_SCREEN_ON);
    setContentView(R.layout.myactivity);  
} 

@Overide  
protected void onNewIntent(Intent intent) {  
    super.onNewIntent(intent);  
} 
```

For some reason, I notice that right when MyActivity is opened, it's flow goes like:

onCreate/onNewIntent -> onResume -> onPause -> onResume

I'm not sure why it does an onPause right away. I notice this only happens when the screened is being turned on by the flags. Does anyone know why this happens? Is there any way this behavior can be prevented?

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-11-04T21:09:29.913

以防万一其他人遇到这种情况，我似乎只有在我通过 XML 布局在活动内膨胀片段时才注意到这种行为。我不知道这种行为是否也发生在 Fragments 的兼容性库版本中（我使用的是 android.app.Fragment）

似乎活动会在调用任何添加的片段`Activity#onResume`之前调用一次`Fragment#onResume`，然后`Activity#onResume`再次调用。

1.  活动：onCreate
2.  片段：onAttach
3.  活动：onAttachFragments
4.  片段：onCreate
5.  活动：onStart
6.  活动： onResume
7.  片段：onResume
8.  活动： onResume

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2018-04-05T18:54:30.683

如果您每次都尝试请求权限可能会导致此类问题，请检查您是否已授予它们

`requestPermissions`可能导致它：

```
onCreate
onStart
onResume
onPause
onResume 
```

使用此方法[ContextCompat.checkSelfPermission(context, permission)](https://developer.android.com/reference/androidx/core/content/ContextCompat#checkSelfPermission(android.content.Context,%20java.lang.String))在请求之前检查是否已授予权限

此方法返回`int`，您可以使用`PackageManager.PERMISSION_GRANTED`常量检查它

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-08-02T17:12:08.783

如果你有`ES File Explorer`然后**强制停止**它。不知何故，它们打断了您的应用程序的生命周期*（评论建议某种覆盖）*。

我`onResume`出现两次的问题是因为`onPause`在创建活动后以某种方式被调用.. 有东西打断了我的应用程序。

这*仅**在安装后第一次*打开或*从工作室构建*后才会发生。

我从另一篇文章中得到了*线索*，发现这是因为 ES File Explorer。[为什么 onResume() 似乎被调用了两次？](https://stackoverflow.com/questions/20693191/why-does-onresume-seem-to-be-called-twice/38726546#38726546)

一旦我*强制停止 ES File Explorer*，这种打嗝行为就不再发生......在尝试了许多其他提议的解决方案后知道这令人沮丧。所以要提防任何其他像这样的*中断应用程序。*

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-02-03T01:02:17.773

我对此进行了一段时间的研究，因为在互联网上没有提到这种奇怪的行为。我没有解决方案如何克服这种阴暗面的行为，但我发现了一个确切的场景，当它确实发生时。

`onPause-onResume-onPause-onResume`每次都会发生，当应用程序在安装后第一次启动时。您可以通过对代码进行任何更改并从 IDE 重新运行（包括重新编译）应用程序来简单地调用此行为。

无论您是否使用 AppCompat 库。我已经测试了这两种情况，并且行为仍在继续。

注意：在 Android Marshmallow 上测试。

我从[这个线程中借用了关于片段和活动生命周期](https://stackoverflow.com/questions/12640316/further-understanding-setretaininstancetrue)的代码，在这里（只需复制、粘贴、在清单中声明活动并运行 Forest run）：

```
import android.app.Activity;
import android.app.Fragment;
import android.app.FragmentTransaction;
import android.content.Context;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

public class TestActivity extends Activity {

    private static final String TAG = "ACTIVITY";

    public TestActivity() {
        super();
        Log.d(TAG, this + ": this()");
    }

    protected void finalize() throws Throwable {
        super.finalize();
        Log.d(TAG, this + ": finalize()");
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d(TAG, this + ": onCreate()");

        TextView tv = new TextView(this);
        tv.setText("Hello world");
        setContentView(tv);

        if (getFragmentManager().findFragmentByTag("test_fragment") == null) {
            Log.d(TAG, this + ": Existing fragment not found.");
            FragmentTransaction ft = getFragmentManager().beginTransaction();
            ft.add(new TestFragment(), "test_fragment").commit();
        } else {
            Log.d(TAG, this + ": Existing fragment found.");
        }
    }

    @Override
    public void onStart() {
        super.onStart();
        Log.d(TAG, this + ": onStart()");
    }

    @Override
    public void onResume() {
        super.onResume();
        Log.d(TAG, this + ": onResume()");
    }

    @Override
    public void onPause() {
        super.onPause();
        Log.d(TAG, this + ": onPause()");
    }

    @Override
    public void onStop() {
        super.onStop();
        Log.d(TAG, this + ": onStop()");
    }

    @Override
    public void onDestroy() {
        super.onDestroy();
        Log.d(TAG, this + ": onDestroy()");
    }

    public static class TestFragment extends Fragment {

        private static final String TAG = "FRAGMENT";

        public TestFragment() {
            super();
            Log.d(TAG, this + ": this() " + this);
        }

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            Log.d(TAG, this + ": onCreate()");
        }

        @Override
        public void onAttach(final Context context) {
            super.onAttach(context);
            Log.d(TAG, this + ": onAttach(" + context + ")");
        }

        @Override
        public void onActivityCreated(Bundle savedInstanceState) {
            super.onActivityCreated(savedInstanceState);
            Log.d(TAG, this + ": onActivityCreated()");
        }

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
            Log.d(TAG, this + ": onCreateView()");
            return null;
        }

        @Override
        public void onViewCreated(View view, Bundle savedInstanceState) {
            super.onViewCreated(view, savedInstanceState);
            Log.d(TAG, this + ": onViewCreated()");
        }

        @Override
        public void onDestroyView() {
            super.onDestroyView();
            Log.d(TAG, this + ": onDestroyView()");
        }

        @Override
        public void onDetach() {
            super.onDetach();
            Log.d(TAG, this + ": onDetach()");
        }

        @Override
        public void onStart() {
            super.onStart();
            Log.d(TAG, this + ": onStart()");
        }

        @Override
        public void onResume() {
            super.onResume();
            Log.d(TAG, this + ": onResume()");
        }

        @Override
        public void onPause() {
            super.onPause();
            Log.d(TAG, this + ": onPause()");
        }

        @Override
        public void onStop() {
            super.onStop();
            Log.d(TAG, this + ": onStop()");
        }

        @Override
        public void onDestroy() {
            super.onDestroy();
            Log.d(TAG, this + ": onDestroy()");
        }
    }

} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-04-16T00:30:26.157

我不确定发生了什么，但我怀疑您的活动正在重新启动，因为设置屏幕被系统视为配置更改。您可以尝试在每次调用时记录配置，`onResume`以查看是否发生了这种情况，如果是，实际发生了什么变化。然后，您可以修改清单以告诉系统您的活动将自行处理更改。

```
protected void onResume() [
    super.onResume();
    Configuration config = new Configuration();
    config.setToDefaults();
    Log.d("Config", config.toString());
    . . .
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-04-20T23:07:38.243

我有类似的问题。我的情况是下一个 **CurrentActivity** extends **MainActivity** **CurrentFragment** extends **MainFragment**

我像往常一样带着意图打开**CurrentActivity 。**在 onCreate **CurrentAcitivity**中，我替换了 CurrentFragment。

生命周期是：1\. onResume MainActivity 2\. onResume CurrentActivity 3\. onResume MainFragment 4\. onResume CurrentFragment

自动调用 onPause，然后再次调用

1.  onResume MainActivity
2.  onResume 当前活动
3.  onResume MainFragment
4.  onResume 当前片段

我决定重新测试所有内容，经过几个小时的尝试和玩耍，我发现了根本问题。在 MainFragment onStart 中，我每次都调用 startActivityForResult（在我的情况下是用于打开 Wifi 的 android 弹出窗口），在 MainFragment 上调用 onPause。我们都知道，在 onPause 之后下一个是 onResume。

所以它不是 Android 错误，它只是我的 :-)

快乐的生命周期调试！

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-01-20T15:16:00.973

我也遇到了这个 onresume-onpause-onresume 序列（在 4.1.2 及更高版本上，但我在 2.3 上没有遇到过这种情况）。我的问题与唤醒锁处理有关：我不小心忘记释放唤醒锁并重新获取它导致错误消息“WakeLock 在仍被持有时已完成”。此问题导致在 onResume 之后立即调用 onPause 并导致错误行为。

我的建议是：检查日志中的错误，这些错误可能与此问题有关。

另一个提示：打开屏幕可能比简单地使用窗口标志更棘手。您可能想在此处查看此答案 - 它建议您设置一个接收器以检查屏幕是否已打开并仅在以下之后启动所需的活动：[https ://stackoverflow.com/a/16346369/875442](https://stackoverflow.com/a/16346369/875442)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-05-14T19:43:50.533

似乎`Activity`从支持库中使用会自动保存和恢复实例。`savedInstanceState`因此，只有在是时才做你的工作`null`。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-01-31T21:40:27.853

我有一个类似的问题，我的问题是在 onCreate() 方法中，我正在做：

```
@Override
protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    super.setContentView(R.layout.friends);  <-- problem
} 
```

我对“超级”的呼唤。触发了 onResume() 两次。在我将其更改为以下内容后，它按预期工作：

```
@Override
protected void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.friends);  <-- 'super.' removed
} 
```

希望能帮助到你。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-16T15:38:29.600

我确信这发生在我的应用程序中，直到我意识到我已经种植了两棵 Jake Wharton 的木材树，并且 onResume() 只是被记录了两次，而不是被调用了两次。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-06-14T15:58:33.150

Basically a lot of stuff can trigger this. Some resume processes that loses focus can do it. A few apps will cause it to happen too. The only way to cope is to block the double running. Note, this will also have an errant pause thrown in for good measure.

```
 boolean resumeblock = false;

    @Override
    protected void onResume() {
        super.onResume();
        sceneView.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() {
            @Override
            public boolean onPreDraw() {
                sceneView.getViewTreeObserver().removeOnPreDrawListener(this);
                if (resumeblock) return false;
                resumeblock = true;

                //Some code.

                return false;
            }
        });
    } 
```

This is a solid way to prevent such things. It will block double resumes. But, it will also block two resumes that preserve the memory. So if you just lost focus and it doesn't need to rebuild your stuff. It will block that too. Which might be a benefit clearly, since if you're using the resume to control some changes over focus, you *only* actually care if you need to rebuild that stuff because of focus. Since the pre-draw listeners can only be called by the one thread and they must be called in sequence, the code here will only run once. Until something properly destroys the entire activity and sets resumeblock back to false.

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-07-06T15:01:43.713

由于在of中设置了`UiMode`，我遇到了同样的问题。更改主题触发了娱乐并对和进行了两次调用。`onCreate()``MainActivity``activity``onPause()``onStart()`

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-01-05T06:31:43.037

我没有看到这个问题的充分答案，所以我决定了这个。

从我的笔记：“似乎活动运行 onResume() onPause() 然后再次 onResume。运行的最后一个方法是 onSizeChanged()。所以一个好的做法是仅在 onSizeChanged() 方法之后启动线程被处决了。”

所以你可以： 记录每个运行的方法。确定最后运行的方法。确保您有一个初始化为 false 的布尔值，并且仅在最后一个方法运行后才更改为 true。然后，一旦您检查布尔值是否为真，您就可以开始所有线程操作。

- 对于任何想知道的人：我正在使用一个表面视图，它有一个最后执行的 onSizeChanged() 方法。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2018-12-07T16:39:15.310

我有同样的问题。我的是运行时的这段代码

```
setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE); 
```

我只是把它放在清单中

```
android:screenOrientation="landscape" 
```

没有更多关于两次调用 onCreate 和 onResume 的问题。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-11-30T16:48:28.137

您是否尝试过在调用方法`getWindow().addFlags(...)`之前调用您`super.onCreate(savedInstanceState)`的`onCreate`方法？

我有一个类似的问题。当我看起来像这样`onResume`时被调用了两次：`onCreate`

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);
    setContentView(R.layout.main);
    ...
} 
```

将其更改为：

```
@Override
public void onCreate(Bundle savedInstanceState) {

    AppCompatDelegate.setDefaultNightMode(AppCompatDelegate.MODE_NIGHT_YES);

    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    ...
} 
```

...解决了问题。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-01-08T20:48:52.493

我刚刚遇到了这个问题，似乎一般来说`getWindow().addFlags()`调整`Window`属性可能是罪魁祸首。

当我的代码是这样的

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_generic_fragment_host);
    // performing fragment transaction when instance state is null... 
```

`onResume()`被触发两次，但是当我删除时`requestWindowFeature()`，它只被调用一次。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-11-09T16:02:21.850

正如@TWL 所说， *ES File Explorer* 对我来说是个问题！卸载应用程序解决了这个问题。安装此 *ES 文件资源管理器*时，`onStart() -> onResume() -> onPause() -> onResume()`.. 是问题所在。 `onResume()`被称为2'ce。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2016-03-21T19:48:01.183

我认为你应该看看这个问题： [Nexus 5 进入睡眠模式会使活动生命周期出现](https://stackoverflow.com/questions/22780028/nexus-5-going-to-sleep-mode-makes-activity-life-cycle-buggy)问题 你应该找到线索

* * *

## 回答 #19

> 赞同：-1
> 
> 时间：2017-07-14T09:20:48.787

我也遇到了这个问题，这是因为碎片..您在活动中拥有的碎片数量`onResume()`将调用该次数。为了克服我在`SharedPrefrences`

# javascript - 为什么我的表单没有验证

> ID：16026757
> 
> 赞同：0
> 
> 时间：2013-04-16T00:19:45.917
> 
> 标签：javascript, html, forms, validation

所以，突然之间，我的表单停止验证，它可以从以下位置实时查看： http: [//scoutsamerica.com/beamodel.php](http://scoutsamerica.com/beamodel.php)

我根本没有编辑它，前几天它工作得很好。它允许用户在不上传图像的情况下通过。

这是页面上的Javascript：

```
 <script type="text/javascript">

    function Validate(oForm) {
        if(!countWords("full_name", 2, "Please input your first and last name.")) {
            return false; // Name didnt validate.
        }
        if(!checkemail("email")) {
            return false; // Email didnt validate.
        }
        if(!checkAge("age")) {
            return false; // Age didnt validate.
        }
        if(!checkTwitter("twitter")) {
            return false; // Twitter didnt validate.
        }
        if(!checkZip("zip")) {
            return false; // Twitter didnt validate.
        }
        if(!checkPhone("phone")) {
            return false; // Twitter didnt validate.
        }
        if(!checkFileFormat(oForm)) {
            return false; // File didnt validate.
        }
        checkFileSize("uploadedfile");
    };

    $(document).ready(function(){

        $("#twitter").blur(function() {
            var s = $("#twitter").val();
            var isAt = s.charAt(0);
            if(isAt !== "@") {
                $(this).val('@' + s);
            }
        });

        function checkCity(s){
            return s.toLowerCase().replace( /\b./g, function(a){ return a.toUpperCase(); } );
        };

        $("#city").blur(function() {
            var s = $("#city").val();
            var isAt = s.charAt(0);
            if(isAt !== "@") {
                $(this).val(checkCity(s));
            }
        });
        $("#phone").blur(function() {
            var phone = $(this).val();

            phone = phone.replace(/\D/g, '');
            if (phone.length == 10) {
                var areaCode = phone.substring(0,3);
                var phoneFirst = phone.substring(3,6);
                var phoneLast = phone.substring(6,10);

                var formattedNumber = areaCode + '-' + phoneFirst + '-' + phoneLast;
                $(this).val(formattedNumber);
            }

        });
        $("#age").blur(function() {
            var age = $(this).val();
            if (age < 18) {
                $(".contactHalf").addClass("young");
                $(".parent").show();
            } else {
                $(".contactHalf").removeClass("young");
                $(".parent").hide();
            }

        });
        //binds to onchange event of your input field
        $('#uploadedfile').bind('change', function() {
            var sizeInBytes = this.files[0].size;

            console.log("Bytes: " + sizeInBytes); //6561060
            console.log("Megabytes: " + (sizeInBytes / (1024*1024)).toFixed(2) + " mb"); //6561060

        });
    });

 </script> 
```

这是我的 validate.js 页面以及它在我的页面上的引用方式：

```
<script type='text/javascript' src='../js/validate.js'></script> 
```

验证.js：

```
 function checkemail(email){
        var str=document.getElementById(email).value;
        var filter=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i

        if (filter.test(str)) {
            testresults=true
        } else {
            alert("Please input a valid email address!")
            testresults=false
        }
        return (testresults)
    }
    $("#beamodelform").submit(function(){
        var isFormValid = true;

        $("#beamodelform input").each(function(){
            if ($.trim($(this).val()).length == 0){
                $(this).addClass("highlight");
                isFormValid = false;
            }
            else{
                $(this).removeClass("highlight");
            }
        });

        if (!isFormValid) alert("Please fill in every field.");

        return isFormValid;
    });
    function countWords(theField, theMax, msg){
        s = document.getElementById(theField).value;
        s = s.replace(/(^\s*)|(\s*$)/gi,"");
        s =s.replace(/[ ]{2,}/gi," ");
        s = s.replace(/\n /,"\n");
        var strLen = s.split(' ').length;

        if (strLen > theMax) {
            alert(msg);
            return false;
        } else {
            return true;
        }
    }
    function checkAge(ageID) {
        var age = document.getElementById(ageID).value;
        if(isNaN(age)) {
            alert("Please input a valid age.");
            return false;
        } else {
            return true;
        }
    }
    function checkTwitter(twitterName) {
        var twitterName = document.getElementById(twitterName).value;
        var isIt = (twitterName.indexOf(" ") !== -1);
        if(isIt) {
            alert("Please input a Twitter username.");
            return false;
        } else {
            return true;
        }
    }
    function checkZip(zipId) {
        var zip = document.getElementById(zipId).value;
        zip = zip.replace(/ /g,'');
        if(isNaN(zip)) {
            alert("Please input a valid ZIP code.");
            return false;
        } else {
            if (zip.length !== 5) {
                alert("Please input a valid ZIP code.");
                return false;
            } else {
                return true;
            };
        }
    }
    function checkPhone(phoneNum) {
        var phoneEnt = document.getElementById(phoneNum).value;
        var phoneNum = phoneEnt.replace(/\D/g, '');
        if(phoneNum.length !== 10) {
            alert("Please input a valid phone number.");
            return false;
        } else {
            return true;
        }
    }
    function checkFileFormat(oForm) {

        var _validFileExtensions = [".jpg", ".jpeg", ".JPG", ".JPEG"];
        // For Files
        var arrInputs = oForm.getElementsByTagName("input");
        for (var i = 0; i < arrInputs.length; i++) {
            var oInput = arrInputs[i];
            if (oInput.type == "file") {
                var sFileName = oInput.value;
                if (sFileName.length > 0) {
                    var blnValid = false;
                    for (var j = 0; j < _validFileExtensions.length; j++) {
                        var sCurExtension = _validFileExtensions[j];
                        if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) {
                            blnValid = true;
                            break;
                        }
                    }
                    if (!blnValid) {
                        alert("Sorry, your image is invalid, allowed extensions are: " + _validFileExtensions.join(", "));
                        return false;
                    }
                } else {
                    alert("Please upload an image.");
                    return false;
                }
            }
        }
        return true;
    };

    function checkFileFormat(uploader) {
        var uploaded = document.getElementById(uploader).value;
        var pic = uploaded.files[0];
        //this.files[0].size gets the size of your file.
        alert(pic.size);

    }; 
```

这是我的表格：

```
<div id="contactScoutsAmerica" class="mainContent">
            <h1>Be A Model</h1>
            <p>Request to be a <img height="19" src="/img/navSA.png" /> Model today!</p>

        <form method="post" id="beamodelform" name="beamodel" action="modelrequest.php" enctype="multipart/form-data" onsubmit="return Validate(this)">
            <div class="contactHalf" id="leftHalf">
                    <div class="contactbrake">
                        <input tabindex="1" type="text" id="full_name" name="full_name" placeholder="Jane Doe" required></input>
                        <input tabindex="2" type="text" id="email" name="email" placeholder="i.e. you@gmail.com" required></input>
                        <label>Name</label>
                        <label>Email</label>
                    </div>
                    <div class="contactbrake">
                        <input tabindex="5" type="text" id="address" name="address" placeholder="4300 Main St." required></input>
                        <input tabindex="6" type="text" id="city" name="city" placeholder="Kansas City" required></input><br>
                        <label>Address</label>
                        <label>City</label>
                    </div>

                    <div class="contactbrake" id="lastleft">
                        <input tabindex="10" type="text" id="timeofday" name="timeofday" placeholder="After 5:30PM" required></input>
                        <input tabindex="11" type="text" id="dayofweek" name="dayofweek" placeholder="Weekdays"></input><br>
                        <label id="timeofdaylabel">Best Time to Call</label>
                        <label id="dayofweeklabel">Day of Week</label>
                    </div>
                    <div class='contactbrake parent'>
                        <input tabindex='12' type='text' id='parentname' name='parentname' placeholder='John Doe'></input>
                        <input tabindex='13' type='text' id='parentnumber' name='parentnumber' placeholder='816-555-2401'></input><br>
                        <label id='timeofdaylabel'>Parent Name</label>
                        <label id='dayofweeklabel'>Parent Phone Number</label></div>
                    <div class="contactbrake">
                        <p>If you are reading this there is a very good chance you have heard about us on the radio, been spotted by one of our talent scouts, or referred by one of our models. If so, congratulations! You have taken the first step to becoming a model or actor with Scouts America. Just fill out this simple application and a representative will contact you within 48 hours.</p>
                    </div>
            </div>
            <div class="contactHalf" id="rightHalf">
                    <div class="contactbrake">
                        <input tabindex="3" type="text" id="age" name="age" placeholder="18" required></input>
                        <input tabindex="4" type="text" id="twitter" name="twitter" placeholder="@ScoutsAmerica"></input>
                        <label>Age</label>
                        <label>Twitter</label>
                    </div>

                    <div class="contactbrake">
                        <select tabindex='7' name="state" id="state" style="width: 49px !important;">
                            <option value="AL">AL</option>
                            <option value="AK">AK</option>
                            <option value="AZ">AZ</option>
                            <option value="AR">AR</option>
                            <option value="CA">CA</option>
                            <option value="CO">CO</option>
                            <option value="CT">CT</option>
                            <option value="DE">DE</option>
                            <option value="DC">DC</option>
                            <option value="FL">FL</option>
                            <option value="GA">GA</option>
                            <option value="HI">HI</option>
                            <option value="ID">ID</option>
                            <option value="IL">IL</option>
                            <option value="IN">IN</option>
                            <option value="IA">IA</option>
                            <option value="KS">KS</option>
                            <option value="KY">KY</option>
                            <option value="LA">LA</option>
                            <option value="ME">ME</option>
                            <option value="MD">MD</option>
                            <option value="MA">MA</option>
                            <option value="MI">MI</option>
                            <option value="MN">MN</option>
                            <option value="MS">MS</option>
                            <option value="MO">MO</option>
                            <option value="MT">MT</option>
                            <option value="NE">NE</option>
                            <option value="NV">NV</option>
                            <option value="NH">NH</option>
                            <option value="NJ">NJ</option>
                            <option value="NM">NM</option>
                            <option value="NY">NY</option>
                            <option value="NC">NC</option>
                            <option value="ND">ND</option>
                            <option value="OH">OH</option>
                            <option value="OK">OK</option>
                            <option value="OR">OR</option>
                            <option value="PA">PA</option>
                            <option value="RI">RI</option>
                            <option value="SC">SC</option>
                            <option value="SD">SD</option>
                            <option value="TN">TN</option>
                            <option value="TX">TX</option>
                            <option value="UT">UT</option>
                            <option value="VT">VT</option>
                            <option value="VA">VA</option>
                            <option value="WA">WA</option>
                            <option value="WV">WV</option>
                            <option value="WI">WI</option>
                            <option value="WY">WY</option>
                        </select>
                        <input tabindex="8" type="text" id="zip" name="zip" placeholder="64130" required></input>
                        <input tabindex="9" type="text" id="phone" name="phone" placeholder="816-555-2400" required></input><br>
                        <label id="statelabel">State</label>
                        <label id="ziplabel">ZIP</label>
                        <label id="phonelabel">Phone</label>
                    </div>

                    <div class="contactbrake" id="lastright">
                        <input type="hidden" name="MAX_FILE_SIZE" value="7500000" />
                        <input type="file" name="uploadedfile" id="uploadedfile" text="Attach File" />
                        <label id="attachfile">Attach image of yourself</label>
                    </div>
                    <div class='contactbrake parent'>
                    </div>
                    <div class="contactbrake">
                        <textarea id="contactMsg" name="contactMsg" autocomplete="off" placeholder="Send us a message!"></textarea>
                        <button type="submit">Send</button>
                    </div>
                </div>
            </form>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:28:44.063

你有一个`checkFileFormat(uploader)`和一个`checkFileFormat(oForm)`功能？我不认为 JS 会知道该调用哪一个。

您是否使用与前几天不同的浏览器？我刚刚在实时页面上填写了表格，它工作正常。它不会让我不上传图片就通过。我在这里使用 Chrome。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:29:34.903

您定义了两个函数，因为`checkFileFormat()`没有为`checkFileSize()`. 我猜第二个实际上应该被命名`checkFileSize()`。

```
function checkFileFormat(uploader) {  // <-- Change name here?
    var uploaded = document.getElementById(uploader).value;
    var pic = uploaded.files[0];
    //this.files[0].size gets the size of your file.
    alert(pic.size);

}; 
```

其次，在`Validate()`函数中，如果文件大小为0，您似乎需要返回`false`，这里您只需调用该方法，不要有条件地返回false。

```
checkFileSize("uploadedfile"); 
```

# vb.net - 带坐标的 if 语句 (vb)

> ID：16026764
> 
> 赞同：2
> 
> 时间：2013-04-16T00:20:04.253
> 
> 标签：vb.net, visual-studio-2010, integer, point

我有这个代码，它有一个错误`if carloc = (250,524)`。代码是检查汽车（图片框）是否在某个地方，然后在您按下“A”时将 ti 移动到其他地方。这是代码：

```
Public Class Form1
Dim carloc As Point
Private Sub Form1_KeyDown(ByVal sender As System.Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles MyBase.KeyDown
     Select e.KeyCode
        Case Keys.A
            If carloc = (250,524) then
                carloc = New Point(285, 524)
                car.Location = carloc
            End If

    End Select
End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:22:34.323

You would need to check the coordinates individually:

```
If carloc.X = 250 AndAlso carloc.Y = 524 Then
    carloc = New Point(285, 524)
    ' .... 
```

If you're dealing with a value type (`Structure`), which you are in this case, or if the type implements `IEquatable(Of T)`, you can also write:

```
If carloc = New Point(250, 524) Then
    carloc = New Point(285, 524)
    ' .... 
```

This will work *in this case*, but not as a general rule for any type.

# javascript - 如何将 div 定位在具有绝对位置的元素旁边？

> ID：16026774
> 
> 赞同：0
> 
> 时间：2013-04-16T00:21:38.710
> 
> 标签：javascript, jquery, css

我正在尝试创建一个`div`可以在用户将鼠标悬停到链接时附加到元素

我有很多链接，我的代码如下所示。

`for loops`创建许多链接

```
codes....

link.href='#';
link.innerHTML = 'test'
link.onmouseover = OnHover;

codes....

function OnHover(){
    var position;
    var div = document.createElement('div');
        div.className='testdiv';
        div.innerHTML = 'test';

        position=$(div).position();

        div.style.top = position['top'] + 15 + 'px';
        $(this).prepend(div);
}

    link element1
    link element2
 ----
|    |   //add new div when hover link element2
 ----
    link element2
    link element3

my css

.testdiv{
    position:absolute;
} 
```

`div`每次用户将鼠标悬停在我的链接和`left top`元素上的位置时，我都想添加一个新的。

我的代码会将所有 div 放在顶部而不是每个元素。

有没有办法做到这一点？非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:30:52.953

在没有看到您的其他 JavaScript/标记的情况下，我可以进行以下观察：

*   你需要`position:absolute`在你的新设置上`div`做`top`任何事情。
*   您需要确保`link`是非`position:static`.
*   像上面这样的非动态样式应该在你的 CSS 中，而不是 JS 中。
*   定位绝对意味着您不需要使用`$(div).position()`
*   您正在使用 jQuery 和纯 JavaScript 的混合，这看起来有点奇怪:)

**JS**

```
function OnHover() {
    var position;
    var div = $('<div></div>');
    div.addClass('testdiv');
    div.html('test');
    div.css('top', 15);
    $(this).prepend(div);
} 
```

**CSS**

```
.testdiv {
    position:absolute;
}

a.testanchor {
    position:relative;
} 
```

# c - 将指向较大结构的指针转换为指向较小结构的指针

> ID：16026775
> 
> 赞同：2
> 
> 时间：2013-04-16T00:21:55.837
> 
> 标签：c, sockets, pointers, casting, struct

这篇文章将建立在这篇文章的基础上，[但](https://stackoverflow.com/questions/16010622/reasoning-behind-c-sockets-sockaddr-and-sockaddr-storage/16010670)会更通用一点。

我经常看到指向大型结构的指针被转换为指向较小结构的指针，我认为这是可行的，因为指针只是结构中第一个字节的地址。我还有一个问题是当大多数方法没有指向他们期望的类型时如何处理指针。

我将以 Socket API 为例：

`sockaddr_storage`大于`sockaddr`but 指针在传递给函数之前被强制`sockaddr_storage`转换为指向的指针`sockaddr`

```
int bind(int sockfd, const struct sockaddr *addr, socklen_t addrlen); 
```

因此，当指针指向比预期更大的结构时，如何函数往往会处理事情。他们说

“哦，`socklen_t addrlen`传递给我的大小 () 比我想象的要大。最好将此指针转换回`sockaddr_storage`!”

然后像那样访问它的成员？还是他们做了更复杂的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:36:23.997

`sockaddr`是 C 的穷人多态习语的一个完美例子。在 OO 语言中，`sockaddr`将是一个基类，从该基类中“派生”了许多协议地址类型（`sockaddr_in`、`sockaddr_in6`、`sockaddr_ll`等）。

基本上，a`sockaddr`被定义为具有一个类型 ( `sa_family`) 来指定它真正拥有的内容，然后是一些数据。指向 a 的指针`sockaddr`通常指向派生结构 ( `sockaddr_*`)，它指定数据的特定解释。

`sockaddr_storage`类似于 plain `sockaddr`，因为它没有特定的协议地址，只有存储空间。不同之处在于它`sockaddr_storage`指定了比 更多的空间`sockaddr`，使其成为存储特定于协议的`sockaddr`s 的合适类型。

一个查看普通文本的函数`sockaddr`首先查看`sa_family`，例如`AF_INET`（对于 IPv4）或`AF_INET6`（对于 IPv6）或其他东西，然后将其给出的指针转换为适当的`sockaddr`子类型（例如`sockaddr_in`对于 IPv4）。然后它可能会检查`addrlen`以确保转换的指针指向足够的空间来保存子类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:56:04.253

@nneonneo 对套接字示例中发生的事情给出了很好的答案。

但总的来说：

```
"What I still have a question about is how to most methods handle pointers when they aren't pointing at the type they expect." 
```

重要的是他们接收到的结构的布局是否与函数计划用它做的事情相匹配。C 提供了一些布局保证，使之成为可能。在这些情况下，函数确实会获得指向它们期望的类型的指针。只是在内存中还有一些额外的东西可以忽略。

通常，被调用函数中没有`downcast`发生任何事情。它只是在`base class`较大结构的一部分上运行

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:32:28.723

我的猜测是函数根本不在乎，如果指向的结构比预期的大，阅读它至少不会造成访问冲突。较大结构的第一部分当然必须具有与较小结构相同（类型）的成员，以便正确读取值。

可能不建议在您自己的代码中执行此操作，编译器会抱怨类型不兼容。

# python - web2py。没有这样的表错误

> ID：16026776
> 
> 赞同：2
> 
> 时间：2013-04-16T00:21:57.840
> 
> 标签：python, web2py

我有一个错误`no such table: mytable`，即使它是在`models/tables.py`. 我使用sqlite。有趣的是，如果我去`admin panel -> my app -> database administration`然后我看到一个链接`mytable`，但是当我点击它时，我得到了`no such table: mytable`。我不知道如何调试此类错误？有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:32:54.980

web2py 将它*认为*表具有的结构保存在单独的文件中。如果有人手动删除了 table，web2py 仍然会认为它存在，但是当你尝试实际*使用*table时当然会出错

`*.mytable.table`在数据库目录中查找文件

# jquery - jQuery Validate - 两个单独的验证，一个表单

> ID：16026777
> 
> 赞同：3
> 
> 时间：2013-04-16T00:22:08.340
> 
> 标签：jquery, jquery-validate

我正在尝试创建一个带有两个按钮（保存和提交）的简单申请表。我正在使用 jQuery 验证插件。为了提交表格，申请人必须正确填写整个表格。没有空框，每个框中都有有效数据。但是，为了保存，他们可以将任意数量的字段留空，但他们填写的字段必须是有效的。（即数字框中没有字母）。

为此，我有两个单独的验证函数，根据用户单击的按钮，调用两者之一。这适用于提交按钮，并且第一次适用于保存按钮。但是，如果用户在一个用于数字的框中输入了一些乱码并点击了两次保存，则表单仍然会提交。他们第一次点击保存时，它的行为正确。

对于我的生活，我无法弄清楚为什么。我的jQuery代码如下：

```
 $(document).ready(function(){

      $("#csa_submit_button").live("click",function(){
            //alert("submit");
            $("#csa_submit_flag").val("true");
            validator = $("#csa_form").validate({
                "rules": {
                    "csa_phone" : {required: true, digits: true, minlength: 10, maxlength: 10},
                    "csa_current_grants" : {number: true, required: true},
                    "csa_current_work_study" : {number: true, required: true},
                    "csa_balance_no_loans" : {number: true, required: true},
                    "csa_current_loans" : {number: true, required: true},
                    "csa_textbooks" : {number: true, required: true},
                    "csa_total_to_date" : {number: true, required: true},
                    "csa_parent_plus" : "required",
                    "csa_student_loans" : "required",
                    "csa_balance" : {number: true, required: true},
                    "csa_employment_contributions" : {number: true, required: true},
                    "csa_current_financial_situation" : "required",
                    "csa_activities" : "required",
                    "csa_request_amount" : {required: true, number: true},
                    "csa_term": {required: true, minlength: 1}
                },  
                "messages": {
                    "csa_term": "You must select at least one term",
                    "csa_phone": "You must enter a phone number in the following format: ##########"
                },
                errorPlacement: function(error, element) {
                   if (element.attr('type') === 'radio') {
                      error.insertAfter(element.parent());
                   }
                   else if (element.attr('name') === 'csa_employment_contributions'){
                       error.insertAfter(element.parent());
                   }
                   else if (element.attr('name') === 'csa_term') {
                       error.insertAfter(element.parent());
                   }
                   else {
                      error.insertAfter(element);
                   }
                }
            }); 
       });
      $("#csa_save_button").live("click",function(){

            $("#csa_submit_flag").val("false");

            validator = $("#csa_form").validate({
                "rules": {
                    "csa_phone" : {number: true},
                    "csa_current_grants" : {number: true},
                    "csa_current_work_study" : {number: true},
                    "csa_balance_no_loans" : {number: true},
                    "csa_current_loans" : {number: true},
                    "csa_textbooks" : {number: true},
                    "csa_total_to_date" : {number: true},
                    "csa_balance" : {number: true},
                    "csa_employment_contributions" : {number: true},
                    "csa_request_amount" : {number: true}
                },
                "messages": {
                    "csa_phone": "You must enter a phone number in the following format: ##########"
                },
                errorPlacement: function(error, element) {
                   if (element.attr('name') === 'csa_employment_contributions'){
                       error.insertAfter(element.parent());
                   } else {
                      error.insertAfter(element);
                   }                
                }
            });

        });

      }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-12-15T16:20:47.467

我想通过指向他自己的另一个答案的链接来完成 Sparky 的答案：[https](https://stackoverflow.com/a/24456384/923712) ://stackoverflow.com/a/24456384/923712 。

简而言之，有一种方法可以在`.validate()`调用后更新验证，使用`.rules('add', ...)`和`.rules('remove')`方法。

更多信息在这里：http: [//jqueryvalidation.org/rules](http://jqueryvalidation.org/rules)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-09T06:08:02.943

如果您想在不同的按钮调用上使用新设置再次调用验证

```
e.g $('#formid').removeData('validator'); 
```

这将删除对附加表单的验证，然后使用新设置再次对其进行初始化

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T00:41:57.870

你对正在做什么有一个根本的误解`.validate()`。这**不是**按需检查有效性的方法。一旦插件正确初始化，就会自动完成。

`.validate()`只是在表单上*初始化*插件及其选项。这就是为什么您在第一次点击时看到它工作一次的原因。按照设计，即使使用不同的选项，再次调用它也无济于事......这就是为什么在随后单击另一个按钮时它似乎被破坏了。

您不能在同一表单上同时拥有两个单独且唯一的插件实例。你别无选择，只能重新设计你的代码。

请参阅文档： [http ://docs.jquery.com/Plugins/Validation](http://docs.jquery.com/Plugins/Validation)

* * *

**编辑：**

没有可用于按需打开/关闭验证的方法。由于该插件旨在处理`click`和拦截`submit`事件，因此您可以从表单中删除另一个按钮（以避免提交）并单独处理数据，使用 ajax 将数据发送到服务器。

```
$('#save').click(function() {
    var data = $('#myform').serialize();
    // ajax code to send the serialized data to the server
}); 
```

**简单演示：http: [//jsfiddle.net/x4N4U/](http://jsfiddle.net/x4N4U/)**

# node.js - 通过 Facebook Graph Node JS 发布帖子

> ID：16026779
> 
> 赞同：1
> 
> 时间：2013-04-16T00:22:32.893
> 
> 标签：node.js, facebook-graph-api, permissions, facebook-page, facebook-access-token

我目前正在寻求通过创建一个自定义应用程序来自动化一些任务，该应用程序允许我轻松地在我的 Facebook 页面（不是我的个人时间线）上发布状态更新。我的后端在 NodeJS 上运行。

**我的客户端代码具有以下内容：**

```
window.fbAsyncInit = function() {
FB.init({
    appId : 'xxxxxxxxxxxxx', // App ID
    channelUrl : '//xxxxxxxxxxx, // Channel File
    status : true, // check login status
    cookie : true, // enable cookies to allow the server to access the session
    xfbml : true // parse XFBML
});

// Additional init code here
FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
        console.log("You are signed into FB");
        var access_token = FB.getAuthResponse()['accessToken'];
        console.log('Access Token = ' + access_token);
        FB.api('/me/accounts', function(response) {
          for(var i=0;i <response.data.length;i++){;
            var page = response.data[i];
            if(page.id==my_id){
                var page_token = page.access_token;
                console.log(page_token);
                var param = 'callback=?&username=' + GetURLParameter('username')+'&session='+ GetURLParameter('session')+'&access_token='+ page_token;
                $.post(saveTokenEndpoint, param, function(data) {
                    console.log(data);
                });
            }
          }
        });

        FB.api('/me', function(response) {
            username = response.name;
            userid = response.id;
            $('#username').text('~Hi '+username+'!');       
            $(document).trigger('fbInit');
        });

        // connected
    } else if (response.status === 'not_authorized') {
        // not_authorized
        login();
    } else {
        login();
        // not_logged_in
    }

});

};

// Load the SDK Asynchronously
( function(d) {
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {
        return;
    }
    js = d.createElement('script');
    js.id = id;
    js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
}(document));

function login() {
FB.login(function(response) {
    if (response.authResponse) {
        console.log("You are signed into FB");
        var access_token = FB.getAuthResponse()['accessToken'];
        FB.api('/me', function(response) {
            username = response.name;
            userid = response.id;
            $('#username').text('~Hi '+username+'!');
            $(document).trigger('fbInit');
        });
        FB.api('/me/accounts', function(response) {
          // handle response
          for(page in response.data){
            if(page.id==my_id){
                var page_token = page.access_token;
                console.log(page_token);
                var param = 'callback=?&username=' + GetURLParameter('username')+'&session='+ GetURLParameter('session')+'&access_token='+ page_token;
                $.post(saveTokenEndpoint, param, function(data) {
                    console.log(data);
                });
            }
          }
        });

    } else {
        // cancelled
    }
}, {scope: 'publish_stream, manage_pages, offline_access'});
} 
```

**我的服务器端代码：**

```
// saves the token received for future use in posting
app.post('/api/saveToken',function(req,res){
    var username = req.body.username;
    var access_token = req.body.access_token;
    var session = req.body.session;
    user.findOne({
        username: username,
        session: session
    },function(err, userObj){
        if(userObj!=null){
            userObj.token = access_token;
            console.log(access_token);
            userObj.save();
            res.jsonp({status:'true'});
        }else{
            res.jsonp({status:'false'});
        }
    });
}); 
```

**我正在使用这种方法在我的页面上发布我的帖子：**

```
var data = querystring.stringify({
access_token: token,
message: message
});

                        var options = {
                            host: 'graph.facebook.com',
                            port: 443,
                        path: '/app_name/feed',
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded',
                            'Content-Length': data.length
                        }
                    };

                    var req = https.request(options, function(res) {
                        res.setEncoding('utf8');
                        res.on('data', function (chunk) {
                            console.log("body: " + chunk);
                        });
                        res.on('end', function(){ // see http nodejs documentation to see end
                            console.log("\nfinished posting message");
                            conObj.approval = 'published';
                            conObj.save();
                        });
                    });
                    req.on('error', function(e) {
                        console.error(e);
                    });
                    req.write(data);
                    req.end(); 
```

**现在的情况：**

我的代码正在运行，我实际上可以看到我页面墙上的帖子。

但

> **除了我自己，其他任何人都不会出现。**

**我如何让它暂时正确显示：** 当我直接从[Graph API Explorer](https://developers.facebook.com/tools/explorer?method=GET&path=me/accounts) (/me/accounts) 复制令牌时，我让它工作了。 [https://developers.facebook.com/tools/explorer?method=GET&path=me%2Faccounts](https://developers.facebook.com/tools/explorer?method=GET&path=me%2Faccounts)

**最终，我想做的就是找到一种在我的页面上发布帖子的方法**

我监控了通过这两个令牌产生的差异，并没有发现任何差异。他们的范围是“公众”和“每个人”。

高手做指教！我觉得这一切都非常令人费解。

如果一切都失败了，我打算尝试 NodeJS facebook，例如[facebook-node-sdk](https://github.com/Thuzi/facebook-node-sdk)和[nodejs-facebook-sdk库。](https://github.com/weizhu/nodejs-facebook-sdk)

感谢您提前回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:32:24.233

你应该做 OAUTH 服务器端，而不是客户端。

这是一个使用 node.js 通过 Facebook Graph API 发布帖子的工作示例：http: [//code.runnable.com/facebook/UTlPM1-f2W1TAABY](http://code.runnable.com/facebook/UTlPM1-f2W1TAABY)

您尚未使用的唯一依赖项是您应该使用的请求。

# android - 使用带有 LoaderManger 的自定义 CursorAdapter 使用空光标进行初始化

> ID：16026782
> 
> 赞同：1
> 
> 时间：2013-04-16T00:22:50.127
> 
> 标签：android, android-cursoradapter, android-loadermanager

我创建了一个自定义 CursorAdapter 与我的列表视图一起使用，并实现了 LoaderManager.LoaderCallbacks 函数来加载数据。

我的问题：在我的活动的 onCreate() 方法中，我想创建我的 CursorAdapter 的一个实例并将其设置为我的列表视图的适配器。但是，由于 LoaderManger 还没有运行我的查询并返回了一个游标，所以我没有游标可以传递给我的适配器的构造函数。如果我传入 null 我会得到一个空指针异常。

使用 simpleCursorAdapter，如果尚未初始化，您可以传递一个空游标。但是我扩展了 CursorAdapter 并且它的行为方式不同。

我的问题：有没有办法将空光标传递给我的适配器？当我的构造函数调用我的适配器的 super(context, cursor) 方法时，我得到了异常。我没有在构造函数中做任何其他事情。

如果我延迟创建我的适配器（并因此将其设置为列表视图的适配器），直到从 LoaderManger 调用 onLoadFinished()，一切正常，但我认为这不是最好的方法。

我还看到了这个链接：

[http://rajeevranganathan.blogspot.com/2012/07/creating-custom-cursor-adapter-and.html](http://rajeevranganathan.blogspot.com/2012/07/creating-custom-cursor-adapter-and.html)

他每次都重新创建整个 CursorAdapter，本质上是换掉列表视图的适配器，而不仅仅是它的光标——这似乎相当低效：您不必重新创建适配器，只需换掉光标即可。

任何帮助将不胜感激。我是否只需要扩展 SimpleCursorAdapter 并忽略所有我不需要的附加参数？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:44:54.440

在没有适配器的情况下离开 ListView 并不是一件坏事。如果你真的想给你的 SimpleCursorAdapter 一个空光标，我想你可以创建一个没有行的 MatrixCursor。

查看Android 开发页面上的加载[器指南。](http://developer.android.com/guide/components/loaders.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T03:25:34.563

如果使用带有**autoRequery**参数的 CursorAdaptor 构造函数并传递 false，则传递空游标是可以的：

```
class MyCursorAdapter extends CursorAdapter {

    MyCursorAdapter(Context context) {
        super(context, null, false);    // cursor=null, autoRequery=false
        .
        .
        .
    }
} 
```

# bash - Bash：从 ls 命令在 for 循环内格式化结果

> ID：16026787
> 
> 赞同：0
> 
> 时间：2013-04-16T00:23:47.697
> 
> 标签：bash, for-loop, ssh, ls

为什么里面的附加“行”`echo "Line $line"`没有附加到 for 循环内的所有文件中？

```
#!/bin/bash

INPUT=targets.csv
IFS=","

[ ! -f $INPUT ] && { echo "$INPUT file not found"; exit 99; }
while read target user password path
do
    result=$(sshpass -p "$password" ssh -n "$user"@"$target" ls "$path"*file* 2>/dev/null)

    if [ $? -ne 0 ]
    then
            echo "No Heap dumps detected."
    else
            echo "Found a Heap dump! Possible OOM issue detected"
            for line in $result
            do
                    echo "Line $line"
            done
    fi

done < $INPUT 
```

.csv 文件内容..

```
rob@laptop:~/scripts$ cat targets.csv 
server.com,root,passw0rd,/root/ 
```

脚本输出..

```
rob@laptop:~/scripts$ ./checkForHeapdump.sh 
Found a Heap dump! Possible OOM issue detected
Line file1.txt
file2.txt 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:33:23.130

该声明：

```
for line in $result 
```

执行分词`$result`以获取`$line`应设置的每个元素。分词使用`$IFS`. 在脚本的前面，您将其设置为 just `,`。所以这个循环将遍历逗号分隔的数据`$result`。由于其中没有任何逗号，因此它只是一个元素。

如果要按行拆分，请执行以下操作：

```
IFS="
"
for line in $result 
```

# jquery - chrome 开发者控制台显示不同的值，源视图显示不同的值

> ID：16026790
> 
> 赞同：0
> 
> 时间：2013-04-16T00:24:18.970
> 
> 标签：jquery, prestashop

我正在使用 prestashop 构建一个电子商务网站，价格值用 jquery 更改，但源视图显示不同的价格值！chrome 开发者控制台显示的值与我在站点中看到的值相同。我只是不明白这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:27:39.180

开发人员工具的 Sources 选项卡显示来自服务器的原始 HTML。如果您想查看已被 Javascript 修改的 DOM，请查看“元素”选项卡。

# macos - pandoc via launchd - 出现错误：“找不到pdflatex。pdf输出需要pdflatex

> ID：16026793
> 
> 赞同：3
> 
> 时间：2013-04-16T00:24:48.177
> 
> 标签：macos, launchd, pdflatex, pandoc

我正在尝试每 90 秒从降价文档生成一个 pdf 文档。我在 launchd 中设置了一个任务来为我处理这个问题。不幸的是，我收到一个错误消息，提示无法找到 pdflatex，即使我可以从命令行调用它。以下是 ddd_publisher.sh 的全部内容，该文件是 launchd 每 90 秒运行一次的文件：

```
/usr/local/bin/pandoc -o /Users/Jon/dev/intercontinental/ddd.pdf /Users/Jon/dev/intercontinental/ddd.ddd 
```

该程序每 90 秒运行一次，但它将以下行写入 stderr：

```
pandoc: pdflatex not found. pdflatex is needed for pdf output. 
```

如果我`pdflatex -v`在命令行输入，它会告诉我它已安装：

```
pdfTeX 3.1415926-2.4-1.40.13 (TeX Live 2012) 
```

这是我启动的 plist 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
<key>Label</key>
<string>ddd.intercontinental.publisher</string>
<key>ProgramArguments</key>
<array>
    <string>/Users/Jon/dev/intercontinental/ddd_publisher.sh</string>
</array>
<key>StandardErrorPath</key>
<string>/Users/Jon/dev/intercontinental/ddd.stderr</string>
<key>StandardOutPath</key>
<string>/Users/Jon/dev/intercontinental/ddd.stdout</string>
<key>StartInterval</key>
<integer>90</integer> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T01:22:38.423

解决方法是将pdflatex的路径添加到bash脚本中，如下：

```
#!/bin/bash
PATH=$PATH:/usr/texbin
/usr/local/bin/pandoc -o /Users/Jon/dev/intercontinental/ddd.pdf /Users/Jon/dev/intercontinental/ddd.ddd 
```

# entity-framework - 我如何以编程方式知道我的实体框架模型中的所有对象

> ID：16026798
> 
> 赞同：0
> 
> 时间：2013-04-16T00:26:05.933
> 
> 标签：entity-framework

我试图找出是否有一种方法可以迭代我的实体框架模型中的所有对象？我尝试查看智能感知、msdn 和 stackoverflow，但无法正确识别与我的查询匹配的任何内容。

类似于以下内容...

```
foreach(var item in entities.Context.getAllObjects())
{
    Console.Write(item.Name);
} 
```

这样做的重点是，我希望能够为我们的开发人员和 devops 团队编写一些关于数据库对象的报告，以便更好地了解我们的生产服务器中发生的事情。我已经将数据放入要报告的单独数据库中的表中。但不是写我们可能希望或可能不想看到的具体报告。我希望能够提供某种可能列出可能的报告表的界面。然后有一些选项可能按日期、dayOfWeek 或从该日期到该日期的小时分组。

我不希望为了添加新报告而必须更改应用程序。这是我编写这个应用程序的第一个障碍……我相信还会有其他障碍。因为该应用程序是为我们的开发团队准备的，所以我不会担心有人试图以一种没有意义的方式查询数据……而且我也希望有一个绝对最低的进入门槛，因为我们可以不要为我们想要跟踪的所有内容编写报告。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T02:26:22.100

你需要这样的东西：

```
var typesInYourContext = context.GetType()
   .GetProperties()
   .Where(p => p.PropertyType.IsGenericType && typeof(DbSet<>).IsAssignableFrom(p.PropertyType.GetGenericTypeDefinition())
   .Select(p=>p.PropertyType.GetGenericArguments()[0]); 
```

（我还没有编译它，它不在我的脑海中，但它应该给你一个大致的想法）

注意：EF 实际上可能会引入比您的上下文中列出的类型更多的类型，但这只会获取您在 DbContext 中明确列出的类型。

# mongodb - mongoDB 日志文件 getlasterror: 1, w: "com.mongodb.WriteConcern.REPLICAS_SAFE"

> ID：16026812
> 
> 赞同：0
> 
> 时间：2013-04-16T00:27:32.947
> 
> 标签：mongodb, spring-data-mongodb

我们有 mongoDB 主从配置。我使用属性 com.mongodb.WriteConcern.REPLICAS_SAFE 更新了 spring mongoDB 模板驱动程序以了解副本。我在日志文件中收到以下错误。

[conn2788271] runQuery 调用 xxx.$cmd { getlasterror: 1, w: "com.mongodb.WriteConcern.REPLICAS_SAFE", wtimeout: 0 }

[conn2786380] 用户断言：14830：无法识别的 getLastError 模式：com.mongodb.WriteConcern.REPLICAS_SAFE

[conn2786380] command xxx.$cmd command: { getlasterror: 1, w: "com.mongodb.WriteConcern.REPLICAS_SAFE", wtimeout: 0 } ntoreturn:1 keyUpdates:0 reslen:182 0ms

似乎错误来自此文件 [https://bitbucket.org/wesc/debian-mongodb/src/97846fbc9d31/mongodb-2.0.2/db/repl_block.cpp](https://bitbucket.org/wesc/debian-mongodb/src/97846fbc9d31/mongodb-2.0.2/db/repl_block.cpp)

如果我遗漏了什么，有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T09:08:34.137

确保您使用的是整数 1 而不是字符串“1”。

请检查：[https ://jira.mongodb.org/browse/JAVA-464](https://jira.mongodb.org/browse/JAVA-464)

# android - ActionBar - 具有居中 ImageView 的自定义视图，两侧的操作项

> ID：16026818
> 
> 赞同：41
> 
> 时间：2013-04-16T00:28:11.480
> 
> 标签：android, android-actionbar, actionbarsherlock

我需要在“主页”活动的操作栏中将自定义徽标（使用 ImageView）居中。我在这个项目中使用 ABS。[这与 SO 上发布的另一个问题（ ActionBar logo centered and Action items on side](https://stackoverflow.com/questions/12750013/actionbar-logo-centered-and-action-items-on-sides)）非常相似，但我不确定 ImageView 或搜索菜单是否有所不同，因为我没有得到我正在寻找的结果对于（居中的图像），或者如果我弄错了。基本上，我在左侧设置了一个图标，在中心插入自定义视图，并在右侧（OptionsMenu）有一个搜索图标。图像确实出现在图标的右侧，但它仍然居中。任何关于如何在操作栏中居中 ImageView 的指针将不胜感激。

主页.java：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_home);

    LayoutInflater inflater = (LayoutInflater) getSupportActionBar().getThemedContext()
            .getSystemService(LAYOUT_INFLATER_SERVICE);

    final View customActionBarView = inflater.inflate(
            R.layout.actionbar_custom_view_home, null);

    /* Show the custom action bar view and hide the normal Home icon and title */
    final ActionBar actionBar = getSupportActionBar();
    actionBar.setHomeButtonEnabled(true);
    actionBar.setDisplayHomeAsUpEnabled(false);
    actionBar.setDisplayShowTitleEnabled(false);
    actionBar.setIcon(R.drawable.ic_ab_som);
    actionBar.setCustomView(customActionBarView);
    actionBar.setDisplayShowCustomEnabled(true);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = new MenuInflater(this);
    inflater.inflate(R.menu.search, menu);
    return true;
} 
```

res/layout/actionbar_custom_view_home.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="horizontal"
android:layout_gravity="center">

<ImageView
    android:id="@+id/actionBarLogo"
    android:contentDescription="@string/application_name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:clickable="false"
    android:duplicateParentState="false"
    android:focusable="false"
    android:longClickable="false"
    android:padding="@dimen/padding_small"
    android:src="@drawable/logo_horizontal" />

</LinearLayout> 
```

资源/菜单/search.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
        android:id="@id/search_item"
        android:icon="?attr/action_search"
        android:title="@string/search_label"
        android:showAsAction="ifRoom|collapseActionView">
    </item>
</menu> 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-04-16T05:08:31.140

如果您想在 ActionBar 中心使用 imageview，请使用：

![在此处输入图像描述](https://i.stack.imgur.com/zcz95.png)

`getActionBar();`只需`getSupportActionBar();`在下面的代码中替换

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final ActionBar actionBar = getActionBar();
        actionBar.setCustomView(R.layout.actionbar_custom_view_home);
        actionBar.setDisplayShowTitleEnabled(false);
        actionBar.setDisplayShowCustomEnabled(true);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    } 
```

你的 actionbar_custom_view_home.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/actionBarLogo"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:clickable="false"
        android:focusable="false"
        android:longClickable="false"
        android:src="@drawable/ic_launcher" />

</LinearLayout> 
```

* * *

## 隐藏操作栏图标

![在此处输入图像描述](https://i.stack.imgur.com/FPJpj.png)

```
final ActionBar actionBar = getActionBar();
actionBar.setCustomView(R.layout.actionbar_custom_view_home);
actionBar.setDisplayShowTitleEnabled(false);
actionBar.setDisplayShowCustomEnabled(true);
actionBar.setDisplayUseLogoEnabled(false);
actionBar.setDisplayShowHomeEnabled(false); 
```

***注意：对于 < 11 API 使用 getSupportActionBar() 和 > 11 API 使用 getActionBar()***

* * *

***已编辑：工具栏***02/03/16

 *```
<android.support.v7.widget.Toolbar
   style="@style/ToolBarStyle"
   xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="match_parent"
   android:layout_height="wrap_content"
   android:background="?attr/colorPrimary"
   android:minHeight="@dimen/abc_action_bar_default_height_material">

    <ImageView
        android:layout_width="wrap_content"
        android:contentDescription="@string/logo"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:src="@drawable/ic_launcher"/>

 </android.support.v7.widget.Toolbar> 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-01-30T09:30:31.100

解释：

![在此处输入图像描述](https://i.stack.imgur.com/UViYa.png)

粉红色的容器是您将添加视图的真实空间。

诀窍是做一些数学运算，将视图（无论如何）居中。

在我的例子中，视图是一个 TextView。这是我的完整方法：

```
public void addTextToActionBar( String textToSet )
{
    mActionbar.setDisplayShowCustomEnabled( true );

    // Inflate the custom view
    LayoutInflater inflater = LayoutInflater.from( this );
    View header = inflater.inflate( R.layout.actionbar_header, null );

    //Here do whatever you need to do with the view (set text if it's a textview or whatever)
    TextView tv = (TextView) header.findViewById( R.id.program_title );
    tv.setText( textToSet );

    // Magic happens to center it.
    int actionBarWidth = DeviceHelper.getDeviceWidth( this ); //Google for this method. Kinda easy.

    tv.measure( 0, 0 );
    int tvSize = tv.getMeasuredWidth();

    try
    {
        int leftSpace = 0;

        View homeButton = findViewById( android.R.id.home );
        final ViewGroup holder = (ViewGroup) homeButton.getParent();

        View firstChild =  holder.getChildAt( 0 );
        View secondChild =  holder.getChildAt( 1 );

        leftSpace = firstChild.getWidth()+secondChild.getWidth();
    }
    catch ( Exception ignored )
    {}

    mActionbar.setCustomView( header );

    if ( null != header )
    {
        ActionBar.LayoutParams params = (ActionBar.LayoutParams) header.getLayoutParams();

        if ( null != params )
        {
            int leftMargin =  ( actionBarWidth / 2 - ( leftSpace ) ) - ( tvSize / 2 ) ;

            params.leftMargin = 0 >= leftMargin ? 0 : leftMargin;
        }
    }
} 
```

布局：

```
<RelativeLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:gravity="center_horizontal|center_vertical|center"
    android:orientation="horizontal" >

<TextView
    android:id="@+id/program_title"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textColor="@android:color/white"
    android:contentDescription="@string/content_description_program_title"
    android:ellipsize="end"
    android:maxLines="1"
    android:textSize="22sp"/>

</RelativeLayout> 
```

享受。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-10-31T08:08:37.737

我遇到了这个问题，这是我的解决方案：

```
ActionBar.LayoutParams layoutParams = new ActionBar.LayoutParams(
        ActionBar.LayoutParams.MATCH_PARENT, ActionBar.LayoutParams.MATCH_PARENT);
layoutParams.gravity = Gravity.CENTER_HORIZONTAL|Gravity.CENTER_HORIZONTAL;
actionBar.setCustomView(yourCustomView,layoutParams); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-16T01:03:29.613

代码中的 ImageView 相对于 LinearLayout 居中，而不是相对于操作栏。您可以在布局中添加左边距 (android:layout_marginLeft) 以调整图像位置。

其他方法不是向操作栏添加图标和操作项，而是使用内部带有图标和按钮的自定义布局。但在这种情况下，您需要自己处理操作项。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-18T18:05:41.170

派对迟到了，但如果它可以帮助其他人 - 使用图层列表并将其设置为背景。否则，徽标将基于剩余空间居中，而不是 Reinherd 提到的整个工具栏。

您可以使用具有静态背景颜色的图层列表，以及将重力设置为中心的图像，如下所示。希望能帮助到你！

**工具栏.axml**

```
<android.support.v7.widget.Toolbar
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto"
    android:id="@+id/toolbar"
    android:layout_width="match_parent"
    android:layout_height="?attr/actionBarSize"
    android:background="@drawable/toolbar_background"
    android:theme="@style/ThemeOverlay.AppCompat.Dark"
    app:popupTheme="@style/ThemeOverlay.AppCompat.Light"
    app:layout_scrollFlags="scroll|enterAlways"
    app:layout_collapseMode="pin">
</android.support.v7.widget.Toolbar> 
```

**工具栏_背景.xml**

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
  <item>
    <shape android:shape="rectangle">
      <solid android:color="@color/colorPrimary" />
    </shape>
  </item>
  <item>
    <bitmap android:src="@drawable/logo" android:gravity="center" />
  </item>
</layer-list> 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-03-04T08:28:42.647

我面临同样的问题，我建议以下解决方案：

1.  在您的 res/layout/actionbar_custom_view_home.xml 中将布局的宽度更改为 wrap_content：

    ```
    android:layout_width="wrap_content" 
    ```

2.  像这样获取操作栏的宽度：

    ```
    Display display = getWindowManager().getDefaultDisplay();
    Point size = new Point();
    display.getSize(size);
    //width of action bar is the same as width of whole screen
    final int actionBarWidth = size.x; 
    ```

3.  将 layoutListener 添加到您的 customActionBarView：

    ```
    customActionBarView.addOnLayoutChangeListener(
      new OnLayoutChangeListener() {

        @Override
        public void onGlobalLayout() {
          float x = customActionBarView.getX();
          int logoImageWidth = imageLogo.getWidth();
          int logoPosition = actionBarWidth / 2 - logoImageWidth / 2;
          if (x != logoPosition) {
            customActionBarView.setX(logoPosition);
            customActionBarView.requestLayout();
          } else {
            customActionBarView.removeOnLayoutChangeListener(this);
          }
        }
      }
    ); 
    ```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2015-12-10T10:43:40.377

我发现唯一有用的是放（根据需要放右或左，或两者兼而有之）：

```
android:layout_marginLeft|Right="?attr/actionBarSize" 
```

我在这里找到的：http: [//sourcey.com/android-custom-centered-actionbar-with-material-design/](http://sourcey.com/android-custom-centered-actionbar-with-material-design/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-03T21:39:46.910

对我来说，“layoutParams.leftMargin”起到了神奇的作用。我可以从左到右推动图标。

```
 androidx.appcompat.app.ActionBar actionBar = getSupportActionBar();
    actionBar.setDisplayOptions(actionBar.getDisplayOptions()
            | ActionBar.DISPLAY_SHOW_CUSTOM);
    actionBar.setDisplayOptions(actionBar.getDisplayOptions());
    ImageView imageView = new ImageView(actionBar.getThemedContext());
    imageView.setImageResource(R.drawable.content_copy);

    ActionBar.LayoutParams layoutParams = new ActionBar.LayoutParams(
            ActionBar.LayoutParams.WRAP_CONTENT,
            ActionBar.LayoutParams.WRAP_CONTENT
            );
    layoutParams.leftMargin = 50;
    imageView.setLayoutParams(layoutParams);

    actionBar.setCustomView(imageView); 
```*

# c# - 生成强类型 Designer.cs 文件

> ID：16026819
> 
> 赞同：0
> 
> 时间：2013-04-16T00:28:12.390
> 
> 标签：c#, webforms

在 VS2010 Web Express 中使用“转换为 Web 应用程序”功能时，会生成相应的 Designer.cs 文件。

但是，用户控件的属性声明都是使用“System.Web.UI.UserControl”，这意味着在代码隐藏文件中，不能使用自定义用户控件中的自定义属性或方法。

这可以通过手动更改设计器文件中的类型来解决，但是我有很多页面，那么有没有更好的方法让VS在生成designer.cs文件时自动执行此操作？

谢谢~

# javascript - 跨浏览器 javascript 拆分

> ID：16026821
> 
> 赞同：3
> 
> 时间：2013-04-16T00:28:16.713
> 
> 标签：javascript, internet-explorer

我需要一个“拆分”功能，它在从 8 开始的每个 IE 版本上都将以相同的方式工作（是的，只有 IE，因为这是用于使用[WebBrowser](http://msdn.microsoft.com/en-us/library/system.windows.forms.webbrowser%28v=vs.100%29.aspx)控件的应用程序）。以下代码将在 IE 8 上警告“2”，在 IE 9+ 上警告“3”：

```
var step1_slices = "One.Two.".split(new RegExp("\\.", "g"));
alert(step1_slices.length); 
```

我是第一个遇到这个问题的人还是有已知的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T02:28:47.370

> 我是第一个遇到这个问题的人吗

不，当分隔符位于字符串的开头或结尾时，较旧的浏览器会以不同的方式实现拆分。有些在两端保留空字符串，有些保留最后一个，有些像 IE，只保留空匹配，如果它们在字符串的主体中。现代浏览器都保留了两个外来者。

解释任何差异的最简单方法是让 IE9+ 像 IE8- 一样查看数组的第一个和最后一个元素，如果它们未定义或为空字符串，则将其删除。

```
String.prototype.split8=function(delim){
  var A=this.split(delim);
  if(!A[0])A.shift();
  if(!A[A.length-1)A.pop();
  return A;
} 
```

# php - 获取给定域的所有电子邮件地址

> ID：16026822
> 
> 赞同：1
> 
> 时间：2013-04-16T00:28:34.343
> 
> 标签：php, email

是否可以在 PHP 中列出给定域的所有电子邮件地址？我找到的所有解决方案都使用 Python 或 Visual Basic，我希望有人对 PHP 脚本提出建议，该脚本可以检索在特定域下注册的所有电子邮件地址，因为现有项目已经用 PHP 编写。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:39:38.010

“...检索在特定域下注册的所有电子邮件地址...”

给定域没有有效电子邮件地址的公共注册表。这必须是在您的电子邮件服务器上运行的脚本，在本地读取文件，这些文件为电子邮件服务器正在处理的给定域配置所有用户别名和电子邮件地址。这将取决于服务器上运行的电子邮件服务器软件的类型以及服务器操作系统等。

它可以在 PHP 中完成，但没有办法公开地对任何域进行——它必须专门为您的服务器完成，并在该服务器上本地运行，并具有读取关键配置文件的适当权限。

# mysql - 变量 SQL 列默认值

> ID：16026826
> 
> 赞同：1
> 
> 时间：2013-04-16T00:28:59.633
> 
> 标签：mysql, sql, database-design

我希望在每个会话的基础上指定列的默认值。下面的脚本不起作用，但描述了我想如何使用它。我目前使用的是 MySQL 5.5.28，但如有必要可以升级。

```
CREATE TABLE my_tbl (
 id INT NOT NULL AUTO_INCREMENT,
 data VARCHAR(45),
 date_created  TIMESTAMP DEFAULT   CURRENT_TIMESTAMP, 
 date_modified TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
 created_by    INT DEFAULT         CUSTOM_USER_ID, 
 modified_by   INT ON UPDATE       CUSTOM_USER_ID
 PRIMARY KEY (id)
) ENGINE = InnoDB;

-- Will set created_id and modified_id=111
SET @CUSTOM_USER_ID=111;
INSERT INTO my_tbl(data) VALUES('hello');

-- Will set modified_id=222
SET @CUSTOM_USER_ID=222;
UPDATE my_tbl SET data='goodby' WHERE id=1;

-- Will keep modified_id=222
SET @CUSTOM_USER_ID=333;
UPDATE my_tbl SET data='hello again',modified_id=modified_id WHERE id=1; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:41:56.720

所以我发布了一个替代方案：

```
delimiter $$

SET @CUSTOM_USER_ID=111;

CREATE TRIGGER myTrigger_INS BEFORE INSERT ON my_tbl FOR EACH ROW
BEGIN
    IF NEW.created_by IS NULL OR NEW.created_by = '' THEN
        SET NEW.created_by = @CUSTOM_USER_ID;
    END IF;
END$$

CREATE TRIGGER myTrigger_UPD BEFORE UPDATE ON my_tbl FOR EACH ROW
BEGIN
    IF NEW.modified_by IS NULL OR NEW.modified_by = '' THEN
        SET NEW.modified_by = @CUSTOM_USER_ID;
    END IF;
END$$

delimiter ; 
```

[学分](http://www.java2s.com/Tutorial/MySQL/0260__Trigger/Beforeinserttrigger.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:33:48.797

这是不可能的。从 MySQL 文档中阅读以下内容：

> 数据类型规范中的 DEFAULT value 子句指示列的默认值。除了一个例外，默认值必须是一个常量；它不能是函数或表达式。例如，这意味着您不能将日期列的默认值设置为 NOW() 或 CURRENT_DATE 等函数的值。例外情况是您可以将 CURRENT_TIMESTAMP 指定为 TIMESTAMP 列的默认值。请参见第 11.3.5 节，“TIMESTAMP 的自动初始化和更新”。

您不能使用这样的表达式来定义默认值。

# quickblox - 如何检索应用程序的热门标签？（Quickblox iOS SDK）

> ID：16026829
> 
> 赞同：0
> 
> 时间：2013-04-16T00:29:32.793
> 
> 标签：quickblox

quickblox 管理仪表板中有一个非常有用的功能——流行标签。

我想知道我是否可以通过某种请求获得所有这些标签（标签，而不是用户）？（我正在使用 quickblox iOS SDK）。我需要他们为用户建立一个建议列表。我真的希望有一个替代解决方案，而不是使用自定义对象来处理它（为此工作太多了）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T09:46:25.907

iOS SDK 不包含用于直接检索流行标签的 API。您可以硬编码所有标签或从用户那里获取标签，然后通过方法通过选定的标签检索用户

**usersWithTags:delegate:** ( [http://sdk.quickblox.com/ios/Classes/QBUsers.html](http://sdk.quickblox.com/ios/Classes/QBUsers.html) )

将来可能会将此选项添加到 SDK。

# c++ - 在 c/c++ 中将变量传递给 SQL/MYSQL 语句

> ID：16026831
> 
> 赞同：-2
> 
> 时间：2013-04-16T00:29:43.440
> 
> 标签：c++, c

我想知道将变量传递到 c/c++ 中的 SQL 语句时的语法到底如何？我已经搜索了各种网站，但我仍然无法获得这样做的确切方法。请大家指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:44:01.260

您没有在问题中指出您使用什么库来生成 SQL 语句，但通常它们使用字符串，在这种情况下简单的连接应该可以工作。以[mysql_query()](http://dev.mysql.com/doc/refman/5.0/en/mysql-query.html)为例：

```
#include <string>

std::string tableName = "Foo";

// Assume we already have a valid `connection`:

mysql_query(connection, ("SELECT * FROM " + tableName).c_str()); 
```

# google-chrome - 有没有办法让 Chrome Canary 自动更新？

> ID：16026832
> 
> 赞同：2
> 
> 时间：2013-04-16T00:29:54.900
> 
> 标签：google-chrome

有没有办法让 Google Chrome Canary 自动更新到最新的构建/版本？这样我就可以真正拥有并在网络的最前沿进行测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-04T08:40:39.277

根据[http://www.omgchrome.com/5-reasons-to-use-google-chrome-canary/](http://www.omgchrome.com/5-reasons-to-use-google-chrome-canary/)，确实如此，而且每天都如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-29T08:53:44.020

由于您的操作系统设置，它可能不会自动更新，“Google 更新服务”必须在后台运行。如果您使用 Windows，那么您可以转到 msconfig.exe -> services(tab)，只需选中“Google Update Service (gupdate)”和“Google Update Service (gupdatem)”复选框，然后单击 Apply。

# java - 如何在 Java 中每行打印特定数量的空格

> ID：16026843
> 
> 赞同：0
> 
> 时间：2013-04-16T00:31:40.417
> 
> 标签：java

我正在尝试让 Java 程序每行打印特定数量的空格，然后下拉以继续列表。我正在查找用户指定范围内的所有素数，然后打印出该范围内的素数和素数本身。每当程序发现一个不是素数的数字时，它应该打印一个 - 。到目前为止，我有：

导入 java.util.Scanner；

公共类 PrimeNums {

```
public static void main(String[] args) {
    Scanner keyboard= new Scanner(System.in);
    int startingVal;
    int endingVal;
    int index;
    int currNum = 2;
    boolean prime;
    int count=0;

    //***  Input  ***

    System.out.println("Enter the Starting Number of the Range: ");
    startingVal = keyboard.nextInt();
    System.out.println("Enter the Ending Value of the Range: ");
    endingVal = keyboard.nextInt();

    //*** Checks for Parameters  ***

    while(startingVal>1000||startingVal%10!=0){
        System.out.println("Starting Value was not evenly divisible by 10\. Reenter Starting Value: ");
        startingVal= keyboard.nextInt();
    }
    while(startingVal>=endingVal||endingVal%10!=0||endingVal>1000){
        System.out.println("Ending Value was less than Starting Value or Did Not Follow Guideline. Reenter Ending Value: ");
        endingVal=keyboard.nextInt();
    }

    //***  Stores Checked Variables  ***

    int range = (endingVal);
    int[] primeArray = new int[10];

    //*** Checks for all Prime Numbers  ***

    for(index=startingVal; index<range; index++){

        if(index==1||index%2==0||index%3==0||index%4==0||index%5==0||index%6==0||index%7==0||index%8==0||index%9==0||index%10==0){
            System.out.print("-");
        }else{
            count++;
            System.out.print(index);
        }
    }
    System.out.println("There are " + count + " Prime Numbers in this range.");
}

} 
```

到目前为止，这个程序找到了范围内的所有素数并将它们打印出来。但是，我需要将代码以 10 个一组打印出来。像这样：这里的范围是：70-200。

* * *

71 - 73 - - - - - 79 - | 80

*   *   83 - - - - - 89 - | 90
*   *   *   *   *   *   97 - - - | 100

101 - 103 - - - 107 - 109 - | 110

*   *   113 - - - - - - - | 120
*   *   *   *   *   *   127 - - - | 130

131 - - - - - 137 - 139 - | 140

*   *   *   *   *   *   *   *   149 - | 150

151 - - - - - 157 - - - | 160

*   *   163 - - - 167 - - - | 170
*   *   173 - - - - - 179 - | 180

181 - - - - - - - - - | 190

191 - 193 - - - 197 - 199 - | 200

* * *

70到200之间有27个质数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:39:28.397

通过用 index 减去起始值，您将获得循环编号，这与您使用计数器时相同。一旦知道这一点，如果计数器可被（如您指定的每组输出的数量，10）`%sizeOfSet == 0`整除，则将返回 true 。`sizeOfSet`

```
int sizeOfSet = 10;
if ((index-startingVal) %sizeOfSet == 0){
//prints out an empty line
System.out.printf("%n");
} 
```

此代码应包含在 if-else 语句之后的 for 循环末尾。

# python - 我的斐波那契数列生成器出了什么问题？

> ID：16026844
> 
> 赞同：3
> 
> 时间：2013-04-16T00:31:51.010
> 
> 标签：python, fibonacci

我正在尝试解决[Project Euler 上的问题 #25](http://projecteuler.net/problem=25)。这是我到目前为止所得到的：

```
def fibonacci(length):
    fibs = [0,1]
    while length > len(fibs):
        fibs.append(fibs[-1] + fibs[-2])        
    return fibs

fibs = fibonacci(5000)

for i in fibs:
    if len(str(i)) > 1000:
        print i

        ## The location of the number in the Fibonacci set.
        print [j for j, x in enumerate(fibs) if x == i] 
```

我测试过的每个数字（包括一些[大](http://www.maths.surrey.ac.uk/hosted-sites/R.Knott/Fibonacci/fibtable.html)数字）都会匹配，但 Project Euler 不接受我得到的答案。

我读到答案是第 4782 个数字，但我知道第一个超过 1000 位的数字是第 4787 个，

```
11867216745258291596767088485966669273798582100095758927648586619975930687764095025968215177396570693265703962438125699711941059562545194266075961811883693134762216371218311196004424123489176045121333888565534924242378605373120526670329845322631737678903926970677861161240351447136066048164999599442542656514905088616976279305745609791746515632977790194938965236778055329967326038544356209745856855159058933476416258769264398373862584107011986781891656652294354303384242672408623790331963965457196174228574314820977014549061641307451101774166736940218594168337251710513138183086237827524393177246011800953414994670315197696419455768988692973700193372678236023166645886460311356376355559165284374295661676047742503016358708348137445254264644759334748027290043966390891843744407845769620260120918661264249498568399416752809338209739872047617689422485537053988895817801983866648336679027270843804302586168051835624516823216354234081479331553304809262608491851078404280454207286577699580222132259241827433 
```

欧拉计划说我尝试过的每一个答案都是错误的。（显然我还没有尝试 4782，因为那会作弊。）

我非常接近，显然出了点问题，但是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T01:02:59.577

你正在检查`len(str(i)) > 1000`，当根据问题陈述你应该检查时`len(str(i)) == 1000`。

此外，您将答案中的数字误解为斐波那契数。实际上，如果你仔细阅读，它是 fib 函数被调用的次数。你的斐波那契数 4782 是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T00:59:52.500

根据第 25 个问题解决者的 projecteuler 论坛，您是正确的。

以 1322 开头的第二个大数字...不是斐波那契数。

一些检查 x 是否为斐波那契数的函数：

```
 import decimal
   def check_fib(n):
       a, b = decimal.Decimal(5*(n**2) + 4), decimal.Decimal(5*(n**2) - 4)
       return any(int(x.sqrt())==x for x in (a, b)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T01:17:33.983

~~正如 thkang 指出的那样，伙计们的人数是错误的，~~请参阅 wims 评论。你的算法有效。

```
def fibonacci(length):
    fibs = [0,1]
    while length > len(fibs):
        fibs.append(fibs[-1] + fibs[-2])        
    return fibs

fibs = fibonacci(5000)
for i,n in enumerate(fibs):

    if len(str(n)) >= 1000:
        print i
        print n
        break 
```

这是我用来解决它的方法，我得到的答案与您相同。

```
def fib():
    x, y = 0, 1
    while True:
        yield x
        x += y
        x, y = y, x
f = fib()
for i,n in enumerate(f):
    if len(str(n)) >= 1000:
        print i
        print n
        break 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T01:29:15.760

除了问题（和问题）之外，您还可以使用生成函数学斐波那契函数直接获取斐波那契数。

```
from decimal import Decimal
from math import sqrt

#sqrt_5 = Decimal(sqrt(5))
sqrt_5 = decimal.Decimal(5).sqrt() # As thkang suggested!
fib = lambda n: (1/sqrt_5)*( (2/(-1+ sqrt_5))**(n+1) - (2/(-1-sqrt_5))**(n+1))

for i in xrange(10000):
   if fib(i).adjusted()+1 == 1000:
      print i+1 
```

4782 是第一个有 1000 位数字的代码。

输出：[4782, 4783, 4784, 4785 4786]。

关于使用生成函数的斐波那契公式[http://www.math.ufl.edu/~joelar/generatingfibonacci.pdf](http://www.math.ufl.edu/~joelar/generatingfibonacci.pdf)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T09:27:03.493

您无需任何编程即可获得解决方案。

我们知道，如果 log_10(m)>=k-1，数字 m 至少使用 k 位十进制表示。

所以基本上我们要做的就是解决不等式：

log_10(F_n)>=999

使用 F_n 的显式形式，您知道它是最接近 ((1+Sqrt(5))/2)^n/Sqrt(5) 的整数。我们可以将这个近似值用于 F_n。请记住，这里有一个小错误，但我们稍后会处理它。

所以不等式变成：

log_10(((1+Sqrt(5))/2)^n/Sqrt(5))>=999

使用一些对数恒等式和一些排序后，它看起来像：

n>=(999+log_10(Sqrt(5)))/log_10((1+Sqrt(5))/2)~=4781.8592

所以我们的最终答案应该在这个附近，让我们讨论一下我之前提到的错误。近似误差为 ((1-Sqrt(5))/2)^n/Sqrt(5)。(1-Sqrt(5))/2~=-0.68，它的绝对值小于1，所以取幂后越来越接近0。(-0.68)^4781是一个很小的数，所以差F_n 的对数和我们使用的近似值（这些是 1000 左右的数字）之间的值甚至更小。在不精确计算的情况下，考虑到 F_n 的大小，这个差异可以完全忽略。因此，解是最小整数n，对于n>=4781.8592，即4782。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-10-20T21:15:16.680

这个生成器给出整数，我已经测试过了`fib(21)`

```
from decimal import Decimal
from math import sqrt

while True:
#sqrt_5 = Decimal(sqrt(5))
    sqrt_5 = Decimal(5).sqrt() # As thkang suggested!
    fib = lambda n: (1/sqrt_5)*( (2/(-1+ sqrt_5))**(n) - (2/(-1-sqrt_5))**(n))
    a=input()
    if a=="x":
        break
    d=round(fib(int(a)))

    print("\t"+str(d)) 
```

要退出程序，只需键入`x`

# javascript - 用整数验证数量

> ID：16026854
> 
> 赞同：0
> 
> 时间：2013-04-16T00:32:38.750
> 
> 标签：javascript, validation

我试图让我的输入字段只接受整数并编写了一些 java 来帮助验证，但是每次我单击下一个输入以插入一个值时，它都会发出我的警报。我错过了什么吗？

```
<script type="text/javascript">
    var cartAmount, subtotal, pstAmount, pstTax, gstTax, taxAmount, shipCharge, afterTax; 

    function validate() {
        //Whole Numbers with Regexp
            var rx = new RegExp(/\d+/);

            if(document.getElementsByClassName("inputValue").value != rx || document.getElementsByClassName("inputValue").value == "") {
                alert("Please use only whole quantities.");
                return false;
            }
    }
    function sumCart() {

        //Adding Cart Values
            cartAmount = (document.frmMain.item1.value * 3.99) + (document.frmMain.item2.value * 5.99); 

        //Finding Subtotals
            document.frmMain.subtotalAmt.value = Math.round(cartAmount*100)/100;
            subtotal = document.frmMain.subtotalAmt.value;

        //Finding Taxes
            pstTax = document.frmMain.taxAmount.value;
            gstTax = .05;

            pstAmount = Math.round((subtotal * pstTax)*100)/100;
            gstAmount = Math.round((subtotal * gstTax)*100)/100;

            taxAmount = parseFloat(pstAmount,10) + parseFloat(gstAmount,10);

            document.getElementById("tax").innerHTML = "Tax in dollars is $" + Math.round(taxAmount * 100)/100;

        //Finding Total
            shipCharge = 0;
            afterTax = parseFloat(subtotal) + parseFloat(taxAmount) + parseFloat(shipCharge);
            document.frmMain.totalAmt.value = Math.round(afterTax*100)/100;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:55:56.493

试试这个验证功能：

```
function validate() {
    //Whole Numbers with Regexp
    var rx = new RegExp(/^\d+$/);
    inputs = document.getElementsByClassName("inputValue");
    for (var i = 0; i < inputs.length; i++) {
        var input = inputs[i].value;
        if (!rx.test(input)) {
           alert("Please use only whole quantities.");
           return false;
        }
    }
} 
```

您的代码有几个问题：

1.  正则表达式`/\d+/`只检查值中是否有任何数字，它不检查它是否*只有*数字。您需要锚定到开头和结尾，`^`并`$`检查整个值。

2.  您正在使用`value != rx`，它不执行正则表达式测试。你必须使用`rx.test()`.

3.  `getElementsByClassName`返回元素的集合，而不是单个元素。您需要遍历它们以获取值。

# cordova - 为 phonegap/jqm 转换网页优化的画布游戏

> ID：16026855
> 
> 赞同：0
> 
> 时间：2013-04-16T00:32:40.000
> 
> 标签：cordova, jquery-mobile, html5-canvas

我之前开发了一个用于网络浏览器的画布游戏，但是我想将它合并到我目前正在构建的 phonegap/query 移动应用程序中，而无需重写大量游戏。然而，我有一些问题需要克服。

1.  游戏是横向的，如何将其设置为永久在横向视图中（我想到了一个旋转的div？）
2.  固定其大小的最佳方法是什么（目前为 800 x 500）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T03:54:59.723

1.  要将方向永久设置为横向，只需在 xcode 中设置（主信息屏幕上有一个方向下拉菜单）。Phonegap/xcode 会为您解决这个问题。

2.  您只是想缩小（<= 3GS）/扩展（>= 4）您的应用程序视图吗？视网膜屏幕呢？您可以为此使用 css，但确切的代码将取决于您的需要。

# c - 套接字事务未通过

> ID：16026856
> 
> 赞同：0
> 
> 时间：2013-04-16T00:32:45.030
> 
> 标签：c, sockets, http, network-protocols

我正在编写一个在将页面发送到浏览器时遇到问题的网络服务器。它正确发送了第一个文件（该文件包括两个 css 文件）。但是，在它发送第二个文件后，浏览器停止请求数据。它总是错过完成页面所需的 css 文件之一。

这是一些交易：

```
GET / HTTP/1.1
Host: website.com
Connection: keep-alive
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko)               Chrome/26.0.1410.43 Safari/537.31
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

HTTP/1.1 OK 200
Server: thserver
Date: Mon Apr 15 17:29:51 2013
Content-Length: 564

Data received: GET /main.css HTTP/1.1
Host: website.com
Connection: keep-alive
Accept: text/css,*/*;q=0.1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.31 (KHTML, like Gecko)     Chrome/26.0.1410.43 Safari/537.31
Referer: http://website.com/
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3

HTTP/1.1 OK 200
Server: thserver
Date: Mon Apr 15 17:29:51 2013
Content-Length: 386 
```

如果有人也知道验证http事务的好方法，那也会有所帮助。我确实查看了 chrome 的开发工具并显示它正在等待接收最后一个文件，但我似乎从未在服务器上收到接收请求。

另外，我使用 telnet 来模拟浏览器，它运行良好。这是我输入的内容：

```
GET / 
GET /index.css
GET /main.css 
```

它每次都发回文件。

代码继续使用 read(2) 轮询套接字，但在第三个文件的请求应该到达时继续返回 EAGAIN 或 EWOULDBLOCK。

这是套接字 io 的代码：

```
const int port_number   = 80;
const int timeout       = 5000000;
const int wait_time     =   10000;

PORT_CALL {

    /* declarations here */

    read_client:

    result = read( socket[ 0 ], &header_buffer[ bytes_read ], BUFFER_SIZE - bytes_read );

    if( result < 0 ){
        if( errno & ( EWOULDBLOCK | EAGAIN ) ){

            if( bytes_read > 0 ){

                bytes_read = 0;
                read_timeout = 0;
                goto respond_request;
            }
            if( read_timeout < timeout ){
                read_timeout += wait_time;
                usleep( wait_time );
                goto read_client;
            }
        }
        goto exit_thread;

    } else if( result > -1 ){
        bytes_read += result;
        goto read_client;
    }
    respond_request:

    /* respond stuff start */

    /* respond stuff end */

    goto read_client;

    exit_thread: 
```

这是涉及创建套接字的代码

```
temp->socket_descriptor = socket( AF_INET, SOCK_STREAM, 0 );

temp->server_address.sin_family = AF_INET;
temp->server_address.sin_addr.s_addr = INADDR_ANY;
temp->server_address.sin_port = htons( * temp->port_number );

if( bind( temp->socket_descriptor,
          ( struct sockaddr * ) &temp->server_address,
          sizeof( temp->server_address ) ) < 0 ) ..

listen( temp->socket_descriptor, 10 );

wait_for_client:

new_socket = accept( temp->socket_descriptor,
                     ( struct sockaddr * ) &client_address,
                     &address_length ); 
```

我知道我可能要求太多了。任何人都知道一个很好的调试工具可以让我解决这个问题，我也将不胜感激。如果有人建议使用帮助我解决问题的调试器工具，我也会认为这是一个答案。

编辑：写入和读取功能现在处于循环中，但问题仍然存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T09:36:01.140

如果您只是学习如何使用数据包捕获进行调试，那么使用wireshark 可能更容易开始。它提供了一个 GUI，可以轻松定义简单的规则并直观地检查捕获。当然，这只是一个口味问题，所以只是一个建议。

至于代码，很难说可能是什么问题，因为它几乎没有[SSCCE](http://sscce.org/)。不过我有一些建议，

1.  如果你要检查类似的东西`if( filename )`，那么`filename = NULL;`在你释放它之后。
2.  如果要将缓冲区归零，请对其进行 memset 或循环遍历其整个大小。里面的测试`for( ; header_buffer[ i ]; i++ ) header_buffer[ i ] = 0;`看起来很危险。
3.  除了 < 0 之外，准备从返回 0 的套接字读取和写入。
4.  循环进行写入。

您的读取是循环直到它有完整的请求，还是直到它有超过 0 个字节？看起来像后者，那是不对的。

**编辑，在下面添加文本：** 示例中的代码仍然不是很完整（write fex 在哪里？），所以很难猜出确切的问题。然而，有几个相当致命的缺陷。

1.  不应该像现在这样测试 errno `if( errno & ( EWOULDBLOCK | EAGAIN ) )`，. 在 Linux 上，您可以测试 if (errno == EWOULDBLOCK) 因为 EAGAIN 和 EWOULDBLOCK 是相同的。在它们不同的系统上，使用两个带有 || 的测试。它们之间。如果 errno 是 fex ECONNRESET，则当前代码返回非零值（在 Linux 上）。

2.  现在代码在技术上涵盖了读取返回 0，但不是作为特殊情况。读取返回 0 表示连接正在关闭，您不应再读取套接字。

关于您的 Web 服务器中可能存在的问题的一个疯狂猜测（与上面的 #2 相关）是客户端在接收到第三个文件之前断开连接，并且服务器在关闭的套接字上保持忙碌循环。

我建议浏览[Beejs 指南](http://beej.us/guide/bgnet/output/html/singlepage/bgnet.html)或一些关于系统和套接字编程的书。

# c - 读取设备状态报告 ANSI 转义序列回复

> ID：16026858
> 
> 赞同：11
> 
> 时间：2013-04-16T00:33:00.830
> 
> 标签：c, terminal, ncurses, xterm, ansi-escape

我正在尝试使用以下代码检索 VT100 终端中光标的坐标：

```
void getCursor(int* x, int* y) {
  printf("\033[6n");
   scanf("\033[%d;%dR", x, y);
} 
```

我正在使用以下 ANSI 转义序列：

> 设备状态报告 - ESC[6n
> 
> 将光标位置报告给应用程序（就像在键盘上键入一样）ESC[n;mR，其中 n 是行，m 是列。

代码编译并发送 ANSI 序列，但是，在接收到它后，终端将`^[[x;yR`字符串打印到，`stdout`而不是`stdin`让我无法从程序中检索它：

![终端窗口](https://i.stack.imgur.com/PKhP5.png)

显然，字符串是为程序指定的，所以我一定做错了什么。有人知道它是什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-06-07T22:05:43.017

我问光标位置。如果我在 100 毫秒后没有答案（这是任意的），我想控制台不是 ansi。

```
/* This function tries to get the position of the cursor on the terminal. 
It can also be used to detect if the terminal is ANSI.
Return 1 in case of success, 0 otherwise.*/

int console_try_to_get_cursor_position(int* x, int *y)
{
    fd_set readset;
    int success = 0;
    struct timeval time;
    struct termios term, initial_term;

    /*We store the actual properties of the input console and set it as:
    no buffered (~ICANON): avoid blocking 
    no echoing (~ECHO): do not display the result on the console*/
    tcgetattr(STDIN_FILENO, &initial_term);
    term = initial_term;
    term.c_lflag &=~ICANON;
    term.c_lflag &=~ECHO;
    tcsetattr(STDIN_FILENO, TCSANOW, &term);

    //We request position
    print_escape_command("6n");
    fflush(stdout);

    //We wait 100ms for a terminal answer
    FD_ZERO(&readset);
    FD_SET(STDIN_FILENO, &readset);
    time.tv_sec = 0;
    time.tv_usec = 100000;

    //If it success we try to read the cursor value
    if (select(STDIN_FILENO + 1, &readset, NULL, NULL, &time) == 1) 
      if (scanf("\033[%d;%dR", x, y) == 2) success = 1;

    //We set back the properties of the terminal
    tcsetattr(STDIN_FILENO, TCSADRAIN, &initial_term);

    return success;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T16:52:27.383

您的程序正在运行，但正在等待 EOL 字符。

`scanf`是面向行的，因此它在处理之前等待新行。尝试运行您的程序，然后按回车键。

解决方案是使用其他不需要换行的东西来读取输入，然后使用 sscanf 解析出值。

您还需要使标准输入非阻塞，否则在缓冲区已满或标准输入关闭之前您将无法获得输入。看到这个问题[Making stdin non-blocking](https://stackoverflow.com/questions/8101079/making-stdin-non-blocking)

您还应该`fflush(stdout);`在 printf 之后调用以确保它确实被写入（printf 通常是行缓冲的，因此如果没有换行符，它可能不会刷新缓冲区）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-30T20:44:39.297

我相信您确实在标准输入中得到了预期的响应。但想象一下实际发生的情况：

*   您将请求作为转义序列发送到标准输出
*   终端接收它并制定相应的答案作为转义序列
*   答案被发送到标准输入
*   调用 scanf 并通过 shell 重定向标准输入，其中 readline 库用于交互式和可编辑的用户输入
*   readline**捕获**转义序列而不是将其传递给终端
*   readline 不使用 ESC 字符重新制定它以防止执行控制序列，而是通过仅使用可打印字符使其可读
*   奇怪的答案到达 scanf 但为时已晚
*   奇怪的答案也会回显到标准输出，以便用户可以立即看到她输入的内容。

为避免这种情况，请改用`getc()`( `==fgetc(stdin)`) 循环。如果遇到 ESC ( `0x1B`)，则将以下字符转储到字符串中，直到找到 ESC 序列的最终分隔符（在您的情况下`'n'`）。之后，您可以使用`sscanf(esqString, formatString, ...)`.

但是在遇到循环之前，您需要将[termios 更改为原始模式](https://stackoverflow.com/a/6869218/3281279)（查看下面的代码示例）。否则没有什么不同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-07-01T15:28:16.550

```
#include <stdlib.h>
#include <stdio.h>
#include <conio.h>

void readCoord(void* row, void* col){
    int i = 0;
    char* input = malloc(10);
    printf("\e[6n");
    while(!_kbhit()) _sleep(1);
    while(_kbhit()) *(input + (i++)) = getch();
    *(input + i) = '\0';
    sscanf(input, "\e[%d;%dR", row, col);
}

void main(void){
    int i = 0, r, c;
    char* coord = malloc(10);
    printf("Hello");
    readCoord(&r , &c);
    printf("\nYour coordinate is (%d, %d)", c, r);
} 
```

`_kbhit()`用于检测输入（DSR 被视为在键盘上键入），并 `getch()`从标准输入中读取和删除字符

该程序依赖于`conio.h`，这不是标准，因此不推荐用于可移植的 C 程序。

# php - 新的 php loadHTML 错误 500

> ID：16026859
> 
> 赞同：0
> 
> 时间：2013-04-16T00:33:13.240
> 
> 标签：php, html, load, getelementbyid

我对 php 完全陌生。

运行此代码（我在 SO 中找到）在执行第 4 行时收到错误 500：

```
$html = $data->saveHTML(); 
```

这段代码有什么问题？我是否必须在 php.ini 中声明某些内容才能运行代码？

```
<?php

$dom= new DOMDocument();
$dom->loadHTMLFile('aTest.html');

$data = $dom->getElementById("someDiv");
$html = $data->saveHTML();

echo $html;
?> 
```

并且网页在同一个文件夹中（我使用 IIS7 和 php）：

```
<HTML>
<HEAD>
    <META NAME="GENERATOR" Content="Microsoft Visual Studio .NET 7.1">
    <TITLE>Test</TITLE>
</HEAD>
<BODY>
        <div id="someDiv">
            Hello World!
        </div>
</BODY> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:35:40.870

`DOMElement`没有`saveHTML`办法。那是一种[方法`DOMDocument`](http://php.net/manual/en/domdocument.savehtml.php)。

```
$data = $dom->getElementById("someDiv");
$html = $dom->saveHTML($data); 
```

您应该考虑在开发过程中打开错误报告。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-16T00:39:05.610

可以试试这个。它可以帮助你。

```
$html = $data->saveHTML($dom); 
```

# cassandra - cql2和cql3之间的Cassandra CQL不兼容

> ID：16026863
> 
> 赞同：1
> 
> 时间：2013-04-16T00:33:37.197
> 
> 标签：cassandra, cql

似乎动态添加新列在 Cassandra CQL3 中不起作用；说我有这张桌子：

> cqlsh:Keyspace2> 从用户中选择 *；
> 
> 用户名 | 出生年份 | 性别 | 密码 | session_token | 状态
> 
> ------------+------------+--------+------------+--- ------------+--------
> 
> 史密斯 | 1968 | 空 | ch@ngem3a | 空 | 无效的
> 
> 史密斯2 | 1963 | 空 | ch@ngem3a2 | 空 | 无效的
> 
> cqlsh:Keyspace2> 插入用户 (user_name, x) 值 ('jsmith',100);

**>错误请求：未知标识符 x**

> 也许您打算使用 CQL 2？启动 cqlsh 时尝试使用 -2 选项。

但警告是正确的，当我去 CQL2 时同样的事情：

```
> Blockquote

cqlsh:Keyspace2> exit
[root@bdvm1 ~]# cqlsh
Connected to Test Cluster at localhost:9160.
[cqlsh 2.2.0 | Cassandra 1.1.9-dse-2.2.2-SNAPSHOT | CQL spec 2.0.0 | Thrift protocol 19.33.0]
Use HELP for help.
cqlsh> use Keyspace1;
cqlsh:Keyspace1> select * from users;
 KEY   | birth_year | gender
-------+------------+--------
  TEST |       1968 |      m
  TEST1 |       1968 |      f

cqlsh:Keyspace1> insert into users (KEY, x) values ('jsmith',100);
cqlsh:Keyspace1> select * from users;
 KEY,TEST | birth_year,1968 | gender,m
 KEY,TEST1 | birth_year,1968 | gender,f
 KEY,jsmith | x,100 
```

有谁知道为什么？我原以为 CQL3 是向后兼容的..

谢谢，马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T13:28:26.303

您需要阅读[http://www.datastax.com/dev/blog/cql3-for-cassandra-experts](http://www.datastax.com/dev/blog/cql3-for-cassandra-experts)和[http://www.datastax.com/dev/blog/thrift-to-cql3](http://www.datastax.com/dev/blog/thrift-to-cql3)。第一个特别解释了为什么 CQL2 不能为许多常见的 Cassandra 设计模式建模，以及我们如何在 CQL3 中解决这些问题。

简短回答：CQL2 所谓的“行中的动态列”在 CQL3 中表示为“分区中的多行”。为了减少混淆，我们现在将 name:value 的原始存储引擎原子称为单元格，而不是列，并将一组具有公共键的单元格称为分区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T12:54:50.607

直接回答是否定的，CQL3 向后不兼容（请参阅[cql3 专家](http://www.datastax.com/dev/blog/cql3-for-cassandra-experts)）。但这并不意味着他们违背了向后兼容的承诺。CQL3 背后的基础 API 仍然是 Thrift API，从 0.7 开始具有相同的功能，只是实现方式发生了变化。.

# css - 使用 css 显示更多功能

> ID：16026867
> 
> 赞同：5
> 
> 时间：2013-04-16T00:34:50.640
> 
> 标签：css, styling

我目前正在开发一个 asp.net mvc 应用程序，并将 css3 用于我的所有显示。

我在屏幕上有一些文字，我想向用户展示一定数量的文字，并能够单击链接以“显示更多”。

所以我会有一个设置高度的 div 并单击显示更多将显示其余内容。

这可以通过css来实现吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-16T00:49:09.260

您可以使用选中（或单选）输入来控制相邻 div 的可见性。您还可以隐藏输入控件并操纵输入的位置等，使其显示在内容下方。

```
<div class="container">
<input id="ch" type="checkbox">
<label for="ch"></label>
<div class="text"> your actual text goes here</div>
</div>

.text {
    height: 100px;
    overflow: hidden;
}
.container {
    position: relative;
}
label {
    position: absolute;
    top: 100%;
}
input {
    display: none;
}
label:after {
    content: "Show More";
}
input:checked + label:after {
    content: "Show Less";
}
input:checked ~ div {
    height: 100%;
} 
```

[http://jsfiddle.net/ExplosionPIlls/6sj4e/](http://jsfiddle.net/ExplosionPIlls/6sj4e/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T00:39:26.477

您必须使用 css 才能使其看起来正确（在底部显示更多内容），但解决方案看起来像

```
<a id="showmore" href="#">Show More</a>
<div id="content">lots of content</div> 
```

CSS：

```
<style>
#content { height: 100px; overflow: hidden; }
a#showmore:visited + #content { height: auto; overflow: visible}
</style> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T01:00:09.177

您可以使用`:target`选择器。

**HTML**

```
<a id="showmemore" href="#contentofsite">Show More</a>
<div id="contentofsite">
    ......
    ......
    ......
    ......
</div> 
```

**CSS**

```
#contentofsite { 
    height: 50px; 
    overflow: hidden; 
}
#showmemore + #contentofsite:target { 
    height: auto;
    overflow: visible;
} 
```

[http://jsfiddle.net/MfyPM/](http://jsfiddle.net/MfyPM/)

* * *

或者你可以使用`:focus`伪类。

**HTML**

```
<a id="showmemore" tabindex="0" href="#">Show More</a>
<div id="contentofsite">
    ......
    ......
    ......
    ......
</div> 
```

**CSS**

```
#contentofsite { 
    height: 50px; 
    overflow: hidden; 
}
#showmemore:focus + #contentofsite { 
    height: auto;
    overflow: visible;
} 
```

[http://jsfiddle.net/MfyPM/1/](http://jsfiddle.net/MfyPM/1/)

# c# - 提早返回还是让代码完成更快？

> ID：16026868
> 
> 赞同：5
> 
> 时间：2013-04-16T00:34:50.797
> 
> 标签：c#, performance, if-statement, return

如果我有一个包含大量 if else 语句的方法，例如：

```
public void myMethod()
{
    if(..)
    else if(..)
    else if(...)
    else if(...)
    else if(...)

    //and so on            
} 
```

将 return 放在这些语句中会更快，以便在发现一个语句为真后不检查其余代码，还是让编译器命中结束括号会更快？

我想这归结为一个问题：return 语句是否有效？

编辑：问题的重点：假设您有一个不断运行的游戏循环，其代码包含很多方法和“else ifs”。如果我必须每秒更新 2000 个不同的对象 60 次，那就是每秒检查 120000 个“else ifs”（至少）。因此，随着时间的推移，这个问题的答案可能会产生影响。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-16T00:35:37.857

没关系。
任何理智或疯狂的编译器都会为任一选项生成相同的字节码。（假设你写的代码实际上是等价的）

您应该使用更具可读性的方法。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-16T02:50:53.260

SLaks 的回答当然是正确的。但我认为你提出这个问题的事实表明你对 if-else 的含义有误解。当你说

```
if(x) X();
else if(y) Y();
else if(z) Z();
return; 
```

这意味着与

```
if(x)
{
  X();
}
else
{
  if (y)
  {
    Y();
  }
  else
  {
    if (z)
    {
      Z();
    }
  }
}
return; 
```

如果，比如说，分支`x`被选中，那么`y`永远不会被检查；控制直接跳到`return`后面`X()`。

事实上，在 C# 中没有“else if”之类的东西——或者 C、C++、Java 或 JavaScript。只有“其他”；如果您碰巧在`if`之后发表声明`else`，那是您的事。没有比这更多的“如果”

```
if (x) X();
else while(y) Y(); 
```

是一个“else while”语句。`else`您可以在;之后放置您想要的任何语句 大多数人选择放一个`if`或一个块语句，但你可以放任何你喜欢的语句。(*)

## 更新：

> 我知道 else if 'skips'，问题的关键是添加一个 return 让它直接跳出来，而不是花时间首先跳过它们。例如，在极端情况下，连续一百万个 if else 语句。它仍然需要找到行尾（这可能需要时间）。我对吗？

好的，我们需要去一个更低的层次。`if-else`语句编译如下：

```
if (condition) 
    Consequence() 
else 
    Alternative();
Continuation(); 
```

实际上是转化为一系列 goto 语句：

```
if (!condition) 
    goto ALTERNATIVE;
Consequence();
goto CONTINUATION;
ALTERNATIVE:  Alternative();
CONTINUATION: Continuation(); 
```

所以如果你有

```
if (x) X(); 
else if (y) Y();
else if (z) Z();
return; 
```

首先变成

```
if (x)
    X(); 
else 
{
    if (y)
        Y();
    else
    {
        if (z)
            Z();
    }
} 
```

然后变成

```
if (!x) goto XALTERNATIVE;
X(); 
goto CONTINUATION;
XALTERNATIVE: if (!y) goto YALTERNATIVE;
Y();
goto CONTINUATION;
YALTERNATIVE: if (!z) goto CONTINUATION;
Z();
CONTINUATION: return; 
```

这是否回答你的问题？

* * *

(*) 本地声明除外；C# 禁止这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:40:46.107

当用作条件的保护时它是有效的，但在你的情况下它并不重要，因为一旦执行这些语句中的一个，其他语句就不会被验证，但是如果你正在做这样的事情：

```
if(...){return;}
if(...){return;}
if(...){return;}
if(...){return;}
if(...){return;} 
```

那么这很重要。

# php - 移动多个标记谷歌地图？

> ID：16026869
> 
> 赞同：0
> 
> 时间：2013-04-16T00:34:59.000
> 
> 标签：php, javascript, google-maps, google-maps-markers, move

我想在谷歌地图中移动多个标记，我成功地找到并遵循这个例子[http://jsfiddle.net/ThinkingStiff/Rsp22/](http://jsfiddle.net/ThinkingStiff/Rsp22/)但是这个例子显示只有一个标记可以移动......我试图修改代码但没有成功。 ..这是我的代码...

```
function initialize() { 
   map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    //makeRequest is function to load data coordinat from db..... success!!
       makeRequest('get_locations.php', function(data) {

            var data = JSON.parse(data.responseText);

         for (var i=0;i<data.lenght;i++){
           //document.getElementById("koordinatnya").innerHTML = data[0]['latitude']+","+data[0]['longitude'];
           var myLatlng = new google.maps.LatLng(data[i]['latitude'], data[i]['longitude']);
           var marker = new google.maps.Marker({
                position: myLatlng,
                title:"Dari db :" + data[i]['tempat']
            });

            marker.setMap(map);
            moveMarker( map, marker, data[i]['latitude'], data[i]['longitude']);

         }

        });
  }

  function moveMarker( map, marker, lat, lng ) {    
        //delayed so you can see it move
            marker.setPosition( new google.maps.LatLng(lat,lng));
            map.panTo( new google.maps.LatLng(lat,lng));
  } 
```

谁能明白为什么这不是我想要的？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T00:24:51.053

尝试以下方法，这对我来说非常有用。此示例有四个映射，如果您有更多映射，您可能希望在 for 循环中填充数组。

请注意如何将所有 8 个点（每张地图两个）加载到同一个位置，然后将 A 到 D（每张地图一个）上/下/左/右移动

HTML：

```
<script src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<table>
    <tr>
        <td><div id="map0" class="map"></div></td>
        <td><div id="map1" class="map"></div></td>
    </tr>
    <tr>
        <td><div id="map2" class="map"></div></td>
        <td><div id="map3" class="map"></div></td>
    </tr>
</table> 
```

CSS：

```
.map
{ 
height: 300px; 
width: 400px;
} 
```

JAVASCRIPT：

```
var vans = { "H": 0, "A": 1, "B": 2, "C": 3, "D": 4, "E": 5, "F": 6, "G": 7, "H": 8  };
var Maps = new Array(); 
var markers = [];

function initialize() {
    var myLatLng = new google.maps.LatLng(53, -1);
        myOptions = {
            zoom: 13,
            center: myLatLng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
            };
        Maps[0] = new google.maps.Map(document.getElementById("map0"), myOptions);
        Maps[1] = new google.maps.Map(document.getElementById("map1"), myOptions);
        Maps[2] = new google.maps.Map(document.getElementById("map2"), myOptions);
        Maps[3] = new google.maps.Map(document.getElementById("map3"), myOptions);
        addPoint(Maps[0], 53, -1, "A");
        addPoint(Maps[1], 53, -1, "B");
        addPoint(Maps[2], 53, -1, "C");
        addPoint(Maps[3], 53, -1, "D");
        addPoint(Maps[0], 53, -1, "E");
        addPoint(Maps[1], 53, -1, "F");
        addPoint(Maps[2], 53, -1, "G");
        addPoint(Maps[3], 53, -1, "H");    
        movePoint(53.5, -2, "A");
        movePoint(53, 0, "B");
        movePoint(53.5, -1, "C");
        movePoint(53, -2, "D");
}
        function movePoint(lat, lng, name) {
            var thisLatlng = new google.maps.LatLng(lat, lng);
            markers[vans[name]].setPosition(thisLatlng);
        }

        function addPoint(thismap, lat, lng, name) {            
            var thisLatlng = new google.maps.LatLng(lat, lng);
            var marker = new google.maps.Marker({
                position: thisLatlng
            });
            marker.setMap(thismap);
            markers[vans[name]] = marker;
        }
initialize(); 
```

# iphone - 没有前端的推送通知？

> ID：16026870
> 
> 赞同：0
> 
> 时间：2013-04-16T00:35:19.203
> 
> 标签：iphone, ios, push-notification, apple-push-notifications

我有这个应用程序，它从互联网上读取第三方（不是我的）JSON 文件。当 JSON 文件中的某个值超过某个值时，我希望显示推送通知。我是否需要前端服务器来扫描 JSON 文件，然后将推送通知发送到 iPhone？有没有办法在没有推送通知的情况下做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T08:18:48.787

如果您不使用服务器来读取该 JSON，则必须在您的应用程序中读取它。这意味着您只能在您的应用程序在前台运行时执行此操作。

如果您想在应用程序未运行时也显示基于该 JSON 的通知，则您必须读取服务器中的 JSON 并向基于它的应用程序发送推送通知。

# python - 试图延迟我的程序的一部分

> ID：16026872
> 
> 赞同：0
> 
> 时间：2013-04-16T00:35:30.680
> 
> 标签：python, screenshot, delay

我试图拍摄我打开的网页的快照，但我需要延迟代码的第二部分，以便程序有时间打开页面

这是代码

```
import os
import sys
import time
import Image
import ImageGrab

import webbrowser
webbrowser.open_new(input("URL: "))
#Need to delay here

SaveDirectory=r'C:\Documents and Settings\User\My Documents\My Pictures'
ImageEditorPath=r'C:\WINDOWS\system32\mspaint.exe'
img=ImageGrab.grab()
box = (100, 100, 400, 400)
region = img.crop(box)
saveas=os.path.join(SaveDirectory,'ScreenShot_'+'.png')
img.save(saveas)
editorstring='""%s" "%s"'% (ImageEditorPath,saveas) 
os.system(editorstring) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:54:26.273

[使用python 的 selenium webdriver 绑定](https://pypi.python.org/pypi/selenium)截图：

```
#!/usr/bin/env python
from selenium import webdriver

browser = webdriver.Firefox()
browser.get('http://www.google.com/')
browser.save_screenshot('screenshot.png')
browser.quit() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:47:44.543

您可以尝试使用 time.sleep(seconds) 让您的程序延迟一段时间。

# php - 带有 UI 对话框的 JQuery Ajax

> ID：16026877
> 
> 赞同：0
> 
> 时间：2013-04-16T00:36:07.197
> 
> 标签：php, jquery, ajax, jquery-ui, smarty

我基本上有一个主 smarty 模板、一个 order smarty 包含、一个 js 和一个 php 文件。基本上，当有人单击订单中的按钮时，我试图创建一个 ajax 弹出窗口。我遇到了困难，页面只重新加载，我不知道我做错了什么。所以主页面有jquery，jquery ui，包含的js弹出文件脚本。js文件中的代码是

```
$(document).ready(function() {
$('.ajax-open').click(function(){
    $.ajax({
            type: "POST",
            url: "/scripts/pop-order.php",
            data: string,
            success: function(data) {
                 $( "#dialog" ).dialog({    
                    width:400,
                    resizable: false,
                    autoOpen: true 
                    });     
                 }
         });
});
}); 
```

我的订单模板中有这个`<button class="ajax-open" >open this shizznizzle</button>`

我的 php 里面有一个 Div id="dialog"，然后里面有一堆 php 代码。我还尝试取出所有 php 代码，然后将简单的文本放入所有页面所做的就是重新加载。我真的不知道在这里做什么，有人可以帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:38:34.503

```
$('.ajax-open').click(function(e){

    //note the e in the function(e)

    e.preventDefault(); //don't go to default URL 
```

或者，您可以在最后返回 false

```
$('.ajax-open').click(function(e){

    return false; 
```

# java - 斯坦福依赖解析器 - 如何获得跨度？

> ID：16026881
> 
> 赞同：4
> 
> 时间：2013-04-16T00:36:40.727
> 
> 标签：java, parsing, nlp, stanford-nlp

我正在用 Java 中的斯坦福库进行依赖解析。有没有办法在我的原始依赖字符串中取回索引？我试图调用 getSpans() 方法，但它为每个令牌返回 null：

```
LexicalizedParser lp = LexicalizedParser.loadModel(
        "edu/stanford/nlp/models/lexparser/englishPCFG.ser.gz",
        "-maxLength", "80", "-retainTmpSubcategories");
TreebankLanguagePack tlp = new PennTreebankLanguagePack();
GrammaticalStructureFactory gsf = tlp.grammaticalStructureFactory();
Tree parse = lp.apply(text);
GrammaticalStructure gs = gsf.newGrammaticalStructure(parse);
Collection<TypedDependency> tdl = gs.typedDependenciesCollapsedTree();
for(TypedDependency td:tdl)
{
      td.gov().getSpan()  // it's null!
      td.dep().getSpan()  // it's null!
} 
```

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T07:38:02.697

我终于编写了自己的辅助函数来获取原始字符串的跨度：

```
public HashMap<Integer, TokenSpan> getTokenSpans(String text, Tree parse)
{
    List<String> tokens = new ArrayList<String>();
    traverse(tokens, parse, parse.getChildrenAsList());
    return extractTokenSpans(text, tokens);
}

private void traverse(List<String> tokens, Tree parse, List<Tree> children)
{
    if(children == null)
        return;
    for(Tree child:children)
    {
        if(child.isLeaf())
        {
            tokens.add(child.value());
        }
        traverse(tokens, parse, child.getChildrenAsList());         
    }
}

private HashMap<Integer, TokenSpan> extractTokenSpans(String text, List<String> tokens)
{
    HashMap<Integer, TokenSpan> result = new HashMap<Integer, TokenSpan>();
    int spanStart, spanEnd;

    int actCharIndex = 0;
    int actTokenIndex = 0;
    char actChar;
    while(actCharIndex < text.length())
    {
        actChar = text.charAt(actCharIndex);
        if(actChar == ' ')
        {
            actCharIndex++;
        }
        else
        {
            spanStart = actCharIndex;
            String actToken = tokens.get(actTokenIndex);
            int tokenCharIndex = 0;
            while(tokenCharIndex < actToken.length() && text.charAt(actCharIndex) == actToken.charAt(tokenCharIndex))
            {
                tokenCharIndex++;
                actCharIndex++;
            }

            if(tokenCharIndex != actToken.length())
            {
                //TODO: throw exception
            }
            actTokenIndex++;
            spanEnd = actCharIndex;
            result.put(actTokenIndex, new TokenSpan(spanStart, spanEnd));
        }
    }
    return result;
} 
```

然后我会打电话

```
 getTokenSpans(originalString, parse) 
```

所以我得到了一个映射，它可以将每个令牌映射到其对应的令牌跨度。这不是一个优雅的解决方案，但至少它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-23T13:34:19.070

即使您已经回答了自己的问题并且这是一个老话题：我今天偶然发现了同样的问题，但使用的是（斯坦福）LexicalizedParser，而不是依赖解析器。尚未针对依赖项对其进行测试，但以下解决了我在 lexParser 场景中的问题：

```
List<Word> wl = tree.yieldWords();
int begin = wl.get(0).beginPosition();
int end = wl.get(wl.size()-1).endPosition();
Span sp = new Span(begin, end); 
```

然后 Span 保存（子）树的索引。（如果你一直走到终端，我想这同样适用于令牌级别）。

希望这可以帮助遇到同样问题的其他人！

# php - 获取 youtube 视频 ID 并将其批量放入此格式的最佳方法

> ID：16026883
> 
> 赞同：0
> 
> 时间：2013-04-16T00:37:01.483
> 
> 标签：php, javascript

我的网站使用 javascript 从数组中读取 youtube 视频 ID。在格式：

```
1:  'A8JsRx2loix',
2:  'XFGAQrEUaes',
3:  'qX9FSZJu44s' 
```

获取网址列表的最佳方式是什么

```
http://www.youtube.com/watch?feature=player_detailpage&v=bCJ-qARb2M0
http://www.youtube.com/watch?feature=player_detailpage&v=bCJ-qAswdM2
http://www.youtube.com/watch?feature=player_detailpage&v=bCJ-sh7b2M0 
```

并提取 11 位视频 ID，将它们放在上面给定的格式中。

注意：url 可以是不同的格式，例如当它们在播放列表中时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T01:01:06.537

你可以使用这个函数来处理任何 youtube url，它会返回一个像这样的对象：

```
{
    type: 'youtube',
    id: 'A8JsRx2loix'
}

function testUrlForMedia(url) {
    var success = false;
    var media = {};
    if (url.match('http://(www.)?youtube|youtu\.be')) {
        if (url.match('embed')) {
            youtube_id = url.split(/embed\//)[1].split('"')[0];
        }
        else {
            youtube_id = url.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0];
        }
        media.type = "youtube";
        media.id = youtube_id;
        success = true;
    }
    if (success) {
        return media;
    }
    return false;
} 
```

[原始来源](https://stackoverflow.com/questions/3452546/javascript-regex-how-to-get-youtube-video-id-from-url#answer-8116347)

# android - Corona 将图像保存到 SD 卡

> ID：16026884
> 
> 赞同：0
> 
> 时间：2013-04-16T00:37:02.297
> 
> 标签：android, image, coronasdk, sd-card

在 corona 中，我们使用以下代码将图像保存到内部存储：

```
local baseDir = system.DocumentsDirectory
display.save( groupStage, "drawImage.png",baseDir ) 
```

但现在我想将它保存到 SD 卡。我该怎么做？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T10:12:07.473

来自[链接](http://forums.coronalabs.com/topic/22389-any-way-to-access-the-sdcard/) 目前，Corona 不提供对 Android 上的外部存储的访问。因此，目前除了通知最终用户他们的存储空间不足并且他们需要释放更多空间来为您的应用程序的更多内容腾出空间之外，目前没有一个好的解决方案。

在您的特定情况下，我认为最好的解决方案是我们添加扩展文件支持，这允许您的应用程序在 Google Play 上超过 50 MB 的障碍。这在我们的待办事项清单上，并且有很多需求。您可以通过下面的链接找到有关此功能的更多详细信息。

[http://developer.android.com/guide/google/play/expansion-files.html](http://developer.android.com/guide/google/play/expansion-files.html)

# c++ - 迭代器错误 C2440

> ID：16026890
> 
> 赞同：2
> 
> 时间：2013-04-16T00:37:46.780
> 
> 标签：c++, visual-studio-2008, iterator

我正在尝试制作一个小型散列程序，但出现了一个我不知道如何处理的错误。问题在箭头上，这是错误：

> 错误 1 ​​错误 C2440：“正在初始化”：无法从“std::_String_const_iterator<_Elem,_Traits,_Alloc>”转换为“std::_String_iterator<_Elem,_Traits,_Alloc>”

我的代码：

```
#include <iostream>
#include <string>
#include <iterator>
using namespace std;

unsigned long hash(const string& str);

int main()
{
   long out;
   string word;
   word = "about";
   out = hash(word) % 255;
   cout << out;
   system("pause");
   return 0;
}

unsigned long djb2(const string& str)
{
    unsigned long hash = 5381;

    for(string::iterator it=str.begin();it!=str.end();it++)  //<~~~~~~~~~~
        hash = ((hash << 5) + hash) + *it; /* hash * 33 + character */

    return hash;
 } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T00:42:35.253

您需要使用`const_iterator`：

```
 for( std::string::const_iterator it=str.begin();it!=str.end();it++) 
```

因为你对函数的论点是`const string &str`必须`iterator`同意的。

# html - 如何在 asp.net mvc 中创建多行文本框？

> ID：16026892
> 
> 赞同：24
> 
> 时间：2013-04-16T00:38:05.937
> 
> 标签：html, asp.net-mvc

如何在 asp.net mvc 中创建多行文本框？

可能不是特定于 asp.net mvc，但它是我正在使用的。

这就是我所拥有的。

```
<%: Html.TextBox("CommentToAdd", null, new
{
@class = "input-medium",    
TextMode = "MultiLine",
Columns = "55",
Rows = "10",
type = "text",
required = "required"
})%> 
```

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-08-18T05:58:26.070

只需将此属性添加到属性。

```
 [DataType(DataType.MultilineText)]
   public string CommentsToAdd{ get; set; } 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-04-16T00:43:32.947

您想使用文本区域，而不是文本框。使用[TextAreaFor](http://msdn.microsoft.com/en-us/library/ee703606%28v=vs.108%29.aspx)将其绑定到您的模型，否则使用[TextArea](http://msdn.microsoft.com/en-us/library/dd470771%28v=vs.108%29.aspx)

```
<%= Html.TextAreaFor(e => e.CommentsToAdd, 10, 55, null) %>
<%= Html.TextArea("CommentsToAdd", string.Empty, 10, 55, null) %> 
```

使用剃须刀：

```
@Html.TextAreaFor(e => e.CommentsToAdd, 10, 55, null)
@Html.TextArea("CommentsToAdd", string.Empty, 10, 55, null) 
```

这将呈现为`<textarea>`（多行）而不是`<input type="text" />`（单行）。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-16T00:40:39.667

我认为`textbox`MVC 中的多行是`textarea`

```
<%= Html.TextArea("Body", null, new { cols = "55", rows = "10" }) %> 
```

或者

```
<%= Html.TextAreaFor(x => x.Body, 10, 55, null) %> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-16T00:40:35.307

多行文本框只是一个文本区域。

这些中的任何一个都应该工作。

```
<%= Html.TextArea("Body", null, new { cols = "100", rows = "5" }) %>

<%= Html.TextArea("Body", null, 5, 100, null) %>

<%= Html.TextAreaFor(x => x.Body, 5, 100, null) %> 
```

# java - 如何创建包含两列的 MySQL 表？

> ID：16026894
> 
> 赞同：-7
> 
> 时间：2013-04-16T00:38:23.957
> 
> 标签：java

我想在 java 中创建包含两列的 MySQL 表，列的名称由用户输入？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:46:48.403

首先你必须连接到数据库，然后你可以执行查询：

```
 System.out.println("Table Creation Example!");
 Connection con = null;
 String url = "jdbc:mysql://localhost:3306/";
 String dbName = "jdbctutorial";
 String driverName = "com.mysql.jdbc.Driver";
 String userName = "root";
 String password = "root";
 String column1 = "nameOfTheFirstColumn";
 String column2 = "nameOfTheSecondColumn";

 try{
  Class.forName(driverName).newInstance();
 con = DriverManager.getConnection(url+dbName, userName, password);
 try{
  Statement st = con.createStatement();
  String table = 
  "CREATE TABLE Employee11(column1 + " varchar(10), + column2 + "Emp_name varchar(10))";
  st.executeUpdate(table);
  System.out.println("Table creation process successfully!");
  }
  catch(SQLException s){
  System.out.println("Table all ready exists!");
  }
  con.close();
  }
  catch (Exception e){
  e.printStackTrace();
  } 
```

改编自此[来源](http://www.roseindia.net/jdbc/jdbc-mysql/CreateTable.shtml)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:52:29.177

首先使用`Scanner`. 现在用这些列名创建表

```
 Statement statement = connection.createStatement();
  String createTable = 
  "CREATE TABLE NEWTABLE(" + inputName1 + "varchar(100), " + inputName2 + " varchar(100))";
  statement.executeUpdate(createTable); 
```

# java - 在参数中传递一个数组对象

> ID：16026897
> 
> 赞同：3
> 
> 时间：2013-04-16T00:38:38.957
> 
> 标签：java, arrays, methods

我是java新手，我想知道，我们如何将数组对象作为参数传递给方法。假设我有：

```
public void sortArray(A[7]) 
```

我应该在括号之间放什么？应该是`A[length of array]`还是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:42:25.613

当您将数组作为参数传递时，它的长度以及其中存储的内容都会被传递，因此您无需专门指定长度。具体实现见下例：

将 int 数组作为参数的方法的简单示例：

```
public void takeArray(int[] myArray) {
    for (int i = 0; i < myArray.length; i++) { // shows that the length can be extracted from the passed in array.
        // do stuff
    }
} 
```

您将因此调用此方法：

假设你有一个这样的数组：

```
int[] someArray = {1, 2, 3, 4, 5}; 
```

然后你调用上面的方法：

```
takeArray(someArray); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:43:40.100

只需将数组传递给方法。您无需提及任何尺寸。

```
void sortArray(int[] array) {
  // Code
} 
```

// 调用方法并传递这个数组 do.

```
int[] array = new int[10];
sortArray(array); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:43:26.117

例如，您有您所说的程序：

```
public void sortArray(typeArray[] A){
 //code
 //code
} 
```

调用数组：

```
typeArray[] A = new typeArray[N]; //N is number of array you want to create
searchArray(A); //this how I call array 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T00:44:26.247

您只需将数组的名称传递给方法。

```
int[] a = new int[10];

...

bar(a); 
```

其中 bar 的定义如下：

```
void bar(int[] a)
{
    ...
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-22T03:36:48.897

这样你就可以传递一个数组

```
int[] a = new int[100];
myFunction(a);

 public void myFunction(int[] a){
       for(int i =0; i< a.lenght();i++){

                System.out.println(i);

              }

       } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-22T03:59:58.007

如果您不希望将数组命名为：

```
public void array(int arr[])
{
    // code handling arr
} 
```

现在对于上述方法，您可以传递一个数组对象而无需像这样创建它：

```
public static void main(String[] args)
{
   array(int[] {1,2,3,4,5});
} 
```

这也称为未命名数组或匿名数组。无需为按值调用创建数组。如果您不再希望该数组包含在 main() 方法中，则可以使用未命名的数组。这有助于节省内存。谢谢

# java - 如何在不使用 Java 中的内置方法 .endsWith() 的情况下实现 String.endsWith()

> ID：16026898
> 
> 赞同：1
> 
> 时间：2013-04-16T00:38:40.740
> 
> 标签：java, string, ends-with

我正在尝试在`String.endsWith()`不使用内置方法的情况下实现方法`String.endsWith()`。

这是我的代码：

```
public static boolean endsWithSuffix(String str, String suffix) {
    char[] chStr = str.toCharArray();
    char[] chSuf = suffix.toCharArray();

    if(!str.contains(suffix) {
        return false;
    }
    return true;
} 
```

`endsWith()`在不使用内置方法的情况下实现该方法的最佳方法是什么？

我一直在尝试使用字符数组，但还没有运气。字符串会更容易吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T00:44:53.230

一种方法是这样的：

*   检查是否`suffix <= str`。
*   使用. 获取where的最后一个`n`字符。`str``n = suffix.length()``substring()`
*   将该部分字符串与`suffix`with`equals()`或进行比较`equalsIgnoreCase()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T00:46:54.413

```
 return str.length() >= suffix.length() && str.substring(str.length() - suffix.length()) == suffix; 
```

你可以使用 .equals 但你必须添加无效检查然后

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T00:47:35.887

```
public static boolean endsWith(String test, String suffix) {

    int start = test.length() - suffix.length();
    if (start >= 0) {
        return test.indexOf(suffix, start) >= 0;
    }
    return false;
}

public static void main(String... args) {

    System.out.println(endsWith("aaabbbccc", "aaa"));
    System.out.println(endsWith("aaabbbccc", "bbb"));
    System.out.println(endsWith("aaabbbccc", "ccc"));
    System.out.println(endsWith("Hello Java", "Java"));
} 
```

输出

```
false
false
true
true 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-16T00:47:54.520

```
 public static boolean endsWith(String str, String suffix){  
        return (str.lastIndexOf(suffix) == str.length() - suffix.length()); 
    }  

    public static void main(String[] args) {
        System.out.println(endsWith("this is a test", "test")); //True
        System.out.println(endsWith("This is another test", "test2"));  //False
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-16T00:44:25.497

这是我要做的：

1.  反转输入字符串
2.  反转后缀字符串
3.  检查1`String.startsWith`的输出。2的输出。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-16T00:49:42.533

您可以尝试字符串的 Substring 方法

```
public static boolean endsWithSuffix(String str, String suffix) 
{
int a,b;
a=str.length();
b=suffix.length();
if (str.subString(b-a,a).equals(suffix))
   return true;
else 
   return false; 
```

}

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-16T00:53:52.157

试试下面的。

```
public static boolean endsWithSuffix(String str, String suffix)     
    int offset = str.length - suffix.length();
    if (offset >= 0) {
        String temp = str.substring(offset, str.length() - 1);
        if (suffix.equals(temp)) {
            return true;
        }
    }
    return false;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-16T02:05:15.340

由于您试图重新发明轮子以弄清楚轮子是如何工作的（这不是一件坏事！），使用 substring + 似乎有点作弊`equals`，不是吗？为什么不直接实施检查，而不是将其传递给`equals`?

基本思想是比较每个字符串的最后一个字符，然后是倒数第二个字符，然后是倒数第三个字符，等等。如果你得到一个不相等的比较，你可以返回 false。否则，您可以返回 true。换句话说，您将两个字符串逐个字符配对；而不是询问这些对是否都相等，而是询问它们中的任何一个是否*不*相等。

* * *

*给定*一个 int `i`，您可以通过. 例如，最后一个数字是，倒数第二个是，等等。所以：*`stringLength - 1 - i``stringLength - 1``stringLength - 2`*

 *1.  检查后缀是否长于`str`. 如果是的话，你可以`return false`
2.  让我们`i`代表我们想看的右边有多少个字符
3.  创建一个循环，从后缀的右侧开始查看所有*i -ith 字符：*`for(int i = 0; i < suffix.length(); ++i)`
4.  在每次迭代中，从两个字符串的右侧获取第*i*个字符，如上所述
5.  如果它们不相等，`return false`. 如果它们相等，则继续下一次迭代
6.  如果你已经用尽了所有的字符`suffix`（即，如果循环结束），则返回 true。

把它们放在一起：

```
public static boolean endsWithSuffix(String str, String suffix) {
    int strLen = str.length();
    int suffixLen = suffix.length();

    if (suffixLen > strLen)
        return false;
    for (int i = 0; i < suffixLen; ++i) {
        char strChar = str.charAt(strLen - 1 - i);
        char suffixChar = suffix.charAt(suffixLen - 1 - i);
        if (strChar != suffixChar)
            return false
    }
    return true
} 
```

的初始检查`suffixLen > strLen`不仅仅是一种优化——它是正确性所必需的。否则，如果后缀比 str 长，那么循环将走得足够远，以至于您会要求`str.charAt(-1)`甚至更低，这将引发异常！还有其他方法可以解决这个问题，但我会让你找到它们。:)*

# recursion - 定义网格中 2 个节点之间的路径长度 [Prolog]

> ID：16026899
> 
> 赞同：0
> 
> 时间：2013-04-16T00:38:58.813
> 
> 标签：recursion, prolog

```
edge(a, b).
edge(b, d).
edge(d, c).
edge(d, e).
edge(d, f).
edge(e, g).
edge(f, g).
edge(g, h). 
```

（假设每条边的长度相同）。

例如，要获取 a 和 d 之间的路径长度： `?- length(a,d)` 应该返回`2*constant (a->b and b->d)`.

我知道要做一个递归过程，我已经开始调用它`isConnected`来测试两个节点之间是否存在连接：

```
isConnected(X1, X2) :- edge(X1, X2). 
```

和

```
isConnected(X1, X2) :- edge(X1, X), isConnected(X, X2). 
```

但我不确定如何从这里开始。我知道我应该有一个`dist`过程来调用`isConnected`and 并且是移动到下一个边缘的结果，然后将结果添加到类似`L is Length`. 但我不知道该怎么做。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T06:11:14.463

Daniel 的回答是好的，你只需将 length/2 应用于返回的列表。这里有一种更直接的方法，在路径建立后添加单元步骤：

```
isConnected(X1, X2, 1) :- edge(X1, X2).
isConnected(X1, X2, D) :- edge(X1, X), isConnected(X, X2, T), D is T + 1. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T03:24:34.553

信不信由你，你真的*很*亲密！您甚至可以生成您需要的所有信息，只是没有将其保存在任何地方。我的意思是`X`在您的第二`isConnected/2`条规则中：这就是您需要保留的所有内容才能到达那里的其余部分。

```
isConnected(X1, X2, [X2])      :- edge(X1, X2).
isConnected(X1, X2, [X |Rest]) :- edge(X1, X),  isConnected(X, X2, Rest). 
```

基本上就是这样：

```
?- isConnected(a,X,P).
X = b,
P = [b] ;
X = d,
P = [b, d] ;
X = c,
P = [b, d, c] ;
X = e,
P = [b, d, e] ;
X = f,
P = [b, d, f] ;
X = g,
P = [b, d, e, g] ;
X = h,
P = [b, d, e, g, h] ;
X = g,
P = [b, d, f, g] ;
X = h,
P = [b, d, f, g, h] ;
false. 
```

# math - 添加两个非静态的谓词参数

> ID：16026907
> 
> 赞同：0
> 
> 时间：2013-04-16T00:39:32.710
> 
> 标签：math, prolog, arithmetic-expressions

我正在尝试将两个数字相加

```
add(num1, num2, output) :-
    output is num1 + num2. 
```

假设 X 为 1，Y 为 3，但它们不是静态的，只是变量。
`add(X, Y, out)`.

我收到一个`error(instantiation_error,(is)/2)`错误

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T02:04:18.770

Prolog 是一种区分大小写的语言，变量名必须是由字母、数字和下划线字符组成的字符序列，并且**必须以大写字母或下划线字符开头**。

因此，
`add(Num1, Num2, Output) :- Output is Num1 + Num2.`
会工作。

# javascript - 那些自动执行的匿名函数（又名 IIFE）实现之间有什么区别

> ID：16026909
> 
> 赞同：9
> 
> 时间：2013-04-16T00:39:39.680
> 
> 标签：javascript

在许多书籍/[博客文章](http://sarfraznawaz.wordpress.com/2012/01/26/javascript-self-invoking-functions/)中，自调用匿名函数模式是这样写的：

```
(function() {
  var foo = 'bar';
})(); 
```

但是，在此运行[JSLint](http://www.jslint.com/)会出现此错误：

> 将调用移动到包含函数的括号中。

例如将其更改为此作品：

```
(function() {
  var foo = 'bar';
}()); 
```

**问题**

1.  为什么第一个实现对 JSLint 来说不够好？有什么区别？
2.  首选形式是什么？JSLint 总是正确的吗？
3.  *为什么它有效？*毕竟`function(){}()`会抛出 a`SyntaxError: Unexpected token (`
    但是用括号包裹它会突然起作用吗？例如**(** `function(){}()`**)** - 工作正常
    （毕竟这是 JavaScript，而不是 Lisp，那么包装括号对 ohterwise 语法错误有什么影响？）

**编辑**：这是对此的跟进（虽然我不会说完全重复）：[JSLint 错误：“将调用移动到包含函数的括号中”](https://stackoverflow.com/questions/4979252/jslint-error-move-the-invocation-into-the-parens-that-contain-the-function)，所以我的主要问题是＃3，为什么它完全有效?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T00:47:52.537

我不知道 Crockford 的观点是如何形成的，但我可以解释为什么用括号括起来是有效的。

JavaScript 中的函数`function() { ... }`语法可以表示两种不同的东西：函数声明或函数表达式。

函数声明是在指定名称下定义当前范围内的函数的*语句。*

```
function example() { 
    alert("Hello World");
}

example(); 
```

函数表达式是计算结果为新实例的*表达式。*`Function`

```
var secondExample = function example() {
    alert("Hello World");
};

secondExample();
example(); // <-- throws an Error: example is not defined. 
```

语法的出现是函数声明还是函数语句取决于解析器的期望。JavaScript 的解析器很简单。它不会向前看并注意到函数后面跟着`()`，因此它应该将其视为表达式。它只是看到`function`一行的开头，因此将其视为一个语句，当它后面跟着 . 时会导致语法错误`()`。当您将它包装在括号中时，解析器会期待一个表达式，并且它可以工作。

用括号括起来（无论你把它们放在哪里）是最清晰的方法，但是任何导致解析器期望表达式的东西都可以工作。例如，按位 NOT 运算符`~`：

```
~function() {
    alert("Hello World");
}(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T00:47:52.807

1.

显然这是约定的问题。第一个示例显示“缺乏约定”（[source](http://jslinterrors.com/move-the-invocation-into-the-parens-that-contain-the-function/)）。至于实际差异，则没有。两者都将毫无错误地执行。

2.

在这种情况下，我更喜欢您的第一个示例，但这只是我的惯例。JSLint 通常是正确的。因此，如果您想遵循他们的命名约定，那么当它显示基于约定的警告时，遵守约定是有意义的。

3.

这是有效的，因为包装 a 的`function(){}`内部`()`使其成为一个表达式，一旦与 final 配对，`()`就会立即调用它。因此，您有一个立即调用的函数表达式。

# ember.js - 影响模型数据和 UI 的操作

> ID：16026917
> 
> 赞同：1
> 
> 时间：2013-04-16T00:40:50.743
> 
> 标签：ember.js

用户单击链接。我想做两件事：

1.  更新模型数据。
2.  显示模型已更改的通知。

所以我可以对调用控制器上的函数的链接进行操作。从那里我可以轻松地更新模型数据。UI应该如何更新？以及如何仅在数据成功保存在服务器上后才显示通知？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T11:59:53.293

这是取自[Yehuda 评论](https://github.com/emberjs/ember.js/issues/1692#issuecomment-11964398)的一个简单示例，这可能涵盖几种情况，具体取决于您要执行的 UI 更新类型。

```
App.NewUserRoute = Ember.Route.extend({
  model: function() {
    return App.User.createRecord();
  },

  events: {
    save: function(user) {
      user.one('didCreate', function() {
        this.transitionTo('showUser', user);
      }, this);

      this.get('store').commit();
    }
  }
}); 
```

由于您的视图状态应尽可能多地取决于路由器/控制器，因此请尽量使其远离这些地方。如果您需要其他一些真正仅限视图的 UI 更新，请将操作发送到视图并将与数据相关的事件从那里发送到路由器/控制器。您应该可以从这里设置回调等。

# java - 如何将 sun.misc.BASE64Encoder 转换为 org.apache.commons.codec.binary.Base64

> ID：16026918
> 
> 赞同：9
> 
> 时间：2013-04-16T00:40:55.997
> 
> 标签：java, base64, apache-commons-codec

我有以下代码`sun.misc.BASE64Encoder`：

```
BASE64Decoder decoder = new BASE64Decoder();
byte[] saltArray = decoder.decodeBuffer(saltD);
byte[] ciphertextArray = decoder.decodeBuffer(ciphertext); 
```

并想将其转换为`org.apache.commons.codec.binary.Base64`. 我已经浏览了 API、文档等，但我找不到似乎匹配并给出相同结果值的东西。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-16T08:37:30.343

它实际上几乎完全相同：

```
Base64 decoder = new Base64();
byte[] saltArray = decoder.decode(saltD);
byte[] ciphertextArray = decoder.decode(ciphertext); 
```

对于解码：

```
String saltString = encoder.encodeToString(salt);
String ciphertextString = encoder.encodeToString(ciphertext); 
```

最后一个更难，因为你在最后使用了“toString”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-16T01:08:43.860

您可以使用[decodeBase64(byte[] base64Data)](http://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/Base64.html#decodeBase64%28byte%5B%5D%29)或[decodeBase64(String base64String)](http://commons.apache.org/proper/commons-codec/apidocs/org/apache/commons/codec/binary/Base64.html#decodeBase64%28java.lang.String%29)方法。例如：

```
byte[] result = Base64.decodeBase64(base64); 
```

这是一个简短的例子：

```
import java.io.IOException;
import org.apache.commons.codec.binary.Base64;
import sun.misc.BASE64Encoder;
import sun.misc.BASE64Decoder;

public class TestCodec {

    public static void main(String[] args) throws IOException {
        String test = "Test BASE64Encoder vs Base64";

//      String encoded = new BASE64Encoder().encode(test.getBytes("UTF-8"));
//      byte[] result = new BASE64Decoder().decodeBuffer(encoded);

        byte[] encoded = Base64.encodeBase64(test.getBytes("UTF-8"));
        byte[] result = Base64.decodeBase64(encoded);

        System.out.println(new String(result, "UTF-8"));
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-03-14T14:19:28.070

代替这两个类（import sun.misc.BASE64Encoder; import sun.misc.BASE64Decoder），你可以使用**java.util.Base64**类。现在改变编码和解码方法如下。对于编码：

```
String ciphertextString =  Base64.getEncoder().encodeToString(ciphertext); 
```

对于解码：

```
 final byte[] encryptedByteArray = Base64.getDecoder().decode(ciphertext); 
```

这里 ciphertext 是 encoding method 中的编码密码。

现在一切都完成了，您可以保存程序并运行。它将运行而不会显示任何错误。

# c++ - 仅使用存储在数组中的字符串中的第一个字母

> ID：16026919
> 
> 赞同：1
> 
> 时间：2013-04-16T00:41:00.573
> 
> 标签：c++, arrays

我目前正在为 MC68HC11 编写“伪汇编编译器”，这并不复杂。我遇到的问题是从文件中读取并存储到数组中。

例如，我有“LDAA #$45”行，我首先将“LDAA”保存到字符串数组中，将“#$45”保存到第二个字符串数组中。我按原样使用第一个数组，但对于第二个数组，我只需要知道该数组中的第一个字母或符号是什么，这样我就可以知道我需要结束的 if 语句。

进入 LDAA 的代码是这样的：

```
if(code[i]=="LDAA"){ //code is my array for the first word read.
  if(number[i]=="#"){ //Here's where I would only need to read the first symbol stored in the array.
    opcode[i]="86";
  }
} 
```

我用于从文件中读取的代码类似于将[文件读入数组](https://stackoverflow.com/questions/1664845/reading-a-file-into-an-array)中的代码？

我不确定这是否完全可行，因为我在网上找不到类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:58:26.230

根据 的类型`number`，您需要：

```
if(number[i]=='#'){ 
```

或者

```
if( number[i][0]=='#'){ 
```

此外，是`code[i]`、`opcode[i]`类型`std::string`或`char*`。[希望是前者。]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T01:00:53.773

你已经标记了这个 C++，所以我假设你的数组包含`std::string`s，在这种情况下：

```
#include <string>
#include <iostream>

int main()
{
    std::string foo = "#$45";
    std::string firstLetter = foo.substr(0, 1);
    std::cout << firstLetter;
    return 0;
} 
```

产生输出：

> #

那是你要找的吗？应用于您的代码：

```
if(code[i]=="LDAA"){
  if(number[i].substr(0, 1)=="#"){
    opcode[i]="86";
  }
} 
```

# iphone - 为什么 iOS 6.1.1 中的沙盒在我越狱后仍然存在于 App 中？

> ID：16026920
> 
> 赞同：1
> 
> 时间：2013-04-16T00:41:11.387
> 
> 标签：iphone, ios, jailbreak

我安装的应用程序使用 Ad-hoc 证书进行签名。但它仅适用于**越狱**iPhone。

我尝试直接读取`/var/mobile/Library/SMS/sms.db`. 但我发现应用程序无法读取它，因为沙盒进程拒绝了该操作。所以我的问题是，iPhone越狱后沙盒是否会被移除？

（而且现在我觉得里面的应用`/var/mobile/Applications/`还是被沙盒限制的，越狱的过程中并没有把这个目录下的沙盒去掉？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T08:32:40.240

不幸的是，你猜对了。在越狱设备上，安装到正常位置 ( `/var/mobile/Applications/`) 的应用程序仍处于沙盒状态（* 请参阅下面的评论）。

**越狱并没有完全删除沙箱**。

它允许您运行未经有效 Apple 证书签名的代码。因此，它还允许您将应用程序安装到不同的位置。

但是，如果您将应用程序安装到`/Applications/`，它将能够读取`/var/mobile/Library/SMS/sms.db`，正如我[在此答案中](https://stackoverflow.com/a/11026338/119114)所描述的那样。作为*系统*应用程序，您将处于沙盒之外。

这与 Objective-C 或 Cocoa Touch 与 C API 无关。如果您所要做的只是使用众所周知的 CI/O 调用来逃避它，那么它就不会是一个沙箱。

有关一些相关讨论，[请参阅this other similar answer (to a closed question) 。](https://stackoverflow.com/a/15970080/119114)

* * *

**更新：**查看 saurik[在此在线线程中](https://news.ycombinator.com/item?id=4127801)的评论。总结是不同的越狱（例如evasi0n、Absinthe、redsn0w）可以以不同的方式影响沙盒。Saurik 的建议当然是**不要**完全删除它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T08:34:53.670

不久前我在尝试从 iPhone 的串口读取数据时遇到了同样的问题。您的猜测是正确的，即使在越狱后，常规 App Store 应用程序`/var/mobile/Applications/`仍然受到沙盒限制。系统应用程序不受这些限制，可以在`/var/stash/Applications/`（或者我认为在 iOS 6 中的路径中有一个标识符）中找到，这是安装 Cydia 越狱应用程序的位置。

*更新*：使用 Cydia 应用程序 iFile 我可以打开`/var/mobile/Library/SMS/sms.db`数据库并查看内容。并且移动短信应用没有特殊的授权文件，所以我认为如果你将你的应用放在系统应用目录中，读取短信数据库应该没有问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-15T04:52:20.887

实际上有一种方法可以解决无法使用沙盒帐户的问题。如果您重新启动越狱设备并且当显示苹果引导标志时，您可以按住音量增大按钮来禁用 mobilesubstrate。这使您的设备可以像从未越狱和启用沙箱一样启动。要回到您的越狱状态，只需重新启动即可。就那么简单！

# compiler-construction - 内核编译——跨平台

> ID：16026921
> 
> 赞同：0
> 
> 时间：2013-04-16T00:41:14.717
> 
> 标签：compiler-construction, cross-platform, kernel, cross-compiling

只是关于编译内核的一个小说明（不是我正在做任何：P）。我对编译的了解是它是特定于机器的，尽管您可以使用交叉编译器来编译您的工作以在不同的机器上运行（或编译为字节码以在虚拟机下运行），但交叉编译需要一些基础知识/要求运行您编译的程序（如 C++/C 库或 Java VM...）所必需的。

但是内核呢？他们编译一次并神奇地在每台机器上运行（* 没有检查），我在网上搜索并找到了一些如何交叉编译内核的指南，但没有说明它为什么或如何工作！具有不同指令集的不同 CPU 如何成功运行相同的二进制文件？！

如果您有一些参考来回答我的问题，我将非常感谢，也许让我开始学习更多关于内核的东西会很棒：D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:31:10.740

他们没有。为 ARM v6 编译的内核不会在任何其他类型的 CPU 上运行。每个二进制文件都是一样的，内核并不神奇。交叉编译仅意味着生成的二进制文件特定于与编译器运行的架构不同的架构。例如，在我的 x86 桌面上，我可以编译将在 x86 上运行的二进制文件，或者我可以交叉编译将在例如 PowerPC 上运行的二进制文件。但两者都不会在对方的目标平台上运行。

# javascript - 识别码和img src属性

> ID：16026922
> 
> 赞同：1
> 
> 时间：2013-04-16T00:41:53.113
> 
> 标签：javascript, html

```
<pre lang="HTML">
<img alt="" name="Code_Verify" id="Code_Verify" align="top" 
     src="/ipcast_os/login_auth/display_verify"/>
</pre> 
```

`display_verify`是输出识别码的函数。为什么`src`属性不是图像文件的目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:45:53.817

属性的 content-type 或 mime-type 不是由客户端（您的浏览器）强制执行的。实际上，即使没有类似`.jpeg`或`.png`其他的扩展名，Web 服务器也可能会为该请求返回有效图像。

`GET`当向 path 发出请求时，由您的服务器以正确的图像进行响应`/ipcast_os/login_auth/display_verify`。

如果您提供有关您的 javascript 的其他信息，我们可以更轻松地为您提供帮助。

# google-chrome - chrome.management.onInstalled.addListener throwing Uncaught SyntaxError: Unexpected identifier

> ID：16026929
> 
> 赞同：0
> 
> 时间：2013-04-16T00:42:56.727
> 
> 标签：google-chrome, google-chrome-extension

我正在尝试编写一个 chrome 扩展程序，以通过使用 chrome 网上商店或其他方式来监听其他扩展程序的安装/卸载/启用/禁用事件。

我打算为此使用 chrome.management 模块。

1.  我已经在 manifest.json 文件中声明了权限。

    ```
    "permissions": [
        "management"
    ], 
    ```

2.  我有一个 background.html 页面

    ```
    "background": {
        "page": "background.html"
    }, 
    ```

3.  我已将 background.js 作为 background.html 页面的一部分

    ```
    <html>
    <script type="text/javascript" src="js/background.js"></script>
    <body>
    </body>
    </html> 
    ```

4.  这是我的 background.js

    ```
    chrome.management.onInstalled.addListener(function(ExtensionInfo info) {
      console.log('somethingz installed...');
      printInfo(info);
      });

    chrome.management.onEnabled.addListener(function(ExtensionInfo info) {
      console.log('somethingz enabled...');
      printInfo(info);
    });

    chrome.management.onDisabled.addListener(function(ExtensionInfo info) {
      console.log('somethingz disabled...');
      printInfo(info);
    });

    function printInfo(info)
    {
      console.log("id: " ++ info.id);
      console.log("name: " ++ info.name);
      console.log("description: " ++ info.description);
      console.log("version: " ++ info.version);
      console.log("mayDisable: " ++ info.mayDisable);
      console.log("enabled: " ++ info.enabled);
      console.log("disabledReason: " ++ info.disabledReason);
      console.log("type: " ++ info.type);
      console.log("appLaunchURL: " ++ info.appLaunchURL);
      console.log("homepageUrl: " ++ info.homepageUrl );
      console.log("updateUrl: " ++ info.updateUrl  );
      console.log("offlineEnabled: " ++ info.offlineEnabled);
      console.log("optionsUrl: " ++ info.optionsUrl);
      console.log("icons: " ++ info.icons);
      console.log("permissions: " ++ info.permissions);
      console.log("hostPermissions: " ++ info.hostPermissions);
      console.log("installType: " ++ info.installType);
    } 
    ```

我正在尝试通过查看 chrome://extensions 页面来调试 background.html 页面，我看到了 -

```
 Uncaught SyntaxError: Unexpected identifier 
```

由于此错误，事件未按预期触发。

请帮忙！！不知道是什么导致了“Uncaught SyntaxError: Unexpected identifier”错误……可能它太基本了，但是，我看了很长一段时间都无法捕捉到它！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:53:33.703

您的代码有两个主要问题。首先，您在侦听器中包含参数的类型，在这种情况下`ExtensionInfo`，删除它。其次，您使用 2`+`将其更改为 1。生成的代码如下所示：

```
chrome.management.onInstalled.addListener(function(info) {
  console.log('somethingz installed...');
  printInfo(info);
}); 
```

和这个

```
function printInfo(info){
  console.log("id: " + info.id); 
```

作为旁注，您可以执行以下操作，而不是手动记录信息的每个部分：

```
console.log(JSON.stringify(info).replace(',','\n')); 
```

# sqlplus - 如何在 Windows 2008 上安装 SQLPLUS（Oracle DB API）

> ID：16026939
> 
> 赞同：5
> 
> 时间：2013-04-16T00:43:44.447
> 
> 标签：sqlplus

我在这个主题上搜索了好几个小时，但无法解决这个简单的问题。

我只想在我的 Windows 机器上安装 sqlplus 和 oci 客户端。oracle 服务器正在远程运行。在这个 windows 框中，我只想要包括 sqlplus 终端在内的客户端组件。

我已经在我的 Windows 机器上完成了以下操作

从这里下载 oracle 数据访问组件

[http://www.oracle.com/technetwork/database/windows/downloads/index-090165.html](http://www.oracle.com/technetwork/database/windows/downloads/index-090165.html)

以管理员身份运行 cmd.exe 并运行以下命令

安装所有 c:\oracle myhome

在windows控制面板中设置以下环境变量

```
ORACLE_HOME=C:\ORACLE
LD_LIBRARY_PATH=C:\ORACLE
LIB_PATH=c:\ORACLE
NLS_LANG=AMERICAN_AMERICA.UTF8
PATH=C:\ORACLE;C:\ORACLE\BIN 
```

但是当我运行 sqlplus.exe 时出现错误

* ***SP2-0667：找不到消息文件 sp1.msb SP2-0750：您可能需要将 ORACLE_HOME 设置为您的 Oracle 软件目录****

我所有的搜索都显示人们通过正确设置 oracle_home 来解决这个问题......但我认为他们安装了完整的服务器产品，而我只使用上面列出的命令安装了客户端组件。

我错过了什么？如何在我的机器上不安装完整服务器的情况下获得工作的 sqlplus？

# javascript - 如何使用 jQuery 承诺链接三个异步调用？

> ID：16026942
> 
> 赞同：72
> 
> 时间：2013-04-16T00:44:15.087
> 
> 标签：javascript, jquery, asynchronous, deferred

我需要以同步方式进行三个 HTTP 调用，如何将数据从一个调用传递到另一个调用？

```
function first()
{
   ajax()
}

function second()
{
   ajax()
}

function third()
{
   ajax()
}

function main()
{
    first().then(second).then(third)
} 
```

我尝试将 deferred 用于这两个功能，并想出了一个部分解决方案。我可以将它扩展为三个功能吗？

```
function first() {
    var deferred = $.Deferred();
     $.ajax({

             "success": function (resp)
             {

                 deferred.resolve(resp);
             },

         });
    return deferred.promise();
}

function second(foo) {
     $.ajax({
            "success": function (resp)
            {
            },
            "error": function (resp)
            {
            }
        });
}

first().then(function(foo){second(foo)}) 
```

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-04-16T19:43:55.817

In each case, return the jqXHR object returned by `$.ajax()`.

These objects are Promise-compatible so can be chained with `.then()`/`.done()`/`.fail()`/`.always()`.

`.then()` is the one you want in this case, exactly as in the question.

```
function first() {
   return $.ajax(...);
}

function second(data, textStatus, jqXHR) {
   return $.ajax(...);
}

function third(data, textStatus, jqXHR) {
   return $.ajax(...);
}

function main() {
    first().then(second).then(third);
} 
```

Arguments `data`, `textStatus` and `jqXHR` arise from the `$.ajax()` call in the previous function, ie. `first()` feeds `second()` and `second()` feeds `third()`.

**[DEMO](http://jsfiddle.net/dK9tc/)** (with `$.when('foo')` to deliver a fulfilled promise, in place of `$.ajax(...)`).

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2014-01-27T23:21:00.557

在 jQuery 中使用 Promise 时，实际上有一种更简单的方法。看看以下内容：

```
$.when(
    $.ajax("/first/call"),
    $.ajax("/second/call"),
    $.ajax("/third/call")
    )
    .done(function(first_call, second_call, third_call){
        //do something
    })
    .fail(function(){
        //handle errors
    }); 
```

只需将所有调用链接到 $.when(...) 调用并处理 .done(...) 调用中的返回值。

如果您愿意，这里有一个演练：http: [//collaboradev.com/2014/01/27/understanding-javascript-promises-in-jquery/](http://collaboradev.com/2014/01/27/understanding-javascript-promises-in-jquery/)

* * *

## 回答 #3

> 赞同：36
> 
> 时间：2017-04-02T20:56:58.220

回复很晚，但我想答案缺少一些直接的链接代码。使用 jquery 中的 Promise 支持链接事件非常简单。我使用以下链接：

```
$.ajax()
.then(function(){
   return $.ajax() //second ajax call
})
.then(function(){
   return $.ajax() //third ajax call
})
.done(function(resp){
   //handle final response here
 }) 
```

它很简单，没有复杂的 for 循环或多个嵌套回调。

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2013-04-16T00:47:16.180

它比这简单得多。

`$.ajax`已经返回了一个承诺（延迟对象），所以你可以简单地写

```
function first() {
    return $.ajax(...);
} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-01-29T12:52:58.317

最好的方法是为此创建一个可重用的函数。这甚至可以使用一行代码来完成`reduce`：

```
function chainPromises(list) {
    return list.reduce((chain, func) => chain ? chain.then(func) : func(), null);
} 
```

这个函数接受一个回调数组，它返回一个承诺对象，就像你的三个函数一样。

**示例用法：**

```
chainPromises([first, second, third]).then(function (result) {
    console.log('All done! ', result);
}); 
```

这样 的结果`first`也将自动成为 的参数`second`，所以基本上会发生这样的事情：

```
first().then(function(res1) { return second(res1) })
       .then(function(res2) { return third(res2)  })
       .then(function(result) { console.log('All done! ', result) }); 
```

当然，您可以根据需要向数组中添加任意数量的函数。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2016-01-26T15:48:49.877

您可以以更实用的方式编写它：

```
[function() { return ajax(...)}, function(data) { return ajax(...)}]
.reduce(function(chain, callback) { 
  if(chain) { 
    return chain.then(function(data) { return callback(data); });
  } else {
    return callback();
  }
}, null) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-09-23T00:33:04.760

我在这里找到了一个好看的解决方案：[How do I chain a sequence of deferred functions in jQuery 1.8.x?](https://stackoverflow.com/questions/13651243/how-do-i-chain-a-sequence-of-deferred-functions-in-jquery-1-8-x#24041521)

这是我自己实现的类似方法，有点丑陋但可能有效。它将每个方法的结果广播为返回的承诺对象上的“进度更新”。

```
 $.chain = function() {
      var defer = $.Deferred();
      var funcs = arguments;
      var left = funcs.length;
      function next(lastResult) {
          if(left == 0) {
              defer.resolve();
              return;
          }
          var func = funcs[funcs.length - left]; // current func
          var prom = func(lastResult).promise(); // for promise will return itself,
                                       // for jquery ojbect will return promise.
          // these handlers will be launched in order we specify them
          prom.always(function() {
              left--;
          }).done(function(ret) {
              defer.notify({
                  idx: funcs.length-left,
                  left: left,
                  result: ret,
                  success: true,
              });
          }).fail(function(ret) {
              defer.notify({
                  idx: funcs.length-left,
                  left: left,
                  result: ret,
                  success: false,
              });
          }).always(function(ret) {
              next(ret);
          });
      }
      next();
      return defer.promise();
  }; 
```

如何根据您的情况使用它？也许不漂亮，但它应该工作：

```
function first() {
    return ajax(...);
}

var id;

funciton second() {
    return ajax(id, ...);
}

function third() {
    return ajax(id, ...);
}

$.chain(first, second, third).progress(function(p) {
    if(p.func == first)
        id = p.result.identifier;
}).then(function() {
    alert('everything is done');
}); 
```

或者您可以从`first`函数中分配该 id 变量。

或者，如果您只需要前一个函数的结果，您可以使用这种方法：

```
function first() {
    return ajax(...);
}
function second(first_ret) {
    return ajax(first_ret.id, ...);
}
function third(second_ret) {
    return ajax(second_ret.something, ...);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-12-02T23:25:23.120

以下似乎有效，并允许函数列表是动态的：

```
<html>
  <head>
  <title>demo chained synchronous calls</title>
  </head>
  <body>

  <script src="http://code.jquery.com/jquery-2.2.4.min.js"></script>
  <script type="text/javascript">
    function one(parms) {
        console.log('func one ' + parms);
        return 1;
    }

    function two(parms) {
        console.log('func two ' + parms);
        return 2;
    }

    function three(parms) {
        console.log('func three ' + parms);
        return 3;
    }

    function four(parms) {
        console.log('func four ' + parms);
        return 4;
    }

    var funcs = ['one', 'two', 'three', 'four'];
    var rvals = [0];

    function call_next_func() {
        if (funcs.length == 0) {
            console.log('done');
        } else {
            var funcname = funcs.shift();
            console.log(funcname);
            rvals.push(window[funcname](rvals));
            call_next_func();
        }
    }

    $(document).ready(function($){
        call_next_func();
    });
  </script>

  </body>
</html>
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-06-18T05:43:39.153

要链接 jquery ajax 调用，我做了：

```
function A(){
     return $.ajax({
      url: url,
      type: type,
      data: data,
      datatype: datatype,
      success: function(data)
      {
        code here
      }
    });
   }

   function B(){
     return $.ajax({
      url: url,
      type: type,
      data: data,
      datatype: datatype,
      success: function(data)
      {
        code here
      }
    });
   }

   function C(){
     return $.ajax({
      url: url,
      type: type,
      data: data,
      datatype: datatype,
      success: function(data)
      {
        code here
      }
    });
   }

   A().done(function(data){
     B().done(function(data){
        C();
     })
   }); 
```

# c - 我想在 C 中实现 glob 函数

> ID：16026943
> 
> 赞同：2
> 
> 时间：2013-04-16T00:44:23.023
> 
> 标签：c, unix

我正在尝试`ls`使用通配符实现命令，`?`并且`*`不使用 glob 函数。我将实现我自己的匹配通配符模式的路径生成器。但我不知道从哪里开始。首先，我需要遍历目录。如何遍历目录以匹配包含通配符的模式字符串。例如，假设模式是`*/*`。我必须遍历`directories/entires`然后检查模式字符串是否与使用的遍历路径匹配`fnmatch()`。而且有很多可能的情况，`../*/*`, `*/../*`, `*/`,`*/*/*.out`等。
有什么有用的链接吗？任何帮助都是极好的。

# php - 带有 PHP“echo”的 XML 得到错误“文档末尾的额外内容”

> ID：16026944
> 
> 赞同：0
> 
> 时间：2013-04-16T00:44:23.893
> 
> 标签：php, xml, echo, extra

我收到了一个我认为非常具体的错误。

这个 PHP 存储在我的域中。它访问带有 mysql 数据库的服务器，并使用它的表信息生成带有标记的 XML，随后将在 Google Map 中使用。

实际上它正在工作，因为它正在检索标记，但是这个错误并没有消失，我不知道是什么原因造成的。我对所有 php 和 android 编程都很陌生。如果有人可以通过简单的解释为我澄清这一点，我将不胜感激。

错误是：

```
This page contains the following errors:

error on line 3 at column 1: Extra content at the end of the document
Below is a rendering of the page up to the first error. 
```

然后它呈现我的预期结果。我想解决并理解为什么会发生这种情况。

你去我的php代码。我从教程（[https://developers.google.com/maps/articles/phpsqlajax_v3](https://developers.google.com/maps/articles/phpsqlajax_v3)）中得到：

```
<?php
require("db_config.php");

function parseToXML($htmlStr) 
{ 
$xmlStr=str_replace('<','&lt;',$htmlStr); 
$xmlStr=str_replace('>','&gt;',$xmlStr); 
$xmlStr=str_replace('"','&quot;',$xmlStr); 
$xmlStr=str_replace("'",'&#39;',$xmlStr); 
$xmlStr=str_replace("&",'&amp;',$xmlStr); 
return $xmlStr; 
} 

// Opens a connection to a MySQL server

$connection=mysql_connect ($mysql_host, $mysql_user, $mysql_password);
if (!$connection) {  die('Not connected : ' . mysql_error());}

// Set the active MySQL database

$db_selected = mysql_select_db($mysql_database, $connection);
if (!$db_selected) {
    die ('Can\'t use db : ' . mysql_error());
}

// Select all the rows in the markers table
$query = "SELECT * FROM Estac WHERE 1";
$result = mysql_query($query);
if (!$result) {
        die('Invalid query: ' . mysql_error());
}

header("Content-type: text/xml");

// Start XML file, echo parent node
echo '<markers>';

// Iterate through the rows, printing XML nodes for each
while ($row = @mysql_fetch_assoc($result)){
  // ADD TO XML DOCUMENT NODE
  echo '<marker>';
  echo 'Name="' . parseToXML($row['Name']) . '" ';
  echo 'Address="' . parseToXML($row['Address']) . '" ';
  echo 'Tel="' . parseToXML($row['Tel']) . '" ';
  echo 'Lat="' . $row['Lat'] . '" ';
  echo 'Lng="' . $row['Lng'] . '" ';
  echo 'Price="' . $row['Price'] . '" ';
  echo '</marker>';
}

// End XML file
echo '</markers>';

?> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-21T13:09:49.153

只需右键单击您的输出错误网页并查看源代码，您将在 PHP 文件中看到正确的错误消息和行号。您将在几秒钟内解决该错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T15:32:55.293

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-24T17:04:28.957

我遇到了同样的问题并将“”放在数据库周围，它起作用了。

# vb.net - 什么是具有始终聚焦窗体的 Visual Basic 代码？

> ID：16026949
> 
> 赞同：0
> 
> 时间：2013-04-16T00:44:48.687
> 
> 标签：vb.net, winforms

我知道什么是 Always-On-Top，但这不是我要找的东西。

“始终聚焦”是指当我单击表单外部时，它不会变灰并变得不可用，我希望表单保持焦点，并且当我单击屏幕外时仍然触发我的 KeyDown 事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T00:47:20.973

对于 VBA，您是否正在寻找“ShowModal”表单属性？这将要求在使用表单之外的东西之前关闭表单。在关闭之前，表单将始终“聚焦”。

对于 VB.NET，您可以使用 ShowDialog 事件，但这将不允许用户在窗体关闭之前进行任何工作。

# haskell - 创建类似于具有链式状态的 IO Monad 的 monad

> ID：16026955
> 
> 赞同：6
> 
> 时间：2013-04-16T00:45:04.543
> 
> 标签：haskell, monads, state-monad

大家好，

今年我对 Haskell 还是很陌生（在 1990 年代初使用它之后，又在 00 年代初再次使用它）。我正在尝试编写一些代码，它使用的模式几乎直接类似于[Haskell Wiki 上显示的示例 IO monad](http://www.haskell.org/haskellwiki/IO_inside#Welcome_to_the_RealWorld.2C_baby)：

```
type IO a  =  RealWorld -> (a, RealWorld) 
```

（是的，我知道这不是 IO 的 GHC 实现，而只是理解它的一种工具。）原因是，在我的应用程序（游戏）中，我现在有两种模式来执行此操作，其中有两种不同的`RealWorld`替换. 一方面，它是游戏的状态，另一方面，它只是一个`StdGen`随机数种子。我当然现在有两对这样的类型：

```
-- | Easily return a specified value as well as the new random number generator
type ReturnRNG a = (a, StdGen)

-- | Take an RNG and return it and another value.
-- (This is basically like the IO type but with the StdGen instead of RealWorld.)
type WithRNG a = StdGen -> ReturnRNG a

-- | Easily return a specified value as well as the new GameState
type ReturnGS a = (a, GameState)

-- | Use a GameState and return a value with the updated GameState.
-- (This is like IO.)
type WithGS a = GameState -> ReturnGS a 
```

（是的，我可以用两个参数将它们抽象成一对，但我还没有解决。）当然，你可以看到 my`WithGS a`和`WithRNG a`types（类型同义词）与上面的完全相似`IO a`。

因此，这是我现在拥有的实际工作代码的简单示例：

```
-- | Returns a random position for the given size.
randomPos :: (Int, Int)          -- ^ The size
          -> WithRNG (Int, Int)  -- ^ The result (0 up to 1 less than the size) and new RNG seed
randomPos (w, h) r0 = ((x, y), r2)
  where
    (x, r1) = randomR (0, w - 1) r0
    (y, r2) = randomR (0, h - 1) r1 
```

这会在指定范围内创建一个随机对，并返回最终的 RNG 种子。我的大部分方法都是这样的（使用`WithRNG`or `WithGS`），使用链式状态，有时甚至达到`r4`or `r6`（或`gs4`等）。我宁愿写这个例子看起来像这样......

```
-- (Not working example)
randomPosSt (w, h) = do
    x <- randomR (0, w - 1)
    y <- randomR (0, h - 1)
    return (x, y) 
```

...但具有完全相同的方法签名和语义。这似乎应该可以按照上述给出这个例子的教程进行：

```
(>>=) :: IO a -> (a -> IO b) -> IO b
(action1 >>= action2) world0 =
   let (a, world1) = action1 world0
       (b, world2) = action2 a world1
   in (b, world2) 
```

如您所见，这几乎正是我在上面所做的（一旦您将“ `let`”替换为“ `where`”符号）。

但是，我不能从类型同义词中创建 Monad。（我已经尝试过 TypeSynonymInstances 但它似乎不适用于“ `instance Monad WithRNG where`”或使用参数。使用 a`newtype`似乎也会添加无用的丑陋语法。）我无法很好地弄清楚 State Monad使用它做一个等效的方法。然而，即使我成功了，State Monad 实现似乎也使用了丑陋的“ `get`”和“ `put`”s（以及“ `runState`”s 等），并且使代码*的*可读性降低，而不是更多。

```
-- THIS DOES NOT WORK
-- | Make a State Monad with random number generator - like WithRNG above
type RandomState = State StdGen

-- | Returns a random position for the given size.
randomPosSt :: (Int, Int)                  -- ^ The size
            -> RandomState (Int, Int)  -- ^ The result (0 up to 1 less than the size) and new RNG seed 
```

经过这一切，我得出的结论是，我要么做错了什么，误解了某些事情，要么就是不能做我想做的事。我正要说“好吧，你真的不需要弄清楚如何修改你的代码来使状态被自动处理，因为它工作得很好”然后放弃了，然后我想我会在这里问（我的处女作潜伏）。我更喜欢更优雅的解决方案。

我还想一个更优雅的解决方案会给我这个我“免费”使用的功能：

```
-- | Maps the specified method, which must take a RNG as the last parameter,
-- over all the elements of the list, propagating the RNG and returning it.
-- TODO: Implement this without using recursion? Using a fold?
mapRandom :: (a -> WithRNG b) -- ^ The function to map (that takes a RNG)
          -> [a] -- ^ The input list
          -> WithRNG [b] -- ^ The RNG to return
mapRandom func [] r0 = ([], r0)
mapRandom func (x:xs) r0 = (mapped : rest, r2)
  where
    (mapped, r1) = func x r0
    (rest, r2)   = mapRandom func xs r1 
```

感谢您的任何想法、建议、参考和您的时间！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T04:51:41.000

您可以在不使用or的`State`情况下使用 monad 。只需将您的状态传递函数直接包装在新类型中：`get``put``State`

```
import System.Random

newtype State s a = State { runState :: s -> (a, s) }

instance Monad (State s) where
    return a = State (\s -> (a, s))

    m >>= f = State (\s0 ->
        let (a, s1) = runState m s0
        in  runState (f a) s1 )

randomPos :: (Int, Int) -> State StdGen (Int, Int)
randomPos (w, h) = do
    x <- State $ randomR (0, w - 1)
    y <- State $ randomR (0, h - 1)
    return (x, y) 
```

诀窍是观察`State`构造函数的类型：

```
State :: (s -> (a, s)) -> State s a 
```

.. 并且`randomR (lo, hi)`有正确的类型可以直接包装在`State`：

```
randomR (1, 6)          :: StdGen -> (Int, StdGen)
StateT $ randomR (1, 6) :: State StdGen Int 
```

构造`State`函数采用状态传递函数并创建一个合适的值以在`State`monad 中使用。然后，当您使用完 monad 后，您可以使用以下命令将 monad 转换回等效的状态传递函数`runState`：

```
runState :: State s a -> (s -> (a, s))

runState (randomPos (5, 6)) :: StdGen -> ((Int, Int), StdGen) 
```

这实际上是如何`RandT`工作的，通过将所有通过生成器的随机函数包装在一个状态单子中，并且`RandT`相当于`StateT StdGen`在引擎盖下。

另外，就像你说的，一元公式会免费为你提供映射版本：

```
mapRandom
    :: ( a  -> (StdGen -> ( b , StdGen)))
    -> ([a] -> (StdGen -> ([b], StdGen)))
mapRandom f xs = runState $ mapM (State . f) xs 
```

这是因为`mapM`（当专门用于`State`）的类型是：

```
mapM :: (a -> State s b) -> [a] -> State s [b] 
```

所以上面的`mapRandom`函数所做的就是将输入包装成一个`State`新类型，使用`mapM`，然后解包。

# iphone - 保存上下文中的 CoreData 错误，NSPersistentStoreCoordinator 没有持久存储

> ID：16026959
> 
> 赞同：3
> 
> 时间：2013-04-16T00:45:53.623
> 
> 标签：iphone, ios, objective-c, core-data

我已经查看了我能找到的所有类似问题，但他们的解决方案都不适合我。

一个问题可能是，在我返回 JSON 并从 webAPI 解析之后，将实体添加到上下文（成功）和保存上下文发生在不同的线程上。但是上下文是在第一次使用 manageContext 和持久存储时设置的，如下所示。因此，在解析发生这种情况之后，它将在该线程上。

确切的错误：

```
 *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'This NSPersistentStoreCoordinator has no persistent stores.  It cannot perform a save operation.' 
```

我试过从模拟器中删除应用程序，正如建议的那样，没有改变。

这是我正在使用的 CoreDataHelper 类，我的应用程序中只有 1 个实例，当我在将新项目添加到上下文后调用 helper 上的 saveContext 方法时会发生错误：

```
@implementation CoreDataHelper

@synthesize managedObjectContext = _managedObjectContext;
@synthesize managedObjectModel = _managedObjectModel;
@synthesize persistentStoreCoordinator = _persistentStoreCoordinator;

#pragma mark - Application's Documents directory

// Returns the URL to the application's Documents directory.
- (NSURL *)applicationDocumentsDirectory
{
    return [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory
                                                   inDomains:NSUserDomainMask] lastObject];
}

- (void)saveContext
{
    NSError *error = nil;
    if (self.managedObjectContext != nil) {
        if ([self.managedObjectContext hasChanges] && ![self.managedObjectContext save:&error]) {
            // Replace this implementation with code to handle the error appropriately.
            // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development.
            NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
            abort();
        }
    }
}

- (void)dealloc {

    [self saveContext];
}

#pragma mark - Core Data stack

// Returns the managed object context for the application.
// If the context doesn't already exist, it is created and bound to the persistent store coordinator for the application.
- (NSManagedObjectContext *)managedObjectContext
{
    if (_managedObjectContext != nil) {
        return _managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = self.persistentStoreCoordinator;
    if (coordinator != nil) {
        _managedObjectContext = [[NSManagedObjectContext alloc] init];
        [_managedObjectContext setPersistentStoreCoordinator:coordinator];
    }
    return _managedObjectContext;
}

// Returns the managed object model for the application.
// If the model doesn't already exist, it is created from the application's model.
- (NSManagedObjectModel *)managedObjectModel
{
    if (_managedObjectModel != nil) {
        return _managedObjectModel;
    }
    NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"Model" withExtension:@"momd"];
    _managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    return _managedObjectModel;
}

// Returns the persistent store coordinator for the application.
// If the coordinator doesn't already exist, it is created and the application's store added to it.
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    if (_persistentStoreCoordinator != nil) {
        return _persistentStoreCoordinator;
    }

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"UserGroupTV.sqlite"];

    NSError *error = nil;
    _persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc]
                                   initWithManagedObjectModel:[self managedObjectModel]];

    // needed for lightweight migrations
    NSMutableDictionary *options = [NSMutableDictionary dictionary];
    [options setObject:[NSNumber numberWithBool:YES]
                forKey:NSMigratePersistentStoresAutomaticallyOption];
    [options setObject:[NSNumber numberWithBool:YES]
                forKey:NSInferMappingModelAutomaticallyOption];

    if (![_persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType
                                                   configuration:nil
                                                             URL:storeURL
                                                         options:options
                                                           error:&error])  {

        UIAlertView *alertView = [[UIAlertView alloc] initWithTitle:@"Error"
                                                            message:[error localizedDescription]
                                                           delegate:self
                                                  cancelButtonTitle:@"OK"
                                                  otherButtonTitles:nil, nil];
        [alertView show];
    }

    return _persistentStoreCoordinator;
}

@end 
```

ETA：我已经看到它提到过，但是如何/在哪里删除存储 sql 文件的机器上的本地文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T01:38:03.100

我没有一个明确的答案，但这里有几件事要看：

1.  在您创建`persistentStoreCoordinator`. 如果在创建过程中添加商店时发生错误，您可以在那里捕获它。

2.  您提到您将托管对象上下文保存在后台线程上。`NSManagedObjectContext`不是线程安全的，您应该只在创建它的线程上使用特定的上下文。每个线程至少需要一个上下文。您可以观察“NSManagedObjectContextDidSaveNotification”并将更改合并到您的主要上下文中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T23:33:47.530

事实证明，每次我回忆 Web API 时，我都在删除商店而不是重新创建它。我最初的目标是每次用户想通过调用 api 刷新视频列表时清理数据库，我正在删除所有对象，然后删除存储并忘记重新创建它。这是我的刷新数据库方案，我只是删除了 saveContext 调用下面的所有内容。

```
- (void)resetDataBase {

    [self deleteAllObjects:@"Speaker"];
    [self deleteAllObjects:@"Tag"];
    [self deleteAllObjects:@"UserGroup"];
    [self deleteAllObjects:@"Video"];

    [_coreDataHelper saveContext];

    // REMOVED BELOW and it worked
    NSPersistentStore * store = [[_coreDataHelper.persistentStoreCoordinator persistentStores] lastObject];
    if (store) {
        NSError * error;
        [_coreDataHelper.persistentStoreCoordinator removePersistentStore:store error:&error];
        if (error) {
            [self showError:error];
        }
    }

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"UserGroupTV.sqlite"];
    [[NSFileManager defaultManager] removeItemAtURL:storeURL error:nil];
} 
```

# c++ - 引号内的字符串

> ID：16026961
> 
> 赞同：0
> 
> 时间：2013-04-16T00:46:19.690
> 
> 标签：c++, prepared-statement, mysql-connector

所以*C++ 连接器 mysql*的文档说：

```
sql::Connection *con;
sql::PreparedStatement  *prep_stmt
// ...

prep_stmt = con->prepareStatement("INSERT INTO test(id, label) VALUES (?, ?)");

prep_stmt->setString(2, "a");
prep_stmt->execute(); 
```

但是当我输入我的代码时

```
 pstmt = con->prepareStatement("UPDATE master SET movie='?' WHERE choice='Y'");
  pstmt->setString(1, str);
  pstmt->execute(); 
```

它告诉我在运行程序后我不允许这样做。

> Camera Command Line.exe 中 0x75c24b32 处未处理的异常：Microsoft C++ 异常：内存位置 0x00dbe59c 处的 sql::InvalidArgumentException。

我知道它告诉我我不能这样做，但我不明白为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:49:52.873

您正在使用准备好的语句，因此您不需要`bound`在 SQL 中引用变量，您应该这样做：

```
pstmt = con->prepareStatement("UPDATE master SET movie=? WHERE choice='Y'");
                                                      ^^^ 
```

# c# - 使用()/Try-Catch 保存/加载

> ID：16026965
> 
> 赞同：0
> 
> 时间：2013-04-16T00:47:15.697
> 
> 标签：c#, stream, using-statement

在过去的几个小时里，我一直在研究如何为我正在制作的游戏实现简单的保存/加载功能。

保存数据被存储在一个文本文件中，在游戏过程中玩家可以保存，存储玩家和敌人的位置，分数等。

我正在为此使用 StreamWriter 和 StreamReader，并且无法决定是使用 using 语句还是 try-catch 来实现它。

为了节省空间，我将仅列出 Save 方法，因为它们与加载方法基本相同。

**使用：**

```
 static void SaveAccounts(string path)
      {

            using (StreamWriter writer = new StreamWriter(path))
            {
                writer.WriteLine(accountNumber);
                writer.WriteLine(name);
                writer.WriteLine(address);
                writer.WriteLine(balance);     
            }
      } 
```

**试着抓**

```
 public void Save(StreamWriter writer)
     {
        writer.WriteLine(accountNumber);
        writer.WriteLine(name);
        writer.WriteLine(address);
        writer.WriteLine(balance);
     }

    public void Save(string filename)
    {
       StreamWriter writer = null;
        try
        {
            writer= new StreamWriter(filename);
            Save(writer);
        }
        catch (Exception e)
        {
            throw e;
        }
        finally
        {
            if (writer!= null) writer.Close();
        }
    } 
```

在这种情况下，我使用“帐户”代替我的精灵，只是看起来更简单。

那么任何人都可以给我任何你会使用的见解吗？如果有的话。

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:49:14.217

您应该使用该`using`语句。

没有理由多写 8 行代码来做完全相同的事情，但是是错误的。
也没有理由编写 4 行额外的代码来正确执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T01:13:18.050

`try/catch`即使需要多几行，我也会使用。为什么？因为`using`您无法控制出现异常时会发生什么。和`try/catch`你一起做。

例如，想象一下如果在保存过程中出现异常会发生什么。随着`using`程序停止并关闭文件，无论您的程序能够写入什么信息。也就是不完整。`try/catch`您可以决定删除该文件。您还可以将所有内容写入临时文件并复制到最终位置，前提是所有代码都可以正常工作，否则只需删除临时文件。

# python - 如何减少我的 python 应用程序连接到 mysql 服务器的超时

> ID：16026968
> 
> 赞同：4
> 
> 时间：2013-04-15T20:36:36.437
> 
> 标签：python, mysql, nginx, web2py, uwsgi

我们有一个使用 uwsgi、nginx 运行的 python 应用程序。

我们有数据库的后备机制。即，如果一台服务器拒绝连接，我们连接到另一台服务器。但问题是连接需要超过 60 秒才能超时。

由于 nginx 在 60s 超时，它会显示 nginx 错误页面。我们在哪里可以更改连接 mysql 服务器的超时时间，以便我们可以在给定的 60 秒 nginx 超时时间内尝试连接 mysql 三次？

我们使用带有 pymysql 适配器的 Web2py 和默认 DAL 对象

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T10:57:23.960

你在谈论选项`connect_timeout`？

```
conn = pymysql.connect(host='127.0.0.1', port=3306, user='root', passwd='', db='mysql', connect_timeout=20) 
```

在 DAL 术语中，此选项将与此有关（未经测试）

```
db = DAL('mysql://username:password@localhost/test', driver_args={connect_timeout=20}) 
```

# git - 在 Git 中将多个提交合并为一个

> ID：16026970
> 
> 赞同：3
> 
> 时间：2013-04-16T00:47:38.887
> 
> 标签：git, git-merge, git-rebase, squash

我有一个单独的分支 git 存储库，有 ~4000 次提交。我想根据提交的创建日期对提交进行分组。例如，给定以下提交：

```
abcd 2013-4-1 12:10
abce 2013-4-1 13:27
...
cdef 2013-4-1 18:16
cdeg 2013-4-2 09:23
...
gade 2013-4-2 18:20
fdeg 2013-4-3 09:42
... 
```

我想获得一个提交历史，例如所有`abcd`-`cdef`提交合并为一个提交，所有 cdeg-gade 合并为一个，依此类推。我尝试使用变基作为

```
git reset --hard cdef
git rebase -i abcd 
```

我无法压缩所有提交，收到以下错误消息。

```
"Cannot 'squash' without a previous commit" 
```

我试图一次压缩一个提交，它奏效了，但花了很长时间，显然不可行。

如何根据提交的创建日期合并提交？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T01:05:30.550

将每天的第一次提交标记为“reword”，其余的标记为“fixup”：

```
reword xxxxxx First commit from 2013-04-01
squash xxxxxx another commit from 2013-04-01
squash xxxxxx another commit from 2013-04-01
reword xxxxxx First commit from 2013-04-02
etc 
```

这将提示您每天编写一条新的提交消息。

请注意，按时间进行提交几乎总是**错误**的做法。对于喜欢`git bisect`正常工作的工具，存储库中的每个提交都应该代表“一口大小”的更改。

# actionscript-3 - 从 oflaDemo 调用 Red5 API

> ID：16026977
> 
> 赞同：1
> 
> 时间：2013-04-16T00:49:02.357
> 
> 标签：actionscript-3, flash, flex4, red5

我一直在尽可能多地查看 Red5 的 oflaDemo 客户端的源代码。我一直试图弄清楚客户端如何访问服务器端代码中提供的功能。

我使用 Adob​​e Flash 查看了 oflaDemo flash 文件，根本看不到其中的任何脚本代码。我没有看到任何开始播放所选电影的任何内容。我没有看到任何调用 DemoService 中的任何服务来获取流目录中可用电影列表的内容。我根本不知道如何调用服务器端函数。

有人能指出如何在 Red5 应用程序中调用服务器端函数的示例吗？在 oflaDemo 应用程序中执行此操作的代码在哪里？是否有任何客户端文档（非上下文 Javadocs 除外）可以说明如何从客户端执行此操作？有没有关于如何使用客户端函数调用服务器端功能的教程？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T07:43:57.887

代码位于“代码”和“按钮代码”层的第一帧上的 Flash 文件中。右键单击上面带有小“a”的框架，然后从弹出菜单中选择“操作”。

# flash - 如何使用 JSFL 设置电影剪辑的舞台实例名称

> ID：16026985
> 
> 赞同：2
> 
> 时间：2013-04-16T00:50:14.680
> 
> 标签：flash, jsfl

当我使用 JSFL 创建影片剪辑并设置 .name 参数时 - 这将成为影片剪辑在库中出现的名称 - 但是，我想为舞台上的影片剪辑提供实例名称。我附上了一张图片来显示我试图通过 JSFL 填充的字段。

谢谢！

![在此处输入图像描述](https://i.stack.imgur.com/k0Lg6.png)

这是设置名称的代码，基本上循环通过 fl.getDocumentDOM() 直到我在舞台上获得所有元素的数组，然后一旦我有了一个元素。

```
var newMc = fl.getDocumentDOM().convertToSymbol("movie clip", mcName, "top left");
newMc.name = "row_" + rowq.toString() + "_column_"+ colq.toString();
newMc.linkageExportForAS=true;      
newMc.linkageClassName="com.xyz.as3.view.component.Piece"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T02:35:54.803

`newMC`是库项目而不是舞台实例，但现在应该选择新实例，因此您可以使用：

```
fl.getDocumentDOM().selection[0].name 
```

# java - 如何从按ID升序排序的数据库中查询？

> ID：16026988
> 
> 赞同：0
> 
> 时间：2013-04-16T00:50:37.163
> 
> 标签：java, android, sqlite

我在资产文件夹中导入了一个数据库。当我调用 nextQuestion() 方法时，我需要从数据库中检索第一个条目。用户回答后，我需要再次加载 nextQuestion() 方法并从数据库中检索下一个条目。我试过了，但没有用，我总是只得到第一个条目：

```
String sql ="SELECT * FROM tblTable ORDER BY _ID ASC LIMIT 1"; 
```

也试过这个：

```
String sql ="SELECT * FROM tblTable ORDER BY _ID ASC"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T08:10:28.317

->`String sql ="SELECT * FROM tblTable ORDER BY _ID ASC";`只执行一次，
-> 将数据保存在 ArrayCollection 中
-> 创建全局变量 whichQuestion:Number; // 保留你所在的问题
-> 创建一个类似的方法

```
 nextQuestion(whichQuestion:Number):String //pass which question you want to ask
{
  return questionCollection[i];
} 
```

-> 然后 whichQuestion +=1;
-> 最后，当你需要问题时，只需调用 nextQuestion() 方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T00:57:26.553

当然你总是只得到第一个，你一遍又一遍地执行相同的查询。如果数据不是很大，请使用第二个查询。只执行一次并将所有行存储在内存中。然后，您的`nextQuestion()`方法不再需要进行数据库查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T00:58:53.863

我相信你需要使用你的第二个查询**一次**，捕获`Resultset`然后直接使用 `first`, `next`,`previous`等遍历它，或者在一个循环中加载它`ArrayList`并使用它的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T01:00:46.630

虽然效率不高，但您可以使用以下查询来获取下一个问题：

```
SELECT * 
FROM 
(
    SELECT * 
    FROM 
        questions 
    ORDER BY ID ASC LIMIT :questionNumber
) ORDER BY ID DESC LIMIT 1 
```

`:questionNumber`第 n 个感兴趣的问题在哪里。

例如：[http ://sqlfiddle.com/#!7/a20b8/4](http://sqlfiddle.com/#!7/a20b8/4)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T07:43:21.897

您真正想要的是最小 ID 仍然大于您之前的 ID 的问题：

```
SELECT *
FROM tblTable
WHERE _ID > ?    -- insert previous ID here
ORDER BY _ID
LIMIT 1 
```

# java - 交互式 Java 软件架构

> ID：16026992
> 
> 赞同：-1
> 
> 时间：2013-04-16T00:51:10.627
> 
> 标签：java, architecture, executorservice

我们不久前设计了一个处理事务的软件架构。它的工作原理是这样的：传入的事件，根据它们的类型，被翻译成's，然后根据事件类型`Callable`运行成一个。`Executor`例如，“Event_A”类型被转换为`EventAHandler`(a `Callable`)，然后在`Executor`.

我们现在必须支持交互式事件，即需要用户通过网络进一步输入的事件，这很慢。例如，对于新类型的事件，我们向用户呈现一个菜单并等待响应。如果我们遵循上述架构，即将每个事件转换为`Callable`，我们会占用等待用户响应的线程，这不是一个好主意。

我正在寻找让我们这样做的建议或建筑风格。我们需要每秒支持大约 10,000 个事件。如果可能的话，我想坚持使用 Executor Framework，并且不能更改系统以支持异步循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T01:00:16.540

使用基于[Actor 模型](http://en.wikipedia.org/wiki/Actor_model)的架构可能适合您的需求，[akka](/questions/tagged/akka "显示标记为“akka”的问题")是这种范例的一个众所周知的实现。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T06:52:10.317

首先，您必须将您的架构表示为[数据流图](http://en.wikipedia.org/wiki/Data_flow_diagram)。它可以是动态的，在执行期间创建新节点。与其等待用户响应，不如创建一个对该响应做出反应的新节点，并将响应路由到该节点。这样你就永远不会阻塞线程。

然后，实现您需要的数据流图元素的哪些属性，例如：

*   节点是对多个后续消息（如对象）做出反应还是用于处理单个消息（如方法调用）

*   节点是否有单个输入或多个输入

*   如果有多个输入，当所有输入都被填充（与门）或任何输入被填充（或门）时节点是否应该触发执行

- ETC

然后决定哪个数据流/actor 库符合您的要求。我不会排除 Akka，但我推荐我的开发[df4j](https://github.com/rfqu/df4j)，因为它紧凑、可扩展，并且支持开箱即用的多输入节点。

# php - 显示错误

> ID：16026994
> 
> 赞同：0
> 
> 时间：2013-04-16T00:51:21.923
> 
> 标签：php, html

我有这个代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" media="screen" href="Azulmedia.css" />
<title>Untitled Document</title>
<style type="text/css">
<!--
body {
    background-color: #FFF;
}
-->
</style>
</head>

<body>
<div class="box" style='display:inline-block;'><h1><center>Pending Reservations to Approve</center></h1>
<?php

require("aacfs.php");
$result=mysql_query("select * from reservation where signoff='' and status!='Cancelled' order by reservno") or die(mysql_error());
echo "<center><div class='box'><table class='hovertable'>
    <th>Reservation No</th> 
    <th>Booking Date</th> 
    <th>Client Name</th>
    <th>Flight Date</th>
    <th>Aircraft</th>
    <th>Itinerary</th>
    <th>ETD</th>
    <th>ETA</th>
    <th>Confirmation Cut Off</th>
    <th>Status</th>
    <th>Reserved By</th>
    </tr>";
    if(mysql_num_rows($result)>0)
    {
        while($row=mysql_fetch_array($result))
        {
            $rvno=$row['reservno'];
            $rn="2012-".$rvno;
            echo"<tr><td>".$rn."</td><td>".$row['bdate']."</td><td>".$row['cliename']."</td><td>".$row['fdate']."</td><td>".$row['acode']."</td><td>".$row['itinerary']."</td><td>".$row['etd']."</td><td>".$row['eta']."</td><td>".$row['cutoff']."</td><td>".$row['status']."</td><td>".$row['adminid']."</td></tr>";

        }
    }
    else
    { ?>
        <tr><td colspan="14" style="text-align:center; color:#FF0000; font-size:16px;">*No Data Available*</td></tr>
        <?php
    }
    echo "</div>";
        ?>
</div>
</br>
<div class="box" style='display:inline-block;'><h1><center>PTR to Edit</center></h1>
<?php

//require("aacfs.php");
$result1=mysql_query("select * from reservation where (etd < now() and status = 'Confirmed' and signoff!='') or (allowed='yes') order by reservno") or die(mysql_error());
echo "<center><div class='box'><table class='hovertable'>
    <th>Reservation No</th> 
    <th>Booking Date</th> 
    <th>Client Name</th>
    <th>Flight Date</th>
    <th>Aircraft</th>
    <th>Itinerary</th>
    <th>ETD</th>
    <th>ETA</th>
    <th>Confirmation Cut Off</th>
    <th>Status</th>
    <th>Reserved By</th>
    </tr>";
    if(mysql_num_rows($result1)>0)
    {
        while($row1=mysql_fetch_array($result1))
        {
            $rvno=$row1['reservno'];
            $rn="2012-".$rvno;
            echo"<tr><td>".$rn."</td><td>".$row1['bdate']."</td><td>".$row1['cliename']."</td><td>".$row1['fdate']."</td><td>".$row1['acode']."</td><td>".$row1['itinerary']."</td><td>".$row1['etd']."</td><td>".$row1['eta']."</td><td>".$row1['cutoff']."</td><td>".$row1['status']."</td><td>".$row1['adminid']."</td></tr>";

        }
    }
    else
    { ?>
        <tr><td colspan="14" style="text-align:center; color:#FF0000; font-size:16px;">*No Data Available*</td></tr>
        <?php
    }
    echo "</div>";
        ?>
</div>

</body>
</html> 
```

它应该首先显示`Pending Reservations to Approve`，然后是表格，然后`PTR to Edit`是表格。但它显示如下：

![在此处输入图像描述](https://i.stack.imgur.com/XbltO.jpg)

我怎样才能分开两个表？首先是`Pending Reservations to Approve`标题和表格，然后`PTR to Edit`是其下方的标题和表格。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:54:32.513

你没有关闭很多标签。`"<center><div class='box'><table class='hovertable'>`- 你不关闭`<table>`和看似`<center>`. `echo "</div>";`实际上应该是`echo "</table></div></center>";`

# php - 如何在 PHP 中从一个日期到另一个日期获取整数

> ID：16026999
> 
> 赞同：-2
> 
> 时间：2013-04-16T00:52:22.750
> 
> 标签：php

嘿伙计们，所以我想知道日期，让我们说 Y-MM-DD，让我们说从上周到现在。

所以：

2013-4-8 到 2013-4-15 <-- 所以我想把这两者之间的距离变成一个整数，所以它应该是 7。

我的问题是如何获得该号码？

大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T01:09:06.840

以时尚的方式：

```
$start = '2013-4-8';
$end = '2013-4-15';
$diff = count(range(strtotime($start), strtotime($end),86400))-1;
echo $diff; 
```

[在线演示](http://codepad.viper-7.com/a8Piyn)