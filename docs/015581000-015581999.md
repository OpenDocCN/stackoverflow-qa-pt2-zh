# StackOverflow 问答 15581000-15581999

# c# - 通过引用或变通方法存储对象

> ID：15581000
> 
> 赞同：2
> 
> 时间：2013-03-22T22:41:42.993
> 
> 标签：c#

我正在为 C# 中的游戏构建内部逻辑，并且来自 C++，这对我来说可能会在翻译中丢失。

我有一个对象，Ability，它计算它提供的奖金并将其作为整数值返回。计算是动态的，可以根据各种变量而改变。

```
 public class Ability: Buffable
    {

        public string abbr { get; private set; }

        public Ability(string name, string abbr, uint score) : base(name, score)
        {
            this.abbr = abbr;
        }

        // Ability Modifier
        // returns the ability modifier for the class.
        public int Ability_modifier()
        {
            const double ARBITARY_MINUS_TEN = -10;
            const double HALVE = 2;
            double value = (double)this.Evaluate();
            double result = (value + ARBITARY_MINUS_TEN) / HALVE;

            // Round down in case of odd negative modifier
            if (result < 0 && ((value % 2) != 0))
            {
                result--;
            }
            return (int)result;
        } 
```

然后我有另一个对象，技能，它应该知道该奖金并将其添加到它的计算中。我想通过引用将能力传递给技能的构造函数，然后存储该引用，以便如果能力改变了计算也可以。明显的问题是显然存储引用是 C# 中的禁忌。

是否有一种解决方法可以解决这个问题，或者有另一种方法来解决我的指针感染的大脑没有考虑的这个问题？我非常希望不必每次都将能力传递给评估技能的函数，因为引用的函数在构造后永远不会改变。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T22:45:37.707

> 明显的问题是显然存储引用是 C# 中的禁忌。

绝对不。引用存储在各处。你在这里做，例如：

```
this.abbr = abbr; 
```

`System.String`是一个类，因此是一个引用类型。所以价值`abbr`是一个参考。

我强烈怀疑您误解了引用类型在 C# 中的工作方式。如果您记得对对象的*引用*，那么对对象的更改将通过引用可见。但是，不会对*您复制的原始表达式*进行更改。

例如，`StringBuilder`用作方便的可变引用类型：

```
StringBuilder x = new StringBuilder("abc");

// Copy the reference...
StringBuilder y = x;

// This changes data within the object that x's value refers to
x.Append("def");

// This changes the value of x to refer to a different StringBuilder
x = new StringBuilder("ghi");

Console.WriteLine(y); // abcdef 
```

有关更多详细信息，请参阅我关于[引用和值](http://pobox.com/~skeet/csharp/references.html)以及[C# 中的参数传递的文章。](http://pobox.com/~skeet/csharp/parameters.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T22:46:00.567

我没有看到足够多的代码来给出一个具体的例子，但是这样做的方法是传入一个 lambda 委托，例如`() => object.property`而不是 this: `object.property`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-22T22:45:11.240

在 C# 中，有引用类型和值类型。所有非值类型的对象都是通过引用传递的，所以引用应该没有问题。只需传递它，它将通过引用传递。

# mysql - MySQL 字段在更新时设置为 0

> ID：15581001
> 
> 赞同：0
> 
> 时间：2013-03-22T22:41:52.847
> 
> 标签：mysql

有没有办法在不使用 PHP 或在我的查询中明确包含该行更新时将字段设置为 0？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T22:47:34.467

`= 0`您可以在定义表格时设置默认值。

从[CREATE TABLE 语法](http://dev.mysql.com/doc/refman/5.1/en/create-table.html)：

```
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] tbl_name
   .../...
column_definition:
    data_type [NOT NULL | NULL] [DEFAULT default_value] 
```

比方说

```
CREATE TABLE test (
a INT,
b INT DEFAULT 0); 
```

如果我们这样做

```
INSERT INTO test (a) values (1),(2),(3); 
```

那么当我们

```
SELECT * FROM test 
```

我们将得到

```
a  |  b
1     0
2     0
3     0 
```

看到它在[SQL Fiddle上工作](http://www.sqlfiddle.com/#!2/05e83/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T22:52:49.960

使用触发器：

```
CREATE TRIGGER set_zero AFTER UPDATE ON table_name
   FOR EACH ROW
      UPDATE table_name SET col_name=0 WHERE xyz=cond_xyz;
; 
```

没有测试它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T22:50:53.170

起初这对我来说似乎是一个奇怪的要求，但实际上在 MySQL 中是可能的。如果您指定该字段的默认值，您可以利用对未指定但现有的列使用默认值`0`这一事实。`REPLACE INTO`

```
INSERT INTO t1 (id, numToZero, value) VALUES (1, 1345, 'value'); 
```

稍后，当您要更新时：

```
REPLACE INTO t1 (id, value) VALUES (1, 'new value'); 
```

这将`(1, 0, 'new value')`在不创建新行的情况下产生。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-03T09:57:48.877

触发器是正确的方法，但塞巴斯蒂安完全错了。

您不会`UPDATE`在触发器内运行，只需将值分配给`new`传递给触发器的记录。此外，它*必须*是一个触发器（因为在**AFTER**触发器中对记录`BEFORE UPDATE`的更改不会被持久化）。`new`

 **```
CREATE TRIGGER set_zero 
  BEFORE UPDATE ON table_name
  FOR EACH ROW
BEGIN
  SET new.col_name = 0; 
END; 
```

请注意，即使定义了默认值，您仍然可以在*插入*期间提供非零值。如果你也不想这样，你还需要一个插入触发器

这是一个 SQLFiddle 示例：[http ://sqlfiddle.com/#!2/cebe82/1](http://sqlfiddle.com/#!2/cebe82/1)**

# php - jQuery在javascript中序列化

> ID：15581002
> 
> 赞同：3
> 
> 时间：2013-03-22T22:42:00.490
> 
> 标签：php, javascript, jquery, html, string

我想知道 javascript 中是否有一些东西可以做与 .serialize() 相同的工作。我需要使用它`someform.onsubmit = funct...`或`<form onsubmit="...`. 我只需要将该表单中的所有数据（就像 jQuery 一样）作为字符串获取。

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:21:28.107

我认为最接近的方法是使用[`FormData`](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest/FormData). 就像是：

```
document.querySelector('form').addEventListener('submit', function (e) {
    e.preventDefault();

    xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
            console.log(xhr.responseText);
        }
    }
    xhr.open("POST", "/echo/json");
    xhr.send(new FormData(this));
}); 
```

这可以说比调用`.serialize`表单集合更简单，但请注意，您显然无法检查`FormData`对象内部的内容。这也是相对较新的，所以跨浏览器不兼容。

# javascript - 使用 Javascript DOM 添加事件监听器

> ID：15581004
> 
> 赞同：4
> 
> 时间：2013-03-22T22:42:04.230
> 
> 标签：javascript, addeventlistener

我无法通过 javascript 添加 eventListener。好的，我有一个创建 4 个锚元素的函数。我想在 onmouseover 上向他们添加一个事件，该事件调用一个函数来更改他们的背景颜色。这是代码（查看 createAnchor() 的倒数第二行以找到相关的代码行。

```
function createAanchor(index) { 
            var a = document.createElement("a");
            var text = getText(index);
            var a = document.createElement("a");
            var t = document.createTextNode(text);
            a.href = getHref(index);
            a.appendChild(t);
            a.style.textAlign = "center";
            a.style.fontSize = "1.2em";
            a.style.color = "white";
            a.style.fontFamily = "arial";
            a.style.fontWeight = "bold";
            a.style.textDecoration = "none";
            a.style.lineHeight = "238px";
            a.style.width = "238px";
            a.style.margin = "5px";
            a.style.background = eightColors(index);
            a.style.position = "absolute";
            a.addEventListener("onmouseover", changeColor());
            return a;
    }

    function changeColor() {
        alert("EVENT WORKING");
    } 
```

好的，这就是问题所在。当函数到达`a.addEventListener("onmouseover", changeColor());`执行`function changeColors()`时，但稍后没有执行`onmouseover`这是为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T22:44:04.440

1.  没有这样`onmouseover`的事件，事件被称为`mouseover`。
2.  您必须将函数引用传递给`addEventlistener`. `()`正如您已经注意到的那样，调用该函数，所以...不要调用它。

应该是这样的：

```
a.addEventListener("mouseover", changeColor); 
```

我推荐阅读quirksmode.org 上[关于事件处理的优秀文章。](http://www.quirksmode.org/js/introevents.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-22T22:43:40.237

这是因为你写的`changeColors()`而不是仅仅`changeColors`. `()`告诉 JavaScript 调用该函数。

也就是说，`changeColors`by本身是对函数的引用，while`changeColors()`是引用函数*然后调用它*。函数调用的结果（函数的返回值）是最终传递给`addEventListener()`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T07:33:18.403

好的，我认为我们需要了解何时在事件类型中使用前缀“on”。在 IE 8 或更低版本的 IE8 中，我们使用 attachEvent 和 detachEvent，它们等效于 addEventListener 和 removeEventListener。这个问题不需要一些差异。

使用 attachEvent 时，事件类型以“on”为前缀，但在 addEventListener 中不使用前缀。

因此，

```
 elem.attachEvent("onclick",listener); // <= IE8

    elem.addEventListener("click",listener,[,useCapture]); // other browsers 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-01T17:05:09.140

我也需要做类似的事情。我的地图中有一个 infoWindow，我需要处理该 infoWindow 中段落的点击事件。所以我这样做了：

```
google.maps.event.addListener(infoWindow, 'domready', function() 
     {
        paragraph = document.getElementById("idOfThatParagraph");
        paragraph.addEventListener("click", function()
        {
          //actions that I need to do
        });
    }); 
```

这个对我有用。所以我希望它会帮助某人:)

# mysql - 在 SELECT 语句中设置变量 - MySQL

> ID：15581005
> 
> 赞同：10
> 
> 时间：2013-03-22T22:42:14.497
> 
> 标签：mysql, variables, concatenation, variable-assignment

我正在使用这个有错误的代码：

```
SET @rejects = '';

SELECT *
FROM list
WHERE maker = 1
    AND by_ids IN ('10','11')
    AND country LIKE '%I%'
    AND (
        src IS NULL
        || src NOT IN (@rejects)
        AND checkSrc(src) = 'yes'
        AND SET @rejects = CONCAT(@rejects,',',src)
    ); 
```

是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2015-04-01T13:16:45.920

问题是你不能混用`select`，`set`在一个语句中，肯定会有语法错误：

```
select*from t where 1 and set@a=1; 
```

> ^(ERROR 1064 (42000)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'set@a=1' 附近使用正确的语法)

如果要在`set`范围内执行`select`，请使用[冒号等于](https://dev.mysql.com/doc/refman/5.7/en/assignment-operators.html#operator_assign-value)语法。改变这个：

```
select*from t where 1 and set@a=1; 
```

进入：

```
select*,@a:=1 from t where 1; 
```

**以下是在每一**行更新变量的方法：

```
create table t(id int); insert t values(1),(2),(3);
set@a=0;
select@a:=id from t; 
```

> ```
> +--------+
> | @a:=id |
> +--------+
> |      1 |
> |      2 |
> |      3 |
> +--------+ 
> ```

你甚至可以这样做`concat`：

```
set@a='0';
select @a:=concat(@a,',',id)from t; 
```

> ```
> +-----------------------+
> | @a:=concat(@a,',',id) |
> +-----------------------+
> | 0,1                   |
> | 0,1,2                 |
> | 0,1,2,3               |
> +-----------------------+ 
> ```

或者`concat`没有前导`0`：

```
set@a='';
select @a:=concat(@a,if(@a='','',','),id)from t; 
```

> ```
> +------------------------------------+
> | @a:=concat(@a,if(@a='','',','),id) |
> +------------------------------------+
> | 1                                  |
> | 1,2                                |
> | 1,2,3                              |
> +------------------------------------+ 
> ```

但是，该手册**明确**指出这是危险的：[![关联](../Images/6fa71948b19cde1a3b181a7c298ac485.png)](http://dev.mysql.com/doc/refman/5.7/en/user-variables.html)

> ...您**永远**不应为用户变量赋值并在同一语句中读取该值...
> 
> ...您可能会得到您期望的结果，但这**不能保证**。
> 
> ...涉及用户变量的表达式的求值顺序是 **undefined**。

[Xaprb](http://www.xaprb.com/blog/2006/12/02/how-to-number-rows-in-mysql/#playing-with-fire)上也提到了这一点。

最后，如果您正在做一些*古怪*的事情，例如为变量分配不同的值类型等，请查看[手册](http://dev.mysql.com/doc/refman/5.7/en/user-variables.html)以确保您了解复杂的机制。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T22:50:26.153

然后你可以这样写你的查询。

```
SET @rejects = '';
SELECT @rejects = CONCAT(@rejects,',',src) FROM list WHERE maker = 1 AND by_ids IN ('10','11') AND country LIKE '%I%' AND 
(src IS NULL OR src NOT IN (@rejects) AND checkSrc(src) = 'yes');
SELECT @rejects; 
```

# css - HTML5 中的 class* 是什么意思

> ID：15581006
> 
> 赞同：2
> 
> 时间：2013-03-22T22:42:18.170
> 
> 标签：css, html, twitter-bootstrap

在 Twitter Bootstrap 中有以下 CSS 类选择器：

```
.show-grid [class*="span"] {
    margin-bottom: 5px;
} 
```

这适用`margin-bottom: 5px`于之后的任何`span`课程`show-grid`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T22:45:43.597

CSS3 规范：[选择器级别 3](http://www.w3.org/TR/selectors/#attribute-selectors)

> `[att*=val]`
> 
> 表示具有 att 属性的元素，其值包含至少一个子字符串“val”的实例。如果 "val" 是空字符串，则选择器不代表任何内容。

根据你的问题：

> 这是否意味着在 show-grid 之后将 margin-bottom:5px 应用于任何跨度类？

**不**，它适用`margin-bottom: 5px`于标记为 class 的任何元素的后代`show-grid`以及哪个 class 包含的每个元素`span`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-22T22:45:35.133

`[attr*=value]`是子字符串[属性选择器](http://www.w3.org/TR/selectors/#attribute-selectors)- 它在 CSS 3 中是新的，在 IE 7+ 中受支持

您发布的内容将为具有*包含*子字符串的类`span`并且也是具有该类的元素的后代的元素添加 5px 的底部边距`.show-grid`

# html - 从网络导入逗号分隔的数字到 excel

> ID：15581009
> 
> 赞同：0
> 
> 时间：2013-03-22T22:42:24.600
> 
> 标签：html, asp.net-mvc, excel

我正在尝试在 Excel 的单元格中导入逗号分隔的数字。它在网络上看起来像这样：

```
000002678,000002737,000002827,000004326,000008528 
```

但是，一旦我将其导入到 excel 中，它就会转换为以下内容：

```
2,678,000,002,737,000,000,000,000,000,000,000,000,000 
```

我怎样才能像在网络上一样保持格式而不是将其视为一个大数字？

```
With ActiveSheet.QueryTables.Add(Connection:= _
    "URL;http://localhost:65076/TestData", Destination:=Range( _
    "$A$1"))
    .Name = "Test"
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = True
    .RefreshOnFileOpen = False
    .BackgroundQuery = True
    .RefreshStyle = xlInsertDeleteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = True
    .RefreshPeriod = 0
    .WebSelectionType = xlAllTables
    .WebFormatting = xlWebFormattingNone
    .WebPreFormattedTextToColumns = True
    .WebConsecutiveDelimitersAsOne = True
    .WebSingleBlockTextImport = False
    .WebDisableDateRecognition = False
    .WebDisableRedirections = False
    .Refresh BackgroundQuery:=False
End With 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-02T13:03:42.557

@PeterL 或 user793468 你解决过这个问题吗？因为我有完全相同的问题，我找到的唯一解决方案是一种解决方法（实际上可以工作！）

设置 Windows 区域和语言设置：“十进制设置”从 、 到 。并且 excel 不会将我的案例 016448,016501,017612,01... 等视为一个长数字。

如果您计划“自动”运行脚本，那么只需将这些设置放在运行脚本的虚拟机中即可。

# html - 将此数据存储在数据存储谷歌应用引擎中的最佳方式

> ID：15581011
> 
> 赞同：0
> 
> 时间：2013-03-22T22:42:25.987
> 
> 标签：html, database, json, google-app-engine, webapp2

我正在尝试为我大学的布告栏制作一个电话应用程序。

这是[布告栏](http://intranet.iiit-bh.ac.in/)。并且每个通知都作为一个[HTML 页面](http://hib.ximb.ac.in/Hibiscus/Pub/nbDocDet.php?docid=3685&client=iiit)。通知的 URL 结构很简单，“docid”给出了每个通知的 ID。据我从模式中猜到它是一个自动递增键。

到目前为止，我的策略是通过增加 docid 值从 get 请求中获取 HTML 文件。解析 html 以获得所需的值，例如 Title、Posted by、Attention、Date 和 body。

最初将现有通知存储到数据存储中，然后 cron 作业可以检查新通知。

这些值集将作为 JSON 提供给手机应用程序。

通知的正文部分使用 HTML 标记进行格式化。我想保留格式。我只是将正文存储为包含所有 html 标记的字符串。这可能是一个问题吗？有没有更好的方法来保留格式？

我必须这样做，因为我无法预先知道完成了哪种格式

# powershell - 如何使用 Powershell 呈现可点击的链接

> ID：15581012
> 
> 赞同：5
> 
> 时间：2013-03-22T22:42:30.770
> 
> 标签：powershell, powershell-2.0, powershell-ise

我正在使用下面的 powershell 脚本将输出写入 html 文件，问题是将所有内容呈现为文本。

我的代码：

```
$PagesObject = New-Object PSObject
Add-Member -input $PagesObject noteproperty 'Site Url' $spweb.url
Add-Member -input $PagesObject noteproperty 'Page Title' $PageTitle
Add-Member -input $PagesObject noteproperty 'Page Url' "<a href="$PagesUrl">$PageTitle</a>"     
$results += $PagesObject
$results | ConvertTo-HTML -head  $a  -body | Out-File \\myfolder\InventoryReports\$CurrentMonth.html 
```

我想将其呈现为可点击的链接

检查下面的屏幕截图，看看它现在是如何渲染的 ![在此处输入图像描述](../Images/31ad9fefcea15abaa43af18666162aa7.png)

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T12:45:34.513

PowerShell 对特殊字符进行编码。解决此问题的一种方法是将它们转换回来，然后将结果写入文件：

```
$pso = New-Object PSObject -Property @{
    SiteUrl = $spweb.url
    PageTitle= $PageTitle
    PageUrl = "<a href='$PagesUrl'>$PageTitle</a>"  
} | ConvertTo-Html

$pso -replace '&gt;','>' -replace '&lt;','<' -replace '&#39;',"'" | 
Out-File \\myfolder\InventoryReports\$CurrentMonth.html 
```

更新：

这是一种处理所有 html 实体的更好方法：

```
Add-Type -AssemblyName System.Web
[System.Web.HttpUtility]::HtmlDecode($pso) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-29T13:54:13.720

IE

```
$pso = New-Object PSObject -Property @{
    SiteUrl = $spweb.url
    PageTitle= $PageTitle
    PageUrl = "<a href='$PagesUrl'>$PageTitle</a>"  
} | ConvertTo-Html

Add-Type -AssemblyName System.Web

[System.Web.HttpUtility]::HtmlDecode($pso) | 
Out-File \\myfolder\InventoryReports\$CurrentMonth.html 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-22T14:05:03.807

除了使用 Html::Decode 或 RegExps 之外，还有一种更通用的方法可以做到这一点。它要复杂得多，但它可能很有用，当除了链接列之外，某些列包含特殊的 HTML 字符，不应该像链接一样处理（例如 $PageTitle 有类似“foo<bar”的东西，什么会破坏标记使用 Html::Decode 后）。

这种方法使用 ConvertTo-Html 生成有效 XHTML 的事实，可以在 Powershell/.Net XML 工具中使用。主要思想是将 cmdlet 输出转换为 XML 文档，然后使用 XPath 检索链接列并修改它们以使用 DOM 函数创建链接。

这是代码片段：

```
$pso = New-Object PSObject -Property @{
    SiteUrl = 'foobar.org'
    PageTitle = 'x&z a<b<c'
    PageUrl = 'foobar.org/contact.html'
} | ConvertTo-Html

$xmlDoc = [xml]$pso
$xhtmlNS = 'http://www.w3.org/1999/xhtml'
$xmlNSManager = New-Object System.Xml.XmlNamespaceManager $xmlDoc.NameTable
$xmlNSManager.AddNamespace('x', $xhtmlNS)
$xmlDoc.SelectNodes('//x:table/x:tr/x:td[3]', $xmlNSManager) | %{
    $a = $xmlDoc.CreateElement('a', $xhtmlNS)
    $a.setAttribute('href', $_.'#text')
    [void]$a.AppendChild($xmlDoc.CreateTextNode('Contact Us'))
    [void]$_.ReplaceChild($a, $_.FirstChild)
}

$xmlDoc.OuterXml | Out-File 'test.html' 
```

检索第 n 列单元格的 XPath 字符串是 '//x:table/x:tr/x:td[n]'，其中 n - 是列数（索引从 1 开始）。可以在此处找到有关使用 XML 命名空间（例如 XmlNamespaceManager 和时髦的 'x:' 前缀）的一些说明：[Xml 命名空间破坏了我的 xpath！](https://stackoverflow.com/questions/5239685)

要一次修改多个列，可以使用以下 XPath：'//x:table/x:tr/x:td[position()=1 or position()=2 or ... or position()=last( )]'

```
foreach ($td in $xmlDoc.SelectNodes('//x:table/x:tr/x:td[position()=1 or position()=2 or ... or position()=last()]', $xmlNSManager)) {
    # processing first column cells
    [void]$foreach.MoveNext()
    # processing second column cells
    [void]$foreach.MoveNext()
    # etc
} 
```

# javascript - Jquery mouseenter 在加载时触发

> ID：15581017
> 
> 赞同：1
> 
> 时间：2013-03-22T22:42:58.450
> 
> 标签：javascript, jquery

当我将鼠标悬停在对象上时，我希望触发一个事件。当我尝试使用 jquery 的 mouseuner 或 mouseover 时，该事件在页面加载时触发一次，当我将鼠标悬停在图像或图像框上时不会触发

我的代码如下。我真的不明白发生了什么。谢谢你。

```
<!DOCTYPE html>
<html>
    <head>
        <script src="jquery-1.9.1.min.js">
        </script>
        <script>
            var img = '';
            var offset_const = 0.03;

            var timer = '';

            $(document).ready(function(){

            function init(obj, image, psize){
                var height = obj.height();
                //obj.height(1000);
                var imageId = 'vtourImg';

                img = $('<img id="'+ imageId +'">');
                img.attr('src', image);
                img.attr('height', height);
                obj.append(img);

                //$(obj).mouseenter(function(e){setInterval(function(e){scroller(e);}, 1000);});
            }

            function scroller(e){
                //setTimeout(scroller(e), 10000);
                var x = e.pageX - this.offsetLeft;
                var y = e.pageY - this.offsetTop;
                var midX = $(this).width() / 2;

                var current_offsetX = img.offset().left;
                var offsetX_add = offset_const * -1 * (x - midX);
                var offsetX = 0;

                offsetX = current_offsetX + offsetX_add;

                img.offset({left: offsetX });
            }

                init($('#vtour'), 'virtualtour4.jpg', 0.00);
                img.mouseenter(alert('test'));
            });
        </script>
    </head>

    <body>
        <div id="vtour" style="width:500px;height:500px;border:3px black solid;overflow:hidden;"></div>
    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T22:46:28.550

您需要将一个函数传递给该`mouseenter`方法：

```
img.mouseenter(function(){alert('test')}); 
```

现在匿名函数将在您输入后立即执行。正如您所拥有的，您`alert('test')`在页面加载时执行，但从未将任何函数传递给事件处理程序。

# c# - Windows 8 C# 在 Frame.Navigate 上保存 ScrollerViewer 状态

> ID：15581024
> 
> 赞同：0
> 
> 时间：2013-03-22T22:43:40.777
> 
> 标签：c#, windows-8, scrollviewer

我需要保存 ScrollViewer 的位置，以便当我导航到页面并点击后退箭头时，它仍将位于原来的位置。

我在用着：

```
protected override void LoadState(Object navigationParameter, Dictionary<String, Object> pageState)
        {
            base.LoadState(navigationParameter, pageState);
            if (pageState != null && pageState.ContainsKey("ScrollerPosition"))
            {
                mainScrollViewer.ScrollToHorizontalOffset((double) pageState["ScrollerPosition"]);
            }
        } 
```

和

```
protected override void SaveState(Dictionary<String, Object> pageState)
        {
            base.SaveState(pageState);
            pageState["ScrollerPosition"] = mainScrollViewer.HorizontalOffset;
        } 
```

但它并没有恢复它所处的状态。我究竟做错了什么？（我对 Windows 8 很陌生！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-08T20:48:23.637

恢复滚动查看器的位置在 Loaded 事件中。在您的构造函数中添加一个处理程序：

```
scrollViewer.Loaded += (sv,event) => ScrollViewerLoaded(sv, event); 
```

（或者通过 XAML）

保存状态，就像你在`SaveState()`. 按原样加载值`LoadState()`，而不是立即使用该值缓存它，直到您到达该 Loaded 事件：

```
void ScrollViewerLoaded(Object sender, RoutedEventArgs event)
{
    mainScrollViewer.ScrollToHorizontalOffset(cachedScrollPosition);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:52:55.187

问题*可能*是`LoadState`在加载任何数据之前调用。如果是这种情况，则没有可滚动的内容，因此您的`ScrollToHorizontalOffset`呼叫无效。

您没有关于如何加载数据的任何详细信息，因此我无法提出具体建议。但是，一般的解决方案是确保在调用设置滚动位置之前加载所有数据。

# flash - 关于道路设置

> ID：15581033
> 
> 赞同：0
> 
> 时间：2013-03-22T22:44:49.237
> 
> 标签：flash, actionscript-2

我创建了一个 Flash as2 汽车游戏，其中汽车始终放置在屏幕中央，并且行驶车道正在移动。我的车道大约比舞台大 50 倍。因此，我会（在这样做之前）问你，如果我将车道分成较小的方块/瓷砖，只在它们出现在舞台视图时显示瓷砖，是否会提高游戏性能？

干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T14:44:08.440

这是我将使用的方法——它是从旧的 8 位游戏中借来的用于性能的方法。

而不是拿你的剪辑是舞台的 50 倍，只是打开和关闭它的片段，你会做的是想出更小的瓷砖，并根据舞台的宽度使用尽可能多的瓷砖，再加上也许后缘上的一两列额外的列。更宽的瓷砖将是更少的瓷砖移动。

现在您可以通过脚本将它们全部移动；如果您的游戏已经在运行主循环或 onEnterFrame，您可以设置一个控制道路移动的子功能，并有一个循环移动每个瓷砖以改变 x 坐标（您的速度）。一旦它们离开舞台的可见边缘，您就可以将它们弹到准备进入的舞台的另一个边缘，让它们继续滑到一边。

另外：如果您使用矢量图，请尝试确保“cacheAsBitmap”属性设置为 true - 或者选中属性面板中舞台对象的框。这也可能会提高你的表现。

# asp.net-mvc - 自定义 400 消息被覆盖

> ID：15581034
> 
> 赞同：0
> 
> 时间：2013-03-22T22:44:50.830
> 
> 标签：asp.net-mvc, asp.net-mvc-4, iis-7

我有一些我想向用户显示的自定义错误消息。因此，当他们说输入错误的用户名/密码组合时，我可能会在我的代码中这样做：

```
Response.StatusCode = 400;
return Json("Invalid username or password"); 
```

这在我的本地机器上运行良好。我一直在部署到一个网络主机，这些消息被服务器覆盖，所以它们都显示为：

> 由于发生内部服务器错误，无法显示该页面。

服务器显然是在试图保护我免于泄露有关出了什么问题的敏感信息，但我确实希望这个错误能够通过并被用户看到（真的，由我的代码解析然后显示）。

我认为 web.config 中有一些东西可以让我完成这项工作，但到目前为止我尝试过的一切都没有奏效。有任何想法吗？

我现在拥有的 web.config 的相关部分：

```
<system.webServer>
    <httpErrors errorMode="Custom" existingResponse="PassThrough">
    </httpErrors>
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true"/>
    etc. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T05:14:05.080

默认情况下，一些 HTTP 状态代码被 IIS 隐藏并被它替换。但是，可以使用以下行进行配置：

```
 <system.webServer>
    <httpErrors errorMode="Detailed"/> 
```

这将允许您在响应中传递您的自定义消息，并在 AJAX 调用完成时在客户端读取它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:21:09.183

为了处理每个 Http 错误代码，您需要在 web.config 文件中添加特定的映射

```
 <customErrors mode="On/RemoteOnly" >
      <error statusCode="400" redirect="My400View" />
      <error statusCode="404" redirect="My404iew" />
      <error statusCode="500" redirect="My500View" />
    </customErrors> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T15:31:54.007

最终的解决方案是从 web.config 中完全删除 < httpErrors > 元素。即使将其设置为此处看到的默认选项[http://www.iis.net/configreference/system.webserver/httperrors](http://www.iis.net/configreference/system.webserver/httperrors)也不起作用，所以我有点困惑为什么删除它会起作用。

```
<system.webServer>
    **Remove <httpErrors> !**
    <validation validateIntegratedModeConfiguration="false"/>
    <modules runAllManagedModulesForAllRequests="true"/> 
```

# c - 链式赋值和隐式转换的优先级

> ID：15581037
> 
> 赞同：-3
> 
> 时间：2013-03-22T22:44:56.537
> 
> 标签：c

我有一个简单而愚蠢的代码片段要分析。本质上，它执行以下操作：

```
a = b = c; 
```

但是类型非常棘手。
在一个地方我有：

```
int a,c;
unsigned int b; 
```

在另一个地方我有：

```
int a;
unsigned int b,c; 
```

如果编译器解释 a = b，那么我将 unsigned int 转换为 int
OK，在 2-complement 上，无论如何，这样的转换是空操作
但是这样的转换可能会溢出，这将是 UB，对吗？
在这种情况下，编译器有权假定我不依赖 UB，因此最终可以无条件地考虑 a>=0 并消除进一步的测试`if(a<0) blah...`，这仍然是正确的吗？

在这种情况下，两段代码都会导致相同的行为。

如果编译器解释`a = c`并且我认为这就是它所做的，并且如果我上面的 UB 分析是正确的，那么这两段代码可能会给出不同的结果。

那么如何解释这些表达式`a=b`or `a=c`，或者换句话说，在哪种情况下可以`(a<0)`消除这样的分支，只有一个，两个或一个都没有？

最后一点，我的确切情况是内联函数中的返回值，但我认为它不会改变上述结论，对吧？

```
static inline int a1(unsigned int *b,unsigned int c) {return *b=c;}
static inline int a2(unsigned int *b,int c) {return *b=c;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T22:47:26.770

```
a = b = c; 
```

和

```
a = (b = c); 
```

这在你的两个例子中是有效的。

*但是这样的演员可以溢出，这将是UB，对吗？*

没有强制转换，而是从一种类型到另一种类型的隐式转换。将类型的值转换为`unsigned int`时`int`，如果该`unsigned int`值在 中不可表示`int`，则转换的结果要么是实现定义的，要么是引发实现定义的行为信号。严格来说，这仍然不是溢出，也不是未定义的行为。

# css - prestashop中的中心页脚

> ID：15581043
> 
> 赞同：-1
> 
> 时间：2013-03-22T22:45:19.237
> 
> 标签：css, footer, prestashop

我正在为我的客户修改主题，但遇到了一个小问题。

我无法将页脚居中。

问题是，如何将 div 添加到页脚作为我将使用 CSS 居中的容器？我应该创建一个新的钩子还是有解决方法？

谢谢，

这是网址：[链接到商店](http://growmundocannabico.com/es/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:09:05.020

您必须将页脚的内容包装在另一个具有固定宽度的容器中，并将边距设置为`0 auto`. 像这样的东西：

```
<div id="footer">
    <div id="some_container">
          <!-- current content in footer -->
    </div>
</div> 
```

然后在 CSS 中设置

```
#some_container {width: 980px; margin: 0 auto;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T09:12:38.157

你可以轻松做到。没有必要为它创建一个新的钩子。如果您需要一个模块，如果该部分的内容是动态的，您可以创建一个模块。但简单的方法是

1）打开页脚文件，即**themes/your_ps_theme_name_folder/footer.tpl**

2）在那里你会发现页脚部分以及页脚钩。按照 Miljan Puzović 的说明放置 div 容器，并将 css to global.css 文件放置在主题的 css 文件夹中。

这是最简单的方法。希望这会有所帮助

# forms - 如何使 ExpressionEngine 中的输入字段成为必需？

> ID：15581050
> 
> 赞同：0
> 
> 时间：2013-03-22T22:45:46.213
> 
> 标签：forms, validation, expressionengine

我发现许多文章/教程/操作方法说明您应该添加`name="required"`or `name="required[]"`，但是当自定义表单中的所有输入字段都具有作为表单功能一部分的显式名称时，您会怎么做？（我尝试将名称更改为 required，希望预先存在的名称是装饰性的，并且表单停止工作。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T20:59:14.003

如果您的意思是使用 Safecracker 的前端输入表单，则有相当多的有关表单验证的文档 - 它可以是针对字段要求的验证（以及针对 CodeIgniter 类的其他验证），或者您可以使用 jquery 进行客户端验证，这通常只涉及加载验证插件并向每个必需的表单元素添加一个 required 类（通常不更改名称）。

# jquery - 如何使用 jquery 将文本添加到现有的 div

> ID：15581059
> 
> 赞同：59
> 
> 时间：2013-03-22T22:46:22.807
> 
> 标签：jquery, html, text, add

当我单击 ID 为 #add 的按钮时，我想向现有 div 添加文本。但这不起作用。

这是我的代码：

```
$(function () {
  $('#Add').click(function () {
    $('<p>Text</p>').appendTo('#Content');
  });
}); 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
 <div id="Content">
    <button id="Add">Add</button>
 </div>
```

我希望你能帮助我。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-03-22T22:51:26.193

您需要定义按钮文本并为该按钮提供有效的 HTML。我还建议使用`.on`按钮的点击处理程序

```
$(function () {
  $('#Add').on('click', function () {
    $('<p>Text</p>').appendTo('#Content');
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<div id="Content">
    <button id="Add">Add Text</button>
</div>
```

此外，我会确保 jquery 位于页面底部，就在结束`</body>`标记之前。这样做会让你不必把整个东西都包起来，`$(function`但我仍然会这样做。在页面末尾加载您的 javascript 可以使页面的其余部分加载，以防您的 javascript 在某处变慢。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-22T22:51:22.270

运行示例：

```
//If you want add the element before the actual content, use before()
$(function () {
  $('#AddBefore').click(function () {
    $('#Content').before('<p>Text before the button</p>');
  });
});

//If you want add the element after the actual content, use after()
$(function () {
  $('#AddAfter').click(function () {
    $('#Content').after('<p>Text after the button</p>');
  });
});
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>

<div id="Content">
<button id="AddBefore">Add before</button>
<button id="AddAfter">Add after</button>
</div>
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-22T22:49:19.077

您的 html 无效`button`不是空标记。尝试

```
<div id="Content">
   <button id="Add">Add</button>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-25T10:56:23.340

我们可以用更简单的方法来做到这一点，比如在按钮上添加一个函数，然后在单击时调用该函数进行追加。

```
<div id="Content">
<button id="Add" onclick="append();">Add Text</button>
</div> 
<script type="text/javascript">
function append()
{
$('<p>Text</p>').appendTo('#Content');
}
</script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-27T17:24:08.683

从我这边很容易：-

```
<html>
<head>
<script
    src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script>
    $(document).ready(function() {
        $("input").click(function() {
            $('<input type="text" name="name" value="value"/>').appendTo('#testdiv');
        });

    });
</script>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Insert title here</title>
</head>
<body>
    <div id="testdiv"></div>
    <input type="button" value="Add" />
</body>
</html> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-08T10:24:31.017

```
$(function () {
  $('#Add').click(function () {
    $('<p>Text</p>').appendTo('#Content');
  });
}); 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
 <div id="Content">
    <button id="Add">Add<button>
 </div>
```

# java - 表单处理得到空指针异常？

> ID：15581060
> 
> 赞同：-1
> 
> 时间：2013-03-22T22:46:24.307
> 
> 标签：java, google-app-engine, jsp, servlets

我想用jsp处理这个表单字段：

```
<div class="control-group">

                                                <!-- Text input-->
                                                <label class="control-label" for="input01">Email:</label>
                                                <div class="controls">
                                                    <input name="email" placeholder="email"
                                                        class="input-xlarge" type="text"
                                                        value="<%=request.getParameter("email")%>">
                                                </div>
                                            </div>
                                            <div class="control-group">
                                                <!-- Text input-->
                                                <label class="control-label" for="input01">Password:</label>
                                                <div class="controls">
                                                    <input name="password" placeholder="password"
                                                        class="input-xlarge" type="text"
                                                        value="<%=request.getParameter("password")%>">
                                                </div>
                                            </div> 
```

当我按下提交时，我得到一个

> 空指针异常

这就是我的servlet方法：

```
@Override
    public void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        logger.log(Level.INFO, "Creating User!!!");
        logger.info("Request: " +  req.toString());
        PrintWriter out = resp.getWriter();//Here I get the null Pointer exception

        String email = req.getParameter("email");
        String password = req.getParameter("password");
        logger.info(email + password);
        try {
            user.insert(email, password);
            Log.info("Inserted: " + email + "    " + password);
        } catch (Exception e) {
            String msg = DAOUser.getErrorMessage(e);
            out.print(msg);
        }
    } 
```

.

如何修复这个空指针异常？

**更新**

我的小服务程序：

```
public class DAOServletUser extends HttpServlet {

    private static final long serialVersionUID = 6820994892755862282L;

    private static final Logger logger = Logger.getLogger(DAOServletUser.class.getCanonicalName());
    /**
     * Get the entities in JSON format.
     */

    public DAOServletUser() {
        super();
    }

    public IDAOUser user;

    /**
     * Create the entity and persist it.
     */
    @Override
    public void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        logger.log(Level.INFO, "Creating User!!!");
        logger.info("Request: " +  req.toString());

        if(resp==null) {
            System.out.println("Respond is NULL!!!");
        }

        PrintWriter out = resp.getWriter();//Here I get the null Pointer exception

        String email = req.getParameter("email");

        if(email==null) {
            System.out.println("email is null");
        } else {
            System.out.println("email is NOT null");
        }
        String password = req.getParameter("password");
        if(password==null) {
            System.out.println("password is null");
        } else {
            System.out.println("password is NOT null");
        }
        logger.info(email + "::" + password);
        try {
            user.insert(email, password);
            Log.info("Inserted: " + email + "    " + password);
        } catch (Exception e) {
            String msg = DAOUser.getErrorMessage(e);
            out.print(msg);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:25:50.580

我假设`IDAOUser`是一个接口。要在 Java 中实现接口，您可以`implements`在类级别使用关键字，如下所示：

```
public class DaoUserImpl implements IDAOUser {
    public void insert(String email, String password) {
        // your code for inserting goes here
    }
} 
```

在您的 servlet 类中，而不是

```
public IDAOUser user; 
```

像这样实例化它（使用`new`关键字）

```
public IDAOUser user = new DaoUserImpl(); 
```

然后，您可以调用`user.insert(email,password)`不是`null`.

但是，如果 DaoUserImpl 使用共享实例数据，则必须小心此解决方案可能出现的多线程问题。您可能希望每个请求都有一个类实例。

# objective-c - OBJ C - 如何从发件人那里获取文本字段名称

> ID：15581064
> 
> 赞同：1
> 
> 时间：2013-03-22T22:46:41.437
> 
> 标签：objective-c, variables, uitextfield, sender

我有几个文本字段，每个都有标签，我想单独添加到数组中。在添加之前，我需要弄清楚它来自哪个字段。我想对所有这些都使用相同的方法，而不是为每个文本字段使用一个方法。

是否可以从发件人那里获取文本字段的变量名称？如果它们是按钮，我可以使用 [sender currentTitle]，但我不知道如何从文本字段中获取标识符。

我在想这样的事情：

```
- (void)makeItSo:(id)sender
{
    NSString * senderName = (UITextField*)[sender stringValue] ;
    if ([senderName isEqual: @"name"] )
        -- add name to array
    else if ([senderName isEqual: @"address"] )
        -- add address to array
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T22:53:10.203

如果你给每个文本字段一个标签，然后使用标签：

```
- (void)makeItSo:(UITextField *)sender {
    if (sender.tag == 1) {
        // the name text field
    } else if (sender.tag == 2) {
        // the address text field
    }
} 
```

这假设您已经`tag`在 IB 或代码中为每个文本字段设置了属性。

为每个标签定义常量可能很有用，因此您最终会得到更易于阅读的内容：

```
#define kNameTextField 1
#define kAddressTextField 2

- (void)makeItSo:(UITextField *)sender {
    if (sender.tag == kNameTextField) {
        // the name text field
    } else if (sender.tag == kAddressTextField) {
        // the address text field
    }
} 
```

如果您有插座或实例变量，那么您可以执行以下操作：

```
- (void)makeItSo:(UITextField *)sender {
    if (sender == _nameTextField) {
        // the name text field
    } else if (sender == _addressTextField) {
        // the address text field
    }
} 
```

where`_nameTextField`和`_addressTextFields`是文本字段的 ivars。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T22:51:40.237

> 是否可以从发件人那里获取文本字段的变量名称？

不，**除非它是一个实例变量，**在这种情况下你可以，但**你最好不要。**

> 我不知道如何从文本字段中获取标识符

与往常一样，阅读[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/uiview_class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW25)就足够了，因为它使用了以下`tag`属性`UIView`：

```
if ([sender tag] == SOME_CUSTOM_PRESET_VALUE) {
    // do stuff
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T22:57:08.893

例如，您可能将这些文本字段作为 ivars：

```
@property (weak) UITextField* textField1;  // tag=1
@property (weak) UITextField* textField2;  // tag=2
...
@property (weak) UITextField* textFieldN;  // tag=N 
```

当您收到一个操作时，您只需执行以下操作：

```
- (void)makeItSo:(id)sender
{
    // This is the searched text field
    UITextField* textField= [self valueForKey: [NSString stringWithFormat: @"textField%d",sender.tag] ];  
} 
```

但是在这一点上，为什么不使用单个属性，它是一个包含 N 个文本字段的数组，而不是 N 个属性？

# jquery - Jquery选项卡不记得新页面加载时最后打开的选项卡

> ID：15581065
> 
> 赞同：1
> 
> 时间：2013-03-22T22:46:44.273
> 
> 标签：jquery, tabs, default

我将 JS 用于一些简单的 Jquery 选项卡，我将其用作开发中网站上的主要垂直导航栏。

我有两个主要选项卡，“选项卡 1”（左侧）和“选项卡 2”（右侧）。在每个选项卡上都有链接到网站各个页面的子链接。

所以我的问题是，每当我单击“选项卡 2”中的链接时，当新页面加载时，导航栏默认恢复为“选项卡 1”。

我希望它让我从“选项卡 2”单击的任何链接都在加载时将导航栏默认为“选项卡 2”。

我的 JS 在这里：

```
$(document).ready(function() {

$(".tab-content").hide();                           
$("ul.tabs li:first").addClass("active").show();    
$(".tab-content:first").show();                     
$("ul.tabs li").click(function() {                  
    $("ul.tabs li").removeClass("active");          
    $(this).addClass("active");                     
    $(".tab-content").hide();                       
    var activeTab = $(this).find("a").attr("href"); 
    $(activeTab).fadeIn();                          
    return false;
});}); 
```

任何帮助将不胜感激。

这是HTML：

```
<!-- START TABS -->

            <div class="tabbz">
                <ul class="tabs">
                    <li><a href="#tab1">サービス内容</a></li>
                    <li class="active"><a href="#tab2">ご利用案内&lt;/a></li>
                </ul>
                <div class="tab-container">
                    <div id="tab1" class="tab-content">
                        <ul>
                            <li>
                            <a href="/a.php">転送サービス&lt;/a>                                
                            <a href="/b.php">お買い物サービス</a>   
                                <ul>
                                    <li><a href="/b1.php">卸売・仕入れサポート</a></li>
                                    <li><a href="/b2.php">国際展示会サポート&lt;/a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div id="tab2" class="tab-content">
                        <ul>
                            <li><a href="/c.php">ご利用ガイド</a>
                                <ul>
                                    <li><a href="/c1.php">個人輸入とは</a></li>
                                    <li><a href="/c2.php">サービスの流れ&lt;/a></li>
                                </ul>
                            </li>
                            <li><a href="/d.php">料金ガイド&lt;/a>
                                <ul>
                                    <li><a href="/d1.php">手数料について&lt;/a></li>
                                    <li><a href="/d2.php">換算レート&lt;/a></li>
                                </ul>
                            </li>                               
                        </ul>
                    </div>
                </div>
            </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T22:50:06.480

好吧，一个新的页面加载发生了，所以标签从头开始重新初始化。您将不得不以某种方式在页面之间传递选定的选项卡 - 在 URL 中作为片段或参数，或在 cookie 中，然后在初始化选项卡时读回该值并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T22:53:44.720

在每个页面上，您可以添加一些属性或唯一标识该页面的内容，例如`<body id="contact">`.

改变你的 js，它说根据 body id 添加活动类

```
 $("ul.tabs li."+$('body').attr('id')).addClass("active").show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T03:49:44.560

你可以改变这一行

```
$("ul.tabs li:first").addClass("active").show(); 
```

到

```
$("ul.tabs li.active").show(); 
```

并在您的 html 中添加**class="active"**到 li

```
<li class="active"> 
```

# javascript - 阅读 json 直到“更多”评论

> ID：15581069
> 
> 赞同：0
> 
> 时间：2013-03-22T22:47:06.460
> 
> 标签：javascript, tumblr

我想从 tumblr 博客中提取并使用 javascript 将其显示在另一个网页上。

我正在使用 $TUMBLR_BLOG/api/read/json 提要，它提供了一个变量，其中填充了博客文章中的信息。

我想将所有内容打印到`"<!-- more -->"`“常规正文”部分中的字符集，即。我不想打印“常规体”中的所有内容，直到更多部分。

关于如何做到这一点的任何想法？

例如。API读取：[http ://blog.intercut.yegfilm.ca/api/read/json](http://blog.intercut.yegfilm.ca/api/read/json)

例如。我正在使用的基本代码：

```
<script type="text/javascript" src="http://blog.intercut.yegfilm.ca/api/read/json"></script>
<script type="text/javascript">
// The variable "tumblr_api_read" is now set.
document.write(
'<h3> <a href="' + tumblr_api_read.posts[0]['url'] + '">' + tumblr_api_read.posts[0]['regular-title'] + '</a></h3>' +
tumblr_api_read.posts[0]['regular-body']);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T22:59:30.833

```
<script type="text/javascript">
  // The variable "tumblr_api_read" is now set.
  var url = tumblr_api_read.posts[0]['url'];
  var title = tumblr_api_read.posts[0]['regular-title'];
  var body = tumblr_api_read.posts[0]['regular-body'];
  body = body.substring(0,body.indexOf("<!-- more -->"));

  document.write('<h3> <a href="' + url + '">' + title + '</a></h3>' + body);
</script> 
```

就那么简单 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T22:52:59.637

像`responseData.split("<!-- more -->")[0]`什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T22:53:08.183

获取 的索引`<!-- more -->`并将子字符串打印到该索引。

```
sampleString = "Foo <!-- more --> Bar";

moreIndex = sampleString.indexOf("<!-- more -->");

if (moreIndex > 0) {
  console.log(sampleString.substring(0, moreIndex));
} 
```

[JSFiddle](http://jsfiddle.net/8xeVM/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-22T22:54:11.280

使用javascript`SubString()`方法：

**示例**：

```
var mystring = 'Hello World <!-- more -->';
alert(mystring.substring(0,mystring.indexOf("<!-- more -->"))); 
```

**jsfiddle**：http: [//jsfiddle.net/8CXd8/](http://jsfiddle.net/8CXd8/)

**文档**：[http ://www.w3schools.com/jsref/jsref_substring.asp](http://www.w3schools.com/jsref/jsref_substring.asp)

# javascript - Webstorm 不刷新修改过的 JavaScript 文件

> ID：15581070
> 
> 赞同：7
> 
> 时间：2013-03-22T22:47:20.720
> 
> 标签：javascript, python, google-chrome, webstorm

我的 HTML 页面引用了一些 JavaScript 文件，例如：

```
<script type="text/javascript" src="MyClass.js"></script> 
```

我正在使用带有 Chrome 的 Windows 中的 Python SimpleHTTPServer 使用 WebStorm 进行调试。我可以在我的 JavaScript 中设置断点，WebStorm 会按预期在它们处停止。

但是，有时当我对 JavaScript 进行更改并重新启动调试器时，它会运行旧代码，而不是更新后的代码。如果我放置一个断点，它停止的行与我放置断点的位置不同步。

如何强制刷新？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-28T05:11:37.587

问题在于 Chrome（和 Firefox）缓存 JavaScript——这可能超出了 WebStorm 的控制范围。解决如下：

**铬合金**

*   F12打开开发者面板，然后在工具栏中右键单击刷新->“清空缓存并硬重新加载”

*   或者; F12打开开发者面板，右下角设置图标，勾选“禁用缓存”

**火狐**

*   安装 Web Developer 工具栏，禁用 -> “禁用整个缓存”

*   或者; 看到[这个接受的答案](https://stackoverflow.com/questions/289751/turn-off-caching-on-firefox "这个接受的答案")

# c# - 在 WinRT 应用程序中使用 XAML 绑定时，UI 线程被阻止

> ID：15581076
> 
> 赞同：1
> 
> 时间：2013-03-22T22:47:33.353
> 
> 标签：c#, xaml, listview, binding, windows-runtime

我有一个带有两个 ListViews 的 WinRT C# 应用程序。一种简单的表示方法是，一个 ListView 是文件夹位置的列表，第二个 ListView 详细说明了该文件夹内的目录结构：

```
 ListView1     ListView2 (Contents of Folder 2)
 Folder 1      Folder a
|Folder 2|       File a
 Folder 3        File b
 Folder 4      Folder b
                 Folder c
                   File c
                 File d 
```

类似的东西。

我有一个主要的 ObservableCollection，它是文件夹的集合。每个文件夹都包含自己的 ObservableCollection，也就是第二个 ListView 中使用的数据。

ListView1 和 2 绑定相同，本质上是：

```
ItemsSource="{Binding Source={StaticResource folderViewSource}}"
ItemsSource="{Binding Source={StaticResource fileViewSource}}" 
```

随着 CollectionViewSources 的定义如下：

```
<!-- The list of folders, used by the main ListView -->
<CollectionViewSource
    x:Name="folderViewSource"
    Source="{Binding FolderBinding}" />

<!-- The files and folders for a specific folder, used by the Files ListView -->
<CollectionViewSource
    x:Name="fileViewSource"
    Source="{Binding ElementName=folderListView, Path=SelectedItem.Files}" /> 
```

ListView1 填充良好，没有问题。

ListView2 确实绑定正确（它在第一个 ListView 中显示所选文件夹的文件），但绑定是在 UI 线程上完成的。在我的电脑上，如果不愉快是可以容忍的。在我的 Surface RT 上，这可能需要 2 秒。

第二个 ListView 中使用的模板非常繁琐，但我将它过滤成一个字符串，它在 Surface 上仍然有点生涩——显然我需要将它移出 UI 线程。

我的第一个想法是将绑定从 XAML 中移开并在代码中进行，但我看不到任何改进它的方法 - 无论我做什么，Windows 仍在 UI 线程上创建 UI 元素。

我还查看了 ISupportIncrementalLoading 但这似乎是为了在滚动时动态加载新项目等。

我已经被困了一段时间，我有一些事情让我很忙，但我想回到这个，但我想不通。希望我遗漏了一些明显的东西。

# linux - blktrace 中的同步 I/O

> ID：15581087
> 
> 赞同：1
> 
> 时间：2013-03-22T22:49:08.860
> 
> 标签：linux, io, kernel, block, trace

blktrace 区分同步写入和异步写入（输出 W 或 WS）。

我想知道，blktrace 如何判断 I/O 请求是否同步？它会查看生物结构中的一些标志吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T07:02:21.383

我觉得你是对的。blktrace（在内核空间中）将检查 bio->bi_rw，标志 BIO_RW_SYNCIO。详细信息在 ./kernel/trace/blktrace.c

# google-apps-script - 如何在文档中查找单词并插入 url

> ID：15581090
> 
> 赞同：0
> 
> 时间：2013-03-22T22:49:20.320
> 
> 标签：google-apps-script, google-docs

如何在 google-drive 文档中的特定单词上插入超链接？

我能找到这个词。之后，我想分配一个超链接。我使用了这段代码：

```
doc.editAsText().findText("mot").setLinkUrl("https://developers.google.com/apps-script/class_text"); 
```

我的文档是 DocumentApp，它在使用 UI 完成时有效。但是，上面的代码不起作用。我该如何执行此任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T15:59:38.393

借助下面的实用功能，您可以做到这一点：

```
linkText("mot","https://developers.google.com/apps-script/class_text"); 
```

该`linkText()`函数将在文档的文本元素中查找给定字符串或正则表达式的所有出现，并用 URL 包装找到的文本。如果`baseUrl`包含 形式的`%target%`占位符，则占位符将替换为匹配的文本。

要从自定义菜单中使用，您需要进一步包装实用程序函数，例如：

```
/**
 * Find all ISBN numbers in current document, and add a url Link to them if
 * they don't already have one.
 * Add this to your custom menu.
 */
function linkISBNs() {
  var isbnPattern = "([0-9]{10})";  // regex pattern for ISBN-10
  linkText(isbnPattern,'http://www.isbnsearch.org/isbn/%target%');
} 
```

### 代码

我最初编写此实用程序函数是为了执行将错误编号与指向我们的问题管理系统的链接一起包装的任务，但已将其修改为更通用。

```
/**
 * Find all matches of target text in current document, and add a url
 * Link to them if they don't already have one. The baseUrl may
 * include a placeholder, %target%, to be replaced with the matched text.
 *
 * @param {String} target   The text or regex to search for. 
 *                          See Body.findText() for details.
 * @param {String} baseUrl  The URL that should be set on matching text.
 */
function linkText(target,baseUrl) {
  var doc = DocumentApp.getActiveDocument();
  var bodyElement = DocumentApp.getActiveDocument().getBody();
  var searchResult = bodyElement.findText(target);

  while (searchResult !== null) {
    var thisElement = searchResult.getElement();
    var thisElementText = thisElement.asText();
    var matchString = thisElementText.getText()
          .substring(searchResult.getStartOffset(), searchResult.getEndOffsetInclusive()+1);
    //Logger.log(matchString);

    // if found text does not have a link already, add one
    if (thisElementText.getLinkUrl(searchResult.getStartOffset()) == null) {
      //Logger.log('no link')
      var url = baseUrl.replace('%target%',matchString)
      //Logger.log(url);
      thisElementText.setLinkUrl(searchResult.getStartOffset(), searchResult.getEndOffsetInclusive(), url);
    }

    // search for next match
    searchResult = bodyElement.findText(target, searchResult);
  }
} 
```

# android-ndk - 为什么 Eclipse C ndk jni 执行速度会比 gcc shell 慢 6 倍？

> ID：15581095
> 
> 赞同：0
> 
> 时间：2013-03-22T22:50:14.387
> 
> 标签：android-ndk

我有一个在 jni 中使用 C ndk 子例程的程序，它处理一个 3204x2406 图像文件，当 NDK_DEBUG=0 的 Eclipse 运行 *（无调试）时需要 6 秒以上。

我在 1 秒内在 shell 中运行的 android 上使用 GCC 编译了相同的代码。

代码由循环和整数数学组成。eclipse ndk 程序和 gcc shell 程序都从完全相同的位置访问完全相同的文件。6 秒内没有跟踪语句。唯一的外部调用是 2406 个读取语句。

eclipse是google集成下载的21.0.0，使用的是Juno 4.2.1和c/c++ 8.1.1。是的，我已经重新启动了 eclipse 并清理了项目。

我现在正在考虑尝试调用或链接到 GCC 代码，但一直觉得我一定错过了一些愚蠢的东西。

# php - 梨包不工作

> ID：15581104
> 
> 赞同：1
> 
> 时间：2013-03-22T22:51:26.197
> 
> 标签：php, pear

几个小时以来，我一直在尝试使用几个 PEAR 包，但无济于事。PEAR 本身正在运行，我*相信*我正确设置了所有配置变量，但是当我尝试从命令行运行我的任何包时，我收到 PHP 错误，告诉我找不到所需的文件。例如，使用`phpdoc`：

```
$ phpdoc
PHP Warning:  require(PhpDocumentor/phpDocumentor/phpdoc.inc): failed to open stream: No such file or directory in /Applications/MAMP/htdocs/pear/bin/phpdoc on line 40

Warning: require(PhpDocumentor/phpDocumentor/phpdoc.inc): failed to open stream: No such file or directory in /Applications/MAMP/htdocs/pear/bin/phpdoc on line 40
PHP Fatal error:  require(): Failed opening required 'PhpDocumentor/phpDocumentor/phpdoc.inc' (include_path='.:/Applications/MAMP/bin/php5.2/lib/php') in /Applications/MAMP/htdocs/pear/bin/phpdoc on line 40

Fatal error: require(): Failed opening required 'PhpDocumentor/phpDocumentor/phpdoc.inc' (include_path='.:/Applications/MAMP/bin/php5.2/lib/php') in /Applications/MAMP/htdocs/pear/bin/phpdoc on line 40 
```

我尝试手动编辑文件，插入文件的绝对路径，但是当我更正一个`require`错误时，就会出现一个新错误。

这是我的 pear.conf：

```
#PEAR_Config 0.9
a:15:{s:10:"__channels";a:2:{s:12:"pecl.php.net";a:0:{}s:5:"__uri";a:0:{}}s:15:"preferred_state";s:6:"stable";s:8:"temp_dir";s:35:"/Applications/MAMP/htdocs/pear/temp";s:7:"bin_dir";s:34:"/Applications/MAMP/htdocs/pear/bin";s:7:"php_dir";s:35:"/Applications/MAMP/htdocs/pear/PEAR";s:7:"doc_dir";s:40:"/Applications/MAMP/htdocs/pear/PEAR/docs";s:8:"data_dir";s:40:"/Applications/MAMP/htdocs/pear/PEAR/data";s:8:"test_dir";s:41:"/Applications/MAMP/htdocs/pear/PEAR/tests";s:9:"cache_dir";s:41:"/Applications/MAMP/htdocs/pear/PEAR/cache";s:9:"cache_ttl";i:300;s:12:"download_dir";s:44:"/Applications/MAMP/htdocs/pear/temp/download";s:10:"http_proxy";s:0:"";s:7:"ext_dir";s:74:"/Applications/MAMP/bin/php5.2/lib/php/extensions/no-debug-non-zts-20050922";s:7:"php_bin";s:37:"/Applications/MAMP/bin/php5.2/bin/php";s:10:"sig_keydir";s:39:"/Applications/MAMP/conf/php5.2/pearkeys";} 
```

![梨配置](../Images/55a55aaaf9220e9c090bbc3bdd827674.png)

我在 Mac OS 10.7.5 上使用 MAMP PRO v1.9.5 和 PHP v5.2.17。此外，我使用 PEAR Web 界面包管理器安装了这些包。如果需要任何进一步的信息，请告诉我，我会发布。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:02:00.217

确保包含路径包含 PEAR 安装 php 类文件的文件夹。检查您的`include_path`ini设置。它应该看起来像：

```
include_path=".:PEAR_CLASSES_PATH" 
```

`PEAR_CLASSES_PATH`梨类路径在哪里

# javascript - 更新无法为无线电类型和选择器设置默认值

> ID：15581109
> 
> 赞同：0
> 
> 时间：2013-03-22T22:52:07.943
> 
> 标签：javascript, jquery

我已经检查了这个链接[Set radio button 'checked' in jquery based on ID](https://stackoverflow.com/questions/3121785/set-radio-button-checked-in-jquery-based-on-id)但是，似乎不太适合我。这是我的代码

```
<label for="basic" class="basic">Gender:</label>
<fieldset data-type="horizontal" data-role="controlgroup" data-mini="true">
    <input type="radio" name="gender" id="radio-mini-1" value="Male" checked="checked" />
    <label for="radio-mini-1">Male</label>

    <input type="radio" name="gender" id="radio-mini-3" value="Female"  />
    <label for="radio-mini-3">Female</label>
</fieldset> 
```

和

```
<label for="select-choice-min" class="select">Living Place:</label>
<select name="select-choice-min" id="livingPlace" data-mini="true">
    <optgroup label="AAA">
    <option value="123">123</option>
    <option value="456">456</option>
    </optgroup>

    <optgroup label="BBB">
    <option value="789">789</option>
    <option value="246">246</option>
    </optgroup>
</select> 
```

请问如何设置默认值？谢谢。

我的 json 返回是这样的：

```
[{"data":{"id":"8","livingPlace":"789","gender":"Female"}}] 
```

**UPDATED** For the living Place，我发现当我使用`$("#livingPlace").val(data[0].data.livingPlace);`它时，它实际上可以获取选择器中的值，当我点击选择器时，它可以显示正确的值，但是，当页面加载时，没有点击选择器，它只显示选择器中的第一个值，即上面示例中的 123

```
 $.getJSON('http://mydomain.com/getmyDetail.php?user_name='+localUsername+'&role='+localRole+'&jsoncallback=?', function(data) { // the javascripts are located here

        $('#livingPlace').val(data[0].data.livingPlace).find('[value="' + data[0].data.livingPlace + '"]').attr('selected', 'selected');} 
```

我是这样做的，有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:05:47.153

设置 select 就像使用 jQuery 输入一样：

```
$('#livingPlace').val(789); // select menu is easy 
```

您的单选按钮有点冗长：

```
$('input[name="gender"][value="Female"]').attr('checked', 'checked'); 
```

让我解释一下那个长选择器。

input - 寻找一个 <input> 标签

[name="gender"] - 查找属性 "name" 设置为 "gender" 的标签 - 这会抓取两个单选按钮。

[value="Female"] - 这是我们缩小到值为 Female 的单选按钮的地方。

选择“女性”单选按钮后，我们将“已选中”属性设置为“已选中”。我们也可以将其设置为 true。嗯，浏览器会自动取消选中其他单选按钮。

加上你的数据，这是一种解决方案：http: [//jsfiddle.net/hRqZP/1/](http://jsfiddle.net/hRqZP/1/)

```
var json = '[{"data":{"id":"8","livingPlace":"789","gender":"Female"}}]';
var data = JSON.parse(json)[0].data; // get 'data' out of json.
$('#livingPlace').val(data.livingPlace); // select menu is easy
$('input[name="gender"][value="' +
      data.gender +
      '"]'
 ).attr('checked', 'checked'); 
```

编辑：我不知道您使用的是什么浏览器，但我注意到 val() 没有在选项上设置“selected=selected”。不过，在 Chrome 中，它显示了正确的值。无论如何，我对其进行了更新，使其也设置了 selected=selected：http: [//jsfiddle.net/hRqZP/2/](http://jsfiddle.net/hRqZP/2/)

```
var json = '[{"data":{"id":"8","livingPlace":"789","gender":"Female"}}]';
var data = JSON.parse(json)[0].data; // get 'data' out of json.
$('#livingPlace').
    val(data.livingPlace).
    find('[value="' + data.livingPlace + '"]').
        attr('selected', 'selected');
$('input[name="gender"][value="' +
      data.gender +
      '"]'
 ).attr('checked', 'checked'); 
```

编辑：对于 jQuery.mobile，选择菜单可能需要刷新：

```
$('#livingPlace').
    val(data.livingPlace).
    find('[value="' + data.livingPlace + '"]').
        attr('selected', 'selected').
    end().
    selectmenu('refresh', true); 
```

# ruby - 在 Ubuntu for Discourse 上安装 fast_xor Gem 时遇到问题

> ID：15581112
> 
> 赞同：1
> 
> 时间：2013-03-22T22:52:31.460
> 
> 标签：ruby, ubuntu, rvm, ubuntu-12.10, ruby-2.0

我对 ruby​​、rvm、gems 等术语很陌生；但我正在尝试在 Ubuntu 12.10 服务器上安装 Discourse。我已经安装了所有的宝石`bundle install`，除了一个，`fast_xor`：

```
Installing fast_xor (1.1.1) 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

    /home/ubuntu/.rvm/rubies/ruby-2.0.0-p0/bin/ruby extconf.rb 
creating Makefile

make
compiling xor.c
xor.c: In function ‘string_xor’:
xor.c:28:5: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
xor.c:45:7: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
linking shared-object xor.so

make install
/usr/bin/install -c -m 0755 xor.so /home/ubuntu/.rvm/gems/ruby-2.0.0-p0/gems/fast_xor-1.1.1/lib/fast_xor
/usr/bin/install: cannot create regular file `/home/ubuntu/.rvm/gems/ruby-2.0.0-p0/gems/fast_xor-1.1.1/lib/fast_xor': No such file or directory
make: *** [install-so] Error 1

Gem files will remain installed in /home/ubuntu/.rvm/gems/ruby-2.0.0-p0/gems/fast_xor-1.1.1 for inspection.
Results logged to /home/ubuntu/.rvm/gems/ruby-2.0.0-p0/gems/fast_xor-1.1.1/ext/xor/gem_make.out

An error occurred while installing fast_xor (1.1.1), and Bundler cannot continue.
Make sure that `gem install fast_xor -v '1.1.1'` succeeds before bundling. 
```

我已从 Git 签出`fast_xor`项目，但在从源代码编译时收到类似的错误。

`rvm list`仅列出一个版本的 Ruby ：

```
ubuntu@ip-10-245-40-185:~/discourse$ rvm list

rvm rubies

=* ruby-2.0.0-p0 [ x86_64 ]

# => - current
# =* - current && default
#  * - default 
```

我不知道从这里去哪里？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T16:51:22.973

在您的`Gemfile`替换行中：

```
gem 'fast_xor' 
```

对于以下一个（从已修复错误的 Git 存储库中提取 fast_xor）：

```
gem "fast_xor", :git => "git://github.com/CodeMonkeySteve/fast_xor.git" 
```

如果由于某种原因 git 协议在您的网络中被防火墙（如我的情况），那么您可以用 HTTPS 替换它：

```
gem "fast_xor", :git => "https://github.com/CodeMonkeySteve/fast_xor.git" 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-23T09:07:13.397

这是 gem 中的一个错误：[https ://github.com/CodeMonkeySteve/fast_xor/issues/5](https://github.com/CodeMonkeySteve/fast_xor/issues/5)

在提问之前始终检查项目的问题跟踪器 - stavkoverflow 用于解决问题而不是报告错误。

# java - 获取城市安卓

> ID：15581113
> 
> 赞同：0
> 
> 时间：2013-03-22T22:52:34.820
> 
> 标签：java, android

我正在尝试获取用户当前的城市（不是确切的地址，只有城市）

为了得到这个国家，我正在使用这个代码：

```
 String locale = context.getResources().getConfiguration().locale.getCountry(); 
```

我尝试使用此代码来获取城市：

```
Geocoder gcd = new Geocoder(context, Locale.getDefault());
List<Address> addresses = gcd.getFromLocation(lat, lng, 1);
if (addresses.size() > 0) 
    System.out.println(addresses.get(0).getLocality()); 
```

但是它为我返回一个空字符串：“”

ps：我已经在清单文件中有一个 ACCESS_FINE_LOCATION 和互联网权限

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:03:55.757

首先，您获取国家/地区的方式只是为您提供在设置中定义的国家/地区。所以这在很多情况下可能是正确的，但对于在他们的设置中设置了另一个国家的用户来说，他们现在实际上是这样的。

`Geocoder`没有给出任何纬度、经度组合的结果，原因之一可能是缺少网络连接，或者您缺少 API 使用的基本服务。

您还应该确保`Geocoder.isPresent()`返回 true - 如果不是，它将不适用于任何位置。[Geocoder 的 isPresent() 方法总是返回 false](https://stackoverflow.com/questions/9075446/geocoders-ispresent-method-always-returns-false)

# intellij-idea - 不使用宏的自定义编辑器命令？

> ID：15581116
> 
> 赞同：0
> 
> 时间：2013-03-22T22:52:55.087
> 
> 标签：intellij-idea

有没有办法在不使用宏的情况下制作自定义命令？我想做这样的事情：

*   跳下 20 行
*   跳上 20 行
*   当光标在底部/顶部的 15 行内移动时，编辑器窗口滚动
*   逐段跳转（意思是：跳转到下一个空行，或方法签名开始，以先到者为准）

当然，这些数字是可编辑的。

我试过宏，但它们太慢了。基本上我希望 IntelliJ 的行为更像 emacs。我希望我不必制作插件，但如果这是唯一的选择，我会的。只是希望有一种我错过的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T18:59:06.403

没有办法做你所要求的。然而，有一个 IdeaVIM 插件可以让你做一些你要求的事情（通过 Preferences->Plugins 安装）。还有一个 emacs 插件可以给你你想要的： http: [//devnet.jetbrains.com/thread/441261](http://devnet.jetbrains.com/thread/441261)

IdeaVIM 插件由 Jetbrains 维护，因此质量可能更高。

# c++ - 嵌套模板的迭代器

> ID：15581121
> 
> 赞同：-5
> 
> 时间：2013-03-22T22:53:10.913
> 
> 标签：c++, templates, iterator

创建嵌套模板的迭代器的一般规则是什么？例如，您将如何为以下模板创建迭代器：

```
map<int, pair<string, int> > M;
map<map<int, string>, map<string, pair<int, int> > N; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T22:54:36.687

`::iterator`如果容器提供它，规则是添加一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T22:54:44.220

就像任何类型的容器的迭代器一样：

```
map<int, pair<string,int>>::iterator it1; // or const_iterator
map<map<int,string>, map<string, pair<int,int>>::iterator it2; // or const_iterator 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-22T22:54:54.773

只需添加`::iterator`

```
map<int, pair<string,int>>::iterator
map<map<int,string>, map<string, pair<int,int>>::iterator 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-22T22:55:01.893

标准 C++ 容器定义了一个类型别名`iterator`和一个`const_iterator`您可以引用的类型别名。

例如，如果您的类型是：

```
map<int, pair<string,int>> 
```

然后，您可以通过执行以下操作获取迭代器的类型：

```
map<int, pair<string,int>>::iterator
//                        ^^^^^^^^^^ 
```

或者，如果您需要一个常量迭代器：

```
map<int, pair<string,int>>::const_iterator
//                        ^^^^^^^^^^^^^^^^ 
```

但是，在 C++11 中您通常不需要这样做，因为`auto`允许您让编译器推断迭代器的类型：

```
map<int, pair<string,int>> m;
// Fill in the map...
auto i = m.begin(); 
```

上述代码段的最后一行相当于：

```
map<int, pair<string,int>>::iterator i = m.begin(); 
```

# ios - 阻止旋转通知传播到子视图

> ID：15581128
> 
> 赞同：2
> 
> 时间：2013-03-22T22:54:20.340
> 
> 标签：ios, objective-c

我正在使用设备方向通知来了解设备是否已旋转，以便我可以执行选择器。这是我正在使用的代码：

```
- (void)awakeFromNib
{
    isShowingLandscapeView = NO;
    [[UIDevice currentDevice] beginGeneratingDeviceOrientationNotifications];
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(orientationChanged:)
                                                 name:UIDeviceOrientationDidChangeNotification
                                               object:nil];
}

- (void)orientationChanged:(NSNotification *)notification
{
    UIDeviceOrientation deviceOrientation = [UIDevice currentDevice].orientation;
    if (UIDeviceOrientationIsLandscape(deviceOrientation) &&
        !isShowingLandscapeView)
    {
        [[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:UIStatusBarAnimationFade];
        [self performSegueWithIdentifier:@"landscape" sender:self];
        isShowingLandscapeView = YES;
    }
    else if (UIDeviceOrientationIsPortrait(deviceOrientation) &&
             isShowingLandscapeView)
    {
        [[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationFade];
        [self dismissViewControllerAnimated:YES completion:nil];
        isShowingLandscapeView = NO;
    }
} 
```

但是，当我导航到其他子视图并旋转设备时，尽管上面的代码位于一个独立于其他视图所具有的类的类中，但仍会执行选择器。那我怎么能阻止呢？我试过：

```
[[UIDevice currentDevice] endGeneratingDeviceOrientationNotifications]; 
```

它也没有用。当设备旋转时，我的应用程序实际上会以横向模式弹出另一个视图。所以在子视图中，横向视图出现在我旋转设备中。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T22:58:49.510

删除`UIDeviceOrientationDidChangeNotification`

```
[[NSNotificationCenter defaultCenter] removeObserver:self name: UIDeviceOrientationDidChangeNotification object:nil]; 
```

删除所有通知

```
[[NSNotificationCenter defaultCenter] removeObserver:self]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T22:59:05.723

在您的父视图控制器中：

```
- (BOOL)shouldAutomaticallyForwardRotationMethods {
    return NO;
} 
```

从文档：

> 调用此方法来确定是否自动将与旋转相关的包含回调转发给子视图控制器。
> 
> 默认实现返回`YES`. 实现包含逻辑的 UIViewController 类的子类可以重写此方法以控制这些方法的转发方式。如果您重写此方法并返回`NO`，您有责任在适当的时候将以下方法转发给子视图控制器：
> 
> `willRotateToInterfaceOrientation:duration:` `willAnimateRotationToInterfaceOrientation:duration:` `didRotateFromInterfaceOrientation:`

# c++ - 在 C++ 中使用 armadilo 读取数据文件的更快方法

> ID：15581131
> 
> 赞同：1
> 
> 时间：2013-03-22T22:54:48.850
> 
> 标签：c++, matlab, armadillo

嗨，我最近刚刚发现了用于 C++ 的犰狳库，我非常喜欢它。在 MATLAB 中对其进行原型设计后，我正在构建一个应用程序，以便我可以更快地执行它。我面临的问题是，当我尝试从`.mat`文件中加载矩阵时，如下所示：

```
A.load("A.mat",raw_ascii); 
//raw_ascii because I can port data to MATLAB as well. 
```

大约需要 10 秒。我想知道在犰狳或 C++ 中是否有更快的方法。

任何想法都非常感谢，谢谢。

编辑 1 - 我要读取的文件大约是 35MB。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:39:11.017

hdf5_binary 应该工作得更快。Matlab 支持这种格式

# android - CounDownTimer 如何设置为计数 2 次？

> ID：15581138
> 
> 赞同：0
> 
> 时间：2013-03-22T22:55:25.130
> 
> 标签：android, countdowntimer

我正在做一个应用程序，`CountDownTimer` 我想使用 1 个倒数计时器进行 2 次倒计时。如果时间结束，则立即开始新的时间，依此类推。

现在我有这样的事情：

```
cdt = new CounDownTimer(time,1000) {
    public void onTick(…) {
        //code
    }
    public void onFinish() {
        //and here I'm thinking to add a new time, but it doesn't work
    }
}; 
```

怎么做？或者也许有其他更简单的选择来解决这个问题？

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:13:56.257

在你的班级中的某个地方 newMyCountdownTimer(time, interval).start();

```
private class MyCountdownTimer extends CountDownTimer
{

    public MyCountdownTimer(long millisInFuture, long countDownInterval)
    {
        super(millisInFuture, countDownInterval);
    }

    @Override
    public void onFinish()
    {
        if (somecondition is satisfied) // be carefull otherwise the countdown keeps running
        { 
        // newTime and newInterval are variables in the outer class  
            new MyCountdownTimer(newTime, newInterval).start();
        }

    }

    @Override
    public void onTick(long millisUntilFinished)
    {
        // TODO Auto-generated method stub

    }

} 
```

# c++ - 使用 IF 语句而不是异常处理更便宜？

> ID：15581139
> 
> 赞同：2
> 
> 时间：2013-03-22T22:55:30.787
> 
> 标签：c++, performance, optimization

异常处理会产生间接成本（据我所知）......而且我很欣赏 IF 语句/分支会导致代码变慢。但是，假设您的程序在 99.9% 的时间内正确运行，则分支预测器在大多数情况下都会正确猜测，并且您不需要在整个程序中进行异常处理开销......

因此，在性能关键的应用程序中，使用 IF 语句而不是传统的异常处理来检测错误是否更好？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T23:12:43.427

异常处理的典型实现不会比语句增加更多的开销（在速度方面）`if`（甚至可能会增加一点）。通过合理谨慎的使用，它还可以减少代码混乱，增强可读性。

IOW，对于完全有意义的代码，它通常是一个相当大的胜利，*几乎*没有缺点。主要的潜在缺点是更大的可执行文件，并且需要运行时支持，因此它并不真正适合设备驱动程序之类的东西（至少通常如此）。

# regex - Notepad++ 正则表达式广告行，复制字符串并更改它们

> ID：15581140
> 
> 赞同：0
> 
> 时间：2013-03-22T22:55:36.997
> 
> 标签：regex, notepad++

我想在数千个波前 *.mtl 文件中搜索替换和字符串以添加许多新的纹理链接。Notepad++ 正则表达式甚至可以做到这一点吗？我已经经常使用正则表达式更改这些文件，但这项任务超出了我的想象！

在当前状态下，我在每个文件中都有很多 Materialparts，看起来像这样。

```
newmtl Material__28  
    Ns 0.000000  
    Ni 1.500000  
    d 1.000000  
    Tr 0.000000  
    Tf 1.000000 1.000000 1.000000   
    illum 2  
    Ka 1.000000 1.000000 1.000000  
    Kd 1.000000 1.000000 1.000000  
    Ks 0.000000 0.000000 0.000000  
    Ke 0.000000 0.000000 0.000000  

    map_Kd textures\wall_exterior_wood_02.png 
```

之后它应该包含命名与第一个 map_Kd 完全相同的 NRM 和 Spec png。

例子：

```
newmtl Material__28  
    Ns 0.000000  
    Ni 1.500000  
    d 1.000000  
    Tr 0.000000  
    Tf 1.000000 1.000000 1.000000   
    illum 2  
    Ka 1.000000 1.000000 1.000000  
    Kd 1.000000 1.000000 1.000000  
    Ks 0.000000 0.000000 0.000000  
    Ke 0.000000 0.000000 0.000000  

    map_Kd textures\wall_exterior_wood_02.png
    map_bump textures\wall_exterior_wood_02_nrm.png
    map_bump textures\wall_exterior_wood_02_nrm alternative.png
    map_Ks textures\wall_exterior_wood_02_spec.png 
```

`map_bump`重要的是，除了前缀“ ”、“ `map_Ks`”和后缀“ `_nrm`”、“ `_nrm alternative`、”`_spec`之外，png的命名应该相同

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:15:31.940

替换`map_Kd (.*)\.png`为 `map_Kd \1.png\r\nmap_bump \1_nrm.png\r\nmap_bump \1_nrm alternative.png\r\nmap_Ks \1_spec.png`。这应该够了吧。

# c# - 为什么这个进程一启动就崩溃？

> ID：15581142
> 
> 赞同：13
> 
> 时间：2013-03-22T22:55:57.473
> 
> 标签：c#, process, system.diagnostics, windows-server-2012

我们有一个 IIS WCF 服务，它以不同的用户身份启动另一个进程 (app.exe)。我可以完全控制这两个应用程序（现在这是一个开发环境）。IIS 应用程序池以我的身份运行，我是域用户 (DOMAIN\nirvin)，同时也是机器上的本地管理员。第二个进程应该以本地用户 (svc-low) 身份运行。我正在使用`System.Diagnostics.Process.Start(ProcessStartInfo)`启动该过程。该进程成功启动 - 我知道，因为没有抛出异常，并且我得到了一个进程 ID。但是该过程立即终止，并且我在事件日志中收到如下错误：

> 错误应用程序名称：app.exe，版本：1.0.3.0，时间戳：0x514cd763
> 
> 错误模块名称：KERNELBASE.dll，版本：6.2.9200.16451，时间戳：0x50988aa6
> 
> 异常代码：0xc06d007e
> 
> 故障偏移：0x000000000003811c
> 
> 错误进程ID：0x10a4
> 
> 错误应用程序启动时间：0x01ce274b3c83d62d
> 
> 错误的应用程序路径：C:\Program Files\company\app\app.exe
> 
> 错误模块路径：C:\Windows\system32\KERNELBASE.dll
> 
> 报告 ID：7a45cd1c-933e-11e2-93f8-005056b316dd
> 
> 故障包全名：
> 
> 错误的包相关应用程序 ID：

我已经对 app.exe 进行了非常彻底的登录（现在），所以我认为它不会在 .NET 代码中引发错误（不再）。

这是真正令人讨厌的部分：我认为我只是启动了错误的过程，所以我将我的`Process.Start()`调用复制到了一个愚蠢的 WinForms 应用程序中，并以我自己的身份在机器上运行它，希望能够修补直到我得到正确的参数。所以当然这是第一次和之后的每一次：我能够持续启动第二个进程并让它按预期运行。它仅从不起作用的 IIS 启动。

我尝试授予 svc-low 权限以“作为批处理作业登录”，并尝试授予自己“替换进程级别令牌”权限（在本地安全策略中），但似乎都没有任何区别。

帮助！

### 环境细节

*   视窗服务器 2012
*   .NET 4.5（提到的所有应用程序）

### 额外细节

起初 app.exe 是一个控制台应用程序。尝试启动会使 conhost.exe 在事件日志中生成错误，因此我将 app.exe 切换为 Windows 应用程序。这将 conhost 排除在外，但给我留下了这里描述的情况。[（通过这个问题](https://stackoverflow.com/questions/677874/starting-a-process-with-credentials-from-a-windows-service)引导这条路。）

我使用的`ProcessStartInfo`对象如下所示：

```
new ProcessStartInfo
{
    FileName = fileName,
    Arguments = allArguments,
    Domain = domainName,
    UserName = userName,  
    Password = securePassword,
    WindowStyle = ProcessWindowStyle.Hidden,
    CreateNoWindow = true,  
    UseShellExecute = false,
    RedirectStandardOutput = false
    //LoadUserProfile = true  //I've done it with and without this set
}; 
```

[一个现有的问题](https://stackoverflow.com/questions/362419/using-process-start-to-start-a-process-as-a-different-user-from-within-a-windo)说我应该使用本机 API，但是 a) 该问题解决了不同的情况，b) 愚蠢的 WinForms 应用程序的成功表明这`Process.Start`是该工作的可行选择。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-28T17:44:44.260

我最终向微软开了一个案子，这是给我的信息：

> Process.Start 在指定凭据时在内部调用 CreateProcessWithLogonW(CPLW)。**不能从 Windows 服务环境**（如 IIS WCF 服务）调用CreateProcessWithLogonW 。它只能从交互式进程（由通过 CTRL-ALT-DELETE 登录的用户启动的应用程序）调用。

（这是支持工程师逐字记录的；强调我的）

他们建议我`CreateProcessAsUser`改用。他们给了我一些有用的示例代码，然后我根据自己的需要进行了调整，现在一切正常！

最终结果是这样的：

```
using System;
using System.ComponentModel;
using System.Diagnostics;
using System.Runtime.InteropServices;
using System.Security;

public class ProcessHelper
{
    static ProcessHelper()
    {
        UserToken = IntPtr.Zero;
    }

    private static IntPtr UserToken { get; set; }

    public int StartProcess(ProcessStartInfo processStartInfo)
    {
        LogInOtherUser(processStartInfo);

        Native.STARTUPINFO startUpInfo = new Native.STARTUPINFO();
        startUpInfo.cb = Marshal.SizeOf(startUpInfo);
        startUpInfo.lpDesktop = string.Empty;

        Native.PROCESS_INFORMATION processInfo = new Native.PROCESS_INFORMATION();
        bool processStarted = Native.CreateProcessAsUser(UserToken, processStartInfo.FileName, processStartInfo.Arguments,
                                                         IntPtr.Zero, IntPtr.Zero, true, 0, IntPtr.Zero, null,
                                                         ref startUpInfo, out processInfo);

        if (!processStarted)
        {
            throw new Win32Exception(Marshal.GetLastWin32Error());
        }

        uint processId = processInfo.dwProcessId;
        Native.CloseHandle(processInfo.hProcess);
        Native.CloseHandle(processInfo.hThread);
        return (int) processId;
    }

    private static void LogInOtherUser(ProcessStartInfo processStartInfo)
    {
        if (UserToken == IntPtr.Zero)
        {
            IntPtr tempUserToken = IntPtr.Zero;
            string password = SecureStringToString(processStartInfo.Password);
            bool loginResult = Native.LogonUser(processStartInfo.UserName, processStartInfo.Domain, password,
                                                Native.LOGON32_LOGON_BATCH, Native.LOGON32_PROVIDER_DEFAULT,
                                                ref tempUserToken);

            if (loginResult)
            {
                UserToken = tempUserToken;
            }
            else
            {
                Native.CloseHandle(tempUserToken);
                throw new Win32Exception(Marshal.GetLastWin32Error());
            }
        }
    }

    private static String SecureStringToString(SecureString value)
    {
        IntPtr stringPointer = Marshal.SecureStringToBSTR(value);
        try
        {
            return Marshal.PtrToStringBSTR(stringPointer);
        }
        finally
        {
            Marshal.FreeBSTR(stringPointer);
        }
    }

    public static void ReleaseUserToken()
    {
        Native.CloseHandle(UserToken);
    }
}

internal class Native
{
    internal const int LOGON32_LOGON_INTERACTIVE = 2;
    internal const int LOGON32_LOGON_BATCH = 4;
    internal const int LOGON32_PROVIDER_DEFAULT = 0;

    [StructLayout(LayoutKind.Sequential)]
    internal struct PROCESS_INFORMATION
    {
        public IntPtr hProcess;
        public IntPtr hThread;
        public uint dwProcessId;
        public uint dwThreadId;
    }

    [StructLayout(LayoutKind.Sequential)]
    internal struct STARTUPINFO
    {
        public int cb;
        [MarshalAs(UnmanagedType.LPStr)]
        public string lpReserved;
        [MarshalAs(UnmanagedType.LPStr)]
        public string lpDesktop;
        [MarshalAs(UnmanagedType.LPStr)]
        public string lpTitle;
        public uint dwX;
        public uint dwY;
        public uint dwXSize;
        public uint dwYSize;
        public uint dwXCountChars;
        public uint dwYCountChars;
        public uint dwFillAttribute;
        public uint dwFlags;
        public short wShowWindow;
        public short cbReserved2;
        public IntPtr lpReserved2;
        public IntPtr hStdInput;
        public IntPtr hStdOutput;
        public IntPtr hStdError;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct SECURITY_ATTRIBUTES
    {
        public System.UInt32 nLength;
        public IntPtr lpSecurityDescriptor;
        public bool bInheritHandle;
    }

    [DllImport("advapi32.dll", EntryPoint = "LogonUserW", SetLastError = true, CharSet = CharSet.Unicode, CallingConvention = CallingConvention.StdCall)]
    internal extern static bool LogonUser(String lpszUsername, String lpszDomain, String lpszPassword, int dwLogonType, int dwLogonProvider, ref IntPtr phToken);

    [DllImport("advapi32.dll", EntryPoint = "CreateProcessAsUserA", SetLastError = true, CharSet = CharSet.Ansi, CallingConvention = CallingConvention.StdCall)]
    internal extern static bool CreateProcessAsUser(IntPtr hToken, [MarshalAs(UnmanagedType.LPStr)] string lpApplicationName, 
                                                    [MarshalAs(UnmanagedType.LPStr)] string lpCommandLine, IntPtr lpProcessAttributes,
                                                    IntPtr lpThreadAttributes, bool bInheritHandle, uint dwCreationFlags, IntPtr lpEnvironment,
                                                    [MarshalAs(UnmanagedType.LPStr)] string lpCurrentDirectory, ref STARTUPINFO lpStartupInfo, 
                                                    out PROCESS_INFORMATION lpProcessInformation);      

    [DllImport("kernel32.dll", EntryPoint = "CloseHandle", SetLastError = true, CharSet = CharSet.Auto, CallingConvention = CallingConvention.StdCall)]
    internal extern static bool CloseHandle(IntPtr handle);
} 
```

使此代码工作有一些先决条件。运行它的用户必须具有“替换进程级别令牌”和“调整进程的内存配额”的用户权限，而“其他用户”必须具有“作为批处理作业登录”的用户权限。这些设置可以在[本地安全策略](http://www.sysnative.com/forums/windows-tips-tricks/521-local-security-policy-windows-7-professional-above-versions.html)（或可能通过组策略）下找到。如果更改它们，则需要重新启动。

`UserToken`是一个可以关闭的属性，`ReleaseUserToken`因为我们会`StartProcess`反复调用，并且我们被告知不要一次又一次地登录其他用户。

该`SecureStringToString()`方法取自[this question](https://stackoverflow.com/questions/818704/how-to-convert-securestring-to-system-string)。使用`SecureString`不是微软建议的一部分；我这样做是为了不破坏与其他代码的兼容性。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-22T23:52:04.603

```
 Exception code: 0xc06d007e 
```

这是一个特定于 Microsoft Visual C++ 的异常，设施代码 0x6d。错误代码为 0x007e (126)，ERROR_MOD_NOT_FOUND，“找不到指定的模块”。当无法找到延迟加载的 DLL 时会引发此异常。大多数程序员都有在他们的机器上生成此异常的代码，即 Visual Studio 安装目录中的 vc/include/delayhlp.cpp。

嗯，这是典型的“找不到文件”事故，特定于 DLL。如果您不知道缺少什么 DLL，那么您可以使用 SysInternals 的 ProcMon 实用程序。您会看到程序搜索 DLL，而不是在它爆炸之前找到。

使用 Process.Start() 使设计不佳的程序崩溃的经典方法是不将 ProcessStartInfo.WorkingDirectory 属性设置为存储 EXE 的目录。这通常是偶然的，但在您使用 Process 类时不会发生。看起来你不会先解决这个问题。

# java - 在 AsyncTask 的 doInBackground() 方法中使用这些变量是否安全？

> ID：15581143
> 
> 赞同：2
> 
> 时间：2013-03-22T22:56:03.293
> 
> 标签：java, android, android-asynctask, thread-safety

我有一个看起来像这样的方法：

```
public void doSomething(final int num1, final int num2, final String str) {
    new AsyncTask<Void, Void, Void>() {
        @Override
        protected Void doInBackground(Void... params) {
            reallyComplexStatisticFunction(num1 + num2, str);
        }
    }.execute();
} 
```

（我已经大大简化了这个例子。）

直接使用'方法中提供`doSomething()`的参数是否明智？或者这会导致线程相关的问题吗？`AsyncTask``doInBackground()`

另外，如果第三个参数是一个[`Context`](http://developer.android.com/reference/android/content/Context.html)实例而不是一个，它会有什么不同`String`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:18:43.173

有一些保证，`AsyncTask`你可以在它的[文档](http://developer.android.com/reference/android/os/AsyncTask.html)中看到，但这些主要是关于访问`AsyncTask`的字段。

在您的示例中，您使用的是原语和字符串。两者都不能真正被修改，所以你在这方面是安全的。

但是，如果您正在使用可以从另一个线程修改的对象，那么您不能确定在您调用的那一刻`execute()`和您实际使用该对象之间它不会被修改，它不会被修改当你在里面读到它时就改变了`doInBackground()`，或者更糟糕的是，当你试图在里面修改它时它会被修改，`doInBackground()`并可能以损坏的状态结束。对于这些情况，您需要使用同步来确保一次只有一个线程可以读取或修改此类对象。

如果您需要保持对象的值/状态在`execute()`您使用它时调用时的状态，`doInBackground()`您可能希望克隆它并将此克隆用作快照。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:11:53.900

这是安全的，只要您只传递原语和/或对[不可变对象](http://en.wikipedia.org/wiki/Immutable_object)的引用。否则，您需要确保没有其他线程将修改这些对象的状态（或同步对它的访问）。

由于`String`s 在 Java 中是不可变的，因此您的示例看起来不错。

# java - 在计算机上使用 OpenGL 绘制 FBO 挂起

> ID：15581145
> 
> 赞同：0
> 
> 时间：2013-03-22T22:56:24.807
> 
> 标签：java, opengl, lwjgl, fbo, hung

我有两台电脑，一台配备 i5 和 ATI Radeon HD 5145 的东芝笔记本电脑，以及一台配备 Pentium D 和 ATI Radeon X1300 系列的旧戴尔台式机。

我使用 LWJGL 创建了一个 Java 应用程序，它创建了一个 FBO。附加到 FBO 的纹理是屏幕的大小（东芝为 1366x768，戴尔为 1024x768）。

我在两台计算机上尝试相同的应用程序，使用名为 MSI Afterburner 的程序查看 CPU 使用率、GPU 使用率和帧率。

在东芝上，它运行完美，在戴尔上它挂起。稍后我会更好地解释。

以下是创建 FBO 的代码：

```
//Create FBO
DisplayMode display = Display.getDisplayMode();

int fboWidth  = display.getWidth();
int fboHeight = display.getHeight();

int fboTextureID = glGenTextures();
int fboID = glGenFramebuffersEXT(); 

glBindFramebufferEXT( GL_FRAMEBUFFER_EXT, fboID);

glBindTexture(GL_TEXTURE_2D, fboTextureID);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); 
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR); 
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, fboWidth, fboHeight, 0, GL_RGBA, GL_INT, 
(java.nio.IntBuffer) null);

glFramebufferTexture2DEXT(GL_FRAMEBUFFER_EXT, GL_COLOR_ATTACHMENT0_EXT,
GL_TEXTURE_2D, fboTextureID, 0);

glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0);
glBindTexture(GL_TEXTURE_2D, 0); 
```

这是显示 FBO 的 while 循环：

```
while(true)
{
    renderFBO();

    glClearColor(1.0f, 1.0f, 1.0f, 0.0f);
    glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glEnable(GL_TEXTURE_2D);
    glBindTexture(GL_TEXTURE_2D, fboTextureID);
    glBegin(GL_QUADS);

    glColor4f(1.0f, 1.0f, 1.0f, 1.0f);

    int x=0; int y=0; //FBO position
    int w=fboWidth; int h=fboHeight; //FBO size

    glTexCoord2f(0, 1);
    glVertex2f(x, y); 
    glTexCoord2f(1, 1);
    glVertex2f(x+w, y);
    glTexCoord2f(1, 0);
    glVertex2f(x+w, y+h);
    glTexCoord2f(0, 0);
    glVertex2f(x, y+h);

    glEnd();
    glBindTexture(GL_TEXTURE_2D, 0);

    glDisable(GL_TEXTURE_2D);
    Display.update(); //Update the screen
    Display.sync(60); //Cap the framerate to 60fps
} 
```

此方法将一些纹理绘制到 FBO 屏幕外

```
private void renderFBO()
    {
        glClearColor(1.0f, 1.0f, 1.0f, 0.0f);

        //Start FBO drawing
        glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, fboID );
        glClearColor(1.0f, 1.0f, 1.0f, 1.0f);
        glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        //Here I draw some textures using quads

        //Stop FBO drawing
        glBindFramebufferEXT( GL_FRAMEBUFFER_EXT, 0);
        glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    } 
```

正如我之前所说，东芝上的应用程序与 Radeon HD 完美结合。5% CPU 使用率，20% GPU 使用率和 60fps。

当使用 Radeon X1300 在旧戴尔上执行此应用程序时，计算机会挂起；CPU使用率为50%，GPU无法测量，fps为0。

如果我不绘制 FBO，只是将其渲染到屏幕外，那么旧的戴尔不会挂起，我会得到正常的结果 5% 的 CPU 使用率、20% 的 GPU 使用率和 60fps。

它在四边形中绘制 FBO 导致计算机挂起的原因。我问，为什么？为什么会这样？我的代码有问题吗？起初我以为是电脑太旧（从 2006 年开始）并且无法处理 FBO，但是为什么在将 FBO 渲染到屏幕外时它没有挂起？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T14:24:28.043

***问题解决了***

终于让它在旧戴尔上工作了。我必须使用 2 纹理的幂。ATI HD 显然可以处理 2 个纹理的非幂，因此我可以将 1366x768 纹理大小附加到 FBO。但是，我无法使用 ATI X1300 附加 1024x768 纹理。使用 1024x1024 纹理，我让应用程序以 60fps 的速度运行，并且 CPU 使用率很低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:08:42.307

可能是显卡不支持 OpenGL 的问题，或者至少是您正在使用的功能的问题。

# php - 避免 PHP 注入的更好模式是什么？

> ID：15581146
> 
> 赞同：-1
> 
> 时间：2013-03-22T22:56:27.007
> 
> 标签：php, url, code-injection

我使用 $_GET 方法创建动态 URL：

```
$page = $_GET['id']; 
```

网址：mysite.com/index.php?id=1

但是，如果有人插入恶意 URL？

网址：mysite.com/index.php&id= [http://www.infectedsite.com/viruses.txt](http://www.infectedsite.com/viruses.txt) ?

如何治疗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:05:19.720

这很容易处理。您可以准确处理查询参数的使用方式，因此请确保在使用该参数时采取适当的预防措施。

如果您正在处理数据库查询，请确保正确转义您的 get 参数。这取决于您使用的内容，但一些有用的页面是：http: [//php.net/manual/en/function.mysql-real-escape-string.php](http://php.net/manual/en/function.mysql-real-escape-string.php)（已弃用，但会让您很好地理解转义字符串）和 PDO 库中的准备语句[http://php.net/manual/en/pdo.prepared-statements.php](http://php.net/manual/en/pdo.prepared-statements.php)

另一件需要注意的是跨站脚本（XSS）。一个很好的阅读来源是[https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)](https://www.owasp.org/index.php/Cross-site_Scripting_(XSS))。只需考虑一下您可能会如何受到这样的攻击，您就可以在代码中防范它。链接的网页在这方面也提供了很好的建议。

Brad 在评论中也提到，PHP 提供了一系列过滤功能。这些可用于清理和验证您的数据。这方面的例子在[http://php.net/manual/en/book.filter.php](http://php.net/manual/en/book.filter.php)。

除此之外，在使用请求参数时主要使用您的常识。如果感觉不对或不安全，那可能是。

# c# - 当我重定向我的 html 页面时，我的 jquery 移动列表没有更新

> ID：15581147
> 
> 赞同：0
> 
> 时间：2013-03-22T22:56:29.443
> 
> 标签：c#, jquery-mobile, refresh

我有一个列表，当我重定向我的页面时，我的 jquery 移动列表没有填充。但是，当我刷新浏览器时它可以工作。有什么我可以添加的东西可以解决这个 jquery 移动问题吗？

这是我的代码：

```
@using (Html.BeginForm("Reply", "Conversation", FormMethod.Post, new {data_ajax = "false"}))
{
     <span style="font-weight: normal; white-space: pre-wrap;">@post.Message</span>        
} 
```

我传入的 post.Message 对象只是我正在显示的字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-05T22:12:48.883

jQuery mobile 在列表方面有一些非标准行为。我自己也遇到过这个问题，发现您需要手动刷新列表。例如

```
$("ListToRefresh").selectmenu('refresh'); 
```

# encoding - 为 Gstreamer 使用 GstTIPlugin 元素时遇到问题

> ID：15581149
> 
> 赞同：0
> 
> 时间：2013-03-22T22:56:49.323
> 
> 标签：encoding, signal-processing, h.264, gstreamer, rtp

对于我的项目，我正在尝试使用 gumstix overo、gstreamer 和 TI 插件来利用 DSP，以便通过 RTP 流式传输视频。我找到了这两个教程，甚至能够成功地遵循它们：

[http://jumpnowtek.com/index.php?option=com_content&view=article&id=81:gumstix-dsp-gstreamer&catid=35:gumstix&Itemid=67](http://jumpnowtek.com/index.php?option=com_content&view=article&id=81:gumstix-dsp-gstreamer&catid=35:gumstix&Itemid=67)

^^在这个版本中，我可以使用 gstreamer 和 GstTIPlugIn 元素编译嵌入式 linux 操作系统。这样做之后，我能够成功地将 videotestsource 流式传输到远程 PC。

但是，该教程适用于 caspa 视频摄像头，我使用的是本教程中使用的 Logitech Pro C920：

[http://www.oz9aec.net/index.php/gstreamer/473-using-the-logitech-c920-webcam-with-gstreamer](http://www.oz9aec.net/index.php/gstreamer/473-using-the-logitech-c920-webcam-with-gstreamer)

^^在这个我们使用H264模式的C920相机。由于 V4l2 驱动程序不支持这一点，我们使用 ac 脚本逐帧从相机捕获并将其流式传输到标准输出。从这里我们告诉 Gstreamer 从文件源中捕获，在这种情况下是 (/dev/fd/0) 中的标准。再次，我能够成功完成此操作并从 C920 相机进行流式传输，但无需使用 TIplugin 来使用 DSP。

现在解决问题：

# ./capture -c 10000 -o | gst-launch -v -e filesrc location=/dev/fd/0 ！h264解析！rtph264pay！udpsink 主机=192.168.1.100 端口=4000

^^此命令将运行捕获程序，gstreamer 将使用 h264parse 管道抓取并流式传输视频进行编码（我相信？）

当我用第一个教程中的 TIplugin 替换 h264parse 时，如下所示：

./capture -c 10000 -o | gst-launch -v -e filesrc location=/proc/self/fd/0 ！TIVidenc1 codecName=h264enc engineName=codecServer！rtph264pay！udpsink 主机=192.168.1.100 端口=4000

我收到此错误：

将管道设置为 PAUSED ... Pipeline is PREROLLING ... ERROR: from element /GstPipeline:pipeline0/GstTIVidenc1:tividenc10: failed to create video encoder: h264enc

附加调试信息：gsttividenc1.c(1584):gst_tividenc1_codec_start ():/GstPipeline:pipeline0/GstTIVidenc1:tividenc10 错误：管道不想预卷。将管道设置为 NULL ...

我还尝试保留两个元素，然后错误说它无法将 h264parse0 链接到 tividenc10

有没有人对 GstTIPlugin 有任何经验并且知道我做错了什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T03:24:15.983

你到底想解决什么问题？您是否尝试使用 TI 的编码元素对 H.264 进行编码？因为如果我没看错的话，'./capture' 实用程序已经接收到 H.264 格式的帧——无需编码。

假设我们有这个黄金例子（这对你有用，对吧？）：

```
./capture -c 10000 -o | gst-launch -v -e filesrc location=/dev/fd/0 ! 
h264parse ! rtph264pay ! udpsink host=192.168.1.100 port=4000 
```

'h264parse' 将 H.264 流解析为 H.264 NAL 单元，以利于 RTP 接收器。如果这有效，那么 h264parse 元素很高兴，因为它正在从捕获程序中获取 H.264 数据。

如果您尝试用 TI H.264 编码器元素替换 h264parse，那会令人困惑。同样，我不确切知道您要解决什么问题，所以我可能没有全貌。

如果您还不熟悉它，请了解“gst-inspect”命令。例如，'gst-inspect h264parse'。这将使您了解元素可以使用或产生的数据类型。

# regex - perl 替换 sql 转储中的序列化字符串

> ID：15581150
> 
> 赞同：1
> 
> 时间：2013-03-22T22:56:50.683
> 
> 标签：regex, perl

出于网站迁移的目的，我必须在 SQL 转储中替换 fqdn。我编写了一个应该采用 STDIN 的 perl 过滤器，替换包含应该替换的域名的序列化字符串，用传递给脚本的任何参数替换它，然后输出到 STDOUT。

这是我到目前为止所拥有的：

```
my $search   = $ARGV[0];
my $replace  = $ARGV[1];
my $offset_s = length($search);
my $offset_r = length($replace);
my $regex    = eval { "s\:([0-9]+)\:\\\"(https?\://.*)($search.*)\\\"" };

while (<STDIN>) {
    my @fs = split(';', $_);
    foreach (@fs) {
        chomp;
        if (m#$regex#g) {
        my ( $len, $extra, $str ) = ( $1, $2, $3 );
        my $new_len = $len - $offset_s + $offset_r;
        $str =~ eval { s/$search/$replace/ };
        print 's:' . $new_len . ':' . $extra . $str . '\"'."\n";
        }
    }
} 
```

过滤器获取可能看起来像这样的传递数据（这取自 wordpress 转储，但我们也应该适应 drupal 转储：

```
INSERT INTO `wp_2_options` VALUES (1,'siteurl','http://to.be.replaced.com/wordpress/','yes'),(125,'dashboard_widget_options','
a:2:{
s:25:\"dashboard_recent_comments\";a:1:{
s:5:\"items\";i:5;
}
s:24:\"dashboard_incoming_links\";a:2:{
s:4:\"home\";s:31:\"http://to.be.replaced.com/wordpress\";
s:4:\"link\";s:107:\"http://blogsearch.google.com/blogsearch?scoring=d&partner=wordpress&q=link:http://to.be.replaced.com/wordpress/\";
}
}
','yes'),(148,'theme_175','
a:1:{
s:13:\"courses_image\";s:37:\"http://to.be.replaced.com/files/image.png\";
}
','yes') 
```

如果我的`$search`. 我试过转义句号，即`domain\.to\.be\.replaced`，但这没有用。我可能是以一种非常迂回的方式来做这件事，或者遗漏了一些明显的东西。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:16:56.733

由于其中包含变量，因此无需评估 ( `eval`) 您的正则表达式。此外，为了避免这些变量的元字符的特殊含义，例如，使用函数`$search`转义它们或包括正则表达式之间和内部的变量。所以而不是：`quotemeta()``\Q``\E`

```
my $regex = eval { "s\:([0-9]+)\:\\\"(https?\://.*)($search.*)\\\"" }; 
```

利用：

```
my $regex = qr{s\:([0-9]+)\:\\\"(https?\://.*)(\Q$search\E.*)\\\"}; 
```

或者

```
my $quoted_search = quotemeta $search;
my $regex = qr{s\:([0-9]+)\:\\\"(https?\://.*)($quoted_search.*)\\\"}; 
```

这条线也有同样的建议：

```
$str =~ eval { s/$search/$replace/ }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T23:18:00.263

`\`您必须将`$search`变量中的转义字符加倍，以使插值字符串包含转义句点。

即`domain\.to\.be\.replaced`-> `domain.to.be.replaced`（不想要）

而`domain\\.to\\.be\\.replaced`-> `domain\.to\.be\.replaced`（正确）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-28T15:51:20.123

我不确定您的 perl 正则表达式是否会替换与旧 DNS 匹配数倍的字符串中的 DNS（在同一序列化字符串中）。

对于同样的问题，我使用 bash、sed 和一个大的 perl 正则表达式编写了一个脚本的要点。你可以[试一试](https://gist.github.com/regilero/5885056)。

我使用的正则表达式是这样的（为了便于理解而爆炸，并且 -7 作为域名长度之间的已知差异）：

```
perl -n -p -i -e '1 while s#
  ([;|{]s:)
  ([0-9]+)
  :\\"
  (((?!\\";).)*?)
  (domain\.to\.be\.replaced)
  (.*?)
  \\";#"$1".($2-7).":\\\"$3new.domain.tld$6\\\";"#ge;' file 
```

这可能不是最好的，但至少它似乎可以胜任。该`g`选项管理包含要清理的多个序列化字符串的行，并且`while`循环重做整个作业，直到序列化字符串中没有替换发生（对于包含多个 DNS 出现的字符串）。我没有足够的正则表达式来尝试递归。

# vb.net - 使用 Vb.Net Com 插件将多行插入 Excel 工作表

> ID：15581152
> 
> 赞同：0
> 
> 时间：2013-03-22T22:57:03.463
> 
> 标签：vb.net, excel-2010, excel-addins

在确定 Excel 工作表 InsertRow 的行索引后，我想使用 VB.net 在其后插入 16 行。如果有任何改变，我正在构建一个 COM 加载项。在 VBA 中，我将通过以下方式执行此操作：

```
 ...
 Dim InsertRow as String
 ...
 Dim ContractForm As Worksheet
 Set ContractForm = Sheets("Lab Contracts")
   ContractForm.Select
   ContractForm.Rows(InsertRow & ":" & InsertRow).Select
   Range(Selection, Selection.Offset(8, 0)).EntireRow.Insert 
```

我似乎找不到在 VB.net 中执行此操作的方法。我已经尝试过：[对于 (InsertRow ":" InsertRow) 的所有实例，我还尝试过 ("47:47") 和 (InsertRow)，以防语法不正确（反之亦然）。

```
 ...
  ContractSheet.Rows(InsertRow ":" InsertRow).Select()
  ContractSheet.Rows.Insert()
  ... 
```

和 ContractSheet.Rows("47:47").Select() ContractSheet.Range("47:47").EntireRow.Insert() 和 ContractSheet.Rows(InsertRow).Select() 对于 n = 1 到 16 ContractSheet。 Range(InsertRow & ":" & InsertRow).rows.insert(xlDown) Next and ContractSheet.Rows(InsertRow).Select() For n = 1 To 16 ContractSheet.Selection.Insert() Next

我可以继续，但我认为这不会有帮助（因为我一直在一个问题上尝试了一个多小时，然后才在这里提问）。根据它的进展情况，我会收到以下错误之一：

H结果：0x800A03EC；或者

HResult 0x80020005; 或者

无法将对象从工作表中筛选出来。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T02:48:23.407

最好[避免使用 Select 语句](https://stackoverflow.com/q/10714251/293078)，除非您必须且您不必在这里。所以，只是为了重新奠定基础，在 VBA 中你应该这样做：

```
Sub test()
Dim InsertRow As Long
Dim ContractForm As Worksheet

InsertRow = "5"
Set ContractForm = Sheets("Lab Contracts")
ContractForm.Rows(InsertRow).Resize(8).Insert xlShiftDown
End Sub 
```

在 VB.Net 中几乎是一样的。（而且我猜在 VB 或 VBA 中都不需要 xlShiftDown 参数）：

```
Imports Microsoft.Office.Interop

Sub test()
    Dim ContractForm As Excel.Worksheet
    Dim InsertRow As Int32

    ContractForm = Application.ActiveWorkbook.Worksheets("Lab Contracts")
    InsertRow = 5
    ContractForm.Rows(InsertRow).Resize(8).insert() '(Excel.XlInsertShiftDirection.xlShiftDown)
End Sub 
```

# javascript - firebug 中的 CSS 选择器

> ID：15581154
> 
> 赞同：-2
> 
> 时间：2013-03-22T22:57:14.387
> 
> 标签：javascript, css, firebug

是否有一个 JavaScript API 可以传递我想要的任何 CSS 选择器？

我问的原因是我想在 firebug 的控制台中运行一些 JavaScript，看看 CSS 各种选择器会返回什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:01:20.870

您可以使用[`getComputedStyle()`](https://developer.mozilla.org/En/DOM%3awindow.getComputedStyle)：

> getComputedStyle() 给出元素所有 CSS 属性的最终使用值。

例如： `window.getComputedStyle(document.getElementById('header'));`

# php - Symfony 异步流的可能性

> ID：15581155
> 
> 赞同：1
> 
> 时间：2013-03-22T22:57:29.737
> 
> 标签：php, asynchronous, stream, server-sent-events

如何在不请求数据库的情况下在客户端获取信息？

该示例将是一个简单的聊天应用程序。两个客户端登录到一个流，比如聊天室。填写表格，通过 ajax 将信息发送到数据库。另一个无需请求即可获得它，例如从数据库中的事件侦听器推送。

那可能吗？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:17:22.940

可以像 nodejs 一样使用 PHP 实现非阻塞 I/O。见：[http ://reactphp.org/](http://reactphp.org/)

如果您只是想制作一个实时聊天应用程序，我仍然会说 PHP 可能不是适合这项工作的工具。这就是 nodejs 擅长的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:09:55.753

HTTP 层不支持您希望完成的任务。[您可以在此 Stackoverflow 页面](https://stackoverflow.com/questions/1480257/http-persistent-connection-vs-tcp-socket-connection)中找到有关此内容的更多信息。

您可能想要使用[node.js](http://nodejs.org/)和[socket.io](http://socket.io/)。你也可以试试这个关于[使用 node.js 和 socket.io 创建聊天系统的](http://psitsmike.com/2011/09/node-js-and-socket-io-chat-tutorial/)教程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-01T19:28:07.513

您可以在 Node.js 等服务器中传递内存中的信息。

聊天消息将使用 AJAX POST 上传并通过活动的 SSE 连接分发给其他客户端（您必须跟踪它们，例如在数组中）。

但是，如果没有数据库，您就没有消息的持久性。如果在客户端断开连接时丢失消息是可以的，那很好，但在聊天的情况下，用户可能希望在离线时收到积压的消息。

# c++ - C++ 从图像中读取信息

> ID：15581158
> 
> 赞同：-1
> 
> 时间：2013-03-22T22:57:50.433
> 
> 标签：c++, image, binary

我必须从图像中读取一些信息。当我将 .tif 图像拖到 Visual C++ 2006 中时，它显示如下： ![在此处输入图像描述](../Images/66eb4b1fb0b07b0ecb0299d7a8199e5c.png) 我正在尝试读取时间图像右侧指定的最小值和最大值（以黄色突出显示）。我怎样才能做到这一点？从文件中读取时，我通常会这样做：

```
ifstream fileStream(file_name); 
string contents;
while(fileStream >> contents) //do something
fileStream.close(); 
```

但是，当我用给定的图像尝试这种方法并在读入信息后立即尝试计算内容时，打印出来的只是：

```
contains = MM 
contains =
contains = 
```

显然，它不起作用。它只读取一次信息，并在 3 次迭代后停止读取。

那么，我怎样才能从图像中获取最大值和最小值呢？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:59:26.733

您的示例代码适用于读取文本文件，但您的 TIFF 文件（大部分）是二进制文件。所以你要做的第一件事是以二进制模式打开文件。

```
std::ifstream fileStream(file_name, std::ios::binary); 
```

-style 提取器`<<`适用于格式化文本，但不适用于二进制文件。

您需要了解文件格式才能确定文件中的哪个位置可以找到您所追求的值。我不知道有关 TIFF 的详细信息，因此您必须找到参考。它可能涉及读取头文件（例如，`fileStream.read(buffer, size)`），查找头文件中的偏移量，移动到文件中的那个位置（例如，`filestream.seekg(offset, ios::beg)`），然后解释那个位置的字节。

这是一个[关于 C++ 文件处理的不错的教程](http://www.cplusplus.com/doc/tutorial/files/)。确保您阅读了名为**Binary Files**的部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:15:53.637

尝试使用`fscanf()`.

```
#include <cstdio>

FILE * file = fopen("filename.tiff","r");

char c;
fscanf(file,"%c",&c); 
```

这将从文件中读取一个字节。通过这种方式反复调用`fscanf()`，可以读取文件，在min的情况下查找字节'm'、'i'和'n'。一旦你找到了这个，你就可以使用

```
int num;
fscanf(file,"%d",&num); 
```

读取下一次出现的*文本*数字（以 ASCII 或其他编码而不是二进制形式编写的数值。

[可以在此处找到](http://www.cplusplus.com/reference/cstdio/fscanf/)有关 fscanf 功能的完整参考。

# android - 进度条 9patch 图像水平刻度

> ID：15581161
> 
> 赞同：0
> 
> 时间：2013-03-22T22:58:03.463
> 
> 标签：android

我正在为我的进度条的自定义进度填充使用 9patch 图像。图像显示在进度条中，但问题是图像为 20px，进度条高度为 50px，最后 30px 为黑色。我可以让我的 9patch 图像增长到适合进度条的高度吗？这是我的 android:progressDrawable

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

<item android:id="@android:id/background">
    <shape>
        <solid android:color="#333333" />
    </shape>
</item>
<item android:id="@android:id/progress">
    <bitmap
        android:gravity="fill_vertical"
        android:src="@drawable/test_progress" />
</item> 
```

这是我的形象 ![9补丁](../Images/8787459ddabeb3abc6e4c5e4ee0386aa.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:54:50.307

> 我可以让我的 9patch 图像增长到适合进度条的高度吗？

是的，您只需要在 9 补丁的垂直部分定义可拉伸区域（这需要在图像的左边框上有一条 1 像素宽的实线）。一开始有点混乱，所以我建议你阅读一些文档来帮助你理解它。

9 个补丁文档 - [http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch](http://developer.android.com/guide/topics/graphics/2d-graphics.html#nine-patch)

创建/预览 9 个补丁 - [http://developer.android.com/tools/help/draw9patch.html](http://developer.android.com/tools/help/draw9patch.html)

# django - Django admin 的 Django 和 MongoDB 问题

> ID：15581163
> 
> 赞同：1
> 
> 时间：2013-03-22T22:58:16.123
> 
> 标签：django, mongodb, django-admin, django-nonrel

我正在尝试将 MongoDB 与 Django 的管理系统集成（[根据 mongodb 网站上的 Tumblelog 教程，](http://docs.mongodb.org/manual/tutorial/write-a-tumblelog-application-with-django-mongodb-engine/)当我尝试时遇到错误`python manage.py syncdb`- 它给了我这个错误 - 我不完全确定该怎么做。谢谢！

```
pymongo.errors.OperationFailure: command SON([('create', u'auth_permission'), ('max', False), ('capped', False), ('size', 0.0)]) failed: exception: create collection invalid size spec 
```

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:36:49.880

好像权限应用有问题，尝试添加`djangotoolbox`给你`settings.py`。

NoSQL 的性质与 django ORM 不兼容，也不兼容`auth`它们`permission`依赖于`JOINS`协同工作的应用程序。

无论如何，你见过[django-nonrel](http://django-nonrel.org/)吗？django-nonrel 提供了更多的应用程序和解决方案来使用 MongoDB 和其他 NoSQL 数据存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-25T03:08:13.757

看到这个链接：[https ://github.com/django-nonrel/mongodb-engine/pull/134](https://github.com/django-nonrel/mongodb-engine/pull/134)

主要问题是对于具有无上限大小的集合，设置一个较大的上限大小，而不是这样后续命令不会失败。

我假设您使用的是 django-nonrel 1.3.1。我从 django-nonrel/mongodb-engine 分叉并在[https://github.com/statguyjames/mongodb-engine.git@master](https://github.com/statguyjames/mongodb-engine.git@master)中进行了修复。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-05T13:58:35.200

首先，我通过完全替换 sql_create_model() 方法尝试了 statguy 的解决方案 - 但它不起作用，一些错误不断出现。

然后我所做的是我添加了

```
size = getattr(model._meta, 'collection_size', None)
if size is not None:
    kwargs['size'] = size
else:
    kwargs['size'] = 10000000000 
```

紧接着

```
for option, mongo_option in [
        ('capped', 'capped'),
        ('collection_size', 'size'),
        ('collection_max', 'max')
    ]:
        kwargs[mongo_option] = getattr(model._meta, option, False) 
```

在 django_mongodb_engine 的文件 creation.py 中。

这样错误就不再出现了。然而，由于这个巨大的价值，mongo 将分配磁盘上的一些文件，这些文件基本上将我当前的数据库从几 MB 变成了大约 17GB - 以分配新文件的错误结束。

非常小心地执行一个值。不过，我可能会遗漏一些东西。

# objective-c - Objective C - 为什么 64 位意味着不同的变量类型

> ID：15581169
> 
> 赞同：3
> 
> 时间：2013-03-22T22:59:03.577
> 
> 标签：objective-c, nsinteger

我听说人们使用 NSInteger 或 CGFloat 等类型而不是 int 或 float 是因为与 64 位系统有关。我仍然不明白为什么这是必要的，即使我在自己的代码中都这样做了。基本上，为什么 64 位系统需要更大的整数？

人们还说目前在 iOS 中没有必要，尽管将来可能需要 64 位 iphone 等。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T23:02:15.280

这一切都在这里解释：

[64 位转换指南简介](https://developer.apple.com/library/mac/#documentation/Darwin/Conceptual/64bitPorting/intro/intro.html)

在主要 64 位更改部分中：

![在此处输入图像描述](../Images/1453132ce7d8866eb31bbb4bfb3e4422.png)

> **数据类型大小和对齐方式**
> 
> OS X 使用两种数据模型：ILP32（其中整数、长整数和指针是 32 位量）和 LP64（其中整数是 32 位量，长整数和指针是 64 位量）。其他类型等价于它们的 32 位对应物（除了 size_t 和一些基于长整数或指针的大小定义的其他类型）。
> 
> 虽然几乎所有 UNIX 和 Linux 实现都使用 LP64，但其他操作系统使用各种数据模型。例如，Windows 使用 LLP64，其中 long long 变量和指针是 64 位的量，而 long 整数是 32 位的量。相比之下，Cray 使用 ILP64，其中 int 变量也是 64 位量。
> 
> 在 OS X 中，用于数据结构布局的默认对齐方式是自然对齐方式（下面会提到一些例外情况）。自然对齐意味着结构中的数据元素以对应于底层数据类型宽度的间隔对齐。例如，一个 4 字节宽的 int 变量将在 4 字节边界上对齐。

您可以在本文档中阅读更多**内容。**它写得很好。我强烈推荐给你。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-22T23:25:35.517

本质上归结为：如果您使用 CGFloat/NSInteger/etc，Apple 可以进行向后不兼容的更改，您可以*通过*重新编译代码来更新您的应用程序。你真的不想通过你的应用程序，检查每次使用`int`and `double`。

有哪些向后不兼容的变化？很多！

*   M68K 转 PowerPC
*   64 位 PowerPC
*   PowerPC 到 x86
*   x86-64（我不确定这是在 iOS 之前还是之后。）
*   iOS

`CGFloat`表示“CoreGraphics”使用的浮点类型：`double`在 OS X 和`float`iOS 上。如果您使用`CGFloat`，您的代码将在两个平台上运行，而不会不必要地损失性能（在 iOS 上）或精度（在 OS X 上）。

`NSInteger`并且`NSUInteger`不太明确，但它们大约用于您可能使用的地方`ssize_t`或`size_t`标准 C 中。`int`或者`unsigned int`在 64 位 OS X 上根本不够大，您可能有一个包含超过 20 亿个项目的列表。（由于定义的方式，未签名不会将其增加到 40 亿`NSNotFound`。）

# openssl - “文件存在”错误是什么意思？

> ID：15581176
> 
> 赞同：0
> 
> 时间：2013-03-22T22:59:55.297
> 
> 标签：openssl, dtls

调用 DTLSv1_listen()，返回 0。

然后使用 SSL_get_error() 检索错误。

```
SSL_error = SSL_ERROR_SYSCALL
errno = 17: "File exists" 
```

这是什么意思？存在什么文件？

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:32:58.503

如果您提供更多上下文，那就太好了。但是简短的谷歌搜索导致了这段代码和评论： http: [//fossies.org/unix/misc/postgresql-9.2.3.tar.gz/dox/fe-secure_8c_source.html](http://fossies.org/unix/misc/postgresql-9.2.3.tar.gz/dox/fe-secure_8c_source.html) （第1085行）

```
1982          /*
1083          * Cert file exists, so load it.  Since OpenSSL doesn't provide the
1084          * equivalent of "SSL_use_certificate_chain_file", we actually have to
1085          * load the file twice.  The first call loads any extra certs after
1086          * the first one into chain-cert storage associated with the
1087          * SSL_context.  The second call loads the first cert (only) into the
1088          * SSL object, where it will be correctly paired with the private key
1089          * we load below.  We do it this way so that each connection
1090          * understands which subject cert to present, in case different
1091          * sslcert settings are used for different connections in the same
1092          * process.
1093          */ 
```

# r - 以正常（非科学）格式写入大整数

> ID：15581178
> 
> 赞同：0
> 
> 时间：2013-03-22T22:59:59.727
> 
> 标签：r, printing, integer

右侧有许多 0 的大整数会在任何类型的输出（在屏幕上打印、写入文件等）中自动转换为科学格式：

```
foo <- 100000
foo 
# [1] 1e+05
write.table(foo)
print(foo)

foo <- foo + 1
foo
# [1] 100001 
```

如何防止这种自动转换，到处都用整数打印大整数？我不是在寻找一种每次都必须记住的答案。

# jquery - 使用 jquery 的网格组合？

> ID：15581180
> 
> 赞同：-1
> 
> 时间：2013-03-22T23:00:08.820
> 
> 标签：jquery

我只是想知道我怎样才能做这种类型的网格组合，效果很好。选项卡更改时触发的效果。

> [http://adammunns.com/grid-portfolio/](http://adammunns.com/grid-portfolio/)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:05:33.040

添加一个覆盖您的图像的覆盖 div（不透明度）。现在在 jquery 中注册一个 on hover 事件，on over 将动画高度设置为 100%（返回到 0）。

```
img.hover(function() {
  overlay.animate('height', '100%');
}, function() {
  overlay.animate('height', 0);
}); 
```

当然要捕捉正在进行的动画（停止当前），这样当你快速悬停几次时它就不会循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:34:34.043

我没有对此进行测试，但以下似乎是您的示例站点中的相关 jQuery：

```
// filter items when filter link is clicked
var selectors = [];

$j('#filters a').click(function(e){
    e.preventDefault();

    var selector = $j(this).attr('data-filter');

    $j('#filters li').removeClass('active');
    $j(this).parent().addClass('active');
    $container.isotope({ filter: selector });
});

var box = $j('.pboxgraphic');
var hover = 'span.hover,span.hover_solid,.pboxtext';

if( $j('#projects').hasClass('fade') ) {
    box.mouseenter(function(el) {
        $j(this).find(hover).stop().fadeIn("fast");                             
    });

    box.mouseleave(function(el) {
        $j(this).find(hover).stop().fadeOut("fast");                                                                
    });
} else {
    box.mouseenter(function(el) {
        $j(this).find(hover).stop().slideToggle("fast");                                
    });

    box.mouseleave(function(el) {
        $j(this).find(hover).stop().slideToggle("fast");                                                                
    });
} 
```

# ios - UIViewController 的视图在呈现后立即改变尺寸

> ID：15581185
> 
> 赞同：0
> 
> 时间：2013-03-22T23:00:44.933
> 
> 标签：ios, ipad, uiviewcontroller

我希望仅在笔尖中显示视图控制器的视图，但是当我调用 presentModalViewController:animated: 时，尺寸正在改变：如以下代码所示：

```
CGRect frame = viewController.view.frame;
NSLog(@"%f %f %f %f", frame.origin.x, frame.origin.y, frame.size.width, frame.size.height); 

[self presentModalViewController:viewController animated:YES];

frame = viewController.view.frame;
NSLog(@"%f %f %f %f", frame.origin.x, frame.origin.y, frame.size.width, frame.size.height); 
```

输出：

```
0.000000 0.000000 297.000000 452.000000
0.000000 0.000000 540.000000 620.000000 
```

是什么导致了这种变化，我能做些什么来防止它？

我知道我可以插入

```
viewController.view.superview.frame = frame; 
```

演示后立即，但这似乎是一个黑客。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:06:33.177

正如您在 developer.apple 讨论中看到的`presentModalViewController:animated:`

**讨论**

将 modalViewController 属性设置为指定的视图控制器。**调整**其视图的大小并将其附加到视图层次结构。视图根据 modalViewController 参数中控制器的 modalTransitionStyle 属性中指定的过渡样式进行动画处理。

# android - Android相机预览映射到最终图片

> ID：15581187
> 
> 赞同：9
> 
> 时间：2013-03-22T23:00:57.637
> 
> 标签：android, camera, mapping, image, preview

我们一直在构建一个自定义的 Android 相机 Activity，其中一个矩形覆盖在相机预览中，当拍摄照片时（按下按钮），我们想要裁剪最终图像的相应矩形区域。问题是我们还没有弄清楚android是如何将预览屏幕映射到最终图像的。

我们尝试了以下公式，但仅在某些情况下有效：

让 x 和 y 为矩形左上角的坐标，如相机预览中所示。

让 preview_width 和 preview_height 为相机预览的宽度和高度。这些是使用 getBestPreviewSize() 函数获得的，该函数循环支持的预览尺寸并选择较大的。假设它们是 1280 和 720。

令 picture_width 和 picture_height 为相机支持的最终图片的宽度和高度。出于我们的目的，假设这是 1632 * 1224（在索尼爱立信 XPERIA 上，这对应于 2 MP）。

我们要找到 x_map, y_map，它们是最终图像的裁剪矩形的 x 和 y。

然后根据类比规则，我们使用的公式是：

x_map = 图片宽度 * x / 预览宽度；y_map = 图片高度 * y / 预览高度；

但是，这似乎并不适用于所有情况。我们发现，当手机的屏幕尺寸与预览尺寸相近时，这个公式几乎可以工作（大约，有一点误差）。

然而，对于其他情况，如索尼 XPERIA 手机，屏幕尺寸为：宽度：480 和高度：854，公式失败。

例如，对于 x=50，则 x_map = 1632 * 50 / 1280 = 63.75 但是这个数字，如从最终图片中裁剪的矩形区域所示，并不真正对应于预览区域中的矩形。很遥远。我们的公式没有考虑屏幕尺寸，尽管尝试修改它以考虑它们，但并没有产生任何理想的结果。

我们怀疑预览尺寸和最终图片之间的映射以某种方式考虑了屏幕尺寸，但还没有弄清楚到底是多少，因为没有关于它的文档，并且在网络上广泛搜索答案后，没有任何相关信息出现。我们认为，在应用类比规则之前，我们需要考虑一定的比例因子和纵横比，才能使公式正常工作。

你知道上面的正确公式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-12T02:00:00.987

首先，获取返回的最大图片尺寸`Camera.getSupportedPictureSizes`- 这是您的相机的原始分辨率，您可以从中确定原始纵横比。任何具有不同纵横比的图片尺寸或预览尺寸都将根据“Matrix.ScaleToFit.CENTER”进行裁剪。

另请参阅： [https ://stackoverflow.com/a/18159351/994834](https://stackoverflow.com/a/18159351/994834)

# c# - 从 Metro 风格应用程序中的页面导航返回后会调用哪个方法？

> ID：15581197
> 
> 赞同：0
> 
> 时间：2013-03-22T23:01:49.420
> 
> 标签：c#, .net, xaml, windows-8, microsoft-metro

在 Metro 应用程序中，从 pageA 导航到 pageB 在 pageA`this.Frame.Navigate(typeof(pageB))`中使用，并且在 pageB 中`this.Frame.GoBack()`使用返回导航。

用户从 pageB 返回后，首先调用 pageA 的哪个方法？

我正在寻找类似`onActivityResult`android的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:24:37.630

PageA 的构造函数是第一个被触发的方法

```
 public sealed partial class PageA : App1.Common.LayoutAwarePage
 {
    public PageA()
    {
        //this is the first code to be fired
    }
  } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-24T04:52:32.453

为了使答案更加丰富多彩 - 当 pageA 的默认`NavigationCacheMode`值为时，首先调用构造函数`Disabled`，但在其他情况下可能/根本不会调用它，实际上可能值得将其设置为 NavigationCacheMode 至少暂时`Enabled`如果您希望快速返回该页面。

更确定的是处理[OnNavigatedTo](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.page.onnavigatedto.aspx)并从那里获取导航参数对象。只要确保你没有传递比短字符串或其他基本类型之一更复杂的东西（字节、Int16、Uint16、Int32/int、UInt32、Int64、UInt64、Single/float、Double、Char、Boolean、String , Guid[似乎受支持](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/9c814f6c67c5#WinRTXamlToolkit/Controls/AlternativeFrame/AlternativeFrame.cs)`Frame`），否则当您想在应用程序停用时保存状态并调用[Frame.GetNavigationState()](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.frame.getnavigationstate.aspx)保存时，您将无法使用控件的内置状态保存机制（`LayoutAwarePage`这样做）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-24T04:16:58.633

我同意 Theo Kouzelis 的观点，构造函数是第一个被解雇的方法。然后是 onNavigatedTo();

但是，如果您希望根据 pageB 上的结果在 pageA 上执行某些任务，则必须创建一个静态对象来保存值。

# spss - 为 manova 运行时出现 SPSS 错误

> ID：15581199
> 
> 赞同：1
> 
> 时间：2013-03-22T23:01:54.383
> 
> 标签：spss, two-way

我一直在使用 SPSS 时遇到问题。当我尝试运行数据集时，它说：

```
>Error # 12005 in column 14\.  Text: -4
>A parenthesized value range in the MANOVA procedure contains a lower limit
>(the first value) that is greater than the upper limit (the second value).
>Execution of this command stops. 
```

这是我试图运行的语法：

```
manova P_Progress, P_ObsComp, P_SocFdBk, P_PsyState
by Group4 (1,2,3,4) Group3 (1,2,3)/
print=cellinfo(means)
     homogeneity(all)
     error(cor)
     signif(multiv,univ,stepdown)/
omean=variables(P_Progress, P_ObsComp, P_SocFdBk, P_PsyState) tables(Group4, 
Group3)/plot=normal. 
```

我正在研究一种双向manova。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T06:16:36.690

我建议查阅有关 MANOVA 的 IBM SPSS Statistics Syntax Reference。MANOVA 的语法应该是这样的：

```
MANOVA dependent varlist [BY factor list (min,max)[factor list...]
[WITH covariate list]] 
```

我相信这段代码应该可以工作：

```
manova P_Progress, P_ObsComp, P_SocFdBk, P_PsyState
    by Group4 (1,4) Group3 (1,3)
  /print = cellinfo(means)
    homogeneity(all)
    error(cor)
    signif(multiv,univ,stepdown)
  /omean = variables(P_Progress, P_ObsComp, P_SocFdBk, P_PsyState)
    tables(Group4, Group3)
  /plot=normal. 
```

# java - 如何在 Eclipse 上运行 Maven 单元测试（testng）？

> ID：15581200
> 
> 赞同：6
> 
> 时间：2013-03-22T23:01:58.547
> 
> 标签：java, maven, testng

我有一个 Maven 项目，并且包含了一些单元测试。我可以使用命令行运行这些单元测试

```
mvn test -Dtest=AppTest 
```

它将毫无问题地运行单元测试（AppTest 类）。但是，如果我尝试在 Eclipse 上以 JUnitTest 的身份运行测试，我会收到一条错误消息

```
"No Tests found with test runner 'JUnit 3'" 
```

我知道测试（AppTest）不是 JUnit 测试，但如果我右键单击测试类，我没有看到“maven”选项。

你知道我如何在 Eclipse 上运行测试吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T04:32:44.900

如果这些是 testng 测试，那么您可以下载 TestNG 的 eclipse 插件并右键单击并将它们作为测试类运行。测试插件[在这里](http://testng.org/doc/eclipse.html)

如果你想以命令行方式运行 maven，你需要 Maven 插件 for eclipse from [here](http://download.eclipse.org/technology/m2e/releases) 然后你可以右键单击你的项目，你应该会看到一个 Run As -> Maven Test 选项。您需要在 pom 的 surefire 插件中设置相关参数或使用运行配置来指定参数，就像您在 -Dtest 中所做的那样

我建议使用 testng 插件，它可以更简单地选择类并运行该类或单个案例甚至一个包。

# .htaccess - 只有一页

> ID：15581204
> 
> 赞同：2
> 
> 时间：2013-03-22T23:02:32.223
> 
> 标签：.htaccess, fileshare

我需要只有主页有以下文件匹配，其中 .pdf 文件需要在打开之前询问，但网站中的其他 .pdf 文件（不在主页上）我想自动打开。这是实现这一目标的最佳方法吗？

这是一个Wordpress网站，最新版本，首页是一个设置页面。此外，该站点的所有者可以在站点内添加更多 .pdf 链接，因此我不想让它过于复杂，因为她每次添加文件时都必须操作代码。

这是我的 .htaccess 文件中当前的内容：

```
# Use PHP5 as default
AddHandler application/x-httpd-php5 .php
ErrorDocument 404 /index.php
ErrorDocument 403 /index.php

#BEGIN WordPress

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

RewriteEngine On 
RewriteCond %{SERVER_PORT} 80 
RewriteRule ^(.*)$ https://www.dramanotebook.com/$1 [R,L]

<Files 403.shtml>
order allow,deny
allow from all
</Files>

<FilesMatch "\.pdf$">
ForceType applicaton/octet-stream
Header set Content-Disposition attachment
</FilesMatch>

# END WordPress 
```

在此先感谢，吉姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T03:49:25.760

我能够通过使用`<Files></Files>`.

例子：

```
<Files "filenameexample.pdf">
ForceType applicaton/octet-stream
Header set Content-Disposition attachment
</Files> 
```

诀窍是您需要为`<files></files>`要单独控制的每个文件添加一个。没有选项可以说“此页面上的所有 PDF 都受到保护，但其他页面执行其他操作”。实际上，您可以..但是您必须在每个文件夹中放置一个 .htaccess 文件才能将其“还原”回这些扩展名的另一种方式。疯狂的。更快地完成我特别需要的 3 个文件。

我发现网上的信息都没有帮助，也没有任何回应。我只是测试了很多。

吉姆

# c - Gwan kv，持久标志/项目数

> ID：15581206
> 
> 赞同：0
> 
> 时间：2013-03-22T23:02:42.450
> 
> 标签：c, key-value, ram, g-wan

我决定使用 Gwan 的 KV 存储来代替 Redis NoSQL 数据库。我在手册中看到 kv 支持文件 IO 的持久标志，以保持我猜在重新启动之间的数据。它使用回调recfn，但是如何格式化该函数以将KV保存到文件中，我理解C文件IO只是没有完全接口此回调并将数据格式化为文件，然后重新加载它的反向Gwan开始时进入KV。

我还注意到您可以设置 kv 将拥有的项目数。如何设置，以便在技术上没有限制，所以可以不断添加东西，直到你用完 ram

多谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T10:51:41.580

回调是用户定义的`recfn`，允许您决定数据将存储在磁盘上的格式（纯文本、格式化、索引、压缩、分发等）。

我们认识到一个专门的示例肯定会有所帮助，感谢您指出这一点。

您可以在创建键值存储时指示的项目数量只是旨在使用适当的内存分配策略的提示 - 它实际上并不限制不断增长的存储的大小。

# matlab - 评估任意计数的直线度

> ID：15581208
> 
> 赞同：0
> 
> 时间：2013-03-22T23:02:55.390
> 
> 标签：matlab, image-processing, computer-vision, line, contour

我想在我的二进制图像中获得轮廓直线度的度量（**相对更快**）。图像如下所示：

![轮廓](../Images/b20136cafa64ee139d656290bc705176.png)

现在，红色框中的轮廓是我希望最好删除的轮廓。因为他们不是直的。这些是我尝试过的事情。我现在在 MATLAB 中实现。

1.收集每个轮廓的行列坐标，然后求导。对于直线对象（例如矩形），导数大多较低，带有一些尖峰（沿着矩形的角）。

问题：收集的坐标不是按顺序排列的，即如果我们将轮廓成像为路径，将按照该顺序遍历轮廓。因此，导数有时会给出高得离谱的值。另外，轮廓不是绝对笔直的，它是边缘检测算法的输出，所以你可以想象可能会有一些不连续（见底部的矩形，人眼可以理解它是一个矩形，虽然它不是绝对笔直的）。

2.试图考虑polyfit，但又出现了这个轮廓问题。由于它是一个矩形，我不知道如何将 polyfit 应用于该点集。

另外，我想删除垂直/水平分布的轮廓。基本上这是一种车道检测算法。所以车道不能绝对垂直/水平。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T03:57:50.793

您应该研究`regionprops`更多的功能。公平地说，我从[这个答案](https://stackoverflow.com/questions/6317029/matlab-filtering-labeled-matrix-according-to-regionprops)中偷了脚本，但它是：

```
BW = imread('lanes.png');
BW  = im2bw(BW);
figure(1),
subplot(1,2,1);
imshow(BW);

cc = bwconncomp(BW);
l = labelmatrix(cc);

a_rp = regionprops(CC,'Area','MajorAxisLength','MinorAxislength','Orientation','PixelList','Eccentricity');
idx = ([a_rp.Eccentricity] > 0.99 & [a_rp.Area] > 100 & [a_rp.Orientation] < 70 & [a_rp.Orientation] > -90);

BW2 = ismember(l,find(idx));

subplot(1,2,2);
imshow(BW2); 
```

你可以弄乱属性。`'Orientation'`, `'Eccentricity'`, 并且`'Area'`可能是您想要处理的参数。我还弄乱了长轴/短轴长度的比率，但偏心率基本上是这样做的（偏心率是衡量椭圆“圆形”程度的指标）。这是输出：

![在此处输入图像描述](../Images/867043fba280cbe2448fe980e065d4ba.png)

我实际上看到了一个很好的视频，专门来自 matlab 用于使用`regionprops`. 我会尝试看看我是否可以找到它并链接它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T03:58:06.953

您可以使用 分割图像[`bwlabel`](http://www.mathworks.com/help/images/ref/bwlabel.html)，然后使用 分别处理每个`bwlabel`连接的对象`find`。这应该有助于解决您的订单问题。

关于度量，目前唯一想到的就是拟合椭圆，并将`a/b`（长轴/短轴）比率（基本上是偏心率）设置为参数。例如，一条直线（即使不是完美的）将被拟合到一个长轴非常大而短轴非常小的椭圆。[因此，假设您将比率阈值设置为 >10 等...例如，可以使用此FEX 提交](http://www.mathworks.com/matlabcentral/fileexchange/3215-fitellipse)来拟合椭圆。

# c++ - 二叉树插入方法

> ID：15581211
> 
> 赞同：2
> 
> 时间：2013-03-22T23:03:15.743
> 
> 标签：c++

对于类，我必须创建一个二叉树，我似乎无法让插入方法正常工作。

预期成绩：

```
first: tree is not empty
        no of nodes    = 15
        height of tree =  5

The elements of 'first' in inorder:
        -11 8 -3 12 -1 -9 -5 2 16 10 6 -13 4 14 -7
The elements of 'first' in preorder:
        2 -1 -3 8 -11 12 -5 -9 4 6 10 16 -13 -7 14
The elements of 'first' in postorder:
        -11 8 12 -3 -9 -5 -1 16 10 -13 6 14 -7 4 2

second: tree is not empty
        no of nodes    =  9
        height of tree =  4

The elements of 'second' in inorder:
        7 3.25 0.75 -7.75 -0.5 -11.5 4.5 -4 8.25
The elements of 'second' in preorder:
        -0.5 0.75 3.25 7 -7.75 -4 4.5 -11.5 8.25
The elements of 'second' in postorder:
        7 3.25 -7.75 0.75 -11.5 4.5 8.25 -4 -0.5

third: tree is not empty
        no of nodes    =  7
        height of tree =  4

The elements of 'third' in inorder:
        objects. list is string This of a
The elements of 'third' in preorder:
        This is list objects. string a of
The elements of 'third' in postorder:
        objects. list string is of a This 
```

我的结果：

```
first: tree is not empty
       no of nodes    = 15
       height of tree = 4
The elements of 'first' in inorder:
-9 -5 4 16 -1 -13 10 -7 2 14 8 6 -3 -11 12
The elements of 'first' in preorder:
2 -1 4 -5 -9 16 -7 10 -13 -3 6 8 14 12 -11
The elements of 'first' in postorder:
-9 -5 16 4 -13 10 -7 -1 14 8 6 -11 12 -3 2
second: tree is not empty
       no of nodes    = 9
       height of tree = 3
The elements of 'second' in inorder:
-7.75 -4 0.75 -11.5 8.25 -0.5 7 4.5 3.25
The elements of 'second' in preorder:
-0.5 0.75 -4 -7.75 8.25 -11.5 3.25 4.5 7
The elements of 'second' in postorder:
-7.75 -4 -11.5 8.25 0.75 7 4.5 3.25 -0.5
third: tree is not empty
       no of nodes    = 7
       height of tree = 3
The elements of 'third' in inorder:
string a is This objects. of list
The elements of 'third' in preorder:
This is a string list of objects.
The elements of 'third' in postorder:
string a is objects. of list This 
```

代码：

```
template <class T>
void binTree<T>::insert(binTreeNode < T >*& node, const T& data) {
        if(node == NULL) {
                root = new binTreeNode<T>(data, NULL, NULL);
                return;
        }

        binTreeNode<T>* ptr1 = node;
        binTreeNode<T>* ptr2 = node;
        bool placeRight = 0;
        while(ptr1 != NULL) {
                ptr2 = ptr1;
                if(height(ptr1->left) > height(ptr1->right)) {
                        placeRight = true;
                        ptr1 = ptr1->right;
                } else if (height(ptr1->right) > height(ptr1->left)) {
                        placeRight = false;
                        ptr1 = ptr1->left;
                } else {
                        placeRight = false;
                        ptr1 = ptr1->left;
                }
        }

        if(placeRight) {
                ptr2->right = new binTreeNode<T>(data, NULL, NULL);
        } else {
                ptr2->left = new binTreeNode<T>(data, NULL, NULL);
        }
} 
```

驱动程序：

```
const vector<int> A { 1, -2, 3, -4, 5, -6, 7, -8, 9, -10, 11, -12, 13, -14, 15 };
const vector<float> B { 0.5, 1.75, -3, 4.25, 5.50, -6.75, 8, 9.25, -10.5 };
const vector<string> C { "This", "is", "a", "list", "of", "string", "objects." };
int main() {
        binTree<int> intTree = binTree<int>();
        binTree<float> floatTree = binTree<float>();
        binTree<string> strTree = binTree<string>();

        for (std::vector<int>::const_iterator it = A.begin() ; it != A.end(); ++it) {
                intTree.insert(*it);
        }
        intTree.preorder(increase);
        cout << "first: ";
        header(intTree);

        inorder(intTree, "first");
        preorder(intTree, "first");
        postOrder(intTree, "first");
} 
```

显示结果的函数：（应该是正确的）

```
template <class T>
void binTree<T>::inorder(binTreeNode < T >* node, void (*f)(T&))
{
        if (node == NULL) {
                return;
        }
        inorder(node->left,f);
        f(node->data);
        inorder(node->right,f);
}

template <class T>
void binTree<T>::preorder(binTreeNode < T >* node, void(*f)(T&))
{
        if (node == NULL) {
                return;
        }
        f(node->data);
        preorder(node->left, f);
        preorder(node->right, f);
}

template <class T>
void binTree<T>::postorder(binTreeNode < T >* node, void(*f)(T&))
{
        if (node == NULL) {
                return;
        }
        postorder(node->left, f);
        postorder(node->right, f);
        f(node->data);
}

template <class T>
    int binTree<T>::height(binTreeNode <T>* node) const {
    if (node == NULL || ((node->left == NULL) && (node->right == NULL))) {
            return 0;
    }

    int leftSide = height(node->left);
    int rightSide = height(node->right);

    if (leftSide > rightSide) {
            return leftSide + 1;
    } else {
            return rightSide + 1;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T02:13:39.300

您的错误在您的高度方法中。如果您有一个不为空但没有子节点的节点，则返回零。你应该返回 1。

在您的高度方法中更改此条件：

```
if (node == NULL || ((node->left == NULL) && (node->right == NULL))) {
    return 0;
} 
```

到：

```
if (node == NULL) {
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:10:09.523

看来您的向量的符号`A`是向后的。你有`1,-2,3,-4,...`，但正确的解决方案有`-1,2,-3,4,...`. 同样，你`B`是

```
const vector<float> B { 0.5, 1.75, -3, 4.25, 5.50, -6.75, 8, 9.25, -10.5 }; 
```

将此与您说我们期望的元素进行比较：

```
7, 3.25, 0.75, -7.75, -0.5, -11.5, 4.5, -4, 8.25 
```

这些看起来甚至不完全相同。

某处转录错误？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T00:49:55.457

你的 height() 函数是什么？

我认为您误解了 BST 的定义：

```
A. the value of the left child is smaller than the value of root node.

B. the value of the right child is bigger than the value of root node.

C. his left child tree and right child tree are also a BST. 
```

但是通过您的代码：

```
while(ptr1 != NULL) {
            ptr2 = ptr1;
            if(height(ptr1->left) > height(ptr1->right)) {
                    placeRight = true;
                    ptr1 = ptr1->right;
            } else if (height(ptr1->right) > height(ptr1->left)) {
                    placeRight = false;
                    ptr1 = ptr1->left;
            } else {
                    placeRight = false;
                    ptr1 = ptr1->left;
            }
    } 
```

您只需比较节点的高度，而不是比较节点的实际值。

# nservicebus - NServiceBus Distributor 吞吐量许可证限制或 MSMQ 性能地狱？

> ID：15581212
> 
> 赞同：2
> 
> 时间：2013-03-22T23:03:24.507
> 
> 标签：nservicebus, nservicebus-distributor

昨天，在与分销商进行了一些非常有希望的测试后，我申请了额外的预算来购买 NSB（36-80 核）的许可证。

应该提到的是，我们目前正在使用分销商来解决管道问题，而不是真正的商业活动，但这将在以后出现。

今天我非常熟练的同事也开始使用公共汽车，只是由于他的项目性质，他的性能要求比我高得多。所以他的测试需要比分销商目前给我的平均 30-50 msg pr 秒多得多。

无论我们尝试做什么：

1.  更多的工人。
2.  工作人员的更多线程。
3.  分配器上的更多线程。
4.  启用/禁用 DTC
5.  以上所有内容都在概念设置的基本证明中，其中包含仅带有 id 的消息。我们无法获得超过 100 条 msg 分布式公关。其次是工人。

这非常糟糕，因为我已经申请了更多的预算资金，如果我们不能很快获得更好的性能，我们必须放弃这个项目，我们将面临一些严重的麻烦：S。

**问题：**

我们当前使用的开发人员许可证是否存在导致此限制的限制，或者 MSMQ 是否存在严重的性能问题，例如此处所述： http: [//ayende.com/blog/4251/what-am-i-缺少-msmq-perf-问题](http://ayende.com/blog/4251/what-am-i-missing-msmq-perf-issue)。

我在 nservicebus 自己的网站上阅读了很多关于许可证的内容，但没有明确说明对开发人员许可证的限制。

希望有人可以帮助我:)。

**[更新]**

我回到基础并尝试用 NSB 自己的代码示例**ScaleOut**重现问题，只需发送 10000 条消息，看看工人/分销商会如何反应。所以我启动了分发器和 2 个工作人员（每个工作人员有 100 个线程）并猜测**问题再次出现。**

1.  幸运的是，这表明我们没有完全错误地配置我们的 Distributor/Worker 设置。
2.  不幸的是，这意味着我们仍然存在与 Distributor 的性能问题。

然后我想知道这是否真的是这样，并开始运行一些简单的线程，使用 Distributor 和 Workers 调整测试。经过一些尝试，我在示例中获得了高达 400-500 msg pr sec 的吞吐量。这是我发现的：

**观察/解决方案：**

1.  Distributor 需要更多的线程，而不仅仅是 1，但不能太多。现在我正在运行 2 个线程。我启动的工人。
2.  如果我运行 20 或 100 个线程，Workers 通常会具有相同的性能。因此，我没有增加线程数量，而是增加了工作人员的数量，这起到了作用。
3.  如果分发器或工作器上的线程数过多，它们似乎会遇到*MSMQ 事务战斗*，它们会相互阻塞，从而使系统突然阻塞。我可以使用 ScaleOut 示例和我自己的代码轻松重现阻塞，但是 TX 之战只是基于我阅读的文章的疯狂猜测，我不知道这就是正在发生的事情。

**后续问题：**

1.  现在要做什么？我们应该用其他东西替换 MSMQ 还是这个问题是 NSB 内部的问题，可以在以后的版本中优化/修复？
2.  这是 Distributor 的预期工作方式，这意味着我们唯一的解决方案是解雇更多的工人吗？
3.  同一端点上的多个工作人员，但与分发器运行的机器不同，是否不会导致工作人员之间可能再次导致 MSMQ TX 战斗的*竞争消费者情况？*
4.  示例和我们自己的代码之间有一个重要区别，我们禁用了 Raven 订阅存储，并且纯粹在 MSMQ 上运行，但据我所知，分销商不使用 Raven db 进行存储。我错了，这可能是一个获得一些表现的地方吗？

我现在正在做一些分布式测试，看看是否存在在同一台机器上启动多个工作人员的问题，但不是与分发服务器相同的机器。我希望这是可能的，而不必为每个工人设置单独的队列，因为我们已经为工人订购了额外的服务器并且没有更多的预算。

到目前为止，我有点失望，因为我不能简单地增加一个工作线程的数量，然后只从一个工作人员开始，然后扩展到更多机器，每台机器都有 1 个工作人员。现在我被迫在一台机器上有多个工人：/。

如果关于我缺少的经销商/工人有任何小问题，请分享，因为这让我发疯：/。

**[更新 2]**

如果我在 Visual Studio 外部使用 NServiceBus.Integration NServiceBus.Distributor/Worker 运行 ScaleOut 示例，并且只有 1 个工作人员，我可以获得 4-500 msg/sec 的吞吐量。

这很好，但它不能解释我在我们自己的设置中做错了什么，我们是自我托管的。看看我们的配置并告诉我是否有问题：

**经销商：**

```
 var queuePrefix = ConvertFriendlyNameTo.QueueName(AppDomain.CurrentDomain.FriendlyName);

        return NServiceBus.Configure.With()
            .DefineEndpointName(queuePrefix)
            .Log4Net(ObjectFactory.GetInstance<IServiceBusLog>().Build())
            .StructureMapBuilder()
            .JsonSerializer()
            .AsMasterNode()
            .RunDistributorWithNoWorkerOnItsEndpoint()
            .MsmqTransport()
            .IsTransactional(true)
            .DisableTimeoutManager()
            .DisableSecondLevelRetries()
            .UnicastBus()
            .CreateBus()
            .Start(() => NServiceBus.Configure.Instance.ForInstallationOn<NServiceBus.Installation.Environments.Windows>().Install()); 
```

**工人：**

```
 var queuePrefix = ConvertFriendlyNameTo.QueueName(AppDomain.CurrentDomain.FriendlyName);

        return NServiceBus.Configure.With()
            .DefineEndpointName(queuePrefix)
            .Log4Net(ObjectFactory.GetInstance<IServiceBusLog>().Build())
            .StructureMapBuilder()
            .JsonSerializer()
            .EnlistWithDistributor()
            .MsmqTransport()
            .IsTransactional(true)
            .DisableTimeoutManager()
            .DisableSecondLevelRetries()
            .UnicastBus()
            .CreateBus()
            .Start(() => NServiceBus.Configure.Instance.ForInstallationOn<NServiceBus.Installation.Environments.Windows>().Install()); 
```

我们在这里做错了什么可能会导致性能差异吗？

亲切的问候。

# css - CSS 布局受限于浏览器窗口？

> ID：15581214
> 
> 赞同：-3
> 
> 时间：2013-03-22T23:03:34.943
> 
> 标签：css, html

我花了至少 10 个小时试图弄清楚如何使用 HTML 和 CSS 实现所描绘的布局，但我一无所获。我无休止地搜索，虽然很多答案似乎都接近了，但我无法将其调整到位。

我只想制作一个简单的浏览器应用程序，它有一个页眉、页脚、左侧的菜单栏，以及一个以导航栏为主要内容的地图。我希望地图被限制在内容 div 中，而不仅仅是“溢出但隐藏”。如果没有任何滚动条，我会喜欢的，如果一切都合适的话。这可能与 CSS 吗？

![在此处输入图像描述](../Images/55a4675025540245641a037cd47b1643.png)

拜托拜托，我要死在这里了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:29:10.650

当然，你可以把所有东西都固定好，听起来好像你想要这样的东西。（关于“从来没有任何滚动条，一切都刚刚好”。）如果这是你想要的，你可以做如下的事情：

```
body,#header,#menu,#footer,#content {
  position:fixed;
  margin:0;
  padding:0; 
}
#header {
  top:0;
  left:0;
  right:0;
  width:auto;
  height:40px; 
}
#menu {
  left:0;
  top:45px;
  bottom:35px;
  height:auto;
  width:120px; 
}
#footer {
  bottom:0;
  left:0;
  right:0;
  width:auto;
  height:30px; 
}
#content {
  right:0;
  top:45px;
  bottom:35px;
  left:125px;
  min-width:200px;
  min-height:200px;
  height:auto;
  width:auto; 
}
#navbar {
  position:relative;
  height:30px;
  display:block;
  min-width:200px;
}
#map {
  position:absolute;
  top:30px;
  left:0;
  right:0;
  bottom:0;
  width:auto;
  height:auto; 
} 
```

有了这样的东西，每个元素都将保持原位，只有内容会随着窗口调整大小。尽管我必须承认，我并没有*真正*理解您的要求。我希望这种方式适合您的需求。老实说，我觉得你的问题有点奇怪，因为你似乎需要学习一些 CSS 基础知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:15:18.760

大多数情况下，听起来您的问题与地图的容器 div 有关。尝试像这样设置它的 CSS 属性：

```
.container {
 position: absolute;
 top: 100px; // Offset for the header 
 bottom: 100px; // Offset for the footer
 left: 200px; // Offset for the menu
 right: 0;
} 
```

然后将地图以 100% 的宽度和高度放在里面。

# android - 我希望我的用户能够为我的整个应用从深色和浅色主题切换

> ID：15581221
> 
> 赞同：0
> 
> 时间：2013-03-22T23:04:09.260
> 
> 标签：android, themes

我有我的深色和浅色样式设置。

我希望用户能够在我的设置活动中从浅色/深色主题进行更改。

我有弹出的对话框，让我们选择亮或暗。

我已经读过这不能动态完成并且很好。我不介意应用程序重新启动以应用更改。

我见过像 falcon pro 这样的其他应用程序允许这样做。我就是这样设置的。在 falcon pro 中，它会询问您是现在还是以后重新启动应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:08:40.347

`Activity`有`setTheme`方法。您必须在任何活动中调用它，或者更好地创建一个 BaseActivity 来执行此操作并通过该 BaseActivity 继承您的任何活动

[以编程方式切换应用程序范围的主题？](https://stackoverflow.com/questions/4663752/switching-application-wide-theme-programmatically)

# html - div 卡错位

> ID：15581224
> 
> 赞同：0
> 
> 时间：2013-03-22T23:04:19.270
> 
> 标签：html, css

这是我正在处理的[投资组合](http://patrykponichtera.com/)

第一次进入网站时，黄色的 Wakey 卡片位于侧边栏下方（它应该在侧边栏的右侧。

刷新网站后，它进入正确的位置是什么原因造成的？

这是卡片所在的内容 div 的 css

```
 #content
{
    width:70%;
    position: absolute;
    display: inline-block;

} 
```

这是侧边栏

```
#sidebar
{
    background-color:#4b4b4b;
    margin:0px;
    margin-left:5%;
    width:400px;
    height:1000px;
    -moz-box-shadow: 0px 0px 25px #000000;
    -webkit-box-shadow: 0px 0px 25px #000000;
    box-shadow: 0px 0px 25px #000000;
    display: inline-block;
} 
```

你可以从网站上看到 html，所以我不会发布它以保持简短

在 IE 上它显示正确，它在 chrome 上给了我这个问题

更新：我已将#content-wrapper 显示更改为`display:inline;`现在，但没有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:22:38.210

为什么不浮动你的侧边栏？并让#content 将自身定位在正常的文档流中。您可能还想为#content 设置宽度。

```
#sidebar
{
  background-color:#4b4b4b;
  margin:0px;
  margin-left:5%;
  width:400px;
  height:1000px;
  -moz-box-shadow: 0px 0px 25px #000000;
  -webkit-box-shadow: 0px 0px 25px #000000;
  box-shadow: 0px 0px 25px #000000;
  float: left; 
```

}

```
#content
{
 float: left;
} 
```

# ios - 如何检测音效何时播放完毕？

> ID：15581225
> 
> 赞同：9
> 
> 时间：2013-03-22T23:04:21.510
> 
> 标签：ios, objective-c, audio, cocos2d-iphone, simpleaudioengine

我正在使用 SimpleAudioEngine 并且我试图在继续之前检测声音效果是否已完成播放。

我正在寻找任何方法，但我尝试实施的方法不起作用！

```
CDSoundEngine *engine = [CDAudioManager sharedManager].soundEngine;    
ALuint soundId = [[SimpleAudioEngine sharedEngine] playEffect:soundId];

float seconds = [engine bufferDurationInSeconds:soundId]; 
```

每次我使用 bufferDurationInSeconds 时，它都会返回一个浮点值 -1 到变量秒。我检查了实现，当 ID 无效时它返回 -1，但我 100% ID 是有效的！

谁能帮我解决这个问题，或者建议我另一种方法来检测声音效果的结束？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-30T09:50:36.167

Violà! Getting CDSoundSource, and then the soundId from that works.

(The second line is optional, it just plays the sound).

```
CDSoundEngine *engine = [CDAudioManager sharedManager].soundEngine;
[[SimpleAudioEngine sharedEngine] playEffect:@"soundeffect.m4a"];
CDSoundSource *aSound =[[SimpleAudioEngine sharedEngine] soundSourceForFile:@"soundeffect.m4a"];
float seconds = [engine bufferDurationInSeconds:aSound.soundId]; 
```

Also to run a method right when it finishes playing I would use an NSTimer that uses the seconds result.

```
[NSTimer scheduledTimerWithTimeInterval:seconds target:self selector:@selector(aMethod) userInfo:nil repeats:NO]; 
```

And then the final method implements something.

```
-(void)aMethod 
{
NSLog(@"finished playing");
} 
```

Although, this doesn't effect the -1 result, I have to point out that the soundId variable appears twice as two different kinds in your code, in the same line, which will cause problems. No worries though, I have tested my method above with success.

```
ALuint **soundId** = [[SimpleAudioEngine sharedEngine] playEffect:**soundId**]; 
```

# regex - 更改 DotNetNuke 6 中电子邮件地址的正则表达式错误消息

> ID：15581227
> 
> 赞同：0
> 
> 时间：2013-03-22T23:04:59.887
> 
> 标签：regex, dotnetnuke

我在注册时更改了电子邮件地址的正则表达式，只允许具有某些域名的人（例如@domain1.com 或@domain2.com）。有没有办法更新当有人输入不同的域名（例如@mysite.com）时显示的错误消息？

我检查了所有资源文件，但找不到错误消息“您必须输入有效的电子邮件地址”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T03:47:31.207

@icidis 已关闭，但您可以使用 Admin/Languages 页面访问语言编辑器，然后您可以更新资源。如果您直接修改文件，您将面临在未来升级中丢失这些更改的风险。如果您使用语言编辑器，您可以修改特定于该门户的RESX文件（基于portalid），甚至可以在HOST级别修改该文件，该文件适用于所有门户，但不会更改“根”文件，因此升级不会覆盖它们。

在 DNN 视频库中查看此视频 [http://www.dotnetnuke.com/Resources/Video-Library/Viewer/Video/232/View/Details/Introduction-to-the-DotNetNuke-Language-Module.aspx](http://www.dotnetnuke.com/Resources/Video-Library/Viewer/Video/232/View/Details/Introduction-to-the-DotNetNuke-Language-Module.aspx)

我相信您可能想要的文件是 \DesktopModules\Admin\Security\App_LocalResources\SharedResources

# php - 如何对此代码进行连接以及如何在 PHP 表单中检索数据

> ID：15581229
> 
> 赞同：0
> 
> 时间：2013-03-22T23:05:09.637
> 
> 标签：php, sql, join, rating-system

我无法弄清楚如何在此代码中实现连接。还有第二个问题是我想`'Charity No: '.$don['charity_id'].'<br/>'.`在 mysql_query中使用`("SELECT * FROM charity where id='?????????'")`

代码现在所做的是它检索所有这些数据，这很好，但我想要charity_id [FK]（在捐赠表中）作为charityname（来自慈善表），并且我确定这是使用连接完成的但是无法弄清楚如何在我的代码中执行此操作。第二个问题是我想创建一个评级系统，对慈善机构进行评级（基于慈善机构编号），数据在上面几行，但我也无法弄清楚。

我的代码是：

```
<?php
if (!isset($_POST['do']) || !isset($_POST['id']) || !$_POST['id'])
exit;

    require_once 'connection.php';

    $don=mysql_fetch_assoc(
        mysql_query('SELECT *
            FROM donation
            WHERE id="'.mysql_real_escape_string($_POST['id'],$con).'"',$con));
    if ($don===false || !$don['id'])
        print '<h3>Donation id #'.$_POST['id'].' does not exist!</h3>';
    else {
        print '<h3>Information about donation id #'.$_POST['id'].'</h3>'.
            'Donor ID: '.$don['donor_id'].'<br/>'.
            'Charity No: '.$don['charity_id'].'<br/>'.
            'Date & Time: '.$don['TransactionTime'].'<br/>'.
            'Donation Amount: £ '.number_format($don['D_Amount'],2).'<br/>'.
         }

$find_data = mysql_query("SELECT * FROM charity where id='?????????'");

while($row = mysql_fetch_assoc($find_data))
{
    $id = $row['id'];
    $C_Name = $row['CharityName']; 
    $C_Desc = $row['CharityDescription'];
    $Hits = $row['Hits'];
    $Ranking = $row['Ranking'];

    echo "

    <form action='rate.php' method='POST'>
    $C_Name: <select name='Ranking'>

    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>

    </select>
    <input type='hidden' value=$id name='ID'>
    <input type='submit' value='Rate'>; 
    </form>

    ";
} 
```

我现在尝试的 JOIN 是：

```
$don=mysql_fetch_assoc(
        mysql_query('SELECT *
                   FROM donation As D JOIN charity as C ON d.charity_id=C.id 
            WHERE id="'.mysql_real_escape_string($_POST['id'],$con).'"',$con)); 
```

但现在运气。

给予任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:07:21.403

不能将 isset 与 $_POST 一起使用，因为它始终被设置并返回数组作为响应。改用空。

```
<?php
if (!empty($_POST['do']) || !empty($_POST['id']) || !$_empty['id'])
exit;

require_once 'connection.php';

//I'm guessing that ID is a number.
if(is_numeric($_POST['id'])){
        $temp_ID = $_POST['id'];    
    }
//Do a count before you trust the ID
$don=mysql_result(mysql_query('SELECT count(*) FROM donation WHERE id="'.$temp_ID.'"'),0);

if ($don!=='1') {
    //Don't print anything they give you here.
    print '<h3>That id does not exist!</h3>';
} else {
    $id = $temp_ID;

    $SQL = "select * from donation d,charity c where c.id=$id and d.id=c.id";
    $result = mysql_query($SQL);
    while ($row = mysql_fetch_array($result)){
        $donorID = $row['donor_id'];
        $charityID = $row['charity_id'];
        $transactionTime = $row['TransactionTime'];
        $amount = number_format($row['D_Amount'],2);
        $C_Name = $row['CharityName']; 
        $C_Desc = $row['CharityDescription'];
        $Hits = $row['Hits'];
        $Ranking = $row['Ranking'];
    }
    $form = "<h3>Information about donation id #$id</h3>\n
        Donor ID: $donorID<br/>\n
        Charity No: $charityID<br/>\n
        Date &amp; Time: $transactionTime<br/>\n
        Donation Amount: £ $amount<br/>\n";

$form .= "
<form action='rate.php' method='POST'>\n
$C_Name: <select name='Ranking'>\n
<option>1</option>\n
<option>2</option>\n
<option>3</option>\n
<option>4</option>\n
<option>5</option>\n
</select>\n
<input type='hidden' value=$id name='ID'>\n
<input type='submit' value='Rate'>\n 
</form>";
print $form;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:34:37.180

这是`JOIN`：

```
SELECT charity.*, donation.* 
FROM charity 
JOIN donation 
ON charity.id = donation.charity_id; 
```

此声明选择所有捐赠。未显示没有捐款的慈善机构。

这是给你的现场演示：[http ://sqlfiddle.com/#!2/be925/2](http://sqlfiddle.com/#!2/be925/2)

请改写并指定第二个问题，我不明白你想要什么。

# iphone - 为什么我的标题没有使用核心位置改变？

> ID：15581230
> 
> 赞同：2
> 
> 时间：2013-03-22T23:05:12.737
> 
> 标签：iphone, ios, ipad, core-location

我正在使用带有 iOS 5.1.1 的 WiFi iPad 第一代

我已经设置了类似于此博客文章的核心位置：http: [//blog.objectgraph.com/index.php/2012/01/10/how-to-create-a-compass-in-iphone/](http://blog.objectgraph.com/index.php/2012/01/10/how-to-create-a-compass-in-iphone/)

在：

```
- (void)locationManager:(CLLocationManager*)manager
didUpdateHeading:(CLHeading*)heading 
```

我记录了真实的航向值：

```
NSLog(@"heading: %f", manager.heading.trueHeading); 
```

无论我将 iPad 指向哪个方向，结果始终是“真实方向：-1.000000”。

我已经在所有 3 轴上旋转了设备并在设置中启用了定位服务。

关于为什么这不起作用的任何想法？航向报告是否不适用于第一代 iPad？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-27T15:34:04.450

这对我的情况有帮助：

1.  选择定位服务（在隐私设置下）
2.  选择应用程序列表底部的系统服务（在位置服务中）
3.  打开**指南针校准**

似乎这样，trueheading-values 不再是 -1 ！

（见下图）！

![在此处输入图像描述](../Images/a9e79c54b3a189a52d42b294e23a1ed8.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T01:13:02.147

要获得有效的航向数据，您还必须配置 CLLocationManager 以更新位置。从苹果文档：

> 注意：如果您希望标题对象包含 trueHeading 属性的有效数据，您的位置管理器对象也应配置为提供位置更新。您可以通过调用位置管理器对象的 startUpdatingLocation 方法来开始传递这些更新。

因此调用`startUpdatingLocation`

请注意，“朝向”是指定义的设备轴指向的方向。您可以使用 [UIDevice currentDevice].orientation 读取的“方向”告诉您设备的倾斜度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T04:32:22.763

-1 表示指南针航向无效。您可能需要执行指南针校准。

# delphi - Delphi 版本的源兼容性 (*.pas & *.dfm)

> ID：15581234
> 
> 赞同：4
> 
> 时间：2013-03-22T23:05:32.093
> 
> 标签：delphi, delphi-xe2, delphi-7

是否有关于项目文件、源代码和 *.dfm 文件在不同 DELPHI 版本之间的兼容性的任何信息。

如果我不使用 DELPHi XE3 的最新功能，我仍然可以打开代码库并使用例如编译。德尔福 2010 年？（我知道 Unicode 问题，或者像 INDY 9 到 INDY 10 这样的组件更改会阻止降级，但这对我来说是另一个话题）

不好的想法，例如不起作用：使用您的 Delphi 7 项目，使用 DELPHI 2010 打开和编译，您不能使用 DELPHi 7 重新打开项目，因为某些对象将具有扩展属性，因为使用 2010 打开项目。手动返工回到 DELPHi 7 风格在这种情况下是相当耗时的。

开发人员团队可以一起工作吗，成员是否使用不同的 DELPHI XX 版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T09:25:54.137

可以做你想做的事，但我无法想象你为什么想做。当我们将应用程序从 D6 移植到 D2010 时，我们共享了可以在两个版本中构建的源代码。

这纯粹是一种过渡安排。一旦我们对 D2010 端口有信心，我们就切断了脐带。在这一点上，我们津津有味地接受了 D2010 的新功能。

为了完成这项工作，我们使用了以下拐杖：

1.  帮助减轻 ANSI/Unicode 差异的函数。
2.  处理单元重命名的单元别名。例如，主题单元将名称从 D6 更改为 D2010，单元别名功能隐藏了这一点。
3.  大量的条件代码。

所有这些都是必需的，因为我们有一个移植任务，因此必须在两个版本中进行编译。旧版本用于我们现有的产品维护，新版本以便我们可以测试和开发端口。

但我认为你没有理由这样做。尤其是因为它会导致非常复杂的代码。如果您希望您的应用程序在 D7 中构建，那么请始终在 D7 中构建它。既然你不能使用现代 Delphi 的特性并保持与 D7 的兼容性，为什么要使用 D7 以外的任何东西呢？当您购买现代 Delphi 时，您还可以访问旧的 Delphi 版本。

# sql - 如何在 SQL 中连接多个 select 语句

> ID：15581236
> 
> 赞同：4
> 
> 时间：2013-03-22T23:05:37.110
> 
> 标签：sql, performance, oracle, join, subquery

我想知道如何在 1）样式和 2）性能方面改进这种形式的查询。以防万一，我使用 Oracle 作为我的数据库。此外，此查询的目的是从第一个 select 语句中选择在 LEFT JOIN 右侧的记录集中没有相应记录的所有记录。来自 ColumnA 的记录在任何表中不一定是唯一的。

```
select ColumnA
from
    (Select ColumnA
    from Table1)
left join
    ((select ColumnA, ColumnB
    from Table2)
    union
    (select ColumnA, ColumnB
    from Table3))
using (ColumnA)
where ColumnB is null
group by ColumnA; 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:36:43.840

我认为您可以将此查询重写为以下内容（请参阅此**[SQL Fiddle](http://sqlfiddle.com/#!4/e4550/13)**）：

```
SELECT  DISTINCT ColumnA
FROM    (SELECT  ColumnA
         FROM    Table1)

MINUS

(SELECT  ColumnA
FROM    Table2
UNION
SELECT  ColumnA
FROM    Table3); 
```

至于风格，为了可读性和清晰度，我建议使用显式连接条件语法`LEFT JOIN ... ON table1.somecolumn = table2.someothercolumn`而不是条件。`USING`但这很可能是个人喜好:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-22T23:20:54.260

我认为不需要`UNION`：

```
select T1.ColumnA
from Table1 T1
    left join Table2 T2 ON T1.ColumnA = T2.ColumnA
    left join Table3 T3 ON T1.ColumnA = T3.ColumnA
where T2.ColumnA IS NULL 
    or T3.ColumnA IS NULL
group by T1.ColumnA; 
```

另一种选择是使用`NOT IN`：

```
select distinct ColumnA
from Table1 
where ColumnA not in (select ColumnA from Table2) 
    and ColumnA not in (select ColumnA from Table3); 
```

这两个都应该返回 Table1 中不在 Table2 或 Table3 中的任何 ColumnA 记录。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-22T23:35:20.390

这里有三种选择。

```
select distinct ColumnA
  from Table1      a
  left join Table2 b using(ColumnA)
  left join Table3 c using(ColumnA)
 where b.ColumnB is null
   and c.ColumnB is null; 
```

.

```
select distinct ColumnA
  from Table1 a
 where ColumnA not in(select ColumnA from Table2)
   and ColumnA not in(select ColumnA from Table3); 
```

.

```
select distinct ColumnA
  from Table1 a
 where ColumnA not in(select ColumnA from Table2 union
                      select ColumnA from Table3); 
```

# android - 如何从 android 上的实时 FFT 获得最准确的音频数据？

> ID：15581237
> 
> 赞同：2
> 
> 时间：2013-03-22T23:05:43.207
> 
> 标签：android, real-time, fft, audio-recording, kissfft

所以我正在尝试构建一个 android 应用程序，它充当实时音频分析器，作为一个项目的前身，该项目将涉及检测和过滤某些声音。

所以我认为我已经掌握了离散傅立叶变换的基础知识，但是我不确定进行实时频率分析的最佳参数应该是什么。

我的印象是，在理想情况下（无限计算能力），我将从 AudioRecord 类获得的 44100 样本/秒 PCM 流中获取所有样本，并将它们放入 44100 元素 fifo“窗口”（填充到2**16 带有 0 并且可能是锥形函数？），每次有新样本进入时在窗口上运行 FFT。这（我认为）会给我 0 - ~22 KHz 的频谱，每秒更新 44100 次.

这似乎不会在智能手机上发生。问题是，我不确定我应该减少哪些计算参数以使其在我的 Galaxy Nexus 上易于处理，同时仍尽可能保持质量。最终我想使用灵敏度更高的外接麦克风。

我认为这将涉及在进行 FFT 之间移动窗口不止一个样本，但我不知道在什么时候这会比仅在较小的窗口上进行 FFT 或如果有第三个选项我忽略了。

使用我从 libgdx 使用的本机实现的 KissFFT，我似乎能够在每 44100 个样本中执行 30-42 个 44100 个元素 FFT 并且仍然具有响应性（这意味着缓冲区从执行 AudioRecord.read 的线程中填充() 的填充速度不会比执行 fft 的线程消耗它的速度快）。

所以我的问题是：

1.  我目前获得的表现会是我将获得的最好的吗？或者看起来我一定是个愚蠢的人，因为可以实现更快的速度？
2.  我的方法至少从根本上是正确的，还是我完全是在错误的树上吠叫？

如果这有助于回答我的问题，我很乐意展示我的任何代码，但其中有很多，所以我想我会选择性地这样做，而不是全部发布。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-30T06:28:36.577

> 如果有第三种选择，我会忽略

是的：同时做这两个，FFT 大小的减小以及更大的步长。在评论中，您指出您想检测“用嘴嗅/咀嚼”。因此，您要做的与语音识别的典型任务类似。在那里，您通常以 10ms 的步长提取特征向量（意味着每 441 个样本 Fs=44.1kHz），并且要变换的信号窗口大约是步长大小的两倍，因此 20ms 产生 2^X FFT 1024 个样本的大小（确保您选择的 FFT 大小是 2 的幂，因为它更快）。

窗口大小的任何增加或步长的减小都会增加数据，但主要是增加冗余。

附加提示：

*   @SztupY 正确地指出，您需要在 FFT 之前“窗口化”您的信号，通常使用 Hamming-wondow。（但这不是“过滤”。它只是将每个样本值与相应的窗口值相乘而不累加结果）。

*   原始 FFT 输出几乎不适合识别“用嘴嗅/咀嚼”，经典识别器由处理 MFCC 序列及其增量的 HMM 或 ANN 组成。

> 我目前获得的表现会是我将获得的最好的吗？或者看起来我一定是个愚蠢的人，因为可以实现更快的速度？

它接近最佳，但您正在浪费所有 CPU 能力来估计高度冗余的数据，而没有给识别器留下任何 CPU 能力。

> 我的方法至少从根本上是正确的，还是我完全是在错误的树上吠叫？

在考虑了我的回答后，您可能会重新考虑您的方法。

# sqlite - sqlite链接错误

> ID：15581242
> 
> 赞同：0
> 
> 时间：2013-03-22T23:06:37.413
> 
> 标签：sqlite, ld

我有一个奇怪的 SQLite 链接错误。我有以下代码：

```
void TestSQLiteTemp()
{
  /* sqlite3_initialize(); */
  sqlite3_close( db );
} 
```

我可以编译和链接，一切都很好：

```
perdue@minervatest04> ldd bin/tests 
    libCAENVME.so => /usr/lib/libCAENVME.so (0x00002afaffc42000)
    ...
    libsqlite3.so.0 => /home/perdue/software/minervadaq/minervadaq/sqlite/lib/libsqlite3.so.0 (0x00002afafff8f000)
    ... 
```

但是，如果我取消注释 sqlite3_initialize 行，ld 失败：

```
g++  -o tests TestSuite.o -L/home/perdue/software/minervadaq/minervadaq/lib -lhardware -lminerva_workers -L/usr/lib64 -ldl -L/work/software/CAENVMElib/lib/x86_64 -lCAENVME -L/usr/local/lib -llog4cpp -L/usr/lib64 -lpthread  -L/usr/lib64  -L/home/perdue/software/minervadaq/minervadaq/sqlite/lib/ -lsqlite3
TestSuite.o: In function TestSQLiteTemp():
/home/perdue/software/minervadaq/minervadaq/tests/TestSuite.cpp:199: undefined reference to `sqlite3_initialize' 
```

有谁知道为什么有些功能可能没问题，但其他功能无法链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T12:04:43.413

要回答我自己的问题，问题是 /usr/lib64 中有一个旧版本的 sqlite，而我的链接器列表中出现在自定义安装区域之前的链接器列表中。如果我将自定义库区域移动到库路径列表的前面，一切正常。

# android - 来自 Android 应用的 JSON 实验

> ID：15581245
> 
> 赞同：3
> 
> 时间：2013-03-22T23:06:46.893
> 
> 标签：android, google-cloud-storage

在 Android 上，我可以上传一个对象。但是当我尝试下载它时，我在 getObject.executeMediaAndDownloadTo(out) 上收到以下错误。

```
java.lang.IllegalArgumentException: Type must be in the 'maintype/subtype; parameter=value' format 
```

代码来自谷歌示例：

```
Storage.Objects.Get getObject = storage.objects().get("bucket", "myObject");
if (getMetadata == true) {
    getObject.setAlt("json");  // Temporary workaround.
    StorageObject object = getObject.execute();
} else {
    // Downloading data.
    out = new ByteArrayOutputStream();
    // If you're not in AppEngine, download the whole thing in one request, if possible.
    // NOTE: As of right now, this will not retry on retryable failure.
    // http://code.google.com/p/google-api-java-client/issues/detail?id=579
    getObject.getMediaHttpDownloader().setDirectDownloadEnabled(true);
    getObject.executeMediaAndDownloadTo(out);
    } 
```

# vb.net - 连接消息字符串时预期语句结束

> ID：15581247
> 
> 赞同：0
> 
> 时间：2013-03-22T23:06:57.637
> 
> 标签：vb.net

我是编程新手，我无法弄清楚为什么它会在`EventInteger.ToString()`我试图复制我的 VB 书中的示例但它不起作用。

```
MessageString = "Total Daily Sales:" &
        DailyTotalDecimal.ToString("C") &
        Environment.NewLine & Environment.Newline &
        "Total Number of Orders:" EventInteger.ToString() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:11:27.057

VB 中的换行符是`_`. 参考： http: [//support.microsoft.com/kb/141513](http://support.microsoft.com/kb/141513)

> 要将语句从一行继续到下一行，请键入一个空格，后跟行继续字符 [键盘上的下划线字符 ( `_`)]。

例子：

```
MessageString = "Total Daily Sales:" & _
        DailyTotalDecimal.ToString("C") & _
        Environment.NewLine & Environment.Newline & _
        "Total Number of Orders:" & EventInteger.ToString() 'you were missing a & 
```

# iphone - 不能为 iphone 4 和 5 准备好 UIViewPicker

> ID：15581248
> 
> 赞同：1
> 
> 时间：2013-03-22T23:07:06.043
> 
> 标签：iphone, ios, storyboard, uipickerview

我有一个用于 iPhone 设备的故事板文件，在其中一个视图中有一个包含 UIPickerView 的子视图，并且当它在 iPhone 4 上运行时，UIPickerView 会卡在视图底部，但是当对于 iPhone 5，UIPickerView 出现在屏幕底部的上方一点。

如果我解决了 iPhone 5 的问题，当我在 iPhone 4 上运行 UIVPickerView 时，它不会完全出现。（它的一半出现在屏幕下方）

那么有没有办法让 UIViewPicker 为 iphone 4 和 5 分辨率做好准备？

注意：我通过使用 UIPickerView 创建一个全新的子视图解决了这个问题。现在无论设备是什么，它都布置得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:15:03.193

创建选取器时，需要使用屏幕的大小来确定位置。似乎您只是手动输入 y 的坐标，这仅在使用一种屏幕尺寸时才有效。

如果您所在的视图与屏幕大小相同（很可能是但也可能不是），您可以执行以下操作：

```
int y = self.view.frame.size.height; 
```

并将其用作您的pickerView 的y 坐标。

否则，您可以使用以下方法找到屏幕的大小：

```
[[UIScreen mainScreen] applicationFrame].size.width //if in portrait
//or
[[UIScreen mainScreen] applicationFrame].size.height //if in landscape 
```

然后，如果您有一个，则必须从中减去 navigationController 的高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T02:29:19.893

如果您使用自动布局，您应该能够更改选择器使用的约束以使其粘在底部。选择picker，点击storyboard右下角的“H”形自动布局菜单图标，选择“Bottom Space to Superview”。然后删除将选择器附加到屏幕顶部的任何约束。如果这不起作用，请确保所有选择器的超级视图都具有将它们附加到底部的约束；您必须决定是否要在 iPhone 5 上调整它们的大小或向下滑动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T14:55:05.257

我解决了这个问题。不知道出了什么问题，但我删除了子视图，然后创建了一个新的并添加了 UIPickerView。令人惊讶的是，现在无论设备是什么，它都布置得很好。

# database - MS Access 字幕分配按钮

> ID：15581249
> 
> 赞同：0
> 
> 时间：2013-03-22T23:07:12.013
> 
> 标签：database, ms-access, button, dao, caption

我正在尝试在 MS Access 的“代码生成器”部分编写代码，该代码将从记录中的按钮中提取标题。我有一个名为 Main Menu 的表，其中包括字段“ RecordID、Caption 和 Report to Run。我需要这个按钮来根据 MainMenu 表中的标题名称分配它的标题。

前任。按钮 A（记录 ID = 1，标题 = 借款人，要运行的报告 = rptCurrentBorrowers）。

单击我需要此按钮的标题为 = Borrower，通过从按钮 A 的记录中读取标题。我无法在需要从 MainMenu 表中拉出的按钮中专门写下标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:24:37.950

我的猜测是，此表单正在显示来自其他表的记录，并且当您浏览这些记录时，您希望按钮标题根据对 [Main Menu] 表的查找进行更改。

`On Current`如果是这样，那么在该表单 ( ) 的事件中类似以下的语句`Sub Form_Current()`可能会起到作用：

```
me.Button_A.Caption = DLookup("Caption", "Main Menu", "RecordID=" & me.RecordID.Value) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-24T08:48:49.350

戈德汤普森指出我在正确的位置。因此，在进行了大量研究之后，我不仅发现了如何实现这种类型的代码，而且发现了它为什么有用。DLookup 只需在数据库中搜索记录或查询，然后根据其标准将信息拉入其脚本位置。我需要为按钮标题实现此功能的原因是，我的最终用户能够从表格中更改按钮的标题，而不是操纵实际代码。这是我完成的 VBA 代码，带有工作按钮。

```
Private Sub Form_Open(Cancel As Integer)
    rptBorrower.Caption = DLookup("Caption", "MainMenu", "ReportID = 1")
    rptMediaList.Caption = DLookup("Caption", "MainMenu", "ReportID = 2")
    rptPastDue.Caption = DLookup("Caption", "MainMenu", "ReportID = 3")
End Sub

'' This code defines the Borrower Button
Private Sub rptBorrower_Click()
    rptBorrower.Caption = DLookup("Caption", "MainMenu", "ReportID = 1")

    Dim varBorrower As Variant
    varBorrower = DLookup("[ReportToRun]", "MainMenu", "[ReportID] = 1")
    DoCmd.OpenReport varBorrower, acViewReport

    rptBorrower_Click_Exit:
    Exit Sub
End Sub

'' This code is defines the Media List Button

Private Sub rptMediaList_Click()
    rptMediaList.Caption = DLookup("Caption", "MainMenu", "ReportID = 2")

    Dim varMediaList As Variant
    varMediaList = DLookup("[ReportToRun]", "MainMenu", "[ReportID] = 2")
    DoCmd.OpenReport varMediaList, acViewReport

    rptMediaList_Click_Exit:
    Exit Sub
End Sub

'' This code defines the Past Due Report Button

Private Sub rptPastDue_Click()
    rptPastDue.Caption = DLookup("Caption", "MainMenu", "ReportID = 3")

    Dim varPastDue As Variant
    varPastDue = DLookup("[ReportToRun]", "MainMenu", "[ReportID] = 3")
    DoCmd.OpenReport varPastDue, acViewReport

    rptPastDue_Click_Exit:
    Exit Sub
End Sub 
```

# matlab - 在 matlab 中测试 libsvm 时结果不佳

> ID：15581250
> 
> 赞同：0
> 
> 时间：2013-03-22T23:07:26.680
> 
> 标签：matlab, classification, svm, libsvm

有人可以帮我解决这个问题吗？我想测试这个分类是否已经很好。所以，我尝试数据测试=数据训练。如果分类好，它将给出 100% (acc)。这是我从这个网站找到的代码：

```
data= [170           66           ;
160            50           ;
170            63           ;
173            61           ;
168            58           ;
184            88           ;
189            94           ;
185            88           ]

labels=[-1;-1;-1;-1;-1;1;1;1];

numInst = size(data,1);
numLabels = max(labels);

 testVal = [1 2 3 4 5 6 7 8];
  trainLabel = labels(testVal,:);
  trainData = data(testVal,:);
  testData=data(testVal,:);
  testLabel=labels(testVal,:);
 numTrain = 8; numTest =8

%# train one-against-all models
model = cell(numLabels,1);
for k=1:numLabels
    model{k} = svmtrain(double(trainLabel==k), trainData, '-c 1 -t 2 -g 0.2 -b 1');
end

%# get probability estimates of test instances using each model
prob = zeros(numTest,numLabels);
for k=1:numLabels
    [~,~,p] = svmpredict(double(testLabel==k), testData, model{k}, '-b 1');
    prob(:,k) = p(:,model{k}.Label==1);    %# probability of class==k
end

%# predict the class with the highest probability
[~,pred] = max(prob,[],2);
acc = sum(pred == testLabel) ./ numel(testLabel)    %# accuracy
C = confusionmat(testLabel, pred)                   %# confusion matrix 
```

这是结果：

```
optimization finished, #iter = 16  
nu = 0.645259 obj = -2.799682, 
rho = -0.437644 nSV = 8, nBSV = 1 Total nSV = 8 
Accuracy = 100% (8/8) (classification)

acc =

    0.3750

C =

     0     5
     0     3 
```

我不知道为什么有两个精度，并且它不同。第一个是 100%，第二个是 0.375。我的代码是假的吗？它应该是 100% 而不是 37.5%。你能帮我纠正这个代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-04T17:56:51.620

如果您使用 libsvm，那么您应该更改 MEX 文件的名称，因为 Matlab 已经有一个名为 svmtrain 的 svm 工具箱。但是，代码正在运行，所以您似乎确实更改了名称，只是没有在您提供的代码上。

第二个是错的，不知道为什么。但是，我可以告诉你，如果你使用 test_Data = training_Data，你几乎总能获得 100% 的准确率。该结果实际上没有任何意义，因为该算法可能会过度拟合并且不会显示在您的结果中。针对新数据测试您的算法，这将为您提供真实的准确性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T01:30:57.870

那是你正在使用的代码吗？我认为您的 svmtrain 调用无效。你应该有`svmtrain(MAT, VECT, ...)`where`MAT`是一个数据矩阵，并且`VECT`是一个带有每行标签的向量`MAT`。其余参数是字符串值对，这意味着您将拥有一个字符串标识符及其对应的值。

当我运行您的代码（Linux，R2011a）时，我在 svmtrain 调用中遇到错误。运行`svmtrain(trainData, double(trainLabel==k))`给出了有效的输出（对于该行）。当然，您似乎没有使用纯 matlab，因为您的`svmpredict`调用不是本机 matlab，而是来自 LIBSVM 的 matlab 绑定......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-30T01:02:15.550

C = chaosmat(testLabel, pred)
交换他们的位置

C=confusionmat(pred,testLabel)

或使用这个

[ConMat,order] = 混淆垫(pred,testLabel)

显示混淆矩阵和类顺序

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-14T23:40:07.683

问题出在

```
[~,~,p] = svmpredict(double(testLabel==k), testData, model{k}, '-b 1'); 
```

`p`不包含预测的标签，它具有标签正确的概率估计。LIBSVM `svmpredict`已经为您正确计算了准确度，这就是它在调试输出中显示 100% 的原因。修复很简单：

```
[p,~,~] = svmpredict(double(testLabel==k), testData, model{k}, '-b 1'); 
```

根据 LIBSVM 的 Matlab 绑定自述文件：

```
The function 'svmpredict' has three outputs. The first one,
predictd_label, is a vector of predicted labels. The second output,
accuracy, is a vector including accuracy (for classification), mean
squared error, and squared correlation coefficient (for regression).
The third is a matrix containing decision values or probability
estimates (if '-b 1' is specified). If k is the number of classes
in training data, for decision values, each row includes results of 
predicting k(k-1)/2 binary-class SVMs. For classification, k = 1 is a
special case. Decision value +1 is returned for each testing instance,
instead of an empty vector. For probabilities, each row contains k values
indicating the probability that the testing instance is in each class.
Note that the order of classes here is the same as 'Label' field
in the model structure. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-24T18:18:08.983

我很遗憾地告诉你所有的答案都是完全错误的！！代码中的主要错误是：

```
numLabels = max(labels); 
```

因为它返回 (1)，尽管如果标签是正数它应该返回 2，然后 svmtrain/svmpredict 将循环两次。

无论如何，将线路更改`labels=[-1;-1;-1;-1;-1;1;1;1];` 为`labels=[2;2;2;2;2;1;1;1];` ，它将成功运行；）

# android - 从另一个类启动静态媒体播放器时程序崩溃

> ID：15581259
> 
> 赞同：0
> 
> 时间：2013-03-22T23:08:28.173
> 
> 标签：android, static, media-player

我有一个包含静态媒体播放器的类，但是当我尝试在另一个活动中启动媒体播放器时，程序停止工作，我在 logcat 中看不到原因。这是我的第一个活动，我从中访问静态媒体播放器：

```
public class MainActivity extends Activity {

TimerClass t = new TimerClass();
Button start, end, nextclass;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    start = (Button) findViewById(R.id.buttStart);
    end = (Button) findViewById(R.id.buttEnd);
    nextclass = (Button) findViewById(R.id.buttNext);

    //THIS IS WHERE I ATTEMPT TO START THE MEDIA PLAYER, PRESSING THIS BUTTON CAUSES THE PROGRAM TO STOP WORKING
    start.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

            TimerClass.playr.start();

        }

    });

    end.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

            TimerClass.handler.removeCallbacks(t.getRunnable());
            TimerClass.num =0;
            TimerClass.playr.stop();
        }

    });

    nextclass.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

            Intent openNext = new Intent("com.example.testingtime.CLASS2");
            startActivity(openNext);

        }

    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
} 
```

}

这是包含媒体播放器的类：

```
 public class TimerClass extends Activity {

 public static MediaPlayer playr;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    playr = MediaPlayer.create(TimerClass.this ,R.raw.click);
}

static int num =0;
public static Handler handler = new Handler();

    public static Runnable runnable = new Runnable() {

        public void run() {

            playr.start();

            System.out.println("Num is "+num);
            num++;
            handler.postDelayed(runnable, 10000);
        }

    };

    public Runnable getRunnable(){

    return runnable; 
    }
} 
```

这是我的Logcat：

```
03-22 23:47:56.699: E/Trace(13723): error opening trace file: No such file or directory (2)
03-22 23:47:56.969: I/Adreno200-EGL(13723): <qeglDrvAPI_eglInitialize:299>: EGL 1.4 QUALCOMM build: AU_LINUX_ANDROID_JB_REL_RB1.04.01.01.06.043_msm7627a_JB_REL_RB1.2_Merge_release_AU (Merge)
03-22 23:47:56.969: I/Adreno200-EGL(13723): Build Date: 12/10/12 Mon
03-22 23:47:56.969: I/Adreno200-EGL(13723): Local Branch: 
03-22 23:47:56.969: I/Adreno200-EGL(13723): Remote Branch: m/jb_rel_rb1.2
03-22 23:47:56.969: I/Adreno200-EGL(13723): Local Patches: NONE
03-22 23:47:56.969: I/Adreno200-EGL(13723): Reconstruct Branch: NOTHING
03-22 23:48:02.009: W/dalvikvm(13723): threadid=1: thread exiting with uncaught exception (group=0x41ce5450)
03-22 23:48:02.019: E/AndroidRuntime(13723): FATAL EXCEPTION: main
03-22 23:48:02.019: E/AndroidRuntime(13723): java.lang.NullPointerException
03-22 23:48:02.019: E/AndroidRuntime(13723):    at com.example.testingtime.MainActivity$1.onClick(MainActivity.java:39)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at android.view.View.performClick(View.java:4129)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at android.view.View$PerformClick.run(View.java:17143)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at android.os.Handler.handleCallback(Handler.java:615)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at android.os.Handler.dispatchMessage(Handler.java:92)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at android.os.Looper.loop(Looper.java:137)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at android.app.ActivityThread.main(ActivityThread.java:4802)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at java.lang.reflect.Method.invokeNative(Native Method)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at java.lang.reflect.Method.invoke(Method.java:511)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:813)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:580)
03-22 23:48:02.019: E/AndroidRuntime(13723):    at dalvik.system.NativeStart.main(Native Method) 
```

我不确定是否有关于其他地方可能导致的信息，Logcat 是 Stacktrace 吗？

关于静态媒体播放器有一些关于 SO 的问题，我尝试实施不同的解决方案，但到目前为止没有任何效果，谁能明白为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:12:11.410

显然`playr`at your `TimerClass`is null - 可能你`TimerClass`之前没有创建过，因此它没有初始化 - 但是共享静态 - 尤其是活动之间的上下文或 UI 依赖元素无论如何都不是一个好主意。

您应该在需要的 Activity 中创建 MediaPlayer。

编辑：注意到你正在做一个`new TimerClass()`你`MainActivity`自己的实例化活动也不是一个好主意。您应该始终使用`startActivity`它-但实际上我认为您并不是真的想`TimerClass`成为一个活动。

# android - 如何在 Android 上检测蓝牙 LE 广告

> ID：15581263
> 
> 赞同：1
> 
> 时间：2013-03-22T23:08:51.300
> 
> 标签：android, bluetooth, bluetooth-lowenergy

有谁知道在 Android 设备上检测蓝牙 LE 广告的最佳方法？我只需要从广告数据包中检索服务 UUID 和 RSSI 值，我**不需要连接**设备——如果这会有所不同。对于包含 Broadcom 蓝牙模块的设备，我是否需要使用供应商特定的蓝牙 API 之一，例如[Broadcom ？](http://android-btle.github.com/framework/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T21:27:40.027

从 SDK 18 开始，Android 现在有用于此的 API。但是，在我的测试中，它们在 Nexus 4 和 4.3 上无法正常工作。

请参阅此处的文档：http: [//developer.android.com/guide/topics/connectivity/bluetooth-le.html](http://developer.android.com/guide/topics/connectivity/bluetooth-le.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:55:43.183

从 Android 4.2 版开始，Broadcom 堆栈已集成到 Android 中，并且可以开箱即用。在此之前，您需要运行另一个堆栈来授予 BLE 访问权限，因为现有的 Android 没有 API。

# objective-c - 在 JSON 中解析字典数组的最佳方法是什么

> ID：15581264
> 
> 赞同：0
> 
> 时间：2013-03-22T23:09:03.937
> 
> 标签：objective-c, json, data-structures

我有一个巨大的 JSON 数据，其中包含字典数组，每个字典都包含许多键值对。

我必须将每个字典解析为模型（NSObject 模型）。

最好的方法是什么？现在我正在使用 SBJSON 框架转换 JSON 并迭代数组，然后将字典中的每个键值存储到 NSObject 模型。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:13:22.497

使用[NSPredicate](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSPredicate_Class/Reference/NSPredicate.html)

**例子：**

```
String predicateString = [NSString stringWithFormat:@"%@ == '%@'", key, value];
NSPredicate *predicate = [NSPredicate predicateWithFormat:predicateString];
NSArray *filteredResults = [allResultsArray filteredArrayUsingPredicate:predicate]; 
```

使用动态密钥时，您应该使用`%K`令牌而不是`%@`

例子：

`NSString predicateString = [NSString stringWithFormat:@"%K == %@", key, value];`

[本文](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html#//apple_ref/doc/uid/TP40001795-SW1)描述了谓词字符串的语法和谓词解析器的一些方面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:16:45.843

一个非正式的协议，`NSKeyValueCoding`，很可能是你想要的。它包含一个`setValuesForKeysWithDictionary:`方法，可以让您将字典转换为您选择的 Objective-C 对象。假设键名与属性名匹配，即。

将其与循环结合起来`for`，您就有了一种从 JSON 制作原生 ObjC 对象的非常快捷的方法。

# cuda - 使用 nvprof 计算 gst_throughput 和 gld_throughput

> ID：15581265
> 
> 赞同：0
> 
> 时间：2013-03-22T23:09:04.387
> 
> 标签：cuda, profiler

我遇到了以下问题。我想使用 为我的 cuda 应用程序测量`gst_efficiency`和。随 cuda 5.0 分发的文档告诉我使用以下公式为具有计算能力 2.0-3.0 的设备生成这些：`gld_efficiency``nvprof`

```
gld_efficiency = 100 * gld_requested_throughput / gld_throughput

gst_efficiency = 100 * gst_requested_throughput / gst_throughput 
```

对于所需的指标，给出了以下公式：

```
gld_throughput = ((128 * global_load_hit) + (l2_subp0_read_requests + l2_subp1_read_requests) * 32 - (l1_local_ld_miss * 128)) / gputime

gst_throughput = (l2_subp0_write_requests + l2_subp1_write_requests) * 32 - (l1_local_ld_miss * 128)) / gputime

gld_requested_throughput = (gld_inst_8bit + 2 * gld_inst_16bit + 4 * gld_inst_32bit + 8
* gld_inst_64bit + 16 * gld_inst_128bit) / gputime

gst_requested_throughput = (gst_inst_8bit + 2 * gst_inst_16bit + 4 * gst_inst_32bit + 8
* gst_inst_64bit + 16 * gst_inst_128bit) / gputime 
```

由于没有给出所用指标的公式，我假设这些是 nvprof 可以计算的事件。但是我的 gtx 460 上似乎没有一些事件（也尝试过 gtx 560 Ti）。我粘贴[了](http://pastebin.com/n22TW2Y1).`nvprof --query-events`

任何想法出了什么问题或我误解了什么？

**编辑：** 我不想使用 CUDA Visual Profiler，因为我试图分析我的应用程序的不同参数。因此，我想`nvprof`使用多个参数配置运行，记录多个事件（每个事件都在一次运行中），然后将数据输出到表格中。我已经把它自动化了，并为其他指标工作（即发出的指令），并希望这样做以提高加载和存储效率。这就是为什么我对涉及`nvvp`. 顺便说一句，因为我的应用程序`nvvp`无法计算存储效率所需的指标，所以在这种情况下它根本对我没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T17:07:52.517

我很高兴有人遇到同样的问题 :) 我正在尝试做同样的事情并且无法使用 Visual Profiler，因为我想分析 6000 个不同的内核。

NVidia 网站上的公式记录不充分 - 实际上变量可以是：

a) 事件

b) 其他指标

c) 不同的变量取决于您拥有的 GPU

但是，其中的许多指标要么有错别字，要么在 nvprof 中的精通程度与网站上的有所不同。此外，这些变量没有被标记，因此您无法仅通过查看它们是 a)、b) 还是 c) 来判断它们。我使用了一个脚本来 grep 它们，然后不得不手动修复它。这是我发现的：

1) "l1_local/global_ld/st_hit/miss" 这些在 nvprof 中有 "load"/"store" 而不是现场的 "ld"/"st"。

2) “l2_ ...whatever..._requests” 这些在 nvprof 中有“sector_queries”而不是“requests”。

3) “local_load/store_hit/miss” 这些在探查器中有“l1_” - “l1_local/global_load/store_hit/miss”

4）“tex0_cache_misses”这个在探查器中有“扇区” - “tex0_cache_sector_misses”

5) "tex_cache_sector_queries" 缺少 "0" - 所以 nvprof 中的 "tex0_cache_sector_queries"。

最后，变量：

1) "#SM" 流式多处理器的数量。通过 cudaDeviceProp 获取。

2) "gputime" 显然是GPU上的执行时间。

3）“warp_size”你的GPU上的warp大小，再次通过cudaDeviceProp获取。

4) "max_warps_per_sm" sm 上可执行的块数 * #SM * 每个块的扭曲。我猜。

5）“elapsed_cycles”找到这个： [https ://devtalk.nvidia.com/default/topic/518827/computeprof-34-active-cycles-34-counter-34-active-cycles-34-value-doesn-39- t-make-sense-to-/](https://devtalk.nvidia.com/default/topic/518827/computeprof-34-active-cycles-34-counter-34-active-cycles-34-value-doesn-39-t-make-sense-to-/) 但如果我明白了，仍然不完全确定。

希望这可以帮助您和其他遇到相同问题的人:)

# jquery - JQuery 的 AJAX 请求：检索 JSON 数据需要哪些设置？

> ID：15581266
> 
> 赞同：0
> 
> 时间：2013-03-22T23:09:04.520
> 
> 标签：jquery, ajax

我想使用 JQuery 的 $.ajax 请求从服务器检索一些 JSON 数据。我在 JQuery 的文档中读到它们的所有设置都是可选的，这并不能帮助我理解我需要或不需要什么。我不确定我需要什么。这是我所拥有的：

**JS代码：**

```
function retrieve() {
     $.ajax({
        url : 'some_url',
        type : 'POST',
        dataType: 'JSON',
        contentType : 'application/json',
        data : JSON.stringify({
          key : 'value: ' 
        }),
        error : function(data) {
          console.log('error');
        },
        success : function(data) {
                    // callback function?
        }
     });
} 
```

我希望我的 .retrieve() 方法能够接受一个包含服务器上所有内容数组的函数，如下所示：

```
 SomeObject.retrieve(function(array){
       // do something w/ array
 } 
```

**问题：**我需要省略或添加任何设置吗？如何生成回调函数，以便在下载消息后可以使用其数据？任何答复将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:38:21.803

在成功接收到 AJAX 响应时执行某些操作（在以下示例中，在警报框中显示接收到的数据）：

```
function retrieve() {
    $.ajax({
        ...,
        success: function(data) {
            alert("Yes! AJAX worked. I received the following data: " + data);
        }
    });
} 
```

为了能够将自定义成功回调函数传递给您的检索方法：

```
function retrieve(successCallback) {
    $.ajax({
        ...,
        success: successCallback
    });
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-22T23:49:54.123

使用 JQuery 的 .get() 和 .post() 更容易理解。使用 .get() 从您的服务器检索数据，如下所示：

```
$.get('ajax/test.html', function(data) {
  $('.result').html(data);
  alert('Load was performed.');
}); 
```

这将从 test.html 中获取信息。您需要知道从哪里获取数据的 url。这可以是您服务器上的控制器。然后函数参数是它成功时发生的事情。在这里，它将使用您的数据填充结果元素 html 并提醒您已执行加载。

# magento - Magento 1 页面布局

> ID：15581268
> 
> 赞同：0
> 
> 时间：2013-03-22T23:09:05.160
> 
> 标签：magento

![在此处输入图像描述](../Images/c2cf79774c6fb4fe029856d25cc236b4.png)我只想更改一个页面的布局，即类别页面。我将 catalog.xml 第 187 行从 2-columns-right 编辑为 1-column，但它编辑了我的产品页面。我的问题是如何仅编辑类别页面（其中显示类别中的所有产品，请参见附图）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:20:22.427

您不应该就地修改核心文件，最好的做法是避免在自定义主题中覆盖和自定义核心布局文件。相反，您应该使用*local.xml*布局文件。[MageBase.com 上有一个很棒的关于布局 XML 定制的教程](http://magebase.com/magento-tutorials/5-useful-tricks-for-your-magento-local-xml/)。

*local.xml*在所有布局 XML 文件中最后被合并到已编译的布局配置 DOM 中，从而赋予其指令相对于其他指令的一定权限。您应该尝试以下内容：

```
<?xml version-"1.0"?>
<layout>
    <catalog_category_view>
        <reference name="root">
            <action method="setTemplate">
                <template>page/2columns-right.phtml</template>
            </action>
        </reference>
    </catalog_category_view>
</layout> 
```

请记住在开发时清除/禁用布局 XML 缓存。

# php - IE 未在 HTML 页面上正确应用 css/脚本（适用于 .php）

> ID：15581271
> 
> 赞同：0
> 
> 时间：2013-03-22T23:09:22.507
> 
> 标签：php, html, css, internet-explorer

我有一个问题，即 IE 无法在纯 HTML 页面上正确加载脚本/样式表，而在 .php 页面上加载它们却非常好。

主页是 php，正确加载弹出窗口并设置样式：[链接已删除]

示例产品页面，未正确加载弹出窗口 [链接已删除]

这种 php/html 差异在其他浏览器上运行得非常好，但它只是 IE 不能很好地工作。任何帮助都会很棒

我已经在 IE 9 及以下版本上对此进行了测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:12:11.233

*这是因为您在 doctype ..之前*有一个注释，这导致 IE 以怪癖模式显示（相当于旧版本的 IE）。任何东西都不应该在这之前，甚至是空白。

`<!-- categories3_eof //--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">`

在 doctype*之后*包含注释，IE 将适当地处理您的 DTD ..

`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><!-- categories3_eof //-->`

# jquery - 超链接上的jquery悬停翻转效果

> ID：15581280
> 
> 赞同：0
> 
> 时间：2013-03-22T23:10:24.603
> 
> 标签：jquery, plugins, jquery-plugins, hover

有谁知道是否有一个 jquery 插件可以像在本网站（右上角，社交网络链接）[http://www.julesbassoleil.fr/](http://www.julesbassoleil.fr/)上那样在超链接上完成悬停效果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:21:58.487

这是一个图标精灵，你可以在这里看到：

[http://www.julesbassoleil.fr/img/social_icons.png](http://www.julesbassoleil.fr/img/social_icons.png)

您唯一需要做的就是在加载时使用 css 设置正确的背景位置，并使用 jquery 为悬停时的背景位置设置动画。

# php - Symfony2 ajax twig 表单错误

> ID：15581286
> 
> 赞同：1
> 
> 时间：2013-03-22T23:11:06.520
> 
> 标签：php, jquery, ajax, symfony, twig

当他们从 ajax 响应返回时，有一个关于如何在 Symfony2 中正确输出表单提交错误的问题。

我正在通过 ajax 发布表单，如果表单未正确填写，它将使用以下代码发回带有错误的响应...

```
 $errors = $form->getErrorsAsString();
 $return = array("responseCode"=>200, "responseVal"=>"Error", "errorReport"=>$errors); 
```

这将创建一个错误数组和其他变量，如下所示：

```
 {"responseCode":200,"responseVal":"Error","errorReport":"ERROR: Name cannot be blank.\nERROR: Address cannot be blank.\nERROR: City cannot be blank.\nERROR: State cannot be blank.\nERROR: Zip cannot be blank.\nERROR: Phone cannot be blank.\nERROR: Email cannot be blank.\nname:\n    No errors\naddress:\n    No errors\ncity:\n    No errors\nstate:\n    No errors\nzip:\n    No errors\nemail:\n    No errors\nfax:\n    No errors\nphone:\n    No errors\n"} 
```

然后我使用 jQuery 将错误写入 div，如下所示：

```
 $("#errorReport").html(data.errorReport); 
```

这给了我一个包含以下内容的 div：

```
 ERROR: Name cannot be blank. ERROR: Address cannot be blank. ERROR: City cannot be blank. ERROR: State cannot be blank. ERROR: Zip cannot be blank. ERROR: Phone cannot be blank. ERROR: Email cannot be blank. name: No errors address: No errors city: No errors state: No errors zip: No errors email: No errors fax: No errors phone: No errors 
```

这看起来真的很俗气。无论如何，在 Twig 或 Symfony 中，我可以格式化这些错误，以便在将它们传递回 twig 模板时看起来像样？我希望它看起来像这样，但我只是不知道它是如何完成的：

```
 Name cannot be blank. 
 Address cannot be blank. 
 City cannot be blank. 
 State cannot be blank. 
 Zip cannot be blank. 
 Phone cannot be blank. 
 Email cannot be blank. 

 (any of the "No errors" would not be shown) 
```

非常感谢你的帮助！！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T06:49:12.057

您应该使用该`$form->getErrors()`方法而不是`$form->getErrorsAsString();` `getErrors`函数 Returns `FormError`Object，后者可用于创建错误消息

所以代码看起来像这样

```
$errors = $form->getErrors();
$errorCollection = array();
foreach($errors as $error){
       $errorCollection[] = $error->getMessageTemplate()
}
$return = array("responseCode"=>200, "responseVal"=>"Error", "errorReport"=>$errorCollection); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-18T00:33:08.600

我想说最干净的解决方案是实现使用以下类的**JMSSerializerBundle**（[http://jmsyst.com/bundles/JMSSerializerBundle ）：](http://jmsyst.com/bundles/JMSSerializerBundle)

[https://github.com/schmittjoh/serializer/blob/6bfebdcb21eb0e1eb04aa87a68e0b706193b1e2b/src/JMS/Serializer/Handler/FormErrorHandler.php](https://github.com/schmittjoh/serializer/blob/6bfebdcb21eb0e1eb04aa87a68e0b706193b1e2b/src/JMS/Serializer/Handler/FormErrorHandler.php)

然后在你的**控制器**中：

```
 // ...
        if ($request->isXMLHttpRequest()) {
        $jsonResponse = new JsonResponse();

        $serializer = $this->container->get('jms_serializer');
        $form = $serializer->serialize($form, 'json');

        $data = array('success' => false,
                       'errorList' => $form);

        $jsonResponse->setData($data);

        return $jsonResponse;
    } 
```

# python - 在python中嵌套描述符/装饰器

> ID：15581288
> 
> 赞同：6
> 
> 时间：2013-03-22T23:11:20.213
> 
> 标签：python, python-2.7, descriptor, python-decorators

当我尝试嵌套描述符/装饰器时，我很难理解会发生什么。我正在使用python 2.7。

例如，让我们采用 和 的以下简化`property`版本`classmethod`：

```
class MyProperty(object):
    def __init__(self, fget):
        self.fget = fget
    def __get__(self, obj, objtype=None):
        print 'IN MyProperty.__get__'
        return self.fget(obj)

class MyClassMethod(object):
    def __init__(self, f):
       self.f = f
    def __get__(self, obj, objtype=None):
        print 'IN MyClassMethod.__get__'
        def f(*args, **kwargs):
            return self.f(objtype, *args, **kwargs)
        return f 
```

试图嵌套它们：

```
class A(object):
    # doesn't work:
    @MyProperty
    @MyClassMethod
    def klsproperty(cls):
        return 555
    # works:
    @MyProperty
    def prop(self):
        return 111
    # works:
    @MyClassMethod
    def klsmethod(cls, x):
        return x**2

% print A.klsproperty
IN MyProperty.__get__
...
TypeError: 'MyClassMethod' object is not callable 
```

`__get__`内部描述符的方法`MyClassMethod`没有被调用。由于无法弄清楚原因，我尝试输入（我认为是）一个无操作描述符：

```
class NoopDescriptor(object):
    def __init__(self, f):
       self.f = f
    def __get__(self, obj, objtype=None):
        print 'IN NoopDescriptor.__get__'
        return self.f.__get__(obj, objtype=objtype) 
```

尝试在嵌套中使用无操作描述符/装饰器：

```
class B(object):
    # works:
    @NoopDescriptor
    @MyProperty
    def prop1(self):
        return 888
    # doesn't work:
    @MyProperty
    @NoopDescriptor
    def prop2(self):
        return 999

% print B().prop1
IN NoopDescriptor.__get__
IN MyProperty.__get__
888
% print B().prop2
IN MyProperty.__get__
...
TypeError: 'NoopDescriptor' object is not callable 
```

我不明白为什么`B().prop1`有效而`B().prop2`无效。

问题：

1.  我究竟做错了什么？为什么我会收到`object is not callable`错误消息？
2.  什么是正确的方法？`MyClassProperty`例如，在重用`MyClassMethod`和`MyProperty`（或`classmethod`和`property`）时定义的最佳方法是什么

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T23:36:38.743

在这种情况下，当使用不带参数的装饰器时，会调用装饰器并将其装饰的函数作为其参数。使用装饰器的返回值而不是装饰函数。所以：

```
@MyProperty
def prop(self):
    ... 
```

相当于：

```
def prop(self):
    ...
prop = MyProperty(prop) 
```

由于`MyProperty`实现了描述符协议，访问`A.prop`实际上将调用`A.prop.__get__()`，并且您已定义`__get__`调用被装饰的对象（在本例中为原始函数/方法），因此一切正常。

现在，在嵌套情况下：

```
@MyProperty
@MyClassMethod
def prop(self):
    ... 
```

等效的是：

```
def prop(self):
    ...
prop = MyClassMethod(prop)   # prop is now instance of MyClassMethod
prop = MyProperty(prop)      # prop is now instance of MyProperty
                             # (with fget == MyClassMethod instance) 
```

现在，和以前一样，访问`A.prop`实际上将调用`A.prop.__get__()`(in `MyProperty`)，然后尝试*调用*`MyClassMethod`（被装饰并存储在`fget`属性中的对象）的实例。

但是`MyClassMethod`没有`__call__`定义方法，所以你得到错误`MyClassMethod is not callable`。

* * *

并解决您的第二个问题：属性已经是类属性-在您的示例中，访问`A.prop`将返回类对象中属性`A().prop`的值，并将返回实例对象中属性的值（可以与如果实例没有覆盖类对象）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-23T00:53:50.297

如果您`MyProperty`将描述符协议应用于其包装的对象，则可以使您的代码工作：

```
class MyProperty(object):
    def __init__(self, fget):
        self.fget = fget
    def __get__(self, obj, objtype=None):
        print('IN MyProperty.__get__')
        try:
            return self.fget.__get__(obj, objtype)()
        except AttributeError: # self.fget has no __get__ method
            return self.fget(obj) 
```

现在您的示例代码有效：

```
class A(object):
    @MyProperty
    @MyClassMethod
    def klsproperty(cls):
        return 555

print(A.klsproperty) 
```

输出是：

```
IN MyProperty.__get__
IN MyClassMethod.__get__
555 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-01T20:18:01.787

我在 Graham Dumpleton 的精彩[博客](https://github.com/GrahamDumpleton/wrapt/blob/master/blog/02-the-interaction-between-decorators-and-descriptors.md)中找到了我自己的老问题的明确答案。

简而言之，我编写的装饰器不尊重*描述符协议*，而是尝试直接调用包装的函数/对象，而不是首先给他们一个机会来执行他们的“描述符魔术”（通过调用他们的`__get__()`第一个）。

# c++ - 如何遍历二维向量？

> ID：15581290
> 
> 赞同：0
> 
> 时间：2013-03-22T23:11:25.600
> 
> 标签：c++, arrays, loops, vector

我有一个大小为 7*7 的二维向量命名表。

除其中 2 个值外，所有值均为 0。

当我运行以下程序时，我假设我进入了一个无限循环，因为没有任何内容输出到屏幕，我必须在终端中按`Ctrl`+`C`取消。

目前我有这个，这给了我错误

```
for(x=0; x = 6 ; x++){
    for(y=0; y = 6 ; y++){
        if (table.at(x).at(y) != 0)
            cout << "Yes." << endl;             
        }
    } 
```

我不明白为什么它不遍历表的每个值，顺序为 (0,0) 然后 (0,1) 然后 (0,2) ... (1,) (​​1,1) ( 1,2) ...等，直到它通过所有这些。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:14:11.617

替换`=`为`<=`

```
for(x=0; x <= 6 ; x++){
  for(y=0; y <= 6 ; y++){
    if (table.at(x).at(y) != 0)
      cout << "Yes." << endl;
    else
      cout << "No." << endl;  
  }
} 
```

# svn - SVN 中带有修订的唯一链接

> ID：15581301
> 
> 赞同：1
> 
> 时间：2013-03-22T23:12:40.130
> 
> 标签：svn, agile, visualsvn, clearquest

我们有一个场景，建议我们为每个变更请求创建一个新的 SVN 标签（每两周一个，因为它是一个敏捷项目）并将其链接到 Clear Quest，以便将来出于审计目的，可以查看在工单上，单击标签 URL 并查看浏览器窗口中的更改内容（我们的 SVN 服务器托管在 VisualSVN 上）。

这不是维护的噩梦吗？在六个月的时间里，我们将查看 12 个标签，并且在紧急发布的情况下可能会快速增长更多）

我想知道解决这个问题的最佳方法。问题又是：

在 Clear Quest 中提供 SVN 更改集作为链接，而无需创建无数标签。

是否可以在主干上创建带有修订的链接，以便可以单击它并直接在浏览器中查看更改集？

感谢您查看这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:22:54.833

首先，听起来您真正想做的是在问题跟踪器和 SVN 之间进行某种集成。你如何去做这取决于你的问题跟踪器，它基于你的标签，我猜是 jira。

以下是有关如何将 JIRA 与 SVN 集成的一些信息： [https ://confluence.atlassian.com/display/JIRA/Integrating+JIRA+with+Subversion](https://confluence.atlassian.com/display/JIRA/Integrating+JIRA+with+Subversion)

通常，此类集成的工作方式是您在提交消息中包含提及您正在解决的问题的内容。另一种选择是修订属性，但这可能有点乏味。

除此之外，回答你原来的问题。你可能想要 viewvc 之类的东西：http: [//www.viewvc.org/](http://www.viewvc.org/)

这为您提供了一个不错的 Web 界面。例如，在 ASF 中，我们有这样的 URL，它们重定向到提交的 viewvc 视图：http: [//svn.apache.org/r1460019](http://svn.apache.org/r1460019)

然后我们可以将其嵌入电子邮件、问题跟踪器等......

# c# - 使用刷新对象收集 wmi 性能计数器

> ID：15581304
> 
> 赞同：3
> 
> 时间：2013-03-22T23:12:47.223
> 
> 标签：c#, wmi, performancecounter

我是 C# 和 .net 的初学者。作为一个 unix 人，我的目的是为 windows 团队提供一项服务，从 windows 服务器收集性能数据并在[石墨](http://graphite.readthedocs.org/en/0.9.10/)中重新编码（通过[StatsD](https://github.com/etsy/statsd/)）。

我发现一个[源代码似乎完全可以做到这一点，](http://www.cloudbird.net/blog/195/getting-windows-and-ravendb-performance-counters-into-graphite)只是它似乎使用了错误的接口（错误的抽象级别）。例如，标签被翻译成本地化的 Windows 版本（这太疯狂了），这使得使用该服务不可行。

使用 wmi 性能计数器似乎是要走的路，但我想有效地查询并发现为此使用刷新对象是推荐的解决方案，但我不知道该怎么做。

不知何故[，我找到了一个查询值的答案](https://stackoverflow.com/questions/3522949/wmi-performance-counter-query-issues)，我将其包含在此处作为参考。

问题是：

*   如何使用刷新器对象每 5 秒查询上一个链接中的磁盘统计信息？
*   （加分）我如何集成，我应该[对前面提到的服务](https://github.com/cloudbirdnet/StatsDPerfMon)进行哪些更改以通过 wmi 而不是性能计数器收集数据？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T01:19:05.030

以下是我在 C# 中通过 WMI 收集有关磁盘使用情况的信息：

```
private List<DiskInfo> GetDiskInfo()
{
    List<DiskInfo> disks = new List<DiskInfo>();
    SelectQuery query = new SelectQuery("SELECT Size, FreeSpace, Name, FileSystem FROM Win32_LogicalDisk WHERE DriveType = 3");

    ManagementObjectSearcher moSearcher = new ManagementObjectSearcher(scope, query);
    ManagementObjectCollection collection = moSearcher.Get();
    foreach (ManagementObject res in collection)
    {
        float size = Convert.ToSingle(res["Size"]) / 1024f;
        float usedSpace = size - (Convert.ToSingle(res["FreeSpace"]) / 1024f);
        DiskInfo di = new DiskInfo();
        di.Name = res["Name"].ToString();
        di.Size = ConvertVal(size);
        di.UsedSpace = ConvertVal(usedSpace);
        if (size > 0)
        {
            di.PercentUsed = ((usedSpace / size) * 100).ToString("N0");
        }
        else
        {
            di.PercentUsed = "0";
        }
        if (res["FileSystem"] != null)
        {
            di.FileSystem = res["FileSystem"].ToString();
            disks.Add(di);
        }                               
    }

    return disks;
}

// handles returning the correct units    
private string ConvertVal(float value)
    {           
        float K = value;
        float M = value / 1024f;
        float G = M / 1024f;
        float T = G / 1024f;
        string unit = "KB";
        float val = K;            

        if (K >= 1024)
        {
            unit = "MB";
            val = M;
        }

        if (M >= 1024)
        {
            unit = "GB";
            val = G;
        }

        if (G >= 1024)
        {
            unit = "TB";
            val = T;
        }

        return val.ToString("N2") + unit;
    } 
```

我主要将上面的代码与完整的 ComputerInfo 类结合使用，我可以每隔几秒在 ASP.NET MVC 服务上从 jQuery AJAX 调用该类，该服务将 JSON 返回到浏览器，并使用提供的数据动态构建页面。
这是我的 DiskInfo 类，用于使数据更易于显示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ComputerInfo.Models
{
    public class DiskInfo
    {
        public string Name { get; set; }
        public string Size { get; set; }
        public string UsedSpace { get; set; }
        public string PercentUsed { get; set; }
        public string FileSystem { get; set; }
    }
} 
```

我希望这有帮助。如果您在答案中需要其他任何内容，请告诉我。

# countif - 添加两个不同的 COUNTIF 公式

> ID：15581305
> 
> 赞同：0
> 
> 时间：2013-03-22T23:12:50.630
> 
> 标签：countif

如何添加两个查看不同条件的不同 COUNTIF 公式。例如：

A 列显示我的日期`4/1/2013`
B 列显示我的产品类型`HQTT`

我把这个公式代入：

```
=COUNTIF(A:A,M3)+COUNTIF(B:B,"HQ TT") 
```

但是，这给了我`2`什么时候应该是的`1`，因为我只有一行显示`4/1/2013`产品`HQTT`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-24T02:25:26.697

为了回答，根据 OP：

> 我使用了这个公式
> `=COUNTIFS(A:A,Q37,B:B,"HQ TT")`
> ，得到了我需要的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:21:23.997

你的公式是说：

计算 A 列中的所有“2013 年 4 月 1 日”值。

计算 B 列中的所有“HQ TT”值。

给我这两个计数的总和。

我认为你想要的是第三列，`=A&B`以及关于它的公式`=COUNTIF(C:C,M3&"HQ TT")`

# c# - 在选择中带有参数的参数化查询返回无效数据

> ID：15581307
> 
> 赞同：0
> 
> 时间：2013-03-22T23:13:01.553
> 
> 标签：c#, .net, sql, ms-access, oledbconnection

我有以下代码：

```
string connectionString = 
    "Provider=Microsoft.JET.OLEDB.4.0;" + 
    "data source=" + processProgramPath + ";";

using (OleDbConnection connection = new OleDbConnection(connectionString))
{
    connection.Open();
    using (OleDbCommand command = new OleDbCommand(
        "SELECT @Value " +
        "FROM BONDPARAMETERS " +
        "WHERE BONDPARAMETERS.SetName = @SetName", connection))
    {
        command.Parameters.AddWithValue("@Value", value);
        command.Parameters.AddWithValue("@SetName", setName);               

        var result = command.ExecuteScalar();
        return result.ToString();
    }
} 
```

结果，我期望得到的是 760。但是，我得到了 StartForce 列的标题。

value = "StartForce" setName = "450(18)-F-OE"

如果我将使用更改为：

```
using (OleDbCommand command = new OleDbCommand("SELECT "+value+" " + 
```

有用。是什么赋予了？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:16:25.287

您不能使用这样的参数动态构建 SQL。请参阅此问题：[在列名上使用 C# SQL 参数化](https://stackoverflow.com/questions/15420228/using-c-sharp-sql-parameterization-on-column-names)

# cordova - 刷新包含 ajax 的元素时出错导致看不见的页面

> ID：15581308
> 
> 赞同：0
> 
> 时间：2013-03-22T23:13:02.053
> 
> 标签：cordova, jquery-mobile

所以基本上我所做的是，当用户在第一页时，我尝试获取内容并将其放入其他页面，我需要在元素上调用刷新，这样我就不会丢失 css，但我在这部分中不断出错。总是用户不在的页面给我错误

html

```
 <div class="wrapper">
      <ul  data-role="listview" class="news_list"></ul> </div>
   </div> 
```

调用函数

```
$(document).ready(function(e) {
        get_latest_news( 1 , 'http://www.xxx.com' , 0 );
    }) 
```

主功能

```
function get_latest_news(id , link_ , refresh_ ){

        var w = $('#'+id).find('.wrapper');
        w.hide();
        w.find('.news_list').html('');
       jQuery.support.cors = true;
        $.ajax({
            url :  link_ ,  
            success:function(data){
                var ul ='' ;
                  $.each( data.posts , function ( k , v ){
                        ul += '<li><h3><a href="#each_news">'
                        +v.title+'</a></h3>'+
                        '<p > '+v.date+' </p></li>';
                    });
                    w.find('.news_list').append(ul);
                    w.find('.news_list').listview('refresh');
                    w.show();
            } 

        })

    } 
```

我明白了

```
Error: cannot call methods on listview prior to initialization; attempted to call method 'refresh' 
```

在这一行

```
w.find('.news_list').listview('refresh'); 
```

我把它改成

```
 w.find('.news_list')listview().listview('refresh'); 
```

现在我明白了

```
TypeError: parentPage[0] is undefined
[Break On This Error]   

parentId = parentUrl || parentPage[ 0 ][ $.expando ], 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T07:33:08.607

您的主要问题是**`document ready`**，它不能用于初始化**`jQuery Mobile`**代码。它将在将**`jQuery Mobile`**页面加载到**`DOM`**. 这就是为什么**`jQuery Mobile`**有自己的初始化内容的方式，它被称为页面事件：

假设您有一个带有 id 的页面**`index`**，您可以像这样初始化它：

```
$(document).on('pagebeforeshow', '#index', function(){       
    //Call your ajax here
}); 
```

要了解有关**`jQuery Mobile`**页面事件以及它们如何工作的更多信息，请查看我的**[文章](http://www.gajotres.net/document-onpageinit-vs-document-ready/)**或在**[此处](https://stackoverflow.com/a/14469041/1848600)**找到它。

如果您有一个带有 id 索引的页面，您的代码应该如下所示：

```
$(document).on('pagebeforeshow', '#index', function(){
    get_latest_news( 1 , 'http://www.xxx.com' , 0 );
}); 
```

[**pagebeforeshow**](http://api.jquerymobile.com/pagebeforeshow/)是您要在此处使用的事件，因为它将在页面即将显示之前触发，因此有足够的时间**`AJAX`**在页面显示之前触发调用和填充列表视图。

其他页面事件可以在**[这里](http://api.jquerymobile.com/category/events/)**找到。

# java - Android：AysncTask 中的进度对话框错误

> ID：15581310
> 
> 赞同：0
> 
> 时间：2013-03-22T23:13:08.390
> 
> 标签：java, android, android-asynctask, progressdialog

我有一些代码在 AsyncTask 中进行一些处理，而在运行时我想显示一个进度对话框。在各个方面，我都希望更新消息，但我遇到了一些麻烦。继承人我到目前为止：

```
class ShowDialogAsyncTask extends AsyncTask<Void, String, Void>{

    private ProgressDialog progressSpinner;

        @Override
        protected void onPreExecute() {
        ProgressDialog progressSpinner = new ProgressDialog(MainActivity.this);
        progressSpinner.setTitle("File Download");
        progressSpinner.setMessage("Connecting to Internet");
        progressSpinner.show();
        }

        @Override
        protected Void doInBackground(Void... params) 
        {
            Log.v("doInBackground","1");
            try {
                Log.v("doInBackground","2");
                onProgressUpdate("Downloading File");
                //do some stuff
            } catch (IOException e) {
                result = "Error";
            }

            onProgressUpdate("Complete!");
            SystemClock.sleep(300);
            return null;
        }

        protected void onProgressUpdate(String... values) 
        {
        Log.e("onProgressUpdate",values[0]);
        try{
        progressSpinner.setMessage(values[0]);
        }catch(Exception e){Log.e("onProgressUpdate","Error!");}
        Log.e("onProgressUpdate","Success!");
        }

        @Override
        protected void onPostExecute(Void result) 
        {
        progressSpinner.dismiss();
        vf.showNext();
        }
} 
```

我希望更新消息的代码不起作用，它只会引发异常。然后，当我尝试关闭进度对话框时，整个事情都崩溃了。

我对android开发很陌生，所以我非常感谢任何指针。

Logcat 条目有点梨形。

```
03-22 22:59:30.189: W/dalvikvm(8133): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
03-22 22:59:30.189: E/AndroidRuntime(8133): Uncaught handler: thread main exiting due to uncaught exception
03-22 22:59:30.195: E/AndroidRuntime(8133): java.lang.NullPointerException 
```

**- 更新 -**

看来我的问题是我一直在声明进度对话框。我最终发现我可以像这样在新创建的构造函数中声明进度对话框

```
progressSpinner = new ProgressDialog(mContext); 
```

然后它将允许 AsyncTask 类的所有其他方法访问来更新消息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:24:34.027

问题可能是您`MainActivity`在创建`ProgressDialog`. 将公共构造函数添加到您的`AsyncTask`和名为的类字段`mContext`：

```
 public ShowDialogAsyncTask(Context c){
           mContext = c;
        } 
```

`this`在`MainActivity`创建类的对象时传入您的：

```
 ShowDialogAsyncTask task = new ShowDialogAsyncTask(this); 
```

在您的 中，使用该上下文`AsyncTask`创建`ProgressDialog`

# .net - PayPal REST API .net SDK - 400 个错误请求

> ID：15581314
> 
> 赞同：14
> 
> 时间：2013-03-22T23:13:55.873
> 
> 标签：.net, rest, sdk, paypal, paypal-sandbox

我在沙箱中工作，并使用 PayPal REST .net SDK 方法 Payment.Create 和 CreditCard 对象。当所有参数都有效并使用来自[https://developer.paypal.com/webapps/developer/docs/integration/direct/accept-credit-cards/](https://developer.paypal.com/webapps/developer/docs/integration/direct/accept-credit-cards/)的测试 CC 编号时，Payment 对象将从该方法返回，并且全部为出色地。

但是，当参数无效时，例如过去的到期日期或沙盒无法识别的 CC 编号，则不会返回 Payment 对象。相反，该方法会引发异常：“HttpConnection Execute 中的异常：无效的 HTTP 响应远程服务器返回错误：（400）错误请求”，但没有进一步解释。

当我在 cURL 中执行相同的请求时，除了“400 Bad Request”之外，我还收到了 JSON 响应。这包括更多有用的消息，例如“VALIDATION_ERROR”和“无效过期（不能是过去）”。

我的问题：有没有办法从 SDK 中获取这些消息？

我试过的：

*   PayPal 文档：[https](https://developer.paypal.com/webapps/developer/docs/api/#errors) ://developer.paypal.com/webapps/developer/docs/api/#errors 该文档提到，如果出现错误，他们会在响应正文中返回详细信息。不幸的是，它没有提供有关 SDK 是否可以访问这些的线索。
*   各种 Google 和 SO 搜索。
*   SDK 提供的 PizzaApp 示例代码没有任何异常处理或进一步深入了解此问题的方式。
*   我在 SDK 中看到一个 PayPalException 对象，但没有找到任何指示它应该如何使用或者它是否与这个问题相关的东西。

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-08-24T06:36:45.197

我今天才开始弄乱 SDK 和 API，马上就遇到了这个问题。我的意思是，如果我要创建自己的表单来处理付款，如果出现任何问题，我想向用户提供反馈。

无论如何，我确实在内部异常中找到了一些隐藏信息。也许这会有所帮助。

```
catch (PayPal.Exception.PayPalException ex)
{
    if (ex.InnerException is PayPal.Exception.ConnectionException)
    {
        context.Response.Write(((PayPal.Exception.ConnectionException)ex.InnerException).Response);
    }
    else
    {
        context.Response.Write(ex.Message);
    }
} 
```

结果响应：

```
{"name":"VALIDATION_ERROR","details":[{"field":"payer.funding_instruments[0].credit_card.number","issue":"Must be numeric"}],"message":"Invalid request - see details","information_link":"https://developer.paypal.com/webapps/developer/docs/api/#VALIDATION_ERROR","debug_id":"0548e52ef9d95"} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-26T19:21:23.720

由于似乎没有人知道这个问题的答案，我研究了 PayPal 的 .NET SDK for REST API 的源代码。从这次审查来看，从当前版本看来，当服务器返回任何 4xx 或 5xx HTTP 状态代码时，似乎没有返回错误消息的规定。我参考了[这个问题](https://stackoverflow.com/questions/692342/net-httpwebrequest-getresponse-raises-exception-when-http-status-code-400-ba)的答案，并更改了 SDK 以允许在适用时返回错误响应。这是 HttpConnection.cs 的相关部分。

```
catch (WebException ex)
{
    if (ex.Response is HttpWebResponse)
    {
        HttpStatusCode statusCode = ((HttpWebResponse)ex.Response).StatusCode;
        logger.Info("Got " + statusCode.ToString() + " response from server");
        using (WebResponse wResponse = (HttpWebResponse)ex.Response)
        {
            using (Stream data = wResponse.GetResponseStream ())
            {
                string text = new StreamReader (data).ReadToEnd ();
                return text;
            }
        }                           
    }
    if (!RequiresRetry(ex))
    {
        // Server responses in the range of 4xx and 5xx throw a WebException
        throw new ConnectionException("Invalid HTTP response " + ex.Message);
    }                       
} 
```

当然，这需要更改调用函数以正确解释错误响应。由于我只使用 Payment Create API，因此我采用了一些不适用于一般用途的快捷方式。然而，基本的想法是我创建了 PaymentError 和 Detail 类，然后更改了 Payment.Create 和 PayPalResource.ConfigureAndExecute 方法来填充并传回一个 PaymentError 对象。

* * *

三年后，PayPal 的 API 错误响应处理有了一些改进。由于其他一些问题，我不得不重新设计我的应用程序，并删除之前的代码。我发现您现在可以捕获 PayPal.Exception.PaymentsException，然后将 JSON 响应字符串反序列化为 PayPal.Exception.PaymentsError 对象。

```
Catch ex As PayPal.Exception.PaymentsException
    Dim tmpPmtErr As PayPal.Exception.PaymentsError = _
        JsonConvert.DeserializeObject(Of PayPal.Exception.PaymentsError)(ex.Response) 
```

感谢@lance 在另一个答案中的提醒，以便更仔细地检查异常。我尝试使用该解决方案，但无法使其工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-19T21:42:01.390

这似乎已经改变了，虽然其中许多答案都指向正确的方向，但没有一个对我完全有效。这相当于我目前最赞成的答案：

```
catch (PayPal.PaymentsException ex)
{
    context.Response.Write(ex.Response);
} 
```

回应：

```
{"name":"VALIDATION_ERROR","details":[{"field":"start_date","issue":"Agreement start date is required, should be valid and greater than the current date. Should be consistent with ISO 8601 Format"}],"message":"Invalid request. See details.","information_link":"https://developer.paypal.com/docs/api/payments.billing-agreements#errors","debug_id":"8c56c13fccd49"} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-17T05:49:01.203

@Jonathan，REST API 集成了 log4net，如果您进行了设置，它会将完整的错误响应输出到日志文件。您必须将此配置部分添加到您的 web.config：

```
<section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net"/> 
```

并设置选项：

```
<log4net>
<appender name="FileAppender" type="log4net.Appender.FileAppender">
  <file value="rest-api.log"/>
  <appendToFile value="true"/>
  <layout type="log4net.Layout.PatternLayout">
    <conversionPattern value="%date [%thread] %-5level %logger [%property{NDC}] %message%newline"/>
  </layout>
</appender>
<root>
  <level value="DEBUG"/>
  <appender-ref ref="FileAppender"/>
</root> 
```

打开你的 global.asax 并将其添加到 Application_Start 中：

```
log4net.Config.XmlConfigurator.Configure(); 
```

现在，只要在您的日志文件夹上设置了写入权限，PayPal REST SDK 就会向日志文件发送错误消息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-21T11:44:29.170

我的问题是 my `total`, `detail.subtotal`, 和`items.price`正在传递像 $1,000.00 这样的值，它需要十进制，所以使用类似的东西：

```
total = Regex.Replace(model.OrderTotal, "[^0-9.]", "") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-06-13T20:42:54.160

改进这里的解决方案是......简单（进口贝宝）

```
 Try
    Catch ex As PaymentsException
        For Each i In ex.Details.details
            Response.Write(i.field) 'Name of Field
            Response.Write(i.code) 'Code If Any
            Response.Write(i.issue) 'Validation Issue
        Next
    End Try 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-08-08T07:42:14.033

以上所有解决方案都没有真正掌握问题..

不久前我遇到了一个类似的问题..在调试了我的代码后，我发现我所做的交易在逻辑上是错误的..小计是 0.25 美元，贝宝服务器看到它并拒绝处理它，并给出我 400 错误的请求

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-06-04T15:46:49.710

如果您在美国以外使用全球化，则需要将小数转换为 InvariantCulture：

```
order.GetTotal().ToString("N2", CultureInfo.InvariantCulture) 
```

# c - 如何一次读取 14 位而不是 8 位的二进制文件？

> ID：15581317
> 
> 赞同：0
> 
> 时间：2013-03-22T23:14:18.240
> 
> 标签：c, binary, compression, bit-manipulation

我需要解压缩一个二进制文件。由于二进制文件以 14 位编码，因此我必须读取 14 位而不是 8 位来解码。但据我所知，使用`getc()`读取文件每次只给我 8 位。有没有有效的方法来实现这一目标？下面是一个可以完成这项工作的代码块，但它似乎效率不高，我该如何改进它？

```
unsigned int input_code(FILE *input)
{
    unsigned int return_value;
    static int input_bit_count=0;
    static unsigned long input_bit_buffer=0L;

    while (input_bit_count <= 24)
    {
        input_bit_buffer |= 
            (unsigned long) getc(input) << (24-input_bit_count);
        input_bit_count += 8;
    }

    return_value=input_bit_buffer >> (32-BITS);
    input_bit_buffer <<= BITS;
    input_bit_count -= BITS;
    return(return_value);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T23:29:36.667

一般来说，您应该避免读取如此少量的数据，因为它效率低下，尽管标准库和 O/S 内部的缓冲代码会弥补这一点。

更好的理由是它可能导致奇怪和不自然的代码。为什么不一次读取 112 位 = 14 个字节 - 这是 8 的倍数和 14 的倍数。然后您可以将生成的缓冲区视为 8 个 14 位数据。所以事情进展顺利。

但是，如果您绝对*必须*一次读取尽可能少的字节，则读取 16 位，然后吃掉（即处理）其中的 14 个，再读取 16 个，将它们与您已经读取的 2 个结合起来，吃掉 14 个，然后重复这个过程. 有关如何执行此类操作的提示，请查看 base64 编码器/解码器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T23:23:15.540

每个输入/输出 char 或 int 的几条指令的开销很可能可以忽略不计。除非您在这里发现瓶颈，否则不要尝试优化这段代码。

此外，如果我是你，我会检查`getc()`. 它可以返回`EOF`而不是数据。

此外，严格来说，`char`（或 C 的字节）中有`CHAR_BIT`位，可以大于 8。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T23:26:09.027

您一次不能读取少于一个字节。但是，您可以使用位掩码和移位操作将最后两位设置为`0`（如果您存储 16），并携带您删除的两个未使用位作为下一个值。不过，这可能会使解码操作更加复杂和昂贵。

如何将 8 乘 8 的值解码（您可以读取 14 个字符 = 112 位 = 8 * 14 位）？我没有测试过这段代码，里面可能有一些错别字。它确实编译但我没有你的文件来测试它：

```
#include <stdio.h>

int main(){
    FILE *file = fopen ("...", "rt");

    // loop variable
    unsigned int i;

    // temporary buffer
    char buffer[14];

    // your decoded ints
    int decoded[8];

    while(fgets(buffer, 14, file) != NULL) {
        int cursor = 0;

        // we do this loop only twice since the offset resets after 4 * 14
        for(i = 0; i <= 4; i+= 4){
            // first decoded int is 16 bits
            decoded[i+0] = (buffer[cursor++] | (buffer[cursor++] << 8));
            // second is 2 + 8 + 8 = 18 bits (offset = 2)
            decoded[i+1] = (decoded[i+0] >> 14) | buffer[cursor++] << 2 | buffer[cursor++] << 10;
            // third is 4 + 8 + 8 = 20 bits (offset = 4)
            decoded[i+2] = (decoded[i+1] >> 14) | buffer[cursor++] << 4 | buffer[cursor++] << 12;
            // next is 6 + 8 = 14 bits (offset = 6)
            decoded[i+3] = (decoded[i+2] >> 14) | buffer[cursor++] << 6;
        }

        // trim the numbers to 14 bits
        for(i = 0; i < 8; ++i)
            decoded[i] &= ((1 << 15) - 1);
    }
    fclose(file);
} 
```

请注意，我对解码后的整数不做任何事情，我一遍又一遍地在同一个数组上写入，这只是一个说明。您可以对代码进行更多分解，但我展开了循环并注释了操作，以便您了解它是如何工作的。

# android - 在软键盘中禁用 DONE，直到在编辑文本中输入最少字符数

> ID：15581319
> 
> 赞同：2
> 
> 时间：2013-03-22T23:14:31.630
> 
> 标签：android, android-edittext, textview, android-softkeyboard, android-keypad

我需要禁用 android 系统软板上的**DONE**按钮 (imeOptions-->IME_ACTION_DONE)，直到在编辑文本中输入最少字符数。有什么建议么？

**注意：**最少字符数只是需要对 edittext 用户输入执行的一种验证。因此，在用户输入的文本通过所有验证之前，DONE 需要保持禁用状态，以防止用户导航到下一步。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:34:12.703

这是我能到达的最接近的地方。我无法禁用该按钮，而是静静地使用由**DONE**按钮触发的事件并且什么也不做。

```
 if ((event.getAction() == KeyEvent.ACTION_DOWN) && (keyCode == KeyEvent.KEYCODE_ENTER)){

        if(isValid(mTextView.getText()){
            //Permit further operation 
        }else{
            //Do nothing - This will consume the KEYCODE_ENTER action
        }
        return false;  //To let other listeners that this event has already been consumed
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:17:42.210

我的建议是不要走这条路。最终，您无法控制软键盘的功能。即使您找到了在普通键盘上执行此操作的方法，它也可能不适用于三星键盘或 Swype 键盘。一些第三方键盘甚至忽略了像 inputType 这样的基本控件，很高兴地向用户显示字母以输入数字字段。您应该将所有与键盘相关的 api 视为建议，而不是指望它们中的任何一个被强制执行。

# python - 如何将跨越多行的括号之间的值放入python中的列表中？

> ID：15581321
> 
> 赞同：2
> 
> 时间：2013-03-22T23:14:39.573
> 
> 标签：python, list, tuples

我对 python 和正则表达式相当陌生，但我正在尝试找出一种方法来做到这一点。

我有一个看起来像这样的文件：

```
random text up here

group groupfoo {

    item_1
    item_2
    item_3
}

group groupbar {
    item_1
    item_2
    item_3
}

random text down here 
```

在这个文件中有几个这样的组。组名（groupfoo、groupbar 等）都是唯一的。我希望能够以某种方式基于组名创建元组并将项目作为值。

请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:24:39.903

这是一种没有正则表达式的方法。`replace`尽管您可能希望在下面的调用中使用正则表达式。但是，如果您的格式与您在问题中显示的一样严格，那么这将起作用。简单（非常简单）的状态机。

```
import collections

grouper = collections.defaultdict(list)
with open("groups.txt") as groups:
    in_group = False
    for line in groups:
        if '{' in line:
            in_group = True
            group_name = line.replace('group ', '').replace(' {', '').strip()
            continue
        if '}' in line:
            in_group = False
        if in_group:
            grouper[group_name].append(line.strip())
print grouper 
```

**输出**

```
defaultdict(<type 'list'>, {'groupbar': ['item_1', 'item_2', 'item_3'], 'groupfoo': ['item_1', 'item_2', 'item_3']}) 
```

# unit-testing - PHPUnit 版本问题 - 在命令行与浏览器中运行

> ID：15581331
> 
> 赞同：0
> 
> 时间：2013-03-22T23:15:59.370
> 
> 标签：unit-testing, phpunit

我是 PHP 单元测试和单元测试的新手。我正在使用 PHP 5.3.8 和 PHPUnit 3.7.18。我有一个简单的数学课和数学测试课：

**数学.php**

```
<?php

class Math {

    protected $val1;
    protected $val2;

    public function set_values($val1, $val2) {
        $this -> val1 = $val1;
        $this -> val2 = $val2;
    }

    public function get_values() {
        return $this -> $val1;
        return $this -> $val2;
    }

    public function add_values() {
        $this -> val1 + $this -> val2 = 5;
        return 5;
    }
}

?> 
```

**Math_Test.php**

```
<?php

require_once 'PHPUnit/Autoload.php';
require_once 'Math.php';

class Math_Test extends PHPUnit_Framework_TestCase {

    protected $value1;
    protected $value2;

    public function test_add() {

        $math = new Math();

        $expected = 7;
        $actual = $math -> add_values();
        $this -> assertEquals($expected, $actual);

    }

    protected function set_up() {
        $this -> math = new Math();
        $this -> math -> setValues(2, 3);
    }

    protected function tear_down() {
        unset($this -> value1);
        unset($this -> value2);
    }
}

?> 
```

起初我很挣扎，因为我的`xampp`安装中有旧版本的 PHPUnit。我经历并升级了 PEAR 和 PHPUnit，并且能够使上述测试正常工作。

令我困惑的是，我可以在命令行中运行这个测试并获得预期的结果。但我希望我也可以在浏览器中运行它，这样我就可以以这种方式查看结果。

使用相同的安装，我可以在我的浏览器中很好地运行这个类似的测试（这来自评论部分`..xampp\php\PEAR\PHPUnit.php`）：

```
<?php

require_once 'PHPUnit.php';

class MathTest extends PHPUnit_TestCase {
    var $fValue1;
    var $fValue2;

    function MathTest($name) {
      $this->PHPUnit_TestCase($name);
    }

    function setUp() {
      $this->fValue1 = 2;
      $this->fValue2 = 3;
    }

    function testAdd() {
      $this->assertTrue($this->fValue1 + $this->fValue2 == 5);
    }
}

$suite = new PHPUnit_TestSuite();
$suite->addTest(new MathTest('testAdd'));

$result = PHPUnit::run($suite);
print $result->toHTML();

?> 
```

注意使用较新的`Auotloader.php`vs`PHPUnit.php`和`PHPUnit_TestCase`vs `PHPUnit_Framework_TestCase`。也许这些版本在我的系统上混合在一起并造成了麻烦？

如何在浏览器中运行较新版本的测试（第一个测试）？我希望我使用测试套件和结果类在 HTML 中运行和显示。我尝试了变化无济于事。

我尝试在第二次测试中设置打印到浏览器部分，第一次测试并收到此错误：

`Fatal error: Class 'PHPUnit' not found in...`

我确认了 PHPUnit 和我的`include_path`一切似乎都在工作。另外，测试在终端中运行良好......

我已经安装了 VisualPHPUnit，这个工具非常适合那些想在浏览器中查看可视化测试的人。如果我能解决这个问题，我可能会将我的注意力转移到让 VisualPHPUnit 为我工作。

我学到了很多写作和编辑这个问题。感谢您的反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T17:13:23.087

我认为该`toHTML()`方法不是较新版本的 PHPUnit 的一部分。我搜索了我使用的 PHPUnit 存储库，似乎没有此函数的实例。我在想，也许它因为某种原因被取消了。

如果我错了，请纠正我，因为那肯定会回答这个问题。

我对在终端中运行 PHPUnit 并使用[VisualPHPUnit](https://github.com/NSinopoli/VisualPHPUnit)感到满意。

# sql-server - 具有挑战性的递归 T-SQL 查询

> ID：15581335
> 
> 赞同：5
> 
> 时间：2013-03-22T23:16:19.003
> 
> 标签：sql-server, tsql, recursion

这是我的场景。假设我有两个表“Car”和“CarPart”。汽车由许多零件组成，每个零件可以属于多辆汽车。在我的例子中，一个复杂的问题是每个部件都有一个新的 PartID，即使它是相同的部件名称，但它只是属于不同的汽车。这是我无法控制的事情，所以请耐心等待。这是设置内容的脚本。

```
IF OBJECT_ID('Car') IS NOT NULL DROP TABLE Car
CREATE TABLE Car (
CarID INT,
CarName VARCHAR(16)
)

IF OBJECT_ID('CarPart') IS NOT NULL DROP TABLE CarPart
CREATE TABLE CarPart (
PartID INT,
PartName VARCHAR(16),
CarID INT
)

INSERT INTO Car
VALUES (1, 'Chevy'),
    (2, 'Ford'),
    (3, 'Toyota'),
    (4, 'Honda'),
    (5, 'Nissan'),
    (6, 'Hugo')

INSERT INTO CarPart 
VALUES  (110, 'Engine', 1),
  (120, 'Engine', 2),
  (210, 'Door', 1),
  (220, 'Door', 3),
  (310, 'Seat', 4),
  (320, 'Seat', 5),
  (410, 'Window', 3),
  (510, 'Wheel', 2),
  (420, 'Window', 6) 
```

如您所见，“Engine”部分属于“Chevy”和“Ford”，并以不同的 ID 列出了两次。再一次，这是我必须忍受的设计限制。

这是我需要完成的：**给定一辆车，我需要找到这辆车的所有零件以及这些零件所属的所有其他汽车。我必须以递归方式继续寻找零件和汽车，直到到达链条的末端**。逻辑可以概括如下：@StartCar --> @StartCar 的部分 --> 同名的其他部分 --> 获取那些“其他”部分的 ID --> 获取“拥有”这些部分的汽车 - -> 重新开始并重复，直到到达链的末端。

为了解决我的问题，我尝试了这个查询：

```
DECLARE @StartCar VARCHAR(16) = 'Chevy'

;WITH cte (CarName, PartName)
AS
(
SELECT c.CarName,
       cp.PartName
FROM CarPart cp
JOIN Car c ON cp.CarID = c.CarID
WHERE c.CarName = @StartCar
UNION ALL
SELECT c.CarName,
       cp.PartName
FROM CarPart cp
JOIN Car c ON cp.CarID = c.CarID
JOIN cte cte ON cp.PartName = cte.PartName
)
SELECT CarName, PartName
FROM cte 
```

但是，它进入无限循环并终止。我希望看到与此类似的输出：

```
CarName PartName
Chevy Engine
Chevy Door
Ford Engine
Ford Wheel
Toyota Door
Toyota Window
Hugo Window 
```

我很感激任何指示。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:21:28.663

[SQL小提琴](http://sqlfiddle.com/#!3/ba5cd/20)

**查询 1**：

```
declare @t table (
  car_name varchar(100), 
  part_name varchar(100)
  )

declare @car int = 3

insert @t
select c.CarName, p.PartName
from Car c join CarPart p on c.CarID = p.CarID
where c.CarID = @car

while exists(
  select c.CarName, p.PartName
  from Car c join CarPart p on c.CarID = p.CarID
  where c.CarName in (
    select c.CarName
    from Car c join CarPart p on c.CarID = p.CarID
    where p.PartName in (select part_name from @t)
      and c.CarName not in (select car_name from @t)
    )
) 
insert @t
  select c.CarName, p.PartName
  from Car c join CarPart p on c.CarID = p.CarID
  where c.CarName in (
    select c.CarName
    from Car c join CarPart p on c.CarID = p.CarID
    where p.PartName in (select part_name from @t)
      and c.CarName not in (select car_name from @t)
    )

select * from @t 
```

**[结果](http://sqlfiddle.com/#!3/ba5cd/20/0)**：

```
| CAR_NAME | PART_NAME |
------------------------
|   Toyota |      Door |
|   Toyota |    Window |
|    Chevy |    Engine |
|    Chevy |      Door |
|     Hugo |    Window |
|     Ford |    Engine |
|     Ford |     Wheel | 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T01:00:16.663

您的 cte 进入无限循环的原因是您没有定义层次结构。如果您绘制关系图，您将看到许多圆圈导致任何演练永远循环。

要解决这个问题，首先要做的是创建层次结构。在我的代码中，第一个 cte`car_hierarchy`通过查找所有`CarID`对但限制左侧必须小于右侧来做到这一点。有了这个，你现在有了一个无圆有向关系图。（如果您忽略方向，您可能仍然会找到圆圈，但这对算法无关紧要。）

第二步是找到给定汽车的所有亲属。因为给定的汽车可能不在层次结构的末尾，所以这是一个两步过程。首先找到最左边的连接汽车，然后找到所有连接的汽车从那里开始。`car_left`并`car_right`在下面的查询中做到这一点。

最后一步是获取 ID 并将汽车和零件名称拉回：

```
IF OBJECT_ID('dbo.Car') IS NOT NULL DROP TABLE dbo.Car
CREATE TABLE dbo.Car (
CarID INT,
CarName VARCHAR(16)
)

IF OBJECT_ID('dbo.CarPart') IS NOT NULL DROP TABLE dbo.CarPart
CREATE TABLE dbo.CarPart (
PartID INT,
PartName VARCHAR(16),
CarID INT
)

INSERT INTO dbo.Car
VALUES (1, 'Chevy'),
    (2, 'Ford'),
    (3, 'Toyota'),
    (4, 'Honda'),
    (5, 'Nissan'),
    (6, 'Hugo')

INSERT INTO dbo.CarPart 
VALUES  (110, 'Engine', 1),
  (120, 'Engine', 2),
  (210, 'Door', 1),
  (220, 'Door', 3),
  (310, 'Seat', 4),
  (320, 'Seat', 5),
  (410, 'Window', 3),
  (510, 'Wheel', 2),
  (420, 'Window', 6)

DECLARE @StartCarID INT = 1;

WITH 
car_hierachy (CarID1, CarID2) AS (
  SELECT DISTINCT
         cp1.CarID CarID1,
         cp2.CarID CarID2
  FROM dbo.CarPart cp1
  JOIN dbo.CarPart cp2
  ON cp1.PartName = cp2.PartName
  AND cp1.CarID < cp2.CarID
),
car_left(CarID) AS (
  SELECT @StartCarID 
  UNION ALL
  SELECT ch.CarID1
  FROM car_hierachy ch
  JOIN car_left cl
  ON cl.CarID = ch.CarID2
),
car_right(CarID) AS (
  SELECT MIN(CarID) 
  FROM car_left
  UNION ALL
  SELECT ch.CarID2
  FROM car_hierachy ch
  JOIN car_right cr
  ON cr.CarID = ch.CarID1
)
SELECT *
FROM car_right ac
JOIN dbo.Car c
ON ac.CarID = c.CarID
JOIN dbo.CarPart cp
ON c.CarID = cp.CarID
ORDER BY c.CarId, cp.PartId; 
```

[SQLFiddle](http://sqlfiddle.com/#!3/b5aa0/1)

这应该可以解决您的问题。但是我不确定它会表现良好。对于大型数据集，您实际上可能会更好地使用循环。但是通过适当的索引，它可能会起作用。所以试试吧。

（我将启动车从雪佛兰切换到丰田，以表明它也适用于层次结构中间的 ars。如果你只从丰田向外走，你会错过福特。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-23T01:42:48.177

您基本上是在遍历一个非循环的图，因此您必须明确避免循环。一种方法是跟踪图中的路径。这是应该工作的代码。您也可以使用 SQL Server 的 HIERARCHYID 数据类型来保存路径。

我选择让 CTE 成为汽车表而不是零件表。您的规则永远不会导致特定汽车的某些（但不是全部）零件，所以这似乎更简单。

```
WITH cte(CarID,hier) AS (
  SELECT CarID, CAST('/'+LTRIM(CarID)+'/' AS varchar(max))
  FROM Car
  WHERE CarName = @StartCar

  UNION ALL

  SELECT c2.CarID, hier+LTRIM(c2.CarID)+'/'
  FROM Car AS c
  JOIN cte ON cte.CarID = c.CarID
  JOIN CarPart AS c1 ON c.CarID = c1.CarID
  JOIN CarPart AS c2 ON c2.PartName = c1.PartName
  WHERE hier NOT LIKE '%/'+LTRIM(c2.CarID)+'/%'
)

SELECT
  c.CarName, cp.PartName
FROM Car AS c
JOIN CarPart AS cp ON cp.CarID = c.CarID
JOIN cte on cte.CarID = c.CarID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-22T23:34:09.350

看起来您需要一个[连接表](http://en.wikipedia.org/wiki/Junction_table)，以便您拥有带有序列号的汽车->汽车零件->汽车零件名称。CarPart 表中不应包含零件序列号。

# javascript - 框架中的数据属性从 JQuery 返回未定义

> ID：15581337
> 
> 赞同：-1
> 
> 时间：2013-03-22T23:16:31.387
> 
> 标签：javascript, jquery, html

html 看起来像这样：

```
<ul class="categoryitems">
    <li><a data-url="../po/browse_po.php" href="welcome.php" target="main">PURCHASE ORDERS</a></li>           
    <li><a data-url="../po/po_email_config.php" href="welcome.php" target="main">PO EMAILS</a></li>     
</ul> 
```

忽略它们不相关的href。我计划防止他们违约。

相关的是jquery失败：

```
$('a').click(function()
    {
        alert($(this).parent().html()); //shows the a tag with the data-url attribute
        //$(this).data('url',"..someurl.com");
        alert($(this).data('url')); //returns undefined; when the previous line is uncommented works 
        alert($(this).attr('data-url')); //this works        
    }); 
```

如果它有所不同，则单击功能将包含在以下内容中：

```
$("#wndNavbar").ready( function() { 

}); 
```

因为它在一个框架中：

```
<frameset cols="<?=$gl_navbar_width?>,*" frameborder="0" framespacing="5" border="0">
    <frame id="wndNavbar" name="wndNavbar" src="nav_bar.php" scrolling="auto" marginheight="0" noresize>
    <frame name="main" src="welcome.php" scrolling="auto" marginheight="0" noresize>
</frameset> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:18:41.390

这不是你阅读的方式`data-url`。这是正确的方法：

```
alert($(this).data('url')); 
```

或者

```
alert($(this).attr('data-url')); 
```

更新：由于上述内容似乎无法为您解决问题，您是否尝试过使用

```
$(document).ready(function() {

}); 
```

或者

```
$("#wndNavbar").live(function() {

}); 
```

代替

```
$("#wndNavbar").ready( function() { 

}); 
```

更新 2：您似乎使用的是`frame`，而不是`iframe`. `ready`不适用于`frame`s，因此您需要使用`load`：

```
$("#wndNavbar").load( function() { 

}); 
```

# java - 有没有比使用 ArrayList 更好的方法，所以我没有得到 IndexOutOfBounds 异常？

> ID：15581338
> 
> 赞同：1
> 
> 时间：2013-03-22T23:16:31.383
> 
> 标签：java, android, arraylist

我有两个数组列表：

```
ArrayList<String> libraries = new ArrayList<String>(2);
ArrayList<String> styles = new ArrayList<String>(2); 
```

我有 3 个 CheckBox 组件。这三个 CheckBoxes 应该向 ArrayList 中添加或删除字符串，但是当检查**jqMobileChk**时会发生 IndexOutOfBoundsException。

三个复选框：

```
jqChk.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        if(jqChk.isChecked()){
            libraries.add(0,"<script src=\"http://code.jquery.com/jquery-1.8.2.min.js\"></script>\n");
        }else if(!jqChk.isChecked()){
            libraries.remove(0);
        }
    }
});

jqMobileChk.setOnClickListener(new OnClickListener() {  
    @Override
    public void onClick(View v) {
        if(jqMobileChk.isChecked()){
            libraries.add(1,"<script src=\"http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js\"></script>\n");
        }else if(!jqMobileChk.isChecked()){
            libraries.remove(1);
        }
    }
});

jqMobCSS.setOnClickListener(new OnClickListener() {     
    @Override
    public void onClick(View v) {
        if(jqMobCSS.isChecked()){
            styles.add(0,"<link rel=\"stylesheet\" href=\"http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css\" />\n");
        }else if(!jqMobCSS.isChecked()){
            styles.remove(0);
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T23:20:04.863

```
ArrayList<String> libraries = new ArrayList<String>(2); 
```

容量 2，尺寸 0

```
 libraries.remove(1); 
```

ofc idnex 超出范围，因为大小为 0

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-22T23:26:49.557

几个问题：

*   不要使用具体类型作为类型签名；改用接口，以便您以后可以根据需要切换实现。因此，使用`List<String> libraries = ...`而不是`ArrayList<String> libraries = ...`.
*   创建一个`List`with`2`作为构造函数的参数只会创建一个包含两个元素*空间的列表。*这并不意味着它包含两个元素。当你这样做时`libraries.remove(1)`，你正在删除甚至不存在的东西。
*   而不是在这里使用 a `List<String>`，我认为 a`Map<Integer, String>`可能会更好：

与其做`add(0, "...")`，不如做`libraries.put(0, "...");`。要删除，您可以执行`libraries.remove(0)`. 如果密钥不存在，您将不会得到异常。例如：

```
jqMobileChk.setOnClickListener(new OnClickListener() {  
    @Override
    public void onClick(View v) {

        if(jqMobileChk.isChecked()) {
            libraryMap.put(0, "<script src=\"http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js\"></script>\n");

        } else if(!jqMobileChk.isChecked()) {
            libraryMap.remove(0);
        }
    }
}); 
```

此外，使用实际版本号可能更好，而不是仅仅`0`or ，而不是. 在这种情况下，您可能希望将地图制作成并执行以下操作：`1``1.3.0``0``Map<String, String>`

```
jqMobileChk.setOnClickListener(new OnClickListener() {  
    @Override
    public void onClick(View v) {

        if(jqMobileChk.isChecked()) {

            libraryMap.put("1.3.0","<script src=\"http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js\"></script>\n");

        } else if(!jqMobileChk.isChecked()) {
            libraryMap.remove("1.3.0");
        }
    }
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-22T23:27:16.763

从[`ArrayList.add`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html#add%28int,%20E%29)

> **抛出：**
> IndexOutOfBoundsException - 如果索引超出范围 (index < 0 || index > size())

中没有元素`ArrayList`，因此是异常。

您可以使用 a[`Map`](http://docs.oracle.com/javase/7/docs/api/java/util/Map.html)代替

```
Map<String, String> libraries = new HashMap<String, String>(); 
```

接着

```
jqMobileChk.setOnClickListener(new OnClickListener() {  
    @Override
    public void onClick(View v) {
        if (jqMobileChk.isChecked()) {
            libraries.put("jqMobileChk","<script src=\"http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js\"></script>\n");
        } else if (!jqMobileChk.isChecked()) {
            libraries.remove("jqMobileChk");
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-22T23:20:14.800

如果 ArrayList 中没有索引 0，则不能添加到索引 1。

改用“真实”数组或[SparseArray](http://developer.android.com/reference/android/util/SparseArray.html) - 你可以这样做。

# android - Google Analytics for Android v2 广告系列跟踪不起作用

> ID：15581347
> 
> 赞同：7
> 
> 时间：2013-03-22T23:17:24.940
> 
> 标签：android, google-analytics, broadcastreceiver, google-play

我花了很多时间在这上面，现在正在拔头发。我正在使用 Google Analytics Android SDK v2。我已经使用了几个月，并使用`EasyTracker`. 那里没有问题。

我最近尝试实施 Campaign Tracking，一切似乎都还不错，但在市场上数周后，即使有数百次推荐下载，我也没有看到任何数据。我最近研究了如何测试它并发现了这个： [stackoverflow.com/questions/5890914/how-to-test-android-referral-tracking](https://stackoverflow.com/questions/5890914/how-to-test-android-referral-tracking)

我正在使用 v2 服务，所以在我的 AndroidManifest.xml 中，我添加了这个：

```
<!-- Used for install referral measurement -->
    <service android:name="com.google.analytics.tracking.android.CampaignTrackingService" />

    <receiver
        android:name="com.google.analytics.tracking.android.CampaignTrackingReceiver"
        android:exported="true" >
        <intent-filter>
            <action android:name="com.android.vending.INSTALL_REFERRER" />
        </intent-filter>
    </receiver> 
```

来源：[https ://developers.google.com/analytics/devguides/collection/android/v2/](https://developers.google.com/analytics/devguides/collection/android/v2/)

我没有其他接收器`INSTALL_REFERRER`。

当我从 ADB 运行测试时，我的应用程序没有任何类型的日志。当我刚刚安装应用程序并观察 Logcat 时，我看到以下内容，这似乎表明至少有一些东西被连接起来：

```
03-22 16:11:10.412: W/GAV2(12444): Thread[GAThread,5,main]: Service unavailable (code=1), will retry.
03-22 16:11:10.443: I/GAV2(12444): Thread[GAThread,5,main]: No campaign data found.
03-22 16:11:15.420: W/GAV2(12444): Thread[Service Reconnect,5,main]: Service unavailable (code=1), using local store. 
```

请帮我弄清楚我在这里缺少什么。这似乎*比*它应该做的要难得多。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-25T07:32:21.440

虽然我无法对其进行测试，但一旦我将其放入 Google Play 市场并进行测试，它就可以工作了。可怕的验证方式，但看起来这个问题对我来说已经解决了。

如果它对任何人有帮助，我在凌晨 12:05 构建了一个分析库版本。当我回到他们的网站重新下载时，它是在同一天构建的，但在上午 9:24。好像我有一个糟糕的版本，在他们修复它之前我很不幸地下载了它。

# jquery - Fancybox/Lightbox 鼠标悬停效果

> ID：15581348
> 
> 赞同：1
> 
> 时间：2013-03-22T23:17:34.783
> 
> 标签：jquery, lightbox, mouseover

我正在建立一个展示我的客户摄影图像的网站。她要求弹出一个灯箱。这是我使用**Lightbox jQuery 插件**（已编辑）完成的，但现在她想要一个鼠标悬停效果，在相框中显示照片。这个网站[http://masteringretouching.com/proof1.php](http://masteringretouching.com/proof1.php)具有所需的效果，但我不知道该怎么做。有人可以帮忙吗？

# design-patterns - 跨层消息传递的中介者模式

> ID：15581354
> 
> 赞同：2
> 
> 时间：2013-03-22T23:18:04.850
> 
> 标签：design-patterns, layer, mediator

我正在实现一个简单的桌面应用程序，它分为 3 层：UI -> 服务/域 -> 存储库。

我正在考虑使用 Mediator 类，以便 UI 层可以通知其他层中其他类的进度，但其他类不耦合到 UI

.eg 有一个购买产品操作。我希望 UI 能够显示购买产品的详细进度，即它可以在屏幕上打印出进度： - 联系支付网关 - 完成支付 - 更新库存等

这是一个可接受的解决方案吗？或者有什么其他建议？

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T04:30:09.807

是的，我以前在这类事情上使用过调解器——特别是使用 guava 的 EventBus 作为调解器。

在我当前的项目中，我使用的是简化的 Observer：Observer 接口只有一个`signal()`方法（无参数）。在每个事件循环中，信号组件都会更新。

# git - 通过 X 提交提前 git...找不到解决方案

> ID：15581361
> 
> 赞同：0
> 
> 时间：2013-03-22T23:18:43.257
> 
> 标签：git, conflict, merge-conflict-resolution

这是顺序

此时我对分支没有任何编辑

1.  我`git pull --rebase`在一个跟踪到远程分支的分支中做了一个
2.  发生冲突
3.  我做了`git reset --hard`
4.  然后`git rebase --abort`

现在它说我的分支领先于 X 次提交

我又试了`git reset --hard`一次，然后再次`git fetch`git `git fetch origin`checkout 分支都无济于事

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T02:18:33.283

你是的事实是在你最初的时候做`X commits ahead`了暗示的结果（你后来也做了一个明确的）。这只是意味着这些提交还没有被推送到被跟踪的分支。这根本不是问题。推送这些提交后，此消息将消失。`git fetch``git pull``git fetch`

# android - 检查项目在使用 SimpleAdapter 制作的自定义 ListView 中的位置

> ID：15581364
> 
> 赞同：2
> 
> 时间：2013-03-22T23:19:08.473
> 
> 标签：android

My`ListView`看起来很棒，它正在从服务器加载新闻并将它们放在`ListView`. 所以我想做的就是用另一种颜色制作最新的新品，但这不能通过检查来工作：`if(position==0)`因为**不仅****第一项**将布局修改为我选择的颜色，而且**第三**项也改变了布局。不知道为什么是第3个。下面是我的代码：

```
 class simpleadapter extends SimpleAdapter
        {

            public simpleadapter(Context context, List<? extends Map<String, ?>> data,
                    int resource, String[] from, int[] to) {
                super(context, data, resource, from, to);
            }

            @Override
            public View getView(int position, View convertView, ViewGroup parent) {
                // TODO Auto-generated method stub
                final View view = super.getView(position, convertView, parent);
                //final TextView tvTitle = (TextView)view.findViewById(R.id.tvTitle);
                //final TextView tvContent = (TextView)view.findViewById(R.id.tvContent);

                final RelativeLayout rl = (RelativeLayout)view.findViewById(R.id.rl);

                if(position == 0)
                    rl.setBackgroundColor(Color.parseColor("#f0f0f0"));//here 'im changing the layout 
holding the item in another color.

                rl.setOnClickListener(new OnClickListener() {

                    public void onClick(View v) {
                        // TODO Auto-generated method stub

                    }
                });
                /*  tvTitle.setOnClickListener(new OnClickListener() {

                    public void onClick(View v) {
                        //Log.i(JohnMain,"Click on the Textview! Congrats!!!");
                        Toast.makeText(MainActivity.this, "Congrats!", Toast.LENGTH_LONG).show();
                    }
                });
                 */
                return view;
                //          return super.getView(position, convertView, parent);
            }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:40:12.363

这是因为s在他们滚出屏幕（并且没有被使用）后`ListView`回收他们的行。`View`因此，如果您设置了一行的颜色`View`，然后它滚动到屏幕外并被回收，它仍然会显示您之前设置的颜色，即使现在它位于不同的位置。一般的经验法则是显式设置`View`更改的行的每个属性。

您只需要`else`在代码中添加一条语句并明确设置每行的默认颜色。

```
 if(position == 0)
      rl.setBackgroundColor(Color.parseColor("#f0f0f0"));
 else
      rl.setBackgroundColor(/*Default Color*/); 
```

# devise - 使用 Rails 创建 FTP 用户帐户

> ID：15581365
> 
> 赞同：0
> 
> 时间：2013-03-22T23:19:10.877
> 
> 标签：devise, ruby-on-rails-3.2, ftp-server

好的，我不确定如何处理或解释这一点，但我会试一试。

我正在使用 Devise for auth 在我的 Mac 上开发 Rails 应用程序。

我想做以下事情：

当用户加入站点时，该应用程序会创建一个 ftp 用户帐户，该帐户具有与他们注册时相同的登录凭据（电子邮件/密码）。这样他们就可以使用站点的根 url 和他们的登录凭据通过 ftp 上传文件。

当用户更新他们的登录凭据时，他们的 ftp 用户帐户需要使用相同的凭据进行更新。

Paperclipftp 或carrierwaveftp 能处理这个吗？实现这一目标的最佳方法是什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T17:20:46.587

[这篇文章](http://offtheline.net/2009/1/6/ftp-authentication-via-rails)不是为您站点的每个用户设置单独的 FTP 帐户，而是通过编写一个控制器操作来处理 FTP 身份验证响应，而不是使用您的 Rails 用户的凭据。它使用[pure-ftpd](http://www.pureftpd.org/project/pure-ftpd)和自定义身份验证模块将带有凭据的 HTTP 请求发送到您的 Rails 应用程序，然后该应用程序将通过您喜欢的任何方式验证它们，并将适当的 FTP 响应返回给客户端。

我还没有尝试过，但我正在处理同样的问题，这种方法对我来说很有意义。

# vba - 多个单元格选择，而不是范围

> ID：15581368
> 
> 赞同：2
> 
> 时间：2013-03-22T23:20:00.490
> 
> 标签：vba, excel, loops, cells

我想遍历每一行并对选定的多个单元格执行一些操作，例如`K3,N3,Q3,T3,W3,Z3`下一个`K4,N4,Q4...`等。

我究竟做错了什么？

```
Sub Colors_test()
    For counter = 3 To 110
    Range("K" & counter, "N" & counter, "Q" & counter, "T" & _
         counter, "W" & counter, "Z" & counter).Select

    Selection.FormatConditions.AddColorScale ColorScaleType:=3
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    Selection.FormatConditions(1).ColorScaleCriteria(1).Type = _
        xlConditionValueLowestValue
    With Selection.FormatConditions(1).ColorScaleCriteria(1).FormatColor
        .Color = 7039480
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).ColorScaleCriteria(2).Type = _
        xlConditionValuePercentile
    Selection.FormatConditions(1).ColorScaleCriteria(2).Value = 50
    With Selection.FormatConditions(1).ColorScaleCriteria(2).FormatColor
        .Color = 8711167
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).ColorScaleCriteria(3).Type = _
        xlConditionValueHighestValue
    With Selection.FormatConditions(1).ColorScaleCriteria(3).FormatColor
        .Color = 8109667
        .TintAndShade = 0
    End With

    Next counter
    MsgBox "Ok All " & counter
End Sub 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T02:42:00.337

无需循环。您可以使用以下代码。

```
Sub Colors_test()

    With Range("K3:K110,N3:N110,Q3:Q110,T3:T110,W3:W110,Z3:Z110")
        .Select
      // your code here

    End With

End Sub 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-22T23:30:25.290

您需要将范围作为 1 个参数传递。试试这个：

```
Range("K" & counter & ",N" & counter & ",Q" & counter & ",T" & counter & ",W" & counter & ",Z" & counter).Select 
```

# java - setObject 和 null 的安全性

> ID：15581370
> 
> 赞同：4
> 
> 时间：2013-03-22T23:20:06.317
> 
> 标签：java, jdbc, prepared-statement

[PreparedStatement.setObject](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setObject%28int,%20java.lang.Object%29)的 Javadoc 说只传递空值是不安全的，并建议使用 setNull 代替，这需要传递列 DB 类型。

由于在 Java 中判断空值的类型并不是一件容易的事，我想知道是否有任何资源列出了为流行的数据库调用带有空值的 setObject 的安全性？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-22T23:41:17.253

oracle 的 java docs 上有一个相当有趣的页面。

[~是有趣的页面:)~](http://docs.oracle.com/javase/1.5.0/docs/guide/jdbc/getstart/mapping.html#table1)

阿比纳夫

根据 EJP 的评论编辑：

根据 Java 文档，以下 setObject 声明更好并推荐：

[void setObject(int parameterIndex, Object x, int targetSqlType)](http://docs.oracle.com/javase/7/docs/api/java/sql/PreparedStatement.html#setObject%28int,%20java.lang.Object,%20int%29)

*注意：并非所有数据库都允许将非类型 Null 发送到后端。为了获得最大的可移植性，应该使用 setNull 或 setObject(int parameterIndex, Object x, int sqlType) 方法来代替 setObject(int parameterIndex, Object x)。*

可以使用上面链接的映射列表来识别对象类型。

# ios - 旋转后如何调整 CAGradientLayer 的大小？

> ID：15581374
> 
> 赞同：15
> 
> 时间：2013-03-22T23:20:39.980
> 
> 标签：ios, objective-c, cocoa-touch, cocoa, cagradientlayer

我正在向`CAGradientLayer`视图添加一个。当视图自动调整大小时（例如旋转后），渐变层不会调整大小。可以将渐变设置为与视图相同的自动调整大小吗？另请注意，我在视图中使用了自动布局约束。

这就是我正在做的事情：

```
 CAGradientLayer *gradientLayer = [CAGradientLayer layer];
    gradientLayer.frame = CGRectMake(0.0, 0.0, frame.size.width, frame.size.height);
    gradientLayer.colors = [NSArray arrayWithObjects:
                       (id)[[UIColor colorWithRed:255.0/255.0f green:255.0/255.0f blue:255.0/255.0f alpha:1.0f] CGColor],
                       (id)[[UIColor colorWithRed:233.0/255.0f green:233.0/255.0f blue:233.0/255.0f alpha:1.0f] CGColor], nil];

    [self.layer insertSublayer:gradientLayer atIndex:0]; 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-11-18T22:27:01.653

这里有两种不同的方法来解决您的问题。

1.  制作`gradientLayer`实例变量而不是局部变量。然后，`layoutSubviews`在您的视图类中覆盖以设置渐变层的框架：

    ```
    - (void)layoutSubviews {
        [super layoutSubviews];
        _gradientLayer.frame = self.bounds;
    } 
    ```

2.  创建一个`UIView`named的子类`GradientView`，并重写它的`+layerClass`方法返回`[CAGradientLayer class]`。使用此视图绘制渐变，而不是直接使用图层。然后设置渐变视图`autoresizingMask`（如果您使用自动布局，则向其添加约束）。 有关示例，[请参见此答案。](https://stackoverflow.com/a/17558724/77567)

创建`GradientView`类还将使调整大小在旋转期间正常运行，因此我推荐该解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T23:34:12.573

我通过覆盖`setFrame:`视图的方法手动调整图层的边界：

```
-(void)setFrame:(CGRect)frame
{
    [super setFrame:frame];
    _gradientLayer.bounds = CGRectMake(0, 0, CGRectGetWidth(frame), CGRectGetHeight(frame));
} 
```

# linux - 如何在由 bash 脚本创建的文件中添加新行/回车符

> ID：15581378
> 
> 赞同：2
> 
> 时间：2013-03-22T23:20:58.540
> 
> 标签：linux, bash

在我的 bash 脚本中，我有：

```
echo -e '#!/bin/sh /n GIT_WORK_TREE=/home/realopti/domains/$name git checkout -f' >> ~/domains/$name.git/hooks/post-receive 
```

这会产生：

```
#!/bin/sh /n GIT_WORK_TREE=/home/realopti/domains/john git checkout -f 
```

在我的接收后文件中。

我希望文件看起来像：

```
#!/bin/sh
GIT_WORK_TREE=/home/realopti/domains/john git checkout -f 
```

我怎样才能做到这一点。

谢谢，

账单

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T23:22:33.817

应该是`\n`，不是`/n`。您可能还想删除它后面的空格，但这没关系。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T23:39:47.827

`cat`比`echo`这个更合适：

```
cat << \EOF > ~/domains/$name.git/hooks/post-receive
#!/bin/sh
GIT_WORK_TREE=/home/realopti/domains/john git checkout -f
EOF 
```

但对于这种特殊情况，使用模板可能更好。将您想要的内容放入`$HOME/template-dir/hooks/post-receive`并设置`GIT_TEMPLATE_DIR=$HOME/template-dir`在您创建 git 存储库的 shell 环境中。（也就是说，在你的启动文件中进行分配。）

# java - 无法从 Activity 或类调用自定义视图（canvasview）的方法

> ID：15581379
> 
> 赞同：1
> 
> 时间：2013-03-22T23:21:00.023
> 
> 标签：java, android

我无法从设置布局（包括视图）的 Activity 调用自定义视图（“canvasview”）的方法。我什至不能从活动中调用 canvasview 的“getter”。

此外，我将视图传递给自定义类（不扩展 Activity），并且我也无法从我的自定义类中调用 canvasview 的方法。

我不确定我做错了什么......

**游戏活动.java：**

```
public class GameActivity extends Activity implements OnClickListener
{

    private View canvasview;

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.game_layout);

        canvasview = (View) findViewById(R.id.canvasview);

        // Eclipse displays ERROR con those 2 method calls:
        int w = canvasview.get_canvaswidth();
        int h = canvasview.get_canvasheight();
    (...) 
```

**游戏布局.xml：**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout2"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".GameActivity" >

    (...)

    <com.example.test.CanvasView
        android:id="@+id/canvasview"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" />

</LinearLayout> 
```

**画布视图.java：**

```
public class CanvasView extends View
{
    private Context context;
    private View view;
    private int canvaswidth;
    private int canvasheight;

    public CanvasView(Context context, AttributeSet attrs)
    {
        super(context, attrs);
        this.context = context;
        this.view = this;
    }

    @Override
    protected void onSizeChanged(int width, int height, 
                                 int old_width, int old_height)
    {
        this.canvaswidth = width;
        this.canvasheight = height;
        super.onSizeChanged(width, height, old_width, old_height);
    }

    public int get_canvaswidth()
    {
        return this.canvaswidth;
    }

    public int get_canvasheight()
    {
        return this.canvasheight;
    } 
```

我对此感到很困惑：？

我还有另一个类（它不扩展“Activity”），它在构造函数中接收对 canvasview 的引用并且也无法“解决”它：？

谢谢，对不起，如果问题太明显，我从 Java 开始，这些事情让我很困惑......

**编辑：**

在睡觉时（凌晨 03:00），考虑到这一点，我注意到 Eclipse 将该行标记为错误，因为 View 对象实际上并没有 get_canvaswidth() 方法。只有子“CanvasView”方法有它。因此，我的问题可以通过**upcast**解决：

```
int w = ((CanvasView) canvasview).get_canvaswidth(); 
```

我的意思是我收到一个视图作为参数，但因为我现在它真的是一个视图子，我应该能够使用向上转换来调用“子”方法。现在 eclipse 不会产生错误**，但**w 和 h 总是报告 0 :-? . 我还测试了不使用答案中建议的向上转换，并在调用中发送和接收 CanvasView 对象，我也得到 0 :?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T23:22:54.617

```
private View canvasview; 
```

无论存储什么，`canvasview`您都只能调用由变量类型定义的方法。您需要更改此行。

```
private CanvasView canvasview; 
```

# java - 快速排序对除少数项目外的所有项目进行排序

> ID：15581382
> 
> 赞同：0
> 
> 时间：2013-03-22T23:21:08.610
> 
> 标签：java, quicksort

我花了很多时间试图找出我不正确的地方。调试等等，但我似乎无法解释为什么我的快速排序会错过一些排序项目。

我在下面复制了用于排序和分区的代码。我有一种感觉，这是一件非常明显的事情，我看得太多了，但我花了无数时间调试、研究和重写我的代码，结果总是一样。

```
// quicksort the subarray from a[lo] to a[hi]
private void sort(Comparable[] a, int lo, int hi) {
    if((hi-lo)>1){
        int pivot = partition(a,lo,hi);
        sort(a,lo,pivot);
        sort(a,pivot+1,hi);
    }
}

// partition the subarray a[lo .. hi] by returning an index j
// so that a[lo .. j-1] <= a[j] <= a[j+1 .. hi]
private int partition(Comparable[] a, int lo, int hi) {
    //find middle
    int pivotIndex = (hi+lo)/2;
    //pick pivot
    Comparable pivot = a[pivotIndex];
    //create left and right pointers
    int left = lo, right = hi;
    //start comparing
    //compare until left passes right
    while(left<right){
        //while left is less than pivot move on
        while(a[left].compareTo(pivot) < 0) left++;
        //while right is greater than pivot move on
        while(a[right].compareTo(pivot) > 0) right--;
        //if the pointers have passed each other we're done
        //if a[left] is greater than a[right] swap them
        if(a[left].compareTo(a[right]) > 0){
            Comparable holder = a[left];
            a[left] = a[right];
            a[right] = holder;
            //increment/decrement
            left++; right--;
        }
    }
    return right;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:54:23.757

只需删除`left++; right--;`，一切都会好起来的。

# mysql - 简单的不同列，无法理解它

> ID：15581387
> 
> 赞同：0
> 
> 时间：2013-03-22T23:21:39.637
> 
> 标签：mysql, distinct

我有以下查询...

```
SELECT DISTINCT TITLE, ID, IMAGE_1, IMAGE_1_DESCRIPTION
FROM PHOTO_GALLERY
ORDER BY ID ASC 
```

当然它会显示所有条目，但我希望它过滤掉任何具有相同 TITLE 字段的条目，只选择最低的 ID

我已经看到有一些与此查询类似的问题，但我似乎无法通过研究它们来找出我的问题的答案。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:27:11.527

select 对“from”位中的表进行笛卡尔积。“在哪里”剔除那些不满足条款的人。“order by”对其余部分进行排序。混合是不同的 - 你得到的第一行与下一行不同。

所以在标题上添加一个 where 子句并使用 LIMIT

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:28:05.110

Distinct 返回指定列集的唯一行。也许您应该尝试将其用作子查询：

```
select min(id), title from photo_gallery group by title 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T23:33:03.700

你需要一个`group by`，而不是一个`distinct`。要获得最低的 id：

```
SELECT TITLE, min(ID) as minid
FROM PHOTO_GALLERY
group by title
ORDER BY minID ASC 
```

要获取其余信息，您需要重新加入表。这是一个具有显式联接的版本：

```
SELECT pg.TITLE, pg.ID, pg.IMAGE_1, pg.IMAGE_1_DESCRIPTION
FROM PHOTO_GALLERY pg join
     (SELECT TITLE, min(ID) as minid
      FROM PHOTO_GALLERY
      group by title
     ) pgt
     on pg.title = pgt.title and pg.id = pgt.minid
ORDER BY ID ASC 
```

# ruby - 在 Ruby 中将 Oracle 结果集转换为可打印数组的最简洁方法是什么？

> ID：15581388
> 
> 赞同：1
> 
> 时间：2013-03-22T23:21:40.797
> 
> 标签：ruby, oracle

这是使用 Ruby 从 Oracle 获取结果的最简洁方式吗？

```
require 'oci8'
results_array = Array.new
oci.exec('select column_a from table_a') do |row|
  results_array.push(row)
end
results_array.each do |result|
  puts result
end 
```

我希望看到更简洁的内容，例如：

```
require 'oci8'
results_array = oci.exec('select column_a from table_a')
puts results_array 
```

但是当我尝试这个时，我得到一个 Oracle Cursor 错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:28:37.677

如果您只想`puts`行：

```
oci.exec('select column_a from table_a') { |row| puts row} 
```

如果您想构建一个数组以供以后使用：

```
results_array = []
oci.exec('select column_a from table_a') { |row| results_array << row }
puts results_array.join("\n") 
```

希望这可以帮助 ：）

# ruby - Selenium Webdriver - Ruby 不支持的命令

> ID：15581389
> 
> 赞同：1
> 
> 时间：2013-03-22T23:21:57.780
> 
> 标签：ruby, selenium, ide, webdriver

使用 Selenium IDE，我导出了一个基本测试，该测试登录到一个帐户，将鼠标悬停在下拉菜单上，然后找到注销按钮。然后测试结束。

我看到的问题是，当在 ruby​​/test::unit/web 驱动程序中导出测试时，我以前`waitForPopUp`的命令不受支持并返回

```
# ERROR: Caught exception [ERROR: Unsupported command [waitForPopUp | _self | 30000]] 
```

我需要 ruby​​ 翻译导航到鼠标悬停，否则测试将超时并返回错误。另外，如果我再次遇到这个问题，如果您可以将我链接到 ruby​​ webdriver 命令列表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T03:34:14.343

将使用 Selenium IDE 创建的测试用例导出到 Ruby 等语言时，有些命令没有完美转换。waitForPopUp 恰好是这些命令之一。相反，您需要在代码中找到无法转换的行并编写支持的命令来执行相同的操作。

您可能想使用这样的东西（未经测试的代码！）：

```
# This code defines the method
def wait_for_and_switch_to_new_popup(timeout = 30) # seconds
  Selenium::WebDriver::Wait.new(:timeout => timeout,:message => "Failed to find popup within #{timeout} seconds!").until do
    @driver.window_handle != @driver.window_handles.last
  end
  @driver.switch_to.window(@driver.window_handles.last)
end 

...

# This calls the method to wait for and switch to the new popup.
# Use this inside your code to tell the browser to switch to the new popup
wait_for_and_switch_to_new_popup 
```

* * *

要了解有关 Selenium WebDriver 的 Ruby 绑定（DSL）的更多信息，您可以在官方 Wiki 页面上了解它们：[http ://code.google.com/p/selenium/wiki/RubyBindings](http://code.google.com/p/selenium/wiki/RubyBindings)

# sql-server - 跳过 OPENROWSET 中的列 (BULK)

> ID：15581392
> 
> 赞同：0
> 
> 时间：2013-03-22T23:22:17.300
> 
> 标签：sql-server

尝试将大量行批量插入表中。

我的 SQL 语句：

```
INSERT INTO [NCAATreasureHunt-dev].dbo.CatalinaCodes(Code)
SELECT (Code)
   FROM OPENROWSET(BULK 'C:\Users\Administrator\Desktop\NCAATreasureHunt\10RDM.TXT',
       FORMATFILE='C:\Users\Administrator\Desktop\NCAATreasureHunt\formatfile.xml') as t1; 
```

10RDM.TXT：

```
DJKF61TGN7
Q9TVM16Z6Z
X44T4169FN
JQ2PT1ZXZK
C7NW71QPNG
SFJRR1FWKZ
TYZJW1ZPFY
9MR3M1J3N5
QJ6R217JTK
TVJVW19TYT 
```

格式文件.xml

```
<?xml version="1.0"?>
<BCPFORMAT xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <RECORD>
        <FIELD ID="C1" xsi:type="CharTerm" TERMINATOR="\r\n"/>
    </RECORD>
    <ROW>
        <COLUMN SOURCE="C1" NAME="Code" xsi:type="SQLNVARCHAR" />
    </ROW>
</BCPFORMAT> 
```

这是我得到的错误：无法将值 NULL 插入“已声明”列，列不允许空值。插入失败。

我正在尝试跳过已声明的列。我在格式文件中做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:29:13.760

看看这个[答案](https://stackoverflow.com/questions/8347254/bcp-import-error-with-xml-format-file-and-identity-column)是否有帮助。

> 对于 XML 格式文件，当您使用 bcp 命令或 BULK INSERT 语句直接导入表时，不能跳过列。但是，您可以导入到表的最后一列以外的所有列。如果必须跳过除最后一列以外的任何列，则必须创建目标表的视图，该视图仅包含数据文件中包含的列。然后，您可以将该文件中的数据批量导入到视图中。
> 
> 要使用 XML 格式文件通过 OPENROWSET(BULK...) 跳过表列，您必须在选择列表和目标表中提供明确的列列表，如下所示：
> 
> 插入...从开放式集中选择（批量...）

# css - ipad web 应用程序导致某些 div 不显示

> ID：15581394
> 
> 赞同：0
> 
> 时间：2013-03-22T23:22:25.260
> 
> 标签：css, ipad, web-applications

在 Chrome 和 Safari（在 ipad 上）上，一切都按原样显示。但是，当我“添加到主屏幕”时，只显示我的背景图像，而其他 div 不显示。我认为这可能与其他 div 的 z-index 或位置有关，但我不知道该怎么做。

CSS

```
#map{ background: url('img/map.png');} 

#map_gate{
z-index: 100;
width: 299px;
height: 313px;
top: 149px;
left: 539px;
position: absolute;
background: url('img/map_gate_closed.png');}

#map_dora{
z-index: 200;
width: 65px;
height: 91px;   
top: 473px;
left: 83px;
position: absolute;
background-image:url('img/map_dora.png');} 

.background{
z-index: 1;
top: 0;
left: 0;    
width: 1024px;
height: 768px;
position: fixed;    
display: none;
overflow: hidden;}

.selected_area {
z-index: 10;
text-align:center;
position: fixed;    
display: none;
/*background-repeat:no-repeat;*/
overflow: hidden;} 
```

HTML

```
<div id="map" class="background map"></div>
<div id="map_gate" class="selected_area map"></div>
<div id="map_dora" class="selected_area map"></div> 
```

# c++ - 无法在 DirectShow 中显示两个摄像头

> ID：15581396
> 
> 赞同：2
> 
> 时间：2013-03-22T23:22:34.240
> 
> 标签：c++, camera, directshow, samplegrabber

我正在使用两个 DirectShow 图表，在不同的线程上运行，以显示流视频（单独使用 VMR 9）并从两个网络摄像头捕获帧（使用 Sample Grabber）。其中一个是内置网络摄像头 (HP TrueVision HD)，另一个是连接到 USB 端口的 Creative VF0520。其他 USB 端口均未使用。

问题是 Creative 相机打开（LED 亮起），但没有流通过。即使我禁用了内置网络摄像头，问题仍然存在。但是，如果在只有 Creative cam 连接的摄像头的桌面上运行，Creative cam 可以正常工作。

该程序在每个摄像头是唯一连接的情况下工作（Creative VF0520 在它是唯一连接到桌面的摄像头时工作），但是当连接两个摄像头时，视频显示和抓帧仅适用于内置网络摄像头。

我怀疑这个问题可能来自与捕获过滤器的名字对象绑定。我正在使用来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/dd377566%28v=vs.85%29.aspx)的修改代码。这是绑定绰号以捕获多个相机的过滤器的正确方法吗？

```
ULONG VideoPlayer::GetMonikers(IEnumMoniker *pEnum, std::vector<IMoniker *> *pListMonikers)
{
ULONG numRetrieved =  0;
IMoniker* pMoniker = NULL;

while (pEnum->Next(1, &pMoniker, &numRetrieved) == S_OK)
{
// Bind to vector
pListMonikers->push_back(pMoniker);

    IPropertyBag *pPropBag;
    HRESULT hr = pMoniker->BindToStorage(0, 0, IID_PPV_ARGS(&pPropBag));
    if (FAILED(hr))
    {
        (*ppMoniker)->Release();
        continue;  
    }
    // Get information to display

    pPropBag->Release();
}

return numRetrieved;
} 
```

然后访问包含名字对象的向量以绑定到捕获过滤器：

```
hr = listMonikers[CAMERA_ID]->BindToObject(NULL, NULL, IID_IBaseFilter, (void**)&pCap); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T09:41:03.010

您对 2 个以上 USB 网络摄像头进行故障排除的第一个也是最好的猜测是达到 USB 带宽限制。使用 USB 视频，您有很高的机会点击它，尤其是。你提到的所有症状。请务必阅读之前的问题：

*   [使用 DirectShow 一次运行多个网络摄像头](https://stackoverflow.com/questions/11986119/run-multiple-webcams-at-a-time-using-directshow/12197797#12197797)
*   [2个USB摄像头不适用于opencv](https://stackoverflow.com/questions/11222813/2-usb-cameras-not-working-with-opencv)
*   [使用许多 USB 网络摄像头的影响](https://stackoverflow.com/questions/2519057/implications-of-using-many-usb-web-cameras)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-06T01:37:34.640

这很可能与 USB 硬件有关。下载 vlc 并检查是否可以从 2 个不同 vlc 实例上的两个摄像头获取视频。

vlc.exe -> 媒体 -> opencapturecapture

如果你不能，然后开始钻研usb。可能是您的第二个 USB 相机正在被 USB 1.0 控制器拾取。我不认为它是directshow，因为我可以让多个摄像机与directshow一起工作。

我有同样的问题，它与 USB 带宽和 USB 控制器有关。尝试将相机也插入不同的 USB 端口。这可能会奏效。

# javascript - WordPress 在哪里存储自定义帖子类型？

> ID：15581398
> 
> 赞同：0
> 
> 时间：2013-03-22T23:22:53.270
> 
> 标签：javascript, jquery, html, css, wordpress

我在 WordPress 上下载了一个主题，安装它并添加了一些页面等。我想为其添加一些功能，所以我决定使用 jQuery 添加一个粘性菜单。我已经安装了相关脚本并使插件正常工作。

我从 themeforest 下载的主题允许最终用户创建一个“部分”，这基本上是一种自定义内容类型，可以分解页面的某些部分。所以在我的主页上，我已将页面的部分内容分成多个部分，但我想将粘性添加到特定部分，因此当您向下滚动到它时，该部分始终保持在视图中。

要使用粘性插件，我需要将一个类应用到父 div 或将父 div 包装在标签中。所以我的问题是，有没有办法实际编辑自定义内容类型的代码？我知道 WordPress 是基于模板工作的，所以每次创建页面、发布等时，它都会存储在数据库中。但肯定有一种方法可以编辑特定页面的代码。

我希望我说得通。对于任何想知道我对继承人的看法的人，请点击链接 - www.gogoblondie.com

该网站仍在开发中，但它是黑色部分，我想在用户滚动时粘贴。

阿兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:22:38.770

根据您的标记结构和需求：

```
jQuery('nav').closest('.section').sticky({topSpacing:0}); 
```

将工作。

# c# - 查看输入的文本框值是否作为数组的一部分存在

> ID：15581402
> 
> 赞同：0
> 
> 时间：2013-03-22T23:23:10.807
> 
> 标签：c#

我正在使用 VS 2012、Windows 窗体项目、C#

我有一系列产品`products[]`，我从项目中的 XML 文件中获取这些产品。用户将使用数字键盘输入产品 ID（4 位数字，只读文本框），然后我在其中搜索`products[]`以找到与 ID 匹配的价格并将用户返回他们的“更改”。如何防止用户输入无效的产品 ID，或者在他们输入 ID 并单击“购买”后告诉他们“错误，此 ID 不存在”。这是我的购买按钮代码，在用户投入他们的“钱”并为产品选择了 4 位数之后。

`CoinChange`是为银行提供给我们的 DLL 中的一个类，它有一个调用的方法，该方法`TotalChange`接受两个参数来返回更改，`decimal productprice`并且`decimal amountDeposited`

```
private void btnPurchase_Click(object sender, EventArgs e)
{
    TextReader reader = null;
    decimal productprice;
    decimal amountDeposited = Convert.ToDecimal(txtDepositAmount.Text);
    int productChoice = Convert.ToInt16(txtChoice.Text);
    XmlSerializer serializer = new XmlSerializer(typeof(Product[]));
    reader = new StreamReader("../../XML/Drinks.xml");
    Product[] products = (Product[])serializer.Deserialize(reader);
    for (int x = 0; x < products.Length; x++)
    {
        if (products[x].productID == productChoice)
        {
            productprice = products[x].price;
            CoinChange CC = Service.TotalChange(productprice, amountDeposited);
            MessageBox.Show("Refund amount:" + "\r\n" + "Nickel: " + CC.Nickel.ToString() + "\r\n" + "Dime: " +
              CC.Dime.ToString() + "\r\n" + "Quarter: " + CC.Quarter.ToString());

            break;
        }
    }
} 
```

如果格式不正确，请不要对我大喊大叫，我是该网站的新手，我会修复它，只是让我知道需要修复什么。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:26:02.647

```
 for (int x = 0; x < products.Length; x++)
    {
        if (products[x].productID == productChoice)
        {
            productprice = products[x].price;
            CoinChange CC = Service.TotalChange(productprice, amountDeposited);
            MessageBox.Show("Refund amount:" + "\r\n" + "Nickel: " + CC.Nickel.ToString() + "\r\n" + "Dime: " +
                            CC.Dime.ToString() + "\r\n" + "Quarter: " + CC.Quarter.ToString());
            return;  // Found and handled the product
        }
    }
    // If we get here none of the products matched
    MessageBox.Show("Invalid product ID.  Please check your catalog and try again."); 
```

# matlab - 将相似输入映射到相似输出的有效方法

> ID：15581409
> 
> 赞同：0
> 
> 时间：2013-03-22T23:24:18.977
> 
> 标签：matlab, matrix, indexing, mapping, large-data

在 matlab 中是否有一种有效的方法来解决这个特定问题。

我正在尝试映射此矩阵或可能的数组 BeansRice（见下文）

```
Beans={0:1,0:1,0:2,0:2,0:2,0:2,0:1,0:1,0:2,0:2}
[a b c d e f g h i j ] = ndgrid(Beans{:})
BeansRice = [a(:) b(:) c(:) d(:) e(:) f(:) g(:) h(:) i(:) j(:)] 
```

进入矩阵/数组BR（见下文）

```
BR=[abc, de, fg, hij]; 
```

如果 a、b 和 c 列的值均为 0（关系偏好），则我偏好 c>b>a。如果所有列 a、b 和 c 的值都为 1（无偏好），则 BR(1)=1。如果 a 和 b 列的值为 0，c 列的值为 2，则 BR(1)=2。如果 a 和 b 列的值为 1，c 列的值为 2，则 BR(1)=1。

我有一个带有索引的 if 函数，但我在想是否可以改进它，使用矩阵中值的等级/顺序来打破平局。寻找一个更有效的过程，因为这只是一个大问题的一个子问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T06:52:13.843

您可以使用逻辑索引而不是 if 条件。例如

```
BR1(a==1 & b==1 & c==1)=1
BR1(a==0 & b==0 & c==2)=2
BR1(a==1 & b==1 & c==2)=1
... 
```

然后处理其他部分，`BR2(d==... & e>...)=##`，然后连接以获得你需要的东西

`BR=[BR1(:) BR2(:) ...]`

ETC...

# javascript - 如何在不创建新对象的情况下更改 nokia.maps.map.StandardMarker 的颜色？

> ID：15581410
> 
> 赞同：0
> 
> 时间：2013-03-22T23:24:31.030
> 
> 标签：javascript, here-api

我一直在尝试这样的事情： laststmarker is a nokia.maps.map.StandardMarker ncolor is a string= #0000FF

```
 laststmarker.brush=ncolor;
    laststmarker.brush="{color:'"+ncolor+"'}";
    laststmarker.brush={color:ncolor}; 
```

和其他东西，我如何在不删除的情况下更改颜色并将其再次添加到地图中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T12:29:38.797

这里要注意的重要一点是**画笔**是[不可变](http://developer.here.com/docs/maps_js/topics/observers.html)的——这意味着你不能直接更新参数——你需要使用设置器，例如 `marker.set("brush" , { color :"#FF0000"});`——这通常是`map.update(-1,0);`为了刷新地图。

下面的示例在鼠标指针悬停在标记上时突出显示该标记。您需要使用自己的[应用程序 ID 和令牌](http://www.developer.nokia.com/Community/Wiki/How_to_Obtain_Your_Own_Nokia_appID_and_Token)才能使其正常工作。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
<meta http-equiv="X-UA-Compatible" content="IE=7; IE=EmulateIE9" />

<base href="http://www.wrc.com/" />
<title>Highlighing a marker</title>
<meta name="description" content="" />
<meta name="keywords" content="" />
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

<script language="javascript"  src="http://api.maps.nokia.com/2.2.4/jsl.js" type="text/javascript" charset="utf-8"></script>

</head>
<body>
<p> Place your pointer over the marker to highlight it.</p>
<div id="gmapcanvas"  style="width:600px; height:600px;" >&nbsp;</div><br/><br/>    

<script type="text/javascript">
// <![CDATA[    

/////////////////////////////////////////////////////////////////////////////////////
// Don't forget to set your API credentials
//
// Replace with your appId and token which you can obtain when you 
// register on http://api.developer.nokia.com/ 
//
            nokia.Settings.set( "appId", "YOUR APP ID GOES HERE"); 
            nokia.Settings.set( "authenticationToken", "YOUR AUTHENTICATION TOKEN GOES HERE");

/////////////////////////////////////////////////////////////////////////////////////   

 map = new nokia.maps.map.Display(document.getElementById('gmapcanvas'), {
     'components': [ 
        // Behavior collection
        new nokia.maps.map.component.Behavior() ],
    'zoomLevel': 5, // Zoom level for the map
    'center': [41.0125,28.975833] // Center coordinates
});
// Remove zoom.MouseWheel behavior for better page scrolling experience
map.removeComponent(map.getComponentById("zoom.MouseWheel"));

var normalMarker  =  new nokia.maps.map.StandardMarker(new nokia.maps.geo.Coordinate(41.0125,28.975833), {brush: {color: "#FF0000"}});
normalMarker.addListener("mouseover" ,  function(evt) { 
        normalMarker.set("brush" , { color :"#0000FF"});
        map.update(-1,0);

 }, false);

normalMarker.addListener("mouseout" ,  function(evt) { 
        normalMarker.set("brush" , { color :"#FF0000"});
        map.update(-1,0);

 }, false);     

map.objects.add(normalMarker);

// ]]>
</script>

</body>
</html> 
```

# nltk - 检查 Nltk POS 标签

> ID：15581412
> 
> 赞同：0
> 
> 时间：2013-03-22T23:24:33.467
> 
> 标签：nltk

我只是在使用 Python 学习 nltk。我正在使用 POS 标记。我想知道的是如何使用标签。例如，这是伪代码：

```
words = []
teststr = "George did well in the test."
tokens = nltk.word_tokenize(teststr)
words = nltk.pos_tag(tokens) 
```

我想做这样的事情：

```
if words[i] == "proper noun":
    #do something 
```

如何检查一个词是名词还是动词或任何其他词性。有人可以帮我吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:31:13.683

如果您查看 pos_tag 函数调用的结果，则会返回以下列表：

```
[('George', 'NNP'), ('did', 'VBD'), ('well', 'RB'), ('in', 'IN'), ('the', 'DT'), ('test', 'NN'), ('.', '.')] 
```

如果您遍历列表以根据专有名词的值执行某些操作，则需要以下代码：

```
if words[i][1] == 'NNP':
    # do something 
```

NNP 是单数专有名词。该列表中的每个条目都是一个元组，其中第一个值是单词，第二个值是 pos。

# mysql - 替换通配符 %LIKE% 查询

> ID：15581420
> 
> 赞同：0
> 
> 时间：2013-03-22T23:25:03.070
> 
> 标签：mysql

我有一个文件路径搜索，允许用户在网站上搜索他/她的文件。示例条目是：

```
`path`
- /Volumes/Fulfill/03-01-13/FILFILE.txt
- /Volumes/Master/.Trash/Weeds.mov 
```

如果有人搜索“master mov”，它将执行以下查询：

```
SELECT * FROM files WHERE path LIKE '%master%' AND path LIKE '%mov%' 
```

并会返回：

```
- /Volumes/Master/.Trash/Weeds.mov 
```

进行上述搜索的更好方式或方法是什么？

**更新**：我尝试执行以下操作，但我的`MYISAM FULLTEXT`搜索实现根本无法正常工作：

```
select * from path where path like '%red%' and path like '%state%' <-- works
select * from path where match(path) against ('red state'); <-- zero results 
```

除了上述方法之外，还有另一种实现全文搜索的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:34:44.953

% 是通配符。如果你用这样的东西替换它会更快：

```
SELECT * FROM files WHERE path LIKE '/Volumes/Master%mov' 
```

因为您没有检查更多条件。

**更新**

对于全文选项，您会（一次）

```
ALTER TABLE files ADD FULLTEXT(path); 
```

然后对于你会的搜索

```
SELECT * FROM files
WHERE MATCH (path)
AGAINST ('+Master +mov' IN BOOLEAN MODE); 
```

忽略短词，默认最小长度为 4 个字符。您可以使用变量 ft_min_word_len 和 ft_max_word_len 更改最小和最大字长

# android - 为聊天创建可滚动布局

> ID：15581425
> 
> 赞同：0
> 
> 时间：2013-03-22T23:26:07.710
> 
> 标签：android, chat

我正在寻找一种在我的应用程序中实现聊天的方法。我已经实现了一种获取传入消息和传出消息的方法。所以我唯一的问题是如何为聊天创建布局。但我真的想不通。看了之后，我发现了一个看起来像聊天的布局（[http://code.google.com/p/simple-android-instant-messaging-application/source/browse/trunk/res/layout/messaging_screen.xml?r =6](http://code.google.com/p/simple-android-instant-messaging-application/source/browse/trunk/res/layout/messaging_screen.xml?r=6) ):

```
 <?xml version="1.0" encoding="utf-8"?>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android" 
        android:orientation="vertical"
        android:padding="10dip" 
        android:layout_width="fill_parent"
        android:layout_height="fill_parent">
    <!--    
    <TextView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="10dip"
        android:text="Friend:"
    />

    <EditText android:id="@+id/friendUserName"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:clickable="true"
        android:singleLine="true"
        android:editable="false" />
    --> 
    <TextView   android:layout_width="fill_parent"
                        android:layout_height="wrap_content"
                        android:layout_marginBottom="10dip"
                        android:text="Messages:"/>

    <EditText   android:id="@+id/messageHistory"
                        android:layout_width="fill_parent"
                        android:layout_height="fill_parent"
                        android:clickable="true"        
                        android:layout_weight="1"
                    android:editable="false"
                    android:gravity="top"
                    android:scrollbars="vertical"
                    android:scrollbarSize="10px"
                    /> 

    <LinearLayout android:orientation="horizontal"
                          android:layout_width="fill_parent"
                          android:layout_height="fill_parent"
                          android:layout_weight="4">

                        <EditText       android:id="@+id/message"
                                                android:layout_width="fill_parent"
                                        android:layout_height="fill_parent"
                                        android:gravity="top"
                                        android:layout_weight="1"
                                        />

                    <Button android:id="@+id/sendMessageButton"
                                android:layout_width="fill_parent"
                                android:layout_height="fill_parent"
                                android:layout_weight="4"
                                android:text="Send"/>

        </LinearLayout>

</LinearLayout> 
```

我不知道我是否以错误的方式使用它，但每条传入的消息总是出现在同一个文本视图中，用新的传入消息覆盖之前的消息。我想可能我需要为 JAVA 方面做更多的事情。

换句话说，我想要的是消息看起来可滚动的地方，并且每条到达的新消息都应该出现在右侧，并且一个接一个。传出消息应出现在左侧。我说的当然是 iPhone 等中 SMS 应用程序的外观。

我不明白该怎么做。如果有人知道一种解决方法，或者任何关于如何实现它的信息，那将是非常受欢迎的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:32:09.987

您需要实现一个屏幕，其中`ListView`显示所有个人聊天消息历史记录，并`EditText`在底部实现用户输入新文本。可能有各种支持 UI 元素，例如顶部的标题和“发送”按钮。

如果需要，每个`ListView`项目都将显示消息以及日期戳和其他信息。您可以为传入和传出消息使用不同的背景。

找到任何示例`ListView`并从那里开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:29:49.193

你想要的是一个`ListView`显示你的消息的。任何消息都将成为您的`ListView`. 对于内容，您必须实现一个`Adapter`知道您的消息数据结构的内容。ListView 中的 ListView、Adapter 和自定义视图的好例子是[http://www.ezzylearning.com/tutorial.aspx?tid=1763429](http://www.ezzylearning.com/tutorial.aspx?tid=1763429)

# php - PHP 类可以包含函数 `get_class_methods` 未列出的方法吗？如果是这样，怎么做？如果不是，为什么会出现？

> ID：15581428
> 
> 赞同：1
> 
> 时间：2013-03-22T23:26:30.370
> 
> 标签：php

我正在研究一些 Magento 代码。

我在看课`Mage_Catalog_Model_Session`

类`Mage_Catalog_Block_Product_List_Toolbar extends Mage_Core_Block_Template`函数中有`getCurrentOrder`这样的代码：

Mage::getSingleton('目录/会话')->getSortOrder();

现在，`Mage::getSingleton('catalog/session')`返回一个类型的对象`Mage_Catalog_Model_Session`

所以我认为这`getSortOrder()`是该类的一种方法，尽管该方法似乎与该工具栏类而不是该会话类一起使用。

这一行应该给我类的方法列表：

```
print_r(get_class_methods(get_class($_test))); 
```

它似乎确实存在，但未`getSortOrder()`列出。

那么，哪个类是`getSortOrder()`其成员以及它是如何 A.) 似乎是它不是其成员的类的成员，或 B.) 是该类的成员但未出现在`get_class_methods()`结果集中?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:31:35.217

听起来像是`getSortOrder()`一个重载的方法。[有关重载的更多信息，请参见此处](http://php.net/manual/en/language.oop5.overloading.php)。取自链接：

`Overloading in PHP provides means to dynamically "create" properties and methods.`

`get_class_methods()`不会显示重载的方法，因为它们是*在调用时在现场创建的*（因此无法知道它们。）许多框架使用重载的 getter。

顺便说一句，有关如何实现 getter 重载的示例，请参见此[答案。](https://stackoverflow.com/a/8743064/1740868)

# javascript - Python - 来自 Windows 机器的日期对象 - 时区问题

> ID：15581431
> 
> 赞同：1
> 
> 时间：2013-03-22T23:26:46.433
> 
> 标签：javascript, python, date, strptime

我有一个 jQuery 应用程序，它将日期对象发送到 python 进行解析。问题是当我尝试在 Windows 机器上使用我的 jQuery 时，日期对象如下所示：

```
Tue Mar 12 2013 00:00:00 GMT-0600(Mountain Daylight Time) 
```

而在我的 Mac 上，我得到：

```
Tue Mar 12 2013 00:00:00 GMT-0600(PST) 
```

当我尝试使用`strptime`函数在 Python 中解析这些时，它失败了，因为它不理解第一个（MDT 一个）末尾的时区。它抱怨这是一种“未知的字符串格式”。

我该如何解决这个问题？难道我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:56:58.647

这里*最好*的解决方案可能是让您的`jQuery`代码在发送之前将其日期时间转换为 GMT。（如果您也想要时区，请单独发送。）然后您可以将它们从 Python 端的 JSON（或其他）中取出，使用 将它们转换为 GMT`datetime`对象`strptime`，然后使用它们，您就完成了。

但*最简单*的解决方案*，代码更改最少，就是让 jQuery 做错事并在 Python 端丢弃时区。基本上，而不是这样：

```
dt = datetime.datetime.strptime(jsondate) 
```

做这个：

```
dt = datetime.datetime.strptime(jsondate.partition('(')[0]) 
```

请注意，在静止之后扔掉所有东西`'('`会给你留下`-0600`部分；你只是失去了“PST”或“山地日光时间”部分。

无论如何，这些部分对你没有任何好处。`datetime`不理解这些时区名称。而且，即使它这样做了，除了偏移量（你已经拥有）之外，它没有任何东西可以映射它们。如果您想要实时时区，则需要一些第三方库，例如[`pytz`](http://pytz.sourceforge.net).**

最重要的是，`strptime`专门返回天真`datetime`的对象，而不是有意识的对象。因此，即使`datetime`可以解析和查找时区，它仍然不会对它们做任何有用的事情，除非您解析`datetime`，然后拉出时区并单独解析并查找它，然后调用`astimezon`.`datetime`

因此，总而言之，丢弃这些信息的最坏情况正是您已经拥有的。

附带说明一下，在连续三个项目中，我将日期时间序列化器推入 Python 端的 JSON 编码/解码器（以及 JS 端的匹配序列化器，用于具有 JS 端的序列化器），这样我就可以传递一个 UTC 日期时间（采用 ISO8601 格式，因为这对于计算机来说就像一个自纪元以来的秒数一样易于使用，并且对于人类来说更容易阅读/编辑）和一个时区偏移量，但如果它切换到一个 tzinfo 键因为以后很重要。所有这三次，它从未变得重要......而它*一直*很重要的项目，我通常会传递 ICAL 时间表或公历前的日期或其他类似的有趣的东西。

最后，作为一个在我的职业生涯中写了太多与日期相关的代码的人，我不得不说：如果你知道任何邪恶的霸主计划接管世界，如果他们承诺废除时区，我愿意忽略他们其他奴役人类或让小猫与婴儿打架并注册为心腹的计划。

* ... 至少对我来说最简单，因为我比 JS 和 jQuery 更了解 Python。:)

** IIRC，`pytz`也无法处理 NT 风格的时区键，例如“Mountain Daylight Time”，因此您实际上需要另一个库来处理它。我想我是从一个处理各种 MS 日期时间的库中得到的，包括处理微软三个类似的 1601-ish 纪元时间之间的差异（两个不太相同的纪元，不同的特殊“时间结束规则”） " 和 "开始时间" 和 "不是日期" 值，...)。

# mips - 在真机上运行 MIPS 指令 [不在模拟器上]

> ID：15581433
> 
> 赞同：0
> 
> 时间：2013-03-22T23:26:49.417
> 
> 标签：mips, emulation

我在大学里研究 MIPS，我们正在使用*Qtspim*模拟器来运行*MIPS*指令。我已经用谷歌搜索了如何在我的真机上运行*MIPS*代码（**不是**像 SPIM 这样的任何模拟器），但我找不到任何评论。*是否可以从MIPS*指令创建可执行文件？

在我的另一堂课（系统编程）中，我们一直在使用*MASM615*`make32`通过使用来自 cmd 的命令来编译汇编指令。我正在寻找任何类似的工具。MIPS 是否存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-30T02:37:13.067

> 是否可以从 MIPS 指令创建可执行文件？

是的，因为汇编器只是一个读取一些输入并产生一些输出文件的程序，因此您可以从任何其他架构为任何架构进行汇编，就像从您的 PC 为其他架构[交叉编译的可能性一样](https://en.wikipedia.org/wiki/Cross_Compiler)

但是执行输出文件是完全不同的事情。每个架构都有自己的机器语言。就像人类无法理解说其他语言的人一样，机器只能理解用它的语言编写的程序。这意味着 MIPS 硬件只能理解和运行 MIPS 二进制文件。x86 等其他架构无法解释具有不同指令编码的另一个指令集

因此，您唯一的方法是使用[模拟器](https://en.wikipedia.org/wiki/Emulator)或[模拟器](https://en.wikipedia.org/wiki/Simulation)

也可以看看

*   [如何在 x86 linux 上执行 MIPS 汇编程序？](https://stackoverflow.com/q/464313/995714)
*   [如何在 x86 平台上运行 MIPS 二进制文件？](https://stackoverflow.com/q/43563286/995714)
*   [如何在 MIPS 平台上运行 i386 二进制文件？](https://stackoverflow.com/q/27543870/995714)

# android-layout - Android Fragment 界面无响应

> ID：15581440
> 
> 赞同：0
> 
> 时间：2013-03-22T23:27:37.827
> 
> 标签：android-layout, android-fragments, actionbarsherlock

我的程序有一个奇怪的问题，我无法解释，到目前为止我还没有找到解决方案。我有一个简单的活动，它将在片段之间切换并通过应用程序的初始设置运行用户。第一个片段只是顶部的文本视图，底部有一个按钮，onClickListener 设置为调用父活动上的方法，但是在测试中，当我单击按钮时，没有任何反应。它不会像普通按钮那样改变颜色，并且似乎没有点击注册。

这是布局的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:text="@string/setup_intro" />

<Button
    android:id="@+id/next_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:clickable="true"
    android:width="72dp"
    android:text="@string/next_button" />

</RelativeLayout> 
```

这是我实现 onClickListener 的片段代码

```
public class SetupFragmentInitialScreen extends SherlockFragment
{
    @Override
    public View onCreateView(LayoutInflater inflater, 
                             ViewGroup container,
                             Bundle savedInstanceState)
    { 
        View parentView = null; 
        parentView = inflater.inflate(R.layout.setup_fragment_initial_screen, 
                                      container, 
                                      false);

        Button nextButton = (Button)parentView.findViewById(R.id.next_button);
        nextButton.setOnClickListener(new OnClickListener()
        {
            @Override
            public void onClick(View v) 
            {
                Log.v("ButtonPressed", "You Pressed the button!");
                ((InitialActivity)getActivity()).onInitialScreenNextPress();
            }
        });

        return parentView;
    }
} 
```

最后，这是我到目前为止的活动代码

```
public class InitialActivity extends SherlockFragmentActivity
{
    private SetupFragmentInitialScreen initialScreen;
    private SetupFragmentPreferenceOneScreen preferenceOneScreen;

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {    
        super.onCreate(savedInstanceState);

        initialScreen = new SetupFragmentInitialScreen();
        preferenceOneScreen = new SetupFragmentPreferenceOneScreen();

        FragmentManager fragmentManager = getSupportFragmentManager();
        FragmentTransaction fragmentTransaction = 
            fragmentManager.beginTransaction();

        fragmentTransaction.setCustomAnimations(android.R.anim.fade_in, 
                                                android.R.anim.fade_out);

        fragmentTransaction.replace(android.R.id.content, 
                                    initialScreen);

        fragmentTransaction.commit();
    }

    public void onInitialScreenNextPress()
    {
        FragmentManager fragmentManager = getSupportFragmentManager();
        FragmentTransaction fragmentTransaction = 
            fragmentManager.beginTransaction();

        fragmentTransaction.setCustomAnimations(android.R.anim.fade_in, 
                                                android.R.anim.fade_out);

        fragmentTransaction.replace(android.R.id.content, 
                                    preferenceOneScreen);

        fragmentTransaction.addToBackStack(null);
        fragmentTransaction.commit();
    }
} 
```

到目前为止，代码对我来说似乎是正确的，但正如我所说，当我尝试按下按钮时，界面没有反应。

编辑：我已将以下代码添加到我的活动中以检查触摸事件

```
@Override
public boolean onTouchEvent(MotionEvent event)
{
    super.onTouchEvent(event);

    Log.v("Touch Detected", "You are touching the screen.");

    return false;
} 
```

它在整个屏幕上记录事件，除了当我触摸按钮时，因此活动正在接收触摸事件，但 UI 本身不是。我还尝试加载另一个具有一对单选按钮的界面，但它们也没有响应。初始化片段时我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:37:57.583

不幸的是，您发布的代码似乎都没有指出问题所在。

按钮不需要 onClick 侦听器即可在按下时更改颜色，所以我不会担心那部分。更重要的是：

*   是否有可能任何透明视图位于按钮顶部并单击？DDMS 有一个“Dump View Hierarchy for UI Automator”按钮，可以帮助您检查这一点。
*   您的活动是否覆盖了 dispatchTouchEvent()、onInterceptTouchEvent() 或相关 API，其中之一是否会阻止触摸到达按钮？
*   如果您将自定义主题应用于按钮，您是否有单独的按下状态的视觉效果？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T14:44:42.700

我弄清楚那是什么。无论出于何种原因，程序不喜欢我在将第一个片段加载到活动中时尝试在动画中进行淡出淡入淡出。我从 onCreate() 方法中删除了该行，现在它工作正常。

# url - 协议相对 URL 是相对 URL 吗？

> ID：15581445
> 
> 赞同：10
> 
> 时间：2013-03-22T23:28:11.813
> 
> 标签：url, uri, relative-path, absolute-path, protocol-relative

所以考虑像这样的[协议相关 URL](http://paulirish.com/2010/the-protocol-relative-url/)；

```
//www.example.com/file.jpg 
```

从我记事起，我脑海中的想法就是相对协议的 URL 实际上是绝对 URL。它们的行为与绝对 URL 完全一样，但它们从不会像相对 URL 那样工作。我不希望这会让浏览器在

```
http://www.example.com///www.example.com/file.jpg 
```

URL 定义了主机和路径（就像绝对 URL 一样），并且该方案继承自所使用的任何页面，因此它构成了一个完整的明确 URL，即绝对 URL。

对？

现在，在对此进行进一步研究后，我得到了[这个答案](https://stackoverflow.com/a/904066/951402)，其中指出；

> 如果*URL*以方案和方案特定部分（后文）开头，则该 URL称为*绝对 URL*。其他任何东西都是*相对 URL*。`//``http:`

 *问题和答案都没有专门讨论协议相关的 URL，所以我注意到这可能只是措辞上的疏忽。

但是，我现在在我的开发中也遇到了一个问题，一个只接受绝对 URL 的系统不适用于协议相对 URL，我不知道这是设计使然还是由于错误。

[RFC3986 部分](https://www.rfc-editor.org/rfc/rfc3986#section-4.2)经常与协议相关的 URL 相关联，也大量使用了“相对”这个词。4.3 然后继续说绝对 URI 定义了一个方案。

所有这些反对我最初假设的证据都让我想到了这个问题；

*协议相关的 URL 是相对的还是绝对的？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:32:31.577

给定它相对的 URL，每个相对 URL 都是一个明确的 URL。因此，如果您的页面是，`http://mypage.com/some/folder/`那么您知道相对 URL`this/that`对应于`http://mypage.com/some/folder/this/that`，并且您知道相对 URL`//otherpage.com/`解析为`http://otherpage.com/`. 重要的是，如果不知道它相对的页面 URL，就无法解析它。

相对 URL 是任何*与*某物相关且无法自行解析的 URL。绝对 URL 不需要任何上下文来解析。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-20T07:35:02.787*

# ios - 应用内购买恢复按钮——即使不知道用户是否购买了内容也提供它？

> ID：15581446
> 
> 赞同：0
> 
> 时间：2013-03-22T23:28:17.847
> 
> 标签：ios, in-app-purchase, appstore-approval

我的应用更新被拒绝，因为我的应用内购买没有恢复按钮。我不明白的是——当我第一次向用户展示 iAP 时，我不知道他们是否已经购买了。我还应该向他们展示恢复按钮吗？

有关如何实现恢复按钮的问题，请参阅[Apple 拒绝，因为 In app purchase not implement restore](https://stackoverflow.com/questions/11200460/apple-reject-because-of-in-app-purchase-not-implement-restore)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:32:10.383

想象一下：用户拥有您的应用并购买了 IAP。然后他们会得到一台新设备并安装您的应用程序。他们想要在新设备上做的第一件事就是点击您的“恢复购买”按钮，这样他们就可以取回已付费的内容。

这当然假设您正在谈论非消耗品或订阅类型的购买。

基本上，任何销售非消耗品的应用程序都必须有一个“恢复购买”按钮。您应该始终显示该按钮。当然，用户可以点击按钮，可能没有什么可以恢复。这可以。只需显示一条消息，告诉用户没有可恢复的内容。

# javascript - 将 reCaptcha 实现为 javascript 验证表单

> ID：15581447
> 
> 赞同：0
> 
> 时间：2013-03-22T23:28:18.377
> 
> 标签：javascript, forms, validation, recaptcha

我有以下表单，我正在使用 javascript 来验证表单字段*onsubmit*。我将如何在此表单中实施**reCaptcha**？我是否必须更改*onsubmit*值才能执行带有 recaptcha 验证和字段验证的 php 文件？这是当前的表格：

```
 <form id="breeders" method="post" action="add-breeder?process" onsubmit="return validateForm()">
    Name:<br />
    <input type="text" id="name" name="name" /><br /><br />
    County:<br />
    <select id="address" name="address">
  <option value="Antrim">Antrim</option>
<option value="Armagh">Armagh</option>
</select><br/>
    <br />Please select a point on the map nearest to you.<br />
    <input type="hidden" id="lat" name="lat" /><br />
    <input type="hidden" id="lng" name="lng" />
    Phone No:<br />
    <input type="text" id="phone" name="phone" /><br /><br />
    Description:<br />
    <textarea cols="40" rows="5" name="breeds" id="breeds" /></textarea><br /><br />

    <input type="submit" value="Add Breeder" class="btn btn-primary btn-large" />
    </form>

   </div>

<script type="text/javascript">
       function validateForm()
    {
    var x=document.forms["breeders"]["name"].value;
    if (x==null || x=="")
      {
      alert("Name is required.");
      return false;
      }

      var x=document.forms["breeders"]["address"].value;
    if (x==null || x=="")
      {
      alert("Location is required.");
      return false;
      }

       var x=document.forms["breeders"]["phone"].value;
    if (x==null || x=="")
      {
      alert("Contact phone number is required.");
      return false;
      } 

        var x=document.forms["breeders"]["breeds"].value;
    if (x==null || x=="")
      {
      alert("A description of Breeds is required.");
      return false;
      }  

        var x=document.forms["breeders"]["lat"].value;
    if (x==null || x=="")
      {
      alert("You have to select a location on the map.");
      return false;
      }

         var x=document.forms["breeders"]["lng"].value;
    if (x==null || x=="")
      {
      alert("You have to select a location on the map.");
      return false;
      }
    }
    </script> 
```

任何帮助表示赞赏，干杯！

**编辑：**

我已经在表单上实现了 reCaptcha，但是当我单击提交时，该*操作*似乎没有执行。文件“submit.php”在同一个根目录下。这是带有 reCaptcha 的表单代码：

```
 <form id="breeders" method="post" action="submit.php" onsubmit="return validateForm()">
    Name:<br />
    <input type="text" id="name" name="name" /><br /><br />
    County:<br />
    <select id="address" name="address">
  <option value="Antrim">Antrim</option>
<option value="Armagh">Armagh</option>
</select><br/>
    <br />Please select a point on the map nearest to you.<br />
    <input type="hidden" id="lat" name="lat" /><br />
    <input type="hidden" id="lng" name="lng" />
    Phone No:<br />
    <input type="text" id="phone" name="phone" /><br /><br />
    Description:<br />
    <textarea cols="40" rows="5" name="breeds" id="breeds" /></textarea><br /><br /><br /><br /><br />

<script type="text/javascript"
   src="https://www.google.com/recaptcha/api/challenge?k=MY_PUBLIC_KEY">
 </script>
 <noscript>
   <iframe src="https://www.google.com/recaptcha/api/noscript?k=MY_PUBLIC_KEY"
       height="300" width="500" frameborder="0"></iframe><br>
 </noscript>

    <br/><input type="submit" value="Add Breeder" class="btn btn-primary btn-large" />
    </form>

   </div> 
```

这是“submit.php”文件的内容：

```
<?php if (!defined('APPLICATION')) exit(); ?>

<?php
 require_once('recaptchalib.php');
 $privatekey = "MY_PRIVATE_KEY";
 $resp = recaptcha_check_answer ($privatekey,
                                 $_SERVER["REMOTE_ADDR"],
                                 $_POST["recaptcha_challenge_field"],
                                 $_POST["recaptcha_response_field"]);
 if (!$resp->is_valid) {
   // What happens when the CAPTCHA was entered incorrectly
   die ("The reCAPTCHA wasn't entered correctly. Go back and try it again." .
        "(reCAPTCHA said: " . $resp->error . ")");
 } else {
   // Your code here to handle a successful verification
 }
 ?>

  <?php
//connection to my database details etc.
?>

  <?php
if(isset($_GET['process']))
{
$query = "Insert INTO `markers` (name, address, lat, lng, phone, breeds) values('$_POST[name]', '$_POST[address]','$_POST[lat]','$_POST[lng]', '$_POST[phone]', '$_POST[breeds]')";
//echo $query; exit;
$result = mysql_query($query) or die(mysql_error());
if(!$result)
{
$msg = "not Inserted";
}
else
{
$msg = "Inserted";
header("location:breeders?m=".$msg);
}
}

?> 
```

“recaptchalib.php 也在同一个文件夹中。您可以在此处查看表格：http: [//poultry.ie/add-breeder](http://poultry.ie/add-breeder)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T01:16:43.350

当您提交数据时，验证码必须在服务器端进行验证，以确保其安全。只要您知道它根本没有强制执行，并且没有什么可以阻止恶意用户向您的服务器端脚本发送他们想要的任何无意义的垃圾，您就可以将您的验证保留在 Javascript 中。在可能的情况下验证服务器端通常是一种很好的做法，但这取决于您正在为谁进行验证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T01:38:52.427

哎呀！阅读此[http://code.google.com/p/recaptcha/wiki/HowToSetUpRecaptcha](http://code.google.com/p/recaptcha/wiki/HowToSetUpRecaptcha)
主要在**第 2 部分：安装**然后您的选择！

**走向你的错误** 

改变 `action="submit.php?process=1"`形式
了吗 `defined('APPLICATION')`？

**更新：**

```
Insert INTO `markers`  to Insert INTO markers 
(in the Above Note: "`" ) 
```

尝试 Echoing 以了解执行停止的位置！

# c# - 将变量绑定到 XAML 字段

> ID：15581450
> 
> 赞同：1
> 
> 时间：2013-03-22T23:28:49.210
> 
> 标签：c#, wpf, xaml, binding, global-variables

我在 Visual Studio 2012 中使用 C# 和 XAML

MS 在 2012 年改变了 Visual Studio 的大部分内容，我无法在网络上找到有效的解决方案。我是 C#/XAML 的新手，所以我不熟悉数据绑定，如果这确实是正确的方法。

我需要在 MainPage.xaml 页面上显示 App.xaml.cs 文件中的变量。这些变量每 100-300 毫秒更改一次状态，因此每次数据更改时都要求刷新页面可能不是一个好主意。

以下是我项目中的代码片段：

App.xaml.cs 定义变量并在 dispatcherTimer 中修改它们：

```
namespace OpenGOTO
{
    public partial class App : Application
    {
        public static string DateStrZ = "";
        public static string FubarTest { get; set; }
    }
} 
```

在 MainPage.xaml（并不总是当前窗口）中，我有 TextBlock：

```
<TextBlock x:Name="UTC_Data" Text="2012-08-01 03:29:07Z" Padding="5" Style="{StaticResource TextBlockStyle1}" /> 
```

在 MainPage.xaml.cs 我有由更新字段的 dispatcherTimer 调用的例程：

```
public void SetFieldsTick()
{
    UTC_Data.Text = App.DateStrZ;
} 
```

如果我将其更改为

```
public static void SetFieldsTick() 
```

这样我就可以从 App.xaml.cs dispatcherTimer 调用它，我收到错误消息：

> 非静态字段、方法或属性“OpenGOTO.MainPage.UTC_Data”需要对象引用

我该怎么做：

1.  将数据绑定到字段（它会自动更新而不需要刷新整个窗口吗？）
2.  创建正确的引用，以便 App.xaml.cs 中的 dispatcherTimer 可以调用 MainPage.xaml.cs 中设置 XAML 页面中的字段的例程。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T02:21:31.820

要使用从数据中获取更新的绑定，您需要做一些事情：

*   要绑定的属性
*   更改通知的一些实现，通常使用`INotifyPropertyChanged`或`DependencyProperty`
*   声明属性的对象实例

您目前没有这些。首先创建一个使用属性实现的对象`INotifyPropertyChanged`来存储您的数据：

```
public class MyBindableObject : INotifyPropertyChanged
{
    private string _dateStr;
    public string DateStr
    {
        get { return _dateStr; }
        set
        {
            if (_dateStr == value)
                return;
            _dateStr = value;

            if (PropertyChanged != null)
                PropertyChanged(this, new PropertyChangedEventArgs("DateStr"));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

然后，您可以从您的`App`类中公开 this 的静态实例，并在新数据进入时对此实例进行更新：

```
 private static MyBindableObject _bindingContainer = new MyBindableObject();
    public static MyBindableObject BindingContainer
    {
        get { return _bindingContainer; }
    }

    public static void SetNewData()
    {
        // use this anywhere to update the value
        App.BindingContainer.DateStr = "<Your New Value>";
    } 
```

现在您已经拥有了 a 所需的一切`Binding`，您只需要将它公开到您的页面。您可以通过设置`DataContext`页面的 来做到这一点，这是默认绑定源：

```
 public MainPage()
    {
        this.InitializeComponent();
        DataContext = App.BindingContainer;
    } 
```

现在你可以绑定你的`TextBlock`：

```
 <TextBlock x:Name="UTC_Data"
            Text="{Binding Path=DateStr}"
            Padding="5" Style="{StaticResource TextBlockStyle1}"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T01:29:47.983

为什么不能只从 App.xaml.cs 调用 UTC_Data？

例如：

```
((MainPage) rootFrame.Content).UTC_Data.Text = DateStrZ; 
```

当然，除非您像这样更改它，否则 UTC_Data 将无法访问：

```
<TextBlock x:FieldModifier="public" x:Name="UTC_Data" Text="2012-08-01 03:29:07Z" Padding="5" Style="{StaticResource TextBlockStyle1}"/> 
```

# c# - 避免行长变为零

> ID：15581454
> 
> 赞同：-4
> 
> 时间：2013-03-22T23:29:39.747
> 
> 标签：c#, algorithm, graph-algorithm

我试图画一条线。

是否有人开发了图形环境并且知道当行长变为零时如何避免 NaN 值？

在 2D 环境中，用户可能会移动一条线或调整它的大小......我在这方面遇到问题，在运行时长度变得无效导致形状消失或行为异常，例如变成一个点。

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:36:59.460

看看[Bresenham 的线算法](https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)。例如，此伪代码不使用除法，因此它不会导致 NaN：（来自 Wikipedia）

```
 function line(x0, y0, x1, y1)
   dx := abs(x1-x0)
   dy := abs(y1-y0) 
   if x0 < x1 then sx := 1 else sx := -1
   if y0 < y1 then sy := 1 else sy := -1
   err := dx-dy

   loop
     setPixel(x0,y0)
     if x0 = x1 and y0 = y1 exit loop
     e2 := 2*err
     if e2 > -dy then 
       err := err - dy
       x0 := x0 + sx
     end if
     if e2 <  dx then 
       err := err + dx
       y0 := y0 + sy 
     end if
   end loop 
```

它还将在起点和终点在相同坐标处绘制一条线。根据您的定义，这是一条长度为 0 或 1 的线。

# android - 如何解决命令“python systrace.py --set-tags gfx,view,wm”中的错误？

> ID：15581455
> 
> 赞同：2
> 
> 时间：2013-03-22T23:29:43.710
> 
> 标签：android, python, exception-handling, command-line-arguments, android-sdk-tools

我想做这个：-

```
$> cd android-sdk/tools/systrace
$> python systrace.py --set-tags gfx,view,wm
$> adb shell stop
$> adb shell start
$> python systrace.py --disk --time=10 -o mynewtrace.html 
```

我运行这个命令： -

```
python systrace.py --set-tags gfx,view,wm 
```

错误来了：-

```
set-tags gfx,view,wm
  File "systrace.py", line 91
    except subprocess.CalledProcessError, e:
                                        ^
SyntaxError: invalid syntax 
```

我对python脚本不太了解，请帮助。

参考链接：http: [//developer.android.com/tools/help/systrace.html#tags](http://developer.android.com/tools/help/systrace.html#tags)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-22T23:33:18.190

该脚本是为 python 2 编写的。您应该安装 python 2.x，而不是 python 3.x。

Android 文档现在应该已经提到它了，真的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T23:32:20.613

根据[http://www.python.org/dev/peps/pep-3110/](http://www.python.org/dev/peps/pep-3110/)，目前正确的语法是**as**而不是逗号。尝试换行：

```
except subprocess.CalledProcessError, e: 
```

到：

```
except subprocess.CalledProcessError as e: 
```

# android - 谷歌语音识别库或 API

> ID：15581458
> 
> 赞同：3
> 
> 时间：2013-03-22T23:29:51.387
> 
> 标签：android, google-chrome, speech-recognition, chromium

谷歌最近在他们的语音识别软件方面取得了长足的进步，该软件用于几个开源产品，例如 Chromium [Web Speech](https://www.google.com/intl/en/chrome/demos/speech.html)和 Android Handsfree texting。我想将他们的语音识别用作我的服务器堆栈的一部分，但是我找不到太多关于它的信息。

文本识别软件是否以库或包的形式提供？或者，我可以从另一个程序调用 chromium 将一些音频文件转录为文本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-29T15:17:03.893

Web Speech API 仅设计用于 Chrome 或 Android 的上下文中。客户端有很多工作要做，所以没有公共服务器到服务器 API 只会获取音频文件并处理它。

如果您搜索 github，您会找到诸如[https://gist.github.com/alotaiba/1730160](https://gist.github.com/alotaiba/1730160)之类的工具，但我很确定这种访问方法 100% 不被支持、认可或确认继续工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-23T04:11:37.233

之前在[https://gist.github.com/alotaiba/1730160](https://gist.github.com/alotaiba/1730160)中所述的方法对我有用。我每天在我的家庭自动化程序中使用它。我使用 python 脚本来捕获音频并确定什么是有用的音频或只是噪音，然后它将小音频片段发送到谷歌并在一秒钟内返回所有文本！我已经成功地将它集成到我的程序中，如果你在周围搜索一下，你会发现更多的人也拥有它！

# java - 如何将 currentMinute 和 currentHour 组合成一个可以在 XML 文件中显示的时间值？

> ID：15581463
> 
> 赞同：0
> 
> 时间：2013-03-22T23:30:25.757
> 
> 标签：java, android, string, sqlite, timepicker

所以我想在布局 add_country.xml 中显示我通过 TimePicker 定义的 currentMinute 和 currentHour 变量 - 我认为我已经正确编码了所有内容，但我似乎无法显示我创建的新变量位于 view_country 中的两个组合时间值 @+id/normalTimeFormat：

```
<TableRow>       
  <TextView 
    style="@style/StyleLabel"
    android:text="Time Limit"/>                    
 <TextView 
    android:id="@+id/normalTimeFormat"
    style="@style/StyleText"/>         
 </TableRow>
 <TableRow> 
```

# view_country.xml

```
 <?xml version="1.0" encoding="utf-8"?>

<TableLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent" 
android:layout_height="wrap_content"
android:stretchColumns="1" 
android:layout_margin="5dp">
<TableRow>         
  <TextView 
    style="@style/StyleLabel"
    android:text="@string/time_lbl"/>
 <TextView 
    android:id="@+id/timeText" 
    style="@style/StyleText"/>         
 </TableRow>
<TableRow>         
  <TextView 
    style="@style/StyleLabel"
    android:text="@string/name_lbl"/>
 <TextView 
    android:id="@+id/nameText" 
    style="@style/StyleText"/>         
 </TableRow>

 <TableRow>         
 <TextView 
    style="@style/StyleLabel"
    android:text="@string/cap_lbl"/>         
 <TextView 
    android:id="@+id/capText"
    style="@style/StyleText"/>         
 </TableRow>

  <TableRow>       
  <TextView 
    style="@style/StyleLabel"
    android:text="Time Limit"/>                    
 <TextView 
    android:id="@+id/codeText"
    style="@style/StyleText"/>         
 </TableRow>
 <TableRow>       
  <TextView 
    style="@style/StyleLabel"
    android:text="Time Limit"/>                    
 <TextView 
    android:id="@+id/normalTimeFormat"
    style="@style/StyleText"/>         
 </TableRow>
 <TableRow>         
 <TextView 
    style="@style/StyleLabel"
    android:text="Linked Users"/>         
 <TextView 
android:id="@+id/codeText"
    style="@style/StyleText"/>         
 </TableRow>
 <TableRow>         
 <TextView 
    style="@style/StyleLabel"
    android:text="@string/code_lbl"/>         
 <TextView 
    android:id="@+id/timeEdit"
    style="@style/StyleText"/>  

</TableRow>

</TableLayout> 
```

# ViewCoreDevice.java

```
import android.app.Activity;
import android.app.AlertDialog;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuInflater;
import android.view.MenuItem;
import android.widget.TextView;
import android.widget.TimePicker;

public class ViewCoreDevice extends Activity {

       private long rowID;
       private TextView nameTv;
       private TextView capTv;
       private TextView codeTv; 
       private TextView timeTv; 
       private TextView minTv; 

       @Override
       public void onCreate(Bundle savedInstanceState) 
       {
          super.onCreate(savedInstanceState);
          setContentView(R.layout.view_country);

          setUpViews();
          Bundle extras = getIntent().getExtras();
          rowID = extras.getLong(CoreDeviceList.ROW_ID); 
       }

       private void setUpViews() {
           nameTv = (TextView) findViewById(R.id.nameText);
           capTv = (TextView) findViewById(R.id.capText);
           timeTv = (TextView) findViewById(R.id.timeEdit);
           minTv = (TextView) findViewById(R.id.timeEdit);
           codeTv = (TextView) findViewById(R.id.codeText);
       }

       @Override
       protected void onResume()
       {
          super.onResume();
          new LoadContacts().execute(rowID);
       } 

       private class LoadContacts extends AsyncTask<Long, Object, Cursor> 
       {
          DatabaseConnector dbConnector = new DatabaseConnector(ViewCoreDevice.this);

          @Override
          protected Cursor doInBackground(Long... params)
          {
             dbConnector.open();
             return dbConnector.getOneContact(params[0]);
          } 

          @Override
          protected void onPostExecute(Cursor result)
          {
             super.onPostExecute(result);

             result.moveToFirst();
             // get the column index for each data item
             int nameIndex = result.getColumnIndex("name");
             int capIndex = result.getColumnIndex("cap");
             int codeIndex = result.getColumnIndex("code");
             int timeIndex = result.getColumnIndex("time");

             nameTv.setText(result.getString(nameIndex));
             capTv.setText(result.getString(capIndex));
//           timeTv.setText(result.getInt(timeIndex)); // <--- HERE WAS AN ERROR
             timeTv.setText(result.getString(timeIndex)); // time was stored as Sting all the time
             minTv.setText(result.getString(timeIndex));
             codeTv.setText(result.getString(codeIndex));

             result.close();
             dbConnector.close();
          }
       } 

       @Override
       public boolean onCreateOptionsMenu(Menu menu) 
       {
          super.onCreateOptionsMenu(menu);
          MenuInflater inflater = getMenuInflater();
          inflater.inflate(R.menu.view_country_menu, menu);
          return true;
       }

       @Override
       public boolean onOptionsItemSelected(MenuItem item) 
       {
          switch (item.getItemId())
          {
             case R.id.editItem:
                Intent addEditContact =
                   new Intent(this, AddEditCountry.class);

                addEditContact.putExtra(CoreDeviceList.ROW_ID, rowID);
                addEditContact.putExtra("name", nameTv.getText());
                addEditContact.putExtra("cap", capTv.getText());
                addEditContact.putExtra("code", codeTv.getText());
                startActivity(addEditContact); 
                return true;

             case R.id.deleteItem:
                deleteContact();
                return true;

             default:
                return super.onOptionsItemSelected(item);
          } 
       }

       private void deleteContact()
       {

          AlertDialog.Builder alert = new AlertDialog.Builder(ViewCoreDevice.this);

          alert.setTitle(R.string.confirmTitle); 
          alert.setMessage(R.string.confirmMessage); 

          alert.setPositiveButton(R.string.delete_btn,
             new DialogInterface.OnClickListener()
             {
                public void onClick(DialogInterface dialog, int button)
                {
                   final DatabaseConnector dbConnector = 
                      new DatabaseConnector(ViewCoreDevice.this);

                   AsyncTask<Long, Object, Object> deleteTask =
                      new AsyncTask<Long, Object, Object>()
                      {
                         @Override
                         protected Object doInBackground(Long... params)
                         {
                            dbConnector.deleteContact(params[0]); 
                            return null;
                         } 

                         @Override
                         protected void onPostExecute(Object result)
                         {
                            finish(); 
                         }
                      };

                   deleteTask.execute(new Long[] { rowID });               
                }
             }
          );

          alert.setNegativeButton(R.string.cancel_btn, null).show();
       }
    } 
```

# AddEditCountry.java

```
import android.app.Activity;
import android.app.AlertDialog;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.ViewGroup;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.TimePicker;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.database.sqlite.SQLiteOpenHelper;
import android.content.Context;

public class AddEditCountry extends Activity {

     private long rowID; 
     private EditText nameEt;
     private EditText capEt;
     private EditText codeEt;
     private TimePicker timeEt;
     private TimePicker minEt;
     private String cHour;
     private String cMinute;
     private String normalTimeFormat;

       @Override
       public void onCreate(Bundle savedInstanceState) 
       {
          super.onCreate(savedInstanceState); 
          setContentView(R.layout.add_country);

          nameEt = (EditText) findViewById(R.id.nameEdit);
          capEt = (EditText) findViewById(R.id.capEdit);
          codeEt = (EditText) findViewById(R.id.codeEdit);
          timeEt = (TimePicker) findViewById(R.id.timeEdit);
          minEt = (TimePicker) findViewById(R.id.timeEdit);

          Bundle extras = getIntent().getExtras(); 

          if (extras != null)
          {
             rowID = extras.getLong("row_id");
             nameEt.setText(extras.getString("name"));  
             capEt.setText(extras.getString("cap"));  
             codeEt.setText(extras.getString("code"));  
             timeEt.setCurrentHour(extras.getInt("time"));
             minEt.setCurrentMinute(extras.getInt("min"));
          }

          Button saveButton =(Button) findViewById(R.id.saveBtn);
          saveButton.setOnClickListener(new OnClickListener() {

              public void onClick(View v) 
              {
                 if (nameEt.getText().length() != 0)
                 {
                    AsyncTask<Object, Object, Object> saveContactTask = 
                       new AsyncTask<Object, Object, Object>() 
                       {
                          @Override
                          protected Object doInBackground(Object... params) 
                          {
                             saveContact();
                             return null;
                          }

                          @Override
                          protected void onPostExecute(Object result) 
                          {
                             finish();
                          }
                       }; 

                    saveContactTask.execute((Object[]) null); 
                 }

                 else
                 {
                    AlertDialog.Builder alert = new AlertDialog.Builder(AddEditCountry.this);
                    alert.setTitle(R.string.errorTitle); 
                    alert.setMessage(R.string.errorMessage);
                    alert.setPositiveButton(R.string.errorButton, null); 
                    alert.show();
                 }
              } 
         });
       }

           private void saveContact() 
           {
              DatabaseConnector dbConnector = new DatabaseConnector(this);

              if (getIntent().getExtras() == null)
              {
                  dbConnector.insertContact(nameEt.getText().toString(),
                          capEt.getText().toString(),
                          timeEt.getCurrentHour().toString(),
                          minEt.getCurrentMinute().toString(),
                          codeEt.getText().toString());
              }
              else
              {
                  dbConnector.updateContact(rowID, nameEt.getText().toString(),capEt.getText().toString(),timeEt.getCurrentHour().toString()+":"+minEt.getCurrentMinute().toString(), codeEt.getText().toString());
                    }
           }
} 
```

# add_country.xml

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
   android:layout_width="fill_parent" 
   android:layout_height="wrap_content" android:layout_weight="1">

   <LinearLayout android:id="@+id/linearLayout"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:orientation="vertical" 
      android:padding="5dp">

      <EditText android:id="@+id/nameEdit"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content" 
         android:imeOptions="actionNext" 
         android:hint="@string/name_hint"
         android:inputType="textPersonName|textCapWords"/>

      <EditText android:id="@+id/capEdit"
         android:layout_width="fill_parent" 
         android:layout_height="wrap_content" 
         android:imeOptions="actionNext" 
         android:hint="@string/cap_hint"
         android:inputType="textPersonName|textCapWords"/>

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Data Limit"
        android:textColor="#ffffff"
        android:textAppearance="?android:textAppearanceMedium" />

    <SeekBar
        android:id="@+id/seekBar1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:gravity="left"
            android:textColor="#ffffff"
            android:text="10MB" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:gravity="right"
            android:textColor="#ffffff"
            android:text="Unlimited Data" />
    </LinearLayout>

    <TextView
        android:id="@+id/textView3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Bandwidth Limit"
        android:textColor="#ffffff"
        android:textAppearance="?android:textAppearanceMedium" />

    <SeekBar
        android:id="@+id/seekBar1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:gravity="left"
            android:textColor="#ffffff"
            android:text="10kbs" />

        <TextView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:textColor="#ffffff"
            android:gravity="right"
            android:text="Unlimited Bandwidth" />
    </LinearLayout>

    <TextView
        android:id="@+id/TextView02"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textAppearance="?android:textAppearanceSmall" />

    <TextView
        android:id="@+id/TextView02"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="WiFi Time Limit"
        android:textColor="#ffffff"
        android:textAppearance="?android:textAppearanceMedium" />

    <TimePicker
        android:id="@+id/timeEdit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:gravity="center"
        android:layout_weight="1.0" />

    <EditText
        android:id="@+id/codeEdit"
        android:inputType="textUri"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:ems="10"
        android:lines="1"
        android:hint="@string/code_hint"
        android:imeOptions="actionNext" />

      <Button android:id="@+id/saveBtn" 
         android:layout_width="wrap_content"
         android:layout_height="wrap_content"
         android:layout_marginTop="15dp"
         android:layout_gravity="center_horizontal"
         android:text="@string/save_btn"/>
   </LinearLayout>
</ScrollView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:41:10.603

您应该使用返回当前时间的东西，例如`new Date()`或`Calendar.getInstance()`与`SimpleDateFormat.format(Date)`. 像这样的东西

```
SimpleDateFormat format = new SimpleDateFormat("HH:m");
Date date = new Date();
format.format(date); 
```

您可以选择适合您的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:07:09.457

我会这样做。

**首先，我会在您的数据库中更改您的字段类型“时间”。字符串 -> 长**

*   改变你的 SQL
*   更改您的 CRUD 方法

在插入时刻，您将使用 System.currentTimeMillis 将其存储在数据库中。

因此，当您获得数据库的信息时，您会得到很长的时间。此时，您只需转换为更适合您的格式。

此时您可以按照@Moesio 所说的那样做：

```
 SimpleDateFormat format = new SimpleDateFormat("HH:m");
       Date date = new Date();
       timeTv.setText(format.format(date).toString()); 
```

# actionscript-3 - 在 AS3 中定义函数哪种方式更好？

> ID：15581467
> 
> 赞同：0
> 
> 时间：2013-03-22T23:30:57.193
> 
> 标签：actionscript-3, function, variables

从性能的角度来看，哪个函数定义更好/更快？制作一个对象并为其添加功能，还是一个一个地制作功能？

```
var myCollection:Object = {
    first: function(variable:int):void {

    },
    second: function(variable:int):void {

    }
}

myCollection.first(1); 
```

或者

```
private function first(variable:int):void {

}

private function second(variable:int):void {

}

first(1); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:44:29.390

后者。性能影响可以忽略不计，除非是大规模的，但第二个会稍微快一些。

基本上它归结为范围。要从一个对象中获取一个函数，你必须在类的范围内找到对该对象的内存引用，然后在该对象的范围内找到对该函数的内存引用。第二种，你只需要在类的范围内找到Function对象（所有函数都是对象）内存引用。

第二种方法在确定正确的功能时，从本质上来说是省去了中间人。现在，每一个都将在不到一毫秒的时间内找到。就你而言，它是即时的。但是如果你连续做 10 万次呢？是的，通过在类中声明，您可能会看到一些性能提升。

作为附加说明，您还将另一个对象与第一个对象一起添加到内存中。添加足够多的这些（再次，需要*大规模*），你会看到存储在内存中的多余对象会减慢

不过，您还应该关注可用性和可读性。在对象中声明意味着一旦类被实例化，函数就不可用，因此您必须小心不要在实例化对象之前调用函数。此外，您将失去代码提示，并且这不是编写代码的常用方式（这意味着另一个开发人员，甚至一年后的您自己，将不得不在没有任何提示或标准帮助的情况下弄清楚它是如何工作的他们在进行任何修改之前已经学会了）

# php - 如何在 cakephp 2.3 中烘焙没有脚手架的插件控制器

> ID：15581470
> 
> 赞同：1
> 
> 时间：2013-03-22T23:31:29.803
> 
> 标签：php, cakephp, plugins, code-generation, cakephp-2.3

当我烘焙我的插件控制器时，它总是使用脚手架生成。

```
class MyController extends PluginAppController {

/**
 * Scaffold
 *
 * @var mixed
 */
        public $scaffold;

} 
```

任何人都可以帮助我在没有脚手架的情况下烘焙插件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T18:57:10.477

从命令行中的主应用程序目录输入

1.  `cake bake controller -p <pluginname>`
2.  选择您正在烘焙的控制器
3.  用默认（否）回答脚手架问题

    您想使用动态脚手架吗？(y/n)
    [n] >

# javascript - 需要设置本地地图切片缓存 - 如何获取完整的切片集？

> ID：15581473
> 
> 赞同：1
> 
> 时间：2013-03-22T23:31:52.593
> 
> 标签：javascript, openlayers, tilecache

我正在使用[OpenLayers](http://openlayers.org/) Javascript 库为我的网络应用程序提供地图视图。这可以部署在无法访问外部 Internet 的环境中。所以理想情况下，我需要一整套地图图块，预先填充在本地 Web 服务器上。我假设这将是*很多*数据。

到目前为止，我一直在使用[TileCache](http://tilecache.org/)在磁盘上本地获取和存储地图图块。这没关系，但显然只为我在地图上探索的区域获取图块。此外，如果目标区域的相关切片尚未在本地磁盘缓存中，则此解决方案不适用于上述部署环境。

我真的不知道一个完整的图块集会有多少数据，所以这个想法完全不切实际吗？我在哪里可以获得瓷砖套装？

# jquery - 有没有办法引用嵌套在 div 中的所有父母/孩子？

> ID：15581474
> 
> 赞同：1
> 
> 时间：2013-03-22T23:31:59.437
> 
> 标签：jquery, parent-child

此功能按类显示/隐藏子元素，但目前需要单独指定每个父元素。我怎样才能修改它，以便它触发相关的子、孙等，而不必指定`id`每个我想要包括的？

我在这里发布了一个带有工作示例的小提琴：http: [//jsfiddle.net/chayacooper/YvMwL/](http://jsfiddle.net/chayacooper/YvMwL/)

```
$(document).ready(function() {
$('#filterOptions li a').click(function() {
    var ourClass = $(this).attr('class');
    $('#filterOptions li').removeClass('active');
    $(this).parent().addClass('active');        

    if(ourClass == 'all') {
        $('#content').children('div.item').show();
        $('#list').children('li.item').show();  
    }
    else {          
        $('#content').children('div:not(.' + ourClass + ')').hide();
        $('#list').children(':not(li.' + ourClass + ')').hide();
        $('#content').children('div.' + ourClass).show();
        $('#list').children('li.' + ourClass).show();
    }
    return false;
});
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:15:16.620

所以，这里有两个问题。首先，您要选择的项目具有不同的标签名称，其次它们处于不同的级别（`div`s是孩子，`li`s是孙子）。幸运的是，您已经有了一种方法来引用所有这些项目：`.item`类。

因此，如果我们将该`find`方法与这种新的选择器方法一起使用，那么我们可以修改您的 jsFiddle：

```
 if (ourClass == 'all')
    {
        // show all our items
        $('#content').find('.item').show();
    }
    else
    {
        // hide all elements that don't share ourClass
        $('#content').find('.item:not(.' + ourClass + ')').hide();

        // show all elements that do share ourClass
        $('#content').find('.item.' + ourClass).show();
    } 
```

我的叉子在这里：http: [//jsfiddle.net/chayacooper/WZpMh/4/](http://jsfiddle.net/chayacooper/WZpMh/4/)

# php - 将关联的 PHP 数组存储到数据库中而不重复

> ID：15581479
> 
> 赞同：0
> 
> 时间：2013-03-22T23:32:30.817
> 
> 标签：php, mysql, database, associative-array

我正在尝试将关联 PHP 数组（一个表）存储到数据库中。这是一个包含许多字段（大约 30 个字段）的大数组，我只想将此数组的 6 个字段存储到一个具有 6 个字段的表中好。该数组的每一行都包含特定文章的信息。我想确保每篇文章只存储一次（不重复），所以在存储数据之前，我需要检查数据库是否有重复查询。这是我的代码无法正常工作。如果有人帮助我，我将不胜感激。

```
<?php $results = $PubMedAPI->query($term, false); ?>
<?php if (!empty($results)): ?>
<?php
    $con=mysqli_connect("localhost","root","","db");
    // Check connection
    if (mysqli_connect_errno())
    {
      echo "Failed to connect to MySQL: " . mysqli_connect_error();
    }
    foreach ($results as $result):

        $pmid = $result['pmid'];
        $title = $result['title'];
        $authors = $result['authors'];
        $journalabbrev = $result['journalabbrev'];
        $year = $result['year'];
        $abstract = $result['abstract'];
        $fetched_articles = mysqli_query($con,"SELECT pmid FROM articles");

        while( ($row = mysqli_fetch_array($fetched_articles))) {
            if ($row['pmid'] == $pmid) {
                echo "This record has already been stored into the database!";
            } else {
                mysqli_query($con,"INSERT INTO articles (pmid, title, authors, journalabbrev, year, abstract)
                VALUES ('$pmid', '$title', '$authors', '$journalabbrev', '$year', '$abstract')");
                echo "This record has been stored into the database!";
            }
        }
    endforeach;
    mysqli_close($con);
?>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:16:05.223

这是一些未经测试的代码，可以更快地完成：

```
$select = "SELECT pmid FROM articles WHERE pmid IN (";
foreach($result in $results) {
    $select .= $result['pmid'] . ',';
}
$select = trim($select,',') . ")";

$existing_pmid = array();
while( ($row = mysqli_fetch_array($select))) {
    $existing_pmid[$row['pmid']] = 1;
}

foreach ($results as $result) {
    if(isset($existing_pmid[$result['pmid']])) {
        echo "This record has already been stored into the database!";
        continue;
    }

    $pmid = $result['pmid'];
    $title = $result['title'];
    $authors = $result['authors'];
    $journalabbrev = $result['journalabbrev'];
    $year = $result['year'];
    $abstract = $result['abstract'];

    mysqli_query($con,"INSERT INTO articles (pmid, title, authors, journalabbrev, year, abstract) VALUES ('$pmid', '$title', '$authors', '$journalabbrev', '$year', '$abstract')");
    echo "This record has been stored into the database!";
} 
```

# html - 为什么这个div会下降？

> ID：15581482
> 
> 赞同：0
> 
> 时间：2013-03-22T23:32:50.130
> 
> 标签：html, css-float, width

有人可以解释一下为什么当我指定一个固定宽度时，这个片段中的四个 div 会下降吗？它甚至以 1 px 的宽度下降。如果我保持自动宽度，它会正确显示在同一行中。

```
<style>
  .au {
    float:left;
    width:200px;
  }
  .u {
    width:auto;  //change this to a fixed size like 1px
  }
</style>
<div class="au">uno</div>
<div class="au">dos</div>
<div class="au">tres</div>
<div class="u">cuatro</div>
<div>cinco</div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T12:33:12.153

这里很简单，你给 .u 类提供 width:auto 所以它占用 100% 这就是为什么现在 .u 类的宽度超过 600px（即三个 div “uno” “dos” “tres” 的总和和第四个 div 的字符宽度“夸特罗”）。因此，它在第三个 div 旁边显示。

在将 widht .u 类 = 1px 或 1px 固定为 638px（宽度包括“cuaro”的字符）时，这就是为什么这里第四个 div 显示在前三个 div 之下

我不能发布图片，否则我可以用它来解释。

对于在 html 和 css 代码下方的输出使用并在浏览器中查看，我希望您可以轻松理解。

```
FIRST PHASE
.au {
float:left;
width:200px;
}
.u {
    width:100px;
}

<div class="au">uno</div>
<div class="au">dos</div>
<div class="au" style="border:red solid 1px;">tres</div>
<div class="u" style="border:green solid 1px;">cuatro</div>
<div>cinco</div>

SECOND PHASE
.au {
float:left;
width:200px;
}
.u {
    width:639px;
}

<div class="au">uno</div>
<div class="au">dos</div>
<div class="au" style="border:red solid 1px;">tres</div>
<div class="u" style="border:green solid 1px;">cuatro</div>
<div>cinco</div> 
```

# xslt - XSLT 循环遍历子项并在每行放入表 2 个子项？

> ID：15581488
> 
> 赞同：0
> 
> 时间：2013-03-22T23:33:22.670
> 
> 标签：xslt, umbraco

我是使用 Umbraco 和 XSLT 的新手。我离学校不远，我们在那里学习了 vb.net 和 asp.net。现在我正在为我们当地的教堂做一个免费的网站。他们想要一个员工页面，所以这是我的第一个解决方案......

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xsl:stylesheet [ <!ENTITY nbsp "&#x00A0;"> ]>
<xsl:stylesheet 
version="1.0" 
xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
xmlns:msxml="urn:schemas-microsoft-com:xslt" 
xmlns:umbraco.library="urn:umbraco.library"xmlns:Exslt.ExsltCommon="urn:Exslt.ExsltCommon" 

xmlns:Exslt.ExsltDatesAndTimes="urn:Exslt.ExsltDatesAndTimes" xmlns:Exslt.ExsltMath="urn:Exslt.ExsltMath" xmlns:Exslt.ExsltRegularExpressions="urn:Exslt.ExsltRegularExpressions" xmlns:Exslt.ExsltStrings="urn:Exslt.ExsltStrings" xmlns:Exslt.ExsltSets="urn:Exslt.ExsltSets" xmlns:umbraco.contour="urn:umbraco.contour" xmlns:tagsLib="urn:tagsLib" xmlns:BlogLibrary="urn:BlogLibrary" 
  exclude-result-prefixes="msxml umbraco.library Exslt.ExsltCommon Exslt.ExsltDatesAndTimes Exslt.ExsltMath Exslt.ExsltRegularExpressions Exslt.ExsltStrings Exslt.ExsltSets umbraco.contour tagsLib BlogLibrary ">

<xsl:output method="xml" omit-xml-declaration="yes"/>

<xsl:param name="currentPage"/>

<xsl:template match="/">

<div class="staffList">
<xsl:for-each select="$currentPage/* [@isDoc and string(umbracoNaviHide) != '1']">

<img src="{staffPhoto}" width="210" height="280"/>  
<p class="introduction"><xsl:value-of select="umbraco.library:ReplaceLineBreaks(staffName)" disable-output-escaping="yes"/></p>     
<p class="introduction"><xsl:value-of select="umbraco.library:ReplaceLineBreaks(position)" disable-output-escaping="yes"/></p>

</xsl:for-each>
</div>

</xsl:template>

</xsl:stylesheet> 
```

到目前为止，这就是我设法完成的工作，但这只是在 div 中一次列出一个。我希望减少该页面上的滚动量，并有空间在表格中每行列出两个。今天在工作中环顾四周后，我仍然未能开发出一个循环，将每个孩子的三条信息放在一个表格单元格中。

我希望它是这样的，但这在 mod 5 上是错误的

```
<div class="staffList">
<table>
<xsl:for-each select="$currentPage/*[position()mod5=1]">
<xsl:variable name = "current-pos" select="(position()-1) * 5+1"/>
<tr>
<xsl:for-each select="$currentPage/*[position()&gt;=$current-pos and position() &lt; $current-pos+5]" >
<td>
<xsl:value-of select="staffName"/>
</td>
</xsl:for-each>
</tr>           
</xsl:for-each>         
</table>
</div> 
```

蚂蚁方向会有所帮助。就像我说的那样，这个 XSLT 对我来说是全新的，同时我试图将我的头包裹在 Umbraco 中对我来说是新的所有其他东西上。在这里通过跟踪和错误学习。

提前感谢您的帮助。担

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T01:20:11.457

看起来您遇到了该错误，因为您需要在“mod”一词之前和之后放置空格。另一方面，您使用的方法有点程序化，并且有一种更优雅的方法，如下所示：

```
<div class="staffList">
  <table>
    <xsl:apply-templates select="$currentPage/*[position() mod 5 = 1]" mode="row" />
  </table>
</div>

<!-- Separate templates -->
<xsl:template match="*" mode="row">
  <tr>
    <xsl:apply-templates select=". | following-sibling::*[position() &lt; 5"
                         mode="cell" />
  </tr>           
</xsl:template> 

<xsl:template match="*" mode="cell">
  <td>
    <xsl:value-of select="staffName"/>
  </td>
</xsl:template> 
```

这确实假设`$currentPage`只是 XML 源文档中的一些单个元素。如果不是这种情况，您仍然可以这样做：

```
<div class="staffList">
  <table>
    <xsl:for-each select="$currentPage/*[position() mod 5=1]">
      <xsl:variable name = "current-pos" select="(position()-1) * 5+1"/>
      <tr>
        <xsl:apply-templates 
           select="($currentPage/*)[position() &gt;= $currentPos and
                                    position() &lt; $current-pos + 5]"
           mode="cell"/>             
      </tr>
    </xsl:for-each>
  </table>
</div>

<xsl:template match="*" mode="cell">
  <td>
    <xsl:value-of select="staffName"/>
  </td>
</xsl:template> 
```

# sql - 在 1 个 SQL 语句中组合更新查询

> ID：15581501
> 
> 赞同：0
> 
> 时间：2013-03-22T23:34:48.920
> 
> 标签：sql, union, updates

我正在尝试将两个更新查询组合成一个 sql 语句。我以为我可以使用联合查询来组合查询，但我做不到。有什么建议吗？我要组合的查询如下：

```
UPDATE PromotionDatabase
  SET PromotionDatabase.PromotionWeekEndingSunday = [PromotionDatabase]![Start Date]+-(Weekday([PromotionDatabase]![Start Date])-1)+7 

UPDATE PromotionDatabase
  SET PromotionDatabase.PromotionEndingWeekEndingSunday = [PromotionDatabase]![End Date]+-(Weekday([PromotionDatabase]![End Date])-1)+7; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:37:56.177

您是否只是想在同一个 UPDATE 语句中更新 2 个字段：

```
UPDATE PromotionDatabase
SET PromotionWeekEndingSunday = [Start Date]+-(Weekday([Start Date])-1)+7,
   PromotionEndingWeekEndingSunday = [End Date]+-(Weekday([End Date])-1)+7; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T01:20:04.130

更新的语法如下。见[w3schools](http://www.w3schools.com/sql/sql_update.asp)

```
UPDATE table_name
SET column1=value, column2=value2,...
WHERE some_column=some_value 
```

# xcode4 - UILabel 双重文本

> ID：15581502
> 
> 赞同：0
> 
> 时间：2013-03-22T23:35:07.873
> 
> 标签：xcode4, uilabel

我正在以这种方式创建一个 UILabel 并且它第一次工作得很好..

```
 CGRect labelFrame = CGRectMake(98, 286, 600, 180);
    UILabel *lblQuestionTitle = [[UILabel alloc] initWithFrame:labelFrame];
    [lblQuestionTitle setBackgroundColor:[UIColor clearColor]];
    [lblQuestionTitle setFont: [UIFont fontWithName:@"Helvetica" size:17.0]];
    [lblQuestionTitle setText:labelText];
    [lblQuestionTitle setNumberOfLines:0];
    [lblQuestionTitle sizeToFit];
    [self.view addSubview:lblQuestionTitle]; 
```

问题是当我稍后使用此代码时，新文本出现在旧文本之上。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:01:55.450

无需重用代码，只需覆盖标签文本。

```
[lblQuestionTitle setText:@"New label text!"]; 
```

如果您真的想要一个全新的按钮，只需在添加新标签之前将 lblQuestionTitle 设置为隐藏

```
[lblQuestionTitle hidden:YES]; 
```

# mysql - INSERT 或 UPDATE 是否存在唯一值

> ID：15581503
> 
> 赞同：0
> 
> 时间：2013-03-22T23:35:11.883
> 
> 标签：mysql

这是我目前的声明

```
INSERT INTO TABLE (LAST_NAME, FIRST_NAME, DOB, ACCESSION, EXAM_DESC, LOCATION, EXAM_DATE, REFERRING)
VALUES (${patientIdentification_patientName_familyName},${patientIdentification_patientName_givenName},${patientIdentification_dateOrTimeOfBirth_value},${commonOrder_placerOrderNumber_entityIdentifier},${observationRequest_relevantClinicalInfo_value},${patientVisit_assignedPatientLocation_facility},${observationRequest_observationDateOrTime_value},${observationRequest_orderingProvider_familyName}) 
```

ACCESSION 在数据库中是唯一的。我需要做的是，如果 ACCESSION 值已经存在，那么我想替换该行。如果它不存在（ACCESSION 的值是唯一的）我希望它插入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:48:04.680

我从您的变量中假设您正在使用 php 来执行此操作。如果我错了，请纠正我。这是您检查它是否存在的方式：

```
$result = mysql_query("SELECT * FROM DBTable WHERE ACCESSION = '$ACCESSION'");
$row = mysql_fetch_array($result);
if($row > 0)
{
    //code for when the record exists (update)
}
else
{
    //code for when the record does not exist (insert)
} 
```

按照此操作并针对您的 dbtable 和值等进行修改。这应该可以满足您的要求

# c#-4.0 - 通用接口的通用抽象基类

> ID：15581505
> 
> 赞同：3
> 
> 时间：2013-03-22T23:35:30.150
> 
> 标签：c#-4.0, generics, inheritance, interface, abstract-class

我试图了解哪种层次结构最适合如下所述的继承。到目前为止，我有以下内容：

```
public interface IManager<T> where T : ISomeObject
{
    bool Add(T o);
    bool Remove(T o);
    bool Update(T o);
} 
```

但后来我希望每个派生类都有一个参数化的构造函数。所以我去了：

```
public abstract class Manager<T> : IManager<T> where T : ISomeObject
{
    protected readonly INeededObject obj;

    protected Manager(INeededObject o)
    {
         obj = o;
    }
} 
```

关于我应该如何解决这个设计问题的任何想法？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T23:37:40.370

您快到了。您也可以在基类中使用泛型类型参数。

```
public abstract class Manager<T> : IManager<T> where T : ISomeObject
{
    protected readonly T obj;

    protected Manager(T o)
    {
         obj = o;
    }
} 
```

您也可以使用参数化类型，例如

```
protected Manager(IList<T> o)
{
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T09:00:55.210

可能有点深夜的“智慧热潮”（这可能又是错误的）。但是将我的界面修改为非通用界面，如下所示：

```
public interface IManager
{
    bool Add(ISomeObject o);
    bool Remove(ISomeObject o);
    bool Update(ISomeObject o);
} 
```

我的抽象类如下所示：

```
public abstract class Manager<T> : IManager<T> where T : ISomeObject
{
    protected readonly INeededObject obj;

    protected Manager(INeededObject o)
    {
         obj = o;
    }

    public abstract bool Add(T o);
    bool IManager.Add(ISomeObject obj)
    {
        return this.Add( (T) obj );
    }
} 
```

# ios - 实例变量会限制性能吗？一个课程应该有两个目的吗？

> ID：15581508
> 
> 赞同：0
> 
> 时间：2013-03-22T23:35:40.440
> 
> 标签：ios, objective-c, performance, cocos2d-iphone

我有一个有多个实例变量的类。我想通过课堂实现两个目的。我可能只将一些变量用于一个目的，有时同时使用两者。

这是一个更具体的例子。我想创建一个类，每次用户点击屏幕时，都会出现一个带有动画的狗精灵和猫精灵。如果再次点击，它们将继续执行不同的动画。但是，有时我只希望狗精灵出现和更新。在其他一些罕见的情况下，我希望在狗精灵出现后点击几下后猫精灵出现。

问题是：实例变量是否分配了太多内存？我非常关心性能，因为我正计划制作一款内存密集型游戏。由于很难预测我何时实际使用所有实例变量，我应该将它们分为两类吗？让我们划分可能的场景以获得更好的想法。

1.  **只有 Dog Sprite 被使用并且 cat sprite 永远不会出现**：如果 cat 的实例变量留在一个类中，则保持不变。

2.  **狗精灵首先出现，然后猫精灵随后出现**：两个精灵最终都会出现。可以分为两类，但有些方法是重复的，因为触摸推进逻辑和动画等方法是相似的。但是如果我们把它放在一个类中，可能会出现场景 1，这可能会在没有大量重复代码的情况下解决。

可能会发生其他事情，但问题已经在上面讨论过。从我的角度来看，这些是利弊：

1.  一类方法

    *   临
    *   避免一些重复的逻辑
    *   无需导入多个导致某些类似实例变量的标头

    *   骗局

    *   可能保留一半的实例变量未使用（包括 NSString、CCSprite、大量整数和浮点数、CCAnimation、CCLabelBMFont）
2.  两级方法

    *   临
    *   更少的实例变量
    *   以后可能继承类而不继承一些不必要的变量

    *   骗局

    *   部分逻辑复现

很难决定我应该使用哪个选项。任何建议都会很棒！先感谢您！

```
if (didHelp) 
   for (int x = 0; x < 100; x++)
      NSLog(@"Thanks!"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T00:28:58.140

> 我非常关心性能

您和其他数以千计的缺乏经验的开发人员。说真的，您最有可能遇到两件事：

1.  您的想法不成比例，再多的性能优化都无法使其发挥作用->改变您的想法
2.  性能一点也不重要，你只是在浪费时间

**性能是游戏开发者在项目开始时需要考虑**的最不重要的事情之一。****

 **为什么？

案例#2 是不言而喻的。

在您开始之前以合理的准确性评估案例 #1 需要经验。即使那样也很困难。如果功能 X 被证明在技术上太具有挑战性（或不可能），只需制定一个备用计划。如果您无法评估性能，并且您的想法不适用于任何备份计划，那么您还有两种选择：

1.  实施不同的想法
2.  创建一个快速原型以找出峰值性能参数：内存使用率、CPU 和 GPU 使用率、加载时间以及任何其他适合性测试，以便在几天（如果不是几小时）内确定您的想法是否可行。

> 实例变量是否分配了太多内存？

不，分配的内存与性能关系不大。

您可以使用[class_getInstanceSize](https://stackoverflow.com/questions/761969/checking-the-size-of-an-object-in-objective-c)来查看类实例使用了多少内存。一个类实例很少会使用超过 500 字节。但是，这仅计算为实例变量分配的内存 - 而不是实例变量可能指向的内存。在 cocos2d 应用程序中，可以公平地说 95% 的内存使用将来自纹理。

> 很难决定我应该使用哪个选项

始终努力：

*   编写可读代码
*   编写可维护的代码
*   少写代码
*   编写更安全的代码
*   只写一次代码（避免重复）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:07:34.373

EmbodiedD，你这里肯定是顾虑太多了。在大多数应用程序中，堆会变得非常大。一个简单的类将是无关紧要的。当您拥有 1000 个数据密集型类的实例时，您可能不得不开始考虑分析。如果您担心组织，那完全是另一回事。如果您使用 var1 和 var2 加载 classA 或使用 var1 加载 classA 并使用 var2 加载 class2，则更多的是如何教您进行抽象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T01:11:18.203

这是一个有点开放式的问题，有很多方法可以解决这个问题。因此，这是我的方法，可能适合也可能不适合所有场景。

在某些情况下可以替换实例变量 - 但是如果必要的话，这不会影响您的决定。需要时应使用实例变量。不要为了替换单个实例变量而执行无休止的计算。当在某个范围之外不需要时，请尝试将您的实例变量限制为变量。**感谢在这里发布的信息丰富的用户，实例变量在如此微观的范围内留下了未使用的影响性能，您不必担心。**

从我的角度来看，一个类应该只关注一个焦点——功能，并且应该将任何其他信息传递给需要它的其他类。信息应该保持封装——一个功能是在其他项目中保持可重用性。

应该关注功能的关系。IT-IS 是说一个对象应该继承另一个对象的关系。实际上，它就像 Sienna-IS 一辆汽车。船——是一种交通工具。因此，这些对象应该从它的超类继承任何信息。相反，IT-HAS 说这些类包含一些不能被继承的东西，通常是质量或组件。赭色 - 是汽车，但轮胎 - 不是 - 赭色。相反，赭色有轮胎。

另一个重要的关系是委托。花哨的定义说它代表另一个人执行一项任务，就像美国的代表如何代表他们的州人民一样。基本上，它向其他班级传递了一定的信息，谁应该在良好的实践中，不影响其他以前的班级。班级不应该确切地知道它传递给谁，但知道足以传递某些信息。这种不知道委托的确切身份的过程称为耦合。

就我而言，对于猫和狗，委托和 IT-IS 是主观上最好的答案。你的意见可能不同。基类应包含 Cat 和 Dog 共享的所有信息。任何其他需要的信息，例如精灵的位置，都应该作为委托传递给其他类。**根据我写的内容，在正常情况下，一个类不应该被编程为执行两个功能；为一个班级做一个功能，并将所有其他尽职尽责的需要传递给另一个。****

# c# - 如何强制应用程序使用不同的配置文件？

> ID：15581512
> 
> 赞同：2
> 
> 时间：2013-03-22T23:36:21.477
> 
> 标签：c#, .net, .net-4.0, configuration, app-config

我有几个需要访问同一个 app.config 文件的 winforms 应用程序。而不是创建 app1.config、app2.config、app3.config 等......有没有办法以某种方式告诉 ConfigurationManager 对象改为读取`common.config`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:57:42.630

您可以使用 ConfigurationManager 类通过代码加载备用配置文件。

[ConfigurationManager 类 (System.Configuration)](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T17:47:55.263

您的每个文件都将引用其配置文件。如果您想要单独的配置文件，只需在相应页面上的呼叫中提及他们的名称，他们就会将他们的控件重定向到该配置。

# javascript - 单击跨度时，关注跨度内的第一个表单元素

> ID：15581514
> 
> 赞同：1
> 
> 时间：2013-03-22T23:36:35.707
> 
> 标签：javascript, jquery, html, css

单击跨度时，我无法弄清楚如何关注跨度内的第一个表单元素。我已经包含了我的代码，我也搞砸了“最接近”但没有运气。

```
<form>
<span>
  <input id="content" type="text">
  <label for="content">Content</label>
</span>
</form>

$('span').click(function() {
    $(this).find('input').focus()
}); 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T23:45:06.577

在回答您的实际问题之前：有一种方法可以实现您正在尝试做的事情，甚至不需要任何 JavaScript。

如果您将输入字段包装在标签标签中，单击标签将自动将焦点放在该字段上。

```
<form>
    <label>
        Content
        <input id="content" name="content" type="text">
    </label>
</form> 
```

* * *

如果您坚持通过 JavaScript/jQuery 执行此操作，则必须确保仅在 DOM 准备好后附加点击处理程序：

```
$(document).ready(function () { // Or equivalent: $(function() { ... });
    $('span').click(function () {
        $(this).find('input:first').focus(); // :first makes sure only the first input found is selected
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-22T23:44:21.957

为什么不使用标签来触发此功能，`span`它将仅涵盖`label`，`input`因此，如果我理解正确，您希望将焦点设置在`input`即使用户单击时`lable`也可以这样实现：

```
<form>
    <span>
       <input name="content" id="content" type="text">
       <label for="content">Content</label>
    </span>
</form> 
```

但是，如果您正在尝试做其他事情，那么：

```
$(document).ready(function(){
   $('span').click(function() {
     $(this).find('input:first').focus();
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T23:40:07.567

确保在加载 DOM 后调用您的 js

```
<script type="text/javascript">
  $(function(){
    $('span').click(function() {
      $(this).find('input').focus()
    });
  });
</script> 
```

# php - 实体负载上的 Symfony2 原则更改值

> ID：15581520
> 
> 赞同：1
> 
> 时间：2013-03-22T23:36:53.600
> 
> 标签：php, symfony, doctrine

我有一个具有字段的数据库结构`content`。在数据库中这是 a `BLOB`(so a `string`)。`content`包含 JSON 编码的字符串。

当我加载它时，我想将它加载到一个特定的`Content`对象中（`Content`对于 JSON 的每种可能格式都有一个不同的子类）。

是否有任何事件或任何我可以连接的东西，以便我可以在构建实体之前立即捕获值（所以我可以对类进行`setContent()`类型提示`Content`而不是必须是通用的，如果信息我必须这样做在我拦截之前加载到实体中）。

有任何想法吗？

* * *

更多细节。基本上我想象的是有某种工厂类，它接受一个 JSON 字符串并将其转换为适当的对象。

```
{
    body: "ABC",
    value: 5
} 
```

转到这样的类的对象：

```
class MyContent extends Content
{
    protected $body;
    protected $value;
} 
```

我不能使用典型的对象映射，因为它是对象的 JSON 字符串。

* * *

进一步澄清

基本上，我有一个名为`Box`. `Box`有一个`content`值，它应该是`Content`.

在正常情况下，如果是一个普通的数据库实体，我只需在and`Content`之间建立一对一的关系，它会正确加载到而不需要做任何特殊的事情。`Box``Content``Content``Box`

但是，在这种情况下，`Content`可以有多种形式。为了处理这个问题，它以 JSON 对象的形式存储在's 表的`BLOB`字段中。`Box`这意味着当 Doctrine 尝试加载时`Box`，它会尝试加载一个字符串。

我可以简单地`Box::setContent()`接受任何参数并根据它是字符串还是`Content`对象来相应地处理它。

但是，我想要它，所以当它被使用时，它**总是**一个`Content`对象，所以我想要函数的类型提示（即，`Box::setContent(Content $content)`）。问题是这会阻止 Doctrine 为该字段提供字符串。

这就是为什么我想拦截 Doctrine 的值`content`并在将其加载到实体之前将其替换为适当的对象`Box`。

我不认为任何 Doctrine 事件都完全符合我的要求，所以它可能真的不可能。=S

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:45:29.500

您应该能够向实体 get 方法添加代码来执行此操作。您还可以查看学说的生命周期回调：http: [//docs.doctrine-project.org/en/2.0.x/reference/events.html#lifecycle-callbacks](http://docs.doctrine-project.org/en/2.0.x/reference/events.html#lifecycle-callbacks)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-24T21:40:13.760

您可以使用 JMSSerializer 从 JSON - [https://github.com/schmittjoh/JMSSerializerBundle](https://github.com/schmittjoh/JMSSerializerBundle)创建实体。

我无法理解你的问题，但也许你可以使用 json_array 类型 - [http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/basic-mapping.html#doctrine-mapping -类型](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/basic-mapping.html#doctrine-mapping-types)

您需要从数据库加载数据而不是创建实体吗？或者加载具有从 JSON 反序列化的嵌套实体的某些字段的实体？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T00:24:52.457

最终我所做的只是为每种可能的`Content`类型创建不同的表和实体，然后使用 Doctrine 的继承让 Doctrine 处理它们。不知道（因为可能有很多很多类型，这意味着更多的表，我不能只是动态地构造新类型），但它现在运行良好。

[教义传承](http://docs.doctrine-project.org/en/2.0.x/reference/inheritance-mapping.html)

# php - Kohana 3.3 $_has_many 错误

> ID：15581522
> 
> 赞同：1
> 
> 时间：2013-03-22T23:37:05.077
> 
> 标签：php, orm, kohana, has-many, has-one

我正在尝试在用户和他的客户之间建立一对多的关系。当我这样设置模型时，我可以访问单个客户端：

```
class Model_User extends Model_Auth_User {
    protected $_has_one = array(
        'client' => array(
            'model' => 'Client',
            'foreign_key' => 'user_id')
    );
    [...] 
```

但是当我尝试切换到 $_has_many 时：

```
class Model_User extends Model_Auth_User {
    protected $_has_many = array(
        'clients' => array(
            'model' => 'Client',
            'foreign_key' => 'user_id')
    );
    [...] 
```

我收到以下错误：

```
Database_Exception [ 1103 ]: Incorrect table name '' [ SELECT COUNT(*) AS `records_found` FROM `` WHERE = '74' AND IN ('4') ] 
```

想不通怎么回事。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T21:24:18.950

我发现了问题。在我的用户模型中声明 $_has_many 属性会覆盖 Kohana 源文件中的相同属性，其中包含角色和令牌信息。

通过复制 Kohana 的 Model_Auth_User 中的值并添加我的属性来解决：

```
protected $_has_many = array(
    'user_tokens' => array('model' => 'User_Token'),
    'roles'       => array('model' => 'Role', 'through' => 'roles_users'),
    'clients'     => array('model' => 'Client', 'foreign_key' => 'user_id'),
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T16:21:40.023

它在客户端中的外观如何？如果你有“Client -> has_one -> User”，这应该不是问题。

如果你有“Client -> has_many -> User”，你需要[has_many through](http://kohanaframework.org/3.3/guide/orm/relationships#hasmany-through)

# vb.net - 从支持多行而不擦除的按钮向文本框添加文本

> ID：15581523
> 
> 赞同：0
> 
> 时间：2013-03-22T23:37:21.793
> 
> 标签：vb.net

所以基本上我想要做的是单击一个按钮，这会将我的文本放入一个文本框并在其后添加 ?xml=1 。如果有人想帮助我完成整个事情，那么图像低于我想要它做的事情

这就是我的意思[http://i.stack.imgur.com/2eatj.png](http://i.stack.imgur.com/2eatj.png)

这是它的样子[http://i.stack.imgur.com/aCoJ0.png](http://i.stack.imgur.com/aCoJ0.png)但是每次我点击 ?xml=1 它都会添加到底部这并不重要我点击哪一行它只会将它添加到最后

我用于 ?xml=1 部分的是 TextBox1.Text &= "?xml=1" {Public Class Form1

```
Private Sub TextBox1_TextChanged(sender As Object, e As EventArgs) Handles TextBox1.TextChanged

End Sub

Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click
    TextBox1.Text &= "?xml=1"
End Sub 
```

结束类}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T03:53:29.517

您的表格不完整，需要各种信息来生成 Steam64Id 编号。

即，您将需要“Universe”、“AccountType”、“AccountInstance”，当然还有“Account Number”。

当您将组件值值放在一起时，您最终会得到 Steam64Id 编号。

您可以在下图中看到它是如何分解的。

![Steam64Id 编号的细分](../Images/1e9cb73e1f289687654a27f80a103e68.png)

更多信息可以在 Steam 开发者页面上找到

[https://developer.valvesoftware.com/wiki/SteamID](https://developer.valvesoftware.com/wiki/SteamID)

# 更新

如果您在其中输入帐号的文本框称为 txtSource，并且您输入的数字为 0123456789，并且在添加“？xml = 1”后要写入的文本框称为 txtDestination，则将其传输过来的代码是

```
txtDestination.text = txtSource.text & "?xml=1" 
```

如果您想在添加 URL 的同时将其传输过来，那么它将是

```
txtDestination.text = "http://steamcommunity.com/ID/" & txtSource.text & "?xml=1" 
```

或者

```
txtDestination.text = "http://steamcommunity.com/PROFILES/" & txtSource.text & "?xml=1" 
```

仍然存在一些未解决的问题，因为您尚未澄清它是 ID 还是配置文件，因此当您将其重写为 URL 时，它会是[http://steamcommunity.com/ID/0123456789?xml=1](http://steamcommunity.com/ID/0123456789?xml=1)还是会它是[http://steamcommunity.com/PROFILES/0123456789?xml=1](http://steamcommunity.com/PROFILES/0123456789?xml=1)我猜只有一个是对的，另一个是错的。

一旦您获得了正确的文件夹（无论是其 ID 还是 Profiles），成功的调用将返回一个 XML 文档，您必须从中提取数据。

# 更新二

好吧，我今天有一些空闲时间，所以我设法敲掉了这段代码，它与图像一起向下，我没有时间进行网页抓取，但我相信会有很多关于 SO 的示例其他用户问过类似问题的地方。希望这足以让您上路。

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

Dim Reference As Long

  If Trim(TextBox1.Text) <> "" Then
    If IsNumeric(TextBox1.Text) Then
      Reference = Shell("c:\program files\internet explorer\iexplore.exe http://steamcommunity.com/profiles/" & Trim(TextBox1.Text) & "?xml=1")
    Else
      Reference = Shell("c:\program files\internet explorer\iexplore.exe http://steamcommunity.com/id/" & Trim(TextBox1.Text) & "?xml=1")
    End If
  Else
    MsgBox("No steam Id entered!", MsgBoxStyle.Critical, "Error")
  End If

End Sub

Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click

  If Trim(TextBox2.Text) <> "" Then
    TextBox3.Text = "http://steamcommunity/friends/add/" & TextBox2.Text
  Else
    MsgBox("No steam 64 Id specified!", MsgBoxStyle.Critical, "Error")
  End If

End Sub

Private Sub Button3_Click(sender As System.Object, e As System.EventArgs) Handles Button3.Click

Dim Reference As Long

  If Trim(TextBox3.Text) <> "" Then
    Reference = Shell("c:\program files\internet explorer\iexplore.exe " & Trim(TextBox3.Text))
  Else
    MsgBox("No steam 64 Id specified!", MsgBoxStyle.Critical, "Error")
  End If

End Sub 
```

![在此处输入图像描述](../Images/0b456f646b0730c8949c6658dbe59e41.png)

# batch-file - 批处理文件列出文件并将其复制到另一个目录

> ID：15581527
> 
> 赞同：-1
> 
> 时间：2013-03-22T23:37:51.723
> 
> 标签：batch-file

我是批处理文件的新手，尽管自 1980 年代中期以来我就有一台计算机。我需要创建一个（最好是简单的）批处理文件，该文件将列出驱动器 D:\TAR\ 上的所有目录（可能是文本文件？）并将扩展名 .tar 附加到目录名称中。然后我想将 E:\Incomplete\File1.tar 上的所有 .tar 文件（在创建的文本文件中）复制到 F:\ToComplete\ 目录。

我尝试从 DOS 命令提示符执行此操作，但我不知道如何将 .tar 扩展名放在目录名称上并进行复制。我一直在谷歌搜索，在这个网站上搜索，没有类似的问题。

网络上是否有一个列表列出了大多数可以在 .bat 文件中使用的命令，例如 @echo、end、if、then 等？我希望能够以它为指导。我将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:44:53.957

命令提示符有一个内置`help`命令，提供了一个不错的常用命令列表，每个命令都支持`/?`开关以获得更多信息。

您通常会使用该`for`命令来枚举目录的内容，如果您需要对目录条目执行字符串操作，您可能会发现命令提示符的“延迟扩展”功能很有用。此功能默认关闭，但可以通过运行为交互式会话启用`cmd /v:on`。（永久启用此功能需要注册表设置。）

就您这里的具体问题而言，当您说“D:\TAR\ 下的所有目录”时，那会是递归操作吗？

# c# - 统一正则表达式

> ID：15581528
> 
> 赞同：3
> 
> 时间：2013-03-22T23:37:53.777
> 
> 标签：c#, regex, unity3d

您好我正在使用以下正则表达式命令仅允许将数字输入到文本字段中

```
Regex rgx = new Regex("[^0-9]"); 
```

但是，这显然不允许输入正负号 +/-。我希望能够输入 -9 作为负值，但是当我这样做时，它会返回为 09。任何帮助获得正确的正则表达式将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T00:36:23.127

你去吧，这个工作 100% 刚刚测试以确保 ;)

```
Regex r = new Regex("^([-+]?)?[0-9]+(,[0-9]+)?$"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:49:03.753

在我看来，您的表达式解析为*除 0 到 9 之外*的所有内容...为了允许*任何带有正号或负号*的数字，我将使用以下表达式：

```
([-+]{0,1}[0-9]+) 
```

+ 或 - 开头 0 或 1 次，之后任何数量>0 的 0...9。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T00:49:30.150

正则表达式 rgx = new Regex("[^-][^0-9]+");

# java - Android 音乐播放器 fc 和错误打开跟踪文件

> ID：15581531
> 
> 赞同：0
> 
> 时间：2013-03-22T23:38:01.780
> 
> 标签：java, android, media-player, audio-player, android-music-player

我最近一直在构建一个音乐应用程序，并且我一直在使用一些源代码并将其定制为我自己的规范。我完成了编辑和调试，它在启动时暂停。

调试：

```
Thread [<1> main] (Suspended (exception RuntimeException))  
ActivityThread.performLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 2306    
ActivityThread.handleLaunchActivity(ActivityThread$ActivityClientRecord, Intent) line: 2356 
ActivityThread.access$600(ActivityThread, ActivityThread$ActivityClientRecord, Intent) line: 150    
ActivityThread$H.handleMessage(Message) line: 1244  
ActivityThread$H(Handler).dispatchMessage(Message) line: 99 
Looper.loop() line: 137 
ActivityThread.main(String[]) line: 5195    
Method.invokeNative(Object, Object[], Class, Class[], Class, int, boolean) line: not available [native method]  
Method.invoke(Object, Object...) line: 511  
ZygoteInit$MethodAndArgsCaller.run() line: 795  
ZygoteInit.main(String[]) line: 562 
NativeStart.main(String[]) line: not available [native method] 
```

[Logcat 日志](https://dl.dropbox.com/u/21682671/log2.txt)（似乎无法在此处显示）

有人可以看看我的代码并告诉我哪里出错了吗？

这是我的项目类代码：

```
package com.timmo.tampmusicplayer;

import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Random;

import android.app.Activity;
import android.content.Intent;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnCompletionListener;
import android.os.Bundle;
import android.os.Handler;
import android.view.View;
import android.widget.ImageButton;
import android.widget.SeekBar;
import android.widget.TextView;
import android.widget.Toast;

public class NowPlaying extends Activity implements OnCompletionListener, SeekBar.OnSeekBarChangeListener {

private ImageButton btnPlay;
private ImageButton btnNext;
private ImageButton btnPrevious;
private ImageButton btnPlaylist;
private ImageButton btnRepeat;
private ImageButton btnShuffle;
private SeekBar songProgressBar;
private TextView songTitleLabel;
private TextView songCurrentDurationLabel;
private TextView songTotalDurationLabel;
// Media Player
private MediaPlayer mp;
// Handler to update UI timer, progress bar etc,.
private Handler mHandler = new Handler();;
private SongsManager songManager;
private Utilities utils;
private int seekForwardTime = 5000; // 5000 milliseconds
private int seekBackwardTime = 5000; // 5000 milliseconds
private int currentSongIndex = 0;
private boolean isShuffle = false;
private boolean isRepeat = false;
private ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.nowplaying);

    // All player buttons
    btnPlay = (ImageButton) findViewById(R.id.bplay);
    btnNext = (ImageButton) findViewById(R.id.bnext);
    btnPrevious = (ImageButton) findViewById(R.id.bprevious);
    btnPlaylist = (ImageButton) findViewById(R.id.bLibrary);
    btnRepeat = (ImageButton) findViewById(R.id.brepeat);
    btnShuffle = (ImageButton) findViewById(R.id.bshuffle);
    songProgressBar = (SeekBar) findViewById(R.id.songProgressBar);
    songTitleLabel = (TextView) findViewById(R.id.songTitle);
    songCurrentDurationLabel = (TextView) findViewById(R.id.tvtimecurrent);
    songTotalDurationLabel = (TextView) findViewById(R.id.tvtimetotal);

    // Mediaplayer
    mp = new MediaPlayer();
    songManager = new SongsManager();
    utils = new Utilities();

    // Listeners
    songProgressBar.setOnSeekBarChangeListener(this); // Important
    mp.setOnCompletionListener(this); // Important

    // Getting all songs list
    songsList = songManager.getPlayList();

    // By default play first song
    playSong(0);

    /**
     * Play button click event plays a song and changes button to pause
     * image pauses a song and changes button to play image
     * */
    btnPlay.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            // check for already playing
            if (mp.isPlaying()) {
                if (mp != null) {
                    mp.pause();
                    // Changing button image to play button
                    btnPlay.setImageResource(R.drawable.play);
                }
            } else {
                // Resume song
                if (mp != null) {
                    mp.start();
                    // Changing button image to pause button
                    btnPlay.setImageResource(R.drawable.pause);
                }
            }

        }
    });

    /**
     * Forward button click event Forwards song specified seconds
     * */
    btnNext.setOnLongClickListener(new View.OnLongClickListener() {

        @Override
        public boolean onLongClick(View arg0) {
            // get current song position
            int currentPosition = mp.getCurrentPosition();
            // check if seekForward time is lesser than song duration
            if (currentPosition + seekForwardTime <= mp.getDuration()) {
                // forward song
                mp.seekTo(currentPosition + seekForwardTime);
            } else {
                // forward to end position
                mp.seekTo(mp.getDuration());
            }
            return true;
        }
    });

    /**
     * Backward button click event Backward song to specified seconds
     * */
    btnPrevious.setOnLongClickListener(new View.OnLongClickListener() {

        @Override
        public boolean onLongClick(View arg0) {
            // get current song position
            int currentPosition = mp.getCurrentPosition();
            // check if seekBackward time is greater than 0 sec
            if (currentPosition - seekBackwardTime >= 0) {
                // forward song
                mp.seekTo(currentPosition - seekBackwardTime);
            } else {
                // backward to starting position
                mp.seekTo(0);
            }
            return true;

        }
    });

    /**
     * Next button click event Plays next song by taking currentSongIndex +
     * 1
     * */
    btnNext.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            // check if next song is there or not
            if (currentSongIndex < (songsList.size() - 1)) {
                playSong(currentSongIndex + 1);
                currentSongIndex = currentSongIndex + 1;
            } else {
                // play first song
                playSong(0);
                currentSongIndex = 0;
            }

        }
    });

    /**
     * Back button click event Plays previous song by currentSongIndex - 1
     * */
    btnPrevious.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            if (currentSongIndex > 0) {
                playSong(currentSongIndex - 1);
                currentSongIndex = currentSongIndex - 1;
            } else {
                // play last song
                playSong(songsList.size() - 1);
                currentSongIndex = songsList.size() - 1;
            }

        }
    });

    /**
     * Button Click event for Repeat button Enables repeat flag to true
     * */
    btnRepeat.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            if (isRepeat) {
                isRepeat = false;
                Toast.makeText(getApplicationContext(), "Repeat is OFF", Toast.LENGTH_SHORT).show();
                btnRepeat.setImageResource(R.drawable.norepeat);
            } else {
                // make repeat to true
                isRepeat = true;
                Toast.makeText(getApplicationContext(), "Repeat is ON", Toast.LENGTH_SHORT).show();
                // make shuffle to false
                isShuffle = false;
                btnRepeat.setImageResource(R.drawable.repeat);
                btnShuffle.setImageResource(R.drawable.noshuffle);
            }
        }
    });

    /**
     * Button Click event for Shuffle button Enables shuffle flag to true
     * */
    btnShuffle.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            if (isShuffle) {
                isShuffle = false;
                Toast.makeText(getApplicationContext(), "Shuffle is OFF", Toast.LENGTH_SHORT).show();
                btnShuffle.setImageResource(R.drawable.noshuffle);
            } else {
                // make repeat to true
                isShuffle = true;
                Toast.makeText(getApplicationContext(), "Shuffle is ON", Toast.LENGTH_SHORT).show();
                // make shuffle to false
                isRepeat = false;
                btnShuffle.setImageResource(R.drawable.noshuffle);
                btnRepeat.setImageResource(R.drawable.norepeat);
            }
        }
    });

    /**
     * Button Click event for Play list click event Launches list activity
     * which displays list of songs
     * */
    btnPlaylist.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            Intent i = new Intent(getApplicationContext(), Library.class);
            startActivityForResult(i, 100);
        }
    });

}

/**
 * Receiving song index from playlist view and play the song
 * */
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    if (resultCode == 100) {
        currentSongIndex = data.getExtras().getInt("songIndex");
        // play selected song
        playSong(currentSongIndex);
    }

}

/**
 * Function to play a song
 * 
 * @param songIndex
 *            - index of song
 * */
public void playSong(int songIndex) {
    // Play song
    try {
        mp.reset();
        mp.setDataSource(songsList.get(songIndex).get("songPath"));
        mp.prepare();
        mp.start();
        // Displaying Song title
        String songTitle = songsList.get(songIndex).get("songTitle");
        songTitleLabel.setText(songTitle);

        // Changing Button Image to pause image
        btnPlay.setImageResource(R.drawable.pause);

        // set Progress bar values
        songProgressBar.setProgress(0);
        songProgressBar.setMax(100);

        // Updating progress bar
        updateProgressBar();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
}

/**
 * Update timer on seekbar
 * */
public void updateProgressBar() {
    mHandler.postDelayed(mUpdateTimeTask, 100);
}

/**
 * Background Runnable thread
 * */
private Runnable mUpdateTimeTask = new Runnable() {
    public void run() {
        long totalDuration = mp.getDuration();
        long currentDuration = mp.getCurrentPosition();

        // Displaying Total Duration time
        songTotalDurationLabel.setText("" + utils.milliSecondsToTimer(totalDuration));
        // Displaying time completed playing
        songCurrentDurationLabel.setText("" + utils.milliSecondsToTimer(currentDuration));

        // Updating progress bar
        int progress = (int) (utils.getProgressPercentage(currentDuration, totalDuration));
        // Log.d("Progress", ""+progress);
        songProgressBar.setProgress(progress);

        // Running this thread after 100 milliseconds
        mHandler.postDelayed(this, 100);
    }
};

/**
 * 
 * */
@Override
public void onProgressChanged(SeekBar seekBar, int progress, boolean fromTouch) {

}

/**
 * When user starts moving the progress handler
 * */
@Override
public void onStartTrackingTouch(SeekBar seekBar) {
    // remove message Handler from updating progress bar
    mHandler.removeCallbacks(mUpdateTimeTask);
}

/**
 * When user stops moving the progress hanlder
 * */
@Override
public void onStopTrackingTouch(SeekBar seekBar) {
    mHandler.removeCallbacks(mUpdateTimeTask);
    int totalDuration = mp.getDuration();
    int currentPosition = utils.progressToTimer(seekBar.getProgress(), totalDuration);

    // forward or backward to certain seconds
    mp.seekTo(currentPosition);

    // update timer progress again
    updateProgressBar();
}

/**
 * On Song Playing completed if repeat is ON play same song again if shuffle
 * is ON play random song
 * */
@Override
public void onCompletion(MediaPlayer arg0) {

    // check for repeat is ON or OFF
    if (isRepeat) {
        // repeat is on play same song again
        playSong(currentSongIndex);
    } else if (isShuffle) {
        // shuffle is on - play a random song
        Random rand = new Random();
        currentSongIndex = rand.nextInt((songsList.size() - 1) - 0 + 1) + 0;
        playSong(currentSongIndex);
    } else {
        // no repeat or shuffle ON - play next song
        if (currentSongIndex < (songsList.size() - 1)) {
            playSong(currentSongIndex + 1);
            currentSongIndex = currentSongIndex + 1;
        } else {
            // play first song
            playSong(0);
            currentSongIndex = 0;
        }
    }
}

@Override
public void onDestroy() {
    super.onDestroy();
    mp.release();
}

} 
```

图书馆.java

```
package com.timmo.tampmusicplayer;

import java.util.ArrayList;
import java.util.HashMap;

import android.app.ListActivity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ListAdapter;
import android.widget.ListView;
import android.widget.SimpleAdapter;

public class Library extends ListActivity {
// Songs list
public ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.playlist);

    ArrayList<HashMap<String, String>> songsListData = new ArrayList<HashMap<String, String>>();

    SongsManager plm = new SongsManager();
    // get all songs from sdcard
    this.songsList = plm.getPlayList();

    // looping through playlist
    for (int i = 0; i < songsList.size(); i++) {
        // creating new HashMap
        HashMap<String, String> song = songsList.get(i);

        // adding HashList to ArrayList
        songsListData.add(song);
    }

    // Adding menuItems to ListView
    ListAdapter adapter = new SimpleAdapter(this, songsListData,
            R.layout.playlist_item, new String[] { "songTitle" }, new int[] {
                    R.id.songTitle });

    setListAdapter(adapter);

    // selecting single ListView item
    ListView lv = getListView();
    // listening to single listitem click
    lv.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // getting listitem index
            int songIndex = position;

            // Starting new intent
            Intent in = new Intent(getApplicationContext(),
                    NowPlaying.class);
            // Sending songIndex to PlayerActivity
            in.putExtra("songIndex", songIndex);
            setResult(100, in);
            // Closing PlayListView
            finish();
        }
    });

}
} 
```

只要您确保自己有意义，任何事情都很棒谢谢

日志猫

```
3-22 23:53:21.335: E/AndroidRuntime(25591): FATAL EXCEPTION: main
03-22 23:53:21.335: E/AndroidRuntime(25591): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.timmo.tampmusicplayer/com.timmo.tampmusicplayer.NowPlaying}: java.lang.ClassCastException: android.widget.Button cannot be cast to android.widget.ImageButton
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2306)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2356)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.ActivityThread.access$600(ActivityThread.java:150)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1244)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.os.Looper.loop(Looper.java:137)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.ActivityThread.main(ActivityThread.java:5195)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at java.lang.reflect.Method.invokeNative(Native Method)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at java.lang.reflect.Method.invoke(Method.java:511)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:795)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:562)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at dalvik.system.NativeStart.main(Native Method)
03-22 23:53:21.335: E/AndroidRuntime(25591): Caused by: java.lang.ClassCastException: android.widget.Button cannot be cast to android.widget.ImageButton
03-22 23:53:21.335: E/AndroidRuntime(25591):    at com.timmo.tampmusicplayer.NowPlaying.onCreate(NowPlaying.java:54)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.Activity.performCreate(Activity.java:5104)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
03-22 23:53:21.335: E/AndroidRuntime(25591):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2260)
03-22 23:53:21.335: E/AndroidRuntime(25591):    ... 11 more 
```

* * *

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:32:08.577

您将一个对象转换为错误的类型。

```
03-22 23:53:21.335: E/AndroidRuntime(25591):
 java.lang.RuntimeException: Unable to start activity 
ComponentInfo{com.timmo.tampmusicplayer/com.timmo.tampmusicplayer.NowPlaying}:
 java.lang.ClassCastException: android.widget.Button cannot be cast to 
android.widget.ImageButton 
```

我将详细说明：您的布局中有一个按钮，您正尝试将其作为 ImageButton 访问。

# php - 我可以通过没有 read.php 的 php 读取和解析 Excel 工作表吗？

> ID：15581532
> 
> 赞同：0
> 
> 时间：2013-03-22T23:38:14.050
> 
> 标签：php, excel

我需要阅读许多 excel 表，为此，我正在使用 php。我的问题是我在哪里可以得到这个 read.php，我应该把它保存在哪里？另外，我应该把我的excel表放在哪里？我从来没有在网上看到过代码中给出的 Excel 表格的路径。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:53:25.997

PHPExcel 是一个免费的全功能 PHP 库，用于读取和编写 Excel 电子表格（xls 和 xlsx）。

[http://phpexcel.codeplex.com/](http://phpexcel.codeplex.com/)

几乎任何事情都可以用它来完成，就像普通用户使用 Excel 所做的那样，但它的使用需要 OOP 技能和一些更高级别的 PHP 练习。

# ios - 为 CGFloat 赋值时使用“f”有什么意义？

> ID：15581535
> 
> 赞同：15
> 
> 时间：2013-03-22T23:38:29.267
> 
> 标签：ios, objective-c, macos, cocoa-touch, cocoa

我经常看到这个：

```
CGFloat someCGFloat = 1.2f; 
```

为什么使用“f”？如果`CGFloat`定义为`float`，则值将转换为 a `float`，如果`CGFloat`定义为 a `double`，则将值转换为 a `double`。

是否只是为了确保不会发生从`double`to的转换？`float`这样做有什么意义？另外，编译器不会处理这个吗？

**编辑：**嗯……哪个答案可以接受……两者都很好！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-22T23:54:44.017

1.0 默认为 double，如果正确的值为 1.2，则存在隐式转换，并且该值从 double 转换为 float（转换不是运行时操作）。在这种情况下，将其称为 1.2f 并不重要。程序员大多滥用它，但在某些情况下它真的很重要。

例如：

```
float var= 1.0e-45;
NSLog(@"%d",var==1.0e-45); 
```

这将打印零，因为 1.0e-45 太小而无法存储到单精度浮点变量中，因此它等于零。写入 var==1.0e-45f 会改变结果。

使用格式说明符主要在编写表达式时很重要，并且由于左值是浮点数，因此您希望表达式也被视为浮点数，但事实并非如此。

一个更引人注目的情况是，当在一个数字上使用 l 格式说明符时，该数字会发生如此大的变化而变成零，并对结果感到惊讶：

```
long var= 1<<32;  // I assume that an int takes 4 bytes and a long 8 bytes 
```

结果为零，写入 1l<<32 会完全改变结果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-22T23:55:33.593

在您的代码段中，只是一个作业，您不需要“f”后缀，实际上您不应该使用它。如果 CGFloat 是单精度（如在 iOS 中），那么您的值将存储为单精度，带或不带“f”，如果 CGFloat 是双精度（如在 Mac OS 上），那么您将不必要地创建一个单精度值存储双精度。

另一方面，如果你在做算术，你应该小心使用“f”或不使用它。如果您使用单精度并包含像“1.2”这样的文字而没有“f”，那么编译器会将其他操作数提升为双精度。如果您使用双精度并包含“f”，那么（如 Mac OS 上的赋值），您将创建一个单精度值，只是为了将其立即转换为双精度值。

# python - 字典存储对。谁存储三倍体？

> ID：15581537
> 
> 赞同：1
> 
> 时间：2013-03-22T23:38:34.633
> 
> 标签：python, dictionary, store

我们将使用字典来存储例如：

```
a={"breakfast":"banana","lunch":"fish","dinner":"soup"} 
```

如果您想在每个键值集旁边添加时间属性，您的方法是什么。当然不是：

```
a={"8AM":"breakfast":"banana","2PM":"lunch":"fish","8PM":"dinner":"soup"} 
```

然后我想使用一个或多个键来访问一个值。

也许通过使用列表做一个技巧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T23:42:19.923

您可以使用元组作为字典键：

```
a = {("8AM", "breakfast"): "banana",
     ("2PM", "lunch"): "fish",
     ("8PM", "dinner"): "soup",
    } 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-22T23:42:32.400

使用以元组为键的字典：

```
>>> a={("8AM","breakfast"):"banana",("2PM","lunch"):"fish",("8PM","dinner"):"soup"}
>>> a["8AM","breakfast"]
'banana' 
```

或者，如果您想仅使用餐点名称来查找时间和食物：

```
>>> a={"breakfast":("8AM","banana"),"lunch":("2PM","fish"),"dinner":("8PM","soup")}
>>> a["breakfast"]
('8AM', 'banana') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-22T23:47:51.227

由于您想使用字典和可能的列表，我建议您确定您的“主键”是什么并创建一个像这样的嵌套结构：

```
a = {
    'breakfast': {
        'time': "8AM",
        'items': ['banana', 'yogurt']
    },
    'lunch': {
        'time': '2PM',
        'items': ['fish', 'tartar sauce']
    },
    'dinner': {
        'time': '8PM',
        'items': ['soup', 'salad']
    }
} 
```

每顿饭的时间是可变的，但我们都知道我们吃早餐、午餐和晚餐（或者至少我们应该吃）。这样做，您可以确定消耗的时间和项目：

```
a['breakfast']['time']
'8AM'

a['breakfast']['items']
['banana', 'yogurt'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-22T23:53:30.090

```
a = {"8AM":{"breakfast":"banana"},"2PM":{"lunch":"fish"},"8PM":{"dinner":"soup"}} 
```

使用：

```
>>>a['8AM']['breakfast']
'banana' 
```

其他：

```
def r(_d,_target):
    result = []
    for k, v in _d.items():
        if(k == _target):
            if type(v) == type({}):
                for x in v.keys():
                    result.append(v[x])
            else:
                result.append(v)
        if type(v) == type({}):
            r2 = r(v,_target)
            if len(r2) > 0:
                for l in r2:
                    result.append(l)
    return result

>>> r(a,"breakfast")
['banana']
>>> r(a,"8AM")
['banana']
>>> r(a,"dinner")
['soup'] 
```

# c# - 可操作的数据表

> ID：15581539
> 
> 赞同：1
> 
> 时间：2013-03-22T23:38:50.623
> 
> 标签：c#, sql, database, user-interface, user-controls

我有使用 c# 实现 UI 的要求，用户可以在其中操作他们希望在文档上显示的数据。数据应该通过 SQL 进入程序（最好不要使用表适配器，因为数据库会被硬编码到程序中，但如果绝对必要的话会使用它）。

当用户选择进入数据库表时，会出现以下 UI：

[https://docs.google.com/file/d/0B6b_N7sDgjmvcUt2amxNaXpJRFU/edit?usp=sharing](https://docs.google.com/file/d/0B6b_N7sDgjmvcUt2amxNaXpJRFU/edit?usp=sharing) [https://docs.google.com/file/d/0B6b_N7sDgjmvdUhmMUJFbEdKeVk/edit?usp=sharing](https://docs.google.com/file/d/0B6b_N7sDgjmvdUhmMUJFbEdKeVk/edit?usp=sharing) [https://docs.google。 com/file/d/0B6b_N7sDgjmvM3BSWDEyM0ROOFE/edit?usp=sharing](https://docs.google.com/file/d/0B6b_N7sDgjmvM3BSWDEyM0ROOFE/edit?usp=sharing)

*   用户应该能够选择他们想要添加到表中的列（从所有表中，应使用 PK/FK 建立连接。），并对这些数据进行排序和移动。

*   然后控件应该能够生成用于从数据库中提取该信息的 sql（或者甚至将数据库传递回主程序，但更喜欢 SQL）

我已经在许多程序中看到过这个 UI，并且想认为那里有一个库可以省去我从头开始制作这个 UI 的麻烦。

是否有任何可用于 C# 的库具有这种功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T12:02:04.517

你也可以试试[DevExpress](http://www.devexpress.com/)。我们使用这个控件库进行编辑操作。它不是免费的，但物有所值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T15:44:50.113

Telerik 的[Rad Grid](http://www.telerik.com/products/aspnet-ajax/grid.aspx)将为您提供上下文菜单和列重新排序方面的所有功能。但是，您将无法输出重新生成表所需的代码。您可以使用在一系列格式（pdf、word、excel 等）中指定的列顺序直接从网格中导出数据。

Rad Grid 也不是免费的，它是一组控件的一部分。

# php - 如何在不提交的情况下使用javascript选择后从列表框中获取值

> ID：15581542
> 
> 赞同：-2
> 
> 时间：2013-03-22T23:38:53.780
> 
> 标签：php, javascript, drop-down-menu, yii, listbox

我在 php（Yii 框架）中编程，我想在选择每个列表框后立即从几个（单选）列表框中获取值。我想在不转到另一个页面或重新加载当前页面的情况下获取它们。最终，这些值应该以 $_SESSION 结尾。

我在这里找到的最接近的线程（ [没有提交按钮](https://stackoverflow.com/questions/14939640/selectbox-without-submit-button)的选择框 ）没有解决我的问题。它仍然依赖于一个按钮，目前还不清楚如何处理 php.ini 中获取的值。

我假设我需要一个像 dropDownList() ( [http://www.yiiframework.com/doc/api/1.1/CHtml#dropDownList-detail](http://www.yiiframework.com/doc/api/1.1/CHtml#dropDownList-detail) ) 这样的函数，它有一个允许 javascript 代码的“选项”字段。

到目前为止我发现的函数——activeDropDownList() 和 dropDownList()——没有“选项字段”。（或者至少没有记录。）

您建议使用什么功能（或功能组合）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:49:15.097

只需将偶然事件侦听器连接到有问题的选择框。在该事件侦听器中，只需获取它们的值并使用 jquery 进行 .ajax() 调用，以将值发送到服务器端 php 脚本，您可以在其中执行任何您需要的操作。

参见： [http :](http://api.jquery.com/jQuery.ajax/) [//api.jquery.com/change/ http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/change/)

# ajax - 如何更改不同页面中的 DIV 内容？

> ID：15581545
> 
> 赞同：0
> 
> 时间：2013-03-22T23:39:53.957
> 
> 标签：ajax, html, replace

我知道有办法在单个页面中更改 DIV 内容。例如，使用 Ajax 从外部 .html 文件动态获取 div 内容，然后使用 load 或 get 函数替换 Div 内容。

但是，有没有办法在不同的页面上执行此操作？

例如，假设有 2 页。One.html 和 Two.html。我想在第一页（One.html）上有一个按钮，当点击它时，将更改页面上特定 DIV Id 的 DIV 内容（默认情况下，div 框是空的，我希望按钮基本上将文本插入框中） 2（两个.html）。

所以过程基本上是：单击 One.html 上的按钮，一些函数从外部 html（例如 Three.html）获取 div 内容，并使用该内容更新 Two.html 上的空 div。另外，我想以类似的方式加载一些基本的 CSS。不仅可以在框中插入文本，还可以更改背景颜色和文本颜色。

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:45:12.240

您只需存储信息并将其发送到下一页，例如，使用 HTTP 请求和提交方法 get 和 post。 [http://www.w3schools.com/tags/ref_httpmethods.asp](http://www.w3schools.com/tags/ref_httpmethods.asp)

# javascript - 表单输入文本显示为“未定义”或“[object HTMLInputElement]”

> ID：15581550
> 
> 赞同：1
> 
> 时间：2013-03-22T23:40:15.543
> 
> 标签：javascript, forms

我有一个表格，其中包含相应输入框的 ID 名称、标题和描述。但是，当我尝试在 HTML 中显示这些值时，我会收到“[object HTMLInputElement]”或“undefined”。

**我在下面的代码块中得到“未定义” ，我在函数外部****全局**声明了变量名称、标题和描述以检索输入值。

```
var name;
var title;
var description;      
document.getElementById("name").onchange = function(){
      name = document.getElementById("name").value;
      };
document.getElementById("title").onchange = function(){
          title = document.getElementById("title").value;
      };
document.getElementById("description").onchange = functio){
          description = document.getElementById("description").value;
      };

var myhtml = '<p>' + name + '</p><p>' + title + '</p><p>' + description + '</p><p>'; 
```

但是，如果我改为在函数内声明变量（而不是“全局”？），我会得到**[object HTMLInputElement] ，如下所示：**

```
document.getElementById("name").onchange = function(){
      var name = document.getElementById("name").value;
      }; 
```

myHTML 是打印在 DOM 中的变量。

这里发生了什么？如果我有全局声明，我已经尝试将名称、标题和描述传递给函数。但这并没有解决问题（我仍然得到“[object HTMLInputElement]”）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T00:32:37.100

“未定义”值是由于“onchange”事件在输入更改之前没有触发。这个 jsfiddle 说明了我的观点：http: [//jsfiddle.net/gR8td/](http://jsfiddle.net/gR8td/)。请注意，在为输入元素键入值后，将显示全局变量的新值。我添加了以下函数来输出值：

```
function showInputs() {
    var myhtml = '<p>' + name + '</p><p>' + title + '</p><p>' + description + '</p>';
    var elem=document.getElementById('output');
    elem.innerHTML = myhtml;
} 
```

# pascal - 如何在方程中使用 Pascal 字符串

> ID：15581551
> 
> 赞同：0
> 
> 时间：2013-03-22T23:40:24.487
> 
> 标签：pascal, freepascal, isbn

我有一个小问题。我编写了一个程序，要求用户输入包含 11 位数字的代码。我将它定义为字符串，但现在我想单独使用此代码中的每个数字并制作一个等式。

例如，如果代码是`37605030299`我需要做方程：

```
(1*3 + 2*7 + 3*6 + 4*0 + 5*5 + 6*0 + 7*3 + 8*0 + 9*2 + 1*9) / 11 
```

并找出什么是MOD。

这是 ISBN 校验位的计算。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T01:16:15.410

请改用循环。（我只显示总值和校验位计算 - 您需要先将用户输入输入到您`UserISBN`自己命名的变量中。）

```
function AddCheckDigit(const UserISBN: string): string;    
var
  i, Sum: Integer;
  CheckDigit: Integer;
  LastCharValue: string;
begin
  Assert(Length(UserISBN) = 10, 'Invalid ISBN number.');
  Sum := 0;
  for i := 1 to 10 do
    Sum := Sum + (Ord(UserISBN[i]) * i);

  { Calculate the check digit }
  CheckDigit := 11 - (Sum mod 11);

  { Determine check digit character value }
  if CheckDigit = 10 then
    LastCharValue := 'X'
  else
    LastCharValue := IntToStr(CheckDigit);

  { Add to string for full ISBN Number }
  Result := UserISBN + LastCharValue;
end; 
```

# joomla2.5 - Joomla - 如何通过 SMTP 从另一台服务器获取电子邮件

> ID：15581555
> 
> 赞同：0
> 
> 时间：2013-03-22T23:41:09.677
> 
> 标签：joomla2.5

您好，我与 joomla 2.5 和 smtp 相混淆。我购买圆顶和托管，并在 cpanel 中创建新电子邮件 (contact@my-site.com)

我希望所有接收和发送的消息都能进入 joomla 管理员邮箱。有人告诉我这是不可能的，我需要模块。

我在 joomla 中为 gmail 配置了我的 SMTP。为什么是gmail？用于测试的 Gmail 是否会在 JO 邮箱中收到消息：

> ```
> Mailer: SMTP
> SMTP Authentication: Yes
> SMTP Security: SSL
> SMTP Port 465
> SMTP username: your gmail username
> SMTP password: your gmail password
> SMTP host: smtp.gmail.com 
> ```

当我从 gmail 向 contact@my-site.com 发送电子邮件时，消息未在 joomla 邮箱中传递。

为什么我做错了我配置 smtp？但是从 gmail 发送到 contact@my-site.com 的所有消息都在 cpanel 邮件服务中传递。

我可以通过 Using Horde、RoundCube 和 SquirrelMail 阅读所有邮件。所有消息都在那里，但我想在 joomla 邮箱中显示该消息。为什么？BCS 我在网站上有很多版主，我不想在 cpanel 上提供完全访问权限。

因此，如果版主想阅读新消息，他必须进入 my-site.com/cpanel 并在那里登录，然后才能阅读消息..

任何人都可以为此提供帮助或提供一些模块或组件来解决此问题。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T09:58:05.240

Joomla 全局配置中的邮件设置仅在 Joomla 本身想要发送一些电子邮件时使用。就像创建新用户时一样，它可以向用户和管理员发送电子邮件。它根本不是为了阅读电子邮件（因此没有 pop 或 imap 设置，只有 smtp）。默认情况下，它将使用网络服务器上存在的 PHP 邮件，大部分时间都可以正常工作。

如果您想在您的 Joomla 网站上阅读来自 Gmail 的电子邮件，您确实需要一个组件。如果您发现可以执行此操作的内容，可以查看 Joomla 扩展目录（JED：[http](http://extensions.joomla.org/extensions/contacts-and-feedback/email) ://extensions.joomla.org/extensions/contacts-and-feedback/email ）。

就我个人而言，我只会设置我的电子邮件程序（Outlook、Windows Live Mail、Thunderbird，...）来使用 pop 或 imap 拉邮件。这比使用任何网络邮件恕我直言要简单得多:)

# django - django 模型 - 管理员可以将变量添加到表中吗？

> ID：15581557
> 
> 赞同：1
> 
> 时间：2013-03-22T23:41:15.527
> 
> 标签：django, admin, models

我有一组人，我想为每个人关联一张带有个人信息的卡片和一个待办事项列表，这个列表没有固定大小（它可能有一个或多个字段），管理员是负责填写这份清单。

如何授予管理员权限以通过管理页面在这些卡片中添加额外字段（不是编码）？有可能还是我必须使用固定大小的列表？

```
class Admin(models.Model):
        first_name = models.CharField(max_length=50)
        last_name = models.CharField(max_length=50)
        birth_date = models.DateField(blank=True, null=True)
        address = models.CharField(max_length=100, blank=True, null=True)
        city = models.CharField(max_length=50, blank=True, null=True)
        phone_number = models.CharField(max_length=20, blank=True, null=True)
        email = models.EmailField(blank=True, null=True)

        def __unicode__(self):
            return u'%s %s' % (self.first_name, self.last_name)

class Person(models.Model):
    first_name = models.CharField(max_length=50)
    last_name = models.CharField(max_length=50)
    birth_date = models.DateField(blank=True, null=True)
    address = models.CharField(max_length=100, blank=True, null=True)
    city = models.CharField(max_length=50, blank=True, null=True)
    phone_number = models.CharField(max_length=20, blank=True, null=True)
    email = models.EmailField(blank=True, null=True)
    admin = models.ForeignKey(Admin, blank=True, null=True)

    def __unicode__(self):
        return u'%s %s' % (self.first_name, self.last_name)

class Card(models.Model):
    id_number = models.IntegerField(default=0)
    person = models.OneToOneField(Person, primary_key=True)

    def __unicode__(self):
        return unicode(self.id_number)  

class Things_to_do(models.Model):
    name = models.CharField(max_length=50)
    repetitions = models.IntegerField(default=0, blank=True, null=True)
    series = models.IntegerField(default=0, blank=True, null=True)
    executions = models.IntegerField(default=0, blank=True, null=True)
    rest_time = models.IntegerField(default=0, blank=True, null=True)
    card = models.ForeignKey(Card, blank=True, null=True)

    def __unicode__(self):
        return unicode(self.name) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T23:52:55.417

您可以尝试创建自定义 JSONField：[http ://djangosnippets.org/snippets/1478/](http://djangosnippets.org/snippets/1478/)

有了这样的东西，您将能够将所有字段存储为字典。试试看：[如何在 Django 数据库模型的字段中存储字典](https://stackoverflow.com/questions/9686409/how-to-store-a-dictionary-in-a-django-database-models-field)

# django - 在这种情况下主机标头中毒可能吗？

> ID：15581559
> 
> 赞同：2
> 
> 时间：2013-03-22T23:41:20.107
> 
> 标签：django, security, nginx, pyramid, webob

Django 团队将主机头中毒（CVE-2011-4139 和 CVE-2012-4520）视为必须在框架级别解决的安全问题。例如，金字塔（即其底层的低级请求包装器——webob）并不认为这是一个问题。

在生产和开发机器上，我有 nginx，`SERVER_NAME`即使`Host`标头包含完整的垃圾，它似乎也可以通过，并且如果没有匹配，则以[444 No response 响应](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#444)[`server_name`](http://nginx.org/en/docs/http/ngx_http_core_module.html#server_name)。

问题：如果我使用构建绝对 URL ，我是否应该担心`Host`这种情况下的标头中毒？`SERVER_NAME`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T14:06:22.493

如果您使用 nginx 清理 HTTP_HOST 和 SERVER_NAME 字段，那么您做的是正确的事情，无需担心 Host 标头中毒。

与 Django 一样，Pyramid 将其中很大一部分视为 WSGI 主机环境的任务。nginx 在清理 HTTP 请求信息方面做得非常出色，久经沙场。

# c# - 为 Visual Studio 2010 和 ASP.net 和 C# 生成 Excel 文件示例

> ID：15581562
> 
> 赞同：1
> 
> 时间：2013-03-22T23:41:58.313
> 
> 标签：c#, asp.net, excel

我遇到过[ExcelPackage](http://excelpackage.codeplex.com/)并找到了几个使用它的示例，但似乎没有一个有效，它们都有某些方面、缺少组件或适用于不同版本的 Visual Studio。我只需要生成一个`.xls`甚至`.xlsx`是一个`.csv`文件，但由于我使用的是第 3 方服务器，因此我无法使用 Office .com 对象。我过去使用过[SpreadsheetGear](http://www.spreadsheetgear.com/)，它很贵，而且我退休了，我买不起这种产品。

如果有人有 ExcelPackage 或任何其他免费软件产品的工作示例，或者可以指出我需要的一切，我将不胜感激。一个常规的 Web 应用程序而不是 MVC 将是首选。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:47:13.817

看看[Michael Stum](https://stackoverflow.com/users/91/michael-stum)的[Simplexcel](https://github.com/mstum/Simplexcel)。它是围绕简单而设计的，在 ASP.net 下得到完全支持，并且应该允许您制作简单但非常有用的 Excel 秘籍。[这里](https://github.com/mstum/Simplexcel/blob/master/src/Simplexcel.TestApp/Program.cs)有一个简单的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:09:54.897

查看[Open XML SDK](http://www.microsoft.com/en-us/download/details.aspx?id=5124)。这使您能够在不使用 Office 本身或互操作的情况下[生成](http://msdn.microsoft.com/en-us/library/dd440953%28v=office.12%29)和操作 Office 文档，因此使其成为服务器端的合适方法。

# requirejs - requirejs 加载脚本进度

> ID：15581563
> 
> 赞同：13
> 
> 时间：2013-03-22T23:42:03.297
> 
> 标签：requirejs

冒着问一个愚蠢问题的风险，我会试一试。

是否可以在 RequireJs 加载依赖项时显示进度指示器？

例如：

```
require(['jquery'], function($) {

    // Well, jQuery loaded in quite some time due to a low-speed connection
    //
    // Or maybe I wanted to show an overlay to prevent user of clicking on UI widgets until the load is complete
}); 
```

如果有一些插件没有出现在我的 Google 搜索中，我不想开始修改 RequireJS 源代码。

感谢你的帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-04-07T08:22:48.877

可以显示微调器或进度指示器，但不能显示栏本身。我可以获得 requirejs 的状态（当前正在加载或空闲），但不是加载/需要加载模块的百分比，因为它们的依赖关系在每个模块加载时都会被解析，但不是在开始时。

但是，无论如何，至少有一个简单的微调器的页面比用户等待时的空白页面要好得多。

无需更改requirejs！所以..

假设我们有文件 require.conf.js

```
require.config({...})
require(["app"], function () { 

// main entry point to your hugde app's code 
}); 
```

它是由html加载的

```
<script data-main="require.conf" type="text/javascript" src="bower_components/requirejs/require.js"></script> 
```

这是标准的 requirejs 场景。让我们将指标添加到

```
<div id="requirejs-loading-panel">
    <div id="requirejs-loading-status"></div>
    <div id="requirejs-loading-module-name"></div>
</div> 
```

好的，让我们赶上 requirejs 的 require.onResourceLoad 函数并完成所有需要的魔法。它将在每个模块加载时由 requirejs 调用，将 requirejs 的上下文与 dep 树和所有其他人员一起传递。我们将使用上下文来确定 requirejs 是否正在加载某些内容。我在预定的计时器调用中做到了，因为 onResourceLoad() 仅在加载时调用，而不是在加载完成时调用。这段代码需要添加到require.js.conf中：

```
require.onResourceLoad = function (context, map, depMaps) {

    var loadingStatusEl = document.getElementById('requirejs-loading-status'),
        loadingModuleNameEl = document.getElementById('requirejs-loading-module-name');
    var panel = document.getElementById('requirejs-loading-panel');

    if (loadingStatusEl && loadingModuleNameEl) {

        if (!context) { // we well call onResourceLoad(false) by ourselves when requirejs is not loading anything => hide the indicator and exit

            panel.style.display = "none";
            return;
        }

        panel.style.display = ""; // show indicator when any module is loaded and shedule requirejs status (loading/idle) check
        clearTimeout(panel.ttimer); 
        panel.ttimer = setTimeout(function () {

            var context = require.s.contexts._;
            var inited = true;
            for (name in context.registry) {
                var m = context.registry[name];

                if (m.inited !== true) {
                    inited = false;
                    break;
                }

            } // here the "inited" variable will be true, if requirejs is "idle", false if "loading"

            if (inited) {
                require.onResourceLoad(false);  // will fire if module loads in 400ms. TODO: reset this timer for slow module loading
            }

        }, 400)
        if (map && map.name) { // we will add one dot ('.') and a currently loaded module name to the indicator

            loadingStatusEl.innerHTML = loadingStatusEl.innerHTML += '.'; //add one more dot character
            loadingModuleNameEl.innerHTML = map.name + (map.url ? ' at ' + map.url : '');
        }
    } else {

    }

}; 
```

一个问题是：我们无法以某种方式确定需要加载多少模块，因此我们无法计算加载进度的实际百分比。但是，至少，我们可以找出我们是否正在加载某些东西（并且事件获取当前正在加载的模块名称）并将其展示给紧张的用户

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-01-04T16:15:30.417

从 v. 2.1.19 开始，RequireJS 具有`onNodeCreated`config 属性。如果您为其分配一个函数，则每次将`<script>`元素附加到文档以加载模块时都会调用该函数。

该函数将提供`node`、`config`、`moduleName`和`url`参数。通过将事件侦听器附加到`node`，您可以检测脚本何时加载或加载失败。

现在您可以检测加载过程何时开始和停止，并可以使用该信息通知用户：

```
require.config({
  /* ... paths, shims, etc. */
  onNodeCreated: function(node, config, moduleName, url) {
    console.log('module ' + moduleName + ' is about to be loaded');

    node.addEventListener('load', function() {
      console.log('module ' + moduleName + ' has been loaded');
    });

    node.addEventListener('error', function() {
      console.log('module ' + moduleName + ' could not be loaded');
    });
  },
}); 
```

对于 IE < 9，您需要附加代码来附加事件侦听器。

**注意：**这仅适用于 RequireJS 直接请求的模块。插件（requirejs/text 等）每个都使用自己的加载机制，并且不会触发`onNodeCreated`. 一些触发器`onXhr`，`onXhrComplete`虽然，所以你也可以处理它们：

```
require.config({
  /* ... paths, shims, etc. */
  config: {
    text: {
      onXhr: function(xhr, url) {
        console.log('file ' + url + ' is about to be loaded');
      },
      onXhrComplete: function(xhr, url) {
        console.log('file ' + url + ' has been loaded');
      }
    }
  }
}); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-24T15:45:14.993

不，这是不可能的。RequrieJs 通过在 DOM 中创建新的 script 标签来加载模块并监听 load 事件。在开始和结束加载之间没有更新事件。所以这不是 requireJs 的限制，而是 DOM 的限制。

# javascript - JavaScript 未显示在 HTML 页面上

> ID：15581564
> 
> 赞同：0
> 
> 时间：2013-03-22T23:42:18.737
> 
> 标签：javascript, html, calculator

我是编程新手，正在尝试制作一个简单的计算器。在编写了一些代码之后，我意识到我的 JavaScript 代码没有显示在我的 HTML 页面上。请告诉我发生了什么事。

这是我的 HTML 代码：

```
<!DOCTYPE html>
<html>
<head>
    <title>
        Simple GUI Calculator
    </title>
    <script src="Calculator.js"></script>
</head>
<body>

</body>
</html> 
```

这是我的 JavaScript 代码：

```
strokeWeight(1);

var x = 10;
var y = 140;
var xDiff = 113;
var yDiff =70;
var buttonSize = 40;

fill(95, 95, 95);
rect(1, 1, 398, 400);

fill(255, 255, 255);
rect(10, 10, 380, 100);

fill(5, 4, 4);

rect(x, y, buttonSize, buttonSize);
rect(x + xDiff, y, buttonSize, buttonSize);
rect(x + 2 * xDiff, y, buttonSize, buttonSize);
rect(x + 3 * xDiff, y, buttonSize, buttonSize);

rect(x, y + yDiff, buttonSize, buttonSize);
rect(x + xDiff, y + yDiff, buttonSize, buttonSize);
rect(x + 2 * xDiff, y + yDiff, buttonSize, buttonSize);
rect(x + 3 * xDiff, y + yDiff, buttonSize, buttonSize);

rect(x, y + 2 * yDiff, buttonSize, buttonSize);
rect(x + xDiff, y + 2 * yDiff, buttonSize, buttonSize);
rect(x + 2 * xDiff, y + 2 * yDiff, buttonSize, buttonSize);
rect(x + 3 * xDiff, y + 2 * yDiff, buttonSize, buttonSize);

rect(x, y + 3 * yDiff, buttonSize, buttonSize);
rect(x + xDiff, y + 3 * yDiff, buttonSize, buttonSize);
rect(x + 2 * xDiff, y + 3 * yDiff, buttonSize, buttonSize);
rect(x + 2 * xDiff + 90, y + 3 * yDiff, buttonSize + 23, buttonSize); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:47:03.490

您正在使用画布 API，但在 HTML 中没有任何画布。

在画布上尝试教程：[https](https://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial) ://developer.mozilla.org/en-US/docs/HTML/Canvas/Tutorial 。然后查看文档和库：[https](https://developer.mozilla.org/en-US/docs/HTML/Canvas) ://developer.mozilla.org/en-US/docs/HTML/Canvas 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:48:03.663

您使用的函数本身并不在 JavaScript 中。它们是 HTML 5 中画布对象的 JavaScript 属性和方法。您可以使用此链接了解如何访问画布对象并将您的代码用作应用于您将创建的画布对象的方法。[http://www.w3schools.com/html/html5_canvas.asp](http://www.w3schools.com/html/html5_canvas.asp)

# verilog - Verilog中的逻辑问题

> ID：15581568
> 
> 赞同：0
> 
> 时间：2013-03-22T23:42:38.973
> 
> 标签：verilog

我正在尝试根据设计编写乘数。它由两个 16 位输入组成，单个加法器用于计算部分乘积。一个输入的 LSB 与另一个输入的 16 位进行“与”运算，并且与门的输出重复地与前一个输出相加。它的 Verilog 代码如下，但我似乎无法让输出正常工作。

```
module datapath(output reg [31:15]p_high,
                output reg [14:0]p_low,
                input [15:0]x, y,
                input clk); // reset, start, x_ce, y_ce, y_load_en, p_reset, 
               //output done);

reg [15:0]q0;
reg [15:0]q1;
reg [15:0]and_output;
reg [16:0]sum, prev_sum; 
reg d_in;
reg [3:0] count_er;

initial
 begin
      count_er <= 0;
      sum <= 17'b0;
      prev_sum <= 17'b0;
 end

always@(posedge clk)
begin
        q0 <= y;
        q1 <= x;
        and_output <= q0[count_er] & q1;
        sum <= and_output + prev_sum;    
        prev_sum <= sum;
        p_high <= sum;
        d_in <= p_high[15];
        p_low[14] <= d_in;
        p_low <= p_low >> 1;
        count_er <= count_er + 1;
 end
 endmodule 
```

![在此处输入图像描述](../Images/ad37b9974dee78e6799b9d074ad0cc86.png) 我创建了一个测试台来测试电路，我看到的第一个问题是，AND 操作没有按我的意愿工作。x 操作数的 16 位与 y 操作数的 LSB 进行“与”运算。y 操作数在每个时钟周期后移动一位，并通过连续添加部分乘积来计算最终乘积。

但是，我从 sum 和 prev_sum 行开始遇到问题，它们的输出显示为 xxxxxxxxxxxx。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:43:18.927

您似乎没有正确重置您需要的所有信号，或者您似乎对非阻塞分配的工作方式感到困惑。

初始开始后：

*   `sum`是 0
*   `prev_sum`是 0
*   `and_output`是 X

在第一个上升沿之后：

*   `sum`是 X，因为`and_output`是 X，并且 X+0 返回 X。此时 sum 永远保持 X，因为 X + 某事始终是 X。

您正在为设计中的几乎每个信号创建一个寄存器，这意味着您的任何信号都不会立即更新。您需要区分要注册的信号和只是组合术语的信号。让寄存器用 上的非阻塞语句更新`posedge clock`，并通过将组合项放在一个`always @*`块中来让它们立即更新。

我不知道您要使用的算法，所以我不能说哪条线应该是哪条线，但我真的怀疑您是否打算让它花费一个时钟周期`x/y`传播到`q0/q1`，另一个周期传播`q`到传播到`and_output`，还有另一个时钟周期从传播`and_output`到总和。

* * *

对更新代码的评论：

*   组合块应该使用阻塞赋值，而不是非阻塞赋值。在 always @* 块内使用`=`而不是。`<=`
*   `sum <= and_output + sum;`看起来不对，应该是`sum = and_output + p_high[31:16]`根据你的图片。
*   您在这里分配 p_low[14] 两次。使第二条语句仅显式设置位 [13:0]：

    ```
    p_low[14]   <= d_in;
    p_low[13:0] <= p_low >> 1; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:01:22.620

您在同一个顺序`always`块中混合了阻塞和非阻塞分配，这可能会导致意外结果：

```
d_in <= p_high[15];
p_low[14] = d_in; 
```

# c++ - C++ 给出一个错误

> ID：15581569
> 
> 赞同：2
> 
> 时间：2013-03-22T23:42:53.713
> 
> 标签：c++

您好，我在这个程序中有一个错误，即 wcout 不是“std”的成员。我也使用了 iostream，但没有用。我有 Dev-C++ 4.9.9.2，我的操作系统是 XP SP3，我需要你的帮助。谢谢你的空闲时间。

```
#include <iostream>
#include <cstring>
#include <cwchar>
using namespace std;
const wchar_t alphabet[] ={'A', 'B', 'C', 'Ç', 'D', 'E', 'F', 'G', 'Ğ', 'H', 'I',
                        'İ', 'J', 'K', 'L', 'M', 'N', 'O', 'Ö', 'P', 'R', 'S',
                        'Ş', 'T', 'U', 'Ü', 'V', 'Y', 'Z', '0', '1', '2', '3',
                        '4', '5', '6', '7', '8', '9', '.', ',', ':', ';', ' '};
const int char_num =44;

void cipher(wchar_t word[], int count, int key)
{
    int i = 0;
    while(i < count) {
        int ind = -1;
        while(alphabet[++ind] != word[i]) ;
        ind += key;
        if(ind >= char_num)
            ind -= char_num;
        word[i] = alphabet[ind];
        ++i;
    }
}

void decipher(wchar_t word[], int count, int key)
{
    int i = 0;
        while(i < count) {
        int ind = -1;
        while(alphabet[++ind] != word[i]) ;
        ind -= key;
        if(ind < 0)
            ind += char_num;
        word[i] = alphabet[ind];
        ++i;
    }
}

int main()
{
    wchar_t text[] = L"ABJT;";
    int len = wcslen(text);
    std::wcout << text << std::endl;
    cipher(text, len, 2);
    std::wcout << text << std::endl;
    decipher(text, len, 2);
    std::wcout << text << std::endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-22T23:44:50.997

如果您使用 MinGW 进行编译，[则尚不支持宽字符](http://www.mingw.org/wiki/wide_characters)。如果您真的需要它，另一种方法是使用[STLPort](http://www.stlport.org/)库作为 libstdc++ 的替代方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:29:39.607

您正在使用的 Dev-C++ 4.9.9.2 附带[7 年以上](http://gcc.gnu.org/releases.html)的 MinGW-gcc 3.4.2 ，可能没有 sftrabbit 建议的正确支持的宽字符。

[如果您查看 sourceforge 上原始Dev-C++](http://sourceforge.net/projects/dev-cpp/)的顶部，您会发现它已被[Orwell Dev-C++](http://sourceforge.net/projects/orwelldevcpp)取代。如果您需要宽字符支持，我建议您使用它，因为它包含更新版本的 MinGW-gcc。

# sql - 从动态 sql 中删除引号时遇到问题

> ID：15581573
> 
> 赞同：-4
> 
> 时间：2013-03-22T23:44:01.977
> 
> 标签：sql, sql-server, sql-server-2008

我想从这个动态 sql 中删除引号，所以它只是一个脚本。

```
set @sqlDNB= '
 SELECT DISTINCT
                   Null CustomerID
                   ,EntityID MCVID
                   ,business_name CustomerName
                   ,physical_City +  ',' + physical_state +  '' + cast(physical_zip as varchar(7)) Address
                   ,'' RM
                   ,'' SubGroup
                   ,'' HierarchyType
                   ,'' status 
                   ,DNB.dunsnum DunsNumber
                   ,'DNB' Source
              from SOR.T_DunAndBradstreet DNB with (nolock)
              left outer join SOR.T_McvDuns MCVDUNS with (nolock)
              on DNB.dunsnum  = MCVDUNS.DunsNumber
                +
 case
 when @p_SearchMethod ='BeginsWith' and @p_CustomerName !='' then 'and business_name like ''' + @p_CustomerName + ''' '
 when @p_SearchMethod ='Contains' and @p_CustomerName !=''  then 'and Contains (business_name,''"' + @p_CustomerName + '"'')'
 when @p_SearchMethod ='Exact' and @p_CustomerName !=''  then  'and business_name =''' + @p_CustomerName + ''' ' 
 else
 ''
end 

+ ' where not exists 
(select dunsnumber from sor.T_Customer customer where customer.DUNSnumber = DNB.dunsnum '
+  
case
 when @p_SearchMethod ='BeginsWith' and @p_CustomerName !='' then 'and customer.Name like ''' + @p_CustomerName + ''' '
 when @p_SearchMethod ='Contains' and @p_CustomerName !=''  then 'and Contains (customer.Name,''"' + @p_CustomerName + '"'')'
 when @p_SearchMethod ='Exact' and @p_CustomerName !=''  then  'and customer.Name =''' + @p_CustomerName + ''' ' 
 else
 ''
end 

if @p_TIN_SSN !='' 
begin
set  @sqlDNB =  @sqlDNB + ' and customer.TINorSSN =''' + @p_TIN_SSN + ''' ' 
end
if  @p_CustomerID !='' 
begin
set  @sqlDNB =  @sqlDNB + ' and customer.[MCVID] =''' + cast(@p_CustomerID as varchar(20)) + '''  '  
end 
set  @sqlDNB =  @sqlDNB + ')' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:54:35.253

从以下代码中删除任何单引号将导致错误：

```
'and business_name like ''' + @p_CustomerName + ''' ' 
```

当您`''`在 SQL 中看到字符串内部时，它表示单个`'`. 例如

```
declare @test varchar(12)
set @test = 'don''t'
select @test 
```

将返回`don't`。

因此，从您提到的代码块中删除任何单引号将使您`like`中断。

希望这是有道理的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:00:25.243

在 SQL Server Management Studio 中“调试”此类脚本的便捷方法如下：

```
DECLARE @sqlDNB nvarchar(max);

set @sqlDNB = <your script here>;

PRINT @sqlDNB; 
```

如果您运行此程序，您将收到可用于修改脚本的特定错误消息。最后，打印的字符串是 SQL 脚本，您也可以复制和测试它。

# ruby - ruby 未定义方法错误 p= 方法不退出

> ID：15581578
> 
> 赞同：3
> 
> 时间：2013-03-22T23:44:33.893
> 
> 标签：ruby

以下是 ruby​​ 中的 Circular double LL 实现。我对 ruby​​ 很陌生（不到几天），所以我为 node.js 做了一个复杂的结构。删除线

```
temp.n.p=temp2 
```

使错误消失，否则会遇到以下错误：-

```
/home/ghost/Desktop/ruby/ds/test.rb:40:in `insert': undefined method `p=' for #<Cdll:0x000000022bfde8> (NoMethodError)
    from /home/ghost/Desktop/ruby/ds/test.rb:60:in `<main>' 
```

这是整个代码：-

```
class Node
    def initialize(a,b,c)
        @data=a
        @next=b
        @prev=c
    end
    def d=(ele)
        @data=ele
    end
    def n=(ele)
        @next=ele
    end
    def p=(ele)
        @prev=ele
    end
    def d
        @data
    end
    def p
        @prev
    end
    def n
        @next
    end

end

class Cdll
    def initialize
        @sentinel=Node.new(nil,self,self)
    end

    def insert(ele)
        temp=@sentinel
        while temp.d!=nil
            temp=temp.n
        end
            temp2=Node.new(ele,temp,temp.n)
            temp.n .p=temp2
            temp.n=temp2
    end

    def search(ele)
        temp=@sentinel.n
        while temp.d!=nil
            if(temp.d==ele)
                return temp
            else
                temp=temp.n
            end
        end
        return nil
    end
end

c=Cdll.new
c.insert(12)
c.insert(14)
if((x=c.search(14))!=nil)
    puts x.d
end 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:37:10.570

看Cdll插入方法。

```
 def insert(ele)
   temp=@sentinel
   # @sentinel.n == self 
   # => true
   while temp.d!=nil
     temp=temp.n
   end
   temp2=Node.new(ele,temp,temp.n)
   # temp.n == self
   # => true
   temp.n.p=temp2
   temp.n=temp2
 end 
```

当您创建 Cdll 类的新实例时 - 您还创建了 Node 的实例，其中上一个和下一个元素是 Cdll 的实例（不是 Node，其中`p=`存在方法）。

我认为它实际上不是双链表。也许节点中的 prev 和 next 元素也应该是一个`Node`实例

# c++ - 如何禁用 DEP

> ID：15581581
> 
> 赞同：4
> 
> 时间：2013-03-22T23:44:56.170
> 
> 标签：c++, winapi, dep

我们有一个应用程序，其中堆的某些部分作为汇编指令执行/用于测试目的 - 我们将程序下载到 PLC，但允许用户通过在下载到 PLC 之前执行他们的代码来模拟运行他们的应用程序。在我们总是从存储指令的堆中执行这些程序并且这工作正常之前，但我们现在已经转换为 VS2012，现在看来关闭 DEP 并不那么容易。我想知道是否有可能以某种方式关闭 DEP 而不管`GetProcessDEPPolicy`返回什么，或者是否有其他技术可以在不涉及 DEP 的情况下从堆中执行汇编指令？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T23:54:23.240

您不想禁用 DEP；您想修改您的应用程序以在其中工作。

根据[http://msdn.microsoft.com/en-us/library/windows/desktop/aa366553%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa366553%28v=vs.85%29.aspx)

```
If your application must run code from a memory page, it must allocate and set the proper
virtual memory protection attributes. The allocated memory must be marked PAGE_EXECUTE,
PAGE_EXECUTE_READ, PAGE_EXECUTE_READWRITE, or PAGE_EXECUTE_WRITECOPY when allocating memory. 
```

遵循这些简单的指示，您的代码可以与 DEP 共存。

# java - 基于 Java 正则表达式的字符串替换

> ID：15581582
> 
> 赞同：1
> 
> 时间：2013-03-22T23:44:58.673
> 
> 标签：java, xml, regex, groovy

在以下用例中寻找基于正则表达式的 Java 字符串替换。我正在做一些基于 Groovy 的 XML 处理，并且由于一些自定义处理（不会对此进行详细说明），生成的 XML 有一些无效标签，例如

```
<?xml version='1.0' encoding='UTF-8'?>
<Customer id="xyz" xmlns='http://abc.com'>
<order orderGroup="mock">
    <entry>
        <key>test</key>
    </entry>
</order orderGroup="mock">
</Customer id="xyz"> 
```

如果您注意到，包含属性的元素名称的结束标签是混乱的。XML 只是被视为一个字符串，所以我想要做的是，只需通过基于字符串正则表达式的替换来替换此类结束标记的出现。例如替换

```
</order orderGroup="mock"> with </order>, 
</Customer id="xyz"> with </Customer> 
```

知道是否可以使用基于 Java 字符串的快速正则表达式来进行此类替换吗？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T00:15:47.317

尝试

```
 xml = xml.replaceAll("</([^ >]+).*?>", "</$1>"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T23:54:56.680

最简单的解决方案是修复您的自定义 XML 处理并让它生成**有效**的XML。

简单的解决方案是使用[JTidy](http://jtidy.sourceforge.net/)之类的东西来清理您的 XML。

如果你必须使用正则表达式，你可以尝试这样的事情：

```
Pattern pattern = Pattern.compile("</([A-Za-z]+) [^>]+>");
Matcher matcher = pattern.matcher(xml);

if(matcher.find()) {
   xml = matcher.replaceAll(matcher.group(1));
} 
```

我还没有测试过，所以请记住这一点。可能有几个问题。

正则表达式的解释：

```
<         -> The opening angle bracket of the tag
/         -> The / that marks a closing tag
(         -> Start of a capturing group. We want to capture the actual ending tag.
[A-Za-z]+ -> One or more alphabetic characters (upper and lowercase)
)         -> End of the capturing group.
          -> A space.
[^>]+     -> One or more of anything that is not a closing angle-bracket.
>         -> The closing angle bracket of the tag. 
```

# r - 如何减小 rgl postscript 的文件大小？

> ID：15581583
> 
> 赞同：2
> 
> 时间：2013-03-22T23:45:00.870
> 
> 标签：r, rgl

我绘制了一个 3d 曲面`rgl`，我想使用它保存为 pdf。尽管情节相当简单，但文件大小接近 1Mb。

```
require(rgl)

f <- function(x,y) {
    d <- 3 * sqrt(x*x + y*y)
    exp(-0.02 * d^2) * sin(d)
}

x <- y <- seq(-pi, pi, length=50)
Grid <- expand.grid(x=x, y=y)
z <- matrix(f(Grid$x, Grid$y), length(x), length(y))

rgl.open()
rgl.viewpoint(phi=-60, theta=0, fov=30, zoom=.8)
surface3d(x, y, z, color="black", front="lines", lit=FALSE)
rgl.bg(color="white")

Sys.sleep(1) #to give rgl some time to render
rgl.postscript("surface.pdf", fmt="pdf") 
Sys.sleep(1)
print(file.info("surface.pdf")$size)
# 880K 
```

设置`lit=FALSE`已经大大减少了文件大小。

我还能如何减小这个数字的大小？

谢谢！

（因为我想在情节中添加更多元素，`lattice::wireframe`所以不是一个选项。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T13:29:02.457

一般来说，我也更喜欢矢量图形，但这里的情况是 rgl 渲染场景。这意味着 pdf 由许多小块组成 - 这就是文件大小快速增长的原因。事实上，您的 pdf 由许多细小的直线组成。`lit = FALSE`意味着这些线条不会被分割成更细的不同颜色的线条。

这些片段在更高放大倍率的 pdf 中也可见，因此我经常在这种情况下使用位图图形（特别是在渲染表面的情况下）。为了获得体面的分辨率，我`rgl.snapshot`打开了一个大窗口。不完美，但对我来说是一个可行的折衷方案（我使用“3d”图形的快照而不是作为引人注目的或概述信息，而不是作为定量可视化）。

* * *

检查 pdf，我发现每行有 2 个副本，可能一个用于正面，一个用于背面，或者来自每个相邻的多边形。使用“相邻多边形”方向上的点`front`和`back`参数进行一些操作。`surface3d`

# apple-push-notifications - 什么情况会导致此存折错误？

> ID：15581586
> 
> 赞同：1
> 
> 时间：2013-03-22T23:45:10.640
> 
> 标签：apple-push-notifications, passbook

我该如何解决？

```
Passbook error [2013-03-22 11:10:28 -0700] 
Web service error for pass.com.example.purchase (https://www.example.com/): 
Server requested update to serial number '12345', but the pass was unchanged. 
```

对于未更改的通行证，上述错误每天会出现数次。有些通行证是几个月前的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T03:27:28.580

当从设备调用以下内容时会发生此错误：

`webServiceURL/version/devices/deviceLibraryIdentifier/registrations/passTypeIdentifier?passesUpdatedSince=tag`,

返回一个或多个序列号，并且您的 Web 服务将`302`响应（或`200`响应但传递相同的 .pkpass 包）返回到后续调用：

`webServiceURL/version/passes/passTypeIdentifier/serialNumber`

在`200`响应的情况下，您将收到第二条错误消息，警告您的 Web 服务忽略了最后修改的标头并返回了完整的未更改的传递数据。

通常，设备会在推送请求之后请求更新的序列号。在这种情况下，您的通行证通常已更改并且不会触发警报。

但是，Passbook 还会在重新启动后立即调用更新序列，因此由于最近的 6.1.3 iOS 更新，您可能会看到一波这样的消息，因为新安装的 Passbook 库会调用您的服务以查看是否有可用的更新它继承的旧通行证。

另外值得注意的是，Passbook 要求更新连续剧`passTypeIdentifier`。如果您正在发出一个单通道的推送请求，但该设备包含具有相同的其他通道`passTypeIdentifier`，您的 Web 服务可能会无意中响应这些旧通道的序列号。

要修复它，您应该查看处理“获取序列号”调用的逻辑，以确保不会返回任何序列号来`302`响应“获取最新版本的通行证”调用。

此错误的主要目的是最大限度地提高设备上的缓存效率，并保护人们的数据计划免受不必要的通行证下载（因为 .pkpass 包通常超过 500kb）。

# php - 如何构建一个函数以使用 PHP 连接到 PDO 并运行查询？

> ID：15581592
> 
> 赞同：1
> 
> 时间：2013-03-22T23:45:51.937
> 
> 标签：php, mysql, pdo

我正在尝试编写几个函数，以便以后可以使用它们使用 PDO 对象连接到数据库。我已经完成了一项返回数据，一项获取计数，另一项进行插入。

我的问题是，当出现异常时，它们中的任何一个都不会返回异常。而且我不确定我需要在哪里添加一行来释放结果表单内存？

这是我目前的功能

```
function getDataSet($query, $connection){

    $cmd = $connection->query( $query );
    return $cmd->fetchAll(PDO::FETCH_ASSOC);

}

function getResultsCount($query, $connection){

    $cmd = $connection->query( $query );
    return $cmd->fetchColumn();

}

function insertRecord($query, $connection){

    $cmd = $connection->query( $query );
    $connection->free();
    return $cmd;

} 
```

这就是我在应用程序中使用这些功能的方式

```
 try {
        $data = getDataSet(' SELECT name FROM TABLE LIMIT 1000', $db);

            foreach($data AS $row){
                echo $row[0]['name'] . '<br />';
            }

        }  catch(PDOException $e){
            echo 'an error encountered'. $e->getMessage();
        }
unset($data); 
```

我的问题的总结如何在它们返回后让这些函数释放结果？曾经存在时如何返回异常？我可以使用更好的功能吗？是否有处理准备语句并返回结果的函数？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T12:38:49.027

看到这么好的编程问题总是很高兴。不过是少见的。

你有一个很好的目标来编写所有这些函数，尽管有一个重大错误。您将它们用作单独的功能，这没有太大意义。所有这些函数都必须是数据库类的方法，使用内部类资源。

尽管您可以从[标签 wiki 获得大部分答案，](https://stackoverflow.com/tags/pdo/info)但似乎该站点从未将访问者引导至此知识缓存，鼓励他们提出新问题而不是阅读已经写好的答案。所以，给你：

> 曾经存在时如何返回异常？

要使 PDO trow 异常，您必须设置相应的选项：

```
$dsn = "mysql:host=localhost;dbname=test;charset=utf8";
$opt = array(
    PDO::ATTR_ERRMODE            => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC
);
$pdo = new PDO($dsn,'root','', $opt); 
```

以这种方式实例化 PDO 将开始在 mysql 错误上引发异常。

> 是否有处理准备语句并返回结果的函数？

就写吧。
为什么不想在函数中使用准备/执行？这是一个（作为类方法，而不是单独的函数）：

```
function getDataSet($query,$data = NULL)
{
    $cmd = $this->conn->prepare( $query );
    $cmd-> execute($data);
    return $cmd->fetchAll();
} 
```

现在您将能够使用参数化查询以及非参数化查询：

```
$data = $db->getDataSet('SELECT name FROM TABLE LIMIT 1000');
$data = $db->getDataSet('SELECT name FROM table WHERE id < ? LIMIT 1000',array($id));
foreach($data AS $row){
    echo $row['name'] . '<br />';
} 
```

（请注意，您不应该只使用 try-catch 来回显错误消息 - PHP 已经这样做了，而且方法要好得多）

> 我需要在哪里添加一行来释放结果表单内存？

我根本不会打扰。它们将被自动清除。

> 函数 getResultsCount($query, $connection){

事实上，这个函数可以做的不仅仅是返回一个计数。它实际上可以返回查询返回的*任何*标量值。所以，最好叫它`getOneResult`或类似的东西：

```
$name = $db->getDataSet('SELECT name FROM table WHERE id=?',array($id)); 
```

> 函数插入记录（$查询，$连接）{

这个函数又被错误地命名了。事实上，它必须只是通用`query()`函数，可以用于运行 INSERT、UPDATE、DELETE 或任何其他查询。

> 我可以使用更好的功能吗？

好吧，毫无疑问，我认为[我自己](https://github.com/colshrapnel/safemysql)为此目的编写的课程更好:)
您可以按原样自由使用它，或者只是为您自己的课程获得一些想法。

# ruby-on-rails - Ruby 正则表达式 - 数组

> ID：15581597
> 
> 赞同：0
> 
> 时间：2013-03-22T23:46:36.570
> 
> 标签：ruby-on-rails, ruby, regex, arrays, ruby-on-rails-3

我有一个看起来像这样的二维 ruby​​ 数组：

```
(Array) - @main.each do |value| 

value[0]    value[1]   value[2]

3.0.1.2     TOTAL      Pass
3.0.1.3     TOTAL      Pass
3.4.0.1     8K         Fail
3.5.4.3     9K         Fail
3.5.0.9     TOTAL      Fail 
```

我想将它们分成 2 个数组，这样第一个数组的所有行都应该是“TOTAL”，而另一个数组应该有其他的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T06:04:41.963

```
@main = [
  %w[3.0.1.2     TOTAL      Pass],
  %w[3.0.1.3     TOTAL      Pass],
  %w[3.4.0.1     8K         Fail],
  %w[3.5.4.3     9K         Fail],
  %w[3.5.0.9     TOTAL      Fail],
]

totals, others = @main.partition{|a| a[1] == 'TOTAL'}

# totals => [["3.0.1.2", "TOTAL", "Pass"], ["3.0.1.3", "TOTAL", "Pass"], ["3.5.0.9", "TOTAL", "Fail"]]
# others => [["3.4.0.1", "8K", "Fail"], ["3.5.4.3", "9K", "Fail"]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:16:07.303

我不太了解您的数组的字段是什么，但您可以使用选择和拒绝：

```
totals = @main.select{|entry| entry == "TOTAL"}
others = @main.reject{|entry| entry == "TOTAL"} 
```

对于您对每个元素进行的任何测试。原始的@main 将保持原样，您可以使用总计和其他来访问元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T00:19:21.450

您的问题没有得到很好的解释，但作为您想要的快速猜测，我建议您查看[`Array.group_by`](http://ruby-doc.org/core-2.0/Enumerable.html#method-i-group_by)，这是 Enumerable 的一部分：

```
ary = [
  %w[3.0.1.2     TOTAL      Pass],
  %w[3.0.1.3     TOTAL      Pass],
  %w[3.4.0.1     8K         Fail],
  %w[3.5.4.3     9K         Fail],
  %w[3.5.0.9     TOTAL      Fail],
]

ary.group_by{ |a| a.last } 
```

它返回一个哈希，键是子数组中最后一个元素的两个不同值：

```
{
    "Pass" => [
        [0] [
            [0] "3.0.1.2",
            [1] "TOTAL",
            [2] "Pass"
        ],
        [1] [
            [0] "3.0.1.3",
            [1] "TOTAL",
            [2] "Pass"
        ]
    ],
    "Fail" => [
        [0] [
            [0] "3.4.0.1",
            [1] "8K",
            [2] "Fail"
        ],
        [1] [
            [0] "3.5.4.3",
            [1] "9K",
            [2] "Fail"
        ],
        [2] [
            [0] "3.5.0.9",
            [1] "TOTAL",
            [2] "Fail"
        ]
    ]
} 
```

访问其中一个很容易：

```
ary.group_by{ |a| a.last }['Pass']
[
    [0] [
        [0] "3.0.1.2",
        [1] "TOTAL",
        [2] "Pass"
    ],
    [1] [
        [0] "3.0.1.3",
        [1] "TOTAL",
        [2] "Pass"
    ]
] 
```

或者：

```
ary.group_by{ |a| a.last }['Fail']
[
    [0] [
        [0] "3.4.0.1",
        [1] "8K",
        [2] "Fail"
    ],
    [1] [
        [0] "3.5.4.3",
        [1] "9K",
        [2] "Fail"
    ],
    [2] [
        [0] "3.5.0.9",
        [1] "TOTAL",
        [2] "Fail"
    ]
] 
```

# ios - 在 alloc 和 init 上保留计数

> ID：15581598
> 
> 赞同：2
> 
> 时间：2013-03-22T23:46:43.790
> 
> 标签：ios, objective-c, cocoa-touch, automatic-ref-counting

一些网站是这样说的：

```
@property (nonatomic, strong) MyObject *foo;

self.foo = [[MyObject alloc] init]; 
```

将保留计数增加到 2

但是自从最新的 xcode 版本或 ARC 以来，这应该不是问题吧？

根据视频我们可以取出所有自动释放

所以从这里：

```
@property (nonatomic, strong) MyObject *foo;

self.foo = [[[MyObject alloc] init] autorelease]; 
```

变成了这个

```
@property (nonatomic, strong) MyObject *foo;

self.foo = [[MyObject alloc] init]; 
```

那么我应该忽略那个说将`self.foo = [[MyObject alloc] init];`保留计数增加到 2 的网站吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:55:26.203

如果没有 ARC，您可能应该使用`retain`（和相应地`assign`）而不是`strong`（和`weak`）。在您的第一个示例中，没有 ARC，该`- init`方法返回一个保留计数为 1 的对象，并且该`foo`属性的设置器将保留计数增加到 2。

在您的第二个示例中（必须没有 ARC，因为 ARC`autorelease`不可用），`- autorelease`调用将对象添加到自动释放池并将其保留计数减少 1，因此对象最终保留计数为 1（对于财产）。

使用 ARC，就像在您的第三个示例中一样，您根本不需要担心保留计数——这就是 ARC 的重点。在幕后，`- init`应该仍然返回一个保留计数为 1 的对象，并且 setter`foo`应该仍然增加保留计数，但是编译器应该在`- release`调用 setter 之后的某处插入。基本上，使用 ARC，因为属性是`strong`，一旦将对象分配给属性，您就可以依赖该对象继续存在，而不必考虑`retain`// `release`。`autorelease`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T23:50:42.097

ARC 使这种说法不真实。自动释放并没有消失，它只是现在由编译器插入，你看不到它。

# android - Phonegap - 支持多种分辨率的最佳方式

> ID：15581603
> 
> 赞同：3
> 
> 时间：2013-03-22T23:47:40.907
> 
> 标签：android, css, cordova

我正在使用 PhoneGap 创建一个应用程序，并希望针对多个 Android 设备。
问题是在文档中我看到有很多方法可以做到这一点，我想知道正确的方法。

在 Android 文档中，我看到我可以为每个屏幕密度使用不同的 CSS，但是我需要为我所做的每个应用程序创建 4 个 CSS。 [http://developer.android.com/guide/webapps/targeting.html](http://developer.android.com/guide/webapps/targeting.html)

在谷歌上我发现我应该使用响应式布局，但一位朋友告诉我这不是正确的做法。

在 PhoneGap 中创建应用程序而不创建许多不必要的 CSS 文件的最佳方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T02:40:59.330

由于您使用的是 Phonegap，我会使用移动框架，如 jQuery Mobile、Sencha Touch 等。这些框架会为您处理这个问题，并启用响应式布局。你朋友的意见似乎有点没有根据。我正在使用 jQuery Mobile，它适用于我测试过的所有移动设备：Galaxy Nexus、iPod touch、iPad 和 Kindle。我的应用程序非常庞大和复杂，在我的代码中，我没有根据屏幕大小进行曲折或曲折。我有一个 CSS 文件，它也支持多个主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T23:54:30.873

我绝对推荐创建一个响应式布局。使用移动优先技术来定位最小的屏幕尺寸，然后使用媒体查询来定位更大的屏幕尺寸。每部手机的行为都略有不同，预计会有一些差异。

# paypal - Safari 嵌入式贝宝失败 - 拒绝显示文档，因为 X-Frame-Options 禁止显示

> ID：15581604
> 
> 赞同：3
> 
> 时间：2013-03-22T23:47:43.600
> 
> 标签：paypal, payment

我刚刚发现我的嵌入式支付实现在 Safari 中不起作用。对于 Safari，我在控制台中收到此错误：拒绝显示文档，因为 X-Frame-Options 禁止显示

我找不到解决此问题的方法。

请注意，该实现在 IE、FF 和 Chrome 中运行良好（嗯，FF 存在差异问题，但这部分似乎可行）。

以下是电话（为清楚起见进行了编辑）：

```
var urlBase = "https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/pay";
var payKey = "AP-12345ABCDE6789012";
flow_Javascript = new PAYPAL.apps.DGFlow( { trigger:null, expType:"light" } );
flow_Javascript.startFlow( urlBase + "?payKey=" + payKey ); 
```

仅供参考，这是在控制台中返回的：

> [加载“ https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/expresscheckoutincontextremembermeflow?execution=e1s1](https://www.sandbox.paypal.com/webapps/adaptivepayment/flow/expresscheckoutincontextremembermeflow?execution=e1s1) ”时遇到无效的“X-Frame-Options”标头：“NONE”不是公认的指令。标题将被忽略。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T18:45:10.850

我遇到了同样的问题，添加 try/catch 块有帮助：

```
try { 
  flow_Javascript.startFlow( urlBase + "?payKey=" + payKey );
} catch (err) {
  // add some error logging here
} 
```

# excel - Excel 函数 - 如果没有结果，则将单元格设为“0”

> ID：15581613
> 
> 赞同：0
> 
> 时间：2013-03-22T23:49:19.187
> 
> 标签：excel, excel-2007

如果没有结果，如何编辑此数组函数以使结果显示 0 而不是 #N/A？我尝试过使用 IF 语句，但无法让它工作......

```
=INDEX(INDIRECT("'"&I18&"'!$h$1:$h$999"),MATCH(1,(INDIRECT("'"&I18&"'!$a$1:$a$999")="Last 20 Games by Venue")*(INDIRECT("'"&I18&"'!$b$1:$b$999")=O18),0)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:52:57.840

在 Excel 2007 中，您可以在公式周围包裹一个 IFERROR 函数 - 语法是

`=IFERROR(original_formula,default_result)`

所以要获得零而不是#N/A，请使用此版本

`=IFERROR(INDEX(INDIRECT("'"&I18&"'!$h$1:$h$999"),MATCH(1,(INDIRECT("'"&I18&"'!$a$1:$a$999")="Last 20 Games by Venue")*(INDIRECT("'"&I18&"'!$b$1:$b$999")=O18),0)),0)`

# php - Linux 服务器上的 PHP - 如何验证电子邮件地址是否真实

> ID：15581614
> 
> 赞同：3
> 
> 时间：2013-03-22T23:49:20.317
> 
> 标签：php, linux, shell, telnet

我在 Linux 服务器上有一个 PHP 脚本，需要确定电子邮件地址是真实的还是虚假的。

我正在尝试为此使用 telnet，从期望脚本启动，但它不起作用。

PHP 脚本的用法是：

```
$retVal = shell_exec( "./atelnet.sh mailserver.net fake@example.com" ) ; 
```

任何帮助将不胜感激，或者完全是更好的方法。

谢谢你。

这是我到目前为止所拥有的：

```
#!/usr/bin/expect
#
# name: atelnet.sh
# usage from php: 
# $retVal = shell_exec( "./atelnet.sh mailserver.net fake@example.com" ) ;
#
# if goes wrong, the script will timeout in 20 seconds
set timeout 20

# first argument assigned to the variable "server"
set server [lindex $argv 0]

# second argument assigned to the variable "emailaddress"
set emailaddress [lindex $argv 1]

# spawn telnet and connect to variable "server" on port 25
spawn telnet $server 25

# script expects "220 ..." telnet from server, telnet login ok response
# actual response looks like: 
# "220 mx.server.com ESMTP ni10si2925797obc.73 - gsmtp"
# or
# "220-host.server.com ESMTP Fri, 22 Mar 2013 01:48:03 -0000"
expect "220"

# script sends initial handshake greeting
send "HELO"

# script expects "250 ..." telnet from server, at-your-service ok response
# actual response looks like: 
# "250 mx.server.com at your service"
# or
# "250 host.server.com Hello host.server.com [111.222.333.444]"
expect "250"

# script sends from: email address (any address is fine)
send "mail from:<a@b.com>"

# script expects "250 ..." telnet from server, ok acknowledgement of from:email
# actual response looks like: 
# "250 2.1.0 OK v16si1294229qct.125 - gsmtp"
# or
# "250 OK"
expect "250"

# script sends query to the email address being tested
# PHP string cat syntax doesn't work !!!
# HOW ???
send "rcpt to:<" . $emailaddress . ">"

# script expects one of these:
# fake: "550-5.1.1 The email account that you tried to reach does not exist."
# or
# true: "250 Accepted"

# log server's response to file. HOW ??? 
```

编辑：

我在我的 PHP 套接字代码下面添加，这似乎不起作用：

```
$smtp_server = fsockopen( $mx_hostname, 25, $errno, $errstr, 30 ) ;
$ret1 = fwrite( $smtp_server, "helo hi\r\n" ) ;
$ret2 = fwrite( $smtp_server, "mail from: <a@b.org>\r\n" ) ;
$ret3 = fwrite( $smtp_server, "rcpt to: <" . $unk_email_address. ">\r\n" ) ; 
```

对此代码的任何想法也将受到欢迎。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T23:59:24.220

我可以看到预期的用法，但我会说实际连接并启动与收件人邮件服务器的握手有点过头了。特别是因为仍然不能保证这意味着用户存在。

您应该在此阶段之前检查 MX 记录，请参阅[getmxrr](http://php.net/manual/en/function.getmxrr.php)
假设您已经检查过，已将其验证为有效的电子邮件字符串，我会说将其与额外的 MX 查找相结合就足够了。

如果你仍然想这样做，我会使用 PHP 套接字而不是 telnet 来实现它。甚至可能使用[expect 扩展](http://www.php.net/manual/en/book.expect.php)，因为您已经开始了该路径。

如果与更高质量的用户注册相关，其他想法可能是让 Facebook 和 Google oauth 在您的网站上登录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:55:50.163

试图发明轮子是没有意义的。

检查例如：[Zend_Validate_EmailAddress](http://framework.zend.com/manual/1.12/en/zend.validate.set.html#zend.validate.set.email_address)

您甚至可以验证主机名和 mx 记录

```
$validator = new Zend_Validate_EmailAddress(
    array(
        'allow' => Zend_Validate_Hostname::ALLOW_DNS,
        'mx'    => true
    )
); 
```

通过验证现有的域和电子邮件地址格式，我会说它应该足够了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T00:00:25.180

您可以使用 PHP 过滤器来验证电子邮件：

[http://php.net/manual/en/filter.filters.validate.php](http://php.net/manual/en/filter.filters.validate.php)

```
$email_a = 'user@example.com';

if (filter_var($email_a, FILTER_VALIDATE_EMAIL)) {
    echo "This (email_a) email address is considered valid.";
} 
```

# css - 有iOS模拟器吗？

> ID：15581619
> 
> 赞同：1
> 
> 时间：2013-03-22T23:49:54.133
> 
> 标签：css, mobile, web

我搜索了一个简单的 iOS 模拟器，它能够解析元标记“media=only...”以呈现基于 CSS 的媒体查询。（我不是在寻找像 xCode 这样的完整应用程序开发程序）我尝试过的“模拟器”似乎只不过是对 URL 可能看起来像显示在 a移动设备宽度（480 像素）。

我听说 xCode 可以用作模拟器，但它的下载量为 1.6 GB，我必须将自己注册为 Apple 的应用程序开发人员（这根本不是问题，但对于我的基本需求来说似乎有点过于奢侈 - 比如使用火箭筒杀死一只苍蝇）。

我想在移动设备上使用媒体查询而不是 jQuery，但似乎这个 CSS3 标记与任何浏览器都不兼容。目前我不得不在我的实际 iPhone 上测试我的工作。显然，这是一个精确的“真实世界”渲染——这很棒，但相当耗时（FTP 你的更改只是为了看到最小的样式更改——这不是 PHP，我不应该这样做！）

我会很感激一些意见！多谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T23:52:21.397

Xcode 很好。如果您想将应用程序部署到 iDevice，您只需注册。您可以从 App Store 免费下载 Xcode，并在包含的 iOS 模拟器中运行 Safari 并测试您想要的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T23:55:28.053

如果您的开发机器在本地网络上并且它正在运行服务器，请通过终端类型的 IP 地址将 iPhone 上的 safari 指向它：

如果配置

获取你的ip。

或者，您可以使用 xCode - 据我所知，您不必注册为应用程序开发人员。

或使用[http://www.Browserstack.com之类的服务](http://www.Browserstack.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T23:56:00.330

如果您不想安装 Xcode，请查看[browserstack.com](http://www.browserstack.com)

# c++ - 使用 stringstream 将动态大小的字符串转换为整数

> ID：15581621
> 
> 赞同：0
> 
> 时间：2013-03-22T23:50:09.627
> 
> 标签：c++, gcc, std

我正在尝试通过使用 stringstream 转换用户给定的字符串来将 int 值添加到向量中。用户给出这样的数据：1,5,6,7,4 所以我永远不会知道究竟会有多少 int 。

现在我只得到第一个输入的数字。其余的被忽略。这就是我想要的：

```
stringstream ss;
int tmpInt;
string data;

cout << "Enter data: (1,2,3,4 etc.)";
getline(cin, data);

ss.str(data);

while(ss >> tmpInt)
{
    myList.addValue(tmpInt);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T23:51:28.630

您需要确保`ignore`逗号：

```
while(ss >> tmpInt)
{
    myList.addValue(tmpInt);
    ss.ignore();
} 
```

目前，提取将尝试读取一个整数，发现有一个逗号，并将流保持在失败状态。

或者，如果您想检查字符是否实际上是逗号（为了输入验证），您可以这样做：

```
while(ss >> tmpInt)
{
    myList.addValue(tmpInt);
    if (ss.get() != ',') break;
} 
```

# java - 文件保存 500 个从 0 到 1000 的随机数。将这些数字写入文件，然后打开文件并一一读取数字

> ID：15581625
> 
> 赞同：0
> 
> 时间：2013-03-22T23:50:51.453
> 
> 标签：java, arrays, file, loops, random

在 while 循环中发现困难。我不确定如何开始调用和/或读取生成文件中的每个数字，以便确定最小和最大数字以及总和。另外，如果可能的话，有人可以解释如何编写代码，以便如果任何数字是连续的，它就会计算多少次。

```
PrintWriter prw = new PrintWriter("results.txt");
int num, largest, smallest, total = 0, count = 0;
int programnumber = 6;
    double average = 0;

PrintWriter prw1= new PrintWriter(new FileWriter("randomdata.txt"));
Random generator = new Random(); 
for (int i = 0; i < 1001; i++){     
         num = generator.nextInt(500);      //Will this generate a file w/ 500 num?
         prw1.write(num + "\n");
    }
    prw1.close();

    largest = 0;        
    smallest = 9999;        
    while (prw1.nextInt()){            //what call statement do I use? 
            num = (prw1.nextInt());    //unsure how to begin reading numbers
            if (num > largest){
                largest = num;
            }
            if (num < smallest){
                smallest = num;
            }
    total += num;
    count++; 
        }
    average = (total / total); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:10:18.573

```
num = generator.nextInt(500);      //Will this generate a file w/ 500 num? 
```

上面所做的是生成一个介于 0 和 499 之间的随机值

为了让您从文件中读取，您必须使用,`BufferedReader`或任何其他阅读器并且不要使用，因为它用于写入而不是读取。`Scanner``FileReader``PrintWriter`

所以你可以试试这个。首先创建一个阅读器：

```
Scanner scr = new Scanner(fileToRead); //fileToRead should be the file you wrote 
```

然后替换以下内容：

```
while (prw1.nextInt()){            //what call statement do I use? 
    num = (prw1.nextInt());    //unsure how to begin reading numbers
    // ...
} 
```

有了这个：

```
while(scr.hasNextLine()){
    num = Integer.parseInt(scr.nextLine());
    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:10:20.780

我不认为`nextInt`你认为它会做。你写：

```
num = generator.nextInt(500); //Will this generate a file w/ 500 num? 
```

这个问题的答案是**否定**的。根据[文档](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt%28int%29)：[_`Random`](http://docs.oracle.com/javase/7/docs/api/java/util/Random.html#nextInt%28int%29)

> ```
> public int nextInt(int n) 
> ```
> 
> 返回一个伪随机、均匀分布的 int 值，介于 0（包括）和指定值（不包括）之间，取自该随机数生成器的序列。

因此`nextInt(500)`生成一个介于 0 和 499（含）之间的数字。

相反，您将希望使用`nextInt(1000 + 1)`0 到 1000（包括 0 到 1000）来获取数字。

您还应该更改阅读代码。您正在尝试从输出流中读取，这是您无法做到的。您可以更改代码以使用扫描仪，但我个人会使用[`BufferedReader`](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html)：

```
try {
    BufferedReader br = new BufferedReader(new FileReader("randomdata.txt"));
    String line = br.readLine();
    while (line != null) {
        // Do something, e.g. Integer.parseInt(line);
        line = br.readLine();
    }
    br.close();
} catch (IOException ie) {
    ie.printStackTrace();
} 
```

`BufferedReader`使用not 的一个原因`Scanner`是它可以扩展到不同格式的数据。也许在一行中的每个数字之前都有一个前缀，或者一行中有两个数字。您可以使用`BufferedReader`抓取整行，然后在解析之前格式化字符串。使用，对on`Scanner`的调用不会很好。`nextInt``"Number: 6"`

# delphi - SetLocaleInfo 失败

> ID：15581627
> 
> 赞同：-2
> 
> 时间：2013-03-22T23:51:08.573
> 
> 标签：delphi, winapi

我有功能

```
procedure bgGetKeyboardLayoutList(List: TStrings);
var
  AList : array [0..50] of Hkl;
  AklName: array [0..255] of Char;
  i: Longint;
begin
  List.Clear;
  for i := 0 to GetKeyboardLayoutList(SizeOf(AList), AList) - 1 do
    begin
      GetLocaleInfo(LoWord(AList[i]), LOCALE_SLANGUAGE, AklName, SizeOf(
               AklName));
      List.AddObject(AklName, Pointer(AList[i]));
    end;
end; 
```

该函数被调用

```
procedure TDefaultInputMethod.Scan;
begin
  bgGetKeyboardLayoutList(FSL);
end; 
```

但是当我尝试在相反的方向使用 SetLocaleInfo 时，我没有成功代码：

```
procedure TDefaultInputMethod.SetAsDefault(index: integer);
begin
  ActivateKeyboardLayout(Hkl(FSL.Objects[index]), 0); //this line works
  if SetLocaleInfo(LoWord(FSL.Objects[index]), LOCALE_SLANGUAGE, PChar(FSL[index]))  then
     ShowMessage('Uspeh')
  else
    begin
      ShowMessage(IntToStr(GetLastError));
    end;
end; 
```

GetLasrError 返回 1004

在此先感谢博扬

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T00:17:43.597

`ShowMessage(SysErrorMessage(GetLastError));`表示`1004`是`Invalid flags`。

根据[`SetLocaleInfo`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd374049%28v=vs.85%29.aspx)MSDN 上的文档，这对应于`ERROR_INVALID_FLAGS`，这是由传递给函数的无效值引起的。

问题出在第二个参数 ( `LOCALE_SLANGUAGE`) 上，根据[文档，它再次](http://msdn.microsoft.com/en-us/library/windows/desktop/dd464799%28v=vs.85%29.aspx)不是可以与 . 一起使用的值之一`SetLocaleInfo`。它只能用于`GetLocaleInfo`检索信息。（请参阅从`Constants Used in the LCType Parameter of GetLocaleInfo, GetLocaleInfoEx, and SetLocaleInfo`该页标题开始的部分。）

# java - 向谷歌地图 v2 添加标记，其中以编程方式添加地图

> ID：15581628
> 
> 赞同：-1
> 
> 时间：2013-03-22T23:51:13.183
> 
> 标签：java, android, google-maps

所以我正在尝试为我的 android 应用程序实现 google maps v2。我已经使用下面的代码成功地将地图添加到我的应用程序中。我还添加了布局代码。我不想更改此实现，因为我有一个表格视图并且地图是选项卡之一。你对我能做什么有什么建议吗？

```
 mMapFragment = MapFragment.newInstance();   
    android.app.FragmentTransaction fragmentTransaction = getFragmentManager().beginTransaction();
    fragmentTransaction.add(R.id.frame, mMapFragment);
    fragmentTransaction.commit(); 
```

布局

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <FrameLayout
        android:id="@+id/frame"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="0dp" >
    </FrameLayout>    
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T12:27:39.770

您可以像这样添加标记：

```
mMapFragment.getMap().addMarker(new MarkerOptions()
        .position(new LatLng(0, 0))
        .title("Hello world")); 
```

# python - 使用 datetime.datetime 在 python 中从用户那里获取输入日期

> ID：15581629
> 
> 赞同：2
> 
> 时间：2013-03-22T23:51:24.653
> 
> 标签：python, date, datetime, python-2.7

我正在尝试从用户那里获取输入日期并将其存储为

```
dt_start = dt.datetime(2006, 1, 1) 
```

我目前正在这样做：

```
i = str(raw_input('date'))
dt_start = dt.datetime(i) 
```

但它会抛出一个错误：

```
Traceback (most recent call last):
File "C:/.../sim.py", line 18, in <module>
    dt_start = dt.datetime(i)
TypeError: an integer is required 
```

谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-23T00:02:08.090

如果您使用该`%Y, %m, %d`格式，您可以尝试使用[`datetime.strptime`](http://docs.python.org/2/library/datetime.html#datetime.datetime.strptime)：

```
from datetime import datetime

i = str(raw_input('date'))
try:
    dt_start = datetime.strptime(i, '%Y, %m, %d')
except ValueError:
    print "Incorrect format" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-07T23:04:05.067

datetime() 仅将 int 作为参数。

尝试这个：

```
from datetime import datetime

date_entry = input('Enter a date (i.e. 2017,7,1)')
year, month, day = map(int, date_entry.split(','))
date = datetime(year, month, day) 
```

# python - python中更快的字符串替换

> ID：15581635
> 
> 赞同：-1
> 
> 时间：2013-03-22T23:52:10.527
> 
> 标签：python, string, string-matching

考虑以下字符串替换 python 代码：

```
import re

s = 'head abc.sys!0x1234 middle defg.sys!0x1a2b tail' # this could be potentially very long

d = {'0x1234' : 'Iamshorter',
     '0x1a2b' : 'Iammuchlonger' }

pat = re.compile(r'(\w+.\w+)!(0x[\d\w]+)')

while True:
    m = pat.search(s)
    if not m:
        break
    module, addr = m.groups()
    start, end = m.span()
    s = s[:start] + '%s!%s' % (module, d[addr]) + s[end:]

print s 
```

它会输出

```
head abc.sys!Iamshorter middle defg.sys!Iammuchlonger tail 
```

我正在寻找更快的 python 习语，以便可以释放 python 正则表达式的力量。我尝试使用 re.sub()，但我很难将“repl”作为匹配字符串的函数。任何建议都非常感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:07:10.260

我唯一的建议是使用[搜索功能](http://docs.python.org/2/library/re.html#re.search)的可选“pos”参数，这样您就不会检查您已经检查过的字符串部分。

# java - 选中窗口中的所有复选框

> ID：15581637
> 
> 赞同：-1
> 
> 时间：2013-03-22T23:52:24.850
> 
> 标签：java

我是java新手，我在窗口上有一些复选框和一个按钮，当我单击此按钮以选中窗口中的所有复选框时，我想要。

在 C# 中，我使用了这个：

```
foreach (Control c in this.Controls) {
    if ((c) is CheckBox) {
        c.Checked = true;
    }
} 
```

**我怎样才能在 Java 中做到这一点？**

这是我试过的代码

```
for (Component c : this.getComponents()) {
   if(c instanceof JCheckBox)
       c.setSelected(true);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:01:26.827

最干净的方法是简单地将所有复选框放在一个集合中（`List<JCheckBox>`例如 a ），然后在列表上迭代：

```
private List<JCheckBox> checkboxesToCheckWhenButtonIsPressed = new ArrayList<JCheckBox>();

public MyPanel() {
    // ... 
    // create the checkboxes, and fill the list of checkboxes
    // create the button
    button.addActionListener(new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            for (JCheckBox checkBox : checkboxesToCheckWhenButtonIsPressed) {
                checkbox.setSelected(true);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:46:41.610

您尝试的代码将无法编译，因为它需要进行`JCheckBox`强制转换才能使该`setSelected`方法可用。此外，循环不会到达任何嵌套容器。为此，您可以使用递归方法进行循环调用，`for`首先传入`ContentPane`:`JFrame`

```
void checkAllCheckBoxes(Container container) {

   for (Component c: container.getComponents()) {
      if (c instanceof Container) {
         checkAllCheckBoxes((Container)c);
      } 

      if (c instanceof JCheckBox) {
         ((JCheckBox) c).setSelected(true);
      } 
   }
} 
```

# visual-studio-2008 - Crystal Report for VS2008 error: "The request could not be submitted for background processing"

> ID：15581638
> 
> 赞同：1
> 
> 时间：2013-03-22T23:52:41.697
> 
> 标签：visual-studio-2008, crystal-reports

I'm developing with VS2008 and Crystal Report for VS2008.

There is a report that includes an image object, which shows a JPG file stored as a blob field in Oracle database.

Most of the times that report exports to PDF correctly, but some times returns error:"The request could not be submitted for background processing" and crashes completely CR.

I realized that it crashes depending on the JPG file that has to show, but I can't determine what feature of the JPG file is making it to crash.

I have already installed this Service Pack but no change at all:

Crystal Reports Basic for VS 2008 - Service Pack 1

Extract of my code:

```
Try    
           Dim oRpt As New cr_my_report    
           oRpt.SetDataSource(dt)   ' dt is a datatable filled from an Oracle database query    
            Dim exportOpts As ExportOptions = oRpt.ExportOptions    
            oRpt.ExportOptions.ExportFormatType = ExportFormatType.PortableDocFormat

            oRpt.ExportOptions.ExportDestinationType = ExportDestinationType.DiskFile

            oRpt.ExportOptions.DestinationOptions = New DiskFileDestinationOptions

            CType(oRpt.ExportOptions.DestinationOptions, DiskFileDestinationOptions).DiskFileName = Server.MapPath("../Temp/" + PDFName)

            oRpt.Export()  ' here it crashes

        Catch ex As Exception

        Finally    
            oRpt.Close()    
            oRpt.Dispose()    
        End Try 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-03T13:22:09.233

After many days, finally I discovered what is the root of problem. The thing is that CR for VS2008 or later versions, **can’t handle jpg files in CMYK mode**. CR only can handle jpg files in RGB mode.

It’s funny that lower versions of CR (the one that came with VS2003) could handle any kind of jpg files. Thanks, Crystal.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:37:26.870

I don't know if this is the same issue on Oracle as it is for SQL Server. Apparently the issue was fixed in sp4.

ADAPT01407087 Description: When using an SQL server native ODBC connection, the Field Explorer displays the Blob datatype as “String” instead of “Picture”. The cause of the problem is that any field that uses the data types varchar(max), nvarchar(max), and varbinary(max) in the SQL Server 2005 driver may fail to be correctly mapped. New Behavior: This problem is resolved

If you can you should update to the latest service pack. You can find all of them for 2008 at [http://scn.sap.com/docs/DOC-27917](http://scn.sap.com/docs/DOC-27917)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-26T13:01:44.980

I had this same issue. The solution was to set my default printer to another printer. I ran the report and it all worked correctly. I then re-set the printer back to the original one and the report still worked.

# javascript - 允许通过右键单击（仅），适用于图像但不适用于 iframe

> ID：15581639
> 
> 赞同：1
> 
> 时间：2013-03-22T23:52:43.007
> 
> 标签：javascript, jquery, contextmenu, mouseevent

试图弄清楚如何让这个脚本与 vimeo 嵌入一起工作。似乎可以正常使用图像（在 OS X 中的 FF、Chrome 和 Safari 中尝试过）。然而，vimeo embed 不会显示上下文菜单。

思路如何解决？

[**演示**](http://jsbin.com/eliraz/1)

```
$('.container').mousedown(function(e){
    if ( e.which == 3 ){
        var overlay = $(this).find('.overlay');
        overlay.hide();
        setTimeout(function() {
          overlay.show();         
        }, 50);
        return false;
    }
}); 
```

# php - 使用 PHP 安全地存储数据

> ID：15581648
> 
> 赞同：1
> 
> 时间：2013-03-22T23:53:28.700
> 
> 标签：php, security, encryption

我需要安全地存储一些可由授权用户在网站上检索的数据。这不是信用卡，但同样是您不希望有人接触到的数据。

唯一会检索数据的用户是发布数据的用户。

所以，我正在考虑把一些东西放在一起，如下所示：

*   一切都通过 SSL 运行
*   要登录，用户将输入他们的用户名和密码，并且还必须上传“密钥”文件 - 建议用户只在拇指驱动器或类似设备上保留一份密钥文件的副本
*   用户的密钥不会物理存储在服务器上。当用户提供他们的登录密钥时，它将存储在内存中
*   所有存储的数据都将使用 MCRYPT_RIJNDAEL_256 加密，用于加密的密钥将是他们必须上传的密钥文件的一部分（即未存储在服务器上的文件）
*   当用户的密钥保存在内存中时，这也将使用 MCRYPT_RIJNDAEL_256 使用每天更改的密钥进行加密
*   我们将在检索数据时生成一个新的 32 字节 IV，因此对于两次单独的检索我们应该得到不同的结果
*   用户可以在需要时重新生成他们的密钥，此时所有存储的数据都用他们的新密钥重新加密
*   用户可以在他们的密钥的内存存储中设置超时 - 要求他们（例如）每 30 分钟重新提供一次。
*   用户还可以在内存存储上设置非活动超时，因此假设他们在（例如）5 分钟内不执行操作，它也会使密钥过期
*   盒子本身将被锁定，仅将端口 80 和端口 22 暴露给单个 IP（我们的办公室 IP）

我的问题是：

我的想法是否正确？上述解决方案是安全的，还是我错过了一些可以轻松获取数据的攻击向量？

据我所知，攻击者需要对机器进行物理访问（或者需要在我们的办公室网络上），即使是这种情况，他们也只能检索当时登录的用户的数据（因为它们是唯一可以存储的密钥）？我的假设正确吗？

有什么方法可以消除在用户登录时将用户密钥存储在内存中的要求（没有要求他们在每次请求时重新提供密钥）？我不认为有，但我希望这是我没有想到的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T00:37:20.890

这在本地网络上听起来有点偏执，但这里有一些其他的事情需要考虑。这些是我自己遇到的一些事情。

1.  盒子和对盒子的物理访问是否已锁定并受到监控（安全房间、安全机架、摄像头）？如果它与“在线”的交换机位于同一个机架中，则跳线可以将它连接到互联网。也有人可以带入无线路由器并将其连接到网络（将其隐藏在桌子下），这样您就无法判断它正在广播。USB 路由器也可用于连接共享。检查 Mac 地址。

2.  如果您要求密钥，您可能希望将密钥与第二个短语（用户提供的可能像两步密码一样）和一个只有您知道的隐藏短语进行散列，所以如果有人在这个东西上运行循环器，他们就不能到任何地方。此外，如果他们捕获了几个数据包，您不希望他们尝试破译转储。如果您在某人提供不同密钥并且哈希失败时进行哈希，那么您知道他们不是您认为的那个人。

3.  如果您在交换密钥的地方捕获初始握手，则可能会破坏 SSL（银行的高端路由器这样做是为了加快传输速度），因此通过连接传输的任何内容都可以使用 Wireshark 之类的东西进行窃听。是否可以访问硬件层？

4.  如果可以访问 USB 端口（因此端口需要锁定在物理机上），则可以在机器上收集任何捕获的内容。如果您让他们提供拇指驱动器，那么这也需要检查（root 工具包、键盘记录器等）。可能是拇指驱动器上运行的应用程序的校验和。此外，还需要检查机器是否有其他 USB 拇指驱动器（可能在机器背面），有人可能会在其中安装键盘记录器并等待。

5.  如果他们可以访问机器上的 CD-rom，他们是否可以重新启动机器并使用 knoppix 之类的东西？不会有数字纸迹。

6.  在浏览器中，您可能希望使其不保留任何历史记录。

7.  所有网页都需要立即过期。

8.  每次有人连接到机器时，您都可以让它安装一个干净的虚拟机。

9.  使用不同的默认 Web 端口。

10.  由于它在数据中心中，因此您需要确保盒子本身寻找特定的连接以便正常工作（有点像保持活动身份验证）。这样，如果盒子有中间人尝试，则必须有人进行物理干预才能使盒子重新上线。

11.  如果盒子在服务器场（在同一个机架中）有自己的防火墙或本地网络，请确保盒子不会盲目信任本地网络。我过去的一些客户托管在“核准备就绪”设施的“安全”笼子里，以找出其他人已经在他们的企业级防火墙后面以及与他们的安全服务器相同的子网中修补了他们的千兆交换机。他们使用我的客户端连接进行广播，而不是试图进入我的客户端的盒子，尽管他们确实设法用红色代码感染了我的客户端的一个邮件服务器（Microsoft）。我的客户端的防病毒/反垃圾邮件防火墙（Fortinet）阻止了所有出站病毒、蠕虫和未经请求的邮件（防火墙向我传呼关于寻找 IP 的新 MAC 地址）。幸运的是我们不是

12.  为了获得最佳安全性，您需要确保机架本身位于其自己的笼子中或物理锁定（独立）。它有点贵，但如果数据是关键任务，那么如果存在违规行为可能会很糟糕。大多数服务器场都信任能够访问笼子的经过身份验证的人，因此他们通常不会将摄像头放在包含 30-40 个机架的笼子内，如果您碰巧在普通人群中托管一个主要的服务器场。此外，大多数服务器场都有几个“守卫”或监控摄像头和登录的人员以及一些技术人员，具体取决于那里托管的内容。

13.  使盒子本身的防火墙只接受来自您自己的几个特定静态 IP 的连接，并且盒子上的任何应用程序也应该进行验证。如果您使用防火墙，则只允许受信任的 VPN 连接访问所需资源（Web 应用程序、数据库等）以外的任何内容。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T00:51:58.137

如果只有上传的用户需要能够阅读内容，那么公钥加密可能有用吗？

这样，您就不必真正关心在内存中是否有密钥或害怕有人嗅探数据。客户将使用他的公钥从他可能在世界上的任何地方加密文件。只有当某人可以访问他的私钥（在加密时不需要）时，您才能解密该数据。

[GPG](http://www.gnupg.org/)是这样的一个很好的工具，并且存在很多图形用户界面。

如果服务器是某种备份，只需确保将私钥的副本存储在安全的地方。这可能是在没有任何类型的互联网访问的外部媒体上。

# ios - 在不使用 restoreCompletedTransactions 的情况下恢复应用内购买的项目

> ID：15581651
> 
> 赞同：1
> 
> 时间：2013-03-22T23:53:48.450
> 
> 标签：ios, objective-c, in-app-purchase, storekit

我的应用程序使用应用程序内购买的内容（非消耗品）并在后端对所有购买进行审计。根据 Apple 指南，该应用程序应实施恢复功能以恢复已购买的项目。它是否总是必须通过调用来完成，`SKPaymentQueue:restoreCompletedTransactions`或者我可以使用我自己的机制从我的后端获取购买项目的列表并在应用程序中恢复它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:19:27.213

`SKPaymentQueue:restoreCompletedTransactions`是一种方便的方法。如果您愿意，您可以使用存储在服务器上的信息恢复应用内购买。事实上，对于非续订订阅，您*必须自己*实现恢复功能，因为 Store Kit 不为这种应用内购买提供它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:23:52.540

显然，Apple 要求使用`SKPaymentQueue:restoreCompletedTransactions`在应用程序购买中恢复的方法。以下是我们从 Apple 得到的回复：

> 我们发现您的应用以非标准方式启动应用内购买流程。
> 
> 使用 Store Kit 来恢复应用内购买是合适的。此外，启动与执行初始应用内购买时相同的过程是适当的，即提示用户提供 Apple ID 密码并确认交易已完成。

我知道，App 审查有时是一件非常主观的事情，但为了安全起见，请使用 Store Kit 功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T10:43:34.977

我为非消耗品开发了[storekit](https://github.com/idzDeveloper/IDZStoreKit)。看看它是否对你有用。:)

# c++ - 是否可以用 lambda 初始化静态变量？

> ID：15581662
> 
> 赞同：24
> 
> 时间：2013-03-22T23:55:07.580
> 
> 标签：c++, static, lambda

我试过这个：

```
#include <map>

int main() {

  static std::map<int,int> myMap = [](){
    std::map<int,int> myMap;
    return myMap;
  };

} 
```

错误：

```
<stdin>: In function 'int main()':
<stdin>:8:3: error: conversion from 'main()::<lambda()>' to non-scalar type 'std::map<int, int>' requested 
```

是的，我知道我可以为它创建另一个“正常”函数，它可以工作，但 lambdas 不能以这种方式初始化对象。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-03-22T23:57:11.133

是的，这确实是可能的。

```
static std::map<int,int> myMap = [](){
  std::map<int,int> myMap;
  return myMap;
}(); 
```

注意`()`最后。您正在分配`myMap`一个 lambda，但您确实想将其分配给 lambda 的结果。你必须为此打电话。

# c - 如何从 .t xt 读取单独的数字/行并将它们输入到 2 个不同的数组

> ID：15581663
> 
> 赞同：2
> 
> 时间：2013-03-22T23:55:09.733
> 
> 标签：c

我正在尝试编写一个程序，该程序从 .txt 读取行并将它们输入到 2 个不同的数组中。

到目前为止，我有这个：

```
 #include <stdio.h>

    int main() {
        FILE * ifp = fopen("input.txt","r"); 
        FILE * ofp = fopen ("output.txt", "w"); 
        int participants = 0, i;  
        char name [10];
        float grade [10];
        float perc [10];

        fscanf(ifp, "%d", &participants);

        for (i=1; i<participants; i++) {
             fscanf(ifp, "%s", &name);

             fscanf(ifp, "%f", &grade);

        }

        printf( "%d\n", participants);
        printf( "%s\n", name);
        printf( "%f\n", grade);

        fclose(ifp);
        fclose(ofp);

        return 0;
    } 
```

我要阅读的 txt 是：

```
 2 
    Optimus 
    45 90 
    30 60 
    25 30 
    50 70 
    Megatron 
    5 6 
    7 9 
    3 4 
    8 10 
```

我的问题是它会拿起前 2 行，但在到达数字时会停止。我正在尝试将名称放入一个数组中，并将所有数字成对放入不同的数组中。现在我只是想检查一下我是否正在拾取数组中的数字，但它并没有把它们全部拾起。

这是我得到的输出：

```
 2
    Optimus
    0.000000 
```

有任何想法吗？

**编辑**

这是我经过一些更改后的新代码：

```
 #include <stdio.h>

    int main() {
        FILE * ifp = fopen("input.txt","r");
        FILE * ofp = fopen ("output.txt", "w");
        int participants = 0, i , j; 
       char name [10];
        int grade [26];
        float perc [26];

        fscanf(ifp, "%d", &participants);

        for (i=1; i<participants; i++) {
             fscanf(ifp, " %s", name);
             fscanf(ifp, " %d", grade);

        }

        printf( "%d\n", participants);
        printf( "%s\n", name);
        printf( "%d\n", grade[0]);

        fclose(ifp);
        fclose(ofp);

      return 0;
    } 
```

我的新输出是：

```
 2
    Optimus
    45 
```

**编辑 2**

稍后我需要对这些数字做的是将一行中的第一个数字与同一行中的第二个数字相除，将其乘以 10，然后根据数字显示“*”。所以它会像这样打印出来：

```
 Optimus
    +:  *****
    -:  *****
    *:  ********
    /:  *******
    Megatron
    +:  ********
    -:  *******
    *:  *******
    /:  ******** 
```

“+”是名称下的第一行。“-”是同名下的第二行。“*”代表第三个。“/”代表第四个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:04:48.900

这是您的主要问题：

```
 printf( "%f\n", grade); 
```

您正在尝试将指针打印为浮点数。你想要`grade[0]`。

在这一行：

```
 fscanf(ifp, "%f", &grade); 
```

这会起作用，但它是不正确的。它应该是`&grade[0]`或者只是简单`grade`的。

当然，在您的最终版本中，您需要调整数组下标。您还需要为名称分配更多数组 - 您目前只能存储一个。

要读入数据，您需要对程序进行大量更改。您可以声明`grade`为`grade[10][8]`（假设最多有 10 个参与者），并将 8 个整数中的每一个存储在数组中。像这样的循环会处理它：

```
 for (i = 0; i < participants; i++) {
      fscanf(ifp, "%s", name);             // read the name (you need to fix this)
      for (j = 0; j < 8; j++) {
        fscanf(ifp, "%d", &grade[i][j]);   // store each number
      }
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:01:28.887

`name`并且`grade`是数组 - 变量的地址对于数组是隐含的。所以地址运算符不应该用于这些变量。

```
fscanf(ifp, "%s", name);
fscanf(ifp, "%f", grade); 
```

# actionscript-3 - 数据从 amfphp 发送到 flash 时如何编码？

> ID：15581671
> 
> 赞同：0
> 
> 时间：2013-03-22T23:55:53.160
> 
> 标签：actionscript-3, encoding, deserialization, amfphp

发送到闪存时如何对数据进行序列化/编码？

或者，“数据从 amfphp 发送到闪存时如何编码？”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T08:53:51.750

在 as3 中，JSON 用于将数据从 php 编码/解码到 flash，反之亦然。您将需要[as3corelib](https://github.com/mikechambers/as3corelib)才能使用此功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T18:21:25.117

我能够弄清楚。事实证明 AMF 是一种格式 - [http://en.wikipedia.org/wiki/Action_Message_Format](http://en.wikipedia.org/wiki/Action_Message_Format)

使用这些十六进制值

```
Undefined - 0x00
Null - 0x01
Boolean False - 0x02
Boolean True - 0x03
Integer - 0x04
Double - 0x05
String - 0x06
XML - 0x07
Date - 0x08
Array - 0x09
Object - 0x0A
XML End - 0x0B
ByteArray - 0x0C 
```

这里有一个库可以反序列化 [https://github.com/pwalczyszyn/amf-message-deserializer](https://github.com/pwalczyszyn/amf-message-deserializer)将其转换为 as3 可读的对象

# php - 从元框查询中获取图片标题

> ID：15581674
> 
> 赞同：1
> 
> 时间：2013-03-22T23:56:24.020
> 
> 标签：php, wordpress, caption, meta-boxes

我想将每个图像的图像标题拉到轮播中。我可以成功拉出 alt 标签，但我无法获得标题。

这是我到目前为止所拥有的，但它正在打破。

```
 <?php $args = array(
    'post_type' => 'homepageslider',
    'posts_per_page' => 1
    ); 
    $query = new WP_Query($args); 
        while ($query->have_posts()):
        $query->the_post();
        $meta = get_post_meta( get_the_ID(  ), 'homepage_media_gallery', false );

        if ( !is_array( $meta ) )
            $meta = ( array ) $meta;

            if ( !empty( $meta ) ) {
            $meta = implode( ',', $meta );
                $images = $wpdb->get_col( "
                SELECT ID FROM $wpdb->posts
                WHERE post_type = 'attachment'
                AND ID IN ( $meta )
                ORDER BY menu_order ASC
                " );
            foreach ( $images as $att ) {
            // Get image's source based on size, can be 'thumbnail', 'medium', 'large', 'full' or registed post thumbnails sizes
            $attachment_meta = wp_get_attachment($att);
            $link = $attachment_meta['caption'];
            $src = wp_get_attachment_image_src( $att, 'full' );
            $alt = get_post_meta($att, '_wp_attachment_image_alt', true);
            $src = $src[0];
            // show caption                         
            echo $link;
            // Show image
            echo "<div><img src='{$src}' class='project-images' />"; ?>
            <?php if ($alt) : ?>
            <div class='homepage-caption'>
                <?php echo $alt; ?>
            </div>
        <?php endif ?>
     <?php echo "</div>"; 
         }
    } 
endwhile 
?> 
```

你如何获得查询中每张图片的标题？我正在使用 WP Meta Boxes 插件来提取图像。

**更新**

奥默克说得对。不需要 SQL 查询。这就是我现在所拥有的，它为每个图像提取 alt、标题和描述。

```
<?php 
    $args = array( 'post_type' => 'attachment', 
       'orderby' => 'menu_order', 
        'order' => 'ASC', 
        'post_mime_type' => 'image' ,
         'post_status' => null, 
         'numberposts' => null, 
          'post_parent' => $post->ID,
         'exclude'     => get_post_thumbnail_id()
    );
$attachments = get_posts($args); ?>
 <?php if ($attachments) : ?>
     <?php foreach ( $attachments as $attachment ): ?>
    <?php 
    $alt = get_post_meta($attachment->ID, '_wp_attachment_image_alt', true);
                                $image_title = $attachment->post_title;
                                $caption = $attachment->post_excerpt;
                                $description = $attachment->post_content;
                                $src = wp_get_attachment_image_src( $attachment->ID, 'full' ); 
                                list($width, $height, $type, $attr) = getimagesize($src[0]); ?>

    <div class="projectBlock">
    <div class="projectCopy">

        <h2><?php echo $alt ?></h2>

        <h3><?php echo $caption ?></h3> 
        <p class='projectDescription'><?php echo $description ?></p>
        </div>
    <div class="projectImage">
        <img src="<?php echo $src[0]; ?>" class="project-images 
    </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:22:37.987

我不确定您如何使用元框（以及为什么？

```
$alt = get_post_meta($attachment->ID, '_wp_attachment_image_alt', true);
$image_title = $attachment->post_title;
$caption = $attachment->post_excerpt;
$description = $image->post_content; 
```

由于 wp 中的附件实际上是内置的 CPT（实际上是一个帖子）：

附件标题实际上是帖子摘录附件标题是帖子标题附件描述是帖子内容。

所以完整的代码更符合以下内容：

```
$args = array( 'post_type' => 'attachment', 
                    'orderby' => 'menu_order', 
                    'order' => 'ASC', 
                    'post_mime_type' => 'image' ,
                    'post_status' => null, 
                    'numberposts' => null, 
                    'post_parent' => $post->ID );

        $attachments = get_posts($args);
        if ($attachments) {
            foreach ( $attachments as $attachment ) {
                $alt = get_post_meta($attachment->ID, '_wp_attachment_image_alt', true);
                $image_title = $attachment->post_title;
                $caption = $attachment->post_excerpt;
                $description = $attachment->post_content;
                } 
             } 
```

# java - 让 AutoCompleteTextView 响应 SimpleAdapter 中的更改

> ID：15581677
> 
> 赞同：0
> 
> 时间：2013-03-22T23:57:10.137
> 
> 标签：java, android, autocompletetextview, simpleadapter

我是 Android 新手，正在尝试使用 AutoCompleteTextView 和不同的适配器。使用 ArrayAdapter （[在此处讨论](https://stackoverflow.com/questions/15375291/autocompletetextview-not-responding-to-changes-to-its-arrayadapter "在这里讨论")）后，我现在正在尝试使用两个 AsyncTask 链进行相同的操作。我在其他地方看到过这种方法的几个例子，我认为它比尝试在线程之间同步数据更整洁。它还允许我保留每个项目的 K、V 哈希图，因此希望我可以在单击此应用程序下一阶段的建议时提取项目 ID。

在这种方法下，我再次努力让视图更新建议。除了我在“编辑”框中键入的内容之外，什么都没有出现。这是 UI 线程和 AsyncTask 链之间的时间问题吗？或者我在适配器/视图绑定中出错了？

注意：我已经尝试过使用 autoComplete.setAdapter(adapter); 在 ParserTask onPostExecute() 方法中应用。那也没有用。

```
public class MainActivity extends Activity {
    public String TAG = new String("MAINACTIVITY");
    public CustomAutoCompleteView autoComplete;
    public InputStream inputStream;
    private String serviceURL = new String("http://www.autocompare.co.uk/search.php?q=");
    public QueryTask queryTask;
    public ParserTask parserTask;
    public SimpleAdapter adapter;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        autoComplete = (CustomAutoCompleteView) findViewById(R.id.autocomparesayt);
        autoComplete.setHint(R.string.search_hint);
        autoComplete.setThreshold(1);
        autoComplete.setAdapter(adapter);

        autoComplete.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(final CharSequence s, int start, int before, int count) {
                int queryThreshold = 3;
                if (s.length() != 2 && (s.length() - 1) % queryThreshold != 0) {
                    return;
                }

                queryTask = new QueryTask();
                queryTask.execute(s.toString());
            }

            @Override
            public void afterTextChanged(Editable s) { }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) { }
       });
    }

    private class QueryTask extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... vehicle) {
            // Go fetch data from webservice
            // this bit works fine
            return(data);
        }

        @Override
        protected void onPostExecute(String result) {
            Log.d(TAG, "now entered parser task");
            super.onPostExecute(result);
            parserTask = new ParserTask();
            parserTask.execute(result);
        }
    }

    private class ParserTask extends AsyncTask<String, Integer, List<HashMap<String, String>>> {
        @Override
        protected List<HashMap<String, String>> doInBackground(String... jsonData) {
            List<HashMap<String, String>> vehicles = null;
            VehicleJSONParser vehicleJsonParser = new VehicleJSONParser();

            // parse JSON string and load data into vehicles
            // this bit works fine too

            return vehicles;
        }

        @Override
        protected void onPostExecute(List<HashMap<String, String>> result) {
            String[] from = {"name"};
            int[] to = new int[] { android.R.id.text1 };

            //  Attempt to set up adapter with data bubbled up from parserTask execution
            //  THIS BIT LOGS NO ERRORS, BUT AUTOCOMPLETETEXTVIEW REMAINS UNCHANGED
            adapter = new SimpleAdapter(getBaseContext(), result, android.R.layout.simple_list_item_1,
           from, to);
            adapter.notifyDataSetChanged();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T23:25:41.043

好的 - 听起来令人难以置信，但似乎将 setAdapter() 方法移回`postExecute`并保持`notifyDataSetChanged()`原位，该死的东西正在工作！

（下一步是找出可能使用意图/捆绑/片段的 AutoCompleteTextView 点击事件.. wheee！）

这是最终的工作代码：

```
public class MainActivity extends Activity {
    public String TAG = new String("MAINACTIVITY");
    public CustomAutoCompleteView autoComplete;
    public InputStream inputStream;
    private String serviceURL = new String("http://www.blabla.co.uk/search.php?q=");
    public QueryTask queryTask;
    public ParserTask parserTask;
    public SimpleAdapter adapter;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        autoComplete = (CustomAutoCompleteView) findViewById(R.id.autocomparesayt);
        autoComplete.setHint(R.string.search_hint);
        autoComplete.setThreshold(1);

        autoComplete.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(final CharSequence s, int start, int before, int count) {
                int queryThreshold = 3;
                if (s.length() != 2 && (s.length() - 1) % queryThreshold != 0) {
                    return;
                }

                queryTask = new QueryTask();
                queryTask.execute(s.toString());
            }

            @Override
            public void afterTextChanged(Editable s) { }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count, int after) { }
       });
    }

    private class QueryTask extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... vehicle) {
            // Go fetch data from webservice
            // this bit works fine
            return(data);
        }

        @Override
        protected void onPostExecute(String result) {
            Log.d(TAG, "now entered parser task");
            super.onPostExecute(result);
            parserTask = new ParserTask();
            parserTask.execute(result);
        }
    }

    private class ParserTask extends AsyncTask<String, Integer, List<HashMap<String, String>>> {
        @Override
        protected List<HashMap<String, String>> doInBackground(String... jsonData) {
            List<HashMap<String, String>> vehicles = null;
            VehicleJSONParser vehicleJsonParser = new VehicleJSONParser();

            // parse JSON string and load data into vehicles
            // this bit works fine too

            return vehicles;
        }

        @Override
        protected void onPostExecute(List<HashMap<String, String>> result) {
            String[] from = {"name"};
            int[] to = new int[] { android.R.id.text1 };

            adapter = new SimpleAdapter(getBaseContext(), result, android.R.layout.simple_list_item_1,
           from, to);
           autoComplete.setAdapter(adapter);
           adapter.notifyDataSetChanged();
        }
    }
} 
```

# c - 嵌入式系统中的密码伪随机数生成器？

> ID：15581679
> 
> 赞同：8
> 
> 时间：2013-03-22T23:57:13.587
> 
> 标签：c, random, embedded, aes

我正在研究具有执行 AES128 (CBC) 加密的外围设备的 STM32L152xx。然而，为了初始化一个随机 IV，我正在寻找一个好的方案来创建密码安全的随机数序列。我现在使用一个简单的 LCRG（线性同余生成器）作为占位符，但这很弱。

我是在嵌入式平台上实现加密的新手，所以我想知道生成加密 PRNG 的常见做法是什么？或者选择密钥和 IV 的好策略是什么？

StackOverflow 上有关加密 PRNG 的大多数答案都是指该平台上不可用的 3rd 方库。但是，如果值得一试，我可以尝试移植它。指向资源的链接和指针也会有所帮助！

我可以访问船上的系统时钟和加速度计。我正在运行 FreeRTOS。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-23T00:13:01.130

您可能需要更好地定义“加密安全”或您的应用程序。如果这是针对手机上的游戏，您可能会使用加速度计作为随机性来源。如果您尝试签署 x.509 证书，您可能会考虑使用一些附加硬件来测量放射性衰变。

严肃地说，根据您需要的“随机性”的强度，考虑以下几点：

1.  每纳秒滴答的时钟的当前 32 位值（大约 4 秒的周期 - 可能足够“随机”，具体取决于您需要种子的频率）。您需要确保您不会以确定的方式获取此值。如果你抓取它时是基于用户输入的，那么它可能没问题。
2.  [雪崩噪声发生器](http://en.wikipedia.org/wiki/Avalanche_diode)馈入施密特触发器输入。
3.  你的所有轴的异或是加速度计（如果东西一直静止不动可能不好，除非它在正常应用中拾取振动）。如果这是用于随身携带的收音机，那么这可能没问题。
4.  一大块未初始化内存的值（您可能希望对其进行散列，因为大部分未初始化内存可能包含从开机到开机的相似值）。此外，如果您的设备没有完全断电，那么这可能不好。
5.  上述一项或多项的某种组合（异或可能是组合上述两个输出的最简单方法）
6.  喜剧选项：[CCD 相机对准熔岩灯](http://www.lavarnd.org/what/index.html)

上述任何方法都可能需要对它们应用某种[去偏](http://en.wikipedia.org/wiki/Hardware_random_number_generator#Software_whitening)算法。最简单的一种是一次考虑您的输入 2 位。如果 2 位相等，则丢弃它们。0b10 变为 1，0b01 变为 0。这将确保您在最终随机值中获得或多或少相同数量的 1 和 0。

最后，如果这是为了一些严重的事情，你应该无视上述所有建议，而不是滚动你自己的加密货币。为您的平台找到一些已经过审查的 API 并使用它。测试随机性算法非常困难。

也许考虑一下[STM32 内核的 F-2 系列，](http://www.st.com/web/catalog/mmc/FM141/SC1169/SS1575)它显然包含一个硬件 RNG

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T00:29:04.987

皮特·布劳曼的回答涵盖了这个问题的一个好的答案应该是什么：无偏和结合弱熵源。在此过程中使用未初始化的内存我会有点犹豫；我可以想到这样的场景，即基于恶意用户先前未使用未初始化内存的假设的系统最终可能会受到损害。除此之外，没有什么我可以不同意的。

为了节省您重新发明可能已经发明的轮子的时间，我的建议是简要了解一下[cryptlib](http://www.cs.auckland.ac.nz/~pgut001/cryptlib/) ，前提是您还没有这样做；" *cryptlib 的高度可移植性意味着它也被用于各种定制的嵌入式系统环境，包括 AMX、ChorusOS、eCos、FreeRTOS/OpenRTOS、uITRON、MQX、PalmOS、RTEMS、ThreadX、T-Kernel、uC/OS II、 VDK、VxWorks 和 XMK。* ” 这个库可能会为您完成大部分工作；假设使用 cryptlib 是可行的，您可能只需要向它提供随机信息（来自多个来源）：“*随机数据收集操作由 cryptAddRandom 函数控制，该函数可用于将您自己的随机信息注入内部随机池或告诉 cryptlib 轮询系统以获取随机信息。*"

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-31T05:04:39.730

我知道这是一个相当古老的问题，但由于还没有人提到加密安全 PRNG，我想我想插话。“加密安全”IV 和密钥应使用加密 PRNG 生成，例如[HMAC_DRBG 或 CTR_DRBG](http://csrc.nist.gov/groups/ST/toolkit/documents/rng/HashBlockCipherDRBG.pdf)。前者基于[HMAC](http://en.wikipedia.org/wiki/Hash-based_message_authentication_code)，后者基于[CTR模式的AES](http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_.28CTR.29)。这两个 PRNG 在[PolarSSL 中可用，它也在 FreeRTOS 上运行](https://polarssl.org/features)。注意不要使用 DUAL_EC_DRBG，这是[NSA 的后门，](http://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator#NSA_backdoor_in_the_Dual_EC_DRBG_PRNG)永远不会再使用。

最重要的是，您需要一个熵源来播种这些 PRNG。不幸的是，这是嵌入式设备的难点。[您可以在此博客](http://blog.cryptographyengineering.com/2012/02/random-number-generation-illustrated.html)中找到一些想法，例如采用 ADC 输出。

特别是在 IV 上，另一个重要的标准是它应该是不可预测的。也就是说，在给定当前密文的情况下，攻击者不应该有系统的方法来预测下一个密文的 IV。这是为了避免[对 TLS 1.0 进行类似 BEAST 的攻击](http://blog.cryptographyengineering.com/2011/09/brief-diversion-beast-attack-on-tlsssl.html)。

最后，对于这类问题，您将有更好的机会在[crypto.stackexchange.com](https://crypto.stackexchange.com/)上获得出色的答案。

# mysql - 在一列中计算多个值

> ID：15581680
> 
> 赞同：1
> 
> 时间：2013-03-22T23:57:26.697
> 
> 标签：mysql, if-statement, sum, conditional-statements

长期读者，第一次海报。我有一张表，我需要从中收集一些值（在“product_group”列中找到）重复的时间量，并且有时还必须考虑来自不同列（“product_type”）的值。

我在论坛上搜索了很长时间，这就是我暂时想到的……我的问题是我觉得这不是最有效的方法。此外，如果没有条件匹配（例如其他条件），它不会让我计算。

```
SELECT
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product1%', 1, 0)) AS Value1,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product2%', 1, 0)) AS Value2,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product3%', 1, 0)) AS Value3,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product4%', 1, 0)) AS Value4,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product5%', 1, 0)) AS Value5,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product6%', 1, 0)) AS Value6,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product7%', 1, 0)) AS Value7,
   SUM(IF(record_type NOT LIKE '%TypeA%' AND product_group LIKE '%Product8%', 1, 0)) AS Value8,
   SUM(product_group NOT LIKE '%Product9%') AS Value9,  
   SUM(IF(record_type LIKE '%TypeA%', 1, 0)) AS Value10
FROM
   [tables]
WHERE
   [conditions] 
```

我的目标是找出加权的用户生产力。所以我计算用户每次处理特定产品的时间。根据产品的类型，我将修改值（从原始的 0.83 到 1.25）以考虑复杂性。一旦所有不同产品的重量都被“碾压”过，我将它们全部加起来，然后除以工作小时数。

数学是在我的 PHP 代码中的 SQL 查询之外完成的。我想知道使用 WHERE 部分中的条件而不是我以前的方法运行多个顺序 SQL 查询是否会更好。这是在这种情况下的样子......

```
SELECT 
   COUNT(*)*0.95 as `Value1`
FROM
   [tables]
WHERE
   record_type NOT LIKE '%TypeA%'
   AND  product_group LIKE '%Product1%'
   [other conditions] 
```

然后对所有其他 10 个左右的值重复...

所以这几乎总结了它。任何可以与我分享的建议、提示、链接将不胜感激，因为我已经用尽了我能想到的所有资源。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:08:20.323

你的方法是更好的方法。运行单独的 SQL 查询最终会多次扫描表。最好只通过表一次。

您还可以在 SQL 中进行额外的算术运算。但是，如果您已经在应用程序代码中编写了它，则无需更改它。

# c# - 使用计时器同步传递给线程的对象

> ID：15581681
> 
> 赞同：0
> 
> 时间：2013-03-22T23:57:36.327
> 
> 标签：c#, multithreading, winforms, timer

我之前制作了一个简单的球和桨程序，所有程序都以一种形式运行。现在我试图让球在单独的线程上运行，但在概念上不太了解如何让球在单独的线程上运行，同时保持我的程序的其余部分相同。

最初计时器会让球移动，所以我想我可以将移动线插入到我的 ballUpdate 类中。但现在我的问题是是否有办法让线程工作我当前的计时器实现。

这就是我的 form1 的样子

```
public partial class Form1 : Form
    {
        Graphics paper;
        Paddle paddle = new Paddle();
        Ball ball = new Ball();
        Thread myThread;
        BallUpdate ballUpdate = new BallUpdate();

        public Form1()
        {
            InitializeComponent();
            myThread = new Thread(() => ballUpdate.ballMotion(ball));
            myThread.Start();
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            paper = e.Graphics;
            paddle.drawPaddle(paper);
            ball.drawBall(paper);

        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            //ball.moveBall();
            ball.collide();
            ball.hitPaddle(paddle.PaddleRec);
            this.Invalidate();
        } 
```

我认为这可能会有所进展，但球根本不动。

```
class BallUpdate
{
    public BallUpdate(){}

    public void ballMotion(Ball x)
    {
        while(true)
        {
            x.moveBall();
            Thread.Sleep(30);
        }   
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:27:02.613

您需要初始化`ballUpdate`并启动`myThread`. 只有球的逻辑应该在单独的线程上。

```
public partial class Form1 : Form
    {
        Graphics paper;
        Paddle paddle = new Paddle();
        Ball ball = new Ball();
        Thread myThread;
        BallUpdate ballUpdate = new BallUpdate();

        public Form1()
        {
            InitializeComponent();
            myThread = new Thread(() => ballUpdate.ballMotion(ball));
            myThread.Start();
        }

        private void Form1_Paint(object sender, PaintEventArgs e)
        {
            paper = e.Graphics;
            paddle.drawPaddle(paper);
            ball.drawBall(paper);

        }
        private void timer1_Tick(object sender, EventArgs e)
        {
            //ball.moveBall();
            ball.collide();
            ball.hitPaddle(paddle.PaddleRec);
            this.Invalidate();
        } 
```

在 BallUpdate 中更改`if(true)`为`while(true)`以防止线程退出。加入延迟，这样你的球就不会飞起来。

```
class BallUpdate
{
    public BallUpdate(){}

    public void ballMotion(Ball x)
    {
        while(true)
        {
            x.moveBall();
            Thread.Sleep(10000);
        }   
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:11:23.480

我建议构建一个循环以下内容的线程方法：

1.  计算自上次计算以来的时间跨度（以毫秒为单位）
2.  相应地移动所有对象
3.  碰撞检查和解决
4.  调用 display 方法来渲染帧
5.  返回步骤 1

请不要在每一帧中创建一个新线程，这将有糟糕的性能。此外，不要在线程中操作图形对象。

# ios - CoreBluetooth [警告] 未知错误：iPhone 5 上的 14

> ID：15581684
> 
> 赞同：9
> 
> 时间：2013-03-22T23:58:03.700
> 
> 标签：ios, bluetooth, iphone-5, core-bluetooth

我可以使用 BLE 连接到外围设备，但在读取一些特性后不久，框架返回：

**CoreBluetooth [警告] 未知错误：14**

并且外围设备已断开。

查看 BT Core_V4.0 规范，我不确定错误的含义。14 是十六进制值吗？根据规范，这是否意味着以下错误：（D 部分第 2 部分 - 错误代码）

2.20 REMOTE DEVICE TERMINATED CONNECTION DUE TO LOW RESOURCES (0X14) Remote Device Terminated Connection due to Low Resources 错误代码表示远程设备由于资源不足而终止了连接。

我尝试更换电池，但没有不同的效果。

另外，我不知道如何捕捉这些 CB 错误，我只看到它们被记录，但是当设备断开连接时，它不会提供错误（它为空）。

我不直接控制外围设备的源代码，但可以要求修复错误。因此，任何提示都值得赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T09:19:35.900

您无法拦截这些 CB 错误，它们只是来自低层 BLE 的痕迹。

例如，错误 13 是写入数据的长度与 GATT 数据库中指定的长度不符。错误 14 表示连接已被另一端（外围设备）关闭。我已经看过好几次了。有时我读取数据的速度太快（在回答之前的问题之前，您不允许请求下一次访问，每个连接在 BLE 中只有 1 个“资源”。也许这就是您所看到的？

与往常一样，最好先安装 TI BTLE USB 加密狗并安装嗅探器软件，然后在 BLE 模式下使用 TI RF Sniffer 工具和该加密狗。您可以从这些跟踪中获得很多可以调试的信息。比如查看是否有多个读取或写入请求没有响应。

# java - 当设备从开发 PC 上拔下时，Android bindService 在 4.0.4 上失败

> ID：15581685
> 
> 赞同：0
> 
> 时间：2013-03-22T23:58:37.853
> 
> 标签：java, android, service, nexus-7

我有两台设备（运行 4.0.4 的三星 Galaxy Tab 10 和运行 4.2.1 的 Nexus 7）。我正在编写的应用程序使用 bindService/unbindService 一个在同一个应用程序中编写的服务来处理数据的持续管理，而不管活动状态如何。连接到启用了 USB 调试的 PC 的仿真器/设备按预期工作。一旦我拔下设备并尝试独立运行应用程序，它就不会出错或退出或任何东西都不会绑定，所以我的登录按钮在绑定完成之前在我的应用程序中不起作用. 这个绑定永远不会完成，我不知道为什么。有没有其他人经历过这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T19:58:25.403

对于将来可能遇到这种情况的任何人，我都将其包括在内。在我的情况下，这是失败的，因为后台服务正在等待调试器，这要归功于 android.os.waitForDebugger() 并且它正在超时。一条线可以把你的世界搞砸。我完全忘记了它在那里。

# java - Class.getResource() 返回 null

> ID：15581687
> 
> 赞同：12
> 
> 时间：2013-03-22T23:59:05.203
> 
> 标签：java, getresource

我正在尝试在 JPanel 上显示图片，但我不断收到错误消息：

> java.lang.IllegalArgumentException：输入 == 空！

我不明白发生了什么。

这是我正在使用的代码：

```
public void actionPerformed(ActionEvent e) {
    try {
        Image image=ImageIO.read(getClass().getResource("img/" +num.getText()+".jpg"));

        Image resized = image.getScaledInstance(200, 200, 100);
        pictureFrame.setIcon(new ImageIcon(resized));
    } catch (Exception ex){
        ex.printStackTrace();
    }
} 
```

这只会导致我收到错误消息！

堆栈跟踪产生以下内容：

```
Java.lang.IllegalArgumentException: input == null!
    at javax.imageio.ImageIO.read(ImageIO.java:1362)
    at work.Item.actionPerformed(Item.java:96)
    at javax.swing.AbstractButton.fireActionPerformed(AbstractButton.java:1995)
    at javax.swing.AbstractButton$Handler.actionPerformed(AbstractButton.java:2318)
    at javax.swing.DefaultButtonModel.fireActionPerformed(DefaultButtonModel.java:387)
    at javax.swing.DefaultButtonModel.setPressed(DefaultButtonModel.java:242)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(BasicButtonListener.java:236)
    at java.awt.Component.processMouseEvent(Component.java:6297)
    at javax.swing.JComponent.processMouseEvent(JComponent.java:3275)
    at java.awt.Component.processEvent(Component.java:6062)
    at java.awt.Container.processEvent(Container.java:2039)
    at java.awt.Component.dispatchEventImpl(Component.java:4660)
    at java.awt.Container.dispatchEventImpl(Container.java:2097)
    at java.awt.Component.dispatchEvent(Component.java:4488)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Container.java:4575)
    at java.awt.LightweightDispatcher.processMouseEvent(Container.java:4236)
    at java.awt.LightweightDispatcher.dispatchEvent(Container.java:4166)
    at java.awt.Container.dispatchEventImpl(Container.java:2083)
    at java.awt.Window.dispatchEventImpl(Window.java:2489)
    at java.awt.Component.dispatchEvent(Component.java:4488)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:668)
    at java.awt.EventQueue.access$400(EventQueue.java:81)
    at java.awt.EventQueue$2.run(EventQueue.java:627)
    at java.awt.EventQueue$2.run(EventQueue.java:625)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:98)
    at java.awt.EventQueue$3.run(EventQueue.java:641)
    at java.awt.EventQueue$3.run(EventQueue.java:639)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.AccessControlContext$1.doIntersectionPrivilege(AccessControlContext.java:87)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:638)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:269)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:184)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:174)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:169)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:161)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:122) 
```

我该如何解决这个问题？我检查了图像的位置，并从不同的位置尝试过，总是得到相同的错误！

我正在使用 Netbeans IDE。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-23T00:10:32.217

假设`getClass()`返回`com.foo.bar.MyActionListener`，`getClass().getResource("img/foo.jpg")`查找`foo.jpg`包中命名的文件`com.foo.bar.img`。如果图像不在此包中，或者如果它在此包中但其根目录不在类路径中，则该方法将返回 null。

如果 img 文件夹位于类路径的根目录下，则应使用`getClass().getResource("/img/foo.jpg")`（注意前导`/`）或`getClass().getClassLoader().getResource("img/foo.jpg")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-17T19:01:26.380

您应该提供源文件的相对路径。例如，如果你有这个：

```
src
 --img
 --classes 
```

你在`classes`文件夹中，你应该这样写：

```
getClass().getResource("../img/" +num.getText()+".jpg") 
```

# ios - 在 Instruments 中进行分析时，OpenGL ES 应用程序似乎运行得更快

> ID：15581688
> 
> 赞同：4
> 
> 时间：2013-03-22T23:59:12.237
> 
> 标签：ios, opengl-es, instruments

我不敢问这个问题，因为它不包含细节，也没有任何代码示例，但那是因为我在过去几周开发的三个完全不同的应用程序上遇到过这个问题，并且我在想特定的代码可能会使问题变得模糊。

在网上搜索并没有发现我遇到的现象，所以我将把它扔在那里，希望其他人也看到同样的事情：

“问题”是我构建的所有 iOS OpenGL 应用程序，对于一个人来说，当我在 Instruments 中对它们进行分析时，它们的运行速度要比它们独立运行时快得多。例如，帧速率大约快两倍（例如从 30fps 跳到 60fps）。这既可以通过代码计时循环来衡量，也可以通过观察应用程序运行来衡量。Instruments 似乎在做一些神奇的事情。

这是在设备上，而不是在 iOS 模拟器上。

如果我分析我的 OpenGL 应用程序并通过 Instruments 上传到设备（特别是运行 iOS 5.1 的 iPad 3），则帧速率会比独立运行快得多。似乎没有像这样的跳帧或恶作剧。它只是以大约两倍的速度进行相同的计算。

虽然我没有包含任何代码示例，但假设我正在做正常的事情。OpenGL ES 2.0，带有 VBO 和 VAO。使用调度队列/块对一些计算密集型代码区域进行多线程处理。没有异国情调或疯狂。

我只是想知道是否有人经历过类似的事情。如果没有，我会回到我的洞穴，继续用叉子刺自己的腿。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T00:27:55.323

可能是当您配置文件时，在您刚刚点击运行时使用发布版本（默认情况下）而不是调试版本。

# clojure - 给定一个偏序集，删除所有较小的项目

> ID：15581690
> 
> 赞同：2
> 
> 时间：2013-03-22T23:59:23.177
> 
> 标签：clojure

我正在努力寻找一种漂亮、惯用的方法来编写函数

```
(defn remove-smaller
  [coll partial-order-fn]
  ___
) 
```

where`partial-order-fn`接受两个参数并返回 -1 0 或 1 它们是可比较的（分别是更小、相等、更大）或`nil`其他。

的结果`remove-smaller`应该是 coll，所有小于 coll 中任何其他项目的项目都将被删除。

示例：如果我们定义了一个偏序，比如数字正常比较，字母也是，但是字母和数字是不可比较的：

```
1 < 2    a < t    2 ? a 
```

然后我们会有：

```
(remove-smaller [1 9 a f 3 4 z])
==> [9 z] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T02:16:31.830

```
(defn partial-compare [x y]
  (when (= (type x) (type y))
    (compare x y)))

(defn remove-smaller [coll partial-order-fn]
  (filter
    (fn [x] (every? #(let [p (partial-order-fn x %)]
                       (or (nil? p) (>= p 0)))
                    coll))
    coll))

(defn -main []
  (remove-smaller [1 9 \a \f 3 4 \z] partial-compare)) 
```

这将输出`(9 \z)`，这是正确的，除非您希望返回值与`coll`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T09:57:25.750

In practice I might just use tom's answer, since no algorithm can guarantee better than O(n^2) worst-case performance and it's easy to read. But if performance matters, choosing an algorithm that is *always* n^2 isn't good if you can avoid it; the below solution avoids re-iterating over any items which are known not to be maxes, and therefore can be as good as O(n) if the set turns out to actually be totally ordered. (of course, this relies on transitivity of the ordering relation, but since you call this a partial order that's implied)

```
(defn remove-smaller [cmp coll]
  (reduce (fn [maxes x]
            (let [[acc keep-x]
                  ,,(reduce (fn [[acc keep-x] [max diff]]
                              (cond (neg? diff) [(conj acc max) false]
                                    (pos? diff) [acc keep-x]
                                    :else [(conj acc max) keep-x]))
                            [[] true], (map #(list % (or (cmp x %) 0))
                                            maxes))]
              (if keep-x
                (conj acc x)
                acc)))
          (), coll)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T07:10:51.023

```
(def data [1 9 \a \f 3 4 \z])

(defn my-fn [x y]
  (when (= (type x) (type y))
    (compare x y)))

(defn remove-smaller [coll partial-order-fn] 
  (mapv #(->> % (sort partial-order-fn) last) (vals (group-by type data))))

(remove-smaller data my-fn)
;=> [9 \z] 
```

Potentially the order of the remaining items might differ to the input collection, but there is no order between the equality 'partitions'

# php - 如何使用 simplexml 更改命名空间元素的值？

> ID：15581693
> 
> 赞同：0
> 
> 时间：2013-03-22T23:59:40.297
> 
> 标签：php, xml, simplexml

我正在尝试更改 XML 值，然后将其另存为 XML。当我更改没有命名空间的元素时工作正常。问题是，当我要更改的值在命名空间中时；我可以找到并打印出来，但任何更改都会被忽略；像这样：

```
$ns = $xmlsingle->children('mynamespace');
foreach ($ns as $myelement)
{
    echo "my element is: [$myelement]";
    //I can change it:
    $myelement = "something else";
    echo "my element is now: [$myelement]"; //yay, value is changed!
}
//GREAT!
//But when I save the XML back, the value is not changed... apparently the children method creates a new object; not a link to the existing object
//So if I copy/paste the code above, I have the original value, not the changed value
$ns2 = $xmlsingle->children('mynamespace');
foreach ($ns2 as $myelement)
{
    echo "my element is UNCHANGED! [$myelement]";
}
//So my change's not done when I save the XML.
$xmlsingle->asXML(); //This XML is exacly the same as the original XML, without changes to the namespaced elements. 
```

**请忽略任何可能无法编译的愚蠢错误，我从原始代码中重新键入了文本，否则会太大；该代码有效，当我将其放回 XML 时，只是 NAMESPACED 元素的值没有改变。

我不是 PHP 专家，也不知道如何以任何其他方式访问命名空间元素……我该如何更改这些值？我到处搜索，但只找到如何读取值的说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:32:21.417

尝试这样的事情：

```
$xml = '
<example xmlns:foo="bar">
  <foo:a>Apple</foo:a>
  <foo:b>Banana</foo:b>
  <c>Cherry</c>
</example>';

$xmlsingle = new \SimpleXMLElement($xml);
echo "<pre>\n\n";
echo $xmlsingle->asXML();
echo "\n\n";

$ns = $xmlsingle->children('bar');
foreach ($ns as $i => $myelement){
    echo "my element is: [$myelement] ";

    //$myelement = "something else"; // <-- OLD
    $ns->$i = 'something else'; // <-- NEW

    echo "my element is now: [$myelement]"; //yay, value is changed!
    echo "\n";
}
echo "\n\n";
echo $xmlsingle->asXML();
echo "\n</pre>"; 
```

结果应该是：

```

      苹果
      香蕉
      樱桃

    我的元素是：[Apple] 我的元素现在是：[其他]
    我的元素是：[香蕉] 我的元素现在是：[别的]

      别的东西
      别的东西
      樱桃

```

希望这有帮助。

# javascript - 在 javascript 中使用关联数组

> ID：15581696
> 
> 赞同：1
> 
> 时间：2013-03-23T00:00:02.553
> 
> 标签：javascript, jquery

我想使用一个变量作为我的关联数组的索引

```
var usersName = []; // Just defining
userName[socket.id] = socket.name; // socket.id is an alphanumeric string 
```

我想使用那个`socket.id`（字符串）作为`usersName`数组的自定义索引，所以我可以获得连接到套接字的所有用户的列表。问题是我逃避变量的方式（我猜）。

我试过这个但没有用：

```
usersName ['\''+socket.id+'\''] = socket.name; 
```

这在 PHP 中有效，但是我无法让它在 javascript 中工作

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:21:33.607

你想要做的基本上是这样的：

```
// say socket = {id: 123, name: 'Bob'};
var foo = {}; // create an object
foo[socket.id] = socket.name; // put socket.name under foo.

var i;
for (i in foo) { //loop through list
   console.log(i, "is", foo[i]); //123 is Bob
} 
```

对？就像发布的评论一样，JS 没有“关联数组”，而是有更好的东西——伪经典对象。JavaScript 中的对象与 PHP 中的对象完全不同。在学习 JavaScript 时，您需要重新学习“对象”的含义。javascript 中的数组并不值得骄傲。它们本质上只是扩展了 Array 原型并具有特殊“长度”属性的对象。JS 中的数组还允许您通过执行 for(i =..; i..; i +=..) 循环来按顺序获取数据。除了 Array.prototype 的好处和以某种可靠顺序加载事物列表的能力之外，数组并没有那么特别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:19:36.803

希望这将按照您想要的方式工作。这是一种 PHP 风格：

**1**

```
var usersName = new Object();
usersName["123"] = 'Jane';
usersName["923"] = 'Charles';

for (var key in usersName) {
    console.log(key + ' => ' + usersName[key]);
} 
```

**2**

```
var usersName = {
    '123' : 'Jane',
    '923' : 'Charles'
};

for (var key in usersName) {
    console.log(key + ' => ' + usersName[key]);
} 
```

# ios - 为什么时间不自动更改为最新的分钟/小时？

> ID：15581697
> 
> 赞同：1
> 
> 时间：2013-03-23T00:00:04.180
> 
> 标签：ios, objective-c, nsdate, nsdateformatter

我正在构建一个用于练习的基本时钟应用程序，由于某种原因，时间不会自动更改为最新的分钟或小时。例如，当前时间是 17:56，但它显示的是 17:54，这是我打开应用程序的最后时间。

```
NSDate *now = [NSDate date];
NSDateFormatter *theOutput = [[NSDateFormatter alloc] init];
[theOutput setDateFormat:@"HH:mm"];
NSString *dateString = [theOutput stringFromDate:now];

NSString *time = [[NSString alloc] initWithFormat:@"The current time is %@", dateString];
[currentTime setText:time]; 
```

我到底做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:09:53.153

您显示的代码将数据和时间设置为该代码执行的时间。该代码中没有任何内容可以更新时钟。您是否每分钟调用一次此代码？如果不是，您需要使用 NSTimer 每分钟调用一次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:06:52.643

检查是否`currentTime`分配了变量。如果是，请致电：

```
[currentTime setNeedsDisplay]; 
```

设置文本后。

# java - 如何使用此 URL 同步时间 android

> ID：15581706
> 
> 赞同：0
> 
> 时间：2013-03-23T00:01:00.880
> 
> 标签：java, android, web-services, wsdl

我有一个 url 用于将服务器时间同步到我的应用程序，问题是如何做到这一点？任何人都可以向我解释在这里做什么，谢谢，我真的很感激。

这是 URL = [http://server10.instaforex.com:2012/TimeService/TimeService.svc/CurrentTime](http://server10.instaforex.com:2012/TimeService/TimeService.svc/CurrentTime)

这是我的主要活动代码。

```
public class MainActivity extends Activity {

    Timer timeoutTimer;
    final Random myRandom = new Random();
    GenerateTask genTask = new GenerateTask();
    static String RAN_TEXT = "text";

    class GenerateTask extends TimerTask {
        boolean started = false;
        public void run() {
            if (started) {
                System.out.println("generating");
                final TextView textGenerateNumber = (TextView)findViewById(R.id.generatenumber);
                RAN_TEXT = "";

                for(int k=0;k<7;k++){
                    RAN_TEXT += myRandom.nextInt(10) + " ";
                }
                runOnUiThread(new Runnable() {

                    @Override
                    public void run() {
                        textGenerateNumber.setText(RAN_TEXT);
                    }
                });
            }
        }
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Button buttonGenerate = (Button)findViewById(R.id.generateme);

        buttonGenerate.setOnClickListener(new OnClickListener(){

            @Override
            public void onClick(View v) {
                System.out.println("click");
                if (!genTask.started) {
                    genTask.started=true;
                    timeoutTimer = new Timer();
                    timeoutTimer.scheduleAtFixedRate(genTask, 0, 30000);
                } else {
                    genTask.started=false;
                    timeoutTimer.cancel();
                }
            }
       });  
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T02:01:51.003

您提供的 URL 返回 XML 文件，里面没有任何类似时间的东西，您最好要求另一个 URL 或给您这个的人的解释：

```
<wsdl:definitions name="TimeService" targetNamespace="TimeService">
<wsdl:types>
<xsd:schema targetNamespace="TimeService/Imports">
<xsd:import schemaLocation="http://server10.instaforex.com:2012/TimeService/TimeService.svc?xsd=xsd0" namespace="TimeService"/>
<xsd:import schemaLocation="http://server10.instaforex.com:2012/TimeService/TimeService.svc?xsd=xsd1" namespace="http://schemas.microsoft.com/2003/10/Serialization/"/>
</xsd:schema></wsdl:types><wsdl:message name="ITimeService_GetCurrentDateTime_InputMessage"><wsdl:part name="parameters" element="tns:GetCurrentDateTime"/>
</wsdl:message><wsdl:message name="ITimeService_GetCurrentDateTime_OutputMessage">
<wsdl:part name="parameters" element="tns:GetCurrentDateTimeResponse"/>
</wsdl:message><wsdl:portType name="ITimeService">
<wsdl:operation name="GetCurrentDateTime">
<wsdl:input wsaw:Action="TimeService/ITimeService/GetCurrentDateTime" message="tns:ITimeService_GetCurrentDateTime_InputMessage"/>
<wsdl:output wsaw:Action="TimeService/ITimeService/GetCurrentDateTimeResponse" message="tns:ITimeService_GetCurrentDateTime_OutputMessage"/>
</wsdl:operation></wsdl:portType><wsdl:binding name="BasicHttpBinding_ITimeService" type="tns:ITimeService">
<soap:binding transport="http://schemas.xmlsoap.org/soap/http"/>
<wsdl:operation name="GetCurrentDateTime">
<soap:operation soapAction="TimeService/ITimeService/GetCurrentDateTime" style="document"/>
<wsdl:input><soap:body use="literal"/>
</wsdl:input><wsdl:output><soap:body use="literal"/>
</wsdl:output>
</wsdl:operation>
</wsdl:binding>
<wsdl:service name="TimeService">
<wsdl:port name="BasicHttpBinding_ITimeService" binding="tns:BasicHttpBinding_ITimeService">
<soap:address location="http://server10.instaforex.com:2012/TimeService/TimeService.svc/basicHttpBinding"/>
</wsdl:port>
</wsdl:service>
</wsdl:definitions> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T03:58:31.740

URL 是指向 WSDL 文件的链接，该文件描述了如何使用他们的 Web 服务来获取时间。您需要使用某种工具来生成 Web Service 以获取时间，例如 Apache CXF。但是，当您在谈论Android时，那太重了...

# ms-word - 将大量带有数学类型方程和矢量图的 .doc 文件导出到带有嵌入式乳胶和 svg 的 html

> ID：15581708
> 
> 赞同：2
> 
> 时间：2013-03-23T00:01:18.727
> 
> 标签：ms-word, wmf, mathtype

我需要将数千个 .doc 文件转换为 HTML。这些文档包含 MathType 方程、Word 绘图（矢量图），而且绘图本身包含更多的方程对象。
通过 Microsoft.Office.Interop.Word，我设法将 .docs 保存为过滤的 HTML 和“未过滤的”HTML（最后一种模式具有生成多个 .wmz 文件的优势）。遗憾的是，MathType SDK 无法转换过程中生成的 wmz 文件中的每一个方程（SDK 附带的 wmf 示例被转换为 LaTeX 就好了..）。 **加起来：**

*   我需要知道哪些 wmf 文件是 MathType 方程，哪些是绘图；
*   我需要能够将作为 MathType 方程的 wmf 文件转换为 LaTeX。
*   我需要一些非常好的 wmf 到 svg 转换器来转换图纸，因为结果常常不符合我们的喜好；
*   我需要访问绘图中包含的数学类型方程。

所有这些都必须自动化，因为有数千个文件。
有这方面经验的人吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T10:28:26.510

WMZ 是 gzipped WMF，所以如果 WMF 到 LaTeX 的转换有效，然后尝试将 WMZ 文件解压缩为 WMF，然后将其转换为 LaTeX。

# java - Spring JDBC 一对一关系

> ID：15581719
> 
> 赞同：0
> 
> 时间：2013-03-23T00:02:41.437
> 
> 标签：java, spring, jdbc, spring-jdbc

我正在将 Spring JDBC 用于我正在处理的应用程序并且我遇到了一个问题。在我的域层中，我有字段；原始类型和对象关联。如果一个人属于一个自治市，我有：

```
public class Person {

    private Municipality municipality;

    // More code
}

public class Municipality {
    // More code
} 
```

在数据库中，您使用主键 + 外键对此进行建模。在这种情况下，person 表有一个外键指向市政表的主键。我为个人和市政当局创建了一个存储库。现在我想检索一个人，但我也想同时将市政当局连接到它。

我要做的第一件事是找到使用 Person 存储库的人。然后我想找到属于这个人的市政府。但是目前我没有在我的域对象中建模的外键。`private int municipality_id`这意味着，我在 Person 类中没有字段。这将导致域对象与数据库耦合（至少现在是这样）。

发出另一个查询只是为了找到 cityity_id 感觉不正确。我怎么解决这个问题？但是，我需要 cityity_id 才能找到市政府。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:09:57.560

以下是一些可能的选择。

1.  在 person 对象上包含市政府 ID。听起来您对这种方法有疑问。这不打扰我。我会简单地将 id 与查询中的其他人数据一起带回。
2.  发出第二个查询以获取市政府，然后在 person 对象上填充市政府。我也不认为这种方法有任何问题。
3.  将两个表连接在一起并带回两个对象的数据。在您的映射器中，您将创建一个城市对象并将其设置为人员对象。

# c# - 从触摸屏重定向/重新映射/预过滤光标输入

> ID：15581721
> 
> 赞同：16
> 
> 时间：2013-03-23T00:02:56.640
> 
> 标签：c#, windows-7, touch, touchscreen, mouse-cursor

## 我的问题

好的，对此的基本答案是使用：

```
Cursor.Clip = new Rectangle(x1, y1, x2, y2); 
```

但我的问题有点复杂。

我需要它做的是正确地将自身映射到特定的窗口边界，以便触摸输入将被限制到该窗口，但会**正确地将自身剪辑到窗口，以便当我触摸左上角或右下角时触摸屏的一角，它会将光标置于窗口的左上角或右下角。**使用`Cursor.Clip`不会这样做，并且我在触摸屏上触摸到该剪切区域之外的所有内容都将映射到我触摸的窗口最近的边缘。

有什么可以让我预先过滤鼠标位置以便我可以正确调整它的边界吗？

## 如果一切都失败了

或者，我可以尝试找到一些将鼠标输入转换为**TUIO**输入并以这种方式将其输入应用程序的代码，但我希望我不必这样做。因此，如果有人知道我如何做到这一点，那么如果我最初的请求不可行，那将很有帮助。

## 对于那些想知道我在做什么的人

如果您需要确切地知道我这样做的原因，我基本上是在尝试将来自触摸屏的鼠标事件输入到视频中的 3D 应用程序中，该应用程序可以接收将绘制的触摸输入（通过普通鼠标事件或 TUIO）到该视频，但无法最大化屏幕的完整分辨率，因为它只会渲染设置为输出的大小。

## 明确

*   我不介意一只普通的老鼠被这些东西打乱。
*   我说的是使用默认 Windows 7 Touch 的 Windows 7 系统
*   输入是通过 USB 输入的，而不是串行的或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T10:14:41.457

您可以使用 Reactive Extensions 来剪辑触摸事件

```
var movingEvents = 
      Observable.FromEventPattern<MouseEventHandler, MouseEventArgs>(
        h => this.MouseMove += h, h => this.MouseMove -= h)
          .Select(x => x.EventArgs.Location)
          .Where(location =>
               location.X >= viewPort.Location.X 
                  && location.X <= viewPort.Location.X + viewPort.Width
                  && location.Y >= viewPort.Location.Y 
                  && location.Y <= viewPort.Location.Y + viewPort.Height);

movingEvents.Subscribe(update);

public void update(Point p)
{
    textBox1.Text = p.ToString();
} 
```

[http://www.codeproject.com/Articles/52308/The-Rx-Framework-By-Example](http://www.codeproject.com/Articles/52308/The-Rx-Framework-By-Example)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-02T20:54:22.277

安装低级鼠标挂钩可能会起作用，因为 Windows 8 之前的触摸屏通常会尽可能地伪装成鼠标。

参见例如[http://www.codeproject.com/Articles/7294/Processing-Global-Mouse-and-Keyboard-Hooks-in-C](http://www.codeproject.com/Articles/7294/Processing-Global-Mouse-and-Keyboard-Hooks-in-C)

# asp.net - 我的 Azure 网站关闭时访问被拒绝错误（删除缓存项）

> ID：15581727
> 
> 赞同：0
> 
> 时间：2013-03-23T00:04:05.930
> 
> 标签：asp.net, caching, azure, azure-web-app-service, asp.net-cache

我的应用在 Azure**网站**上运行良好（**不是 Web 角色**，请排除 Web 角色特定的答案！），但有时我的日志中出现以下错误：

```
System.UnauthorizedAccessException: Access to the path 'C:\DWASFiles\Sites\myAzureWebSiteNameHere\VirtualDirectory0\site\wwwroot' is denied.
   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
   at System.IO.FileSystemEnumerableIterator`1.CommonInit()
   at System.IO.FileSystemEnumerableIterator`1..ctor(String path, String originalUserPath, String searchPattern, SearchOption searchOption, SearchResultHandler`1 resultHandler, Boolean checkHost)
   at System.IO.Directory.EnumerateFiles(String path)
   at System.Web.WebPages.Deployment.WebPagesDeployment.AppRootContainsWebPagesFile(String path)
   at System.Web.WebPages.Deployment.PreApplicationStartCode.OnChanged(String key, Object value, CacheItemRemovedReason reason)
   at System.Web.Caching.CacheEntry.CallCacheItemRemovedCallback(CacheItemRemovedCallback callback, CacheItemRemovedReason reason) 
```

这发生在站点重新启动之前（由 Azure，而不是我，可能是为了对包含站点的 VM 进行维护操作）。所以我得出的结论是它发生在“关闭”操作期间，当系统尝试清除缓存时。

我正在使用这样的 Asp.net 缓存：`HttpContext.Current.Cache[myKey] = something`并且我**没有**定义任何特定的回调，例如`CacheItemRemovedCallback`. 上面的调用堆栈确认错误在系统回调中。

它似乎是特定于 Azure 的（甚至可能特定于 Azure 网站），因为本地服务器上的同一个网站从未出现过这种错误。

你知道如何防止这个错误发生吗？谢谢 ！

# jquery - onmouseover 向左和向右扩展图像边

> ID：15581729
> 
> 赞同：0
> 
> 时间：2013-03-23T00:04:31.443
> 
> 标签：jquery, html, css

我正在尝试扩展图像的左侧和右侧。例如，如果图像大小为 1100px 宽度，则部分左右将被扩展。我不想进行完整的图像扩展。

```
<div class="side_left"></div>
<div class="mid_container"></div>
<div class="side_right"></div> 
```

**在这里你可以看到我的代码：http:** [//jsfiddle.net/squidraj/EgHGm/](http://jsfiddle.net/squidraj/EgHGm/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:22:07.543

我相信这应该做你想要的：http: [//jsfiddle.net/hLMTW/](http://jsfiddle.net/hLMTW/)

```
.mid_container {
    background: url(http://www.jeffreyhomesinc.com/images/banner%202.png) -35px 0 no-repeat;
    height: 245px;
    margin: auto 35px;
    width: 1030px;
    float:left;
}

.mid_container:hover {
    background-position: 0 0;
    margin: 0;
    width: 1100px;
} 
```

如果您希望为过渡设置动画，可以使用 CSS 动画：

```
.mid_container:hover {
    background-position: 0 0;
    margin: 0;
    width: 1100px;
    animation-duration: 3s;
    animation-name: slide;
}

@keyframes slide {
    from {
        background-position: -35px 0;
        margin: 0 35px;
        width: 1030px;
    }
    to {
        background-position: 0 0;
        margin: 0;
        width: 1100px;
    }
} 
```

当然需要注意的是，悬停效果在低级浏览器上根本不起作用，尽管所有主要浏览器的最新版本都支持它。您可以通过使用 -moz 和 -webkit 前缀复制它来扩展对效果的支持。这个小提琴（[http://jsfiddle.net/hLMTW/5/](http://jsfiddle.net/hLMTW/5/)）包括向后兼容前缀。

如果它解决了您的问题，请接受答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:35:25.983

在你的CSS中，你把

```
background-position: "center center"; 
```

. 它将您的背景图像居中到中心

剩下的只是扩展 div [http://jsfiddle.net/EgHGm/1/](http://jsfiddle.net/EgHGm/1/)

将 div 居中放在中间，应该没问题

# shell - 阻塞 shell 脚本的执行流程，直到前面的进程完成？

> ID：15581730
> 
> 赞同：1
> 
> 时间：2013-03-23T00:04:42.197
> 
> 标签：shell, scripting

我有一份我想并行运行的作业列表，我从一个主脚本中调用它们。这是一个例子

```
echo "Starting jobs"
job1 &
job2 &
job3 &

# I want to wait until job1, job2 & job3 finishes on the multi core box
echo "Now I can proceed" 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T00:07:03.153

`wait`是命令。除非等待作业完成，否则不会继续执行。

```
echo "Starting jobs"
job1 &
job2 &
job3 &

wait

# I want to wait until job1, job2 & job3 finishes on the multi core box
echo "Now I can proceed" 
```

# android - 在 TextView 上设置 Scroller 以进行垂直滚动

> ID：15581733
> 
> 赞同：1
> 
> 时间：2013-03-23T00:05:02.947
> 
> 标签：android, textview, vertical-scrolling, scroller

我正在尝试通过在其上设置 Scroller 来实现一种垂直滚动的 TextView。以下代码适用于我运行 Android 2.3 的设备，但不适用于运行 Android 级别 15 的设备。任何想法为什么？

```
Private TextView tenthsTxt;
Private Scroller tenthsScroller;
....

tenthsTxt = (TextView)findViewById(R.id.tenths);
LinearInterpolator scrollerInterpolator = new LinearInterpolator();
tenthsScroller = new Scroller(this, scrollerInterpolator);
tenthsTxt.setScroller(tenthsScroller);
tenthsScroller.startScroll(0,0,0, 59);
tenthsTxt.invalidate();

.... 
```

TextView 的 xml 如下所示：

```
 <TextView 
    android:id="@+id/tenths"
    android:background="@drawable/tenths_digit_holder"
    android:text="0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n0"
    android:textSize="25dp"
    android:gravity="center"
    android:paddingTop="5dp"
    android:paddingBottom= "5dp"        
    android:layout_width = "30dp"
    android:textStyle="normal"
    android:layout_height="43dp"                
    android:textColor="#ffff0000" /> 
```

在 Android 2.3 上，TextView 以正确的量垂直滚动。在运行 4.03 的 Android 设备上，TextView 根本不滚动。可以肯定的是，还使用了缩放到设备像素密度的 y 位移 - 结果是相同的，在 Android 4.03 设备上没有观察到滚动运动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T11:22:50.853

```
<ScrollView 
    android:id="@+id/scrollView"
    android:layout_width="300dp"
    android:layout_height="100dp"
    android:scrollHorizontally="false"
    android:ems="10">
    <TextView 
            android:id="@+id/textView"
        android:layout_width="match_parent"
        android:textAppearance="?android:attr/textAppearanceMedium" 
        android:layout_height="match_parent"/>
</ScrollView> 
```

scrollView 的大小固定，并且 textView 的高度与它们的父级对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-12T04:01:51.350

我知道你想要什么。这是您需要的一个很好的源代码示例：

它包含以下内容：

垂直自动滚动文本条目 ListView ListView 侦听器 15+ 命令（真的很容易添加更多） 基本用户界面 假文件系统按钮侦听器等等... 在此处下载源代码：

[http://www.fileswap.com/dl/0L8nU0kSFD/](http://www.fileswap.com/dl/0L8nU0kSFD/)

如果你想看看它是什么样子的，请看这里：

[https://play.google.com/store/apps/details?id=com.coGame.consoletest&hl=en](https://play.google.com/store/apps/details?id=com.coGame.consoletest&hl=en)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T11:29:39.000

你也可以通过编程来做到这一点

```
 txtView.setMovementMethod(new  ScrollingMovementMethod()); 
```

# php - 在字符串 php 正则表达式之后获取数字

> ID：15581734
> 
> 赞同：1
> 
> 时间：2013-03-23T00:05:14.883
> 
> 标签：php, regex

我正在使用 PHP 来解析电子邮件并希望获取特定字符串之后的数字：例如，我想从此字符串中获取数字 033：

```
 Account Number: 033 
 Account Information: Some text here 
```

总是有单词 Account Number: 然后是数字，然后是换行符。我有：

```
 preg_match_all('!\d+!', $str, $matches); 
```

但这只是得到所有的数字......

任何帮助都会很棒！谢谢

编辑：

文本是 HTML ......这可能是问题所在：

```
 <font face="Arial, Helvetica, sans-serif" color="#000099"><strong><font color="#660000">Account 
     Number</font></strong><font color="#660000">: 033<br>
    <strong>Account Name</strong>: More text here<br> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-23T00:11:30.777

如果数字总是在后面`Account Number:` （包括末尾的那个空格），那么只需将其添加到您的正则表达式中：

```
preg_match_all('/Account Number: (\d+)/',$str,$matches);
// The parentheses capture the digits and stores them in $matches[1] 
```

结果：

```
$matches Array:
(
    [0] => Array
        (
            [0] => Account Number: 033
        )

    [1] => Array
        (
            [0] => 033
        )

) 
```

**注意：**如果存在 HTML，则*可以*将其包含在正则表达式中，只要您不相信 HTML 会发生变化。否则，我建议使用[HTML DOM Parser](http://simplehtmldom.sourceforge.net/)来获取字符串的纯文本版本并从那里使用正则表达式。

*话虽如此*，以下是在正则表达式中包含 HTML 并提供与上述相同的输出的示例：

```
// Notice the delimiter 
preg_match_all('@<font face="Arial, Helvetica, sans-serif" color="#000099"><strong><font color="#660000">Account 
Number</font></strong><font color="#660000">: (\d+)@',$str,$matches); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-23T00:12:20.990

```
$str = 'Account Number: 033 
 Account Information: Some text here';

preg_match('/Account Number:\s*(\d+)/', $str, $matches);

echo $matches[1]; // 033 
```

您也不需要使用`preg_match_all()`您没有通过将匹配放在括号中来将其放入反向引用中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T00:45:00.407

以 HTML 为基础：

```
$str = '<font face="Arial, Helvetica, sans-serif" color="#000099"><strong><font
    color="#660000">Account Number</font></strong><font color="#660000">: 033<br>
    <strong>Account Name</strong>: More text here<br>';
preg_match_all('!Account Number:\s+(\d+)!ims', strip_tags($str), $matches);
var_dump($matches); 
```

我们得到：

```
array(2) {
    [0]=>
    array(1) {
        [0]=>
        string(19) "Account Number: 033"
    }
    [1]=>
    array(1) {
        [0]=>
        string(3) "033"
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-28T08:37:51.030

@montes`strip_tags()`在使用正则表达式提取目标子字符串之前适当地调用以清理/简化输入文本。但是，该模式可以进行一些改进，并假设每封电子邮件只有一个帐号，您不应该使用`preg_match_all()`, 而是`preg_match()`.

*   不需要不区分大小写，因此`i`模式修饰符没有意义。
*   模式中没有`^`或`$`元字符，所以`m`模式修饰符没有用。
*   模式中没有`.`元字符，所以`s`模式修饰符没有用。
*   `\K`重新开始全串匹配。这是有益的，因为它消除了使用捕获组的必要性。

代码：（[演示](https://3v4l.org/GsuWK)）

```
$html = '<font face="Arial, Helvetica, sans-serif" color="#000099"><strong><font
    color="#660000">Account Number</font></strong><font color="#660000">: 033<br>
    <strong>Account Name</strong>: More text here<br>';

echo preg_match('~Account Number:\s*\K\d+~', strip_tags($html), $match)
     ? $match[0]
     : 'No Account Number Found'; 
```

输出：

```
033 
```

# javascript - queue.js：函数数组和闭包数组之间的区别？

> ID：15581736
> 
> 赞同：1
> 
> 时间：2013-03-23T00:05:24.690
> 
> 标签：javascript, asynchronous, queue, meteor

因此，我试图确保在尝试将数据呈现到可视化之前发生一系列 HTTP GET 请求。典型的交易，对吧？

我正在使用 queue.js，并在 queue.js github 页面（[https://github.com/mbostock/queue](https://github.com/mbostock/queue)）上看到了这个：

> *或者，如果您想连续运行大量异步任务（这里表示为闭包数组）：*

```
 var q = queue(1);
    tasks.forEach(function(t) { q.defer(t); });
    q.awaitAll(function(error, results) { console.log("all done!"); }); 
```

> *Queue.js 可以在 Node.js 或浏览器中运行。*

因此，我所做的是创建了一个函数数组，每个函数都包含一个 Meteor.http.get 调用（因为我使用的是 Meteor.js），然后逐行执行。

似乎正在发生的事情是，虽然我的数组——其中有 8 个函数，每个插槽中都有正确的函数——被填充（然后像在代码中一样传递给 defer，）只有一个实际运行。

这就是我想知道的。好吧，总的来说，为什么只有一个函数在运行，尽管传递了 8 个函数来延迟？但具体来说——对闭包有一个模糊的理解，我真的有很多函数。有什么我错过的吗，因为文档特别提到了闭包，这就是为什么所有函数都没有执行的原因？

谢谢你看这个！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:32:38.633

这可能是您在测试套件中引用的语句的字面部分：

```
"queue of asynchronous closures, processed serially": {
    topic: function() {
        var tasks = [], 
            task = asynchronousTask(),
            n = 10,
            q = queue(1);

        while (--n >= 0) tasks.push(task);

        tasks.forEach(function(t) { q.defer(t); });

        q.awaitAll(this.callback)
    },
    "does not fail": function(error, results) {
        assert.isNull(error);
    },
    "executes all tasks in series": function(error, results) {
        assert.deepEqual(results, [1, 1, 1, 1, 1, 1, 1, 1, 1, 1]);
    }
}, 
```

[https://github.com/mbostock/queue/blob/master/test/queue-test.js#L103](https://github.com/mbostock/queue/blob/master/test/queue-test.js#L103)

哪个运行`task = asynchronousTask()`，哪个是从队列中拉出并调用的

```
function asynchronousTask() {
    var active = 0;

    return function(callback) {
        ++active;

        process.nextTick(function() {
            try {
                callback(null, active);
            } finally {
              --active;
            }
        });
    };
} 
```

上面，inner`return function() {...}`是我认为被引用为*闭包*的，它在每个异步函数都被从队列中调用时，*在范围内*保留它对外部变量的引用。`active`

当然，这在回调和处理程序方面相当强大，因为它为您提供了维护和操作本地共享变量的方法，例如，如果您想知道返回了多少函数，以及列表何时用尽. 换句话说，一个队列。

以下在上面的示例中没有使用，但将其用作参考点，看看它与`synchronousTask`上面的功能有何不同。

```
function synchronousTask() {
    var active = 0;

    return function(callback) {
        try {
            callback(null, ++active);
        } finally {
            --active;
        }
    };
} 
```

[https://github.com/mbostock/queue/blob/master/test/queue-test.js#L265](https://github.com/mbostock/queue/blob/master/test/queue-test.js#L265)

# java - C# 相当于创建实现接口的匿名类

> ID：15581737
> 
> 赞同：8
> 
> 时间：2013-03-23T00:05:28.253
> 
> 标签：java, c#, interface, anonymous-class

我最近开始使用 C#，我想找到一个等效的方法。我不知道这叫什么，所以我将简单地通过代码向您展示。

使用 Java，我能够创建这样的接口：

```
public interface Event {
    public void execute();
} 
```

并在方法的参数中传递此接口，如下所示：

```
public class TestEvent {
    ArrayList<Event> eventList = new ArrayList<Event>();

    public void addEvent(Event event){
        eventList.add(event);
    }

    public void simulateEvent(){
        addEvent(new Event() {
            public void execute(){
                //functionality
            }
        } );
    }

    public void processEvents(){
        for(Event event : eventList)
            eventList.execute();
    }
} 
```

**编辑**：我的问题是关于类的`simulatEvent`方法`TestEvent`，如果 C# 可以执行这样的操作。

我想知道是否有办法用 C# 做类似的事情（在`simulateEvent`方法中实例化接口）以及实际调用的是什么。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T00:32:05.753

呜呜……好吧，请允许我概括一下：

所以在Java中，你需要一种方法来传递函数。Java 本身并不支持作为一等公民的函数，这是实现**匿名类**背后的一个原因- 封装的函数组可以内联声明并传递（作为接口）到方法/其他类，然后调用这些函数.

在 C# 中，函数是一等公民，可以声明为`Delegates`、`Func<>s`或`Action<>s`。让我们尝试比较（各种）：

某种 Java-y 构造（我的 Java 相当老，所以请耐心等待）：

```
public interface IDoSomething {
    public int Return42();
    public bool AmIPrettyOrNot(string name);
    public void Foo();
} 

public void Main(String[] args) {
    DoStuff(new IDoSomething() {
        public int Return42() { return 42; }
        public bool AmIPrettyOrNot(string name) { return name == "jerkimball"; }
        public bool Foo(int x) { ... }
    });
}

public void DoStuff(IDoSomething something) { ... } 
```

C# 中的（非常粗略的）等价物是：

```
public void Main(string[] args)
{
    Func<int> returns42 = () => 42;
    Func<string,bool> amIPretty = name => name == "jerkimball";
    Action<int> foo = x => {};
} 
```

现在，正如其他人所提到的，在处理事件时，您通常会在 Java 端看到这种模式——在 C# 端也是如此：

```
 public class Foo 
 {
     // define the shape of our event handler
     public delegate void HandlerForBarEvent(object sender, EventArgs args);
     // declare our event
     public event HandlerForBarEvent BarEvent;

     public void CallBar()
     {
         // omitted: check for null or set a default handler
         BarEvent(this, new EventArgs());
     }
 }    

 public void Main(string[] args)
 {
      var foo = new Foo();
      // declare the handler inline using lambda syntax
      foo.BarEvent += (sender, args) => 
      {
           // do something with sender/args
      }
      foo.CallBar();
 } 
```

请注意，我们也可以给它一些具有相同“形状”的东西：

```
 public void MyHandler(object sender, EventArgs args)
 {
     // do stuff
 }
 public void Main(string[] args)
 {
      var foo = new Foo();
      // that method above is the same "shape" as HandlerForBarEvent
      foo.BarEvent += MyHandler;
      foo.CallBar();
 } 
```

但它也在 Java 中用于定义线程做什么，如果内存服务（即，`Runnable`） - 我们也可以在 C# 中这样做：

```
var thread = new Thread((Action)(() => 
     {
         // I'm the threads "run" method!
     });
thread.Start(); 
```

现在，其他的东西 - 枚举：

```
public void processEvents(){
    for(Event event : eventList)
        eventList.execute();
} 
```

C# 有同样的想法，只是叫法不同：

```
public void processEvents()
{
    // edit: derp, 'event' is a keyword, so I'm
    // renaming this, since I won't get into why
    // you could also use @event...
    foreach(var evt in eventList)
    {
        evt.Execute();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T00:08:15.650

编辑：看起来你的问题是关于匿名接口实现而不是事件。您可以使用内置`Action`委托类型而不是您的`Event`接口。

然后，您可以`Action`使用 lambda 表达式进行实例化。您的代码如下所示：

```
public class TestEvent
{
    List<Action> eventList = new List<Action>();

    public void addEvent(Action event){
        eventList.add(event);
    }

    public void simulateEvent(){
        addEvent(() => {
        });
    }

    public void processEvents(){
        for(Action event : eventList)
            event();
    }
} 
```

您可以使用`delegate`语法而不是使用`() => { .. .}`ie `delegate() { ... }`in `simulateEvent`。

C# 不支持匿名接口实现，所以如果你的接口有多个方法，那么你必须在某个地方定义一个具体的类。根据使用情况，您可以让此类包含您可以在创建时提供的委托属性，例如

```
public class Delegates
{
    public Action Event { get; set; }
    public Func<string> GetValue { get; set; }
} 
```

然后，您可以像这样创建它：

```
var anon = new Delegates
{
    Event = () => { ... },
    GetValue = () => "Value"
} 
```

# r - 将列表中的 NaN 值替换为零 (0)

> ID：15581743
> 
> 赞同：17
> 
> 时间：2013-03-23T00:06:50.550
> 
> 标签：r, nan

嗨亲爱的我有一个问题`NaN`。我正在处理一个包含许多变量的大型数据集，并且它们具有`NaN`. 数据是这样的：

```
z=list(a=c(1,2,3,NaN,5,8,0,NaN),b=c(NaN,2,3,NaN,5,8,NaN,NaN)) 
```

我使用此命令将列表强制为数据框，但我得到了这个：

```
z=as.data.frame(z)
> is.list(z)
[1] TRUE

> is.data.frame(z)
[1] TRUE
> replace(z,is.nan(z),0) 
Error en is.nan(z) : default method not implemented for type 'list' 
```

我强迫 z 到数据框，但这还不够，也许`NaN`列表中有一个表格可以改变。谢谢你的帮助。这个数据只是一个例子，我的原始数据有 36000 个观察值和 40 个变量。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-03-23T00:08:43.723

这是一个完美的用例`rapply`。

```
> rapply( z, f=function(x) ifelse(is.nan(x),0,x), how="replace" )
$a
[1] 1 2 3 0 5 8 0 0

$b
[1] 0 2 3 0 5 8 0 0 
```

`lapply`也可以，但`rapply`在这种情况下可以正确处理嵌套列表。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-23T00:32:58.813

由于您似乎不介意将数据放在数据框中，因此您也可以做一些高度矢量化的事情。但是，这仅在每个列表元素长度相等时才有效。我在您的数据（`36000/40 = 900`）中猜测是这种情况：

```
z <- as.data.frame(z)
dim <- dim(z)
y <- unlist(z)
y[ is.nan(y) ] <- 0
x <- matrix( y , dim )
#        [,1] [,2]
#   [1,]    1    0
#   [2,]    2    2
#   [3,]    3    3
#   [4,]    0    0
#   [5,]    5    5
#   [6,]    8    8
#   [7,]    0    0
#   [8,]    0    0 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-23T00:09:35.980

**按照 OP 的编辑：**按照您编辑的标题，应该这样做。

```
unstack(within(stack(z), values[is.nan(values)] <- 0))
#   a b
# 1 1 0
# 2 2 2
# 3 3 3
# 4 0 0
# 5 5 5
# 6 8 8
# 7 0 0
# 8 0 0 
```

`unstack``data.frame`如果结果输出的长度相等，则会自动为您提供 a （与第一个示例不同，如下所示）。

* * *

**旧解决方案（用于连续性）。**

尝试这个：

```
unstack(na.omit(stack(z)))
# $a
# [1] 1 2 3 5 8 0

# $b
# [1] 2 3 5 8 
```

注意1：从您的帖子看来，您想用0替换NaN。 的输出`stack(z)`，可以将其保存到变量中，然后替换为0，然后就可以了`unstack`。

注 2：此外，由于 na.omit 删除了 NA 以及 NaN，我还假设您的数据不包含 NA（来自您上面的数据）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-15T18:18:34.287

```
z = do.call(data.table, rapply(z, function(x) ifelse(is.nan(x),0,x), how="replace")) 
```

如果您最初有 data.table 并且想要 1-line 替换。

但请记住，之后需要重新定义键：

```
> key(x1)
[1] "date"
> x1 = do.call(data.table, rapply(x1, function(x) ifelse(is.na(x), 0, x), how="replace"))
> key(x1)
NULL 
```

# c# - 查找字符串中所有出现的子字符串

> ID：15581745
> 
> 赞同：2
> 
> 时间：2013-03-23T00:06:53.250
> 
> 标签：c#

我有一个文本文件，其中包含以下内容：

```
_vehicle_12 = objNull;
if (true) then
{
  _this = createVehicle ["Land_Mil_Guardhouse", [13741.654, 2926.7075, 3.8146973e-006], [], 0, "CAN_COLLIDE"];
  _vehicle_12 = _this;
  _this setDir -92.635818;
  _this setPos [13741.654, 2926.7075, 3.8146973e-006];
}; 
```

我想查找和之间的所有匹配项`{`并`};`分配以下字符串：

```
string direction = "_this setDir" value, in example _vehicle_12 it would mean that:
string direction = "-92.635818";

string position = "_this setPos" value, in example _vehicle_12 it would be:
string position = "[13741.654, 2926.7075, 3.8146973e-006]"; 
```

我有多次出现这些类型，并且想找出每次`{ };`发生时设置方向和位置并移动到下一个事件的最佳方法。

以下代码可以读取字符串（将文件保存在一个大字符串中）并且它发现第一次出现很好，但是我想对其进行调整以查找 { 和 } 的每次出现；

```
string alltext = File.ReadAllText(@file);
string re1 = ".*?"; // Non-greedy match on filler
string re2 = "(\\{.*?\\})"; // Curly Braces 1

Regex r = new Regex(re1 + re2, RegexOptions.IgnoreCase | RegexOptions.Singleline);
Match m = r.Match(alltext);
if (m.Success)
{
    String cbraces1 = m.Groups[1].ToString();
    MessageBox.Show("Found vehicle: " + cbraces1.ToString() + "\n");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:35:49.490

1.  想一个可能有效的正则表达式
2.  测试一下。
3.  如果不起作用，请修改并返回步骤 2。
4.  你有一个有效的正则表达式:-)

为了让你开始：

```
\{\n([0-z\[\]" ,-\.=]+;\n)+\} 
```

应该返回花括号内的各个行。

# xcode - 如何根据宏定义隐藏代码？

> ID：15581750
> 
> 赞同：3
> 
> 时间：2013-03-23T00:07:15.357
> 
> 标签：xcode, macros

使用 VisualStudio/Resharper，我们获得了一个有用的功能，它可以根据宏定义隐藏代码（或将其转换为另一种颜色）。例如：

```
#ifdef DEBUG

if(!is_DEBUG_defined)
{
   // Make code gray
   // Or hide it!
}

#endif 
```

有没有办法在 XCode 中有这种行为？我注意到在这种情况下，如果未定义宏，则`#ifdef`/`#endif`语句中定义的任何变量/函数在 XCode 的自动完成之外都不可用，但如果还有视觉指示该代码实际上不会是，这将非常有用编译。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-09T13:15:08.813

显然 Xcode 已经这样做了——但在某些主题上很难看到。使用默认主题，非预处理部分的源代码是纯黑色的。

暂时将你的主题更改为“Dusk”（Xcode->Preferences->Fonts&Colors），然后非预处理部分的代码将变为纯白色，这样更容易看到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-09T13:36:02.423

是的，同样的代码`objective c`也在工作中。像：

```
#ifdef DEBUG
   //your code
#endif 
```

# architecture - DCOM 单例替换

> ID：15581755
> 
> 赞同：0
> 
> 时间：2013-03-23T00:08:06.417
> 
> 标签：architecture, asp-classic, singleton, communication, dcom

我们有一个旧的遗留 Web 应用程序。该架构包括：

1.  （经典）为客户浏览器提供服务的 ASP 页面；VB脚本，数以千计
2.  由 ASP (IIS) 调用的进程外 DCOM 服务器；MFC、单例、exe
3.  数据库; 一种或多种模式
4.  调用 DCOM 服务器的补充 ASP.NET 应用程序

服务器的角色是：

*   处理用户登录、注销和许可
*   保留用户会话信息
*   生成 UI
*   保护/授权用户操作
*   在数据库中检索和存储数据

由于服务器的角色众多，ASP（IIS）和DCOM服务器之间的调用接口相当广泛，并且在许多页面中被大量使用。
主要**问题在于 IIS 调用 DCOM 服务器**，并且随着更新的 Windows 服务器变得更大。从 Windows server 2008 开始，这种组合几乎完全不可维护。使用 UAC，即使是单例进程外 DCOM 服务器也无法工作（不同的进程在不同的安全上下文中启动）。

我想保留服务器的 MFC/C++ 代码并将其作为单例运行（尽管有所有缺点）。那些许多 ASP 页面是应用程序中最动态且始终在变化的部分，我希望它们保持不变。我可能会牺牲补充的 ASP.NET 应用程序。

**服务器的单例进程外 DCOM 接口的最佳替代品是什么？**我认为性能和未来的维护是最重要的。

（我可以看到一个相同的 .Net 接口作为 COM 替代品，但我主要关心的是在我的第一次迭代中保持它的单进程单例。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T01:57:02.190

这个问题对于 SO 来说有点开放......但我很久以前使用了以下技术，做一个 Java-to-COM 桥。HTH...

我知道代码有效，因为您愿意保留大部分代码。您在缩放单例模式时遇到问题。

因此，将您的单身人士分成两部分。

首先，将您的单例作为服务（或在 COM+ 中）运行。向该进程添加一个小的 shim（在其自己的线程上运行），它接收 HTTP 请求并将它们转换为进程内 COM 调用。由于您已经在进程外工作，因此跨线程编组应该不是问题。看看[Mongoose](https://code.google.com/p/mongoose/)的 HTTP 部分。它是一个单一的 C 文件，可以让您立即运行概念证明。

其次，（从头开始）编写一个普通的、非单例的、进程内的 COM 对象，该对象实现与服务器相同的接口。该存根只会将它接收到的 COM 调用转换为对 HTTP 帖子的调用到真正的单例。

+确保您的 shim 不在公共接口上监听！

# matlab - 如何在没有“isempty”破解的情况下在 Matlab 函数中获得持久计数器？

> ID：15581769
> 
> 赞同：1
> 
> 时间：2013-03-23T00:09:17.203
> 
> 标签：matlab

我想在函数中添加一个计数器，以便它知道它被调用了多少次。

这是我目前正在使用的。

```
function Foo ()
persistent counter;
if (isempty(counter))
     counter = 0
end 

counter = counter + 1
end 
```

第 3-5 行看起来像 hack。

如何在不重置或使用 isempty 的情况下直接将计数器初始化为 0？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T03:11:23.853

Merlin，`isempty(marker)`应该是`isempty(counter)`，但我确定这就是你的意思。[如果您查看此处](http://www.mathworks.com/help/matlab/ref/persistent.html)和[此处](http://www.mathworks.com/help/simulink/ug/defining-and-initializing-persistent-variables.html)，您拥有的代码就是 matlab 文档推荐的代码。此外，这也是 Loren[使用](http://blogs.mathworks.com/loren/2006/03/29/understanding-persistence/)的。所以你所拥有的是正确的（对不起，如果这个答案不令人满意）。

# javascript - CSS display:inline 防止元素刷新

> ID：15581771
> 
> 赞同：0
> 
> 时间：2013-03-23T00:09:38.053
> 
> 标签：javascript, html, css, inline

我的项目中有一个时钟插入到一个 div 中，对我来说，它被呈现为“内联”非常重要。事实上，AM/PM 单元就在它旁边，我希望它随着时钟变短而移动（即 11:11 而不是 22:22）。

所以我将它的属性设置为 display: inline; 像这样 ：

```
.time{
    display: inline;
    position: relative;
    cursor: pointer;
    z-index: 1;
    font-size: 50pt;    
} 
```

am/pm 元素也是如此：

```
.ampm{
    display: inline;
    cursor: pointer;
    position: relative;
    z-index: 1;
    font-size: 18pt;
    top: -40px;
} 
```

这是 HTML 文件：

```
<div class="timeDate">
    <div class="hour"><div id="time" class="time"></div><div id="ampm" class="ampm"></div></div>
    <div id="date" class="date"></div>
</div> 
```

至少，不断更新它的Javascript代码：

```
setInterval('checkTime()', 1000);

function checkTime(){
    currentTime = new Date();
    _minutes = currentTime.getMinutes();
    _hours = currentTime.getHours();
    _day = currentTime.getDay();
    _date = currentTime.getDate();
    _month = currentTime.getMonth();
    time.innerHTML = _hours + ":" + _minutes;
    ampm.innerHTML = ampmValue;
} 
```

它适用于 display: block; 另外，当我添加秒数时，我可以看到它更新，但只有 10 次中有 2 次。你知道为什么，我该如何解决？提前致谢 ！

这是我的项目的链接（仅限 Chrome）：[http](http://acemond.free.fr/FEZAcetheme/BETA/FEZ_Lockscreen_1.2-3.theme/LockBackground.html) : //acemond.free.fr/FEZAcetheme/BETA/FEZ_Lockscreen_1.2-3.theme/LockBackground.html 它是为了在本地工作，所以完全加载页面，然后重新加载（你会保留缓存）

嗯，好吧……有点找到出路了……

```
if(mode12h) time.innerHTML = _hours + ":" + _minutes + "<sup><font size='5'>" + ampmValue + "</font></sup>";
else time.innerHTML = _hours + ":" + _minutes; 
```

看起来很简单，但那段代码的问题是分配给时钟的 .click 函数将不再正常工作。所以我添加了一个空控件，最重要的是为了接收点击。它有效，不知道为什么。

**编辑**：找到了一个更好的方法来做到这一点：

```
hours.innerHTML = _hours + ":" + _minutes + "<span class='ampm'>" + ampmValue + "</span>"; 
```

与相关的 CSS：

```
.ampm{
    position: absolute;
    z-index: 1;
    height: 75px;
    text-align: center;
    width: 40spx;
    font-size: 20pt;    
} 
```

我以前这样做过，但正如我所说的那样，它阻止了 .click 函数正常工作。但现在它与我在上面添加的管理点击的面板配合得很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:16:33.947

是否可以像添加一样简单：

```
var time = document.getElementById('time');

var ampm = document.getElementById('ampm')` 
```

在做之前

```
time.innerHTML = _hours + ":" + _minutes;
ampm.innerHTML = ampmValue; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:37:34.677

好的，这段代码对我有用：http: [//jsfiddle.net/3xyYh/1/](http://jsfiddle.net/3xyYh/1/)

```
setInterval(checkTime, 1000); 
```

删除了 checkTime 调用周围的引号，但也许这也不是问题？然而，这对我来说很好用 display: inline。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T01:01:16.560

您应该将 应用于`display: inline;`您的父元素`.timeDate`

**编辑：** 好的！我看过你的时钟，我发现了一些东西：你应该给你的元素浮动。见下文：

```
.ampm {
    cursor: pointer;
    display: inline;
    float: right;
    font-size: 18pt;
    margin-top: 0;
    position: relative;
    z-index: 1;
    top: 20px;
    right: 2px;
}

.time {
    cursor: pointer;
    display: inline;
    float: left;
    font-size: 45pt;
    position: relative;
    z-index: 1;
} 
```

# javascript - 如何在不导致浏览器加载新页面的情况下编写/更改查询字符串

> ID：15581774
> 
> 赞同：0
> 
> 时间：2013-03-23T00:09:53.293
> 
> 标签：javascript, jquery, url

我可以编写查询字符串的第一种技术是使用提交的表单。

我想在没有重定向的情况下更改 url。

旧网址是

本地主机：8080

并在 Url 中自动添加 foo=1&foo=2 （变量 s）

本地主机:8080?=foo=1&foo=2

还有其他写作技巧或手段吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T00:31:54.257

[您可以使用HTML5 历史 API](http://diveintohtml5.info/history.html)操作位置 url 。不幸的是，这只适用于适当的浏览器。

或者，您可以在 URL 中使用井号 (#) 代替问号。在你的情况下`localhost:8080#foo=1&bar=1`使用`location.href = '#foo=1&bar=1';`例如。

不知道这是否可能在您的情况下。

# javascript - 高级用户的网络应用程序架构

> ID：15581780
> 
> 赞同：0
> 
> 时间：2013-03-23T00:10:34.907
> 
> 标签：javascript, node.js, mongodb, express

我有一个很大的问题。

我有一个 web 应用程序，我在 nodejs 中完成的普通用户添加到数据库时，他们可以登录并更改您的个人详细信息，例如标题、描述、订单、密码，但我想添加高级用户，并且那个高级具有特殊功能的用户可以更改数据库中没有的东西。例如您的 ID、您的电子邮件地址、删除您的对话等。

问题是这些功能是根据高级用户要求创建的。也就是说，我需要一种仅为特定用户创建功能的方法。

例如... ANDRES 用户是高级用户。ANDRES 只需要创建和删除评论。此外，用户是原始 JOSE，JOSE 需要在您的博客内创建文件夹。

我想知道如何为 jose 制作只有 jose 才能使用的功能。

编辑 1

这篇[文章](https://stackoverflow.com/questions/12781619/storing-form-schemas-and-functions-in-a-database)可能是解决方案，但任何人都可以解释我如何使用示例？

# php - PDO 和 PHP OOP 代码建议

> ID：15581782
> 
> 赞同：2
> 
> 时间：2013-03-23T00:11:05.987
> 
> 标签：php, oop, class, methods, pdo

我对 PHP 面向对象编程非常陌生，所以想知道是否可以就我创建的数据库对象获得一些好的建议。

我调用类**db**并将我的类包含到每个页面加载中并启动数据库对象`using $db = new db`。然后我为我可能需要的每个操作（从数据库构建菜单，获取登录信息等）调用其中的方法，并根据我想要做什么使用不同的参数。

它将它的第一个参数作为带有 ? 的查询。符号作为我要绑定的值的替换，第二个参数是要在数组中绑定到它的值，然后在prepared_statement方法中循环，第三个参数是类型（ FETCH_ARRAY 返回一个SELECT语句行的数组， NUM_ROWS 返回受影响的行数，INSERT 返回最后插入的 ID）。

下面是我如何调用此函数的示例：

```
$db->prepared_execute( "SELECT * FROM whatever WHERE ? = ? ", array( 'password', 'letmein' ), NUM_ROWS ); 
```

如果没有要绑定的参数或不需要返回，则第二个和第三个参数是可选的。

由于我是 OOP 的新手，我发现很难准确了解何时正确使用以及什么是公共、私有、静态函数/变量和设计模式（Singleton 等）。

我已经阅读了许多教程以达到我所拥有的程度，但我觉得现在我需要把它带到这里以获得进一步的答案或建议，了解下一步如何使用 OOP 以及我已经建立的这门课程。

它按原样工作，这对我来说是一个很好的起点，除了我将在接下来添加的任何错误处理，但我想确保我没有在这里犯任何明显的设计错误。

该类的代码如下：

```
class db {

var $pdo;

public function __construct() {

$this->pdo = new PDO('mysql:dbname=' . DB_NAME . ';host=' . DB_HOST . ';charset=utf8', DB_USER, DB_PASS);
$this->pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
$this->pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

}

public function prepared_execute( $query, $bind_values = null, $type = null ) {

$preparedStatement = $this->pdo->prepare( $query );

if( $bind_values ) {

$i = 1;

foreach( $bind_values as $bind_value ) {

$preparedStatement->bindValue($i, $bind_value);

$i++;

} }

$preparedStatement->execute();

if(     $type == FETCH_ARRAY ) { return $preparedStatement->fetchAll();  }

elseif( $type == NUM_ROWS ) { return $preparedStatement->rowCount();     }

elseif( $type == INSERT   ) { return $this->pdo->lastInsertId();         }

else{   return true; }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:55:08.337

你的代码有点过时了。您应该使用[可见性关键字](http://www.php.net/manual/en/language.oop5.visibility.php)之一，而不是`var`声明您的属性。在这种情况下，您可能希望使用`protected`它以使其不能从类外部进行修改，但以便将来的任何子类都可以在内部对其进行修改。您可能还需要添加一个 getter，以防您需要直接使用 PDO（您将 - 请参阅我的类示例下方的最后陈述）。

在课堂上硬编码你的 PDO 连接信息是不好的。您应该将这些作为参数传递，就像直接使用 PDO 一样。我还将添加传递预配置 PDO 实例的功能。

虽然不是必需的，但符合[PSR-0 到 PSR-2](https://github.com/php-fig/fig-standards/tree/master/accepted)是个好主意；具体而言，在您的情况下，我正在谈论类和方法命名，它们都应该是 camelCase 并且该类的第一个字符应该是大写字母。与此相关的是，您的代码格式也很丑陋，尤其是您的块语句...如果这只是复制和粘贴的问题，请忽略该注释。

所以总的来说我会重构你的代码看起来像这样：

```
class Db {

  protected $pdo;

  public function __construct($dsn, $user, $pass, $options = array()) {

    if($dsn instanceof PDO) {
      // support passing in a PDO instance directly
      $this->pdo = $dsn;

    } else  {

      if(is_array($dsn)) {
        // array format
        if(!empty($options)) {
          $dsn['options'] = $options;
        }

        $dsn = $this->buildDsn($options);
      } else {
        // string DSN but we need to append connection string options
        if(!empty($options)) {
          $dsn = $this->buildDsn(array('dsn' => $dsn, 'options' => $options));
        }
      }

      // otherwise just use the string dsn
      // ans create PDO

      $this->pdo = new PDO($dsn, $user, $pass);
    }

    // set PDO attributes
    $this->pdo->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    $this->pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
  }

  public function getConnection()
  {
    return $this->pdo;
  }

  protected function buildDsn($options) {

    if($isDbParts = isset($options['dbname'], $options['hostname']) || !($isDsn = isset($option['dsn']))) {
      throw new Exception('A dsn OR dbname and hostname are required');
    }

    if($isDsn === true) {
      $dsn = $options['dsn'];
    } else if {
      $format = '%s:dbname=%s;host=%s';
      $driver = isset($options['dbtype']) ? $options['dbtype'] : 'mysql';
      $dsn = sprintf($format, $options['dbtype'], $options['dbname'], $options['host']);
    }

    if(isset($options['options'])) {
      $opts = array();

      foreach($options['options'] as $name => $value) {
        $opts[] = $name . '=' . $value;
      }

      if(!empty($opts)) {
        $dsn .= ';' . implode(';', $opts);
      }
    }

    return $dsn; 
  }

  public function preparedExecute( $query, $bind_values = null, $type = null ) {

    $preparedStatement = $this->pdo->prepare( $query );

    if( $bind_values ) {

      $i = 1;

      foreach( $bind_values as $bind_value ) {

        $preparedStatement->bindValue($i, $bind_value);

        $i++;
      } 
    }

    $preparedStatement->execute();

    if( $type == FETCH_ARRAY ) { 
      return $preparedStatement->fetchAll();  
    }
    elseif( $type == NUM_ROWS ) { 
      return $preparedStatement->rowCount();     
    }
    elseif( $type == INSERT   ) { 
      return $this->pdo->lastInsertId();         
    }
    else {   
      return true;  
    }

  }
} 
```

最后，除非这只是出于教育目的，否则我不会这样做。有大量不同的查询具有不同的零件装配，这里没有考虑，所以在某些时候这不会支持你需要它做的事情。相反，我会使用 Doctrine DBAL、Zend_Db 或类似的东西，它们将通过其 API 支持更大的查询复杂性。简而言之，不要重新发明轮子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:16:46.770

我开发了类似的东西，它可以帮助你。

```
public function select($sql, $array = array(), $fetchMode = PDO::FETCH_ASSOC){      
    $stmt = $this->prepare($sql);

    foreach ($array as $key => $value){
        $stmt->bindValue("$key", $value);
    }

    $stmt->execute();
    return $stmt->fetchAll();
}

public function insert($table, $data){
    ksort($data);

    $fieldNames = implode('`,`', array_keys($data));
    $fieldValues = ':' .implode(', :', array_keys($data));

    $sql = "INSERT INTO $table (`$fieldNames`) VALUES ($fieldValues)";

    $stmt = $this->prepare($sql);

    foreach ($data as $key => $value){
        $stmt->bindValue(":$key", $value);
    }

    $stmt->execute();
} 
```

# javascript - 如何在 jquery ui 模式对话框小部件内从外部 url 动态加载内容？

> ID：15581787
> 
> 赞同：9
> 
> 时间：2013-03-23T00:11:28.653
> 
> 标签：javascript, jquery, jquery-ui

我之前问过这个问题，但我认为我没有正确解释我想要完成的事情。

我的网站上有多个链接，我想从 jquery ui 模态对话框小部件中的链接打开内容。

我正在尝试使用“this”来引用用户动态选择的链接。我在这里做错了什么？

我正在使用的代码如下：

```
<a href="index.cs.asp?Process=comments&id=1" id="test">comment #1</a>
<a href="index.cs.asp?Process=comments&id=2" id="test">comment #2</a>
<a href="index.cs.asp?Process=comments&id=3" id="test">comment #3</a>
<div id="somediv"></div>                                    
    <script type="text/javascript">

    $(document).ready(function() {  

        $("#somediv").load(this.getTrigger().attr("href")).dialog({
            autoOpen: false,
            width: 400,
            modal: true
        });     
        $("#test").click(function(){$( "#somediv" ).dialog( "open" );});
});

</script> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-23T00:45:10.753

[http://jsfiddle.net/qp7NP/](http://jsfiddle.net/qp7NP/)

一些更改：将 ID 更改为 Class 并使用 IFrame。

```
<a href="http://wikipedia.com/" class="test">comment #1</a><br>
<a href="http://ebay.com/" class="test">comment #2</a><br>
<a href="http://ask.com/" class="test" >comment #3</a><br>
<div id="somediv" title="this is a dialog" style="display:none;">
    <iframe id="thedialog" width="350" height="350"></iframe>
</div>
<script>
$(document).ready(function () {
    $(".test").click(function () {
        $("#thedialog").attr('src', $(this).attr("href"));
        $("#somediv").dialog({
            width: 400,
            height: 450,
            modal: true,
            close: function () {
                $("#thedialog").attr('src', "about:blank");
            }
        });
        return false;
    });
});
</script> 
```

如果您想引入 HTML 而不是 IFrame，则必须使用 Ajax (XMLHttpRequest)，如下所示：http: [//jsfiddle.net/qp7NP/1/](http://jsfiddle.net/qp7NP/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:22:28.593

您不能有多个具有相同 ID 的元素。改为将链接更改为`class="test"`，因此将点击事件更改为`$('.test').click()`。

另外，如果您仍然有问题，我记得我遇到了一些类似的问题，因为 JQUery Dialog 是如何处理 DOM 的。它会从字面上撕掉您的#somediv 内容并将其附加到页面底部以显示该对话框。我通过将其包装在另一个 div 中解决了我的动态对话框加载问题。

```
<div id="somediv-wrap">
  <div id="somediv">

  </div>
</div>

<script>
    $(document).ready(function() {  

        $("#somediv-wrap").dialog({
                  autoOpen: false,
                   width: 400, 
                   height:200,
                   modal: true
                  });  

        $(".test").click(function(event)
          {
              event.preventDefault();
              var link = $(this).attr('href');

              $("#somediv").load(link,function(){
               $( "#somediv-wrap" ).dialog( "open" );   
              });                        
      });
   });
</script> 
```

# javascript - 注入 JavaScript 以在网站上使用？

> ID：15581791
> 
> 赞同：-2
> 
> 时间：2013-03-23T00:11:47.590
> 
> 标签：javascript, iphone, ios, xcode, uiwebview

我对 iOS 编程的整个 Web 方面完全陌生，所以请耐心等待：P。我的目标是从网站上获取一个 JavaScript 文件，然后“注入”该脚本，以便我可以使用它登录另一个网站。我不确定我的做法是否是“最好的”，所以如果你发现它们有不好的地方，请告诉我！:D

因此，在我的应用程序中，我们从一个视图开始，其中用户有两个文本框和一个提交按钮。一个用于用户名的文本框，一个用于密码的文本框。当用户点击提交时，我想加载页面，将输入的用户名和密码放在 HTML 页面上的正确位置！

```
- (IBAction)signInTouched:(id)sender {

    if (userName.text.length > 0 && pass.text.length > 0)
    {
        NSString *theSite = @"www.thesite.com";

        NSURL *theURL = [NSURL URLWithString:theSite];
        NSURLRequest *loginRequest = [[NSURLRequest alloc] initWithURL:theURL];

        [webView loadRequest:loginRequest]; // Webview is the web view :P

        NSURL *jsSite = [NSURL URLWithString:@"www.ThePlaceWithTheJS"];

        NSString *jsString = [NSString stringWithContentsOfURL:jsSite encoding:NSUTF8StringEncoding error:nil];

        [webView stringByEvaluatingJavaScriptFromString:jsString];

        NSString *userValue = userName.text;
        NSString *passValue = pass.text;
        NSString *javaFunction = [NSString stringWithFormat:@"login(%@,%@)", userValue, passValue]; // login is the function in the javascript

        [webView stringByEvaluatingJavaScriptFromString:javaFunction];  

    }

    } 
```

然后，这里是 JS 文件：

```
<script type='text/javascript'>
function login(username,password){
    var usernameBox = document.getElementById("ctl00_plnMain_txtLogin");
    usernameBox.value = usernameBox.value + username;

    var passwordBox = document.getElementById("ctl00_plnMain_txtPassword");
    passwordBox.value = passwordBox.value + password;

}
</script> 
```

所以，问题是我不知道我是否做得很好，或者如何让它正常工作。每当我测试它时，文本都不会加载到网站上的字段中。所以它显然在某个地方出错了......但是在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:41:44.007

```
 [webView stringByEvaluatingJavaScriptFromString:jsString]; 
```

此调用尝试执行您的 javascript

但是，此时 jsString 包含`<script>`标签，不应该在 .js 文件中使用，标签在 HTML 中使用所以在评估时`<script>`出现错误

只需删除 .js 文件中的开始和结束标记，就可以了。

此外，如果不是真的有必要，这也不是很好的方法，因为您通过同步加载脚本来延迟 webview 的加载时间

您还应该在异步模式下获取您的 .js 文件，并在收到评估此文件和您对登录功能的调用后

# c# - 无法在 silverlight 客户端中打开信号器连接

> ID：15581802
> 
> 赞同：1
> 
> 时间：2013-03-23T00:13:22.070
> 
> 标签：c#, silverlight, signalr

我正在尝试根据此博客在 Silverlight 中实现 SignalR：[SignalR 和 Silverlight](http://chris.59north.com/post/2011/12/15/SignalR-and-Silverlight.aspx)。

当我尝试 .Invoke() 时，出现运行时错误“System.InvalidOperationException：必须先调用 Start 方法才能发送数据。在 Microsoft.AspNet.SignalR.Client.Connection.Send(String data) 在 Microsoft.AspNet .SignalR.Client.Hubs.HubProxy.Invoke[T](String 方法，Object[] args)..."

我的连接上有 _conn.Start() 。如果我在调用之前再次尝试 Start() 它，它会引发异常。这是我的代码：

```
 private IHubProxy _hub;
    private HubConnection _conn;

    public AddProductView()
    {
        InitializeComponent();
        var url = Application.Current.Host.Source.GetComponents(UriComponents.Scheme | UriComponents.HostAndPort,
                                                                UriFormat.Unescaped);
        _conn = new HubConnection(url);
        _hub = _conn.CreateHubProxy("SilverlightPrism.Mvc.Services.ProductHub");
        _hub.On<string>("NewMessage", message => Deployment.Current.Dispatcher.BeginInvoke(() => DoAddItem(message) ));
        _conn.Start();
    }

    private void DoAddItem(string item)
    {
        var product = DeserializeToProduct(item);
        ProductData.Products.Add(product);
    }

    private void buttonAdd_Click(object sender, RoutedEventArgs e)
    {
        Random random = new Random();
        var id = Guid.NewGuid();
        var product = new Product
            {
                Price = random.Next(1000,100000),
                ProdId = id,
                ProdName = "New prod."
            };
        var jsonMessage = SerializeToJsonString(product);
        _hub.Invoke("SendMessage", jsonMessage);
    } 
```

它在 _hub.Invoke(); 上抛出异常；

如何正确连接集线器并发送消息？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T00:30:03.730

`HubConnection.Start` is asynchronous. You cannot call `Start` right before `Invoke` because your `HubConnection` is probably still in the `Connecting` state.

You need to wait for the `Task` returned from `Start` to complete before you can call `IHubProxy.Invoke`. You can use `await` (or `Task.ContinueWith` if you aren't running .NET 4.5) to ensure `Start` finishes before you enable `buttonAdd`.

You could also create your `AddProductView` object asynchronously in a factory method. Instead of calling `HubConnection.Start` in the constructor, you could do it in a static `Task<AddProductView> CreateAddProductView()` method.

Alternatively, if you don't care about the creation of your `AddProductView` being asynchronous, you can just call `Start` synchronously:

```
_conn.Start().Wait(); 
```

# abap - Web Dynpro for ABAP 说明文本（绿色下划线）不适用于某些用户

> ID：15581808
> 
> 赞同：1
> 
> 时间：2013-03-23T00:13:53.660
> 
> 标签：abap, webdynpro

我最近在 SRM 合同屏幕上的某些字段（包括标准字段和自定义字段）中添加了说明文本。我进行单元测试的用户工作正常，但是大多数其他用户不能工作。经过调查，我发现不仅仅是我添加的说明文字，而是所有说明文字都丢失了。

![在此处输入图像描述](../Images/b490830a6fede5ce71a06b4b3e01a7c6.png)

根据[sap help entry](http://help.sap.com/saphelp_crm70/helpdata/EN/45/11e345459d7201e10000000a155369/content.htm)该行为类似于我对**Help mode = off**的期望。

是否可以根据每个用户（或角色）打开或关闭帮助模式，我应该在哪里找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-01T18:20:36.370

您已经找到它：SAP 帮助说：“您可以在门户中的个人设置或关联的 URL 参数中激活帮助模式”......意味着在个人设置中，但我觉得您希望全局而不是个人base 或在关联的 URL 参数中。后者意味着您必须在门户内容中找到应用程序，在那里您可以找到 URL 参数，我会尝试添加 HELPMODE=ON... 这对您有帮助吗？首先右键单击您的应用程序“技术帮助”或“..Help”，然后查看您要查找的应用程序。然后谷歌应用程序并添加+“门户内容”，我想你会找到它。问候， zy

# javascript - Ajax请求调用后不设置全局变量

> ID：15581810
> 
> 赞同：0
> 
> 时间：2013-03-23T00:14:16.960
> 
> 标签：javascript, ajax, variables, global-variables

我正在尝试在 Javascript 中进行 AJAX 调用以获取两个值。然后我想全局使用这些值进行一些计算，然后将结果打印出来。以下是我的代码。

```
 // my calculation functions will go here

   var value1 = 0;
   var value2 = 0;
   MakeRequest(); //after makeRequest() value1 and value2 should be 10 and 20 respectively.
   var total = value1 + value2;
   console.log(total); // this is still zero. because value1 and value2 are still 0.

//request AJAX
    function createXMLHTTPObject(){
        var ajaxRequest;  // The variable that makes Ajax possible!

        try{
            // IE 7+, Opera 8.0+, Firefox, Safari
            ajaxRequest = new XMLHttpRequest();
            return ajaxRequest;
        } catch (e){
            // Internet Explorer
            try{
                ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
                return ajaxRequest;
            } catch (e) {
                try{
                    // Internet Explorer 5, 6
                    ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                    return ajaxRequest;
                } catch (e){
                    // Something went wrong
                    alert("Your browser broke!");
                    return false;
                }
            }
        }
    }

    // Create a function that will receive data sent from the server
    function AjaxRequest(url,callback,method){
        var req = createXMLHTTPObject();
        req.onreadystatechange= function(){
                if(req.readyState != 4) return;
                if(req.status != 200) return;
                callback(req);
        }
        req.open(method,url,true);
        req.send(null);
    }

    function AjaxResponse(req){
        var respXML=req.responseXML;
        if(!respXML) return;
        value1=respXML.getElementsByTagName("value1")[0].childNodes[0].nodeValue;
        value2= respXML.getElementsByTagName("value2")[0].childNodes[0].nodeValue;
        console.log("the value1 is "+ value1);  //successfully print the values
        console.log("the value2 is "+ value2);
    } 

    function MakeRequest(){
         AjaxRequest("values.xml",AjaxResponse,"get");
    } 
```

1.  所以我的第一个问题是为什么total = value 1 + value2 仍然为0。我已经将它们设为全局变量，然后在makeRequest() 中更新了value1 和value2，但它似乎不影响值。我该怎么做才能更新 value1 和 value2 以便在这些函数之外使用它们。

2.  基本上，我从在线教程中复制了 ajax 请求代码。这里有一件事我不明白。当我调用 MakeRequest() 函数时，它调用 AjaxRequest("values.xml",AjaxResponse,"get"); 但是，AjaxReponse(req) 在这里需要一个参数“req”。但是 AjaxRequest("values.xml",AjaxResponse,"get") 里面的 AjaxResponse 没有放参数。它仍然有效。这是为什么？我真的很理解这部分。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T00:18:20.923

因为 AJAX 调用是**异步**的，这意味着您的代码会像这样实时运行：

```
var value1 = 0;
var value2 = 0;
MakeRequest();           // AJAX REQUEST is made, that will happen on its on timeline
var total = value1 + value2;
console.log(total);     // still will be 0 at this point, since AJAX response has not returned

// MakeRequest will fire AJAX request and WHEN THE REQUEST IS SUCCESSFUL, it can modify value1 and value2, then calculate total 
```

`total = value1 + value2`应该在您的 AJAX 请求成功返回后计算，*如果*您想要`value1`并且`value2`依赖于 AJAX 请求的结果。

# vba - 使用 Excel VBA 管理 SharePoint 文档库

> ID：15581813
> 
> 赞同：1
> 
> 时间：2013-03-23T00:14:41.547
> 
> 标签：vba, excel, sharepoint-2010

自从在 Excel VBA 中弃用 SharedWorkspace 对象以来，我一直无法找到执行相同任务的替代方法。注意 Excel VBA 是我可以访问的唯一开发工具。不过，我确实有 SharePoint Designer。

Microsoft 是否提供了任何东西来替换 SharedWorkspace 对象提供的功能？

我的大部分任务都涉及遍历文档库中的文档。例如，查看哪些已签出，等等。使用 SharedWorkspace 对象很容易做到这一点。谁能告诉我在没有 SharedWorkspace 对象的情况下使用 VBA 的方法吗？

我发现我可以在我的 VBA 代码中使用 SharePoint Designer 参考来完成该任务，但这需要我打开 SharePoint Designer UI，这对于我的需要来说花费的时间太长。（为什么 SharePoint Designer 应用程序对象没有像其他 Office 应用程序那样的可见属性？那会有所帮助）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T23:11:49.500

SharePoint 提供了一组丰富的 Web 服务来与网站上的内容进行交互。要遍历文档库中的所有文档，可以使用[GetListItems Web 服务](http://msdn.microsoft.com/en-us/library/lists.lists.getlistitems%28v=office.12%29.aspx)。这将要求您编写代码来调用 Web 服务。 [XMLHTTP](http://msdn.microsoft.com/en-us/library/windows/desktop/ms759148%28v=vs.85%29.aspx)是这样做的一种“简单”方式。如果您需要代码示例，请告诉我。

# sql - 使用 BULK INSERT 在 SQL Server 上插入空字符串

> ID：15581814
> 
> 赞同：4
> 
> 时间：2013-03-23T00:14:42.413
> 
> 标签：sql, sql-server, sql-server-2012, bulkinsert

示例表包含字段`Id`（表的标识，整数）；`Name`（一个允许空值的简单属性，它是一个字符串）

我正在尝试包含以下内容的 CSV：

> 1、
> 
> 1,""
> 
> 1，''

由于批量插入，它们都没有给我一个空字符串。我正在使用 SQL Server 2012。

我能做些什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T08:06:47.417

据我所知，批量插入不能插入空字符串，它可以保留空值或使用带有keepnulls选项或不带keepnulls选项的默认值。对于您的 3 条示例记录，插入数据库后，它应该是：

```
    | 编号 | 姓名
    | 1 | 空值
    | 1 | “”   
    | 1 | ''   

```

原因是，批量插入会将您的第一行、第二列值视为 null；对于其他 2 行，将第二列值视为不为空，并按原样处理。

**而不是让批量插入为您插入空字符串值，您可以让您的表格列具有默认值作为空字符串。**

示例如下：

```
 CREATE TABLE BulkInsertTest (id int, name varchar(10) DEFAULT '') 
```

```
将相同的 CSV 文件批量插入表中
```

```
BULK INSERT Adventure.dbo.BulkInsertTest
   FROM '....\test.csv'
   WITH 
      (
         FIELDTERMINATOR ='\,',
         ROWTERMINATOR ='\n'
      )
   SELECT * FROM BulkInsertTest 
```

结果将如下所示：（CSV 中的第一行将获得一个空字符串）

```
    | 编号 | 姓名
    | 1 |   
    | 1 | “”   
    | 1 | ''   

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-03T10:55:49.653

请记住，仅当您不使用选项 KEEPNULLS 时，才会插入指定的 DEFAULT 值。使用与上面相同的示例，如果您将选项添加`KEEPNULLS`到`BULK INSERT`，即：

```
BULK INSERT BulkInsertTest
FROM '....\test.csv'
WITH 
(
    FIELDTERMINATOR ='\,',
    ROWTERMINATOR ='\n',
    KEEPNULLS
) 
```

将导致默认列值被忽略并从空字符串中插入 NULL，即：

```
SELECT * FROM BulkInsertTest 
```

现在会给你：

```
id  name
1   NULL
1   ""
1   '' 
```

在您的示例中添加它似乎没有充分的理由`KEEPNULLS`，但我刚才遇到了一个类似的问题，`KEEPNULLS`在`BULK INSERT`.

`[name]`我的解决方案是在临时表中定义 make 列，`BulkInsertTest` `NOT NULL`但请记住 DEFAULT 列值被忽略，而是插入一个空字符串。

在此处查看更多信息：[在批量导入期间保留 Nulls 或 UseDefault 值（SQL Server）](http://technet.microsoft.com/en-us/library/ms187887.aspx)

# ruby - 未定义的方法“有效吗？” 为了 ＃

> ID：15581815
> 
> 赞同：0
> 
> 时间：2013-03-23T00:14:50.417
> 
> 标签：ruby, testing, rspec

为什么会出现此错误？怎么修？

```
 1) User should exist
     Failure/Error: User.should be_valid
     NoMethodError:
       undefined method `valid?' for #<Class:0x94b626c> 
```

测试是：

```
require 'spec_helper'

describe User do
  it "should exist" do
    User.should be_valid
  end 
  it "should not allow me to create a new user without required fields" do
    User.new(:email => 'bob').should_not be_valid
  end 

end 
```

第二个测试工作正常，我怎样才能让第一个通过？我只是想让它检查模型是否存在

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:21:16.577

测试一个类隐式地测试它是否存在。如果类不存在，两个代码示例都会出错。第一个是不必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:17:10.150

在第一个测试中替换`User.should be_valid`为。`User.new.should be_valid`RSpec 正在调用`valid?`User 类而不是它的实例。

# ruby-on-rails - 在亚马逊 EC2 上使用 capistrano 部署到生产环境时，资产不会预编译

> ID：15581820
> 
> 赞同：13
> 
> 时间：2013-03-23T00:15:35.917
> 
> 标签：ruby-on-rails, deployment, amazon-ec2, capistrano, asset-pipeline

我致力于能够使用 capistrano 部署到生产环境。我面临几个问题，在解决其中大部分问题的同时，我们还有最后一个问题。

我们的预编译资产选项没有在生产环境中正确编译它们，因此，我们无法使用最后开发的功能，因为它们严重依赖 JS。

在不试图影响任何人如何分析这个问题的情况下，这是我试图让它发挥作用的一些方法：

1.  本地预编译资产，推送到 github repo，从本地机器部署到 ec2。cap deploy 是本地的，推送到 ec2 的代码是 github 上的。
2.  按照建议尝试使用 capistrano 任务。在 Capfile 中使用 load 'deploy'assets' 并让 cap deploy:setup 任务完成它的工作。
3.  使用选项 cap deploy:assets:clean 然后 cap deploy:assets:precompile
4.  尝试从公共中删除资产，然后在 deploy.rb 中使用 pipeline_precompile 任务
5.  过期的资产，迫使 Rails 预编译所有改变 application.rb 中 assets.versions 的东西
6.  在 environment/production.rb 中的 config.assets 上尝试了不同的组合
7.  最后，尝试删除生产中的公共/资产并使用 RAILS_ENV=production bundle exec rake assets:precompile 进行预编译

该应用程序只是没有使用新的 JS 文件。如果您在 repo 或服务器本身中检查代码，我在 name.js.coffee 中引入了一个简单的注释（第 xxx 行的“# Shows and hides menus based on the data on DB”），这不在在生产中编译的 assets.js。这是一个快速测试，以确保正在使用最近的资产。

这里的整个问题是js和css文件，而不是rails。这就是为什么它如此难以测试或找到的原因。这也是最近 js 框架流行的原因之一。万一出现问题，您不必为了寻找问题所在而自杀。如果问题出现在 ruby​​ 或 rails 中，通常不会花费那么长时间来找出问题所在。一旦你获得了 js、css 和跨浏览器的兼容性，这就是手头的问题。

这是我的 deploy.rb 文件。运行轨道 3.2.12 ruby​​-1.9.3-p327：

```
# $:.unshift(File.expand_path('./lib', ENV['rvm_path']))

# Load rvm's capistrono plugins
require 'rvm/capistrano'

require 'bundler/capistrano'

set :rvm_type, :user

set :user, 'username'
set :domain, 'ip_address'
set :application, "app_pro"
set :keep_releases, 2 # It keeps on two old releases.

# git repo details
set :scm, :git # You can set :scm explicitly or Capistrano will make an intelligent guess based on known version control directory names
set :repository,  "git@github.com:user/app.git"
set :scm_username, 'user'
set :git_enable_submodules, 1
set :git_shallow_clone, 1
set :branch, 'master'

# Or: `accurev`, `bzr`, `cvs`, `darcs`, `git`, `mercurial`, `perforce`, `subversion` or `none`

role :web, domain                          # Your HTTP server, Apache/etc
role :app, domain                          # This may be the same as your `Web` server
role :db,  domain, :primary => true# 'ec2-23-23-156-118.compute-1.amazonaws.com' This is where Rails migrations will run
# role :db,  "your slave db-server here"

# deply options
default_run_options[:pty] = true
set :ssh_options, {:forward_agent => true}
set :ssh_options, {:auth_methods => "publickey"}
set :ssh_options, {:keys => ["~/Downloads/key.pem"]}
set :deploy_to, "/home/user/appdir"
set :deploy_via, :remote_cache
set :use_sudo, false

# if you want to clean up old releases on each deploy uncomment this:
after "deploy:restart", "deploy:cleanup"

# if you're still using the script/reaper helper you will need
# these http://github.com/rails/irs_process_scripts

# If you are using Passenger mod_rails uncomment this:
namespace :deploy do
  task :start do
    # run COMMAND="/etc/init.d/nginx restart" invoke SUDO=1
    run "sudo /etc/init.d/nginx restart"
    # exit
  end
  after "deploy:start", "deploy:cleanup"

  task :stop do ; end
  task :restart, :roles => :app, :except => { :no_release => true } do
    run "touch #{File.join(current_path,'tmp','restart.txt')}"
  end

  task :setup_config, roles: :app do
    run "mkdir -p #{shared_path}/config"
    put File.read("config/database.example.yml"), "#{shared_path}/config/database.yml"
    puts 'now edit the config file database in #{shared_path}'
  end
  after 'deploy:setup', 'deploy:setup_config'

  desc "Symlink shared resources on each release - not used"
  task :symlink_config, :roles => :app do
    run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"
  end

  after 'deploy:finalize_update', 'deploy:symlink_config'

  desc "It helps to seed database with values"
  task :seed do
    run "cd #{current_path}; bundle exec rake db:seed RAILS_ENV=#{rails_env}"
  end
  task :create_schema do
    run "cd #{current_path}; bundle exec rake db:create RAILS_ENV=#{rails_env} --trace"
  end
end 
```

正在运行的新/替代 (deploy_new2.rb) 文件：

```
# On-working new/alternative deploy.rb file:

require 'rvm/capistrano'
require 'bundler/capistrano'

set :rvm_type, :user

set :application, "ip_address"
set :domain, 'ip_address'

# Roles
role :web, domain
role :app, domain
role :db,  domain, :primary => true

#deployment details
set :deploy_via, :remote_cache
set :user, "username"
set :copy_compression, :bz2
set :git_shallow_clone, 1
set :scm_verbose, true
set :use_sudo, false
set :deploy_to, "/home/user/dir"

default_run_options[:pty] = true
set :ssh_options, {:forward_agent => true}
set :ssh_options, {:auth_methods => "publickey"}
set :ssh_options, {:keys => ["~/Downloads/key.pem"]}

#repo details
set :scm, :git
set :repository,  "git@github.com:user/app.git"
set :scm_username, 'user'
set :keep_releases, 2
set :branch, "master"

namespace :deploy do
  # task :start, :roles => :app, :except => { :no_release => true } do
  #   # not need to restart nginx every time
  #   # run "service nginx start"
  #   run "cd #{release_path} && touch tmp/restart.txt"
  # end

  # after "deploy:start", "deploy:cleanup"
  # after 'deploy:cleanup', 'deploy:symlink_config'

  # You do not need reload nginx every time, eventhought if you use passenger or unicorn
  # task :stop, :roles => :app, :except => { :no_release => true } do
  #   run "service nginx stop"
  # end

  # task :graceful_stop, :roles => :app, :except => { :no_release => true } do
  #   run "service nginx stop"
  # end

  # task :reload, :roles => :app, :except => { :no_release => true } do
  #   run "cd #{release_path} && touch tmp/restart.txt"
  #   run "service nginx restart"
  # end

  task :restart, :roles => :app, :except => { :no_release => true } do
    run "cd #{release_path} && touch tmp/restart.txt"
  end

  # If you enable assets/deploy in Capfile, you do not need this
  # task :pipeline_precompile do
  #   # run "cd #{release_path}; RAILS_ENV=#{rails_env} bundle exec rake assets:precompile"
  #   # precompile assets before deploy and upload them to server 
  #   # run_locally("RAILS_ENV=#{rails_env} rake assets:clean && RAILS_ENV=#{rails_env} rake assets:precompile")
  #   # top.upload "public/assets", "#{release_path}/public/assets", :via =>:scp, :recursive => true
  # end
end

# you do not need to this, because you already add require 'bundler/capistrano'
# before "deploy:assets:precompile", "bundle:install" 
```

和./Capfile：

```
load 'deploy'
# Uncomment if you are using Rails' asset pipeline
load 'deploy/assets'
load 'config/deploy' # remove this line to skip loading any of the default tasks 
```

预先感谢您的任何帮助！如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-23T01:22:15.653

您不需要自己的 :precompile_assets 任务。您通过在 Capfile 中包含加载“部署/资产”来使用 Capistrano。

从 deploy.rb 中删除 :precompile_assets 任务可能会解决问题。如果您查看 Capistrano 的源代码，您会发现它实现 :precompile_assets 的方式完全不同：[https ://github.com/capistrano/capistrano/blob/legacy-v2/lib/capistrano/recipes/deploy/assets.rb](https://github.com/capistrano/capistrano/blob/legacy-v2/lib/capistrano/recipes/deploy/assets.rb)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T03:25:49.300

你可以试试这段代码

```
# On-working new/alternative deploy.rb file:

require 'rvm/capistrano'
require 'bundler/capistrano'

set :rvm_type, :user

set :application, "ip_address"
set :domain, 'ip_address'

# Roles
role :web, domain
role :app, domain
role :db,  domain, :primary => true

#deployment details
set :deploy_via, :remote_cache
set :user, "username"
set :copy_compression, :bz2
set :git_shallow_clone, 1
set :scm_verbose, true
set :use_sudo, false
set :deploy_to, "/home/user/dir"

default_run_options[:pty] = true
set :ssh_options, {:forward_agent => true}
set :ssh_options, {:auth_methods => "publickey"}
set :ssh_options, {:keys => ["~/Downloads/key.pem"]}

#repo details
set :scm, :git
set :repository,  "git@github.com:user/app.git"
set :scm_username, 'user'
set :keep_releases, 2
set :branch, "master"

namespace :deploy do
  # task :start, :roles => :app, :except => { :no_release => true } do
  #   # not need to restart nginx every time
  #   # run "service nginx start"
  #   run "cd #{release_path} && touch tmp/restart.txt"
  # end

  # after "deploy:start", "deploy:cleanup"
  # after 'deploy:cleanup', 'deploy:symlink_config'

  # You do not need reload nginx every time, eventhought if you use passenger or unicorn
  # task :stop, :roles => :app, :except => { :no_release => true } do
  #   run "service nginx stop"
  # end

  # task :graceful_stop, :roles => :app, :except => { :no_release => true } do
  #   run "service nginx stop"
  # end

  # task :reload, :roles => :app, :except => { :no_release => true } do
  #   run "cd #{release_path} && touch tmp/restart.txt"
  #   run "service nginx restart"
  # end

  task :restart, :roles => :app, :except => { :no_release => true } do
    run "cd #{release_path} && touch tmp/restart.txt"
  end

  # If you enable assets/deploy in Capfile, you do not need this
  # task :pipeline_precompile do
  #   # run "cd #{release_path}; RAILS_ENV=#{rails_env} bundle exec rake assets:precompile"
  #   # precompile assets before deploy and upload them to server 
  #   # run_locally("RAILS_ENV=#{rails_env} rake assets:clean && RAILS_ENV=#{rails_env} rake assets:precompile")
  #   # top.upload "public/assets", "#{release_path}/public/assets", :via =>:scp, :recursive => true
  # end
end

# you do not need to this, because you already add require 'bundler/capistrano'
# before "deploy:assets:precompile", "bundle:install" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-28T19:36:19.560

解决方案：这是工作部署文件-

```
require 'rvm/capistrano'
require 'bundler/capistrano'

set :rvm_type, :user

set :application, "ip_address"
set :domain, 'ip_address'

# Roles
role :web, domain
role :app, domain
role :db,  domain, :primary => true

#deployment details
set :deploy_via, :remote_cache
set :user, "user"
set :copy_compression, :bz2
set :git_shallow_clone, 1
set :scm_verbose, true
set :use_sudo, false
set :deploy_to, "/home/user/app_dir"

default_run_options[:pty] = true
set :ssh_options, {:forward_agent => true}
set :ssh_options, {:auth_methods => "publickey"}
set :ssh_options, {:keys => ["~/sites/app/config/key.pem"]}

#repo details
set :scm, :git
set :repository,  "git@github.com:github_id/app.git"
set :scm_username, 'github_id'
set :keep_releases, 2
set :branch, "master"

after 'deploy:update_code', 'deploy:symlink_db'

namespace :deploy do
  # task :start, :roles => :app, :except => { :no_release => true } do
  #   # not need to restart nginx every time
  #   # run "service nginx start"
  #   run "cd #{release_path} && touch tmp/restart.txt"
  # end

  # after "deploy:start", "deploy:cleanup"
  # after 'deploy:cleanup', 'deploy:symlink_config'

  # You do not need reload nginx every time, eventhought if you use passenger or unicorn
  # task :stop, :roles => :app, :except => { :no_release => true } do
  #   run "service nginx stop"
  # end

  # task :graceful_stop, :roles => :app, :except => { :no_release => true } do
  #   run "service nginx stop"
  # end

  # task :reload, :roles => :app, :except => { :no_release => true } do
  #   run "cd #{release_path} && touch tmp/restart.txt"
  #   run "service nginx restart"
  # end

  task :restart, :roles => :app, :except => { :no_release => true } do
    run "cd #{release_path} && touch tmp/restart.txt"
  end

  desc "Symlinks the database.yml"
  task :symlink_db, :roles => :app do
    run "ln -nfs #{deploy_to}/shared/config/database.yml #{release_path}/config/database.yml"
  end

  # If you enable assets/deploy in Capfile, you do not need this
  # task :pipeline_precompile do
  #   # run "cd #{release_path}; RAILS_ENV=#{rails_env} bundle exec rake assets:precompile"
  #   # precompile assets before deploy and upload them to server 
  #   # run_locally("RAILS_ENV=#{rails_env} rake assets:clean && RAILS_ENV=#{rails_env} rake assets:precompile")
  #   # top.upload "public/assets", "#{release_path}/public/assets", :via =>:scp, :recursive => true
  # end
end

# you do not need to this, because you already add require 'bundler/capistrano'
# before "deploy:assets:precompile", "bundle:install" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-21T19:53:21.393

我发现 capistrano 资产编译规则在捆绑器规则之前运行，所以没有任何效果，我编写了自己的：

```
 after "bundle:install" do
    run "cd #{release_path}; RAILS_ENV=production bundle exec rake assets:precompile"
  end 
```

然后我发现我真的对在我的生产机器上安装 js 运行时不感兴趣。我回到只是将我的资产放入我的 git 树的部署分支中。我第一次这样做时，我忘了包含 manifest.yml 文件。

[http://jimneath.org/2012/05/05/precompile-assets-using-a-git-hook.html](http://jimneath.org/2012/05/05/precompile-assets-using-a-git-hook.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-24T19:51:46.903

如果您在 Gemfile 中有 uglifier，它在资产编译期间运行，它可能已配置为仅删除您用来测试是否正在部署更改的 Javascript 资产的注释。

Uglifier 的自述文件[说](https://github.com/lautis/uglifier#usage)这是可能的，并区分了几种评论。因此，您可能会被资产编译后仍然存在的另一条评论误导。

判断这种可能性的另一个线索是（正如你所说）这个问题是在解决其他问题的漫长（累人）过程之后出现的。通常，这会阻止人们产生这样的看法；长期的努力可以“锁定”他们的假设。

因此，请尝试在您的 Javascript 中添加变量声明而不是注释。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-17T14:52:12.760

我遇到了与此类似的问题，但解决方案是删除 Gemfile 中的资产组，因为用于预编译的默认任务上限取决于资产似乎不在单独的组中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-28T11:44:32.670

我遇到了这个问题。原来我必须在我的服务器上安装 node 和 yarn 以获得 rake assets:precompile 才能工作

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-11-03T18:37:52.020

我最近也遇到了这个问题，使用 Capistrano 部署的资产预编译挂在 AWS 中。我通过在部署时临时从 t3.micro 实例切换到 t3.small 实例解决了这个问题。看起来微实例没有足够的资源用于预编译步骤。

# android - Android：FBO 到位图。在某些设备上具有 NPOT 图像大小的加扰结果

> ID：15581821
> 
> 赞同：2
> 
> 时间：2013-03-23T00:15:38.403
> 
> 标签：android, bitmap, opengl-es-2.0

老实说，我不喜欢这样问，但我对这个一点头绪都没有！

你以前见过这个吗？

![在此处输入图像描述](../Images/54bd72710773a75034e2692895bfd36e.png)

可以看出，图像按照某种定义的模式进行了加扰。这只发生在某些（低端）设备中，具有两个图像的非电源 (FBO)。它在其他设备上运行良好。

我所做的是将 Android 位图加载到 FBO（工作正常，因为它在屏幕上显示正常）。我做了一些编辑（我粘贴了一个贴纸，它在图像中似乎在正确的位置），最后再次将 FBO 保存到位图中。它适用于 512x512 FBO（FBO 具有图像尺寸），但不适用于那个（507x800）。

有任何想法吗？？？我不发布代码，因为我不知道，请告诉我，我会添加它。

这是从 FBO 检索信息的 GL 调用

```
public Buffer toPixelBuffer(){
        final int w = this.getWidth(); //colorTexture width 
        final int h = this.getHeight();
        final ByteBuffer pixels = BufferUtils.newByteBuffer(w*h * 4);
        Gdx.gl.glPixelStorei(GL10.GL_PACK_ALIGNMENT, 1);
        Gdx.gl.glReadPixels(0,0, w, h, GL20.GL_RGBA, GL20.GL_UNSIGNED_BYTE, pixels);
        pixels.clear();
        return pixels;
    } 
```

我现在也没有带越野车的设备来测试:(

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-03-21T22:39:35.840

我有同样的问题。我在 Galaxy Ace、Galaxy Y 和其他一些设备上体验过这一点。

经过大量测试后，我发现它甚至不需要 POT 纹理，因此将纹理大小保持为 64 像素增量就可以了。所以假设我有一个 122x53 的纹理，我需要将它转换为 128x64。一个等等。

接下来是我用来获取有效纹理尺寸的函数。为宽度和高度调用它。

```
/**
 * Some GPUs such as the "VideoCore IV HW" on the Samsung Galaxy Ace
 * require texture (FBO) sizes to be in '64' increments (WTF!!!!)
 * 
 * @param dimension
 *            Base dimension to calculate
 * @return Resolved 64 dimension
 */
public static int calculate64Dimension(final int dimension)
{
    return  (((dimension - 1) >> 6) << 6) + 64;
} 
```

# mongodb - 为什么在 MongoDB 中使用锁定？

> ID：15581823
> 
> 赞同：1
> 
> 时间：2013-03-23T00:15:48.523
> 
> 标签：mongodb, pymongo, database-locking

MoongoDB来自NoSql时代，Lock是和RDBMS有关的东西？[来自维基百科](http://en.wikipedia.org/wiki/Optimistic_locking)：

> 乐观并发控制（OCC）是一种用于**关系数据库管理系统**的并发控制方法...

那么为什么我在 PyMongo 中找到`is_locked`，甚至在进行非阻塞调用的驱动程序中，Lock 仍然存在，Motor 有`is_locked`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T00:17:46.627

NoSQL 并不意味着自动没有锁。总有一些操作需要锁。

例如建立索引

官方 MongoDB 文档是比维基百科更可靠的来源（无意冒犯维基百科 :)）

[http://docs.mongodb.org/manual/faq/concurrency/](http://docs.mongodb.org/manual/faq/concurrency/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T00:26:16.843

Mongo 进行就地更新，因此它需要锁定才能修改数据库。还有其他需要锁定的东西，因此请阅读@Tigra 提供的链接以获取更多信息。

就数据库而言，这是非常标准的，它不是特定于 RDBMS 的东西（Redis 也这样做，但基于每个键）。

有计划实施集合级（而不是数据库级）锁定：[https ://jira.mongodb.org/browse/SERVER-1240](https://jira.mongodb.org/browse/SERVER-1240)

一些数据库，如 CouchDB，通过仅附加新文档来解决锁定问题。他们创建一个新的、唯一的修​​订 ID，一旦文档完成写入，数据库就会指向新的修订。我确信在更改使用的修订版时会有某种并发控制，但它不需要阻止数据库来做到这一点。这有一些缺点，例如需要定期运行[压缩。](http://wiki.apache.org/couchdb/Compaction)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T10:00:35.347

MongoDB 实现了数据库级别的锁定系统。这意味着非原子操作将锁定在每个数据库级别上，这与大多数技术人员锁定在表级别以进行基本操作的 SQL 不同。

就地更新仅发生在某些运算符上——`$set`作为其中之一，MongoDB 文档确实曾经有一个页面显示所有这些，但我现在找不到它。

MongoDB 目前实现了一个读/写锁，每个锁都是独立的，但它们可以相互阻塞。

锁对任何数据库都至关重要，例如，如果当前正在写入文档，如何确保对文档的一致读取？如果您写入文档，您如何确保一次只应用单个更新而不是同时应用多个更新？

我不确定版本控制如何在 CouchDB 中阻止这种情况，锁对于一致读取非常重要，并且与版本控制分开，即如果您希望将读取锁应用于同一版本或读取当前正在执行的文档怎么办写入新版本？您显然会看到一个锁定队列出现。即使版本控制可能对写锁饱和有一点帮助，仍然会有一个写锁，它仍然需要在一个级别上工作。

至于并发特性；如果数据不在 RAM 中，MongoDB 有能力（一方面）为其他操作消退一个操作。这意味着锁不会只是坐在那里等待数据被调入，同时其他操作也会运行。

附带说明一下，MongoDB 实际上有比这更多的锁，它还有一个全局和阻塞的 JavaScript 锁，它没有常规锁的正常并发特性。

> 甚至在进行非阻塞调用的驱动程序中

嗯，我认为您可能会对“非阻塞”应用程序或服务器的含义感到困惑：[http ://en.wikipedia.org/wiki/Non-blocking_algorithm](http://en.wikipedia.org/wiki/Non-blocking_algorithm)

# python - Python将信息添加到列表中

> ID：15581827
> 
> 赞同：1
> 
> 时间：2013-03-23T00:16:13.947
> 
> 标签：python, list, python-2.7

我必须定义一个函数： add_info(new_info, new_list) 采用一个包含四个元素的元组，其中包含一个人的信息和一个新列表。如果此人的姓名不在列表中，则使用新人的信息更新列表并返回 True 以表示操作成功。否则，将打印错误，列表不变并返回 False。

例如：

```
>>>d = load_file(’people.csv’)
>>>d
[(John’, ’Ministry of Silly Walks’, ’5555’, ’27 October’),
(’Eric’, ’Spamalot’, ’5555’, ’29 March’)]
>>>add_info((’John’, ’Cheese Shop’, ’555’, ’5 May’), d)
John is already on the list
False
>>>d
[(John’, ’Ministry of Silly Walks’, ’5555’, ’27 October’),
(’Eric’, ’Spamalot’, ’5555’, ’29 March’)]
>>>add_info((’Michael’, ’Cheese Shop’, ’555’, ’5 May’), d)
True
>>>d
[(John’, ’Ministry of Silly Walks’, ’5555’, ’27 October’),
(’Eric’, ’Spamalot’, ’5555’, ’29 March’), 
(’Michael’, ’Cheese Shop’, ’555’, ’5 May’)] 
```

到目前为止，我的代码如下所示：

```
def load_file(filename):
with open(filename, 'Ur') as f:
    return list(f)

def save_file(filename, new_list):
with open(filename, 'w') as f:
    f.write('\n'.join(new_list) + '\n')

def save_file(filename, new_list):
with open(filename, 'w') as f:
    f.write(line + '\n' for line in new_list)

def save_file(filename, new_list):
with open(filename, 'w') as f:
    for line in new_list:
        f.write(line + '\n')

def add_info(new_info, new_list):

name = new_info

for item in new_list:
    if item == name:
        print str(new_info) , "is already on the list."
        return False
else:
    new_list.append(new_info)
    return True 
```

每当我输入一个已经在列表中的名称时，它只会将该名称添加到列表中。不知道该怎么办。有任何想法吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:30:52.033

听起来我可能正在为你做作业，但无论如何......

```
def add_info(new_info, new_list):
    # Persons name is the first item of the list
    name = new_info[0]

    # Check if we already have an item with that name
    for item in new_list:
        if item[0] == name:
            print "%s is already in the list" % name
            return False

    # Insert the item into the list
    new_list.append(new_info)
    return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T03:29:27.270

您的 if 语句将字符串 (item[0]) 与列表 (name) 进行比较。所以该测试总是失败，它会移动到返回 True 的 else 语句。

# python - 如何在非简单标准上使用 Pandas 执行 DataFrames 的内部或外部联接

> ID：15581829
> 
> 赞同：7
> 
> 时间：2013-03-23T00:16:32.310
> 
> 标签：python, sql, numpy, pandas

给定两个数据框，如下所示：

```
>>> import pandas as pd

>>> df_a = pd.DataFrame([{"a": 1, "b": 4}, {"a": 2, "b": 5}, {"a": 3, "b": 6}])
>>> df_b = pd.DataFrame([{"c": 2, "d": 7}, {"c": 3, "d": 8}])
>>> df_a
   a  b
0  1  4
1  2  5
2  3  6

>>> df_b
   c  d
0  2  7
1  3  8 
```

我们想使用非简单标准生成两个数据帧的 SQL 样式连接，比如说“df_b.c > df_a.a”。据我所知，虽然`merge()`肯定是解决方案的一部分，但我不能直接使用它，因为它不接受“ON”标准的任意表达式（除非我遗漏了什么？）。

在 SQL 中，结果如下所示：

```
# inner join
sqlite> select * from df_a join df_b on c > a;
1|4|2|7
1|4|3|8
2|5|3|8

# outer join
sqlite> select * from df_a left outer join df_b on c > a;
1|4|2|7
1|4|3|8
2|5|3|8
3|6|| 
```

我目前的内部连接方法是生成 df_a 和 df_b 的笛卡尔积，方法是向两者添加一列“1”，然后在“1”列上使用 merge()，然后应用“c > a”标准。

```
>>> import numpy as np
>>> df_a['ones'] = np.ones(3)
>>> df_b['ones'] = np.ones(2)
>>> cartesian = pd.merge(df_a, df_b, left_on='ones', right_on='ones')
>>> cartesian
   a  b  ones  c  d
0  1  4     1  2  7
1  1  4     1  3  8
2  2  5     1  2  7
3  2  5     1  3  8
4  3  6     1  2  7
5  3  6     1  3  8
>>> cartesian[cartesian.c > cartesian.a]
   a  b  ones  c  d
0  1  4     1  2  7
1  1  4     1  3  8
3  2  5     1  3  8 
```

对于外部联接，我不确定最好的方法，到目前为止，我一直在尝试获取内部联接，然后应用对标准的否定来获取所有其他行，然后尝试编辑该“否定” " 设置为原件，但它并没有真正起作用。

**编辑**. HYRY 在这里回答了具体问题，但我需要在 Pandas API 中更通用和更多的东西，因为我的加入标准可以是任何东西，而不仅仅是一个比较。对于外连接，首先我在“左侧”添加一个额外的索引，在我进行内连接后将保持自身：

```
df_a['_left_index'] = df_a.index 
```

然后我们做笛卡尔并获得内部连接：

```
cartesian = pd.merge(df_a, df_b, left_on='ones', right_on='ones')
innerjoin = cartesian[cartesian.c > cartesian.a] 
```

然后我在“df_a”中获得我们需要的额外索引 ID，并从“df_a”中获取行：

```
remaining_left_ids = set(df_a['_left_index']).\
                    difference(innerjoin['_left_index'])
remaining = df_a.ix[remaining_left_ids] 
```

然后我们使用直接的 concat()，它将缺失的列替换为左侧的“NaN”（我认为它之前没有这样做，但我猜它确实如此）：

```
outerjoin = pd.concat([innerjoin, remaining]).reset_index() 
```

HYRY 仅在我们需要比较的那些列上进行笛卡尔计算的想法基本上是正确的答案，尽管在我的具体情况下，实现起来可能有点棘手（概括和全部）。

问题：

1.  您将如何在“c > a”上生成 df_1 和 df_2 的“连接”？你会做同样的“笛卡尔积，过滤器”方法还是有更好的方法？

2.  你将如何产生相同的“左外连接”？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T01:29:41.417

我使用 ufunc 的外部方法来计算结果，这里是例子：

首先，一些数据：

```
import pandas as pd
import numpy as np
df_a = pd.DataFrame([{"a": 1, "b": 4}, {"a": 2, "b": 5}, {"a": 3, "b": 6}, {"a": 4, "b": 8}, {"a": 1, "b": 7}])
df_b = pd.DataFrame([{"c": 2, "d": 7}, {"c": 3, "d": 8}, {"c": 2, "d": 10}])
print "df_a"
print df_a
print "df_b"
print df_b 
```

输出：

```
df_a
   a  b
0  1  4
1  2  5
2  3  6
3  4  8
4  1  7
df_b
   c   d
0  2   7
1  3   8
2  2  10 
```

内连接，因为这只计算`c`&的笛卡尔积`a`，内存使用量小于整个 DataFrame 的笛卡尔积：

```
ia, ib = np.where(np.less.outer(df_a.a, df_b.c))
print pd.concat((df_a.take(ia).reset_index(drop=True), 
                 df_b.take(ib).reset_index(drop=True)), axis=1) 
```

输出：

```
 a  b  c   d
0  1  4  2   7
1  1  4  3   8
2  1  4  2  10
3  2  5  3   8
4  1  7  2   7
5  1  7  3   8
6  1  7  2  10 
```

要计算左外连接，请使用查找不在内连接中的`numpy.setdiff1d()`所有行：`df_a`

```
na = np.setdiff1d(np.arange(len(df_a)), ia)
nb = -1 * np.ones_like(na)
oa = np.concatenate((ia, na))
ob = np.concatenate((ib, nb))
print pd.concat([df_a.take(oa).reset_index(drop=True), 
                 df_b.take(ob).reset_index(drop=True)], axis=1) 
```

输出：

```
 a  b   c   d
0  1  4   2   7
1  1  4   3   8
2  1  4   2  10
3  2  5   3   8
4  1  7   2   7
5  1  7   3   8
6  1  7   2  10
7  3  6 NaN NaN
8  4  8 NaN NaN 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-18T02:24:21.383

这可以通过广播和 np.where 来完成。使用任何你想要的二元运算符来评估为真/假：

```
import operator as op

df_a = pd.DataFrame([{"a": 1, "b": 4}, {"a": 2, "b": 5}, {"a": 3, "b": 6}])
df_b = pd.DataFrame([{"c": 2, "d": 7}, {"c": 3, "d": 8}])

binOp   = op.lt
matches = np.where(binOp(df_a.a[:,None],df_b.c.values))

print pd.concat([df.ix[idxs].reset_index(drop=True) 
                 for df,idxs in zip([df_a,df_b],matches)],
                axis=1).to_csv() 
```

，A B C D

0,1,4,2,7

1,1,4,3,8

2,2,5,3,8

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-11T04:28:33.590

来自[pyjanitor的](https://pyjanitor-devs.github.io/pyjanitor/)[conditional_join](https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.conditional_join.html#janitor.conditional_join)可能有助于抽象/方便；该功能目前在开发中：

```
# pip install git+https://github.com/pyjanitor-devs/pyjanitor.git
import pandas as pd
import janitor 
```

内部联接

```
 df_a.conditional_join(df_b, ('a', 'c', '<'))

  left    right
     a  b     c  d
0    1  4     2  7
1    1  4     3  8
2    2  5     3  8 
```

左连接

```
df_a.conditional_join(df_b, ('a', 'c', '<'), how = 'left')

  left    right
     a  b     c    d
0    1  4   2.0  7.0
1    1  4   3.0  8.0
2    2  5   3.0  8.0
3    3  6   NaN  NaN 
```

该函数采用元组的变量 (*args) 参数作为条件 ( `col from left`, `col from_right`, `join operator`)

# shell - 在日期和时间之后检查模式

> ID：15581832
> 
> 赞同：0
> 
> 时间：2013-03-23T00:16:49.017
> 
> 标签：shell, logging, pattern-matching

有日志文件，其中有模式

```
----- Fri Mar 22 20:11:50 2013
statement 1
statement 2
statement 3
.
.
.
No errors
statement 10
statement 11
statement 12 
```

我需要搜索生成的当前日期和时间日志，并在日志文件中查找模式“无错误”。我怎样才能做到这一点 ？小提示：日志文件将包含多天日志条目。

我试过了

```
 [ `grep -c "No Errors"  /usr/apps/logs/errrors.log` eq 1 ]
 echo "No error" 
```

问题是它没有回显“无错误”，因为它可能在这里有多个匹配项。那么如何在日志文件中的某些检查时间和日期后找到模式？

谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:28:17.200

在通过管道连接的两个单独的命令中执行此操作。该命令的第一部分将打印日期或字符串“No errors”的匹配项。第二部分将删除重复的相邻输出行，这样每个日期之间最多打印一个“No errors”。

```
grep -ei '[0-9]:[0-9][0-9]:[0-9][0-9] 20[0-9][0-9]' -ei 'No errors' | uniq 
```

如果在该日期之后和日志文件中包含的下一个日期之前出现任何字符串“No errors”，则您获得的输出将是日期列表，然后是日期之后的消息“No errors” .

我不确定您的文件是否包含“无错误”或“无错误”，因此请确保我的命令已更新为您正在搜索的内容。此外，请确保更改命令，以便它接收来自您正在使用的日志文件的输入。例如，

```
cat logfile | grep -ei ...... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T01:01:51.050

您可以使用`awk`可以定义记录分隔符和字段分隔符的工具。我无法测试，因为您没有提供太多样本输入，但这样的事情可能会起作用：

```
awk -v RS='----- ' -v FS='\n' '/No errors/ {print "No errors on " $1}' logfile 
```

# ruby-on-rails - 关联 Ruby on Rails 进行连接

> ID：15581833
> 
> 赞同：0
> 
> 时间：2013-03-23T00:16:51.980
> 
> 标签：ruby-on-rails, ruby

我是 ruby​​ 的新手，我正在尝试建立良好的关联:)，但我在将它们写入 ruby​​ 模型时遇到了一些问题，具有以下内容：

游戏 (id <-> game_id) 玩家 (user_id <-> id) 用户

我认为应该或多或少为：一个玩家有很多游戏但属于一个用户，一个用户有很多玩家

我希望能够在 3 个类（即游戏和播放器）之间进行连接以获取用户

我的方式正确吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T01:48:58.833

如果你的模型正确设置了 has_many 和 belongs_to 方法，那么加入的方法非常简单

```
User.joins(:games, :players) 
```

希望这可以帮助

这里有一个关于整个查询界面的非常好的指南

[http://guides.rubyonrails.org/active_record_querying.html](http://guides.rubyonrails.org/active_record_querying.html)

# c++ - Vim 宏生成 C++ 构造函数

> ID：15581835
> 
> 赞同：5
> 
> 时间：2013-03-23T00:17:08.293
> 
> 标签：c++, vim, macros

我想知道是否可以在 Vim 中定义一个宏来让您执行以下操作。假设你有一个类定义

```
class CRectangle {
  int x;
  int y;
  _
}; 
```

其中 _ 指定当前光标位置。

运行宏应该会自动生成

```
class CRectangle {
  int x;
  int y;

public:
  CRectangle (int x, int y);
  ~CRectangle ();
};

CRectangle::(int x, int y) {
  this->x = x;
  this->y = y;
} 
```

我一直在考虑这个问题，但没有得到任何结果。也许创建构造函数定义有点过分。至少获得构造函数声明是否可行？

====

正如 sftrabbit 指出的那样，生成类似的东西可能更可取

```
CRectangle::(int _x, int _y) : x(_x), y(_y) {} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-23T02:16:25.363

好吧……我很无聊……

```
qm           ; Gentlemen... start your macros (we'll call it 'm')
ma           ; Mark your current location as 'a'
v            ; switch to 'visual' mode
?{<cr>       ; Search back to the opening brace (actually hit 'enter' for that <cr>)
l"by         ; Go forward one character and yank the selection to buffer 'b'
b            ; Go back one word
"cyw         ; Copy the class name into buffer 'c'
'a           ; Jump back to the starting location
opublic:<cr> ; add "public:"
()<esc>B"cP  ; create an empty constructor
t)"bp        ; Paste the list of arguments in
             ; Rather complex reformatting regex on the next line
:.,/)/s/\s*\w\+\s+\(\w+\);\n/_\1, /<cr>
kJ:s/,\s*)/)/<cr> ; Simple cleanup
A : {}<esc>  ; Finish some of the basics
F:"bp        ; Paste in the fields again for generating the initialization
             ; Below: Another fairly complicated formatting regex
:.,/{}/s/\s*\w\+\s\+\(\w\+\);\n/\1(_\1),/<cr>
:s/,\s*{/ {/<cr>     ; Cleanup
kJ                   ; Finished with the constructor
q                    ; Finish macro (I'm going to omit the rather trivial destructor) 
```

我确信这可以简化......但作为“可以做到吗？”的答案。是的……当然可以。

请注意，您还必须对其进行一些修改以处理您的 vim 配置为格式化（自动缩进等）。

如果你对在课堂上组装变量有点草率，你可能不得不`/\s*\w\+\s\+\(\w\+\)\s*;\s*\n/`在`/\s*\w\+\s\+\(\w\+\);\n/`这两个地方交换。（处理事物周围的一些额外空间）

# python - 如果数组包含 2 或 3，则返回 True

> ID：15581837
> 
> 赞同：3
> 
> 时间：2013-03-23T00:17:22.543
> 
> 标签：python, python-2.7

我遇到了这个 CodingBat 问题：

> 给定一个长度为 2 的 int 数组，如果它包含 2 或 3，则返回 True。

我尝试了两种不同的方法来解决这个问题。谁能解释我做错了什么？

```
#This one says index is out of range, why?
def has23(nums):
 for i in nums:
  if nums[i]==2 or nums[i]==3:
   return True
  else:
   return False 
```

```
#This one doesn't past the test if a user entered 4,3.
#It would yield False when it should be true. Why?
def has23(nums):
 for i in nums:
  if i==2 or i==3:
   return True
  else:
   return False 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T00:20:29.323

您的第一个不起作用，因为`for`Python 中的`for`循环与其他语言中的循环不同。它不是迭代索引，而是迭代实际元素。

`for item in nums`大致相当于：

```
for (int i = 0; i < nums.length; i++) {
    int item = nums[i];

    ...
} 
```

你的第二个不起作用，因为它返回`False`得太快了。如果循环遇到一个不是`2`or的值`3`，它会返回`False`并且不会遍历任何其他元素。

将您的循环更改为：

```
def has23(nums):
    for i in nums:
        if i == 2 or i == 3:
            return True  # Only return `True` if the value is 2 or 3

    return False  # The `for` loop ended, so there are no 2s or 3s in the list. 
```

或者只是使用`in`：

```
def has23(nums):
    return 2 in nums or 3 in nums 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-03T01:48:30.993

出于学习目的使用索引 A 变体来完成上述操作的另一种方法

```
 def has23(nums):
  try :
    alpha = nums.index(2)
    return True
  except:
    try:
      beta = nums.index(3)
      return True
    except:
      return False 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-26T20:50:11.693

老帖子，我知道，但对于未来的读者：

关于 for 循环，我认为值得一提的是另一个选项：使用 range() 函数。

代替

```
 for i in nums: 
```

您可以将 for 循环切换为如下所示：

```
for i in range(len(nums)): 
```

这将迭代整数，就像其他语言一样。然后使用`nums[i]`将获取索引的值。

但是，我注意到您的代码及其既定目标的另一个问题：在 for 循环中，所有执行路径都返回一个变量。无论数组的长度如何，它只会执行一次 for 循环，因为在第一次执行后它返回，结束函数的执行。如果第一个值为 false，则函数将返回 false。

相反，只有当语句为真时，您才希望在循环内结束执行。如果循环遍历所有可能性并且没有什么是错误的，则返回 false：

```
def has23(nums):
 for i in range(len(nums)):   # iterate over the range of values
  if nums[i]==2 or nums[i]==3:# get values via index
   return true                # return true as soon as a true statement is found
 return false                 # if a true statement is never found, return false 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2020-06-22T07:39:29.910

此 Java 代码工作正常：-

```
public boolean has23(int[] nums) {
  if(nums[0]==2||nums[1]==2||nums[0]==3||nums[1]==3){
    return true;
  }
  return false;
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2018-11-03T14:01:50.243

```
def has23(nums):
  if nums[0] ==2 or nums[0]==3 or nums[1] ==2 or nums[1]==3: 
    return True
  else: 
    return False 
```

# vim - 如何在 Vim 中自动完成文件路径，就像在 zsh 中一样？

> ID：15581845
> 
> 赞同：18
> 
> 时间：2013-03-23T00:19:06.363
> 
> 标签：vim, autocomplete, zsh

在 Zsh 中，我可以使用带有斜杠的文件名完成来定位源代码树深处的文件。例如，如果我输入：

```
 vim s/w/t/u/f >TAB< 
```

zsh 将模式替换为：

```
 vim src/wp-contents/themes/us/functions.php 
```

我想要的是能够在 Vim 命令行中以相同的方式定位文件，以便输入

```
 :vi s/w/t/u/f >TAB< 
```

将自动完成到：

```
 :vi src/wp-contents/themes/us/functions.php 
```

我正在尝试为 Wildmode 解析 Vim 文档，但我看不出什么设置会给我这个。它对单个文件名进行自动完成，但不是文件路径。Vim 本身支持这个吗？或者如何自定义文件的自动完成算法？

感谢您的任何建议！-mykle-

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-23T05:53:13.100

我找不到一个插件来做到这一点，所以我写了一个。它被称为[vim-zsh-path-completion](https://github.com/fweep/vim-zsh-path-completion)。它可以满足您的需求，尽管通过`<C-s>`而不是`<Tab>`. 不过，您可以使用它`<Tab>`来更好地控制匹配的内容。

它有错误，但对于没有空格/特殊字符的基本路径，它应该可以工作。我认为它在当前状态下已经足够有用了。我希望消除错误并清理代码，但我想我现在就开始征求反馈。

谢谢你的主意！

**原始（错误）答案，但有一些关于 Vim 的 wildmode 的有用信息。**

将以下内容放入您的`.vimrc`:

```
set wildmenu
set wildmode=list:longest 
```

这将完成 上最长的唯一匹配`<Tab>`，包括在适当的情况下附加 a`/`并下降到目录中。如果有多个匹配项，它将显示您迄今为止输入的匹配项列表。然后您可以键入更多字符并`<Tab>`再次完成。

我更喜欢下面的设置，它完成到第一个唯一匹配`<Tab>`，然后如果你再次点击会弹出一个菜单`<Tab>`，你可以使用箭头键导航并按 Enter 进行选择：

```
set wildmode=list:longest,list:full 
```

签出`:help wildmenu`和`:help wildmode`。您可能还想设置`wildignore`完成时要忽略的模式列表。我有我的：

```
set wildignore=.git,*.swp,*/tmp/* 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-23T07:20:59.433

Vim 默认没有这样的功能。最接近的内置功能是 wildmenu/wildmode 组合，但它仍然非常不同。

[快速浏览 vim.org 的脚本部分](http://www.vim.org/scripts/script_search_results.php?&keywords=path&show_me=20&result_ptr=160)没有返回任何内容，但我并没有看得太远：您应该进一步挖掘。也许它就在那里，某个地方。

您是否尝试过 Command-T、LustyExplorer、FuzzyFinder、CtrlP 或许多类似插件之一？

我使用[CtrlP](https://github.com/kien/ctrlp.vim)并且可以对文件路径或文件名进行模糊匹配。在文件路径上完成后，我可以使用下面的密钥序列打开`src/wp-contents/themes/us/functions.php`（假设`functions.php`是唯一`us`以 a 开头的文件`f`）：

```
,f " my custom mapping for the :CtrlP command
swtuf<CR> 
```

***编辑***

在考虑可能的解决方案时，恐怕我有点短视。我专注于您的确切要求，但 Vim 在打开文件时有很酷的技巧！

该`:e[dit]`命令接受两种类型的通配符：`*`类似于`*`您在 shell 中使用的通配符，`**`表示“任何子目录”。

所以完全有可能做到：

```
:e s*/w*/t*/u*/f*<Tab> 
```

或类似的东西：

```
:e **/us/f<Tab> 
```

甚至：

```
:e **/fun<Tab> 
```

结合 Jim 的回答中的 wildmode 设置，我认为您在这里有一个非常强大的文件导航工具。

# java - 片段设计

> ID：15581847
> 
> 赞同：1
> 
> 时间：2013-03-23T00:19:21.037
> 
> 标签：java, android, android-fragments

我的应用程序中的片段有问题。我的界面如下所示：

```
Screen 1
+---------------+
|   Fragment 1  |
+---------------+
|   Fragment 2  |
|               |
|               |
+---------------+

Screen 2
+---------------+
|   Fragment 1  |
+---------------+
|   Fragment 3  |
|               |
|               |
+---------------+ 
```

每个屏幕都是一个单独的活动，这些片段在我的布局 .xml 文件中定义（因此动态替换可能不起作用）。

我的问题是：

screen1 和 screen2 都包含一个片段 1，以及随之而来的所有信息。就目前而言，当我启动screen2活动时，我目前正在传递fragment1的所有数据 - 然后我用来自fragment1 screen1的数据填充screen2中的fragment1。如果用户点击后退按钮，我必须用 screen2 中的任何更改填充 fragment1 screen1。这是一个很大的头痛。

有没有更简单的方法来做到这一点？

（我不想使用单活动/多片段方法，因为我已经去过那里并认为多活动/多片段更适合这个应用程序。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:27:48.620

> 有没有更简单的方法来做到这一点？

是的，使用单个`Activity`，并`Fragment 3` `replace` `Fragment 2`在需要添加时使用，因此`Fragment 1`所有数据都将保持不变。

> （我不想使用单活动/多片段方法，因为我已经去过那里并认为多活动/多片段更适合这个应用程序。）

我不得不不同意，因为您通过`Fragments`在 xml 中设置并在`Activity`s 之间传递它们的数据来选择更难的路线。我几乎可以保证这比`FrameLayout`在布局中设置容器然后简单地`Fragment`在其中添加/替换 s 需要更多的工作。

简单示例 - [http://developer.android.com/training/basics/fragments/fragment-ui.html](http://developer.android.com/training/basics/fragments/fragment-ui.html)

# android - Android 列表视图不可见

> ID：15581851
> 
> 赞同：0
> 
> 时间：2013-03-23T00:19:55.367
> 
> 标签：android

我有我的布局 xml 作为

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:paddingTop="10dip"
    android:paddingLeft="10dip"
    android:paddingRight="10dip">
    <!-- Editext for Search -->
    <EditText android:id="@+id/inputSearch"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:hint="Search.."
        android:inputType="textVisiblePassword"/>

    <ListView
        android:id="@+id/table_list_listView"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/customshape">
    </ListView>
    <TextView android:id="@android:id/empty"        
        android:layout_width="wrap_content"        
        android:layout_height="wrap_content"        
        android:text="@string/no_servers"/>

</LinearLayout> 
```

但是当活动启动时，我看不到列表视图。仅显示 Edittext。

任何帮助都会得到帮助我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T00:23:16.223

如果没有看到你的 java 代码，我会说这是因为你没有`orientation`在你的`root layout`. 我假设你想要一个垂直方向，在这种情况下你需要在你的`root layout`

```
android:orientation="vertical"` 
```

默认情况下，`LinearLayout`有一个水平的`orientation`. 由于 your `width`of your `EditText`is `fill_parent`，它占据了所有的宽度

# java - 使用 try and catch 字符串输入

> ID：15581857
> 
> 赞同：0
> 
> 时间：2013-03-23T00:20:35.637
> 
> 标签：java

我正在做的是要求用户输入一个月。我已经输入了一个`if`并`else if`说明**月份 > 12 还是月份 < 1**并重新要求用户输入月份。我试图使用 try 和 catch 语句来捕捉用户输入字符串并告诉他们输入一个月。我的代码的问题是，当它捕获用户输入字符串时，命令行**会不断重复**“请输入月份 1-12”并让用户重新输入月份。谁能阻止我遇到的问题。

我尝试将其`month.scan.nextInt()`插入，`catch`但我得到一个错误，我真的很困惑。

```
import java.util.*;
import java.util.Calendar;
import java.util.Date;
import java.util.Scanner;

public class Price {
    public static void main(String[] args) {
        userInput();
    }

    public static void userInput() {
        Scanner scan = new Scanner(System.in);

        int month, day, year;
        boolean i = true;
        System.out.println("Please enter a month MM: "); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:25:26.950

发生错误是因为您的代码没有使用`catch`子句中的无效输入。您的程序尝试一次又一次地读取它，导致另一个异常。

如下更改代码应该可以解决问题：

```
catch(InputMismatchException imme) { 
    System.out.println("Please enter a month 1-12");
    scan.next(); // Ignore the invalid input
} 
```

如果您想让您的代码对其他人更具可读性，请提出解释其用途的名称。例如，变量`i`用于决定是否继续读取。将其重命名为`continueReading`将使您的循环更易于理解：

```
while (continueReading) ... // You do not need "== true" after a boolean variable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:25:29.767

如果用户输入的月份超出了指定范围（例如`23`），请注意会发生什么：

1.  -`if`语句计算`false`并转到`else`块。
2.  打印一条消息，然后用户再次输入文本。
3.  循环再次开始，用户再次输入文本。

因此，您的文本未被检查。尝试删除线

```
month = scan.nextInt(); 
```

调用后打印错误消息。

# java - 将 Date 对象转换为 Date 对象 in (mm/dd/yyyy)

> ID：15581858
> 
> 赞同：0
> 
> 时间：2013-03-23T00:20:43.040
> 
> 标签：java, date

我的班级正在调用一个`Date incomingDate = new Date()`文档所说的： *分配一个 Date 对象并对其进行初始化，以便它表示分配它的时间，测量到最接近的毫秒。*

显然`incomingDate`看起来像：

但是，我需要在 mm/dd/yyyy 中以格式化方式（而不是字符串）传递相同的 Date 对象以打印到 csv 文件。

`Date`班级和班级`Formatter`没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:28:48.017

您应该使用`SimpleDateFormat`来格式化您的日期

```
Date incomingDate = new Date();
SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy");
System.out.println(dateFormat.format(incomingDate )); // sysout or whatever you want (write in your CVS for example) 
```

# html - 如何禁用 Ember.js 选择菜单中的第一个选项

> ID：15581859
> 
> 赞同：5
> 
> 时间：2013-03-23T00:20:45.797
> 
> 标签：html, ember.js, handlebars.js

我对 Ember 很陌生，到目前为止我很喜欢它！但是，我觉得我对一些 HTML 元素失去了一点控制，特别是`<select>`菜单和它的`<option>`s。

我希望默认 ( `selected`)`<option>`也被禁用，即具有属性`disabled`. 我习惯了这种在选择菜单上设置“占位符”的方法，但我也愿意接受其他建议。

例如，如果我有一个性别选择菜单，我希望得到以下代码：

```
<select>
  <option selected disabled>Please select gender</select>
  <option value="m">Male</select>
  <option value="f">Female</select>
</select> 
```

我有以下 JavaScript 和 Handlebars 代码：

### JavaScript

```
genders = [
  Ember.Object.create({value: 'm', label: 'Male'}),
  Ember.Object.create({value: 'f', label: 'Female'}),
];

App.GenderSelect = Ember.Select.extend({
  contentBinding: "genders",
  optionValuePath: "content.value",
  optionLabelPath: "content.label"
}); 
```

### 车把

```
{{view App.GenderSelect prompt="Please select gender"}} 
```

### 生成的 HTML

这给了我几乎我想要的代码。然而，第一个`<option>`是缺少`disabled`属性，因此这个问题。

```
<select>
  <option value>Please select gender</select>
  <option value="m">Male</select>
  <option value="f">Female</select>
</select> 
```

此外，它不会设置`selected`属性，但这不是绝对必要的，因为它是菜单中的第一个选项。

我感谢任何答案，包括对这个问题的直接答案和使用其他方法的有效建议，而不是`disabled`.

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T01:22:50.817

该 HTML 被硬编码到模板中，并且没有简单的方法可以做到这一点。

也就是说，您可以使用以下子类 Ember.Select

```
didInsertElement: function () {
    this.$('option:first').attr('disabled', true);
} 
```

您还可以使用该`layout`属性在自动渲染选项上方手动插入占位符：

```
layout: precompileTemplate("<option selected disabled>Please select gender</option>{{yield}}") 
```

鉴于这也需要一个子类，我认为使用`didInsertElement`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T21:29:55.677

这个答案无耻地利用了@ChristopherSwasey 的答案，但会影响所有`Ember.Select`使用该`prompt`属性的全局 s。

```
Ember.Application.initializer({
    name: 'ember-select-with-nullprompt',

    initialize: function(container, application) {
        Ember.Select.reopen({
            didInsertElement: function () {
                if (this.prompt)
                    this.$('option:first').attr('disabled', true);
            }
        });
    }
}); 
```

# vb.net - 将新记录添加到具有标识主键的表中

> ID：15581861
> 
> 赞同：0
> 
> 时间：2013-03-23T00:21:10.263
> 
> 标签：vb.net

我的数据库中有这个表结构：

```
CREATE TABLE RIAD (
NumeroR int primary key identity,
 NomR varchar(50),
 AdresseRueR varchar(50),
 CodePostalR int,
  VilleR varchar(50),
 TelephoneR varchar(50),
 NomContactR varchar(50),
 CodeReg int,
 NombreDePlaces int) 
```

我有这个表格：

![在此处输入图像描述](../Images/ebcab8ea02091ae47bf39f00b416dcf8.png)

当我单击按钮 Ajouter 时，我希望从三个按钮上方的文本字段中将新记录添加到我的数据库中的 RIAD 表中。

这是我尝试过的代码：

```
Public cnx As New SqlConnection("data source=localhost; initial catalog=EFF_TSDI_2009_V1; integrated security=sspi")
    Public ds As New DataSet
    Public adapterRiad As SqlDataAdapter
    Public builderRiad As SqlCommandBuilder

Private Sub MajRiad_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        adapterRiad = New SqlDataAdapter()
        adapterRiad.SelectCommand = New SqlCommand("SELECT  * FROM RIAD", cnx)
        adapterRiad.Fill(ds, "RIAD")
        DataGridView1.DataSource = ds.Tables("RIAD")
        builderRiad = New SqlCommandBuilder(adapterRiad)
    End Sub

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim dialog As DialogResult = MessageBox.Show("Voulez vous vraiment ajouter cette personne ?", "Confirmation", MessageBoxButtons.YesNo)
        If (dialog = DialogResult.Yes) Then

            ds.Tables("RIAD").Rows.Add(nomR.Text, AdresseRueR.Text, CInt(CodePostalR.Text), VilleR.Text, TelephoneR.Text, NomContactR.Text, _
CInt(CodeReg.Text), CInt(NombreDePlaces.Text))
            For Each c As Control In Me.Controls
                If TypeOf (c) Is TextBox Then
                    c.Text = String.Empty
                End If
            Next
            adapterRiad.InsertCommand = builderRiad.GetInsertCommand
            adapterRiad.Update(ds, "RIAD")

        End If
    End Sub 
```

但是当我点击按钮 Ajouter 我得到这个错误：

> *输入字符串的格式不正确。无法存储在 NumeroR 列中。预期类型是 Int32。*

`<eeeee>`是我试图在 NomR 文本字段中写入的值，而 VB.net 正在尝试以 NomR 文本字段的值作为主键保存新行，但主键是标识。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:28:46.593

而不是使用[Rows.Add()](http://msdn.microsoft.com/en-US/library/07wwak56%28v=vs.110%29.aspx)方法，您可能想要明确说明哪个字段在哪里......这是更多代码，但会阻止框架代表您做出假设。

[这](http://msdn.microsoft.com/en-us/library/5ycd1034%28v=vs.80%29.aspx?cs-save-lang=1&cs-lang=vb#code-snippet-3)是一个参考。相关部分是“将新记录插入无类型数据集”

因此，您可以执行以下操作：

```
Dim newRiadRow As DataRow = ds.Tables("RIAD").NewRow()

newCustomersRow("NomR") = nomR.Text
newCustomersRow("AdresseRueR") = AdresseRueR.Text
'More fields here

ds.Tables("RIAD").Rows.Add(newRiadRow) 
```

# php - 更新购物车上的 Magento 302 错误

> ID：15581863
> 
> 赞同：1
> 
> 时间：2013-03-23T00:21:11.873
> 
> 标签：php, apache, magento, shopping-cart, http-status-code-302

我有一个草稿网站[http://fazeee3.com](http://fazeee3.com)

当我将商品添加到购物车时，它会正确运行。但是当我尝试更新购物车中的数量时，它会将数组正确发布到[http://fazeee3.com/checkout/cart/updatePost/](http://fazeee3.com/checkout/cart/updatePost/)但服务器的响应是 302“临时不可用”

这个错误应该存在哪里？.htaccess / CartController / 还是什么？

我试图死（）；在购物车控制器中的许多代码部分，但我看到这一行 (76) 是问题所在

```
 $returnUrl = $this->getRequest()->getParam('return_url'); 
```

此行位于“_goBack”

请指教？！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-23T07:35:13.857

尝试添加到表单

```
<input type="hidden" name="form_key" value="<?php echo Mage::getSingleton('core/session')->getFormKey(); ?>" /> 
```

# asp.net - 名称 xxx 在特定上下文中不存在

> ID：15581872
> 
> 赞同：0
> 
> 时间：2013-03-23T00:21:50.953
> 
> 标签：asp.net

为什么每当我尝试调试我的代码时，我总是在 VS 中收到以下错误消息？

```
Error   2   The name 'Password' does not exist in the current context   Login.aspx.cs   22  22  Team13
Error   1   The name 'UserName' does not exist in the current context   Login.aspx.cs   21  27  Team13 
```

这是我的 Login.aspx 代码

```
 <form id="loginForm" runat="server">
    <div id="login_box" runat="server">
        <!-- LOGIN BOX -->
            <asp:Login ID="Login1" runat="server" OnAuthenticate="Login1_Authenticate" Width="293px"
                Height="172px">
                <LayoutTemplate>
                    User Name:<br />
                    <asp:DropDownList ID="UserName" runat="server" DataSourceID="SqlDataSource1" DataTextField="dept"
                        DataValueField="id" Width="200px">
                    </asp:DropDownList>
                    <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:team13ConnectionString %>"
                        SelectCommand="SELECT [id],[dept] FROM [ts_dept] ORDER BY [id]"></asp:SqlDataSource>
                    <br /><br />
                    Password:<br />
                    <asp:TextBox ID="Password" runat="server" TextMode="Password"></asp:TextBox>
                    <asp:RequiredFieldValidator ID="PasswordRequired" runat="server" ControlToValidate="Password"
                        ErrorMessage="Password is required." ToolTip="Password is required." ValidationGroup="Login1">*</asp:RequiredFieldValidator>
                    <asp:CheckBox ID="RememberMe" runat="server" Text="Remember me next time." />
                    <asp:Literal ID="FailureText" runat="server" EnableViewState="False"></asp:Literal>
                    <a href="http://89.200.143.163/~team13/login.php">Switch to PMW</a>
                    <asp:Button ID="LoginButton" runat="server" CommandName="Login" Text="Log In" ValidationGroup="Login1" />
                </LayoutTemplate>
            </asp:Login>
        </div>
    </form> 
```

这是我的 Login.aspx.cs 代码

```
using System;
using System.Collections;
using System.Configuration;
using System.Data.SqlClient;
using System.Data;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.HtmlControls;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Xml.Linq;
using System.Web.Configuration;

public partial class login : System.Web.UI.Page
{

    protected void Login1_Authenticate(object sender, AuthenticateEventArgs e)
    {
        string username = Login1.UserName;
        string pwd = Login1.Password;

        string strConn;
        strConn = WebConfigurationManager.ConnectionStrings["team13ConnectionString"].ConnectionString;
        SqlConnection Conn = new SqlConnection(strConn);
        Conn.Open();

        string sqlUserName;
        sqlUserName = "SELECT id,pass FROM ts_dept ";
        sqlUserName += " WHERE (id ='" + username + "')";
        sqlUserName += " AND (pass ='" + pwd + "')";
        SqlCommand com = new SqlCommand(sqlUserName, Conn);

        string CurrentName;
        CurrentName = (string)com.ExecuteScalar();

        if (CurrentName != null)
        {
            Session["UserAuthentication"] = username;
            Session.Timeout = 1;
            Response.Redirect("Default.aspx");
        }
        else
        {
            Session["UserAuthentication"] = "";
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T01:51:45.340

这些控件位于`Login`自定义控件内。即使您在页面中“看到它们”，您也只能使用以下命令实际访问它们`FindControl`：

```
TextBox txtUserName = Login1.FindControl("UserName") as TextBox; 
```

# jquery - 设置数据属性相等的不同div的高度

> ID：15581874
> 
> 赞同：1
> 
> 时间：2013-03-23T00:22:10.013
> 
> 标签：jquery, html

我的问题是我想通过使用数据属性来设置不同 div 的高度。我的 HTML 标记如下所示：

```
<div data-curriculum="person">
   <h2>Person</h2>
</div>
<div data-curriculum="edc">
   <h2>education</h2>
</div>
[...]
<div class="row-group" data-rowgroup="person">
     [.. stuff ..]
</div>
<div class="row-group" data-rowgroup="edc">
     [.. stuff ..]
</div>
[...] 
```

好吧，我可以用这段代码来实现它：

```
var rowGroup = $("[data-rowgroup*='person']").height();

$("div[data-curriculum*='person']").height(rowGroup); 
```

但我不想为每个 div 或 group 写下代码。我想做动态的。就像 data-rowgroup 的值为 XXX 一样，搜索具有相同值的 data-curriculum 并将 data-curriculum 的高度设置为与 data-rowgroup 的 div 高度相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:37:39.657

使用 CSS 可能有更好的方法来实现这种效果，但是如果你想像你问的那样用 jQuery 设置高度，这里有一个解决方案：

循环遍历`.row-group`div 并执行与之前相同的操作，但替换硬编码的字符串：

```
$(".row-group").each(function () {
  var name = $(this).data("rowgroup"); // accesses data-rowgroup attribute
  var rowGroupHeight = $(this).height();
  $("div[data-curriculum*='" + name + "']").height(rowGroupHeight);
} 
```

# python - python中的ctypes与memset一起崩溃

> ID：15581881
> 
> 赞同：5
> 
> 时间：2013-03-23T00:22:34.220
> 
> 标签：python, ctypes, ipython

我正在尝试从内存中删除密码字符串，[就像这里建议的那样](https://stackoverflow.com/questions/982682/mark-data-as-sensitive-in-python/983525#983525)。

我写了那个小片段：

```
import ctypes, sys

def zerome(string):
    location = id(string) + 20
    size     = sys.getsizeof(string) - 20
    #memset =  ctypes.cdll.msvcrt.memset
    # For Linux, use the following. Change the 6 to whatever it is on your computer.
    print ctypes.string_at(location, size)
    memset =  ctypes.CDLL("libc.so.6").memset
    memset(location, 0, size)
    print "Clearing 0x%08x size %i bytes" % (location, size)
    print ctypes.string_at(location, size)

a = "asdasd"

zerome(a) 
```

奇怪的是，这段代码在 IPython 上运行良好，

```
[7] oz123@yenitiny:~ $ ipython a.py 
Clearing 0x02275b84 size 23 bytes 
```

但与 Python 崩溃：

```
[8] oz123@yenitiny:~ $ python a.py 
Segmentation fault
[9] oz123@yenitiny:~ $ 
```

任何想法为什么？

我使用 Python 2.7.3 在 Debian Wheezy 上进行了测试。

### 小更新...

该代码适用于 CentOS 6.2 和 Python 2.6.6。代码在使用 Python 2.6.8 的 Debian 上崩溃。我试着思考为什么它可以在 CentOS 上运行，而不是在 Debian 上运行。唯一不同的原因是我的 Debian 是多架构的，而 CentOS 运行在我的带有 i686 CPU 的旧笔记本电脑上。

因此，我重新启动了我的 CentOS 笔记本电脑并在其上加载了 Debian Wheezy。该代码适用于非多架构的 Debian Wheezy。因此，我怀疑我在 Debian 上的配置有些问题......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-23T01:06:45.157

ctypes 已经有一个`memset`函数，所以你不必为 libc/msvcrt 函数创建一个函数指针。此外，20 字节适用于常见的 32 位平台。在 64 位系统上，它可能是 36 字节。这是 a 的布局`PyStringObject`：

```
typedef struct {
    Py_ssize_t ob_refcnt;         // 4|8 bytes
    struct _typeobject *ob_type;  // 4|8 bytes
    Py_ssize_t ob_size;           // 4|8 bytes
    long ob_shash;                // 4|8 bytes (4 on 64-bit Windows)
    int ob_sstate;                // 4 bytes
    char ob_sval[1];
} PyStringObject; 
```

所以在 32 位系统上可能是 5*4 = 20 字节，在 64 位 Linux 上可能是 8*4 + 4 = 36 字节，或者在 64 位 Windows 上可能是 8*3 + 4*2 = 32 字节。由于没有使用垃圾回收标头跟踪字符串，因此您可以使用`sys.getsizeof`. 一般来说，如果您不希望包含 GC 标头大小（在内存中它实际上位于您从中获取的对象的基地址之前`id`），则使用对象的`__sizeof__`方法。至少这是我经验中的一般规则。

您想要的只是从对象大小中减去缓冲区大小。CPython 中的字符串以空值结尾，因此只需将其长度加 1 即可获得缓冲区大小。例如：

```
>>> a = 'abcdef'
>>> bufsize = len(a) + 1
>>> offset = sys.getsizeof(a) - bufsize
>>> ctypes.memset(id(a) + offset, 0, bufsize)
3074822964L
>>> a
'\x00\x00\x00\x00\x00\x00' 
```

* * *

**编辑**

更好的选择是定义`PyStringObject`结构。这样便于检查`ob_sstate`。如果它大于 0，则意味着该字符串已被保留，并且明智的做法是引发异常。单字符字符串与仅由 ASCII 字母和下划线组成的代码对象中的字符串常量以及解释器内部用于名称（变量名称、属性）的字符串一起被实习。

```
from ctypes import *

class PyStringObject(Structure):
    _fields_ = [
      ('ob_refcnt', c_ssize_t),
      ('ob_type', py_object),
      ('ob_size', c_ssize_t),
      ('ob_shash', c_long),
      ('ob_sstate', c_int),
      # ob_sval varies in size
      # zero with memset is simpler
    ]

def zerostr(s):
    """zero a non-interned string"""
    if not isinstance(s, str):
        raise TypeError(
          "expected str object, not %s" % type(s).__name__)

    s_obj = PyStringObject.from_address(id(s))
    if s_obj.ob_sstate > 0:
        raise RuntimeError("cannot zero interned string")

    s_obj.ob_shash = -1  # not hashed yet
    offset = sizeof(PyStringObject)
    memset(id(s) + offset, 0, len(s)) 
```

例如：

```
>>> s = 'abcd' # interned by code object
>>> zerostr(s)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<string>", line 10, in zerostr
RuntimeError: cannot zero interned string

>>> s = raw_input() # not interned
abcd
>>> zerostr(s)
>>> s
'\x00\x00\x00\x00' 
```

# javascript - Javascript方法定义不一致

> ID：15581885
> 
> 赞同：0
> 
> 时间：2013-03-23T00:23:06.897
> 
> 标签：javascript

我有一个带有多种方法的 javascript 对象。但是我注意到定义方法的方式有些不一致。

这是对象：

```
function MenuObject(containerId, skin) {

    this.id = containerId;
    this.something = something2;
    .
    .
    .
    this.anotherThing = anotherThing2;      

    this.setSkin = function(skin) { //We have a function here

        //body...
    {

}

MenuObject.prototype.getTopLevelPolygon = function() //Another function.
{
   var p = this.something3;

   //Method body goes here...
} 
```

一些函数的定义类似于**this.functionName = function()**，其他的类似于**MenuObject.prototype.functionName = function()**

我只是想知道为什么不属于 MenuObject 的所有功能都定义为 MenuObject.prototype.functionName = function() ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:27:24.303

如果您不使用私有实例变量，则使用原型定义方法通常更有效，因为它们由 javascript 内部（通过原型）一举分配给新对象，而不是一次单独分配一个你自己的代码。

而且，良好的编码习惯会说，除非有特定原因，否则不应混合使用方法（并且此代码并未指出使用混合的任何特定原因）。

当您希望它们能够访问私有实例变量时，在构造函数中分配方法是有原因的：

```
function MenuObject(containerId, skin) {

    var myPrivateVariable = 0;

    this.setSkin = function(skin) {
        // method can access myPrivateVariable here, 
        //    but a method put on the prototype cannot access it
    }
} 
```

您可以在此处阅读有关私有实例变量的更多信息：http: [//javascript.crockford.com/private.html](http://javascript.crockford.com/private.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:26:59.520

好吧，简短的回答是，在构造函数中分配`this.functionName = function()`的项目是按需创建的，而使用创建的`prototype`项目更像是静态函数，因为它们存在于“函数”的实例之外并且是在程序执行时构建的，而不是到实例化时。这些不一致要么是故意的，要么是初级编程的产物（可能是更早的）。

编辑：

顺便说一句，它还有更多的东西，但细节还在继续，我想到了一件事，它还允许你在“类”中拥有“私有”功能，如果你让我称之为那。你也可以这样定义原型对象：

```
SomeFunction.prototype = {
     SomeFn1:function(){},
     SomeFn2:function(){},
     SomeFn3:function(){} // etc etc
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T00:27:13.680

不同之处在于您何时要向对象添加公共函数。

该`this.functionName = function()`方法要求您在声明对象时定义所有对象函数`function MenuObject(containerId, skin) { ... };`。

该`MenuObject.prototype.functionName = function()`方法允许您*在之前声明对象后向对象***添加附加**功能。有点像为不同的情况添加*插件*或*扩充*对象。

 **** * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-23T00:33:51.727

在构造函数中定义方法（this.method = fun..）可以通过使用闭包来使用“私有”数据。此外，每次调用构造函数时都会创建构造函数中的方法。如果在调用构造函数时不使用“new”，“this”通常会附加到全局窗口对象，因此可能会导致非常混乱和误解的错误。

在构造函数之外定义方法 (MenuObj.prototype.method = fun..) 可以在以后的代码中随时覆盖，而在构造函数内部定义总是优先，并且不能被原型修改覆盖。编辑原型会影响原型链，并可能导致非常混乱和被误解的错误。

我建议阅读 Douglas Crockford 的书籍或访问他的网站[http://www.crockford.com/](http://www.crockford.com/)并查看有关 JavaScript 的视频和文章。***

# java - Hadoop - 节省空间和多输入问题

> ID：15581886
> 
> 赞同：1
> 
> 时间：2013-03-23T00:23:11.573
> 
> 标签：java, hadoop, maven-2, compression, mapreduce

好的，所以我对 Hadoop 很陌生，并且编写了一个任务，该任务基本上处理 2 个压缩文件的文件夹，以查看总内容是否相等。

然而，我的第一次工作以 30% 失败，因为文件系统上的空间不足（我无法扩展），所以我研究了压缩并发现[这个问题](https://stackoverflow.com/questions/5571156/hadoop-how-to-compress-mapper-output-but-not-the-reducer-output?rq=1)导致我尝试 snappy，但是因为我被迫使用 hadoop 0.2 它不识别 snappy 所以我想尝试 gzip

```
conf.setBoolean("mapred.output.compress", true);
conf.set("mapred.output.compression.type", CompressionType.BLOCK.toString());
conf.setClass("mapred.output.compression.codec", GzipCodec.class, CompressionCodec.class);
conf.setBoolean("mapred.compress.map.output", true);
conf.set("mapred.map.output.compression.type", CompressionType.BLOCK.toString());
conf.setClass("mapred.map.output.compression.codec", GzipCodec.class, CompressionCodec.class); 
```

但后来我得到：

> java.io.IOException：在 org.apache.hadoop.io.compress.zlib.BuiltInGzipDecompressor.executeHeaderState 的 org.apache.hadoop.io.compress.zlib.BuiltInGzipDecompressor.processBasicHeader(BuiltInGzipDecompressor.java:490) BuiltInGzipDecompressor.java:254) 在 org.apache.hadoop.io.compress.zlib.BuiltInGzipDecompressor.decompress(BuiltInGzipDecompressor.java:183) 在 org.apache.hadoop.io.compress.DecompressorStream.decompress(DecompressorStream.java:89)在 org.apache.hadoop.io.compress.DecompressorStream.read(DecompressorStream.java:83) 在 org.apache.hadoop.io.IOUtils.wrappedReadForCompressedData(IOUtils.java:170) 在 org.apache.hadoop.mapred.IFile $Reader.readData(IFile.java:342) 在 org.apache.hadoop.mapred.IFile$Reader.rejigData(IFile.java:373) 在 org.apache.hadoop.mapred.IFile$Reader。readNextBlock(IFile.java:357) at org.apache.hadoop.mapred.IFile$Reader.next(IFile.java:389) at org.apache.hadoop.mapred.Merger$Segment.next(Merger.java:220)在 org.apache.hadoop.mapred.Merger$MergeQueue.merge(Merger.java:420) 在 org.apache.hadoop.mapred.Merger$MergeQueue.merge(Merger.java:381) 在 org.apache.hadoop.mapred .Merger.merge(Merger.java:60) at org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:414) at org.apache.hadoop.mapred.LocalJobRunner$Job.run(LocalJobRunner.java:309 )381) 在 org.apache.hadoop.mapred.Merger.merge(Merger.java:60) 在 org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:414) 在 org.apache.hadoop.mapred.LocalJobRunner $Job.run(LocalJobRunner.java:309)381) 在 org.apache.hadoop.mapred.Merger.merge(Merger.java:60) 在 org.apache.hadoop.mapred.ReduceTask.run(ReduceTask.java:414) 在 org.apache.hadoop.mapred.LocalJobRunner $Job.run(LocalJobRunner.java:309)

从阅读中我相信这是因为没有一个hadoop压缩算法可以压缩来自多个输入文件的地图输出。毫无疑问，我也需要压缩输出，但考虑到现在甚至还没有开始，我很乐意取得任何进展。

所以现在当我转向互联网寻求帮助时，我还能做些什么来减少这个占用空间，我真的需要压缩，因为我正在处理大约 20GB 的输入，而我的单节点集群上只有 50GB 可以使用（我目前正在测试环境中执行此操作，因此是单个节点并且无法使用更多资源进行测试，直到我可以显示它工作，因为我无法杀死生产集群）。

任何建议将不胜感激。

# python - DropBox 如何保护其 python 代码？

> ID：15581890
> 
> 赞同：12
> 
> 时间：2013-03-23T00:23:35.803
> 
> 标签：python, obfuscation, dropbox

我知道 DropBox 在其应用程序中使用了很多 python 代码，所以我想知道它如何保护代码不被盗，因为混淆 python 代码（[保护 python 代码](https://stackoverflow.com/questions/261638/how-do-i-protect-python-code)）似乎非常困难。

我已经阅读了将 python 代码转换为可执行文件的软件（即 pyinstaller）。DropBox 是否使用类似的软件来保护他们的代码？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-23T05:28:30.480

我刚刚尝试反编译它，但所有反编译器都失败了，因为他们不知道 dropbox pycs 中使用的幻数。所以我用谷歌搜索并发现了这个：http: [//itooktheredpill.dyndns.org/2012/dropbox-decrypt/](http://itooktheredpill.dyndns.org/2012/dropbox-decrypt/)（[archive.org 链接](https://web.archive.org/web/20141009012100/http://itooktheredpill.irgendwo.org/2012/dropbox-decrypt/)）

它说他们已经修改了解释器来加密模块并禁止访问代码对象。另外，他们会打乱操作码。

# c++ - C++中数组的指针

> ID：15581891
> 
> 赞同：2
> 
> 时间：2013-03-23T00:24:01.180
> 
> 标签：c++, arrays, pointers, methods

我在 C++ 中使用指针有一些问题。我用不同大小的数组实现了三种方法，但计算相同。所以我决定提取计算并将它们放在一个需要数组的新方法中。但这不起作用，我不知道如何修改我的程序。

```
void method1() {
  float a[3][3];
  calculate(a, 3);
}

void method2() {
  float a[4][4];
  calculate(a, 4);
}

void method3() {
  float a[5][5];
  calculate(a, 5);
}

void calculate(float *param[], int n) {
  // Code
} 
```

我知道我可以使用全局变量或向量等，但我需要这个结构中的逻辑。

这是编译器错误：

```
Test.cpp: In function 'void method1()':
Test.cpp:7:16: error: cannot convert 'float (*)[3]' to 'float**' for argument '1' to 'void calculate(float**, int)'
Test.cpp: In function 'void method2()':
Test.cpp:12:16: error: cannot convert 'float (*)[4]' to 'float**' for argument '1' to 'void calculate(float**, int)'
Test.cpp: In function 'void method3()':
Test.cpp:17:16: error: cannot convert 'float (*)[5]' to 'float**' for argument '1' to 'void calculate(float**, int)' 
```

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T00:38:31.603

```
template <int n>
void calculate(float (&param)[n][n]) {
  std::cout << param[x][y];
}

void method1() {
  float a[3][3];
  calculate(a);
} 
```

或者，如果你想支持动态大小（不太可能），你将不得不做一个奇怪的把戏，并向编译器撒谎，假装它是一个一维数组，这很快就会变得棘手。

```
int index(int x, int y, int n) {return y*n+x;}

void calculate(float* param, int n) {
    std::cout << param[index(x, y, n)];
}

void method1() {
  float a[3][3];
  calculate(a[0], 3);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T03:43:05.743

您可以使用指向指针的指针...

```
void calculate(float *param[], int n)
{
    // Code
}

void method1() {

    float **a = new float*[3];

    a[0] = new float[3];
    a[1] = new float[3];
    a[2] = new float[3];

    a[0][0] = 1.0f;
    a[0][1] = 2.0f;
    a[0][2] = 3.0f;

    a[1][0] = 4.0f;
    a[1][1] = 5.0f;
    a[1][2] = 6.0f;

    a[2][0] = 7.0f;
    a[2][1] = 8.0f;
    a[2][2] = 9.0f;

    calculate(a, 3);
}

void method2() {
    float **a = new float*[4];

    a[0] = new float[4];
    a[1] = new float[4];
    a[2] = new float[4];
    a[3] = new float[4];

    calculate(a, 4);
}

void method3() {
    float **a = new float*[5];

    a[0] = new float[5];
    a[1] = new float[5];
    a[2] = new float[5];
    a[3] = new float[5];
    a[4] = new float[5];

    calculate(a, 5);
} 
```

否则，您必须在函数签名中指定数组的列大小...

```
void calculate(float param[][3], int n) {
  // Code
}

void method1() {
  float a[3][3];
  calculate(a, 3);
}
/*
void method2() {
  float a[4][4];
  calculate(a, 4);
}

void method3() {
  float a[5][5];
  calculate(a, 5);
}*/ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T00:53:09.890

如果您希望在不使用模板的情况下传递数组，您可以执行以下操作：

```
static const int size = 3;

void calculate(float (&param)[size][size]) {
}

int main() {
  float  a[size][size];

  calculate(a);
  return 0;
} 
```

`size`也可以是一个`#define`，但我更喜欢`static const`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-23T00:41:38.473

如果您只想处理方形数组，那么您可以使用模板：

```
template <int N>
calculate(float param[N][N]) {
// code
} 
```

# r - 如何为点阵图键中的点指定特定的“填充”？

> ID：15581892
> 
> 赞同：0
> 
> 时间：2013-03-23T00:24:20.063
> 
> 标签：r, lattice

我希望工作的一个简单例子：

```
library(lattice)
xyplot(1~1, 
  key=list( 
    text=list( c("a", "b") ), 
    points=list(pch=21, fill=c("red", "blue")) ## note pch=21 => filled circle
  )
) 
```

人们会期望图例中使用的点会被填充为红色，但情况似乎并非如此。作为并行，此代码按预期工作：

```
xyplot(1~1, 
  key=list( 
    text=list( c("a", "b") ), 
    points=list(pch=21, col=c("red", "blue"))
  )
) 
```

有什么想法可以强制格子为图例点使用特定的填充吗？

# bash - Bash脚本将目录的文件读入数组

> ID：15581893
> 
> 赞同：3
> 
> 时间：2013-03-23T00:24:26.607
> 
> 标签：bash

我在 bash 中将文件读入数组时遇到问题。

我注意到人们不建议使用 ls -1 选项。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-23T00:45:22.190

获取文件列表最可靠的方法是使用 shell 通配符：

```
# First set bash option to avoid
# unmatched patterns expand as result values
shopt -s nullglob
# Then store matching file names into array
filearray=( * ) 
```

如果您需要在当前目录以外的地方获取文件，请使用：

```
filearray=( "$dir"/* ) 
```

请注意，目录路径应该用双引号括起来，以防它包含空格或其他特殊字符，但`*`不能或不会扩展为文件列表。此外，这会用文件的路径填充数组，而不仅仅是名称（例如，如果`$dir`是“path/to/directory”，filearray 将包含“path/to/directory/file1”、“path/to/directory/file2” “， ETC）。如果只需要文件名，可以使用以下命令修剪路径前缀：

```
filearray=( "$dir"/* )
filearray=( "${filearray[@]##*/}" ) 
```

如果您需要在子目录中包含文件，事情会变得有点复杂；看到[这个以前的答案](https://stackoverflow.com/questions/1116992/capturing-output-of-find-print0-into-a-bash-array/1120952#1120952)。

# python - Scapy DNS 请求仅使用 TCP 格式错误

> ID：15581894
> 
> 赞同：3
> 
> 时间：2013-03-23T00:24:31.927
> 
> 标签：python, tcp, dns, scapy

我使用 scapy 和 python 来构建我的 DNS 请求。UDP 请求没问题，但是当我想使用 TCP（**与我使用 UDP 的请求完全相同**）时，Wireshark 说我的 DNS 请求格式不正确。

这是我的python代码：

```
from scapy.all import *
ip=IP(dst="130.104.254.1")
dns = DNS(rd=1, qd=DNSQR(qname = "google.be", qtype="A"))

SYN=ip/TCP(sport=RandNum(1024,65535), dport=53, flags="S", seq=42)
SYNACK=sr1(SYN)

ACK=ip/TCP(sport=SYNACK.dport, dport=53, flags="A", seq=SYNACK.ack, ack=SYNACK.seq + 1)
send(ACK)

DNSRequest = ip/TCP(sport=SYNACK.dport, dport=53, flags="PA", seq=SYNACK.ack, ack=SYNACK.seq + 1) / dns
DNSReply = sr1(DNSRequest, timeout = 1) 
```

在我发送请求之前，三向握手已完全完成。

![这是我的wireshark错误](../Images/b29ae428a7a3299b61bc763f56694127.png)

非常感谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T14:57:42.860

经过更多研究，我在 RFC 1035 中发现：

> 4.2.2\. TCP 使用情况
> 
> 通过 TCP 连接发送的消息使用服务器端口 53（十进制）。消息以给出消息长度的两字节长度字段为前缀，不包括两字节长度字段。此长度字段允许低级处理在开始解析之前组装完整的消息。

所以解决方案在下面的代码中：

```
from scapy.all import *

ip=IP(dst="216.239.32.10")

request = DNS(rd=1, qd=DNSQR(qname = "google.be", qtype="A")) #size = 27(dec) = 1b (hex)
twoBytesRequestSize = "\x00\x1b" #BIG ENDIAN
completeRequest = str(request) + twoBytesRequestSize

SYN=ip/TCP(sport=RandNum(1024,65535), dport=53, flags="S", seq=42)
SYNACK=sr1(SYN)

ACK=ip/TCP(sport=SYNACK.dport, dport=53, flags="A", seq=SYNACK.ack, ack=SYNACK.seq + 1)
send(ACK)

DNSRequest = ip/TCP(sport=SYNACK.dport, dport=53, flags="PA", seq=SYNACK.ack, ack=SYNACK.seq + 1) / completeRequest
DNSReply = sr1(DNSRequest, timeout = 1) 
```

# iphone - 断言失败错误

> ID：15581895
> 
> 赞同：0
> 
> 时间：2013-03-23T00:24:33.283
> 
> 标签：iphone, ios, objective-c, xml, touchxml

我正在为 iPhone（用于 Cydia）制作一个动态库，并尝试使用 TouchXML 来解析 XML。当我调用这个方法时

```
+(NSArray *)initWithXMLfromData:(NSData *)data withRootElement:(NSString *)rootElement{
NSError *err;
CXMLDocument *parser = [[CXMLDocument alloc] initWithData:data options:0 error:&err];
NSArray *xml = [parser nodesForXPath:[NSString stringWithFormat:@"//%@", rootElement] error:&err];
if (err) {
    NSLog(@"%@", err);
}
return xml;
} 
```

从我的应用程序中，我从调试器中收到此错误

```
Assertion failure in -[CXMLElement description], /Users/macuser/Desktop/c/parser/TouchXML-master/Source/CXMLElement.m:287 
```

我正在使用此方法调用该方法

```
NSArray *xml = [XMLParse initWithXMLfromData:[NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://a-cstudios.com/xml.xml"]] withRootElement:@"root"];
NSLog(@"%@", [xml objectAtIndex:0]); 
```

XML的布局是这样的

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<root>
    <val>34</val>
</root> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:15:09.447

我正在使用文档示例和您的 XML，我看到您更改了 XML。以下代码适用于您在问题中发布的 xml：

```
NSMutableArray *res = [[NSMutableArray alloc] init];

CXMLDocument *doc = [[[CXMLDocument alloc] initWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://a-cstudios.com/xml.xml"]] options:0 error:nil] autorelease];
NSArray *nodes = NULL;

//  searching for val nodes
nodes = [doc nodesForXPath:@"//val" error:nil];

for (CXMLElement *node in nodes) {
    NSMutableDictionary *item = [[NSMutableDictionary alloc] init];
    int counter;
    for(counter = 0; counter < [node childCount]; counter++) {
        //  common procedure: dictionary with keys/values from XML node
        [item setObject:[[node childAtIndex:counter] stringValue] forKey:[[node childAtIndex:counter] name]];
    }

    [res addObject:item];
    [item release];
}

//  print  results
NSLog(@"%@", res);
[res release]; 
```

# android - MultiChoiceModeListener.onItemCheckedStateChanged() 仅在选中项目时执行

> ID：15581897
> 
> 赞同：3
> 
> 时间：2013-03-23T00:25:06.447
> 
> 标签：android, android-listview, android-adapter, android-checkbox

我有问题。在我的主要活动中，扩展`ListActivity`和实现`MultiChoiceModeListener`，我有覆盖的方法`onItemCheckedStateChanged()`。

问题是这个方法只有在 itrem 的新检查状态为 CHECKED 时才会执行。如果我取消选中它，它不会执行。

我以编程方式从我的`DataListAdapter`. 我的项目布局包含一个`CheckBox`，当它被选中时，我使用控件`onCheckedChanged()`来更改列表项检查状态。

有什么线索吗？

这是我的代码（仅相关代码）：

**主要活动：**

```
public class MainActivity extends ListActivity implements MultiChoiceModeListener
{
    @Override
    protected void onCreate (Bundle bundle)
    {
        super.onCreate (bundle);
        // Set our view from the "main" layout resource
        setContentView (R.layout.main);

        this.getListView().setChoiceMode(AbsListView.CHOICE_MODE_MULTIPLE_MODAL);
        this.getListView().setMultiChoiceModeListener(this);

        _dataAdapter = new ServerListAdapter (this);
        this.getListView(). setAdapter(_dataAdapter);
        registerForContextMenu (this.getListView());
    }

    public void onItemCheckedStateChanged(ActionMode mode, int position, long id, boolean isChecked) 
    {
        // Some code that only is executed when the setItemChecked is true on the DataListAdapter.        
    }
} 
```

**列表适配器**

```
public class ServerListAdapter extends BaseAdapter 
{
    @Override
    public View getView (final int position, View convertView, ViewGroup parent)
    {
        View view = (convertView == null ?
                _context.getLayoutInflater().inflate(
                R.layout.server_list_item_view,
                parent, 
                false) : convertView);

        final ListView listView = (ListView)parent;
        ((CheckBox)view.findViewById(R.id.chkItemServerSelected)).setOnCheckedChangeListener(new OnCheckedChangeListener() 
        {
            @Override
            public void onCheckedChanged(CompoundButton pCompound, boolean arg1) 
            {
                listView.setItemChecked(position, pCompound.isChecked());
            }       
        });

        return view;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T02:17:05.383

像这样试试

我已经完成了自定义多项选择 ListView，它将解决您的问题。通过以下链接获取完整的源代码。

**[http://amitandroid.blogspot.in/2013/03/android-custon-single-choice-lsitview.html](http://amitandroid.blogspot.in/2013/03/android-custon-single-choice-lsitview.html)**

这是一个单选列表视图。您需要更改并且需要更改为multipleChoice

```
 <ListView
        android:id="@+id/list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:cacheColorHint="#00000000"
        android:divider="#b5b5b5"
        android:dividerHeight="1dp"
        android:choiceMode="multipleChoice"
        android:listSelector="#00000000" />

Custom Multiple Choice ListView:- 
```

![在此处输入图像描述](../Images/21c8d376b53bb499e5f37c57cbfc9e06.png)

步骤1)

```
/**
 * 
 */
package com.custom.view;

import java.util.ArrayList;
import java.util.List;

import android.content.Context;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewGroup;
import android.widget.Checkable;
import android.widget.RelativeLayout;

public class CheckableRelativeLayout extends RelativeLayout implements
        Checkable {

    private boolean isChecked;
    private List<Checkable> checkableViews;

    public CheckableRelativeLayout(Context context, AttributeSet attrs,
            int defStyle) {
        super(context, attrs, defStyle);
        initialise(attrs);
    }

    public CheckableRelativeLayout(Context context, AttributeSet attrs) {
        super(context, attrs);
        initialise(attrs);
    }

    public CheckableRelativeLayout(Context context, int checkableId) {
        super(context);
        initialise(null);
    }

    /*
     * @see android.widget.Checkable#isChecked()
     */
    public boolean isChecked() {
        return isChecked;
    }

    /*
     * @see android.widget.Checkable#setChecked(boolean)
     */
    public void setChecked(boolean isChecked) {
        this.isChecked = isChecked;
        for (Checkable c : checkableViews) {
            c.setChecked(isChecked);
        }
    }

    /*
     * @see android.widget.Checkable#toggle()
     */
    public void toggle() {
        this.isChecked = !this.isChecked;
        for (Checkable c : checkableViews) {
            c.toggle();
        }
    }

    @Override
    protected void onFinishInflate() {
        super.onFinishInflate();

        final int childCount = this.getChildCount();
        for (int i = 0; i < childCount; ++i) {
            findCheckableChildren(this.getChildAt(i));
        }
    }

    /**
     * Read the custom XML attributes
     */
    private void initialise(AttributeSet attrs) {
        this.isChecked = false;
        this.checkableViews = new ArrayList<Checkable>(5);
    }

    /**
     * Add to our checkable list all the children of the view that implement the
     * interface Checkable
     */
    private void findCheckableChildren(View v) {
        if (v instanceof Checkable) {
            this.checkableViews.add((Checkable) v);
        }

        if (v instanceof ViewGroup) {
            final ViewGroup vg = (ViewGroup) v;
            final int childCount = vg.getChildCount();
            for (int i = 0; i < childCount; ++i) {
                findCheckableChildren(vg.getChildAt(i));
            }
        }
    }
} 
```

第2步）

p

```
ackage com.custom.view;

import android.content.Context;
import android.util.AttributeSet;
import android.view.KeyEvent;
import android.view.MotionEvent;
import android.widget.CheckBox;
public class InertCheckBox extends CheckBox {

    public InertCheckBox(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public InertCheckBox(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public InertCheckBox(Context context) {
        super(context);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        return false;
    }

    @Override
    public boolean onKeyDown(int keyCode, KeyEvent event) {
        return false;
    }

    @Override
    public boolean onKeyMultiple(int keyCode, int repeatCount, KeyEvent event) {
        return false;
    }

    @Override
    public boolean onKeyPreIme(int keyCode, KeyEvent event) {
        return false;
    }

    @Override
    public boolean onKeyShortcut(int keyCode, KeyEvent event) {
        return false;
    }

    @Override
    public boolean onKeyUp(int keyCode, KeyEvent event) {
        return false;
    }

    @Override
    public boolean onTrackballEvent(MotionEvent event) {
        return false;
    }
} 
```

Step3) listitem.xml

```
<com.custom.view.InertCheckBox
    android:id="@+id/multiitemCheckBox"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_centerVertical="true"
    android:layout_margin="5dp"
    android:focusable="false" />

<TextView
    android:id="@+id/singleitemId"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:layout_centerVertical="true"
    android:layout_marginLeft="20dp"
    android:layout_toRightOf="@+id/multiitemCheckBox"
    android:focusable="false"
    android:textSize="14sp" /> 
```

希望这对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-07T13:39:47.843

所以，我解决了我遇到的类似问题。

有几点需要考虑：

1.  BaseAdapter 默认没有稳定的 id，而要让选择/取消选择正常工作，您的适配器应该有稳定的 id。检查 AbsListView.java 源代码以确认。因此，在您的适配器实现中覆盖`hasStableIds()`方法以返回 true 并确保`getItemId(int position)`为每一行返回一个唯一的 id。

2.  不确定这第二件事是否真的有必要，但以防万一......默认情况下，列表中的实现行是不可选择的 - 它们仅在您将手指放在项目上时才会显示一些突出显示。如果您想显示某种静态突出显示并保持选中行 - 您的项目应该实现`Checkable`接口。至于我 - 我使用自定义`CheckableLinearLayout`实现作为我所有项目的基础。那行得通。您可以在互联网上找到实现或回信给我，我会在这里发布一个。

一般来说，我建议查看`AbsListView`源代码，它真的有助于理解出了什么问题

# java - 从用户输入中获取答案并传递给另一个类

> ID：15581898
> 
> 赞同：1
> 
> 时间：2013-03-23T00:25:07.367
> 
> 标签：java, string, class, user-input

我正在尝试接受用户输入，然后将该输入传递给另一个类以执行一系列检查。在这种情况下，要将答案与用户可以键入的选项列表进行比较，如果他们键入选项，将执行操作。我从一个菜单选项开始，但我在控制台中键入“菜单”，没有任何反应......程序只是终止而没有错误。

在调试中，在'return;' 值“菜单”存储在变量“答案”中。之后的下一步我得到“Thread [main] (Suspended)”和这个堆栈跟踪消息：

> Thread.exit() 行：不可用 [局部变量不可用]

如何从 main() 获得要在我的 Exec 类中识别的答案？

这是我的`main()`：

```
package program2;
public class Calculator {
    public static String answer;

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        System.out.println("Enter the word menu: ");
        String answer = sc.nextLine();
        return;
    }
} 
```

这是我尝试执行操作的 Exec 类：

```
package program2;

public class Exec {
    String newAnswer = Calculator.answer;

    public Exec (String answer){        
        if (newAnswer.equals("menu")){
            menu();
        }   
    } 
    public static void menu(){
        System.out.printf("%-30s %-30s %-30s%n", "Enter value: enter", "Duplicate: dup" "Exp:exp");        
    }
} 
```

我也尝试过像这样更简单的方法（收到相同的回复）：

```
package program2;
public class Calculator {
    public static String answer;

    public static void main(String[] args) {
        answer = "menu";
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:38:17.900

对于初学者，您需要从 main 实例化一个 Exec 实例，并将其传递给 Exec... 即：

```
String answer = sc.nextLine();
Exec ex = new Exec(answer);
return; 
```

从那里开始，它应该可以工作。它说没有更多可用的变量，因为您的程序以该返回语句结束......

但是您的 Exec 类中也有问题.... newAnswer 未分配，您正在测试它是否相等...您将收到另一个错误...

编辑：

ugg .. 它比那更糟糕...不要重新声明答案，使用`this.answer`...您正在声明一个新的局部变量。

# javascript - 搜索结果在 Internet Explorer 9 及更低版本中显示最下方的页面

> ID：15581901
> 
> 赞同：0
> 
> 时间：2013-03-23T00:25:32.920
> 
> 标签：javascript, php, html, internet-explorer, html-table

我使用 PHP 和 Javascript 构建了一个相当简单的站点来返回一个充满搜索结果的表格，但由于某种原因，我的充满搜索结果的表格在 Internet Explorer 9 及更低版本中返回了大约 2 页。结果在包括移动设备在内的现代浏览器中看起来不错。我发现推送结果的页面下方的距离与返回的结果数量成正比。此外，如果返回数千个结果，我可以在 Android 平板电脑上平移到空白区域，通常宽度是固定的。

```
 <table width='100%' class="table table-bordered table-hover table-condensed">

            <colgroup width='18%'/>
            <colgroup id='colgroup' class='colgroup' align='center'
                    valign='middle' title='title' width='1*' span='3' />

            <thead>
                <tr>
                    <th>Drawing</th>
                    <th>Project Title</th>
                    <th>Sheet Title</th>
                    <th>Drawing Date</th>
                </tr>
            </thead>

            <tbody>

         <?php

            // gets value sent over search form
            $locnum = $_GET['locnum']; 
            $drawnum = $_GET['drawnum']; 
            $projttitle = $_GET['projtitle']; 
            $shttitle = $_GET['shttitle']; 
            $shtnum = $_GET['shtnum']; 
            $discp = $_GET['discp']; 
            $drawdate = $_GET['drawdate']; 

            //set minimum query length
            $min_length = 2;

            // if query length is more or equal minimum length then 
            if(strlen($locnum) OR strlen($drawnum) OR strlen($projttitle) OR strlen($shttitle) OR strlen($shtnum) OR strlen($discp) OR strlen($drawdate) >= $min_length){ // if query length is more or equal minimum length then

                // changes characters used in html to their equivalents, for example: < to &gt;
                $locnum = htmlspecialchars($locnum); 
                $drawnum = htmlspecialchars($drawnum); 
                $projttitle = htmlspecialchars($projttitle); 
                $shttitle = htmlspecialchars($shttitle); 
                $shtnum = htmlspecialchars($shtnum); 
                $discp = htmlspecialchars($discp); 
                $drawdate = htmlspecialchars($drawdate); 

                // makes sure nobody uses SQL injection
                //mysql_real_escape_string is deprecated as of PHP 5.5.0 and will be removed in the future
                $locnum = mysql_real_escape_string($locnum);
                $drawnum = mysql_real_escape_string($drawnum);
                $projttitle = mysql_real_escape_string($projttitle);
                $shttitle = mysql_real_escape_string($shttitle);
                $shtnum = mysql_real_escape_string($shtnum);
                $discp = mysql_real_escape_string($discp);
                $drawdate = mysql_real_escape_string($drawdate);

                //this query isn't perfect...ideally Location Number would be an exact match rather than containing the variable, but if I make that change, it becomes impossible to search on the other fields while $locnum is blank     
                $raw_results = mysql_query("SELECT * FROM draw
                    WHERE (`LocationNumber` LIKE '".$locnum."%' && `DrawingNumber` LIKE '%".$drawnum."%' && `ProjectTitle` LIKE '%".$projttitle."%' && `SheetTitle` LIKE '%".$shttitle."%' && `SheetNumber` LIKE '%".$shtnum."%' && `Discipline` LIKE '%".$discp."%' && `DrawingDate` >= '".$drawdate."%') ORDER BY LocationNumber, DrawingNumber, Discipline, SheetNumber") or die(mysql_error());
                    //ORDER BY LocationNumber, DrawingNumber, Discipline

                //'%$locnum%' has wildcards built in
                //if you want exact match use `field`='$locnum'
                // or if you want to match just full word use '% $locnum %' ...OR ... '$locnum %' ... OR ... '% $locnum'

                //Number of results 
                echo "<p><b>".mysql_num_rows($raw_results)." results"."</b>";

                //Sort order dropdown
                echo
                    "&nbsp Click any table heading <b>to sort</b> search results. <b>To save</b> a PDF, right-click link and choose Save-As or similar.</p>";

                //begin while loop
                if(mysql_num_rows($raw_results) > 0){ // if one or more rows are returned do following

                    while($results = mysql_fetch_array($raw_results)){
                    // $results = mysql_fetch_array($raw_results) puts data from database into array, while it's valid it does the loop

        //I need to replace all "\" in the 'Path' field with "/".  The hyperlink works fine in Chrome but not Firefox...haven't tried IE yet               
          echo "<tr>"."<td><b>"."<a href= http://facilities.ucsb.edu/_client/pdf/atlas/drawings/".$results['Path'].">".$results['LocationNumber']." - ".$results['DrawingNumber'].", ".$results['SheetNumber'].", ".substr($results['Discipline'],0,4)." </a></b></td>&nbsp&nbsp<td>".$results['ProjectTitle']."</td><td>".$results['SheetTitle']."</td><td>".substr($results['DrawingDate'],0,10)."</td></tr>";
                        // posts results gotten from database(title and text) you can also show id ($results['id'])

                    }

                }
                else{ // if there is no matching rows do following
                    echo "No results";
                }

            }

            else{ // if query length is less than minimum
                echo "Minimum search length is ".$min_length;
            }

        ?>
                <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
                <script src="js/jquery.sortElements.js"></script>
                <script>
                    var th = jQuery('th'),
                        li = jQuery('li'),
                        inverse = false;

                    th.click(function(){

                        var header = $(this),
                            index = header.index();

                        header
                            .closest('table')
                            .find('td')
                            .filter(function(){
                                return $(this).index() === index;
                            })
                            .sortElements(function(a, b){

                                a = $(a).text();
                                b = $(b).text();

                                return (
                                    isNaN(a) || isNaN(b) ?
                                        a > b : +a > +b
                                    ) ?
                                        inverse ? -1 : 1 :
                                        inverse ? 1 : -1;

                            }, function(){
                                return this.parentNode;
                            });

                        inverse = !inverse;

                    });

                    $('button').click(function(){
                        li.sortElements(function(a, b){
                            return $(a).text() > $(b).text() ? 1 : -1;
                        });
                    });
                </script>
        </tbody>
        </table> 
```

关于如何使它与至少 IE9 兼容的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:47:30.483

我认为这个问题很可能是你有`<div>`一些内容（“点击排序”等）作为你的直接孩子（第一个孩子）`<tbody>`，这是无效的，我可以想象这会让 IE9 吓坏了。你也有`</td>&nbsp;&nbsp;<td>`在桌子的中间，这可能是有问题的。尝试删除这些并将该 div 移到表格外部或将其放入内部`<tr><td></td></tr>`，看看布局是否有所改善。

# c++ - sizeof 用于字符串矩阵

> ID：15581904
> 
> 赞同：3
> 
> 时间：2013-03-23T00:26:32.877
> 
> 标签：c++, arrays, matrix, sizeof

评论很好地解释了这一切。帮助？

```
 string aZOM[][2] = {{"MoraDoraKora", "PleaseWorkFFS"},{"This is a nother strang.", "Orly?"}};
cout << sizeof("MoraDoraKora") <<" \n";
//Obviously displayes the size of this string...
cout << sizeof(aZOM[0][0]) << " \n";
//here's the problem, it won't display the size of the actual string... erm, what?

string example = aZOM[0][0];
cout << example << " \n";
cout << aZOM[0][1] << " \n";
//Both functions display the string just fine, but the size of referencing the matrix is the hassle. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T00:28:35.460

`sizeof`以字节为单位为您提供传递给它的对象的大小。如果你给它 a `std::string`，它会给你`std::string`对象本身的大小。现在该对象我为实际字符动态分配存储空间并包含指向它们的指针，但这不是对象本身的一部分。

要获取 a 的大小`std::string`，请使用它的[`size`/`length`](http://en.cppreference.com/w/cpp/string/basic_string/size)成员函数：

```
cout << aZOM[0][1].size() << " \n"; 
```

*工作正常*的原因是`sizeof("MoraDoraKora")`字符串文字`"MoraDoraKora"`不是对象。它的类型是“array of 13 ”，因此以字节为单位报告该数组的大小。*`std::string``const` `char1``sizeof`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T00:29:51.487

`sizeof`返回类型的大小，而不是指向的数据的大小。

字符串通常是指向 char 的指针，其中链中的最后一个 char 的值为 0。

如果你想要字符串的实际大小，你可以使用`aZOM[0][0].length()`*

# jquery - Jquery下拉菜单 - 图像的css悬停重叠

> ID：15581915
> 
> 赞同：0
> 
> 时间：2013-03-23T00:27:55.087
> 
> 标签：jquery, css, drop-down-menu, menu

我有以下 jquery 下拉菜单：

[http://kwedsd.byethost7.com/2.html](http://kwedsd.byethost7.com/2.html)

当您悬停任何顶级链接时，会出现一个绿色水平条（悬停状态），如果您仔细查看绿色水平条与边框重叠购买大约 2 px，请任何人都可以建议我如何更改 css 以阻止这种重叠发生。

另外为了方便查看，我还附上了一张图片。（红色方块显示重叠）

![在此处输入图像描述](../Images/ba4e4c966e5fae0c04b3ba8a15cc74d4.png)

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:34:09.527

设置以下为我解决了它：

```
.ddsmoothmenu ul li a {
  margin-right:2px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:35:36.953

实际上，这不是边框，而是`<li>`看起来像边框的元素的背景图像。因此，它实际上在里面`<li>`，因此可以被`<a>`里面的标签覆盖。由于`<a>`具有透明背景，因此在添加 :hover 边框之前不会显示问题。尝试在 上设置背景颜色`<a>`，您会看到它覆盖了`<li>`.

添加一个`padding-right: 2px`到`<li>`你应该很好，因为这将保护背景图像的“边框状”位不被`<a>`.

# string - 我怎么能用帕斯卡做到这一点

> ID：15581918
> 
> 赞同：0
> 
> 时间：2013-03-23T00:28:25.803
> 
> 标签：string, integer, freepascal

我怎么能用帕斯卡做到这一点？

```
ISBN=input('Please enter the 10 digit number: ')

while len(ISBN)!= 10:

    print('Please make sure you have entered a number which is exactly 10 characters long.')
    ISBN=int(input('Please enter the 10 digit number: '))
    continue

else:

    Digit1=int(ISBN[0])*11
    Digit2=int(ISBN[1])*10
    Digit3=int(ISBN[2])*9
    Digit4=int(ISBN[3])*8
    Digit5=int(ISBN[4])*7
    Digit6=int(ISBN[5])*6
    Digit7=int(ISBN[6])*5
    Digit8=int(ISBN[7])*4
    Digit9=int(ISBN[8])*3
    Digit10=int(ISBN[9])*2
    Sum=(Digit1+Digit2+Digit3+Digit4+Digit5+Digit6+Digit7+Digit8+Digit9+Digit10)
    Mod=Sum%11
    Digit11=11-Mod
    if Digit11==10:
       Digit11='X'
    ISBNNumber=str(ISBN)+str(Digit11)
    print('Your 11 digit ISBN Number is ' + ISBNNumber) 
```

# rvm - rvm requirements 'osx_brew 的加载要求失败！'

> ID：15581926
> 
> 赞同：4
> 
> 时间：2013-03-23T00:29:23.653
> 
> 标签：rvm, homebrew

我今天尝试在我的 Mac（OS X 10.8.3）上安装 Ruby 2.0.0-p0，但由于 gem 安装方面的一些问题而失败（不幸的是我没有保留错误日志）。

从那以后，我在使用 RVM 和 Brew 时遇到了问题——如果我尝试对 RVM 做任何事情，它只会打印错误消息：

```
Failed loading requirements for osx_brew! 
```

我已尝试删除并重新安装 RVM 和 Brew，但没有成功，而且我在 Internet 上找不到对此消息的任何引用。有人知道为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-23T00:38:51.283

同样的问题，我需要更新 rvm - 确保之后阅读要求；

```
rvm get stable
rvm requirements 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:39:44.590

似乎是上一个版本的 RVM 的问题。我也有同样的问题...您需要尝试安装稳定版本...

rvm 稳定下来

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-23T09:03:01.240

这是一个错误，已经修复，更新：

```
rvm get head
rvm install ruby --autolibs=4 
```

# javascript - 卡在数字和字母随机化javascript上

> ID：15581927
> 
> 赞同：3
> 
> 时间：2013-03-23T00:29:36.833
> 
> 标签：javascript, jquery

所以我被困在这个脚本上，无法弄清楚如何完成它。我需要它在完成动画后将 new_string 更改为旧字符串，然后`setInterval`在 1 或 2 分钟后将相同的动画从新的旧字符串运行到​​我将从 JSON 中获取的新字符串。这是脚本：

```
$(document).ready(function () {
    var old_string = "first word";
    var new_string = "second word";

    while (old_string.length < new_string.length) {
        old_string += " ";
    }
    while (new_string.length < old_string.length) {
        new_string += " ";
    }

    for (i = 0; i < 18; i++) {
        var cell_id = create_cell();
        cycle_characters(old_string.charCodeAt(i), new_string.charCodeAt(i), cell_id);
    }
});

var create_cell = function() {
    var $rack = $("#rack");
    var cell_id = "cell_" + $("#rack .cell").size() + 1;
    $rack.append($("<span class='cell first_run'>").attr("id", cell_id));
    return cell_id;
}

var cycle_characters = function (old, newer, cell_id) {
    // 32 = space; 126 = tilde
    // low-range ASCII only
    var lower_limit = 32;
    var upper_limit = 126;

    var old = parseInt(old);
    var newer = parseInt(newer);

    if (old > upper_limit || old < lower_limit) {
        old = lower_limit;
    }
    if (newer > upper_limit || newer < lower_limit) {
        newer = lower_limit;
    }

    if ("string" != typeof cell_id) {
        cell_id = $(cell_id).attr("id");
    }

    var $cell = $("#" + cell_id);

    $cell.text(String.fromCharCode(old));
    if (newer != old) {
        var call = "cycle_characters(" + (old + 1) + ", " + newer + ", " + cell_id + ")";
        if ($cell.hasClass("first_run")) {
          $cell.removeClass("first_run");
          setTimeout(call, 1000);
        } else {
          setTimeout(call, 20);
        }
    }

} 
```

这里也是一个[JsFiddle](http://jsfiddle.net/ktEJy/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T04:26:40.613

这是一个更新的示例，可能正在执行您想要的操作：

[http://jsfiddle.net/ktEJy/2/](http://jsfiddle.net/ktEJy/2/)

请注意，该`setNewWord`函数显然需要从其他来源中提取下一个单词，而不是像我正在做的数组中的随机单词。

对于后代，这里是代码：

```
$(document).ready(function () {
    var old_string = "First Word";
    var new_string = "Second Word";

    function doTheDo() {
        $('#rack').html("");
        while (old_string.length < new_string.length) {
            old_string += " ";
        }
        while (new_string.length < old_string.length) {
            new_string += " ";
        }

        for (i = 0; i < new_string.length; i++) {
            var cell_id = create_cell();
            cycle_characters(old_string.charCodeAt(i), new_string.charCodeAt(i), cell_id);
        }
    }

    function setNewWord() {
        // grab the word from some json
        words = ['Abracadabra', 'Foo bar baz splat', 'Bingo Dingo Ringo']
        new_string = words[Math.floor(Math.random() * words.length)]
        doTheDo();
    }

    function create_cell() {
        var $rack = $("#rack");
        var cell_id = "cell_" + $("#rack .cell").size() + 1;
        $rack.append($("<span class='cell first_run'>").attr("id", cell_id));
        return cell_id;
    }

    function cycle_characters(old, newer, cell_id) {
        // 32 = space; 126 = tilde
        // low-range ASCII only
        var lower_limit = 32;
        var upper_limit = 126;

        var old = parseInt(old);
        var newer = parseInt(newer);

        if (old > upper_limit || old < lower_limit) {
            old = lower_limit;
        }
        if (newer > upper_limit || newer < lower_limit) {
            newer = lower_limit;
        }

        if ("string" != typeof cell_id) {
            cell_id = $(cell_id).attr("id");
        }

        var $cell = $("#" + cell_id);

        $cell.text(String.fromCharCode(old));

        var current = '';
        $('.cell').each(function (el, i) {
            current += $(i).text(); //console.info(i);
        });

        if (current != new_string && newer != old) {
            if ($cell.hasClass("first_run")) {
                $cell.removeClass("first_run");
                setTimeout(function() {cycle_characters(old+1, newer, cell_id);}, 1000);
            } else {
                setTimeout(function() {cycle_characters(old+1, newer, cell_id);}, 20);
            }
        } else if (current == new_string) {
            old_string = new_string;
            setTimeout(function() { setNewWord();}, 3000);
        } 
    }
    doTheDo();
}); 
```

# java - Java Swing 的多种问题

> ID：15581928
> 
> 赞同：1
> 
> 时间：2013-03-23T00:29:37.520
> 
> 标签：java, swing, webpage

我对 Java 图形用户界面非常缺乏经验，我只使用 Java 的 GUI 库，因为它对我目前想要实现的目标很方便。我有一个 JPanel，其中有……多个问题。

*   JEdi​​torPane 位于文本之上，使 JLabel 黯然失色。
*   JPanel 周围没有出现边框。
*   当 GUI 打开时，它的大小被调整到最小。
*   JEdi​​torPane 未调整大小。
*   尝试添加网格布局不起作用。它读到我的`Exception in thread "AWT-EventQueue-0" java.lang.IllegalArgumentException: cannot add to layout: constraint must be a string (or null)`错误。
*   **为新手问题欢呼：如何添加边框？**

这是我的代码：

```
import java.awt.*;
import java.awt.event.*; 
import java.awt.image.*;
import java.io.*;    
import javax.imageio.*;
import javax.swing.*; 
import javax.activation.MimetypesFileTypeMap;

public class UpdateMechanism {
    private static void showGUI() {
        JFrame frame = new JFrame("The Neverhood Restoration Project");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        BufferedImage icoImage = null;
        try {
            icoImage = ImageIO.read(
                frame.getClass().getResource("/nhood.bmp"));
        } catch (IOException e) {
            System.out.println(e);
        }
        frame.setIconImage(icoImage);

        JPanel heapPanel = new JPanel(); 
        frame.setSize(new Dimension(1024, 600));
        heapPanel.setBackground(new Color(0xA64343));

        JLabel headerLabel = new JLabel("The Neverhood Restoration Project");
        headerLabel.setHorizontalTextPosition(JLabel.CENTER);

        try {
            Font sFont = Font.createFont(Font.TRUETYPE_FONT, new File("DUGFB___.TTF")); 
            sFont = sFont.deriveFont(Font.PLAIN, 48);
            GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment(); 
            ge.registerFont(sFont);
            headerLabel.setFont(sFont);
        } catch (FontFormatException|IOException e) { 
            System.out.println(e); 
        }

        JEditorPane updateLog = new JEditorPane(); 
        updateLog.setSize(800, Short.MAX_VALUE);
        JScrollPane scrollPane = new JScrollPane(updateLog);   
        updateLog.setEditable(false);   

        try {
            updateLog.setPage("http://theneverhood.sourceforge.net/");
        } catch (IOException e) {
            updateLog.setContentType("text/html");
            updateLog.setText("<html>The application could not load the webpage.</html>");
        }   

        frame.add(headerLabel);
        frame.add(scrollPane);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                showGUI();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:41:27.163

不要在组件上使用 setSize() 方法。布局管理器可以使用首选/最小/最大尺寸来确定如何根据布局管理器的规则布置组件。而是做

```
//updateLog.setSize(800, Short.MAX_VALUE);
JScrollPane scrollPane = new JScrollPane(updateLog);   
scrollPane.setPreferredSize( new Dimension(800, 400) ); 
```

> JEdi​​torPane 位于文本之上，使 JLabel 黯然失色。

JFrame 默认使用 BorderLayout。此外，默认情况下，所有组件都会添加到中心，但仅显示最后添加的组件。尝试：

```
//frame.add(headerLabel);
frame.add(headerLabel, BorderLayout.NORTH); 
```

这行代码什么也不做，因为您稍后会在帧上调用 pack()：

```
frame.setSize(new Dimension(1024, 600)); 
```

> 如何添加边框？

请参阅 Swing 教程中有关[如何使用边框](http://docs.oracle.com/javase/tutorial/uiswing/components/border.html)的部分。阅读教程中的其他部分也没有什么坏处。布局管理器上有一个。

编辑：

> 如何将“BorderLayout.NORTH”中的文本居中

阅读 JLabel API。您应该使用另一种 setHorizo​​ntalXXX() 方法，而不是您尝试使用的方法：

> 为什么他的背景颜色不显示？

什么是堆面板？为什么设置它的颜色会做任何事情？您没有将面板添加到框架或向其中添加任何组件。

如果要更改框架的背景，则需要访问内容窗格。再次了解为什么您需要阅读有关如何制作框架的 Swing 教程，该教程解释了内容窗格。

```
 frame.getContentPane().setBackground(new Color(0xA64343)); 
```

为什么他的背景颜色不显示？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-23T00:44:16.690

您正在将两个组件添加到框架`CENTER`的默认位置。`BorderLayout`如果您将标头添加到 中`NORTH`，则效果很好。

`setSize`如果您调用，请不要调用框架`pack()`。

`updateLog.setSize(800, Short.MAX_VALUE);`也是无用的，因为包装滚动窗格的视口也有自己的布局，它将覆盖您的调用。

关于边界，您可以调用`setBorder`并提供任何工厂值`BorderFactory`或提供您自己的实现。

查看您的代码的更新版本：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.FontFormatException;
import java.awt.GraphicsEnvironment;
import java.io.File;
import java.io.IOException;

import javax.swing.JEditorPane;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

public class UpdateMechanism {
    private static void showGUI() {
        JFrame frame = new JFrame("The Neverhood Restoration Project");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JPanel heapPanel = new JPanel();
        frame.setSize(new Dimension(1024, 600));
        heapPanel.setBackground(new Color(0xA64343));

        JLabel headerLabel = new JLabel("The Neverhood Restoration Project");
        headerLabel.setHorizontalTextPosition(JLabel.CENTER);

        try {
            Font sFont = Font.createFont(Font.TRUETYPE_FONT, new File("DUGFB___.TTF"));
            sFont = sFont.deriveFont(Font.PLAIN, 48);
            GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
            ge.registerFont(sFont);
            headerLabel.setFont(sFont);
        } catch (FontFormatException | IOException e) {
            System.out.println(e);
        }

        JEditorPane updateLog = new JEditorPane();
        JScrollPane scrollPane = new JScrollPane(updateLog);
        updateLog.setEditable(false);

        try {
            updateLog.setPage("http://theneverhood.sourceforge.net/");
        } catch (IOException e) {
            updateLog.setContentType("text/html");
            updateLog.setText("<html>The application could not load the webpage.</html>");
        }

        frame.add(headerLabel, BorderLayout.NORTH);
        frame.add(scrollPane);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                showGUI();
            }
        });
    }
} 
```

# javascript - 如何停止表单提交并使用 javascript 进行验证？

> ID：15581933
> 
> 赞同：0
> 
> 时间：2013-03-23T00:30:02.800
> 
> 标签：javascript, forms, validation, expressionengine

我遇到了一个看起来像这样的表格，我无法更改：

```
<form id="mx_locator" name="mx_locator" method="post" action="search-results">

  <!-- form elements -->
  <span><input type="image" src="/images/search.png" onclick="loader()"></span>

</form> 
```

它位于 CMS 内部，知道在单击时转发表单数据并生成结果页面。加载器函数调用只是处理添加/删除一个类以获得某种效果。

我被要求编写一个验证表单的 javascript。有一个邮政编码字段和一个城市字段。必须填写其中一项。不是两者，而是其中之一。因此，当有人单击该按钮时，我的 javascript 必须停止提交，检查这些字段，并且只有在它们良好的情况下才能继续。

简而言之，我该怎么做呢？最重要的是，我担心无论 js 做什么，表单都会处理，因为 CMS 正在控制它。我根本无法更改表单 html。我可以添加JS。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:41:59.773

首先将 onsubmit 属性添加到表单标签。

```
<form id="mx_locator" onsubmit="return ziporcity(this)" name="mx_locator" ... 
```

然后在您的文档中添加一个脚本标签，其中包含或链接到函数 ziporcity，您可以这样编写：

```
<script>
function ziporcity(f) { return /\d{5}/.test(f['zipFieldName'].value) || /\S/.test(f['cityFieldName'].value); }
</script> 
```

这个简单的验证函数检查一个或另一个或两者是否为真，zip 字段是否包含 5 个连续数字（9 个数字也可以通过），和/或 city 字段是否包含非空格。

您需要将 zipFieldName 更改为表单中 zip 字段的 name="..." 属性中包含的名称，并将 cityFieldName 更改为城市字段的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T01:04:23.163

```
<script> 
$(document).ready(function() {
    $("#mx_locator").submit(function() {  
      var isValid = callSomeValidationFunctionThatReturnTrueFalse();
      return isValid;  // the key is return false will prevent submit
    });
});
</script> 
```

您将需要包含 jQuery。如果在您的表单提交事件被 CMS 完全超越的地方确实很奇怪，那么只需隐藏并在其位置创建一个新表单。

```
<script> 
$(document).ready(function() {
    // save old form html and hide
    var myForm = $("#mx_locator");
    var formHtml = myForm.html();
    myForm.html("").hide();

    // append new form in its place and 
    var myNewForm = $('<form id="mx_locator2" name="mx_locator2" .../></form>');
    myNewForm.html(formHtml);
    myNewForm.insertAfter(myForm);
});
</script> 
```

# python - Python：来自 2D 图像的 3D 轮廓 - pylab 和 contourf

> ID：15581935
> 
> 赞同：3
> 
> 时间：2013-03-23T00:30:08.033
> 
> 标签：python, 3d, matplotlib, plot

我有一个关于 Python(pylab) 和绘图的问题 - 我能够加载和显示图像（下面的代码加载下面的图像），但我无法将其绘制为 3D 轮廓，我知道数组是`pylab.contourf(x,y,z)`尽管我不确定如何从加载的图像数据中实现这一点，但这是必需的。

请有任何建议和帮助。我的代码：

```
from PIL import Image
import pylab

fileName = "image1.png"
im = Image.open(fileName)
#pylab.contourf(im) # don't work - needs an array but how
pylab.axis('off')
pylab.imshow(im)
pylab.show() 
```

![image1.png](../Images/1ff9b045bff57886bddb644804d87637.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-24T16:41:01.760

您的图像可以在等高线图中表示的原因是它显然是**[伪彩色图像](http://en.wikipedia.org/wiki/False_color)**，即使用完整的 RGB 色谱来表示单个变量的图像。 **等高线图还表示具有**确定颜色的单个变量（即 Z 轴）的数据，因此您也可以将图像数据表示为等高线图。

这就是[我建议](https://stackoverflow.com/questions/15582105/python-plot-stacked-image-slices/15582454#15582454)您首先使用等高线图的原因。（但是，您在这个问题中实际要求的内容通常不存在：没有普遍有效的方法将彩色*图像*转换为等高线图，因为彩色图像通常具有三种独立的颜色，RGB 和等高线图只有一个（Z 轴），*即*，这只适用于伪彩色图像。）

要专门解决您的问题：

1) 如果您有用于创建显示的伪彩色图像的 z 轴数据，只需在等高线图中使用此数据。这是最好的解决方案。

2）如果您没有 z 数据，那就更麻烦了，因为您需要将图像中的颜色反转为 z 值，然后将其放入等高线图中。您展示的图像几乎可以肯定是使用颜色图 matplotlib.cm.jet，我找不到比[unubtu 在这里说](https://stackoverflow.com/questions/3720840/how-to-reverse-color-map-image-to-scalar-values)的更好的方法来反转它。

最后，您需要了解等高线图和图像之间的区别才能使细节发挥作用。

**`convert`为什么不起作用的演示**：
在这里，我使用从左到右的 z 值斜坡来运行完整的测试用例。很明显，z 值现在完全混乱了，因为最大的值现在是最小的，等等。

也就是说，目标就是那个图。2 匹配图。4，但他们有很大的不同。当然，问题在于`convert`它没有正确映射`jet`到原始 z 值集。

![在此处输入图像描述](../Images/702a896386a91c450156e1dc718702e4.png)

```
import numpy as np
import matplotlib.pyplot as plt
import Image

fig, axs = plt.subplots(4,1)

x = np.repeat(np.linspace(0, 1, 100)[np.newaxis,:], 20, axis=0)

axs[0].imshow(x, cmap=plt.cm.gray)
axs[0].set_title('1: original z-values as grayscale')

d = axs[1].imshow(x, cmap=plt.cm.jet)
axs[1].set_title('2:original z-values as jet')    
d.write_png('temp01.png')  # write to a file

im = Image.open('temp01.png').convert('L')  # use 'convert' on image to get grayscale
data = np.asarray(im)  # make image into numpy data
axs[2].imshow(data, cmap=plt.cm.gray)
axs[2].set_title("3: 'convert' applied to jet image")

img = Image.open('temp01.png').convert('L')
z   = np.asarray(img)
mydata = z[::1,::1]  # I don't know what this is here for
axs[3].imshow(mydata,interpolation='nearest',cmap=plt.cm.jet)
axs[3].set_title("4: the code that Jake French suggests")

plt.show() 
```

但是，正如我上面建议的那样，正确地做到这一点并不难。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-24T22:09:36.113

OK，一些研究和简化代码，关键是convert('L')，即rgb转灰度，那么Ali_m的代码就可以了：

```
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import pylab as pl
from PIL import Image
import numpy as np
import pylab

img = Image.open('40.jpg').convert('L')
z   = np.asarray(img)
mydata = z[::1,::1]
fig = pl.figure(facecolor='w')
ax1 = fig.add_subplot(1,2,1)
im = ax1.imshow(mydata,interpolation='nearest',cmap=pl.cm.jet)
ax1.set_title('2D')

ax2 = fig.add_subplot(1,2,2,projection='3d')
x,y = np.mgrid[:mydata.shape[0],:mydata.shape[1]]
ax2.plot_surface(x,y,mydata,cmap=pl.cm.jet,rstride=1,cstride=1,linewidth=0.,antialiased=False)
ax2.set_title('3D')
ax2.set_zlim3d(0,100)
pl.show() 
```

![在这里输出](../Images/2c783e8fa2e7c73c67664ca88144d742.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-23T02:27:51.547

**编辑**：对不起，我误解了 OP 的原始问题。要从 PIL`Image`对象中获取 numpy 数组，您通常只需调用`np.array(im)`. 但是，我处理了大量显微镜数据，我发现对于某些图像格式（特别是 16 位 TIFF），这种语法并不总是有效，在这种情况下我会使用`np.asarray(im.getdata()).reshape(*im.shape[::-1])`.

这是一个修改后的例子：

```
import numpy as np
from matplotlib import pylab as pl
from mpl_toolkits.mplot3d import Axes3D
from PIL import Image

def getimarray(path):
    im = Image.open(path,'r')
    return np.array(im)

def doplots(path='tmp/cell.png'):

    mydata = getimarray(path)
    mydata = mydata[::5,::5]
    fig = pl.figure(facecolor='w')
    ax1 = fig.add_subplot(1,2,1)
    im = ax1.imshow(mydata,interpolation='nearest',cmap=pl.cm.jet)
    ax1.set_title('2D')
    ax2 = fig.add_subplot(1,2,2,projection='3d')
    x,y = np.mgrid[:mydata.shape[0],:mydata.shape[1]]
    ax2.plot_surface(x,y,mydata,cmap=pl.cm.jet,rstride=1,cstride=1,linewidth=0.,antialiased=False)
    ax2.set_title('3D')
    ax2.set_zlim3d(0,255)

    return fig,ax1,ax2

if __name__ == '__main__':
    doplots() 
```

# symfony - 条件 URL/路由 symfony2：干净的 URL

> ID：15581937
> 
> 赞同：1
> 
> 时间：2013-03-23T00:30:16.537
> 
> 标签：symfony

只要有机会我们可以在 Symfony 中做到这一点：

*   如果**没有****页面**属性：转到`/category/{category}`
*   如果有**页面****属性**：转到`/category/{category}/page/{page}`

`/page/{page}`只有当有页面属性时，我才需要添加。

* * *

*到目前为止，我只设法拥有这个：*

*   如果**没有****页面**属性：转到`/category/{category}`
*   如果有**页面****属性**：转到`/category/{category}/{page}`

具有以下内容：

```
<route id="category_view" pattern="/category/{categoryId}/page/{page}">
    <default key="_controller">AcmeHouseBundle:House:view</default>
    <default key="categoryId">null</default>
    <default key="page">1</default>
    <requirement key="categoryId">\d+</requirement>
    <requirement key="page">\d+</requirement>
</route> 
```

* * *

不同之处在于拥有`/category/{category}/page/{page}`而不是`/category/{category}/{page}`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:49:09.390

目前不支持此类事情（在合并[此 PR之前）。](https://github.com/symfony/symfony/pull/7051)所以你只能通过两条不同的路线来实现这一点：

```
<route id="category_view" pattern="/category/{categoryId}">
    <default key="_controller">AcmeHouseBundle:House:view</default>
    <default key="categoryId">null</default>
    <default key="page">1</default>
    <requirement key="categoryId">\d+</requirement>
</route>

<route id="category_view_page" pattern="/category/{categoryId}/page/{page}">
    <default key="_controller">AcmeHouseBundle:House:view</default>
    <default key="categoryId">null</default>
    <default key="page">1</default>
    <requirement key="categoryId">\d+</requirement>
    <requirement key="page">\d+</requirement>
</route> 
```

# c# - 使用正则表达式从字符串中提取坐标的更好方法

> ID：15581938
> 
> 赞同：2
> 
> 时间：2013-03-23T00:30:29.597
> 
> 标签：c#, regex

我想从字符串中提取坐标。

我拥有的字符串具有这种形式：

```
string Coord = @"
      at point  X=-277923.7300  Y=16462.7700  Z=   0.0000
      at point  X=-277816.6200  Y=16311.1500  Z=   0.0000
      at point  X=-277629.1900  Y=16109.7100  Z=   0.0000
      at point  X=-277573.4000  Y=16055.5600  Z=   0.0000
      at point  X=-277524.3100  Y=16023.0700  Z=   0.0000
      at point  X=-277508.6900  Y=15986.2400  Z=   0.0000
      at point  X=-277488.6100  Y=15866.0200  Z=   0.0000
      at point  X=-277466.3000  Y=15766.3800  Z=   0.0000
      at point  X=-277421.6700  Y=15710.0700  Z=   0.0000
      at point  X=-277281.0900  Y=15595.2700  Z=   0.0000
      at point  X=-277234.2300  Y=15547.6100  Z=   0.0000
      at point  X=-277185.1400  Y=15469.6400  Z=   0.0000
      at point  X=-277091.4900  Y=15354.1300  Z=   0.0000:; 
```

我想将所有 X 和 Y（不关心 Z）提取到坐标列表中。

这是坐标类：

```
public class Coordinates
{
    public double Longitude { get; set; }
    public double Latitude { get; set; }

    public Coordinates(double Long, double Lat)
    {
        this.Longitude = Long;
        this.Latitude = Lat;
    }
} 
```

我被推荐使用`Regex`而且由于我对它完全陌生，我有点挣扎，但设法准备好了一些东西。

**这是我到目前为止所做的：**

```
private List<Coordinates> ExtractCoordinates(string Coordinates)
    {

        List<Coordinates> lstOfCoordinates = new List<Coordinates>();

        //I managed to put this regex together after some trial and error
        //This regex will extract this pattern : " X=(any decimal) Y=(any decimal)"

        Regex reg = new Regex("(X=)-?\\d+\\.?\\d+\\s+(Y=)-?\\d+\\.?\\d+");

        //I get the matches and save them in a list
        MatchCollection collection = reg.Matches(Coord);
        List<string> lstOfMatches = (from Match match in collection
                                     select match.Value).ToList();

        //At this point I have alist of string having this form: "X=-277923.7300  Y=16462.7700" 

        //I had no idea how to proceed from here so I did it in a bad way
        //Basically I just Cut the string when I detect the first '=' 
        //and then take the rest until the Y. I remove the = and trim it 
        //and then parse it to double this is the X
        //Same logic for the Y coordinates
        foreach (string match in lstOfMatches)
        {
            double X = double.Parse(match.Substring(match.IndexOf('='), match.IndexOf('Y') - match.IndexOf('=')).Replace("=","").Trim());
            double Y = double.Parse(match.Substring(match.IndexOf("Y=")).Replace("Y=", "").Trim());
            lstOfCoordinates.Add(new Coordinates(X, Y));
        }
        return lstOfCoordinates;
    } 
```

好吧，基本上它可以工作，但我觉得这不是一个好方法。

所以我正在寻找一种更好的方法来做到这一点。也许只使用正则表达式或任何关于更清洁方式的建议来完成整个逻辑。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:56:27.563

```
var results = Regex.Matches(Coord, @"X=(?<X>-?\d+.?\d+)\s+Y=(?<Y>\d+.?\d+)");

for (int i = 0; i < results.Count; i++)
{
    Console.WriteLine(string.Format("X={0} Y={1}", results[i].Groups["X"], results[i].Groups["Y"]));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:43:28.670

使用组来捕获实际数字。此外，使用 @"" 符号来减少反斜杠。

```
Regex reg = new Regex(@"(X=)-?(\d+(\.\d+)?)\s+(Y=)-?(\d+(\.\d+)?)"); 
```

查看 Match.Groups

# c++ - 将目录更改为桌面

> ID：15581939
> 
> 赞同：0
> 
> 时间：2013-03-23T00:30:35.170
> 
> 标签：c++, windows, directory

无论 Windows 7 和 XP 上的 C++ 中的用户名，我都需要将我的程序目录更改为桌面。我目前正在使用`_chdir()`功能。我试过了`_chdir("Desktop")`，`_chdir("desktop")`但它返回-1。

有没有办法做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:33:33.167

读取`%HOMEPATH%`环境变量，切换到该目录，然后切换到桌面目录。

# php - 触发跟踪像素 onClick

> ID：15581941
> 
> 赞同：2
> 
> 时间：2013-03-23T00:30:53.407
> 
> 标签：php, javascript, html

我有这个跟踪像素，通常会放置在“安装成功”页面的正文中：

```
<img src="http://domain.com/adclick.php" width="1" height="1" border="0" /> 
```

但相反，我希望它在有人点击下载按钮时触发。这可能吗？我在想下载按钮可以调用一个会点击 adclick.php 页面的 javascript 函数 onClick？

谢谢詹姆斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:42:46.243

尝试以下操作：

```
<script>
  function fire() {
    var img = document.createElement("img");
    img.setAttribute("src", "http://domain.com/adclick.php");
    /* set other attributes here */
    document.body.appendChild(img);
  }
</script>
<button onClick="fire();">Click me</button> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:41:58.817

这不是一个 PHP 问题，但至少你在标记。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript"> 
function iteration() { 
$.get("http://domain.com/adclick.php");
return false;
}
</script>
<input type="button" value="Tracking Text" onclick="iteration();" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-15T14:41:02.490

只需创建一个图像

```
var trackingPxl = new Image(); 
```

并在您的下载功能中设置 src

```
trackingPxl.src = 'http://example.com/adclick.php'; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-15T14:27:30.997

如果您使用的是 jQuery，另一种可能的解决方案是：

```
<script type="text/javascript">
function downloadButtonClicked() {
    $('<img src="http://example.com/adclick.php" width="1" height="1" border="0" />').appendTo('body');
}
</script>
<a href="/download" onclick="downloadButtonClicked();">Download</a> 
```

# spring-security - 使用模式配置 Spring Security 过滤器链为 /j_spring_security_check 返回 404

> ID：15581942
> 
> 赞同：1
> 
> 时间：2013-03-23T00:31:12.357
> 
> 标签：spring-security

我正在使用 Spring MVC 和 Spring Security Release 3.1.3 和 tomcat 7.0.37

我需要配置 2 个安全过滤器链，一个用于 BasicAuthentication，一个用于 FormBasedAuthentication。

这是我的 spring-security.xml 文件：

```
<beans:beans ...>
...

<!-- ....................... -->
<!-- The Gui is secured here -->
<!-- ....................... -->
<http auto-config="true" use-expressions="true" pattern="/gui/**">
    <intercept-url pattern="/gui/login**" access="isAnonymous()"/>

    <form-login login-page="/gui/login" default-target-url="/gui/welcome"
                authentication-failure-url="/gui/loginfailed" />

    <logout logout-success-url="/gui/logout" />

    <intercept-url pattern="/welcome*" access="hasRole('een_admin')" /> 
    <intercept-url pattern="/mandantAdmin/**" access="isAuthenticated()"/>
    <intercept-url pattern="/standortAdmin/**" access="isAuthenticated()"/> 
    <intercept-url pattern="/ereignisse/**" access="isAuthenticated()" />
    <intercept-url pattern="/tickets/**" access="isAuthenticated()"/>  <!-- requires-channel="https" -->        
    <intercept-url pattern="/**" access="hasRole('een_admin')"/>
</http>

<!-- ................................. -->
<!-- The Service Methods are secured here -->
<!-- ................................. -->
<http use-expressions="true" >
    <http-basic />
    <logout logout-url="/resources/j_spring_security_logout"/>

    <intercept-url pattern="/service/ticketManagement/**" access="isAuthenticated()"/>
    <intercept-url pattern="/service/standortKonfig/**" access="isAuthenticated()"/>
    <intercept-url pattern="/service/ereignisStorage/**" access="isAuthenticated()"/>

</http>
<debug/>

<authentication-manager>
  <authentication-provider>
    <password-encoder hash="sha-256"/>
    <user-service>
        <user name="123" password="asdf" authorities="een_admin" />
    </user-service>
  </authentication-provider>
</authentication-manager>
</beans:beans> 
```

我的 web.xml 如下：

```
<servlet>
    <servlet-name>mvc-dispatcher</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>mvc-dispatcher</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/mvc-dispatcher-servlet.xml,
        /WEB-INF/spring-security.xml
    </param-value>
</context-param>

<!-- ........................................................................... -->
<!--                                Spring Security                              -->
<!-- ........................................................................... -->
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

当访问基于表单的受保护资源之一时，我成功委派给配置的自定义登录表单。但是在输入我的凭据后，我收到一个 404 错误，找不到“j_spring_security_check”（它正在使用这个 url: `"http://127.0.0.1:8080/webapp/j_spring_security_check"`）

以下是一些日志：

```
Request received for '/gui/login':

org.apache.catalina.connector.RequestFacade@174e4b3

servletPath:/gui/login
    pathInfo:null

    Security filter chain: [
      SecurityContextPersistenceFilter
      LogoutFilter
      UsernamePasswordAuthenticationFilter
      BasicAuthenticationFilter
      RequestCacheAwareFilter
      SecurityContextHolderAwareRequestFilter
      AnonymousAuthenticationFilter
      SessionManagementFilter
      ExceptionTranslationFilter
      FilterSecurityInterceptor
    ]
    Request received for '/j_spring_security_check':

    org.apache.catalina.connector.RequestFacade@174e4b3

    servletPath:/j_spring_security_check
    pathInfo:null

    Security filter chain: [
      SecurityContextPersistenceFilter
      LogoutFilter
      BasicAuthenticationFilter
      RequestCacheAwareFilter
      SecurityContextHolderAwareRequestFilter
      AnonymousAuthenticationFilter
      SessionManagementFilter
      ExceptionTranslationFilter
      FilterSecurityInterceptor
    ]

    01:06:06,345  WARN http-apr-8080-exec-3 servlet.PageNotFound:1080 - No mapping found for HTTP request with URI [/webapp/j_spring_security_check] in DispatcherServlet with name 'mvc-dispatcher'

    In access_logs:
    "POST /webapp/j_spring_security_check HTTP/1.1" 404 949 
```

请注意重定向时缺少的**UsernamePasswordAuthenticationFilter 。**

如果我删除第一个元素中的模式属性 pattern="/gui/**" 并注释掉第二个元素（需要，否则拦截器 URL 模式存在问题）它再次正常工作。

稍微简化一下：当向 http 元素添加模式属性时，j_spring_security_check 再也找不到了。

我做错了什么，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T16:15:30.677

您需要意识到您在`http`块中定义的 URL与属性*无关*，因此首先，您拥有的所有模式（例如）都将不起作用，因为它们只会为以永远不会匹配。应该是。`pattern``intercept-url``/welcome*``/gui``/gui/welcome`

您的登录表单提交到的 URL 也必须在`form-login`某处具有匹配元素。在您的情况下，它位于过滤器链中，因此永远不会匹配`/gui/**`请求。`/j_spring_security_check`

因此，您需要将登录表单中的 URL 更改为以`/gui`. 您还可以通过设置[`login-processing-url`](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#nsa-form-login). 例如：

```
<form-login login-processing-url="/gui/login.do" login-page="/gui/login" default-target-url="/gui/welcome" authentication-failure-url="/gui/loginfailed" /> 
```

（选择完全不提及 Spring 的东西是个好主意）。

您还应该删除该`auto-config`属性，因为它在这里没有做任何有用的事情，只会让人们感到困惑。

# ruby-on-rails - 启动后无法 ssh 到实例。在 Rails 中使用雾

> ID：15581946
> 
> 赞同：1
> 
> 时间：2013-03-23T00:31:19.273
> 
> 标签：ruby-on-rails, fog

在我使用 Fog 引导它之后，我无法立即连接到 EC2 实例。引导后，我等待实例准备好，然后再等待 5 秒。但是我仍然无法通过 ssh 连接。稍后连接可用，但在机器“准备好”后需要一点时间。

```
instance.wait_for { ready? }
instance.wait_for { !public_ip_address.nil?}
sleep(5) 
```

关于等待机器准备好接受 ssh 连接的方法有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T01:11:36.457

假设您使用的是 EC2，请确保服务器所在的安全组允许端口 22 上的 SSH。如果您不在 EC2 上，则可能是类似的防火墙问题。

编辑：这是我以前使用过的一些代码，从来没有遇到过任何问题，但那是与非 ec2 云提供商有关的。

```
def wait_for resource, msgOnStart, msgOnReady='Done'
  print msgOnStart
  resource.wait_for do
    print '.'
    if resource.ready?
      print "#{msgOnReady}\n"
      true
    end
  end
end

@server = compute.servers.create(#blahblahblah)
wait_for @server, 'Provisioning server' 
```

# c++ - 无法通过引用传递的参数来维护 const 的正确性

> ID：15581947
> 
> 赞同：0
> 
> 时间：2013-03-23T00:31:19.217
> 
> 标签：c++, reference, constants

我确定以前有人问过这个问题，但是所有搜索结果都有`const&`问题。

我想确保以下方法不会更改`GuestNode`传递给它的值，所以我想通过`const GuestNode& guest`，但 g++ 不会让这种情况发生，因为我正在分配`&guest`to 指针。为什么会这样？以及如何确保传递的参数保持原样？

```
 void GuestList::Add(GuestNode& guest)
   {
      if ( first == 0 )
      {
         //first guest
         first = &guest;
      }
      else
      {
         //nth guest
         GuestNode *p = first;
         while ( p->next != 0 )
            p = p->next;
         p->next = &guest;
      }
      SetCount(GetCount() + 1);
   } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T00:33:51.603

如果你做`guest`一个`const GuestNode&`，那么`&guest`就是一个`const GuestNode*`。也就是说，它是一个指向`const GuestNode`. 这是有道理的，否则您将能够`const`通过指向它的非`const`指针来修改该对象。因此，如果您要将该指针分配给`first`and/or `p`，则需要确保它们也是`const GuestNode*`s 。

如果您需要`first`, 我假设它是 , 的成员`GuestList`, 是 non- `const`，那么您不应该`const`参考。

展示：

```
const int x = 5;
int* p = &x; // error: invalid conversion from ‘const int*’ to ‘int*’ 
```

想象一下，如果这不是错误，那么即使对象应该是，我也`*p = 10;`可以更改 的值。`x``const`

# extjs - 可以在 Sencha Touch 中使用字段集来显示数据吗？

> ID：15581948
> 
> 赞同：0
> 
> 时间：2013-03-23T00:31:20.910
> 
> 标签：extjs, sencha-touch-2

这用于在地址簿应用程序中显示联系人详细信息。

我得到了一个 json 结果集，我想在一个字段集中很好地显示这些数据。

有没有办法轻松做到这一点？或者我必须从字段集中复制完整的 html 输出并将其放在 itemTpl 中，例如它出现在示例中（[http://dev.sencha.com/deploy/touch/examples/production/forms/index.html](http://dev.sencha.com/deploy/touch/examples/production/forms/index.html)）例如

```
<div class="x-inner x-form-inner x-translatable x-scroll-scroller" id="ext-element-6">
<div class="x-container x-form-fieldset" id="ext-fieldset-1">
    <div class="x-docking-vertical">
        <div id="ext-title-1" class="x-form-fieldset-title x-docked-top">
            <div class="x-innerhtml " id="ext-element-97">Personal Info</div>
        </div>
        <div class="x-body" id="ext-element-98">
            <div class="x-inner x-form-fieldset-inner" id="ext-element-8">
                <div class="x-container x-field-text x-field x-label-align-left x-field-required x-field-labeled x-field-clearable x-form-label-nowrap" id="ext-textfield-1">
                    <div class="x-form-label" id="ext-element-10" style="width: 40% !important; "><span id="ext-element-11">Name</span>
                    </div>
                    <div class="x-component-outer" id="ext-element-9">
                        <div id="ext-input-1" class="x-field-input">
                            <input id="ext-element-12" class="x-input-el x-form-field x-input-text" type="text" name="name" autocapitalize="off" value="{Name}">
                            <div class="x-clear-icon" id="ext-element-14"></div>
                            <div class="x-field-mask" id="ext-element-13" style="display: none !important; "></div>
                        </div>
                    </div>
                </div> 
```

ETC...

有没有更简单的方法？谢谢

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-23T12:30:19.880

为什么不使用字段集但将字段设置为只读？

# c# - 在编辑器中显示不存在的错误，但仍然可以正常编译

> ID：15581949
> 
> 赞同：0
> 
> 时间：2013-03-23T00:31:52.377
> 
> 标签：c#, visual-studio-2012, compiler-errors

这是我看到的错误：

![截屏](../Images/e9d76fd956df3005dbf66f095a0b987c.png)

好吧，`LiveConcat`返回一个`LiveConcatClass<T>`类：

```
public static LiveConcatClass<T> LiveConcat<T>(this IBindingList<T> first, IBindingList<T> second)
{
    return new LiveConcatClass<T>(first, second);
} 
```

它继承了我的`ReadOnlyBindingList<T>`抽象类：

```
public class LiveConcatClass<T> : ReadOnlyBindingList<T>
{
    //...
} 
```

这又实现了我的`IBindingList<T>`接口（列表中的最后一个）：

```
public abstract class ReadOnlyBindingList<TResult> : IBindingList, IList, IEnumerable, IEnumerable<TResult>, ICollection, ICollection<TResult>, IBindingList<TResult>
{
    //...
} 
```

And`LiveSelect`是一个扩展方法，它需要一个`IBindingList<T>`：

```
public static LiveSelectClass<TSource, TResult> LiveSelect<TSource, TResult>(this IBindingList<TSource> source, Expression<Func<TSource, TResult>> selector)
{
    return new LiveSelectClass<TSource, TResult>(source, selector);
} 
```

所以我不明白为什么我会得到那个错误。问题是，它编译并运行良好，但无法摆脱错误。我什至尝试重新启动我的机器。我的 VS 安装会损坏吗？我正在使用 VS 2012 Ultimate。

# asp.net-mvc - AutoMapper 中是否有办法指定所有被映射的字符串都将被修剪

> ID：15581951
> 
> 赞同：0
> 
> 时间：2013-03-23T00:31:55.017
> 
> 标签：asp.net-mvc, razor, mvvm, automapper

我正在将 WinForms 应用程序转换为 ASP.NET MVC4，并尝试使用 AutoMapper 实现 ViewModel 方法，以在域实体和 ViewModel 之间进行映射，主要是将更复杂的对象图展平为 ViewModel，以便在视图中轻松绑定。

我遇到的问题是，当将域模型想要应用的某些字段留空时，会抛出`Trim()`a 。`NullReferenceException`

最初这一切都是在域对象中处理的，例如在 Customer 对象中，我有一个字符串属性，可以修剪以确保修剪传入的任何值，这样就不必在任何可以设置值的地方用 Trim 弄乱原始 WinForms ，只需将其传递给域模型并让它设置执行 Trim 或 ToUpper 作为值被持久化。

```
public virtual String Name
{
    get { return _name; }
    set { _name = StringFormatting.ToTitleCase(value.Trim()); }
}

public virtual String Email
{
    get { return _email; }
    set { _email = value.Trim(); }
} 
```

就我的 ViewModel 而言，我刚刚获得了自动实现的属性：

```
public class CustomerCreateViewModel
{
    [Required(ErrorMessage="Please enter a name for this customer")]
    public string Name { get; set; }

    [DataType(DataType.EmailAddress)]
    public string Email { get; set; }
} 
```

但是，如果在提交表单时电子邮件文本框为空，`NullReferenceException`则将抛出

> 设置 { _email = value.Trim() ; }

为了解决这个问题，我添加了一个 setter 保护子句

```
public virtual String Email
{
    get { return _email; }
    set
    {
        if (_email == value) return;
        _email = value.Trim();
    }
} 
```

并且该*字段*的错误消失了，但它移动到了下一个属性，Mobile - 我重复了修复，然后到下一个，下一个和下一个。这些都不是必需的，因此将它们传入空是正确的。

AutoMapper 中是否有办法指定要修剪所有被映射的字符串？我是不是错误地接近了这个？不需要修剪字符串吗？或者应该在哪里进行修剪，我的偏好是只需要在提交字符串时修剪它们，而不是在任何单个控制器的代码中，感觉应该在 ViewModel / Domain 模型的某个地方完成，但是在哪里？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2016-03-21T12:33:34.700

作为替代和更简单的解决方案

```
Mapper.CreateMap<string, string>().ConvertUsing(
   str => !string.IsNullOrEmpty(str) ? str.Trim() : null
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T00:58:07.233

你可以`ITypeConverter<M,V>`这样使用...

```
public class ModelToViewModelConverter : ITypeConverter<Model, ViewModel>
{
        public UIItemViewModel Convert(ResolutionContext context)
        {
            Model model = (Model)context.SourceValue;
            // Perform your logic 
        }
} 
```

# ruby-on-rails - 嵌套表单 - 无法批量分配受保护的属性

> ID：15581956
> 
> 赞同：4
> 
> 时间：2013-03-23T00:32:29.733
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-forms, nested-attributes

我对此有点困惑，因为我觉得我已经避开了常见的错误（比如错误[输入 attr_accessible](https://stackoverflow.com/questions/12380761/cant-mass-assign-protected-attributes-with-nested-protected-models)或[完全忽略它](https://stackoverflow.com/questions/5037239/nested-form-triggering-a-cant-mass-assign-protected-attributes-warning)），但我仍然得到一个

```
Can't mass-assign protected attributes: home, work 
```

错误在这里。我猜我错过了一些东西，但我不确定是什么。

无论如何，在我的新应用程序中，用户有一个家庭和一个工作（每个都属于一个用户），我希望用户在注册时输入它们。所以，在我的模型中：

**用户.rb**

```
attr_accessible :email, :first_name, :last_name, :password, :password_confirmation, :home_attributes, :work_attributes

  has_one :home, :work

  accepts_nested_attributes_for :work, :home

  has_secure_password 
```

**主页.rb**

```
attr_accessible :address, :latitude, :longitude, :user_id
belongs_to :user

validates :address, presence: true 
```

**工作.rb**

```
attr_accessible :address, :latitude, :longitude, :user_id
belongs_to :user

validates :address, presence: true 
```

在我的控制器中

**users_controller.rb**

```
def new
    @user = User.new

  respond_to do |format|
    format.html # new.html.erb
    format.json { redirect_to @user }
  end
end 
```

并以我的形式：

**意见/用户/_form.html.haml**

```
= form_for @user do |f|
  - if @user.errors.any?
    .error_explanation
      %h2
        = pluralize(@user.errors.count, "error") 
        prohibited this post from being saved:
      %ul
        - @user.errors.full_messages.each do |msg|
          %li= msg

  = f.label :first_name
  = f.text_field :first_name

  = f.label :last_name
  = f.text_field :last_name

  = f.label :email
  = f.text_field :email

  = f.label :password
  = f.password_field :password

  = f.label :password_confirmation, "Re-Enter Password"
  = f.password_field :password_confirmation

  = f.fields_for :home do |builder|
    = builder.label :address, "Home address"
    = builder.text_field :address
  %br
  = f.fields_for :work do |builder|
    = builder.label :address, "Work address"
    = builder.text_field :address

  .btn-group
    = f.submit 'Sign Up!', class: "btn" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-23T01:45:16.493

看起来您还没有设置实例变量来包含这些属性。

在你的控制器中，你应该有这样的东西

```
def new
    @user = User.new
    @user.homes.build
    @user.works.build

  respond_to do |format|
    format.html # new.html.erb
    format.json { redirect_to @user }
  end
end 
```

如果您不构建这些属性，表单将不知道该怎么做。

**编辑**：修复了构建嵌套资源的语法

# c++ - 在框架上获得所有不同颜色的最快方法？

> ID：15581961
> 
> 赞同：0
> 
> 时间：2013-03-23T00:33:02.523
> 
> 标签：c++, opengl

我们渲染一个没有阴影/灯光/透明度/等的世界——纯色顶点。我们有一个 360*360 度全景鱼眼相机。我们的分辨率约为 200*200 RGB 像素。我们希望在给定的帧上获得所有独特的颜色。在OpenGL中最快的方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:40:25.157

看看[`GL_EXT_histogram`](http://www.opengl.org/registry/specs/EXT/histogram.txt)，它可能是你正在寻找的：

> 此扩展定义了对特定颜色分量值（直方图）的出现进行计数并跟踪最小和最大颜色分量值（minmax）的像素操作。可选模式允许在直方图和/或 minmax 操作完成后丢弃像素数据。否则，像素数据不受影响地继续进行下一个操作。

# backbone.js - 使用backbone.js中的状态机处理url和路由

> ID：15581962
> 
> 赞同：2
> 
> 时间：2013-03-23T00:33:29.697
> 
> 标签：backbone.js

很想知道以下场景是否存在任何模式。看起来需要某种类型的状态机：

*   两个系列（比方说汽车和鸟类，只是编造这个）
*   您可以深入了解任一集合并查看详细视图
*   每个集合都有一个与之关联的视图，每个集合还有一个详细视图
*   想要防止在 router.on 方法中重复代码并保持干燥（也许只有一种方法可以查看汽车的状态并做一些事情，对鸟类也是如此？）

**状态**：汽车-鸟类
**网址**：#

**状态**：汽车详细信息 - 鸟类
*网址*：#/cars/1

**状态**：汽车详细信息 - 鸟类详细信息
**url**：#/cars/1/birds/1

**状态**：汽车 - 鸟类详细信息
**url**：#birds/1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-19T15:58:16.937

[这里](http://marksoper.me/Backbone-Routing-Lessons-Learned-Subrouters-and-State-Machines.html)有一个很好的关于这个主题的迷你教程。也是来自 Backbone 网站的[状态机混合](https://github.com/sebpiq/backbone.statemachine)，但似乎并不特别针对路由器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T20:41:38.507

```
var Router = Backbone.Router.extend({
routes: {
    '*variables': 'drawViews'
},

parse: function(variables) {
    values = variables.split("/");
    return values;
},

drawViews: function(variables) {
    values = this.parse(variables);
//and here you check the first value and see it its car or bird then you get      
//next value of the array wich will be the index and so on. 
} 
```

});

# c# - 如何获取 Windows 服务登录用户的安全令牌？

> ID：15581963
> 
> 赞同：3
> 
> 时间：2013-03-23T00:33:32.487
> 
> 标签：c#, windows, windows-services, token, impersonation

我需要模拟特定 Windows 服务的 LogOn 用户帐户。

我已经能够使用 WMI 获取用户名（遗憾的是，LogOn 用户身份似乎没有使用任何与 Windows 服务相关的常规 .NET 类公开）。但是，只有用户名（可以是本地帐户或域帐户）我如何获取该 Windows 身份的令牌？

可以提供令牌的 LogonUser WinAPI 调用需要密码作为参数，这显然是不可用的。用户输入不是一种选择。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T23:16:31.267

最终做了以下事情：

1.  检查服务是否正在运行。如果没有启动服务。
2.  使用 WMI 从服务名称获取 PID。
3.  使用 .NET Process 类从 PID 获取进程句柄。
4.  使用 OpenProcessHandle 获取进程令牌
5.  使用 DuplicateToken 复制令牌，以验证足够的权限。
6.  使用在步骤 4 中获得的令牌创建新的 WindowsIdentity。
7.  模拟这个新的 WindowsIdentity，在模拟下进行操作，然后撤消模拟，使用 WindowsImpersonationContext。

希望这对需要模拟运行服务的用户帐户的其他人有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-26T00:32:15.857

尽管 Microsoft 完全没有记录这一点，因为他们想假装服务登录在登录时不需要明文密码，但实际上确实需要，并且 services.exe 使用正确的密码调用 LogonUser。

密码被塞到注册表深处的某个地方，只有 SYSTEM 可以访问并加密以启动，但 SYSTEM 帐户可以获得机器密钥并解密密码。

[http://www.computersecurityarticles.info/security/decrypting-lsa-secrets/](http://www.computersecurityarticles.info/security/decrypting-lsa-secrets/)

请注意，因为这是无证的，你不应该使用它。

# c# - 从现有数据集中为本地报告添加新数据源？

> ID：15581968
> 
> 赞同：0
> 
> 时间：2013-03-23T00:33:54.130
> 
> 标签：c#, winforms

使用向导向项目添加新数据源时，有 4 个选项，一个用于**Database**，一个用于**Service**，一个用于**Object**，最后一个用于**Sharepoint**。我专注于**Database**和**Object**，这两个选项在获取数据的方式上几乎相同，它们都使用 SQL 查询来获取数据，这里的区别是**Database**将从存储在服务器上的过程或函数中获取数据，而**目的**将从远程执行某些 SQL 查询的方法中获取数据。使用其中两个选项将使我重新创建/重新执行我的 SQL 语句来获取数据，这是非常不必要的，因为我已经有一个填充了数据的数据集（用于在 DataGridView 中显示），那么为什么我必须这样做重新执行我在填充数据集时执行的确切 SQL 语句？

为了帮助您更轻松地描绘上下文，我将在此处发布一些代码：

```
DataSet ds = new DataSet();
SqlDataAdapter da = new SqlDataAdapter("My SQL SELECT query", mySqlConnection);
da.Fill(ds,"myTable"); 
```

现在我想将 ds 添加为我的本地报告的新数据源，使用向导似乎无法提供帮助，我想要的新数据源可以通过上面的确切“My SQL SELECT 查询”创建，这意味着 ds 已经我想要什么，但是我不知道如何使它可用于我的本地报告的数据源。

我希望你能理解我的问题，我不想做已经做过的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T00:44:44.927

如果我理解正确...如果您将内存中的数据集作为数据集，则可以使用 Object 方法从数据集中返回数据源，而不使用 SQL。您可以在数据集中使用 LINQ 或数据表的 Select() 方法来过滤数据。

[http://msdn.microsoft.com/en-us/library/det4aw50.aspx](http://msdn.microsoft.com/en-us/library/det4aw50.aspx)

[http://msdn.microsoft.com/en-us/library/bb552415.aspx](http://msdn.microsoft.com/en-us/library/bb552415.aspx)

希望能帮助到你。

# javascript - 如何检查单击的div（左侧或右侧）的至少一侧是否没有其他div

> ID：15581972
> 
> 赞同：0
> 
> 时间：2013-03-23T00:34:21.133
> 
> 标签：javascript, jquery, onclick, offset, typeof

我有一些 100x100px 的 div：

![在此处输入图像描述](../Images/5294cc7f43adca310243c5c6713a51bd.png)

3个块的HTML代码：

```
<div id="plane">
   <div class="tile tile3" block-id="1" style-id="3" style="left:50px; top:50px"></div>
   <div class="tile tile1" block-id="2" style-id="1" style="left:150px; top:50px"></div>
   <div class="tile tile3" block-id="3" style-id="3" style="left:250px; top:50px"></div>
</div> 
```

当我单击一个 div 时，我添加了一个名为的类`ss`，它使单击的 div/block 变为黄色。我有这个使用以下代码：

```
 el.innerHTML = html.join('');
       $(el).find('.tile').click(function () {
       var clickedBlock = $(this); 
       clickedBlock.addClass('ss'); 
 }); 
```

问题是我只想将`ss`类添加到我单击的块（div）中并且至少有一侧（左侧或右侧）空闲。这样就不会附加其他块。在屏幕截图的情况下，绿色块的一侧清晰，因此`ss`单击时应该能够获得 te 类。红色的没有免费的一面，所以点击它时不应该添加任何课程。

我在互联网上搜索了一个解决方案并阅读了一些关于`offset`并且`typeof`认为我可以使用它的东西。简而言之：单击一个块，获取它`style left`并`top`检查周围是否有任何 div 相同`style left -100`（左侧）和`+100`右侧 where `top = 0`。如果有，返回真。如果一侧为真或双方返回假（在这种情况下，左右两边都没有块），则该块是“空闲”的，`ss`需要在单击的块上添加类。

我试过这段代码（没有成功）：

```
el.innerHTML = html.join('');
    $(el).find('.tile').click(function () {
        var clickedBlock = $(this); 
        var offset = $(this).offset(); //get the top and left px

        if (typeof clickedBlock[offset.left-100][offset.top=clickedBlock.attr('top')] == 'true') { //check the left side
            if (typeof clickedBlock[offset.left+100][offset.top=clickedBlock.attr('top')] == 'false') { //check the right side
                clickedBlock.addClass('ss'); 
            }
        } else { //if left side is already false, it really doesn't matter if the right side is clear or not since 1 side needs to be clear
                clickedBlock.addClass('ss'); 
        }
}); 
```

我的问题：如何使这项工作？这是做到这一点的最佳方法，还是有更好的方法？如果是这样，哪些？

此外，以下选项也是可能的：

![在此处输入图像描述](../Images/86166adea29481273fec43cb3aebb116.png)

这个的 HTML 代码是：

```
<div id="plane">
  <div class="tile tile3" block-id="1" style-id="3" style="left:50px; top:50px"></div>
  <div class="tile tile1" block-id="2" style-id="1" style="left:150px; top:100px"></div>
  <div class="tile tile2" block-id="3" style-id="2" style="left:50px; top:150px"></div>
  <div class="tile tile3" block-id="4" style-id="3" style="left:250px; top:150px"></div>
</div> 
```

这里的绿色和蓝色块是“免费的”。因此，在这种情况下，我们需要调整代码以检查 div 与`left-100`and `top-50`, `left-100`and `top+50`, `left+100`and `top-50`, `left+100`and `top+50`。所以总共有 6 次检查（左边 3 次，右边 3 次）

所以总而言之：如果（点击时）一侧是免费的（或两者都是）添加`ss`类。我希望我的问题很清楚，有人可以提供帮助。

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T01:11:11.873

没有冒犯，但我认为你的方法离工作还有光年。您正在将表示单个元素的 jQuery 对象视为一个多维数组，以某种方式神奇地由各种偏移量索引，然后应用 typeof 以希望产生一个布尔值？这里已经很晚了，如果我读错了，请道歉......

[编辑：我在http://jsfiddle.net/AcmLR/1/](http://jsfiddle.net/AcmLR/1/)创建了一个小提琴，在那里我修复了一些错误并且似乎运行良好。下面的代码也更新了。

也许尝试这样的事情：

```
var tiles = $('.tile');
tiles.click(function(){
  var me = $(this); //To save a few lookups
  /*Read out the top and left attributes, remove 'px' to 
  get the numeric part and force them to be numbers using the + (not really needed)*/
  var myLeft = +me.css('left').replace('px', '');
  var myTop = +me.css('top').replace('px', '');
  var leftFree = true, rightFree = true; //Assume both sides are free to begin with
  tiles.not(me).each(function(){
    if(!leftFree && !rightFree){
      return; //No need processing any more boxes
    }
    var me = $(this); //To save a few lookups
    var left = +me.css('left').replace('px', '');
    var top = +me.css('top').replace('px', '');
    if(top < myTop-100 || top > myTop+100){
      return; //This box is completely above or below the clicked box
    }
    if(left == myLeft-100){
      leftFree = false;
      return;
    }
    if(left == myLeft+100){
      rightFree = false;
      return;
    }
  });
  if(leftFree || rightFree){
    me.addClass('ss'); //In this scope me still refers to the clicked box
  }
}); 
```

根据您的确切要求，盒子是否可以移动等，可能会有更高效或更紧凑的解决方案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-23T02:42:51.433

在您的示例中，您似乎可以说：

```
$('.tile').on({
    click : function () {
        if($(this).css('left') != '150px') {
            $(this).addClass('ss');
        }
    }
}); 
```

因为只有中间的 div 才会有那个特定的声明，所以你总是知道点击的是外部 div。

如果您的代码通常如此具体，则此方法有效。如果它更具动态性和流动性（例如一组 div 向左浮动），您可以执行类似于您在上面发布的内容的操作：

```
$('.tile').on({
    click : function () {
        var prevEleOffSet = $(this).prev('.tile').offset().left,
            nextEleOffSet = $(this).next('.tile').offset().left,
            thisEleOffSet = $(this).offset().left;

        if(prevEleOffSet > thisEleOffSet || nextEleOffSet < thisEleOffSet) {
            $(this).addClass('ss');
        }
    }
}); 
```

首先，我们检查我们点击的 $('.tile') 的 prev('.tile') 是否在屏幕的左侧。如果是，我们可以假设它在上面的行中。如果结果是 prev('.tile') 在同一行，我们检查下一个('.tile')。如果它没有我们点击的 $('.tile') 左边那么远，我们可以假设它在下一行，而不是在我们点击的 div 旁边。

如果这些陈述中的任何一个是真的，我们就会给你的班级打耳光，把它变成黄色，然后继续我们的业务。

我希望这会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-23T01:02:34.030

我会尝试一些东西，但这可能不适用于所有情况

第一 - 我将遍历该框内的所有 div 并收集“左” css 值（Jquery 偏移量或 css）并将它们存储到一个数组中。但我不会全部收集，我只是取一个独特的价值。所以 5 div 左边是 (50,50,150,200,200)。我只会收集（50,150,200）。（这可以很容易地用一个while循环来完成）。

第二 - 检查数组长度是否> 2。如果 <=2 则每个框都会变黄。

3rd - 如果 > 2，则只有第一个和最后一个值是可以变黄的框的值

同样，理想情况下，这将在您有单行时起作用，如果您有超过 1 行，则必须检查它们彼此的对齐方式...

那是我最好的镜头@_o

# c - c文件我得到的只是一个无限循环

> ID：15581977
> 
> 赞同：1
> 
> 时间：2013-03-23T00:34:59.457
> 
> 标签：c, file, file-io, io

任何人都可以帮助我完成以下 c 程序吗？这只是我在 c 中的第二个程序，所以我不知道我在做什么。

我正在尝试在 c 中创建一个程序来读取文件“input.txt”并根据学生的正确答案百分比以星号给出学生的数学分数

我想出的只是一个无限循环

+：*

-：*

*** :*

/：*

input.txt 将类似于下面

* * *

1*名学生*

卡拉*学生姓名*

8 10*加分由 8/10 决定*

50 80*减法分数由 50/80 决定*

30 60*乘法分数由 30/60 决定*

2 5*分区分数由 2/5 决定*

* * *

具有所需的输出

卡拉

+: * * * * * * * *

-: * * * * * *

*: * * * * *

/: * * * *

* * *

我的代码

```
int num; 
char name; 
int sum;
int cur;
int i;
int avg; 

//call file
FILE*ifp=fopen("input.txt","r");
fscanf(ifp,"%d",&num);
for (i=0;i=num;i++){
        fscanf(ifp,"%c",&name);
        printf("%c",&name);
        for(sum=0;sum<=4;sum++){
            fscanf(ifp,"%d",&cur);
            scanf(cur,"%d %d")
            avg=%d/%d;
            if (sum==1)
                printf("+:");
            else if (sum==2)
                printf("-:");
            else if (sum==3)
                printf("*:");
            else if (sum==4)
                printf("/:");
            if (avg==1)
                printf("**********\n");
            else if (avg>=.9)
                printf("*********\n");
            else if (avg>=.8)
                printf("********\n");
            else if (avg>=.7)
                printf("*******\n");
            else if (avg>=.6)
                printf("******\n");
            else if (avg>=.5)
                printf("*****\n");
            else if (avg>=.4)
                printf("****\n");
            else if (avg>=.3)
                printf("***\n");
            else if (avg>=.2)
                printf("**\n");
            else if (avg>=.1)
                printf("*\n");
            else
                printf("\n");
        }
}
//close file
fclose(ifp);
return 0; 
```

如果有人可以帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T00:38:33.087

您的无限循环是因为您的外循环有条件：更改`for (i=0;i=num;i++)`为`for (i=0;i<num;i++)`

实际上，您每次只是将 i 分配给 num ，因此是无限循环。

编辑：我还应该指出您的行中有语法错误

```
scanf(cur,"%d %d")
avg=%d/%d; 
```

并且您的`avg`变量被声明为 int，因此您将执行整数除法，这可能不会像您预期的那样运行；也就是说，您只会得到整数，因此您随后的条件将在很大程度上毫无意义。你应该把它变成一个浮点数或双精度数，并将你的一个操作数转换为浮点数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T00:46:20.123

考虑以下 For 循环：

```
for(i = 0, i < 10; i++)
{
   DoSomething();
} 
```

执行的顺序是：

*   运行 i = 0;
*   运行 i < 10; 如果结果为“真”，请继续。如果结果为“假”，则退出循环。因为 i 第一次是 0，而 0 小于 10，所以结果为真。继续前进
*   运行 DoSomething();
*   运行我++
*   返回“运行 i < 10；如果结果为“真”...

在您的情况下，您实际上是在将 num 分配给 i，而不是检查 i 是否等于 num。因为 C 将 0 视为“假”，而将其他任何内容视为“真”，并且因为 i = 10 的“结果”是 10（参见边栏 1），计算机将 i = 10 评估为“真”，所以循环继续进行

在 C 语言中这是一个很容易犯的错误，因为编译器不会警告你。像 Lint 这样的静态分析工具可以，但那是另一回事了。

**在结论**中，您可能希望 "i = num" 成为 "i < num" 或 "i <= num" 或其他一些条件语句。

**Sidebar1**此属性允许您像 a = b = c = 10 一样链接分配。c = 10 的结果是 10，因此被分配给 b。b = 10 的结果是 10，因此被分配给 a。

# node.js - NodeJS：如何调试“检测到 EventEmitter 内存泄漏。添加了 11 个侦听器”

> ID：15581978
> 
> 赞同：56
> 
> 时间：2013-03-23T00:35:14.377
> 
> 标签：node.js, memory-leaks, eventemitter

如何调试引发此错误的应用程序：

```
(node) warning: possible EventEmitter memory leak detected. 11 listeners added. Use emitter.setMaxListeners() to increase limit.
Trace
    at Socket.EventEmitter.addListener (events.js:160:15)
    at Socket.Readable.on (_stream_readable.js:653:33)
    at Socket.EventEmitter.once (events.js:179:8)
    at TCP.onread (net.js:527:26) 
```

我找不到假设的泄漏对象来增加监听器限制 `.setMaxListeners(0);`

**解决方案（来自 fardjad 和 jan salawa）**

通过 jan salawa 的搜索，我找到了一个工作库 ( [longjohn](https://github.com/mattinsler/longjohn) )，用于增加堆栈跟踪的详细程度。根据 fardjad 的回复，我发现我们必须对`EventEmitter.addListener` **AND** `EventEmitter.on`进行原型设计。

使用该解决方案，我可以获得这个新的跟踪：

```
(node) warning: possible EventEmitter memory leak detected. 11 listeners added. Use emitter.setMaxListeners() to increase limit.
Trace
    at EventEmitter.addListener.EventEmitter.on (xxx/main.js:44:15)
    at Readable.on (_stream_readable.js:653:33)
    at ServerResponse.assignSocket (http.js:1072:10)
    at parser.onIncoming (http.js:1979:11)
    at parserOnHeadersComplete (http.js:119:23)
    at socket.ondata (http.js:1912:22)
    at TCP.onread (net.js:510:27) 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-25T18:28:30.257

原来这是nodejs核心的一个bug，我们在这里讨论这个问题：[https ://github.com/joyent/node/issues/5108](https://github.com/joyent/node/issues/5108)

**`EventEmitter memory leak detected`抛出并填满可用内存/可用 CPU 时间的错误 http 服务器的解决方案：**

恢复到旧版本`v0.8.23`。（您可以从这里下载并安装/编译它：http: [//blog.nodejs.org/2013/04/08/node-v0-8-23-legacy/](http://blog.nodejs.org/2013/04/08/node-v0-8-23-legacy/)）

**2018 年更新：**我看到了一些关于这个主题的反馈，而这个问题似乎已经消失了多年。请注意，此响应**仅适用于使用 nodejs 构建泄漏的 http 服务器**。如果您处于其他情况，请查看此线程上的其他回复并且不要降级您的版本（如此回复所建议的那样），您将浪费您的时间。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-25T14:49:32.860

对我来说，您的事件循环似乎被阻止了。如果您在 node.js 事件循环中执行 cpu 密集型任务，则可能会发生这种情况。您可以使用[子进程](http://nodejs.org/api/child_process.html)来执行密集任务。

您可以使用[以下方法](http://grokbase.com/t/gg/nodejs/1232z2xchk/how-to-detect-and-diagnose-event-loop-blocking)检查阻塞 node.js 的内容：

1.  [测量](https://github.com/CrabDude/trycatch/blob/master/lib/hook.js)每个调用的计算时间。如果时间很长，请记录下来，以便您知道应用程序行为不端。
2.  设置日志计划，以便您知道什么时候出现阻塞循环

    ```
    function timeTick() {
        var startTime = (new Date().getTime());
        function onTick() {
            var interval = (new Date().getTime()) - startTime;
            if(interval > 5)
                console.log('timeTick(): WARNING: interval = ' + interval);
        }
       process.nextTick(onTick);
    }
    setInterval(timeTick, 1000);
    ```

3.  使用[个人资料。](https://github.com/mape/node-profile)
4.  使用[它](https://github.com/flatiron/winston)来记录和分析。它是**[Nodejitsu](http://readwrite.com/2011/06/03/nodejitsu-open-source-nodejs)**中使用的库。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2014-03-22T01:30:56.000

这正是发生在我身上的事情。对我来说，我不小心将一个事件侦听器嵌套在另一个事件侦听器中。

例如，查看您的代码并确保在另一个事件侦听器块中没有事件侦听器块（除非您是故意这样做的）：

```
socket.on('data', function(data) {
//code goes here

socket.on('close' , function() {
//code goes here
     });

   }); 
```

在上面的错误示例中，socket.on ('close') 侦听器应该在 socket.on('data') 块之外。

就我而言，当我收到 5 个数据流时，socket.on('close') 侦听器正在等待关闭事件发生。当我关闭一次时，将执行另一个第四次关闭事件。这显然不是我想要的。这是由于 Node.js 的非阻塞性质。由于回调函数，它会“记住”事件。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2018-03-31T18:15:13.180

从节点 6 开始，您应该使用`node --trace-warnings`：[https ://nodejs.org/api/cli.html#cli_trace_warnings](https://nodejs.org/api/cli.html#cli_trace_warnings)

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2015-10-21T08:49:58.357

如果您注册同一对象的特定事件超过 11 次，则会引发此警告。

检查您是否在您经常调用的函数中对特定事件进行“on”调用，这会导致多次注册事件。

[这个](https://medium.com/@jongleberry/understanding-node-jss-possible-eventemitter-leak-error-message-bc2ee68b24ea)链接帮助我理解了这一点。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-03-23T12:47:11.703

> 我试图对 EventEmitter 进行原型设计以将日志消息添加到 addListener 但我无法让它工作

要挂钩`addListener`，您可以执行以下操作：

```
// on the first line of your main script
var events = require("events"),
    EventEmitter = events.EventEmitter;

var originalAddListener = EventEmitter.prototype.addListener;
EventEmitter.prototype.addListener = function (type, listener) {
    if (this.listenerCount(this, type) >= 10) {
        // TODO: PLACE YOUR CODE FOR DEBUGGING HERE
    }
    originalAddListener.apply(this, arguments);
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-07-22T14:46:47.967

我在运行单元测试时看到了这一点。我的单元测试反复调用正在调用的代码：

```
process.on("uncaughtException", () => { ... }); 
```

我不得不使用依赖注入来注入一个伪造的进程对象，从而解决了这个问题。

主.js：

```
export function main(myProcess) {
    myProcess.on("uncaughtException", () => { ... });
}

if (require.main === module) { // to prevent this from executing when running unit tests
    main(process);
} 
```

我的单元测试会做：

```
const fakeProcess = jasmine.createSpy("process", ["on"]);
main(fakeProcess); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2016-04-05T17:48:58.303

**我在使用mocha**和**酵素测试****React**组件时遇到了同样的问题。

 *****在完成测试后，我能够通过显式卸载组件来解决我的问题。*

问题是我在测试中多次安装组件，然后添加了更多的侦听器，直到侦听器的数量达到 11，我收到了警告。

**我通过添加render.unmount()**行更改了我的测试代码。这解决了我的问题。

```
describe('<CircleArc />', () => {

    it('renders', function () {
        const rendered = mount(<CircleArc />);
        assert.ok(rendered.find('path'));
        rendered.unmount();
    });
} 
```****

# matlab - 使用欧拉角旋转 wobj 顶点

> ID：15581983
> 
> 赞同：1
> 
> 时间：2013-03-23T00:35:43.177
> 
> 标签：matlab, rotation, wavefront

**专家您好！**

我有一个欧拉旋转矩阵：

```
a11 = cos(psi)*cos(phi) - cos(theta)*sin(phi)*sin(psi);
a12 = cos(psi)*sin(phi) + cos(theta)*cos(phi)*sin(psi);
a13 = sin(psi)*sin(theta);
a21 = -sin(psi)*cos(phi) - cos(theta)*sin(phi)*cos(psi);
a22 = -sin(psi)*sin(phi) + cos(theta)*cos(phi)*cos(psi);
a23 = cos(psi)*sin(theta);
a31 = sin(theta)*sin(phi);
a32 = -sin(theta)*cos(phi);
a33 = cos(theta);

rotationMatrix = [a11 a12 a13; a21 a22 a23; a31 a32 a33] 
```

我确定旋转矩阵是正确的。当我尝试对 wobj 文件（在本例中为框）应用旋转时，会出现问题。

我想旋转一个看起来像这样的盒子：

```
vertices =

 0     0     0
 0     2     0
 0     2     2
 0     0     2
 2     0     2
 2     0     0
 2     2     0
 2     2     2 
```

如果我做：

```
rot= rotationMatrix*vertices' 
```

然后在旋转后再次将顶点转回来

```
FV.vertices = rot' 
```

我得到一个错误的旋转。谁能帮帮我？

问题说明： ![盒子没有像红色系统那样旋转（X,Y,Z）](../Images/a5520c28941b901f206918914abbad78.png)

# php - 使用 Php 和 Ajax 对 JSON 结果进行分页

> ID：15581988
> 
> 赞同：0
> 
> 时间：2013-03-23T00:36:01.033
> 
> 标签：php, javascript, ajax, json

我成功解析了一些`json`来自 的内容`youtube api`，但每个请求我只能显示 50 个结果（由于 api 的限制），所以我将如何在我的脚本中实现`Javascript`或`Ajax`（你认为最好的）`php`来对更多视频进行分页以显示观看者到达列表底部后的结果（例如，显示“再显示 50 个视频”的链接）

我是这种编程的新手，所以请帮忙

```
<?php
    $id = urlencode($_GET['id']);
    $url = "https://gdata.youtube.com/feeds/api/playlists/$id?alt=jsonc&v=2&start-index=1
&max-results=50";
    $content = file_get_contents($url);
    $json = json_decode($content, true);
    echo "<div id=\"info\"><center><h1><b>{$json['data']['title']}</center></b></h1><br>{$json['data']['description']} there are {$json['data']['totalItems']} uploaded in this playlist.</center><p></div><div class=\"decoration\"></div>";
    echo "<div id=\"center\">";
    echo "<ul>";
    $count = 0;
    foreach ($json['data']['items'] as $items) {
        ++$count;
        echo "<li style=\"width: 300px;min-height: auto;border: none;display: inline-block;margin: 5px;padding:10px;background-color: rgba(17,0,52,0.14);border-radius: 5px;\"><a href=\"video.php?plid={$json['data']['id']}&vidid={$items['video']['id']}\"><font size=\"5\" style=\"font-weight:bold;\">{$items['video']['title']}</font></a><Br \>";
        echo "<a href=\"video.php?plid={$json['data']['id']}&vidid={$items['video']['id']}\"><img style=\"width:300;height:auto;\" src=\"{$items['video']['thumbnail']['hqDefault']}\" title=\"{$items['video']['title']}\" id=\"ytThumb\"></img></a></li>";
    }
echo "</ul>";
echo "</div>";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T07:29:47.917

[已经在这里](https://stackoverflow.com/questions/11704452/stuck-with-paginating-youtube-api-playlist-results-trying-to-calculate-tha-sum)回答了

从外观上看，您只需`startindex`根据用户所在的页面更改您的 url。在页面底部，如果有 50 个结果，只需添加一个链接以加载更多，它将调用相同的 url，`startindex`并且大 1。

# jboss - Gradle - 如何从神奇的缓存中提取依赖项？

> ID：15581990
> 
> 赞同：2
> 
> 时间：2013-03-23T00:36:19.773
> 
> 标签：jboss, jetty, gradle, netflix

我正在查看一个配置了 gradle 的项目（github 上的 netflix/karyon），并且能够轻松构建战争（“gradle war”）。到目前为止，这是最好的。

哪里有战争？这很容易，只要`find . -type f \( -name "*.war" \)`……猜猜调试标志也会告诉我吗？

战争中有什么？只有示例项目的代码，它很棒、漂亮且轻量级。你会期待什么。

依赖项在哪里？现场无处。我确实有一个很好的主意，即它们位于隐藏的 gradle dot 目录中某处的神奇缓存中。

如何获取依赖项列表？

我想我可以“gradle clean && gradle war > out”并检查 maven.org GET 的 out 文件？我尝试了“gradle dependencies”并且它“构建成功”但没有列出依赖项。

我还尝试了“工作”的 eclipse 插件，它创建了一个 .project 文件。但这就是它所做的一切。没有向构建路径添加任何内容，也没有可言的库。

是的，我知道它可以运行，因为我可以使用 gradle jetty 插件成功运行 webapp。（也是魔法）

所以问题：

1.  是否有用于“找出依赖项并列出它们或更好地将它们提取到目录”的 gradle 命令

2.  为什么eclipse插件不起作用？(A) 我需要做什么才能在 eclipsify 步骤中正确识别源，以及 (B) 只是一个问题，Eclipse 如何知道 jar 文件的神奇位置和编码？

3.  有用于 gradle 的 jboss 插件吗？还是将工作中的 gradle/jetty 项目迁移到不会导致过早老化的工作 gradle/jboss 项目的最佳实践？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T11:18:41.837

在我看来， karyon 是一个多级项目，根项目没有依赖项，因此您没有得到任何输出，`gradle dependencies`也没有为根项目提供任何输出。所以你可能应该去`gradle :karyon-core:dependencies`获得一些更有趣的东西。

Gradle 将依赖项保存在其缓存中，`~/.gradle/caches/artifacts-<number>/filestore`但它是所有项目的缓存，而不仅仅是特定项目。如果您确实需要将所有依赖项复制到一个目录，您可以使用类似于此的副本：

```
task copyDeps(type: Copy) {
    from configurations.compile
    into "$projectDir/deps"
} 
```

然后`gradle copyDeps`将所有编译依赖项复制到`deps`您的项目目录中。

如果您坚持将所有依赖项放在 lib 目录中，那么您需要指定一个[平面 dir 存储库](http://www.gradle.org/docs/current/userguide/dependency_management.html#sec:flat_dir_resolver)：

```
repositories {
    flatDir {
        dirs 'lib'
    }
} 
```

不幸的是，我无法帮助您解决其他两个问题。

# jsp - springframework 多个表单在一个视图页面中

> ID：15581992
> 
> 赞同：1
> 
> 时间：2013-03-23T00:36:50.100
> 
> 标签：jsp, spring-mvc

我想要两个页面视图和两个控制器。

*配置文件/update.jsp*

```
form:form id="updateform" commandName="profile" method="post" action="/profile/update/${id}" 
```

*帐户/update.jsp*

```
form:form id="updateform" commandName="account" method="post" action="/account/update/${id}" 
```

现在我想将它们合并到一个页面视图中。我应该在 中添加个人资料和帐户`profile/update.jsp`，然后一键提交。

我怎样才能做到这一点？请告诉我。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-23T01:11:55.670

一个表单只能处理一组数据。最好的解决方案是创建一个具有两个实体的复杂 bean：

```
public class FormData {
    private Account account;
    private Profile profile;

    ....
} 
```

有一个表格：

```
<spring:url value="/handler" var="handler" />
<spring:form commandName="formData" action="${handler}" method="POST">
    <form:input path="account.id" />
    <form:input path="profile.name" />

    ...
</spring:form> 
```

和一个控制器方法：

```
@RequestMapping("handler")
public update(@ModelAttribute("formData") FormData formData){
    ...
} 
```

# c++ - 可变参数模板功能：专门化头/尾和空基本情况

> ID：15581999
> 
> 赞同：13
> 
> 时间：2013-03-23T00:37:34.137
> 
> 标签：c++, templates, c++11, variadic-templates, template-meta-programming

我想在一个类中有一个可变参数模板函数。可变参数模板参数是应该以类似循环的方式处理的字符。所以我想像在haskell中那样编写它，头/尾拆分列表，直到达到基本情况（空列表）。

作为一个例子，让我们只计算给定参数的数量（只是一个最小的例子）。

我想出了以下代码：

```
struct MyClass {
    template<char ...X>
    static int count();
};

template<>
int MyClass::count<>() {
    return 0;
}
template<char Head, char ...Tail>
int MyClass::count<Head, Tail...>() {
    return 1 + count<Tail...>();
} 
```

但是，这[似乎不起作用](http://ideone.com/ybuhxZ)：

```
prog.cpp:12:35: error: function template partial specialization ‘count<Head, Tail ...>’ is not allowed
prog.cpp:12:5: error: prototype for ‘int MyClass::count()’ does not match any in class ‘MyClass’
prog.cpp:3:16: error: candidate is: template<char ...X> static int MyClass::count() 
```

我怎样才能做到这一点？我知道函数不支持部分专业化。但我认为将可变参数模板专门化为头/尾和空基本案例版本不是*部分*专业化而是*完全*专业化，但也许我错了？我需要把它写成一个类而不是一个函数吗？

我找到了实现基本案例而不使用模板语法的示例（printf）。但我想我的情况不同，因为对 printf 的调用不使用模板语法而是*类型 deduction*，所以`printf(tail...)`调用`printf()`if`tail`为空。另一方面，就我而言，在调用基本情况时，`count<>()`与`count()`.

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-23T00:43:30.060

我会说重载函数模板而不是专门化它们通常是一个更好的主意：

```
struct MyClass {
    template<typename... Tail>
    static int count() {
        return 0;
    }

    template<char Head, char... Tail>
    static int count() {
        return 1 + count<Tail...>();
    }
};

#include <iostream>

int main() {
    std::cout << MyClass::count<'f','o','o'>();
} 
```

这是一个[活生生的例子](http://ideone.com/7SgiTL)。我还要提到内置运算符`sizeof...`可用于此目的：

```
struct MyClass {
    template<char... Chars>
    static int count() {
        return sizeof...(Chars);
    //         ^^^^^^^^^
    }
}; 
```