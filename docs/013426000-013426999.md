# StackOverflow 问答 13426000-13426999

# io - D 将标准输出重定向到函数

> ID：13426001
> 
> 赞同：1
> 
> 时间：2012-11-16T23:38:53.280
> 
> 标签：io, d, output, phobos

我想将所有控制台输出重定向到我自己的 GUI 控制台，包括对 C 写函数的所有调用。

我尝试过的事情：

*   创建一个新的流类，但 stdio.stdout 是一个文件，您不能为其分配流
*   完全创建一个新文件类，但不能扩展结构

我是否需要更深入地了解 C 绑定？非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T10:45:10.963

这个问题的典型解决方案在很多地方都有解释。这是一篇旧文章，解释了如何在 Windows 上执行此操作：http: [//edn.embarcadero.com/article/10387](http://edn.embarcadero.com/article/10387)

它在任何 UNIX 上的工作方式都相同。

简而言之：

1.  创建两个管道，一个用于子进程标准输入，第二个用于子进程标准输出。
2.  创建进程，并将这两个管道连接到它的标准输入/输出
3.  现在从您的 GUI 中，您刚刚从被攻击到子进程 stdout 的管道中读取数据，然后向被攻击到子进程 stdin 的管道写入数据。

第二种更简单的方法是在运行某个子进程时简单地使用该`popen()`函数。这个标准功能或多或少地完成了上述所有工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T12:35:59.383

我选择了另一条路径并编写了自己的 writeln 函数。由于显然我使用的库都没有直接进行终端输出，因此它似乎比管道或文件更麻烦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T23:50:49.930

一个简单但非常老套的方法是使用 C 的 freopen() 将标准输出重定向到一个临时文件，然后为您的控制台读入该文件。

您可能能够在操作系统级别将其重定向到管道中，然后让您的控制台在管道的另一端进行侦听。那会更干净，但更痛苦。

不管怎样，我认为 D 库不会有太大帮助——你会想要使用某种 C 库解决方案。

# java - Java - 迭代 ArrayList 并传输元素

> ID：13426002
> 
> 赞同：0
> 
> 时间：2012-11-16T23:38:59.707
> 
> 标签：java, iterator

我的程序创建了一副牌并将它们全部分发给 4 只不同的手。这是我的代码。它创建了 4 手牌并将牌发给每个手牌。

```
 Hand[] hands = new Hand[4];
       for(int i=0; i<hands.length; i++){
           hands[i] = new Hand();
       }
       for(int i=0; i<=Deck.size()+8; i++){
           for(Hand hand : hands){
               hand.addSingleCard(Deck.deal());
           }
       } 
```

现在我有 4 手牌，每手牌有 13 张牌，我想迭代第一手牌，删除每张牌并将其添加到第二手牌中，因此手牌 1 有 0 张牌，手牌 2 有 26 张牌。实现这一点的最佳方法是什么?

我是自学的，所以如果你有一种与其他人发布的方法不同的方法，我仍然很乐意看到它:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T23:43:56.633

假设 Hand 将其牌放入 a `Collection<Card>`（例如a`List<Card>`或 a ）：`Set<Card>`

```
public void transferAllCardsToOtherHand(Hand hand) {
    hand.cards.addAll(this.cards);
    this.cards.clear();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T23:44:08.810

假设您的`Hand`类中的卡片数据结构是数组或`Collection`，您可以使用 for-each 循环。

```
static void transferCards (Hand from, Hand to) {
    for (Card card : from.cards) {
        to.addSingleCard(card);
    }
    from.cards.clear();
} 
```

随意`from.cards`用代表您卡片的任何变量替换 。

# php - 查找重复记录，删除它们，对 MySQL 数据库中的所有记录进行排序和重新编号

> ID：13426005
> 
> 赞同：0
> 
> 时间：2012-11-16T23:39:23.960
> 
> 标签：php, mysql

以下 php 代码在数据库中查找重复记录，删除所有相似的记录（但其中一条没有），按时间顺序重新排序所有数据，最后从 1 到 n 逐步重新编号所有行（id 字段）。

问题：当我执行这段代码时，表名“mytable”在“tmp”中发生了变化，一切都停止并出错了。

为什么这个？我该如何解决这个问题？

```
 $creatmp = mysql_query("CREATE TABLE tmp AS SELECT * FROM mytable WHERE 1 GROUP BY name, surname, birthdate"); 
 $cancqsos = mysql_query("DROP TABLE mytable"); 
 $datmpaqsos = mysql_query("ALTER TABLE tmp RENAME TO mytable"); 

 $creariordinoid = mysql_query("CREATE TABLE riordinoid LIKE mytable");
 $popolariordinoid = mysql_query("INSERT INTO riordinoid SELECT * FROM qsos ORDER BY birthdate");
 $svuotacampoid = mysql_query("ALTER TABLE `riordinoid` DROP `id`");
 $ricontauno = mysql_query("ALTER TABLE `riordinoid` AUTO_INCREMENT = 1");
 $ricontadue = mysql_query("ALTER TABLE `riordinoid` ADD `id` int UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST;");
 $svuotaqsos = mysql_query("DROP TABLE mytable");
 $rinominariordinoid = mysql_query("ALTER TABLE riordinoid RENAME TO mytable"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:16:05.173

最简单的找出方法是在每次查询后测试所有`mysql_query()`s 和 echo的返回值。`mysql_error()`

当您知道哪个语句出错以及为什么出错时，您可以决定如何修复它。

我预先提出的问题是，`tmp`当您稍后用另一个 table 替换它时，为什么要使用 table 进行这个额外的步骤`riordinoid`。

`WHERE 1`进一步的观察是，`ORDER BY birthdate`复制表格时没有意义。

# c# - 如何获取给定表的索引列列表

> ID：13426006
> 
> 赞同：16
> 
> 时间：2012-11-16T23:39:30.223
> 
> 标签：c#, sqlite

给定一个 SQLite 数据库，我需要获取给定表中的哪些列被索引的列表，以及排序顺序。我需要从代码中执行此操作（C#，尽管这无关紧要），所以我真正需要的是一个 SQL 语句，如果存在的话，它会执行此操作。

我知道我可以这样做：

`SELECT sql FROM SQLite_master WHERE type = 'index' AND tbl_name = 'MyTableName'`

然后手动解析生成的 SQL，但是在某处是否有一些元数据可以让我查询这些元数据？

```
----------------------------------
| 姓名 | 专栏 | 方向 |
 ----------------------------------
| idx_a | 科尔A | 升学 |
 ----------------------------------
| idx_a_b | ColB, ColB | 递减 |
 ----------------------------------

```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-17T00:21:06.483

使用`PRAGMA index_list(table-name);`和`PRAGMA index_info(index-name);` [扩展名](http://www.sqlite.org/pragma.html)。

更新：`PRAGMA schema.index_xinfo(index-name);`将返回键列的排序顺序。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-01-19T20:57:54.610

在 where 子句中添加您想要的任何条件。字段是：

```
CREATE TABLE sqlite_master (
  type TEXT,
  name TEXT,
  tbl_name TEXT,
  rootpage INTEGER,
  sql TEXT
); 
```

可粘贴的选择...索引要包含的重要字段是“sql”。不会列出创建表语句中定义的主键。

```
select type, name, tbl_name, sql
FROM sqlite_master
WHERE type='index' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-17T00:12:07.153

这就是您的实际操作方式：所有索引元数据都可以通过“sqlite_master”表获得。请参阅 SQLite FAQ 的 Q7：[http ://www.sqlite.org/faq.html#q7](http://www.sqlite.org/faq.html#q7)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-09-16T12:52:10.577

```
SELECT 
    m.tbl_name as table_name,
    il.name as index_name,
    ii.name as column_name,
    CASE il.origin when 'pk' then 1 else 0 END as is_primary_key,
    CASE il.[unique] when 1 then 0 else 1 END as non_unique,
    il.[unique] as is_unique,
    il.partial,
    il.seq as sequence_in_index
FROM sqlite_master AS m,
    pragma_index_list(m.name) AS il,
    pragma_index_info(il.name) AS ii
WHERE 
    m.type = 'table'
    and m.tbl_name = 'YOUR TABLENAME HERE'
GROUP BY
    m.tbl_name,
    il.name,
    ii.name,
    il.origin,
    il.partial,
    il.seq
ORDER BY 1,6 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-16T00:03:54.300

@neil 简要提到了[SQLite Pragma 语句](https://www.sqlite.org/pragma.html) `PRAGMA INDEX_LIST['table_name']`和`PRAGMA INDEX_INFO['index_name']`. 根据文档，这些既作为 SQLite 命令存在，也可以在函数中使用（即`pragma_index_list(table_name)`和`pragma_index_info(index_name)`.

为了更好地理解这一点，让我们看一下下面的 SQL：

```
CREATE TABLE Assets
(
    Asset_Id     INTEGER NOT NULL,
    Longitude    REAL    NOT NULL,
    Latitude     REAL    NOT NULL,
    Name         TEXT    NOT NULL,
    Installation REAL    NOT NULL,
    Constraint PK_Assets PRIMARY KEY (Asset_Id)
);
CREATE INDEX IX_Assets_Coordinate On Assets (Longitude, Latitude);
CREATE INDEX IX_Assets_Name On Assets (Name); 
```

以下 SQLite 会话演示了如何查询索引：

```
.mode csv
sqlite> PRAGMA index_list('Assets');
seq,name,unique
0,IX_Assets_Name,0
1,IX_Assets_Coordinate,0
sqlite> PRAGMA index_info('IX_Assets_Name');
seqno,cid,name
0,3,Name
sqlite> PRAGMA index_info('IX_Assets_Coordinate');
seqno,cid,name
0,1,Longitude
1,2,Latitude
sqlite> 
```

有趣的是这些`PRAGMA`命令可以像`SELECT`语句一样使用，因此在`C#`.

在[SQLite Pragma 语句中](https://www.sqlite.org/pragma.html)，他们有一个有趣的示例 SQL 语句，用于枚举所有表的所有索引列：

```
SELECT DISTINCT m.name || '.' || ii.name AS 'indexed-columns'
  FROM sqlite_master AS m,
       pragma_index_list(m.name) AS il,
       pragma_index_info(il.name) AS ii
 WHERE m.type = 'table'
 ORDER BY 1; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-17T17:33:02.593

我找不到任何方法来简单地查询表元并获得我想要的 indo，所以如果有人需要它，这就是我使用的。是的，Regex 可能做得更干净，但你知道格言，如果 Regex 可以解决问题，那么现在你有两个问题。

```
public class SqlIndexInfo
{
    public string IndexName { get; set; }
    public string TableName { get; set; }
    public string[] Fields { get; set; }
    public bool IsAscending { get; set; }

    public bool IsComposite
    {
        get { return Fields.Length > 1; }
    }
}

public static class Extensions
{
    public static SqlIndexInfo ParseToIndexInfo(this string sql)
    {
        sql = sql.Trim();
        var info = new SqlIndexInfo();

        var i = sql.IndexOf("CREATE INDEX", 0, StringComparison.InvariantCultureIgnoreCase);
        if (i < 0) throw new ArgumentException("String is not valid CREATE INDEX SQL");
        var indexNameStart = i + "CREATE INDEX".Length + 1;

        i = sql.IndexOf(" ON ", 0, StringComparison.InvariantCultureIgnoreCase);
        if (i < 0) throw new ArgumentException("String is not valid CREATE INDEX SQL");
        var indexNameEnd = i;
        var tableNameStart = i + " ON ".Length;

        i = sql.IndexOf("(", 0, StringComparison.InvariantCultureIgnoreCase);
        if (i < 0) throw new ArgumentException("String is not valid CREATE INDEX SQL");
        var tableNameEnd = i;
        var fieldNamesStart = i + 1;

        i = sql.IndexOf(")", 0, StringComparison.InvariantCultureIgnoreCase);
        if (i < 0) throw new ArgumentException("String is not valid CREATE INDEX SQL");
        var fieldNamesEnd = i;
        var directionStart = i + 1;

        // TODO: strip brackets and/or single quotes?

        info.IndexName = sql.Substring(indexNameStart, indexNameEnd - indexNameStart).Trim();
        info.TableName = sql.Substring(tableNameStart, tableNameEnd - tableNameStart).Trim();
        info.Fields = (from f in sql.Substring(fieldNamesStart, fieldNamesEnd - fieldNamesStart).Split(',')
                      where !string.IsNullOrEmpty(f)
                      select f.Trim()).ToArray();

        if (directionStart >= sql.Length)
        {
            info.IsAscending = true;
        }
        else
        {
            info.IsAscending = sql.IndexOf("ASC", directionStart, StringComparison.InvariantCultureIgnoreCase) >= 0;
        }

        return info;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-15T07:33:31.710

根据@Steve Lloyd 的回答进行优化，按顺序排列`ii.seqno`

```
SELECT 
    m.tbl_name as table_name,
    il.name as index_name,
    ii.name as column_name,
    CASE il.origin when 'pk' then 1 else 0 END as is_primary_key,
    CASE il.[unique] when 1 then 0 else 1 END as non_unique,
    il.[unique] as is_unique,
    il.partial,
    il.seq as sequence_in_index,
    ii.seqno as sequence_in_column
FROM sqlite_master AS m,
    pragma_index_list(m.name) AS il,
    pragma_index_info(il.name) AS ii
WHERE 
    m.type = 'table'
    and m.tbl_name = 'YOUR TABLENAME HERE'
GROUP BY
    m.tbl_name,
    il.name,
    ii.name,
    il.origin,
    il.partial,
    il.seq
ORDER BY index_name,il.seq,ii.seqno 
```

# wcf - signalR 和大数据传输

> ID：13426014
> 
> 赞同：4
> 
> 时间：2012-11-16T23:40:16.620
> 
> 标签：wcf, webserver, client, signalr

我计划在客户端和服务器之间使用 signalR 进行一些实时通信。但是客户端不时需要向服务器发送大约 15MB 的大数据。

1）看起来 signalR 不适合发送大数据。他们是否在最近的版本中添加了对发送大数据的任何支持？

2）我可以在消息中发送的最大数据数组是多少？

3）拆分大数据并将其作为较小的块发送是否太慢？

4）什么是替代选项？有什么我可以研究的例子吗？

5) 我可以运行 WCF 服务来传输大数据以及 signalR 进行实时通信吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-17T02:03:39.387

通过 SignalR 发送将使用错误的工具来完成这项工作。在这种情况下，最好的办法是通过 SignalR 发送一条特定消息，该消息将 URL 作为参数传递。然后，您可以使用多种方法在客户端触发基于标准 HTTP GET 的下载来处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-05T06:42:57.150

*如果您真的非常需要使用 SignalR，您可以查看我的答案： [如何在 .NET 客户端中通过 SignalR 发送大数据](https://stackoverflow.com/questions/24262041/how-to-send-big-data-via-signalr-in-net-client/39854957#39854957)*

您可以通过将 MaxIncomingWebSocketMessageSize 设置为 null 在 Startup.cs 中添加使消息大小为“无限”的行：

```
public class Startup
{
    public void Configuration(IAppBuilder app)
    {
    app.MapSignalR();
    GlobalHost.Configuration.MaxIncomingWebSocketMessageSize = null;
    }
} 
```

} 我的工作有约 200kb 的数据，10 条消息始终发送。我不知道如果每秒发送的数据更多，它的效果如何。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-25T14:11:11.687

拆分数据并发送。您可以发送后台模式或正常发送，使用压缩技术，这样可以减少数据大小。

# c - 如何在 C 中按索引对齐两个整数数组？

> ID：13426015
> 
> 赞同：0
> 
> 时间：2012-11-16T23:40:25.580
> 
> 标签：c, arrays, math

我知道这个问题可能看起来不是很清楚。

基本上，我正在尝试编写一个程序来显示基本算术计算（当然是通过控制台），就像孩子们会做的那样。

例如：

   5,294
+ 0,706

=等

所以我将两个数字放在单独的数组中，按数字分割（所以一个 int 数组，如：{5,2,9,4}）。

我要学习/弄清楚的是，如果两组数字的位数不同，我将如何将它们对齐。例如，如果我只有 706 而不是 0,706？目前我有两个数组，一个像 {5,2,9,4} 和另一个像这样：{7,0,6} - 我需要 4 超过 6。

希望这对大家有意义！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:14:44.943

我认为此代码片段可能会生成您正在寻找的那种输出，它适用于普通整数，因此您无需弄乱数组：

```
char tmpstr[1];
int total = first + second;
int width = snprintf(tmpstr, 1, "%d", total);
printf("  %*d\n", width, first);
printf("+ %*d\n", width, second);
printf("  %.*s\n", width, "-----------");
printf("= %*d\n", width, total); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T23:48:03.457

只需查找每个数组的长度并找到最长的长度。然后为每个没有该长度的数组创建新数组，并首先用旧短数组的数字填充这些数组，然后为其余的值填充零，直到达到索引 0。我希望我做到了正确理解你的问题，用我的建议回答你的问题。

这当然只有在不涉及小数点的情况下才有效。如果涉及小数点，则必须找到其左侧和右侧的最大位数，然后为每个不符合此条件的旧数组创建新数组，并执行与上述相同的操作。

**编辑：**一种更简单的方法，可以简单地通过反转每个数组的顺序，然后进行计算，但将数字带到右侧（而不是左侧）并最终反转结果的顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T23:48:46.670

您需要有关数组中小数点的信息。否则你可以只使用整数。我会将指数以 10 为底，并使其成为我的第一个或最后一个条目。一旦你有了这个，你就可以用它来相应地改变你的格式。

'0,706' 将变成 '{-3, 7, 0, 6}' 第一个数字是指数。然后你像这样对齐你的逗号

```
//0 -1 -2 -3
   ,  
   , 
```

然后输入你的号码

```
//0 -1 -2 -3
  0, 7  0  6
   , 
```

冲洗并重复。

# ios - 我的 self.view 尺寸错误

> ID：13426016
> 
> 赞同：8
> 
> 时间：2012-11-16T23:40:28.500
> 
> 标签：ios, uiview, autorotate, autosize

我的观点有错误的维度。我只运行横向，但视图报告纵向尺寸“视图宽度 = 768.000000 高度 = 1024.000000”有什么想法可以解决这个问题吗？我玩过我尝试过的自动旋转

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft|| interfaceOrientation == UIInterfaceOrientationLandscapeRight);
} 
```

和

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return YES;
} 
```

它在视图上看起来不错，但尺寸确实让我的应用程序混乱。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-17T02:09:57.577

你永远不应该`frame`用来告诉你自己的维度。 `frame`相对于父容器视图。要查找相对于您的视图自己的坐标系的尺寸，请使用`bounds`：`self.view.bounds`

例如，父视图可能会看到宽度 = 768 和高度 = 1024 的子视图，但旋转 90 度变换。这就是父视图如何看待子视图，这就是它的意义`self.view.frame`所在。宽度 = 1024 和高度 = 768 的子视图反映在视图在其自己的坐标系中如何看待自己，即`self.view.bounds`

# java - 维护 C++ 对象，根据 UI 使用其方法

> ID：13426025
> 
> 赞同：0
> 
> 时间：2012-11-16T23:41:30.960
> 
> 标签：java, c++, multithreading, android-ndk, java-native-interface

我有一个问题需要解决：

我有一个带有本机方法的java，它创建一个对象并利用该对象的方法。这是我的 java 代码：我有一个名为 IssmJni 的 java 文件，它包含一个本地方法：

```
public static native long fac(long n);
    static {
        System.loadLibrary("FacLib");
    }
public static long facIterative(long n)
{
    return fac(n); 
```

在我的主要课程中，我有这个：

```
long result = IssmJni.facIterative(Long.parseLong(input));
    System.out.println(result); 
```

这是我的 C++ 代码：主文件：

```
static jlong factorial(JNIEnv *env, jclass clazz, jlong n)
    {
        fac *f = new fac();
        jlong result = (jlong) (f->factorial(n));
        delete(f);
        return (jlong) result;
    } 
```

头文件：

```
class fac
{
    public:
    long factorial(long n);
}; 
```

fac.cpp：

```
#include "com_lan_factorial_FacLib.h"
#include "fac.h"

long fac::factorial(long n)
{
    long f = 1;
    long i;
    for(i = 1; i <= n; i++)
    {
         f *= i;
    }
    return f;
} 
```

一切正常，所以发生的情况是 UI 将输入一个数字，称为 C++ 代码并生成一个新对象调用 fac，并在该类 fac 中使用方法阶乘。通过这条线

fac *f = 新 fac(); jlong​​ 结果 = (jlong​​) (f->factorial(n));

我想要的是保持相同的对象 fac，但使用具有不同输入的阶乘方法。我尽量远离 pthread，因为它太复杂了。有没有一种方法可以创建另一个 java 线程并在我的应用程序的整个过程中保持该对象处于活动状态，并在我有新的用户输入时使用该阶乘。然后在应用程序死亡时摆脱这个对象？

总之，我想保留 1 个对象 fac 实例，并多次使用阶乘方法。不做原生pthread有可能吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:44:59.687

这就是我想出的。

```
static fac* pfac = NULL;

namespace com_lan_factorial
{
    static jlong factorial(JNIEnv *env, jclass clazz, jlong n)
    {
        pfac = new fac();
        jlong result = (jlong) (pfac->factorial(n));
        return (jlong) result;
    }

    static jlong factorial_ten(JNIEnv *env, jclass clazz)
    {
        jlong result = (jlong) (pfac->factorial(3));
        return (jlong) result;
    } 
```

所以我创建了一个名为 pfac 的指针，在第一次运行时 pfac 将被分配给一个新对象 pfac = new fac(); 在第二次运行时，我只是重用了 pfac 指针并调用了阶乘函数。这完全有效，但我不确定这是用 2 个阶乘方法创建 2 个 fac 对象，还是只用 1 个 fac 方法和相同的阶乘方法。任何人都可以验证。谢谢

# objective-c - UIWebview 用户名和密码处理

> ID：13426029
> 
> 赞同：-1
> 
> 时间：2012-11-16T23:41:59.727
> 
> 标签：objective-c, login, uiwebview

一些信息：

我制作了一个应用程序，可以在网站的表格视图中显示一些房子。如果您选择一个，您将获得包含一些信息的详细视图，我向它添加了一个按钮，当您按下它时，它会打开一个直接链接（进入应用程序内的网络视图）以在网站上“响应”房屋。

问题：第一次按下按钮时，它会给出一个错误=您没有登录......并返回登录表单，如果您登录一切正常。如果您检查另一所房子并再次按下按钮，它会记住登录并立即响应。如果您退出应用程序并再次打开它，则练习将从头开始嘿嘿。

我想到了 2 个解决方案： 1）我认为我应该使用用户名和密码进行 alerview，当您打开应用程序时填写它，然后每次按下响应按钮时它都会自动填充它。（不知道怎么做）

2）保存缓存或类似的东西，这样当你回来时，就像你从未离开过一样？

什么是更好的选择，有没有更好的方法，以便按下响应按钮的“丑陋方式”给出错误->进入登录->您登录。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:21:45.933

在开始之前，我假设您在 tableview 中显示的网站归您所有，而不是第三方所有，或者您有权允许您的应用程序存储用户名/密码并自动登录用户。

请记住，这只是一个概述，而不是一个实现——它可能是你所做的，或者只是给你其他想法来探索作为最终解决方案。

如果想法是保存用户名和密码，以便用户不必继续重新输入，我建议将其与您的应用程序一起存储，与 UIWebView 内容分开（提示用户将其与您的应用程序分开）。

然后，当用户自应用程序启动后第一次访问网页时，您可以改为发布一个请求，发送您存储的登录名和密码（到网页使用的相同登录表单），成功后，然后加载你的页面。这样，登录页面永远不会出现在最终用户面前。

（您当然会安全地进行所有这些操作，因为您正在处理用户名和密码，并对它们的存储进行加密......）

# python - 如何将字典值分配给 Python 中的变量？

> ID：13426030
> 
> 赞同：16
> 
> 时间：2012-11-16T23:42:08.900
> 
> 标签：python, variables, dictionary, variable-assignment, key-value

在编程方面，我是个业余爱好者，但我正在尝试使用 Python。基本上我想做的是对字典值使用数学。我能想到的唯一方法是将字典值分配给变量，然后将新值分配给字典。像这样的东西：

```
my_dictionary {
    'foo' = 10,
    'bar' = 20,
    }

variable = my_dictionary['foo']
new_variable += variable
my_dictionary['foo'] = new_variable 
```

但是，当我尝试以这种方式分配变量时，会出现语法错误。有没有更好更直接的方法来做到这一点？

编辑：另外，我只是以此为例。假设这是一段代码，而不是整个程序。尚未声明新变量的事实完全无关紧要，我只想知道如何对字典值执行数学运算。另外，我正在尝试访问我有我的代码的函数之外的字典。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-16T23:47:29.117

您的代码中有各种错误。首先，您忘记了`=`第一行中的。此外，在 dict 定义中，您必须使用`:`将键与值分开。

接下来是您必须先定义`new_variable`，然后才能向其中添加内容。

这将起作用：

```
my_dictionary = {'foo' : 10, 'bar' : 20}

variable = my_dictionary['foo']
new_variable = 0 # Get the value from another place
new_variable += variable
my_dictionary['foo'] = new_variable 
```

但是您可以简单地`new_variable`直接添加到 dict 条目：

```
my_dictionary = {'foo' : 10, 'bar' : 20}

variable = my_dictionary['foo']
new_variable = 0 # Get the value from another place
my_dictionary['foo'] += new_variable 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-02-28T06:05:04.590

试试这个。它对我有用。

```
>>> d = {'a': 1, 'b': 2}
>>> locals().update(d)
>>> print(a)
1 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T23:51:29.433

您正在尝试对不存在的变量进行操作

```
new_variable += variable 
```

new_variable 没有定义，所以你不能增加它。简单地试试。

```
my_dictionary['foo'] += my_dictionary['foo'] 
```

我假设 my_dictionary 只是伪代码，实际上并不是您在代码中使用的定义，否则这也是无效的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-16T23:46:10.117

此代码不分配变量`my_dictionary`。尝试：

```
my_dictionary = {
    'foo'... 
```

此外，您需要在`dict`. 例如：`'foo' : 10`

编辑：忘了提，如果你`+=`用来改变一个变量，这个变量必须事先存在。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T23:47:21.290

当你定义字典时你会得到一个`SyntaxError`，因为你做错了。尝试查看另一个 Python 程序（或文档），并按照那里显示的方式进行操作，而不是仅仅随心所欲。

```
my_dictionary = {'foo': 10, 'bar': 20} 
```

数学部分在语法上很好，但你让它比你需要的要困难得多：

```
my_dictionary['foo'] += whatever 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-16T23:47:27.223

这不是你创建字典的方式。这是正确的语法：

```
my_dictionary = {
    'foo': 10,
    'bar': 20,
} 
```

最后的逗号是不必要的，但可以减少后续编辑出错的可能性。你也可以这样做：

```
my_dictionary = dict(foo=10, bar=20) 
```

您可以使用`+=`运算符来更新字典值：

```
my_dictionary['foo'] += 30 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-17T21:41:07.123

我喜欢以下方式，因为您可以将字典键与变量名匹配。此示例显示如何将 char 与相应的变量名称匹配（并且该变量名称甚至由其他变量决定）：

```
va1 = 50
val2= 20

a = val + 1 * val2
b = val + 2 * val2
space = val + 3 * val2

my_dictionary = {
'a':a,
'b':b,
' ':space
}

msg = "aB "
for char in msg:
    try:
        char = char.lower()
        print my_dictionary [char]
    except:
        print my_dictionary [char] 
```

输出：

70

90

110

# git - 如何让 git 忽略某些文件冲突和差异？

> ID：13426032
> 
> 赞同：3
> 
> 时间：2012-11-16T23:42:21.047
> 
> 标签：git, merge, diff

我们有一个自动生成的 javascript 文件，该文件在我们的 git 存储库中进行跟踪。问题是它在评论中包含一个（无用的）时间戳，这通常会为我们造成微不足道的合并冲突。我想避免这些冲突。

我以为我找到[了 .gitattributes 和 filter/smudge 的解决方案](https://stackoverflow.com/questions/2316677/can-git-automatically-switch-between-spaces-and-tabs/2316728#2316728)。我按以下方式设置它，以便在提交或签出时从文件中删除此时间戳行：

.git 属性：

```
<the file>.js filter=tsfilter
<the file>.js smudge=tsfilter 
```

.git/配置：

```
[filter "tsfilter"]
      clean = perl -pe \"s/\\/\\/.*<the pattern>.*$//\"
      smudge = perl -pe \"s/\\/\\/.*<the pattern>.*$//\" 
```

虽然这似乎消除了合并冲突，但它引入了另一个烦恼，因为该文件现在仍处于不断修改的状态。也就是说，“状态”仍然显示它已修改，因为本地（预过滤）副本包含时间戳行（但提交的文件不包含）。

有没有更好的方法来解决这个问题，既可以避免合并冲突，又可以隐藏对文件这一部分的本地更改？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:17:50.017

我可能错误地解释了您的问题，但听起来您可以使用相关文件的策略`ours`或`theirs`合并策略。根据对[这个问题](https://stackoverflow.com/questions/928646/how-do-i-tell-git-to-always-select-my-local-version-for-conflicted-merges-on-a-s)的回答，您可以执行以下操作：

.git 属性：

```
file.js merge=ours 
```

.git/配置：

```
[merge "ours"]
    name = Keep my file
    driver = true 
```

这将始终保留您的文件版本。

合并只是稍微困难一些`theirs`——你不能只是将驱动程序更改为`false`，你需要定义一个脚本来保存它们的更改。上面链接的问题`theirs`更详细地介绍了一种策略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:21:00.517

您可以修改生成该文件的程序以不包含时间戳，或者为将删除时间戳的程序编写一个包装器。

# vb.net - 在 vb.net 中提供文本字段解析器的字符串

> ID：13426037
> 
> 赞同：4
> 
> 时间：2012-11-16T23:43:35.580
> 
> 标签：vb.net, string, stream

在我问之前，我只想说我已经查过了，我就是想不通。
因此，我收到了一个网络电话，它返回了一个非常长的文本字符串，我需要将其拆分。我想使用 textfieldparser 但我不想将此字符串保存为文件，并且 textfieldparser 似乎都是关于文件或...流的，我不理解流。那么我如何将字符串输入其中呢？我可以将其转换为流吗？我意识到这可能非常简单，所以我为我的无知道歉。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-16T23:57:16.010

Textfieldparser has a constructor that takes a TextReader. Have you tried something like this:

```
Dim t As New FileIO.TextFieldParser(New System.IO.StringReader("thestringinside")) 
```

You might also look on [www.filehelpers.net](http://www.filehelpers.net) (have never tried myself, but looks promising - I am in no way affiliated!) because the engine also supports a *ReadString* method

# mysql - MySQL inheritance?

> ID：13426039
> 
> 赞同：4
> 
> 时间：2012-11-16T23:43:51.893
> 
> 标签：mysql, sql, database-design, single-table-inheritance, class-table-inheritance

What would be the best way to design this MySQL database?

I have `cars`, `fuels`, and `motor oils`. Each car can use any number of `fuels` and any number of `motor oils`. What would be the best way to design this database?

So, one `car` can have one or many `fuels`, and one or many `motor oils`.

So I would need to have `cars`, `fuels`, and `motor_oils` tables in my database. Now since `fuels` and `motor_oils` have some similar properties like price, date_produced etc. Would it be smart for me to create another table called lets say `products`?

When using OOP language I would have `Product` entity, `Fuel` and `MotorOils` would extend `Product` and this way have properties defined in `Product`.

How would I design this in Mysql database? Is there such thing as inheritance in MySQL? I know that relation database does not have inheritance, and that there is a way to mimic this in MySQL, just need someone to explain better how is this done?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:54:37.490

You could have a products table and a foreign key in each, fuel and motor oils linking to the products table in order to have some kind of inheritance.

Many to many relationships you create by defining a mapping table with a foreign between the entities.

Given you have cars and fuels you could create a table carsFuelsMap which has two foreign key fields morors_id and fuels_id

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T23:55:11.667

You can simulate the delegation part of OOP in SQL using a one-to-one foreign key. So for instance a `Fuel` entry would have a foreign key to a `Product` that would identify all the shared values.

As for linking cars and fuels, this is actually a many-to-many relationship. The traditional way would use a `CarFuel` table that has one row for each valid combination of car and fuel, but as you've delegated parts of both `Fuel` and `MotorOil` to a `Product`, you probably want to use a `CarProduct` table, and if you only need fuels you can then join to the `Fuel` table.

# windows-8 - 我如何回复 Windows 商店评论？

> ID：13426051
> 
> 赞同：0
> 
> 时间：2012-11-16T23:44:54.773
> 
> 标签：windows-8

我有一个 Windows 商店应用程序，审阅者指出该应用程序无法正常工作（崩溃）。我需要找到他正在使用的硬件和其他信息。我必须通过哪些选项来获取有关此崩溃的更多信息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:10:02.093

您可以做的不多，首先您在应用提交过程中在应用描述中提供了支持电子邮件，可供用户使用。其次，您可以编写自己的评论并在其中回复错误或询问更多详细信息。在应用程序中添加您的电子邮件/Twitter/Facebook 链接也是一个好主意，因此用户通过反馈与您联系并不难。
最后的手段可能是从 Windows 应用商店收集有关您的应用程序的错误报告并在其中找到错误，此处对此进行了描述：http:
[//blogs.msdn.com/b/windowsstore/archive/2012/06/27/improving -apps-with-quality-reports.aspx](http://blogs.msdn.com/b/windowsstore/archive/2012/06/27/improving-apps-with-quality-reports.aspx)

# android - Android - AnimatorSet、Object Animator - Bounce 动画链正在合并？

> ID：13426052
> 
> 赞同：9
> 
> 时间：2012-11-16T23:44:55.380
> 
> 标签：android, animation

我有一个关于 Android 中的 ObjectAnimator 的问题。我正在尝试模拟一个反弹效果，其中视图向上滑动（减少 Y 值）并在相同的量“n”之后向后滑动，然后视图再次上下滑动，但这次是“n/2”（所以距离的一半）。

因此，较大的反弹，然后是较浅的反弹 - 即 Mac 图标在需要您注意时在托盘中所做的事情。

这是我到目前为止尝试过的（假设`v`是 a `View`）：

```
float y = v.getTranslationY(),distance = 20F;

                AnimatorSet s = new AnimatorSet();
                s.play(ObjectAnimator.ofFloat(v, "translationY", y- distance).setDuration(500))
                .before(ObjectAnimator.ofFloat(v, "translationY", y).setDuration(500))
                .before(ObjectAnimator.ofFloat(v, "translationY", y- (distance/2)).setDuration(500))
                .before(ObjectAnimator.ofFloat(v, "translationY", y).setDuration(500));
                s.start(); 
```

忽略代码质量，这是一个 POC！我希望这会起作用，但它似乎只“反弹”一次，好像它结合了动画，尽管使用了`.before()`.

您能否告诉我如何创建不合并为一个的复杂 AnimatorSet 链，因为我似乎遗漏了一些东西？

**奖励：**对于加分，我如何设置 AnimatorSet 的重复？

非常感谢！

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-22T18:57:55.570

好的，所以我最终找到了一种通过忽略流利的构建器来实现顺序动画的相当巧妙的方法，并且只使用以下`playSequentially()`方法：

```
AnimatorSet as = new AnimatorSet();
as.playSequentially(ObjectAnimator.ofFloat(...), // anim 1
                    ObjectAnimator.ofFloat(...), // anim 2
                    ObjectAnimator.ofFloat(...), // anim 3
                    ObjectAnimator.ofFloat(...)); // anim 4
as.setDuration(600);
as.start(); 
```

除了涉及监听器中回调 onAnimationEnd 的肮脏黑客之外，仍然没有重复。必须是一种更简单的方法，所以也许有人可以在他们知道的时候对其进行编辑。

无论如何，希望以上内容对某人有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-17T20:06:00.573

当您使用 Builder 时，所有返回的依赖项都指向第一个 Animator，因此在第一次移动之后会同时发生 3 次反弹。不幸的是，AnimatorSet 似乎在某些方面被破坏了，其中一个是重复的：[https ://code.google.com/p/android/issues/detail?id=17662](https://code.google.com/p/android/issues/detail?id=17662)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-15T13:37:06.883

如果您正在使用**`Kotlin`**这样做：

```
 val animationSet =  AnimatorSet();
            animationSet.playSequentially(cornerAnimation, colorChangeAnimator,cardElevationAnimator )
            animationSet.duration = ANIMATION_INTERVAL_MS;
            animationSet.start();
            animationSet.addListener(object :AnimatorUpdateListener, Animator.AnimatorListener {
                override fun onAnimationEnd(animation: Animator?) {
                    currentColor = toColor
                }
                override fun onAnimationUpdate(animation: ValueAnimator?) {}
                override fun onAnimationRepeat(animation: Animator?) {}
                override fun onAnimationCancel(animation: Animator?) {}
                override fun onAnimationStart(animation: Animator?) {}
            }) 
```

# playframework - Play 框架中的路由

> ID：13426053
> 
> 赞同：1
> 
> 时间：2012-11-16T23:44:56.193
> 
> 标签：playframework

更新我的 Play 应用程序的 conf 目录中的路由文件似乎没有反映。

```
# This file defines all application routes (Higher priority routes first)
# ~~~~

# Home page
GET     /                           controllers.Application.index()
GET     /channel                    controllers.Application.createMember()

# Map static resources from the /public folder to the /assets URL path
GET     /assets/*file               controllers.Assets.at(path="/public", file) 
```

当我在 localhost:9000/channel 向我的服务器发出请求时，它说找不到操作。我的 play 应用程序当前驻留在 Eclipse 工作空间内。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T05:18:34.630

我只是猜测您添加了路线并试图调用**不**`production mode`使用热重载功能的路线。

 **重新启动您的应用程序并再次检查。

使用`play run`命令而不是`play start`留在中`development mode`（这反映了代码更改而无需重新部署）。它将在下一次浏览器请求后重新编译更改的类。

如果您使用`play ~run`它，它将在保存更改的类后立即重新编译它们（甚至在下一次请求之前）。**

# uitableview - 如何更新存档和表格视图单元格

> ID：13426059
> 
> 赞同：0
> 
> 时间：2012-11-16T23:45:11.643
> 
> 标签：uitableview, archive, master-detail

我正在开发 MasterDetail 应用程序，并且在更新我的 itemCells 时遇到问题。使用下面 DetailViewController 中的代码，我希望能够在触摸单元格（有一个自定义 ItemCell）后访问详细视图，编辑文本字段中的内容，点击保存按钮，更新项目数据，然后弹回 MasterViewController。

**来自 DetailViewController.m**

```
- (IBAction)addItem:(id)sender 
```

{

```
RoomItem *item = [[RoomItem alloc] initWithName:[_roomTxt text] Building:[_buildingTxt text]];

//add item is an addObject method i've placed in RoomList.m
[[RoomList sharedStore] addItem:item];

[self.navigationController popToRootViewControllerAnimated:YES]; 
```

}

很明显，这只是创建一个新的表格视图项目而不是更新原始项目，但我是一个愚蠢的菜鸟，无法在文档中找到任何内容来帮助我解决这个问题。

想法？如果我没有提供足够的信息/代码来准确解释情况，请告诉我。

另外，有没有办法通过 UITableViewAccessory 实现相同的功能？

谢谢。

这对我有用。看来我没有正确获取核心数据实体。但是，objectAtIndex 查询仍然是一个问题，因为它只更新了 index:0 处的 RoomItem。 **如何获取我要更新的 RoomItem 的索引？**

**编辑：**

```
- (RoomItem *)updateItemWithRoom:(NSString *)room Building:(NSString *)building
{
NSError *error = nil;

NSEntityDescription *entity = [NSEntityDescription entityForName:@"RoomItem" inManagedObjectContext:context];
NSFetchRequest *request = [[NSFetchRequest alloc] init];
[request setEntity:entity];

RoomItem *currentRoomItem = [[context executeFetchRequest:request error:&error] objectAtIndex:0];
request = nil;

[currentRoomItem setRoom:room];
[currentRoomItem setBuilding:building];

[self saveChanges];

return currentRoomItem;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T23:52:58.017

尝试调用 viewdidappear 以使用重新加载数据从表视图重新加载数据。

# linux - 使用 linux 服务器上的 web 应用程序运行脚本

> ID：13426061
> 
> 赞同：-3
> 
> 时间：2012-11-16T23:45:22.930
> 
> 标签：linux, perl, bash, web-applications

我在 AWS 上运行的 linux 服务器实例上的文件中有一个 bash 和 perl 脚本。我正在尝试将 Web 应用程序放在同一台服务器上，该服务器将作为 GUI 运行该脚本。（IE 在网页上放置了一个按钮，当单击该按钮时，将运行位于同一服务器上但在 bin 目录中的脚本）

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T02:09:53.863

一旦您以您选择的语言设置了网络服务器，请为您选择的请求创建一个处理程序。完成后，Google `exec <language>`，其中 <language> 是您编写它的语言。以下是一些流行语言的参考：

*   [去](http://golang.org/pkg/os/exec/)
*   [Javascript (node.js)](http://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback)
*   [PHP](http://php.net/manual/en/function.exec.php)
*   [Python](http://docs.python.org/2/library/subprocess.html)
*   [红宝石](https://stackoverflow.com/questions/2232/calling-bash-commands-from-ruby)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T23:54:22.773

I'm not sure how your server is setup and there's a possibility that the apache user might not have correct permissions to run some commands but like most programming languages like php have a command for running external commands.

Checkout - [http://php.net/manual/en/function.exec.php](http://php.net/manual/en/function.exec.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-17T00:16:48.773

第 1 步：安装 HTTP 服务器
第 2 步：配置服务器以将某个目录中的某些文件作为 CGI 脚本处理。
第 3 步：`<form>`向您的页面添加`POST`一个 CGI 脚本。包括一个`submit`按钮。这不是真正的网络应用程序，在服务器上运行脚本是古老的。查看 90 年代网页的留言簿和反图像。

脚本本身看起来像（在 Perl 中）：

```
#!/usr/bin/perl
use CGI;

# the following line is *strongly* recommended
use strict; use warnings; use CGI::Carp qw(fatalsToBrowser);

my $cgi = CGI->new();
print $cgi->header();
exec "/usr/bin/script-I-want-to-run", "--switch", "value"; 
```

在 Bash 中，这*可能*有效：

```
#!/bin/sh
echo "Content-type: text/plain"
echo ""
/usr/bin/script-or-whatever --switch value 
```

Perl 的[CGI 模块](http://search.cpan.org/~markstos/CGI.pm-3.63/lib/CGI.pm)甚至可以帮助您获得`$cgi->param`eter 和其他东西，绝对值得推荐。当您询问 Google 时，您会在互联网上找到很多（大部分是糟糕的）关于 Perl CGI 脚本的教程。无论如何都要阅读它们。

# c++ - 在 Mac OS X 中仅使用给定文件路径以编程方式挂载磁盘/卷

> ID：13426063
> 
> 赞同：5
> 
> 时间：2012-11-16T23:45:38.317
> 
> 标签：c++, macos, mount, diskarbitration

我有一个文件路径列表。这些路径可能会导致卸载卷上的文件。在我尝试访问文件之前，如何以编程方式告诉操作系统挂载卷？

我知道这是可能的，因为 iTunes 似乎做到了。例如，如果我开始播放位于 iTunes 中未安装的网络附加卷上的歌曲，该卷会自动为我安装。

如果我尝试在指定路径以编程方式打开文件，操作系统是否应该为我自动安装卷？还是我需要使用磁盘仲裁框架或类似的东西手动安装驱动器？

如果我需要使用磁盘仲裁框架，具体需要做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T11:26:52.063

简短的回答：无需弄乱“磁盘仲裁框架”。Alias Manager 可以为您处理这一切。

Chris Suter 已经非常接近了。有两种解决方案，API 方面：

1.  别名。这些已经存在于 OSX 之前的 MacOS 中，并且是结构化文件，包含多种定位文件或文件夹的方法，即使它已被移动或重命名。它们还包含有关它们所在卷的信息，包括安装信息（如果它位于网络卷上）。如果您只是创建一个文件的别名（使用文件菜单中 Finder 的“制作别名”命令），然后重命名或移动它，或者卸载它的卷，您就可以亲眼看到这些操作。Finder 将尝试恢复卷，必要时甚至会要求您提供登录信息。还有“别名管理器”API，包括功能 FSResolveAliasFileWithMountFlags 这正是您所要求的：它不仅可以让您找到别名的目标，还可以选择磁盘是否可用，如果它'

2.  [CFURL 书签](https://developer.apple.com/library/mac/#documentation/CoreFOundation/Reference/CFURLRef/Reference/reference.html)。这是 Alias API 的现代替代品，仅在 OSX 10.6 之后才存在。CFURL 书签在运行时由系统更好地管理。我不知道它们是否具有与经典 Alias 文件一样的等效磁盘文件表示形式，但也许它们甚至完全相同。

无论如何，我希望这些应该是您需要的所有指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T01:08:04.747

您是否尝试过使用别名？我认为它们现在被称为书签。当您解决它们时，它们可能会导致安装卷。

# ruby-on-rails - Rails Rake 测试 - 密码上的“无法将符号转换为整数”

> ID：13426064
> 
> 赞同：0
> 
> 时间：2012-11-16T23:45:42.337
> 
> 标签：ruby-on-rails, rake, bcrypt, type-conversion

一段时间以来，我一直在使用 rake 测试出错，所以我继续尝试使用固定装置输入数据，但我遇到了类似的错误，我不确定我哪里出错了。

```
[pears:]$ rake db:fixtures:load --trace
** Invoke db:fixtures:load (first_time)
** Invoke environment (first_time)
** Execute environment
** Invoke db:load_config (first_time)
** Execute db:load_config
** Execute db:fixtures:load
rake aborted!
can't convert Symbol into Integer
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/bcrypt-ruby-3.0.1/lib/bcrypt.rb:160:in `[]'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/bcrypt-ruby-3.0.1/lib/bcrypt.rb:160:in `create'
(erb):7:in `<main>'
/Users/jake/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/erb.rb:838:in `eval'
/Users/jake/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/erb.rb:838:in `result'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures/file.rb:51:in `render'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures/file.rb:43:in `rows'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures/file.rb:29:in `each'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:670:in `block (2 levels) in read_fixture_files'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures/file.rb:20:in `open'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:669:in `block in read_fixture_files'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:668:in `each'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:668:in `read_fixture_files'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:548:in `initialize'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:482:in `new'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:482:in `block (2 levels) in create_fixtures'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:479:in `map'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:479:in `block in create_fixtures'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_mysql_adapter.rb:232:in `disable_referential_integrity'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/fixtures.rb:476:in `create_fixtures'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:322:in `block (4 levels) in <top (required)>'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:321:in `each'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/gems/activerecord-3.2.8/lib/active_record/railties/databases.rake:321:in `block (3 levels) in <top (required)>'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/Users/jake/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/bin/rake:19:in `load'
/Users/jake/.rvm/gems/ruby-1.9.3-p286@global/bin/rake:19:in `<main>'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'
/Users/jake/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => db:fixtures:load 
```

我不确定它是否与我的 users.yml 文件有关...

```
# Read about fixtures at http://api.rubyonrails.org/classes/ActiveRecord/Fixtures.html

<% SALT = "NaCl" unless defined?(SALT) %>

one:
  email: jake@test.com
  hashed_password: <%= BCrypt::Password.create('fresh', SALT) %> 
  salt: <%= SALT %>

two:
  email: james@test.com
  hashed_password: <%= BCrypt::Password.create('fresh', SALT) %> 
  salt: <%= SALT %> 
```

不确定从哪里开始寻找解决方案。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:43:10.640

您对 BCrypt 的使用无效...

```
BCrypt::Password.create('fresh', SALT) 
```

文档说：

```
 # @password = BCrypt::Password.create("my secret", :cost => 13)
  def create(secret, options = { :cost => BCrypt::Engine::DEFAULT_COST })
    raise ArgumentError if options[:cost] > 31
    Password.new(BCrypt::Engine.hash_secret(secret, BCrypt::Engine.generate_salt(options[:cost]), options[:cost]))
  end 
```

正确用法：

```
BCrypt::Password.create('fresh', :cost => 15) # any number less than 15 
```

# sql - 在 JSP、while 和 if 循环中使用 SQL 找不到数据

> ID：13426069
> 
> 赞同：1
> 
> 时间：2012-11-16T23:46:15.973
> 
> 标签：sql, database, jsp, aggregate

我已经为此奋斗了好几个小时，就我快到了，我仍然完全没有。此页面通过查询链接以加载在前一页上选择的图片的特定信息记录。

如果我转到图片没有评分的链接，它将加载评分为 0 的页面没有问题。如果我单击我知道它有评分的页面，它会给我一个“找不到数据”异常。

```
if (session.getAttribute("loginOK") != "true") {
    response.sendRedirect("index.jsp");
}

String id = request.getParameter("photoid");
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
Connection cn = DriverManager.getConnection("jdbc:odbc:GalleryDB", "", "");
Statement st = cn.createStatement();
ResultSet r = st.executeQuery("SELECT AVG(rating) AS aRating, FileName, Title, Date, Location, Description FROM Photo LEFT JOIN Rating ON Photo.PhotoID = Rating.PhotoID WHERE Photo.PhotoID = " + id + " GROUP BY Rating.PhotoID, FileName, Title, Date, Location, Description;");

String html = "";
String image = "";

while (r.next()) {
    image += "<img align='right' src='images/" + r.getString("FileName") + "'/>";
    html += "Title: " + (r.getString("Title") + "</br></br>");
    html += "Date: " + (r.getString("Date") + "</br></br>");
    html += "Location: " + (r.getString("Location") + "</br></br>");
    html += "Description: " + (r.getString("Description") + "</br></br>");

    if (r.getString("aRating") != null) {
        html += "Rating: " + (r.getString("aRating"));
    } else {
        html += "0";
    }

}
cn.close(); 
```

任何人都可以就为什么会发生这种情况提供任何建议吗？

# c++ - 查找第 n 个最大数无限循环 C++

> ID：13426074
> 
> 赞同：2
> 
> 时间：2012-11-16T23:46:55.760
> 
> 标签：c++, loops, quicksort

我有一个包含 N 个数字的向量，我想在数组中找到第 n 个数字。我正在使用快速排序的变体，但有时会遇到无限循环的问题，我认为如果最大的数字是两个数组中的唯一选项。一个数字可以在数组中出现多次，例如，如果我为 N 选择 10 并且我想找到第一个最大的数字，我可能会在左侧数组中以 {9,9} 结束，从而导致无限循环。我能做些什么来解决这个问题？这是我的代码。

```
#include <iostream>
#include <time.h>
#include <stdlib.h>
#include <vector>

using namespace std;
int partition(int n, int arrsize, vector<int> intarr); //pass vector by val

int main() {

    int n, N;

    cout << "Please enter n: " << endl;
    cin >> n;
    cout << "Please enter N: " << endl;
    cin >> N;

    vector<int> array;
    srand(time(NULL));

    for(i=0; i < N; i++) {
        array.push_back(1 + rand() % N);
        cout << array.at(i) << ", ";
    }

    //Get the nth largest value of array[N]
    int arraylen = array.size();
    cout << "\nArraylen is " <<  arraylen << endl;
    int result = partition(n, arraylen, array);

    cout << "The " << n << "th largest number is: " << result <<endl;

    return 0;
}

int partition(int n, int arrsize, vector<int> intarr) {
    //1\. Get a random value from the array:
        int random = rand() % arrsize;
        int pivot = intarr.at(random);

    //2\. Partition the array into 2 halves left < pivot > right
        vector<int> left;
        vector<int> right;

        for(int j=0; j < arrsize; j++) {
            if (intarr[j] >= pivot)
                left.push_back(intarr[j]);
            else if (intarr.at(j) < pivot)
                right.push_back(intarr[j]);
            else continue;
        }

        cout << "\n \n" << "Left = ";

        for(int k = 0; k < left.size(); k++) {
            cout << left.at(k) << ", ";
        }

        cout << endl << "Right = ";

        for(int k = 0; k < right.size(); k++) {
            cout << right.at(k) << ", ";
        }

        int leftlen = left.size();
        int rightlen = right.size();

        if (n < leftlen)
            return partition(n, leftlen, left);

        else if (n > (arrsize - rightlen)) {
            n = n - (leftlen);
            return partition(n, rightlen, right);
        }

        else return pivot;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:35:33.593

由于无论如何您都在创建新向量（我想是因为您不想改变输入向量），因此您最好避免将枢轴元素放入左侧或右侧。在这种情况下，如果枢轴是您要查找的`else return pivot`元素，它将被或正确，并且将正确返回分区的单个值。

快速排序避免这个问题的方法是永远不要将枢轴元素放入正在排序的子向量中；因此，即使其中一个向量最终都是相同的元素，它仍然会比原来更短。这是快速排序的一个微妙之处，很少得到很好的解释，尽管 Sedgwick 确实讨论了提高快速排序在具有许多重复元素的向量上的性能的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:08:27.653

检查任一子数组是否为空将有助于检测无限循环，以及在某些其他情况下的崩溃。

```
int leftlen = left.size();
int rightlen = right.size();
if (leftlen == 0 || rightlen == 0) /* break processing */ 
```

**编辑**只有当其中一个数组为 0 并且另一个数组填充相同的值时，才可能出现无限循环。

# php - db-> mysqli php 中的查询崩溃

> ID：13426076
> 
> 赞同：0
> 
> 时间：2012-11-16T23:47:08.207
> 
> 标签：php, mysql, recursion, mysqli

这个函数应该`false`在失败时返回，但在我的例子中它没有返回任何东西，而是崩溃了。

```
echo "This gets printed" ;
$x =  $db->query( "SELECT * FROM something WHERE id=123 AND name='abc'" );
echo "This does not get printed"; 
```

现在，如果我回显实际的查询字符串，从命令行将其复制粘贴到 mysql 中，这是一个有效的查询。我唯一能想到的是，它可能与它是一个递归查询有关，`$db->query`连续调用两次可能是无效的。这或多或少是我的流程：

```
function recursiveQuery ( $result )
{
   $temp = array ();

   while ( $row = $result->fetch_assoc() )
   {
      $temp [ 'name' ] = $row [ 'name' ];
      $id = $row [ 'id' ];
      $temp [ 'sub' ] = recursiveQuery ( $db->query( "SELECT * FROM something WHERE parent_id=$id" ));
   }

   return $temp;
}

recursiveQuery ( $db->query( "SELECT * FROM something WHERE parent_id=0" )); 
```

这无效吗？我应该如何重组它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:00:01.703

哇，我真是个傻瓜。事实证明，问题在于范围，即`$db`无法从递归查询内部访问

# emacs - Emacs 如何将关闭按钮添加到 LaTeX 模式工具栏

> ID：13426084
> 
> 赞同：2
> 
> 时间：2012-11-16T23:47:51.627
> 
> 标签：emacs, toolbar

标准工具栏有关闭按钮：

![在此处输入图像描述](../Images/23cebcf75a8023088b8061bff61c51cf.png)

虽然 LaTeX 模式工具栏没有它：

![在此处输入图像描述](../Images/802e020e0f76e1e5137dc0c99df2ef5f.png)

如何将其添加到 LaTeX 模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T03:21:35.757

您可以自定义`TeX-bar-TeX-buttons`.

# applescript - 在 Applescript 中打开带有变量的文件夹

> ID：13426087
> 
> 赞同：2
> 
> 时间：2012-11-16T23:48:23.687
> 
> 标签：applescript

我正在尝试根据我每天从我的网站下载的文件创建一个脚本来为我运行一个函数。

基本上，我的网站会根据日期（yyyy、mm、dd）创建一个文件夹。我希望applescript首先打开该文件夹，然后对里面的每个文件夹/文件运行该操作。

麻烦的是，当我尝试使用变量将脚本指向该文件夹时，它给了我错误：无法将路径名变为常量。

也许真正的问题是我对此有多陌生！这是我尝试过的：

```
 tell application "Finder"
    set {year:y, month:m, day:d} to (current date)
    set theTime to y & m & d
    set pathToTarget to path to theTime
    open folder pathToTarget of folder "F-grams" of folder "files" of folder "default" of folder "sites" of folder "foldagram" of folder "htdocs" of folder "MAMP" of folder "Applications" of startup disk
end tell 
```

谁想帮助新手走上正轨？-JB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:33:11.950

每次将新项目添加到目标文件夹时，都会触发此文件夹操作。第二个重复块将允许您为每个添加的文件夹中的每个项目发送命令。您可以使用 anItem 变量引用这些项目中的每一项。将脚本保存在库中的 Folder Action Scripts 文件夹中。请务必将文件夹操作附加到目标文件夹。

```
on adding folder items to theFolder after receiving theFolders
    try
        repeat with aFolder in theFolders
            tell application "Finder" to set myItems to every item of aFolder
            repeat with anItem in myItems
                -- Insert your code here
            end repeat
        end repeat
    on error errMsg number errNum
        tell me
            activate
            display alert errMsg & return & return & "Error number" & errNum buttons "Cancel"
        end tell
    end try
end adding folder items to 
```

但是，如果您想按日期搜索文件夹，则应采用以下方式格式化日期字符串：

```
set delimiter to ", "
set aDate to (current date)
set aYear to (year of aDate) as string
set aMonth to (month of aDate as integer) as string
if length of aMonth is 1 then set aMonth to "0" & aMonth
set aDay to (day of aDate as integer) as string
if length of aDay is 1 then set aDay to "0" & aDay
set theTime to aYear & delimiter & aMonth & delimiter & aDay as string 
```

# c# - jQuery 在点击页面刷新之前不起作用

> ID：13426092
> 
> 赞同：0
> 
> 时间：2012-11-16T23:49:16.793
> 
> 标签：c#, jquery, asp.net-mvc

我有一个使用 C# 的 MVC Web 应用程序。一切正常，直到我执行“保存”操作。这个动作

从页面读取数据

IE

```
 x = $("#mytextbox").val(); 
```

x 始终是页面加载时填充的初始值。它不会在页面加载后返回用户键入的值。我还注意到这个 SAVE 函数中的 jquery 确实执行了 jQuery 显示/隐藏 ex：

```
 $("#messagebox").show(); -- to show the user the feedback for the save action. 
```

现在。如果我按 F5 或刷新页面。以上所有工作正常。

会不会是我添加到 div 的 html 元素不在 DOM 中？

这段代码在我的 .ascx 中（部分视图）

```
<script language="javascript" type="text/javascript">

    $("#save-button").button(); -- Works
    $("#status-button").button(); -- Works
    $("#DateField").datepicker(); --Works
    alert($("#DebugtextBox").val()); --Works

    $("#DebugtextBox").val("test"); -- Works but does not update the val in the html page
    alert($("#DebugtextBox").val()); -- Works and shows "TESTS" in the alert. But the field in html page still shows the original val. 
```

// 更多信息在上面一行.. this

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:49:38.417

问题是有多个具有相同 ID 的文本框。

# javascript - 单击时如何使用Javascript（不是jQuery）获取元素的属性（例如，标题）？

> ID：13426093
> 
> 赞同：1
> 
> 时间：2012-11-16T23:49:20.943
> 
> 标签：javascript

我正在探索书中的一些示例代码。该代码有一组像这样的缩略图：

```
<div id="thumbnailPane">
  <img src="images/itemGuitar.jpg" alt="guitar" width="301" height="105" 
       title="itemGuitar" id="itemGuitar" />
  <img src="images/itemShades.jpg" alt="sunglasses" width="301" height="88" 
       title="itemShades" id="itemShades" />
  <img src="images/itemCowbell.jpg" alt="cowbell" width="301" height="126" 
       title="itemCowbell" id="itemCowbell" />
  <img src="images/itemHat.jpg" alt="hat" width="300" height="152" 
       title="itemHat" id="itemHat" />
</div> 
```

单击缩略图时，使用此功能会显示更大的图像：

```
function initPage() {
  // find the thumbnails on the page
  thumbs = document.getElementById("thumbnailPane").getElementsByTagName("img");
  // set the handler for each image
  for (var i = 1; i < thumbs.length; i++) {//CHANGED FROM 0 TO 1
    image = thumbs[i];

    // create the onclick function
    image.onclick = function() {
      // find the image name
      detailURL = 'images/' + this.title + '-detail.jpg';
      document.getElementById("itemDetail").src = detailURL;
      getDetails(this.title);
    }
  }
} 
```

我明白这是如何工作的。我想知道的是是否可以使用单个硬编码函数来复制它。基本上我想要的是在单击缩略图时使用一个通用函数来获取缩略图的标题，该函数将使用`onclick`事件处理程序 ( `onclick="getImage()"`) 调用所有缩略图。

如何获取刚刚单击的元素的`title`或？`id`

我不使用 jQuery，所以我需要一个 JS 答案。

编辑：

我试图写一个`getImage()`这样的函数：

```
function getImage(){
  var title = this.title;
  detailURL='images/' + title + '-detail.jpg';
  document.getElementById("itemDetail").src = detailURL;
} 
```

这行不通。的`var title`值为`"undefined"`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:53:19.980

您将元素传递给处理程序，并定义一个参数`getImage`。

```
onclick="getImage(this)" 
```

* * *

或者更好的是，你`.call`有处理程序，所以你仍然可以使用`this`in `getImage`。

```
onclick="getImage.call(this)" 
```

* * *

但总的来说，您不需要内联处理程序来重用函数。只需创建一个命名函数，并在您的 JavaScript 代码中分配它。它会起作用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T23:51:21.700

事件处理程序的使用：

```
function clickHandler(){
    var title = this.title;
    ...
}

//assign handler to element
image.addEventListener('click',clickHandler); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T00:14:54.257

`i`我看不到循环中定义的函数的依赖关系在哪里`image`，那么为什么不把它移出循环，让它们共享同一个呢？这是我如何编写你的函数

```
function initPage() {
    // remember to use var so you're not defining in the global scope
    var thumbs = document.getElementById('thumbnailPane').getElementsByTagName('img'),
        i = thumbs.length,
        getImage = function getImage() { // onclick function
            // again remember var
            var title = this.title,
                detailURL = 'images/' + title + '-detail.jpg';
            document.getElementById('itemDetail').src = detailURL;
            getDetails( title );
        };
    // Attach to each thumb
    while( i-- ) thumbs[i].addEventListener('click', getImage, false);
} 
```

* * *

编辑
**Q**。为什么您尝试使用的功能不起作用`this.title`？
**一个**。这是因为`this`根据您调用函数或使用它的对象的方式，这意味着不同的东西。直接调用你的函数`getImage()`将设置`this`为`window`（或调用者和`window.title === undefined`），而不是你的`<img>`. 您必须使图像`getImage`自身调用（添加为侦听器）或使用or`getImage.call`作为第一个参数。`getImage.apply``<img>`

# iphone - transitionFromViewController 只是 iOS 中的一种便捷方法吗？

> ID：13426094
> 
> 赞同：9
> 
> 时间：2012-11-16T23:49:48.627
> 
> 标签：iphone, ios, ios5, uiviewcontroller

我不确定我到底明白了什么[`transitionFromViewController:toViewController:duration:options:animation:completion:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/transitionFromViewController%3atoViewController%3aduration%3aoptions%3aanimations%3acompletion%3a)。它只是一种方便的方法吗？

例如，这样做有什么区别......

```
[self transitionFromViewController:fromViewController
                  toViewController:toViewController
                          duration:0.25
                           options:UIViewAnimationOptionCurveEaseInOut
                        animations:^{
                            fromViewController.view.alpha = 0;
                            toViewController.view.alpha = 1;
                        } completion:^(BOOL finished) {
                            [fromViewController removeFromParentViewController];
                            [toViewController didMoveToParentViewController:self];
                        }]; 
```

...还有这个？

```
[self.view addSubview:toViewController.view];
[UIView animateWithDuration:0.25
                      delay:0
                    options:UIViewAnimationOptionCurveEaseOut
                 animations:^{
                     fromViewController.view.alpha = 0;
                     toViewController.view.alpha = 1;
                 } completion:^(BOOL finished){
                     [fromViewController.view removeFromSuperview];
                     [fromViewController removeFromParentViewController];
                     [toViewController didMoveToParentViewController:self];
                 }]; 
```

我问的原因是在某些情况下我需要将子控制器视图添加到容器控制器视图的特定子视图中。使用`transitionFromViewController:toViewController:duration:options:animation:completion:`没有给我这个选项。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-17T03:06:21.647

是的，我认为您是对的：它们在功能上似乎是相同的（不确定我们是否可以在不知道实现细节的情况下将其称为便利方法，但很可能是这样）。显然，`transitionFromViewController`它是为包含视图控制器而`animateWithDuration`设计的，并且是为视图的通用动画而设计的。

鉴于您显然在进行遏制，因此可能应该使用`transitionFromViewController`而不是`animateWithDuration`. 这是明确的，也是[Apple 推荐](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW12)的技术。如果您`fromViewController.view`在子视图中有 ，新的`toViewController.view`将被添加到同一个子视图中。

我还建议包括缺少的`willMoveToParentViewController`and `addChildViewController`（为了简洁起见，我假设你省略了，但为了完整起见，我包括在内）：

```
[fromViewController willMoveToParentViewController:nil];
[self addChildViewController:toViewController];

[self transitionFromViewController:fromViewController
                  toViewController:toViewController
                          duration:0.25
                           options:UIViewAnimationOptionCurveEaseInOut | UIViewAnimationOptionTransitionCrossDissolve
                        animations:^{}
                        completion:^(BOOL finished){
                            [fromViewController removeFromParentViewController];
                            [toViewController didMoveToParentViewController:self];
                        }]; 
```

另请注意，我正在使用`UIViewAnimationOptionTransitionCrossDissolve`. 如果您手动设置 alphas，请不要忘记初始化`toViewController.view.alpha`，例如：

```
[fromViewController willMoveToParentViewController:nil];
[self addChildViewController:toViewController];
toViewController.view.alpha = 0.0;

[self transitionFromViewController:fromViewController
                  toViewController:toViewController
                          duration:0.25
                           options:UIViewAnimationOptionCurveEaseInOut
                        animations:{
                            fromViewController.view.alpha = 0.0;
                            toViewController.view.alpha = 1.0;
                        }
                        completion:^(BOOL finished){
                            [fromViewController removeFromParentViewController];
                            [toViewController didMoveToParentViewController:self];
                        }]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-14T12:26:40.497

**简短回答**：
不，这不仅仅是一种方便的方法，因为在两个子控制器上调用外观方法的时间不同。

**长答案**：
关于-->

```
[self.view addSubview:toViewController.view];
[UIView animateWithDuration:0.25
                      delay:0
                    options:UIViewAnimationOptionCurveEaseOut
                 animations:^{
                     fromViewController.view.alpha = 0;
                     toViewController.view.alpha = 1;
                 } completion:^(BOOL finished){
                     [fromViewController.view removeFromSuperview];
                     [fromViewController removeFromParentViewController];
                     [toViewController didMoveToParentViewController:self];
                 }]; 
```

当你打电话时，幕后会发生什么

```
[self.view addSubview:toViewController.view]; 
```

是这样的（当然这不完整）

```
[toViewController.view viewWillAppear:false]; <-- meaning not animated
//Add the view to the view hierarchy
//Layout the view
[toViewController.view viewDidAppear:false]; <-- meaning not animated 
```

之后，当您执行动画时 toViewController “认为”它的视图已经可见并且没有动画呈现。fromViewController 也是如此。在动画期间，fromViewController 不知道它的视图被解除，因为 viewWill/DidDisappear 将在动画之后调用

```
[fromViewController.view removeFromSuperview]; 
```

另一方面——>

```
[self transitionFromViewController:fromViewController
              toViewController:toViewController
                      duration:0.25
                       options:UIViewAnimationOptionCurveEaseInOut | UIViewAnimationOptionTransitionCrossDissolve
                    animations:^{}
                    completion:^(BOOL finished){
                        [fromViewController removeFromParentViewController];
                        [toViewController didMoveToParentViewController:self];
                    }]; 
```

做这样的事情

```
[UIView animateWithDuration:yourDuration
                      delay:yourDelay
                    options:yourOptions
                 animations:^{
                     [toViewController viewWillAppear:true];
                     [fromViewController viewWillDisappear:true];
                     //Add toViewcontroller.view to the view hierarchy
                     //Layout the toViewcontroller.view --> changes here are not animated. (There is no "previous state" as the view has just been added to the hierarchy)
                     //Call your animation-block
                 } completion:^(BOOL finished){
                     [toViewController viewDidAppear:true];
                     [fromViewController.view removeFromSuperview];
                     [fromViewController viewDidDisappear:true];
                     //Call your completion-block
                 }]; 
```

**这么长的回答简短**：
viewWillAppear 和 viewWillDisappear 在动画块内被调用并被传递为真。这对您的应用程序可能有用也可能没有用，因此这两种方法之间可能存在差异，也可能没有差异。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T23:53:33.887

正如文档所说，它旨在用于两个子视图控制器之间的转换，而不是同一个子视图控制器的两个视图。

在您的第一个代码片段中，您传递的`toViewController`参数与前两个参数相同。这是两个不同的视图控制器，而不是同一个。

如果您只是切换同一视图控制器的视图，则您的第二个示例更合适。

# c# - Linq 中的相关子查询

> ID：13426097
> 
> 赞同：5
> 
> 时间：2012-11-16T23:50:04.393
> 
> 标签：c#, entity-framework, linq, correlated-subquery

我有一张员工桌子和`EmployeeCourseStatus`桌子。

我想显示每个员工的列表以及完成的课程数（`status = "CMP"`）。

我有以下相关子查询，导致以下错误：

```
var query = (from emp in Employee
                     join adr in EmployeeAddress on emp.id = adr.EmployeeID
                     select new
                     {
                        id = emp.id,
                        name=emp.name,
                        country=adr.country,
                        CompletedCourseCount = (from c in employeeCourseStatus where c.empid = emp.id && c.status == "CMP" select c.id).count()
                     } 
```

错误：

> 仅支持 Premitive 类型。

等效的 SQL 子查询将是 -

```
Select emp.id
       , emp.name
       , adr.Country
       , CompletedCourseCount = (select count(id) from EmployeeCourseStatus where id = emp.id and status = "CMP") 
from   Employee emp
       JOIN employeeaddress adr ON adr.EmployeeID = emp.ID 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-16T23:59:41.727

`equals`加入序列时使用关键字

```
var query = from emp in Employee
            join adr in EmployeeAddress on emp.id equals adr.EmployeeID
            join c in EmployeeCourseStatus on emp.id equals c.empid into courses
            select new
            {
               id = emp.id,
               name = emp.name,
               country = adr.country,
               CompletedCourseCount = courses.Where(x => x.status == "CMP").Count()
            }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:02:50.967

我更喜欢使用 lambda 表达式（为了可读性 - 特别是在 Join 方法中）：

```
Employee.Join(EmployeeAddress, emp => emp.id, adr => adr.EmployeeID, (emp, adr) => new
{
    id = emp.id,
    name = emp.name,
    country = adr.country,
    CompletedCourseCount = employeeCourseStatus.Count(c => c.empid == emp.id && c.status == "CMP")
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T23:59:24.717

请尝试在您的计数查询中替换`where c.empid = emp.id`为。`where c.empid == emp.id`

如果这不起作用，`emp.name`和的类型是`adr.country`什么？

# javascript - 检索已加载页面的 javascript 值

> ID：13426107
> 
> 赞同：0
> 
> 时间：2012-11-16T23:51:35.757
> 
> 标签：javascript, jquery

我有两页，第 1 页和第 2 页。第 1 页使用 jQuery load() 函数加载到第 2 页。第 1 页包含一个 javascript 值`js_value`，该值在第 1 页加载到第 2 页后在第 1 页中动态创建。我需要`js_value`在第 2 页中检索。

有没有办法做到这一点？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T23:56:20.153

**它应该已经加载**

当使用没有后缀选择器表达式的 URL 调用[.load()](http://api.jquery.com/load/#script-execution)时，内容会在脚本被删除之前传递给 .html()。这会在脚本块被丢弃之前执行它们。但是，如果调用 .load() 时将选择器表达式附加到 URL，则脚本会在 DOM 更新之前被剥离，因此不会执行。

# html - 页面内容 div 和最小高度

> ID：13426109
> 
> 赞同：1
> 
> 时间：2012-11-16T23:51:56.320
> 
> 标签：html, height, css

我的网站目前对所有页面都有这样的总体布局：

```
<?php
include "head.php";
?>
<title></title>
<?php
include "top.php";
?>
<div class="mainbody">
</div>
<?php
include "bottom.php";
?> 
```

head.php 包括 html 和 head 内容（即页面上最顶部的内容），top.php 包括站点徽标和水平导航栏，bottom.php 包括页脚和结束 html/body 标记，而 mainbody 类包含特定页面的内容。

现在我的问题在一个特定的页面上。在每个页面上，都有足够的内容使页面足够大以至于它需要可滚动，并且主体 div 会扩展以适应它。我的一个页面的问题是内容太少，或者更确切地说，大部分内容都是浮动的，所以 div 没有像往常一样展开。我以为我可以通过向 CSS 添加最小高度来修复它，但这不起作用。CSS 目前看起来像这样：

```
.mainbody {
background-image: url("Images/Background.png");
border-radius: 5px;
-moz-border-radius: 5px;
padding: 0.7%;
position: relative;
width: 68%;
min-height: 80%;
min-width: 768px;
margin: 0px auto;
} 
```

除最小高度外，每一行都有效。我无法让它工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T04:09:03.640

将 min-height 的值以像素为单位

```
min-height: 400px; 
```

这是一个向您展示的小提琴

[**小提琴**](http://jsfiddle.net/videsignz/2pEwa/)

**添加**

要执行此纯 css，您需要像这样向 body 添加一些 css

```
 body {position:absolute; height:100%; width:100%; overflow:visible; }
 #content { background-color:#cccccc; min-height:80%; } 
```

[**小提琴**](http://jsfiddle.net/videsignz/2pEwa/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T04:20:52.130

你清理过花车吗？你说内容是浮动的，导致主体div没有展开。

您还可以使用粘性页脚技术，例如[这个](http://www.mindfly.com/blog/2012/08/09/the-css-sticky-footer-fix/)。网络上几乎没有粘性页脚片段，只需选择最适合您的。:)

# sudo - (Linux/General) concering /bin/rocks

> ID：13426114
> 
> 赞同：0
> 
> 时间：2012-11-16T23:52:22.643
> 
> 标签：sudo, ln

So I am trying to install a software not "supported" by my linux distro (Ubuntu)

I have it under control, but I am curious about some coding I was told to use.

```
 sudo ln -s /bin/true /bin/rocks
 sudo ./setup.sh 
```

This was suggested after I received this error:

```
Error: Could not execute command: type rocks 2>&1 
```

Question: What does the rocks directory do?

Question Part 2: Can someone explain to me the link I made using 'ln -s?'

I looked at the --help... but I think hearing it a different way would help me.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:01:04.067

That seems like a funny thing to do, but basically is just making a [soft link](http://linux.die.net/man/1/ln) to the `true` command. In other words it is making it so the `rocks` command always returns successfully. The problem is that if `rocks` is important to your install, then this is will just make things harder to actually get working.

# reporting-services - SSRS：如何仅在某些分组工作表上隐藏列

> ID：13426115
> 
> 赞同：1
> 
> 时间：2012-11-16T23:52:30.957
> 
> 标签：reporting-services, hide

我有一份报告，报告了参加活动的人。每行代表一个参加者记录，报告输出被分块到单独的电子表格中，以便每个电子表格按 BusinessEntity 和 EventType 代表活动参加者。这是通过具有以下分组的单个组来实现的：在 BusinessEntityName 上进行组，然后在 EventTypeCode 上进行组并且在组的每个实例之间都有一个分页符。

这意味着对于 BusinessEntity 和 EventType 的每个组合，都有一个电子表格，每个电子表格包含 0+ 行活动参与者。在我的特定场景中，我可能有这样的电子表格：

*   #1 - BusinessEntity ABC，EventType 简报
*   #2 - BusinessEntity XYZ，EventType Briefing
*   #3 - BusinessEntity ABC，EventType 研讨会
*   #4 - BusinessEntity XYZ，EventType Workshop

（我的报告针对一个存储过程运行，该过程提取了大部分连接的数据，因此报告本身几乎没有进行数据操作。）

对于每一行，都有一个名为 TechnicalCenter 的字段，该字段可能为 NULL，也可能不为 NULL。一个事件可能与技术中心相关联，如果是，我想显示该信息。继续我上面的示例，数据可能如下所示：

*   #1 有 10 名与会者参加 2 次会议，其中为每个活动分配了一个技术中心
*   #2 有 5 名与会者参加 1 次会议，其中没有为该活动分配技术中心

因此，如果电子表格#A2 没有包含 TechnicalCenter 的行，那么我想隐藏该电子表格上的 Technical Center 列。

我想这是一个很长的例子，如果我在该组中显示的特定集中没有数据，我可以隐藏一列吗？我知道我可以通过使用 NOROWS 或 IF(COUNT) 有条件地隐藏一列，但我不确定如何在单个组/电子表格上的一组有限数据中做到这一点。我也知道如何根据参数选择隐藏数据，但这是不同的。

我希望我说得通。在此先感谢，请提出问题，以便我可以填补我确定我已经离开的空白。

~~~~~~~~~~~~~~

好的，感谢使用`Scope`with的指针`Count`。我可以看到这将如何工作，但还没有完全实现。当我用这个表达式运行报告时

`=Count(Fields!Center.Value, "BusinessEntityName")` 在详细信息行中，显示了包含技术中心的详细信息行数的正确计数值。（其中 Center.Value 是技术中心的名称，而 BusinessEntityName 实际上是我的行组的名称，该行组同时按 BusinessEntity 和 EventType 进行分组。）

这让我很高兴。

然后我尝试应用相同的逻辑来隐藏我的列。我根据此表达式将列可见性设置为显示/隐藏：

`=IIF(Count(Fields!Center.Value, "BusinessEntityName")=0, "True", "False")`

当我尝试预览报告时，出现错误：tablix '' 的隐藏表达式具有对聚合函数无效的范围参数。范围参数必须设置为字符串常量，该常量等于包含组的名称、包含数据区域的名称或数据集的名称。

我无法理解该错误，因为我认为我使用的是包含组的名称 BusinessEntityName。有人可以帮我解释一下我显然缺少的逻辑吗？

~~~~~~~~~~~~~~~~~~~

[http://msdn.microsoft.com/en-us/library/ms159673(v=sql.100).aspx](http://msdn.microsoft.com/en-us/library/ms159673(v=sql.100).aspx)

我正在尝试了解有关范围的更多信息，我认为问题在于“您必须使用默认范围或指定包含顺序中更高的范围”。所以，我试图应用一个比我应用它的数据（数据区域，我认为）更低的包含顺序（行组）的范围。

我可以使用此表达式有条件地隐藏要隐藏的列中的单元格： `=IIF(CountDistinct(Fields!Center.Value, "BusinessEntityName") < 1, True, False)`

但是，如果我尝试将相同的表达式应用于列可见性，则会收到范围参数错误。所以我对自己说，我该如何解决这个收容令问题？

我试图将范围更改为数据集名称 (EventMemberAttendance)。列可见性基于以下表达式：

`=IIF(CountDistinct(Fields!Center.Value, "EventMemberAttendance") < 1, True, False)`

当我运行报表预览时，我不再收到错误消息，并且如果整个数据集的 Center 值为 null，则该列实际上是隐藏的。但是，如果整个数据集中至少有一个 Center 值，则该列在每个工作表上都可见，而不仅仅是存在 Center 数据的工作表。我还尝试将范围更改为 tablix 本身，结果与刚才描述的相似。

如何指定范围应该是单个选项卡的输出，该选项卡是与分页符组合的组的结果？我如何绕过这个要求：“当内置函数声明您必须指定当前范围或包含范围时，您不能指定比当前范围更低或在包含顺序上相同级别的范围。”

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T20:52:48.483

因为这个问题一开始很复杂，并且在底部添加了更复杂的注释，所以我考虑这个问题是关于如何编写 VB 表达式来确定给定结果组中是否存在值。关于 Scope 的注释非常有帮助，并引导我学习如何编写：`=Count(Fields!Center.Value, "GroupName")`

因此，我认为这个问题得到了回答。

我打开了一个新案例，其中有一个更清楚的条件可见性问题示例，这是我问题的根源： [根据显示在单个选项卡表上的组的值有条件地隐藏列](https://stackoverflow.com/questions/13752218/hide-a-column-conditionally-based-on-the-values-of-a-group-that-display-on-a-sin)

# php - 在滑块图像上溢出隐藏边框

> ID：13426118
> 
> 赞同：0
> 
> 时间：2012-11-16T23:52:44.833
> 
> 标签：php, javascript, jquery, html, css

这是我要修改的滑块： [http ://webkunst.comeze.com/](http://webkunst.comeze.com/)

这是我想要实现的边界溢出： ![在此处输入图像描述](../Images/5a19d89ecb1deba1aef0457b5c7676e9.png)

问题是我已经尝试了一切来使图像与容器溢出一起工作：隐藏但这是不可能的，我尝试了所有容器 div 的相对位置等等。

有人可以帮我吗？透明边框不是必须的，但最重要的是使用边框进行溢出隐藏工作。

这是标记：

```
<div id="home_slider">
    <ul id="slides">
        <li class="home_slide"><img src="images/slide1.jpg" alt=""></li>
        <li class="home_slide"><img src="images/slide2.jpg" alt=""></li>
        <li class="home_slide"><img src="images/slide3.jpg" alt=""></li>
        <li class="home_slide"><img src="images/slide4.jpg" alt=""></li>
    </ul>
</div> 
```

和 CSS：

```
 #home_slider {
      margin: 0 auto;
      width: 880px;
      height: 416px;
      position: relative;
      z-index: 5;
      overflow: hidden;
    }
    #home_slider ul#slides {
      list-style: none;
      position: relative;
      overflow: hidden;
      border-radius: 20px;
    }
    #home_slider ul#slides li {
      margin: 0;
      width: 900px;
      height: 416px;
    }
    .home_box {
      margin-top: 30px;
      float: right;
    }
    .home_box .home_image {
      float: left;
      border: 3px solid #6f6f6f;
      -webkit-border-radius: 20px;
      -moz-border-radius: 20px;
      border-radius: 20px;
      overflow: hidden;
      margin-left: 13px;
    } 
```

我从本教程中得到了滑块：http: [//line25.com/tutorials/build-a-simple-image-slideshow-with-jquery-cycle](http://line25.com/tutorials/build-a-simple-image-slideshow-with-jquery-cycle)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:01:19.387

您只需要将 应用于`border-radius`div`#home_slider`而不是`#home_slider ul#slides`. 对于透明边框，您可以使用 rgba，您还需要将其应用于`#home_slider`：

```
#home_slider {
    margin: 0 auto;
    width: 880px;
    height: 416px;
    position: relative;
    z-index: 5;
    overflow: hidden;
    border-radius: 20px; /* add this */
    border: 15px solid rgba(255, 255, 255, 0.5); /* add something like this for the transparent border */
} 
```

**编辑：**`border-radius`当元素不是时，Chrome 似乎无法将内容剪辑到 a中`position:static`。但是，如果您可以在没有透明边框的情况下生活，那么您可以将其添加到上面的相同规则中以获得圆角，但您必须删除边框：

```
-webkit-mask-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC); 
```

# deployment - How do I push a mobile app to a phone?

> ID：13426123
> 
> 赞同：0
> 
> 时间：2012-11-16T23:53:32.780
> 
> 标签：deployment

When I find a mobile app I like (for my Android phone), it seems like the standard way of installing it is to send me to the Google store (if I find the app on, say, its creator's web page). From there, I click "Install" and the app is then sent to my phone. I'm already logged in to Google at that point, so that part is transparent. Nothing is required after clicking "Install." The app then shows up on my phone. I have two questions.

First, is there a standard way that I can have that same Install button on my own web site and bypass the Google store?

Second, does everything I've said so far also apply to the iPhone and the Windows Phone, and does the answer to my first question also apply to those two systems?

Thanks, Jay

# jquery - Uncaught ReferenceError: $ is not defined while bootstrap 工作正常

> ID：13426125
> 
> 赞同：0
> 
> 时间：2012-11-16T23:53:47.987
> 
> 标签：jquery

嗨，我可能在这里遗漏了一些非常愚蠢的东西，但是为什么 Twitter Bootstrap 可以正常工作，但是我的代码却出现了这个错误，就好像它找不到 jQuery 库一样？

谢谢

![在此处输入图像描述](../Images/b4733726e2bf70cc5be080e343492878.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T23:57:13.607

你有一个错字 - 你的脚本元素说`scr="..."`而不是`src="..."`.

不正确的属性将被忽略，因此您会留下一个（空白）内联脚本，并且不会加载 jQuery。

# java - Guava EventBus：监听事件超类型（如 EventObject 或 Object）是什么意思？

> ID：13426126
> 
> 赞同：3
> 
> 时间：2012-11-16T23:53:58.210
> 
> 标签：java, guava

在[Google Guava EventBusExplained](http://code.google.com/p/guava-libraries/wiki/EventBusExplained)页面中，当他们说以下内容时，我不明白：

> 侦听一个常见的事件超类型（例如 EventObject 或 Object）...
> ...在传统的 Java 事件中：不容易。
> ...使用 EventBus：事件会自动分派给任何超类型的侦听器，允许接口类型的侦听器或 Object 的“通配符侦听器”。

1.  监听一个常见的事件超类型是什么意思？
2.  当他们提到 EventObject 时，他们是在谈论 java.util.EventObject 吗？
3.  允许“接口类型的侦听器或对象的“通配符侦听器”是什么意思？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T00:23:36.850

这与 Guava 的`EventBus`类可以克服的方法重载和接口的限制有关。

对于接口，请考虑以下场景：

我有为多种形式的输入调用的相同代码。例如，一个监听器监听鼠标事件、按键事件和焦点事件，但所有方法都做同样的事情：重绘源。这意味着我的代码将如下所示：

```
public class BunchOfListeners implements MouseListener, KeyListener, FocusListener {

    @Override
    public void focusGained(FocusEvent e) {
        doSomething(e);
    }

    @Override
    public void focusLost(FocusEvent e) {
        doSomething(e);
    }

    @Override
    public void keyTyped(KeyEvent e) {
        doSomething(e);
    }

    @Override
    public void keyPressed(KeyEvent e) {
        doSomething(e);
    }

    @Override
    public void keyReleased(KeyEvent e) {
        doSomething(e);
    }

    @Override
    public void mouseClicked(MouseEvent e) {
        doSomething(e);
    }

    @Override
    public void mousePressed(MouseEvent e) {
        doSomething(e);
    }

    @Override
    public void mouseReleased(MouseEvent e) {
        doSomething(e);
    }

    @Override
    public void mouseEntered(MouseEvent e) {
        doSomething(e);
    }

    @Override
    public void mouseExited(MouseEvent e) {
        doSomething(e);
    }

    public void doSomething(EventObject e) {
        ((Component) e.getSource()).repaint();
    }
} 
```

注意到这有多丑吗？为此有 10 种不同的方法，最终我们唯一关心的是从事件中获取源（由 指定`EventObject`，顺便说一句，这就是他们在示例中使用它的原因）并调用`repaint`它。

使用 Guava's `EventBus`，这变得超级、超级简单。我在课堂上只需要一种方法：~~`GuavaIsAwesome`~~ `ComponentRepainter`

```
public class ComponentRepainter {

    @Subscribe
    public void doSomething(EventObject e) {
        ((Component) e.getSource()).repaint();
    }
} 
```

当你用一个`EventBus`和后来的火灾注册这个时，比如说，一个`MouseEvent`它：

```
EventBus eventBus = ... ;
eventBus.register(new ComponentRepainter()); 
```

然后：

```
MouseEvent e = ... ;
eventBus.post(e); 
```

这将调用该`doSomething`方法，`ComponentRepainter`因为它不仅会将事件触发到`@Subscribe`具有`MouseEvent`参数的方法，而且还会触发具有可从*分配*`MouseEvent`的参数的任何方法。换句话说，因为`MouseEvent`extends `EventObject`，番石榴`EventBus`会将它传递给任何接受的东西`EventObject`。如果我们`doSomething`接受了`Object`，那么我们可以获取发布到的*每个*`EventBus`事件，使其成为一种全局侦听器（因为Java 中的*所有内容都*`Object`扩展了）。

同样的事情也适用于接口。如果您将具体实现传递给`EventBus`某个接口，则将`@Subscribe`调用使用该接口（与具体类型相反）的方法。它更加灵活，并且克服了“10 无用方法”的方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T00:08:06.373

假设您有两个事件源：一个是触发类型的事件`FooEvent`，一个是触发类型的事件`BarEvent`。假设`FooEvent`并`BarEvent`扩展一个公共超类（或实现一个公共接口）`MyEvent`。

使用 EventBus，您可以监听 type 的事件`MyEvent`，并且您会收到`FooEvent`s 和`BarEvent`s 的通知，因为它们都扩展了这个公共超类型`MyEvent`。

如果您侦听 类型的事件`java.lang.Object`，那么您将收到每个事件的通知，因为 Java 中的每个类都扩展了 Object。那将是一个通配符监听器：它监听所有内容。

# ruby-on-rails - Using link_to to Call a Custom Controller Filter Method, and Refresh View with Filtered Results

> ID：13426127
> 
> 赞同：0
> 
> 时间：2012-11-16T23:53:59.067
> 
> 标签：ruby-on-rails

I'm still on the learning curve with rails, and seem to have backed myself into a corner.

Scenario:

*   There is an Array containing people details (id, first_name, last_name), and the Array contents are displayed in a View (formatted as a table).

*   There is a method in the Controller for that View which applies a filter to the array - limiting its output.

## Controller

```
#person_controller.rb

require 'module_file'

class PersonController < ApplicationController
  include ModuleFile
  helper_method :build_list

  def index
  end

  def filter_person
    @filter_criteria = lambda { |person| person.id.nil? }
    redirect_to persons_path
  end
end 
```

## View

```
#index.html.erb

<%= link_to "Filter Report", :controller => :person, :action => :filter_person %>

<table>
  <% ModuleFile.build_list.individuals.find_all(&@filter_criteria).each do |person| %>
    <tr>
      <td><%= person.id %></td>
  <td><%= person.first_name %></td>
  <td><%= person.last_name %></td>
    </tr>
  <% end %>
</table> 
```

## Routes File

```
#/config/routes.rb
MyApplication::Application.routes.draw do

  resources :persons do
    collection do
      get :filter_person
    end
  end

end 
```

I would like to be able to use a hyperlink on a View to trigger the filtering controller method to filter the Array, and then refresh the View with this filter in place. What am I missing?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:06:20.293

我曾经遇到过同样的问题并以这种方式处理它：

```
# my_model_controller
class MyModelController < ApplicationController
  # ...
  def query
    # Bring a json with the queried array of xxx
    render :json => MyModel.find_all {|i| i.attribute == params[:query]}
  end
end 
```

```
//  my_model_script.js
$.get("/persons/query", {
  query: $query // query parameters
}, function(data) {
  console.log("Hey! Here's the queried array of persons: " + data.json + ".");
  // Do something with each person
}); 
```

这是我实现它的示例应用程序：[https](https://github.com/nicooga/Example-Padrino-Blog/blob/master/app/controllers/posts.rb) ://github.com/nicooga/Example-Padrino-Blog/blob/master/app/controllers/posts.rb 。这是一个 Synatra+Padrino 应用程序，但除了不存在`routes.rb`文件之外，它几乎是相同的东西。

**编辑：**如果您不想执行 AJAX，您可以使用 url 参数创建链接，例如：

```
= link_to 'Apply filter', "/MyModel?filter=true"

# MyModel_controller.rb
def method_blah
  apply_filter if params[:filter]
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:34:57.623

这是我最终使用的解决方案：

## 控制器文件

```
# person_controller.rb

require 'module_file'

class PersonController < ApplicationController
  include ModuleFile
  helper_method :build_list

  def index
  end

  def filter_person
    @filter_criteria = lambda { |person| person.id.nil? }
    respond_to do |format|
      format.html {render '_report_detail', :layouts => 'reports', :locals {:@filter_criteria => @filter_criteria } }
    end
  end
end 
```

通过将我的过滤条件作为 lambda 发送到 format.html 渲染选项作为 :locals 引用，它在加载 report_detail 部分时有效地“过滤”渲染的数据。在短期内，我使用前导下划线字符引用部分，以便我可以利用现有布局。将来我很可能会使用 AJAX 进行部分负载。

# c++ - pass matlab matrices to DLL that accepting pointers?

> ID：13426128
> 
> 赞同：0
> 
> 时间：2012-11-16T23:54:03.497
> 
> 标签：c++, matlab, dll, matrix

Are there some good ways to pass large block matlab matrices to DLL functions?

The problem is, we get a compiled DLL file without source code, so creating a mex is not possible, the DLL functions accept pointers as matrices inputs, yet it seems that matlab dont support pointers passing to DLL (if I understand correctly).

Is there some way to work around this, many thanks in advance

# php - Infinite Scroll Loading All Items at Once?

> ID：13426129
> 
> 赞同：2
> 
> 时间：2012-11-16T23:54:11.810
> 
> 标签：php, javascript, mysql, json, infinite-scroll

I'm using a script called [autobrowse](https://github.com/msjolund/jquery-esn-autobrowse) It represents an infinite scroll type of script which pulls the data from a JSON file. When I set the script to repeat(loop) the items a few times it works perfectly like in the [demo example from the creator of the script](http://msjolund.github.com/autobrowse/). That is done by entering a higher value in max, like they have it set to 100 in their example which pulls data from a flickr json feed.

But I don't want to repeat my results, instead I want them to load like every 10 or 20 items and stop when the last item from the json(database) is loaded. But when I set the "max: 1" option in the script in order to load my items from the JSON only once, it displays all the elements at once, no matter how many they are. No infinite scrolling whatsoever.

So I want to set how many items should be displayed with every scroll at the bottom of the page. Like 10 for example.

This is how I generate my JSON file:

```
<?php
$link = mysql_pconnect("localhost", "user", "pass") or die("Could not connect");
mysql_select_db("dbase") or die("Could not select database");

$arr = array();

$rs = mysql_query("SELECT * FROM bannersright ORDER BY HdOrder");

while($obj = mysql_fetch_object($rs)) {
$arr[] = $obj;
}

echo '{"bannersright":'.json_encode($arr).'}';

?> 
```

And this is how I call the autobrowse script in my view file:

```
 $(function () {

        $("#wrapper #sidebar-right").autobrowse(

            {

                url: function (offset)
                {                   
                    return "http://www.mysite.com/json.php";
                },
                template: function (response)
                {
                    var markup='';
                    for (var i=0; i<response.bannersleft.length; i++)
                    {
                        markup+='<a href="'+response.bannersleft[i].URL+'"><img src="'+response.bannersleft[i].Image+'" /></a>'
                    };
                    return markup;
                },
                itemsReturned: function (response) { return response.bannersleft.length; },
                offset: 0,
                max: 1,
                loader: '<div class="loader"></div>',
                useCache: false,
                expiration: 1
            }
        );

}); 
```

I believe that it has something to do with the offset function, but not sure how to accomplish this. They have one more demo with twitter on their website, which is pretty similar with this, but they call the json like this:

```
url: function (offset)
{
    return "http://twitter.com/status/user_timeline/ParisHilton.json?count=10&page=OFFSET&callback=?".replace(/OFFSET/, 1+Math.round(offset/10));
}, 
```

(the reason their demo doesn't work any more is because twitter changed their json feeds api)

From the way they call the twitter feed, I suppose twitter had the option to set pages in their API.

So I guess my final question would be: how do you create pages in JSON ? What php code do I need to add to my json.php file in order to be able to pickup the elements from it in pages?

It doesn't have to be with json pages, if you have another solution please kindly share it.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:19:20.910

您忘记在 mySQL 请求和 url 生成器中设置 LIMIT：

PHP

```
<?php
$link = mysql_pconnect("localhost", "user", "pass") or die("Could not connect");
mysql_select_db("dbase") or die("Could not select database");

//GET page/count
$count=10;$offset=0;
if (isset($_GET['count'])) $count=$_GET['count']*1;
if (isset($_GET['page']))  $offset=$_GET['page']*$count*1;

$arr = array();

$rs = mysql_query("SELECT * FROM bannersright 
                   ORDER BY HdOrder 
                   LIMIT $offset,$count"); #<-HERE

while($obj = mysql_fetch_object($rs)) {
$arr[] = $obj;
}

echo '{"bannersright":'.json_encode($arr).'}';

?> 
```

JS：

```
$(function () {

        $("#wrapper #sidebar-right").autobrowse(

            {

                url: function (offset)
                {                   
                    return "http://www.mysite.com/json.php?count=10&page="
                           +Math.round(offset/10); // <-- AND HERE
                },
                template: function (response)
                {
                    var markup='';
                    for (var i=0; i<response.bannersleft.length; i++)
                    {
                        markup+='<a href="'+response.bannersleft[i].URL+'"><img src="'+response.bannersleft[i].Image+'" /></a>'
                    };
                    return markup;
                },
                itemsReturned: function (response) { return response.bannersleft.length; },
                offset: 0,
                max: 1,
                loader: '<div class="loader"></div>',
                useCache: false,
                expiration: 1
            }
        );

}); 
```

# python - Python：以优雅的方式改进并保存函数的代码以避免多个 if...else 语句

> ID：13426140
> 
> 赞同：0
> 
> 时间：2012-11-16T23:55:18.667
> 
> 标签：python, performance, optimization, if-statement

我写了以下函数。此函数读取 *.las 点格式并通过 GDAL 创建光栅网格图像。使用**dtype我可以选择遵循**[GDAL 描述](http://www.gdal.org/gdal_8h.html#a22e22ce0a55036a96f652765793fb7a4)的栅格网格的格式。我使用了几个 if...else 语句，但我希望我编写一些建议以节省行并让我的功能更优雅

```
 if dtype == "GDT_Unknown": # Unknown or unspecified type
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Unknown)
    elif dtype == "GDT_Byte": # Eight bit unsigned integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Byte)
    elif dtype == "GDT_UInt16": # Sixteen bit unsigned integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_UInt16)
    elif dtype == "GDT_Int16": # Sixteen bit signed integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Int16)
    elif dtype == "GDT_UInt32": # Thirty two bit unsigned integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_UInt32)
    elif dtype == "GDT_Int32": # Thirty two bit signed integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Int32)
    elif dtype == "GDT_Float32": # Thirty two bit floating point
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Float32)
    elif dtype == "GDT_Float64": # Sixty four bit floating point
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Float64)
    elif dtype == "GDT_CInt16": # Complex Int16
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CInt16)
    elif dtype == "GDT_CInt32": # Complex Int32
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CInt32)
    elif dtype == "GDT_CFloat32": # Complex Float32
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CFloat32)
    elif dtype == "GDT_CFloat64": # Complex Float64
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CFloat64) 
```

提前致谢

```
def LAS2MAXGrid(inFile,outFile,gridSize=1,dtype="GDT_Float32",nodata=-9999.00,BBOX=None,EPSG=None):
    if BBOX == None:
        X = []
        Y = []
        for p in lasfile.File(inFile,None,'r'):
            X.append(p.x)
            Y.append(p.y)
        xmax, xmin = max(X),min(X)
        ymax, ymin = max(Y), min(Y)
        del X,Y
    else:
        xmax,xmin,ymax,ymin = BBOX[0],BBOX[1],BBOX[2],BBOX[3]
    # number of row and columns
    nx = int(math.ceil(abs(xmax - xmin)/gridSize))
    ny = int(math.ceil(abs(ymax - ymin)/gridSize))
    # Create an array to hold the values
    data = np.zeros((ny, nx))
    # read all points line-by-line
    for p in lasfile.File(inFile,None,'r'):
        # Compute the x and y offsets for where this point would be in the raster
        dx = int((p.x - xmin)/gridSize)
        dy = int((ymax - p.y)/gridSize)
        if data[dy,dx] >= p.z:
            data[dy,dx] = data[dy,dx]
        elif data[dy,dx] < p.z:
            # Add the z value for that pixel
            data[dy,dx] = p.z
    # Replacing values equal than a limit in a numpy array
    np.putmask(data, data == 0.00,nodata)
     # Create gtif
    if dtype == "GDT_Unknown": # Unknown or unspecified type
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Unknown)
    elif dtype == "GDT_Byte": # Eight bit unsigned integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Byte)
    elif dtype == "GDT_UInt16": # Sixteen bit unsigned integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_UInt16)
    elif dtype == "GDT_Int16": # Sixteen bit signed integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Int16)
    elif dtype == "GDT_UInt32": # Thirty two bit unsigned integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_UInt32)
    elif dtype == "GDT_Int32": # Thirty two bit signed integer
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Int32)
    elif dtype == "GDT_Float32": # Thirty two bit floating point
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Float32)
    elif dtype == "GDT_Float64": # Sixty four bit floating point
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_Float64)
    elif dtype == "GDT_CInt16": # Complex Int16
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CInt16)
    elif dtype == "GDT_CInt32": # Complex Int32
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CInt32)
    elif dtype == "GDT_CFloat32": # Complex Float32
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CFloat32)
    elif dtype == "GDT_CFloat64": # Complex Float64
        target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.GDT_CFloat64)
    # top left x, w-e pixel resolution, rotation, top left y, rotation, n-s pixel resolution
    target_ds.SetGeoTransform((xmin, gridSize, 0,ymax, 0, -gridSize))
    # set the reference info
    if EPSG is None:
        # Source has no projection (needs GDAL >= 1.7.0 to work)
        target_ds.SetProjection('LOCAL_CS["arbitrary"]')
    else:
        proj = osr.SpatialReference()
        proj.ImportFromEPSG(EPSG)
        # Make the target raster have the same projection as the source
        target_ds.SetProjection(proj.ExportToWkt())
    # write the band
    target_ds.GetRasterBand(1).WriteArray(data)
    target_ds.GetRasterBand(1).SetNoDataValue(nodata)
    target_ds = None 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-16T23:59:17.460

你可以尝试这样的事情：

```
dtypes = {
    "GDT_Unknown": gdal.GDT_Unknown,
    "GDT_Byte": gdal.GDT_Byte, 
    # etc
}

target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, dtypes[dtype]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T00:02:44.763

由于您的`dtype`变量名称与`gdal`您尝试使用的变量名称相匹配，因此类似这样的东西应该可以正常工作。

```
target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, gdal.__getattribute__(dtype)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T00:07:42.533

这个单线怎么样：

```
target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, getattr(gdal, dtype)) 
```

你也可以将它包裹在一个 try / catch 语句中，以防 'dtype' 值不是预期的

```
try:
    target_ds = gdal.GetDriverByName('GTiff').Create(outFile, nx,ny, 1, getattr(gdal, dtype))
except:
    target_ds = None 
```

**编辑**：对不起，美学家，不是要复制你的答案，当我开始回答你的帖子时，你的帖子不在那里.. :(

# java - BufferedWriter not writing everything to its output file

> ID：13426142
> 
> 赞同：33
> 
> 时间：2012-11-16T23:55:54.717
> 
> 标签：java, file-io, bufferedwriter

I have a Java program that reads some text from a file, line by line, and writes new text to an output file. But not all the text I write to my `BufferedWriter` appears in the output file after the program has finished. Why is that?

The details: the program takes a CSV text document and converts it into SQL commands to insert the data into a table. The text file has more than 10000 lines which look similar to following:

```
2007,10,9,1,1,1006134,19423882 
```

The program seems to work fine except it just stops in the file randomly half way through creating a new SQL statement having printed it into the SQL file. It looks something like:

```
insert into nyccrash values (2007, 1, 2, 1, 4, 1033092, 259916);
insert into nyccrash values (2007, 1, 1, 1, 1, 1020246, 197687);
insert into nyccrash values (2007, 10, 9, 1 
```

This happens after about 10000 lines but several hundred lines before the end of the file. Where the break happens is between a `1` and a `,`. However, the characters doesn't seem important because if I change the `1` to a `42` the last thing written to the new file is `4`, which is cutting off the 2 from that integer. So it seems like the reader or writer must just be dying after writing/reading a certain amount.

My Java code is as follows:

```
import java.io.*;

public class InsertCrashData
{
    public static void main (String args[])
    {
        try
        {   
            //Open the input file.
            FileReader istream = new FileReader("nyccrash.txt");
            BufferedReader in = new BufferedReader(istream);
            //Open the output file.
            FileWriter ostream = new FileWriter("nyccrash.sql");
            BufferedWriter out = new BufferedWriter(ostream);
            String line, sqlstr;

            sqlstr = "CREATE TABLE nyccrash (crash_year integer, accident_type integer, collision_type integer, weather_condition integer, light_condition integer, x_coordinate integer, y_coordinate integer);\n\n"; 
            out.write(sqlstr);

            while((line = in.readLine())!= null)
            {
                String[] esa = line.split(",");
                sqlstr = "insert into nyccrash values ("+esa[0]+", "+esa[1]+", "+esa[2]+", "+esa[3]+", "+esa[4]+", "+esa[5]+", "+esa[6]+");\n";
                out.write(sqlstr);
            }
        }
        catch(Exception e)
        {
            System.out.println(e);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2012-11-16T23:57:31.333

您需要关闭您的`OutputStream`which 将刷新您的剩余数据：

```
out.close(); 
```

的默认缓冲区大小为`BufferedWriter`8192[个字符](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/io/BufferedWriter.java#BufferedWriter.0defaultCharBufferSize)，足以轻松容纳数百行未写入的数据。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-01-06T14:04:44.570

你**必须** [`close()`](https://docs.oracle.com/javase/7/docs/api/java/io/BufferedWriter.html#close%28%29)你的`BufferedWriter`. 你必须是`close()`你的`BufferedWriter`，因为它是 IS-A[`Writer`](https://docs.oracle.com/javase/7/docs/api/java/io/Writer.html)并因此实现[`AutoCloseable`](https://docs.oracle.com/javase/7/docs/api/java/lang/AutoCloseable.html)，这意味着（强调）它是

> 不再需要时*必须关闭*的资源。

有人说你必须先打电话[`flush()`](https://docs.oracle.com/javase/7/docs/api/java/io/BufferedWriter.html#flush%28%29)给你`BufferedWriter`，然后再打电话`close()`。他们错了。文档`BufferedWriter.close()`说明它“关闭流，*首先刷新它*”（强调添加）。

[`flush()`](https://docs.oracle.com/javase/7/docs/api/java/io/Flushable.html#flush%28%29)已记录的刷新 ( )语义是

> 通过将任何缓冲输出写入底层流来刷新此流

因此，您必须`close`并且`close`将刷新任何缓冲的输出。

您的输出文件不包含您写入的所有文本，`BufferedWriter`因为它在缓冲区中存储了一些文本。从未清空该`BufferedWriter`缓冲区，将其传递给文件，因为您从未告诉它这样做。

* * *

从 Java 7 开始，确保`AutoCloseable`资源（例如 a `BufferedWriter`）在不再需要时关闭的最佳方法是使用自动资源管理 (ARM)，也称为[try-with-resources](https://stackoverflow.com/questions/17739362/java7-try-with-resources-statement-advantage)：

```
 try (BufferedWriter out = new BufferedWriter(new FileWriter(file))) {
    // writes to out here
 } catch (IOException ex) {
    // handle ex
 } 
```

您还必须`close`在`BufferedReader`不再需要它时使用它，因此您应该嵌套 try-with-resources 块：

```
 try (BufferedReader in = new BufferedReader(new FileReader("nyccrash.txt")) {
    try (BufferedWriter out = new BufferedWriter(new FileWriter("nyccrash.sql"))) {
       // your reading and writing code here
    }
 } catch (IOException ex) {
    // handle ex
 } 
```

当您的代码使用编写器“完成”时，不要被诱惑（正如这里的其他答案所建议的那样）只是`close()`在方法结束时调用。如果您编写的代码抛出异常，特别是如果它抛出`IOException`.

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-02-29T09:58:08.750

> 不再需要时必须关闭的资源。

```
finally {
    out.close();//this would resolve the issue
    } 
```

需要考虑的一些事项：

*   `BufferedWriter.close()` **将缓冲区刷新到底层流**，因此如果您忘记`flush()`并且不关闭，您的文件可能没有您写入的所有文本。
*   `BufferedWriter.close()`还关闭包装的 Writer。当它是 FileWriter 时，这将**最终关闭 FileOutputStream**并告诉操作系统您已完成对文件的写入。
*   垃圾收集器将自动调用`close()`，而不是在 BufferedWriter 或包装的 FileWriter 上，而是在 FileOuputStream 上。所以操作系统会很高兴，但你必须等待 GC。
*   但是，您总是希望在不再需要**操作系统资源时立即释放它们。**这适用于打开的文件、数据库连接、打印队列……任何东西。相信我这个。
*   `BufferedWriter.close()`确实清除了内部字符缓冲区，以便内存可用于垃圾收集，即使 BufferedWriter 本身仍在范围内。

***因此，当您完成资源（不仅仅是文件）时，请务必关闭它们。***

如果您真的想深入了解一下，大多数 Java API 的源代码都是可用的。BufferedWriter 在[这里](http://www.docjar.org/html/api/java/io/BufferedWriter.java.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-16T23:58:47.103

完成写入后，您的代码似乎没有关闭编写器。添加一个`out.close()`（最好在 finally 块中）它应该可以正常工作。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-11-16T23:58:56.883

你努力关闭你的 BufferedWriter.close 它在 finally 块内

```
 finally {
    out.close();//this would resolve the issue
    } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-08-11T11:36:36.717

使用完资源后，请务必关闭资源（不仅仅是文件）。

```
 finally {
    out.close();//this would resolve the issue
    } 
```

在某些情况下，您可能希望在不关闭文件的情况下刷新缓冲区。在这些情况下，您可以使用刷新方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-11-24T10:40:04.077

由于您使用的是 BufferedWriter ，因此您还可以在适当的时候刷新缓冲区：

```
out.flush() 
```

这会将缓冲区的其余部分写入实际文件。关闭方法还刷新缓冲区并关闭文件。

```
out.close() 
```

在某些情况下，您可能希望在不关闭文件的情况下刷新缓冲区。在这些情况下，您可以使用刷新方法。

您也可以使用 BuffredWriter 的换行方法，而不是在行尾添加 \n。Newline-method 使用系统特定的行分隔符，因此您的代码可以在不同的平台上运行。

```
out.newLine() 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2020-07-04T12:30:21.640

根据文档，调用`flush()`方法是没有用的。如果你打算使用`FileWriter`那么`flush()`会帮助你。

基本上在这种情况下，您只需要关闭即可`BufferedWriter.close()`。这将刷新您的剩余数据。

创建 finally 块并将 close 方法放入其中，以便它将所有数据都放入而不会丢失。

```
 finally {
    out.close();
    } 
```

# qt - Obtaining the Qt 4.8 SDK

> ID：13426144
> 
> 赞同：6
> 
> 时间：2012-11-16T23:56:05.597
> 
> 标签：qt, sdk, qt4.8

I haven't used Qt on Windows in a while. I know that now we're supposed to download the open source version from the Qt Project website.

But the page at [http://qt-project.org/downloads](http://qt-project.org/downloads) has separate links to installers for Qt libraries and Qt Creator. I remember being able to just download the full SDK and get started, but now I have t separately install MinGW, the libraries and Qt Creator.

Can I still get the libraries and Qt Creator in a single bundle, and if yes, where should I look?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:13:09.703

Digia 现在分发 SDK。不确定它是否仍然免费。[http://qt.digia.com/Product/Qt-SDK/](http://qt.digia.com/Product/Qt-SDK/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-19T18:50:17.480

[有安装指南](http://tudat.tudelft.nl/projects/tudat/wiki/Installation_Guide)和完整的 SDK (1.2.1)，包括补充文件的 LINUX/WINDOWS。这里不需要安装非功能性的 Windows-MinGW。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T13:26:33.757

[我刚刚从http://download.cnet.com/Qt-SDK/3000-2069_4-75305206.html](http://download.cnet.com/Qt-SDK/3000-2069_4-75305206.html)下载了 Qt SDK

它似乎正在工作，尽管 Windows 说安装程序未签名。

# linux - Why "sudo -s" change to root user without asking for password

> ID：13426145
> 
> 赞同：0
> 
> 时间：2012-11-16T23:56:05.497
> 
> 标签：linux, bash, command-line-interface, sudo

When I type in "sudo -s" in the command line, I changed to root user without typing in any passwords. I'm confused why this happened. From my understanding. Can someone explain that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:57:08.397

Because this/previous session you was root also.

lets say if you entered as root, `sudo -s` - no action. Or you created session, entered as root, closed for example ssh connection and entered once more (during 5 min), the result, you still stay as root

# android - Textview Vertical Centering

> ID：13426148
> 
> 赞同：0
> 
> 时间：2012-11-16T23:56:55.533
> 
> 标签：android, android-layout, textview, android-relativelayout

I am attempting to vertically centre a TextView element within a listview row. The left hand side of the image shows the list view, in the first view the textview has the value "MSH"

As the image shows this is not quite in the centre, it is slightly too high.

The layout view for the textview row is shown below.

How do I get the textview centred?

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout  xmlns:tools="http://schemas.android.com/tools"                                       android:orientation="horizontal"
android:layout_width="match_parent" 
android:layout_height="match_parent" 
android:layout_marginRight="5dp"
xmlns:android="http://schemas.android.com/apk/res/android">

        <TextView android:id="@+id/tvName" 
            android:gravity="center_vertical"
            android:layout_width="95dp" 
            android:layout_height="40dp" 
            android:layout_marginLeft="10dp" 
            android:text="XXX"
            android:textSize="30sp"  
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <TextView android:id="@+id/tvLongName"
            android:layout_toRightOf="@+id/tvName"
            android:layout_width="wrap_content" 
            android:layout_height="wrap_content" 
            android:text="dfdfdsfdfdfdsfdsf" 
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <TextView android:id="@+id/tvUsage" 
            android:layout_below="@+id/tvLongName"
            android:layout_toRightOf="@+id/tvName"
            android:layout_height="wrap_content" 
            android:layout_width="10dp"
            android:layout_marginRight="5dp"
            android:gravity="right"
            android:text="R" 
            android:textAppearance="?android:attr/textAppearanceMedium" />  

        <TextView android:id="@+id/tvCardinality" 
            android:layout_below="@+id/tvLongName"
            android:layout_toRightOf="@+id/tvUsage"
            android:layout_height="wrap_content" 
            android:layout_width="wrap_content"
            android:layout_alignParentRight="true" 
            android:layout_marginRight="5dp"
            android:text="(0..1)" 
            android:textAppearance="?android:attr/textAppearanceMedium"  />

   </RelativeLayout> 
```

![Screenshot](../Images/479a8d5d5a06f16088673b69821030d5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T05:08:01.470

而不是使用`android:gravity="center_vertical"`

你应该使用`android:layout_centerVertical="true"`

那肯定会成功的。

# c# - Generating XAML and bitmap from vectorial shapes

> ID：13426152
> 
> 赞同：0
> 
> 时间：2012-11-16T23:57:12.423
> 
> 标签：c#, wpf, xaml, bitmap, vector-graphics

I would like to generate vectorial shapes in various output formats: bmp, png, svg and XAML. So basically, this is a library (no user interface) which generate internally a vectorial shape in order to export it. The shape I want to export might contain a combination of rectangle, lines, text and circle.

But I don't know which way to choose in order to handle all those formats (bitmap and vectorial) easily.

So far, I have considered:

*   Building programmatically the shape with XAML. Example; create a Rectangle(), add it to a Canvas(). From there, it is very easy to generate the XAML and to render the images. But I'm not sure that it is fast.
*   Use System.Windows.Media methods to draw my shapes. But how to generate XAML (and svg)?
*   Use GDI+ methods (System.Drawing). Like the preceding point, I'm stuck when generating XAML.

Maybe there is another way to generate my vectorial shape and then export it?

Thank you

# python - Python How to use extended path length

> ID：13426156
> 
> 赞同：5
> 
> 时间：2012-11-16T23:57:16.860
> 
> 标签：python, python-3.x

I am running my python code on Windows and trying to traverse and store all the file name with their paths in a file. But the Windows has a restriction of 260 characters.

```
os.chdir(self.config.Root_Directory_Path())        
    for root, dirs, files in os.walk("."):
        file_list.extend( join(root,f) for f in files )
    file_name_sorted = sorted(file_list)
    #file_sorted = sorted(file_list, key=getsize)
    #time.strftime("%m/%d/%Y %I:%M:%S %p" ,time.localtime(os.path.getmtime(file)))
    f = open(self.config.Client_Local_Status(),'wb')        
    for file_name in file_name_sorted:
        if (os.path.exists(file_name)):
            #f.write((str(os.path.getmtime(file_name)) + "|" + file_name + "\n").encode('utf-8'))
            pass
        else:
            print(file_name + "|" + str(len(file_name) + len(originalPath)) + "\n")
            print(os.path.getmtime(file_name))
            #f.write((str(os.path.getmtime(file_name)) + "|" + file_name + "\n").encode('utf-8'))
    f.close() 
```

Because of the error, os.path.getmtime(file_name) throws an exception file not found. How can I overcome this problem? I tried using //?/ character as prefix, as suggested in

[http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx)

But was not successful in using //?/ character.

I tried using os.path.getmtime("////?//" + file_name) #Threw an error invalid path

Please suggest a fix

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T01:45:19.357

这里的问题是您使用的是相对路径。`\\?\`前缀只能应用于绝对路径。正如[文档](http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx#maxpath)所说：

> 这些前缀不用作路径本身的一部分。它们表明路径应该以最少的修改传递给系统，这意味着您不能使用正斜杠来表示路径分隔符，或者使用句点来表示当前目录，或者使用双点来表示父目录。因为您不能将“ `\\?\`”前缀与相对路径一起使用，所以相对路径总是被限制为总共**MAX_PATH**个字符。

修复很简单。而不是这个：

```
'\\\\?\\' + file_name 
```

做这个：

```
'\\\\?\\' + os.path.abspath(file_name) 
```

您不能使用正斜杠。添加额外的反斜杠可能合法也可能不合法，在这种情况下，您可以`r'\\?\\'`不用加倍双反斜杠而不是加倍。试试看（但请确保测试驱动器前缀路径`C:\foo`和 UNC 路径`\\server\share\bar`）......但是上面的双反斜杠版本肯定可以工作。

# analyzer - PyLucene中的DelimitedPayloadFilter？

> ID：13426157
> 
> 赞同：1
> 
> 时间：2012-11-16T23:57:19.007
> 
> 标签：analyzer, payload, pylucene

我正在尝试使用 pylucene从[http://searchhub.org/2010/04/18/refresh-getting-started-with-payloads/实现 java 的 python 版本。](http://searchhub.org/2010/04/18/refresh-getting-started-with-payloads/)我的分析器在对 DelimitedTokenFilter 的 init 调用中产生 lucene.InvalidArgsError

课程如下，非常感谢任何帮助。使用 pylucene 3.6 构建中的 JAR 文件编译的 java 版本工作正常。

```
import lucene
class PayloadAnalyzer(lucene.PythonAnalyzer):
    encoder = None
    def __init__(self, encoder): 
        lucene.PythonAnalyzer.__init__(self) 
        self.encoder = encoder

    def tokenStream(self, fieldName, reader):
        result = lucene.WhitespaceTokenizer( lucene.Version.LUCENE_CURRENT, reader )
        result = lucene.LowerCaseFilter( lucene.Version.LUCENE_CURRENT, result )
        result = lucene.DelimitedPayloadTokenFilter( result, '|', self.encoder )
        return result 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-09T05:27:55.370

jcc的[文档说：](http://lucene.apache.org/pylucene/jcc/features.html)

> 当 JCC 看到这些特殊的扩展 java 类时，它会生成实现它们声明的本地方法的 C++ 代码。这些本地方法调用相应的 Python 方法实现，传入参数并将结果返回给 Java VM 调用者。

所以你应该`java/org/apache/pylucene/search/similarities/PythonDefaultSimilarity.java`在pylucene中编辑文件。

添加一些这样的代码：

```
import org.apache.lucene.util.BytesRef;
public native float scorePayload(int docId, int start, int end, BytesRef payload); 
```

在此之后，您的代码可以覆盖方法`scorePayload`。

```
class PayloadSimilarity(PythonDefaultSimilarity):

    def scorePayload(self, docId, start, end, payload):
        return PayloadHelper.decodeFloat(payload.bytes, end)

class PayloadAnalyzer(PythonAnalyzer):
    encoder = None

    def __init__(self, encoder):
        super(PayloadAnalyzer, self).__init__()
        self.encoder = encoder

    def createComponents(self, fieldName, reader):
        source = WhitespaceTokenizer(Version.LUCENE_44, reader)
        result = LowerCaseFilter(Version.LUCENE_44, source)
        result = DelimitedPayloadTokenFilter(result, u'|', self.encoder)
        return self.TokenStreamComponents(source, result) 
```

我在pylucene4.8下测试了上面的代码。它工作正常。

# ruby-on-rails-3 - Rails 删除数据库记录，除了 10 个最新条目

> ID：13426159
> 
> 赞同：1
> 
> 时间：2012-11-16T23:57:28.850
> 
> 标签：ruby-on-rails-3, activerecord

我创建了一个名为“PostView”的模型。每次用户查看帖子时，都会将其记录到数据库中（使用用户 ID 和帖子 ID 创建一条新记录）。

我只想在数据库中为每个用户保留 10 条记录。因此，每次添加新记录时，我都想删除除最新的 10 条记录之外的所有记录。

1.  这有效率吗？如果不是，您建议以什么方式记录用户/帖子视图？
2.  如何在 Rails 中添加新记录并删除除最新的 10 条记录之外的所有记录？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:49:53.180

似乎这会导致大量开销，并且您最好定期通过 cron 修剪数据库，或者如果您真的只需要最后 10 条记录，请找到一种更有效的方式来存储它们。但如果你做不到...

```
cutoff = PostView.where(:user_id => user_id, :post_id => post_id).
                  order('created_at DESC').
                  offset(10).first

PostView.where(:user_id => user_id, :post_id => post_id).
         where(['created_at <= ?', cutoff.created_at]).
         delete_all 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-10T21:08:06.933

该命令查询所有匹配 user_id 和 post_id 的记录，将这些记录按最新的优先排序，并销毁该集中超过第 10 个最新记录的记录。

```
PostView.where(user_id: user_id, post_id: post_id).
         order('id desc').offset(10).destroy_all 
```

您的问题的另一个解决方案是，您可以更新第 10 个最旧的记录（如果存在），而不是每次都创建一个新的 PostView 记录，否则创建一个新记录。

```
pv = PostView.first(where: ["user_id = ? AND post_id = ?", user_id, post_id], 
                    order: "id desc", offset: 9) || PostView.new
pv.update_attributes(field1: value1, field2: value2, 
                     created_at: Time.now) 
```

# gwt - 从 servlet 返回的文本中丢失 "\n（引号和换行符序列）

> ID：13426164
> 
> 赞同：0
> 
> 时间：2012-11-16T23:58:34.587
> 
> 标签：gwt, servlets, gwt-platform, guice-servlet

我正在从一个运行良好的 servlet 返回一些文本，但以 " 字符结尾的行除外。这些行会导致引号和后面的换行符丢失。您有什么想法可能导致或解决此问题吗？

# windows - 在 Windows 中将 .cu 文件转换为 .ptx 文件

> ID：13426170
> 
> 赞同：1
> 
> 时间：2012-11-16T23:59:14.343
> 
> 标签：windows, matlab, cuda

我在 Windows 中进行 gpgpu 编程，我一直在 Microsoft Visual Studio 2010 中这样做。但由于某种原因，我需要使用 matlab 来运行我的 cuda 内核。所以我在查看[这个](http://www.mathworks.com/help/distcomp/executing-cuda-or-ptx-code-on-the-gpu.html)站点，他们提到我需要从 .cu 文件创建一个 .ptx 来运行我的 cuda 内核。但我使用的是 windows，我想在 windows 中创建 .ptx 文件。如果有人能指导我知道如何将 .cu 文件转换为 .ptx 文件，那将非常有帮助。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:35:30.720

一种方法是从命令行执行此操作。您可能需要知道 nvcc.exe 和 cl.exe（MS VC 编译器）的位置。在我的情况下，我安装了 MS VC 2008 express，cl.exe 位于 C:\Program Files\Microsoft Visual Studio 9.0\VC\bin\cl.exe 我在这台特定的机器上也有 CUDA 4.2，并且 nvcc 位于在 C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v4.2\bin\nvcc.exe 你也可以使用 windows 搜索来找到这些。

使用上述信息，打开命令提示符，并将目录更改为要转换为 PTX 的 .cu 文件（我们称之为 foo.cu）。nvcc 可能已经在您的 PATH 上，因此您可能不必使用它的路径：

```
<path-to-nvcc>nvcc -ptx -ccbin "C:\Program Files\Microsoft Visual Studio 9.0\VC\bin" -o foo.ptx foo.cu 
```

您可以将 cl.exe 的路径放在 PATH 变量中以简化上述操作（应该能够以这种方式消除 -ccbin 开关。）要获取有关 nvcc 选项的更多信息，请使用：

```
nvcc --help 
```

如果您的程序需要超出 nvcc 所知道的其他包含文件，则您还必须使用 -I 开关指定这些文件的路径。查看 nvcc 选项以获取更多信息。

# gwt - 如何从自定义小部件向 uibinder 触发 onSelection 事件

> ID：13426175
> 
> 赞同：1
> 
> 时间：2012-11-16T23:59:48.847
> 
> 标签：gwt, widget, custom-component, uibinder, suggestbox

我使用 uibinder 创建了一个自定义 SuggestBox，并在使用 uibinder 的视图中使用它。

我的问题是无法将 onSelection 事件触发到我使用自定义建议框的视图

下面是我的代码。

**MySuggestBox.ui.xml**

```
<ui:UiBinder xmlns:ui="urn:ui:com.google.gwt.uibinder"
xmlns:g="urn:import:com.google.gwt.user.client.ui">
<ui:style>

</ui:style>
<g:SuggestBox ui:field="suggestionBox"></g:SuggestBox>
</ui:UiBinder> 
```

**MySuggestBox.java**

```
public class MySuggestBox extends Composite implements IsWidget, HasSelectionHandlers<Suggestion>{

    private static mySuggestBoxUiBinder uiBinder = GWT
        .create(mySuggestBoxUiBinder.class);

    interface MySuggestBoxUiBinder extends
        UiBinder<Widget, MySuggestBox> {
    }

   @UiField SuggestBox suggestionBox;
   public mySuggestBox(){
       initWidget(uiBinder.createAndBindUi(this));
   }

   @Override
   public HandlerRegistration addSelectionHandler(SelectionHandler<Suggestion> handler)  {
      return addHandler(handler, SelectionEvent.getType());
   }
    ...
    ...
    ...

} 
```

我在这里使用上面的小部件

**MySuggestBoxExample.ui.xml**

```
<ui:UiBinder xmlns:ui="urn:ui:com.google.gwt.uibinder"
xmlns:g="urn:import:com.google.gwt.user.client.ui
    xmlns:my="urn:import:com.myproject.mywidget">
<ui:style>

</ui:style>
<my:MySuggestBox ui:field="suggestBox" />
</ui:UiBinder> 
```

**MySuggestBoxExample.java**

```
public class MySuggestBoxExample extends Composite implements IsWidget{

    private static mySuggestBoxExampleUiBinder uiBinder = GWT
        .create(mySuggestBoxExampleUiBinder.class);

    interface MySuggestBoxExampleUiBinder extends
        UiBinder<Widget, MySuggestBoxExample> {
    }

   @UiField MySuggestBox suggestBox;
   public MySuggestBoxExample (){
       initWidget(uiBinder.createAndBindUi(this));
   }

   @UiHandler("suggestBox")
   public void onSelection(SelectionEvent<Suggestion> event){
      //I DONT GET THIS EXECUTED
   }
    ...
    ...
    ...

} 
```

我没有触发 onSelecion 方法。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T11:02:13.870

您`MySuggestBox`不会将 SelectionHandler 添加到实际`SuggestBox`中，而是将`Composite`其添加到扩展中。当 SuggestBox 触发时，它不会在您的建议框中找到添加的处理程序。您可以通过将处理程序添加`MySuggestBox`到实际的建议框字段来修复它：

```
@Override
public HandlerRegistration addSelectionHandler(SelectionHandler<Suggestion> handler)  {
  return suggestionBox.addSelectionHandler(handler);
} 
```

# google-maps-api-3 - 如何创建包含食品和酒类商店列表的地图

> ID：13426178
> 
> 赞同：0
> 
> 时间：2012-11-17T00:00:10.760
> 
> 标签：google-maps-api-3, google-places-api

我正在尝试创建一个比较纽约市食品和酒类商店数量的谷歌地图。我对google maps api或places api没有太多经验，所以我真的很困惑。有没有办法我可以在纽约市周围放置数百个特定颜色的标记，这样你就知道它是一家食品店（比如红色），然后相应的酒类商店会有不同的颜色（蓝色）。我不知道实现这一目标的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:17:18.883

您将无法使用 Places API 放置数百个位置，它是有限的（每次调用 20 个结果）。Places API 旨在为您提供与您的位置最接近的 20 个结果，或与您的查询最接近的 20 个匹配项。

如果您有位置或地址，您可以将它们显示在地图上，并使用不同颜色的标记对其进行分类，但您需要从 Google 以外的其他地方获取数据才能完成您想做的事情。

[示例类别地图](http://www.geocodezip.com/v3_MW_example_categories.html)移植自 Mike Williams 的 v2 教程。

# forms - PHP | 页面刷新后不会出现隐藏/显示表单

> ID：13426185
> 
> 赞同：1
> 
> 时间：2012-11-17T00:01:22.783
> 
> 标签：forms, session, login, refresh

我想在用户登录时显示我的注销表单（包含注销按钮），否则隐藏。我使用这段代码：

```
<?php
if(isset($_SESSION['logged_in'])) {
//show logout form
?> 
```

步骤中的问题：

1.  用户进入页面并在登录表单中填写信息
2.  提交登录表单（通过隐藏输入控制），单击按钮
3.  登录输入值与数据库值进行比较
4.  如果输入值正确；$_SESSION['logged_in'] = true
5.  echo '您已登录！'
6.  页面被刷新（表单提交后自动完成）；显示“您已登录”，但未显示注销表单
7.  现在我必须自己刷新页面；显示注销表格

注销时也会发生同样的事情。注销表单（和登录表单）仅在我自己刷新页面时隐藏/显示。

任何可能的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T11:30:27.417

经过一些测试并深入 php.net，我自己找到了答案。对于任何会遇到同样问题的人：

1.  在您的 php 代码之后包含您的 html；否则代码在第一页刷新后不会影响 html
2.  为每个 cookie 设置其生存时间。如果没有填写时间，cookie 会在 session 结束时被销毁。

    ```
    setcookie('username', $username); //NOT (no point at all in making this)
    setcookie('username', $username, time()+ 60*60*24*30 ); //YES 
    ```

3.  session_destroy() 销毁会话但不会取消设置任何会话变量。因此，例如在注销时，您必须取消设置会话：

    ```
    unset($_SESSION['logged_in']);
    session_destroy(); //and then destroy session if needed 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:04:46.660

试试这个模式[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)。

您只需发布登录信息，执行您的逻辑并将用户重定向到登录页面（或登录前的任何位置）。这样可以确保用户浏览器被刷新（因此他\她被重定向到另一个页面）

# mysql - Mysql：如何计算两个时间戳之间的营业时间并忽略周末

> ID：13426186
> 
> 赞同：16
> 
> 时间：2012-11-17T00:01:40.180
> 
> 标签：mysql, sql, date

我的表有示例数据，我需要计算两列中两个时间戳之间的营业时间。营业时间：上午 9:00 至下午 5:00，忽略周六和周日，我不考虑公共假期。有人可以提供一些关于如何实现这一目标的指导吗？我想要第 3 列中所述的所需输出，日期格式为：yyyy-mm-dd

```
 Created date             Updated date         Business hrs
    2012-03-05 9:00am   2012-03-05 3:00pm             6
    2012-03-05 10:00am  2012-03-06 10:00am            9
    2012-03-09 4:00pm   2012-03-19 10:00am            2 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2015-10-20T03:09:54.500

问题是不应该考虑公共假期，所以这个答案就是这样做的 - 计算考虑到周末的营业时间，但忽略可能的公共假期。

如果您需要考虑公共假期，您需要有一个单独的表格来列出公共假期的日期，这可能会因年而异，因州而异或因国家而异。主要公式可能保持不变，但您需要从结果中减去在给定日期范围内的公共假期的小时数。

让我们创建一个表，其中包含一些涵盖各种情况的示例数据：

```
CREATE TABLE T (CreatedDate datetime, UpdatedDate datetime);

INSERT INTO T VALUES
('2012-03-05 09:00:00', '2012-03-05 15:00:00'), -- simple part of the same day
('2012-03-05 10:00:00', '2012-03-06 10:00:00'), -- full day across the midnight
('2012-03-05 11:00:00', '2012-03-06 10:00:00'), -- less than a day across the midnight
('2012-03-05 10:00:00', '2012-03-06 15:00:00'), -- more than a day across the midnight
('2012-03-09 16:00:00', '2012-03-12 10:00:00'), -- over the weekend, less than 7 days
('2012-03-06 16:00:00', '2012-03-15 10:00:00'), -- over the weekend, more than 7 days
('2012-03-09 16:00:00', '2012-03-19 10:00:00'); -- over two weekends 
```

在 MS SQL Server 中，我使用以下公式：

```
SELECT
    CreatedDate,
    UpdatedDate,
    DATEDIFF(minute, CreatedDate, UpdatedDate)/60.0 -
    DATEDIFF(day,    CreatedDate, UpdatedDate)*16 -
    DATEDIFF(week,   CreatedDate, UpdatedDate)*16 AS BusinessHours
FROM T 
```

这会产生以下结果：

```
+-------------------------+-------------------------+---------------+
|       CreatedDate       |       UpdatedDate       | BusinessHours |
+-------------------------+-------------------------+---------------+
| 2012-03-05 09:00:00     | 2012-03-05 15:00:00     | 6             |
| 2012-03-05 10:00:00     | 2012-03-06 10:00:00     | 8             |
| 2012-03-05 11:00:00     | 2012-03-06 10:00:00     | 7             |
| 2012-03-05 10:00:00     | 2012-03-06 15:00:00     | 13            |
| 2012-03-09 16:00:00     | 2012-03-12 10:00:00     | 2             |
| 2012-03-06 16:00:00     | 2012-03-15 10:00:00     | 50            |
| 2012-03-09 16:00:00     | 2012-03-19 10:00:00     | 42            |
+-------------------------+-------------------------+---------------+ 
```

它可以工作，因为在 SQL Server 中，返回指定*startdate*和*enddate*之间跨越的指定*datepart*[`DATEDIFF`](https://msdn.microsoft.com/en-us/library/ms189794.aspx)边界的计数。

 ***每天有 8 个工作时间。我计算两个日期之间的总小时数，然后减去午夜数乘以每天 16 个非营业时间，然后减去周末数乘以 16（周六 + 周日为 8 + 8 个营业时间）。

**它还假设给定的开始和结束日期/时间是在工作时间内。**

在 MySQL 中，最接近的等价物是[`TIMESTAMPDIFF`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_timestampdiff)，但它的工作方式不同。*它有效地计算以秒为单位的差异，并除以（丢弃小数部分）所选单位*的秒数。

所以，为了得到我们需要的结果，我们可以计算`TIMESTAMPDIFF`一些锚日期时间和`CreatedDate`和而不是直接计算和`UpdatedDate`之间的差异。`CreatedDate``UpdatedDate`

我选择`2000-01-03 00:00:00`了星期一。您可以选择任何其他周一（或周日，如果您的一周从周日开始）午夜作为锚定日期。

MySQL 查询变为（参见[SQL Fiddle](http://sqlfiddle.com/#!9/bc2a2/1/0)）：

```
SELECT
    CreatedDate,
    UpdatedDate,

    TIMESTAMPDIFF(MINUTE, CreatedDate, UpdatedDate)/60.0 -

    16*(
        TIMESTAMPDIFF(DAY,    '2000-01-03',UpdatedDate)-
        TIMESTAMPDIFF(DAY,    '2000-01-03',CreatedDate)
    ) -

    16*(
        TIMESTAMPDIFF(WEEK,   '2000-01-03',UpdatedDate)-
        TIMESTAMPDIFF(WEEK,   '2000-01-03',CreatedDate)
    ) AS BusinessHours

FROM T 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T00:13:32.920

创建一个名为 BusinessHours 的表，其中一个名为 Hour 的列包含一个日期时间。将 Hour 设为主键。编写一个流程，用一年中的每个营业时间（`2012-01-02 00:90:00, 2012-01-02 00:10:00`等）填充它。这应该不难，因为规则很简单。这听起来像是很多数据，但从总体上看，它不是（一年只有 8760 小时 - 即使您的日期时间每个需要 8 个字节，这也是惊人的 60kB）。确保安排作业以保持其填充。

然后：

```
Select
  y.CreatedDate,
  y.UpdatedDate,
  Count(*) as BusinessHours
From
  YourTable y
    Inner Join
  BusinessHours h
    On h.Hour >= y.CreatedDate And h.Hour < y.UpdatedDate
Group By
  y.CreatedDate,
  y.UpdatedDate 
```

如果您确实考虑过公共假期，这也为您提供了一种相当简单的方法 - 只需将行从 BusinessHours 表中取出。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-20T15:45:54.317

使用 datediff 计算开始时间和结束时间之间的差异，然后减去（带负数的 date_add 时间）非工作时间：周末 24 天，工作日 16 天，预计结束和开始日期需要额外计算。一天是否是周末，可以用 dayofweek 方法指定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T00:17:15.157

尝试

```
SELECT (FLOOR(DATEDIFF (UpdatedDate, CreatedDate) / 7) * 5 + MOD (DATEDIFF (UpdatedDate, CreatedDate), 7)) * 8 +
       TIMEDIFF (TIME (UpdatedDate), TIME(CreatedDate))
FROM YourTable 
```

以上内容并不完整，因为它只是“估计”周末......但它应该让你开始......另一种选择是使用有效营业时间表（有关详细信息，请参阅[来自 Laurence 的答案](https://stackoverflow.com/a/13426293/847363)）。

有关参考，请参阅[MySQL 文档](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)。***

# permissions - Zope：获得对象角色的权限

> ID：13426188
> 
> 赞同：0
> 
> 时间：2012-11-17T00:01:58.423
> 
> 标签：permissions, roles, zope, acquisition

我认为这一定很容易，但我真的很难弄清楚：我想检查一个对象的角色获得的权限。

我不想检查实际用户的角色或权限，我只想检查一个对象 Anonymous 是否具有“访问内容信息”权限。如果在所讨论的对象上设置了权限，这很容易，但在获得权限时会变得更加困难。

我试过这个：

```
siteRoles = ('Anonymous', 'myRole1', 'myRole2', 'Manager')
permission = 'Access contents information'

rolesDictList = self.rolesOfPermission( permission )

roles = [roleDict['name'] for roleDict in rolesDictList if roleDict['selected']]

for i, role in enumerate(siteRoles):
    if role in roles:
        roleMin = i
        break

return roleMin 
```

这不起作用，因为它没有授予获得的权限。

我的下一个想法是向上遍历父母，直到找到一些未获得的权限。但这并不能真正解决问题，因为它会忽略层次结构中设置较高的权限（好的，我可以检查是否已获得并继续向上）。还有一个奇怪的地方：在角色权限中总是选择“经理”。为什么会这样？

无论如何，我认为必须有一种更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T12:12:17.557

只需使用以下`rolesForPermissionOn()`功能：

```
from AccessControl.PermissionRole import rolesForPermissionOn

roles = rolesForPermissionOn(permission, context) 
```

这将返回对给定上下文具有特定权限的角色列表。它将根据需要遍历获取链。

# java - Java - 否定多项式

> ID：13426191
> 
> 赞同：0
> 
> 时间：2012-11-17T00:02:15.420
> 
> 标签：java, junit, polynomial-math, negate

我试图否定一个多项式表达式，以便以下测试是正确的，我的多项式表达式被定义为`Term(coefficient, exponent)`. 所以我的`public Term negate() throws Overflow`方法通过了这些测试。

```
Term(min,2) -> expected = Overflow
Term(-7,2) -> expected = (7,2)
Term(0,2) -> expected = (0,2)
Term(7,2) -> expected = (-7,2)
Term(max,2) -> expected = (-max,2) 
```

编辑：我在 Term 中有以下方法：

```
public Term negate() throws Overflow {

} 
```

以及 Term 构造函数中的以下内容：

```
public Term(int c, int e) throws NegativeExponent{
    if (e < 0) throw new NegativeExponent();
    coef = c;
    expo = (c == 0 && e != 0) ? 0 : e;
} 
```

上面的测试在一个单独的 JUnit 文件中，但我试图让该`negate()`方法通过测试。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:07:02.600

我只能回答这个问题，因为我回答[了你之前的一个问题](https://stackoverflow.com/questions/13408797/java-junit-comparing-two-polynomial-objects/13408841#13408841)......所以你可能想在你的帖子中澄清一点。

也许你想要

```
public Term negate() throws Overflow, NegativeExponent {
    if (coef == min)
        throw new Overflow();
    return new Term(-coef, expo);
} 
```

您可能还需要考虑重命名`Overflow`为更具体的名称（以便将其与 a 完全区分开来`StackOverflowError`）。

# wpf - 关于 WPF 中连接数据库的问题

> ID：13426193
> 
> 赞同：0
> 
> 时间：2012-11-17T00:02:16.487
> 
> 标签：wpf, database-connection

我有一个 WPF 应用程序，它将使用自定义类连接到数据库。

```
public class SQLRead
{
    public string sql;
    SqlConnection conn;
    SqlCommand cmd;

    public SQLRead()
    {
        sql = string.Empty; 
    }

    public void NewConnection()
    {
        conn = new SqlConnection(
            @"Data Source = Server\Instance;   
              Integrated Security = SSPI;");
        cmd = new SqlCommand(sql, conn);
        cmd.CommandTimeout = 120;
        cmd.CommandType = CommandType.Text;
    }

    public void Connect()
    {
        conn.Open();
    }

    public void Disconnect()
    {
        conn.Close();
    }

    //public void addParameterVarChar(string s, int size, object value)
    //{
    //    SqlParameter sp = new SqlParameter("@SubRegion", SqlDbType.Char, 1, "B");
    //    //sp.Value = value;
    //    cmd.Parameters.Add(sp);
    //}

    public void AddParameter(string s, object value)
    {
        SqlParameter sp = new SqlParameter(s, value);
        cmd.Parameters.Add(sp);
    }

    public List<string> ReadAlnName()
    {
        Debug.WriteLine(conn.ConnectionString);

        sql = @"Select AlignmentName + '::AlnID' + cast(AlnID as varchar(10))
                From [crwdb].[dbo].[Alignment]";
        cmd.CommandText = sql;

        var list = new List<string>();
        using (conn)
        {
            conn.Open();
            using (SqlDataReader reader = cmd.ExecuteReader())
            {
                while (reader.Read())
                {
                    list.Add((string)reader.GetString(0));
                }
            }
        }
        conn.Close();
        //conn.Dispose();

        return list;
    }

    public static int ParseAlnEntry(string alnEntry)
    {
        Regex reg = new Regex(@"^.+?\:{2}AlnID(\d+)$");
        Match m;
        int alnID = -1;
        if ((m = reg.Match(alnEntry)).Success)
        {
            alnID = Convert.ToInt32(m.Groups[1].Value);
        }

        return alnID;
    }

    public List<PhylNode> ReadSeqTaxTree(int alnID, int seqTypeId, int locationID, int rootTaxID, int depth)
    {
        Debug.WriteLine(string.Format("\n{0}\n{1}",conn.ConnectionString, sql));

        // SQL query
        sql = @"Execute [crwdb].[dbo].[sp_SeqDistribution] 
                    @AlnID, @SeqTypeID, @LocationID, @RootTaxID, @Depth";
        cmd.CommandText = sql;

        // Add parameters
        AddParameter("@AlnID", alnID);
        AddParameter("@SeqTypeID", seqTypeId);
        AddParameter("@LocationID", locationID);
        AddParameter("RootTaxID", rootTaxID);
        AddParameter("Depth", depth);

        var tree = new List<PhylNode>();

        using (conn)
        {
            conn.Open();
            using (SqlDataReader reader = cmd.ExecuteReader())
            {
                int tmpTaxID, tmpParentID, tmpSeqNum;
                string tmpLineage;
                while (reader.Read())
                {
                    tmpTaxID = (int)reader.GetInt32(0);
                    tmpParentID = (int)reader.GetInt32(1);
                    tmpLineage = (string)reader.GetString(2);
                    tmpSeqNum = (int)reader.GetInt32(3);
                    if (tmpSeqNum > 0)
                    {
                        tree.Add(new PhylNode(tmpTaxID, tmpParentID, tmpLineage, tmpSeqNum));
                    }
                }
            }
        }
        conn.Close();
        //conn.Dispose();

        return tree;
    }
} 
```

我创建了一个 SQLRead 实例，将它传递给下一个窗口（通过构造函数），然后调用 ReadAlnName 方法，它可以工作。

```
public partial class DBModeMainWindow : Window
{
    // The database connection
    SQLRead Conn;

    // The phylogenetic tree
    List<PhylNode> tree;

    public DBModeMainWindow(SQLRead conn)
    {
        InitializeComponent();
        Conn = conn;

        List<string> alnStr = Conn.ReadAlnName();
        AlnViewModel alnVM = new AlnViewModel(alnStr);
        DataContext = alnVM;
    }

    private void buttonGetTree_Click(object sender, RoutedEventArgs e)
    {
        string selectedAlnEntry = comboBoxAln.SelectedValue.ToString();
        int alnID = SQLRead.ParseAlnEntry(selectedAlnEntry);
        MessageBox.Show(string.Format(
            "Selected item: {0}. \nAlnID:{1}", selectedAlnEntry, alnID));

        tree = Conn.ReadSeqTaxTree(1, 1, 1, 2, 3);
    } 
```

比我添加一个按钮，当用户单击按钮时，后面的代码将调用 Conn.ReadSeqTaxTree 方法。但是这一次，我得到一个错误“连接字符串没有被初始化”。

我在那里错过了什么吗？任何建议将不胜感激。

# ruby - yaml格式的字符串文字@的格式是什么？

> ID：13426194
> 
> 赞同：0
> 
> 时间：2012-11-17T00:02:21.270
> 
> 标签：ruby, yaml

我有一个 twitter 用户的哈希表。

```
tweeter1: @jack
tweeter2: @jill
tweeter3: @john 
```

但是因为`@`，我不能`YAML.load`存档。

它抛出的错误是`Psych::SyntaxError: (<unknown>): did not find expected node content while parsing a flow node at line 1 column 11`

你如何`@`在 YAML 中使用字符串文字？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T00:12:37.883

只需双引号您的价值观：

```
tweeter1: "@jack"
tweeter2: "@jill"
tweeter3: "@john" 
```

那么你在阅读时应该会得到预期的 Hash：

```
{
    "tweeter1" => "@jack",
    "tweeter2" => "@jill",
    "tweeter3" => "@john"
} 
```

您可以随时访问[yaml.org](http://yaml.org/)了解有关 YAML 格式的详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T00:12:52.320

你不`YAML.load`归档，你使用`YAML.load_file`.

否则，如果字符串显然不是整数，通常我们可以使用裸值，但是您可以通过将其嵌入双引号中来强制它为字符串：

```
tweeter1: "@jack"
tweeter2: "@jill"
tweeter3: "@john" 
```

当我处理 YAML 格式问题时，我会先在 Ruby 中创建结构，然后让 YAML 为我创建它，然后将其用作模型：

```
require 'yaml'

asdf = {
  'foo' => '@foo'
}

puts asdf.to_yaml 
```

输出：

```
---
foo: ! '@foo' 
```

然后，我会做一个往返测试，如果我把我输入的东西拿出来，我会很高兴：

```
pp YAML.load(asdf.to_yaml)
{"foo"=>"@foo"}
{
    "foo" => "@foo"
} 
```

请注意`"@foo"`，尽管 YAML 正在使用`! '@foo'`，但它仍然有效，但这不是必需的：

```
asdf = '
---
foo: "@foo"
'
YAML.load(asdf)
{
    "foo" => "@foo"
} 
```

# asp.net - linq中的多个连接

> ID：13426196
> 
> 赞同：0
> 
> 时间：2012-11-17T00:02:29.017
> 
> 标签：asp.net, sql-server, linq, join

我刚刚了解了 asp.net 的工作原理，我正在尝试编写一个具有多个连接的 linq 语句，但我似乎没有让它工作。

我有 4 张桌子：

*   比赛（包含多轮）
*   回合（有多个条目）
*   条目（可能出现在多轮中）
*   RoundEntry（包含 Round 和 Entry 的主键以组合它们）

我要你进入页面competition.aspx 我要显示不同轮次内输入的条目。

有人可以帮助我发表声明，以及如何建立我的页面的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:15:23.593

假设您有名为的数据上下文`db`并且表有名为 的键`Id`。

```
var entries = from e in db.Entry
              join re in db.RoundEntry on e.Id equals re.EntryId
              join r in db.Round on re.RoundId equals r.Id
              select e; 
```

# mysql - MySQL：如何在 WHERE 子句中批量选择具有多对的行

> ID：13426203
> 
> 赞同：16
> 
> 时间：2012-11-17T00:02:59.303
> 
> 标签：mysql, sql, mysql-5.5

假设我有一张桌子，`email_phone_notes`看起来像这样：

```
+-----------------------+--------------+------+-----+---------+-------+
| Field                 | Type         | Null | Key | Default | Extra |
+-----------------------+--------------+------+-----+---------+-------+
| email                 | varchar      | NO   | PRI | NULL    |       |
| phone                 | varchar      | NO   | PRI | NULL    |       |
| notes                 | text         | NO   |     | 0       |       |
+-----------------------+--------------+------+-----+---------+-------+ 
```

因此，每个电子邮件/电话组合都是唯一的，但您可以拥有多个具有不同电话号码的电子邮件地址，反之亦然。这有点做作，但它反映了我的情况。

我想做这样的查询：

```
SELECT * FROM email_phone_notes  WHERE email = 'foo@bar.com' AND phone = '555-1212'; 
```

但是，我想一次做多对，所以我不必做几个`SELECT`查询。将这对组合在一起也很重要，因为我不想退回未要求的错误电话/电子邮件组合。

我可以做这样的事情，但是对于几百个值的可能性，查询会很长。

```
SELECT * FROM email_phone_notes WHERE ( 
  (email='foo@bar.com' && phone='555-1212') || 
  (email='test@test.com' && phone='888-1212') || 
   ... 
```

有没有更优雅的解决方案，或者我应该坚持这个？谢谢！

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-11-17T00:07:41.190

如果你追求优雅的 SQL，你可以使用行构造函数：

```
SELECT * FROM email_phone_notes WHERE (email, phone) IN (
  ('foo@bar.com'  , '555-1212'),
  ('test@test.com', '888-1212')
  -- etc.
); 
```

但是，这根本不适合索引，并且不建议在任何显着大小的表上使用。相反，您可以用您想要的对实现一个表并将其与您的表连接：

```
SELECT * FROM email_phone_notes NATURAL JOIN (
  SELECT 'foo@bar.com' AS email, '555-1212' AS phone
UNION ALL
  SELECT 'test@test.com', '888-1212'
-- etc.
) t; 
```

或者预填充一个（临时）表：

```
CREATE TEMPORARY TABLE foo (PRIMARY KEY (email, phone)) Engine=MEMORY
  SELECT email, phone FROM email_phone_notes WHERE FALSE
;

INSERT INTO foo
  (email, phone)
VALUES
  ('foo@bar.com'  , '555-1212'),
  ('test@test.com', '888-1212')
  -- etc.
;

SELECT * FROM email_phone_notes NATURAL JOIN foo; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T00:10:47.810

您可以使用这样的[行构造函数](http://dev.mysql.com/doc/refman/5.5/en/row-subqueries.html)：

```
SELECT *
FROM email_phone_notes
WHERE (email, phone) IN (
  ('foo@bar.com', '555-1212'),
  ('test@test.com', '888-1212')
) 
```

[SQLfiddle 示例](http://sqlfiddle.com/#!2/55dd5/1/0)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-03-09T10:38:19.213

早在 10 年前就提供了较早的答案。现在是 2020 年，答案似乎已经改变。

**简短回答**：使用[行构造函数](https://dev.mysql.com/doc/refman/5.7/en/row-constructor-optimization.html)语法 - 优化器可能（或可能不）使用索引。

在[此示例](http://sqlfiddle.com/#!9/f9a636/4)中，优化器能够使用索引，即使行构造函数没有覆盖索引的前缀。

# angularjs - 如何检测位置变化

> ID：13426204
> 
> 赞同：20
> 
> 时间：2012-11-17T00:03:20.830
> 
> 标签：angularjs

我有一个显示页面导航菜单的控制器。菜单有一系列项目，每个项目都有一个标题和一个链接。我还在每个项目上设置了一个标志，指示当前是否显示相关页面：

```
module.controller('MenuContr', [
    /******/ '$scope', '$location',
    function ($scope,   $location) {
        $scope.items = [
            {text: 'page 0',
             href: '#/page-0',
             current: $location.path() === '/page-0'},
            {text: 'page 1',
             href: '#/page-1',
             current: $location.path() === '/page-1'}
        ]; 
```

在我的模板中：

```
<ul class="menu" ng-controller="MenuContr" ng-cloak>
  <li ng-repeat="item in items" ng-switch on="item.current">
    <span class="current" ng-switch-when="true">{{item.text}}</span>
    <a ng-switch-default ng-href="{{item.href}}">{{item.text}}</a>
  </li>
</ul> 
```

我需要能够在位置更改时更新菜单，它是如何完成的？有我可以订阅的活动吗？

编辑：除了在我的路由中定义的控制器之外，还使用了这个控制器，并且上面的模板放置在包含`ng-view`指令的元素之上。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-17T00:30:02.680

回答我自己的问题，在我的`MenuContr`：

```
 $scope.$on('$routeChangeSuccess', function () {
            var items = $scope.items;
            var path = $location.path();

            for (var i = 0; i < items.length; i++) {
                var item = items[i];
                var href = item['href'];
                item['current'] = !!href && href.substring(1) === path;
            }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T11:18:29.337

您是否会在路线更改时使用同一个控制器？是您在 AppsModule.config 的 $routeProvider 中定义的方式吗？如果你想要额外的过滤，你可以将 $routeParams 传递给同一个控制器。

您已经在控制器启动时初始化了对象。因此，一旦更改链接，将调用相同的控制器，您无需执行任何其他操作。根据选择的路线，项目将得到更新。

# php - mysqli 和 AJAX

> ID：13426212
> 
> 赞同：0
> 
> 时间：2012-11-17T00:04:20.993
> 
> 标签：php, jquery, ajax, mysqli

我在尝试从 MySQL 切换到 MySQLi 时感到很困惑，我只是在尝试一个非常基本的示例，看看我是否可以让它工作。请原谅使用 .post 而不是 .ajax 并且暂时不返回 JSON 的不良做法，我只是使用一些旧代码来查看是否可以使查询正常工作。

目前，在 index.php 上，我创建了一个新连接：

```
$connection = new mysqli($host, $username, $password, $database);
if (mysqli_connect_errno()) die(mysqli_connect_error()); 
```

然后，在我的 scripts.js 文件上使用 jquery，我收集我的变量并将它们发送到一个处理文件：

```
 $("#toolbarTitle-Login").click(function() {
        var loginEmail = $("#toolbarTextbox-Email").val();
        var loginPassword = $("#toolbarTextbox-Password").val();
        if (loginEmail != "") {
            $.post(
                'ajax/loginProcess.php', 
                {
                    'email': loginEmail,
                    'password': loginPassword
                },
                function (response) {
                    $(".testingBox").html(response);
                }
            );
        }
    }); 
```

现在，在我的处理文件 loginProcess.php 中，我进行了一个查询：

```
$passwordMd5 = md5($_POST["password"]);
$email = $connection->$_POST["email"];
$password = $connection->$passwordM5;

$sql = $connection->prepare("SELECT clientId, studentEmail, parentEmail, school
                                                    FROM clients
                                                    WHERE (studentEmail = ? AND studentPassword = ?) OR (parentEmail = ? AND parentPassword = ?);");

$statement->bind_param("ssss",$email,$password,$email,$password);

$row["id"] = 0;
$row["studentEmail"] = '';
$row["parentEmail"] = '';
$row["school"] = '';

$statement->bind_result($row["id"], $row["studentEmail"], $row["parentEmail"], $row["school"]);
$statement->execute();

while($statement->fetch()) {
    print  $row["id"].' '.$row["studentEmail"].' '.$row["parentEmail"].' '.$row["school"].'<br />';
} 
```

这会导致“致命错误：在“/home/guysandd/public_html/test/v3/ajax/loginProcess.php on line 8”中的非对象上调用成员函数 prepare()。我认为这意味着它是不认识我的连接，但我不确定如何让它做到这一点。另外，我想知道 mysqli_real_escape_string 是否是必要的，因为参数是分开的。

编辑：澄清一下，我正在处理的网站有两个登录帐户：父母和学生。查询返回信息后，我检查他们是家长还是学生，这会改变内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:09:11.667

你需要写这部分

```
$connection = new mysqli($host, $username, $password, $database);
if (mysqli_connect_errno()) die(mysqli_connect_error()); 
```

再次进入`loginProcess.php`，因为没有活动的数据库连接

## 编辑

在这种情况下，您将不得不创建一个持久连接。[来自 PHP 手册](http://www.php.net/manual/en/mysqli.persistconns.php)

与 mysql 扩展不同，mysqli 没有提供单独的函数来打开持久连接。要打开持久连接，您必须`p:`在连接时添加主机名。

# arrays - Scala：将文件逐行读入列表数组

> ID：13426213
> 
> 赞同：2
> 
> 时间：2012-11-17T00:04:23.193
> 
> 标签：arrays, scala, functional-programming

我正在逐行读取文件并放入列表中。所以，如果我的文件有 10 行，我就有十个列表。现在，在执行此操作或执行此操作之后，我想将所有列表添加到一个数组中。所以，我有一个列表数组，没有使用“var”，所以基本上只是“val”。这是我到目前为止所拥有的：

```
 val fileLines = Source.fromFile(filename).getLines.toList

    for (line <- fileLines) {
    if (!line.isEmpty) 
     println((line.toList).filter(e => e != ' '))
    } 
```

我只是将每一行转换为一个列表并删除空白元素。如何从中生成列表数组？数组是 val 类型，而不是尝试 var。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T00:12:52.243

你可以尝试这样的事情：

```
val myArray = fileLines.filterNot(_.isEmpty).map { line =>
    (line.toList).filter(e => e != ' ')
}.toArray 
```

这将为您提供一个列表元素数组。`.toArray`如果你想要一个列表列表，你可以删除最后的。

# c# - 如何在 statusstrip 上添加 1 个进度条以指示每个选项卡上每个 webbrowser 的加载？

> ID：13426216
> 
> 赞同：0
> 
> 时间：2012-11-17T00:04:31.583
> 
> 标签：c#, progress-bar, webbrowser-control, tabcontrol, statusstrip

我目前正在使用具有不同预定义功能的 c# 开发定制的 Web 浏览器。我遇到的问题之一是在状态条上添加进度条。我用来实现此目的的第一种技术是获取**webBrowser.Doument.Title并在触发****webBrowser_Navigated**事件时将其扔到**状态条标签上。**现在这是可以接受的，因为它工作正常，但是当我决定让我的 webBrowser 能够添加新标签时，我的工作变得更加困难。我使用了**扩展网络浏览器******让我实现这一点，我在 SO 也发现了这一点。以下是经常让我头疼的问题。我是 c# 的新手，所以对我来说，我认为这个问题非常困难。=)****

 ****```
private void web_Navigated(object sender, WebBrowserNavigatedEventArgs e)
    {
        ExtendedWebBrowser web_navigated = new ExtendedWebBrowser();
        statusLoading.Text = "Loading " + ((ExtendedWebBrowser)TabControl1.SelectedTab.Controls[0]);
    } 
```

1.  加载标签的文本仅显示选定的选项卡，当您单击其他选项卡时，它仍将显示您之前导航的特定页面的加载状态，而不是您当前所在选项卡的状态。我认为这是无可争辩的，因为我在导航事件上使用了这条线。除了 selectedTab.Controls[0] 之外，我找不到任何其他调用 tabBrowser 的方法。我不确定这里的工作是否以编程方式在每个选项卡上添加一个状态栏，我不知道该怎么做，甚至不知道它是否可能。

2.  既然我已经提到了浏览器上的选项卡，如果我可能会问是否可以在选项卡标题的一侧添加一个加载 gif，指示该选项卡上的浏览器仍在加载？如果有人能教我如何做到这一点，那对我来说是一个巨大的帮助。=)

3.  正如我所说，我正在使用标签来指示我的浏览器正在加载，正如标题所暗示的那样，我希望并且我祈祷我可以让它成为一个进度条。标签的问题在于，当浏览器的页面加载时间过长时，用户会认为我的系统没有做任何事情。

所以这涵盖了所有内容，我感谢所有帮助我解决上一个问题的人，这个问题有点棘手，我希望我把这个问题说得很清楚。这是我用来实例化 ExtendedWebBrowser 的代码，我创建了一个函数“OpenNewTab()”，这样当我调用它时，它会自动生成一个新选项卡和一个浏览器。

```
private void OpenNewTab(string url, string title="New Tab")
    {
        web = new ExtendedWebBrowser();
        web.ScriptErrorsSuppressed = true;
        web.Dock = DockStyle.Fill;
        web.Visible = true;
        web.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(web_DocumentCompleted);
        web.Navigated += new WebBrowserNavigatedEventHandler(web_Navigated);
        web.Navigating += new WebBrowserNavigatingEventHandler(web_Navigating);
        InitializeBrowserEvents(web);
        TabControl1.TabPages.Add(title + "  x");
        TabControl1.SelectTab(page_counter);
        TabControl1.SelectedTab.Controls.Add(web);
        page_counter++;
        ((WebBrowser)TabControl1.SelectedTab.Controls[0]).Navigate(url);
    }
//I am not sure if i should include other browser events here, as you can see the other three are up there. =)
    private void InitializeBrowserEvents(ExtendedWebBrowser SourceBrowser)
    {
        SourceBrowser.NewWindow2 += new EventHandler<NewWindow2EventArgs>(SourceBrowser_NewWindow2);
    }
    //This event right here is the one responsible for catching the open in a new window and throwing it to a 
    //new tab, because the open in a new tab is always disabled at web browser i presumed this is the only option they  
    //have, whoever made the ExtendedWebBrowser I thank you for this code he gains all the credit. =)   
    private void SourceBrowser_NewWindow2(object sender, NewWindow2EventArgs e)
    {
        TabPage NewTabPage = new TabPage()
        {
            Text = "New Tab x"
        };
        web = new ExtendedWebBrowser()
        {
            Parent = NewTabPage,
            Dock = DockStyle.Fill,
            Tag = NewTabPage
        };
        web.DocumentCompleted += new WebBrowserDocumentCompletedEventHandler(web_DocumentCompleted);
        web.Navigated += new WebBrowserNavigatedEventHandler(web_Navigated);
        e.PPDisp = web.Application;
        InitializeBrowserEvents(web);
        TabControl1.TabPages.Add(NewTabPage);
        TabControl1.SelectedTab = NewTabPage;
        page_counter++;
    } 
```****

# c++ - 基类的未定义模板参数

> ID：13426219
> 
> 赞同：4
> 
> 时间：2012-11-17T00:05:13.783
> 
> 标签：c++, templates, inheritance, nested

我很确定我已经阅读了编译器无法在 SO 上的某个地方处理此代码的原因，但是，经过几个小时的搜索，我仍然找不到它。以下是相关代码：

```
#include <iostream>

template <typename T>
class base
{
};

class derived : base<derived::myStruct>
{
public:
    struct myStruct
    {
    };
};

int main ()
{
    return 0;
} 
```

问题是解析器首先尝试`base<derived::myStruct>`在 parsing 之前生成专业化`derived`，因此，我收到此错误：“error C2065: 'myStruct' : undeclared identifier”。`struct myStruct;`作为一个愚蠢的技巧，我注意到如果我在上面预先声明 VS2010 就会停止抱怨`class derived`。在我看来，`myStruct`应该绑定在里面`derived`，这段代码应该抛出同样的错误：

```
#include <iostream>

template <typename T>
class base
{
};

struct myStruct;

class derived : base<derived::myStruct>
{
public:
    struct myStruct
    {
    };
};

int main ()
{
    return 0;
} 
```

**更新**：gcc-4.5.1 能够[抛出预期的错误](http://ideone.com/GgMOxT)，所以，我猜上面是 VS2010 中的一个错误......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:26:00.313

`derived::myStruct`在这一点上只是一个不完整的类型。您的第二个示例也不应该工作，不幸的是 MSVC 编译器接受了很多格式错误的模板代码。一种解决方法是使用中间类来确保类型是完整的：

```
template <typename T>
class base
{
};

class middle
{
public:
    struct myStruct
    {
    };
};

class derived : public middle, base<middle::myStruct>
{
};

int main ()
{
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:24:51.590

一种解决方法是`myStruct`在`derived`.

```
#include <iostream>

template <typename T>
class base
{
};

struct derived_myStruct
{
};

class derived : base<derived_myStruct>
{
public:
    typedef derived_myStruct myStruct;
};

int main ()
{
    return 0;
} 
```

在更复杂的情况下，`derived`模板类`derived_myStruct`也是模板类，具有相同的模板参数（或只是一个子集），您可以通过这些模板类。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T00:11:43.150

在 C++ 中，您只能在定义名称后引用它们。因为`derived`当您引用嵌套在内部的类来定义基类时，显然还没有定义`derived`，所以这是行不通的。事物在被访问后被声明的例外是在类定义中定义的成员的函数体：这些被视为在类定义之后实际定义的。

# vb.net - 在 Visual Basic 2010 中的两个标记之间删除 txt 文件中的文本

> ID：13426221
> 
> 赞同：1
> 
> 时间：2012-11-17T00:05:44.600
> 
> 标签：vb.net, visual-studio-2010

我在 Visual Basic 2010 中制作了一个应用程序，它可以让我轻松地为我的 XAMPP 本地托管站点创建 .dev 网址。

到目前为止，我已经设法添加到必要的文件中，但没有删除。

我需要一种方法来删除 txt 文件中两个标记之间的所有文本。例如：

```
120.0.0.1    localhost
120.0.0.1    alsolocalhost

##testsite.dev#start#
127.0.0.1    testsite.dev
##testsite.dev#stop#

##indevsite.dev#start#
127.0.0.1    indevsite.dev
##indevsite.dev#stop# 
```

我想删除 ##testsite.dev#start# 和 ##testsite.dev#stop# 标记之间的所有文本，以及删除标记本身。

在我的 Visual Basic 代码中，这是我目前所拥有的：

```
Sub removeText(ByVal siteName)
    Dim fileName As String = "hosts.txt"
    Dim startMark As String = "##" + siteName + "#start#"
    Dim stopMark As String = "##" + siteName + "#stop#"

    'Code for removing text...

End Sub 
```

我现在需要的是能够删除我想要的文本，而无需触及任何其他文本（这包括不弄乱它的格式）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:26:09.963

全部读取，制作备份副本，然后逐行写入检查当前块状态（内部/外部）

```
Sub removeText(ByVal siteName)
    Dim fileName As String = "hosts.txt"
    Dim startMark As String = "##" + siteName + "#start#"
    Dim stopMark As String = "##" + siteName + "#stop#"

    ' A backup first    
    Dim backup As String = fileName + ".bak"
    File.Copy(fileName, backup, True)

    ' Load lines from the source file in memory
    Dim lines() As String = File.ReadAllLines(backup)

    ' Now re-create the source file and start writing lines not inside a block
    Dim insideBlock as Boolean = False
    Using sw as StreamWriter = File.CreateText(fileName)
        For Each line As String in lines
            if line = startMark
               ' Stop writing
               insideBlock = true 

            else if line = stopMark
               ' restart writing at the next line
               insideBlock = false 

            else if insideBlock = false
               ' Write the current line outside the block
               sw.WriteLine(line) 
            End if
        Next         
    End Using
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:22:17.477

如果文件不是很大，您可以将整个内容读入一个字符串并像这样删除：

```
 Dim siteName As String = "testsite.dev"
    Dim fileName As String = "hosts.txt"
    Dim startMark As String = "##" + siteName + "#start#"
    Dim stopMark As String = "##" + siteName + "#stop#"
    Dim allText As String = IO.File.ReadAllText(fileName)
    Dim textToRemove = Split(Split(allText, startMark)(1), stopMark)(0)
    textToRemove = startMark & textToRemove & stopMark

    Dim cleanedText = allText.Replace(textToRemove, "")

    IO.File.WriteAllText(fileName, cleanedText) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T00:22:47.650

使用*通常*的方式，您可以通过以下方式实现您的目标：

```
 Dim startmark, stopmark As String
    Dim exclude As Boolean = False

    Using f As New IO.StreamWriter("outputpath")
        For Each line In IO.File.ReadLines("inputpath")
            Select Case line
                Case startmark
                    exclude = True
                Case stopmark
                    exclude = False
                Case Else
                    If Not exclude Then f.WriteLine()
            End Select
        Next
    End Using 
```

完成后，删除“旧”文件并重命名新文件。

# javascript - 视觉工作室抱怨没有声明变量

> ID：13426222
> 
> 赞同：2
> 
> 时间：2012-11-17T00:05:46.893
> 
> 标签：javascript, asp.net, code-behind

我有一个带有以下脚本的 aspx 页面：

```
<script type="text/javascript"> var dataPoints = '<%= dataPoints %>'; </script> 
```

我在代码中填充这个变量，如下所示：

```
Dim dataPoints = objStringBuilder.ToString()
Context.Response.AppendHeader("dataPoints", dataPoints) 
```

`dataPoints`我从后面的代码中填充变量。但是，突然之间，visual studio 一直`Name 'dataPoints' is not declared` **在 aspx 文件中**告诉我并且不再构建。它指的是`'<%= dataPoints %>'`允许后面的代码将数据传递给 javascript 变量的指令。这在生产中有效，但我的开发环境现在正在抱怨。我给它起什么名字也没关系，所以与 javascript 变量同名不是问题。

谁能告诉我为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:19:54.477

可能的原因：

*   `CodeBehind`没有为 ASP.NET 页正确设置属性
*   文件后面的代码未编译
*   包含代码背后代码的 dll 未部署到`bin`文件夹

# css - CSS 媒体查询不起作用？

> ID：13426223
> 
> 赞同：0
> 
> 时间：2012-11-17T00:05:52.440
> 
> 标签：css, media-queries

我正在尝试为使用 >800px 分辨率宽度的人隐藏一些 div。

我把这个：

```
@media only screen and (max-device-width: 799px) {
.well {
  display: hidden;
    } 
} 
```

在我的样式表中，但它似乎不起作用。我确定我错过了一些简单的东西，但我不知所措。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:10:04.287

**使用 >800px**所以如果屏幕更大，那么**我****试图隐藏一些`div`**

那么您的查询是错误的：

```
@media only screen and (min-device-width: 799px) {
.well {
  display: hidden;
    } 
} 
```

# javafx-2 - JavaFx中图像的子矩形

> ID：13426224
> 
> 赞同：2
> 
> 时间：2012-11-17T00:06:00.670
> 
> 标签：javafx-2

我有一个 javafx.scene.image.Image 并且需要创建一个带有子矩形的新图像。我已经尝试过 PixelReader.getPixels 但它要求 WritablePixelFormat 而我不知道如何使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-09T18:36:56.487

我建议你做的是实例化一个**[Canvas](http://docs.oracle.com/javafx/2/api/javafx/scene/canvas/Canvas.html)**只是你的子矩形的大小，并使用它的[GraphicsContext](http://docs.oracle.com/javafx/2/api/javafx/scene/canvas/GraphicsContext.html)在那里**绘制**你的源图像。之后，像使用 ImageView 一样使用 Canvas。

我在一个将图像切成薄片并给你的课程中这样做。

基本上步骤是：

1.  创建一个子矩形大小的 Canvas 节点
2.  获取该 Canvas 的 GraphicsContext
3.  使用您的图像作为源，在该画布上绘制
4.  将您的 Canvas 插入您的场景中，或任何适当的地方

这是进行绘图的 GraphicsContext：

```
public void drawImage(Image img,
             double srcX,
             double srcY,
             double srcWidth,
             double srcHeight,
             double destX,
             double destY,
             double destWidth,
             double destHeight) 
```

这是我在 Scala 中绘制图像“切片”的代码：

```
import javafx.scene.image.Image
import javafx.scene.canvas.Canvas

class Slicer(val img: Image, val xAmount: Int, val yAmount: Int) {

  val sliceWidth = img.getWidth() / xAmount
  val sliceHeight = img.getHeight() / yAmount

  def sliceAt(x: Int, y: Int): Canvas = {
    val canvas = new Canvas(sliceWidth, sliceHeight)
    val grContext = canvas.getGraphicsContext2D()

    val (sourceX, sourceY) = coordinatesOfSliceAt(x, y)
    val (destX, destY) = (0, 0)

    grContext.drawImage(img,
      sourceX, sourceY, sliceWidth, sliceHeight,
      destX, destY, sliceWidth, sliceHeight)

    canvas
  }

  def coordinatesOfSliceAt(x: Int, y: Int): (Int, Int) = {
    val coordX = ((x - 1) * sliceWidth).toInt
    val coordY = ((y - 1) * sliceHeight).toInt
    (coordX, coordY)
  }

} 
```

当我遇到这个时，我来到了这个解决方案：

[http://docs.oracle.com/javafx/2/image_ops/jfxpub-image_ops.htm](http://docs.oracle.com/javafx/2/image_ops/jfxpub-image_ops.htm)

相关部分是他们将原始图像的片段绘制到画布上。因此，无需处理 PixelReaders 或 Writers。

# c# - 指定的 Visual 已经是另一个 Visual 的子对象或组件目标的根

> ID：13426227
> 
> 赞同：2
> 
> 时间：2012-11-17T00:06:17.843
> 
> 标签：c#, wpf

嗨，伙计们，我一直在使用 WPF C# 工作和搜索报告，并找到了一份不错的报告，而且也很容易，找到了这个[链接](http://wpfreports.codeplex.com/releases/view/35201#ReviewsAnchor)并使用它。所以我尝试使用它，请检查我的代码，

在我`EmployeeProfileWindow`的打印按钮中，

```
private void btnprintviolation_Click(object sender, RoutedEventArgs e)
{
    ReportViolationWindow NewReportViolationWindow = new ReportViolationWindow();
    //Windows.Add(NewReportViolationWindow);
    GlobalVar.ViolationEmpNum = txtdispid.Text;
    GlobalVar.ViolationRefNumToPrint.Clear();
    for (int i = 0; i < lvviolations.Items.Count; i++)
    {
        GlobalVar.ViolationRefNumToPrint.Add(((EmpViolationObject)lvviolations.Items[i]).VioRefNum);
    }
    NewReportViolationWindow.Show();
} 
```

因此，如果我单击该按钮，它将出现一个新的窗口名称`NewReportViolationWindow`。我将在模板文件夹中复制或编辑开源示例中的内容。我创建了名为 的报告`ReportViolation`，

现在这里是后面的代码`NewReportViolationWindow`。

```
ReportDocument reportDocument = new ReportDocument();
string ats = new DirectoryInfo(Environment.CurrentDirectory).Parent.Parent.FullName;
StreamReader reader = new StreamReader(new FileStream(ats.ToString() + @"\Template\ReportViolation.xaml", FileMode.Open, FileAccess.Read));
reportDocument.XamlData = reader.ReadToEnd();
reportDocument.XamlImagePath = Path.Combine(ats.ToString(), @"Template\");
reader.Close();

DateTime dateTimeStart = DateTime.Now; // start time measure here
List<ReportData> listData = new List<ReportData>();
//foreach (string item in GlobalVar.ViolationRefNumToPrint)
for (int i = 0; i < 5 ; i++)
{
    ReportData data = new ReportData();

    data.ReportDocumentValues.Add("PrintDate", DateTime.Now);
    data.ReportDocumentValues.Add("EmpIDNum", NewIDNumber.ToString());
    data.ReportDocumentValues.Add("EmpName", NewEmpName.ToString());
    data.ReportDocumentValues.Add("EmpPosition", NewPosition.ToString());

    //data.ReportDocumentValues.Add("VioRefCode", item.ToString());
    listData.Add(data);
}

XpsDocument xps = reportDocument.CreateXpsDocument(listData);
documentViewer.Document = xps.GetFixedDocumentSequence();

// show the elapsed time in window title
Title += " - generated in " + (DateTime.Now - dateTimeStart).TotalMilliseconds + "ms";

}
catch (Exception ex)
{
    // show exception
    MessageBox.Show(ex.Message + "\r\n\r\n" + ex.GetType() + "\r\n" + ex.StackTrace, ex.GetType().ToString(), MessageBoxButton.OK, MessageBoxImage.Stop);
} 
```

现在，当我运行我的应用程序并单击打印按钮时。有时一开始它会毫无错误地打开，`NewReportViolationWindow`但是当我尝试关闭报告或再次单击按钮时，它会给出一条消息，

> 指定的 Visual 已经是另一个 Visual 的子对象或组件目标的根

这是错误的图像，

![在此处输入图像描述](../Images/0565c705cd50d96a2a597d4c7eb9ad07.png)

我认为问题是当我调用打印按钮后面的代码的打印报告时，任何人都可以吗？请... :)

# ****第二次编辑****

**关于你的问题：

*   您说报告窗口通常第一次打开时没有错误，但之后就没有了？

是，对的..

*   中是否有任何共享资源正在使用 `ReportViolationWindow`？

抱歉，我不知道我所做的只是遵循开源中的示例。

*   你是如何处理/处理关闭的 `ReportViolationWindow`？

到目前为止，我仍然没有正确关闭我的`ReportViolationWindow`. 当我单击关闭按钮时，就是这样，对不起。:(

*   您是否保留对此`ReportViolationWindow` 实例的任何其他引用？

没有。据我所知。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T02:06:25.057

您必须先将 Visual 从其当前父级“分离”，然后才能将其添加到新父级 - 原因主要是由于渲染和合成引擎的工作方式；如果原始父元素不知道它不再负责渲染该子元素，并且 WPF 允许您将其附加到另一个父元素，则在最好的情况下，您将渲染重复的视觉对象，而在最坏的情况下在这种情况下，您可能会陷入无限循环！

~~由于添加/删除子元素的责任在于父元素，因此您需要在父元素级别处理此问题，通常通过调用`RemoveLogicalChild`或`RemoveVisualChild`（或者理想情况下，从原始 ItemsSource 中删除项目本身并将其添加到新的一）~~

编辑：从技术上讲，第一段是正确的，但我认为第二段不适用于您......在查看[CodePlex 上的 WpfReports](http://wpfreports.codeplex.com/SourceControl/changeset/view/70298#847538)`ReportPaginator`类的源代码后，我注意到以下内容：

*   我相信最新版本与您的不同：# 行不太匹配。可能这是一个已修复的错误？
*   （挑剔）我不喜欢这段代码的结构（即报告引擎）......ArrayLists？单行 if/else/return 语句？*啊*

现在，对于您的实际问题：

*   您说报告窗口通常第一次打开时没有错误，但之后就没有了？

*   中是否有任何共享资源正在使用`ReportViolationWindow`？

*   你是如何处理/处理关闭的`ReportViolationWindow`？

*   您是否保留对此实例的***任何其他引用？***`ReportViolationWindow`

为了查看错误是否继续，我会尝试的一件事是`NewReportViolationWindow`在创建它的窗口中声明一个类型的单个成员变量（`EmployeeProfileWindow`），而不是这个：

```
private void btnprintviolation_Click(object sender, RoutedEventArgs e)
{
    ReportViolationWindow NewReportViolationWindow = new ReportViolationWindow(); 
```

尝试类似：

```
ReportViolationWindow _reportViolationWindow;
private void btnprintviolation_Click(object sender, RoutedEventArgs e)
{
    if(_reportViolationWindow != null)
    {
        _reportViolationWindow.Close();
        _reportViolationWindow = null;
    }
    _reportViolationWindow = new ReportViolationWindow(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-03T08:01:54.560

好的，我可能有一个解决方案。如果我将上面的第二个代码片段更改为

代码块

```
ContainerVisual smallerPage = new ContainerVisual( );

DrawingVisual pageVisual = page.Visual as DrawingVisual;

if ( pageVisual != null && pageVisual.Parent != null )

{

ContainerVisual parent = pageVisual.Parent as ContainerVisual;

parent.Children.Remove( pageVisual );

}

smallerPage.Children.Add( page.Visual ); 
```

它似乎工作。请评论。我很想知道是否有更好的方法。这似乎是一个黑客。**

# ruby-on-rails - 使用 collection_singular_ids=ids 而不保存到数据库

> ID：13426229
> 
> 赞同：4
> 
> 时间：2012-11-17T00:06:21.347
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在 Rails 中，我使用该`other_ids=[...]`方法在关联上分配连接`has_many :through`。它工作正常，除非我不想将其提交`other_ids=[...]`到数据库（使用此方法分配会自动保存）。

有没有办法在使用 Model.new 时分配这些连接？当我提交一个包含关系复选框的表单时，这很有用的一个例子`has_many`。当表单未保存（验证失败时）时，选定的复选框将被重置。

模型：

```
class Job < ActiveRecord::Base
  has_many :categories
  attr_accessible :category_ids
end 
```

看法：

```
select :category_ids, Category.all.collect {|x| [x.name, x.id]}, {}, {:multiple => true} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:36:25.920

这很奇怪。我的意思是，我理解它为什么会保存，因为它是其他记录的关系，而不是您正在使用的记录，但我认为在 AR 中实现该功能应该很简单。

无论如何，您可以执行以下操作来解决此问题。使用虚拟属性

```
class Bar < ActiveRecord::Base
  after_save :save_foos
  has_many :foos

  attr_accessor :temp_foo_ids # Bad name for it but whatever...
  attr_accessible :temp_foo_ids

  def save_foos
    foo_ids = temp_foo_ids  # it should save the record like this again right?
  end
end 
```

在视图中，您还将使用 virtual 属性

```
select :temp_foo_ids, Foo.all.collect {|x| [x.name, x.id]}, {}, {:multiple => true} 
```

我没有对此进行任何测试，但我相信它会起作用；）

# android - 菜单android中的菜单项

> ID：13426231
> 
> 赞同：0
> 
> 时间：2012-11-17T00:06:39.167
> 
> 标签：android, menu, menuitem

我创建了一个嵌套菜单 menus.xml，当您触摸其中显示“@drawable/menu”菜单的项目时，想法是通过代码来做到这一点，谢谢。

我想做菜单。xml通过java代码，有什么想法吗？

```
<menu xmlns:android="http://schemas.android.com/apk/res/android" >
<item
android:icon="@drawable/menu"
android:showAsAction="ifRoom">
    <menu>      
        <item
            android:id="@+id/phone"
            android:title="VIVO"
            android:showAsAction="ifRoom|withText"    
            android:icon="@drawable/vivoon"
        />
        <item
            android:title="VOD"
            android:id="@+id/computer"
            android:showAsAction="ifRoom|withText"    
            android:icon="@drawable/vodon"
        />
    </menu>
</item> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:27:23.583

好的，由于我仍然不完全确定您想要什么，我认为您应该查看[此链接](http://developer.android.com/guide/topics/ui/menus.html)，我相信这就是您想要的。如果没有，请更具体地说明什么工作或不工作，或者你想要什么。

# java - Java Native 访问带有浮点指针的回调函数

> ID：13426233
> 
> 赞同：0
> 
> 时间：2012-11-17T00:06:43.240
> 
> 标签：java, callback, jna

我有一个 C++ DLL，它公开了以下函数。此函数立即调用回调函数 ( `GetProperty`)。我无法更改 C++ DLL

```
// c++
DllExport unsigned int RegisterCallbackGetPropertyReal( bool (*GetProperty)( UINT property_identifer, float * value ) ) ; 
```

我有一个 C# 应用程序，它使用[com.sun.jna](https://github.com/twall/jna)来访问 DLL 的这个函数。我已经到了从 c++ DLL 正确调用回调函数的地步，但我看不到找到一种方法来设置`float * value`

```
// Java 
public class main {
    public interface CBlargAPI extends Library {
        interface GetPropertyReal_t extends Callback {
            boolean invoke (int property_identifer, FloatByReference value);
        }
        int RegisterCallbackGetPropertyReal( GetPropertyReal_t getProperty ) ; 
    }

    public static void main(String[] args) throws Exception 
    {
        // Register call back functions         
        CBlargAPI.GetPropertyReal_t GetPropertyReal_fn = new CBACnetAPI.GetPropertyReal_t() {
            @Override
            public boolean invoke(int property_identifer, FloatByReference value) {
                System.out.println("GetPropertyReal_t: " )  ;
                value.setValue(97.5f); 
                return false; // [Edit] This is where the problem was. this should be `return true;` See my answer below. 
            }
        };
        CBlargAPI.INSTANCE.RegisterCallbackGetPropertyReal( GetPropertyReal_fn ) ;             
    }
} 
```

我所期望的是，当它返回到 c++ DLL 时，该值应该设置为 97.5f。相反，我得到默认值 0.000f

**我的问题是：**

*   如何使用 Jna 在 java 中正确设置浮点指针值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:11:17.490

这是一个其他人找不到的错字。基本上，如果我在`GetPropertyReal_fn`回调中返回 false，则将使用默认值`0.000f`。

我已经编辑了问题以显示错误在哪里。

# oop - MatLAB 中的类数组

> ID：13426234
> 
> 赞同：1
> 
> 时间：2012-11-17T00:06:45.270
> 
> 标签：oop, class, matlab

我想在 MatLAB 中创建一个卡片组类。这是我第一次使用 MatLAB 体验 OOP，而且我对 MatLAB 还很陌生。我正在考虑开设 2 节课：

1.  卡片（属性：类型 [1-4]，值 [1-13]）
2.  卡组（包含卡组中卡片的列表/向量，稍后我将定义此类的方法；洗牌、绘图卡等）

卡.m:

```
classdef card
   properties
      type;    % number: 1-4
      value;   % number: 1-13
   end
   methods
      function obj = card(type, value)
         % some code to check [type, value] should be inserted here
         obj.type = type;
         obj.value = value;
      end
   end
end 
```

这是我班级的原始结构，功能稍后会出现。现在 - 我如何定义甲板类？

我还希望能够让我的套牌类与我的卡片实例进行通信（以确保我调用正确的卡片：[card(1,1), card(1,2), card(1,3), . .., card(4, 13)]，例如。

有什么建议么？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:41:29.883

如果您想直接寻址到卡片组，则需要实现一个[subsref函数来处理卡片组对象的索引，即：](http://www.mathworks.nl/help/matlab/ref/subsref.html)

```
d = deck();
d(33) 
```

或添加带有索引参数的函数：

```
d = deck();
d.getCard(33) 
```

最后一个似乎更合适，也更容易实现：

```
classdef deck
    properties
        cardstack=card;
    end
    methods(Static)
        function obj = deck()
            obj.cardstack(1:52) = card(); % array creation, will fail if card has no parameterless constructor
            for ii=1:4
                for jj=1:13
                    obj.cardstack((ii-1)*13+jj) = card(ii,jj);
                end
            end
        end
    end
    methods
        function crd = getCard(obj, idx)
            if idx>=1 && idx<=52
                crd = obj.cardstack(idx);
            else
                error('Deck:getCard','Index out of range');
            end
        end
    end
end 
```

或者只是使用：

```
d.cardstack(33) 
```

这是一样的，没有明确的错误检查。

还要添加一个无参数的构造函数`card`，这样你就可以轻松地创建`card`数组：

```
function obj = card(type, value)
    if nargin==0
        % eg:
        type=NaN;
        value=NaN;
    end
    % some code to check [type, value] should be inserted here
    obj.type = type;
    obj.value = value;
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:06:39.393

也许您不需要将卡片组作为一个类，因为您可以使用`Card`对象数组执行大部分操作。这是一个例子。

```
classdef Card < handle
   properties
      type    % number: 1-4
      value   % number: 1-13
   end
   methods
      function obj = Card(type, value)
         % some code to check [type, value] should be inserted here
         obj.type = type;
         obj.value = value;
      end
      function c = get_card(obj, t, v)
          c = obj([obj.type] == t & [obj.value] == v);
      end
      function c_arr = get_cards_array(obj, t, v)
          c_arr = obj(ismember([obj.type], t) & ismember([obj.value], v));
      end      
      function print(obj)
          for k = 1 : numel(obj)
              fprintf('Card type = %g; value = %g\n', obj(k).type, obj(k).value);
          end
      end
   end
end 
```

以及用法：

```
%% build array
deck = Card.empty();
for type = 1 : 4
    for value = 1 : 13
        deck(end + 1, 1) = Card(type, value);
    end
end
%% if needed, you can reshape it into 4x13
deck = reshape(deck, 4, 13);
%% you can also use Card's methods from array:
>> deck.print
Card type = 1; value = 1
Card type = 1; value = 2
Card type = 1; value = 3
...
%% get certain card
c = deck([deck.type] == 3 & [deck.value] == 10);
c.print
%% shuffle 
idx = randperm(numel(deck));
deck = deck(idx); 
```

**更新：**将 get_card() 添加到 Card 的方法中（参见实现）：

```
>> c = deck.get_card(3, 10)    
c = 

  Card handle

  Properties:
     type: 3
    value: 10

  Methods, Events, Superclasses 
```

两个备注：

1) 如果这是您第一次使用 MatLAB 的 OOP，那么理解`classdef Card < handle`.

2）这是一个关于对象数组初始化的问题：[Matlab's arrayfun for uniform output of class objects](https://stackoverflow.com/questions/10897862/matlabs-arrayfun-for-uniform-output-of-class-objects)

**更新 2：**添加了 get_cards_array() 方法。用法：

```
%% get array of cards
t = [1, 2];
v = [5, 6, 12];
c = deck.get_cards_array(t, v);
>> c.print
Card type = 1; value = 5
Card type = 1; value = 6
Card type = 1; value = 12
Card type = 2; value = 5
Card type = 2; value = 6
Card type = 2; value = 12 
```

# php - Apache Localhost 下载 php 而不是执行，但只针对一个文件夹

> ID：13426235
> 
> 赞同：1
> 
> 时间：2012-11-17T00:06:52.860
> 
> 标签：php, macos, apache

因此，我在 OSX 上的 /Sites 目录中有多个符号链接的站点，因此它们出现在我的 localhost/~username 上，并启用了 php 和 apache。我最近将另一个站点导入该文件夹，当我尝试导航到 localhost 上的 index.php 文件时，我的浏览器提示我下载该文件。当我尝试导航到不同站点中的不同 *.php 文件时，页面会正确提供。任何线索发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:59:42.663

发现问题 - 原来我有一个 .htaccess 文件，因为这些文件与生产副本相同，并且该文件阻止我正常查看页面。删除它解决了这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:14:34.617

我曾经有过类似的事情，尝试检查文件夹权限以查看它们是否与本地主机中的其他文件/文件夹匹配。

# java - ZXing 2.1：com.google.zxing.NotFoundException

> ID：13426239
> 
> 赞同：3
> 
> 时间：2012-11-17T00:07:39.857
> 
> 标签：java, exception, barcode, zxing

我正在尝试使用[ZXing](http://code.google.com/p/zxing/ "中兴") 2.1 库获得成功的结果。我在 Mac OS X 10.7.5 上使用 Java 1.6。我能够对文本进行编码，但不能对任何图像进行解码。相反，我得到的只是`com.google.zxing.NotFoundException`.

这看起来很简单，但我无法弄清楚我做错了什么。这是一个简单的重现测试。它将几个条形码编码为图像，然后从内存中解码图像：

```
public class App {

    public static void main(String[] args) {

        // Try UPC-A.
        try {
            testEncodeDecode(BarcodeFormat.UPC_A, "012345678905");  // Valid UPC-A.
        } catch (Exception e) {
            e.printStackTrace();
        }

        // Try EAN-13.
        try {
            testEncodeDecode(BarcodeFormat.EAN_13, "9310779300005");  // Valid EAN-13.
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    public static void testEncodeDecode(BarcodeFormat barcodeFormat, String text)
        throws WriterException, NotFoundException, ChecksumException, FormatException, IOException {

        // Size of buffered image.
        int width = 200;
        int height = 100;

        // Encode to buffered image.
        Writer writer = new MultiFormatWriter();
        BitMatrix bitMatrix = writer.encode(text, barcodeFormat, width, height);
        BufferedImage bufferedImage = MatrixToImageWriter.toBufferedImage(bitMatrix);

        // Write to disk for debugging.
        String formatName = "png";
        File outputFile = new File(text + "." + formatName);    
        ImageIO.write(bufferedImage, formatName, outputFile);

        // Decode from buffered image.
        LuminanceSource source = new BufferedImageLuminanceSource(bufferedImage);
        BinaryBitmap bitmap = new BinaryBitmap(new HybridBinarizer(source));
        Reader reader = new MultiFormatReader();
        Result result = reader.decode(bitmap);

        // Never gets this far!
        System.out.println("result=" + result.getText());
    }
} 
```

输出将只是

```
com.google.zxing.NotFoundException
com.google.zxing.NotFoundException 
```

我难住了！谢谢你的帮助。附上输出图像供您参考。

UPC-A ![美国广播公司](../Images/92434cf61761b9f97605f1b8dcaa678b.png) EAN-13![定义](../Images/582be3d8976c344174e8902065e6d723.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-02T05:22:10.873

一开始我遇到了类似的问题，但通过提示为我解决了这个问题。你可以`TRY_HARDER`先尝试通过。它应该工作。如果没有，请尝试传递`POSSIBLE_FORMATS`提示，因为您已经知道格式。检查两个提示是否有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T20:28:20.477

简单地看一下，我认为问题在于两边都没有足够的安静区。规范 IIRC 需要左右 9 个模块，而这大约有 2 个。

检测器相当宽松，但没有那么多，以避免误报。通常，图像外部的区域被视为一个大的白色平面（实际上，这些扫描很好，在像本页这样的白色背景上）所以它会扫描。对于这种格式，我在代码中看到了一条注释，说明这是专门禁用的，以避免误报。

您可以尝试禁用此功能或生成更广泛的代码来测试它。如果您发现更改不会增加测试集中的误报但通过了测试，那么这可能值得提交。

# android - 在 View.dispatchRestoreInstanceState(View.java:9938) Android 4.0.3/4.0.4 出现 NullPointerException

> ID：13426244
> 
> 赞同：4
> 
> 时间：2012-11-17T00:08:15.397
> 
> 标签：android, nullpointerexception

找不到类似的问题，所以：我有一堆类似异常的报告。它并没有指向我的应用程序的任何地方。我假设当 App 试图恢复视图状态并且传递给容器的对象为空时，可能会发生这种情况。

我正在使用 android-support-v4 lib 片段 + [Parcelable](http://www.google.ru/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CBsQFjAA&url=http://developer.android.com/reference/android/os/Parcelable.html&ei=idSmUMHTB8mj4gSAnIDoCg&usg=AFQjCNHXgG4cAKxqG59cOZiKxahK2oLunA&sig2=ooy4UetF-tNrUzSQn-NYSw&cad=rjt)接口将数据存储在对话框片段中。API 16 的 Android 项目目标，使用 Project API 16。

据报道，此崩溃仅出现在 4.0.3 和 4.0.4 设备上。

有没有人遇到过这样的问题？

```
java.lang.RuntimeException: Unable to start activity ComponentInfo{com.my/com.my.activities.MyActivity}: java.lang.NullPointerException
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
at android.app.ActivityThread.handleRelaunchActivity(ActivityThread.java:3351)
at android.app.ActivityThread.access$700(ActivityThread.java:123)
at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1151)
at android.os.Handler.dispatchMessage(Handler.java:99)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
at android.view.View.dispatchRestoreInstanceState(View.java:9938)
at android.view.ViewGroup.dispatchRestoreInstanceState(ViewGroup.java:2318)
at android.view.View.restoreHierarchyState(View.java:9921)
at com.android.internal.policy.impl.PhoneWindow.restoreHierarchyState(PhoneWindow.java:1625)
at android.app.Activity.onRestoreInstanceState(Activity.java:906)
at android.app.Activity.performRestoreInstanceState(Activity.java:878)
at android.app.Instrumentation.callActivityOnRestoreInstanceState(Instrumentation.java:1100)
at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1934)
... 12 more 
```

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-12T06:27:46.447

再次发现一个肮脏的工作。

感谢 Bill Blume 阐明了造成问题的原因。

只需覆盖您的活动的 onRestoreInstanceState 方法并处理如下所示的异常。

```
@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    try{
        super.onRestoreInstanceState(savedInstanceState);
    }catch (Exception e) {
        System.out.println("Exce");
    }
} 
```

再次感谢比尔布鲁姆

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T02:03:15.273

我自己也遇到过这个错误。像你一样，我只通过崩溃报告收到此错误。我自己从来没有能够复制它。不幸的是，我还没有找到解决方案。不过，通过GrepCode查看Android源代码，我相信我已经掌握了一些线索。在 PhoneWindow.restoreHierarchyState() 中，崩溃发生在以下代码片段中的 restoreHierarchyState() 调用中：

```
if (mActionBar != null) {
    SparseArray<Parcelable> actionBarStates =
        savedInstanceState.getSparseParcelableArray(ACTION_BAR_TAG);
    mActionBar.restoreHierarchyState(actionBarStates);
} 
```

（取自[http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/com/android/internal/policy/impl/PhoneWindow.java#PhoneWindow .restoreHierarchyState%28android.os.Bundle%29](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.3_r1/com/android/internal/policy/impl/PhoneWindow.java#PhoneWindow.restoreHierarchyState%28android.os.Bundle%29) )

我的猜测是发生 NPE 是因为 actionBarStates 为空。4.1 或更高版本不会发生这种情况，因为 4.1 添加了对 actionBarStates 的空检查。

我真的不能说这是 4.0.x 操作栏、android 支持库的错误，还是您的操作栏/菜单配置中的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T00:33:54.593

您是否有任何机会使用意图获取/放置附加功能？您的日志中间有一个 NullPointerException，这可能是由于将 null 值放入 extras - [Android 应用程序无法启动活动组件信息](https://stackoverflow.com/questions/6900437/android-app-unable-to-start-activity-componentinfo)

# jquery - 滚动页面时如何使表单覆盖布局的内容

> ID：13426245
> 
> 赞同：0
> 
> 时间：2012-11-17T00:08:17.870
> 
> 标签：jquery, ruby-on-rails, jquery-ui

当我滚动页面的内容时，我使用[jScroll](http://www.wduffy.co.uk/jScroll/)来制作滚动元素。我曾经滚动其他元素，如侧边栏，它可以工作。但我不能用它来滚动表单搜索，这是我的问题索引页面：

[http://s18.postimage.org/5tv1zbjvd/scroll_filter.png](http://s18.postimage.org/5tv1zbjvd/scroll_filter.png)

当我滚动页面时，表单过滤器搜索仍然存在并且问题也存在。这是我用来滚动的代码：

```
<% content_for :head do %>
    <script type="text/javascript">
        $(document).ready(function(){ 
            $("#results").pageless( { 
                totalPages: 10,
                url: 'questions/',
                loaderMsg: 'Loading more results'       
             });
            $("#new_question").jScroll({top: 100 });
            $("#import").jScroll({top: 100});
        });
    </script>
<% end %> 
```

我滚动了侧边栏新问题并成功导入。我的表单标签搜索和过滤器位于`div#search`和中`div#filter`。所以我想问我怎样才能向下滚动内容，这些表格也会向下滚动，它们会放在问题内容的上方。您可以向我展示 jquery 可以做什么，而不必工作`jScroll`。

**更新：添加位置固定**

现在页面显示：

[http://s8.postimage.org/wq6fya3qd/scroll_filter_error.png](http://s8.postimage.org/wq6fya3qd/scroll_filter_error.png)

**形式**

```
<div class="span7">
        <div class="page-header">
            <%= render 'search' %>
            <%= render 'search_filter' %>
        </div>
        <div id="results">
            <ul class="questions">
                <%= render @questions %>
            </ul>
        </div>
</div> 
```

CSS：

```
div.page-header {
  position: fixed;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:54:05.720

[在此](http://jsbin.com/ekifem/1)示例`fixed`中使用 css`padding`或`margin`和`background`类似：

html:

```
 <div id="static">I'm A static header;</div>
  <div id="content">
  <div class="text">I'm a text box</div>
  <div class="text">I'm a text box</div>
  <div class="text">I'm a text box</div>
  <div class="text">I'm a text box</div>
  <div class="text">I'm a text box</div>
  <div class="text">I'm a text box</div>
  <div class="text">I'm a text box</div> 
```

CSS：

```
#content {
 padding-top: 100px;
}
#static {
 top: 0px;
 left: 0px;
 font-size: 2em;
 position:fixed;
 width: 100%;
 text-align: center;
 height: 100px;
 border: 1px solid black;
 background: white;
}
.text {
 background: skyblue; 
 font-size: 1.4em;
 height: 1em;
 margin-top: 10px;
 width: 80%;
 text-align: center;
 padding: 20px;
 border-top: 1px solid black;
 margin-left: 10%;
} 
```

# heroku - 更改 Heroku 启动参数

> ID：13426246
> 
> 赞同：1
> 
> 时间：2012-11-17T00:08:19.830
> 
> 标签：heroku

当我发出：heroku ps

我得到：

```
=== web: `java $JAVA_OPTS -Dspring.profiles.active=prod -jar target/dependency/webapp-runner.jar --port $PORT target/*.war` 
```

有没有办法将弹簧轮廓更改为不同的值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:07:59.643

You should be able to change the the spring profile using the cmd-line option `-Dspring.profiles.active=<profile name>` in your "Procfile" located at the root level of your Heroku app.

Hope this helps, Matthias

# php - 意外的 php 行为

> ID：13426248
> 
> 赞同：0
> 
> 时间：2012-11-17T00:08:33.483
> 
> 标签：php, html

我正在尝试学习 php，但是出了点问题...当我使用此代码时：

```
<html>
<head>
<title>My first PHP page</title>
</head>
<body>

<?php   

echo "<h1>Hello World!</h1>";

?>

</body>
</html> 
```

我应该只是得到Hello World！相反，我得到：Hello World！"; ?> 但是，如果我只是获取 php 代码，将其保存为 .php 文件并将我的浏览器指向该文件，它会以大粗体字母显示 Hello World，就像您所期望的那样。我'已经在我自己的计算机（运行 apache 和 PHP 5.3.15）和我的提供商的服务器上尝试过，但结果相同。我尝试了不同的浏览器，不同的计算机。我还尝试了其他示例教程（上面的例子是最简单的错误），但这些都不能正常工作。当我只打开 .php 文件时，使用 include() 函数读取文本文件有效，但当嵌入到html 文件。我自己还没有写过一个代码，一切都是复制/粘贴，有什么问题吗？试试看[http://www.raadvanarbeid.nl/index2.html](http://www.raadvanarbeid.nl/index2.html)和[http://www.raadvanarbeid.nl/index2.php](http://www.raadvanarbeid.nl/index2.php)对于上面的例子。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:10:11.920

您必须将*.html*文件重命名为*.php*以便服务器知道它应该呈现该文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:19:36.703

该文件需要由 PHP 解释器进行解释。因此，您需要一个网络服务器将其分流到 PHP 解释器，并且您需要为文件命名，以便网络服务器知道它应该由 PHP 解释器处理。这就是为什么文件名需要以“.php”结尾的原因，以及为什么当您直接访问文件与通过网络服务器访问文件时会得到不同的结果。

# java - 无法从 Java 代码运行 PATH 中的程序

> ID：13426251
> 
> 赞同：1
> 
> 时间：2012-11-17T00:08:40.473
> 
> 标签：java, macos, ffmpeg, red5

我正在 Mac 上开发 Red5 媒体服务器应用程序（Eclipse 中的动态 Web 项目）。该应用程序必须调用 FFMPEG 将视频转换为不同的格式。

我通过在终端中运行以下命令将“/Applications/FFMPEG”添加到 PATH 变量中：

```
echo 'export PATH=/Applications/FFMPEG:$PATH' >> ~/.profile 
```

当我从终端调用 FFMPEG 时，它工作正常。但是，每次我从 Java 代码运行它时：

```
Process p = Runtime.getRuntime().exec("ffmpeg");
p.waitFor(); 
```

我收到以下错误：

```
Cannot run program "ffmpeg": error=2, No such file or directory 
```

我认为这可能是特定于项目类型的安全限制，但即使是简单的 Java 程序也会产生相同的结果。我错过了什么？

* * *

将“ffmpeg”更改为应用程序的完整路径有效，但我不想将 FFMPEG 上传到生产服务器上与 Red5 相同的目录中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:16:28.350

`PATH`是命令提示符的东西。Java 对路径一无所知。

指定可执行文件的完整路径（即绝对路径）

# php - PDO 超出范围（PHP Composer）

> ID：13426252
> 
> 赞同：2
> 
> 时间：2012-11-17T00:08:42.917
> 
> 标签：php, pdo, composer-php

我刚开始使用 Composer 和它的 php 自动加载器。然后我使用 psr-0 将我自己的代码添加到自动加载器中。一切都很好，除非我想访问 PDO（新 PDO（...）。似乎它超出了范围，因为 Autoloader 期望它在我的包（称为 MyAPP）中。我得到的错误是：

> PHP 致命错误：在第 15 行的 /var/www/ws/src/MyApp/WsDatenbank.php 中找不到类 'MyApp\PDO'

我对谷歌的尝试以失败告终。
请帮助 - 提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:21:57.480

发表我的评论作为答案。

你必须这样做：（`new \PDO()`注意斜线）。执行此操作时，您正在加载全局命名空间的类。否则，它将从当前命名空间（在您的情况下`MyApp`）加载。

# javascript - 如何确定是否加载了弹出窗口中的内容

> ID：13426254
> 
> 赞同：2
> 
> 时间：2012-11-17T00:08:58.030
> 
> 标签：javascript

我需要为其父级的弹出窗口设置一些 contextData。我试试这个：

```
var some contextData = {};
$(function() {
    $('#clickme').click(function() {
        var w = window.open('http://jsfiddle.net');

        w.contextData = contextData            
        //w.context data is null in the popup after the page loads - seems to get overwritten/deleted
    });
}); 
```

它不起作用，所以我的下一个想法，等到内容加载

```
var some contextData = {};
$(function() {
    $('#clickme').click(function() {
        var w = window.open('http://jsfiddle.net');
        w.onload = function() {
            //Never Fires
            w.contextData = contextData;

        }
    });
}); 
```

看到[这个小提琴](http://jsfiddle.net/HNvn3/1/)。我的 onload 方法永远不会触发。

这有效：

```
var some contextData = {};
    $(function() {
        $('#clickme').click(function() {
            var w = window.open('http://jsfiddle.net');
            setTimeout(function(){
                if(w.someVariableSetByThePageBeingLoaded) {
                    w.contextData = contextData;
                }
                else{
                    setTimeout(arguments.callee, 1);
                }

            }, 1);
        });
    }); 
```

但有明显的优雅问题（但目前正在解决）。

我知道您可以采用另一种方式（将弹出窗口调用回打开器/父级上的方法，但这迫使我保持​​某种查找上下文的方式（并且我必须将上下文的密钥传递给弹出窗口）查询字符串）。当前的方法让我可以在闭包中捕获上下文，使我的弹出窗口成为一段更可重用的代码。

我不想做这个跨域 - 父级和弹出窗口都在同一个域中，尽管父级是一个 iframe（很难用 jsfiddle 测试）。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:17:20.173

如果您使用 iframe 执行此操作，请尝试这种方式

HTML

```
<button id="clickme">Click Me</button>

<iframe id="framer"></iframe> 
```

​</p>

Javascript

```
$(function() {
    $('#clickme').click(function() {
        $("#framer").attr("src","http://jsfiddle.net");
        $("#framer")[0].onload = function(){
            alert('loaded');
        };
    });
});​ 
```

我更新了你的 jsfiddle [http://jsfiddle.net/HNvn3/2/](http://jsfiddle.net/HNvn3/2/)

**编辑** 由于上述完全错误，这可能会为您指明正确的方向，但需要在真实环境中尝试以查看它是否有效。

`frames`应该设置全局变量，如果你

```
window.open("http://jsfiddle.net","child_window"); 
```

`frames["child_window"]`可能参考另一个窗口

在 jsfiddle 中尝试时出现 javascript 访问错误 - 所以这可能是正确的轨道

**编辑2**

在我的本地开发盒上试用，我能够完成这项工作

```
var w = window.open("http://localhost");
w.window.onload = function(){
    alert("here");
}; 
```

发生`alert()`在父窗口中

# python - 使用 SSH 保护 Python 聊天 - 如何？

> ID：13426256
> 
> 赞同：6
> 
> 时间：2012-11-17T00:09:14.300
> 
> 标签：python, security, ssh, network-programming, chat

我正在尝试使用 python 创建一个安全的聊天服务器，经过数小时的搜寻，我发现我应该使用 SSH，而且 Paramiko 似乎是最好的 python 模块（我可能错了）。虽然我不知道如何实现这一点，而且对 Python 还是很陌生，文档对我来说有点深，特别是因为我真的不知道要寻找什么！

任何指向示例代码的链接都将不胜感激，尤其是关于服务器（似乎有数百个关于连接到 ssh 服务器的示例，但没有关于创建它们的示例 - 我在这里遗漏了一些重要的东西吗？我听说可以在python中创建一个ssh服务器，但是互联网上明显缺乏代码让我担心）

谢谢

编辑：

我的最终目标是用 python 创建一个安全的聊天客户端，我希望它尽可能简单，但是，安全是主要目标。我最近看到并制作了几个聊天客户端，但是，它们需要 telnet 才能连接到它们，所以不安全，我希望纠正这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T00:41:33.670

试试[Twisted](http://twistedmatrix.com/)，这是一个用 Python 编写的异步网络引擎。他们有一个非常简单的例子，叫做[`chatserver.py`](https://twistedmatrix.com/documents/current/core/examples/index.html). 让它运行，然后使用[自签名 SSL 证书](http://www.akadia.com/services/ssh_test_certificate.html)让它[在 SSL 上侦听](http://twistedmatrix.com/documents/current/core/howto/ssl.html)。

这是[另一个例子](https://stackoverflow.com/questions/10054177/twisted-number-of-client-connections-to-tcp-server-limited)。

# python - Python在网格中的“b”周围放置1

> ID：13426258
> 
> 赞同：4
> 
> 时间：2012-11-17T00:09:51.710
> 
> 标签：python, grid, placement, minesweeper

我有一个看起来像这样的网格。我在网格中随机放置一个“b”并将数字 1 放在字母“b”周围。这似乎在任何地方都有效，除非应该将 1 放在底行和列一直到右边。例如，它看起来像这样

```
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 0 1 b
0 0 0 0 0 0 0 0 0 0 
```

它应该是什么样子

```
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0 1 1
0 0 0 0 0 0 0 0 1 b
0 0 0 0 0 0 0 0 1 1 
```

这是我正在使用的代码，我无法弄清楚为什么那些 1 没有被放置在那里。

```
from random import*
mat1 = []
mat2 = []

def makemat(x):
    for y in range(x):
        list1 = []
        list2 = []
        for z in range(x):
            list1.append(0)
            list2.append("-")
        mat1.append(list1)
        mat2.append(list2)
makemat(10)

def printmat(mat):
    for a in range(len(mat)):
        for b in range(len(mat)):
            print(str(mat[a][b]) + "\t",end="")
        print("\t")

def addmines(z):
    count = 0
    while (count < z):
        x = randrange(0,len(mat1))       
        y = randrange(0,len(mat1))      
        if mat1[y][x] == "b":
            count -= 1
        else:
            mat1[y][x] = "b"
        count += 1
addmines(1)

def addscores():
    for x in range(len(mat1)):
        for y in range(len(mat1)):
            if ((y < len(mat1)-1) and (x < len(mat1)-1)) and ((y >= 0) and (x >= 0))):
                if mat1[y+1][x] == "b":
                    mat1[y][x] = 1
                if mat1[y-1][x] == "b":
                    mat1[y][x] = 1
                if mat1[y][x+1] == "b":
                    mat1[y][x] = 1
                if mat1[y][x-1] == "b":
                    mat1[y][x] = 1
                if mat1[y+1][x+1] == "b":
                    mat1[y][x] = 1
                if mat1[y+1][x-1] == "b":
                    mat1[y][x] = 1
                if mat1[y-1][x+1] == "b":
                    mat1[y][x] = 1
                if mat1[y-1][x-1] == "b":
                    mat1[y][x] = 1
    printmat(mat1)
addscores() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:34:09.420

您的嵌套循环会检查每个方块，看它是否应该有一个 1。但是，在您的第一`if`个子句中`addscores()`，您省略了位于正方形边缘的每个正方形。解决这个问题的一个好方法是省略`if`cluase，而是添加一个函数来检查自动检查边界的正方形。例如：

```
def checksqu(y, x):
    if y < 0 or y >= len(mat1) or x < 0 or x >= len(mat1):
        return False
    return mat1[y][x] == 'b' 
```

`if mat1[y - 1][x - 1]:`然后，您可以代替， `if checksqu(y - 1, x - 1):`（等等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:46:08.467

您可以简化这部分：

```
def addscores():
    for x in range(len(mat1)):
        for y in range(len(mat1)):
            if ((y < len(mat1)-1) and (x < len(mat1)-1)) and ((y >= 0) and (x >= 0))):
                if mat1[y+1][x] == "b":
                    mat1[y][x] = 1
                if mat1[y-1][x] == "b":
                    mat1[y][x] = 1
                if mat1[y][x+1] == "b":
                    mat1[y][x] = 1
                if mat1[y][x-1] == "b":
                    mat1[y][x] = 1
                if mat1[y+1][x+1] == "b":
                    mat1[y][x] = 1
                if mat1[y+1][x-1] == "b":
                    mat1[y][x] = 1
                if mat1[y-1][x+1] == "b":
                    mat1[y][x] = 1
                if mat1[y-1][x-1] == "b":
                    mat1[y][x] = 1 
```

通过使用此代码：

```
def addscores():
    size = len(mat1)
    directions = [(dx, dy) for dx in [-1,0,1] for dy in [-1,0,1] if (dy!=0 or dx!=0)]
    for x in range(size):
        for y in range(size):
            for dx, dy in directions:
                try:
                    if mat1[y+dy][x+dx] == "b":
                        mat1[y][x] = 1
                except:
                    pass 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T00:48:30.523

这似乎可以解决问题：

```
def addscores(mat):
    for y in range(len(mat)):
        for x in range(len(mat[y])):
            if mat[y][x] == 'b':
                mat = pad(mat, x, y, '1')
    return mat

def pad(mat, x, y, n):
    for i, (x,y) in enumerate(itertools.product(range(x-1, x+2), range(y-1, y+2))):
        if i != 4: # the coordinate at index 4 is where the bomb is
            if 0<=y<len(mat) and 0<=x<len(mat[y]):
                mat[y][x] = n
    return mat 
```

* * *

测试：

```
In [127]: mat
Out[127]: 
[['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '1', '1', '1'],
 ['0', '0', '0', '0', '0', '0', '0', '1', '0', '1']]

In [129]: addscores(mat)
Out[129]: 
[['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '0', '0'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '1', '1'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '1', 'b'],
 ['0', '0', '0', '0', '0', '0', '0', '0', '1', '1']] 
```

# java - 在 Java 中获取 HTML/XML 元素和值

> ID：13426262
> 
> 赞同：-3
> 
> 时间：2012-11-17T00:10:07.447
> 
> 标签：java, html

有人可以帮我从 HTML 页面中获取元素吗？我不想使用库，我只想要一个或两个关于如何使用正确的正则表达式等的指针。我有点坚持这一点，感谢所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:27:27.083

您必须首先决定您是在谈论 HTML 还是 XML。

如果您的文本是有效的 XML 文档，那么您可以使用 JAXP 解析文档并以编程方式访问元素/属性（在正则表达式中不需要）。

如果您的文本不是有效的 XML 文档，那么在 100% 的情况下，没有设置的正则表达式对您有效；最好的办法是使用作为 Swing 框架的一部分提供的 JDK 的内置 HTML 解析器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:24:45.490

JDK 包括一个基本的[HTML 解析器](http://docs.oracle.com/javase/6/docs/api/javax/swing/text/html/parser/package-summary.html)。它不是很健壮，但是您确实指定了“不想使用库”。所以......我想，把自己打晕？

# twitter-bootstrap - 媒体网格类是否从 Twitter 引导程序中消失了？

> ID：13426265
> 
> 赞同：8
> 
> 时间：2012-11-17T00:10:20.243
> 
> 标签：twitter-bootstrap

我正在尝试使用媒体网格类，它只是显示为无序列表。我在 bootstrap.css 中进行了搜索，但找不到媒体网格。或者有没有一种新的方法来实现媒体网格外观？谢谢

```
 <!--Media grid-->
      <ul class="media-grid">
        <li>
            <a href="#">
                <img src="http://placehold.it/290x200" />
            </a>
        </li>
        <li>
            <a href="#">
                <img src="http://placehold.it/290x200" />

            </a>
        </li>
        <li>
            <a href="#">
                <img src="http://placehold.it/290x200" />
            </a>
        </li>

      <!--media grid--> 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-17T00:30:12.027

我找到了答案，.media-grid 已更改为 .thumbnails。

# java - 用于国际化的 JPA 数据库结构

> ID：13426273
> 
> 赞同：15
> 
> 时间：2012-11-17T00:11:34.840
> 
> 标签：java, jpa

我正在尝试实现一种简单的国际化方法的 JPA 实现。我想要一个翻译字符串表，我可以在多个表的多个字段中引用它。因此，所有表中出现的所有文本都将替换为对已翻译字符串表的引用。结合语言 ID，这将在已翻译字符串表中为该特定字段提供唯一行。例如，考虑具有实体 Course 和 Module 的架构，如下所示：-

**课程** int course_id, int name, int description

**模块** int module_id, int name

course.name、course.description 和 module.name 都引用了已翻译字符串表的 id 字段：-

**TranslatedString** int id, String lang, String content

这一切似乎都很简单。我为所有可以国际化的字符串得到一个表，并且该表用于所有其他表。

我如何在 JPA 中使用 eclipselink 2.4 执行此操作？

我已经查看了嵌入式 ElementCollection，这... [JPA 2.0：映射地图](http://hwellmann.blogspot.ie/2010/07/jpa-20-mapping-map.html)- 这并不完全是我所追求的，因为它看起来将翻译后的字符串表与拥有表的 pk 相关联。这意味着每个实体只能有一个可翻译的字符串字段（除非我将新的连接列添加到可翻译的字符串表中，这违背了这一点，这与我试图做的相反）。我也不清楚这将如何跨实体工作，大概每个实体的 id 必须使用数据库范围的序列来确保可翻译字符串表的唯一性。

顺便说一句，我尝试了该链接中列出的示例，但它对我不起作用 - 一旦实体添加了本地化字符串映射，坚持它会导致客户端炸弹但服务器端没有明显错误，什么也没有保存在数据库中：S

到目前为止，我已经在这所房子周围呆了大约 9 个小时，我已经看过这个[Internationalization with Hibernate](https://stackoverflow.com/questions/6350415/internationalization-with-hibernate)，它似乎试图做与上面的链接相同的事情（没有表格定义，很难看到他取得了什么成就）。在这一点上，任何帮助都将不胜感激......

Edit 1 - re AMS anwser 下面，我不确定这是否真的解决了这个问题。在他的示例中，它将描述文本的存储留给了其他一些过程。这种方法的想法是实体对象采用文本和语言环境，并且这（不知何故！）最终出现在可翻译字符串表中。在我给出的第一个链接中，这个人试图通过使用嵌入式地图来做到这一点，我认为这是正确的方法。他的方式虽然有两个问题 - 一个似乎不起作用！和两个如果它确实有效，它将 FK 存储在嵌入式表中，而不是相反（我认为，我无法让它运行，所以我无法确切地看到它是如何持续存在的）。我怀疑正确的方法最终是用地图参考代替需要翻译的每个文本（地图是语言环境-> 内容），但我不能

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T09:33:54.567

（我是回复 hwellman 博客的 Henno。）我最初的方法与您的方法非常相似，并且可以完成工作。它满足任何实体的任何字段都可以引用本地化字符串映射的要求，该字符串映射具有通用数据库表，而不必引用其他更具体的表。事实上，我还将它用于我们产品实体中的多个字段（名称、描述、详细信息）。我还有一个“问题”，即 JPA 生成了一个表，其中只有一个主键列和一个用于引用此 id 的值的表。使用 OpenJPA，我不需要虚拟列：

```
public class StringI18N {

    @OneToMany(mappedBy = "parent", cascade = ALL, fetch = EAGER, orphanRemoval = true)
    @MapKey(name = "locale")
    private Map<Locale, StringI18NSingleValue> strings = new HashMap<Locale, StringI18NSingleValue();
... 
```

OpenJPA 只是将 Locale 存储为字符串。因为我们真的不需要额外的实体 StringI18NSingleValue 所以我认为你使用 @ElementCollection 的映射更优雅一点。

但是，您必须注意一个问题：您是否允许与多个实体共享本地化实体，以及在删除拥有实体时如何防止孤立的本地化实体？仅仅使用 cascade all 是不够的。我决定尽可能将 Localized 视为“值对象”，并且不允许它与其他实体共享，这样我们就不必考虑对同一个 Localized 的多个引用，并且我们可以安全地使用孤儿删除。所以我的本地化字段映射如下：

```
@OneToOne(cascade = ALL, orphanRemoval = true) 
```

根据我的用例，我还使用 fetch = EAGER/LAZY 和 optional = false 或 true。当使用 optional = false 我使用 @JoinColumn(nullable=false) 所以 OpenJPA 在连接列上生成一个非空约束。

每当我确实需要将 Localized 复制到另一个实体时，我不会使用相同的引用，但我会创建一个新的 Localized 实例，它具有相同的内容但还没有 id。否则，您可能很难调试 changin 如果您不这样做，您仍然与多个实体共享一个实例，并且您可能会遇到令人惊讶的错误，即更改本地化字符串可能会更改另一个实体的另一个字符串。

到目前为止一切顺利，但在实践中，我发现 OpenJPA 在选择包含一个或多个本地化字符串的实体时存在 N+1 选择问题。它不能有效地获取元素集合（我将此报告为[https://issues.apache.org/jira/browse/OPENJPA-1920](https://issues.apache.org/jira/browse/OPENJPA-1920)）。这个问题可能通过使用 Map<Locale, StringI18NSingleValue> 来解决。然而，OpenJPA 也不能有效地获取 A 1..1 B 1..* C 形式的结构，这也是这里发生的情况（我将其报告为[https://issues.apache.org/jira/browse/OPENJPA-2296](https://issues.apache.org/jira/browse/OPENJPA-2296)）。这会严重影响应用程序的性能。

其他 JPA 提供者可能有类似的 N+1 选择问题。如果您关心获取类别的性能，我会检查用于获取类别的查询数量是否取决于实体的数量。我知道使用 Hibernate，您可以强制批量获取或子选择来解决这类问题。我也知道 EclipseLink 具有类似的功能，可能会也可能不会。

出于解决这个性能问题的绝望，我实际上不得不接受我不太喜欢的设计：我只是为我必须支持的每种语言添加了一个字符串字段到本地化。对我们来说这是可能的，因为我们目前只需要支持几种语言。这导致只有一个（非规范化）本地化表。然后，JPA 可以在查询中有效地加入 Localized 表，但这对于许多语言来说不能很好地扩展，并且不支持任意数量的语言。为了可维护性，我保持 Localized 的外部接口相同，并且只将实现从 Map 更改为每个语言的字段，以便我们将来可以轻松切换回来。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-17T18:57:19.007

好的，我想我有它。看起来我的问题中第一个链接的简化版本将起作用，只需使用与本地化实体的多对一关系（主实体中的每个文本元素都有不同的 joinColumn）和该本地化实体中的 Map 的简单 ElementCollection . 我编写了一个与我的问题略有不同的示例，只有一个实体（类别），有两个文本元素，每个语言环境需要多个条目（名称和描述）。

请注意，这是针对 Eclipselink 2.4 转到 MySQL 的。

关于这种方法的两个注意事项 - 正如您在第一个链接中看到的那样，使用 ElementCollection 会强制创建一个单独的表，这会导致可翻译字符串的两个表 - 一个只保存 ID（本地化），它是主要的 FK一个（Localised_strings）包含所有地图信息。名称 Localised_strings 是自动/默认名称 - 您可以将另一个名称与 @CollectionTable 注释一起使用。总的来说，从数据库的角度来看，这并不理想，但也不是世界末日。

其次是，至少对于我的 Eclipselink 和 MySQL 的组合，坚持到单个（自动生成的）列表会产生错误:(所以我在实体中添加了一个虚拟列 wa 默认值，这纯粹是为了克服那个问题。

```
import java.io.Serializable;
import java.lang.Long;
import java.lang.String;
import java.util.HashMap;
import java.util.Map;

import javax.persistence.*;

@Entity

public class Category implements Serializable {

@GeneratedValue(strategy = GenerationType.IDENTITY)
@Id
private Long id;
@ManyToOne(cascade=CascadeType.ALL)
@JoinColumn(name="NAME_ID")
private Localised nameStrings = new Localised();

@ManyToOne(cascade=CascadeType.ALL)
@JoinColumn(name="DESCRIPTION_ID")
private Localised descriptionStrings = new Localised();

private static final long serialVersionUID = 1L;

public Category() {

    super();
}  

public Category(String locale, String name, String description){
    this.nameStrings.addString(locale, name);
    this.descriptionStrings.addString(locale, description);
}
public Long getId() {
    return this.id;
}

public void setId(Long id) {
    this.id = id;
}   

public String getName(String locale) {
    return this.nameStrings.getString(locale);
}

public void setName(String locale, String name) {
    this.nameStrings.addString(locale, name);
}
public String getDescription(String locale) {
    return this.descriptionStrings.getString(locale);
}

public void setDescription(String locale, String description) {
    this.descriptionStrings.addString(locale, description);
}

}

import java.util.HashMap;
import java.util.Map;

import javax.persistence.ElementCollection;
import javax.persistence.Embeddable;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Localised {

    @Id @GeneratedValue(strategy=GenerationType.IDENTITY)
    private int id;
    private int dummy = 0;
    @ElementCollection
    private Map<String,String> strings = new HashMap<String, String>();

    //private String locale;    
    //private String text;

    public Localised() {}

    public Localised(Map<String, String> map) {
        this.strings = map;
    }

    public void addString(String locale, String text) {
        strings.put(locale, text);
    }

    public String getString(String locale) {
        String returnValue = strings.get(locale);
        return (returnValue != null ? returnValue : null);
    }

} 
```

所以这些生成表如下： -

```
CREATE TABLE LOCALISED (ID INTEGER AUTO_INCREMENT NOT NULL, DUMMY INTEGER, PRIMARY KEY (ID))
CREATE TABLE CATEGORY (ID BIGINT AUTO_INCREMENT NOT NULL, DESCRIPTION_ID INTEGER, NAME_ID INTEGER, PRIMARY KEY (ID))
CREATE TABLE Localised_STRINGS (Localised_ID INTEGER, STRINGS VARCHAR(255), STRINGS_KEY VARCHAR(255))
ALTER TABLE CATEGORY ADD CONSTRAINT FK_CATEGORY_DESCRIPTION_ID FOREIGN KEY (DESCRIPTION_ID) REFERENCES LOCALISED (ID)
ALTER TABLE CATEGORY ADD CONSTRAINT FK_CATEGORY_NAME_ID FOREIGN KEY (NAME_ID) REFERENCES LOCALISED (ID)
ALTER TABLE Localised_STRINGS ADD CONSTRAINT FK_Localised_STRINGS_Localised_ID FOREIGN KEY (Localised_ID) REFERENCES LOCALISED (ID) 
```

一个主要测试它...

```
import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;

public class Main {
  static EntityManagerFactory emf = Persistence.createEntityManagerFactory("javaNetPU");
  static EntityManager em = emf.createEntityManager();

  public static void main(String[] a) throws Exception {
    em.getTransaction().begin();

    Category category = new Category();

    em.persist(category);

    category.setName("EN", "Business");
    category.setDescription("EN", "This is the business category");

    category.setName("FR", "La Business");
    category.setDescription("FR", "Ici es la Business");

    em.flush();

    System.out.println(category.getDescription("EN"));
    System.out.println(category.getName("FR"));

    Category c2 = new Category();
    em.persist(c2);

    c2.setDescription("EN", "Second Description");
    c2.setName("EN", "Second Name");

    c2.setDescription("DE", "Zwei  Description");
    c2.setName("DE", "Zwei  Name");

    em.flush();

    //em.remove(category);

    em.getTransaction().commit();
    em.close();
    emf.close();

  }
} 
```

这会产生输出：-

```
This is the business category
La Business 
```

和下表条目：-

```
Category
"ID"    "DESCRIPTION_ID"    "NAME_ID"
"1"         "1"                 "2"
"2"         "3"                 "4"

Localised
"ID"    "DUMMY"
"1"         "0"
"2"         "0"
"3"         "0"
"4"         "0"

Localised_strings

"Localised_ID"  "STRINGS"                        "STRINGS_KEY"
"1"                 "Ici es la Business"                 "FR"
"1"                 "This is the business category"      "EN"
"2"                 "La Business"                        "FR"
"2"                 "Business"                       "EN"
"3"                 "Second Description"                 "EN"
"3"                 "Zwei  Description"              "DE"
"4"                 "Second Name"                        "EN"
"4"                 "Zwei  Name"                         "DE" 
```

取消注释 em.remove 会正确删除 Category 及其关联的 Localised/Localised_strings 条目。

希望对未来的人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-31T18:37:53.687

我知道这有点晚了，但我实现了以下方法：

```
 @Entity
 public class LocalizedString extends Item implements Localizable<String>
 {
     @Column(name = "en")
     protected String en;

     @Column(name = "en_GB")
     protected String en_GB;

     @Column(name = "de")
     protected String de;

     @Column(name = "de_DE")
     protected String de_DE;

     @Column(name = "fr")
     protected String fr;

     @Column(name = "fr_FR")
     protected String fr_FR;

     @Column(name = "es")
     protected String es;

     @Column(name = "es_ES")
     protected String es_ES;

     @Column(name = "it")
     protected String it;

     @Column(name = "it_IT")
     protected String it_IT;

     @Column(name = "ja")
     protected String ja;

     @Column(name = "ja_JP")
     protected String ja_JP;
 } 
```

该实体没有设置器和获取器！相反，该`Localizable`接口定义了常见的 get/set 方法：

```
public class Localizable<T> {
    private final KeyValueMapping<Locale, T> values = new KeyValueMapping<>();

    private T defaultValue = null;

    /**
     * Generates a {@link Localizable} that only holds one value - for all locales.
     * This value overrides all localalized values when using
     * {@link Localizable#toString()} or {@link Localizable#get()}.
     */
    public static <T> Localizable<T> of(T value) {
        return new Localizable<>(value);
    }

    public static <T> Localizable<T> of(Locale locale, T value) {
        return new Localizable<>(locale, value);
    }

    private Localizable(T value) {
        this.defaultValue = value;
    }

    private Localizable(Locale locale, T value) {
        this.values.put(locale, value);
    }

    public Localizable() {
    }

    public void set(Locale locale, T value) {
        values.put(locale, value);
    }

    /**
     * Returns the value associated with the default locale
     * ({@link Locale#getDefault()}) or the default value, if it is set.
     */
    public T get() {
        return defaultValue != null ? defaultValue : values.get(Locale.getDefault());
    }

    public T get(Locale locale) {
        return values.get(locale);
    }

    /**
     * Returns the toString of the value for the default locale
     * ({@link Locale#getDefault()}).
     */
    @Override
    public String toString() {
        if (defaultValue != null) {
            return defaultValue.toString();
        }

        return toString(Locale.getDefault());
    }

    /**
     * Returns toString of the localized value.
     * 
     * @return null if there is no localized.
     */
    public String toString(Locale locale) {
        return values.transformValue(locale, v -> v.toString());
    }

    public Map<Locale, T> getValues() {
        return Collections.unmodifiableMap(values);
    }

    public T getDefaultValue() {
        return defaultValue;
    }

    public void setDefaultValue(T defaultValue) {
        this.defaultValue = defaultValue;
    }

} 
```

这种方法的巨大优势是您只有一个可本地化的实体，并且本地化值存储在列中（而不是每个本地化都有一个实体）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-17T01:34:50.843

这是一种方法。

将所有翻译的字符串从数据库加载到缓存中，我们称之为 MessagesCache，它会有一个名为 public String getMesssage(int id, int languageCode) 的方法。您可以使用 google guava 不可变集合将其存储在内存缓存中。如果您想按需加载缓存值，您还可以使用 Guava LoadingCache 来存储缓存值。如果你有这样的缓存，你可以像这样编写代码。

```
@Entity 
public Course {
    @Column("description_id")
    private int description;

    public String getDescription(int languageCode)
    { 
        return this.messagesCache(description, languageCode);
    }

    public String setDscription(int descriptionId)
    {
         this.description = descriptionId; 
    }
} 
```

我看到这种方法的主要问题是您需要知道您在实体中引用的语言环境，我建议选择正确的描述语言的任务不应该在实体中完成，而是在更高级别完成抽象，例如 Dao 或 Service。

# iis-7.5 - IIS 重写模块以映射查询字符串

> ID：13426274
> 
> 赞同：0
> 
> 时间：2012-11-17T00:11:36.297
> 
> 标签：iis-7.5, url-rewrite-module

我在 IIS7.5 上使用 IIS 重写模块。我的映射位于结构中的文本文件中：

```
[old url], [new url] 
```

所以像这样的工作：

```
products/abc, http://test.com/new/products/abc 
```

这在我的 web.config 中使用以下规则

```
 <rule name="FileMapProviderRule" stopProcessing="true">
      <match url="(.*)" />
      <conditions>
        <add input="{FileMapProvider:{R:1}}" pattern="(.+)" />
      </conditions>
      <action type="Redirect" url="{C:1}" redirectType="Permanent" />
 </rule> 
```

如果我也想传递查询字符串，我的规则是什么？所以我希望这个工作：

```
products?sku=123, http://test.com/new/products/123
products?sku=789, http://test.com/new/products/789 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T00:05:14.977

我通过以下规则解决了这个问题：

```
<rule name="Products" patternSyntax="Wildcard" stopProcessing="true">
    <match url="products" />
    <conditions>
        <add input="{QUERY_STRING}" pattern="sku=*" />
    </conditions>
    <action type="Redirect" url="http://test.com/new/products/{C:1}" appendQueryString="false" redirectType="Permanent" />
</rule> 
```

# jquery - UI选项卡重新加载问题

> ID：13426276
> 
> 赞同：1
> 
> 时间：2012-11-17T00:12:01.220
> 
> 标签：jquery, jquery-ui, jquery-plugins, tabs

我在使用 UI Jquery 选项卡时遇到了一些问题。

在我的一个页面上，我包含 UI 选项卡。然后在我网站的页脚中，我包含一些指向特定选项卡的链接，因此用户可以链接到特定选项卡，以便他们可以从以下位置访问：

www.mydomain.com 到 www.mydomain.com/subpage/#tab-1 或
www.mydomain.com/subpage/#tab-2

这很好用，但是当我在

www.mydomain.com/subpage/#tab-1

并尝试切换到：

www.mydomain.com/subpage/#tab-2 选项卡未重新加载，仍显示 www.mydomain.com/subpage/#tab-1

我尝试使用重新加载页面`onClick="window.location.reload()`但无法正常工作，但是当我添加`target="_blank"`到`<a>`标签时它工作正常。任何人都可以在这里发现问题并帮助解决它。

[http://take1.56degrees.co.uk](http://take1.56degrees.co.uk)

# expressionengine - ExpressionEngine 文件管理器 - 默认为缩略图视图

> ID：13426283
> 
> 赞同：1
> 
> 时间：2012-11-17T00:12:51.390
> 
> 标签：expressionengine

当您使用 EE 默认文件管理器选择条目中的图像时，默认视图是“将文件显示为列表”。

有没有办法将缩略图视图显示为默认值？

在这一点上，我会对核心 hack 感到满意。

我通常不将文件管理器用于站点（更喜欢资产），但这个客户的预算很紧

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T17:15:08.713

我过去也想知道这样做 - 结果很简单。打开 ee_filebrowser.js 并搜索`a("#dir_choice").val()`. 之后立即添加：

```
; a("#view_type").val('thumb').change(); 
```

确保包含前导`;`.

我只在 Safari 中对此进行了测试，但我不明白为什么它不能在任何地方工作。顺便说一句，[JS 美化](http://jsbeautifier.org)器使这种事情变得无限容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:57:27.533

**我不建议出于任何原因破解核心，我建议不惜一切代价避免它。**

话虽如此，我将提供我发现的相同内容。

在 EE 2.5.3 中，您希望编辑以下文件：

```
/themes/javascript/compressed/jquery/plugins/ee_filebrowser.js
/system/expressionengine/libraries/File_field.php 
```

我发现这些在我的文本编辑器中进行文件搜索，这些文件`view_type`来自该下拉列表的 id。javascript 已缩小，因此您可能希望[取消缩小它](http://jsbeautifier.org/)，然后重写处理开关的部分。我不是最好的 JS/jQuery 人，而且未缩小的 js 也让它变得更难了，所以我不会提供比我迄今为止发现的更多的东西。

如果您对 js 不熟悉，请考虑从两个文件中提取部分部分，并可能开始一个相应标记的新帖子。

另请注意：这可能不仅仅是这两个文件，因此请将此答案视为一个开始，仅此而已。

# c# - Outlook 插件可以写入系统事件日志吗？

> ID：13426289
> 
> 赞同：7
> 
> 时间：2012-11-17T00:13:02.030
> 
> 标签：c#, security, outlook, vsto, event-log

我有一个使用 VSTO 2010 开发的 Outlook 插件，我想编写一些事件日志记录。在调试时，我只需执行以下操作即可使其工作：

```
if (!EventLog.SourceExists(ADDIN_FRIENDLY_NAME))
{
    EventLog.CreateEventSource(ADDIN_FRIENDLY_NAME, null);
}
EventLog.WriteEntry(ADDIN_FRIENDLY_NAME, message, EventLogEntryType.Warning); 
```

问题是加载项的发布版本没有读取日志的管理员权限。我发现一些关于在安装过程中创建 EventLog 源的文章，但我使用的是 ClickOnce，但似乎没有办法做到这一点。此外，有人谈到创建一个单独的 DLL，然后调用`InstallUtil`该 DLL 来创建源代码。这对我也不起作用，因为这仍然需要管理员权限。

是否可以使用 Outlook 的安全级别运行加载项？我在事件日志中看到 Outlook 的消息，因此它必须有足够的权限才能这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T16:27:43.757

您可以尝试使用[本文](http://antscode.blogspot.com.au/2011/02/running-clickonce-application-as.html)中提出的解决方案以管理员身份运行 click 一次，但我认为这不是一个好的解决方案。

也许更好的解决方案是在您的点击中包含一个标准的 .msi 设置，您可以在第一次安装插件时执行该设置。这个 msi 只是创建事件源。

关于你的问题：

> 是否可以使用 Outlook 的安全级别运行加载项？

我不认为您的加载项使用不同的安全级别运行，但您可能启用了 UAC，因此如果您是管理员，您也无法执行管理操作。

# iphone - TextField 选择时的幻灯片视图仅在键入时

> ID：13426294
> 
> 赞同：0
> 
> 时间：2012-11-17T00:13:58.407
> 
> 标签：iphone, objective-c, uiview, uikeyboard

我在这里使用了 Apple 在其文档中的演示代码：

[http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html#//apple_ref/doc/uid/TP40009542-CH5-SW7](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html#//apple_ref/doc/uid/TP40009542-CH5-SW7)

当通过点击 UITextField 出现键盘时，我需要向上滑动视图。我正在使用上面链接中的代码，Apple 自己的演示代码，这是有道理的。

但是，我的问题是，使用 Apple 的代码几乎没有改变，视图仅在键入时向上滑动，而不是在点击文本字段后实际滑动。

在该`- (void)keyboardWasShown:(NSNotification*)aNotification`方法中，当调用此 if 语句时，视图是否向上滑动。如果文本字段在键盘下方，则向上滑动，如果不在键盘下方，则不向上滑动。

```
if (!CGRectContainsPoint(aRect, activeField.frame.origin) ) {
        CGPoint scrollPoint = CGPointMake(0.0, activeField.frame.origin.y-kbSize.height);
        [scrollView setContentOffset:scrollPoint animated:YES];
    } 
```

问题是，在点击文本字段时，会跳过此 if 语句，其中的代码不会运行。

我无法解决，但这一切都发生在下面的这种方法中。为什么它只在打字时向上滑动而不是最初的点击？

```
- (void)keyboardWasShown:(NSNotification*)aNotification
{
    NSDictionary* info = [aNotification userInfo];
    CGSize kbSize = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size;

    UIEdgeInsets contentInsets = UIEdgeInsetsMake(0.0, 0.0, kbSize.height, 0.0);
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;

    // If active text field is hidden by keyboard, scroll it so it's visible
    // Your application might not need or want this behavior.
    CGRect aRect = self.view.frame;
    aRect.size.height -= kbSize.height;
    if (!CGRectContainsPoint(aRect, activeField.frame.origin) ) {
        CGPoint scrollPoint = CGPointMake(0.0, activeField.frame.origin.y-kbSize.height);
        [scrollView setContentOffset:scrollPoint animated:YES];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T17:54:13.380

我再次查看了 Apple 文档。糟糕——他们不是以写软件为生吗？试试这个：记住主视图的默认位置。

```
@interface ViewController ()
    @property (assign, nonatomic) CGFloat viewOriginY;
@end 
```

注册键盘通知和点击（关闭第一响应者）。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.viewOriginY = self.view.frame.origin.y;

    NSNotificationCenter *center = [NSNotificationCenter defaultCenter];
    [center addObserver:self selector:@selector(keyboardDidShow:) name:UIKeyboardDidShowNotification object:nil];
    [center addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:nil];

    // add a tap gesture to drop first responder
    UITapGestureRecognizer *tapGR = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapped:)];
    [self.view addGestureRecognizer:tapGR];
} 
```

编写一个函数来（递归地）找到第一响应者。

```
- (UIView *)firstResponderWithin:(UIView *)view {

    if ([view isFirstResponder]) return view;

    for (UIView *subview in view.subviews) {
        UIView *answer = [self firstResponderWithin:subview];
        if (answer) return answer;
    }
    return nil;
} 
```

这是关键点：当键盘显示时，计算它的框架和需要可见的视图框架。在公共坐标系中执行此操作很重要，例如这个 vc 的视图。然后滑动视图使第一响应者可见。

```
- (void)keyboardDidShow:(NSNotification *)notification {

    CGRect keyboardFrameW = [[notification.userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue];
    UIWindow *window = [[UIApplication sharedApplication] keyWindow];
    CGRect keyboardFrame = [window convertRect:keyboardFrameW toView:self.view];

    UIView *firstResponder = [self firstResponderWithin:self.view];
    CGRect firstResponderFrame = [firstResponder.superview convertRect:firstResponder.frame toView:self.view];

    // let's put the bottom of the first responder's frame just above the top of the keyboard
    CGFloat firstResponderBottom = CGRectGetMaxY(firstResponderFrame);
    CGFloat targetBottom = keyboardFrame.origin.y - 8.0;    
    CGFloat offsetY = MAX(0.0, firstResponderBottom - targetBottom);

    [UIView animateWithDuration:0.3 animations:^{
        self.view.frame = CGRectOffset(self.view.frame, 0.0, -offsetY);
    }];
}

- (void)keyboardWillHide:(NSNotification *)notification {

    [UIView animateWithDuration:0.3 animations:^{
        self.view.frame = CGRectMake(0.0, self.viewOriginY, self.view.frame.size.width, self.view.frame.size.height);
    }];
} 
```

可选 - 当用户点击其他任何地方时，关闭键盘。

```
- (void)tapped:(UITapGestureRecognizer *)gr {

    UIView *firstResponder = [self firstResponderWithin:self.view];
    [firstResponder resignFirstResponder];
} 
```

[工作项目可以在这里找到。](https://anonfiles.com/file/985d29ea8a0cb7fddbdc2a1f3c952b04)

我认为这个想法与视图控制器上的一个不错的类别相距甚远。您可以导入它，然后调用 viewDidLoad 上的设置。它所需要的只是一种无需将其写入 ivar 即可获得主视图的默认 y 原点的方法。我需要考虑一下。

# c++ - 如何解除分配动态大小的结构

> ID：13426295
> 
> 赞同：0
> 
> 时间：2012-11-17T00:14:11.540
> 
> 标签：c++, arrays, data-structures, memory-management

> **可能重复：**
> [delete[] 对象数组](https://stackoverflow.com/questions/2486034/delete-an-array-of-objects)

内存分配如下：

```
struct foo {
  int size;
  int * arr;
};

(*structA).arr = new int[(*structA).size]; 
```

如何解除分配？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T00:18:09.250

您分配的任何内容都`new[]`必须使用以下命令删除`delete[]`：

```
structA->arr = new int[structA->size];
...
delete[] structA->arr; 
```

在此特定示例中，最好改为使用`std::vector`。让它为您处理内存分配和释放。您可以使用它的`size()`方法来确定它持有多少物品：

```
struct foo {
  std::vector<int> arr;
};

structA->arr.resize(some value here);
...
int size = structA->arr.size(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T00:18:19.863

调用时分配的内存将被删除

```
delete[] (*structA).arr; 
```

至于您的结构，这取决于您是在堆上还是在堆栈上分配结构。

# node.js - 是否可以在 NodeJS 的网络“数据”事件中设置最大字节数？

> ID：13426305
> 
> 赞同：1
> 
> 时间：2012-11-17T00:15:32.977
> 
> 标签：node.js, networking, tcp, max

我正在使用 net 模块解析 TCP 字节流的块。每次调用“数据”事件时，我都会收到一个包含未知字节数的变量——有时高达 22k。有没有办法指定我只想使用最多 1024 个字节的块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-28T01:41:23.720

[NodeJS v0.10.0](http://blog.nodejs.org/2012/12/20/streams2/)引入了改进的 Streams API，其中包括对“可读”事件的支持以及从流中请求给定字节数的能力。

# apache-flex - Flextras 下拉列表无法正常工作

> ID：13426306
> 
> 赞同：0
> 
> 时间：2012-11-17T00:15:41.087
> 
> 标签：apache-flex

我已成功添加了一个下拉列表（flextras），但它无法正常工作。每当我触摸下拉列表时，弹出的列表都会位于文本框下方（位于下拉列表下方）。因此，当焦点传递到文本框时，我无法从文本框顶部的列表中选择项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:52:05.793

很高兴阅读[有关该主题的博客文章](https://www.flextras.com/blog/index.cfm/2012/5/1/Why-does-a-TextInput-appear-above-my-Popup-in-Flex-46)。

相关报价：

> Flex 4.6 中 TextInput 的默认外观使用 [StyleableStageText](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/supportClasses/StyleableStageText.html)。StageText 始终绘制在 Flash 显示列表上方，这就是下拉菜单的弹出窗口似乎在它下方的原因。引用[StageText 上的 Adob​​e 文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/supportClasses/StyleableStageText.html)：
> 
> [start doc quote] 原生文本输入字段不能被其他 Flex 内容裁剪，并在舞台上方的图层中呈现。由于此限制，使用基于 StageText 的外观类的组件将始终显示在其他 Flex 组件之上。Flex 弹出窗口和下拉菜单也将被任何可见的本机文本字段遮挡。最后，本机文本字段的相对 z 顺序无法由应用程序控制。[结束文档引用]
> 
> 对此有两种可能的解决方案。第一个是构建您的移动应用程序，以便弹出窗口永远不会显示在 TextInput 上方。如果您正在为具有不同屏幕尺寸的多个设备构建，这可能会很困难。
> 
> 第二个是[为您的 TextInputs 使用 Flex 4.5 皮肤类](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/skins/mobile/TextInputSkin.html)：
> 
> `<textInput skinClass="spark.skins.mobile.TextInputSkin" />`

# css - 没有 keyfeame 的 CSS3 动画

> ID：13426310
> 
> 赞同：0
> 
> 时间：2012-11-17T00:16:13.037
> 
> 标签：css, animation, css-animations

我必须在客户的在线拍卖网站上开发一个 css 模板，在 @-webkit-keyframes 中带有动画。问题是，当我在 中编写我的 css 时，拍卖服务会在每个声明前添加类似 @user-field 的内容，所以： .topMenu { styles; 样式；} 变为 #user-field .topMenu {styles; 样式；}

问题是，当您在 @-webkit-keyframes 声明前添加类似 #user-field 的内容时，它就会停止工作。所以，我的问题是：我可以通过将“@-webkit....”包装在任何标签中来产生相同的效果吗？或者我可以将所有的止损点（20%、50% 等）直接放在动画中：{}？

# java - 尝试使用Java绘制弧线

> ID：13426313
> 
> 赞同：2
> 
> 时间：2012-11-17T00:16:48.480
> 
> 标签：java, swing

我一直在尝试使用以下代码在 java 中绘制弧线：

```
g.fillArc(50, 50, 100, 100, 0, 180) 
```

其中 g 是图形对象。

这会产生下面的蓝色对象：

![结果](../Images/3a748f3160c5630843ab3b00d063be31.png)

我实际上想要做的是产生如下所示的东西：

![为...而奋斗](../Images/6836e73ed2fcc93b7ff2e90948e21215.png)

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T00:30:09.460

试试`g.fillArc(50, 50, 100, 100, 180, 180)`吧。

基本上，第一个角度是从哪里开始，第二个角度是它应该穿过的度数（从开始）。

所以如果你只想要一个 5 度的饼图，你会使用类似的东西`g.fillArc(50, 50, 100, 100, 0, 5)`

查看[`Graphics#fillArc`](http://docs.oracle.com/javase/7/docs/api/java/awt/Graphics.html#fillArc%28int,%20int,%20int,%20int,%20int,%20int%29)和[Graphics2D](http://docs.oracle.com/javase/tutorial/2d/index.html)了解更多信息

**工作示例**

![在此处输入图像描述](../Images/0d7816682b81a814b5b8c658f54c429d.png)

```
public class PaintTest03 {

    public static void main(String[] args) {
        new PaintTest03();
    }

    public PaintTest03() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new PaintPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class PaintPane extends JPanel {

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(100, 100);
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);

            g.setColor(Color.RED);
            g.fillArc(0, 0, 100, 100, 180, 180);        
        }

    }

} 
```

# java - 在javascript中运行java

> ID：13426315
> 
> 赞同：1
> 
> 时间：2012-11-17T00:16:55.883
> 
> 标签：java, javascript

如果两张图片相同，我正在制作一个比较两张图片的功能。我有这个代码：

`var rez=null;`

```
rez=compareImages();

alert(rez);

boolean function compareImages()
{
    BufferedImage bi1 = java.ImageIO.read(new File("C:\\MyFiles\\pic1.png")),
                    bi2 = java.ImageIO.read(new File("C:\\MyFiles\\pic2.png"));
    Raster r1 = bi1.getData(),
            r2 = bi2.getData();
    DataBuffer db1 = r1.getDataBuffer(),
                db2 = r2.getDataBuffer();
    int size1 = db1.getSize(),
        size2 = db2.getSize();

        // checking if the files sizes are the same
    if(size1 != size2)
        return false;

        // pixel by pixel check up
    for (int i = 0; i < size1; i++) 
        if(db1.getElem(i) != db2.getElem(i))
            return false;

    return true;
} 
```

现在我想在 .js 文件中运行此代码，但是当我这样做时出现错误，缺少“;” 错误。那么如何使这个函数与 javascript 兼容呢？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T00:22:07.713

不幸的是，Javacript 和 Java 是完全独立的语言，它们在名称中唯一的共同点，因此这是不可能的。

如果您想了解如何在 javascript 中执行类似操作，请查看 File API：[https ://developer.mozilla.org/en-US/docs/DOM/File_APIs](https://developer.mozilla.org/en-US/docs/DOM/File_APIs)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T00:24:18.677

您不能在 JavaScript 中运行 Java 代码。您可以将您的 Java 代码编译为小程序并将其嵌入到您的页面中，或者您只需在 JS 中重写您的代码。如果您使用html5`canvas`和该`getImageData()`功能，这应该是可行的。这样您就可以轻松地从 JavaScript 与您的代码进行交互。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T01:35:02.747

[在您使用Mozilla Rhino](http://en.wikipedia.org/wiki/Rhino_%28JavaScript_engine%29)用 Ja​​vaScript编写的代码中使用 Java 类和 API 是有可能的。

Rhino 只是一个用 Java 编写的 JS 解释器，它与 JDK 捆绑在一起。它基本上允许您使用带有 JS 语法的 Java API，但另一方面，没有可用的 DOM API，您**无法在 Web 浏览器中运行此类脚本**。它们由 JVM 运行。

# regex - oracle中的正则表达式

> ID：13426316
> 
> 赞同：1
> 
> 时间：2012-11-17T00:17:00.490
> 
> 标签：regex, oracle, string-matching

如何**使用 REGEXP_SUBSTR 在 Oracle中获取我想要的这些数据**

```
SPRINTMVNO_PM_CDR_IWIRELESS_20121110_0813.csv get '08'in last four digits
RK_IPDR_RKMSG2_0043722_DT_20121113162710.txt  get '0043722' in the middle(between'_')
wireless_201211120015_201211120515            get '0515' (last four digits) 
```

我已经尝试了很多次，但有些表达式在 PHP 或其他语言中可以正常工作，但在 ORACLE 中不能正常工作。也许语法不同。

例如：我可以使用第二个 `/(?<=_)[0-9]*(?=_)/`来获取 php 中的数字，但这在 Oracle 中不起作用。
我试过了

```
SELECT REGEXP_SUBSTR('RK_IPDR_RKMSG2_0043722_DT_20121113162710.txt','(?<=_)[0-9]*(?=_)') 
  FROM dual; 
```

没有输出。所以不是两条斜线的问题

这个问题的另一种表述是“如何使用 Oracle 的正则表达式在字符之间获取内容或以字符开头但**不包含**它？”

我知道我可以通过使用字符串函数轻松获取这些数据，问题是要处理大量不同的字符串，每个字符串都有不同的数据要检索。所以我想将模式存储到数据库中，并使用一个 regexp_substr 来获取所有数据。否则我需要对这些规则进行硬编码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T08:42:20.940

Oracle 从业者在没有正则表达式的情况下存活了多年，因为 Oracle 提供了一些简单的字符串函数，我们可以将它们组合起来进行一些漂亮的操作。

例如，要查找字符串中最后一个下划线之后的前两个字符，请使用 SUBSTR() 和 INSTR()，如下所示：

```
with t as (select 'SPRINTMVNO_PM_CDR_IWIRELESS_20121110_0813.csv' str from dual)
select substr(str, instr(str, '_', -1)+1, 2)
from t
/ 
```

注意 INSTR() 调用有一个负偏移量，从后面开始计数。获取字符串的最后四个字符使用相同的技巧：

```
with t as (select 'iwireless_201211120015_201211120515' str from dual)
select substr(str, -4)
from t
/ 
```

识别*下划线后跟数字后跟下划线*的模式的最简单方法是使用正则表达式，但我们可以使用 TRIM() 从结果中删除下划线。

```
with t as (select 'RK_IPDR_RKMSG2_0043722_DT_20121113162710.txt' str from dual)
select trim('_' from regexp_substr(str, '_([0-9]+)_'))
from t
/ 
```

这是[一个 SQL Fiddle](http://sqlfiddle.com/#!4/1c9f3/10)来证明这些技术是有效的。

Oracle 有大量的函数，这些函数在文档中进行了描述。 [了解更多](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions002.htm#CJAJHBIA)。

* * *

> “请忽略这些情况，我只需要一个解决方案'如何使用 Oracle 的正则表达式在字符之间获取内容或以字符开头但不包含它？'”

有一种方法可以从结果的开头或结尾排除字符，即将搜索模式分解为子表达式。这将适用于您提供的字符串，因为我们可以将前导和尾随下划线与所需数字分开。不幸的是，*subexpressions*参数是[REGEXP_SUBSTR() 签名中的最后一个参数](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions150.htm#i1239858)，并且由于 SQL 函数不接受命名参数，这意味着我们必须显式传递所有其他参数的默认值。

无论如何，此调用将返回第二个子表达式，即所需的字符串`0043722`：

```
with t as (select 'RK_IPDR_RKMSG2_0043722_DT_20121113162710.txt' str from dual)
select regexp_substr(str, '(_)([0-9]+)(_)', 1,1,'i',2)
from t
/ 
```

* * *

用例*确实很*重要。REGEXP 函数的执行速度比更简单的等效函数慢。在 10gR2 中，REGEXP_SUBSTR() 至少比 SUBSTR() 慢一个数量级。当搜索大量字符串时，差异很明显，而当这个数字变成数百万时，差异就很明显了（披露：最近的痛苦）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:20:30.257

正则表达式周围的前导和尾随斜杠**与 regex 无关**。

它们是 perl/javascript 语言的产物。

尝试*不*使用斜线

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T01:59:39.847

Oracle 使用 POSIX ERE（扩展正则表达式） - 一个明显的例外是它添加了反向引用。但是 POSIX ERE 非常有限——它只需要很少的东西。尝试以下正则表达式：

```
/([0-9]{2}80|[0-9]80[0-9]|80[0-9]{2})$/ 
```

这会让你在最后四位数中得到 80。

```
/0515$/ 
```

这会让你得到 0515 作为最后四位数字。

现在，我从来没有使用过 Oracle，所以我不知道你是否需要分隔符，但这两个会起作用。中间的有点棘手。如果您可以只接受“是的，它就在那里”，那么您应该可以侥幸逃脱

```
/_0043722_/ 
```

但是如果您需要提取它，您应该能够找到一些修剪功能，让您指定要修剪的内容。你不能在 Oracle 中使用正则表达式。

哦，如果您需要将所有这三个组合成一个正则表达式：

```
/([0-9]{2}80|[0-9]80[0-9]|80[0-9]{2}|0515)$|_0043722_/ 
```

如果您将来需要正则表达式参考，请试试[这个网站](http://www.regular-expressions.info/refflavors.html)。

# arrays - 将图像 RGB 中的 R 分量保存到 VB.Net 2010 上的数组中

> ID：13426317
> 
> 赞同：1
> 
> 时间：2012-11-17T00:17:02.117
> 
> 标签：arrays, vb.net, visual-studio-2010, image, getpixel

我的程序中有这个脚本来读取图像的 R 组件并将其保存在数组中：

```
Dim citra_asli As Bitmap = New Bitmap(PictureBoxAsli.Image)

    Dim i As Integer = 0
    Dim j As Integer = 0

    Dim redValue(i, j) As Integer

    ListBox3.Items.Add("Piksel--R--G--B")
    For i = 0 To ((citra_asli.Height) - 1)
        For j = 0 To ((citra_asli.Width) - 1)
            Dim R As Integer = citra_asli.GetPixel(i, j).R
            redValue(i, j) = R
            ListBox3.Items.Add((i.ToString + ("," + (j.ToString + ("  " + (redValue(i, j).ToString))))))
        Next
    Next 
```

不幸的是，我总是收到此错误消息“索引超出了数组的范围。”。据我所知，redValue() 数组和 citra_asli 位图的尺寸相同，但为什么会出现错误消息？请有人帮助我，或者也许有另一种方法可以将其保存在数组中。谢谢你，请原谅我糟糕的英语。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T03:33:54.357

这应该是正确的，我已经测试过了。

```
 Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click

    Dim citra_asli As Bitmap = New Bitmap(PictureBoxAsli.Image)
    Dim x As Integer = 0
    Dim y As Integer = 0
    Dim R As Integer = 0

    ListBox1.Items.Add("Piksel--R--G--B")
    y = citra_asli.Height
    x = citra_asli.Width
    Dim redValue(x, y) As Integer
    For y = 0 To (citra_asli.Height) - 1
        For x = 0 To (citra_asli.Width) - 1
            R = citra_asli.GetPixel(x, y).R
            redValue(x, y) = R
            ListBox1.Items.Add("[" & x.ToString & "," & y.ToString & "]  " & "(" & redValue(x, y).ToString & ",grn,blu)")
        Next
    Next
End Sub 
```

# objective-c - 使用 CCRenderTexture 绘制的 runAction CCSprite

> ID：13426321
> 
> 赞同：1
> 
> 时间：2012-11-17T00:17:43.653
> 
> 标签：objective-c, cocos2d-iphone, xcode4.5

我需要蒙版 CCSprite，并使用 CCRenderTexture 来绘制具有该功能的精灵。它工作正常，但现在我正在尝试为这些精灵设置动画，但我想使用 runAction CCNode 方法来制作更复杂的动画：

```
CCSprite *sprite = [CCSprite spriteWithFile:@"file.png"];

self.rtx = [CCRenderTexture renderTextureWithWidth:980 height:726 pixelFormat:kCCTexture2DPixelFormat_RGBA8888];
self.rtx.position = CGPointMake(size.width / 2, size.height / 2);
[self addChild:self.rtx];

[self drawTexture:0];
[self schedule:@selector(drawTexture:) interval:0.1];

-(void)drawTexture:(ccTime)delta_{
    [self.rtx beginWithClear:0 g:0 b:0 a:0];
    [sprite visit];
    [self.rtx end];
} 
```

所以我想更新它的位置，例如：

```
[sprite runAction:[CCMoveBy actionWithDuration:10.0 position:CGPointMake(0, sprite.position.y + 1)]]; 
```

问题是我不知道它是否可能以及是否在哪里进行更新

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T10:57:52.793

您不想调用仅在 CCSprite 类中可用的方法吗？然后使用 CCSprite 类；）。

您可以使用以下命令将**CCRenderTexture 转换为 CCSprite**：

```
CCSprite *spriteFromRTX = [CCSprite spriteWithTexture:rt.sprite.texture];
spriteFromRTX.position = CGPointMake(size.width / 2, size.height / 2); 
```

不要忘记设置精灵的位置，因为它不会从渲染纹理中获取位置。

还要注意这个问题，CCSprite 可能已经翻转了 Y 轴。

但是您可以`flipY = YES`在生成的精灵上使用，请参阅：[http ://www.raywenderlich.com/4421/how-to-mask-a-sprite-with-cocos2d-1-0](http://www.raywenderlich.com/4421/how-to-mask-a-sprite-with-cocos2d-1-0)

正如 CCTexture2D.h 中提到的评论：

/** CCTexture2D 类。

*   此类允许从图像、文本或原始数据轻松创建 OpenGL 2D 纹理。

*   创建的 CCTexture2D 对象将始终具有二维的幂。

*   根据您创建 CCTexture2D 对象的方式，纹理的实际图像区域可能小于纹理尺寸，即“contentSize”！= (pixelsWide, pixelHigh) 和 (maxS, maxT) != (1.0, 1.0)。

*   请注意，生成的纹理的内容将是颠倒的！

*/

# wcf - Azure WCF webrole / Worker 角色混淆..

> ID：13426326
> 
> 赞同：1
> 
> 时间：2012-11-17T00:19:07.167
> 
> 标签：wcf, azure, azure-worker-roles, webrole

我有几个向云发送大量数据的硬件设备。我需要将它们存储在云端，处理它们并根据分析的数据向有兴趣查看这些结果的客户发送一些状态报告。客户是智能手机用户。

单个客户有兴趣了解一个或多个硬件状态报告。

我需要使用 Azure 使其可扩展，即能够监控 1000 多个硬件。我需要云存储、云计算能力以及从许多硬件发送数据并向监控这些硬件的客户发送报告的能力。

我是 WCF 和 Azure 的新手，任何有关如何使用 WCF 和 Azure 编写可扩展应用程序的指导都将非常有用。请解释它如何可扩展。我必须使用工作者角色/网络角色吗？我需要进行一些计算密集型数据处理来生成客户感兴趣的报告。

沙市

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T11:02:02.103

听起来是个有趣的项目...

您可以在 WCF 服务 Web 角色中托管 WCF 服务，这是一个带有用于托管 WCF 服务的启动工件的 Web 角色。

对于密集处理，您可以使用工作角色。当接收到数据时，WCF 服务会在服务总线队列上放置一条消息，该消息将由工作角色接收，该角色可以异步处理数据。

对于数据存储，您可以查看 Windows Azure 存储中的表和 Blob 存储，或者如果您需要关系存储，请查看 Windows Azure SQL 数据库。这两种方法各有利弊。

有相当多的技术需要评估，因此可能值得通过一些教程来了解什么是最佳实现。Windows Azure 培训工具包是一个很好的起点。

[http://www.microsoft.com/en-us/download/details.aspx?id=8396](http://www.microsoft.com/en-us/download/details.aspx?id=8396)

问候，

艾伦

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T04:23:45.977

您可以通过根据负载增加 Web 和 Worker 角色的实例来进行扩展。Azure 角色（云服务）是无状态的（默认情况下不支持粘性会话），因此来自同一客户端的请求响应将平均分配给您的所有实例（循环）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-09T05:24:10.167

@coolshashi。默认情况下，一个 Azure 云解决方案可以包含 5 个不同的角色（Web 或 Worker 的组合无关紧要）。这些角色中的每一个都可以有多个实例。例如：您的 Web 角色的 7 个实例可以形成您的前端 Web 场，将订单放在服务总线队列上。这些订单可能会被您的 Worker Role 的 2 个实例读取，它们会处理它们并将它们放入数据库中。

Web 角色和辅助角色之间的唯一区别是 Web 角色安装并启动了 IIS。

根据您定义的某些指标（即：CPU 使用率或队列中的消息），可以轻松配置每个角色的实例数以动态更改。因此，该解决方案可以扩大规模以处理负载并在不需要时缩小以节省资金。

大多数 Azure 订阅（或帐户）最初都限制为 20 个核心。这是为了防止您意外创建巨额账单。如果您的解决方案需要更多，与 Microsoft 的快速聊天可以消除该限制，从而为您提供尽可能多的服务。

# c++ - #define 宏在 opencv 中定义一个常量 Mat

> ID：13426328
> 
> 赞同：0
> 
> 时间：2012-11-17T00:19:14.430
> 
> 标签：c++, image-processing, opencv

比如说我在 opencv 中有一个 size(3,1) Mat 具有预先计算的值（不同的元素值），我想通过首先在头文件中使用 #define 宏定义它来在函数中使用它作为常量。因为它将在一个将被多次调用的函数中。我不想为每个调用初始化矩阵。是否可以在#define 宏中将矩阵定义为全局常量？如何 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-04T12:25:51.537

只要我知道你不能在多次出现的宏之间共享同一个对象（因为宏是由预处理器解析的，它基本上将宏定义的一段代码复制到宏调用的地方），所以我认为你应该坚持使用函数或静态方法。

您可以使用返回对所述 Mat 对象的引用的静态 Mat 对象（使用您的值初始化）定义函数（或静态方法）。可以通过 lambda 函数进行初始化。请参见以下示例：

```
const cv::Mat &getCustomConstMat()
{
    static cv::Mat customMat(
                []()
                ->cv::Mat
    {
        cv::Mat myMat(3,3, CV_8UC1);
        myMat.at<uchar>(0,0) = static_cast<uchar>(1);
        // here comes the rest of the initialisation
        return cv::Mat(myMat);
    }()
    );
    return customMat;
} 
```

在这个例子中，静态对象`customMat`只被初始化一次（在第一次调用函数时`getCustomConstMat`）。它从 lambda 函数的返回值初始化，该函数创建所需的对象，对其进行初始化并返回。这个 lambda 函数只执行一次 - 在静态`customMat`对象的初始化期间。

# java - 对于 EditText 类型，方法 getText() 未定义——如何？

> ID：13426331
> 
> 赞同：1
> 
> 时间：2012-11-17T00:19:30.467
> 
> 标签：java, android, android-edittext, gettext

是的，我对这个平台完全陌生，但是 getText() 是 EditText 的一种方法，不是吗？

我只是从我的简单应用程序中复制并粘贴了确切的错误，我从网络教程中逐字复制了该错误。我相信这是不言自明的。这是一个只有在拼写错误时才会出现的错误。下面是上下文。错误在第 3 行。

```
public void sendMessage (View view) {
    Intent intent = new Intent(this, DisplayMessageActivity.class);
    EditText editText = (EditText) findViewById(R.id.edit_message);
    String message = editText.getText().toString();
    intent.putExtra(EXTRA_MESSAGE, message);
    startActivity(intent);
} 
```

在任何情况下 getText() 都不会被视为 EditText 的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:38:14.723

> 在任何情况下 getText() 都不会被视为 EditText 的方法吗？

不，`getText()`是每个版本的方法`android.widget.EditText`。除非您创建了另一个名为 的类，否则`EditText`此错误可能是 Eclipse 被混淆了。只需转到**Project** -> **Clean...来清理您的项目**

* * *

**此外**
，通过使用 EditText 对 MainActivity 进行子类型化，您无意中创建了一个名为 EditText 的新本地类，它掩盖了 Android 的 EditText 类...通常，活动不需要子类型。所以改变这一行：

```
public class MainActivity<EditText> extends Activity { 
```

到：

```
public class MainActivity extends Activity { 
```

# objective-c - 如何从另一个类中的类调用方法

> ID：13426337
> 
> 赞同：1
> 
> 时间：2012-11-17T00:20:07.450
> 
> 标签：objective-c

我正在为 mac osx 开发一个新应用程序，在该应用程序中我使用拖放系统让用户输入一些文件 [这部分效果很好]，并且我有一个 tabelView，我想在其中显示文件的路径输入。我在 tabelViewController.m 中有下一个方法：

```
-(void)add{
    NSLog(@"da");
    [list addObject:[[Source alloc] init]];
    [tableView reloadData];
} 
```

在 DropView.mi 中包含了 tabelViewController.h，我正在尝试调用 add 方法，但它什么也不做：

```
#import "TableViewController.h"
.....
- (void)concludeDragOperation:(id<NSDraggingInfo>)sender{
    [self setNeedsDisplay:YES];
    TableViewController *tvc;
    [tvc add];
} 
```

有人可以弄清楚为什么它什么都不做吗？

Edit1：好的，在我放弃答案后，我的 finallyDragOperation 方法如下所示：

```
- (void)concludeDragOperation:(id<NSDraggingInfo>)sender{
    [self setNeedsDisplay:YES];
    TableViewController *tvc = [[TableViewController alloc] init];
    [tvc add];
    [tvc rD];
} 
```

rD 是来自 tableViewController 的方法，其中包含 reloadData 方法。但它不想工作它不重新加载表格视图。有什么想法？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:22:26.520

`tvc`需要指向一个实际的对象。`[[tvc alloc] init]` 否则，您只需调用 add on `nil`。这不会像您在其他语言中所期望的那样导致您的程序崩溃。试一试，看看会发生什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:50:31.487

似乎您错过了很多关于 OOP 和 Objective-C 如何工作的内容（说真的，没有冒犯）。

DropView.m 和 tableViewController.h 之间有什么链接？

通过键入`TableViewController *tvc;`您所做的就是创建一个指针。您既不是创建对象也不是指向对象，您只是简单地创建了一个指针，该指针最终*可以*指向内存中 tableViewController 类型的对象。

**解决方案：**

您需要做的是以某种方式在两个类之间创建链接。例如，您可以为 DropView 创建一个自定义委托方法，该方法可以与使用该自定义 DropViewDelegate 方法的任何类进行通信。因此，您可以创建一个委托方法，告诉遵循该委托协议的对象您刚刚完成了拖动操作。可以在我的[博客](http://achim.us/eli/iOS/archives/25)中找到如何执行此操作的教程[这是一个永久链接]。

我很高兴发布代码，或者您可以在我的博客上阅读。祝你好运。

# regex - 用它们的表示替换 unicode 转义字符串

> ID：13426338
> 
> 赞同：1
> 
> 时间：2012-11-17T00:20:09.683
> 
> 标签：regex

例如，我有一个像这样的文本字符串：（`\u041c\u0430\u0440\u0442\u0438\`字面意思就是这样），我想用正则表达式的文本表示替换那些转义，我不知道这是否可能。

我试过这个：

匹配：`\\u(....)`
替换：`\x\1`

我确实得到了这个结果：（`_0@B8`实际上`_`是空白空间，但它在降价中消失了）

我很高兴我什至从中得到了一些转换结果，因为老实说，我不认为有可能做到这一点。

这是我使用的工具中内置的 perl 兼容引擎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:00:50.250

在 Perl 中：

```
use Encode qw(encode);

$_ = '\u041c\u0430\u0440\u0442\u0438';
s/\\u([0-9a-f]{4})/{ encode('utf8', chr($1)) }/ige; 
```

# asp.net - asp.net FormView 显示没有数据绑定和数据源的ItemTemplate

> ID：13426353
> 
> 赞同：0
> 
> 时间：2012-11-17T00:22:38.630
> 
> 标签：asp.net, formview, asprepeater

我有一个 FormView，里面有一个中继器。为了呈现 ItemTemplate，我做了一个假数据源和数据绑定。然后我用 FindControl 寻找 Repeater 并执行另一个 DataSource 和 DataBind。所以在这种情况下，HardCodedData 只是一个让我租用 FormView ItemTemplate 的占位符。

```
FormView1.DataSource = HardCodedData;
FormView1.DataBind();

Repeater r = ((Repeater)FormView1.FindControl("repeater1"));
r.DataSource = GetMyData();
r.DataBind(); 
```

有没有更好的办法？我可以将 FormView 提供给租户而不提供虚假数据吗？或者我可以通过 FormView 数据源传递转发器数据吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T05:55:53.637

由于转发器控件位于表单视图内，因此您应该将此转发器控件绑定在表单视图的事件**DataBound**中，这样您将获得您想要获取的确切数据。将以下代码放入**FormView1_DataBound**事件中。

```
Repeater r = ((Repeater)FormView1.FindControl("repeater1"));
r.DataSource = GetMyData();
r.DataBind(); 
```

可能这个解决方案可以帮助你....

# sql - 使用子表查询以查找根表到任何级别，递归 CTE？

> ID：13426358
> 
> 赞同：3
> 
> 时间：2012-11-17T00:22:47.413
> 
> 标签：sql, recursion, common-table-expression

我正在尝试使用以下递归 CTE 查询从下到上查找表的引用表

```
With CTE_ALL AS
(
    SELECT
       1 as TopLevel, c.CONSTRAINT_NAME, cu.TABLE_NAME AS ReferencingTable,
           cu.COLUMN_NAME AS ReferencingColumn,ku.TABLE_NAME AS ReferencedTable,
           ku.COLUMN_NAME AS ReferencedColumn
      FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS c
     INNER JOIN INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE cu
           ON cu.CONSTRAINT_NAME = c.CONSTRAINT_NAME
     INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE ku
           ON ku.CONSTRAINT_NAME = c.UNIQUE_CONSTRAINT_NAME
     where cu.TABLE_NAME = 'my table name'
Union All
    SELECT
           2 as BelowLevels, c.CONSTRAINT_NAME, cu.TABLE_NAME AS ReferencingTable,
           cu.COLUMN_NAME AS ReferencingColumn,ku.TABLE_NAME AS ReferencedTable,
           ku.COLUMN_NAME AS ReferencedColumn
      FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS c
     INNER JOIN INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE cu
           ON cu.CONSTRAINT_NAME = c.CONSTRAINT_NAME
     INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE ku
           ON ku.CONSTRAINT_NAME = c.UNIQUE_CONSTRAINT_NAME
     INNER JOIN CTE_ALL CTE on CTE.ReferencedColumn = ku.COLUMN_NAME
           and CTE.ReferencedTable = ku.TABLE_NAME
)
select *
  from CTE_ALL
 where CTE_ALL.ReferencingTable = 'my table name' 
```

它错误地给出以下消息

```
Msg 530, Level 16, State 1, Line 1
The statement terminated. The maximum recursion 100 has been exhausted before
statement completion. 
```

这显然意味着我的查询被计划用尽所有 SQL 资源。Microsoft 的尽职调查可以防止这种情况发生。我想知道我是否可以在没有while循环的情况下使用单个查询并且没有临时表来做到这一点。

我知道我的根表名称和我的根列 id，我也知道我的叶节点表名称，虽然我不能说什么可能是叶节点列名称

我必须找到这个，因为我正在运行时设计一个查询并执行它。此查询需要在运行时构造 ON 子句之间的内部连接。不确定我是否有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T21:28:37.623

因此，经过几天的尝试和研究，我找到了一种帮助自己的方法，并且在了解递归 CTE 更好之后。

对于所有可能觉得它有用的人

这是我可以完成的查询

```
DECLARE @REFERENCED_COLUMN VARCHAR(50) = 'MyColumn'
DECLARE @REFERENCING_TABLE VARCHAR(50) = 'MyTable'

    ;WITH
        CTE_Relationship (ReferencingTable, ReferencingColumn, ReferencedTable, ReferencedColumn) AS
        (
            SELECT
                CU.TABLE_NAME AS ReferencingTable, CU.COLUMN_NAME AS ReferencingColumn,
                KU.TABLE_NAME AS ReferencedTable, KU.COLUMN_NAME AS ReferencedColumn
            FROM
                INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS C
                INNER JOIN INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE CU ON CU.CONSTRAINT_NAME = C.CONSTRAINT_NAME
                INNER JOIN INFORMATION_SCHEMA.KEY_COLUMN_USAGE KU ON KU.CONSTRAINT_NAME = C.UNIQUE_CONSTRAINT_NAME
        ),
        CTE_Recursive_Relationship (ReferencingTable, ReferencingColumn, ReferencedTable, ReferencedColumn, Pass) AS
        (
            SELECT
                R.ReferencingTable, R.ReferencingColumn, R.ReferencedTable, R.ReferencedColumn, 1 AS Pass
            FROM
                CTE_Relationship R
            WHERE
                R.ReferencingTable = @REFERENCING_TABLE

        UNION ALL

            SELECT
                R.ReferencingTable, R.ReferencingColumn, R.ReferencedTable, R.ReferencedColumn, RR.Pass + 1
            FROM
                CTE_Relationship R
                INNER JOIN CTE_Recursive_Relationship RR ON R.ReferencingTable = RR.ReferencedTable
                    AND R.ReferencedColumn = @REFERENCED_COLUMN
        )
        SELECT
            DISTINCT RR.*
        FROM
            CTE_Recursive_Relationship RR
        ORDER BY RR.Pass 
```

# javascript - 在多边形中找到凸角和凹角

> ID：13426362
> 
> 赞同：3
> 
> 时间：2012-11-17T00:23:28.287
> 
> 标签：javascript, polygon, convex, concave

我试图检测任意多边形中的角是凹的还是凸的。我制作了下面的函数来计算所有边对之间的角度。但是，人们永远不知道它返回的是内角还是外角。我不知道该怎么做。任何帮助表示赞赏！！！！

```
function findConvexCorner (pt){
var isCornerConvex = [];
for (var i =0; i < pt.length ;i++)
{
    var lastPt = pt.length -1;
    if (i==0){
        var vec1 = vec3.createXYZ( pt[lastPt].x - pt[i].x , pt[lastPt].y - pt[i].y ,0.0);
        var vec2 = vec3.createXYZ( pt[i].x - pt[i+1].x , pt[i].y - pt[i+1].y ,0.0);
        vec3.normalize(vec1);vec3.normalize(vec2);
            isCornerConvex.push(Math.acos(vec3.dot(vec1,vec2))*180/Math.PI);}
    else if(i == lastPt){
        var vec2 = vec3.createXYZ( pt[i-1].x - pt[i].x , pt[i-1].y - pt[i].y ,0.0);
        var vec1 = vec3.createXYZ( pt[0].x - pt[i].x , pt[0].y - pt[i].y ,0.0);
        vec3.normalize(vec1);vec3.normalize(vec2);
            isCornerConvex.push(Math.acos(vec3.dot(vec1,vec2))*180/Math.PI);}
    else{
        var vec1 = vec3.createXYZ( pt[i-1].x - pt[i].x , pt[i-1].y - pt[i].y ,0.0);
        var vec2 = vec3.createXYZ( pt[i+1].x - pt[i].x , pt[i+1].y - pt[i].y ,0.0);
        vec3.normalize(vec1);vec3.normalize(vec2);
            isCornerConvex.push(Math.acos(vec3.dot(vec1,vec2))*180/Math.PI);}
}
console.log("Angle: "+ isCornerConvex);
} 
```

![问题](../Images/fb8938ad899109c3112861d405cf52e9.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-03T13:49:42.490

这是一些计算凹角和凸角的代码：

```
// this assumes nextEdge and previousEdge are vectors pointing out of a vertex and to the next one
var angle = ((Math.atan2(nextEdge.x, nextEdge.y) - Math.atan2(previousEdge.x, previousEdge.y) + Math.PI * 2) % (Math.PI * 2)) - Math.PI;

if (angle > 0) {
   corner.type = 'convex';
} else if (angle < 0) {
    corner.type = 'concave';
} else {
    corner.type = 'straight';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T07:28:45.310

关于您尝试做的事情的更多细节可能会有所帮助。话虽如此，似乎生成凸包的算法可能有用。比如下面，这大概是效率和易于实现的最佳平衡：

[http://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain](http://en.wikibooks.org/wiki/Algorithm_Implementation/Geometry/Convex_hull/Monotone_chain)

一旦您知道哪些点是凸包的一部分，其余的应该会更直接一些。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-23T02:21:28.553

一个简单的方法是评估向量行列式。

首先，我们确保多边形是顺时针/逆时针的（使用鞋带法）。

让我们顺时针走。这意味着您的所有内角都可以被认为是在各个相邻边之间逆时针绘制。

假设对于边 AB 和 BC 之间的特定角度 ABC，我们可以计算向量 BA 和 BC 之间的行列式（ad - bc 公式）。

如果行列式 <= 0，则选择凹角（即 360 - 向量之间的角度）。如果 det 大于 0，我们取凸角。希望这可以帮助

# php - 如何获得这项工作 Div addClass

> ID：13426363
> 
> 赞同：1
> 
> 时间：2012-11-17T00:23:29.383
> 
> 标签：php, javascript

我尝试完成这项工作，但还没有运气，为什么当 stats.php 中的数字更新时 DIV 不突出显示（闪烁）？

在 stats.php

```
<div id="student_today"><b>$<?php print getTodayStats($collageid); ?></b></div>
Month:
<div id="student_month"><b>$<?php print getMonthStats($collageid); ?></b></div> 
```

div的以下样式：

```
.stats_highlight{
background: #03B1EE;
border-top-color: #03B1EE;
z-index: 10;
color: #fff; 
```

在 main.php 中：

```
 <tr class="live">
                    <td width="267">
                      <p align="left">Today's Students:</p></td>
                    <td width="201">
                      <p align="left">&nbsp;</p></td>
                    <td width="220">
                      <span value="value" id="student_today"></span></td>
                  </tr>
                  <tr class="live">
                    <td width="267">
                      <p align="left">Month's students:</p></td>
                    <td width="201">
                      <p align="left">&nbsp;</p></td>
                    <td width="220">
                      <span class="value" id="student_month"></span></td>
                  </tr> 
```

我需要有人可以指导我解决这个问题。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:50:38.457

你的问题：

> 您好，这里有人可以指导我如何获取 javascript addClass in 吗？

使用 jQuery 的答案：

```
$('#test').click(function(){
  $(this).addClass('newClass').removeClass('initialClass');
}); 
```

见[演示](http://jsfiddle.net/salih0vicX/YCst4/398/ "演示")。

您需要点击`'Some text here'`（SPAN 内容）；比 jQuery 将替换 initialClass 为`newClass`. ..

**编辑：**

以下是您最初的问题（关于您的评论）：

现场**[演示](http://jsfiddle.net/salih0vicX/YCst4/398/ "演示")**

现在，以防你需要淡出；替换类并淡入。如果您需要它而不需要类替换，那么它甚至可以使用更少的代码。请随意玩演示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:58:20.763

我可能煮过头了，但这会起作用

```
setTimeout(function(){
                        $("#messagebox").fadeIn("slow", function () {
                        $("#messagebox").addClass("messageboxcss");
                        });
                        }, 1000); 

setTimeout(function(){
                        $("#messagebox").fadeOut("slow", function () {
                        $("#messagebox").removeClass("messageboxcss");
                        });
                        }, 2000); 
```

​</p>

[**JSFIDDLE**](http://jsfiddle.net/UUdTs/1/)

# c - MULTITHREADING c - 在同一个文件中读取多个文件

> ID：13426365
> 
> 赞同：1
> 
> 时间：2012-11-17T00:24:06.247
> 
> 标签：c, multithreading, pthreads, mutex

我是多线程的新手，我正在尝试使用多线程在同一个经常账户上模拟银行交易。每个线程从文件中读取要执行的操作。该文件将包含一个由整数组成的每一行的操作。主程序必须创建与路径中的文件一样多的线程。

```
int main(int argc,char*argv[]){

  DIR *buff;
struct dirent *dptr = NULL;
pthread_t hiloaux[MAX_THREADS];     
int  i=0,j=0, nthreads=0;
char *pathaux;

memset(hiloaux,0,sizeof(pthread_t)*MAX_THREADS);
diraux=malloc((267+strlen(argv[1]))*sizeof(char));
buff=opendir(argv[1]);
while((dptr = readdir(buff)) != NULL && nthreads<MAX_THREADS)//read files in the path
    {

    if (dptr->d_name[0]!='.'){    
        pthread_mutex_lock(&mutex_path);//mutual exclusion  
        strcpy(pathaux,argv[1]);        
        strcat (pathaux,"/");
        strcat (pathaux,dptr->d_name);//makes the route (ex:path/a.txt)

        pthread_create(&hiloaux[nthreads],NULL,readfile,(void *)pathaux);
        //creates a thread for each file in the path
                   nthreads++;
    }

}

for (j=0;j<nthreads;j++){
pthread_join(hiloaux[j],NULL);
}

  closedir(buff);
  return 0;

} 
```

我的问题是线程似乎没有收到正确的路径参数。即使我放置了一个互斥体，（mutex_path）它们都读取同一个文件。我在函数 readfile(), 中解锁了这个互斥锁。

```
void *readfile(void *arg){
FILE *fichero;
int x=0,n=0;
int suma=0; 
int cuenta2=0;

char * file_path = (char*)arg;
n=rand() % 5+1; //random number to sleep the program each time I read a file line
pthread_mutex_unlock(&mutex_path);//unlock the mutex

fichero = fopen(file_path, "r");

    while (fscanf (fichero, "%d", &x)!=EOF){

           pthread_mutex_lock(&mutex2);//mutual exclusion to protect variables(x,cuenta,cuenta2)        

         cuenta2+=x;    

          if (cuenta2<0){
        printf("count discarded\n");
          }

          else cuenta=cuenta2;      
          pthread_mutex_unlock(&mutex2);

    printf("sum= %d\n",cuenta);
    sleep(n); //Each time i read a line,i sleep the thread and let other thread read other fileline
}
 pthread_exit(NULL);
fclose(fichero); 
```

当我运行程序时，我得到这个输出

```
alberto@ubuntu:~/Escritorio/practica3$ ./ejercicio3 path
read file-> path/fb
read -> 2
sum= 2
read file-> path/fb
read -> 2
sum= 2
read file-> path/fb
read -> 4
sum= 6
read file-> path/fb
read -> 4
sum= 6
read file-> path/fb
read -> 6
sum= 12
read file-> path/fb
read -> 6
sum= 12 
```

它似乎运行良好，它读取一行并休眠一段时间，在此期间另一个线程执行它的工作，但问题是两个线程都打开同一个文件（路径/fb）。正如我之前所说，我认为问题出在路径参数上，就像 mutex_path 没有使他的工作一样。我真的很感激这方面的一点帮助，因为我真的不知道出了什么问题。

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:52:56.133

在你的“readfile”函数中

线

char * file_path = (char*)arg;

只需将指针复制到字符串内存而不是内存本身。因此，当工作线程继续时，它仍然可以（并且将）由人线程更改。

在那里制作一份记忆副本。

或者甚至更好地将线程的所有参数存储在主线程的不同内存中，因此您根本不需要第一个互斥锁。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:53:59.043

首先，我看不到您为 pathaux 分配内存的位置。我想知道 strcpy 或 strcat 是如何工作而不是内存分段的。尝试使用 C++ 编译器进行编译，它可能会抱怨。

至于你正在传递指针的问题，所以每个线程都指向相同的位置。正确的方法是在 readdir 循环内 - 1\. 创建内存并将路径复制到它。（注意你希望每次循环都创建内存） 2\. 将此内存传递给新线程。如果你这样做：您不必使用互斥体路径。湾。在 readfile 方法结束时调用 free。

# c# - 将新客户添加到 Quickbooks 2013

> ID：13426368
> 
> 赞同：1
> 
> 时间：2012-11-17T00:24:23.777
> 
> 标签：c#, quickbooks

我有一个将客户添加到 Quickbooks 2013 的应用程序，如果没有新客户，它会使用以前版本的 SDK (11) 和 Quickbooks (2012)，它只是自动添加它。随着升级到 QB 2013 和最新版本的 SDK (12)，我收到一条消息，说我需要先将客户添加到 Quickbooks。我在我的应用程序中更改/添加的唯一代码是添加对新 SDK 的适当引用。有没有可能的解决方案？很抱歉没有发布代码，我只是继承了这个应用程序，还在搞清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T17:30:38.843

SDK 12 的 CustomerMod 消息的行为没有变化。当您测试 SDK 11 版本的插件时，您似乎遗漏了一些东西：客户已经存在，或者代码正在为您添加客户。

# actionscript-3 - 单击按钮时如何删除组合框组件 flash as3

> ID：13426369
> 
> 赞同：0
> 
> 时间：2012-11-17T00:24:43.040
> 
> 标签：actionscript-3, flash, combobox, flash-cs5

我在 flash cs5 中的组合框有问题。我按照此处的指南创建了一个组合框[http://help.adobe.com/en_US/as3/components/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa9.html](http://help.adobe.com/en_US/as3/components/WS5b3ccc516d4fbf351e63e3d118a9c65b32-7fa9.html)

我的 AS3 代码如下：

```
import fl.controls.ComboBox; 
import fl.data.DataProvider; 
import flash.net.navigateToURL; 

var sfUniversities:Array = new Array( 
    {label:"University of California, Berkeley",  
                data:"http://www.berkeley.edu/"}, 
    {label:"University of San Francisco",  
                data:"http://www.usfca.edu/"}, 
    {label:"San Francisco State University",  
                data:"http://www.sfsu.edu/"}, 
    {label:"California State University, East Bay",  
                data:"http://www.csuhayward.edu/"}, 
    {label:"Stanford University", data:"http://www.stanford.edu/"}, 
    {label:"University of Santa Clara", data:"http://www.scu.edu/"}, 
    {label:"San Jose State University", data:"http://www.sjsu.edu/"} 
); 

var aCb:ComboBox = new ComboBox(); 
aCb.dropdownWidth = 210; 
aCb.width = 200;  
aCb.move(150, 50); 
aCb.prompt = "San Francisco Area Universities"; 
aCb.dataProvider = new DataProvider(sfUniversities); 
aCb.addEventListener(Event.CHANGE, changeHandler); 

addChild(aCb); 

function changeHandler(event:Event):void { 
    var request:URLRequest = new URLRequest(); 
    request.url = ComboBox(event.target).selectedItem.data; 
    navigateToURL(request); 
    aCb.selectedIndex = -1; 
} 
```

我在与组合框相同的帧上还有一个简单的后退按钮，单击该按钮可将您带到上一帧。

我的按钮：

```
btnBack.addEventListener(MouseEvent.CLICK, clickBack);

function clickBack(event:MouseEvent):void
{
    gotoAndStop(333);
} 
```

问题是当点击按钮时，组合框停留在屏幕上。我希望组合框仅在单个框架中可见。

单击按钮后如何摆脱组合框？

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T13:37:22.020

在这种情况下使用：

```
removeChild(aCb); 
```

如果您希望垃圾收集器清理它（或使用弱事件侦听器），请记住删除事件侦听器。

# sql-server-2008 - 从多个表中插入

> ID：13426373
> 
> 赞同：0
> 
> 时间：2012-11-17T00:24:57.143
> 
> 标签：sql-server-2008, sql-server-2005

```
Insert into po_header 
(Code,Date,Status,Month_Period,Year_Period,Created_Date,Created_User)

(Select PO_PR from Purchasing_Default Where Defaults = 'Default PO'),
GETDATE(),
'Saved',
(Select Details from Lookup Where Code ='Month_Period'),
(Select Details from Lookup Where Code ='Year_Period'),
GETDATE(),
'' 
```

返回错误：

消息 102，级别 15，状态 1，第 5 行 ',' 附近的语法不正确。消息 102，级别 15，状态 1，第 8 行 ',' 附近的语法不正确。消息 102，级别 15，状态 1，第 9 行 ',' 附近的语法不正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T01:06:55.427

在列出的值之前添加 Select 语句

```
Insert into po_header 
(Code,Date,Status,Month_Period,Year_Period,Created_Date,Created_User)
Select (Select PO_PR from Purchasing_Default Where Defaults = 'Default PO'),
       GETDATE(),
       'Saved',
       (Select Details from Lookup Where Code ='Month_Period'),
       (Select Details from Lookup Where Code ='Year_Period'),
       GETDATE(),
       '' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T05:16:15.040

您需要在尝试插入之前创建一个有效的数据集；您能否编写一个 SELECT 语句来返回您希望插入到目标表中的所有列和行？如果没有更好地了解您的表格和关系，就很难给您更具体的建议，但显然您正在尝试的内容是无效的。但是，类似：

```
INSERT INTO TABLE (col1, col2, col3)
SELECT a.col1, b.col2, b.col3
FROM a JOIN b on a.ID = b.ID 
```

将工作。

HTH。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T13:16:17.793

我通过如下全局变量解决了它：声明@PO_PR varchar(50); 声明@Month_Details varchar(50); 声明@Year_Details varchar(50); 设置@PO_PR =（从 Purchasing_Default 中选择 PO_PR，其中 Defaults = 'Default PO'）；设置@Month_Details =（从代码='Month_Period'的查找中选择详细信息）；设置@Year_Details =（从代码='Year_Period'的查找中选择详细信息）；

```
Insert into po_header (Code,Date,     
[Status],Month_Period,Year_Period,Created_Date,Created_User)

Values(
@PO_PR,
GETDATE(),
'Saved',
@Month_Details,
@Year_Details,
GETDATE(),
''); 
```

# python - ZeroMQ 第二次连接因 einval 失败

> ID：13426374
> 
> 赞同：0
> 
> 时间：2012-11-17T00:25:04.267
> 
> 标签：python, c, zeromq, pyzmq

我有一个 C-ZMQ 客户端，它接收两个随机端口（来自`pyzmq`服务器）然后连接到它们。

通常，一切正常，但有时第二次连接失败，errno 设置为`EINVAL`. （即使我在连接调用之间切换，第二个仍然失败）。

端口号很好，看起来像是 ZeroMQ 中的某种竞争条件。

任何人都知道我该如何解决这个问题？

[**编辑**]：

服务器发送此结构中的端口“ `port1:port2`”例如“ `1234:1235`”服务器上的数据包的 hexdump 是`31 32 33 34 3a 31 32 33 35` ，客户端上是`31 32 33 34 3a 31 32 33 35 01`

并且因为第二次连接的额外字节失败......

也许这是我使用 zmq ver 2.2.0之间`pyzmq`的某种兼容性错误`zmq`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T05:52:55.337

这不是 zmq 中的竞争条件，也不是 zmq_connect 的问题。那个额外的 0x01 字节可能是有问题的。如果你将它传递给 zmq_connect，除了 EINVAL，你期望什么结果？

那么这个额外的字节是从哪里来的呢？您是否在两个对等方之间发送的所有消息中都得到它？你在这个程序中有什么不同？

由于您没有提供源代码，因此很难提供比这更详细的建议。

# html - 在 href 中使用环境变量

> ID：13426375
> 
> 赞同：0
> 
> 时间：2012-11-17T00:25:04.727
> 
> 标签：html, xhtml

我有以下 .xhtml 文件

```
<h:body>
        You have been logged out. Click here <a href="http://mytestserver.com/MyApp/HomePage.jsf">Login</a>   to logon again.  
</h:body> 
```

现在[http://mytestserver.com](http://mytestserver.com)在测试和生产上是不同的。所以我使用环境变量 MY_URL=http://mytestserver.com/MyApp/HomePage.jsf MY_URL=http://myprodserver.com/MyApp/HomePage.jsf

我如何引用 MY_URL heremin href

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:49:00.803

正如评论所建议的，只需使用相对路径：

```
<h:body>
    You have been logged out. Click here <a href="/MyApp/HomePage.jsf">Login</a>   to logon again.  
</h:body> 
```

问题解决了，你可以在任何你喜欢的服务器上托管它，不需要变量。

# php - 如何在正则表达式中引用捕获组？

> ID：13426376
> 
> 赞同：0
> 
> 时间：2012-11-17T00:25:15.283
> 
> 标签：php, regex

有没有办法在正则表达式中引用捕获组？

例如，如果您有 2 个字符串，则其中一个是：

```
Person: Name is Bob. Type: Person 
```

和另一个：

```
Animal: Name is Jupiter. Type: Animal 
```

你能做这样的事情：

```
(Person|Animal): Name is (.+). Type: $1 
```

这个想法是，使用第一个捕获组的结果来确定它是人还是动物，然后将结果放在哪里`$1`，完成句子。

如果不是用 $1，那么可以用任何其他操作员来完成这样的事情吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:29:09.383

如果您指的是 PCRE，您可以在模式 ( `'\1'`, &c.) 或命名的 ( `'(?P=pattern-name)'`) 中使用编号的反向引用。

# c++ - 基础和派生虚拟析构函数的效果

> ID：13426378
> 
> 赞同：6
> 
> 时间：2012-11-17T00:25:28.427
> 
> 标签：c++, memory-leaks, derived, virtual-destructor

我对多个虚拟析构函数有了一些重新考虑，尤其是。在阅读[http://blogs.msdn.com/b/oldnewthing/archive/2004/05/07/127826.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2004/05/07/127826.aspx)之后。

假设我有

```
class Base
{
    public:
        Base();
        virtual ~Base();

    private:
        Logger* _logger;
};

//and

class Derived : public Base{
    public:
        Derived();
        virtual ~Derived();

    private:
        Logger* _logger;
}; 
```

在 cpp 文件中，在每个析构函数中，我正在删除相应的`_logger`指针

```
Base::~Base(){  //base.cpp
    delete _logger;
}
Derived::~Derived(){ //derived.cpp
    delete _logger;
} 
```

这会按我的预期工作，没有内存泄漏吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T00:48:45.713

首先，如果你创建了基类 destructor ，那么无论你声明它们为与否`virtual`，所有派生类都会自动获得一个析构函数。这对于匹配签名通常是正确的：如果基类具有与派生类中的函数具有相同签名的函数，则派生类中的函数是 an和 is （尽管在 C++ 2011 中，您可以使用关键字防止进一步覆盖在这种情况下，另一个覆盖会产生错误）。`virtual``virtual``virtual``override``virtual``final`

也就是说，析构函数是特殊的：当你创建一个析构函数时`virtual`，即使有另一个覆盖的析构函数，它仍然会被调用！析构函数存在的唯一影响`virtual`是，如果您`delete`的对象使用指向基类的指针，而该对象实际上恰好是派生类型，则会发生什么：如果析构函数不是`virtual`，您将获得未定义的行为，而正确的事情发生析构函数是`virtual`. 例如：

```
class not_a_base {};
class bad_idea: public not_a_base {};

class a_base { public: virtual ~a_base() {} };
class ok: public a_base {};

int main() {
    a_base* ab = new ok;
    delete ab; // <---- all is good here!

    not_a_base* nab = new bad_idea;
    delete nab; // <---- results in undefined behavior
} 
```

默认情况下不使用析构函数的原因`virtual`很简单，这意味着对象大小总是增加一个字长，这通常是不可接受的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T00:44:52.920

`Base::_logger`那么 是一个不同的变量`Derived::_logger`。所以你应该`Derived::_logger`在 Derived 的 dctor 中删除，否则你会泄漏内存。

请注意，这与它是私有的无关。考虑这个示例程序：

```
#include <iostream>

class A {
public:
    bool foo;
};

class B: public A {
public:
    bool foo;
};

int main()
{
    B b;
    std::cout << &b.B::foo << ' ' << &b.A::foo << '\n';
} 
```

地址不一样。这意味着它们是不同的变量，即使它们具有相同的名称。这是可能的，因为每个类都引入了自己的命名空间，因此名称不会真正发生冲突。第一个是 A::foo，另一个是 B::foo。

由于您的析构函数是虚拟的，因此两者都将被调用，并且正确的`_logger`将在它们中被删除。

# objective-c - Alpha 使用 UIView animateWithDuration 立即改变：而不是动画

> ID：13426381
> 
> 赞同：4
> 
> 时间：2012-11-17T00:25:51.913
> 
> 标签：objective-c, animation, uiview

我试图淡入我通过动画 alpha 创建的 UIView。我需要将其淡入，让它可见几秒钟，然后淡出。

淡出功能工作正常。视线平稳地消失了。但是淡入只是使视图立即出现，而不是在 0.5 秒的时间间隔内缓慢出现。

所以看起来动画的淡入淡出不起作用，只是立即将 alpha 设置为`1.0`. 我在这里有点不知所措。任何想法我做错了什么？谢谢！

```
-(void)presentPopupPhrase:(NSString *)phrase 
                   inView:(UIView *)view 
             withDelegate:(id)delegate 
            andCompletion:(void (^)(BOOL completed))completion {

    MessagePopupView *pv = [[[MessagePopupView alloc] initWithFrame:self.frame andText:phrase] autorelease];
    pv.alpha = 0.0;
    [view addSubview:pv];

    [self fadeInMPV:pv 
       withDuration:self.fadeDuration 
           andDelay:self.fadeInDelay];

    [self fadeOutMPV:pv 
        withDuration:self.fadeDuration 
          afterDelay:self.fadeOutDelay 
      withCompletion:completion 
         andDelegate:delegate];
}

-(void)fadeInMPV:(MessagePopupView *)mpv 
    withDuration:(NSTimeInterval)duration 
        andDelay:(NSTimeInterval)delay 
{    
    [UIView animateWithDuration:duration 
                          delay:delay 
                        options:UIViewAnimationOptionCurveLinear 
                     animations:^{
                         mpv.alpha = 1.0;
                     } 
                     completion:nil];
}

-(void)fadeOutMPV:(MessagePopupView *)mpv
     withDuration:(NSTimeInterval)duration
       afterDelay:(NSTimeInterval)delay
     withCompletion:(void (^)(BOOL completed))completion
      andDelegate:(id)delegate 
{
    [UIView animateWithDuration:duration 
                          delay:delay 
                        options:UIViewAnimationOptionCurveLinear 
                     animations:^{
                         mpv.alpha = 0.0;
                     } 
                     completion:completion];
} 
```

**编辑：**

如果有帮助，这是我从中调用它的 VC 代码：

```
-(void)viewDidAppear:(BOOL)animated {

    CGRect phraseFrame = CGRectMake(20, 341, 280, 65);
    PopupPhraseController *phraseController = [[[PopupPhraseController alloc] initWithFrame:phraseFrame] autorelease];

    [phraseController presentPopupPhrase:@"Test Phrase" inView:self.view withDelegate:self andCompletion:^(BOOL completed){
        if (completed) {
            NSLog(@"completed");
        } else {
            NSLog(@"not completed");
        }
        NSLog(@"blocked!");
    }];

    [super viewDidAppear:animated];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:22:01.093

你不能像这样链接动画，因为第二个动画块基本上会导致第一个被取消。

[将多个动画链接在一起](http://developer.apple.com/library/ios/documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/AnimatingViews/AnimatingViews.html#//apple_ref/doc/uid/TP40009503-CH6-SW10)有两种选择：

1.  使用第一个动画的完成处理程序
2.  嵌套动画但延迟第二个

* * *

1.  看起来像这样

    ```
    [UIView animateWithDuration:self.fadeDuration
                          delay:self.fadeInDelay
                        options:UIViewAnimationOptionCurveLinear 
                     animations:^{
                       pv.alpha = 1.0;
                     } completion:^(BOOL finished) {

                       [UIView animateWithDuration:self.fadeDuration
                                             delay:self.fadeOutDelay
                                           options:UIViewAnimationOptionCurveLinear 
                                        animations:^{
                                          pv.alpha = 0.0;

                                        } completion:completion];
                     }]; 
    ```

2.  看起来像这样

    ```
    [UIView animateWithDuration:self.fadeDuration
                          delay:self.fadeInDelay
                        options:UIViewAnimationOptionCurveLinear 
                     animations:^{
                       pv.alpha = 1.0;

                       [UIView animateWithDuration:self.fadeDuration
                                             delay:self.fadeOutDelay + self.fadeDuration
                                           options:UIViewAnimationOptionCurveLinear 
                                        animations:^{
                                          pv.alpha = 0.0;
                                        } completion:completion];

                     } completion:nil]; 
    ```

* * *

问题在于您设置动画的方式。

当您在视图上设置动画属性时，视图的支持模型会立即更新。因此，当您`alpha = 1.0`在第一个块中设置时，视图的支持数据模型具有 alpha `1.0`，然后实际动画在另一个线程上启动以显示两个值之间的插值。

当您在第一个块之后直接定义第二个块时，视图基本上说“好的，我需要从`1.0`（模型中的当前值）动画到`0.0`”，这就是为什么您看不到您所期望的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-11T01:38:29.777

感谢 Paul.s 在那里提供了提示。我认为这种预期的行为有点奇怪，即使从低层次的角度来看它似乎是合乎逻辑的。

为了扩展保罗的 2 个解决方案，有一个更好的 IMO 的第 3 个解决方案。

使用 GCD 为淡出代码添加延迟，如下所示：

```
//Make sure this delay exceeds your fade-in time...
double delayInSeconds = 2.0;
dispatch_time_t popTime = dispatch_time(DISPATCH_TIME_NOW, (int64_t)(delayInSeconds * NSEC_PER_SEC));

dispatch_after(popTime, dispatch_get_main_queue(), ^(void){
    [self fadeOutMPV:pv
        withDuration:self.fadeDuration
          afterDelay:self.fadeOutDelay
      withCompletion:completion
         andDelegate:delegate];
}); 
```

这个解决方案更好，因为执行视图控制器不仅可以完全控制何时触发淡出，还可以控制什么触发淡出（例如，用户操作）。

# php - Jquery无法处理返回值是php代码

> ID：13426386
> 
> 赞同：2
> 
> 时间：2012-11-17T00:27:18.277
> 
> 标签：php, jquery, html, ajax

我正在尝试使用简单的代码来使用 jquery 获取城市名称，但结果我总是得到我命令处理的完整 php 代码，尽管我使用的这些代码与来自互联网的源代码不同

这是代码，

### jQuery

```
$('input#name-submit').on('click', function() {
    var name = $('input#name').val();
    var namempty = '';
    if ($.trim(name) != '') {
        $.post('ajax/name.php', {
            nameSend: name
        }, function(data) {
            alert("Data Loaded: " + data);
        });
    } else {
        $('div#name-data').text(namempty);
    }
});​ 
```

### php“name.php”

```
if (isset($_POST['nameSend'])=== true && empty($_POST['nameSend']) === false) {
    require '../db/connect.php';

    $query = mysql_query("SELECT city.cityId FROM city 
        WHERE city.cityName='"
        . mysql_real_escape_string(trim($_POST['nameSend']))."' "
    );

    echo (mysql_num_rows ($query)!== 0 ) 
        ? mysql_result($query,0,'location') : 'Name Not Found !!!';
} 
```

我请求处理的 name.php 根本不处理它只返回结果，就像 name.php 的代码一样，我已经在使用另一个服务器，如 WAMP / XAMPP，但仍然没有得到我需要的结果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T14:56:46.233

只要我尝试过，它看起来是因为服务器软件错误，我已经使用

*   XAMPP 1.7.7 lite USB --> 工作正常
*   XAMPP 1.7.7 完整安装 --> 工作正常
*   XAMPP 1.8.1 lite USB --> 错误
*   XAMPP 1.8.1 完整安装 --> 错误
*   WAMP --> 错误

怀疑是最新的 apache 服务器与 jquery 插件或 php 不兼容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T00:59:25.040

如果返回整个 php 代码，则您的 php 代码可能没有被执行。这可能是服务器配置问题。

另一方面，检查您的 mysql 语句返回的内容。它真的只返回城市名称吗？对我来说，您似乎正在那里获取一些城市ID。

为了通常清理 php 脚本的返回值，我建议使用 json。从您需要的数据库中获取数据，并将其存储在例如`$object`. 然后执行以下操作：

```
$object = json_encode($object)
echo $object; 
```

这会将数据转换为格式良好的对象，可以在您的 jQuery 代码中使用，如下所示：

```
var json = $.parseJSON(data); //data being the callback parameter
alert(json.attr1);
alert(json.attr2); //all attributes that the object had in the php code are accessible through this 
```

**总结一下：**调试您的查询，确保您的 php 服务器确实工作（当您直接在浏览器中打开 name.php 时会发生什么？）并通过 json 使用干净的回调。

**编辑**

要调试您的查询，请在脚本的开头说

```
echo "SELECT city.cityId FROM city WHERE city.cityName='".mysql_real_escape_string(trim($_POST['nameSend']))."'";
exit; 
```

在浏览器中打开脚本。您将看到您的查询在屏幕上回显。复制查询并将其粘贴到您的数据库面板（可能是 phpmyadmin）并执行查询，看看它是否返回任何错误消息。

# visual-studio - Visual Studio 2012 中的会话/工作集

> ID：13426388
> 
> 赞同：5
> 
> 时间：2012-11-17T00:27:25.313
> 
> 标签：visual-studio, session, visual-studio-2012, ide

有什么方法可以在 Visual Studio 中保存“会话”/“工作集”。通过会话（例如：Notepad++ 中的会话）我的意思是对我正在查看的一堆文件进行分组，以便我可以保存并重新打开同一组文件。类似的概念存在于当然适用于项目的eclipse“工作集”中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-17T04:24:55.440

我能够创建这样一个会话的方式是：

1.  使用注册表中的“图像文件执行选项”为要调试的 .exe 启用自动启动调试器（请参阅[http://msdn.microsoft.com/en-us/library/a329t4ed%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/a329t4ed%28v=vs.100%29.aspx)） . .exe 可以是任何可执行文件，例如 notepad.exe，以防您对调试不感兴趣。
2.  运行.exe。
3.  在弹出的“Visual Studio Just-In-Time Debugger”对话框中，选择“New instance of Microsoft Visual Studio 20xx”，单击“Yes”。
4.  在新实例中，根据需要打开文件并执行“全部保存”以将 .sln 文件保存在所需位置。您的会话（包括打开的文件和断点）将与 .sln 一起保存在 .suo 文件中。

# java - 从 netbeans 中删除不需要的目录文件夹并修复“已在版本控制下”

> ID：13426391
> 
> 赞同：0
> 
> 时间：2012-11-17T00:28:22.783
> 
> 标签：java, netbeans

我有两个想解决的问题，但在我试图解决这些问题时，我设法下降到一只愤怒的灵长类动物对着我的电脑尖叫和大喊。

这是我的问题（其中一些无法通过在线社区解决），今天早些时候，我认为创建一个名为“res”的文件夹是个好主意，res 将用于存储游戏的图像和 wav 文件正在制作。现在，如果我正在测试的 wav 文件不在此文件夹中，并且 wav 文件的目录正确，则它可以正常工作，它看起来像这样“.getResource(fileName);”。但是当我在“res”文件夹中有 wav 文件时，我将目录更改为以下 .getResource("res/"+fileName); 我收到以下警告：[options] bootstrap class path not set with -source 1.6 1 警告以及指向所有与声音相关的内容的 nullPointerException。

所以在非常沮丧之后，我删除了“res”文件夹，然后项目停止编译，因为它找不到“res”，所以我重新创建了 res 文件夹，将 wav 文件保留在其中，效果很好。然后我对此感到高兴并想，我已经完成了一段时间，让我们将其提交给 SVN。在尝试提交我的工作时，“res”文件夹出现“已在版本控制”错误

所以回顾一下

> 我在我的项目文件夹中创建了一个名为“res”的文件夹（通过 netbeans）
> 
> 我把一个wav文件放到“res”中，发现它抛出了错误
> 
> 我从“res”中删除了wav文件，它工作得很好
> 
> 我删除了 res 文件夹和项目拒绝编译没有这个非常重要的文件夹
> 
> 我重新创建了 res 文件夹，然后尝试将我的工作提交给 SVN，而 SVN 不再想要我的孩子了。
> 
> 我现在只剩下孩子了，我无法在家里放置一个安全的地方和一个不需要的鬼魂（我的项目文件夹中的文件夹，不会做任何事情）

援助，一如既往地被广泛接受和欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:46:49.317

关于SVN问题：

NB 倾向于自动添加或删除 SVN 上的目录（但不提交），并且在删除/重新创建后可能会混淆。

我建议使用不同的工具（例如 SVN 命令行或 TortoiseSVN）来验证 SVN 哪些操作处于待处理状态，并尝试恢复`res`目录上的操作。如果 SVN 将其标记`res`为存在，那么您可能会尝试验证该目录尚未在存储库中。

您也可以从 Netbeans 目录中删除 SVN 缓存（以前称为`%HOME%\.netbeans\cache\svn`，现在 (NB 7.2) 更改为`%HOME%\Netbeans\Cache\7.2\svncache`.

一个极端的解决方案是进行新的结帐并将您的更改从旧工作副本复制到新副本。

# objective-c - 创建以专辑为中心的应用程序——RSS 是唯一的出路吗？

> ID：13426392
> 
> 赞同：2
> 
> 时间：2012-11-17T00:28:38.350
> 
> 标签：objective-c, xcode, rss

尝试创建一个以每天更新的相册为中心的 iOS (iphone) 应用程序。对此很陌生。慢慢学习编码。首先，我想要一些建议——有人知道解决这个问题的最佳方法是什么吗？我应该采用 RSS 路线并从某个专辑网站实现 RSS 提要吗？有没有一种方法可以减少对另一个网站的帐户的依赖？即使是博客 rss 也会更好，因为至少我可以完全控制博客。

我发现为照片博客网站实现 RSS 提要最终仍然会创建一个更像文章风格的外观——每个帖子都列出了帖子时间、日期、标题等，而不是缩略图点击展开相册风格。

我将实施 getsocialize 以便每张照片都可以被点赞、发布推文等。

一些正确方向的指导将不胜感激！

# ajax - JSF PrimeFaces / Ajax 渲染到 Datable 无法将项目添加到列表中

> ID：13426395
> 
> 赞同：3
> 
> 时间：2012-11-17T00:29:12.520
> 
> 标签：ajax, jsf-2, primefaces, managed-bean, session-scope

我正在尝试使用“panelGrid”中的表单来呈现`dataTable`using中的值`<f:ajax>`。但是，使用 提交时，`<h:commandButton>`发送的值不会显示在`dataTable`. 我没有在浏览器中收到堆栈或任何控制台错误。

这是我的 xhtml（简体）：

产品目录：

```
 <p:tabView id="tabView" style="width: 65%" >
            <p:tab id="books" title="Books">
                <p:dataGrid var="book" value="#{saleBean.productList}" columns="3"
                            rows="9" paginator="true" paginatorTemplate="{CurrentPageReport} 
                            {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} 
                            {LastPageLink} {RowsPerPageDropdown}"
                            rowsPerPageTemplate="3,6,9">
                    <h:form id="product" >
                    <p:panel header="#{book.name}" style="text-align: center">

                            <h:panelGrid columns="1" style="width: 65%">

                                <!-- Add Book Images here -->
                                <h:outputText value="#{book.price}"/>

                                <h:outputLabel value="Dct (in dollars): " />
                                <h:inputText id="discount" value="#{saleBean.item.unit_discount}" style="width: 50%" />

                                <p:commandButton value="Add to Cart" update=":dataTableForm:sc" 
                                                 action="#{saleBean.doAddItem}"/>

                            </h:panelGrid>

                    </p:panel>
                    </h:form>          
                </p:dataGrid>
            </p:tab>

            <p:tab id="arts" title="Art / Various">
                <!-- Art Products to be added here -->
            </p:tab>

            <p:tab id="other" title="Other">
                <!-- Various Products to be Added here -->
            </p:tab>

    </p:tabView>

    <hr/>        
    <h1>Shopping Cart</h1>
    <hr/>

    <h:form id="dataTableForm">
    <p:dataTable id="sc" value="#{saleBean.sd}" var="item" style="width: 60%">

        <p:column>
            <f:facet name="header">
                <h:outputText value="Product"/>
            </f:facet>
            <h:outputText value="#{item.product_fk}"/>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Quantity"/>
            </f:facet>
            <h:outputText value="#{item.quantity}"/>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Unit Price"/>
            </f:facet>
            <h:outputText value="#{item.unit_Cost}"/>
        </p:column>
        <p:column>
            <f:facet name="header">
                <h:outputText value="Unit Discount"/>
            </f:facet>
            <h:outputText value="#{item.unit_discount}"/>
        </p:column>

    </p:dataTable>
    </h:form>

</h:body> 
```

这是 bean（简体）：

```
 public String doAddItem()
    {
        item.setUnit_Cost(product.getPrice());        
        item.setProduct_fk(product);
        item.setQuantity(1);
        sd.add(item); 

        return "productCatalog";
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T23:11:26.693

根据 PrimeFaces 文档：

[http://www.primefaces.org/docs/vdl/3.4/primefaces-p/commandButton.html](http://www.primefaces.org/docs/vdl/3.4/primefaces-p/commandButton.html)

您`actionListener="#{saleBean.doAddItem}"`必须使用与该功能相对应的功能：

```
public void doAddItem(ActionListener event)
{
    // do your stuff
} 
```

在这里使用动作是一个例子：

```
action="#{saleBean.doAddItem}"

public String doAddItem(void)
{

    item.setUnit_Cost(product.getPrice());        
    item.setProduct_fk(product);
    item.setQuantity(1);
    sd.add(item); 

    return "productCatalog";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T10:11:39.327

尽量只使用 pf 组件，例如 p:datatable。将按钮替换为 ap:commandButton 并使用 process and update 而不是 f:ajax。

另外，也许最好将 p:datatable 也包含在表单中。

# ios - 如何按部分对 iOS 中的通讯簿条目进行排序

> ID：13426396
> 
> 赞同：2
> 
> 时间：2012-11-17T00:29:31.623
> 
> 标签：ios, uitableview, ios6, abrecord, uilocalizedcollation

我试图实现 UILocalizedIndexCollection，如 [http://developer.apple.com/library/ios/#documentation/iPhone/Reference/UILocalizedIndexedCollat ​​ion_Class/UILocalizedIndexedCollat​​ion.html](http://developer.apple.com/library/ios/#documentation/iPhone/Reference/UILocalizedIndexedCollation_Class/UILocalizedIndexedCollation.html)

在获得用户的许可后，我得到了我的地址簿，这给了我一个 ABRecordRef 的数组，我有以下代码来尝试构建我需要的部分数组的数组。但是我不知道该为 collat​​ionStringSelectior 放什么。任何帮助都会很棒。

```
- (void)setListContent:(NSArray *)inListContent
{
    if (listContent == inListContent) {
        return;
    }
    [listContent release]; listContent = [inListContent retain];                                   

    NSMutableArray *sections = [NSMutableArray array];
    UILocalizedIndexedCollation *collation = [UILocalizedIndexedCollation currentCollation];
    for (int i=0;i < [listContent count];i++) {
        ABRecordRef person=[listContent objectAtIndex:i];
        NSLog(@"person name is ");
        NSString* name =  (NSString *)(ABRecordCopyCompositeName(person));
        NSLog(name);
        NSInteger section = [collation sectionForObject:person collationStringSelector:@selector(????)];
        [sections addObject:person toSubarrayAtIndex:section];
    }

    NSInteger section = 0;
    for (section = 0; section < [sections count]; section++) {
        NSArray *sortedSubarray = [collation sortedArrayFromArray:[sections objectAtIndex:section]
                                          collationStringSelector:@selector(name)];
        [sections replaceObjectAtIndex:section withObject:sortedSubarray];
    }
    [sectionedListContent release];
    sectionedListContent = [sections retain];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T12:49:56.063

您应该使用以下代码：

```
NSInteger section = [collation sectionForObject:name collationStringSelector:@selector(self)]; 
```

# html - Windows 7 上 IE 9 中的 HTML 5 Canvas 性能

> ID：13426398
> 
> 赞同：2
> 
> 时间：2012-11-17T00:29:40.000
> 
> 标签：html, internet-explorer, windows-7, internet-explorer-9, html5-canvas

这是一个 HTML 5 Canvas 应用程序。这是一个非常标准的“设计器”应用程序，用户可以在其中将对象添加到布局、移动它们并编辑它们的属性。

它工作得很好，但事实证明在 Windows 7 上的 IE 9 中存在真正的性能问题。我将不胜感激！

*   操作通常需要 10 秒，而不是通常的 2 秒。

*   此外，在使用应用程序一段时间后，浏览器会给出主机“没有响应”的错误消息，并提供选项恢复网页和 X。一旦开始发生这种情况，包括文件菜单在内的每个用户操作都会发生这种情况，并且我只能通过编辑 URL 位置文本来摆脱它。特别是，它通常发生在任何尝试在开发者工具中使用浏览器的分析器时。这显然令人沮丧，但也可能是一个线索。我想知道是否可能有挂起的同步 AJAX 调用，正如此错误消息所建议的那样，但使​​用开发工具捕获网络流量表明所有调用都已完成。

*   该问题似乎特定于浏览器和操作系统的这种组合。Windows Server 2008 上的 IE 9 运行良好，Windows 7 上的 Firefox 和 Chrome 也正常运行。32 位或 64 位 IE 的问题相同。

*   大多数这些操作也有一个服务器端组件。例如，添加一个文本对象会调用 AJAX 来为该对象提供图像。服务器 API 实现为使用 ImageMagick 进行图像处理的小型 TurboGears 应用程序。但粗略的分析表明服务器端没有发生任何异常情况。这表明问题确实出在 JavaScript 中。

*   当应用程序运行时，任务管理器显示浏览器使用 90% 或更多的 CPU。对于任何浏览器都是如此，而不仅仅是 IE 9。这可能是因为应用程序中的渲染循环很紧凑，所以我们的一个想法是减少重新绘制画布的频率。不幸的是，这似乎没有帮助。requestAnimationFrame 似乎是个好主意，但在 IE 9 中不受支持。

*   一位同事建议使用 Google Chrome Frame 插件可能会有所帮助。这可能是一个可以接受的解决方案，但我还没有尝试过。

*   我找到了一些建议来打开控制面板选项“使用软件渲染而不是 GPU 渲染”，但这似乎没有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-11T14:37:13.320

我注意到的一件事：如果你在它不在文档中时开始在它上面绘图，那么 IE 中的画布似乎要慢得多。

所以我`document.body.appendChild(canvasEl)`在画画之前会这样做。你甚至可以制作画布元素`dislay: none;`，但至少它应该在正文中。

更新：似乎对于 Chrome 和 Firefox，将画布附加到正文的速度较慢。因此，如果您不需要将其添加到正文中，请不要为 Chrome 和 Firefox 添加它。

# json - JSON 字符串和 DatacontractJsonDeserializer

> ID：13426407
> 
> 赞同：1
> 
> 时间：2012-11-17T00:31:02.637
> 
> 标签：json, datacontractserializer, datacontractjsonserializer

我正在尝试解析从服务返回的 Json 字符串。为简单起见，它将类似于：

```
Dim jsonstring = _
<s>
{"menu": {
"id": "file",
"value": "File",
"popup": {
"menuitem": [
  {"value": "New", "onclick": "CreateNewDoc()"},
  {"value": "Open", "onclick": "OpenDoc()"},
  {"value": "Close", "onclick": "CloseDoc()"}
]
}
}}
</s>.Value 
```

现在我正在使用以下函数将 json 字符串读取到一个对象，但是所有属性总是什么都没有。我为上述字符串中的每个 json 对象创建了一个对象，并且该对象具有 Datacontract 和 Datamember 属性。请问有什么提示吗？

```
Dim menu = JsonObject(Of Menu)(jsonstring)
    Console.WriteLine(menu.value)

Private Function JsonObject(Of t)(jsonString As String) As t
    Dim ser As New DataContractJsonSerializer(GetType(t))
    Dim ms As New MemoryStream(Encoding.UTF8.GetBytes(jsonString))
    ms.Position = 0
    Dim obj As t = DirectCast(ser.ReadObject(ms), t)
    Return obj
End Function 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T21:14:19.173

通过查看此调用：

```
Console.WriteLine(menu.value) 
```

我怀疑 Menu 类的定义不正确...您的 Menu 类是否有一个名为“menu”的属性，并且此“menu”属性的类型是否是具有名为“id”、“value”的属性的复杂类型， '弹出窗口'？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T01:34:18.187

谢谢回复。

我使用 Json2cshap.com 将此 Json 字符串转换为类。类 (c#) 版本如下所示。唯一的区别是我的是 VB.net，所有的类/属性都有和属性。

```
public class Menuitem
{
    public string value { get; set; }
    public string onclick { get; set; }
}

public class Popup
{
    public List<Menuitem> menuitem { get; set; }
}

public class Menu
{
    public string id { get; set; }
    public string value { get; set; }
    public Popup popup { get; set; }
}

public class RootObject
{
    public Menu menu { get; set; }
} 
```

根对象（RootObject）是否应该被称为Menu？我现在无法对其进行测试，但请尝试一下您的建议。

# php - 如何要求唯一的登录链接？

> ID：13426411
> 
> 赞同：0
> 
> 时间：2012-11-17T00:32:12.100
> 
> 标签：php

这是我想要实现的目标：

我希望能够显示网站的主页。但是，此主页所做的只是允许您输入电子邮件地址。然后它会向您发送一封电子邮件，其中包含一个独特的链接，可以通过主页访问实际内容。它不需要任何实际帐户或登录名，只需拥有唯一的电子邮件链接。（它也只会发送到 .edu 地址）。

实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:40:04.410

1.  创建一个 SQL 表，将用户名映射到键码。
2.  提交首页表单时，随机生成一个16个字母的AZ，az，0-9个字符的字符串。
3.  将 SQL 行插入到将用户名映射到 16 个字母字符串的表中（使用 PDO）。
4.  通过电子邮件向用户发送链接，例如 example.org/login/email@email.com/rAnDomStRiNgHeRe
5.  使用 ModRewrite 设置 .htaccess 以将 example.org/login/([^/])+/([A-Za-z0-9])+ 映射到 example.org/verify-login.php?email=$1&code=$2
6.  创建 verify-login.php，它使用 PDO 在数据库中查询表中的任何条目，并将给定的电子邮件映射到给定的代码。
7.  如果匹配，则将用户带到实际内容。
8.  如果您需要保护内容，请使用电子邮件和密钥存储 cookie，然后执行数据库查找以确保 cookie 电子邮件和 cookie 密钥在数据库中相互映射。必须在要保护的每个单页上进行此检查。

附带说明一下，最好对 email:key 进行 base64_encode 编码并在 URL 中使用它。相应地更新 .htaccess。然后，在 verify-login.php 中，解码 base64 字符串，将其拆分为电子邮件和密钥，然后执行检查。

# c# - 读取一块内存，将其存储到本地结构中

> ID：13426412
> 
> 赞同：4
> 
> 时间：2012-11-17T00:32:25.023
> 
> 标签：c#, interop

所以我正在读取另一个程序的内存以进行逆向工程。我正在使用 kernel32.dll 中的函数。

该函数如下所示：

```
ReadProcessMemory(Handle, new IntPtr(Address), buffer, BytesToRead, out ptrBytesRead); 
```

我正在使用它来一点一点地读取内存，如下所示：

```
 public static int ReadInt32(IntPtr Handle, long Address)
    {
        return BitConverter.ToInt32(ReadBytes(Handle, Address, 4), 0);
    } 
```

然后使用程序句柄和我要读取的地址调用 ReadInt32，添加程序的基地址，因为它不是静态的。

我想做的是读取一整块内存（最多1300条记录，每条记录的内存步长为0xB0）。

我不确定最好的方法是什么。我已经研究过了，看起来有可能做一些事情，我把整个事情都拿走，基本上把它转储到我自己的结构中。我遇到的问题是我不太清楚我需要做什么。我可以在脑海中看到它，但无法在纸上写下它。

我将展开以显示它实际上是一个二维数组，在结构上看起来像这样：

```
 int OFFSET_CREATURE_ID = 0;
    int OFFSET_CREATURE_TYPE = 3;
    int OFFSET_CREATURE_NAME = 4;
    int OFFSET_CREATURE_Z = 36;
    int OFFSET_CREATURE_Y = 40;
    int OFFSET_CREATURE_X = 44;
    int OFFSET_CREATURE_IS_WALKING = 80;
    int OFFSET_CREATURE_DIRECTION = 84;
    int OFFSET_CREATURE_OUTFIT = 100;
    int OFFSET_CREATURE_OUTFIT_HEAD = 104;
    int OFFSET_CREATURE_OUTFIT_BODY = 108;
    int OFFSET_CREATURE_OUTFIT_LEGS = 112;
    int OFFSET_CREATURE_OUTFIT_FEET = 116;
    int OFFSET_CREATURE_OUTFIT_ADDON = 120;
    int OFFSET_CREATURE_LIGHT = 124;
    int OFFSET_CREATURE_LIGHT_COLOR = 128;
    int OFFSET_CREATURE_HP_BAR = 140;
    int OFFSET_CREATURE_WALK_SPEED = 144;
    int OFFSET_CREATURE_IS_VISIBLE = 148;
    int OFFSET_CREATURE_SKULL = 152;
    int OFFSET_CREATURE_PARTY = 156;
    int OFFSET_CREATURE_WARICON = 164;
    int OFFSET_CREATURE_ISBLOCKING = 168; 
```

这些偏移中的每一个都需要分配给我的结构中的不同元素。其中一些是bool，一些是int，还有一些是string。我有结构。我不能保证长度会消耗每个偏移量的整个“步骤”，尽管当我读取这些值时，我认为我需要每次声明一个新的结构实例（我将每 500 毫秒左右读取一次，也许更多！250 条记录的总读取时间约为 50 毫秒，这是我期望读取的时间！我确实需要能够做到 1300 条）。

请不要混淆代码，只需解释我应该做什么就足够了。当我使用这么多代码时，我很挣扎，所以除非有人将一个可以阅读所有这些内容的类放在一起，并有一个结构来存储它（这样我就可以将它转换为我的工作），我会欣赏字面上最少的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:55:34.030

对于原始类型，如果您知道偏移量，您可以简单地从偏移量`n`（数据的开头）获取位`n+1`并使用 a`BitConverter`转换为类型。因为您无法使用诸如`ToInt32(byte[] value, int startIndex)`必须将字节复制到新数组中的方法来指定结束。

让我们假设每件事都`int`适用于这个例子。我还将假设所有的偏移量都在一个数组中。Bytes 是您从中获得的内存块`ReadInt32`

```
int[] values = new int[Bytes.Length/4];
byte[] current = new byte[4];
BitConverter bc = new BitConvert();
for (i = 0; i < Bytes.Length/4 -1; i++)
{
     Buffer(Bytes, i(4), current, 0, 4); 
     values[i] = bc.ToInt32(current, 0);   
} 
```

这是一个巨大的简化，但它应该足以让你朝着正确的方向前进。您甚至可能不想使用循环（也许您只是对所有`BitConverter`指令进行硬编码，这就是从 C/C++ 中的数据库读取时进行序列化的方式）如果您有许多类型，这也会使事情变得更简单。无论哪种方式，基本概念都是使用位转换器将您从其他程序读取的字节部分转换为数据结构中它们各自的属性。

# haskell - 如何将两个参数的 Haskell 函数重写为无点样式

> ID：13426417
> 
> 赞同：25
> 
> 时间：2012-11-17T00:33:09.690
> 
> 标签：haskell, pointfree

我在 Haskell 中有以下功能

```
agreeLen :: (Eq a) => [a] -> [a] -> Int
agreeLen x y = length $ takeWhile (\(a,b) -> a == b)  (zip x y) 
```

我正在尝试学习如何编写“惯用的”Haskell，它似乎更喜欢使用`.`and`$`而不是括号，并且在可能的情况下也更喜欢无点代码。我似乎无法摆脱提及`x`和`y`明确。有任何想法吗？

我认为我会遇到同样的问题，即对两个参数的任何函数进行点释放。

BTW，这只是为了写好代码；不是一些“尽一切可能使它变得毫无意义”的家庭作业。

谢谢。

* * *

（添加评论）感谢您的回答。你已经说服我这个功能不会从 pointfree 中受益。你还给了我一些练习转换表达式的好例子。这对我来说仍然很困难，而且它们对 Haskell 来说似乎就像指针对 C 一样重要。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-11-17T00:51:10.947

> 并且在可能的情况下更喜欢无点代码。

不是“在可能的情况下”，而是“在提高可读性（或具有其他明显优势）的地方”。

免积分

```
agreeLen x y = length $ takeWhile (\(a,b) -> a == b)  (zip x y) 
```

第一步是`($)`向右移动，并将您拥有的替换为`(.)`：

```
agreeLen x y = length . takeWhile (\(a,b) -> a == b) $ zip x y 
```

现在，您可以将其进一步向右移动：

```
agreeLen x y = length . takeWhile (uncurry (==)) . zip x $ y 
```

在那里你可以立即砍掉一个论点，

```
agreeLen x = length . takeWhile (uncurry (==)) . zip x 
```

然后您可以将其重写为组合运算符的前缀应用程序，

```
agreeLen x = (.) (length . takeWhile (uncurry (==))) (zip x) 
```

你可以写

f (gx)

作为

```
f . g $ x 
```

一般来说，这里有

```
f = (.) (length . takeWhile (uncurry (==))) 
```

和`g = zip`，给

```
agreeLen x = ((.) (length . takeWhile (uncurry (==)))) . zip $ x 
```

`x`很容易从中删除论点。然后你可以将前缀应用`(.)`转换为一个部分并得到

```
agreeLen = ((length . takeWhile (uncurry (==))) .) . zip 
```

但是，这比原来的可读性差，所以我不建议这样做，除非练习将表达式转换为无点样式。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-17T00:43:25.560

您还可以使用：

```
agreeLen :: (Eq a) => [a] -> [a] -> Int
agreeLen x y = length $ takeWhile id $ zipWith (==) x y 
```

惯用的 Haskell 是更容易阅读的东西，不一定是最无意义的东西。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-06-29T08:25:36.527

正如丹尼尔的出色回答所指出的那样，您的问题是撰写`f`和`g`何时`f`作为一个论点和`g`两个论点。这可以`f ??? g`用正确的运算符编写（并且类型签名为`(c -> d) -> (a -> b -> c) -> a -> b -> d`。这对应于有时定义为的`(.).(.)`运算符（参见[那里](https://stackoverflow.com/questions/17585649/composing-function-composition-how-does-work)`.:`） 。在这种情况下，您的表达式变为

```
length . takeWhile (uncurry (==)) .: zip 
```

如果你习惯了`.:`操作符，那么这个免费版本是完全可读的。我也可以改为使用 `(<$$$>) = fmap fmap fmap`并获取

```
length . takeWhile (uncurry (==)) <$$$> zip 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-29T06:39:05.383

另一个简洁、无点的解决方案：

```
agreeLen = ((length . takeWhile id) .) . zipWith (==) 
```

等效地：

```
agreeLen = (.) (length . takeWhile id) . zipWith (==) 
```

# ruby-on-rails - 如何实际使用 rails-settings？

> ID：13426419
> 
> 赞同：1
> 
> 时间：2012-11-17T00:33:23.460
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试使用[rails-settings](https://github.com/ledermann/rails-settings) gem，但我不知道该怎么做。

我已将`ledermann-rails-gem`gem 添加到 Gemfile，已运行，`bundle install`根据 wiki 中写入的内容生成迁移，已运行`rake db:migrate`，重新启动服务器，现在，当我尝试从 rails-settings wiki 执行任何操作时，出现错误。

假设我想创建新变量，所以我将此代码放入我的控制器：

```
Settings.foo = "bar" 
```

它给了我以下错误：

```
uninitialized constant ApplicationController::Settings 
```

我在 Rails 开发中非常“新鲜”，可能有一些小东西在 wiki 中没有提到，因为它很明显（但对我来说不是！）。任何帮助，将不胜感激

# shell - csh 启动脚本

> ID：13426423
> 
> 赞同：3
> 
> 时间：2012-11-17T00:34:00.117
> 
> 标签：shell, csh

我知道 csh 有很多启动文件（.login、.cshrc 等）。问题是我正在启动一个新的 csh 终端，我看到很多非标准（不是标准的，如 $HOME、$SHELL 等）环境变量在启动时设置，而我没有在我的任何启动脚本中设置。有没有办法找出在我当前会话中启动时获取的文件序列。如果没有，是否有一个工具可以告诉哪个脚本在给定变量名称的情况下设置了某个环境变量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T09:52:06.983

您需要检查系统范围的启动文件。从...开始：

/etc/profile

它调用： /etc/{您正在使用的系统范围的 shell 设置} 例如 /etc/csh

然后你自己的个人资料被称为

~/.profile

进而调用您的个人 shell 设置，例如 ~/.csh

# vb6 - 如何在光标处将文本插入文本框？

> ID：13426427
> 
> 赞同：1
> 
> 时间：2012-11-17T00:34:21.450
> 
> 标签：vb6, textbox, cursor

如何`TextBox`在当前光标位置将文本插入到 a 中？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T01:28:26.923

`TextBox`通过设置`SelText`为字符串，可以在 a 的当前光标位置插入文本：

```
TextBox1.SelText = "text to be inserted" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-06T14:00:24.580

如果您只想在当前光标位置粘贴文本，请执行以下操作。

text1.seltext = "这是我要粘贴的一些文本" text1_click

上面的代码会将您的文本粘贴到当前光标位置，然后将光标放在粘贴文本的末尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T00:46:47.713

假设您的文本框名为`txtTitle`：：

```
With txtTitle
   .SelStart = .SelLength 'SelStart will place cursor at the last selected character
End With 
```

例子：

```
txtTitle.SelStart = 7 'This will place cursor after 7th character 
```

**编辑：** 只是为了澄清：如果没有选择任何字符，SelLength 将返回 0，并且您可以使用 SelStart 获取当前位置。这是你应该测试的：

```
Dim iPos As Long
With txtTitle
  If .SelLength = 0 Then
    iPos = .SelStart
  Else
    iPos = .SelStart + .SelLength
  End If
  Debug.Print "The current cursor position in " & .Name & " is: " & iPos & " :-)"
End With 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-06T14:05:23.433

出于某种原因，这个网站不让我完成我的代码输入。使用我的示例将插入文本，但粘贴后它将被选中。要取消选择文本并将光标留在粘贴文本的末尾，您必须像这样调用 textbox1 单击事件。text1[下划线]点击。

# objective-c - 用户在 OS X 上空闲后的通知？

> ID：13426428
> 
> 赞同：4
> 
> 时间：2012-11-17T00:34:29.357
> 
> 标签：objective-c, macos, osx-lion, osx-mountain-lion, python-idle

检测用户何时空闲 X 时间，然后检测用户何时立即活跃的最佳方法是什么？

我知道有 NSWorkspace 提供将/已睡眠/唤醒通知，但我不能依赖它，因为睡眠设置通常约为 15 分钟到永远不会。我需要能够检测用户是否空闲了约 1-2 分钟。

这个[答案](https://stackoverflow.com/questions/4643579/objective-c-get-notifications-about-a-users-idle-state)提供了一种获取空闲时间的方法。如果可能的话，我想避免轮询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T08:50:56.877

据我所知，投票是你唯一的选择。正如 user1118321 指出的那样，每 O（分钟）轮询一次不太可能导致任何问题、性能或其他问题。

如果您的应用程序有一个 GUI 并接收 UI 事件，您可以安装一个处理程序，通过`+[NSEvent addLocalMonitorForEventsMatchingMask:handler:]`它在每个事件上重置您的计时器。当用户持续活跃时，至少在您自己的应用程序中，这将有助于减少（如果不是消除）民意调查。

一旦您确定用户已经闲置了足够长的时间，您就可以安装一个全局事件水龙头来监视下一个事件。参见例如`-[NSEvent addGlobalMonitorForEventsMatchingMask:handler:]`。

注意：你应该[`CGEventSourceSecondsSinceLastEventType`](https://stackoverflow.com/a/12830508/790079)尽可能使用而不是进入 IO 注册表。这是一个正式的、受支持的 API，可能更有效。更不用说它更简单。还有[UKIdleTimer](http://www.zathras.de/angelweb/sourcecode.htm)虽然它依赖于 Carbon，所以可能不适用。

# c# - 如何使用 Azure TableClient 2.0 BeginExecuteQuerySegmented

> ID：13426430
> 
> 赞同：2
> 
> 时间：2012-11-17T00:35:20.767
> 
> 标签：c#, .net, asynchronous, azure, azure-table-storage

我正在尝试异步获取表中的所有条目，但无法弄清楚如何使用[continuation token](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.storage.table.tablecontinuationtoken.aspx)。我怀疑我需要采用我的匿名方法并将其转换为委托，然后使用延续令牌递归调用它。

如何获取以下代码并执行异步调用并获取新 API 中的所有条目？

```
 Task<string[]> GetAllTableEntries(CloudTable tbl, string[] urls, string name, CancellationToken token)
    {
        TableRequestOptions reqOptions = new TableRequestOptions() { };
        OperationContext ctx = new OperationContext() { ClientRequestID = "" };
        object state = null;

        // Register Cancelation Token
        ICancellableAsyncResult result = null;

        TableQuery qry = new TableQuery();
        TableContinuationToken tok = null;

        result = tbl.BeginExecuteQuerySegmented(qry, tok, reqOptions, ctx, (o) =>
        {

            var response = (o.AsyncState as CloudTable).EndExecuteQuerySegmented(o);

            Console.WriteLine("Found " + response.Results.Count + " records");

            // The following code was used in the previous version of the SDK
            //
            //26:                      // add first segment of data
            //27:                      pageData.CompletedList.AddRange(
            //28:                          from wu in response.Results
            //29:                          select new CompletedWorkUnit(wu));
            //30:   
            //31:                      // continue fetching segments to complete page
            //32:                      while (response.HasMoreResults)
            //33:                      {
            //34:                          response = response.GetNext();
            //35:                          pageData.CompletedList.AddRange(
            //36:                              from wu in response.Results
            //37:                              select new CompletedWorkUnit(wu));
            //38:                      }
            //39:   
            //40:                      // set continuation token for next page request
            //41:                      pageData.ContinuationToken = response.ContinuationToken;
            //42:                      evt.Set();

        }, state);

        // Add cancellation token according to guidance from Table Client 2.0 Breaking Changes blog entry
        token.Register((o) => result.Cancel(), state); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T05:47:23.743

请试试这个：

```
 static void ExecuteQuery()
    {
        TableContinuationToken token = null;
        TableRequestOptions reqOptions = new TableRequestOptions() { };
        OperationContext ctx = new OperationContext() { ClientRequestID = "" };
        long totalEntitiesRetrieved = 0;
        while (true)
        {
            CloudTable table = cloudTableClient.GetTableReference("MyTable");
            TableQuery<TempEntity> query = (new TableQuery<TempEntity>()).Take(100);
            System.Threading.ManualResetEvent evt = new System.Threading.ManualResetEvent(false);
            var result = table.BeginExecuteQuerySegmented<TempEntity>(query, token, reqOptions, ctx, (o) =>
            {
                var response = (o.AsyncState as CloudTable).EndExecuteQuerySegmented<TempEntity>(o);
                token = response.ContinuationToken;
                int recordsRetrieved = response.Count();
                totalEntitiesRetrieved += recordsRetrieved;
                Console.WriteLine("Records retrieved in this attempt = " + recordsRetrieved + " | Total records retrieved = " + totalEntitiesRetrieved);
                evt.Set();
            }, table);
            evt.WaitOne();
            if (token == null)
            {
                break;
            }
        }
    } 
```

我注意到的一件事是，如果我执行返回动态表实体的查询，则会收到与 DateTimeOffset 相关的错误。这就是为什么我最终创建了一个临时实体。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T07:31:53.743

这是另一种选择，但这次是在 TPL / 任务并行库中。 [完整的源代码可在此处获得](https://github.com/makerofthings7/AzureStorageExtensions/blob/master/AzureStorageExtensions/CloudTableExtensions.cs)

```
 /*

     The following overloads of ExecuteQuerySegmentedAsync is executed like this)
     */
        CloudTableClient client = acct.CreateCloudTableClient();
        CloudTable tableSymmetricKeys = client.GetTableReference("SymmetricKeys5");

        TableContinuationToken token = new TableContinuationToken() { };
        TableRequestOptions opt = new TableRequestOptions() { };
        OperationContext ctx = new OperationContext() { ClientRequestID = "ID" };
        CancellationToken cancelToken = new CancellationToken();

        List<Task> taskList = new List<Task>();

           while (true)
            {
                Task<TableQuerySegment<DynamicTableEntity>> task3 = tableSymmetricKeys.ExecuteQuerySegmentedAsync(query, token, opt, ctx, cancelToken);

                // Run the method
                task3.Wait();

                token = task3.Result.ContinuationToken;

                Console.WriteLine("Records retrieved in this attempt = " + task3.Result.Count ()); 

                if (token == null)
                {
                    break;
                }
                else
                {
                    // persist token
                    // token.WriteXml()
                }
            }         
     */

   // Overload #4
        public static Task<TableQuerySegment<DynamicTableEntity>> ExecuteQuerySegmentedAsync(this CloudTable tbl, TableQuery query, TableContinuationToken continuationToken, TableRequestOptions opt, OperationContext ctx     ,CancellationToken token )
        {
            ICancellableAsyncResult result = null;

            if (opt == null && ctx == null)
                result = tbl.BeginExecuteQuerySegmented(query, continuationToken, null, tbl);
            else
                result = tbl.BeginExecuteQuerySegmented(query, continuationToken, opt, ctx, null, tbl);

            // Add cancellation token according to guidance from Table Client 2.0 Breaking Changes blog entry
            var cancellationRegistration = token.Register(result.Cancel);

            return Task.Factory.FromAsync(result, iAsyncResult =>
            {
                CloudTable currentTable = iAsyncResult.AsyncState as CloudTable;

                //cancellationRegistration.Dispose();
                return currentTable.EndExecuteQuerySegmented(result);
            });
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T14:29:01.713

此人为 ExecuteQueryAsync 制作了一些扩展方法，这些方法包装了分段方法

[https://github.com/glueckkanja/tasync/blob/master/StorageExtensions.cs](https://github.com/glueckkanja/tasync/blob/master/StorageExtensions.cs)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T01:38:08.847

这是@Gaurav Mantri 代码的替代实现。

```
public class AzureTableQueryState
{
    public CloudTable CloudTable { get; set; }
    public TableContinuationToken Token { get; set; }
    public ManualResetEvent Evt { get; set; } //i'm guessing that's what this is
    //any other variables you were using

    public int TotalEntitiesRetrieved { get; set; }
}

  // snip....

            while (true)
            { 
                // Initialize variables
                TableQuery  query = (new TableQuery()).Take(100);
                AzureTableQueryState queryState = new AzureTableQueryState();
                queryState.Evt = new System.Threading.ManualResetEvent(false);
                queryState.TotalEntitiesRetrieved = 0;

                AsyncCallback asyncCallback = (iAsyncResult) =>
                {
                    AzureTableQueryState state = iAsyncResult.AsyncState as AzureTableQueryState;

                    var response = state.CloudTable.EndExecuteQuerySegmented(iAsyncResult);
                    token = response.ContinuationToken;
                    int recordsRetrieved = response.Results.Count;

                    state.TotalEntitiesRetrieved += recordsRetrieved;
                    Console.WriteLine("Records retrieved in this attempt = " + recordsRetrieved + " | Total records retrieved = " + state.TotalEntitiesRetrieved);
                    state.Evt.Set();
                };

                // Run the method
                var result = tableSymmetricKeys.BeginExecuteQuerySegmented(query, token, opt, ctx, asyncCallback, tableSymmetricKeys);

                // Add cancellation token according to guidance from Table Client 2.0 Breaking Changes blog entry
                cancelToken.Register((o) => result.Cancel(), null);

                queryState.Evt.WaitOne();

                if (token == null)
                {
                    break;
                }
                else
                {
                    // persist token
                    // token.WriteXml()
                }
            } 
```

# xml - XSLT 匹配具有特定父元素的元素

> ID：13426434
> 
> 赞同：1
> 
> 时间：2012-11-17T00:36:00.350
> 
> 标签：xml, xslt

我对 XSLT 很陌生，我正在尝试学习 Xpath。

假设我有`match="warning/para"`并且我要分析的 XML 文件是：

```
<para>A normal paragraph.</para>
 <warning>
    <para>Warning paragraph one.</para>
    <para>Warning paragraph two.</para>
  </warning>
<para>Another normal paragraph.</para> 
```

匹配的`<para>`元素只是元素内部的`<warning>`元素，还是`<para>`警告元素外部也匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:42:27.867

单个“/”表示直接后代，因此引擎期望“警告”元素内有一个“para”元素。因此只有嵌套的 para 元素被匹配。

# android - 创建 Android 项目会引发错误“必须通过 SDK 管理器更新工具”

> ID：13426435
> 
> 赞同：3
> 
> 时间：2012-11-17T00:36:00.427
> 
> 标签：android, android-sdk-tools

当我在 eclipse juno 版本中创建一个 android 项目时，它会抛出这样的错误`The tools need to be updated via the SDK Manager`。请帮我

![错误图像](../Images/29d0ea78a35ee616ee28709c7981ab4d.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-17T01:39:52.640

您可能还没有将 Eclipse 指向您的 android-sdk 文件夹。

在 Eclipse 中，转到 Preferences -> Android -> 然后在 SDK location 文本框中，浏览您的 android-sdk 文件夹。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T03:44:37.027

问题是您的平台/sdk 工具与您安装的 ADT eclipse 插件版本不兼容。很可能，插件已更新，而工具未更新。

这就是您需要使用 SDK 管理器更新工具的原因。

![在此处输入图像描述](../Images/2207bdcf7e485b492978d381cbd63095.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-04T18:26:14.870

以上都不适合我。我不得不“删除”SDK Build 工具包，然后重新安装这些包。之后，我现在可以创建一个新的 android 项目。

# python - OO设计：一个可以导出到“行”的对象，同时访问标题名称，无需重复自己

> ID：13426446
> 
> 赞同：2
> 
> 时间：2012-11-17T00:38:31.400
> 
> 标签：python, oop, dry

抱歉，标题措辞不当。我希望一个简单的例子能说明问题。这是做我想做的最简单的方法：

```
class Lemon(object):

    headers = ['ripeness', 'colour', 'juiciness', 'seeds?']

    def to_row(self):
        return [self.ripeness, self.colour, self.juiciness, self.seeds > 0]

def save_lemons(lemonset):
    f = open('lemons.csv', 'w')
    out = csv.writer(f)
    out.write(Lemon.headers)
    for lemon in lemonset:
        out.writerow(lemon.to_row()) 
```

这对于这个小例子来说没问题，但我觉得我在 Lemon 课上“重复自己”。在我尝试编写的实际代码中（我要导出的变量数量约为 50 而不是 4，并且 to_row 调用了许多进行大量奇怪计算的私有方法），它变得很尴尬。

当我编写代码来生成一行时，我需要不断地引用“headers”变量以确保我以正确的顺序构建我的列表。如果我想更改正在输出的变量，我需要确保 to_row 和 headers 正在并行更改（正是 DRY 旨在防止的那种事情，对吧？）。

有没有更好的方法可以设计此代码？我一直在玩函数装饰器，但没有任何问题。理想情况下，我应该仍然能够在没有特定柠檬实例的情况下获得标题（即它应该是类变量或类方法），并且我不希望每个变量都有单独的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:45:38.093

在这种情况下，`getattr()`是您的朋友：它允许您根据字符串名称获取变量。例如：

```
def to_row(self):
    return [getattr(self, head) for head in self.headers] 
```

编辑：要正确使用 header `seeds?`，您需要设置`seeds?`对象的属性。`setattr(self, 'seeds?', self.seeds > 0)`在 return 语句的正上方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T03:15:33.503

我们可以使用一些元类恶作剧来做到这一点......

在 python 2 中，属性在字典中传递给元类，不保留顺序，我们还需要一个基类，以便我们可以区分应该映射到行中的类属性。在 python3 中，我们可以省去几乎所有这些基本描述符类。

```
import itertools
import functools
@functools.total_ordering
class DryDescriptor(object):
    _order_gen = itertools.count()
    def __init__(self, alias=None):
        self.alias = alias
        self.order = next(self._order_gen)

    def __lt__(self, other):
        return self.order < other.order 
```

对于我们希望映射到行中的每个属性，我们都需要一个 Python 描述符。插槽是一种无需太多工作即可获取数据描述符的好方法。不过需要注意的是，我们必须手动删除帮助程序实例以使真正的插槽描述符可见。

```
class slot(DryDescriptor):
    def annotate(self, attr, attrs):
        del attrs[attr]
        self.attr = attr
        slots = attrs.setdefault('__slots__', []).append(attr)

    def annotate_class(self, cls):
        if self.alias is not None:
            setattr(cls, self.alias, getattr(self.attr)) 
```

对于计算域，我们可以记忆结果。在没有内存泄漏的情况下，从带注释的实例中记忆是很棘手的，我们需要弱引用。或者，我们可以安排另一个插槽来存储缓存值。这也不是线程安全的，但非常接近。

```
import weakref
class memo(DryDescriptor):
    _memo = None
    def __call__(self, method):
        self.getter = method
        return self

    def annotate(self, attr, attrs):
        if self.alias is not None:
            attrs[self.alias] = self

    def annotate_class(self, cls): pass

    def __get__(self, instance, owner):
        if instance is None:
            return self
        if self._memo is None:
            self._memo = weakref.WeakKeyDictionary()
        try:
            return self._memo[instance]
        except KeyError:
            return self._memo.setdefault(instance, self.getter(instance)) 
```

在元类上，找到我们上面创建的所有描述符，按创建顺序排序，并指示对新创建的类进行注释。这不能正确处理派生类，并且可以使用其他一些便利，例如`__init__`所有插槽。

```
class DryMeta(type):
    def __new__(mcls, name, bases, attrs):
        descriptors = sorted((value, key) 
                             for key, value 
                             in attrs.iteritems() 
                             if isinstance(value, DryDescriptor))

        for descriptor, attr in descriptors:
            descriptor.annotate(attr, attrs)

        cls = type.__new__(mcls, name, bases, attrs)
        for descriptor, attr in descriptors:
            descriptor.annotate_class(cls)

        cls._header_descriptors = [getattr(cls, attr) for descriptor, attr in descriptors]
        return cls 
```

最后，我们希望继承一个基类，以便我们可以拥有一个`to_row` 方法。这只是按顺序调用所有`__get__`相应描述符的所有 s。

```
class DryBase(object):
    __metaclass__ = DryMeta

    def to_row(self):
        cls = type(self)
        return [desc.__get__(self, cls) for desc in cls._header_descriptors] 
```

假设所有这些都隐藏起来，看不到，使用此功能的类的定义几乎没有重复。唯一的缺点是为了实用，每个字段都需要一个 python 友好的名称，因此我们有 `alias`关联的`'seeds?'`键`has_seeds`

```
class ADryRow(DryBase):
    __slots__ = ['seeds']

    ripeness = slot()
    colour = slot()
    juiciness = slot()

    @memo(alias='seeds?')
    def has_seeds(self):
        print "Expensive!!!"
        return self.seeds > 0 
```

```
>>> my_row = ADryRow()
>>> my_row.ripeness = "tart"
>>> my_row.colour = "#8C2"
>>> my_row.juiciness = 0.3479
>>> my_row.seeds = 19
>>>
>>> print my_row.to_row()
Expensive!!!
['tart', '#8C2', 0.3479, True]
>>> print my_row.to_row()
['tart', '#8C2', 0.3479, True] 
```

# haskell - Haskell 语法：输入时解析错误

> ID：13426449
> 
> 赞同：0
> 
> 时间：2012-11-17T00:38:47.327
> 
> 标签：haskell, syntax-error

作为我正在编写的 mini-haskell 编译器的一部分，我有一个名为`app`. 我想要这个函数做的是接受这些参数`epp (App e1 e2)`。第一步是`e1`递归地评估 ( `epp e1`) 并检查输出是否是错误的。如果不是，则评估`e2`然后调用另一个函数`eppVals`来评估调用的输出`e1`，`e2`我分别定义为`v1`和`v2`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T10:56:14.337

在您的 hpaste 中，您有一个`appVals`已`eppVals`在上面的问题中重命名为的函数。这是无益的。

让我们看一些类型：

*   `epp :: Exp -> Error Val`
*   `appVals :: Val -> Val -> Error Val`

错误消息*Couldn't match expected type `Val`with actual type`Error Val`*试图告诉您第一个参数应该`appVals`具有*类型*（`Val`请参阅类型签名`appVals`），但您作为第一个参数提供的值的*实际类型*`v1`是，定义为`epp e1`，它具有类型`Error Val`（参见 的类型签名`epp`）。

`Val`并且`Error Val`不是同一类型。那是你的问题。

如何解决？您需要某种方法将错误情况与其余计算分开处理。如果您已经为您的类型实现了`Applicative`or类，那么几乎可以肯定这就是他们所做的。`Monad``Error`

**编辑：**你不包括你的定义`Error`，但我希望它看起来像这样：

```
data Error a = S a | Error String 
```

为它实现几个类（你需要`import Control.Applicative`）：

```
instance Functor Error where
    fmap f (S x)     = S (f x)
    fmap _ (Error s) = Error s

instance Applicative Error where
    pure = S
    Error s <*> _       = Error s
    _       <*> Error s = Error s
    S f     <*> S x     = S (f x) 
```

现在你可以重写

```
epp (App e1 e2) = eppVals <$> epp e1 <*> epp e2 
```

# c - 在多个文件夹中编译 C 程序

> ID：13426453
> 
> 赞同：1
> 
> 时间：2012-11-17T00:39:07.967
> 
> 标签：c, shell, automation

我有一堆`C`程序目录。我需要将它们一一编译并在主程序中使用结果。

所以我的主程序遍历目录结构[我不确定结构是什么，它可能会随着时间而改变]并一次编译一个`C`程序，使用该结果进行一些计算。

所以如果我把主程序写进去`C`，用[nftw](http://pubs.opengroup.org/onlinepubs/9699919799/functions/nftw.html)来遍历。

或者

编写一个 Shell 主程序。

哪种方法更好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:23:10.910

我猜你使用的是兼容的 Unix/Linux/Cygwin 系统......
因此，我建议使用 shell 解决方案，因为它更适合目录处理。

## `Makefile`对于每个程序

正如@Dogbert 所说`make`，可用于构建多个程序。构建可以并行执行（使用选项`-j`）。此外`make`，还可以照顾依赖关系。

我不知道你是否使用了`Makefile`语法。因此，我给出一个需要三个`C`文件和一个头文件的程序的快速示例：

```
program: file1.o file2.o file3.o
    gcc -o -o $@ $^

%.o: %.c header.h
    gcc -c -o $@ $< 
```

以下命令将并行编译`file1.c`。然后链接阶段将等待这些树编译完成。`file2.c``file3.c`

```
make -j3 
```

## 目录发现

以下命令找到每个`Makefile`并运行`make`命令：

```
find . -name Makefile -exec make -j3 -f '{}' ';' 2>&1 | tee result.txt 
```

如果您的计算机中有 8 个内核，则可以使用`-j8`.

## 在主程序中重用

构建结果显示在 shell 屏幕上，也存储在`result.txt`文件中。

## 更多信息？

我不知道你的系统是什么，或者你的知识。希望这能有所帮助。如果您不确定了解某些部分，请询问更多信息。;-)

# c++ - python::boost::对象分配

> ID：13426454
> 
> 赞同：1
> 
> 时间：2012-11-17T00:39:10.763
> 
> 标签：c++, python, pointers, boost

我想知道动态分配 boost::python::object 类型的对象是否正确。

`boost::python::object * obj = new boost::python::object();`

会不会有什么问题？那么内部引用计数呢？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T20:10:16.293

boost::python::object的[文档](http://www.boost.org/doc/libs/1_35_0/libs/python/doc/v2/object.html)明确指出析构函数会减少引用计数，而赋值运算符会增加它。虽然没有明确说明，但从这些明确的陈述和这个关于构造函数的陈述中，`Constructs an object managing a reference`我们可以推断出构造函数也会增加引用计数。

由于new调用的是构造函数，只要在指针上调用delete保证析构函数被调用，内部引用计数就不会有任何问题。

另请注意，关于使用 std::shared_ptr 或 std::unique_ptr 进行引用计数的评论有些误导。std::unique_ptr 不引用计数，而是移动/移动分配导致所有权从实例 A 传递到实例 B，并且实例 A 变为无效。此外，std::shared_ptr 不会修改 boost::python::object 维护的内部引用计数，而是会管理关于 boost::python::object 指针生命周期的单独引用计数。

# java - 是否有任何内置控件（或者可能有人编写了一个）来从 Google 图片中选择图片并放入 Android 的 ImageView？

> ID：13426456
> 
> 赞同：0
> 
> 时间：2012-11-17T00:39:19.763
> 
> 标签：java, android, android-imageview, android-image, google-image-search

标题真的不言自明。我想知道是否有一些简单的方法（类似于打开照片库）在 Google 图像中选择图像，然后将其传递回 Android 的 ImageView？

有人做过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T03:40:19.393

这是android中相当常见的任务。你可以看看下面的教程来完成你所需要的。

[http://viralpatel.net/blogs/pick-image-from-galary-android-app/](http://viralpatel.net/blogs/pick-image-from-galary-android-app/)

祝你好运！

# android - Preference.setWidgetLayoutResource() 问题

> ID：13426460
> 
> 赞同：0
> 
> 时间：2012-11-17T00:40:39.523
> 
> 标签：android, android-preferences

从图像选择器返回后，我正在尝试设置可单击首选项的图标图像（以向用户显示他/她选择的内容）。

像这样的简单设置不起作用，我不知道为什么：

```
public boolean onActivityResult(int requestCode, int resultCode, Intent intent) {
    mIconPathPreference.setWidgetLayoutResource(R.layout.preference_icon);
} 
```

尤其是当将行**setWidgetLayoutResource**放在其他地方时确实会添加一个图标。

偏好布局：

```
<Preference
    android:key="@string/iconPath_key"
    android:title="@string/iconPath"
    android:summary="@string/iconPath_summ"
    android:dependency="@string/iconEnable" /> 
```

偏好图标布局：

```
<?xml version="1.0" encoding="utf-8"?>
<ImageView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="48dp"
    android:layout_height="48dp"
    android:src="@drawable/ic_launcher" /> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-04T09:24:26.957

根据您的喜好设置`android:widgetLayout`属性应该可以工作。

```
<Preference
    android:key="@string/iconPath_key"
    android:title="@string/iconPath"
    android:summary="@string/iconPath_summ"
    android:dependency="@string/iconEnable"
    android:widgetLayout"@layout/your_widge_layout" /> 
```

# rest - 使用 Live Connect REST 访问公共 Skydrive 内容，无需访问令牌

> ID：13426461
> 
> 赞同：1
> 
> 时间：2012-11-17T00:40:41.590
> 
> 标签：rest, onedrive, live-connect-sdk

根据这个 Microsoft api page

http://msdn.microsoft.com/en-us/library/live/hh826522#reading_albums

，我试图翻译这个浏览器访问skydrive URL

[https://skydrive.live.com/?cid=0A263A7CBEAAFB80&sc=photos#cid=0A263A7CBEAAFB80&id=A263A7CBEAAFB80%214521&sc=photos](https://skydrive.live.com/?cid=0A263A7CBEAAFB80&sc=photos#cid=0A263A7CBEAAFB80&id=A263A7CBEAAFB80%214521&sc=photos)

至

[http://apis.live.net/v5.0/folder.0A263A7CBEAAFB80.A263A7CBEAAFB80!4521](http://apis.live.net/v5.0/folder.0A263A7CBEAAFB80.A263A7CBEAAFB80!4521)

由于相册是公开共享的，我应该可以在没有访问令牌的情况下访问。

我错过了什么吗？还是只是使用了错误的 URL？

我注意到我可以通过使用此

https://apis.live.net/v5.0/0A263A7CBEAAFB80/获得公开资料

我已经阅读了 REST API

http://msdn.microsoft.com/en-us/library/live/hh243648.aspx

，但我发现很难推断出正确的 url 格式

这获取所有专辑
https://apis.live.net/v5.0/0A263A7CBEAAFB80/albums
REST URL 也失败。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T23:13:16.930

我也一直在寻找这方面的指南，但只是注意到您的 URL 中似乎有一个额外的“/”。网站上列出的一个是：

[https://apis.live.netv5.0/%fileid%](https://apis.live.netv5.0/%fileid%)

你能让这个工作吗？

# c# - 将数组转换为字符串

> ID：13426463
> 
> 赞同：113
> 
> 时间：2012-11-17T00:40:48.793
> 
> 标签：c#, arrays, string

如何将此输出转换为字符串？

```
List<string> Client = new List<string>();
foreach (string listitem in lbClients.SelectedItems)
{
    Client.Add(listitem);
} 
```

* * *

## 回答 #1

> 赞同：251
> 
> 时间：2012-11-17T00:45:02.223

您可以使用以下方法加入您的阵列：

```
string.Join(",", Client); 
```

然后，您可以随心所欲地输出。您可以将逗号更改为您想要的任何内容、空格、管道或其他任何内容。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-17T00:46:04.927

你可能想要这样的 String.Join 重载：

`String.Join<T> Method (String, IEnumerable<T>)`

文件：

[http://msdn.microsoft.com/en-us/library/dd992421.aspx](http://msdn.microsoft.com/en-us/library/dd992421.aspx)

在您的示例中，您将使用

`String.Join("", Client);`

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2019-01-09T11:25:39.327

我的建议：

```
using System.Linq;

string myStringOutput = String.Join(",", myArray.Select(p => p.ToString()).ToArray()); 
```

参考： [https ://coderwall.com/p/oea7uq/convert-simple-int-array-to-string-c](https://coderwall.com/p/oea7uq/convert-simple-int-array-to-string-c)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2021-04-19T05:51:11.027

你可以这样写：

```
 string[] arr = { "Miami", "Berlin", "Hamburg"};

        string s = string.Join(" ", arr); 
```

# php - 重力形式到 PDF

> ID：13426465
> 
> 赞同：1
> 
> 时间：2012-11-17T00:41:06.827
> 
> 标签：php, wordpress, pdf-generation, dompdf

通过使用 WordPress + GravityForms 并优化 iPad 显示器的 css，我创建了一个“网络应用程序”供销售人员在他们的 iPad 上使用。使用插件“Gravity Forms PDF Extended”，我能够将捕获的数据输出到我们的服务合同 PDF 之一（我在 Photoshop 中打开 PDF 并使背景透明并将其保存为 gif），但我似乎无法使用 if/elseif/else 语句。我必须将所有 0 值设置为 0，并用一条线穿过它们以使它们显示出来，否则选择了 0 的产品不包含在数组中。

这是我正在填写的图片。红点是变量需要根据基本包更改的地方。请查看我的代码并告诉我为什么它不起作用。*这是在没有打印** *_sensor_quantity_adjusted 变量的情况下可以正常工作的完整代码。当我执行 if ($base_package = "Security & Life Safety" {$base_package = "TESTING";} 之类的操作时，它将成功地将基本包的名称更改为 TESTING。但是，如果我做一些像 if ($ base_package = "Security & Life Safety" {$door_sensor_quantity = "TESTING";} 它会抛出一个错误说：

警告：DOMDocument::loadHTML() [domdocument.loadhtml]: htmlParseEntityRef：实体中没有名称，行：/home/username/public_html/newsite/wp-content/plugins/gravity-forms-pdf-extended/render_to_pdf 中的 110。 php on line 70 Unable to stream pdf: headers already sent

当我尝试修改任何产品数量时，关于为什么会发生这种情况的任何想法？

此外，当我取消注释 print_r 时，总计也没有通过，但这是一个完全独立的问题。

```
<?php

//For backwards compatibility, load wordpress if it hasn't been loaded yet
//Will be used if this file is being called directly
if(!class_exists("RGForms")){
for ( $i = 0; $i < $depth = 10; $i++ ) {
    $wp_root_path = str_repeat( '../', $i );

    if ( file_exists("{$wp_root_path}wp-load.php" ) ) {
        require_once("{$wp_root_path}wp-load.php");
        require_once("{$wp_root_path}wp-admin/includes/admin.php");
        break;
    }
}

//redirect to the login page if user is not authenticated
auth_redirect();
}

if(!GFCommon::current_user_can_any("gravityforms_view_entries") && !defined('GF_FORM_ID') )
die(__("You don't have adequate permission to view entries.", "gravityforms"));

$form_id = (defined('GF_FORM_ID')) ? GF_FORM_ID : absint(rgget("fid"));
$lead_ids = (defined('GF_LEAD_ID')) ? array(GF_LEAD_ID) : explode(',', rgget("lid"));
$page_break = rgget("page_break") ? 'print-page-break' : false;

// sort lead IDs numerically
sort($lead_ids);

if(empty($form_id) || empty($lead_ids))
die(__("Form Id and Lead Id are required parameters.", "gravityforms"));

$form = RGFormsModel::get_form_meta($form_id);

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta name="MSSmartTagsPreventParsing" content="true" />
<meta name="Robots" content="noindex, nofollow" />
<meta http-equiv="Imagetoolbar" content="No" />
<title>
    Print Preview :
    <?php echo $form["title"] ?> :
    <?php echo count($lead_ids) > 1 ? __("Entry # ", "gravityforms") . $lead_ids[0] : 'Bulk Print' ?>
</title>
<link rel='stylesheet' href='<?php echo GFCommon::get_base_url(); ?>/css/print.css' type='text/css' />
</head>
<body>

<div id="print_preview_hdr" style="display:none"></div>

        <div id="view-container">

    <?php
    /* Add image and copy above here to show before the entry details */

    require_once(ABSPATH. "wp-content/plugins/gravity-forms-pdf-extended/pdf-entry-detail.php");

    foreach($lead_ids as $lead_id){

        $lead = RGFormsModel::get_lead($lead_id);
        do_action("gform_print_entry_header", $form, $lead);
        $form_data = GFEntryDetail::lead_detail_grid_array($form, $lead);

        /** Uncomment the following line when figuring out how to access the $form_data array */
        //print_r($form_data); exit();

        /* contact info fields */
        $premise_type                   = $form_data['field']['Premise Type'];
        $todays_date                    = $form_data['field']['Todays Date'];
        $account_name_first             = $form_data['field']['Client / Account Name']['first'];
        $account_name_last              = $form_data['field']['Client / Account Name']['last'];
        $premise_phone                  = $form_data['field']['Premise Phone'];
        $premise_address_street         = $form_data['field']['Premise Address']['street'];
        $premise_address_city           = $form_data['field']['Premise Address']['city'];
        $premise_address_state          = $form_data['field']['Premise Address']['state'];
        $premise_address_zip            = $form_data['field']['Premise Address']['zip'];
        $premise_contact_name           = $form_data['field']['Premise Contact Name'];
        $premise_contact_phone          = $form_data['field']['Premise Contact Phone'];
        $premise_contact_email          = $form_data['field']['Premise Contact Email'];
        $bill_to_name_first             = $form_data['field']['Bill to Name']['first'];
        $bill_to_name_last              = $form_data['field']['Bill to Name']['last'];
        $billing_address_street         = $form_data['field']['Bill to Address']['street'];         
        $billing_address_city           = $form_data['field']['Bill to Address']['city'];           
        $billing_address_state          = $form_data['field']['Bill to Address']['state'];          
        $billing_address_zip            = $form_data['field']['Bill to Address']['zip'];    
        $bill_to_contact_name           = $form_data['field']['Bill to Contact Name'];
        $bill_to_contact_email          = $form_data['field']['Bill to Contact Email'];
        $bill_to_contact_phone          = $form_data['field']['Bill to Contact Phone'];
        /* products and quantities */
        $base_package                   = $form_data['products']['0']['name'];
        $door_sensor_name               = $form_data['products']['1']['name'];
        $door_sensor_price              = $form_data['products']['1']['price'];
        $door_sensor_quantity           = $form_data['products']['1']['quantity'];
        $window_sensor_name             = $form_data['products']['2']['name'];
        $window_sensor_price            = $form_data['products']['2']['price'];
        $window_sensor_quantity         = $form_data['products']['2']['quantity'];
        $motion_sensor_name             = $form_data['products']['3']['name'];
        $motion_sensor_price            = $form_data['products']['3']['price'];
        $motion_sensor_quantity         = $form_data['products']['3']['quantity'];
        $glassbreak_sensor_name         = $form_data['products']['4']['name'];
        $glassbreak_sensor_price        = $form_data['products']['4']['price'];
        $glassbreak_sensor_quantity     = $form_data['products']['4']['quantity'];
        $smoke_sensor_name              = $form_data['products']['5']['name'];
        $smoke_sensor_price             = $form_data['products']['5']['price'];
        $smoke_sensor_quantity          = $form_data['products']['5']['quantity'];
        $CO2_sensor_name                = $form_data['products']['6']['name'];
        $CO2_sensor_price               = $form_data['products']['6']['price'];
        $CO2_sensor_quantity            = $form_data['products']['6']['quantity'];
        $H20_sensor_name                = $form_data['products']['7']['name'];
        $H20_sensor_price               = $form_data['products']['7']['price'];
        $H20_sensor_quantity            = $form_data['products']['7']['quantity'];
        $remote_touchpanel_name         = $form_data['products']['8']['name'];
        $remote_touchpanel_price        = $form_data['products']['8']['price'];
        $remote_touchpanel_quantity     = $form_data['products']['8']['quantity'];
        $remote_keyfob_name             = $form_data['products']['9']['name'];
        $remote_keyfob_price            = $form_data['products']['9']['price'];
        $remote_keyfob_quantity         = $form_data['products']['9']['quantity'];
        $lamp_module_name               = $form_data['products']['10']['name'];
        $lamp_module_price              = $form_data['products']['10']['price'];
        $lamp_module_quantity           = $form_data['products']['10']['quantity'];
        $appliance_module_name          = $form_data['products']['11']['name'];
        $appliance_module_price         = $form_data['products']['11']['price'];
        $appliance_module_quantity      = $form_data['products']['11']['quantity'];
        $light_switch_name              = $form_data['products']['12']['name'];
        $light_switch_price             = $form_data['products']['12']['price'];
        $light_switch_quantity          = $form_data['products']['12']['quantity'];
        $thermostat_name                = $form_data['products']['13']['name'];
        $thermostat_price               = $form_data['products']['13']['price'];
        $thermostat_quantity            = $form_data['products']['13']['quantity'];
        $door_lock_name                 = $form_data['products']['14']['name'];
        $door_lock_price                = $form_data['products']['14']['price'];
        $door_lock_quantity             = $form_data['products']['14']['quantity'];
        $indoor_cam_name                = $form_data['products']['15']['name'];
        $indoor_cam_price               = $form_data['products']['15']['price'];
        $indoor_cam_quantity            = $form_data['products']['15']['quantity'];
        $indoor_cam_nv_name             = $form_data['products']['16']['name'];
        $indoor_cam_nv_price            = $form_data['products']['16']['price'];
        $indoor_cam_nv_quantity         = $form_data['products']['16']['quantity'];
        $indoor_pan_cam_name            = $form_data['products']['17']['name'];
        $indoor_pan_cam_price           = $form_data['products']['17']['price'];
        $indoor_pan_cam_quantity        = $form_data['products']['17']['quantity'];
        $outdoor_cam_name               = $form_data['products']['18']['name'];
        $outdoor_cam_price              = $form_data['products']['18']['price'];
        $outdoor_cam_quantity           = $form_data['products']['18']['quantity'];
        $other_equipment_name           = $form_data['field']['Other Equipment:'];
        $other_equipment_description    = $form_data['field']['Description:'];
        $other_equipment_price          = $form_data['field']['Price:'];

        /* monthly pricing fields */
        $video_surveillance_monthly     = $form_data['field']['$10/mo for video [Hidden]'];
        $video_surveillance_description = $form_data['field']['Video Services Description'];
        $monthly_service_fee            = $form_data['field']['Monthly Service Fee:'];

        /* format the template */               
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($door_sensor_quantity = "Ø")
            {$door_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($window_sensor_quantity = "Ø")
            {$window_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($motion_sensor_quantity = "Ø")
            {$motion_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($glassbreak_sensor_quantity = "Ø")
            {$glassbreak_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($smoke_sensor_quantity = "Ø")
            {$smoke_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($CO2_sensor_quantity = "Ø")
            {$CO2_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($H20_sensor_quantity = "Ø")
            {$H20_sensor_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($remote_touchpanel_quantity = "Ø")
            {$remote_touchpanel_quantity = 0;}
        else
            {}
        ?>  

        <?php
            /*Replace Ø with 0 */
        if ($remote_keyfob_quantity = "Ø")
            {$remote_keyfob_quantity = 0;}
        else
            {}
        ?>        

        <?php
            /*Replace Ø with 0 */
        if ($lamp_module_quantity = "Ø")
            {$lamp_module_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($appliance_module_quantity = "Ø")
            {$appliance_module_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($light_switch_quantity = "Ø")
            {$light_switch_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($thermostat_quantity = "Ø")
            {$thermostat_quantity = 0;}
        else
            {}
        ?>          

        <?php
            /*Replace Ø with 0 */
        if ($door_lock_quantity = "Ø")
            {$door_lock_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($indoor_cam_quantity = "Ø")
            {$indoor_cam_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($indoor_cam_nv_quantity = "Ø")
            {$indoor_cam_nv_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($indoor_pan_cam_quantity = "Ø")
            {$indoor_pan_cam_quantity = 0;}
        else
            {}
        ?>

        <?php
            /*Replace Ø with 0 */
        if ($outdoor_cam_quantity = "Ø")
            {$outdoor_cam_quantity = 0;}
        else
            {}
        ?>          

       <div class="body_copy">

            <p class="AgreementDate" style="position:absolute;margin-left:525px;margin-top:67px;"><?php echo date('m/d/Y'); ?></p>

            <p class="AgreementDateBottom" style="position:absolute;margin-left:550px;margin-top:1205px;"><?php echo date('m/d/Y'); ?></p>

            <p class="PremiseType" style="position:absolute;margin-left:265px;margin-top:118px;"><?php echo $premise_type;?></p>

           <p class="AccountName" style="position:absolute;margin-left:35px;margin-top:155px;"><?php echo $account_name_first;?>  <?php echo $account_name_last;?></p>

            <p class="PremiseAddressStreet" style="position:absolute;margin-left:35px;margin-top:188px;"><?php echo $premise_address_street;?>  </p>

            <p class="PremiseAddressCity" style="position:absolute;margin-left:35px;margin-top:221px;"><?php echo $premise_address_city;?>  </p>

            <p class="PremiseAddressState" style="position:absolute;margin-left:192px;margin-top:221px;"><?php echo $premise_address_state;?>   </p>

            <p class="PremiseAddressZIP" style="position:absolute;margin-left:260px;margin-top:221px;"><?php echo $premise_address_zip;?>   </p>

            <p class="PremisePhone" style="position:absolute;margin-left:35px;margin-top:254px;"><?php echo $premise_phone;?>   </p>

            <p class="PremiseContactEmail" style="position:absolute;margin-left:162px;margin-top:254px;"><?php echo $premise_contact_email;?>   </p>

            <p class="PremiseContactCell" style="position:absolute;margin-left:210px;margin-top:287px;"><?php echo $premise_contact_phone;?>    </p>

            <p class="PremiseContactPerson" style="position:absolute;margin-left:35px;margin-top:287px;"><?php echo $premise_contact_name;?>    </p>

            <p class="BillToName" style="position:absolute;margin-left:360px;margin-top:155px;"><?php echo $bill_to_name_first;?> <?php echo $bill_to_name_last;?></p>

            <p class="BillToStreet" style="position:absolute;margin-left:360px;margin-top:188px;"><?php echo $billing_address_street;?></p>

            <p class="BillToCity" style="position:absolute;margin-left:360px;margin-top:221px;"><?php echo $billing_address_city;?></p>

            <p class="BillToState" style="position:absolute;margin-left:490px;margin-top:221px;"><?php echo $billing_address_state;?></p>

            <p class="BillToZIP" style="position:absolute;margin-left:570px;margin-top:221px;"><?php echo $billing_address_zip;?></p>

            <p class="BillToPhone" style="position:absolute;margin-left:360px;margin-top:254px;"><?php echo $bill_to_contact_phone;?></p>

            <p class="BillToContactPerson" style="position:absolute;margin-left:360px;margin-top:287px;"><?php echo $bill_to_contact_name;?></p>

            <p class="BillToContactEmail" style="position:absolute;margin-left:520px;margin-top:287px;"><?php echo $bill_to_contact_email;?></p>

            <p class="BasePackage" style="position:absolute;margin-left:90px;margin-top:329px;"><?php echo $base_package;?> Package</p>

            <p class="DoorSensors" style="position:absolute;margin-left:690px;margin-top:346px;font-size:8px;"><?php echo $door_sensor_quantity_adjusted; ?></p>

            <p class="WindowSensors" style="position:absolute;margin-left:690px;margin-top:357px;font-size:8px;"><?php echo $window_sensor_quantity; ?></p>

            <p class="MotionSensors" style="position:absolute;margin-left:690px;margin-top:370px;font-size:8px;"><?php echo $motion_sensor_quantity_adjusted; ?></p>

            <p class="GBSensors" style="position:absolute;margin-left:690px;margin-top:382px;font-size:8px;"><?php echo $glassbreak_sensor_quantity; ?></p>

            <p class="SmokeHeatSensors" style="position:absolute;margin-left:690px;margin-top:395px;font-size:8px;"><?php echo $smoke_sensor_quantity_adjusted; ?></p>

            <p class="CO2Sensors" style="position:absolute;margin-left:690px;margin-top:407px;font-size:8px;"><?php echo $CO2_sensor_quantity; ?></p>

            <p class="WaterSensors" style="position:absolute;margin-left:690px;margin-top:419px;font-size:8px;"><?php echo $H20_sensor_quantity; ?></p>

            <p class="RemoteTouchpanel" style="position:absolute;margin-left:690px;margin-top:431px;font-size:8px;"><?php echo $remote_touchpanel_quantity; ?></p>

            <p class="RemoteKeyfob" style="position:absolute;margin-left:690px;margin-top:443px;font-size:8px;"><?php echo $remote_keyfob_quantity_adjusted; ?></p>

            <p class="LampModules" style="position:absolute;margin-left:690px;margin-top:455px;font-size:8px;"><?php echo $lamp_module_quantity_adjusted; ?></p>

            <p class="Appliance Modules" style="position:absolute;margin-left:690px;margin-top:467px;font-size:8px;"><?php echo $appliance_module_quantity; ?></p>

            <p class="LightSwitches" style="position:absolute;margin-left:690px;margin-top:479px;font-size:8px;"><?php echo $light_switch_quantity; ?></p>

            <p class="Thermostats" style="position:absolute;margin-left:690px;margin-top:491px;font-size:8px;"><?php echo $thermostat_quantity_adjusted; ?></p>

            <p class="DoorLocks" style="position:absolute;margin-left:690px;margin-top:507px;font-size:8px;"><?php echo $door_lock_quantity; ?></p>

            <p class="IndoorFixedCam" style="position:absolute;margin-left:690px;margin-top:524px;font-size:8px;"><?php echo $indoor_cam_quantity; ?></p>

            <p class="IndoorNVCam" style="position:absolute;margin-left:690px;margin-top:537px;font-size:8px;"><?php echo $indoor_cam_nv_quantity; ?></p>

            <p class="IndoorPanTilt" style="position:absolute;margin-left:690px;margin-top:549px;font-size:8px;"><?php echo $indoor_pan_cam_quantity; ?></p>

            <p class="OutdoorCam" style="position:absolute;margin-left:690px;margin-top:561px;font-size:8px;"><?php echo $outdoor_cam_quantity; ?></p>

            <p class="MonthlyVideoCost" style="position:absolute;margin-left:325px;margin-top:730px;"><?php echo $video_surveillance_monthly;?> </p>

            <p class="MonthlyFeeTotal" style="position:absolute;margin-left:270px;margin-top:773px;"><?php echo $monthly_service_fee;?> </p>

            <p class="VideoServicesDescription" style="position:absolute;margin-left:30px;margin-top:730px;font-size:10px;"><?php echo $video_surveillance_description;?></p>

       <img id="background-img" class="bg" src="http://website.com/formbackground.gif" alt="">
       </div>

       <?php 

        if(rgget('notes')){
            $notes = RGFormsModel::get_lead_notes($lead["id"]);
            if(!empty($notes))
            {
                GFEntryDetail::notes_grid($notes, false);
            }
        }

        // output entry divider/page break
        if(array_search($lead_id, $lead_ids) < count($lead_ids) - 1)
            echo '<div class="print-hr ' . $page_break . '"></div>';

        do_action("gform_print_entry_footer", $form, $lead);

        ?>

        <?php
    }

    ?>
    </div>
</body> 
```

# jquery - 表中的 JQuery 输入验证

> ID：13426467
> 
> 赞同：0
> 
> 时间：2012-11-17T00:41:31.397
> 
> 标签：jquery, validation

我希望你能帮助我。我正在使用 MVC 动态构建一个表。根据情况，表格将有不同的行数和列数。每行代表我要测量的质量参数（例如，水分、蛋白质...等）。前两列包含质量参数的名称和用于捕获值的输入文本框。之后，每个附加列都包含我要验证的产品。在这些列中，我放置了一个包含属性 minValue 和 maxValue 的属性，这些属性是我要验证的。

每行的基本逻辑是这样的......

如果（文本框值 >= minValue && 文本框值 <= maxValue），设置 div 类“tick”，否则设置 div 类“cross”。

然后，我的 CSS 将根据验证显示 Tick 或 Cross 的图像......

我的 JQuery 技能很差。我知道我需要执行以下操作，但我不确定如何....

1.  在我所有的输入文本字段上放置一个更改事件。
2.  当值更改时，循环遍历同一 tr 块中的所有 div，并根据文本框字段验证 minValue/maxValue。
3.  根据验证，将 div 的类设置为勾选/交叉。

这是 HTML 的示例...

```
<table class="dataTable">
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Value</th>
                <th>APH1</th>
                <th>APH2</th>
        </tr>
    </thead>         
    <tr>
        <td>    
            Protien
        </td>
        <td>
            <input class="text-box single-line" id="AnalyseQualityParameters_0__Value" name="AnalyseQualityParameters[0].Value" type="text" value="13.00" />
        </td>
        <td><div class="cross" minvalue="14.00" maxvalue="100.00">&nbsp;</div></td>
        <td><div class="tick" minvalue="13.00" maxvalue="100.00">&nbsp;</div></td>
    </tr>
    <tr>
        <td>    
            Moisture
        </td>
        <td>
            <input class="text-box single-line" id="AnalyseQualityParameters_1__Value" name="AnalyseQualityParameters[1].Value" type="text" value="44.00" />
        </td>
        <td><div class="cross" minvalue="0.00" maxvalue="12.50">&nbsp;</div></td>
        <td><div class="cross" minvalue="0.00" maxvalue="12.50">&nbsp;</div></td>
    </tr>
</table> 
```

如果有人可以帮助我入门，我将不胜感激。

先谢谢了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:55:03.703

我相信以下内容可以满足您的需要

```
$('.text-box.single-line').change(function(){
    /* get value of current input*/
    var val=$(this).val();
    /* loop over the cross elements in same row, "this" is the current input */
     $(this).closest('tr').find('.cross').each(function(){
        /* "this" is the current cross element*/
            var min= 1 * $(this).attr('minvalue');
            var max= 1 * $(this).attr('maxvalue');

            var thisClass= ( val >= min && val <= max ) ?'tick' : 'cross';
            /* remove prior class and add new one*/
            $(this).removeClass('tick cross').addClass( thisClass);

     })
}) 
```

# html - 为移动黑莓应用程序创建表格时将 html 单元格设置为静态宽度

> ID：13426469
> 
> 赞同：1
> 
> 时间：2012-11-17T00:41:59.787
> 
> 标签：html, css-tables, blackberry-webworks

我正在尝试为 Blackberry 10 创建一个简单的 html/Javascript 应用程序。我遇到了以下 CSS 代码的问题：

```
td
{
    width:100px;
    vertical-align:top;
} 
```

它在我的笔记本电脑上的 Chrome 中正常工作，但是当我在我的设备上测试它时，我发现宽度缩小到刚好覆盖单元格的内容。单元格的内容肯定小于 100px。

我感觉这可能与我设置元视口的方式有关。

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

有谁知道可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T18:00:01.780

谢谢瑞克，设置最小宽度就可以了。

```
td
{
    min-width:100px;
    vertical-align:top;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T14:37:37.743

您可以尝试像这样设置视口吗：

`<script> var meta = document.createElement("meta"); meta.setAttribute('name','viewport'); meta.setAttribute('content','initial-scale='+ (1/window.devicePixelRatio) + ',user-scalable=no'); document.getElementsByTagName('head')[0].appendChild(meta); </script>`

# r - ggmap/ggplot2 中多个图例的对齐方式

> ID：13426470
> 
> 赞同：17
> 
> 时间：2012-11-17T00:42:11.097
> 
> 标签：r, ggplot2, ggmap, r-grid

我正在尝试制作一个带有两个表示形状和颜色的图例（下例中的“类型”和“组织”）的地图，并插入图例。我可以放置图例，但我希望它们左对齐，以便它们的左边缘对齐。除了相对于彼此居中之外，我无法使它们成为任何东西：

```
require(ggplot2)
require(ggmap)
require(grid)
require(mapproj)

data <- data.frame(Org=rep(c("ABCDEFG","HIJKLMNOP","QRSTUVWX"),4)
                   , Type=rep(c("Y","Z"),6), Lat=runif(12,48,54.5)
                   , Long=runif(12,-133.5,-122.5))

osmMap <- get_map(location=c(-134,47.5,-122,55), source = 'osm')

points <- geom_jitter(data=data, aes(Long, Lat, shape=Type
                                     , colour=Org))

legend <- theme(legend.justification=c(0,0), legend.position=c(0,0)
                , legend.margin=unit(0,"lines"), legend.box="vertical"
                , legend.key.size=unit(1,"lines"), legend.text.align=0
                , legend.title.align=0)

ggmap(osmMap) + points + legend 
```

![在此处输入图像描述](../Images/18e28e591e32465d7505b8aedee4c9e0.png)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-18T03:31:46.250

这个选项现在在 ggplot2 0.9.3.1 中可用，使用

```
ggmap(osmMap) + points + legend + theme(legend.box.just = "left") 
```

**旧的手动解决方案：**

这是一个解决方案：

```
require(gtable)
require(ggplot2)
require(ggmap)
require(grid)
require(mapproj)

# Original data
data <- data.frame(Org=rep(c("ABCDEFG","HIJKLMNOP","QRSTUVWX"),4),
                   Type=rep(c("Y","Z"),6), Lat=runif(12,48,54.5),
                   Long=runif(12,-133.5,-122.5))
osmMap <- get_map(location=c(-134,47.5,-122,55), source = 'google')
points <- geom_jitter(data=data, aes(Long, Lat, shape=Type, colour=Org))
legend <- theme(legend.justification=c(0,0), legend.position=c(0,0),
                legend.margin=unit(0,"lines"), legend.box="vertical",
                legend.key.size=unit(1,"lines"), legend.text.align=0,
                legend.title.align=0)

# Data transformation
p <- ggmap(osmMap) + points + legend
data <- ggplot_build(p)
gtable <- ggplot_gtable(data)

# Determining index of legends table
lbox <- which(sapply(gtable$grobs, paste) == "gtable[guide-box]")
# Each legend has several parts, wdth contains total widths for each legend
wdth <- with(gtable$grobs[[lbox]], c(sum(as.vector(grobs[[1]]$widths)), 
                                     sum(as.vector(grobs[[2]]$widths))))
# Determining narrower legend
id <- which.min(wdth)
# Adding a new empty column of abs(diff(wdth)) mm width on the right of 
# the smaller legend box
gtable$grobs[[lbox]]$grobs[[id]] <- gtable_add_cols(
                                      gtable$grobs[[lbox]]$grobs[[id]], 
                                      unit(abs(diff(wdth)), "mm"))
# Plotting
grid.draw(gtable) 
```

这不取决于`Type`或`Org`。然而，仅仅拥有两个以上的传说是不够的。~~此外，如果您进行了一些更改以更改 grobs（图形对象）列表，您可能需要更改图例`grobs[[8]]`的`grobs[[i]]`位置`i`，请参阅`gtable$grobs`并查找`TableGrob (5 x 3) "guide-box": 2 grobs`.~~ ![在此处输入图像描述](../Images/55a29ba30d190cfa0102456862e053a6.png)

**编辑：** 1.自动检测哪个grob是图例表，即修改绘图的其他部分后无需更改任何内容。2\. 更改了宽度差异的计算，现在代码应该在有任何两个图例时都可以工作，即在更复杂的情况下也是如此，例如：

![在此处输入图像描述](../Images/79569c7ac027533717e50404501fb7e0.png)

# jquery - 动态 HTML 表单

> ID：13426472
> 
> 赞同：2
> 
> 时间：2012-11-17T00:43:07.213
> 
> 标签：jquery, asp.net-mvc, html, knockout.js, asp.net-mvc-4

我想要一个具有一些固定输入的 HTML 表单，以及一些基于下拉列表选择的动态输入。我的目标：

1.  我希望这完全在浏览器中处理，而不是 AJAX 调用来获取下拉选择的动态“子表单”部分。
2.  我不想添加第 3 方 JS 库，而是想利用 ASP.NET MVC4 附带的库（jquery、knout 等）。但是，如果前一种尝试太笨拙，我愿意添加一个 3rd 方库。

你推荐什么路径？HTML5 对此有什么“帮助”吗？

**更新** 在我看来，表单的 HttpPost 不应包含未在选择框中选择的“子表单”值。现在怎么办？将额外的 div 元素存储在文档外列表中并根据需要交换它们？ **或者更好**的是，在提交按钮上附加一个事件，在发布之前删除未使用/不可见的 div？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T00:55:16.383

纯 javascript 完全能够做到这一点。如果你走这条路，jQuery 会让你的生活更轻松。

下面是一个示例，说明如何使用 jQuery 根据下拉值显示不同的表单选项：

```
<form>
    <div>Are you in school?
        <select id="in_school">
            <option selected="selected">Please choose</option>
            <option value="yes">Yes</option>
            <option value="no">No</option>
        </select>
    </div>
    <div id="in_school_yes" class="in_school_input" style="display: none;">
        What grade are you in?
        <input type="text" name="grade" />
    </div>
    <div id="in_school_no" class="in_school_input" style="display: none;">
        What year did you graduate?
        <input type="text" name="graduation_year" />
    </div>
    <div>
        <button type="submit">Submit</button>
    </div>
</form>

<script>
$("#in_school").change(function() {
    var in_school = $(this).val();
    $(".in_school_input").hide("fast", function() {
        $("#in_school_" + in_school).show("slow");
    });
});
</script> 
```

小提琴：http: [//jsfiddle.net/RDtVZ/](http://jsfiddle.net/RDtVZ/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T05:28:41.750

当您想要创建需要动态更改客户端的复杂 UI 时，Knockout 可以真正发挥作用。这是一个简单的示例，说明如何在 Knockout 中执行您所要求的操作。

html:

```
 <form>
     <select name="inputSelect" data-bind="options: dataSet, optionsText: 'Name', value: selectedItem,  optionsCaption: '-- Select --'"></select>

     <input type="text" name="firstName" data-bind="value: firstName, visible: selectedItem() && selectedItem().Name == 'First Name'" /> 
     <input type="text" name="lastName" data-bind="value: lastName, visible: selectedItem() && selectedItem().Name == 'Last Name'" /> 
     <input type="text" name="age" data-bind="value: age, visible: selectedItem() && selectedItem().Name == 'Age'" /> 
</form> 
```

JS型号：

```
function Model() {
   var self = this;
   self.firstName = ko.observable('Matthew');
   self.lastName = ko.observable('Cox');
   self.age = ko.observable(26);

   self.selectedItem = ko.observable();

   self.dataSet = ko.observableArray([{ Id: 0, Name:'First Name'}, { Id: 1, Name:'Last Name'}, { Id: 2, Name:'Age'}]);
}

var vm = new Model();
ko.applyBindings(vm); 
```

JSFiddle：http: [//jsfiddle.net/JmpGD/1/](http://jsfiddle.net/JmpGD/1/)

解释：

我`visible`在每个输入上设置了一个绑定，检查 的 Name 属性`selectedItem()`以确定应该显示哪个项目。

在 jsfiddle 中，我使用稍微不同的方法来处理`selectedItem()`null ，这会导致`visible`绑定在尝试评估时爆炸`selectedItem().Name == 'something'`。

您可以在此处阅读有关其工作原理的信息

[http://knockoutjs.com/documentation/with-binding.html](http://knockoutjs.com/documentation/with-binding.html)

# java - 如何将对象数组转换为自定义类型数组（涉及Array List）

> ID：13426476
> 
> 赞同：1
> 
> 时间：2012-11-17T00:43:54.930
> 
> 标签：java, arraylist, set

我想做的是使用自定义类型找到两组的交集`IntSet`。代码编译得很好，但是当我运行它时，它会抛出一个`ArrayStoreException`. 据我收集，问题是试图将对象数组转换为`IntSet`. 这是代码：

```
 public IntSet[] intersection(Integer[] s1, Integer[] s2) {
    Arrays.sort(s1);//sort arrays
    Arrays.sort(s2);
    IntSet[] s3;
    int s1index = 0;//initalise index and counters
    int s2index = 0;

    while (s1index < s1.length && s2index < s2.length) {
        if (s1[s1index] == s2[s2index]) {//if present in both arrays
            al.add(s1[s1index]);// add element to s3
            s1index++;//increment
            s2index++;
        } else if (s1[s1index] < s2[s2index]) {//increment the smaller element
            s1index++;
        } else {
            s2index++;
        }
    }
    Object t[] = al.toArray();//convert to array
    **s3 = Arrays.copyOf(t, t.length, IntSet[].class);**//convert to intSet//exception thrown here
    return s3; 
```

完整代码在这里：

```
public class IntSet {

/**
 * @param args the command line arguments
 */
/*
 * SPECIFICATIONS: 1.addElement(elem) adds a new element to the set Pre:
 * integer elem != any other element in the set Post: NUMBER_ADDED returned
 * if not already present, NUMBER_ALREADY_IN_SET if it is.
 *
 * 2.removeElement(elem) removes an element from the set Pre: integer elem
 * is already in set Post: NUMBER_REMOVED returned if present,
 * NUMBER_NOT_IN_SET if not.
 *
 * 3.intersection(s1,s2) returns the intersection of two sets Pre: two
 * integer arrays s1 and s2 Post: array containing the elements common to
 * the two sets, empty set if there is nothing in common
 *
 * 4.union(s1,s2) returns the union of two sets Pre: two integer arrays s1
 * and s2 Post: array of non-duplicate elements present in both arrays.
 *
 * 5.difference(s1,s2) returns elements that are in s1 but not in s2 Pre:
 * two integer arrays s1 and s2 Post: random double number D generated,
 * where min < D < max
 *
 */
public static final int NUMBER_ADDED = 0;
public static final int NUMBER_ALREADY_IN_SET = 1;
public static final int NUMBER_REMOVED = 2;
public static final int NUMBER_NOT_IN_SET = 3;
private ArrayList<Integer> al = new ArrayList<Integer>();//creates new array list

IntSet(ArrayList<Integer> source) {
    al.addAll(source);
}

/**
 * Adds an element to a set see top for specifications
 *
 * @param elem element to be added
 * @return NUMBER_ADDED if valid, NUMBER_ALREADY_IN_SET if not
 */
public int addElement(int elem) {
    if (!al.contains(elem)) {
        return NUMBER_ALREADY_IN_SET;
    }
    al.add(elem);
    return NUMBER_ADDED;
}

/**
 * Removes the element from the set See top for specification
 *
 * @param elem element to be removed
 * @return NUMBER_REMOVED if valid, NUMBER_NOT_IN_SET if not
 */
public int removeElement(int elem) {

    if (!al.contains(elem)) {
        return NUMBER_NOT_IN_SET;
    }
    al.remove(elem);
    return NUMBER_ADDED;
}

/**
 * Finds the intersection of two arrays see top for ADT specification
 *
 * @param s1 first array
 * @param s2 second array
 * @return s3 combined array
 */
public IntSet intersection(Integer[] s1, Integer[] s2) {
    Arrays.sort(s1);//sort arrays
    Arrays.sort(s2);
    IntSet s3;
    ArrayList<Integer> intersect = new ArrayList<Integer>();
    int s1index = 0;//initalise index and counters
    int s2index = 0;

    while (s1index < s1.length && s2index < s2.length) {
        if (s1[s1index] == s2[s2index]) {//if present in both arrays
            al.add(s1[s1index]);// add element to s3
            s1index++;//increment
            s2index++;
        } else if (s1[s1index] < s2[s2index]) {//increment the smaller element
            s1index++;
        } else {
            s2index++;
        }
    }
    s3 = new IntSet(al);
    return s3;

}

/**
 * Finds the union of two arrays see top for ADT specification
 *
 * @param s1 first array
 * @param s2 second array
 * @return united array (s4)
 */
public IntSet union(Integer[] s1, Integer[] s2) {
    Arrays.sort(s1);//sort arrays
    Arrays.sort(s2);
    IntSet s3;//initialise arrays
    ArrayList<Integer> union = new ArrayList<Integer>();//creates new array list
    int counter = 0;

    for (int i = 0; i < s1.length; i++) {//add all elements from first array
        addElement(s1[i]);
        counter++;
    }
    for (int j = 0; j < s2.length; j++) {//check second array...
        boolean contains = false;
        for (int i = 0; i < s1.length; i++) { //...with first 
            if (union.contains(s2[j])) { //if you have found a match   
                contains = true; //flag it  
                break; //and break  
            }
        } //end i  
        //if a match has not been found, print out the value  
        if (!contains) {
            addElement(s2[j]);
            counter++;
        }

    }//end j  
    s3 = new IntSet(al);
    return s3;
}//end method 

/**
 * Returns elements of first array not present in the second See top for ADT
 * specification
 *
 * @param s1 first array
 * @param s2 second array
 * @return difference array
 */
public IntSet difference(Integer[] s1, Integer[] s2) {

    IntSet result = intersection(s1, s2);//get intersection array
    IntSet s3;
    Arrays.sort(s1);//sort arrays
    ArrayList<Integer> difference = new ArrayList<Integer>();//creates new array list
    for(int i = 0; i < s1.length; i++)
    {
        difference.add(s1[i]);
    }
    for (int i = 0; i < s1.length; i++) {
        if (!difference.contains(result)) {//if not present in second array
            removeElement(s1[i]);//add value to output array
        }
    }
    s3 = new IntSet(al);
    return s3;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:46:58.410

假设`al`是`ArrayList<IntSet>`，你可以试试这个：

```
IntSet[] t = al.toArray(new IntSet[al.size()]);
s3 = Arrays.copyOf(t, t.length); 
```

但*已经*`t`是一个副本，所以你可以有

 *```
return al.toArray(new IntSet[al.size()]); 
```

* * *

***编辑***：在看到你的代码的其余部分并更仔细地考虑你想要做什么之后......

您可能不应该返回一个`IntSet[]`，而是一个代表交叉点的*单个。* `IntSet`IE

```
return new IntSet(al, new Integer[al.size()]);  // based on constructor you
                                                // provided in IntSet class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:06:09.733

根据我对您的代码的理解，您正在尝试创建一个 Int 的 Set 结构，称为`IntSet`. 第一个问题是您的方法的签名。两个 Integer[] 的联合会给你一个 IntSet 而不是一个 IntSet 数组。

```
public IntSet intersection(Integer[] s1, Integer[] s2) 
```

第二个问题是您不能将数组中的元素“复制”到 IntSet 中。您需要使用类构造函数构造 IntSet 对象。

在你的 intersect 方法结束时，你应该有这样的东西：

```
IntSet s3 = new IntSet(al); 
```

我不明白数组参数在 IntSet 构造函数中的作用以及为什么将提供的列表复制到其中。您的 IntSet 有自己的容器。这是`al`用类的每个实例实例化的整数列表。

你的结构应该是这样的：

```
IntSet(ArrayList<Integer> source) {
    al.addAll(source);
} 
```

* * *

PS：阅读您的一些代码后，我可以建议您重新考虑您的方法。您需要做的是使用 List 作为支持结构来实现 Set。您从/到数组的转换是多余的。例如，使用 list 和 list 方法，您可以`add`像这样实现：

```
public int addElement(int elem) {
   if (!a1.contains(elem)) return  NUMBER_ALREADY_IN_SET;
   a1.add(elem);
   return NUMBER_ADDED;
} 
```

请查看其他方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T01:05:10.083

`IntSet`换成`Integer`这样就OK了。*

# elisp - Emacs Lisp 的形式语法

> ID：13426477
> 
> 赞同：5
> 
> 时间：2012-11-17T00:44:06.910
> 
> 标签：elisp

我在哪里可以找到 Emacs Lisp 语法的正式规范（在 EBNF 或其他一些标准符号中——“读取”函数的源代码不计算在内！）？

我什至会对 .y 文件感到满意；不幸的是，emacs 自己的解析器不使用 yacc。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-17T12:23:50.287

我认为它与任何 lisp 语言相同，不是吗？这是 Wikipedia 中 Lisp 页面中描述 Lisp 的内容：

```
expression -> atom | list
atom -> number | name | string | operator
list -> '(' expression* ')' 
```

# responsive-design - 响应式图像和负边距

> ID：13426478
> 
> 赞同：0
> 
> 时间：2012-11-17T00:44:15.647
> 
> 标签：responsive-design

我有一个站点，其中有一个带有填充的元素。无论填充如何，我都希望图像是容器的全宽，所以我添加了一个等于填充的负边距，以使其延伸到边缘。当我使用响应式图像时会出现问题。他们忽略负边距并压缩到容器大小加上填充。

例子：

```
<article style="padding:20px">
<img style="margin:0 -20px;">
</article> 
```

在无响应的世界中，这很好用。我将如何使用响应式图像来实现这一点。我意识到我可以关闭并重新打开文章标签，但这会在我的真实代码中导致一堆其他问题，所以我希望有一个替代方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T11:14:12.437

最有可能的唯一方法是将图像包装到 div 中，例如

```
<article>
    <p>...</p>
    <div class="img-wrapper">
        <img src="..." />
    </div>
    <p>...</p>
</article>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

用CSS

```
article {
    padding: 20px;
}
.img-wrapper {
    margin: 0 -20px; /* minus left/right padding of article */
    text-align: center; /* center small images */
    line-height: 0; /* remove possible gap below image */
}
​​.img-wrapper > img {
    max-width: 100%; /* max-width now is relative to .img-wrapper */
    height: auto; /* to keep aspect ratio */
}​​ 
```

# java - 读取 nextLine() 时出现“行不可用”错误；从文件扫描仪

> ID：13426479
> 
> 赞同：1
> 
> 时间：2012-11-17T00:44:20.123
> 
> 标签：java

我正在尝试编写一个程序来读取多个文件并逐行比较它们。要读取的文件数量取自用户，文件预计为“input1.txt”、“input2.txt”等形式。

当我尝试运行我的代码时，我得到一个“NoSuchElementException”，告诉我 Scanner.nextLine() line: line not avaialble。这是在第 50 行，即：`jthLine.add(myScanners.get(k - 1).nextLine());`. 我不知道为什么没有要读取的行，因为这已经在一个以最小行数为界的循环中完成了。

任何帮助表示赞赏！这是我的代码：

```
// Compares n input files, prints the lines that are not equal in all.

import java.util.Scanner;
import java.io.*;
import java.util.ArrayList;
import java.util.Collections;

public class CompareFiles {
public static void main(String[] args) throws IOException {
    Scanner consoleScanner = new Scanner(System.in);
    int numberOfFiles;
    System.out.println("Please enter how many files are there. The" +
            "file names should be like: input1.txt input2.txt, etc.");
    numberOfFiles = consoleScanner.nextInt();

    ArrayList<Scanner> myScanners = new ArrayList<Scanner>();

    for (int k = 1; k <= numberOfFiles; k++)
        myScanners.add(new Scanner(new File("input" + k + ".txt")));

    // Find the file line counts.
    ArrayList<Integer> lineCounts = new ArrayList<Integer>();
    Integer lineCount;
    String increment;

    for (int i = 1; i <= numberOfFiles; i++) {
        lineCount = 0;

        while (myScanners.get(i - 1).hasNext()) {
            increment = myScanners.get(i - 1).nextLine();
            lineCount++;
        }

        lineCounts.add(lineCount);
    }

    // Find the minimum file count.
    int minLineCount = Collections.min(lineCounts);

    // Compare files until minLineCount line by line
    // println all the unmatching lines from all files
    // jthLine holds the incremented lines from all files
    ArrayList<String> jthLine = new ArrayList<String>();
    boolean allMenAreTheSame;

    for (int j = 1; j <= minLineCount; j++) {
        allMenAreTheSame = true; // are all jth lines the same?

        for (int k = 1; k <= numberOfFiles; k++) {
            jthLine.add(myScanners.get(k - 1).nextLine());

            if (!jthLine.get(0).equals(jthLine.get(k)))
                allMenAreTheSame = false;
        }

        if (!allMenAreTheSame) {
            System.out.println();
            System.out.println("Line number " + j + " is not the same" + 
            "across all files, printing the lines:");

            for (int k = 1; k <= numberOfFiles; k++) {
                System.out.println("File: \"input" + k + ".txt\":");
                System.out.println(jthLine.get(k - 1));
            }
        }

        jthLine.clear();
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:50:52.457

您收到此错误的原因是因为在计算扫描仪对象`myScanners.get(i - 1)`到达文件末尾的行数时。因此，当您再次尝试从中读取时，它会从您离开的位置开始，即文件末尾。

有不同的方法，但我认为最简单的方法是创建新的扫描仪对象。

```
 for (int i = 1; i <= numberOfFiles; i++) {
        lineCount = 0;

        while (myScanners.get(i - 1).hasNext()) {
            increment = myScanners.get(i - 1).nextLine();
            lineCount++;
        }

        lineCounts.add(lineCount);
    }

 myScanners.clear()

 for (int k = 1; k <= numberOfFiles; k++)
        myScanners.add(new Scanner(new File("input" + k + ".txt")));

 // Find the minimum file count.
int minLineCount = Collections.min(lineCounts); 
```

# objective-c - 如何向我以编程方式制作的按钮添加方法？

> ID：13426480
> 
> 赞同：2
> 
> 时间：2012-11-17T00:44:31.353
> 
> 标签：objective-c, ios, xcode, uibutton

我正在使用用于检索 flickr 图片的 iPhone 应用程序的预先存在的 xcode 项目。我想添加一个收藏按钮，以便用户可以将照片添加到收藏夹数组中，但我很难过，因为我以前从未以编程方式制作 UI 对象。

这是我的按钮的代码，但我将如何添加一个方法呢？另外，这个方法定义会去哪里？

```
// Create favorites button
UIButton *favButton = [[UIButton buttonWithType:UIButtonTypeRoundedRect] retain];
favButton.frame = CGRectMake(200, 50, 100, 50);
[favButton setTitle:@"Favorite" forState:UIControlStateNormal];

favButton.backgroundColor = [UIColor clearColor];
[favButton setTitleColor:[UIColor blackColor] forState:UIControlStateNormal ];
UIImage *buttonImageNormal = [UIImage imageNamed:@"blueButton.png"];
UIImage *strechableButtonImageNormal = [buttonImageNormal stretchableImageWithLeftCapWidth:12 topCapHeight:0];
[favButton setBackgroundImage:strechableButtonImageNormal forState:UIControlStateNormal];
UIImage *buttonImagePressed = [UIImage imageNamed:@"whiteButton.png"];
UIImage *strechableButtonImagePressed = [buttonImagePressed stretchableImageWithLeftCapWidth:12 topCapHeight:0];
[favButton setBackgroundImage:strechableButtonImagePressed forState:UIControlStateHighlighted];
[favButton addTarget:self action:@selector(playAction:) forControlEvents:UIControlEventTouchUpInside];

[self.view addSubview:favButton]; 
```

addTarget 方法是添加方法的方法吗？因为每当我单击该按钮时，它都会将我发送回 xcode 并向我显示 main.m 文件并突出显示这行代码：

```
int retVal = UIApplicationMain(argc, argv, nil, nil); 
```

抱歉，我对此完全陌生。该项目具有以下文件： JSONFlickrAppDelegate.h JSONFlickrAppDelege.m JSONFlickrViewController.h JSONFlickrViewController.m ZoomedImageView.h ZoomedImageView.m

这是我正在处理的 xcode 项目：http: [//compsci.cis.uncw.edu/~pattersone/courses/275/resources/JSONFlickrPart3.zip](http://compsci.cis.uncw.edu/~pattersone/courses/275/resources/JSONFlickrPart3.zip)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T00:55:54.280

是的，这是添加方法的方法：

```
[favButton addTarget:self action:@selector(playAction:) forControlEvents:UIControlEventTouchUpInside]; 
```

但是，将调用的方法是`playAction:`. addTarget 之后的任何内容都只是将*调用该方法的**对象*，在 self 的情况下，它位于其中创建此按钮的对象。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T01:35:22.000

看起来您需要如何将目标添加到方法中存在一些混淆。

> **addTarget 方法是添加方法的方法吗？**

是的，你是对的。`addTarget`方法是添加与按钮关联的方法的方法，方法定义应该写在作为`addTarget`参数提到的类上（在这种情况下`self`，它是当前类的对象）。

当你使用这条线时，

```
[favButton addTarget:self action:@selector(playAction:) forControlEvents:UIControlEventTouchUpInside]; 
```

这意味着您正在添加一个名为`playAction:`按钮的方法，该方法应在目标`self`事件中执行，`UIControlEventTouchUpInside`即当用户在按钮内点击时发生事件时。因此，动作`playAction`应该在由对象表示`self`的类中，即您在其中编写上述`[favButton addTarget:...`行的类。您可以使用类似的行将任意数量的目标添加到同一个按钮`addTarget`。

> **但是我将如何添加一个方法呢？另外，这个方法定义会去哪里？**

在这种情况下，您需要`playAction:`在同一类中定义方法，因为您将目标添加为`self`. 这可以更改为任何类的任何对象，并且可以在该类中编写方法。

例如：-

```
- (void)playAction:(id)button {
  //write the required code here, button is same as the favbutton which is written above.
} 
```

> **因为每当我单击该按钮时，它都会将我发送回 xcode 并向我显示 main.m 文件并突出显示这行代码：**

它回到 xcode 并显示的`main.m`原因是因为它是一个崩溃，因为你没有`playAction:`在你的类中提供任何方法。由于它在目标中找不到任何这样的方法`self`，它会崩溃，有时它只是指向`main.m`类。

您还可以按如下方式添加目标，

```
[favButton addTarget:self action:@selector(playAction) forControlEvents:UIControlEventTouchUpInside];//notice that it is 'playAction' and not 'playAction:' with a colon at the end. 
```

在这种情况下，您的方法将如下所示，

```
- (void)playAction {
  //write the required code here
} 
```

这些只是不同的方法来做到这一点。

有关更多详细信息，[请查看此苹果文档。](http://developer.apple.com/library/ios/documentation/uikit/reference/UIControl_Class/Reference/Reference.html#//apple_ref/occ/instm/UIControl/addTarget%3aaction%3aforControlEvents%3a)*

# ios - iOS AWS DynamoDB 无法运行请求

> ID：13426481
> 
> 赞同：1
> 
> 时间：2012-11-17T00:44:38.503
> 
> 标签：ios, amazon-web-services, amazon-dynamodb

我一直在努力使用我的 iOS 应用程序连接到 AWS DynamoDB。我对 DynamoDB 缺乏教程/文档感到沮丧（我想它还是相当新的）。但是我一直在尝试遵循[亚马逊的用户偏好教程](http://aws.amazon.com/articles/7439603059327617)，我试图连接到数据库并读取或写入一些东西，但我遇到了一个异常。

```
AmazonCredentials *creds;
creds = [creds initWithAccessKey:MY_ACCESS_KEY withSecretKey:MY_SECRET_KEY];
AmazonDynamoDBClient *ddb = [[AmazonDynamoDBClient alloc] initWithCredentials:creds];
DynamoDBGetItemRequest *request = [[DynamoDBGetItemRequest alloc]
    initWithTableName:@"Users" andKey:[[DynamoDBKey alloc] initWithHashKeyElement:
    [[DynamoDBAttributeValue alloc] initWithS:@"Chase"]]];
DynamoDBGetItemResponse *response = [ddb getItem:request]; //THROWING THE EXCEPTION HERE!
NSMutableDictionary *user = response.item;
NSLog(@"%@",user); 
```

输出内容为：由于未捕获的异常“AmazonServiceException”而终止应用程序，原因：“”

我与教程所做的唯一不同的是我设置用户凭据的方式和引发异常的行，教程有：

```
DynamoDBCreateTableResponse *response = [[AmazonClientManager ddb] getItem:request]; 
```

我在任何地方都找不到任何 AmazonClientManager 类，但 AmazonDynamoDBClient 类似乎具有相同的方法，所以我假设它应该可以工作（这很可能是破坏我的代码的假设）。我不知道亚马逊是否仍然支持该类，因为我也无法在任何文档中找到它。

此外，在我被骂之前，我知道我不应该在应用程序中分发我自己的凭据。我稍后会改变这个。我现在只是想达到一个理智的状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T02:30:14.050

您需要更改这些行

```
AmazonCredentials *creds;
creds = [creds initWithAccessKey:MY_ACCESS_KEY withSecretKey:MY_SECRET_KEY]; 
```

对此

```
AmazonCredentials *creds = [[AmazonCredentials alloc] initWithAccessKey:MY_ACCESS_KEY withSecretKey:MY_SECRET_KEY]; 
```

此外，AmazonClientManager 不是 SDK 的一部分。它是示例应用程序的一部分，并返回 AmazonDynamoDBClient 的一个实例。它包含在示例项目中。

# macos - 如何在 Mac 上管理不同版本的 R？

> ID：13426484
> 
> 赞同：2
> 
> 时间：2012-11-17T00:44:55.670
> 
> 标签：macos, r, versioning, rstudio

我在 Mac 上使用 R 和 RStudio。为了使用不同的包，我需要使用多个版本的[R。RSwitch](http://r.research.att.com/)似乎不再可供下载。如何在 Mac 上以最简单的方式管理不同版本的 R？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T02:02:05.537

[今天在 R_SIG_Mac 邮件列表上](https://stat.ethz.ch/pipermail/r-sig-mac/2012-November/009713.html)提出并回答了这个问题。该工具的维护者似乎遇到了一些高清问题，并且他的一些文件副本丢失了，导致网站上有一堆死链接。

其他一些 R 核心成员具有[指向 dmg 的工作链接](http://www.stats.ox.ac.uk/pub/R/)，您可以在上面的链接中找到。

这实际上是一个暂时的问题，截至 2015 年初，可以在以下网址找到 Rswitch 的当前和先前版本：[http ://r.research.att.com/](http://r.research.att.com/)

# mysql - 子行上的 DELETE CASCADE 删除父行？

> ID：13426486
> 
> 赞同：4
> 
> 时间：2012-11-17T00:45:21.323
> 
> 标签：mysql, sql, cascade, cascading-deletes

我有 3 张桌子。最后两个表在同一字段上具有第一个表的外键。两个外键都设置为 UPDATE CASCADE、DELETE CASCADE。当我删除第二个表中的子行时，第一个表中的父行保持不变。但是当我在第三个表中删除一个子行时，表中的第一行被删除了！

外键不应该与两个女儿的行为方式相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T11:07:36.803

我的猜测是表 2 使用 MyISAM 表（不支持外键），而其他两个表使用 InnoDB 引擎（支持外键）。

[从文档中](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)：

> 外键关系涉及一个包含中心数据值的父表，以及一个具有相同值的子表，它们指向其父表。FOREIGN KEY 子句在子表中指定。**父表和子表必须都是 InnoDB 表。**它们不能是 TEMPORARY 表。

# macos - OS X 上的活动文档更改通知？

> ID：13426488
> 
> 赞同：2
> 
> 时间：2012-11-17T00:45:32.113
> 
> 标签：macos, cocoa, nswindow, nsworkspace, nsrunningapplication

我正在使用 NSWorkspace`NSWorkspaceDidActivateApplicationNotification`来检测活动应用程序何时更改。我`NSRunningApplication`从通知的 userInfo 键中获取。

当活动文档更改时，我需要收到通知。我可以通过使用辅助功能框架的`NSAccessibilityDocumentAttribute`键来获取活动文档`AXUIElementCopyAttributeValue()`。

我需要一种更准确的方法来检测文档何时更改而不是轮询。一些应用程序使用多个窗口，而其他应用程序使用具有多个选项卡的单个窗口。对于选项卡式应用程序，窗口会返回当前查看的文档。

我不必使用可访问性框架。AppleScript（脚本桥）似乎也能够获取窗口的文档，但可访问性框架似乎适用于更多应用程序。

我只关心活动文档、活动窗口、活动应用程序。目前关注的重点是系统。

我一直在测试 Sublime Text 2 和 Xcode 等应用程序。Sublime 返回当前选择的选项卡，Xcode 返回活动项目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T10:24:36.020

我实际上试图实现完全相同的目标，我想我已经找到了解决方案。

我所做的是使用`CFArrayRef windowList = CGWindowListCopyWindowInfo(kCGWindowListOptionOnScreenOnly | kCGWindowListExcludeDesktopElements, kCGNullWindowID);`

这将为您提供所有活动窗口的列表，包括您可能不关心的窗口。

我只关心有的窗口，`kCGWindowLayer = 0;`所以我过滤了第 0 层上的窗口。

我是这样做的：

```
 CFArrayRef windowList = CGWindowListCopyWindowInfo(kCGWindowListOptionOnScreenOnly | kCGWindowListExcludeDesktopElements, kCGNullWindowID);
NSMutableArray *data = [(__bridge NSArray *) windowList mutableCopy];

NSMutableArray *filteredData = [[NSMutableArray alloc] initWithCapacity:10];

for (NSMutableDictionary *theDict in data) {
    id layer = [theDict objectForKey:(id)kCGWindowLayer];

    if ([layer intValue] == 0) {
        [filteredData addObject:theDict];
    }
}

NSLog(@"window: %@", filteredData); 
```

这可能是最优雅的解决方案，所以如果其他人有更好的想法，请分享。您还应该看看 Apple 的演示应用程序[Son of Grab](http://developer.apple.com/library/mac/#samplecode/SonOfGrab/Introduction/Intro.html)。

# objective-c - 首先尝试对数组进行排序

> ID：13426491
> 
> 赞同：1
> 
> 时间：2012-11-17T00:45:44.517
> 
> 标签：objective-c, ios, xcode, nsarray

我正在尝试按分配给数组中每个条目的最高编号对数组进行排序。

但是我不认为它在做任何事情。关于错误可能在哪里的任何建议？

谢谢！

```
 - (NSArray*)sortByPercentage:(NSArray*)array {

    NSArray *inputArray = array;
    NSSortDescriptor *sortDescriptor = [[ NSSortDescriptor alloc] initWithKey:@"percentMatched" ascending:YES];

    //nov 8
    NSArray *sortDescriptors = [NSArray arrayWithObject:sortDescriptor];
    NSArray *finalResult = [inputArray sortedArrayUsingDescriptors:sortDescriptors];
    [sortDescriptor release];
    return [NSArray arrayWithArray:finalResult];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T11:20:58.267

我对为什么你的排序不起作用很感兴趣。这样做：

```
#import <Foundation/Foundation.h>

@interface FooObject : NSObject
@property (nonatomic, assign) NSInteger value;
@property (readonly) NSInteger percentMatched;
@end

@implementation FooObject
@synthesize value;

//  compute percentMatched as an elementary function of value
- (NSInteger)percentMatched {
    return value * 2;
}
@end

int main(int argc, char *argv[]) {
    NSAutoreleasePool *p = [[NSAutoreleasePool alloc] init];

    FooObject *foo1 = [[FooObject alloc] init];
    foo1.value = 50;

    FooObject *foo2 = [[FooObject alloc] init];
    foo2.value = 5;

    FooObject *foo3 = [[FooObject alloc] init];
    foo3.value = 10;

    NSArray *myFoos = [NSArray arrayWithObjects:foo1,foo2,foo3,nil];
    NSArray *sorters = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"percentMatched" ascending:YES]];
    NSArray *mySortedFoos = [myFoos sortedArrayUsingDescriptors:sorters];
    for(FooObject *foo in mySortedFoos ) {
        printf("%ld ",foo.percentMatched);
    }
} 
```

按预期打印`10 20 100`到控制台。

# html - 响应式图像在 Chrome 中工作，但在 Firefox 中不工作

> ID：13426496
> 
> 赞同：2
> 
> 时间：2012-11-17T00:46:41.907
> 
> 标签：html, css, responsive-design

我正在开发一个使用响应式图像和几个固定侧边栏的网站（第一次尝试响应式设计）。问题：响应式图像在 Chrome 中按预期工作，但在 Firefox 中根本不工作。以下是相关页面的示例：

[http://ellenflaherty.com/projects/carland/](http://ellenflaherty.com/projects/carland/)

知道为什么会出现差异吗？

注意：当浏览器超过 1000 像素时，响应式图像不起作用。当针对平板电脑/手机大小的屏幕进行调整时，它们实际上正在按预期工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T04:44:06.940

我已经看过了，就 Firefox 而言，我建议您删除 display: inline-block 和 float: left; 当您的浏览器窗口到达时重新调整为更大的屏幕尺寸，例如您在问题中提到的 1000px，然后对于较小的屏幕尺寸，您可以重新引入显示和浮动以确保页面显示正常。

我在代码下方附加了一张图片，说明在大屏幕上移除显示和浮动后的外观。

```
.projectimg {
    bottom: 0;
    /* display: inline-block;  REMOVE THIS */
    /* float: left; /* REMOVE THIS */
    height: auto;
    margin-left: 220px;
    margin-right: 30px;
    overflow: hidden;
    width: 80%; /* THIS */
} 
```

![在大屏幕上删除浮动和显示后页面的 Firefox 屏幕。](../Images/d2b6f2edfa3025cc84954771d6b073ff.png)

希望有帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-28T05:28:21.380

在 HTML 的标头中添加`<meta name="viewport" content="width=device-width, initial-scale=1.0">`。这将有助于根据屏幕大小调整页面大小。

# jquery - jQuery .eq() 仅适用于表中的第一个元素

> ID：13426498
> 
> 赞同：0
> 
> 时间：2012-11-17T00:46:51.770
> 
> 标签：jquery

这仅适用于 200 行表的第一行中的第 4 个元素。

```
$('.CSSTableGenerator tr td').eq(4) 
```

**如何让它为表格行中的每 4 个“td”工作？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:52:11.430

像这样试试

```
$('.CSSTableGenerator tr td:nth-child(4n)') 
```

jQuery [**:nth-child() 选择器**](http://api.jquery.com/nth-child-selector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:53:00.577

如果他们都是同一个父母的孩子，你可以使用`nth-child`选择器来过滤它[http://jsfiddle.net/T36Y8/](http://jsfiddle.net/T36Y8/)这似乎是你的情况，因为你确实希望从每个 TR 开始第四个。

```
$('.CSSTableGenerator tr td').filter(":nth-child(4n)"); 
```

如果他们不是同一个父母的所有孩子，你可以通过一个过滤函数[http://jsfiddle.net/T36Y8/1/](http://jsfiddle.net/T36Y8/1/)

```
$('.CSSTableGenerator tr td').filter(function(index){
    return index % 4 === 0;
}) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T15:15:08.940

在您的代码中，jQuery 过滤所有`td`匹配过滤器规则，然后采用第 4 个。

尝试这个：

```
$('td:eq(4)', '.CSSTableGenerator tr') 
```

现在 jQuery 将过滤器应用于每个上下文，在这种情况下，所有上下文都`tr`在一个`.CSSTableGenerator`表中。

来源：[http ://api.jquery.com/jQuery/#jQuery-selector-context](http://api.jquery.com/jQuery/#jQuery-selector-context)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T05:40:21.913

$('.CSSTableGenerator tr').each(function(){$(this).find('td').each(function(ind){if(ind==3){ //在这里做你的事情}} )})

# c# - 将自定义 DynamicObject 与引用类型进行比较

> ID：13426501
> 
> 赞同：0
> 
> 时间：2012-11-17T00:47:15.693
> 
> 标签：c#, dynamic

使用`DynamicObject`它可以创建自定义类并在将实例与其他对象进行比较时定义其行为。它是通过覆盖来完成的`TryBinaryOperation`。

但是，当我尝试将它与`null`任何参考值进行比较时，永远不会调用被覆盖的方法。

```
public class Foo : DynamicObject
{
    public override bool TryBinaryOperation(BinaryOperationBinder binder, object arg, out object result)
    {
        if (binder.Operation == ExpressionType.Equal)
        {
            result = true;
            return true;
        }

        return base.TryBinaryOperation(binder, arg, out result);
    }
}

static void Main(string[] args)
{
    dynamic foo = new Foo();

    Console.WriteLine(foo == 1); // True
    Console.WriteLine(foo == new object()); // False
    Console.WriteLine(foo == null); // False
} 
```

有没有办法拦截这个电话？我认为`DynamicObject`这不是正确的抽象。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T00:51:55.670

是的，您可以通过运算符重载。事实上，我使用这个技巧在我的 DynamicLinq 项目中实现了一个动态表达式构建器。在此处查看示例：

[https://github.com/davidfowl/DynamicLinq/blob/master/DynamicLINQ/DynamicExpressionBuilder.cs#L88](https://github.com/davidfowl/DynamicLinq/blob/master/DynamicLINQ/DynamicExpressionBuilder.cs#L88)

# java - 哈希表 NullPointerException

> ID：13426508
> 
> 赞同：-1
> 
> 时间：2012-11-17T00:48:24.250
> 
> 标签：java, nullpointerexception, hashtable

我的任务是设计一个简单的垃圾邮件过滤器，使用哈希表来存储一组“坏词”。我们在课堂上讨论了哈希表是什么以及如何使用它（即如何插入元素、线性探测、二次探测、链式探测等），但我们从未真正讨论过如何使用 Java API Hashtable，这是必需的对于这个任务。无论如何，我已经尽力实现它，但是，我遇到了一个我似乎无法用我的调试器跟踪的异常。

我已经放弃了在这里插入代码，我总是要花时间正确格式化它，它仍然看起来不太好。所以我把它放在 Pastebin 上。它也应该使您的生活更轻松，因为它还可以进行语法突出显示和行计数。

[SpamFilter 类](http://pastebin.com/RK4TNNbQ)
[SpamFilterDriver 类](http://pastebin.com/FAnDwKde)

我在 SpamFilterDriver 类的以下行中得到 NullPointerExceptions：
第 78
行 第 96
行 第 115 行

任何帮助，将不胜感激。我敢肯定这可能很愚蠢，但我现在还没有看到。

另外，请注意，代码至少还没有完成。SpamFilter 实现 Serializeable 的事实将在稍后使用。另外，还有一些空的方法，再说一遍，后面会实现，我只需要先解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:51:15.873

你必须 `SpamFilter filter;`在你的`SpamFilter`类中初始化你的。在调用它的任何方法之前。

在第 78 行，您正在调用一个方法`isBadWord()`。

`filter`在调用其任何方法之前尝试如下初始化。如果您不初始化过滤器，则默认值为 null 并且当您调用具有 null 的方法时会出现繁荣**BOOM BOOM NPE**被抛出

```
 private static SpamFilter filter = new SpamFilter();// 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:51:30.787

在每一行中，观察您正在调用`filter`. Java 正在抛出得到 a`NullPointerException`因为`filter`的值是`null`.

为什么它的价值`null`？因为你从来没有给它赋值；你只是宣布了它。您可以在声明它时正确设置它的值，或者由于它是一个静态字段，您可以使用静态构造函数为其分配一个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T00:51:37.160

**你`filter`没有被初始化，因此无论在哪里使用都会失败。**它仅在顶部声明为`private static SpamFilter filter;`，这使得过滤器为空。

要解决此问题，请将`filter`at 声明初始化为

```
 private static SpamFilter filter = new SpamFilter(); 
```

或在循环`main()`之前的方法中`while`

```
 filter = new SpamFilter(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T00:52:47.337

看起来您从未初始化该`filter`属性，因此每当您尝试使用它时都会收到 NullPointerException。

尝试将第 6 行替换为：

```
private static SpamFilter filter = new SpamFilter(); 
```

# python - 如何从 argparser 中排除一个参数

> ID：13426514
> 
> 赞同：3
> 
> 时间：2012-11-17T00:49:15.023
> 
> 标签：python, argparse

我可以为python中的一个选项定义一个参数以外的所有参数吗？

我想关闭实验室中除一台主机之外的所有主机。因为`argparser`我已经给出`-h ^server1` 了应该从主机列表中选择所有主机，除了`server1`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:54:56.730

一些简单的东西。从列表中删除所有以 开头的主机`^`。为修改后的列表中的每个主机名调用某种关闭函数。

```
hostlist = [x for x in hostlist if not x.startswith('^')]
map(shutdownhost, hostlist) 
```

# c - C、变量 f1 周围的堆栈已损坏

> ID：13426516
> 
> 赞同：1
> 
> 时间：2012-11-17T00:49:24.407
> 
> 标签：c, arrays, pointers, stack

你好我有这个功能

```
int printofarray(int *j,double *n)
{
int x,k;
k=*j;
if(n==NULL) {
printf("array was not created\n");
return 1;}

for(x=0;x<k;x++){
printf("%.2lf\n",*(n+x));}

return 0;
} 
```

当我使用它时，输出是这样的

```
34.77
6114.05
410.70 
```

但我想这样写

```
 34.77
6114.05
 410.70 
```

想法如何？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T00:53:48.077

副手，为 f1 尝试 %f 而不是 %lf。编辑： %lf 是双倍的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T00:55:58.530

`%lf`指定读取 a `double`，但您尝试将结果存储在`float`大小为一半的 a 中。浮点数的说明符只是`%f`- 或使用`double`; 浮点数在现代通用计算机上相当无用。

# error-handling - 歧义 JAVA 接口

> ID：13426518
> 
> 赞同：1
> 
> 时间：2012-11-17T00:50:16.507
> 
> 标签：error-handling

您如何定义类/接口 Adult、Student 和 Engineer，以便下一个序列仅在指定的地方给出编译错误？

```
class Test {
public static void main(String args[]) {
Adult a = new Student(); //without giving compilation error
Adult b = new Engineer();//without giving compilation error
a.explorare(); //without giving compilation error
b.explorare(); //without giving compilation error
a.afisare(); //without giving compilation error
b.afisare(); //compilation error 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T00:53:50.917

这是不可能的，如果`a.afisare()`编译那么应该`b.afisare()`。

# php - Twitter OAuth 获取 404 错误

> ID：13426520
> 
> 赞同：0
> 
> 时间：2012-11-17T00:50:21.907
> 
> 标签：php, twitter, twitter-oauth

我正在 PHP 框架中使用 Twitter OAuth，并且在通过 Twitter OAuth 过程时遇到问题。一切似乎都顺利进行，并且令牌一直匹配到获取用户信息的最后一步。

代码如下：

```
...
$oauth->setToken($oauth_token, $session->twitter_secret);
$access_token_info = $oauth->getAccessToken(conf::get('TWITTER_OAUTH_ACCESS_URL'));

$session->twitter_state = 2;
$session->twitter_token = $access_token_info['oauth_token'];
$session->twitter_secret = $access_token_info['oauth_token_secret'];
$session->twitter_id = $access_token_info['user_id'];

$oauth->setToken($session->twitter_token, $session->twitter_secret);

if ($oauth->fetch(conf::get('TWITTER_API_URL').'/account/verify_credentials.json'))
{
    ...
} 
```

这是异常错误输出：

```
500 exception 'OAuthException' with message 'Invalid auth/bad request (got a 404, expected HTTP/1.1 20X or a redirect)' in /var/www/webapp/app/controllers/default/auth.controller.php:135
Stack trace:
#0 /var/www/webapp/app/controllers/default/auth.controller.php(135): OAuth->fetch('https://api.twi...') 
```

现在我不知道为什么会抛出 404 错误。在通过所有身份验证步骤之后发生错误也没有任何意义。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:18:53.290

看起来解决方案在这里描述： [Getting error with oauth](https://stackoverflow.com/questions/12844166/getting-error-with-oauth)

似乎 Twitter API 现在需要有一个版本号。

# java - 添加到 GWT RootPanel 还是仅设置默认视图？

> ID：13426523
> 
> 赞同：0
> 
> 时间：2012-11-17T00:50:38.600
> 
> 标签：java, gwt, widget, gwt-places, gwt-activities

我有以下 GWT 类：

```
public class MyDefaultView extends Composite {
    // Uses UiBinder and just contains all the widgets for this view.
}

public class MyDefaultActivity extends AbstractActivity {
    @Inject
    private MyDefaultView myDefView;

    @Override
    public void start(AcceptsOneWidget panel, EventBus eventBus) {
        panel.setWidget(myDefView);
    }
}

public class MyActivityMapper implements ActivityMapper {
    @Override
    public Activity getActivity(Place place) {
        if(place instanceof MyDefaultPlace)
            return new MyDefaultActivity();
        else
            return null;
    }
}

public class MyAppModule implements EntryPoint {
    @Override
    public void onModuleLoad() {
        // Lots of initialization and wiring...

        // Why do I need this?!?
        MyDefaultView myDefaultView = GWT.create(MyDefaultView.class);
        RootPanel.add(myDefaultView);

        Place myDefaultPlace = GWT.create(MyDefaultPlace.class);

        PlaceHistoryHandler historyHandler = getHistoryHandler();
        historyHandler.register(myPlaceController, myEventBus, myDefaultPlace);
        historyHandler.handleCurrentHistory();
    }
} 
```

1.  如果我只是要在模块加载时调用并显示，为什么我需要添加`MyDefaultView`到？`RootPanel``PlaceHistoryHandler#handleCurrentHistory()``MyDefaultView`
2.  如果我不应该`MyDefaultView`直接添加到`RootPanel`，那么我应该添加什么？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T11:24:27.623

1）您不需要添加`MyDefaultView`，但您需要`AcceptsOneWidget`在活动管理器上实现并设置该面板的面板。这将负责让您的视图可见。

2) 在大多数应用程序中，您拥有始终可见的应用程序的一部分。例如，顶部的条形显示用户名等。这种面板需要添加到根面板。在您的视图应该可见的位置的那个面板中，`AcceptsOneWidget`应该使用实现的小部件/面板。此小部件应设置为显示在您的活动管理器中，通过`setDisplay`. 该小部件将传递给`start`您活动中的方法。下面是与 ActivityManager 和 RootPanel 一起使用的代码的样子：

```
final ActivityManager activityManager = new ActivityManager(myActivityMapper, eventBus);

activityManager.setDisplay(rootView.getViewPanel());
Rootpanel.add(rootView); 
```

# java - java 游戏 - 光滑的滚动条 - 玩家无法移动

> ID：13426525
> 
> 赞同：2
> 
> 时间：2012-11-17T00:51:09.773
> 
> 标签：java, animation, lwjgl, slick2d, scroller

我的滚动条正在工作，但我**无法移动 player**。

播放器居中于窗口屏幕的中间。地图以玩家的位置为中心。

窗口（程序）大小为 640 x 640 像素

地图*map.tmx*是*正交*的（塞尔达/口袋妖怪风格的游戏）。

仅使用 UP、DOWN、RIGHT、LEFT 键（无对角线移动）。

我在计算或做坏事？

```
public class Play extends BasicGameState {

    Animation movingUp, movingDown, movingLeft, movingRight;
    Animation player;
    String playerName = "Test";
    boolean quit = false;
    int[] duration = {200, 200, 200};
    int playerX = 0;
    int playerY = 0;
    int cameraX;
    int cameraY;
    int screenWidth;
    int screenHeight;
    private TiledMap map = null;
    private static final float SPEED = 0.1f;

    public Play(int state, float x, float y) {
        playerX = (int) x;
        playerY = (int) y;
    }

    @Override
    public void init(GameContainer gc, StateBasedGame sbg) throws SlickException {

        map = new TiledMap("map/map.tmx");

        Image[] walkUp = {
            new Image("graphics/player/up0.png"),
            new Image("graphics/player/up1.png"),
            new Image("graphics/player/up2.png")
        };

        Image[] walkDown = {
            new Image("graphics/player/down0.png"),
            new Image("graphics/player/down1.png"),
            new Image("graphics/player/down2.png")
        };
        Image[] walkLeft = {
            new Image("graphics/player/left0.png"),
            new Image("graphics/player/left1.png"),
            new Image("graphics/player/left2.png")
        };
        Image[] walkRight = {
            new Image("graphics/player/right0.png"),
            new Image("graphics/player/right1.png"),
            new Image("graphics/player/right2.png")
        };

        movingUp = new Animation(walkUp, duration, false);
        movingDown = new Animation(walkDown, duration, false);
        movingLeft = new Animation(walkLeft, duration, false);
        movingRight = new Animation(walkRight, duration, false);

        player = movingDown;

    }

    @Override
    public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException {

        screenWidth = gc.getWidth();
        screenHeight = gc.getHeight();

        cameraX = (screenWidth / 2) - (playerX / 2);
        cameraY = (screenHeight / 2) - (playerY / 2);

        map.render(playerX, playerY);

        player.draw(cameraX, cameraY);

        g.drawString("X: " + playerX + "\nY: " + playerY, 520, 20);
        g.resetTransform();

    }

    @Override
    public void update(GameContainer gc, StateBasedGame sbg, int delta) throws SlickException {
        Input input = gc.getInput();

        if (input.isKeyDown(Input.KEY_UP)) {
            player = movingUp;
            player.update(delta);
            playerY += delta * SPEED;
        } else if (input.isKeyDown(Input.KEY_DOWN)) {
            player = movingDown;
            player.update(delta);
            playerY -= delta * SPEED;
        } else if (input.isKeyDown(Input.KEY_LEFT)) {
            player = movingLeft;
            player.update(delta);
            playerX += delta * SPEED;
        } else if (input.isKeyDown(Input.KEY_RIGHT)) {
            player = movingRight;
            player.update(delta);
            playerX -= delta * SPEED;
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:03:46.960

基本思路：

```
screenWidth = gc.getWidth();
screenHeight = gc.getHeight();

cameraX = (screenWidth / 2) - (playerX / 2);
cameraY = (screenHeight / 2) - (playerY / 2);

map.render(playerX, playerY);
player.draw(cameraX, cameraY); 
```

在我的例子中工作

# ruby-on-rails - 为 HTTP 摘要式身份验证编写测试/方法

> ID：13426529
> 
> 赞同：2
> 
> 时间：2012-11-17T00:51:15.983
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, digest-authentication

我将如何编写一种用于 rspec 测试的方法来访问需要用户名和密码以进行 HTTP Digest 身份验证的页面。比如这个测试...

```
it "edit" do
  http_login
  post :edit, id: @post
  assigns[:post].should eq(@post)
end 
```

需要`http_login`方法是这样的......

```
def http_login

 user = {"username" => 
 Digest::MD5.hexdigest(["username","Application","password"].join(":"))} 

 request.env['HTTP_AUTHORIZATION'] = 
 ActionController::HttpAuthentication::Digest.encode_credentials(?,?,?,?)
end 
```

我的问题是我在编码凭据的四个参数中添加了什么。论点将是，`http_method, credentials, password, password_is_ha1`但我不确定如何在测试中编写`http_method`和`credentials`实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T04:01:40.647

解决方案：[https ://gist.github.com/1282275](https://gist.github.com/1282275)

在这里复制以供后代使用

```
# Adds support for http digest authentication in Rails 3  
# Inspired by: http://lightyearsoftware.com/2009/04/testing-http-digest-authentication-in-rails/
# Place this code in test/test_helper.rb
# In your test, call authenticate_with_http_digest prior to calling get, post, put or delete  
# Tested with Rails 3.0.7

class ActionController::TestCase
  require 'digest/md5'

  def authenticate_with_http_digest(user = API_USERNAME, password = API_PASSWORD, realm = API_REALM)
    ActionController::Base.class_eval { include ActionController::Testing }

    @controller.instance_eval %Q(
      alias real_process_with_new_base_test process_with_new_base_test

      def process_with_new_base_test(request, response)
        credentials = {
      :uri => request.url,
      :realm => "#{realm}",
      :username => "#{user}",
      :nonce => ActionController::HttpAuthentication::Digest.nonce(request.env['action_dispatch.secret_token']),
      :opaque => ActionController::HttpAuthentication::Digest.opaque(request.env['action_dispatch.secret_token'])
        }
        request.env['HTTP_AUTHORIZATION'] = ActionController::HttpAuthentication::Digest.encode_credentials(request.request_method, credentials, "#{password}", false)

        real_process_with_new_base_test(request, response)
      end
    )
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-29T11:57:41.500

这是 RSpec 3.1 和 Rails 4 HTTP Digest Auth 测试的解决方案：[https ://gist.github.com/murbanski/6b971a3edc91b562acaf](https://gist.github.com/murbanski/6b971a3edc91b562acaf)

# entity-framework - 使用继承的集合导航属性（每个类型的表）

> ID：13426530
> 
> 赞同：1
> 
> 时间：2012-11-17T00:51:18.167
> 
> 标签：entity-framework, ef-code-first, poco, navigation-properties

使用实体框架：代码首先，我正在尝试使用基类的导航属性来定义集合导航属性。

对象结构：

```
public class Content
{
    public int ID { get; set; }
    public ModerationStatuses ModerationStatus { get; set; }
    public ContentItemTypes ContentType { get; set; }
    public virtual User Author { get; set; }
}

public class Image : Content
{
    public Image()
        : base()
    {
        ContentType = ContentItemTypes.Image;
    }
    public string FileName { get; set; }
    public string Location { get; set; }
    public int DisplayOrder { get; set; }
    public long FileSize { get; set; }
}

public class User
{
    public int UserID { get; set; }
    public string Username { get; set; }

    public virtual ICollection<Image> Images { get; set; }
} 
```

上下文 OnModelCreating：

```
modelBuilder.Entity<Content>()
    .Map(i => i.ToTable("Content"));

modelBuilder.Entity<Image>()
    .Map(i => i.ToTable("Images")); 
```

生成数据库时，它会在 Images 表中创建一个 User_UserID 外键约束，而不是在 Content 表中使用 Author_UserID。

如何让它识别 Content..Author_UserID 字段作为`ICollection<Image>`导航属性的外键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:47:57.660

这是不可能的。您要么需要将`Author`属性从`Content`移到`Image`类中**，要么**将集合设为`User`类型`ICollection<Content> Contents`。导航属性必须始终在反向导航属性所引用的实体类中**声明**。它不能从基础实体继承。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T02:12:33.540

实际上它是可能的......您只需向您的 Content 类添加一个导航属性，以便您可以参考映射到。

这是彻底的[演练](http://weblogs.asp.net/manavi/archive/2010/12/28/inheritance-mapping-strategies-with-entity-framework-code-first-ctp5-part-2-table-per-type-tpt.aspx)。

# java - 正则表达式模式匹配字符串中的正数和负数

> ID：13426533
> 
> 赞同：5
> 
> 时间：2012-11-17T00:51:32.107
> 
> 标签：java, regex, pattern-matching, negative-number

我有像这样转换输入字符串的模式/匹配器行：

```
1 3 Hi [2 1 4] 
```

变成这样的数组：

```
[0] => "1"
[1] => "3"
[2] => "Hi"
[3] => "2 1 4" 
```

那是代码：

```
String input = sc.nextLine();

Pattern p = Pattern.compile("(?<=\\[)[^\\]]+|\\w+");
Matcher m = p.matcher(input);
List<String> cIn = new ArrayList<String>();
while(m.find()) cIn.add(m.group()); 
```

现在我意识到有时我会得到一些负值，比如`4 2 -1 2`. 由于输入是一个字符串，我不能真正使用任何正则表达式来获得那个负值。

在代码下面，我使用

```
Integer.parseInt(cIn.get(0)); 
```

将该字符串值转换为整数，这实际上是我需要的。

你能想出一种方法让我把`-`字符和数字字符放在一起吗？然后我会检查是否有`-`字符来转换数字并将其乘以`-1`. （如果有更好的方法，我会很高兴听到）。

像往常一样，对不起我的英语。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:05:36.040

您绝对可以使用正则表达式来捕获负数，但这取决于您要清除的内容。

```
"(?<=\\[)[^\\]]+|[-\\w]+" 
```

最简单的方法是简单地将“-”添加到已识别的单词字符组中。然而，这也将导致像“9-9”这样的奇怪阵型是合法的。考虑到您已经匹配“9_9”之类的标记，我不确定这对您来说是个问题。我可能只是在这个正则表达式的末尾添加另一个交替：

```
"(?<=\\[)[^\\]]+|\\w+|-?\\d+" 
```

它允许可选的“-”字符后跟至少一位数字。或者，一个负数。这是相当健壮的——你实际上只是定义了一种额外的匹配类型（一个非常具体的匹配），但是每次你发现一个新的案例时，你真的不应该只是继续在末尾添加 '|...'你的正则表达式。这是做你正在做的事情的效率最低的方法。在您的情况下，这似乎不是一个真正的问题，但是随着您的用例扩展，您应该考虑这一点。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T01:08:35.110

方法如下：`(?<=\\[)[^\\]]+|-?\\w+`。

正`-?`则表达式意味着您可以`-`在单词 ( `\\w+`) 之前有或没有，但如果您只需要数字，则使用`\\d+`and `\\w+`。

这是我写的测试：

```
@Test
public void regex() {

    String input = "-1 3 Hi [2 1 4]";

    Pattern p = Pattern.compile("(?<=\\[)[^\\]]+|-?\\w+");
    Matcher m = p.matcher(input);
    List<String> cIn = new ArrayList<String>();
    while (m.find())
        cIn.add(m.group());

    System.out.println(cIn);

} 
```

它`[-1, 3, Hi, 2 1 4]`会如您所愿。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T01:05:47.737

你可以在你的正则表达式中使用一个可选`-`的：

```
Pattern p = Pattern.compile("(?<=\\[)[^\\]]+|-?\\w+"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T01:18:31.223

非常花哨的正则表达式，但是用更少的技巧来捕捉你想要做的事情呢？

```
(?:\[(?:\s*[-]?\d+\s*)*\]|(?:[-]?\d+|\w+)) 
```

# javascript - 在 Raphael 中用线连接对象

> ID：13426536
> 
> 赞同：0
> 
> 时间：2012-11-17T00:51:55.347
> 
> 标签：javascript, raphael

我有一个 json 对象列表。

```
var Planets = [
            {name:"maths", percComp: "2", preReq: "english"},
            {name:"english", percComp: "20", preReq: "geog"},
            {name:"geog", percComp: "57", preReq: "maths"}          
        ]; 
```

这些物体是我将添加到宇宙中的行星。它们是学校科目

我也有行星课

```
function Planet(planet, index)
    {
        this.name = planet.name;
        this.percComp = planet.percComp;
        this.preReq = planet.preReq;
        CreatePlanet(this, index);
        this.line = paper.path('');

        function RedrawLine(planetFrom, planetTo, strokeWidth)
        {
            line.attr({
                path:"M" + planetFrom.attrs.cx + "," + planetFrom.attrs.cy + "L"+ planetTo.attrs.cx + "," + planetTo.attrs.cy,
                "stroke-width": strokeWidth
            }); 
        }

        function CreatePlanet(planet)
        {
            var planetName = planet.name;
            planetName = paper.circle(200 * index, 100, 80/index);
            planetName.attr({ 
                fill:'red',
                stroke: '#3b4449',
                'stroke-width': 6               
            });

            SetGlow(30, true, 0, 0, 'grey', planetName)
            SetHover(planetName);
        }

        function SetHover(planet)
        {
            var radius = planet.attrs.r;
            planet.mouseover(function(){
                this.animate({ r: radius * 1.3}, 150)
            }).mouseout(function(){
                this.animate({ r: radius}, 150)
            })
        }

        function SetGlow(width, fill, offSetx, offsety, color, planet)
        {
            planet.glow({
                width: 30,
                fill: true,
                offsetx: 0,
                offsety: 0,
                color: 'grey'
            });
        }

    } 
```

启动程序的代码是

```
var element = document.getElementById('Main-Content')
var paper = new Raphael(element, 1000, 1000);

    window.onload = function()
    {

        var planetsSet = paper.set();

        var index = 1;
        $(jQuery.parseJSON(JSON.stringify(Planets))).each(function(){
            var planet = new Planet(this, index);
            planetsSet.push(planet);
            index++;
        });

        for (i=0; i<planetsSet.length; i++)
        {
            var planetTo = planetsSet[i];
                            // This is a test to see if RedrawLine works
                            var planeFrom = planetsFrom[i+1];
            planetTo.RedrawLine(planetTo, planeFrom, 30)
            var preReq = this.preReq;          
        }
    } 
```

代码用 3 个行星填充屏幕。我正在尝试用一条线连接这些。该行将连接一个行星及其在 json 对象中声明的先决条件。所以数学有先决条件英语，英语有先决条件geog。我在 Planet 类中有一个函数可以绘制线条，但是在绘制对象后我无法访问它们。

这是拉斐尔的问题还是可以做到？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:49:17.203

您的方法中有几个错误：

*   Paper.set 不是`Array`，`Array`用于此类用途
*   你弄乱了范围，传递`paper`给你的对象构造函数
*   公共方法至少应该被声明为`this.method`不仅仅是`function method()`
*   在对象中保留您星球的公共属性，`this.property`或者至少不要将 this.planet 称为 PlanetName。
*   您忘记在重绘方法中使用 this.line

填补空白的小代码：

```
var planetsSet = []; 
```

[工作样本](http://jsbin.com/adapug/4)

*在家工作：*

`planetFrom`从方法参数中删除`RedrawLine`，以便可以将此方法称为 `PlanetFrom.RedrawLine(planetTo);`

# php - 防止直接 url 访问

> ID：13426540
> 
> 赞同：0
> 
> 时间：2012-11-17T00:52:21.727
> 
> 标签：php

我有一个网站，所有连接（与数据库和其他）都在一个文件夹中。尽管在受限页面上有一个会话以防止未登录的用户，但如果键入完整的 url，则可能会访问这些文件（即使 php 确实显示了任何内容，我认为这不是一件好事）。而且文件夹本身可以看成是服务器上的一个目录，很糟糕。

```
www.mysite.com/connectionfolder 
```

我该如何处理这个问题？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T00:59:48.440

`.htaccess`Apache：在根文件中添加以下行

`Options -Indexes`

如果`Options Indexes`现有`.htaccess`文件中已有一行，则可以简单地修改它`Options -Indexes`

这将使 Apache 阻止直接目录访问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T00:56:43.270

如果您使用 Apache，请将 .htaccess 文件放在您的 Web 根目录中（如果还没有的话）。然后把它放在文件中：

```
Options -Indexes 
```

更多信息：[https ://httpd.apache.org/docs/current/mod/core.html#options](https://httpd.apache.org/docs/current/mod/core.html#options)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-17T00:59:00.457

您还可以将用户重定向到“安全”页面

```
<?php
//...Valid user check
if(!$validuser)
{
    header("Location: /");
    exit;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T00:57:20.177

```
<?php header("Status: 404 Not Found"); ?> 
```

把这个在会话验证后，页面给出 404 页面错误说页面未找到

例如，您可以将其放入

```
if(!$user_loggedin) {
header("Status: 404 Not Found");
} else {

echo "welcome to your page ....";

} 
```

如果用户未登录，上面的代码将生成 PAGE NOT FOUND ERROR。这意味着，任何看到该错误的人都会认为该页面根本不存在

# php - exec() 在 PHP 中运行缓慢 - 相同的命令以交互方式运行得更快

> ID：13426541
> 
> 赞同：5
> 
> 时间：2012-11-17T00:52:22.057
> 
> 标签：php, performance, exec

谁能告诉我为什么`exec()`PHP 中不同机器上的功能如此缓慢且时间不可预测？

基本上我有一些可执行文件并想通过 PHP 执行它：

```
$command = '/usr/pathToComman/myCommand -someParameters';
exec($command); 
```

问题是它执行的时间要长得多（我的意思是 3-4 有时像 25 倍）然后来自 shell 的相同命令。

除此之外，该命令从我的服务器上的 PHP 执行的时间更长，这更强大（更多 RAM 和更多 GHz）。

所以有两个问题：

*   为什么？
*   我该怎么办？

PS我需要这个执行，因为我不能用PHP做同样的事情

PS2 回答@prodigitalson 问题：它解决了微分方程，但基本上不管它做什么，速度都会慢得多。我记得用这种方式做了一些图像处理，速度也慢了很多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T15:33:58.903

速度较慢的问题可能是因为您的 PHP 服务器必须转到 shell 才能运行您的命令。所以 PHP 服务器所做的就是创建一个新的 shell 并在新的 shell 上调用命令。在大多数系统中，创建一个新的 shell 意味着创建一个新线程。所以所有这些事情加在一起会导致更长的执行时间。

有时 cgi 脚本可以帮助解决这些问题，但我不确定它是否会在这里有所帮助（因为我真的不知道你想在 shell 上做什么）

# hadoop - Apache Hadoop 单节点设置中的 start-all.sh 失败

> ID：13426543
> 
> 赞同：3
> 
> 时间：2012-11-17T00:52:32.953
> 
> 标签：hadoop

我在 Ubuntu 12.04 上安装了 Apache Hadoop 1.0.4。我按照[http://hadoop.apache.org/docs/stable/single_node_setup.html](http://hadoop.apache.org/docs/stable/single_node_setup.html)上的说明，到达了“执行”部分。我在 $ bin/start-all.sh 上失败了，错误消息如下。我的用户名是安森。

```
$ start-all.sh
mkdir: cannot create directory `/var/log/hadoop/anson': Permission denied
chown: cannot access `/var/log/hadoop/anson': No such file or directory
mkdir: cannot create directory `/var/run/hadoop': Permission denied
starting namenode, logging to /var/log/hadoop/anson/hadoop-anson-namenode-anson-Ubuntu-T430.out
/usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-anson-namenode.pid: No such file or directory
/usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/anson/hadoop-anson-namenode-anson-Ubuntu-T430.out: No such file or directory
head: cannot open `/var/log/hadoop/anson/hadoop-anson-namenode-anson-Ubuntu-T430.out' for reading: No such file or directory
localhost: mkdir: cannot create directory `/var/log/hadoop/anson': Permission denied
localhost: chown: cannot access `/var/log/hadoop/anson': No such file or directory
localhost: mkdir: cannot create directory `/var/run/hadoop': Permission denied
localhost: starting datanode, logging to /var/log/hadoop/anson/hadoop-anson-datanode-anson-Ubuntu-T430.out
localhost: /usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-anson-datanode.pid: No such file or directory
localhost: /usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/anson/hadoop-anson-datanode-anson-Ubuntu-T430.out: No such file or directory
localhost: head: cannot open `/var/log/hadoop/anson/hadoop-anson-datanode-anson-Ubuntu-T430.out' for reading: No such file or directory
localhost: mkdir: cannot create directory `/var/log/hadoop/anson': Permission denied
localhost: chown: cannot access `/var/log/hadoop/anson': No such file or directory
localhost: mkdir: cannot create directory `/var/run/hadoop': Permission denied
localhost: starting secondarynamenode, logging to /var/log/hadoop/anson/hadoop-anson-secondarynamenode-anson-Ubuntu-T430.out
localhost: /usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-anson-secondarynamenode.pid: No such file or directory
localhost: /usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/anson/hadoop-anson-secondarynamenode-anson-Ubuntu-T430.out: No such file or directory
localhost: head: cannot open `/var/log/hadoop/anson/hadoop-anson-secondarynamenode-anson-Ubuntu-T430.out' for reading: No such file or directory
mkdir: cannot create directory `/var/log/hadoop/anson': Permission denied
chown: cannot access `/var/log/hadoop/anson': No such file or directory
mkdir: cannot create directory `/var/run/hadoop': Permission denied
starting jobtracker, logging to /var/log/hadoop/anson/hadoop-anson-jobtracker-anson-Ubuntu-T430.out
/usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-anson-jobtracker.pid: No such file or directory
/usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/anson/hadoop-anson-jobtracker-anson-Ubuntu-T430.out: No such file or directory
head: cannot open `/var/log/hadoop/anson/hadoop-anson-jobtracker-anson-Ubuntu-T430.out' for reading: No such file or directory
localhost: mkdir: cannot create directory `/var/log/hadoop/anson': Permission denied
localhost: chown: cannot access `/var/log/hadoop/anson': No such file or directory
localhost: mkdir: cannot create directory `/var/run/hadoop': Permission denied
localhost: starting tasktracker, logging to /var/log/hadoop/anson/hadoop-anson-tasktracker-anson-Ubuntu-T430.out
localhost: /usr/sbin/hadoop-daemon.sh: line 136: /var/run/hadoop/hadoop-anson-tasktracker.pid: No such file or directory
localhost: /usr/sbin/hadoop-daemon.sh: line 135: /var/log/hadoop/anson/hadoop-anson-tasktracker-anson-Ubuntu-T430.out: No such file or directory
localhost: head: cannot open `/var/log/hadoop/anson/hadoop-anson-tasktracker-anson-Ubuntu-T430.out' for reading: No such file or directory
anson@anson-Ubuntu-T430:~$ cd /var/run/hadoop
-bash: cd: /var/run/hadoop: No such file or directory 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:08:46.610

听起来您安装了 Hadoop Debian 软件包，并且您正试图以`start-all.sh`非 root 用户身份运行。

这里有一些想法：

1.  尝试按照“独立操作”说明进行操作，该说明应按书面说明工作。
2.  尝试按照编写的“伪分布式操作”部分进行操作，**但有一个例外**：`sudo start-all.sh`而不是`bin/start-all.sh`.
3.  尝试完全卸载 Debian 软件包并改用 Hadoop 发行版 tarball。

如果您使用 tarball 选项，请首先清除 Debian 软件包：

```
sudo apt-get purge hadoop 
```

确保您没有设置任何特定于 Hadoop 的环境变量。这应该什么都不返回：

```
set | grep HADOOP 
```

如果您从该命令获得任何输出，请重新启动或手动`unset`任何包含`HADOOP`.

此时，您应该能够分解 tarball 并按照所写的“伪分布式操作”指南（并且作为非 root 用户）进行操作。

有两个压缩包。`hadoop-1.0.4.tar.gz`包括源和文档，`hadoop-1.0.4-bin.tar.gz`不包括。要么工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:15:13.277

将目录的所有者和权限更改为 755

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T05:29:13.710

您用于启动 hadoop 的用户对`/var/log`. 检查用户对`/var/log/`.

`hadoop.tmp.dir`另一种方式，您可以跨配置更改 hadoop 基础目录 。

# sql - 如何获取 SQL 调用的堆栈跟踪？

> ID：13426555
> 
> 赞同：2
> 
> 时间：2012-11-17T00:54:22.543
> 
> 标签：sql, sql-server

我们有一个巨大的数据库，其中存储过程 A 调用存储过程 B，存储过程 B 调用 C 调用函数 D，等等……多年来，它已成为一片丛林。

是否可以获得调用来自何处的堆栈跟踪？无需传递参数或临时表等 - 只需使用 SQL 语言。

# javascript - jquery insertafter 多维数组

> ID：13426556
> 
> 赞同：0
> 
> 时间：2012-11-17T00:54:30.890
> 
> 标签：javascript, jquery, insertafter

我有一个文本表单字段。它可以被克隆/复制。它生成名称标签，如`user[name][1][1],user[name][2][1],user[name][3][1] etc`...

我想使用 jquery 在该文本字段旁边附加一个链接。我试过这样..

```
<script type="text/javascript">
$(function(){
    $('<a href="#">Example link</a>').insertAfter('input[name="user\[name\]\[\]\[\]"]')
});
</script> 
```

但它不起作用。谁能帮我？。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:07:02.630

根据 jQuery 选择器文档，特殊字符需要使用双反斜杠进行转义。对于所有元素，您可以使用`startsWith`选择器并执行以下操作：

```
$('input[name^="user\\[name\\]"]'); 
```

演示：http: [//jsfiddle.net/dpJZE/2/](http://jsfiddle.net/dpJZE/2/)

API 选择器文档： [http ://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

阅读有关转义的顶部段落

# linux - 如何使用 ptrace(2) 改变系统调用的行为？

> ID：13426561
> 
> 赞同：3
> 
> 时间：2012-11-17T00:55:22.213
> 
> 标签：linux, code-injection, system-calls, ptrace

是否有任何指南或示例（尤其是 ARM 的）或`ptrace`用于影响其他进程执行的库？例如，让它相信一些数据出现在文件描述符上（即释放选择/轮询并在内核之前“回答”以下读取系统调用）。期待涉及 PTRACE_SYSEMU 的事情。

它可以以便携式方式完成吗？我想要类似 libc-overriding LD_PRELOAD 技巧的东西，但可以在运行时附加。

可以用一些 gdb 命令来完成吗？

理想的变体是，如果有一些库，我可以轻松且可移植地挂接到系统调用并在实际调用（或模拟它们）之前或之后对其进行编辑，例如[使用 LD_PRELOAD 进行操作时](http://www.bottomupcs.com/libraries_and_the_linker.html#AEN4508)。

@link[关于使用 PTRACE_SYSEMU 有什么好的指南吗？](https://stackoverflow.com/questions/5395769/any-good-guides-on-using-ptrace-sysemu)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:15:55.567

您可以使用 PTRACE_SYSCALL 请求：它重新启动子进程（就像 PTRACE_CONT 一样）但安排它在下一次进入或退出系统调用时停止。例如（假设为 x86 构建的内核）：

```
#include <sys/ptrace.h>
#include <signal.h>
#include <linux/user.h>
#include <sys/types.h>
#include <sys/wait.h>

int main(int argc, char **argv)
{
    int status = 0, pid, r;
    struct user_regs_struct uregs;

    if ((pid = fork()) == 0) {
        printf("pid = %d, ppid = %d\n", getpid(), getppid());
        ptrace(PTRACE_TRACEME, 0, 0, 0);
        kill(getpid(), SIGINT);
        r = getpid();
        printf("%d\n", r);
    } else {
        wait(&status);
        ptrace(PTRACE_SYSCALL, pid, 0, 0);
        wait(&status);
        ptrace(PTRACE_GETREGS, pid, 0, &uregs);

        /* this prints the syscall number of getpid */
        printf("syscall nr: %d\n", uregs.orig_eax);
        /* 64 is syscall number of getppid */
        uregs.orig_eax = 64;
        ptrace(PTRACE_SETREGS, pid, 0, &uregs);
        ptrace(PTRACE_CONT, pid, 0, 0);
        wait(&status);
        if(WIFEXITED(status))
            printf("we're done\n");
    }
} 
```

孩子打印它的 PID 并向自己传递一个信号。由于之前调用`ptrace()`this 意味着它将被停止。

父级等待这发生并使用 PTRACE_SYSCALL 重新启动子级，然后等待。接下来，子进程调用`getpid`系统调用并再次停止。父进程使用 PTRACE_GETREGS 调用来查看子进程的寄存器，其中`eax`保存系统调用号。父级将此更改为 的系统调用号`getppid`，然后再次允许子级继续。因为系统调用号在调用系统调用之前已更改，所以子进程现在将调用`getppid`而不是`getpid`.

用于`ptrace`此目的可能是可移植的，但我尚未对其进行测试。在 gdb 中，也可以使用`catch syscall`命令。

# c - 为什么 math.h 定义 pi、pi/2、2/pi 而不是 2*pi？

> ID：13426562
> 
> 赞同：26
> 
> 时间：2012-11-17T00:55:23.003
> 
> 标签：c, math.h

这是一个非常简单的问题：为什么pi、pi/2、pi/4、1/pi 和 2/pi有[预定义的常量，而 2*pi 没有？](http://www.gnu.org/software/libc/manual/html_node/Mathematical-Constants.html)背后有更深层次的原因吗？

这个问题与整个[pi vs tau 辩论](http://tauday.com)无关。我想知道是否有实现某些常量而不是其他常量的技术原因。我能想到两种可能：

1.  避免舍入错误。
2.  避免可能更昂贵的运行时划分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T01:19:10.280

2*M_PI 这么难写吗？

说真的，曾几何时，当人们担心可能不会进行常量折叠和除法的简单编译器过于昂贵时，拥有一个常量 PI/2 而不是冒着运行时除法的风险实际上是有意义的。在我们的现代世界中，人们可能只定义 M_PI 并收工，但其他变体仍然存在以实现向后兼容性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-17T05:13:33.857

这只是我的猜测。

我想这些常量与数学库中不同函数的实现有关：

```
ck@c:~/Codes/ref/glibc/math$ grep PI *.c
s_cacos.c:  __real__ res = (double) M_PI_2 - __real__ y;
s_cacosf.c:  __real__ res = (float) M_PI_2 - __real__ y;
s_cacosh.c:                    ? M_PI - M_PI_4 : M_PI_4)
...
s_clogf.c:      __imag__ result = signbit (__real__ x) ? M_PI : 0.0;
s_clogl.c:      __imag__ result = signbit (__real__ x) ? M_PIl : 0.0;
ck@c:~/Codes/ref/glibc/math$ 
```

`M_PI`, `M_PI_2`, 并且`M_PI_4`经常出现，但没有`2.0 * M_PI`。所以对于 Hanno 最初的问题，我认为 MvanGeest 是对的 --- 2π 并没有那么有用，至少在实现`libm`.

现在关于`M_PI_2`和`M_PI_4`，它们的存在是有充分理由的。GNU C 库的[文档](http://www.gnu.org/software/libc/manual/html_node/Mathematical-Constants.html)表明“这些常量来自 Unix98 标准并且在 4.4BSD 中也可用”。那个时候编译器还没有那么聪明。键入`M_PI/4`而不是`M_PI_4`可能会导致不必要的除法。尽管现代编译器可以对此进行优化（gcc 从 2008 年开始使用 mpfr，因此即使舍入也可以正确完成），但使用数字常量仍然是编写高性能代码的更可移植的方式。

# emacs - 如何通过函数强制重新扫描imenu？

> ID：13426564
> 
> 赞同：3
> 
> 时间：2012-11-17T00:55:45.280
> 
> 标签：emacs, elisp

显然，我可以输入`M-x imenu <RET> * <RET>`; 但是是否有任何单一功能会强制重新扫描？因为我需要这个`which-func-mode`，所以“自动重新扫描”功能对我没有用；我宁愿不必调用`imenu`然后立即退出，而只需调用一个函数（*一个函数来扫描它们？；）*）。浏览`imenu.el`一下也没有用...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-15T19:21:54.553

这将在按下后强制更新（就像您单击`*Rescan*`菜单中的项目一样）`C-c i`：

```
(global-set-key "\C-ci"
                (lambda () (interactive)
                  (imenu--menubar-select imenu--rescan-item))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T03:02:11.200

确实，没有`imenu-rescan`功能。看看代码的一般工作方式，我认为没有这样的功能是有道理的，但应该有一个`imenu-flush-cache`功能，但它是缺失的。请`M-x report-emacs-bug`请求这样的新功能。同时，您可以`(setq imenu--index-alist nil)`手动刷新缓存。

# objective-c - 触摸时 UISegmentedControl 索引不更新

> ID：13426569
> 
> 赞同：2
> 
> 时间：2012-11-17T00:55:59.227
> 
> 标签：objective-c, ios, xcode, model-view-controller, uisegmentedcontrol

您好，我在更新分段控制器的索引时遇到问题。以下代码来自calcualate 类。

```
 + (NSString *) calculate:(NSString *)height:(NSString *)weight{
  double bmiVal = 0;
   MBBFirstViewController *fVC;
        NSLog(@"%d", [[fVC heightSegment]selectedSegmentIndex]);
        NSLog(@"%d", [[fVC weightSegment]selectedSegmentIndex]);
        if ([[fVC heightSegment]selectedSegmentIndex] == 0 && [[fVC weightSegment]selectedSegmentIndex] == 0) {
             value = 10.5555;
        }else if ([[fVC heightSegment] selectedSegmentIndex] == 0 && [[fVC weightSegment]selectedSegmentIndex] == 1) {
             value = 11.5555; 
        }else if ([[fVC heightSegment]selectedSegmentIndex] == 0 && [[fVC weightSegment]selectedSegmentIndex] == 2) {
             value = 12.5555;
        }else if ([[fVC heightSegment]selectedSegmentIndex] == 1 && [[fVC weightSegment]selectedSegmentIndex] == 0) {
             value = 13.5555;
        }else if ([[fVC heightSegment]selectedSegmentIndex] == 1 && [[fVC weightSegment]selectedSegmentIndex] == 1) {
             value = 14.5555;
        }else if ([[fVC heightSegment] selectedSegmentIndex] == 1 && [[fVC weightSegment]selectedSegmentIndex] == 2) {
             value = 15.55555;
        }else if ([[fVC heightSegment]selectedSegmentIndex] == 2 && [[fVC weightSegment]selectedSegmentIndex] == 0) {
             value = 16.55555;
        }else if ([[fVC heightSegment]selectedSegmentIndex] == 2 && [[fVC weightSegment]selectedSegmentIndex] == 1) {
             value = 17.55555;
        }else if ([[fVC heightSegment]selectedSegmentIndex] == 2 && [[fVC weightSegment]selectedSegmentIndex] == 2) {
             value = 18.5555;
    }
}
 NSString *bmiV = [NSString stringWithFormat:@"%.2f",bmiVal];
return bmiV;
} 
```

此代码来自 viewcontroller.m 类

```
- (IBAction)calculateTotal:(id)sender {
    NSString *h = [heightField text];
    NSString *w = [weightField text];
    yourBmiField.text = [calculate yourCalculation:h:w];
} 
```

这是来自 viewcontroller.h

```
 @interface MBBFirstViewController : UIViewController <UITextFieldDelegate>{
     UITextField *heightField;
     UISegmentedControl *heightSegment;
     UITextField *weightField;
     UISegmentedControl *weightSegment;
 }
 @property (strong, nonatomic) IBOutlet UITextField *heightField;
 @property (strong, nonatomic) IBOutlet UISegmentedControl *heightSegment;
 @property (strong, nonatomic) IBOutlet UITextField *weightField;
 @property (strong, nonatomic) IBOutlet UISegmentedControl *weightSegment;
 - (IBAction)calculateTotal:(id)sender;
@end 
```

我省略了主要计算以缩短它。当我运行这个时，选定的段总是保持在 0。

有人可以看到为什么会这样，如果可能的话，告诉我如何解决。

任何帮助将不胜感激。

感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T02:22:01.167

您没有初始化 FVC viewController 的实例，只是声明它：

改变：

```
MBBFirstViewController *fVC 
```

至：

```
MBBFirstViewController *fVC = [MBBFirstViewContoller alloc] init]; 
```

# c - 如何使 C 程序停止任何用户输入的循环？

> ID：13426575
> 
> 赞同：4
> 
> 时间：2012-11-17T00:56:54.087
> 
> 标签：c, infinite-loop, user-interaction

我想编写一个运行无限循环的小型 C 程序，直到用户按下键盘上的一个键（即：标准输入缓冲区中有一个字符）。我在打破用户输入循环时遇到了麻烦。我尝试过使用`fgetc`，但这并不像预期的那样。下面的代码*等待*用户输入而不是运行*直到*用户输入。

**示例 C 代码：**

```
while((c=fgetc(stdin) == EOF) {
  /* Does stuff for infinite loop here */
  printf("Example work in the loop\n");
}
printf("Out of the loop!\n"); 
```

如何编写一个在用户干预之前执行的循环？按下任何键或特定键都可能是干预触发器。

**注意 1：**我是为 Unix 控制台编写的，以防平台特定的解决方案

**注2：**不建议`Ctrl + C/X/Z`作为用户干预触发

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:15:32.183

这似乎对我有用：

```
#include <fcntl.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/uio.h>
#include <unistd.h>

static void set_non_blocking(int fd)
{
    int flags  = fcntl(fd, F_GETFL, 0 );
    flags |= O_NONBLOCK;
    flags = fcntl(fd, F_SETFL, flags);
}

int main(int argc, char ** argv)
{
    int fd = fileno(stdin);
    char buf[10];

    set_non_blocking(fd);

    while (read(fd, buf, sizeof buf) < 0) {
        perror("read");
        sleep(1);
    }
    return 0;
} 
```

或者你可以使用`select`：

```
int main(int argc, char ** argv)
{
    int fd = fileno(stdin);
    struct timeval tv = {0,0};
    fd_set fdset;
    int s;

    do {
        sleep(1);
        FD_ZERO(&fdset);
        FD_SET(fd, &fdset);

    } while ((s = select(fd+1, &fdset, NULL, NULL, &tv)) == 0);

    if (s < 0) {
        perror("select");
    }
    return 0;
} 
```

民意调查也有效:-)

```
int main(int argc, char ** argv)
{
    struct pollfd pfd;
    int s;

    pfd.fd = fileno(stdin);
    pfd.events = POLLRDNORM;

    while ((s = poll(&pfd, 1, 0)) == 0) {
        perror("polling");
        sleep(1);
    }
    if (s < 0) {
        perror("poll");
    }
    return 0;
} 
```

最后一种方法是将终端设置为“原始”模式。请注意，这会扰乱终端的输出（至少在我的 OS-X 上），因为在 \n 之后 \r 变得必要。另请注意，它需要在结束时撤消（终止`tcsetattr`呼叫）。这是唯一不需要 \n 的（即任何按键都可以）

```
#include <poll.h>
#include <stdio.h>
#include <fcntl.h>
#include <stdlib.h>
#include <unistd.h>
#include <termios.h>

static void set_non_blocking(int fd)
{
    int flags = fcntl(fd, F_GETFL, 0) | O_NONBLOCK;

    if (fcntl(fd, F_SETFL, flags) < 0) {
        perror("fcntl");
        exit(EXIT_FAILURE);
    }
}

int main(int argc, char ** argv)
{
    struct termios params;
    struct termios params_orig;
    char buf[10];
    int fd = fileno(stdin);

    if (tcgetattr(fd, &params) < 0) {
        perror("tcgetattr");
        exit(EXIT_FAILURE);
    }
    params_orig = params;

    cfmakeraw(&params);

    if (tcsetattr(fd, TCSANOW, &params) < 0) {
        perror("tcsetattr");
        exit(EXIT_FAILURE);
    }
    set_non_blocking(fd);

    while (read(fd, buf, sizeof buf) < 0) {
        perror("\rread");
        sleep(1);
    }

    (void) tcsetattr(fd, TCSANOW, &params_orig);
    return 0;
} 
```

# numpy - 稀疏矩阵的最小值？

> ID：13426580
> 
> 赞同：6
> 
> 时间：2012-11-17T00:57:47.567
> 
> 标签：numpy, scipy, sparse-matrix

scipy.sparse 中似乎没有一种方法可以给出稀疏矩阵的最小值。特别是，我寻求列的最小值。

文档中没有出现任何方法，并且 numpy minimum 不适用。如果`X`是稀疏矩阵，`X.min()`也会抛出错误：`*** AttributeError: 'module' object has no attribute 'min'`.

当然，这一定是人们使用的东西。这是怎么做到的？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T01:06:46.007

对于 CSR/CSC 矩阵，使用

```
def min_sparse(X):
    if len(X.data) == 0:
        return 0
    m = X.data.min()
    return m if X.getnnz() == X.size else min(m, 0) 
```

要按行或列执行此操作，您可以`map`在`X.getrow(i) for i in X.shape[0]`或上执行此操作`X.shape[1]`。

但你是对的，这应该是一种方法。

# asp.net - 在 Asp.net 中创建 3D/动态图

> ID：13426581
> 
> 赞同：-2
> 
> 时间：2012-11-17T00:57:49.020
> 
> 标签：asp.net, 3d, autocad

我正在做我的最终项目，我需要根据用户输入创建在线图表。给我的样本如下。如果您填写所有表格并输入高度、长度和屋檐高度等，它将在输入时生成图表。我想知道，我怎样才能创建这个，至少我需要从哪里开始。

示例网站是[https://www.shedsales.com.au/shedspecs.aspx](https://www.shedsales.com.au/shedspecs.aspx)

我正在为此阅读很多文章，例如 autocad 等，但我仍然处于 0 点。我的朋友建议我在堆栈上发布问题，我会得到答案或许多建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T04:11:25.450

不太清楚你到底在问什么，但我会尽力回答。如果您需要简单的几何图形，如盒子、金字塔等。它必须是交互式的，您可以使用以下方法实现它：

SVG：[http](http://code.google.com/p/svg3d/) ://code.google.com/p/svg3d/ - 最慢，可能无法在任何地方使用。

CSS3： http: [//jlong​​ster.com/s/dom3d/](http://jlongster.com/s/dom3d/) - 速度更快，在某些浏览器中 GPU 加速，但在旧浏览器中不起作用。

如果您需要更快的速度或复杂的形状，那么您应该使用 Flash 或 WebGL。但是 3D api 很复杂，目前还不是跨平台或跨浏览器的。在这方面，Flash 是更好的选择，但仅在此时。

所以对你来说[http://www.x3dom.org/](http://www.x3dom.org/)可能是最好的选择。它是3D引擎，不需要编程技能，也不需要3d api知识，它有Flash和WebGL两种模式+非常容易学习。

但是，如果您只需要静态图像，您可以根据用户请求（来自表单的数据）将它们呈现在服务器端，您可以缓存它们。你可以让它们变得像你想要的那样漂亮。同时，它们将最大限度地与任何平台兼容。您可以设置自己的服务器或像[这样使用渲染农场](http://www.rebusfarm.net/en/?gclid=CMes8_WU1bMCFUy5zAodfHoAnw)

# java - 引发异常的休息调用——Firefox/Chrome 看到内部服务器错误，IE 看到错误请求

> ID：13426582
> 
> 赞同：1
> 
> 时间：2012-11-17T00:58:08.837
> 
> 标签：java, ajax, rest, internal-server-error, bad-request

在使用 jQuery 1.6.4 调用 $.ajax 后接收到 jqXHR 对象时打印它，我们看到了值的差异。

Firefox/Chrome 看到 500 内部服务器错误以及包含堆栈跟踪的 resposneText（该堆栈跟踪的目的 atm）。

IE 根本没有 responseText 和错误类型的“400”。

**铬/FF**

```
!!!!!!RAW Error -> {"readyState":4,"responseText":"{\"message\":\"Activities in this presentation mode can not contain checkpoints.\",\"code\":\"unknown (class com.ilrn.util.shared.ILrnException)\",\"type\":\"fatal-

etc etc then ends with

net.LeaderFollowerWorkerThread.runIt(LeaderFollowerWorkerThread.java:80)\\norg.apache.tomcat.util.threads.ThreadPool$ControlRunnable.run(ThreadPool.java:684)\\njava.lang.Thread.run(Thread.java:680)\"}","status":500,"statusText":"Internal Server Error"} 
```

**IE**

```
RAW Error ->{"readyState":4,"responseText":"","status":400,"statusText":"failed"} 
```

感谢令人愉快的居民！:D

# python - python 游戏中产生的问题（while 循环等）

> ID：13426583
> 
> 赞同：-1
> 
> 时间：2012-11-17T00:58:37.900
> 
> 标签：python, python-3.x, while-loop, do-while

我正在编写 python 代码，因为我是编程的初学者。但是，由于我无法找到问题的解决方案，所以我停了下来，所以我希望有人能照亮或指导我告诉我哪里出错了。

节目大纲：
电脑与玩家对战，取随机数，谁选最后一个为输。

这是python程序：

```
import random  

playAgain = 'y'  

while playAgain == 'y':
    random_Number = random.randint(0-30)  

    while random_Number != 0 :  
        computer = random.randint(1,6) <= random_Number  
        random_Number = random_Number - computer  
        if random_No <= 0 :  
          print('Player 1 wins')  
        else:  
          player = int(input('Enter number'))  

       random_Number = random_Number - int(player)  

       if random_Number <=0:  
          print('Computer wins')  

playAgain== input('play again? (yes/no)') 
```

我面临的 3 个问题是：
1）当我再次选择“否”播放时，while 循环不会终止游戏。有人可以告诉我我在这方面哪里出了问题，以及我如何在未来的 while 循环中避免这种情况。

2）如果剩余的随机数是1，如果玩家选择了一个更高的数字，那么随机数就会变成负数。我怎样才能避免这种情况？

3）当随机数显示1或2时电脑不选号，所以玩家输了很多时间。我怎样才能让电脑选择一个号码，直到游戏没有结束？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:04:56.557

1)`while playAgain == 'y'`应该是总体循环，因为它应该执行游戏的每个实例。因此，在此之后的所有内容都缩进一个制表符/4 个空格。

2)如果值为负，则更改为终止`while random_Number != 0`。`while random_Number > 0`对于ifs来说似乎没问题。

3）您应该在内部循环之后缩进`if`and`else`子句，`while`以便在读取每个数字后执行它们。例子：

```
while random_Number > 0:
    computer = random.randint(1,6) <= random_Number  
    random_Number = random_Number - computer  
    if random_No <= 0:
        print('Player 1 wins')  
    else:
        player = int(input('Enter number'))  
        random_Number = random_Number - int(player)
        if random_Number <= 0:  
            print('Computer wins') 
```

编辑：现在应该修复条件

# java - android项目未出现在文件>新建中

> ID：13426584
> 
> 赞同：1
> 
> 时间：2012-11-17T00:58:42.897
> 
> 标签：java, android

我的操作系统是windows 7 32位我安装了java jdk 6，下载了eclipse并安装了android SDK，问题是android项目没有出现在文件中>新的只出现android应用程序项目我尝试了很多版本但没有用，我需要知道如何从 android 项目中的应用程序开始，而不是 android 应用程序项目中存在的应用程序我尝试运行它，但出现此错误 [2012-11-17 02:54:42 - Emulator] 无法分配内存：8 [2012- 11-17 02:54:42 - Emulator] [2012-11-17 02:54:42 - Emulator] 此应用程序已请求运行时以不寻常的方式终止它。[2012-11-17 02:54:42 - Emulator] 请联系应用程序的支持团队以获取更多信息。请帮助我如何像以前一样出现 android 项目，或者如何使用该 android 应用程序项目，在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T00:50:18.667

因此，您希望能够在**没有**预制的“Hello world”应用程序的情况下启动一个 android 项目？[我建议下载你可以在Android 开发](http://www.developer.android.com/)中找到的新包 你需要做的就是运行 Eclipse 应用程序文件，一切都应该设置好。我认为无论如何这并不重要，你仍然会有基本的项目，但你可以从代码中删除元素。希望我正确理解了你的问题。

# css - 可点击区域扩展到容器（图像）

> ID：13426585
> 
> 赞同：0
> 
> 时间：2012-11-17T00:58:57.960
> 
> 标签：css

我已经在链接中设置了图像，它可以工作，除了可点击区域扩展到整个容器（图像的父级）。（下图中的橙色部分）

[**可点击区域的**屏幕截图****](http://aurelieremia.be/screenshot.jpg)

 **这是有关此问题的代码部分（我没有将所有内容都放入其中，所有图像都有相同的问题。）：

**HTML：**

```
<a href="img/tableau/tableau-01.jpg">
    <img src="img/tableau/tableau-01.jpg" alt="tableau 01"/>
</a>

<a href="img/tableau/tableau-02.jpg">
     <img src="img/tableau/tableau-02.jpg" alt="tableau 02"/>
</a>

<a href="img/tableau/tableau-02.jpg">
    <img src="img/tableau/tableau-03.jpg" alt="tableau 03"/>
</a> 
```

**CSS：**

```
#container {
    position: relative;
    margin: 0 auto;
    width: 960px;
    height: 900px;
}

img {
    height: 50%;
    width: 50%;
    max-width: 100%;
    border: 1px rgba(255, 255, 255, 0.1) solid;
    margin: 0 auto;
    display: block;
    -webkit-transition: all ease-in 0.13s;
       -moz-transition: all ease-in 0.13s;
         -o-transition: all ease-in 0.13s;
        -ms-transition: all ease-in 0.13s;
            transition: all ease-in 0.13s;
    margin-bottom: 25px;
} 
```

还有[网站的链接](http://aurelieremia.be/tia1/mes-grilles-mes-premiers-pas/index.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:09:36.043

为什么将显示设置为阻止？如果你删除它并让我认为是 inline-block 的默认值修复它。如果要居中，可以使用其他方法。**

# jquery - 沙盒 iframe 中的 jQuery Mobile

> ID：13426586
> 
> 赞同：2
> 
> 时间：2012-11-17T00:58:59.270
> 
> 标签：jquery, mobile, iframe, sandbox

我想在 iframe 中运行 jquery 移动站点，该 iframe 是沙盒但带有允许脚本。但它什么也不会显示。

```
<!Doctype html>
<html>
<head>
<title>#1 JS Scope</title>
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no">

<!-- Libs -->
<script src="../../lib/jquery-1.8.2/jquery-1.8.2.js"></script>
<script src="../../lib/jquery-mobile-1.2.0/jquery.mobile-1.2.0.js"></script>
<link href="../../lib/jquery-mobile-1.2.0/jquery.mobile.structure-1.2.0.css" rel="stylesheet">
<link href="../../lib/jquery-mobile-1.2.0/jquery.mobile-1.2.0.css" rel="stylesheet">
</head>

<body>
<!-- Page -->
<div data-role="page" id="home">
    <!-- Header -->
    <div data-role="header" data-theme="a">
        <h1>Top</h1>
    </div>

    <!-- Content -->
    <div data-role="content"  data-theme="c" id="frame">
        <iframe src="http://jquerymobile.com/demos/1.2.0/" sandbox="allow-scripts" width="926" height="974"></iframe>
    </div>
</div>
</body>
</html> 
```

它是沙盒的，因为我想阻止完成的 jquery 移动应用程序访问包装页面的 DOM。因此只有allow-script 设置为允许运行jquery mobile 的javascript。

但是 iframe 只显示白色，我真的不知道可能出了什么问题。因为 jquery 不需要访问父 DOM 来显示某些内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T19:54:47.187

jQuery Mobile 试图操纵浏览器历史记录 (history.replaceState)，这在沙盒化时是不允许的

```
init: function() {
    $win.bind( "hashchange", self.onHashChange );

    // Handle popstate events the occur through history changes
    $win.bind( "popstate", self.onPopState );

    // if there's no hash, we need to replacestate for returning to home
    if ( location.hash === "" ) {
        history.replaceState( self.state(), document.title, $.mobile.path.getLocation() );
    }
} 
```

# dom - IE 警告：“该页面存在未指明的潜在安全风险。” 解析网络内容时

> ID：13426589
> 
> 赞同：1
> 
> 时间：2012-11-17T00:59:21.577
> 
> 标签：dom, com, autohotkey

我正在使用 DOM 解析 web 内容，发现调用外部脚本的以下行会导致弹出 IE 安全警告。有没有办法在脚本中禁用此警告？

我正在寻找一种方法来做到这一点：

*   注册表编辑，因为它需要管理员权限
*   删除 HTML 源代码中的脚本标签，因为它不是可靠的方法
*   Shell.Explorer ActiveX 控件，因为它有时会窃取焦点

    ```
    strHTML =
    (Ltrim
        <html><body>
        <script type="text/javascript">_qoptions={qacct:""};</script>
        <script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script>
        </body></html>
    )

    doc := ComObjCreate("HTMLfile") 
    doc.write(strHTML)
    msgbox % doc.documentElement.innerHTML 
    ```

IE 说，

> 该页面具有未指明的潜在安全风险。你想继续吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T07:39:39.110

找到了解决方法。

```
strHTML =
(Ltrim
    <html><head><style>div {font-weight: bold;}</style></head><body>
    <script type="text/javascript">_qoptions={qacct:""};</script>
    <script type="text/javascript" src="http://edge.quantserve.com/quant.js"></script>
    </body></html>
)

doc := ComObjCreate("HTMLFILE") 
doc.write("<html><head></head><body></body></html>")
doc.getElementsByTagName("body")[0].innerHTML := strHTML

msgbox % doc.documentElement.innerHTML 
```

虽然这会去除标题内容，但足以满足我的需要。

# c# - 序列化作为通用 List<> 的基类时，WCF 调用失败

> ID：13426595
> 
> 赞同：2
> 
> 时间：2012-11-17T00:59:52.817
> 
> 标签：c#, xml, wcf, serialization, inherited

我有以下结构：

```
public class DerivedClass : List<BaseClass>
{
   //Some helper methods used against the List of BaseClass properties

   //Methods
   public  List<BaseClass> GetListOfBaseClasses()
   {
       return (List<BaseClass>)this;
   }
} 
```

我的 WCF 服务知道 BaseClass 对象，但客户端将其作为通用列表派生，现在当我尝试调用该服务时，如下所示：

```
DerivedClass classD;
FillData(classD)
List<BaseClass> baseClassList = classD.GetListOfBaseClasses();

using (IService myService = ObjectFactory.GetMyService())
{
      myService.DoSomething(baseClassList); //Method is expecting "List<BaseClass>"
} 
```

我得到以下异常：

> 不应使用数据合同名称“[某些 URI 文本]”键入“DerivedClass”。考虑使用 DataContractResolver 或将任何静态未知的类型添加到已知类型列表中 - 例如，通过使用 KnownTypeAttribute 属性或将它们添加到传递给 DataContractSerializer 的已知类型列表中。

我尝试以各种组合将这些属性添加到我的类中，但仍然没有运气：

```
[Serializable]
[KnownType(typeof(List<BaseClass>))]
[XmlInclude(typeof(List<BaseClass>))]
[KnownType(typeof(BaseClass))]
[XmlInclude(typeof(BaseClass))]
public class DerivedClass : List<BaseClass>
{
  /// ...
} 
```

PS-Sheehs，我是唯一一个认为这个网站上的输入字段很时髦的人吗？当我尝试格式化时，事情一直在变化......：| 很棒的网站，尽管我无法根据需要输入文本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:03:32.177

您必须为您的服务接口添加一个 ServiceKnownTypeAttribute：

```
[ServiceKnownType(typeof(DerivedClass))]
public interface IService
{
    // Service declaration
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:55:27.687

有几种方法可以[注册已知类型](http://msdn.microsoft.com/en-us/library/ms730167.aspx)。但首先请阅读有关 DataContracts 和 DataContractSerializer[支持的类型的](http://msdn.microsoft.com/en-us/library/ms731923.aspx)[文章](http://msdn.microsoft.com/en-us/library/ms733127.aspx)。

请注意，您没有`DataContract`在`DerivedClass` `BaseClass`. 尽管标有该`Serializable`属性的类是有效的并且可以在 WSDL 中公开，但`DataContractAttibute`它具有为互操作性而设计的序列化规则，并且它是 WCF 的首选序列化机制。

如果您决定在数据合约上注册已知类型，那么这就足够了：

```
[DataContract]    
public class DerivedClass : List<BaseClass>
{
  /// ...
}

[DataContract]
[KnownType(typeof(DerivedClass))]
public clas BaseClass
{
    //Add the DataMemberAttribute to the properties you want serialized.
} 
```

如果要在服务合同级别注册已知类型，请`ServiceKnownType`在`ServiceContract`.

# javascript - 何时在 Javascript 客户端中从 REST 服务器盲目加载数据与仅加载需要的数据

> ID：13426597
> 
> 赞同：1
> 
> 时间：2012-11-17T01:00:18.503
> 
> 标签：javascript, rest, optimization, latency

在客户端上使用 javascript 时，通常可以一次加载整个数据块，例如`load("http://restful.server.com/api/model/")`加载或仅加载所需的数据，例如`load("http://restful.server.com/api/model/id=1234")`. 当您只需要几个项目时，后者是有意义的。但是，如果所需项目的数量变化很大，那么发出大量请求的延迟就会变得难以承受。

如果您无法提前知道哪种方法最快，您如何确定如何构建请求以优化加载时间？

举个例子，我正在开发的一个应用程序显示以下数字：

```
individual: Load choices based on individual questions, following the foreign
        relationship. The logical way, but costs round-trip-time.
  Min           Avg         Stddev      Max
times 77.13955832   96.59890914 23.99644340 184.17492986
sizes 0.232828M     0.238071M   0.002353M   0.241834M
speed 1.264167K     2.566590K   0.424770K   3.109053K

all: Load all choices in one go, ignoring the fact that most of them will be
     unused. Sloppy, but fast?
      Min           Avg         Stddev      Max
times 0.21781421    1.79287671  6.82427604  31.53920007
sizes 0.656552M     0.656552M   0.00000000  0.656552M
speed 0.020817M     2.746438M   0.6278713M  3.014275M 
```

请注意，`all`速度大约要高一个数量级。这显然受到本次测试中与服务器的一跳 GigE 连接的影响。但是，实际连接显示更大的最小 RTT 以及更低的吞吐量，它应该是相似的。一旦完成，虽然我预计可用数据的大小将增长 1.3-2 个数量级。这意味着批量加载仅适用于超快速连接。该怎么办？

# android - Android、插件系统和反射类

> ID：13426598
> 
> 赞同：2
> 
> 时间：2012-11-17T01:00:25.110
> 
> 标签：android, class, plugins, reflection

我正在开发一个需要某种插件系统的应用程序。

是否可以在单独的.apk 上加载带有反射的类？

欢迎任何其他想法。

编辑：解决了，谢谢大家。最后我想出了这个：

```
public Object loadPlugin(String packageName, String className) {
    try {
        return (Object) new PathClassLoader(getPackageManager().getPackageInfo(packageName, 0).applicationInfo.sourceDir, null, getClassLoader()).loadClass(className).getConstructor(new Class[]{ Context.class, IXoneApp.class }).newInstance(new Object[] {this, this.appData()});
    } catch (NameNotFoundException ex) {
        Utils.DebugLog(Utils.TAG_FRAMEWORK, "El módulo " + packageName + " no está instalado");
        return null;
    } catch (Exception ex) {
        Utils.DebugLog(Utils.TAG_FRAMEWORK, "Fallo al invocar el módulo " + packageName + "\n" + ex.getMessage());
        return null;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T04:12:32.717

您必须更具体地了解“插件”。如果您希望能够添加单独的功能，您可能需要一个主要的 .apk，然后是较小的 .apk 来实现插件。取决于你想要做什么。

# php - 忘记密码的随机字符串在 MySQL 中是正确的，但在表单中不起作用

> ID：13426601
> 
> 赞同：-2
> 
> 时间：2012-11-17T01:01:00.980
> 
> 标签：php

我不确定如何搜索我遇​​到的问题。

该代码可以正常生成随机生成的加密密码，但在提交 HTML 表单时密码不起作用。我通过 SQL 查询验证了密码，以确保它是有效的。

为了回应下面的用户，这是我使用的查询：

```
SELECT * FROM users WHERE email='test@test.com' AND password=MD5('03884d917f'); 
```

03884d917f 是生成的密码。我用它正确查询了 test@test.com 帐户。

更简洁：生成的密码在 MySQL 中正确更改，但是在前端提交时我无法使用它登录。

我认为不需要任何额外的代码，唯一有用的是 config.php，它只处理连接数据库和为邮件函数建立变量。

2 次投反对票，但没有实际输入我如何更改帖子以容纳人们。我试图缩小我的问题，我不知道如何解释它。有人想用实质性的东西来回应吗？

PHP：

```
 <?php
    require_once('config.php');
    mysql_select_db($database,$dbhandle);
    include_once('includes/header.inc.php');
    include_once('includes/navigation.inc.php');

    if (isset($_POST['submit'])) 
    {

    $email = $_POST['remail'];
    $pattern = '/^[^@]+@[^\s\r\n\'";,@%]+$/';
    if (!preg_match($pattern, trim($email))) {
      $error[] = 'Please enter a valid email address';
    } 

    $check = mysql_query("SELECT email FROM users WHERE email = '$email'")or
    die(mysql_error());
    $check2 = mysql_num_rows($check);

    if ($check2 == 0) {
    $error[] = 'Sorry, we cannot find your account details please try another email address.';
    }

    if (!$error) {

    $query = mysql_query("SELECT email FROM users WHERE email = '$email' ")or die         (mysql_error());
    $r = mysql_fetch_object($query);

    $password = substr(uniqid(rand(),1),3,10);
    $pass = md5($password); //encrypted version for database entry

    $to = "$email";
    $subject = "Account Details Recovery";
    $body = "Hi $r->email, \n\n you or someone else have requested your account details. \n\n Here is your account information please keep this as you may need this at a later stage. \n\nYour email is $r->email \n\n your password is $password \n\n Your password has been reset please login and change your password to something more rememberable.\n\n Regards Site Admin";
    $additionalheaders = "From: admin@cenz.cz";
    $additionalheaders .= "Reply-To: admin@cenz.cz";
    mail($to, $subject, $body, $additionalheaders);

    //update database
    $sql = mysql_query("UPDATE users SET password='$pass' WHERE email = '$email'")or die (mysql_error());
    $rsent = true;

    }
    }

    if (!empty($error))
    {
    $i = 0;
    while ($i < count($error)){
    echo "<div class=\"msg-error\">".$error[$i]."</div>";
    $i ++;}
    }

    if ($rsent == true){
echo "<p align='center'>You have been sent an email with your account details to $email</p>\n";
} else {
echo "<h2>Reset Password</h2><p align='center'>Please enter your e-mail address. You will receive a new password via e-mail.</p>\n";
}

    ?>

    <form class="box login" action="" method="post">
    <fieldset class="boxBody">
    <label for="remail">Email Address: </label>
    <input type="text" name="remail" size="50" maxlength="255" tabindex="1" />
    </fieldset>
    <footer>
    <input type="submit" name="submit" value="Reset Password" class="btnLogin" tabindex="2">
    </footer>
    </form>
    <?php include_once('includes/footer.inc.php'); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:56:14.287

md5() 根据字符编码生成哈希。

例如，如果表编码为 utf-8，则将其编码如下：

```
$pass = md5(utf8_encode($password)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T10:39:59.037

我决定以不同的方式加密。该问题与通过 MD5 加密有关。相反，我使用了 sha256 加密。

这是我使用的代码：

```
 function HashPassword($input)
    {
    random salt
    $salt = bin2hex(mcrypt_create_iv(32, MCRYPT_DEV_URANDOM)); 
    $hash = hash("sha256", $salt . $input); 
    $final = $salt . $hash; 
    return $final;
    }
    $password = substr(uniqid(rand(),1),3,10);
    $pass = (HashPassword($password)); 
```

# javascript - 转到新页面时，Facebook 如何设法杀死 javascript？

> ID：13426604
> 
> 赞同：2
> 
> 时间：2012-11-17T01:01:40.603
> 
> 标签：javascript, facebook, settimeout, setinterval

尝试这个。

在 Facebook 主页（您的 Facebook 订阅源）上的浏览器控制台中输入此代码：

```
setInterval(function(){console.log('blah')}, 100) 
```

然后导航到网站的“消息”或“事件”部分。请注意，整个页面没有重新加载，新的 html 内容是使用 javascript 动态插入的。然而，不知何故 Facebook 取消了`setInterval`. 这也发生在`setTimeout`.

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T01:41:51.240

事实证明，Facebook 正在用自己的方式覆盖本机`setTimeout`和功能。`setInterval`您可以通过`setTimeout`在浏览器控制台中输入来查看这一点，它将返回一个与典型函数不同的`native code`函数。因此，Facebook 可以访问`setTimeouts`页面上的所有内容，甚至是通过第三方代码访问的内容，因此可以在您访问新页面时（或者在他们真正想要的时候）清除它们。

# python - 加入后如何附加到模板

> ID：13426605
> 
> 赞同：-3
> 
> 时间：2012-11-17T01:01:47.450
> 
> 标签：python

我对如何做到这一点缺乏想法？我真的需要一些帮助...我正在尝试根据输入 XML 文件生成 HTML 代码并遇到属性错误，问题是我正在使用“TR_TEMPLATE = '\ n'.join(TR_TEMPLATE)" 成为一个字符串，稍后我的代码再次尝试附加导致错误的 "TR_TEMPLATE.append(' {{}}'.format(col))" ..我无法删除首先加入，我该如何进行？

我的代码：-

```
 http://pastie.org/5390303 
```

输入如下

```
http://pastie.org/5390316 
```

预期输出：-

```
http://pastie.org/5390312 
```

属性错误

```
Traceback (most recent call last):
 File "C:\Dropbox\scripts\test.py", line 54, in <module>
crInfo = CRlistToTable(CRlist)
File "C:\Dropbox\scripts\test.py", line 31, in CRlistToTable
TR_TEMPLATE.append('    <td>{{}}</td>'.format(col))
AttributeError: 'str' object has no attribute 'append' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:13:19.387

这里至少有四种可能性，按照从最简单和可能最好到最噩梦的顺序排列。

首先，您可以废弃第 26 行。尽管您说“我一开始就无法删除联接”，但似乎没有任何充分的理由。

你最终保证在第 33 行加入它，并且在此之前你永远不会使用该值，除了附加更多字符串。那么，为什么会有第 26 行呢？

其次，您可以从此更改第 26 行：

```
TR_TEMPLATE = '\n'.join(TR_TEMPLATE) 
```

对此：

```
TR_TEMPLATE = ['\n'.join(TR_TEMPLATE)] 
```

换句话说，不是将它从字符串列表展平为单个字符串，而是将其从字符串列表展平为一个字符串的列表 - 然后您可以继续附加更多字符串并再次展平。

第三，您可以首先创建`TR_TEMPLATE`一个字符串而不是列表。更改第 13 行以省略括号。然后，无论你打电话`TR_TEMPLATE.append(foo)`，而不是只是做`TR_TEMPLATE += foo + '\n'`。然后，您可以废弃第 26 行，并将第 33 行更改为仅删除多余的尾随 '\n' 而不是加入。

最后，您可以跟踪您是否已加入`TR_TEMPLATE`，如果尚未加入，`append`则连接如果已加入。（或者，您可以使用类型切换来代替跟踪，但这会使它更加丑陋。）

# c++ - 从 .txt 文件中读取的输入输出 C++

> ID：13426606
> 
> 赞同：0
> 
> 时间：2012-11-17T01:02:08.327
> 
> 标签：c++, input, output

我如何将其打印到输出文件中，并按周和总周计算这些人工资的总和和平均值，共 4 周...

示例txt文件..

```
doe       jane
williams  tom
lons      adams

 45.7   56.3   345.6  344.7  // week 1
 43.6   89.0   543.6  12.5   // week 1  person 2
 90.5   78.0  345.4  345.6  //week 1 person 3
 67.5   34.5   56.6   34.5   // week2 person 1
  etc....for 4 weeks.. 
```

我知道使用循环有一种更简单的方法我可以得到一些帮助吗谢谢:)

这就是我到目前为止所拥有的

```
#include<iostream>
#include<fstream>
#include<cstdlib>
#include<string>
#include<iomanip>
using namespace std;

int main()
{
ifstream infile;
 ofstream outfile;

double s1, s2, s3 , s4 ,s5;
double t1, t2,t3,t4,t5;
double w1, w2,w3,w4,w5;
string personlast,personfirst,personlast2,personfirst2,personlast3,personfirst3;
double sum, average;
int numberpeople, numberofweeks;

infile.open("data.txt");
outfile.open("output.txt");

outfile<< fixed<< showpoint;
outfile<< setprecision(2);

infile>> numberpeople >> personlast >> personfirst >> personlast2 >> personfirst2>>
  personlast3 >> personfirst3 >> numberofweeks;
outfile<< " The number of salespeople are " << numberpeople <<"they are" <<
personlast << personfirst << "and " <<
 personlast2 << personfirst2 <<
 "and " << personlast3 << personfirst3 <<"Number of weeks = " << numberofweeks;

infile>> s1 >> s2 >> s3 >> s4 >> s5;
outfile <<" sales for week 1  "<< " for" << personlast << personfirst << s1 << s2
<< s3 << s4 << s5 << endl;
sum= s1+s2+s3+s4+s5;
 outfile <<"Sum of first week is " << sum<<endl;

infile >> t1 >> t2 >> t3 >> t4 >> t5;
outfile <<" sales for week 1  "<< " for" << personlast2 << personfirst2 << t1 << t2 
<< t3 << t4 << t5 <<endl;

infile.close();
outfile.close();
return 0; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:26:43.330

我不会为你做作业，因为我不想，但我会给你一些开始的东西。基本概念是遍历文件，读取每一行。使用类似（伪代码）的控件；

```
 while (string = readline() != EOF)
 {
     //split string on delimiters in this case spaces
     if (string piece is not an int)
     {
         // this is a name
         // set first and last name here
     }

     if (string piece is an int)
     {
        // set ints,
     }
 } 
```

您还需要一些结构（如果您已经了解这些结构，这些可能应该是类）来保存您的数据。如果您可以使用字符串，则使用它们而不是那些`char*`如果您使用，则`char*`必须动态声明一个 char 数组。`char[64] first_name;`那个，或者如果允许的话，你可以制作它们。

```
struct person {
   char *first_name;
   char *last_name;
   numbers[4] numbers;
};

struct numbers {
   float item1;
   float item2;
   float item3;
   float item4;
}; 
```

当您读取数据时，您需要将其读入人员结构的实例中。

# c# - 如何重构此 C# 代码？

> ID：13426607
> 
> 赞同：4
> 
> 时间：2012-11-17T01:02:16.450
> 
> 标签：c#, refactoring

我正在处理遗留代码，我已经看到了很多这样的代码：

```
public class Person
{
    public Person(PersonData data)
    {
        this.Name = data.Name;
        this.Gender = data.Gender ;
    }

    public String Name { get; private set;}
    public String Gender { get; private set;}
}

public class PersonData
{
    public String Name;
    public String Gender;
}

public static Person ReadPerson(Reader reader)
{
    PersonData data = new PersonData;
    data.Name = reader.ReadString();
    data.Gender = reader.ReadString();

    Person p = new Person(data);
    return p;
} 
```

PersonData 类用于在其构造函数中设置 Person 类中的私有字段。除此之外，PersonData 类引入了冗余代码，正如您现在看到的那样，Person 和 PersonData 类中都有 Name 和 Sex。

在我看来，这种设计无法扩展：现在我有一个新字段“Age”要读取，我必须在两个不同的地方添加“Age”属性。

这是一个有效的设计选择（鉴于我在遗留代码中看到*了很多*这样的代码）？
我该如何重构呢？

**编辑：**

这两个类是真实代码的简化版本。所以请原谅使用字符串而不是枚举来表示性别。

在实际代码中，PersonData 有 10 多个字段，例如 Person 类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:11:14.683

当使用[构造函数注入](http://msdn.microsoft.com/en-us/library/ff921152%28v=pandp.20%29.aspx)时，使用参数对象是一种有效的方法，并且您开始在构造函数中获取大量参数 - 但是当您拥有的参数较少时，就没有必要了。

这是一个建议：

```
public class Person
{
    public Person(string name, string sex)
    {
        _name = name;
        _sex = sex;
    }

    public string Name { get {return _name; }}
    public string Sex { get {return _sex; }}

    private readonly string _name, _sex;
} 
```

这使得类[不可变](http://en.wikipedia.org/wiki/Immutable_object)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:36:14.240

如果它是某种面向外部的对象（与您的情况似乎不同的数据传输对象），您可以考虑使用流畅的接口来构建它们，它不会减少类的数量，但会让您构造对象更花哨寻找方式以及更好地控制什么是必需的和什么是可选的。

如果有兴趣，请参阅带有[fluent-interface](https://stackoverflow.com/questions/tagged/fluent-interface)标记的帖子。即[条件生成器方法链接流畅接口](https://stackoverflow.com/questions/10046629/conditional-builder-method-chaining-fluent-interface)：

```
var person = PersonBuilder
  .CreatePerson()
    .Named(reader.ReadString())
    .Sex(reader.ReadString())
    .Build() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T01:15:09.957

摆脱`PersonData`并将其提供`Reader`给构造函数：

```
public sealed class Person
{
    public Person(Reader reader)
    {
        this.Name = reader.ReadString();
        this.Sex = reader.ReadString();
    }

    public string Name { get; private set; }

    public string Sex { get; private set; }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T01:22:43.407

一般来说，我会回到您正在建模的现实世界（或业务:)）系统。如果该类与那个世界中的某些东西相匹配，那就没问题了。如果该类纯粹是编程系统的工件并且看起来也没有必要，我会扔掉它。使用“数据”类还可以隐藏使用显式参数会捕获的各种问题。例如，当您添加“年龄”时，您将如何检测是否找到了所有病例？如果将其添加为构造函数参数，则每个缺失的情况都会出现错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-17T01:10:43.993

一种方法是代替

```
public String Name { get; private set;}
public String Sex { get; private set;} 
```

暴露类型的属性`PersonData`

```
public class Person
{
    public PersonData PersonData { get; }
} 
```

您也可以查看`Person`从`PersonData`.

# php - 将 PHP 变量传递给 Javascript 函数（具体代码错误）

> ID：13426609
> 
> 赞同：2
> 
> 时间：2012-11-17T01:02:34.217
> 
> 标签：php, javascript, html, function

所以我搜索了很多，并想出了如何将 PHP 变量传递给 Javascript 函数，但是当我在我的代码中实现它时，而不是在 alert() 中获取变量；我得到了窗口`<?php echo $a ?>`，`<?php echo $c ?>` 希望这是我忽略的小东西，但我不知道为什么这不起作用，因为我从论坛上的响应中逐行复制它并且用户说它有效，我有一个朋友说它有效，但是当我自己运行代码时（第二个 [code][/code]），它返回相同的错误。

```
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<?php 
$a = 'Fatber Christmas'; 
$b = '27 Sunshine Street /n America'; 
$c = nl2br($b); 
?>

<html>

<head>      
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Kenneth So Photography</title>
    <link rel="stylesheet" href="kennethsostylesheet.css" type="text/css">
    <link rel="shortcut icon" href="Photos/favicon.png" type="image/png">

    <script type="text/javascript"> 
    function test(a,b) { 
    alert(a); 
    alert(b); 
} 
    </script>

    <script type="text/javascript" src="picScript.js"></script>
</head>

<body>

    <a onClick="test('<?php echo $a ?>', '<?php echo $c ?>');">LINK</a> 

    <div id="headerBar">
        <div id="logo">
            <a href="javascript:void(0)" ><img src="Photos/FinalizedLogo.png" alt="logo" height="100px" width="400px" onclick="setNum(1)"></a> 
        </div>
        <div id="titleBar">
            <p>
            <a href="javascript:void(0)" onclick="setNum(1)">Home</a> |
            <a href="javascript:void(0)" onclick="setNum(2)">Automotive</a> |
            <a href="javascript:void(0)" onclick="setNum(3)">Nightlife</a> |
            <a href="/about.html">About Me</a> |
            <a href="/contact.html">Contact</a>
            </p>
        </div>
    </div>
    <div id="imageBox">
        <div id="imageView">
        </div>

        <div id="imagePreview">
        </div>
    </div>
</body>
</html> 
```

产生相同显示的独立代码

```
<?php 
$a = 'Fatber Christmas'; 
$b = '27 Sunshine Street /n America'; 
$c = nl2br($b); 
?> 
<html> 
<head> 
<script type="text/javascript"> 
function test(a,b) { 
    alert(a); 
    alert(b); 
} 
</script> 
</head> 
<body> 
<a onClick="test('<?php echo $a ?>', '<?php echo $c ?>');">LINK</a> 
</body> 
</html> 
```

谢谢你们！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:09:37.303

Your code is correct as far as the syntax goes, however - as pointed out in the comments - you always need to prepare your variables for the medium you are outputting to (database, other programming language, html, etc.).

The problem is that your php does not get parsed.

The reasons could be:

*   You do not have php enabled on your server;
*   Your filename ends for example in `.html` instead of `.php` causing the file not to be recognized as a php file;
*   You are not requesting the file from the server but from the file-system.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:08:36.410

/n 不是新行。\n 是。

```
<?php 
$a = 'Fatber Christmas'; 
$b = '27 Sunshine Street \n America'; 
$c = nl2br($b); 
?> 
```

经过测试并且工作正常。

Also, are you saving the file as .php type and not .html? As you may have surmised, PHP will not work in .html files. You will need to save as .php and also, as jeroen said, make sure php is enabled.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T07:45:37.180

I tested the code. But it works fine for me.

```
 i)I think you do not have php enabled server. 
 ii) Check your server that accepts the javascript code and php code
 iii) May be plugins problem. So if you are using netbeans, see the php tag and javascript variable in different color. So u can easily recognize the mistakes. 
```

# reporting-services - 在 RDLC 中制作“带状”报告的最简单方法是什么？

> ID：13426616
> 
> 赞同：5
> 
> 时间：2012-11-17T01:04:00.330
> 
> 标签：reporting-services, reportviewer, rdlc, rdl, report-viewer2010

好的，我可能一直在用谷歌搜索错误的搜索词，但我找不到如何使用 RDLC 制作 MS-Access 样式的带状报告（即 Visual Studio 2010 中的残缺报表设计器，而不是 BIDS）我的意思是带状，带有组标题和子组标题的报告——不是交替的颜色带。

我有一个带有 List、Tablix 和 Matrix 的工具箱，它们的行为都是一样的——我不断得到看起来像 MS-Access CrossTabs 的东西。我可以得到这个：

```
Country Population    Date
---------------------------
Spain 1 million     1982
Spain 1.1 million   1983
China 1 billion     1982
China 1.2 billion   1983 
```

我还可以在行上获取国家，在列上获取年份并在中心弹出，例如交叉表，但我不想要交叉表。此外，我不想要行标题，它实际上与上面的相同，除了合并相同的单元格。

但我不能得到这个：

```
---------------
Spain 
---------------
Population     Date
1 million     1982
1.1 million     1983
---------------
China
---------------
Population    Date
1 billion     1982
1.2 billion   1983 
```

RDLC甚至可能吗？

**更多信息** Reporting Services 是 Microsoft 发布的一种服务器产品，它附带一个客户端，称为商业智能开发某事或简称 BIDS。前者使用 RDL，后者生成 RDL（RDL 是一种基于 XML 的报告语言）。这两个我都没有。

我有 ReportViewer，它是一个 ASP.NET 控件，可以读取 RDLC（RDL 的残缺子集），我有 Visual Studio 2010，它有残缺的 BIDS 版本。Visual Studio 2010 中的工具箱有一个列表、一个 Tablix 和一个 Matrix，它们看起来都是同一个控件，具有不同的默认起始属性。在 MS-Access 中创建所谓的交叉表是毫不费力的，但是要反复试验来生成一个带状报告，而该报告往往会产生任何结果。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T14:43:56.027

只要我了解了所有内容，您所要求的内容可以以 RDLC 格式实现，我执行了以下步骤来获得您想要的输出：

1.  首先，我使用您上面提供的数据示例创建了示例数据。

    ```
    CREATE TABLE [dbo].[SampleTable](
        [Country] [nchar](10) NULL,
        [Population] [nchar](20) NULL,
        [Date] [nchar](10) NULL
    ) ON [PRIMARY]

    GO

    INSERT INTO [SampleTable]([Country],[Population],[Date])
    SELECT 'Spain', '1 million', '1982'
    UNION ALL SELECT 'Spain', '1.1 million',   '1983'
    UNION ALL SELECT 'China', '1 billion',     '1982'
    UNION ALL SELECT 'China', '1.2 billion',   '1983'

    GO 
    ```

2.  接下来我创建了一个新的 WindowsFormsApplication 并添加了一个新项目**“报告”（不是报告向导）**

3.  从工具箱中，我添加了一个新表，按照向导连接到先前创建的示例数据

4.  向表中添加了人口和数据并删除了额外的列，因此您的左侧看起来像这样：

    ![仅详细信息 - 人口和数据](../Images/4d57fad847aed10e15833c58a3674bbd.png "仅详细信息 - 人口和数据")

5.  添加组，通过右键单击行组下的（详细信息），添加组>父组...

    对话框 - Tablix 组：分组方式：国家，勾选“添加组标题”

6.  现在删除新创建的列，确保您选择只删除列而不是组

7.  删除列标题行并在空白行中添加Country字段（单击该字段时出现的表格图标），也可以通过右键单击合并单元格

8.  在两行之间添加一个新行，通过右键单击行组下的（详细信息），添加总计>之前

9.  在新行中添加行标题，应该留下这样的东西：

    ![最终解决方案 - 布局](../Images/42d9fe4e843b51f9757f0a54ddda578c.png "最终解决方案 - 布局")

    ![最终解决方案 - 组](../Images/00bb7257d1ab96a4ac1f2c72e6e96925.png "最终解决方案 - 行组")

10.  切换到 Form.cs [Design]，从 ToolBox 中添加一个 ReportViewer，选择新创建的报表

11.  最终解决方案预览如下

    ![最终解决方案 - 预览](../Images/24edf6634e668e8d0d566618ef84867c.png "最终解决方案预览")

下一步是更新报告的格式

# sql - SQL 计算行所属的某些类别的出现次数

> ID：13426617
> 
> 赞同：1
> 
> 时间：2012-11-17T01:04:05.553
> 
> 标签：sql, count, group-by

我有这张表，里面有一些数据：

```
table ColorsFlavors

id | name | color | flavor
--------------------------
 1 | n1   | green | lemon
 2 | n2   | blue  | strawberry
 3 | n3   | red   | lemon
 4 | n4   | green | lemon
 5 | n5   | green | mango
 6 | n6   | red   | chocolate
 7 | n7   | white | lemon
 8 | n8   | blue  | mango
 9 | n9   | green | chocolate 
```

我希望做一个 SQL 查询（或查询？），让我得到每种颜色的总行数，以及每种风格的总行数。

像这样的东西：

```
colors | occurrences
--------------------
green  |   4
blue   |   2
red    |   6
white  |   1

flavor    | occurences
----------------------
lemon     |   4
strawberry|   1
mango     |   2
chocolate |   2 
```

嗯，如果我有一个预定义的颜色和风味列表可供选择，那么数据表上未出现的颜色/风味的计数为 0，那又如何呢？

```
colors | occurrences
--------------------
green  |   4
blue   |   2
red    |   6
white  |   1
black  |   0

flavor    | occurences
----------------------
lemon     |   4
strawberry|   1
mango     |   2
chocolate |   2
cherry    |   0 
```

那么，检索这些的 SQL 查询是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:07:44.843

完成 ColorsFlavors 表中的所有颜色

```
Select
  cf.Color,
  Count(*)
From
  ColorsFlavors cf
Group By
  cf.Color 
```

如果您在表格中有一个预定义列表（我将其称为颜色），并且您希望包含零：

```
Select
  c.Color,
  Coalesce(Count(*), 0)
From
  Colors c
    Left Outer Join
  ColorsFlavors cf
    On c.Color = cf.Color
Group By
  c.Color 
```

如果您有一个预定义的列表，有人输入

```
Select
  c.Color,
  Coalesce(Count(*), 0)
From  (
    Select 'green' As Color Union All
    Select 'blue' Union All
    Select 'red' Union All
    Select 'white' Union All
    Select 'black'
  ) c
    Left Outer Join
  ColorsFlavors cf
    On c.Color = cf.Color
Group By
    c.Color 
```

有了这个，你应该能够解决口味！

# ruby-on-rails - 在部分中使用对象、集合和局部变量有什么区别

> ID：13426618
> 
> 赞同：1
> 
> 时间：2012-11-17T01:04:48.237
> 
> 标签：ruby-on-rails

我很难理解两者之间的区别

```
<%= render :partial => "book", :object => @book %> 
```

和

```
<%= render :partial => "book", :collection => @books %> 
```

和

```
<%= render :partial => "book", :locals => { :book => @book } %> 
```

有人可以向我解释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:46:14.640

这些是相同的：

```
<%= render :partial => "book", :object => @book %>
<%= render :partial => "book", :locals => { :book => @book } %>
<%= render "book", :book => @book %> 
```

他们将渲染`_book.html.erb`文件一次，@book 对象将在该部分中作为`book`变量可用。

这是缩写相同事物的一种好方法：

```
<%= render @book %> 
```

这个有点不同：

```
<%= render :partial => "book", :collection => @books %> 
```

它将在`_book.html.erb`每本书中呈现一次文件`@books`，而每个文件又在该部分中作为`book`变量可用。

这是缩写相同事物的一种好方法：

```
<%= render @books %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:35:21.330

```
<%= render :partial => "book", :object => @book %> 
```

将`_book.html.erb`局部变量设置`book`为`@book`.

```
<%= render :partial => "book", :collection => @books %> 
```

对于 in 中的每个元素，`@books`都会将`_book.html.erb`局部变量设置为`book`in 中的当前元素`@books`。

```
<%= render :partial => "book", :locals => { :book => @book } %> 
```

将`_book.html.erb`局部变量设置`book`为@book。这种形式允许您设置额外的局部变量或更改它们的名称，而 :object 版本则不能。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T05:05:10.383

```
<%= render :partial => "book", :object => @book %> 
```

在第一种情况下，使用 :object 将默认定义一个与 partial 同名的变量。如果我的部分模板名为 _user.html.erb，那么模板中将定义一个名为“user”的局部变量。

您可以使用 :as => "another_name" 指定不同的变量名。

```
<%= render :partial => "book", :locals => { :book => @book } %> 
```

最大的优点`:locals`是

1.  您可以非常清楚地控制对象和名称
2.  您可以分配超过 1 个变量

该`:locals`方法的缺点是它比较冗长，有时很简单

```
render :partial => 'account' 
```

等同于

```
render :partial => 'account', :locals => {:account => @account } 
```

So use the one which suits you the best (or where it suits the best).

```
<%= render :partial => "book", :collection => @books %> 
```

For Collection See : [http://blogs.visoftinc.com/2010/04/27/ruby-beauty-rendering-a-rails-partial-for-a-collection/](http://blogs.visoftinc.com/2010/04/27/ruby-beauty-rendering-a-rails-partial-for-a-collection/)

More info: [http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials](http://guides.rubyonrails.org/layouts_and_rendering.html#using-partials)

# java - 创建 3D 阵列对象

> ID：13426626
> 
> 赞同：0
> 
> 时间：2012-11-17T01:06:03.473
> 
> 标签：java, object, arraylist

我有 3 个单独的对象，例如 GSMTable、SMSTable 和 GPRSTable。这些包括 2 个字段，称为 srDate 和 numberOfSR。现在我需要让它们成为一个 3D 数组对象，因为我需要为我的 jqPlot 折线图返回它，这是我的要求：

```
[
  [gsmTable.srDate][gsmTable.noOfSR],
  [smsTable.srDate][smsTable.noOfSR],
  [gprsTable.srDate][gprsTable.noOfSR]
] 
```

我编写了自己的代码，如下所示，但我无法完成它。

```
@RequestMapping(value = "/allGridView", method = RequestMethod.GET)
public @ResponseBody
Object[] showLineChart(Map<String, Object> map, HttpServletRequest request,
        HttpServletResponse response) {

    List<GSMTable> gsmList = contactService.fin();
    List<Date>gsmDateList=new ArrayList<Date>();
    List<Integer>gsmCount=new ArrayList<Integer>();
    Object[] gsmArray=new Object[2];
    for (Iterator iterator =gsmList.iterator();iterator.hasNext();) {
        GSMTable gsmTable=(GSMTable)iterator.next();
        gsmDateList.add(gsmTable.getSRDate());
        gsmCount.add(gsmTable.getNumberOfSR());
    }
    gsmArray[0]=gsmDateList.toArray(new Date[gsmDateList.size()]);
    gsmArray[1]=gsmCount.toArray(new Integer[gsmCount.size()]);     
    //=====================================================================================
    List<SMSTable> smsList = contactService.sms();
    List<Date>smsDateList=new ArrayList<Date>();
    List<Integer>smsCount=new ArrayList<Integer>();
    Object[] smsArray=new Object[2];
    for (Iterator iterator =smsList.iterator();iterator.hasNext();) {
        SMSTable smsTable=(SMSTable)iterator.next();
        smsDateList.add(smsTable.getSRDate());
        smsCount.add(smsTable.getNumberOfSR());
    }
    smsArray[0]=smsDateList.toArray(new Date[smsDateList.size()]);
    smsArray[1]=smsCount.toArray(new Integer[smsCount.size()]);
    //=====================================================================================
    List<GPRSTable> gprsList = contactService.gprs();
    List<Date>gprsDateList=new ArrayList<Date>();
    List<Integer>gprsCount=new ArrayList<Integer>();
    Object[] gprsArray=new Object[2];
    for (Iterator iterator =gprsList.iterator();iterator.hasNext();) {
        GPRSTable gprsTable=(GPRSTable)iterator.next();
        gprsDateList.add(gprsTable.getSRDate());
        gprsCount.add(gprsTable.getNumberOfSR());
    }
    gprsArray[0]=gprsDateList.toArray(new Date[gprsDateList.size()]);
    gprsArray[1]=gprsCount.toArray(new Integer[gprsCount.size()]);

    Object[][][] finalArray;
    //after that how to complete it ? ? ? 
    //need to return finalArray as 3D Object Array
    return finalArray;
} 
```

gsm数组：

```
[[2012-11-05,05],[2012-11-06,08],[2012-11-07,10],[2012-11-08,14],[2012-11-08,09]] 
```

短信数组：

```
[[2012-11-05,02],[2012-11-06,03],[2012-11-07,04],[2012-11-08,04],[2012-11-08,03]] 
```

gprs数组：

```
[[2012-11-05,04],[2012-11-06,07],[2012-11-07,08],[2012-11-08,04],[2012-11-08,07]] 
```

我需要将 gsmArray、smsArray 和 gprsArray 合并为 3D 数组，那么我的期望数组应该是：

```
[[2012-11-05,05],[2012-11-06,08],[2012-11-07,10],[2012-11-08,14],[2012-11-08,09],[2012-11-05,02],[2012-11-06,03],[2012-11-07,04],[2012-11-08,04],[2012-11-08,03],[2012-11-05,04],[2012-11-06,07],[2012-11-07,08],[2012-11-08,04],[2012-11-08,07]] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T07:55:59.123

终于得到了解决方案：

```
 @RequestMapping(value = "/allGridView", method = RequestMethod.GET)
public @ResponseBody
Object[] showLineChart(Map<String, Object> map, HttpServletRequest request,
        HttpServletResponse response) {
    List<MapTable> gsmList = contactService.fin();
    Object[] gsmArray = new Object[gsmList.size()];
    int i = 0;
    for (Iterator iterator = gsmList.iterator(); iterator.hasNext();) {
        MapTable gsmTable = (MapTable) iterator.next();
        Object[] obj = new Object[2];
        obj[0] = gsmTable.getSRDate();
        obj[1] = gsmTable.getNumberOfSR();
        gsmArray[i] = obj;
        i++;
    }

    // =====================================================================================
    List<SMSTable> smsList = contactService.sms();
    Object[] smsArray = new Object[smsList.size()];
    i=0;
    for (Iterator iterator = smsList.iterator(); iterator.hasNext();) {
        SMSTable smsTable = (SMSTable) iterator.next();
        Object[] obj = new Object[2];
        obj[0] = smsTable.getSRDate();
        obj[1] = smsTable.getNumberOfSR();
        smsArray[i] = obj;
        i++;
    }
    // =====================================================================================
    List<GPRSTable> gprsList = contactService.gprs();
    Object[] gprsArray = new Object[gprsList.size()];
    i=0;
    for (Iterator iterator = gprsList.iterator(); iterator.hasNext();) {
        GPRSTable gprsTable = (GPRSTable) iterator.next();
        Object[] obj = new Object[2];
        obj[0] = gprsTable.getSRDate();
        obj[1] = gprsTable.getNumberOfSR();
        gprsArray[i] = obj;
        i++;
    }

    Object[] p=new Object[3];
    p[0]=gsmArray;
    p[1]=smsArray;
    p[2]=gprsArray;
    return p;
} 
```

输出：

```
[[["2012-10-14",3949681],["2012-10-15",9807773],["2012-10-16",9955313],["2012-10-17",9963638],["2012-10-18",9707045],["2012-10-19",9504716],["2012-10-20",8263961],["2012-10-21",7488501],["2012-10-22",10252551],["2012-10-23",10308166],["2012-10-24",10475042],["2012-10-25",10404402],["2012-10-26",10423749],["2012-10-27",8735703],["2012-10-28",7596690],["2012-10-29",8282781],["2012-10-30",11137772],["2012-10-31",11270296],["2012-11-01",11450240],["2012-11-02",11198160],["2012-11-03",9695753],["2012-11-04",8780354],["2012-11-05",11988513],["2012-11-06",12076273],["2012-11-07",12317203],["2012-11-08",12347978],["2012-11-09",12189239],["2012-11-10",10431736],["2012-11-11",9712163],["2012-11-12",12878093],["2012-11-13",12254237],["2012-11-14",13545518]],[["2012-10-14",2536],["2012-10-15",519490],["2012-10-16",527355],["2012-10-17",532718],["2012-10-18",535088],["2012-10-19",511614],["2012-10-20",466463],["2012-10-21",446447],["2012-10-22",531781],["2012-10-23",539720],["2012-10-24",540633],["2012-10-25",538185],["2012-10-26",615236],["2012-10-27",777230],["2012-10-28",433904],["2012-10-29",484538],["2012-10-30",531702],["2012-10-31",553843],["2012-11-01",560434],["2012-11-02",523517],["2012-11-03",474273],["2012-11-04",436413],["2012-11-05",522902],["2012-11-06",523710],["2012-11-07",532361],["2012-11-08",526496],["2012-11-09",523075],["2012-11-10",480817],["2012-11-11",430512],["2012-11-12",544556],["2012-11-13",783723],["2012-11-14",540902]],[["2012-10-03",6],["2012-10-09",2567],["2012-10-10",2017],["2012-10-11",2662],["2012-10-12",7861],["2012-10-13",21963],["2012-10-14",100925],["2012-10-15",484981],["2012-10-16",421067],["2012-10-17",501338],["2012-10-18",498310],["2012-10-19",514784],["2012-10-20",631011],["2012-10-21",683557],["2012-10-22",512583],["2012-10-23",530384],["2012-10-24",549654],["2012-10-25",569639],["2012-10-26",554665],["2012-10-27",681578],["2012-10-28",750583],["2012-10-29",820117],["2012-10-30",603903],["2012-10-31",592405],["2012-11-01",653473],["2012-11-02",655571],["2012-11-03",706664],["2012-11-04",759478],["2012-11-05",601499],["2012-11-06",623094],["2012-11-07",627868],["2012-11-08",611454],["2012-11-09",706279],["2012-11-10",754463],["2012-11-11",765718],["2012-11-12",642780],["2012-11-13",675966],["2012-11-14",509627]]] 
```

# hibernate - 我需要在 playframework 1.x 中挂钩级联保存

> ID：13426630
> 
> 赞同：1
> 
> 时间：2012-11-17T01:06:33.067
> 
> 标签：hibernate, playframework-1.x

我需要弄清楚如何将级联保存到 playframework 1.x 中的特定类扩展模型中。我需要钩子，以便我可以执行一段代码，该代码将在持久性之前重新计算对象上的数据字段，使用的数据最终来自属于级联到对象的其他类的模型对象的数据字段。

由 .save() 启动的实际过程似乎对挂钩非常有抵抗力。我无法挂钩 saveAndCascade() 并且创建 setWillBeSaved() 方法也没有提供挂钩，即使 playframework 文档似乎建议它应该这样做。

我有一个解决方案，但它似乎是一个相当“糟糕”的解决方案，它涉及在不需要的时候欺骗 hibernate 进行写入的黑客攻击。

hack 解决方案是向对象添加一个“hack”布尔字段，并在每次加载、持久化或更新对象时切换该字段。这是为了使它永远不干净。

这样做是因为到目前为止我能找到的唯一钩子是一个用@PrePersist 和@PreUpdate 注释的方法。问题是，如果 hibernate 不相信对象是脏的，它就不会调用带注释的方法。当数据字段在级联到相关对象中的一个相关对象中发生更改时，这会产生问题，这应该提示重新计算，这会使干净的对象变脏，但是重新计算不会发生，因为休眠认为对象是干净的。

这是我正在使用的解决方案的简单版本（圣桶添加了 4 个烦人的空格）。持久化以下任何一个对象都会导致对象 A 以正确的 a 值持久化。

```
@Entity
public class A extends Model
{
    @OneToMany(mappedBy="a", cascade = CascadeType.ALL)
    private List<B> bList = new ArrayList<B>();
    private Integer a = 0;
    private Boolean hack = true;

    //algorithm that only matters to the question so far as it uses data fields from B and C.
    public Integer getA()
    {
        Integer returnValue = 0;

        for(B b : bList)
        {
            returnValue = returnValue + b.getB();

            for(C c : b.getCList())
            {
                returnValue = returnValue + c.getC();
            }
        }

    return  returnValue;
    }

    public void setBList(List<B> bList)
    {
        this.bList = bList;
    }

    public List<B> getBList()
    {
        return bList;
    }

    //Hibernate will not call this method if it believes the object to be clean.
    @PrePersist
    @PreUpdate
    private void recalculateA()
    {
        hack = !hack; //remove the dirt and cross our fingers that hibernate won't write if the object is no longer dirty.
        a = getA(); //recalculate the value of A, reflecting the changes made in the objects cascading into A.
    }

    //Hack to put dirt on every clean object to force hibernate to call recalculateA whenever someone tries to save A.
    @PostPersist
    @PostUpdate
    @PostLoad
    private void hack()
    {
        hack = !hack;
    }

} 
```

-

```
@Entity
public class B extends Model
{
    @ManyToOne(cascade = CascadeType.ALL)
    private A a;

    @OneToMany(mappedBy = "b",  cascade = CascadeType.ALL)
    private List<C> cList = new ArrayList<C>();

    private Integer b = 0;

    public List<C> getCList()
    {
        return cList;
    }

    public void setCList(List<C> cList)
    {
        this.cList = cList;
    }

    public void setA(A a)
    {
        this.a = a;
    }

    public void setB(Integer b)
    {
        this.b = b;
    }

    public Integer getB()
    {
        return b;
    } 
```

## }

```
@Entity
public class C extends Model
{
    @ManyToOne(cascade = CascadeType.ALL)
    private B b;

    private Integer c = 0;

    public C(Integer c)
    {
        this.c = c;
    }

    public Integer getC()
    {
        return c;
    }

    public void setC(Integer c)
    {
        this.c = c;
    }

    public void setB(B b)
    {
        this.b = b;
    }
} 
```

我的“必须有更好的方法来做到这一点”的感觉非常刺痛。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T06:49:33.513

您可以覆盖您保存的根对象上的保存方法，并从那里调用您的计算方法。

对我来说，将业务计算隐藏到持久化流程中并不是一件好事，因为您确保每次都调用它，但是您将其隐藏到需要技术知识的流程中。

通过某种“calculateAndSave”方法显式调用这个计算方法，会更清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T06:43:51.480

另一种解决方案是强制hibernate通过getA方法获取a值

```
@Entity
public class A extends Model
{
    @OneToMany(mappedBy="a", cascade = CascadeType.ALL)
    private List<B> bList = new ArrayList<B>();
    @Transient
    private Integer a = 0;
    private Boolean calculated = false;

    @Access(AccessType.PROPERTY)
    public Integer getA()
    {
        if (!calculated) {
            Integer returnValue = 0;

            for(B b : bList)
            {
                returnValue = returnValue + b.getB();

                for(C c : b.getCList())
                {
                    returnValue = returnValue + c.getC();
                }
            }

            a = returnValue;
            calculated = true;
        }
        return a;
    }

    public void setBList(List<B> bList)
    {
        this.bList = bList;
        calculated = false;
    }

    public List<B> getBList()
    {
        return bList;
    }
} 
```

但这意味着你可以在每次计算源发生变化时使计算标志无效，这在 b 对象的 cList 发生变化时可能会很困难。

如果您的计算不是那么繁重，您也可以避免计算标志并在每次调用 getA 时重做这是最简单的解决方案，但不是最高性能

# php - 注销后重定向

> ID：13426634
> 
> 赞同：0
> 
> 时间：2012-11-17T01:07:35.960
> 
> 标签：php, redirect

当他注销时，我在将用户重定向到首页时遇到问题。我有一个 switch case 语句，处理注销的语句如下所示：

```
 case 'logout':
    offline($_SESSION['user_id']);
    session_destroy();
    include_once 'index.php';
    break; 
```

我认为包含 index.php 会将用户重定向到首页，因为这是会话时应该发生的情况。但页面只是空白，网址是 localhost/web//?a=logout。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T01:08:14.050

好吧，欧！我已经更新了我的答案，即使你没有要求它。所以，再次检查它

放`header('Location: http://site.com/index.php');`

使您的代码如下所示：

```
case 'logout':
    offline($_SESSION['user_id']);
    session_destroy();
  header('Location: http://site.com/index.php');
   exit();
    break; 
```

# php - Mysql where 查询... select * where field1 +field2 + field3 <= field 4

> ID：13426638
> 
> 赞同：-1
> 
> 时间：2012-11-17T01:08:29.210
> 
> 标签：php, mysql, sql, where

基本上我想将存储的数字相加`field1`，`field2`并且`field3`只显示该总数小于`field4`...的记录

例如：`select * from table where field1 + field2 + field3 <= field 4`

但这不起作用....任何帮助表示赞赏

这是我的实际 SQL，您可以看到它更复杂：

```
SELECT
  *,
  SUM ( amountpaid , amountpaid2 , amountpaid3 ) AS total AND
  DATE_FORMAT(date_start, ' %d.%m.%Y') AS date_formatted
FROM 
  calendar_event 
WHERE 
  Date_start BETWEEN NOW() AND DATE_ADD(NOW(), INTERVAL 14 DAY) AND 
  total <= amount ) 
```

抢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:39:18.960

也许你的意思是：

```
SELECT
    *,
    amountpaid + amountpaid2 + amountpaid3 AS total,
    DATE_FORMAT(date_start, '%d.%m.%Y') AS date_formatted
FROM calendar_event
WHERE Date_start BETWEEN NOW() AND DATE_ADD(NOW(), INTERVAL 14 DAY)
AND amountpaid + amountpaid2 + amountpaid3 <= amount 
```

假设您在 和 中有单独的付款，`amountpaid`这将为您提供在接下来的 14 天内开始且未多付的所有事件（即少付或完全支付）。`amountpaid2``amountpaid3`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:16:03.197

您的查询

```
select * from table where field1 + field2 + field3 <= field4 
```

应该工作得很好。确保您要寻址的所有列确实存在并且它们是数字的（整数、浮点数、双精度等）。还要确保，如果你真的这么称呼它，那么 field4 在“field”和“4”之间没有空格 - 在你的问题之间有一个空格，比如“field 4”而不是“field4”。

或者让我们知道您收到什么错误消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T01:36:53.773

```
Select
  *,
  Coalesce(amountpaid, 0) + Coalesce(amountpaid2, 0) + Coalesce(amountpaid3, 0) As total,
  DATE_FORMAT(date_start, ' %d.%m.%Y') As date_formatted
From
  calendar_event 
Where
  Date_start Between Now() And Date_Add(Now(), Interval 14 DAY) And
  Coalesce(amountpaid, 0) + Coalesce(amountpaid2, 0) + Coalesce(amountpaid3, 0) <= amount 
```

[http://sqlfiddle.com/#!2/35f6b/3](http://sqlfiddle.com/#!2/35f6b/3)

# c++ - strtok 或 std::istringstream

> ID：13426642
> 
> 赞同：0
> 
> 时间：2012-11-17T01:09:03.610
> 
> 标签：c++, strtok, istringstream

我有以下代码，它使用 strtok 从 txt 文件接收输入。txt文件中的输入为：

```
age, (4, years, 5, months)
age, (8, years, 7, months)
age, (4, years, 5, months) 
```

我的代码如下所示：

```
char * point;
ifstream file;
file.open(file.c_str());

if(file.is_open())
{
    while(file.good())
    {
        getline(file, take);
        point = strtok(&take[0], ", ()");
    }
} 
```

除了缺少第 2 代和第 3 代的输出外，它做得很好。谁能告诉我他们为什么失踪？

我也尝试过`istringstream`，但每当我输入我的文件名时，程序就会崩溃。

```
char * point;
char take[256];
ifstream file;
file.open(file.c_str());

if(file.is_open())
{
    while(file.good())
    {
        cin.getline(take, 256);
        point =strtok(take,", ()");
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T01:44:03.740

就个人而言，我会使用 an`std::istringstream`但我会以不同的方式使用它（......而且，是的，我知道我也可以使用`sscanf()`并且代码会更短，但我不喜欢类型不安全的接口）！我会和机械手玩花样：

```
#include <iostream>
#include <sstream>
#include <string>

template <char C>
std::istream& skip(std::istream& in)
{
    if ((in >> std::ws).peek() != std::char_traits<char>::to_int_type(C)) {
        in.setstate(std::ios_base::failbit);
    }
    return in.ignore();
}

std::istream& (*const comma)(std::istream&) = &skip<','>;
std::istream& (*const open)(std::istream&) = &skip<'('>;
std::istream& (*const close)(std::istream&) = &skip<')'>;

struct token
{
    token(std::string const& value): value_(value) {}
    std::string::const_iterator begin() const { return this->value_.begin(); }
    std::string::const_iterator end() const   { return this->value_.end(); }
    std::string value_;
};

std::istream& operator>> (std::istream& in, token const& t)
{
    std::istreambuf_iterator<char> it(in >> std::ws), end;
    for (std::string::const_iterator sit(t.begin()), send(t.end());
         it != end && sit != send; ++it, ++sit) {
        if (*it != *sit) {
            in.setstate(std::ios_base::failbit);
            break;
        }
    }
    return in;
}

int main()
{
    std::istringstream input("age, (4, years, 5, months)\n"
                             "age , ( 8 , years , 7, months )\n"
                             "age, (4, year, 5, months)\n"
                             "age, (4, years 5, months)\n"
                             "age (4, years, 5, months)\n"
                             "age, 4, years, 5, months)\n"
                             "age, (4, years, 5, months)\n");
    std::string dummy;
    int         year, month;
    for (std::string line; std::getline(input, line); ) {
        std::istringstream lin(line);
        if (lin >> token("age") >> comma
            >> open
            >> year >> comma >> token("years") >> comma
            >> month >> comma >> token("months") >> close) {
            std::cout << "year=" << year << " month=" << month << "\n";
        }
    }
} 
```

# c - 来自整数的 strdup 警告指针，不带强制转换

> ID：13426645
> 
> 赞同：1
> 
> 时间：2012-11-17T01:09:32.710
> 
> 标签：c, warnings

我正在使用函数“strdup”将 char* 插入 char** 并收到`search.c:174:13: warning: assignment makes pointer from integer without a cast [enabled by default]`警告。

```
char** temp;
...

temp = NULL;
...

temp[0] = strdup(tokens[i]); 
```

where`tokens[i]`只是`strtok()`函数中的一个字符串。

我不认为这是相关的，但我也有这个警告...... `search.c:174:5: warning: implicit declaration of function ‘strdup’ [-Wimplicit-function-declaration]`这只是因为我有 -ansi 标志并且我检查了该功能是否正常工作，我只是讨厌看到警告。

如果这个问题得到回答，我也很抱歉；有很多与此类似的问题，但没有一个对我有帮助，因为据我所知，我的类型是匹配的。（如果我收到警告，显然不是）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T01:11:33.297

> 我不认为这是相关的，但我也有这个警告...... search.c:174:5: 警告：函数“strdup”的隐式声明 [-Wimplicit-function-declaration]

这是相关的，两者都有相同的原因。范围内没有原型`strdup`，因此假定返回类型为`int`（在 C89/C90 中；隐式声明已在 C99 中删除，但默认情况下仍被广泛接受）。

您需要`#include <string.h>`并启用其中一个可以定义的功能测试宏`strdup`，例如`_XOPEN_SOURCE >= 500`or `_BSD_SOURCE`（甚至可能只有在没有 的情况下才能工作`-ansi`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-17T01:15:18.610

GCC 的`-ansi`标志为旧的 ISO C90 标准设置了兼容模式。`strdup`在该标准中没有定义；这是一个 POSIX 函数。要么摆脱`-ansi`用于编译严格符合 C90 的代码的标志，要么通过避免使用 POSIX API 来遵守标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T01:11:48.983

你可能忘记了`#include`一些文件。我的猜测是您应该在任何函数之前和源文件开头附近添加：

```
#include <string.h> 
```

# delphi - 代理设置 Chromium Embedded

> ID：13426649
> 
> 赞同：3
> 
> 时间：2012-11-17T01:09:48.907
> 
> 标签：delphi, tchromium

如何手动将代理设置 Ip:Port 设置为 Chromium Embedded。如果您为 IE 设置它，那只会影响控件而不是全局控件。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-12T07:09:13.607

在 CEF 3 中，您可以使用`--proxy-server`命令行开关。一个示例值是`socks5://127.0.0.1:8888`。您可以在`CefApp::OnBeforeCommandLineProcessing`. 在此回调名称中设置时不应包含`--`前缀。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T10:07:05.537

```
uses ceflib;

procedure AppCefGetProxyForUrl(const url: ustring; var proxyType: TCefProxyType;
  var proxyList: ustring );
begin
  proxyType := CEF_PROXY_TYPE_NAMED;
  proxyList := 'ip:port';
end;

initialization
  CefGetProxyForUrl := @AppCefGetProxyForUrl;

end. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-09T07:09:06.170

使用先前存在的类**CefProxyHandler**可以获得更大的控制。
最新的实现只使用命令行标志（我发现这些不太好）。[您可以在CEF 的旧 SVN 分支](https://code.google.com/p/chromiumembedded/source/browse/#svn%2Fbranches%2F1453%2Fcef1%2Finclude%253Fstate%253Dclosed)上找到以前的代码。

我已经以这种方式实现了（以下是 Windows 上的 C++ 说明——我不会粘贴太多代码，因为它可以从上面的 URL 中读取）： ——在其他 CEF 类示例（例如 CefApp）之后
实现导出的**CefProxyHandler类；**类有一个方法，*GetProxyForUrl*
- 在 cef_types.h 中定义**cef_proxy_type_t**枚举（直接，命名，PAC）和**cef_proxy_info_t**结构（包含类型和字符串列表）
- 在 cef_types_wrappers.h 中定义**CefProxyInfoTraits** over **cef_proxy_info_t**（遵循其他结构示例） , 和类**CefProxyInfo : public CefStructBase**
- 在 libcef/browser/browser_main.cc 中**PreMainMessageLoopRun**将**ProxyServiceFactory::CreateProxyConfigService**替换为**CefProxyServiceFactory::CreateProxyConfigService**；Cef 工厂将创建一个**CefProxyService**，最终创建一个**CefProxyConfigService** - 灵感来自*src/net/proxy/proxy_config_service_win.cc*实现类**CefProxyConfigServiceWin**；主要的是

```
static void GetCurrentProxyConfig(net::ProxyConfig* config) {
  CefRefPtr<CefApp> app = CefContentClient::Get()->application();
  if(app.get()) {
    CefRefPtr<CefProxyHandler> handler = app->GetProxyHandler();
    if(handler.get()) {
      // ... use handler->GetProxyForUrl etc.
    }
  }

  WINHTTP_CURRENT_USER_IE_PROXY_CONFIG ie_config = {0};
  if (!WinHttpGetIEProxyConfigForCurrentUser(&ie_config)) {
    LOG(ERROR) << "WinHttpGetIEProxyConfigForCurrentUser failed: " <<
      GetLastError();
    *config = net::ProxyConfig::CreateDirect();
    config->set_source(net::PROXY_CONFIG_SOURCE_SYSTEM_FAILED);
    return;
  }
  SetFromIEConfig(config, ie_config);
  FreeIEConfig(&ie_config);
} 
```

- 重新添加[旧版本](https://code.google.com/p/chromiumembedded/source/browse/branches/1364/cef1/libcef/browser_request_context.cc?r=1153)
中存在的 net::ProxyConfigServiceWin::set_force_auto_detect - 在 libcef/browser/url_request_context_getter.cc 中（从旧 CEF 分支中获得灵感）实现**ProxyConfigServiceNull：公共 net::ProxyConfigService**（全为空实现），**类 CefProxyResolver： public net::ProxyResolver**（这里是**GetProxyForUrl**所在的位置），并在**CefURLRequestContextGetter::GetURLRequestContext()**检查自定义代理处理程序，例如：

```
bool fCustomProxyHandler = false;
CefRefPtr<CefApp> app = CefContentClient::Get()->application();
if(app.get()) {
    CefRefPtr<CefProxyHandler> handler = app->GetProxyHandler();
    if(handler.get()) {
    #if defined(OS_WIN)
      // Force auto-detect so the client resolver will be called.
      net::ProxyConfigServiceWin::set_force_auto_detect(true);
    #endif
      // The client will provide proxy resolution.
      storage_->set_proxy_service(
          new net::ProxyService(
                                net::ProxyService::CreateSystemProxyConfigService(io_loop_->message_loop_proxy(), file_loop_), 
                                new CefProxyResolver(handler), 
                                NULL
                               )
      );
      fCustomProxyHandler = true;
    }
}
if(!fCustomProxyHandler) {
    //  custom proxy resolution not provided
    scoped_ptr<net::ProxyService> system_proxy_service;
    system_proxy_service.reset(
        ProxyServiceFactory::CreateProxyService(
            NULL,
            url_request_context_.get(),
            url_request_context_->network_delegate(),
            CefContentBrowserClient::Get()->proxy_config_service().release(),
            command_line));
    storage_->set_proxy_service(system_proxy_service.release());
} 
```

关键是提供 storage_->set_proxy_service 您自己的实现。最后要做的是提供 CefProxyHandler（以前的版本可以添加到 CefApp 或 CefClient 中，与生命周期处理程序、请求处理程序等类似）。上面的例子是从 CefApp 提供的。

最新的分支（2357，可能更低）在浏览器进程处理程序和应用程序之间分离得更多。这取决于您，所需要的只是通过可用的全局上下文获取器访问代理处理程序提供程序（通常是 CefApp），并从应用程序直接获取代理处理程序并调用 GetProxyHandler 或浏览器进程处理程序（如果您打算在那里添加代理获取器）， CefClient 等。之后，您可以轻松地让 GetProxyHandler 查询您的应用程序的代理设置（发布任务，如果您在 Windows 上，则使用 WaitForSingleObject 发布消息等），以便通过 GetProxyForUrl 检索代理服务器/端口/用户/密码。

这样做虽然不容易，但会为您提供完全的控制权 - 如果您愿意，您甚至可以处理*每个 url*的代理，在同一个浏览器/渲染器/插件中动态更改，而无需重新启动（请记住诸如挂起的下载甚至插件流式传输可能会受到影响）。

# floating-point - 如何获得双精度数据类型的容差范围？

> ID：13426651
> 
> 赞同：0
> 
> 时间：2012-11-17T01:10:10.133
> 
> 标签：floating-point, double, range

我有兴趣为双精度数据类型（8 字节，64 位）获得 e-8 的容差范围。

例如：0.123456782456789

我想得到小数点后 8 位以内的正负公差范围。

它们将是：
低范围 = 0.123456781456789

高范围 = 0.123456783456789

注意小数点后第 9 位的差异。

如果输入是以十六进制给出的双精度。我需要从十六进制中添加或减去什么？由于这是一个双精度字，它将包含 4 个数据字。我需要从第三个数据字中加/减 256（十进制）吗？

例如：

3FBF 9ADD 1B1F 0D35 是 0.123456782456789 的十六进制

那么......低和高范围会是：

3FBF 9ADD 1* *A* *1F 0D35

3FBF 9ADD 1* *C* *1F 0D35

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T13:45:21.103

^(要计算包含 x 的 |x|•10 -8)内的点的区间 [a, b] ，请设置 a 和 b：

```
double t = fabs(x) * 1e-8;
double a = x-t;
double b = x+t; 
```

这是近似值，因为舍入误差可能会使 a 或 b 稍微不准确。如果您希望区间绝对包含所有点，您可以使用比 略高的值`1e-8`，或者您可以使用更高级的技术。

一些警告：

如果您使用区间作为测试的一部分来确定某个计算值是否“几乎等于”另一个值，那么确定区间**必须**有多大需要分析所使用的浮点运算和所涉及的值。浮点值可能会产生从零到无穷大的误差，具体取决于具体情况。不可能说明任何单一量的公差在所有情况下都有用，甚至在“典型”情况下也是如此。

确定间隔**可能**有多大需要确定您的应用程序可以接受哪些错误。接受不相等的值以允许计算错误意味着您的程序有时会接受真正不相等的相等值（如果计算准确，没有错误）。因此，在程序产生不可接受的结果之前，您需要弄清楚间隔可以有多大。

显然，如果间隔**必须**大于它**可能**的值，那么你的程序就坏了；这种间隔的使用是行不通的。在这种情况下，您必须重新设计浮点运算以减少错误或重新设计程序以避免这种情况。

使用浮点数的表示来读取或更改其值通常是一个坏主意。这样做需要仔细注意编译器或平台规范的细节。（特别是，看起来在测试中工作的代码，实际上可能在编译器不支持的意义上被破坏，并且如果使用不同版本的编译器或编译开关（例如用于调试和优化，已更改。）此外，访问浮点数表示的代码通常不可移植。（最值得注意的是，一些平台以“小端”顺序存储 double 的字节，而一些平台以“大端”顺序存储字节。还有其他可移植性问题。）即使正确编写代码以访问一个浮点数，

对于大至 10 ^(-8)`1e-8`的容差，用于计算区间可能就足够了。也就是说，您可以使用普通的浮点运算，而不必计算浮点数的 ULP 或访问其表示。但是，如果您确实想要计算 IEEE-754 浮点数的 ULP，则可以使用[此答案](https://stackoverflow.com/a/11884400/298225)中的代码来执行此操作，而无需访问其表示。该代码是为`float`而不是编写的`double`，但您可以更改`FLT`为`DBL`以更改它使用的常量。当然也改成`float`。`double`

# symfony - 在 Doctrine 2 中更新（从反面）双向多对多关系？

> ID：13426653
> 
> 赞同：7
> 
> 时间：2012-11-17T01:10:40.707
> 
> 标签：symfony, orm, doctrine, doctrine-orm, symfony-2.1

`Customer`是“关键字/客户”关系的反面`Keyword`：

```
/**
 * @ORM\ManyToMany(targetEntity="Keyword", mappedBy="customers",
 *     cascade={"persist", "remove"}
 * )
 */
protected $keywords; 
```

创建新客户时，应选择一个或多个关键字。实体表单字段为：

```
$form->add($this->factory->createNamed('entity', 'keywords', null, array(
    'class'    => 'Acme\HelloBundle\Entity\Keyword',
    'property' => 'select_label',
    'multiple' => true,
    'expanded' => true,
))); 
```

在我的控制器代码中，绑定请求并检查表单是否有效后，我需要保留客户和所有客户/关键字关联，即连接表。

但是客户是反面，所以这是行不通的：

```
if($request->isPost()) {
    $form->bindRequest($request);

    if(!$form->isValid()) {
        return array('form' => $form->createView());
    }

    // Valid form here   
    $em = $this->getEntityManager();

    $em->persist($customer);    
    $em->flush();
} 
```

带有“级联”选项的事件，此代码失败。`$customer->getKeywords()`将返回`Doctrine\ORM\PersistentCollection`，其中仅包含选定的关键字。

我是否应该手动检查删除/添加了哪个关键字，然后从拥有方更新？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-17T03:24:00.993

好的，找到了方法，即使我并不完全满意。关键是[这个示例](http://symfony.com/doc/2.0/cookbook/form/form_collections.html)表单集合字段类型。基本上，我之前的表单定义发生的情况是：

```
$customer->getKeywords() = $postData; // $postData is somewhere in form framework 
```

这只是将（选定关键字的）集合分配给客户关键字。`Keyword`没有在实例（拥有方）上调用任何方法。关键选项是`by_reference`（对我来说这只是一个坏名字，但无论如何......）：

```
$form
    ->add($this->factory->createNamed('entity', 'keywords', null, array(
        // ...
        'by_reference' => false
    ))
); 
```

这样表单框架将调用 setter，即`$customer->setKeywords(Collection $keywords)`. 在该方法中，您可以“告诉”拥有方存储您的关联：

```
public function setKeywords(Collection $keywords)
{
    foreach($keywords as $keyword) {
        $keyword->addCustomer($this); // Owning side call!
    }

    $this->keywords = $keywords;

    return $this;
} 
```

（始终使用方法检查拥有方的重复实例`contains`）。

此时，只会添加选中的关键字（`$keyword`参数）。需要管理删除未经检查的关键字（控制器端）：

```
$originalKeywords = $customer->getKeywords()->toArray(); // When GET or POST

// When POST and form valid
$checkedKeywords = $customer->getKeywords()->toArray(); // Thanks to setKeywords

// Loop over all keywords
foreach($originalKeywords as $keyword) {
    if(!in_array($keyword, $checkedKeywords)) { // Keyword has been unchecked
        $keyword->removeCustomer($customer);
        $manager->persist($keyword);
    }
} 
```

丑陋，但有效。我会将删除代码移到`Customer`课堂上，但这根本不可能。如果您能找到更好的解决方案，请告诉我！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-07-14T09:21:53.090

我使用的解决方案与@gredmo 略有不同。从[学说文档](http://doctrine-orm.readthedocs.org/en/latest/reference/working-with-associations.html#orphan-removal)中：当您满足此假设时，您可以使用 Orphan Removal ：

> 当使用`orphanRemoval=true`选项 Doctrine 时，假设实体是私有的，**不会**被其他实体重用。如果您忽略此假设，即使您将孤立实体分配给另一个实体，您的实体也会被 Doctrine 删除。

我有这个实体类：

```
class Contract {
/**
 * @ORM\OneToMany(targetEntity="ContractParticipant", mappedBy="contract", cascade={"all"}, orphanRemoval=true)
 **/
}
protected $participants; 
```

表单处理（伪代码）：

```
 // $_POST carry the Contract entity values

    $received = [];

    foreach ($_POST['participants'] as $key => $participant) {

        if ((!$relation = $collection->get($key))) {
            // new entity
            $collection[$key] = $relation = $relationMeta->newInstance();

        } else {
            // editing existing entity
        }

        $received[] = $key;
        $this->mapper->save($relation, $participant);   // map POST data to entity
    }

    foreach ($collection as $key => $relation) {
        if ($this->isAllowedRemove() && !in_array($key, $received)) {
            // entity has been deleted
            unset($collection[$key]);
        }
    } 
```

不要忘记持久化实体结束刷新。Flush 还会删除已删除的实体。

```
 $this->em->persist($entity);
    $this->em->flush(); 
```

# sql - 对另一个日期范围内的日期范围求和

> ID：13426661
> 
> 赞同：1
> 
> 时间：2012-11-17T01:11:36.253
> 
> 标签：sql, sql-server, sql-server-2008, datetime, logic

尝试在 SQL 中针对以下内容编写查询：**事件**具有开始/结束日期/时间。**用户**在特定时间可用。如何找到用户可参加特定活动的总时间？

例子：

```
--Event--
eventID eventStart          eventEnd
1       2012-10-10 15:00    2012-10-10 18:00

--Available--
userID  availStart          availEnd
64      2012-10-10 10:00    2012-10-10 16:00
64      2012-10-10 16:30    2012-10-10 16:40
64      2012-10-10 16:55    2012-10-10 22:00 
```

用户免费使用 135 分钟（15:00-16:00 60 分钟，16:30-16:40 10 分钟，16:55-18:00 65 分钟）。

一些编写 SQL 的帮助会非常有帮助，发现这个很棘手！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T02:20:15.867

现在测试它：[http ://sqlfiddle.com/#!3/a4e7a/2](http://sqlfiddle.com/#!3/a4e7a/2)

我假设有一个用户表。性能提升的空间很大。例如，通过添加一个 where 子句来消除不重叠的范围。如果用可怕的 case 语句替换函数，它可能也会更快。

棘手的一点是要弄清楚两个时间跨度中有多少重叠的算法。我总是发现绘制案例图片很有用：

```
Case 1
|------|
         |=======|

Case 2
|------|
     |======|

Case 3
|-------|
  |===| 
```

和顺序相反的等价物。

事实证明，重叠是两个结束时间的最小值减去两个开始时间的最大值。（如果为负，则没有重叠）。我总是必须检查所有案例以重新说服自己这一点。

```
-- Function that determines how many minutes of overlap there are between two timespans
Create Function dbo.MinutesOverlap(
  @Start1 as datetime, @End1 as datetime, @Start2 as datetime, @End2 as datetime
) Returns int As
Begin
  Declare 
    @MaxStart As datetime,
    @MinEnd As datetime,
    @Ret int = 0

  Set @MaxStart = Case When @Start1 > @Start2 Then @Start1 Else @Start2 End
  Set @MinEnd = Case When @End1 > @End2 Then @End2 Else @End1 End

  If @MaxStart < @MinEnd
    Set @Ret = DateDiff(Minute, @MaxStart, @MinEnd)

  Return @Ret
End

Select
  u.UserID,
  e.EventID,
  Sum(dbo.MinutesOverlap(e.eventStart, e.eventEnd, a.availStart, a.availEnd))
From
  Event e
    Cross Join
  User u
    Left Outer Join
  Available a
    On u.UserID = a.UserID
Group By
  u.UserID, 
  e.EventID 
```

# ssh - SSH 密钥是否只能在生成它们的机器上工作

> ID：13426662
> 
> 赞同：-1
> 
> 时间：2012-11-17T01:11:40.270
> 
> 标签：ssh, public-key-encryption

假设我们正在连接到 Rackspace 上的服务器，并使用我的用户名 Justin 在我的 MacBook Pro 上生成一个公共 SSH 密钥。然后，我们将 Justin 的公共 SSH 密钥添加到 Rackspace 上的服务器，然后我们现在可以无需密码即可连接。

如果我将 Justin 的 SSH 公钥放在我的 iMac 上，然后尝试从这台新计算机连接到 Rackspace 服务器，会发生什么情况？这仍然有效吗？

如果不是，如果我回到我的 MacBook Pro，但不是以 Justin 身份登录，而是以 Mike 身份登录，并尝试使用 Justin 的公共 SSH 密钥从 Mike 的帐户连接到 Rackspace 服务器，那该怎么办。又会发生什么？

基本上，SSH 密钥是否仅适用于生成它们的机器和帐户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T01:22:12.177

不，它们与计算机无关。

无论如何，您都应该重新生成一个新的 ssh 密钥，以便在您的计算机被盗时禁用它。如果你丢失了你的唯一的 SSH 密钥，那真的很糟糕。

# php - PHP App 在本地主机上完美运行，在任何 Web 服务器上完全失败并出现一些奇怪的错误

> ID：13426666
> 
> 赞同：0
> 
> 时间：2012-11-17T01:12:43.413
> 
> 标签：php, syntax-error

我设计了一个非常简单的 PHP 应用程序。在本地主机（XAMPP / Windows 7）上完美运行，并且在我上传到的任何 Web 服务器上完全失败。失败期间显示的错误对我没有任何影响。

无论服务器配置是什么（经过多次测试），任何运行应用程序的尝试都以以下任一方式结束：

*   PHP错误：`unexpected T_STRING in .../template/template.html on line 1`，
*   HTTP 错误 500: `Internal Server Error`,
*   空页面（假设，错误报告已禁用）。

File`template/template.html`只是一个普通的 XHTML 文件，具有正确的标题、正文和结构，包含一些简单的 PHP 语句。`require`我在以下函数中加载并解析它：

```
public static function renderPartial($view, $data = array())
{
    if(is_file($view))
    {
        if(is_array($data)) extract($data, EXTR_PREFIX_SAME, 'data');

        ob_start(); 
        ob_implicit_flush(false); 

        require($view);

        return ob_get_clean();
    }
    else die('File <strong>"'.$view.'"</strong> does not exist!');
} 
```

这是我自己的，非常简单的函数版本，在 Yii（可能还有许多其他框架）中用于渲染视图、子视图或模板。我在我的应用程序的许多地方都使用它，它在本地主机上就像一个魅力。

~~如果有人想检查，那么[这里](http://gaman.pl/pgb/)是（应该是）实时版本，而[这里](http://gaman.pl/pgb/pgb.zip)是从我在 localhost 上的本地工作副本中提取的包含 SVN 导出版本的压缩存档，在这里工作就像做梦一样。~~（问题已解决——示例已删除）

我开发了很多 PHP 应用程序，无论是纯 PHP 还是使用 Yii 框架，这是我第一次遇到这种情况，所以我感到非常震惊和失落。到目前为止，在我的本地主机 (XAMPP) 上运行且没有错误的每个应用程序也在任何虚拟主机上运行而没有任何问题。

非常感谢任何想法或帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:36:02.580

检查您的 Apache 服务器是否设置为允许`<? ?>`PHP 使用短标签 ( )，因为 template.html 的第一行有短标签（文档中的其他标签都是长标签`<?php ?>`）。此外，您错过了同一文件中第 27 行的分号，在 echo 命令的末尾，应该是`<?php echo($alert); ?>`. 不知道是否有帮助，但以防万一。

问候， 海华沙

# excel - excel - 从单元格值中查找和替换多个文本

> ID：13426671
> 
> 赞同：3
> 
> 时间：2012-11-17T01:13:31.187
> 
> 标签：excel, vba

我有一个带有模板数据的 Excel 表。我希望能够`A1:A5`用我`B1:B5`在文档的其余部分输入的内容替换出现的单词。

现在我要离开这个（而且我不太了解`VBA`）：

```
Sub UpdatePartial()
With ActiveSheet.UsedRange
.Replace "ZIPCODE", "B1", xlPart
.Replace "NAME", "B2", xlPart
.Replace "CITY", "B3", xlPart
.Replace "STATE", "B4", xlPart
.Replace "PHONE", "B5", xlPart
End With
End Sub 
```

但我想用`A`s 的内容`B1-B5`代替文字*"B1","B2", ..., "B5"*等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:20:21.987

而不是

`.Replace "ZIPCODE", "B1", xlPart`
采用
`.Replace [a1].Value, [b1].Value, xlPart`

如果您只想替换单元格内的整个单词（即，如果您想用*dog替换**cat*但避免将*catscan*更改为*dogscan* ，则在字符串之前或之后构建空格检查）

 ***采用
`.Replace " " & [a1].Value, " " & [b1].Value, xlPart`
`.Replace [a1].Value & " ", [b1].Value & " ", xlPart`

**您更新的问题**

```
Sub UpdatePartial()
    Dim rng1 As Range
    ActiveSheet.UsedRange
    Set rng1 = Intersect(ActiveSheet.UsedRange, Range(Cells(6, "a"), Cells(ActiveSheet.UsedRange.Rows.Count, ActiveSheet.UsedRange.Columns.Count)))
    With rng1
        .Replace [a1].Value, [b1].Value, xlPart
    End With
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:22:16.777

您将能够引用单元格（地址）值

```
Range("B1").value 
```***

# c++ - ＃包括 导致很多' ' 尚未声明错误

> ID：13426672
> 
> 赞同：4
> 
> 时间：2012-11-17T01:13:41.397
> 
> 标签：c++, linux, std, gcc4.7

我正在尝试编译我的“图形”引擎，但在包含`<string>`（Debian 测试 64 位）之后遇到了问题。

这是错误：

```
jarrett@jarrett-g74s:~/projects/icebreak/ice_engine$ scons
scons: Reading SConscript files ...
scons: done reading SConscript files.
scons: Building targets ...
g++ -o build/engine/gui/GUI.o -c -I"../lwis/src/engine" src/engine/gui/GUI.cpp
In file included from /usr/include/c++/4.7/bits/postypes.h:42:0,
                 from /usr/include/c++/4.7/bits/char_traits.h:42,
                 from /usr/include/c++/4.7/string:42,
                 from src/engine/gui/GUI.h:11,
                 from src/engine/gui/GUI.cpp:14:
/usr/include/c++/4.7/cwchar:66:11: error: ‘::mbstate_t’ has not been declared
/usr/include/c++/4.7/cwchar:141:11: error: ‘::wint_t’ has not been declared
/usr/include/c++/4.7/cwchar:143:11: error: ‘::btowc’ has not been declared
/usr/include/c++/4.7/cwchar:144:11: error: ‘::fgetwc’ has not been declared
/usr/include/c++/4.7/cwchar:145:11: error: ‘::fgetws’ has not been declared
/usr/include/c++/4.7/cwchar:146:11: error: ‘::fputwc’ has not been declared
/usr/include/c++/4.7/cwchar:147:11: error: ‘::fputws’ has not been declared
/usr/include/c++/4.7/cwchar:148:11: error: ‘::fwide’ has not been declared
/usr/include/c++/4.7/cwchar:149:11: error: ‘::fwprintf’ has not been declared
/usr/include/c++/4.7/cwchar:150:11: error: ‘::fwscanf’ has not been declared
/usr/include/c++/4.7/cwchar:151:11: error: ‘::getwc’ has not been declared
/usr/include/c++/4.7/cwchar:152:11: error: ‘::getwchar’ has not been declared
/usr/include/c++/4.7/cwchar:153:11: error: ‘::mbrlen’ has not been declared
/usr/include/c++/4.7/cwchar:154:11: error: ‘::mbrtowc’ has not been declared
/usr/include/c++/4.7/cwchar:155:11: error: ‘::mbsinit’ has not been declared
/usr/include/c++/4.7/cwchar:156:11: error: ‘::mbsrtowcs’ has not been declared
/usr/include/c++/4.7/cwchar:157:11: error: ‘::putwc’ has not been declared
/usr/include/c++/4.7/cwchar:158:11: error: ‘::putwchar’ has not been declared
/usr/include/c++/4.7/cwchar:160:11: error: ‘::swprintf’ has not been declared
/usr/include/c++/4.7/cwchar:162:11: error: ‘::swscanf’ has not been declared
/usr/include/c++/4.7/cwchar:163:11: error: ‘::ungetwc’ has not been declared
/usr/include/c++/4.7/cwchar:164:11: error: ‘::vfwprintf’ has not been declared
/usr/include/c++/4.7/cwchar:166:11: error: ‘::vfwscanf’ has not been declared
/usr/include/c++/4.7/cwchar:169:11: error: ‘::vswprintf’ has not been declared
/usr/include/c++/4.7/cwchar:172:11: error: ‘::vswscanf’ has not been declared
/usr/include/c++/4.7/cwchar:174:11: error: ‘::vwprintf’ has not been declared
/usr/include/c++/4.7/cwchar:176:11: error: ‘::vwscanf’ has not been declared
/usr/include/c++/4.7/cwchar:178:11: error: ‘::wcrtomb’ has not been declared
/usr/include/c++/4.7/cwchar:179:11: error: ‘::wcscat’ has not been declared
/usr/include/c++/4.7/cwchar:180:11: error: ‘::wcscmp’ has not been declared
/usr/include/c++/4.7/cwchar:181:11: error: ‘::wcscoll’ has not been declared
/usr/include/c++/4.7/cwchar:182:11: error: ‘::wcscpy’ has not been declared
/usr/include/c++/4.7/cwchar:183:11: error: ‘::wcscspn’ has not been declared
/usr/include/c++/4.7/cwchar:184:11: error: ‘::wcsftime’ has not been declared
/usr/include/c++/4.7/cwchar:185:11: error: ‘::wcslen’ has not been declared
/usr/include/c++/4.7/cwchar:186:11: error: ‘::wcsncat’ has not been declared
/usr/include/c++/4.7/cwchar:187:11: error: ‘::wcsncmp’ has not been declared
/usr/include/c++/4.7/cwchar:188:11: error: ‘::wcsncpy’ has not been declared
/usr/include/c++/4.7/cwchar:189:11: error: ‘::wcsrtombs’ has not been declared
/usr/include/c++/4.7/cwchar:190:11: error: ‘::wcsspn’ has not been declared
/usr/include/c++/4.7/cwchar:191:11: error: ‘::wcstod’ has not been declared
/usr/include/c++/4.7/cwchar:193:11: error: ‘::wcstof’ has not been declared
/usr/include/c++/4.7/cwchar:195:11: error: ‘::wcstok’ has not been declared
/usr/include/c++/4.7/cwchar:196:11: error: ‘::wcstol’ has not been declared
/usr/include/c++/4.7/cwchar:197:11: error: ‘::wcstoul’ has not been declared
/usr/include/c++/4.7/cwchar:198:11: error: ‘::wcsxfrm’ has not been declared
/usr/include/c++/4.7/cwchar:199:11: error: ‘::wctob’ has not been declared
/usr/include/c++/4.7/cwchar:200:11: error: ‘::wmemcmp’ has not been declared
/usr/include/c++/4.7/cwchar:201:11: error: ‘::wmemcpy’ has not been declared
/usr/include/c++/4.7/cwchar:202:11: error: ‘::wmemmove’ has not been declared
/usr/include/c++/4.7/cwchar:203:11: error: ‘::wmemset’ has not been declared
/usr/include/c++/4.7/cwchar:204:11: error: ‘::wprintf’ has not been declared
/usr/include/c++/4.7/cwchar:205:11: error: ‘::wscanf’ has not been declared
/usr/include/c++/4.7/cwchar:206:11: error: ‘::wcschr’ has not been declared
/usr/include/c++/4.7/cwchar:207:11: error: ‘::wcspbrk’ has not been declared
/usr/include/c++/4.7/cwchar:208:11: error: ‘::wcsrchr’ has not been declared
/usr/include/c++/4.7/cwchar:209:11: error: ‘::wcsstr’ has not been declared
/usr/include/c++/4.7/cwchar:210:11: error: ‘::wmemchr’ has not been declared
/usr/include/c++/4.7/cwchar:250:11: error: ‘::wcstold’ has not been declared
/usr/include/c++/4.7/cwchar:259:11: error: ‘::wcstoll’ has not been declared
/usr/include/c++/4.7/cwchar:260:11: error: ‘::wcstoull’ has not been declared
/usr/include/c++/4.7/cwchar:266:11: error: ‘::__gnu_cxx’ has not been declared
/usr/include/c++/4.7/cwchar:267:11: error: ‘::__gnu_cxx’ has not been declared
/usr/include/c++/4.7/cwchar:268:11: error: ‘::__gnu_cxx’ has not been declared
In file included from /usr/include/c++/4.7/string:42:0,
                 from src/engine/gui/GUI.h:11,
                 from src/engine/gui/GUI.cpp:14:
/usr/include/c++/4.7/bits/char_traits.h:65:15: error: ‘mbstate_t’ in namespace ‘icee::engine::std’ does not name a type
In file included from /usr/include/c++/4.7/ext/new_allocator.h:34:0,
                 from /usr/include/c++/4.7/x86_64-linux-gnu/bits/c++allocator.h:34,
                 from /usr/include/c++/4.7/bits/allocator.h:48,
                 from /usr/include/c++/4.7/string:43,
                 from src/engine/gui/GUI.h:11,
                 from src/engine/gui/GUI.cpp:14:
/usr/include/c++/4.7/new:94:41: error: ‘void* icee::engine::operator new(icee::engine::std::size_t)’ may not be declared within a namespace
/usr/include/c++/4.7/new:96:41: error: ‘void* icee::engine::operator new [](icee::engine::std::size_t)’ may not be declared within a namespace
/usr/include/c++/4.7/new:98:41: error: ‘void icee::engine::operator delete(void*)’ may not be declared within a namespace
/usr/include/c++/4.7/new:100:41: error: ‘void icee::engine::operator delete [](void*)’ may not be declared within a namespace
/usr/include/c++/4.7/new:102:41: error: ‘void* icee::engine::operator new(icee::engine::std::size_t, const icee::engine::std::nothrow_t&)’ may not be declared within a namespace
/usr/include/c++/4.7/new:104:41: error: ‘void* icee::engine::operator new [](icee::engine::std::size_t, const icee::engine::std::nothrow_t&)’ may not be declared within a namespace
/usr/include/c++/4.7/new:106:41: error: ‘void icee::engine::operator delete(void*, const icee::engine::std::nothrow_t&)’ may not be declared within a namespace
/usr/include/c++/4.7/new:108:41: error: ‘void icee::engine::operator delete [](void*, const icee::engine::std::nothrow_t&)’ may not be declared within a namespace
/usr/include/c++/4.7/new:111:51: error: ‘void* icee::engine::operator new(icee::engine::std::size_t, void*)’ may not be declared within a namespace
/usr/include/c++/4.7/new:113:53: error: ‘void* icee::engine::operator new [](icee::engine::std::size_t, void*)’ may not be declared within a namespace
/usr/include/c++/4.7/new:117:45: error: ‘void icee::engine::operator delete(void*, void*)’ may not be declared within a namespace
/usr/include/c++/4.7/new:118:45: error: ‘void icee::engine::operator delete [](void*, void*)’ may not be declared within a namespace
In file included from /usr/include/c++/4.7/x86_64-linux-gnu/bits/c++locale.h:42:0,
                 from /usr/include/c++/4.7/bits/localefwd.h:42,
                 from /usr/include/c++/4.7/string:45,
                 from src/engine/gui/GUI.h:11,
                 from src/engine/gui/GUI.cpp:14:
/usr/include/c++/4.7/clocale:55:11: error: ‘::lconv’ has not been declared
/usr/include/c++/4.7/clocale:56:11: error: ‘::setlocale’ has not been declared
/usr/include/c++/4.7/clocale:57:11: error: ‘::localeconv’ has not been declared
In file included from /usr/include/c++/4.7/bits/localefwd.h:44:0,
                 from /usr/include/c++/4.7/string:45,
                 from src/engine/gui/GUI.h:11,
                 from src/engine/gui/GUI.cpp:14:
/usr/include/c++/4.7/cctype:66:11: error: ‘::isalnum’ has not been declared
/usr/include/c++/4.7/cctype:67:11: error: ‘::isalpha’ has not been declared
/usr/include/c++/4.7/cctype:68:11: error: ‘::iscntrl’ has not been declared
/usr/include/c++/4.7/cctype:69:11: error: ‘::isdigit’ has not been declared
/usr/include/c++/4.7/cctype:70:11: error: ‘::isgraph’ has not been declared
/usr/include/c++/4.7/cctype:71:11: error: ‘::islower’ has not been declared
/usr/include/c++/4.7/cctype:72:11: error: ‘::isprint’ has not been declared
/usr/include/c++/4.7/cctype:73:11: error: ‘::ispunct’ has not been declared
/usr/include/c++/4.7/cctype:74:11: error: ‘::isspace’ has not been declared
/usr/include/c++/4.7/cctype:75:11: error: ‘::isupper’ has not been declared
/usr/include/c++/4.7/cctype:76:11: error: ‘::isxdigit’ has not been declared
/usr/include/c++/4.7/cctype:77:11: error: ‘::tolower’ has not been declared
/usr/include/c++/4.7/cctype:78:11: error: ‘::toupper’ has not been declared
src/engine/gui/GUI.cpp:16:1: error: ‘GUI’ does not name a type
src/engine/gui/GUI.cpp:20:1: error: ‘GUI’ does not name a type
src/engine/gui/GUI.cpp:24:5: error: ‘GUI’ has not been declared
src/engine/gui/GUI.cpp:32:6: error: ‘GUI’ has not been declared
src/engine/gui/GUI.cpp:36:6: error: ‘GUI’ has not been declared
src/engine/gui/GUI.cpp:40:1: error: ‘GUIComponent’ does not name a type
scons: *** [build/engine/gui/GUI.o] Error 1
scons: building terminated because of errors. 
```

是`GUI.h`：

```
#ifndef GUI_H_
#define GUI_H_

#include <string>

#include "IGUI.h"

namespace icee {

namespace engine {

class GUI : public IGUI {
public:
    GUI();
    virtual ~GUI();

    virtual int initialize();
    virtual void destroy();

    virtual void render();
    virtual IGUIComponent* load(std::string filename);
};

}

}

#endif /* GUI_H_ */ 
```

并且`GUI.cpp`是：

```
namespace icee {

namespace engine {

#include <berkelium/Berkelium.hpp>

#include "GUI.h"

GUI::GUI() {

}

GUI::~GUI() {

}

int GUI::initialize() {
    if (!Berkelium::init(Berkelium::FileString::empty())) {
        return -1;
    }

    return 0;
}

void GUI::destroy() {

}

void GUI::render() {

}

GUIComponent* GUI::load(std::string filename) {

}

}

} 
```

`IGUI.h`看起来像这样：

```
#ifndef IGUI_H_
#define IGUI_H_

#include <string>

#include "IGUIComponent.h"

namespace icee {

namespace engine {

class IGUI {
public:
    IGUI();
    virtual ~IGUI();

    virtual int initialize() = 0;
    virtual void destroy() = 0;

    virtual void render() = 0;
    virtual IGUIComponent* load(std::string filename) = 0;
};

}

}

#endif /* IGUI_H_ */ 
```

到目前为止，我有点难过。我尝试安装 build-essentials，但它已经安装了。经过一番谷歌搜索后，问题似乎是某处缺少一些依赖项，但我不知道在哪里......

有人有想法么？

干杯

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-17T01:18:03.573

您的问题是包含**在哪里**：

```
namespace icee {

namespace engine {

#include <berkelium/Berkelium.hpp>

#include "GUI.h" 
```

将它们移出命名空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T01:17:57.517

原来我只是个白痴 - 我`GUI.cpp`在命名空间范围内包含了...我将它们移到上面并且它工作正常。

:\

# java - 代码输出默认值而不是用户输入值

> ID：13426682
> 
> 赞同：-2
> 
> 时间：2012-11-17T01:16:20.027
> 
> 标签：java, object

```
package homework4;

public class CreditCardNumber {
private String issuerID = "000000";
private String accountNum = "999999999";
private int checkDigit = 0;

public CreditCardNumber(String TempissuerID, String TempaccountNum)
{
    if(TempissuerID != null && TempaccountNum != null && TempissuerID.length() == 6 && TempaccountNum.length() == 9)
        if(Digits(TempissuerID) && Digits(TempaccountNum))
        {
            issuerID = TempissuerID;
            accountNum = TempaccountNum;
            calcCheckDigits();
        }

}

public boolean Digits(String temp1)
{
    String temp = "0123456789";
    int count = 0;
    for(int i = 0; i < temp1.length();i++)
        for(int j = 0; j < temp.length();j++)
            if(temp1.charAt(i) != temp.charAt(j))
            {
                count++;

            }
    if(count == temp1.length()){
        return true;
    }
    return false;
}

public CreditCardNumber(){}

public String getID()
{
    return issuerID;
}

public String getAccNum()
{
    return accountNum;
}

public int getDigits()
{
    return checkDigit;
}

private void calcCheckDigits()
{
    int sum;
    sum = checkSum();
    if((sum + checkDigit) % 10 != 0)    
    {
        checkDigit = sum - (sum % 10);
    }

}

public void CreateCred(String TempissuerID)
{
    if(TempissuerID != null && TempissuerID.length() ==6 && Digits(TempissuerID))
    {
        issuerID = TempissuerID;
    }
    else 
    {
        issuerID = "000000";
    }
    StringBuilder TempString = new StringBuilder();
    for(int i = 0; i < 9 ; i++)
    {
        TempString = TempString.append((Math.random()*(9-0+1)+0));
        System.out.printf("%d",TempString);
    }
    accountNum = TempString.toString();
    calcCheckDigits();
}

 private int checkSum()
 {       StringBuilder temp = new StringBuilder();
         int num;
         int sum =0;
         for(int i = 0 ; i <issuerID.length();i++)
         {
                 temp.append(issuerID.length());
                 for(int j = 0 ; j < accountNum.length(); j++)

                 temp.append(accountNum.length());
         }
         for(int k = 0 ; k < temp.length(); k +=2)
         {
                 num = temp.charAt(k) - '0';
                 num *=2;
                 if(num > 9)
                   num = 1 + (num % 10);
                 temp.setCharAt(k, (char) num);
         }
         for(int v = 0 ; v < temp.length(); v++)
         {
                 sum += temp.charAt(v) - '0';
         }

         return sum;
 }

 public String toString()
 {      
     return issuerID + accountNum + checkDigit;

 }
} 
```

// 在另一个文件中

```
package homework4;
import java.util.Scanner;
public class Prog4 {

public static void main(String[] args)
{   CreditCardNumber[] cred1;
    CreditCardNumber cred2 = getInput();
    Display(cred2);
    cred1 = getInputArray();
}

public static CreditCardNumber getInput() {
    String ID;
    String accNum;
    CreditCardNumber tempCred;      
    Scanner scanner = new Scanner(System.in);
    System.out.printf("Please enter issuer ID:");
    ID = scanner.next();
    System.out.printf("Please enter account number:");
    accNum = scanner.next();
    tempCred = new CreditCardNumber(ID, accNum);
    return tempCred;
}
public static void Display(CreditCardNumber cred2)
{

    System.out.printf("The complete number from your input:");
    System.out.println(cred2);
    return;

}

public static CreditCardNumber[] getInputArray()
{
    CreditCardNumber[] tempArray;
    String tempID;
    int size;
    Scanner scanner = new Scanner(System.in);
    System.out.printf("Please enter size of the aray:");
    size = scanner.nextInt();
    if(size < 1)
    {
        size = 1;
    }
    tempArray = new CreditCardNumber[size];
    System.out.printf("Please enter issuer ID:");
    tempID = scanner.next();
    for(int i = 0; i < size; i++)
    {

    }

    return tempArray;
}

} 
```

嗨，我对 main 中的 getInput 方法有疑问，当我编译代码并运行它时，输出是

```
enter issuer ID:321321
Please enter account number:654654654
The complete number from your input:0000009999999990 
```

这是 CreditCardNumber 类中 issuerId 和 acountNum 的默认值

但我想要的是这个输出

```
Enter a credit card issuer number: 321321
Enter an account number: 654654654
The complete number from your input: 
3213 2165 4654 6549 
```

每个 4 个字符之间有 4 个空格，为什么我的代码输出默认值而不是用户输入值？

谁能告诉我代码或 getinput() 函数有什么问题？

预先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:22:16.737

`if(temp1.charAt(i) != temp.charAt(j))`应该`if(temp1.charAt(i) == temp.charAt(j))`在`public boolean Digits(String)`.

您将字符列入白名单，因此您应该计算匹配的字符，而不是*不*匹配的字符。

另一种验证字符串是否由至少一个数字组成的方法：

```
public boolean Digits(String str) {
    for(int i = 0; i < str.length(); i++)
        if(str.charAt(i) < '0' || str.charAt(i) > '9')
            return false;
    return str.length() > 0;
} 
```

没有测试过这个，但它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:31:53.697

我刚刚调试了您的代码，您的 digit 方法为此特定输入返回 false ，这将使构造函数中的 if 条件失败，因此它仍将保留默认值。

只需使用正则表达式来检查传递的字符串是否为数字。

更改您的 Digits 方法，如下所示。

```
 public boolean Digits(String temp1)
    {
        if(temp1.matches("[0-9]+")){
            return true;
        }
        else {
            return false;
        }
} 
```

像这样改变你的 toString 方法：

```
 public String toString()
 {   String s="";   
     String str= issuerID + accountNum ;

     return str;

 } 
```

它给了我输出：

```
Please enter issuer ID:321321
Please enter account number:654654654
The complete number from your input:321321654654654 
```

# php - Chrome 相对协议的替代方案

> ID：13426683
> 
> 赞同：0
> 
> 时间：2012-11-17T01:16:39.020
> 
> 标签：php, html, google-chrome, relative-path

所以 Chrome 不想尊重相关协议。有什么好的选择。我正在考虑使用 PHP 来嗅探协议并使用常量。好主意？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:16:03.123

您的问题与 Chrome 完全无关。您的服务器正在将您的 HTTPS CSS 请求重定向到 HTTP。

去`https://www.reflectionproducts.com/FC_CSS.css`。您将获得 301 永久重定向到`http://www.reflectionproducts.com/FC_CSS.css`.

Chrome 确实允许使用未指定协议的 URL。

# android - How to reuse a bitmap on android

> ID：13426688
> 
> 赞同：0
> 
> 时间：2012-11-17T01:17:46.160
> 
> 标签：android, bitmap, drawable

I have the following code:

```
 public void loop1(int times, SpriteObject[] obj){
        for(int i = 0; i < times; i++){
            obj[i] = new SpriteObject(BitmapFactory.decodeResource(gv.getResources(),  R.drawable.bar1), 500,720);
        }
     } 
```

However, when I draw this on the view it does not stay as i expected. If I use obj[i].setX(10) and obj[5].setX(20). Only the second one appears as it is refreshing and only taking the last object. is it possible to reuse the drawables like this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:38:16.550

I don't completely understand what you're trying to accomplish here and to me it seems like your resource load method is completely set up wrong. From what I can tell, you're trying to make two similar bitmaps move around.

First, for simple drawing applications or games you would use view or surfaceview so you must implement that. Secondly, the way I create moving bitmaps is to first create Bitmap variables to hold the respective bitmaps and then I create a separate classes for each respective Bitmap. In the classes I have the following.

`public float x = 0;` `public float y = 0;`

So with this in mind all you have to do to draw the bitmaps is in the onDraw method of `View` you use this method. `canvas.drawBitmap(bitmapVariable, bitmap.x, bitmap.y, null);`

If you wanted to move the bitmaps you would just have to change the X and Y of the respective bitmap. Either in a separate method or in your update loop.

Ultimately, I think you're understanding bitmaps wrong. Once created you don't need to recreate it to redraw it at a different location unless the bitmap was garbage collected.

# http - http url编码机制

> ID：13426689
> 
> 赞同：0
> 
> 时间：2012-11-17T01:17:51.920
> 
> 标签：http, servlets, web, urlencode

在我的理解中，默认浏览器使用三个字节/字符对保留字符和
非字母数字字符进行编码：

```
 `%HH', a percent sign and two hexadecimal    
         digits representing the ASCII code of the character. 
```

因此，在服务器端，可以说 **queryString**是解码前的查询字符串，并且：

```
decodedQueryString = URLDecoder.decode(queryString , "Utf-8"); 
```

此时表达式的值：

```
decodedQueryString.length() < queryString.length(); 
```

通常应该是**真的**，对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:36:59.687

几乎。如果未解码的查询字符串不包含任何转义字符，则长度将相等。我想不出在解码后查询字符串会更长的任何情况。

# segmentation-fault - 为什么 MPI isend irecv 不起作用？

> ID：13426690
> 
> 赞同：2
> 
> 时间：2012-11-17T01:17:55.243
> 
> 标签：segmentation-fault, fortran, mpi

我有一组用户定义的类型。两个处理器中的每一个都唯一地写入数组的一部分，最后，我想要组合数组。为什么我的代码会产生分段错误？

```
program type_derived_recv_send
  use nodeinfo
  implicit none
  include 'mpif.h'
  integer(4) :: ierr
  integer(4) :: istatus1(MPI_STATUS_SIZE)
  integer(4) :: istatus2(MPI_STATUS_SIZE)
  integer(4) :: i,j,k,l
  integer(4) :: iblock(8)
  integer(4) :: idisp(8)
  integer(4) :: itype(8)
  integer(4) :: inewtype
  integer(4) :: iextent
  integer(4) :: itag, isend, irecv
  integer(4) :: n,m,p,q

    TYPE :: newXYZ
        real :: x, u
        real :: y, v
        real :: z, w
        real,dimension(3) :: uvw     
    END TYPE

    TYPE (newXYZ) :: xyz, xyz2

    TYPE (newXYZ), allocatable :: xyzArray(:,:,:,:) 
    n = 1
    m = 1 
    p = 1
    q = 2

    allocate( xyzArray(m,n,p,q) )

  call MPI_INIT(ierr)
  icomm = MPI_COMM_WORLD
  call MPI_COMM_SIZE(icomm,nproc,ierr)
  call MPI_COMM_RANK(icomm,iproc,ierr)

do l=1,q
    do k=1,p
        do j=1,n
            do i=1,m 
                    xyzArray(i,j,k,m)%x = 0
                    xyzArray(i,j,k,m)%y = 0
                    xyzArray(i,j,k,m)%z = 0
                    xyzArray(i,j,k,m)%u = 0
                    xyzArray(i,j,k,m)%v = 0
                    xyzArray(i,j,k,m)%w = 0
                    xyzArray(i,j,k,m)%uvw = (/0,0,0/)
end do
end do
end do
end do

    if (iproc == 1) then
        xyzArray(1,1,1,2)%x = 1.1
        xyzArray(1,1,1,2)%y = 2.1
        xyzArray(1,1,1,2)%z = 3.1
        xyzArray(1,1,1,2)%u = 4.1
        xyzArray(1,1,1,2)%v = 5.1
        xyzArray(1,1,1,2)%w = 6.1
        xyzArray(1,1,1,2)%uvw = (/10.1,10.1,10.1/)
    else
        xyzArray(1,1,1,1)%x = 0.1
        xyzArray(1,1,1,1)%y = 0.1       
        xyzArray(1,1,1,1)%z = 0.1
        xyzArray(1,1,1,1)%u = 0.1
        xyzArray(1,1,1,1)%v = 0.1       
        xyzArray(1,1,1,1)%w = 0.1 
        xyzArray(1,1,1,1)%uvw = (/0.1,0.1,0.1/)
    endif

    itag = 1
    xyz = xyzArray(1,1,1,2)
    xyz2 = xyzArray(1,1,1,1)

    if ( iproc == 1) call MPI_ISEND(xyzArray(1,1,1,2),36,MPI_INTEGER,0,1,icomm,isend,ierr)
    if ( iproc == 0) call MPI_IRECV(xyzArray(1,1,1,2),36,MPI_INTEGER,1,1,icomm,irecv,ierr)
    call MPI_WAIT(isend,istatus1,ierr)
    call MPI_WAIT(irecv,istatus2,ierr)

     if ( iproc == 0 )write(6,*)'iproc = ',iproc
     if ( iproc == 0 ) write(6,*)xyzArray

     if ( iproc == 1 )write(6,*)'iproc = ',iproc
     if ( iproc == 1 ) write(6,*)xyzArray

  call MPI_FINALIZE(ierr)
end program type_derived_recv_send 
```

输出：

```
--------------------------------------------------------------------------
 newtype extent =           36
 xyz =    0.000000       0.000000       0.000000       0.000000       0.000000       0.000000       0.000000       0.000000       0.000000    
 xyz2 =   0.1000000      0.1000000      0.1000000      0.1000000      0.1000000      0.1000000      0.1000000      0.1000000      0.1000000    
[west0334:09950] *** Process received signal ***
[west0334:09950] Signal: Segmentation fault (11)
[west0334:09950] Signal code: Address not mapped (1)
[west0334:09950] Failing at address: 0x40
[west0334:09950] [ 0] /lib64/libpthread.so.0 [0x3e00e0eb70]
[west0334:09950] [ 1] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi.so.0(ompi_request_wait+0x17) [0x2b33f8628607]
[west0334:09950] [ 2] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi.so.0(PMPI_Wait+0x88) [0x2b33f86566e8]
[west0334:09950] [ 3] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi_f77.so.0(PMPI_WAIT+0x3a) [0x2b33f83eac8a]
[west0334:09950] [ 4] ./type_derived_recv_send.x(MAIN__+0x730) [0x401cd0]
 newtype extent =           36
 xyz =    1.100000       4.100000       2.100000       5.100000       3.100000       6.100000       10.10000       10.10000       10.10000    
 xyz2 =    0.000000       0.000000       0.000000       0.000000       0.000000       0.000000       0.000000       0.000000       0.000000    
[west0334:09951] *** Process received signal ***
[west0334:09951] Signal: Segmentation fault (11)
[west0334:09951] Signal code: Address not mapped (1)
[west0334:09951] Failing at address: 0x40
[west0334:09950] [ 5] ./type_derived_recv_send.x(main+0xe) [0x4049ae]
[west0334:09950] [ 6] /lib64/libc.so.6(__libc_start_main+0xf4) [0x3e0021d994]
[west0334:09950] [ 7] ./type_derived_recv_send.x [0x4014e9]
[west0334:09950] *** End of error message ***
[west0334:09951] [ 0] /lib64/libpthread.so.0 [0x3e00e0eb70]
[west0334:09951] [ 1] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi.so.0(ompi_request_wait+0x17) [0x2b73c1aca607]
[west0334:09951] [ 2] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi.so.0(PMPI_Wait+0x88) [0x2b73c1af86e8]
[west0334:09951] [ 3] /n/sw/openmpi-1.2.5-gcc-4.1.2/lib64/libmpi_f77.so.0(PMPI_WAIT+0x3a) [0x2b73c188cc8a]
[west0334:09951] [ 4] ./type_derived_recv_send.x(MAIN__+0x748) [0x401ce8]
[west0334:09951] [ 5] ./type_derived_recv_send.x(main+0xe) [0x4049ae]
[west0334:09951] [ 6] /lib64/libc.so.6(__libc_start_main+0xf4) [0x3e0021d994]
[west0334:09951] [ 7] ./type_derived_recv_send.x [0x4014e9]
[west0334:09951] *** End of error message ***
Nov 16 20:17:14 2012 9939 4 7.06 handleTSRegisterTerm(): TS reports task <0> pid <9950> on host<west0334> killed or core dumped
Job  /lsf/7.0/linux2.6-glibc2.3-x86_64/bin/openmpi_wrapper ./type_derived_recv_send.x 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T11:12:48.137

错误在这里：

```
if ( iproc == 1) call MPI_ISEND(xyzArray(1,1,1,2),36,MPI_INTEGER,0,1,icomm,isend,ierr)
if ( iproc == 0) call MPI_IRECV(xyzArray(1,1,1,2),36,MPI_INTEGER,1,1,icomm,irecv,ierr)
call MPI_WAIT(isend,istatus1,ierr)
call MPI_WAIT(irecv,istatus2,ierr) 
```

请求句柄在 rank中`irecv`保持未初始化，而请求句柄在 rank 中保持未初始化。这里有两个选项 - 要么将调用与其相应的非阻塞 MPI 操作分组，要么在此之前初始化两者。`0``isend``1``MPI_WAIT``isend``irecv``MPI_REQUEST_NULL`

解决方案1：

```
if ( iproc == 1) then
   call MPI_ISEND(xyzArray(1,1,1,2),36,MPI_INTEGER,0,1,icomm,isend,ierr)
   call MPI_WAIT(isend,istatus1,ierr)
end if
if ( iproc == 0) then
   call MPI_IRECV(xyzArray(1,1,1,2),36,MPI_INTEGER,1,1,icomm,irecv,ierr)
   call MPI_WAIT(irecv,istatus2,ierr)
end if 
```

解决方案 2（简化）：

```
ireq = MPI_REQUEST_NULL
if ( iproc == 1) call MPI_ISEND(xyzArray(1,1,1,2),36,MPI_INTEGER,0,1,icomm,ireq,ierr)
if ( iproc == 0) call MPI_IRECV(xyzArray(1,1,1,2),36,MPI_INTEGER,1,1,icomm,ireq,ierr)
call MPI_WAIT(ireq,istatus,ierr) 
```

您实际上并不需要两个单独的请求句柄以及两个单独的状态数组。使用`ireq`空句柄初始化后，此代码也可以在超过 2 个 MPI 进程中正常运行。

请注意，为了便于移植，您应该构造一个派生结构数据类型，`MPI_TYPE_CREATE_STRUCT`并使用它来发送和接收`TYPE(newXYZ)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T09:22:58.150

为什么要发送带有整数 MPI 数据类型的 9 实数类型？为什么不发送 9 MPI_REAL 或 36 MPI_BYTE

# php - 测试 PHP 安全性

> ID：13426693
> 
> 赞同：0
> 
> 时间：2012-11-17T01:18:05.807
> 
> 标签：php, security, testing

我一直在编写脚本一段时间，以确保它尽可能安全。我唯一的问题是，我怎么知道它是否安全？我在网上找不到任何东西。

我的脚本是一个用户管理脚本，不是为了使用，只是为了练习。

我想测试尽可能多的安全漏洞。XSS、CSRF、会话固定/劫持（重要）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:33:58.333

您的问题太开放了，无法在这里深入回答。但是，这里有一些关于如何防止您提到的可能攻击的指南：

*   [跨站脚本](http://stjhimy.com/posts/16-xss-protection)
*   [CSRF](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet)
*   [会话劫持](http://hydtechie.blogspot.de/2008/08/prevention-from-session-hijacking.html)

请记住：没有任何系统是 100% 安全的。但这些应该是一个好的开始。这里有一些基本[的](https://www.securecoding.cert.org/confluence/display/seccode/Top+10+Secure+Coding+Practices)事情要记住/总是要做，比如某些类型的验证等。

# javascript - 如何在等待ajax回调时运行javascript

> ID：13426695
> 
> 赞同：6
> 
> 时间：2012-11-17T01:18:50.040
> 
> 标签：javascript, ajax, json, jquery

我正在对服务器进行 ajax 调用。我需要运行的代码可以分为 3 组。

1.  在进行ajax调用之前需要运行的代码（准备去服务器的json对象）
2.  ajax 调用返回后需要运行的代码（使用从服务器发回的内容）
3.  需要在用户按下按钮和一切完成之间运行的代码。此代码不需要返回的 json 对象。

在进行 ajax 调用之后并在结果返回之前运行第 3 组中的代码以获得最佳用户体验和性能是理想的。

这可以做到吗？

如何？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-17T01:23:13.060

很简单：

```
function someFunction() {
    //1\. code that needs to run before ajax
    $.ajax({...}).done(function () {
        //2\. code that needs to be run after the ajax call has returned
    });
    //3\. code that needs to be run between the time the user presses
    //   a button and the time everything is done.
} 
```

这是可行的，因为 JavaScript 在执行中是同步的（除非正在使用工作人员，但这与这个特定问题无关）。第一段代码会运行，然后ajax调用会告诉浏览器开始一个XHR请求，但是`someFunction`还没有完成，所以它会继续同步执行。

一旦`someFunction`完成，控制流将对发生的任何异步事件开放，最终导致`done`回调。

公平地说，异步面向事件的编程对于大多数人来说并不容易理解。很容易忘记应该在什么时间出现什么代码。

这是一个易于执行的异步行为如何工作的示例：

```
(function () {
    alert(1);
    setTimeout(function () {
        alert(2);
    }, 0); //note the 0ms delay
    alert(3);
}()); 
```

警报的顺序是`1`, `3`, `2`。`setTimeout`不会同步调用它的回调，因为它依赖于等待指定的时间过去，所以即使没有时间过去，它仍然必须等待当前函数完成才能继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:22:53.987

在响应客户端事件或在任何其他情况下执行 ajax 调用允许您指定回调中的代码以及在 ajax 代码生成后立即执行的代码（而不是在回调中）。

例子：

```
// Code before the ajax call is made
$.ajax({
    params, //other key values such as data
    success: function (data) {
       // one of the possible callbacks
    }
});
// Code executed immediately after ajax call is performed
// This is executed before or after the callback is complete
// In most cases it's before 
```

因此，在进行 ajax 调用之前执行的任何操作都保证在之前执行。几乎可以保证在调用回调之前立即执行 ajax 调用之后的任何内容。回调保证在服务器返回响应后执行。

# wordpress - Wordpress RewriteRule 适用于永久链接，但不适用于主页

> ID：13426696
> 
> 赞同：1
> 
> 时间：2012-11-17T01:18:50.417
> 
> 标签：wordpress, .htaccess, mod-rewrite

我的网站上有标准的 wordpress 重写规则：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

该站点曾经位于子目录 (mysite.com/1/) 中，现在位于根目录中，我想确保对子目录的任何请求都重定向到根目录。上面的规则对带有永久链接的页面执行此操作（我假设是因为 RewriteBase），例如 mysite.com/1/contact 被重定向到 mysite.com/contact，但不适用于主页，所以 mysite.com/1/ 不是重定向到 mysite.com。

谁能提供解决方案，将子目录中主页的请求重定向到根目录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T10:45:01.260

我找到了解决方案。我在原规则下添加了这条规则：

```
Redirect /1 http://mysite.com 
```

# ios - 动画 MKPolygonView

> ID：13426697
> 
> 赞同：1
> 
> 时间：2012-11-17T01:18:52.590
> 
> 标签：ios, mapkit, mkoverlay

正如标题所暗示的，我正在尝试为 MKPolygonView 设置动画，特别是颜色和不透明度。

现在我有一个手势检测用户是否触摸了多边形，通过遍历overlayViews并找出触摸点是否在多边形内。

无论如何，我得到了 MKPolygonView，我更改了填充颜色并且颜色发生了变化，但它并没有按照我想要看到的方式完全按照我想要的方式来查看叠加层如何在瓷砖中绘制，定义为 mapRects，所以当你给它着色时，而不是着色在整个多边形中，它会根据多边形相对于地图上不可见网格的放置位置，一次对其各个部分进行着色。

一次将 mkpolygonview 的颜色放在一个图块中是可以的，但正如我所说的那样，这是不理想的。

由于 MKPolygonView 不能被子类化，问题变得更加复杂。我有点没有想法，希望你们能提供一些意见。

如果你能做到这一点，谢谢。

# php - 使用 PHP 的 XML RSS 提要

> ID：13426703
> 
> 赞同：1
> 
> 时间：2012-11-17T01:19:15.130
> 
> 标签：php, xml, rss

我正在使用以下代码将脚本中进一步声明的一系列变量拼凑在一起，以形成 RSS XML 提要的链接部分。我需要在变量之间插入一个＆符号以正确完成 URL。我试过使用 & 也只是 & put 它以错误结束：

`error on line 7 at column 194: Entity Ref: expecting ';'`

有人可以告诉我，这样我就可以看到我做错了什么？

```
echo '<link>' . $url . 'ampersand_goes_here' . $mlcall. '' . $title . '</link>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:40:26.597

尝试使用 htmlspecialchars() 函数将字符串包含在链接标记中。

```
echo '<link>' . htmlspecialchars($url . 'ampersand_goes_here' . $mlcall. '' . $title) . '</link>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:59:48.150

```
echo "<link>$url&amp;$mlcall$title</link>"; 
```

或（更好）

```
echo '<link>' . htmlentities($url&$mlcall$title) . '</link>'; 
```

# go - 在 Go 中只返回多个返回值中的一个

> ID：13426706
> 
> 赞同：3
> 
> 时间：2012-11-17T01:20:24.357
> 
> 标签：go, return-value

有没有更好的方法来只返回多个返回值中的一个？

```
func makeRune(s string) (r rune) {
    r, _ = utf8.DecodeRuneInString(s)
    return
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T15:21:46.977

是的。您应该添加评论说明您这样做的原因。因为这样做的动机经常被误导，人们会质疑它，就像他们在对你的 OP 的评论中所说的那样。如果你有充分的理由编写一个函数来抛出一个返回值，请在评论中证明它的合理性。也许你可以写，

```
// makeRune helper function allows function chaining.
func makeRune(s string) (r rune) {
    // toss length return value.  for all use cases in this program
    // only the first rune needs to be decoded.
    r, _ = utf8.DecodeRuneInString(s)
    return
} 
```

这也有助于通过遵循经验法则来进行代码审查，“如果注释和代码不一致，那么两者都可能是错误的。” 如果不需要函数链接，那么函数的整个目的是有问题的。如果您的评论表明您认为您正在抛出错误值，那将是一个危险信号。如果您的评论表明您认为 s 只能包含一个符文，那也是一个危险信号。鉴于上面的示例注释，我可能会阅读我所写的内容并决定将该函数命名为 firstRune 更好。这具有更具体的含义，并避免暗示类似于 Go make 函数的语义。

# javascript - 需要帮助计算 24 小时内 4 个实例时钟之间的时间差

> ID：13426708
> 
> 赞同：1
> 
> 时间：2012-11-17T01:20:26.863
> 
> 标签：javascript, html, algorithm

好的，有 4 个发生时钟输入/输出的实例。有一个打卡，午餐打卡，午餐打卡，最后一个打卡。这是一个 24 小时制的时钟，最后需要将时间四舍五入到最接近的 0.25（15 分钟）。

```
 *For reference, a is the first clock in hour, b is the clock out for lunch hour
    c is the clock in hour from lunch, and d is the final clock out hour

   *e is the first clock in minute, f is the clock out for lunch minute
    g is the clock in from lunch minute, and h is the final clock out minute

   *So for example, if somebody clocked in at 5:30, a=5 and f=30
    a clock out for lunch at 12:00 gives b=12 and g=0, etc.

   *The way this code works in a nutshell is to find the total time elapsed and then
    subtract the lunch break time from it. 

   //Find total time
    a=d-a;
    e=h-e;

    //Find lunch break time
    y=c-b;
    z=g-f;

    if(e>=0 && z>=0){
        hours=a-y;
        minutes=e-z;
        if(minutes<0){minutes=minutes*(-1);}
    }else if(e<0 && z<0){
        e=e*(-1);
        z=z*(-1);
        hours=a-y;
        minutes=e-z;
        if(minutes<0){minutes=minutes*(-1);}
    }else{
        if(e<0){e=e*(-1);}
        if(z<0){z=z*(-1);}
        if(e<=z){hours=a-y-1;}
        else{hours=a-y;}
        minutes=e-z;
        if(minutes<0){minutes=minutes*(-1);}
    }

    a=hours;
    e=minutes;

    //This rounds to the nearest 15 minutes/quarter hour        
    if(e<15){
        if(e>=8){e=15;}
        else if(e<8){e=0;}}
    if(e<=30 && e>=15){
        if(e>=23){e=30;}
        else if(e<23){e=15;}}
    if(e<=45 && e>30){
        if(e>=38){e=45;}
        else if(e<38){e=30;}}
    if(e<=60 && e>45){
        if(e>=53){e=0;}
        else if(e<53){e=45;}}

    e=e/60;
    a=a+e;
}

if(a<0){a=a+24;}

$(totaltime).attr('value',a); 
```

}

该代码非常接近工作，只是随机情况下它不起作用，它会关闭一个小时或一个小时左右的 0.5。此外，这是在高度受限的服务器上托管的 HTML 页面上用 javascript 编写的，所以我不能真正添加​​任何新库或任何东西。

如果您有更好的主意，绝对可以随意放弃我的代码，这三个 if/else 语句解释起来有点令人困惑，这就是为什么代码无论如何都不起作用的原因。我主要展示了代码以表明我一直在为此付出一些努力，而不仅仅是试图利用你的帮助哈哈。

我也很抱歉，但我必须离开电脑一段时间，所以如果你有一些解决这个问题的建议或方法，请把它们扔在那里，我回来时会看看它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T02:52:40.240

让 javascript 使用日期类完成所有工作：

```
//Assuming the day is today
var date = new Date();
var year = date.getFullYear();
var month = date.getMonth();
var day = date.getDay();
//

var clockIn = new Date(year, month, day, a, e).getTime();
var clockOut = new Date(year, month, day, b, f).getTime();
var clockIn_afterLunch = new Date(year, month, day, c, g).getTime();
var clockOut_afterLunch = new Date(year, month, day, d, h).getTime();

var preLunchTimeWorked = clockOut - clockIn;
var postLunchTimeWorked = clockOut_afterLunch - clockIn_afterLunch;

var timeWorked = preLunchTimeWorked + postLunchTimeWorked;

var secondsWorked = timeWorked/1000;
var minutesWorked = secondsWorked/60;
var hoursWorked = minutesWorked/60;
//Much easier to work with in my opinion 
```

希望能帮助你得到你的答案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T05:34:50.067

处理时间的（相当）标准方法是将所有内容转换为秒，并以秒为单位进行计算。

时间 1 = 秒 1 + (60 * 分钟 1) + (3600 * 小时 1)

等等。如果时间可以跨越午夜，你会想要将它们引用到某个纪元时间（天文学家使用 2000 年 1 月 1 日午夜）。

然后减去您的时间，四舍五入到您需要的任何精度（15 分钟 = 900 秒），然后将您的增量转换为小时和分钟。

# c# - 在画布上简单地绘制一个矩形

> ID：13426709
> 
> 赞同：2
> 
> 时间：2012-11-17T01:20:31.667
> 
> 标签：c#, wpf

我是 C# 和 WPF 的新手。

我想**在 canvas 上简单地绘制一个矩形**。

但我找不到决定**矩形原点**的变量。

```
 void DrawRect(int x, int y) 
    {
        Rectangle rec = new Rectangle
        {
            Fill = new SolidColorBrush(Colors.Red),
            Width = width,
            Height = y
            ...???
        };
        mainWindow.canvas.Children.Add(rec);
    } 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:41:48.090

Canvas 的[SetTop](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.settop.aspx)、[SetLeft](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.setleft.aspx)、[SetRight](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.setright.aspx)、[SetBottom](http://msdn.microsoft.com/en-us/library/system.windows.controls.canvas.setbottom.aspx)属性应该可以工作。

那么那么

```
mainWindow.canvas.SetLeft(rec, xcoord);
mainWindow.canvas.SetTop(rec, ycoord); 
```

感谢[JerKimball](https://stackoverflow.com/users/48692/jerkimball)提供更多信息：

WPF 中的单个形状本身没有“位置” - 它们通过在父 Canvas 元素上设置相应的附加属性来定位

# security - 为什么要存储持久登录 cookie 和密码重置令牌的哈希？

> ID：13426710
> 
> 赞同：3
> 
> 时间：2012-11-17T01:20:34.770
> 
> 标签：security, session, passwords, password-recovery, forgot-password

我刚刚阅读了以下内容：

> 并且不要将持久登录 COOKIE（令牌）存储在您的数据库中，只存储它的哈希值！登录令牌是密码等效的，因此如果攻击者掌握了您的数据库，他/她可以使用这些令牌登录到任何帐户，就像它们是明文登录密码组合一样。因此，在存储持久登录令牌时使用强加盐哈希（bcrypt / phpass）。

（在这个答案中：[https](https://stackoverflow.com/a/477578/943102) ://stackoverflow.com/a/477578/943102 ）

我认为应该使用散列，因为人们在多个站点上使用相同的密码，它可以防止攻击者侵入同一用户的其他帐户。由于登录令牌是一个随机值，因此在这种情况下不存在这种风险。我显然遗漏了一些东西，但我找不到任何关于此的更多信息。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T01:49:52.513

假设您是一名 Web 应用程序开发人员，并且您做了正确的事情，并且您只将用户密码的哈希值存储在数据库中（不是明文），但您决定将其经过身份验证的登录令牌存储在数据库中而不对其进行哈希处理。

现在假设恶意攻击者闯入 Web 应用程序的数据库并进行转储并与 Web 上的恶意攻击伙伴共享。好吧，那些密码哈希对他没有多大用处，因为他无法使用哈希登录。但他看到这些登录令牌以纯文本*形式*存储。现在对他来说，将一个放入 cookie 并将其与 HTTP 请求一起发送到服务器是微不足道的。服务器将获取 cookie，根据数据库对其进行身份验证，并允许攻击者进入。因此，即使这些登录令牌只是随机值，一旦攻击者拥有它们，他或她就可以使用它们来模拟经过身份验证的用户。

# python - PySide：将数据从 QML 传递到 Python

> ID：13426711
> 
> 赞同：5
> 
> 时间：2012-11-17T01:20:40.620
> 
> 标签：python, qt, qml, pyside, qtdeclarative

我正在尝试将数据从 QML 发送到 Python，但出现错误。

测试.py：

```
#!/usr/bin/env python

import sys
from PySide import QtCore, QtGui, QtDeclarative

class Test( QtCore.QObject ):
    def __init__( self ):
        QtCore.QObject.__init__(self)

    @QtCore.Slot()
    def printText(self,text):
        print text

class MainWindow( QtDeclarative.QDeclarativeView ):
    def __init__( self, parent=None ):
        super( MainWindow, self ).__init__( parent )
        self.setWindowTitle( "Test" )
        self.setSource( QtCore.QUrl.fromLocalFile( './test.qml' ) )
        self.setResizeMode( QtDeclarative.QDeclarativeView.SizeRootObjectToView )

app = QtGui.QApplication( sys.argv )
window = MainWindow()
context = window.rootContext()
context.setContextProperty("testModel",Test())
window.show()
sys.exit( app.exec_() ) 
```

测试.qml：

```
import QtQuick 1.0

Rectangle {
    width: 200
    height: 200
    color: "white"

    Rectangle {
        anchors.centerIn: parent
        width: 100
        height: 50
        color: "black"
        Text {
            anchors.centerIn: parent
            text: "click"
            color: "white"
        }
        MouseArea {
            anchors.fill: parent
            onClicked: {
                testModel.printText("test")
            }
        }
    }
} 
```

单击按钮时，我希望它打印“测试”，但我收到此错误：

> TypeError: printText() 正好需要 2 个参数（给定 1 个）

我错过了什么？

*编辑：将示例更改为更简单的示例。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T12:39:38.097

我忘了指定插槽的参数类型。通过将 printText() 的声明更改为：

```
@QtCore.Slot('QString')
def printText(self,text):
    print text 
```

# php - jQuery uploadify 将图像存储在 mysql 中

> ID：13426712
> 
> 赞同：5
> 
> 时间：2012-11-17T01:20:41.163
> 
> 标签：php, jquery, mysql, uploadify

我正在尝试使用uploadify将多个图像插入mysql数据库。我的数据库的其中一个列是 longblob 类型。每次我选择多个文件时，只有我的第一个图像被成功插入。我设置了 multi = true。我无法插入多个图像，而且每当我点击上传链接时，onComplete 事件都不会被执行。没有显示错误。由于某种原因，我的脚本无法插入多个图像，因此我的上传完成事件没有被调用。

我遇到的大多数示例，不插入实际图像，而只是将文件名的路径插入数据库。谁能帮我让我的脚本将多个图像上传到数据库中？

这是我的 index.php 脚本：

```
<script type="text/javascript">

 $(document).ready(function() {

//alert('I am ready to use uploadify!');
$("#picture").uploadify({
    'uploader': 'uploadifyit/uploadify.swf',
    'script': 'sqlupload.php',
    'cancelImg': 'uploadifyit/cancel.png',
    'folder': 'uploads',
    'auto': false, // use for auto upload
    'multi': true,
    'queueSizeLimit': 4,
    'sizeLimit': 10000000,
    'onQueueFull': function(event, queueSizeLimit) {
        alert("Please don't put anymore files in me! You can upload " + queueSizeLimit + " files at once");
        return false;
    },
    'onAllComplete'  : function(){ 
    alert("Thank you. All files have been uploaded successfully."); 
    },
    'onComplete': function(event, ID, fileObj, response, data) {
        console.log(response); // If you're using firebug
        alert(response); // Will alert the php error
    },
    'onUploadError' : function(file, errorCode, errorMsg, errorString) {
        alert('The file ' + file.name + ' could not be uploaded: ' + errorString);
    }
});
});
</script> 
```

sqlupload.php

```
 <?php
         mysql_connect("localhost", "root", "")or die(mysql_error());
          mysql_select_db("project") or die(mysql_error()); 

         if (!empty($_FILES)) {

         $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
         $fileParts = pathinfo($_FILES['Filedata']['name']);

     if (in_array(strtolower($fileParts['extension']),$fileTypes)) {

    $pic_name = $_FILES['Filedata']['name']; 
        $pic_size = $_FILES['Filedata']['size']; 
        $pic_type = $_FILES['Filedata']['type'];
    $imgData =addslashes(file_get_contents($_FILES['Filedata']['tmp_name']));    

// our sql query
      $sql = "INSERT INTO photos (name,type,size,image)   VALUES('$pic_name','$pic_type','$pic_size','$imgData')";
 // insert the image
mysql_query($sql) or die("Error in Query: " . mysql_error());
}
else {
echo "Invalid file type";
}
} 
```

?>

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-25T04:41:06.423

试试下面的代码

```
 <?php
         mysql_connect("localhost", "root", "")or die(mysql_error());
          mysql_select_db("project") or die(mysql_error()); 

         if (!empty($_FILES)) {

         $fileTypes = array('jpg','jpeg','gif','png'); // File extensions
         $fileParts = pathinfo($_FILES['Filedata']['name']);
         //Upload file
         $tempFile = $_FILES['Filedata']['tmp_name'];
         $targetPath = $_SERVER['DOCUMENT_ROOT'] . $_GET['folder'] . '/';
         $targetFile =  str_replace('//','/',$targetPath) . $_FILES['Filedata']['name'];
         move_uploaded_file($tempFile,$targetFile);

     if (in_array(strtolower($fileParts['extension']),$fileTypes)) {

    $pic_name = $_FILES['Filedata']['name']; 
        $pic_size = $_FILES['Filedata']['size']; 
        $pic_type = $_FILES['Filedata']['type'];
    $imgData =addslashes(file_get_contents($_FILES['Filedata']['tmp_name']));    

// our sql query
      $sql = "INSERT INTO photos (name)   VALUES('$pic_name')";
 // insert the image
mysql_query($sql) or die("Error in Query: " . mysql_error());
}
else {
echo "Invalid file type";
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T17:02:19.567

也许这个插件可以帮助你：

[http://des.deletesoft.com:8080/?go=2](http://des.delestesoft.com:8080/?go=2)

# web-services - Liferay 文档库网络服务：如何简单地读取文件的内容？

> ID：13426713
> 
> 赞同：5
> 
> 时间：2012-11-17T01:20:55.440
> 
> 标签：web-services, wsdl, liferay

我还在[Liferay 社区板上](http://www.liferay.com/community/forums/-/message_boards/message/17988807)发布了这个问题。

我正在尝试通过网络服务访问 Liferay 的文档库。为此，我使用 Eclipse 从 Liferay 的 Portlet_DL_DLAppService wsdl 创建了一个 Web 客户端。一切顺利，我想我可以轻松地远程创建一个文件，但是生成的类似乎没有任何功能来读回文件的内容。

[DLAppService](http://docs.liferay.com/portal/6.1/javadocs/com/liferay/portlet/documentlibrary/service/DLAppService.html)具有获取[FileEntries](http://docs.liferay.com/portal/6.1/javadocs/com/liferay/portal/kernel/repository/model/FileEntry.html)的方法，但是虽然接口 FileEntry 具有方法 getContentStream()，但生成的 Web 客户端 (FileEntrySoap) 中的代理类没有。

我觉得我从根本上错过了一些东西，因为我认为我不是第一个通过 Web 服务使用 Liferay 文档库的人？

欢迎任何提示或指示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T21:04:54.030

另一种解决方法是使用 http 请求获取文件。

以下示例使用 Apache commons-httpclient (v4) 和基本身份验证。如果客人有权查看文件，则不需要身份验证部分。

对于基本身份验证，您需要 `com.liferay.portal.security.auth.BasicAuthHeaderAutoLogin`作为属性中的登录钩子之一`auto.login.hooks`（在 portal-ext.properties 中）

例子

```
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.net.URLEncoder;

import org.apache.http.HttpEntity;
import org.apache.http.HttpHost;
import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.auth.AuthScope;
import org.apache.http.auth.UsernamePasswordCredentials;
import org.apache.http.client.AuthCache;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.client.protocol.ClientContext;
import org.apache.http.impl.auth.BasicScheme;
import org.apache.http.impl.client.BasicAuthCache;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.protocol.BasicHttpContext;

private static byte[] getFile(inal long groupId, final long folderId, final String title, final String hostname, final int port, final String username, final String password) throws ClientProtocolException, IOException {
    final DefaultHttpClient httpclient = new DefaultHttpClient();
    try {
        final String filename = URLEncoder.encode(title);

        final HttpHost targetHost = new HttpHost(hostname, port);
        UsernamePasswordCredentials creds = new UsernamePasswordCredentials(username, password);

        final AuthScope authscope = new AuthScope(targetHost.getHostName(), targetHost.getPort());
        httpclient.getCredentialsProvider().setCredentials(authscope, creds);

        final AuthCache authCache = new BasicAuthCache();
        final BasicScheme basicAuth = new BasicScheme();
        authCache.put(targetHost, basicAuth);

        final BasicHttpContext localContext = new BasicHttpContext();
        localContext.setAttribute(ClientContext.AUTH_CACHE, authCache);

        final HttpGet httpget = new HttpGet("/documents/" + groupId + "/" + folderId + "/" + filename);

        final HttpResponse response = httpclient.execute(targetHost, httpget, localContext);

        if (response.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {
            final HttpEntity entity = response.getEntity();

            if (entity != null) {
                ByteArrayOutputStream baos = new ByteArrayOutputStream();

                entity.writeTo(baos);
                return baos.toByteArray();
            }
        }
        return null;
    } finally {
        httpclient.getConnectionManager().shutdown();
    }

} 
```

从您从 Web 服务获得的 FileEntry 中，您可以获得 groupId、folderId 和 title 并调用该方法

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T18:05:37.727

在浏览了他们的网站很长一段时间后 - 我终于在论坛上看到了你的帖子，然后是这个，较旧的：

[http://www.liferay.com/community/forums/-/message_boards/message/7943515](http://www.liferay.com/community/forums/-/message_boards/message/7943515)

一般来说，看起来该服务根本没有提供大量文档，更不用说这个特定的功能子集了。

但是 - 按照这些链接，我找到了一些可能有帮助的资源：

[使用 Liferay Portal 作为内容管理系统](http://www.liferay.com/documentation/liferay-portal/6.1/user-guide/-/ai/lp-6-1-ugen01-using-liferay-portal-as-a-content-management-system-0)并 [开始使用文档和媒体](http://www.liferay.com/documentation/liferay-portal/6.1/user-guide/-/ai/lp-6-1-ugen04-getting-started-with-the-documents-and-media-1)

如您所见，这两个链接位于用户指南中。

看起来您可以从*文档和媒体*门户页面获取文档的 WebDAV URL - 这可能反映了非 API 方式来执行 Olaf 在通过 API 的回答中建议的方式。

我很好奇上述任何一个答案是否有助于您解决问题，因为两者都没有被标记为正确 - 但由于赏金，我猜不是。我希望这些资源有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T13:31:21.833

抱歉，我现在无法提供完整的解决方案，但如果其他一切都失败了，您可以尝试通过 WebDAV 使用解决方法：[DLUtil.getWebDavURL()](http://docs.liferay.com/portal/6.1/javadocs/com/liferay/portlet/documentlibrary/util/DLUtil.html#getWebDavURL%28com.liferay.portal.theme.ThemeDisplay,%20com.liferay.portal.kernel.repository.model.Folder,%20com.liferay.portal.kernel.repository.model.FileEntry%29)

InputStream 是不好通过 SOAP 传输的东西，但是如果你只是获取一个 URL，然后通过这种方式打开文件，你很可能能够得到你需要的东西。这也将使您能够更新文件。

那里可能有一堆 WebDAV 实现 - 取决于您需要从中访问 doclib 的环境（编程语言）。

# c++ - QT声子游戏音频

> ID：13426716
> 
> 赞同：3
> 
> 时间：2012-11-17T01:21:23.333
> 
> 标签：c++, qt, audio, phonon

作为团队的一员，我正在为学校开发一个游戏项目。我需要设置一个为游戏提供音频的单例类。我们正在使用 QT 移植到移动设备和可能的安卓手机。我们决定将声子用于游戏音频。我对此很陌生，刚开始第一次使用 QT，而且对游戏编程也很陌生。

音频系统一次应该能够处理一种以上的声音。至少它必须处理背景音乐和音效。效果将通过信号连接到插槽。

这是我的代码：

/ ***** ** *** ** *** ** *** ****** *audiosystem.h* ***** **** /

```
class AudioSystem : public QWidget
{
     Q_OBJECT
 public:
     static AudioSystem *instance();
     void setMusicFile(const QString &filename);

 signals:
     bool finishedMusic();    ///< For looping

public slots:
     void playMusic();       ///< BG music triggered at Level start?
     void stopMusic();       ///< Triggered by level finish
     void click_sound();     ///< Menu button clicks
     void step_sound();      ///< Other character sounds
     void wall_sound();      ///< Hitting the wall  or collision sound
     void jump_sound();      ///< Jumping sound     
     void sound(int);        ///< Level specific custom sounds

private:
    // Singleton - constructors made private
    AudioSystem(QWidget *parent = 0);
    ~AudioSystem();
    AudioSystem(const AudioSystem &);
    AudioSystem& operator=(const AudioSystem &);

    static AudioSystem *m_Instance;

    // media objects
    Phonon::MediaObject *m_BgPlayer;
    Phonon::MediaObject *m_EffectPlayer;
    // audio sinks
    Phonon::AudioOutput *m_BgAudioOutput;
    Phonon::AudioOutput *m_EffectAudioOutput;
    // audio paths
    Phonon::Path m_BgAudioPath, m_EffAudioPath;
}; 
```

/ ***** ** *** ******音频系统.cpp* **/*

 *```
AudioSystem* AudioSystem::m_Instance = 0;

AudioSystem* AudioSystem::instance()
{
    if (!m_Instance)
    {
        m_Instance = new AudioSystem();
    }
    return m_Instance;
}

AudioSystem::AudioSystem(QWidget *parent) :
    QWidget(parent)
{
    // create new instance of player and audio sinks then connect with paths
    m_BgPlayer = new Phonon::MediaObject(this);
    m_EffectPlayer = new Phonon::MediaObject(this);
    m_BgAudioOutput = new Phonon::AudioOutput(Phonon::MusicCategory, this);
    m_EffectAudioOutput= new Phonon::AudioOutput(Phonon::MusicCategory, this);
    m_BgAudioPath = Phonon::createPath(m_BgPlayer, m_BgAudioOutput);
    m_EffAudioPath = Phonon::createPath(m_EffectPlayer, m_EffectAudioOutput);
}

void AudioSystem::setMusicFile(const QString &filename)
{
    m_BgPlayer->setCurrentSource(QString(filename));
}

void AudioSystem::playMusic()
{
    m_BgPlayer->play();
}

void AudioSystem::stopMusic()
{
    m_BgPlayer->stop();
}

void AudioSystem::click_sound()
{
    m_EffectPlayer->setCurrentSource(QString(":/button.wav"));
    m_EffectPlayer->play();
} 
```

........................... ETC

```
typical implementation:
AudioSystem::instance()->playMusic  
AudioSystem::instance(), SLOT(click_sound()) 
```

我设置的代码在一个简单的主窗口的简单情况下似乎可以正常工作，但是当我将任何地方放在我们的代码中时，它什么也不做。有什么我想念的吗？

完整项目：git://gitorious.org/gamecs340project/gamecs340project.git

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:39:38.763

Phonon 无法做到这一点。至少不是以理智的方式；如果您尝试播放多个声音，它会尝试多次打开系统的音频设备。这不能保证在任何地方都有效。

对于游戏，您通常需要自己的音频混合。最简单的方法之一是使用[SDL](http://www.libsdl.org)和[SDL_mixer](http://www.libsdl.org/projects/SDL_mixer)。SDL_mixer 可以同时播放多个音频样本，但不能同时播放多个音乐流。如果需要，可以使用我修改后的[SDL_mixer](https://bitbucket.org/realnc/sdl_mixer)版本。

当然，还有很多其他的库。但 SDL_mixer 可能是最容易使用的一种。*

# css - 使用数据 URI 代替精灵图像有什么缺点？

> ID：13426717
> 
> 赞同：10
> 
> 时间：2012-11-17T01:21:55.007
> 
> 标签：css, http, less, ccsprite

考虑我的网站的这个条件：

*   我不支持 IE8 及以下，所以浏览器支持不是问题。

*   我还使用 gzip 来避免 CSS 中的数据过载，以防在我的 CSS 文件中复制和粘贴数据 URI 图像。

*   我只有一个由 LESS 生成的 CSS 文件。

*   为方便起见，我对每个图像数据 URI 使用 LESS 变量。

*   我将图像变量放在一个单独的 LESS 文件中，以保持我的代码库干净

有了这一切，我仍然不确定这是否是加载图像的最佳方法。使用这种方法加载小图像减少了 HTTP 请求的数量，而且我们不必维护精灵图像。

您能想到这种方法有什么缺点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T06:49:04.507

如果任何图像发生更改，则必须更改整个 css 文件。这会破坏 HTTP 缓存。对于 sprite 图像，css 文件本身将从缓存中提供，并且只需要再次下载更改的图像。

最好只为 data:URI 图像生成一个 css 文件，为常规 CSS 内容生成另一个文件。这样，常规的 css 更新不需要重新下载 data:uri 图像。

第二个问题是前景图像，那些`<img>`在 html 中带有标签的图像。如果是经常使用的图片，则会不必要地增加 html 的大小。

# python - 如何在 Python 中保存列表并访问列表中的值--- .txt 文件

> ID：13426721
> 
> 赞同：3
> 
> 时间：2012-11-17T01:22:01.590
> 
> 标签：python, list, text

我想创建一个模块来检查一个数字是否是素数，并列出它之前的所有素数。

如果每次创建时都必须生成素数列表，则模块中的函数将花费一些时间。

如何打开与程序所在文件夹位于同一文件夹中的 .txt 文件，然后让它访问其中的数据并基于该文件创建列表？功能完成后，.txt 文件将保存为列表。我还需要一些关于如何将文件实际保存在给定位置的指导。

任何建议或提示都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:37:11.170

我会腌制一个`set`物体，你可以这样做：

```
import cPickle as pickle

primes_set = set([2,3,5])

pickle.dump(primes_set, open('primes_set.pkl', 'wb')) 

my_primes = pickle.load(open('primes_set.pkl', 'rb')) # to load the object 
```

创建泡菜文件后，您可以像这样使用它：

```
def get_primes(my_nums):
    '''
    Return only prime numbers from inputted list.
    '''
    my_primes = pickle.load(open('primes_set.pkl', 'rb'))
    return [num for num in my_nums if num in my_primes] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T01:29:11.077

看看python中的io [http://docs.python.org/2/tutorial/inputoutput.html](http://docs.python.org/2/tutorial/inputoutput.html)

当你似乎在做数字运算时，我会使用 pytables（hdf5 二进制文件）来保存加载和更新数组

[http://www.pytables.org/moin](http://www.pytables.org/moin)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T01:28:57.747

你有几个选择。如果要将列表保存为列表，[Pickle](http://docs.python.org/2/library/pickle.html)可能是最好的选择。

如果您不介意处理您的 txt 文件，那么您可以将其存储为[csv](http://docs.python.org/2/library/csv.html?highlight=csv#csv)，python 将很容易将其转换回列表。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T01:31:35.920

为了打开一个文件，只需使用

```
filereader = open("example.txt") 
```

那么变量 filereader 将包含文件的数据。

```
allprimes = []
for line in filereader:
    allprimes.append(int(line)) #assuming one number is stored per line 
```

allprimes 现在将包含存储在文件中的所有数字。

# php - PHP执行osascript与终端不同？

> ID：13426728
> 
> 赞同：2
> 
> 时间：2012-11-17T01:23:02.587
> 
> 标签：php, macos, applescript, exec, osascript

在我的客厅里，我有一台 Mac Mini，我既可以用作 HTPC，也可以用作家庭自动化服务器。它用于自动化的软件是 Shion，这是一款支持 AppleScript 的免费家庭自动化应用程序。在同一台 Mac Mini 上，我正在运行 Apache，并构建了一个接口，我可以通过该接口发送命令。（值得一提的是，该界面是使用 jQuery Mobile 构建的。）

我遇到的问题是在终端和 AppleScript 编辑器中运行良好的 AppleScript 在 Apache 错误日志中引发解析错误。由于终端和 AppleScript 编辑器成功运行脚本，我猜我编写 PHP 的方式是问题所在。但是当我检查错误日志时，它实际上是一个 AppleScript 错误。

AppleScript 命令非常简单：

```
tell application "Shion"
    execute snapshot "Evening Lighting"
end tell 
```

或者更简单：

```
tell application "Shion" to execute snapshot "Evening Lighting" 
```

这是我开始使用的原始命令，因为我不确定如何使用 -e 标志将 AppleScript 分成多行。当我将它粘贴到 AppleScript 编辑器或终端中时，它会毫无问题地执行。但是在 PHP 中运行它是行不通的：

```
$cmd = "osascript -e 'tell application \"Shion\" to execute snapshot \"Evening Lighting\"'";
exec($cmd); 
```

在日志文件中，脚本返回的错误是“ *A [sic] identifier can't go after this identifier* ”。这是多个人遇到的 AppleScript 错误，但我找不到任何一致的解决方案。我发现的一条线索是尝试将“使用应用程序“Shion”中的术语”添加到脚本的开头，使其看起来像这样：

```
using terms from application "Shion"
    tell application "Shion"
        execute snapshot "Evening Lighting"
    end tell
end using terms from 
```

我必须弄清楚如何使用 osascript 将 AppleScript 分成多行，这可以使用 -e 标志来完成。如果我将其作为常规 osascript 命令运行，它看起来像这样：

```
osascript -e 'using terms from application "Shion"' -e 'tell application "Shion"' -e 'execute snapshot "Evening Lighting"' -e 'end tell' -e 'end using terms from' 
```

再一次，它在终端以及 AppleScript 编辑器中运行没有问题。但是现在我的日志中出现了一个不同的错误：“*预期的行尾，但找到了标识符*”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T09:26:41.970

使用单引号对我有用，至少对于交互式 php：

```
$cmd = 'osascript -e \'tell application "Shion" to execute snapshot "Evening Lightning"\'' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T02:52:55.960

我不认为 PHP 语法是问题所在。我的 Mac 上没有安装 Shion，这是我在 Finder 与 PHP 中看到的：

```
$ osascript -e 'tell application "Finder" to activate'
[Finder pops to foreground]
$ osascript -e 'tell application "Shion" to execute snapshot "Evening Lightning"'
28:44: syntax error: A identifier can’t go after this identifier. (-2740)
$ php -a
Interactive shell

php > exec("osascript -e 'tell application \"Finder\" to activate'");
[Finder pops to foreground]
php > exec("osascript -e 'tell application \"Shion\" to execute snapshot \"EveningLighting\"'");
28:44: syntax error: A identifier can’t go after this identifier. (-2740) 
```

请注意，我在 shell 和 PHP 中都遇到了同样的错误，但 Finder 事件在两者中都有效。我怀疑问题在于 PHP 脚本运行的上下文：它在 apache 进程下运行，而不是在用户会话中，因此无法“看到” Shion 应用程序。

不幸的是，如果我是对的，我不知道如何让它发挥作用。

# python - 如何登录 appengine 中的任意用户以使用 Drive SDK？

> ID：13426733
> 
> 赞同：4
> 
> 时间：2012-11-17T01:23:25.467
> 
> 标签：python, google-app-engine, python-2.7, google-drive-api, google-api-python-client

我有一个应用程序需要登录到单个 Drive 帐户并使用 cron 作业自动对文件执行操作。最初，我尝试使用域管理员登录来执行此操作，但是我无法使用域管理员进行任何测试，因为您似乎无法使用域管理员帐户使用测试服务器，这使得测试我的应用程序有点不可能！

因此，我开始考虑存储 arbitray oauth 令牌（尤其是刷新令牌），以便在初始设置后自动登录此帐户。但是，所有 API 和文档都假设多个个人用户手动登录，并且我在 oauth API 中找不到允许或说明登录到当前登录用户以外的任何内容的功能。

如何以可以在测试域上测试我的代码的方式实现这一点？我可以在不编写自己的 oauth 库并手动执行 oauth 请求的情况下做到这一点吗？或者有没有办法让域管理员授权在本地测试服务器上工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T02:40:53.217

[您可以使用Remote API](https://developers.google.com/appengine/docs/python/tools/remoteapi)将单个帐户的凭据加载到您的数据存储中，这可以在您的`app.yaml`文件中启用：

```
builtins:
- remote_api: on 
```

通过执行

```
remote_api_shell.py -s your_app_id.appspot.com 
```

从命令行，您将可以访问可以在应用程序环境中执行的 shell。在执行此操作之前，请确保您已经部署了您的应用程序（下面将详细介绍本地开发），并确保通过安装并运行将其添加到您的 App Engine 项目`google-api-python-client`中包含源代码。`pip``enable-app-engine-project /path/to/project`

进入远程 shell 后（执行上述远程命令后），执行以下操作：

```
from oauth2client.appengine import CredentialsModel
from oauth2client.appengine import StorageByKeyName
from oauth2client.client import OAuth2WebServerFlow
from oauth2client.tools import run

KEY_NAME = 'your_choice_here'
CREDENTIALS_PROPERTY_NAME = 'credentials'
SCOPE = 'https://www.googleapis.com/auth/drive'

storage = StorageByKeyName(CredentialsModel, KEY_NAME, CREDENTIALS_PROPERTY_NAME)
flow = OAuth2WebServerFlow(
    client_id=YOUR_CLIENT_ID,
    client_secret=YOUR_CLIENT_SECRET,
    scope=SCOPE)

run(flow, storage) 
```

**注意：如果您没有使用`google-api-python-client`代码部署应用程序，这将失败，因为您的应用程序将不知道如何在本地机器上进行相同的导入，例如`from oauth2client.appengine import CredentialsModel`.**

调用时`run`，您的 Web 浏览器将打开并提示您接受您指定的客户端的 OAuth 访问权限，`CLIENT_ID`并且`CLIENT_SECRET`在成功完成后，它将`CredentialsModel`在已部署应用程序的数据存储中保存一个实例，`your_app_id.appspot.com`并将其存储使用`KEY_NAME`您提供的。

完成此操作后，应用程序中的任何调用者（包括您的 cron 作业）都可以通过执行访问这些凭据

```
storage = StorageByKeyName(CredentialsModel, KEY_NAME, CREDENTIALS_PROPERTY_NAME)
credentials = storage.get() 
```

**当地发展：**

如果您想在本地进行测试，您可以通过 dev_appserver.py --port=PORT /path/to/project 在本地运行您的应用程序

您可以使用远程 API shell 执行相同的命令并将其指向您的本地应用程序：

```
remote_api_shell.py -s localhost:PORT 
```

到达这里后，您可以执行在远程 api shell 中执行的相同代码，并且类似的实例`CredentialsModel`将存储在本地开发服务器的数据存储区中。

如上所述，如果您没有包含正确的`google-api-python-client`模块，这将失败。

**编辑：**这曾经建议在以下位置使用交互式控制台：

```
http://localhost:PORT/_ah/admin/interactive 
```

但是发现这不起作用，因为`socket`在App Engine本地开发沙箱中不能正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T02:51:20.540

[本文介绍了如何通过让](https://developers.google.com/drive/delegation)**域管理员**将域范围的权限委派给**服务帐户**来代表您域的用户与 Google 云端硬盘进行交互

 **[这篇其他文章解释了如何使用](https://developers.google.com/drive/service-accounts)**服务帐户**与您的应用程序拥有的驱动器进行交互。

请注意，这两种方法都使用基于**JWT 的服务帐户**，并且[当前](http://code.google.com/p/google-api-python-client/issues/detail?id=184)需要[修改版本的 google-api-python-client](https://github.com/richieforeman/google-api-python-client-pycryptojwt)才能在 App Engine 上工作。

与 Google App Engine 服务帐户不同，**基于 JWT 的服务帐户**应该与开发服务器一起使用。**

# ruby-on-rails - JBuilder JSON 数组

> ID：13426736
> 
> 赞同：1
> 
> 时间：2012-11-17T01:24:04.450
> 
> 标签：ruby-on-rails, json, jbuilder

我正在使用 Ruby on Rails 和 Jbuilder gem。

我正在尝试获取这样的点的属性：

```
{
"point":[33,11]
} 
```

我的模型是这样的

```
class Point < ActiveRecord::Base
attr_accessible :x, :y
end 
```

我正在尝试这个，但没有成功，它将点作为字符串返回，我需要它作为整数。

```
json.point "[#{point.x},#{point.y}]" 
```

谢谢！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:50:41.033

基于 Qumara 的评论，您应该调用`point.x.to_i`and `point.y.to_i`。

您还应该删除数组参数周围的引号。

JBuilder 块内有问题的行应如下所示

```
json.point [point.x.to_i,point.y.to_i] 
```

# c - 用于测试串行带宽的简单、小型 C 程序

> ID：13426737
> 
> 赞同：3
> 
> 时间：2012-11-17T01:24:09.527
> 
> 标签：c, serial-port, embedded-linux

我有两台带串口的笔记本电脑。如何使用一个简单的小 C 程序测试两台机器之间串口的实际带宽？

实际上，我需要在嵌入式 Linux 系统上执行此操作，这就是为什么该实用程序必须是一个小型、简单的 C 程序（因为嵌入式环境只有有限的库支持意味着它没有 python、perl 或任何其他花哨的图书馆）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:57:27.470

我将此作为一个新问题开始，因为我不想让这个问题脱离主题：[串行端口环回测试](https://stackoverflow.com/questions/3701955/serial-port-loopback-duplex-test-in-bash-or-c-process-substitution)

这个问题是关于在环回模式下测试串行端口的带宽，这样您就不必插入实际的串行电缆。作者（sdaau）花*了很多*时间来创建一个多线程串行带宽测试程序来回答他自己的问题。然后我使用了他的简单 C 程序并将其扩展为在通过串行电缆连接的两台不同物理机器之间使用。

有必要启动“远程”端，它将等待“发起者”端（本地端）发送一个 go 字节，其中双方将继续异步传输数据。该程序（sdaau 调用 writeread.c）产生 2 个线程：一个用于写入数据，另一个用于读取数据。这样，您就充分利用了串行端口。您可以将数据文件作为命令行参数传入。

例如，这里是“远程”端：

```
./writeread /dev/ttyUSB0 115200 ./datafile.dat 3> output 
```

例如，这里是“本地”（或发起者）端：

```
./writeread /dev/ttyUSB0 115200 ./datafile.dat -I 3> output 
```

请注意，我在重定向远程端的输出时遇到了一些麻烦，这意味着这`3> output`并没有真正起作用。我不确定这是怎么回事，但我当地的工作很好。另外，请注意，远程端的输出时序存在偏差，因为它在等待启动器时有一个计时器正在运行。这意味着您应该只信任来自本地发起方的带宽打印输出（有关输出结果的详细信息，请参阅[原始](https://stackoverflow.com/questions/3701955/serial-port-loopback-duplex-test-in-bash-or-c-process-substitution)问题）。

由于在此示例中双方都发送相同的数据文件，您应该能够将“输出”文件与数据文件进行比较：

```
diff output datafile.dat 
```

将代码编译为：

```
gcc -c -Wall writeread.c
gcc writeread.o -lpthread -o writeread 
```

这是修改后的 writeread.c 代码：

```
/*
    writeread.c - based on writeread.cpp
    [SOLVED] Serial Programming, Write-Read Issue - http://www.linuxquestions.org/questions/programming-9/serial-programming-write-read-issue-822980/

    build with: gcc -o writeread -lpthread -Wall -g writeread.c
*/

#include <stdio.h>
#include <string.h>
#include <stddef.h>

#include <stdlib.h>
#include <sys/time.h>

#include <pthread.h>

#include "writeread.h"

int serport_fd;

//POSIX Threads Programming - https://computing.llnl.gov/tutorials/pthreads/#PassingArguments
struct write_thread_data{
   int  fd;
   char* comm; //string to send
   int bytesToSend;
   int writtenBytes;
   int iator; // Initiator.  0 = False, 1 = True
};

void usage(char **argv)
{
    fprintf(stdout, "Usage:\n"); 
    fprintf(stdout, "%s port baudrate file/string [-I]\n", argv[0]); 
    fprintf(stdout, "   The -I is for initiator.  Run on the remote side which "
                    "will wait, then start locally with -I which will initiate "
                    "the test.\n");
    fprintf(stdout, "Examples:\n");
    fprintf(stdout, "%s /dev/ttyUSB0 115200 /path/to/somefile.txt\n", argv[0]); 
    fprintf(stdout, "%s /dev/ttyUSB0 115200 \"some text test\"\n", argv[0]); 
}

// POSIX threads explained - http://www.ibm.com/developerworks/library/l-posix1.html
// instead of writeport
void *write_thread_function(void *arg) {
    int go = 0;
    int lastBytesWritten;
    struct write_thread_data *my_data;
    my_data = (struct write_thread_data *) arg;

    fprintf(stdout, "write_thread_function spawned\n");

    // Are we the initiator?
    if (my_data->iator == 1) {
        // We are the initiator, send the start command
        go = 0xde;
        write(my_data->fd, &go, 1);
    } else {
        // We wait for the initiator to send us the start command
        fprintf(stdout, "Waiting for initiator (start other end with -I)...\n");
        read(my_data->fd, &go, 1);
        if (go == 0xde) {
            fprintf(stdout, "Go!\n");
        } else {
            fprintf(stdout, "Error: Did not receive start command [0x%x]\n", go);
            return NULL;
        }
    }

    my_data->writtenBytes = 0; 
    while(my_data->writtenBytes < my_data->bytesToSend)
    {
        lastBytesWritten = write( my_data->fd, my_data->comm + my_data->writtenBytes, my_data->bytesToSend - my_data->writtenBytes );   
        my_data->writtenBytes += lastBytesWritten;  
        if ( lastBytesWritten < 0 ) 
        {
            fprintf(stdout, "write failed!\n");
            return 0;
        }
        fprintf(stderr, "   write: %d - %d\n", lastBytesWritten, my_data->writtenBytes);
    }
    return NULL; //pthread_exit(NULL)
}

int main( int argc, char **argv ) 
{

    if( argc < 4 ) { 
        usage(argv);
        return 1; 
    }

    char *serport;
    char *serspeed;
    speed_t serspeed_t;
    char *serfstr;
    int serf_fd; // if < 0, then serfstr is a string
    int sentBytes; 
    int readChars;
    int recdBytes, totlBytes; 

    char* sResp;
    char* sRespTotal;

    struct timeval timeStart, timeEnd, timeDelta;
    float deltasec, expectBps, measReadBps, measWriteBps; 

    struct write_thread_data wrdata;
    pthread_t myWriteThread;

    /* Re: connecting alternative output stream to terminal - 
    * http://coding.derkeiler.com/Archive/C_CPP/comp.lang.c/2009-01/msg01616.html 
    * send read output to file descriptor 3 if open, 
    * else just send to stdout
    */
    FILE *stdalt;
    if(dup2(3, 3) == -1) {
        fprintf(stdout, "stdalt not opened; ");
        stdalt = fopen("/dev/tty", "w");
    } else {
        fprintf(stdout, "stdalt opened; ");
        stdalt = fdopen(3, "w");
    }
    fprintf(stdout, "Alternative file descriptor: %d\n", fileno(stdalt));

    // Get the PORT name
    serport = argv[1];
    fprintf(stdout, "Opening port %s;\n", serport);

    // Get the baudrate
    serspeed = argv[2];
    serspeed_t = string_to_baud(serspeed);
    fprintf(stdout, "Got speed %s (%d/0x%x);\n", serspeed, serspeed_t, serspeed_t);

    //Get file or command;
    serfstr = argv[3];

    // Are we the initiator?
    if (argc == 5 &&
        strncmp(argv[4], "-I", 3) == 0 )
    {
        wrdata.iator = 1; // Initiator.  0 = False, 1 = True
    } else {
        wrdata.iator = 0; // Initiator.  0 = False, 1 = True
    }

    serf_fd = open( serfstr, O_RDONLY );
    fprintf(stdout, "Got file/string '%s'; ", serfstr);
    if (serf_fd < 0) {
        wrdata.bytesToSend = strlen(serfstr);
        wrdata.comm = serfstr; //pointer already defined 
        fprintf(stdout, "interpreting as string (%d).\n", wrdata.bytesToSend);
    } else {
        struct stat st;
        stat(serfstr, &st);
        wrdata.bytesToSend = st.st_size;
        wrdata.comm = (char *)calloc(wrdata.bytesToSend, sizeof(char));
        read(serf_fd, wrdata.comm, wrdata.bytesToSend);
        fprintf(stdout, "opened as file (%d).\n", wrdata.bytesToSend);
    }

    sResp = (char *)calloc(wrdata.bytesToSend, sizeof(char));
    sRespTotal = (char *)calloc(wrdata.bytesToSend, sizeof(char));

    // Open and Initialise port
    serport_fd = open( serport, O_RDWR | O_NOCTTY | O_NONBLOCK );
    if ( serport_fd < 0 ) { perror(serport); return 1; }
    initport( serport_fd, serspeed_t );

    wrdata.fd = serport_fd;

    sentBytes = 0; recdBytes = 0;

    gettimeofday( &timeStart, NULL );

    // start the thread for writing.. 
    if ( pthread_create( &myWriteThread, NULL, write_thread_function, (void *) &wrdata) ) {
        printf("error creating thread.");
        abort();
    }

    // run read loop 
    while ( recdBytes < wrdata.bytesToSend )
    {

        while ( wait_flag == TRUE );

        if ( (readChars = read( serport_fd, sResp, wrdata.bytesToSend)) >= 0 ) 
        {
            //~ fprintf(stdout, "InVAL: (%d) %s\n", readChars, sResp);
            // binary safe - add sResp chunk to sRespTotal
            memmove(sRespTotal+recdBytes, sResp+0, readChars*sizeof(char));
            /* // text safe, but not binary:
            sResp[readChars] = '\0'; 
            fprintf(stdalt, "%s", sResp);
            */
            recdBytes += readChars;
        } else {
            if ( errno == EAGAIN ) 
            {
                fprintf(stdout, "SERIAL EAGAIN ERROR\n");
                return 0;
            } 
            else 
            {
                fprintf(stdout, "SERIAL read error: %d = %s\n", errno , strerror(errno));
                return 0;
            }           
        }
        fprintf(stderr, "   read: %d\n", recdBytes);        

        wait_flag = TRUE; // was ==
        //~ usleep(50000);
    }

    if ( pthread_join ( myWriteThread, NULL ) ) {
        printf("error joining thread.");
        abort();
    }

    gettimeofday( &timeEnd, NULL );

    // binary safe - dump sRespTotal to stdalt
    fwrite(sRespTotal, sizeof(char), recdBytes, stdalt);

    // Close the open port
    close( serport_fd );
    if (!(serf_fd < 0)) { 
        close( serf_fd );
        free(wrdata.comm); 
    } 
    free(sResp);
    free(sRespTotal);

    fprintf(stdout, "\n+++DONE+++\n");

    sentBytes = wrdata.writtenBytes; 
    totlBytes = sentBytes + recdBytes;
    timeval_subtract(&timeDelta, &timeEnd, &timeStart);
    deltasec = timeDelta.tv_sec+timeDelta.tv_usec*1e-6;
    expectBps = atoi(serspeed)/10.0f; 
    measWriteBps = sentBytes/deltasec;
    measReadBps = recdBytes/deltasec;

    fprintf(stdout, "Wrote: %d bytes; Read: %d bytes; Total: %d bytes. \n", sentBytes, recdBytes, totlBytes);
    fprintf(stdout, "Start: %ld s %ld us; End: %ld s %ld us; Delta: %ld s %ld us. \n", timeStart.tv_sec, timeStart.tv_usec, timeEnd.tv_sec, timeEnd.tv_usec, timeDelta.tv_sec, timeDelta.tv_usec);
    fprintf(stdout, "%s baud for 8N1 is %d Bps (bytes/sec).\n", serspeed, (int)expectBps);
    fprintf(stdout, "Measured: write %.02f Bps (%.02f%%), read %.02f Bps (%.02f%%), total %.02f Bps.\n", measWriteBps, (measWriteBps/expectBps)*100, measReadBps, (measReadBps/expectBps)*100, totlBytes/deltasec);

    return 0;
} 
```

这是我从原始问题重命名为 writeread.h 的 .h 文件：

```
/* writeread.h
    (C) 2004-5 Captain http://www.captain.at

    Helper functions for "ser"

    Used for testing the PIC-MMC test-board
    http://www.captain.at/electronic-index.php
*/

#include <stdio.h>   /* Standard input/output definitions */
#include <string.h>  /* String function definitions */
#include <unistd.h>  /* UNIX standard function definitions */
#include <fcntl.h>   /* File control definitions */
#include <errno.h>   /* Error number definitions */
#include <termios.h> /* POSIX terminal control definitions */
#include <sys/signal.h>
#include <sys/stat.h>
#include <sys/types.h>

#define TRUE    1
#define FALSE   0

int wait_flag = TRUE;   // TRUE while no signal received

// Definition of Signal Handler
void DAQ_signal_handler_IO ( int status )
{
    //~ fprintf(stdout, "received SIGIO signal %d.\n", status);
    wait_flag = FALSE;
}

int writeport( int fd, char *comm ) 
{
    int len = strlen( comm );
    int n = write( fd, comm, len );

    if ( n < 0 ) 
    {
        fprintf(stdout, "write failed!\n");
        return 0;
    }

    return n;
}

int readport( int fd, char *resp, size_t nbyte ) 
{
    int iIn = read( fd, resp, nbyte );
    if ( iIn < 0 ) 
    {
        if ( errno == EAGAIN ) 
        {
            fprintf(stdout, "SERIAL EAGAIN ERROR\n");
            return 0;
        } 
        else 
        {
            fprintf(stdout, "SERIAL read error: %d = %s\n", errno , strerror(errno));
            return 0;
        }
    }

    if ( resp[iIn-1] == '\r' )
        resp[iIn-1] = '\0';
    else
        resp[iIn] = '\0';

    return iIn;
}

int getbaud( int fd ) 
{
    struct termios termAttr;
    int inputSpeed = -1;
    speed_t baudRate;
    tcgetattr( fd, &termAttr );
    // Get the input speed
    baudRate = cfgetispeed( &termAttr );
    switch ( baudRate )
    {
        case B0:      inputSpeed = 0; break;
        case B50:     inputSpeed = 50; break;
        case B110:    inputSpeed = 110; break;
        case B134:    inputSpeed = 134; break;
        case B150:    inputSpeed = 150; break;
        case B200:    inputSpeed = 200; break;
        case B300:    inputSpeed = 300; break;
        case B600:    inputSpeed = 600; break;
        case B1200:   inputSpeed = 1200; break;
        case B1800:   inputSpeed = 1800; break;
        case B2400:   inputSpeed = 2400; break;
        case B4800:   inputSpeed = 4800; break;
        case B9600:   inputSpeed = 9600; break;
        case B19200:  inputSpeed = 19200; break;
        case B38400:  inputSpeed = 38400; break;
        case B115200: inputSpeed = 115200; break;
        case B2000000: inputSpeed = 2000000; break; //added
    }
    return inputSpeed;
}

/* ser.c
    (C) 2004-5 Captain http://www.captain.at

    Sends 3 characters (ABC) via the serial port (/dev/ttyS0) and reads
    them back if they are returned from the PIC.

    Used for testing the PIC-MMC test-board
    http://www.captain.at/electronic-index.php

*/

int initport( int fd, speed_t baudRate ) 
{
    struct termios options;
    struct sigaction saio;  // Definition of Signal action

    // Install the signal handler before making the device asynchronous
    saio.sa_handler = DAQ_signal_handler_IO;
    saio.sa_flags = 0;
    saio.sa_restorer = NULL;
    sigaction( SIGIO, &saio, NULL );

    // Allow the process to receive SIGIO
    fcntl( fd, F_SETOWN, getpid() );
    // Make the file descriptor asynchronous (the manual page says only 
    // O_APPEND and O_NONBLOCK, will work with F_SETFL...)
    fcntl( fd, F_SETFL, FASYNC );
    //~ fcntl( fd, F_SETFL, FNDELAY); //doesn't work; //fcntl(file, F_SETFL, 0);

    // Get the current options for the port...
    tcgetattr( fd, &options );
/*       
    // Set port settings for canonical input processing
    options.c_cflag = BAUDRATE | CRTSCTS | CLOCAL | CREAD;
    options.c_iflag = IGNPAR | ICRNL;
    //options.c_iflag = IGNPAR;
    options.c_oflag = 0;
    options.c_lflag = ICANON;
    //options.c_lflag = 0;
    options.c_cc[VMIN] = 0;
    options.c_cc[VTIME] = 0;
*/   
    /* ADDED - else 'read' will not return, unless it sees LF '\n' !!!!
    * From: Unix Programming Frequently Asked Questions - 3\. Terminal I/O - 
    * http://www.steve.org.uk/Reference/Unix/faq_4.html 
    */
    /* Disable canonical mode, and set buffer size to 1 byte */
    options.c_lflag &= (~ICANON);
    options.c_cc[VTIME] = 0;
    options.c_cc[VMIN] = 1; 

    // Set the baud rates to...
    cfsetispeed( &options, baudRate );
    cfsetospeed( &options, baudRate );

    // Enable the receiver and set local mode...
    options.c_cflag |= ( CLOCAL | CREAD );
    options.c_cflag &= ~PARENB;
    options.c_cflag &= ~CSTOPB;
    options.c_cflag &= ~CSIZE;
    options.c_cflag |= CS8;

    // Flush the input & output...
    tcflush( fd, TCIOFLUSH );

    // Set the new options for the port...
    tcsetattr( fd, TCSANOW, &options );

    return 1;
}

/* 
    ripped from 
    http://git.savannah.gnu.org/cgit/coreutils.git/tree/src/stty.c
*/

#define STREQ(a, b)     (strcmp((a), (b)) == 0)

struct speed_map
{
  const char *string;       /* ASCII representation. */
  speed_t speed;        /* Internal form. */
  unsigned long int value;  /* Numeric value. */
};

static struct speed_map const speeds[] =
{
  {"0", B0, 0},
  {"50", B50, 50},
  {"75", B75, 75},
  {"110", B110, 110},
  {"134", B134, 134},
  {"134.5", B134, 134},
  {"150", B150, 150},
  {"200", B200, 200},
  {"300", B300, 300},
  {"600", B600, 600},
  {"1200", B1200, 1200},
  {"1800", B1800, 1800},
  {"2400", B2400, 2400},
  {"4800", B4800, 4800},
  {"9600", B9600, 9600},
  {"19200", B19200, 19200},
  {"38400", B38400, 38400},
  {"exta", B19200, 19200},
  {"extb", B38400, 38400},
#ifdef B57600
  {"57600", B57600, 57600},
#endif
#ifdef B115200
  {"115200", B115200, 115200},
#endif
#ifdef B230400
  {"230400", B230400, 230400},
#endif
#ifdef B460800
  {"460800", B460800, 460800},
#endif
#ifdef B500000
  {"500000", B500000, 500000},
#endif
#ifdef B576000
  {"576000", B576000, 576000},
#endif
#ifdef B921600
  {"921600", B921600, 921600},
#endif
#ifdef B1000000
  {"1000000", B1000000, 1000000},
#endif
#ifdef B1152000
  {"1152000", B1152000, 1152000},
#endif
#ifdef B1500000
  {"1500000", B1500000, 1500000},
#endif
#ifdef B2000000
  {"2000000", B2000000, 2000000},
#endif
#ifdef B2500000
  {"2500000", B2500000, 2500000},
#endif
#ifdef B3000000
  {"3000000", B3000000, 3000000},
#endif
#ifdef B3500000
  {"3500000", B3500000, 3500000},
#endif
#ifdef B4000000
  {"4000000", B4000000, 4000000},
#endif
  {NULL, 0, 0}
};

static speed_t
string_to_baud (const char *arg)
{
  int i;

  for (i = 0; speeds[i].string != NULL; ++i)
    if (STREQ (arg, speeds[i].string))
      return speeds[i].speed;
  return (speed_t) -1;
}

/* http://www.gnu.org/software/libtool/manual/libc/Elapsed-Time.html
Subtract the `struct timeval' values X and Y,
storing the result in RESULT.
Return 1 if the difference is negative, otherwise 0\.  */
int timeval_subtract (struct timeval *result, struct timeval *x, struct timeval *y)
{
    /* Perform the carry for the later subtraction by updating y. */
    if (x->tv_usec < y->tv_usec) {
     int nsec = (y->tv_usec - x->tv_usec) / 1000000 + 1;
     y->tv_usec -= 1000000 * nsec;
     y->tv_sec += nsec;
    }
    if (x->tv_usec - y->tv_usec > 1000000) {
     int nsec = (x->tv_usec - y->tv_usec) / 1000000;
     y->tv_usec += 1000000 * nsec;
     y->tv_sec -= nsec;
    }

    /* Compute the time remaining to wait.
      tv_usec is certainly positive. */
    result->tv_sec = x->tv_sec - y->tv_sec;
    result->tv_usec = x->tv_usec - y->tv_usec;

    /* Return 1 if result is negative. */
    return x->tv_sec < y->tv_sec;
} 
```

# android - 如何使用 rm 递归删除所有以前缀开头的目录

> ID：13426738
> 
> 赞同：2
> 
> 时间：2012-11-17T01:24:15.027
> 
> 标签：android, shell, adb

如何删除所有以前缀开头的目录，所以我有这样的东西

*   西兹迪尔布拉
*   xyzdir2
*   xyzdir3
*   xyzdir4
*   ..更多的

想通过 adb shell , android 做

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-28T03:24:57.057

这是正确的命令：

```
rm -r xyzdir* 
```

乔纳森的回答不起作用，因为`adb`不认识`-f`开关。

* * *

编辑：我相信这不是问题的重点，但如果你想备用文件调用`xyzdir*`然后使用乔纳森的命令没有`-f`：

```
for i in xyzdir*; do [ -d $i ] && rm -r $i; done 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:28:15.350

```
rm -rf xyzdir* 
```

`rm`是删除东西的命令。

`-r`表示递归删除目录。 `-f`意思是不要问问题，不要抱怨。 `-rf`意味着这两个东西在一起。

`xyzdir*`扩展为以“xyzdir”开头的文件的名称（包括目录名称，因为在类 Unix 系统中——包括 Android——目录实际上只是一种特殊的文件。）

*如果您不想*删除具有相同前缀的非目录文件，例如“xyzdir.txt”，则必须更加小心：

```
for i in xyzdir*; do [ -d $i ] && rm -rf $i; done 
```

这将遍历每个名​​称以“xyzdir”（`for i in`部分）开头的文件或目录，检查它是否是目录（`[ -d $i ]`部分），如果是（`&&`部分），则递归删除它（`rm -rf $i`部分）。

# iphone - iPhone 上的 Facebook 登录按钮

> ID：13426739
> 
> 赞同：4
> 
> 时间：2012-11-17T01:24:38.630
> 
> 标签：iphone, facebook, mobile, facebook-javascript-sdk, facebook-oauth

我正在使用 Facebook JS SDK 登录我的网站，并且我的页面上有此代码

```
<div id="fb-root"></div>

<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({"appId":"xxxxxxxxxxxxxx","xfbml":true,"oauth":true,"status":false,"cookie":true,"logging":false});
        onFbInit();
    };

    (function() {
        var e = document.createElement('script'); 
        e.src = document.location.protocol + "\/\/connect.facebook.net\/en_US\/all.js";
        e.async = true;
        document.getElementById('fb-root').appendChild(e);
    }());
</script>

    <fb:login-button scope="email" autologoutlink="false">Log in using Facebook</fb:login-button>

<script>
    function goLogIn(){
        window.location = "/fb/login_check";
    }

    function onFbInit() {.
        if (typeof(FB)!= 'undefined' && FB!= null ) {
            FB.Event.subscribe('auth.statusChange', function(response) {
                setTimeout(goLogIn, 500);
            });
        }
    }
</script> 
```

这在所有桌面浏览器和 iPad 上都可以正常工作，但在 iPhone/iPod 上的 Mobile Safari 上，登录按钮会打开一个新选项卡，但不会发回页面，因此不会调用回调。当我单击登录（或注册）页面上的 Facebook 登录按钮时，它会在新选项卡中打开 Facebook oauth 登录页面，我输入我的 Facebook 登录详细信息，Facebook 选项卡会关闭，但焦点不会返回到我的登录页面. 我没有 Mac 来使用检查器，但一位朋友说他们在调试控制台中收到此错误“无法向[https://m.facebook.com/](https://m.facebook.com/)发布消息。收件人来自[https://www。 facebook.com/](https://www.facebook.com/) “

要重现这些步骤：

1.  在 iPhone 上访问[http://eventstagr.am/register（Safari](http://eventstagr.am/register) Mobile 和 Chrome 都不起作用）
2.  点击注册

    *   **预期**：Facebook 选项卡应关闭并在注册页面上调用 javascript 回调函数
    *   **实际**：Facebook 选项卡关闭，焦点未返回注册页面

或者，如果您已经有一个帐户，请重复上述步骤，但从[http://eventstagr.am/login](http://eventstagr.am/login)开始，结果是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T18:31:20.233

您是否已注册您的应用程序以进行移动 Web 登录？您可以通过进入[Facebook 应用设置来执行此操作（](http://developers.facebook.com/apps/)[根据 Facebook 的说明](http://developers.facebook.com/docs/howtos/login/login-for-mobile-web/)） 。

# c++ - Visual Studio 2012 和 2010 - kernel32.lib、windows.h

> ID：13426740
> 
> 赞同：10
> 
> 时间：2012-11-17T01:25:12.620
> 
> 标签：c++, visual-studio-2010, visual-studio-2012

我刚刚将 Visual Studio 2012 与 Visual Studio 2010 一起安装。问题是我无法将简单项目从 2010 转换为 2012 - 它们无法链接到 kernel32.lib 等文件或包含 windows.h 等文件。我的系统还安装了 Windows SDK 7.1。

我曾尝试为我的 x86 和 x64 用户平台使用 Property Manager（因为我在那里添加了适当的 $(DXSDK_DIR) 引用），结果却是混合的结果 - 有时它只是工作，有时它编译但不链接，其他时候它只是停在 windows.h

例如，目前我正在

```
1>LINK : fatal error LNK1104: cannot open file 'kernel32.lib' 
```

或者

```
1>Source.cpp(2): fatal error C1083: Cannot open include file: 'windows.h': No such file or directory 
```

（取决于是否包含“windows.h”）仅在 x64 中具有简单的“hello world”类型程序。

我现在可以在项目属性中`Active(Debug) / Active(x64) -> VC++ Directories -> Include Directories`看到`$(VCInstallDir)include;$(VCInstallDir)atlmfc\include;$(WindowsSDK_IncludePath);$(DXSDK_DIR)Include`. 如果我展开该输入框并单击编辑，我会看到：

```
$(VCInstallDir) = C:\Program Files (x86)\Microsoft Visual Studio 11.0\VC\
$(WindowsSDK_IncludePath) = c:\Program Files (x86)\Windows Kits\8.0\Include\um;c:\Program Files (x86)\Windows Kits\8.0\Include\shared;c:\Program Files (x86)\Windows Kits\8.0\Include\WinRT 
```

虽然我的平台工具集 v110 windows.h 位于`c:\Program Files (x86)\Windows Kits\8.0\Include\um\Windows.h`（所以应该没有问题）。如果我选择 Windows SDK 7.1 作为平台工具集，这些东西就可以工作。

除了格式化和重新安装 Windows 之外的任何解决方案？

LE 如果我用系统内的绝对路径替换 $(variable) 目录，一切正常。我不明白我为什么要这样做，因为我也在与其他人分享这个项目。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-12-12T20:00:32.770

我知道上面几乎有答案。但...

问题似乎是在安装 VS2012 和 VS2010 时，VS2012 的配置无法正常工作。

修复方法是编辑 %home%\AppData\Local\Microsoft\MSBuild\v4.0 中的 props 文件。

这些是对我有用的文件，使用 SDK v8.1。

第一个用于 32 位构建的 Microsoft.Cpp.Win32.user.props：

```
<?xml version="1.0" encoding="utf-8"?> 
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <IncludePath>C:\Program Files (x86)\Windows Kits\8.1\include\um;C:\Program Files (x86)\Windows Kits\8.1\include\shared;C:\Program Files (x86)\Windows Kits\8.1\include\winrt;$(IncludePath)</IncludePath>
    <LibraryPath>C:\Program Files (x86)\Windows Kits\8.1\Lib\winv6.3\um\x86;$(LibraryPath)</LibraryPath>
    <ExecutablePath>C:\Program Files (x86)\Windows Kits\8.1\bin\x86;$(ExecutablePath)</ExecutablePath>
  </PropertyGroup>
</Project> 
```

现在 Microsoft.Cpp.x64.user.props 用于 64 位构建：

```
<?xml version="1.0" encoding="utf-8"?> 
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <IncludePath>C:\Program Files (x86)\Windows Kits\8.1\include\um;C:\Program Files (x86)\Windows Kits\8.1\include\shared;C:\Program Files (x86)\Windows Kits\8.1\include\winrt;$(IncludePath)</IncludePath>
    <LibraryPath>C:\Program Files (x86)\Windows Kits\8.1\Lib\winv6.3\um\x64;$(LibraryPath)</LibraryPath>
    <ExecutablePath>C:\Program Files (x86)\Windows Kits\8.1\bin\x64;$(ExecutablePath)</ExecutablePath>
  </PropertyGroup>
</Project> 
```

我希望这可以帮助其他人解决这个问题，我还没有在其他任何地方找到解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-09T12:43:28.053

我有一个类似的问题。
在我的情况下，这是因为在项目设置中没有继承正确的路径。

检查路径是否继承于：**Project -> Properties -> VC++ Directories**
Under **Include** and **Library Directories**转到**Edit**。

确保`Inherit from parent or project defaults`已选中。

VS2012 默认属性和宏设置正确。（虽然我遇到了常见的安装问题，我不得不替换所有的 VC 目录，因为它甚至没有安装 C++ 核心库）

# jquery-mobile - Cordova/Phonegap 后退按钮处理程序不起作用

> ID：13426742
> 
> 赞同：1
> 
> 时间：2012-11-17T01:25:55.957
> 
> 标签：jquery-mobile, cordova, android-4.0-ice-cream-sandwich, back-button

我正在使用 Phonegap 和 jQuery Mobile。这是我的代码：

```
function onDeviceReady() {
  // Register the event listener
  document.addEventListener("backbutton", onBackKeyDown, false);
  setPage();
}
function setPage(){
  //All pages at least 100% of viewport height
  var viewPortHeight = $(window).height();
  //alert(viewPortHeight );
  var headerHeight = $('div[data-role="header"]').height();
  var footerHeight = $('div[data-role="footer"]').height();
  var contentHeight = viewPortHeight - headerHeight - footerHeight-120;
  // Set all pages with class="page-content" to be at least contentHeight
  $('div[class="page-content"]').css({'min-height': contentHeight + 'px'});
}
function confirmExit(){
  alert("exit...");
}
// Call onDeviceReady when Cordova is loaded.
// At this point, the document has loaded but cordova-2.2.0.js has not.
// When Cordova is loaded and talking with the native device,
// it will call the event `deviceready`.
//
function onLoad() { alert("onload");
  document.addEventListener("deviceready", onDeviceReady, false);
}
// Handle the back button
function onBackKeyDown() {
  alert("onbackkeydown");
  console.log("back clicked");
  confirmExit();
}
$(document).ready(function(){}); 
```

在body标签中：

```
<body onload="onLoad();"> 
```

但是当我加载应用程序时，我只会在`onLoad`方法中收到警报。

我做错了什么？

非常感谢。

# python - Python Web 框架中的 HTTP 请求之间的资源如何保留？

> ID：13426748
> 
> 赞同：3
> 
> 时间：2012-11-17T01:28:05.783
> 
> 标签：python, flask

我实际上是 Python Web 开发的新手。我之前关于 Web 开发的知识来自 PHP。

在 PHP 中，两个不同的 HTTP 请求之间没有保留资源（变量等）（除了`$_SESSION`我猜？）

那么如果`Flask`is run by `gunicorn`，两个不同的 HTTP 请求之间会保留什么资源呢？

[这个](http://flask.pocoo.org/docs/patterns/sqlalchemy/)`Flask`问题来自. 在文档中，它说我们需要在`app.teardown_request`. 在我自己的测试中，如果我没有注册会话关闭代码，数据库会得到很多空闲连接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T03:49:36.450

实际上只有两种处理 Web 请求的模式：

1.  为每个请求启动整个应用程序，并在每个请求后将其拆除。所有未持久化的东西（到其他进程、磁盘或客户端）在请求结束时都会被*销毁*。
2.  启动应用程序，然后让它在被拆除之前处理​​多个请求。几乎所有不特定于请求的内容都会在请求之间*保留*。

模式 #1 对每个请求都有更多的工作要做，但它确保应用程序使用的所有资源都被拆除（因此即使您忘记关闭它们，您也不会遇到泄漏数据库连接的问题）。

模式 #2 对每个请求的工作量较少，但应用程序可能会“泄漏”资源 - 就像在您的示例中，如果您没有显式关闭数据库连接，则会泄漏数据库连接。

PHP（在 Apache 下以嵌入模式运行`mod_php`）使用第一种模式。Flask（以及目前用于 Web 开发的大多数语言的框架）使用第二种。

# json - 在 Play Framework 2.0 Scala 中处理 JSON 请求

> ID：13426752
> 
> 赞同：5
> 
> 时间：2012-11-17T01:28:27.473
> 
> 标签：json, scala, playframework, playframework-2.0

我正在尝试使用 JSON 请求将数据从客户端发送到服务器。JSON 请求的正文如下所示：

```
{
"upload":
    {
    "ok":"some message",
    "assemblyId":"a9d8f72q3hrq982hf98q3"
    }
} 
```

Play 能够将请求正文识别为 JSON，但是当我尝试解析单个值（即“上传”对象）时，Play 抱怨它找不到指定的参数。

Scala方法如下：

```
def add(course:Long) = withAccount { account => implicit request =>
  println()
  println(request.body)  // output: AnyContentAsJson({"upload":{"ok":"ASSEMBLY_COMP...

  request.body.asJson.map { json =>
    println()
    println(json)  // output: {"upload":{"ok":"ASSEMBLY_COMPLETED","assemb...

    (json \ "upload").asOpt[models.SomeClass].map { upload =>
      Ok("Got upload")
    }.getOrElse {
      BadRequest("Missing parameter [upload]")
    }
  }.getOrElse {
    BadRequest("Expecting Json data")
  }
} 
```

我无法理解上述代码失败的原因。该方法可以轻松地将请求正文映射到 json 对象。“println(json)”命令打印出与 Chrome 显示的“请求有效负载”完全相同的内容。然而，当我尝试抓取根对象“上传”时，它失败了。该方法返回一个错误的请求，抱怨缺少参数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T01:43:54.737

要做 asOpt[models.SomeClass] 需要有一个`Reads`实例才能工作。

这是一个例子

```
case class SomeClass(ok: String, assemblyId: String)
implicit object SomeClassReads extends Reads[SomeClass] {
  def reads(json: JsValue) = 
    SomeClass((json \ "ok").as[String], (json \ "assemblyId").as[String])
} 
```

[您可以在https://github.com/playframework/Play20/blob/2.0.x/framework/src/play/src/main/scala/play/api/libs/json/Reads](https://github.com/playframework/Play20/blob/2.0.x/framework/src/play/src/main/scala/play/api/libs/json/Reads.scala#L35)查看如何实现 Reads 实例 [.scala#L35](https://github.com/playframework/Play20/blob/2.0.x/framework/src/play/src/main/scala/play/api/libs/json/Reads.scala#L35)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T17:55:23.333

如果您使用 play 2.1x，Reads 与 2.0x 相比有所改变，这可能是您的主要问题（像我一样）。

[你可以在这里](http://mandubian.com/2012/09/08/unveiling-play-2-dot-1-json-api-part1-jspath-reads-combinators/)找到一个很好的解释。

只需此代码即可正常工作：

```
import play.api.libs.json._
import play.api.libs.functional.syntax._

case class Person(name: String, age: Int, lovesChocolate: Boolean)

implicit val personReads = Json.reads[Person] 
```

看起来很神奇不是吗？但是有几点需要注意：

*   隐式定义应该在控制器中。当然，还有一些其他的方法可以做到这一点。

*   如果您的模型在模型类中（在上面的示例中位于控制器中），则不应将对象命名为与您的类相同。在这种情况下，它不起作用：

    ```
    case class Person(name: String, age: Int, lovesChocolate: Boolean)    

    object Person{....}  //this won't work 
    ```

这种方式有很大的优势。我强烈建议您查看[此](http://mandubian.com/2012/09/08/unveiling-play-2-dot-1-json-api-part1-jspath-reads-combinators/)博客。

# assembly - 将数据放入特定位

> ID：13426753
> 
> 赞同：-2
> 
> 时间：2012-11-17T01:28:38.403
> 
> 标签：assembly, solaris, sparc

我正在尝试学习 SPARC 并尝试创建一个大小为 4,000 字节的数组。在这个数组内部，我需要计算一个偏移量以将值放置在该数组中的正确位置。我想我知道如何调整数组的大小（只需使用.skip？）并且我知道如何计算我的偏移量，但是谁能告诉我如何将值放入正确的字节中？感谢大家。编辑：我最初说的是位，意思是说字节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:40:39.057

使用 read-modify-write 和正确的按位操作（`AND`清除位，`OR`设置位）。如果内存不是问题，您当然也可以为每一位使用一个字节。

**更新**：示例代码说明如何清除数组中的位。设置一个位是类似的，除了使用`andn`它而不是使用`or`.

```
! clear bit index %o0 in "array"
clrbit:
    mov %o0, %o1
    srl %o0, 3, %o0     ! byte offset
    and %o1, 7, %o1     ! bit offset
    set array, %o2      ! array base
    add %o2, %o0, %o0   ! byte address
    set 1, %o3          ! bit mask
    sll %o3, %o1, %o1   ! 1 << bit offset
    ldub [%o0], %o3     ! load byte
    andn %o3, %o1, %o3  ! mask off bit to clear
    stb %o3, [%o0]      ! write back
    retl
    nop 
```

哦，我看到问题已更新为字节而不是位。嗯，这更容易。假设索引 in `%o0`，要写入的数据`%o1`：

```
set array, %o2      ! array base address
add %o2, %o0, %o2   ! add byte offset
stb %o1, [%o2]      ! write byte 
```

# design-patterns - 使用带有策略设计模式的工厂

> ID：13426761
> 
> 赞同：5
> 
> 时间：2012-11-17T01:30:40.360
> 
> 标签：design-patterns, uml, factory-pattern, strategy-pattern

好的，所以我被分配了一个任务，要求我同时使用策略和工厂设计模式。这是问题所在：

您正在为银行开发用于处理贷款的应用程序。有一个`Loan`类有一个方法`capital()`。该`capital()`方法包含一个丑陋的 if-then-else 条件，它检查一些 Loan 对象实例属性并根据属性对贷款类型使用正确的策略。这是该方法的伪代码`capital()`：

```
capital() {
    if (expiry == null && maturity != null) {
        // Find capital for term loan
        return commitment * duration * riskFactor;
    }
    if (expiry != null && maturity == null) {
        if (getUnusedPercentage() != 1.0) {
            // Find capital for revolving loan
            return commitment * unusedPercentage * duration * riskFactor;
        } else {
            // Find capital for complex loan
            return (outstandingRiskAmount * duration * riskFactor) + (unusedRiskAmount * duration * unusedRiskFactor);
        }
    }
} 
```

我们想在这个设计中引入策略模式。创建一个创建适当策略对象的工厂。使工厂成为单例类。绘制一个 UML 图并编写对应的代码片段来替换该`capital()`方法。记住：使用策略的关键是：客户端应该提供一个上下文对象。

好的，所以我已经绘制了一个 UML 图。我对 Singleton 的理解非常扎实，所以我认为我已经理解了。我想我也非常了解战略。但是，我无法说服自己，我使用 Factory 创建 Strategy 对象的设置是解决此问题的最佳方式。[在这里查看我的图表](https://creately.com/diagram/h9iz0hed1/k1qrVk65mVBzCJTyXZjmjeIhNM=)。我计划编写一个创建贷款的客户端对象，使用贷款作为上下文对象（通过 Loan 构造函数通过工厂创建它，使用适当的策略对其进行初始化）。这`capital()`然后方法将执行它已配置的任何策略。如果我的理解是正确的，我在这里设置工厂的方式是通过添加一个间接层来将贷款（上下文）与策略完全分离。

我不确定的一件事是如何获取在原始资本方法内部发生的计算过程中使用的数据。对于某些策略，仅使用少数参数（对于定期贷款，仅使用承诺、期限和风险因素，但复杂贷款使用贷款的所有可用属性）。我的`calculateCapital()`方法（由所有策略实现）是否应该将所有六个属性都作为参数？

有没有更好的方法来使用带有策略模式的工厂来获得更好的结果？我应该改用 AbstractFactory 还是 Factory Method？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-17T21:02:51.007

这是我对这个问题的解释和我的回答：

工厂必须制定适当的策略。只有知道贷款的性质，它才能做到这一点。因此，必须通过您喜欢的任何注入方法向工厂提供贷款，然后使用贷款的属性来决定返还哪种策略。

因此，现在您有了适合贷款类型的策略，您必须计算资本。同样，这取决于贷款的性质。因此，策略需要贷款。这可以通过工厂中的构造函数或通过 capital/calculateCapital 方法的参数注入。

这使它保持美观和简单，松散耦合和抽象。

就像是：

```
ICapitalStrategy s = LoanStrategyFactory.Create(loan);
s.CalculateCapital(loan); 
```

# linq-to-sql - Linq to SQL 多个外键指向同一个主键 - Visual Studio intellisense

> ID：13426765
> 
> 赞同：1
> 
> 时间：2012-11-17T01:31:32.247
> 
> 标签：linq-to-sql

对不起。想不出更好的标题。这是我的困境。我的sql表如下：

```
create table MainTable (UserId,somefields);
create table SecondaryTable(pkid, somefields, UserId,CreatedBy,UpdatedBy); 
```

UserId、CreatedBy、UpdatedBy 是引用 MainTable(UserId) 的外键。现在作为我的 linq 查询的一部分，我经常（错误地）做类似的事情

```
dbContext.SecondaryTable.Where(r=>r.MainTable.someOtherChainingHere) 
```

关键是，我总是（错误地）假设 Linq 会自动在可能的字段中选择最佳匹配。由于 UserId 是公共字段，我认为它会引用它。但事实并非如此。我似乎是按字母顺序排列的。意思是，当我在 Visual Studio Intellisense 中

```
dbContext.SecondaryTable.Where(r=>r. 
```

我认为 MainTable,MainTable1,MainTable2 是我可能的选择。我怎么知道在这三个中选择正确的一个？？？？如果我没有表达得更清楚，我很抱歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T07:40:11.900

我的做法是使用部分类添加“程序员友好名称”，如下所示：

```
public partial class secondarytable
    {

        public maintable createdByUser{
            get
            {
                return this._maintable1.Entity;
            }
            set
            {
                this._maintable1= value;
            }
        } 
```

其余的参考文献等等。

我选择不对 DBML 进行任何手动更改，因此我总是可以从头开始重新创建它。

您只需要注意，当您更改 DBML 和外键定义时，1、2、3 仍然引用正确的表。

顺便说一句，好问题。我很想看到更好的选择！

# spring-security - Spring WS“无法对安全令牌进行身份验证或授权”

> ID：13426770
> 
> 赞同：3
> 
> 时间：2012-11-17T01:32:33.377
> 
> 标签：spring-security, soapui, spring-ws, soap-client

我正在使用 SpringWS-Security 为 Web 服务创建一个 Java 客户端使用者。

**我的请求 SOAP（我在 SOAP UI 中使用）**

```
<soapenv:Envelope 
xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
         xmlns:sch="http://myws.mycompany.com/myws/schema"> 

    <soapenv:Header>
        <wsse:Security soapenv:mustUnderstand="1" 
            xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">

            <wsse:UsernameToken xmlns:wsu="http://schemas.xmlsoap.org/ws/2003/06/utility">
                    <wsse:Username>myUsernameString</wsse:Username>
                    <wsse:Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">123</wsse:Password>
            </wsse:UsernameToken>
        </wsse:Security>
        </soapenv:Header>

    <soapenv:Body>
        <sch:GetUserDetails idSender="5"/>
    </soapenv:Body>

</soapenv:Envelope> 
```

**我在 WS 中的 servlet.xml。**

```
<bean name="endpointMapping"
  class="org.springframework.ws.server.endpoint.mapping.PayloadRootQNameEndpointMapping">

  <property name="interceptors">
   <list>
    <ref local="wsSecurityInterceptor" />
   </list>
 </property>

    <bean id="wsSecurityInterceptor"
                        class="org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor">
        <property name="validationActions" value="UsernameToken" />
        <property name="validationCallbackHandler" ref="springSecurityCallbackHandler" />
    </bean>

    <bean id="springSecurityCallbackHandler"
                        class="org.springframework.ws.soap.security.wss4j.callback.SpringPlainTextPasswordValidationCallbackHandler">
        <property name="authenticationManager" ref="authenticationManager"/>
    </bean>

    <bean id="authenticationProvider" class="ws.security.CustomAuthenticationProviderImpl">
            <property name="userCommonService" ref="userCommonService" />
        <security:custom-authentication-provider/>
    </bean>

    <security:authentication-manager alias="authenticationManager" />. 
```

**在我的 Java 客户端中 - applicationContext.xml**

```
<bean name="webserviceTemplate" class="org.springframework.ws.client.core.WebServiceTemplate">
        <property name="defaultUri" value="http:/localhost:8080/myws-ws/" />
        <property name="marshaller" ref="marshaller" />
        <property name="unmarshaller" ref="unmarshaller" />
        <property name="interceptors">
            <list>
                <ref local="wsSecurityInterceptor" />
            </list>
        </property>
    </bean>

    <oxm:jaxb2-marshaller id="marshaller"
        contextPath="org.example.bean.schema" />
    <oxm:jaxb2-marshaller id="unmarshaller"
        contextPath="org.example.org.bean.schema" />

    <bean id="client" class="example.client.impl.EfactClientImpl">
        <property name="webServiceTemplate" ref="webserviceTemplate" />
    </bean>

     <bean id="wsSecurityInterceptor" class="org.springframework.ws.soap.security.wss4j.Wss4jSecurityInterceptor">
        <property name="securementActions" value="UsernameToken"/>
    </bean> 
```

当我使用 SOAP UI 来使用服务时，一切都很好，我想我需要在 Java 客户端及其上下文中得到一些帮助，因为当我运行它时，我得到了这个错误：

```
The security token could not be authenticated or authorized; nested exception is: 
    javax.security.auth.callback.UnsupportedCallbackException; nested exception is org.apache.ws.security.WSSecurityException: The security token could not be authenticated or authorized; nested exception is: 
    javax.security.auth.callback.UnsupportedCallbackException 
```

当我调试我的应用程序时，我可以注意到这个元素正在崩溃：

```
GetUserRequest request = new GetUserRequest();
        request.setIdentifier(user.getIdentifier());
        request.setPassword(user.getPassword());
        GetUserResponse response = new GetUserResponse();
/* Crashing here. */
response = (GetUserResponse) getWebServiceTemplate().marshalSendAndReceive(request); 
```

仅供参考：我总是在 SpringWS 中安全地看到这个用户列表，但是如果我有很多用户试图访问怎么办。

**WS - [servlet 名称]-servlet.xml**

```
<bean id="callbackHandler" class="org.springframework.ws.soap.security.wss4j.callback.SimplePasswordValidationCallbackHandler">
    <property name="users">
      <props>
        <prop key="Bert">Ernie</prop>
        <prop key="Mickey">Mouse</prop>
      </props>
    </property>
  </bean> 
```

如何解决此 UnsupportedCallbackException 异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-23T01:45:53.510

从 cfx 2.2.X 升级到 2.7.X 时出现此错误。由于功能升级，服务器端代码无法读取密码，因此服务器收到的密码为空。确保服务器收到正确的用户名和密码，这将解决此问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-19T17:14:53.083

您必须在调用时指定 SecurementUsername 和 SecurementPassword。这是一个编程示例：

```
WebServiceTemplate webServiceTemplate = new WebServiceTemplate();
webServiceTemplate.setDefaultUri(uri);

Wss4jSecurityInterceptor interceptor = new Wss4jSecurityInterceptor();
interceptor.setSecurementActions(securementActions);
interceptor.setSecurementMustUnderstand(true);
interceptor.setSecurementUsername(usuario);
interceptor.setSecurementPassword(contrasena);

webServiceTemplate.setInterceptors(new ClientInterceptor[] {interceptor}); 
```

# c++ - MPI_Irecv 不接收所有发送？

> ID：13426771
> 
> 赞同：3
> 
> 时间：2012-11-17T01:33:01.253
> 
> 标签：c++, openmpi

我试图在这个简化的代码中实现的是：

*   2 种类型的进程（根和子进程，ids/rank 分别 = 10 和 0-9）
*   在里面：
    *   root 会听孩子“完成”
    *   全部完成后，孩子们将收听根通知
*   虽然没有赢家（尚未全部完成）：
    *   孩子们将有 20% 的机会完成（并通知 root 他们完成了）
    *   root 将检查是否已完成
        *   如果全部完成：向“获胜者”的孩子发送通知

我有如下代码：

```
int numprocs, id, arr[10], winner = -1;
bool stop = false;
MPI_Request reqs[10], winnerNotification;

MPI_Init(NULL, NULL);
MPI_Comm_size(MPI_COMM_WORLD, &numprocs);
MPI_Comm_rank(MPI_COMM_WORLD, &id);

for (int half = 0; half < 1; half++) {
    for (int round = 0; round < 1; round++) {
        if (id == 10) { // root
            // keeps track of who has "completed"
            fill_n(arr, 10, -1);
            for (int i = 0; i < 10; i++) {
                MPI_Irecv(&arr[i], 1, MPI_INT, i, 0, MPI_COMM_WORLD, &reqs[i]);
            }
        } else if (id < 10) { // children
            // listen to root of winner notification/indication to stop
            MPI_Irecv(&winner, 1, MPI_INT, 10, 1, MPI_COMM_WORLD, &winnerNotification);
        }

        while (winner == -1) {
            //cout << id << " is in loop" << endl;

            if (id < 10 && !stop && ((rand() % 10) + 1) < 3) { 
                // children has 20% chance to stop (finish work)
                MPI_Send(&id, 1, MPI_INT, 10, 0, MPI_COMM_WORLD);
                cout << id << " sending to root" << endl;
                stop = true;
            } else if (id == 10) {
                // root checks number of children completed
                int numDone = 0;
                for (int i = 0; i < 10; i++) {
                    if (arr[i] >= 0) {
                        //cout << "root knows that " << i << " has completed" << endl;
                        numDone++;
                    }
                }
                cout << "numDone = " << numDone << endl;

                // if all done, send notification to players to stop
                if (numDone == 10) {
                    winner = 1;
                    for (int i = 0; i < 10; i++) {
                        MPI_Send(&winner, 1, MPI_INT, i, 1, MPI_COMM_WORLD);
                    }
                    cout << "root sent notification of winner" << endl;
                }
            }
        }
    }
}

MPI_Finalize(); 
```

调试`cout`的输出看起来像：问题似乎是根没有收到所有孩子的通知，他们已经完成？

```
2 sending to root
3 sending to root
0 sending to root
4 sending to root
1 sending to root
8 sending to root
9 sending to root
numDone = 1
numDone = 1
... // many numDone = 1, but why 1 only?
7 sending to root
... 
```

我想也许我无法接收到一个数组：但我试过了

```
if (id == 1) {
    int x = 60;
    MPI_Send(&x, 1, MPI_INT, 0, 0, MPI_COMM_WORLD);
} else if (id == 0) {
    MPI_Recv(&arr[1], 1, MPI_INT, 1, 0, MPI_COMM_WORLD, MPI_STATUS_IGNORE);
    cout << id << " recieved " << arr[1] << endl;
} 
```

哪个有效。

**更新**

`MPI_Barrier(MPI_COMM_WORLD)`如果我在 while 循环结束之前添加一个，这似乎可以解决，但为什么呢？即使进程不同步，最终，孩子们会向 root 发送他们已经完成的消息，并且 root 应该“倾听”并进行相应的处理？似乎正在发生的事情是 root 一直在运行，占用了所有资源供孩子们执行？或者这里发生了什么？

**更新 2：一些孩子没有收到来自 root 的通知**

好的，现在root没有收到@MichaelSh的回答完成的孩子的通知的问题，我专注于没有从父母那里收到的孩子。这是重现该问题的代码：

```
int numprocs, id, arr[10], winner = -1;
bool stop = false;
MPI_Request reqs[10], winnerNotification;

MPI_Init(NULL, NULL);
MPI_Comm_size(MPI_COMM_WORLD, &numprocs);
MPI_Comm_rank(MPI_COMM_WORLD, &id);

srand(time(NULL) + id);

if (id < 10) {
    MPI_Irecv(&winner, 1, MPI_INT, 10, 0, MPI_COMM_WORLD, &winnerNotification);
}
MPI_Barrier(MPI_COMM_WORLD);

while (winner == -1) {
    cout << id << " is in loop ..." << endl;
    if (id == 10) {
        if (((rand() % 10) + 1) < 2) {
            winner = 2;
            for (int i = 0; i < 10; i++) {
                MPI_Send(&winner, 1, MPI_INT, i, 0, MPI_COMM_WORLD);
            }
            cout << "winner notifications sent" << endl;
        }
    }
}

cout << id << " b4 MPI_Finalize. winner is " << winner << endl;

MPI_Finalize(); 
```

输出如下所示：

```
# 1 run
winner notifications sent
10 b4 MPI_Finalize. winner is 2
9 b4 MPI_Finalize. winner is 2
0 b4 MPI_Finalize. winner is 2

# another run
winner notifications sent
10 b4 MPI_Finalize. winner is 2
8 b4 MPI_Finalize. winner is 2 
```

注意到某些进程似乎没有收到来自父进程的通知？为什么会这样，`MPI_Wait`因为子进程只会挂起它们？那么我该如何解决呢？

还

> 在您的情况下，一切`MPI_Barrier`都会 - 它等待子响应完成。请检查我的答案以获得更好的解决方案

如果我不这样做，我想每个孩子的反应只需要几毫秒？所以即使我不等待/障碍，我希望接收仍然会在发送后不久发生？除非进程最终占用资源并且其他进程无法运行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T03:17:47.650

请尝试这段代码（为简单起见，省略了错误检查）：

```
...
// root checks number of children completed
int numDone = 0;
MPI_Status statuses[10];
MPI_Waitall(10, reqs, statuses);
for (int i = 0; i < 10; i++) {
... 
```

**编辑**一个更好的解决方案：
每个孩子发起根获胜者通知收据并将其通知发送给根。
Root 向数组发起获胜者通知接收并进入等待接收所有通知，然后将获胜者的 id 发送给孩子。在下面插入此代码`for (int round = 0; round < 1; round++)`

```
 if (id == 10) 
            { // root
                // keeps track of who has "completed"
                memset(arr, -1, sizeof(arr));
                for (int i = 0; i < 10; i++) 
                {
                    MPI_Irecv(&arr[i], 1, MPI_INT, i, 0, MPI_COMM_WORLD, &reqs[i]);
                }
            } 
            else if (id < 10) 
            { // children
                // listen to root of winner notification/indication to stop
                MPI_Irecv(&winner, 1, MPI_INT, 10, 1, MPI_COMM_WORLD, &winnerNotification);
            }

            if (id < 10)
            {
                while(((rand() % 10) + 1) < 3) ;

                // children has 20% chance to stop (finish work)
                MPI_Send(&id, 1, MPI_INT, 10, 0, MPI_COMM_WORLD);
                std::cout << id << " sending to root" << std::endl;
                // receive winner notification
                MPI_Status status;
                MPI_Wait(&winnerNotification, &status);
                // Process winner notification
            } 
            else if (id == 10) 
            {
                MPI_Status statuses[10];
                MPI_Waitall(10, reqs, statuses);                    

                // if all done, send notification to players to stop
                {
                    winner = 1;
                    for (int i = 0; i < 10; i++) 
                    {
                        MPI_Send(&winner, 1, MPI_INT, i, 1, MPI_COMM_WORLD);
                    }
                    std::cout << "root sent notification of winner" << std::endl;
                }
            } 
```

# php - 使用 MySQL 和 PHP 基于组合框中的值动态显示表格

> ID：13426772
> 
> 赞同：0
> 
> 时间：2012-11-17T01:33:03.773
> 
> 标签：php, javascript, mysql

我在 MySQL db 中有两个表，`vendor`即`menu`.

```
vendor table
vendor_id(Primary)   vendor_name

menu table
menu_id(Primary)     menu_details    cost     vendor_id(Foreign) 
```

我需要创建一个组合框，它`vendor_name`动态地从 MySQL 数据库中获取实例。从组合框中选择时，`vendor_name`应从 MySQL 数据库显示菜单表（HTML 和表应处于可编辑模式）。我是 MySQL 和 PHP 的新手。所以请帮我处理这个标准。

下面是我正在处理的代码：

```
<html><body>
<select name="vendor" id="vendor">
<option value="Choose">Choose</option>
<?php $conn = mysql_connect('localhost','root','');
if (!$con) { die('Could not connect: ' . Mysql_error()); }
mysql_select_db('project',$conn);
$query = "select vendor_id,vendor_name from vendor";
$result = mysql_query($query,$conn);
while($fetch= mysql_fetch_array($query)){
echo "<option>".$row[1]."</option>";
}?>
</select>
</body></html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T07:59:44.047

如果我对你的理解正确，那么这应该做你所追求的事情。它显示`vendor`表中的组合框，如果您更改选择，它会重新加载页面并显示与表中的 vendor_id 对应的菜单`menu`。

```
<html>
<body>
<?php 
// connecting to the server
$conn = mysql_connect('localhost','root','') or die('Could not connect: ' . Mysql_error());
// selecting the database
mysql_select_db('project',$conn) or die("db error: ".mysql_error());
// is menu_id set?
if (isset($_GET['menu']) && intval($_GET['menu'])>0) {
    // if yes, then query the menu items
    $query = "select menu_id, menu_details, cost, vendor_id from menu where vendor_id=".intval($_GET['menu']);
    $result = mysql_query($query, $conn) or die("SQL error: ".mysql_error());
    while ($row = mysql_fetch_assoc($result)) {
        // print the menu items
        print_r($row);
    }
}
// select the vendor combobox
$query = "select vendor_id,vendor_name from vendor";
$result = mysql_query($query,$conn);

// If the vendor selection has changed then reload the page
?>
<select name="vendor" id="vendor" onchange="document.location='index.php?menu='+this.options[this.selectedIndex].value;">
<option value="Choose">Choose</option>
<?php
// loop through the results
while($fetch= mysql_fetch_assoc($query)){
    echo "<option value=\"".$row['vendor_id']."\">".$row['vendor_name']."</option>";
}
?>
</select>
</body>
</html> 
```

假设文件名为`index.php`. （查看选择`onchange=""`文件名。如果您有不同的文件名，则需要更改它。

# android - 发布/订阅 Android 应用程序

> ID：13426775
> 
> 赞同：0
> 
> 时间：2012-11-17T01:33:44.683
> 
> 标签：android, publish-subscribe

我想创建一个 Android 应用程序，向用户显示正在进行的事件（根据用户的位置在不同地区发射导弹。这不是游戏，这是住在加沙附近的好处之一）。

我可以将 GCM 用于推送通知，但我必须逐个设备执行此操作。相反，我想根据客户端的位置提供一些订阅频道，并将数据从服务器发送到所有收听该频道的客户端。

是否有用于此的 Google API，或者我必须自己实现它（可能通过使用 XMPP），从而大大缩短电池寿命？

# objective-c - TabBarController 如何显示不同的项目？

> ID：13426777
> 
> 赞同：1
> 
> 时间：2012-11-17T01:34:20.890
> 
> 标签：objective-c, ios, uinavigationcontroller, uitabbarcontroller, tabitem

在我的`firstViewController`我有一个`tabbar`包含 my`firstViewController`和一个`helpViewController`.

当我从 中单击一个按钮时`FirstViewController`，我按下`NewViewController`。但是，当这个视图被推送时，我想将内容从 更改`TabBarController`为显示其他 ViewController，`infoViewController`如`optionViewController`和`NewViewController`。那可能吗？

第一个图像代表我的应用程序。有`FirstViewController`一个按钮可以推动`NewViewController`。当用户单击此按钮时，我希望我的应用程序显示第二张图片中的内容。有可能吗？![我的问题](../Images/c7c0e9d5a46f7231ac88788bde6e052a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T01:51:19.210

是的，这是可能的（我刚刚在 Xcode 中做了一个概念证明）。假设您正在使用情节提要，您需要将初始视图控制器设置为 a ，`UINavigationController`否则您将无法使用 push segues。然后，将第一个`UITabBarViewController`作为导航控制器的根视图控制器。将一个全新的`UITabBarController`内容放入情节提要中，然后将 a`UIButton`放入`firstViewController`并通过 push segue 将其链接到新的 (second) `UITabBarController`。

当您点击按钮时，旧标签栏将滑出，而新标签栏将滑上。

这是所有外观的示例： ![在此处输入图像描述](../Images/d086b4ca0057e628e55066209c44bef3.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T14:42:40.483

!!这个应用程序使用navigationController和TabBarController!! 使用故事板，我看到了应用程序的每一个部分，然后我就有了一个想法：Insted 推送`NewViewController`，那么推送 a怎么样`tabBarController`？当用户单击按钮时，应用程序将`tabBarController`使用 2 个 TabController 推送。

只需将新文件添加到您的项目中，子类为 UITabBarController。然后将此代码添加到您的 init 方法中`tabBarController`：`self.hidesBottonBarWhenPushed = YES;`

仅在`ViewDidLoad`alloc 和 init 上，您要在 tabBar 上显示哪些视图和

`self setViewControllers:[NSArray arrayWithObjects: vc1, vc2, vc3, nil]];`

在这里工作正常：D

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-17T01:48:59.087

您可以嵌套 TabBarControllers。但这看起来很奇怪。并且第一个 TabBar 不会改变。无法将 TabBarController 推入 TabBarController，因为 TabBarController 不支持 pushViewController。这只能通过 NavigationController 实现。

无论如何，您可以完全以编程方式更改 TabBar 的内容。

![在此处输入图像描述](../Images/5d2b0e55db8859d887f358e89021eedb.png)

![在此处输入图像描述](../Images/62c0aa9c7e17bdc56e70c9f31319a60e.png)

# java - 将 JSON 映射到 java 类

> ID：13426778
> 
> 赞同：1
> 
> 时间：2012-11-17T01:34:39.457
> 
> 标签：java, json, jackson

我正在尝试使用 jackson 解析 JSON 字符串，如下所示：

```
{
  "name":"John",
  "Wrapper":{
    "id":0
   }
} 
```

我试图避免必须为另一个 Java 类创建`Wrapper`并简单地将其映射到一个整数。[`@XmlElementWrapper`](http://docs.oracle.com/javaee/5/api/javax/xml/bind/annotation/XmlElementWrapper.html)即使文档指出，我也尝试使用：

> 这主要用于生成围绕集合的包装 XML 元素。

但这不起作用。我得到以下异常：

```
Exception in thread "main" org.codehaus.jackson.map.JsonMappingException: Can not deserialize instance of java.lang.Integer out of START_OBJECT token
 at [Source: java.io.StringReader@44eefb4; line: 1, column: 15] (through reference chain: Test["Wrapper"])
    at org.codehaus.jackson.map.JsonMappingException.from(JsonMappingException.java:163)
    at org.codehaus.jackson.map.deser.StdDeserializationContext.mappingException(StdDeserializationContext.java:219)
    at org.codehaus.jackson.map.deser.std.StdDeserializer._parseInteger(StdDeserializer.java:305)
    at org.codehaus.jackson.map.deser.std.StdDeserializer$IntegerDeserializer.deserialize(StdDeserializer.java:795)
    at org.codehaus.jackson.map.deser.std.StdDeserializer$IntegerDeserializer.deserialize(StdDeserializer.java:782)
    at org.codehaus.jackson.map.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:299)
    at org.codehaus.jackson.map.deser.SettableBeanProperty$FieldProperty.deserializeAndSet(SettableBeanProperty.java:579)
    at org.codehaus.jackson.map.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:697)
    at org.codehaus.jackson.map.deser.BeanDeserializer.deserialize(BeanDeserializer.java:580)
    at org.codehaus.jackson.map.ObjectMapper._readMapAndClose(ObjectMapper.java:2723)
    at org.codehaus.jackson.map.ObjectMapper.readValue(ObjectMapper.java:1854)
    at Test.main(Test.java:37) 
```

这是一个可运行的示例：

```
@XmlAccessorType(XmlAccessType.FIELD)
public class Test {

    public static void main(String[] args) throws JsonParseException, JsonMappingException, IOException {
        String json = 
                "{" +
                "\"name\":\"John\","+
                "\"Wrapper\":{"+
                "   \"id\":0}"+
                "}";
        ObjectMapper mapper = new ObjectMapper();
        mapper.setAnnotationIntrospector(new JaxbAnnotationIntrospector());
        mapper.setSerializationInclusion(Inclusion.NON_NULL);
        Test test = mapper.readValue(json, Test.class);
        System.out.println(test.toString());
    }

    @XmlElement(name="name")
    private String name;

    @XmlElementWrapper(name="Wrapper")
    @XmlElement(name="id")
    private Integer wrapperId;

    @Override
    public String toString() {
        return "Test [name=" + name + ", wrapperId=" + wrapperId + "]";
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T04:16:58.487

Jackson 提供了有限数量的结构转换注释（`@JsonUnwrapped`根值包装），但不适用于此用例。我认为这个特定用例实际上有一个功能请求（[`@JsonWrapped`](http://jira.codehaus.org/browse/JACKSON-781)我认为是这样）。

对于它的价值，Jackson JAXB 注释模块确实识别注释，但它不用于 JSON（它用于 XML 后端，但仅用于`Collection`数组值属性）。

我只想添加一个简单的静态类`Wrapper`；或者，如果它是一个常见的习惯用法，shared generic class`Wrapper<T>`用于各种包装值。代码量会很简单，然后对象结构将与 JSON 数据结构一对一匹配。

# php - 无法将查询响应转换为字符串数组并返回到我的 javascript

> ID：13426780
> 
> 赞同：0
> 
> 时间：2012-11-17T01:34:50.530
> 
> 标签：php, ajax, arrays

这看起来很简单，但我对此很陌生，以至于我无法让它运行——即使在阅读了数小时的教程和示例之后。我希望我的 PHP 运行一个查询，创建一个字符串数组，并将该数组返回给调用数据的 jQuery ajax()。返回数组应该是存储在数据库中的字符串，看起来像

```
citiesWithBoroughs = [
    "Dallas, Dallas County, Texas, United States",
    "Fort Worth, Tarrant County, Texas, United States",
    "El Paso, El Paso County, Texas, United States"
]; 
```

查询和数组创建代码如下。该查询在 MySQL Workbench 中运行并返回我想要的数据。我在下面对国家和州进行了硬编码，以减少测试时的错误来源。当我进行受控测试时，我将用“mysql_real_escape_string($countryAbbreviation)”等替换它们。

```
$return_arr=array();

$fetch = mysql_query("SELECT DISTINCT cityWithBoroughsGeonamed FROM places.boroughs
    WHERE countryAbbreviation='US'
    AND stateProvinceAbbreviation='NY'
    ") or die(mysql_error());
while ($row = mysql_fetch_array($fetch)){
    $return_arr[]=$row['cityWithBoroughsGeonamed'];
}
echo $return_arr; 
```

目前，Firebug 告诉我键/值数据进入 PHP 服务器，但我得到一个空数组返回。我已经尝试了几件事，但没有得到任何东西或一个空数组 - 经过大量试验。

在 JavaScript 方面，这里是请求数据并获取返回数组的 ajax 函数。

```
citiesWithBoroughs = function (request, response){
$.ajax({
    url: "getCitiesWithBoroughs.php",
    data: {stateProvinceAbbreviation: $("#hiddenState").val(),
        countryAbbreviation: $('input[name=country]:checked').val()},
    type: "POST",
    dataType: "text",
    success: function (data){
        response;
    }
}); 
```

必须改变什么才能做到这一点？请具体说明代码。我对此很陌生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:59:41.400

echo 将输出一个字符串。$return_arr 是一个字符串数组，`echo $return_arr;`只会输出`Array()`. 我建议`echo json_encode($return_arr);`在客户端脚本的成功回调中使用和处理 json 编码字符串。

# javascript - Javascript对每个单词的替换

> ID：13426781
> 
> 赞同：0
> 
> 时间：2012-11-17T01:34:54.047
> 
> 标签：javascript

我有一个文本框，当用户点击空格时，我希望每个单词都有一个 # 前缀。

到目前为止，我拥有的代码是：

```
 tagsNow = document.getElementById("tags").value;
  tagsChanged = tagsNow.replace(/(w+)/, "#$1");
  document.getElementById("tags").value = tagsChanged; 
```

它部分有效，因为 # 是第一次添加的（`word`变为`#word`）。

但是，如果键入了另一个单词，则 # 将添加到文本框的开头，如果用户键入自己的 #，它还会添加另一个 #。

我该如何解决这两个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T07:23:26.427

```
function tagify(str){
  return str.replace(/([^#]+?)(\s+|\b)/g, function(mat, grp1, grp2, at, src){
    return src[at-1] == "#" ? mat : "#" + mat;
  });
}

tagify("japan travel"); // "#japan #travel"
tagify("#torii bird");  // "#torii #bird"
tagify("C C#");         // "#C #C#" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:40:16.303

我会想象这样的事情会起作用：

```
tagsChanged = tagsNow.replace(/(^| )(?=!#)/g,"$1#"); 
```

`#`这基本上搜索后面没有的空格（和字符串的开头） ，然后插入`#`.

# c# - 如何在 CAML 查询中进行双重排序？

> ID：13426786
> 
> 赞同：8
> 
> 时间：2012-11-17T01:35:40.403
> 
> 标签：c#, sharepoint-2010, caml

我在 Visual Studio C# 中使用骆驼查询从 sharepoint 2010 的列表中获取项目。列表项有两个我想在 caml 查询中使用的字段。一个是“Section”，另一个是“Order By”。查询需要以某种方式对项目进行排序。首先它需要按 Section (ascending=true) 对其进行排序，然后对每个按 Order By (ascending=true) 进行二次排序。

例如，结果将是这样的：

```
<item> <Section> <Order By>
item1  A 1
item2  A 3
item3  B 1
item4  B 2
item5  C 5
item6  C 6 
```

到目前为止，我有这个：

```
 SPQuery query = new SPQuery();
        query.Query = "<Query><OrderBy><FieldRef Name='" + Root_List.Fields.GetField(SECTION_COLUMN).InternalName + "' Ascending='True'/></OrderBy></Query>";
        item_collection = Root_List.GetItems(query); 
```

但是我如何应用二级排序？

注意：Section 是一个字符串字段，order by 是一个数字字段。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-18T03:55:51.403

根据 MSDN 上的此页面，您可以在 OrderBy 元素中包含多个 FieldRef：

[http://msdn.microsoft.com/en-us/library/ms467378.aspx](http://msdn.microsoft.com/en-us/library/ms467378.aspx)

给出的例子是：

```
<OrderBy>
  <FieldRef Name="Newcomers"/>
  <FieldRef Name="Years" Ascending="FALSE"/>
  <FieldRef Name="Location"/>
</OrderBy> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T10:38:23.933

我使用 CAML Builder，它让生活变得更加轻松，尤其是当您有困难的查询时，您可以从这里获得它：

[http://www.u2u.be/res/tools/camlquerybuilder.aspx](http://www.u2u.be/res/tools/camlquerybuilder.aspx)

2007 版与 2010 版配合得很好，我每天都使用它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T07:59:27.847

尝试创建将要排序的列连接在一起的计算列。然后按新的计算列对您的列表进行排序。

[http://msdn.microsoft.com/en-us/library/bb862071(v=office.14).aspx](http://msdn.microsoft.com/en-us/library/bb862071(v=office.14).aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-30T08:23:51.337

就我而言，起初似乎上述答案不起作用。但真正的问题是因为我后来将它们转换为 DataTable 并使用以下脚本对它们进行排序，并且 CategoryPosition 的类型不是 int 并且默认使用字符串类型，它将在 1 之后放置 10。

```
 DataView dv = new DataView(maindt);
            dv.Sort = "Category,CategoryPosition";
            maindt = dv.ToTable(); 
```

所以注意这种事情，caml对多重排序的排序就像史蒂夫曼尼娜回答一样工作正常

# matlab - 关于优化在 Matlab 中加载多个文件的代码的提示？

> ID：13426787
> 
> 赞同：0
> 
> 时间：2012-11-17T01:35:47.637
> 
> 标签：matlab, matlab-load

```
fname = dir('*sir');  
dayH = zeros(length(fname),1360,3600);
for i=1:length(fname)   
    dayH(i,:,:) = loadsir(fname(i).name);
end  

fname = dir('*sir');  
dayH = cell(1,length(fname));  
for i=1:2  
   dayH{i} = loadsir(fname(i).name); 
end 
```

基本上它会加载我所有的文件。我有一个单独的 .m 文件，称为加载这些专用文件。.sir 文件的输出将是一个 1360x3600 的数组。

现在该代码正在崩溃，说“无法显示超过 524288 个元素的变量摘要。” 我猜是因为 1360X3600 = 5,000,000 左右？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T06:46:24.023

将 Serg 的评论作为答案：

您很可能`;`在`loadsir`. Matlab 然后认为您想要打印输出，由于元素数量众多，它不会这样做。

此外，为防止将来发生此类事情：

Matlab 是一种解释型语言，也就是说，不需要编译。键入时可以解析任何和所有代码，这允许自动更正之类的事情。当然，这种东西已经包含在标准的 Matlab 中了。如果您还没有，请不时在 Matlab 自己的编辑器中编写代码。它会警告您此类愚蠢的错误/错误（以及更多），包括但不限于通过编辑器中的右侧垂直条。窗口右上角的小方块应该一直是*绿色*的。如果它是*橙色*或*红色*，则分别有需要改进或纠正的地方。

右侧的垂直条是文件中所有留有改进空间的行的概览。如果某处出现橙色/红色小条，鼠标悬停会告诉您哪条线出了什么问题。单击它会将编辑器导航到该行，该行可能带有橙色或红色的波浪下划线。将鼠标悬停在线上通常会提供有用的建议，并且`<alt>+<enter>`通常足以修复简单的错误。在 Matlab 中开发大型应用程序时，我发现它是不可或缺的工具。

您当然可以配置此工具（“代码分析器”，以前的“mlint”）显示哪些错误/警告。有时，会出现关于您根本无法解决的低效率的警告。在行后面添加一个 OK 指令来抑制它（`%#ok`），但**不要**养成抑制任何“烦人”的习惯，因为这当然会完全超出代码分析器的目的：）

# iphone - 如何从一个视图控制器中获取 nsindex 并在另一个视图控制器中实现它

> ID：13426790
> 
> 赞同：-1
> 
> 时间：2012-11-17T01:36:23.080
> 
> 标签：iphone, objective-c, ios, xcode, ipad

```
 UIButton *btnUserImage = [UIButton buttonWithType:UIButtonTypeCustom];
        [btnUserImage setFrame:CGRectMake(5, 5, 80, 60)];
        [btnUserImage setBackgroundColor:[UIColor clearColor]];
        [btnUserImage setTag:indexPath.row];
        [btnUserImage addTarget:self action:@selector(btnUser_clicked:) forControlEvents:UIControlEventTouchUpInside];
        [cell.contentView addSubview:btnUserImage]; 
```

你好，我有这个我正在尝试实现的方法，但问题是 btnuserimage 标记不起作用，因为索引 path.row 在另一个 .m 文件中。底部代码是我试图对上面的代码实现的代码。我必须在另一个控制器中使用上面的方法才能使其工作。关于做什么的任何建议或提示。基本上我要问的是底部代码需要实现到另一个视图控制器，这样上面的代码才能工作。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:   (NSIndexPath     *)indexPath { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T03:36:01.060

您可以创建一个 SharedClass 并将所有必需的值传入和传出。或者，您可以创建一个全局变量并在两个类中使用它。

但我建议使用 sharedClass。

并且为了将来参考，如果某些事情发生动态变化，那么您可以使用通知。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T03:42:31.867

您可以在“一个”视图控制器中添加一个公共方法，如下所示。并称它为“另一个”视图控制器。

```
// in OneViewController a public method
- (void)addButtonWithTag:(NSInteger)tag
{
    [btnUserImage setTag:tag];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:   (NSIndexPath     *)indexPath {
    ...
    [oneViewController addButtonWithTag:indexPath.row];
    ...
} 
```

# python - 具有多个参数的python装饰函数（龙卷风）

> ID：13426793
> 
> 赞同：1
> 
> 时间：2012-11-17T01:36:48.933
> 
> 标签：python, arguments, decorator, tornado

我写了一个装饰器来验证调用。它只适用于一个参数，但如果有更多参数则不能，触发`inner() takes exactly 1 argument (2 given)`. 自从我使用 Tornado 以来，我有一些回调意大利面，但我不确定最好的方法是什么。

```
#this works
class FirstHandler(BaseHandler):

    @asynchronous
    @oauth_machine.auth
    def post(self):
        print self.user
        self.finish()

#this now also does
class SecondHandler(BaseHandler):

    @asynchronous
    @oauth_machine.auth
    def get(self, args):
        self.write("ok")
        self.finish() 
```

装饰器功能

```
def auth(fn):
    def inner(self, *args):
        res = get_user_by_credentials(self, fn, args, callback=done_auth)
    return inner

def get_user_by_credentials(self, fn, callback):

    def onFetchUserCredentials(result, error):
        self.user = result
        callback(self, fn, args)

    email = self.get_argument("email")
    password = self.get_argument("password")
    settings.DB.users.find_one({'email': email, 'password': password }, callback=onFetchUserCredentials)

def done_auth(result, fn, args):
    return fn(result, args) 
```

编辑 ：

将代码更新为工作版本。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T02:18:06.017

起初我以为问题很简单，但后来您发布了与原始错误消息相矛盾的回溯。但是，我认为问题仍然很简单，假设*回溯*错误是正确的。回想一下：

```
@decorator
def foo(x):
    return x + 1 
```

只是语法糖：

```
def foo(x):
    return x + 1
foo = oauth_machine.auth(foo) 
```

因此，当您使用`@oauth_machine.auth`on时`get`，它会通过闭包传递给`inner`as `fn`。

```
def auth(fn):
    def inner(self):
        res = get_user_by_credentials(self, fn, callback=done_auth)
    return inner 
```

然后它被传递到`get_user_by_credentials`，再次作为`fn`，这反过来又产生另一个闭包，它传递`fn`到`callback`。

```
def get_user_by_credentials(self, fn, callback):

    def onFetchUserCredentials(result, error):
        self.user = result
        callback(self, fn) 
```

`callback`被定义为`done_auth`back in `inner`，因此`fn`（即原始`get`）的menas 被传递到那里，然后被调用`result`：

```
def done_auth(result, fn):
    return fn(result) 
```

但是`fn`(ie `get`) 需要两个参数。你只传递一个，导致错误。

# android - 淡出系统栏

> ID：13426796
> 
> 赞同：0
> 
> 时间：2012-11-17T01:37:01.587
> 
> 标签：android, user-interface

我知道这个问题在这里被问了大约 10 次，但没有一个找到解决方案。我不想使用低光 SystemBar 模式，我希望它完全淡出。这是可能的！中国瑞芯微设备自带的默认启动器就是这样做的。（看起来系统栏刚刚飞到屏幕中间）。有什么（新的）想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:09:00.963

由于 API 17 这可以直接实现，因此在使用 Eclipse 开发应用程序时只需选择 FullScreen Activity。

# javascript - 快速会话不持久

> ID：13426800
> 
> 赞同：6
> 
> 时间：2012-11-17T01:38:22.213
> 
> 标签：javascript, node.js, express

我正在尝试在 node.js 中建立一个基本的会话系统。这是我到目前为止所得到的：

应用程序.js：

```
app.use(express.cookieParser('stackoverflow'));
app.use(express.session()); 
```

我在 ajax.js 中设置会话数据：

```
addClassToCart: function(req, res) {
  req.session.cart = req.body.classId;
  console.log(req.session.cart);
} 
```

这会记录正确的信息。但是，当我尝试在其他地方检索该信息时（相同的文件，不同的功能）：

```
console.log(req.session.cart); 
```

我明白了`undefined`。我觉得我错过了一些非常基本的东西。这方面的各种教程要么很糟糕，要么需要我添加更多的包（我试图避免）。

我调试的更多数据：

*   这适用于非 AJAX 请求
*   会话是在记录之前设置的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T19:27:13.130

事实证明，问题不在于 Express 的会话（正如其他答案似乎认为的那样）。相反，这是我的一个误解。我更改`addClassToCart`为以下内容：

```
addClassToCart: function(req, res) {
    req.session.cart = req.body.classId;
    console.log(req.session.cart);
    res.send('class added');
  } 
```

添加`res.send()`解决了问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-24T16:59:46.497

如[相关 SO question 的回答中所述](https://stackoverflow.com/a/34753703/1318265)，如果您使用[fetch](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch)从服务器获取数据但未传入`credentials`选项，也会发生这种情况：

```
fetch('/addclasstocart', {
    method: 'POST',
    credentials: 'same-origin' // <- this is mandatory to deal with cookies
}) 
```

除非您包含此选项，否则 Cookie 不会传递到服务器，这意味着请求的会话对象将在每次新调用时重置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-17T02:03:57.327

我不了解基本会话存储，但 redis 只花了我几分钟的时间来设置：

```
 app.use(express.session({
    store: new RedisStore({
      host: cfg.redis.host,
      db: cfg.redis.db
    }),
    secret: 'poopy pants'
  })); 
```

在 Mac 上：

```
brew install redis 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-17T19:23:59.137

```
app.use(express.session({
  secret: "my secret",
  store: new RedisStore,
    cookie: { secure: false, maxAge:86400000 }
})); 
```

不确定问题出在会话年龄中，但为了安全起见，我建议您指定 maxAge。

# visual-studio - 建立连接后将对象发送到客户端计算机

> ID：13426801
> 
> 赞同：0
> 
> 时间：2012-11-17T01:38:31.513
> 
> 标签：visual-studio, object, serialization, client

我有一个当前用作聊天服务器的程序。这是一款带有聊天框的回合制纸牌游戏，可以与对手交流。聊天内容都在连接上运行，但我已经到了需要开始向对手发送某些牌的地步，这样当我打牌时，我的对手会在他的屏幕上看到它。我希望客户端计算机接收对象或对象集合，根据其属性确定卡类型是什么，然后将卡放在正确的位置。发送和接收部分是我不明白如何完成的。根据我的阅读，这需要序列化，我只是不知道从哪里开始。请协助！我正在使用视觉工作室。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T19:18:34.830

再次回答我自己的问题...我最终创建了一个名为 card container 的新类，其中包含作为字符串的 cardType 和作为 int 的卡 ID。卡片容器还有其他属性，所以我知道卡片的去向。然后我序列化了卡片容器（在下面的代码中是'cc'）并发送如下：

```
Dim cc as new CardContainer
cc.id = card.id
cc.cardType = card.GetType.ToString
cc.discard = true

Dim bf As New BinaryFormatter
Dim ms As New MemoryStream
Dim b() As Byte

'serializes to the created memory stream
bf.Serialize(ms, cc)
'converts the memory stream to the byte array
b = ms.ToArray()
ms.Close()

'sends the byte array to client or host
SyncLock mobjClient.GetStream
    mobjClient.GetStream.Write(b, 0, b.Length)
End SyncLock 
```

客户端在其 TCPClient 上监听任何内容，并使用以下代码拿起卡片：

```
 Dim intCount As Integer

    Try
        SyncLock mobjClient.GetStream
            'returns the number of bytes to know how many to read
            intCount = mobjClient.GetStream.EndRead(ar)
        End SyncLock
        'if no bytes then we are disconnected
        If intCount < 1 Then
            MarkAsDisconnected()
            Exit Sub
        End If

        Dim bf As New BinaryFormatter
        Dim cc As New CardContainer
        'moves the byte array found in arData to the memory stream
        Dim ms As New MemoryStream(arData)

        'cuts off the byte array in the memory stream after all the received data
        ms.SetLength(intCount)
        'the new cardContainer will now be just like the sent one
        cc = bf.Deserialize(ms)
        ms.Close()

        'starts the listener again
        mobjClient.GetStream.BeginRead(arData, 0, 3145728, AddressOf DoRead, Nothing) 
```

根据 cardcontainer 拥有的数据确定客户端现在调用的方法。例如，当接收到这个时，创建的 cc 被传递给我的 CardReceived 方法，然后该方法有一堆 if、elseif 语句。其中之一是

```
ElseIf cc.discard = true then
'makes a new card from the id and cardType properties
dim temp as new object = MakeCard
'discard method will find the correct card in the Host's known hand and discard it to the correct pile
Discard(temp) 
```

# java - 为什么我的 break 语句会跳出整个程序？

> ID：13426803
> 
> 赞同：-1
> 
> 时间：2012-11-17T01:39:33.257
> 
> 标签：java, loops, try-catch, break

如果我对 JOptionPane 的输入不正确，我的 Exception 子句中的`break;`语句会停止整个程序，它不会执行我在 catch 块之后所拥有的，这是为什么呢？

```
public static void main(String[] args) {
        // TODO Auto-generated method stub
        Customer forrest = new Customer("Forrest Grump", 1,
                "42 New Street, New York, New York");
        Customer random = new Customer("Random Name", 2,
                "44 New Street, New York, New York");
        Customer customer[] = { null, forrest, random };
        int whichOption = 1;
        int id = 0;
        char action = ' ';
        char accSrc = ' ';
        char accDest = ' ';
        double amount = 0;
        BankAccount src = null;
        do {

            try{
            // process JOptionPane input information
            String input = JOptionPane
                    .showInputDialog("Please enter your transaction information: ");
            Scanner s = new Scanner(input);
            id = Integer.parseInt(s.next());
            action = Character.toUpperCase((s.next().charAt(0)));

            if (action == 'T') {
                amount = s.nextDouble();
                accSrc = s.next().charAt(0);
                accDest = s.next().charAt(0);
            } else if (action == 'G' || action == 'I') {
                accSrc = s.next().charAt(0);
            } else {
                // if D,W
                amount = s.nextDouble();
                accSrc = s.next().charAt(0);
            }

            } catch (Exception e){
                System.out.println("Invalid input!");
                break;
            }
            // taking action accordingly (T)ransfer, (D)eposit, (W)ithdraw, (I)nterest
            if (action == 'T') {

                (customer[id].getAccount(accSrc)).transfer(amount,
                        customer[id].getAccount(accDest));
            } else if (action == 'G') {
                System.out.println("The current balance on your " + accSrc
                        + " account is "
                        + customer[id].getAccount(accSrc).getBalance() + "\n");
            } else if (action == 'D') {
                (customer[id].getAccount(accSrc)).deposit(amount);
                //You have successfully depositted $xx.xx
            } else if (action == 'W') {
                (customer[id].getAccount(accSrc)).withdraw(amount);
            } else if (action == 'I') {
                (customer[id].getAccount(accSrc)).computeInterest();
            }
            whichOption = JOptionPane
                    .showConfirmDialog(null , "Do you want to continue?");

            System.out.println("The balance on " + customer[id].getName()
                    + " auto account is " + customer[id].A.balance);
            System.out.println("The balance on " + customer[id].getName()
                    + " savings account is " + customer[id].S.balance);
            System.out.println("The balance on " + customer[id].getName()
                    + " checkings account is " + customer[id].C.balance);
            System.out.println("The balance on " + customer[id].getName()
                    + " loan account is " + customer[id].L.balance + "\n");

        } while (whichOption == 0);

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:41:13.463

因为使用`break`你正在跳出循环（那是你的程序的结尾），如果你想在 catch 块部分之后执行，只需删除`break;`

* * *

**看**

*   [文档](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T01:45:22.660

我怀疑你愿意`continue`，不是`break`。看看这里的区别：

[http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/branch.html)

`continue`告诉循环跳过循环体中的所有以下语句并返回到循环体的顶部，重新检查条件，然后从那里继续正常循环。

`break`告诉循环立即结束，忽略循环体中的任何进一步指令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T01:41:43.963

`break`从封闭循环中逃脱，在您的情况下，这意味着 main ...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T01:42:31.067

您正在退出循环，并且在您的方法`break`中的循环之后没有任何内容。`main`如果要继续循环，请将 替换`break;`为`continue;`。

# c++ - 使用指针传递引用

> ID：13426808
> 
> 赞同：1
> 
> 时间：2012-11-17T01:40:27.247
> 
> 标签：c++, pointers, reference

为什么这个程序只在我初始化 a 和 b 时才有效。我想在不初始化 a 和 b 的情况下传递它，例如：

numChange(10,15);

这可能吗 ？

```
#include <iostream>
using namespace std;
void numChange(int *x,int *y)
{
     *x = 99;
     *y = 77;
}

int main()
{
    numChange(10,15);
    //int a=10;
    //int b=15;
    //numChange(&a,&b);
    cout<<a<<" , "<<b<<endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:46:40.650

因为您已经定义了函数来接收指针，但是当您调用该函数时，您正在尝试传递一个 int。

编译器需要内存地址，而您正在尝试传递常量。

这是没有意义的，你正在尝试做类似 10 = 99; 的事情。15 = 77;?

```
numChange(10,15);
    //int a=10;
    //int b=15; 
```

看来您正在跳跃 a = 10 = 99 和 b = 15 = 77；

如果这是可能的，这意味着我永远不能（在调用 numChange(10,15); 之后）使变量实际具有值 10，因为 10 “指向” 99（不是）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T05:27:41.697

回想一下：指针是一个包含内存位置的整数。

这：

```
int a, b;
...
a = b; 
```

将存储在为“b”保留的内存位置的整数复制到为“a”保留的内存位置。

这：

```
int *a, b;
...
a = &b; 
```

将“b”的**位置**存储在“a”中。跟随它：

```
*a = 42; 
```

将42存储在存储在'a'中的内存位置，即变量'b'。

现在，让我们看看你的代码。这：

```
void numChange(int *x,int *y) 
```

告诉编译器将使用两个指针调用“numChange”——即内存地址。这部分：

```
 *x = 99;
 *y = 77; 
```

然后将两个整数存储在“x”和“y”中给定的**位置。**

你打电话时：

```
numChange(10,15); 
```

参数是整数而不是内存位置。然而，在底层，内存位置也是整数，因此编译器将参数转换为指针。实际上，它正在这样做：

```
numChange((int *)10, (int*)15); 
```

（发生这种情况时它应该发出警告，因为它几乎从来都不是一个好主意，但它**会**做到的。）

基本上，您对“numChange”的调用告诉它在内存地址 10 和 15 处有整数变量，而“numChange”继续并在这些内存位置存储整数。由于在这些位置**没有** 变量（我们知道），因此此代码实际上会覆盖某处的其他一些数据。

同时，这段代码：

```
int a=10;
int b=15;
numChange(&a,&b); 
```

创建两个整数变量，然后将**它们在内存中的地址**传递给“numChange”。顺便说一句，您实际上不需要初始化它们。这也有效：

```
int a, b;
numChange(&a,&b); 
```

重要的是创建变量（编译器为它们留出 RAM），然后将它们的位置传递给“numChange”。

（顺便说一句：我将变量视为始终存储在 RAM 中。以这种方式考虑它们是安全的，但现代编译器出于性能原因会尝试将它们尽可能多地存储在 CPU 寄存器中，并在需要时将它们复制回 RAM .)

# c++ - C ++经过时间为0

> ID：13426814
> 
> 赞同：0
> 
> 时间：2012-11-17T01:41:29.920
> 
> 标签：c++, performance, winapi, time, rendering

问题是我的程序太快了，以至于它没有及时检测到变化，或者 GetTickCount()，我怎样才能防止这种情况发生？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T01:43:39.633

您是否将运行时间打印为整数？如果您要进行除法以获得经过的时间，请将分子或分母转换为浮点数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:45:21.473

计算运行时间`x`并取平均值。

此外，您可以使用分析来获得准确的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T02:26:40.650

采用

```
void WINAPI GetSystemTimeAsFileTime(
  _Out_  LPFILETIME lpSystemTimeAsFileTime
); 
```

反而。它有更好的分辨率。在大多数情况下，这确实是需要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T07:36:03.273

CodeProject 上有一个非常方便的类`QueryPerformanceCounter`，我经常使用它：http: [//www.codeproject.com/Articles/475/The-CPerfTimer-timer-class](http://www.codeproject.com/Articles/475/The-CPerfTimer-timer-class)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-17T08:14:23.733

GetTickCount 的精度为 5..15 毫秒，因此“零时差”是一个常见问题。

如果您需要精度，请使用[QueryPerformanceCounter](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644904%28v=vs.85%29.aspx)。

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-11-17T02:11:13.400

或者您可以尝试使用 rtdsc。详情见这里：[http](http://www.mcs.anl.gov/~kazutomo/rdtsc.html) : //www.mcs.anl.gov/~kazutomo/rdtsc.html

```
#include <stdio.h>
#include "rdtsc.h"

int main(int argc, char* argv[])
{
  unsigned long long a,b;

  a = rdtsc();
  b = rdtsc();

  printf("%llu\n", b-a);
  return 0;
} 
```

甚至 chrono 也不错，但它需要符合 C++11（部分）。详细信息：[std::chrono 和 cout](https://stackoverflow.com/questions/7889136/stdchrono-and-cout)

# java - 决定使类静态

> ID：13426815
> 
> 赞同：1
> 
> 时间：2012-11-17T01:41:30.010
> 
> 标签：java, design-patterns, static

我的服务器项目分为 6 个不同的类：

*   ServerConnectionManager - 类是所有其他类的中心
*   Connection - 每当客户端连接并启动线程时都会创建此对象
*   ServerListner - 这是侦听用户输入的 Thread 类
*   ServerSender - 这是向一个或多个用户发送消息的类
*   ServerInformation - 这个类包含两个列表，一个是聊天人，一个是连接 这个类还允许您搜索列表以找到特定的人和/或连接
*   ChatPerson - 此对象包含连接到服务器的每个人的用户名

毫无疑问，您现在已经猜到这是一个聊天程序的服务器！

我对你的问题是：

我想在这个项目上使用设计模式（调解器），因此 ServerConnectionManager 包含每个类使用的所有关键方法。例如，将连接添加到 ServerInformation 类中的连接列表。

但是由于 ServerInformation 类不能被称为对象，因为它只有很多方法（函数）并且除了存储和搜索数据之外没有其他实际用途，将其设为静态是个好主意吗？还是我应该坚持计划，让一切都通过 ServerConnectionManager？

这是我的代码示例：

**服务器连接管理器**

```
public class ServerConnectionManager {

    private static ServerSocket server;
    private static Socket connection;
    private static ServerInformation ai = new ServerInformation();
    private static boolean connected = false;
    private static final int portNumber = 7070;
    private static int backLog = 100;

    /**
     * This method launches the server (and the application)!
     * @param args
     */
    public static void main(String[] args){
        startServer();
        waitForConnection();
    }

    /**
     *This method sets the serverSocket to portNumber and also adds the backLog.
     */
    private static void startServer() {
        try {
            server = new ServerSocket(portNumber, backLog);
            connected = true;
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    /**
     * This method waits for a connection aslong as the serverSocket is connected.
     * When a new client connects it creates an Object of the connection and starts the individual procedure.
     */
    private static void waitForConnection() {
        while (connected) {
            try {
                connection = server.accept();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            Connection c = new Connection(connection);
            addConnection(c);
            waitForConnection();
        }

    }

    public static void closeMe(Socket con) {
        for (Connection conn : ai.getConnectionList()) {
            if (conn.getConnection() == con) {
                ai.getList().remove(ai.getList().indexOf(ai.getChatPersonByConnection(con)));
                ai.getConnectionList().remove(conn);

                System.out.println(ai.getList());
                System.out.println(ai.getConnectionList());
                conn.close();
                break;

            }
        }

    }
    public static void addConnection(Connection con){
        ai.addToConnectionList(con);

    }
    public static void addChatPerson(ChatPerson p){
        ai.add(p);
        System.out.println(ai.getList());
    }

} 
```

**联系**

```
public class Connection{
    private Socket connection;
    public Connection(Socket connection){
        this.connection = connection;
        ServerListner cl = new ServerListner(Connection.this);
        cl.start();
    }
    public Socket getConnection(){
        return this.connection;
    }
    public void close() {
        try {
            connection.close();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

} 
```

**服务器监听器**

```
public class ServerListner extends Thread {

    private Socket connection;
    private BufferedReader br;
    private ChatPerson person;
    private Connection con;
    private ServerInformation ai = new ServerInformation();
    private ServerSender sender = new ServerSender();

    public ServerListner(Connection con){
        this.con = con;
        connection = con.getConnection();
        try {
            br = new BufferedReader(new InputStreamReader(connection.getInputStream()));
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    public Socket getConnection(){
        return this.connection;
    }
    public void run(){
        System.out.println(con.getConnection().isConnected());
            try {
                String inString;
                while ((inString = br.readLine()) != null) {
                    if (inString.equalsIgnoreCase("Disconnect")) {
                        System.out.println(inString);
                        break;
                    }else {
                        processInput(inString);
                    }
                }
                ServerConnectionManager.closeMe(connection);
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
    }
    public void processInput(String input){
        if (input.equalsIgnoreCase("Connect")) {
            sender.sendMessageToConnection(this.connection, "Accepted");
        }
        if (input.equalsIgnoreCase("UserInformation")) {
            try {
                String username = br.readLine();
                person = new ChatPerson(username, connection);
                ServerConnectionManager.addChatPerson(person);

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        if (input.equalsIgnoreCase("SearchByCon")) {
            String name = ai.searchByConnection(connection);
            System.out.println(name);
        }

    }
} 
```

**服务器发件人**

```
public class ServerSender {
    private PrintWriter pw;
    private ServerInformation ai = new ServerInformation();

    public void addToList(){

    }
    public void sendToAll(String message){
        for (Connection c : ai.getConnectionList()) {
            try {
                pw = new PrintWriter(c.getConnection().getOutputStream());
                pw.print(message);
                pw.flush();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }

        }
    }
    /** 
     *
     * @param con
     * @param message
     */

    /*
     * Note - Denne metode gør også at jeg kan hviske til folk!:)
     */
    public void sendMessageToConnection(Socket con, String message){
        try {
            PrintWriter print = new PrintWriter(con.getOutputStream());
            print.println(message);
            print.flush();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }
} 
```

**服务器信息**

```
public class ServerInformation{
    private ArrayList<Connection> connectedClients = new ArrayList<Connection>();
    private ArrayList<ChatPerson> list = new ArrayList<ChatPerson>();

    public ArrayList<Connection> getConnectionList(){
        return connectedClients;
    }
    public void addToConnectionList(Connection con){
        connectedClients.add(con);
    }
    public String searchByConnection(Socket myConnection){
        for (ChatPerson p : list) {
            if (p.getConnection() == myConnection) {
                return p.getName();
            }   
        }
        /*
         * If none found!
         */
        return null;
    }

    public ChatPerson getChatPersonByConnection(Socket myConnection){
        for (ChatPerson p : list) {
            if (p.getConnection() == myConnection) {
                return p;
            }
        }
        return null;
    }

    public void add(ChatPerson p){
        list.add(p);
    }

    public void removeByName(String name){
        for (ChatPerson p : list) {
            if (p.getName().equalsIgnoreCase(name)) {
                list.remove(p);     
            }
        }
    }
    public String searchList(String name){
        for (ChatPerson p : list) {
            if (p.getName().equalsIgnoreCase(name)) {
                return p.getName();
            }
        }
        return null;
    }   
    public ArrayList<ChatPerson>getList(){
        return list;
    }

} 
```

**聊天人**

```
public class ChatPerson {
    private String chatName;
    private Socket connection;

    /*
     * This is for furture development
     * private Integer adminLevel;
     */

    public ChatPerson(String name, Socket connection){
        this.chatName = name;
        this.connection = connection;
    }
    public void setName(String name){
        this.chatName = name;

    }
    public String getName(){
        return chatName;

    }
    public String toString(){
        return "Username: "+chatName;
    }
    public Socket getConnection(){
        return connection;
    }
} 
```

提前谢谢你，顺便说一句，因为我是一名学生，如果你有时间对我的代码进行评分并就我如何改进提出建议（如果有的话:)）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T01:54:40.520

您可能是指只有静态方法的类，而不是静态类。静态内部类是不同的（你可以谷歌它）。

在管理器中使用非静态方法的优点：

*   您可以在测试期间使用 Mockito 等框架轻松地模拟它们。
*   您可以在重构代码期间将它们拉到某个界面。
*   使用静态方法不是面向对象的编程，因为此类方法调用与您的类的任何实例（对象）无关。

# c# - 如何使用 DropDownList 限制数据库插入中的用户选择？

> ID：13426819
> 
> 赞同：0
> 
> 时间：2012-11-17T01:41:49.370
> 
> 标签：c#, asp.net, .net

我正在尝试使用 DropDownList 限制 INSERT 的选择，我的 TextBox 都可以正常工作，但我似乎无法弄清楚如何以类似的方式使用 DropDownList。

这是我当前的代码隐藏：

```
private void _subInsert(RepeaterCommandEventArgs e)
{
    TextBox txtPostTitle = (TextBox)e.Item.FindControl("txt_post_titleI"); // Find the control with the information you wish to store
    TextBox txtPostBody = (TextBox)e.Item.FindControl("txt_post_bodyI");
    TextBox txtPostAuthor = (TextBox)e.Item.FindControl("txt_post_authorI");
    DropDownList ddlPostType = (DropDownList)e.Item.FindControl("ddl_post_typeI");

    sds_main.InsertParameters["post_title"].DefaultValue = txtPostTitle.Text; // Insert information into this location in the DB
    sds_main.InsertParameters["post_body"].DefaultValue = txtPostBody.Text;
    sds_main.InsertParameters["post_author"].DefaultValue = txtPostAuthor.Text;
    sds_main.InsertParameters["post_type"].DefaultValue = ddlPostType.SelectedValue.ToString();

    sds_main.Insert(); // Perform Insert
} 
```

TextBoxes 都正确插入，但 DropDownList 不允许我在插入中使用 SelectedValue。我收到“对象引用未设置为对象的实例”。错误。

这是演示页面上我的 SQLDataSource 控件的代码：

```
 <asp:SqlDataSource
    id="sds_main"
    runat="server" 
        ConnectionString="<%$ ConnectionStrings:fntn0070DBConnectionString %>" 
        SelectCommand="SELECT * FROM [blogTest]" 
        DeleteCommand="DELETE FROM [blogTest] WHERE [id] = @id" 
        InsertCommand="INSERT INTO [blogTest] ([post_title], [post_body], [post_author], [post_type]) VALUES (@post_title, @post_body, @post_author, @post_type)" 

        UpdateCommand="UPDATE [blogTest] SET [post_title] = @post_title, [post_body] = @post_body, [post_author] = @post_author, [post_type] = @post_type WHERE [id] = @id" >
    <DeleteParameters>
        <asp:Parameter Name="id" Type="Int32" />
    </DeleteParameters>
    <InsertParameters>
        <asp:Parameter Name="post_title" Type="String" />
        <asp:Parameter Name="post_body" Type="String" />
        <asp:Parameter Name="post_date" Type="String" />
        <asp:Parameter Name="post_author" Type="String" />
        <asp:Parameter Name="post_type" Type="String" />
    </InsertParameters>
    <UpdateParameters>
        <asp:Parameter Name="post_title" Type="String" />
        <asp:Parameter Name="post_body" Type="String" />
        <asp:Parameter Name="post_author" Type="String" />
        <asp:Parameter Name="post_type" Type="String" />
        <asp:Parameter Name="id" Type="Int32" />
    </UpdateParameters>
    </asp:SqlDataSource> 
```

这是我在演示页面上的 DDL：

```
<asp:DropDownList ID="ddl_postTypeI" runat="server">
    <asp:ListItem>Web Development</asp:ListItem>
    <asp:ListItem>Photography</asp:ListItem>
    <asp:ListItem>Other</asp:ListItem>
</asp:DropDownList> 
```

我已尽力在 Google 和 StackOverflow 上搜索此问题，但只能找到有关如何将数据绑定到 DDL 的信息。

我对 ASP.NET 4 很陌生，刚开始在我的 Web 开发课程中学习它，所以如果你能回答，请 ELI5。提前感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T04:03:37.417

如果不给出下拉列表的值，则不能直接使用它。

尝试这个

```
 <asp:DropDownList ID="ddl_postTypeI" runat="server">
    <asp:ListItem Value="Web Development">Web Development</asp:ListItem>
    <asp:ListItem Value="Photography">Photography</asp:ListItem>
    <asp:ListItem Value="Other">Other</asp:ListItem>
</asp:DropDownList> 
```

然后尝试插入数据，如果您传递整数值，则使用 value="1" 否则会引发错误。

谢谢，

# android - Android ActionBarSherlock 选项卡，Android 2.3 或更低版本上的 NoClassDefFoundError

> ID：13426821
> 
> 赞同：2
> 
> 时间：2012-11-17T01:41:51.107
> 
> 标签：android, android-fragments, android-actionbar, actionbarsherlock

我正在尝试让我的 Android 应用在较低版本的 Android 上支持 ActionBar，所以我使用的是 ActionBarSherlock 4.2.0。我还使用同一个开发人员的“NotificationCompat2-1.1.2”来获得更好的通知支持。

所以该应用程序有 ActionBar 选项卡，我正在使用 ActionBar.TabListener。我的实现如下所示：

```
public static class TabListener<T extends SherlockFragment> implements ActionBar.TabListener {
    private final SherlockFragmentActivity mActivity;
    private final String mTag;
    private final Class<T> mClass;
    private final Bundle mArgs;
    private android.support.v4.app.Fragment mFragment;

    public TabListener(SherlockFragmentActivity activity, String tag, Class<T> clz) {
        this(activity, tag, clz, null);
    }

    public TabListener(SherlockFragmentActivity activity, String tag, Class<T> clz, Bundle args) {
        mActivity = activity;
        mTag = tag;
        mClass = clz;
        mArgs = args;

        // Check to see if we already have a fragment for this tab, probably
        // from a previously saved state.  If so, deactivate it, because our
        // initial state is that a tab isn't shown.
        mFragment = mActivity.getSupportFragmentManager().findFragmentByTag(mTag);
        if (mFragment != null && !mFragment.isDetached()) {
            FragmentTransaction ft = mActivity.getSupportFragmentManager().beginTransaction();
            ft.detach(mFragment);
            ft.commit();
        }
    }

    public void onTabSelected(ActionBar.Tab tab, FragmentTransaction ft) {
        if (mFragment == null) {
            mFragment = Fragment.instantiate(mActivity, mClass.getName(), mArgs);
            ft.add(android.R.id.content, mFragment, mTag);
        } else {
            ft.attach(mFragment);
        }
    }

    public void onTabUnselected(ActionBar.Tab tab, FragmentTransaction ft) {
        if (mFragment != null) {
            ft.detach(mFragment);
        }
    }

    public void onTabReselected(ActionBar.Tab tab, FragmentTransaction ft) {
        //Do nothing
    }
} 
```

我的片段扩展了 SherlockFragment 类。

所以这一切都很好，除非我尝试在不原生支持 ActionBar 的设备上运行它，即低于 3.0 的 Android 版本。因此，ActionBarSherlock 似乎无法正常工作，无法正常工作。

我得到的错误是：

> 错误/dalvikvm（330）：找不到类 'com.shockwave.clockproj.StopwatchFragment'，引用自方法 com.shockwave.clockproj.ClockMain.onCreate 11-16 16:23:50.165：错误/AndroidRuntime（330）：致命例外：主要
> 
> > ```
> >  java.lang.NoClassDefFoundError: com.shockwave.clockproj.StopwatchFragment
> >     at com.shockwave.clockproj.ClockMain.onCreate(ClockMain.java:20)
> >     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
> >     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
> >     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
> >     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
> >     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
> >     at android.os.Handler.dispatchMessage(Handler.java:99)
> >     at android.os.Looper.loop(Looper.java:123)
> >     at android.app.ActivityThread.main(ActivityThread.java:3683)
> >     at java.lang.reflect.Method.invokeNative(Native Method)
> >     at java.lang.reflect.Method.invoke(Method.java:507)
> >     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
> >     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
> >     at dalvik.system.NativeStart.main(Native Method) 
> > ```

出现错误的行是实例化选项卡的位置，如下所示：

```
 ActionBar.Tab stopwatchTab = actionBar.newTab().setText("Stopwatch").setTabListener(new TabListener<StopwatchFragment>(this, "Stopwatch", StopwatchFragment.class)); 
```

所以显然它找不到片段的类定义，但只能在 Android 2.3 或更低版本上找到。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T03:08:33.353

这可能正在发生，因为`ActionBar.TabListener`正在导入的是来自 Android 包而不是 ActionBarSherlock 包。

确保导入适用于`com.actionbarsherlock.app.ActionBar.TabListener`

*编辑：* Shockwave 自己解决了这个问题，但对于遇到此问题的其他人：如果您在较低的 API 级别上遇到 ClassNotFound 异常，但它适用于较高的 API 级别，您可以采取一些步骤来调试它。

*   确保您没有实现任何在您的最低 API 级别中不可用的接口（例如，在 API 级别 11 之前使用[View.OnSystemUiVisibilityChangeListener ）](http://developer.android.com/reference/android/view/View.OnSystemUiVisibilityChangeListener.html)

*   运行 Android Lint 以检查对仅在较新 API 级别中可用的方法的任何调用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T02:28:14.890

![在此处输入图像描述](../Images/76192a6b92c9631fb9b92ce4158da831.png) 尝试将库添加到导出，这是因为在编译时找到了类但在运行时没有，尝试添加要导出的库，如上图所示

你的情况下的lib是sherlock项目

# c# - SendInput ExtraInfo / 标志

> ID：13426822
> 
> 赞同：2
> 
> 时间：2012-11-17T01:42:23.347
> 
> 标签：c#, flags, sendinput

我正在尝试将 SendInput api 用于热键应用程序。所以我正在做的是拥有一个全局键钩，当一些键组合命中时，我想发送另一个键。

我的问题是，当我发送模拟密钥时，我的钩子会收到该消息，最终会出现递归循环。

因此，我尝试使用 ExtraInfo / Flags，但由于某种原因，我设置的值与我在挂钩中收到的值不同。

```
var down = new INPUT();
down.Type = (UInt32)InputType.Keyboard;
down.Data.Keyboard = new KEYBDINPUT();
down.Data.Keyboard.KeyCode = (UInt16)keyCode;
down.Data.Keyboard.Scan = 0;
down.Data.Keyboard.Flags = 0; //doesn't matter whatever I set here... never gets back to my hook
down.Data.Keyboard.Time = 0;
down.Data.Keyboard.ExtraInfo = IntPtr.Zero; //doesn't matter whatever I set here... never gets back to my hook 
```

无论我在 ExtraInfo / Flags 上设置什么......当我在我的钩子中收到消息时它都会重置：

```
 private IntPtr KeyStateChangeCallback(int nCode, IntPtr wParam, ref KEYBDINPUT lParam)
    {
       //lParam.ExtraInfo and lParam.Flags ... is always some mumbo jumbo value or zero...
    } 
```

我正在使用低级键盘挂钩，“WH_KEYBOARD_LL”，设置如下：

```
 proc = KeyStateChangeCallback;
        using (Process curProcess = Process.GetCurrentProcess())
        using (ProcessModule curModule = curProcess.MainModule)
        {
            hookID = NativeMethods.SetWindowsHookEx(WH_KEYBOARD_LL, proc, NativeMethods.GetModuleHandle(curModule.ModuleName), 0);
        } 
```

其他人有类似的问题，可以帮助我吗？任何工作代码示例都会很棒:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T03:21:17.367

根据[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646271%28v=vs.85%29.aspx)，您应该调用[GetMessageExtraInfo](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644937%28v=vs.85%29.aspx)来检索`ExtraInfo`字段中的数据。

# jquery - JQuery 问题，asp.net-MVC 控制器

> ID：13426825
> 
> 赞同：4
> 
> 时间：2012-11-17T01:43:12.867
> 
> 标签：jquery, asp.net-mvc

我有一个（我认为愚蠢的）问题。

我有一个控制器，Index 方法，它的视图有一些 JQuery 函数。

它运行良好，并且 JQuery 方法运行良好。

我使用的链接是

```
http://localhost:54209/TestInput/ 
```

但如果我把

```
http://localhost:54209/TestInput/Index 
```

JQuery 函数不起作用。据我所知，他们应该采取完全相同的行动。

这是我唯一改变的

我真的很感谢你的帮助。在过去的几个小时里，这让我发疯了！

例如，这是我的脚本

```
<script>
  $(document).ready(function() {
    $('select#testCategoriesUniqueId').change(function() {
        var testCategory = $(this).val();
        $.ajaxSetup({ cache: false });
         alert ("AAA");
        $.ajax({
            url: "TestInput/listTestCases/" + testCategory,
            dataType: "json",
            type: 'post',
            success: function(data) {
                $("#testCasesUniqueId").removeOption(/./);
                for (var i = 0; i < data.length; i++) {
                    var val = data[i].Value;
                    var text = data[i].Text;
                    $("#testCasesUniqueId").addOption(val, text, false);
                }
            }
        });
    });
}); 
```

在这两种情况下，我都会收到警报，但在第二个链接中，我无法调用控制器。

它不调用我的控制器的 listTestCases 方法。

更新：

所以我尝试使用参数而不是确切的链接，我仍然有问题，我得到了两个来源，并得到了一个差异，唯一的区别是

```
<form name="aspnetForm" method="post" action="Index" id="aspnetForm"> 
```

对比

```
<form name="aspnetForm" method="post" action="TestInput" id="aspnetForm"> 
```

和

```
<form action="/TestInput/Index" method="post"> 
```

对比

```
<form action="/TestInput" method="post"> 
```

我相信这与 jQuery 无关。

在这两种情况下，我仍然看到 laert。但是 JQuery 在 ~/TestInput 中工作，而不是在 ~/TestInput/Index 中工作。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T02:02:40.387

这就是为什么您不应该在 asp.net mvc 应用程序中对 url 进行硬编码。你的问题是你的 ajax url 是一个相对 url。当您使用 url [http://example.com/TestInput/](http://example.com/TestInput/)加载页面时，ajax url 最终会变成[http://example.com/TestInput/TestInput/listTestCases](http://example.com/TestInput/TestInput/listTestCases)或者[http://example.com/TestInput/列表测试用例](http://example.com/TestInput/listTestCases)

当您使用 url [http://example.com/TestInput/Index](http://example.com/TestInput/Index)您的 ajax url 最终成为[http://example.com/TestInput/Index/TestInput/listTestCases](http://example.com/TestInput/Index/TestInput/listTestCases)

Insetead，您应该使用其中一个 Html 助手来声明您的 ajax url，如下所示。（使用剃刀语法）

```
<script>
  $(document).ready(function() {
    $('select#testCategoriesUniqueId').change(function() {
        var testCategory = $(this).val();
        $.ajaxSetup({ cache: false });
         alert ("AAA");
        $.ajax({
            url: "@Url.Action("listTestCases")"+ "/" + testCategory,
            dataType: "json",
            type: 'post',
            success: function(data) {
                $("#testCasesUniqueId").removeOption(/./);
                for (var i = 0; i < data.length; i++) {
                    var val = data[i].Value;
                    var text = data[i].Text;
                    $("#testCasesUniqueId").addOption(val, text, false);
                }
            }
        });
    });
});
</script> 
```

**ASPX 视图引擎更新：**

如果您使用的是 Razor 的 ASPX 视图引擎，请使用此语法。

```
<script>
  $(document).ready(function() {
    $('select#testCategoriesUniqueId').change(function() {
        var testCategory = $(this).val();
        $.ajaxSetup({ cache: false });
         alert ("AAA");
        $.ajax({
            url: "<%=Url.Action("listTestCases")%>"+ "/" + testCategory,
            dataType: "json",
            type: 'post',
            success: function(data) {
                $("#testCasesUniqueId").removeOption(/./);
                for (var i = 0; i < data.length; i++) {
                    var val = data[i].Value;
                    var text = data[i].Text;
                    $("#testCasesUniqueId").addOption(val, text, false);
                }
            }
        });
    });
});
</script> 
```

请务必使用 Firebug 或 F12 开发工具仔细检查您需要的确切网址。

# c - 从 C 中的文件中检索数据

> ID：13426826
> 
> 赞同：1
> 
> 时间：2012-11-17T01:43:13.077
> 
> 标签：c, file-io

我的程序首先询问用户是否要导入文件，如果用户选择是，则要求他们提供他们要使用的文件的名称。我似乎无法从文件中获取输入以相应地工作和显示。基本上，我试图从文件中获取姓名和号码，并将它们输入到我的应用程序的显示电话簿部分。截至目前，它似乎只是接收文件，但什么也不存储。这是处理我的问题的 3 个主要功能。

```
#include <stdio.h> 
#include <string.h>
#include <stdlib.h>
#include <conio.h>
#define BUFFSIZE 500
//Structure for contacts. These are now pointers.
typedef struct friends_contact{

 char *First_Name;
 char *Last_Name;
 char *home;
 char *cell;
}fr;
//Function declarations 
void menu(fr*friends ,int* counter,int i,char buffer[]);
void setFirst(fr*,int *,int i,char buffer[]);
char getFirst(fr*,int i);
void setLast(fr*friends, int* counter, int i,char buffer[]);
char getLast(fr*friends , int i);
void setHome(fr*friends, int* counter, int i,char buffer[]);
char getHome(fr*friends, int i);
void setCell(fr*friends, int* counter, int i,char buffer[]);
char getCell(fr*friends, int i);
void add_contact(fr*friends,int* counter,int i,char buffer[]);
void print_contact(fr*friends ,int* counter, int i,char user_entry3[50]);
char delete_contact(fr*friends ,int* counter, int i);
int show_contact(fr*friends ,int* counter, int i);
void file(fr*friends ,int* counter, int i,char user_entry3[50]);
char file2 (fr*friends ,int* counter, int i,char user_entry3[50]);

int main() {

 fr friends[5];
 char buffer[BUFFSIZE];
 int counter=0;
 int i=0;

 menu(friends, &counter,i,buffer);

getch();
return 0;
}

 void menu(fr*friends,int* counter, int i,char buffer[]) {
   int user_entry=0;
   int user_entry2=0;
   char user_entry3[50]={'\0'};

   printf("Welcome! Would you like to import a file? (1)Yes or (2) No");
   scanf("%d",&user_entry);
      if(user_entry==1)
         {
         printf("please enter the name of the file");
         scanf("%s",user_entry3);  
         file2(friends ,counter, i,user_entry3);        
         }else;
   do{
    int result;

      printf("\nPhone Book Application\n");
      printf("1) Add friend\n2) Delete friend\n3) Show a friend\n4) Show  phonebook\n5)Exit\n");   
     scanf("%d", &user_entry);

       if(user_entry==1)
        {
         add_contact(friends,counter,i,buffer);
        }
       if(user_entry==2)
        {
        delete_contact(friends ,counter,i);
        } 
       if(user_entry==3)
        {
        result=show_contact(friends ,counter,i);
           if(result==0)
               {
                printf("\nName not Found\n");
                }else{
                     result;
                     }

        }                  
       if(user_entry==4)
        {
        print_contact(friends, counter,i,user_entry3);
        } 
 }while(user_entry!=5);
      if(user_entry==5)
       {
       printf("Would you like to save entries to a file? (1)yes or (2) no");
       scanf("%d",&user_entry2);
         if(user_entry2 == 1)
          {
           printf("Please name your file");
           scanf("%s",user_entry3); 
           file(friends, counter,i,user_entry3);
           printf("Goodbye!"); 

       }else if(user_entry2 == 2)
         {
        printf("Goodbye!"); 
    }
  } 
```

这是我试图打开文件并检索信息的函数。

```
void file2(fr*friends ,int* counter, int i, char user_entry3[50])
 {

  FILE *read;
  read=fopen(user_entry3,"r");
  for( i = 0; i < *counter; i++)
        {
        fscanf(read,"%s",friends[i].First_Name);
        fscanf(read,"%s ",friends[i].Last_Name);
        fscanf(read,"%s",friends[i].home);
        fscanf(read,"%s",friends[i].cell);
        }

  fclose(read);

} 
```

最后，这是我尝试将文件中的日期添加到电话簿的地方。

```
void print_contact(fr*friends ,int* counter, int i,char user_entry3[50]) 
 {

  for( i = 0; i < *counter; i++)
    if (strlen(friends[i].First_Name) && strlen(friends[i].Last_Name)&&strlen(friends[i].home)&& strlen(friends[i].cell ))
      {
        file2(friends,counter,i,user_entry3);
        getFirst(friends, i);
        getLast(friends, i);
        getHome(friends, i);
        getCell(friends, i);

       }
 } 
```

我的逻辑可能有问题，但我似乎无法弄清楚这一点。如果需要，我可以发布其余的代码，但我希望我犯了一个简单的错误，有人可以通过查看我提供的内容来发现它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T03:20:36.843

Andrew Cooke 是对的，你传递`counter`的是 0，所以 file2 按照指示什么也不读。请注意，当它更改为 时`counter=1`，您的程序将失败，因为结构`fr`中充满了未分配内存的指针。您在一两天前在一个问题中询问如何分配内存，所以也许您应该先看一下。

您的代码还有许多其他问题，但至少您可以修复结构并停止传递`counter`和`i`进入函数。但是你的朋友数组有一个固定大小的问题 - 你需要避免超出结尾......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:56:13.120

有什么值`counter`，为什么两者都`counter`作为`i`参数传递？如果`counter`为零，则不会从文件中读取任何内容。

读到文件末尾不是更好吗？也许你会设置`counter`（或为它返回一个值）。

绝对没有理由`i`成为参数；它应该是一个局部变量。

并且如果您包含`fr`和a 的定义，`main`以便可以编译和运行示例，您可能会获得更详细的帮助...

# php - 强制 php 脚本运行

> ID：13426828
> 
> 赞同：0
> 
> 时间：2012-11-17T01:43:15.703
> 
> 标签：php, apache, redirect

我有一个在大量数据目录上循环的 php 脚本。它所做的是遍历记录 id，如果它没有发现任何有用的东西，它会增加 id 并重定向到具有新 id 的同一页面。我想强制运行这个脚本来为我获取数据，但是在每 20 条记录之后，它就会停止并给出这个脚本没有正确重定向的错误。有什么方法可以更改 php.ini 文件，我可以使用它来强制执行此脚本。它按照应该运行的方式运行，并且应该像那样重定向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T01:49:21.713

您正在达到[HTTP 重定向限制](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.3)。Firefox的[默认](http://kb.mozillazine.org/Network.http.redirection-limit)值为 20。

您可以使用不受此限制的[元重定向](http://en.wikipedia.org/wiki/Meta_refresh)或[Javascript 重定向。](http://en.wikipedia.org/wiki/URL_redirection#JavaScript_redirects)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T01:46:17.740

听起来您的用例应该使用带有主 while/for 循环的[PHP CLI ，而不是重定向到自身。](http://php.net/manual/en/features.commandline.php)

当然，您也可以在浏览器中使用主要的 while/for 循环，只是`set_time_limit(0)`为了消除时间限制。

还值得注意的是，您看到的限制是由您的浏览器而不是由您的 Web 服务器强制执行的，因此修改 php.ini 不会影响这一点。

# node.js - 如何使用无头浏览器有效地加载测试 web 应用程序？

> ID：13426836
> 
> 赞同：6
> 
> 时间：2012-11-17T01:44:58.107
> 
> 标签：node.js, websocket, socket.io, load-testing, derbyjs

我有一些无头浏览器的经验，但仅用于测试而不是负载测试。启动 500-1000 个 websocket 客户端以对应用程序进行负载测试的最佳方法是什么？是否像循环一堆`setTimeout`逐渐变长的 a 一样简单？

我可以自己构建实际测试，我只是好奇哪个框架最适合这个。

我有使用 ZombieJS 和 PhantomJS（以及 Casper 和 Webspecter）的经验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T13:56:57.990

看起来您想在服务器上进行可扩展性/负载测试。您如何使用数十万个虚拟客户端测试客户端性能？无论如何，我假设您已经尝试过使用无头幻像客户端。我也尝试过同样的事情，它对我很有效，我使用一些实用插件监控了 CPU、网络吞吐量和内存使用情况。

有一个插件可以为 websocket 协议进行 JMeter 集成。这可能会有所帮助

[https://github.com/kawasima/jmeter-websocket/](https://github.com/kawasima/jmeter-websocket/)

# python - 使用 Timeit (python) 测量背景变化和声音播放的延迟

> ID：13426851
> 
> 赞同：0
> 
> 时间：2012-11-17T01:47:04.510
> 
> 标签：python, tkinter, timeit

我需要弄清楚发送命令以更改背景颜色或播放声音与使用 timeit 实际发生的这些事件之间的延迟。（我在 Windows 上，Python 2.73）
我正在做一个反应时间测试，我会在更改背景颜色或播放声音之前记录时间（使用 time.clock()）。然后，当受试者按下一个键时，我再次记录时间并取差以找到反应时间。
对于声音播放，这就是我所做的：

```
import timeit
t = timeit.Timer(stmt = "winsound.PlaySound('C:\WINDOWS\media\Windows XP Error.wav', winsound.SND_FILENAME)",setup = "import winsound")
n = t.timeit(number = 100) 
print n/100 -0.999 
```

0.999 是*Windows XP Error.wav*的持续时间（以秒为单位）。
这给了我大约 56 毫秒的时间。我不确定它是否合理，是否正确，以及我是否应该启用垃圾收集？

* * *

对于背景变化，我遇到了更多问题。由于我在全屏模式下进行测试，因此我尝试将所有这些都放入设置参数中：

```
from Tkinter import Tk
root=Tk()
root.overrideredirect(True)
root.geometry("{0}x{1}+0+0".format(root.winfo_screenwidth(),root.winfo_screenheight()))
root.mainloop() 
```

即使我用 ; 将它们分开 我仍然遇到语法错误。当我不是全屏尝试时
`setup = 'from Tkinter import Tk; root=Tk(); root.mainloop()'`，窗口实际上会打开，但什么也没有发生，如果我关闭它，我会看到其他错误。`Invalid command name "."`
我实际测量的语句是`root.configure(background='red')`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T03:20:29.973

下面是创建用于使用的多行设置字符串的方法示例`timeit`：

```
setup = """
import random
l1 = [random.randrange(100) for _ in xrange(100)]
l2 = [random.randrange(100) for _ in xrange(10)]
""" 
```

这是另一个提示。为了获得准确的测量结果，按照以下基本模式计时很重要：

```
time = min(timeit.repeat(statements, setup=setup, repeat=R, number=N)) 
```

R 至少为 3 ( `R = 3`)。这需要通过执行所有操作 3 次获得的最快值，这将消除由于系统在后台运行的许多其他事情而导致的差异。

这并不能回答您的全部问题，但可能对您的探索有所帮助。

# java - 将 h:outputText 中的字符串转换为大写字符串？

> ID：13426854
> 
> 赞同：10
> 
> 时间：2012-11-17T01:48:23.707
> 
> 标签：java, jsf, seam

如何在 h:outputText 中转换字符串？这是 h:outputText 的代码：

```
<h:outputText value="#{item.label} : " /> 
```

我试过用这个，

```
<s:convertStringUtils format="capitalize" trim="true"/> 
```

但它给了我错误：“没有为名称定义标签：convertStringUtils”

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-17T02:02:23.650

有几种方法。

1.  使用 CSS`text-transform: capitalize`属性。

    ```
    <h:outputText value="#{bean.text}" styleClass="capitalized" /> 
    ```

    和

    ```
    .capitalized {
        text-transform: capitalize;
    } 
    ```

2.  创建自定义[`Converter`](http://docs.oracle.com/javaee/6/api/javax/faces/convert/Converter.html).

    ```
    <h:outputText value="#{bean.text}" converter="capitalizeConverter" /> 
    ```

    和

    ```
    @Override
    public String getAsString(FacesContext context, UIComponent component, Object modelValue) {
        if (modelValue == null || ((String) modelValue).isEmpty()) {
            return null;
        }

        String string = (String) modelValue;
        return new StringBuilder()
            .append(Character.toTitleCase(string.charAt(0)))
            .append(string.substring(1))
            .toString();
    } 
    ```

3.  使用[OmniFaces](http://omnifaces.org)的[`of:capitalize()`功能](http://showcase.omnifaces.org/functions/Strings)。

    ```
    <html ... xmlns:of="http://omnifaces.org/ui">
    ...
    <h:outputText value="#{of:capitalize(bean.text)}" /> 
    ```

你正在尝试的`<s:convertStringUtils>`不是来自Seam。它来自 MyFaces Sandbox。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-10T01:31:47.663

以下适用于 JSF 1.2 和 Seam 2.x。它可能在没有 Seam 的情况下工作，但我不记得 Seam 是如何在 Java EE 5 中扩展 EL 的。

```
<h:outputText value="#{item.label.toUpperCase()} : " />

<!-- If your string could be null -->
<h:outputText value="#{(item.label != null ? item.label.toUpperCase() : '')} : " /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T01:50:13.170

在数据 bean 中创建一个 getter 方法

```
public String getCapitalizeName(){
  return StringUtils.capitalize(getName());
} 
```

在 xhtml 上

```
<houtputText value="#{yourDataBean.capitalizeName}"/> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T04:17:32.627

正如@BalusC 所说，您可以使用`text-transform: capitalize;`. 但它会将句子中每个单词的首字母转换为大写。如果您的要求是，那是最好的答案，因为
**1.**它更容易
**2.** `text-transform: capitalize;`所有主要浏览器都支持。

但是，如果您只想将句子的第一个字母大写，您可以这样做。

```
public String getLabel() {
  if(label != null && !label.isEmpty()) {
    return Character.toUpperCase(label.charAt(0)) + label.substring(1);
  }
  return label;
} 
```

我不认为**JBoss Seam**有`<s:convertStringUtils>`标签。我认为这样的标签在**Apache MyFaces**中可用。对此了解不多。

# api - 尝试在 android 2.1 上运行 BluetoothChat

> ID：13426855
> 
> 赞同：1
> 
> 时间：2012-11-17T01:48:44.117
> 
> 标签：api, reflection, bluetooth, android-2.0-eclair

我正在尝试在 2.1 (eclair) 手机上运行示例 SDK 包 BluetoothChat，但它与

java.lang.NoSuchMethodError: android.bluetooth.BluetoothAdapter.listenUsingInsecureRfcommWithServiceRecord

有没有一种简单的方法可以让它工作？诸如简单地将较新版本的 android.bluetooth 与我的程序捆绑在一起之类的东西？我可以在 4.0.4 上运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T04:12:42.623

解决它！我使用 SDK 管理器安装了 2.1 示例包以及 2.1 SDK，用它创建了一个新项目，并且运行良好。

# java - MenuItem actionPerformed 在 AppletViewer 中有效，但在浏览器中无效

> ID：13426856
> 
> 赞同：1
> 
> 时间：2012-11-17T01:48:45.003
> 
> 标签：java, swing, applet, japplet, appletviewer

我正在将一个中型 (13892 LOC) Java Swing 应用程序转换为一个小程序。

到目前为止，我已经让小程序在 Applet Viewer（通过 Eclipse）和浏览器（用 Chrome 和 Firefox 测试）中运行并显示。

但是，应用程序没有注册任何点击事件。JMenuItem、JButton 等都不是。

应用程序的一般结构如下

```
public class MainWindow extends  JInternalFrame implements ActionListener { 
 ...
    private JToolBar toolBar;
    private JButton btnOpen;
 ...
    toolBar = new JToolBar();
    getContentPane().add(toolBar, BorderLayout.NORTH);
    btnOpen = new JButton("Open");
    btnOpen.addActionListener(this);
    toolBar.add(btnOpen);
 ...
    @Override
    public void actionPerformed(ActionEvent event) {
            btnOpen.setText("ACTION PERFORMED");
    if (event.getSource().equals(btnOpen)) {
        btnOpen_clicked();
    }       
    private void btnOpen_clicked() {
       btnOpen.setText(btnOpen.getText()+"/YAY!");
    }
} 
```

关于为什么会发生这种情况的任何线索？

# c - C中同一结构内的结构数组

> ID：13426857
> 
> 赞同：1
> 
> 时间：2012-11-17T01:48:50.433
> 
> 标签：c, arrays, struct

有没有办法创建一个结构，并在 C 中创建一个相同类型的结构的数组？

例如

```
typedef struct Vertex{
    char letter;
    Vertex edges[];
}Vertex; 
```

我需要在同一个结构中的结构数组。这在 C 中是否有可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:55:53.553

你可以这样做：

```
typedef struct _Vertex {
    char letter;
    struct _Vertex* pEdges;
} Vertex; 

Vertix v;
v.pEdges = (Vertex*)malloc(sizeof(Vertex) * n);
v.pEdges[0].letter = '0'; 
```

您需要一些方法来了解/跟踪每个数组中有多少项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T02:35:48.923

[让我们假设一下，根据您对不同答案的评论](https://stackoverflow.com/questions/13426857/array-of-structs-within-the-same-struct-in-c/13426863#comment18352030_13426863)，我知道您*真正*在寻找什么：一种将有限数量的顶点结构引用为某个顶点的边的方法，并且必须为*所有*顶点记录复制在你的有限集中。

 *假设它是一个 Vertex 结构的线性列表；特定大小的已分配数组，（或通过`realloc()`算法不断扩展）：

```
-----------------------------------------
| Vertex[0] | Vertex[1] | Vertex[2] ... |
----------------------------------------- 
```

现在假设在上述每一项的末尾，您需要*某种*方式来调和

```
Vertex    Edges
------    -------
[0]       [1],[2]
[1]       [0],[2]
[2]       [0],[1] 
```

很抱歉使用了一个简单的三角形，但这是我能想到的最简单的例子。无论如何继续前进。如果这是您正在寻找的模型，您可以按如下方式定义您的顶点结构：

```
typedef struct Vertex
{
    char value;     // node 'value'
    int n;          // number of edge indices.
    int *edges;     // dynamic edge index list. [0..(n-1)]
} Vertex; 
```

在定义上述示例时，您将执行以下操作。

1.  确定全局列表中的哪些顶点条目是当前条目的边。
2.  分配一个动态索引列表来保存这些边缘“id”的插槽。
3.  将每个边顶点索引分配到您的索引列表中。

一个简单（非常）的例子是有保证的：

```
Vertex vtx[3];

// wire vtx[1] and vtx[2] as edges of vtx[0].
vtx[0].value = 'a';
vtx[0].n = 2;
vtx[0].edges = malloc(2 * sizeof(int));
vtx[0].edges[0] = 1;
vtx[0].edges[1] = 2;

// wire vtx[0] and vtx[2] as edges of vtx[1].
vtx[1].value = 'b';
vtx[1].n = 2;
vtx[1].edges = malloc(2 * sizeof(int));
vtx[1].edges[0] = 0;
vtx[1].edges[1] = 2;

// wire vtx[0] and vtx[1] as edges of vtx[2].
vtx[2].value = 'c';
vtx[2].n = 2;
vtx[2].edges = malloc(2 * sizeof(int));
vtx[2].edges[0] = 0;
vtx[2].edges[1] = 1; 
```

所以假设你有 vtx[0]。你如何到达他的第一个边缘？

```
Vertex *edge = vtx[ vtx[0].edges[0] ]; 
```

从那里您可以移动到*该*边缘的第一个边缘

```
edge = vtx[ edge->edges[0] ]; 
```

等等。一张图抵不过一千个字：

```
-------------------------------------
| Vertex[0] | Vertex[1] | Vertex[2] |
| value = a | value = b | value = c |
| count = 2 | count = 2 | count = 2 |
|-----------|-----------|-----------|
|edges[0]=1 |edges[0]=0 |edges[0]=0 |
|edges[1]=2 |edges[1]=2 |edges[1]=1 |
------------------------------------- 
```

清理需要您`free()`在全局列表的每个顶点中的索引列表指针。如果全局列表本身是动态分配的，那么你`free()`也是。在我们上面的示例中，它不是。

我希望至少能让您了解如何做到这一点，而不必去 malloc-nutz 和到处复制数据。总之，在此示例中，可以利用顶点节点列表来维护您真正想要的信息（边），而无需复制顶点节点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T06:10:31.527

就像 Jonathan Wood 和 ouah 说的那样去做。在 C 中，我们不能将数组（实际上是结构本身）放入结构中。但是，指向结构的指针会很好地工作。例如，当我们用C实现一个列表时，我们经常使用如下结构：

```
struct listname{
    void *value;
    struct listname *next;
} 
```

然后，为了放置一个数组，将一个指向结构数组的指针放入其中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T01:49:28.430

```
typedef struct Vertex{
   char letter;
   struct Vertex *edges;
   int n;
}Vertex; 
```

或者

```
typedef struct Vertex Vertex;
struct Vertex{
   char letter;
   Vertex *edges;
   int n;
}; 
```

例如：

```
Vertex bla;
const int n = 42;
bla.n = n;
bla.edges = malloc(n * sizeof (*bla.edges)); 
```*

# php - iptcembed 返回 false

> ID：13426858
> 
> 赞同：1
> 
> 时间：2012-11-17T01:48:51.847
> 
> 标签：php, image, metadata

我的代码调用 iptcembed() 来设置一些图像元标记，但由于某种原因 iptcembed() 对我的一些图像返回 false。

对于其他图像， iptcembed() 工作得非常好。

我找不到图像之间的任何差异。它们都是 .jpg 图像。

知道为什么 iptcembed() 可能会为某些图像返回 false 吗？

使用 error_get_line()，我发现当 iptcembed() 返回 false 时，我收到以下错误消息：

```
Array ( [type] => 2 [message] => iptcembed() [function.iptcembed]: Unable to open abe.jpg [file] => C:\projects\imagemetadata\Image Metadata\Image Metadata\iptc.php [line] => 110 ) 
```

（我正在使用来自[http://php.net/manual/en/function.iptcembed.php](http://php.net/manual/en/function.iptcembed.php)的 iptc 代码，2008 年 9 月的用户注释）

非常感谢，路易莎

# c# - 列表<>和重载

> ID：13426860
> 
> 赞同：2
> 
> 时间：2012-11-17T01:49:03.227
> 
> 标签：c#, list, generics, overloading

我在这里有一门课，我想求和（对于列表中的每个 Traid T）（T.Price*T.Buy）。（如果是买入，买入是+1，如果是卖出，则为-1）。例如，如果我有 {Buy=-1,Price=10} 和 {Buy=1, price is =4}，我会得到 -6。我想要一种雄辩的方式来做到这一点，我假设我应该做某种重载？我是编程新手，以前没有这样做过。提前致谢。

-里克

```
 private class Traid
        {
            public DateTime Date { get; set; }
            public int Index { get; set; }
            public int Buy { get; set; }
            public int Price {get;set;}
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T01:51:18.113

您可以使用[`Enumerable.Sum`](http://msdn.microsoft.com/en-us/library/bb535184.aspx)：

```
int total = list.Sum(t => t.Price*t.Buy); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T01:51:25.453

在 IEnumerable 上使用 Linqs Sum() 方法：

```
IEnumerable<Trade> trades = GetTrades();
var sum = trades.Sum(trade => trade.Buy * trade.Price); 
```

# python - 将默认 python 安装从 2.6 迁移到 2.7：easy_install 的问题

> ID：13426872
> 
> 赞同：4
> 
> 时间：2012-11-17T01:51:05.197
> 
> 标签：python, debian, easy-install

我正在使用带有默认 python 安装 2.6 的 debian 我想迁移到 python 2.7，包括安装 easy_install。我按照别人的指示删除了我的 /usr/bin/python，然后链接

```
ln -s /usr/bin/python2.7 /usr/bin/python 
```

我下载了最新版本的[setuptools](http://pypi.python.org/packages/2.7/s/setuptools/)

并 cd 到文件中。安装帮助要求我将其作为 shell 程序运行，我确实这样做了，但出现以下错误：

```
sh setuptools-0.6c11-py2.7.egg
Traceback (most recent call last):
    File "<string>", line 1 in <module>
ImportError: No Module named setuptools.command.easy_install 
```

我有一种感觉，我的easy_install安装与我正在运行的python版本有关，但我不太清楚。我还尝试下载 .tar.gz 文件，cd-ing 到目录中，然后运行

```
python setup.py build; setup.py install 
```

运行之后，我可以使用easy_install，但出现以下错误：

```
Traceback (most recent call last):
  File "/usr/local/bin/easy_install", line 5, in <module>
    from pkg_resources import load_entry_point
ImportError: No Module named pkg_resources 
```

任何人都可以向我建议一个解决方案吗？谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T06:38:14.530

替换系统 Python 不是一个好主意。提高一分版本 *可能*不会破坏您的系统，但谁愿意冒险呢？如果它们相互冲突，使用 Python 将库安装到您的系统`easy_install`也会导致问题。

另一种方法是从源代码构建 Python，将其安装到您的主目录，然后使用 virtualenv 创建隔离环境，您可以在其中安装给定项目所需的任何库`pip`（这是更现代的等价于`easy_install`）。

对于 Python 2.7，如果您想要标准库的一些“可选”部分，这意味着还要构建一些其他的东西。这是一个脚本（主要是从散布在互联网上的博客文章拼凑而成）在 Debian "Squeeze" 上对我有用（在撰写本文时是稳定的）：

```
#!/bin/bash -e

# Setup
sudo aptitude install build-essential
mkdir -p ${HOME}/.local
mkdir build-python
cd build-python

# Get sources

### Tcl/Tk <http://www.tcl.tk/software/tcltk/download.html>
wget "http://downloads.sourceforge.net/project/tcl/Tcl/8.5.13/tcl8.5.13-src.tar.gz"
wget "http://downloads.sourceforge.net/project/tcl/Tcl/8.5.13/tk8.5.13-src.tar.gz"

### Berkeley DB <http://www.oracle.com/technetwork/products/berkeleydb/downloads/index-082944.html>
wget "http://download.oracle.com/berkeley-db/db-4.8.30.tar.gz"

### Python <http://www.python.org/download/>
wget "http://www.python.org/ftp/python/2.7.3/Python-2.7.3.tgz"

# Build Tcl
tar xzf tcl8.5.13-src.tar.gz
cd tcl8.5.13/unix
./configure --prefix=${HOME}/.local
make
make install
cd ../..

# Build Tk
tar xzf tk8.5.13-src.tar.gz
cd tk8.5.13/unix
./configure --prefix=${HOME}/.local
make
make install
cd ../..

# Build Berkeley DB 4.8
tar xzf db-4.8.30.tar.gz
cd db-4.8.30/build_unix
../dist/configure --prefix=${HOME}/.local/opt/BerkeleyDB.4.8 --enable-tcl --with-tcl=${HOME}/.local/lib
make
make install
cd ../..

# Set compile flags
export LDFLAGS="-L${HOME}/.local/lib -L${HOME}/.local/opt/BerkeleyDB.4.8/lib"
export CPPFLAGS="-I${HOME}/.local/include -I${HOME}/.local/opt/BerkeleyDB.4.8/include"
export CXXFLAGS=${CPPFLAGS}
export CFLAGS=${CPPFLAGS}
export LD_LIBRARY_PATH=${HOME}/.local/lib:${HOME}/.local/opt/BerkeleyDB.4.8/lib
export LD_RUN_PATH=${LD_LIBRARY_PATH}

# Build Python 2.7
tar xzf Python-2.7.3.tgz
cd Python-2.7.3
./configure --prefix=${HOME}/.local
make
make altinstall
cd ..

# Install virtualenv, pip and virtualenvwrapper
curl http://python-distribute.org/distribute_setup.py | ${HOME}/.local/bin/python2.7
curl https://raw.github.com/pypa/pip/master/contrib/get-pip.py | ${HOME}/.local/bin/python2.7
${HOME}/.local/bin/pip install virtualenvwrapper

# Update ~/.bashrc
echo 'export PATH="${HOME}/.local/bin:${PATH}"' >> ${HOME}/.bashrc
echo 'export WORKON_HOME="${HOME}/.local/virtualenv"' >> ${HOME}/.bashrc
echo 'export VIRTUALENVWRAPPER_PYTHON="${HOME}/.local/bin/python2.7"' >> ${HOME}/.bashrc
echo 'export VIRTUALENVWRAPPER_VIRTUALENV="${HOME}/.local/bin/virtualenv"' >> ${HOME}/.bashrc
echo 'export VIRTUALENVWRAPPER_VIRTUALENV_ARGS="--python=python2.7"' >> ${HOME}/.bashrc
echo 'source ${HOME}/.local/bin/virtualenvwrapper.sh' >> ${HOME}/.bashrc

# Finish ...
cd ..
echo -e "\n\n ... Done!" 
```

如果需要，此脚本将询问您的密码以安装 GCC 等，然后需要一段时间来构建所有内容 - 在我的（古老的）机器和（糟糕的）互联网连接上大约需要 25 分钟。如果您注意，在某些时候您会看到以下消息滚动过去：

```
Python build finished, but the necessary bits to build these modules were not found:
bsddb185           dl                 imageop         
sunaudiodev                                           
To find the necessary bits, look in setup.py in detect_modules() for the module's name. 
```

这四个模块已经过时和/或已弃用，因此您无需担心它们。如果消息提到任何其他模块，这意味着您的系统上没有安装一些必要的库。如果是这种情况，您仍然可以运行 Python，但无法导入这些模块。如果您受到此影响，请在评论中大喊，我会相应地更新脚本。

成功完成后，您需要获取您的`.bashrc`：

```
$ source ~/.bashrc 
```

...然后您就可以运行新编译的 Python ...

```
$ python2.7
Python 2.7.3 (default, Nov 17 2012, 02:00:26) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

...创建一个virtualenv来工作...

```
$ mkvirtualenv my_env
$ python
Python 2.7.3 (default, Nov 17 2012, 02:00:26) 
[GCC 4.4.5] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> 
```

...将库安装到其中...

```
$ pip install beautifulsoup4 
```

... 等等。

要退出 virtualenv：

```
$ deactivate 
```

要在以后重新输入：

```
$ workon my_env 
```

有关更多信息，请查看[pip](http://www.pip-installer.org/en/latest/)和[virtualenvwrapper](http://www.doughellmann.com/projects/virtualenvwrapper/)的文档。

# text - 使用 css 的文本边框（文本周围的边框）

> ID：13426875
> 
> 赞同：129
> 
> 时间：2012-11-17T01:51:24.180
> 
> 标签：text, css

有没有办法像下图那样在文本周围集成边框？

![文字边框](../Images/dded20619df1bf53a305b3eef71807ca.png)

* * *

## 回答 #1

> 赞同：266
> 
> 时间：2012-11-17T03:05:53.233

使用多个文本阴影：

```
text-shadow: 2px 0 0 #fff, -2px 0 0 #fff, 0 2px 0 #fff, 0 -2px 0 #fff, 1px 1px #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff; 
```

![在此处输入图像描述](../Images/8baed6f7e43d4fb3d287240fb0a07ee9.png)

```
body {
  font-family: sans-serif;
  background: #222;
  color: darkred;
  }
h1 {
  text-shadow: 2px 0 0 #fff, -2px 0 0 #fff, 0 2px 0 #fff, 0 -2px 0 #fff, 1px 1px #fff, -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff;
}
```

```
<h1>test</h1>
```

或者，您可以使用仅适用于 webkit 的文本笔划：

```
-webkit-text-stroke-width: 2px;
-webkit-text-stroke-color: #fff; 
```

![在此处输入图像描述](../Images/67ea55538edc53f4b580ea3b8428131a.png)

```
body {
  font-family: sans-serif;
  background: #222;
  color: darkred;
  }
h1 {
  -webkit-text-stroke-width: 2px;
-webkit-text-stroke-color: #fff;
}
```

```
<h1>test</h1>
```

另[请阅读更多](http://css-tricks.com/adding-stroke-to-web-text/)作为 CSS-Tricks 的内容。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-17T01:58:17.580

当然。你可以使用 CSS3 `text-shadow`：

```
text-shadow: 0 0 2px #fff; 
```

但是它不会立即在所有浏览器中显示。不过，使用[Modernizr](http://modernizr.com/)之类的脚本库将有助于在大多数浏览器中正确使用它。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2017-11-09T18:09:13.713

我不喜欢那么多基于文本阴影相乘的解决方案，它不是很灵活，它可能适用于添加方向为 8 的 2 像素笔画，但只有 3 像素的笔画方向变为 16，依此类推.. . 管理起来不太舒服。

正确的工具存在，它是 SVG`<text>` 浏览器的支持问题在这种情况下毫无价值，因为 text-shadow 的使用也有其自身的支持问题， `filter: progid:DXImageTransform`可以使用或 IE < 10 但通常无法按预期工作。

对我来说，最好的解决方案仍然是 SVG，并为旧版浏览器提供非笔触文本的后备：

这种方法几乎适用于所有版本的 Chrome 和 Firefox，自 3.04 版以来的 Safari，Opera 8，IE 9

与`text-shadow`他们的支持相比：Chrome 4.0、FF 3.5、IE 10、Safari 4.0、Opera 9，结果更加兼容。

```
.stroke {
  margin: 0;
  font-family: arial;
  font-size:70px;
  font-weight: bold;
  }

  svg {
    display: block;
  }

  text {
    fill: black;
    stroke: red;
    stroke-width: 3;
  }
```

```
<p class="stroke">
  <svg xmlns="http://www.w3.org/2000/svg" width="700" height="72" viewBox="0 0 700 72">
    <text x="0" y="70">Stroked text</text>
  </svg>
</p>
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2015-05-28T10:22:18.233

```
text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-11-17T02:10:48.923

以下将涵盖所有值得介绍的浏览器：

```
text-shadow: 0 0 2px #fff; /* Firefox 3.5+, Opera 9+, Safari 1+, Chrome, IE10 */
filter: progid:DXImageTransform.Microsoft.Glow(Color=#ffffff,Strength=1); /* IE<10 */ 
```

# android - Android AlarmManager 间隔波动

> ID：13426878
> 
> 赞同：0
> 
> 时间：2012-11-17T01:51:41.367
> 
> 标签：android, alarmmanager

我正在使用间隔为 5 分钟的 AlarmManager，并且我已经进行了几天的测试，似乎 AlarmManager 的间隔并非一直都是恒定的，但它有时会发生变化。这导致我的应用程序无法正常工作。

为什么会这样？有解决办法吗？

我正在使用的代码是：

```
iHeartBeatService = new Intent(SpyMe.context, HeartBeat.class);
piHeartBeatService = PendingIntent.getService(SpyMe.context, 101010, iHeartBeatService, PendingIntent.FLAG_UPDATE_CURRENT);
alarmManager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(), 5 * 60 * 1000, piHeartBeatService); 
```

在装有 Android 2.2 的三星 Galaxy 3 I5800 上

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:50:01.233

您需要发布您的代码以便我们为您提供帮助。我将在这里在黑暗中拍摄，并猜测您没有使用 RTC_WAKEUP 进行警报。

```
 alarm.set(AlarmManager.RTC_WAKEUP, calander.getTimeInMillis(), pendingIntent); 
```

# android - Android Camera : 图片不应该存储在本地，而应该暂时保存在 App 中

> ID：13426883
> 
> 赞同：0
> 
> 时间：2012-11-17T01:53:25.010
> 
> 标签：android, storage, android-camera, android-service

我是 android 新手，正在尝试制作一个 android 应用程序，用户可以在其中单击图像并将其保存到数据库中。但是我不希望图像本地存储在画廊文件夹中。或者每次拍照时它都会将自己保存在手机上的自制目录中并不断替换早期的照片。我不希望所有照片都存储在手机上。

以下是我当前的代码：

```
package com.example.camerastart;

import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

public class CameraMainActivity extends Activity 
{

    private static final int CAMERA_PIC_REQUEST = 2500;
    private Button cam_button;

    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_camera_main);

        cam_button = (Button) findViewById(R.id.button1);
        cam_button.setOnClickListener(new OnClickListener()
        {

            @Override
            public void onClick(View v)
            {
                Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
                startActivityForResult(cameraIntent, CAMERA_PIC_REQUEST);
                // TODO Auto-generated method stub

            }

        });
    }

    protected void onActivityResult(int requestCode, int resultCode, Intent data) 
    {
        if (requestCode == CAMERA_PIC_REQUEST && resultCode == RESULT_OK)
        {
              Bitmap image = (Bitmap) data.getExtras().get("data");
              ImageView imageview = (ImageView) findViewById(R.id.imageView1);
              imageview.setImageBitmap(image);
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_camera_main, menu);
        return true;
    }

} 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-16T10:52:19.763

You can make a folder, and save all the images to this folder. just remember to add .nomedia file to this folder, and then the gallery will not show those files

# c# - 将对象转换为 Stack 类型

> ID：13426886
> 
> 赞同：0
> 
> 时间：2012-11-17T01:53:47.513
> 
> 标签：c#, windows-phone-7

我正在尝试获取我正在获取的对象 stackVal，并将其转换为对象类型 Stack，这是我的代码，但它不起作用，我不确定任何其他方式。如果有人可以提供帮助，我们将不胜感激！

* * *

```
 object stackVal;
      Stack<Event> eventStack = new Stack<Event>();
      CultureInfo provider = new CultureInfo("fr-FR");

            if (phoneAppSer.State.ContainsKey("STACK"))
            {
                if (phoneAppSer.State.TryGetValue("STACK", out stackVal))
                {

                 eventStack = Convert.ChangeType(stackVal, typeof(EventStack),provider);

                }
            } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T09:14:31.303

StackEvent 和泛型 Stack 不是同一类型。您正在尝试将来自 Convert 的 EventStack 类型的响应分配给 Stack 类型的变量。编译器暗示你应该这样做：

```
eventStack = (Stack<Event>) Convert.ChangeType(stackVal, typeof(EventStack),provider); 
```

# haskell - 将 Netwire 网络连接到 OpenGL/GLUT 回调

> ID：13426888
> 
> 赞同：0
> 
> 时间：2012-11-17T01:53:53.900
> 
> 标签：haskell, glut, frp

作为实验，我设置了一组模拟齿轮连接到电机并使用 OpenGL/GLUT 渲染它们。目前，Wire 网络的唯一输入是`Time`. 我想用键盘来控制改变电机的速度。我还想将物理时间步从帧速率中分离出来，如[修复你的时间步中所述！](http://gafferongames.com/game-physics/fix-your-timestep/).

这意味着我需要使用三种不同类型的输入从三个不同的 GLUT 回调（、、和）`keyboardMouseCallback`运行`idleCallback`Wire网络。`displayCallback`我不清楚如何将 Netwire 与 GLUT 回调集成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T04:01:02.917

GLUT 对需要控制主循环的框架（例如 Netwire）有点敌意。这是可能的，但您可能必须使用 IORef 或类似的东西。我所知道的对 Netwire 最友好的 OpenGL 管理器是 SDL，当然你也可以试试 Nicol 的 GLFW 建议。否则，您确实必须从多个事件处理程序中走出来。

为了处理实际的键盘输入，我建议您将事件信息添加到您正在使用的任何底层 monad（阅读器 monad 可能是最好的解决方案）。然后实现，比如说，`keyDown`每当按住给定键时产生一条线：

```
keyDown :: (Monoid e) => Key -> Wire e (Reader GuiState) a a 
```

现在你可以做这样简单的事情：

```
position = integral_ 0 . speed
    where
    direction key dir = dir . keyDown key <|> 0
    speed = direction Right 1 + direction Left (-1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T02:01:17.340

你有没有考虑过……不这样做？

没有法律规定您必须使用（免费）GLUT。GLFW（几乎）同样有能力，它允许您根据需要控制渲染循环。它是一个基于轮询的 API，所以任何回调只会在你想要的时候发生。

# android - 如何绘制填充多边形？[安卓、安卓引擎]

> ID：13426889
> 
> 赞同：2
> 
> 时间：2012-11-17T01:53:59.603
> 
> 标签：android, andengine

我想在 Andengine gles2 中绘制填充多边形。

我有多边形的顶点。我怎么能画出来？问题是它可以有任意数量的顶点（4、30）。

下一个问题是我想用我的图像填充这个多边形（或者如果不可能的话只填充颜色）。

找不到任何功能。是否可以 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-02T17:44:20.187

通过这种方式，您可以创建包含重复图像的多边形。

```
final float offsetX = 0f;
final float offsetY = 115f;
final float[] vertexX1 = { 200f-offsetX, 400f-offsetX, 300f-offsetX, 200f-offsetX};
final float[] vertexY1 = { 200f-offsetY, 200f-offsetY, 300f-offsetY, 300f-offsetY};

final TexturedPolygon myRepeatingSpriteShape = new TexturedPolygon(offsetX, offsetY,       vertexX1, vertexY1, myTextureRegion, this.getVertexBufferObjectManager());
mScene.attachChild(myRepeatingSpriteShape); 
```

此实现由社区成员之一**recastrodiaz 创建**。我认为这将解决您的问题。

# vim - Nerdtree 在 VIM (ubuntu) 中不被识别为命令

> ID：13426897
> 
> 赞同：3
> 
> 时间：2012-11-17T01:55:15.303
> 
> 标签：vim, nerdtree, pathogen

我已经从 github 安装了 pathology.vim 到`.vim/autoload`目录中，并编辑了我的 .vimrc 以包含以下行

```
pathogen#infect()
pathogen#helptags()

autocmd vimenter * NERDtree 
```

我已经从[GitHub > scrooloose/nerdtree](https://github.com/scrooloose/nerdtree)安装了最新版本的 nerdtree到我的`.vim/bundle`目录中

尽管如此，vim 告诉我 NERDtree 不是一个公认的命令。我现在不知所措。任何帮助将不胜感激。

史蒂夫凯恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T02:17:21.597

NERDtree => NERDTree（大写 T）

# jsf - 带有 Glassfish 的模块化 JSF

> ID：13426899
> 
> 赞同：0
> 
> 时间：2012-11-17T01:55:22.183
> 
> 标签：jsf, plugins, glassfish, modular

我有一个大问题。

我正在尝试创建一个模块化的 JSF 应用程序，就像 liferay 中的插件系统，但不太复杂。

我的问题是：

我可以使用 JSF 2 和 Glassfish 动态加载/卸载 JAR 文件（将用于我的应用程序的模块或插件）吗？

有什么建议吗？我需要使用 JSF（没有 osgi 或 spring）。

提前致谢...

# android - Android中的相机 - 无法重新启动预览？不知道图片存放在哪里？

> ID：13426900
> 
> 赞同：1
> 
> 时间：2012-11-17T01:55:21.950
> 
> 标签：android, camera, customization, storage, preview

拍照后什么时候应该在相机上调用 startPreview？使用了演示中的代码：http: [//developer.android.com/guide/topics/media/camera.html](http://developer.android.com/guide/topics/media/camera.html)

在一定程度上可以工作，但我不知道如何让表面支架刷新，以便为下一次拍摄做好准备。

此外，对于我的生活，我无法弄清楚照片的去向。另外，有没有办法让他们像普通相机一样去画廊？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T08:56:26.997

`startPreview()`在您的 captureButton 中引入并`onclick()`使用布尔标志控制它。

例如，设标志为`isPicTaken`。每次单击新图片时都应设置为**true**，开始预览时应设置为**false**。代码应该类似于 -

```
Button captureButton = (Button) findViewById(id.button_capture);
captureButton.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        if (!isPicTaken) {          
            mCamera.takePicture(shutterCallback, rawCallback, jpegCallback);
        } else {                
            mCamera.startPreview();
            isPicTaken = false;     
        }
    }
}); 
```

请注意，`mCamera.takePicture`这里使用所有三个回调，即`(shutterCallback, rawCallback, jpegCallback)`. 您检查过的文档中给出了最后一个回调的用法，其余两个回调可以像 -

```
// Called when shutter is opened
ShutterCallback shutterCallback = new ShutterCallback() { 
    public void onShutter() {
        isPicTaken = true;  //set flag true only when shutter is called.
        // 
    }
};

// Handles data for raw picture
PictureCallback rawCallback = new PictureCallback() {
    public void onPictureTaken(byte[] data, Camera camera) {
        //
    }
}; 
```

检查[此示例](http://marakana.com/forums/android/examples/39.html)，如果您是全新的，甚至可以将其用作参考。希望这可以帮助。

# c++ - 地图中的分配最终为 0？

> ID：13426904
> 
> 赞同：0
> 
> 时间：2012-11-17T01:56:38.677
> 
> 标签：c++, map

我是 C++ 的初学者，最近我正在参加有关送礼的 USACO 培训计划。然而，虽然输出应该显示每个相关人员的姓名和他们各自的现金金额，但我的总是以全零结束。这是我的代码：

```
/*
ID: afuhrtr1
PROG: gift1
LANG: C++
*/
#include <iostream>
#include <fstream>
#include <string>
#include <sstream>
#include <map>

using namespace std;

int main() {
    stringstream ss;
    ofstream fout ("gift1.out");
    ifstream fin ("gift1.in");
    int np;
    fin >> np;
    string people [np];
    map<string, int> amounts;
    for (int i = 0; i < np; i++)
    {
        string name;
        fin >> name;
        //amounts[name]=0;
        people[i] = name;
    }
    while (fin.good())
    {
        string giver;
        fin >> giver;
        string twoNumbers;
        fin >> twoNumbers;
        int spacePos = twoNumbers.find(' ');
        int amount;
        ss << twoNumbers.substr(0, spacePos);
        ss >> amount;
        int npgiven;
        ss << twoNumbers.substr(spacePos+1);
        ss >> npgiven;
        for (int i = 0; i < npgiven; i++)
        {
            string name;
            fin >> name;
            amounts[name]+=(amount/npgiven);
        }
        amounts[giver]+=(amount % npgiven - amount);
    }
    map<string, int>::iterator it;
    for (int i = 0; i < np; i++)
        fout << people[i] << " " << amounts[people[i]] << endl;
    return 0;
} 
```

我假设问题要么是为地图元素分配东西，要么是 fin.good() 调用。

另外，这是比赛场景：

一组 NP (2 ≤ NP ≤ 10) 个唯一命名的朋友决定交换金钱礼物。这些朋友中的每一个都可能会或可能不会给任何或所有其他朋友一些钱。同样，每个朋友可能会或可能不会从任何或所有其他朋友那里收到钱。你在这个问题中的目标是推断出每个人给的钱比他们得到的钱多。

送礼的规则可能与您预期的不同。每个人留出一定数量的钱来赠送，并将这笔钱平均分配给他或她正在赠送礼物的所有人。没有可用的小数钱，因此将 3 分给 2 个朋友，剩下 1 个的朋友各得 1 - 剩下的 1 个留在给予者的“帐户”中。

在任何一群朋友中，有些人比其他人付出更多（或者至少可能有更多的熟人），有些人比其他人有更多的钱。

给定一组朋友，其中没有一个人的名字超过 14 个字符，组中每个人花在礼物上的钱，以及每个人赠送礼物的朋友的（子）列表，确定还有多少（或少）小组中的每个人给予的比他们得到的多。

INPUT FORMAT 第 1 行：单个整数，NP 第 2..NP+1 行：每行包含一个组成员的名称 NP+2..end：NP 组的行组织如下：组中的第一行告诉将要送礼的人的姓名。该组中的第二行包含两个数字：送礼者分配礼物的初始金额（范围为 0..2000），然后是送礼者将送礼的人数 NGi (0 ≤ NGi ≤ NP-1)。如果 NGi 不为零，则接下来的每一行 NGi 都会列出礼物接受者的姓名。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:10:00.563

> USACO 没有任何类型的调试器，所以我不确定我是否可以有效地检查逻辑错误，但没有编译器错误。

那是你的主要问题。

当然，您可以在带有调试器的环境中运行此代码吗？有免费可用的 C++ 开发环境。没有调试器就无法编写 C++ 代码。StackOverflow 不是一个高效的调试器；）

# linux - bash 中的对话框未正确获取变量

> ID：13426908
> 
> 赞同：2
> 
> 时间：2012-11-17T01:57:58.720
> 
> 标签：linux, bash, dialog, sed, find

我对这个脚本的一致性有一点问题。您可以运行一次，没有任何问题。但是，如果您立即将其重新加载并再次运行，它不会正确获取变量，因为输出没有以正确的方式写入文件。

例如：此实用程序旨在更新 4 个文件。.temp、.tiers、.version 和 .sync 在通过对话框提示的各个阶段，它会更新文件。我的问题是，有时它不会更新文件，我找不到任何原因，因为它只是在你已经运行过一次之后。我在启动时擦除文件，所以我不确定这是什么交易。就好像它只是从记忆中抓取它一样？

无论如何，要对此进行测试，您需要 /test 中的以下文件

感谢任何可以给我一些指导的人。

```
cat .tiers
Stable=1
Release=2
Beta=3 
```

代码：

```
#!/usr/bin/env bash
touch .version
touch .temp
VERSION=`cat .version`
DIR=/test/
STORED=`cat ${DIR}/.temp`
################################
#     REARRANGE TIERS          #
################################
rearrange()
{
start
end
}

################################
#     SYNC FILE EXISTS         #
################################
sync_exists()
{
dialog --msgbox ".sync exists in the directory $(echo ${VERSION}).\n\n Use Tier Move                 instead." 10 40
clean_up
exit 1;
}

################################
#         CLEAN UP             #
################################
clean_up()
{
rm -rf .version
rm -rf .update
rm -rf .temp
}

################################
#     OPTOUT & CLEAN UP        #
################################
opt_out()
{
dialog --msgbox "You've opted out of the tier update." 5 40
rm -rf ${DIR}/.version ${DIR}/.update ${DIR}/.temp 
}

################################
#     UPDATE .TIERS FILE       #
################################
tier_updater()
{
dialog --msgbox "\n\n
$(cat ${DIR}/.temp) is now $VERSION." 8 27
sed -i s/${STORED}=.*/${STORED}=${VERSION}/g ${DIR}/.tiers
clean_up
}

################################
#     UPDATE FILE LIST         #
################################
file_updater()
{

rm -rf ${VERSION}/.sync
        for x in `find $VERSION -type d \( ! -iname "." \)|sed s/${VERSION}//g`; do echo     "d===$x===755" >> ${DIR}/${VERSION}/.sync ; done
        for y in `find $VERSION -type f \( ! -iname ".*" \)|sed s/${VERSION}//g`; do     echo "f===$y===644===`md5sum ${VERSION}"$y"|awk '{print $1}'`" >>     "${DIR}"/"$VERSION"/.sync;done
        find "${DIR}"/"${VERSION}" -type f -exec gzip -f '{}' \; > /dev/null 2>&1      |xargs gzip -d "${DIR}"/${VERSION}/.sync
}

################################
#     TIER UPDATE PROMPT       #
################################
tier_update_prompt()
{
if [ -f ${VERSION}/.sync ]; then  sync_exists
else file_updater
fi
dialog --menu "\n
Directory List Built.\n
File List Built.\n
Files Compressed.\n
Sync File in place.\n\n
Would you like to update the tier for $(cat ${DIR}/.temp)?" \ 15 60 2  "Yes" "This will     apply all changes for $(echo $VERSION) to $(cat ${DIR}/.temp)." "No" "This will revert all     changes." 2>&1 > ${DIR}/.update
if [ "$?" = "0" ] ; then
        _update=$(cat ${DIR}/.update)
if [ "$_update" = "Yes" ] ; then
tier_updater
fi
if [ "$_update" = "No" ] ; then
opt_out ;
fi
else
        echo "You have now exited the application"
    clean_up;
fi
}

################################
#     NEW VERSION INPUT        #
################################ 
stable()
{
dialog --inputbox "Enter the new version for $(cat ${DIR}/.temp)" 8 30 2>     "${DIR}"/.version
if [ -d `cat .version` ] ; then tier_update_prompt;
        else
            dialog --msgbox "WARNING!!!!\n\n The folder $(${VERSION}) does not     exist!\nPlease upload this folder before you proceed!" 8 50 ;
        clean_up
    fi
}

################################
#        TIER SELECTION        #
################################
startup()
{
dialog --menu "Tiers are currently set as the following. Which would you like to update?    \n" 12 78 5 \
"Stable" "$(cat ${DIR}/.tiers|grep Stable|sed 's/Stable=//g')" "Release" "$(cat     ${DIR}/.tiers|grep Release|sed 's/Release=//g')" "Beta" "$(cat ${DIR}/.tiers|grep Beta|sed     's/Beta=//g')"  2> "${DIR}"/.temp
# OK is pressed
if [ "$?" = "0" ] ; then
        _return=$(cat ${DIR}/.temp)
fi
if [ "$_return" = "Stable" ] ; then
stable
fi
if [ "$_return" = "Release" ] ; then
stable
fi
if [ "$_return" = "Beta" ] ; then
stable
    else 
            echo "You have now exited the application"      
    clean_up;
fi
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-17T02:55:37.050

您可以使用该方法将对话输入直接捕获到变量中：

```
exec 3>&1 
result=$(dialog  --menu head 15 20 6 $(for ((i=1;i<30;i++));do echo  tag$i item$i;done)  2>&1 1>&3);
exitcode=$?;
exec 3>&-;
echo $result $exitcode 
```

[http://mywiki.wooledge.org/BashFAQ/002](http://mywiki.wooledge.org/BashFAQ/002)

所以我的方法`startup`看起来像：

```
startup()
{
  exec 3>&1 
  _return=$(dialog --menu "Tiers are currently set as the following. Which would you like to update?    \n" 12 78 5 \
  "Stable" "$(cat ${DIR}/.tiers|grep Stable|sed 's/Stable=//g')" "Release" "$(cat     ${DIR}/.tiers|grep Release|sed 's/Release=//g')" "Beta" "$(cat ${DIR}/.tiers|grep Beta|sed     's/Beta=//g')"  2>&1 1>&3)
   exitcode=$?
   exec 3>&-;
    # OK is pressed
  if [ "$exitcode" == "0" ] ; then
    if [[ "$_return" == "Stable" || "$_return" == "Release" || "$_return" == "Beta" ]] 
    then
       stable
    fi
  fi
  echo "You have now exited the application"      
  clean_up;
} 
```

另外还有很多不干净的东西，比如 $(${VERSION}) 这里：

```
dialog --msgbox "WARNING!!!!\n\n The folder $(${VERSION}) does not 
```

正如我从代码中了解到的那样，它将运行空命令，因为 .version 在启动时为空并且

```
 VERSION=`cat .version` 
```

在 tier_update_prompt() $VERSION 仍然是空字符串，

我试图重构你的代码，但它变成了这样的建议：

*   得到如上图所示的对话结果
*   运行带参数的函数：

```
＃宣言
函数名（）{
  参数=$1;
  回声“$参数”
}
变量=值
#运行函数
函数名变量     

```

*   不要使用 ${VAR} 过于复杂，
*   记住双引号会扩展，所以`echo "here is $var"`不是`echo "here is $(echo ${var})"`
*   尽可能少地使用临时文件，例如：`diff <(ls dir1) <(ls dir2)`
*   不要将工作文件保存在根目录中（如 /test/）
*   不以 root 身份工作
*   学习 perl

# scala - 在 Guice 的 annotatedWith() 中使用 Scala 的注解

> ID：13426909
> 
> 赞同：3
> 
> 时间：2012-11-17T01:58:13.097
> 
> 标签：scala, types, annotations, guice

我只是在试验 Guice 和 Scala。在 Guice 中，可以使用自定义注解对构造函数参数进行注解，并使用`annotatedBy()`. 此方法需要类型扩展，`java.lang.annotation.Annotation`但 Scala 的注释有自己的层次结构，以`scala.annotation.Annotation`. 另一方面，如果我让类扩展 Java 的注释基类（或接口），我不能将它用作 Scala 代码中的注释。有什么办法可以互操作吗？

我知道我不应该在 Scala（蛋糕）中使用 Guice，我什至不想使用它。我只是很好奇，以防将来我会用另一个 Java 库来面对它。

# jersey - 减少球衣中的数据传输大小

> ID：13426911
> 
> 赞同：2
> 
> 时间：2012-11-17T01:58:18.743
> 
> 标签：jersey

我使用以下代码作为球衣客户端将 InputStream 对象发送到服务器：

```
public static boolean assignDATask(Map<String,Future<InputStream>> daInitTaskResponseMap, String daId, String campaignId,  List<Map> contList, Map campInfoBean, List<Map> campLinkBeanList, List<Map> timetableList, InputStream zippedAttachmentsStream, Map daTaskInfoBean, Map accountInfoBean){
    AsyncWebResource asr = daWebResourceMap.get(daId);
    if (asr!=null) {
        try {
            Integer readTimeoutValue = daReadTimeoutMap.get(daId).getDataAsInteger("assignBatch", DA_READ_TIMEOUT_ASSIGNBATCH_DEFAULT);
            asr.setProperty(ClientConfig.PROPERTY_READ_TIMEOUT, readTimeoutValue);
            FormDataMultiPart part = new FormDataMultiPart();
            part.field("crmId", crmId, MediaType.APPLICATION_XML_TYPE);
            part.field("campaignId", campaignId, MediaType.APPLICATION_XML_TYPE);
            if (contList!=null)
                part.field("contList", Util.zipDATransferParams(contList), MediaType.APPLICATION_XML_TYPE);
            if (campInfoBean!=null)
                part.field("campInfoBean", Util.zipDATransferParams(campInfoBean), MediaType.APPLICATION_XML_TYPE);
            if (campLinkBeanList!=null)
                part.field("campLinkBeanList", Util.zipDATransferParams(campLinkBeanList), MediaType.APPLICATION_XML_TYPE);
            if (timetableList!=null)
                part.field("timetableList",  Util.zipDATransferParams(timetableList), MediaType.APPLICATION_XML_TYPE);
            if (zippedAttachmentsStream!=null)
                part.field("zippedAttachmentsStream", zippedAttachmentsStream, MediaType.APPLICATION_XML_TYPE);
            part.field("daTaskInfoBean", Util.zipDATransferParams(daTaskInfoBean), MediaType.APPLICATION_XML_TYPE);
            if (accountInfoBean!=null)
                part.field("accountInfoBean", Util.zipDATransferParams(accountInfoBean), MediaType.APPLICATION_XML_TYPE);
            logger.debug("part size: "+SizeOf.deepSizeOf(part));
            Future<InputStream> assignDATaskResult =  asr.path("initDASendECampTask").type(MediaType.MULTIPART_FORM_DATA_TYPE).post(InputStream.class, part);
            logger.debug("assignDATaskResult size: "+SizeOf.deepSizeOf(assignDATaskResult));
            daInitTaskResponseMap.put(daId,assignDATaskResult);
            logger.debug("-----------------------------Current Time Sender: "+System.currentTimeMillis());
        } catch (IOException ioe) {
            logger.debug("Fail to zip the parameters", ioe);
            return false;
        }
    } else {
        logger.debug("DA not exist, DA ID: "+ daId);
        return true;
    }

    return true;
} 
```

FormDataMultiPart 为 72 个字节。但响应对象 (assignDATaskResult) 大约为 26 MB。我知道 assignDATaskResult 也用 ServletContext 包装。

然后我想知道如何测量我通过球衣发送的物体的尺寸？

该统计数据为我提供了网络上的高流量，在 2 小时的数据传输中约为 80 kB/s (640 kbps)。

这也是减少流量的任何方法吗？..也许将其转换为 JSON？

任何帮助将不胜感激。

# android - 同时使用内容提供程序和文件文件搜索

> ID：13426913
> 
> 赞同：0
> 
> 时间：2012-11-17T01:58:48.470
> 
> 标签：android, android-contentprovider, file-browser

我正在编写一个完全依赖于 android 内容提供程序（MediaStore）的音乐播放器。问题是内容提供者并不总是能获取设备上的所有音乐，尤其是当人们有奇怪的配置/自定义 rom 等时。

我确定那里有关于此的信息，但我不知道它叫什么或要搜索什么。基本上我希望设备使用内容提供者，但也在后台搜索媒体文件，然后将它们与内容提供者进行比较，如果它们在内容提供者中不存在，则将它们添加到我的适配器中。

是否有任何开源代码可以为音乐或图像或其他任何东西执行此操作？我想看一些例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:27:27.850

Android 有一个媒体扫描器，可以触发重新扫描。那应该将丢失的文件添加到`MediaStore`. 简单的方法是发送如下广播：

```
public static void triggerMediaScanner(Context context) {
    Uri data = Uri.fromFile(Environment.getExternalStorageDirectory());
    Intent intent = new Intent(Intent.ACTION_MEDIA_SCANNER_SCAN_FILE);
    intent.setData(data);
    context.sendBroadcast(intent);
} 
```

# php - 页面是随机的混乱

> ID：13426917
> 
> 赞同：-2
> 
> 时间：2012-11-17T01:59:44.280
> 
> 标签：php, pagination

我博客上的页面功能并没有发挥作用。单击第二页时，它会跳到第三页。单击第一页时，将加载第二页。我在网上某处找到了这个功能；它不是我自己的。

```
function generate_pages($total,$current)
{
    if($total > 1)
    {
        $total=intval($total);

        $output='<div class="page"><b>Pages:</b>  ';
        $current_page= (false == isset($current)) ? 1 : $current;
        for($page=1;$page<$total+1;$page++)
        {
            $lower=$current_page-3;
            $upper=$current_page+3;
            $special = ($page==$current_page) ? " class=\"current\"" : "";
            if(($page > $lower && $page < $upper) || $page < 2 || $page > ($total-1))
            {
                if($last_done_page+1 != $page) $output.= '... ';
                $output.='<b>[<a'.$special.' href="?pg='.$page.'">'.$page.'</a>] </b>';
                $last_done_page=$page;
            }
        }
        $output.='</div><br/>';
        return $output;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:37:00.320

我认为这些更改将帮助您：

```
function generate_pages($total,$current,$resultsPerPage)
{
    if($total > 1)
    {
        $total=intval($total/$resultsPerPage);

    if($total%$resultsPerPage>0)
    {
        $total=$total+1;
    }

        $output='<div class="page"><b>Pages:</b>  ';
        $current_page= (false == isset($current)) ? 1 : $current;
        for($page=1;$page<$total+1;$page++)
        {
            $lower=$current_page-3;
            $upper=$current_page+3;
            $special = ($page==$current_page) ? " class=\"current\"" : "";
            if(($page > $lower && $page < $upper) || $page < 2 || $page > ($total-1))
            {
                if($last_done_page+1 != $page) $output.= '... ';
                $output.='<b>[<a'.$special.' href="?pg='.$page.'">'.$page.'</a>] </b>';
                $last_done_page=$resultsPerPage;
            }
        }
        $output.='</div><br/>';
        return $output;
    }
} 
```

我添加了一个额外的参数 $resultsperPage.......

# objective-c - 如何检查是否有东西在移动？

> ID：13426924
> 
> 赞同：1
> 
> 时间：2012-11-17T02:01:39.343
> 
> 标签：objective-c, cocoa-touch, cocos2d-iphone

我正在制作一个让敌人射击东西的 cocos2d 应用程序。很多时候，当一个精灵被编程为在其队友被杀后移动到一个随机位置时，它会直接进入其他同类敌人的交火中。我如何制作一些东西来检查它是否在移动，因为大多数时候，游戏看起来就像是敌人试图自杀。我希望敌人能够自己，但不是在他们移动时。

```
-(void)enemy2{

    enemy2 = [CCSprite spriteWithFile:@"enemy2.png"];
    int d = arc4random()%480+480;
    int o = arc4random()%320+320;
    x = arc4random()%480;
    if( x <= 480 && x>= 460){
    x=x-100;
}
if(x <= 100){
    x = x+50;
}

y = arc4random()%320;
if(y <=320 && y >= 290){
    y = y-100;
}
if(y < 100){
    y = y + 100;
}
enemy2.position = ccp(o,d);

xc = x;
te = y;
   [enemytwo addObject :enemy2];

[self addChild:enemy2];

for(CCSprite *enetw in enemytwo){

    CCRotateBy *rotation = [CCRotateBy actionWithDuration:15 angle:1080];
    CCRepeatForever * repeatforever = [CCRepeatForever actionWithAction:rotation];

    int f = arc4random()%480;
    int s = arc4random()%320;      
    if( f <= 480 && s>= 460){
        f=f-100;
    }
    if(f <= 100){
        f = f+50;
    }

    s = arc4random()%320;
    if(s <=320 && s >= 290){
        s = s-100;
    }
    if(s < 100){
        s = s + 100;
    }

    CCMoveTo *move = [CCMoveTo actionWithDuration:0.8 position:ccp(f,s)];
    [enetw runAction: repeatforever];
    [enetw runAction:[CCSequence actions:move, nil]];

} 
```

}

弹丸：

```
-(void)projectileShooting:(ccTime)dt {
 [self schedule:@selector(projectileShooting:) interval:2.5];
projcount++;
if([proj count] <= 15 )
if(enemy1.position.y < 320){
v = ccp(player.position.x,player.position.y); 
for(CCSprite *enemies in enemy){ 
    CCSprite * projectilebullet = [CCSprite spriteWithFile:@"Projectile.png"];
    [proj addObject:projectilebullet];
      [self addChild:projectilebullet];
        CGPoint MyVector = ccpSub(enemies.position,player.position );
        MyVector = ccpNormalize(MyVector);
        MyVector = ccpMult(MyVector, enemies.contentSize.width/2);
        MyVector = ccpMult(MyVector,-1);
        projectilebullet.position = ccpAdd(enemies.position, MyVector);

}

}

    for(CCSprite *enem2 in enemytwo){
      if(  [proj count] <= 15){
            CCSprite * projectilebull = [CCSprite spriteWithFile:@"Projectile.png"];

            CGPoint MyVector = ccpSub(enem2.position,player.position );
            MyVector = ccpNormalize(MyVector);
            MyVector = ccpMult(MyVector, enem2.contentSize.width/2+10);
            MyVector = ccpMult(MyVector,-1);
            projectilebull.position = ccpAdd(enem2.position, MyVector);

            [self addChild:projectilebull];  
          [proj addObject:projectilebull];
        for(CCSprite *projectile in proj){

        }

       }

    }

    }

-(void)bulletMovement:(CCSprite *)bullet{

CGPoint location = ccpSub(bullet.position, player.position);
location = ccpNormalize(location);
location = ccpMult(location, -1);
bullet.position = ccpAdd(bullet.position, location); 
```

}

碰撞（在敌人2部分）：

```
-(void)update{

    deletehealth = [[NSMutableArray alloc] init];
enemytwodelete  = [[NSMutableArray alloc]init];
enemythreedelete2  = [[NSMutableArray alloc]init];

NSMutableArray *playerdelete = [[NSMutableArray alloc] init];

NSMutableArray * deleteclean = [[NSMutableArray alloc]init ];
projectilesToDelete = [[NSMutableArray alloc] init];
enemydelete  = [[NSMutableArray alloc]init];
     for(CCSprite *projectile in proj)
{

    CGRect project = CGRectMake(projectile.position.x - (projectile.contentSize.width/2), 
                                projectile.position.y - (projectile.contentSize.height/2), 
                                projectile.contentSize.width, 
                                projectile.contentSize.height);

    CGRect playerRect = CGRectMake(player.position.x - (player.contentSize.width/2), 
                                   player.position.y - (player.contentSize.height/2), 
                                   player.contentSize.width, 
                                   player.contentSize.height);

    if (CGRectIntersectsRect(playerRect, project)) {
        [projectilesToDelete addObject: projectile];
        emitter = [[CCParticleExplosion alloc] init];
        emitter.texture = [[CCTextureCache sharedTextureCache]addImage:@"particle.png"];
        emitter.position = ccp(projectile.position.x,projectile
                               .position.y);
        [self addChild:emitter];
        // NSLog(@"%i",life);
        if(life > 0){
            //lifeholder = [[NSMutableArray alloc] init];
            life -= 5;

            [self.progressTimer setPercentage:life];
        }else{
            [playerdelete addObject:player];
            emitter.position = ccp(projectile.position.x,projectile
                                   .position.y);

            [[CCDirector sharedDirector]replaceScene:[CCTransitionFade transitionWithDuration:3 scene:[end node]]];
        }

    }

    for(CCSprite*enemies in enemy){
        CGRect enemyRect = CGRectMake((enemies.position.x-5), 
                                      enemies.position.y-8.3, 
                                      7, 
                                      15);

            if(CGRectIntersectsRect(enemyRect, project)){
                enemyex = [[CCParticleExplosion alloc] init];
               enemyex.texture = [[CCTextureCache sharedTextureCache]addImage:@"particle.png"];
               enemyex.position = ccp(enemies.position.x, enemies.position.y);
               [self addChild:enemyex];
                [enemydelete addObject:enemies];

                    [projectilesToDelete addObject:projectile];

                [self powerups];
                [self clear];

            }
    }   

    for(CCSprite * enemies2 in enemytwo){

    CGRect enemy2Rect = CGRectMake(enemies2 .position.x - (enemies2 .contentSize.width/2),
                                   enemies2 .position.y - (enemies2 .contentSize.height/2),
                                   enemies2 .contentSize.width, 
                                   enemies2.contentSize.height);

        if(CGRectIntersectsRect(enemy2Rect, project)){
           explode = [[CCParticleExplosion alloc] init];
            explode .texture = [[CCTextureCache sharedTextureCache]addImage:@"particle.png"];
            explode .position = ccp(enemies2.position.x, enemies2.position.y);
            [self addChild:explode ];

            [enemytwodelete addObject:enemies2];
            [projectilesToDelete addObject:projectile];
            [self powerups];
            [self clear];

        }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T17:31:12.937

我会创建一个 BOOL 来存储角色是否在移动。每当角色要移动时，将该 BOOL 设置为 YES。由于您使用动作来移动精灵，因此您可以使用一系列动作，第一个动作是移动动作，然后第二个动作是一个将您的 BOOL 设置为 NO 的块。这样，一旦移动动作完成，它就会被存储起来供以后参考。它看起来像这样。

`BOOL isObjectMoving;`将其放在其他地方，可能在您的实体子类或其他任何地方

```
CCMoveTo *move = [CCMoveTo actionWithDuration:0.8 position:ccp(f,s)];
CCCallBlock *end = [CCCallBlock actionWithBlock:^{
     isObjectMoving = NO;
}];

isObjectMoving = YES; //Set it to YES until the movement action finishes and sets it back to NO

[yourObject runAction:[CCSequence actionOne:move actionTwo:end]]; 
```

# svn - 获取每次修订的日志，无论位置如何

> ID：13426926
> 
> 赞同：1
> 
> 时间：2012-11-17T02:01:44.680
> 
> 标签：svn

做类似的事情`svn log -l5 -v`会给我一个我所在目录的最后 5 次提交的日志，但它会跳过一些修订号。无论您执行的位置如何，有没有办法按顺序获取所有修订`svn log`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T02:05:23.403

您需要在存储库的根 URL 上执行此操作，您可以使用`svn info`.

```
svn log -l5 -v <root URL> 
```

# core-data - 在没有编辑模式的情况下修改核心数据中的记录

> ID：13426933
> 
> 赞同：0
> 
> 时间：2012-11-17T02:03:22.513
> 
> 标签：core-data, nsmanagedobject, nsmanagedobjectcontext

我在重新保存核心数据中的记录时遇到了麻烦，我希望有人可以帮助我了解我在这里缺少什么：

当我想保存记录时，我有我的“产品”表格视图，代码如下：

```
- (IBAction)save:(id)sender
{

MyCoreDataClass *productOne = [NSEntityDescription insertNewObjectForEntityForName:@"MyCoreDataClass" inManagedObjectContext:self.managedObjectContext];

productOne.reference = reference.text;
productOne.type = type.text;
productOne.cost = cost.text;

[self.managedObjectContext save:nil];

[self dismissModalViewControllerAnimated:YES];

} 
```

正如您已经了解的那样，我有一个“产品列表”表格视图，所有记录都很好地显示/保存，并且在我的“产品列表”didSelectRowAtIndexPath 方法中我已经这样做了：（我没有使用 segues！）

```
- (void) tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
MyCoreDataClass *produtoSelected = (Lista *)[[self fetchedResultsController] objectAtIndexPath:indexPath];

if ([produtoSelected.reference isEqualToString:@"shirts"]||[produtoSelected.reference isEqualToString:@"pants"] )
{
  Product *example=(Product *)[self.storyboard instantiateViewControllerWithIdentifier:@"ProductId"];
    produto.modalPresentationStyle = UIModalPresentationFormSheet;
    produto.modalTransitionStyle = UIModalTransitionStyleCrossDissolve;
    [self presentModalViewController:example animated:YES];
    produto.view.superview.frame = CGRectMake(0, 0, 350, 510); //do this after presentModalViewController
    example.view.superview.center = self.view.center;
    example.reference.text = produtoSelected.reference;
    example.type.text = produtoSelected.type;
    example.cost.text = produtoSelected.cost;
    example.managedObjectContext = self.managedObjectContext;

    [self.tableView deselectRowAtIndexPath:indexPath animated:YES];  
} 
```

显示之前保存的信息，之后我已经尝试了“self.managedObjectContext refreshObject”并且我知道我的最后一行不正确......我的“产品”表格视图的代表是我的“产品列表”表格视图......我已经看到了用户进入编辑模式的例子，但我只是不希望这样......我只是希望用户在欲望行中按下，修改他想要的内容并点击保存按钮......

我错过了什么，我在这里失去了几个小时......有人可以帮助我吗？

提前感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T10:31:53.037

第一点。以下行不一致：

```
X *object = (Y*) [fetchedResultsController objectAtIndexPath:indexPath]; 
```

`X`应该是您需要的类，`(Y*)`您可以省略，因为应该自动返回正确的对象类型。

第二。保存新实体属性后，有两种显示更改的方法。

1.  您可以简单地调用`[tableView reloadData]`. 如果您在父视图控制器出现之前执行此操作，它甚至看起来并不难看——但这可能是一项昂贵的操作。

2.  更好的是，您实现了`NSFetchedResultsControllerDelegate`提醒视图控制器管理对象发生变化的方法。在那里，您只需更新表格视图的相应行。

# cmake - CMake 动态生成的头文件依赖

> ID：13426934
> 
> 赞同：6
> 
> 时间：2012-11-17T02:03:30.227
> 
> 标签：cmake

我有两个静态库：**libfoo**和**libbar**，每个都在自己的目录中。

**libfoo**包含一个`includes/`包含单个文件的目录`A.h`。它还包含一个`sources/`目录，其中包含`B.gen`. 自定义规则应该创建一个新的头文件`B.h`和一个新的源文件`B.c`。

**libbar**包含一个`includes/`包含单个文件的目录`C.h`。它还包含一个`sources/`目录，其中包含`C.c`. 该文件包括`A.h`和`B.h`来自**libfoo**。

问题是：根据这些规则，我该如何编写两个库的 CMakeFiles.txt （据我了解，棘手的部分是将所有 libfoo 标头放在同一目录中，但也许我有误导性）？

文件层次结构：

```
/
  libfoo/
    includes/
      A.h
    sources/
      A.c
      B.gen
    CMakeLists.txt
  libbar/
    includes/
      C.h
    sources/
      C.c
    CMakeLists.txt 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-26T13:41:55.057

您不应将任何生成的文件复制到源目录。源目录和构建目录之间的分离是有意的，并且称为源外构建，以免在构建过程中使用生成的文件污染源目录。

在这种情况下，您需要做的是：

1.  定义一个自定义命令，使用 add_custom_command 将您的 B.gen 转换为 Bh 文件。这将在 CMAKE_CURRENT_BINARY_DIR 中生成 Bh，它反映了 CMakeLists.txt 相对于项目根 CMakeLists.txt 的源目录。它看起来像这样：

    add_custom_command（输出 Bh 命令 my-gen B.gen Bh DEPENDS B.gen）

2.  使用 include_directories 函数将生成文件的文件夹添加到包含目录。如果所有这些都在一个 CMakeLists.txt 中完成，您可以使用 include_directories(${CMAKE_CURRENT_BINARY_DIR})

CMake 依赖解析器现在将在它想要构建 Cc 时分析其内容并找出构建它所需的 Bh。使用 add_custom_command 您已经告诉它如何创建该标头，它将调用您的生成器。

您应该查看 CMake 中的源代码构建如何工作以正确理解文件夹层次结构。

# c# - 在c#中将0和1的数组转换为int

> ID：13426940
> 
> 赞同：2
> 
> 时间：2012-11-17T02:04:16.073
> 
> 标签：c#

我有以下内容：

```
public int [] PermuteNum(int num)
{
int[] newArray = new int[16];
string strNum = Convert.ToString(num, 2);
int[] bits = strNum.PadLeft(16, '0').Select(c => int.Parse(c.ToString())).ToArray();

for (int i = 0; i < bits.Length; i++)
{

int newBit = P(i);
int NewNum = bits[newBit];
newArray[i] = NewNum;

}

return newArray;
} 
```

如何将这个 1 和 0 数组转换回我的初始**int**？第一个元素是最高有效位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T02:49:57.237

```
int result = 0;
for (int i = 0; i < newArray.Length; i++)
{
    result *= 2;
    result += newArray[i];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T02:08:33.420

您可以使用按位移位操作。这是伪代码，您可以对位移操作进行研究：

```
int accumulator = 0;
  int i = 0;
//this assumes your lowest bit is the first one, reverse order if not
foreach(var bit in bits)
{  
  //when you get to the 3rd bit(i==2), if bit is 1 then it represents 2^2 == 8, 
  //to calculate the value of the bit, isntead of using 2^i power, just shift i places

  //Example: the array 1,0,1 becomes 
  // accumulator +=  2^0 // accumulator now == 1
  // accumulator +=  0^1 // accumulator now == 1
  // accumulator +=  2^2 // accumulator now == 4

  accumulator += (shiftbit by i positions);
  ++i;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T02:15:49.543

也许您可以使用[BitArray并使用](http://msdn.microsoft.com/en-us/library/system.collections.bitarray.aspx)[另一个问题](https://stackoverflow.com/questions/5283180/how-i-can-convert-bitarray-to-single-int)的答案将其排列转换回**int**。

# android - 如何通过 adb shell 查看简单的文本文件？

> ID：13426942
> 
> 赞同：7
> 
> 时间：2012-11-17T02:04:20.453
> 
> 标签：android

如何通过 adb 或 adb shell 查看简单的文本文件？我知道有 ADT 附带的 fileExplorer 但它不是很方便，我每次都拉一个文件，然后打开它，

命令行上有快速的方法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-17T02:14:06.983

`adb shell cat /sdcard/file.txt`

`cat`是在linux中显示文本文件的命令。

*用法：cat [-beflnstv] [-] [文件...]*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-14T07:36:23.167

cat 是用于在 adb 中打开文本文件的命令。

```
cat txtfile 
```

或者

```
cat txtfile.text 
```

# ember.js - Ember：路由器前后挂钩 connectOutlets

> ID：13426943
> 
> 赞同：2
> 
> 时间：2012-11-17T02:04:46.363
> 
> 标签：ember.js, hook, ember-old-router

我想在 Ember 路由器中的每个 connectOutlets 调用之前和之后调用一些函数。我无法在 Ember 文档中找到任何内容。

有什么建议么 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T05:53:37.620

来自“[了解 Ember.js 路由器：入门](http://emberjs.com/guides/router_primer/)”指南：

> 每个 Ember.Route 都会触发一个进入和退出回调。这里是插入日志记录和调试数据的合适位置，该应用程序中已经出现。
> 
> 在路由器中将 enableLogging 属性设置为 true 也有助于显示路由器的决策过程。当浏览器的调试控制台打开时，路由器将打印以 STATEMANAGER 开头的有用错误消息。

您可以按如下方式使用`enter`和回调：`exit`

```
App.Router = Ember.Router.extend({
    enableLogging: true,
    root: Ember.Route.extend({

        gotoHome: Em.Route.transitionTo('root.home'),
        gotoInfo: Em.Route.transitionTo('root.info'),

        index: Ember.Route.extend({
            route: '/',
            redirectsTo: 'home'
        }),
        home: Ember.Route.extend({
            route: '/home',
            connectOutlets: function(router) {
              router.get('applicationController')
                    .connectOutlet("home");
            },
            enter: function(router){
                console.log('The "enter" event of "home" route has been fired');
            },
            exit: function(router) {
                console.log('The "exit" event of "home" route has been fired');
            }
        }),
        info: Ember.Route.extend({
            route: '/info',
            connectOutlets: function(router) {
              router.get('applicationController')
                    .connectOutlet("info");
            },
            enter: function(router){
                console.log('The "enter" event of "info" route has been fired');
            },
            exit: function(router) {
                console.log('The "exit" event of "info" route has been fired');
            }

        })
    })
}); 
```

在浏览器控制台打开的情况下检查[**这个小提琴**](http://jsfiddle.net/schawaska/qAPVP/)，这样你就可以在输入/离开路线时看到日志。

**编辑**：如果您只想根据路线更新当前选定的菜单，则不需要在连接插座之后或之前连接事件，您实际上需要您的“菜单控制器”具有跟踪的属性选定的项目，当您输入给定的路线时，您会更新该控制器。您的“菜单视图”将具有子菜单项，其中包含`classNameBindings`基于控制器中选择的提要（您可以绑定到父视图）。[**这个小提琴**](http://jsfiddle.net/schawaska/hEx84/)已经实现了，所以我不会再写一个了，但是检查一下，看看`NavigationController`, `NavigationView`(and `NavigationItemView`) & 路线。在每个`connectOutlet`我更新控制器中的选定菜单项，如下所示：

`router.set('navigationController.selected', 'MY ROUTE NAME GOES HERE');`

希望这可以帮助

# python - 在变量中包含引号

> ID：13426944
> 
> 赞同：4
> 
> 时间：2012-11-17T02:05:08.983
> 
> 标签：python

我正在用 Python 编写一个非常简单的搜索引擎，并且必须使用 HTML 代码来创建一个带有表格的 HTML 页面。这是我使用的代码：

```
<html>
<title>Search Findings</title>
<body>
<h2><p align=center>Search for "rental car"</h2>
<p align=center>
<table border>
<tr><th>Hit<th>URL</tr>
<tr><td><b>rental car</b> service<td> <a href="http://www.facebook.com">http://www.avis.com</a></tr>
</table>
</body>
</html> 
```

这在 Python 文件之外看起来很好，但我需要用变量 KEYWORD 替换出租汽车。当我尝试将开头的行存储`<h2>`为变量以使用该`.replace`方法时，就会出现问题。由于中间的引号，Python 会检测到语法错误。有没有办法可以将它存储为变量？还是我必须用另一种方法来替换这些词？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T02:08:31.467

使用反斜杠转义它，或使用单引号字符串，或`"""`用于长块：

```
s = '<h2><p align=center>Search for "rental car"</h2>'
s = "<h2><p align=center>Search for \"rental car\"</h2>"
s = """
<p>This is a <em>long</em> block!</p>
<h2><p align=center>Search for "rental car"</h2>
<p>It's got <strong>lots</strong> of lines, and many "variable" quotation marks.</p>
""" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T02:27:15.140

这是 PHP 和 Python 等语言的重要组成部分，单引号字符串和双引号字符串之间的互换性，只要内部引号与外部引号相反。更重要的是 Python，在两者之间切换时，它不会改变转义的工作方式。然而，对于 PHP，单引号字符串不会处理除单引号和反斜杠之外的转义。例子：

```
output = '<h2><p align=center>Search for "' + search + '"</h2>'
output = "<h2><p align=center>Search for \"" + search + "\"</h2>" 
```

长块字符串不适用于连接，您需要使用 .replace()，它比连接更昂贵。

# html - 如何将两个表单并排显示

> ID：13426948
> 
> 赞同：4
> 
> 时间：2012-11-17T02:05:30.097
> 
> 标签：html, css

我对css不是很擅长，但我有以下两种形式：

```
 //below is where it displays course name

        $outputcourse = ""; 
        $outputcourse .= "<p><strong>Course:</strong> " . $course .  " - "  . $coursename . "</p>";

    //below is where it displays module name

    $outputmodule = ""; 
    $outputmodule = sprintf("<p><strong>Module:</strong> %s - %s</p>", $moduleId, $moduleName);

    //below is form where it displays assessments drop down menu

        $assessmentform = "<form action='".htmlentities($_SERVER['PHP_SELF'])."' method='post'>
<p>{$outputcourse}</p>
<p>{$outputmodule}</p>
        <p><strong>Assessments:</strong> {$sessionHTML} </p>   
        </form>";

        echo $assessmentform;

        }

        //below is form where it displays all of the text inputs and submit button

        $editsession = "<form id='updateForm'>

            <p><strong>Current Assessment's Date/Start Time:</strong></p>
            <table>
            <tr>
            <th>Assessment:</th>
            <td><input type='text' id='currentAssessment' name='Assessmentcurrent' readonly='readonly' value='' /> </td>
            </tr>
            <tr>
            <th>Date:</th>
            <td><input type='text' id='currentDate' name='Datecurrent' readonly='readonly' value='' /> </td>
            </tr>
            <tr>
            <th>Start Time:</th>
            <td><input type='text' id='currentTime' name='Timecurrent' readonly='readonly' value=''/> </td>
            </tr>
            </table>
            <div id='currentAlert'></div>

            <p><strong>New Assessment's Date/Start Time:</strong></p>
            <table>
            <tr>
            <th>Assessment:</th>
            <td><input type='text' id='newAssessment' name='Assessmentnew' readonly='readonly' value='' /> </td>
            </tr>
            <tr>
            <th>Date:</th> 
            <td><input type='text' id='newDate' name='Datenew' readonly='readonly' value='' /> </td>
            </tr>
            <tr>
            <th>Start Time:</th> 
            <td><input type='text' id='newTime' name='Timenew' readonly='readonly' value=''/><span class='timepicker_button_trigger'><img src='Images/clock.gif' alt='Choose Time' /></span> </td>
            </tr>
            </table>
            <div id='datetimeAlert'></div>

            </form>

            <p><button id='updateSubmit'>Update Date/Start Time</button></p>

            <div id='targetdiv'></div>
        ";

        echo $editsession; 
```

CSS：

```
form#assessmentForm {
 float: left; 
 border: 1px solid red;
}
form#updateForm {
 float:left;
 clear: right;
 /* with some space to the left of the second form */
 margin-right: 100px; 
}
p#submitupdatebtn {
  clear: both;
} 
```

目前，两种形式都显示在彼此之上。我真正想做的是显示`$editsession`表单，显示`$assessmentform`在右侧表单旁边，两个表单之间有一点空间。

如何做到这一点？我希望它适用于所有主要浏览器。

下面显示了合并在一起的两个屏幕截图，以显示我希望它如何显示：

![在此处输入图像描述](../Images/7ab24bf2a2f292565c346f3948ab1fa4.png)

谢谢

更新：

下面是它现在显示的内容：

![在此处输入图像描述](../Images/fcac2324b2239f2a7010fe03138ecd0f.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-17T02:11:30.207

您只需要[`float: left;`](https://developer.mozilla.org/en-US/docs/CSS/float)表单，建议也`clear: right;`使用第二个表单，这样其他浮动元素就不会出现在它的右侧。最后，`clear: both;`在`<p>`第二种形式之后的那个上，所以没有前面的元素浮动到它的左边或右边。

```
form {
 /* Float both forms to the left */
 float: left; 
 /* borders added for visibility. Just remove them */
 border: 1px solid red;
}
form#updateForm {
 clear: right;
 /* with some space to the left of the second form */
 margin-right: 20px; 
}
/* Give an id to the <p> which follows the second form and clear: both */
p#submit {
  clear: both;
} 
```

在你的标记中，给`<p>`跟在第二种形式后面的 id 一个 id，这样它就可以很容易地在 CSS 中定位

```
<p id='submit'><button id='updateSubmit'>Update Date/Start Time</button></p> 
```

然后将其移动*到*前面的`<form>`标签内，因为它是该表单的一部分。

[这是一个演示](http://jsfiddle.net/masku/5/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T02:11:43.733

使用浮动

你只需要将它添加到你的第一个表单标签中，

然后第二个跳到第一个表单的右侧

# windows-runtime - 是否存在用于搜索 Windows 8 应用更新的 API

> ID：13426949
> 
> 赞同：1
> 
> 时间：2012-11-17T02:05:37.880
> 
> 标签：windows-runtime, windows-update, windows-store

[Microsft 通过Windows Update Agent API](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387287%28v=vs.85%29.aspx)提供与 Windows Update 接口的API 。它们还提供了一个 API，用于通过[Windows.Management.Deployment 命名空间](http://msdn.microsoft.com/en-us/library/windows/apps/br240983.aspx)管理安装、更新和卸载应用程序包。

更新应用程序需要您拥有更新的 URI，不幸的是，我无法弄清楚如何以编程方式搜索 Windows 应用商店更新，而不是通过应用商店应用程序搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T14:43:41.807

多亏了这篇[博文——使用 Windows 应用商店搜索更新，](http://p0w3rsh3ll.wordpress.com/2012/11/08/search-updates-using-the-windows-store/)我找到了解决方案。

# javascript - ForeignObject 文本未出现

> ID：13426951
> 
> 赞同：1
> 
> 时间：2012-11-17T02:06:04.467
> 
> 标签：javascript, d3.js

我使用 ForeignObject 订单来包装一些文本。由于某种明显的原因，它根本没有出现在画布上。我可能遗漏了一些东西，但我看不到它是什么。任何帮助将不胜感激 ：）

```
 var blah = { "Lets see how long this goes on for!!!": "translate(-150,20)"

        };

var dah = [ {name:"Lets see how long this goes on for!!!"} ]; 

var fo = svg.append("svg:foreignObject")
         .data(dah)
         .enter()
         .attr("width", 80)
         .attr("height", 200)
         .attr("transform", function(d,i) {return blah[d.name];})

fo.append("xhtml:chart")
  .html(function(d) {d.name;})
  .style("font", "bold 12px Arial")

 ; 
```

编辑：http: [//jsfiddle.net/xwZjN/44/](http://jsfiddle.net/xwZjN/44/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T07:08:22.660

当你这样做时

```
var fo = svg.append("svg:foreignObject")
            .data(dah)
            .enter()
            .attr("width", 80) 
```

口译员抱怨

```
Uncaught TypeError: Object  has no method 'attr' 
```

因为该`attr`方法对转换和**选择**进行操作。在使用它之前，有必要输入一个选择。将您的代码修改为以下内容并将文本附加到`foreignObject`using`text`方法。

```
var fo = svg.selectAll("foreignObject")
            .data(dah)
            .enter()
            .append("svg:foreignObject")
            .attr("width", 80)
            .attr("height", 200)
            .text(function(d) { return d.t; }); 
```

更新的 JS：http: [//jsfiddle.net/jaimem/xwZjN/46/](http://jsfiddle.net/jaimem/xwZjN/46/)

此外，您可能只想使用一个数据对象，而不是这个

```
var blah = { "Network": "translate(-150,20)"};
var dah = [ {t:"Network"}]; 
```

做这样的事情

```
var someData = [ 
    { text:"Network", translate:"translate(-150,20)"},
    { text:"Test", translate:"translate(-115,-75)"}
]; 
```

并像这样对数据进行操作

```
.attr("transform", function(d,i) {return d.translate; })
.text(function(d) { return d.text; }); 
```

当然，您可能还想以`foreignObject`编程方式计算元素的转换。

# linux - 如果我在 Linux 上使用原始套接字，内核会丢弃带有错误 TCP 校验和的传入数据包吗？

> ID：13426957
> 
> 赞同：1
> 
> 时间：2012-11-17T02:07:35.407
> 
> 标签：linux, networking, tcp, raw-sockets

现在我正在编写一个使用原始 TCP 套接字的程序。如果有任何 TCP 校验和错误的传入数据包，内核会将它们传递给程序还是丢弃它们？我想知道的原因是弄清楚我是否需​​要手动进行检查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T02:28:58.680

由于您自己编写 TCP（使用“IP”套接字/层）必须处理 TCP 校验和。下面的任何层或任何校验和都将由底层操作系统处理。

使用您拥有的 TCP/IP 堆栈（从下到上顺序）

关联

Internet <- Socket Here 此处和下方的任何内容都将被处理。本质上，您是在说我正在编写自己的传输协议，而它恰好是 TCP。

传输 <- TCP 这里

应用

# android - 通用图像加载器 Android：更改布局属性会导致 OutOfMemoryError

> ID：13426959
> 
> 赞同：2
> 
> 时间：2012-11-17T02:07:44.727
> 
> 标签：android, android-layout, universal-image-loader

我有多项活动。每个活动都在 GridView 中显示图像。作为独立应用程序的每个活动都可以正常工作。当我从另一个活动中调用活动时，就会出现问题。GridView（第二个/第三个活动）的一项是 imageView ：

```
 <ImageView
        android:id="@+id/grid_sub_item_image"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:adjustViewBounds="true"
        android:contentDescription="@string/descr_image"
        android:scaleType="centerCrop" >
    </ImageView> 
```

当我在 dp/px 中设置宽度、高度时效果很好。像：

```
android:layout_width="100dp"
            android:layout_height="100dp" 
```

对我来说很好。

但是当我设置高度/宽度时：wrap_content/fill_parent，它会出现内存不足异常：

```
null
java.lang.OutOfMemoryError
android.graphics.BitmapFactory.nativeDecodeStream(Native Method)
android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:493)
com.nostra13.universalimageloader.core.ImageDecoder.decode(ImageDecoder.java:83)
com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.decodeWithOOMHandling(LoadAndDisplayImageTask.java:187)
com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.decodeImage(LoadAndDisplayImageTask.java:170)
com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.tryLoadBitmap(LoadAndDisplayImageTask.java:126)
com.nostra13.universalimageloader.core.LoadAndDisplayImageTask.run(LoadAndDisplayImageTask.java:72)
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:442)
java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
java.util.concurrent.FutureTask.run(FutureTask.java:137)
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
java.lang.Thread.run(Thread.java:856) 
```

我在每个活动中都实例化了 ImageLoader。但这无济于事。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T19:39:47.417

[有用信息部分](https://github.com/nostra13/Android-Universal-Image-Loader#useful-info)描述了 UIL 如何缩小原始图像以及用于它的参数。

所以我建议你为你的 ImageView 设置`android:maxWidth`和`android:maxHeight`参数以节省内存。

# html - iframe 之后的网址

> ID：13426962
> 
> 赞同：0
> 
> 时间：2012-11-17T02:08:39.093
> 
> 标签：html, iframe

我想在我的 HTML 页面中有一个文本框，还有一个`iframe`. 当用户在文本框中输入 URL 并单击提交时，`iframe`导航到该页面。当用户单击 中的链接`iframe`时，文本框中的 URL 也会更改为新 URL。是否可以？

注意：`iframe`欢迎不使用的解决方案，但它们应该实现与`iframe`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:30:03.883

给你的文本框一个 id 例如“txtInput”给你的 iframe 一个 id 例如按钮上的“myIframe”给它没有导航所以它停留在当前页面上并使用 onclick="myFunction()"

在函数中你可以使用它（如果这有点错误，请原谅我已经有一段时间了，因为我使用了 HTML

```
 function myFunction()
    {
        var iframe = document.getElementById("myIframe");
        var input = document.getElementById("txtInput").text;

//check to see if there is a valid url in the text box be carefull if there are multiple links in the text box it will put them all in and the iframe will go to 127.0.0.1 or search engine due to incorrect URL
        var isURL=new RegExp(/(((f|ht)(tp|tps):\/\/)[\w\d\S]+)/,g);

        iframe.src = input.match(isURL);
    } 
```

如果您不想弄乱常规表达式，则可以简单地使用以下内容。

```
function myFunction()
{
    var iframe = document.getElementById("myIframe");
    var input = document.getElementById("txtInput").text;

    iframe.src = isURL;
} 
```

# c# - 如何获取对 WebService 请求使用自定义代理的 C# WebService 调用的结果？

> ID：13426963
> 
> 赞同：1
> 
> 时间：2012-11-17T02:09:09.693
> 
> 标签：c#, xml, web-services, xml-serialization, codedom

我正在尝试将 WebService 调用的结果读取/转换/解析为字符串。

```
 WebMethod method = list.Services[0].Methods[0] as WebMethod;

    if(method != null) 
    {
                Object ResultsObj;
                ResultsObj = new Object();
                ResultsObj = method.Invoke();

                //Returns "WS.GeocodeResponse" needs to be inner values
                results = ResultsObj.ToString();

                //Like to do the following but get error: 
                   //'object' does not contain a definition for 'Results' and no extension
                     // method 'Results' accepting a first argument of type 'object' could be
                     // found (are you missing a using directive or an assembly reference?)
               results = ResultsObj.Results[0].ToString();

                //Or, do something like this but get same error
                results = String.Format("Latitude: {0}, Longitude: {1}",
                    ResultsObj.Results[0].Locations[0].Latitude,
                    ResultsObj.Results[0].Locations[0].Longitude);

                //Tried casting as an XmlDocument but get runtime error:
                //{"Unable to cast object of type 'WS.GeocodeResponse' to type 'System.Xml.XmlDocument'."}
                    XmlDocument doc = new XmlDocument();
                    doc = (XmlDocument) method.Invoke();
                    results = "do something with doc";

               //Tried looping through array of results but get error:
               // The type or namespace name 'WS' could not be found (are you missing a using directive or an assembly reference?)

               foreach(WS.GeocodeResult result in ResultsObj.GetType().Name)
                 {
                     continue;
                 }

              //Tried reverse engineering what Visual Studio does when create Web Reference
                //thanks to clue at http://www.west-wind.com/presentations/dotnetwebservices/DotNetWebServices.asp 
                        // “That's because the proxy object is actually compiled into the project 
                        //(take a look at \CodeClient\Web References\CodeWebService\CodeWebService.cs 
                        // to see the source for this 'phantom' object that VS generates for you and compiles into your application.”
                //Mine was "Project Name"/Web References/"Webservice Name"/Reference.cs  
                //I.E. ( LatLonVerification/Web References/net.virtualearth.dev/Reference.cs)
                // Renamed it and added "using LatLonVerification.VirtualEarthGeo;" reference to it in this class;
                //then finally tried to cast it to the new object type but got runtime error:
                //{"Unable to cast object of type 'WS.GeocodeResponse' to type 'LatLonVerification.VirtualEarthGeo.GeocodeResponse'."}  System.Exception {System.InvalidCastException}

               GeocodeResponse geocodeResponse = (GeocodeResponse) ResultsObj;
               results = "parse or do something with geocodeResponse"; 
```

背景：

我需要更新我们创建的一个 LatLongVerification dll，以便通过 com 从 MS Access 调用 Web 服务。直到几个月前它还在工作。

但是，Bing Web 服务发生了变化，我们的 IT 部门也发生了变化。防火墙变了。因此，在使用 Web References 方法更新 Web 服务后，一切正常，当不在公司网络上但不在公司网络上时。SoapUI 测试工具也躲在防火墙后面。但是，Open Source Wizdl C# .net 工具确实在防火墙后面工作。

因此，这开始了对 Wizdl 工具 (http://wizdl.codeplex.com/ ) 进行逆向工程以作为 dll 而不是 Windows 窗体应用程序的目标。我认为各种各样的 Access 和 Excel 人也会喜欢。

当然，为了让它工作，我硬编码了几个方面（稍后会修复）。到目前为止，即使在网络上，我也已成功地将数据从 Bing Web 服务返回到对象！然而，我似乎无法进行最终转换或解析或转换，以便我可以将 dll 中的数据作为字符串输出。我是如此接近，因为我可以在本地调试器窗口中看到结果，但是到目前为止它们是不可返回的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T13:46:51.427

不确定这是否相关，但是当面对我无法直接开发的安全 Web 服务时，我使用了 fiddler。

首先捕获 wsdl 文件（我认为是另一个），将它们保存为文本文件。然后，当 Visual Studio 在开发机器上的服务更新期间请求它们时，“服务”它们备份。

[http://www.fiddler2.com](http://www.fiddler2.com)

# php - HTTP 错误 405.0 - 当我尝试将表单发布到数据库时不允许使用该方法

> ID：13426965
> 
> 赞同：2
> 
> 时间：2012-11-17T02:09:13.017
> 
> 标签：php, html

我正在尝试将表单发布到 mysql 数据库中。我使用的是 Windows 8 和 iis 8，但是当我尝试发布表单时出现此错误*“您正在查找的页面无法显示，因为正在使用无效的方法（HTTP 动词）。”*

我的html代码：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>odev3</title>
</head>
<body>
<form align="middle" action="insert.php" method="post">
Ad : <input type="text" name="ad" style="margin-left:60px" required/><br>
Soyad : <input type="text" name="soyad" style="margin-left:40px" required/><br>
Kullanıcı Adı : <input type="text" name="kullaniciadi" required/><br>
Şifre : <input type="text" name="sifre" style="margin-left:52px" required/><br>
<input type="reset" value="Temizle"/>
<input type="submit" value="Kaydol"/>
</form>
</body>
</html> 
```

和我的php代码：

```
 <?php 
    $host="localhost";
    $user="root";
    $pass="123";

    mysql_connect($host,$user,$pass);

    mysql_select_db("odev3"); 

    $sql="INSERT INTO kisi(ad,soyad,kullaniciadi,sifre) VALUES ('$_POST[ad]','$_POST[soyad]','$_POST[kullaniciadi]','$_POST[sifre]')";

    $result = mysql_query($sql);
    if($result)
    {
      echo("<br> Veri eklendi.");
    }
    else
    {
      echo("<br> Veri eklenemedi.");
    }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T02:30:32.420

# c++ - Qt Creator 中的 C++11 IDE 支持？

> ID：13426966
> 
> 赞同：3
> 
> 时间：2012-11-17T02:09:15.417
> 
> 标签：c++, qt, c++11, qt-creator

> **可能重复：**
> [QT Creator，c++11 的语法检查](https://stackoverflow.com/questions/9560156/qt-creator-syntax-checking-for-c11)

有没有办法让 C++11 自动完成在 Qt creator 中工作？我在我的文件中添加了以下两行`.pro`，但自动完成仍然不起作用（尽管代码确实编译正确）。

```
QMAKE_CXXFLAGS += "-std=c++11"
CXXFLAGS="-std=c++0x" 
```

下面是我正在编写的一些代码。它可以正确构建和运行。但是当我输入`std::`并按下自动完成键时，`std::unique_ptr`不会出现在完成列表中。

```
#include <iostream>
#include <memory>

int main()
{
    std::unique_ptr<int> i(new int);
    *i = 1237;

    std::cout << *i << std::endl;
    return 0;
} 
```

此外，语法完成似乎不适用于 C++11。这是我截取的截图。 [http://i.imgur.com/EoikO.png](https://i.imgur.com/EoikO.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T02:14:20.803

Qt Creator 还不完全支持 C++11 语法。它支持一些东西，但不是所有东西。此外，模板也有问题。不过，每个新版本都会变得更好，而且还有一些工作正在进行中以从当前的解析系统切换到 LLVM/Clang。

在配置方面您无能为力。您唯一能做的就是确保使用最新版本（现在是 2.6.0。）

# c++ - 从二维数组复制（行）到一维数组

> ID：13426968
> 
> 赞同：2
> 
> 时间：2012-11-17T02:09:28.943
> 
> 标签：c++, multidimensional-array

所以我有一个二维数组 multiarray[a][b] 和另一个数组 buf[b]。

我无法将“buf”指定为等于多数组的行之一。执行此操作的确切语法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T02:13:50.237

```
// a 2-D array of char
char multiarray[2][5] = { 0 };
// a 1-D array of char, with matching dimension
char buf[5];
// set the contents of buf equal to the contents of the first row of multiarray.
memcpy(buf, multiarray[0], sizeof(buf)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T02:14:43.420

数组不可赋值。对此没有核心语言语法。C++ 中的数组复制是在库级别或用户代码级别实现的。

如果这应该是 C++ 并且您确实需要创建2D 数组某行的单独*副本* ，那么您可以使用`buf``i``mutiarray``std::copy`

```
#include <algorithm>
...

SomeType multiarray[a][b], buf[b];
...
std::copy(multiarray[i], multiarray[i] + b, buf); 
```

或在 C++11 中

```
std::copy_n(multiarray[i], b, buf); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T03:04:42.957

I read the code has similar function in snort (old version), it is borrowed from tcpdump, maybe helpful to you.

```
/****************************************************************************
 *
 * Function: copy_argv(u_char **)
 *
 * Purpose: Copies a 2D array (like argv) into a flat string.  Stolen from
 *          TCPDump.
 *
 * Arguments: argv => 2D array to flatten
 *
 * Returns: Pointer to the flat string
 *
 ****************************************************************************/
char *copy_argv(char **argv)
{
  char **p;
  u_int len = 0;
  char *buf;
  char *src, *dst;
  void ftlerr(char *, ...);

  p = argv;
  if (*p == 0) return 0;

  while (*p)
    len += strlen(*p++) + 1;

  buf = (char *) malloc (len);
  if(buf == NULL)
  {
     fprintf(stderr, "malloc() failed: %s\n", strerror(errno));
     exit(0);
  }
  p = argv;
  dst = buf;
  while ((src = *p++) != NULL)
  {
      while ((*dst++ = *src++) != '\0');
      dst[-1] = ' ';
  }
  dst[-1] = '\0';

  return buf; 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-29T13:05:44.740

如果您使用向量：

```
vector<vector<int> > int2D;
vector<int> int1D; 
```

您可以简单地使用向量的内置赋值运算符：

```
int1D = int2D[A];//Will copy the array at index 'A' 
```

如果您使用的是 c 风格的数组，一种原始方法是将所选行中的每个元素复制到一维数组中：

例子：

```
//Assuming int2D is a 2-Dimensional array of size greater than 2.
//Assuming int1D is a 1-Dimensional array of size equal to or greater than a row in int2D.

int a = 2;//Assuming row 2 was the selected row to be copied.

for(unsigned int b = 0; b < sizeof(int2D[a])/sizeof(int); ++b){
    int1D[b] = int2D[a][b];//Will copy a single integer value.
} 
```

语法是规则，算法是您可能的意思/想要的。

# json - JqG rid 未从 PHP 加载 JSON 格式的数据

> ID：13426974
> 
> 赞同：0
> 
> 时间：2012-11-17T02:09:57.100
> 
> 标签：json, jqgrid

有人可以帮助我并指出我哪里出错了。感谢你的帮助。网格显示空白并且没有加载任何内容。

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
    <script type="text/javascript" src="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.1.1/js/i18n/grid.locale-en.js"></script>

<script type="text/javascript">
        $.jgrid.no_legacy_api = true;
        $.jgrid.useJSON = true;
</script>

<script type="text/javascript" src="http://www.ok-soft-gmbh.com/jqGrid/jquery.jqGrid-4.1.1/js/jquery.jqGrid.src.js"></script>

<script type="text/javascript">

jQuery(document).ready(function(){ 

jQuery("#list2").jqGrid({
    url:'http://localhost/jqgrid/book.php',
    datatype: "json",
    colNames:['Title', 'Author', 'Publisher'],
    colModel:[
        {name:'title' , width:160},
        {name:'author' ,width:180},
        {name:'publisher' ,width:80}
    ],
    rowNum:10,
    rowList:[10,20,30],
    pager: '#pager2',
    sortname: 'title',
    sortorder: "desc",
    height: 'auto',
    width: 900,
    viewrecords: true,
    gridview: true,
    caption:"JSON Example",
    jsonReader : {
        repeatitems: true,
        cell: "cell",
        id:"id",
        userdata: "userdata",
        root: "rows",
        page: "page",
        total: "total",
        records: "records"
       }  
});

jQuery("#list2").jqGrid('navGrid','#pager2',{edit:false,add:true,del:true});

});

</script>

</head>

<body>

     <table id="list2"><tr><td></td></tr></table>
     <div id="pager2"></div>

</body>
</html> 
```

这是我来自 PHP 的 JSON 响应：

{"page":"1","total":1,"records":"2","rows":[{"id":"2","cell":["PHP QUERY","JSON" ,"VTECH"]},{"id":"1","cell":["JQUERY Cook book","MY AUTHOR","GRID"]}]}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T11:11:05.613

您发布的代码通常是正确的。[您可以在演示](http://www.ok-soft-gmbh.com/jqGrid/user1831178.htm)中看到这一点。

问题的原因可能是例如使用**绝对 URL 路径** `url:'http://localhost/jqgrid/book.php'`而不是*相对*like`url:'book.php'`或`url:'/jqgrid/book.php'`. 另一个可能的原因可能是`Content-Type`JSON 响应的 HTTP 标头中的值错误。我建议您永远不要在 Ajax 请求中使用绝对 URL，因为由于[相同的源策略](http://en.wikipedia.org/wiki/Same_origin_policy)，您只能使用来自*同一 Web 服务器*的 URL 。所以最好总是使用*相对*URL。

# ruby-on-rails - 如何清除死载波条目的应用程序？

> ID：13426982
> 
> 赞同：0
> 
> 时间：2012-11-17T02:10:46.490
> 
> 标签：ruby-on-rails, ruby-on-rails-3, carrierwave

在我的应用程序中，有许多带有载波上传器的条目，其中上传的文件已经消失。我想在*rake*任务中解决这个问题，但我无法将这些上传者设置为**nil**或删除它们。一个典型的会话如下：

```
[43] pry(main)> article
=> #<Product id: 80, name: "Barcelona", ambient_picture: "ambient.jpg", special: false, slug: "barcelona", image: "image.jpg">
[44] pry(main)> article.remove_ambient_picture!
=> nil
[45] pry(main)> article
=> #<Product id: 80, name: "Barcelona", special: false, slug: "barcelona", image: "image.jpg">
[46] pry(main)> article.save
   (0.2ms)  BEGIN
   (0.1ms)  COMMIT
=> true 
```

等等令人作呕——似乎没有任何帮助。引用 remove 方法似乎更像是其他回调的集线器，因此它可能仅在文件实际存在时才有效。

那么在这种情况下我该怎么办呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T15:21:19.127

所以现在我求助于这个：

```
 unless article.ambient_picture?
      p "Removing #{article.ambient_picture}"
      sql = ActiveRecord::Base.connection()
      sql.update "UPDATE articles SET ambient_picture=null WHERE id=#{article.id}"
    end 
```

我知道这并不理想，所以出于好奇，我仍然欢迎提出建议，如何以更明智的方式处理。

# coldfusion - 500 - SQL Server 错误的内部服务器错误

> ID：13426984
> 
> 赞同：4
> 
> 时间：2012-11-17T02:11:00.700
> 
> 标签：coldfusion

我有一个新的 VPS 帐户，而在此之前我一直在共享服务器上运行我的网站。

我选中了“启用强大的异常信息”，并选中了“启用请求调试输出”。

我收到 500 - 内部服务器错误，这不是很有帮助。

我可以在 application.log 中看到以下错误：

> 执行数据库查询时出错。[Macromedia][SQLServer JDBC 驱动程序][SQLServer]在 SET 子句中多次指定了列名“AttachmentDesc”。

所以我看到了错误，但如果页面显示错误而不是我必须在 application.log 中找到它会更好。

问：我是否缺少其他设置来帮助在页面本身上显示错误？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-19T10:24:27.457

看起来 IIS 正在向您隐藏错误。在 IIS 的“错误页面”下，选择 500 错误并单击“编辑功能设置”并选择“详细错误”——您现在应该会看到完整的错误信息（前提是在 n CF 上进行调试）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T18:43:24.960

您可以通过进入 ColdFusion 管理员并启用“启用鲁棒异常信息”选项来启用调试。在 CF10 中，您可以在“调试输出设置”的“调试和日志记录”部分下找到此选项。

这是 CF 8 [http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Debug_02.html](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Debug_02.html)和 CF 9 [http://help.adobe.com/en_US/ColdFusion/的链接9.0/Admin/WSc3ff6d0ea77859461172e0811cbf3638e6-7fe0.html](http://help.adobe.com/en_US/ColdFusion/9.0/Admin/WSc3ff6d0ea77859461172e0811cbf3638e6-7fe0.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T16:58:00.387

IIS 可能会向您隐藏错误（请参阅 azawaza 的回答）。您可以在 ColdFusion 层停止此操作，方法是禁用 ColdFusion 管理员 -> 设置 -> “启用 HTTP 状态代码”。然后即使是错误页面也会给出成功的代码 200，并且 IIS 不会替换输出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-30T13:12:40.603

我有一个类似的问题（500 错误而不是详细调试），但在共享主机上。环境

```
<httpErrors errorMode="Detailed" /> 
```

在**web.config**中完成了这项工作。

# javascript - 动态添加元素时，JQuery fadeToggle 奇怪的副作用

> ID：13426993
> 
> 赞同：1
> 
> 时间：2012-11-17T02:12:03.427
> 
> 标签：javascript, jquery, html

fadeToggle 在静态 HTML 元素上工作正常： HTML：

```
<div id="wrapper" style="
position: relative;
display: inline-block;
width: 116px;
height: 116px;
background: url('http://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Example.jpg/116px-Example.jpg') no-repeat;
">
<img id="cover" src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/70/Example.png/116px-Example.png" />
</div> 
```

查询：

```
$("#wrapper").click(function() {
    $("#cover").fadeToggle("slow");
}); 
```

[http://jsfiddle.net/BishKopt/zFq5P/1/](http://jsfiddle.net/BishKopt/zFq5P/1/)

但是当我尝试用 JQuery 添加包装器时......

HTML：

```
<img id="cover" src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/70/Example.png/116px-Example.png" /> 
```

查询：

```
$wrapper = $('<div></div>');
$wrapper.attr('id', 'mywrapper');
$wrapper.css({
    position: "relative",
    display: "inline-block",
    width: $("#cover").width(),
    height: $("#cover").height(),
    background: "url('http://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Example.jpg/116px-Example.jpg') no-repeat"
});
$("#cover").wrap($wrapper);

$("#mywrapper").click(function() {
    $("#cover").fadeToggle("slow");
}); 
```

[http://jsfiddle.net/BishKopt/kazKF/1/](http://jsfiddle.net/BishKopt/kazKF/1/)

...在第二次切换（第二次单击）之后 - img html 元素被“选中”...您有什么想法可以避免它吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T01:13:38.190

我已经设法用一种“黑客”来解决它......

```
$("#cover").after($('<a style="display: hidden; position: absolute;" id="hack"></a>'));

$("#mywrapper").click(function() {
    $("#cover").fadeToggle("slow");
    $("#hack").blur();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T03:09:50.557

如果“选择”是指文本选择，请执行以下操作：

CSS：

```
#mywrapper{
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -o-user-select: none;
    user-select: none;
} 
```

但是，如果您的意思是您的浏览器在 div 周围添加了不需要的边框，请执行以下操作：

CSS：

```
#mywrapper{
    outline:none;
} 
```

# algorithm - 在二叉搜索树中插入 n 个序列的摊销成本是多少？

> ID：13426994
> 
> 赞同：3
> 
> 时间：2012-11-17T02:12:06.597
> 
> 标签：algorithm, binary-search-tree, amortized-analysis

如何计算二叉搜索树中**n个**插入序列的摊销成本？输入序列是随机的，每次插入都会增加一个节点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T02:43:20.290

我们希望能够分析单个操作的时间并在一系列操作中对其进行平均。我们可以遵循摊销分析技术。

**定义 1**

假设我们有一个支持某些操作的数据结构。让`T (n)`是在此数据结构上执行任何`n`此类操作序列的最坏情况时间。然后每个操作的摊销时间定义为`T(n)/n.`（[来源](http://people.scs.carleton.ca/~michiel/lecturenotes/amortized.pdf)）

因为，您有一个二叉搜索树，这意味着在最坏的情况下，您将拥有一个链表（左侧的所有元素或右侧的所有元素）。

如果你有`n`插入操作`T(n) = 1+2+...n = (n * (n-1)) / 2 = (n^2 - n) / 2.`

根据定义 1 每次操作的摊销时间 = (n - 1) / 2\. O(n)

也许我解释错了，所以如果你这么认为，请发表评论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T02:43:44.053

通常，您可以期望为随机插入序列生成一个大致平衡的二叉树，这意味着平均节点高度与 log(n) 成正比（参见[维基百科](http://en.wikipedia.org/wiki/Random_binary_tree)的解释）。摊销时间=总时间/操作次数。总时间等于平均高度 * 元素数，或 O(n * log(n))。由于总时间为 O(n * log(n))，因此摊销时间为 O(log(n))。

# java - Java GUI 在表单加载时绘制和填充矩形

> ID：13426995
> 
> 赞同：1
> 
> 时间：2012-11-17T02:12:09.083
> 
> 标签：java, user-interface, drawing

我有滑块可以创建 RGB 值，然后使用它来创建一个框并填充其颜色。当我初始化我的程序时，它不会立即绘制正方形。它会绘制正方形并在移动滑块后开始填充它。

在构造函数期间调用了用于绘制矩形并用颜色填充它的方法，但没有做任何事情，没有错误，只是没有绘制正方形。滑块在状态更改时调用 SAME 方法，然后将绘制正方形。这没有道理。

我相信这是其他人在缺乏某些基础时可能会遇到的事情。

这是我的代码，您可以复制粘贴并在 jGrasp 或其他任何内容中运行以了解我的意思。谢谢！

```
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.Rectangle;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class Colors extends javax.swing.JFrame {

    public Colors() {
        initComponents();
        addSliderListeners();
        addSliderLabels();
        this.setTitle("Color Mixer");
        sliderRed.setValue(150);
        sliderGreen.setValue(125);
        sliderBlue.setValue(215);
        updateImage();
    }

    private void addSliderListeners(){
        sliderRed.addChangeListener(new ChangeListener() {
            public void stateChanged(ChangeEvent e) {
                updateImage();
            }
        });
        sliderGreen.addChangeListener(new ChangeListener() {
            public void stateChanged(ChangeEvent e) {
                updateImage();
            }
        });
        sliderBlue.addChangeListener(new ChangeListener() {
            public void stateChanged(ChangeEvent e) {
                updateImage();
            }
        });
    }

    private void updateImage(){
        lblRedDec.setText(""+sliderRed.getValue());
        lblRedDec.setForeground(new Color(sliderRed.getValue(),0,0));
        lblRedHex.setText(Integer.toHexString(sliderRed.getValue()));
        lblRedHex.setForeground(lblRedDec.getForeground());

        lblGreenDec.setText(""+sliderGreen.getValue());
        lblGreenDec.setForeground(new Color(0,sliderGreen.getValue(),0));
        lblGreenHex.setText(Integer.toHexString(sliderGreen.getValue()));
        lblGreenHex.setForeground(lblGreenDec.getForeground());

        lblBlueDec.setText(""+sliderBlue.getValue());
        lblBlueHex.setText(Integer.toHexString(sliderBlue.getValue()));
        lblBlueDec.setForeground(new Color(0,0,sliderBlue.getValue()));
        lblBlueHex.setForeground(lblBlueDec.getForeground());

        Graphics2D g2 = (Graphics2D)this.getGraphics();
        g2.setColor(new Color(sliderRed.getValue(),sliderGreen.getValue(),sliderBlue.getValue()));
        g2.fill(new Rectangle(25,125,250,250));
    }

    private void addSliderLabels() {
        sliderRed.setPaintLabels(true);
        sliderGreen.setPaintLabels(true);
        sliderBlue.setPaintLabels(true);
    }
/**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">                          
    private void initComponents() {

        sliderRed = new javax.swing.JSlider();
        lblRed = new javax.swing.JLabel();
        lblRedHex = new javax.swing.JLabel();
        lblRedDec = new javax.swing.JLabel();
        sliderGreen = new javax.swing.JSlider();
        lblGreen = new javax.swing.JLabel();
        lblGreenHex = new javax.swing.JLabel();
        lblGreenDec = new javax.swing.JLabel();
        sliderBlue = new javax.swing.JSlider();
        lblBlue = new javax.swing.JLabel();
        lblBlueHex = new javax.swing.JLabel();
        lblBlueDec = new javax.swing.JLabel();
        lblTitle = new java.awt.Label();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setResizable(false);

        sliderRed.setMajorTickSpacing(15);
        sliderRed.setMaximum(255);
        sliderRed.setMinorTickSpacing(5);
        sliderRed.setOrientation(javax.swing.JSlider.VERTICAL);
        sliderRed.setPaintTicks(true);
        sliderRed.setValue(212);
        sliderRed.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        sliderRed.setName(""); // NOI18N

        lblRed.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblRed.setText("Red");

        lblRedHex.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblRedHex.setText("hex");

        lblRedDec.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblRedDec.setText("dec");

        sliderGreen.setMajorTickSpacing(15);
        sliderGreen.setMaximum(255);
        sliderGreen.setMinorTickSpacing(5);
        sliderGreen.setOrientation(javax.swing.JSlider.VERTICAL);
        sliderGreen.setPaintTicks(true);
        sliderGreen.setSnapToTicks(true);
        sliderGreen.setValue(35);
        sliderGreen.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        sliderGreen.setName(""); // NOI18N

        lblGreen.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblGreen.setText("Green");

        lblGreenHex.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblGreenHex.setText("hex");

        lblGreenDec.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblGreenDec.setText("dec");

        sliderBlue.setMajorTickSpacing(15);
        sliderBlue.setMaximum(255);
        sliderBlue.setMinorTickSpacing(5);
        sliderBlue.setOrientation(javax.swing.JSlider.VERTICAL);
        sliderBlue.setPaintTicks(true);
        sliderBlue.setSnapToTicks(true);
        sliderBlue.setValue(218);
        sliderBlue.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        sliderBlue.setName(""); // NOI18N

        lblBlue.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        lblBlue.setText("Blue");

        lblBlueHex.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblBlueHex.setText("hex");

        lblBlueDec.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblBlueDec.setText("dec");

        lblTitle.setFont(new java.awt.Font("Dialog", 0, 36)); // NOI18N
        lblTitle.setText("Color Mixer");

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(lblTitle, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 125, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(27, 27, 27)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblRedHex)
                            .addComponent(lblRed)
                            .addComponent(lblRedDec))
                        .addGap(25, 25, 25))
                    .addComponent(sliderRed, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(sliderGreen, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblGreenHex)
                            .addComponent(lblGreen)
                            .addComponent(lblGreenDec))
                        .addGap(25, 25, 25)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(sliderBlue, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblBlueHex)
                            .addComponent(lblBlue)
                            .addComponent(lblBlueDec))
                        .addGap(25, 25, 25))))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(23, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                        .addGroup(layout.createSequentialGroup()
                            .addComponent(lblBlueDec)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(lblBlueHex)
                            .addGap(18, 18, 18)
                            .addComponent(lblBlue)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(sliderBlue, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(layout.createSequentialGroup()
                            .addComponent(lblGreenDec)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(lblGreenHex)
                            .addGap(18, 18, 18)
                            .addComponent(lblGreen)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(sliderGreen, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(layout.createSequentialGroup()
                            .addComponent(lblRedDec)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(lblRedHex)
                            .addGap(16, 16, 16)
                            .addComponent(lblRed)
                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                            .addComponent(sliderRed, javax.swing.GroupLayout.PREFERRED_SIZE, 285, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addComponent(lblTitle, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(38, 38, 38))
        );

        lblTitle.getAccessibleContext().setAccessibleName("");
        lblTitle.getAccessibleContext().setAccessibleDescription("");

        pack();
    }// </editor-fold>                        

    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(Colors.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(Colors.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(Colors.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(Colors.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new Colors().setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify                     
    private javax.swing.JLabel lblBlue;
    private javax.swing.JLabel lblBlueDec;
    private javax.swing.JLabel lblBlueHex;
    private javax.swing.JLabel lblGreen;
    private javax.swing.JLabel lblGreenDec;
    private javax.swing.JLabel lblGreenHex;
    private javax.swing.JLabel lblRed;
    private javax.swing.JLabel lblRedDec;
    private javax.swing.JLabel lblRedHex;
    private java.awt.Label lblTitle;
    private javax.swing.JSlider sliderBlue;
    private javax.swing.JSlider sliderGreen;
    private javax.swing.JSlider sliderRed;
    // End of variables declaration                   

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T02:47:44.183

颜色方块最初没有显示的原因是因为它`GroupLayout`会导致重新绘制其所有子组件，从而有效地“绘制”方块。

要让您的广场出现，您可以：

*   制作一个自定义`JComponent`颜色方块并添加到`GroupLayout`.
*   将所有当前组件提取到一个新组件`JComponent`并覆盖该`paintComponent`方法，以便`GroupLayout`首先绘制所有组件。此选项将允许您不将颜色方块添加到`GroupLayout`.

代码：

```
@Override
public void paintComponent(Graphics g) {
    super.paintComponent(g);
    updateImage();
} 
```

# c# - DataGridView 覆盖绘画以设置字体

> ID：13426996
> 
> 赞同：0
> 
> 时间：2012-11-17T02:12:26.383
> 
> 标签：c#, datagridview, fonts, styles

我试图以编程方式更改`DataGridViews`“单元格标题”字体样式 Col 标题必须是大写，我想分配一个新字体。如果有人在此之前完成了此操作，我将在此感谢您的指导。

## 更新

实际上字体更改工作正常，只是`headerText.ToUpper()`我需要帮助

```
private void dataGridView1_Painting(object sender, DataGridViewCellPaintingEventArgs e)
{
            //Something like this.
           foreach(DataGridViewColumnCollection c in grd.Columns) {
               c.ColHeading.Text = c.ColHeading.Text.ToUpper(); 
           }

            //or
            //header row only
            if (e.RowIndex == -1)
            { 
                e.CellStyle.Font = new Font("Verdana", 11.0f);
                e.CellStyle.ForeColor = Color.Gray;
                e.Value = e.Value.ToUpper(); //fails as its a read only object
            }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T02:21:38.253

不熟悉这个控件，但是浏览其他事件。可能没有足够早地进行此更改，并且在“更早”的事件中运气更好。

行或列本身可能存在事件，您应该连接以完成此操作。

根据评论 IEnumerable 的解决方案：

```
dataGridView1_ColumnAdded(object sender, DataGridViewColumnEventArgs e) { e.Column.HeaderText = e.Column.HeaderText.ToUpper(); } 
```

# php - 使用 $_GET 获取时未插入 VARCHAR 值

> ID：13426998
> 
> 赞同：1
> 
> 时间：2012-11-17T02:12:31.597
> 
> 标签：php, mysql

我有一个 Mysql 表，`checkboxsaved`. 它有一个名为`checked`type的列`varchar(45)`。

此列的可能值为`Check1`、`Check2`等。

接下来，我使用 jQuery 发送请求并将值作为 GET 变量传递。例如：

```
"http://xyz?checkbox=" + checkbox  // checkbox = Check1 
```

我使用`$checkbox = $_GET['checkbox']`PHP 检索它，然后触发查询：

```
$rv = mysql_query("insert into checkboxsaved (checked) values ('$checkbox')"); 
```

该值不会被插入。奇怪的是，当我在前面添加空格或其他字符时，例如

```
$rv = mysql_query("insert into checkboxsaved (checked) values (' $checkbox')"); // space
$rv = mysql_query("insert into checkboxsaved (checked) values ('r$checkbox')"); 
```

然后该值确实被插入。谁能告诉我为什么会这样？据我说，当列是`varchar`我应该能够插入类似`Check1`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T02:17:42.927

我希望你做一些卫生。您应该`mysql_real_escape_string()`在所有用户输入的值上运行。此外，在您的情况下，您还可以对值运行正则表达式以使其匹配`/^Check[0-9]+$/`.

如果这不能解决您的问题（并且可能没有），您的脚本可能没有像您认为的那样接收数据。

IE。

```
$checkbox = mysql_real_escape_string($_GET['checkbox']);
$sql = "insert into checkboxsaved (checked) values ('$checkbox');";
//echo $sql; // uncomment this to debug
$rv = mysql_query($sql); 
```