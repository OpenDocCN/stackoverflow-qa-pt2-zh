# StackOverflow 问答 14678000-14678999

# wpf - 在 WPF 中创建大量用户控件？

> ID：14678002
> 
> 赞同：1
> 
> 时间：2013-02-03T22:21:15.880
> 
> 标签：wpf, user-controls, separation-of-concerns

在 WPF 应用程序中创建大量用户控件以分离关注点是否正常，否则这些关注点会塞在具有巨大 XAML 层次结构的单个窗口中？我发现我一直在制作新的用户控件，即使我不打算重用它们，只是为了让我的每个子组件都有一个单独的任务。我还给他们每个人自己的视图模型，而不是将事物绑定到一个主视图模型上的属性。

这是正常的吗？从代码清洁度的角度来看，我觉得我在做正确的事情。但从WPF的角度来看，我觉得这不可能。

例如，假设您在窗口左侧有一个列表，当您选择一个项目时，它会更改右侧显示的内容。列表上方还有一些按钮来操作它，例如添加和删除项目。我倾向于将整个列表作为 UserControl 拉出，它只包含列表和其上方的控制按钮。然后主窗口将只包含我的新控件。

我是不是太过分了？

# java - 使用 Android 在线存储/检索应用程序数据

> ID：14678004
> 
> 赞同：0
> 
> 时间：2013-02-03T22:21:21.500
> 
> 标签：java, android, database

我是 Java 和 Android 的新手。我刚刚开始开发一个应用程序，它将信息保存到服务器上，同一公司内的其他人可以使用来自不同安卓设备的相同应用程序检索该信息。我知道如何使用简单的 php 脚本将数据简单地存储在服务器上，但这有点复杂，涉及一个用户将信息写入服务器，而另一个用户可以查看/下载它。在一家公司内，会有多个用户可以访问这些数据。所以我的问题是，实施只有同一公司的成员才能访问的公司范围数据库的最佳方法是什么？对不起，如果这对你们中的一些人来说很明显。我才刚刚开始，我有 7 本书关于 android 编程，但没有一本描述了如何去做我想做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T12:35:12.687

为此，您需要使用 Android**网络服务**来访问数据。换句话说，要**检索**网络数据库信息，您的设备将使用指定的 URL 和参数连接到您的服务。反过来，服务将回复所需的数据，比如可能是 XML 格式。您的应用程序需要做的就是解析 XMl 并根据需要显示日期。

同样的事情也适用于**将**数据放入服务器，但是在这种情况下，数据将作为参数发送到网络服务 URL，并且服务将处理数据库的持久性。

我的建议是对关键字“Android 网络服务”进行谷歌搜索。

# c - Valgrind cannot locate stack allocation for uninitialised data

> ID：14678006
> 
> 赞同：2
> 
> 时间：2013-02-03T22:21:41.177
> 
> 标签：c, linux, file-io, valgrind

I have a a single error when I run my program through valgrind. The problem is that it wont tell me where the uninitialised bytes were allocated:

```
==22141== Syscall param write(buf) points to uninitialised byte(s)
==22141==    at 0x5B68900: __write_nocancel (syscall-template.S:82)
==22141==    by 0x5AFB882: _IO_file_write@@GLIBC_2.2.5 (fileops.c:1289)
==22141==    by 0x5AFB749: new_do_write (fileops.c:543)
==22141==    by 0x5AFCEB4: _IO_do_write@@GLIBC_2.2.5 (fileops.c:516)
==22141==    by 0x5AFDD3E: _IO_switch_to_get_mode (genops.c:189)
==22141==    by 0x5AFBA96: _IO_file_seekoff@@GLIBC_2.2.5 (fileops.c:999)
==22141==    by 0x5AF4F25: rewind (rewind.c:37)
==22141==    by 0x567D149: CBFileAppend (CBFileEC.c:69)
==22141==    by 0x5473AFA: CBDatabaseCreateDeletionIndex (CBDatabase.c:270)
==22141==    by 0x5473195: CBInitDatabase (CBDatabase.c:112)
==22141==    by 0x54721A1: CBNewAddressStorage (CBAddressStorage.c:37)
==22141==    by 0x401F67: main (testCBAddressManager.c:226)
==22141==  Address 0x402a009 is not stack'd, malloc'd or (recently) free'd
==22141==  Uninitialised value was created by a stack allocation
==22141==    at 0x546F750: ??? (in /media/sf_BitEagle_Projects/cbitcoin/bin/libcbitcoin-storage.2.0.so) 
```

Would I be correct in assuming this means some sort of invalid pointer to the stack? This happens in rewind() and I do not understand why rewind would be like this. I tried attaching the valgrind process to gdb and I tried to print the result of the ftell() on the file pointer. This caused valgrind to exit with this:

```
valgrind: m_syswrap/syswrap-main.c:1296 (vgPlain_client_syscall): Assertion 'sci->status.what == SsIdle' failed.
==22938==    at 0x3804CA36: ??? (in /usr/lib/valgrind/memcheck-amd64-linux)
==22938==    by 0x3804CBDC: ??? (in /usr/lib/valgrind/memcheck-amd64-linux)
==22938==    by 0x38091F55: ??? (in /usr/lib/valgrind/memcheck-amd64-linux)
==22938==    by 0x3808E5DF: ??? (in /usr/lib/valgrind/memcheck-amd64-linux)
==22938==    by 0x3808F739: ??? (in /usr/lib/valgrind/memcheck-amd64-linux)
==22938==    by 0x3809F7D5: ??? (in /usr/lib/valgrind/memcheck-amd64-linux)

sched status:
  running_tid=1

Thread 1: status = VgTs_Runnable
==22938==    at 0x5B68900: __write_nocancel (syscall-template.S:82)
==22938==    by 0x5AFB882: _IO_file_write@@GLIBC_2.2.5 (fileops.c:1289)
==22938==    by 0x5AFB749: new_do_write (fileops.c:543)
==22938==    by 0x5AFCEB4: _IO_do_write@@GLIBC_2.2.5 (fileops.c:516)
==22938==    by 0x5AFDD3E: _IO_switch_to_get_mode (genops.c:189)
==22938==    by 0x5AFBA96: _IO_file_seekoff@@GLIBC_2.2.5 (fileops.c:999)
==22938==    by 0x5AF1AA5: ftell (ioftell.c:41)
==22938==    by 0x40133F: ??? (in /media/sf_BitEagle_Projects/cbitcoin/bin/testCBAddressManager)
==22938==    by 0xF75E467: ???
==22938==    by 0x7FEFFF3BF: ???
==22938==    by 0xF75E467: ???
==22938==    by 0x546DE87: ??? (in /media/sf_BitEagle_Projects/cbitcoin/bin/libcbitcoin-storage.2.0.so)
==22938==    by 0x7FEFFF3DF: ??? 
```

How would I go about determining the cause of this error?

Edit: I fixed the other issue I was having but this persists.

This is from the code here: [https://github.com/MatthewLM/cbitcoin/blob/master/test/testCBAddressManager.c](https://github.com/MatthewLM/cbitcoin/blob/master/test/testCBAddressManager.c)

The file IO code is here: [https://github.com/MatthewLM/cbitcoin/tree/master/dependencies/storage](https://github.com/MatthewLM/cbitcoin/tree/master/dependencies/storage)

Thank you.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T04:21:54.470

> Syscall param write(buf) points to uninitialised byte(s)

There isn't necessarily anything wrong with that. Consider:

```
int main() {
  struct Foo { int a; int b; int c; } x;
  x.a = 1; x.c = 3;
  write(1, &x, sizeof(x));  // part of x is not initialized
  return 0;
} 
```

If later you read the data back in, and only use `.a` and `.c` members, then your program is well defined.

> Would I be correct in assuming this means some sort of invalid pointer to the stack?

No.

If you really wanted to find out *which* part of data is uninitialized, use Valgrind'd [built-in gdbserver](http://valgrind.org/docs/manual/manual-core-adv.html#manual-core-adv.gdbserver), and issue `monitor check_memory defined` [command](http://valgrind.org/docs/manual/mc-manual.html#mc-manual.monitor-commands).

# ios - 在 cocos2d 上调用 my 方法

> ID：14678007
> 
> 赞同：0
> 
> 时间：2013-02-03T22:21:53.870
> 
> 标签：ios, xcode, cocos2d-iphone, call, schedule

我有一个方法可以在屏幕上绘制一个带有动画效果的精灵，如果我在 init 中调用这个方法

```
if( (self=[super init]) ) {
// ....
[self myMethod];
// .....
} 
```

然后他在我的项目上做了一次

当我按计划打电话时

```
-(void)schedulMyMethod:(ccTime)dt {
    [self myMethod];
}

if( (self=[super init]) ) {
// ....
[self schedule:@selector(schedulMyMethod:) interval:0.5];
// .....
} 
```

它运行无限次

我需要这样我才能调用我的方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:41:54.717

你的意思是，你想让它重复N次？您需要保持其运行剩余时间的状态。

```
@property (nonatomic, assign) NSInteger timesToRunMyMethod;

- (void)beginRunningMyMethod {

    self.timesToRunMyMethod = 100;   // N==100
    [self myMethod];
}

- (void)myMethod {

    self.timesToRunMyMethod--;
    // do stuff
    if (self.timesToRunMyMethod > 0) {
        // i used native delayed execution, you can replace it with whatever cocos2d offers if you want
        [self performSelector:@selector(myMethod) withObject:nil afterDelay:0.5];
    }
} 
```

在 init 上启动它可能是错误的。它是视图控制器吗？然后你可以使用 viewDidAppear 或 willAppear。

# c# - DateTime.AddYear、AddMonth、AddDay、AddHour、AddMinute 不加？

> ID：14678010
> 
> 赞同：0
> 
> 时间：2013-02-03T22:21:59.387
> 
> 标签：c#, datetime

我有以下代码：

```
DateTime endTime = new DateTime(01, 01, 01, 00, 00, 00);

endTime = endTime.AddYears(currentYear - 1);
endTime = endTime.AddMonths(currentMonth - 1);
endTime = endTime.AddDays(currentDay - 1);

hourToWaitTo = Convert.ToInt32(txtboxHourToWaitTo.Text);
minuteToWaitTo = Convert.ToInt32(txtboxMinuteToWaitTo.Text);

endTime = endTime.AddHours(hourToWaitTo);
endTime = endTime.AddMinutes(minuteToWaitTo); 
```

但它不会向 endTime 添加任何内容

**编辑1：**

我像这样设置 currentYear、currentMonth 和 currentDay：

```
int currentYear = Convert.ToInt32(DateTime.Now.ToString("yyyy"));  
int currentMonth = Convert.ToInt32(DateTime.Now.ToString("MM")); 
int currentDay = Convert.ToInt32(DateTime.Now.ToString("dd")); 
```

hourToWaitTo 和 minuteToWaitTo 由用户在文本框中设置。

我希望用户设置计算机关闭的时间（例如 12:25），并且我还想要倒计时来说明距离关闭还有多少小时：分钟：秒。我已经设法做到了所有这些，但我无法解决上面提到的 endTime 问题。

**解决方案：**

这个问题的解决方法很简单：

```
DateTime endTime = new DateTime(currentYear, currentMonth, currentDay, hourToWaitTo, minuteToWaitTo, 0); 
```

我之前尝试过这样做，但由于某种原因，我遇到了错误。要设置上面的这些变量，我使用了：

```
int currentYear = Convert.ToInt32(DateTime.Now.ToString("yyyy"));  
int currentMonth = Convert.ToInt32(DateTime.Now.ToString("MM")); 
int currentDay = Convert.ToInt32(DateTime.Now.ToString("dd")); 
```

和

```
int minuteToWaitTo = Convert.ToInt32(txtboxMinuteToWaitTo.Text);
int hourToWaitTo = Convert.ToInt32(txtboxHourToWaitTo.Text); 
```

感谢大家的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:31:18.137

这不是您问题的直接答案-您发布的代码看起来不错，所以肯定有其他事情发生-但我想知道为什么您不只是做类似的事情：

```
hourToWaitTo = Convert.ToInt32(txtboxHourToWaitTo.Text);
minuteToWaitTo = Convert.ToInt32(txtboxMinuteToWaitTo.Text);

DateTime endTime = new DateTime(currentYear, currentMonth, currentDay, hourToWaitTo, minuteToWaitTo, 0); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T19:54:15.410

应该废除这样的代码：

```
int currentYear = Convert.ToInt32(DateTime.Now.ToString("yyyy"));  
int currentMonth = Convert.ToInt32(DateTime.Now.ToString("MM")); 
int currentDay = Convert.ToInt32(DateTime.Now.ToString("dd")); 
```

您正在检查系统时钟三次，提取部分值，序列化为字符串，解析该字符串，然后使用每个部分。很多工作都白费。

您真正需要的是：

```
DateTime endTime = DateTime.Today.AddHours(hourToWaitTo)
                                 .AddMinutes(minuteToWaitTo); 
```

您应该考虑您正在使用的日期类型。当您使用构造函数构造 DateTime 时`.Kind`，`Unspecified`除非您明确告诉它您想要什么样的日期，否则您会得到一个。在您的场景中，使用本地日期更合适，您将使用`DateTime.Today`or获得该日期`DateTime.Now`。

另请注意，由于您要求用户输入当地时间，但允许他们输入时间组件，因此该时间可能无效或不明确。这发生在夏令时转换期间。`TimeZoneInfo.Local.IsInvalidTime()`您可以使用或验证用户输入`TimeZoneInfo.Local.IsAmbiguousTime()`。在时间不明确的情况下，您需要询问您的用户“在夏令时转换之前还是之后？” 或类似的东西。

最后，如果用户有可能与所讨论的计算机不在同一时区，那么您还有很多工作要做。您应该考虑`DateTimeOffset`改用，并且您将需要捕获关闭的预期偏移量或时区。另一种方法是将时间转换为关闭事件的 UTC 时间。 [查看本文](https://stackoverflow.com/q/2532729/634824)了解更多详细信息和最佳实践。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:28:06.513

```
 new DateTime(year,month,day,hour,minute,0) 
```

?

# asp.net - MVC3 @Model 在布局中变为空

> ID：14678012
> 
> 赞同：0
> 
> 时间：2013-02-03T22:22:03.327
> 
> 标签：asp.net, asp.net-mvc-3, layout, model, null

所以我在创建的 MVC3 布局中发生了一些奇怪的事情。它是 BaseVM 的强类型。每个 View 模型都继承自 BaseVM。当我调试并单步执行代码并单步执行我的布局时，BaseVM 模型不为空，它调用一个方法来获取页脚中版权的当前年份。但是，一旦我走到布局的底部，它就会在我调用属性以获取年份的地方抛出异常，突然模型为空。现在这不会导致应用程序显示错误屏幕或消息，但每次加载页面时都会记录此异常。这是一个代码示例：

```
public class BaseVM
{
    public string CurrentYear
    {
        get
        {
            return DateTime.Today.Year.ToString();
        }
    }

    public BaseVM()
    {
    }
}

public class PrelaunchReserveVM : BaseVM
{
    public PrelaunchDTO Prelaunch { get; set; }

    public PrelaunchReserveVM()
        : this(new PrelaunchDTO()) { }

    public PrelaunchReserveVM(PrelaunchDTO prelaunch)
        : base()
    {
        this.Prelaunch = prelaunch;
    }
} 
```

控制器中的动作：

```
public ActionResult Reserve()
{
    return View("Reserve", new PrelaunchReserveVM(new PrelaunchDTO()));
} 
```

布局：

```
@model StickyThink.Models.VM.BaseVM 
```

...

```
<div id="container">
    <div id="main" role="main" style="padding: 0px; margin: 0px;">
        @RenderBody()
    </div>
</div>

<footer>
    <div id="FooterPageContainer" class="center">
        Copyright &copy @Model.CurrentYear ...  All rights reserved.
    </div>
</footer>
<!-- END: Add your site or application content here -->
@Html.Partial("_Scripts")
@RenderSection("scripts", false); 
```

所以它进入@Model.CurrentYear 并且模型不为空。然后它降级到@RenderSection（从视图中渲染一些脚本），然后抛出异常并且@Model 为空。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:25:19.890

您需要将 Model 作为第二个参数传递给`@Html.Partial("_Scripts", Model)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:16:45.170

如果我不得不大胆猜测，我认为 _Scripts 部分的内容有问题。也许它需要模型@krillgar，但我猜不会。我建议将 _Scripts 部分移动到 NOT 部分，并像往常一样引用标题中的脚本。我怀疑这个异常会更早地出现并帮助您找到问题，而模型变为空的原因是因为异常的类型。因此，如果您移动 _Scripts 部分并更早地设置为 null，您就知道这是要查看的地方。

# .htaccess - htaccess 使重写条件页面特定

> ID：14678014
> 
> 赞同：0
> 
> 时间：2013-02-03T22:22:06.510
> 
> 标签：.htaccess

我的 htaccess 中有以下内容，适用于名为投资组合的页面：

```
RewriteCond %{QUERY_STRING} ^_escaped_fragment_=([^&]*)
RewriteRule .* http://%{HTTP_HOST}/portfolio#!%1? [R=301,L,NE] 
```

但是，我现在需要保留它并为另一个名为 PrivateGallery 的页面生成相同的重写。

我怎样才能在没有两者冲突的情况下做到这一点，有没有办法以不同的方式编写第一个条件行，例如它是特定于页面的，然后第二次复制它以相应地更改页面名称？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:35:22.220

经过无数次的实验，我终于找到了我想要的东西。我用这个实现了它：

```
RewriteCond %{QUERY_STRING} ^_escaped_fragment_=([^&]*)
RewriteRule .* %{REQUEST_URI}#!%1? [R=301,L,NE] 
```

因此，我的两个包含转义片段的页面都将重写为它们的 hashbang 代表 URL，而没有一个页面也重定向到另一个页面。

这主要是为了让 Facebook 为一个项目解析这些 URL，我需要像 button/fb 评论来表示文档中的单独图像 URL。

# svn - 如何在netbeans中禁用颠覆

> ID：14678015
> 
> 赞同：8
> 
> 时间：2013-02-03T22:22:15.923
> 
> 标签：svn, netbeans-7

我在 Windows 上使用 NetBeans 7.0.1，我遇到以下问题：我的项目在 SVN 下进行版本控制，但我使用的是外部 SVN 工具，因为我真的不喜欢 netbeans 中的内置 subversion 客户端，它是对我来说马车和混乱。

现在我正在尝试重命名我的项目中的文件，但它失败并出现 SVN 错误

```
Subversion failed to move X:\***.html to: X:\***a.html
org.tigris.subversion.javahl.ClientException: svn: Cannot write to 'X:\***\.svn\tmp\text-base\indexa.html.svn-base': X:\***\.svn\tmp\text-base\indexa.html.svn-base (The system cannot find the file specified) 
```

有什么方法可以完全禁用 NetBeans 中的颠覆支持？我不使用它，我不想要它。

我用谷歌搜索了一下，发现卸载 subversion 插件会有所帮助，但在这个版本的 NetBeans 中，subversion 支持可能是内置的，我在已安装的插件中​​看不到它，也找不到任何禁用它的设置。我还怀疑 NetBeans 颠覆了我的存储库，即使我的常规客户端现在也抛出错误。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-03T22:52:38.000

> 在这个版本的 NetBeans 中，subversion 支持可能是内置的，我在已安装的插件中​​看不到它，也找不到任何禁用它的设置。

`Tools`-`Plugins`在`Installed`选项卡标记“显示详细信息”复选框中，选择 Subversion 并点击`Deactivate`或`Uninstall`按钮。该插件将被停用/删除，系统将提示您重新启动 IDE

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-12T11:59:19.643

这是停用特定于 SVN 项目的另一种解决方案：

**将项目文件夹添加到未版本化文件夹列表中**：配置文件：~/.netbeans/VERSION/config/Preferences/org/netbeans/modules/versioning.properties

添加一行：unversionedFolders=FULL_PATH_TO_PROJECT_FOLDER

IDE 重新启动后，该项目不应再被视为版本化

[资源](http://forums.netbeans.org/post-42506.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-11T20:16:59.120

NetBeans 提供了在选项菜单下断开特定文件夹与版本控制的能力。这允许您对某些项目使用内置支持并在其他项目中禁用支持。请注意，您只能选择已经由 SVN 管理的文件夹。

[![在此处输入图像描述](../Images/2ba9f6f39f1bf431d7bb06ca517f095c.png)](https://i.stack.imgur.com/9RrCZ.png)

[这可能会更改与@Satya Prakash 的答案](https://stackoverflow.com/a/19333938/4252741)相同的文件，但要通过 GUI。

# django - 使用 django_model_comments 的 WSGIRequest 错误

> ID：14678016
> 
> 赞同：3
> 
> 时间：2013-02-03T22:22:20.593
> 
> 标签：django, django-templates, django-comments

很抱歉发布与该错误相关的另一个问题：

> **'WSGIRequest' 对象没有属性 'find'**

但我真的无法在任何地方找到答案。

我正在尝试使用[django_model_comments](https://github.com/twig/django_model_comments)应用程序，它扩展了 django 包含的评论应用程序。做了页面告诉的所有事情，但是在运行服务器时，我得到以下信息：

```
Environment:

Request Method: GET
Request URL: http://localhost:8000/feed/1

Django Version: 1.4.3
Python Version: 2.7.2
Installed Applications:
['django.contrib.admin',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.sites',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'model_comments',
 'django.contrib.comments',
 'pinax_theme_bootstrap_account',
 'pinax_theme_bootstrap',
 'django_forms_bootstrap',
 'account',
 'metron',
 'user_app',
 'feed_app']
Installed Middleware:
['django.middleware.common.CommonMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware']

Template error:
In template D:\Docs\Work\repo\project\feed_app\templates\feed.html, error at line 10
   'WSGIRequest' object has no attribute 'find'
  1 : {% load model_comment_tags %}
  2 : {% get_comment_form for feed as post_form %}             
  3 : {% render_comment_form post_form %}

Traceback:
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\core\handlers\base.py" in get_response
  111\.                         response = callback(request, *callback_args, **callback_kwargs)
File "D:\Docs\Work\repo\project\feed_app\views.py" in get_user_feed
  37\.                     'feed': private_feed})
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\base.py" in render
  140\.             return self._render(context)
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\base.py" in _render
  134\.         return self.nodelist.render(context)
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\base.py" in render
  823\.                 bit = self.render_node(node, context)
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\debug.py" in render_node
  74\.             return node.render(context)
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\defaulttags.py" in render
  281\.                 return nodelist.render(context)
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\base.py" in render
  823\.                 bit = self.render_node(node, context)
File "D:\Docs\Work\repo\so_virtual_env\lib\site-packages\django\template\debug.py" in render_node
  74\.             return node.render(context)
File "D:\Docs\Work\repo\project\model_comments\templatetags\model_comment_tags.py" in render
  26\.         return self.func(context)
File "D:\Docs\Work\repo\project\model_comments\templatetags\model_comment_tags.py" in wrap
  75\.         form.set_request(request)
File "D:\Docs\Work\repo\project\model_comments\forms.py" in set_request
  106\.             self.fields['from_url'].initial = unicode(Url(request))
File "D:\Docs\Work\repo\project\model_comments\url_util.py" in __init__
  11\.         self.scheme, self.netloc, self.path, self.params, self.query_string, self.fragment = urlparse.urlparse(url)
File "C:\Python27\Lib\urlparse.py" in urlparse
  134\.     tuple = urlsplit(url, scheme, allow_fragments)
File "C:\Python27\Lib\urlparse.py" in urlsplit
  173\.     i = url.find(':')

Exception Type: AttributeError at /feed/1
Exception Value: 'WSGIRequest' object has no attribute 'find' 
```

使用模板标签时会发生错误：

```
html = "{% load model_comment_tags %} \
        {% get_comment_form for feed as post_form %}\
        {% render_comment_form post_form %}"
t = template.Template(html)
html = t.render(RequestContext(request, {'feed': private_feed})) 
```

我检查了我所有的中间件，应用程序的顺序，删除了 .pyc 文件，并在模板中进行了各种实验。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-10T04:57:43.570

django_model_comments 库中有一个错误，因为它们在[这里](https://github.com/twig/django_model_comments/blob/master/forms.py#L106)传递 HttpRequest 对象，而不是 Url 类所期望的字符串[，](http://twigstechtips.blogspot.com/2011/02/python-simple-query-string-manipulation.html)因此它应该调用`build_absolute_uri()`请求对象上的方法，然后将字符串传递给 Url 类。

所以基本上替换

```
unicode(Url(request)) 
```

和

```
unicode(Url(request.build_absolute_uri())) 
```

# c - EPOLLIN 并在没有 EPOLLOUT 的情况下发送

> ID：14678018
> 
> 赞同：0
> 
> 时间：2013-02-03T22:22:32.730
> 
> 标签：c, linux, epoll

在您的帮助和阅读其他资源之后，我已经能够成功使用 epoll，我现在面临的问题是我需要发送到与 EPOLLOUT 事件返回不同的 FD，所以如果我有 5 个 FD，那么我需要发送到 1，然后发送到 4，然后返回到 1，然后发送到 5，依此类推。

以下伪代码是我现在拥有的 IN 和 OUT 事件，

```
 while(1) {

 rval = epoll_wait();

    for (i = 0; i < rval; i++) { 
     if (events & EPOLLOUT) {
        //send to the ready FD for sending
      }
     if (events & EPOLLIN) {
        //Receive from ready fd, this part is perfect for my application 
      }
    }
} 
```

我需要做的是如下

```
char buff[100];
fd = read_data(buff); // read data ready to send, the return value is the FD the application should send the returned data to 

send(fd, buff, 100, 0); 
```

然后我需要 EPOLLIN 从任何 FD 接收数据，因为我将一直从所有 fd 接收数据，我不知道该怎么做，你能帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:26:06.553

您应该在每个可以发送的 FD 周围添加一层包装：让它有一些“准备好”的状态和一个本地数据队列。现在制作一个接受数据的接口。如果状态不是“就绪”，则立即将数据排入队列并返回。否则尝试发送数据（在循环中），如果您点击 EAGAIN 或 EWOULDBLOCK，则将其余数据排入队列并将“就绪”设置为 false。

同时，在你的主事件循环中，每当你得到一个 EPOLLOUT 时，进入一个`send`循环来排空队列，如果你没有错误地完成，则将“准备好”设置为 true。（根据这个逻辑，EPOLLOUT 应该只在您的 FD 未“准备好”时触发，假设您处于边沿触发模式。）

# asp.net - styleSheetTheme 属性被忽略

> ID：14678021
> 
> 赞同：2
> 
> 时间：2013-02-03T22:22:58.433
> 
> 标签：asp.net, web-config, authorization, stylesheet

我正在开发一个 ASP .Net 网站。
我创建了 2 个 ASPX 页面和 1 个母版页。
我的 2 个 ASPX 页面是与母版页关联的内容页面。
我的 2 个 ASPX 页面是：MainMenu.aspx 和 Authentication.aspx。
Authentication.aspx 是我的登录页面。

我为我的网站创建了一个主题。
我的主题由一个 CSS 文件组成。
我在 web.config 文件中添加了以下元素以自动导入我的 CSS 文件：

```
<pages styleSheetTheme="Default" /> 
```

我的 CSS 文件已正确导入，直到我在 web.config 文件中配置授权，如下所示：

```
<configuration>
    <system.web>

        ...

        <pages styleSheetTheme="Default" />

        <authentication mode="Forms">
          <forms loginUrl="~/Authentication.aspx" defaultUrl="~/MainMenu.aspx">
          </forms>
        </authentication>

        <authorization>
          <deny users="?" />
        </authorization>
    </system.web>

  <location path="~/Authentication.aspx">
    <system.web>
      <authorization>
        <allow users="?" />
      </authorization>
    </system.web>
  </location>
</configuration> 
```

我的授权配置的目的是：

*   允许任何用户访问我的登录页面 - Authentication.aspx
*   只允许经过身份验证的用户访问我的登录页面以外的页面

如果我注释了身份验证、授权和位置元素，那么我的 CSS 文件将再次正确导入。

我的授权配置有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T11:11:52.977

有人向我解释了我的问题的原因：

1.  加载身份验证页面时向服务器发送了一个请求。
2.  该请求针对 CSS 文件。
3.  但 CSS 文件位于仅限未经身份验证的用户使用的文件夹中。

因此请求失败。

我是如何解决我的问题的：

*   我已将所有受限文件放入一个公共文件夹中。
*   我在文件夹中创建了一个 web.config 文件，只允许经过身份验证的用户访问。
*   我已经从我的网站根 web.config 文件中删除了授权和位置元素。

# matlab - 八度大数据集，不显示（）或正确写入

> ID：14678022
> 
> 赞同：2
> 
> 时间：2013-02-03T22:23:16.123
> 
> 标签：matlab, octave

我有一个正在缓存的庞大数据集，然后将过滤后的分析数据写入磁盘。我的代码中有各种`disp()`命令以及`fprintf()`调用。

我想在进程运行时在文件和屏幕上查看结果，但我发现在终止程序之前我什么也得不到，此时所有数据都写入我的文件和`disp()`洪水终端。

是否有办法在处理它们时强制`disp()`执行`fprintf()`？

这是一个例子：

```
function one(varargin)
    setenv GNUTERM 'x11';

    dirname = strcat(pwd, '/fileset');
    files = dir(dirname);
    disp('reading directory'), disp(dirname);
    fileidx = find(~[files.isdir]);
    out = fopen('write_data.txt', 'w');
    fprintf(out, '"--- var a[0]", "--- var [1]";\n');

    numfiles = length(fileidx);
    for i = 1:numfiles
        dispstring = sprintf('processing file %d of %d...', i, numfiles);
        disp(dispstring);
        filename = [dirname, '/', files(fileidx(i)).name];
        disp(filename);
        fid = fopen(filename, 'r');

        %some processing here to obtain timevalues and maxvars

        for i = 1:length(timevalues)
            fprintf(out, '%d, %d;\n', timevalues(i), maxvars(i));
        end 
    end 

    fclose(out);
end 
```

我看到了[这篇文章](https://stackoverflow.com/questions/2633019/how-can-i-flush-the-output-of-disp-in-matlab-or-octave)，但我不确定建议的哪些方法适用于我。这似乎`fflush()`也是为了将数据推入更高优先级的情节中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T06:45:48.957

我以前遇到过这个问题，你用 fflush 来解决它。写

```
fflush(stdout); 
```

强制终端使用调用 fflush(stdout) 之前的所有打印和显示到标准输出的结果进行更新。我不确定您是否应该费心将输出刷新到文件，因为它可能会使您的代码变慢，但如果您愿意，您可以这样做

```
fflush(out); 
```

# javascript - 使用 jquery 加载元素时是否可能发出警报？

> ID：14678024
> 
> 赞同：0
> 
> 时间：2013-02-03T22:23:37.303
> 
> 标签：javascript, html, jquery

这是我正在使用的示例，我试图在使用 jquery .load 将元素加载到页面时发出警报，但似乎无法正确处理，有什么建议吗？这可能吗？

[http://jsfiddle.net/ZhsBR/2/](http://jsfiddle.net/ZhsBR/2/)

html:

```
<div id="nav1">click to load content</div>
<div id="target"></div> 
```

js：

```
$("#nav1").click(function() {
    $('#target').load('http://fiddle.jshell.net/user/login/ #content > *');
});

$("#pageContainer").ready(function() {
    alert("dynamic content has been loaded");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:24:28.720

它称为回调，您必须在`load()`函数中提供一个。

```
$('#target').load('http://fiddle.jshell.net/user/login/ #content > *', function(){
    //the request is complete
    alert("Dynamic Content Has Been loaded");
}); 
```

# macos - 如何使用 Doxygen 为 Dash 指定关键字？

> ID：14678025
> 
> 赞同：3
> 
> 时间：2013-02-03T22:23:37.667
> 
> 标签：macos, documentation, doxygen

我正在使用 Doxygen 为我的项目生成文档，该文档生成的文档集几乎可以与[dash](http://kapeli.com)完美配合。

我想知道的是如何在dash中设置搜索关键字；默认为“未知：”

![Dash 文档集](../Images/2b53f38fb0860f361e92649352553fee.png)

我需要更改什么，以便它读取“未知：”以外的内容。我可以在 Doxygen 中更改它吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T02:03:17.977

我是 Dash 的开发者。Dash 使用 docset 内 Info.plist 文件中的 DocSetPlatformFamily 键来确定默认关键字。不幸的是，据我所知，Doxygen 没有设置这个值的选项。我将联系 Doxygen 团队并要求他们添加此选项。随意做同样的事情。

目前，我最好的建议是编写一个后生成脚本，在 Info.plist 文件中添加所需的密钥（它只是一个文本文件）。

例如，这应该有效：

```
perl -pi -w -e "s/<\/dict>/<key>DocSetPlatformFamily<\/key><string>__DESIRED KEYWORD__<\/string><key>DashDocSetFamily<\/key><string>doxy<\/string><\/dict>/s" Info.plist 
```

注意：我还添加了一个值为“doxy”的“DashDocSetFamily”条目。这将导致 Dash 将文档集作为 Doxygen 生成的文档集处理，并显示可过滤的目录。

如果您还没有找到它们，这里有一些推荐的设置，用于生成用于 Dash 的 Doxygen 文档集：

```
SEARCHENGINE           = NO
DISABLE_INDEX          = YES
GENERATE_TREEVIEW      = NO 
```

# javascript - jQuery 内部有争论的函数

> ID：14678026
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:23:54.080
> 
> 标签：javascript, jquery, html, jquery-ui

有人可以帮助为什么这不起作用。

HTML 代码：

```
<li><a href="#" onclick="adminDBDisplay(ownorg);" >OOrg</a></li>
<li><a href="#" onclick="adminDBDisplay(twoorg);" >Twoorg</a></li> 
```

jQuery：

```
$(document).ready(function(){
    function adminDBDisplay(db){
        alert("Got into function" +db);
        // Planning to use jQuery Ajax here
    } 
}); 
```

当我查看使用 Firebug 时，出现以下错误：

```
"ReferenceError: adminDBDisplay is not defined" 
```

有人可以帮我为什么这不起作用。我处理这个问题的方式有问题。请让我知道是否有更好的方法。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:26:22.253

使用 定义函数时`function name() {...}`，如果您已经在函数内部，那么它将仅在该函数中定义。

函数定义不应包含在 a 中`.ready()`，因为它们在被调用之前不会运行。取下`.ready()`包装纸，你应该很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:37:36.207

以下符号：

```
$(function() { ... }); 
```

本身是一个绑定`function() {...}`到`document.ready`. 而 running function `adminDBDisplay(db){...}`in`document.ready`仅在运行时定义它的函数，但实际上并没有调用它。为了调用它，你会想要`adminDBDisplay('parameter');`

为了有效地实现它，您需要将其放置在页面正文中，如下所示：

```
<head>
<script src="yourversionofjquery.js"></script>
<script>
//Defining your function for calling later
function adminDBDisplay(db)
{
    alert("Got into function" +db);
    //Planning to use Jquery Ajax here
}
</script>
</head>
<body>
<script>
//Binding an anonymous function to document.ready
$(function () {
        //Do whatever you want after document.ready
    });
</script>
<div> rest of body</div>
</body> 
```

让我知道这是否有意义/修复了您的错误。

编辑：另外，在'ownorg'周围加上'单引号'，例如“adminDBDisplay（'ownorg'）;” 否则它正在寻找一个名为 ownorg 的变量。

# cocoa - 核心数据道模式

> ID：14678030
> 
> 赞同：7
> 
> 时间：2013-02-03T22:24:20.773
> 
> 标签：cocoa, core-data

我开始为 ios 开发，现在我正在研究核心数据。有一件事我不清楚，当我研究很多人在控制器上管理核心数据实体时。对我来说，这不是 MVC，因为核心数据来自模型层。

所以我认为使用 DAO 模式实现核心数据会很好，但是在我想知道是否有任何核心数据模式或者是否有一些使用核心数据实现 DAO 的缺点之前？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-01-09T07:36:00.793

避免在控制器中实现数据查找方法确实是正确的。这种方式遵循了 MVC 设计模式的理念：控制器应该只是调用高级“粘合”代码，因此充当描述视图如何与模型交互的文档。

关于持久对象，有两种主要方法：

*   使用 ActiveRecord 模式
*   使用数据访问对象模式。

**数据访问对象**(DAO) 是专用于将模型/域对象持久化到数据源的接口。

**ActiveRecord**模式将持久性方法放在模型对象本身上，而 DAO 定义了一个离散接口。DAO 模式的优点是：

*   它很容易定义另一种持久性风格，例如从数据库迁移到云，而无需更改接口并因此影响其他类。

*   持久性关注点被模块化，远离主要的模型对象关注点。

ActiveRecord 模式的优点是简单。

**CoreData 的 ActiveRecord**

目前，ActiveRecord 模式似乎在 Objective-C 开发人员中更受欢迎。以下项目为 CoreData 提供 ActiveRecord：[https ://github.com/magicalpanda/MagicalRecord](https://github.com/magicalpanda/MagicalRecord)

**CoreData 的 DAO**

我不熟悉为 CoreData 提供 DAO 模式的广泛使用的库。但是，如果没有库的帮助，它可以很容易地应用：

*   为特定实体定义所有数据方法 - 协议上的 findByName、保存、删除等。
*   通过调用适当的 CoreData 方法来实现协议。

注意：[Typhoon 框架的示例项目](https://github.com/typhoon-framework/Typhoon-example)将很快包含一些将 DAO 模式与 CoreData 一起应用的示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-04T13:06:23.197

您正在寻找类似[Core Date Persistence Framework的东西](http://www.codeproject.com/Articles/315043/CoreData-Persistence)

这个框架允许你这样做：

```
DAOFactory *factory = [DAOFactory factory];
DAO *dao = [factory createRuntimeDAO:@"EntityName"];
NSArray *items = [dao findAll]; 
```

还有很多更有趣的事情。

# java - 尝试将信息（高分列表）添加到 .txt 文件 + 排序，而不删除现有数据

> ID：14678031
> 
> 赞同：1
> 
> 时间：2013-02-03T22:24:26.047
> 
> 标签：java

*这是一个单一的分配。*

那么，我从哪里开始呢？

**任务：**任务是制作一个外部 .txt 文件的高级列表。.txt 文件只能有 5 个不同的最高分，这意味着如果我添加一个高于第 5 位高分的高分，则需要删除一个并用新的高分替换。

如果单击类名，您将被重定向到包含代码的粘贴链接。

**问题：**我无法在不删除当前文本的情况下获得添加文本的代码。代码的当前语句可能是处理问题的错误方式，我不知道。我尝试了几种方法，但似乎没有一个对我有用（或者我做错了）。对列表进行排序应该不是问题，因为我在最近的作业中已经这样做了。

无论如何，闲聊够了，让我们开始做事吧。

我的主要：

```
 public class main {

    public static void main(String[] args) {
        menu menu = new menu();
        menu.display();

    }
} 
```

[我的菜单：](http://pastie.org/6035175)

```
import java.util.*;

public class menu {
    highscores highscores = new highscores();
    private Scanner input = new Scanner(System.in);

    public void display() {
        System.out.println("Make your selection!");
        System.out.println("Select an option: \n" + "  1) Insert new score\n"
                + "  2) Print list\n" + "  3) Reset list \n" + "  4) Quit\n ");

        int selection = input.nextInt();
        input.nextLine();

        switch (selection) {
        case 1:
            highscores.enterScore();
            break;
        case 2:
            highscores.printList();
            break;
        case 3:
            highscores.resetList();
            break;
        case 4:
            System.out.println("Exiting program...");
            System.exit(1);
        default:
            System.out.println("Try Again!"); 
            break;

        }

    }

} 
```

[我的高分名单](http://pastie.org/6035178)

```
import java.io.*;
import java.util.*;

public class highscores {

    public void enterScore() {
        Scanner scan = new Scanner(System.in);
        System.out.println("Enter the players name!: ");
        String name = scan.nextLine();
        System.out.println("Enter the players score!: ");
        String score = scan.nextLine();
        System.out.println("Player " + name + " got: " + score
                + " points. Great job!");
        try {
            File file = new File("HighScores.txt");
            PrintWriter writer;
            writer = new PrintWriter(file);
            writer.println("Player name: " +name +" - " +"Player score:" +score);
            writer.close();
        } catch (Exception e) {
            System.out.println("Error #1");
        }
    }

    public void printList() {
        try {
            File file = new File("Highscores.txt");
            Scanner scanner;
            if (file.exists()) {
                scanner = new Scanner(file);
                for (int i = 0; i < 5; ++i) {
                    String line = scanner.nextLine();
                    System.out.println(line);
                }
            } else {
                System.out.println("Error #2");
            }
        } catch (Exception e) {
            System.out.println("Error #1");
        }
    }

    public void resetList() {
        try {
            File file = new File("Highscores.txt");
            PrintWriter writer;
            writer = new PrintWriter(file);
            for (int i = 0; i < 5; ++i) {
                writer.println("Player name: x - Player score: x ");
            }
            writer.close();
        } catch (Exception e) {
            System.out.println("Error #1");
        }

    }
} 
```

有什么方法可以保存此代码并将其用于此任务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:29:44.377

> **问题：**我无法在不删除当前文本的情况下获得添加文本的代码。

使用[`FileWriter(File file, boolean append)`](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File,%20boolean%29)并将其包装在[`PrintWriter(Writer out)`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintWriter.html#PrintWriter%28java.io.Writer%29).

`FileWriter(File file, boolean append)`的JavaDoc：

> 在给定 File 对象的情况下构造一个 FileWriter 对象。***如果第二个参数为真，那么字节将被写入文件的末尾而不是开头。***
> 
> 参数：
> 
> file - 要写入的 File 对象
> 
> append -***如果为真，那么字节将被写入文件的末尾而不是开头***

* * *

更新您的代码：

```
PrintWriter writer;
writer = new PrintWriter(file); 
```

至：

```
PrintWriter writer;
writer = new PrintWriter(new FileWriter(file, true)); 
```

# data-structures - 用二进制表示分数？

> ID：14678033
> 
> 赞同：0
> 
> 时间：2013-02-03T22:24:30.203
> 
> 标签：data-structures, rational-numbers

我正在查看分数的二进制数据表示，我想知道如果您要同时存储存储分数的分子和分母，分数会有什么样的数据结构。它只是两个没有关系但在计算中使用时组合在一起的单独数字吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:26:35.557

如果您想存储有理数而不丢失精度，正确的方法是存储分子和分母。

在实践中，大多数人使用浮点数学或内置/库任意精度数字数据类型（例如[Java 的 BigDecimal](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html)）。

如果您特别想对分数使用数据类型，则[某些语言](http://en.wikipedia.org/wiki/Rational_data_type#Language_support)具有用于有理数的内置类型。对于大多数其他语言，通常有一个具有可用数据类型的库（例如，对于 Java Apache Commons 有一个[Fraction](http://commons.apache.org/lang/api/org/apache/commons/lang3/math/Fraction.html)类，对于 C/C++ GMP 有一个[mpq_t 数据类型](http://gmplib.org/manual/Rational-Number-Functions.html#Rational-Number-Functions)）

# ios - 将位于文档目录中的记录的 .caf 文件附加到邮件 iOS Xcode

> ID：14678040
> 
> 赞同：0
> 
> 时间：2013-02-03T22:25:14.727
> 
> 标签：ios, email, documents, mfmailcomposer, caf

我在文档目录中有用户记录的文件...显示在 uitableview 中...

我将此代码放在我的 didSelectRowAtIndexPath 中...为什么这不起作用？

```
 NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *fileName = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@",[directoryContents objectAtIndex:indexPath.row]]];
NSURL *audioURL = [NSURL URLWithString:fileName];
NSData *audioData = [NSData dataWithContentsOfURL:audioURL];

MFMailComposeViewController *mailer = [[MFMailComposeViewController alloc] init];

    mailer.mailComposeDelegate = self;

[mailer addAttachmentData:audioData mimeType:@"audio/caf" fileName:fileName]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:34:08.367

您创建的 URL 不正确。你需要使用`fileURLWithPath`，而不是`URLWithString`。

另外，这个：

```
NSString *fileName = [documentsDirectory stringByAppendingPathComponent:[NSString stringWithFormat:@"%@",[directoryContents objectAtIndex:indexPath.row]]]; 
```

应该：

```
NSString *fileName = [documentsDirectory stringByAppendingPathComponent:[directoryContents objectAtIndex:indexPath.row]]; 
```

不需要字符串格式。

最后一件事。传递给`addAttachment`方法的文件名应该只是一个文件名，而不是完整的路径名。

# php - 一个接一个地使用两个php脚本处理表单

> ID：14678047
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:25:47.420
> 
> 标签：php, forms, post, processing

我有一个页面，其中包含用于登录到我的网站“login.php”中的子部分的表单。我想做一些用户信息的记录。就像用户名，时间，使用的浏览器......但没有触及原始的'login.php'，对用户具有一定的透明度，将表单传递给原始脚本以设置cookie......

我正在考虑添加包含表单的第二页“login.html”，`action=logtofile.php`然后将数据传递给允许用户访问成员区域的原始“login.php”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:37:16.923

尝试更具体，我不知道你的问题是什么。一个问题中至少应该有一个问号:)

我不明白为什么需要两个 PHP 脚本，为什么不能将记录用户信息和执行用户登录写入一个脚本？

# mysql - SQL 在 LEFT JOIN 上获取最大 id 字段

> ID：14678056
> 
> 赞同：9
> 
> 时间：2013-02-03T22:26:24.563
> 
> 标签：mysql, sql

我正在尝试从 tblimage 中提取与每个用户的 tblimage 中的 maxid 相对应的照片。目前，我正在从消息表中获取所有消息以及发布消息的用户的随机照片，我希望这张照片是最新上传的照片。它现在写的方式只是从桌子上随机抽取一张照片。有什么建议么？

表结构如下：

> 消息：msgid、消息、user_id、event_id
> tblimage：id、照片、用户 ID

```
SELECT messages.*, tblimage.photo, max(tblimage.id) 
        FROM messages LEFT JOIN tblimage ON messages.user_id = tblimage.userid 
        GROUP BY messages.msg_id, messages.user_id 
        ORDER BY messages.msg_id DESC, tblimage.id desc 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-02-03T22:45:33.770

尝试

```
SELECT messages.*, T2.photo
FROM messages
LEFT JOIN (SELECT userid, MAX(id) AS maxid
           FROM tblimages
           GROUP BY userid) AS T1
ON messages.user_id = T1.userid
LEFT JOIN tblimages AS T2
ON T2.id = T1.maxid
ORDER BY messages.msg_id DESC 
```

它为 tblimages 中的每个用户找到 max(id)，然后使用它来将每个用户加入到该用户的最新照片中。

# compiler-construction - 解释器 vs 编译器 vs 虚拟机

> ID：14678060
> 
> 赞同：31
> 
> 时间：2013-02-03T22:26:44.510
> 
> 标签：compiler-construction, vm-implementation

我有一个关于解释器、编译器和虚拟机 (VM) 的问题。

现在我知道解释器和编译器之间的区别，但是**虚拟**机与前两个有什么不同？与解释器和编译器相比，VM 的优缺点是什么？

非常感谢。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-02-03T22:55:09.257

虚拟机并不能完全替代编译器或解释器。我认为您正在考虑 JIT 编译器，即实现了多少 VM。

虚拟机本身就是这个名字所说的——它是一台实际上并不存在的机器（处理器）。例如，大多数处理器没有任何处理内存分配的内在方法，也没有任何类型知识。但是，Java VM 有一条`new`指令可以分配某个类的实例。VM 的设计者认为这是语言中一个足够重要的概念，值得拥有自己的操作码，这是 VM 中的基本操作单元。

创建自己的指令集的优点通常是弥合长编译/优化时间和慢解释器之间的差距。例如，当您编译 Java 类时，您不必进行任何寄存器分配或内联或任何传统编译器的工作。JIT 稍后会这样做，但仅限于您运行足够多次的代码部分，并在程序运行期间分散开来。与 Java 源代码不同，JVM 的指令集与 Java 非常接近，因此初始编译速度很快，并且对于 VM 来说阅读起来简单快捷。

至于解释器与 JIT 编译器，权衡通常围绕运行时性能与开发时间。JIT 需要更长的时间来开发，但是解释器在运行时要慢得多。但是，在很多情况下，例如脚本和中小型网站，程序运行时间不够长，无法让您真正看到使用 JIT 的任何好处。

我还应该提到像 VMware 这样的软件。这也是一个虚拟机，但它使用的指令集也恰好在真实硬件上使用。它与语言 VM 的基本概念相同，因为它假装是一台实际不存在的机器，但实际上它是不同的并且非常复杂。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2013-02-03T22:48:54.973

纯英语

**编译器**将一种语言转换为另一种语言。例如，C# 转换为 IL，Java 转换为字节码，C++ 转换为二进制机器码。在编译阶段没有执行。

**解释**器一次解释（执行）源文件中的一行。如PHP、Perl、其他脚本语言

**虚拟机**可以指几个东西，我知道的两个：

*   Hypervisor 相关的虚拟机，如[Hyper-V](http://en.wikipedia.org/wiki/Hyper-V)、[Xen](http://en.wikipedia.org/wiki/Xen)。这些允许您在单个硬件上运行多个操作系统
*   软件运行时，如[Java 虚拟机](http://en.wikipedia.org/wiki/Java_virtual_machine)、[公共语言运行时](http://en.wikipedia.org/wiki/Common_Language_Runtime)。该软件允许运行独立于平台的中间语言（IL 代码、字节代码）并执行特定[于机器的指令（即时编译](http://en.wikipedia.org/wiki/Just-in-time_compilation)）。通常，此类 VM 负责其他附属任务：资源管理、内存清理、线程、安全等

没有优点和缺点。这三个人都从事难以比较的不同工作。

[语言和平台没有特别的顺序，实际上还有数百个其他示例]

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-05-04T12:58:22.133

# 真机与虚拟机

*   真机是机器代码由硬件执行的机器
*   虚拟机是其“机器代码”由解释器执行的机器。

# 解释器与编译器

[**答案在这里**](https://stackoverflow.com/a/23456402/3300831)

# php - 如何从代码运行 phpunit？

> ID：14678062
> 
> 赞同：5
> 
> 时间：2013-02-03T22:27:06.427
> 
> 标签：php, phpunit

我想使用本地安装的 PHPUnit（通过 composer）来运行我的测试并将其显示在屏幕上（例如访问 /admin/tests）。但我在文档中找到的唯一运行测试的方法是命令行工具。

贝娄是我正在寻找的一个假设示例：

```
$session = new PHPUnit_TestSession('path/to/folder');
$results = $session->runAll();
echo $results->failuresCount();
// other hipotetical $result->methods...
// maybe $results->dump() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T22:28:20.313

这可能是一种矫枉过正，但你是在享受一种享受：[https](https://github.com/NSinopoli/VisualPHPUnit) ://github.com/NSinopoli/VisualPHPUnit :)

**编辑**这是使用 TextUI_TestRunner 对 PHPUnit 的基本使用

```
// make sure you have PHPUnit on your path
require_once "PHPUnit/Framework/TestSuite.php";
require_once "PHPUnit/TextUI/TestRunner.php";

$suite = new PHPUnit_Framework_TestSuite();
$suite->addTestSuite('YourTestCase');

// run the test suite with TextUI_TestRunner
PHPUnit_TextUI_TestRunner::run($suite); 
```

该类`YourTestCase`是 的子类`PHPUnit_Framework_TestCase`，您可以在官方网站上阅读更多关于如何编写的内容：[http ://www.phpunit.de/manual/3.2/en/writing-tests-for-phpunit.html](http://www.phpunit.de/manual/3.2/en/writing-tests-for-phpunit.html)

但是，我还建议您获取这本书的副本：http: [//www.amazon.com/Advanced-PHP-Programming-George-Schlossnagle/dp/0672325616](https://rads.stackoverflow.com/amzn/click/com/0672325616)作者教你很多很酷的技巧，包括自动加载测试， ETC。

# visual-c++ - 为什么我的注册表无法读取工作 vc++？

> ID：14678063
> 
> 赞同：0
> 
> 时间：2013-02-03T22:27:14.533
> 
> 标签：visual-c++, dll, registry

我正在使用以下代码：

```
bool DllGuard()
{
    HKEY keyHandle;
    bool rgValue = bool();
    DWORD Size;
    DWORD Type;

    try
    {
        if (RegOpenKeyEx(HKEY_CURRENT_USER, "Software\\MSB", 0, KEY_QUERY_VALUE, &keyHandle) == ERROR_SUCCESS)
        {
            Type = REG_DWORD;

            Size = sizeof(DWORD);

            RegQueryValueEx(keyHandle, "DllGuard", NULL, &Type, (LPBYTE)rgValue,&Size);
        }     

        RegCloseKey(keyHandle);

        if (rgValue == false)
        {
            return true;
        }
        else
        {
            return false;
        }
    }
    catch (...)
    {
        return false;
    }
}

BOOL APIENTRY DllMain(HINSTANCE hInstance, DWORD fdwReason, LPVOID lpReserved)
{
    if(fdwReason == DLL_PROCESS_ATTACH)
    {
        if (DllGuard())
        {
            DisableThreadLibraryCalls(hInstance);
            CreateThread(NULL, 0, (LPTHREAD_START_ROUTINE)&Main, NULL, 0, NULL);
        }
        else
        {
            exit(0);
        }
    }
    return TRUE;
} 
```

第一次工作正常，因此在 DllMain 中创建了线程。

第二次，它不起作用，因为即使注册表项设置为 true，它仍会在 DllMain 中创建线程。

帮助！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:41:18.757

`(LPBYTE)rgValue`应该是`(LPBYTE)&rgValue`，因为你想传递一个指针（所以`rgValue`由 . 修改`RegQueryValueEx`。它应该是`DWORD rgValue`而不是`bool`（也许你知道它们恰好大小相同，但更难阅读）。

*此外，检查 的返回值*也很棒，`RegQueryValueEx`这样下次失败时我们就有机会知道出了什么问题。（如果您不知道如何处理故障，可以用 , 写一些东西`OutputDebugString`，以便在 sysinternals' 中看到`dbgview.exe`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T14:22:59.803

我无法发表评论，但我认为重要的是要知道，除非您知道自己在做什么，否则根本不应该考虑使用 DLLMain... 看看[DllMain 入口点的 MSDN 页面](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682583%28v=vs.85%29.aspx)：

> **警告** 您可以在 DLL 入口点执行的操作受到严格限制。要提供更复杂的初始化，请为 DLL 创建一个初始化例程。您可以要求应用程序在调用 DLL 中的任何其他例程之前调用初始化例程。

或者你可以[害怕。非常害怕](http://blogs.msdn.com/b/oleglv/archive/2003/10/24/56141.aspx)

# ruby-on-rails - Win 8 Pro 64 上的 ActiveAdmin

> ID：14678066
> 
> 赞同：0
> 
> 时间：2013-02-03T22:27:34.360
> 
> 标签：ruby-on-rails, windows, activeadmin

我最近在 Windows 8 Pro 64 上安装了 ActiveAdmin，当我发出“rails server”命令并在 Google Chrome 中查看 ActiveAdmin 时，我显示以下错误：

```
ExecJS::RuntimeError in Active_admin/devise/sessions#new

Showing C:/Ruby193/lib/ruby/gems/1.9.1/gems/activeadmin-0.5.1/app/views/layouts/active_admin_logged_out.html.erb where line #12 raised:

(in C:/Ruby193/lib/ruby/gems/1.9.1/gems/activeadmin-  0.5.1/app/assets/javascripts/active_admin/lib/namespace.js.coffee)

Extracted source (around line #12):

9:     <%= stylesheet_link_tag style.path, style.options %>
10:   <% end %>
11:   <% ActiveAdmin.application.javascripts.each do |path| %>
12:     <%= javascript_include_tag path %>
13:   <% end %>
14: 
15:   <%= csrf_meta_tag %> 
```

我已经尝试过这里给出的解决方案，但仍然没有运气：

[https://github.com/gregbell/active_admin/issues/1773](https://github.com/gregbell/active_admin/issues/1773)

我在 Win 7 和 Mac OS X 上安装和运行 ActiveAdmin 从来没有遇到过问题。我很好奇是否有其他用户遇到过这个问题并知道解决方案？

我真的不想再次降级到 Win 7 :(

我已确保 Java 已安装并正常工作。

提前致谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T15:02:38.000

我从这个位置删除了我的应用文件夹中的 active_admin.js：

```
app/assets/javascripts/active_admin.js 
```

以为我会添加这个以防其他用户卡在这里:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T12:31:31.080

据我所知，您实际上并没有解决问题，您只是删除了 activeadmin javascript。虽然这将阻止错误消息的出现，但它也会终止任何 activeadmin javascript 功能，这远非理想。

根据我自己的经验，解决 ExecJS::RuntimeError 是使用咖啡脚本时的环境问题，而不是 activeadmin 问题 - 有些人建议添加`gem 'therubyracer'`到您的 Gemfile，但我在成功构建它时遇到了问题。

对我来说，通过安装 node.js 解决了上述问题。

# c++ - 在字符串到 int 转换中使用 atoi 时出错

> ID：14678067
> 
> 赞同：0
> 
> 时间：2013-02-03T22:27:34.693
> 
> 标签：c++

所以，我尝试使用 atoi 函数将字符串转换为 int，但是我收到一个错误，说参数类型 char 与 const char* 类型的参数不兼容。这是代码：

```
void evaluate(const char values[], string& codeMessage, string& result)
{
    unsigned int i = 0;
    while (i<codeMessage.length())
    {
        result+= values[atoi(codeMessage[i])];
        i++;
    }
} 
```

因此，如果`evaluate({a,b,c,d}, "2331", result)`调用该函数，则结果必须包含`"cdda"`. 任何想法，我的代码有什么问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:29:58.460

`atoi`需要一个 C 字符串，而不是单个字符。

如果你想将一个数字在词法上转换为等价的整数，为什么不简单地断言它在`'0'`and之间`'9'`，然后减去`'0'`呢？无论语言环境的字符集如何，数字都必须是连续的。

```
while (i < codeMessage.length()) {
    if (codeMessage[i] >= '0' && codeMessage[i] <= '9') {
       result += values[codeMessage[i] - '0'];
    }

    i++;
} 
```

# c# - “~/”和“../”有什么区别？

> ID：14678072
> 
> 赞同：0
> 
> 时间：2013-02-03T22:28:09.533
> 
> 标签：c#, asp.net, .net, vb.net

在代码中，我经常发现 ~/ 或 ../ 带有路径，但不幸的是，我不清楚这些是什么以及有什么区别。哪一个与多级目录一起使用？

我猜 ../ 表示站点或应用程序的域？

你能指导一下它们是什么，它们有什么不同吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T22:30:01.690

`~/`经常在辅助函数中被引用，`<%= ResolveUrl() %>`例如。它指的是网站的根目录，而`../`只是指父目录。两者都是相对网址。

让我们举个例子。假设您的网站托管在一个名为`MyApplication`. 当您使用`<%= ResolveUrl("~/foo/bar") %>`它时，它会生`/MyApplication/foo/bar`成为输出 url，无论在哪个 WebForm 位置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-03T22:37:11.303

有两种路径：

*   常规路径
*   虚拟路径

当您只是使用`/`或`../`使用相对于 IIS 的常规路径时 - Web 服务器 - 网站 URL。也就是说，`/myfile.txt`如果您的应用程序托管在名为`mydir`. 在这种情况下，`/myfile.txt`将以这样的 URL 结尾：`http://www.mydomain.com/myfile.txt`，而您期望的是`http://www.mydomain.com/mydir/myfile.txt`。

出于这个原因，ASP.NET 让您有机会提供虚拟路径。都是从`~`性格开始的。该`~`字符指定解析的 URI 是相对于 IIS 应用程序的。以上面的期望为例`http://www.mydomain.com/mydir/myfile.txt`，正确的虚拟路径是`~/myfile.txt`.

**请注意，非服务器控件中不允许使用虚拟路径。这种路径用于选定数量的 ASP.NET 类方法和服务器控件**。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-03T22:29:36.650

波浪号 (~) 指的是应用程序根目录。在 ASP 中，波浪号用于 HyperLinks 或 Page.ResolveURL。

两个点 (..) 是指比当前文件夹高一级的文件夹。

# iphone - Xcode 说它实际上运行时无法启动应用程序

> ID：14678074
> 
> 赞同：0
> 
> 时间：2013-02-03T22:28:11.350
> 
> 标签：iphone, xcode, timeout, device

我该怎么办？

Xcode 在设备上启动应用程序并启动，但是当它启动时，会弹出下面的图像，当我单击“确定”时，它会使应用程序崩溃。

模拟器没有问题，但由于这个原因，我无法阅读有关调试的控制台。这真的没有理由发生。

我也不知道什么代码会导致这种情况。我没有错误或警告，直到昨天一切都很好。如果您需要任何代码或更多信息来帮助我，请询问:-)

我已经删除了应用程序，重新启动了设备和我的 mac。

![在此处输入图像描述](../Images/816327bb109b613ceea8905171d36358.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:28:34.403

好的，我在这里找到了答案：

[同样的问题在这里](https://stackoverflow.com/questions/11683308/xcode-4-4-error-timed-out-waiting-for-app-to-launch)

基本上你不能在 Ad-Hoc 配置文件上进行调试:-)

# c1-cms - 为 Composite CMS 创建新语言的步骤是什么？

> ID：14678079
> 
> 赞同：1
> 
> 时间：2013-02-03T22:28:37.653
> 
> 标签：c1-cms

为复合 CMS 创建另一种语言（例如波斯语）的主要步骤是什么？我认为我应该执行以下步骤：
1\. 我认为我应该将我的语言添加到文化列表中
2\. 本地化中有以“en-us.xml”结尾的文件我应该使用“fa-ir.xml”创建他们的波斯语版本。 xml”！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T01:51:26.083

如果您希望翻译管理 UI，您可以在[http://docs.composite.net/Console/LocalizingConsole找到指导和工具](http://docs.composite.net/Console/LocalizingConsole)

如果您想为您的网站添加另一种内容语言，您可以在[http://docs.composite.net/HTML/C1-Localization/Website-Languages找到指导，在](http://docs.composite.net/HTML/C1-Localization/Website-Languages)[http://users.composite.net 找到](http://users.composite.net/Pages/MultipleLanguages)最终用户帮助[/页面/多种语言](http://users.composite.net/Pages/MultipleLanguages)

# php - 如何在 Notepad ++ 编辑器中缩进 HTML 或 PHP 代码？

> ID：14678080
> 
> 赞同：13
> 
> 时间：2013-02-03T22:28:45.457
> 
> 标签：php, html, notepad++

如何在记事本 ++ 编辑器中缩进 HTML 或 PHP 代码以更好地组织我的代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T22:34:34.120

如果您想要自动格式化，请查看[SourceFormatX](http://www.sourceformat.com/index.php)，它是 Notepad++ 的付费插件。

[除此之外， Notepad++ Wiki](http://docs.notepad-plus-plus.org/index.php/Plugin_Central)上还有一些免费插件可用于格式化 HTML 或 PHP 代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T22:35:33.953

通常的做法是为每个当前打开的“块”缩进一个级别。在 PHP 中，“块”只是 和 之间的`{`代码`}`。在 HTML 中，“块”是未在同一行上关闭的任何标记。

在 Notepad++（和许多其他代码编辑器）中，您可以选择几行代码并按 Tab 缩进整个选择（或 Shift+Tab 缩进它）。这应该有助于保持代码整洁。

另外需要注意的是，Notepad++ 可以为您折叠块。在行号旁边，您应该看到一棵带`[-]`框的树。您可以单击它们以折叠它们正在标记的块，从而更好地了解您的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-04T16:42:10.853

如果您需要一个插件来格式化您的 HTML，您是否只想制表符尚不清楚，但在常识中，我想您正在寻找一种软件来重新缩进代码。有一个插件 Tidy2 在：

[https://github.com/davegb3/NppTidy2](https://github.com/davegb3/NppTidy2)

有了它，您可以重新格式化您的所有 HTML 代码，并更改执行方式，这通常很有趣。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T22:33:45.800

选择部分代码或任何文本，然后按**tab**，它将缩进所有选定的行。按**shift + tab**取消缩进。

# css - CSS到达另一个元素

> ID：14678081
> 
> 赞同：1
> 
> 时间：2013-02-03T22:28:52.513
> 
> 标签：css

你能帮我在 .right 类悬停上达到 .form 类吗？我已经尝试过 + 和 ~，但可能我做错了什么。这是代码：

```
<div id="searchForm">

  <div id="typeSelector">
    <div class="left"><img src="images/left_arrow.png"></div>
    <div class="middle"><img src="images/typeSelector.png"></div>
    <div class="right"><img src="images/right_arrow.png"></div>
  </div>

  <div class="transform3D">
    <div id="one" class="form"></div>
  </div>
  <div class="transform3D">
    <div id="two" class="form"></div>
  </div>
  <div class="transform3D">
    <div id="three" class="form"></div>
  </div>
  <div class="transform3D">
    <div id="four" class="form"></div>
  </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:47:46.497

如果您可以摆脱#typeSelector div，则有一个解决方案。

然后使用“兄弟”选择器`~`

`.left:hover ~ .transform3D #one`

但我不确定它是否适用于所有浏览器。

[http://jsfiddle.net/NeekGerd/HHtef/](http://jsfiddle.net/NeekGerd/HHtef/)

# sql - 按行求和 2 个字段并按每月每天查询最大值

> ID：14678089
> 
> 赞同：0
> 
> 时间：2013-02-03T22:29:45.427
> 
> 标签：sql

我使用 SQL 进行简单查询，但现在需要执行一些更复杂的操作。我不确定如何嵌套查询。

我有一张包含以下列的表格：

```
Date, Daily Power, Daily Power 1, Daily power2 
```

我需要找到它`max daily values`，然后按月过滤。我也需要`Daily Power 1`并`Daily Power 2`总结成一个新的专栏。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T11:36:51.037

您的表的部分问题是数据未标准化，因为您有 3 列，每列都包含一个单独的值`DailyPower`。

您可以轻松获得所需结果的一种方法是使用查询对数据进行*反透视。*`UNION ALL`

此查询将从多列中获取数据并将其转换为多行以供使用：

```
select date, 'DailyPower' as col, DailyPower as value
from yourtable
union all
select date, 'DailyPower1' as col, DailyPower1 as value
from yourtable
union all
select date, 'DailyPower2' as col, DailyPower2 as value
from yourtable 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/982c5/1)。此查询获取数据并将其转换为结果：

```
|       DATE |         COL | VALUE |
------------------------------------
| 2012-01-01 |  DailyPower |   456 |
| 2012-01-02 |  DailyPower |   789 |
| 2012-02-01 |  DailyPower |    23 |
| 2012-01-01 | DailyPower1 |   789 |
| 2012-01-02 | DailyPower1 |   235 |
| 2012-02-01 | DailyPower1 |    89 |
| 2012-01-01 | DailyPower2 |    65 |
| 2012-01-02 | DailyPower2 |    45 |
| 2012-02-01 | DailyPower2 |    10 | 
```

一旦数据在行中，就更容易`max()`按日期获取值。

您的查询将类似于以下内容：

```
select date, 
  max(value) MaxDailyPower,
  sum(case when col in ('DailyPower1', 'DailyPower2') then value end) TotalDailyPower
from
(
  select date, 'DailyPower' as col, DailyPower as value
  from yourtable
  union all
  select date, 'DailyPower1' as col, DailyPower1 as value
  from yourtable
  union all
  select date, 'DailyPower2' as col, DailyPower2 as value
  from yourtable
) src
where date >= '2012-01-01' 
  and date <= '2012-12-31'
group by date 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/ce5a54/2)。这给出了结果：

```
|       DATE | MAXDAILYPOWER | TOTALDAILYPOWER |
------------------------------------------------
| 2012-01-01 |           789 |             854 |
| 2012-01-02 |           789 |             280 |
| 2012-02-01 |            89 |              99 | 
```

编辑#1，如果你想`GROUP BY`一个月，那么你可以使用：

```
select month(date) Month, 
  max(value) MaxDailyPower,
  sum(case when col in ('DailyPower1', 'DailyPower2') then value end) TotalDailyPower
from
(
  select date, 'DailyPower' as col, DailyPower as value
  from yourtable
  union all
  select date, 'DailyPower1' as col, DailyPower1 as value
  from yourtable
  union all
  select date, 'DailyPower2' as col, DailyPower2 as value
  from yourtable
) src
group by month(date) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/ce5a54/5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:44:47.383

这是你想要的吗？

```
select date,
       (case when DailyPower > DailyPower1 and DailyPower > DailyPower2 then DailyPower
             when DailyPower1 > DailyPower2 then DailyPower1
             else DailyPower2
       ) as MaxDailyPower,
       coalesce(DailyPower1, 0) + Colaesce(DailyPower2) as DailyPowerSUm
from t
where date between '2012-01-01' and '2012-03-31'  -- for the filter 
```

这假设您的数据中每个日期都有一行。

# php - 在 Wordpress 上使用 AJAX 自动注销

> ID：14678093
> 
> 赞同：1
> 
> 时间：2013-02-03T22:29:58.147
> 
> 标签：php, jquery, ajax, wordpress

Wordpress 正在一个网站上使用，我正在帮助我们从网站上登录的用户那里获得一些准确的统计数据。具体来说，我们希望它们处于活动状态，并且我们希望在它们不活动时自动将它们注销。

我见过几个做自动注销类型的插件，但由于 PHP 插件是服务器端的性质，它们只检查页面加载。

我们需要一些客户端解决方案，在空闲时将它们注销（可能会给它们一个弹出窗口以单击它们，这样它们就不会被注销）。

我在这里看到了一些关于此的主题：

[带有计时器的php ajax自动注销](https://stackoverflow.com/questions/3801935/php-ajax-auto-logout-with-timer)

[如果用户当前在页面上处于活动状态，如何使用 JavaScript/jQuery 检测？](https://stackoverflow.com/questions/1009260/how-can-i-detect-with-javascript-jquery-if-the-user-is-currently-active-on-the-p)

但我不确定如何将它应用于 wordpress 网站上的每个页面，而不仅仅是编辑源代码。这当然是可能的，但我认为这不是正确的解决方案。

所以，我想我可以处理代码来检测用户活动，我链接的主题对此有所帮助。我不确定是否真的从网站上注销用户。我对 jQuery 和 AJAX 解决方案不是很熟悉，将 Wordpress 加入其中也无济于事。

# python - 使用变量以点表示法指定对象属性

> ID：14678097
> 
> 赞同：13
> 
> 时间：2013-02-03T22:30:15.270
> 
> 标签：python

是否可以使用变量访问 Python 对象上的属性/方法以及如何访问？

例子：

```
handler.request.GET.add() 
```

我想通过预先将方法捕获到变量中然后以点表示法使用它来替换“GET”部分。

```
method = handler.method
handler.request.{method}.add() 
```

我只是看不到在哪里/如何做到这一点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-03T22:33:06.030

您正在寻找`getattr`：

`getattr(handler.request, 'GET')`是一样的`handler.request.GET`。

所以你可以做

```
method = "GET"
getattr(handler.request, method).add() 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-03T22:32:33.040

使用[`getattr()`函数](http://docs.python.org/2/library/functions.html#getattr)访问动态属性：

```
method = 'GET'
getattr(handler.request, method).add() 
```

这将与`handler.request.GET.add()`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T22:32:57.480

你可以做类似[getattr](http://docs.python.org/2/library/functions.html#getattr)

```
getattr(handler.request, "GET").add() 
```

然后就做

```
method = "GET" # or "POST"
getattr(handler.request, method).add() 
```

# image - tumblr 如何在未经允许的情况下在 Gmail 上显示徽标图像

> ID：14678098
> 
> 赞同：2
> 
> 时间：2013-02-03T22:30:24.380
> 
> 标签：image, gmail, tumblr

我刚刚注册了 tumblr，令我惊讶的是，在他们的确认电子邮件中可以看到 tumblr 徽标图像。这是我从 tumblr 收到的第一封电子邮件，我还没有在 Gmail 中选择“显示图像”选项，所以徽标图像是如何出现的。我检查了它，它确实是一个带有有趣源 URL 的图像

见下文：

![来自 Gmail 的屏幕截图](../Images/59df3aa510e56900aaf002fc98b97edc.png)

图片的 HTML 代码是

```
<img src="?ui=2&amp;ik=ec1c699863&amp;view=att&amp;th=13ca2239a42b6379&amp;attid=0.1.1&amp;disp=emb&amp;zw&amp;atsh=1" width="127" height="27" border="0" alt="Tumblr"> 
```

# haskell - Haskell：猪拉丁语

> ID：14678101
> 
> 赞同：-2
> 
> 时间：2013-02-03T22:30:26.750
> 
> 标签：haskell, apache-pig

问题：翻译成“Pig Latin”的简单规则是取一个以元音开头的单词并添加“yay”，同时取任何以一个或多个辅音开头的单词并将它们转移到后面，然后再添加“啊”。例如，“able”变成“ableyay”，“stripe”变成“ipestray”。编写一个函数，将一串字母转换成它的 Pig-Latin 翻译。

执行：

```
-- define function to detect vowel
isVowel :: Char -> Bool
isVowel c = elem c ['u','e','o','a','i']

-- define function Latin Pig
lp ::String -> String
lp str = if (isVowel (head str)) then do {str ++ "yay"} 
         else
            do {

                str ++ (head str)
                tail str
                lp str

                } 
```

问题：到目前为止，我的代码（逻辑）没有任何问题。老实说，这是我的 Haskell 入门课程的作业。但是编译器给了我错误：

```
**Couldn't match expected type `t0 -> t1 -> t2 -> t3 -> [Char]'
                with actual type `Char'
    Expected type: [t0 -> t1 -> t2 -> t3 -> [Char]]
      Actual type: String
    In the first argument of `head', namely `str'
    In the second argument of `(++)', namely
      `(head str) tail str lp str'
Failed, modules loaded: none.** 
```

我的代码有什么问题？！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T22:52:06.383

首先，考虑模式匹配。
任何非空列表都可以定义为**x:xs**，其中
**x** 为头列表
**xs**为尾列表

然后你的代码变成，

```
-- define function Latin Pig
lp :: String -> String
lp [] = ""
lp (x:xs) = if (isVowel x) then str ++ "yay"
            else ..... -- fill here
                where str = (x:xs) 
```

别忘了 operator **:**是 list 的构造函数，例如
'a':"bab" => "abab"

请记住，字符串是一个字符列表。
此外，您可以跳过前面示例中的 where 子句，如下所示，

```
-- define function Latin Pig
lp :: String -> String
lp [] = ""
lp str@(x:xs) = if (isVowel x) then str ++ "yay"
                else ..... -- fill here 
```

应该足以帮助你。
祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T06:11:29.940

我不确定使用递归是否是您要求的一部分，但这是我对您的任务的看法。您不需要使用`do`monad 来实现您想要的（除非这是作业的目标？）。

您可能需要考虑使用模式匹配和守卫而不是 if else 块。

此外，就像 zurgl 所说，您可以像这样利用匹配字符串：`string@(x:xs)`这将允许您在使用整个字符串的同时使用 head`x`和 tail `xs`。

**注意：**所有字符串都是列表。

这是我建议的一个简单示例。

```
-- define function to detect vowel
isNotVowel :: Char -> Bool
isNotVowel c = notElem c ['u','e','o','a','i']

-- define function Latin Pig
lp :: String -> String
lp [] = []
lp p@(x:xs)
    | not $ isNotVowel x = p++"yay"
    | otherwise = let (constants, rest) = span isNotVowel p
                    in (rest++constants++"ay") 
```

玩得开心学习haskell！

一些学习haskell的好资源：

*   [向您学习 Haskell for Great Good](http://learnyouahaskell.com/)
*   [真实世界的 Haskell](http://book.realworldhaskell.org/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T09:19:23.627

这是另一种放置猪拉丁规则的方式：

*   如果一个词不以一连串的辅音开头，那么翻译就是原词后跟“yay”
*   否则翻译是单词的其余部分，然后是最初的辅音，然后是“ay”

这更容易翻译成 Haskell。

（实际的 Haskell 代码省略了，因为这是家庭作业。）

您会发现将您`isVowel`的函数与[`break`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#v%3abreak)Data.List 中的函数结合起来很有帮助。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-11-07T10:26:54.950

请参考以下代码。

```
private static BufferedReader buf = new BufferedReader(new InputStreamReader(System.in));

    public static void main(String[] args) throws IOException {
        System.out.print("Enter sentence: ");
        String sentence = getString();
        String latin = pigLatinForSentence(sentence);
        System.out.println(latin);
    }

    private static String pigLatinForSentence(String s) {
        String latin = "";
        int i = 0;
        while (i < s.length()) {
            while (i < s.length() && !isLetter(s.charAt(i))) {
                latin = latin + s.charAt(i);
                i++;
            }
            if (i >= s.length())
                break;
            int begin = i;
            while (i < s.length() && isLetter(s.charAt(i))) {
                i++;
            }
            int end = i;
            latin = latin + pigWord(s.substring(begin, end));
        }
        return latin;
    }

    private static boolean isLetter(char c) {
        return ((c >= 'A' && c <= 'Z') || (c >= 'a' && c <= 'z'));
    }

    private static String pigWord(String word) {
        int split = firstVowelInSentence(word);
        return word.substring(split) + "-" + word.substring(0, split) + "ay";
    }

    private static int firstVowelInSentence(String word) {
        word = word.toLowerCase();
        for (int i = 0; i < word.length(); i++)
            if (word.charAt(i) == 'a' || word.charAt(i) == 'e' || word.charAt(i) == 'i' || word.charAt(i) == 'o'
                    || word.charAt(i) == 'u')
                return i;
        return 0;
    }

    private static String getString() throws IOException {
        return buf.readLine();

    } 
```

希望此解决方案可以帮助您了解有关猪拉丁语的更多详细信息。

# php - Koahan ORM：向多对多关系添加额外数据

> ID：14678103
> 
> 赞同：0
> 
> 时间：2013-02-03T22:30:46.267
> 
> 标签：php, kohana

`through`我使用数据透视表将我的模型设置为多对多。但是，我想在数据透视表中添加一些额外的数据。

在过去 ( `kohana 3.0`) 我能够使用 add 方法提供额外的数据

```
$obj->add('alias', $related, array('extra'=>'data')) 
```

但是在 Kohana 3.3 中，该`add`方法似乎没有为额外数据提供第三个参数，而且我似乎无法在保存后找到如何执行此操作，添加更多数据然后重新保存。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T11:23:50.360

这不再受支持，因为`Kohana 3.1`.

他们删除它的原因（来源：[http](http://dev.kohanaframework.org/issues/3754) ://dev.kohanaframework.org/issues/3754 ）：

> 我们决定删除它，因为如果您需要将数据放入数据透视表中，最好使用直通模型。直接在 add() 方法中插入数据会绕过通常在模型中的验证和过滤。如果您需要直通表中的数据，请使用模型。我们不会改变这一点。

您现在必须为数据透视表创建一个模型并将附加信息放入该模型中。

然后，`has_many "through" (n:n)`您应该使用`has_many (1:n)`两个表与数据透视表的关系而不是使用关系。

我希望这回答了你的问题。

# r - 如何提取坐标以绘制连接ggplot2中的图例键的线段？

> ID：14678107
> 
> 赞同：0
> 
> 时间：2013-02-03T22:31:13.800
> 
> 标签：r, ggplot2, data-visualization

长期以来，我一直困惑于一种简洁的方式来传达折线图中数字和分类变量之间交互的重要性（Y轴上的响应，X轴上的数字预测变量，以及分类变量的每个级别一条线在这些轴上绘制的不同颜色或图案）。我终于想到了绘制连接图例键而不是数据行的传统“括号和 p 值”的想法。

这是我的意思的模型：

```
library(ggplot2);
mydat <- do.call(rbind,lapply(1:3,function(ii) data.frame(
    y=seq(0,10)*c(.695,.78,1.39)[ii]+c(.322,.663,.847)[ii],
    a=factor(ii-1),b=0:10)));

myplot <- ggplot(data=mydat,aes(x=b,y=y,colour=a,group=a)) +
    geom_line()+theme(legend.position=c(.1,.9));

# Plotting with p-value bracket:
myplot + 
    # The three line segments making up the bracket
    geom_segment(x=1.2,xend=1.2,y=13.8,yend=13) + 
    geom_segment(x=1.1,xend=1.2,y=13,yend=13)  + 
    geom_segment(x=1.1,xend=1.2,y=13.8,yend=13.8) +
    # The text accompanying the bracket. 
    geom_text(label='p < 0.001',x=2,y=13.4); 
```

这比尝试在折线图本身的某个位置绘制括号更简洁。

问题在于`geom_segment`s 和 s的 x 和 y 值`geom_text`是通过反复试验获得的，而对于另一个数据集，这些坐标将是完全错误的。如果我正在尝试编写一个函数，其目的是自动化从模型中提取这些对比并绘制它们的过程（有点像`effects`包，但在如何表示数据方面具有更大的灵活性），那将是一个问题。

我的问题是：有没有办法以某种方式拉出包含图例的每个框的实际坐标并将它们转换为 and 使用的比例`geom_segment`，`geom_text`或者在创建`myplot`对象时手动指定每个框的坐标，或者可靠地预测各个框的位置考虑到`myplot$theme$legend.position`回报，将它们转换为情节的比例`0.1 0.9`？

我想在 ggplot2 中执行此操作，因为它健壮、优雅且非常适合我想用我的脚本做的所有其他事情。我愿意使用扩展 ggplot2 的其他软件包，我也愿意接受其他方法来直观地指示线图上的显着性水平。然而，相当于“你甚至不应该这样做”的建议并不具有建设性——因为无论我个人是否同意你的观点，我的合作者和他们的编辑都不阅读 Stackoverflow（很遗憾）。

* * *

更新：

这个问题可以简化为：如果`myplot$theme$legend.key.height`在行中并且`myplot$theme$legend.position`似乎大致在整个绘图区域的一小部分（但不完全是），我如何将它们转换为描绘 x 和 y 轴的单位，或者，将 x 和 y 轴刻度转换为 和 的`legend.key.height`单位`legend.position`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:48:58.787

我不知道你提出的问题的答案。但是，如果不太花哨的方法来传达信息，另一种绝对快速可行的方法是更改​​级别的名称，以便级别名称包含重要代码。在您的第一个示例中，您可以使用

```
levels(mydat$a) <- list("0" = "0", "1 *" = "1", "2 *" = "2") 
```

然后传说将反映这一点：

![在此处输入图像描述](../Images/038d940fba935eeecc11e19dc4b68777.png)

有了更多的关卡和重要的组合，您可能可以计算出一组符号。然后在您的图形图例中提及每组符号中反映的 p 水平。

这可能是传达信息的一种相关方式：下图由`rxnNorm`in `HandyStuff` [here](https://github.com/bryanhanson/HandyStuff)生成。不幸的是，这是另一个无法回答的问题，因为我无法使用新版本的`ggplot2`. 希望我能尽快弄清楚。 ![rxnNorm](../Images/eacdddfdfb1f1c647e05a0bec3e23697.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T01:58:29.807

我的回答不是使用`ggplot2`，而是使用`lattice` 包。`dotplot`如果我想比较连续变量和分类变量，我想这就是我会使用的。

在这里，我`dotplot`以两种方式使用，一种是我复制你的情节，另一种是

```
library(lattice)
library(latticeExtra)      ## to get ggplot2 theme

  #y versus levels of B, in different panel of A
  p1 <- dotplot(b~y|a , 
          data = mydat, 
          groups = a,
          type = c("p", "h"),
          main = "interaction between numeric and categorical variables ",
          xlab = "continuous value",
                par.settings = ggplot2like())

  #y versus levels of B , grouped by a(color and line are defined by a)
  p2 <- dotplot(b~y, groups= a , 
          data = mydat,
          type = c("l"),
          main = "interaction between numeric and categorical variables ",
          xlab = "continuous value",
                par.settings = ggplot2like())

  library(gridExtra)           ## to arrange many grid plots
   grid.arrange(p1,p2) 
```

![在此处输入图像描述](../Images/f3a76003b7b28b2436ee1bfd48e6abeb.png)

# objective-c - 带有字典的 NSSet：通过键的值获取对象

> ID：14678110
> 
> 赞同：4
> 
> 时间：2013-02-03T22:31:22.197
> 
> 标签：objective-c, nsarray, nsdictionary, enumeration, nsset

我使用 NSSet 有以下星座：

```
NSSet {
    NSDictionary {
        "Unique-Identifier-Key": Unique Value
        "Key2": ValueABC
        "Key3": ValueDEF
    }

    NSDictionary {
        "Unique-Identifier-Key": Unique Value
        "Key2": ValueFGH
        "Key3": ValueJKL
    }

    NSDictionary {
        "Unique-Identifier-Key": Unique Value
        "Key2": ValueRST
        "Key3": ValueXYZ
    }
} 
```

我正在寻找一种通过其唯一值从 NSSet 中获取一个字典的方法。该 NSSet 中有很多 NSDictionaries，因此我正在寻找性能最佳的方式。

`(NSSet *)objectsPassingTest:(BOOL (^)(id obj, BOOL *stop))predicate`按照以下方式使用怎么样？

```
NSString *idSearched = ...;
NSSet *results = [MySet objectsPassingTest:^(id obj,BOOL *stop){
    if ([obj valueForKey:@"Unique-Identifier-Key"] == idSearched) return YES;
    else return NO;
}]; 
```

这是最高效的解决方案吗？当我读到 NSSet 在查找对象方面比 NSArray 具有更好的性能时，我使用了 NSSet。而且我不需要对象的有序序列。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:37:14.137

我认为您想要的实际布局是：

```
NSDictionary {
    Unique Value: NSDictionary {
        "Key2": ValueABC
        "Key3": ValueDEF
    }

    Unique Value: NSDictionary {
        "Key2": ValueFGH
        "Key3": ValueJKL
    }

    Unique Value: NSDictionary {
        "Key2": ValueRST
        "Key3": ValueXYZ
    }
} 
```

基本上，与其将唯一键/值对存储在字典中，不如使用一个新字典，其中唯一值是其他数据的*键。*如果您的唯一值是 an`NSString`那么您会发现您可能会接近 O(1) 时间复杂度。

您可以使用以下代码将您的集合转换为上述布局：

```
NSMutableDictionary *searchable = [NSMutableDictionary dictionary];
for (NSDictionary *dict in MySet)
    [searchable setObject:dict forKey:[dict objectForKey:@"Unique-Identifier-Key"]]; 
```

（尽管将数据直接加载到上述结构中而不是从集合中转换它会更好）。然后，每当您想查找您的字典之一时：

```
NSDictionary *dict = [searchable objectForKey:idSearched]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:06:33.907

我认为当你`NSSet`这样使用它时它不会帮助你提高性能。`NSSet`由于散列算法或某些排序算法，它比 NSArray 具有更好的性能。如果您使用这样的谓词，我认为`NSSet`必须搜索整个集合才能找到您需要的项目。

我建议您创建一个新类 MyObject，其中包含您的`NSDictionary`, 并覆盖`hash`and`isEqual`

```
- (BOOL)isEqual:(id)object;
- (NSUInteger)hash; 
```

在散列中，您返回唯一值散列，这将提高您的性能。但是，如果您需要搜索的对象很少，您可以只使用简单的谓词

# recursion - Scheme 中的递归（或 while 循环）

> ID：14678115
> 
> 赞同：3
> 
> 时间：2013-02-03T22:31:57.127
> 
> 标签：recursion, while-loop, scheme

```
(define (orderedTriples n)
(set! i n)
(set! j n)
(set! k n)
(while (>= i 0)
   (while (>= j 0)
     (while (>= k 0)
       (printf "(~a, ~a, ~a)" i j k) 
       (set! k (- k 1))) 
     (set! j (- j 1))) 
  (set! i (- i 1)))) 
```

所以我的问题是......我对如何使 while 循环在方案中工作感到困惑（我对此很陌生，所以如果我离开了，请原谅语法）。我在这里输入 while 只是为了解决问题并展示我想要完成的工作。谁能帮我一个简单的递归示例或嵌套递归？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:24:57.320

根据使用的 Scheme 解释器，有几种方法可以实现所需的循环。例如，在 Racket 中，它就像使用[迭代和](http://docs.racket-lang.org/guide/for.html)推导一样简单：

```
(define (orderedTriples n)
  (for* ([i (in-range n -1 -1)]
         [j (in-range n -1 -1)]
         [k (in-range n -1 -1)])
    (printf "(~a, ~a, ~a)" i j k))) 
```

问题中显示的编程风格（假设它有效）在Scheme中非常不鼓励 - 使用突变（`set!`操作）进行循环是一个很大的禁忌，这就是你用类C语言解决问题的方式，但是特别是在 Scheme 中（以及在一般的 Lisp 中）还有其他用于在程序中实现迭代的构造（`do`例如，@TerjeD 给出的解决方案演示了 的使用），即使这样的构造不存在，递归解决方案或者使用[更高阶程序](http://en.wikipedia.org/wiki/Higher-order_function)的解决方案将是首选。例如，这是另一种可能的解决方案，使用仅具有标准过程的[嵌套映射](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-15.html#%_sec_2.2.3)（除了`printf`，它是非标准的）：

```
(define (range n)
  (if (negative? n)
      '()
      (cons n (range (- n 1)))))

(define (orderedTriples n)
  (for-each (lambda (i)
              (for-each (lambda (j)
                          (for-each (lambda (k)
                                      (printf "(~a, ~a, ~a)" i j k))
                                    (range n)))
                        (range n)))
            (range n))) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:03:10.957

您可以使用`do`这样编写的循环（用于函数的内部循环）：

```
(do ((k n (- k 1)))               ; variable, initialization, and updating form
   ((< k 0))                      ; stop condition, and optionally return value
  (printf "(~a, ~a, ~a)" i j k))  ; body forms 
```

有关迭代构造的更多信息，请参见[http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-ZH-7.html#%_idx_138 。](http://www.schemers.org/Documents/Standards/R5RS/HTML/r5rs-Z-H-7.html#%_idx_138)`do`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T10:01:47.937

如果必须，您可以使用递归来做到这一点。

```
(define (ordered-triples n)
  (let iloop ((i n))
    (unless (negative? i)
      (let jloop ((j n))
        (unless (negative? j)
          (let kloop ((k n))
            (unless (negative? k)
              (printf "~a ~a ~a\n" i j k)
              (kloop (sub1 k))))
          (jloop (sub1 j))))
      (iloop (sub1 i))))) 
```

当然，使用 Racket 的`for*`循环更容易。

# ios - performSelector:withObject:afterDelay: 不接受我的自定义 UIImageView 指针，为什么不呢？

> ID：14678128
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:33:13.023
> 
> 标签：ios, objective-c, pointers, performselector

好的，伙计们......希望这将是另一个快速的。

我有一个类 MonsterView，扩展 UIImageView，扩展 NSObject。

我已经声明了一个名为 myMonster 的 MonsterView 指针，它包含一个 MonsterView 类的对象，看起来像这样......

```
MonsterView* myMonster = [monsterArray objectAtIndex:0]; 
```

现在指针 myMonster 指向 MonsterView 类的对象。

我有这样的方法：

```
-(void) takeTurnHostile:(MonsterView*) monster
{
     // Do Stuff
} 
```

我想通过使用 performSelector 来调用这个方法......像这样：

```
[self performSelector:@selector(takeTurnHostile) withObject:myMonster afterDelay:0.1]; 
```

该死的机器不会有这种废话。为什么以所有美好和神圣的名义，我不能这样做？

更重要的是，我怎么 - 可以 - 我这样做？

多谢你们！J-摇滚

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T22:34:56.333

```
@selector(takeTurnHostile) 
```

应该

```
@selector(takeTurnHostile:) 
```

因为您的选择器带有一个参数，而冒号是选择器名称的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:35:01.660

选择器中缺少冒号...

```
[self performSelector:@selector(takeTurnHostile:) withObject:myMonster afterDelay:0.1]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T22:35:08.073

它应该是`@selector(takeTurnHostile:)`。你忘记了冒号

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T22:46:36.697

正如 H2CO3 所说，您必须提供冒号：

```
takeTurnHostile: 
```

冒号表示您正在调用的方法有 1 个参数。当前没有冒号，您要运行该方法：

```
-(void) takeTurnHostile
{
} 
```

# python - Python 十六进制

> ID：14678132
> 
> 赞同：79
> 
> 时间：2013-02-03T22:33:29.560
> 
> 标签：python, hex

如何以以下格式将十进制转换为十六进制（至少两位，零填充，不带 0x 前缀）？

输入：`255` 输出：`ff`

输入：`2` 输出：`02`

我试过`hex(int)[2:]`了，但它似乎显示了第一个例子而不是第二个例子。

* * *

## 回答 #1

> 赞同：154
> 
> 时间：2013-02-03T22:34:37.503

使用带有格式的[`format()`函数。](http://docs.python.org/2/library/functions.html#format)`'02x'`

```
>>> format(255, '02x')
'ff'
>>> format(2, '02x')
'02' 
```

该`02`部分告诉`format()`使用至少 2 位数字并使用零将其填充到长度，`x`表示小写十六进制。

[*格式规范迷你语言*](https://docs.python.org/2/library/string.html#formatspec)还为您提供`X`了大写十六进制输出，您可以在字段宽度`#`前加上`0x`or`0X`前缀（取决于您使用`x`或`X`作为格式化程序）。只需考虑您需要调整字段宽度以允许额外的 2 个字符：

```
>>> format(255, '02X')
'FF'
>>> format(255, '#04x')
'0xff'
>>> format(255, '#04X')
'0XFF' 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-03T22:58:20.570

我认为这就是你想要的：

```
>>> def twoDigitHex( number ):
...     return '%02x' % number
... 
>>> twoDigitHex( 2 )
'02'
>>> twoDigitHex( 255 )
'ff' 
```

* * *

## 回答 #3

> 赞同：-8
> 
> 时间：2014-10-01T18:47:41.340

另一种解决方案是：

```
>>> "".join(list(hex(255))[2:])
'ff' 
```

可能是一个古老的答案，但很实用。

# php - MySQL 计算出多列中的最低值

> ID：14678138
> 
> 赞同：3
> 
> 时间：2013-02-03T22:33:50.607
> 
> 标签：php, mysql

我有一张桌子，上面有以下内容：

```
+----+-------+-------+-----------+-----------+--------------+--------------+
| id | stock | price | usedStock | usedPrice | specialStock | specialPrice |
+----+-------+-------+-----------+-----------+--------------+--------------+
| #1 |     1 | 10.00 |         0 | 0         |            0 | 0            |
| #2 |     0 | 0     |         1 | 15.00     |            1 | 20.00        |
| #3 |     0 | 0     |         0 | 11.00     |            1 | 14.00        |
+----+-------+-------+-----------+-----------+--------------+--------------+ 
```

如果商品类型有库存，我想创建一个查询，首先按最低价格订购。

因此查询将产生以下顺序：

```
#1 - 10.00 (because 10.00 is the lowest result)
#3 - 14.00 (because although 11.00 is less, it's not in stock)
#2 - 15.00 (because 15.00 is lower than 20.00) 
```

我已经在这个问题中添加了 PHP 标记，以防在选择表格后使用 PHP 进行更快的计算。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:52:45.270

我会先创建一个视图

```
CREATE VIEW stock_min_price AS
SELECT id, LEAST(IF(stock > 0, price, 1000000000),
    IF (usedStock > 0, usedPrice, 10000000000),
    IF (specialStock > 0, specialPrice, 10000000000)) AS actualPrice
FROM tablename; 
```

然后按所有商品的实际价格选择和订购

```
SELECT id, IF(actualPrice = 1000000000, NULL, actualPrice) AS price
FROM stock_min_price
ORDER BY actualPrice 
```

//编辑：当库存可以大于1时比较> 0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:58:48.853

如果商品有库存，我会以最低价格订购：

```
ORDER BY
  LEAST(CASE WHEN stock        THEN price        ELSE GREATEST(price, usedPrice, specialPrice) END,
        CASE WHEN usedStock    THEN usedPrice    ELSE GREATEST(price, usedPrice, specialPrice) END,
        CASE WHEN specialStock THEN specialPrice ELSE GREATEST(price, usedPrice, specialPrice) END) 
```

如果条件为真（>=1），每个CASE WHEN都会返回价格，否则返回最大的价格。[在这里](http://sqlfiddle.com/#!2/a693b)拉小提琴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T01:15:15.637

坦率地说，您应该重新考虑针对这种操作的数据建模。这三种股票之间没有直接联系，因此您确实应该将它们标准化为另一个表。为此，我将假设您的旧表名为*oldTable*

```
 CREATE TABLE stock(item_id integer, amount integer, price double, type enum('normal', 'used', 'special'));

    INSERT INTO stock SELECT o.id, o.stock, o.price,'normal' FROM _oldTable as o 
    WHERE o.stock >0 OR o.amount >0 ;

    INSERT INTO stock SELECT o.id, o.usedStock, o.usedPrice, 'used' FROM _oldTable as o
    WHERE o.stock >0 OR o.amount >0 ;

    INSERT INTO stock SELECT o.id, o.specialStock, o.specialPrice,'special' FROM _oldTable as o
    WHERE o.stock >0 OR o.amount >0 ; 
```

你有它。如您所见，您现在基本上可以通过简单`join`的库存表获取您的信息。

```
 SELECT o.id, s.kind, min(s.price) FROM _oldTable_ AS o 
    JOIN stock as s ON s.item_id = o.id AND s.amount > 0
    GROUP BY s.item_id 
```

如果你想产生一个像你原来的表一样的输出，你可以使用：

```
 SELECT o.id, n.amount as amount, n.price as price, u.amount as usedAmount, u.price as usedPrice, s.amount as specialAmount, s.price as specialPrice
    FROM _oldTable_ AS o 
    LEFT JOIN stock as n ON n.item_id = o.id AND n.type = 'normal'
    LEFT JOIN stock as u ON u.item_id = o.id AND n.type = 'used'
    LEFT JOIN stock as s ON s.item_id = o.id AND n.type = 'special'; 
```

现在也更容易 a) 获取每个库存的总金额（金额列上的总和，带有`GROUP BY`item_id 的声明）b) 获取使用的库存类型。

ps：`item_id`如果你有很多项目，你可能应该在列上设置一个索引。另请注意，如果并非所有项目都有各种库存，此解决方案可能会为您节省磁盘空间

# mysql - 将 SQL 结果格式化为总和

> ID：14678140
> 
> 赞同：2
> 
> 时间：2013-02-03T22:34:17.370
> 
> 标签：mysql, sql

这是我用来从三个不同的“地址”收集每日值的查询，这些地址引用了我们系统中的不同传感器。

```
SELECT DISTINCT
    LEFT(changes.date_time, 6) AS 'date',
    changes.address AS 'address',
    (CASE WHEN changes.address IN (18) THEN - MAX(changes.value * types.multiplier) ELSE MAX(changes.value * types.multiplier) END) AS 'value'
FROM sensor.changes
INNER JOIN sensor.types ON changes.type = types.idx
WHERE
    changes.address IN (1, 4, 8)
    AND changes.date_time >= '12110100000000'
    AND changes.date_time <= '13050100000000'
GROUP BY LEFT(changes.date_time, 6),
    changes.address
ORDER BY changes.idx; 
```

第一个日期包含以下值，随后的日期带有相同的地址：

```
date   address value
130203 1        0.0160
130203 4        0.1220
130203 8       -0.0070 
```

我想将这三个值（地址 1+4+8）组合成该日期的一行。我已尝试对“值”列进行 SUM，但这会导致 SQL 错误：`#1111 - Invalid use of group function`. 取出第二个 GROUP BY 列会在每个日期产生一个值，但该值不是这些值的总和。使用第二个查询来格式化结果是可以的，但我希望在第一个查询中完成数学运算，因为数据库服务器不是本地的。

编辑：澄清我需要的结果：

```
date   address value
130203 1       0.131 
```

在这种情况下，列下的整数`address`无关紧要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:39:37.043

您应该添加一个分组子句。

```
SELECT Resdate,SUM(Res.address),SUM(Res.value)
FROM
(
SELECT DISTINCT
    LEFT(changes.date_time, 6) AS 'date',
    changes.address AS 'address',
    (CASE WHEN changes.address IN (18) THEN - MAX(changes.value * types.multiplier) ELSE MAX(changes.value * types.multiplier) END) AS 'value'
FROM sensor.changes
INNER JOIN sensor.types ON changes.type = types.idx
WHERE
    changes.address IN (1, 4, 8)
    AND changes.date_time >= '12110100000000'
    AND changes.date_time <= '13050100000000'
GROUP BY LEFT(changes.date_time, 6),
    changes.address
ORDER BY changes.idx
) AS Res
GROUP BY Res.Date 
```

# javascript - Array() 中的 getElementById() 正在覆盖数组中的其他元素

> ID：14678142
> 
> 赞同：0
> 
> 时间：2013-02-03T22:34:19.450
> 
> 标签：javascript, html, google-chrome, multidimensional-array, getelementbyid

我觉得这应该有一个非常简单的答案，但我仍然摸不着头脑，谷歌也没有帮助。我正在尝试将有关元素的信息存储在数组中。但是在 Google Chrome 中，当我设置有关第二个元素的信息时，它会覆盖第一个元素。这是代码的简化版本：

```
<!DOCTYPE HTML>
<html>
  <head>
    <script>
      var $box = new Array();
      $box['test'] = new Array();
      function load(){
        $box['test'][document.getElementById('box')] = true;
        $box['test'][document.getElementById('boxinfo')] = false;

        console.log('box: ' + $box['test'][document.getElementById('box')]);                // box: false      // Should be true
        console.log('boxinfo: ' + $box['test'][document.getElementById('boxinfo')]);        // boxinfo: false  // Should be false
        console.log(document.getElementById('box') == document.getElementById('boxinfo'));  // false           // Should be false
      }
    </script>
  </head>
  <body onload="load();">
    <div id="box">
      <div id="boxinfo">BoxInfo</div>
      Box
    </div>
  </body>
</html> 
```

我怎样才能做到这一点

```
$box['test'][document.getElementById('box')]          // is true
$box['test'][document.getElementsByTagName('div')[0]] // is true
$box['test'][document.getElementById('boxinfo')]      // is false 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:38:51.113

做的时候

```
foo[ bar ] = someValue; 
```

`bar`转换为*字符串*值，然后用作属性名称（正在分配给它）。在您的情况下，您的 DOM 元素被转换为字符串，如`'[object HTMLDivElement]'`. 如果您的两个元素都是 DIV，它们将被转换为相同的*字符串*值，这就是为什么第二个赋值会覆盖第一个，即两个赋值都分配给相同的属性。

您要实现的目标不能用简单的数组来实现。

# mysql - Java EE 数据库瓶颈 - 缓存

> ID：14678144
> 
> 赞同：0
> 
> 时间：2013-02-03T22:34:21.910
> 
> 标签：mysql, jakarta-ee, caching, jboss, infinispan

我正在编写一个应用程序，它通过 gui 读取文件，将其转换为不同的格式，将两个文件保存在 MySQL DB 中，并将转换后的文件作为下载选项提供给用户。

我想知道可以使用哪些缓存技术/设计模式来缓解这种潜在的瓶颈。例如，在转换后立即缓存两个文件（@CacheResult ？）并尽快将缓存的文件返回给用户，然后才将文件保存到 DB。

我正在使用 JBoss 并且可以使用 Infinispan 进行缓存。我猜这种用例必须有既定的模式，我只是不知道它们是什么！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:45:36.937

你的瓶颈在于写入，而不是读取。

您的操作系统将缓存文件供您阅读。缓存的唯一原因是如果您想更好地控制缓存文件的生命周期，而不是依赖于固有的文件系统缓存。

至于写入，您可以简单地转换为内存，然后稍后在后台将其保存到磁盘。但是你没有 ACIDity 那样做——失去系统，你失去了转换和原始数据。

真正的解决方案是在后端拥有不错的 I/O，例如高端 SAN/NAS 设备或简单的现代 SSD。

# c++ - 将文件中的值存储到数组中并根据特定数字提取值

> ID：14678145
> 
> 赞同：0
> 
> 时间：2013-02-03T22:34:22.623
> 
> 标签：c++

文件.txt

```
0 00 19
0 200 699
0 7000 8499
0 85000 89999
0 900000 949999
0 9500000 9999999
1 00 09
1 100 399
1 4000 5499
1 55000 86979
1 869800 998999
1 9990000 9999999
2 00 19
2 200 349
2 35000 39999
2 495 699
2 7000 8399
2 84000 89999
2 900000 949999
2 9500000 9999999
3 00 02
3 030 033
3 0340 0369
3 03700 03999
3 04 19
3 200 699
3 7000 8499
3 85000 89999
3 900000 949999
3 9500000 9999999 
```

假设我只想要第一个值所在的块，`3`我怎样才能只将以下内容存储到三个单独的数组中：

```
3 00 02
3 030 033
3 0340 0369
3 03700 03999
3 04 19
3 200 699
3 7000 8499
3 85000 89999
3 900000 949999
3 9500000 9999999 
```

我到目前为止：

```
while (finished != EOF){
    finished = fscanf(fp,"%d %s %s\n", &areaScanned, &pubLow, &pubHigh);
} 
```

这很好用，但它存储了整个列表。我怎样才能缩小范围？基本上我需要做的是检查某个数字是否介于第 1 行、第 1 列和第 2 列之间、第 2 行、col1 和 col2 之间的值、第 3 行、col1 和 col2 之间的值等之间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:44:06.230

首先，您可能不想使用`fscanf`. 其次，你几乎肯定不想使用三个单独的数组，如果你能提供帮助的话。如果可能的话，你想要这样的东西：

```
struct whatever { 
    int a, b, c;

    friend std::istream &operator>>(std::istream &is, whatever &w) { 
        return is >> w.a >> w.b >> w.c;
    }
};

std::vector<whatever> w;

std:copy_if(std::istream_iterator<whatever>(infile),
            std::istream_iterator<whatever>(),
            std::back_inserter(w),
            [](whatever const &w) { return w.a == 3; } ); 
```

# css - 居中对齐应用了额外字母间距的文本

> ID：14678154
> 
> 赞同：5
> 
> 时间：2013-02-03T22:35:00.927
> 
> 标签：css, alignment

将一些增加的文本居中对齐`letter-spacing`以使其实际上位于其容器的中心的最佳方法是什么？文本位于一个`h5`标签中，该标签在父级中居中对齐，`div`但明显位于左侧，因为`letter-spacing`适用于每个字母的右侧。我可以手动添加一些左填充，但如果浏览器缩放级别发生更改，则不会保持一致。

**有没有办法使用 css 或 JavaScript 计算每个字母之间的间距？有没有更好的方法在字母之间插入间距，以便所有内容都居中对齐？**

容器 div 已经`20px`在所有边都有填充，所以我真的需要添加`0.75em`到左侧填充。这是`h5`和容器标签的相关css：

```
.container {
    padding: 20px;
    float: left;
}

.container h5 {
    font-size: 33px;
    letter-spacing: 1.5em;
    text-align: center;
} 
```

容器如下所示：

![容器](../Images/ac42d9be1e5105e5e6412c58ffbab39c.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:54:10.177

你不能只指定`padding-left: 1.5em;`你的`.container h5`吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T23:05:59.097

替代解决方案可能是指定`margin-right: -1.5em;`for `.container h5`，因此在对齐时您不会在容器中添加额外空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-11T04:02:10.223

它很旧，但另一个解决方案（技巧）是在字符之间添加一个空格。对我来说，这是最好的解决方案，因为我想要角色之间有很大的空间；）

# c++ - 为 GCC 使用 AT&T 内联汇编程序

> ID：14678156
> 
> 赞同：2
> 
> 时间：2013-02-03T22:35:04.437
> 
> 标签：c++, c, assembly, x86, inline-assembly

我正在编写一个简单但有点具体的程序：

**目的：**从它的阶乘计算数字
**要求：**所有计算必须在 gcc 内联 asm 上完成（at&t 语法）

源代码：

```
#include <iostream>

int main()
{
        unsigned n = 0, f = 0;

        std::cin >> n;

        asm
        (
                "mov %0, %%eax \n"
                "mov %%eax, %%ecx \n"
                "mov 1, %%ebx \n"
                "mov 1, %%eax \n"
                "jmp cycle_start\n"
                "cycle:\n"
                "inc %%ebx\n"
                "mul %%ebx\n"
                "cycle_start:\n"
                "cmp %%ecx, %%eax\n"
                "jnz cycle\n"
                "mov %%ebx, %1 \n":

                "=r" (n):
                 "r" (f)

       );

       std::cout << f;

       return 0;
} 
```

此代码导致 SIGSEV。

英特尔 asm 语法（[http://pastebin.com/2EqJmGAV](http://pastebin.com/2EqJmGAV)）上的相同程序运行良好。为什么我的“AT&T 计划”失败了，我该如何解决？

```
#include <iostream>

int main()
{
   unsigned n = 0, f = 0;

   std::cin >> n;

   __asm
   {
      mov eax, n

      mov ecx, eax
      mov eax, 1
      mov ebx, 1
      jmp cycle_start

      cycle:

      inc ebx
      mul ebx

      cycle_start:

      cmp eax, ecx
      jnz cycle

      mov f, ebx
   };
   std::cout << f;

   return 0;
} 
```

UPD：推入堆栈并恢复使用过的寄存器会产生相同的结果：SIGSEV

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T22:49:12.797

您的输入和输出方式错误。

所以，从改变开始

```
 "=r" (n):
             "r" (f) 
```

至：

```
 "=r" (f) :
             "r" (n) 
```

然后我怀疑你会想告诉编译器关于clobbers（你正在使用的不是输入或输出的寄存器）：

所以添加：

```
 : "eax", "ebx", "ecx" 
```

在上面的两行之后。

我个人会做一些其他的改变：

1.  使用本地标签（`1:`等`2:`），这允许在没有“重复标签”的情况下复制代码。
2.  使用`%1`而不是`%%ebx`- 这样，您就不会使用额外的寄存器。
3.  直接移动`%0`到`%%ecx`。您稍后将加载`1`到`%%eax`两个指令中，那么它有什么用途`%%eax`呢？

【现在，我写的太多了，别人先回答了……】

编辑：而且，正如 Anton 指出的那样，您需要`$1`加载常量 1，`1`即从地址 1 读取，这不能很好地工作，并且很可能是您的问题的原因

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:47:49.443

希望没有要求只使用 gcc 内联 asm 来解决它。您可以使用 翻译您的 AT&T 示例`nasm`，然后使用反汇编`objdump`并查看正确的语法。

我似乎记得如果您的意思是字面常量而不是内存引用，那`mov 1,%eax`应该是。`mov $1,%eax`

@MatsPetersson 的回答对于您的内联程序集与编译器（破坏/输入/输出寄存器）的交互非常有用。我专注于你得到的原因`SIGSEGV`，阅读地址`1`确实回答了这个问题。

# node.js - express.js app.get('/images/1.gif' ... 问题

> ID：14678166
> 
> 赞同：0
> 
> 时间：2013-02-03T22:35:38.620
> 
> 标签：node.js, express, nowjs-sockets

我有以下代码，它是我正在尝试构建的快速应用程序的一部分：

```
app.get('/stat/1.gif', function( req, res ) {
    var time = +new Date();
    var origin;
    res.writeHead(200, {'Content-Type': 'image/gif'});
    origin = /\/(.*)\.gif/.exec(req.url);
    console.log(origin);
    if (origin) {
        var ip = req.ip;
        if (ip === null || ip === "127.0.0.1") {
            ip = "82.246.239.187";
        }
        location = geoip.lookup(ip);
        console.log(location);
        var obj;
        console.log(location.city);
        console.log(location.ll[1]);
        console.log(location.ll[0]);
        obj = {
            city: location.city
            ,longitude: location.ll[1]
            ,latitude: location.ll[0]
            ,ip: ip
            ,timestamp: time
        };
        console.log(obj);
    everyone.now.receiveLocation(obj);
    } else {
        console.log( 'fixme no origin' );
    }
}); 
```

看着我作为 obj 得到的 console.log()

```
{ city: 'Nîmes',
  longitude: 4.3596,
  latitude: 43.8338,
  ip: '82.246.239.187',
  timestamp: 1359930392288 } 
```

但我不断收到此错误：

```
TypeError: Property 'receiveLocation' of object #<Object> is not a function
    at /Users/khinester/Documents/Tutorials/Node/Blade/server.js:188:18
    at callbacks (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/lib/router/index.js:161:37)
    at param (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/lib/router/index.js:135:11)
    at pass (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/lib/router/index.js:142:5)
    at Router._dispatch (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/lib/router/index.js:170:5)
    at Object.router (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/lib/router/index.js:33:10)
    at next (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/node_modules/connect/lib/proto.js:199:15)
    at resume (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/node_modules/connect/lib/middleware/static.js:60:7)
    at SendStream.error (/Users/khinester/Documents/Tutorials/Node/Blade/node_modules/express/node_modules/connect/lib/middleware/static.js:73:37)
    at SendStream.EventEmitter.emit (events.js:115:20) 
```

我正在使用[https://github.com/bluesmoon/node-geoip](https://github.com/bluesmoon/node-geoip)

我正在使用带有以下代码的[https://github.com/kuno/GeoIP ：](https://github.com/kuno/GeoIP)

```
app.get('/stat/1.gif', function( req, res, next ) {
    var time = +new Date();
    var origin;
    res.writeHead(200, {'Content-Type': 'image/gif'});
    origin = /\/(.*)\.gif/.exec(req.url);
    if (origin) {
        var ip = req.headers['x-real-ip'];
        if (ip === null || ip === "127.0.0.1") {
            ip = "82.246.239.187";
        }
        city.lookup(ip, function(err, location) {
            var obj;
            if ( !err && location ) {
                obj = {
                    city: location.city
                    ,longitude: location.longitude
                    ,latitude: location.latitude
                    ,ip: ip
                    ,timestamp: time
                };
            } else { 
                console.log( 'server fake location' );
                obj ={ 
                    city: 'Bexleyheath',
                    longitude: 0.15000000596046448,
                    latitude: 51.45000076293945,
                    ip: '86.173.61.119',
                    timestamp: 1343054092459 
                };
            }
            everyone.now.receiveLocation(obj);
            console.log(obj);
        });
    console.log(origin[1], req.connection.remoteAddress, req.headers['user-agent']);
    } else {
        console.log( 'fixme no origin' );
    }
}); 
```

这工作正常，但我需要使用 geoip-lite 作为我想要加热的主机这没有 geoip c 库。

非常感谢任何建议。

# mysql - Codeigniter 复杂的 MySQL 查询 - 删除反引号 - 这是一个安全问题吗？

> ID：14678168
> 
> 赞同：1
> 
> 时间：2013-02-03T22:35:48.150
> 
> 标签：mysql, codeigniter, backticks

我正在尝试通过检查几个不同的数据库字段来构建一个 MySQL 查询以返回适当的搜索结果。例如，如果用户搜索“plumber leeds”，如果企业在“city”字段中有“leeds”，并且名称中包含“plumber”一词，我希望返回该搜索结果。

用户搜索可能包含多个单词并且是不可预测的。我目前正在通过扩展搜索词、修剪它并使用它来编译复杂的搜索查询以返回所有相关结果来实现我所需要的。

我将这个复杂的查询存储在一个变量中，并使用 Codeigniter 的 Active Record 来运行查询。

```
$this->db->where($compiled_query, null, false); 
```

我担心的是我没有用反引号保护查询，我不确定这是否是一个安全问题。我启用了 XSS Clean 但仍然不确定这是否可以。

根据 CI 的用户手册： $this->db->where() 接受可选的第三个参数。如果您将其设置为 FALSE，CodeIgniter 将不会尝试使用反引号保护您的字段或表名。

来源：[http ://ellislab.com/codeigniter/user-guide/database/active_record.html](http://ellislab.com/codeigniter/user-guide/database/active_record.html)

关于我如何在一个单独的问题中编译查询的一些信息。我知道 mysql_real_escape_string 即将被弃用并且不是包罗万象的，因此我对此方法的部分担忧。

[https://stackoverflow.com/questions/13321642/codeigniter-active-record-sql-query-of-multiple-words-vs-multiple-database-fi](https://stackoverflow.com/questions/13321642/codeigniter-active-record-sql-query-of-multiple-words-vs-multiple-database-fi)

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:56:17.827

反引号与安全无关。它们实际上只是一种“字符串化”您的字段和表名的方法，这样您就可以使用名为`datatype`example 的字段而不会与 mysql 关键字发生冲突

你很安全

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T01:28:09.107

我不会说你是绝对“安全的”，因为如果你在 SQL 查询中接受用户输入，你在技术上永远不会安全（即使你已经操纵了它......只要有意愿，就有办法）。

一旦放弃对应用程序的控制权，就必须非常小心处理这些数据的方式，以免让自己面临注入攻击。

XSS Clean 将帮助处理`POST`cookie 数据——它不会在`GET`变量上自动运行。`$data = $this->security->xss_clean($data);`如果它来自`GET`数组，我会手动运行输入。

# r - 将推特结果转换为数据框

> ID：14678172
> 
> 赞同：0
> 
> 时间：2013-02-03T22:36:11.053
> 
> 标签：r, twitter

我有一个简单的 for 循环，可以将过去 100 条用户名的推文写入 .csv 文件：

```
library(twitteR)
mclist <- read.table('usernames.txt')

for (mc in mclist) 
{
    tweets <- userTimeline(mc, n = 100)

    df <- do.call("rbind", lapply(tweets, as.data.frame))

    write.csv(df, file=paste("Desktop/", mc, ".csv", sep = ""), row.names = F)
} 
```

我主要遵循我在 StackOverflow 上阅读的内容，但我继续收到此错误消息：

```
Error in file(file, ifelse(append, "a", "w")) : 
  invalid 'description' argument
In addition: Warning message:
In if (file == "") file <- stdout() else if (is.character(file)) { :
  the condition has length > 1 and only the first element will be used 
```

我哪里做错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T01:41:54.617

我只是稍微清理了代码，一切都开始工作了。

**第 1 步**：让我们设置工作目录并加载“twitteR”包。

```
library(twitteR)
setwd("C:/Users/Dinre/Desktop") # Replace with your desired directory 
```

**第 2 步**：首先，我们需要从纯文本文件中加载用户名列表。我假设文本文件中的每一行都有一个用户名，如下所示：

```
[contents of usernames.txt]
edclef
notch
dkanaga 
```

让我们使用 'scan' 函数加载它，将每一行读入一个数组：

```
mclist <- scan("usernames.txt", what="", sep="\n") 
```

**第 3 步**：我们将遍历用户名，就像您之前所做的那样，但我们不会引用目录，因为我们将使用相同的目录作为输出作为输入。原始代码在尝试引用桌面目录时出现语法错误，我们将避开它。

```
for (mc in mclist){
    tweets <- userTimeline(mc, n = 100)
    df <- do.call("rbind", lapply(tweets, as.data.frame))
    write.csv(df, file=paste(mc, ".csv", sep = ""), row.names = F)
} 
```

我最终在桌面上得到了三个文件，所有数据似乎都是正确的。

```
edclef.csv
notch.csv
dkanaga.csv 
```

**更新**：如果您真的想在代码中引用不同的目录，请使用“。” 字符来引用父目录。例如，如果您的工作目录是您的 Windows 用户配置文件，您可以像这样引用“桌面”文件夹：

```
setwd("C:/Users/Dinre")
...
write.csv(df, file=paste("./Desktop/". mc, ".csv", sep = ""), row.names = F) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T20:22:48.053

*twListToDF*包中有一个便利函数，它将处理推文列表到 data.frame 的转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T01:05:45.510

由于您的 mclist 是 a `data.frame`，您可以将您`for`的替换为`apply`

```
apply( mclist, 1,function(mc){
  tweets <- userTimeline(mc, n = 100)
  df <- do.call("rbind", lapply(tweets, as.data.frame))
  write.csv(df, file=paste("Desktop/", mc, ".csv", sep = ""), ##!! Change Desktop to  
                                                              ## something like Desktop/tweets/
            row.names = F)
}) 
```

PS：

> userTimeline 函数仅在请求的用户具有公共时间线或您之前使用 registerTwitterOAuth 注册了 OAuth 对象时才有效

# c# - 通过 *.js 加载 Javascript 然后调用 JavaScript 函数

> ID：14678176
> 
> 赞同：0
> 
> 时间：2013-02-03T22:36:41.567
> 
> 标签：c#, javascript, browser

我已经做了很多阅读，但我不明白为什么这不起作用。我正在使用带有当前更新的 VS2010。我想将网页加载到 C# Web 浏览器控件中（此应用程序是 Windows 窗体应用程序）：

```
this.webBrowser1.Navigate("https://mydomain/L1/L2/L3/L4/webpage.asp");
this.webBrowser1.PerformLayout(); 
```

据我了解，要从 C# 调用 Javascript 函数，可以使用：

```
this.webBrowser1.Document.InvokeScript("passwordReset"); 
```

或者如果有参数要传递：

```
object[] parameters = new object[3];
parameters[0] = “1”;
parameters[0] = false;
parameters[0] = “3”;

webBrowser1.Document.InvokeScript("passwordReset", parameters); 
```

我的网页代码如下。我已经展示了我尝试过的两种方法。如果我将 Javascript 插入页面，一个似乎可行。

由于我的限制，我不想使用这种方法。我需要能够调用 *.js 文件，如下所示：

```
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>My Test Page...</title>

<script type="text/javascript" language="javaScript"> 
function passwordReset()
{
alert("You're about to change your password!!");
}
</script>

<script type="text/javascript" src="/L1/L2/Password_Reset.js"></script>

</head> 
```

请注意，我没有同时在我的页面中包含两个 Javascript。我在这个例子中只包括了两者。

有人可以解释为什么这个方法在调用“Password_Reset.js”文件中的函数时不能按预期工作吗？

我尝试设置完全权限：[PermissionSet(SecurityAction.Demand, Name = "FullTrust")]

并且还使这个应用程序 Com 可见：[System.Runtime.InteropServices.ComVisibleAttribute(true)]

编辑：我想要实现的是能够在 webBrowser1.Navigate("URL"); 之后运行 Javascripts。当它们被写入页面代码时，如下所示：

```
<script type="text/javascript" src="/L1/L2/Password_Reset.js"></script> 
```

编辑：在重新阅读我的问题时，我想知道这个问题是否是文件夹级别的问题并且脚本没有加载？有人可以就此提出建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:45:23.093

我不确定您要完成什么。

不过，我建议你看一下启动脚本注册方法。如果你使用它们，一个 JavaScript 函数将在 html 文档加载后在客户端浏览器中执行。

看看[这篇](http://msdn.microsoft.com/en-us/library/asz8zsxy.aspx)文章。也许你可以用它来解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T09:08:38.237

最后，解决方案非常简单，而且有点明显。我有点尴尬。

浏览器控制文档完成后：

```
webBrowser1.DocumentCompleted +=new WebBrowserDocumentCompletedEventHandler(webBrowserTest_DocumentCompleted); 
```

事件已被调用，何时：

```
webBrowser1.PerformLayout(); 
```

已经运行，Javascripts，在这个阶段还没有完全加载，我可以看到。如果我设置一个延迟计时器并计算 1000 毫秒，然后调用我的 Javascript，那么整个事情就可以完美运行。除非通过延迟对我的 javascript 的调用，反过来允许后台的另一个问题自行解决？

我想接下来要解决的问题是，为什么 DocumentCompleted 事件处理程序不包括以人们期望的方式加载脚本。

我希望其他人发现这很有用，并且可以节省我花在解决这个问题上的时间。

# java - 将按钮禁用属性绑定到 fxml 中的树视图选择

> ID：14678177
> 
> 赞同：3
> 
> 时间：2013-02-03T22:36:44.560
> 
> 标签：java, binding, javafx, fxml

我仅在 fxml 中找不到任何简单绑定的示例。

如果在树视图上选择了一个项目，我想启用/禁用按钮。

我试过这段代码（标签用于测试绑定）：

```
<Scene xmlns:fx="http://javafx.com/fxml">
  <BorderPane>
    <top>
      <Button text="test" disable="${treeView.selectionModel.selectedItem.isNull}" />
    </top>
    <center>
      <TreeView fx:id="treeView" />
    </center>
    <bottom>
      <Label text="${treeView.selectionModel}" />
      <Label text="${treeView.selectionModel.selectedItem.isNull}" />
    </bottom>
  </BorderPane>
</Scene> 
```

此代码不会产生错误。

第一个标签显示 treeView 的选择模型`toString()`。
第二个标签不显示任何内容，但应显示 true 或 false。
该按钮应启用和禁用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T19:44:08.557

从代码中，您可以执行以下操作：

```
treeview.getSelectionModel().selectedIndexProperty().addListener(new ChangeListener<Number>()
    {
        @Override
        public void changed(ObservableValue<? extends Number> observable, Number oldValue, Number newValue)
        {
            if (newValue.intValue() > 0)
                button.setDisable(true);
            else
                button.setDisable(false);
        }
}); 
```

# jquery - jQuery ajax 发送 json 并返回 html

> ID：14678187
> 
> 赞同：7
> 
> 时间：2013-02-03T22:37:41.070
> 
> 标签：jquery

我想使用参数执行 ajax 调用。如果可能的话，我想将参数作为 json 或文本发送。

结果以 html 内容类型返回。

所以这就是我尝试过的

```
 var data2 = {
      'some-id': 5
  };

  $.ajax({
        type: "POST",
        url: /* some url */,
        data: JSON.stringify(data),
        dataType: 'json',
        success: function(data){      
            //some logic
        }
   }).fail(function() {
            //some error logic
   }); 
```

问题是，ajax 失败并显示“未定义”消息，因为它期望 html 作为响应，但是我的操作返回 html。

我怎样才能使它与 html 响应一起使用？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-03T22:44:06.603

只需将“dataType”设置为“html”。

参数“dataType”是 jQuery ajax 调用期望返回的类型。

更多信息：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# c# - EntityFramework 5.0 无法使用 SaveContext 保存带有子对象的对象

> ID：14678190
> 
> 赞同：0
> 
> 时间：2013-02-03T22:38:16.017
> 
> 标签：c#, entity-framework-5

我有一个具有共同属性的基础对象：

```
public abstract class BaseItem
    {
        [Required]
        public  User ModifiedUser { get; set; }

        [Required]
        public User CreatedUser { get; set; }
    } 
```

所有其他对象都继承自上述内容，但是当我尝试使用 SaveContext 进行保存时，它不起作用并出现错误：ModifiedUser - ModifiedUser 字段是必需的。CreatedUser - CreatedUser 字段是必需的。

分类对象：

```
public class Category : BaseItem, INotifyPropertyChanged
    {
        public int CategoryId { get; set; }

        public string Name { get; set; }
...
   } 
```

保存类别的方法：

```
public List<Category> SaveCategories(Category[] categories)
        {
            try
            {
                using (EntityContext context = new EntityContext())
                {
                    context.Category.AddOrUpdate(categories);
                    context.SaveChanges();
                }
                ...
            }
 catch (DbEntityValidationException e)
            {
...
}
} 
```

我使用了 AddOrUpdate() 但我也尝试先从数据库中获取一个类别，然后调用 context.SaveChanges(); 但我得到同样的错误。

有什么想法我在这里做错了吗？

## ＃＃ 更新 ＃＃

我想我发现了为什么会这样。问题在于 BaseItem，它是我拥有 ModifiedUser 和 CreatedUser 的所有其他类的基类。好吧，我还有一个继承自 baseitem 的 User 类。所以现在我面临着 BaseItem 和 User 之间的循环依赖。或者在这种情况下，由于 User 从 BaseItem 继承，我们对自引用对象有一个循环依赖。

```
public class User : BaseItem
    {
        public int UserId { get; set; }

        [Required]
        public string UserName { get; set; }
    } 
```

我试图将 ModifiedUser 和 CreatedUser 设为虚拟，但我有 WCF，它不会序列化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:43:51.833

类别数组中的每个类别对象上的 ModifiedUser 和 CreatedUser 是否为空？它们不能为空，因为您将它们标记为必需。

# ruby - 为什么我无法安装 gem？

> ID：14678191
> 
> 赞同：2
> 
> 时间：2013-02-03T22:38:20.457
> 
> 标签：ruby, rubygems

截至今天，我无法安装任何 gem。AFAIK什么都没有改变。

安装时我得到以下信息：

```
$ ~/ gem install sinatra
WARNING:  Error fetching data: hostname does not match the server certificate (https://gemcutter.org/latest_specs.4.8.gz)
WARNING:  Error fetching data: hostname does not match the server certificate (https://gemcutter.org/latest_specs.4.8.gz)
ERROR:  Could not find a valid gem 'sinatra' (>= 0) in any repository
ERROR:  Possible alternatives: sinatra 
```

有任何想法吗？（这是在 Mac 上）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:27:25.073

我不完全确定为什么，但是通过编辑我的`~/.gemrc`并删除所有源栏`rubygems.org`，问题就消失了。

# java - 解析时 JSON 对象为空

> ID：14678192
> 
> 赞同：1
> 
> 时间：2013-02-03T22:38:20.997
> 
> 标签：java, android, json, gson

我的 json 对象的格式是：

```
 String jsonObjRecv =  {
      "response":{
       "respobj":{
        "id":<int>,
        "number":<string>,
        "validated":<boolean>
         }
        },
        "status":"ok",
        "errors":null
        } 
```

当代码为：

```
 JSONObject jsonObjCont = new JSONObject(jsonObjRecv);
        String getString= jsonObjCont.toString(2); 
```

在这种情况下 getString != null 并且我可以接收数据，但是当我尝试获取 JSON 对象的嵌套数据时，如下所示：

```
 JSONObject jsonObjCont = new JSONObject(jsonObjRecv);
        JSONObject regNumber = jsonObjCont.getJSONObject("respobj");
        String number= regNumber.getString("number"); 
```

它不起作用。

我尝试使用 GSON 库，但它在以下情况下有效：

```
public String parse(String jsonObjRecv) {
    JsonElement jelement = new JsonParser().parse(jsonObjRecv);
    String result = jelement.toString();
    return result; 
```

并且不工作：

```
public String parse(String jsonObjRecv) {
    JsonElement jelement = new JsonParser().parse(jsonObjRecv);
    JsonObject jobject = jelement.getAsJsonObject();
    jobject = jobject.getAsJsonObject("respobj");

    String result = jobject.get("number").toString();
    return result; 
```

我的错误在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:56:23.367

问题是您没有正确访问您的 JSON 对象 - 它是一个包含对象的对象，该`response`对象包含一个`respobj`对象。

`Gson`示例如下。请注意代码中的注释 - 您需要获取`response`对象*然后*从中获取`respobj`。

```
public static void main( String[] args )
{
    String jsonObjRecv =  "{\"response\":{\"respobj\":{\"id\":1,\"number\":\"22\",\"validated\":true}},\"status\":\"ok\",\"errors\":null}";

    JsonElement jelement = new JsonParser().parse(jsonObjRecv);
    JsonObject jobject = jelement.getAsJsonObject();

    // Here is where you're making an error. You need to get the outer
    // 'response' object first, then get 'respobj' from that.
    jobject = jobject.getAsJsonObject("response").getAsJsonObject("respobj");

    String result = jobject.get("number").getAsString();

    System.out.println(result);

} 
```

输出：

> 22

**编辑添加：**注意我使用了`getAsString()`vs. `toString()`- 如果你使用后者，你会得到原始 JSON，它将在值周围包含引号（例如输出将是`"22"`）

# c# - 此操作需要 IIS 集成管道模式。防伪令牌

> ID：14678194
> 
> 赞同：3
> 
> 时间：2013-02-03T22:38:50.333
> 
> 标签：c#, .net, iis-7

我正在运行 IIS7、.NET 4.5 并且有一个 MVC2 站点。

我收到错误“此操作需要 IIS 集成管道模式”。当我导航到一个页面（一个 aspx 视图）时，它上面有一个带有 AntiForgeryToken 的表单。

```
<%=Html.AntiForgeryToken() %> 
```

我四处搜索并看到了为其他人（正在运行 IIS6）修复此错误的 AddHeaders 解决方案，但我看不出这有什么相似之处。

我之所以提到 AntiForgeryToken，是因为如果我把那条线去掉，页面就可以工作了！

编辑：我尝试重新安装 .NET 4.5 - 没有帮助

编辑：我的 AppPool 绝对设置为“集成”托管管道模式 (ApplicationPoolIdentity)。这是此应用程序池中唯一的应用程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-08T23:58:19.423

在 IIS Express 中运行应用程序。这解决了我同样的问题。只需右键单击您的项目并选择“属性”并单击“Web”选项卡，在服务器下单击“使用 localIIS Web 服务器并单击“使用 IIS express”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T04:19:59.783

使用升级工具升级到 MVC3 已解决问题 [http://blogs.msdn.com/b/marcinon/archive/2011/01/13/mvc-3-project-upgrade-tool.aspx?Redirected=true](http://blogs.msdn.com/b/marcinon/archive/2011/01/13/mvc-3-project-upgrade-tool.aspx?Redirected=true)

我意识到这对每个人来说并不总是一个可行的解决方案 - 所以会留下这个问题，希望其他人对修复 MVC2 解决方案有想法。

# r - 不理解 R 中的选项方法

> ID：14678197
> 
> 赞同：0
> 
> 时间：2013-02-03T22:39:04.683
> 
> 标签：r, dataframe, options

有人可以解释一下吗？为什么设置的选项不起作用？为什么默认还是factor，然后就不能绑定数据了？

```
> options(stringAsFactors = FALSE)
> getOption("stringsAsFactors")
[1] TRUE
> policy.number = c("A00187", "A00300","A00467","A01226")
> issue.age = c(74,30,68,74)
> sex=c("F", "M", "M", "F")
> smoke=c("S","N","N","N")
> face.amount = c(420, 1560, 960, 1190)
> ins.df = data.frame(policy.number, issue.age, sex, smoke, face.amount)
> ins.df = rbind(ins.df, c("A01495", 62, "M", "N", 1330))
Warning message:
In `[<-.factor`(`*tmp*`, ri, value = "A01495") :
  invalid factor level, NAs generated 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:46:20.987

在您的第一行代码中，您忘记了一个 "s" ：

```
options(stringAsFactors = FALSE) 
```

应该 ：

```
options(stringsAsFactors = FALSE) 
```

# php - php 检查远程 rtmp 文件是否存在

> ID：14678199
> 
> 赞同：1
> 
> 时间：2013-02-03T22:39:20.907
> 
> 标签：php, flash, video, rtmp

> **可能重复：**
> [检查远程机器上是否存在文件](https://stackoverflow.com/questions/4235953/check-if-file-exists-on-remote-machine)

如果我有这样的 URI

```
rtmp://.../mp4:20122013/..._16x9_1.mp4 
```

php中有没有一种方法可以验证并返回它是否存在？如果不在php中，我该如何实现我的目的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:50:31.153

下次对google和stackoverflow做更深入的研究。

本文解释了如何使用 PHP 和 rtmpdump 检查 rtmp 流是打开还是关闭。

[如何检查 RTMP 源流是否直播？](http://blog.svnlabs.com/how-to-check-rtmp-source-stream-is-live-or-not/)

如果您喜欢/需要使用 php native 执行此操作，您可以使用此库

[php-rtmp-客户端](http://code.google.com/p/php-rtmp-client/)

**更新**

在您的情况下，它将需要运行：

```
rtmpdump -v -v -r "rtmp://flash.onthefly.nhl.com/ondemand/NHLHighlights//mp4:20122013/02/0118/2_118_nsh_sjs_1213_h_continuous_1600K_16x9_1.mp4" -W "http://nhl.cdn.neulion.net/u/videocenter/flex/images/evp.swf" 
```

检查 rtmpdump 了解更多信息。

# ios - GPUImage 2 视频输入

> ID：14678202
> 
> 赞同：1
> 
> 时间：2013-02-03T22:39:45.927
> 
> 标签：ios, objective-c, gpuimage

我正在尝试使用 将 2 个视频混合在一起`GPUImageAlphaBlendFilter`。输出看起来像我想要的，但有一些帧已经过时了。例如，时间 0.32 的帧被放置在时间 0.4。您可以查看此[Youtube 视频](http://www.youtube.com/watch?v=D7VVwTE5jOw&feature=youtu.be)了解详细信息。这次不匹配使视频看起来不太好，所以我希望有人能帮助我。

我尝试深入研究文件`GPUImageTwoInputFilter`，方法

`- (void)newFrameReadyAtTime:(CMTime)frameTime atIndex:(NSInteger)textureIndex;`

并尝试更改此行：

`[super newFrameReadyAtTime:frameTime atIndex:0];` 但是如果我`frameTime`改成`firstFrameTime`，第二个视频有时间不匹配的问题，如果我把它改成`secondFrameTime`，第一个视频有时间不匹配的问题。

# scala - 在解释器中获取类型和类标记/绑定参数化类型

> ID：14678203
> 
> 赞同：0
> 
> 时间：2013-02-03T22:39:50.380
> 
> 标签：scala, reflection, interpreter, type-erasure, scala-2.10

给定一个参数化类型：

```
trait Document[S] 
```

我想为嵌入式解释器绑定 this 的实例，例如

```
def test[S](doc: Document[S]) = tools.nsc.interpreter.NamedParam("document", doc) 
```

这需要 a`TypeTag`和 a `ClassTag`of `Document[S]`。请注意，我需要能够绑定完整类型，即`Document[S]`而不仅仅是`Document[_]`.

我该怎么办？我想我会在文档中添加一些内容，例如

```
trait Document[S] {
   def tt: reflect.runtime.universe.TypeTag[Document[S]] = ???
   def ct: reflect.runtime.universe.ClassTag[Document[S]] = ???
} 
```

（为什么我需要两个不同的标签来获取命名参数？）

* * *

**编辑**：以下使其编译

```
trait Document[S] {
  implicit def systemType: reflect.runtime.universe.TypeTag[S]
}

def test[S](doc: Document[S]) = {
  import doc.systemType
  tools.nsc.interpreter.NamedParam("document", doc)
} 
```

但是我仍然`Document[_]`在解释器中绑定到，所以我的类型参数`Document`丢失了？！

# javascript - 弹出窗口中的 RSS 阅读器

> ID：14678204
> 
> 赞同：-2
> 
> 时间：2013-02-03T22:39:55.000
> 
> 标签：javascript, html

所以我刚刚测试了这个[小提琴](http://jsfiddle.net/fCt4D/)，但弹出窗口中没有我的 RSS 阅读器，而是它现在是空的。如何在我的弹出窗口中显示这个？

这是我想放在弹出窗口中的 RSS 阅读器脚本：

```
<html><head>
<title>New own RSS reader demonstration</title>
<link rel="stylesheet" type="text/css" href="css/main.css" />
<script type="text/javascript" src="js/main.js"></script>
</head>
 <body>
<!-- FEED READER START HERE -->
 <div id="feed"></div>
 <script type="text/javascript">
 <!--
  /*  O P T I O N S */
   feedURL = 'https://news.google.com/news/feeds?cf=all&ned=us&hl=en&topic=h&ncl=dvaadJqUY6PZt7MP7WyQ1UWmilCSM&output=rss';
  postCount = 15;
  excerptLength = 10;
   //-->
    </script>
  <script type="text/javascript" src="feed_reader.js"></script>
   <!-- END OF FEED READER -->
   </body>
   </html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T14:20:27.400

未调用脚本块，我认为 feedURL 变量中的 rss 数据输入不正确。

# list - Haskell -- 使用列表中的元组中的列表进行列表理解

> ID：14678205
> 
> 赞同：0
> 
> 时间：2013-02-03T22:40:00.507
> 
> 标签：list, haskell, tuples, list-comprehension

我有：

```
type Person     = String
type Book       = String
type Database   = [(Person,[Book])] 
```

我正在尝试定义一个函数：

```
books :: Database -> Person -> [Book] 
```

它包含 1）一个元组列表（包含一个字符串和一个字符串列表 2）一个字符串名称

并返回一个字符串列表（即数据库中的书籍）

我想使用列表理解，但我不知道如何访问数据库列表内部元组中的列表中的元素。

想法？

示例数据库如下所示：

```
db = [("Bob", ["Red Riding Hood", "Alice in Wonderland"]), ("Carol", ["Game of Thrones"])] 
```

如果我要求说“Carol”，它应该返回 [“Game of Thrones”]。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:48:19.567

由于您有一个关联列表，您可以使用该[`lookup`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3alookup)功能。它几乎完全像你想要的那样工作：

```
getVal :: Database -> String -> Maybe [String]
getVal  = lookup 
```

唯一的区别是它返回一个`Maybe`但恕我直言，这是正确的行为，考虑一下如果您在查找时数据库中没有值会发生什么？

既然你想在这里使用模式匹配是源`lookup`

```
lookup                  :: (Eq a) => a -> [(a,b)] -> Maybe b
lookup _key []          =  Nothing
lookup  key ((x,y):xys)
    | key == x          =  Just y
    | otherwise         =  lookup key xys 
```

或者在你的情况下

```
getVal :: Database -> String -> [String] --Avoids a Maybe if you want
getVal _key []          =  []
getVal  key ((x,y):xys)
    | key == x          =  y
    | otherwise         =  getVal key xys 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:36:08.427

正如其他海报所说，`lookup`这是去这里的方式：这是在关联列表中搜索某些内容的标准程序。

也就是说，使用列表理解的解决方案**是**

```
books :: Database -> Person -> [Book]
books db authorName = [book | (author, bookName) <- db,
                              author == authorName
                              book <- bookName] 
```

它是一个一个地取出`(author, bookName)`元组，丢弃作者不匹配的元组。如果然后将该作者的书籍添加到结果中。

同样，这为标准库中已经存在的函数实现了一种解决方法，并且通常可读性较差。真的，使用`lookup`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T22:55:38.280

我不会使用列表推导来实现该功能 - 列表推导更适合构建列表。

您正在寻找的是 Prelude 函数[查找](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v%3alookup)：

```
lookup :: Eq a => a -> [(a, b)] -> Maybe b 
```

如您所见，如果`a ~ Person`和`b ~ [Book]`交换参数之后，它几乎具有正确的类型。既然你想要`[Book]`回来而不是`Maybe [Book]`你可以把整个东西包裹在[fromMaybe](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#v%3afromMaybe)里面，结果是：

```
books db = fromMaybe [] . flip lookup db 
```

# javascript - 如何让用户自定义背景图像？

> ID：14678207
> 
> 赞同：2
> 
> 时间：2013-02-03T22:40:33.830
> 
> 标签：javascript, css, image, background, skinning

如今，许多网站都具有“主题”功能，当用户能够自定义页面的外观时。有时它只是一组固定的主题，但有时人们可以自由选择他们想要的任何风格——例如，他们可以设置页面背景的任何颜色。

我想更进一步——让他们也选择背景*图像*。流程非常简单：用户上传一个文件（通过`<input type="file" />`），然后这个文件变成一个背景图片——但仅限于这个用户。

不过，我在网上找不到任何关于此功能的信息，我也不知道该怎么做。

我在想的另一件事是，如果用户选择了一个背景，也许我可以使用 HTML5`localstorage`让该背景在每次访问者访问页面时出现。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:10:21.360

这是一个概念证明（主要基于[MDN FileReader doc page](https://developer.mozilla.org/en-US/docs/DOM/FileReader) + [this answer](https://stackoverflow.com/questions/9344526/setting-css-background-to-an-image-in-local-storage)给出的代码）：

**HTML**：

```
<input id="test" type="file" onchange="loadImageFile(this)" /> 
```

**JS**：*无换行（头部）模式*

```
$(switchBackground);
var oFReader = new FileReader(),
    rFilter = /^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;

oFReader.onload = function(oFREvent) {
    localStorage.setItem('b', oFREvent.target.result);
    switchBackground();
};

function switchBackground() {
  var backgroundImage = localStorage.getItem('b');
  if (backgroundImage) {
    $('body').css('background-image', 'url(' + backgroundImage + ')');    
  } 
}

function loadImageFile(testEl) {
  if (! testEl.files.length) { return; }
  var oFile = testEl.files[0];
  if (!rFilter.test(oFile.type)) { alert("You must select a valid image file!"); return; }
  oFReader.readAsDataURL(oFile);
} 
```

这是一个[**工作演示**](http://jsfiddle.net/N7KfQ/4/)，已签入最新的 Firefox 和 Chrome 版本。至少看起来工作正常。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-30T07:29:35.740

这是此问题的快速解决方案。

custom-background.js 是一个轻量级的 jQuery 插件，允许用户更改网站的默认背景并将选择的背景保存到本地存储。这个插件可以很容易地添加到任何网站或网络应用程序中，而不会影响网站的性能。

你可以从这里下载并检查代码 [https://github.com/CybrSys/custom-background.js](https://github.com/CybrSys/custom-background.js)

# php - Laravel 4：在包中使用视图

> ID：14678209
> 
> 赞同：6
> 
> 时间：2013-02-03T22:41:06.557
> 
> 标签：php, laravel, laravel-4

我在 Laravel 4 中创建了一个非常基本的应用程序，我将在各种项目中重复使用它，所以在我走得太远之前将它转换为一个包是有意义的，但我正在努力做出改变让它工作，我认为这主要是由于弄清楚如何访问应用程序中通常可用的各种对象，例如 View::make

我有以下代码在应用程序中工作：

```
class PageController extends BaseController {

public function showPage($id)
{
            //do stuff
            return View::make('page/showPage')
                 ->with('id', $id)
                 ->with('page', $page);
} 
```

对于包裹，我有以下内容：

```
use Illuminate\Routing\Controllers\Controller;
use Illuminate\Support\Facades\View;

class PageController extends Controller {

public function showPage($id)
{
      //do stuff        
      return View::make('page/showPage')
                 ->with('id', $id)
                 ->with('page', $page);
} 
```

但是，这不会加载位于以下位置的刀片模板：

```
workbench/packagenamespace/package/src/views/page/showPage.blade.php 
```

这也不起作用：

```
return View::make('packagenamespace/package/src/page/showPage') 
```

另外，我想知道我对使用外观对象的 use 语句所做的操作是否正确，对我来说，似乎应该有一种更简洁的方式来访问 View 对象之类的东西？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-03T23:50:16.440

您应该阅读文档： http: [//four.laravel.com/docs/packages](http://four.laravel.com/docs/packages)

特别是解释从包中加载视图的部分；）

```
return View::make('package::view.name'); 
```

如果您不想使用：

```
use Illuminate\Support\Facades\View; 
```

做就是了：

```
use View; 
```

甚至没有 use 语句：

```
\View::make('package::view.name'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-31T09:33:46.323

```
// Serviceprovider.php

$this->loadViewsFrom(__DIR__.'/resources/views', 'laratour');

// Controller    

<?php

    namespace Mprince\Laratour\Controllers;

    use Illuminate\Http\Request;
    use Illuminate\Routing\Controller;

    class LaratourController extends Controller
    {

        public function index()
        {
            return view('laratour::index');
            // return view('packageName::bladeFile');
        }
        //END
    } 
```

# sencha-touch-2 - 用 Ext 解析日期

> ID：14678212
> 
> 赞同：1
> 
> 时间：2013-02-03T22:41:19.817
> 
> 标签：sencha-touch-2

我试图在 Ext (Sencha Touch 2) 中解析以下 ISO 格式的日期，但弄错了。

我查看了文档，但是我做错了，很烦人，有人发现了吗？

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Date](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.Date)

从 Chrome 控制台

```
Ext.Date.parseDate('2012-03-06T11:14:28','Y-m-dTH:i:m');
Sun Apr 06 2014 11:14:00 GMT+0300 (FLE Daylight Time) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T14:38:28.693

您似乎正在尝试使用简单的令牌重新创建 ISO 8601 解析器，这是不正确的。

幸运的是，在您自己提供的文档中，您将能够看到它已经可以解析 ISO 8601！

```
Ext.Date.parseDate('2012-03-06T11:14:28','c'); 
```

# ruby-on-rails - 构建一个包含 Rack 应用程序的 RubyGem

> ID：14678213
> 
> 赞同：0
> 
> 时间：2013-02-03T22:41:22.843
> 
> 标签：ruby-on-rails, ruby, rubygems, rack

我目前正在构建一个依赖 Rack 来服务 HTTP 请求的 gem。

我不想将我自己的 gem（或存储库）与特定于部署的东西混在一起，我只想能够将其添加到 Gemfile：

```
gem 'my-awesome-rack-gem'
gem 'unicorn'
gem 'capistrano' 
```

然后能够从单独的安装中运行和管理所有内容。但这可能吗？我曾尝试寻找具有相同功能的宝石，也曾尝试寻找具有机架功能的宝石，但没有适当的解决方案。

欢迎提出想法和链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T15:24:06.157

[Rack 是中间件，基本上是 HTTP请求](http://rack.rubyforge.org/doc/Rack/Request.html)和[响应](http://rack.rubyforge.org/doc/Rack/Response.html)的包装器。

有许多默认包装器，请参阅[https://github.com/rack/rack/blob/master/lib/rack.rb](https://github.com/rack/rack/blob/master/lib/rack.rb) - 但为了运行一些代码，您需要在 config.ru 或你的 Rails 应用程序。

在此处查看基于机架的记录器的示例：

[http://clogger.rubyforge.org/](http://clogger.rubyforge.org/)

# c# - Visual Studio - 值不能为空。参数名称：孩子

> ID：14678215
> 
> 赞同：1
> 
> 时间：2013-02-03T22:41:35.260
> 
> 标签：c#, winforms, visual-studio-2012, crash, windows-forms-designer

当我从 Visual Studio 的设计器中移动按钮时，我收到此错误

![在此处输入图像描述](../Images/0c2127bb663497fc22584de57f83df12.png)

这不会很烦人，因为如果我运行解决方案，我在运行时不会收到任何错误，即使在我的设计器按钮中变成这样：

![在此处输入图像描述](../Images/3fc75f642991e8b4f5554b0c22b6c6a9.png)

如果我尝试移动现有的 groupbox（或者我尝试添加一个新的 groupbox）它会崩溃（visual studio）。

如何调试 Visual Studio 以更好地理解我的设计器问题？因为当它崩溃时，Visual Studio 会自行关闭并重新打开，而无需询问任何内容。

或者甚至是一个已知的错误并且有一个简单的解决方案？（但我在谷歌上没有找到类似的东西）

# box2d - Libgdx Box2D 为身体设置图像

> ID：14678223
> 
> 赞同：7
> 
> 时间：2013-02-03T22:42:29.320
> 
> 标签：box2d, libgdx

我在将图像设置为动态/静态主体时遇到问题。

我找到了一个关于它的闪存代码

```
public void setImage()
{
    sprite = new B2Sprite();
    var bitmap:Bitmap = new Image();
    sprite.addChild();
    bitmap.x -= bitmap.width / 2;
    bitmap.y -= bitmap.height / 2;
    body.SetUserData(sprite);
    sprite.body = body;
} 
```

但将其转换为 java :( 请任何人帮助我或提供有关 java 上 box2D 的教程的链接。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-15T21:32:47.360

你有一个关于 box2D 和 libgdx 关于逻辑和渲染概念的非常有用的链接。[这里](http://www.aurelienribon.com/blog/projects/physics-body-editor/)

然后你可以像这样分离渲染部分的逻辑部分：

逻辑部分：

```
private void createBottleBody() {
    // 0\. Create a loader for the file saved from the editor.
    BodyEditorLoader loader = new BodyEditorLoader(sourceFile);

    // 1\. Create a BodyDef, as usual.
    BodyDef bd = new BodyDef();
    bd.position.set(0, 0);
    bd.type = BodyType.DynamicBody;

    // 2\. Create a FixtureDef, as usual.
    FixtureDef fd = new FixtureDef();
    fd.density = 1;
    fd.friction = 0.5f;
    fd.restitution = 0.3f;

    // 3\. Create a Body, as usual.
    bottleModel = world.createBody(bd);

    // 4\. Create the body fixture automatically by using the loader.
    loader.attachFixture(bottleModel, "test01", fd, BOTTLE_WIDTH);
} 
```

渲染部分：

```
public void render() {
    Vector2 bottlePos = bottleModel.getPosition().sub(bottleModelOrigin);

    bottleSprite.setPosition(bottlePos.x, bottlePos.y);
    bottleSprite.setOrigin(bottleModelOrigin.x, bottleModelOrigin.y);
    bottleSprite.setRotation(bottleModel.getAngle() * MathUtils.radiansToDegrees);

    ...
} 
```

加载器：在链接中，您可以找到加载器。

```
public void attachFixture(Body body, String name, FixtureDef fd, float scale) {

    //Load the rigidModel by key
    RigidBodyModel rbModel = (RigidBodyModel) this.model.rigidBodies.get(name);

    if (rbModel == null)
        throw new RuntimeException("Name '" + name + "' was not found.");

    //Loading polygons
    Vector2 origin = this.vec.set(rbModel.origin).mul(scale);
    Vector2[] vertexes;
    PolygonModel polygon;

    for (int i = rbModel.polygons.size()-1; 0 <= i; i--) {
        polygon = (PolygonModel) rbModel.polygons.get(i);
        vertexes = polygon.vectorBuffer;

        //Loading vertexes (scaled) from polygon
        for (int ii = vertexes.length-1; 0 <= ii; ii--) {
            vertexes[ii] = new Vector2().set((Vector2) polygon.vertices.get(ii)).mul(scale);
            vertexes[ii].sub(origin);
        }

        //sets vertexs to polygon
        this.polygonShape.set(vertexes);
        fd.shape = this.polygonShape;
        body.createFixture(fd);

    }

    //Loading circles
    CircleModel circle;
    Vector2 center;
    float radius;

    for (int i = rbModel.circles.size()-1; 0 <= i; i--) {
        circle = (CircleModel) rbModel.circles.get(i);
        center = new Vector2().set(circle.center).mul(scale);
        radius = circle.radius * scale;

        this.circleShape.setPosition(center);
        this.circleShape.setRadius(radius);
        fd.shape = this.circleShape;
        body.createFixture(fd);

    }
} 
```

最后...模型

```
public static class CircleModel {
    public final Vector2 center = new Vector2();
    public float radius;
}

public static class PolygonModel {
    public final List<Vector2> vertices = new ArrayList<Vector2>();
    private Vector2[] vectorBuffer;
}

public static class RigidBodyModel {
    public String name;
    public String imagePath;
    public final Vector2 origin = new Vector2();
    public final List<PolygonModel> polygons = new ArrayList<PolygonModel>();
    public final List<CircleModel> circles = new ArrayList<CircleModel>();
}

public static class Model {
    public final Map<String, RigidBodyModel> rigidBodies = new HashMap<String, RigidBodyModel>();
} 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-04T09:32:38.423

由于您的问题被标记为 LibGDX，因此您使用[Sprites](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/graphics/g2d/Sprite.html)会很方便。

```
public void setImage(Sprite sprite){
    body.setUserData(sprite);
} 
```

那么在`render()`，可能会有这样的事情

```
private SpriteBatch batch = new SpriteBatch();
public void render() {
    batch.begin();
    Iterator<Body> iter = world.getBodies();
    Body body;
    Sprite sprite;
    while (iter.hasNext()) {
        body = iter.next();
        sprite = (Sprite) body.getUserData();
        // I did not take a look at implementation but you get the idea
        sprite.x = body.x;
        sprite.y = body.y;
        sprite.draw(batch);
    }
    batch.end();  
} 
```

`getImage()`使用可以返回具有适当位置、旋转等的精灵的方法围绕 body 创建一个包装类并不是一个坏主意。

*请注意，我没有测试我的代码，可能有错误。*

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-04T22:28:41.267

```
public void create()
{texture = new Texture(Gdx.files.internal("data/ball.png"));
sprite = new Sprite(texture,0,0,32,32);
batch_sprite = new SpriteBatch();
.....
}
public void render()
{
....
xball=PIXELS_PER_METER*(theBall.getWorldCenter().x)-sprite.getWidth()/2;
yball=PIXELS_PER_METER*(theBall.getPosition().y)-sprite.getHeight()/2;

batch_sprite.begin();
sprite.draw(batch_sprite);
sprite.setX(xball);
sprite.setY(yball);
batch_sprite.end();
....} 
```

由于重力，加速度导致精灵延迟，但在重力 = Vector2(0.0f, -1.1f) 下工作正常，这正是我想要的。

# xcode - XCode 协议

> ID：14678225
> 
> 赞同：2
> 
> 时间：2013-02-03T22:42:50.613
> 
> 标签：xcode, protocols

我正在向我的项目添加一个新协议，但 XCode 无法识别该代码。我在同一个项目中已经有其他协议没有任何问题，但这次有趣的是代码的颜色不正确，自动文本助手无法识别语言。

例如，在协议中，代码如下所示：

```
#import <Foundation/Foundation.h>

@protocol URLGetDelegate <NSObject>
@required

@optional

- (void)setWeather:(NSArray*) data;
- (void)setChemists:(NSData*) data;

@end 
```

然后 NSObject 显示为紫色，但是在新协议中 NSObject 显示为黑色，当我输入代码时，NSO ... XCode 不会自动为我提供 NSObject 字样。

```
#import <Foundation/Foundation.h>

@protocol CompanyDelegate <NSObject>

@end 
```

有什么帮助吗？

谢谢

![协议工作](../Images/c1d272cfe23f33ef102952ca3d65681a.png)

![协议工作文本弹出窗口](../Images/1b6042542a3af08b4352aff52a87f858.png)

![协议不起作用](../Images/f2eb43484706ceee1e8958621580b644.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-02T23:30:46.707

Laure_f_o 指的是 XCode 中缺乏标准的自动完成和文本着色；本质上，XCode 拒绝识别新添加的协议。因此，当您尝试将其添加到一个类并将该类声明为订阅该协议时，您会收到构建错误。

我只是遇到了完全相同的问题：我项目中的其他协议工作正常，但是当尝试添加一个新协议时，XCode 根本无法识别它。这就是 XCode 4.6.2 的全部内容

最终为我解决了以下问题（基于 Javy 的建议：[Xcode Not Immediately Recognizing New Classes (iOS)](https://stackoverflow.com/questions/8300108/xcode-not-immediately-recognizing-new-classes-ios)）：

1.) 清洁项目

2.) 关闭项目（但不是 XCode）

3.) 在 Xcode 中打开 Organizer（在 Window 菜单下）

4.) 选择“项目”选项卡

5.）删除“派生数据”（如果您已保存快照，则必须先删除这些快照）

6.) 退出 XCode 并重新启动计算机

7.）重新打开项目并再次清理它

8.) 将问题协议导入一个类并将该类声明为订阅它

然后，也只有到那时，我才最终让有问题的协议开始表现得如此，并且在尝试在类中使用它时没有遇到构建错误。

# c# - datagrid.itemssource = e.Result 在主页中不起作用-silverlight

> ID：14678227
> 
> 赞同：0
> 
> 时间：2013-02-03T22:42:53.893
> 
> 标签：c#, wcf, linq, silverlight, silverlight-5.0

我正在创建一个 Silverlight Web 应用程序，我使用 linq to sql 来绑定我的 sql 数据库。这行得通。我现在的问题是，当我尝试将数据保存在数据网格或列表框中时，什么也没有发生（意味着没有输出）。

这是我在 wcf 服务文件中的代码：

```
public List<mytable> get_info()
    {
        LinqMapInfoDataContext _context = new LinqMapInfoDataContext();
        var result = (from x in _context.mytable select x).ToList();
        return result;
    } 
```

在 mainpage.xaml.cs

```
private void ser_client_get_infoCompleted(object sender, ServiceRefMapInfo.get_infoCompletedEventArgs e)
    {
        DataGrid grid1 = new DataGrid();
        grid1.ItemsSource = e.Result;                       
    } 
```

网络配置

```
<configuration>

<system.web>
    <compilation debug="true" targetFramework="4.0" />
</system.web>

<system.serviceModel>

  <bindings>

    <basicHttpBinding>
      <binding name="IncreasedTimeout"
               sendTimeout="00:25:00">
      </binding>
    </basicHttpBinding>

  </bindings>

    <behaviors>
        <serviceBehaviors>
            <behavior name="">
                <serviceMetadata httpGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:49:43.200

您正在创建一个 DataGrid 来保存数据，但您没有添加到 LayoutRoot。

将 DataGrid 的创建移动到页面的构造函数中，您需要将它添加到页面中，或者最好还是在 XAML 中定义它：

```
<Grid x:Name="LayoutRoot">
    <DataGrid ..../>
</Grid> 
```

（非常简化）。

下一步是检查数据是否实际返回给客户端。在以下位置设置断点：

```
grid1.ItemsSource = e.Result; 
```

尝试在调试器中查看 e.Result 的值。这应该显示您要显示的项目列表。但是，您的查询仅在此时进行评估，因此如果您返回很多项目，这可能需要很长时间甚至超时。如果发生这种情况，您需要增加服务呼叫的超时时间。在第一个实例中，尽​​管在服务器端编辑查询，以便它只返回几个 10 的项目。这将允许您验证数据是否正确返回。

要增加超时，请将其添加到 web.config 文件中：

```
<bindings>
  <basicHttpBinding>
    <binding name="IncreasedTimeout"
             sendTimeout="00:25:00">
    </binding>
  </basicHttpBinding> 
```

另一件奇怪的事情是，您返回的是 a`List`而不是a 中的数据`IQueryable`。对于少量数据，我认为它不会有任何区别（鉴于您发布的代码），但它是其他尝试。但是，如果您可能返回大量数据，您应该查看它，因为它支持分页。

这使您可以控制在一次调用中返回多少数据。这可以加快速度并减少客户端的内存占用（其他可能出错的地方）。然后在 UI 中一次显示一页数据并允许用户在其中导航。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T21:11:47.707

我知道了。

在我更改 linq2sql 或服务文件中的任何内容后，我总是重建我的解决方案。但这还不够。我必须在我的解决方案文件夹中“右键单击”我的服务参考，然后单击“实现服务参考”。之后它工作得很好。

谢谢你的帮助，克里斯F。

# silverlight - Silverlight HyperlinkBut ton 根本不工作

> ID：14678235
> 
> 赞同：0
> 
> 时间：2013-02-03T22:43:52.300
> 
> 标签：silverlight, button, hyperlink

我正在尝试根据[此文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.hyperlinkbutton%28v=vs.95%29.aspx)实现 Siverlight HyperlinkBut​​ton ：

```
<HyperlinkButton Content="Click here to learn about Silverlight"
                 NavigateUri="http://www.silverlight.net" 
                 TargetName="_blank" 
                 Margin="10,60,0,0"/> 
```

但是，当我构建并单击它时，它什么也没有显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:17:50.443

我的猜测是您没有为 Silverlight 对象启用外部导航。如果您没有单击链接时会引发安全异常，但您可能会在不知情的情况下捕获它。上述链接的备注部分对此进行了描述。

要启用导航，请编辑您的 Silveright 主机页面 (EG index.html) 并在 Silverlight 对象下添加以下参数

```
<param name="enableNavigation" value="true" /> 
```

默认情况下，Silverlight 每次运行/调试时都会生成 .html 页面，因此您将丢失参数。要解决此问题，请在同一目录中使用不同的名称复制 .html 文件，或者手动指定要在项目设置中使用的 .html 文件。

[http://msdn.microsoft.com/en-us/library/dd833071(v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/dd833071(v=vs.95).aspx)

更新：

这适用于 Chrome、Firefox 和 IE8。它不适用于 IE9。您可以使用开发人员工具在 IE 中对此进行测试。链接适用于文档模式 IE8，但在使用文档模式 IE9 时会引发未经授权的访问异常。

更新#2：

要让它在 IE9 中工作，您可以强制它使用 IE8 文档模式。为此，您需要删除 DOCTYPE 标记并添加元标记。例如

```
<html xmlns="http://www.w3.org/1999/xhtml" >
  <head>
    <meta http-equiv="x-ua-compatible" content="IE=8">
    .
    . 
```

代替

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
  <head>
    .
    . 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T05:22:37.380

您应该访问此链接以获取超链接按钮问题或.....它正在正常工作.....

```
<UserControl x:Class="HyperlinkButton2.Page"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Width="300" Height="100">
    <Canvas x:Name="LayoutRoot" Background="White">
        <HyperlinkButton x:Name="hbtnTest" TargetName="_blank" Content="SilverlightShow" NavigateUri="http://www.silverlightshow.net" Canvas.Top="40" Canvas.Left="30"></HyperlinkButton>
    </Canvas> 
```

[在 Silverlight 中使用 HyperlinkBut​​ton 控件](http://www.silverlightshow.net/items/Using-the-HyperlinkButton-control-in-Silverlight-2-Beta-1.aspx)

# perl - 如何在 get Manager 调用中为查询传递变量？

> ID：14678236
> 
> 赞同：0
> 
> 时间：2013-02-03T22:44:02.393
> 
> 标签：perl, mason, rose-db-object

我正在尝试进行简单的 Rose DB 调用： $id = xyz; $name = "公司";

```
DataB::testTable::Manager->get_testTable( query =>[ id => $id, name => $name ] ); 
```

可能不会每次都编写整个查询，并将其声明为字符串变量，这样我就可以调用

```
DataB::testTable::Manager->get_testTable( query =>[ $query ] ); 
```

其中 $query = qq { id => $id , name => $name };

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T07:08:11.423

根据**我从您的问题中了解到**的情况，我给出了这个答案。试试这个。

 ~~~~```
my $myquery = {query =>{ id=>$id, name=>$name }} ;

TGI::testTable::Manager->get_testTable($myquery); 
```~~  ~~希望，这会给你一些想法。

**编辑“带有数组引用的哈希”：**

```
my $myquery = [ id=>$id, name=>$name ] ;

TGI::testTable::Manager->get_testTable(query => $myquery); 
```

看看这个：[如何将一个字符串变量作为“查询”传递给获取管理器调用？](https://stackoverflow.com/questions/14678683/how-to-pass-a-a-string-variable-as-query-for-get-manager-call)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T17:58:58.440

那么实际上我想出了如何做到这一点。它没有那么复杂。唯一的问题是 RoseDB 对象期望查询的数组引用。所以像这样的工作：

我的@query = ( id => $id, name => $name );

```
testDB::testTable::Manager->get_testTable( query => \@query ); 
```

只是想自己回答一下，以防有人正在寻找解决方案~~~~

# twitter - Meteor 客户端订阅第三方 API

> ID：14678237
> 
> 赞同：1
> 
> 时间：2013-02-03T22:44:04.000
> 
> 标签：twitter, meteor

有几个使用 Meteor 和 Twitter API 的例子。典型的做法是将新的推文插入到服务器的 Meteor Collection 中，然后让客户端订阅这个集合。

但是，如果我只想在客户端显示新推文，则无需将这些推文存储在我的数据库中，写入数据库是昂贵、耗时且不必要的。

Meteor 客户端是否可以直接收听 Twitter，或者至少避免将新推文写入 Meteor 服务器数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:28:18.470

[`Meteor.http.get`](http://docs.meteor.com/#/full/http_get)只需使用 jQuery 的 $.getJSON等[其他方法](https://stackoverflow.com/questions/8783085/twitter-json-api-with-jquery)直接与 Twitter REST API对话。你真的不需要专门用 Meteor 构建任何东西来与 Twitter API 对话，但是如果你这样做的话，你的应用程序显然会受益于 Meteor 的特性，比如实时模板。否则，您将不得不自己修补。

# ruby-on-rails - 在不同页面中嵌入带有额外字段的设计表单

> ID：14678240
> 
> 赞同：1
> 
> 时间：2013-02-03T22:44:24.467
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我正在使用 devise+omniaouth 进行身份验证。我的用户也有一个配置文件，具有以下关系；

```
class User < ActiveRecord::Base
 has_many :authentications
 has_one :profile
 accepts_nested_attributes_for :profile
 attr_accessible :email, :password, :password_confirmation, :remember_me, :profile_attributes
etc. 
```

所以我的 registrations/new.html.erb 看起来像这样：

```
<% resource.build_profile %>
<%= form_for(resource, :as => resource_name,
                     :url => registration_path(resource_name)) do |f| %>
<%= devise_error_messages! %>

<%= f.fields_for :profile do |profile_form| %>
  <h2><%= profile_form.label :name %></h2>
  <p><%= profile_form.text_field :name %></p>
<% end %>

<h2><%= f.label :email %></h2>
<p><%= f.text_field :email %></p>

<h2><%= f.label :password %></h2>
<p><%= f.password_field :password %></p>

<h2><%= f.label :password_confirmation %></h2>
<p><%= f.password_field :password_confirmation %></p>

<p><%= f.submit "Sign up" %></p>

<br/>
<%= render :partial => "devise/shared/links" %>
<% end %>

<%= render "links" %> 
```

如您所见，我试图从配置文件中填写的唯一属性是“名称”。这可以正常工作，当您尝试从 /users/sign_up 注册时，您必须填写姓名、电子邮件和密码。

现在，我正在尝试从模式窗口显示此注册窗口，因此我创建了： /views/devise/menu/_registration_items.html.erb 具有相同的信息：

```
<%= form_for(resource, :as => resource_name,
                     :url => registration_path(resource_name)) do |f| %>
<%= devise_error_messages! %>

<%= f.fields_for :profile do |profile_form| %>
  <h2><%= profile_form.label :name %></h2>
  <p><%= profile_form.text_field :name %></p>
<% end %>

<h2><%= f.label :email %></h2>
<p><%= f.text_field :email %></p>

<h2><%= f.label :password %></h2>
<p><%= f.password_field :password %></p>

<h2><%= f.label :password_confirmation %></h2>
<p><%= f.password_field :password_confirmation %></p>

<p><%= f.submit "Sign up" %></p>

<br/>

<% end %> 
```

我还将它添加到应用程序控制器中（如果我将它放在帮助程序中，它的工作方式相同）：

```
 def resource_name
   :user
 end

 def resource
   @resource ||= User.new
 end

 def devise_mapping
   @devise_mapping ||= Devise.mappings[:user]
 end 
```

如[https://github.com/plataformatec/devise/wiki/How-To%3a-Display-a-custom-sign_in-form-anywhere-in-your-app所述](https://github.com/plataformatec/devise/wiki/How-To%3a-Display-a-custom-sign_in-form-anywhere-in-your-app)

除了名称字段没有在表单中显示之外，一切正常。（例如，没有该字段名称的登录表单可以正常工作）。我想我必须映射其他东西，但我不知道它是什么。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T00:43:06.377

我忘了添加

```
<% resource.build_profile %> 
```

表格顶部的行。

# batch-file - 批量跟踪（矢量化）许多位图到.swf？

> ID：14678242
> 
> 赞同：0
> 
> 时间：2013-02-03T22:44:33.203
> 
> 标签：batch-file, bitmap, adobe, flash

有人知道如何将许多位图即时批量跟踪（矢量化）为 flash .swf 格式吗？

我可以用 Flash Pro 做到这一点，但我正在寻找大量的跟踪，所以需要自动化的方式来做到这一点。

有一些用于 svg 的批处理跟踪程序，但我需要跟踪到 .swf

（ps 我现在有工具可以将位图嵌入到 swf 中，我实际上需要跟踪它们）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T04:31:15.430

*   [您可以使用as3potrace](https://github.com/PowerflasherBR/as3potrace)库直接从 AS3 跟踪图像 并保存它。可以在[此处](http://wahlers.com.br/claus/blog/as3-bitmap-tracer-vectorizer-as3potrace/)找到用于跟踪的最小代码。另一个项目是[vectorizationpackage](http://code.google.com/p/vectorizationpackage/downloads/list)。

*   使用控制台脚本修改 as3 代码中的图像路径并为多个图像重新编译。要从命令行重新编译，您需要按照*mitim*的建议使用[JSFL](http://gskinner.com/blog/archives/2004/08/jsfl_fla_batch.html)。

# objective-c - 在某个索引处启动 UICollectionView

> ID：14678244
> 
> 赞同：0
> 
> 时间：2013-02-03T22:45:02.720
> 
> 标签：objective-c, xcode, uicollectionview

我试图弄清楚如何在某个索引号处启动 UICollectionView。默认情况下，所有单元格都从索引 0 开始。但是假设我想从索引 2 开始。有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T22:47:29.707

看看 UICollecitonView 的[scrollToItemAtIndexPath:atScrollPosition:animated:](http://developer.apple.com/library/ios/documentation/uikit/reference/UICollectionView_class/Reference/Reference.html#//apple_ref/occ/instm/UICollectionView/scrollToItemAtIndexPath%3aatScrollPosition%3aanimated%3a)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:51:17.980

我猜在显示数据源之前，您有几个要显示的单元格不在数据源中。我以前做过。

因此，当您执行 cellForRowAtIndexPath （或其他任何内容）时，只需更改 indexPath 行。

所以...

numberOfRowsInSection = 2 + 您的数据源计数。

在 cellForRow...

如果 row <= 1 则只需使用您的静态内容。

否则 NSIndexPath *newIndexPath = oldIndexPath.section, oldIndexPath.row - 2

我目前无法访问代码，但我猜这就是你想要做的。

# android - 在 android 画布中设置显示图像的缩放比例

> ID：14678246
> 
> 赞同：0
> 
> 时间：2013-02-03T22:45:18.807
> 
> 标签：android, graphics, transformation

我正在尝试编写一个 android 应用程序，它可以让我在图像上绘制图形，然后缩放和缩放图像，图形停留在图像上已绘制在其上的同一位置，同时实时更改图形.

但是，在保持图像中心的同时，我实际上遇到了很多问题。我已经编写了代码，其中有一个更新图像的线程。使用我创建的名为“PendingUpdate”的类通过 ArrayBlockingQueue 传递更新。此更新包含所需的缩放级别，它应该是图像像素与画布像素和图像中心的比率。但是，以下代码在我缩放时使其平移，这让我感到困惑。

```
//Scale the image
canvas.scale(pendingUpdate.getZoom(), pendingUpdate.getZoom());

//Translate the image
double updateCx = pendingUpdate.getCenter().getX();
double updateCy = pendingUpdate.getCenter().getY();
double halfCanvasWidthInImagePixels = pendingUpdate.getZoom()*(canvas.getWidth()/2);
double halfCanvasHeightInImagePixels = pendingUpdate.getZoom()*(canvas.getHeight()/2);
double imageTranslateX = updateCx - halfCanvasWidthInImagePixels;
double imageTranslateY = updateCy - halfCanvasHeightInImagePixels;
canvas.translate(-(float)imageTranslateX, -(float)imageTranslateY);
canvas.drawBitmap(pendingUpdate.getImage(), matrix, new Paint()); 
```

感谢您的帮助！

编辑：这是完整的功能，如果有帮助，我也可以发布 PendingUpdate，但它只是一个数据类。

```
 private void doDraw(Canvas canvas, PendingUpdate pendingUpdate) {
        int iWidth = pendingUpdate.getImage().getWidth();
        int iHeight = pendingUpdate.getImage().getHeight();
        Matrix matrix = new Matrix();

        canvas.drawColor(Color.BLACK);
        //TODO: add scrolling functionality to this
        if(pendingUpdate.getZoom()>0) {

            //Scale the image
            canvas.scale(pendingUpdate.getZoom(), pendingUpdate.getZoom());

            //Translate the image
            double updateCx = pendingUpdate.getCenter().getX();
            double updateCy = pendingUpdate.getCenter().getY();
            double halfCanvasWidthInImagePixels = pendingUpdate.getZoom()*(canvas.getWidth()/2);
            double halfCanvasHeightInImagePixels = pendingUpdate.getZoom()*(canvas.getHeight()/2);
            double imageTranslateX = updateCx - halfCanvasWidthInImagePixels;
            double imageTranslateY = updateCy - halfCanvasHeightInImagePixels;
            canvas.translate(-(float)imageTranslateX, -(float)imageTranslateY);
            canvas.drawBitmap(pendingUpdate.getImage(), matrix, new Paint());

        }else {
            //matrix.postTranslate(canvas.getWidth()-iWidth/2, canvas.getWidth()-iHeight/2);
            canvas.drawBitmap(pendingUpdate.getImage(),
                    (canvas.getWidth()-iWidth)/2,
                    (canvas.getHeight()-iHeight)/2, null);
        }
        //TODO: draw other stuff on canvas here such as current location

    } 
```

编辑2：这就是我最终让它工作的方式，只是在翻译之前对其进行缩放。

```
 private void doDraw(Canvas canvas, PendingUpdate pendingUpdate) {
        int iWidth = pendingUpdate.getImage().getWidth();
        int iHeight = pendingUpdate.getImage().getHeight();

        canvas.drawColor(Color.BLACK);
        //TODO: add scrolling functionality to this
        if(pendingUpdate.getZoom()>0) {

            //Scale the image
            canvas.save();
            double updateCx = pendingUpdate.getCenter().getX();
            double updateCy = pendingUpdate.getCenter().getY();
            double halfCanvasWidthInImagePixels = (canvas.getWidth()/2);
            double halfCanvasHeightInImagePixels = (canvas.getHeight()/2);
            double imageTranslateX = updateCx - halfCanvasWidthInImagePixels;
            double imageTranslateY = updateCy - halfCanvasHeightInImagePixels;
            //canvas.scale(pendingUpdate.getZoom(), pendingUpdate.getZoom(), (float)pendingUpdate.getCenter().getX(), (float)pendingUpdate.getCenter().getY());

            canvas.scale(pendingUpdate.getZoom(),
                    pendingUpdate.getZoom(),
                    canvas.getWidth()/2,
                    canvas.getHeight()/2);

            canvas.translate(-(float)imageTranslateX,
                    -(float)imageTranslateY);
            canvas.drawBitmap(pendingUpdate.getImage(), 0, 0, null);

            canvas.restore();
        }else {
            //TODO: update this so it displays image scaled to screen and updates current zoom somehow
            canvas.drawBitmap(pendingUpdate.getImage(),
                    (canvas.getWidth()-iWidth)/2,
                    (canvas.getHeight()-iHeight)/2, null);
        }
        //TODO: draw other stuff on canvas here such as current location    
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:45:31.030

如果我是你，我会使用`Canvas.scale(float sx, float sy, float px, float py)`完全符合你要求的方法。

但是，查看您的代码，我认为您可能一次搞砸了太多转换，这很难调试。

1.  如果你打算改变它，总是（我的意思是*总是*）调用你进入的初始矩阵`Canvas.save()`。这是因为您要在其上绘制的可能是整个窗口的画布，例如，整个窗口的剪裁设置为当前正在绘制自身的控件的边界。`Canvas.restore()``Canvas``Canvas`

2.  使用方法提供的矩阵变换方法，`Canvas`使用最简单的调用绘制位图。

遵循这两个建议，看看`View`我刚刚编造的整体，将点设置为枢轴（不变的点 - 缩放中心）`bitmap`的一个因子。测试 - 工作。`3``(16,16)`

```
public class DrawingView extends View {
    Bitmap bitmap;

    public DrawingView(Context context) {
        super(context);
        bitmap = BitmapFactory.decodeResource(context.getResources(), R.drawable.ic_launcher);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        float sx = 3;
        float sy = 3;
        float px = 16;
        float py = 16;
        canvas.save();
        canvas.scale(sx, sy, px, py);
        canvas.drawBitmap(bitmap, 0, 0, null);
        canvas.restore();
    }
} 
```

# android - 通过不同屏幕缩放对象是如何工作的？

> ID：14678249
> 
> 赞同：0
> 
> 时间：2013-02-03T22:45:33.220
> 
> 标签：android, screen

我是 Android 新手，但我仍然设法设计了一个在我的智能手机上运行良好的应用程序。我阅读了有关 Android 对不同屏幕尺寸的支持的教程，我想：“好吧，那太好了，Android 本身会缩放应用程序以适应其他屏幕尺寸。我只需要为不同的分辨率设置不同的图像，这样它们看起来更好的。” 好吧，看来我不明白它是如何工作的。通过在 Android SDK 中使用虚拟设备，我可以在较小的屏幕尺寸上运行我的应用程序。不幸的是，没有自动“缩放”，我的应用程序布局的一半没有显示在屏幕上。我的智能手机上的一个图像按钮是屏幕的六分之一，它可能占据了这个新的小屏幕的三分之一。我忘记了什么？我阅读了一些解释和其他帖子，但我得到的信息似乎表明不会发生自动缩放......也许我错过了一些基本规则？谢谢

编辑：下面我添加一些我的代码作为示例。即使屏幕尺寸发生变化，我应该如何更改它以使 ImageButtons 以相同的方式填充智能手机屏幕？（如果它是可能的）。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 xmlns:tools="http://schemas.android.com/tools"
 android:layout_width="match_parent"
 android:layout_height="match_parent"
 android:background="@drawable/greenbackground"
 tools:context=".GameFrame" >

  <ImageButton
    android:id="@+id/image1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_marginLeft="30dp"
    android:layout_marginTop="27dp"
    android:background="@android:color/transparent"
    android:clickable="false"
    android:contentDescription="@string/app_name"
    android:src="@drawable/empty" />

  <ImageButton
    android:id="@+id/image2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_toRightOf="@+id/image1"
    android:layout_alignTop="@+id/image1"
    android:layout_marginLeft="16dp"
    android:background="@android:color/transparent"
    android:clickable="false"
    android:contentDescription="@string/app_name"
    android:src="@drawable/empty" />

<ImageButton
    android:id="@+id/image3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginLeft="14dp"
    android:layout_toRightOf="@+id/image2"
    android:layout_alignTop="@+id/image2"
    android:background="@android:color/transparent"
    android:clickable="false"
    android:contentDescription="@string/app_name"
    android:src="@drawable/empty" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:23:41.737

您需要使用 a`ScollView`来显示在小屏幕上不可见的 UI 元素。请记住，a`ScrollView`只能有一个孩子：

```
<ScollView
[...] >

  <MyParentLayout
   [...] >

      <MyUiElements
      [...] >

   </MyParentLayout>

</ScollView> 
```

# ruby-on-rails - 如何在 ruby on rails 模型中指定 2 个外键？

> ID：14678254
> 
> 赞同：1
> 
> 时间：2013-02-03T22:45:57.390
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rubygems, ruby-on-rails-3.2

我希望能够轻松访问 current_users 对话。例如

```
current_user.conversations 
```

问题是当前用户可以是发件人或收件人（sender_id 或 recipient_id）

```
class User < ActiveRecord::Base

  has_many :conversations, :foreign_key => "sender_id" 
```

这可行，但有时发件人是收件人，或者说例如某人作为发件人向某人发送了 10 条消息，而收件人没有回复任何消息，但数据库中仍然存在他们的对话。

如果我以该用户身份登录并键入 current_user.conversations，则不会出现任何内容，因为用户模型中指定的外键是 sender_id。没有办法同时指定两者吗？喜欢在 sql 中使用“OR”吗？

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:36:18.397

我不相信有一种方法可以*完全按照*您的意愿行事，但是您可能需要考虑一些替代方法：

1）将其拆分为两个关系，send_conversations 和 received_conversations，然后您可以定义一个组合它们的方法。

2) 添加一个新的类方法来执行一些自定义 SQL：

```
class User < ActiveRecord::Base
  def conversations
    Conversation.where("sender_id = :id OR receiver_id = :id", id: self.id)
  end
end 
```

# c# - 如何将数组发送到列表框？

> ID：14678259
> 
> 赞同：0
> 
> 时间：2013-02-03T22:46:24.420
> 
> 标签：c#, wpf, winforms, listbox, folderbrowserdialog

我只是想*将*我的一些旧应用程序从 Win-forms 迁移到 WPF。`ListBox`在我的旧 win-form 应用程序中，我可以使用下面的代码向 a 发送一个数组。

在我的新 WPF 应用程序中，这不会填充`ListBox`. 奇怪的是它不会出错，它只是不起作用。

...好吧，当我第一次测试应用程序时它确实出错了，我收到一条消息说我没有权限，但现在它只显示消息说“完成”而不做任何事情。

```
private void btnFolderBrowser_Click(object sender, RoutedEventArgs e)
{
    getFileStructure();
    System.Windows.Forms.MessageBox.Show("done!");
}

private void getFileStructure()
{
    string myDir = "";
    int i;
    string filter = txtFilter.Text;

    FolderBrowserDialog fbd = new FolderBrowserDialog();
    fbd.RootFolder = Environment.SpecialFolder.Desktop;
    fbd.ShowNewFolderButton = false;
    fbd.Description = "Browse to the root directory where the files are stored.";

    if (fbd.ShowDialog() == System.Windows.Forms.DialogResult.OK)
        myDir = fbd.SelectedPath;

    try
    {
        txtRootDir.Text = fbd.SelectedPath;
        string[] fileName = Directory.GetFiles(myDir, filter, SearchOption.AllDirectories);

        for (i = 0; i < fileName.Length; i++)
            lstFileNames.Items.Add(fileName[i]);
    }

    catch (System.Exception excep)
    {
        System.Windows.Forms.MessageBox.Show(excep.Message);
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:11:35.483

在 WPF 中，您应该在后面的代码中填充属性并将您的 UI 元素绑定到这些属性，从后面的代码中引用/访问 UIElements 不是一个好习惯。

这是一个基于我认为您正在尝试做的模型示例。

xml:

```
<Window x:Class="WpfApplication14.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
       Title="MainWindow" Height="350" Width="525" Name="UI">
    <StackPanel DataContext="{Binding ElementName=UI}">
        <TextBox Text="{Binding TextRootDir}" IsReadOnly="True" />
        <ListBox ItemsSource="{Binding MyFiles}" SelectedItem="{Binding SelectedFile}" Height="244" />
        <TextBox Text="{Binding TextFilter, UpdateSourceTrigger=PropertyChanged}" />
        <Button Content="Browse" Click="btnFolderBrowser_Click" >
            <Button.Style>
                <Style TargetType="{x:Type Button}">
                    <Setter Property="IsEnabled" Value="True" />
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding TextFilter}" Value="">
                            <Setter Property="IsEnabled" Value="False" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
    </StackPanel>

</Window> 
```

代码：

```
public partial class MainWindow : Window, INotifyPropertyChanged
{
    private string _textRootDir;
    private string _textFilter = string.Empty;
    private string _selectedFile;
    private ObservableCollection<string> _myFiles = new ObservableCollection<string>();

    public MainWindow()
    {
        InitializeComponent();
    }

    public ObservableCollection<string> MyFiles
    {
        get { return _myFiles; }
        set { _myFiles = value; }
    }

    public string SelectedFile
    {
        get { return _selectedFile; }
        set { _selectedFile = value; NotifyPropertyChanged("SelectedFile"); }
    }

    public string TextFilter
    {
        get { return _textFilter; }
        set { _textFilter = value; NotifyPropertyChanged("TextFilter"); }
    }

    public string TextRootDir
    {
        get { return _textRootDir; }
        set { _textRootDir = value; NotifyPropertyChanged("TextRootDir"); }
    }

    private void btnFolderBrowser_Click(object sender, RoutedEventArgs e)
    {
        GetFileStructure();
        MessageBox.Show("done!");
    }

    private void GetFileStructure()
    {
        string myDir = "";
        System.Windows.Forms.FolderBrowserDialog fbd = new System.Windows.Forms.FolderBrowserDialog();
        fbd.RootFolder = Environment.SpecialFolder.Desktop;
        fbd.ShowNewFolderButton = false;
        fbd.Description = "Browse to the root directory where the files are stored.";

        if (fbd.ShowDialog() == System.Windows.Forms.DialogResult.OK)
        {
            myDir = fbd.SelectedPath;
            try
            {
                TextRootDir = fbd.SelectedPath;
                MyFiles.Clear();
                foreach (var file in Directory.GetFiles(myDir, TextFilter, SearchOption.AllDirectories))
                {
                    MyFiles.Add(file);
                }
            }
            catch (Exception excep)
            {
                MessageBox.Show(excep.Message);
                return;
            }
        }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    public void NotifyPropertyChanged(string propertyName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
    }
} 
```

结果：

![在此处输入图像描述](../Images/090cf1b3b223c2265ff3f178de55dd37.png)

# c# - 使 Form1 中的菜单项从其他表单中检查 true/false

> ID：14678260
> 
> 赞同：0
> 
> 时间：2013-02-03T22:46:26.370
> 
> 标签：c#

如何从其他表单中将 Form1 中的菜单项检查为真/假？

我只是可以更改文本，从其他表单启用/禁用它，但不更改检查状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:56:00.193

您需要将该项目转换为 ToolStripMenuItem，因为 Find 方法返回 ToolStripItem 类型的项目（ToolStripMenuItem 继承自该项目）。

例子：

```
private void FindItAndCheck()
{
    ToolStripMenuItem item = 
       this.MainMenuStrip.Items.Find("exit", true).FirstOrDefault() 
       as ToolStripMenuItem;

    if (item == null) throw new ApplicationException("...");
    else
    {
        item.Checked = true;
    }
} 
```

# google-app-engine - 使用 Google Engine URL 获取 google doc got java.net.SocketTimeoutException

> ID：14678264
> 
> 赞同：0
> 
> 时间：2013-02-03T22:46:39.363
> 
> 标签：google-app-engine

在 google 引擎中，我可以获取网络上的其他 URL，但无法获取 google doc（我尝试了正常的 java url 连接，获取 google doc 没有问题）。

java.net.SocketTimeoutException：获取时超时：[https](https://docs.google.com/uc) ://docs.google.com/uc ....

```
 OutputStream os = resp.getOutputStream();
        URL url = new URL("https://docs.google.com/uc?id=0B-UWER27gDKlUjRkT2czVXpzNDg");
        HttpURLConnection conn = (HttpURLConnection)url.openConnection();
        conn.setInstanceFollowRedirects(true);
        // URL url = new URL("http://www.gradsch.ohio-state.edu/Depo/ETD_Tutorial/lesson2.pdf");
        System.out.println(url);
         byte b[] = new byte[2048];
        InputStream is = url.openStream();
        int len;
        while ((len=is.read(b))!=-1)
        {
            os.write(b, 0, len);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T02:57:56.617

您可以设置请求的最后期限，即服务等待响应的最长时间。默认情况下，获取的最后期限是 5 秒

```
conn.setConnectTimeout(60000);  //60 Seconds
conn.setReadTimeout(60000);  //60 Seconds 
```

请在此处查看文档：[https ://developers.google.com/appengine/docs/java/urlfetch/overview#Fetching_URLs_with_java_net](https://developers.google.com/appengine/docs/java/urlfetch/overview#Fetching_URLs_with_java_net)

# python - 在 Linux 中安装 SetupTools 时出错

> ID：14678266
> 
> 赞同：0
> 
> 时间：2013-02-03T22:46:49.943
> 
> 标签：python, linux, setuptools

所以我尝试在新服务器上安装 setuptools，所以我得到了

```
wget http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg 
```

并尝试`sh setuptools-0.6c11-py2.7.egg`在文件所在的目录中，我得到

```
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ImportError: No module named setuptools.command.easy_install 
```

我在任何地方都找不到任何调试方法。

当我尝试

```
import sys
from setuptools.command.easy_install import bootstrap
sys.exit(bootstrap()) 
```

我明白了

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
ImportError: No module named setuptools.command.easy_install 
```

当我进入`sys.path`python解释器时，它给了我以下信息：

```
['', '/opt/python2.7/lib/python27.zip', '/opt/python2.7/lib/python2.7', '/opt/python2.7/lib/python2.7/plat-linux3', '/opt/python2.7/lib/python2.7/lib-tk', '/opt/python2.7/lib/python2.7/lib-old', '/opt/python2.7/lib/python2.7/lib-dynload', '/opt/python2.7/lib/python2.7/site-packages'] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:56:09.637

你可以尝试一些不同的东西：

*   将文件移动到不同的目录，cd 到同一目录，然后再次尝试运行`sh setuptools-0.6c11-py2.7.egg`.

*   `python2.7`在文件所在的同一目录中打开 python2.7 交互式提示（只需运行）。然后运行：

    ```
    import sys
    from setuptools.command.easy_install import bootstrap
    sys.exit(bootstrap()) 
    ```

    尝试手动安装

*   如果这仍然不起作用，请运行`python2.7`并运行以下 python 代码，并将显示的信息添加到您的问题中：

    ```
    import sys
    import setuptools

    print 'Path:', sys.path
    print 'setuptools package:', setuptools.__file__ 
    ```

最后但并非最不重要的一点是，测试下载的 egg 是否没有以某种方式损坏或截断。测试 md5 哈希和大小：

```
$ md5 setuptools-0.6c11-py2.7.egg 
MD5 (setuptools-0.6c11-py2.7.egg) = fe1f997bc722265116870bc7919059ea
$ ls -l setuptools-0.6c11-py2.7.egg 
-rw-r--r--  1 own  grp  332005 Jul  8  2010 setuptools-0.6c11-py2.7.egg 
```

如果它们不匹配，请重新下载文件并重试。

# python - Memcache 对象在特定日期到期

> ID：14678270
> 
> 赞同：2
> 
> 时间：2013-02-03T22:47:13.547
> 
> 标签：python, memcached

我想将 memcache 对象的到期时间设置为特定日期。

```
cache.set(string, 1, 86400) 
```

上面的声明允许我将其设置为一天，但如果日期更改，它不会过期。我可以处理此问题的一种方法是计算一天中剩余的秒数并将其作为变量提供。

我想知道是否有更简单/有效的方法来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T00:35:08.103

查看[文档](https://developers.google.com/appengine/docs/python/memcache/clientclass#Client_set)，我们看到过期参数解释为：

> 可选的过期时间，可以是当前时间的相对秒数（最多 1 个月），也可以是绝对的 Unix 纪元时间。默认情况下，项目永远不会过期，尽管项目可能会由于内存压力而被驱逐。浮点值将四舍五入到最接近的整数秒。

所以基本上如果你输入的数字小于 2592000，它被解释为一个*相对*时间。*因此，数字 86400 将被解释为从现在*开始的86400 秒（一天），即设置的时间。

看起来您将要使用大于该数字的数字来表示*绝对*时间。有[多种](https://stackoverflow.com/questions/113829/how-to-convert-date-to-timestamp-in-php)方法可以获取 unix 时间戳。但很简单，你可以这样做：

```
time_tuple = (2013, 2, 15, 0, 0, 0,0,0,0)
timestamp = time.mktime(time_tuple)
cache.set(string, 1, timestamp); 
```

你最初的想法是正确的。您现在可以找出时间戳，以及您想要的日期的时间戳并提供差异，这也是等效的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:28:03.137

每天至少每个小时都在变化，不是吗？客户端或服务器必须指定其中哪一个与任何给定请求相关。对于客户端应用程序来说，这通常是一项更好的任务。

请注意，您可以指定绝对时间戳，这可能会更容易计算到期时间，因为您可以在一整天（或至少一个小时）内重复使用它。

# blob - base64 编码的 PNG 到 Blob

> ID：14678271
> 
> 赞同：4
> 
> 时间：2013-02-03T22:47:26.577
> 
> 标签：blob, dart

我正在摆弄用base64编码的PNG创建一个Blob......

```
 final FormData formData = new FormData();
  final String base64Image = "data:image/png;base64,iVBORw0K<reduced the data.....>gg==";

  final Blob blob = new Blob([base64Image],"image/png");

  formData.append('file', blob, "android.png");

  req.send(formData); 
```

我不知道我做错了什么，但 blob 的内容是某种东西，而不是我想要的 png。

提前谢谢...

[**更新**]

```
 final FormData formData = new FormData();
  final String base64Image = "iVBORw0KGgo<...reduce data...>kJggg==";

  // BTW: I used the Base64 from dart-sdk/io/base64.dart
  final List<int> intList = Base64.decode(base64Image);
  final Int8Array int8array = new Int8Array.fromList(intList);
  final String atobString = window.atob(base64Image);

  // Does not work
  // final Blob blob = new Blob([atobString]);

  // The same...
  // final Blob blob = new Blob([int8array]);

  formData.append('file', blob, "android.png");
  //formData.append('new-filename', "icon-share.png");

  req.send(formData); 
```

我认为 Base64.decode 生成的字节数还可以。文件大小为 1003 字节，解码也产生 1003 字节。

[**更新 2** ] 这是我正在谈论的来源： [https ://github.com/MikeMitterer/AndroidIconGenerator.DART/blob/master/test/src/restserver.dart](https://github.com/MikeMitterer/AndroidIconGenerator.DART/blob/master/test/src/restserver.dart)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T19:17:44.840

好的，这是我自己的问题的答案：

```
import 'dart:convert'
...

test(' -> Upload File to REST-Server', () {

  final HttpRequest req = new HttpRequest();

  loadEnd(HttpRequest request) {
    if (request.readyState == HttpRequest.DONE) {

      switch(request.status) {

        case HttpStatus.HTTP_200_OK:
          expect(response['path'].endsWith("android.png"),true);

          break;

        case HttpStatus.HTTP_0_COMMUNICATION_FAILED:
          expect(request.status,HttpStatus.HTTP_200_OK);
          break;

        default:
          expect(request.status,HttpStatus.HTTP_200_OK);
          break;
      }
    }
  }

  req.open("POST", uriprovider.forUpload().toString());

  // REST returns JSON Data
  req.setRequestHeader('Accept', 'application/json');

  req.onLoadEnd.listen(expectAsync1((ProgressEvent e) => loadEnd(req)));

  final FormData formData = new FormData();

  final String base64Image = "data:image/png;base64,iVBORw0KG<code reduce for sample>RU5ErkJggg==";
  final String raw = "iVBORw0KG<code reduce for sample>RU5ErkJggg==";
  final String contenttype = "image/png";

  // Base64 is a modified version of dart-sdk/lib/io/base64.dart
  final List<int> intList = BASE64.decode(raw);
  final Int8Array int8array = new Int8Array.fromList(intList);

  // Converting to Uint8Array brought the solution!
  final Uint8Array uint8array = new Uint8Array(intList.length);

  // does not work!
  //var binary = window.atob(raw);

  final Blob blob = new Blob([uint8array]);

  formData.append('file', blob, "android.png");

  req.send(formData);

}); 
```

感谢大家把我推向正确的方向！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T09:43:30.090

在编码为 Blob 之前，需要**解码 base64 （即 atob）url。**这很简单！试试看！

# c# - 删除 FileSystemWatcher 正在监视的文件夹

> ID：14678275
> 
> 赞同：2
> 
> 时间：2013-02-03T22:47:37.527
> 
> 标签：c#, directory

我想创建一个应用程序，而不是只查看根层次结构文件夹，......我单独查看每个文件夹（关闭监视子文件夹）

但是，我似乎无法正确获取删除逻辑。我希望能够删除层次结构中的任何文件夹，无论是在应用程序内部，还是在外部，比如通过 Windows 资源管理器。

当我尝试其中任何一个时，我似乎遇到了锁定问题，因为删除命令无法执行。

如果我禁用观看，那么一切似乎都正常。所以我假设问题是试图删除正在监视的文件夹。

有没有办法解决这个问题？理想情况下，我希望 fileSystemWatcher 在其监视的文件夹已被删除时自动停止监视。

```
public MainWindow()
{
    InitializeComponent();

    fsw1 = new FileSystemWatcher()
    {
        Path = "Folder",
        NotifyFilter = NotifyFilters.LastWrite | NotifyFilters.LastAccess | NotifyFilters.FileName | NotifyFilters.DirectoryName,
        IncludeSubdirectories = false,
        Filter = "",
        EnableRaisingEvents = true
    };

    fsw1.Deleted += new FileSystemEventHandler(OnFileSystemItemDeleted);

    fsw2 = new FileSystemWatcher()
    {
        Path = "Folder/Folder",
        NotifyFilter = NotifyFilters.LastWrite | NotifyFilters.LastAccess | NotifyFilters.FileName | NotifyFilters.DirectoryName,
        IncludeSubdirectories = false,
        Filter = "",
        EnableRaisingEvents = true
    };

    fsw2.Deleted += new FileSystemEventHandler(OnFileSystemItemDeleted);
}

protected override void OnMouseLeftButtonDown(MouseButtonEventArgs e)
{
    base.OnMouseLeftButtonDown(e);

    //fsw1.EnableRaisingEvents = false;
    //fsw2.EnableRaisingEvents = false;

    System.IO.Directory.Delete("Folder", true);
}

void OnFileSystemItemDeleted(object sender, FileSystemEventArgs e)
{

}

FileSystemWatcher fsw1, fsw2; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-09T17:29:15.030

目前，您正在使用 fsw1 和 fsw2 来查看可能在任何时间点被删除的任何类型的数据。

虽然，我没有看到为每个文件夹创建 FSW 的意义，但这里有一个可能有帮助的答案：

为了观察文件夹本身，您需要为要观察的每个文件夹创建一个 FSW。

然后，您可以将 FSW 的 NotifyFilter 设置为 DirectoryName，如下所示：`folderSystemWatcher.NotifyFilter = NotifyFilter.DirectoryName`

[在这里](https://stackoverflow.com/questions/3336637/net-filesystemwatcher-was-it-a-file-or-a-directory)看到一个例子。

因此，其中一个 FSW 会告诉您某个文件夹已被删除，然后您可以停止、处置或对正在查看该已删除文件夹的 FSW 执行任何操作。

我没有尝试过，但我想这就是我会这样做的方式......

# pdf - 将pdf转换为png：为什么ghostscript需要永远？

> ID：14678276
> 
> 赞同：0
> 
> 时间：2013-02-03T22:47:38.087
> 
> 标签：pdf, ghostscript

我正在用这样的ghostscript转换图像：

```
 gs -sDEVICE=png16m -r75 \
    -dNOPAUSE -dBATCH -dSAFER \
    -sOutputFile="$output-%03dl.png" "$file" 
```

在某些图像上，这需要很长时间（> 10 分钟）。

如果我在同一张图像上使用带有默认值（因此分辨率更高）的 pdftoppm，则只需不到一分钟。

谁能告诉我为什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T09:20:40.593

不是没有看到有问题的 PDF 文件，没有。引用 Ghostscript 的版本也可能具有指导意义。一种可能性是正在对图像进行插值，这是一项昂贵的操作，您可以尝试 -dNOINTERPOLATE

# php - 获取任何语言环境的“列表分隔符”字符

> ID：14678281
> 
> 赞同：4
> 
> 时间：2013-02-03T22:48:11.393
> 
> 标签：php, csv, locale, intl

仅从客户端提供的区域设置标识符名称（字符串）开始，我如何或在哪里查找该区域设置的默认“列表分隔符”字符？

“列表分隔符”设置是许多不同类型的应用程序和编程语言在连接或拆分字符串和数组时可能用作默认分组字符的字符。这对于在电子表格程序中打开 CSV 文件尤其重要。虽然这通常是逗号“，”，但此默认字符可能会因机器的区域设置而异。它甚至可能在操作系统之间有所不同。

我对我自己的服务器环境不感兴趣。相反，我需要根据他们提供给我的语言环境标识符来了解更多关于客户端的信息，因此我自己的服务器设置是无关紧要的。同样对于此解决方案，我无法更改此服务器上的区域设置以匹配整个当前进程的客户端作为查找此值的快捷方式。

如果这是在 ICU 库中定义的，我无法找到使用[`INTL`扩展名](http://www.php.net/manual/en/book.intl.php)查找此值的任何方法。

有什么提示吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T19:28:45.653

我不确定我的回答是否能满足您的要求，但我建议（尤其是当您不想更改服务器上的语言环境时）使用可以为您提供答案的函数：

据我所知（[似乎还有维基百科](http://en.wikipedia.org/wiki/Comma-separated_values#Lack_of_a_standard)），CSV 中的列表分隔符是逗号，除非语言环境的小数点是逗号，在这种情况下，列表分隔符是分号。

因此，您可以使用以下命令获取使用逗号 (Unicode U+002C) 作为分隔符的所有语言环境的列表：

```
cd /usr/share/i18n/locales/
grep decimal_point.*2C *_* -l 
```

然后您可以使用此列表来确定适当的列表分隔符：

```
function get_csv_list_separator($locale) {
    $locales_with_comma_separator =  "az_AZ be_BY bg_BG bs_BA ca_ES crh_UA cs_CZ da_DK de_AT de_BE de_DE de_LU el_CY el_GR es_AR es_BO es_CL es_CO es_CR es_EC es_ES es_PY es_UY es_VE et_EE eu_ES eu_ES@euro ff_SN fi_FI fr_BE fr_CA fr_FR fr_LU gl_ES hr_HR ht_HT hu_HU id_ID is_IS it_IT ka_GE kk_KZ ky_KG lt_LT lv_LV mg_MG mk_MK mn_MN nb_NO nl_AW nl_NL nn_NO pap_AN pl_PL pt_BR pt_PT ro_RO ru_RU ru_UA rw_RW se_NO sk_SK sl_SI sq_AL sq_MK sr_ME sr_RS sr_RS@latin sv_SE tg_TJ tr_TR tt_RU@iqtelif uk_UA vi_VN wo_SN");
    if (stripos($locales_with_comma_separator, $locale) !== false) {
        return ";";
    }
    return ",";
} 
```

（语言环境列表取自我自己的Debian机器，我不知道列表的完整性）

如果您不想拥有此静态语言环境列表（尽管我认为这不会经常更改*）*，您当然可以使用上面的命令生成列表并将其缓存。

最后一点，根据[RFC4180 第 2.6 节](https://www.rfc-editor.org/rfc/rfc4180)，列表分隔符实际上永远不会改变，而是包含逗号的字段（因此这也意味着浮点数，取决于语言环境）应该用双引号括起来。虽然（如上链接）没有多少人遵循 RFC 标准。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T08:25:12.727

没有像“列表分隔符”这样的语言环境设置，它可能是特定于软件的，但我怀疑它是特定于用户的。

但是...您可以检测用户的语言环境并尝试匹配设置。

1.  获取浏览器区域设置：`$accept_lang = $_SERVER['HTTP_ACCEPT_LANGUAGE'];`这可能包含逗号分隔值的列表。一些浏览器虽然不发送这个。[更多在这里...](http://php.net/manual/en/reserved.variables.server.php)

2.  接下来，您可以在此处`setlocale(LC_ALL, $accept_lang);`使用更多内容并获取可用的区域设置 `$locale_info = localeconv();` [...](http://php.net/manual/en/function.localeconv.php)

# scala - 类型别名搞砸了类型标签？

> ID：14678292
> 
> 赞同：2
> 
> 时间：2013-02-03T22:49:38.650
> 
> 标签：scala, reflection, scala-2.10

为什么类型标签不能与类型别名一起使用。例如给定

```
trait Foo
object Bar {
  def apply[A](implicit tpe: reflect.runtime.universe.TypeTag[A]): Bar[A] = ???
}
trait Bar[A] 
```

我想在以下方法中使用别名，因为我需要输入`A`大约两打：

```
def test {
  type A = Foo
  implicit val fooTpe = reflect.runtime.universe.typeOf[A] // no funciona
  Bar[A]                                                   // no funciona
} 
```

下次尝试：

```
def test {
  type A = Foo
  implicit val fooTpe = reflect.runtime.universe.typeOf[Foo] // ok
  Bar[A]                                                     // no funciona
} 
```

所以看来我根本不能使用我的别名。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T10:40:34.900

改用weakTypeOf。反射在内部区分全局可见和局部声明，因此您也需要区别对待它们。这个疣可能会在更高版本的 Scala 中被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:36:23.707

变更`def apply`声明：

```
import scala.reflect.runtime.universe._
trait Foo
object Bar {
  def apply[A]()(implicit tpe: TypeTag[A]): Bar[A] = ???
}
trait Bar[A]
class test {
  type A = Foo
  implicit val foo = typeOf[A]
  def test = Bar[A]()                                                 
} 
```

# mysql - MySQL - 不止一行显示 AVG

> ID：14678294
> 
> 赞同：1
> 
> 时间：2013-02-03T22:49:42.813
> 
> 标签：mysql, sql, aggregate-functions

如果我运行一个包含 的查询，`Aggregation function (AVG)`有什么方法可以让它显示在多行上？我需要的查询类似于：

```
SELECT field1, field2, AVG(field2) FROM tMyTable; 
```

我需要的输出是这样的：

```
field 1 | field 2 | AVG(field2)               
record1 | 1.17    | 1.19     
record2 | 1.21    | 1.19    
record3 | 1.18    | 1.19 
```

如您所见，我需要在每一行上显示平均输出。我明白这可能是/是一种非正统的方法，但是我使用的图表应用程序需要这种输出格式。

如果有任何可用的方法，那么我将不胜感激您的建议。也许嵌套第二次查找？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:53:15.050

```
SELECT field1,field2,(SELECT AVG(field2) FROM Table) AS AvgFieldTwo
FROM Table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:03:42.663

您还可以使用`CROSS JOIN`：

```
SELECT field1, field2, src.AvgField2
FROM MyTable
CROSS JOIN
(
  SELECT avg(field2) AvgField2
  FROM MyTable
) src 
```

# c# - 在二维排序数组中找到 k 个最小\最大的元素

> ID：14678296
> 
> 赞同：-3
> 
> 时间：2013-02-03T22:49:56.173
> 
> 标签：c#, algorithm, data-structures

给定一个二维数组。行和列已排序。

以最有效的方式从二维数组中找到第 k 个最大的元素。可以就地完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T06:05:56.507

一个稍微蛮力的就地解决方案：尝试通过二进制搜索来猜测值。你知道最大值和最小值（它们在角落里）。对于每个候选者，在遵循较小和较大元素之间的边界时计算较小元素的数量。由于数组是排序的，这个边界是一条相当短的路径穿过它。跟踪较小元素中最大值的位置。该值可能会出现多次。数一数。假设一个 NxN 数组，这将需要 O(N*B)，其中 B 是值的位数。

我只是在大声思考......我隐约记得阅读过一个令人难以置信的最佳解决方案，但我不知道在哪里。

# jquery - 如何将jQuery对象数组转换为单个对象

> ID：14678301
> 
> 赞同：0
> 
> 时间：2013-02-03T22:50:42.600
> 
> 标签：jquery

**我想将 jQuery 对象数组转换为单个 jQuery 对象，每个元素“在”最后一个创建的元素“之后”：**

测试 HTML：

```
<div id="test">asd</div>
<a></a> 
```

JS：

```
 var createElem = function(numElems) {
        var elems;
        for(var i=0; i<numElems; i+=1) {
            elems.push($("#test").clone());
        }

        return elems;

    };

    $("a").append(createElem(20)); // fails because its an array and not a jQuery object 
```

我知道我可以创建一个元素并将我所有的克隆放入其中：

```
 var createElem = function(numElems) {
        var elem = $('<div>');

        for(var i=0; i<numElems; i+=1) {
            elem.append($("#test").clone());
        }

        return elem;

    }; 
```

但我宁愿不处理在返回之前必须从这个父包装器中取出元素的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:55:15.103

需要先定义`elems`为数组才能使用`push`

```
var elems=[]; 
```

编辑：`<div>`不是有效的孩子`<a>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:53:28.457

确保初始化数组。

```
 var createElem = function(numElems) {
        var elems = [];
        for(var i=0; i<numElems; i+=1) {
            elems.push($("#test").clone());
        }

        return elems;

    }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T23:03:05.040

尝试像这样使用附加：

```
$("a").append(null,createElem(20)); 
```

根据[jQuery docs](http://api.jquery.com/append/)（我自己也试过）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T23:55:45.487

```
var createElem = function ( numElems ) {
    var $elems = $(),
        $test = $( '#test' ),
        index = 0;

    for ( ; index < numElems; index++ ) {
        $elems = $elems.add( $test.clone() );
    }

    return $elems;

}; 
```

看看情况如何。我相当确定逻辑是正确的，我只是无法通过手机进行测试。

# ember.js - 带有 ember 数据的 ember js，浏览器前后移动会导致重新加载使用 find() 请求的模型

> ID：14678307
> 
> 赞同：0
> 
> 时间：2013-02-03T22:51:38.543
> 
> 标签：ember.js, ember-data

我只是构建小应用程序来测试路由器。每个模型都会加载一次，每当我要求它时，下次我通过单击链接访问相同的 url 时，我会看到缓存的结果。一切都很好，但随后我点击了浏览器上的返回按钮，我看到了一个对服务器的请求，该请求是以前用`find()`aka询问的模型`findAll()`。每次我点击浏览器上的后退或前进按钮时都会发生这种情况，无论我使用`location: 'history'`或`location: 'hash'`

我只有两个模型，一个请求 with `find()`，另一个请求 via `find(id)`。所以我现在想知道这是否会以这种方式发生，或者我的应用程序存在一些我应该寻找的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:44:34.123

当然，这不是它应该如何工作的。我们有一个使用 location: 'history' 和几个模型的应用程序，当用户在浏览器中单击后退/前进时，它们会保持缓存。

# mysql - MySQL CSV 导入未插入 0

> ID：14678309
> 
> 赞同：0
> 
> 时间：2013-02-03T22:51:41.283
> 
> 标签：mysql, phpmyadmin

我正在尝试`.txt`使用 phpmyadmin 导入 CSV 格式的文件。它是美国的邮政编码数据库。当我选择导入选项然后加载文件时，除了以 a 开头的 ZipCode 之外，所有内容都已成功插入`0`它不会添加`0`'，因此例如 ZipCode`00601`被添加为`601`，`01234`被添加为`1234`。有没有人经历过这种情况或知道防止这种情况的方法？我在`.txt`下面包含了一个文件片段。

片段：

```
"00601","+18.165273","-066.722583","ADJUNTAS","PR","ADJUNTAS","STANDARD"
"00602","+18.393103","-067.180953","AGUADA","PR","AGUADA","STANDARD"
"00603","+18.455913","-067.145780","AGUADILLA","PR","AGUADILLA","STANDARD"
"00604","+18.493520","-067.135883","AGUADILLA","PR","AGUADILLA","STANDARD" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:56:11.800

您可能将 ZipCode 数据类型设为 Integer，这就是省略前导零的原因。将 ZipCode 数据类型更改为 char(5)，如下所示： [Mysql Datatype for US Zip (Postal Codes)](https://stackoverflow.com/questions/1493926/mysql-datatype-for-us-zip-postal-codes)

# uiscrollview - UIScrollView + 自动布局问题

> ID：14678310
> 
> 赞同：2
> 
> 时间：2013-02-03T22:51:51.117
> 
> 标签：uiscrollview, constraints, autolayout

考虑以下结构：

| UIScrollView | UITextField | （左侧为 UIScrollView，右侧为 UITextField）

我正在尝试将 UILabel 添加到 UIScrollView 并使 UIScrollView 根据 UILabel 大小增长。UITextFiled 会随着 UIScrollView 的增长而变小。

```
- (IBAction)makeScrollViewGrow:(id)sender
    self.myScrollView.translatesAutoresizingMaskIntoConstraints = NO;
    self.myTextField.translatesAutoresizingMaskIntoConstraints = NO;
    UILabel *myLabel = [[UILabel alloc] init];
    myLabel.text = @"THIS IS A LONG MESSAGE";
    myLabel.translatesAutoresizingMaskIntoConstraints = NO;
    [self.myScrollView addSubview:myLabel];
    UITextField *theTextField = self.myTextField;
    [self.myTextField removeConstraint:self.titleTextFieldWidthConstraint];
    [self.myScrollView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|[myLabel]|" options:0 metrics:0 views:NSDictionaryOfVariableBindings(myLabel)]];
    [self.myScrollView addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[myLabel]|" options:0 metrics:0 views:NSDictionaryOfVariableBindings(myLabel)]];
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"H:|-20-[theSCrollView]-8-[theTextField]-20-|" options:0 metrics: 0 views:NSDictionaryOfVariableBindings(theSCrollView, theTextField)]];
    [self.view addConstraints:[NSLayoutConstraint constraintsWithVisualFormat:@"V:|[theSCrollView]|" options:0 metrics: 0 views:NSDictionaryOfVariableBindings(theSCrollView)]];
} 
```

这里的问题是 UIScrollView 没有被调整大小，因为 UITextField 具有固定的宽度。如果我以编程方式删除宽度 UITextField 约束，UIScrollView 将接管所有宽度而不考虑文本标签（intrinsicContentSize）。我需要手动设置 Scrollview contentsize 还是可以使用自动布局自动设置？

谢谢

# scala - 使用 Manifest（或 TypeTag）隐式参数时重载失败？

> ID：14678312
> 
> 赞同：0
> 
> 时间：2013-02-03T22:52:32.947
> 
> 标签：scala

考虑以下（无用的）高阶函数，它试图访问其传递函数参数的清单：

```
def foo[T <: (P1) => Unit, P1](f: T)(implicit p1: Manifest[P1]) {} 
```

这是一个编译良好的示例：

```
def theFunc(i: Int) {}
def foo[T <: (P1) => Unit, P1](f: T)(implicit p1: Manifest[P1]) {}
foo(theFunc _) 
```

假设我们要添加一个支持两个参数函数的重载：

```
def theFunc(i: Int) {}
def foo[T <: (P1) => Unit, P1](f: T)(implicit p1: Manifest[P1]) {}
def foo[T <: (P1, P2) => Unit, P1, P2](f: T)(implicit p1: Manifest[P1], p2: Manifest[P2]) {}
foo(theFunc _) 
```

..编译器说没那么快：

```
overloaded method value foo with alternatives:
[error]   [T(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo) <: (P1, P2) => Unit, P1, P2](f: T(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo))(implicit p1: Manifest[P1], implicit p2: Manifest[P2])Unit <and>
[error]   [T(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo) <: P1 => Unit, P1](f: T(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo)(in method foo))(implicit p1: Manifest[P1])Unit
[error]  cannot be applied to (Int => Unit)
[error]     foo(theFunc _)
[error]     ^
[error] one error found 
```

好的，如果我们去掉 Manifest 隐式参数呢？

```
def theFunc(i: Int) {}
def foo[T <: (P1) => Unit, P1](f: T) {}
def foo[T <: (P1, P2) => Unit, P1, P2](f: T) {}
foo(theFunc _) 
```

再次编译正常！

使用一些不同类型的隐式参数怎么样？

```
def theFunc(i: Int) {}
def foo[T <: (P1) => Unit, P1](f: T)(implicit i: Int) {}
def foo[T <: (P1, P2) => Unit, P1, P2](f: T)(implicit i: Int, s: String) {}

implicit val i = 3
implicit val s = "hi"

foo(theFunc _) 
```

也编译得很好。

有人知道这里发生了什么吗？我正在运行 Scala 2.10.0。我尝试将 TypeTags 交换为 Manifests 并得到相同的错误，所以我猜测它特定于编译器提供的隐式。

请注意，对于我的真实用例，我很确定将 T 定义为类型参数是必需的，因为我需要它的 TypeTag；我不相信下面提出的存在类型替代方案会起作用。

[如果有人感兴趣，这是我的实际代码——它是 Lift 中 jsonCall 的抽象，用于从 Scala 函数创建 AnonFunc JsExps。](https://gist.github.com/9840ae5a37d4b03c759a)

谢谢！

* * *

**更新**：为什么我不能像 Régis Jean-Gilles 建议的那样使用存在类型？

在我上面链接的真实用例中，我还需要传递函数的 TypeTag。我传递的不是匿名函数，而是扩展 Function2 的对象：

```
object MyFunc extends ((Int, String) => JsCmd) {
  def apply(myInt: Int, myString: String) = JsCmds.Noop
} 
```

这使我可以通过 TypeTag 读取函数的参数名称（[请参阅要点](https://gist.github.com/9840ae5a37d4b03c759a)）。

练习一些关于存在类型的天真，我尝试了这个：

```
object MyFunc extends ((Int, String) => Unit) {
  def apply(myInt: Int, myString: String) {}
}

def foo[P1, P2, T](f: T forSome { type T <: (P1, P2) => Unit})(implicit tag: TypeTag[T],  p1: Manifest[P1], p2: Manifest[P2]) = tag

foo(MyFunc) 
```

这当然会产生：

```
<console>:12: error: type parameter not specified
                  foo(MyFunc)
                     ^ 
```

* * *

如果我正在滥用类型系统，请立即阻止我，但是**如果对重载的原始问题没有令人满意的答案，这难道不是编译器错误吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:16:28.423

第一个问题是为什么你有这么复杂的类型参数？查看您的示例，您似乎可以很好地转换这些定义：

```
def foo[T <: (P1) => Unit, P1](f: T)(implicit p1: Manifest[P1]) {}
def foo[T <: (P1, P2) => Unit, P1, P2](f: T)(implicit p1: Manifest[P1], p2: Manifest[P2]) {} 
```

进入更简单的定义：

```
def foo[P1](f: P1 => Unit)(implicit p1: Manifest[P1]) {}
def foo[P1, P2](f: (P1, P2) => Unit)(implicit p1: Manifest[P1], p2: Manifest[P2]) {} 
```

使用后者，对`foo`编译的调用很好。

如果出于某种原因您确实需要该类型`T`（例如，您的实际代码定义了扩展函数的类型，**并且**您的`foo`方法返回的内容取决于函数的确切类型），您可以依赖存在类型：

```
def foo[P1](f: T forSome { type T <: (P1) => Unit})(implicit p1: Manifest[P1]) {}
def foo[P1, P2](f: T forSome { type T <: (P1, P2) => Unit})(implicit p1: Manifest[P1], p2: Manifest[P2]) {} 
```

至于为什么你首先会出错，老实说，我没有确凿的解释。

* * *

**更新**：好的，所以从你下面的评论来看，我的直觉似乎很好：你过度简化了你的例子，因为你确实**需要**类型参数 T。

我说**似乎**是因为老实说，我看不出您`TypeTag[T]`将如何在您发布的要点中获得任何帮助。查看代码，您显然使用`TypeTag`only 来尝试提取参数名称。问题是您实际上正在获取`apply`函数对象方法的参数名称。换句话说，`v1`无论[函数](http://www.scala-lang.org/api/current/index.html#scala.Function2)对象`v2`是否`Function2`为包装具有不同参数名称的方法。

也就是说，我从现在开始假设您确实需要`TypeTag`为函数类型获取一个。我上面给出的第一个解决方案实际上没有问题（根本没有`T`参数的那个），所以你可能想再试一次。插图：

```
def foo[P1](f: P1 => Unit)(implicit tag: TypeTag[P1 => Unit], p1: Manifest[P1]) { println( "TypeTag: " + tag ) }
def foo[P1, P2](f: (P1, P2) => Unit)(implicit tag: TypeTag[(P1, P2) => Unit], p1: Manifest[P1], p2: Manifest[P2]) { println( "TypeTag: " + tag ) }
foo(theFunc _) 
```

结果：

```
TypeTag: TypeTag[Int => Unit] 
```

对我来说似乎还可以。所以我建议只使用它。

请注意，对于existentials，这根本不会编译（所以我不知道你在哪里设法得到`Any`）：

```
def foo[P1](f: T forSome { type T <: (P1) => Unit})(implicit tag: TypeTag[T],  p1: Manifest[P1]) {}
def foo[P1, P2](f: T forSome { type T <: (P1, P2) => Unit})(implicit tag: TypeTag[T],  p1: Manifest[P1], p2: Manifest[P2]) {}

<console>:15: error: not found: type T
          def foo[P1, P2](f: T forSome { type T <: (P1, P2) => Unit})(implicit tag: TypeTag[T],  p1: Manifest[P1], p2: Manifest[P2]) {}
                                                                                            ^
<console>:14: error: not found: type T
          def foo[P1](f: T forSome { type T <: (P1) => Unit})(implicit tag: TypeTag[T],  p1: Manifest[P1]) {} 
```

# mysql - 给定表是 3000 万条记录，如何检查 id 是否存在于另一个表中？

> ID：14678317
> 
> 赞同：2
> 
> 时间：2013-02-03T22:52:53.327
> 
> 标签：mysql, performance, bigdata

我知道这个问题似乎是重复的，但我不知道如何以不同的方式提出问题。

我在 MySQL 数据库中有两个非常简单的表，第一个是表`Users`

```
id,   user_id
 1       1
 2       3
 4       4 
```

二是表友

```
id,    user_id,    friend_id
 1        1             3
 2        1             4
 3        1             8 
```

我从我想要清理的 CSV 文件中转储了数据。我需要检查表 1 中是否还存在friend_id。第一个表大约有 30000 行，但第二个表大约有 3000 万行。

我用这个查询来检查

```
 SELECT u.user_id, uf.friend_id as exists_friend_ids
FROM Users u, Friends uf
WHERE u.user_id = '1'
    and uf.friend_id IN (select user_id from eventify.Users) 

```

但是，我想要的输出是这样的，但是由于我无法运行上述查询来实际给出我的测试结果，所以我无法继续。

```
user_id,   exists_friend_ids
    1            3
    1            4 
```

您可以看到 8 不存在，因为它在 Users 表中不存在。但由于第二个表有超过 3000 万条记录，它只是在我的计算机上永远运行。我做得对还是这是唯一的方法。还是我应该学习 Hadoop？

我已更新我的查询以使用相等连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:17:34.793

您是否尝试过使用 GROUP BYfriend_id 的 LEFT JOIN 查询？如果用户不存在，它不会在结果中添加一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:38:21.567

如果您所做的只是清理表，那么您有一些灵活性，因为查询运行缓慢这一事实不会产生很大的影响，因为您只想运行一次。这里有几个不同的选项：

1.  使用左连接查找 users 表中没有相应好友 ID 的好友中的行（未经测试）：

    SELECT Friends.id, Users.user_id FROM Friends LEFT JOIN Users on Friends.friend_id = Users.user_id WHERE Users.user_id 为 NULL

    然后删除你找到的记录

2.  使用内部连接来查找存在的朋友。然后用这些记录创建一个新表（未经测试）

    SELECT Friends.id, Users.user_id FROM Friends INNER JOIN Users on Friends.friend_id = Users.user_id

    并将结果行插入到一个新表中，该表将成为您的新“朋友”表。

希望有帮助

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-03T23:18:45.467

我不明白你为什么在这里做 CASE 构造。如果您想获取 users 表中不存在的所有朋友 ID 的列表，那么类似：

```
select friends.friend_id,
       count(*) 
  from friends
 where friends.friend_id not in (select users.user_id
                                   from users)
 group by 1 
```

您当然会有关于 users.user_id 的索引...

# javascript - 在 javascript 运行之前未创建 Div

> ID：14678320
> 
> 赞同：0
> 
> 时间：2013-02-03T22:53:18.740
> 
> 标签：javascript, onload, classname

我有一个关于 javascript/html 的问题。

首先，我有这个：

```
var post = document.body.getElementsByClassName("post");  
var x=post[i].getElementsByClassName("MyDiv")[0].innerHTML; 
```

**我从未定义**的调试器中得到`x`，它不存在。

 **这个 javascript 函数运行`onload`主体。我确信我在我的 javascript 中给出了正确的类名，所以它应该找到我的 div。

所以，我在某处读到，有时 javascript 找不到元素，因为它**还不存在**，它还没有在浏览器中创建（不管这意味着什么）。

由于这个原因，我的函数是否有可能找不到具有该类名的 div？

有解决办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:14:19.353

好的，不要用 调用函数，而是 `body onload`使用 jQuery 的`ready()`函数，或者，如果你不想使用 jQuery，你可以使用纯 javascript，但这取决于你：

```
// jQuery
$(document).ready(function() {
    var post = document.getElementsByClassName("post"),
    x = post[i].getElementsByClassName("MyDiv")[0].innerHTML;
});

// JavaScript
window.onload = function initialization() {
    var post = document.getElementsByClassName("post"),
    x = post[i].getElementsByClassName("MyDiv")[0].innerHTML;
} 
```

一些旁注，我不知道它的用途`innerHTML` 是什么，而且如果你正在做一个 for 循环，`i`那么肯定会发布该代码，这很重要。

经过一番讨论，我的回答似乎对您有用，但您也可以按照@RobG 的建议将脚本放在正文标签的末尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T02:30:24.550

> 所以，我在某处读到，有时 javascript 找不到元素，因为它还不存在，它还没有在浏览器中创建（不管这意味着什么）。

浏览器在获取标记时会逐步创建 DOM。当遇到脚本元素时，所有标记处理都会在脚本运行时停止（除了[defer 和 async](http://www.w3.org/TR/2008/WD-html5-20080610/tabular.html#defer)有影响的地方）。如果脚本尝试访问尚未创建的元素（可能是因为尚未处理其标记），则不会找到它。

> 此 javascript 函数运行正文的加载。

如果这意味着您正在使用类似的东西：

```
<body onload="someFn()"...> 
```

也许

```
<script>
  window.onload = function() {
    someFn();
    ...
  }
</script> 
```

然后在调用该函数时，所有 DOM 节点都可用。有些，如图像，可能没有完全加载，但它们的元素已经创建。

如果这意味着您在正文中有脚本并且没有使用该`load`事件，您应该将脚本移动到页面底部（例如，就在结束`body`标记之前）并查看是否可以解决问题。**

# android - 如何从 webChromeClient 开始另一个活动

> ID：14678321
> 
> 赞同：3
> 
> 时间：2013-02-03T22:53:20.467
> 
> 标签：android, android-activity, webviewclient, webchromeclient

在 webViewClient 中，我使用 shouldOverrideUrlLoading 来检查链接/url 并加载另一个活动，但是如何在 webChromeClient 中执行相同的技巧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:10:39.260

你不能在`webChromeClient`. 您必须同时设置`webViewClient`和`webChromeClient`。

# c - p 和 a 有什么区别？

> ID：14678323
> 
> 赞同：0
> 
> 时间：2013-02-03T22:53:21.260
> 
> 标签：c, pointers

> **可能重复：**
> [数组名称是 C 中的指针吗？](https://stackoverflow.com/questions/1641957/is-array-name-a-pointer-in-c)

`p`C 中的和有什么区别`a`？

```
float a[10],*p; p=a; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:56:20.947

如果我们将“差异”定义为减法的结果，则答案*为零*：

```
assert((p-a) == 0); 
```

...直到您分配一些其他指针值`p`（您不能这样做`a`，因为它没有命名指针变量：它命名了一个数组，该数组在适当的上下文中*衰减为指针；**还有*其他上下文，例如`sizeof(p)!=sizeof(a)`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:00:25.290

```
float a[10],*p; p=a; 
```

`a`是 10 的数组`float`。

`p`是指向 的指针`float`。它指向 的第一个元素`a`。

在 C 中，数组不是指针。数组和指针是两种不同的类型。例如：

```
sizeof a;   // compute the size of an array
sizeof p;   // compute the size of a pointer

p = &a[1];  // this is valid, p points to the second element of a
a = &p[1];  // this is not valid, you cannot assign to an array 
```

# php - php在存储在db中的日期之前安排电子邮件这么多天

> ID：14678325
> 
> 赞同：0
> 
> 时间：2013-02-03T22:53:32.430
> 
> 标签：php, cron, schedule

我将如何安排一封电子邮件在某个日期前这么多天/几周发出？

我为正在创建的提醒服务设置了 cron 作业。目前，cron 作业在当天发送电子邮件提醒。我想在存储在数据库中的日期前 2 周发送电子邮件提醒。

关于如何实现这一目标的任何想法？

谢谢，丹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:55:01.820

您几乎已经具备此逻辑，如果您在当天发送电子邮件，那么只需将它应该检查的日期从今天更改为两周后的日期。

# excel-2010 - 如何使用工作簿 1 中的值查找工作簿 2 中的值？

> ID：14678326
> 
> 赞同：0
> 
> 时间：2013-02-03T22:53:35.543
> 
> 标签：excel-2010

在工作簿 1 中，我有两列值。第一列是零件编号，第二列是数量。从顶部开始，我想从 workbook1 中查找零件号，看看它是否在 workbook2 中。如果没有，则进入下一部分。如果是这样，则从工作簿 1 中获取数量并将该数量发布到工作簿 2 中。

我是 Excel 新手，我有一些编写宏的知识，但我绝对是初学者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-20T19:14:52.823

为了回答：

根据OP，这有效：-

```
=IFERROR(VLOOKUP(A13,[Book2.xlsx]Sheet1!$A$1:$D$17,4,FALSE),0) 
```

# django - Shopify Django 应用程序在最终确定中的 shopify_app/views.py 中失败

> ID：14678327
> 
> 赞同：1
> 
> 时间：2013-02-03T22:53:52.070
> 
> 标签：django, heroku, shopify

我创建了一个托管在 Heroku 上的 Shopify 应用。我必须将 shopify 应用程序的名称从 shopify_app 修改为 shopifyapp 以便 Heroku 将其识别为 Django 应用程序。

如果我通过 app-name.herokuapp/login 直接访问我的应用并将应用连接到我的商店，它会正确提取我最近的订单和产品。

如果我通过应用程序菜单访问应用程序并重定向到 app-name.herokuapp/login/finalize 它显示

/login/finalize/ 处的 KeyError

我没有修改 shopify_app 中的任何内容，只是将其名称更改为 shopifyapp 无处不在。

我怀疑由于应用程序无法完成，这就是为什么这样的链接也不起作用的原因：https://{{ current_shop.domain }}/admin/orders/{{ order.id }}">{{ order. name }} 他们只是直接指向类似的东西

```
 https://admin/orders/000000000 
```

任何人都可以使用 shopify 应用程序帮助解决此问题吗？

我已经公开了我的应用程序仓库，因为它本质上仍然只是演示应用程序： [https ://github.com/dpetrillo740/scm](https://github.com/dpetrillo740/scm)

应用程序在[http://scmapp.herokuapp.com/运行](http://scmapp.herokuapp.com/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T15:13:49.557

这是演示应用程序中的一个错误。我刚刚用这个提交[27d5091](https://github.com/Shopify/shopify_django_app/commit/27d5091aa57695bfca4525f55fdf5a09e836ec10)修复了它。

将应用程序 url 中的路径从 /login/finalize 更新为 /login。现在提供 redirect_uri 用于使用 shopify 进行身份验证，因此它仍将重定向回 finalize 端点。

# c++ - 为派生的可变参数类模板调用函数模板重载

> ID：14678330
> 
> 赞同：4
> 
> 时间：2013-02-03T22:54:03.070
> 
> 标签：c++, templates, c++11

我有一个从可变参数类模板`deriv`派生的可变参数类模板`base`。

我有一个可以接受任何类型的函数模板`T`，以及类型的重载`base<Ts...>`；

`base<Ts...>`传递 a 时如何获得要使用的重载`const deriv<Ts...>&`？

**下面的工作示例：**

```
#include <iostream>
#include <tuple>

template<typename... Ts>
struct base
{
    std::tuple<Ts...> tuple;
};

template<typename... Ts>
struct deriv : base<Ts...>
{
};

//--------------------------------

template<typename T>
void func(const T&)
{
    std::cout << "T" << std::endl;
}

template<typename... Ts>
void func(const base<Ts...>&)
{
    std::cout << "base<Ts...>" << std::endl;
}

//----------------------------------------

int main()
{
    int a;
    base <int, double> b;
    deriv<int, double> c;

    func(a);
    func(b);
    func(c); // <--- I want func<base<Ts...>> not func<T> to be called here

    exit(0);
} 
```

**示例的输出：**

```
T
base<Ts...>
T 
```

**我想要的输出是：**

```
T
base<Ts...>
base<Ts...> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T23:42:27.037

*除非*你准备好重新设计你的代码，否则你**不能**，而且是有充分理由的。

您的非可变参数重载 的`func()`比可变参数版本*更匹配*：事实上，当尝试解析您的函数调用时，`T`非可变参数重载的类型参数将被推断为`derived<int, double>`.

另一方面，`Ts`可变参数重载中的参数包将被推断为`int, double`. 在类型推断之后，这实际上会给编译器留下这两种选择来解决您的调用：

```
void func(const deriv<int, double>&); // Non-variadic after type deduction
void func(const base<int, double>&);    // Variadic after type deduction 
```

在尝试匹配参数为 type 的调用时应该选择哪一个`derived<int, double>`？

```
deriv<int, double> c;
func(c); 
```

显然，第一个非可变参数重载是**更好的匹配**。

那么如何调用*第二个*重载而不是第一个呢？你有几个选择。首先，您可以通过显式指定模板参数来限定您的调用：

```
func<int, double>(c); 
```

如果您不喜欢这样，也许您可​​以重新考虑非可变重载的定义`func()`：您真的希望它接受*任何*可能的类型`T`吗？或者是否有某些类型您知道不应调用此重载？如果是这样，您可以使用 SFINAE 技术并`std::enable_if`排除不需要的匹配。

作为进一步的可能性，您可以稍微放宽模板函数的签名，并允许将其参数推断为某个模板类的实例化：

```
template<template<typename...> class T, typename... Ts>
void func(const T<Ts...>&)
{
    std::cout << "base<Ts...>" << std::endl;
} 
```

仅此更改就应该以您想要的方式修复程序的行为。

**更新：**

如果您希望仅对从类模板的任何实例派生的类调用专用函数模板**，**则`base<>`可以使用`std::is_base_of<>`类型特征并`std::enable_if`以下列方式：

```
template<template<typename...> class T, typename... Ts>
void func(
    const T<Ts...>&, 
    typename std::enable_if<
        std::is_base_of<base<Ts...>, T<Ts...>>::value
        >::type* = nullptr
    )
{
    std::cout << "base<Ts...>" << std::endl;
} 
```

**附录：**

在模板函数重载对您的设计没有帮助的情况下，请注意您始终可以求助于**部分模板专业化**。不幸的是，函数模板不能被特化，但您仍然可以利用*类*模板的部分特化并添加一个辅助函数来隐藏该模板的实例化。这就是你重写代码的方式：

```
namespace detail
{
    template<typename T>
    struct X
    {
        static void func(const T&)
        {
            std::cout << "T" << std::endl;
        }
    };

    template<template<typename...> class T, typename... Ts>
    struct X<T<Ts...>>
    {
        static void func(const T<Ts...>&)
        {
            std::cout << "base<Ts...>" << std::endl;
        }
    };
}

template<typename T>
void func(const T& t)
{
    details::X<T>::func(t);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:43:49.830

通用模板重载是一个更好的匹配，因为它不需要转换（除了添加`const`，两个重载都有）。

您可以`base`通过添加显式强制转换（[示例](http://ideone.com/53E01O)）来获得 -template 重载：

```
func(static_cast<base<int, double> &>(c)); 
```

（或者，您可以放弃多个重载，而是将一些`is_base_of`辅助逻辑粘贴到主函数模板的主体中。）

# ruby-on-rails-3 - ActiveRecord 如何正确排除有条件的记录？

> ID：14678333
> 
> 赞同：0
> 
> 时间：2013-02-03T22:54:24.587
> 
> 标签：ruby-on-rails-3, activerecord

为什么下面不起作用？尝试从查询中排除所有 is_reply = 1 值，但不知道如何去做。我尝试了几种组合，但都失败了。

is_reply = 1 的所有记录仍会通过以下查询返回，我认为需要分或部分但如何？

> @messages = Message.all(:conditions => ['is_reply = ? AND recipient_id = ? OR user_id = ?', 0, current_user.id, current_user.id] )

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:59:37.557

您可能想使用括号`()`并将您的条件组合在一起

```
 ['is_reply = ? AND (recipient_id = ? OR user_id = ?)', 0, current_user.id, current_user.id] 
```

# jquery - 使用 setSelectionRange 未定义 jQuery TypeError

> ID：14678334
> 
> 赞同：0
> 
> 时间：2013-02-03T22:54:29.627
> 
> 标签：jquery, html

我试图在任何文本之后专注于文本区域。这适用于 IE 和 Chrome，但在 Firefox 中它在文本之前开始。

以下错误的原因是什么：

```
TypeError: $(...)[0] is undefined
[Break On This Error]   

$(focus)[0].setSelectionRange($(focus).val().length, $(focus).val().length); 
```

相关代码：

```
$(focus)[0].setSelectionRange($(focus).val().length, $(focus).val().length);
$(focus).focus(); 
```

整个 jQuery 代码：

```
<script src="//cdn.jsdelivr.net/jquery.cookie/1.3/jquery.cookie.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
    $("#state").change(function () {
    this.form.submit();
})
var focus = $.cookie("inputFocus");

$(focus)[0].setSelectionRange($(focus).val().length, $(focus).val().length);
$(focus).focus();

$("#supplier_name").val($("#supplier_name").val());
$("#aircraft_type").val($("#aircraft_type").val());
var typingTimer;                
var doneTypingInterval = 600;  

$('#supplier_name').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#supplier_name').val) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
    $.cookie("inputFocus", "#supplier_name"); 
});

$('#aircraft_type').keyup(function(){
    clearTimeout(typingTimer);
    if ($('#aircraft_type').val) {
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
    }
    $.cookie("inputFocus", "#aircraft_type"); });
function GetQueryStringParams(sParam)
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam)
        {
            return sParameterName[1];
        }
    }
}

var state = GetQueryStringParams('state');
var supplier_name = GetQueryStringParams('supplier_name');
var aircraft_type = GetQueryStringParams('aircraft_type');

    if(supplier_name === "" && state === "any" && aircraft_type === "") {
            $('#clear').attr('disabled','disabled');
    }
    $("#clear").click(function() {
    if(state === "any") {
        $("#aircraft_type").val("");
        $("#supplier_name").val("");
    } else {
        $('#state option:selected').remove();
        $("#aircraft_type").val("");
        $("#supplier_name").val("");    
    }
    });

function doneTyping () {
    $("form").submit();
}

});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:14:32.707

更详细。

如果您尝试读取的 cookie 不存在 $.cookie 将返回 undefined。正如 Docs und “read Cookies”中所说

[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)

```
$.cookie('not_existing'); // => undefined 
```

抓住它

```
if(!focus) focus = ""; 
```

# java - 使用 while 循环进行 Java 数据验证

> ID：14678335
> 
> 赞同：1
> 
> 时间：2013-02-03T22:54:34.453
> 
> 标签：java, validation

此应用程序验证用户正在输入正确的数据。我已经完成了大约 95%，但我不知道继续？(y/n) 部分。如果您点击 y 或 n 以外的任何内容（或者如果您将该行留空），它应该会打印一个错误：所以这就是应用程序在控制台中应该看起来的样子：

继续？（是/否）：

错误！此条目是必需的。再试一次。

继续？（是/否）：x

错误！条目必须是“y”或“n”。再试一次。

继续？（是/否）：n

这是我的代码：

```
public static void main(String[] args) {
   System.out.println("Welcome to the Loan Calculator");
   System.out.println();

   Scanner sc = new Scanner(System.in);
   String choice = "y";
   while (choice.equalsIgnoreCase("y"))
   {
       System.out.println("DATA ENTRY");
       double loanAmount = getDoubleWithinRange(sc, "Enter loan amount: ", 0, 1000000);
       double interestRate = getDoubleWithinRange(sc, "Enter yearly interest rate: ", 0, 20);
       int years = getIntWithinRange(sc, "Enter number of years: ", 0, 100);

       double monthlyInterestRate = interestRate/12/100;
       int months = years * 12; 
       double monthlyPayment = calculateMonthlyPayment(loanAmount, monthlyInterestRate, months);

       NumberFormat currency = NumberFormat.getCurrencyInstance();
       NumberFormat percent = NumberFormat.getPercentInstance();
       percent.setMinimumFractionDigits(1);

       String results = "Loan amount: \t\t" + currency.format(loanAmount) + "\n"
               + "Yearly interest rate: \t" + percent.format(interestRate/100) + "\n"
               + "Number of years: \t" + years + "\n"
               + "Monthly payment: \t" + currency.format(monthlyPayment) + "\n";

       System.out.println();
       System.out.println("FORMATTED RESULTS");
       System.out.println(results);

      String getContinue = getContinueWithinRange(sc, "Continue? (y/n): ", "y", "n");
      System.out.print(getContinue);
      System.out.println();
   }

}
public static double getDoubleWithinRange(Scanner sc, String prompt, double min, double max)
{
    double d = 0.0;
    boolean isValid = false; 
    while (isValid == false)
    {
        d = getDouble(sc, prompt);
        if (d <=min) {
            System.out.println("Error! Number must be greater than " + min + ".");
        }
        else if (d >= max) {
            System.out.println("Error! Number must be less than " + max + ".");
        }
        else {
            isValid = true;
        }
    }
    return d; 
}
public static double getDouble(Scanner sc, String prompt)
{
    double d = 0.0;
    boolean isValid = false;
    while (isValid == false)
    {
        System.out.print(prompt);
        if (sc.hasNextDouble())
        {
            d = sc.nextDouble();
                    isValid = true;
        }
        else
        {
            System.out.println("Error! Invalid decimal value. Try Again.");
        }
        sc.nextLine();
    }
    return d; 
}
public static int getIntWithinRange(Scanner sc, String prompt, int min, int max)
{
    int i = 0;
    boolean isValid = false;
    while (isValid == false)
    {
        i = getInt(sc, prompt);
        if (i <= min) {
            System.out.println("Error! Number must be greater than " + min + ".");
        }
        else if (i >= max) {
            System.out.println("Error! Number must be less than " + max + ".");
        }
        else {
            isValid = true;
        }
    }
    return i; 
}
public static int getInt(Scanner sc, String prompt)
{
    int i = 0;
    boolean isValid = false;
    while (isValid == false)
    {
        System.out.print(prompt);
        if(sc.hasNextInt())
        {
            i = sc.nextInt();
            isValid = true;
        }
        else 
        {
            System.out.println("Error! Invalid integer value. Try again.");
        }
        sc.nextLine();
    }
    return i;

}
public static double calculateMonthlyPayment(double loanAmount, double monthlyInterestRate, double months)
{
    double monthlyPayment = 0;
    for (int i = 1; i <= months; i++)
    {
        monthlyPayment = loanAmount * monthlyInterestRate/(1 - 1/Math.pow(1 + monthlyInterestRate, months));
    }
    return monthlyPayment;
}
      System.out.print(getContinue);
      System.out.println();        
public static String getContinueWithinRange(Scanner sc, String prompt, String yContinue, String nContinue)
{ 
String i = ""; 
boolean isValid = false;
while (isValid == false)
{
       i = getContinue(sc, prompt);
       if (!yContinue.equalsIgnoreCase("") && !nContinue.equalsIgnoreCase("")){
           System.out.println("Error! Entry must be 'y' or 'n'. Try again.");
       }        
       else{
           isValid = true;
       }
}
return i;
 }
public static String getContinue(Scanner sc, String prompt)
 {
 String i = "";
 boolean isValid = false;
 while(isValid == false)
 {
        System.out.print(prompt);
        if (i.length() > 0)
        {

            i = sc.nextLine(); 
            isValid = true;
        }
        else
        {
            System.out.println("Error! Entry is required. Try again.");
        }       
        sc.nextLine();
 }
 return i;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:22:29.583

将 getContinue() 中的 while 循环的内容更改为：

```
System.out.print(prompt);
i = sc.nextLine();
if (i.length() > 0)
{
    isValid = true;
}
else
{
    System.out.println("Error! Entry is required. Try again.");
} 
```

这首先打印提示，然后将输入读入将返回的变量，然后检查输入的长度是否大于零。

* * *

在getContinueWithinRange()中，需要将if子句中的条件替换为

```
!yContinue.equalsIgnoreCase(i) && !nContinue.equalsIgnoreCase(i) 
```

这将“y”和“n”针对输入而不是针对“”。

* * *

此外，如果您想在阅读“y”后实际继续，您需要执行以下操作：

```
if (!yContinue.equalsIgnoreCase(i) && !nContinue.equalsIgnoreCase(i)){
    System.out.println("Error! Entry must be 'y' or 'n'. Try again.");
}        
else {
    isValid = true;
} 
```

第一种情况捕获无效输入，第二种情况如果用户输入“n”则结束循环，第三种情况告诉用户在输入“y”后循环将继续。

* * *

最后，为了让你的程序做它应该做的事情，改变

```
String getContinue = getContinueWithinRange(sc, "Continue? (y/n): ", "y", "n"); 
```

至

```
choice = getContinueWithinRange(sc, "Continue? (y/n): ", "y", "n"); 
```

在你的主要方法中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:50:24.930

我根据您第一次提交的代码为您尝试一些东西

```
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

import javax.imageio.ImageIO;
import javax.swing.ImageIcon;

public class Tester4 {

    public static String getContinueWithinRange(Scanner sc, String prompt, String yContinue, String nContinue) {
        String result = "";
        boolean isValid = false;
        boolean isStarted = false;
        while(!isValid) {
            result = getContinue(sc, prompt, isStarted);
            isStarted = true;
            if(yContinue.equalsIgnoreCase(result) || nContinue.equalsIgnoreCase(result)) {
                isValid = true;
            } else if(!yContinue.equalsIgnoreCase(result) || !nContinue.equalsIgnoreCase(result)) {
                System.out.println("Error! Entry must be 'y' or 'n'. Try again.");
            } else {
                System.out.println("Error! Entry must be 'y' or 'n'. Try again.");
            }
        }
        return result;
    }

    public static String getContinue(Scanner sc, String prompt, boolean isStarted) {
        String result = "";
        boolean isValid = false;
        while(!isValid) {
            if(result.isEmpty() && !isStarted) {
                System.out.print(prompt);
                System.out.println("Error! Entry is required. Try again.");
            }
            result = sc.nextLine();
            if(result.length() > 0) {
                isValid = true;
            }
        }
        return result;
    }

    public static void main(String args[]) {

        Scanner sc = new Scanner(System.in);
        String getContinue = getContinueWithinRange(sc, "Continue? (y/n): ", "y", "n");
        // to call the method
        System.out.print(getContinue);
        System.out.println();
    }

    // InputStream stream = this.getClass().getClassLoader().getResourceAsStream("/images/image.jpg");
    // BufferedImage bufferedImage=ImageIO.read(stream);
    // ImageIcon icon= new ImageIcon(bufferedImage);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-05T20:56:24.707

```
import java.util.*;
import java.text.*;

public class LoanPaymentApp {

public static void main(String[] args) 
{

    System.out.println("Welcome to the Loan Calculator");
    System.out.println();

    Scanner sc = new Scanner(System.in);
    String choice = "y";
    while (!choice.equalsIgnoreCase("n"))
    {
   System.out.println("DATA ENTRY");
   double loanAmount = getDoubleWithinRange(sc, "Enter loan amount: ", 0, 1000000);
   double interestRate = getDoubleWithinRange(sc, "Enter yearly interest       rate: ", 0, 20);
   int years = getIntWithinRange(sc, "Enter number of years: ", 0, 100);

   double monthlyInterestRate = interestRate/12/100;
   int months = years * 12; 
   double monthlyPayment = calculateMonthlyPayment(loanAmount, monthlyInterestRate, months);

   NumberFormat currency = NumberFormat.getCurrencyInstance(Locale.US);
   NumberFormat percent = NumberFormat.getPercentInstance();
   percent.setMinimumFractionDigits(1);

   String results = "Loan amount: \t\t" + currency.format(loanAmount) + "\n"
           + "Yearly interest rate: \t" + percent.format(interestRate/100) + "\n"
           + "Number of years: \t" + years + "\n"
           + "Monthly payment: \t" + currency.format(monthlyPayment) + "\n";

   System.out.println();
   System.out.println("FORMATTED RESULTS");
   System.out.println(results);

   System.out.print("Continue? (y/n): ");
        choice = sc.nextLine();
        while (!choice.equalsIgnoreCase("y") && !choice.equalsIgnoreCase("n"))
        {
             if (choice.equals(""))
             {
                System.out.println("Error! This entry is required. Try again.");
                System.out.print("Continue? (y/n): ");
             }
             else
             {
                  System.out.println("Error! Entry must be 'y' or 'n'. Try again.");
                  System.out.print("Continue? (y/n): ");
             }
            choice = sc.nextLine();
        }

        }

        }
        public static double getDoubleWithinRange(Scanner sc, String prompt, double min, double max)
{
double d = 0.0;
boolean isValid = false; 
while (isValid == false)
{
    d = getDouble(sc, prompt);
    if (d <=min) {
        System.out.println("Error! Number must be greater than " + min + ".");
    }
    else if (d >= max) {
        System.out.println("Error! Number must be less than " + max + ".");
    }
    else {
        isValid = true;
    }
}
return d; 
}
public static double getDouble(Scanner sc, String prompt)
{
double d = 0.0;
boolean isValid = false;
while (isValid == false)
{
    System.out.print(prompt);
    if (sc.hasNextDouble())
    {
        d = sc.nextDouble();
                isValid = true;
    }
    else
    {
        System.out.println("Error! Invalid decimal value. Try Again.");
    }
    sc.nextLine();
}
 return d; 
}
public static int getIntWithinRange(Scanner sc, String prompt, int min, int max)
{
int i = 0;
boolean isValid = false;
while (isValid == false)
{
    i = getInt(sc, prompt);
    if (i <= min) {
        System.out.println("Error! Number must be greater than " + min + ".");
    }
    else if (i >= max) {
        System.out.println("Error! Number must be less than " + max + ".");
    }
    else {
        isValid = true;
    }
}
return i; 
}
public static int getInt(Scanner sc, String prompt)
{
int i = 0;
boolean isValid = false;
while (isValid == false)
{
    System.out.print(prompt);
    if(sc.hasNextInt())
    {
        i = sc.nextInt();
        isValid = true;
    }
    else 
    {
        System.out.println("Error! Invalid integer value. Try again.");
    }
    sc.nextLine();
}
return i;

}
 public static double calculateMonthlyPayment(double loanAmount, double monthlyInterestRate, double months)
 {
double monthlyPayment = 0;
for (int i = 1; i <= months; i++)
{
    monthlyPayment = loanAmount * monthlyInterestRate/(1 - 1/Math.pow(1 + monthlyInterestRate, months));
}
return monthlyPayment;
}

} 
```

# python - 建树逻辑问题

> ID：14678336
> 
> 赞同：0
> 
> 时间：2013-02-03T22:54:34.243
> 
> 标签：python

我正在编写一个简单的应用程序，其中包含代表英语的树。我在 C++ 中做过类似的事情，但这是我第一次尝试在 Python 中构建树。

```
englishWords = []
englishFile = open("english.txt")
for line in englishFile:
    englishWords.append(line.rstrip())

class Node:
    def __init__(self, value):
        self.Value = value
        self.checked = False
        self.Pointers = []
        self.numPointers = 0
    def addNode(self, value):
        x = Node(value)
        self.Pointers.append(x)
        return x

headString = "HEAD"
Head = Node(headString)

def buildPointers(parent, info, nodeList):  

    x = 0
    y = len(nodeList)
    while x < y :
        if parent.numPointers == 0:
            newNode = parent.addNode(info)
            parent.numPointers = parent.numPointers + 1
            buildPointers(newNode, nodeList[x+1], nodeList)
            break
        else:
            for i in parent.Pointers:
                if info == i.Value:
                    buildPointers(i, nodeList[x+1], nodeList)
                    continue
                else:   
                    newNode = parent.addNode(info)
                    parent.numPointers = parent.numPointers + 1
                    buildPointers(newNode, nodeList[x+1], nodeList)
                    continue

def treeBuild(lyst):
    for i in lyst:
        iList = list(i)
        buildPointers(Head, iList[0], iList)

treeBuild(englishWords) 
```

一旦我运行代码，Windows 就会显示“python.exe 已停止运行”，这可能是我忽略了一些简单的事情，所以请随意撕毁我或我写这个的方式。我会喜欢任何有助于使我成为更好的程序员的批评。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:13:59.327

基本上这不是真正的pythonic，这里有很多错误，但我想主要问题是使用太多递归，python“开箱即用”不是很擅长。

它将默认递归深度限制为 1000 步。你可能需要更多。这是一个问答，[解释](https://stackoverflow.com/questions/3289430/maximum-level-of-recursion-in-python)如何更改此默认值。

另一个好建议是更改递归以使用此[博客文章中的生成器](http://nedbatchelder.com/blog/201205/recursive_dogma.html)

ps：由于您不更改 x 的值，因此在某些情况下，while 循环可能会永远运行，不是吗？（我没有完全理解算法，所以我不确定）

**编辑：**为了使它更pythonic，我将更改填充部分以与上下文管理器一起使用：

```
with open("english.txt") as english_file:
   for line in english_file .. 
```

顺便说一句，一种更好的方法，不将数百万个字符串加载到列表中，会将填充部分更改为生成器函数，每次都会产生一个英文单词 - 更高效和 Pythonic。[您可以在此处](http://www.tp.umu.se/~nylen/fnm/pylect/advanced/advanced_python/index.html)阅读有关上下文管理器和生成器功能的信息

**另一个编辑：学习惯用 python**最好的起点是打开一个 python shell 和：

```
import this 
```

“蟒蛇之禅”将出现。[kenneth reitz 的Hitchhikers guide to python](http://docs.python-guide.org/en/latest/)是现代 Python 开发的一个很好的自以为是的指南，包括库、最佳实践、阅读建议和编写idomatic python 。

和一个类似的来源，更集中的来源，正在[编写惯用的 Python](http://www.jeffknupp.com/blog/2012/10/04/writing-idiomatic-python/)

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:19:58.280

当您递归导致无限递归时，您实际上并没有减少 nodeList 。当你完成一个单词的处理时，你也不会正确地跳出循环。以下 buildnodelist 至少完成。我不保证它会按预期工作，因为我只修改了一些阻塞行：

```
def buildPointers(parent, info, nodeList):
    if parent.numPointers == 0:
        newNode = parent.addNode(info)
        parent.numPointers = parent.numPointers + 1
        if len(nodeList) > 1:
            buildPointers(newNode, nodeList[x+1], nodeList[1:])
    else:
        for i in parent.Pointers:
            if info == i.Value:
                if len(nodeList) > 1:
                    buildPointers(i, nodeList[x+1], nodeList[1:])
            else:
                newNode = parent.addNode(info)
                parent.numPointers = parent.numPointers + 1
                if len(nodeList) > 1:
                    buildPointers(newNode, nodeList[x+1], nodeList[1:]) 
```

本质上，我已经删除了 While 循环并传递了 nodeList 的第一个元素的切片（如果其中包含超过 1 个项目）。

# url-rewriting - Liferay Resource 和 Action URL 参数的区别

> ID：14678337
> 
> 赞同：2
> 
> 时间：2013-02-03T22:54:38.553
> 
> 标签：url-rewriting, liferay, liferay-6, tuckey-urlrewrite-filter

我需要为 liferay 门户中的资源 URL 创建一个自定义 url 过滤器（使用[tukey.org](http://tuckey.org/urlrewrite/)），但我不知道如何区分 liferay 创建的带有 @ResourceMapping 注释的 URL 和使用 @ActionMapping 创建的 URL。Liferay 默认为操作和资源 URL 添加了一些参数。我只想将过滤器应用于资源链接。请帮助我了解这些 URL 之间的区别。

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T09:47:33.220

所有资源请求的 url 中都有 request-param `p_p_lifecycle=2`，而 action 请求有`p_p_lifecycle=1`和 render 请求`p_p_lifecycle=0`（这是默认的，经常被省略）

# android - android子片段在膨胀之前创建

> ID：14678345
> 
> 赞同：0
> 
> 时间：2013-02-03T22:55:32.877
> 
> 标签：android, android-fragments, android-inflate

我正在创建一个`Fragment` `FragParent`显示几个输入字段，其中一个是 sub- `Fragment` `frag`，带有专门的音频控件。

两个片段的布局都是在它们的`onCreateView()`方法中从 XML 加载的。我正在使用的代码如下，但我对此有一些疑问：

A）`replace()`如果子片段已经被返回，它是否可以`findFragmentByTag()`，或者这是一个不必要的步骤？

`inflate()`B）在父Fragment完成调用之前，子Fragment是否可以在布局中被实例化和替换？

```
<!-- language: lang-java  -->
// Load sub-Fragment with audio UI.
String fragStr = "fragment_audio_str";
int fragView = R.id.frag_audio_frame_layout;
FragmentManager fm = getChildFragmentManager();
FragmentTransaction fmt = fm.beginTransaction();
Fragment frag = (Fragment)  fm.findFragmentByTag(fragStr);
if (null == frag) {
    frag = new Fragment();
}
fmt.replace(fragView, frag, fragStr); 
fmt.commit();

return inflater.inflate(R.layout.fragment_parent, container, false);
} // END onCreateView() of FragParent 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T15:52:37.753

> A) 如果 findFragmentByTag() 已经返回子片段，是否可以替换() 子片段，或者这是一个不必要的步骤？

不，如果片段已经存在，则不需要替换它。但是，如果您的子片段不存在，则需要替换它。

> B) 在父Fragment 完成inflate() 调用之前，子Fragment 是否可以在布局中被实例化和替换？

不，您需要膨胀父`Fragment`布局，然后`Fragment`在返回父布局之前将您的孩子添加到其中`View`。

尝试这样的事情：

```
 View parentFragLayout = inflater.inflate(R.layout.fragment_parent, container, false);
        FrameLayout childFragContainer = (FrameLayout) parentFragLayout.findViewById(R.id.frag_audio_frame_layout);

        // Load sub-Fragment with audio UI.
        String fragStr = "fragment_audio_str";
        FragmentManager fm = getChildFragmentManager();
        Fragment frag = fm.findFragmentByTag(fragStr);

        // Child fragment isn't there, so add it
        if (frag == null) {
            frag = new Fragment();
            FragmentTransaction fmt = fm.beginTransaction();
            fmt.replace(childFragContainer.getId(), frag, fragStr);
            fmt.commit();
        }
        return parentFragLayout; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:47:37.967

除非您的 Fragment 包含您的 XML 布局（因为您将其添加到 onCreateView 中，我假设它不包含在您的 XML 布局中）您仍然需要使用 FragmentManager 来添加 Fragment。但是，您应该使用`add()`而不是`replace()`. `replace()`只有在实际替换另一个 Fragment 时才应该调用。

虽然我对第二个问题不是百分百肯定，但我很确定它是否定的。

# delphi - 保存图像以记录

> ID：14678348
> 
> 赞同：2
> 
> 时间：2013-02-03T22:55:42.707
> 
> 标签：delphi, ms-access, delphi-xe3

我将一些信息存储到我的 Access 数据库中，一个参数是一个 BLOB 字段，在这种情况下是一个图像，加载到一个 Timage 中。

我正在使用此代码来保存它：

```
var
AStream : TMemoryStream;
begin
AStream := TMemoryStream.Create;
  try
Image1.Picture.Graphic.SaveToStream(AStream);
AStream.Position := 0;
if Adotable1.Active then
begin
  Adotable1.Edit;
  TBlobField(Adotable1.FieldByName('Termograma')).LoadFromStream(AStream);
  Adotable1.Post;
end;
  finally
    AStream.Free;

adotable1.Append;
adotable1['Data']:= datetimepicker1.Date;
adotable1['Temax']:= edit4.Text;
adotable1['Temin']:= edit5.Text;
adotable1['Descrição da Posição']:= memo1.Text;
adotable1['Comentários']:= memo2.Text;
adotable1.Post; 
```

但我也有其他信息，我通过单击“附加”部分等同一个按钮来存储。

发生的情况是，当我按下保存按钮时，此信息不会存储在数据库中的相同 ID 中。

我该如何纠正这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:14:04.313

您正在编辑当前记录，将图像保存到其中，添加新记录，并将其余信息保存到该新记录中。我认为您打算添加一条全新的记录，将图像和数据添加到该新记录中，然后保存这些更改。

试试这个：

```
var
  AStream : TMemoryStream;
begin
  if not AdoTable1.Active then
    AdoTable1.Open;

  Adotable1.Append;

  AStream := TMemoryStream.Create;
  try
    Image1.Picture.Graphic.SaveToStream(AStream);
    AStream.Position := 0;
    TBlobField(Adotable1.FieldByName('Termograma')).LoadFromStream(AStream);
  finally
    AStream.Free;
  end;

  adotable1['Data']:= datetimepicker1.Date;
  adotable1['Temax']:= edit4.Text;
  adotable1['Temin']:= edit5.Text;
  adotable1['Descrição da Posição']:= memo1.Text;
  adotable1['Comentários']:= memo2.Text;
  adotable1.Post;
end; 
```

# c++ - 如何计算几乎平行的两条线段之间的重叠

> ID：14678356
> 
> 赞同：2
> 
> 时间：2013-02-03T22:56:31.270
> 
> 标签：c++, geometry, computational-geometry

我有同样定向（但不完全平行）的二维线段。我想找出与给定线段最大重叠的线段。我认为标量可以用来有效地计算这一点，但我的几何太差了，无法弄清楚这一点。例如，在下图中；与其他线段相比，将暗线假定为给定线，红色突出显示的线段具有最大覆盖范围（或最长重叠，不确定我的术语是否正确）。

> 我的目标是从其他线段集中找到代表暗线的最佳线。

我想要找到的是对给定行具有最大覆盖范围的任何行。这意味着，我想避免开始和结束在给定线段末端之外的线段。此外，当许多线路为给定线路提供最大覆盖时，我想避免较短的线路并需要较长的线路。`idea is to find another line which we can consider instead of that given line segment`

高度赞赏帮助，因为稍后我想在编程环境中实现这一点。谢谢

示例 1 ![例子](../Images/72fb6dfbec7112a2757351015e2437e5.png)

![在此处输入图像描述](../Images/717c0f497de062cb7d9f99ee25980993.png) 示例2

要说我的意思是“覆盖”，我会在上图中说：投影的蓝线完全位于深黑线内。但它太短了。但是，红线（投影线）的大部分位于黑线内，尽管红线的某些部分出去了。绿线完全脱离黑线。所以，我可以说红线用黑线提供最大的覆盖范围..（我的想法正确吗？）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T05:53:46.730

1.  将候选句段的结尾投影到目标句段上。
2.  计算投影之间的距离。
3.  [可选] 乘以线段之间角度的 cos。

注意#1：在此上下文中，段上的投影意味着位于该段上的最近点。一种方法是：

*   在穿过线段的无限线上投影一个点
*   如果投影在段内 - 拿走它
*   如果投影在段之外 - 取最近的段结束

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:33:03.600

我不知道您的问题是关于图形处理或计算功能。

但是对于图形，这个问题属于计算机视觉学科，你想要的也许是[霍夫线变换算法](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/hough_lines/hough_lines.html)。

但是，如果您的问题比这更简单，那么您想要的可能是[SAD 算法](http://en.wikipedia.org/wiki/Sum_of_absolute_differences)

# ubuntu - 用 nginx-push-stream-module 重新编译 Nginx？

> ID：14678358
> 
> 赞同：1
> 
> 时间：2013-02-03T22:56:39.437
> 
> 标签：ubuntu, nginx

我已经用 apt-get 在 Ubuntu 上安装了 Nginx。现在我需要以某种方式添加模块：

他们的安装建议使用模块重新编译 Nginx： [https ://github.com/wandenberg/nginx-push-stream-module/blob/master/README.textile](https://github.com/wandenberg/nginx-push-stream-module/blob/master/README.textile)

当我使用 apt-get 安装 Nginx 时，我该怎么做？

我想保留我当前的所有设置，并以某种方式将模块放入其中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-13T14:11:40.920

你基本上不能..你必须重建nginx，或者找到一些用这些选项编译了nginx的ppa

# python - 基于属性显示对象

> ID：14678360
> 
> 赞同：0
> 
> 时间：2013-02-03T22:57:10.873
> 
> 标签：python, django

这很简单。我有一个带有 pin 属性的对象数据库。

**用例**

*   用户输入 4 位密码
*   显示具有匹配引脚号的对象

在 django 中完成此任务的最简单方法是什么？

索引.html

```
<form action="/polls/" method="post">
    {% csrf_token %} 
    <p>
        <label for="pin">Enter group pin:</label> 
        <input id="pin" type="text" name="pin" maxlength="4" /> 
        <input type="submit" value="View Polls" />
    </p>
</form> 
```

目前它是硬编码的

```
{% for poll in latest_poll_list %}
    {% if poll.pin == "1234" %}
        <ul class="poll-list">
            <li><a href="/polls/{{ poll.id }}/">{{ poll.question }}</a> - {{poll.pin}}</li>
        </ul>
    {% endif %}
{% endfor %} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:02:40.067

我对 django 很陌生，所以可能有更好的解决方案，但我会试一试。在你看来，你可以做这样的事情。考虑到您的代码，我假设您有一个类 `Poll`

```
poll = Poll.objects.filter(pin=request.POST['pin']) 
```

# vhdl - VHDL 如果条件不能正常工作

> ID：14678362
> 
> 赞同：1
> 
> 时间：2013-02-03T22:57:17.943
> 
> 标签：vhdl

我在确定我的代码为什么不能正常工作时遇到了一些困难。我正在尝试使用 3 位操作码创建 ALU。

除一种情况外，所有情况均无法正常工作；操作码 011 (SEQ)。它被定义为 if(a==b) z<='0' 和 output<='0'。a 和 b 是输入，z 是零标志。我希望通过以下 VHDL 代码获得此功能

```
....
    BEGIN

    result <= dummy_result;

    PROCESS (a, b, op) 

        VARIABLE carry: STD_LOGIC:='0';

         --DEFINE ALIAS TO SEPERATE ALU-OP SIGNAL
        alias NEG_TSEL      : STD_LOGIC IS op(2);
        alias ALU_SELECT    : STD_LOGIC_VECTOR(1 downto 0) IS op(1 downto 0);
    BEGIN
         if ALU_SELECT="11" THEN

                if NEG_TSEL='0'  THEN   -- SEQ

                    if a = b THEN
                        dummy_result <="00000";
                    end if;

                elsif NEG_TSEL='1' THEN     --SCO

                    cout <= '1';
                    result <= "XXXXX";

                end if;

        elsif ALU_SELECT="00" THEN... 
```

使用此代码，当 op = 011 时，结果始终设置为零。

当我将代码更改为：

```
 .....
            if a = b THEN
                dummy_result <="00000";

            else
                dummy_result <= "10101";
            end if;
..... 
```

它工作正常，但结果不能改变，所以我将它改为“dummy_result <= dummy_result;”而不是“10101”向量 但这给了我与原始案例相同的结果。

有什么建议么？难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T05:18:21.400

这是我对您的代码的问题：

就个人而言，我觉得在每个循环中，您都应该向 、 和 . 输出`result`一些`cout`东西`zero`。目前，您始终输出到`zero`，但您仅有条件地输出到其他两个端口。这可能会创建闩锁，这可能不是您想要的。因此，例如 SCO 操作，也应该向 推送一些东西`cout`，而 SCO 操作应该向`dummy_result`信号推送一些东西。

您的减法实现未按您的预期工作。

```
when "110" => -- SUB
    tmp_b <= NOT b;
    carry := '1';

    for i in 0 to 4 loop
        dummy_result(i) <= carry XOR a(i) XOR tmp_b(i);
        carry := (a(i) AND tmp_b(i)) OR (tmp_b(i) AND carry) OR (carry AND a(i));
    end loop;
    cout <= carry; 
```

`tmp_b`是一个信号。那里发生的逻辑将与此过程中的其他所有事情同时发生，而不是顺序发生。您可能希望它是一个变量，就像`carry`is 一样。

* * *

我还想让你知道 case 语句（相对于 if 链）。您的代码可能如下所示：

```
PROCESS (a, b, op)
    VARIABLE carry: STD_LOGIC:='0';
BEGIN

    case op is
        when "011" => -- SEQ
            dummy_result <= "00000";

        when "111" => -- SCO
            cout <= '1';

        when "000" => -- AND
            dummy_result <= a AND b;

        ...

        when others =>
            dummy_result <= "00000";
            cout <= '0';
    end case;
end process; 
```

* * *

回到最初的问题`SEQ`，你的原始代码如下所示：

```
when op = "011" =>
    if a = b then
        dummy_result <= "00000";
    end if; 
```

正如我上面提到的，这里的问题是这很可能是一个闩锁。当 a /= b 时，您需要输出您期望的值，而不能只是`dummy_result <= dummy_result`. 如果你把它推到物理电线和芯片上，你期望它变成什么？

相反，您应该将最后一个 dummy_result 的值传递给该实体，或者如果特定操作应该保存结果的值，您应该输出“00000”并输出一个附加信号，说明*保存*前一个值的任何内容（在注册），不应该更新它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T18:05:05.207

此处的目的是除非另有指定，否则 dummy_result 旨在保留“result”的先前值。不幸的是，这个单元被实现为一个组合过程，没有时钟。

因此，存储不能在该单元中可靠地实现。
因此，它必须在本单元之外实施。
几乎可以肯定已经是了；在作为时钟进程实现的寄存器中。

因此，将该寄存器的输出作为新的输入端口“prev_result”带回并使用默认分配给 dummy_result。这不仅将克服您迄今为止发现的特定故障，而且将克服所有其他“dummy_result”（还有另一个）缺失的分配，以同步方式保留“result”的旧值。

```
 PROCESS (a, b, op, prev_result) 
       -- declarations here
    BEGIN
       -- default assignment
       dummy_result <= prev_result;

       if ALU_SELECT="11" THEN
          if NEG_TSEL='0' THEN    -- SEQ
             if a = b THEN
                dummy_result <="00000";
             end if;
       ...
    END PROCESS; 
```

我认为你会更好地重组设计以使 ALU 成为一个时钟进程，但如果你按照指示不要这样做，那么你将不得不采用这个（或类似的）解决方案。

# sql-server-2008 - SQL Server 行级安全性 - 多对多

> ID：14678367
> 
> 赞同：2
> 
> 时间：2013-02-03T22:58:08.423
> 
> 标签：sql-server-2008, security, active-directory, row-level-security

我们使用的是 SQL Server 2008，并在 Active Directory (AD) 中设置了权限。核心表中的每一行只需要那些有权查看每一行的人才能查看。我可以在每一行上设置行级安全性（每一行包含一个与 AD 组对齐的角色），但是我有以下问题：-

*   因为这些角色代表国家，所以我有 100 个角色。此外，我有一些用户可以访问多个角色......并且给定用户可以访问的几个角色没有一致地分组（即存在重叠）：因此用户角色是多对多关系

在这种情况下（为了启用灵活的模型），我的第一反应是为每个国家创建一个 AD 组，然后在数据库角色中创建分组（对每个国家进行分组）。但是，这将是维护开销 - 例如，有许多工作人员可以访问所有组，因此当一个国家/地区上线时，会创建一个新的 AD 组，这意味着我必须请求将这些用户作为成员添加到新的 AD 组（以及需要将新的全局用户添加到所有组） - 我宁愿有一个可以全面访问的全局组。

有没有人遇到过这种问题。基本上，如果我只有非常精细的 AD 组，我可以在数据库角色级别内容纳多对多，但是我宁愿拥有精细的 AD 组（对于那些需要精细权限的用户）以及用于那些的全局 AD 组需要访问所有行的用户（我只需要添加具有全局访问权限的用户）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T12:42:10.747

根据您的描述，如果您有大量用户需要管理，那么创建第三方管理工具或使用身份管理工具来管理您的 AD 组和相应的 SQL 行级安全性将是一个很好的情况。

至于广告组，你想到的我也会做，即

*   基于国家/地区的 100 个角色
*   所有国家/地区的 1 个角色 => 包含所有其他 AD 国家/地区组

创建一个工具（如果你有一个理想的身份管理工具），

*   工具允许您手动将用户分配到他们的国家
*   工具将国家/地区映射到其相应的 AD 组（身份管理将具有此开箱即用）
*   工具将国家/地区映射到其相应的 SQL 行安全性
*   工具定期将国家与 AD 组和 SQL 安全同步（这是为了防止系统管理员手动将用户组分配给用户，身份管理再次将其开箱即用）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-17T11:13:19.213

我完成的是：-

*   每个国家创建一个数据库组（大约 100 个）
*   为每个分组创建一个数据库组（GLOBAL、EUROPE、APAC、LATINAMERICA、NORTHAMERICA、UK 等）
*   创建包含所需级别用户的 AD 组（只需要 12 个）
*   将 AD 组添加为相应数据库角色的成员
*   在他们所在的各个国家和群体之间创建数据库角色父子关系；例如。英国在欧洲（注意这里允许多对多）
*   为组中的组创建数据库角色父子关系（注意这里允许多对多）

一些注意事项：-

*   这里添加的每个数据库角色都需要是数据库用户
*   当创建数据库角色关系时，所有相关的数据库角色和 AD 组也被引入该关系
*   现在我可以根据需要在 AD 组级别或单个国家/地区 AD 组级别添加用户
*   数据库角色和任何关系都是脚本化的
*   IS_MEMBER 子句位于各个国家/地区级别

# sas - 从另一个数据集创建数据集时使用信息

> ID：14678370
> 
> 赞同：-1
> 
> 时间：2013-02-03T22:58:29.703
> 
> 标签：sas

我有一个数据集，其中包含所有字符格式的数据。

现在我想从这个数据集创建另一个数据集，把它放在正确的十进制或日期或字符格式中。

这就是我正在尝试的。

```
数据work.testout；

    属性 account_open_date 信息 = mmddyy10.;

    对 nobs 做 i = 1；
        设置 braw.accounts 点 = i nobs = nobs;
        输出;

    结尾;
    停止;
跑;

```

这给了我： `Variable 'account_open_date' from data set braw.accounts (at line 7 column 21) has a different type (character) to the variable type on the data vector (numeric)`

这样做的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:40:02.530

您不能使用信息将变量直接从字符转换为数字。至少在 SAS 中，您不能在不使用中介的情况下将变量从字符转换为数字、句点。您必须执行以下操作：

```
data want;
set have(rename=varwant=temp);
varwant=input(temp,MMDDYY10.);
drop temp;
run; 
```

在那里，您将（字符）变量重命名为临时名称，然后使用 INPUT 将其转换为数字。

# jsp - 第二个表单提交为空

> ID：14678375
> 
> 赞同：0
> 
> 时间：2013-02-03T22:59:28.500
> 
> 标签：jsp, servlets

我有一个包含表单的 JSP，其中包含多个文本输入。

我可以用一些数据填充文本输入。单击提交按钮后，将按预期调用我的 servlet 的 doPost 方法。按照 PRG 设计模式，我在 doPost 方法的末尾使用“sendRedirect”调用，以避免在例如用户重新加载 wep 页面时再次提交我的表单。

此时一切正常：表格中输入的数据显示在屏幕上。

但是，如果我再次按下提交按钮，我会得到令人讨厌的 nullPointerExceptions，因为传递给我的 servlet 的 doPost 方法的 HttpServletRequest 不再包含我在第一次提交时输入的数据。

我不明白为什么会出现这种行为：表单包含数据，但第二次没有发送。

你能解释一下我的方法有什么问题吗？

[编辑] 我正在尝试另一种方法，通过使用会话属性，这是我的一些代码：

关于 JSP (myJsp.jsp)

```
<form method="post" action="myServlet">
field: <input type="text" name="field" value="${sessionScope.bean.field}"><br>
<input type="submit" name="lastname">
</form> 
```

在 servlet (myServlet.java)

```
private Bean myBean;

doPost(...){
doSthWithMyBean(myBean);
response.sendRedirect("myJsp.jsp");
}

doGet(...){
request.getSession().setAttribute("bean",myBean);
this.getServletContext()....("myJsp.jsp").forward(request, response);
//I forget the exact methods on the description above, but you see what I do : I forward the request and response to the same jsp
} 
```

我的理解是： - 第一次加载页面时，会调用 doGet 方法。所以 myBean 被设置为会话的一个属性——当我点击提交时，doPost 方法被调用。由于 myBean 已被设置为会话的属性，我希望自动检索 bean 信息（因为 ${sessionScope.bean.field} 在表单的 value 字段中）

=> 使用第二种方法，即使是第一个表单提交也会因空指针异常而失败，但我不明白为什么。

如果我恢复使用请求参数而不是会话对象

```
value="${bean.field} 
```

我通过 doPost 方法中的 request.getParameter 访问参数。它适用于表单的第一次提交，但在第二次提交时，即使表单填充了第一次提交的值，也没有名为“字段”的请求参数。

总结一下我所有的谈话：-当我使用请求参数时：为什么第二次提交时没有名为“字段”的请求参数？- 当我使用会话属性时：为什么在第一次提交表单时它为空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:08:57.753

我找到了解决问题的方法，但我不喜欢它。

*   在第一次提交时，请求参数映射包含表单输入内容。所以我通过 request.getParameter(....) 方法获取它们，并使用 request.getSession.setAttribute(.....) 将它们设置为我的会话属性

*   在第二次提交时，请求参数映射不包含表单内容（即使它们显示在表单中，因为它们是从会话属性中检索的）我测试request.getParameter的空性，如果它是空的，我不'不更新我的会话属性。

它有效，但我觉得它不干净，而且我确定我遗漏了一些东西，所以我把它留给任何其他想法。谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T13:00:58.913

使用 #{...} EL 表达式有效

# file - Processing.js - 列出草图目录中的文件

> ID：14678376
> 
> 赞同：0
> 
> 时间：2013-02-03T22:59:29.717
> 
> 标签：file, list, directory, processing.js

我是新来的，大家好！

我用Processing语言写了一些东西，现在我需要切换到Processing.js。我需要编写一个应用程序，首先扫描草图文件夹以准备提供的文件列表。而在 Processing 中直截了当的东西不在 PJS 中。

我目前正在网上搜索，但我只找到了经典处理的解决方案。我知道 JavaScript 有限制，通常无法访问用户端文件，但是有没有办法列出草图本身的文件？

我想到的唯一方法是通过 PHP 在服务器端列出它们，并根据草图文件夹动态生成 .pde 文件。但关键是不要使用任何其他语言。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T22:10:38.540

在网站上运行的 Processing.js 只能获取 URL 可以提供的信息，并且由于网络上没有“目录列表”，因此它无法获取您使用的 URL 的目录列表内容。但是，根据您真正想做的事情，可能有一种方法可以使其工作而无需求助于 PHP。

假设您的 Pjs 页面在 www.example.org/index.html 上运行，并且您想列出 www.example.org/sketch/ 的内容，一种选择是简单地拥有一个文件 www.example.org/sketch/ list.txt 包含草图可以访问的所有文件名，只需使用

```
String[] fileNames = loadStrings("./sketch/list.txt") 
```

操作说明。

如果您可以举例说明“我需要编写一个首先扫描草图文件夹以准备提供的文件列表的应用程序”的含义，则可能有更具体的解决方案（即，文件是什么，什么是用户需要它们等）

# javascript - 在 Ace Editor 中禁用滚动条

> ID：14678377
> 
> 赞同：1
> 
> 时间：2013-02-03T22:59:35.910
> 
> 标签：javascript, ace-editor

我想禁用 Ace 编辑器中的所有滚动条，或者用更时尚的东西替换。这可以做到吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-22T12:57:47.873

用自定义滚动条替换滚动条会很痛苦。

但是你总是可以用这个简单的（虽然 hacky）CSS 隐藏编辑器的滚动条：

```
.ace_scrollbar {
    display: none !important;
} 
```

在旧版 Ace 上：

```
.ace_sb {
    display: none !important;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T10:52:34.553

一种方法是使用[::-webkit-scrollbar-](http://css-tricks.com/examples/WebKitScrollbars/)并忽略那些愚蠢到无法实现它的浏览器。

隐藏滚动条是可能的，但以一种相当老套的方式，所以如果你也需要在 Firefox 上拥有时尚的滚动条，请尝试在[https://github.com/ajaxorg/ace/issues/869上询问](https://github.com/ajaxorg/ace/issues/869)

# c - 如果A==B && B==C && C==D，有没有更好的方法？

> ID：14678379
> 
> 赞同：4
> 
> 时间：2013-02-03T23:00:14.663
> 
> 标签：c

是否有“如果 A、B 和 C 都等于 D”的简写？在我现在所处的场景中，我实际上只对查看它们是否都相等感兴趣，而不是它们的实际值，所以“如果 A、B、C 和 D 相同”的东西也有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:39:17.703

该问题被标记为 C，但如果允许 C++11，您可以定义`all_equal`如下：

```
template <typename T1>
inline bool all_equal(T1&& val) {
 return true;
}

template <typename T1, typename T2, typename... Ts>
inline bool all_equal(T1&& val1, T2&& val2, Ts&&... rest) {
  return val1 == val2 && all_equal(std::forward<T2>(val2), std::forward<Ts>(rest)...);
} 
```

示例用法：

```
all_equal(3);    // true
all_equal(3, 3); // true
all_equal(3, 4); // false
all_equal(x, y, z); // would be expanded to 'x == y && y == z' 
```

参数的数量没有限制。

如果你想坚持使用 C，你可以使用[变长参数列表](http://www.swig.org/Doc1.3/Varargs.html)，但我不推荐它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:57:31.917

您不太可能遇到这可能是速度限制的情况。然而，通常，最小化循环中的分支是最快的。

我会做

```
!(a^b | b^c | c^d) 
```

我怀疑位运算符`|`会比 wildplasser 答案中的短路更快`||`，至少当每次执行循环时结果都不相同时不要假设。如果它真的很重要，请尝试两者并进行测量。

虽然它的语法很短

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T23:14:21.963

短路异或技巧：

```
int abcd(unsigned aa, unsigned bb, unsigned cc, unsigned dd)
{
#define FOUR_UNEQUAL(a,b,c,d)  ((a^b^c^d) || (a^b) || (c^d) || (b^c)) ? 1 : 0

return FOUR_UNEQUAL(aa,bb,cc,dd);
} 
```

生成的程序集（GCC 4.6.1-9ubuntu3）：

```
type   abcd, @function
abcd:
.LFB23:
        .cfi_startproc
        movl    %esi, %eax
        xorl    %edi, %eax
        xorl    %edx, %eax
        cmpl    %ecx, %eax
        jne     .L7
        cmpl    %esi, %edi
        jne     .L7
        cmpl    %ecx, %edx
        setne   %al
        cmpl    %edx, %esi
        setne   %dl
        orl     %edx, %eax
        movzbl  %al, %eax
        ret
        .p2align 4,,10
        .p2align 3
.L7:
        movl    $1, %eax
        ret
        .cfi_endproc 
```

而且，如前所述，速度增益是微不足道的（如果有的话）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T23:06:34.253

你可以定义一个宏来做到这一点：

```
#DEFINE ARE_ALL_EQUALS(A, B, C, D) (((A) == (B)) && ((B) == (C)) && ((C) == (D))) 
```

但要注意 B 和 C 的多重评估。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T23:08:13.057

你可以定义一个宏

```
#define ALL_EQUAL(A, B, C, D) ((A) == (B)) && ((B) == (C)) && ((C) == (D)) 
```

但我看不出比通常的东西有任何优势。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-04T00:20:37.680

也许“最快”的方法是比较对，然后检查对的结果： `(A == B) && (C == D) && (A == C)`正如 OP 所指出的那样。对于更多元素，工作对，并在完整的二叉树中组合结果。可能会尽可能地重新排序，以便`&&`平均尽早失败。无论如何，这是一个*非常*专业的操作（如果我曾经做过类似的事情，我不记得了），因此为此提供额外的符号可能会比获得的伤害更大。

与往常一样：首先编写最易读的代码，然后在测量结果表明值得的情况下进行性能评估。人工时间（编写、调试、维护代码）比计算机运行它的时间更有价值，除非在*极*少数情况下。

# c# - 我应该创建多个控制器还是创建具有多个操作的单个控制器来处理更详细的响应？

> ID：14678383
> 
> 赞同：3
> 
> 时间：2013-02-03T23:00:38.730
> 
> 标签：c#, asp.net-web-api

这是一个关于 web api 设计的问题。假设我有一个返回城市和城市属性的方法，例如人口、FIPS 代码和区域。还有更多的属性，通常是 20+。

在某些情况下，我会提交 FIPS 代码并期望返回城市名称。其他时候，我将提交 FIPS 代码并期望返回一些其他属性（可能是区域和人口）。

我的问题是，我应该如何为这些场景构建控制器和操作？我应该有一个名为 City 的控制器和一系列方法来准确返回我需要的内容，还是应该使用多个控制器？

我对 web api 设计相当陌生，但拥有一个控制器感觉更干净。我的想法是一个名为 City 的控制器，具有适当命名的操作，例如 GetNameAndPopulationFromFipsCode() 或类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:03:23.620

资源是相同的，所以实际上它通常是同一个控制器。

我看到了两种自然的方法来实现这一点：

1.  内容协商
2.  客户端传递一个可选参数以获取完整的视图模型

首先是更多的 RESTful 但可能有点痛苦，考虑到当前 Web API 中基于键的连接。

二是更容易实现：

```
// almost pseudocode !!
// called by /api/City/123?extended=true
public City Get(int id, bool? extended)
{
   ExtendedCity city = GetCity(id);
   return extended.HasValue && extended.Value ? MapTo(city) : city;
}

// ----

public class City
{
   ...
}

public class ExtendedCity : City
{
   ...
} 
```

# 更新

正如@Darrel 指出的那样，查询字符串参数会更改资源。**但就资源组织而言，它保持了层次结构**，这就是首选方法的原因。

# touch - 使用 ZURB Foundation 的触控设备 Fastclick？

> ID：14678384
> 
> 赞同：2
> 
> 时间：2013-02-03T23:00:39.757
> 
> 标签：touch, zurb-foundation

如果我使用 ZURB 的**Foundation**创建一个响应式网站，我是否需要包含一个类似**Fastclick**的库（由 FTLabs 提供）以避免触摸设备上的 300 毫秒点击延迟？

似乎图书馆应该包括这个，因为让事情在移动设备上表现得很好是它的主要目的。

我想，当我想到它时，似乎**fastclick**应该包含在需要在触摸设备上显示的每个网站中 - 或者不......？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T11:52:08.103

[此处列出](http://foundation.zurb.com/docs/javascripts.php)了 Foundation 的所有Javascript 库。

*   jQuery.js
*   jquery.foundation.alerts.js - **添加关闭警报的功能**
*   jquery.foundation.buttons.js - **为下拉按钮和拆分添加下拉功能**
*   jquery.foundation.accordion.js - **为手风琴添加打开/关闭功能**
*   jquery.foundation.navigation.js - **向导航元素添加功能**
*   jquery.foundation.topbar.js - **为顶部栏添加功能**
*   jquery.foundation.forms.js - **添加创建自定义表单元素的功能**
*   jquery.foundation.mediaQueryToggle.js - **添加有用的媒体查询查看器工具**
*   jquery.foundation.tabs.js - **向选项卡添加切换功能**
*   jquery.foundation.tooltips.js - **添加工具提示功能**
*   jquery.placeholder.js - **向表单添加占位符函数**
*   jquery.foundation.orbit.js - **我们的自定义图像/内容滑块插件**
*   jquery.foundation.reveal.js - **我们简单的模态插件**
*   jquery.foundation.clearing.js - **我们的新图片库插件**
*   jquery.foundation.magellan.js - **我们甜蜜的新粘性导航插件。**
*   jquery.foundation.joyride.js - **一个很棒的功能游览插件。**

它们都没有涵盖[Fastclick](https://github.com/ftlabs/fastclick)的功能，因此**如果您希望避免 300 毫秒的点击延迟，请手动添加 Fastclick**。关于它是否“应该包含在触摸设备上显示的每个网站中”，我认为这是个人喜好问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-20T11:16:28.797

似乎旧的接受答案不再有效。Fastclick 现在被 Foundation 使用。

在那里搜索“Fastclick”时，在 Foundation Github 存储库中找到了这个：

![Foundation Github Repo 中 Fastclick 搜索的结果](../Images/5e97161f0bb24dd0a9058bbfaf34721f.png)

（来自[https://github.com/zurb/foundation/search?utf8=%E2%9C%93&q=fastclick](https://github.com/zurb/foundation/search?utf8=%E2%9C%93&q=fastclick)）

另外，我在 Foundation Github repo 上找到了这个：

```
 // Enable FastClick if present
  $(function () {
    if (typeof FastClick !== 'undefined') {
      // Don't attach to body if undefined
      if (typeof document.body !== 'undefined') {
        FastClick.attach(document.body);
      }
    }
  }); 
```

（来源：[https](https://github.com/zurb/foundation/blob/d2c9a9a7e84e53e5eff41ac2f61a8425f0760086/js/foundation/foundation.js) ://github.com/zurb/foundation/blob/d2c9a9a7e84e53e5eff41ac2f61a8425f0760086/js/foundation/foundation.js ）

因此，这基本上意味着您**可以**根据需要使用 Fastclick，Foundation 会为您初始化它，但您也可以决定是否从您的库中排除并且不使用 Fastclick。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-14T01:48:34.660

[http://foundation.zurb.com/docs/javascript.html](http://foundation.zurb.com/docs/javascript.html) 文档说使用它，我不确定没有它会有什么问题

# php - 在没有模板的 Zend Framework 2 中进行重定向

> ID：14678385
> 
> 赞同：2
> 
> 时间：2013-02-03T23:00:48.763
> 
> 标签：php, templates, redirect, zend-framework2

我正在尝试从路由 /admin 重定向到 /admin/post/list。

我设置了从 /admin 到 IndexController::indexAction() 的路由

然后我做了这样的控制器

```
class IndexController extends AbstractActionController
{
    public function indexAction()
    {
        $this->redirect()->toRoute('postList');
    }
} 
```

它运行良好，但 ZF2 需要制作模板 index/index.phtml。

在没有空模板的情况下，如何更好地进行重定向？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T23:52:22.240

如果你添加`return`它应该工作：

```
return this->redirect()->toRoute('postList'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T02:08:51.893

我最初发现我根本无法使返回响应选项起作用，尽管有文档和大量失败的尝试。

最后，我删除了我包含的默认应用程序模块，以“开箱即用”引导事物，但没有用于其他任何东西，并且在为它转换了翻译器配置和工厂之后，（根据错误的要求模板 - 我想我什至可以删除它，因为不需要）它开始工作。

嘿，快！

# c++ - 反向字符串函数给了我一个分段错误

> ID：14678388
> 
> 赞同：0
> 
> 时间：2013-02-03T23:01:19.537
> 
> 标签：c++, segmentation-fault

我正在复习我的 C/C++ 技能。我试图实现一个反转字符串的函数，但每次运行程序时都会出现分段错误（核心转储）。

```
#include <stdio.h>
#include <string.h>

void revstr(char *str);

int main()
{
    char *str = "hello mofo!";
    revstr(str);
    puts(str);

    return 0;
}

void revstr(char *str)
{
    int start = 0;
    int len = strlen(str);
    int mid = len / 2;
    int i, t;
    printf("start: %d, mid: %d,len: %d\n", start, mid, len);

    for ( i = start; i < mid; ++i )
    {
        printf("str[%d] swapping to str[%d]: %c, %c\n", i, len - 1 -i, str[i], str[len - 1 - i]);
        t = str[i];
        str[i] = str[len - 1 - i];
        str[len - 1 - i] = t;
    }
} 
```

这个解决方案也给了我同样的段错误：

```
#include <stdio.h>
#include <string.h>

void revstr(char *str);

int main()
{
    char *str = "hello mofo!";
    revstr(str);
    puts(str);

    return 0;
}

void revstr(char *str)
{
    char *end = str;
    char t;
    if ( str )
    {
        while ( *end != 0 )
            end++;
        end--;

        while ( str < end )
        {
            t = *str;
            *str++ = *end;
            *end-- = t;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:03:15.587

```
char *str = "hello mofo!"; 
```

`str`是字符串文字，默认为`const`，更改它是未定义的行为，你想要这个：

```
char str[] = "hello mofo!"; 
```

# javascript - javascript手风琴菜单

> ID：14678391
> 
> 赞同：1
> 
> 时间：2013-02-03T23:02:06.477
> 
> 标签：javascript, menu

我有这个 JavaScript 代码可以使手风琴菜单起作用，它可以工作，有点...当我单击链接时，它确实按应有的方式下降，但是当我再次单击它时，它又恢复了，然后又下降了，而不是像我想的那样隐藏。隐藏刚刚打开的元素的唯一方法是单击菜单上的下一个元素，然后第一个元素将关闭，第二个将打开.. 可以修改为使打开的元素，关闭并保持关闭状态，而不是关闭并立即打开。

代码：

```
// JavaScript Document
$(document).ready(function() {

    //ACCORDION BUTTON ACTION   
    $('div.accordionButton').click(function() {
        $('div.accordionContent').slideUp('normal');    
        $(this).next().slideDown('normal');
    });

    //HIDE THE DIVS ON PAGE LOAD    
    $("div.accordionContent").hide();

}); 
```

```
 <div id="wrapper">
     <div class="accordionButton"><strong>Subject:</strong></div>
    <div class="accordionContent">Text</div>
     <div class="accordionButton"><strong>Subject:</strong></div>
    <div class="accordionContent">Text</div>
     <div class="accordionButton"><strong>Subject:</strong></div>
    <div class="accordionContent">Text</div>        
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:09:45.313

改变：

```
$('div.accordionContent').slideUp('normal');
$(this).next().slideDown('normal'); 
```

成为

```
$('div.accordionContent').not($(this).next()).slideUp('normal');
$(this).next().slideToggle(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:11:18.150

这可能是一个事件冒泡问题，但没有完整的代码，很难说。您可以尝试在单击侦听器的末尾包含“return false”以停止冒泡并确保不执行任何默认行为。

# html - 如何指定我的扩展程序是 Chrome 网上应用店中的“应用程序”？

> ID：14678398
> 
> 赞同：0
> 
> 时间：2013-02-03T23:02:50.600
> 
> 标签：html, google-chrome, google-chrome-extension, chromebook

我制作了一个[Chrome 扩展](https://chrome.google.com/webstore/detail/super-simple-tasks/bngpflcpbefndiblbdjokgpmbldcoplk)并在我的清单中设置了 browser_action。这会在浏览器栏中放置一个小图标，然后单击该图标会运行 background.js，从而在新选项卡中打开应用程序。

但是，我注意到在网上商店中，我的应用程序图标列在一个小拼图中，它不像我安装的其他“应用程序”那样出现在[Chrome 新标签页上。](http://support.google.com/chrome/bin/answer.py?hl=en&answer=95451)

我是否需要在 manifest.json 文件中设置特定内容才能将其列为“应用程序”而不是扩展名？除了删除拼图并将其列在新标签页上之外，将其作为应用程序还有什么好处吗？

这是我的 manifest.json 文件：

```
{
  "manifest_version": 2,

  "content_security_policy": "script-src 'self' 'unsafe-eval'; object-src 'self'",

  "name": "Super Simple Tasks",
  "description": "A very simple tasks app that uses localStorage.",
  "version": "1.1",

  "icons": {
    "16": "img/icon16.png",
    "48": "img/icon48.png",
    "128": "img/icon128.png"
  },

  "permissions": [
    "tabs",
    "storage"
  ],

  "offline_enabled": true,

  "background": {
    "scripts": ["background.js"]
  },

  "browser_action": {
    "default_icon": "img/icon19.png",
    "default_title": "Super Simple Tasks"
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:04:52.840

You need to specify that it is an `app`:

`"app": {...},`

This will explain how to format your manifest: [https://developer.chrome.com/trunk/apps/manifest.html](https://developer.chrome.com/trunk/apps/manifest.html)

# javascript - 在不同域上重定向 iframe 的父级 - 替代逻辑

> ID：14678407
> 
> 赞同：1
> 
> 时间：2013-02-03T23:03:54.803
> 
> 标签：javascript, jquery, html, iframe

我知道以前有人问过类似的问题，但我想知道是否有人可以帮助找到特定问题的解决方案：

我有一个表格，我想在不同的域中嵌入几个不同的网站。此表单需要重定向到 PayPal。计划是将此表单嵌入到 iframe 中，使其易于更新等，并且嵌入的代码最少。但是，由于相同的来源政策，我不能`parent.location.href = "http://PaypalPaymentAddress.com";`用来重定向表单。我不想在框架中处理付款（Paypal 无论如何都禁止这样做）......

我能想到的唯一解决方法是运行一个脚本并将表单呈现到父页面中，调用一个 Web 服务左右来获取 HTML，但这显然是很多工作！

有什么想法可以设置它以使其正常工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:10:05.920

您可以使用表单的目标属性 `"_parent"`，当它被提交时，目标 URL 将被加载到父窗口中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T14:04:23.523

我的最终方法是基于 Molle 博士的回答，但略有不同。我在这里解释了它以防它对其他人有用：

我将表单设置为正常提交，允许我所有的服务器验证等只触发一次。如果表单提交成功（通过服务器验证），一个包含空表单的小型 html 客户端页面将被回传。

这个空表单有一个父页面 URL 的 post 动作，以及一个 target = "Parent" 和在客户端 "document ready" 上，一个 jQuery 方法提交表单，导致父页面重新加载。

如果脚本被禁用，还提供了一个带有“_top”属性的链接。

```
<script type="text/javascript">
    jQuery(document).ready(function () {
        $("#redirectForm").submit();
    });
</script>
<a href="{parentpageurl}" id="redirectLink" target="_top">click here if not redirected automatically</a><br />

<form id="redirectForm" method="POST" action="{parentpageurl}" target="_parent">

</form> 
```

绕过“同源策略”的一种方法，因为此方法适用于跨域。希望对某人有所帮助！

# google-calendar-api - 使用 Python 和 gdata 库通过 id 获取 Google 日历事件

> ID：14678408
> 
> 赞同：0
> 
> 时间：2013-02-03T23:03:59.830
> 
> 标签：google-calendar-api, gdata

如何使用 gdata 库从特定的 Google 日历获取事件并知道事件 ID？我在文档中看不到这样的例子。

我知道我可以（并且应该）使用 v3 API 和 python-api-client，但我想在 Google Apps 域的所有用户日历中添加和修改事件，而无需用户干预。有一个更好的方法吗？

提前致谢，并致以最诚挚的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:29:16.290

自我回应：

```
from gdata.calendar.client import *
from gdata.calendar import *

gdclient = gdata.calendar.client.CalendarClient(source = 'testing')

gdclient.ClientLogin(ADMIN_USER_LOGIN, ADMIN_USER_PASSWORD, gdclient.source)

feed_uri = gdclient.get_calendar_event_feed_uri(calendar = THE_USER_EMAIL)

event_uri = feed_uri + '/' + THE_EVENT_ID

calendar_entry = gdclient.get_calendar_entry(event_uri, desired_class=gdata.calendar.data.CalendarEventEntry)) 
```

我意识到的一件事是没有办法改变事件的颜色（或者，至少，我没有找到它）。这可以通过 Google Calendar API v3 实现。

# html - CSS 下拉菜单错误 - 无法定位特定元素

> ID：14678409
> 
> 赞同：0
> 
> 时间：2013-02-03T23:04:07.493
> 
> 标签：html, css, drop-down-menu

1.  试图使服务链接在悬停时变为橙色，背景为灰色 - 如果不更改所有菜单项，就无法做到这一点。
2.  将鼠标悬停在服务上后，我无法单击示例链接。

    ```
     .menu
                {
                margin:0;
                padding:0;
                 }

        .menu ul {

                padding-top: 40px;
                padding-left: 0px;
                line-height: 0px;
                margin-bottom: 0px;
                float: right;
            }

            ul li {
                display: inline;
            }

            ul li a:visited {
                text-decoration: none;
            }

            ul li a:hover, .menu ul li .current{
                color: #f7823b;
            }

            ul li {
              display: block;
              position: relative;
              float: left;
            }
            li ul { display: none; }

            ul li a {
                float: left;
                font-size: 20px;
              display: block;
              text-decoration: none;
              color: #ffffff;
              padding: 20px;
              margin-left: 1px;
              white-space: nowrap;

            }

            li:hover ul {
              display: block;

            }
            li:hover li {
              float: none;
              font-size: 11px;
            }
            ul ul li:hover a { background: #818285; }
            /*li:hover li a:hover { background: #818285;    width:100%; }*/

            ul ul {
                position: absolute;
                z-index: 500;
                margin:0;
                padding-top: 0px;
            }

            ul ul li a
            {
                padding: 20px 0px 20px 5px;
                width: 100%;
                background: #818285;
            } 
    ```

    ```
     <div class="socialmedia">
          <a href="https://www.facebook.com/cyclonestrategies"><img class="button" src="http://lifeafterclass.com/cyclone/images/header/facebook.png" <="" img=""></a>
            <a href="https://twitter.com/CycloneStrategy"><img class="button" src="http://lifeafterclass.com/cyclone/images/header/twitter.png" <="" img=""></a>
            <a href="http://www.stumbleupon.com/stumbler/CyclonStrategies">
            <img class="button" src="http://lifeafterclass.com/cyclone/images/header/stumbleupon.png" <="" img=""></a>
            <a href="http://www.linkedin.com/company/cyclone-strategies-llc">
            <img class="button" src="http://lifeafterclass.com/cyclone/images/header/linkedin.png" <="" img=""></a>
        </div>

        <div class="menu">
            <ul id="menu">
                <li><a href="/">Home</a></li>
                <li><a href="/about-us"> About</a></li>
                <li class="special"><a href=""> Services</a>
                <ul>
                <li><a href="/digital-advertising">Digital Advertising</a></li>
                <li><a href="/promotion-management">Promotion Management</a></li>
                <li><a href="/social-media">Social Media</a></li>
                </ul>
            </li>
            <li><a href="/examples">Examples</a></li>
                <li><a href="/blog"> Blog</a> </li>
                <li><a href="contact-us"> Contact Us</a></li>
            </ul>

        </div>

            <div style="clear:both"></div>
    </div> 
    ```

我已经尝试了一切 - 任何帮助表示赞赏。谢谢！ [http://jsfiddle.net/8ARm5/](http://jsfiddle.net/8ARm5/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:07:02.587

由于`li`包含服务有一个类`special`，您可以使用它在悬停时定位元素。

```
.special:hover{
  color: orange;
  background: grey;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:36:33.240

尝试在`li`非`a`元素上添加悬停：

```
li:hover > a {
   color: #f7823b;
} 
```

这样做，即使您在子菜单中指向链接，链接也会保留样式定义。看看：http: [//jsfiddle.net/8ARm5/5/](http://jsfiddle.net/8ARm5/5/)

# python - Unpickle 有时会生成空白对象

> ID：14678412
> 
> 赞同：1
> 
> 时间：2013-02-03T23:04:35.760
> 
> 标签：python, serialization, pickle

我正在尝试使用 pickle 来保存自定义类；非常类似于下面的代码（尽管在类上定义了一些方法，还有更多的字典等用于数据）。但是，通常当我运行它时，pickle 然后 unpickle，我会丢失类中的所有数据，就好像我创建了一个新的空白实例一样。

```
import pickle
class MyClass:
    VERSION = 1
    some_data = {}
    more_data = set()

    def save(self,filename):
        with open(filename, 'wb') as f:
            p = pickle.Pickler(f)
            p.dump(self)

    def load(filename):
        with open(filename,'rb') as ifile:
            u = pickle.Unpickler(ifile)
            obj = u.load()
            return obj 
```

我想知道这是否与泡菜类的备忘录有关，但我觉得不应该。当它不起作用时，我查看生成的文件，它看起来像这样：（显然不是可读的，但它显然不包含数据）

```
€c__main__
我的课
q
```

无论如何，我希望这足以让某人了解这里可能发生的事情，或者看什么。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T04:51:52.317

您遇到的问题是您使用可变类变量来保存数据，而不是将数据放入实例变量中。

该`pickle`模块只保存直接存储在实例上的数据，而不是也可以通过`self`. 当您发现未腌制的实例没有数据时，这可能意味着该类不包含上次运行的数据，因此实例无法再访问它。

以这种方式使用类变量也可能会导致其他问题，因为数据将由类的所有实例共享！这是一个说明问题的 Python 控制台会话代码：

```
>>> class Foo(object):
        class_var = []
        def __init__(self, value):
            self.class_var.append(value)

>>> f1 = Foo(1)
>>> f1.class_var
[1]
>>> f2 = Foo(2)
>>> f2.class_var
[1, 2] 
```

这可能不是你想要的。但它变得更糟了！

```
>>> f1.class_var
[1, 2] 
```

您认为属于的数据`f1`已因`f2`. 事实上，它是`f1.class_var`同一个对象`f2.class_var`（它也可以`Foo.class_var`直接通过，而无需经过任何实例）。

所以，使用类变量几乎肯定不是你想要的。相反，为类编写一个`__init__`创建新值并将其保存为实例变量的方法：

```
>>> class Bar(object):
        def __init__(self, value):
            self.instance_var = [] # creates a separate list for each instance!
            self.instance_var.append(value)

>>> b1 = Bar(1)
>>> b1.instance_var
[1]
>>> b2 = Bar(2)
>>> b2.instance_var # doesn't include value from b1
[2]
>>> b1.instance_var # b1's data is unchanged
[1] 
```

Pickle 将按照您的预期处理这个类。它的所有数据都在实例中，所以当你 unpickle 时，你永远不应该得到一个空实例。

# f# - 使用单声道安装 f# 3 windows xp

> ID：14678414
> 
> 赞同：2
> 
> 时间：2013-02-03T23:04:50.683
> 
> 标签：f#, mono, xbuild

我正在尝试使用 mono 3 而不是 .net 工具从源代码[https://github.com/fsharp/fsharp](https://github.com/fsharp/fsharp)安装 f# 3.0，因为我有 net 4.0 并且我需要一个 >=4.5 的版本（仅适用于 windows vista 和窗户 8)

当我尝试构建 fsharp-proto-build.proj 时，问题就变成了。我明白了：

```
MSBUILD : warning MSB4056: Se debe llamar al motor de MSBuild en Singlethread-Apartment. El modelo de subprocesos actual es '"MTA".
basically it's saying than I need change the msbuild engine to singlethread instead mta...I can't found how do this... 
```

当我尝试构建 fsharp-library-build.proj 时，我得到了这个：

```
 C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(1360,9):
warning MSB3257: La referencia principal "C:\fsh\fsharp\lib\debug\4.0\FSharp.Core.dll" no se pudo resolver porque su versión es superior "4.3.0.0" a la existente en la versión de .NET Framework de destino actual. La que se encuentra en la versión de .NET Framework de destino actual es "4.0.0.0".

************************************************************************************
I can't understand why is referencing to net framework when I'm using xbuild with mono 3

C:\fsh\fsharp\src\fsharp\FSharp.Data.TypeProviders\TypeProviderEmit.fs(25,49): error FS0039: The type 'TypeProviderEditorHideMethodsAttribute' is not defined

C:\fsh\fsharp\src\fsharp\FSharp.Data.TypeProviders\TypeProviderEmit.fs(25,42): error FS0752: The operator 'expr.[idx]' has been used on an object of indeterminate type based on information prior to this program point. Consider adding further type constraints

C:\fsh\fsharp\src\fsharp\FSharp.Data.TypeProviders\TypeProviderEmit.fs(34,49): error FS0039: The type 'TypeProviderXmlDocAttribute' is not defined

........

2 warning(s)

57 Errors 
```

请帮助我不熟悉.net或单声道工具...谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T02:42:44.133

安装 Mono 3.0 后，您应该从开始菜单启动 Mono 命令提示符，然后执行

xbuild*参数*

否则，xbuild 使用 Microsoft .NET Framework 作为主机。

强烈建议使用 MSBuild 来构建 F#，这就是他们在 README 中所说的（该 readme 文件对于 Windows 案例不是很准确，我可能会在本周末抽出一些时间），

[https://github.com/fsharp/fsharp](https://github.com/fsharp/fsharp)

由于您使用的是 Windows XP，请尝试构建一个干净的盒子，而不安装 Microsoft .NET Framework，然后使用 Mono 和 F#。这应该可以为您节省一些时间，因为您不需要同时与两者作战。

已编辑：目前 Mono 2.10.9 和 3.0.3 都不能在 Windows 上编译 fsharp master。将进一步调查以了解如何编译它。

# matlab - 如何在matlab中绘制for循环结果？

> ID：14678415
> 
> 赞同：-1
> 
> 时间：2013-02-03T23:04:54.323
> 
> 标签：matlab, plot

我正在计算求和与积分相比的绝对误差（求和答案 - 积分答案）：

e^x 从 0 到 1 的积分，与 (1/n)*summation(e^rand()) 从 i = 1 到 n 进行比较。

我必须在 matlab 中绘制误差与 n 的关系。我无法理解如何做到这一点。我可以通过使用从 1 到 50 的 for 循环来计算从 1 到任意数字（如 50）的误差。但是，我将如何绘制这个？我需要对不同的 n 值进行多次求和吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:13:36.740

所以你要做的是同时计算积分和误差函数的面积，并将它们存储在一个数组中：

```
maxLevel = 50;
integral = zeros(maxLevel, 1);
summation = zeros(maxLevel, 1);

for i = 1:maxLevel

    integral(i) = integralFunction(i);
    summation(i) = summationFunction(i);
end 
```

然后你可以像这样绘制：

```
plot(1:length(integral), integral, 'r');
hold on;
plot(1:length(summation), summation, 'g'); 
```

# c# - 更改列表中项目的属性

> ID：14678418
> 
> 赞同：2
> 
> 时间：2013-02-03T23:05:47.177
> 
> 标签：c#, linq

如何以最简洁的方式更改列表中单个项目的单个属性？

```
 public static class QuestionHelper
    {
        public static IEnumerable<SelectListItem> GetSecurityQuestions()
        {
            return new[]
                {
                    new SelectListItem { Value = "What was your childhood nickname?", Text = "What was your childhood nickname?"},
                    new SelectListItem { Value = "What is the name of your favorite childhood friend?", Text = "What is the name of your favorite childhood friend?"},
                    ...
                };
        }
    } 
```

我想生成此列表，根据字符串设置 Selected 属性一项：

```
string selectText = "What is the name of your favorite childhood friend?";
form.SecurityQuestions = QuestionHelper.GetSecurityQuestions().Select(x => { /*Set Selected = true for SelectListItem where item.Text == selectedText */ } );

return PartialView(form); 
```

注意：这必须考虑 if(selectedText == null) 然后将第一项设置为 Selected

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:08:28.440

不要用 LINQ 做，用`foreach`!

```
form.SecurityQuestions = QuestionHelper.GetSecurityQuestions();
foreach(var item in form.SecurityQuestions)
    item.Selected = item.Text == selectedText;

if(selectedText == null)  // Select the first item by default
    form.SecurityQuestions.First().Selected = true; 
```

LINQ 已创建用于查询否以修改对象的状态。

# nokia - 无法在 Meego/Harmattan 中以编程方式修改文件

> ID：14678420
> 
> 赞同：0
> 
> 时间：2013-02-03T23:05:47.150
> 
> 标签：nokia, meego, meego-harmattan

我正在开发一个 Meego/Harmattan 应用程序，在我的包中有一个文件 x.dat，我需要使用我的可执行 foo 应用程序在其中写入，Debian 包成功并在 /opt/foo/bin 中安装 x.dat 但是当我调试，应用程序 foo 拒绝为后续的 fwrite 成功打开文件，这是否与缺少 Aegis 清单条目有关？，该条目的正确句子是什么，是否手动完成？

注意：我尝试使用不同的路径来安装数据文件 x.dat，但没有成功，这包括尝试 /home/user。提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T10:58:42.057

您的应用程序没有写入权限，`/opt`因为它以`user`. 您必须将文件放入安装`/home/user/.yourapp/`后脚本中。（您也可以直接输入文件，但不建议这样做）`chown``user:user``/opt`

# android - 如何在 X 秒后发送延迟的 BroadcastReceiver

> ID：14678426
> 
> 赞同：2
> 
> 时间：2013-02-03T23:06:14.827
> 
> 标签：android, broadcastreceiver

我有一个扩展的类，`BroadcastReceiver`在`onReceive`这个类的方法中我有这个代码：

```
Intent autoBoostIntent = new Intent();
autoBoostIntent.setAction(Values.ACTION_AUTO_BOOST);
context.sendBroadcast(autoBoostIntent); 
```

其目的是使用特定的`action`. 问题是，我想延迟上述过程，例如每 10 秒发送一次广播。这可能吗？

**编辑：**我希望广播无限期循环，无论设备是否唤醒（键盘解锁）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:21:03.977

简单来说，您可以在`Thread.sleep(10000)`代码中添加一个，这将导致线程在继续执行下一个操作之前休眠 10 秒。

如果您正在使用`BroadcastReceivers`，您可以扩展您的应用程序以使用[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html)类，该类将在设定的时间触发广播（您可以通过编程将其设置为从现在开始的 10 秒）。

或者你可以使用[Handler](http://developer.android.com/reference/android/os/Handler.html)。

# android - 从两个不同的应用程序访问数据库

> ID：14678427
> 
> 赞同：2
> 
> 时间：2013-02-03T23:06:16.143
> 
> 标签：android, database, android-contentprovider

我正在创建已发布免费 Lite 版的应用程序的高级版。我想将数据从精简版传输到高级版，或者让两个版本访问同一个数据库。[Android，两个应用一个数据库？](https://stackoverflow.com/questions/9130832/android-two-apps-one-database/)帮助回答了后面的怎么做。如果数据库是在精简版中创建的，那么当用户安装高级版时会发生什么？他们是否必须安装精简版才能保留数据？另一方面，我能否在独立于任一版本但仍处于沙盒状态的位置创建数据库？最终，我希望能够允许用户在安装 Premium 版本后删除 Lite 版本，但仍保持所有数据完好无损。我该怎么做呢？还是我坚持让我的用户在升级到高级版后仍然安装这两个版本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T02:26:51.193

我建议至少研究一下 CouchDB 来托管数据。您将数据创建为文档（以 JSON 格式），然后创建包含文档的数据库。

此外，您可以在数据上创建视图 - [http://wiki.apache.org/couchdb/HTTP_view_API](http://wiki.apache.org/couchdb/HTTP_view_API)。您可以将参数传递给视图以过滤数据等。

[您可以使用 Cloudant ( https://cloudant.com/](https://cloudant.com/) ) 或 IrisCouch ( [http://www.iriscouch.com/](http://www.iriscouch.com/) )创建示例 CouchDB 。我知道 Cloudant 支持 HTTP 身份验证，因此您可以在 Android 设备上使所有调用看起来像这样：

`[http://user:password@yourdomain.com/database](http://user:password@yourdomain.com/database)`

另一种选择是查看 TouchDB，它为您处理来自 CouchDB 的复制。[https://github.com/couchbaselabs/TouchDB-Android](https://github.com/couchbaselabs/TouchDB-Android)请记住，该项目现在有点落后，所以我认为它还没有准备好生产，但他们今年重点关注它，所以应该是很快就来了。

只是建立具有身份验证的共享数据库的一个选项。然后，您可以托管相同的数据，并将精简版与高级版的内容严格保留在 UI 中。

# ruby-on-rails - 如何向专有的 ruby gem 添加一行，以便它可以在 Heroku 上正常工作？

> ID：14678428
> 
> 赞同：0
> 
> 时间：2013-02-03T23:06:17.037
> 
> 标签：ruby-on-rails, ruby, rubygems

我需要添加

```
attr_accessible :user 
```

对engagecsm gem 的投票模型。

请参阅此问题了解我为什么需要这样做（跳至答案）：[Rails Engage！错误（无法批量分配受保护的属性：用户）](https://stackoverflow.com/questions/14421250/rails-engage-error-cant-mass-assign-protected-attributes-user)

现在，通常我会在 github 上分叉并添加行，但没有 github，而且我认为将其公开或其他内容可能违反规则。无论如何，所以我刚刚在 gemfile 中添加了 gem，如下所示：[https ://rubygems.org/gems/engagecsm](https://rubygems.org/gems/engagecsm)

通过在本地计算机上打开 gem 并输入该行，我已将该行添加到本地安装的engagecsm 中。但是，我希望这适用于 Heroku。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:15:41.677

在您的`lib`文件夹中，创建一个文件（我的建议是`lib/ext/engagecms/vote.rb`），然后输入以下内容：

```
require 'engagecms' #make this the correct require for the gem, the goal is to force the gem to load before your code

class Vote < ActiveRecord::Base # you'll need to make this declaration equal the engage one
  attr_accessible :user
end 
```

这是猴子修补代码，因此将来可能会由于升级而中断。

更好的长期策略是创建一个包装器，将`Vote.create(params[:vote])`（`params[:vote]`具有您的`user`属性）转换为

```
user = params[:vote].delete(:user)

Vote.create(params[:vote]) do |v|
  v.user = user
end 
```

这种技术可以让你表现得好像它是可访问的，但避免了猴子补丁，由于存在损坏和冲突的风险，这不是最佳实践。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:16:35.237

在`config/application.rb`：

```
# run before each request in dev, or during initialization in test & prod
config.to_prepare do
  # re-open the `Vote` class so we can make some changes
  Vote.class_exec do
    # the custom changes
    attr_accessible :user
  end
end 
```

# symfony - Symfony2 登录 - 错误凭据 | Doctrine 不接收任何参数

> ID：14678429
> 
> 赞同：2
> 
> 时间：2013-02-03T23:06:25.163
> 
> 标签：symfony, login, doctrine, credentials

我是一个 symfony 新手，我正在尝试创建一个注册和登录表单。到目前为止，我已经注册成功。但是登录表单不断向我返回“Bad Credentials”错误。我检查了很多关于这个问题的线程，但我似乎无法弄清楚。
我创建了 User.php，它有一些基础知识：

```
<?php
    namespace Money\MainBundle\Entity;

    use Doctrine\ORM\Mapping as ORM;
    use Symfony\Component\Validator\Constraints as Assert;
    use Symfony\Bridge\Doctrine\Validator\Constraints\UniqueEntity;
    use Symfony\Component\Security\Core\User\AdvancedUserInterface;

    /**
     * @ORM\Entity
     * @ORM\Table(name="user")
     * @UniqueEntity(fields="email", message="Email already taken", groups="registration")
     * @UniqueEntity(fields="username", message="Username already taken", groups="registration")
     */
    class User implements AdvancedUserInterface, \Serializable
    {
    /**
     * @ORM\Id
     * @ORM\Column(type="integer")
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    private $id;

    /**
     * @ORM\Column(type="string", unique=true)
     * @Assert\NotBlank(groups="registration")
     */
    private $username;

    /**
     * @ORM\Column(type="string", unique=true)
     * @Assert\Email(groups="registration")
     * @Assert\NotBlank(groups="registration")
     */
    private $email;

    /**
     * @ORM\Column(type="string")
     * @Assert\NotBlank(groups="registration")
     * @Assert\MinLength(limit=4, groups="registration", message="Your password needs to have at least 4 characters")
     */
    private $password;

    /**
     * @ORM\Column(name="is_active", type="boolean")
     */
    private $isActive;

    /**
     * @ORM\Column(type="string", length=32)
     */
    private $salt;

    /**
     * constructor
     */

    public function __construct()
    {
        $this->isActive = true;
        $this->salt = md5(uniqid(null, true));
    }

    /**
     * setters
     */

    public function setEmail($email)
    {
        $this->email = $email;
    }

    public function setPassword($password)
    {
        $this->password = $password;
    }

    public function setUsername($username)
    {
        $this->username = $username;
    }

    /**
     * advanced
     */

    public function isAccountNonExpired()
    {
        return true;
    }

    public function isAccountNonLocked()
    {
        return true;
    }

    public function isCredentialsNonExpired()
    {
        return true;
    }

    public function isEnabled()
    {
        return $this->isActive;
    }

    /**
     * @inheritDoc
     */
    public function getUsername()
    {
        return $this->username;
    }

    /**
     * @inheritDoc
     */
    public function getEmail()
    {
        return $this->email;
    }

    /**
     * @inheritDoc
     */
    public function getSalt()
    {
        return $this->salt;
    }

    /**
     * @inheritDoc
     */
    public function getPassword()
    {
        return $this->password;
    }

    /**
     * @inheritDoc
     */
    public function getRoles()
    {
        return array('ROLE_USER');
    }

    /**
     * @inheritDoc
     */
    public function eraseCredentials()
    {
    }

    /**
     * @see \Serializable::serialize()
     */
    public function serialize()
    {
        return serialize(array(
            $this->id,
        ));
    }

    /**
     * @see \Serializable::unserialize()
     */
    public function unserialize($serialized)
    {
        list (
            $this->id,
        ) = unserialize($serialized);
    }
} 
```

然后我有security.yml

```
jms_security_extra:
    secure_all_services: false
    expressions: true

security:
    encoders:
        Symfony\Component\Security\Core\User\User: plaintext
        Money\MainBundle\Entity\User: 
            algorithm: sha512   
            encode_as_base64: true
            iterations: 10

    role_hierarchy:
        ROLE_ADMIN:       ROLE_USER
        ROLE_SUPER_ADMIN: [ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

    providers:
        user_db:
            entity: { class: Money\MainBundle\Entity\User, property: username }

    firewalls:
        dev:
            pattern:  ^/(_(profiler|wdt)|css|images|js)/
            security: false

        login:
            pattern:  ^/login$
            security: false

        secured_area:
            pattern:    ^/dashboard
            form_login:
                check_path: /dashboard/login_check
                login_path: /login
            logout:
                path:   /logout
                target: /

    access_control:
        - { path: ^/dashboard, roles: ROLE_ADMIN } 
```

我创建登录表单

```
class LoginForm extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('username', 'text', array('attr' => array('placeholder' => 'Username', 'class' => 'span12')));
        $builder->add('password', 'password', array('attr' => array('placeholder' => 'Password', 'class' => 'span12')));
    }

    // public function getDefaultOptions(array $options)
    // {
    //     return array(
    //         'data_class' => 'Money\MainBundle\Entity\User'
    //     );
    // }

    public function getName()
    {
        return 'login';
    }
} 
```

登录操作在这里

```
public function loginAction()
    {
        //create login form
        $form = $this->createForm(new LoginForm(), new User());
        //request
        $request = $this->getRequest();
        $session = $request->getSession();

        // get the login error if there is one
        if ($request->attributes->has(SecurityContext::AUTHENTICATION_ERROR)) {
            $error = $request->attributes->get(
                SecurityContext::AUTHENTICATION_ERROR
            );
        } else {
            $error = $session->get(SecurityContext::AUTHENTICATION_ERROR);
            $session->remove(SecurityContext::AUTHENTICATION_ERROR);
        }

        return $this->render(
            'MoneyMainBundle:Main:signup.html.twig',
            array(
                'error' => $error,
                'form' => $form->createView(),
                'register' => false
            )
        );
    } 
```

我也像这样编码我的密码：

```
public function signUpAction()
{
    //create valid form entity
    $form = $this->createForm(new RegisterForm(), new User());
    //check request
    $request = $this->getRequest();
    if ($request->getMethod() == 'POST') {
        $form->bindRequest($request);

        if ($form->isValid()) {
            //useful variables
            $user = $form->getData();
            $factory = $this->get('security.encoder_factory');
            $encoder = $factory->getEncoder($user);
            //encode password
            $pass = $encoder->encodePassword($user->getPassword(), $user->getSalt());
            $user->setPassword($pass);
            //save data to db
            $em = $this->getDoctrine()->getEntityManager();
            $em->persist($user);
            $em->flush();

            return $this->redirect($this->generateUrl('money_main_dashboard'));
        }
    }

    return $this->render('MoneyMainBundle:Main:signup.html.twig', array(
        'form' => $form->createView(),
        'register' => true,
        'error' => false
    ));
} 
```

最后，日志在这里：

```
Marker - Feb 4, 2013 12:02:57 AM
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\FrameworkBundle\EventListener\SessionListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\RouterListener::onKernelRequest". [] []
[2013-02-04 00:03:01] request.INFO: Matched route "money_main_login_check" (parameters: "_route": "money_main_login_check") [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\LocaleListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\Security\Http\Firewall::onKernelRequest". [] []
[2013-02-04 00:03:01] doctrine.DEBUG: SELECT t0.id AS id1, t0.username AS username2, t0.email AS email3, t0.password AS password4, t0.is_active AS is_active5, t0.salt AS salt6 FROM user t0 WHERE t0.username = ? LIMIT 1 ["NONE_PROVIDED"] []
[2013-02-04 00:03:01] security.INFO: Authentication request failed: Bad credentials [] []
[2013-02-04 00:03:01] security.DEBUG: Redirecting to /login [] []
[2013-02-04 00:03:01] event.DEBUG: Listener "Symfony\Component\Security\Http\Firewall::onKernelRequest" stopped propagation of the event "kernel.request". [] []
[2013-02-04 00:03:01] event.DEBUG: Listener "Symfony\Bundle\AsseticBundle\EventListener\RequestListener::onKernelRequest" was not called for event "kernel.request". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\Security\Http\Firewall\ContextListener::onKernelResponse". [] []
[2013-02-04 00:03:01] security.DEBUG: Write SecurityContext in the session [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\Security\Http\RememberMe\ResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Bridge\Monolog\Handler\FirePHPHandler::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\CacheListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Bundle\WebProfilerBundle\EventListener\WebDebugToolbarListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\StreamedResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.terminate" to listener "Symfony\Bundle\SwiftmailerBundle\EventListener\EmailSenderListener::onKernelTerminate". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\FrameworkBundle\EventListener\SessionListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\RouterListener::onKernelRequest". [] []
[2013-02-04 00:03:01] request.INFO: Matched route "money_main_login" (parameters: "_controller": "Money\MainBundle\Controller\MainController::loginAction", "_route": "money_main_login") [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\LocaleListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\Security\Http\Firewall::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\AsseticBundle\EventListener\RequestListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Symfony\Bundle\FrameworkBundle\DataCollector\RouterDataCollector::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\ControllerListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\ParamConverterListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\TemplateListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Acme\DemoBundle\EventListener\ControllerListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Symfony\Component\HttpKernel\DataCollector\RequestDataCollector::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\Security\Http\RememberMe\ResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Bridge\Monolog\Handler\FirePHPHandler::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\CacheListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Bundle\WebProfilerBundle\EventListener\WebDebugToolbarListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\StreamedResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.terminate" to listener "Symfony\Bundle\SwiftmailerBundle\EventListener\EmailSenderListener::onKernelTerminate". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\FrameworkBundle\EventListener\SessionListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\RouterListener::onKernelRequest". [] []
[2013-02-04 00:03:01] request.INFO: Matched route "_wdt" (parameters: "_controller": "Symfony\Bundle\WebProfilerBundle\Controller\ProfilerController::toolbarAction", "token": "510eeca5b649c", "_route": "_wdt") [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\HttpKernel\EventListener\LocaleListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Component\Security\Http\Firewall::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.request" to listener "Symfony\Bundle\AsseticBundle\EventListener\RequestListener::onKernelRequest". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Symfony\Bundle\FrameworkBundle\DataCollector\RouterDataCollector::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\ControllerListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\ParamConverterListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\TemplateListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Acme\DemoBundle\EventListener\ControllerListener::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.controller" to listener "Symfony\Component\HttpKernel\DataCollector\RequestDataCollector::onKernelController". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\Security\Http\RememberMe\ResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Bridge\Monolog\Handler\FirePHPHandler::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Sensio\Bundle\FrameworkExtraBundle\EventListener\CacheListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\ProfilerListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Bundle\WebProfilerBundle\EventListener\WebDebugToolbarListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.response" to listener "Symfony\Component\HttpKernel\EventListener\StreamedResponseListener::onKernelResponse". [] []
[2013-02-04 00:03:01] event.DEBUG: Notified event "kernel.terminate" to listener "Symfony\Bundle\SwiftmailerBundle\EventListener\EmailSenderListener::onKernelTerminate". [] [] 
```

重要的部分应该是教义调试：

```
[2013-02-04 00:03:01] doctrine.DEBUG: SELECT t0.id AS id1, t0.username AS username2, t0.email AS email3, t0.password AS password4, t0.is_active AS is_active5, t0.salt AS salt6 FROM user t0 WHERE t0.username = ? LIMIT 1 ["NONE_PROVIDED"] [] 
```

但我不知道为什么它没有收到任何帖子参数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T09:11:10.920

问题是输入字段中的名称值是 login[username] 和 login[password]，我无法将这些名称更改为 _username 和 _password（login_check 接受）所以我必须手动创建一个表单（没有抽象类型和表单生成器），现在它可以工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T15:34:35.687

如果您的表单类型类在 getName 方法中返回空字符串或 null，那么您的输入应该具有属性名称

```
class LoginType extends AbstractType {

    public function buildForm(FormBuilderInterface $builder, array $options) {
        $builder->add('_username')->add('_password', 'password');
    }   

    public function getName() {
        return '';
    }
} 
```

这应该够了吧

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-08T16:23:21.553

如果您创建了自己的表单类，您还可以在 security.yml 中输入以下内容：

```
username_parameter: login[username]
password_parameter: login[password] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-26T15:21:36.743

只需制作树枝模板并将字段命名为“_username”和“_password”。那么魔法应该为你完成。

# java - 安卓邮箱验证

> ID：14678430
> 
> 赞同：2
> 
> 时间：2013-02-03T23:06:31.357
> 
> 标签：java, android

> **可能重复：**
> [我应该如何在 Android 上验证电子邮件地址？](https://stackoverflow.com/questions/1819142/how-should-i-validate-an-e-mail-address-on-android)

我用这个：

```
Pattern.matches("^(.+)@([^@]+[^.])$", email) 
```

我进入时它不起作用`asdf@asdf`，为什么pelase？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:09:49.453

```
Pattern.matches("^(.+)@([^@]+[^.]).([^.])$", email) 
```

它适用于这样的电子邮件：

```
name@name.com 
```

# php - 如果特定用户已登录，则 Wordpress 重定向

> ID：14678433
> 
> 赞同：1
> 
> 时间：2013-02-03T23:06:34.237
> 
> 标签：php, wordpress

我目前在一个站点内设置了两个成员区域。如果用户登录，然后决定浏览一般网站，当他们再次单击“会员区”图标时，我希望该页面确定哪个用户已登录，然后将他们重定向到正确的会员区域。如果没有用户登录，它应该显示登录表单。

我目前有以下内容：

```
<?php 
if ( $session->logged_in ) {
    if ( $username == "user1" ) {
        wp_redirect ( home_url("/members-area-1") );
        exit; }
    } elseif ( $username == "user2" ) {
        wp_redirect ( home_url("/members-area-2") );
        exit; 
    } else {     
?> 
```

目前它没有重定向，它只显示登录表单，无论我以哪个用户身份登录。关于如何使这项工作正常工作的任何建议？

（温柔点，说到 wordpress 和 php 开发，我还是很原始的）

非常感谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:00:19.797

你可以试试这个

```
if ( is_user_logged_in() )
{
    global $current_user;
    if( $current_user->user_login == 'user1' )
    {
        wp_redirect( home_url("/members-area-1") );
    }
    elseif( $current_user->user_login == 'user2' )
    {
        wp_redirect( home_url("/members-area-2") );
    }
    else
    {
        // logged in but doesn't match
    }
} 
```

请参阅[用户](http://codex.wordpress.org/Function_Reference/is_user_logged_in)在 codex 上登录（）。

**更新：**要解决标头发送警告问题，您可以在`functions.php`文件中添加以下代码以启用输出缓冲

```
add_action('init', 'buffer_start');
add_action('wp_footer', 'buffer_end');

function callback($buffer) { return $buffer; } // This is not necessury if you don't use callback argument in the ob_start function.
function buffer_start() { ob_start("callback"); }
function buffer_end() { ob_end_flush(); } 
```

# python - 将参数从父函数传递给嵌套函数Python

> ID：14678434
> 
> 赞同：3
> 
> 时间：2013-02-03T23:06:33.790
> 
> 标签：python, arguments, nested-loops, nested-function

这是我的代码：

```
def f(x):
    def g(n):
        if n < 10:
            x = x + 1
            g(n + 1)
    g(0) 
```

当我评估 f(0) 时，会出现错误“x 在赋值之前引用”。

但是，当我使用 "print x" 而不是 "x = x + 1" 时，它会起作用。

似乎在 g 的范围内，我只能将 x 用作“使用事件”而不是“绑定事件”。我想问题是 f 只传递给 g x 的值。

我理解正确与否？如果不是，有人可以解释为什么“x = x + 1”的左侧在引用之前没有定义吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:08:42.333

你理解正确。在 Python 2 的嵌套范围内，您不能使用`x`to 赋值。

`nonlocal`在 Python 3 中，您仍然可以通过将变量标记为;来将其用作绑定事件。这是为此用例引入的关键字：

```
def f(x):
    def g(n):
        nonlocal x
        if n < 10:
            x = x + 1
            g(n + 1)
    g(0) 
```

在 python 2 中，你有一些变通方法；使用可变的以避免需要绑定它，或（ab）使用函数属性：

```
def f(x):
    x = [x]   # lists are mutable
    def g(n):
        if n < 10:
            x[0] = x[0] + 1   # not assigning, but mutating (x.__setitem__(0, newvalue))
            g(n + 1)
    g(0) 
```

或者

```
def f(x):
    def g(n):
        if n < 10:
            g.x = g.x + 1
            g(n + 1)
    g.x = x  # attribute on the function!
    g(0) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:09:14.617

是的，分配名称与读取它们的值不同。除非您另外指定，否则在函数中分配的任何名称都被视为该函数的局部变量。

在 Python 2 中，“指定其他方式”的唯一方法是使用一条`global`语句来允许您分配给全局变量。在 Python 3 中，您还可以使用`nonlocal`语句为更高（但不一定是全局）范围内的变量赋值。

在您的示例中，`x`位于更高但非全局范围内（函数`f`）。因此，在 Python 2 中无法`x`从内部进行分配`g`。在 Python 3 中，您可以`nonlocal x`使用`g`.

# wordpress - 如何更改编辑帖子链接的 URL？

> ID：14678435
> 
> 赞同：2
> 
> 时间：2013-02-03T23:06:42.923
> 
> 标签：wordpress

我想更改编辑帖子链接的 URL，以便将您定向到我自己的自定义编辑页面。我一直在寻找过滤器或功能，但我能找到的只是`edit_post_link()`功能和`get_edit_post_link()`功能。从我从[文档](http://codex.wordpress.org/Function_Reference/edit_post_link)中可以看到，`edit_post_link`只更改链接文本，而不是 URL。我`get_edit_post_link`相信会为您获取 URL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T02:23:43.223

您需要将过滤器添加到`get_edit_post_link`. 这是未经测试的，但类似于：

```
add_filter( 'get_edit_post_link', 'my_edit_post_link' );
function my_edit_post_link( $url, $post->ID, $context) {
    $url = //However you want to generate your link

    return $url;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-06T17:14:53.873

工作版本：

```
add_filter( 'get_edit_post_link', 'my_edit_post_link', 10, 3 );
function my_edit_post_link( $url, $post_id, $context) {
    $url = "http://somethingerother.com/custom_post_editor.php?post=".$post_id; // Modify the URL as desired

    return $url;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T23:25:10.410

我的 wordpress 开发技能有点生疏，但你可能应该使用 wordpress[挂钩](http://codex.wordpress.org/Plugin_API)来挂钩[`edit_post`](http://adambrown.info/p/wp_hooks/hook/edit_post) ，并编写你的插件来重写返回值或`do_action`只是去你自己的自定义编辑页面

# c# - 使用字段或属性作为 xmlnode 值

> ID：14678438
> 
> 赞同：0
> 
> 时间：2013-02-03T23:07:16.930
> 
> 标签：c#, xml, xml-serialization

我正在尝试制作角度课程。当我将此类序列化为 xml 时，我想关注：

```
<Angle Unit="Degree">90</Angle>

or

<Angle Unit="Radian">3.14......</Angle> 
```

目前，当我序列化我的课程时，我得到以下信息：

```
<Angle Unit="Degree">
  <Degree>90</Degree>
</Angle>

or

<Angle Unit="Radian">
  <Radian>90</Radian>
</Angle> 
```

我知道带有 [XmlText] 的字符串是可能的，但是有没有一种方法可以使用双精度值或其他值而无需自定义 xmlwrite 和 xmlread？

下面显示了我的类代码的一部分：

```
[Serializable]
public struct Angle
{
    [XmlAttribute]
    public UnitType Unit;

    public double Radian
    {
        get;
        set;
    }
    public bool ShouldSerializeRadian();

    public double Degree
    {
        get;
        set;
    }
    public bool ShouldSerializeDegree();
} 
```

使用 Unit 和 shouldSerialize 我选择要使用的值。

当我设置度数 = 90 时，弧度的值为 1.5707 ...

`UnitType`是具有度数和弧度的枚举。is `unit = unittype.degree`degree 将在序列化时使用，而`unit = unittype.radian`radiin 将在序列化时使用。

我用来选择我使用的表示的代码如下：

```
public bool ShouldSerializeRadian() 
{ 
   return (Unit == UnitType.Radian); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:40:33.987

不确定这是否是最佳解决方案，但您可以创建一个代理属性来处理序列化/反序列化。

就像是

```
[Serializable]
public class Angle 
{
    [XmlAttribute]
    public UnitType Unit;

    [XmlTextAttribute]
    public double Value
    {
        get { return Unit == UnitType.Degree ? Degree : Radian; }
        set
        {
            if (Unit == UnitType.Degree)
            {
                Degree = value;
                return;
            }
            Radian = value;
        }
    }

    [XmlIgnore]
    public double Radian { get; set; }

    [XmlIgnore]
    public double Degree { get; set; }
} 
```

结果：

```
 <Angle Unit="Radian">70.8</Angle> 
  <Angle Unit="Degree">45.2</Angle> 
```

# java - 在java中快速将字符串转换为xml

> ID：14678442
> 
> 赞同：0
> 
> 时间：2013-02-03T23:08:27.820
> 
> 标签：java, xml, performance

我有一个将 xml 字符串发送到输出流的应用程序。在将内容写入输出流之前，我必须确保文本节点中的内容（节点值中的内容）不超过固定长度。为此，我编写了一个示例代码来获取文本节点内容，这可以帮助我进行内容验证。但我担心这个示例代码是有效的，因为当我运行它时它需要大约 0.2 秒 eclipse profiler(TPTP)。我想知道是否有更好的方法来提高性能。下面是示例代码。

```
 StringWriter stringWriter = new StringWriter();
     stringWriter.write("<node src='something'>nodetext goes here</node>");
     InputSource src = new InputSource(new StringReader(stringWriter.toString()));
     try {
        Element doc = DocumentBuilderFactory.newInstance().newDocumentBuilder().parse(src).getDocumentElement();
        System.out.println(doc.getChildNodes().getLength());
        Node n = doc.getChildNodes().item(0);
        System.out.println(n.getNodeValue());
    } catch (Exception e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T09:01:20.173

You will get a vast performance improvement by reusing the DocumentBuilderFactory - creating the factory involves searching the classpath. Reusing the DocumentBuilder will probably help as well. However, the overall approach of creating XML as a string, parsing it, and then serailizing it again seems intrinsically inefficient and I haven't really understood your explanation of why it's necessary.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T01:30:45.623

使用 SAX 解析器而不是 DOM。有关示例，请参见[本文。](http://www.mkyong.com/java/how-to-read-xml-file-in-java-sax-parser/)

# php - 是否有相当于 PHP 的 mail() 函数的 nodejs

> ID：14678447
> 
> 赞同：9
> 
> 时间：2013-02-03T23:09:01.180
> 
> 标签：php, node.js, email

我来自 PHP 世界，我习惯于偶尔使用 mail() 发送快速诊断电子邮件。NodeJS 的标准库中是否有与此大致等价的模块或方法？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2017-08-27T18:27:56.373

当然：

```
const nodemailer = require('nodemailer');
const transporter = nodemailer.createTransport({sendmail: true}, {
  from: 'no-reply@your-domain.com',
  to: 'your@mail.com',
  subject: 'test',
});
transporter.sendMail({text: 'hello'}); 
```

另请参阅[在 docker 容器中配置 sendmail](https://stackoverflow.com/questions/26215021/configure-sendmail-inside-a-docker-container/45907529#45907529)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-03T23:10:59.963

Nodemailer 是一种流行、稳定且灵活的解决方案：

*   [http://www.nodemailer.com/](http://www.nodemailer.com/)
*   [https://github.com/andris9/Nodemailer](https://github.com/andris9/Nodemailer)

完全使用看起来像这样（顶部只是设置 - 所以每个应用程序只需执行一次）：

```
var nodemailer = require("nodemailer");

// create reusable transport method (opens pool of SMTP connections)
var smtpTransport = nodemailer.createTransport("SMTP",{
    service: "Gmail",
    auth: {
        user: "gmail.user@gmail.com",
        pass: "userpass"
    }
});

// setup e-mail data with unicode symbols
var mailOptions = {
    from: "Fred Foo ✔ <foo@blurdybloop.com>", // sender address
    to: "bar@blurdybloop.com, baz@blurdybloop.com", // list of receivers
    subject: "Hello ✔", // Subject line
    text: "Hello world ✔", // plaintext body
    html: "<b>Hello world ✔&lt;/b>" // html body
}

// send mail with defined transport object
smtpTransport.sendMail(mailOptions, function(error, response){
    if(error){
        console.log(error);
    }else{
        console.log("Message sent: " + response.message);
    }

    // if you don't want to use this transport object anymore, uncomment following line
    //smtpTransport.close(); // shut down the connection pool, no more messages
}); 
```

# javascript - 在 contenteditable 中精确拖放

> ID：14678451
> 
> 赞同：62
> 
> 时间：2013-02-03T23:09:38.090
> 
> 标签：javascript, html, css, drag-and-drop, draggable

### 设置

所以，我有一个内容可编辑的 div —— 我正在制作一个所见即所得的编辑器：粗体、斜体、格式等，以及最近的：插入精美的图像（在精美的框中，带有标题）。

```
<a class="fancy" href="i.jpg" target="_blank">
    <img alt="" src="i.jpg" />
    Optional Caption goes Here!
</a> 
```

用户通过我向他们展示的对话框添加这些精美的图像：他们填写详细信息，上传图像，然后就像其他编辑器功能一样，我用来`document.execCommand('insertHTML',false,fancy_image_html);`在用户选择时将其放入。

### 所需的功能

所以，现在我的用户可以在一个精美的图像中扑通一声——他们需要能够移动它。用户需要能够单击并拖动图像（花哨的框和所有）以将其放置在 contenteditable 中他们喜欢的任何位置。他们需要能够在段落之间移动它，甚至在段落内——如果他们愿意的话，可以在两个词之间移动。

### 是什么给了我希望

请记住——在内容可编辑中，普通的旧**`<img>`**标签已经被用户代理所祝福，具有这种可爱的拖放功能。默认情况下，您可以随意拖放**`<img>`**标签；默认的拖放操作的行为就像人们梦寐以求的那样。

因此，考虑到这种默认行为如何在我们的`<img>`伙伴中如此出色地发挥作用——我只想稍微扩展这种行为以包含更多的 HTML——这似乎应该很容易实现。

## 我迄今为止的努力

首先，我使用 draggable 属性设置了我的花哨`<a>`标签，并禁用了 contenteditable （不确定这是否有必要，但它似乎也可以关闭）：

```
<a class="fancy" [...] draggable="true" contenteditable="false"> 
```

然后，因为用户仍然可以将图像拖出花哨的`<a>`盒子，我不得不做一些 CSS。我在 Chrome 中工作，所以我只向您展示 -webkit- 前缀，尽管我也使用了其他前缀。

```
.fancy {
    -webkit-user-select:none;
    -webkit-user-drag:element; }
    .fancy>img {
        -webkit-user-drag:none; } 
```

现在用户可以拖动整个花哨的盒子，部分褪色的点击拖动表示图像反映了这一点——我可以看到我现在正在拿起整个盒子:)

我尝试了几种不同 CSS 属性的组合，上面的组合对我来说似乎很有意义，而且效果最好。

我希望仅此 CSS 就足以让浏览器将整个元素用作可拖动项目，自动授予用户我梦寐以求的功能......*然而，它似乎比这更复杂。*

### HTML5 的 JavaScript 拖放 API

这种拖放的东西*似乎*比它需要的更复杂。

所以，我开始深入研究 DnD api 文档，现在我陷入了困境。所以，这就是我所设计的（是的，jQuery）：

```
$('.fancy')
    .bind('dragstart',function(event){
        //console.log('dragstart');
        var dt=event.originalEvent.dataTransfer;
        dt.effectAllowed = 'all';
        dt.setData('text/html',event.target.outerHTML);
    });

$('.myContentEditable')
    .bind('dragenter',function(event){
        //console.log('dragenter');
        event.preventDefault();
    })
    .bind('dragleave',function(event){
        //console.log('dragleave');
    })
    .bind('dragover',function(event){
        //console.log('dragover');
        event.preventDefault();
    })
    .bind('drop',function(event){
        //console.log('drop');      
        var dt = event.originalEvent.dataTransfer;
        var content = dt.getData('text/html');
        document.execCommand('insertHTML',false,content);
        event.preventDefault();
    })
    .bind('dragend',function(event){ 
        //console.log('dragend');
    }); 
```

**所以这就是我卡住的地方：**这几乎完全有效。*几乎完全。*我有一切工作，直到最后。在放置事件中，我现在可以访问我试图在放置位置插入的精美盒子的 HTML 内容。我现在需要做的就是将它插入正确的位置！

问题是**我找不到正确的放置位置，或任何插入它的方法。**我一直希望找到某种*“dropLocation”*对象来将我的花哨的盒子倾倒到**`dropEvent.dropLocation.content=myFancyBoxHTML;`**其中，或者至少是某种放置位置值，以便找到我自己的方式将内容放在那里？ *我得到了什么吗？*

*我做错了吗？我完全错过了什么吗？*

我尝试**`document.execCommand('insertHTML',false,content);`**像我预期的那样使用，但不幸的是，我在这里失败了，因为选择插入符号没有像我希望的那样位于精确的放置位置。

我发现如果我注释掉所有的**`event.preventDefault();`**，选择插入符号变得可见，并且正如人们希望的那样，当用户准备放下时，将他们的拖动悬停在 contenteditable 上，可以看到小选择插入符号在字符之间运行跟随用户的光标和放置操作——向用户指示选择插入符号代表精确的放置位置。**我需要这个选择插入符号的位置。**

通过一些实验，我在 drop 事件和 dragend 事件期间尝试了 execCommand-insertHTML'ing - 既不将 HTML 插入到 drop-selection-caret 所在的位置，而是使用在拖动操作之前选择的任何位置。

*因为选择插入符号在拖动期间可见，所以我制定了一个计划。*

有一段时间，我试图在 dragover 事件中插入一个临时标记，例如`<span class="selection-marker">|</span>`，就在 之后`$('.selection-marker').remove();`，试图让浏览器不断（在 dragover 期间）删除所有选择标记，然后在插入点添加一个 -基本上在任何时候在插入点所在的地方留下一个标记。当然，计划是用我拥有的拖动内容替换这个临时标记。

当然，这些都不起作用：我无法按计划将选择标记插入到明显可见的选择插入符号处——再次，在拖动操作之前，execCommand-insertedHTML 将自身放置在选择插入符号所在的任何位置。

## 呵呵。那么我错过了什么？它是如何完成的？

**如何获取或插入拖放操作的精确位置？** *我觉得这显然是拖放操作中的常见操作——我肯定忽略了某种重要而明显的细节吗？*我什至必须深入研究 JavaScript，或者也许有一种方法可以仅使用可拖动、可放置、可内容编辑和一些花哨的 CSS3 等属性来做到这一点？

我仍在寻找——仍在修补——我会在发现我一直失败的地方后立即回复:)

* * *

## 狩猎继续（原帖后编辑）

* * *

Farrukh 提出了一个很好的建议——使用：

```
console.log( window.getSelection().getRangeAt(0) ); 
```

查看选择插入符号的实际位置。我把它放到了**dragover**事件中，当我发现选择插入符号在contenteditable中我的可编辑内容之间明显跳跃时。

**唉，返回的 Range 对象在拖放操作之前报告属于选择插入符号的偏移索引。**

这是一次英勇的努力。谢谢法鲁克。

**那么这里发生了什么？**我感觉到我看到的小选择插入符号根本不是选择插入符号！我觉得是骗子！

### 经进一步检查！

原来，这是一个冒名顶替者！在整个拖动操作期间，真正的选择插入符号保持不变**！**你可以看到小虫子！

我正在阅读[MDN Drag and Drop Docs](https://developer.mozilla.org/en-US/docs/DragDrop/Drag_and_Drop)，发现了这个：

> 当然，您可能还需要在拖动事件周围移动插入标记。**您可以将事件的 clientX 和 clientY 属性与其他鼠标事件一起使用来确定鼠标指针的位置。**

哎呀，这是否意味着我应该根据**clientX**和**clientY**自己弄清楚？自己使用鼠标坐标确定选择插入符号的位置？可怕的！！

明天我会考虑这样做——除非我自己，或者这里的其他人读到这个，可以找到一个理智的解决方案:)

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-02-05T04:54:49.550

## 龙滴

我做了很多荒谬的摆弄。所以，这么多 jsFiddleing。

**这不是一个健壮或完整的解决方案；我可能永远也想不出一个。如果有人有更好的解决方案，我会全力以赴——我不想这样做，但这是迄今为止我能够发现的唯一方法。以下 jsFiddle 以及我即将吐出的信息，在我的特定 WAMP 设置和计算机上使用特定版本的 Firefox 和 Chrome 对我有用。** *当它在您的网站上不起作用时，不要来找我哭。这种拖放式的废话显然是**每个人都为自己着想。***

***[jsFiddle：追逐 Moskal 的 Dragon Drop](http://jsfiddle.net/ChaseMoskal/T2zHQ/)***

所以，我把我女朋友的脑子弄得无聊了，她以为我一直在说“dragon drop”，而实际上，我只是在说“drag-and-drop”。它卡住了，所以这就是我为处理这些拖放情况而创建的 JavaScript 小伙伴。

**事实证明——这有点像一场噩梦。HTML5 Drag-and-Drop API 即使乍看之下也是可怕的。***然后，当你开始理解并接受它应该*工作的方式时，你几乎对它热身了。然后你意识到它实际上是一场多么可怕的噩梦，因为你了解了 Firefox 和 Chrome 如何在他们自己的特殊规范中执行这个规范方式，并且似乎完全忽略了您的所有需求。你会发现自己在问这样的问题：“等等，什么元素现在正在被拖动？如何获取该信息？如何取消此拖动操作？如何停止此特定浏览器对这种情况的独特默认处理？” ...你的问题的答案：“你是靠自己的，失败者！继续破解，直到有效果！”。

因此，这就是我如何**在多个 contenteditable 内部、周围和之间实现任意 HTML 元素的精确拖放。** *（注意：我不会完全深入每个细节，你必须查看 jsFiddle ——我只是在漫无边际地谈论我从经验中记得的看似相关的细节，因为我的时间有限)*

## 我的解决方案

*   首先，我将 CSS 应用于可拖动对象（fancybox）——我们需要`user-select:none; user-drag:element;`在花式框上，然后特别`user-drag:none;`是在花式框内的图像上（以及任何其他元素，为什么不呢？）。不幸的是，这对于 Firefox 来说还不够，它需要`draggable="false"`在图像上显式设置属性以防止它被拖动。
*   接下来，我将属性应用`draggable="true"`到`dropzone="copy"`contenteditables 上。

**对于可拖动对象（花式框），我为`dragstart`.** 我们将 dataTransfer 设置为复制 HTML ' ' 的空白字符串——因为我们需要欺骗它认为我们要拖动 HTML，但我们取消了任何默认行为。有时默认行为会以某种方式滑入，并导致重复（就像我们自己进行插入一样），所以现在最糟糕的故障是在拖动失败时插入“”（空格）。我们不能依赖默认行为，因为它经常失败，所以我发现这是最通用的解决方案。

```
DD.$draggables.off('dragstart').on('dragstart',function(event){
    var e=event.originalEvent;
    $(e.target).removeAttr('dragged');
    var dt=e.dataTransfer,
        content=e.target.outerHTML;
    var is_draggable = DD.$draggables.is(e.target);
    if (is_draggable) {
        dt.effectAllowed = 'copy';
        dt.setData('text/plain',' ');
        DD.dropLoad=content;
        $(e.target).attr('dragged','dragged');
    }
}); 
```

**对于 dropzones，我为`dragleave`and绑定了一个处理程序`drop`。**dragleave 处理程序仅适用于 Firefox，因为在 Firefox 中，当您尝试将其拖动到 contenteditable 之外时，拖放将起作用（Chrome 默认拒绝您），因此它会针对 Firefox-only 执行快速检查`relatedTarget`。**呵呵。**

**Chrome 和 Firefox 获取 Range 对象的方式不同，**因此必须努力为每个浏览器在 drop 事件中做不同的事情。Chrome 基于**鼠标坐标构建范围** *（是的，没错）*，但 Firefox 在事件数据中提供了它。`document.execCommand('insertHTML',false,blah)`原来是我们如何处理下降。哦，我忘了提——我们不能`dataTransfer.getData()`在 Chrome 上使用来获取我们的 dragstart 设置 HTML——这似乎是规范中的某种奇怪的错误。Firefox 将规范称为废话，并给我们提供了数据——但 Chrome 没有，所以我们向后弯腰，将内容设置为全局，并通过地狱杀死所有默认行为......

```
DD.$dropzones.off('dragleave').on('dragleave',function(event){
    var e=event.originalEvent;

    var dt=e.dataTransfer;
    var relatedTarget_is_dropzone = DD.$dropzones.is(e.relatedTarget);
    var relatedTarget_within_dropzone = DD.$dropzones.has(e.relatedTarget).length>0;
    var acceptable = relatedTarget_is_dropzone||relatedTarget_within_dropzone;
    if (!acceptable) {
        dt.dropEffect='none';
        dt.effectAllowed='null';
    }
});
DD.$dropzones.off('drop').on('drop',function(event){
    var e=event.originalEvent;

    if (!DD.dropLoad) return false;
    var range=null;
    if (document.caretRangeFromPoint) { // Chrome
        range=document.caretRangeFromPoint(e.clientX,e.clientY);
    }
    else if (e.rangeParent) { // Firefox
        range=document.createRange(); range.setStart(e.rangeParent,e.rangeOffset);
    }
    var sel = window.getSelection();
    sel.removeAllRanges(); sel.addRange(range);

    $(sel.anchorNode).closest(DD.$dropzones.selector).get(0).focus(); // essential
    document.execCommand('insertHTML',false,'<param name="dragonDropMarker" />'+DD.dropLoad);
    sel.removeAllRanges();

    // verification with dragonDropMarker
    var $DDM=$('param[name="dragonDropMarker"]');
    var insertSuccess = $DDM.length>0;
    if (insertSuccess) {
        $(DD.$draggables.selector).filter('[dragged]').remove();
        $DDM.remove();
    }

    DD.dropLoad=null;
    DD.bindDraggables();
    e.preventDefault();
}); 
```

**好吧，我厌倦了这个。我已经写了我想写的所有内容。我正在收工，如果我想到任何重要的事情，可能会更新此内容。**

谢谢大家。//追赶。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-12T00:05:02.403

因为我想在原生 JS 解决方案中看到这一点，所以我做了一些工作以删除所有 jQuery 依赖项。希望它可以帮助某人。

首先是标记

```
 <div class="native_receiver" style="border: 2px solid red;padding: 5px;" contenteditable="true" >
      WAITING  FOR STUFF
    </div>
    <div class="drawer" style="border: 2px solid #AAE46A; padding: 10px">
      <span class="native_drag" data-type="dateselector" contenteditable="false" draggable="true" style="border: 2px solid rgba(0,0,0,0.2);padding:4px; margin:2px">
        Block 1
      </span>
      <span class="native_drag" data-type="dateselector" contenteditable="false" draggable="true" style="border: 2px solid rgba(0,0,0,0.2);padding:4px; margin:2px">
        Second Blk
      </span>
    </div> 
```

然后是一些帮手

```
 function addClass( elem, className ){
        var classNames = elem.className.split( " " )
        if( classNames.indexOf( className ) === -1 ){
            classNames.push( className )
        }
        elem.className = classNames.join( " " )
    }
    function selectElem( selector ){
        return document.querySelector( selector )
    }
    function selectAllElems( selector ){
        return document.querySelectorAll( selector )
    }
    function removeElem( elem ){
         return elem ? elem.parentNode.removeChild( elem ) : false
    } 
```

然后是实际方法

```
 function nativeBindDraggable( elems = false ){
        elems = elems || selectAllElems( '.native_drag' );
        if( !elems ){
            // No element exists, abort
            return false;
        }else if( elems.outerHTML ){
            // if only a single element, put in array
            elems = [ elems ];
        }
        // else it is html-collection already (as good as array)

        for( let i = 0 ; i < elems.length ; i++ ){
            // For every elem in list, attach or re-attach event handling
            elems[i].dataset.transferreference = `transit_${ new Date().getTime() }`;
            elems[i].ondragstart = function(e){
                if (!e.target.id){
                    e.target.id = (new Date()).getTime();
                }

                window.inTransferMarkup = e.target.outerHTML;
                window.transferreference = elems[i].dataset.transferreference;
                addClass( e.target, 'dragged');
            };
        };
    }

    function nativeBindWriteRegion( elems = false ){
        elems = elems || selectAllElems( '.native_receiver' );
        if( !elems ){
            // No element exists, abort
            return false;
        }else if( elems.outerHTML ){
            // if only a single element, put in array
            elems = [ elems ];
        }
        // else it is html-collection

        for( let i = 0 ; i < elems.length ; i++ ){
            elems[i].ondragover = function(e){
                e.preventDefault();
                return false;
            };
            elems[i].ondrop = function(e){
                receiveBlock(e);
            };
        }
    }

    function receiveBlock(e){
        e.preventDefault();
        let content = window.inTransferMarkup;

        window.inTransferMarkup = "";

        let range = null;
        if (document.caretRangeFromPoint) { // Chrome
            range = document.caretRangeFromPoint(e.clientX, e.clientY);
        }else if (e.rangeParent) { // Firefox
            range = document.createRange();
            range.setStart(e.rangeParent, e.rangeOffset);
        }
        let sel = window.getSelection();
        sel.removeAllRanges(); 
        sel.addRange( range );
        e.target.focus();

        document.execCommand('insertHTML',false, content);
        sel.removeAllRanges();

        // reset draggable on all blocks, esp the recently created
        nativeBindDraggable(
          document.querySelector(
            `[data-transferreference='${window.transferreference}']`
          )
        );
        removeElem( selectElem( '.dragged' ) );
        return false;
    } 
```

最后实例化

```
nativeBindDraggable();
nativeBindWriteRegion(); 
```

以下是功能片段

```
function addClass( elem, className ){
            var classNames = elem.className.split( " " )
            if( classNames.indexOf( className ) === -1 ){
                classNames.push( className )
            }
            elem.className = classNames.join( " " )
        }
        function selectElem( selector ){
            return document.querySelector( selector )
        }
        function selectAllElems( selector ){
            return document.querySelectorAll( selector )
        }
        function removeElem( elem ){
             return elem ? elem.parentNode.removeChild( elem ) : false
        }

    	function nativeBindDraggable( elems = false ){
    		elems = elems || selectAllElems( '.native_drag' );
    		if( !elems ){
    			// No element exists, abort
    			return false;
    		}else if( elems.outerHTML ){
    			// if only a single element, put in array
    			elems = [ elems ];
    		}
    		// else it is html-collection already (as good as array)

    		for( let i = 0 ; i < elems.length ; i++ ){
    			// For every elem in list, attach or re-attach event handling
    			elems[i].dataset.transferreference = `transit_${ new Date().getTime() }`;
    			elems[i].ondragstart = function(e){
    				if (!e.target.id){
    					e.target.id = (new Date()).getTime();
    				}

    				window.inTransferMarkup = e.target.outerHTML;
    				window.transferreference = elems[i].dataset.transferreference;
    				addClass( e.target, 'dragged');
    			};
    		};
    	}

    	function nativeBindWriteRegion( elems = false ){
    		elems = elems || selectAllElems( '.native_receiver' );
    		if( !elems ){
    			// No element exists, abort
    			return false;
    		}else if( elems.outerHTML ){
    			// if only a single element, put in array
    			elems = [ elems ];
    		}
    		// else it is html-collection

    		for( let i = 0 ; i < elems.length ; i++ ){
    			elems[i].ondragover = function(e){
    				e.preventDefault();
    				return false;
    			};
    			elems[i].ondrop = function(e){
    				receiveBlock(e);
    			};
    		}
    	}

        function receiveBlock(e){
    		e.preventDefault();
    		let content = window.inTransferMarkup;

    		window.inTransferMarkup = "";

    		let range = null;
    		if (document.caretRangeFromPoint) { // Chrome
    			range = document.caretRangeFromPoint(e.clientX, e.clientY);
    		}else if (e.rangeParent) { // Firefox
    			range = document.createRange();
    			range.setStart(e.rangeParent, e.rangeOffset);
    		}
    		let sel = window.getSelection();
    		sel.removeAllRanges(); 
    		sel.addRange( range );
    		e.target.focus();

    		document.execCommand('insertHTML',false, content);
    		sel.removeAllRanges();

            // reset draggable on all blocks, esp the recently created
    		nativeBindDraggable(
              document.querySelector(
                `[data-transferreference='${window.transferreference}']`
              )
            );
    		removeElem( selectElem( '.dragged' ) );
    		return false;
    	}

    nativeBindDraggable();
    nativeBindWriteRegion();
```

```
 <div class="native_receiver" style="border: 2px solid red;padding: 5px;" contenteditable="true" >
          WAITING  FOR STUFF
        </div>
        <div class="drawer" style="border: 2px solid #AAE46A; padding: 10px">
          <span class="native_drag" data-type="dateselector" contenteditable="false" draggable="true" style="border: 2px solid rgba(0,0,0,0.2);padding:4px; margin:2px">
            Block 1
          </span>
          <span class="native_drag" data-type="dateselector" contenteditable="false" draggable="true" style="border: 2px solid rgba(0,0,0,0.2);padding:4px; margin:2px">
            Second Blk
          </span>
        </div>
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-10T09:28:57.460

1.  事件拖动开始；`dataTransfer.setData("text/html", "<div class='whatever'></div>");`
2.  事件掉落： `var me = this; setTimeout(function () { var el = me.element.getElementsByClassName("whatever")[0]; if (el) { //do stuff here, el is your location for the fancy img } }, 0);`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-10-24T01:40:45.837

总结上面的答案，关键是`event.parentNode`和`event.rangeOffset`（firefox）和`caretRangeFromPoint(event.clientX, event.clientY)`（chrome）。这是一个最小的例子：

```
span {
    border: 1px solid red;
}

span:before {
   content: "grab ";
   background-color: #0f0;
}
```

```
<p contenteditable="true"
    ondrop="sel = window.getSelection();
        if (document.caretRangeFromPoint)
            range = document.caretRangeFromPoint(event.clientX, event.clientY)
        else {
            sel.collapse(event.rangeParent,event.rangeOffset)
            range = sel.getRangeAt(0)
        }
        range.insertNode(sp1)"
    ondragover="
        return false"
>This is a contenteditable paragraph. Grab the green field in the following span 
 <span draggable="True" id="sp1" ondragstart=" 
    event.dataTransfer.setData('text/plain', this.innerText)">span</span>
 and drag it inside this paragraph.
</p>
```

# php - 尝试创建数据库和表并插入一些数据

> ID：14678452
> 
> 赞同：0
> 
> 时间：2013-02-03T23:09:39.010
> 
> 标签：php

这就是我到目前为止所拥有的......我不明白为什么它不起作用？有任何想法吗？这只是一个连接数据库、创建表和插入一些数据的简单脚本。我也想检索数据，但我想我可能有点过头了。

```
 <?php

    ini_set('display_errors',1);
    error_reporting(E_ALL);

    $link = mysql_connect('localhost', 'root', '');
    if (!$link) {
        die('Could not connect: ' . mysql_error());
    }
    echo 'Connected successfully';

    if (mysql_query("CREATE_DATABASE nogjhghkgst98", $link))
    {
        echo "Database created";
    }
    else
    {
        echo "Error creating database: " . mysql_error();
    }

    if ($link="CREATE TABLE contactsZ8 (id int(6) NOT NULL auto_increment,first varchar(15)         NOT         NULL,last varchar(15) NOT NULL,phone varchar(20) NOT NULL,mobile varchar(20) NOT     NULL,fax varchar(20) NOT NULL,email varchar(30) NOT NULL,web varchar(30) NOT NULL,PRIMARY KEY     (id),UNIQUE id (id),KEY id_2 (id))") {
        echo "ineserted";
    }
    else
    {
        echo "not inserted" . mysql_error();
    }

    $link = "INSERT INTO contactsZ VALUES ('','John','Smith','01234 567890','00112 334455','01234     567891','johnsmith@gowansnet.com','http://www.gowansnet.com')";

    $link="SELECT * FROM contactsZ";
    $link=mysql_query($link);

    mysql_close($link);

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:18:21.317

肯定有问题：

```
if ($link="CREATE TABLE contactsZ8 (id int(6) NOT NULL auto_increment,first varchar(15)         NOT         NULL,last varchar(15) NOT NULL,phone varchar(20) NOT NULL,mobile varchar(20) NOT     NULL,fax varchar(20) NOT NULL,email varchar(30) NOT NULL,web varchar(30) NOT NULL,PRIMARY KEY     (id),UNIQUE id (id),KEY id_2 (id))") { 
```

*   if 中的赋值
*   查询未执行（这还不错：一旦创建表，重新加载页面时再次执行查询将失败）
*   分配给`$link`！这令人困惑（但不应产生任何错误）...

然后 ：

```
$link = "INSERT INTO contactsZ VALUES ('','John','Smith','01234 567890','00112 334455','01234     567891','johnsmith@gowansnet.com','http://www.gowansnet.com')"; 
```

*   不执行查询。
*   编辑：在`INSERT`中完成`contactsZ`，而在`CREATE TABLE`创建`contactsZ8`.

编辑2：最后：

```
mysql_close($link); 
```

重新分配 3 次后`$link`，`$link`不再是（可选的，顺便说一句）链接标识符......

# c++ - 我可以在写入磁盘之前修改 ofstream 吗？

> ID：14678457
> 
> 赞同：0
> 
> 时间：2013-02-03T23:10:05.030
> 
> 标签：c++, visual-c++, stl

```
std::ofstream ofs;
ofs << "Hello, world!" << endl; 
```

现在我想在写入磁盘之前修改`ofs`to的内容？`"Hello, money!"`我该如何实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:21:24.247

`std::endl`IO 操纵器将刷新流缓冲区的内容，因此如果您稍后想要在其内容被刷新之前处理流，则必须将其更改为a `'\n'`。

此外，假设您真正想要这样做的原因是因为您需要操作格式化后要写入的字符串，我会让您意识到您可以使用 an`std::ostringstream`来利用格式化的功能流式传输并将结果收集到一个字符串中，然后您可以对其进行操作并正常写入文件。

如果这对您来说是显而易见的信息并且您的用例更复杂，那么您将不得不编写自己的流缓冲区，正如@MatsPetersson 所指出的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:13:00.437

编辑：您应该创建一个派生自的类`filebuf`(出于本讨论的目的，`myfilebuf`并使用它来构造一个`ostream`，这比上述更准确。

在`myfilebuf`你实现`sputbackc`中，并有一个状态机来识别“Hello，World！”，并将其替换为“Hello，Money！”，这可能意味着缓冲第二层，直到你知道它是哪一层。

# cocoa - 键入时，重音在 NSTextView 中保持分离

> ID：14678464
> 
> 赞同：5
> 
> 时间：2013-02-03T23:10:51.773
> 
> 标签：cocoa, diacritics, nstextview

我在我的 Cocoa 应用程序中使用 NSTextView。我按下 Option-E，文本视图在黄色高亮框中显示一个重音符号，表示它是标记文本，而不是最终输入。当我键入下一个字符时，文本视图必须将其显示为单个重音字符，但事实并非如此。例如![在此处输入图像描述](../Images/92797e5769fec399295863a3a66bb05f.png) 为什么？

更新：这是我的步骤： ![在此处输入图像描述](../Images/068f1cf4300c40940b26757cad02f6cb.png)

# jquery - 带有数据库的 jQuery 可排序实现

> ID：14678469
> 
> 赞同：1
> 
> 时间：2013-02-03T23:11:39.073
> 
> 标签：jquery, database, serialization, jquery-ui-sortable

我一直在尝试使用排序列表项的新顺序来更新数据库。我试图按照本教程进行操作，但后来发现自己在本教程中迷失了方向，觉得自己超出了我的深度（没有帮助他提到以前编写的代码并且在他们的论坛上不再可用）。[http://www.youtube.com/watch?v=3mOs0VY_sIw](http://www.youtube.com/watch?v=3mOs0VY_sIw)

我希望对如下列表进行排序（可以添加或删除条目）[http://dev.michaelbole.com/cms/](http://dev.michaelbole.com/cms/)

以下显示了我的前端：

```
<ul id="sortable">
<?php
    $sortget = mysql_query("SELECT data FROM sortable", $connection);

    $sortget = explode(',', $sortget[0]['data']);
    print_r($sortget);

    $result = mysql_query("SELECT *FROM bookwrite", $connection);
    if (!$result){
        die("Database query failed: " . mysql_error());
        }

    while ($row = mysql_fetch_array($result)) {
        echo "<li id='item_".$row["id"]."'>"."<h1>".$row["post_title"]."</h1>"."<p>".$row["post_details"]."</p>"."</li>";   
    }   

?>

</ul> 
```

JS：

```
 $(function() {
        $( "#sortable" ).sortable({
            containment: 'parent',
            tolerance: 'pointer',
            cursor: 'pointer',
            revert: 'true',
            opacity:'0.60',
            update: function(event, ui) {
                var postData = $(this).sortable('serialize');
                console.log(postData);  

                $.post('save.php', {list: postData}, function(o) {
                    console.log(o);
                }, 'json');
            }

    });
    $( "#sortable" ).disableSelection();
}); 
```

并保存：

```
<?php

$list = $_POST['list'];

$output = array();
$list = parse_str($list, $output);
print_r($output);
$save = implode(',',$output['item']);
require_once("includes/connection.php");

echo $list;
mysql_query("UPDATE sortable SET 'data' = '$save'", $connection);

?> 
```

# python - 保存时计算字段值？

> ID：14678472
> 
> 赞同：1
> 
> 时间：2013-02-03T23:12:06.027
> 
> 标签：python, sqlalchemy, flask, flask-sqlalchemy

```
class Quote(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    content = db.Column(db.Text)    
    votes = db.Column(db.Integer)
    author_id = db.Column(db.Integer, db.ForeignKey('author.id'))    
    date_added = db.Column(db.DateTime,default=datetime.datetime.now())    
    last_letter = db.Column(db.String(1)) 
```

我有一个看起来像上面的模型。我想`last_letter`成为无论`content`是什么的最后一个字母。我应该把这个逻辑放在哪里，以便每次保存模型时都会发生？我正在阅读有关混合属性和其他内容的信息，但我不确定哪种方式是正确的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:46:27.933

1.朴素的方式：您可以使用sqlalchemy列`default`值设置如下：

```
last_letter = db.Column(db.char, default=content[len(content)-1:]) 
```

没有检查这是否真的有效，猜不到。

2.您还可以执行以下操作，例如将此**初始化**添加到类中：

```
def __init__(self,id,content,votes,auther_id,date_added):
    self.id = id
    self.content = content
    #yadda yadda etc
    self.last_letter = content[len(content)-1:] #or something similiar 
```

3.  或者您可以使用“听”到“插入前”事件并按照[此处](https://stackoverflow.com/questions/10599376/object-based-default-value-in-sqlalchemy-declarative)的说明动态添加它。

4.  您可以在没有 sqlalchemy 的情况下使用带有 sql 触发器（在数据库中）的 sql 计算列。

5.  您可能可以使用 sqlalchemy mapper sql 表达式作为混合属性，我自己也没有尝试过，看起来[很简单](http://docs.sqlalchemy.org/en/rel_0_8/orm/mapper_config.html#mapper-sql-expressions)，可能是最优雅的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:53:14.423

`last_letter`可以装饰`@property`和定义

```
@property
def last_letter(self):
    return self.content[-1] 
```

*免责声明：我刚刚学会了如何使用装饰器并且在任何地方都在使用它们*

# php - 使用 Response::download() 从 AWS S3 下载文件

> ID：14678479
> 
> 赞同：1
> 
> 时间：2013-02-03T23:13:09.540
> 
> 标签：php, amazon-web-services, laravel

```
public function get_download($record_id)
{
    $record = Record::find($record_id);
    $file_name = $record->with_value('File Upload')->name;

    // something like https://s3.amazonaws.com/webapp/uploads/laravelsauce.png
    $file_url = read_file($record->with_value('File Upload')->value);

    return Response::download($file_url, $file_name);

    /*
    // works but why not the above
    header('Content-Type: application/octet-stream');
    header("Content-Transfer-Encoding: Binary");
    header("Content-disposition: attachment; filename='{$file_name}'");
    readfile($file_url);
    exit;
    */
} 
```

给我：

未处理的异常

信息：

[filesize() [function.filesize]: https://s3.amazonaws.com/webapp/uploads/laravelsasuce.png](https://s3.amazonaws.com/webapp/uploads/laravelsasuce.png)的统计失败

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:13:09.540

解决方案：/laravel/response.php

您不能在 aws 文件上使用 File::size，因为 File::size() === filesize() 并且该函数无论出于何种原因都无法绘制 S3 文件。

![在此处输入图像描述](../Images/4838efa81f7b3a57b29249d99d4b0aac.png)

# database - Prestashop：升级后是否保留数据库文件中的附加字段？

> ID：14678489
> 
> 赞同：0
> 
> 时间：2013-02-03T23:14:55.937
> 
> 标签：database, field, prestashop

我不确定 Prestashop 升级后是否保留了数据库文件中的其他字段？

因此，如果保留，我不需要使用带有自己字段的扩展文件，我可以使用覆盖的程序（类、模块等）更新这些字段......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:05:29.977

如果您修改核心类以添加与数据库匹配的其他字段，它们将仅在更新后保留在数据库中。更新后，您必须在类中重新指定这些。

您“应该”覆盖核心文件。这是一个典型的例子，这会`purchaseOrder`在订单中添加一个字段。这将被命名为 /overrides/classes/Order.php

```
<?php
/**
 *
 */
class Order extends OrderCore
{

    public $purchaseOrder;

    public function getFields()
    {
        $fields = parent::getFields();
        $fields['purchaseOrder'] = pSQL($this->purchaseOrder);

        return $fields;
    }

}

?> 
```

# php - 将 2 个表与左连接组合的问题

> ID：14678491
> 
> 赞同：0
> 
> 时间：2013-02-03T23:15:33.990
> 
> 标签：php, mysql

我会尽量解释这个问题。我有两个表“users1213”，这是一个玩家表和“Loanperiodes”。现在我正在尝试使用 sql-query 立即获得目前在俱乐部的球员列表。如果他们被租借到另一家具乐部，他们不必在名单上。俱乐部也有可能租借一名球员，所以这些球员也必须在名单上。所以我现在有这个（俱乐部有一个id“1”，球队也有一个id“1”）：

```
SELECT users1213.id, surname, name, team, club, loanclub
FROM users1213
LEFT JOIN loanperiode ON users1213.id = loanperiode.player
WHERE users1213.status =  'player'
AND (
(
users1213.club !=  '1'
AND loanperiode.loanclub =  '1'
AND loanperiode.begin <=  '2013-02-03'
AND loanperiode.end >=  '2013-02-03'
AND (
uitleenperiodes.team_id =  '1'
)
)
OR (
users1213.club =  '1'
AND users1213.team =  '1'
AND (
loanperiode.loanclub IS NULL 
OR (
loanperiode.loanclub IS NOT NULL 
AND (
loanperiode.begin <  '2013-02-03'
AND loanperiode.end <  '2013-02-03'
)
OR (
uitleenperiodes.begin >  '2013-02-03'
AND uitleenperiodes.end >  '2013-02-03'
)
)
)
)
)
GROUP BY users1213.id
ORDER BY name
LIMIT 0 , 30 
```

通过这个查询，我得到了一个很好的结果，但有 1 个问题，当有人获得 2 个贷款期时。例如，PLAYER1 现在被租借给 CLUB A，因此他可能不会被列出。但是当 PLAYER1 也有一个已经过期的租借期时，到 CLUB B，PLAYER1 会因为 LEFT JOIN 而被列出。有没有解决方案可以通过查询解决这个问题，或者我必须在运行阵列时进行检查？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:57:41.577

```
SELECT users1213.id, surname, name, team, club, loanclub
FROM users1213
LEFT JOIN loanperiode ON users1213.id = loanperiode.player
    AND '2013-02-03' BETWEEN loanperiode.begin AND loanperiode.end

WHERE
loanperiode.loanclub =  '1'
OR (loanperiode.loanclub IS NULL -- I suppose this happens only when there is no loan between those dates so nothing LEFT JOINed
AND users1213.club = '1')

ORDER BY name 
```

这个例子假设用户一次只能拥有一笔贷款（是的，他可以拥有更多在历史上结束的贷款，但只有一笔在今天之前开始并在未来结束）。

# mysql - 根据时间从多个表中获取最接近数据的最快方法

> ID：14678492
> 
> 赞同：4
> 
> 时间：2013-02-03T23:15:39.653
> 
> 标签：mysql, sql, time-series

我有三个表，设置如下：

```
TEMPERATURE_1
  time
  zone (FK)
  temperature
TEMPERATURE_2
  time
  zone (FK)
  temperature
TEMPERATURE_3
  time
  zone (FK)
  temperature 
```

每个表中的数据定期更新，但不一定同时更新（即时间条目不相同）。

我希望每次都能从每个表中访问最接近的读数，即：

```
TEMPERATURES
  time
  zone (FK)
  temperature_1
  temperature_2
  temperature_3 
```

换句话说，对于我的三个表中的每个唯一时间，我想要 TEMPERATURES 表中的一行，其中 temperature_n 值是与每个原始表在时间上最接近的温度读数。

目前，我已经使用两个视图进行了设置：

```
create view temptimes
as select time, zone 
  from temperature_1
union
  select time, zone
  from temperature_2
union
  select time, zone
  from temperature_3;

create view temperatures
as select tt.time,
          tt.zone,
          (select temperature 
           from temperature_1
           order by abs(timediff(time, tt.time))
           limit 1) as temperature_1,
          (select temperature 
           from temperature_2
           order by abs(timediff(time, tt.time))
           limit 1) as temperature_2,
          (select temperature 
           from temperature_3
           order by abs(timediff(time, tt.time))
           limit 1) as temperature_3,
from temptimes as tt
order by tt.time; 
```

这种方法有效，但在生产中使用太慢（对于每个温度约 1000 条记录的小型数据集需要几分钟以上）。

我对 SQL 不是很好，所以我确定我错过了正确的方法。我应该如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:55:10.453

这很慢的原因是它需要 3 次表扫描来计算和排序差异。

我假设您已经在时区列上有索引 - 目前它们不会因为表扫描问题而有所帮助。

有许多选项可以避免这种情况，具体取决于您的需求和数据收集率。

您已经说过数据是定期收集的，但不是同时收集的。这提出了一些选择。

1.  您需要临时数据的重要性级别 - 天、小时、分钟等。仅将时区信息存储到该重要性级别（或有另一列）并对此进行查询。
2.  如果您知道 3 个壁橱时间将在某个时间范围内（小时、天等），则放入 where 子句以将计算限制在可能的候选时间。您正在有效地构建直方图类型的存储桶 - 您将需要一个日历表来有效地执行此操作。
3.  进行单向比较，即仅将考虑限制在您要查找的时间之后的那些时间，因此，如果您要查找 12:00:00，则 13:45:32 是候选时间，但 11:59:59 不是。

我了解您要完成的工作-问问自己为什么以及更简单的解决方案是否可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T02:39:36.063

代价高昂的部分是相关子查询必须计算每个表的每一行的时间差，以便在主查询中*为**一行的一**列*找到`temperature_*`最接近的行。

 ***如果您可以根据*索引*仅选择当前时间之后的*一行和当前时间之前的**一行*，并且只计算这两个候选者的时间差，那么速度会大大加快。要使其快速运行，您只需要在表**中的列上建立索引**。***`time`***

 *我忽略了这个专栏`zone`，因为它在问题中的作用仍然不清楚，它只会给核心问题增加更多的噪音。应该很容易添加到查询中。

如果没有其他视图，此查询会立即执行所有操作：

```
SELECT time
      ,COALESCE(temp1
            ,CASE WHEN timediff(time, time1a) > timediff(time1b, time) THEN
                (SELECT t.temperature
                 FROM   temperature_1 t
                 WHERE  t.time = y.time1b)
             ELSE
                (SELECT t.temperature
                 FROM   temperature_1 t
                 WHERE  t.time = y.time1a)
             END) AS temp1

      ,COALESCE(temp2
            ,CASE WHEN timediff(time, time2a) > timediff(time2b, time) THEN
                (SELECT t.temperature
                 FROM   temperature_2 t
                 WHERE  t.time = y.time2b)
             ELSE
                (SELECT t.temperature
                 FROM   temperature_2 t
                 WHERE  t.time = y.time2a)
             END) AS temp2

      ,COALESCE(temp3
            ,CASE WHEN timediff(time, time3a) > timediff(time3b, time) THEN
                (SELECT t.temperature
                 FROM   temperature_3 t
                 WHERE  t.time = y.time3b)
             ELSE
                (SELECT t.temperature
                 FROM   temperature_3 t
                 WHERE  t.time = y.time3a)
             END) AS temp3
FROM  (
  SELECT time
        ,max(t1) AS temp1
        ,max(t2) AS temp2
        ,max(t3) AS temp3

        ,CASE WHEN max(t1) IS NULL THEN
           (SELECT t.time FROM temperature_1 t
            WHERE  t.time < x.time
            ORDER  BY t.time DESC LIMIT 1) ELSE NULL END AS time1a
        ,CASE WHEN max(t1) IS NULL THEN
           (SELECT t.time FROM temperature_1 t
            WHERE  t.time > x.time
            ORDER  BY t.time      LIMIT 1) ELSE NULL END AS time1b

        ,CASE WHEN max(t2) IS NULL THEN
           (SELECT t.time FROM temperature_2 t
            WHERE  t.time < x.time
            ORDER  BY t.time DESC LIMIT 1) ELSE NULL END AS time2a
        ,CASE WHEN max(t2) IS NULL THEN
           (SELECT t.time FROM temperature_2 t
            WHERE  t.time > x.time
            ORDER  BY t.time      LIMIT 1) ELSE NULL END AS time2b

        ,CASE WHEN max(t3) IS NULL THEN
           (SELECT t.time FROM temperature_3 t
            WHERE  t.time < x.time
            ORDER  BY t.time DESC LIMIT 1) ELSE NULL END AS time3a
        ,CASE WHEN max(t3) IS NULL THEN
           (SELECT t.time FROM temperature_3 t
            WHERE  t.time > x.time
            ORDER  BY t.time      LIMIT 1) ELSE NULL END AS time3b
  FROM  (
      SELECT time, temperature AS t1, NULL AS t2, NULL AS t3 FROM temperature_1
      UNION ALL
      SELECT time, NULL AS t1, temperature AS t2, NULL AS t3 FROM temperature_2
      UNION ALL
      SELECT time, NULL AS t1, NULL AS t2, temperature AS t3 FROM temperature_3
      ) AS x
  GROUP BY time
  ) y
ORDER BY time; 
```

[**-> sqlfiddle**](http://sqlfiddle.com/#!9/363f7/12)

### 解释

**suqquery x**替换您的视图`temptimes`并将温度带入结果。如果所有三个表都同步并且所有相同时间点的温度都相同，那么其余的甚至都不需要并且非常快。
对于三个表中的一个没有行的每个时间点，都按照指示获取温度：从每个表中获取“最接近”的一个。

**suqquery y**根据当前时间从每个缺少温度的表中聚合行`x`并获取上一次（`time1a`）和下一次（ ）。`time1b`这些查找应该使用索引快速。

最后**一个查询**从实际缺失的每个温度的最接近时间的行中获取温度。

如果 MySQL 允许从高于当前子查询的一个以上级别引用列，则此查询可能会更简单。咬它不能。在**PostgreSQL**中工作得很好：[->sqlfiddle](http://sqlfiddle.com/#!12/363f7/2)

如果可以从相关子查询返回多于一列，它也会更简单，但我不知道如何在 MySQL 中做到这一点。

*使用CTE*和*窗口函数*会*更*简单，但 MySQL 不知道这些现代 SQL 特性（与其他相关的 RDBMS 不同）。

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T03:17:53.333

我的建议是你不要采取最接近的时间，而是在给定时间或之前采取第一次。原因很简单：通常给定时间的数据是当时已知的。对于大多数目的而言，合并未来信息通常不是一个好主意。

通过此更改，您可以修改查询以利用`time`. 查询中的索引的问题是该函数排除了索引的使用。

因此，如果您想要最近的温度，请对每个变量使用它：

```
 (select temperature 
       from temperature_1 t2
       where t2.time <= tt.time
       order by t2.time desc
       limit 1
      ) as temperature_1, 
```

实际上，你也可以这样构造它：

```
 (select time 
       from temperature_1 t2
       where t2.time <= tt.time
       order by t2.time desc
       limit 1
      ) as time_1, 
```

然后将温度信息重新加入。这将是有效的，使用索引。

考虑到这一点，您实际上可以有两个变量`time_1_before`和`time_1_after`，分别表示在或之前的最佳时间和在或之后的最佳时间。您可以在选择中使用逻辑来选择最接近的值。使用索引返回温度的连接应该是有效的。

但是，我要重申，我认为最后一个温度或之前的温度可能是最好的选择。******

# perl - Perl - DynaLoader.pm - libbtparse.so - 缺少共享对象

> ID：14678496
> 
> 赞同：1
> 
> 时间：2013-02-03T23:16:05.020
> 
> 标签：perl, shared-libraries

`Text::BibTeX`嗨大师我在运行使用模块的 perl 脚本时遇到问题。当我运行脚本（脚本在 $PATH 中）时，我得到了这个：

```
[pista@HP-PC bibtex]$ bibmerge 
Can't load '/home/pista/perl5/lib/perl5/x86_64-linux-thread-multi/auto/Text/BibTeX/BibTeX.so' for module Text::BibTeX: libbtparse.so: cannot open shared object file: No such file or directory at /usr/lib64/perl5/DynaLoader.pm line 190.
 at /home/pista/bin/bibmerge line 4
Compilation failed in require at /home/pista/bin/bibmerge line 4.
BEGIN failed--compilation aborted at /home/pista/bin/bibmerge line 4.
Unknown Text::BibTeX function: "cleanup" at /home/pista/bin/bibmerge line 4
END failed--call queue aborted at /home/pista/bin/bibmerge line 4.
[pista@HP-PC bibtex]$ ldd /home/pista/perl5/lib/perl5/x86_64-linux-thread-multi/auto/Text/BibTeX/BibTeX.so
    linux-vdso.so.1 =>  (0x00007fff175ff000)
    libbtparse.so => not found
    libc.so.6 => /lib64/libc.so.6 (0x00007fbbb6267000)
    /lib64/ld-linux-x86-64.so.2 (0x000000310b800000)
[pista@HP-PC bibtex]$ 
```

我假设某处缺少动态 .so 库。所以我创建了几个地方的符号链接：

```
[pista@HP-PC bibtex]$ ldd /home/pista/perl5/lib/perl5/x86_64-linux-thread-multi/auto/Text/BibTeX/BibTeX.so
    linux-vdso.so.1 =>  (0x00007ffffd3ff000)
    libbtparse.so => not found
    libc.so.6 => /lib64/libc.so.6 (0x00007f9906d86000)
    /lib64/ld-linux-x86-64.so.2 (0x000000310b800000)
[pista@HP-PC bibtex]$ ls -l /usr/local/lib64/libbtparse.so /usr/share/perl5/libbtparse.so /usr/local/lib64/perl5/libbtparse.so /usr/local/share/perl5/libbtparse.so /usr/lib64/perl5/libbtparse.so
lrwxrwxrwx 1 root root     30 Feb  3 22:19 /usr/lib64/perl5/libbtparse.so -> /usr/local/lib64/libbtparse.so
-r-xr-xr-x 1 root root 268365 Nov 21 00:35 /usr/local/lib64/libbtparse.so
lrwxrwxrwx 1 root root     30 Feb  3 22:19 /usr/local/lib64/perl5/libbtparse.so -> /usr/local/lib64/libbtparse.so
lrwxrwxrwx 1 root root     30 Feb  3 22:19 /usr/local/share/perl5/libbtparse.so -> /usr/local/lib64/libbtparse.so
lrwxrwxrwx 1 root root     30 Feb  3 22:19 /usr/share/perl5/libbtparse.so -> /usr/local/lib64/libbtparse.so 
```

还尝试重新安装`Text::BibTeX`：`cpan -f -i Text::BibTeX`它没有错误地完成，但没有解决问题。

还尝试了以下内容：

```
[pista@HP-PC bibtex]$ echo $LD_LIBRARY_PATH
[pista@HP-PC bibtex]$ LD_LIBRARY_PATH="$LD_LIBRARY_PATH:/usr/local/lib64/"
[pista@HP-PC bibtex]$ echo $LD_LIBRARY_PATH
:/usr/local/lib64/
[pista@HP-PC bibtex]$ export $LD_LIBRARY_PATH
bash: export: `:/usr/local/lib64/': not a valid identifier 
```

在另一个窗口我试过这个（不修改`$LD_LIBRARY_PATH`只是导出）：

```
[pista@HP-PC bibtex]$ echo $LD_LIBRARY_PATH

[pista@HP-PC bibtex]$ export $LD_LIBRARY_PATH
declare -x BOOT_IMAGE="/boot/vmlinuz-3.6.11-1.fc16.x86_64"
declare -x DBUS_SESSION_BUS_ADDRESS="unix:abstract=/tmp/dbus-KwW8FbO4rY,guid=bf5418c1b6c412ebce2d49f80000001b"
declare -x DESKTOP_SESSION="LXDE"
declare -x DISPLAY=":0"
declare -x GNOME_KEYRING_CONTROL="/tmp/keyring-ovZxH6"
declare -x GNOME_KEYRING_PID="1721"
declare -x GTK_IM_MODULE="gtk-im-context-simple"
declare -x HISTCONTROL="ignoredups"
declare -x HISTSIZE="1000"
declare -x HOME="/home/pista"
declare -x HOSTNAME="HP-PC"
declare -x IMSETTINGS_INTEGRATE_DESKTOP="yes"
declare -x IMSETTINGS_MODULE="none"
declare -x KDEDIRS="/usr"
declare -x KDE_IS_PRELINKED="1"
declare -x KEYTABLE="us"
declare -x LANG="en_US.UTF-8"
declare -x LESSOPEN="||/usr/bin/lesspipe.sh %s"
declare -x LOGNAME="pista"
declare -x LS_COLORS="rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=01;05;37;41:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lz=01;31:*.xz=01;31:*.bz2=01;31:*.tbz=01;31:*.tbz2=01;31:*.bz=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.jpg=01;35:*.jpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.axv=01;35:*.anx=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=01;36:*.au=01;36:*.flac=01;36:*.mid=01;36:*.midi=01;36:*.mka=01;36:*.mp3=01;36:*.mpc=01;36:*.ogg=01;36:*.ra=01;36:*.wav=01;36:*.axa=01;36:*.oga=01;36:*.spx=01;36:*.xspf=01;36:*.pdf=00;33:*.ps=00;33:*.ps.gz=00;33:*.txt=00;33:*.patch=00;33:*.diff=00;33:*.log=00;33:*.tex=00;33:*.xls=00;33:*.xlsx=00;33:*.ppt=00;33:*.pptx=00;33:*.rtf=00;33:*.doc=00;33:*.docx=00;33:*.odt=00;33:*.ods=00;33:*.odp=00;33:*.xml=00;33:*.epub=00;33:*.abw=00;33:*.html=00;33:*.wpd=00;33:"
declare -x MAIL="/var/spool/mail/pista"
declare -x OLDPWD
declare -x PATH="/home/pista/perl5/bin:/home/pista/perl5/bin:/home/pista/perl5/bin:/home/pista/perl5/bin:/home/pista/perl5/bin:/home/pista/perl5/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/pista/.local/bin:/home/pista/bin"
declare -x PERL5LIB="/home/pista/perl5/lib/perl5/x86_64-linux-thread-multi:/home/pista/perl5/lib/perl5"
declare -x PERL_LOCAL_LIB_ROOT="/home/pista/perl5"
declare -x PERL_MB_OPT="--install_base /home/pista/perl5"
declare -x PERL_MM_OPT="INSTALL_BASE=/home/pista/perl5"
declare -x PREFERRED="/usr/bin/startlxde"
declare -x PWD="/home/pista/bibtex"
declare -x QT_IM_MODULE="xim"
declare -x SAL_USE_VCLPLUGIN="gtk"
declare -x SHELL="/bin/bash"
declare -x SHLVL="2"
declare -x SSH_ASKPASS="/usr/libexec/openssh/gnome-ssh-askpass"
declare -x SYSFONT="latarcyrheb-sun16"
declare -x TERM="xterm"
declare -x USER="pista"
declare -x XAUTHORITY="/home/pista/.Xauthority"
declare -x XDG_CONFIG_HOME="/home/pista/.config"
declare -x XDG_CURRENT_DESKTOP="LXDE"
declare -x XDG_MENU_PREFIX="lxde-"
declare -x XDG_RUNTIME_DIR="/run/user/pista"
declare -x XDG_SEAT="seat0"
declare -x XDG_SESSION_COOKIE="2126b6a2b64504b04e875c5400000010-1359914175.927526-581717791"
declare -x XDG_SESSION_ID="1"
declare -x XDG_VTNR="1"
declare -x XMODIFIERS="@im=none"
declare -x _LXSESSION_PID="1788" 
```

几个问题：最重要的是：如何制作`Text::BibTeX`作品？为什么`echo $LD_LIBRARY_PATH`只显示导出它显示？是否有一些 perl 包管理器可以处理依赖项、安装/卸载包？如何为所有用户安装软件包，我假设当软件包安装在 root 用户下时，它将安装在 root 主目录下，所以没有人可以访问它，还是我错了？是否可以更改已安装模块的位置（使用户的模块可供其他人使用）？为什么我无法经典地打印 @INC 变量`perl -e 'print @INC'`是这个错误还是功能？

非常感谢

# iphone - 如果您的 CSS 布局在 iPhone 的移动版 Safari 中出现混乱，典型的原因是什么？

> ID：14678497
> 
> 赞同：0
> 
> 时间：2013-02-03T23:16:08.633
> 
> 标签：iphone, css, safari, mobile-safari, positioning

我的网站适用于我测试过的浏览器的当前版本（Ff、Chrome、Safari、IE9）。但布局在 iPhone Safari (iOS 6.0) 中完全混乱。

看看： [http ://btb-2.ch.emerson.ch-meta.net/ueber-uns.html](http://btb-2.ch.emerson.ch-meta.net/ueber-uns.html)

我在网上搜索了iPhone的移动Safari的具体问题，但只能找到一些关于固定定位的观点。如果您的布局在 iPhone Safari 中混乱，从哪里开始调试？

什么是典型问题？感谢您的任何提示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:10:59.203

原因是 iPhone 的屏幕尺寸较小。它的宽度较小，您的内容会被挤在一起。尝试拖动浏览器的边缘以减小其宽度，您将看到问题出现。

检查您的`<div id="container">`. 随着屏幕尺寸的减小，它被推高。

# c++ - 大阶乘系列

> ID：14678499
> 
> 赞同：1
> 
> 时间：2013-02-03T23:16:32.657
> 
> 标签：c++, c, algorithm

我必须打印系列：-

```
n*(n-1),n*(n-1)*(n-2),n*(n-1)*(n-2)*(n-3),n*(n-1)*(n-2)*(n-3)*(n-4)...,n!. 
```

问题是 n 的值很大，它可以达到 37 和 n！会明显越界吗？我只是无法开始，请帮助，如果您在我的位置，您将如何解决这种情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:18:49.163

这取决于您使用的语言。当数字对于机器的本机整数表示而言太大时，某些语言会自动切换到大整数包。在其他语言中，只需使用一个大型整数库，它应该可以处理 37！容易地。

Wikipedia[列出了一些语言的任意精度算术库](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic#Libraries)。网络上还有很多其他资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-22T22:20:00.650

3 岁的问题看起来很有趣。

简单地创建一个例程以将字符串“乘以”一个*factor*。效率不高，但可以完成工作。

```
#include <stdlib.h>
#include <string.h>
void mult_array(char *x, unsigned factor) {
  unsigned accumulator = 0;
  size_t n = strlen(x);
  size_t i = n;
  while (i > 0) {
    i--;
    accumulator += (unsigned)(x[i]-'0')*factor;
    x[i] = (char) (accumulator%10 + '0');
    accumulator /= 10;
  }
  while (accumulator > 0) {
    memmove(x+1, x, ++n);
    x[i] = (char) (accumulator%10 + '0');
    accumulator /= 10;
  }
}

#include <stdio.h>
void AS_Factorial(unsigned n) {
  char buf[1000]; // Right-size buffer (problem for another day)
  sprintf(buf, "%u", n);
  fputs(buf, stdout);
  while (n>1) {
    n--;
    mult_array(buf, n);
    printf(",%s", buf);
  }
  puts("");
} 
```

样本使用和输出

```
int main(void) {
  AS_Factorial(5);
  AS_Factorial(37);
  return 0;
}

5,20,60,120,120
37,1332,46620,1585080,52307640,1673844480,...,13763753091226345046315979581580902400000000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T14:59:03.557

如果不允许使用任何第三方库，您可以实现自己的大整数类型。你可以这样做：

```
 #include <iostream>
    #include <iomanip>
    #include <vector>
    using namespace std;

    const int base = 1000 * 1000 * 1000; // base value, should be the power of 10
    const int lbase = 9; // lg(base)

    void output_biginteger(vector<int>& a) {
      cout << a.back();
      for (int i = (int)a.size() - 2; i >= 0; --i)
        cout << setw(lbase) << setfill('0') << a[i];
      cout << endl;
    }

    void multiply_biginteger_by_integer(vector<int>& a, int b) {
      int carry = 0;
      for (int i = 0; i < (int)a.size(); ++i) {
        long long cur = (long long)a[i] * b + carry;
        carry = cur / base;
        a[i] = cur % base;
      }
      if (carry > 0) {
        a.push_back(carry);
      }
    }

    int main() {
      int n = 37; // input your n here
      vector<int> current(1, n);
      for (int i = n - 1; n >= 1; --n) {
        multiply_biginteger_by_integer(current, i);
        output_biginteger(current);
      }
      return 0;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-08T09:03:02.457

您可以使用大整数，但这仍然有一些限制，但即使这种数据类型可以处理非常大的值。大整数可以容纳的值，范围从
-9223372036854775808 到 9223372036854775807 为有符号大整数，
0 到 18446744073709551615 为无符号大整数。

如果你真的打算做一些比大整数数据类型更大的值计算，为什么不试试[GMP 库](http://gmplib.org/)呢？

正如该网站所说，“GMP 是一个用于任意精度算术的免费库，对有符号整数、有理数和浮点数进行操作。除了机器中可用内存所暗示的精度外，对精度没有实际限制GMP运行。GMP有丰富的功能集，功能有一个规则的接口。- gmplib.org

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-04T06:53:49.807

我刚刚在 Java 中尝试过[BigInteger ，它可以工作。](http://docs.oracle.com/javase/1.4.2/docs/api/java/math/BigInteger.html)

用于演示目的的工作代码：

```
import java.math.BigInteger;

public class Factorial {
    public static int[] primes = {2,3,5,7,11,13,17,19,23,29,31,37};
    public static BigInteger computeFactorial(int n) {
        if (n==0) {
            return new BigInteger(String.valueOf(1));
        } else {
            return new BigInteger(String.valueOf(n)).multiply(computeFactorial(n-1));
        }
    }
    public static String getPowers(int n){
        BigInteger input = computeFactorial(n);
        StringBuilder sb = new StringBuilder();
        int count = 0;
        for (int i = 0; i < primes.length && input.intValue() != 1;) {
            BigInteger[] result = input.divideAndRemainder(new BigInteger(String.valueOf(primes[i])));
            if (result[1].intValue() == 0) {
                input = input.divide(new BigInteger(String.valueOf(primes[i])));
                count++;
                if (input.intValue() == 1) {sb.append(primes[i] + "(" + count + ") ");}
            } else {
                if (count!=0)
                sb.append(primes[i] + "(" + count + ") ");
                count = 0;
                i++;
            }
        }
        return sb.toString();
    }
    public static void main(String[] args) {
        System.out.println(getPowers(37));
    }
} 
```

如果您愿意，可以随意使用它而不必担心版权问题。

**更新**：直到现在我才意识到你在使用 C++。在这种情况下，您可以尝试[boost BigInteger 。](http://code.google.com/p/cpputils/source/browse/0.6/cpputils/include/cpputils/exttypes/BigInteger.hpp?r=c62b5ae5ec96fa6373805e96c52397f853ec8a5e)

# javascript - 使用 Find 查找 HTML 片段的 Ajax 响应

> ID：14678500
> 
> 赞同：4
> 
> 时间：2013-02-03T23:16:33.600
> 
> 标签：javascript, jquery, dom, filter, find

我正在用 JQuery find 做一些测试，我有一个来自 AJAX 请求的 html 响应，所以最初的结果是这样的。

```
<!DOCTYPE html>
<html>
<body>   
      <div id="dashboard">
        <div id="dash2">
            <h1>Hi</h1>
        </div>
    </div>
</body>
</html> 
```

在我的 Ajax 成功代码中是这样的..

```
success : function(response,status) {                       
    console.log( $(response).find('#dashboard').html() );
} 
```

在控制台上打印它给我一个`undefined`.

但是，当我将响应页面（我创建了一个嵌套 div）修改为此

```
<!DOCTYPE html>
<html>
<body>
        <div id="div1">
            <div id="dashboard">
                <div id="dash2">
                    <h1>Hi</h1>
                </div>
            </div>
        </div>
</body>
</html> 
```

我返回的 Ajax Success 代码中的行 `console.log( $(response).find('#dashboard').html() );`返回了

```
<div id="dash2">
    <h1>Hi</h1>
</div> 
```

我的问题，第一个 HTML 怎么会在这样做`console.log( $(response).find('#dashboard').html() );`时给我一个未定义的，但是在第二个 HTML（嵌套在 div 中的那个）给了我`#dashboard`（我期望得到的那个）的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:26:25.027

据我所知，这是一个依赖于浏览器的行为，哪些标签作为卫生措施被丢弃，例如`<head/>`.

`#dashboard`执行时找不到原因

```
$(response).find('#dashboard') 
```

很可能是因为`#dashboard`在消毒之后已经成为根元素，并且`.find()`匹配到不在根本身上的后代元素。

我通常为了避免这个问题在一个空的`<div>`.

```
$("<div/>").html(response).find('#dashboard') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:28:22.037

jQuery 会去除除正文内容之外的所有内容，因此`#dashboard`位于顶层，因此`find`实际上会搜索`#dashboard`. 由于`#dashboard`它位于顶层，您可以使用过滤器从其他顶层节点中选择它。

[http://jsfiddle.net/mowglisanu/SqL9Q/](http://jsfiddle.net/mowglisanu/SqL9Q/)

# javascript - 类开关的地址复选框，但仅使用 id light2

> ID：14678502
> 
> 赞同：0
> 
> 时间：2013-02-03T23:16:40.747
> 
> 标签：javascript, jquery, html

我的问题如下：

[我用这个 IMG / CSS / jQuery 代码](http://www.maissan.net/articles/jquery-switch/2)在我的网站上设置了我的复选框

有趣的部分是：

```
<script type="text/javascript">
    $(document).ready(function() {
      // Iterate over checkboxes
      $("input[type=checkbox].switch").each(function() {
        // Insert mark-up for switch
        $(this).before(
          '<span class="switch">' +
          '<span class="mask" /><span class="background" />' +
          '</span>'
        );
        // Hide checkbox
        $(this).hide();
        // Set inital state
        if (!$(this)[0].checked) {
          $(this).prev().find(".background").css({left: "-56px"});
        }
      }); // End each()

      // Toggle switch when clicked
      $("span.switch").click(function() {
        // If on, slide switch off
        if ($(this).next()[0].checked) {
          $(this).find(".background").animate({left: "-56px"}, 200);

        // Otherwise, slide switch on
        } else {
          $(this).find(".background").animate({left: "0px"}, 200);
        }
        // Toggle state of checkbox
        $(this).next()[0].checked = !$(this).next()[0].checked;
      });
    }); // End ready()

</script> 
```

现在我想访问：

```
<input type="checkbox" id="light2" class="switch"> 
```

如何使用 JavaScript 处理 ID 标签？

我试过这样的事情：

```
<script>
    $(document).ready(function(){
        $("span.switch + #light2").click(function(){
            if($(this).next()[0].checked)
            {
                alert('checked');
            }
            else
            {
                 alert('unchecked');
            }
        });
    });
</script> 
```

感谢您的任何提示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:22:23.327

```
 $(document).ready(function(){
        $("#light2").click(function(){
            if($("#light2").is(":checked"))
            {
                alert('checked');
            }
            else
            {
                 alert('unchecked');
            }
        });
    }); 
```

工作示例：http: [//jsfiddle.net/bA2fX/](http://jsfiddle.net/bA2fX/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T10:56:56.433

感谢 ClarkeyBoy，解决方案是：

```
<script>
    $(document).ready(function(){
        $("#light2").prev("span.switch").click(function() {
            if($("#light2").attr("checked"))
            {
                alert('checked');
            }
            else
            {
                 alert('unchecked');
            }
        });
    });

</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T23:46:34.447

如果您的意图是为**每个** `.switch`ed 元素设置样式，则应该通过 CSS 来实现。

如果您的需求更复杂，那么您可以通过使用 选择每个`.switch`类元素来实现`$('.switch')`。例如：

```
$('.switch').css('color', 'red'); 
```

相反，要选择具有 ID 的特定元素（因为它**必须**是唯一的），您可以简单地使用`$('#light2')`. 例如：

```
$('#light1').on( 'click', function( evt ) {
    evt.preventDefault();
    if ($(this).is(':checked')) {
        /* your AJAX code */
    }
});

$('#light2').on( 'click', function( evt ) {
    evt.preventDefault();
    if ($(this).is(':checked')) {
        /* your AJAX code */
    }
}); 
```

但是，由于您的部分代码是在运行时由 jQuery 创建的，因此您必须在伪事件结束时设置样式并附加事件（好吧，最后您也可以[委托](http://api.jquery.com/on/)`onDomReady`） ，否则您的代码将找不到请求的元素。

# php - 灯箱通过 URL 包含图像

> ID：14678510
> 
> 赞同：0
> 
> 时间：2013-02-03T23:18:12.543
> 
> 标签：php, javascript, html

我有一个使用 URL 重写的站点，因此我必须直接引用资源，而不是通过相对 URL。我通常通过将站点 url 附加到 href 的开头来做到这一点。

例子：

```
<script src="<?php echo SITE_URL ?>lightbox/js/lightbox.js"></script> 
```

问题是在 lightbox.js 中图像是相对加载的：

```
function LightboxOptions() {
  this.fileLoadingImage = 'images/loading.gif';
  this.fileCloseImage = 'images/close.png';
  this.resizeDuration = 700;
  this.fadeDuration = 500;
  this.labelImage = "Image";
  this.labelOf = "of";
} 
```

我意识到我可以这样做：

```
 this.fileLoadingImage = 'http://www.example.com/images/loading.gif'; 
```

但它不符合我从上下文中抽象资源的想法。我想要它，所以如果我在我的配置文件中修改站点 URL，它也会显示在 lightbox.js 文件中。我对Javascript一无所知，所以这让我很沮丧。

更可接受的是：

```
 this.fileLoadingImage = site_url + '/images/loading.gif'; 
```

其中 site_url 根据 config.php 反映当前 url。如何获取 javascript 文件的 SITE_URL 常量？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:29:38.853

您可以设置一个[虚拟主机](http://en.wikipedia.org/wiki/Virtual_hosting)，将其指向包含 index.php（您的公用文件夹）的项目文件夹，然后将所有引用更改为绝对（即..e `this.fileLoadingImage = '/images/loading.gif'`）。

我相信这是许多框架所做的。

过去，如果我需要一个临时的 php 生成的 javascript 变量，我会将它直接放在`<script>`我的 scripts.php 文件中的新标签中：

```
<script src ="/js/jquery.js"></script>
...
<script>
  var SITE_URL = <?php echo $site_url; ?>;
</script> 
```

虽然我不确定这是一个很好的做法。

# image - 重组碎片图像

> ID：14678511
> 
> 赞同：0
> 
> 时间：2013-02-03T23:18:13.433
> 
> 标签：image, image-processing

我有一张被分成几部分的图像，64 行 x 64 列。每张图片为 256x256 像素。图片都是PNG。它们被命名为“Image--.png”，例如“Image-3-57”。行和列的编号从 0 而不是 1 开始。

我怎样才能将它重新组合成一个图像？理想情况下使用 BASH 和工具（我是系统管理员）虽然 PHP 也是可以接受的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:28:31.217

好吧，如果你想使用 PHP，这不是很复杂。您需要的只是一些图像功能[——imagecreate](http://cz.php.net/manual/en/function.imagecreate.php)和[imagecopy](http://cz.php.net/manual/en/function.imagecopy.php)。如果您的 PNG 是半透明的，您还需要[imagefilledrectangle](http://php.net/manual/en/function.imagefilledrectangle.php)来创建透明背景。在下面的代码中，我依赖于所有块大小相同的事实——因此像素大小必须能够除以块的数量。

```
<?php
$width = 256*64;    //height of the big image, pixels
$height = 256*64;
$chunks_X = 64;  //Number of chunks
$chunks_Y = 64;  //Same for Y
$chuk_size_X = $width/$chunks_X;  //Compute size of one chunk, will be needed in copying
$chuk_size_Y = $height/$chunks_Y;

$big = imagecreate($width, $height);   //Create the big one
for($y=0; $y<$chunks_Y; $y++) {
  for($x=0; $x<chunks_X; $x++) {
    $chunk = imagecreatefrompng("Image-$x-$y.png");
    imagecopy($big, $chunk, 
              $x*$chuk_size_X,    //position where to place little image    
              $y*$chuk_size_Y,
              0,                  //where to copy from on little image
              0,
              $chuk_size_X,       //size of the copyed area - whole little image here
              $chuk_size_Y,
    );
    imagedestroy($chunk);        //Don't forget to clear memory
  }
}
?> 
```

这只是一个草稿。我不确定所有这些 xs 和 ys 以及其他细节。时间不早了，我累了。

# mysql - 我的查询需要帮助

> ID：14678513
> 
> 赞同：-1
> 
> 时间：2013-02-03T23:18:41.410
> 
> 标签：mysql, sql

我的查询需要帮助：

```
SELECT 
P.ID,
P.CategoryID,
P.Name,
P.SupplierID,
p.UnitPrice,
p.UnitsInStock,
pp.PicturePath
FROM Products P JOIN ProductPhoto PP ON p.ID=PP.ProductID   WHERE P.CategoryID='2'; 
```

这个查询给了我 2 个结果，但它必须给我 4 个结果，因为有 4 个数据`categoryID='2'`

我也从这个查询中检查过，有 4 个数据`categoryID='2'`

```
 select * from Products; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:20:27.437

你会想要一个`LEFT JOIN`：

```
SELECT  P.ID,
  P.CategoryID,
  P.Name,
  P.SupplierID,
  p.UnitPrice,
  p.UnitsInStock,
  pp.PicturePath
FROM Products P 
LEFT JOIN ProductPhoto PP 
  ON p.ID=PP.ProductID  
WHERE P.CategoryID='2' 
```

即使表中没有匹配的行，A`LEFT JOIN`也会返回所有。将仅返回两个表中匹配的行。`Products``ProductPhoto``INNER JOIN`

如果您在学习`JOIN`语法方面需要帮助，那么这里有一个很好[的联接的可视化解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:21:49.517

```
SELECT 
P.ID,
P.CategoryID,
P.Name,
P.SupplierID,
p.UnitPrice,
p.UnitsInStock,
pp.PicturePath
FROM Products P LEFT JOIN ProductPhoto PP ON p.ID=PP.ProductID   WHERE P.CategoryID='2' 
```

尝试使用左连接，可能没有生产照片记录匹配产品。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T23:23:45.703

请注意，您正在对 ProductID 上的 ProductPhoto 执行 INNER JOIN，该 ProductID 等于 Products 中的 ID。

如果两个表中只有 2 个匹配行的 categoryID 为 2，那么您将看到返回的所有内容。

将您的查询更改为 LEFT JOIN 并查看您的 4 行是否返回。如果是，那么您的上述查询是正确的。

# c# - updatepanel 内中继器中的链接按钮使用 RegisterClientScriptBlock 生成新窗口

> ID：14678516
> 
> 赞同：0
> 
> 时间：2013-02-03T23:18:49.417
> 
> 标签：c#, updatepanel, postback, repeater, registerclientscriptblock

我有一个奇怪的情况。

我在 UpdatePanel 中有一个中继器。中继器有一个链接按钮，它产生一个新窗口——或者更确切地说，它应该产生一个新窗口。当中继器位于 UpdatePanel 之外时，它工作正常；现在没有了。

我尝试将转发器设置为 AsyncPostBack 触发器，但没有成功：

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server" UpdateMode="Conditional">
                <Triggers>
                    <asp:AsyncPostBackTrigger ControlID="rptEmployees" />
                   <asp:AsyncPostBackTrigger ControlID="imgClear" />
                </Triggers> 
```

我尝试在 ItemDataBound 上将 Linkbutton 设为 AsyncPBtrigger，但没有成功：

```
 LinkButton lb = (LinkButton)e.Item.FindControl("lbtnVcard");
          sm1.RegisterAsyncPostBackControl(lb); 
```

当我将 Linkbutton 设为 PostBackTrigger 时，弹出窗口会出现一次。以后任何时候我点击其中一个链接按钮（直到我进行硬刷新）都不会出现弹出窗口，尽管中继器的 ItemCommand 总是被点击：

```
 ClientScript.RegisterClientScriptBlock(GetType(), "", "<script>var" +
                                                                  @"  win=window.open('vCard.aspx',null,'width=50,height=50," +
                                                                  @"top=100,left=100','true');</script>", false); 
```

最后，这是我的 ItemTemplate：

```
 <ItemTemplate>
                            <!--For IE9 there can be no whitespace -->
                            <tr>
                                <td width="140"><strong><%# Eval("DisplayName") %></strong><asp:HiddenField runat="server" ID="HFname" Value='<%# Eval("SamAccountName") %>'/></td>
                                <td width="100"><%# Eval("Office") %></td>
                                <td width="120"><%# Eval("WorkPhone") %></td>
                                <td width="120"><%# Eval("MobilePhone") %></td>
                                <td width="300" style="text-align: left"><a href="mailto:<%# Eval("EmailAddress") %>"><%# Eval("EmailAddress") %></a></td>
                                <td><div class="button"><asp:LinkButton CommandName="vCard" runat="server" ID="lbtnVcard" Text="vCard" CssClass="button"/></div></td>
                            </tr>

                        </ItemTemplate> 
```

任何线索/想法？

谢谢。

更新：仍然是一个问题，因为我需要访问服务器将一些数据加载到内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:31:32.087

在页面上定义打开窗口的js

```
<script type="text/javascript">

 function OpenWin(){

window.open('vCard.aspx',null,'width=50,height=50,top=100,left=100','true');

}

</script> 
```

修改 itemtemplate 以指向它。

```
 <ItemTemplate>
                            <!--For IE9 there can be no whitespace -->
                            <tr>
                                <td width="140"><strong><%# Eval("DisplayName") %></strong><asp:HiddenField runat="server" ID="HFname" Value='<%# Eval("SamAccountName") %>'/></td>
                                <td width="100"><%# Eval("Office") %></td>
                                <td width="120"><%# Eval("WorkPhone") %></td>
                                <td width="120"><%# Eval("MobilePhone") %></td>
                                <td width="300" style="text-align: left"><a href="mailto:<%# Eval("EmailAddress") %>"><%# Eval("EmailAddress") %></a></td>
                                <td><div class="button"><asp:LinkButton CommandName="vCard" runat="server" ID="lbtnVcard" Text="vCard" CssClass="button" OnClientClick="OpenWin()"/></div></td>
                            </tr>

                        </ItemTemplate> 
```

您现在可以删除连接到按钮的 js，以查看行为是否发生变化。

# scala - 为什么Scala编译器说逆变类型A出现在类型>的协变位置：A <：任何类型B？

> ID：14678518
> 
> 赞同：6
> 
> 时间：2013-02-03T23:19:14.620
> 
> 标签：scala, covariance, contravariance

编译器告诉我这不能带有以下警告：“逆变类型 A 出现在类型 > 的协变位置：A <：任何类型 B。” 警告在 compose 方法的类型参数中。从逻辑上讲，类型定义对我来说很有意义。如果编译器对 andThen 没有疑虑，为什么反过来会出现问题？

```
trait Foo[-A]{
  def compose[B >: A](t: Foo[B]): Foo[A] = t andThen this
  def andThen[B <: A](t: Foo[B]): Foo[B]
} 
```

我所需要的只是一个它崩溃的例子。那我很开心。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:57:00.657

正如错误所说，您的方差注释`A`是错误的。您不能`A`在作为协变位置的返回类型中使用。想象一下，您有另一种方法，`Foo`其中使用`A`适当的逆变位置（作为参数）：

```
trait Foo[-A] {
  ...
  def foo(a: A): Unit
} 
```

现在您可以看到这是如何崩溃的：

*   `Foo[-A]`意味着`Foo[X] <: Foo[Y]`如果`X >: Y`
*   返回值可能是声明的返回类型的子类型
*   因此，如果`-A`在这里是合法的，`compose`可能会返回`Foo[A1]`一些`A1 >: A`
*   说`trait X`和`trait Y extends X { def bar() }`
*   想象一个打电话的`Foo[Y]`地方`foo``a.bar()`
*   `compose`因此，如果允许返回，它将中断`Foo[X]`

因此，对于您要编译的示例，`A`必须是不变的。

# php - 亚马逊 ASIN 转图书 ISBN

> ID：14678522
> 
> 赞同：0
> 
> 时间：2013-02-03T23:20:08.210
> 
> 标签：php, amazon

我正在使用[Amazon ECS PHP 库](https://github.com/Exeu/Amazon-ECS-PHP-Library/)，我正在按 ASIN 查找亚马逊书籍并想知道 ISBN 号。返回响应包括除 10 位 ISBN 号之外的所有内容。这是我的脚本：

```
$response = $amazonEcs->responseGroup('Large')->lookup('B0099RKXE8'); 
```

如何在不抓取亚马逊网站的情况下获得图书 ISBN？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-26T17:57:54.073

您的产品是 kindle，图书 ASIN 是 ISBN 10，所以如果您发现这样的产品以“B”开头，则在结果中找不到 ISBN (ISBN13)，以了解有关 ISBN10 和 ISBN13 差异的更多信息：[http](http://en.wikipedia.org/wiki/International_Standard_Book_Number) ://en.wikipedia.org/wiki/International_Standard_Book_Number 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-10T02:42:30.783

如果您只想查看 ISBN，即使 responseGroup 'Medium' 也足够了。

# java - 在 toString 方法中格式化小数？

> ID：14678523
> 
> 赞同：0
> 
> 时间：2013-02-03T23:20:10.370
> 
> 标签：java, rounding

我正在开发一个实现运费和诸如此类的基本成本的项目，我需要能够格式化 toString 以便它显示小数点后 2 位的成本。我已经对舍入做了一些研究并实现了 BigDecimal 舍入方法：

```
public static double round(double unrounded, int precision, int roundingMode) {
    BigDecimal bd = new BigDecimal(unrounded);
    BigDecimal rounded = bd.setScale(precision, roundingMode);
    return rounded.doubleValue();
}

private double baseCost() {

    double cost = (weightInOunces * costPerOunceInDollars);
    cost = round(cost, 2, BigDecimal.ROUND_HALF_UP);
    return cost;
}

@Override
public String toString() {
    return "From: " + sender + "\n" + "To: " + recipient + "\n"
            + carrier + ": " + weightInOunces + "oz" + ", "
            + baseCost();
} 
```

但是，当它打印价值 11.50 美元时，它的价格是 11.5 美元。我知道如何以 System.out.format() 样式格式化小数，但我不确定如何将其应用于 toString。我怎样才能格式化它，以便所有小数都显示为两个值？我也想知道我是否应该使用 BigDecimal，因为课堂上还没有介绍。是否还有其他易于实现的舍入方法也可以格式化双精度值的显示？或者我应该只在 toString 方法中格式化小数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:27:00.253

你可以`DecimalFormat`在`toString`. 关于 的适当性`BigDecimal`，如果您正在处理金钱，在需要精度的地方，请使用 BigDecimal。

```
@Override
public String toString() {

   DecimalFormat format = new DecimalFormat("#.00");

   return "From: " + sender + ... + format.format(baseCost());
} 
```

如果您返回`BigDecimal`而不是`double`从您的`round`方法返回，则不会丢失浮动精度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:26:51.873

用于`DecimalFormat`打印带有两位小数的`double`as a 。`String`

```
@Override
public String toString() {
    DecimalFormat df = new DecimalFormat("#.00");
    return "From: " + sender + "\n" + "To: " + recipient + "\n"
            + carrier + ": " + weightInOunces + "oz" + ", "
            + df.format(baseCost());
} 
```

# c# - 在同一列上选择多个位置

> ID：14678526
> 
> 赞同：3
> 
> 时间：2013-02-03T23:20:49.083
> 
> 标签：c#, linq, linq-to-objects

给定以下代码：

```
var filtered = (from a in lijst select a);

 foreach (string brandstof in checkedListBoxHoofdbrandstof.CheckedItems)
 {
   MessageBox.Show(brandstof);
   filtered =  (from a in lijst where a.Hoofdbrandstof.Contains(brandstof) select a);
 }
 MessageBox.Show(filtered.Count().ToString()); 
```

*   `lijst`是一个类的列表，大约有 16000 个项目

当`checkedListBoxHoofdbrandstof.CheckedItems`包含超过 1 个项目时，查询仅使用最后一个 where 子句的结果。

例如：我有 2 个值，A 和 B，尽管 A 返回 100 行，B 返回 50 行，但结果只包括最后 50 行。A 不再包含在结果中。

我尝试使用`a.Hoofdbrandstof.Any`，但这会导致有关类型的错误。我也试过`a.Hoofdbrandstof.Equals`了，结果一样。

有谁知道我可以如何组合这些结果，以便 A 和 B 的结果都在 var 过滤中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:27:10.200

简单的方法：

```
var checkedItems = checkedListBoxHoofdbrandstof.CheckedItems;
var filtered = from a in lijst
               where checkedItems.Contains(a.Hoofdbrandstof)
               select a 
```

但是这种方法的复杂性如果`O(n^2)`要降低它`O(n)`使用 Join 操作

```
var checkedItems = checkedListBoxHoofdbrandstof.CheckedItems.Cast<string>().ToList();
var filtered = from a in lijst
               join checkedItem in checkedItems on a.Hoofdbrandstof equals checkedItem
               select a 
```

# playframework-2.0 - 播放 html 表单以提交带参数的 GET 请求

> ID：14678528
> 
> 赞同：5
> 
> 时间：2013-02-03T23:21:16.460
> 
> 标签：playframework-2.0

我有一个播放 GET 路线，如何以 scala html 形式使用它？

路线

```
GET  /service/register  controllers.WebRegister.register(plan?="") 
```

斯卡拉 HTML

```
@form(action = routes.WebRegister.register, 'style -> "width: 320px;") {
       <fieldset>
           <input type="hidden" name="plan" value="FREE" id="plan">
       </fieldset>
       <div class="form-actions plan-form peer-btn-center peer-m-v-t">
            <input type="submit" data-icon='&#xe6660;' class="btn btn-primary btn-large" value="Sign Up">
       </div>
} 
```

它给了我一个错误：

> 类 ReverseWebRegister 中方法注册的参数缺失；[错误] 如果您想将其视为部分应用的函数，请在此方法后面加上 `_'

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T08:51:20.123

您不需要传递它两次（通过路由参数和表单的隐藏字段），因此您有两种解决方案：仅使用路由 arg：

## 路由的论点

路线

```
GET  /service/register  controllers.WebRegister.register(plan: String?="") 
```

模板

```
@form(action = routes.WebRegister.register("free")) {
   <input type="submit">
} 
```

当然，如果你只有这一个字段，你可以直接使用链接：

```
<a href='@routes.WebRegister.register("free")'>Register free</a> 
```

爪哇动作

```
public static Result register(String plan) {
    return ok(plan);
} 
```

## 仅表单域

从控制器中的请求中删除路由和绑定字段的参数：

路线

```
GET  /service/register  controllers.WebRegister.register 
```

模板

```
@form(action = routes.WebRegister.register) {
   <input type="hidden" name="plan" value="free">
   <input type="submit">
} 
```

爪哇动作

```
public static Result register() {
    return ok(form().bindFromRequest().get("plan"));
} 
```

# api - 使用 API 按年份过滤专辑

> ID：14678529
> 
> 赞同：3
> 
> 时间：2013-02-03T23:21:21.610
> 
> 标签：api, discogs-api

因此，我正在开发一个应用程序，该应用程序具有使用 Echo Nest API 生成与用户音乐目录中的艺术家类似的 100 位左右的艺术家列表的功能。然后，用户可以提供某一年，并且基于相似的艺术家，应用程序将返回该年发行的专辑列表。

唯一的问题是我不知道如何根据年份过滤专辑。Echo Nest API 对专辑的作用并不大。Discogs 和 Last.fm API 可用于专辑，Discogs API 有关于专辑发行日期的数据，但无法按发行日期过滤初始查询。例如，如果我有艺术家 Fleet Foxes，并且我想按 2011 年发行的专辑对其进行过滤，则没有选项可以搜索 Fleet Foxes 仅限于 2011 年发行日期的专辑。

在这一点上，我真正能看到的唯一选择是迭代艺术家拥有的每张专辑，并且只添加那些符合我要求的专辑。但是，这显然对 API 和我的服务器来说都非常繁重，尤其是考虑到 100 个相似艺术家列表中的许多艺术家没有符合我标准的专辑，而且许多艺术家的专辑都在 100 个范围内。您会考虑单曲、混音等。

有没有人看到这样做的更好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:22:36.697

如果一个 API 真的没有办法按年份过滤，那么是的，当然你必须拉下所有版本并在事后过滤它们。

如果您认为这对您的代码和/或其服务器造成负担，则应提交功能请求以添加过滤。

但是，您应该首先确保他们真的不提供这样的东西。大多数 REST API 将“获取”和“搜索”分开。例如，`http://api.example.com/artists/12345/releases`可能没有任何过滤方式，但`http://api.example.com/search?type=releases&artist=12345&year=2011`可能存在。

在不详细查看所有 API 的情况下，快速查看 Discogs 的[“运行搜索查询”](http://www.discogs.com/developers/resources/database/search-endpoint.html#run-a-search-query)文档表明您可以`year`在搜索中包含一个标准（尽管看起来您可能实际上无法按艺术家 ID 进行搜索，只是按艺术家姓名？）。

# delphi - 为什么当参数是计算变量值时，Math.Ceil 会给出意想不到的结果？

> ID：14678533
> 
> 赞同：2
> 
> 时间：2013-02-03T23:21:56.163
> 
> 标签：delphi, floating-point, ceil

在下面的代码中，最后两次调用`Ceil`给出了意外的结果。你能帮忙评论一下原因吗？

此外，如果误差（或偏差）是随机的，我能得到预期值吗？

`Ceil(Calculated_Var_Value) = 7`当`Calculated_Var_Value = 7.0000000000`.

非常感谢！

```
 procedure TForm2.FormCreate(Sender: TObject);
    var
      A, B, C: Extended;
      Val: Extended;
    begin
      ShowMessage(FloatToStr((1.8 - 2.5) / -0.1));
      ShowMessage(FloatToStrF((1.8 - 2.5) / -0.1, ffFixed, 20, 20));
      ShowMessage(FloatToStr(Ceil((1.8 - 2.5) / -0.1)));

      Val := (1.8 - 2.5) / -0.1;
      ShowMessage(FloatToStr(Val));
      ShowMessage(FloatToStrF(Val, ffFixed, 20, 20));
      ShowMessage(FloatToStr(Ceil(Val)));

      Val := (1.8 - 2.5) / -0.1;
      ShowMessage(FloatToStr(Val * 100 / 100));
      ShowMessage(FloatToStrF(Val * 100 / 100, ffFixed, 20, 20));
      ShowMessage(FloatToStr(Ceil(Val * 100 / 100)));

      A := 1.8; B := 2.5; C := -0.1;
      Val := (A - B) / C;
      ShowMessage(FloatToStr(Val));
      ShowMessage(FloatToStrF(Val, ffFixed, 20, 20));
      ShowMessage(FloatToStr(Ceil(Val)));

      A := 1.8; B := 2.5; C := -0.1;
      Val := (A - B) / C;
      ShowMessage(FloatToStr(Val * 100 / 100));
      ShowMessage(FloatToStrF(Val * 100 / 100, ffFixed, 20, 20));
      ShowMessage(FloatToStr(Ceil(Val * 100 / 100)));
    end; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T00:02:50.710

这只是浮点运算固有的不准确性。您的两个值不能完全用二进制浮点表示，`1.8`并且`-0.1`. 因此，这些数字由最接近的可表示值近似。这意味着您的方程式很可能不会精确计算为`7`.

现在考虑你的两个表达式：

```
Val1 := (1.8 - 2.5) / -0.1;
Val2 := (A - B) / C; 
```

这两者的区别在于`Val1`编译时`Val2`求值，运行时求值。现在，取决于编译器如何`(1.8 - 2.5) / -0.1`评估常量表达式。据我所知，它没有记录如何评估。

但是，很明显，编译器使用与运行时使用的不同的评估方法来评估常量表达式。该程序说明：

```
{$APPTYPE CONSOLE}

uses
  SysUtils, Math;

var
  A, B, C: Extended;
  Val1, Val2: Extended;
begin
  Val1 := (1.8 - 2.5) / -0.1;
  Writeln(Ceil(Val1));

  A := 1.8; B := 2.5; C := -0.1;
  Val2 := (A - B) / C;
  Writeln(Ceil(Val2));

  Writeln(BoolToStr(Val1=7.0, True));
  Writeln(BoolToStr(Val2=7.0, True));
  Writeln(BoolToStr(Val1<Val2, True));

  Readln;
end. 
```

输出：

```
7
8
真的
错误的
真的

```

因此，这表明`Val1`和`Val2`具有不同的值，并且`Val2`严格大于`7`。

您遇到的基本问题是浮点值的可表示性。因为您使用的是`Extended`使用二进制表示的 ，所以您的十进制输入值不能完全表示。如果你想在这里精确算术，你将需要使用十进制表示。

在回答这个问题的变体时，我向您推荐有关该主题的基本阅读材料：[每个计算机科学家应该了解的浮点运算知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T00:02:03.540

这是典型的舍入误差。当您将此行添加到输出时，您可以看到它：

```
ShowMessage(FloatToStr(Val-7)); 
```

# awk - 使用awk合并两个关联数字的文件

> ID：14678536
> 
> 赞同：1
> 
> 时间：2013-02-03T23:22:17.367
> 
> 标签：awk

我有两个文件，请注意我想使用最后一列作为参考：

1）第一个文件：

```
[robert@10-2Fontes]$ head rxid 
0.086297     id 0    udp    767     0
0.091866     id 1    udp    760     1
0.097236     id 2    udp    733     2
0.103616     id 3    udp    869     3
0.110956     id 4    udp    1000    4
0.459247     id 9    udp    754     54 
```

注意：这个文件有 64196 行。

2）第二个文件（参考）：

```
[robert@10-2Fontes]$ head pumba.txt 
0.086297 0
0.091866 1
0.097236 2
0.103616 3
0.110956 4
0.118285 5
0.125615 6
0.130077 7
0.459247 54 
```

这个文件是一个索引，有 64677 行，

3）我想要一个第三个文件，它在文件2中搜索对应的号码，并将相关的号码放在第一个文件的最后一列。像这样的东西：

```
0.086297     id 0    udp    767     0 0.086297
0.091866     id 1    udp    760     1 0.091866
0.097236     id 2    udp    733     2 0.097236
0.103616     id 3    udp    869     3 0.103616
0.110956     id 4    udp    1000    4 0.110956
... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:28:43.943

怎么样：

```
awk 'NR==FNR{a[$2]=$1;next}$6 in a{print $0,a[$6]}' file2 file1 > file3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T06:00:18.837

以防万一，您甚至可以将第一列作为参考，然后您不需要最后一列进行参考检查。我的意思是假设你有

文件1：

```
0.086297     id 0    udp    767     
0.091866     id 1    udp    760     
0.097236     id 2    udp    733     
0.103616     id 3    udp    869     
0.110956     id 4    udp    1000    
0.459247     id 9    udp    754 
```

和文件2：

```
0.086297 0
0.091866 1
0.097236 2
0.103616 3
0.110956 4
0.118285 5
0.125615 6
0.130077 7
0.459247 54 
```

您仍然可以像这样根据第一列组合它们

`awk 'NR==FNR{a[$1]=$0; next;}$1 in a {print a[$1]" "$2}' file1.txt file2.txt`

1.  `.NR==FNR{a[$1]=$0; next;}`对于第一个文件，第一列将用作存储整行的索引，下一部分将被跳过

2.  对于第二个文件，如果`$1`数组中存在第一列，`a`那么我们将先前保存的行与第二列合并`$2`

最终输出

```
0.086297     id 0    udp    767 0
0.091866     id 1    udp    760 1
0.097236     id 2    udp    733 2
0.103616     id 3    udp    869 3
0.110956     id 4    udp    1000 4
0.459247     id 9    udp    754 54 
```

# mysql - 将递增的由字母和数字组成的 ID 号使用什么类型

> ID：14678538
> 
> 赞同：0
> 
> 时间：2013-02-03T23:22:23.547
> 
> 标签：mysql, types, phpmyadmin

我应该使用什么类型来创建由字母和数字组成的 ID 号，它也会增加，例如“HP0001”增加到“HP0002”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:24:52.033

“X”长度的 Varchar，或 2 个字段，1 个 varchar 和另一个数字，都必须是主键

您可以检查我在此示例中所说的内容：

[http://sqlfiddle.com/#!2/df078/4](http://sqlfiddle.com/#!2/df078/4)

# python - 函数不保留数组中的值

> ID：14678542
> 
> 赞同：-3
> 
> 时间：2013-02-03T23:22:51.500
> 
> 标签：python, arrays, loops, numpy, filelist

所以我有一个函数可以遍历目录中的文件，从每个文件中提取指定的数组，然后将它们堆叠在一个大数组中。

```
def Graph(files,directory):
    pattern = "{}.fits".format(files)
    x = array([])
    for filename in fnmatch.filter(os.listdir(directory),pattern):
        data = pyfits.getdata(filename)
        x1 = data.field('table')
        x = hstack((x,x1))

    plot(x,y) #where y would also be defined as data retrieved in the loop 
```

当函数离开循环时，它会完全清除大数组 (x)。任何线索为什么会发生这种情况？

我需要从文件列表中获取数据并将它们的所有数据组合到一个数组中，然后绘制该数据。（我将绘制它与另一个以相同方式创建的数组“y”。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:25:26.227

当然，您`x`在函数中创建，当函数退出时，它会超出范围并自动清理。

在函数末尾返回它并存储结果：

```
def Graph(files,directory):
    pattern = "{}.fits".format(files)
    x = array([])
    for filename in fnmatch.filter(os.listdir(directory),pattern):
        data = pyfits.getdata(filename)
        x1 = data.field('table')
        x = hstack((x,x1))

    plot(x,y) #where y would also be defined as data retrieved in the loop

    return x

x = Graph(files, directory) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T07:16:56.093

还有其他人已经指出，您必须`return`读取您读入的数组，以便以后使用它。一些额外的评论：

*   如果例程只读取数据会更优雅，并且您可以在例程返回数据后绘制它。

*   不要在循环中使用 hstack，因为它会创建副本。要么使用 numpy 中的`fromfile`or`genfromtxt`例程，要么至少在循环中创建一个列表，并在循环完成后将其转换为数组。如果你以类似的方式获得它，这同样适用于 y：

    ```
    def readfiles(files, directory):
        "Returns x and y values read from files in a given directory."
        pattern = "{}.fits".format(files)
        tmpx = []
        tmpy = []
        for filename in fnmatch.filter(os.listdir(directory),pattern):
            data = pyfits.getdata(filename)
            tmpx.append(data.field('table'))
            tmpy.append(...)    # Retrieve your y data
        x = hstack(tmpx)
        y = hstack(tmpy)
        return x, y

    # Main program
    x, y = readfiles("test", "testdir")
    plot(x, y) 
    ```

# apache-poi - 如何使新的 Excel 2007 函数（如 SUMIFS）在 Apache POI 中工作？

> ID：14678544
> 
> 赞同：1
> 
> 时间：2013-02-03T23:23:10.053
> 
> 标签：apache-poi

我使用[Apache POI](http://poi.apache.org/) for Java 在 Excel 单元格中设置公式。我正在使用以下代码使公式显示为公式而不是字符串：

```
// "cell" object previously created or looked up
String StrFormula = "SUM(\"A1:A10\")";
cell.setCellType(HSSFCell.CELL_TYPE_FORMULA);
cell.setCellFormula(strFormula); 
```

这`setCellType(HSSFCell.CELL_TYPE_FORMULA)`对大多数公式来说都是诀窍，但不是全部。有一些函数（在 Excel 2007 中引入），如 SUMIFS、COUNTIFS。IFERROR, AVERAGEIFS 导致单元格包含字符串。必须单击 + 输入 Excel 中的每个此类单元格才能识别公式。有什么技巧可以使这些功能正常工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-11-14T15:20:18.750

很久没有问这个问题了，但是由于我最近遇到了类似的问题，所以我会尝试回答。

在我们的例子中，我们必须切换到`XSSF`文档类（而不是`HSSSF`）来支持 Excel2007 值。

# jquery - 验证电子邮件地址的格式 - 没有正则表达式，没有插件 jquery

> ID：14678545
> 
> 赞同：-5
> 
> 时间：2013-02-03T23:23:13.960
> 
> 标签：jquery, email-validation

我有一个几乎可以工作的功能 - 它验证以下形式的电子邮件地址格式：

*   必须有 @ 符号
*   @ 符号后必须有一些字符串。
*   必须有一个“。” 之后是另一个字符串。

它目前不起作用，因为我不知道如何正确插入一个接受用户输入的任何字符串的变量 - 如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:08:22.520

我不会自称是电子邮件验证专家。

如果您真的不能使用正则表达式，可以执行以下操作：

```
function validateEmail(str){
   var index_at= str.indexOf('@')
   if( index_at === -1){
       return false;
   }   

    var name= str.substr(0,index_at);
     /* should test name for other invalids*/

    var domain=str.substr(index_at+1);
    /* should check for extra "@" and any other checks that would invalidate an address of which there are likely many*/
    if( domain.indexOf('@') !=-1){
        return false;
    }
    /* dot can't be first character of domain*/
   return domain.indexOf('.') >0;

} 
```

演示：http: [//jsfiddle.net/v43Hw/](http://jsfiddle.net/v43Hw/)

***强烈建议使用经过电子邮件标准测试的正则表达式，以获得更高的可靠性。***

# c++ - 为转发链链接新的运营商

> ID：14678549
> 
> 赞同：0
> 
> 时间：2013-02-03T23:23:44.130
> 
> 标签：c++, memory-management, memory-leaks

考虑下面的类

```
class Forwarder : public Base
{
private:
     Base* dest;
     Forwarder* next;
public:
    explicit Forwarder(Base* dest, Forwarder* next)
        : dest(dest), next(next) {}
    ~Forwarder() {
        if (next) delete next;
        delete dest;
    }

    void DoStuff() {
        if (next) next->DoStuff();
        dest->Process();
    }
}; 
```

它的目的是为事件创建一个转发链，因此如果`DoStuff`在基层被调用，它将在整个链中传播，并通知其他人。我想用它来将输出发送到各种流。无论如何，创建链的典型方法是：

`Forwarder f(new First, new Forwarder(new SomeOther, new Forwarder(new YouGetTheIdea, NULL)));`

这是一种非常方便的构建链的方法，但它很危险并且容易受到内存泄漏的影响，因为编译器可以随机播放。有没有更安全的方法来构建我想要的链（最好保留精益语法）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:35:04.293

不要显式使用，而是使用`new`返回智能指针的函数，并使构造函数接受智能指针。

```
For example,

class Forwarder : public Base
{
private:
     shared_ptr<Base> dest;
     shared_ptr<Forwarder> next;
public:
    explicit Forwarder(shared_ptr<Base> dest, shared_ptr<Forwarder> next)
        : dest(dest), next(next) {}

    void DoStuff() {
        if (next) next->DoStuff();
        dest->Process();
    }
}; 
```

然后像这样使用它：

```
Forwarder f(make_shared<First>(), make_shared<Forwarder>(make_shared<SomeOther>(), make_shared<Forwarder>(make_shared<YouGetTheIdea>(), shared_ptr<Forwarder>(NULL)))); 
```

`unique_ptr`如果您实现`make_unique()`（或等效的工厂方法） ，您也可以改用

# c# - DataGridComboboxColumn 与 ObservableCollection 绑定

> ID：14678551
> 
> 赞同：0
> 
> 时间：2013-02-03T23:23:49.853
> 
> 标签：c#, wpf, xaml, observablecollection, datagridcomboboxcolumn

我的小项目现在看起来完全不同了。现在我有了`ObservableCollection OC1`想要与整体绑定的数据`DatagridTextBoxColumns`（通过*Binding Path*）以及`ObservableCollection OC2`我存储案例的位置`DatagridComboboxColumn`（as `ItemsSourceBinding`）。`SelectedItem`属性 in`DatagridComboboxColumn`是 from 的一个值`OC1`（并且它是 c 的一种`OC2`情况）。绑定就`DatagridTextBoxColumns`OK了。

XAML：

```
<DataGrid x:Name="DGoc1" x:Uid="DGoc1" AutoGenerateColumns="False"
          AlternationCount="2" SelectionMode="Single" Margin="0,5,0,0" 
          HorizontalAlignment="Stretch">
  <DataGrid.Columns>

    <!-- This works fine -->
    <DataGridTextColumn Binding="{Binding Path=id}" Header="ID" 
                        Width="Auto" IsReadOnly="True"/>

    <!-- Dow to bind this properly?? -->
    <DataGridComboBoxColumn ItemsSource="{Binding OC2}" 
                            SelectedItemBinding="{Binding Path=valueFromOc1}"
                            Header="OC2Cases" Width="Auto"/> 
```

C#（**更新**）：

```
public class ClasswithSomeData
{
    public int id { get; set; }
    public string valueFromOc1 { get; set; }
}
public partial class DGCBC : Window
{
    public ObservableCollection<string> OC2 { get; set; }
    public ObservableCollection<ClasswithSomeData> OC1 { get; set;}

    private void tabPanel1_Loaded(object sender, RoutedEventArgs e)
    {
        LoadDG();
    }

public void LoadDG()
    {
    OC2 = new ObservableCollection<string>(someCases);

    OC1 = new ObservableCollection<ClasswithSomeData> { };
    OC1.Add(someData1);
    OC1.Add(someData2);
    OC1.Add(someData3);
    DGoc1.ItemsSource = OC1; 
```

如何`DatagridComboboxColumn`正确绑定？请帮忙举个例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T02:13:27.847

您的 observablecollections 被声明为字段：

```
public ObservableCollection<string> OC2;
public ObservableCollection<ClasswithSomeData> OC1; 
```

它们应该是属性：

```
public ObservableCollection<string> OC2 {get;set;}
public ObservableCollection<ClasswithSomeData> {get;set;} 
```

不要忘记 INotifyPropertyChanged！=)

# mysql - mysql拒绝访问

> ID：14678552
> 
> 赞同：0
> 
> 时间：2013-02-03T23:23:57.477
> 
> 标签：mysql, raspberry-pi, raspbian

我是 mySql 的新手，只是将下载的 sql 文件放入数据库时​​遇到了很多麻烦。我正在我的树莓派上使用最新版本的 raspbian 的命令行。

```
mysql> GRANT ALL ON bbdatabank.* TO 'pi'@'localhost' IDENTIFIED BY 'password';
Query OK, 0 rows affected (0.00 sec)

mysql> CREATE DATABASE bbdatabank;
Query OK, 1 row affected (0.00 sec)

mysql> quit 
```

当我尝试将我的 sql 文件（lahman2012.sql）链接到数据库时，即使我使用上面的密码（密码），我也会收到错误消息

```
mysql -u pi -p -s bbdatabank < lahman2012.sql
Enter password: 
ERROR 1044 (42000): Access denied for user 'pi'@'localhost' to database 'bbdatabank' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:33:45.540

您还需要在 MySQL 中重新加载用户表：

```
FLUSH PRIVILEGES; 
```

[http://dev.mysql.com/doc/refman/5.0/en/flush.html](http://dev.mysql.com/doc/refman/5.0/en/flush.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:48:46.710

我个人的建议是尝试让 sql 用户使用通配符

就像是

```
CREATE USER 'pi'@'%' IDENTIFIED BY 'xyz'; 
```

这样，如果有任何差异，它会忽略它

# jquery - Parsley.js 1.x - 动态更改表单数据属性时出错

> ID：14678553
> 
> 赞同：2
> 
> 时间：2013-02-03T23:23:59.380
> 
> 标签：jquery, parsley.js

我在输入字段时第一个 keyup 事件的 Parsley 错误消息`#myTestField`是

> 这个值太短了。它应该有**4 个字符**或更多。

我试图即时更改 Parsley 字段数据属性，但这似乎不起作用。它保留首先分配的值（html 表单），而不考虑 JS 代码中修改过的值。

在 Chrome 上，我可以检查加载 DOM 后数据属性值是否发生了变化。

我的代码是

```
<form name="myForm" id="myForm">
    <input type="text" name="myTestField" id="myTestField" data-trigger="keyup" data-minlength="4" data-validation-minlength="0" >
    <button id="mySubmitButton" type="submit" >Save</button>
</form>

<script>
// wait for the DOM to be loaded 
    $(document).ready(function() {
    // destroy
    $('#myForm').parsley('destroy');
    // change attribute
    $('#myTestField').attr('data-minlength','2');
    // assign parsley to do the job
    $('#myForm').parsley();
      });
</script> 
```

我做错了什么？

更新：

这是 Parsley.js 的一个已知问题，[GitHub 上有一个问题 #52](https://github.com/guillaumepotier/Parsley.js/issues/52)

我也尝试在相同的输入#Id 上使用`removeItem()`后跟，`addItem()`但也没有工作。

我仍在尝试找出解决方法

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T14:00:58.040

Parsley 基于数据属性，由 jQuery 与`.data()`

不幸的是，当你添加一个 data-attr 时，它并没有绑定到 jQuery`.data()`上。您必须以这种方式即时添加验证器：

```
<script>
// wait for the DOM to be loaded 
    $(document).ready(function() {
      // destroy
      $('#myForm').parsley('destroy');
      // change attribute
      $('#myTestField').data('minlength', 2);
      // assign parsley to do the job
      $('#myForm').parsley();
    });
</script> 
```

我将添加一个 API 来即时添加/编辑/删除验证器，而无需调用 destroy :)

# html - Chrome/Safari 和 Firefox 之间奇怪的边距差异

> ID：14678557
> 
> 赞同：0
> 
> 时间：2013-02-03T23:24:32.343
> 
> 标签：html, css, margin

我最近设计了一个网站（[http://willryan.us/typefun01](http://willryan.us/typefun01)），主要是在编码的同时使用Chrome进行测试。我最近注意到在某些部分的末尾发生了一些奇怪的事情，（历史之后的间隙，样式与解剖学的重叠）。

我的样式表中有一个 CSS 重置（不确定这是否与此有关），我无法弄清楚是什么原因造成的，以及如何让网站看起来像在 Chrome 中查看时的样子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:36:22.467

如果你想避免 History 之后的差距，你会想在 historyWide 中使用填充而不是边距；边距拉开元素，而填充使它们更大

在解剖学上发生的事情是您正在使用属性“top”来修改#styles，这将移动元素，但父级只会为元素保留原始空间。如果您必须保持元素之间的关系，那么使用边距和填充比使用“顶部”更好。

最后，我不会像使用#stylesMono 那样使用边距定位元素。我认为您可以更好地使用段落来保持垂直位置，并从那里开始使用“p”范围内的浮动、边距和填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:28:18.467

历史之后的差距是由于：

```
#historyWide {
    margin: 250px 80px 75px;
} 
```

可以通过以下方式进行补救：

```
div#content > div {
    overflow: hidden; /* or auto */
} 
```

您还可以将 #content 的子 div 内元素的大顶部和底部边距移动到子 div 本身的填充。只要它全部包含在这些子 div 中，任何东西都可以工作。

您只是看到浏览器处理不完美布局的不同方式。

# java - 默认语言环境和数字格式

> ID：14678558
> 
> 赞同：0
> 
> 时间：2013-02-03T23:24:34.813
> 
> 标签：java, localization

嗨，我正在努力像 NumberFormat.getInstance() 的文档所说的那样格式化数字。（Windows 7、NetBeans、Java 7）

我首先进入区域设置并删除了我们的英语，我们的英语键盘和所有内容。我将其全部设置为法语和法国。我什至重新启动了我的电脑。我的代码是：

```
System.setProperty("user.language", "fr");
System.setProperty("user.country", "FR");
System.setProperty("user.language.display", "fr");
System.setProperty("user.country.display", "FR");
System.setProperty("user.language.format", "fr");
System.setProperty("user.country.format", "FR");
Locale locale = new Locale("French", "France");
Locale.setDefault(locale);
Locale.setDefault(Locale.Category.DISPLAY, locale);
Locale.setDefault(Locale.Category.FORMAT, locale);
java.text.NumberFormat nf = java.text.NumberFormat.getInstance();
System.out.println(nf.format(4.5)); 
```

尽管如此，程序仍会打印“4.5”。我不明白，对于法国法国，这应该是“4,5”。我还需要做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:32:23.857

这就是问题：

```
Locale locale = new Locale("French", "France"); 
```

它应该是：

```
Locale locale = new Locale("fr", "FR"); 
```

或者只是使用`Locale.FRENCH`.

此外，您无需设置任何属性或更改默认语言环境。只需获取`NumberFormat`您感兴趣的语言环境。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:32:16.383

这比那要容易得多...

```
 Locale locale = Locale.FRENCH; 
```

将使用法语语言环境初始化变量，并且

```
 java.text.NumberFormat nf = java.text.NumberFormat.getInstance(locale); 
```

将为您提供该语言环境的 NumberFormat。

编辑：当您使用 NetBeans 时，有两个提示可以避免将来出现此类问题：

当您键入

```
 Locale locale = new Locale( 
```

紧随其后的是 ctrl-space NetBeans 将弹出该语句的可能完成列表，每个选项都有一个显示 JavaDoc 的小窗口。

或者，当光标位于 NetBeans 上`Locale`时，当您按 Alt-F1 或右键单击时，NetBeans 将打开一个带有 JavaDoc 的浏览器窗口，显示 JavaDoc。

Java 的库有很好的文档记录，只需按一下键就可以编写文档可以真正节省时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-19T14:58:40.090

这是一个非常古老的问题，但我想报告我刚刚发现 OSX 的 JVM 实现中似乎是一个错误（仅限 Mac 的错误）。

这是显示问题的一小段代码：

```
public static void main(String[] args) {
    DecimalFormatSymbols d = DecimalFormatSymbols.getInstance(Locale.getDefault(Locale.Category.FORMAT));

    System.out.println(System.getProperty("user.language.format"));
    System.out.println(System.getProperty("user.language"));
    System.out.println(d.getDecimalSeparator());
    System.out.println(d.getGroupingSeparator());

    Locale l = Locale.getDefault();
    System.out.println("Language: "+l.getLanguage());
    System.out.println("Country: "+l.getCountry());
    System.out.println("Variant: "+l.getVariant());
    System.out.println("Tag: "+l.toLanguageTag());
    Currency c = Currency.getInstance(l);
    System.out.println("Code: "+c.getCurrencyCode());
    NumberFormat nc = DecimalFormat.getCurrencyInstance();
    NumberFormat ni = DecimalFormat.getNumberInstance();

} 
```

就我而言，输出是：

```
en
es
.
,
Language: es
Country: ES
Variant: 
Tag: es-ES
Code: EUR 
```

我的操作系统我设置了 es_ES 但由于一个错误。JVM 系统属性`user.language.format`未正确初始化，这是几个痛苦的根源。

# javascript - 带有 Rails 应用程序的 Stepy jQuery 向导表单。安装/表格问题

> ID：14678565
> 
> 赞同：0
> 
> 时间：2013-02-03T23:25:33.223
> 
> 标签：javascript, jquery, ruby-on-rails, asset-pipeline

我正在尝试将 Stepy jQuery 插件 ( [http://wbotelhos.com/stepy](http://wbotelhos.com/stepy) ) 与我的 rails 表单集成以创建向导。我宁愿不使用 Wicked 之类的东西——首选前端快速的东西。

我已将 javascript 和 CSS 在他们自己的文件中添加到我的资产管道中，并安装`gem 'jquery-ui-rails'`并放入`//= require jquery.ui.all`我的资产管道中。

即使在此之后，我似乎也无法让它在 rails 应用程序中工作。关于我可能做错了什么的任何想法？我仍在学习资产管道和 javascript，因此非常感谢您的帮助。

所有三个步骤都显示在我的表单视图中，而不是单独的步骤，如下所示：

![向导快照](../Images/6256118671ae142d1d1d5edb4cd1dde2.png)

应用程序.js

```
$('#steps').stepy(); 
```

_form.html.erb

```
<%= form_for(@wizard) do |f| %>

  <form id="steps">
    <fieldset title="Step 1">
      <legend>Step 1</legend> 
      <div class="field">
        <%= f.label :field1 %><br />
        <%= f.text_field :field1 %>
      </div>
    </fieldset>

    <fieldset title="Step 2">
      <legend>Step 2</legend> 
      <div class="field">
        <%= f.label :field2 %><br />
        <%= f.text_field :field2 %>
      </div>
    </fieldset>

    <fieldset title="Step 3">
      <legend>Step 3</legend> 
      <div class="field">
        <%= f.label :field3 %><br />
        <%= f.text_field :field3 %>
      </div>
    </fieldset>

    <div class="actions">
      <%= f.submit %>
    </div>
  </form>

<% end %> 
```

**编辑**

我最终使用了这个 gem 中的向导：`github.com/stephenbaldwin/fuelux-rails`它到目前为止有效。但是，我仍然愿意接受有关如何使上述工作的建议。

# mongodb - 为什么mongodb锁定数据库而不是collecton

> ID：14678569
> 
> 赞同：0
> 
> 时间：2013-02-03T23:26:09.443
> 
> 标签：mongodb, concurrency

我在[mongodb 手册](http://docs.mongodb.org/manual/faq/concurrency/)中阅读了一些关于数据库锁定的信息。它说 mongodb 为使用数据库的多个客户端实现了某种读写锁。当我们需要确保数据完整性时，这似乎是绝对合乎逻辑的。

我的问题是为什么 mongodb 锁定数据库而不是集合？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:34:08.480

该[功能](https://jira.mongodb.org/browse/SERVER-1240)还没有完成。它计划用于 2.4+（也许是 2.5？）。在 2.2 之前，它是全局锁而不是数据库级锁。

# java - HTML中的搜索功能

> ID：14678570
> 
> 赞同：0
> 
> 时间：2013-02-03T23:26:16.117
> 
> 标签：java, html

如何在 HTMLDocument 中搜索文本，然后返回该单词/句子的索引和最后一个索引，但在搜索时忽略标签..

**搜索：** stackoverflow
**html：** <p class="red">stack<b>overflow</b></p>

这应该返回索引 15 和 31。

就像在网页中搜索时在浏览器中一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T03:12:16.507

如果您想在 Java 中执行此操作，这里是使用 Jsoup 的粗略示例。但是当然你应该实现细节，以便代码可以正确解析任何给定的 html。

```
String html = "<html><head><title>First parse</title></head>"
      + "<body><p class=\"red\">stack<b>overflow</b></p></body></html>";

String search = "stackoverflow";

Document doc = Jsoup.parse(html);
String pPlainText = doc.body().getElementsByTag("p").first().text(); // will return stackoverflow

if(search.matches(pPlainText)){
    System.out.println("text found in html");

    String pElementString = doc.body().html(); // this will return <p class="red">stack<b>overflow</b></p></body>
    String firstWord = doc.body().getElementsByTag("p").first().ownText(); // "stack"
    String secondWord = doc.body().getElementsByTag("p").first().children().first().ownText(); // "overflow"

    //search the text in pElementString
    int start = pElementString.indexOf(firstWord); // 15
    int end = pElementString.lastIndexOf(secondWord) + secondWord.length(); // 31
    System.out.println(start + " >> " + end);

}else{
    System.out.println("cannot find searched text");
} 
```

# ruby-on-rails - Rails 安装 Gem - 主机名与服务器证书不匹配

> ID：14678573
> 
> 赞同：0
> 
> 时间：2013-02-03T23:26:40.253
> 
> 标签：ruby-on-rails, amazon-ec2, gem, certificate

我最近一直在尝试使用 Amazon EC2 上传我的第一个 Rails 项目。在那个过程中，我隐约记得在命令行某处配置了一个密钥，以让我连接到 EC2 实例。无论如何，从那以后（我认为），当我收到错误消息时，我无法安装 Ruby Gems：

![在此处输入图像描述](../Images/10530f7b9a8824a289f03f704a1bd302.png)

我一直在寻找几个小时来尝试解决这个问题，所以非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:47:59.657

看来您的 gem 配置仍在查看`https://gemcutter.org`.

在您的浏览器中访问它，您将很快意识到问题，SSL证书已签名`rubygems.org`

我建议您将您的宝石来源更改为`https://rubygems.org`

尝试设置 gem 源

```
gem sources --add https://rubygems.org/ 
```

现在如果你跑

```
gem sources 
```

你应该得到类似的东西

```
*** CURRENT SOURCES ***

https://gemcutter.org/
https://rubygems.org/ 
```

所以也删除 gemcutter.org

```
gem sources --remove https://gemcutter.org/ 
```

那你应该没事。

# node.js - nock 库 - 如何匹配任何 url

> ID：14678580
> 
> 赞同：22
> 
> 时间：2013-02-03T23:27:58.833
> 
> 标签：node.js

嗨，我正在尝试[nock 库](https://github.com/flatiron/nock/blob/master/README.md)，但正在努力匹配查询字符串上的随机模式。我认为像下面的代码这样的东西应该可以工作，但我什么也做不了。

```
 var nock, request;

  request = require('request');

  nock = require('nock');

  nock("http://www.google.com").filteringPath(/.*/g).get("/").reply(200, "this should work?");

  request("http://www.google.com?value=bob", function(err, res, body) {
    return console.log(body);
  }); 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-04T04:55:20.423

我以前没有使用过这个，但是通过阅读[文档](https://github.com/flatiron/nock#path-filtering)可能会有所帮助。

像这样的东西怎么样：

```
var nock = require('nock');
var request = require ('request');

nock("http://www.google.com")
    .filteringPath(function(path){
        return '/';
    })
    .get("/")
    .reply(200, "this should work?");

request("http://www.google.com?value=bob", function(err, res, body) {
    return console.log(body);
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-05-09T06:32:08.530

我们也可以使用正则表达式

```
nock("http://www.google.com")
   .get(/.*/) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-10-06T09:28:52.140

只是为了完成 thtsigma 的回答：

如果要**匹配任何范围（协议、域和端口），**还可以添加[范围过滤](https://github.com/node-nock/nock#scope-filtering)

 **```
var nock = require('nock');
var request = require ('request');

nock("http://www.whatever-here.com", {
    filteringScope: function(scope) {
      return true;
    }
  })
  .filteringPath(function(path){
      return "/";
  })
  .get("/")
  .reply(200, "this should work?");

request("http://www.google.com?value=bob", function(err, res, body) {
  return console.log(body);
}); 
```

这样，任何 url 都将被匹配。**

# sql-server-2012 - SQL Server 2012 Enterprise vs Standard - 使用分区？

> ID：14678589
> 
> 赞同：2
> 
> 时间：2013-02-03T23:29:17.570
> 
> 标签：sql-server-2012, partitioning

我一直在针对 SQL Server 2012 Enterprise 进行开发，并开始迁移到生产环境，我发现我们的托管服务提供商已经安装了 Standard。我不认为这应该是一个问题，因为我没有实现任何企业特定的功能。但是，当我恢复数据库时，它无法激活，并且在事件日志中，我发现一条消息表明数据库无法激活，因为它包含版本不支持的功能。当我深入挖掘时，我发现似乎 FTS 或其他一些函数自动创建了 5 个分区函数和方案。

然后我经历了一个耗时的过程来删除分区功能和方案，并且可以成功地恢复标准版上的数据库。

过了一会儿，我备份了数据库（没有 PF 或 PS），将它转移到我的开发环境，恢复它（在 SQL Enterprise 上），过了一段时间我发现已经创建了一个分区函数和方案。当我接下来备份和恢复到 prod 时，这一次数据库激活正常，没有错误 - 即使有分区功能和方案。

我刚刚运行了以下命令：

```
SELECT feature_name FROM sys.dm_db_persisted_sku_features ; 
```

从这里

[http://msdn.microsoft.com/en-us/library/cc280724.aspx](http://msdn.microsoft.com/en-us/library/cc280724.aspx)

并发现对于具有 5 个分区功能/方案的数据库，分区被列为特定于版本的功能。当对具有 1 个功能/方案的数据库运行相同的操作时，它没有列出。

这里有什么事情是自动创建的，FTS 相关的分区方案在标准版上是可以的，但不是手动创建/其他类型的？（请记住，我从未手动实现分区）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-29T12:37:01.340

基于 MSDN 文章[SQL Server 2012 版本支持的功能](http://msdn.microsoft.com/en-us/library/cc645993.aspx)：

只有企业版支持表和索引的分区。这意味着如果任何表或索引被分区，则不能将其导入任何其他版本。但是，分区方案和分区函数可以存在而不被任何表或索引使用。在这种情况下导入成功，因为没有分区表或索引。

此外，RDBMS 可管理性部分告诉我们，所有版本都在一定程度上支持分布式分区视图。因此允许分区方案和功能作为定义存在于所有版本中。

# c++ - 这两个向量初始化是否实现了相同的结果？

> ID：14678590
> 
> 赞同：-4
> 
> 时间：2013-02-03T23:29:19.640
> 
> 标签：c++

这些是否有效地做同样的事情？

```
vector<MyType> stuff;
MyClass(MyType *things, int numThings){
    for (int i = 0; i < numThings; ++i){
        //stuff[i] = things[i]; //original version of question, fixed
         stuff.push_back(things[i]);
    }
} 
```

对比

```
vector<MyType> stuff;
MyClass(MyType *things, int numThings) : stuff(things, things+numThings) {}//fixed 
```

如果是的话，使用这两种方法的开销有多大？（方法一中的额外打字除外）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T23:32:39.970

不。

第一种方法崩溃，因为它访问了超出零大小向量末尾的元素。如果通过首先调整向量大小来修复此错误，则向量中的元素将首先被初始化，然后使用`operator=`. 如果通过在循环中使用来修复错误`push_back()`，则可以在循环期间调整向量的大小。

第二种方法在一个步骤中使用所需内容初始化向量，这是首选，因为这更简单且明显正确。它也没有调整向量大小的开销，也没有两次初始化元素的开销。

**编辑：**看起来第二个也是一个错误：

```
stuff(things, numThings) 
```

应该

```
stuff(things, things + numThings) 
```

我永远记不起标准库类的所有构造函数，有趣的是`string`这个构造函数有但`vector`没有。

## 固定版本

以下两个版本大致等价：

```
MyClass(MyType *things, int numThings)
{
    stuff.reserve(numThings);
    for (int i = 0; i < numThings; i++)
        stuff.push_back(things[i]);
}

MyClass(MyType *things, int numThings)
    : stuff(things, things + numThings);
{ } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T23:34:31.033

这可能是最好的：

```
MyClass(MyType*things, int numThings) : stuff(things, things + numThings) {}
//                                                    ^^^^^^^^^^^^^^^^^^ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T23:44:12.227

取决于你的意思是相同的结果。假设这两种方法都有效（您需要修改第二种方法以匹配迪特里希和其他人的建议），您仍然有一种方法使用初始化列表，另一种方法是将向量填充到构造函数的主体中。

第二个将产生一个向量，其内容*在构造函数 body 的开头*是有效的。

虽然这两种方法都将以相同大小和内容的向量结束，但第二种方法更可取，因为：

1.  它更清洁
2.  它也可能更快。

# rubygems - 如何将 ubuntu 上的 ruby gem 更新到 1.9？

> ID：14678591
> 
> 赞同：2
> 
> 时间：2013-02-03T23:29:25.447
> 
> 标签：rubygems

我正在尝试在 32 位 Ubuntu EC2 AMI 上安装 Shapado，并将 ruby​​ 更新到 1.9.2 作为安装的一部分。但是，我收到此错误

```
ubuntu@domU....:/var/rails/shapado$ sudo rake gems:install
rake aborted!
Gemfile syntax error:
/var/rails/shapado/Gemfile:87: syntax error, unexpected ':', expecting kEND
gem 'sass-rails', git: 'https://github.com/rails/sas...
                    ^
/var/rails/shapado/Gemfile:87: syntax error, unexpected ',', expecting kEND
...hub.com/rails/sass-rails.git', branch: '3-2-stable'
                          ^
/var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/dsl.rb:35:in `eval_gemfile'
/var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/dsl.rb:7:in `evaluate'
/var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler/definition.rb:18:in `build'
/var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler.rb:144:in `definition'
/var/lib/gems/1.8/gems/bundler-1.2.3/lib/bundler.rb:112:in `setup'
/var/rails/shapado/config/boot.rb:8
/var/rails/shapado/config/application.rb:1
enter code here 
```

不是 ruby​​ 用户，我猜这与 gems/1.8 有关，但如果我尝试使用更新

```
gem update --system 
```

我收到警告说此更新系统在 Debian 上已禁用。

```
ubuntu@domU-12-31-38-04-9E-D2:/var/rails/shapado$ gem update --system
ERROR:  gem update --system is disabled on Debian, because it will overwrite the
content of the rubygems Debian package, and might break your Debian system in s
ubtle ways. The Debian-supported way to update rubygems is through apt-get, usin
g Debian official repositories.
If you really know what you are doing, you can still update rubygems by setting 
the REALLY_GEM_UPDATE_SYSTEM environment variable, but please remember that this
is completely unsupported by Debian. 
```

那么，拥有 1.8 颗宝石是不是一个错误，如果是，那么更新它的最佳方法是什么？如果这样更好的话，我可以对整个事情进行核弹并重新开始。我想我应该指定一个特定的版本，而不是仅仅按照安装说明[http://shapado.com/questions/how-to-install-shapado-on-amazon-ec2](http://shapado.com/questions/how-to-install-shapado-on-amazon-ec2)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-29T16:50:21.247

这在 Debian 中被设计为禁用。

```
gem update --system 
```

而是使用这个：

```
apt-get install rubygems 
```

如果您仍然遇到问题，建议您使用 Aptitude 卸载 RubyGems，然后从源代码重新安装。[RubyGems 网站在此处](http://help.rubygems.org/kb/rubygems/rubygems-upgrade-issues)提供说明。

# android - 应用程序可能在其主线程上做了太多工作

> ID：14678593
> 
> 赞同：471
> 
> 时间：2013-02-03T23:29:28.940
> 
> 标签：android, multithreading

我是 Android SDK/API 环境的新手。这是我第一次尝试绘制绘图/图表。我尝试使用 3 个不同的免费库在模拟器上运行不同类型的示例代码，布局屏幕上没有显示任何内容。logcat 重复以下消息：

```
W/Trace(1378)：来自 nativeGetEnabledTags 的意外值：0
 I/Choreographer(1378)：跳过了 55 帧！应用程序可能在其主线程上做了太多工作。

```

当我运行与许可库的评估副本有关的示例代码时，问题并没有持续存在并且图表有效。

* * *

## 回答 #1

> 赞同：547
> 
> 时间：2014-01-15T00:07:41.440

* * *

## 回答 #2

> 赞同：287
> 
> 时间：2015-08-30T10:48:10.597

正如其他人在上面回答的那样，“跳过了 55 帧！” 意味着您的应用程序中有一些繁重的处理。

就我而言，我的申请中没有繁重的过程。我仔细检查了所有内容并删除了那些我认为有点繁重的过程。

我删除了 Fragments、Activity、Libraries，直到只剩下骨架。但问题仍然没有消失。我决定检查资源，发现我使用的一些图标和背景非常大，因为我忘记检查这些资源的大小。

所以，我的建议是，如果以上答案都没有帮助，你也可以检查你的资源文件大小。

* * *

## 回答 #3

> 赞同：72
> 
> 时间：2016-04-13T22:39:57.000

我也有同样的问题。
我的情况是，我使用的是可绘制对象中的背景图像。该特定图像约为 130kB，并在我的 android 应用程序的初始屏幕和主页期间使用。

**解决方案**- 我只是将该特定图像从 drawables 转移到 drawables-xxx 文件夹，并且能够释放后台占用的大量内存，并且跳过的帧不再跳过。

**更新**使用“nodp”可绘制资源文件夹来存储背景可绘制文件。
[密度合格的可绘制文件夹或可绘制nodpi优先吗？](https://stackoverflow.com/questions/24682094/will-a-density-qualified-drawable-folder-or-drawable-nodpi-take-precedence)

* * *

## 回答 #4

> 赞同：24
> 
> 时间：2016-02-02T19:43:12.093

UI 线程延迟的另一个常见原因是 SharedPreferences 访问。当您`PreferenceManager.getSharedPreferences`第一次调用 a 和其他类似方法时，关联的 .xml 文件会立即*在同一个线程中*加载和解析。

解决这个问题的一个好方法是从后台线程触发第一个 SharedPreference 加载，尽早开始（例如从`onCreate`你的 Application 类）。这样，在您想要使用它的时候，偏好对象可能已经构建好了。

不幸的是，有时在启动的早期阶段（例如在初始活动甚至应用程序本身）读取首选项文件是必要的。在这种情况下，仍然可以通过使用`MessageQueue.IdleHandler`. 在主线程上执行您需要执行的所有其他操作，然后在您的 Activity 完全绘制后安装 IdleHandler 以执行代码。在该 Runnable 中，您应该能够访问 SharedPreferences 而不会延迟太多绘图操作并使 Choreographer 不高兴。

* * *

## 回答 #5

> 赞同：19
> 
> 时间：2017-11-29T15:54:02.080

我有同样的问题。Android Emulator 在 Android < 6.0 上完美运行。当我使用模拟器 Nexus 5 (Android 6.0) 时，该应用程序`I/Choreographer: Skipped frames`在日志中的运行速度非常慢。

因此，我通过将 Manifest 文件`hardwareAccelerated`选项更改为`true`如下方式解决了这个问题：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.myapplication">

    <application android:hardwareAccelerated="true">
        ...
    </application>
</manifest> 
```

**2022 年 1 月更新**。根据@M.Ed 的评论：如果您的目标 API >= 14，则默认[启用硬件加速。](https://developer.android.com/guide/topics/graphics/hardware-accel)

* * *

## 回答 #6

> 赞同：18
> 
> 时间：2013-08-10T04:47:13.430

尝试使用以下策略来提高您的应用程序性能：

*   如果可能，请使用多线程编程。即使您的智能手机只有一个内核（如果处理器有两个或更多，线程可以在不同的内核中运行），性能优势也是巨大的。使您的应用程序逻辑与 UI 分离很有用。使用 Java 线程、AsyncTask 或 IntentService。[检查这个](https://developer.qualcomm.com/blog/multi-threading-android-apps-multi-core-processors-part-1-2)。
*   阅读并遵循 Android 开发网站的 misc 性能提示。[在这里检查](http://developer.android.com/training/articles/perf-tips.html)。

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2015-09-04T06:50:15.977

我不是专家，但是当我想将数据从我的 android 应用程序发送到 Web 服务器时，我收到了此调试消息。虽然我使用 AsyncTask 类并在后台进行数据传输，但为了从服务器获取结果数据，我使用了 AsyncTask 类的 get() 方法，这使得 UI 同步，这意味着你的 UI 将等待太长时间。所以我的建议是让你的应用程序在一个单独的线程上完成所有面向网络的任务。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-07-08T11:52:46.443

优化您的图像...不要使用大于 100KB 的图像...图像加载占用过多的 CPU 并导致您的应用程序挂起。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2016-06-14T08:11:57.680

我有同样的问题。就我而言，我有 2 个嵌套的相对布局。RelativeLayout 总是必须进行两次测量传递。如果嵌套RelativeLayouts，你会得到一个指数测量算法。

* * *

## 回答 #10

> 赞同：6
> 
> 时间：2019-02-22T15:59:48.630

这通常发生在您在主线程中执行大型进程时。跳过少于 200 个的帧是可以的。但是如果跳过的帧超过 200 个，它会减慢应用程序 UI 线程的速度。您可以做的是在一个称为工作线程的新线程中执行这些进程，然后，当您想要访问并使用 UI 线程执行某些操作（例如：使用视图、findView 等执行某些操作）时，您可以使用**处理程序或runOnUiThread**（我更喜欢这个）为了显示处理结果。这绝对解决了问题。在这种情况下，使用工作线程非常有用，甚至必须使用。

[https://stacklearn.ir](https://stacklearn.ir)

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2018-03-22T05:00:32.963

我有同样的问题。当我在另一台计算机上运行代码时，它运行良好。然而，在我的身上，它显示“应用程序可能在其主线程上做了太多工作”。

我通过重新启动Android工作室解决了我的问题[文件->无效缓存/重新启动->单击“无效并重新启动”]。

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2019-12-05T09:08:37.123

就我而言，这是因为我不小心在方法上设置了断点。一旦我清除它，消息就消失了，性能提高了很多。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2021-01-02T08:34:31.853

正如我所做的那样，我首先首选使用`SVG`图像而不是所有其他类型，如果不可能的话，请`PNG`使用`JPG`一些图像处理工具（例如`Adobe Photoshop`或`Fotosizer`. 最简单的方法之一是像[这样](https://compresspng.com/)的在线图像压缩工具，它帮助我将所有图像文件减少到其初始大小的近 50%。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-02-05T01:05:42.847

这实际上不是问题。当您长时间使用调试器时会发生这种情况。拆下制动点并再次检查。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2016-05-20T04:39:26.020

在开发一个在网格布局上使用大量可绘制 png 文件的应用程序时，我遇到了同样的问题。我还尝试尽可能优化我的代码..但它对我没有用..然后我尝试减小那些 png 的大小..并猜测它工作得很好..所以我的建议是减少可绘制资源的大小（如果有）..

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-01-28T16:11:04.667

我的应用程序有同样的问题。但它除了在上面显示卡片列表和文本之外没有做任何事情。没有在后台运行。但后来经过一些调查发现，卡片背景的图像集导致了这种情况，即使它很小（350kb）。[然后我使用http://romannurik.github.io/AndroidAssetStudio/index.html](http://romannurik.github.io/AndroidAssetStudio/index.html)将图像转换为 9patch 图像 。
这对我有用。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2017-10-14T09:02:41.953

在对这个问题进行了大量研发之后，我得到了解决方案，

就我而言，我使用的是每 2 秒运行一次的服务，并且使用 runonUIThread，我想知道问题是否存在，但根本不存在。我发现的下一个问题是我在 May App 中使用了大图像，这就是问题所在。

我删除了图像并设置了新图像。

结论：-查看您的代码是否有任何您正在使用的原始文件很大。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2018-08-13T14:12:02.450

首先阅读警告。它说主线程上有更多负载。所以你要做的就是在一个线程中运行更多工作的函数。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2021-08-08T13:55:24.767

尚未解决，但会解决。对于我的具有一个可组合功能（按钮）和逻辑来检查设备（模拟器）上是否存在“com.whatsapp”包的小型项目，我在**启动模拟器**时在同一日志中具有以下内容：

```
I/Choreographer: Skipped 34 frames!  The application may be doing too much work on its main thread. 
```

* * *

## 回答 #20

> 赞同：-1
> 
> 时间：2020-08-16T07:14:51.920

如果您在应用程序中使用 async/await 功能，这是正常的。

# f# - 实施管道运营商的成本

> ID：14678597
> 
> 赞同：2
> 
> 时间：2013-02-03T23:29:47.180
> 
> 标签：f#

我正在使用一种名为“elm”的语言，它试图将 Haskel-esque 语法和 FRP 引入 Javascript。这里有一些关于从 F# 实现管道运算符的讨论，但语言设计者担心与更标准的（至少在其他 FP 语言中）反向管道运算符相比会增加成本（我假设会增加编译时间或编译器实现复杂性） （榆树已经实现）。任何人都可以谈论这个吗？[也请随意直接发布到该线程，否则如果没有其他人这样做，我将粘贴回最佳答案]。

[https://groups.google.com/forum/?fromgroups=#!topic/elm-discuss/Kt0MbDyRpO4](https://groups.google.com/forum/?fromgroups=#!topic/elm-discuss/Kt0MbDyRpO4)

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-04T00:06:25.277

在您引用的讨论中，我看到埃文提出了两个挑战：

1.  给我看一些使用它的 F# 项目
2.  找一些可靠的 F# 程序员谈论为什么它是一个好主意以及随之而来的成本（博客文章或其他内容）。

我会回答如下：

1.  正向管道成语在 F# 编程中非常常见，出于文体（我们喜欢它）和实用（它有助于类型推断）的原因。几乎所有你会发现的 F# 项目都会经常使用它。当然，我所有的开源项目都使用它（Unquote，FsEye，NL found [here](http://code.google.com/u/105074354266714820623/)）。毫无疑问，您会发现所有[位于 Github 的 F# 项目](https://github.com/fsharp)都相同，包括 F# 编译器源代码本身。

2.  Brian 是 Microsoft F# 编译器团队的一名开发人员，早在 2008 年就发表了一篇关于[F# 中的流水线的](https://lorgonblog.wordpress.com/2008/03/30/pipelining-in-f/)博客，这是一篇仍然非常有趣且相关的博客，它将 F# 管道与 POSIX 管道联系起来。在我自己的估计中，实施管道操作员的成本非常低。在 F# 编译器中，这在任何意义上都是正确的（它是一个单行的内联函数定义）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T23:58:06.913

管道运算符实际上非常简单 - 这是标准定义

```
let inline (|>) a b = b a 
```

此外，`.`线程中讨论的运算符是 F# ( ) 中的反向管道运算符，`<|`它使您能够消除一些括号。

我认为添加管道运营商不会对复杂性产生重大影响

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-04T14:46:28.677

除了这里已经给出的优秀答案之外，我还想补充几点。

首先，管道运算符在 F# 中很常见的原因之一是它有助于规避当前完成类型推断的方式的缺点。具体来说，如果将聚合操作与使用 OOP 的 lambda 函数应用到集合类型推断通常会失败。例如：

```
Seq.map (fun z -> z.Real) zs 
```

这会失败，因为 F# 还不知道`z`遇到该属性时的类型，`Real`因此它拒绝编译此代码。惯用的解决方法是使用管道运算符：

```
xs |> Seq.map (fun z -> z.Real) 
```

这非常丑陋（IMO），但它确实有效。

其次，F# 管道运算符在一定程度上很好，但您目前无法获得中间结果的推断类型。例如：

```
x
|> h
|> g
|> f 
```

如果此时出现类型错误，`f`程序员将想知道输入的值的类型，`f`以防问题实际上出在`h`或`g`但目前在 Visual Studio 中是不可能的。具有讽刺意味的是，这在 OCaml 中使用 Emacs 的 Tuareg 模式很容易，因为您可以获得任何子表达式的推断类型，而不仅仅是标识符。

# c# - 从 XML 读取值？

> ID：14678599
> 
> 赞同：0
> 
> 时间：2013-02-03T23:30:03.063
> 
> 标签：c#, xml

XML 数据：

```
<LIST>
  <TITLE>Item</TITLE>
  <YEAR>2013</YEAR>
  <NAME>
    <NAME_ n="1">AB</NAME_>
    <NAME_ n="2">CD</NAME_>
    <NAME_ n="3">EF</NAME_>
    <NAME_ n="4">GH</NAME_>
    <NAME_ n="5">IJ</NAME_>
  </NAME>
  <PRICE>
    <PRICE_ n="1">100</PRICE_>
    <PRICE_ n="2">103</PRICE_>
  </PRICE>
  <AV>
    <AV_ n="0">128,457</AV_>
    <AV_ n="1">1,746,301</AV_>
    <AV_ n="2">173,247</AV_>
    <AV_ n="3">246,102</AV_>
  </AV>
  <PIC>
    www.example.com/pictest.jpg
  </PIC>
  <URL>www.test.com/itemtest</URL>
</LIST> 
```

我试过这段代码：

```
XmlTextReader reader = new XmlTextReader(a);
while (reader.Read())
{
    if (reader.Name == "AV")
    {
        label1.Text += reader.Value;
    } 
```

现在，我知道我的代码需要更多帮助，因为我无法获得任何输出！
如何从此 XML 中读取值？

任何人都可以帮助我从这个 XML中获得**所有价值吗？**bcs 我对 xml 非常陌生，需要样本才能开始工作！:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:12:06.823

要从节点的内容中获取所有数值和属性编号`AV_`，请使用下一个脚本：

```
string str = "..."; //xml contents go here

var xml = XDocument.Parse(str);

var values = xml.Descendants("AV_")
                .Select(n => n.Attribute("n").Value + " : " + n.Value);

values.ToList()
      .ForEach(Console.WriteLine); 
```

印刷：

```
0 : 128,457
1 : 1,746,301
2 : 173,247
3 : 246,102 
```

不要忘记添加对 Linq 到 XML 命名空间的引用`using System.Xml.Linq`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:34:42.043

您正在查找父元素并获取它的文本值。它没有文本值，只有另一个孩子。

试试吧

```
 XmlTextReader reader = new XmlTextReader(a);
        while (reader.Read())
        {
            if (reader.Name == "AV_")
            {
                label1.Text += reader.Value;
            } 
```

# d3.js - 绘制具有最小可能高度的 D3.js 集群

> ID：14678601
> 
> 赞同：0
> 
> 时间：2013-02-03T23:30:52.880
> 
> 标签：d3.js, hierarchy, dendrogram

有没有办法动态设置 D3.js 集群的高度，使其具有可能的最小高度（即在树状图的边缘开始被切断或节点开始重叠之前的最小高度）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T20:52:01.617

[D3.js Google Group 上的这个帖子](https://groups.google.com/forum/?fromgroups=#!searchin/d3-js/element%2420dynamic%2420height/d3-js/7Js0dGrnyek/MfGJAdiPlQwJ)终于为我解答了这个问题。我还将我的集群更改为一棵树。希望这可以帮助其他有同样问题的人！

# c# - 使用 AddRange 将一列二维数组添加到列表框

> ID：14678603
> 
> 赞同：0
> 
> 时间：2013-02-03T23:31:15.080
> 
> 标签：c#, arrays, winforms, listbox, addrange

我有一个二维数组：

```
string[,] table = new string[100,2]; 
```

我想将 table[,0] 添加到列表框，类似的东西

```
listbox1.Items.AddRange(table[,0]); 
```

这样做的诀窍是什么？

编辑：我想知道是否可以使用 AddRange 做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:39:49.070

为了便于阅读，您可以为数组创建扩展方法。

```
public static class ArrayExtensions
{
    public static T[] GetColumn<T>(this T[,] array, int columnNum)
    {
        var result = new T[array.GetLength(0)];

        for (int i = 0; i < array.GetLength(0); i++)
        {
            result[i] = array[i, columnNum];
        }
        return result;
    }
} 
```

现在您可以轻松地将范围添加为数组中的切片。请注意，您从原始数组创建元素的副本。

```
listbox1.Items.AddRange(table.GetColumn(0)); 
```

# javascript - 使用快速框架更新 ajax 和 nodejs 服务器的进度条？

> ID：14678604
> 
> 赞同：2
> 
> 时间：2013-02-03T23:31:25.157
> 
> 标签：javascript, jquery, node.js, twitter-bootstrap, express

我在这样的模态框中制作了一个进度条

```
<div class="progress progress-info">
  <div class="bar" style="width: 0%"></div>
</div> 
```

我像这样用ajax更改div的内容

```
function download_inicio()
{
    $.ajax(
    {
        url:'/inicio',
        cache: false,
        type: 'GET',
    }).done(function(web)
    {
        $('#contenido_nav_principal').fadeOut(600,function()//hide the div
        {
            $('#contenido_nav_principal').empty();// empty the div
            $('#contenido_nav_principal').html(web);//changing html 
            $('#contenido_nav_principal').fadeIn(600);// fade in the div
        });
    });
} 
```

所以我想用从服务器接收数据的百分比来更新进度条...数据是从 url:/inicio 接收的 html

服务器在 nodejs 上监听

```
app.get('/inicio',routes.inicio.inicio); 
```

全部！

# json - 跨平台 JSON 解析

> ID：14678607
> 
> 赞同：2
> 
> 时间：2013-02-03T23:31:40.563
> 
> 标签：json, delphi, delphi-xe3, firemonkey-fm2

大家晚上好。

我目前正在开发我的产品[WinFlare](http://www.innuendo-eu.co.uk/index.php?id=76)的跨平台兼容版本。我面临的问题是[SuperObject](http://code.google.com/p/superobject/)仍然不能与 Firemonkey 跨平台兼容。无论如何，我在产品的原始版本中使用了它，但现在我想创建一个跨平台版本，而不是仅限于 Windows 的版本，我发现它很麻烦。

`DBXJSON`是我经过大量研究后能够找到的唯一跨平台解决方案，但事实证明，尝试和处理这令人沮丧。我为它找到的大多数示例要么不适用于我的情况，要么它们太复杂而无法从中获得任何有用的信息。有很多讨论，但我只是在努力掌握 SuperObject 如此简单的任务。今晚的大部分时间我都在努力寻找可以构建的东西，但我所尝试的一切都让我回到了原点。

理想情况下，我想修复 SuperObject，但我缺乏深入了解使其与 OS X 跨平台兼容的知识（并为移动工作室做好准备）。我欢迎对此提出任何建议，但我想没有人有时间完成如此艰巨的任务，看起来 DBXJSON 是我唯一的选择。

我正在处理的 JSON 布局仍然相同；

```
{
  response: {
    ips: [
       {
         ip: "xxx.xxx.xxx.xxx",
         classification: "threat",
         hits: xx,
         latitude: xx,
         longitude: xx,
         zone_name: "domain-example1"
         },
        {
         ip: "yyy.yyy.yyy.yyy",
         classification: "robot",
         hits: yy,
         latitude: xx,
         longitude: xx,
         zone_name: "domain-example2"
         }
       ]
   }
  result : "success",
  msg: null
} 
```

`ips`数组中可能有数百个结果。假设我想解析数组中的所有项目并提取每个`latitude`值。让我们再假设一下，我打算将它们输出到一个数组中。这是我想使用的那种代码模板；

```
procedure ParseJsonArray_Latitude(SInput : String);
var
  i : Integer;
  JsonArray : TJsonArray;
Begin
  // SInput is the retrieved JSON in string format
  { Extract Objects from array }

  for i := 0 to JsonArray.Size-1 do
  begin
    Array_Latitude[i] := JsonArray.Item[i].ToString;
  end;
end; 
```

本质上，在它说的地方`{ Extract Objects from array }`，我想要使用**DBXJSON的****最基本**的解决方案来解决我的问题。显然，我在上面的模板中显示的相关调用可能不正确——它们只是为了提供帮助。**`JsonArray`**

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T05:20:45.397

首先，解析字符串以获取对象。

```
var
  obj: TJsonObject;

obj := TJsonObject.ParseJsonValue(SInput) as TJsonObject; 
```

这为您提供了一个具有三个属性的对象，即响应、结果和消息。尽管`ParseJsonValue`它是 的一种方法`TJsonObject`，并且您的特定字符串输入恰好代表一个对象值，但它可以`TJsonValue`根据给定的 JSON 文本返回任何后代的实例。知道从哪里开始可能是使用 DbxJson 最困难的部分。

接下来，获取响应属性值。

```
response := obj.Get('response').JsonValue as TJsonObject; 
```

该结果应该是另一个对象，这次具有一个属性 ips。获取该属性，它应该有一个值的数组。

```
ips := response.Get('ips').JsonValue as TJsonArray; 
```

最后，您可以从数组中获取值。看起来您希望这些值是数字，因此您可以这样转换它们。

```
for i := 0 to Pred(ips.Size) do
  Array_Latitude[i] := (ips.Get(i) as TJsonObject).Get('latitude').JsonValue as TJsonNumber; 
```

完成后，请记住 free `obj`，而不是此处提到的其他变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-19T20:06:47.893

为了完成，由于问题表明没有`DBXJSON`跨平台的替代方案，我想指出两个开源替代方案，它们从最初的问题开始出现。

*   [XSuperObject](https://code.google.com/p/x-superobject/)有一个非常接近[SuperObject](https://code.google.com/p/superobject/)的 API ，但是是跨平台的；
*   我们的[SynCrossPlatformJSON.pas](https://github.com/synopse/mORMot/blob/master/CrossPlatform/SynCrossPlatformJSON.pas)单元，它比`DBXJSON`和`XSuperObject`.

`SynCrossPlatformJSON`能够通过自定义类型创建*无模式*对象或数组，将它们序列化和反序列化为 JSON，`variant`包括*后期绑定*以访问属性。

对于您的问题，您可以编写：

```
var doc: variant;
    ips: PJSONVariantData; // direct access to the array
    i: integer;
...
  doc := JSONVariant(SInput);   // parse JSON Input and fill doc custom variant type
  if doc.response.result='Success' then       // easy late-binding access
  begin
    ips := JSONVariantData(doc.response.ips); // late-binding access into array
    SetLength(Arr_Lat,ips.Count);
    for i := 0 to ips.Count-1 do begin
      Arr_lat[i] := ips.Values[i].latitude;
      Memo1.Lines.add(ips.Values[i].latitude); 
     end;
  end;  
... // (nothing to free, since we are using variants for storage) 
```

后期绑定和变体存储允许非常可读的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T19:13:15.313

感谢[Rob Kennedy](https://stackoverflow.com/users/33732/rob-kennedy)的帮助，我设法构建了一个解决问题的解决方案；

```
var
  obj, response, arrayobj : TJSONObject;
  ips : TJSONArray;
  JResult : TJsonValue;
  i : Integer;
  Arr_Lat : Array of string;
begin
try
  Memo1.Lines.Clear;
  obj := TJsonObject.ParseJSONValue(SInput) as TJSONObject;
  response := Obj.Get('response').JsonValue as TJSONObject;
  ips := response.Get('ips').JsonValue as TJSONArray;
  SetLength(Arr_Lat, ips.Size-1);
  for i := 0 to ips.Size-1 do
    begin
      arrayobj := ips.Get(i) as TJSONObject;
      JResult := arrayobj.Get('latitude').JsonValue;
      Arr_lat[i] := JResult.Value;
      Memo1.Lines.Add(JResult.Value);
    end;
finally
  obj.Free;
end; 
```

这会将结果添加到数组 ( `Arr_Lat`) 中，并将它们输出到备忘录 ( `Memo1`)。**

# c++ - BigInt 运算符+函数？

> ID：14678609
> 
> 赞同：0
> 
> 时间：2013-02-03T23:32:15.693
> 
> 标签：c++, bigint

我一直在尝试使用 operator+ 功能，但它似乎不起作用..不知道出了什么问题：s

大整数

```
#include <iostream>
using namespace std;
using std::cout;

#ifndef BIGINT_H
#define BIGINT_H

class BigInt
{
//input and output operators
   friend istream & operator >> (istream &, BigInt &);
   friend ostream & operator << (ostream &, const BigInt &);

//overloaded operators
   BigInt operator + (BigInt &, BigInt &);

public:
   BigInt(); //default constructor
   BigInt(int); //initializes array with user-specified numbers

  // BigInt operator +(const BigInt &); //???

   void display(); //prints array

private:
   static const int CAPACITY = 40;
   int Digits[CAPACITY]; //stores all digits

};
#endif 
```

大整数.cpp

```
#include <iostream>
#include "BigInt.h"
using std::cout;

BigInt::BigInt()
{
   for (int i = 0; i < CAPACITY; i++)
      Digits[i] = 0;
}

BigInt::BigInt(int InitNum)
{
   for(int i = 0; i < CAPACITY; ++i)
      Digits[i] = 0;

   for (int i = 0; InitNum != 0 ; ++i)
   {
      Digits[i] = (InitNum % 10);
      InitNum = InitNum / 10;
   }
}

//------------------------------------------------------------------
BigInt operator +(BigInt & lhs, BigInt & rhs)
{
   BigInt results;
   int carry = 0;

   for (int i = 39 ; i >= 0; i--)
   {
      int indexAddition = lhs.Digits[i] + rhs.Digits[i] + carry;
      if (indexAddition > 9)
         carry = 1;
      else
         carry = 0;

      results.Digits[i] %= 10;
   }

   return results;
}

//-----------------------------------------------------------------
bool BigInt::operator == (const BigInt & rhs)
{
   for(int i = 0; i < CAPACITY; i++)
   {
      if (Digits[i] != rhs.Digits[i])
         return false;
   }
   return true;
}

//-----------------------------------------------------------------
ostream & operator << (ostream & cout, const BigInt& a)
{
   for(int i = a.CAPACITY - 1; i >= 0 ; i--)
      cout << a.Digits[i];

   cout << "\n";

   return cout;
}

istream & operator >> (istream & cin,  BigInt& a)
{
   for(int i = 0; i < a.CAPACITY; i++)
      cin >> a.Digits[i];

   return cin;
}

//---------------------------------------------------------------
void BigInt::display()
{
   for(int i = CAPACITY - 1; i >= 0; i--)
      cout << Digits[i];

   cout << "\n";
} 
```

主文件

```
#include <iostream>
#include <cstdlib>
#include <fstream>
#include "BigInt.h"

int main()
{
   BigInt object1(45756369);
   BigInt object2(47435892);

   cout << object1;
   object2.display();

   BigInt object3 = object1 + object2;

   cout << object3;

   return 0;
} 
```

当我尝试使用

```
 BigInt operator +(const BigInt &); 
```

，它是这样实现的：

```
BigInt::operator +(const BigInt &a)
{
   BigInt result;

   for(int i = 0; i < CAPACITY; i++)
      result = Digits[i] + a.Digits[i];

   return result;
} 
```

我会收到这个错误：

```
BigInt.cpp: In function âBigInt& operator+(const BigInt&)â:
BigInt.cpp:36:23: error: âCAPACITYâ was not declared in this scope
BigInt.cpp:37:16: error: âDigitsâ was not declared in this scope
BigInt.h:50:23: error: âint BigInt::Digits [40]â is private
BigInt.cpp:37:30: error: within this context
BigInt.cpp:34:11: warning: reference to local variable âresultâ returned [enabled by default] 
```

当我使用

```
BigInt operator +(BigInt & lhs, BigInt & rhs)
{
   BigInt results;
   int carry = 0;

   for (int i = 39 ; i >= 0; i--)
   {
      int indexAddition = lhs.Digits[i] + rhs.Digits[i] + carry;

      if (indexAddition > 9)
         carry = 1;
      else
         carry = 0;

      results.Digits[i] %= 10;
   }

   return results;
}

In file included from BigInt.cpp:9:0:
BigInt.h:31:39: error: âBigInt BigInt::operator+(BigInt&, BigInt&)â must take either zero or one     argument
BigInt.h: In function âBigInt operator+(BigInt&, BigInt&)â:
BigInt.h:50:23: error: âint BigInt::Digits [40]â is private
BigInt.cpp:50:27: error: within this context
BigInt.h:50:23: error: âint BigInt::Digits [40]â is private
BigInt.cpp:50:43: error: within this context
BigInt.h:50:23: error: âint BigInt::Digits [40]â is private
BigInt.cpp:57:11: error: within this context 
```

为什么？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:53:51.040

该`operator+`函数不是其中的成员，`BigInt`因此它无法访问其私有成员。您应该将其声明为类的朋友：

```
friend BigIn operator +(BigInt &, BigInt &); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:59:09.807

您忘记了第 4 行中的**results.Digits[i]**

```
BigInt BigInt::operator+(const BigInt &a)
{
   BigInt result;

   for(int i = 0; i < CAPACITY; i++)
      result.Digits[i] = Digits[i] + a.Digits[i];

   return result;
} 
```

# windows-runtime - Windows.Foundation.Uri 支持 Data URI Scheme？

> ID：14678611
> 
> 赞同：0
> 
> 时间：2013-02-03T23:32:18.457
> 
> 标签：windows-runtime, winjs

Windows.Foundation.Uri 是否支持[data URI Scheme](http://en.wikipedia.org/wiki/Data_URI_scheme)，如果支持，我可以在 Windows.UI.StartScreen.SecondaryTile 中使用它作为 logoReference 参数吗？请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:29:13.240

刚刚使用 JavaScript Grid 应用程序模板对此进行了测试，但它不起作用。

Windows.Foundation.Uri 的构造函数将愉快地接受数据 URI，但 Windows.UI.StartScreen.SecondaryTile 的构造函数在尝试使用数据 URI 初始化图块时抛出异常。

所以你可能需要找到另一种方法来解决这个问题。也许您可以动态创建平铺图像并将其保存到您的 appdata 文件夹中，然后可以通过 ms-appdata:// URI 方案访问该文件夹？

有关 Windows 应用商店应用开发的更多信息，请注册[Generation App](http://bit.ly/gd30tolaunch)。

# c# - 在c#中从系统托盘单击桌面中的快捷方式恢复程序

> ID：14678613
> 
> 赞同：1
> 
> 时间：2013-02-03T23:32:28.963
> 
> 标签：c#, system-tray

我使用 Visual Studio 2012，Windows 窗体。单击桌面上的快捷方式时，我需要从系统托盘恢复应用程序。

我使用此代码可以防止同一应用程序的双重距离，但不能从系统托盘打开应用程序。

```
[STAThread]
    static void Main()
    {
        string mutex_id = "my application";
        using (Mutex mutex = new Mutex(false, mutex_id))
        {
            if (!mutex.WaitOne(0, false))
            {
                Form1 fForm;
                fForm = new Form1();
                fForm.Show();
                fForm.WindowState = FormWindowState.Normal;
                fForm.ShowInTaskbar = true;
                // MessageBox.Show("Instance Already Running!", "Error", MessageBoxButtons.OK, MessageBoxIcon.Hand);
                return;
            }

            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new Form1());
        }
    } 
```

我在stackoverflow中阅读了一些问题，但没有运气。我需要在这段代码中修改什么？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:45:03.153

您可以使用 Mutex 来完成此操作。[这](http://www.codeproject.com/Articles/32908/C-Single-Instance-App-With-the-Ability-To-Restore)是 CodePlex 的一个附加解决方案，它很容易集成到您的程序中。该解决方案确实提供了以下功能：

*   如果第一个实例最小化到系统托盘（又名“通知区域”），则将其还原
*   激活第一个实例
*   防止第二个实例打开

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:42:58.107

用不同的想法检查[这个问题](https://stackoverflow.com/questions/697058/single-instance-windows-forms-application-and-how-to-get-reference-on-it)和答案，以获得已经运行的应用程序实例。并检查此链接 - [http://msdn.microsoft.com/en-us/magazine/cc163741.aspx](http://msdn.microsoft.com/en-us/magazine/cc163741.aspx)（查看互斥锁）。

# java - 文本文件到哈希图

> ID：14678617
> 
> 赞同：-3
> 
> 时间：2013-02-03T23:33:00.230
> 
> 标签：java, oop, data-structures, hashmap

我有一个文本文件，其值的格式为：

* * *

```
[id1] text1

[id2] text2

... 
```

* * *

我想知道是否有人可以告诉我如何读取这个文本文件并将其写入 java 中的 hashmap。任何指针表示赞赏。

编辑：是的。我还没试过。到目前为止，我刚刚能够从文件中读取条款并将其打印在文本文件中。我只是在看指针。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:39:34.107

您可以阅读每一行并使用正则表达式，例如：

```
"\\[(.*?)\\]\\s*(.*)" 
```

然后第一组将包含 ID，第二组将包含值。

我不会给出代码，因为您甚至还没有真正尝试过任何东西，但是您可以查看[Pattern](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)和[Matcher](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html)类。（这两个类的名称是链接）

正则表达式的解释：

```
\\[   - open bracket (escaped)
(.*?) - capturing stuff inside the brackets
\\]   - close bracket
\\s*  - whitespace
(.*)  - everything after that (the data) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:16:38.850

如果您的文本文件小到可以保存在对象中（例如 hashmap），您可以保存。或者您必须考虑其他解决方案。例如，您有一个 20GiB 的文本文件。

您可以通过以下方式拆分您阅读的行：

```
String[] arr = line.split("(?<=])\\s+", 2) 
```

然后你把它放在你的HashMap（比如yourMap）中

```
yourMap.put(arr[0], arr[1]) 
```

我在这里做了一个小例子：

```
final String a = "[001] text here";
    final String b = "[001] text [tricky] here";
    final String c = "[0 0 1] text here";

    final String regex = "(?<=])\\s+";

    // if you want to test it, you would see key/value are correctly splited
    System.out.println(Arrays.toString(a.split(regex, 2)));
    System.out.println(Arrays.toString(b.split(regex, 2)));
    System.out.println(Arrays.toString(c.split(regex, 2)));

//--------------------------------------    

//here is the part to put them into your file
    HashMap<String,String> yourMap = new HashMap<String,String>();
    String[] array = null;
    //for each line from that file {
    array = line.split(regex,2);
    yourMap.put(array[0], array[1]);
    //}for loop ends 
```

# github - 如何为来自同一个 ssh 客户端的两个单独的 GitHub 帐户设置身份验证？

> ID：14678618
> 
> 赞同：2
> 
> 时间：2013-02-03T23:33:19.853
> 
> 标签：github, ssh, ssh-keys

简短版本：

> 有没有办法设置从一个 Linux 帐户到两个不同的 Github 帐户的自动基于公钥的 ssh 身份验证？

* * *

我有两个 Github 帐户，一个是工作帐户，一个是个人帐户，我想将它们完全分开。

我已经在我的工作 Github 帐户中设置了自动 ssh 身份验证（使用我的 ~/.ssh/id_rsa.pub）。它工作正常。

当我尝试将相同的 ssh 密钥添加到我的个人 Github 帐户时，我收到“密钥已在使用中”的错误消息。

编辑：好的，我想一个人可能能够通过适当的设置来做我想做的事情`~/.ssh/config`，但我还没有弄清楚这些应该是什么。`User`一方面，我不清楚如何`IdentityFile`为同一个主机（`github.com``git push`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T07:12:02.580

您需要创建两组（公钥/私钥）密钥，每个帐户一组。

您可以通过 ssh 配置文件引用它们，详见“ [GitHub：多帐户设置](https://stackoverflow.com/a/13567787/6309)”/

```
#Account one
Host github.com
    HostName github.com
    PreferredAuthentications publickey
    IdentityFile /c/Users/yourname/.ssh/id_rsa
    User git

#Account two
Host ac2.github.com
    HostName github.com
    PreferredAuthentications publickey
    IdentityFile /c/Users/yourname/.ssh/id_rsa_ac2
    User git 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-14T16:46:53.830

似乎 GitHub 不允许两个存储库使用相同的 RSA 密钥。

作为解决方法，您必须为每个站点创建单独的 RSA 密钥：

```
ssh-keygen -t rsa -f rsa_site1
ssh-keygen -t rsa -f rsa_site2 
```

这将生成私钥和公钥。然后将公钥添加到 GitHub 以部署密钥。

然后将您的私钥部署到远程：

```
cat rsa_site1 | ssh user@remote "cat > ~/.ssh/rsa_site1 && chmod 600 ~/.ssh/rsa_site1"
cat rsa_site2 | ssh user@remote "cat > ~/.ssh/rsa_site2 && chmod 600 ~/.ssh/rsa_site2" 
```

要在服务器上获取您的私有存储库，您可以使用以下内容：

```
ssh user@remote 'ssh-agent sh -c '\''cd /webroot/site1 && ssh-add ~/.ssh/rsa_site1 && git fetch git@github.com:priv/site1.git'\'
ssh user@remote 'ssh-agent sh -c '\''cd /webroot/site2 && ssh-add ~/.ssh/rsa_site2 && git fetch git@github.com:priv/site2.git'\' 
```

# asp.net-mvc - 在一个 ASP.NET MVC 实例中处理桌面和移动控制器的路由

> ID：14678619
> 
> 赞同：0
> 
> 时间：2013-02-03T23:33:22.543
> 
> 标签：asp.net-mvc

我希望我的网站提供来自同一个 ASP.NET MVC 实例的移动版本和桌面版本。

**我将有 2 个主机名：**

[http://m.sitename.com](http://m.sitename.com) & [http://www.sitename.com](http://www.sitename.com)

我想保持模块化，这意味着移动站点的控制器完全独立（而不仅仅是拆分视图）。我很高兴为所有移动控制器命名以“M”为前缀以避免重复的类名问题，IE：

```
MAccountController.cs
AccountController.cs 
```

我想`m.sitename.com/account/x`为移动设备维护 URL，而不是`/maccount/x` . 所以在我看来，有两种可能的方法可以很好地处理这个问题：

**选项1：**

所有移动链接都将是`/maccount/x`格式，但显示名称（在 URL 中）将是`/account/x`

或者：

**选项2：**

不知何故，我将移动控制器设置为仅响应`http://m.sitename.com`格式请求，而桌面控制器仅响应`http://www.sitename.com`格式。

**选项 2a。**使用子类化 IE`AccountController : DesktopController/MobileController` 或

**选项 2b。**Controller 类本身的某种属性/属性。

**选项 1 或 2 是否可行？**这个比那个好吗？有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:27:52.517

`DisplayMode`是更好的方法。因为这非常灵活。有时你的网页在 iphone 中不同。但是您的选项 1,2 无法做到。关于 DisplayMode 用法：

你的正常看法是

```
/Views/Home/Default.aspx  //or Default.cshtml 
```

移动视图是

```
/View/Home/Default.mobile.aspx  // or Default.mobile.cshtml 
```

但是路线是一样的。

怎么做。第一的。在 Global.asax 中插入 DisplayModePrivider

```
DisplayModeProvider.Instance.Modes.Insert(0, new
DefaultDisplayMode("iPhone")
{
    ContextCondition = (context => context.GetOverriddenUserAgent().IndexOf
        ("iPhone", StringComparison.OrdinalIgnoreCase) >= 0)
 }); 
```

第二。像这样使用

```
/View/Home/Default.iphone.aspx 
```

如果你想要不同的路线。[这](http://odetocode.com/blogs/scott/archive/2012/12/06/mixing-asp-net-mvc-display-mode-providers-and-routing-rules.aspx)可能对你有帮助

# javascript - 无法让 javascript DOM 选择器工作

> ID：14678622
> 
> 赞同：0
> 
> 时间：2013-02-03T23:33:54.927
> 
> 标签：javascript

> **可能重复：**
> [为什么 jQuery 或诸如 `getElementById` 之类的 DOM 方法找不到元素？](https://stackoverflow.com/questions/14028959/why-does-jquery-or-a-dom-method-such-as-getelementbyid-not-find-the-element)

我一直在尝试学习 js，但是我无法获得一个非常简单的示例来工作，而且我似乎找不到我做错了什么。据我了解，下面的示例应该可以工作。当我点击第二个按钮时，它调用函数 f2 并输出“batman”作为警报，所以我知道 javascript 页面链接正确。但是当我点击第一个按钮时，什么也没有发生。

HTML：

```
<head>
<script type="text/javascript" src="Positioning and flow tests.js"></script>
</head>

<body>

<p id="par1">Test</p>

<button onclick="f1()">Click me for par 1 content</button>

<button onclick="f2()">Click me for predefined text</button>
</body>
</html> 
```

Javascript

```
// JavaScript Document

var var1 = document.getElementById("par1");

function f1()
{
    alert(var1.innerHTML);
}

function f2()
{
alert("batman");
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T23:35:31.280

您必须将 JavaScript 放在页面底部，否则`par1`当您的代码运行时该元素将不可用：

```
<head>
    <title>Positioning and flow tests</title>
</head>

<body>
    <p id="par1">Test</p>
    <button onclick="f1()">Click me for par 1 content</button>
    <button onclick="f2()">Click me for predefined text</button>
    <script type="text/javascript" src="Positioning and flow tests.js"></script>
</body> 
```

* * *

另一种方法是将代码设置为在页面完成加载时运行：

```
var var1;
window.onload = function () {
    var1 = document.getElementById("par1");
};

function f1()
{
    alert(var1.innerHTML);
}

function f2()
{
    alert("batman");
} 
```

但这将等到页面*完全*加载，其中包括下载所有图像。如果您在所有图像完全下载之前单击第一个按钮，则会出现错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:40:14.817

您需要将代码放在元素之后或执行以下操作： HTML：

```
<body onload="init()">
... 
```

JS：

```
var var1;
function init() {
    var1 = document.getElementById("par1");
}

function f1()
{
    alert(var1.innerHTML);
} 
```

问题是您正在尝试获取尚未创建的元素，因此不存在。使用“init”函数将等到整个文档加载完毕后再尝试获取元素。

# android - 如何在Android中实现这种图像堆栈效果？

> ID：14678624
> 
> 赞同：0
> 
> 时间：2013-02-03T23:34:12.757
> 
> 标签：android

我查看了 H&M Android 应用程序并试图弄清楚如何实现一些小部件。谁能知道这个图像框架是如何实现的？我可以猜到它使用openGL。

![https://lh6.ggpht.com/Q-WH9L6rIIPEaEpp2ty0uXH7VqDbVqE_0x2f22o4cjvCHsVm-lTDtfqRkGWRRzywnas](../Images/3fd1dd65e5e987e37624b92cb039e20e.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T10:58:36.043

我会冒险猜测；）

首先创建正面图像。在这种情况下，它是通过使用 ImageView 和 TextView 膨胀线性布局来构建的。然后将其缓存到位图（在设置阶段，而不是绘制时间）。

在 onDraw 中，该位图被绘制到屏幕上。然后剪裁画布以避免再绘制该区域。节省大量绘图时间，无需对透明像素进行四倍透支。

然后背景是这样绘制的：

```
 for(int i = NUMBER_OF_LAYERS - 1; i > 0; i--) {
            canvas.save();
            float rotation = MAX_ANGLE * shiftModifier * ((float) i / (NUMBER_OF_LAYERS - 1));
            canvas.rotate(rotation, mImageHalfWidth, mImageHalfHeight);
            paint.setAlpha((int) (255f / (2 * i)));
            canvas.drawRect(mBitmap.getBounds(), paint);
            canvas.restore();
        } 
```

NUMBER_OF_LAYERS 是背景层数。

MAX_ANGLE 是最倾斜层的旋转角度。

shiftModifier 用于为背景层设置动画。它从零（背景完全隐藏）移动到一（背景角度 = MAX_ANGLE）。

油漆只是颜色设置为白色的油漆。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T00:01:06.003

一个透明的png框架？这也可能是九个补丁！

# django - 如何在 Heroku 上更新站点包中的文件

> ID：14678629
> 
> 赞同：1
> 
> 时间：2013-02-03T23:34:45.953
> 
> 标签：django, git, heroku

我刚刚为我的 django 项目安装了[django-robots-txt](https://github.com/nkuttler/django-robots-txt)。现在，正如项目所述，我必须根据需要编辑 robots.txt 文件。由于我无法将该文件 git 推送到我的 Heroku 服务器上，因此我不确定如何在服务器上编辑该文件。有谁知道这是怎么做到的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:11:30.110

在本地计算机上编辑文件。

做一个

```
git add -u 
```

更新项目的资源。然后

```
git commit -m "changes that you made" 
```

和一个

```
git push heroku master(assuming you are working on the master branch) 
```

这应该会将您最近的更改（包括 robots.txt 的更改）推送到 heroku。

# c# - 实体框架 - 种子数据库 - PK 是否需要包含在种子方法中？

> ID：14678630
> 
> 赞同：0
> 
> 时间：2013-02-03T23:34:47.303
> 
> 标签：c#, entity-framework, ef-code-first, entity-framework-migrations, seeding

遵循[MVC 音乐商店](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-4)教程，数据库以示例数据为种子。`Album`课程如下：

```
namespace MvcMusicStore.Models
{
    public class Album
    {
        public int      AlbumId     { get; set;}
        // ...
    }
} 
```

然后在本教程中使用的示例数据类中，在方法`Album`中创建一个对象，如下所示`Seed()`：

```
new Album { Title = "The Best Of Billy Cobham", 
Genre = genres.Single(g => g.Name == "Jazz"), 
Price = 8.99M, Artist = artists.Single(a => a.Name == "Billy Cobham"), 
AlbumArtUrl = "/Content/Images/placeholder.gif" } 
```

在**我的**项目中，我有一堂课`Tenant`：

```
public class Tenant
{
    [key]
    public int      TenantId     { get; set;}
    // ...
} 
```

在我的`Seed()`方法中，我创建了一个这样的租户：

```
new Tenant { UserId=1,  UserName="Matthew" /*...*/ } 
```

在我的`Seed()`方法中，我包含了作为 UserId 的租户 PK - 租户是从用户派生的。我想知道，因为在 Seed() 方法中我明确表示租户的 UserId PK 为 1，所以在方法运行时会导致问题吗？我问是因为在音乐商店教程中，作者没有包含专辑的PK。

所以创建专辑时没有明确说明 PK。EF会默认应用PK吗？我刚刚花了一段时间为我自己的项目创建了很多示例数据，并且我已经手动将很多实体的 PK 放入了 - EF 会接受这个还是会给我带来问题？播种是生成样本数据的最佳方式 - 替代方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:42:44.300

当您不添加`[Key]`属性时，EF 将尝试查找名为`Id`or的 int 可读可写属性`<yourClassName>Id`。

就这样。这就是为什么将 AlbumId 作为类 Album 的 PK 的原因：该类中不存在关键属性 AlbumId = `<nameOfClass>Id`，它是一个可读可写的 int。

如果您设置了 Key 属性，EF 将不会尝试查找另一个。这只是一个约定，可以让您不那么冗长。

对于示例数据，`Seed()`方法的主体是将它们放入 Code First 的好方法。

# animation - IOS：动画 UICollectionViewCells 在改变方向时滑动

> ID：14678633
> 
> 赞同：0
> 
> 时间：2013-02-03T23:35:11.240
> 
> 标签：animation, ios6, uiinterfaceorientation, uicollectionview, uicollectionviewlayout

我正在寻找覆盖我`UICollectionViewFlowLayout`以在由于方向变化而改变位置时导致单元格滑动。我目前拥有的是纵向每行 3 个单元格和横向每行 4 个单元格，但我能得到的唯一动画是当我改变方向时默认淡入。

我一直在考虑使用`performBatchUpdates`，但我很确定这不是我能找到答案的地方。

我也一直在研究`layoutAttributesForElementInRect`，`layoutAttributesForItemAtIndexPath`我认为这是我可以找到答案的地方。我不确定是否需要为单元格创建一个新属性（`previousCenter`也许）并将其用作新动画的起点，或者可能使用`performBatchUpdates`应该是新帧的值作为要更改的值。

> 为了记录，我发现的所有动画问题都是关于如何更改动画以插入和删除项目，这不是我想要做的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T15:30:09.373

尝试

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(    NSTimeInterval)duration {
    [super willRotateToInterfaceOrientation:toInterfaceOrientation duration:duration];
    [self.collectionView reloadData];
} 
```

然后添加你需要的任何东西来“滑动”它。

如果您使用的是 flowLayout 或其子类，它应该会自动为您重新定位单元格。如果您使用子类布局，您可能需要调整您返回的布局属性以对应于旋转。动画应该为你完成。

# actionscript-3 - AS3 将图像添加到扩展 MovieClip 的类

> ID：14678639
> 
> 赞同：2
> 
> 时间：2013-02-03T23:35:36.883
> 
> 标签：actionscript-3, movieclip

我是 AS3 的新手，但我以前用 flash 做过一些事情。我有一个扩展 MovieClip 的类，并具有我定义的一些属性和函数。如何将图像与此类关联，以便可以将其类型的对象添加到舞台并查看该图像（以及能够关联鼠标事件等）？这是课程：

```
public class Tank extends MovieClip {
    public var Id:int;
    public var HP:int;
    public var Dmg:int;

    public function Tank(id:int, hp:int, dmg:int){
        // constructor code
        this.Id = id;
        this.HP = hp;
        this.Dmg = dmg;

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:43:22.740

最干净的方法是删除`extends MovieClip`你的部分`Tank`并给它一个将引用其显示的属性。

```
public class Tank
{
    private var skin:Bitmap;

    public function Tank(...)
    {
        skin = new Bitmap( new YourImage() );
    }

    public function get Skin():Bitmap
    {
        return skin;
    }

} 
```

`YourImage`如果您转到以下位置，将替换为您在库中为 Bitmap 提供的类名`Properties -> ActionScript`：

![在此处输入图像描述](../Images/9fb4a7b530a75468aa9d83083bc992ba.png)

这样，当您创建 时`Tank`，您可以将其添加到`DisplayList`这样的位置（从您有权访问 的地方`stage`，例如您的文档类或时间线）：

```
var tank:Tank = new Tank(...);
stage.addChild(tank.Skin); 
```

# ruby-on-rails - 在 Rails 3 中，跟踪对给定 RESTful 资源的访问次数最有效的方法是什么？

> ID：14678640
> 
> 赞同：2
> 
> 时间：2013-02-03T23:35:38.347
> 
> 标签：ruby-on-rails, database, postgresql, optimization, model

我搜索了这个，很惊讶没有找到答案，所以我可能过于复杂了。但是，基本上我的 Rails 3 应用程序中有几个 RESTful 模型，我想以一种非常简单的方式跟踪它们，只是为了随着时间的推移跟踪流行度。就我而言，我只对跟踪 GET/show 方法的点击感兴趣——用户登录并查看这两个资源，他们的访问次数随着每次查看/页面加载而增加。

因此，我在 Books 模型上放置了一个“访问”列：

```
==  AddVisitsToBooks: migrating ===============================================
-- add_column(:books, :visits, :integer)
-> 0.0008s
==  AddVisitsToBooks: migrated (0.0009s) ====================================== 
```

该列初始化为零，然后，基本上，在 books_controller 内部，

```
def show
  unless @book.owner == current_user      #hypothetically, we won't let an owner 
                                          "cheat" their way to being popular
  @book.visits = @book.visits + 1
  @book.save
end 
```

这很好用，除了现在每次调用 show 方法时，您不仅有一个对象记录的读取操作，还有一个写入操作。也许这正是我问题的核心；在中小型生产应用程序中插入单个整数更改所需的总开销是否很大？或者这是一笔小买卖，还是根本什么都没有？

有更聪明的方法吗？每次查看给定页面时，我想出的所有其他内容仍然涉及写入记录。即使我很少搜索该字段，索引该字段是否会有所帮助？

顺便说一下，数据库是 PostgreSQL 9（在 Heroku 上运行）。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T23:45:59.213

你上面描述的有一个重要的缺点：一旦进程更新数据库（增加访问计数器），该行就会被阻塞，如果有任何其他进程必须等待..我建议使用 DB Sequence：[http:// www.postgresql.org/docs/8.1/static/sql-createsequence.html](http://www.postgresql.org/docs/8.1/static/sql-createsequence.html)但是，您需要在代码中维护自定义序列：[Ruby on Rails+PostgreSQL：使用自定义序列](https://stackoverflow.com/questions/7820747/ruby-on-railspostgresql-usage-of-custom-sequences)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T18:07:51.587

经过一番搜索，我决定从模型本身中删除访问计数器，因为正如 MiGro 所说，每次显示页面时都会阻塞该行，即使只是片刻。我认为 DB 序列方法可能是最快的，我将对其进行更多研究，但目前它有点超出我的范围，在 ActiveRecord 中实现似乎有点麻烦。因此，

[https://github.com/charlotte-ruby/impressionist](https://github.com/charlotte-ruby/impressionist)

似乎是一个不错的选择；将视图计数保存在备用表中，并使用包含 1200 多个机器人等黑名单的 gem。

# android - Android 登录屏幕变为空白

> ID：14678642
> 
> 赞同：0
> 
> 时间：2013-02-03T23:35:43.713
> 
> 标签：android, performance, android-emulator

我面临以下代码的严重问题，并会感谢任何形式的帮助。

```
public class WebHandler
{
private String username;
private String password;
private boolean errorOccured;
private String errorMessage;
private String server;

public WebHandler(String server)
{
    this.server = server;
    StrictMode.ThreadPolicy policy = new   
            StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
}

public void setUsername(String username)
{
    this.username = username;
}

public void setPassword(String password)
{
    this.password = password;
}

public String getInternetData(String url)
{
    BufferedReader bufferedReader = null;
    String data = null;

    try
    {
        HttpClient client = new DefaultHttpClient();
        URI website = new URI("http://google.com"); 
        HttpGet request = new HttpGet();
        request.setURI(website);
        HttpResponse response = client.execute(request);
        bufferedReader = new BufferedReader(new    
                    InputStreamReader(response.getEntity().getContent()));

        StringBuffer stringBuffer = new StringBuffer("");

        String line;

        while ((line = bufferedReader.readLine()) != null)
        {
            stringBuffer.append(line);
            Log.e("PLW", line);
        }

        bufferedReader.close();
        data = stringBuffer.toString();
    } 
    catch(Exception e)
    {
        this.errorOccured = true;
        this.errorMessage = e.getMessage();
    }

    return data;

}

public String Post(List<NameValuePair> nameValuePair, String url)
{
    String result = null;

    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost("http://www.google.com/");

    nameValuePair.add(new BasicNameValuePair("usernmae", this.username));
    nameValuePair.add(new BasicNameValuePair("password", this.password));

    Log.e("PLW_0", "called post..." );

    try
    {
        httpPost.setEntity(new UrlEncodedFormEntity(nameValuePair));
        HttpResponse response = httpClient.execute(httpPost);
        result = response.toString();
        Log.e("PLW_1", "response:" + result);
    } 
    catch (Exception e)
    {
        // writing exception to log
        Log.e("PLW_2", "Error:", e);
        Log.e("PLW_3", "error:" + e.getMessage());
    }
    return result;
}

public boolean hasError()
{
    return this.errorOccured;
}

public String getError()
{
    return this.errorMessage;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:56:48.883

您是否尝试在其他线程中运行您的代码？避免使用连接或耗时的任务阻塞主线程。

**更新：**

异步任务示例：

1.  [http://anujarosha.wordpress.com/2012/01/27/handling-http-post-method-in-android/](http://anujarosha.wordpress.com/2012/01/27/handling-http-post-method-in-android/)
2.  [http://pcfandroid.wordpress.com/2011/07/14/http-post-with-asynctask-android-tutorial/](http://pcfandroid.wordpress.com/2011/07/14/http-post-with-asynctask-android-tutorial/)

# php - PHP MySQL 插入

> ID：14678645
> 
> 赞同：0
> 
> 时间：2013-02-03T23:36:03.090
> 
> 标签：php, mysql

我有一个带有 mysql 的 php，如果没有相同的信息，它将向数据库中插入一些数据

```
<?php 

$id=$_POST['id'];
$guildname=$_POST['guildname'];
$level=$_POST['level'];
$score=$_POST['score'];
$guildmaster=$_POST['guildmaster'];

$con = mysql_connect("localhost", "root", "");
if (!$con)
  {die('Could not connect to mysql: ' . mysql_error());} 

$mydb = mysql_select_db("gunbound");
if (!$mydb)
  {die('Could not connect to database: ' . mysql_error());} 

  $dup = mysql_query("SELECT Id FROM guildrequest WHERE Id='".$_POST['id']."'");
        if(mysql_num_rows($dup) >= 1){
            echo '<b>You have already ask for guild request.</b>';
        }
        else
        {

     $dup2 = mysql_query("INSERT INTO guildrequest VALUES ('$id', '$guildname', '$level', '$score', '$guildmaster')");
        }
 Print "<center>You have requested to join the guild.</center>"; 

mysql_close($con);
?> 
```

但如果没有记录相等，它不会将记录添加到数据库中

也不执行这个：

```
$dup2 = mysql_query("INSERT INTO guildrequest VALUES ('$id', '$guildname', '$level', '$score', '$guildmaster')"); 
```

即使代码：

```
if(mysql_num_rows($dup) >= 1){ 
```

说他可以做插入的动作

请帮我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:18:58.137

尝试这个：

```
<?php 

$id=$_POST['id'];
$guildname=$_POST['guildname'];
$level=$_POST['level'];
$score=$_POST['score'];
$guildmaster=$_POST['guildmaster'];

$con = mysql_connect("localhost", "root", "");
if (!$con)
  {die('Could not connect to mysql: ' . mysql_error());} 

$mydb = mysql_select_db("gunbound");
if (!$mydb)
  {die('Could not connect to database: ' . mysql_error());} 

  $dup = mysql_query("SELECT Id FROM guildrequest WHERE Id='".$_POST['id']."'");
        if(mysql_num_rows($dup) >= 1){
            echo '<b>You have already ask for guild request.</b>';
        }
        else
        {

     $dup2 = mysql_query("INSERT INTO guildrequest VALUES ('$id', '$guildname', '$level', '$score', '$guildmaster')");
     return $dup2;
        }
 Print "<center>You have requested to join the guild.</center>"; 

mysql_close($con);
?> 
```

我已在您的 else 声明中添加了回报。我将执行你的 $dub2 变量。如果您想保留变量 $dub2 ，您可以在中间执行您的查询。另一种方法是使用 mysql_execute() 函数。

这将是一个 MYSQLI 等价物：

```
<?php 

$id=$_POST['id'];
$guildname=$_POST['guildname'];
$level=$_POST['level'];
$score=$_POST['score'];
$guildmaster=$_POST['guildmaster'];

$host = "hostname";
$user = "username";
$password = "password";
$database = "database";

$con = mysqli_connect($host, $user, $password, $database);
if (!$con)
  {die('Could not connect to mysql: ' . mysql_error());} 

 $dup = "SELECT Id FROM guildrequest WHERE Id='".$_POST['id']."'";

mysqli_query($con, $dup);
  if (!$dup)
  {die('Could not connect to database: ' . mysql_error());} 

        if(mysqli_num_rows($dup) >= 1){
            echo '<b>You have already ask for guild request.</b>';
        }
        else
        {
     $dup2 = "INSERT INTO guildrequest VALUES ('$id', '$guildname', '$level', '$score', '$guildmaster')";
     mysqli_query($con, $dup2);
        }
 Print "<center>You have requested to join the guild.</center>"; 

mysqli_close($con);
?> 
```

# ruby-on-rails-3.2 - 访问在单独文件中定义的 SASS 变量时出错

> ID：14678651
> 
> 赞同：1
> 
> 时间：2013-02-03T23:36:31.853
> 
> 标签：ruby-on-rails-3.2, sass

我正在尝试将 Rails 3.2 与 Sass 一起使用。我试图在我的项目中创建一个 Sass 文件来定义基于[Railscast #268](http://railscasts.com/episodes/268-sass-basics)的所有全局变量。但是由于未定义的变量，我不断收到 Sass::SyntaxError。

我有的：

应用程序.css.scss

```
/*
*= require_self
*/

@import "variables.css.scss";
@import "layout.css.scss"; 
```

变量.css.scss

```
$font_size: 14px; 
```

布局.css.scss

```
body { 
    font-size: $font_size;
} 
```

我不知道我在这里做错了什么。任何建议都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:50:53.463

您可能希望将需要此变量的 sass 文件作为部分文件（例如 _layout.css.scss），这将阻止 rails 尝试在没有依赖关系的情况下单独编译它们。

# java - ArrayAdapter 可能导致应用程序崩溃

> ID：14678657
> 
> 赞同：0
> 
> 时间：2013-02-03T23:37:21.140
> 
> 标签：java, android, listview, android-asynctask, android-arrayadapter

我在使用我的应用程序时遇到问题。我刚开始开发这个应用程序，到目前为止只用了大约 15 个小时。但我遇到了一个障碍。通常我可以用谷歌搜索障碍，我的大部分答案都来自这个论坛！

所以我希望我能找到解决方案。下面是我的活动 java 文件。这就是问题所在，因为它以前工作正常。使用数组适配器显示我的列表时遇到了很多麻烦。

```
public class Favorites extends Activity{
UserFunctions userFunctions  = new UserFunctions();
ArrayList<String> zipcodes = new ArrayList<String>(0);
ArrayAdapter<String> arrayAdapter1 =      
         new ArrayAdapter<String>(this,android.R.layout.activity_list_item,zipcodes);

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.favoritespage);

    new DownloadDataTask().execute();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main_screen, menu);
    return true;
}

   private class DownloadDataTask extends AsyncTask<JSONArray, JSONArray, ArrayList<String> > {

        @Override
        protected ArrayList<String> doInBackground(JSONArray... params) {
            JSONArray json = userFunctions.ziplistrequest("37.5", "140.45", "20");

            for(int i=0; i < json.length() ; i++) {
                JSONObject jarray = null;
                try {
                    jarray = json.getJSONObject(i);
                    String zip = jarray.getString("ZIPCODE");
                    zipcodes.add(zip);
                    arrayAdapter1.add(zip);
                    Log.d(zip,"Output");
                } catch (JSONException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
            return zipcodes;
        }   
        protected void onPostExecute(){
            ListView listView = (ListView) findViewById(R.id.listView1);
            listView.setAdapter(arrayAdapter1);
        }
    } 
```

}

现在我不知道究竟是什么导致了我的问题。我试过用谷歌搜索跟踪的各个部分无济于事。我找到了很多关于它的文章，但每一篇都与我的完全不同，所以他们的解决方案对我不起作用。下面是痕迹。

```
01-29 07:55:47.753: E/AndroidRuntime(3723): FATAL EXCEPTION: main
01-29 07:55:47.753: E/AndroidRuntime(3723): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.example.lo/com.example.lo.Favorites}: java.lang.IllegalStateException: System services not available to Activities before onCreate()
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2106)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.os.Looper.loop(Looper.java:137)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at java.lang.reflect.Method.invokeNative(Native Method)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at java.lang.reflect.Method.invoke(Method.java:511)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at dalvik.system.NativeStart.main(Native Method)
01-29 07:55:47.753: E/AndroidRuntime(3723): Caused by: java.lang.IllegalStateException: System services not available to Activities before onCreate()
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.Activity.getSystemService(Activity.java:4463)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.widget.ArrayAdapter.init(ArrayAdapter.java:310)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.widget.ArrayAdapter.<init>(ArrayAdapter.java:104)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at com.example.lo.Favorites.<init>(Favorites.java:33)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at java.lang.Class.newInstanceImpl(Native Method)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at java.lang.Class.newInstance(Class.java:1319)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.Instrumentation.newActivity(Instrumentation.java:1054)
01-29 07:55:47.753: E/AndroidRuntime(3723):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2097)
01-29 07:55:47.753: E/AndroidRuntime(3723):     ... 11 more 
```

在此期间，我将尝试解决此问题。我想我是唯一一个宁愿编程也不愿看超级碗的人：P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:39:08.117

在班级的顶部，保持

```
ArrayAdapter<String> arrayAdapter1; 
```

并移动其余部分，使其看起来像这样：

```
arrayAdapter1 = new ArrayAdapter<String>(Favorites.this,android.R.layout.activity_list_item,zipcodes); 
```

to`onCreate()`或 in `onPostExecute()`，具体取决于您要对数据做什么。

抛出异常是因为`Adapter`s（和许多 Android 组件）需要在 Activity 中初始化的某些（幕后）事物。但是，这些事情不会在`Activity`'s`onCreate()`被调用之前发生，因为`onCreate()`这是[Activity 生命周期](http://developer.android.com/images/activity_lifecycle.png)的开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:40:54.490

问题是这一行：

```
ArrayAdapter<String> arrayAdapter1 =      
     new ArrayAdapter<String>(this,android.R.layout.activity_list_item,zipcodes); 
```

在活动正确初始化之前，您不能`this`在调用中使用。`new ArrayAdapter()`您可以分配给`arrayAdapter1`inside `onCreate()`（在调用之后`super.onCreate()`，或在您的内部`DownloadDataTask`。最好在内部`onPostExecute`而不是在内部执行此操作`doInBackground`。

# javascript - 在视频元素上移动时，JQuery UI 可调整大小/可拖动会失去“抓地力”

> ID：14678658
> 
> 赞同：2
> 
> 时间：2013-02-03T23:37:46.290
> 
> 标签：javascript, jquery, jquery-ui, youtube-api, jquery-ui-resizable

我有一个嵌入了 youtube 视频的页面，我正在尝试实现一个自定义叠加层，您可以在其中使用可调整大小和可拖动`<div>`（使用 JQuery UI）定义区域。

在屏幕的其他区域拖动时`<div>`，它的响应速度非常好，但是当在视频上（使用 IFrame API 嵌入，以防它很重要）时，如果您将鼠标移动到爬行以外的任何位置，它会经常“失去控制” ' 在调整大小手柄或移动手柄上。IE 和 Chrome 都是这种情况。

这里的JSFiddle：http: [//jsfiddle.net/MfZes/1/](http://jsfiddle.net/MfZes/1/)（可拖动框位于 youtube 框架下方）

有谁知道这是为什么，或者是否可以避免？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T16:09:51.340

我以前做过。

您可以挂钩 jquery ui 的可调整大小和可拖动插件的 dragstart、resizestart、dragstop 和 resizestop 事件。

将视频放在容器 div 中。在视频旁边，插入另一个 div，它将充当叠加层。将宽度和高度设置为 100%，绝对定位并将显示设置为隐藏。

当调整大小/拖动开始事件触发时，显示覆盖 div。当他们停下来时，把它藏起来。（您需要隐藏它，因为您仍然希望能够在不调整大小或拖动时与视频进行交互。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-05T07:30:13.120

我有同样的问题，但悬停在画布上：

```
$('.DraggableDiv').draggable({
    start : function() {
        var d = document.createElement('div');
        $(d).addClass('canvas_shadow');
        $('.canvasContainer').append(d);
    },
    stop : function() {
        $( ".canvas_shadow" ).remove();
}); 
```

为 .canvas_shadow 添加 css：

```
.canvas_shadow {
  position: absolute;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  opacity: 0.1;
  z-index: 80;
} 
```

# android - cmd 无法识别 dex2jar- Android Apk

> ID：14678661
> 
> 赞同：14
> 
> 时间：2013-02-03T23:38:23.503
> 
> 标签：android, cmd, dex

我想从 apk 获取源代码并使用这个解决方案[有没有办法从 APK 文件中获取源代码？](https://stackoverflow.com/questions/3593420/android-getting-source-code-from-an-apk-file)

我尝试将文件 dex 转换为 jar，我使用了 dex2jar；但 cmd 无法识别此命令。

```
dex2jar classes.dex 
```

“dex2jar 未被识别为内部或外部命令”

dex2jar 被弃用了吗？

我可以用什么将 dex 转换为 jar？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2015-10-12T05:31:16.873

以上答案都不适合我，我可以通过以下方式让它工作， **不需要 classes.dex 文件。因此，请仔细遵循以下说明：**

1.  下载 dex2jar 的最新版本，我可以通过谷歌搜索并从 sourceforge 获得最新版本。以防万一你没有得到它[http://sourceforge.net/projects/dex2jar/](http://sourceforge.net/projects/dex2jar/)
2.  将您的 apk 文件放到 dex2jar 文件夹中。

3.  打开命令提示符[win user] 并导航到您放置 apk 文件的文件夹。

4.  输入此命令`d2j-dex2jar.bat someApk.apk`，您将获得 jar 文件[使用 jd-ui 工具读取 jar 文件] 对于 mac 用户，请参阅此 [链接中的第 4 点] 以获取合适的终端命令[http://sourceforge.net/p/dex2jar/wiki /用户指南/](http://sourceforge.net/p/dex2jar/wiki/UserGuide/)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-07-04T10:10:30.723

使用命令

`d2j-dex2jar classes.dex`

代替

`dex2jar classes.dex`

还要确保您将 dex2jar 文件提取到与您在[给定示例](https://stackoverflow.com/questions/3593420/android-getting-source-code-from-an-apk-file)的步骤 1 中保存的 apk 源文件相同的文件夹中。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-05-22T09:11:14.270

如果您使用的是 dex2jar-2.x jar 文件，则会产生问题。尝试下载[dex2jar-0.0.9.15](https://github.com/pxb1988/dex2jar/releases/tag/0.0.9.15) jar 文件，然后尝试该命令。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-31T10:26:44.770

Here are the steps I used:

*   unzipped both apk folder & dex2jar folder
*   Created a New Folder
*   Combined all apk & dex2jar files into the new folder
*   Opened command prompt & changed my directory pointing to the new folder name
*   in command prompt, I typed d2j-dex2jar classes.dex, Hit Enter
*   ....this created a new file in my new folder named classes-dex2jar.jar

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-04-10T09:45:58.467

我有同样的问题，我已经解决了，你从 GitHub 下载的文件实际上并没有编译，所以你必须先编译它，而不是编译，从[https://sourceforge.net/下载这个 zip 文件projects/dex2jar/files/dex2jar-2.0.zip/download](https://sourceforge.net/projects/dex2jar/files/dex2jar-2.0.zip/download)并执行完全相同的过程（在您在问题中引用的答案中），您将获得一个 jar 文件作为输出。该文件已经为您编译了所有资源，因此您不必手动完成这项工作！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-02-02T06:37:44.723

我在不同的文件夹中提取了 apk 和 dex。在将提取的文件复制到同一文件夹中并运行 dex2jar classex.dex 时，它起作用了。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-01T08:51:05.223

对我来说路径有问题，正确的路径是 C:\Users\username\Desktop\foldername\dex2jar>d2j-dex2jar classes.dex

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-05T13:03:12.200

我通过首先下载`dex2jar-0.0.9.1`jar 文件而不是最新的来解决它。然后我使用以下命令 `d2j-dex2jar.bat classes.dex`并确保在`dex2jar-0.0.9.15`目录中打开命令窗口。打开 cmd 的快捷方式是打开目录，然后按 shift 并右键单击目录窗口内的任意位置。然后去这里打开命令窗口。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-08-24T09:11:13.093

即使在所有这些答案之后，如果有些人有问题去文件夹

```
dex2jar-0.0.9.15\dex-tools\src\main\bin 
```

在这里你有`dex2jar.bat/sh`和`d2j-dex2jar.bat/sh`文件都在那里。

移动您的`classes.dex`并使用这些命令中的任何一个。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-05-13T06:53:49.907

1) 从此[链接](https://excellmedia.dl.sourceforge.net/project/dex2jar/dex2jar-2.0.zip)下载 dex2jar并解压到您的工作目录中。
2) 在提取的文件夹中打开命令提示符并输入 d2j-dex2jar ..\classes.dex。

您将在当前文件夹中获得**classes-dex2jar.jar 。**

# sql-server - 如何跟踪修订？

> ID：14678665
> 
> 赞同：0
> 
> 时间：2013-02-03T23:39:01.510
> 
> 标签：sql-server, nhibernate, versioning, revision-history

我正在尝试设计我的数据库，并且我希望能够跟踪更改的历史记录。

我将有一张桌子，上面有食物的所有营养成分。当用户对项目进行更改时（例如将卡路里从 100 更改为 200）。我想把它作为一个新的修订版。

这样来的人可以看到它是原来的 100 卡路里，然后更新为 200 卡路里。我想这很像堆栈现在的工作方式，您可以在其中看到已编辑的内容。

我想知道最好的方法是什么？我正在使用 sql server 和 nhibernate。

我正在考虑有另一列或其他内容作为修订号。然后每次进行修订时，数字都会增加。这是一个好方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T09:21:49.337

[NHibernate.Envers](https://bitbucket.org/RogerKratz/nhibernate.envers)可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:04:53.110

你可以按照你写的那样做，添加另一个修订号。

另一种方法是添加时间戳并将其用作历史记录。每次更新项目时，您都会添加一个包含当前值和当前时间戳的行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T02:07:48.087

我通常会使用某种形式的审计表来处理这个问题。我们目前工作的地方是将我们所有的审计表放在一个审计模式下，并且我们有一个审计表，用于我们希望跟踪修订的每一个。我们不使用 NHibernate，因此我们只使用触发器来确保对给定行的每次更新以及时间戳和用户 ID 都记录在审计表中，这样您就可以获得一些上下文和修订方式的顺序制作。

在 NHibernate 中使用触发器似乎[很困难，但您可以使用](https://stackoverflow.com/questions/6583583/how-to-tell-nhibernate-that-a-trigger-updates-another-table)[本文中提到的 NHibernate 拦截器或事件之类的](https://stackoverflow.com/a/2859017/685760)东西。我会说触发器比依赖您的代码更可取，但如果这是使用 NHibernate 的唯一方法，那么也许值得一看。

最后，我看到它提到您可以使用 SQL Server 的本机[审计](http://msdn.microsoft.com/en-us/library/dd392015%28v=sql.100%29.aspx)或跟踪功能。我自己从来没有使用过这个，但记得在 SO 上的一些帖子暗示这取代了创建你自己的手动审计表和相关触发器的需要。正如上面链接中的这句话所示，它似乎做了你想做的事；

> 可以将数据库对象上的用户、角色或组的活动审计限制在表级别。也就是说，您可以将 SQL Server 审计作为目标，以跟踪用户的特定活动，直至单个表级别。例如，SQL Server Audit 允许记录 DBO 对 Payroll 表的所有更新。

对我来说，这听起来更像是一次真正的审计，而不仅仅是修订历史，但也许在这方面有更多经验的人可以评论其用于修订跟踪的可行性。当然，你还得看看它对 NHibernate 有什么影响。

# mod-rewrite - 使用 RewriteRules 进行 301 重定向

> ID：14678669
> 
> 赞同：0
> 
> 时间：2013-02-03T23:39:13.857
> 
> 标签：mod-rewrite, redirect, http-headers

我有一个关于 RewriteRules 的问题。我想永久移动一页，所以我想使用 301 重定向。我试过这个：

```
RewriteRule ^page1/([A-Z].*)$ http://www.abs.nl/page1/vraag-$1 [R=301] 
```

但是，这不起作用。有人可以告诉我如何解决这个问题吗？我已经尝试了几个小时来找到答案。

我还应该使用 %{HTTP_HOST} 条件吗？我经常看到这个，但我不知道它是如何工作的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:08:24.600

几件事：

1.  确保`RewriteEngine On`在重写规则之前有。
2.  您当前的正则表达式正在寻找一个大写字母后跟任何字符，这是您想要的吗？

尝试这个：

```
RewriteEngine On
RewriteRule ^page/(.*)$ http://www.abs.nl/page1/vraag-$1 [R=301,L] 
```

该重定向将匹配 URL 中 page/ 之后的任何字符串。

# linux - 在单个 cron 任务上运行 10 多个 ls 命令？

> ID：14678672
> 
> 赞同：0
> 
> 时间：2013-02-03T23:39:32.697
> 
> 标签：linux, bash, shell, unix, ls

我在 cron 上运行以下命令：

```
sudo find "$VOLUME1" "$VOLUME2" "$VOLUME3" "$VOLUME4" -type f -exec ls -lT {} + > $FILE 
```

这个命令需要几个小时才能完成，因为它运行了大约百万个文件左右。

当我执行命令时，它显示了 14(!!) 个不同的运行`top`实例。`ls`这是脚本中的错误，还是导致运行这么多 ls 命令的原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:54:07.423

因为命令行长度有限，`find`不能启动单个`ls`实例超过一百万个参数。相反，它将产生多个`ls`进程，每个进程都有数千个参数。

在我的机器上，最大命令行长度似乎是 2097152，也许这也可能是 1000000/14 个文件名的大小？

```
$ getconf ARG_MAX
2097152 
```

# php - APC 将数据存储在哪里？

> ID：14678676
> 
> 赞同：4
> 
> 时间：2013-02-03T23:40:06.350
> 
> 标签：php, caching, apc

我想用来`apc_store()`缓存一些结果。

但我需要知道数据将存储在哪里，以及限制是什么。

它总是存储在内存中吗？或者也写入磁盘？我希望不经常访问的数据存储在磁盘上。我应该为此使用不同的缓存系统吗？

这是极限吗？`apc.shm_size = 32MB`. 如果是这样，当我超过它时会发生什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T23:44:43.307

存储在 APC 变量缓存中的数据`apc_store()`始终存储在内存中。如果你需要存储比这有意义的更多的数据，你需要自己想出一些其他的缓存解决方案。

`apc.shm_size`配置指令设置*整个*APC 共享内存缓存的大小，用于操作码和用户变量。如果您向缓存中写入的数据多于此处指定的数据，将从缓存中删除元素，从最近最少使用的开始。您的代码需要能够处理这个问题——毕竟它是一个缓存，而不是一个数据库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T23:44:14.683

APC 会将其存储在内存中。

您可以使用 apc.shm_size 设置要使用的大小

这是一个解释 APC 如何工作的链接。 [http://lampzone.wordpress.com/2010/03/26/how-does-apc-work/](http://lampzone.wordpress.com/2010/03/26/how-does-apc-work/)

以及所有 APC 设置的列表 [http://php.net/manual/en/apc.configuration.php](http://php.net/manual/en/apc.configuration.php)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T23:48:27.037

APC 总是将数据存储在内存中，它就是为此而设计的。您不能让 APC 将数据写入磁盘，但您当然可以实现几个不同的存储适配器以满足您的缓存需求。如果您希望将某些内容存储在磁盘上，请实现文件适配器。不同的大小设置确实是您分配给 APC 的内存量，如果超过它，APC 将开始转储 LIFO。这只会影响您的表现，不会影响其他任何事情。您的应用需要能够在有或没有缓存的情况下运行。如果不是这种情况，那么您就是在滥用缓存以实现持久性的想法。

# perl - 使用 moose 从 perl 中的对象数组调用对象方法

> ID：14678682
> 
> 赞同：1
> 
> 时间：2013-02-03T23:40:54.363
> 
> 标签：perl, oop, moose

我有一个对象具有另一组对象的数组的属性。我有一个 toString 方法，我想打印出对象的全部内容。主要目标是让 Job 对象调用数组中的所有后处理作业。我也想在对象数组中的对象上调用 toString 方法。目前，我收到此错误：

`Can't call method "toString" without a package or object reference at JobClass.pm line 52, <JOBFILE> line 5\. (which is $item->toString(); in the foreach loop)`

$item 上的 Dumper 显示以下内容：

```
$VAR1 = bless( {
             'ImportID' => '22',
             'ImportTableID' => '1234',
             'ImportTable' => 'testImport'
           }, 'PostJob' ); 
```

我试图理解的主要目标是如何调用从成员数组返回的对象的方法。

以这种方式实例化的类：

```
    我的 $postJob = PostJob->new(ImportTable => "testImport",ImportTableID => "1234", ImportID => "22");
    我的@postJobs =“”；
    推（@postJobs，$postJob）；
    $postJob->toString(); #这很好用
    我的 $job = Job->new(DirectoryName => "testDir",StagingTableName => "stageTable", QBStagingTableID => "5678",postProcessJobs => \@postJobs);
    $job->toString(); #Breaks 上面有错误

```

代码如下：

```
    打包 PostJob；
    使用驼鹿；
    使用严格；
    使用 Data::Dumper；

    有 'ImportTable' => (isa => 'Str', is => 'rw', required => 1);
    有 'ImportTableID' => (isa => 'Str', is => 'rw', required => 1);
    有 'ImportID' => (isa => 'Str', is => 'rw', required => 1);

    子字符串 {
     # 打印所有值
     我的 $self = 班次；；
    print "Post Job 的表名是 ".$self->ImportTable."\n";
    print "Post Job 的表 ID 是 ".$self->ImportTableID."\n";
    print "Post Job 的导入 ID 是 ".$self->ImportID."\n";
    }

    打包作业；

    使用严格；
    使用 Data::Dumper；
    使用驼鹿；

    有 'DirectoryName' => (isa => 'Str', is => 'rw', required => 1);
    有 'StagingTableName' => (isa => 'Str', is => 'rw', required => 1);
    有 'StagingTableID' => (isa => 'Str', is => 'rw', required => 1);
    有 'postProcessJobs'=> (isa => 'ArrayRef', is => 'rw', required => 0);

    子 addPostJob {
     我的 ($self,$postJob) = @_;
     推(@{$self->postProcessJobs()},$postJob);

    }

    子字符串
     {
     # 打印所有值。
     我的 $self = 班次；
     print "转储作业对象内容**********************************\n";
     print "目录是".$self->DirectoryName."\n";
     print "Staging Table is ".$self->StagingTableName."\n";
     print "Staging Table ID is ".$self->StagingTableID."\n";

        打印“转储岗位工作内容**********************************\n”；   
        foreach 我的 $item (@{$self->postProcessJobs()})
            {

                $item->toString();
                打印自卸车（$项目）；
            }
        打印“结束转储作业*******************************\n”；    
    }

    1个；

```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:59:17.893

问题出在以下行：

```
my @postJobs =""; 
```

这将创建数组的第一个成员，但该成员不是作业，它是一个空字符串。将其替换为

```
my @postJobs; 
```

并且错误消失了。

# perl - 如何将字符串变量作为“查询”传递给 get Manager 调用？

> ID：14678683
> 
> 赞同：0
> 
> 时间：2013-02-03T23:41:18.953
> 
> 标签：perl, mason, rose-db-object

我正在尝试打这个简单的电话：

```
DataB::testTable::Manager->get_testTable( query => [ id => $id, name => $name ] ) 
```

效果很好。但是是否可以为查询传递一个变量。就像是：

```
$query = "id => $id , name => $name";
DataB::testTable::Manager->get_testTable( query => [ $query ] ); 
```

或类似的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:50:06.797

字符串和复杂的数据结构是完全不同的东西。

字符串是一系列代码点/字素/字节（取决于您的外观）。弦是哑的。字符串不擅长包含复杂和/或分层数据。（以防万一：XML 是纯粹的痛苦）

但是，您可以使用引用将任何 Perl 数据结构放入标量变量中。方括号创建对匿名数组的引用。

这些行组是等价的，只是引入了一个变量名：

```
DataB::testTable::Manager->get_testTable( query   => [ id => $id, name => $name ] );

my @query = (id => $id, name => $name);
DataB::testTable::Manager->get_testTable(query => \@query); # the "\" takes a reference to a value

my @query = (id => $id, name => $name);
DataB::testTable::Manager->get_testTable(query => [@query]); # using "[]" to make the arrayref. The reference points to a copy of @query.

# this solution is probably best:
my $query = [ id => $id, name => $name ]; # "[]" makes an arrayref
DataB::testTable::Manager->get_testTable(query => $query); 
```

使用对数据结构的引用比使用字符串更好。

（您可以通过 将字符串解释为 Perl 源代码`eval`。这非常强大，但并非所有内容都可以字符串化为可以评估为等效数据结构的形式。不要使用字符串评估，除非经过深思熟虑的元编程.)

有关引用和复杂数据结构的更多信息，[perlref](http://perldoc.perl.org/perlref.html)、[perlreftut](http://perldoc.perl.org/perlreftut.html)和[perldsc](http://perldoc.perl.org/perldsc.html)可能会很有趣。

# file-upload - 如何给客户端使用 Meteor 上传的结果？

> ID：14678691
> 
> 赞同：1
> 
> 时间：2013-02-03T23:42:45.737
> 
> 标签：file-upload, meteor

我不确定以前是否有人问过这个问题，我一直在浏览互联网寻找有关文件上传的答案，但找不到合适的答案。事情是这样的：我想将文件上传到服务器。这没关系。我发现大量讨论讨论如何将文件上传到服务器。

现在我的问题是我无法找到一种方法来告诉客户端文件已有效上传或者是否有错误......我一直在客户端上尝试， `Meteor.call('methodName', args, function(error, result){//some code});`在服务器上使用这个：

```
Meteor.methods({
    saveFile: function (blob, name, path, encoding) {
        var fs = __meteor_bootstrap__.require('fs');
        var path = badgesHelper.cleanPath(path);
        var name = badgesHelper.cleanName(name || 'file');
        var encoding = encoding || 'binary';
        path = Meteor.chroot + path + '/';
        console.log(path, name, encoding);

        var uploadResult = {success: false};

        fs.writeFile(path + name, blob, encoding, function (error) {
            if (error) {
                uploadResult.error = error
                Meteor.Error(500, 'An error occurred');
            } else {
                var date = new Date();
                uploadResult.success = true;
            }
        });
        return uploadResult;
    }
}); 
```

而且我只是找不到将uploadResult映射发送到客户端的方法。由于调用是异步的，节点在调用回调函数之前点击“返回”并且uploadResult具有函数的真实结果......我不想使用filepicker.io我需要知道如何做到这一点任何包裹。

如果我做错了，请指教，因为现在我被困在那里......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:11:39.130

这里不需要映射，因为您只返回一个`boolean`值，您可以直接返回它。如果出现错误，您可以直接抛出它而不是`false`. 此外，您必须`throw new Meteor.Error()`而不是仅仅`Meteor.Error()`.

修改后的代码：

```
Meteor.methods({
    saveFile: function (blob, name, path, encoding) {
        var fs = __meteor_bootstrap__.require('fs');
        var path = badgesHelper.cleanPath(path);
        var name = badgesHelper.cleanName(name || 'file');
        var encoding = encoding || 'binary';
        path = Meteor.chroot + path + '/';
        console.log(path, name, encoding);

        var uploadResult = false;

        fs.writeFile(path + name, blob, encoding, function (error) {
            if (error) {
                // EDIT: Throws an error
                // error.error = 500; error.reason = "An error occurred";
                throw new Meteor.Error(500, 'An error occurred');
            } else {
                // result = true
                return true;
            }
        });
    }
}); 
```

# three.js - 手动将 Three.js JSON 几何文件从 r42 升级到 r55

> ID：14678692
> 
> 赞同：1
> 
> 时间：2013-02-03T23:42:50.137
> 
> 标签：three.js

我有一些定义几何的 JSON 文件，这是 Three.js`JSONLoader`类的 r42 所要求的。这些文件是格式的第 2 版。

在版本之间手动更新这些文件是否可行？

第一个明显的区别是文件不再是 JavaScript，而是实际的 JSON。这很容易纠正。然而，新格式有一个`metadata`部分，三十分钟的实验并没有让我有任何收获。

我看到问题是因为`Geometry`对象的`material`属性有一个空`materials`数组。生成的几何图形具有不同材料的多个部分，如 r42 所示。

有谁知道我可以如何手动调整这些 .json 文件以使用 r55？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T08:44:46.743

我不完全了解格式的内部结构是如何变化的，但这里有一些提示：

*   如果您有源对象，最好的方法是重新导出/转换。如果您的源格式晦涩难懂，现在还应该有更多的转换器和导出器可供使用。如果来源未知，一些谷歌搜索可能是值得的。
*   `metadata`部分无关紧要，它不用于加载程序中的任何内容。
*   没有了`Geometry.materials`。相反，JSONLoader 的回调将加载的材料作为单独的参数返回给回调。有关更多信息，请参阅[迁移指南](https://github.com/mrdoob/three.js/wiki/Migration)(r52->r53)。事实上，加载程序接口在 r46 中也发生了变化。
*   `git log`一些示例模型文件（如果您真的需要手动迁移，搜索更改可能是您前进的方向）表明可能存在例如 UV 翻转，这将难以手动修复，但可以在代码中解决。但首先你需要在屏幕上显示一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T09:42:16.373

尝试将文件拖入[编辑器](http://mrdoob.github.com/three.js/editor/)，然后执行`File/Export Geometry`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T19:48:55.457

这是拖放到编辑器中的修复。在 index.html 中的 drop 事件之前添加此代码。我在 OSX 中的 Chrome ( 24.0.1312.56 )、Safari 和 Firefox 中对此进行了测试。

```
 document.addEventListener("dragover", function(e) {
            e.preventDefault();
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T16:08:17.183

@mrdoob 的答案在对编辑器进行了几个补丁后起作用（[这里](https://github.com/mrdoob/three.js/commit/5852cab635c031a0209e1d0d12f24518c920dfd8)和[这里](https://github.com/mrdoob/three.js/commit/6d080240ebd2bc0626075fd6a34e66edc6fbbd1e#editor/index.html)。）

但是值得注意的是，可以在文本编辑器中手动升级文件，尤其是在您没有任何 UV 坐标的情况下。

*   早期版本不使用 JSON——它们是 JavaScript 文件。转换很简单。
*   您可以忽略该`metadata`部分，也可以将其从评论中移植到对象中。
*   如果您确实有 UV 坐标，那么它们必须以不同方式映射（我相信轴被翻转）

# php - XPATH - 使用 getAttribute 保留空格

> ID：14678699
> 
> 赞同：0
> 
> 时间：2013-02-03T23:43:50.267
> 
> 标签：php, xpath

**HTML**

```
<input type='text' name='title[]' value='Some word and another'> 
```

**PHP**

```
$title = $xpath->query('//input')->item(0); 
echo $title = $title->getAttribute('value') 
```

**结果**

> 一些

**我需要得到**

> 一个字一个字

**问题** 由于某种原因，第一个空间之后的所有内容都被删除了..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:47:46.220

确保将其加载为 HTML，以便它允许您使用单引号：

```
$dom = new DOMDocument;
$dom->loadHTML("<input type='text' name='title[]' value='Some word and another'>");

$xpath = new DOMXpath($dom);

echo $xpath->query('//input')->item(0)->getAttribute('value'); 
```

在这里查看它的实际操作：[http ://codepad.viper-7.com/pcs3or](http://codepad.viper-7.com/pcs3or)

# c# - EF 4.3 Azure 和本地开发之间的行为不同

> ID：14678704
> 
> 赞同：0
> 
> 时间：2013-02-03T23:45:00.987
> 
> 标签：c#, asp.net-mvc, azure, entity-framework-4, azure-web-roles

我刚刚将在本地运行良好的 Web 应用程序部署到 Windows Azure，我遇到了一个令人困惑的错误。在 Azure 上，我的代码在以下行中失败：

```
 context.Dogs.Add(entity); 
```

我得到的错误是：

**收藏已修改；枚举操作可能无法执行**

我知道有一个已知的错误（[实体框架集合已修改；枚举操作可能无法执行](https://stackoverflow.com/questions/12250868/entity-framework-collection-was-modified-enumeration-operation-may-not-execute)），但有没有人有任何见解为什么它会在本地运行良好，但在 Azure 上却不行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T22:05:17.890

安装 .Net 4.5 会更改 .NET 4.0，并修复 .NET Framework 中的错误，即使是针对 4.0 的应用程序也是如此。

这可能包括您的应用程序展示的行为。

尝试在 Azure 上定位 4.5，以确保您部署的应用程序也收到这些修复。

除非您部署到已安装或可以安装 .NET 4.5 的环境，否则您*永远不*应该将其安装在您的开发 PC 上，以避免由“静默修复”引起的此类错误。

# syntax-highlighting - Sublime Text 2 运算符突出显示

> ID：14678705
> 
> 赞同：1
> 
> 时间：2013-02-03T23:45:01.280
> 
> 标签：syntax-highlighting, sublimetext2, operator-keyword

只是想知道如何在 Sublime Text 2 中添加运算符突出显示。默认主题都没有突出显示运算符，Monokai 的 tmLanguage 文件似乎也没有任何运算符选项。谁能告诉我如何做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-03T19:54:03.607

我不认为突出显示可以完成我一般。但是，这可以通过创建（或编辑）.tmLanguage 文件来针对特定语法完成（参考可以在这个答案中找到：[https](https://stackoverflow.com/a/11288058/4207760) ://stackoverflow.com/a/11288058/4207760 ）。

例如通过添加 =| 到标准 C.tmLanguage 文件中的（正则表达式）匹配键：

```
<key>match</key>
<string>\b(break|case|continue|default|do|else|for|goto|if|_Pragma|return|switch|while)\b</string> 
```

这变成：

```
<key>match</key>
<string>\b(=|break|case|continue|default|do|else|for|goto|if|_Pragma|return|switch|while)\b</string> 
```

并且所有等号 (=) 现在都像“if”、“else”、“for”等一样突出显示。

# c - 如果 jiffies 的分辨率为毫秒，usecs_to_jiffies 如何将 usecs 转换为 jiffies？

> ID：14678709
> 
> 赞同：0
> 
> 时间：2013-02-03T23:45:34.850
> 
> 标签：c, linux, timer, linux-kernel

从[这里](http://www.kernel.org/doc/man-pages/online/pages/man7/time.7.html)：

> HZ 的值因内核版本和硬件平台而异。在 i386 上情况如下：在 2.4.x 及以下的内核上，HZ 为 100，给出的 jiffy 值为 0.01 秒；从 2.6.0 开始，HZ 提高到 1000，即 0.001 秒。从内核 2.6.13 开始，HZ 值是内核配置参数，可以是 100、250（默认值）或 1000，产生的 jiffies 值分别为 0.01、0.004 或 0.001 秒。从内核 2.6.20 开始，可以使用更多频率：300，这是一个可平均划分常见视频帧速率（PAL，25 HZ；NTSC，30 HZ）的数字。

那么我该如何转换`5usec`为`jiffies`?

```
extern unsigned long usecs_to_jiffies(const unsigned int u); 
```

它似乎没用，因为 jiffies 分辨率不足以测量微秒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T01:58:17.477

如有疑问，请阅读代码！

在这里（它的一个版本可以在[这里](http://lxr.linux.no/#linux+v3.7.5/kernel/time.c#L470)找到）：

```
unsigned long usecs_to_jiffies(const unsigned int u)
{
    if (u > jiffies_to_usecs(MAX_JIFFY_OFFSET))
        return MAX_JIFFY_OFFSET;
#if HZ <= USEC_PER_SEC && !(USEC_PER_SEC % HZ)
    return (u + (USEC_PER_SEC / HZ) - 1) / (USEC_PER_SEC / HZ);
#elif HZ > USEC_PER_SEC && !(HZ % USEC_PER_SEC)
    return u * (HZ / USEC_PER_SEC);
#else
    return (USEC_TO_HZ_MUL32 * u + USEC_TO_HZ_ADJ32)
        >> USEC_TO_HZ_SHR32;
#endif
} 
```

所以，它会做一些事情来检查是否有捷径，如果没有其他工作，就用一些 64 位数学计算出来。

但是 5usec 将是一个 jiffies，无论它运行哪一段代码。

# c# - IMGUR 照片上传 POST 请求

> ID：14678710
> 
> 赞同：2
> 
> 时间：2013-02-03T23:45:43.793
> 
> 标签：c#, http, post, request, imgur

我想做的是使用他们的 API 将照片上传到 imgur 网站[http://api.imgur.com/endpoints/image#image-upload](http://api.imgur.com/endpoints/image#image-upload)。正如我在文档中所读到的，图像数据必须在“图像”参数中。所以我正在做的是将 POST 请求数据设置为“image=base64codedfile&title=blabla&type=base64”，它确实上传了它，但文件已损坏。如果我的请求将只包含“base64codedfile”而没有图像、标题、类型名称参数，它的工作就像一个魅力。难道我做错了什么？

如果我将其设置为：

```
string postData = "image="+Convert.ToBase64String(image)+"&type=base64&title=test; 
```

图像已损坏

如果它只是原始数据：

```
string postData = Convert.ToBase64String(image); 
```

它正在工作

整个代码是这样的：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("https://api.imgur.com/3/upload.xml");
request.Headers.Add("Authorization", "Client-ID >>myclientid<<");
request.Method = "POST";

string filePath = "d:\\test.jpg";
FileStream file = new FileStream(filePath, FileMode.Open);
byte[] image = new byte[file.Length];
file.Read(image, 0, (int)file.Length);
ASCIIEncoding enc = new ASCIIEncoding();
string postData = Convert.ToBase64String(image);
byte[] bytes = enc.GetBytes(postData);

request.ContentType = "application/x-www-form-urlencoded";
request.ContentLength = bytes.Length;

Stream writer = request.GetRequestStream();
writer.Write(bytes, 0, bytes.Length);

HttpWebResponse response = (HttpWebResponse)request.GetResponse(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:54:03.173

我也在尝试做同样的事情并且也面临着这个问题......

我有一个解决方案...

上传您的图片后，使用**response.getresponsestream(** )....获取图片的 id。然后使用此 id 更新该图片..不要忘记使用 imgur api 更新图片..要了解有关更新 imgur 图片的更多信息，请访问此[链接](http://api.imgur.com/endpoints/image#image-upload%5C)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-29T19:57:02.153

我的解决方案：

```
 using (var reader = new StreamReader(response.GetResponseStream()))
        {
            var objText = reader.ReadToEnd();
        } 
```

在对象文本中，您将找到 json 响应

# adobe-illustrator - 如何在 Illustrator Extendscript 中使用 aiBringToFront？

> ID：14678712
> 
> 赞同：0
> 
> 时间：2013-02-03T23:45:54.917
> 
> 标签：adobe-illustrator, extendscript

在 Illustrator 中，我想在我的一个脚本中创建一个函数，用于“放在*前面”*。在 CS5 类型库中，我找到了该对象，`AiZOrderMethod.aiBringToFront`但是，我不知道如何使用它。

到目前为止，这是我想出的：

```
//BringToFront

mySelection = activeDocument.selection;
    if (mySelection.length>0){
        var doc = app.activeDocument;                   //current document
        var s    = doc.selection;                              //current slection
        var sl   = s.length;                                     //number of selected objects
        s.AiZOrderMethod.aiBringToFront();

        //for(var i = 0 ; i < sl; i++) s[i].aibringtofront();   //for each selected element...
        app.redraw();
    }else{
        alert("Nothing selected!")
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T14:40:03.463

`app.activeDocument.selection`是一个`Array`

尝试这个：

```
var doc = app.activeDocument;  //current document
var sel = doc.selection;       // array
var sl   = sel.length;       //number of selected objects

    if (sl>0){
        for(var i = 0 ; i < sl; i++){
            // for every item in selection array
          sel[i].zOrder(ZOrderMethod.BRINGTOFRONT);
            }
        app.redraw();
    }else{
        alert("Nothing selected!")
} 
```

# asp.net - 如何更改 ViewResult 的内容

> ID：14678714
> 
> 赞同：0
> 
> 时间：2013-02-03T23:46:26.597
> 
> 标签：asp.net, asp.net-mvc-3, razor, viewresult

```
bool isChecked = false;
<input type="checkbox" name="x" checked="@isChecked" /> 
```

在 MVC 4 中，上述代码将生成为

```
<input type="checkbox" name="x" /> 
```

但是在 MVC 3 中，需要这样写：

```
bool isChecked = false;
@if(isChecked)
{
   <input type="checkbox" name="x" checked="checked" /> 
}
else
{
    <input type="checkbox" name="x" /> 
} 
```

如果我们是微软开发者，需要修改哪些程序集，如何修改？如何自定义升级代码？请帮助我，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:05:47.993

老实说，我真的不明白这些代码块之后的问题，但我可以说您可以在 ASP.NET MVC3 的视图中使用内联条件。像这样的东西，例如：

```
bool isChecked = false;
<input type="checkbox" name="x" @(isChecked ? "checked=checked" : "") /> 
```

它更短，它会产生这样的代码：

```
<input type="checkbox" name="x"> 
```

顺便说一句，有一个辅助方法`Html.CheckBox`可以在您的视图中创建复选框，在第二个参数中您可以指示是否要检查它：

```
@{bool isChecked = false;}    
@Html.CheckBox("x", isChecked) 
```

这将渲染：

```
<input id="x" type="checkbox" value="true" name="x">
<input type="hidden" value="false" name="x"> 
```

自己试试吧。

# c# - 嵌入式 MongoDB 文档在使用 C# 驱动程序保存时未获得 ID

> ID：14678718
> 
> 赞同：4
> 
> 时间：2013-02-03T23:46:54.770
> 
> 标签：c#, mongodb, mongodb-.net-driver

当我有一个包含文档列表的根文档并保存/插入时，根文档总是从 MongoDB 获取一个 ID，但列表中的文档没有，它们与`ObjectId.Empty`. 我不确定我做错了什么还是这是故意的行为？

这是我正在尝试做的一个例子：给定类：

```
public class Foo
{
    public ObjectId Id { get; set; }
    public string Name { get; set; }
    public IList<Bar> Bars { get; set; }
}

public class Bar
{
    public ObjectId Id { get; set; }
    public string Name { get; set; }
} 
```

与工厂：

```
public class Factory
{
    public Foo CreateFoo(string name)
    {
        return new Foo {
            Id = new ObjectId(),
            Name = name,
            Bars = new List<Bar>()
        };
    }

    public Bar CreateBar(string name)
    {
        return new Bar {
            Id = new ObjectId(),
            Name = name
        };
    }
} 
```

当我运行这样的示例时：

```
public class Program
{
    static void Main(string[] args)
    {
        var client = new MongoClient("mongodb://localhost");
        var server = client.GetServer();
        var database = server.GetDatabase("Example1");
        if (!database.CollectionExists("foos")) database.CreateCollection("foos");

        var factory = new Factory();
        var foo1 = factory.CreateFoo("first");
        foo1.Bars.Add(factory.CreateBar("bar"));
        var collection = database.GetCollection("foos");
        collection.Insert(foo1);

        var foo2 = factory.CreateFoo("second");
        collection.Insert(foo2);
        foo2.Bars.Add(factory.CreateBar("bar"));
        collection.Save(foo2);
    }
} 
```

`foo1`和`foo2`get都是`_id`由 MongoDB 生成的，但都没有`Bars`。所有的`Bars`仍然有`ObjectId.Empty`。现在一个简单的解决方案是更新工厂以使用`ObjectId.GenerateNewId()`，但我会觉得它是从数据库生成的更舒服。有人对此有任何见解吗？难道我做错了什么？这甚至可能吗？感谢您的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:23:07.130

这是预期的行为。每个文档（不是子文档）都有一个 _id，如果为空则自动分配。

您要么需要单独的 Bars 集合并从 Foo 文档中引用它，要么手动生成 ObjectId。

如果你是从工厂 [或存储库] 做的，那么它会很可靠。

编辑：

此外，如果您使用

```
[BsonRepresentation(BsonType.ObjectId)]
string Id {get;set;} 
```

这意味着您可以更轻松地访问 objectId 值，它仍然会保存在 ObjectId 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T20:25:04.497

`_id`仅当字段被标识为集合时，驱动程序才会为您生成 Id 字段。在您的情况下，`Bar`嵌入在`Foo`文档中。

`Bar`因此，拥有一个自动生成的 Id 字段是没有意义的。

在您的示例中，确实没有理由`Bar`拥有唯一的`_id`. 当您查询集合时，您将基于`_id`of 进行查询，`Foo`并且您将`Bar`在响应中获得可用的对象。

这绝对是预期的行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-25T09:59:32.327

有一种常见的情况是更新或删除嵌入文档集合的一个元素。唯一的方法是依赖 id。

目前我已经构建了一个自定义的 IIdGenerator 并将其分配给 IdMemberMap，但它只被调用用于根文档。

有没有其他方法可以为嵌入文档生成自动 ID？

# performance - Kinect 颜色和深度流性能

> ID：14678719
> 
> 赞同：1
> 
> 时间：2013-02-03T23:47:00.103
> 
> 标签：performance, colors, xna, kinect

我正在开发 XNA 游戏。在我的游戏中，我使用 Kinect`Color Stream`并`Depth Stream`仅获取玩家的图像。为此，我检查深度像素并找到带有`PlayerIndex > 0`. 然后我用方法将这些深度点映射到颜色点，`MapDepthPointToColorPoint`并从彩色视频中获取这些像素的颜色。

这可以正常工作，但性能非常糟糕（尤其是在游戏中）。当我关闭颜色流并将像素设置为黑色（我的意思是带有播放器索引的像素）时，一切都很顺利。但是当我启用颜色流时它不是很有效。

我为此尝试了两件事`AllFramesReady`：

1-

```
 using (ColorImageFrame colorVideoFrame = imageFrames.OpenColorImageFrame()) 
   {
      //color logic
   }
   using (DepthImageFrame depthVideoFrame = imageFrames.OpenDepthImageFrame()) 
   {
      //depth logic 
   } 
```

和

2-

```
 using (ColorImageFrame colorVideoFrame = imageFrames.OpenColorImageFrame()) 
   {
      colorReceived=true;
   }
   if (colorReceived){
      //color logic
   }
   using (DepthImageFrame depthVideoFrame = imageFrames.OpenDepthImageFrame()) 
   {
      depthReceived=true; 
   }
   if (depthReceived){
      //depth logic
   } 
```

第二个似乎有更好的性能，因为它在`using`块之外应用颜色和深度逻辑，并尽快将资源返回给 Kinect。但是当第二个玩家出现时，性能会急剧下降。但有时当我使用第二种选择时，播放器的图像会消失 1 或 2 帧。

我还能做些什么来提高颜色和深度流的性能？谢谢你的帮助。

# javascript - 如何从 Node.js 中的另一个文件正确创建原型对象？

> ID：14678721
> 
> 赞同：2
> 
> 时间：2013-02-03T23:47:25.113
> 
> 标签：javascript, node.js

我在 Node.js 中遇到了一个非常令人沮丧的问题。

我将从我正在做的事情开始。

我在文件中创建一个对象，然后导出构造函数并在其他文件中创建它。

我的对象定义如下：

**文件 1：**

```
var Parent = function() {};

Parent.prototype = {
     C: function () { ... }
}

module.exports = Parent; 
```

**文件 2：**

```
var Parent = require('foo.js'),
      util = require('util'),
      Obj = function(){ this.bar = 'bar' };
util.inherits(Obj, Parent);
Obj.prototype.A = function(){ ... };
Obj.prototype.B = function(){ ... };
module.exports = Obj; 
```

我正在尝试在另一个文件中使用该对象

**文件 3：**

```
var Obj = require('../obj.js'),
      obj = new Obj();

obj.A(); 
```

我收到错误：

```
TypeError: Object [object Object] has no method 'A' 
```

但是，当我运行 Object.getPrototypeOf(obj) 时，我得到：

```
{ A: [Function], B: [Function] } 
```

我不知道我在这里做错了什么，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T00:42:29.073

我无法重现您的问题。这是我的设置：

**父.js**

```
var Parent = function() {};

Parent.prototype = {
  C: function() {
    console.log('Parent#C');
  }
};

module.exports = Parent; 
```

**child.js**

```
var Parent = require('./parent'),
    util = require('util');

var Child = function() {
  this.child = 'child';
};

util.inherits(Child, Parent);

Child.prototype.A = function() {
  console.log('Child#A');
};

module.exports = Child; 
```

**main.js**

```
var Child = require('./child');
child = new Child();

child.A();
child.C(); 
```

并运行`main.js`：

```
$ node main.js
Child#A
Parent#C 
```

源代码可通过 Git 在以下 Gist 克隆：[https ://gist.github.com/4704412](https://gist.github.com/4704412)

* * *

旁白：澄清`exports`vs`module.exports`讨论：

如果要将*新属性附加*到导出对象，可以使用`exports`. 如果您想*将导出完全重新分配给一个新值*，您可以使用`module.exports`. 例如：

```
// correct
exports.myFunc = function() { ... };
// also correct
module.exports.myFunc = function() { ... };

// not correct
exports = function() { ... };
// correct
module.exports = function() { ... }; 
```

# ios - UICollectionView 上的 UIRefreshControl 仅在集合填充容器的高度时才有效

> ID：14678727
> 
> 赞同：148
> 
> 时间：2013-02-03T23:48:15.017
> 
> 标签：ios, uicollectionview, uirefreshcontrol

我正在尝试将 a 添加`UIRefreshControl`到 a `UICollectionView`，但问题是刷新控件不会出现，除非集合视图填满其父容器的高度。换句话说，除非集合视图足够长以至于需要滚动，否则它不能被拉下以显示刷新控制视图。一旦集合超过其父容器的高度，它就会被拉下并显示刷新视图。

我已经建立了一个快速的 iOS 项目，其中只有一个`UICollectionView`内部主视图，有一个到集合视图的出口，以便我可以将其添加`UIRefreshControl`到`viewDidLoad`. 还有一个带有重用标识符的原型单元`cCell`

这是控制器中的所有代码，它很好地展示了这个问题。在这段代码中，我将单元格的高度设置为 100，这不足以填充显示，因此无法拉出视图并且不会显示刷新控件。将其设置为更高的值以填充显示，然后它就可以工作了。有任何想法吗？

```
@interface ViewController () <UICollectionViewDelegateFlowLayout, UICollectionViewDataSource>
@property (strong, nonatomic) IBOutlet UICollectionView *collectionView;
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    UIRefreshControl *refreshControl = [[UIRefreshControl alloc] init];
    [self.collectionView addSubview:refreshControl];
}

-(NSInteger)numberOfSectionsInCollectionView:(UICollectionView *)collectionView {
    return 1;
}

-(NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {
    return 1;
}

-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath {
    return [collectionView dequeueReusableCellWithReuseIdentifier:@"cCell" forIndexPath:indexPath];
}

-(CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout *)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {
    return CGSizeMake(self.view.frame.size.width, 100);
} 
```

* * *

## 回答 #1

> 赞同：403
> 
> 时间：2013-02-04T18:59:33.050

试试这个：

`self.collectionView.alwaysBounceVertical = YES;`

一个完整的代码`UIRefreshControl`

```
UIRefreshControl *refreshControl = [[UIRefreshControl alloc] init];
refreshControl.tintColor = [UIColor grayColor];
[refreshControl addTarget:self action:@selector(refershControlAction) forControlEvents:UIControlEventValueChanged];
[self.collectionView addSubview:refreshControl];
self.collectionView.alwaysBounceVertical = YES; 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-12-13T09:04:07.267

Storyboard/Xib 中的属性/滚动视图/垂直弹跳

[![在此处输入图像描述](../Images/d919be64efd7dde5b963d3d1e9936d4b.png)](https://i.stack.imgur.com/fFXXq.png)

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-10-20T21:19:55.533

拉里迅速回答：

```
 let refreshControl = UIRefreshControl()
    refreshControl.tintColor = UIColor.blueColor()
    refreshControl.addTarget(self, action: "refresh", forControlEvents: .ValueChanged)
    collectionView.addSubview(refreshControl)
    collectionView.alwaysBounceVertical = true 
```

斯威夫特 3：

```
 let refreshControl = UIRefreshControl()
    refreshControl.tintColor = .blue
    refreshControl.addTarget(self, action: #selector(refresh), for: .valueChanged)
    collectionView.addSubview(refreshControl)
    collectionView.alwaysBounceVertical = true 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-22T05:17:18.837

如果您`collectionview`的内容大小足以垂直滚动，那没关系，但在您的情况下不是。

您必须启用该属性`AlwaysBounceVertical`，以便您可以设置`self.collectionView.alwaysBounceVertical = YES;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-29T06:36:25.060

`UIRefreshControl`我也面临同样的问题，直到`UICollectionView`' 的内容大小足够大可以垂直滚动，我才能使用，

设置`bounces`属性`UICollectionView`解决了这个

```
[self.collectionView setBounces:YES];
[self.collectionView setAlwaysBounceVertical:YES]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-17T06:13:45.327

我在`beginRefreshing()`之后马上打电话`viewDidLoad()`，但在某些屏幕上它不起作用。只有`collectionView.layoutIfNeeded()`在`viewDidLoad()`帮助我

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-06T08:15:41.297

如果集合视图处于刷新状态，则必须检查 api 调用，然后结束刷新以解除刷新控制。

```
private let refreshControl = UIRefreshControl()
 refreshControl.tintColor = .white
 refreshControl.addTarget(self, action: #selector(refreshData), for: .valueChanged)
 collectionView.addSubview(refreshControl)
 @objc func refreshData() {
    // API Call
 }
// Disable refresh control if already refreshing 
if refreshControl.isRefreshing {
    refreshControl.endRefreshing()
} 
```

# bash - 如何在bash中连接到wifi？

> ID：14678730
> 
> 赞同：1
> 
> 时间：2013-02-03T23:48:44.253
> 
> 标签：bash, passwords, wifi

我想制作一个简单的 bash 脚本来连接到已知的 wifi 网络。到目前为止，我...

```
#!/bin/bash
NETWORK_ID=${1:myintranet}
WIRELESS_KEY=${2:""}
WIRELESS_DEVICE=${3:wlan0}

if [ ! -n "$WIRELESS_KEY" ]; then
        read -s -p "Enter Password: " WIRELESS_KEY
fi
#ifconfig wlan0
iwconfig wlan0 essid $NETWORK_ID key s:$WIRELESS_KEY
dhclient wlan0 
```

我在请求时输入网络的纯文本密码，但失败并出现错误
`iwconfig: unknown command "s:myPassword"`

但我找不到任何理由为什么它应该期待一个命令而不是将密钥转换为十六进制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T14:00:44.903

这对我来说适用于 WEP wifi。不要忘记使用 .sh 扩展名命名脚本。

```
#!/bin/bash
NETWORK_ID=${1:myintranet}
WIRELESS_KEY=${2:xxx}
WIRELESS_DEVICE=${3:wlan0}

if [ -z "$WIRELESS_KEY" ]; then
        read -s -p "Enter Password: " WIRELESS_KEY
fi
#ifconfig wlan0
iwconfig wlan0 essid $NETWORK_ID key s:$WIRELESS_KEY
dhclient wlan0 
```

对于 WPA wifi，它可能无法正常工作。考虑使用[wpa_supplicant](http://wiki.debian.org/WiFi/HowToUse#wpa_supplicant)或使用 wicd (wicd-gtk) 配置它

# c# - PetaPoco (DotNetNuke) 和 SQL - 添加具有 List 属性的对象或其他复合对象

> ID：14678733
> 
> 赞同：3
> 
> 时间：2013-02-03T23:49:03.813
> 
> 标签：c#, sql, json, dotnetnuke, petapoco

我正在使用基于 PetaPoco (DotNetNuke 7.0) 的数据访问层。在处理相对简单的对象时，我已经成功地使用了它，但是我现在必须插入一个对象，该对象至少包含一个属性，该属性是其他对象的列表。

例如：

```
class Person
{
   public Person(){}
   public string name { get; set; }
   public List<Address> addresses { get; set; }
}
class Address
{
   ...
} 
```

我正在使用的实际对象比上面的示例复杂得多 - 对象中至少有四个复合 List 对象要插入到存储库中。

我想做的是在 SQL 中定义表，并能够像这样对 PetaPoco 进行简单的调用：

```
public static void AddOrder(Person person)
{
    using (IDataContext context = DataContext.Instance())
    {
        var repository = context.GetRepository<Person>();
        repository.Insert(person);
    }
} 
```

其背景是对象从 Knockout/jQuery 前端传递到 Web 服务，因此 JSON 字符串被转换为数据对象，然后必须将其存储在数据库中。

我觉得真的有三个问题：

1.  如何编写代表 Person 和包含的地址列表的 SQL 表？

2.  如何编写必要的 PetaPoco 代码来插入 Person 对象及其包含的任何对象？

3.  我是否应该忘记尝试将对象存储在数据库中而只将 JSON 字符串存储在数据库中？

谢谢你看:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T09:18:45.250

我还没有安装 DotNetNuke 7，但是我检查了 codeplex 的源代码，我认为你可以这样做：

```
public static void AddOrder(Person person)
{
    using (IDataContext context = DataContext.Instance())
    {
        var repositoryPerson = context.GetRepository<Person>();
        var repositoryAddrress = context.GetRepository<Address>();

        context.BeginTransaction();
        try 
        {
            repositoryPerson.Insert(person);
            foreach(var address in person.addresses)
            {
                repositoryAddress.Insert(address);
            }
            context.Commit();
        }
        catch (Exception) 
        {
           context.RollbackTransaction();
           throw;
        }
    }
} 
```

我没有测试过它，所以我不能保证它有效，但这对我来说似乎是正确的。

# postgresql - 错误：表单中的函数表达式不能引用相同查询级别的其他关系：如何解决 LATERAL

> ID：14678734
> 
> 赞同：-1
> 
> 时间：2013-02-03T23:49:15.820
> 
> 标签：postgresql, postgresql-9.2, lateral

```
DROP SCHEMA tmp CASCADE;
CREATE SCHEMA tmp ;
SET search_path=tmp;

CREATE TABLE primes
        ( pos SERIAL NOT NULL PRIMARY KEY
        , val INTEGER NOT NULL
        , CONSTRAINT primes_alt UNIQUE (val)
        );

CREATE FUNCTION is_prime(_val INTEGER)
RETURNS BOOLEAN
AS $func$
DECLARE ret BOOLEAN ;
BEGIN

SELECT False INTO ret
WHERE EXISTS (SELECT *
        FROM primes ex
        WHERE ex.val = $1
        OR ( (ex.val * ex.val) <= $1 AND ($1 % ex.val) = 0 )
        );
RETURN COALESCE(ret, True);
END;
$func$ LANGUAGE plpgsql STABLE;

CREATE VIEW vw_prime_step AS (
        -- Note when the table is empty we return {2,3,1} as a bootstrap
        SELECT
           COALESCE(MAX(val) +2,2) AS start
         , COALESCE((MAX(val) * MAX(val))-1, 3) AS stop
         , COALESCE(min(val), 1) AS step
        FROM primes
        );
SELECT * FROM vw_prime_step;

        -- The same as a function.
        -- Works, but is not usable in a query that alters the primes table.
        -- ; even not with the TEMP TABLE construct
CREATE FUNCTION fnc_prime_step ( OUT start INTEGER, OUT stop INTEGER, OUT step INTEGER)
RETURNS RECORD
AS $func$
BEGIN
/***
CREATE TEMP TABLE tmp_limits
        ON COMMIT DROP
        AS SELECT ps.start,ps.stop,ps.step FROM vw_prime_step ps
        ;
-- RETURN QUERY 
SELECT tl.start,tl.stop,tl.step INTO $1,$2,$3
FROM tmp_limits tl
LIMIT 1
        ; 
***/
SELECT tl.start,tl.stop,tl.step INTO $1,$2,$3
FROM vw_prime_step tl
LIMIT 1;
END;
$func$
-- Try lying ...
-- IMMUTABLE LANGUAGE plpgsql;
-- Try lying ...
Stable LANGUAGE plpgsql;

        -- This works
SELECT * FROM fnc_prime_step();
INSERT INTO primes (val)
SELECT gs FROM fnc_prime_step() sss
 , generate_series( 2, 3, 1 ) gs
WHERE is_prime(gs) = True
        ;
        -- This works
SELECT * FROM fnc_prime_step();
INSERT INTO primes (val)
SELECT gs FROM fnc_prime_step() sss
 , generate_series( 5, 24, 2 ) gs
WHERE is_prime(gs) = True
        ;

        -- This does not work
        -- ERROR:  function expression in FROM cannot refer to other relations of same query level:1
SELECT * FROM fnc_prime_step();
INSERT INTO primes (val)
SELECT gs FROM fnc_prime_step() sss
 , generate_series( sss.start, sss.stop, sss.step ) gs
WHERE is_prime(gs) = True
        ;

SELECT * FROM primes;
SELECT * FROM fnc_prime_step(); 
```

当然，这个问题纯粹是假设性的，我还没有愚蠢到试图在 DBMS 中计算素数表。但问题仍然存在：有没有一种干净的方法来解决没有 的问题`LATERAL`？

正如你所看到的，我尝试了一个视图（不起作用），围绕这个视图的函数（也不起作用），这个函数中的一个临时表（njet），并调整了函数的属性。

下一步可能是一些触发黑客（但我真的非常讨厌触发器，主要是因为它们对于 DBMS 模式的严格性是不可见的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:16:20.480

您可以在目标列表中使用 SRF 功能，但应该有一些奇怪的极端情况。横向是最好的。

```
postgres=# select i, generate_series(1,i) X from generate_series(1,3) g(i);
 我 | X
---+---
 1 | 1
 2 | 1
 2 | 2
 3 | 1
 3 | 2
 3 | 3
(6 行)

```

# java - 删除 .JSP 文件中的 Java cookie

> ID：14678735
> 
> 赞同：1
> 
> 时间：2013-02-03T23:49:18.690
> 
> 标签：java, jsp, servlets, cookies, scriptlet

我正在使用以下函数来创建在 Java Servlet 中设置的 cookie。我试图在 .JSP 文件的脚本中删除它。但是它没有删除cookie，有什么想法吗？

这是我用来在 Servlet 中创建 cookie 的函数：

```
 for(String classId :request.getParameterValues("classId")){
        optionCookie = new Cookie("componentSearchOptionSelect",classId);
        response.addCookie(optionCookie);
    } 
```

这是我用来删除 scriptlet 中的 cookie 的代码：

```
Cookie[] cookies = null;
        cookies = request.getCookies();
        if(cookies != null){
            for(int i = 0; i < cookies.length; i++){
                 Cookie cookie = cookies[i];
                 if(cookie.getName().equals("componentSearchOptionSelect")){

                     selectedClass = cookie.getValue();
                     cookie.setMaxAge(0);
                     response.addCookie(cookie);
                 }
             }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:28:27.113

JSP 作为一种视图技术，负责生成 HTTP 响应体。Cookie 必须放在 HTTP 响应标头中。因此，如果您将该 cookie 代码放在 JSP 中的一半，并且 JSP 已经生成了导致响应已经提交的大量 HTML，那么设置 HTTP 响应标头就为时已晚。HTTP 响应标头已经发送到客户端，这是一个不归路。如果您已经注意了服务器日志，那么您应该已经注意到一条`IllegalStateException`带有非常不言自明的消息和跟踪。

因此，要解决您的问题，只需确保在尚未提交响应时删除 cookie。将包含所有业务逻辑的*scriptlet*放在JSP 页面的最顶部，早在 JSP 将任何内容写入 HTTP 响应正文之前。

```
<%
    // Business logic here.
%>
<!DOCTYPE html>
<html>
    ... (presentation logic here)
</html> 
```

实际上，JSP 是执行业务逻辑的**错误场所（请阅读：您**[根本](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)[不应该使用*scriptlet*](https://stackoverflow.com/questions/3177733/how-to-avoid-java-code-in-jsp-files/3180202#3180202)）。您应该为此使用[servlet](https://stackoverflow.com/tags/servlets/info)或[servlet 过滤器](https://stackoverflow.com/tags/servlet-filters/info)。在您的特定情况下，我认为您只需要一个带有`doGet()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:05:04.127

请试试这个。

```
/*
Cookie[] cookies = null;
cookies = request.getCookies();
if(cookies != null){
    for(int i = 0; i < cookies.length; i++){
         Cookie cookie = cookies[i];
         if(cookie.getName().equals("componentSearchOptionSelect")){
             selectedClass = cookie.getValue();
             cookie.setMaxAge(0);
             response.addCookie(cookie);
         }
     }
}
*/

Cookie cookie = new Cookie("componentSearchOptionSelect", "");
cookie.setMaxAge(0);
response.addCookie(cookie); 
```

顺便问一下，为什么要`Cookie`多次设置相同的值？cookie`componentSearchOptionSelect`的值是最后一个 from 的值`request.getParameterValues("classId"))`。

# java - 光标 setFilterQueryProvider 问题

> ID：14678737
> 
> 赞同：1
> 
> 时间：2013-02-03T23:49:32.003
> 
> 标签：java, android

我试图通过在简单游标适配器类上使用“setFilterQueryProvider”来过滤从我的数据库处理程序类返回的游标的结果。目前，我在以下方法中遇到多个错误：

当前错误：

错误一：

```
The method FilterQueryProvider() is undefined for the type ViewAppointments. 
```

错误2：

```
Syntax error, insert ";" to complete Statement. 
```

错误 3：

```
Illegal modifier for the variable runQuery; only final is permitted 
```

错误 4：

```
Syntax error on token ")", ; expected 
```

错误 5：

```
Void methods cannot return a value. 
```

错误6：

```
Syntax error on token ")", delete this token. 
```

上述错误在以下代码中注明：

```
DBHandlerApp changedAppoint = new DBHandlerApp (this, null, null);

             //ERROR 1 on 'FilterQueryProvider' and ERROR 2 on end ')'.
     cursorAdapter.setFilterQueryProvider(FilterQueryProvider()

            {

            //ERROR 3 on 'runQuery'. Error 4 on end ')'.
        public Cursor runQuery(CharSequence constraint)
        {
                //ERROR 5.
            return changedAppoint.getChanges(constraint.toString());

        }
        ERROR 6 on end ')'
    }); 
```

这是完成的课程。我目前在类的“onCreate”方法中有这个有问题的方法。'ERROR 5' 抱怨返回类型的事实让我相信这在 'OnCreate' 中是错误的地方，因为它显然是无效的。将它放在代码中的其他位置会产生其他括号错误。

希望有人能看到我的布局错误在哪里出错。

```
package com.example.flybase2;

import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.app.ListActivity;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;

public class ViewAppointments extends ListActivity implements OnClickListener {
SimpleCursorAdapter cursorAdapter;
ListView searchedAppView;
ImageButton searchAppoints;
EditText searchAppName;
Long id;

 //@SuppressWarnings("deprecation")
 //@SuppressWarnings("static-access")

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

setContentView(R.layout.appointmentview);

searchedAppView = (ListView)findViewById(android.R.id.list);

searchAppoints = (ImageButton) findViewById(R.id.btnSearchAppointName); 
searchAppName = (EditText) findViewById(R.id.inputAppointName); 

    DBHandlerApp DBAppointments = new DBHandlerApp(this, null, null);

    DBHandlerApp searchApps = new DBHandlerApp(this, null, null);

    searchApps.open();

    Cursor cursor = searchApps.getAppointmentsData();
     searchApps.close();
    startManagingCursor(cursor);

    String [] from = new String [] {DBAppointments.KEY_NAMEAPP, DBAppointments.KEY_TYPEAPP, DBAppointments.KEY_TIMEAPP, DBAppointments.KEY_DATEAPP, DBAppointments.KEY_COMMENTAPP};
    int [] to = new int [] {R.id.txtAppointName, R.id.txtAppointType, R.id.txtAppointTime, R.id.txtAppointDate, R.id.txtAppointCom};

    cursorAdapter = new SimpleCursorAdapter(this, R.layout.setappointviews, cursor, from, to);
    searchedAppView.setAdapter(cursorAdapter);

    searchedAppView.setTextFilterEnabled(true);

    searchAppoints.setOnClickListener(this);

    searchAppName.addTextChangedListener(new TextWatcher()
     {

        @Override
        public void onTextChanged(CharSequence s, int start, int before,
                int count) {

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {

        }

        @Override
        public void afterTextChanged(Editable s) {

                cursorAdapter.getFilter().filter(s.toString());

        }

     });

            //********** ERRORS **********
    DBHandlerApp changedAppoint = new DBHandlerApp (this, null, null);

     cursorAdapter.setFilterQueryProvider(FilterQueryProvider()
    {
        public Cursor runQuery(CharSequence constraint)
        {
            return changedAppoint.getChanges(constraint.toString());

        }
    });

    };

@Override
public void onClick(View clickedSearch)

{

    String searchedName = searchAppName.getText().toString();

    DBHandlerApp searchOnName = new DBHandlerApp(this, null, null);
    DBHandlerApp getColumns = new DBHandlerApp(this, null, null);
    searchOnName.open();

    Cursor nameResult = searchOnName.searchAppByName(searchedName);

    @SuppressWarnings("static-access")
    String [] from = new String [] {getColumns.KEY_NAMEAPP, getColumns.KEY_TYPEAPP, getColumns.KEY_TIMEAPP, getColumns.KEY_DATEAPP, getColumns.KEY_COMMENTAPP};
    int [] to = new int [] {R.id.txtAppointName, R.id.txtAppointType, R.id.txtAppointTime, R.id.txtAppointDate, R.id.txtAppointCom};

    @SuppressWarnings("deprecation")

    SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this, R.layout.setappointviews, nameResult, from, to);
    searchedAppView.setAdapter(cursorAdapter);

}

@Override
protected void onListItemClick(ListView l, View v, int position, long idd) {
    super.onListItemClick(l, v, position, idd);
    final DBHandlerApp delApp = new DBHandlerApp(this, null, null);

    id = idd;

    final CharSequence[] items = {"Edit Appointment Details", "Delete Appointment"};

    Builder alertDialogBuilder = new AlertDialog.Builder(ViewAppointments.this);

    alertDialogBuilder.setTitle("Appointment Options:");

    alertDialogBuilder.setItems(items, new DialogInterface.OnClickListener() {

        public void onClick(DialogInterface dialog, int item) {

            if (items[item].equals("Edit Appointment Details")) {

                Intent setName = new Intent("com.example.flybase2.AppointmentEditChanges");
                setName.putExtra("passedID", id);
                startActivity(setName);

            }

            else if (items[item].equals("Delete Appointment")) {

                      delApp.open();
                      delApp.deleteAppointment(id);
                      delApp.close();

            }

            }  

        });

    alertDialogBuilder.show();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T21:09:33.243

我设法解决了这个问题。这是由于许多问题，但最大的问题是我没有导入“filterQueryProvider”小部件！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T20:06:47.247

> 对于 ViewAppointments 类型，未定义方法 FilterQueryProvider()。

该错误很容易解释，而不是为您调用的方法提供一个实例，`FilterQueryProvider`这`setFilterQueryProvider()`会使`FilterQueryProvider()`事情变得混乱。相反，它应该是这样的：

```
cursorAdapter.setFilterQueryProvider(new FilterQueryProvider() {

    public Cursor runQuery(CharSequence constraint) {
        return changedAppoint.getChanges(constraint.toString());
    }
}); 
```

并制作`changedAppoint` `final`：

```
final DBHandlerApp changedAppoint = new DBHandlerApp (this, null, null); 
```

看看你在上面的更改后是否有任何错误。

# r - 将公式传递给 R 函数？

> ID：14678738
> 
> 赞同：10
> 
> 时间：2013-02-03T23:49:39.533
> 
> 标签：r, function, formula, survey

对此的任何帮助将不胜感激。我正在使用 Lumley 调查包并试图简化我的代码，但遇到了一点小问题。

包中的 svymean 函数在我的代码中调用如下，其中第一个参数是一个公式，指示我想要哪些变量，第二个参数是该数据集：

```
svymean(~hq_ehla, FraSvy, na.rm=TRUE) 
```

我正在尝试创建一个函数，该函数将提取分类变量的平均值（比例）和标准错误，因此我创建了以下函数：

```
stats <- function(repstat, num) {
    estmean <- as.numeric(round(100 * repstat[num], digits=0))
    estse <- round(100 * sqrt(attributes(repstat)$var[num,num]), digits=1)
    return(list(mean=estmean, se=estse))
} 
```

这行得通，所以当我提取第一类的均值和 se 时，例如，我使用：

```
stats(svymean(~hq_ehla, FraSvy, na.rm=TRUE), 1)$mean
stats(svymean(~hq_ehla, FraSvy, na.rm=TRUE), 1)$se 
```

我想做的就是把它简化为更短的东西，也许我只需要写：

```
stats(FraSvy, "hq_ehla", 1)$mean 
```

或类似的东西。问题是我不知道如何使用变量名将公式传递给函数。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-03T23:59:43.043

您可以使用`reformulate`构建公式并`svymean`在函数中调用。用于`...`传递`na.rm`或其他参数`svymean`

```
stats <- function(terms, data,  num, ...) {
  .formula <- reformulate(terms)
  repstat <- svymean(.formula, data, ...)
  estmean <- as.numeric(round(100 * repstat[num], digits=0))
  estse <- round(100 * sqrt(attributes(repstat)$var[num,num]), digits=1)
  return(list(mean=estmean, se=estse))
}

stats(data = FraSvy, terms = "hq_ehla", 1, na.rm = TRUE)$mean 
```

查看[此答案](https://stackoverflow.com/a/12967834/1385941)以获取有关以编程方式创建公式对象的更多详细信息

或者，您可以在函数中传递一个公式对象。

```
stats2 <- function(formula, data,  num, ...) {

  repstat <- svymean(formula, data, ...)
  estmean <- as.numeric(round(100 * repstat[num], digits=0))
  estse <- round(100 * sqrt(attributes(repstat)$var[num,num]), digits=1)
  return(list(mean=estmean, se=estse))
}

stats2(data = FraSvy, formula = ~hq_ehla, 1, na.rm = TRUE)$mean 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T06:43:42.257

和函数可能会让你的生活更轻松`coef`..`SE`

```
# construct a function that takes the equation part of svymean as a string
# instead of as a formula.  everything else gets passed in the same
# as seen by the `...`
fun <- function( var , ... ) svymean( reformulate( var ) , ... )

# test it out.
result <- fun( "hq_ehla" , FraSvy , na.rm = TRUE )

# print the results to the screen
result

# also your components
coef( result )
SE( result )

# and round it
round( 100 * coef( result ) )
round( 100 * SE( result ) ) 
```

# html - 如何删除网址末尾的斜杠？

> ID：14678747
> 
> 赞同：0
> 
> 时间：2013-02-03T23:50:40.837
> 
> 标签：html, .htaccess, url

目前，访问我网站上的链接的唯一方法是在网址末尾有一个斜杠，如 www.me.com/portfolio/ 如何在最后删除斜杠？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:02:59.527

```
Options +FollowSymlinks -MultiViews

RewriteEngine On
RewriteBase /

# Remove slashes
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !(.*)$
RewriteRule ^(.*)$ http://domain.com/$1 [L,R=301] 
```

我相信这会奏效。将其放在您要执行此操作的目录中。

# java - RestTemplate & Jackson - 自定义 JSON 反序列化？

> ID：14678748
> 
> 赞同：0
> 
> 时间：2013-02-03T23:50:51.700
> 
> 标签：java, json, jackson, resttemplate

Web 服务返回一个空字符串而不是 NULL，这会导致 Jackson 崩溃。所以我创建了一个自定义解析器，我试图手动解析它？任何想法我怎么能做到这一点？

我在这里做错了什么？我要做的就是像往常一样将 JSON 解析为对象。使用 @JsonProperty 将字段名称添加到我的属性中，因此解析器应该知道如何转换它。

```
public class InsertReplyDeserializer extends JsonDeserializer<ListingReply> {

    @Override
    public ListingReply deserialize(JsonParser jsonParser, DeserializationContext arg1)
            throws IOException, JsonProcessingException {

        ObjectCodec oc = jsonParser.getCodec();
        JsonNode node = oc.readTree(jsonParser);

        // If service returns "" instead of null return a NULL object and don't try to parse
        if (node.getValueAsText() == "")
            return null;

       ObjectMapper objectMapper = new ObjectMapper();
       ListingReply listingReply = objectMapper.readValue(node, ListingReply.class);

       return listingReply;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T02:33:02.260

这是我解决它的方法

```
@Override
public MyObject deserialize(JsonParser jsonParser, DeserializationContext arg1)
        throws IOException, JsonProcessingException {

    ObjectCodec oc = jsonParser.getCodec();
    JsonNode node = oc.readTree(jsonParser);

    if (node.getValueAsText() == "")
        return null;

    MyObject myObject = new MyObject();
    myObject.setMyStirng(node.get("myString").getTextValue());

    JsonNode childNode = node.get("childObject");
    ObjectMapper objectMapper = new ObjectMapper();
    ChildObject childObject = objectMapper.readValue(childNode,
            ChildObject.class);

             myObject.setChildObject(childObject);
             return myObject;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T23:21:45.247

I am not sure you need to manually parse response. You solution would work but seems sub-optimal in my opinion. Since it looks like that you are using RestTemplate, you should rather write (or move your parser code to) your own message converter. Then add this converter to your rest template object which will internally deserialize the value for you. Something along the lines,

```
public class CustomHttpmsgConverter extends  AbstractHttpMessageConverter<Object> {
private ObjectMapper objectMapper = new ObjectMapper();
@Override
protected Object readInternal(Class clazz, HttpInputMessage inputMessage) throws IOException, HttpMessageNotReadableException {
   InputStream istream = inputMessage.getBody();
   String responseString = IOUtils.toString(istream);
   if(responseString.isEmpty()) //if your response is empty
     return null;
   JavaType javaType = getJavaType(clazz);
   try {
       return this.objectMapper.readValue(responseString, javaType);
   } catch (Exception ex) {
    throw new HttpMessageNotReadableException(responseString);
    }
}

//add this converter to your resttemplate
    RestTemplate template = new RestTemplate();
    List<HttpMessageConverter<?>> converters = new ArrayList<HttpMessageConverter<?>>();
    converters.add(new CustomHttpmsgConverter());
    template.setMessageConverters(converters); 
```

# java - Java 标签定时器和保存

> ID：14678750
> 
> 赞同：0
> 
> 时间：2013-02-03T23:50:57.867
> 
> 标签：java, swing, timer, jframe

让我解释一下我想要做什么。

我有两个类扩展`JFrame`，`StartJFrame`和`TestingJFrame`。在 main 方法中，我启动了一个`StartJFrame`. 它有一个按钮，开始。按下该按钮后，我将其设置为隐藏该框架并启动`TestingJFrame`. 现在我在 T 中没有任何东西`estingJFrame`。

在那个屏幕中，我希望在右下角有一个计时器标签，从 45 秒开始倒计时到 0。我还需要每 10 秒运行一次代码，并收集一些数据。将有两个按钮`TestingJFrame`，是和否。当其中一个被按下时，它应该停止计时器并保存信息。

数据基本上只是翻倍。每次运行程序时，我只会收集一次数据。我有一`UserData`堂课，其中包含有关测试主题的一些信息，以及一个双打列表，它每 10 秒添加一次。我对如何在 java 中保存数据有一个大致的了解。

我的问题是，我应该如何设置计时器，以便它从 45 秒开始倒计时，当它达到 0 或用户按下是或否按钮时，它会调用一个函数来保存数据？我想我可以处理保存数据部分。

抱歉，如果这真的很简单，我是 Java 新手（来自 c#），Swing 让我有点困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:02:39.310

您可以使用[javax.swing.Timer](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)来设置您的计时器。你也可以看看[官方教程](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T00:10:52.703

第一部分（显示倒计时和停止计时器）相对容易......

```
public class TimerTest01 {

    public static void main(String[] args) {
        new TimerTest01();
    }

    public TimerTest01() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new TestPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    public class TestPane extends JPanel {

        private JLabel label;
        private Timer timer;
        private long startTime;

        public TestPane() {
            setLayout(new GridLayout(0, 1));
            label = new JLabel("...");
            label.setHorizontalAlignment(JLabel.CENTER);
            final JButton btn = new JButton("Start");
            btn.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    if (timer.isRunning()) {
                        timer.stop();
                        btn.setText("Start");
                    } else {
                        startTime = System.currentTimeMillis();
                        timer.restart();
                        btn.setText("Stop");
                    }
                    repaint();
                }
            });
            add(label);
            add(btn);

            timer = new Timer(250, new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    long endTime = (startTime + 45000);
                    long timeLeft = endTime - System.currentTimeMillis();
                    if (timeLeft < 0) {
                        timer.stop();
                        label.setText("Expired");
                        btn.setText("Start");
                    } else {
                        label.setText(Long.toString(timeLeft / 1000));
                    }
                    repaint();
                }
            });
        }
    }
} 
```

查看[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)了解更多信息

您问题的第二部分是含糊不清地可靠地为您提供答案。数据从何而来？怎么收的？？

# java - 两个非常长的整数相加

> ID：14678751
> 
> 赞同：0
> 
> 时间：2013-02-03T23:51:00.107
> 
> 标签：java

为了练习，我试图通过将它们放在数组中并在数组中添加相应的元素来添加两个非常长的整数。但是，当尝试添加结转时，我遇到了问题（即，结转是 1，例如，当您执行 199 + 199 = 398 时，您添加到十位）。

当做 167 + 189 时，我得到了正确的答案，即 356。但是，对于这个例子（199 + 199），我得到的是 288 而不是 398。我的问题是，为什么我做的时候会得到一个不正确的答案199 + 199，如果我做 167 + 189 时结转效果很好？

```
if (stringNumOneLength == stringNumTwoLength)
    {   int answer; 
        int carryOver = 0;
        int answerArray[] = new int[stringNumOneLength + 1];
        for (int i = 1; i <= stringNumTwoLength; i = i + 1)
        {            
            answer = Character.getNumericValue(stringNumOne.charAt(stringNumOneLength - i)) + Character.getNumericValue(stringNumTwo.charAt(stringNumTwoLength - i) + carryOver);
            System.out.println(answer);
            if (answer >= 10)
            {
                for (int j = 0; j <= 9; j = j + 1)
                {
                    if (10 + j == answer) 
                    {
                        carryOver = 1;
                        answer = j;
                        System.out.println("The carryover is " + carryOver + ".");
                    }
                }
            }
            else
            {
                carryOver = 0;
            }

            answerArray[stringNumOneLength + 1 - i] = answer;
        }
        System.out.println(Arrays.toString(answerArray));
    } 
```

输出如下：

[1, 9, 9]

[1, 9, 9]

18

结转为 1。

8

2

[0, 2, 8, 8]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:06:48.737

您将进位添加到角色而不是其值：

```
 ... + Character.getNumericValue(stringNumTwo.charAt(stringNumTwoLength - i) + carryOver); 
```

您想在 + 中移动右父级。

请注意，您的 for 循环是不必要的。这做同样的事情：

```
if (answer >= 10)
{
    answer -= 10;
    carryOver = 1;
    System.out.println("The carryover is 1.");
}
else ... 
```

如果您对惯用的解决方案感兴趣：

```
public class Test {

    public String add(String a, String b) {
        StringBuilder r = new StringBuilder();
        int carry = 0;
        for (int ia = a.length() - 1, ib = b.length() - 1; ia >= 0 || ib >= 0; ia--, ib--) {
            int aDigit = ia < 0 ? 0 : Character.getNumericValue(a.charAt(ia));
            int bDigit = ib < 0 ? 0 : Character.getNumericValue(b.charAt(ib));
            int sum = carry + aDigit + bDigit;
            if (sum >= 10) {
                sum -= 10;
                carry = 1;
            }
            else {
                carry = 0;
            }
            r.append(Character.forDigit(sum, 10));
        }
        if (carry > 0) {
            r.append('1');
        }
        return r.reverse().toString();
    }

    public void run() {
        System.out.println("789 + 89 = " + add("789", "89"));
        System.out.println("12 + 128 = " + add("12", "128"));
        System.out.println("999 + 999 = " + add("999", "999"));
    }

    public static void main(String[] args) {
        new Test().run();
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T23:57:52.013

这一行的括号：

```
answer = Character.getNumericValue(stringNumOne.charAt(stringNumOneLength - i)) + Character.getNumericValue(stringNumTwo.charAt(stringNumTwoLength - i) + carryOver); 
```

错了。注意`+ carryOver`在对 Character.getNumericValue 的调用中是如何进行的。

# java - 使用 Java 和 GWT 将客户端的本地 csv 文件数据预处理为数组

> ID：14678753
> 
> 赞同：0
> 
> 时间：2013-02-03T23:51:04.683
> 
> 标签：java, javascript, html, gwt, browser

我进行了搜索和搜索，遇到了解决部分问题的问题，但没有全面的问题。我正在使用 GWT 和 eclipse 开发一个网站，该网站使用 highcharts 来制作一些花哨的情节。

这个想法是，用户将能够选择一个 csv 类型的本地数据文件，并且在选择文件后，将使用他们的数据和我们花哨的算法来渲染绘图。

我们不想向服务器发送大量数据，因为这对用户来说成本高昂且耗时。有没有办法使用要在 GWT-eclipse 项目中实现的 Java 代码来处理或至少预处理用户的数据？

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:26:06.190

这是[GWT Toolkit 的副本：在客户端预处理文件](https://stackoverflow.com/questions/490062/gwt-toolkit-preprocessing-files-on-client-side)

答案之一指向这些链接：

[http://code.google.com/p/gwt-nes-port/wiki/FileAPI](http://code.google.com/p/gwt-nes-port/wiki/FileAPI) - HTML5 文件 API 的 GWT 包装器

[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/) - HTML5 FileAPI

但是，唉，FileAPI 是相当新的：[http ://caniuse.com/fileapi](http://caniuse.com/fileapi)

为了避免使用服务器，您拥有的另一种选择是将 CSV 文件粘贴到的文本区域，然后使用 GWT 读取它。这是一个常见的技巧，我认为您甚至可以通过这种方式从某些电子表格程序中复制+粘贴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T05:35:57.197

**您目前无法在所有浏览器中以通用方式在 GWT 中执行此操作。**GWT 转换为 javascript，它没有处理客户端文件所需的权限。

有关更详细的答案，您可以参考 -[如何从 GWT FileUpload 组件中检索文件？](https://stackoverflow.com/questions/14053937/how-to-retrieve-file-from-gwt-fileupload-component)

# css - Firefox中的CSS容器高度不同？

> ID：14678755
> 
> 赞同：0
> 
> 时间：2013-02-03T23:51:24.260
> 
> 标签：css, firefox

我的 CSS 有问题。基本上我有一个`<div>`被调用的容器，它包含我网站的所有内容。容器平行于其他东西的右侧边缘。

我需要两者在底部正确对齐。Chrome 和 Safari 显示容器高度相同，右侧边距和容器都对齐，但在 Firefox 中，容器比右侧边距短。无论如何我可以为firefox或其他方式设置单独的css条件，因为它看起来很傻。

我曾尝试使用 height 100% 但我不能使用它，因为我有 javascript 和其他隐藏并淡入的东西以及其他原因。

```
#container {
        /* [disabled]overflow: hidden;
    */
        padding-top: 10px;
        padding-right: 20px;
        padding-bottom: 20px;
        padding-left: 20px;
        /* [disabled]float: left; */
        width: 960px;
        margin-left: auto;
        margin-right: auto;

    }

    body {
        /* [disabled]margin-right: auto; */
        /* [disabled]margin-left: auto; */
        /* [disabled]width: 1010px; */
        font-size: 11px;
        font-family: "lucida grande", tahoma, verdana, arial, sans-serif;
        color:#3F3F3F;
        background-color: #F3F3F3;
        margin-top: 20px;
        overflow:auto;
        /* [disabled]float: left; */
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:57:49.067

你可以尝试这样的事情：

**HTML**

```
<div>HEADER</div>

<div class="container">
    <div class="content">
        <p>Content Area</p>
        <p>row#2</p>
        <p>row#3</p>
        <p>row#4</p>
        <p>row#5</p>
        <p>row#6</p>
    </div>

    <div class="sidebar">
        Sidebar
    </div>
</div>

<div>FOOTER</div> 
```

**CSS**

```
.container {
    width: 960px;
    padding: 10px 20px 20px;
    margin: 0 auto;    
    overflow: hidden;
}

.content, .sidebar {
    float: left;
    padding: 1%;
    padding-bottom: 100%;
    margin-bottom: -100%;
}

.content {
    width: 68%;
    background-color: red;
}

.sidebar {
    width: 28%;
    background-color: green;
} 
```

这应该将两列对齐到相同的高度。

我做了一个[演示](http://jsfiddle.net/ragnarokkr/hHgJt/)，你可以试试。

**编辑**：也许你可以看看关于[CSS-Tricks](http://css-tricks.com/fluid-width-equal-height-columns/)的文章，其中讨论了不同的有效替代方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T01:01:23.827

如果没有 HTML，很难准确地说出来。将两者都放入具有确定像素高度的包装 div 中，然后将 #content 和 #margin div 置于 100% 高度呢？

```
#wrapper{
width: 100%;
height: your height in px;
}

#container {
    /* [disabled]overflow: hidden;
*/
    height: 100%;
    padding-top: 10px;
    padding-right: 20px;
    padding-bottom: 20px;
    padding-left: 20px;
    /* [disabled]float: left; */
    width: 960px;
    margin-left: auto;
    margin-right: auto;

}

#margin{
height:100%;
} 
```

此外，在 firebug 中使用所有 CSS 来解决此问题。一个个去掉属性，找出可能的问题。

# ios - 按下 Home 键时保持 GPS 运行几分钟

> ID：14678759
> 
> 赞同：2
> 
> 时间：2013-02-03T23:52:36.193
> 
> 标签：ios, gps, background-process, cllocation, home-button

我有一个带有区域监控的应用程序，但为了更好的定位，当用户进入指定的区域时，我调用“startUpdatingLocation”以使用 GPS：

```
 - (void)locationManager:(CLLocationManager *)manager didEnterRegion:(CLRegion *)region {
   [manager startUpdatingLocation]; 
}

-(void)locationManager:(CLLocationManager *)manager didUpdateLocations:(NSArray *)locations{
locationManager =manager;

     CLLocation *location1 = locationManager.location;
     CLLocation *location2 = [[CLLocation alloc] initWithLatitude:obj.latitude longitude:obj.longitude];
    float betweenDistance=[location1 distanceFromLocation:location2];

    if((betweenDistance/1000)<=0.350000){
            // Fires an UIAlert
     } 
```

}

这在大多数情况下都可以正常工作，例如，如果用户在该地区之外，然后按下“主页按钮”，进入该地区后触发功能“didEnterRegion”，GPS 开始工作几分钟并显示警报，这是正确的方法。

但是，如果应用程序已打开，然后用户在该区域中输入触发功能“didEnterRegion”并且 GPS 启动，但如果用户在那一刻按下“主页按钮”，则 GPS 停止并且警报永远不会出现。

我不想在 info.plist 中激活“必需的背景模式”选项，因为我只想在用户按下主页按钮后使用 GPS 几分钟，而不是在过度模式下使用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T03:03:36.583

当您的应用程序委托收到消息 applicationWillResignActive: 您可以通过创建如下请求来请求操作系统保持您的应用程序运行：

```
UIBackgroundTaskIdentifier taskID = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
    // do you cleanup in here if your background task gets terminated by the system
}]; 
```

之后，您的事件循环将继续运行，您将继续接收正常的事件（除了您的应用程序的窗口不可见，因此您显然不会收到触摸事件或其他与窗口相关的事件）。

一旦您不再需要继续运行，您可以像这样发布您的请求

```
[[UIApplication sharedApplication] endBackgroundTask:taskID]; 
```

为了让这一切正常工作，只需向您的应用程序委托添加一个标志，以便在您执行需要更多时间的操作时通知它。然后，当您的代理收到 applicationWillResignActive: 消息时，它可以检查该标志，如果已设置，则请求一些后台时间以继续运行。

# sas - 如何获得SAS（proc phreg）中估计参数的值？

> ID：14678762
> 
> 赞同：3
> 
> 时间：2013-02-03T23:53:08.473
> 
> 标签：sas

SAS()中如何获取估计参数的值`proc phreg`？我一直在搜索语法`OUTPUT`和基线，但它们只给出值`XBETA`集。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T14:40:10.393

我不喜欢统计，所以我只是猜测你的意思是什么 - 这是一个我认为可以帮助你的例子：

```
ods trace on;
ods output ParameterEstimates=work.my_estimates_dataset;
proc phreg data=sashelp.class;
model age = height;
run;

ods trace off; 
```

这是使用 SAS/Base 的 SAS 输出交付系统组件。使用`ods trace on;`，您将在 SAS 日志中看到对部分过程输出的引用：

```
Output Added:
-------------
Name:       ParameterEstimates
Label:      Maximum Likelihood Estimates of Model Parameters
Template:   Stat.Phreg.ParameterEstimates
Path:       Phreg.ParameterEstimates 
```

您可以引用这些（通常通过名称或路径）并将它们存储在带有`ODS OUTPUT...`语句的表中。查找 SAS ODS 用户指南了解更多信息。

# gmail - gmail支持的电子邮件地址是否有明确的测试？

> ID：14678767
> 
> 赞同：4
> 
> 时间：2013-02-03T23:54:20.163
> 
> 标签：gmail

我们有一个注册流程，我们也有通过谷歌登录。

注册流程要求输入密码，但如果您有一个由 gmail 管理的电子邮件地址，则无需纠缠您提供单独的密码，您只需通过 Google 的 OpenID/OAuth2 登录即可

因此，我想知道是否对电子邮件地址进行了任何快速简便的检查，以确认该地址由 GMail 管理。

给出假阴性是可以的，假阳性是完全不能接受的。

显然，“它是@gmail.com”测试是一个有效的测试，但我想要一些假阴性率较低的东西。

我的下一个想法是检查 DNS 中的 MX 记录，看看那是否是 Google Mail MX 记录……但这是否证明该帐户由 google 管理？

或者人们还有其他测试吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T23:58:10.297

查询 SMTP 服务器，打开与 SMTP 服务器的连接，开始发送电子邮件，如果没有收到 550（用户不存在），则取消 SMTP 会话并退出。

希望这可以帮助！

# ide - 如何获取 install4j IDE 的日志？

> ID：14678770
> 
> 赞同：1
> 
> 时间：2013-02-03T23:55:27.843
> 
> 标签：ide, install4j

我在 5.1.5 中从 5.0 打开一个 install4j 项目，并出现一个对话框

> 加载配置时出错：java.lang.reflect.InvocationTargetException

如果我保存这个项目，大小会从 44kB 下降到 20kB。

我如何弄清楚出了什么问题？堆栈跟踪将是一个很好的开始......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:18:40.760

我发现 /tmp/install4j_error.log 显示了堆栈跟踪。

似乎我的 ${compiler:basedir} 变量导致了一个问题，因为它在变量列表中未指定......

# asp.net - asp.net GridView 数据操作

> ID：14678772
> 
> 赞同：0
> 
> 时间：2013-02-03T23:55:41.903
> 
> 标签：asp.net

我有显示这样的数据的 GridView

```
名称 类型 描述

abc 1 测试
xyz 2 测试
mno 1 另一个测试

```

此数据是从 sqldatasource 中检索的。

问题：我想显示类型名称而不是 ID 例如（如果类型 = 1，那么它应该显示“卡车”，如果类型 = 2，它应该显示“司机”）我只有 2 种类型（卡车和司机）

有人可以帮我吗？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:02:00.967

`BoundField`您可以将“类型”列的当前值替换为`TemplateField`.

我假设你没有设置`GridView` `AutoGenerateColumns`为真。

```
 <asp:TemplateField>
            <HeaderTemplate>Type</HeaderTemplate>
            <ItemTemplate>
                <%# Convert.ToInt32(Eval("Type").ToString()) == 1 ? "Truck" : "Driver" %>
            </ItemTemplate>
        </asp:TemplateField> 
```

# django - 传递数据时页面停顿

> ID：14678777
> 
> 赞同：0
> 
> 时间：2013-02-03T23:56:59.827
> 
> 标签：django

我试图在页面之间传递一些数据，但它不起作用。有小费吗？我单击提交，它会将我带到一个空白页面。如果我刷新，那么它会显示我的基本模板样式，但没有传递任何数据。

索引.html

```
{% extends "polls/base.html" %}

{% block title %}Vote{% endblock %}

{% block content %}

<h1>Welcome</h1>

<form action="/polls/" method="post">{% csrf_token %}
<p><label for="pin">Enter group pin:</label>
    <input id="pin" type="text" name="pin" maxlength="4" />
  <input type="submit" value="View Polls" /></p>
</form>

    <a href="admin/">Moderator login</a>

</p>

{% endblock %} 
```

民意调查/index.html

```
{% extends "polls/base.html" %}

{% block title %}Recent Polls{% endblock %}

{% block content %}

{{ pin }}

{% endblock %} 
```

民意调查/urls.py

```
url(r'^$',
        ListView.as_view(
            model=Poll,
            template_name='polls/index.html')), 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:55:00.683

您需要编写一个视图来处理表单提交。有效的视图是列出您的所有民意调查。我建议你阅读教程：

基本视图：[https](https://docs.djangoproject.com/en/1.4/intro/tutorial03/) ://docs.djangoproject.com/en/1.4/intro/tutorial03/ 表单提交：[https ://docs.djangoproject.com/en/1.4/intro/tutorial04/](https://docs.djangoproject.com/en/1.4/intro/tutorial04/)

基本上，您的表单会将数据发送到另一个处理您的数据的 URL。

您必须在`action`属性中指定它：

```
<form action="/polls/create-poll" method="post">{% csrf_token %}
<input type='text' name='poll-name' />
<input type='submit' />
</form> 
```

在您看来：

```
def create_poll(request):
    poll_name = request.POST.get('poll-name')
    poll = Poll.objects.create(name=poll_name)
    return HttpResponse("Poll created") 
```

我不想听起来粗鲁。但是您应该从一些 HTTP 和 HTML 教程开始。一个好的网络程序员是一个对基本知识有详细了解的人。HTTP 是一个很棒的协议，尝试从头到尾学习它。

# ios - 通过 URLForUbiquityContainerIdentifier+Path 而不是 NSMetadataQuery 检查 UI(Managed)Document 是否已经在 iCloud 中？

> ID：14678782
> 
> 赞同：3
> 
> 时间：2013-02-03T23:57:45.693
> 
> 标签：ios, cocoa-touch, core-data, icloud, uimanageddocument

我有一个非常简单的鞋盒式 iOS 应用程序，带有**1**个单一的**核心数据**数据库（作为**UIManagedDocument**），并考虑尝试添加**iCloud**支持。

* * *

我当然必须**检查****云中**是否已经**存在**数据库**在启动时创建新的 UIManagedDocument* *、保存/打开它等。

 ***因为我**已经知道文件名**并且有 1 个文档或根本没有文档，所以我真的不知道是否必须这样做

1.  **使用确切文件名**的谓词启动**NSMetaDataQuery** ， 然后从结果中**获取****fileURL**（并显式下载它？）如果有，则打开它，或者

*******   只使用`[[NSFileManager defaultManager] fileExistsAtPath:self.iCloudDBURL]` 从`iCloudDBURL`URLForUbiquityContainerIdentifier + 附加创建**的**？此 URL 是否只是一个本地 URL，并且不会自动检查“真实”云？****** 

 ***** * *

我知道使用 UIManagedDocument 可能不是这种应用程序的“正确”方式，但我认为它更容易，我可以尝试..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:30:26.847

您需要使用该`NSMetadataQuery`方法。

在 iCloud 上使用 iOS 时，文档不会自动下载——它们只会在您请求时下载。按照您的建议使用`NSFileManager`只会告诉您该文件是否存在于本地设备上。但是，该文件可能存在于云端，尚未在本地下载。如果您使用`NSMetadataQuery`，您可以找出文档是否存在于*任何地方*，即使它在云中并且尚未实际下载。如果文档是在其他设备上创建的，您可以了解它。这也涵盖了用户删除并重新安装应用程序但不删除云数据的情况——即使它没有下载，你也会发现它是否存在。

由于您正在使用`UIManagedDocument`，您不需要进行特定的下载调用——当您打开它时，它会为您处理。*******

# assembly - 如何使用汇编写入标准输出？

> ID：14678783
> 
> 赞同：5
> 
> 时间：2013-02-03T23:57:51.253
> 
> 标签：assembly, x86, stdout, freebsd

我在尝试写“嗨！”时遇到了麻烦。在“标准输出”中。我使用 Freebsd 系统调用的默认调用约定（FreeBSD 开发人员手册：11.3.1）和我的新手汇编技能编写了这段代码。

这是代码（at&t 格式）：

```
.data
        str:
        .ascii "hi!"

.text

.globl main

main:
        pushl $0x3      # size
        pushl $str      # *buf
        pushl $0x1      # fd
        movl $0x4,%eax  # write
        int $0x80

        movl $0x1,%eax
        movl $0x0,%ebx
        int $0x80 
```

该系统是 FreeBSD 9 x86。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-05-22T18:17:09.207

学习这一点的简单方法之一是让 C 编译器为您生成一个汇编程序模板。我们从 C 中的等价物开始：

```
main()
{
        write(1, "hi!\n", 4);
        return 0;
} 
```

然后我们让编译器为我们创建汇编代码：

```
cc -S hello.c 
```

生成的汇编代码应该可以进行汇编（并与 C 库链接）。

```
 .file   "hello.c"
    .section    .rodata
.LC0:
    .string "hi!\n"
    .text
    .p2align 4,,15
.globl main
    .type   main, @function
main:
.LFB2:
    pushq   %rbp
.LCFI0:
    movq    %rsp, %rbp
.LCFI1:
    movl    $4, %edx
    movl    $.LC0, %esi
    movl    $1, %edi
    movl    $0, %eax
    call    write
    movl    $0, %eax
    leave
    ret
.LFE2:
    .size   main, .-main
    .section    .eh_frame,"a",@progbits
.Lframe1:
    .long   .LECIE1-.LSCIE1
.LSCIE1:
    .long   0x0
    .byte   0x1
    .string "zR"
    .uleb128 0x1
    .sleb128 -8
    .byte   0x10
    .uleb128 0x1
    .byte   0x3
    .byte   0xc
    .uleb128 0x7
    .uleb128 0x8
    .byte   0x90
    .uleb128 0x1
    .align 8
.LECIE1:
.LSFDE1:
    .long   .LEFDE1-.LASFDE1
.LASFDE1:
    .long   .LASFDE1-.Lframe1
    .long   .LFB2
    .long   .LFE2-.LFB2
    .uleb128 0x0
    .byte   0x4
    .long   .LCFI0-.LFB2
    .byte   0xe
    .uleb128 0x10
    .byte   0x86
    .uleb128 0x2
    .byte   0x4
    .long   .LCFI1-.LCFI0
    .byte   0xd
    .uleb128 0x6
    .align 8
.LEFDE1:
    .ident  "GCC: (GNU) 4.2.1 20070831 patched [FreeBSD]"
    .section    .note.GNU-stack,"",@progbits 
```

目前尚不清楚（对我而言）您真正需要多少超出 .size 指令的尾随内容，但这应该让您顺利上路。

# java - 是否可以以“批处理”方式在 Java 中执行 windows 命令？即一个接一个但坚持不懈？

> ID：14678787
> 
> 赞同：3
> 
> 时间：2013-02-03T23:58:21.023
> 
> 标签：java, batch-file, command, cmd, runtime

我正在寻找能够以“批处理”方式运行 Windows 命令的 Java 应用程序；我的意思是它在命令之间是持久的，而不是好像你一次只执行一个。

这方面的一个例子可能是：

```
@echo off
pushd C:\foldertobepushedto\
call batchfiletobecalled.bat
popd
pushd anotherdirectorytobepushedinto
call anotherbatchfiletobecalled.bat
popd 
```

我希望能够使用`Process process = Runtime.getRuntime().exec(CMD);`能够运行这些行中的每一行但保持持久性的方式，这样就不会好像每行都与其他行完全分开运行。

我希望我有点道理；我打算基本上一起删除批处理文件的使用，并将每一行作为一个元素存储在向量/数组中，并以这种方式执行“批处理”样式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-01T05:10:06.143

打扰一下。我知道在 JScript 中解决这个问题的方法；如果有 Java 的等效方法，我会忽略。

如果您：

单独执行 CMD.EXE 文件，不带参数，但通过 WshShell.Exec 方法：

```
var WshShell = new ActiveXObject("WScript.Shell");
var oExec = WshShell.Exec("cmd"); 
```

WshShell.Exec 方法提供对进程标准 I/O 通道的访问。

之后，将要执行的命令发送到进程的 STDIN 通道：

```
oExec.Stdin.WriteLine("@echo off");
oExec.Stdin.WriteLine("pushd C:\foldertobepushedto\");
oExec.Stdin.WriteLine("call batchfiletobecalled.bat");
oExec.Stdin.WriteLine("popd");
oExec.Stdin.WriteLine("exit"); 
```

这样，所有命令将以完全等效的方式执行，就好像它们将包含在批处理文件中一样。唯一的区别是某些命令将无法正确执行，例如`GOTO`.

# matlab - 在matlab中减去两个矩阵，结果中的负值被零替换

> ID：14678793
> 
> 赞同：5
> 
> 时间：2013-02-03T23:59:06.440
> 
> 标签：matlab, matrix

我在matlab中有两个矩阵，

```
> IRwindow =
> 
>   **183**  171  150  125  137
    138  167  184  173  152
    105  114  141  167  185  
    148  113  105  115  141  
    186  183  147  112  105
> 
> ILwindow =
> 
>   **201**  170  165  177  203
    181  174  167  169  189 
    154  150  156  168  181 
    187  175  158  131  144 
    173  186  183  167  141 
```

我想逐元素减去这两个矩阵并得到结果；例如对于第一个元素（**183 - 201= -18**），但该元素的输出为零。结果结果如下：

```
> IRwindow - ILwindow

 ans =

     **0**    1    0    0    0
     0    0   17    4    0
     0    0    0    0    4
     0    0    0    0    0    
     13    0    0    0    0 
```

我怎样才能保持真实的结果？我的结果矩阵中的负数不为零

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T00:02:17.110

运行以下示例代码：

```
%# Create random matrices
X = randi(100, 5, 5);
Y = randi(100, 5, 5);

%# Convert to strictly non-negative format
X = uint8(X);
Y = uint8(Y);

%# Perform subtractions
A = X - Y;

%# Convert to double format
X = double(X);
Y = double(Y);

%# Perform subtraction
B = X - Y; 
```

对于给定的示例运行：

```
A =

    0   15   36    0    0
    0    0    0    0    3
    0    0    0   25    0
   13    0   15    0    0
    0   49    0    0   14 
```

尽管：

```
B =

    -8    15    36    -4   -65
     0   -47   -45   -11     3
   -18   -17   -11    25   -52
    13   -53    15   -15    -1
   -35    49   -47    -8    14 
```

你会注意到所有的负数`A`都被0替换了，而负数`B`显示正确。

简单地说：如果您使用无法存储负数的数字格式，则 Matlab 会在 0 处截断。解决方案是转换为能够容纳“实”数（或其近似值）的格式，例如`double`，或者在您的情况下，其中一种格式可能更合适，`int`例如`int8`,或.`int16``int32``int64`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T00:10:53.987

另一种选择是在一行中使用`single`或减法，如下所示：`double`

```
 ans=double(IRwindow-ILwindow) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T00:04:20.290

我没有遇到与您相同的问题：我有以下代码：

```
IRwindow = [

183  171  150  125  137
138  167  184  173  152
105  114  141  167  185  
148  113  105  115  141  
186  183  147  112  105]

ILwindow = [

201  170  165  177  203
181  174  167  169  189 
154  150  156  168  181 
187  175  158  131  144 
173  186  183  167  141]

IRwindow - ILwindow 
```

我得到这个输出：

```
IRwindow =

   183   171   150   125   137
   138   167   184   173   152
   105   114   141   167   185
   148   113   105   115   141
   186   183   147   112   105

ILwindow =

   201   170   165   177   203
   181   174   167   169   189
   154   150   156   168   181
   187   175   158   131   144
   173   186   183   167   141

ans =

   -18     1   -15   -52   -66
   -43    -7    17     4   -37
   -49   -36   -15    -1     4
   -39   -62   -53   -16    -3
    13    -3   -36   -55   -36 
```

检查您创建的矩阵是否正确创建（作为双精度数而不是无符号整数）。

# php - 使用基于 HTML 的电子邮件发送表单时如何通知网站管理员

> ID：14678795
> 
> 赞同：-2
> 
> 时间：2013-02-03T23:59:10.967
> 
> 标签：php, html, forms, email

基本上我的页面上有一个表格，当用户填写并发送时，发送给我的代码是（PHP）：

```
$webmater = myemail@mail.com;
$from = $user_name;
$body = "Name: $user_name \n".
        "E-mail: $user_email \n".
        "Subject: $user_subject \n".
        "Message: $user_message \n";
$headers = 'From: '.$from.' <'.$user_email.'>' . "\r\n" . 'Reply-To: ' . $user_email;
mail($server, $user_subject, $body, $headers); 
```

有没有办法在 $body 中插入页面？喜欢：

```
$body = "<html>Lalalala.......</html>"; 
```

我实际上尝试过，但页面最终将我构建的所有代码发送给我。基本上我不希望将那个“糟糕”的信息文本发送到电子邮件。我想要它有某种设计。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:01:55.577

只需将 HTML 内容类型添加到标题中：

```
$body = "<html>Lalalala.......</html>";
$headers = 'From: '.$from.' <'.$user_email.'>' . "\r\n" . 'Reply-To: ' . $user_email . "\r\n";
$headers .= "Content-Type: text/html; charset=ISO-8859-1";
mail($server, $user_subject, $body, $headers); 
```

阅读这篇精彩的文章：[**使用 PHP 发送漂亮的 HTML 电子邮件**](http://css-tricks.com/sending-nice-html-email-with-php/)。

# java - 文件.删除（）；什么也没发生

> ID：14678801
> 
> 赞同：2
> 
> 时间：2013-02-04T00:00:24.990
> 
> 标签：java, file-io

我以前也有过这种情况，我这辈子都不记得问题是什么了……

我试图使用`file.delete();`，但文件没有被删除，没有错误或任何东西，所以试试这个：

```
public void removeFile(File file){
     file.delete();
     System.out.println(file.canRead());
     System.out.println(file.canWrite());
     System.out.println(file);
     System.out.println(file.delete());
 } 
```

它返回：

```
C:\contest\dpd\
true
true
C:\contest\dpd\out\408.OUT
false 
```

注意：在 Windows 7 上运行。有问题的文件没有被任何其他程序打开，它没有只读设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T01:04:03.487

好的，根据我的评论，答案是我很愚蠢。

该文件用于：

```
 BufferedReader reader = new BufferedReader(new FileReader(file)); 
```

阅读器未关闭

> reader.close();

也许如果有人遇到这种问题并遇到这个问题，请追溯文件的使用，检查它被访问的位置，检查任何正在使用它的东西，在调用删除函数之前释放它。

# javascript - 下拉列表选择

> ID：14678802
> 
> 赞同：0
> 
> 时间：2013-02-04T00:00:27.883
> 
> 标签：javascript, html, function, select, onclick

当在 DropDownList 中选择一个项目时，我能否请一些帮助来调用 Javascript 函数 (getSelectedFilterText)。

这是我的代码：

```
<select id="FeedBackFilter" name="FeedBackFilter" width="2000" onclick="getSelectedFilterText">
    <option value="All">All</option>
    <option value="Bad">Bad</option>
    <option value="Good">Good</option>
    <option value="Both">Both</option>
</select>

function getSelectedFilterText()
{
    alert("test");
    var e = document.getElementById("FeedBackFilter");
    var strUser = e.options[e.selectedIndex].text;
    alert(strUser);
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:07:29.827

首先你需要像这样的括号：

```
onclick="getSelectedFilterText()" 
```

但是，如果您只希望在他们更改选择时发生这种情况，您应该考虑使用事件“onchange”，如下所示：

```
onchange="getSelectedFilterText()" 
```

这样，当他们更改选项时就会发生这种情况，而不是当他们单击它时……这是不同的，他们可以在不更改选项的情况下单击它

# javascript - 图像返回值“null”

> ID：14678803
> 
> 赞同：0
> 
> 时间：2013-02-04T00:00:28.813
> 
> 标签：javascript, html, image, null

我有一个 javascript 代码，它使用`getElementById`. 但是当我在萤火虫中调试它时，它说我的变量的值为“null”。这是我的代码：

```
var image = document.getElementById('myImage');

image.src = "imageone.png"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:03:58.277

那是因为没有具有该 ID 的元素。

如果元素实际上具有该 id，则原因是代码运行时尚未解析该元素。将其放入`load`事件中以在整个页面被解析后运行它：

```
window.onload = function() {
  var image = document.getElementById('myImage');
  image.src = "imageone.png";
}; 
```

或者，您可以将脚本块放在`body`图像标签下方的元素中。

# css - css3 移动媒体查询

> ID：14678805
> 
> 赞同：1
> 
> 时间：2013-02-04T00:00:44.490
> 
> 标签：css

我对肖像和风景有不同的看法

```
 /* portrait ----------- */
    @media only screen 
    and (max-width : 320px) {
      body{
         padding:20px;
        }
    }

  /* landscape----------- */
      @media only screen 
    and (min-width : 321px) {
     body
        {
        padding:60px;
        }
    }
  /* webpage----------- */
       body
            {
            padding:0px;
            } 
```

但是，横向 css 对网页视图的影响。我如何溢出网页？我试图在网页上进行另一个媒体查询，但没有奏效。我也只尝试`(min-device-width : 321px)`过设备，但它不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:43:17.107

如[本文](http://www.1stwebdesigner.com/css/how-to-use-css3-orientation-media-queries/)所述，媒体查询规范包括方向检测。它应该看起来像这样：

```
@media screen and (orientation:landscape) and (min-width:321px) {
    foo {
        padding:60px;
    }
}

@media screen and (orientation:portrait) and (max-width:320px) {
    foo {
        padding:20px;
    }
} 
```

等等。

# c# - 如何控制查询的结果是null还是空

> ID：14678808
> 
> 赞同：0
> 
> 时间：2013-02-04T00:01:01.043
> 
> 标签：c#, .net

我的项目中有 SqlConnection，我想控制我的查询结果

```
public IEnumerable<Product> ListPrpductByCategory(int ID)
{

    var dr = db.ExecuteReader(@"SELECT P.ID,P.CategoryID,P.Name,P.SupplierID,p.UnitPrice,p.UnitsInStock,pp.PicturePath 
                                FROM Products P 
                                LEFT JOIN ProductPhoto PP ON p.ID=PP.ProductID   
                                WHERE P.CategoryID=@ID",
                                Values: new object[] { ID });
    while (dr.Read())
    {
        yield return new Product()
        {
            ID = dr.GetInt32(0),
            CategoryID = dr.GetInt32(1),
            SupplierID = dr.GetInt32(3),
            Name = dr.GetString(2),
            UnitPrice = dr.GetDecimal(4),
            UnitInstock = dr.GetInt16(5),
            PicturePath = dr.GetString(6)
        };
    }
    dr.Close();

    //...
} 
```

如果没有图片，它会抛出我想控制`dr.GetString(6)` 的错误

```
if(dr.GetString(6)==null)
    PicturePath="Noimage.jpg"; 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T01:04:54.300

我通常把它们写成：

```
PicturePath = dr.IsDBNull(6) ? "Noimage.jpg" : dr.GetString(6) 
```

此外，您应该将数据读取器包装在一个`using`语句中：

```
using(var dr = db.ExecuteReader(...))
{
    while (dr.Read())
    {
        ...
    }
} //no need to call Close, as Dispose already closes the reader. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T00:03:05.453

尝试使用[空合并运算符](http://en.wikipedia.org/wiki/Null_coalescing_operator)

```
PicturePath = GetString(6) ?? "Noimage.jpg", 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T00:03:33.813

尝试[IsDBNull](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.isdbnull.aspx)：

```
if(dr.IsDBNull(6))
PicturePath = "Noimage.jpg";
else
PicturePath = dr.GetString(6); 
```

# c++ - 如何在选择文件夹对话框中为静态控件的背景着色？

> ID：14678810
> 
> 赞同：0
> 
> 时间：2013-02-04T00:01:31.257
> 
> 标签：c++, winapi, styles, controls

我的意思是为标题栏下方的描述对话框着色。我成功地在那里改变了字体，但背景完全不同。

正如我在各处阅读的那样，它是通过捕获 WM_CTLCOLORSTATIC 消息来完成的，但是没有人在我应该捕获此消息的位置放置完整的代码，此代码是我所理解的，我已将其放入对话框的回调过程中。

问题是 WM_CTLCOLORSTATIC 永远不会被调用。

```
#include <windows.h>
#include <iostream>
#include <shlobj.h> //for Shell API, dir dialog
#include <commctrl.h>

int CALLBACK BrowseCallBackProc( HWND hwnd, UINT uMsg, LPARAM lParam, LPARAM lpData) {
  switch(uMsg) {
    case BFFM_INITIALIZED: {
      HWND static_control = NULL;
      char szClassName[_MAX_PATH];
      for (HWND hChild = GetWindow(hwnd, GW_CHILD); hChild != NULL; hChild =  GetNextWindow(hChild, GW_HWNDNEXT))
      {
        if ((GetWindowLong(hChild, GWL_STYLE) & WS_VISIBLE) == 0) continue;
        GetClassName(hChild, szClassName, _countof(szClassName));
        if (!strcmp("Static",szClassName)) {
          static_control = hChild;
          break;
        }
      }
      HFONT hFont = CreateFont (13, 0, 0, 0, FW_DONTCARE, FALSE, FALSE, FALSE, ANSI_CHARSET, OUT_TT_PRECIS, CLIP_DEFAULT_PRECIS, DEFAULT_QUALITY, DEFAULT_PITCH | FF_DONTCARE, TEXT("Fixedsys"));
      SendMessage(static_control, WM_SETFONT, (WPARAM)hFont, TRUE);
      break;
    }
    case WM_CTLCOLORSTATIC: {
      std::cout << "WM_CTLCOLORSTATIC fired!" << std::endl;
      break;
    }
  }
}

int main() {
  using namespace std;
  BROWSEINFOW bi;
  LPITEMIDLIST pidl;
  LPMALLOC pMalloc;
  if (SUCCEEDED (::SHGetMalloc (&pMalloc))) {
    ::ZeroMemory (&bi,sizeof(bi));  
    bi.hwndOwner = NULL;
    bi.lpszTitle = L"ok, now how to make my background... yellow for example ?";
    bi.pszDisplayName = 0;
    bi.pidlRoot = 0;
    bi.ulFlags = BIF_NEWDIALOGSTYLE | BIF_VALIDATE | BIF_USENEWUI | BIF_UAHINT;
    bi.lpfn = BrowseCallBackProc;
    bi.lParam = (LPARAM)L"d:\\";
    pidl = ::SHBrowseForFolderW(&bi);
  }
  system("pause");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:19:48.510

[您可以使用SetWindowSubclass](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762102%28v=vs.85%29.aspx)函数对对话窗口进行子类化。

在指定的回调函数中，您将收到`WM_CTLCOLORSTATIC`消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:28:04.513

[MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762598%28v=vs.85%29.aspx)提到您传递给的回调过程仅`::SHBrowseForFolder`用于接收四种类型的事件：

*   `BFFM_INITIALIZED`
*   `BFFM_IUNKNOWN`
*   `BFFM_SELCHANGED`
*   `BFFM_VALIDATEFAILE`

这些事件都与`WM_CTLCOLORSTATIC`消息无关，被发送到父窗口的窗口过程。

# javascript - 有没有办法提高这个可拖动世界地图的性能？

> ID：14678811
> 
> 赞同：0
> 
> 时间：2013-02-04T00:01:44.177
> 
> 标签：javascript, webkit, maps, draggable

我为游戏实现了一个简单的可拖动世界地图，但是使用不同的浏览器时性能会有所不同——这很明显。我使用了 256x256 像素图块，脚本动态渲染数字以填充整个窗口和边框。

原型： http: [//mt111102.students.fhstp.ac.at/draggable/game.html](http://mt111102.students.fhstp.ac.at/draggable/game.html)

目前我只是通过在 mousemove 上设置`top`和样式属性来做到这一点。`left`这是一个片段：

```
mouseDown : function(e) {
    Map.myPreventDefault(e);

    dx = map.offsetLeft - e.clientX;
    dy = map.offsetTop - e.clientY;

    map.addEventListener('mousemove', Map.divMove, false);
},

divMove : function(e) {
    Map.myPreventDefault(e);

    map.style.position = "absolute";
    map.style.cursor = "move";

    map.style.left = e.clientX + dx + "px";
    map.style.top = e.clientY + dy + "px";
} 
```

稍后当拖动到边界时，我将使用 XHR 加载新图块并在另一端删除旧图块以保持性能，以便包装器不会变大。

我的问题是：使用 CSS translate 而不是仅仅设置`top`and`left`属性会更高效吗？你们有**什么**技巧可以让它更流畅吗？

在 Firefox 中，原型几乎可以完美运行，但在 Chrome 等 Webkit 浏览器中，它看起来不太好——它有点滞后。我只是想知道谷歌地图是如何让它在每个现代浏览器中以同样的流畅度工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:13:13.767

CSS 变换，尤其是具有 Z 值（将变换加载到 GPU 中）的 CSS 变换几乎总是更快、更流畅——尤其是在 iPad 等设备上，但在其他设备上也是如此。

有关更多详细信息，您可以查看有关 GPU 加速的本教程：

*   [http://creativejs.com/2011/12/day-2-gpu-accelerate-your-dom-elements/](http://creativejs.com/2011/12/day-2-gpu-accelerate-your-dom-elements/)

# bash - 使用 inotify 检查目录修改

> ID：14678812
> 
> 赞同：0
> 
> 时间：2013-02-04T00:01:46.187
> 
> 标签：bash, inotify

我开始 bash 脚本，并且我正在制作一个脚本来备份任何修改的目录。修改包括新文件/文件夹和对现有文件的修改。我将如何使用 inotify 进行此操作？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T13:26:59.007

我认为您正在寻找该工具`inotifywait`。

例如：

```
inotifywait -r -m -e modify -e create <one_or_more_dirs> |
while read line
do
     echo $line
done 
```

# java - 读取 NfcA MifareClassic NFC 标签

> ID：14678825
> 
> 赞同：3
> 
> 时间：2013-02-04T00:03:20.850
> 
> 标签：java, android, nfc, mifare

我有不同的标签：

*   亚马逊标签：NfcA [http://www.amazon.de/gp/product/B00AESJ3B0/ref=oh_details_o00_s00_i00](http://www.amazon.de/gp/product/B00AESJ3B0/ref=oh_details_o00_s00_i00)
*   我的钥匙：NFCA
*   一些广告标签：NfcA、Ndef、MifareUltraLight

我想读出我的钥匙。UID 是`20 66 be 52`，ATQA 是`00 40`SAK 是`00 08`（ATQA 和 SAK 与来自 Amazon 的密钥相同，所以我猜它也是 Mifare Classic 1KB）

每当我试图`transceive(byte[])`抓住`TagLostException`. 有趣的事实：广告标签效果更好，但仍然抛出`IOException: Transceive failed`

尝试将标签（对于我的密钥）解析为`IsoDep`或`MifareClassic`抛出`Nullpointer`. 只能`NfcA`工作，但我无法从标签中读取任何数据。

有人可以提供我的有效命令或任何其他方式从 Android 读取内容吗？

```
MifareClassic mfc = MifareClassic.get(tagFromIntent);
mfc.connect(); //Nullpointer 
```

**编辑：**似乎问题可能出在我的 Nexus 4 上（主要是为 NFC 东西买的 :( ）它似乎不支持 MIFARE Classic 标签。但如果你还有想法把它们写下来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:43:43.687

好的，现在很清楚：Nexus 4 不支持 MIFARE Classic（例如 MIFARE Ultralight 有效）

它**可以**读取 UID、ATQA 和 SAK，但**不能**写入或读取块/扇区。

遗憾的是，像 Nexus 4（以及 Nexus 10）这样的高端/旗舰设备无法读取最流行的标签。

# java - 如何从 PNG 图片构建个人 JFrame

> ID：14678831
> 
> 赞同：1
> 
> 时间：2013-02-04T00:04:47.237
> 
> 标签：java, image, swing, jpanel, paint

我尝试从 PNG 图片构建我的个人 JFrame。但是 Mac OSX 10.8 和 Windows 7 之间存在不同的行为。（我必须使用 JDK 6）

这是我的代码：

```
[...]

public Fenetre()
{

    this.setLocationRelativeTo(null);
    this.setUndecorated(true);
    this.setBackground(new Color(0,0,0,0));

    try {
        image = ImageIO.read(this.getClass().getResource("/Images/frame.png"));     
    } catch (IOException e) {
        e.printStackTrace();
    }

    this.setSize(image.getWidth(),image.getHeight());                
    this.setLayout(null);

    panel = new JPanel();
    JButton quit = new JButton("Quitter");
    panel.add(quit);
    Dimension size = panel.getPreferredSize();
    panel.setBounds(67, 45, size.width, size.height);

    this.add(panel);

    this.addMouseListener(this);
    this.addMouseMotionListener(this);
    this.setVisible(true);      

}

public void paint(Graphics g) {

    Graphics2D g2 =(Graphics2D) g;
    g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC)); // SRC_ATOP > Windows
    g2.drawImage(image, 0, 0, this);
    panel.update(panel.getGraphics());

}

[...] 
```

Mac OSX 10.8 (AlphaComposite = SRC) 上的结果：

[http://imageshack.us/photo/my-images/15/maczr.png/](http://imageshack.us/photo/my-images/15/maczr.png/)

然后，在 Windows 7 (AlphaComposite = SRC_ATOP) 上，在启动和移动它时，我可以看到：

[http://imageshack.us/photo/my-images/16/windowsqu.jpg/](http://imageshack.us/photo/my-images/16/windowsqu.jpg/)

怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T00:15:30.490

您的代码不完整，但在我看来，您正在覆盖 JFrame 的 paint() 方法。你永远不应该这样做（除非你知道你在做什么并且你调用了 super.paint(..)）！

如果要在框架中显示图像，则可以：

a) 将带有图像的 JLabel 添加到框架
b) 或通过覆盖 paintComponent() 方法在 JPanel 上进行自定义绘画，然后将面板添加到框架。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-04T00:28:15.507

你不尊重油漆链

```
public void paint(Graphics g) {
    // You must call super.paint somewhere here...

    Graphics2D g2 =(Graphics2D) g;
    g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC)); // SRC_ATOP > Windows
    g2.drawImage(image, 0, 0, this);
    panel.update(panel.getGraphics());

} 
```

你不应该打电话给`Component#update`.

```
 panel.update(panel.getGraphics()); 
```

这是由重绘管理器代表您调用的，它调用`paint`.

`paint`调用`paintComponent`，`paintBorder`并且`paintChildren`未能遵守绘制链意味着没有调用这些方法，它们非常重要

正如 camickr 所指出的，您永远不需要覆盖`paint`顶级容器的方法，例如`JFrame`.

相反，创建一个能够为您执行绘画的自定义组件并将其设置为框架内容窗格......

```
this.setLocationRelativeTo(null);
this.setUndecorated(true);
this.setBackground(new Color(0,0,0,0));

setContentPane(new FancyPaintPane());

pack(); 
```

和`FancyPaintPane`

```
public class FancyPaintPane extends JPanel {

    private BufferedImage image;

    public FancyPaintPane() {
        try {
            image = ImageIO.read(this.getClass().getResource("/Images/frame.png"));
        } catch (IOException e) {
            e.printStackTrace();
        }

        setOpaque(false);
    }

    @Override
    public Dimension getPreferredSize() {
        return new Dimension(image.getWidth(), image.getHeight());
    }

    @Override
    protected void paintComponent(Graphics g) {
        super.paintComponent(g); //To change body of generated methods, choose Tools | Templates.
        Graphics2D g2 = (Graphics2D) g.create();
        g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC)); // SRC_ATOP > Windows
        g2.drawImage(image, 0, 0, this);
        g2.dispose();
    }
} 
```

您也不应该在`Graphics`不恢复上下文的情况下修改上下文。这些是同一顶级容器内所有组件的共享资源。更好的方法是创建一个副本，您可以在完成后对其进行操作和处置...

您还试图在不先将组件标记为透明的情况下显示具有透明元素的组件。这会产生令人讨厌的油漆伪影。你应该称之为`JComponent#setOpaque`传递一个`false`值。

我也强烈建议您不要使用`null`布局。他们有一个讨厌的习惯，回来咬你。

**用简单的例子更新**

![在此处输入图像描述](../Images/bafdff2ce13c30deb22bab77387acc80.png)

```
public class CirclePaneTest {

    public static void main(String[] args) {
        new CirclePaneTest();
    }

    public CirclePaneTest() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                CirclePane circlePane = new CirclePane();
                circlePane.setLayout(new BorderLayout());
                circlePane.addMouseListener(new MouseAdapter() {
                    @Override
                    public void mouseClicked(MouseEvent e) {
                        if (e.getClickCount() == 2) {
                            System.exit(0);
                        }
                    }
                });

                JLabel label = new JLabel("Look Ma, I'm a circle");
                label.setHorizontalAlignment(JLabel.CENTER);
                label.setVerticalAlignment(JLabel.CENTER);

                JFrame frame = new JFrame("Test");
                frame.setUndecorated(true);
                frame.setBackground(new Color(0, 0, 0, 0));
                frame.setContentPane(circlePane);
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(label);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class CirclePane extends JPanel {

        public CirclePane() {
            setOpaque(false);
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(200, 200);
        }

        protected int getRadius() {
            return Math.min(getWidth(), getHeight()) - 1;
        }

        @Override
        public Insets getInsets() {

            int radius = getRadius();
            int xOffset = (getWidth() - radius) / 2;
            int yOffset = (getHeight() - radius) / 2;
            Insets insets = new Insets(
                    radius / 6,
                    radius / 6,
                    radius / 6,
                    radius / 6);

            return insets;
        }

        @Override
        protected void paintComponent(Graphics g) {

            super.paintComponent(g);

            int radius = getRadius();
            int xOffset = (getWidth() - radius) / 2;
            int yOffset = (getHeight() - radius) / 2;

            Graphics2D g2d = (Graphics2D) g.create();
            g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setColor(getBackground());
            g2d.fillOval(xOffset, yOffset, radius, radius);
            g2d.setColor(Color.GRAY);
            g2d.drawOval(xOffset, yOffset, radius, radius);
            g2d.dispose();

        }
    }
} 
```

**更新了 Java 7 的代码**

应使用以下代码将框架设置为在 Java 6 下透明。

```
JFrame frame = new JFrame("Test");
frame.setAlwaysOnTop(true);
frame.setUndecorated(true);
try {
    Class<?> awtUtilsClass = Class.forName("com.sun.awt.AWTUtilities");
    if (awtUtilsClass != null) {

        Method method = awtUtilsClass.getMethod("setWindowOpaque", Window.class, boolean.class);
        method.invoke(null, frame, false);
    }

} catch (Exception exp) {
}
//frame.setBackground(new Color(0, 0, 0, 0));
frame.setContentPane(circlePane); 
```

# ios - 使用带有 RubyMotion 的静态 iOS 库

> ID：14678837
> 
> 赞同：1
> 
> 时间：2013-02-04T00:05:15.010
> 
> 标签：ios, objective-c, static-libraries, rubymotion

我对 RubyMotion 很感兴趣，但想在支付许可费之前了解更多关于使用 3rd 方 iOS 框架的信息。

我在[此处](http://www.rubymotion.com/developer-center/guides/project-management/)的第 2.2 节中看到，它指出：

> “要在 RubyMotion 项目中供应第 3 方库，源代码必须在文件系统的某处可用。”

我对 iOS 框架的理解本质上是一个静态库（.a 文件）和一堆头文件，**没有**源代码 - 这似乎向我暗示，无法将 RubyMotion 使用 3rd 方 iOS 框架。

但是，阅读此文档进一步说明可以将项目类型与（静态库名称数组）和（包含公共头文件的目录的路径）一起提供`:static`给方法。这似乎与源代码必须可用的断言相矛盾。`vendor_project``:products``:headers_dir`

所以我的问题 - 是否可以在无法访问源代码的情况下使用带有 RubyMotion 的闭源第 3 方 iOS 框架？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T09:26:06.417

是的，这是完全可能的。我认为文档的含义只是您需要包含您在项目中使用的所有内容。

您可以使用 xcode 项目，也可以使用带有多个头文件的静态库（.a 文件）（也可能是一些 Objective-c 包装文件）。

在你的 Rakefile 中这样的东西就可以完成这项工作！

```
app.vendor_project('vendor/your-lib-name', :static,
    :products => ['lib.a'],
    :headers_dir => 'lib-header-path') 
```

这是[一篇](http://markvillacampa.com/2012/06/09/how-to-use-objective-c-libraries-with-rubymotion/)我觉得很有帮助的文章，它很好地解释了如何在 RubyMotion 中使用 3rd 方库。

除了手动在项目中包含库之外，您还可以使用 Cocoapods 上可用的库。有一个 RubyMotion 包装器 - motioncocoapods ，我最近写[了一篇](http://www.moodstocks.com/2013/01/28/the-moodstocks-real-time-image-recognition-sdk-now-available-as-a-pod-on-cocoapods/)关于这个主题的文章，如果你有兴趣可以看看。

# php - Doctrine2 ORM 不会刷新在脚本之外更改的对象

> ID：14678838
> 
> 赞同：5
> 
> 时间：2013-02-04T00:05:33.073
> 
> 标签：php, symfony, doctrine-orm

我真的不知道如何命名或搜索已经发布的问题，所以如果之前在这里看到过，我深表歉意。

使用以下代码，我得到了一些不希望的结果：

```
// get object managers
$fooManager = $this->getContainer()->get('foo_manager');
$barManager = $this->getContainer()->get('bar_manager');

// infinite loop
for (;;) {

    // keep getting unitialized "foo" objects, or quit if none
    while (($foo = $fooManager->findUninitialized()) !== null) {

        // an uninitialized "foo" will need to make a "bar" object
        $bar = $barManager->create();
        $bar->setA('...');

        // save "bar" to database, update() WILL perform a flush()
        $barManager->update($bar);

        // make the association of "bar" to "foo"
        $foo->setBar($bar);

        // save "foo" to database, update() WILL perform a flush()
        $fooManager->update($foo);

    }

    // keep getting unprocessed "foo" objects, or quit if none
    while (($foo = $fooManager->findUnprocessed()) !== null) {

        // process the data from "foo" object's "bar"
        process($foo->getBar()->getB());

    }

} 
```

您可以看到在第一个`while`循环中，`$bar`正在制作对象并将其放入数据库中。另一个脚本正在接受这些并对它们做事。

在第二个`while`循环中，`$foo`对象试图访问它们修改过的“bar”对象（注意`getB()`被调用，我们可以假设在另一个单独执行的脚本中`setB()`用于更改对象的状态）。

但是，在第二个循环中，当我调用 时`getB()`，它不会返回我`setB()`在其他脚本中设置的值。

我可以确保所有数据都正确地持久化（并刷新）到数据库中，因此当`getB()`在第二个循环中调用

我注意到的一件事是，在日志文件中，当我在第二个循环中调用时，我没有看到一个查询来提取“bar”的数据`$foo->getBar()`（这些应该是延迟加载的）。此外，如果我`var_dump()`从第二个循环中返回的值`$foo->getBar()`，它看起来与关联的“bar”对象在第一个循环结束时看起来完全一样。

我在想有某种缓存或正在发生的事情（因为我在脚本执行的早期更改了那些“条形”对象，Doctrine 似乎只是重新使用那些而不是从数据库中重新加载它们的数据）。

我知道我想要做的可能并不常见。我正在做的是使用 Symfony2 控制台命令功能编写一些命令行“守护程序”来帮助处理一些数据；包含此代码的“守护程序”与另一个“守护程序”一起运行，该“守护程序”处理那些被创建的“条形”对象。

好奇是否有办法在我调用该`$foo->getBar()`方法时将其修复到我的第二个循环中的位置，我实际上是从数据库中提取更新的数据。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-24T12:56:33.800

This was really provided by the user [ChocoDeveloper](https://stackoverflow.com/users/1502830/chocodeveloper). Making use of the `refresh($entity)` method on the entity manager solved my problem.

For example:

```
$em->refresh($entity); 
```

# jquery - JSON & jQuery 定义

> ID：14678839
> 
> 赞同：0
> 
> 时间：2013-02-04T00:05:37.600
> 
> 标签：jquery, ajax, json

我在开发基于用户数据 API 的脚本时遇到问题。

我创建了一个函数`getUserData(username, what);`，它的作用是这样的；

```
var lasuniAPI = "script/data.php";
$.getJSON(lasuniAPI, { p: 'userdata', data: username}, function(data){
    return data.userdata.what;
}); 
```

我想要定义“什么”，但遗憾的是我得到了未定义的回报。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:18:32.130

在您的函数中执行此操作：

控制台.log（数据）；

console.log() 将准确地告诉您返回变量中的内容。（如果您不知道 console.log() 输出信息的位置，请阅读开发人员工具。在 chrome 中，转到 View->Developer->Javascript 控制台。

另一件有价值的事情是 Chrome 开发者工具中的网络标签。它将准确地告诉您哪些标头和变量正在发送到服务器以及服务器响应的内容。

您可能还想确保服务器返回的 JSON 字符串根据 jsonlint.com 是有效的。

# php - PHP exec 和 OSASCRIPT？

> ID：14678840
> 
> 赞同：0
> 
> 时间：2013-02-04T00:05:42.347
> 
> 标签：php, apache, exec, osascript

我有一个小苹果脚本如下：

```
beep
delay 2
tell application "Finder" to activate 
```

它只是发出声音，等待 2 秒，然后将“Finder”窗口置于前台。

当我从命令行运行它时，它工作正常。

然后我希望 PHP 使用 exec() php 函数调用该脚本。

```
<?
$cmd = "/usr/bin/osascript \"myscript.scpt\"";
exec($cmd);
?> 
```

它仍然可以正常工作。

但是当我从浏览器调用相同的 PHP 脚本时，它不起作用！PHP 启动，Apple 脚本也启动，因为我能听到哔声，但它的最后一行没有执行。

我认为这将是一个环境变量，所以我确保它们与终端中的方式相同：

```
$cmd = "HOME='/Users/mikael' && … && /usr/bin/osascript \"myscript.scpt\""; 
```

变量设置正确（与 env|sort 检查），但在浏览器中显示的 php 脚本中运行我的苹果脚本并使用标准的 MacOS apache 东西仍然没有运气。

任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:09:41.750

当`osascript`通过 Web 服务器从 PHP 运行时，它没有在登录上下文中运行，因此它无法将 Apple 事件发送到在桌面上运行的应用程序（如 Finder）。`osascript`如果您尝试通过 SSH使用，您会发现会出现类似的问题。

登录上下文是 OS X 中一个复杂的、文档记录不充分的区域。如果您想了解更多关于登录上下文的信息，您可能希望获得 Amit Singh 的[*Mac OS X Internals: A Systems Approach的副本。*](http://books.google.com/books?id=K8vUkpOXhN4C&pg=PA1066)

但是，如果您不这样做，答案通常很简单：不要依赖于`osascript`Web 服务器的正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T06:31:06.053

我遇到了同样的麻烦，并意识到 apache 以用户 www 执行。您可以通过编辑 etc/apache2/httpd.conf 来更改它。将用户更改为您的用户短名称，将组更改为员工。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T00:57:45.907

好的，我可能已经找到了一种允许从浏览器中从 PHP 调用 Apple 脚本的方法。

这并不完全令人满意，但这就是我要做的：

所以基本上我没有使用默认的 macOS apache 服务器，而是使用这个设置 Web 服务器和 MySQL 的服务器：http: [//www.mamp.info/en/index.html](http://www.mamp.info/en/index.html)

我提到了 MAMP，但可能还有其他。

我的 Apple 脚本终于使用该解决方案完全运行。

# django - 在 admin 中使用 readonly_fields 在 TextField 中保留格式文本

> ID：14678845
> 
> 赞同：4
> 
> 时间：2013-02-04T00:06:29.907
> 
> 标签：django, django-admin, django-models

我在管理员中有一个文本字段，其中包含来自 txt 文件的文本。我的 txt 有换行符。问题是当 TextField 位于 readonly_fields 中时，所有换行符都消失并且所有内容都被分组。如何在 readonly_fields 模式下使用该字段保持格式？不在 readonly_fields 中时不会发生此问题。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-19T02:07:24.837

我仍在使用 django 1.3，终于找到了解决方案。因此，如果其他人仍在这条船上：

覆盖模板 fieldset.html（从 pythondir/djangodir/django/contrib/admin/templates/admin/includes/fieldset.html 复制到 djangoprojectdir/templates/admin/includes/fieldset.html）

它包含以下行：

```
 {% if field.is_readonly %}
                            <p>{{ field.contents }}</p> 
```

将它们更改为：

```
 {% if field.is_readonly %}
                            <p>{{ field.contents|linebreaksbr }}</p> 
```

这是在尝试 Danny 的解决方案后发现它不起作用，因为从内容函数返回的文本被转义以用转义码替换标签（“<”代表“<”等），然后阅读：[https：/ /code.djangoproject.com/ticket/19226](https://code.djangoproject.com/ticket/19226)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T07:22:27.163

当您查看页面的源代码时，您会看到换行符。该空格在浏览器中显示为单个空格。您需要将所有换行符 ( `\n`) 转换为 HTML 换行符 ( `<br />`) 以使其看起来符合您的要求。

选项 1： jQuery 来拯救。

像这样的东西：

```
 <script type="text/javascript">
      (function($) {

        $(document).ready(function() {
       // Adjustments for read-only fields:
       // a) Convert quoted HTML entities back to HTML
            $('.readonly').each(function() {
                // Ensure there isn't valid html in the field
                // The RegEx checks for any valid html opening tag
                {% comment %}
                TODO: It would be better to check against a special class name
                on the widget
                {% endcomment %}
                if ($(this).html().match(/<(\w+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/) == null) {
                  $(this).html($(this).text());
                  $('ul', this).addClass('with_bullet');
                  $('li', this).addClass('with_bullet');
                }
            });

            // b) Insert &nbsp; into empty <p>'s (m2m fields) so they don't break layout
            // (see comment on text nodes: http://api.jquery.com/empty-selector/)
            $('p.readonly:empty').each(function() { $(this).html('&nbsp;') })
        });
      })(django.jQuery);
    </script> 
```

（注意：我们添加了“with_bullet”类，因为我们使用了 grappelli，并且 ul 和 li 的样式没有项目符号（list-style-type: none）所以这是一种让它们重新出现在我们自己的 CSS 中的方法。 ..) 还要注意最后的布局修复，我认为在更高版本的 grappelli 中不需要。

选项 2：monkeypatch django.contrib.admin.helpers.AdminReadonlyField：

```
from django.contrib.admin import helpers
from django.contrib.admin.util import (lookup_field,
    display_for_field, label_for_field, help_text_for_field)
from django.core.exceptions import ObjectDoesNotExist
from django.db.models.fields.related import ManyToManyRel
from django.forms.util import flatatt
from django.template.defaultfilters import capfirst
from django.utils.encoding import force_unicode, smart_unicode
from django.utils.html import escape, conditional_escape
from django.utils.safestring import mark_safe

class BetterAdminReadonlyField(object):
    def __init__(self, form, field, is_first, model_admin=None):
        label = label_for_field(field, form._meta.model, model_admin)
        # Make self.field look a little bit like a field. This means that
        # {{ field.name }} must be a useful class name to identify the field.
        # For convenience, store other field-related data here too.
        if callable(field):
            class_name = field.__name__ != '<lambda>' and field.__name__ or ''
        else:
            class_name = field
        self.field = {
            'name': class_name,
            'label': label,
            'field': field,
            'help_text': help_text_for_field(class_name, form._meta.model)
        }
        self.form = form
        self.model_admin = model_admin
        self.is_first = is_first
        self.is_checkbox = False
        self.is_readonly = True

    def label_tag(self):
        attrs = {}
        if not self.is_first:
            attrs["class"] = "inline"
        label = self.field['label']
        contents = capfirst(force_unicode(escape(label))) + u":"
        return mark_safe('<label%(attrs)s>%(contents)s</label>' % {
            "attrs": flatatt(attrs),
            "contents": contents,
        })

    def contents(self):
        from django.contrib.admin.templatetags.admin_list import _boolean_icon
        from django.contrib.admin.views.main import EMPTY_CHANGELIST_VALUE
        field, obj, model_admin = self.field['field'], self.form.instance, self.model_admin
        try:
            f, attr, value = lookup_field(field, obj, model_admin)
        except (AttributeError, ValueError, ObjectDoesNotExist):
            result_repr = EMPTY_CHANGELIST_VALUE
        else:
            if f is None:
                boolean = getattr(attr, "boolean", False)
                if boolean:
                    result_repr = _boolean_icon(value)
                else:
                    result_repr = smart_unicode(value)
                    if getattr(attr, "allow_tags", False):
                        result_repr = mark_safe(result_repr)
            else:
                if value is None:
                    result_repr = EMPTY_CHANGELIST_VALUE
                elif isinstance(f.rel, ManyToManyRel):
                    result_repr = ", ".join(map(unicode, value.all()))
                else:
                    result_repr = display_for_field(value, f)
        return conditional_escape(result_repr)

helpers.AdminReadonlyField = BetterAdminReadonlyField 
```

你可以把它放在一个文件夹“monkeypatches”中并称之为“admin_readonly_field.py”（不要忘记添加一个空`__init__.py`文件夹以使该文件夹成为一个模块）。然后在您的应用程序中`__init__.py`添加

```
from monkeypatches import admin_readonly_field 
```

你走了。

上面的代码只包含monkeypatch AdminReadonlyField 的相关导入和代码（在本例中从Django 1.3 复制）。与原始课程相比，实际上没有任何变化。更改您认为对您的情况最有用的任何内容。

在您的特定情况下，您可以将这两行添加到倒数第二行：

```
 result_repr = display_for_field(value, f)

        if isinstance(field, models.TextField):
            result_repr = result_repr.replace('\n', '<br />') 
```

（`from django.db import models`在顶部）

很抱歉，Django 附带的课程太糟糕了，选项 2 是我推荐的方法。您的 TextField 并不是唯一在只读模式下看起来很糟糕的字段...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T07:39:44.897

文本中的换行符通常由字符`\n`或`\r`或经常表示`\r\n`（查看[维基百科上的这篇文章以](http://en.wikipedia.org/wiki/Line_break_%28computing%29)获取更多信息）。

您遇到的问题是这些字符将用于在文本编辑字段中显示新行，但它们不代表 html 中的新行（它们被忽略）。

如果您希望它们显示在只读字段中，则可以将它们替换为`<br/>`元素。

如果您可以将您的字符串标记为[安全](https://docs.djangoproject.com/en/1.4/ref/utils/#module-django.utils.safestring)（即，如果您可以安全地添加 html 代码，而没有任何人使用该字段添加恶意代码的风险），那么您可以覆盖模型上的 save 方法以将文本换行符换成 html 行休息 -

```
from django.utils.safestring import mark_safe

def save(self, *args, **kwargs):
    self.text_field = mark_safe(self.text_field.replace("\n", "<br/>"))
    super(YourModel, self).save(*args, **kwargs) 
```

[另一种选择是使用django-tinymce 之](http://django-tinymce.readthedocs.org/en/latest/)类的插件添加全文格式化功能。

我的最后一个建议是用 javascript 破解它。将 admin 文件夹添加到您的模板，然后创建一个 base_site.html 文件，该文件扩展了原始文件并添加了一个简单的 javascript 函数（如此[处](https://docs.djangoproject.com/en/1.4/ref/contrib/admin/#overriding-admin-templates)所述）。就像是 -

```
{% extends "admin/base.html" %}

{% block extrahead %}
    <script type="text/javascript">
        window.onload = function () {
            var p_elements = document.getElementById('content-main').getElementsByTagName('p');
            var unixNewLine = new RegExp("\n", "g");
            for (var i = p_elements.length - 1; i >= 0; i--) {
                p_elements[i].innerHTML = p_elements[i].innerHTML.replace(unixNewLine, '<br/>');
            }
        }
    </script>
{% endblock %} 
```

您需要为`replace`文本中的每种类型的新行添加一个（例如`\r`，`\r\n`）。虽然这可能会满足您的需求，但它似乎是所有这些中最肮脏的黑客。

# javascript - 使用 JS 或 JQuery 的多个条件/禁用选择选项？

> ID：14678846
> 
> 赞同：1
> 
> 时间：2013-02-04T00:06:33.390
> 
> 标签：javascript, jquery

根据这个小提琴（[http://jsfiddle.net/Qu44s/](http://jsfiddle.net/Qu44s/)），我试图有更多的条件，而不仅仅是 2 个选择字段 -> [http://jsfiddle.net/tet8M/](http://jsfiddle.net/tet8M/)但不知道该怎么做. :(

例如：

```
Green -> XS -> Femal -> V-Neck, U-Neck

Blue -> S, M -> Male, Female -> V-Neck

Yellow -> L, XL -> unisex -> short-arms, long-arms 
```

抱歉，我绝对不适合 JS 或 JQ，但也许有人知道如何解决这个问题。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:25:39.517

只需扩展您拥有的内容并禁用不相关的选项。

见[演示](http://jsfiddle.net/xkKd7/5/)。

```
var availableSizesForColors = {
    '2': ['6'],
    '3': ['7', '8'],
    '4': ['9', '10']
};

var availableGendersForColors = {
    '2': ['13'],
    '3': ['12', '13'],
    '4': ['14']
};

var availableExtrasForColors = {
    '2': ['18', '19'],
    '3': ['18'],
    '4': ['16', '17']
};

$('#color').change(function() {
    var availableSizes = availableSizesForColors[this.options[this.selectedIndex].value];
    var availableGenders = availableGendersForColors[this.options[this.selectedIndex].value];
    var availableExtras = availableExtrasForColors[this.options[this.selectedIndex].value];
    $('#size option').prop('disabled', function () { return $.inArray(this.value, availableSizes) == -1 });
    $('#sex option').prop('disabled', function () { return $.inArray(this.value, availableGenders) == -1 });
    $('#extra option').prop('disabled', function () { return $.inArray(this.value, availableExtras) == -1 });
}); 
```

`color`如果未选中，则禁用表单的其余部分。

```
$('#color').change(function() {
    $('#size').val('5');
    $('#sex').val('11');
    $('#extra').val('15');
    if (this.options[this.selectedIndex].value == 1) {
        $('#size,#sex,#extra').attr("disabled", "disabled");
    } else {
        $('#size,#sex,#extra').removeAttr("disabled");
    }
});
$('#color').trigger('change'); 
```

# java - 如何将参数从漂亮的 URL 传递到 JSP 页面？

> ID：14678851
> 
> 赞同：1
> 
> 时间：2013-02-04T00:06:52.387
> 
> 标签：java, jsp, servlets, friendly-url

我试图一次做两件事，但我似乎没有找到可以同时做两件事的答案。

我正在尝试这个：

**我希望以结尾的 URL`/user/{parameter}`映射到可以访问参数的 JSP 页面 user.jsp。**

我找到了使用这种方法将参数从 web.xml 文件传递​​到 JSP 的方法

```
<init-param>
<param-name>someParam</param-name>
<param-value>itsValue</param-value>
</init-param> 
```

我找到了创建 URL 过滤器并将它们映射到 Java Servlet 的方法。

我需要的是一个组合。此外，我在将 URL 参数传递给 Servlet 时发现的内容也不是很详细，因此也非常欢迎提供一个很好的参考！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T01:42:14.167

> *我希望以 /user/{parameter} 结尾的 URL 映射到一个 JSP 页面 user.jsp，我可以在其中访问参数。*

映射一个 servlet`/user/*`并用于`HttpServletRequest#getPathInfo()`提取路径信息。

例如

```
@WebServlet("/user/*")
public class UserServlet extends HttpServlet {

    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String pathInfo = request.getPathInfo(); // "/{parameter}"
        // ...
        request.getRequestDispatcher("/WEB-INF/user.jsp").forward(request, response);
    }

} 
```

基本上就是这样。使用常用`String`方法，如`substring()`和/或`split()`将路径信息分解为可用部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T01:22:44.310

使用 base-url servlet 解析 URL 并执行条件 servlet 转发到适当的 JSP。

```
request.getRequestDispatcher().forward(JSPurl) 
```

假设您有一个 URL 分支`/sales/`。在此 URL 分支下，您将允许以下 URL 由以下 URL 提供服务`/implemented/usersales.jsp`：

*   /sales/liquour/users/{地区}
*   /sales/liquour/soft/users/{地区}
*   /sales/toiletries/users/{type}

以及以下 URL 由`/implemented/products.jsp` - /sales/groceries/products/{section} - /sales/groceries/meat/products/{region} - /sales/groceries/vegetables/beans/products/{region}提供服务

您将有一个用于将 servlet 类 org.myorg.SalesHandler 映射到 /sales/ 的 web.xml servlet 映射。

在 org.myorg.SalesHandler servlet 类中的服务方法覆盖中，分析 URL 模式（使用正则表达式或其他方式），然后使用有条件地转发请求

```
request.getRequestDispatcher().forward(JSPurl) 
```

### JAX-RS

但是，当我们有 jax-rs 时，你为什么要这样做呢？

[如何从 JAX-RS 服务转发到 JSP？](https://stackoverflow.com/questions/6984338/how-to-forward-from-a-jax-ws-service-to-jsp).

JAX-RS 乍一看可能令人望而生畏，但实际上实现起来非常简单直观。

# android - Android 可以从 webview 页面获取信息？

> ID：14678858
> 
> 赞同：0
> 
> 时间：2013-02-04T00:08:24.693
> 
> 标签：android, webview

应用程序是否可以根据 webview 中的打开页面执行特定功能？例如检测其中的一些javascript？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:29:12.143

Android 文档的这一部分可能会有所帮助：http: [//developer.android.com/guide/webapps/webview.html#UsingJavaScript](http://developer.android.com/guide/webapps/webview.html#UsingJavaScript)

您可以使用 loadUrl() 在 WebView 上调用 javascript。例如：

```
webView.loadUrl("javascript: someJavascriptMethod(true, 1, 8, 'some string');"); 
```

该页面还可以使用 Javascript 接口将数据传回 Java 代码。使用公共方法创建一个公共类。然后，创建该类的实例并使用[webView.addJavascriptInterface()安装它](http://developer.android.com/reference/android/webkit/WebView.html#addJavascriptInterface%28java.lang.Object,%20java.lang.String%29)

例如

```
 public class JsObject {
    @JavascriptInterface
    public String toString(String value) { // This method can be called from Javascript }
 }
 webView.addJavascriptInterface(new JsObject(), "injectedObject");
 webView.loadData("", "text/html", null);
 webView.loadUrl("javascript:alert(injectedObject.aJavaMethod('some value'))"); 
```

如果您需要查看某个 javascript 方法是否可用，或者如果您需要从 DOM 中读取，您可以使用 loadUrl 调用一些可以为您执行这些查找的 javascript。然后，您可以使用 javascript 接口调用具有某种响应的 Java 方法。

# java - 爪哇 | ^M 的 CSV 问题

> ID：14678860
> 
> 赞同：0
> 
> 时间：2013-02-04T00:08:31.660
> 
> 标签：java, csv

我对这个烦人的 ^M 有疑问，在导出一些数据时，将其写入要下载的 CSV 文件。我做了一些研究，发现如果您正在读取的文件来自 Windows 系统，则会发生此问题（Windows 使用 CR（即 ^M）/LF 对来指示行尾，而 UNIX 仅使用 LF）。

现在任何人都可以在将其提交给作者之前为我提供解决此问题的解决方案（例如消除或替换 ^M ）（writer.write(columnToBeInserted);）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:17:22.187

您可以使用`unix2dos`和`dos2unix`分别转换 UNIX 和 Windows 文件。两者都可以在 *nix 和 Windows 平台上使用。阅读[更多](https://www.ibm.com/developerworks/mydeveloperworks/blogs/nix/entry/dos2unix_and_unix2dos_converting_between_dos_and_unix_part_12?lang=en)。

适用于 Windows 的链接

*   [Dos2Unix](http://sourceforge.net/projects/dos2unix/)

*   [Unix2Dos](http://download.cnet.com/Unix2DOS/3000-2381_4-10488164.html)

另请参阅[如何在 java 中将文件从 Dos 转换为 Unix](https://stackoverflow.com/questions/9374991/how-to-convert-files-from-dos-to-unix-in-java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T00:24:00.980

当你阅读每一行时

```
line.replaceAll("\\p{Cntrl}", ""); 
```

或使用工具为您完成

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T00:18:01.727

在 linux/unix 环境中，有一个称为实用程序的实用程序`dos2unix`，`unix2dos`它将文件从 windows 转换为 linux 格式，反之亦然。

在 Windows 上检查此链接并下载实用程序，该实用程序将从 Windows 转换为 linux 格式[http://www.sg-chem.net/u2win/](http://www.sg-chem.net/u2win/)

# python - 尝试返回字符串中元音的索引

> ID：14678862
> 
> 赞同：0
> 
> 时间：2013-02-04T00:09:35.583
> 
> 标签：python

对于这段代码，我几乎拥有它，以便它返回某些索引，但它计算同一索引中的多个元音。我刚刚意识到 index() 只返回该项目的第一次出现，但现在我已经用尽了其他可能性。

```
def vowel_indices(s):
'string ==> list(int), return the list of indices of the vowels in s'
res = []
for vowel in s:
    if vowel in 'aeiouAEIOU':
        res = res + [s.index(vowel)]
return res 
```

这种工作的一个例子是：

> vowel_indices('你好世界')
> 
> [1, 4, 7]

相反，我最终得到 [1,4,4] 作为回报。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T00:12:02.207

使用列表比较`enumerate`：

```
vowel_indices = [idx for idx, ch in enumerate(your_string) if ch.lower() in 'aeiou'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T00:16:09.703

你的问题是`.index()`在你的元音第一次出现时停止，所以后面出现的重复元音不会被注意到。

而不是 using `.index()`，而是使用一个计数器变量（有点像 C++`for`循环）：

```
def vowel_indices(s):
    res = []
    index = 0

    for vowel in s:
        index += 1

        if vowel.lower() in 'aeiou':
            res.append(index)

    return res 
```

或使用`enumerate()`：

```
def vowel_indices(s):
    res = []

    for index, vowel in enumerate(s):
        if vowel.lower() in 'aeiou':
            res.append(index)

    return res 
```

# ember.js - 如何使用 Ember 的 V2 路由器保存路径并返回

> ID：14678863
> 
> 赞同：3
> 
> 时间：2013-02-04T00:09:38.327
> 
> 标签：ember.js, ember-router

所以，我对 Ember 的新路由器有一些问题。我正在尝试保存并稍后返回给定动态段的当前路径，所以我的网址可能看起来像

```
#/inventory/vehicle/1001 
```

然后可以分支到

```
#/inventory/vehicle/1001/details
#/inventory/vehicle/1001/photos
#/inventory/vehicle/1001/description 
```

等等。我需要一种方法来返回最近的路线。Ember 指南在这里有一个方法：

[http://emberjs.com/guides/routing/redirection/](http://emberjs.com/guides/routing/redirection/)

这种方法的问题在于，通过创建“/choose”路线并将其分配给“/”，这会覆盖标准的“/inventory/vehicle/1001”路线。例如，如果我要尝试像这样创建一个 linkTo 车辆：

```
{{#linkTo "vehicle" vehicle}} 
```

然后 Ember 会抛出错误，因为“车辆”路线不再存在。相反，它必须设置为：

```
{{#linkTo "vehicle.choose" vehicle}} 
```

哪个有效，激活 VehicleChooseRoute 和一切。除了，由于“vehicle.choose”在技术上是“vehicle”的子项，#linkTo 只有在当前路线为

```
#/inventory/vehicle/1001 
```

它会立即重定向到最新的过滤器，所以它基本上永远不会打开。所以基本上我试图找出解决这个问题的方法。我尝试将“vehicle.choose”的路径更改为标准路径（#/inventory/vehicle/1001/choose），这样它就不会覆盖“vehicle”路线，然后像这样设置 VehicleRoute：

```
Case.Router.map(function() {
  this.resource('inventory', function(){
    this.route('review');
    this.route('sheets');
    this.resource('vehicle', { path: '/vehicle/:vehicle_id' }, function(){
      this.route('choose');
      this.route('details');
      this.route('consignor');
      this.route('additional');
      this.route('price');
      this.route('dmv');
      this.route('expenses');
      this.route('description');
      this.route('tasks');
    });
  });
});

App.VehicleRoute = Ember.Route.extend({
  model: function(params) {
    return Case.Vehicle.find(params.vehicle_id);
  },
  setupController: function(controller, model) {
    model.set('active', true);
  },
  redirect: function() {
    this.transitionTo('vehicle.choose');
  }
})

Case.VehicleChooseRoute = Ember.Route.extend({
  redirect: function() {
    var lastFilter = this.controllerFor('vehicle').get('lastFilter');
    this.transitionTo('vehicle.' + (lastFilter || 'details'));
  }
}); 
```

但是由此产生的问题（除了感觉相当黑客之外）是重定向替换了通常由“车辆”呈现的整个模板，所以我只得到子视图。所以这不是一个选择。

# extjs - 同步存储后如何读取附加响应数据

> ID：14678864
> 
> 赞同：3
> 
> 时间：2013-02-04T00:09:39.727
> 
> 标签：extjs, extjs4, response

我有以下情况。我有一个与我的服务器同步的 TreeStore。服务器响应返回带有附加属性“additionalTask​​s”（存储一些服务器生成的新节点信息）的修改节点数据。如果商店的所有侦听器都已经获得了实例化的记录对象而不是原始响应数据，我如何获得此属性的值？我尝试将此附加字段添加到我的模型中，但是当我检查侦听器函数中记录的值时，它们显示为空。

```
 Ext.define('ExtendedTask', {
        extend: 'Ext.data.NodeInterface',
        fields: [
            { name : 'additionalData', type : 'auto', defaultValue : null, persist : false}
        ]
    });

var store = Ext.create("Ext.data.TreeStore", {
    model : 'ExtendedTask',
    autoSync: false,
    proxy : {
        method: 'GET',
        type : 'ajax',
        api: {
            read : 'tasks.js',
            update : 'update.php',
            create : 'update.php'
        },
        reader : {
            type : 'json'
        }
    },
    listeners: {
        update : function(){
            console.log('arguments: ', arguments);
        }
    }
}); 
```

这是我的 update.php 响应：

```
<?php
echo '[ { "Id" : 1,'.
    '"Name" : "Planning Updated",'.
    '"expanded" : true,'.
    '"additionalData": ['.
    '    {'.
    '        "Name" : "T100",'.
    '        "parentId" : null'.
    '    }'.   
    ']'.
']';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T20:53:54.437

商店的代理始终保留最新请求的原始响应。尝试这样的事情，看看你需要的信息是否在那里。

```
update : function(){
   console.log(this.proxy.reader.rawData);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T05:31:44.310

我遇到了同样的问题。我最终要做的是使用标准树模型属性（我使用过`cls`）来处理您尝试加载到模型中的任何自定义数据。我可能是错的，但从我开始研究这个问题开始，似乎 extjs 迫使树模型只使用标准字段。他们说：

> 如果没有指定模型，将创建一个实现 Ext.data.NodeInterface 的隐式模型。标准的树字段也将被复制到模型上以维护它们的状态。这些字段列在 Ext.data.NodeInterface 文档中。

然而，从测试看来，无论是否指定了模型，似乎只有标准字段可用。我能找到的唯一解决方法是使用我不需要的标准字符串类型字段 like `cls`，尽管我很想看看是否有人找到了更好的方法。

[http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.TreeStore](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.TreeStore)

# sql-server-2008 - SQL 查询 - 同一列上的多个 COUNT 具有来自嵌套 SELECT 查询的不同值

> ID：14678869
> 
> 赞同：7
> 
> 时间：2013-02-04T00:10:31.987
> 
> 标签：sql-server-2008, select, count, nested

我正在努力使用正确的 SQL 语法来返回一列中特定值的计数。

此查询有效（可能语法不正确，但 SQL Server 2008 似乎很高兴）

```
SELECT StudentID, count(UnApproved)as Late, count(Unapproved) as Absent from results
WHERE unapproved=1 and StudentID in 
  (
    SELECT studentid  FROM [Results] 
    WHERE StudentYearLevel='10' and Date > 20130101) group by StudentID
  ) 
```

当然，由于 'where' 的位置，`Late`和列都返回相同的值。`Absent`

因此，这是（从右侧）确定属于“Year 10”成员的学生的 ID。

然后，对于返回的每个学生 ID，我需要它返回未批准缺勤类型为 1 的未批准缺勤计数，并在下一列中返回类型为 2 的未批准缺勤计数。

如果我尝试像这样提交查询：-

```
SELECT StudentID, count(UnApproved)as Late where unapproved=2, count(Unapproved) as Absent from results 
where unapproved=1 and StudentID in 
  (
    SELECT studentid  FROM [Results] where StudentYearLevel='10' and Date > 20130101
  )
group by StudentID 
```

SQL Server 破解了它，并用红色给几乎整个查询加了下划线。

我需要结束这三列：-

`StudentID | Late | Absent`

并且三列具有具有适当计数的学生 ID。

我可以做最基本的选择查询，但是当涉及到嵌套查询、联合、连接、内部时，我已经超出了我的深度。非常感激任何的帮助。我决不能确定我的（工作）查询结构是否正确，因为我对此很擅长。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-04T00:13:06.793

```
SELECT StudentID, 
SUM(case when Unapproved =1 then 1 else 0 end) as Late, 
SUM(case when Unapproved =2 then 1 else 0 end) as Absent 
from results where 
StudentID in (SELECT studentid FROM [Results] where StudentYearLevel='10' and Date > 20130101) 
group by StudentID 
```

# javascript - 显示默认隐藏的内容？

> ID：14678877
> 
> 赞同：-4
> 
> 时间：2013-02-04T00:11:00.677
> 
> 标签：javascript, jquery, html

我有一个我正在制作的小型 jQuery 游戏的代码，默认情况下所有图片（字符）都是隐藏的。有一个问题是“你准备好玩了吗？” 和一个是或否按钮。当您单击是按钮时，它会隐藏按钮和文本。它还应该显示第一张图像，即#main。由于某种原因，它不起作用。这是带有以下图像的jQuery代码：

```
$(document).ready(function(){
$('#main,#batman,#car,#hobo,#knife,#gangfight,#ganggun,#gangknife,#blood').hide(-100);  
var main=$('#main');  
 batman=$('#batman');  
 car=$('#car');
 hobo=$('#hobo');
 cop=$('#cop');
 knife=$('#knife');
 gangfight=$('#gangfight');
 ganggun=$('#ganggun');
 gangknife=$('#gangknife');
 blood=$('#blood');
    document.write('<title>LOAUP</title>');
    document.write('<center><h1>The life of an unlucky person</h1></center>');
    document.write('<center id="start">Are you ready to play?</center>');
    document.write('<center><button id="yes">Yes</button><button id="no">No</button></center>');
    $('#yes').click(function(){
        $('#yes,#no').hide(function(){
            $('#start').hide();
            $('#main').show
        });
        });
    $('#no').click(function(){
        $('#yes,#no').hide();
        $('#start').hide();
        document.write('<center>Ok, come back another time then.</center>');
    });
});
//Images below this (HTML)
<img id='main' src='/jquery/sprites/spritePerson.png' />
    <img id='batman' src='/jquery/sprites/spriteBatman.png' />
    <img id='car' src='/jquery/sprites/spriteCar.png' />
    <img id='hobo' src='/jquery/sprites/spriteHobo.png' />
    <img id='cop' src='/jquery/sprites/spriteCop.png' />
    <img id='knife' src='/jquery/sprites/spriteKnife.png' />
    <img id='gangfight' src='/jquery/sprites/spriteGangFight.png' />
    <img id='ganggun' src='/jquery/sprites/spriteGangGun.png' />
    <img id='gangknife' src='/jquery/sprites/spriteGangKnife.png' />
    <img id='blood' src='/jquery/sprites/spriteBloodPuddle.png' /> 
```

**编辑：**

这是示例：http: [//jsbin.com/ocowas/1](http://jsbin.com/ocowas/1)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T01:41:31.637

在您的#main 点击功能更改

```
$('#main').show 
```

至

```
$('#main').show(); 
```

您的变量列表应该用逗号分隔而不是冒号分隔。并且您可能还想重命名您的变量，以通过前缀 $ 符号使它们更明显和更容易阅读/记住。例如，当您将选择器存储为变量时，请使用

```
var $element = $('#element'),
    $element2 = $('#element2'),
    $element23 = $('#element23'); 
```

此外， hide() 函数不会像您使用的那样采用负数。只需使用 hide() 进行即时隐藏，或使用 hide(100) 进行快速隐藏，使用 hide(2000) 进行慢速.. 检查：[http ://docs.jquery.com/Effects/hide](http://docs.jquery.com/Effects/hide)

例如，要在不使用 document.write 的情况下将 html 附加到文档中，可以将 html 存储为变量，然后选择 body 标记或任何其他标记，然后将 html 附加/前置或替换到该位置。

```
$('body').append(yourHTMLvar);
$('body').prepend(yourHTMLvar);
$('body').html(yourHTMLvar); 
```

'title' 标签应该只出现在 html 文档的 'head' 标签之间。改用标题标签，从“h1”到“h6”。据我所知，html 'center' 标签也已被弃用。尝试改用“span”、“p”甚至“div”。

# jquery - prettyPhoto 不显示所有图片

> ID：14678878
> 
> 赞同：0
> 
> 时间：2013-02-04T00:11:08.887
> 
> 标签：jquery, html, css, twitter-bootstrap, prettyphoto

所以我刚刚使用 twitter-bootstrap 模板完成了一个网站，偶然发现了一个小问题。在本地运行页面时，一切正常，但是将页面上传到虚拟服务器后，prettyPhoto拒绝显示网站上一半的图片，说：请求的URL /img/gallery/gallery-04.jpg is not在这台服务器上找到。

正如我所说，当我在本地运行页面时，一切正常。我检查并仔细检查了所有必要的脚本，一切似乎都井井有条。无论如何，这是我的代码：

```
<div class="span6 YDCOZA usability packaging">
                <div class="single-item">
                    <div class="img-box">
                        <img src="img/gallery/gallery-04.jpg" alt="Alt Text" width="960"; height="720"; >
                        <div class="single-navigation">
                            <a class="fullimage" rel="prettyPhoto" href="img/gallery/gallery-04.jpg">
                            <div class="full-image">
                            </div>
                            </a>
                        </div>
                        <!-- .single-navigation -->
                    </div>
                    <!-- .img-box -->

                </div>
                <!-- .single-item -->
            </div>

<!-- Footer Scripts -->
<script src="js/libs/bootstrap/bootstrap.min.js"></script>
<script src="js/jquery.easing.1.3.js"></script>
<script src="js/jquery.flexslider-min.js"></script>
<script src="js/jquery.hoverIntent.minified.js"></script>
<script src="js/plugins.js"></script>
<script src="js/jquery.prettyPhoto.js"></script>
<script src="js/jquery.isotope.min.js"></script>
<script src="js/script.js"></script>

 <!-- Header Scripts -->
 <link rel="stylesheet" href="css/prettyphoto.css">
 <script src="js/libs/jquery-1.7.2.min.js"></script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T01:08:13.170

检查图像路径。大概这是个问题。

尝试在图像路径上删除第一个 / 。所以它将是 img/gallery/gallery-04.jpg

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T11:29:43.583

我发现了问题。问题是：文件路径是image.jpg，文件名是image.JPG。所以这实际上是文件扩展名中的小写/大写。现在我觉得自己很愚蠢。那好吧。我们生活，我们学习。

# command-line - 如何编写包含字符串的 msdeploy runco mmand 命令

> ID：14678881
> 
> 赞同：0
> 
> 时间：2013-02-04T00:11:51.567
> 
> 标签：command-line, command-prompt, msdeploy

您好我正在尝试编写一个 msdeploy 命令，该命令在命令的 runco​​mmand 部分中包含两个字符串。

msdeploy.exe -verb:sync -source:runCommand="^"c:\opensesame\opensesame.cmd^" ^"c:\windows\system32^"" -dest:auto

我试图用克拉来逃避引号。

基本上假设发生的是调用 opensesame 并将路径传递给它，以便它可以打开计算器。

我猜我没有正确的转义字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T03:47:53.863

如果`runCommand`没有给出*bat*或*cmd*文件的完整路径（并且只有完整路径），它将在服务器上按*原样*执行命令，而无需先上传*bat/cmd*文件。如果要在执行脚本之前上传脚本，则需要将参数烘焙到脚本中，并将其不带参数传递给`runCommand`.

# android - Android - 如何为 2 种语言的字符串使用 2 个“值”文件夹？

> ID：14678884
> 
> 赞同：1
> 
> 时间：2013-02-04T00:12:34.140
> 
> 标签：android, xml, eclipse

我计划让我的应用程序成为双语、英语和德语。
我有两个文件夹`/values`，现在突然找不到我的字符串，给我所有字符串的以下错误

```
"Error: No resource found that matches the given name (at 'text' with value '@string/stringname') 
```

我如何告诉它在我的所有字符串所在的新文件夹中查找？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T00:16:24.793

你不需要里面有 2 个文件夹`values`。在`values`你保留你的`strings.xml`文件（从这里它将获取英语字符串）并创建另一个文件夹，在里面你`res/`将`values-de`创建文件的副本`strings.xml`并只翻译内容。安卓系统会根据手机使用的语言选择合适的内容。

# c# - MVC4 ValidationMessageFor

> ID：14678885
> 
> 赞同：1
> 
> 时间：2013-02-04T00:12:36.417
> 
> 标签：c#, jquery, .net, asp.net-mvc-4, html-helper

我有一个视图，它使用 ValidationMessageFor 访问模型中包含的数据注释，并且没有问题。但是，我不想在相关控件之外显示验证消息（作为标准做法），而是在用户将鼠标悬停在验证警告图标上时显示验证消息。

我已经设法让这部分工作，但它需要在用户单击验证警告图标之前有问题的控件具有焦点，否则它不会显示任何内容。是否可以通过 jQuery 检索验证消息？

模型：

```
[Required(ErrorMessageResourceName = "EmailRequiredErrorMessage", ErrorMessageResourceType = typeof(Resources.Languages.Models.RegistrationValidateModel))]
[StringLength(60, ErrorMessageResourceName = "EmailStringLengthErrorMessage", ErrorMessageResourceType = typeof(Resources.Languages.Models.RegistrationValidateModel))]
[Display(Name = "EmailDisplayName", ResourceType = typeof(Resources.Languages.Models.RegistrationValidateModel))]
[RegularExpression(@".+@.+\..+", ErrorMessageResourceName = "EmailInvalidRegularExpressionErrorMessage", ErrorMessageResourceType = typeof(Resources.Languages.Models.RegistrationValidateModel))]
public string Email { get; set; } 
```

看法

```
@Html.ValidationMessageFor(m => m.Email) 
```

生成的 HTML

```
<input class="span12" data-val="true" data-val-length="You must enter an email address less than 60 characters long" data-val-length-max="60" data-val-regex="You must enter a valid email address" data-val-regex-pattern=".+@.+\..+" data-val-required="You must enter an email address1" id="Email" name="Email" type="text" value="" /> 
```

...

```
<span class="field-validation-valid" data-valmsg-for="Email" data-valmsg-replace="true"></span> 
```

目前，验证后悬停无法检索错误消息

![在此处输入图像描述](../Images/f3f9d19f643354c1bd6e79e14cb56204.png)

但是，如果您给控件焦点，然后单击验证警告图标，它会显示消息（尽管位置略有不同）：

![在此处输入图像描述](../Images/8f13af8a62190572b496ba4aa2b0045f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:16:51.870

无论控件是否具有焦点，使用 jQuery 访问属性都应该没有问题。尝试

```
$("#Email").attr("data-val-required") 
```

# image - 为我的 Google Geomap 设置国家背景

> ID：14678887
> 
> 赞同：1
> 
> 时间：2013-02-04T00:12:53.823
> 
> 标签：image, replace, background-image, google-visualization, geomap

几天前，我探索了地理地图，但事实证明，更改元素的属性很容易。

但我有两个问题：

*   我想在地图上添加河流和森林。所以我考虑设置背景图像而不是地理地图图形。但我找不到解决这个问题的方法。有没有办法为一个国家或地区设置背景图片？

*   当您选择一个城市（例如“伦敦”）时，如何更改“气泡”的形状？我想把它改成正方形。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T00:45:24.490

不幸的是，您正在寻找的内容在当前实施的地理图表中不可用。

从某种意义上说，使用背景图像是可能的，您可以使用 CSS 使地图中的所有形状都透明，并在 div 中使用背景图像使其看起来好像小圆圈正在绘制在森林和河流的地图上，但你会遇到两个大障碍：

1.  您的地图需要在大小/布局上与 Google Maps SVG 相同
2.  如果 Google 更改了他们使用的 SVG（或他们使用的视图/投影），您也需要编辑您的

显然，这并不理想。您可以通过创建自定义 javascript 在地图上写入河流和森林来解决它，但这将是一个非常令人头疼的问题（特别是如果您使用多个地图/视图）。

至于圆圈，如果不使用 javascript 在后台破解实际的 SVG，就无法将它们更改为正方形。虽然这绝对是可能的（如果你真的很擅长 SVG/Javascript），但它再次没有使用 geocharts 的任何花哨功能，而更多的是一个自定义解决方案，如果/当谷歌更新时必须更新他们的 API。

与其那样做，你可能想在谷歌地图本身上查看相同的实现。这将允许您以更大的灵活性（以及更稳定的 API）使用自定义标记、绘制自定义形状等。

# eclipse - 如何使用 Eclipse 编译 Haxe 程序？

> ID：14678891
> 
> 赞同：1
> 
> 时间：2013-02-04T00:14:28.770
> 
> 标签：eclipse, eclipse-plugin, haxe

我安装了 Eclihx 插件，现在我正在尝试对其进行测试。Main.hx 的内容是

```
class Main {
    static function main() {
        trace("This is a test.");
    }
} 
```

Build.hxml 的内容是

```
-cp Source

# Uncomment the desirable target
# JavaScript target
-js Output/haxe Test.js

# SWF 9 target
-swf9 Output/haxe Test.swf

# ActionScript3 target
-as3 Output

# Neko target
-neko Output/haxe Test.n

# PHP target
-php Output

# C++ target
-cpp Output

# Uncomment and place your main class with package
-main Main 
```

项目菜单中的构建选项显示为灰色。我该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T20:44:15.393

首先，您不能一次编译所有目标，您需要注释所有目标并取消注释例如 javascript 目标。

然后，打开 Haxe 包资源管理器并选择（鼠标左键单击）您的项目（根），然后单击鼠标右键，运行方式，运行配置...

左键双击 Haxe 应用程序，您将获得 New_configuration。选择项目，设置构建文件并单击运行。您的项目已编译。进一步，您可以使用 CTRL+11 来编译您的项目。

现在，您将需要针对 javascript 目标的测试 html 文档。在输出目录（生成 .js 文件的位置）中创建 test.html 并使用如下内容：

```
<html>
<head><title>Haxe JS</title></head>
<body>
<div id="haxe:trace"></div>
<script type="text/javascript" src="hxTest.js"></script>
</body>
</html> 
```

对于 Neko，我通常将 .n 扩展名与 Neko 程序等相关联（然后您只需双击 .n 即可执行您的程序）

提示：项目属性、Haxe 内容辅助、构建文件（从您的项目中选择 build.hxml）以启用代码完成。

# java - 读取文件输入数据并将其加载到数组中

> ID：14678892
> 
> 赞同：0
> 
> 时间：2013-02-04T00:14:35.103
> 
> 标签：java

我正在开发一个从文件中读取数据并将其输入到数组中的程序。看起来它应该可以工作，但是我从程序中得到了一个奇怪的输出（没有错误，它运行，只是给了我一个奇怪的结果）。

这是我的代码：

```
 Scanner s = new Scanner(new File("../Computer/src/computers/computer.txt"));
    String[] comps = new String[2];

    int i = 0;

    while (s.hasNextLine()) {
        comps[i] = s.nextLine();
        i++;
    }
    s.close();

    System.out.println(comps); 
```

我得到的输出是：

```
[Ljava.lang.String;@3d62b333
BUILD SUCCESSFUL (total time: 1 second) 
```

另外，如果我的文本文件有问题，我的文本文件看起来像这样：

```
12344555 Dell Intel 499.99
23623626 Asus AMD 299.99 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T00:15:57.590

你不能打印这样的数组。您获得的输出是输出哈希码的默认`toString()`值`Object`。

您必须遍历它并打印每个`String`

```
for (String s : comps)
{
    System.out.println(s);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:25:58.970

您正在正确读取文件，但以不正确的方式打印数组。

使用下面打印您的阵列。

```
 for(int j =0;j<comps.length;j++)
    {
        System.out.println(comps[j]);
    } 
```

# ios - 停止 IOS 动画一次出现

> ID：14678900
> 
> 赞同：0
> 
> 时间：2013-02-04T00:15:44.507
> 
> 标签：ios, objective-c, ios-simulator

听说IOS会批量制作动画。

例如，我有大约 4 个方法可以进行一些更新（在主线程上），当它们完成时，我调用一个方法来淡入显示其完成的复选标记的图像。（见下文）但似乎它们都同时出现。我怎样才能让它们出现在每个方法调用之后？

```
[mySubClass1 UpdateAllGeneralData_Single];
[self FadeImageGeneralInfo];

[mySubClass1 UpdateAllMeetingData_Single];
[self FadeImageMeetingList];

[mySubClass1 UpdateAllSpeakerData_Single];
[self FadeImageSpeakerList]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:20:51.020

您可以使用计时器将每个后续调用延迟`FadeImage____List`一定量，或者您可以使用`UIView` `animateWithDuration:delay:options:animations:completion:`类方法来延迟每个后续动画。

如果您选择选项 2，实现它的最简单方法可能是更改`FadeImage______List`为接受延迟参数。然后，例如（如果每个动画需要 0.5 秒）：

```
[mySubClass1 UpdateAllGeneralData_Single];
[self FadeImageGeneralInfoWithDelay:0];

[mySubClass1 UpdateAllMeetingData_Single];
[self FadeImageMeetingListWithDelay:0.5];

[mySubClass1 UpdateAllSpeakerData_Single];
[self FadeImageSpeakerListWithDelay:1.0]; 
```

# android - 从同一类中的另一个方法暂停倒数计时器

> ID：14678901
> 
> 赞同：1
> 
> 时间：2013-02-04T00:15:49.377
> 
> 标签：android, countdowntimer

我正在尝试使用 .cancel() 函数暂停倒数计时器。但它不会暂停。

我的 cdTimer 是一个全局变量，以便我从其他方法访问。

```
public void startTimer()
{
    //create timer
    cdTimer = new CountDownTimer(timeLimit, 1000) {
         public void onTick(long millisUntilFinished) {
             timeLeft = (int)millisUntilFinished;
             if(millisUntilFinished < 60000)
                 timer.setText("Time : 00 : " + String.valueOf(millisUntilFinished / 1000) );
             else if(millisUntilFinished >= 60000 && millisUntilFinished < 120000)
                 timer.setText("Time : 01 : " + String.valueOf((millisUntilFinished / 2) / 1000));
             else if(millisUntilFinished >= 120000 && millisUntilFinished < 180000)
                 timer.setText("Time : 02 : " + String.valueOf((millisUntilFinished / 3) / 1000));

             if(millisUntilFinished < 20000)
                 timer.setTextColor(Color.RED);
         }
         public void onFinish() {
             showGameOverScreen();
         }
         }.start();
} 
```

然后从另一种方法，我试图像这样访问它。

```
public void pauseMenu() 
{
     cdTimer.cancel();
} 
```

有任何想法吗？

# css - JQuery Mobile 在我的 Rails 开发服务器上呈现不正确

> ID：14678904
> 
> 赞同：0
> 
> 时间：2013-02-04T00:16:15.087
> 
> 标签：css, ruby-on-rails, jquery-mobile

我很难找出这个错误。我在 JQuery Mobile 中的所有小部件在我的开发服务器上都无法正确呈现，但是当我将更改推送到 heroku 时，一切都很好。我尝试在 rails 中删除我的 tmp 文件夹，但它仍然呈现奇怪。

这是我的开发服务器和 heroku 的屏幕截图：

![开发服务器](../Images/f35ff119fb69f467f1f8077500c2055b.png)

![Heroku 上的生产服务器](../Images/f4e4065e19655ce63d126cec833a5efe.png)

我认为这与资产管道有关，但我不知道是什么原因造成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T11:59:46.483

确保删除您的 public/assets 文件夹。编译后的 css 和 js 会掩盖你的改变

# graph - Tinkerpop - 我如何在图中找到一个节点？

> ID：14678905
> 
> 赞同：3
> 
> 时间：2013-02-04T00:16:21.017
> 
> 标签：graph, gremlin, orientdb

如果不遍历整个事物，我似乎无法在图中找到特定节点。有什么我想念的吗？

我正在使用 tinkerpop 蓝图。

Orientdb 为诸如“#8:1”之类的节点提供了某种无语义的 id - 我如何在不知道 id 的情况下找到它？顶点有一个像'user=jason'这样的属性来识别它。我在想我将只使用 redis 来存储用户/位置对或以其他方式使用超级节点（不，谢谢）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-04T01:08:22.703

蓝图具有关键索引的概念。

[https://github.com/tinkerpop/blueprints/wiki/Graph-Indices](https://github.com/tinkerpop/blueprints/wiki/Graph-Indices)

给定您的示例，为“用户”定义一个键索引，然后使用键索引对其进行查询。下面是一个在 Gremlin 提示符下使用 OrientDB 的示例：

```
gremlin> g = new OrientGraph("memory://graph")
==>orientgraph[memory://graph]
gremlin> g.createKeyIndex("user", Vertex.class)
==>null
gremlin> g.addVertex([user:"Jason"])
==>v[#8:-3]
gremlin> g.addVertex([user:"Rick"])
==>v[#8:-4]
gremlin> g.stopTransaction(SUCCESS)
==>null
gremlin> g.V('user','Jason')
==>v[#8:1] 
```

# javascript - 特定于事件的方法在 Backbone.js 中悬而未决？

> ID：14678912
> 
> 赞同：0
> 
> 时间：2013-02-04T00:16:59.477
> 
> 标签：javascript, backbone.js

下面的两种方法在[主干.js](http://www.backbonejs.org)的顶级范围内。但是它们仅用于 Backbone.Events。

为什么不将它们作为属性包含在传递给 Backbone.Events 的对象文字中，就像其他方法一样？

这是为了让它们保持私密性并脱离用户 API 吗？

```
// only used in Backbone.Events
eventsApi = function(obj, action, name, rest) {
    // internals
};
// only used in Backbone.Events
triggerEvents = function(events, args) {
    // internals
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:24:43.853

> 这是为了让它们保持私密性并脱离用户 API 吗？

我会说是的。它的显示模块模式。

```
var myModule = (function() {
  var privateFn = function() { ... };

  return {
    publicFn: function() {
      return privateFn();
    }
  };
}()); 
```

或通过主干使用术语：

```
(function(){

  // other backbone code

  var eventsApi = function() { ... };
  var Events = Backbone.Events = {
    on: function() {
      // code...
      var whatever = eventsApi(some, args);
      // code...
    }
  };

  // other backbone code

}()); 
```

现在`Events.Backbone.on`是一个可以调用该函数的函数`eventsApi`，即使该`eventsApi`函数没有公开。

# java - Eclipse GWT“没有引用 CSS 文件”

> ID：14678915
> 
> 赞同：1
> 
> 时间：2013-02-04T00:17:32.843
> 
> 标签：java, css, eclipse, gwt

我正在使用 Eclipse Juno Service Release 1，安装了最新的 GWT Designer 插件并运行更新。当我在 GWT Design 中并选择小部件属性的 StyleName 行中的 CSS 按钮时，我收到消息“没有从模块或 HTML 引用的 CSS 文件”。

我的 gwt.xml 是：

```
<module>
<inherits name="com.google.gwt.user.User"/>
<inherits name="com.google.gwt.user.theme.standard.Standard"/>
<entry-point class="org.AwardTracker.client.AwardTracker"/>
<stylesheet src="org.AwardTracker.AwardTracker.css"/>

<!--  servelet context - path is arbitrary, but must match up with the rpc init inside java class -->
<!--  Tomcat will listen for this from the server and waits for rpc request in this context -->
<servlet class="org.AwardTracker.server.MySQLConnection" path="/MySQLConnection" />
    <inherits name="com.google.gwt.user.theme.standard.Standard"/>
    <inherits name="com.google.gwt.user.theme.chrome.Chrome"/>
    <inherits name="com.google.gwt.user.theme.dark.Dark"/>
</module> 
```

我的 CSS 在 org.AwardTracker 中（直接在 gwt.xml 文件上方）。

我用谷歌搜索的所有提示都是更新 GWT Designer。这些提示都是几年前的，我有最新版本。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T05:17:42.247

您必须首先在war文件夹中检查您的css文件bcoz css文件和html文件存在于war文件夹中，而不是检查html文件中的链接

```
 <link type="text/css" rel="stylesheet" href="abc.css"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T05:29:12.473

您需要使您的项目包和引用正确。您可以按照此处提供的有关项目/文件组织的解决方案 -[在 Gwt WindowBuilder 中编辑 CSS](https://stackoverflow.com/questions/6461436/editing-css-in-gwt-windowbuilder)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T05:24:31.907

由于路径的原因，似乎找不到该文件。您已经在该`xml`文件中，因此请尝试

```
<stylesheet src="AwardTracker.css"/> 
```

希望这会有所帮助。

# ios6 - 向应用商店提交 iphone 5 优化的应用

> ID：14678916
> 
> 赞同：0
> 
> 时间：2013-02-04T00:17:53.943
> 
> 标签：ios6, xcode4.5, iphone-5

当我开始在 xcode 中创建我的应用程序时，主情节提要中的所有视图控制器都是 iphone 5 4 英寸显示屏。所以我终于完成了我的 iphone 5 应用程序，但是，当我在 iphone 4 模拟器上运行该应用程序时，一切都是重叠和倾斜的。我是否必须完全复制该应用程序并将我的所有视图缩小到 iphone 4 3.5 英寸显示屏，还是直接提交应用程序原样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:36:48.590

你应该做的是：

a) 在故事板文件中打开自动布局，并确保视图在两种屏幕尺寸下都正确布局。故事板中有一个按钮可以切换大小：

![在此处输入图像描述](../Images/3425a3b98e650133147c56c689079790.png)

b）找出代码中的屏幕尺寸并相应地修改它们的位置。

选项 a) 是最容易做到的。

# apache - 使用依赖于协议的 mod_rewrite 有条件地重定向流量

> ID：14678919
> 
> 赞同：0
> 
> 时间：2013-02-04T00:18:08.587
> 
> 标签：apache, .htaccess, mod-rewrite, apache2

我一直在编写重写规则来尝试将我们的所有流量从 mysite.com.au 重定向到 www.mysite.com.au。我还需要根据是否启用 SSL 有条件地重定向。

我已经从[askapache.com进行了一些修改，以创建一个依赖于](http://www.askapache.com/htaccess/http-https-rewriterule-redirect.html)*http*或*https*的变量。下面是我正在使用的代码：

```
 RewriteCond %{HTTPS} =on
    RewriteRule ^(.+)$ - [env=ps:https]
    RewriteCond %{HTTPS} !=on
    RewriteRule ^(.+)$ - [env=ps:http]
    RewriteCond %{HTTP_HOST} ^mysite\.com\.au(.*)$ [NC]
    RewriteCond %{HTTP_HOST} !^$
    RewriteRule ^(.*)$ %{ENV:ps}://www.mysite.com.au/$1 [L,R=301] 
```

这适用于带有路径的 URL（例如 mysite.com.au/foo 重定向到 www.mysite.com.au/foo）并且*http*和*https*切换正常。

但是，当仅访问域（仅 mysite.com.au）时，它会重定向到[http://www.mysite.com.au/home/website/public_html/:/www.mysite.com.au/](http://www.mysite.com.au/home/website/public_html/:/www.mysite.com.au/)

我敢肯定这是我所缺少的非常小的和基本的东西 - 如果有人能指出它，那将不胜感激。

谢谢！

安德鲁

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T00:49:40.493

我找到了答案——这与乍一看完全不同。

我打开了*RewriteLog*并发现了问题。如果我使用原始条件/规则并使用 mysite.com.au/test 在日志中，我会看到以下内容：

```
 10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/test -> test
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.+)$' to uri 'test'
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/test -> test
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.+)$' to uri 'test'
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/test -> test
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.*)$' to uri 'test'
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (2) [perdir /home/website/public_html/] rewrite 'test' -> 'http://www.mysite.com.au/test'
    10.1.1.1 - - [11/Feb/2013:11:37:50 +1100] [mysite.com.au/sid#b81d24f8][rid#b847d100/initial] (2) [perdir /home/website/public_html/] explicitly forcing redirect with http://www.mysite.com.au/test 
```

但是，当我仅针对 mysite.com.au 运行它时，我看到：

```
 10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/ ->
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.+)$' to uri ''
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/ ->
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.+)$' to uri ''
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/ ->
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.*)$' to uri ''
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (2) [perdir /home/website/public_html/] rewrite '' -> '://www.mysite.com.au/'
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (3) [perdir /home/website/public_html/] add per-dir prefix: ://www.mysite.com.au/ -> /home/website/public_html/://www.mysite.com.au/
    10.1.1.1 - - [11/Feb/2013:11:38:16 +1100] [mysite.com.au/sid#b81d24f8][rid#b845bc18/initial] (2) [perdir /home/website/public_html/] explicitly forcing redirect with http:/.makeitmine.com.au/home/website/public_html/://www.mysite.com.au/ 
```

请注意，我尝试设置的环境变量（SSL 开/关）没有被设置。因此，它没有看到 http/https 前缀并假设它是相对内部路径！

当我尝试设置环境变量时，我使用以下代码：

```
 RewriteCond %{HTTPS} =on
    RewriteRule ^(.+)$ - [env=ps:https]
    RewriteCond %{HTTPS} !=on
    RewriteRule ^(.+)$ - [env=ps:http] 
```

^(.+)$ 的正则表达式需要至少 1 个字符，这是不匹配的！我修改如下：

```
 RewriteCond %{HTTPS} =on
    RewriteRule ^(.*)$ - [env=ps:https]
    RewriteCond %{HTTPS} !=on
    RewriteRule ^(.*)$ - [env=ps:http] 
```

现在它匹配了，即使是 0 个字符！

再次感谢您的帮助，问题已解决：）

```
 10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/ ->
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.*)$' to uri ''
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/ ->
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.*)$' to uri ''
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (3) [perdir /home/website/public_html/] strip per-dir prefix: /home/website/public_html/ ->
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (3) [perdir /home/website/public_html/] applying pattern '^(.*)$' to uri ''
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (2) [perdir /home/website/public_html/] rewrite '' -> 'http://www.mysite.com.au/'
    10.1.1.1 - - [11/Feb/2013:11:44:57 +1100] [mysite.com.au/sid#b81d24f8][rid#b8478208/initial] (2) [perdir /home/website/public_html/] explicitly forcing redirect with http://www.mysite.com.au/ 
```

# c++ - 满足条件后如何终止函数

> ID：14678920
> 
> 赞同：-1
> 
> 时间：2013-02-04T00:18:09.933
> 
> 标签：c++, c

描述：

我有一个遵循这种格式的文件：`number number number`，这里有几行：

```
0 00 19
0 900000 949999
0 9500000 9999999
1 00 09
2 00 19
2 200 349
2 35000 39999
2 900000 949999
2 9500000 9999999
3 00 02
3 7000 8499
3 9500000 9999999
4 00 19
4 7000 8499
80 00 19
80 900000 999999
81 00 19
81 900000 999999
82 990000 999999
83 7000 8499
958 95000 99999
959 7000 8499
960 85000 99999
961 00 19 
```

第一列代表`area`，第二列代表`num1`和`num2`。

我设法将每一列存储在其各自的变量中，如下所示：

```
int isRegistered(FILE* fp, int area)
{
    int finished = 1;
    int scanned_area;
    char num1[7], num2[7];
    int rc = 1;

    rewind(fp);

    while (finished != EOF) {
        finished = fscanf(fp,"%d %s %s\n", &scanned_area, &num1, &num2);
    }
    return rc;
} 
```

我知道我“不应该使用 fscanf”并且不应该在 using 中进行扫描`%s`，但是这些是特定于分配的，我无法更改它们。

现在我将所有这些数字存储在它们各自的变量中，第一列数字存储在 中`scanned_area`，第二列存储在 中`num1`，第三列存储在`num2`.

**设想**

我的面积值为 1。如何对其进行编码，以便当scanned_area == 1 时，函数停止？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:24:57.140

> 我的面积值为 1。如何对其进行编码，以便当scanned_area == 1 时，函数停止？

您可以使用`break`退出循环：

```
while (condtion)
{
  // some code
  if (scanned_area == 1)
  {
     break;
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T02:10:58.113

如果您希望函数停止，则只需返回一个适当的值，在您的情况下返回一个整数。一旦函数命中 return 语句，则返回值，执行后没有其他内容。

希望这会有所帮助：D

# sql - SQL - 如何创建一个动态矩阵，显示每个项目随时间推移的属性值（属性数量随日期变化）

> ID：14678921
> 
> 赞同：0
> 
> 时间：2013-02-04T00:18:27.573
> 
> 标签：sql, sql-server-2008, pivot, dynamic-pivot

**我有：**
`items`由一组 id 描述（GroupType、ID、Name）

`VALUES`在每个日期填充因子值的表，以便项目仅获得具有每个日期值的特定因子集。

`FACTORS`包含因子的静态描述的表。

**寻找：**

**我想创建一个临时表，其中包含一个显示每个日期每个项目的因子值的矩阵，**以便人们可以以用户友好的方式查看在给定日期填充了哪些因子（具有相应的值）。

价值观

```
Date        GroupType   ID  Name   FactorId  Value
01/01/2013        1     1   A      1         10
01/01/2013        1     1   A      2         8
01/01/2013        1     1   A      3         12

01/01/2013        1     2   B      3         5
01/01/2013        1     2   B      4         6

02/01/2013        1     1   A      1         7
02/01/2013        1     1   A      2         6

02/01/2013        1     2   B      3         9
02/01/2013        1     2   B      4         9 
```

因素

```
FactorId FactorName 
1     Factor1
2     Factor2
3     Factor3
4     Factor4
.     .
.     .
.     . 
```

# 临时表因子值矩阵

```
Date          Group       ID     Name  Factor1    Factor2      Factor3     Factor4  Factor...
01/01/2013        1        1        A       10          8           12
01/01/2013        1        2        B                                5           6

02/01/2013        1        1        A        7          6           
02/01/2013        1        2        B                                9           9 
```

任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T10:40:28.643

这种类型的数据转换称为 a [`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)，它从行中获取值并将其转换为列。

在 SQL Server 2005+ 中，有一个函数可以执行这种数据轮换。

**静态枢轴：**

如果您的值将被设置，那么您可以`FactorNames`使用静态枢轴将其硬编码到列中。

```
select date, grouptype, id, name, Factor1, Factor2, Factor3, Factor4
from
(
  select v.date,
    v.grouptype,
    v.id,
    v.name,
    f.factorname,
    v.value
  from [values] v
  left join factors f 
    on v.factorid = f.factorid
  -- where v.date between date1 and date2
) src
pivot
(
  max(value)
  for factorname in (Factor1, Factor2, Factor3, Factor4)
) piv; 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/d1132/2)。

**动态枢轴：**

在您的情况下，您声明您将拥有未知数量的值。如果是这样，那么您将需要使用动态 SQL 来生成将在运行时执行的 SQL 字符串：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(FactorName) 
                    from factors
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT date, grouptype, id, name,' + @cols + ' from 
             (
                select v.date,
                  v.grouptype,
                  v.id,
                  v.name,
                  f.factorname,
                  v.value
                from [values] v
                left join factors f 
                  on v.factorid = f.factorid
                -- where v.date between date1 and date2
            ) x
            pivot 
            (
                max(value)
                for factorname in (' + @cols + ')
            ) p '

execute(@query) 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/d1132/1)。

这两个版本都产生相同的结果：

```
|       DATE | GROUPTYPE | ID | NAME | FACTOR1 | FACTOR2 | FACTOR3 | FACTOR4 |
------------------------------------------------------------------------------
| 2013-01-01 |         1 |  1 |    A |      10 |       8 |      12 |  (null) |
| 2013-01-01 |         1 |  2 |    B |  (null) |  (null) |       5 |       6 |
| 2013-02-01 |         1 |  1 |    A |       7 |       6 |      11 |  (null) |
| 2013-02-01 |         1 |  1 |    B |  (null) |  (null) |       9 |       9 | 
```

如果要根据日期范围过滤结果，则只需`WHERE`在上述查询中添加一个子句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T03:24:10.553

看起来您只是想将行转换为列。我认为这可以满足您的要求：

```
select Date, Group, ID, Name, 
       max(case when factorid = 1 then name end) as Factor1,
       max(case when factorid = 2 then name end) as Factor2,
       max(case when factorid = 3 then name end) as Factor3,
       max(case when factorid = 4 then name end) as Factor4
from t
group by Date, Group, ID, Name 
```

# ios - Route me (Alpstein fork) for iOS 标记在更高的缩放级别中摆动

> ID：14678926
> 
> 赞同：0
> 
> 时间：2013-02-04T00:18:59.557
> 
> 标签：ios, markers, route-me

我正在尝试让 Route me 与构建地图一起工作，但我遇到了一个小问题。

尝试使用标记路由我的示例之一。当您尽可能放大时，标记开始摆动并且不会粘在地图上。它看起来不太好，它是 19 级，在建筑物中我使用 21 级并且标记只是飞来飞去。

我只是在猜测，但似乎有一些网格系统的间距很大并且标记正试图对其进行剪辑。

你有这方面的经验吗？

编辑：我发现问题出在 RMMapScrollView 中。当用户与滚动视图交互时，它不会以某种方式捕获每个像素。但只有当缩放大于 16 或类似的东西时......真的很奇怪。

我不知道如何解决它，我将切换到没有这种问题的原始路线-我。

# .net - 如果我在Framework 4下安装MVC4会不会错过一些功能

> ID：14678927
> 
> 赞同：1
> 
> 时间：2013-02-04T00:19:27.577
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-4

该版本`asp.net-mvc4`是开发到最新版本的框架（4.5）`.Net`我想知道如果我在4.0框架上安装这个框架有些功能会丢失吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T03:18:17.687

您不会错过 ASP.NET MVC 框架中的任何内容，但是您将无法使用仅在 .NET 4.5 中可用的 C# 的新异步功能。此外，如果您使用的是实体框架，请注意 EF 对枚举的支持需要 .NET 4.5。

# html - 画布透明度蒙版效果重置

> ID：14678931
> 
> 赞同：0
> 
> 时间：2013-02-04T00:20:04.683
> 
> 标签：html, canvas

我正在尝试在页面上覆盖画布，以使其看起来像已被磨砂，然后使用 mousemove 将其清除，遵循这篇文章：

[http://www.stevecalderon.com/2012/03/html5-canvas-tricks-transparency-mask-for-eraser-effect.html](http://www.stevecalderon.com/2012/03/html5-canvas-tricks-transparency-mask-for-eraser-effect.html)

我创建了一个 jsfiddle - [http://jsfiddle.net/ZWsG6/2/](http://jsfiddle.net/ZWsG6/2/)

```
var canvas = "";
var ctx = "";

function frost2(){

var int=self.setInterval(function(){clock()},1000);

canvas = document.createElement("canvas");

canvas.width = window.innerWidth;
canvas.height= window.innerHeight;
canvas.style.position = "absolute";
canvas.style.top = "0px";
canvas.style.left = "0px";
var objTo = document.getElementById("fltouch");
objTo.appendChild(canvas);

ctx = canvas.getContext('2d');

ctx.globalAlpha = 0.95;
ctx.fillStyle = "rgb(0, 255, 255)";
ctx.fillRect(0, 0, canvas.width, canvas.height);

ctx.globalCompositeOperation = 'destination-out';    

function drawPoint(pointX,pointY){

    ///scrape
    var grd = ctx.createLinearGradient(pointX - 75,pointY-5,pointX + 75,pointY + 5)

grd.addColorStop(0, "transparent"); 
grd.addColorStop(0.3, "rgba(255,255,255,.6)"); 
grd.addColorStop(0.7, "rgba(255,255,255,.6)"); 
grd.addColorStop(1, "transparent"); 

ctx.fillStyle = grd;
ctx.fillRect(pointX - 75,pointY,400,30);

    }

canvas.addEventListener('mousemove',function(e){
            e.preventDefault();
            drawPoint(e.pageX,e.pageY);
        },false);

}

function clock(){
ctx.globalAlpha = 0.95;
ctx.fillStyle = "rgb(0, 255, 255)";
ctx.fillRect(0, 0, canvas.width, canvas.height);
ctx.globalCompositeOperation = 'destination-out';    

} 
```

我添加了一个函数 clock() 来每秒运行一次并用颜色重新填充画布，以便需要再次清除它但它不起作用，只能完全删除填充。

谁能告诉如何重置画布以再次填充颜色？如果它可以慢慢完成，看起来有点像再次冻结，那将是一个奖励。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:42:13.307

在重新填充画布之前，您需要设置`globalCompositeOperation`回默认值：`source-over`

```
function clock() {
    ctx.globalCompositeOperation = 'source-over';
    ctx.globalAlpha = 0.95;
    ctx.fillStyle = "rgb(0, 255, 255)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.globalCompositeOperation = 'destination-out';
} 
```

[http://jsfiddle.net/VqCbv/1/](http://jsfiddle.net/VqCbv/1/)

# mysql - MySQL 错误代码：1193。未知的系统变量

> ID：14678934
> 
> 赞同：3
> 
> 时间：2013-02-04T00:20:45.920
> 
> 标签：mysql, mysql-workbench, error-code, mysql-error-1193

好的，所以我正在处理触发器，它告诉我它（MySQL 工作台 5.2）不识别这个变量。
***错误代码：1193。未知系统变量error_msg_3***

我认为在触发器中使用它是正确的，请帮助我

```
CREATE TRIGGER controlla_MaxCARDINALITA_INSERT
BEFORE INSERT ON SENTIERO__HA__TAPPA
FOR EACH ROW 
BEGIN

DECLARE max_cardinalita INTEGER;
DECLARE error_msg_3 CONDITION FOR SQLSTATE '99003';

SELECT COUNT(*) into max_cardinalita
FROM SENTIERO__HA__TAPPA
WHERE IDsentiero=NEW.IDsentiero;

IF max_cardinalita>=10 THEN
        SIGNAL error_msg_3;
        SET error_msg_3='INSERT: Il sentiero ha già il massimo numero di tappe consentito';

END IF;

END$$ 
```

**编辑 ：：**

我试过这个，它似乎工作

```
DECLARE msg VARCHAR(255);
set msg = concat('MyTriggerError: Trying to insert a negative value in trigger_test: ');
signal sqlstate '45000' set message_text = msg; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T00:46:32.497

根据[MySQL 文档](https://dev.mysql.com/doc/refman/8.0/en/server-error-reference.html#error_er_unknown_system_variable)，`#1193`当您使用错误的代码时会发生错误`SQLSTATE`。

> **消息**：未知的系统变量`%s`

而且，正如您在同一[页面](https://dev.mysql.com/doc/refman/8.0/en/server-error-reference.html)`99003`上看到的那样，没有定义SQLSTATE 。

# zend-framework2 - zf2 - 使用 Zend\Db\TableGateway\TableGateway 加入；

> ID：14678939
> 
> 赞同：0
> 
> 时间：2013-02-04T00:21:41.050
> 
> 标签：zend-framework2, tablegateway

我想使用 zf2 从第一个和第二个表中选择字段进行简单的连接，但是当我尝试将字段数组放入 columns 方法时出现错误（“无法执行语句”）。

```
public function fetchAll()
{
    $resultSet = $this->tableGateway->select(function (Select $select) {
        $select->columns();// ->with params gives an 'Statement could not be executed'
        $select->join(array('t2' => 'categories'), 'table1.idCategory = t2.id');
        $select->order('dateTime DESC')->limit(100);
    });  
...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T09:31:51.350

您需要确保 dateTime/id 字段位于您提供的列列表中。

如果您转储异常 ($e->getTraceAsString())，您将获得有关导致错误的原因的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T10:11:48.313

评论此语句**或**在数组中添加至少一个有效的“列”名称（表列/字段名称）。

```
$select->columns(array('column_one', 'column_two', 'column_N')); 
```

一个空白`$select->columns();`语句会生成类似于`SELECT FROM table_name`导致错误的 sql 查询。

当您注释此语句时，它会生成类似的 sql 查询`SELECT * FROM table_name` ，如果您传递列名，星号将被它们替换。

# osx-lion - 八度文档不存在

> ID：14678940
> 
> 赞同：1
> 
> 时间：2013-02-04T00:22:20.173
> 
> 标签：osx-lion, octave

```
octave:1> doc fflush 
```

> 信息：/usr/local/Cellar/octave/3.6.3/share/info/octave.info：没有这样的文件或目录

我不确定我的安装做错了什么，但是在尝试查找文档时我得到了上面的消息（`help fflush`工作正常）。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-14T16:30:47.357

我遇到了同样的问题，并通过手动将相应的 deb 存档解压缩到 brew 安装的相应位置来解决它：

从这里下载 deb：[http ://packages.ubuntu.com/de/quantal/all/octave-info/download](http://packages.ubuntu.com/de/quantal/all/octave-info/download)

```
cd ~/Downloads
mkdir doc
cd doc
ar -x ../octave-info_3.6.2-5_all.deb
tar xzf data.tar.gz 
cd usr
find . -name '*.gz' -type f -exec gunzip "{}" \;
cd ..
cp -r share /usr/local/Cellar/octave/3.6.4/
cd ~/Downloads
rm -r doc 
```

当然，您必须调整 octave 版本号以匹配最新版本和您的啤酒窖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T01:25:09.050

我不知道Mac OSC。如果您自己构建它，可能是您在构建时禁用了文档。使用包管理器...您已经检查过它没有单独的`octave-doc`包。

还有很多其他的 Mac 包管理器都有 Octave。请参阅[Octave 的 wiki](http://wiki.octave.org/Octave_for_MacOS_X)。快速浏览一下其他包管理器，似乎它们都有单独的文档包。

# asp.net - 从 SQL detailsView 中删除

> ID：14678941
> 
> 赞同：1
> 
> 时间：2013-02-04T00:22:22.193
> 
> 标签：asp.net

嘿，我只是在学习如何使用 asp.net，我正在尝试使用网格视图来显示信息和详细信息视图，以便从数据库中编辑/删除信息。现在我可以编辑和更新数据库中的信息，但我也希望将其删除，但有些东西对我不起作用。我设置了一个例外，当我选择该项目并按删除时，它会弹出我的例外，即另一个用户删除了该项目，而它没有。我不确定我做错了什么，对我来说它看起来应该有效。

这是详细信息视图中删除命令和参数的代码

```
 DeleteCommand="DELETE FROM [Customers]
     WHERE [CustomerID] = @original_CustomerID
      AND [Name] = @original_Name
       AND [Address] = @original_Address
        AND [City] = @original_City
         AND [State] = @original_State
          AND [ZipCode] = @original_ZipCode
           AND ([Phone] = @original_Phone 
            OR [Phone] IS NULL  AND @original_Phone IS NULL) 
           AND ([Email] = @original_Email 
           OR [Email] IS NULL AND @original_Email IS NULL)" 

<DeleteParameters>
        <asp:Parameter Name="original_CustomerID" Type="Int32" />
        <asp:Parameter Name="original_Name" Type="String" />
        <asp:Parameter Name="original_Address" Type="String" />
        <asp:Parameter Name="original_City" Type="String" />
        <asp:Parameter Name="original_State" Type="String" />
        <asp:Parameter Name="original_ZipCode" Type="String" />
        <asp:Parameter Name="original_Phone" Type="String" />
        <asp:Parameter Name="original_Email" Type="String" />
    </DeleteParameters> 
```

这是cs文件中的删除功能

```
protected void DetailsView1_ItemDeleted(object sender, DetailsViewDeletedEventArgs e)
{
    if (e.Exception != null)
    {
        lblError.Text = "A database error has occurred.<br /><br />" +
            "Message: " + e.Exception.Message;
        e.ExceptionHandled = true;
    }
    else if (e.AffectedRows == 0)
        lblError.Text = "Another user may have deleted that customer."
            + "<br />Please try again.";
    else
        GridView1.DataBind();
}

protected void DetailsView1_ItemDeleting(
    object sender, DetailsViewDeleteEventArgs e)
{
    e.Values["Name"]
        = e.Values["Name"].ToString().Substring(1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T05:25:06.327

为什么要对删除语句进行如此庞大的查询？在[MSDN 详细信息视图示例中查看它是如何完成的](http://msdn.microsoft.com/en-us/library/7z482d0y.aspx)

您的 SQL 表中的 CustomerID 应该是**唯一的**，因此您的删除语句应该很简单：

```
DeleteCommand="DELETE FROM [Customers] WHERE [CustomerID] = @original_CustomerID" 
```

而且只有一个删除参数：

```
<DeleteParameters>
        <asp:Parameter Name="original_CustomerID" Type="Int32" />
</DeleteParameters> 
```

另一件非常重要的事情是您需要`DataKeyNames="CustomerID"`在 DetailsView 上进行设置，以便`DetailsView1_ItemDeleted`知道要删除哪一行。希望这可以帮助！

# list - 方案流和循环列表

> ID：14678943
> 
> 赞同：1
> 
> 时间：2013-02-04T00:22:36.353
> 
> 标签：list, functional-programming, lisp, scheme, circular-list

在 Scheme/Lisp 中，我试图创建一个将列表转换为循环列表的函数。因此，我认为我需要构建一个无限流，其中列表的尾部指向列表的头部。

到目前为止，这是我的代码：

```
(define (rotate-list l1 l1copy)
  (if (null? (force (cdr l1)))
      (cons (car l1) (delay l1copy)))
      (cons (car l1) (delay (rotate-list (force (cdr l1)) l1copy)))) 
```

非常感谢所有帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-04T02:28:44.830

不，您不需要流来制作循环列表。

有两种创建循环列表的方法，标准 Scheme 方法和 Racket 方法（因为 Racket 的 conses 是不可变的）。我将查看使用[SRFI 1](http://srfi.schemers.org/srfi-1/srfi-1.html)`circular-list`函数的示例。这是参考实现：

```
(define (circular-list val1 . vals)
  (let ((ans (cons val1 vals)))
    (set-cdr! (last-pair ans) ans)
    ans)) 
```

这样做是在给定值列表中找到最后一对，并将`set-cdr!`其返回到该列表的开头。很简单，对吧？

在 Racket 中，conses 是不可变的，因此`set-cdr!`不存在。因此，Racket 是这样做的：

```
(define (circular-list val1 . vals)
  (let ([ph (make-placeholder #f)])
    (placeholder-set! ph
      (cons val1 (let loop ([vals vals])
                   (if (null? vals)
                     ph
                     (cons (car vals) (loop (cdr vals)))))))
    (make-reader-graph ph))) 
```

这使用 Racket 的[`make-reader-graph`](http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._make-reader-graph%29%29)功能来处理循环。非常漂亮。:-)

# php - 为什么 getcwd() 在 __destruct() 中返回 /？

> ID：14678947
> 
> 赞同：5
> 
> 时间：2013-02-04T00:23:18.630
> 
> 标签：php, getcwd

我刚刚注意到如果在 __destruct() 魔术函数中调用 getcwd() 返回“/”，而在任何其他方法中它返回预期路径。

你对此有什么解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T00:27:47.777

有一个[老错误](https://bugs.php.net/bug.php?id=34206)。

而不是`getcwd()`，你能用`__FILE__`吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T00:33:41.947

这是一个 SAPI 行为

“在脚本关闭期间调用的析构函数已经发送了 HTTP 标头。脚本关闭阶段的工作目录可能与某些 SAPI（例如 Apache）不同。”

来自[http://php.net/manual/en/language.oop5.decon.php](http://php.net/manual/en/language.oop5.decon.php)

但正如其他答案中提到的，有很多方法可以获取当前的相对路径。如果您在运行时更改它，请确保注意对象内部的某个位置。

# c - 如何使用 printf 重复一个字符？

> ID：14678948
> 
> 赞同：92
> 
> 时间：2013-02-04T00:23:51.730
> 
> 标签：c, printf

我想做一些类似`printf("?", count, char)`重复字符`count`时间的事情。

完成此操作的正确格式字符串是什么？

编辑：是的，很明显我可以`printf()`循环调用，但这正是我想要避免的。

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-04-30T12:25:31.440

您可以使用以下技术：

```
printf("%.*s", 5, "================="); 
```

这将在 Visual Studio 上打印`"====="` It works for me，没有理由它不应该在所有 C 编译器上工作。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2013-05-23T12:08:49.333

简短的回答 - 是的，很长的回答：不是你想要的。

您可以使用[printf](http://pubs.opengroup.org/onlinepubs/9699919799/functions/printf.html)的 %* 形式，它接受可变宽度。并且，如果您使用 '0' 作为您的打印值，*并结合*在左侧填充零的右对齐文本..

```
printf("%0*d\n", 20, 0); 
```

产生：

```
00000000000000000000 
```

我把舌头牢牢地放在脸颊上，提供了这个恐怖秀的小代码片段。

有时候，你只需要做坏事**来**记住为什么你在剩下的时间里那么努力。

```
#include <stdio.h>

int width = 20;
char buf[4096];

void subst(char *s, char from, char to) {
    while (*s == from)
    *s++ = to;
}

int main() {
    sprintf(buf, "%0*d", width, 0);
    subst(buf, '0', '-');
    printf("%s\n", buf);
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：31
> 
> 时间：2015-08-11T06:46:46.050

如果您限制自己重复 0 或空格，您可以这样做：

对于空间：

```
printf("%*s", count, ""); 
```

对于零：

```
printf("%0*d", count, 0); 
```

* * *

## 回答 #4

> 赞同：19
> 
> 时间：2013-05-15T05:21:22.733

在 c++ 中，您可以使用 std::string 来获取重复字符

```
printf("%s",std::string(count,char).c_str()); 
```

例如：

```
printf("%s",std::string(5,'a').c_str()); 
```

输出：

```
aaaaa 
```

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2013-02-04T00:26:17.590

哪有这回事。您必须使用`printf`or编写一个循环`puts`，或者编写一个将字符串计数次数复制到新字符串中的函数。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-02-04T00:53:38.860

`printf`不这样做 - 并且`printf`对于打印单个字符来说太过分了。

```
char c = '*';
int count = 42;
for (i = 0; i < count; i ++) {
    putchar(c);
} 
```

不用担心效率低下；`putchar()`缓冲其输出，因此除非需要，否则它不会对每个字符执行物理输出操作。

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2013-12-24T17:54:14.217

如果您有一个支持 alloca() 函数的编译器，那么这是可能的解决方案（虽然很丑）：

```
printf("%s", (char*)memset(memset(alloca(10), '\0', 10), 'x', 9)); 
```

它基本上在堆栈上分配 10 个字节，这些字节用 '\0' 填充，然后前 9 个字节用'x' 填充。

如果您有 C99 编译器，那么这可能是一个更简洁的解决方案：

```
for (int i = 0;  i < 10;  i++, printf("%c", 'x')); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-11-21T01:40:54.073

```
#include <stdio.h>
#include <string.h>

void repeat_char(unsigned int cnt, char ch) {
    char buffer[cnt + 1];
    /*assuming you want to repeat the c character 30 times*/
    memset(buffer,ch,cnd); buffer[cnt]='\0';
    printf("%s",buffer)
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2015-09-18T12:53:15.207

你可以制作一个功能来完成这项工作并使用它

```
#include <stdio.h>

void repeat (char input , int count )
{
    for (int i=0; i != count; i++ )
    {
        printf("%c", input);
    }
}

int main()
{
    repeat ('#', 5);
    return 0;
} 
```

这将输出

```
##### 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2018-02-27T22:27:04.320

```
char buffer[41];

memset(buffer, '-', 40);    // initialize all with the '-' character<br /><br />
buffer[40] = 0;             // put a NULL at the end<br />

printf("%s\n", buffer);     // show 40 dashes<br /> 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2014-04-27T16:26:28.637

```
printf("%.*s\n",n,(char *) memset(buffer,c,n)); 
```

`n`<= `sizeof(buffer)`[ 也可能是 n < 2^16]

但是，优化器可能会将其更改为`puts(buffer)`，然后缺少 EoS 将......

并且假设 memset 是一个汇编指令（但在芯片上仍然是一个循环）。

严格来说，给定前提条件“无循环”，没有解决方案。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-02-04T00:50:52.790

我认为做一些这样的。

```
void printchar(char c, int n){
     int i;
     for(i=0;i<n;i++)
         print("%c",c);
}

printchar("*",10); 
```

# java - 如何让java等待用户输入？

> ID：14678950
> 
> 赞同：-1
> 
> 时间：2013-02-04T00:24:09.903
> 
> 标签：java

所以，我有一个循环，它使用扫描仪输入 3 个单独的用户输入，2 个整数和一个字符串。整数工作得很好，但字符串输入不起作用。它跳过了 String 的 iput，然后再次循环请求 int。

```
for(int e = 10; e > 5; e++)
    {
        System.out.println("Enter the Y coordinate of your guess. The upper left corner is 0, and the lower left is 7");
        int guessY = inputDevice.nextInt();
        System.out.println("Enter the X coordinate of your guess. The upper left corner is 0, and the upper right is 7");
        int guessX = inputDevice.nextInt();

        display[guessX][guessY] = map[guessX][guessY];
        for(int j = 0; j < 8; j++)

                {

            for(int t = 0; t < 8; t++)

            {

                System.out.print(display[j][t] + " ");

            }

            System.out.println();

        }

        System.out.println("Enter go when you are ready to make another move.");
        System.out.println("Enter quit to give up");
        String cont = inputDevice.nextLine();

        if(cont.equalsIgnoreCase("quit"))
        {
            System.out.println("Weenie.");
            System.exit(0);
        } else if(cont.equalsIgnoreCase("go")) {
            for(int i = 0; i < 100; i++)
                System.out.println("\b");
        }

        if(map[guessX][guessY] == '0')
        {
            if(map[guessX - 1][guessY - 1] == '0')
                display[guessX - 1][guessY - 1] = map[guessX - 1][guessY - 1];
            if(map[guessX - 1][guessY + 0] == '0')
                display[guessX - 1][guessY + 0] = map[guessX - 1][guessY + 0];
            if(map[guessX - 1][guessY + 1] == '0')
                display[guessX - 1][guessY + 1] = map[guessX - 1][guessY + 1];
            if(map[guessX + 0][guessY - 1] == '0')
                display[guessX + 0][guessY - 1] = map[guessX + 0][guessY - 1];
            if(map[guessX + 0][guessY + 1] == '0')
                display[guessX + 0][guessY + 1] = map[guessX + 0][guessY + 1];
            if(map[guessX + 1][guessY - 1] == '0')
                display[guessX + 1][guessY - 1] = map[guessX + 1][guessY - 1];
            if(map[guessX + 1][guessY + 0] == '0')
                display[guessX + 1][guessY + 0] = map[guessX + 1][guessY + 0];
            if(map[guessX + 1][guessY + 1] == '0')
                display[guessX + 1][guessY + 1] = map[guessX + 1][guessY + 1];
        }
        if(display[guessX][guessY] == 'M')
        {
            System.out.println("You hit a mine");
            System.out.println("Game over.");
            System.exit(0);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T02:00:42.877

从 java 7 文档[http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html](http://docs.oracle.com/javase/7/docs/api/java/util/Scanner.html)：

> public String nextLine()
> 将此扫描器前进到当前行并返回被跳过的输入。此方法返回当前行的其余部分，不包括末尾的任何行分隔符。位置设置为下一行的开头。
> 
> 由于此方法继续搜索输入以查找行分隔符，因此如果不存在行分隔符，它可能会缓冲所有搜索要跳过的行的输入。

您可能想使用：

> public String next()
> 从这个扫描器中查找并返回下一个完整的令牌。一个完整的标记前后是匹配分隔符模式的输入。此方法可能会在等待输入扫描时阻塞，即使先前调用 hasNext() 返回 true。

# ruby-on-rails - 如何配置 Rails 以在 500 错误时发送电子邮件？

> ID：14678952
> 
> 赞同：6
> 
> 时间：2013-02-04T00:24:16.300
> 
> 标签：ruby-on-rails

有时在生产中，某些具有特定输入的代码可能会因 500 错误而中断。当出现 500 错误时，如何将 Rails 3 配置为自动将回溯发送到电子邮件？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-04T00:27:40.973

查看[ExceptionNotification](https://github.com/smartinez87/exception_notification)。这正是它的设计目的。

如果你想要更好的可见性，我建议你设置一个错误捕捉器。它基本上是 ExceptionNotifier 的升级版。Airbrake 运行良好，但我更喜欢开源等效的 Errbit。[https://github.com/errbit/errbit](https://github.com/errbit/errbit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T01:44:07.620

你可以试试这个[ExceptionLogger](https://github.com/ryancheung/exception_logger)。它允许您在数据库表中记录异常。

# c++ - 声明新的数字类型

> ID：14678954
> 
> 赞同：1
> 
> 时间：2013-02-04T00:24:30.983
> 
> 标签：c++

回到大学时，当我使用 pascal 时，我了解到您可以声明一个数字范围的类型。它是这样的：

```
<somekeyword> TypeName 1..10; or something like that. 
```

长话短说，我想知道是否以及如何创建具有一系列可能数值的类型。

提前致谢。

编辑：抱歉，如果我不清楚，我正在寻找可以在其中声明数字类型（例如字节（0..255）或 DayOfYear（1..31））的 C++ 中的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:43:48.577

大概是这样的：

```
class range {
  int _start;
  int _end;
public:
  range(int s, int e): _start(s), _end(e) {}

  bool operator && (int n) const { return n >= _start && n <= _end; }

}; 
```

您可以用作：

```
range r(10,28);

if( r && 13 ) ... ;
else ... ; 
```

或者简单地说

```
if( range(12,34) && 13 ) ... ;
else ... ; 
```

# c - libc 随机数生成器有缺陷？

> ID：14678957
> 
> 赞同：20
> 
> 时间：2013-02-04T00:25:06.737
> 
> 标签：c, algorithm, math, random, glibc

考虑一种算法来测试在特定次数的尝试后从一组 N 个唯一数字中选择某个数字的概率（例如，在 N=2 的情况下，轮盘赌（没有 0）中需要 X 次尝试的概率是多少黑赢？）。

正确的分布是 pow(1-1/N,X-1)*(1/N)。

但是，当我使用以下代码对此进行测试时，在 X=31 处总是有一个深沟，与 N 无关，也与种子无关。

这是由于使用中的 PRNG 的实现细节而无法避免的内在缺陷，这是一个真正的错误，还是我忽略了一些明显的东西？

```
// C

#include <sys/times.h>
#include <math.h>
#include <stdio.h>

int array[101];
void main(){

    int nsamples=10000000;
    double breakVal,diffVal;
    int i,cnt;

    // seed, but doesn't change anything
    struct tms time;
    srandom(times(&time));

    // sample
    for(i=0;i<nsamples;i++){
        cnt=1;
        do{
            if((random()%36)==0) // break if 0 is chosen
                break;
            cnt++;
        }while(cnt<100);
        array[cnt]++;
    }

    // show distribution
    for(i=1;i<100;i++){
        breakVal=array[i]/(double)nsamples; // normalize
        diffVal=breakVal-pow(1-1/36.,i-1)*1/36.; // difference to expected value
        printf("%d %.12g %.12g\n",i,breakVal,diffVal);
    }
} 
```

在带有 libc6 包 2.15-0ubuntu20 和 Intel Core i5-2500 SandyBridge 的最新 Xubuntu 12.10 上进行了测试，但几年前我已经在一台较旧的 Ubuntu 机器上发现了这一点。

我还在 Windows 7 上使用 Unity3D/Mono 进行了测试（但不确定是哪个 Mono 版本），这里使用 System.Random 时，沟渠发生在 X=55，而 Unity 的内置 Unity.Random 没有可见沟渠（至少没有对于 X<100)。

分布：![在此处输入图像描述](../Images/6fc100a768c6f96342020291a120b2d9.png)

区别：![在此处输入图像描述](../Images/3a51488999d88ff17ae3fd218d797dbd.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-04T01:10:24.457

这是因为 glibc 的`random()`函数不够随机。根据[这个页面](http://www.mathstat.dal.ca/~selinger/random/)，对于返回的随机数`random()`，我们有：

`o[i] = (o[i-3] + o[i-31]) % 2^31`

或者：

`o[i] = (o[i-3] + o[i-31] + 1) % 2^31`.

现在取，并假设上面的第一个等式是使用的（每个数字都有 50% 的机会发生这种情况）。现在如果和，那么小于 1/36 的机会。这是因为 50% 的时间会小于 2^31，而当这种情况发生时，`x[i] = o[i] % 36``x[i-31]=0``x[i-3]!=0``x[i]=0``o[i-31] + o[i-3]`

`x[i] = o[i] % 36 = (o[i-3] + o[i-31]) % 36 = o[i-3] % 36 = x[i-3]`,

这是非零。这会导致您在 0 个样本之后看到 31 个样本。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-04T02:31:03.613

在这个实验中测量的是伯努利实验的成功试验之间的间隔，其中成功被定义`random() mod k == 0`为一些`k`（OP 中的 36 个）。`random()`不幸的是，执行意味着伯努利试验在统计上不独立，这一事实破坏了这一事实。

我们将编写`random()'的输出，我们注意到：`rnd[i]``i^(th)`

`rnd[i] = rnd[i-31] + rnd[i-3]    `概率为 0.75

`rnd[i] = rnd[i-31] + rnd[i-3] + 1`概率为 0.25

（有关证明大纲，请参见下文。）

让我们假设，我们目前正在研究. 那么它一定是这样的，因为否则我们会把循环算作长度。`rnd[i-31] mod k == 0``rnd[i]``rnd[i-3] mod k ≠ 0``k-3`

但是（大多数时候）。`(mod k): rnd[i] = rnd[i-31] + rnd[i-3] = rnd[i-3] ≠ 0`

因此，当前的试验在统计上并不独立于之前的试验，成功后的第 31 次^(试验)成功的可能性远低于伯努利试验的无偏系列。

使用实际上并不适用于`random()`算法的线性同余生成器的通常建议是使用高位而不是低位，因为高位“更随机”（即，与连续值的相关性较小）。但这在这种情况下也不起作用，因为上述恒等式同样适用于 function`high log k bits`和 function `mod k == low log k bits`。

事实上，我们可能期望线性同余生成器工作得更好，特别是如果我们使用输出的高阶位，因为虽然 LCG 在蒙特卡罗模拟方面不是特别好，但它不会受到线性反馈的影响`random()`.

* * *

`random`算法，对于默认情况：

让`state`是一个无符号长的向量。使用种子、一些固定值和混合算法进行初始化。为简单起见，我们可以认为状态向量是无限的，尽管只使用了最后 31 个值，因此它实际上是作为环形缓冲区实现的。`state[0]...state[30]`

生成`rnd[i]: (Note: `⊕` is addition mod 2^(32).)`

 ``state[i] = state[i-31] ⊕ state[i-3]`

`rnd[i] = (state[i] - (state[i] mod 2)) / 2`

Now, note that:

`(i + j) mod 2 = i mod 2 + j mod 2   ` if `i mod 2 == 0` or `j mod 2 == 0`

`(i + j) mod 2 = i mod 2 + j mod 2 - 2` if `i mod 2 == 1` and `j mod 2 == 1`

If `i` and `j` are uniformly distributed, the first case will occur 75% of the time, and the second case 25%.

So, by substitution in the generation formula:

`rnd[i] = (state[i-31] ⊕ state[i-3] - ((state[i-31] + state[i-3]) mod 2)) / 2`

`     = ((state[i-31] - (state[i-31] mod 2)) ⊕ (state[i-3] - (state[i-3] mod 2))) / 2` or

`     = ((state[i-31] - (state[i-31] mod 2)) ⊕ (state[i-3] - (state[i-3] mod 2)) + 2) / 2`

The two cases can be further reduced to:

`rnd[i] = rnd[i-31] ⊕ rnd[i-3]`` 

`rnd[i] = rnd[i-31] ⊕ rnd[i-3] + 1`

如上所述，第一种情况发生率为 75%，假设 rnd [i-31]和 rnd [i-3]是从均匀分布中独立得出的（它们不是，但它是一个合理的第一近似值）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T11:52:31.407

正如其他人指出的那样，`random()`不够随机。

在这种情况下，使用较高位而不是较低位没有帮助。根据手册 ( `man 3 rand`)，**旧**的实现`rand()`在低位有问题。这就是为什么`random()`建议改为。虽然，当前的实现`rand()`使用与`random()`.

我尝试了建议的*正确使用*旧的`rand()`：

```
if ((int)(rand()/(RAND_MAX+1.0)*36)==0) 
```

...并在 X=31 处获得相同的深沟

有趣的是，如果我将`rand()`的数字与另一个序列混合，我会摆脱困境：

```
unsigned x=0;
//...

        x = (179*x + 79) % 997;
        if(((rand()+x)%36)==0) 
```

我正在使用旧的[Linear Congruential Generator](http://en.wikipedia.org/wiki/Linear_congruential_generator)。我从素数表中随机选择了 79、179 和 997。这应该生成长度为 997 的重复序列。

也就是说，这个技巧可能引入了一些非随机性，一些足迹......由此产生的混合序列肯定会通过其他统计测试。`x`在连续迭代中永远不会采用相同的值。实际上，重复每个值需要 997 次迭代。

> ''[..] 随机数不应使用随机选择的方法生成。应该使用一些理论。”（DEKnuth，“计算机编程的艺术”，第 2 卷）

对于模拟，如果您想确定，请使用[Mersenne Twister](http://en.wikipedia.org/wiki/Mersenne_twister)

# sockets - 无法连接到本地计算机上的套接字

> ID：14678958
> 
> 赞同：2
> 
> 时间：2013-02-04T00:25:27.140
> 
> 标签：sockets, f#

我在[这里对示例 C# 代码](http://msdn.microsoft.com/en-us/library/vstudio/system.net.sockets.socket%28v=vs.110%29.aspx)进行了简单的翻译：

```
let socket_CreateBindListen (sv_ : string) (pt_ : int) : Socket option =
    let (he : IPHostEntry) = Dns.GetHostEntry(sv_)
    let rsock, ipe =
        he.AddressList
        |> Seq.map (fun s ->
            let (ipe2 : IPEndPoint) = new IPEndPoint (s, pt_)
            let (rsock2 : Socket) = new Socket (ipe2.AddressFamily, SocketType.Stream, ProtocolType.Tcp)
            rsock2.Connect ipe2 ///// <---- No connection could be made because the target machine actively refused it
            rsock2, ipe2)
        |> Seq.find (fun (s, t) -> s.Connected)
    try
        rsock.Bind ipe
        rsock.Listen 10
        printfn "%s now listening on port %d" sv_ pt_
        Some (rsock)
    with
        | _ ->
            printfn "Failed to connect to %s on port %d" sv_ pt_
            None

socket_CreateBindListen "127.0.0.1" 50000 
```

我确保首先在我的机器上为入站和出站连接打开 TCP 端口 50000。（我什至尝试完全禁用防火墙。）似乎没有任何效果。我不断收到错误消息：

```
No connection could be made because the target machine actively refused it. 
```

我正在使用 Windows 8。我非常感谢一些关于我可能会尝试的其他指示。

在此先感谢您的时间。

* * *

**编辑**

我希望我不会因为在这里写博客而违反 StackOverflow 的任何发布政策。

我已将代码更新为以下内容：

```
let socket_CreateBindListen (sv_ : string) (pt_ : int) : Socket option =
    let (he : IPHostEntry) = Dns.GetHostEntry(sv_)
    let rsock, ipe =
        he.AddressList
        |> Seq.map (fun s ->
            let (ipe2 : IPEndPoint) = new IPEndPoint (s, pt_)
            let (rsock2 : Socket) = new Socket (ipe2.AddressFamily, SocketType.Stream, ProtocolType.Tcp)
            try
                rsock2.Connect ipe2
                rsock2, ipe2
            with
                | _ ->
                    null, null)
        |> Seq.find (fun (s, t) -> (s <> null) && (s.Connected))
    try
        rsock.Bind ipe
        rsock.Listen sbl
        printfn "%s now listening on port %d" sv_ pt_
        Some (rsock)
    with
        | _ ->
            printfn "Failed to connect to %s on port %d" sv_ pt_
            None 
```

现在我收到以下错误：

```
KeyNotFoundException was unhandled
An unhandled exception of type 'System.Collections.Generic.KeyNotFoundException' occurred in FSharp.Core.dll 
```

我在 Google 和 Bing 上进行了广泛的研究，但没有任何运气。

* * *

**编辑 2**

根据 的要求`Jack P.`，以下是 的输出`netstat -a`，以及执行二进制文件时发生的情况：

```
PS C:\Users\shredderroy> netstat -a

Active Connections

  Proto  Local Address          Foreign Address        State
  TCP    0.0.0.0:80             SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:135            SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:445            SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:2179           SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:49152          SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:49153          SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:49154          SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:49155          SPEEDMACHINE:0         LISTENING
  TCP    0.0.0.0:49156          SPEEDMACHINE:0         LISTENING
  TCP    192.168.0.139:139      SPEEDMACHINE:0         LISTENING
  TCP    192.168.0.139:49159    bn1wns2011708:https    ESTABLISHED
  TCP    192.168.0.139:49167    vc-in-f108:imaps       ESTABLISHED
  TCP    192.168.0.139:49171    vc-in-f108:imaps       ESTABLISHED
  TCP    192.168.0.139:49239    a23-67-250-112:http    CLOSE_WAIT
  TCP    [::]:80                SPEEDMACHINE:0         LISTENING
  TCP    [::]:135               SPEEDMACHINE:0         LISTENING
  TCP    [::]:445               SPEEDMACHINE:0         LISTENING
  TCP    [::]:2179              SPEEDMACHINE:0         LISTENING
  TCP    [::]:49152             SPEEDMACHINE:0         LISTENING
  TCP    [::]:49153             SPEEDMACHINE:0         LISTENING
  TCP    [::]:49154             SPEEDMACHINE:0         LISTENING
  TCP    [::]:49155             SPEEDMACHINE:0         LISTENING
  TCP    [::]:49156             SPEEDMACHINE:0         LISTENING
  UDP    0.0.0.0:500            *:*
  UDP    0.0.0.0:4500           *:*
  UDP    0.0.0.0:5355           *:*
  UDP    127.0.0.1:53194        *:*
  UDP    127.0.0.1:60316        *:*
  UDP    127.0.0.1:61644        *:*
  UDP    192.168.0.139:137      *:*
  UDP    192.168.0.139:138      *:*
  UDP    [::]:500               *:*
  UDP    [::]:4500              *:*
  UDP    [::]:5355              *:*
  UDP    [fe80::b193:4f6:d053:6324%20]:546  *:*
PS C:\Users\shredderroy> cd "C:\Users\shredderroy\Documents\Visual Studio 2012\Projects\FSharp\SocketTests_Server\SocketTests_Server\bin\Debug
"
PS C:\Users\shredderroy\Documents\Visual Studio 2012\Projects\FSharp\SocketTests_Server\SocketTests_Server\bin\Debug> .\SocketTests_Server.exe
Unhandled Exception: System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it [::1]:50000
   at System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Connect(EndPoint remoteEP)
   at SocketTests_Server.TestModule_1.heo@22.Invoke(IPAddress s) in C:\Users\shredderroy\Documents\Visual Studio 2012\Projects\FSharp\SocketTests_Server\SocketTests_Server\TestModule_1.fs:line 25 at Microsoft.FSharp.Collections.SeqModule.TryFind[T](FSharpFunc`2 predicate, IEnumerable`1 source)
   at SocketTests_Server.TestModule_1.socket_CreateBindListen_1(String sv_, Int32 pt_) in C:\Users\shredderroy\Documents\Visual Studio
2012\Projects\FSharp\SocketTests_Server\SocketTests_Server\TestModule_1.fs:line 20
   at SocketTests_Server.Program.Main(String[] args) in C:\Users\shredderroy\Documents\Visual Studio 2012\Projects\FSharp\SocketTests_Server\SocketTests_Server\Program.fs:line 9
PS C:\Users\shredderroy\Documents\Visual Studio 2012\Projects\FSharp\SocketTests_Server\SocketTests_Server\bin\Debug> 
```

我会继续努力。到目前为止，我已将我的程序 , 添加`SocketTests_Server.exe`到 Windows 防火墙中允许的程序列表中，打开了入站和出站连接的相关端口，完全禁用了防火墙 - 一切都无济于事。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T00:48:53.557

我认为正在发生的事情是您连接了两次，其中一个地址连接正常。然后，您的代码会继续查看剩余的地址并尝试再次连接。

您的代码缺少`break`C# 代码中的等效项。

一些可能的解决方案：

1.  使用 while 循环代替`Seq.map`
2.  在内部使用引用变量`map`
3.  将所有代码压缩到`Seq.find`并删除对 map 的调用（可能是最优雅的）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-04T01:27:35.297

我从你链接的页面翻译了代码——它编译，虽然我没有尝试运行它。

```
open System
open System.Text
open System.Net
open System.Net.Sockets

let connectSocket (server : string, port : int) : Socket option =
    // Get host related information.
    let hostEntry = Dns.GetHostEntry server

    // Loop through the AddressList to obtain the supported AddressFamily. This is to avoid 
    // an exception that occurs when the host IP Address is not compatible with the address family 
    // (typical in the IPv6 case). 
    hostEntry.AddressList
    |> Seq.tryPick (fun address ->
        let ipe2 = IPEndPoint (address, port)
        let rsock2 = new Socket (ipe2.AddressFamily, SocketType.Stream, ProtocolType.Tcp)
        rsock2.Connect ipe2
        if rsock2.Connected then
            Some rsock2
        else None)

// This method requests the home page content for the specified server. 
let socketSendReceive (server : string, port : int) : string =
    let request =
        sprintf "GET / HTTP/1.1\r\nHost: %s\r\nConnection: Close\r\n\r\n" server
    let bytesSent =
        Encoding.ASCII.GetBytes request
    let bytesReceived = Array.zeroCreate 256

    // Create a socket connection with the specified server and port.
    match connectSocket (server, port) with
    | None ->
        "Connection failed"
    | Some s ->
        // Send request to the server.
        s.Send (bytesSent, Array.length bytesSent, SocketFlags.None)
        |> ignore

        // Receive the server home page content. 
        let mutable bytes = 0
        let mutable page =
            sprintf "Default HTML page on %s:\r\n" server

        // The following will block until the page is transmitted. 
        while bytes > 0 do
            bytes <- s.Receive (bytesReceived, Array.length bytesReceived, SocketFlags.None)
            page <- page + Encoding.ASCII.GetString (bytesReceived, 0, bytes)

        page

//
let main args =
    let port = 80

    let host =
        if Array.isEmpty args then
            // If no server name is passed as argument to this program,  
            // use the current host name as the default.
            Dns.GetHostName ()
        else
            args.[0]

    socketSendReceive (host, port)
    |> Console.WriteLine 
```

**编辑**：我做了一点挖掘，“主动拒绝”是该错误消息的关键，根据：[无法建立连接，因为目标机器主动拒绝它](https://stackoverflow.com/a/9695442/1197411)。简而言之，请仔细检查您尝试连接的服务器是否设置正确；当连接被*主动*拒绝时，没有防火墙问题——服务器实际上拒绝了您的连接。

如果您绝对确定服务器设置正确，那么您可以尝试最后一件事。根据[Socket Connection Is Actively Refused (MSDN Forums)](http://social.msdn.microsoft.com/Forums/en-SG/netfxnetcom/thread/ab22f90e-c648-4dbf-a8b7-0b535a67bb11)，您可能需要使用[IPAddress.NetworkToHostOrder 方法](http://msdn.microsoft.com/en-us/library/9014we01.aspx)为 IPEndPoint 正确设置端口值。在这种情况下，只需将其添加为我的`connectSocket`函数（上图）的第一行：

```
let port = IPAddress.NetworkToHostOrder port 
```

**编辑 2**：查看`netstat`您发布的信息 - 端口 50000 上没有服务器`LISTENING`。如果您确定服务器软件设置正确，请确保它使用您想要的端口（而不仅仅是选择随机端口）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T01:08:28.807

首先，我要感谢大家，特别是 @Jack P. 和 @John Palmer，他们阅读了我的代码并提供了非常好的和有启发性的建议。非常感谢您的指导。

* * *

`TcpListener`我已经通过使用and`TcpClient`类来规避上述问题。所以我想我会写[这个服务器函数](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcplistener%28v=vs.110%29.aspx)和[这个客户端函数](http://msdn.microsoft.com/en-us/library/system.net.sockets.tcpclient%28v=vs.110%29.aspx)的简单F#翻译，它们一起实现服务器和客户端。希望这个示例代码可以为其他初学者节省一些时间。

* * *

**服务器**

```
let connectAndListen () : unit =
    let (laddr : IPAddress) = IPAddress.Parse ("127.0.0.1")
    let lpt = 32000
    let (svr : TcpListener) = new TcpListener (laddr, lpt)
    try
        svr.Start ()
        let (bta : byte[]) = Array.create 256 (byte (0))
        while true do
            printfn "Waiting for a connection..."
            let (cl : TcpClient) = svr.AcceptTcpClient ()
            printfn "Connected"
            let (ns : NetworkStream) = cl.GetStream ()
            let mutable (i : int) = ns.Read (bta, 0, (Array.length bta))
            while i <> 0 do
                let (dat : string) = System.Text.Encoding.ASCII.GetString (bta, 0, i)
                printfn "Received:  %s" dat
                let (msg : byte[]) = System.Text.Encoding.ASCII.GetBytes (dat.ToUpper ())
                ns.Write (msg, 0, (Array.length msg))
                printfn "Sent:  %s" (dat.ToUpper ())
                i <- ns.Read (bta, 0, (Array.length bta))
            cl.Close ()
    with
    | excp ->
        printfn "%s" excp.Message
    svr.Stop () 
```

* * *

**客户**

```
let connect (sv_ : string) (pt_ : int) (msg_ : string) : unit =
    try
        let cl = new TcpClient (sv_, pt_)
        let (dat : byte[]) = System.Text.Encoding.ASCII.GetBytes msg_
        let (st : NetworkStream) = cl.GetStream ()
        st.Write (dat, 0, (Array.length dat))
        printfn "Sent:  %s" msg_
        let (rdat : byte[]) = Array.create 256 (byte (0))
        let (i : int) = st.Read (rdat, 0, (Array.length rdat))
        let (rsp : string) = System.Text.Encoding.ASCII.GetString (rdat, 0, i)
        printfn "Received:  %s" rsp
        st.Close ()
        st.Dispose ()
    with
    | :? ArgumentNullException as excp ->
        printfn "ArgumentNullException encountered:  %s" excp.Message
    | :? SocketException as excp ->
        printfn "SocketException encountered:  %s" excp.Message
    printfn "Press ENTER to continue"
    Console.ReadLine () |> ignore 
```

* * *

将代码放在单独的项目中，编译并运行它们。他们在我的机器上工作。

# python - “队列”对象没有属性“大小”

> ID：14678959
> 
> 赞同：4
> 
> 时间：2013-02-04T00:25:29.417
> 
> 标签：python, class, python-3.x, queue, attributeerror

我在 StackOverflow 上看到过其他类似的例子，但我不明白任何答案（我还是一个新程序员），我看到的其他例子也不像我的，否则我不会发布这个问题。

我在 Windows 7 上运行 Python 3.2。

我以前从来没有遇到过这种情况，而且我已经多次以这种方式上课，所以我真的不知道这次有什么不同。唯一的区别是我没有制作所有的 Class 文件。我得到了一个模板来填写和一个测试文件来试一试。它适用于测试文件，但不适用于我的文件。我一直在以与测试文件完全相同的方式调用类中的方法（例如 Lineup.size()）

这是我的课：

```
类队列：

    # 构造函数，它创建一个新的空队列：
    def __init__(self):
        self.__items = []

    # 将新项目添加到队列的后面，并且不返回任何内容：
    def 队列（自我，项目）：
        self.__items.insert(0,item)
        返回

    # 移除并返回队列中最前面的项目。  
    # 如果队列为空，则不返回任何内容。
    def 出队（自我）：
        如果 len(self.__items) == 0:
            返回无
        别的：
            返回 self.__items.pop()

    # 返回队列中最前面的项目，并且不更改队列。  
    def 窥视（自我）：
        如果 len(self.__items) == 0:
            返回无
        别的：
            返回 self.__items[(len(self.__items)-1)]

    # 如果队列为空，则返回 True，否则返回 False：
    def is_empty(self):
        返回 len(self.__items) == 0

    # 返回队列中的项目数：
    默认尺寸（自我）：
        返回 len(self.__items)

    # 从队列中删除所有项目，并将大小设置为 0：
    def 清除（自我）：
        del self.__items[0:len(self.__items)]
        返回

    # 返回队列的字符串表示形式：
    def __str__(self):
        return "".join(str(i) for i in self.__items)

```

这是我的程序：

```
from queue import Queue

Lineup = Queue()

while True:
  decision = str(input("Add, Serve, or Exit: ")).lower()
  if decision == "add":
    if Lineup.size() == 3:
      print("There cannot be more than three people in line.")
      continue
    else:
      person = str(input("Enter the name of the person to add: "))
      Lineup.queue(person)
      continue
  elif decision == "serve":
    if Lineup.is_empty() == True:
      print("The lineup is already empty.")
      continue
    else:
      print("%s has been served."%Lineup.peek())
      Lineup.dequeue()
      continue
  elif (decision == "exit") or (decision == "quit"):
    break
  else:
    print("%s is not a valid command.")
    continue 
```

这是我输入“添加”作为决策变量时的错误消息：

*第 8 行，在 builtins.AttributeError: 'Queue' object has no attribute 'size'*

那么，这里发生了什么？这个有什么不同？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-04T00:37:10.300

Python 3 已经有一个`queue`模块（你可能想看看）。当你找到你时`import queue`，Python`queue.py`在找到你的`queue.py`.

将您的`queue.py`文件重命名为`my_queue.py`，将您的导入语句更改为`from my_queue import Queue`，您的代码将按您的意愿运行。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-04T00:30:51.210

尝试重命名其他名称的大小或对列表 __items 实施计数器，例如

```
def get_size(self):
    cnt = 0
    for i in self.__items:
        cnt++
    return cnt 
```

# java - 运行 Jar 文件不起作用。找不到主

> ID：14678961
> 
> 赞同：0
> 
> 时间：2013-02-04T00:25:43.387
> 
> 标签：java, batch-file, jar

我使用 netbeans 为学校创建我的 java 项目。我不喜欢 netbeans 如何使用内部控制台而不是通常的黑色 CMD/Windows/终端控制台，因此我决定使用批处理文件通过命令行编译我的项目。我的批处理文件拒绝运行 jar。它说找不到主类。我不知道为什么：S

有人可以帮助我或告诉我如何解决吗？

我相信帮助我所需的所有信息如下：

```
@echo off

set ProjectName=WildWidgetsWarehouse.jar
set ProjectPath=C:/Users/Brandon/Documents/NetBeansProjects/

set path=C:/Program Files/Java/jdk1.7.0_11/bin

cd /d %~dp0
ECHO.
dir %ProjectPath%/*.java
ECHO.
ECHO.

for %%* in (.) do set FolderName=%%~n*
for %%* in (..) do set ParentDirectory=%%~dpnx*

javac -d ../Classes *.java -cp ../Classes;std.jar

cd %ParentDirectory%\Classes
jar cvf %UserProfile%\Desktop\%ProjectName% %FolderName% .*
java -cp . %UserProfile%\Desktop\%ProjectName%

PAUSE 
```

运行时，它会打印：

```
Invalid switch - "Users".

Note: Some input files use unchecked or unsafe operations.
Note: Recompile with -Xlint:unchecked for details.
.* : no such file or directory

Prints all the file it added.. It adds all my classes.. See picture below

Error: Could not find or load main class C:\Users\Brandon\Desktop\WildWidgetsWar
ehouse.jar
Press any key to continue . . . 
```

我的 Jar 文件如下所示：

![在此处输入图像描述](../Images/d3380363aad0a3fb2089b78ba26f380d.png) ![在此处输入图像描述](../Images/1f977579ace3a985b05730aaa85bf808.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:41:56.403

要运行 jar 文件，您需要`-jar`选项

```
java -jar xxx.jar 
```

请`man java`阅读`-jar`选项部分。

您也可能希望将主类信息添加到 jar 文件的清单中。

`man jar`，然后查看`e`选项。

你的`MANIFEST.MF`罐子应该看起来像（只是例子）

```
Manifest-Version: 1.0
Created-By: 1.6.0 (or maven, ant, blahblah)
Main-Class: com.yourpackage.MainClass 
```

# mobiscroll - 车轮外的车轮编号可见

> ID：14678963
> 
> 赞同：1
> 
> 时间：2013-02-04T00:26:00.773
> 
> 标签：mobiscroll

使用 v:2.4，FF18，使用 datetime 演示，如果我单击并向上/向下拖动数字轮，数字会暂时离开轮区，然后消失，然后轮实际滚动。这在 v:2.0 中没有发生。有没有办法避免这种影响，或者它是一个错误？

抱歉，很难截屏；它只是发生在一瞬间，但看起来很难看。

* * *

有截图 ![在此处输入图像描述](../Images/a9a0c4b9d9983bac7127483b1c12c28a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T07:19:55.313

看起来它在 2.4.1 中已修复该问题在 2.0（和 2.1）中没有发生，因为该`top`属性是动画的而不是硬件加速的`translate3d`，它提供了更流畅的动画，但在 FF18 上表现得似乎很时髦。

令人惊讶的是，`border-radius`从`.dww`类（动画容器）中删除似乎解决了这个问题。

# matlab - 如何获得颜色图中的最高值？

> ID：14678970
> 
> 赞同：1
> 
> 时间：2013-02-04T00:26:59.670
> 
> 标签：matlab, image-processing

我想扩展我在 Dicom 图像上获得的颜色图，为此我需要它们的灰度强度的最高值。我怎样才能在代码中做到这一点？

```
image_data, image_colormap= dicomread('dicomfile.dcm');

max(image_colormap) 
```

返回`[]`

：-/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:37:39.550

这对我有用：

```
I = dicomread('dicomimg.dcm');
max(I(:)) 
```

对于真彩色/灰度图像，地图为空

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T00:50:29.197

从[文档](http://www.mathworks.com/help/images/ref/dicomread.html)中，

> [X,map] = dicomread(...) 返回图像 X 和颜色映射图。**如果 X 是灰度或真彩色图像，则 map 为空。**

对于灰度图像，您可以使用`max(image_data(:))`

# css - Safari 错误：kCFErrorDomainCFNetwork -10

> ID：14678971
> 
> 赞同：1
> 
> 时间：2013-02-04T00:27:05.173
> 
> 标签：css, safari, base64, data-uri

我正在尝试在外部 CSS 文件中加载数据 uri。这是代码：

```
.icon-blank-page-large {
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAA3NCSVQICAjb4U/gAAAAXVBMVEX///+vr6+tra2mpqalpaWdnZ3///+UlJT7+/v39/f19fXz8/Pr6+vp6enn5+fj4+Ozs7OqqqqmpqalpaWFhYWRkZGNjY2Li4uJiYl+fn56enp4eHh2dnZycnJwcHBeRFztAAAAH3RSTlMAM1WImbvd3e7u7u7u7u7u7u7u7u7/////////////xBl9GgAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAAUdEVYdENyZWF0aW9uIFRpbWUANi8xLzEzOKlF0AAAAMNJREFUSInt1tsSgiAUhWGsxNJOHsoQ1n7/xyxLaYSNY01XDf81nwoXsoUYShW4skTwNYDp3LQm0it2fQrUp610y4nAC4XSW91H1EKvGQBzDIDiCmwY0Pnf8wJy13ICHbu+B7LgxBxg3xEG+/6wbp4Ig/MgdLIIXMiWLQL5W2ARsBXmQyB1BH8EKNDvQNx03HTc9HdA85diGASuXdve+d0r1POggpqAx+hQMaPD2KEE0gl4Difam07GDNAIp8D4M6Ts8++7/VXclnc6pwAAAABJRU5ErkJggg); 
```

}

它适用于 Chrome 和 Firefox，但 Safari 无法加载图像并记录以下错误：

```
Failed to load resource: The operation couldn’t be completed. (kCFErrorDomainCFNetwork error -10.) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-11T04:35:40.670

此错误是由不正确的编码引起的。base64 字符串的一部分丢失了，尽管它在 Chrome 和 FF 中仍然有效。

# sml - Basis 有标准的“const”函数吗？

> ID：14678974
> 
> 赞同：2
> 
> 时间：2013-02-04T00:27:22.063
> 
> 标签：sml, smlnj, ml

刚刚学习 ML，我一直在寻找类似于 Haskell 的 const 的内置函数。它将被定义为：

```
fun const a b = a 
```

我自己当然很容易实现 :) 但我认为可能有一个我忽略的等效标准函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T07:43:46.050

标准库中没有这样的函数，所以你必须像以前一样自己定义它。

# jsp - 无法从 JSP 页面访问自定义 HttpSession 属性

> ID：14678982
> 
> 赞同：0
> 
> 时间：2013-02-04T00:28:01.457
> 
> 标签：jsp, tomcat, attributes, httpsession

我在 HttpSession 中定义了一个自定义属性，并在库类中设置了该属性，如下所示：

```
public class changeBeanAttribute {
public changeBeanAttribute() 
{
}
public void changeAttribute (HttpServletRequest request) {
       request.getSession().setAttribute("CustomAttribute","Sample Attribute Value");
}
} 
```

但是，当我尝试按如下方式从 JSP 页面访问修改后的属性时，我得到一个 null 值返回

```
<% String str = request.getSession().getAttribute("CustomAttribute"); %> 
```

有人能帮我理解为什么我不能从 JSP 页面访问 HttpSession 属性吗？
JSP 页面和 Java 类都在 Tomcat 容器中运行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T12:12:03.913

你试过设置

```
<%@ page session="true"%> 
```

在您的 jsp 页面顶部？我认为这是默认设置，但也许您已将其设置为 false。它允许您的会话在您的 jsp 页面上可用。

# cocos2d-iphone - GL Func 减法 Cocos2d

> ID：14678990
> 
> 赞同：0
> 
> 时间：2013-02-04T00:28:50.093
> 
> 标签：cocos2d-iphone, mask, blending, glblendfunc

有谁知道如何将 Cocos2d 2.x 中特定精灵的混合模式更改为 GL_FUNC_SUBTRACT？

我尝试了一些事情，但基本上我正在尝试使用白色（或黑色）圆圈创建图层蒙版并隐藏 alpha。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T15:24:17.557

您可以尝试为此目的实现您的包装器 Sprite。该类（假设是 SubSprite）应该继承 CCNode 类并有一个成员，即您想使用 GL_FUNC_SUBTRACT 绘制的常规 CCSprite。

用这样的东西覆盖 draw 方法：

```
-(void) draw{
  int oldEquation;
  glGetIntegerv( GL_BLEND_EQUATION_ALPHA, &oldEquation);
  glBlendEquation( GL_FUNC_SUBTRACT );
  [targetSprite draw];
  glBlendEquation( oldEquation );
} 
```

我还没有尝试过，但它应该可以工作，你不必重写整个精灵绘图功能。

# android - 如何使用 LIFO 之类的文件？

> ID：14678993
> 
> 赞同：0
> 
> 时间：2013-02-04T00:29:34.167
> 
> 标签：android, file, stack

我的应用程序每 30 分钟发送一个数据包。当数据包无法发送时，我想将它（一个简单的字符串）存储在一个名为`error.log`. `error.log`根据 LIFO 策略，当用户按下一个名为“restoreErrors”的按钮时，我想从中提取一个数据包并尝试重新发送它。

例如文件 error.log 是：

```
String1
String2
String3 
```

当用户按下“restoreErrors”按钮时，我需要按顺序加载保存的数据包：

```
while (!file.empty) {
  String str = loadUnsendedStringFromFile();
} 
```

我的问题是像 LIFO 一样使用文件，因为我可以正确读取字符串，但我需要删除当前提取的字符串（如堆栈模型中的 POP）。

谢谢。

编辑：好的，我将使用一个简单的列表来实现这一点，无需为每个数据包错误存储在文件中......谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T00:33:20.093

使用[ArrayList](http://developer.android.com/reference/java/util/ArrayList.html)，您可以调用 add 方法将未发送的消息添加到列表中。然后你可以按照你想要的顺序发送它们（向上或向下，用一个简单的 for 循环）。然后，调用 remove 方法删除发送的字符串，它会留下未发送的字符串

# php - 使用 cPanel API 在 PHP 中创建 mySQL 数据库和用户

> ID：14678994
> 
> 赞同：0
> 
> 时间：2013-02-04T00:29:54.887
> 
> 标签：php, api, cpanel, whm

我正在尝试创建一个 mysql 用户并将其分配给创建的数据库。

我尝试将 $db_host 设置为 IP 地址、FQD、localhost（因为我在同一台服务器上运行）等。所有这些都没有成功。

关于我做错了什么有什么建议吗？（xmlapi.php 很好）

```
include("xmlapi.php");
$db_host = "usingfullyqualifieddomain";
$cpuser = "myuser";
$cppass = "mypass";

$xmlapi = new xmlapi($db_host);
$xmlapi->set_port(2083);
$xmlapi->password_auth($cpuser,$cppass);
$xmlapi->set_debug(1);
//create database
print $xmlapi->api1_query($cpuser, "Mysql", "adddb", 'myDatabaseName');
//create user
print $xmlapi->api1_query($cpuser, "Mysql", "adduser", array('user' => 'myDBUser','pass'=>'myDBPwd')); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:37:40.930

The error is probably related to the way you're making your first service call, to create the database. Here is how I do it, on CPanel 11:

```
$auth_user = 'XXXXXX'; 
$auth_pass = 'XXXXX'; 
$server = 'XXXXXXXX.com';
$json_client = new \xmlapi($server);

$json_client->set_output('json'); 
$json_client->set_port(2083); 
$json_client->password_auth($auth_user, $auth_pass);
$json_client->set_debug(1);

# Create Database
$result = $json_client->api1_query( $auth_user, 'Mysql', 'adddb', array($shop->alias));
var_dump($result); 
```

Note that the fourth parameter should be an array with the parameters, and not a string as you are doing it.

Also notice that the print on the api call result is not very useful for debugging. Try var_dump'ing it, as it will show you some more interesting information to work on.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-09-04T10:19:45.557

目前，cpanel 支持 cpanel json api .. 在这里您可以使用此代码 .. 这对我很有效

```
<?php 

$cpanelusername = "cpanelusername";
$cpanelpassword = "cpanelpassword";  
$domain = 'mydomain.com';

$query = "https://$domain:2083/json-api/cpanel?cpanel_jsonapi_module=Mysql&cpanel_jsonapi_func=adddb&cpanel_jsonapi_apiversion=1&arg-0=DBNAME";

$curl = curl_init();                                // Create Curl Object
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER,0);       // Allow self-signed certs
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST,0);       // Allow certs that do not match the hostname
curl_setopt($curl, CURLOPT_HEADER,0);               // Do not include header in output
curl_setopt($curl, CURLOPT_RETURNTRANSFER,1);       // Return contents of transfer on curl_exec
$header[0] = "Authorization: Basic " . base64_encode($cpanelusername.":".$cpanelpassword) . "\n\r";
curl_setopt($curl, CURLOPT_HTTPHEADER, $header);    // set the username and password
curl_setopt($curl, CURLOPT_URL, $query);            // execute the query
$result = curl_exec($curl);
if ($result == false) {
    error_log("curl_exec threw error \"" . curl_error($curl) . "\" for $query");   
                                                    // log error if curl exec fails
}
curl_close($curl);

print $result;

?> 
```

# java - 断点调试永远不会进入子类

> ID：14678998
> 
> 赞同：0
> 
> 时间：2013-02-04T00:31:25.450
> 
> 标签：java, android, listview, android-arrayadapter

我的列表视图没有填充我从 MySQL 数据库中提取的数据。我已经测试了网络服务，一切都很完美。我正在调试它，我注意到当我在我的异步任务中设置一个断点时，它从来没有去那里。我从执行命令中走出来，它从来没有进去过。一切运行良好，没有错误。我很困惑和新的，请温柔。

```
public class Favorites extends Activity{
  UserFunctions userFunctions  = new UserFunctions();
  ArrayList<String> zipcodes = new ArrayList<String>(0);
  ArrayAdapter<String> arrayAdapter1;

@Override
protected void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.favoritespage);
  arrayAdapter1 = new ArrayAdapter<String>(Favorites.this,android.R.layout.activity_list_item,zipcodes);
  new DownloadDataTask().execute();
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
  // Inflate the menu; this adds items to the action bar if it is present.
  getMenuInflater().inflate(R.menu.activity_main_screen, menu);
  return true;
}

private class DownloadDataTask extends AsyncTask<JSONArray, JSONArray, ArrayList<String> > {
  @Override
  protected ArrayList<String> doInBackground(JSONArray... params) {
    JSONArray json = userFunctions.ziplistrequest("37.5", "140.45", "20");
    for(int i=0; i < json.length() ; i++) {
      JSONObject jarray = null;
      try {
        jarray = json.getJSONObject(i);
        String zip = jarray.getString("ZIPCODE");
        zipcodes.add(zip);
        arrayAdapter1.add(zip);
        Log.d(zip,"Output");
      } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
      }
    }
    return zipcodes;
  }
  protected void onPostExecute(){
    ListView listView = (ListView) findViewById(R.id.list);
    listView.setAdapter(arrayAdapter1);
  }
} 
```

如果需要任何其他答案，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:29:47.453

好东西。我将添加我的评论作为问答结束和纯 SO 点贪婪的答案:)

> 如果将调试点直接粘贴在异步任务 doInBackground 上会发生什么？清理并构建您的项目（如果使用 Eclipse IDE）以防出现一些编译器/类生成问题