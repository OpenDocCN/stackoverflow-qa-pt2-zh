# StackOverflow 问答 16043000-16043999

# visual-studio-2010 - VS2012 解决方案 打开脚本或自动化

> ID：16043000
> 
> 赞同：1
> 
> 时间：2013-04-16T17:07:23.640
> 
> 标签：visual-studio-2010, visual-studio-2012, scripting, automation

打开项目时，我需要将标准组件 DLL 复制到每个 VS2012 项目中定义的标准文件夹中。我们不允许在 Subversion 中存储 DLL，因此每次开发人员打开项目/解决方案时，我都需要重新加载此文件夹。我正在寻找一种自动化解决方案，该解决方案将从集中位置提取 DLL 并将它们复制到开发人员的解决方案中。我查看了 Visual Studio Extensions，但复制几个文件似乎需要做很多工作。VS2012（希望是 VS2010）中是否还有其他挂钩，我可以在其中编写简单的 PowerShell 脚本来复制这些文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-26T14:46:32.843

事实证明，AntHillPro 有自己的功能，用于存储常见的 DLL 并在构建之前将它们加载到解决方案中的文件夹中。它不像 MSBuild 预构建任务那样优雅，但它适合模型，然后是我们的 Java 构建，并稍作调整。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:24:41.647

Why you just do no use Nuget? Adding nuget reference and enable nuget restore on build will do exactly what you need. You can create nuget repository as shared folder.

# frameworks - 播放框架 2：尝试在生产模式下启动应用程序时出错

> ID：16043006
> 
> 赞同：4
> 
> 时间：2013-04-16T17:07:39.123
> 
> 标签：frameworks, playframework-2.0

操作系统：Windows 7 64 位

java版本：1.7.0_17

javac版本：1.7.0_17

我是 Play Framework 的新手，基本上想了解一切。

有一个名为 java/helloworld 的示例应用程序。没有改变任何东西并继续使用“开始”命令。

```
[helloworld] $ start

(Starting server. Type Ctrl+D to exit logs, the server will remain in background
)

Error occurred during initialization of VM
java.lang.ExceptionInInitializerError
        at java.lang.Runtime.loadLibrary0(Unknown Source)
        at java.lang.System.loadLibrary(Unknown Source)
        at java.lang.System.initializeSystemClass(Unknown Source)
Caused by: java.lang.StringIndexOutOfBoundsException: String index out of range:
 0
        at java.lang.String.charAt(Unknown Source)
        at java.io.Win32FileSystem.<init>(Unknown Source)
        at java.io.WinNTFileSystem.<init>(Unknown Source)
        at java.io.FileSystem.getFileSystem(Native Method)
        at java.io.File.<clinit>(Unknown Source)
        at java.lang.Runtime.loadLibrary0(Unknown Source)
        at java.lang.System.loadLibrary(Unknown Source)
        at java.lang.System.initializeSystemClass(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:30:18.897

我认为这与 Play 无关。您似乎遇到了[这个问题](https://stackoverflow.com/questions/13913196/file-separator-java-7-option-causes-exceptionininitializererror)，这看起来是您的 Windows 风格的 JVM 错误。

要在生产模式下运行示例应用程序，您可能必须执行以下操作：

1.  运行`play stage`命令（在 Play 控制台之外，就在命令行上）。阶段任务在[此处描述](http://www.playframework.com/documentation/2.0/Production)
2.  在启动应用程序之前，[将此 JVM 参数](https://stackoverflow.com/a/14002403/926710)添加到阶段任务生成的脚本中。`target\start`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-12T12:43:58.290

作为解决方法添加

```
 -Dfile.separator=\/ 
```

play.bat 和 build.bat 的参数。

# c# - 大文件作为 Visual Studio 2012 中的嵌入式资源

> ID：16043010
> 
> 赞同：3
> 
> 时间：2013-04-16T17:07:55.300
> 
> 标签：c#, visual-studio-2012

我正在尝试在 Visual Studio 2012 中添加一个大文件 (3.6gb) 作为嵌入式资源。这可能吗？我也尝试过使用 ~1gb 的文件，但它们也失败了。已经有一些其他文件，大小从 5-60mb 不等，它们工作正常。

编译时收到此错误消息： **错误 2 将元数据写入文件时出现意外错误“没有足够的存储空间来完成此操作。**

（运行win8 x64，大量的内存和磁盘空间。严重怀疑这就是问题所在..）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:16:11.507

Don't embbed such a large file, it will cause problems to the compiler! Add it as a linked resource.

# python - 如何根据python中的标头提取某些csv数据

> ID：16043011
> 
> 赞同：5
> 
> 时间：2013-04-16T17:08:10.177
> 
> 标签：python, csv

如何根据 python 中的标头从 csv 文件中提取特定数据？例如，假设 csv 文件包含以下信息：

```
Height,Weight,Age
6.0,78,25 
```

我怎么能只检索python中的年龄？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T17:19:07.077

我支持该`csv`建议，但我认为在这里使用`csv.DictReader`会更简单：

（Python 2）：

```
>>> import csv
>>> with open("hwa.csv", "rb") as fp:
...     reader = csv.DictReader(fp)
...     data = next(reader)
...     
>>> data
{'Age': '25', 'Weight': '78', 'Height': '6.0'}
>>> data["Age"]
'25'
>>> float(data["Age"])
25.0 
```

在这里，我`next`只是用来获取第一行，但如果您愿意，您可以遍历这些行和/或提取一整列信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:15:00.357

要遵循的过程是：读取第一行，在您要查找的数据的该行上找到索引（位置），然后使用该索引将数据从其余行中提取出来。

Python 提供了一个非常有用的`csv.reader`类来完成所有的阅读，所以它非常简单。

```
import csv

filename = 'yourfilenamehere'
column = 'Age'

data = [] # This will contain our data

# Create a csv reader object to iterate through the file
reader = csv.reader( open( filename, 'rU'), delimiter=',', dialect='excel')

hrow = reader.next() # Get the top row
idx = hrow.index(column) # Find the column of the data you're looking for

for row in reader: # Iterate the remaining rows
    data.append( row[idx] )

print data 
```

请注意，这些值将以字符串形式出现。`row[idx]`您可以通过包装例如转换为 int`data.append( int( row[idx] ) )`

# java - 如何将动态值添加到列表列表中

> ID：16043015
> 
> 赞同：0
> 
> 时间：2013-04-16T17:08:20.270
> 
> 标签：java, list

我有一个`List<List<Tableof>>`：

```
List<List<Tableof>> test; 
```

我创建列表，如下`t1`所示添加到`test`. 我怎样才能像`t1`动态地创建一个列表，因为这些列表的数量不是固定的。

```
 private List<List<Tableof>> test = new ArrayList<List<Tableof>>();
    List<Tableof> t1 = new ArrayList<Tableof>();
    Query query4 = em.createNamedQuery("Tableof.findAll");
    t1 =  query4.getResultList();
    test.add(t1); 
```

关于如何做的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:34:39.660

Query 类的 getResultList 方法必须返回 List<Tableof>。

这是应该工作的代码。

```
private List<List<Tableof>> test = new ArrayList<List<Tableof>>();

Query query4 = em.createNamedQuery("Tableof.findAll");
List<Tableof> t1 =  query4.getResultList();
test.add(t1); 
```

此方法将在 Query 类中。

```
public List<Tableof> getResultList() {
    List<Tableof> list = new ArrayList<Tableof>()
    ResultSet rs = stmt.executeQuery(query);
    while (!rs.islast()) {
        rs.next();
        Tableof tableof = (Tableof) rs.getObject();
        list.add(tableof)
    }
    return list;
} 
```

# ios - UITableViewCell 编辑一个单元格在 8 行后更改另一个单元格控件

> ID：16043016
> 
> 赞同：1
> 
> 时间：2013-04-16T17:08:22.063
> 
> 标签：ios, objective-c, uitableview

现在我是 IOS 编程的初学者，我创建了一个视图并在其中放置了一个 tableview，然后我使用我想用于 tablecell 的模板创建了一个 xib 并为该调用创建了一个类。表格单元格有一个标签（在加载单元格时设置）、一个开关和一个文本字段。

该表加载良好，标签显示了它们应该显示的正确文本，从数据库加载了 12 行。SQLite。

问题：当我编辑第 1 行中的文本字段时，第 9 行中的文本字段被编辑，反之亦然。当我在第 2 行编辑时，第 10 行被编辑！直到第 4,12 行，不仅是文本字段，还有切换开关。

一些代码：AlertViewController.h

```
@property (weak, nonatomic) IBOutlet UITableView *table; 
```

警报视图控制器.m

```
@synthesize table;

static NSString *alertCellID=@"AlertViewCell";

----some code here ----
-(void)ViewDidLoad
{
---some code here----
    self.table.delegate=self;
    self.table.dataSource=self;

    if(managedObjectContext==nil)
    {
        id appDelegate=(id)[[UIApplication sharedApplication] delegate];
        managedObjectContext=[appDelegate managedObjectContext];
    }
    [self loadCategories];

    [table registerNib:[UINib nibWithNibName:@"AlertViewCell" bundle:[NSBundle mainBundle]] forCellReuseIdentifier:alertCellID];
}

-(NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [arrCategories count];
}
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    Category *cat=[arrCategories objectAtIndex:indexPath.row];
    AlertViewCell *cell = [tableView dequeueReusableCellWithIdentifier:alertCellID];
    UILabel *lblGroupName=(UILabel *)[cell viewWithTag:101];
    lblGroupName.text=cat.nameEn;
    UITextField *txtHours=(UITextField *)[cell viewWithTag:103];
    txtHours.delegate=self;
    return cell;
}
-(NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
} 
```

**编辑：** 我不知道它是否与适合 8 条记录的滚动大小有关？以及如何克服呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T01:17:22.487

好的，我解决了如下：

首先问题是因为我使用dequeuereusablecellwithidentifier，它似乎每x行返回相同的引用，其中x是屏幕上出现的行数而不滚动，所以这使得单元格1=单元格9，单元格2=单元格10 以此类推。

所以为了解决这个问题，我必须使标识符唯一，并且为了解决标识符用于加载注册笔尖的问题，我必须使用这个唯一标识符名称注册笔尖。这是更改：

```
-(UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSString *identifier=[NSString stringWithFormat:@"%@%d",alertCellID,indexPath.row];
    [table registerNib:[UINib nibWithNibName:@"AlertViewCell" bundle:[NSBundle mainBundle]] forCellReuseIdentifier:identifier];
    Category *cat=[arrCategories objectAtIndex:indexPath.row];

    AlertViewCell *cell = (AlertViewCell *)[tableView dequeueReusableCellWithIdentifier:identifier forIndexPath:indexPath];
    if(!cell)
    {
        NSArray *topLevelObjects=[[NSBundle mainBundle] loadNibNamed:@"AlertViewCell" owner:self options:nil];
        cell=[topLevelObjects objectAtIndex:0];
    }
    UILabel *lblGroupName=(UILabel *)[cell viewWithTag:101];
    lblGroupName.text=cat.nameEn;
    UITextField *txtHours=(UITextField *)[cell viewWithTag:103];
    txtHours.delegate=self;
    return cell;
} 
```

# c# - ODBC 连接问题：执行任何操作时出现函数序列错误

> ID：16043018
> 
> 赞同：2
> 
> 时间：2013-04-16T17:08:25.900
> 
> 标签：c#, sql, odbc, data-migration, 4d-database

我的任务是一次性从 4D 数据库迁移到我们的 MSSQL 结构。我在 ODBC 管理员中设置了一个数据源，并且能够毫无问题地连接到它。

我在 Visio 中对架构进行了“逆向工程”，因此我可以很好地了解表之间的关系，并计划如何重新构建 4D 数据以适应我们的架构。我创建了一个简单的控制台应用程序，因为这将是一次运行，并且我能够建立与数据源的连接，但是一旦我执行任何操作，连接就会断开或被禁用。

```
 System.Data.Odbc.OdbcConnection conn = 
               new System.Data.Odbc.OdbcConnection("Dsn=4D v12 datasource");
        try
        {
            conn.Open();
            Console.WriteLine("Status of Connection:" + conn.State.ToString());
            //Here it says the connection to the DB is open and ready for action
            Console.ReadLine(); 
            //pause to visually confirm  the connection is open
            OdbcCommand com = new OdbcCommand("SELECT * FROM ATable", conn);
            com.CommandType = CommandType.Text;
            Console.Write(com.ExecuteNonQuery());
            //Right here it blows up and closes the connection                
         } 
```

我也尝试对数据集和数据适配器做一些事情，但无济于事。

```
System.Data.Odbc.OdbcConnection conn = new System.Data.Odbc.OdbcConnection("Dsn=4D v12 datasource");
        try
        {
            conn.Open();
            Console.WriteLine("Status of Connection:" + conn.State.ToString());                
            Console.ReadLine();
            OdbcCommand com = new OdbcCommand("SELECT * FROM ATable", conn);
            com.CommandType = CommandType.Text;
            //Also tried using data sets and data adapters
            DataSet dsTest = new DataSet();
            OdbcDataAdapter dataAdapter = new OdbcDataAdapter(com);
            //but right at this line the connection suddenly disconnects
            dataAdapter.Fill(dsTest);

        }
        catch (Exception e)
        {
            Console.WriteLine("Failure:" + e.Message.ToString());
            // the exception message reads simply connection has been disabled. 
            Console.WriteLine("Status of Connection: " + conn.State.ToString());
            Console.ReadLine();
        }
        finally 
        {
            Console.Write("Closing connection.");
            conn.Close();
            Console.Write(".");
            conn.Dispose();
            Console.WriteLine(".");
            Console.WriteLine("Connection Closed and Disposed");
            Console.ReadLine();
        } 
```

我试图寻找遇到同样困难的人，但我发现的文档很少，并且在这方面没有太大帮助。有大量关于在 4D 产品上执行查询的信息，但不是来自数字鸿沟。请有经验的朋友指教。感谢您的时间和您可能提供的任何帮助，热心的读者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:41:12.500

显然，问题的根本原因在于驱动程序。将我从网站上获得的驱动程序替换为所有者发送的驱动程序后，连接停止被禁用，一切都按预期工作。

# ruby-on-rails - 如何在rails中使用表单中的date_select和time_select？

> ID：16043027
> 
> 赞同：0
> 
> 时间：2013-04-16T17:09:24.897
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1

我的数据库中的表中分别有一个`Date`和`Time`列。当我单击表中的编辑时，`Date`和`Time`应该显示值`params`。用户可以更改`Date`和`Time`并更新`form`.

我尝试了以下方法：

```
<div class="field">
  <%= f.label :Sent_Date, 'Sent Date:' %>
  <%= date_select(:Appointment_Date, object: f.object) %>
</div>

<div class="field">
  <%= f.label :Appointment_Time, 'Appointment Time:' %>
  <%= f.time_select(:history, :Appointment_Time, include_seconds: true) %>
</div> 
```

它没有正确显示值，也不会更改为下一条记录。它显示以选择值。我需要在这里转换日期吗？因为，在数据库中，它只是类似的值`2013/05/13`，而在字段中是类似的`20 December 2013`

`Time`字段不工作。请建议我如何解决这个问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T22:39:22.777

不要将常量用作模型的字段。任何以大写字母开头的变量都将被视为常量，并且常量意味着不会改变。当尝试更改常量的值时， Ruby 会给您一个`warning: already initialized constant`提示，因此这可能是您无法更改时间和日期的原因。

# android - android 活动娱乐 - 意图是否包含原始附加内容？

> ID：16043032
> 
> 赞同：2
> 
> 时间：2013-04-16T17:09:36.150
> 
> 标签：android, android-intent, android-activity, android-lifecycle

我有一项活动，预计在启动时会传递一些额外内容。

`getIntent()`当这个活动被销毁并重新创建时，从内部调用返回的意图是否`onCreate()`包含与活动最初启动时相同的额外内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:20:32.783

Depends on if it was intentionally destroyed. If it was destroyed by a finish() call, no. If it was destroyed because the system was freeing up memory, yes. It will also have a flag stating that this is a recreate (useful if your app only works from the first activity, such as an app that needs you to be logged in).

# java - 如何声明可以包含另一个元素或仅包含文本的元素

> ID：16043034
> 
> 赞同：1
> 
> 时间：2013-04-16T17:09:37.583
> 
> 标签：java, xml, jaxb

新手问题。我在问之前搜索过！我想对一些 Java 类进行建模，以便 JAXB 编组输出如下（本质上是 HTML 表数据 - XML）：

```
 <td>
      <span class="myClass">assets</span>
   </td>
   <td>some text</td>
   <td>some more text</td> 
```

基本上，很容易让所有的东西都使用文本值。但是，当我尝试包含上述跨度的规定（声明为单独的 XMLElement）时，我无法单独获得“文本”。例如，它要么将文本包装在我声明保存文本的 String 属性的名称中，要么如果我尝试使用 @XmlValue 将其关闭，那么它会抱怨你不能在同一个声明中混合 XMLElement 和 XMLValue（即使我根据上面的上下文只使用一个或另一个 - 每个 td 包含一个跨度或文本，但不能同时包含两者）。

输出的种类是：

```
<td><span class="myClass">assets</span></td><td><value>some text></value></td> 
```

最终问题归结为“我如何删除那些“价值”元素？” 我想：

```
<td><span class="myClass">assets</span></td><td>some text</td> 
```

我可以发布数据，但实际上只有在绝对必要的情况下。我希望上述解释足以让某人友好地提供解决方案。

谢谢大家的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:11:55.887

好的，所以这里有答案。看起来很简单，但希望它可以为其他人节省一个小时的黑客和搜索 jaxb 文档。执行以下操作 - 这里的真正问题是让 TD 具有某种多态性 - 在我的情况下，我只想要一个跨度或纯文本值。两者都没有用例。

```
@XmlSeeAlso(Span.class)
@XmlRootElement(name = "td")
public class TableData {

private List<Object> items;

public TableData() {}

public TableData(List<Object> items) {
    this.items = items;
}

@XmlMixed
@XmlAnyElement
public List<Object> getItems() {
    return items;
}

public void setItems(List<Object> items) {
    this.items = items;
}

} 
```

我有一个 Span 类（也单独声明为 XMLElement。诀窍是放宽对值可以是什么类型的限制（不要尝试声明两种属性类型，一个字符串用于文本，一个 Span.class 用于跨度情况）。还请注意@XmlSeeAlso、@XmlMixed 和@XmlAnyElement。在某些情况下@XmlElementRef 和@XmlElementRefs 更适合。在我这里的情况下，使用@XmlAnyElement 可以毫不费力地工作。

对于更完整的讨论，我推荐 Blaise Doughan 在这篇文章中给出的答案：[JAXB - Java/ XMLValue & XMLElement conflict](https://stackoverflow.com/questions/15495156/jaxb-java-xmlvalue-xmlelement-conflict)

# javascript - Javascript 适用于 jsfiddle 但不适用于 ASP .net

> ID：16043035
> 
> 赞同：1
> 
> 时间：2013-04-16T17:09:51.510
> 
> 标签：javascript, asp.net, .net

我想通过单击列表项中的一列/字符串来过滤项目列表。当我点击销售时，只会显示销售类别列表中的项目。当我再次单击销售时，将显示列表中的所有项目。

它就像我在[jsfiddle上想要的那样工作](http://jsfiddle.net/5pMsR/1/)

但为什么它不能在 ASP .net 上的 Visual Studio 中工作？它抛出异常

```
...
var a = p.getElementsByTagName("a")[0];
... 
```

这是我的 HTML 代码：

```
<div data-role="page" id="page1">
    <div data-role="content">
        <ul data-role="listview" data-inset="false" data-filter="true" id="testList">
            <li data-icon="false">
                <p class="ui-li-heading"> 
                  <strong> 1</strong>
                </p>

                <p class="ui-li-aside"> 
                    <span>
                        <a href="javascript:void(0)" class="areaItem" id="areaItem">Sales</a>
                        &nbsp;
                        &nbsp;
                    </span>
 <span class="ui-icon ui-icon-gear" style="display: inline-block;"></span>
 <span class="ui-icon ui-icon-check" style="display: inline-block;"></span>    
                </p>
            </li>
  </div>
</div> 
```

这是我的 Javascript：

```
var filtered = 0;

$(".areaItem").click(function () {
    var SearchTerm = $(this).text();

    var ul = document.getElementById("testList");
    var liArray = ul.getElementsByTagName("li");

    for(var i=0; i<liArray.length; i++) {
        var p = liArray[i].getElementsByTagName("p")[0];
        var a = p.getElementsByTagName("a")[0];

        if(filtered == 1) {
            $(liArray[i]).show();
        } else {
            if(a.text.localeCompare(SearchTerm) != 0) {
                $(liArray[i]).hide();
            }
        }
    }

    if (filtered == 0) {
        filtered = 1;
    } else {
        filtered = 0;
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T01:06:56.617

我将从重构您的 javascript 开始：

```
$(document).ready(function () { //Make sure doc is loaded
   var list = $("#testList");
   var listItems = $(list).find("li"); //could also do $("#listtest li);

   $(".areaItem").click(function () {
       var parentLi = $(this).closest("li");   //Get li that encloses clicked item 
       $(listItems).not(parentLi).toggle();    //Toggle display of other li
   });
}); 
```

它更简单，更符合 jQuery 的使用方式。

见：http: [//jsfiddle.net/5pMsR/3/](http://jsfiddle.net/5pMsR/3/)

这本身不足以解决您的问题。仔细检查呈现给页面的内容。特别是 check `id`，因为 ASP.net 因破坏 ID 而臭名昭著。谷歌 ASP.net 名称修改和 asp.net ID 修改以获取更多信息。如果您的 ID 被损坏，请在脚本中使用以下内容

```
var list = $('#<%= YourListElement.ClientID%>'); 
```

或使用类。

**更新**

重新阅读您的问题后，我意识到我的解决方案可能无法满足您的需求。如果您希望在单击其中任何一个时显示两个“销售”项目，则可以使用以下命令：

```
var list = $("#testList");
var listItems = $(list).find("li"); //could also do $("#listtest li);

$(".areaItem").click(function () {
    var parentLi = $(this).closest("li");  //Get Parent li of clicked element
    var filter = $(parentLi).find(".areaItem").text(); //Set Filter based on text of clicked item
    $(listItems).filter(function(){ //Use jQuery filter to find based on text
        //in the filter context 'this' is a li being filtered not the item clicked
        //$(this).find(".areaItem").text() is used to compare against all list items text
        return $(this).find(".areaItem").text() != filter;
    }).toggle();

}); 
```

见：http: [//jsfiddle.net/5pMsR/8/](http://jsfiddle.net/5pMsR/8/)

**更新 2**

我已经更新了上面的代码和小提琴，以根据评论使解决方案更加健壮。最终渲染中似乎`a`不存在该标签。代码更改现在将基于 CSS 类而不是标签进行搜索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T23:35:59.620

过去我遇到过类似的问题：问题在于 ASP.NET 页面生命周期和在 DOM 中创建元素之前解析的 javascript。由于您试图将单击处理程序绑定到`.areaItem`该类，因此在解析该函数​​时，该类的成员元素必须全部在 DOM 中可用。

从记忆中我想我最终将点击委托给了文档：

```
$(document).on(click, ".areaItem", function() { <function content> }); 
```

我相信这会使解析发生在`load`事件之后，此时所有元素都已创建。

我不确定的原因是因为我删除了所有这些代码并以不同的方式进行了操作：将脚本块直接放在我的内容页面中，位于 ASP 控件和 HTML 之后。如果您希望将 JS 放在标头或单独的文件中，但在内容确实有效后将其嵌入，则不理想：

```
<div data-role="page" id="page1">
<div data-role="content">
    <ul data-role="listview" data-inset="false" data-filter="true" id="testList">
        <li data-icon="false">
            <p class="ui-li-heading"> 
              <strong> 1</strong>
            </p>

            <p class="ui-li-aside"> 
                <span>
                    <a href="javascript:void(0)" class="areaItem" id="areaItem">Sales</a>
                    &nbsp;
                    &nbsp;
                </span>
                <span class="ui-icon ui-icon-gear" style="display: inline-block;"></span>
                <span class="ui-icon ui-icon-check" style="display: inline-block;"></span>    
            </p>
        </li>
  </div>
</div>

<script>
  var filtered = 0;

  $(".areaItem").click(function () {
    var SearchTerm = $(this).text();

    var ul = document.getElementById("testList");
    var liArray = ul.getElementsByTagName("li");

    for(var i=0; i<liArray.length; i++) {
        var p = liArray[i].getElementsByTagName("p")[0];
        var a = p.getElementsByTagName("a")[0];

        if(filtered == 1) {
            $(liArray[i]).show();
        } else {
            if(a.text.localeCompare(SearchTerm) != 0) {
                $(liArray[i]).hide();
            }
        }
    }

    if (filtered == 0) {
        filtered = 1;
    } else {
        filtered = 0;
    }
});
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T06:54:24.360

我带来了对我来说有点奇迹的解决方案，因为我是 javascript 新手。在 IE 中一切正常，但在 Chrome 中，点击后所有 li 都消失了。

```
var filtered = 0;

        $(".areaItem").click(function () {
            var SearchTerm = $(this).text();

            $('#testList > li').each(function () {
                var a = $(this).find("a").attr("id","areaItem");

                //alert(a[0].innerHTML);

                if (filtered == 1) {
                    $(this).show();
                } else {
                    //alert(a.text());
                    if (a[0].innerHTML.localeCompare(SearchTerm) != 0) {
                        $(this).hide();
                    }
                }

            });

            if (filtered == 0) {
                filtered = 1;
            } else {
                filtered = 0;
            }
        }); 
```

# csv - 从数据驱动订阅中导出 SSRS 中的空 csv

> ID：16043038
> 
> 赞同：3
> 
> 时间：2013-04-16T17:10:00.070
> 
> 标签：csv, reporting-services, export

当返回的数据为空时，如何从 SSRS (2012) 数据驱动订阅创建的导出 csv 文件中删除逗号？该报告每天创建，然后导出为 csv 文件。当报告未返回任何结果时，导出的 csv 文件仅包含一行逗号。当它返回结果时，它会输出一个正确的 csv 文件。文件需要每天生成，不管结果如何，但没有数据返回时需要为空而不带逗号？

例如，当返回数据时：

姓名 1、地址 1、城市 1、州 1、邮编 1

姓名 2、地址 2、城市 2、州 2、邮编 2

例如，当未返回数据时，我需要它为空白，但它当前创建：

,,,,

# php - 哪种数组语法更有效？

> ID：16043039
> 
> 赞同：0
> 
> 时间：2013-04-16T17:10:03.090
> 
> 标签：php, arrays, syntax, performance

**我没有找到类似的问题**

# 1

```
$form['level1']['level2'][] = array(
    'data' => 'some data',
    'type' => 'some type',
);
//etc 
```

# 2

```
 $form = array(
   'level1' => array(
      'level2' => array(
         array(
            'data' => 'some data',
            'type' => 'some type',
         ), 
         //etc
       ),
    ),
 ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:13:36.790

这绝对是微优化...

```
Test 1: 9.0906839370728
Test 2: 8.5538339614868 
```

但第二种效率更高。例如`[]`较慢，因为它首先必须检查最后一个索引等......而且第一个必须首先检查数组是否已经存在（在每个维度上），而在第二种情况下，PHP 很清楚有一个新的大批。

Ps：但我真的不知道，因为第一个比第二个更难解析。我没有测量的解析器时间......（而且我不认为现在经常重新创建数组？）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-16T17:13:07.523

2 比 1 更具可读性。

另外，如果您要在没有警告的情况下进行游戏，则 1 将是：

```
$arr = array();
$arr["level1"] = array();
$arr["level1"]["level2"] = array();
//... etc 
```

# api - Magento SOAP 更改产品价格

> ID：16043040
> 
> 赞同：1
> 
> 时间：2013-04-16T17:10:04.713
> 
> 标签：api, soap, magento-1.7

我需要一种在 magento 中导入订单的方法。

在 mangeto 网站上找到这个并让它工作。我现在遇到的问题是我需要更改产品价格。这是可能的吗？（无法找到真正的谷歌）

```
 //$proxy = new SoapClient('');
 $proxy = new SoapClient('');
 $sessionId = $proxy->login('');
 var_dump($sessionId);
 // Create a quote, get quote identifier
 $shoppingCartId = $proxy->call( $sessionId, 'cart.create', array( '0' ) );
 var_dump($shoppingCartId);

 // Set customer, for example guest
 $customerAsGuest = array(
"firstname" => "testFirstname",
"lastname" => "testLastName",
"email" => "",
"website_id" => "0",
"store_id" => "0",
"mode" => "guest",
"gender" => "male"
 );
 $resultCustomerSet = $proxy->call($sessionId, 'cart_customer.set', array( $shoppingCartId,      $customerAsGuest) );

 // Set customer addresses, for example guest's addresses
 $arrAddresses = array(
array(
    "mode" => "shipping",
    "firstname" => "testFirstname",
    "lastname" => "testLastname",
    "company" => "testCompany",
    "street" => "testStreet",
    "city" => "testCity",
    "region" => "testRegion",
    "postcode" => "testPostcode",
    "country_id" => "NL",
    "telephone" => "0123456789",
    "fax" => "0123456789",
    "is_default_shipping" => 0,
    "is_default_billing" => 0
),
array(
    "mode" => "billing",
    "firstname" => "testFirstname",
    "lastname" => "testLastname",
    "company" => "testCompany",
    "street" => "testStreet",
    "city" => "testCity",
    "region" => "testRegion",
    "postcode" => "testPostcode",
    "country_id" => "NL",
    "telephone" => "0123456789",
    "fax" => "0123456789",
    "is_default_shipping" => 0,
    "is_default_billing" => 0
     )
 );
 $resultCustomerAddresses = $proxy->call($sessionId, "cart_customer.addresses",      array($shoppingCartId, $arrAddresses));

 // add products into shopping cart
 /*$arrProducts = array(
array(
    "product_id" => "1",
    "qty" => 2
),
array(
    "sku" => "testSKU",
    "quantity" => 4
)
 );*/

 $arrProducts = array(
array(
    "product_id" => "16021",
    "qty" => 2
),
array(
    "sku" => "P0014685",
    "quantity" => 4
)
 );
 $resultCartProductAdd = $proxy->call($sessionId, "cart_product.add", array($shoppingCartId,      $arrProducts));
 /*
 // update product in shopping cart
 $arrProducts = array(
array(
    "product_id" => "1",
    "qty" => 5
),
 );
 $resultCartProductUpdate = $proxy->call($sessionId, "cart_product.update",      array($shoppingCartId, $arrProducts));

 // remove products from shopping cart, for example by SKU
 $arrProducts = array(
array(
    "sku" => "testSKU"
     ),
 );
 $resultCartProductRemove = $proxy->call($sessionId, "cart_product.remove",           array($shoppingCartId, $arrProducts));
 */
 // get list of products
 echo"<br/>Artikelen<br/>";
 $shoppingCartProducts = $proxy->call($sessionId, "cart_product.list",      array($shoppingCartId));
 print_r( $shoppingCartProducts );
 //echo"<br/>Verzendmethode<br/>";
 // get list of shipping methods
 $resultShippingMethods = $proxy->call($sessionId, "cart_shipping.list", array($shoppingCartId));
 //print_r( $resultShippingMethods );

 // set shipping method
 $randShippingMethodIndex = rand(1, count($resultShippingMethods) );
 $shippingMethod = $resultShippingMethods[$randShippingMethodIndex]["PostNL gratis"];
 //$resultShippingMethod = $proxy->call($sessionId, "cart_shipping.method", array($shoppingCartId, $shippingMethod));
 $resultShippingMethod = $proxy->call($sessionId, "cart_shipping.method", array($shoppingCartId, 'freeshipping_freeshipping'));

 // get list of payment methods
 $resultPaymentMethods = $proxy->call($sessionId, "cart_payment.list",      array($shoppingCartId));
 //print_r($resultPaymentMethods);

 // set payment method
 $paymentMethod = array(
"method" => "checkmo"
 );
 $resultPaymentMethod = $proxy->call($sessionId, "cart_payment.method",      array($shoppingCartId, $paymentMethod));
 /*
 // add coupon
 $couponCode = "aCouponCode";
 $resultCartCouponRemove = $proxy->call($sessionId, "cart_coupon.add",      array($shoppingCartId, $couponCode));

 // remove coupon
      $resultCartCouponRemove = $proxy->call($sessionId, "cart_coupon.remove",      array($shoppingCartId));
 */
 // get total prices
 $shoppingCartTotals = $proxy->call($sessionId, "cart.totals", array($shoppingCartId));
 print_r( $shoppingCartTotals );

 // get full information about shopping cart
 $shoppingCartInfo = $proxy->call($sessionId, "cart.info", array($shoppingCartId));
 print_r( $shoppingCartInfo );
 /*
 // get list of licenses
 $shoppingCartLicenses = $proxy->call($sessionId, "cart.licenseAgreement",           array($shoppingCartId));
 print_r( $shoppingCartLicences );

 // check if license is existed
 $licenseForOrderCreation = null;
 if (count($shoppingCartLicenses)) {
$licenseForOrderCreation = array();
foreach ($shoppingCartLicenses as $license) {
    $licenseForOrderCreation[] = $license['agreement_id'];
}
 }
 */
 // create order
 $resultOrderCreation = $proxy->call($sessionId,"cart.order",array($shoppingCartId,      null, $licenseForOrderCreation)); 
```

# haskell - 比较元组列表以查找计费列表中最昂贵的项目

> ID：16043043
> 
> 赞同：0
> 
> 时间：2013-04-16T17:10:23.503
> 
> 标签：haskell, tuples

这是我坚持的过去试卷中的一个问题。请帮忙。

给出了超市账单的类型。账单的每个条目都包含产品的名称、购买了该产品的数量以及单个产品的价格。

```
type Product = String
type Count = Float -- type chosen for simple arithmetic
type Price = Float
type Bill = [(Count, Product, Price)] 
```

定义一个函数*mostExpensive*，给定账单将返回账单中最昂贵条目的产品名称和总成本（考虑购买了多少产品）。假设只有一种这样的产品。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T17:18:19.680

In `Data.List`, there's a function called `maximumBy` that is useful here. It takes a function that does the comparison. To write that function, we'll use a function in `Data.Ord` called `comparing`. All we need now is a way to say *what* we want to compare. So if we define:

```
calcPrice (k, _, p) = k*p 
```

Then we can get the result using:

```
maximumBy (comparing calcPrice) items 
```

Armed with that, I think you can solve the problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T20:37:15.213

感谢您的所有帮助，但我将此作为最终答案并与编译器进行了检查，它可以工作:)

```
mostExpensive :: Bill -> (Price, Product)
mostExpensive [] = (0, "No Products in Bill")
mostExpensive a = head (reverse(sort (map getTotal2 a)))
    where getTotal2 :: (Count, Product, Price) -> (Price, Product)
          getTotal2 (a,b,c) = ((a * c), b) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:34:47.533

这是一种更新手的方法，也可以完成这项工作。可能在优雅等级上得分为负，但非常简单。

**如果您正在编写自己的内容，请不要在下面偷看。我敢打赌它比这短:-)**

您应该能够调用 ghci 中的每个组件函数来将其拆开。

```
type Product = String
type Count = Float -- type chosen for simple arithmetic
type Price = Float
type Bill = [(Count, Product, Price)]
type LinePrice = (Product, Price)

myBill :: Bill
myBill = [ (4.0, "Bananas", 0.30), (1.0, "Apple", 0.50), (2.0, "Eggs", 0.25) ]

priceList :: Bill -> [LinePrice]
priceList = map (\(ct,prd,prc) -> (prd, ct*prc))

maxItem :: [LinePrice] -> LinePrice
maxItem lst = maxItem_m ("none",0.0) lst

maxItem_m :: LinePrice -> [LinePrice] -> LinePrice
maxItem_m max [] = max
maxItem_m (prd_m,prc_m) ((prd,prc):rest)
    | prc > prc_m = maxItem_m (prd,prc) rest
    | otherwise   = maxItem_m (prd_m,prc_m) rest

main = do
    let mostExpensive = maxItem $ priceList myBill
    print mostExpensive 
```

# javascript - 将多列 html 表转换为单列以实现移动友好的布局

> ID：16043045
> 
> 赞同：4
> 
> 时间：2013-04-16T17:10:27.763
> 
> 标签：javascript, jquery, html, dom, jquery-selectors

我有一个有 3 列的表。我想转换为单行。

![在此处输入图像描述](https://i.stack.imgur.com/6Vw96.png)

```
both append.('</tr><tr>') and after.('</tr><tr>') do not work. 
```

想要这样的移动友好页面 -

![在此处输入图像描述](https://i.stack.imgur.com/DiROX.png)

感谢您的帮助！

[http://jsfiddle.net/tZt3Q/](http://jsfiddle.net/tZt3Q/)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-16T17:13:51.593

实现此目的的一种方法是使用 JQuery 包装方法。见`[Wrap](http://api.jquery.com/wrap/)` 和 `[UnWrap](http://api.jquery.com/unwrap/)`

`***[Demo](http://jsfiddle.net/z3r9b/)***`

`***[Demo W/O class](http://jsfiddle.net/2Z9h9/)***`

```
 $(document).ready(function () {
    var tbl = $("table");
      $('td','table').unwrap().each(
     function () {     
          tbl.append($(this).wrap('<tr>').parent()); 
    });
  }); 
```

更简单的一个：

```
 $(document).ready(function () {
    $('table').find('td').unwrap().wrap($('<tr/>'));
}); 
```

**[小提琴](http://jsfiddle.net/bs7Rg/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:34:13.260

试试这个：

**单行**：

```
var $tds = $("table td").clone();
$("table").empty().append($("<tr>").append($tds)); 
```

[http://jsfiddle.net/hescano/tZt3Q/10/](http://jsfiddle.net/hescano/tZt3Q/10/)

**单列**：

```
var $tds = $("table td").clone();
$("table").empty();
$tds.each(function(){
    $("table").append($("<tr>").append($(this)));
}); 
```

[http://jsfiddle.net/hescano/tZt3Q/11/](http://jsfiddle.net/hescano/tZt3Q/11/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:17:35.573

正如一个建议..你可以使用`divs`单元格而不是表格，它会在没有任何 JS 的情况下使用 float css：

像这样 ：

[http://jsfiddle.net/tZt3Q/9/](http://jsfiddle.net/tZt3Q/9/)

HTML：

```
<div class="tableDivColumns">
<div>One</div><div>Tow</div><div>Three</div><div>Four</div><div>Five</div><div>six</div>
    <div>Seven</div><div>Eight</div><div>Nine</div>
</div>

<div class="tableDivRows">
<div>One</div><div>Tow</div><div>Three</div><div>Four</div><div>Five</div><div>six</div>
    <div>Seven</div><div>Eight</div><div>Nine</div>
</div> 
```

CSS：

```
.tableDivColumns {border:1px solid green; padding 5px; width:160px;height:160px;}
.tableDivColumns div {border:1px solid blue; width:50px; height:50px;float:left;}

.tableDivRows {border:1px solid green; padding 5px; width:60px;height:470px;}
.tableDivRows div {border:1px solid blue; width:50px; height:50px;float:left;} 
```

# java - 动态设置缓冲图像的大小

> ID：16043050
> 
> 赞同：0
> 
> 时间：2013-04-16T17:10:41.483
> 
> 标签：java, swing, dynamic, jframe, bufferedimage

我正在使用它来设置缓冲图像的大小。

```
Dimension imgDim = new Dimension(700, 380);

BufferedImage gridImage = new BufferedImage(imgDim.width, imgDim.height,
    BufferedImage.TYPE_INT_RGB); 
```

而不是这个，我想使用类似的东西来设置图像的大小：

```
Dimension imgDim = d;

BufferedImage gridImage = new BufferedImage(d.width/8, d.height/8,
    BufferedImage.TYPE_INT_RGB); 
```

但我得到`negativeArraySizeException`

`d`是我`JFrame`使用`getMaximumSize()`方法得到的尺寸

当我打印出`d.width/8`我无法理解的 268435455 之类的值时。有没有其他方法可以做到这一点，请帮忙

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:20:51.803

> d is the dimensions of my JFrame which I'm getting using `getMaximumSize`() method

You would get d using the `getSize`() method **after** you call the `pack`() method or `setSize`() method.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:20:23.430

You should use `getSize()` instead of `getMaximumSize()`.

If you don't `setPreferredSize` for your `JFrame`, `getMaximumSize()` will return a very big number. See [Component.getMaximumSize()](http://docs.oracle.com/javase/7/docs/api/javax/swing/plaf/ComponentUI.html#getMaximumSize%28javax.swing.JComponent%29)

`getSize()` returns your `JFrame's` current size

See [Component JavaDocs](http://docs.oracle.com/javase/7/docs/api/java/awt/Component.html#getSize%28%29)

# flashdevelop - 找不到 FlashDevelop 类路径定义

> ID：16043051
> 
> 赞同：0
> 
> 时间：2013-04-16T17:10:48.530
> 
> 标签：flashdevelop, gsap

我下载了 greensock-as3.zip 并设置了 'com' 文件夹类路径，但我收到此错误消息

```
Error: Access of undefined property TweenLite.
Error: Definition com.greensock:TweenLite could not be found. 
```

但有趣的是，当我写作时，我可以到达 TweenLite`import com.greensock.TweenLite;`

你对这个问题有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:04:13.073

如果您的图书馆位于：`path/to/tweenlite/src/com/...`

那么类路径应该是：`path/to/tweenlite/src/`

FlashDevelop 对错误的类路径来说太好了。

# javascript - iDangerous Swiper 未检测到滑动

> ID：16043055
> 
> 赞同：3
> 
> 时间：2013-04-16T17:10:58.717
> 
> 标签：javascript, jquery, html

所以我正在为一个使用 iDangerous Swiper 插件的移动网站创建一个图像选取框，并且在尝试使用它时遇到了问题。在基于站点的设置（[在此处找到](http://www.idangero.us/sliders/swiper/api.php)）之后，我根据他们演示的确切规范构建了我的演示页面。但由于某种原因，该功能没有运行，我无法滑动到下一个 div。作为一个移动网站，我使用的是 Jquery 和 Jquery Mobile。有任何想法吗？

```
<body>

<div class="swiper-container">
  <div class="swiper-wrapper">

      <!--First Slide-->
      <div class="swiper-slide">
       <img src="img/1.png" width="200" height="118">
      </div>

      <!--Second Slide-->
      <div class="swiper-slide">
       <img src="img/2.png" width="200" height="118">
      </div>

      <!--Third Slide-->
      <div class="swiper-slide">
        <img src="img/3.png" width="200" height="118">
      </div>

      <!--Fourth Slide-->
      <div class="swiper-slide">
       <img src="img/4.png" width="200" height="118"> 
      </div>

      <!--Fifth Slide-->
      <div class="swiper-slide">
        <img src="img/5.png" width="200" height="118">
      </div>      

  </div>
</div>

<script>

$(function(){
    var mySwiper = $('.swiper-container').swiper(options);
})

</script>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T22:09:21.323

iDangero.us 在这里！:) 您的 HTML 是正确的。但是您的示例中的“选项”是什么？这应该是一个带有参数的对象，或者如果您想使用默认选项，那么只需从您的示例中删除“选项”字样： var mySwiper=$('.swiper-container').swiper()

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T19:10:45.917

要使用 Swiper 按钮，您需要在 mySwiper 对象上使用 .swipeNext() 和 .swipePrev() 方法，例如：

```
<!-- Add somewhere in HTML your buttons:-->
<span class="button-next">Next button</span>
<span class="button-prev">Previous button</span>
<script>
$(function(){
  var mySwiper = $('.swiper-container').swiper();
  //"Next" button - some HTML element with "button-next" class
  $('.button-next').click(function(){mySwiper.swipeNext()})
  //"Prev" button - some HTML element with "button-prev" class
  $('.button-prev').click(function(){mySwiper.swipePrev()})

})
</script> 
```

# javascript - 如何检查是否定义了一些变量？

> ID：16043059
> 
> 赞同：2
> 
> 时间：2013-04-16T17:11:19.970
> 
> 标签：javascript

我想检查我的 3 个变量是否已定义，但这不起作用：

```
If (typeof inputServer && inputUser && inputPassword !="undefined") {
        alert("it works!");
    } 
```

我的调试器说“Uncaught SyntaxError: Unexpected token {”

请帮我 ：）

问候汤姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:12:47.727

JavaScript 是区分大小写的语言。`if`关键字以 small 开头`i`。

此外，我建议您使用`typeof inputServer !== "undefined"`来检查变量是否已定义。

**REF：** [检测未定义的对象属性](https://stackoverflow.com/questions/27509/detecting-an-undefined-object-property-in-javascript)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T17:13:29.970

```
if ((inputServer != undefined) && (inputUser != undefined) && (inputPassword != undefined)) {
        alert("it works!");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:36:45.247

首先，`if`应该是小写。

然后，你可以这样做：

```
if (inputServer !== undefined && inputUser !== undefined && inputPassword !== undefined) {
    alert("it works!");
} 
```

如果您想检查它们是否不是`undefined`OR `null`，您可以这样做（这是使用双重相等有用的罕见情况之一）：

```
if (inputServer != null && inputUser != null && inputPassword != null) {
    alert("it works!");
} 
```

最后，如果您想检查它们是否不是任何虚假值（`null`, `undefined`, `false`, `-0`, `+0`, `NaN`, `''`），您可以这样做：

```
if (inputServer && inputUser && inputPassword) {
    alert("it works!");
} 
```

**旁注**：您不需要`typeof`在大多数正常情况下使用 - 除非`undefined`实际上是在程序中某处定义的变量...

幸运的是，在 ECMAScript 5.1 中，无法覆盖`window.undefined` [http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.1.3](http://www.ecma-international.org/ecma-262/5.1/#sec-15.1.1.3)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:14:48.683

它是 if(all lower) 而不是 If - 如果没有定义 vars，它仍然会给你一个错误，因为你在问他们 - 你可以做的是（假设这个代码在我理解的全局范围内运行：

```
if(typeof(window.inputServer) != 'undefined' && typeof(window.inputUser) != 'undefined'){

} 
```

# asp.net - 创建 Web 服务请求

> ID：16043062
> 
> 赞同：0
> 
> 时间：2013-04-16T17:11:37.170
> 
> 标签：asp.net, xml, vb.net, wcf, soap

我想将数据提供给一个代理，该代理创建一个SOAP XML请求，格式如下：

```
<dat:MusicCollection>
           <!--Zero or more repetitions:-->
           <dat:Song>
              <dat:songUserkey>TakemeHome</dat:songUserkey>
           </dat:Song>
</dat:MusicCollection> 
```

我已经编写了文件来调用服务并提供如下详细信息：

```
dim ucizi1 as SongRequest 'this is the request class in the proxy
dim Songs as Song = New Song
Songs.songUserKey = "TakeMeHome"
dim ucz
ucz = Songs.SongUserKey
ucizi1.SongCollection.Add(ucz) 
```

MusicCollection 类如下：

```
<System.Diagnostics.DebuggerStepThroughAttribute(),  _
 System.CodeDom.Compiler.GeneratedCodeAttribute("System.Runtime.Serialization", "4.0.0.0"),  _
 System.Runtime.Serialization.CollectionDataContractAttribute(Name:="ProductCollection", [Namespace]:="http://ucizi.Musicservice/DataContracts", ItemName:="Song")>  _
Public Class SongCollection
    Inherits System.Collections.Generic.List(Of ucizi.Music.DataContracts.Song)
End Class 
```

歌曲类如下：

```
<System.Diagnostics.DebuggerStepThroughAttribute(),  _
 System.CodeDom.Compiler.GeneratedCodeAttribute("System.Runtime.Serialization", "4.0.0.0"),  _
 System.Runtime.Serialization.DataContractAttribute(Name:="Product", [Namespace]:="http://Ucizi.Music/DataContracts")>  _
Partial Public Class Product
    Inherits Object
    Implements System.Runtime.Serialization.IExtensibleDataObject

    Private extensionDataField As System.Runtime.Serialization.ExtensionDataObject

    Private SongUserkeyField As String

    Public Property ExtensionData() As System.Runtime.Serialization.ExtensionDataObject Implements System.Runtime.Serialization.IExtensibleDataObject.ExtensionData
        Get
            Return Me.extensionDataField
        End Get
        Set
            Me.extensionDataField = value
        End Set
    End Property

    <System.Runtime.Serialization.DataMemberAttribute(IsRequired:=true)>  _
    Public Property SongUserkey() As String
        Get
            Return Me.SongUserkeyField
        End Get
        Set
            Me.SongUserkeyField = value
        End Set
    End Property
End Class 
```

但是，当我运行此代码时，出现错误：无法将类型为“system.string”的对象转换为类型“ucizi.music.DataContracts.Song”。

我看不出这个错误是从哪里来的，有人可以帮助我并告诉我如何纠正这个错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:56:30.410

排队

```
Songs.songUserKey = "TakeMeHome"
dim ucz
ucz = Songs.SongUserKey
ucizi.SongCollection.Add(ucz) 
```

你设置`ucz`为`SongUserKey`- 这是字符串。

然后，将它添加到集合**SongCollection**

```
Public Class SongCollection
    Inherits System.Collections.Generic.List(Of ucizi.Music.DataContracts.Song)
End Class 
```

这是预期的**`Song`**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T14:41:10.090

**在Songs.songUserKey = "TakeMeHome"**之后添加以下代码

 **```
dim ucizi2 as songCollection
ucizi2.Add(song)
ucizi1.songcollection = ucizi2 
```

这样就顺利解决了问题。你们让我大开眼界。**

# diff - 带有“<<<<<<< mine”和“>>>>>>>> yours”类型标记的带注释的差异文件

> ID：16043063
> 
> 赞同：6
> 
> 时间：2013-04-16T17:11:38.270
> 
> 标签：diff, diff3

我正在尝试使用具有如下标记的 Linux diff 命令创建一个 diff 文件（取自 diff3 手册页）：

```
 <<<<<<< mine
          lines from mine
          =======
          lines from yours
          >>>>>>> yours 
```

这种格式对我来说非常直观，让我可以轻松地修复 vim 中的合并冲突，当我尝试使用 diff3 合并三个文件（我的、你的和原始的）时它工作得很好，但我想要普通 diff 的相同格式。我希望这很简单，但我无法得到它。我已经尝试了大多数主要选项（-e、--ed 等），甚至尝试创建 --changed-group-format 但没有成功。

希望这是我刚刚忽略的简单事情。

更新：

添加行、删除行和冲突行的两个文件差异示例：

![在此处输入图像描述](https://i.stack.imgur.com/y9L9q.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T20:31:19.433

您可以使用 diff 选项。下面的shell脚本

```
diff \
   --unchanged-group-format='%=' \
   --old-group-format='' \
   --new-group-format='%>' \
   --changed-group-format='<<<<<<< mine
%<=======
%>>>>>>>> yours
' \
orig.txt new.txt 
```

输出

```
This has some stuff
in that gets
modified in
a later version
<<<<<<< mine
and there is a conflict
=======
and there is a conflict (like here)
>>>>>>> yours
about which version
should be used.
newline 
```

对于屏幕截图中的文件。您可以在文档中查看更多格式选项，例如[此处](http://www.chemie.fu-berlin.de/chemnet/use/info/diff/diff_3.html)。

一个班轮（从命令行工作，至少在 linux 上）：

```
diff --unchanged-group-format="%=" --old-group-format="" --new-group-format="%>" --changed-group-format="<<<<<<< mine%c'\\12'%<=======%c'\\12'%>>>>>>>> yours%c'\\12'" orig.txt new.txt 
```

# html - 页脚不会自动向下移动页面

> ID：16043064
> 
> 赞同：1
> 
> 时间：2013-04-16T17:11:38.550
> 
> 标签：html, css

我正在为我的页脚使用这个 CSS：

```
/* FOOTER */
#footer {
    width:100%;
    height:580px;
    border-top:4px solid #666666;
    background-color:#eeeeee;
}
#footer-inner {
    width:80%;
    margin:0 auto 0 auto;
    height:inherit;
}
#footerTop {
    width:100%;
    height:480px;
    padding-top:10px;
    border-bottom:2px #000000 solid;
}
#footerTopLeft {
    width:30%;
    height:420px;
    float:left;
    display:inline;
    margin-top:10px;
    padding:0 15px 10px 15px;
    border-right:1px solid #000000;
}
#footerTopMid {
    width:30%;
    height:420px;
    float:left;
    display:inline;
    margin-top:10px;
    padding:0 15px 10px 15px;
    border-right:1px solid #000000;
}
#footerTopRight {
    width:30%;
    height:420px;
    float:left;
    display:inline;
    padding:0 15px 10px 15px;
}

#enquiryForm                    { clear:both; padding:8px 40px 0 0;  }
.enquiryField                   { clear:both; padding:5px 0; }
.enquiryField label             { clear:none; float:left; }
.enquiryField input             { clear:none; font-family:Calibri; float:right; padding:3px; width:189px; }
.enquiryField textarea          { clear:none; float:right; font-family:Calibri; padding:5px; width:189px; }

.enquiryError                   { clear:both; color:#fff; font-family:Calibri; }
#enquirySent                    { color:#fff; font-family:Calibri; } 
```

但它不会根据上面的内容自动向下移动页面。这是一个完整的 css/HTML 的小提琴：

[http://jsfiddle.net/ctmGT/](http://jsfiddle.net/ctmGT/)

我似乎必须根据我拥有的内容量来更改我拥有的 div 高度

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:17:22.043

you need to change

```
<div style="clear: both; height:500px;"></div> 
```

to

```
<div class="push"></div> 
```

# .net - .Net Wrapper 和内存空间来解决全局变量问题

> ID：16043068
> 
> 赞同：0
> 
> 时间：2013-04-16T17:11:50.690
> 
> 标签：.net, memory-management, dll

我有一个现有的 C++ DLL，它是通过调用应用程序的 LoadLibray 调用的。它被交给了一个窗口，并预计在该窗口中运行。在单窗口环境中（即为下一个用户和/或窗口卸载 DLL），一切都很好。但是，我发现当我们获得多个窗口时，就会发生麻烦。

我相信问题是由于我们草率并且有相当多的全局数据（即`extern`，或`declare`类之外的s），当然，当窗口切换时，并非所有数据都正确更新并且它被“混淆”了。

一种解决方案可能是包装所有全局数据并将其分配给“窗口”，然后当激活特定窗口时，指针将指向该数据块。但是，我认为这是一项巨大的编码工作。

我想知道的另一个解决方案（最后是问题:-) 是我们是否可以包装 DLL 并使其成为一个 .NET 对象，该对象将为每个需要的窗口实例化。

问题是这是否可以以这样一种方式完成，以便每个实例完全独立于另一个实例，从而消除我们在使用全局变量时遇到的麻烦？

# playframework-2.0 - POST /tasks/:id/删除

> ID：16043071
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:11:58.713
> 
> 标签：playframework-2.0

我刚刚开始尝试使用 play 框架并尝试使用 todolist 项目

在路由文件中：我对其他事情没有任何问题，但以下 POST /tasks/ :id/delete controllers.application.deleteTask() 如果有人帮助我，:id/delete 的确切工作是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:27:28.087

您的示例中有 3 段由斜线分隔。第一个是`tasks`静态的，第二个`:id`是动态的，第三个是静态的`delete`，这意味着链接可以是`/tasks/1/delete`，`/tasks/2/delete`等等。无论如何，您应该将此动态段作为`deleteTask()`操作参数传递：

```
POST /tasks/:id/delete controllers.application.deleteTask(id: Long) 
```

它在**动态部件**和**参数类型部分的**[路线文档](http://www.playframework.com/documentation/2.0.4/JavaRouting)中进行了描述。

# android - android如何制作文本文件查看器？

> ID：16043072
> 
> 赞同：2
> 
> 时间：2013-04-16T17:12:00.283
> 
> 标签：android, file, text

这是一个概念问题。我在 android 市场上看到了很多文本文件查看器。他们能够打开一个包含数千个单词的 txt 文件。查看器以百页显示文本内容，并允许返回上一页，转到下一页等。我的问题是，因为单词的长度不同。如果你想去第50页，你是否必须从第1页开始，检查第1页到第49页需要多少单词，那么你知道第50页的第一个英文单词吗？而当你返回一页时，你不知道第 49 页的第一个字。再说一次，我怎样才能有效地找到它？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:34:12.740

如果您没有使用文本查看器的经验，最好的方法是基于 webView 的应用程序。您可以轻松地将一些 HTML/CSS 添加到文本中并将其传递给 Web 视图。WebKit 将完成所有工作。例如，断字。自己做有点棘手，特别是对于多种语言。WebKit 可以为你做这件事。

在没有 WebKit 的情况下谈论您的概念 - 让用户更改字体重要吗？如果是，我猜你应该在每次更改时重新解析文档。无论如何，最简单的方法是使用百分比并显示不精确的页面，而是非常接近的位置。例如，您可以在文档的 Pro-cents 中找出一页的大小，并使用它来获取需要显示的部分。

祝你研究顺利！

# java - 如何打印 ArrayList 中的所有元素？

> ID：16043073
> 
> 赞同：0
> 
> 时间：2013-04-16T17:12:04.057
> 
> 标签：java, arraylist

我正在尝试打印我添加到数组列表中的所有元素，但它只打印地址而不是字符串。
有人可以帮助我或给出一些提示吗？我整个下午都在找

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:13:14.197

您需要覆盖 Autuer 的 toString 方法以 String 格式返回其内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:15:22.830

You can also, use a foreach to do it ;)

```
for(Auteur a: auteurs){
    System.out.print(a.getName() + " - " + a.getNumber());
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:04:33.127

`itr.next()`返回`Auteur`而不是的对象`String`。要打印名称，您需要键入 cast 它，`Auteur`如果您有该类的打印方法，则打印它`Auteur`。

```
Auteur aut = (Auteur) itr.next();
System.out.println(aut.printMethod()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:16:57.573

Every object in Java inherits

```
public String toString(); 
```

from `java.lang.Object`

in your `Auteur` class you need to write some code similar to the following:

.... ....

```
@Override
public String toString() {
    return "Name: "+this.name;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T17:18:07.947

Try defining the `toString()` method in your `Auter` class as follows:

```
public String toString() {
    return this.getName() + " - " + this.getNumber());
} 
```

and your code will do what you wish. `System.out.println` calls the argument's `toString()` method and prints that out to the Output console.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T16:09:47.713

您所看到的称为对象的默认[toString](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#toString%28%29)。它是它所属的类的 FQCN（完全限定的类名）和对象的 hashCode 的合并。

引用 toString 的 JavaDoc：

> Object 类的 toString 方法返回一个字符串，该字符串由对象作为实例的类的名称、at 符号字符“@”和对象的哈希码的无符号十六进制表示形式组成。换句话说，此方法返回一个等于以下值的字符串：
> 
> ```
>  getClass().getName() + '@' + Integer.toHexString(hashCode()) 
> ```

我们可以覆盖`toString`以提供更易于阅读的输出。看看下面的两个类，有和没有`toString`。尝试执行 main 方法并比较两个打印语句的输出。

```
class Person {
    private String name;

    @Override
    public String toString() {
        return "Person [name=" + this.name + "]";
    }
}

class Address {
    private String town;
}

public class Test {
    public static void main(String... args) {
        Person person = new Person();
        Address address = new Address();

        System.out.println("Person is : " + person);
        System.out.println("Address is : " + address);
    }
} 
```

# php - 将 Javascript 或 PHP 变量传递到另一个页面

> ID：16043078
> 
> 赞同：1
> 
> 时间：2013-04-16T17:12:17.647
> 
> 标签：php, javascript

我已经尝试解决这个问题两天了，但没有运气。我正在使用带有 Javascript 的 PHP，我正在尝试访问另一个页面上的 Javascript 变量。

这是我的 Javascript 代码，它只提醒用户 taskID 是什么......

```
<script>
function myFunction(taskID)
{
alert("Task #" + taskID);

}
</script> 
```

这是我的PHP

```
//select all tasks for this report
            $tasks = mysqli_query($conn,"SELECT taskID, hoursSpent, workDone, plannedTasks FROM Tasks where reportID = $report_id AND projID = $proj_id");
            $task_count = 1;
            while($row1 = mysqli_fetch_array($tasks))
            {
                $taskID = $row1['taskID'];
                //display the task information
                echo "<strong id='tasks'>Task #" . $task_count . "</strong>";
                echo " - <a href = '#' onclick ='myFunction($taskID)'>Edit</a><br>";

                echo "Hours Spent: " . $row1['hoursSpent'] . "<br><br>"; 
                echo "Accomplished: <br>" . $row1['workDone'] . "<br><br>";
                echo "Planned for Next week: <br>" . $row1['plannedTasks'] . "<br>";
                echo "<br>";
                $task_count++;
            } 
```

如何将该 taskID 传递到另一个页面，以便我可以编辑任务信息？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:17:06.993

Just change this:

```
echo " - <a href = '#' onclick ='myFunction($taskID)'>Edit</a><br>"; 
```

To

```
echo " - <a href = 'editTask.php?id=".$taskID."'>Edit</a><br>"; 
```

And you're there. Just make sure that, in the editTask.php file, you check the id:

```
$editID = (int) $_GET['id'];//<-- $editID will hold an int, that is the id of the record the user wanted to edit. 
```

Quite apart from that: good to see you're using an up-to-date extension for mysql. Nevertheless, code like this:

```
mysqli_query($conn,"SELECT taskID, hoursSpent, workDone, plannedTasks FROM Tasks where reportID = $report_id AND projID = $proj_id"); 
```

Will leave you vulnerable for injection attacks. Please do look into prepared statements.

```
$tasks = mysqli_query($conn, 'SELECT taskID, hoursSpent, workDone, plannedTasks FROM Tasks WHERE reportID = ? AND projID = ?');
mysqli_stmt_bind_param($tasks, 'i', $reportID);//replace i with s if should be a string etc... 
```

Once your building queries based on client side data (which you will be doing with this: using the url to get the id...), it's the easiest way to protect yourself against a very common threat.

[check this link](http://www.php.net/mysqli_prepare)
[This one](http://www.php.net/manual/en/mysqli-stmt.bind-param.php)
And of course, [this one](http://bobby-tables.com/) to understand what injection is

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:18:02.190

Like this

```
<script>
function myFunction(taskID) {
  location="nextpage.php?task="+taskID;
  return false;

}
</script>

echo " - <a href = '#' onclick ='return myFunction("'.$taskID.'")'>Edit</a> 
```

Or simpler

```
echo " - <a href='nextpage.php?task='.$taskID.'">Edit</a> 
```

# c++ - 串口通讯读线C++

> ID：16043079
> 
> 赞同：1
> 
> 时间：2013-04-16T17:12:24.053
> 
> 标签：c++, python, symbian, pyserial, pys60

我想用 Symbian C++ 从串行中读取一行，但要做到这一点，我必须继续读入缓冲区，直到到达“/n”。我不知道该怎么做。这实际上是一个 Python 项目，但我正在尝试使用从 PySerial 移植的必要函数创建一个 C++ 库。我仍然需要移植的是“readline”。

这是它的原始 Python 代码：

```
def readline(self, size=None, eol=LF): 
     """read a line which is terminated with end-of-line (eol) character
     ('\n' by default) or until timeout."""
     leneol = len(eol)
     line = bytearray()

     while True: 
         c = self.read(1)
         if c: 
             line += c 
             if line[-leneol:] == eol: 
                 break 
             if size is not None and len(line) >= size: 
                 break 
         else: 
             break
     return bytes(line) 
```

我的库基于 PyS60USB，它已经实现了以下内容以读取至少一个字节：

```
TUint8* buf = 0;
TPtr8 tmp(buf, 0);
TInt err;
TBool alloc_ok = EFalse;

Py_BEGIN_ALLOW_THREADS;         
TRAP(err,
   buf = (TUint8*) User::AllocLC(1);
   tmp.Set(buf, 0, 1);
   alloc_ok = ETrue;
   self->iConnManager->RecvL(tmp, timeout);
   CleanupStack::Pop(buf);
   );
Py_END_ALLOW_THREADS; 
```

我现在的问题是，如何将上述 Python 代码转换为 Symbian C++ 代码，以便将所有读取字节添加到缓冲区并不断检查缓冲区的 eol？

谢谢，所有帮助将不胜感激。

# css - 相对改变字体大小

> ID：16043081
> 
> 赞同：0
> 
> 时间：2013-04-16T17:12:36.477
> 
> 标签：css

我不知道默认字体大小是多少，但无论如何我想将其缩小 2px。

```
<td style='width:30%; margin:0 5%; text-align:left;vertical-align:top;font-family:Tahoma, Arial, Helvetica;' font-size:'xx'>Some text</td> 
```

分配什么`font-size`属性以使我的文本小 2 个像素。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:21:21.463

如果你真的想让它`2px`更小，并且你很乐意接受这只适用于现代浏览器：

```
font-size: calc(1em - 2px); 
```

参考：

[caniuse](http://caniuse.com/calc)上的兼容性信息

[Mozilla](https://developer.mozilla.org/en-US/docs/CSS/calc)或[w3c](http://www.w3.org/TR/css3-values/#calc)上的文档

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:16:02.770

What you want is to use em's instead of pixels. Em's are represented in percentages relative to everything else so

```
font-size: .8em; 
```

Would make it 80% of the size as the text around it.

See [http://www.w3schools.com/cssref/css_units.asp](http://www.w3schools.com/cssref/css_units.asp) for a good explanation on CSS units.

# ios - Superview 中的自定义 UIView 放置

> ID：16043088
> 
> 赞同：1
> 
> 时间：2013-04-16T17:12:44.100
> 
> 标签：ios, uiview, frame, subview

我有一个自定义 UIView 子类，它需要位于超级视图的底部。我使用以下方法设置视图的原点：

```
CGRect subviewFrame = subview.frame;

CGPoint newOrigin = CGPointMake(0, superview.bounds.size.height - subviewFrame.size.height);

subviewFrame.origin = newOrigin;

[subview setFrame:subviewFrame]; 
```

但是，这会将子视图（origin.y）直接放在父视图的视图框架之外。

![框架外的子视图](https://i.stack.imgur.com/Haw0j.png)

如果我使用：

```
CGPoint newOrigin = CGPointMake(0, superview.bounds.size.height - subviewFrame.size.height * 2.0f); 
```

我得到了我想要的结果，这是位于窗口底部的子视图。

![框架内的子视图](https://i.stack.imgur.com/uGvnz.png)

我不明白为什么必须将子视图的高度乘以 2。

如果有人能告诉我我错过了什么，将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T21:59:01.213

我使用 [UIScreen mainScreen].bounds 来获取初始帧，它不会补偿状态和导航栏。UIScreen applicationFrame：返回框架减去状态栏高度。我使用此方法并考虑导航栏高度（44.0）以获得所需的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T10:38:38.483

绘制 UIView 边界的有用代码。KADebugShowViewBounds(superview, [UIColor redColor]) 和 KADebugShowViewBounds(subview, [UIColor redColor])。您将看到红色的超级视图和子视图的边界。我认为问题应该是你的布局。

```
#import <Foundation/Foundation.h>
#import <QuartzCore/QuartzCore.h>

#ifndef KAViewDebugHelper_h
#define KAViewDebugHelper_h

#ifdef DEBUG
#define KADebugShowViewBounds(aView, aColor) \
do \
{ \
    UIColor *color = [(id)aColor isKindOfClass:[UIColor class]] ? aColor : [UIColor redColor]; \
    aView.layer.borderColor = color.CGColor; \
    aView.layer.borderWidth = 1.0f; \
} \
while(0)
#else
#define KADebugShowViewBounds(aView)
#endif
#endif 
```

# c# - 为什么 `Console.Read()` 总是跳到另一个位置？

> ID：16043097
> 
> 赞同：0
> 
> 时间：2013-04-16T17:13:19.807
> 
> 标签：c#, if-statement, timer, console, character

我有一种方法用于询问一个人想在`Console`游戏中走哪条路。

上述方法：

私有静态无效 dirChoose()

```
{
    Console.SetCursorPosition(0, 7);
    Console.WriteLine("A mysterious voice says \"Which way will you go?\"");
    Console.WriteLine("Type");
    if (curLeft == false) { Console.WriteLine("(L)eft    "); }
    if (curUp == false) { Console.WriteLine("(U)p        "); }
    if (curRight == false) { Console.WriteLine("(R)ight  "); }
    if (curDown == false) { Console.WriteLine("(D)own    "); }

    Console.SetCursorPosition(49, 7);

    userDirInput = Convert.ToChar(Console.Read());
    Console.SetCursorPosition(0, 13);
    Console.Write("read as " + userDirInput);

         if (userDirInput == 'u' || userDirInput == 'U') { reDir = 1; userDirInput = 'y'; }//up
    else if (userDirInput == 'd' || userDirInput == 'D') { reDir = 3; userDirInput = 'y'; }//down
    else if (userDirInput == 'l' || userDirInput == 'L') { reDir = 0; userDirInput = 'y'; }//left
    else if (userDirInput == 'r' || userDirInput == 'R') { reDir = 2; userDirInput = 'y'; }//right
    else//anything besides
    {
        Console.SetCursorPosition(0, 14);
        Console.WriteLine("You entered an incorrect direction. Please try again.");
        Console.SetCursorPosition(rWALL_STOP - 1, 3);

        doneBool = false;
        t.Elapsed += right;
        t.Start();

    }
}//dirChoose() 
```

在回答“你会走哪条路？”的问题时 应该读取输入的第一个字符。因此，如果您输入整个单词“left”或“right”，那么它会显示为“l”和“r”。然后它应该改变一个数字并让它做它应该做的事情。出于某种奇怪的原因，它在读取第一个后跳转到第二个，因此它随后将适当的方法添加到计时器并继续前进。

笔记：

```
static Timer t = new Timer(16);
public static char userDirInput { get; set; }

public static bool curLeft { get; set; }
public static bool curUp { get; set; }
public static bool curRight { get; set; }
public static bool curDown { get; set; }
public static bool doneBool{ get; set; } 
```

所以我的问题是“为什么光标在第一个字符之后跳到第二个字符？我该如何解决？”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:20:57.167

您可以按如下方式阅读密钥。将 false 值传递给 ReadKey() 将在屏幕上回显输入的值。

```
ConsoleKeyInfo cki = Console.ReadKey(false);
userDirInput = cki.KeyChar; 
```

代替

```
userDirInput = Convert.ToChar(Console.Read()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:32:36.843

我不确定我是否理解您的问题，但您似乎误解了 Console.Read() 的行为。当您调用 Console.Read() 时，您将获得缓冲区中的下一个字符。如果用户键入“left”然后按回车，您将调用控制台读取以获取“l”，然后缓冲区中将剩下 5 个字符。下一个调用将返回'e'，然后是'f'，然后是't'，然后是'\r'，然后是'\n'。

因此，如果用户输入“left\r\n”，那么在您第二次调用 dirChoose() 时，它的行为将与无法识别的输入一样。

# javascript - 使用 Javascript/html 进行简单的图像替换

> ID：16043106
> 
> 赞同：0
> 
> 时间：2013-04-16T17:13:48.230
> 
> 标签：javascript, jquery, html, css

无法为这个简单的任务找到准时的答案，非常感谢您的帮助

我们有一个想要根据用户的颜色选择来切换的图像。

尝试了几种方法，都没有奏效。

这是这样的想法：

![](https://i.stack.imgur.com/kCa1l.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:26:46.553

只需将单击侦听器绑定到您的按钮并更改`src`图像的属性。

```
$('#colorButton').click( function() { //choose a new color
    $('#imageIcon').attr('src', 'path/to/new/image.png'); //change the img's source
}); 
```

编辑（回答问题）：如果您希望此代码应用于所有按钮，请为每个按钮提供类似的类而不是 ID：

```
<div class="colorButton"></div> 
```

然后您可以使用以下选择器将上述点击侦听器应用于所有这些`divs`：

```
$('.colorButton') 
```

自然，您希望尽可能简单地更改您的图像。您可以将所有颜色映射到其相应的图像文件，但就设计而言，这可能会变得混乱和笨拙。我会创建一个目录来存储您的所有图像文件（例如，`/your/color/swatches`），并为每个文件指定一个与其颜色一致的名称，例如`'ff0000.png'`红色、`'0000ff.png'`蓝色等。

我们为什么要这样做？这样我们就可以根据`background-color`您按钮的属性切换您的图像。假设您有以下按钮：

```
<div class="colorButton" style="background-color: '#ff0000'"></div>
<div class="colorButton" style="background-color: '#0000ff'"></div> 
```

您可以使用相同的单击侦听器，但由于我们将背景颜色映射到图像，因此必须对其进行一些修改：

```
$('.colorButton').click( function() {
    var color = $(this).css('backgroundColor');
    //(You'll need to modify your color string here)
    $('#imageIcon').attr('src', 'your/color/swatches/' + color + '.png');
}); 
```

但这还行不通。由于大多数浏览器`"rgb(xx, yy, zz)"`从返回`.css('backgroundColor')`，您需要将该字符串转换为十六进制。[SO上的这篇文章](https://stackoverflow.com/a/1740716/464188)提供了一种或多或少有效的方法，但是您需要对其进行修改以适合我指出的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:20:45.057

```
$('#YourButton').click(function() {
    var oldSrc = 'images/Image1.png';
    var newSrc = 'images/Image2.png';
    $('img[src="' + oldSrc + '"]').attr('src', newSrc);

}); 
```

Just change the image source with javascript by clicking your button with another color

Note: it´s jquery so you have to include the js file..

# logging - Heroku：无法访问日志

> ID：16043111
> 
> 赞同：0
> 
> 时间：2013-04-16T17:14:15.700
> 
> 标签：logging, heroku, permissions

在尝试跟踪 Heroku 上托管的 api 的日志时：

```
heroku logs --tail --app production 
```

我收到以下消息：

```
!    You do not have access to the app production. 
```

我之前已经跟踪过这些日志一百万次了。我仍然可以部署到生产服务器，并且我已经注销并重新登录。似乎没有任何工作。有任何想法吗？

# c# - 如何防止直接访问内容？

> ID：16043113
> 
> 赞同：4
> 
> 时间：2013-04-16T17:14:20.407
> 
> 标签：c#, asp.net-mvc

使用 ASP MVC 4.5，如何应用安全措施来防止用户直接访问内容？

例如，仅通过输入链接来防止访问存储在 Web 服务器上的图像或其他文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:48:32.690

1.  将您的图像放在不可通过网络访问的文件夹中。
2.  创建可以读取图像文件并在 HTTP 响应中返回其内容的服务器端脚本（例如，HttpHandler）。
3.  在该脚本中，执行用户验证以确保用户有权访问该文件。
4.  在 HTML 中，让标记的`src`属性`img`指向您的脚本。

用户仍然可以直接输入脚本的 URL 来查看图像。但是您至少可以要求用户登录到您的站点并有权查看图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:18:22.847

[使用ASP .NET Membership](http://msdn.microsoft.com/en-us/library/yh26yfzy%28v=vs.100%29.aspx)等身份验证系统并要求某些凭据才能访问内容。除此之外，真的没有办法了。如果用户有直接链接并可以访问您网站的该区域，则根据网络服务器的工作方式，没有办法阻止它。

您可以采取某些安全措施来帮助防止用户获得直接链接，一个简单的方法就是禁用右键单击。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T15:04:42.397

为了防止盗链，我制作了以下**HTTPHandler 。**

*它似乎适用于我的项目，但我不确定这是否是最佳实践。*

```
 public void ProcessRequest(HttpContext context)
    {
        //write your handler implementation here.

        //Http
        HttpRequest request = context.Request;
        HttpResponse response = context.Response;

        //Header - Properites
        int Index = -1;
        string[] Keys = request.Headers.AllKeys;
        List<string[]> Values = new List<string[]>();

        //Header - Loop to get key values
        for (int i = 0; i < Keys.Length; i++)
        {
            Values.Add(request.Headers.GetValues(i));
            //Check if property "Accept" exists
            if (Keys[i].CompareTo("Accept") == 0)
                Index = i;
        }

        //Check if URL and URL Referrer are null
        if (context.Request.Url != null && context.Request.UrlReferrer != null && Index >= 0)
        {
            //Check image types
            if (!context.Request.UrlReferrer.AbsolutePath.EndsWith(".bmp") ||
                !context.Request.UrlReferrer.AbsolutePath.EndsWith(".jpg") ||
                !context.Request.UrlReferrer.AbsolutePath.EndsWith(".jpeg") ||
                !context.Request.UrlReferrer.AbsolutePath.EndsWith(".png"))
            {

                //Check header "Accept"
                if (Values[Index][0].CompareTo("*/*") == 0)
                {
                    //Get bytes from file
                    byte[] MyBytes = File.ReadAllBytes(context.Request.PhysicalPath);
                    //new HttpContext(context.Request, context.Response).Request.MapPath(context.Request.RawUrl).ToString()

                    context.Response.OutputStream.Write(MyBytes, 0, MyBytes.Length);

                    context.Response.Flush();
                }
                else
                    //Redirect                
                    context.Response.Redirect("/Home");

            }
            else
                //Redirect                
                context.Response.Redirect("/Home");
        }
        else
            //Redirect                
            context.Response.Redirect("/Home");
    } 
```

**Web.config**也进行了如下修改：

```
<system.webServer>
    <handlers>
        <!--My-->
        <add name="PhotoHandler-BMP" path="*.bmp" verb="GET" type="MVCWebApplication.Handlers.PhotoHandler" resourceType="File" />
        <add name="PhotoHandler-JPG" path="*.jpg" verb="GET" type="MVCWebApplication.Handlers.PhotoHandler" resourceType="File" />
        <add name="PhotoHandler-JPEG" path="*.jpeg" verb="GET" type="MVCWebApplication.Handlers.PhotoHandler" resourceType="File" />
        <add name="PhotoHandler-PNG" path="*.png" verb="GET" type="MVCWebApplication.Handlers.PhotoHandler" resourceType="File" />
    </handlers>
</system.webServer> 
```

随时评论任何改进。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:28:08.097

除非您想打扰您的用户，否则您无能为力。一种可能（并且被广泛使用）的事情可能是检查您的推荐人（并使其出现在您的应用程序中），但这很容易被欺骗。

如果对此的安全性至关重要，那么唯一想到的就是通过脚本下载所有内容，该脚本将检查凭据（或您可能想要的任何其他安全措施），但您无能为力。

如果浏览器确实已经将某些内容下载到本地计算机，那么您绝对无法阻止该用户使用该数据（您可以设置一些障碍，例如避免右键单击等，但在某些情况下可以避免所有这些障碍）方式或其他）。

# css - 下拉菜单列表问题 CSS

> ID：16043114
> 
> 赞同：0
> 
> 时间：2013-04-16T17:14:36.023
> 
> 标签：css, html, drop-down-menu

我的下拉菜单不起作用！它适用于 Jsfiddle，但不适用于现实生活......哈哈。我对这一切都很陌生。我希望这不是一个愚蠢的问题。我试图找到解决方案，但还没有看到一个按我想要的方式工作的解决方案。

```
<!DOCTYPE html>

    <html>
        <head>
            <title>Home - Joe </title>
            <link rel="stylesheet" type="text/css" href="home.css"/>
            <script src="Home.js" type="text/javascript"></script>
        </head>
        <body>
            <div id="header">
                <ul id="nav">
                    <li> <a href="index.html"> Home </a></li> <!-- menu-->
                    <li> <a href="music.html"> Music </a></li>
                        <ul class="dropdown">
                            <li><a href="#">Albums</a></li> <!-- drop down list-->
                            <li><a href="#">Downloads</a></li>
                            <li><a href="#">Videos</a> </li>
                        </ul>
                    <li> <a href="Portfolio.html"> Portfolio </a></li>
                        <ul class="dropdown">
                            <li><a href="#">Photography</a></li>
                            <li><a href="#">Designs</a></li>
                            <li><a href="#">Webpages</a> </li>
                        </ul>
                    <li> <a href="About.html"> About </a></li>
                        <ul class="dropdown">
                            <li><a href="#">Biography</a></li>
                            <li><a href="#">Interests</a></li>
                            <li><a href="#">Goals</a> </li>
                        </ul>
                    <li> <a href="Contact.html"> Contact </a></li>
                </ul>
            </div>

            <div id="ContentLeft">  
            </div>
            <div id="ContentBottom">
            </div>
        </body>
    </html> 
```

CSS：

```
body {
        color: #666;
        text-align: left;
        margin: 0px;
        font-family: Roboto;
        font-weight: lighter;
    }

#header {
    width:100%;
    height:20px;
    background:#333;
    border-bottom:1px solid #000;
    padding: 5px 5px 5px 0px;
}

.dropdown{
    display:none;
    list-style-type:none;
    background:#333;
}

#nav {
    list-style-type: none;
    margin-top: 0px;
    margin-left:-30px;
    background:#333;
    float:left;

}   

#nav li {
    padding:0px 10px 0px 10px;
    float:left;
}

#nav li a {
    color: #666;
    text-decoration: none;
}

#nav li a:hover {
     color: #CCC;
}
#nav li:hover ul{
    display:block;
    position: absolute;
    margin: 0px 0px 0px -10px;
    padding:0;
    text-align: left;
}

#nav li:hover li{
    float:none;
     background:#333;
}

#nav li a:active {
     color: #FFF;
} 
```

[http://jsfiddle.net/WwuRK/](http://jsfiddle.net/WwuRK/) <--- 我希望它像这样工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:18:39.157

您需要将`<ul>` ***.*** `<li>`在您当前的示例中，您正在执行以下操作：

```
<body>
    <div id="header">
        <ul id="nav">
            <li> <a href="index.html"> Home </a></li> <!-- menu-->
            <li> <a href="music.html"> Music </a></li>
                                                    ^----------- remove
                 <ul class="dropdown">
                     <li><a href="#">Albums</a></li> <!-- drop down list-->
                     <li><a href="#">Downloads</a></li>
                     <li><a href="#">Videos</a> </li>
                </ul>
            </li> <-------- add removed </li> here
            <li> <a href="Portfolio.html"> Portfolio </a></li>
                                                           ^----------- remove 
```

删除标签并将它们添加***到***.`ul.dropdown`

这是您当前代码的演示（不起作用）：http: [//jsfiddle.net/dirtyd77/WwuRK/4/](http://jsfiddle.net/dirtyd77/WwuRK/4/)

* * *

这是您的代码的更新版本：

```
<div id="header">
    <ul id="nav">
        <li> <a href="index.html"> Home </a></li> <!-- menu-->
        <li> <a href="music.html"> Music </a>
            <ul class="dropdown">
                <li><a href="#">Albums</a></li> <!-- drop down list-->
                <li><a href="#">Downloads</a></li>
                <li><a href="#">Videos</a> </li>
            </ul>
        </li>
        <li> <a href="Portfolio.html"> Portfolio </a></li>
        <ul class="dropdown">
            <li><a href="#">Photography</a></li>
            <li><a href="#">Designs</a></li>
            <li><a href="#">Webpages</a> </li>
        </ul>
        <li> <a href="About.html"> About </a>
            <ul class="dropdown">
                <li><a href="#">Biography</a></li>
                <li><a href="#">Interests</a></li>
                <li><a href="#">Goals</a> </li>
            </ul>
        </li>
        <li> <a href="Contact.html"> Contact </a></li>
    </ul>
</div>

<div id="ContentLeft"></div>
<div id="ContentBottom"></div> 
```

编辑代码的工作演示：http: [//jsfiddle.net/dirtyd77/WwuRK/6/](http://jsfiddle.net/dirtyd77/WwuRK/6/)

希望这会有所帮助，如果您有任何问题，请告诉我。

# xaml - 从 Metro 应用程序中的邮件应用程序获取数据

> ID：16043117
> 
> 赞同：0
> 
> 时间：2013-04-16T17:14:50.797
> 
> 标签：xaml, microsoft-metro

是否可以从第 3 方 Metro 应用程序中获取数据到我的应用程序中？例如，我试图找出我的 Metro 应用程序是否可以从特定用户那里获取电子邮件数据。真的可以通过共享合约实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-20T04:54:34.690

谢谢xyroid。这是不可能的。关闭此线程。

# expressionengine - 仅表达式引擎列表类别条目

> ID：16043118
> 
> 赞同：0
> 
> 时间：2013-04-16T17:14:51.013
> 
> 标签：expressionengine

使用下面的代码，我目前正在显示频道的所有类别，但我只需要显示每个条目的类别或类别。它们已在每个单独的条目中被选中。

我错过了什么？

```
 {exp:channel:entries channel="news" dynamic="no" orderby="date" sort="desc" }

<article class="listing">

        <h2><a href="#">{title}</a></h2>
    <p>Posted on: {entry_date format="%F %j, %Y"} in {exp:channel:categories channel="news" style="linear" show_empty="no"}
        {category_name},{/exp:channel:categories}</p> 

            <p class="summary">{news_summary}</p>

    <p style="margin-top: 10px;"><a href='{url_title_path='news/view'}'>Read More</a></p>

      </article> 
```

{/exp:channel:entries}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:43:35.497

问题是，我在类别中使用了常规的频道类型标签。正确的代码是......

```
 {exp:channel:entries channel="news" dynamic="no" orderby="date" sort="desc" }

<article class="listing">

        <h2><a href="#">{title}</a></h2>
    <p>Posted on: {entry_date format="%F %j, %Y"} in 

    {categories  backspace="1"}
             {category_name},
    {/categories}</p>

            <p class="summary">{news_summary}</p>

    <p style="margin-top: 10px;"><a href='{url_title_path='news/view'}'>Read More</a></p>

      </article> 
```

{/exp:channel:entries}

# python - 用于人脸识别的 PCA 类 matplotlib

> ID：16043120
> 
> 赞同：0
> 
> 时间：2013-04-16T17:15:05.813
> 
> 标签：python, matplotlib, face-recognition, pca

我正在尝试使用 python 通过主成分分析 (PCA) 进行人脸识别。我正在使用`pca`. `matplotlib`这是它的文档：

> 类 matplotlib.mlab.PCA(a) 计算 a 的 SVD 并为 PCA 存储数据。使用 project 将数据投影到一组缩减的维度上
> 
> ```
> Inputs:
> a: a numobservations x numdims array
> Attrs:
> a a centered unit sigma version of input a
> numrows, numcols: the dimensions of a
> mu : a numdims array of means of a
> sigma : a numdims array of atandard deviation of a
> fracs : the proportion of variance of each of the principal components
> Wt : the weight vector for projecting a numdims point or array into PCA space
> Y : a projected into PCA space 
> ```

因子载荷在 Wt 因子中，即第一个主成分的因子载荷由 Wt[0] 给出

这是我的代码：

```
import os
from PIL import Image
import numpy as np
import glob
import numpy.linalg as linalg
from matplotlib.mlab import PCA

#Step 1: put database images into a 2D array
filenames = glob.glob('C:\\Users\\Karim\\Downloads\\att_faces\\New folder/*.pgm')
filenames.sort()
img = [Image.open(fn).convert('L').resize((90, 90)) for fn in filenames]
images = np.asarray([np.array(im).flatten() for im in img])

#Step 2: database PCA
results = PCA(images.T)
w = results.Wt

#Step 3: input image
input_image = Image.open('C:\\Users\\Karim\\Downloads\\att_faces\\1.pgm').convert('L')
input_image = np.asarray(input_image)

#Step 4: input image PCA
results_in = PCA(input_image)
w_in = results_in.Wt

#Step 5: Euclidean distance
d = np.sqrt(np.sum(np.asarray(w - w_in)**2, axis=1)) 
```

但我收到一个错误：

```
Traceback (most recent call last):
  File "C:/Users/Karim/Desktop/Bachelor 2/New folder/matplotlib_pca.py", line 32, in <module>
    d = np.sqrt(np.sum(np.asarray(w - w_in)**2, axis=1))
ValueError: operands could not be broadcast together with shapes (30,30) (92,92) 
```

1.  谁能帮我纠正错误？
2.  这是人脸识别的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:08:22.567

该错误告诉您两个数组 (`w`和`w_in`) 的大小不同，并且`numpy`无法弄清楚如何广播值以获取差异。

我不熟悉此功能，但我猜问题的根源是您的输入图像大小不同。

# php - 以编程方式附加到 PHP 中的文件

> ID：16043124
> 
> 赞同：1
> 
> 时间：2013-04-16T17:15:11.720
> 
> 标签：php, python, exec, file-permissions

我正在尝试通过网站以编程方式将 RSA 公钥附加到 authorized_keys 文件中，但我无法找到任何可行的解决方案。我尝试使用 PHP 的`file_put_contents()`函数，但遇到权限被拒绝错误，并且我有一个可以工作的 python 脚本，但我似乎无法让 PHP 使用`exec()`命令或`shell_exec()`. 这是相关的PHP代码：

```
if(@$_POST['action']=='submit'){
    $key = $_POST['key_field'];

    //file_put_contents("/home/biosproject/.ssh/authorized_keys", $key, FILE_APPEND);

    $test = "/usr/bin/python savetofile.py \"".$key."\"";
    $tmp = shell_exec($test);
} 
```

我知道我需要清理输入，但该网站目前正在开发中，所以我只是在此期间像这样测试它。现在我正在使用运行 Apache 的 XAMPP。有什么我想念的或可以尝试的吗？对于 PHP exec/shell_exec，我尝试对命令的所有部分使用完整路径名，但还没有任何效果。python脚本如下：

```
#!usr/bin/python
import sys    
key = sys.argv[1]    
with open("/home/biosproject/.ssh/authorized_keys","a") as append:
    diditwork = append.write(key)
print key 
```

正如我之前提到的，这个脚本是有效的，但我不能从 PHP 脚本中调用它。

## 编辑：

我的 authorized_keys 文件如下所示：
-rw-rw-rw- 1 biosproject www-data 1200 Apr 15 13:17 /home/biosproject/.ssh/authorized_keys

## 更新：

我通过使用从数据库条目附加必要信息的 cron 作业绕过权限来解决此问题。现在效果很好！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:22:25.803

关于我的内联代码的说明：

```
$text = "nice text to append :P";
// open a file handler with a+ flag that means "open file for append and if it does not exist, create it"
$fo = fopen("filename.ext", "a+");
// append $text to file handler with a \n at the end
fwrite($fo, $text . PHP_EOL); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:23:52.450

Python 脚本在这里对您没有帮助 - 这是`/home/biosproject/.ssh/authorized_keys`文件的权限问题，即 Apache 没有修改它的权限，也不会产生任何进程，这将包括您的 Python 脚本。

最简单的解决方法是更改​​文件权限，使其可由 Apache 写入。假设 apache 作为 group 运行`www-data`，做...

```
sudo chgrp www-data /home/biosproject/.ssh/authorized_keys
sudo chmod g+w /home/biosproject/.ssh/authorized_keys 
```

...虽然我忘记了 if`ssh`抱怨 if`authorized_keys`设置为`g+w`.

**更新**

在我看来，`www-data`还需要`+x`访问所有父目录`/home/biosproject/.ssh/authorized_keys`才能更改它，尽管我很确定如果您以这种方式更改目录权限`ssh`会抱怨。`.ssh`

您要么必须使用与`/home/biosproject/.ssh`目录所有者相同的 UID 运行 apache，要么使用[`setuid`](http://en.wikipedia.org/wiki/Setuid)脚本进行更改。

# html - HTML Content and watermarks

> ID：16043128
> 
> 赞同：-2
> 
> 时间：2013-04-16T17:15:27.840
> 
> 标签：html, css, image

Is it possible to watermark or otherwise secure HTML content so it can be printed but not photocopied after it's printed? For an application that prints passes, for example.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:19:04.880

This is way beyond HTML/CSS's capabilities. If you watermark an image then it will have to show up on the printed copy to be visible in a photocopied version, unless you are using a very sophisticated printer.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:19:39.757

No, that is simply not possible.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:10:07.087

您可以添加一个特殊的打印布局，它只是隐藏孔页：

```
<style type="text/css" media="print">
* {display:none;}
</style> 
```

或者尝试`html`不确定`*`旧 IE 版本是否支持星号。

# ios - CALayer - 将子图层放置在故事板 UIButtons 下方？

> ID：16043130
> 
> 赞同：29
> 
> 时间：2013-04-16T17:15:28.690
> 
> 标签：ios, uibutton, avfoundation, calayer, avcapturesession

我的情节提要中有一个带有几个 UIButton 的视图控制器。其中一个激活子层中显示的 AVFoundation 相机预览层：

```
captureVideoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:session];
captureVideoPreviewLayer.frame = self.view.bounds;
[self.view.layer addSublayer:captureVideoPreviewLayer]; 
```

这可以正常工作，除了预览层呈现在我的按钮之上，因此即使按钮仍然可点击，用户也无法看到它们。有没有一种简单的方法可以将子图层放置在按钮下方？或者一种简单的方法来提高图层中的按钮？非常感谢！

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-04-16T17:56:08.633

按钮层都是主视图层的子层。您需要将相机预览图层放在按钮图层的下方。尝试这个：

```
// put it behind all other subviews
[self.view.layer insertSublayer:captureVideoPreviewLayer atIndex:0];

// or, put it underneath your buttons, as long as you know which one is the lowest subview
[self.view.layer insertSublayer:captureVideoPreviewLayer below:lowestButtonView.layer]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-05T09:10:28.500

只是补充。*您可以通过调用UIView*方法***带来***任何 UIView 的子类。

```
[self.view bringSubviewToFront:self.desiredButton]; 
```

# javascript - What is the value of validating JSON?

> ID：16043131
> 
> 赞同：-4
> 
> 时间：2013-04-16T17:15:31.800
> 
> 标签：javascript, json, security, debugging, validation

Can we compile a list of reasons to validate JSON? There are a couple aspects I think we should consider:

1.  Security
2.  Debugging

Are there others?

Also, where should validation happen?

1.  Server
2.  Client
3.  Policy Enforcement Points? - does JSON validation make sense on an enterprise firewall? Why?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:22:47.863

JSON 只是 JavaScript 的一个子集，因此验证将有助于确保它只是那个子集，并且解析它的行为不会产生副作用。一般来说，我会在客户端验证错误是否可能是用户错误的结果（如电子邮件地址），并在服务器上验证可能导致黑客攻击的事情（如任何我确保向其他人呈现的字符串）在服务器上转义它）。我想我并没有太多担心 JavaScript 可能会通过 JSON 解析泄漏到系统的敏感部分，当我解析 JSON 时我没有评估 JavaScript 服务器端我只是将它视为字符串的集合和数字（如 C# 中的字典）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:17:27.240

> Can we compile a list of reasons to validate JSON?

*   Data validity.

> Also, where should validation happen?

*   Before data usage.

# javascript - Qunit Javascript 客户端日志记录

> ID：16043132
> 
> 赞同：0
> 
> 时间：2013-04-16T17:15:32.497
> 
> 标签：javascript, client-side, qunit, error-logging

我们有小型包装客户端日志框架来启用 javascript 客户端日志记录。我们在 Javascript 中公开了不同的功能，如 LogError、LogWarn、LogInfo。

```
 JavaScriptLogger.LogError(exception)            
       {
         postAjax(exception);
         WriteConsoleLog(exception)

   } 
```

当用户使用 JavaScriptLogger.LogError(exception) 记录错误时，会执行两件事： 1\. postAjax(exception) ：将 ajax 发布到指定的服务器 URL。2\. WriteConsoleLog(exception) : 根据用户传递的错误类型写入异常Console.Error/Console.Warn/Console.Log。

现在我想要一个使用 Qunit 框架的 LogError、LogWarn、LogInfo 函数的单元测试用例。

有人可以给我一个建议如何开始和如何去做。

问候， SCP

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T00:27:26.707

好吧，首先，我希望你明白有人可能会以这种方式淹没你的服务器日志，希望你有办法防止这种情况发生。

其次，您希望模拟该 Ajax 调用，以便您不依赖服务器来工作（消除一种潜在错误来源）。您可以为此使用[Mockjax 之](https://github.com/appendto/jquery-mockjax)类的东西。

之后，您可能希望在一次`asyncTest`调用中运行所有这些测试（而不是简单的`test`），因为 Ajax 调用仍然应该是异步的。 [http://api.qunitjs.com/asyncTest/](http://api.qunitjs.com/asyncTest/)

（PS对不起，如果我的格式不好，请在我的手机上输入。）

# node.js - 在没有 IO 操作的情况下，return 在 node.js 中是否可以正常工作？

> ID：16043134
> 
> 赞同：0
> 
> 时间：2013-04-16T17:15:34.943
> 
> 标签：node.js

例如，我的功能是这样的

```
function summ(a,b)
{
 return a+b;
}

module.exports.summ = summ; 
```

在其他文件中：

```
var obj = require('./that file')

function app()
{
 var s = obj.summ(7,7);
} 
```

如果我`console.log(s);` 说它给出了完美的答案。我怀疑这是否会在请求频繁出现时一直出现，因为我在休息 api 中使用这种返回？或者需要回调函数，结果是

```
function summ(a,b,callback)
{
 callback(a+b);
} 
```

和

```
function app()
{
 obj.summ(7,7,function(result){
 var s = result;
  }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:28:57.430

As long as your `summ` function behaves in a synchronous manner, like it does in your example code, you don't have to use callbacks.

If you would use asynchronous functions in `summ` (anything I/O related, like reading a file, querying a database, opening a network connection), that *would* require passing a callback function because you would have to wait until the action is completed before you return the result (by calling the callback function).

# mysql - 更好地使用“索引”或使用查询在相关数据库列之间创建连接？

> ID：16043135
> 
> 赞同：0
> 
> 时间：2013-04-16T17:15:40.207
> 
> 标签：mysql, database, indexing, multiple-columns, relational

我想知道在相关数据库列之间创建连接的最佳方法是什么 - 在查询中或使用`Index`？我知道使用的主要问题`Index`是性能速度，我认为这不是问题。

表中的每一列代表各种产品属性，并且许多列直接连接到其他一些列（通常为 2 - 3 列），其中一种方式是：

1.  相同属性的替代数据类型*（即颜色名称 + 显示的 hex#，或图像名称 + .png 文件名 + alt 值）*。这些列中的值表示相同的信息，但格式不同，因此值之间存在直接相关性，但值本身并不相同。

2.  用于对列中的值进行分类的子集。相同的值存在于多个列中（具有父/子或兄弟关系）。 *例如，“Colors All”列细分为 5 列，表示不同类型的颜色（即 Dark、Light、Bright 等），其中大部分组进一步细分为 3 个类别（按暗度等排序） .)。海军颜色分为 3 列 - “颜色全部”、“深色”和“宝石色调”。*

过去我只用来`Index`创建表之间的关系（使用外键），但似乎这可能使我不必每次都创建连接它们的语句。

目前我正在使用带有 PDO 提取语句的 mySql（但我可能会在接下来的 12 个月内切换数据库）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:37:21.353

我应该首先澄清查询和索引不是彼此的替代品。

创建表时，会定义列，其中一些列可以定义为 FOREIGN KEYS，与另一个表中的其他列相关。表之间的关系仅用于参照完整性目的（如果引擎支持）。它对于文档目的也很有用，一些查询设计者使用它们来猜测查询中的连接。

索引（或索引）用于不同的目的。他们告诉数据库创建一个额外的数据结构，服务器可以根据索引列的值加速行的检索。

因此，外键定义表之间的关系，查询连接相关表，索引加速查询中的连接、过滤、分组和排序操作。

编辑：表格用于表示一种实体。因此，我们可以有一个具有两个属性的颜色表：colors(color_name, color_value)。Color_value 可以是十六进制字符串或整数表示。原则上，我们不会有格式为 rgb(x,y,z) 的颜色代码列，因为这总是可以从第一个开始计算的。

我们将有另一个表来保存图像列表。但是，颜色表和图像表之间没有关系。

编辑 2：第二种类型通常用两个表格表示。第一个表存储典型的层次关系，第二个表告诉每个颜色标记的类。因此，您提供的示例的关系模型将是：

```
colors(colorid, color_name, color_value)
color_classes(classid, classname, parentid)
colors_classes(colorid, classid)

e.g.,
(colorid, color_name, color_value) - colors
(1,       'Navy',     'xxx')

(classid, classname,    parentid) - color_classes
(1,      'All colors',    0)
(2,      'Dark colors',   1)
(3,      'Light colors',  1)
(4,      'Jewel Tones',   2) -- assuming Jewel Tones is a subdivision of Dark Colors

(colorid, classid) - colors_classes
(1,       4)       -- assuming Jewel Tones is a subdivision of Dark Colors 
```

您还应该知道，递归关系（如在 color_classes 中）在关系模型中没有得到很好的处理，但它们仍然很常见，并且有解决方案来处理它。

最后，我不确定关系模型是否确实最适合您的问题。这将取决于您想要对数据进行的用途。

# asp.net-mvc-4 - 代码优先迁移更新数据库丢失数据？

> ID：16043136
> 
> 赞同：1
> 
> 时间：2013-04-16T17:15:40.737
> 
> 标签：asp.net-mvc-4, entity-framework-migrations

如何在不丢失数据的情况下更新数据库`Code First`？我正在开发一个新项目，并且已经对代码中的数据库进行了一些更改。然后它就打动了我，`migrations`似乎总是丢弃并重新创建您更改的任何内容。

这是我在使用该应用程序时不希望发生的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:19:11.030

I use Script option, to generate scrpit. i change it to alter table when it tries to drop it:

```
Update-Database -Script -ProjectName Proj -StartupProjectName Proj 
```

# objective-c - 如何在 NSString 中获取单词的 X 坐标

> ID：16043137
> 
> 赞同：0
> 
> 时间：2013-04-16T17:15:59.540
> 
> 标签：objective-c, nsstring, cgfloat

我有一个标签，里面有一个句子，那是一个字符串。我需要获取字符串中特定单词的 x 坐标。因此，例如，如果我在句子中有一个说“狗跑了”的句子，我需要能够找到 x 和 y 坐标，以及在其上放置 UITextField 的宽度和高度。到目前为止，这是我的代码：

```
- (void)insertTextFields:(NSString *)string inLabel:(UILabel *)label
{
    CGFloat stringWidth = [self getWidthOfString:string inLabel:label];
    CGFloat stringHeight = label.bounds.size.height;
    CGFloat stringYOrigin = label.bounds.origin.y;
    CGFloat stringXOrigin = [self getXOriginOfString:string fromString:label.text inLabel:label];
    CGRect textFieldRect = CGRectMake(stringXOrigin, stringYOrigin, stringWidth, stringHeight);
    UITextField *textField = [[UITextField alloc] initWithFrame:textFieldRect];
    [label addSubview:textField];
}

- (CGFloat)getWidthOfString:(NSString *)string inLabel:(UITextField *)label
{
    CGFloat maxWidth = CGRectGetMaxX(label.frame);
    CGSize stringSize = [string sizeWithFont:label.font forWidth:maxWidth lineBreakMode:NSLineBreakByCharWrapping];
    CGFloat width = stringSize.width;
    return width;
}

- (CGFloat)getXOriginOfString:(NSString *)string fromString:(NSString *)sentenceString inLabel:(UILabel *)label
{
    CGFloat maxWidth = CGRectGetMaxX(label.frame);
    CGSize sentenceStringSize = [sentenceString sizeWithFont:label.font forWidth:maxWidth lineBreakMode:NSLineBreakByWordWrapping];
    CGSize stringSize = [string sizeWithFont:label.font forWidth:maxWidth lineBreakMode:NSLineBreakByWordWrapping];
    //I have the width of both the individual word and the sentence
    //now I need to find the X coordinate for the individual word inside of the sentence string
    return xOrigin;
} 
```

有人能告诉我我需要做什么来解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:26:12.743

Is that the x position of the start of the word? Just measure the string that precedes the word....

```
- (CGFloat)getXOriginOfString:(NSString *)string fromString:(NSString *)sentenceString inLabel:(UILabel *)label {

    CGFloat maxWidth = CGRectGetMaxX(label.frame);
    NSRange range = [sentenceString rangeOfString:string];
    NSString *prefix = [sentenceString substringToIndex:range.location];

    return [prefix sizeWithFont:label.font
                       forWidth:maxWidth
                  lineBreakMode:NSLineBreakByWordWrapping].width;
} 
```

The end of the word will be this result + the `stringSize` in the code you posted. Or maybe I'm misunderstanding the question?

# android - ProgressDialog：更改文本大小

> ID：16043140
> 
> 赞同：9
> 
> 时间：2013-04-16T17:16:16.837
> 
> 标签：android

我从 java 代码创建了一个 ProgressDialog：

```
mProgressDialog = ProgressDialog.show(this, ..., ... , true); 
```

我想更改消息文本的大小及其颜色，我该怎么做？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-16T19:38:55.817

您可以使用可跨字符串并设置可跨字符串的颜色和大小。使用可扩展字符串设置文本颜色和大小。

**注意**：确保字体大小不会太大而无法适应屏幕

activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:layout_marginBottom="35dp"
    android:layout_marginLeft="56dp"
    android:text="Button" />

</RelativeLayout> 
```

主要活动

```
 public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    Button b= (Button) findViewById(R.id.button1);
    b.setOnClickListener(new OnClickListener()
    {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            String s= "Hello";
            String title="MyTitle";
            SpannableString ss1=  new SpannableString(title);
            ss1.setSpan(new RelativeSizeSpan(2f), 0, ss1.length(), 0);  
            ss1.setSpan(new ForegroundColorSpan(Color.RED), 0, ss1.length(), 0); 
            SpannableString ss2=  new SpannableString(s);
            ss2.setSpan(new RelativeSizeSpan(2f), 0, ss2.length(), 0);  
            ss2.setSpan(new ForegroundColorSpan(Color.GREEN), 0, ss2.length(), 0); 
            ProgressDialog pd = new ProgressDialog(MainActivity.this);
            pd.setTitle(ss1);
            pd.setMessage(ss2);
            pd.show();
        }

    });

}
   } 
```

![在此处输入图像描述](https://i.stack.imgur.com/B1y7j.png)

**或者**

您可以使用自定义样式更改文本的颜色

样式.xml

```
 <style name="NewDialog" parent="@android:style/Theme.Dialog">

<item name="android:windowFrame">@null</item>
<item name="android:windowBackground">@android:color/transparent</item>
<item name="android:windowIsFloating">true</item>
<item name="android:windowContentOverlay">@null</item>
<item name="android:windowTitleStyle">@null</item>
<item name="android:colorBackground">#ffffff</item>// change background color
<item name="android:windowAnimationStyle">@android:style/Animation.Dialog</item>
<item name="android:windowSoftInputMode">stateUnspecified|adjustPan</item>
<item name="android:backgroundDimEnabled">true</item>
<item name="android:width">600dip</item>
<item name="android:height">100dip</item>
 <item name="android:textColor">#0FECFF</item>// change color
</style> 
```

在你的活动中

```
 ProgressDialog pd = new ProgressDialog(this,R.style.NewDialog); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-03-24T15:26:58.400

您还可以使用：[ContextThemeWrapper](http://developer.android.com/reference/android/view/ContextThemeWrapper.html)

例如：

```
ProgressDialog.show(new ContextThemeWrapper(this, R.style.DialogCustom), "Loading", "Wait please");

<style name="DialogCustom">
    <item name="android:textSize">18sp</item>
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:34:53.587

试试这样

```
private void showProgressDialog() {

    progressDialog = new ProgressDialog(this,R.style.CustomDialog);
    progressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
    progressDialog.setMessage("Logging in. Please wait.");
    progressDialog.show();
} 
```

使用自定义布局

# java - 使用 toString() 方法打印一个对象

> ID：16043144
> 
> 赞同：0
> 
> 时间：2013-04-16T17:16:27.553
> 
> 标签：java

你好，我有一个 rmiclient 和 RMIserver 并发送一系列对象 Product 我想用 toString 将它打印为一个列表把它显示给我 {Product2@sad45 我做不到代码是

```
public static void main(String[] args) {
         Scanner in = new Scanner(System.in);
                int pin=0;
                String tostring="";
        try {   

            String  name    =   "//Localhost/RMI_Server";
            Functions lp    =(Functions)Naming.lookup(name);
            try{
            System.out.println("Please give your Personal Code (PIN)");

                        pin=in.nextInt();
             }catch (Exception nfe) {
                    System.out.println("Input must be a number." + nfe);
                            }
            if(lp.validate(pin)){
            System.out.println("Give description of item");
            String desc=in.next();
                        Product [] p =lp.search(desc);
                        for(int i=0;i<p.length;i++){
                        tostring=(String)p[i];
            System.out.println(tostring);}
            System.out.println("Give numberCode of item you want to buy");
            String code=in.next();
            System.out.println(lp.purchase(code));
            }else{
            System.out.println("Your code is False");}
            lp.close();

        }catch (Exception   e)  {
             System.out.println("SumClient  err:    " + e); 
             System.exit(1);
         }  
            }   
        } 
```

Product 类的代码是

```
import java.io.Serializable;

public class Product implements Serializable {

    private String description;
    private String serialNum;
    private float price;
    private String company;

    public Product(String description,String serialNum,float price,String company){
    this.description=description;
    this.serialNum=serialNum;
    this.price=price;
    this.company=company;       
    }

    public void set_description(String description){this.description=description;}
    public String get_description(){return description;}
    public void set_serialNum(String serialNum){this.serialNum=serialNum;}
    public String get_serialNum(){return serialNum;}
    public void set_price(float price){this.price=price;}
    public float get_price(){return price;}
    public void set_company(String company){this.company=company;}
    public String get_company(){return company;}

    public String toSting(){
        String str="Item "+ this.serialNum +" is product from "+ this.company +" price " + this.price +"E Description: ( "+ this.description +" )";
        return str;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:17:33.223

您的`toString`方法中有错字：

```
public String toSting() 
```

`toSting`而不是`toString`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:22:32.580

除了更改`public String toSting()`为`public String toString()`您的代码中还有另一个问题。

像你在行中那样将你的投到`Product`a是错误的`String`

```
tostring=(String)p[i];
System.out.println(tostring); 
```

只需打印`Product`，它的`toString`方法就会自动为您调用。

```
System.out.println(p[i]) 
```

# javascript - 在其他 div 点击时动态更改 div 内容（AngularJS）

> ID：16043146
> 
> 赞同：10
> 
> 时间：2013-04-16T17:16:28.647
> 
> 标签：javascript, jquery, angularjs

所以，我是 AngularJS 的新手，我试图在单击另一个 div 内容后更改一个 div 内容（这个包含我想要放在第一个的内容的 div）。

HTML

```
<div ng-controller="dCtrl">
    <ul ng-repeat="product in products">
        <li change>
            {{product.name}}
            <div class="hide">{{product.description}}</div>
        </li>
    </ul>
</div>

<div id="test"></div> 
```

Javascript

```
var app = angular.module("dt", []);

app.directive("change", function() {

    return function(scope, element) {

        element.bind("click", function() {
           var message = element.children("div").text();
           console.log("breakpoint");

           angular.bind("#test", function() {
               this.text(message);
           });
        })
    }
})

app.controller("dCtrl", function($scope) {

$scope.products = [
    { "name" : "Escova XPTO", "description": "Lava tudo num instante"},
    { "name" : "Pasta de Dentes YMZ", "description": "Dentifrico do camandro"}
];

}) 
```

我知道我只能说：

```
$("#test").html(message); 
```

但我仍然对混合 jQuery 和 AngularJS 感到困惑，我不知道这是否是正确的做法

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T20:34:18.103

**设置 ng-点击：**

[ngClick](http://docs.angularjs.org/api/ng.directive:ngClick)用于做一些事情，比如你在更改指令中进行的可怕的 jQuery 风格的事情。将 ng-click 放在可点击 div 的属性中，并传入一个方法来更改 $scope 变量接受的...

**[ngShow](http://docs.angularjs.org/api/ng.directive:ngShow)和[ngHide](http://docs.angularjs.org/api/ng.directive:ngHide)。**

当这些指令为真时，如名称所述，显示或隐藏关联的 html 对象。您可以传入 $scope 变量来确定布尔值。当 $scope 更新时，这些方法会自动更新 DOM 以显示/隐藏元素。

# html - iframe height not changing when the source height changes dynamically

> ID：16043147
> 
> 赞同：0
> 
> 时间：2013-04-16T17:16:31.537
> 
> 标签：html, iframe, dynamic, include

I have html pages A and B. I am including html B page in html A using iframe.

Means iframe source point to "page B".

Issue is, if the page B changes dynamically - iframe height is not changing. How can I control this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:53:11.170

iframe 是 Page A 的一部分，因此它的大小由 Page A 的 DOM 控制。如果您希望页面 B（iframe 内容）影响页面 A 上 iframe 的大小，则可以使用一些 Javascript 来实现，前提是页面 A 和页面 B 位于同一域中。

适用于页面 B 的 javascript：

```
var iframe = window.parent.getElementById("iframe-id"); // Get the iframe from the parent window
iframe.style.width = newwidth; // set its width (should be a string "##px")
iframe.style.height = newheight; // set its height (should be a string "##px") 
```

从页面 B 上动态更改元素大小的任何内容中检索到的位置和`newwidth`位置。`newheight`

# c++ - 在 MP3 中转换 Wav

> ID：16043149
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:16:40.130
> 
> 标签：c++, qt, qt5

如何使用 QtMultimedia 在 MP3 中转换 WAV？

有一些特定的类用于读取 WAV 和写入 MP3 文件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:30:25.240

As far as I know there is no MP3 encoder packaged with Qt. You'll have to use an external library.

**Edit:** this is confirmed by [this thread](https://qt-project.org/forums/viewthread/13445) at least as far as Qt4 is concerned (no idea about Qt5 though but I suspect it's the same).

# c - 二级二叉树插入分段错误

> ID：16043150
> 
> 赞同：1
> 
> 时间：2013-04-16T17:16:43.783
> 
> 标签：c, macos, unix

在检查 bst 中的节点是否为空后，当我尝试将值分配给 bst 的成员时出现分段错误

```
#include <stdio.h>
#include <stdlib.h>

typedef int Data_Item;

struct Bst2_Node
{
  int key;
  Data_Item data;
  struct Bst2_Node *left, *right;
};
typedef struct Bst2_Node BStree2_node;
typedef BStree2_node** BStree2;

BStree2 bs_tree2_ini(void)
{
  BStree2 bst;
  bst =(BStree2)malloc(sizeof(BStree2_node *));
  *bst=NULL;
  return bst;
}

void bs_tree2_insert(BStree2 bst, int key, Data_Item data)
{
  if(*bst==NULL)
{
    (*bst)->key = key;
    (*bst)->data = data;
}

  else if(key < (*bst)->key)
{
    bs_tree2_insert(&(*bst)->left, key, data);
}
  else if(key > (*bst)->key)
{
    bs_tree2_insert(&(*bst)->right, key, data);
}
  else return;
}

Data_Item *bs_tree2_search(BStree2 bst, int key)
{
    if(key==(*bst)->key)
{
    return &(*bst)->data;
}
    else return NULL;
}

void bs_tree2_traversal(BStree2 bst)
{
    if(!*bst) return;

    bs_tree2_traversal(&(*bst)->left);
    printf("%d\n", (*bst)->data);
    bs_tree2_traversal(&(*bst)->right);
}

static void btree_free(BStree2_node *bt)
{
   if(bt == NULL) return;
   btree_free(bt->left);
   btree_free(bt->right);
   free(bt);
}

void bs_tree2_free(BStree2 bst)
{
   btree_free(*bst);
   free(bst);
}

int main(int argc, char** argv)
{
 int a;
 int b;
 a = 1;
 b = 2;
 BStree2 bst = bs_tree2_ini();
 printf(".");
 bs_tree2_insert(bst, a, b);
 //bs_tree2_traversal(bst);
 bs_tree2_free(bst);
 return (0);
} 
```

另外，当我将 a 指针初始化为空时，这是否意味着内容也为空？抱歉格式化

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:26:03.897

> when I initialize the a pointer to null, does that mean the contents are null as well?

No. When you initialize the a pointer to null, it sets it to point to zero. You can still access a null pointer and retrieve members from it ***but on most operating systems, this will cause a crash such as a segmentation fault***.

Your crash is because you allocate a pointer to a pointer, see `typedef BStree2_node** BStree2`; the double asterisk indicates it's a double pointer type (pointer to a pointer).

Then you initialize the contents to NULL (so, you have a valid pointer to NULL) in `bs_tree2_ini()`. Then you dereference the second pointer in `bs2_tree2_insert()`.

If (*bst) is NULL, you should not set any of its members. It is not a valid pointer. You need to allocate a structure first. For example,

```
if ((*bst)==NULL)
{
    (*bst) = (BStree2_node*)malloc(sizeof(BStree2_node));
    if ((*bst) == NULL)
    {
        // allocation failed.
    }
    else
    {
        // allocation success. set data members here.
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:38:06.677

我不确定*为什么*这些天教师们对哨兵节点感到高兴，但它们不是必需的。该值`NULL`与其他任何值一样好。考虑这样的实现，我**强烈**建议您花大量时间盯着、研究，如果可能的话，使用调试器单步执行：

```
#include <stdio.h>
#include <stdlib.h>
#include <time.h>

typedef int Data_Item;
typedef struct BST_Node
{
    int key;
    Data_Item data;
    struct BST_Node *left, *right;
} BST_Node;

typedef enum
{
    BST_TRAVERSE_PREORDER,
    BST_TRAVERSE_INORDER,
    BST_TRAVERSE_POSTORDER
} BST_TRAVERSE_TYPE;

// allocate a new BST node and copy in the passed data
BST_Node *BST_newnode(int key, Data_Item data)
{
    BST_Node *p = malloc(sizeof(*p));
    p->left = p->right = NULL;
    p->key = key;
    p->data = data;
    return p;
}

// insert. recurses until we reach a null node, then performs
//  the insertion at that node pointer. initial invoke is done
//  using the address of the root of our tree.
//
// note: this implementation does NOT allow duplicates
void BST_insert(struct BST_Node** p, int key, Data_Item data)
{
    if (*p == NULL)
    {
        *p = BST_newnode(key, data);
    }
    else if (key < (*p)->key)
    {
        BST_insert(&(*p)->left, key, data);
    }

    else if ((*p)->key < key)
    {
        BST_insert(&(*p)->right, key, data);
    }
}

// traverses based on traversal selection type
void BST_traverse(BST_Node* p, BST_TRAVERSE_TYPE tt,
                  void (*pfn)(int, Data_Item* data))
{
    if (!p)
        return;

    switch (tt)
    {
        case BST_TRAVERSE_PREORDER:
            pfn(p->key, &p->data);
            BST_traverse(p->left, tt, pfn);
            BST_traverse(p->right,tt, pfn);
            break;

        case BST_TRAVERSE_INORDER:
            BST_traverse(p->left, tt, pfn);
            pfn(p->key, &p->data);
            BST_traverse(p->right,tt, pfn);
            break;

        case BST_TRAVERSE_POSTORDER:
            BST_traverse(p->left, tt, pfn);
            BST_traverse(p->right,tt, pfn);
            pfn(p->key, &p->data);
            break;
    }
}

// deletes a node AND all its children
void BST_delete_all(BST_Node** p)
{
    // do nothing on a null pointer
    if (!*p)
        return;

    BST_delete_all(&(*p)->left);
    BST_delete_all(&(*p)->right);
    free(*p);
    *p = NULL;
}

// my print function
void print_data(int key, Data_Item* pData)
{
    printf("Key %.2d ==> %d\n", key, *pData);
}

int main(int argc, char *argv[])
{
    srand((unsigned)time(0));
    BST_Node* root = NULL;
    for (int i=0;i<16;++i)
        BST_insert(&root, rand()%50, i);

    printf("Preorder Traversal\n");
    printf("=================\n");
    BST_traverse(root, BST_TRAVERSE_PREORDER, &print_data);

    printf("\nInorder Traversal\n");
    printf("=================\n");
    BST_traverse(root, BST_TRAVERSE_INORDER, &print_data);

    printf("\nPostorder Traversal\n");
    printf("=================\n");
    BST_traverse(root, BST_TRAVERSE_POSTORDER, &print_data);

    // delete the tree
    BST_delete_all(&root);

    return EXIT_SUCCESS;
}; 
```

**样本输出**

```
Preorder Traversal
=================
Key 30 ==> 0
Key 07 ==> 2
Key 05 ==> 4
Key 04 ==> 5
Key 03 ==> 8
Key 24 ==> 3
Key 17 ==> 7
Key 10 ==> 14
Key 16 ==> 15
Key 19 ==> 9
Key 29 ==> 12
Key 43 ==> 1
Key 40 ==> 10
Key 39 ==> 11

Inorder Traversal
=================
Key 03 ==> 8
Key 04 ==> 5
Key 05 ==> 4
Key 07 ==> 2
Key 10 ==> 14
Key 16 ==> 15
Key 17 ==> 7
Key 19 ==> 9
Key 24 ==> 3
Key 29 ==> 12
Key 30 ==> 0
Key 39 ==> 11
Key 40 ==> 10
Key 43 ==> 1

Postorder Traversal
=================
Key 03 ==> 8
Key 04 ==> 5
Key 05 ==> 4
Key 16 ==> 15
Key 10 ==> 14
Key 19 ==> 9
Key 17 ==> 7
Key 29 ==> 12
Key 24 ==> 3
Key 07 ==> 2
Key 39 ==> 11
Key 40 ==> 10
Key 43 ==> 1
Key 30 ==> 0 
```

# javascript - Jquery.js 从 Bootstrap 停用可选项卡导航

> ID：16043153
> 
> 赞同：0
> 
> 时间：2013-04-16T17:16:51.230
> 
> 标签：javascript, jquery, twitter-bootstrap, conflict

我在一个网站上工作，我遇到了 Twitter BootStrap 的问题。

我有标签导航来浏览不同的视图，并且在每个视图中我都有一个轮播。为了使旋转木马工作，我必须从 Twitter 添加 Jquery.js 文件。但是自从我添加它之后，可标签导航不再起作用。我的意思是当我的指针在选项卡上时有一个结束，但是当我点击它时，什么也没有发生。

我不知道 jquery.js 和 Twitter BootStrap 中的 tabbable navs 之间是否存在冲突，或者我是否做错了什么。所以这里是我的代码：

```
 <head>
    <!-- JS Files -->
            <script src="bootstrap/js/jquery.js"></script>
            <script src="bootstrap/js/bootstrap.js"></script>
            <script type="text/javascript">
                $(document).ready(function () {
                    $('.carousel').carousel({
                        interval: 3000
                    });

                $('.carousel').carousel('cycle');
                });
            </script>
    </head>
    <body>

                    <div class="navbar">
    <div class="navbar-inner">
        <div class="container">
            <ul class="nav">
                    <li><a href="index.php">Accueil</a></li>

                    <li><a href="index.php?page=concept">Concept</a></li>

                    <li class="active"><a href="index.php?page=collections">Collections</a></li>

                    <li><a href="index.php?page=contact">Contact</a></li>
             </ul>
        </div>
    </div>
</div>

            <ul class="breadcrumb">
                    <li><a href="index.php">Accueil</a> <span class="divider">/</span></li>
                    <li><a href="index.php?page=collections">Collections</a> <span class="divider">/</span></li>
                    <li class="active">SummerSpring - Business Line</li>
            </ul>

        <div  class="tabbable tabs-left">
            <ul class="nav nav-tabs">
                    <li class="active"><a href="index.php?page=collections/summerspring" data-toggle="tab">Business Line</a></li>
                    <li><a href="index.php?page=collections/summerspring/ligneessentielle" data-toggle="tab">Ligne Essentielle</a></li>
                    <li><a href="index.php?page=collections/summerspring/blueline" data-toggle="tab">Blue Line</a></li>
                    <li><a href="index.php?page=collections/summerspring/blacklabel" data-toggle="tab">Black Label</a></li>
                    <li><a href="index.php?page=collections/summerspring/slimfit" data-toggle="tab">Slim Fit</a></li>
                    <li><a href="index.php?page=collections/summerspring/greybygrey" data-toggle="tab">Grey By Grey</a></li>
            </ul>

        <div class="tab-content">
        <div class="tab-pane active">

        <div class="row-fluid">

            <div class="span2">
            </div>

            <div class="span8">
                <br>

            <div id="myCarousel" class="carousel slide">
                <ol class="carousel-indicators">
                  <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#myCarousel" data-slide-to="1"></li>
                  <li data-target="#myCarousel" data-slide-to="2"></li>
                </ol>
                    <div class="carousel-inner">
                        <div class="item active">
                            <img src="images/showroomspirit.jpg" alt="">
                                <div class="carousel-caption">
                                  <h4>First Thumbnail label</h4>
                                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                                </div>
                        </div>
                        <div class="item">
                            <img src="images/showroomspirit.jpg" alt="">
                                <div class="carousel-caption">
                                  <h4>Second Thumbnail label</h4>
                                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                                </div>
                        </div>
                        <div class="item">
                            <img src="images/showroomspirit.jpg" alt="">
                                <div class="carousel-caption">
                                  <h4>Third Thumbnail label</h4>
                                    <p>Cras justo odio, dapibus ac facilisis in, egestas eget quam. Donec id elit non mi porta gravida at eget metus. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
                                </div>
                        </div>
                    </div>
                                <a class="left carousel-control" href="#myCarousel" data-slide="prev">&lsaquo;</a>
                                <a class="right carousel-control" href="#myCarousel" data-slide="next">&rsaquo;</a>
            </div>

            </div>

            <div class="span2">
            </div>

        </div>
    </body> 
```

你知道它会是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:31:34.213

由于使用`preventDefault()`了引导选项卡，锚元素的默认行为没有被执行。

您也许可以删除元素`data-toggle="tab"`上的属性`.nav-tabs a`，它会正常工作。

如果这不起作用，您需要让它们再次充当链接；这可以通过使用以下代码来完成：

```
$('.nav-tabs a')
    .filter('[href]').click(function(){
        window.location.href = $(this).attr('href');
    }); 
```

# java - reg ex 表达式，只需要用逗号分隔

> ID：16043156
> 
> 赞同：0
> 
> 时间：2013-04-16T17:16:52.870
> 
> 标签：java, regex, groovy

测试代码在这里。我想增加我当前的正则表达式以逗号分隔

```
String test = "This Is ,A Test"
println(test)
String noSpace = test.replaceAll("\\s","")
println(noSpace)
String[] words = noSpace.split("[^a-zA-Z0-9'-.]+")

words.each {
   println(it)
} 
```

这会产生输出

```
This Is ,A Test
ThisIs,ATest
ThisIs,ATest 
```

我希望它在哪里产生输出

```
This Is ,A Test
ThisIs,ATest
ThisIs
ATest 
```

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:53:52.507

引用自 javadoc

> 请注意，字符类内部的元字符集与字符类外部的元字符集不同。例如，正则表达式。在字符类中失去其特殊含义，而表达式 - 成为形成范围的元字符。

所以你需要逃避破折号：

```
String[] words = noSpace.split("[^a-zA-Z0-9'\\-.]+"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:18:57.440

To split based on comma, simply use

```
String[] words = noSpace.split(","); 
```

# opengl-es - How Cocos2d and other 2d OpenGL Engines draw sprites?

> ID：16043157
> 
> 赞同：1
> 
> 时间：2013-04-16T17:16:56.650
> 
> 标签：opengl-es, cocos2d-iphone, opengl-es-2.0, theory

Just for learning purpose I want to build a really simple 2D openGL Engine, so I'm really curious to understand how the most famous Engines work (or at least which is your idea).

I know that using a SpriteBatches the engine performs a single drawing call per SpriteBatch while drawing simple sprites every sprite needs a drawing call. Let's say that I'm only interested in drawing separated sprites without a SpriteBatch.

**Here is my idea for simple Sprites drawing:** I suppose they are represented through a plane and a texture. Every plane has a set of vertices and indices and a common shader (let's keep it simple). The sprites are stored in a sort of array and **for each sprites** the engine needs to set a `VBO` with the vertices of the current plane and call `glBindBuffer`, `glBufferData`, set the shaders and call `glDrawElements`. The VBO is then cleared and the previous operations are repeated for the next sprite.

**Could it be a common routine to draw sprites?**

**About the SpriteBatch** I suppose that the big difference is that the VBO stores the vertices of every plane once and for this reason it is able to draw all the sprites in a single `glDrawElements` call.

**Am I on the right way or my "suppositions" are totally wrong?**

# iphone - 在 iPhone 上更改国家/地区以进行本地化测试

> ID：16043160
> 
> 赞同：0
> 
> 时间：2013-04-16T17:17:05.317
> 
> 标签：iphone, ios, localization

我可以在“设置”->“通用”->“国际”中更改语言，但如何在物理 iPhone 上更改**国家**/地区，以便测试本地化是否正常工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:30:03.160

这是通过设置->常规->国际->区域格式设置完成的。

区域格式决定了区域设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T22:46:20.857

如果您正在测试网络应用程序，您可以使用另一个国家的代理服务器。不过，您必须在这样做时使用 Wifi。

# android - 意图始终为空 onStartCommand

> ID：16043173
> 
> 赞同：5
> 
> 时间：2013-04-16T17:18:06.777
> 
> 标签：android, android-intent, service, android-activity

我有以下代码

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    if(intent != null) {
        Log.i("INTENT", intent.getAction().toString());
    }
    return START_STICKY;
} 
```

但它总是`NullPointerException`在线返回：

```
Log.i("INTENT", intent.getAction().toString()); 
```

为什么？如果“intent”变量不为空，我正在检查上面。如果是这种情况，请执行以下代码。但我仍然得到空指针异常。

服务是从这样的活动开始的：

```
startService(new Intent(this, MainService.class)); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-16T17:22:04.137

你得到一个`NullPointerException`因为`intent.getAction()`似乎返回`null`。

你应该把你的检查扩展到这个：

```
if(intent != null && intent.getAction() != null) { 
```

如果你想向你的意图添加一个动作，你需要调用[setAction()](http://developer.android.com/reference/android/content/Intent.html#setAction%28java.lang.String%29)：

```
Intent i = new Intent(this, MainService.class);
i.setAction("foo");
startService(i); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-31T02:10:03.130

我得到了类似的堆栈，添加检查

```
intent.getAction() != null 
```

有效。

```
E/AndroidRuntime: FATAL EXCEPTION: main
              Process: com.example.languoguang.welcomeapp, PID: 17676
              java.lang.RuntimeException: Unable to start service com.example.languoguang.welcomeapp.CountService@f6049d4 with Intent { cmp=com.example.languoguang.welcomeapp/.CountService }: java.lang.NullPointerException: Attempt to invoke virtual method 'java.lang.String java.lang.String.toString()' on a null object reference
                  at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3698)
                  at android.app.ActivityThread.access$1500(ActivityThread.java:198)
                  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1668)
                  at android.os.Handler.dispatchMessage(Handler.java:106)
                  at android.os.Looper.loop(Looper.java:164)
                  at android.app.ActivityThread.main(ActivityThread.java:6649)
                  at java.lang.reflect.Method.invoke(Native Method)
                  at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493)
                  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:826)
               Caused by: java.lang.NullPointerException: Attempt to invoke virtual method 'java.lang.String java.lang.String.toString()' on a null object reference
                  at com.example.languoguang.welcomeapp.CountService.onStartCommand(CountService.java:24)
                  at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:3679)
                  at android.app.ActivityThread.access$1500(ActivityThread.java:198) 
                  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1668) 
                  at android.os.Handler.dispatchMessage(Handler.java:106) 
                  at android.os.Looper.loop(Looper.java:164) 
                  at android.app.ActivityThread.main(ActivityThread.java:6649) 
                  at java.lang.reflect.Method.invoke(Native Method) 
                  at com.android.internal.os.RuntimeInit$MethodAndArgsCaller.run(RuntimeInit.java:493) 
                  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:826) 
```

I/Process：发送信号。PID：17676 SIG：9

# php - Adding Parameters to URLs - AddThis

> ID：16043174
> 
> 赞同：0
> 
> 时间：2013-04-16T17:18:07.220
> 
> 标签：php, javascript, addthis

When I like the page from my site, the link is from index...I need that this link be the link of the correct page...I'm trying to take the url address( have the index of my site..then I click in a image..and open another link with infos from my photo. There has a like button and when I click , this like the link of the first page of my site , don't the current page) I'm trying to follow this tutorial: [http://support.addthis.com/customer/portal/articles/381249-adding-parameters-to-urls#.UW1-Kit8KPV](http://support.addthis.com/customer/portal/articles/381249-adding-parameters-to-urls#.UW1-Kit8KPV)

here is the code that I have tried:

```
 <style type="text/css">
    .float-all {
        float: left;
        width: 82px;
        height: 30px;
        overflow: hidden;
        margin: 2px;
        padding: 4px 2px;
    }
    .post-btn-share {
        width: 100%;
        overflow: auto;
    }

</style>

<!-- AddThis Button BEGIN -->
<div class="post-btn-share">
    <div class="addthis_toolbox addthis_default_style">
        <div class="float-all">
            <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
        </div>
        <div class="float-all">
            <a class="addthis_button_tweet"></a>
        </div>
        <div class="float-all">
            <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
        </div>
    </div>
</div>

<script type="text/javascript">
var addthis_share = {
url_transforms : {
add: {
img: '<?php echo $_GET['img']; ?>',
user: '<?php echo $_GET['user']; ?>'
  }
 }
}
</script>
<script type="text/javascript">var addthis_config = {"data_track_addressbar":true};</script>
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-51473a5c09315ac4"></script>

<!-- AddThis Button END --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T20:59:33.540

通过 AddThis 支持站点，我发现这篇关于 URL 和标题的文章：http: [//support.addthis.com/customer/portal/articles/381242-url-title#.UW26obVg8y4](http://support.addthis.com/customer/portal/articles/381242-url-title#.UW26obVg8y4)。

> 注意：某些服务，尤其是 Facebook 和 LinkedIn，不使用我们发送给它们的参数。相反，他们使用元标记来确定要共享的 URL、标题和描述。有关更多信息，请参阅此博客文章。[有关详细信息，请参阅此博客文章](http://www.addthis.com/blog/2012/09/27/debugging-sharing-to-facebook/#comments)。

# java - 使用 ArrayLists 创建 HashMap

> ID：16043177
> 
> 赞同：0
> 
> 时间：2013-04-16T17:18:17.487
> 
> 标签：java

我正在制作一个项目经理程序（一个非常简单的程序）。基本上有同事和他们的任务。现在，我制作了以下结构：我使用`HashMap`键作为 CoWorkers 的名称，值始终是`ArryList`包含他或她的工作的 CoWorkers。

我的问题是我可以创建这个结构，但是当我尝试添加一个任务时，我总是得到一个 ArrayLists`null`作为返回值。

这是我的代码片段：

```
HashMap<String, ArrayList<String>> jobs = new HashMap<String, ArrayList<String>>();

public void createJobs(){
    nameReader();
    for(String name:names){
        File f = new File(name+"_job.txt");
        if(f.exists()){
            jobs.put(name, jobReader(name));
        }
    }
    Set set = jobs.entrySet(); 
    Iterator i = set.iterator(); 
    while(i.hasNext()) { 
        Map.Entry me = (Map.Entry)i.next(); 
        System.out.print(me.getKey() + ": "); 
        System.out.println(me.getValue()); 
    } 
} 
```

在控制台上使用此方法后，我看到以下结果：

> 乔治：[洗衣服]

所以我认为我做的一切都很好。

但是之后：

```
public void addJob(String name, String job){
    try{
        List<String> itemsList = jobs.get(name);
    itemsList.add(job);
    }catch(Exception ex){
         System.err.println(ex.getMessage() + jobs.get(name) +name);
    }
} 
```

我正在调用这个方法：

```
addjob("George","Clean up your room!"); 
```

控制台上的结果将是：

> nullnull乔治

**更新**

```
public ArrayList jobReader(String name){
    ArrayList<String> tasks = new ArrayList<String>();
    try{
        Scanner s = new Scanner(new File(name+"_job.txt"));
        while (s.hasNext()){
            tasks.add(s.next());
        }
        s.close();
    }catch(IOException ioe){
        System.err.println("IOException: " + ioe.getMessage());
    }
    return tasks;
} 
```

**更新 2**

这是我的漏洞代码：

```
public class CoWorkers {
    HashMap<String, ArrayList<String>> jobs = new HashMap<String, ArrayList<String>>();
    ArrayList<String> names = new ArrayList<String>();

    public void createJobs(){
        nameReader();
        for(String name:names){
            File f = new File(name+"_job.txt");
            if(f.exists()){
                jobs.put(name, jobReader(name));
            }
        }
        Set set = jobs.entrySet(); 
        Iterator i = set.iterator(); 
        while(i.hasNext()) { 
            Map.Entry me = (Map.Entry)i.next(); 
            System.out.print(me.getKey() + ": "); 
            System.out.println(me.getValue()); 
        } 
    }

    public void addName(String name){
        try{
            String filename= "Names.txt";
            FileWriter fw = new FileWriter(filename,true); 
            fw.write(name+"\n");
            fw.close();
        }
        catch(IOException ioe){
            System.err.println("IOException: " + ioe.getMessage());
        }
    }

    public void addJob(String name, String job){
        DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
        Date date = new Date();
        try{
            List<String> itemsList = jobs.get(name);
            itemsList.add(job);
        }catch(Exception ex){
             ex.printStackTrace();
        }
    }

    public ArrayList jobReader(String name){
        ArrayList<String> tasks = new ArrayList<String>();
        try{
            Scanner s = new Scanner(new File(name+"_job.txt"));
            while (s.hasNext()){
                tasks.add(s.next());
            }
            s.close();
        }catch(IOException ioe){
            System.err.println("IOException: " + ioe.getMessage());
        }
        return tasks;
    }

    public void nameReader(){
        names.clear();
        try{
            Scanner s = new Scanner(new File("Names.txt"));
            while (s.hasNext()){
                names.add(s.next());
            }
            s.close();
        }catch(IOException ioe){
            System.err.println("IOException: " + ioe.getMessage());
        }
    }
    public static void main(String[] args) {
        CoWorkers project = new CoWorkers();
        project.createJobs();
        project.addJob("George","Do the laundry");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:39:48.427

查看代码 ex.getMessage() + jobs.get(name) +name ，你必须得到空指针异常，因为你的控制台打印 nullnullGeorge 这意味着 List itemsList = jobs.get(name);//这是空的，因此是列表。将 null 添加到 List 会给你空指针异常。这意味着在 Map 中添加 George 时，没有发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:48:35.360

所以我创建了自己的小测试类，并证明你的代码有效。

我不认为你在这里向我们展示了一切。

我认为在某处您对变量“工作”有两个定义，一个是隐藏另一个。

- - - 更新 - - -

好的，所以我用硬编码的名称和作业运行你的代码，它工作得很好。我的建议：尝试做同样的事情。

```
 String names[] = {"George", "Bill"};
        for(String name:names){          
             jobs.put(name, jobReader(name));              
        }

       public ArrayList jobReader(String name){
        ArrayList<String> tasks = new ArrayList<String>();
                tasks.add("Tidy");
            return tasks;
    } 
```

我怀疑您从文件中读取的内容与“George”不匹配，尽管我们尚不知道原因。一旦我们对列表处理有信心，我们就可以考虑数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:50:40.060

通常，如果您要操作该值，最好先检查您的地图是否包含键。例如：

```
public void addJob(String name, String job){

    if (!jobs.containsKey(name)) {
        jobs.put(name, new ArrayList<String>());
    }
    List<String> itemsList = jobs.get(name);
    itemsList.add(job);
} 
```

您遇到的另一个问题是，当您找不到包含某人工作的文件时，您会默默地失败。考虑将其添加到`createJobs()`

```
 for(String name:names){
        File f = new File(name+"_job.txt");
        if(f.exists()){
            jobs.put(name, jobReader(name));
        } else { // This is new
            jobs.put(name, new ArrayList<String>());
        }
    } 
```

# java - Is there a way to disable all buttons with a method?

> ID：16043180
> 
> 赞同：1
> 
> 时间：2013-04-16T17:18:23.067
> 
> 标签：java, swing

This is a lab for school that I'm struggling with, the code is making a game of hangman, and when the "brain" program says the game is over, all of the letter buttons are supposed to be disabled.

relevant code sections:

the buttons:

```
class ActionButton extends JButton implements ActionListener{
    private String name;
    private char t;
    public ActionButton(String s){
        super(s);
        name = s;
        t = name.charAt(0);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        ido.newLetter(t);
        this.setEnabled(false);
        LovesMePanel.this.update();
    }

} 
```

the update method:

```
public void update(){
    answers = ido.getAnswer();
    flower.setTriesLeft(ido.getTriesLeft());
    progress.setText(answers);      
    if(ido.gameOver()){
// This is where I need to deactivate the buttons       
        if(ido.hasWon()){

        }
    }
    else if(triesLeft == 0){

    }

} 
```

the buttons are all created in a loop in the LoveMePanel that holds all of the other panels. Is there a way to reference them all or disable them all when the game is over? If not, how should I change my code so that it would be possible to do that?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:23:04.503

如果将按钮放在 a`Collection`中，则可以遍历它们并一直禁用它们。IE，

```
for (JButton b : myButtons) {
    b.setEnabled(false)
} 
```

如果没有，您有 26 个禁用语句要编写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:24:52.287

See the [setEnabled()](http://docs.oracle.com/javase/6/docs/api/java/awt/Component.html#setEnabled%28boolean%29) method for JButton. You can:

1.  Add your Buttons to an `ArrayList` while creating them and then iterate over it and disable one by one
2.  Get children of a JPanel, iterate over them, check if it's a button and disable it
3.  Put a [Glass Pane](http://docs.oracle.com/javase/tutorial/uiswing/components/rootpane.html) on top of your Burrons to intercept the incoming events

Feel free to choose the one you like best.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:22:42.890

如何通过调用 getComponents 并递归迭代它们并找到 JButtons 并在找到它们时禁用它们来获取根面板的子级？

# python - Python - 如何比较列表中的所有项目

> ID：16043183
> 
> 赞同：0
> 
> 时间：2013-04-16T17:18:37.173
> 
> 标签：python, list, loops, pyqt, pyside

作为python入门者，遇到问题时尝试向聪明人寻求帮助。这就是现在：

我必须比较一个列表中的项目（Qt 场景项目），并制作相互碰撞的单独项目组。

请帮我写代码：

```
class MainWin(QMainWindow):
    def __init__(self):
        super(MainWin, self).__init__()
        self.Win()
        self.L = self.buildAllWalls()
        items = self.scene.items()
        allGroups = groupItemsFromList(None, items)
        self.paintGroups(allGroups)
        print len(allGroups)

    def paintGroups(self, groups):
        for g in groups :
            color = QColor(0, 0, 0)
            # RANDOM COLOR
            namcol = "#%s" % "".join([hex(randrange(0, 255))[2:] for i in range(3)])
            color.setNamedColor(namcol)
            while color.isValid() == False :   #   ERROR CHECK
                namcol = "#%s" % "".join([hex(randrange(0, 255))[2:] for i in range(3)])
                color.setNamedColor(namcol)
            pen = QPen(color, 14, Qt.SolidLine)
            for w in g :
                w.setPen(pen)

    def Win(self):
        self.scene = QGraphicsScene()
        self.sView = QGraphicsView(self.scene)
        self.sView.setRenderHint(QPainter.Antialiasing)
        self.sView.setAlignment( Qt.AlignLeft | Qt.AlignTop )

        self.setCentralWidget(self.sView)
        self.setGeometry(20, 380, 400, 300)
        self.show()

    def buildAllWalls(self):
        data = self.wallCoordinates()
        for p in range(len(data)) :
            ptA = QPointF(data[p][0], data[p][1])
            ptB = QPointF(data[p][2], data[p][3])
            self.wall(ptA, ptB)

    def wall(self, ptA, ptB):
        pen = QPen(QColor(100, 100, 100), 14, Qt.SolidLine)
        currL = self.scene.addLine(QLineF(ptA.x(), ptA.y(), ptB.x(), ptB.y()))
        currL.setPen(pen)
        return currL

    #[50,75,325,75],
    def wallCoordinates(self):
        data = [[50,100,150,100],[175,200,125,200],[175,275,125,275],[175,275,175,200],
            [150,150,150,100],[175,100,225,100],[250,100,325,100],[350,125,175,125],
            [50,125,125,125],[125,175,125,125],[150,150,175,150],[175,150,175,200],
            [50,150,100,150],[100,150,100,200],[100,200,125,200],[50,175,75,175],
            [75,225,75,175],[75,225,125,225],[125,275,125,225]]
        return data

def main():

    app = QApplication(sys.argv)
    ex = MainWin()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:32:26.093

这是我将如何写这个：

```
def groupItemsFromList(self, itemList):
    tmp = itemList[:]
    allGroups = []
    while tmp:
        it = tmp.pop(0)  
        currentGroup = [it]
        # loop from back to front so we can remove items safely
        for i in range(len(tmp)-1, -1, -1):
            if it.collidesWithItem(tmp[i]):
                currentGroup.append(tmp.pop(i))
        allGroups.append(currentGroup)
    return allGroups 
```

例如：

```
class Test(object):
    def __init__(self, key):
        self.key = key
    def collidesWithItem(self, other):
        return isinstance(other, self.__class__) and self.key == other.key
    def __repr__(self):
        return '{0}({1})'.format(self.__class__.__name__, self.key)

example = [Test(1), Test(2), Test(1), Test(1), Test(3), Test(2), Test(3), Test(4)]
print groupItemsFromList(None, example) 
```

输出：

```
[[Test(1), Test(1), Test(1)], [Test(2), Test(2)], [Test(3), Test(3)], [Test(4)]] 
```

这假设所有与项目发生碰撞的项目也会相互碰撞。

**编辑：听起来假设无效，请尝试以下（未经测试）：**

```
def groupItemsFromList(self, itemList):
    tmp = itemList[:]
    allGroups = []
    while tmp:
        it = tmp.pop(0)  
        currentGroup = [it]
        i = len(tmp) - 1
        while i >= 0:
            if any(x.collidesWithItem(tmp[i]) for x in currentGroup):
                currentGroup.append(tmp.pop(i))
                i = len(tmp) - 1
            else:
                i -= 1
        allGroups.append(currentGroup)
    return allGroups 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:34:03.997

~~看起来你可以这样做：~~

 ~~```
def groupItemsFromList(self, itemList):
    """
    Make a list of lists, where each list is composed of the
    items (excepting itself, of course) that an item collides with.
    """
    return [
        [item for item in itemList[:i] + itemList[i:] if item.collidesWithItem(x)]
        for i, x in enumerate(itemList)
    ] 
```~~ 

~~`itemList[:i] + itemList[i:]`是“我想要原始列表中除第 i 个项目之外的所有元素”的 python 习语。~~

 ~~* * *

后来：我明白了。你想要更像这样的东西：

```
def groupItemsFromList(self, itemList):
    def collision_indexes(i, target):
        return [i] + [j for j, item in enumerate(itemList[i + 1:], start=i + 1) if item.collidesWithItem(target)]

    processed = set()
    results = []
    for i, target in enumerate(itemList):
        if i not in processed:
            indexes = collision_indexes(i, target)
            processed.update(indexes)
            results.append([itemList[j] for j in indexes])
    return results 
```

这里唯一的优点是这是无副作用的代码。原始数据没有变化，只有应用于数据的函数和对新的临时数据结构所做的更改。~~

# java - 引用初始化为 null 的对象数组中的插槽

> ID：16043184
> 
> 赞同：0
> 
> 时间：2013-04-16T17:18:38.343
> 
> 标签：java, debugging, generics, iterator, nullpointerexception

为了遍历哈希表，我正在尝试检查数组的槽是否等于 null。但是，我得到了 NullPointerException。有没有办法解决这个问题？

谢谢！

这是导致问题的 next() 方法（及其类）。

```
 public K next() throws NoSuchElementException{
      int tempStore = -1;
      MapHashCellList tempCells = null;
      System.out.println("Got here! 1");
      System.out.println(mapCells);
      if(mapCells.length==0) {throw new NoSuchElementException();}
      if (mapCells[arrayPointer]!=null && listCounter<=mapCells[arrayPointer].size()-2){
              System.out.println("Got here! 2");
        tempCells = mapCells[arrayPointer];
        tempStore = listCounter;
        listCounter++;
      }
      else{
        arrayPointer++;
              System.out.println("Got here! 3");
        while (mapCells[arrayPointer]==null){
          arrayPointer++;
          listCounter=0;
                System.out.println("Got here! 4");
          if(mapCells[arrayPointer]!=null){
            tempCells = mapCells[arrayPointer];
            tempStore = listCounter;
            listCounter++;
          }
          System.out.println("ListCounter: " + listCounter);
          System.out.println("Array: " + arrayPointer);
        }
      }
      return (K)tempCells.get(tempStore).getKey();
    } 
```

根据用户的一个问题，这是整个班级的代码：

```
import java.util.*;

public class ProjectMap<K,V> implements MapInterface<K,V>{

  public MapHashCellList[] mapCells;
  public int size;

  public ProjectMap(){
    mapCells = new MapHashCellList[11];
    size = 0;
  }

  public boolean containsKey( K key ){
    if(key==null){return false;}
    if(isEmpty()){return false;}
    if(mapCells[hashValue(key)]!=null){
      MapHashCellList temp = (MapHashCellList)mapCells[hashValue(key)];
      for (int g =0; g<temp.size(); g++){
        if (temp.get(g).getKey().equals(key)){
          return true;
        }
      }
    }
    return false;
  }

  public boolean isEmpty(){
    if(size==0){return true;}
    else return false;
  }

  public int hashValue(K key){
    return (int)(Math.abs(key.hashCode()%10));
  }

  public MapHashCellList get(int index){
    return (MapHashCellList)mapCells[index];
  }

  public V get( K key ){
    if(mapCells[hashValue(key)]!=null){
      MapHashCellList temp = (MapHashCellList)mapCells[hashValue(key)];
      for (int q =0; q<temp.size(); q++){
        if (temp.get(q).getKey().equals(key)){
          return (V)temp.get(q).getValue();
        }
      }

    }
    return null;
  }

  //Key = docID, V = documentNumber
  public V put( K key, V value ){
    //If cell isn't empty and Key exists, replace existing Value since duplicate
    if(mapCells[hashValue(key)]!=null){
      MapHashCellList temp = (MapHashCellList)mapCells[hashValue(key)];
      for (int q =0; q<temp.size(); q++){
        if (temp.get(q).getKey().equals(key)){
          V temp1 = (V)temp.get(q).getValue();
          temp.get(q).setValue(value);
          return temp1;
        }
      }
    }

    //Otherwise add to end of linkedlist
    if(mapCells[hashValue(key)]!=null){
      MapHashCellList temp = (MapHashCellList)mapCells[hashValue(key)];
      MapHashCell newCell = new MapHashCell(key,value);
      temp.add(newCell);
      size++;
      return null;
    }

    //Index doesn't exist yet, so make new LinkedList and add to correct index position
    MapHashCellList newCell = new MapHashCellList(key,value);
    mapCells[hashValue(key)] = newCell;
    size++;
    return null;
  }

  public V remove( K key ){
    if(mapCells[hashValue(key)]!=null){
      MapHashCellList temp = (MapHashCellList)mapCells[hashValue(key)];
      for (int q =0; q<temp.size(); q++){
        if (temp.get(q).getKey().equals(key)){
          V temp1 = (V)temp.get(q).getValue();
          temp.remove(q);
          size--;
          return temp1;
        }
      }
    }
    return null;
  }

  public int size(){
    return size;
  }

  public Iterator<K> iterator(){
    Iterator<K> temp = new KIterator();
    return temp;
  }

  private class KIterator implements Iterator<K>{
    int arrayPointer=0;
    int listCounter=0;

    KIterator(){
    }

    public K next() throws NoSuchElementException{
      int tempStore = -1;
      MapHashCellList tempCells = null;
      System.out.println("Got here! 1");
      System.out.println(mapCells);
      if(mapCells.length==0) {throw new NoSuchElementException();}
      if (mapCells[arrayPointer]!=null && listCounter<=mapCells[arrayPointer].size()-2){
              System.out.println("Got here! 2");
        tempCells = mapCells[arrayPointer];
        tempStore = listCounter;
        listCounter++;
      }
      else{
        arrayPointer++;
              System.out.println("Got here! 3");
        while (mapCells[arrayPointer]==null){
          arrayPointer++;
          listCounter=0;
                System.out.println("Got here! 4");
          if(mapCells[arrayPointer]!=null){
            tempCells = mapCells[arrayPointer];
            tempStore = listCounter;
            listCounter++;
          }
          System.out.println("ListCounter: " + listCounter);
          System.out.println("Array: " + arrayPointer);
        }
      }
      return (K)tempCells.get(tempStore).getKey();
    }

    public boolean hasNext(){
      if(isEmpty()) {return false;}
      for(int d=arrayPointer; d<mapCells.length; d++){
        if (mapCells[d]!=null){
          try{
            if(mapCells[d].get(listCounter+1)!=null){
              return true;
            }
          }
          catch(IndexOutOfBoundsException e){
            for(int l=arrayPointer; l<mapCells.length; l++){
              if (mapCells[l]!=null){
                return true;
              }
              else{
                return false;
              }
            }
          }
        }
      }
      return false;
    }

    //Removes last element
    public void remove(){
      mapCells[arrayPointer].remove(listCounter-1);
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:39:48.220

至少有一个问题与您的`public K next`方法有关：

```
public K next() throws NoSuchElementException{
  int tempStore = -1;
  MapHashCellList tempCells = null;
  System.out.println("Got here! 1");
  System.out.println(mapCells);
  if(mapCells.length==0) {throw new NoSuchElementException();}
  if (mapCells[arrayPointer]!=null && listCounter<=mapCells[arrayPointer].size()-2){
          System.out.println("Got here! 2");
    tempCells = mapCells[arrayPointer];
    tempStore = listCounter;
    listCounter++;
  }
  else{
    arrayPointer++;
          System.out.println("Got here! 3");
    while (mapCells[arrayPointer]==null){
      arrayPointer++;
      listCounter=0;
            System.out.println("Got here! 4");
      if(mapCells[arrayPointer]!=null){
        tempCells = mapCells[arrayPointer];
        tempStore = listCounter;
        listCounter++;
      }
      System.out.println("ListCounter: " + listCounter);
      System.out.println("Array: " + arrayPointer);
    }
  }
  return (K)tempCells.get(tempStore).getKey();
} 
```

在一开始的时候：

```
MapHashCellList tempCells = null; 
```

然后看`else`部分。您有以下循环：

```
while (mapCells[arrayPointer]==null){ 
```

在这个循环中你有这个：

```
if(mapCells[arrayPointer]!=null){
        tempCells = mapCells[arrayPointer];
        tempStore = listCounter;
        .................. 
```

由于程序**永远不会**进入这个`if`（你的`while`条件保证它），所以`tempCells`保持为**null**。

然后，最后你有以下内容：

```
return (K)tempCells.get(tempStore).getKey(); 
```

必须产生`NullPointerException`.

# r - 来自`nls`的R表达式适合？

> ID：16043186
> 
> 赞同：2
> 
> 时间：2013-04-16T17:18:54.110
> 
> 标签：r, expression, formula

我已经使用 拟合了一个参数函数`nls`，现在我想打印出一个函数表达式，并将学习的参数替换回去。例如：

```
x <- runif(100, 0, 100)
m <- 13 * exp(-0.05 * x^2) + 0.1 + runif(100,0,0.1)
mod <- nls(m ~ a*exp(-b*x^2)+c, start=list(a=10,b=0.1,c=0.1)) 
```

我可以像这样提取公式和系数：

```
formula(mod)
# m ~ a * exp(-b * x^2) + c
coef(mod)
#           a           b           c 
# 13.00029360  0.04975388  0.14457936 
```

但我没有看到直接替换它们的方法。我似乎唯一能做的就是再次写出公式：

```
substitute(m ~ a * exp(-b * x^2) + c, as.list(round(coef(mod), 4)))
# m ~ 13.0003 * exp(-0.0498 * x^2) + 0.1446 
```

我的最终目标是从磁盘上的 RDS 文件中读取拟合对象，并在[org-mode](http://orgmode.org)文档`nls`中显示其功能表达式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:42:43.440

这是你要找的吗？

```
do.call(substitute, args=list(formula(mod), as.list(round(coef(mod),4))))
# m ~ 13.0097 * exp(-0.0501 * x^2) + 0.1536 
```

它之所以有效，是因为`do.call`首先计算两个参数，`args`然后才使用`substitute()`将系数替换为公式表达式。即，`do.call()`最终计算的表达式看起来像这样，根据需要：

```
as.call(list(substitute, formula(mod), as.list(round(coef(mod),4))))
# .Primitive("substitute")(m ~ a * exp(-b * x^2) + c, list(a = 13.0097, 
# b = 0.0501, c = 0.1536)) 
```

# php - 如何判断 URL 是否指向图像？

> ID：16043189
> 
> 赞同：3
> 
> 时间：2013-04-16T17:19:04.753
> 
> 标签：php

我有一个带有文本输入的 php 页面，用户应该在其中粘贴图像的远程 URL，我必须将其存储在服务器中并将其显示给用户。现在的问题是，我不相信用户总是会提供正确的图像 url，我不希望他们上传 pdf 或其他文件，或者一个巨大的、几 GB 的文件。现在我可以检查扩展名，但这不是很有帮助，我听说我可以检查 mime-type，但我不知道如何打开文件一次并检查所有验证，如 mime-type 和 file一口气大小，然后将文件复制过来。此外，由于文件将按原样提供（名称更改较小），我想知道是否有可能确保该文件没有任何注入的病毒或有问题的代码。

任何建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:22:21.557

您可以使用`exif_imagetype()`它来查看它是否是图像。

如果您想 100% 确定它不是恶意软件或奇怪的东西。使用 GD 库并通过 GD 库保存它是个好主意。所以里面没有`dangerous`代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:34:58.780

使用 Curl，您对 https 没有任何问题，您可以存储一个文件并检查它。
这是检查图像内容类型的代码，然后使用 exif_imagetype() 检查文件（启用 php_mbstring 和 php_exif 扩展）。

```
$url = 'https://www.google.com/images/icons/ui/doodle_plus/doodle_plus_google_logo_on_grey.gif';

$userAgent = 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; .NET CLR 1.1.4322)';       
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_USERAGENT, $userAgent);
curl_setopt($ch, CURLOPT_CONNECTTIMEOUT,60);
curl_setopt($ch, CURLOPT_FAILONERROR, 1);

curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true); 
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);

curl_setopt($ch, CURLOPT_NOBODY, true);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_exec( $ch ) ;
if(!curl_errno($ch))  
{
    $type = curl_getinfo($ch, CURLINFO_CONTENT_TYPE); 
    if ( stripos($type, 'image') !== FALSE )
    {
        curl_setopt($ch, CURLOPT_NOBODY, false);  
        curl_setopt($ch, CURLOPT_HEADER, false);    
        $filename = tempnam('/path/to/store/file/', 'prefix');
        $fp=fopen($filename,'wb');
        curl_setopt($ch, CURLOPT_FILE, $fp); 
        curl_exec($ch);
        fclose($fp);
        if ( exif_imagetype($filename) !== FALSE )
        {
            echo "100% IMAGE!";
            // take it!
        }

        unlink($filename);
    }      
}

curl_close($ch); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:35:38.110

好吧，这里真的有很多事情可以做。我建议使用 cURL 作为传输文件的机制（而不是`file_get_contents()`类似的）。这样做的原因是，您可以先向资源发送 HEAD 请求，以便在提交实际下载之前获取标头信息。从标题中，您应该能够评估文件名、文件大小、mime 类型信息等。请注意，这些信息中的任何一个都不应该被信任，但它至少在提交文件下载之前给您一个健全性检查。

完成完整性检查后，您可以将文件下载到本地 snadbox 目录中。这不应该是 Web 可访问的目录。您可以使用`exif_imagetype()`来确定文件是否确实是您感兴趣的类型的图像。

假设这一切看起来不错，我会在 GD 库中进行最后一点清理和重命名（也许使用`imagecreatefrom*()`函数从临时下载文件中制作最终图像）。

# marionette - Several application objects in Backbone.Marionette App

> ID：16043192
> 
> 赞同：0
> 
> 时间：2013-04-16T17:19:07.810
> 
> 标签：marionette

Is it possible to define several application objects in Backbone.Marionette Application? What is the best practise for creating modular application - to establish a set of application objects with distinct names, or describe specific functionality in modules extended from Marionette.Module?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T15:54:30.713

Marionette 包含了应用程序模块的概念。

[https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.application.module.md](https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.application.module.md)

```
MyApp = new Backbone.Marionette.Application();

MyApp.module("Foo", function(){

  // module code goes here

});

MyApp.start(); 
```

# oracle11g - ORA-12547: TNS Lost Contact when running DBCA on Oracle 11g installation on Ubuntu Linux 12.04 64 bit

> ID：16043193
> 
> 赞同：4
> 
> 时间：2013-04-16T17:19:09.740
> 
> 标签：oracle11g, ubuntu-12.04

I'm trying to create a database using DBCA on Oracle 11g installation on Ubuntu Linux 12.04 64 bit.

I followed the instructions [here](http://www.makina-corpus.org/blog/howto-install-oracle-11g-ubuntu-linux-1204-precise-pangolin-64bits), but I get

> ORA-12547: TNS Lost Contact when running DBCA.

Below are the details. Can someone assist with the solution?

1.  Instead of using `/opt/oracle` as the "oracle" user home, I used `/home/oracle`

2.  I did not install the libstdc++5 in 32 bit version

3.  I did everything else the same as the posting

4.  Installation resulted in "missing packages". I tried to do an apt-get install for these packages from ubuntu, but ubuntu says that they don't exist. Then I saw in the instructions:

    > Once you will reach the "pre-reqs" screen, check "Ignore all" to continue the installation.

5.  When running `./dbca` from `$ORACLE_HOME/bin`, it fails with ORA-12547.

6.  I checked `$ORACLE_HOME/network/admin` and listener.ora , sqlnet.ora , and tnsnames.ora all look OK.

7.  However, I think that tnsnames.ora is not being read properly, because `./tnsping` fails and the error message states that "EZ Connect" was used. But in my sqlnet.ora , I have

    ```
    names.directory_lookup = (TNSNAMES,EZCONNECT) 
    ```

    It should use EZ Connect only after tnsnames is tried.

8.  Also, I sometimes get ORA-12541: No listener. I tried running `./netca`. Everything is OK until I perform a test on the listener, and it fails.

9.  I can't run `./lsnrctl`. Absolutely nothing happens for this, as well as lsnrctl start, stop, status.

10.  I can't go through sqlplus. If I run `./sqlplus` , it asks me for username/password directly.

11.  If I do `./sqlplus / as sysdba`, then this results in "ORA-12547: TNS lost contact".

12.  All environment variables are set correctly in `.bashrc`.

13.  I tried re-running root.sh , but the problem is not fixed.

14.  `/etc/oratab` is OK

15.  `/etc/hosts` is OK, but I can't always ping the "localhost" or "127.0.0.1", or "ubuntu" or "127.0.1.1"

    The same TNS or Listener errors display.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-09-08T03:53:49.243

1.  当我登录oracle（sqlplus system/pass as sysdba）时，我得到了这个：

    错误： 　

    ORA-12547: TNS：尝试连接到 Oracle 时失去联系。

2.  首先，我认为服务器已关闭，但我检查它，它是好的。很多人说'chmod 6751 oracle'，我做到了，但我得到了另一个错误：

    错误：

    ORA-01031: 权限不足

    输入用户名：

3.  最后，我将系统用户从 root 切换到 oracle。我登录成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-20T11:55:13.203

```
Ensure the DB is up and running and you can connect locally AS SYSDBA to the database
using Oracle binaries owner (usually oracle:oinstall Unix / Linux user). If it does not
work, probably you encounter a different problem.

1\. Check privileges of an Oracle file on Unix / Linux host where database is running:
  cd $ORACLE_HOME/bin
  ls -ltr oracle

2\. Change permissions as below:
  chmod 6751 oracle
  ls -ltr oracle

 This code may help you lot.
```

# python - 在 django rest-framework 中返回响应

> ID：16043196
> 
> 赞同：5
> 
> 时间：2013-04-16T17:19:21.503
> 
> 标签：python, django, django-templates, django-views, django-rest-framework

我正在 django rest-framework 中编写一个应用程序：我的 views.py：

```
class tagList(generics.ListCreateAPIView,APIView):

    model = tags
    serializer_class = getAllTagsDetailSerializer
    def get_queryset(self):
        print "q1"
        print self.request.QUERY_PARAMS.get('tag', None)
        print self.request.user
        print "q1"
        if tags.objects.filter(tag='burger')!= None:
             return tags.objects.filter(tag='burger')
        else:
            content = {'please move along': 'nothing to see here'}
            return Response(content, status=status.HTTP_404_NOT_FOUND) 
```

如果查询返回无，我想返回错误状态代码。但是如果我尝试设置 Response 则会引发错误：

```
Exception Type: TypeError
Exception Value:    
object of type 'Response' has no len()
Exception Location: /usr/local/lib/python2.7/dist-packages/django/core/paginator.py in _get_count, line 53 
```

否则，如果查询结果不是无，则它正在工作。如何在 Django rest-framework 上设置状态码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:36:22.287

该方法应该返回一个 QuerySet，而不是一个 Response 对象，我敢打赌你应该抛出一个`Exception`，或者 an`APIException`或者 an `Http404`。

无论如何，您的处理似乎很奇怪，我认为您应该只返回 QuerySet 并且框架将处理结果是否为空。该方法应如下所示：

```
def get_queryset(self):
    return tags.objects.filter(tag='burger') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-16T05:40:02.260

你能试试这个

```
model = tags # Model name
serializer_class = getAllTagsDetailSerializer # Call serializer

def get_queryset(self):
    key = self.request.QUERY_PARAMS.get('appKey', None)
    getTagName = self.request.QUERY_PARAMS.get('tagName')
    keyData = app.objects.filter(appKey=key).exists()    
    try:
        if keyData == True:
            return tags.objects.filter(tag=getTagName)
        else:
            raise exceptions.PermissionDenied
    except app.DoesNotExist:
        pass 
```

我认为它会工作......

# android - 启用 ALWAYS_FINISH_ACTIVITIES 的常见场景有哪些？

> ID：16043198
> 
> 赞同：1
> 
> 时间：2013-04-16T17:19:24.320
> 
> 标签：android, android-activity, cyanogenmod

我的任务是支持一个已经在生产中部署但不正确地支持销毁和重新创建活动的应用程序。当用户的设备默认配置为始终销毁不在前台的活动时，这一点最为明显。

这个应用程序没有明确设置值；它使用全局默认值。

我的问题是：启用此设置的常见情况是什么？例如：

1.  设备制造商自定义 Android，以便可以从默认设备设置活动中切换此设置。

2.  自定义 Android 版本（例如 Cyanogen）已配置为默认“开启”。

3.  用户下载某种“电动工具”，允许他调整默认系统设置。

这些可能性有多大？还有其他我错过的常见案例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:26:19.850

> Device manufacturer customizes Android such that this setting can be toggled from within the default device settings activity.

There is no customization needed. This is available in the Developer Options area.

> Custom Android build (e.g. Cyanogen) has been configured to have it "on" by default.

One hopes that nobody does this.

> User downloads some sort of "power tool" allowing him to tweak the default system settings.

Again, this is part of Android, so no "power tool" is needed.

> How likely are each of these?

Not very. I'd be surprised if it is more than one device in 10,000\. If your app cannot handle this setting (and I suspect that few apps do), and you are worried about it, feel free to check the setting and display something to the user to have them go revert the setting.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:24:08.937

如今，几乎所有设备的设置中都有它——所有 nexus 设备和高端三星设备。用户不需要电动工具即可在任何这些设备中打开它。

# powershell - 自动在密码提示中输入文本

> ID：16043199
> 
> 赞同：0
> 
> 时间：2013-04-16T17:19:30.840
> 
> 标签：powershell, vbscript, symantec

有没有办法使用脚本自动在 ms windows 中的密码提示窗口中输入文本。

我正在尝试删除应用密码时不允许删除的产品，但是在 CMD 中传递密码不起作用，因为提示将出现所有方式。

产品 SEP 12.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:23:05.273

不知道这是否对您有帮助，但是：

[http://wasp.codeplex.com/](http://wasp.codeplex.com/)

# jquery - mouseenter 和 mouseleave 在我的插件中给了我一个奇怪的结果

> ID：16043201
> 
> 赞同：0
> 
> 时间：2013-04-16T17:19:38.697
> 
> 标签：jquery, html, plugins

我已经为它构建了一个导航栏和一个插件。设计很简单，如下图所示![红线在鼠标悬停时移动到选项上](https://i.stack.imgur.com/Akzvb.png)

现在，当鼠标经过它时，红线移动到选项上方。当鼠标从整个导航栏上移动时，红线应该返回到它的原始位置。下面是插件：

```
(function($){
$.fn.MyNavSlider = function(){
var bar,slide,pos,width,deflt;
bar=$(this);
slide=$('.myslider');
pos=bar.position();
width=bar.width();
deflt=$("#Nav_bar");

bar.on('mouseenter',function(){
slide.animate({'left': pos.left + 'px', 'width': width + 'px'}, 300);
});
//(first attempt)if I use th below code the weird behaviour begins
bar.on('mouseleave',function(){
slide.animate({'left': '0px', 'width':'20px'}, 300);
});
/*(Second attempt)I also tried the following
deflt.on('mouseleave',function(){
//back to original position
});
*/
}
})( jQuery );
$("div.Mylinks").each(function(){
$(this).MyNavSlider();
}); 
```

这是html的布局：

```
<div id="Nav_bar">
<div id="Slider_holder">
<div class="myslider"></div>
</div>

<div id="Nav_bar">
<div class="Mylinks">Option 1</div>
<div class="Mylinks">Option 2</div>
<div class="Mylinks">Option 3</div>
<div class="Mylinks">Option 4</div>
//......etc
</div>
</div> 
```

移动选项工作正常。如果我在（第一次尝试）中使用代码，每次鼠标移到新选项上时，红色标记都会移动到原始位置，然后转到新选项。如果我使用（第二次尝试），当我将鼠标从选项上移开时，它什么也不做，直到我将鼠标移回一个选项上，然后它会回到原始位置，然后是我的新选项。我也试过：

```
bar.on('mouseleave',function(){
//my code to execute
}); 
```

和 ：

```
bar.on({
mouseenter: function(){
//code to execute
},
mouseleave: function(){
//code to execute
}
}); 
```

和 ：

```
bar.on('hover',function(){
//code to execute
});
deflt.animate({'left':'0px','width':'20px'}); 
```

我什至在函数中添加了一个事件，然后在 mouseleave 函数中做了类似的事情：

```
if(bar.har(e.target).length > 0)
{
//execute reset code
}
//the event was added to $.fn.MyNavSlider = function(event) line 
```

我想要的只是让红色标记在鼠标经过所有选项时平滑过渡，然后在鼠标从导航栏上方移动时返回到其原始位置。我还为此创建了一个 JsFiddle。我是 JsFiddle 的新手，所以我也无法让它工作。[我的第一小提琴](http://jsfiddle.net/uxTpZ/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:34:21.610

并添加到另一个答案......并使红色标记返回到原始位置：

```
$('#Nav_bar').on('mouseleave', function () {
    slide.animate({
        'left': '0px',
            'width': '20px'
    }, 300);
}); 
```

完整的小提琴：http: [//jsfiddle.net/NACBK/](http://jsfiddle.net/NACBK/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:31:38.303

你想要这样吗？

**演示** [http://jsfiddle.net/uxTpZ/1/](http://jsfiddle.net/uxTpZ/1/)

像这样设置这个方法：

```
bar.on('mouseenter', function () {
        slide.animate({
            'left':$(this).position().left + 'px',
                'width': width + 20 + 'px'
        }, 300);
     }); 
```

# ios - 在 iOS 中处理大图像

> ID：16043204
> 
> 赞同：12
> 
> 时间：2013-04-16T17:19:44.510
> 
> 标签：ios, uiimage, thumbnails, photo, cgbitmapcontext

我想允许用户选择一张照片，而不限制大小，然后对其进行编辑。

我的想法是创建一个与屏幕大小相同的大照片的缩略图进行编辑，然后在编辑完成后，使用大照片进行与缩略图相同的编辑。

当我使用`UIGraphicsBeginImageContext`创建缩略图时，它会导致内存问题。

我知道由于硬件限制，很难直接编辑整个大图像，所以我想知道是否有一种方法可以将大图像降采样到小于 2048*2048 而不会出现内存问题？

我发现有一个`BitmapFactory`类有一个`inSampleSize`可以在 Android 平台上对照片进行下采样的选项。如何在 iOS 上做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-11-16T10:33:24.270

您需要使用`UIImage`它来处理图像加载，它实际上不会将图像加载到内存中，然后以您想要的结果图像的大小创建位图上下文（因此这将是使用的内存量）。然后，您需要从原始图像（这是将部分图像数据加载到内存中的位置）迭代多次绘制图块，`CGImageCreateWithImageInRect`使用`CGContextDrawImage`.

请参阅[Apple 的此示例代码](https://developer.apple.com/Library/ios/samplecode/LargeImageDownsizing/Introduction/Intro.html#//apple_ref/doc/uid/DTS40011173)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-04T01:30:32.117

大图像不适合内存。因此将它们加载到内存中然后调整它们的大小是行不通的。

要处理非常大的图像，您必须平铺它们。已经有很多解决方案，例如看看这是否可以解决您的问题：

[https://github.com/dhoerl/PhotoScrollerNetwork](https://github.com/dhoerl/PhotoScrollerNetwork)

我实现了自己的自定义解决方案，但那是特定于我们的环境的，我们已经有一个运行服务器端的图像切片器，我可以只请求特定的大图像切片（madea 服务器，这真的很酷）

平铺工作的原因是基本上你只将可见像素保留在内存中，并且没有那么多。当前不可见的所有切片都被分解到磁盘缓存或闪存缓存中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-15T22:21:54.640

看看 Trevor Harmon 的这项工作。它提高了我的应用程序的性能。我相信它也对你有用。

[https://github.com/coryalder/UIImage_Resize](https://github.com/coryalder/UIImage_Resize)

# c# - 在 MVVM 中实现 ICommand 时，我遗漏了一些东西

> ID：16043206
> 
> 赞同：2
> 
> 时间：2013-04-16T17:19:48.477
> 
> 标签：c#, wpf, mvvm, icommand, relaycommand

一般来说，我对 C# 和 WPF 很陌生，来自 LAMP Web 应用程序背景。我已经尝试过几个关于这个主题的教程，但它们让我很困惑。

[https://rachel53461.wordpress.com/2011/05/08/simplemvvmexample/](https://rachel53461.wordpress.com/2011/05/08/simplemvvmexample/) [http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial](http://www.codeproject.com/Articles/165368/WPF-MVVM-Quick-Start-Tutorial)

在第一个教程中，应用程序以一个简单的界面打开。一个文本框和两个按钮。当您更新 ProductId 文本框时，从 0 变为 1，“获取产品”按钮变为活动状态。当您单击“获取产品”按钮时，会出现 DataTemplate 的内容。我看不到这些事情实际发生在哪里。是什么导致按钮变为活动状态？是什么导致表格出现？

希望你们能帮我把它变笨=）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:22:58.590

按钮被激活或停用，因为它们绑定到`ICommand`. `ICommand`包括一个[`CanExecute`](http://msdn.microsoft.com/en-us/library/system.windows.input.icommand.canexecute.aspx)属性，该属性确定按钮是否处于活动状态。

> 我看不到这些事情实际发生在哪里。

该命令使用委托：

```
 _getProductCommand = new RelayCommand(
                param => GetProduct(),
                param => ProductId > 0
            ); 
```

第二个委托使命令在（委托返回 true `CanExecute`）时被激活（变为 true ）。`ProductId > 0`

当您单击按钮时，命令的`Execute`方法将触发并执行操作。

至于首先启动的窗口，请查看标题为“启动示例”的部分 -`app.xaml.cs`其中有用于首先显示窗口的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:25:34.993

在该特定示例中，您可以看到：

```
<TextBox Grid.Row="0" Grid.Column="1" Text="{Binding ProductId}" /> 
```

使用[数据绑定](http://msdn.microsoft.com/en-gb/library/ms750612.aspx)`TextBox`将其属性绑定到当前数据上下文（这是视图模型的实例）上。`Text``ProductId`

当您在 中键入文本时`TextBox`，其值将`ProductId`在视图模型的属性上自动更新。

该命令检查 的值`ProductId`是否大于 0 以确定是否`Button`启用。

可以看到`Button`' 命令设置为`GetProductCommand`:

```
<Button ... Command="{Binding Path=GetProductCommand}" ... /> 
```

使用`GetProductCommand`表达式`ProductId > 0`作为其`CanExecute`谓词：

```
_getProductCommand = new RelayCommand(
              param => GetProduct(),
              param => ProductId > 0
); 
```

WPF 将执行此 lambda 表达式`ProductId > 0`，其结果将确定是否`Button`启用。启用并单击按钮后，将执行第一个 lambda 表达式 - `GetProduct()`。

说了这么多，[你真的应该使用 MVVM 框架](http://www.lhotka.net/weblog/UsingTheMVVMPatternRequiresAFramework.aspx)，这些框架还有其他机制可以在你的视图模型上调用方法，这些机制克服了命令的一些限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T18:11:15.230

本质上，MVVM 或 Model、View、ViewModel 背后的理念是删除背后的代码并分离出应用程序的各个层，以便它们可以独立工作。您的 GUI 或视图与 Viewmodel 或代码隐藏之间的交互并没有像您想象的那样发生。很多人对视图模型如何与 gui 或视图进行交互感到困惑。我是一名 winforms 开发人员，拥有代码隐藏文件，您可以在其中轻松查看隐藏代码中的事件处理程序并在逻辑上遵循代码。在您将 XAML gui 的数据上下文设置为视图模型的 MainWindow 代码中，如下所示。

```
public partial class MainWindow : Window
{
    #region Members
    SongViewModel _viewModel;
    int _count = 0;
    #endregion

    public MainWindow()
    {
        InitializeComponent();

        //  We have declared the view model instance declaratively in the xaml.
        //  Get the reference to it here, so we can use it in the button click event.
        _viewModel = (SongViewModel)base.DataContext;
    }

    private void ButtonUpdateArtist_Click(object sender, RoutedEventArgs e)
    {
        ++_count;
        _viewModel.ArtistName = string.Format("Elvis ({0})", _count);
    }
} 
```

然后 {Binding Path=Property} 将 _viewModel 的属性连接到 XAML 元素。添加 RaisePropertyChanged 是通知 gui 该属性的值已更改。

```
public string ArtistName
    {
        get { return Song.ArtistName; }
        set
        {
            if (Song.ArtistName != value)
            {
                Song.ArtistName = value;
                RaisePropertyChanged("ArtistName");
            }
        }
    } 
```

View 模型的 ArtistName 属性绑定到标签，就像在 XAML 中一样

这或多或少是您在 gui 和代码之间的交流。因此，例如在您的第一个示例中，当您将文本框从 0 更改为 1 时，就会更新 ViewModel 中的 ProductID 属性。您可以在您的 ICommand GetProductCommand 中看到有一个参数被传递给 relayCommand 用于 ProductID > 0。现在它的 1 canexecute 为真，因此该命令现在可以执行并且按钮变为可点击。当您单击它时，GetProduct 是发生的操作，然后该方法将您的 CurrentProduct 属性设置为值。产品信息的 Datatemplate 绑定到 xaml 中的 ProductModel，ProductModel 绑定到 CurrentProduct，因此现在在该数据模板中 CurrentProduct 的属性可以绑定到 xaml 元素，因此 CurrentProduct.ProductName 或绑定到

```
<TextBox Grid.Row="1" Grid.Column="1"  Text="{Binding ProductName}" /> 
```

起初它令人困惑，但当你掌握它时，它会完全有意义。

# python - what is the difference between print and return in python?

> ID：16043207
> 
> 赞同：0
> 
> 时间：2013-04-16T17:19:50.380
> 
> 标签：python

I'm doing my homework and I got confused between "print" and "return".

For example when I asked to make a function that return all the letters in ("a","e","i","o","u"), why is the out put cannot come out when I just put my def function (ex. all_letters("hello my wife") ? but when I put "print letters" there is an output?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:20:54.177

使用`return`，您可以分配给变量：

```
def my_funct(x):
    return x+1 
```

然后你就可以做到了`y = my_funct(5)`。`y`现在等于 6。

为了帮助描述它，把一个函数想象成一台机器（类似于他们在一些数学课中使用的）。通过插入变量（在本例中为`x`），函数输出（或`returns`）某些内容（在本例中为`x+1`）。变量是输入，而`return`给出输出。

但是，使用 时`print`，该值仅显示在屏幕上。

如果将函数更改为：

```
def my_funct(x):
    print(x+1) 
```

然后 do `y = my_funct(x)`, `y`equals `None`，因为`print()`不返回任何东西。

使用机器比喻，您插入变量（再次，`x`）但不是输出某些东西，它只是向您显示它等于什么（再次，`x+1`）。但是，它不输出任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T17:21:20.077

`return`返回一个值到调用范围。 `print`（除非有人做了一些猴子补丁）将数据推送到标准输出。随后可以从调用范围使用返回的值，而打印的内容被分派到操作系统，操作系统会相应地处理它。

```
>>> def printer(x):
...     print x * 2
...
>>> def returner(x):
...     return x * 2
...
>>> printer(2)
4
>>> y = printer(2)
4
>>> y is None
True
>>> returner(2)
4
>>> y = returner(2)
>>> y
4 
```

交互式控制台在说明这一点时有点误导，因为它只打印返回值的字符串表示，但`y`上面示例中分配的值的差异是说明性的。 `y`是`None`当分配结果时，`printer`因为`return None`对于没有显式返回值的任何函数都有一个隐式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T17:25:27.523

`return` is a keyword while `print` is a function:

`return` is useful when you want to assign a value to a variable.

`print` just allows you to print some text in the command prompt:

```
def foo():
    return 2
bar = foo() # now bar == 2
print(bar) # prints 2 
```

# ruby - Explain the differences in setting up a web dev environment on Mac

> ID：16043208
> 
> 赞同：0
> 
> 时间：2013-04-16T17:19:53.783
> 
> 标签：ruby, bundler, homebrew, heroku-toolbelt

I'm new to web development and as I research how to install various dev tools on my Mac the following questions have come up,

*   Should I install Heroku via the [standalone toolbelt](https://toolbelt.heroku.com/standalone) or via homebrew? Isn't the point of homebrew to manage non-Apple packages in a single place.

*   Ruby development using the bundler gem again seems like a wise decision, so that gems are no longer installed via gem install but rather with a project Gemfile. This would suggest that the only gem install required is Bundler. However, then I see developers install a range of tools like this

    `gem install bundler foreman pg rails thin --no-rdoc --no-ri`

    Is this just laziness or is there some reasoning behind this choice that I don't understand?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:47:29.520

`bundler`而且`foreman`我知道在项目之外。Bundler 出于显而易见的原因，而 foreman 因为有时它不喜欢在捆绑包的约束中很好地运行，但据我所知，没有理由在捆绑包之外安装`pg`,`rails`和`thin`。

在某些 bundler 配置中，bundler 将检查本地安装的 gem 并将它们用作 bundle 的一部分，而在其他配置中，它不会。也许安装该 gems 套件的原因是为了防止 gem 的多个版本安装在系统上的不同项目中，本质上充当 gems 的全局存储库。

老实说，我正在对此进行头脑风暴，但这是我能想出的唯一合乎逻辑的解释，希望有人能比我自己回答得更好。

# php - how to correctly update integer field adding value on symfony?

> ID：16043214
> 
> 赞同：0
> 
> 时间：2013-04-16T17:20:16.970
> 
> 标签：php, sql-update, symfony-1.4

Ive been working with symfony since few days, now I am trying to make updates, but I am stuck with many problems, one of them is that I cant find a way to update a field adding a value, instead replacing the value, I just want to add the new one.

```
$q = Doctrine_Query::create()
->update('OhrmBudget')
->set('spent', 'spend' + $cost)
->where('month', $month)
->where('year', $year);
$q->execute(); 
```

I feel like the "wheres" are not working! because I also have another update and it sets the new value to all fields on my table.

```
$q = Doctrine_Query::create()
->update('OhrmTrainningSubmit')
->set('state', $state)
->where('trainning', $training)
->andWhere('user', $user);
$q->execute(); 
```

Any idea how to make this updates? I checked [a link](http://symfony.com/legacy/doc/cookbook/1_2/en/retrieving_data_with_doctrine) with reference I checked, but in none of them make this kind of updates, and none of them use more than one Where that I need, anyone could give me an idea?

I am with symfony 1.4

Thanks

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:52:21.253

我认为对于您的第一个查询，它会更好：

```
$q = Doctrine_Query::create()
->update('OhrmBudget b')
->set('b.spent', 'newvalue')
->where('b.month = ?', $month)
->andWhere('b.year = ?', $year)
->execute(); 
```

您必须使用“ **andWhere()** ”而不是“where()”作为第二个 where。

# android - Android layout_below way of working

> ID：16043215
> 
> 赞同：0
> 
> 时间：2013-04-16T17:20:19.857
> 
> 标签：android, layout, android-listview

So I have a layout that contains a ListView...and underneath the ListView I have various other elements...my problem is that if the ListView gets a lot of elements, then the elements from the bottom disapear from the screen....How can i solve this?

My layout:

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        xmlns:tools="http://schemas.android.com/tools"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
             android:id="@+id/header"
             android:orientation="horizontal"
             android:layout_width="fill_parent"
             android:layout_height="wrap_content"
             android:layout_alignParentTop="true">

            <TextView android:id="@+id/name_header"
                android:textSize="18sp"
                android:textStyle="bold"
                android:layout_marginLeft="10sp"
                android:layout_marginTop="5sp"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.6"
                android:text="@string/product"
            />

            <TextView android:id="@+id/quantity_header"
                android:textSize="18sp"
                android:textStyle="bold"
                android:layout_marginTop="5sp"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.2"
                android:text="@string/quantity"
                android:gravity="center"
            />

            <TextView android:id="@+id/total_price_header"
                android:textSize="18sp"
                android:textStyle="bold"
                android:layout_marginTop="5sp"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="0.2"
                android:text="@string/price"
                android:gravity="center"
            />

        </LinearLayout>

        <View android:id="@+id/line"
            android:layout_width="match_parent"
            android:layout_height="2dip"
            android:background="#FF0000" 
            android:layout_below="@+id/header"
        />

        <ListView
            android:id="@+id/listViewOrder"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:layout_below="@+id/line"
            android:layout_marginTop="10sp"
            android:layout_centerHorizontal="true" >
        </ListView>

        <View android:id="@+id/line2"
            android:layout_width="match_parent"
            android:layout_height="2dip"
            android:background="#FF0000" 
            android:layout_marginTop="10sp"
            android:layout_below="@+id/listViewOrder"
        />

        <TextView android:id="@+id/total_cost"
            android:textSize="18sp"
            android:textStyle="bold"
            android:layout_marginTop="5sp"
            android:layout_marginBottom="15sp"
            android:layout_marginRight="5sp"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="right"
            android:layout_below="@+id/line2"
        />

        <RadioGroup android:id="@+id/radio"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:layout_below="@+id/total_cost">

            <RadioButton android:id="@+id/radio_home"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/radio_home"
                android:layout_marginRight="20sp"
                android:onClick="onRadioButtonClicked"
            />
            <RadioButton android:id="@+id/radio_work"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="@string/radio_work"
                android:onClick="onRadioButtonClicked"
            />
        </RadioGroup>

</RelativeLayout> 
```

Thanks

EDIT : The problem was in my approach..what I needed was a TableLayout...and the element outside to be a ScrollView

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:22:26.133

在 listView 上放置一个 layout_above。如果你在下部视图上使用 layout_below，它会先调整列表视图的大小，然后找一个地方把它下面的东西放在屏幕外。如果您在 listView 上执行 layout_above 将其放在这些元素之上，它将首先布局其下方的元素，然后将 listview 布局在这些元素之上，强制其进入剩余空间。只需记住将最底部的项目与父项的底部对齐。

# jsf-2 - 参考JSF根据迭代索引动态生成的ids

> ID：16043218
> 
> 赞同：11
> 
> 时间：2013-04-16T17:20:24.163
> 
> 标签：jsf-2

在 JSF 中，`<ui:repeat/>`PrimeFaces 等类似组件`<p:dataTable/>`根据迭代索引为子组件生成动态 id，即：

```
<p:dataTable id="table" var="item" value="#{itemList}">
    <h:outputText id="name" value="#{item.name}"/>
</p:dataTable> 
```

会产生这样的东西：

```
<table id="table">
    <span id="table:0:name">name0</span>
    <span id="table:1:name">name1</span>
    <span id="table:2:name">name2</span>
    ...
    <span id="table:n:name">nameN</span>
</table> 
```

所以所有元素显然都有一个不同的客户 ID。我故意跳过`<tr/>`,`<td/>`等。

因此，`<p:ajax ... update=":table:name"/>`引用表中的所有名称并且它工作正常，虽然我可以确认组件存在于标记中但`<p:ajax ... update=":table:#{someDesiredIndex}:name"/>`失败并显示类似于事件的消息。`SEVERE: javax.faces.FacesException: Cannot find component with identifier ":table:0:name" in view.`难道不能这样做吗？

我在 GlassFish 3.1.2 和 Mojarra 2.1.6 上运行以防万一。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-16T17:58:06.083

它确实不存在于 JSF 组件树中，因为[`UIViewRoot#findComponent()`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UIComponentBase.html#findComponent%28java.lang.String%29). 它仅存在于生成的 HTML 输出中。JSF 组件树中只有一个`<h:outputText id="name">`，而不是您所期望的多个。它只是在生成 HTML 输出时被多次重用。充其量，您可以通过 获取物理组件`table:name`，但这反过来又不存在于 HTML DOM 树中，因此`document.getElementById()`在执行 ajax 更新期间会失败。

无论如何，为了实现具体的功能需求，您基本上需要有一个物理存在的组件来表示 JSF 组件树中的行。如果您使用视图构建时间标记（例如 JSTL `<c:forEach>`）而不是视图呈现时间标记，则可以在循环中创建它们。

```
<table id="table">
    <c:forEach items="#{itemList}" var="item" varStatus="loop">
        <tr><td><h:outputText id="table_#{loop.index}_name" value="#{item.name}" /></td></tr>
    </c:forEach>
</table> 
```

这将在 JSF 组件树中创建物理上的多个组件，并呈现为：

```
<table id="table">
    <span id="table_0_name">name0</span>
    <span id="table_1_name">name1</span>
    <span id="table_2_name">name2</span>
    ...
    <span id="table_n_name">nameN</span>
</table> 
```

您可以通过例如引用它们`update=":table_#{someDesiredIndex}_name"`。

### 也可以看看：

*   [如何找出用于 ajax 更新/渲染的组件的客户端 ID？找不到从“bar”引用的表达式“foo”的组件](https://stackoverflow.com/questions/8634156/cannot-find-component-with-expression-foo-referenced-from-bar-fajax-con)
*   [JSF2 Facelets 中的 JSTL...有意义吗？](https://stackoverflow.com/questions/3342984/jstl-in-jsf2-facelets-makes-sense)

* * *

**更新**：从 Mojarra 2.2.5 开始，`<f:ajax>`不再验证客户端 ID，渲染器能够遍历迭代组件以找到要渲染的正确迭代轮次。所以以这种方式引用迭代索引`<f:ajax>`应该可以正常工作。它仅在当前的 MyFaces 2.2.7 / PrimeFaces 5.1 版本中还不起作用，但预计它们会在未来的版本中赶上它。

# css - 为什么当元素的包装器的“显示”被切换时，CSS3 过渡在元素上不起作用？

> ID：16043225
> 
> 赞同：1
> 
> 时间：2013-04-16T17:20:51.843
> 
> 标签：css, css-transitions, css-animations

我正在尝试为我的一个网络应用程序制作一个对话框。我在[http://jsbin.com/etuyut/2/edit](http://jsbin.com/etuyut/2/edit)实现了这个概念。

我想让对话框带有动画。

我知道随着包装器`display`变成`none`. 我想知道引入（显示）对话框有什么问题。

我使用 ZeptoJS 作为前端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:41:50.593

乳清？嗯，这是乳清...

[http://w3schools.invisionzone.com/index.php?showtopic=46498](http://w3schools.invisionzone.com/index.php?showtopic=46498)

*   淡入时，将显示更改为块，然后将不透明度增加到 1.0
*   淡出时，将不透明度降低到 0.0，然后将显示更改为无
*   在下次淡入之前，再次将显示更改为阻止...

褪色是一项非常常规的工作，没有什么是不可能的。通过上面的链接后，如果您需要代码方面的帮助，请告诉我。我认为这足以将您推向正确的方向。

# concurrency - 消费者生产者算法的混合解决方案

> ID：16043230
> 
> 赞同：0
> 
> 时间：2013-04-16T17:21:16.780
> 
> 标签：concurrency, producer-consumer, mutual-exclusion

我试图证明以下生产者/消费者问题的解决方案不起作用，通过显示当消费者处于 M1 的开头时，有一种情况是它无法在有限范围内使项目出队时间，和/或存在一种情况，即生产者处于 L2 的开头，并且它无法在有限时间内将项目入队。我只是找不到任何例子来证明这一点。

该算法假设有 10 个生产者，10 个消费者，缓冲区大小为 10。

```
nf = 0; // counting semaphore, # of items in queue
bm = 1; // binary semaphore, ensures mutex 
```

制片人

```
L1: Produce(item);
L2: P(bm);
If (queue_is_full) {
  V(bm);
  GoTo L2;
} else {
  Enqueue(item);
  V(bm);
  V(nf);
  GoTo L1;
} 
```

消费者

```
M1: P(nf);
P(bm);
Dequeue(item);
V(bm);
Consume(item);
GoTo M1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T03:33:43.667

如果我的理解是正确的，P(x) 将锁定直到 x != 0 并且 v(x) 总是执行 x++。

在上面的代码中，`M1: P(nf);`只有当队列中的项目可用时才会让消费者通过。然后它总是获取并释放 bm 上的锁。所以我很确定代码不会与其他消费者或生产者陷入僵局。

在生产者中它获取 bm 然后对列表进行操作。它不会在 v(bm) 之前获取任何其他锁，并且它在两个分支中都执行 v(bm)，因此它保证会发生。由于 v(bm) 最终会发生，因此消费者最终可以消费一件物品。在 v(bm) 之后，av(nf) 得到保证，因此当生产一件物品时，一个消费者将尝试最终消费它。

因此，除非有像 listcapacity == 0 这样愚蠢的东西，否则代码看起来不错。

如果消费者做了 P(bm)-> P(nf)-> V(bm) 会有问题，但上面的代码看起来不错

# java - 禁用蓝牙声音输出

> ID：16043237
> 
> 赞同：2
> 
> 时间：2013-04-16T17:22:09.100
> 
> 标签：java, android, audio, bluetooth

我正在编写一个应用程序来监视通知流的音量设置（使用广播接收器进行`android.media.VOLUME_CHANGED_ACTION`- 我知道的一种黑客攻击），当它设置为静音时，我想阻止我的蓝牙耳机响铃但不断开它，这样，如果我选择接听电话（它会振动或我看到它在响铃），我可以通过我的蓝牙耳机接听电话。

到目前为止，我已经尝试将语音流、蓝牙流（通过提供`int 6`）、设置`setBluetoothScoOn(false)`、使用`stopBluetoothSco()`和静音前面提到的流静音，但似乎没有任何效果。我已经获得了修改音频的权限，所以我开始认为这是不可能的。

有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T04:43:29.430

连接蓝牙耳机时，使用 HFP 协议发送来电通知，该协议仅在内部发送某些 AT 命令（电话到耳机），让耳机知道来电，设置 SCO ON/OFF 会将通话音频转至耳机/电话，振铃内置于蓝牙耳机

# java - 找不到 Java 运行时环境说 ArgoUML

> ID：16043250
> 
> 赞同：8
> 
> 时间：2013-04-16T17:22:57.840
> 
> 标签：java, argouml

我已经在我的系统中正确安装了 jdk，我也正确设置了 CLASSPATH，但是当我安装 ArgoUML 时，它显示一条 Message the **No JRE found**，我该怎么办？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-05-14T16:22:46.607

我也遇到了这个问题，正确安装了 x64 JRE 8u45。不知道 Windows exe 安装程序是否需要 x86 jvm？

无论如何，请`binary package`从以下位置下载 zip~~[底格里斯*（死）*](http://argouml-downloads.tigris.org/argouml-0.34/)~~ [GitHub](https://github.com/argouml-tigris-org/argouml/releases/download/VERSION_0_35_1/ArgoUML-0.35.1.zip)在某处发布并解压缩。它从那里运行良好 * with `argouml.bat`，您只是没有添加开始菜单条目。

*   编辑：您的 PATH 必须正确才能找到 java.exe，简单的检查方法是打开一个新的 Cmd shell（开始 > 运行... > cmd）并键入`java -version`您应该从 jvm 得到一些东西

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T17:25:41.213

检查是否`JAVA_HOME`设置了环境变量（它应该包含您的 JRE 安装到的目录）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-12-31T12:26:31.537

我在WIN7_X64上有同样的问题。

我已经手动安装了，这里有一些步骤：

*   下载[argouml-0.34 压缩文件](http://argouml-downloads.tigris.org/argouml-0.34/)
*   将存档解压缩到 install_dir 例如：（`C:\Program Files (x86)\ArgoUML-0.34`使其对所有用户可见）
*   使用以下信息创建快捷方式`ArgoUML`：`C:\ProgramData\Microsoft\Windows\Start Menu\Programs`

**目标：** “`install_dir\argouml.jar"`例如：`"C:\Program Files (x86)\ArgoUML-0.34\argouml.jar"`

**开始于：** `"install_dir"`例如：`"C:\Program Files (x86)\ArgoUML-0.34"`

**更改图标...：**浏览至`install_dir\ArgoUML.ico`Ex：`C:\Program Files (x86)\ArgoUML-0.34\ArgoUML.ico`

> 您可以使用`argouml.bat`，但上述步骤绰绰有余。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-08-13T06:42:16.897

我先安装了[windows x64](https://i.stack.imgur.com/qlhdm.png)，但是没有用。

然后我[离线安装了windows x86](https://i.stack.imgur.com/9N8Fj.png)，它工作了。简单的！

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-08-17T12:13:12.677

首先从 oracle.com 安装 86 位 jre(Windows x86 Offline)，然后尝试安装 ArgoUML。我认为它会工作。它对我有用。获取下面的 jre 和 ArgoUML 下载链接。

jre链接-

[https://www.oracle.com/java/technologies/javase-jre8-downloads.html](https://www.oracle.com/java/technologies/javase-jre8-downloads.html)

ArgoUML 链接-

[https://argouml.en.softonic.com/download](https://argouml.en.softonic.com/download)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-05-23T20:17:47.367

我可以通过首先安装 Java x86/32 位 JRE 来使用安装程序

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2020-11-27T15:54:27.470

1.  首先安装jre-8u271-windows-x641.exe
2.  安装 argouml
3.  卸载 jre-8u271-windows-x641.exe
4.  移动到文件夹：C:\Users\nameuser\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\ArgoUML 右键单击​​ ArgoUML 然后目标下的属性：“C:\Program Files\Java\jdk-15\bin \javaw.exe "-Xms64m -Xmx512m -jar" C:\Program Files (x86)\ArgoUML\argouml.jar "指定你的jdk me我的bin路径是C:\Program Files\Java\jdk-15\bin \javaw.exe
5.  执行文件（双击）.bat：C:\Program Files (x86)\ArgoUML\argouml.bat

# asp.net - 4.5 中的异步：取消和超时

> ID：16043254
> 
> 赞同：3
> 
> 时间：2013-04-16T17:23:09.903
> 
> 标签：asp.net, vb.net, async-await, asp.net-4.5

我在 HTTPHandler 中有一个长时间运行的进程，我使用 Async Await .net 4.5 异步执行

这可以按预期完美运行...

**如何添加超时，以便在处理时间过长时返回字符串“超时”？**

```
Protected Async Sub button1_Click(sender As Object, e As System.EventArgs)
    Dim asyncHandler = New AsyncHandler
    Await asyncHandler.ProcessRequestAsync(HttpContext.Current)
    Response.Write(asyncHandler.Result)
End Sub

Public Class AsyncHandler
    Inherits HttpTaskAsyncHandler

    Public Property Result As String

    Public Async Function ProcessRequestAsync(context As HttpContext) As Task
        Me.Result = Await DoLongRunningProcessAsync(context)
    End Function

    Private Function DoLongRunningProcessAsync(context As HttpContext) As Task(Of String)

        'TODO: add a timeout so that if this takes too long we return "timeout":

        Return Task.Run(Of String)(Function() DoLongRunningProcess(context))

    End Function

    Private Function DoLongRunningProcess(context As HttpContext) As String
        'perform long running process....

        Return "success"
    End Function

End Class 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:03:46.633

**这是我最终实现的：**

创建了一个超时值 x 毫秒的 CancellationToken

添加了一个 try catch 来捕获错误：OperationCanceledException

```
Public Async Function ProcessRequestAsync(context As HttpContext) As Task
        Dim cts As CancellationTokenSource = New CancellationTokenSource(30000) 'eg: 30 seconds
        Try
            Me.ResultCode = Await DoLongRunningProcessAsync(HttpContext.Current, cts.Token)
        Catch ex As OperationCanceledException
            Me.ResultCode = "timeout"
        End Try
End Function 
```

将 CancellationToken 传递给 DoLongRunningProcessAsync 方法的签名

通过调用 ThrowIfCancellationRequested 检测超时

```
Private Function DoLongRunningProcessAsync(context As HttpContext, ct As CancellationToken) As Task(Of String)
        Return Await Task.Run(Of String)(
            Function()
                Dim resultCode As String = DoLongRunningProcess(context)

                'detect timeout:
                ct.ThrowIfCancellationRequested()

                Return resultCode
            End Function)
End Function 
```

这是一篇很棒的文章，我发现它真的很有帮助：

[4.5 中的异步：在异步 API 中启用进度和取消](http://blogs.msdn.com/b/dotnet/archive/2012/06/06/async-in-4-5-enabling-progress-and-cancellation-in-async-apis.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:54:03.540

我不结 VB.NET，但我通常在 C# 中执行此操作，如下例所示：

```
CancellationTokenSource cancellationTokenSource = new CancellationTokenSource();

// Make sure that we have a way to cancell long running 
Task<SomeClass> longRunningTask = GetSomethingAsync(cancellationTokenSource.Token);

// One of the task should be finished
if (longRunningTask == await Task.WhenAny(longRunningTask, Task.Delay(30000)))
{
     // Long running task completed
     SomeClass result = await longRunningTask;
}
else
{
     // Task.Delay(30000) was finished
     cancellationTokenSource.Cancel();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T02:11:05.467

通常，支持超时的 TPL 代码通过 @outcoldman 和 @StephenCleary 提到的 CancellationToken(Source) 来实现。但是，在您的场景中，您说您希望超时路径也返回一个字符串，只是一个不同的字符串。

因此，与其使用 CancellationToken(Source)，不如将超时代码视为另一个生成字符串的任务，然后选择首先完成的任务（超时任务或“真实”任务）并返回该字符串，这可能会更简单.

我将您的 DoLongRunningProcess （最里面的函数）更改为异步并返回 Task(Of String) ，这样您就不必执行 Task.Run 了。

'Await Await' 可能看起来很奇怪，但是 Task.WhenAny 返回一个 Task(Of Task(Of T)) 所以第一个 Await 是到达首先完成的特定任务，然后我们等待它以获得实际的字符串结果。

```
Sub Main
    MainAsync().Wait()
End Sub

' Define other methods and classes here
Public Async Function MainAsync As Task
    Dim asyncHandler = New AsyncHandler
    Await asyncHandler.ProcessRequestAsync(System.Web.HttpContext.Current)
    Console.WriteLine(asyncHandler.Result)
End Function

Public Class AsyncHandler
    Inherits HttpTaskAsyncHandler

    Public Property Timeout As TimeSpan = TimeSpan.FromSeconds(10)

    Public Property Result As String

    Public Overrides Async Function ProcessRequestAsync(context As HttpContext) As Task
        Me.Result = Await DoLongRunningProcessAsync(context)
    End Function

    Private Async Function DoLongRunningProcessAsync(context As HttpContext) As Task(Of String)

        'TODO: add a timeout so that if this takes too long we return "timeout":

        Dim workerTask As Task(Of String) = DoLongRunningProcess(context)
        Dim cancelTask As Task(Of String) = DoTimeout()

        Return Await Await Task.WhenAny(workerTask, cancelTask)

    End Function

    Private Async Function DoTimeout() As Task(Of String)
        Await Task.Delay(Timeout)

        Return "timeout"
    End Function

    Private Async Function DoLongRunningProcess(context As HttpContext) As Task(Of String)
        'perform long running process....

        Await Task.Delay(TimeSpan.FromSeconds(15))

        Return "success"
    End Function

End Class 
```

# html - 为什么我的 html 没有链接到我的打印 CSS 样式表？

> ID：16043257
> 
> 赞同：0
> 
> 时间：2013-04-16T17:23:22.890
> 
> 标签：html, css, printing, stylesheet

css我正在尝试使用 css 创建一个打印样式表以连接到我的 html 网页。我在下面添加了样式表行，我的样式表是一个名为 print.css 的 css 文件，与我的 html 文件位于同一目录中。这是我第一次这样做，就程序而言，我做错了什么吗？

感谢您的任何建议

HTML

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="stylesheet" type="text/css" href="print.css" media="print"/>

<style>
   .
   .
   .
</style>

</head> 
```

CSS

```
 <!DOCTYPE html>
 <html>
 <head>
 <style>
 body{
 width: 8000px;
 background-color: #FFFFFF;
  }
  .section{
  width: 2000px;
  float: left;
  height: 100%;
  z-index: 1;
  font-size:20px;
  page-break-after: always;
  page-break-inside: avoid;

  p a:after {
  content: " (" attr(href) ")";
  font-size: 50%;
   }
 </style>
 </head>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:36:17.607

CSS 文件不能包含 HTML。这是您的 print.css 文件应包含的所有内容：

```
body{
    width: 8000px;
    background-color: #FFFFFF;
}

.section{
    width: 2000px;
    float: left;
    height: 100%;
    z-index: 1;
    font-size:20px;
    page-break-after: always;
    page-break-inside: avoid;
}

p a:after {
    content: " (" attr(href) ")";
    font-size: 50%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-08T16:09:13.253

您在 CSS 文件中包含了 HTML，这将不起作用。您需要删除`<!DOCTYPE html> <html> <head> and <style>`标签。

您还忘记了`.section`用右括号关闭您的 css，所以它看起来像这样：

```
.section{
width: 2000px;
float: left;
height: 100%;
z-index: 1;
font-size:20px;
page-break-after: always;
page-break-inside: avoid; } 
```

除此之外，请检查您的 CSS 文件是否与`link`标签中指定的名称相同 - 您可能在某处有拼写错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T17:32:57.717

您对 css 文件的调用中的 href 错误：

您正在调用一个可能不存在的 HTML 文件

```
<link href="print.html" type="text/css" rel="stylesheet" media="print" /> 
```

如果确实存在，则从该 HTML 文件中提取您的 css 并将其放入 CSS 文档中，然后像这样链接到该文件：

```
<link href="print.css" type="text/css" rel="stylesheet" media="print" /> 
```

在该文件中，将您的样式包装在此标签中：

@media print {你的css在这里}

这应该完全符合您的需要。

# sql-server-2008 - 查找最近编译的语句

> ID：16043265
> 
> 赞同：1
> 
> 时间：2013-04-16T17:24:00.290
> 
> 标签：sql-server-2008

在我们的一台 SQL 2008 R2 服务器上，我遇到了与批处理运行数量相关的异常高百分比的编译。通常服务器在这方面运行得有点高（大约占总批次的 25%），但今天它更像是 80%。查看 DMV 向我展示了已编译的内容，但没有告诉我何时发生。

我知道我可以使用分析器提取这些数据（现在正在这样做），但希望能找到存储在历史记录中的某个地方。

有没有人找到一种方法来做到这一点，或者 Profiler 是唯一的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:03:39.600

当然，您可以`creation_time`使用`sys.dm_exec_query_stats`：

```
SELECT * FROM sys.dm_exec_query_stats AS s
  INNER JOIN sys.dm_exec_cached_plans AS p
  ON s.plan_handle = p.plan_handle
  CROSS APPLY sys.dm_exec_sql_text(s.sql_handle)
  ORDER BY creation_time DESC; 
```

# .htaccess - Magento 将 https 重定向到 http 主页

> ID：16043266
> 
> 赞同：0
> 
> 时间：2013-04-16T17:24:02.327
> 
> 标签：.htaccess, http, magento, https, singlepage

谷歌已经用https索引了我网站的主页。但我只需要将 https 重定向到 http 这个页面。我正在使用 Magento，今天我有一条规则可以删除我域的 htaccess www。我创建的将 https 的主页重定向到 http 的每个规则都不起作用。
有人有解决方案吗？
谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:37:50.593

尝试

```
#Redirect your Homepage from HTTPS to HTTP
RewriteCond %{HTTPS} on
RewriteRule ^$ http://%{HTTP_HOST} [L,R] 
```

请参阅[http://www.activo.com/redirect-https-to-http-for-any-homepage/](http://www.activo.com/redirect-https-to-http-for-any-homepage/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:42:12.743

**首先在 Magento 中进行设置：**

打开管理面板并访问**`System -> Configration -> Web panel`**并设置：

*   基本 URL（不安全）为`http://www.domain.com/magento/`.

*   基本 URL（安全）为`https://www.domain.com/magento/`.

然后设置：

*   在前端使用安全 URL = 是

*   保存您的设置，清除您的 Magento 缓存

**最后在 Magento 的 .htaccess 中在 RewriteBase 行下面添加这些行：**

```
RewriteCond %{HTTPS} off
RewriteRule (?!^(index\.php/?|.*\.css|.*\.js|.*\.gif|.*\.jpe?g|.*\.png|.*\.txt|.*\.ico|)$)^ https://%{HTTP_HOST}%{REQUEST_URI} [R=302,L]

RewriteCond %{HTTPS} on
RewriteRule ^(index\.php/?|.*\.css|.*\.js|.*\.gif|.*\.jpe?g|.*\.png|.*\.txt|.*\.ico|)$ http://%{HTTP_HOST}%{REQUEST_URI} [R=302,L,NC] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-07T13:21:18.263

将此与谷歌索引器的 301 http 请求一起使用。

```
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}/$1 [R=301,L] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-22T06:36:02.187

如果您使用 includeflare，则此重定向不起作用

在您的 htaccess 文件及其 cloudflare 格式上尝试以下内容

**Http 到 Https 重定向：**

```
 RewriteCond %{HTTP:CF-Visitor} '"scheme":"http"'
 RewriteRule ^(.*)$ https://www.domain.com/$1 [L] 
```

**见说明：**

在 CloudFlare 中使用灵活 SSL 时，您的源服务器将始终接受通过 HTTP（端口 80）的请求。为了正确重定向通过 HTTPS 安全上网的用户，您应该修改重写规则以使用 CF-Visitor HTTP 标头。CF-Visitor 标头包含以下内容：

```
CF-Visitor: {"scheme":"http"} 
```

或
CF 访问者：{"scheme":"https"}

要将用户从 HTTP 重定向到 HTTPS，可以使用以下命令：

```
RewriteCond %{HTTP:CF-Visitor} '"scheme":"http"'
RewriteRule ^(.*)$ https://www.domain.com/$1 [L] 
```

同样，要要求 CloudFlare 上的所有流量都通过 HTTPS，您可以使用以下命令：

```
RewriteCond %{HTTP:CF-Visitor} !'"scheme":"http"'
RewriteRule ^(.*)$ https://www.domain.com/$1 [L] 
```

# facebook - 如何使用 Facebook 登录将用户登录到我的服务？

> ID：16043273
> 
> 赞同：0
> 
> 时间：2013-04-16T17:24:30.720
> 
> 标签：facebook, facebook-login

我希望用户使用 Facebook 登录来登录我的应用程序（它有自己的服务器端）。

我考虑过让用户登录，然后将访问令牌发送到我的服务器（当然使用 SSL）

然后我的服务器将在 Facebook 前检查该访问令牌的用户 ID（这样我就知道它是一个有效的访问令牌）。

这是做这种事情的正确方法吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:30:46.937

以下是 facebook 本身的说明。 [https://developers.facebook.com/docs/howtos/login/server-side-login/](https://developers.facebook.com/docs/howtos/login/server-side-login/)

# javascript - 不给我指路

> ID：16043275
> 
> 赞同：0
> 
> 时间：2013-04-16T17:24:37.653
> 
> 标签：javascript, google-maps

我可能不明白它是如何工作的，但是如果我输入`@Model.name`其中会找到一个地址（只是为了您的测试目的而编造一个），下面的 javascript 应该会找到我，找到目的地并找到我的方向。

但事实并非如此。为什么不呢？没有控制台错误。

```
 function success(position) {
    var s = document.querySelector('#status');

    if (s.className == 'success') {
        // not sure why we're hitting this twice in FF, I think it's to do with a cached result coming back    
        return;
    }

    s.innerHTML = "found you!";
    s.className = 'success';

    var mapcanvas = document.createElement('div');
    mapcanvas.id = 'mapcanvas';
    mapcanvas.style.height = '400px';
    mapcanvas.style.width = '560px';

    document.querySelector('article').appendChild(mapcanvas);

    var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
    var directionsService = new google.maps.DirectionsService();
    var directionsDisplay = new google.maps.DirectionsRenderer();

    var myOptions = {
        zoom: 15,
        center: latlng,
        mapTypeControl: false,
        navigationControlOptions: { style: google.maps.NavigationControlStyle.SMALL },
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };

    var map = new google.maps.Map(document.getElementById("mapcanvas"), myOptions);

    var marker = new google.maps.Marker({
        position: latlng,
        map: map,
        title: "You are here! (at least within a " + position.coords.accuracy + " meter radius)"
    });

    var request = {
        origin: latlng,
        destination: '@Model.id',
        travelMode: google.maps.DirectionsTravelMode.DRIVING
    };

    directionsService.route(request, function (response, status) {
        if (status == google.maps.DirectionsStatus.OK) {
            directionsDisplay.setDirections(response);
        }
    });
}

function error(msg) {
    var s = document.querySelector('#status');
    s.innerHTML = typeof msg == 'string' ? msg : "failed";
    s.className = 'fail';

    // console.log(arguments);
}

if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(success, error);
} else {
    error('not supported');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:03:26.190

您必须`map`为`directionsDisplay`

# algorithm - prefix similarity search

> ID：16043278
> 
> 赞同：3
> 
> 时间：2013-04-16T17:24:44.050
> 
> 标签：algorithm, postgresql, fuzzy-search

I am trying to find a way to build a fuzzy search where both the text database and the queries may have spelling variants. In particular, the text database is material collected from the web and likely would not benefit from full text engine's prep phase (word stemming) I could imagine using pg_trgm as a starting point and then validate hits by Levenshtein. However, people tend to do prefix queries E.g, in the realm of music, I would expect "beetho symphony" to be a reasonable search term. So, is someone were typing "betho symphony", is there a reasonable way (using postgresql with perhaps tcl or perl scripting) to discover that the "betho" part should be compared with "beetho" (returning an edit distance of 1)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T16:23:49.353

我最终得到的是对通用算法的简单修改：通常我会从矩阵或向量对中获取最后一个值。参考[http://en.wikipedia.org/wiki/Levenshtein_distance](http://en.wikipedia.org/wiki/Levenshtein_distance)中的“迭代”算法，我将要探测的字符串作为第一个参数，将查询字符串作为第二个参数。现在，当算法完成时，结果列中的最小值给出了正确的结果

示例结果：查询“fantas”，数据库中的单词“fantasy”，“fantastic” => 0 查询“fantas”，数据库中的单词“fan” => 3

编辑距离的输入是从基于三元相似度的“大多数单词”列表中选择的单词

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:45:46.477

您可以修改编辑距离算法，为字符串的后半部分赋予较低的权重。

例如：对于每个 i&j，Match(i,j) = 1/max(i,j)^2 而不是 Match(i,j)=1。（i 和 j 是您要比较的符号的位置）。

它的作用是：dist('ABCD', 'ABCE') < dist('ABCD', 'EBCD')。

# c# - 通过 mvc4 控制器向信号器发送数据库更改通知

> ID：16043282
> 
> 赞同：0
> 
> 时间：2013-04-16T17:24:55.653
> 
> 标签：c#, .net, asp.net-mvc-4, entity-framework-5, signalr-hub

我使用 ScottGu 在线提供的 NerdDinner 教程创建了一个类似 NerdDinner 的应用程序。我想将 SignalR 添加到我的应用程序中，以便每次创建新晚餐时，应更新主页上显示的晚餐值。

我的 HomeController 中有一个 create 方法

```
 [HttpPost]
    public ActionResult Create(Dinner dinner)
    {
        if (ModelState.IsValid)
        {
            nerdDinners.Dinners.Add(dinner);

            nerdDinners.SaveChanges();
        }
        return RedirectToAction("Index");
    } 
```

我的 Hub 类如下：

```
[HubName("DinnerHub")]
public class NewDinnerHub : Hub
{
    int dinnerCount = 0;
    NerdDinners.Models.NerdDinners nerdDinners = new NerdDinners.Models.NerdDinners();

    public void SendDinnerNumber(int no_of_dinners)
    {
        var dinners = from d in nerdDinners.Dinners
                      select d;
        dinnerCount = dinners.ToList().Count();
        no_of_dinners = dinnerCount;
        IHubContext context = GlobalHost.ConnectionManager.GetHubContext<NewDinnerHub>();
        context.Clients.All.getDinnerNumber(this.Context.ConnectionId, no_of_dinners);
    }

} 
```

这是我的 index.cshtml

```
@model IEnumerable<NerdDinners.Models.Dinner>

<h2>Index</h2>

<h1>Upcoming Dinners</h1>
<ul>
@foreach(var d in Model) {
<li>
    @Html.DisplayFor(modelItem => d.Title)
    @Html.DisplayFor(modelItem => d.EventDate)
 </li>
 }
 </ul>
<p>
    @Html.ActionLink("Create New", "Create")
</p>
<p>
    @Html.Label("Number_of_Dinners","Number of Dinners : ") <label id="No_of_Dinners" />
</p>
<table>
    <tr>
        <th>
            Title
        </th>
        <th>
            EventDate
        </th>
        <th>
            Address
        </th>
        <th>
            HostedBy
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Title)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.EventDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Address)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.HostedBy)
        </td>
        <td>
            @Html.ActionLink("Edit", "Edit", new { id=item.DinnerID }) |
            @Html.ActionLink("Details", "Details", new { id=item.DinnerID }) |
            @Html.ActionLink("Delete", "Delete", new { id=item.DinnerID })
        </td>
         </tr>
    }

</table> 
```

我的 index.cshtml 中的 javascript 也在下面

```
<script>
    $(function () {

        var hub = $.connection.DinnerHub;
        $No_of_Dinners = $("#No_of_Dinners");

        hub.client.getDinnerNumber = function (connectionId, no_of_dinners) {
            $No_of_Dinners.text = no_of_dinners;
        };

        $.connection.hub.start().done(function () {
            hub.server.sendDinnerNumber($No_of_Dinners);
        });

    });
</script>

<script src="../../Scripts/jquery-1.7.1.js"></script>
<script src="../../Scripts/jquery-ui-1.8.20.js"></script>
<script src="../../Scripts/jquery.signalR-1.0.1.js"></script>
<script src="/signalr/hubs"></script> 
```

我不确定出了什么问题。每当添加新晚餐时，我都需要使用数据库中的晚餐数量更新我的“No_of_Dinners”标签。另外，我正在使用 .Net MVC4，我不想将我的模式更改为 MVVM。我在网上看到的所有例子都是 MVVM。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T15:55:27.003

I solved the problem. I wasn't working properly because I did not have my Route.MapHubs() method above RegisterRoutes(). Also, I had to delete bundles/jquery from _Layout.cshtml

# c# - 将 WinForm 应用程序转换为 WPF ViewModel

> ID：16043283
> 
> 赞同：2
> 
> 时间：2013-04-16T17:24:56.897
> 
> 标签：c#, wpf, mvvm

我正在使用 MVVM 模式将一个简单的 WinForm 应用程序转换为 WPF。我的偏爱实现的视图模型代码如下。我被困住了`showPath(string path)`，`addFile(string file)`因为他们正在使用 WPF 控件。我怎样才能克服这个问题？

```
class DirectorySearchModel
{
    /*-- invoke on UI thread --------------------------------*/

    void showPath(string path)
    {
        //textBlock1.Text = path;
        //return path;
    }
    /*-- invoke on UI thread --------------------------------*/

    void addFile(string file)
    {
        //listBox1.Items.Add(file);
    }
    /*-- recursive search for files matching pattern --------*/

    void Search(string path, string pattern)
    {
        /* called on asynch delegate's thread */
        if (System.Windows.Application.Current.Dispatcher.CheckAccess())
            showPath(path);
        else
            System.Windows.Application.Current.Dispatcher.Invoke(
              new Action<string>(showPath), DispatcherPriority.Background, new string[] { path }
            );
        string[] files = Directory.GetFiles(path, pattern);
        foreach (string file in files)
        {
            if (System.Windows.Application.Current.Dispatcher.CheckAccess())
                addFile(file);
            else
                System.Windows.Application.Current.Dispatcher.Invoke(new Action<string>(addFile), DispatcherPriority.Background,
                  new string[] { file }
                );
        }
        string[] dirs = System.IO.Directory.GetDirectories(path);
        foreach (string dir in dirs)
            Search(dir, pattern);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:28:24.233

> 我怎样才能克服这个问题

您将创建两个属性 - 一个`ObservableCollection<string>`用于文件名（what is `listBox1`）和一个`string`（它也在集合上引发`PropertyChanged`）用于路径（what is `textBlock1`）。然后视图将绑定到这些属性。

这些方法只需要设置路径并添加到集合中，视图就会自动更新。

# php - Yii 参数条件（PHP 框架）

> ID：16043284
> 
> 赞同：1
> 
> 时间：2013-04-16T17:24:59.390
> 
> 标签：php, yii

我是 yii 世界的新手，尽我所能学习框架，同时阅读*Jeffrey Winesett的关于 Yii 的书 - '* **Web Application Development Using Yii and PHP** ' ，

 *我碰到 ：

```
'params'=>array(':projectId'=>$this->_project->id) 
```

如果有人读过这本书，有人可以解释为什么我们使用*:projectId*为什么不直接使用*projectId*？**':' 代表什么？**它是特定的语法还是特定于php的东西。

这是确切的代码：

```
public function actionIndex()
    {

        $dataProvider=new CActiveDataProvider('Issue', array(
            'criteria'=>array(
                'condition'=>'project_id=:projectId',
                'params'=>array(':projectId'=>$this->_project->id),
            ),
        ));
        $this->render('index',array(
            'dataProvider'=>$dataProvider,
        ));
    } 
```

任何答案将不胜感激。问候。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:34:32.653

":" id 用于标识条件字符串中的参数。这是一种安全地将参数绑定到 sql 语句的方法。

在您的情况下，当您指定此条件时

```
project_id=:projectId 
```

在你的数据库模式中，Yii 知道 project_id 是一个整数，然后当你绑定参数时：

```
'params'=>array(':projectId'=>$this->_project->id), 
```

Yii 将确保您绑定一个整数并为其编写 SQL 语句并生成如下 SQL 语句：`project_id=26`

这与字符串 ex. 相同：

```
 'criteria'=>array(
            'condition'=>'name=:myname',
            'params'=>array(':myname' => 'Ronald McDonald'),
        ), 
```

那么您针对此条件的 sql 语句将是`name='Ronald McDonald'`*

# c# - 从 C# 中的 List 或 HashSet 中删除重复项

> ID：16043288
> 
> 赞同：2
> 
> 时间：2013-04-16T17:25:20.457
> 
> 标签：c#, list, hashset, duplicate-removal

我有一个非常简单的测试方法，它返回一个包含许多重复项的列表，但是当它没有时我想我会尝试 HashSet 因为它应该删除重复项，但看来我需要覆盖 Equals 和 GetHashCode 但我是真的很难理解我需要做什么。我会很感激一些指示。

```
HashSet<object> test = XmlManager.PeriodHashSet(Server.MapPath("../Xml/XmlFile.xml"));
foreach (Object period in test2)
{
    PeriodData pd = period as PeriodData;
    Response.Write(pd.PeriodName + "<br>");
} 
```

我也尝试了以下

```
List<object> test = XmlManager.PeriodList(Server.MapPath("../Xml/XmlFile.xml"));
List<object> test2 = test.Distinct().ToList();
foreach (Object period in test2)
{
    PeriodData pd = period as PeriodData;
    Response.Write(pd.PeriodName + "<br>");
} 
```

PeriodData 对象的 delcarewd 如下：

```
public class PeriodData
{
    private int m_StartYear = -9999999;
    private int m_EndYear = -9999999;
    private string m_PeriodName = String.Empty;

    public int StartYear
    {
        get { return m_StartYear; }
        set { m_StartYear = value; }
    }
    public int EndYear
    {
        get { return m_EndYear; }
        set { m_EndYear = value; }
    }
    public string PeriodName
    {
        get { return m_PeriodName; }
        set { m_PeriodName = value; }
    }
} 
```

这是我要删除重复的返回的 PeriodName 。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:30:59.633

为了使`HashSet<T>`工作，您至少需要覆盖`Object.Equals`和`Object.GetHashCode`。这就是允许散列算法通过值知道是什么使两个对象“不同”或相同的原因。

在简化和改进代码方面，我建议进行两项主要更改以使其工作：

首先，您应该使用`HashSet<PeriodData>`(或`List<PeriodData>`)，而不是`HashSet<object>`.

其次，你的`PeriodData`类应该实现[`IEquatable<PeriodData>`](http://msdn.microsoft.com/en-us/library/ms131187.aspx)以提供正确的散列和相等性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:49:49.963

你必须决定是什么让两个时期相等。如果两个周期的所有三个属性都必须相同才能相等，那么您可以这样实现 Equals：

```
public override bool Equals(object obj)
{
    if (ReferenceEquals(null, obj)) return false;
    if (ReferenceEquals(this, obj)) return true;
    if (obj.GetType() != this.GetType()) return false;
    PeriodData other = (PeriodData)obj;
    return m_StartYear == other.m_StartYear && m_EndYear == other.m_EndYear && string.Equals(m_PeriodName, other.m_PeriodName);
} 
```

对于 GetHashCode，您可以执行以下操作：

```
 public override int GetHashCode()
    {
        return (((m_StartYear * 397) ^ m_EndYear) * 397) ^ m_PeriodName.GetHashCode();
    } 
```

（归功于应得的：这些改编自 ReSharper 的代码生成工具生成的代码。）

正如其他人所指出的，最好也实施`IEquatable<T>`。

如果你不能修改类，或者你不想修改它，你可以将相等比较逻辑放在另一个实现的类中`IEqualityComparer<PeriodData`，你可以将它传递给适当的构造函数`HashSet<PeriodData>`和`Enumerable.Distinct()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:30:55.773

您必须实施[`IEquatable<T>`](http://msdn.microsoft.com/en-us/library/ms131187.aspx)才能使 Distinct() 工作。

如果你不知道，框架怎么知道如何说“*这两个对象是相同的”？*您必须为框架提供一种比较对象的方法，这就是`IEquatable<T>`实现的目的。

# shell - 无法在终端暂停 nano

> ID：16043291
> 
> 赞同：8
> 
> 时间：2013-04-16T17:25:34.290
> 
> 标签：shell, unix, terminal, signals

尝试在这里学习如何使用终端。

所以我可以使用 ctrl-z 来暂停其他进程，但由于某种原因它在 nano 中不起作用。为什么会这样？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-09-15T16:05:58.073

我一直在寻找解决方案，而接受的答案对我没有帮助。

`set suspend`在 ~/.nanorc 中设置有效！

[http://www.nano-editor.org/dist/v2.2/nanorc.5.html](http://www.nano-editor.org/dist/v2.2/nanorc.5.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T17:28:38.360

这可以通过屏蔽 SIGTSTP 信号轻松完成：

```
#include <signal.h>

signal(SIGTSTP,SIG_IGN); /* disable ctrl-Z */ 
```

显然，这就是 nano 正在做的事情。

如果您希望 nano 允许您使用 ctrl-z 暂停它，您可以输入以下代码：

```
set suspend 
```

进入你的`$HOME/.nanorc`.

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-05-21T14:26:11.467

如果你输入`nano -z`它也可以。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2021-04-01T11:35:30.860

如果 ctrl 不起作用，请尝试使用 ctrl + x。

# ios - Programmatically determining rendered NSString dimensions and offsets

> ID：16043293
> 
> 赞同：2
> 
> 时间：2013-04-16T17:25:40.007
> 
> 标签：ios, objective-c, uilabel, uifont

Framing this question as directly and with as much information as possible, so as to allow a definitive answer. There's even a picture!

I have a simple subclass of `UILabel` (subclassed to allow rendering of stroked text).

Header:

```
//  svCustomNumeralLabel.h

#import <UIKit/UIKit.h>

@interface svCustomNumeralLabel : UILabel

@property UIFont *customFont;
@property CGPoint drawPoint;

@end 
```

Complete implementation:

```
#import "svCustomNumeralLabel.h"

@implementation svCustomNumeralLabel

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        [self initialize];
    }
    return self;
}

-(id)initWithCoder:(NSCoder *)aDecoder{
    self = [super initWithCoder:aDecoder];
    if (self) {
        [self initialize];
    }
    return self;
}

-(void)initialize{
    self.customFont =  [UIFont fontWithName:@"Forgotten Futurist" size:200.0];
    self.drawPoint = CGPointMake(-10.0,-39.0);

    float capHeight = self.customFont.capHeight;
    NSLog(@"Cap height: %f", capHeight);
}

- (void)drawRect:(CGRect)rect
{

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextSetRGBFillColor(context, 1.0, 1.0, 1.0, 1.0);//RGBA
    CGContextSetRGBStrokeColor(context, 0.0, 0.0, 0.0, 1.0);
    CGContextSetTextDrawingMode(context, kCGTextFillStroke);

    float descender = self.customFont.descender;
    float ascender = self.customFont.ascender;

    NSLog(@"Ascender: %f descender: %f", ascender, descender);

    CGSize frameSize = self.frame.size;
    NSLog(@"Frame width: %f height: %f", frameSize.width, frameSize.height);

    CGSize unDrawnSize = [self.text sizeWithFont:self.customFont];
    NSLog(@"Undrawn width: %f height: %f", unDrawnSize.width, unDrawnSize.height);

    CGSize drawnSize = [self.text drawAtPoint:self.drawPoint withFont:self.customFont];
    NSLog(@"Drawn width: %f height: %f", drawnSize.width, drawnSize.height);

} 
```

I've put an instance of this class into a `UIView` in Interface Builder. The `svCustomNumeralLabel`'s view has been manually sized in IB to 80.0 width, 127.0 height.

I've set the value of `self.drawPoint` in the `initialize()` method by trial-and-error, to its current value of `(-10.0, -39.0)`.

The result, with these manually set and hard-wired values, is a nice numeral, exactly positioned within its container frame (which for clarity is set to have a gray background):![svCustomNumeralLabel screengrab](https://i.stack.imgur.com/sdb1e.png)

The `NSLog` output from the run above:

```
Cap height: 126.600006
Ascender: 165.601562 descender: -58.400002
Frame width: 80.000000 height: 127.000000
Undrawn width: 100.000000 height: 229.000000
Drawn width: 99.200005 height: 229.000000 
```

# My question

How could I have programmatically determined the value of self.drawPoint to achieve this result, ie the '0' character rendered at the exact top-left?

Secondary question: how can I compute a correct value for the precise width and height of the character, as actually rendered, to facilitate fitting it nice and snug in its view?

As you can see from the `NSLog` outputs, there appears to be very little information available that bears much resemblance to the actual numeral as drawn. The only metric that correlates with frame dimensions is `UIFont.capHeight`. There appears to be no information that I could reliably use to determine the `(-10.0, -39.0)` offset value of `self.drawPoint`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:42:37.950

您可以在 CGFont 级别了解有关字体的所有信息：

[https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGFont/Reference/reference.html](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGFont/Reference/reference.html)

在更深层次上，您可以使用 Core Text：

[http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Operations/Operations.html#//apple_ref/doc/uid/TP40005533-CH4-SW20](http://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/CoreText_Programming/Operations/Operations.html#//apple_ref/doc/uid/TP40005533-CH4-SW20)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:36:07.237

AppKit 为 Foundation Framework 提供了一些不错的补充`NSString`：[NSString UIKit Additions](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html)

特别感兴趣：`- (CGSize)sizeWithFont:(UIFont *)font`和相关的方法。

# python - 使用 scipy.sparse.csc_matrix 代替 numpy 广播

> ID：16043299
> 
> 赞同：11
> 
> 时间：2013-04-16T17:26:15.987
> 
> 标签：python, numpy, scipy, sparse-matrix

我的代码中有以下表达式：

```
a = (b / x[:, np.newaxis]).sum(axis=1) 
```

其中`b`是形状的 ndarray `(M, N)`，并且`x`是形状的 ndarray `(M,)`。现在，`b`实际上是稀疏的，所以为了提高内存效率，我想用`scipy.sparse.csc_matrix`or代替`csr_matrix`。然而，以这种方式广播并没有实现（即使除法或乘法保证保持稀疏性）（的条目`x`非零），并引发 a `NotImplementedError`. 有没有`sparse`我不知道的功能可以满足我的要求？（`dot()`将沿错误的轴求和。）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T20:47:26.090

如果`b`是 CSC 格式，则`b.data`具有 的非零条目`b`，并且`b.indices`具有每个非零条目的行索引，因此您可以按以下方式进行除法：

```
b.data /= np.take(x, b.indices) 
```

它比 Warren 的优雅解决方案更 hack，但在大多数情况下它可能也会更快：

```
b = sps.rand(1000, 1000, density=0.01, format='csc')
x = np.random.rand(1000)

def row_divide_col_reduce(b, x):
    data = b.data.copy() / np.take(x, b.indices)
    ret = sps.csc_matrix((data, b.indices.copy(), b.indptr.copy()),
                         shape=b.shape)
    return ret.sum(axis=1)

def row_divide_col_reduce_bis(b, x):
    d = sps.spdiags(1.0/x, 0, len(x), len(x))
    return (d * b).sum(axis=1)

In [2]: %timeit row_divide_col_reduce(b, x)
1000 loops, best of 3: 210 us per loop

In [3]: %timeit row_divide_col_reduce_bis(b, x)
1000 loops, best of 3: 697 us per loop

In [4]: np.allclose(row_divide_col_reduce(b, x),
   ...:             row_divide_col_reduce_bis(b, x))
Out[4]: True 
```

如果您就地进行除法，则可以在上面的示例中将时间几乎减少一半，即：

```
def row_divide_col_reduce(b, x):
    b.data /= np.take(x, b.indices)
    return b.sum(axis=1)

In [2]: %timeit row_divide_col_reduce(b, x)
10000 loops, best of 3: 131 us per loop 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-16T20:23:41.877

要实施`a = (b / x[:, np.newaxis]).sum(axis=1)`，您可以使用`a = b.sum(axis=1).A1 / x`. 该`A1`属性返回 1D ndarray，因此结果是 1D ndarray，而不是`matrix`. 这个简洁的表达式有效，因为您既要按轴 1 进行缩放`x` *，*又要沿轴 1 求和。例如：

```
In [190]: b
Out[190]: 
<3x3 sparse matrix of type '<type 'numpy.float64'>'
        with 5 stored elements in Compressed Sparse Row format>

In [191]: b.A
Out[191]: 
array([[ 1.,  0.,  2.],
       [ 0.,  3.,  0.],
       [ 4.,  0.,  5.]])

In [192]: x
Out[192]: array([ 2.,  3.,  4.])

In [193]: b.sum(axis=1).A1 / x
Out[193]: array([ 1.5 ,  1\.  ,  2.25]) 
```

更一般地，如果你想用一个向量来缩放一个稀疏矩阵的行`x`，你可以`b`在左边乘以一个包含`1.0/x`在对角线上的稀疏矩阵。该函数`scipy.sparse.spdiags`可用于创建这样的矩阵。例如：

```
In [71]: from scipy.sparse import csc_matrix, spdiags

In [72]: b = csc_matrix([[1,0,2],[0,3,0],[4,0,5]], dtype=np.float64)

In [73]: b.A
Out[73]: 
array([[ 1.,  0.,  2.],
       [ 0.,  3.,  0.],
       [ 4.,  0.,  5.]])

In [74]: x = array([2., 3., 4.])

In [75]: d = spdiags(1.0/x, 0, len(x), len(x))

In [76]: d.A
Out[76]: 
array([[ 0.5       ,  0\.        ,  0\.        ],
       [ 0\.        ,  0.33333333,  0\.        ],
       [ 0\.        ,  0\.        ,  0.25      ]])

In [77]: p = d * b

In [78]: p.A
Out[78]: 
array([[ 0.5 ,  0\.  ,  1\.  ],
       [ 0\.  ,  1\.  ,  0\.  ],
       [ 1\.  ,  0\.  ,  1.25]])

In [79]: a = p.sum(axis=1)

In [80]: a
Out[80]: 
matrix([[ 1.5 ],
        [ 1\.  ],
        [ 2.25]]) 
```

# ruby - 在使用 Nokogiri 解析 Wordpress XML 时搜索标签

> ID：16043301
> 
> 赞同：0
> 
> 时间：2013-04-16T17:26:16.430
> 
> 标签：ruby, xml, wordpress, nokogiri

我有一个包含引号的 Wordpress 博客的 XML 文件：

```
<item>
  <title>Brothers Karamazov</title>
  <content:encoded><![CDATA["I think that if the Devil doesn't exist and, consequently, man has created him, he has created him in his own image and likeness."]]></content:encoded>
  <category domain="post_tag" nicename="dostoyevsky"><![CDATA[Dostoyevsky]]></category>
  <category domain="post_tag" nicename="humanity"><![CDATA[humanity]]></category>
  <category domain="category" nicename="quotes"><![CDATA[quotes]]></category>
  <category domain="post_tag" nicename="the-devil"><![CDATA[the Devil]]></category>
</item> 
```

我要提取的内容是标题、作者、内容和标签。到目前为止，这是我的代码：

```
require "rubygems"
require "nokogiri"

doc = Nokogiri::XML(File.open("/Users/charliekim/Downloads/quotesfromtheunderground.wordpress.2013-04-14.xml"))

doc.css("item").each do |item|
  title   = item.at_css("title").text
  tag     = item.at_xpath("category").text
  content = item.at_xpath("content:encoded").text

  #each post will later be pushed to an array, but I'm not worried about that yet, so for now....
  puts "#{title} #{tag}"
end 
```

我正在努力从每个`item`. 我得到了类似的回报`Brothers Karamazov Dostoyevsky`。我不担心它的格式，因为它只是一个测试，看看它是否正确地拾取东西。有人知道我该怎么做吗？

我还想制作大写 = Author 的标签，所以如果你知道怎么做，它也会有所帮助，尽管我还没有尝试过。

* * *

编辑：我将代码更改为：

```
doc.css("item").each do |item|
  title   = item.at_css("title").text
  content = item.at_xpath("content:encoded").text
  tag     = item.at_xpath("category").each do |category|
        category
  end

  puts "#{title}: #{tag}"
end 
```

返回：

```
Brothers Karamazov: [#<Nokogiri::XML::Attr:0x80878518 name="domain" value="post_tag">,     #<Nokogiri::XML::Attr:0x80878504 name="nicename" value="dostoyevsky">] 
```

这似乎更易于管理。它搞砸了我从大写标签中获取作者的计划，但是，这没什么大不了的。我怎么能只拉第二个`value`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T02:01:35.793

当方法只返回第一个结果时，您正在使用`at_xpath`并期望它返回多个结果。`at_`

你想要这样的东西：

```
tags = item.xpath("category").map(&:text) 
```

这将返回一个数组。

至于识别作者，您可以使用正则表达式选择以大写字母开头的项目：

```
author = tags.select{|w| w =~ /^[A-Z]/} 
```

它将选择任何大写的标签。这使标签保持不变。如果您想将作者与标签分开，您可以使用`partition`：

```
author, tags = item.xpath("category").map(&:text).partition{|w| w =~ /^[A-Z]/} 
```

请注意，在上述示例中，作者是一个数组，将包含所有匹配项（即多个大写标签）。

# web - 为数据门户选择哪个开源 Web 框架？

> ID：16043303
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:26:20.787
> 
> 标签：web, frameworks, open-source

我的组织需要开发一个与此类似的数据门户：http: [//dataportal.afdb.org/](http://dataportal.afdb.org/)但是提供了众多可用的 Web 框架和语言，我被要求查询合适的。

我们希望使用一个干净、开源、可扩展且灵活的 Web 框架，但最重要的是我们可以非常快速地开发我们的门户。

你会推荐哪个 Web 框架，为什么？

非常感谢。

卡洛斯。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-16T18:35:40.010

那么您提供的链接[http://dataportal.afdb.org/default.aspx](http://dataportal.afdb.org/default.aspx)似乎正在运行 .Net 语言（因此是 .aspx 扩展名）。这也可以在后端包含 C#，这对于数据量大的应用程序来说是一个不错的选择。

通过挖掘源代码，我看到他们也在使用 WebResource.axd，这可能是指在[http://www.asp.net/ajax](http://www.asp.net/ajax)找到的 .Net 代码使用 Ajax 库。

我还在那里看到了 JQuery，但 JavaScript 框架几乎是任何 Web 应用程序的要求。

我会开始查看这些资源，看看你的项目需要什么。还请记住，如果您必须在现有服务器上运行您的应用程序，则有 Microsoft 与 Linux 语言。.Net、C# 和 ajax.net 库都存在于 Microsoft 世界中，因此它们无法在原生的 Linux 服务器上运行。

作为旁注，我是[Node.js](http://nodejs.org/)的巨大推动者，用于高度交互和/或数据繁重的应用程序，因此如果您从头开始构建，它将是一个非常有用的框架。

# php - 如何在没有 PHP 的情况下从 2 个 MySQL 表构建一个新的 MySQL 表

> ID：16043304
> 
> 赞同：0
> 
> 时间：2013-04-16T17:26:22.683
> 
> 标签：php, mysql

我有 2 个表我想合并到第三个表中我想纯粹作为 MySQL 查询而不是选择行并使用 PHP while() 来构建第三个表。

表 1 包含以下内容

```
ID Name
1  A
2
3 
```

表 2 包含以下内容

```
ID  Desc
10
15  B
20 
```

我想编写一个查询语句来生成以下组合表，但我只希望新的 Desc 包含表 1 中的 Name 或表 2 中的 Desc 中的非空白值，在事件中表 2 优先于表 1两个表都包含一个非空白

```
ID1 ID2 Desc
1   10  A
1   15  B
1   20  A
2   10
2   15  B
2   20
3   10
3   15  B
3   20 
```

这可以作为 MySQL 查询吗？我应该使用 PHP 方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:46:18.963

```
insert into TableThree (id1, id2, Descr)
select
    T1.id,
    T2.id,
    case LENGTH(TRIM(T2.Descr))
        when 0 then T1.Name
        else T2.Descr
    end
from TableOne T1, TableTwo T2
order by 1, 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:32:47.687

想想，你需要这个...

```
select t1.id as id1, t2.id as id2, if(length(t2.name), t2.desc, t1.name) as desc from t1,t2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:34:16.793

你可以这样做：

SELECT a.ID as ID1, b.ID as ID2, (CASE WHEN b.Desc is not null THEN b.Desc ELSE a.Name END) as Desc from Table1 a full join Table2;

但这是未经测试的......祝你好运。

问候

副歌

# ruby - How to use plain ruby instead of YAML

> ID：16043307
> 
> 赞同：1
> 
> 时间：2013-04-16T17:26:33.967
> 
> 标签：ruby

With the 1.9 syntax ruby hashes and YAML are pretty close. I was wondering what ways there are of using a ruby file to retrieve some data.

Given that our `config.rb` is something like

`{ api: "My key", name: "name" }`

### Option 1

Read and eval the file

`config = eval open('./config.rb').read`

### Option 2

Require the file and then reference a variable

The config.rb file changes to the following (note `CONFIG`)

`CONFIG = { api: "My key", name: "name" }`

And then we can do

```
require './config'

# ...
config = CONFIG 
```

Are there any other ways of doing this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:38:33.297

Mark Ba​​tes 的配置器是我认为您正在寻找的一个很好的例子。查看他的代码，了解他如何使用 Ruby 通过 YAML 进行配置。

[https://github.com/markbates/configatron](https://github.com/markbates/configatron)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:04:01.817

您不能执行选项 2。选项 1 很容易完成。但是使用yaml会更好。

# php - 谁能帮我删除操作 php mysql ajax jquery

> ID：16043308
> 
> 赞同：-2
> 
> 时间：2013-04-16T17:26:36.670
> 
> 标签：php, mysql, jquery

我正在创建一个运行良好的评论系统，但删除按钮不执行任何操作我正在使用 php mysql jquery ajax 我花了过去 3 个小时试图弄清楚如何修复此错误并使其正常工作，但这并没有发生在我身上

所以任何人都可以帮助我

# 评论框.php

```
 <div class="comment-buttons-holder">
            <ul>
                <li id="<?php echo $comment->comment_id; ?>" class="delete-btn">X</li>
             </ul>
          </div> 
```

# comment_delete.js （这是我正在学习的地方，这个测试没有显示任何内容）

```
$(document).ready(function() {
     $('.delete-btn').each(function() {
        var btn = this;
        $(btn).click(function(){
           console.log( "this id: " + btn.id );
        });
    }); 
}); 
```

# 评论删除.php

```
 <?php
     if(isset($_POST['task']) && $_POST['task'] == 'comment_delete')
      {
        require_once('../includes/db_connect.php'); 

        //echo "i am in the server side and i heard that you want delete";

         require_once('../models/comments.php');

          if(class_exists('comments'))
          {
              if(Comments::delete($_POST['comment_id']))
              {
                  echo "true";
              }

          }
          echo "false";

      }
    ?> 
```

# 这是评论类（包含删除功能）

```
<?php
require_once('subscribers.php'); 

class Comments
{
     public static function getComments()
     {
         $output = array();
         $sql = "select * from comments order  by comment_id desc";
         $query = mysql_query($sql);

         if($query)
         {
             if(mysql_num_rows($query) > 0)
             {
                 while($row = mysql_fetch_object($query))
                 {
                     $output[] = $row;
                 }
             }
         }   
         return $output;
     }
     // return stdClass object  from the database
     public static function insert($comment, $userId)
     {
         //  insert data into database 
         $comment = addslashes($comment);
         $sql = "insert into comments values('', '$comment', '$userId')";
         $query = mysql_query($sql);

         if($query)
         {
             $insert_id = mysql_insert_id();

             $std = new stdClass();
             $std->comment_id = $insert_id;
             $std->comment = $comment;
             $std->userId =(int)$userId;

              return $std;
         }
         return null;

     }
     public static function update($data)
     {

     }
     public static function delete($commentId)
     {

         $sql = "delete from comments where comment_id=$commentId";
         $query = mysql_query($sql);
         if($query)
         {
             return true;
         }
         return null;
     }

}

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:36:13.317

试试这个

```
$(document).ready(function() {
     $('.delete-btn').click(function(){
           console.log( "this id: " + $(this).attr('id') );
        });
    }); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:36:37.617

以下是如何对`bind`jquery 对象集上的事件执行函数：

```
$(document).ready(function() {
    $('.delete-btn').bind('click', function() {
         console.log( "this id: " + btn.id );
    });
}); 
```

处于文档就绪状态。

# c# - 如何选择复选框并在文本框中显示值以及未选中复选框时不显示值

> ID：16043317
> 
> 赞同：1
> 
> 时间：2013-04-16T17:27:03.573
> 
> 标签：c#, asp.net

我创建了一个`Checkboxlist`和`Button`两个`TextBoxes`。

在选择`checkboxes`和按下的第一个值时，`button`我想在其中一个中显示它，`textboxes`当我取消选中时，`checkboxes`我希望该值从该值中消失`textboxes`。

```
if (CheckBoxPersonalInfo.Items[0].Selected)
            {
                LabelFirstName.Text = CheckBoxPersonalInfo.Items[0].Text;
            }
            else
            {
                LabelFirstName.Text = "";
            }

            if (CheckBoxPersonalInfo.Items[1].Selected)
            {
                LabelLastName.Text = CheckBoxPersonalInfo.Items[1].Text;
            }
            else
            {
                LabelLastName.Text = "";
            } 
```

此代码工作正常，但取消选中 LabelFirstName.Text & LabelLastName.Text = ""; 不要空着

更新

```
private void ButtonOKCheckBoxes()
    {
        EMPLOYEE theEmpl;
        using (var db = new knowitCVdbEntities())
        {
            theEmpl = (from p in db.EMPLOYEES
                       where p.username == strUserName
                       select p).FirstOrDefault();
        }

        if (theEmpl != null)
        {
            PanelFullCv.Visible = true;
            LabelPleaseRegister.Visible = false;
            //CheckBoxPersonalInfo.Items[0].Text;
            if (CheckBoxPersonalInfo.Items[0].Selected)
            {
                LabelFirstName.Text = theEmpl.firstname;
            }
            else
            {
                LabelFirstName.Text = "";
            }
            //CheckBoxPersonalInfo.Items[1].Text;
            if (CheckBoxPersonalInfo.Items[1].Selected)
            {
                LabelLastName.Text = theEmpl.lastname;
            }
            else
            {
                LabelLastName.Text = "";
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:39:47.307

您可以使用该[`CheckedListBox.ItemCheck`](http://msdn.microsoft.com/en-in/library/system.windows.forms.checkedlistbox.itemcheck.aspx)事件来监视 Item 的 Checked 和 Unchecked 状态。

```
private void Form1_Load(object sender, EventArgs e)
{
    checkedListBox1.ItemCheck += CheckedListBox1_ItemCheck;

}

private void CheckedListBox1_ItemCheck(object sender, ItemCheckEventArgs e)
{
    if (e.NewValue == CheckState.Unchecked)
    {
        textBox1.Text = string.Empty;
        textBox2.Text = string.Empty;
    }
}        

private void button1_Click_1(object sender, EventArgs e)
{
    if (checkedListBox1.SelectedIndex > -1)
    {
        // set the data on text box
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:41:38.140

首先，您应该**真正**尝试遵循一些[命名准则](http://msdn.microsoft.com/en-us/library/xzf533w0%28v=vs.71%29.aspx)。像类一样命名控件是一种非常糟糕的做法。

你可以这样尝试：

```
displayButton.Click += (s,e) => { 
displayTxtBox.Text = checkBoxPersonalInfo.SelectedItem.ToString(); 
};

checkBoxPersonalInfo_ItemCheck += (s,e) => { 
if (e.NewValue == CheckState.Unchecked)
displayTxtBox.Clear();
}; 
```

把这两个事件都放在你的`form_Load`里面，他们会做的是：

*   `displayButton.Click`- 单击按钮时，所选项目将显示在文本框中。
*   `checkBox.CheckedChanged`- 取消选中复选框时，文本框将被清除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:00:36.187

在此方法中使用 !IsPostBack

```
void page-load()
    {
    if(!IsPostBack)
    {
         //Call your CheckBoxList Binding method   
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-16T17:39:38.023

if 条件下的 -1 和 0 确实令人困惑。代码的最后一部分是否应该嵌套在 if 部分中？

也许你需要类似的东西：

```
if (CheckBoxPersonalInfo.Items[0].selected)
{
   LabelFirstName.Text = theEmpl.firstname;
}
else 
{
    LabelFirstName.Text = "";
}
if (CheckBoxPersonalInfo.Items[1].selected)
{
    LabelLastName.Text = theEmpl.lastname;
}
else 
{
    LabelLastName.Text = "";
} 
```

# iframe - 带有 iFrame 的 Meteor 0.6.1 版本 - 无法调用 parent.function

> ID：16043319
> 
> 赞同：0
> 
> 时间：2013-04-16T17:27:11.463
> 
> 标签：iframe, meteor

```
<a href="#" onclick="parent.test()">Test Method</a> 
```

这在 0.5.9 中有效。在 0.6.1 中失败，出现错误“caught TypeError: Object [object global] has no method 'test'”。test() 在客户端文件夹的 .js 文件中定义。在 0.6.1 中，.js 文件中的所有代码似乎都被包装到一个匿名函数中。解决方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T00:53:33.963

从 6.0 版开始，Meteor 将每个文件的代码包装到一个函数中，以防止全局命名空间污染。如果要跨文件共享变量，则必须从变量声明中删除“var”。

如果您使用咖啡脚本，请为您的变量使用@。

# python - 将 wlst 命令重定向到 python 脚本中的文件

> ID：16043320
> 
> 赞同：1
> 
> 时间：2013-04-16T17:27:12.153
> 
> 标签：python, redirect, directory, append, wlst

在 python 脚本中有一个带有这样参数的命令

ThreadDump('true', '位置', 服务器名)

上面的命令是一个 wlst 命令，它为该服务器获取线程转储，并将转储文件重定向到该位置以及该位置中的该文件。

但是 ThreadDump() 是在从 1 到 6 的 for 循环中，因此线程转储必须发生 5 次，并且每次转储信息都必须附加到文件中。

使用 >& 选项将 python 文件的整个输出尝试到另一个文件，但问题是有一个 CRON 作业正在运行，并且原始转储信息正在被新信息重写。

所以，只需要重定向并附加上面的命令

ThreadDump('true', 'location', 'servername') 到文件 >> /dir/newdir/file

或 ThreadDump('true', 'location', 'servername') 到文件 >& /dir/newdir/file

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:05:25.990

如果您可以使用文件中的 threaddump 重定向脚本的输出，并且唯一的问题是运行此脚本的 cron 作业，请尝试编辑 crontab 以在其中添加 >>（2>&1 用于将 stderr 重定向到 stdout）：

```
*/15 * * * * /path/to/shell/script.sh >> /www/logs/script.log 2>&1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:49:35.073

使用原始代码示例会更容易理解，但我认为也许你可以做类似的事情

```
import os
import fileinput

for i, whatever in enumerate(list_of_threads_or_something):
     ThreadDump('true', 'location' + str(i), servername)
     # do whatever else you need to do

locations = ['location'+str(i) for i in range(6)]
with fileinput.input(locations) as f, open('location', 'w') as fout:
    for line in f:
        fout.write(line)

for loc in locations:
    os.remove(loc) 
```

`'location'`根据需要更改

# mysql - 每次堆栈启动时如何引导 RDS MySQL 创建表？

> ID：16043321
> 
> 赞同：4
> 
> 时间：2013-04-16T17:27:12.303
> 
> 标签：mysql, amazon-web-services, amazon-rds, amazon-cloudformation

我正在尝试从 Cloudformation 引导我的 RDS。我在这里使用了模板[https://s3.amazonaws.com/cloudformation-templates-us-east-1/RDS_MySQL_55.template](https://s3.amazonaws.com/cloudformation-templates-us-east-1/RDS_MySQL_55.template)。

我可以从 cfn-create-stack 创建 RDS，但我希望实例在`changelog`每次创建新堆栈时都有用于 dbdeploy 的表。我找不到引导新堆栈的方法。

由于安全原因，我也无法从我的计算机上运行 mysqladmin。

任何建议将不胜感激。非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T04:02:07.590

这是一种廉价的黑客攻击，可能不是最好的答案，但我认为它会起作用。您可以使用该表创建数据库的 RDS 快照，但该表为空，然后将其[DBSnapshotIdentifier](http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html#cfn-rds-dbinstance-dbsnapshotidentifier)添加到 CloudFormation模板。快照充当模式映像，您的所有附属数据库都可以基于该模式映像。

# jquery - 从由 Ajax 填充的 Dropbox 中的已选择项目中获取 .val()（在源代码中为空白！）

> ID：16043330
> 
> 赞同：0
> 
> 时间：2013-04-16T17:27:37.163
> 
> 标签：jquery, ajax, cakephp

我的表格中有 3 个字段：州、市和区；

当我选择州时，城市下拉框会填充相关数据。然后我需要自动完成区域作为参数传递 cityID

这是看起来的样子：

```
$(document).ready(function()     {
    $('#AdDistrict').autocomplete(
    {

    source: "autocomplete/fetch?model=district&field=name&city=" + $("#AdCityId").val(),
    minLength: 2
    });
  }); 
```

但那`$("#AdCityId").val()`是空白的，如果我查看源代码，我什么也没有看到，`<options>`但出现在页面上。

我试过用

```
$("#AdCityId").val(), 
$("#AdCityId option:selected").val() 
```

但我总是得到“未定义”。我认为问题是因为在源代码中，我的选择看起来像这样：

```
<div class="input select required"><label for="AdCityId">City</label><select name="data[Ad][city_id]" id="AdCityId">
<option value="">Selecione a Cidade</option>
</select></div> 
```

有什么提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:36:52.263

[您可以像这个问题](https://stackoverflow.com/questions/3399139/jquery-possible-to-dynamically-change-source-of-autocomplete-widget)一样在城市下拉菜单的 onchange 事件中设置 .autocomplete() 源

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:37:49.220

```
 <option value="">Selecione a Cidade</option> 
```

该选项的值设置为“”，因此它完全返回该值。如果您想要中间的文本将其更改为

```
 <option>Selecione a Cidade</option> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:30:37.737

在这种情况下，使用函数作为源是有意义的。

```
source: function(request,response) {
    $.ajax({
        url: "autocomplete/fetch?model=district&field=name&city=" + $("#AdCityId").val(),
        data: { term: request.term },
        type: "get",
        dataType: "json",
        success: function(data){
            response(data);
        }
    });
} 
```

# visual-studio-2012 - tSQLt 项目无法在 Visual Studio 2012 中构建

> ID：16043332
> 
> 赞同：3
> 
> 时间：2013-04-16T17:27:45.480
> 
> 标签：visual-studio-2012, tsqlt

我有许多使用 tSQLt 在 Visual Studio 2010 中正确构建的数据库项目。当我在 Visual Studio 2012 中打开它们时，我被告知 IDE 必须进行“功能更改”才能使用它们。

一旦我让转换通过，就没有一个数据库项目能够成功构建。相反，似乎 tSQLt 架构中的任何对象都会引发有关 sys.objects 的错误，如下所示：

```
{Path}.Database.Messages\Schema Objects\Schemas\tSQLt\
Programmability\Functions\Private_GetConstraintType.function.sql(6,10):
Error:  SQL71501: Function: [tSQLt].[Private_GetConstraintType] has an 
unresolved reference to object [sys].[objects]. 
```

转换似乎没有以任何方式更改命名脚本。这是怎么回事？（以及如何调查这样的问题。这很神秘。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-25T18:30:28.137

tSQLt 函数**[tSQLt].[Private_GetConstraintType]**从位于**msdb**系统数据库中的**sys.objects中选择。**

 **您需要将对**msdb**（或**master**）数据库的数据库引用添加到 Visual Studio 2012（数据工具）中的数据库项目中。

为此，请转到*解决方案->项目->参考->添加数据库参考*（见下面的屏幕截图）

![在此处输入图像描述](https://i.stack.imgur.com/5olyB.png)

并添加对系统数据库**msdb**的引用。这应该会有所帮助。

![在此处输入图像描述](https://i.stack.imgur.com/j9IDf.png)**

# remote-desktop - 终端服务丢弃消息

> ID：16043333
> 
> 赞同：1
> 
> 时间：2013-04-16T17:27:51.717
> 
> 标签：remote-desktop, terminal-services

有一个通过终端服务/远程桌面服务虚拟通道 API 进行通信的应用程序。随机且周期性地（大约每 20,000 条消息），客户端将发送一条消息（VirtualChannelWrite 返回 0，并使用 CHANNEL_EVENT_WRITE_COMPLETE 调用 VirtualChannelOpenEvent），但服务器调用 WTSVirtualChannelRead 永远不会读取该消息。服务器上没有错误消息。客户端写入没有时间差异的迹象。

在服务器端，虚拟通道只能从一个线程访问进行读写，因此不是线程问题（WTSVirtualChannelRead 和 WTSVirtualChannelWrite 不是线程安全的）。

任何人都了解导致丢失消息的原因？

我想知道这个 API 是否根本无法针对高密度的客户端到服务器流量进行扩展（从未见过从服务器到客户端的丢弃消息）。[根据MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383852%28v=vs.85%29.aspx)，我想知道服务器上的重叠 I/O 解决方案是否会表现得更好：“WTSVirtualChannelQuery 返回一个文件句柄，您可以使用它来执行异步（重叠）读写操作”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-22T17:18:07.130

Angry Coder 的[回答](https://stackoverflow.com/a/16458107/281650)是正确的，您必须使用 Overlapped I/O。我找到了一个在细节上略有不同的解决方案：

首先，正如我在问题中提到的，只要在同一个线程中调用 WTSVirtualChannelRead() 和 WTSVirtualChannelWrite()，它们通常就可以工作。但是 WTSVirtualChannelRead() 仍然偶尔会丢失消息。显然解决方法是[阻止 1 秒](http://www.codeproject.com/Articles/16374/How-to-Write-a-Terminal-Services-Add-in-in-Pure-C?msg=4004413#xx4004413xx)。当您需要写入时不好，但在读取阻塞时不能。

其次，我根据[这篇文章](http://www.codeproject.com/Articles/523355/Asynchronous-I-O-with-Thread-BindHandle)在 .NET 中实现了 Overlapped I/O 。使用I/O完成端口，读取和写入总是在回调方法中完成，因此无需区分是否有数据可用。

第三，不需要实现动态虚拟通道；[这一切都适用于每个虚拟通道客户端 API](http://msdn.microsoft.com/en-us/library/aa383580(v=vs.85).aspx)的静态通道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T09:03:52.447

WTSVirtualChannelRead 和 WTSVirtualChannelWrite API 是微软设计糟糕的 API 之一。

首先，由于异步 I/O，您不能从任何线程使用 WTSVirtualChannelRead() 和 WTSVirtualChannelWrite()。您必须使用 WTSVirtualChannelQuery() 来获取文件句柄，然后通过 ReadFile() 和 WriteFile() 对虚拟通道进行读取和写入。

此外，在读取虚拟通道时，您必须处理您必须处理 ReadFile() 立即返回的情况，因为有可用数据和 ReadFile() 被阻塞，您等待 I/O 完成然后调用 GetOverLappedResult()。

有关更多详细信息，请关注[http://blogs.msdn.com/b/rds/archive/2007/09/20/dynamic-virtual-channels.aspx](http://blogs.msdn.com/b/rds/archive/2007/09/20/dynamic-virtual-channels.aspx)

# php - PHP 计数器重置

> ID：16043334
> 
> 赞同：0
> 
> 时间：2013-04-16T17:27:54.940
> 
> 标签：php, counter, reset

我的 PHP 计数器有问题。我需要计算两个变量，用 | 分隔，但计数器经常重置为`|1`. 我已经使用了该`flock`功能，但它仍然不起作用。此外，有时它不会增加变量的值。

numeri.txt（计数器）：

`5098|561307`

这是 PHP 脚本：

```
$filename="numeri.txt";
$contents=file_get_contents($filename);
$fp=fopen($filename,'a');
if(!flock($fp,LOCK_EX))
{
    while(true)
    {
        usleep(100000);
        if(flock($fp,LOCK_EX))
        {
            break;
        }
    }
}
ftruncate($fp,0);
$contents=explode("|",$contents);
$clicks=$contents[0];
$impressions=$contents[1]+1;
fwrite($fp,$clicks."|".$impressions);
flock($fp,LOCK_UN);
fclose($fp); 
```

如何修复代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:37:34.073

如果您的输出重置为“|1”，则您的 $contents 变量未设置为任何有用的值。

每次也尝试编写 $contents 变量，以便在输出为“|1”的情况下查看它是什么。

我认为 $contents 是问题所在，但是您没有显示最初设置该变量的位置。

# javascript - 如何通过引用设置值对象

> ID：16043336
> 
> 赞同：2
> 
> 时间：2013-04-16T17:27:57.733
> 
> 标签：javascript, object

我想通过引用对象 a`3`来设置值。`a.b`

例子：

```
var a ={};
a.a =1;
a.b =2;
var x = a.b;
alert (a.b);// show 2
x =3;
alert (a.b); // I want to see in this line 3 instead 2. 
```

非常感谢

我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:29:31.930

You can't do that. Since `2` is a primitive, you don't have a reference to it, instead `x` actually has the value `3`.

What you can do is to provide a function that will modify the property of the parent object:

```
var a = {
   a: 1,
   b: 2,
   setB: function(value) {
      this.b = value;
   }
}

a.setB(3);
console.log(a.b); 
```

I think this is cleaner.

To answer your edit, yes, sort of. It depends what you're doing. If you had the following:

```
var a = {
   a: {value: 1},
   b: {value: 2},
};

var x = a.b;
x = {value: 3}; 
```

Then `a.b` would still be `{value: 2}`, because all you have done is made `x` point to a different object. But realize that `x` points to `a.b`, which is an object, so instead, if you do `x.value = 3;`, `a.b` now has `{value: 3}`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:31:40.593

你在 JavaScript 中没有指针，所以你不能简单地这样做。

您通常在 JavaScript 中“替换”指针的方法是使用回调：

```
var a ={};
a.a =1;
a.b =2;
var x = a.b;
alert (a.b);// show 2
var f = function(v){ a.b=v};
f(3);
alert (a.b); // alerts 3 
```

这个回调可以传递给其他函数，并且可能是最接近你在这种语言中想要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:33:57.987

您只能通过引用传递对象。

```
var a = {};
a.a = 1;
a.b = 2;
var x = a;
alert (a.b); // 2
x.b = 3;
alert (a.b); // 3 
```

[**演示**](http://jsfiddle.net/dTzLQ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:51:11.783

当您想要传递对值的引用时，您总是可以使用装箱。现实情况是，您的业务案例将决定什么最适合您。

[什么是装箱和拆箱，权衡取舍是什么？](https://stackoverflow.com/questions/13055/what-is-boxing-and-unboxing-and-what-are-the-trade-offs)

这是一些未经测试的伪代码，但它应该适合您。

您有几个选择，将整个对象视为参考，或者仅对单个原始值进行装箱。

```
var c={}
c.a = null
c.b = null

//set the value of "c"
c = a;

//change the value of the reference
a.b = 100;

//now the reference has been update
alert( c.b );  // equals 100 
```

或者，如果您只想将 int 装箱

```
var boxed_value = {}
boxed_value.total = 100;

var obj_a = {};
obj_a.value_a = boxed_value;

//obj_a.value_a.total = 100;

var obj_b = {};
obj_b.value = boxed_value;

//obj_b.value_a.total = 100
//obj_a.value_a.total = 100

boxed_value.total = 200;
obj_a.value.total = 300;
obj_b.value.total = 400;

//now all values have changed as they are referenced 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T17:37:44.963

再举一个例子

```
 var a ={};
    a.a =1;
    a.b =2;
    var x =function(v){ a.b=v};
    alert (a.b);// show 2
    x(3);
    alert (a.b); 
```

# javascript - 选中单选按钮时 - 显示选择标签部分

> ID：16043339
> 
> 赞同：0
> 
> 时间：2013-04-16T17:28:10.893
> 
> 标签：javascript, wordpress, radio-button, contact-form-7

所以我使用 WordPress 的插件 Contact Form 7，我有这个带有 2 个单选按钮的表单：

```
<input type="radio" name="investorlandlord" value="I'm an Investor">
<input type="radio" name="investorlandlord" value="I'm a Landlord" tabindex="1"> 
```

当我是投资者按钮被选中时，我需要在其下方显示以下下拉菜单：

```
<select name="finance" class="wpcf7-form-control wpcf7-select" id="finance"><option value="Finance Available">Finance Available</option>...</select> 
```

当另一个按钮被选中时，我需要出现这个下拉菜单：

```
<select name="properties" class="wpcf7-form-control wpcf7-select" id="properties"><option value="Number of Properties">Number of Properties</option>...</select> 
```

在 WordPress 中是否有任何简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:08:27.047

我已经在这里使用它解决了这个问题，并且效果很好:)

```
jQuery(function(){
               jQuery("input[name=investorlandlord]").change(function(){          

            if ($(this).val() == "I'm a Landlord") {
            jQuery("#properties").slideDown()
            }
            else {
            jQuery("#properties").slideUp();
            }                                                            
       });
    });
jQuery(function(){
        jQuery("input[name=investorlandlord]").change(function(){          

            if ($(this).val() == "I'm an Investor") {
            jQuery("#finance").slideDown()
            }
            else {
            jQuery("#finance").slideUp();
            }                                                            
});
}); 
```

# java - SolrCloud 设置错误与集合 API NPE

> ID：16043342
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:28:18.013
> 
> 标签：java, solr

我正在尝试设置 SolrCloud 安装，并且我遵循了本指南：[http ://wiki.apache.org/solr/SolrCloudTomcat](http://wiki.apache.org/solr/SolrCloudTomcat)

浏览到任何 solr 实例时，我都会收到此错误消息（如预期的那样）：

```
There are no SolrCores running.
Using the Solr Admin UI currently requires at least one SolrCore. 
```

但是，在涉及 curl 命令的最后一步，我收到以下错误：

```
curl 'http://mysolr1.com:8080/solr/admin/collections?action=CREATE&name=collection&numShards=4&replicationFactor=1'
<?xml version="1.0" encoding="UTF-8"?>
<response>
<lst name="responseHeader"><int name="status">500</int><int name="QTime">11</int></lst><lst name="error"><str name="trace">java.lang.NullPointerException
    at org.apache.solr.handler.admin.CollectionsHandler.handleResponse(CollectionsHandler.java:149)
    at org.apache.solr.handler.admin.CollectionsHandler.handleCreateAction(CollectionsHandler.java:277)
    at org.apache.solr.handler.admin.CollectionsHandler.handleRequestBody(CollectionsHandler.java:112)
    at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)
    at org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:591)
    at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:201)
    at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:141)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:947)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:408)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1009)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722)
</str><int name="code">500</int></lst>
</response> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T05:13:09.510

似乎 Solr 无法通信或 Solr 没有从 ZooKeeper 获得预期的响应。

根据 Solr 4.2.1[源代码](http://svn.apache.org/repos/asf/lucene/dev/tags/lucene_solr_4_2_1/solr/core/src/java/org/apache/solr/handler/admin/CollectionsHandler.java)：

```
Line 149 # QueueEvent event = coreContainer.getZkController()
.getOverseerCollectionQueue()
.offer(ZkStateReader.toJSON(m), DEFAULT_ZK_TIMEOUT); 
```

那么您能否验证一下：

连接到 ZooKeeper 并验证 Solr 配置是否存在（[此参考可能会有所帮助](http://myjeeva.com/solrcloud-cluster-single-collection-deployment.html#uploading-solrconfig-to-zookeeper)）

让我知道结果！

# ruby - 用于 HLS 的开源 AES-128 加密？

> ID：16043343
> 
> 赞同：1
> 
> 时间：2013-04-16T17:28:20.627
> 
> 标签：ruby, encryption, openssl, aes, http-live-streaming

Apple 有一些非常好的工具可以将实体媒体文件分割为 HLS 并添加 AES-128 加密。但是，它们仅在 Mac 上运行，因此在机器在 Linux 上运行的典型云环境中不是很有用。

我正在寻找任何有助于将 AES-128 加密添加到预分段 HLS 的现有工具和库。我不相信这将是超级复杂的实施。我想用 Ruby 编写它。有谁知道任何有用的工具或资源？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:13:22.280

您可以在 Ruby中使用[OpenSSL::Cipher类。](http://www.ruby-doc.org/stdlib-2.0/libdoc/openssl/rdoc/OpenSSL/Cipher.html)由于 OpenSSL 扩展基本上是原生 OpenSSL 的包装器，因此速度非常快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T10:55:20.550

您可以 fork 并执行 openssl 来进行实际加密。您很可能不想在 ruby​​ 中进行 AES 加密，因为它会非常慢。

您可以在此 shell 脚本之后为您的程序建模：[https ://stackoverflow.com/a/3600805/759140](https://stackoverflow.com/a/3600805/759140)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-13T12:58:55.447

FFMPEG可以转码和加密HLS文件

```
ffmpeg -y -i <file in> -hsl_time 10 -hls_key_info_file <key info file> -hls_segment_filename "encrupted-%d.ts" encrypted.m3u 
```

您可以在此处找到更多信息： [FFMPEG 加密](https://stackoverflow.com/questions/32734578/ffmpeg-encryption)

AVCONV 应该也可以，但我还没有让它工作。

# android - NullPointerException with android on loaders/asynctaskloader

> ID：16043346
> 
> 赞同：0
> 
> 时间：2013-04-16T17:28:35.037
> 
> 标签：android, android-asynctask, loader

制作一个 twitter 安卓应用。试图使 OAuth 工作。尝试初始化使用者时出现空指针异常。

这是我的主要活动以及 asynctaskloader 类：

```
public class MainActivity extends FragmentActivity implements LoaderManager.LoaderCallbacks{

final String TAG = getClass().getName();

private OAuthConsumer consumer;
private OAuthProvider provider;
private String token;
private String secret;
private getCommonsHttpOAuthConsumer consumerLoader;

Activity context;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button signInButton = (Button) findViewById(R.id.signInButton);

    signInButton.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            sign_in();
        }
    });     
}

public void sign_in()
{
    try {

        Log.i(TAG, "test");

        this.consumer = (OAuthConsumer) getSupportLoaderManager().initLoader(0, null, this); //here's the error

        Log.i(TAG, "test2");
    } catch (Exception e) {
        Log.e(TAG, "Error creating consumer / provider",e);
    }       
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
public android.support.v4.content.Loader onCreateLoader(int id, Bundle arg1) {
    consumerLoader = new getCommonsHttpOAuthConsumer(context);
    return consumerLoader;
}

@Override
public void onLoadFinished(android.support.v4.content.Loader arg0,
        Object arg1) {
    // TODO Auto-generated method stub

}

@Override
public void onLoaderReset(android.support.v4.content.Loader arg0) {
    // TODO Auto-generated method stub

}

}

class getCommonsHttpOAuthConsumer extends AsyncTaskLoader<OAuthConsumer>{

public getCommonsHttpOAuthConsumer(Context context) {
    super(context);
    // TODO Auto-generated constructor stub
}

@Override
public OAuthConsumer loadInBackground() {
    // TODO Auto-generated method stub

    return new CommonsHttpOAuthConsumer(Constants.CONSUMER_KEY, Constants.CONSUMER_SECRET);
}

} 
```

这是我的日志：

```
04-16 13:03:54.976: I/com.example.twittertestnewapi.MainActivity(22476): test
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476): Error     creating consumer / provider
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476): java.lang.NullPointerException
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.support.v4.content.Loader.<init>(Loader.java:91)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.support.v4.content.AsyncTaskLoader.<init>(AsyncTaskLoader.java:92)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at com.example.twittertestnewapi.getCommonsHttpOAuthConsumer.<init>(MainActivity.java:115)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at com.example.twittertestnewapi.MainActivity.onCreateLoader(MainActivity.java:87)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.support.v4.app.LoaderManagerImpl.createLoader(LoaderManager.java:490)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.support.v4.app.LoaderManagerImpl.createAndInstallLoader(LoaderManager.java:499)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.support.v4.app.LoaderManagerImpl.initLoader(LoaderManager.java:553)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at com.example.twittertestnewapi.MainActivity.sign_in(MainActivity.java:68)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at com.example.twittertestnewapi.MainActivity$1.onClick(MainActivity.java:56)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.view.View.performClick(View.java:4204)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.view.View$PerformClick.run(View.java:17355)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.os.Handler.handleCallback(Handler.java:725)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.os.Handler.dispatchMessage(Handler.java:92)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.os.Looper.loop(Looper.java:137)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at android.app.ActivityThread.main(ActivityThread.java:5041)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at java.lang.reflect.Method.invokeNative(Native Method)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at java.lang.reflect.Method.invoke(Method.java:511)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-16 13:03:54.986: E/com.example.twittertestnewapi.MainActivity(22476):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:48:45.477

您不会初始化`context`与`Loader`. 在`onCreate()`方法中添加：

```
context = this; 
```

# jquery - jQuery Mobile 日期选择器版本问题

> ID：16043348
> 
> 赞同：3
> 
> 时间：2013-04-16T17:28:36.520
> 
> 标签：jquery, jquery-mobile, jquery-plugins, datepicker, datebox

[使用 jquery mobile 的 datepicker ( datepicker](http://jquerymobile.com/demos/1.0a4.1/experiments/ui-datepicker/) )时我遇到了一些问题

当我使用 jQuery 1.5 版本和 jQuery mobile 1.0a4.1 时，日期选择器按预期显示。这是代码：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <link href="~/Content/jquery.ui.datepicker.mobile.css" rel="stylesheet" />
    <link rel="stylesheet"  href="http://code.jquery.com/mobile/1.0a4.1/jquery.mobile-1.0a4.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.5.min.js"></script>
    <script>
        //reset type=date inputs to text
        $(document).bind("mobileinit", function () {
            $.mobile.page.prototype.options.degradeInputs.date = true;
        });
    </script>
    <script src="http://code.jquery.com/mobile/1.0a4.1/jquery.mobile-1.0a4.1.min.js"></script>
    <script src="~/Scripts/jquery.ui.datepicker.js"></script>
    <script src="~/Scripts/jquery.ui.datepicker.mobile.js"></script>

</head>
<body>

    @RenderBody()
    <div data-role="page">

        <div data-role="content">
            <p>Hello world</p>
            <form action="#" method="get">
                    <div data-role="fieldcontain">
                        <label for="date">Date Input:</label>
                        <input type="date" name="date" id="date" value="" />
                    </div>
                </form>
</div>
</body> 
```

但是当我使用 jQuery 1.9.1 和 jQuery mobile 1.3.1 时，它会产生以下错误：

> TypeError: Object [object Object] 没有方法'live' [http://localhost:62799/Scripts/jquery.ui.datepicker.mobile.js:50]

代码：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />

    <link href="~/Content/jquery.ui.datepicker.mobile.css" rel="stylesheet" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script>
        //reset type=date inputs to text
        $(document).bind("mobileinit", function () {
            $.mobile.page.prototype.options.degradeInputs.date = true;
        });
    </script>
    <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
    <script src="~/Scripts/jquery.ui.datepicker.js"></script>
    <script src="~/Scripts/jquery.ui.datepicker.mobile.js"></script>

</head>
<body>

    @RenderBody()
    <div data-role="page">
        <div data-role="content">
            <p>Hello world</p>
            <form action="#" method="get">
                    <div data-role="fieldcontain">
                        <label for="date">Date Input:</label>
                        <input type="date" name="date" id="date" value="" />
                    </div>
                </form>
</div>
</body> 
```

有一些解决方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:52:40.817

基本上你可能使用的是旧版本的**[datepicker](http://jqueryui.com/datepicker/)**。

您的版本仍然使用函数**live**进行事件绑定。在 jQuery 1.9+ 版本中不推荐使用相同的功能。

您有 2 个解决方案：

1.  使用较新版本的**[日期选择器](http://jqueryui.com/datepicker/)**
2.  或者使用 jQuery 版本 1.8.3，因为它仍然具有**实时**功能，并且 jQuery Mobile 可以很好地使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T01:56:05.547

您使用的日期选择器是实验性的，从未被纳入主版本

*   [http://jquerymobile.com/demos/1.0a4.1/experiments/ui-datepicker/](http://jquerymobile.com/demos/1.0a4.1/experiments/ui-datepicker/)

DateBox 是另一种选择，可用于移动设备

*   [http://dev.jtsage.com/jQM-DateBox2/](http://dev.jtsage.com/jQM-DateBox2/)

# vim - 如何在正常模式下录制和/或创建包含字符 'q' 的 vim 宏？

> ID：16043351
> 
> 赞同：4
> 
> 时间：2013-04-16T17:28:56.593
> 
> 标签：vim, macros

众所周知，`q`它用于开始录制和终止录制宏。

不幸的是，我正在尝试记录一系列命令，其中包括 command `q:`，并且宏（自然）在`q`.

有没有办法可以记录一系列命令，包括`q`在正常模式下键入的命令？

更新：我尝试重新映射`q`到其他内容并将另一个字母映射到`q`，但这似乎破坏了`q`我尝试记录的实际命令的功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:47:19.827

您可以执行`:``Ctrl`+`f`打开命令历史记录窗口而不停止录制。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T18:06:00.280

好吧，您已经得到了公认的答案，我只是提到了另一个录制宏的技巧，以便您可以`q:`在宏中拥有：

你可以按`:ctrl-f`，或者如果你真的爱`q:`，你可以：

例如：

```
let @q='5j5kq:<c-v><up><c-v><enter>j' 
```

`5j5k`什么都不做，例如。

`200@q`将在接下来的 200 行中执行最后一个命令。如果您的最后一个命令将一些参数（如当前行号或当前行（文本））传递给函数。它也会起作用。

如果要在宏中编辑命令行，则需要在`<c-v><enter>`按下按键序列之前。

因为`<c-v><up><c-v><enter>`，你真的需要这样输入，而不是纯文本。

但从我的角度来看，普通任务不需要这些技巧。

# javascript - Get the name of an enum in jQuery

> ID：16043355
> 
> 赞同：0
> 
> 时间：2013-04-16T17:29:03.923
> 
> 标签：javascript, jquery, enums, jquery-templates

I have the following jQuery template, which I want to display a drop down list for all the values in an enum. I can get the numeric value of the enum, but not the name. Is it possible to get the name? Below is the important snippets of the code - it displays 4 options in the drop down list, with the correct integer value for "value", but nothing for name. I've tried ${$key} as well, but I'm assuming I'm just missing some syntax?

Javascript enum:

```
var LayoutEnum = Object.freeze(
        {
            NotDefined: 0,
            OneTier: 1,
            TwoTier: 2,
            ThreeTier: 3,
        }); 
```

jQuery template:

```
<script id="Layout_template" type="text/x-jQuery-tmpl">
    <div class="row-fluid">
        <div class="control-group span4">
            <label>Layout:</label>
            <div class="controls">
                <select id="LayoutControl">
                    {{each LayoutEnum }}
                        <option value="${$value}">${$name}</option>
                    {{/each}}
                </select>
            </div>
        </div>
    </div>
</script> 
```

# c# - Update a User Control from MainWindow

> ID：16043357
> 
> 赞同：2
> 
> 时间：2013-04-16T17:29:10.663
> 
> 标签：c#, wpf

First, see this code in the MainWindow

```
 <Grid x:Name="LayoutRoot" MinWidth="900" MinHeight="650" RenderTransformOrigin="0.5,0.5">
        <local:RightSideContent x:Name="rightPanel"  Grid.Column="1"  Width="Auto" Height="Auto"/>

    </Grid> 
```

I create a User Control name RightPanel and name it in MainWindow.xaml *rightPanel*

Example, in the User Control RightPanel has a TextBlock name textblock. Then, and I want to update the TextBlock and I am in MainWindow, I must call `rightPanel.textblock.Text ="..."`.

So I think it is not a good way, because if I am in another Class, so I can't go back to MainWindow to update this textblock, and I can't call a method(static or non) to MainWindow or to RightPanel to update. Once more reason I think it isn't good, anytime you must interactive the MainWindow, instead I think we should send directly the message to RightPanel.

Please help me, thanks and forgive if my English isn't clear enough!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:36:57.607

您可以向`RightSideContent`用户控件添加一个依赖属性来处理文本。这将让您直接从您`MainWindow`的 xaml 绑定到它。

然后，`RightSideContent`用户控件可以将 绑定`textblock.Text`到该依赖项属性，显示那里的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:37:32.587

您可以创建一个名为“Text”的[依赖属性](http://msdn.microsoft.com/en-us/library/ms752914.aspx)，然后将其绑定到 MainWindow 的 DataContext 上的一个属性。

假设您没有遵循 MVVM 模式，您的 MainWindow.cs 中会有一些属性，即代码隐藏。例如：

```
private string _rightSideText = string.Empty;
public string RightSideText
{
    get { return _rightSideText; }
    set
    {
        _rightSideText = value;
        OnPropertyChanged("RightSideText");
    }
} 
```

这假设您已`INotifyPropertyChanged`在 MainWindow 上实现。

然后，在您的 MainWindow XAML 中：

```
<Grid x:Name="LayoutRoot" MinWidth="900" MinHeight="650" RenderTransformOrigin="0.5,0.5">
    <local:RightSideContent Text="{Binding Path=RightSideText}" x:Name="rightPanel"  Grid.Column="1"  Width="Auto" Height="Auto"/>
</Grid> 
```

这假设您已经添加了依赖属性。

完成后，您只需在想要更改文本时设置“RightSideText”即可。

# ms-access - iff command issue in MS Access

> ID：16043361
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:29:25.267
> 
> 标签：ms-access, ms-access-2007, ms-access-2010

Hi I am newbie in MS Access I am using the following expression to calculate the balance of my wallet

```
Balance: Nz(IIf([In]=Yes,Sum([Cost]),0))-Nz(IIf([In]=No,Sum([Cost]),0)) 
```

I want to take difference of two sums, one with [In] = Yes and other with [In] = No, this will tell me the balance of the whole transactions, I have written the fomula given above I dunno why its not working

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:46:27.057

您必须重新排序您的表达式：

```
Balance: Sum(IIf([In]="Yes",Nz([Cost],0)))-Sum(IIf([In]="No",Nz([Cost],0))) 
```

# c++ - 将我自己的函数添加到 OpenCV

> ID：16043367
> 
> 赞同：1
> 
> 时间：2013-04-16T17:29:41.357
> 
> 标签：c++, visual-studio-2010, opencv, cmake

我需要向 OpenCV 2.4.4 添加一种计算连接组件的新方法，以便在我自己的一个项目中使用。我已经有了[这个问题](https://stackoverflow.com/questions/4641817/blob-extraction-in-opencv/10116591#10116591)的函数代码（感谢[jason](https://stackoverflow.com/users/1327999/jason)），我导航到找到代码和标题[的补丁。](http://code.opencv.org/attachments/467/opencv-connectedcomponents.patch)

我所做的是在 中添加一个新文件`connectedcomponents.cpp`，`C:\opencv\modules\imgproc\src`我在其中放置了这个新函数的代码。接下来，我去了`C:\opencv\modules\imgproc\include\opencv2\imgproc`并将适当的导出标头添加到`imgproc.hpp`. 最后，我使用 Visual Studio 2010 在 OpenCV 源代码中重建了`opencv_imgproc`项目。一切正常，并为我生成`opencv_imgproc244.dll`、`opencv_imgproc244.lib`和`opencv_imgproc244.exp`文件。

现在，我将这些文件（除了 .exp，我找不到它应该放在哪里？）复制到我现有的 OpenCV 目录中并替换旧文件。当我现在尝试构建自己的项目时，一切仍然正常，但我无法从这里访问新方法。我包括`#include <opencv2/imgproc/imgproc.hpp>`，从这里我可以访问文件中的所有其他方法，除了我想要的新方法。

一切都编译但方法未公开的事实使我认为还有一些其他文件我也应该更改，但是，由于缺乏经验，我不知道该文件可能在哪里或什么。

额外信息：我正在使用 Visual Studio 2010、OpenCV 2.4.4 并使用 CMake 2.8.10.2 构建 OpenCV 我知道有诸如[cvBlobsLib 之类](http://opencv.willowgarage.com/wiki/cvBlobsLib)的计算连接组件的库，并且我已在我的项目中成功使用了这些库。但是，我想要一个更快和更新的解决方案（cvBlobsLib 仍然使用旧的 IplImage）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T08:07:59.640

所以今天早上用新的眼睛看问题后，我立即发现了我的错误。我**最初所做**的是将新函数的标头代码添加到

`C:\opencv\modules\imgproc\include\opencv2\imgproc\imgproc.hpp`,

但我**应该做**的是将它也添加到

`C:\opencv\build\include\opencv2\imgproc\imgproc.hpp`,

因为这是任何使用 OpenCV 的项目都包含的文件。现在一切都按计划进行。

# iphone - 出现键盘时调整视图大小 (iOS)

> ID：16043371
> 
> 赞同：13
> 
> 时间：2013-04-16T17:30:05.083
> 
> 标签：iphone, ios, ipad, keyboard, landscape-portrait

我意识到有许多类似的解决方案，例如[TPKeyboardAvoiding](https://github.com/michaeltyson/TPKeyboardAvoiding)，[Apple 著名的解决方案](https://developer.apple.com/library/ios/#documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)，以及涉及使用 UIScrollView 的各种建议。就我而言，我需要调整视图的大小以适应键盘，而不是滚动或移动它。[这个解决方案](https://stackoverflow.com/questions/8704137/keeping-object-on-top-of-keyboard-in-the-event-of-becomefirstresponder-or-resign/8704371#8704371)最接近我想要实现的目标，所以这是我的基础。但是，我在使事情在横向模式下工作时遇到问题。我在键盘出现时调整视图大小的方法是：

```
- (void)keyboardWillShow:(NSNotification *)note {
    NSDictionary *userInfo = note.userInfo;
    NSTimeInterval duration = [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] doubleValue];
    UIViewAnimationCurve curve = [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] intValue];

    CGRect keyboardFrame = [[self textField].superview convertRect:[[userInfo objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue] fromView:nil];
    CGRect statusBarFrame = [[self textField].superview convertRect:[UIApplication sharedApplication].statusBarFrame fromView:nil];

    CGRect bounds = [self textField].superview.bounds;    
    CGRect newFrame = CGRectMake(0.0, 0.0, bounds.size.width, keyboardFrame.origin.y + statusBarFrame.size.height);
    [UIView animateWithDuration:duration delay:0 options:UIViewAnimationOptionBeginFromCurrentState | curve animations:^{
        [self textField].superview.frame = newFrame;
    } completion:nil];
} 
```

这在纵向模式下完美运行。

![在此处输入图像描述](https://i.stack.imgur.com/o7Pdw.png)

但是，在横向模式下，视图从左到右或从右到左调整大小取决于设备旋转的方向，而不是从下向上。

![在此处输入图像描述](https://i.stack.imgur.com/R6sU8.png)

显然，我使用坐标的方式有问题，并且在横向模式下，某些参考框架并不是我认为的那样，但我有一段时间在整理如何解决它。我已经尝试使用 -convertRect: 转换各种东西：但我没有尝试让我到任何地方。

我真的希望那些对所有这些矩形以及它们在方向变化时如何变化不那么困惑的人能够发现我做错了什么以及我需要做些什么才能做到这一点。作为参考，我[创建了一个项目](https://github.com/bkocik/KeyboardResize)，展示了重现我遇到的问题的最简单案例。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-16T18:38:21.930

我不建议您为视图控制器调整根视图的大小，您可以创建 contentView 并添加到视图控制器的视图中。您可以按如下方式更改此 contentView 的大小（我不使用自动布局）：

```
- (void)keyboardWillShow:(NSNotification *)note {
    NSDictionary *userInfo = note.userInfo;
    NSTimeInterval duration = [userInfo[UIKeyboardAnimationDurationUserInfoKey] doubleValue];
    UIViewAnimationCurve curve = [userInfo[UIKeyboardAnimationCurveUserInfoKey] integerValue];

    CGRect keyboardFrameEnd = [userInfo[UIKeyboardFrameEndUserInfoKey] CGRectValue];
    keyboardFrameEnd = [self.view convertRect:keyboardFrameEnd fromView:nil];

    [UIView animateWithDuration:duration delay:0 options:UIViewAnimationOptionBeginFromCurrentState | curve animations:^{
        self.contentView.frame = CGRectMake(0, 0, keyboardFrameEnd.size.width, keyboardFrameEnd.origin.y);
    } completion:nil];
}

- (void)keyboardWillHide:(NSNotification *)note {
    NSDictionary *userInfo = note.userInfo;
    NSTimeInterval duration = [userInfo[UIKeyboardAnimationDurationUserInfoKey] doubleValue];
    UIViewAnimationCurve curve = [userInfo[UIKeyboardAnimationCurveUserInfoKey] integerValue];

    CGRect keyboardFrameEnd = [userInfo[UIKeyboardFrameEndUserInfoKey] CGRectValue];
    keyboardFrameEnd = [self.view convertRect:keyboardFrameEnd fromView:nil];

    [UIView animateWithDuration:duration delay:0 options:UIViewAnimationOptionBeginFromCurrentState | curve animations:^{
        self.contentView.frame = CGRectMake(0, 0, keyboardFrameEnd.size.width, keyboardFrameEnd.origin.y);
    } completion:nil];
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-11-18T20:15:47.217

Vitaliy B 的回答很快。我有一个名为 templateHeaderContentView 的视图，我创建了一个函数并在那里配置了视图高度。您使用自己的视图并在那里相应地更改高度。

```
func keyboardWillShow(notification: NSNotification) {
    keyboardShowOrHide(notification)
}

func keyboardWillHide(notification: NSNotification) {
    keyboardShowOrHide(notification)
}

private func keyboardShowOrHide(notification: NSNotification) {
    guard let userInfo = notification.userInfo else {return}
    guard let duration = userInfo[UIKeyboardAnimationDurationUserInfoKey]else { return }
    guard let curve = userInfo[UIKeyboardAnimationCurveUserInfoKey] else { return }
    guard let keyboardFrameEnd = userInfo[UIKeyboardFrameEndUserInfoKey] else { return }

    let curveOption = UIViewAnimationOptions(rawValue: UInt(curve.integerValue << 16))
    let keyboardFrameEndRectFromView = view.convertRect(keyboardFrameEnd.CGRectValue, fromView: nil)
    UIView.animateWithDuration(duration.doubleValue ?? 1.0,
        delay: 0,
        options: [curveOption, .BeginFromCurrentState],
        animations: { () -> Void in
            self.templateHeaderContentView.configureView(keyboardFrameEndRectFromView.origin.y)
        }, completion: nil)
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-24T16:25:07.193

从马嘴里直接覆盖得很好：

[https://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html](https://developer.apple.com/library/ios/documentation/StringsTextFonts/Conceptual/TextAndWebiPhoneOS/KeyboardManagement/KeyboardManagement.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-09T11:07:43.323

我已经做到了，希望这段代码对你有帮助。

```
- (void)viewWillAppear:(BOOL)animated
{
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillShow:)
                                                 name:UIKeyboardWillShowNotification
                                               object:nil];

    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(keyboardWillBeHidden:)
                                                 name:UIKeyboardWillHideNotification
                                               object:nil];
}

- (void)keyboardWillShow:(NSNotification*)notification
{
    [self moveControls:notification up:YES];
}

- (void)keyboardWillBeHidden:(NSNotification*)notification
{
    [self moveControls:notification up:NO];
}

- (void)moveControls:(NSNotification*)notification up:(BOOL)up
{
    NSDictionary* userInfo = [notification userInfo];
    CGRect newFrame = [self getNewControlsFrame:userInfo up:up];

    [self animateControls:userInfo withFrame:newFrame];
}

- (CGRect)getNewControlsFrame:(NSDictionary*)userInfo up:(BOOL)up
{
    CGRect kbFrame = [[userInfo objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue];
    kbFrame = [self.view convertRect:kbFrame fromView:nil];

    CGRect newFrame = self.view.frame;
    newFrame.origin.y += kbFrame.size.height * (up ? -1 : 1);

    return newFrame;
}

- (void)animateControls:(NSDictionary*)userInfo withFrame:(CGRect)newFrame
{
    NSTimeInterval duration = [[userInfo objectForKey:UIKeyboardAnimationDurationUserInfoKey] doubleValue];
    UIViewAnimationCurve animationCurve = [[userInfo objectForKey:UIKeyboardAnimationCurveUserInfoKey] integerValue];

    [UIView animateWithDuration:duration
                          delay:0
                        options:animationOptionsWithCurve(animationCurve)
                     animations:^{
                         self.view.frame = newFrame;
                     }
                     completion:^(BOOL finished){}];
}

static inline UIViewAnimationOptions animationOptionsWithCurve(UIViewAnimationCurve curve)
{
    return (UIViewAnimationOptions)curve << 16;
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-18T05:42:22.050

试试这个方法。根据您的要求对其进行编辑。

```
#define kOFFSET_FOR_KEYBOARD 280.0

- (void)keyboardWillHide:(NSNotification *)notif {
    [self setViewMoveUp:NO];
}

- (void)keyboardWillShow:(NSNotification *)notif{
    [self setViewMoveUp:YES];
}

- (void)textFieldDidBeginEditing:(UITextField *)textField {
    stayup = YES;
    [self setViewMoveUp:YES];
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    stayup = NO;
    [self setViewMoveUp:NO];
}

//method to move the view up/down whenever the keyboard is shown/dismissed
-(void)setViewMoveUp:(BOOL)moveUp
{
    [UIView beginAnimations:nil context:NULL];
    [UIView setAnimationDuration:0.3]; // if you want to slide up the view
    [UIView setAnimationBeginsFromCurrentState:YES];

    CGRect rect = self.view.frame;
    if (moveUp)
    {
        // 1\. move the view's origin up so that the text field that will be hidden come above the keyboard 
        // 2\. increase the size of the view so that the area behind the keyboard is covered up.

        if (rect.origin.y == 0 ) {
            rect.origin.y -= kOFFSET_FOR_KEYBOARD;
            //rect.size.height += kOFFSET_FOR_KEYBOARD;
        }

    }
    else
    {
        if (stayup == NO) {
            rect.origin.y += kOFFSET_FOR_KEYBOARD;
            //rect.size.height -= kOFFSET_FOR_KEYBOARD;
        }
    }
    self.view.frame = rect; 
    [UIView commitAnimations];
} 
```

# c - 使用 c mod 运算符计算硬币面额

> ID：16043374
> 
> 赞同：0
> 
> 时间：2013-04-16T17:30:11.800
> 
> 标签：c, operator-keyword, modulus

我被教导如何使用 c 中的 mod 运算符来计算硬币面额的找零，例如：如果给定 22 美元，并且需要计算出 22 中有多少 10 美元、5 美元、2 美元和 1 美元，那么：

```
22/10 = 2 of $10
22%10 = 2
Therefore since only $2 left:
2/5 = 0
2%5 = 2
2/2 = 1 of $2
2%2 = 0 
So 2 $10 and 1 $2. 
```

我的问题是，我究竟如何才能将其编写为代码，以便它适用于任何给定数量的更改？我仍然是初学者，所以我遇到了一些困难。我感谢任何帮助，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:34:13.763

因此，如果纸币/硬币的最大值为 10 美元（如果这听起来微不足道，很抱歉，但我不是美国公民）：

```
int vals[] = { 10, 5, 2, 1 };
int amount = 22;

for (int i = 0; i < sizeof(vals) / sizeof(vals[0]); i++) {
    printf("%d piece of $%d\n", amount / vals[i], vals[i]);
    amount %= vals[i];
} 
```

# android - 在android apk的不同活动中加载.so文件时的内存共享

> ID：16043375
> 
> 赞同：0
> 
> 时间：2013-04-16T17:30:18.783
> 
> 标签：android, c, shared-libraries

我在一个 apk 中有两个独立的 Android 活动。这两个活动都加载了一个 source.so 文件。我的问题是，对于`int c;`生成 .so 文件的 c 文件中的全局变量，这是否`int c`在这两个活动之间共享？如果更改为两个应用程序而不是两个活动，情况会有所不同吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:36:53.103

> 这两个活动之间是否共享此 int c？

它应该是。该变量对您的流程是全局的。

> 如果更改为两个应用程序而不是两个活动，情况会有所不同吗？

是的，因为两个应用程序通常在不同的进程中运行。

# c - 字符串到十进制的转换

> ID：16043377
> 
> 赞同：0
> 
> 时间：2013-04-16T17:30:25.287
> 
> 标签：c, string, serial-port, decimal

我正在使用 RS232 串行通信来旋转电机。串行通信是在字符串中完成的，但我需要十进制值。任何线索如何继续。我正在用 c 语言编码。我尝试使用 atoi 函数，但它不起作用。

```
char *p; 
```

`int z=atoi(p);`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:37:49.983

使用`strtoXXX()`函数族。如果您需要`int`,`long`或`long long`它们的未签名变体：

```
long l = strtol("1234567", NULL, 10);
long long ll = strtoll("1234567", NULL, 10);
unsigned long l = strtoul("1234567", NULL, 10); 
```

如果你需要一个`float`, `double`, 或者`long double`使用这个：

```
float f = strtof("3.1415927", NULL);
double d = strtod("3.1415927", NULL); 
```

手册[在这里](http://pubs.opengroup.org/onlinepubs/009696699/functions/strtol.html)和[这里](http://pubs.opengroup.org/onlinepubs/009695399/functions/strtod.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:34:46.053

通常给出一个字符串：

```
char * myStr= "123"; 
```

将其值作为 int 获取的方法是：

```
int value=atoi(myStr); 
```

需要注意的一些重要事项：

以下包括是必要的：

```
#include <stdlib.h> 
```

并且您必须确保您的字符串是一个以空字符结尾的字符串，否则 atoi 会使您的程序崩溃。

您没有给我们太多信息，但如果您正在编写微控制器（我怀疑因为您告诉我们电机），您可能不想使用 stdlib。在这种情况下，您可能已经使用了 costum 函数。

请看下面的代码：

```
int stringToInt(char* nrStr){
int nrChars=0;
while(nrStr[nrChars]!='\0'){
    nrChars++;
}

int result=0;
int i=0;
while(nrStr[i]!='\0'){//while you dont get to the end of the string
    int digit=nrStr[i]-48;//48 is zero ascii code
    int exp=nrChars-i-1;
    int add=digit*power(10,exp);
    result+=add;
    i++;

}
return result;

}
int power(int base, int exp){
int ret=1;
int i;
for(i=0;i<exp;i++){
    ret*=base;
}
return ret;
} 
```

这不使用任何库函数并完成工作。我已经在 3 分钟内完成了它，它可能有一些小错误，它不是很有效并且不会验证可能的错误，但原则上如果你将一个格式良好的整数作为空终止字符串传递给 strinToint 函数，它将输出正确的价值。

如果您使用的库确实具有某种幂函数实现，请使用它而不是我给您的库，因为它根本没有效率。

最后一点：如果您出于某种原因需要在其他基础上使用它，比如说八进制，您必须选择以下行：

```
int add=digit*power(10,exp); 
```

至：

```
 int add=digit*power(8,exp); 
```

对于十六进制，这将不起作用，并且此类功能的实现将有很大不同。

# java - Java 中 XOR 编码的 gamma 生成模糊不清

> ID：16043378
> 
> 赞同：1
> 
> 时间：2013-04-16T17:30:32.977
> 
> 标签：java, security, encryption

我正在编写一个 java 应用程序，它将被编译成机器代码。此应用程序将使用 XOR 加密对一些数据进行编码。该操作的 Gamma 是在应用程序内部生成的。我不能随机生成它，因为另一个应用程序必须对信息进行解码，并且无法将伽玛从第一个应用程序发送到第二个应用程序。因此，我需要一些使用第二个应用程序将提供的密钥来生成伽玛的方法。问题是这个算法可能会使用调试器找到。我想让它尽可能难，关于如何做到这一点的任何想法？

PS。我一直在考虑创建需要参数并使用大量系统资源的不同 java 对象。之后我会在他们身上使用 getBytes() 。这将在调试器中产生大量附加代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:28:05.097

与其尝试实现自己的加密技术，不如尝试使用内置库让您的生活更轻松。`javax.crypto`由于您要发送到自己的服务器，因此请使用和`java.security`包设置 RSA 加密。

这个 StackOverflow 答案谈到在 Java 中使用 RSA：[https ://stackoverflow.com/a/2027694/2216621](https://stackoverflow.com/a/2027694/2216621)

如果您不熟悉 RSA，请在 wikipedia 上阅读：[http://en.wikipedia.org/wiki/RSA_(algorithm)](http://en.wikipedia.org/wiki/RSA_(algorithm))

您的基本策略将是创建一个公钥/私钥对，并将公钥放入客户端应用程序中。然后使用公钥加密数据，然后将其发送到服务器。在那里，您将使用私钥解密数据。

# c# - 更改数据库中的对象

> ID：16043387
> 
> 赞同：0
> 
> 时间：2013-04-16T17:31:16.070
> 
> 标签：c#, database

我正在努力将属性更改（实际上添加）到我的数据库中已经存在的对象。

在我的数据库中，我有`Scenario`对象，每个`Scenario`对象都与（一个或多个）`SceneWriter`对象链接。`SceneWriter`现在我想`Scenario`用给定的`ScenarioID`.

这是我尝试这样做的方法：

```
string filmID = comboBox1.SelectedValue.ToString();
        Scenario newScenario = new Scenario();
        foreach (Scenario scenario in scenarioes)
        {
            string thisID = scenario.filmID.ToString();
            if (thisID.Equals(filmID))
            {
                try
                {
                    // remove old scenario from DB
                    myDatabase.Scenario.Remove(scenario);
                    myDatabase.SaveChanges();

                    // add new scenario to DB, which now contains new scenewriter
                    newScenario = scenario;
                    scenario.SceneWriter.Add(newScenewriter); // this newScenewriter I fetched before
                    myDatabase.Scenario.Add(newScenario);
                    myDatabase.SaveChanges();
                }
                catch (Exception ec)
                {
                    MessageBox.Show(ec.ToString());
                }
            }
        } 
```

但是，当我尝试从中删除此`Scenario`记录时，它给了我一个错误`myDatabase`，因为它与其他一些表链接。

所以我需要的是**不删除**任何记录，而是**更改**它（只需添加这个`SceneWriter`），最好是在里面`myDatabase`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:35:49.990

您可以只更新对象

```
string filmID = comboBox1.SelectedValue.ToString();
Scenario newScenario = new Scenario();
foreach (Scenario scenario in myDatabase.Scenario
    .Where(scn => scn.filmID.ToString().Equals(filmId))
{
    scenario.SceneWriter.Add(newScenewriter);before
}

myDatabase.SaveChanges(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:39:25.557

刚刚删除了删除场景的代码并重新添加它。这绝对是多余的过程。

```
 string filmID = comboBox1.SelectedValue.ToString();
    Scenario newScenario = new Scenario();
    foreach (Scenario scenario in scenarioes)
    {
        string thisID = scenario.filmID.ToString();
        if (thisID.Equals(filmID))
        {
            try
            {
                scenario.SceneWriter.Add(newScenewriter);
                myDatabase.SaveChanges();
            }
            catch (Exception ec)
            {
                MessageBox.Show(ec.ToString());
            }
        }
    } 
```

# php - LOAD DATA INFILE 无法使用 \Zend\Db\Adapter

> ID：16043388
> 
> 赞同：1
> 
> 时间：2013-04-16T17:31:17.073
> 
> 标签：php, mysql, zend-framework, pdo

下面的代码直接与 PHP 的 PDO 一起使用，但如果我使用 Zend\Db\Adapter 它会引发错误。第一个尝试块不起作用，而第二个尝试块工作正常并且所有数据都被导入。

```
try {
    $dbAdapter = $this->getServiceLocator()->get('Zend\Db\Adapter\Adapter');
    $result = $dbAdapter->query("LOAD DATA INFILE '?' INTO TABLE users FIELDS TERMINATED BY ',' ENCLOSED BY '" . '"' . "' LINES TERMINATED BY '\n' IGNORE 1 LINES",
                    array('/tmp/feed.csv'));
} catch (PDOException $e) {
    print "Error1!: " . $e->getMessage() . "<br/>";
}
try {
    $dbh = new PDO('mysql:host=localhost;dbname=myapps_test', 'myapps_test_user', 'pwd');
    $result = $dbh->exec("LOAD DATA INFILE '/tmp/feed.csv' INTO TABLE users FIELDS TERMINATED BY ',' ENCLOSED BY '" . '"' . "' LINES TERMINATED BY '\n' IGNORE 1 LINES");
    $dbh = null;
} catch (PDOException $e) {
    print "Error2!: " . $e->getMessage() . "<br/>";
} 
```

我在第一个 try 块中得到的错误：

```
Zend\Db\Adapter\Exception\InvalidQueryException: Statement could not be executed

Caused by
PDOException: SQLSTATE[HY000]: General error: 13 Can't get stat of '/db/dev/mysqldata/myapps_test/?' (Errcode: 2) 
```

位置 /db/dev/mysqldata/myapps_test 是 mysql 服务器的数据库文件所在的位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:13:38.207

`'?'`应该只是`?`在第一个查询中（单引号会自动添加）。我认为这就是给您带来路径问题的原因。

# php - 公交路线数据库

> ID：16043396
> 
> 赞同：0
> 
> 时间：2013-04-16T17:31:40.640
> 
> 标签：php, mysql

我创建了巴士路线的搜索功能。我创建了一个索引页面：

```
<DOCTYPE! html>
<head>
<title>Search</title>
<body>
Enter info below:
<br />
<form action='routes.php' action='get'>

Start Destination:
<select name="start">
 <option value="StopA">Stop A</option>  
</select>
<br />
End Destination:
<select name="stop">
 <option value="StopZ">Stop Z</option>
</select>

Departing between (start):
<select name="start_time">
 <option value="13:40">13:40</option>
 <option value="13:45">13:45</option>
 <option value="13:50">13:50</option>
 <option value="13:55">13:55</option>
</select>
<br />
Departing between (end):
<select name="end_time">
 <option value="13:40">13:40</option>
 <option value="13:45">13:45</option>
 <option value="13:50">13:50</option>
 <option value="13:55">13:55</option>
</select>
<input type="submit" value="Submit">
</form> 
```

和一个连接到我的数据库的“路线”页面

```
<?php
mysql_connect('', '', '');
$start = $_GET['start'];
$stop = $_GET['stop'];
$start_time = $_GET['start_time'];
$end_time = $_GET['end_time'];

$query = mysql_query("SELECT * FROM searchengine.times where STOP_1 = '$start' and   STOP_7 = '$stop' and time(time) between '$start_time' and '$end_time'") or die(mysql_error());

echo "<table border='1'>";
echo "<tr> <th>Departure Time</th> <th>Route No.</th> <th>Stop 1</th> <th>Stop 2</th>       <th>Stop 3</th> <th>Stop 4</th> <th>Stop 5</th> </tr>";

while($row = mysql_fetch_array($query))
{ 
echo "<tr><td>"; 
echo $row['time'];
echo "</td><td>"; 
echo $row['route_no'];
echo "</td><td>";
echo $row['STOP_1'];
echo "</td><td>";
echo $row['STOP_2'];
echo "</td><td>";
echo $row['STOP_3'];
echo "</td><td>";
echo $row['STOP_4'];
echo "</td><td>";
echo $row['STOP_5'];
echo "</td></tr>"; 
echo $row['STOP_6'];
echo "</td></tr>";
echo $row['STOP_7'];
echo "</td></tr>";
} 

echo "</table>";

?> 
```

当我从起始巴士站搜索到终点巴士站时，我没有得到任何结果。

我的数据库看起来像这样：

```
time(PM) STOP_1 STOP_2 STOP_3 STOP_4 STOP_5 STOP_6 STOP_7 route_no.
13:00     
13:20
13:40
14:00 
```

这个对吗？任何人都可以查看我的代码是否存在问题，或者是否有人对如何改进它有任何建议，我将不胜感激。

亲切的问候，钥匙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:35:58.987

我认为问题在于`and time(time)`将其更改为反引号，因为**时间**是一个关键字，它应该像这样使用 `time(`time`)`

# javascript - x-editable 如何获取被点击元素的id

> ID：16043398
> 
> 赞同：6
> 
> 时间：2013-04-16T17:31:51.640
> 
> 标签：javascript, jquery, ajax

我是 x-editable 和 jQuery 的新手，所以我在理解如何使用 x-editable 获取单击元素的“id”时遇到问题，希望有人能提供帮助。

我的页面上有几个链接，位于名为#line_item_unit_cost 的 div 中。

```
 <div id="line_item_unit_cost">
      <a id="1">link</a>
      <a id="2">link</a>
      <a id="3">link</a>
      <a id="4">link</a>
      <a id="5">link</a>
 </div> 
```

当我单击其中一个链接时，我正在触发一个 x 可编辑脚本，该脚本将允许我进行内联编辑。我遇到的问题是我需要传递我正在处理的行项目，以便我可以更新我的数据库。我不知道如何（或者我做错了）访问我点击的链接的“id”。

这是我的脚本：

```
 $('#line_item_unit_cost a').editable({
            validate: function(value) {
                if($.trim(value) == '') return 'This value is required.';
            },
            type: 'text',
            url: '/post',
            pk: {{ purchaseOrder.id }},
            title: 'Enter Value',
            params: {
                purchaseOrderId : {{ purchaseOrder.id }} ,
                lineId : $(this).attr("id"),
                text: 223
            },
            ajaxOptions: {
                dataType: 'json'
            },
            success: function(response, newValue) {

            }
        }); 
```

这一行： lineId : $(this).attr("id") 给了我一个空值。

如果我使用 lineId ： $("#line_item_unit_cost a").attr("id") 会不断拉出页面“id”上的第一个实例，而不是正在编辑的那个。

任何人都知道如何获取我使用 x-editable 单击的链接的 ID？

非常感谢！！！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-16T17:43:35.007

决定我会提供解决方案而不是删除帖子，以防其他人需要这个......

```
 $('#line_item_unit_cost a').editable({
            validate: function(value) {
                if($.trim(value) == '') return 'This value is required.';
            },
            type: 'text',
            url: '/poste',
            pk: {{ purchaseOrder.id }},
            title: 'Enter Freight Value',
            params: function(params) {
                var line = $(this).attr("id");
                var data = {};
                data['purchaseOrderId'] = params.pk;
                data['field'] = params.name;
                data['value'] = params.value;
                data['lineId'] = line;
                return data;
            },
            ajaxOptions: {
                dataType: 'json'
            },
            success: function(response, newValue) {

            }
        }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-17T07:47:02.120

```
$(custom_selector).each(function() {
    var current_element = $(this);
    $(this).editable({
        //common code where you can use current_element
    });    
}); 
```

# xaml - 3 窗格循环滚动面板 - 建议

> ID：16043399
> 
> 赞同：4
> 
> 时间：2013-04-16T17:31:51.740
> 
> 标签：xaml, windows-8, windows-runtime

我有一个 UI 实现挑战（至少对我来说）。需要一个无限循环的 3 个窗格的滚动视图：当用户从窗格 2 向右滑动到窗格 3 时，他们应该能够继续向右滚动到窗格 1 并在窗格中继续滚动，无休止地重复。一次只显示一个完整的窗格 - 没有悬边。

像这样的东西： ![3窗格全景](https://i.stack.imgur.com/K8w9F.png)

我发现的所有示例都非常精细，带有数据绑定和视图模型，通常基于 ListBoxes/views。我们不需要任何复杂的东西：我们的 3 个窗格不是动态的，总是有 3 个。

我们当前的实现，它只在 pane1 和 pane3 之间来回滚动（满足之前的要求），遵循 MSDN WinRT 控件示例：

```
<ScrollViewer>
  <StackPanel>
    <Grid /> <!-- pane1 -->
    <Grid /> <!-- pane2 -->
    <Grid /> <!-- pane3 -->
  </StackPanel>
</ScrollViewer> 
```

就目前而言，这工作得很好，因为我们有触摸体验，并且内容跟随用户的手指并且在他们滚动时可见。

到目前为止，我的想法是：

*   在“开始”和“结束”上添加另一个网格
*   计算滚动时的水平偏移
*   在面板进行到一半时，将“最后一个”窗格内容复制/插入到“下一个”窗格中

但我不知道这是否会奏效，总的来说我不确定如何去做。我们正在寻找一些非常简单的东西来理解这一点并进行可用性测试，但它必须真正在 C#/XAML（Windows 应用商店应用程序）中工作。所以我在向更聪明的人寻求建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:25:55.637

你不应该使用它，`ScrollViewer`因为它不会循环并且有滚动条或指示器来显示你在可滚动内容中的视口位置。A`FlipView`会更好一些，但它也不支持循环。我推荐的解决方案是从头开始简单地实现它。将所有面板放在`Canvas`与面板相同大小的位置并处理面板中的`ManipulationDelta`事件（您需要至少给它们一个`Transparent` `Background`成功的命中测试和`ManipulationMode="TranslateX,TranslateInertia"`）并调用`Canvas.SetLeft(panel)`面板以`e.Delta.Translation.X`从事件参数中更新它们的位置。如果位置低于`-panel.ActualWidth`添加`3 * panel.ActualWidth`如果高于 - 减去该金额。`e.PointerDeviceType == PointerDeviceType.Mouse`如果您决定在控件中显示操作事件时过滤掉操作事件，请确保还添加按钮以启用鼠标翻转项目`FlipView`，但我个人更喜欢保留鼠标拖动操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T09:10:55.703

检查这个：[为 ItemsControl 创建一个自定义 ItemsPanel](http://blogs.msdn.com/b/mim/archive/2013/04/16/winrt-create-a-custom-itemspanel-for-an-itemscontrol.aspx)

它描述创建两个 ItemsPanel ：第一个将生成一个包含所有项目的圆圈，第二个将生成一个无限循环列表。

# android - android意图从谷歌地图获取点

> ID：16043400
> 
> 赞同：0
> 
> 时间：2013-04-16T17:31:53.793
> 
> 标签：android, google-maps, android-intent

我希望我的用户而不是手动输入纬度和经度；应用程序应该启动谷歌地图，用户可以在那里标记一个点。我应该得到这个点的坐标以便在我的应用程序中进一步使用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:35:40.817

There is no documented and supported means of doing this.

You are welcome to create your own activity for allowing the user to pick a point, one that embeds some form of Google Maps or another mapping engine.

Or, you can find some third-party mapping application, other than Google Maps, that documents that they support this capability.

# android - 多个额外的意图

> ID：16043402
> 
> 赞同：0
> 
> 时间：2013-04-16T17:31:56.250
> 
> 标签：android

我得到了三个活动导致相同的活动，其中显示了一个数字，并根据它的来源进行了一些计算，当我在每个意图中只有一个额外的时候，一切都很好，但是让我们说活动一个我需要知道什么选项被选中了，所以我又添加了三个额外的。

但是我在活动一中添加的这三个额外的在上一个活动中似乎没有被识别。

活动一

```
if (selectedItem.trim().equals("100mm")) {
    Total1 =  (int) (a * b * 10);
}

else if (selectedItem.trim().equals("215mm")) {
    Total2 =  (int) (a * b * 20);
}

else if (selectedItem.trim().equals("325")) {
     Total3 =  (int) (a * b * 30);
}
else if (selectedItem.trim().equals("hollow ")) {
     Total4 =  (int) (a * b * 10);
}
    Intent intent = new Intent(CalculateB.this,
            WlAmounts.class);
    intent.putExtra("Result100",Total1);
    intent.putExtra("Result215", Total2);
    intent.putExtra("Result325", Total3);
    intent.putExtra("ResultHollow",Total4);
    startActivity(intent); 
```

上次活动

```
Intent sender = getIntent();
    int edge = sender.getExtras().getInt("Result100");
    int flat = sender.getExtras().getInt("Result215");
    int wide = sender.getExtras().getInt("Result325");
    int hollow = sender.getExtras().getInt("ResultHollow");
    int opes1 = sender.getExtras().getInt("ResultOpe1");
    int opes2 = sender.getExtras().getInt("ResultOpe2");

    if (getIntent().hasExtra("Result100")) {
        answer.setText(edge + "");

    } else if (getIntent().hasExtra("Result215")) {
        answer.setText(flat + "");

        //i'm doing some calculations here

    } else if (getIntent().hasExtra("Result325")) {
        answer.setText(wide + "");

    //i'm doing some calculations here

           } else if (getIntent().hasExtra("ResultHollow")) {
           answer.setText(hollow + "");

     //i'm doing some calculations here

          } else if (getIntent().hasExtra("ResultOpe1")) {
          answer.setText(opes1 + "");

    //i'm doing some calculations here

         }  else if (getIntent().hasExtra("ResultOpe2")) {
             answer.setText(opes2 + ""); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:36:59.320

只需保留一个额外的意图，这将有助于识别呼叫来自哪个活动。然后提取其他各自的意图

# javascript - 在 dropzone 事件后获取表行 ID

> ID：16043407
> 
> 赞同：4
> 
> 时间：2013-04-16T17:32:24.143
> 
> 标签：javascript, jquery, jquery-plugins, dropzone.js

我已经为此努力了几个小时，希望有人能提供帮助。当文件上传到 dropzone 框中时，我正在尝试获取行 ID 或表单 ID。我有多个带有多个放置区框的表格行。

这是我表中的示例行：

```
<table class="docs" id="show">      
    <tr class="doc" id="*Need_This*">
        <td>
            <div class="file_upload drop">
                <form class="dropzone clickable" id="*Or_Need_This*">
                </form>
            </div>
        </td>
    </tr>
</table> 
```

这是我的jQuery：

```
<script type="text/javascript">
$(document).ready(function(){
     $(".dropzone").dropzone({ 
        paramName: 'photos',
        url: "post.php",
        dictDefaultMessage: "Drag or Click",
        clickable: true,
        enqueueForUpload: true,
        init: function() {
            var id = $(this).closest('tr').attr('id');
            this.on("success", function(file) { alert(id); });
          }
    });
});
</script> 
```

现在它返回未定义。我需要获取 id，以便我可以将 css 更改附加到行上的其他元素。任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-24T17:40:30.153

`this`在您的情况下是指 Dropzone 实例，而不是元素本身！如果您需要访问 dropzone 的实际元素，请使用`dropzone.element`.

所以你可以这样做：`var id = $(this.element).etc...`。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-26T19:39:11.380

在文档中，您可以阅读：

> 获取服务器响应作为第二个参数

试试这个：

```
this.on("success", function(file,rep) {
     alert(file);
     alert(rep); //The response
}); 
```

# javascript - 移动网站上的变色（平衡）背景图片

> ID：16043410
> 
> 赞同：1
> 
> 时间：2013-04-16T17:32:40.827
> 
> 标签：javascript, animation, colors, background-image, mobile-website

我是一名为智能手机设计网站的初学者程序员，我有一个身体背景图像，我想慢慢改变颜色平衡，交替颜色，就像有人在任一方向调整 Photoshop 颜色平衡控制条一定百分比一样。当您查看页面时，这种情况会不断发生，但速度足够慢，不会太分散注意力。本质上，一个变色的背景图像。

这种效果是否有可能在智能手机上实现？如何实现？谢谢！

这是 bg 图片的链接：http:
[//i.imgur.com/T1FMp5L.jpg](http://i.imgur.com/T1FMp5L.jpg)

我正在考虑的可能解决方案（记住我是新手）：创建多个处于不同平衡状态的图像并使用缓慢的过渡来平滑地从一个过渡到下一个，或者创建一个循环动画图像文件并将其用作 bg图片。这些东西中的任何一个都可以在我的应用程序中使用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T22:11:14.297

我发现这可以使用 Canvas 完成。我发现了这个：[画布 - 使用 HTML5/CSS/JS 更改图像的颜色？](https://stackoverflow.com/questions/10069171/canvas-change-colors-of-an-image-using-html5-css-js)

第一条评论详细描述了它并提供了这个 jsfiddle 示例：http: [//jsfiddle.net/pHwmL/1/](http://jsfiddle.net/pHwmL/1/)

```
function tintImage(imgElement,tintColor) {
    // create hidden canvas (using image dimensions)
    var canvas = document.createElement("canvas");
    canvas.width = imgElement.offsetWidth;
    canvas.height = imgElement.offsetHeight;

    var ctx = canvas.getContext("2d");
    ctx.drawImage(imgElement,0,0);

    var map = ctx.getImageData(0,0,320,240);
    var imdata = map.data;

    // convert image to grayscale
    var r,g,b,avg;
    for(var p = 0, len = imdata.length; p < len; p+=4) {
        r = imdata[p]
        g = imdata[p+1];
        b = imdata[p+2];
        // alpha channel (p+3) is ignored           

        avg = Math.floor((r+g+b)/3);

        imdata[p] = imdata[p+1] = imdata[p+2] = avg;
    }

    ctx.putImageData(map,0,0);

    // overlay filled rectangle using lighter composition
    ctx.globalCompositeOperation = "lighter";
    ctx.globalAlpha = 0.5;
    ctx.fillStyle=tintColor;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // replace image source with canvas data 
```

这适用于支持 HTML5 的智能手机/浏览器。

# php - 是否可以在 PHP 中对 MySQL 数据库中声明的列/变量使用 if 条件？

> ID：16043412
> 
> 赞同：-4
> 
> 时间：2013-04-16T17:32:48.493
> 
> 标签：php, sql, database

我目前正在做一个投票网站。我想知道我是否可以将 PHP 中的“if 条件”放在我在 MySQL 数据库中定义的变量上？我有一个名为“用户”的数据库。这个数据库有三列——用户名、密码和标志。用户名和密码是预定义的。'flag' 默认设置为 0。flag 值为 0 表示用户尚未投票。我想在标志上使用“如果条件”来检查用户是否已经投票。到目前为止，我的代码会将标志更新为 1，但是 if 条件似乎无法正常工作。可能是我没有从我的数据库中正确读取“标志”。我还使用 cookie 来存储用户的用户名，然后读取该 cookie 为该特定用户设置 flag=1。我现在只需要知道：

1.  从数据库中读取 flag 的值并
2.  对标志应用 if 条件

谢谢。

编辑：我需要根据标志的值将用户带到不同的页面。如果该特定用户的标志为 0，我希望该用户转到“谢谢”投票页面，否则如果标志为 1，我将他带到“您已经投票”页面。

这是代码：

```
<?php

$host="localhost"; // Host name 
$username="dbxxxxx"; // Mysql username 
$password="password"; // Mysql password 
$db_name="dbxxxxx_users"; // Database name 
$tbl_name="users"; // Table name 

// Connect to server and select databse.
mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");

$user = $_COOKIE["details"];  //cookie details has the username the user used to log in

$SQL = "SELECT flag FROM users WHERE Username='$user'"; //THIS IS WHERE I AM TRYING TO READ FLAG, HOWEVER IT DOESN'T WORK. I NEED AN ALTERNATE STATEMENT FOR WHAT I AM DOING HERE.
$flag = mysql_query( $SQL );   
$db_field = mysql_fetch_assoc($flag);  

if($db_field==0)     {       
        mysql_query("UPDATE result SET Votes=Votes+1 //if flag in database = 0 
        WHERE Name='Candidate1'");  //updates result for candidate1 if the user voted for 1
        $user = $_COOKIE["details"];  //reading the cookie again. can be omitted.

        mysql_query("UPDATE users SET flag=1   //changing flag to 1 so user cannot vote again
        WHERE Username='$user'");

        header("location: http://www.lithuaniavote.com/thankyou.html");
 }

else    //flag != 1 or user has already voted
{
    header("location: http://www.lithuaniavote.com/alreadyvoted.html");
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:46:28.390

```
$mysqli = new mysqli("localhost", "my_user", "my_password", "world");

if ($stmt = mysqli->prepare("SELECT flag FROM users WHERE username=?")) {

    /* bind params */
    mysqli_stmt_bind_param($stmt, $user);

    /* execute query */
    mysqli_stmt_execute($stmt);

    /* bind result variables */
    mysqli_stmt_bind_result($stmt, $flag);

    if($flag != 0) {
       if ($upd = mysqli->prepare("UPDATE users SET flag = 1 WHERE username=?")) {
           mysqli_stmt_bind_param($upd, $user);
           mysqli_stmt_execute($upd);

           /* did not vote. succes view */
       } 
    } else {
      /* voted already. error view  */
    }
}

$mysqli->close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:42:50.183

一旦 Query 运行，这将做到这一点：

```
if( $row['flag'] == 0 ) {
    header('Location: http://www.example.com/thank_you.php');
} else if ($row['flag'] == 1 ) 
    header('Location: http://www.example.com/you_have_voted.php');
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:41:40.270

好吧，首先你应该从数据库中选择关于用户的数据

```
<?php
$flag = false;
// making query text
$query = "SELECT * FROM `users` WHERE `username` = '".$username."'";    
// executing mysql query
$sel = mysql_query($query);
if ($sel AND mysql_num_rows($sel) >= 1) { // if query was successfully executed
    $row = mysql_fetch_object($sel); // making object ($row) from DB data (now you have $row->username, $row->password and $row->flag)
    $flag = $row->flag; // write flag value from DB into php variable
}

if ($flag != false) {
    // user hadn't wote
    // so we can present voting poll here or execute update query if user just voted
} else {
    // user already woted
}
?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T17:44:31.563

您可以使用 SQL 执行此操作：

```
$sql = "select IF(flag='1','Voted','Not Voted') AS 'status' from users where username='$username'"; 
```

在代码中，您将执行以下操作：

```
switch($status){

  case 'Not Voted':
  include('newVoter.php');
  break;

  default:
  include('voted.php');

} 
```

如果您在检查之前没有打印任何内容以进行筛选，您可以执行以下操作：

```
switch($status){

  case 'Not Voted':
  header('Location: newVoter.php');
  break;

  default:
  header('Location: voted.php');

} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-16T17:36:22.957

我不明白*为什么*你需要检查`PHP`侧面的标志。您可以根据标志添加过滤器。

```
SELECT ... FROM votes WHERE flag = 0 
```

否则，您是否正在寻找这样的东西？

```
$sql = "SELECT flag FROM votes WHERE username = 'bob'";

$result = mysqli_query($sql);
$row = mysqli_fetch_assoc($result);
if( $row['flag'] == 0 ) {
    //do something
} 
```

# ruby-on-rails - 带参数的字符串路径

> ID：16043416
> 
> 赞同：6
> 
> 时间：2013-04-16T17:33:06.340
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, link-to

我需要一种在帮助程序中从数组创建一组 Rails 3 路径的好方法`link_to`。

我有：

```
TITLES = ['foo', 'bar', 'baz']
TITLES.each do |t|
  = link_to t, (.....path....) 
```

这样我需要构建一组路径：

```
foo_super_users_path(user)
bar_super_users_path(user)
baz_super_users_path(user) 
```

如您所见，我需要为每个路径添加相同的前缀**_super_users ，并传递****用户**对象。作为最终结果，我需要类似的东西：

```
link_to t, foo_super_users_path(user)
link_to t, bar_super_users_path(user)
link_to t, baz_super_users_path(user) 
```

非常感谢您的建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:40:22.573

怎么样

```
TITLES.each do |t|
  = link_to t, eval("#{t}_super_users_path(user)") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-01-16T14:29:52.007

而是 eval 使用 public_send

```
TITLES.each do |t|
  = link_to t, public_send("#{t}_super_users_path", user) 
```

# symfony - Symfony2：我可以在 $variable 是字符串的地方使用 find($variable) 吗？

> ID：16043417
> 
> 赞同：1
> 
> 时间：2013-04-16T17:33:12.100
> 
> 标签：symfony, doctrine, dbal

由于我的代码中的一行，引发了异常：

```
$acadObj = $em->getRepository('ProjectMyBundle:Academie')->find($acadDeleg); 
```

where`$acadDeleg`是我从数据源中检索的字符串。

一般官方文档使用`find($id)`where `$id`is a number（整数）。为此，我问是否可以使用字符串。问题是我有一个表，我必须从中获取一个值，然后与另一个表进行比较，这样我就可以创建一个对象。

作为记录，`$acadDeleg`是`Academie`Entity的主键

编辑 ：

异常消息：

```
The Exception message :

An exception occurred while executing 'SELECT t1.codeLieu AS codeLieu2, t1.nomLieu AS nomLieu3, t1.latLieu AS latLieu4, t1.lngLieu AS lngLieu5 FROM Academie t1 WHERE t0.codeLieu = ?' with params {"1":"A"}:

SQLSTATE[42S22]: Column not found: 1054 Unknown column 't0.codeLieu' in 'where clause' 
```

学院定义：

```
<?php

namespace PFA\SIGBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Academie
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="PFA\SIGBundle\Entity\AcademieRepository")
 */
class Academie extends Lieu
{

} 
```

刘定义：

```
<?php

namespace PFA\SIGBundle\Entity;

use Doctrine\ORM\Mapping as ORM;

/**
 * Lieu
 *
 * @ORM\Table()
 * @ORM\Entity(repositoryClass="PFA\SIGBundle\Entity\LieuRepository")
 */
abstract class Lieu
{

/**
 * @var string
 *
 * @ORM\Column(name="codeLieu", type="string", length=20)
 * @ORM\Id
 */
private $codeLieu;

/**
 * @var string
 *
 * @ORM\Column(name="nomLieu", type="string",nullable=true)
 */
private $nomLieu;

/**
 * @var float
 *
 * @ORM\Column(name="latLieu", type="float", nullable=true)
 */
private $latLieu;

/**
 * @var float
 *
 * @ORM\Column(name="lngLieu", type="float", nullable=true)
 */
private $lngLieu;
// getters and setters here...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:40:19.337

您的抽象类`Lieu`必须是`MappedSuperclass`.

您需要将`Lieu`定义更改为：

```
/**
 * Lieu
 *
 * @ORM\MappedSuperclass
 */
abstract class Lieu
{
  //[...]
} 
```

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/inheritance-mapping.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/inheritance-mapping.html)

# html - 如何设置类名包含字符串的div（元素）

> ID：16043419
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:33:19.867
> 
> 标签：html

我想使用 css 来设置类或 id 名称包含特定单词的对象。

我使用了 javascript，但现在需要 css 解决方案。

//ps我的javascript代码如下。它试图获取特定类名的 id 并设置它的样式（页面加载 3 秒后）：

```
<script src="ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">

        var t=setTimeout(function(){
            var clasnamee = "form-field";
            var whatcontains = "copy";
            var myla = document.getElementsByClassName(clasnamee);
            var arylengh = myla.length;

            for (var i = 0; i < arylengh; i++) {

                var kk = document.getElementsByClassName(clasnamee)[i].id;
                if(kk.indexOf(whatcontains) > - 1)
                {
                 $("tr#" + kk).css("background-color", "#BCB4B4");
                // or try with jQuery
                //jQuery("tr#" + kk).css("background-color", "#BCB4B4");

                }
            }

        },3000);
        </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:39:14.190

这是一种样式 css 元素包含特定单词（字符串）的方法。

如果 ID 包含 blabla：

```
div[id*="blabla"] 
{
    background-color:#BCB4B4;
} 
```

*（您不仅可以用于 div，还可以用于表格、输入、标签、文本区域或任何其他变体：*

```
input[class*="blabla"] 
{
    background-color:#BCB4B4;
} 
```

# racket - 如何在终端中使用 Racket？

> ID：16043424
> 
> 赞同：5
> 
> 时间：2013-04-16T17:33:45.097
> 
> 标签：racket

我没有运气找到一种方法来按照我想要的方式进行这项工作，所以如果有人能提供帮助，我将不胜感激。

我想要的是能够在终端上做到这一点：

`> racket`

然后能够输入 Racket 命令并让它们编译。喜欢，

```
> (+ 1 2)
> 3 
```

希望有一些命令，比如

```
> racket myprog.rkt
> 3 
```

仅`myprog.rkt`包含`(+ 1 2)`.

如果这是一个明显的问题，我对此很抱歉，但我只是不知道如何使它工作。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:21:00.980

您几乎完全准确地描述了`racket`可执行文件在做什么。唯一的区别是你`myprog.rkt`需要`#lang racket`在顶部有一个。

如果您使用的是 Mac，则需要使用直接路径运行可执行文件，或将其添加到您的环境中`$PATH`，或对其进行符号链接。您将在`bin`子目录中找到可执行文件。

如果你在 Windows 上，你必须做同样的事情——要么将 Racket 目录添加到`PATH`系统设置中，要么直接运行它。在 Windows 上，您应该有一个 Racket 可执行文件的启动链接，该可执行文件将在 cmd 框中运行。（请注意，如果您查看 Racket 目录，则不会有`bin`子目录。）

# python - “模块”对象在 django 中没有属性“模型”错误

> ID：16043426
> 
> 赞同：5
> 
> 时间：2013-04-16T17:33:51.700
> 
> 标签：python, django

我正在开发一个简单的博客引擎。这是我的模型的初始代码：

```
from django.db import models
from django.contrib.auth.models import User

class Entry(models.Model):

    title = models.CharField(max_length=80)
    author = models.models.models.ForeignKey(User)
    pubdate = models.DateTimeField()
    text = models.TextField()
    tags = models.ManyToManyField(Tag)

class Tag(models.Model):
    name = models.CharField(max_length=25)

class Comment(models.Model):
    author = models.ForeignKey(User)
    pubdate = models.DateTimeField()
    text = models.TextField() 
```

当我尝试运行`python manage.py syncdb blog`时，出现错误

```
'Module' Object Has no Attribute 'models' 
```

我正在使用 sqlite3。我还没有设置任何视图或测试。在`settings.py`中，我包含了以下应用程序：

```
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
'blogApp',
'south', 
```

任何想法这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:42:27.117

你有

```
author = models.models.models.ForeignKey(User) 
```

那应该是

```
author = models.ForeignKey(User) 
```

反而。

# css - CSS 居中内联导航

> ID：16043431
> 
> 赞同：0
> 
> 时间：2013-04-16T17:34:04.577
> 
> 标签：css, centering, navbar

我在为班级创建的导航菜单居中时遇到问题，我尝试了所有文本对齐、margin-left/margin-rgiht、将其居中在 html 等中。我找到的每个站点都告诉我 margin-left:auto; 和边距右：自动；但这不起作用。这是我需要在页面中自动居中的菜单。

```
 <div class="menu">
<ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="artwork.html">Artwork</a>
        <ul>
            <li><a href="#">Pencil</a></li>
            <li><a href="#">Pastel</a></li>
            <li><a href="#">Color Pencil</a></li>
            <li><a href="#">Charcoal</a></li>
            <li><a href="#">Digital</a></li>
        </ul>
    </li>
    <li><a href="#">Projects</a>
        <ul>
            <li><a href="#">74 Duster</a></li>
            <li><a href="#">The "Beast"</a></li>
            <li><a href="#">Darkness and Hope</a></li>
        </ul>
    </li>
    <li><a href="#">About</a>
        <ul>
            <li><a href="#">Who I am and why it matters</a></li>
            <li><a href="#">Contact Me</a></li>
        </ul>
    </li>
</ul>
</div> 
```

这是它的CSS：

```
.menu {
margin-right:auto;
margin-left:auto;
max-width:700px;
display:inline-block;
padding:0px;
font-size:14px;
font-weight:bold;
text-align:center;
}

.menu ul {
width:700px;
background:#333333;
height:35px;
list-style:none;
margin:0;
padding:0;
text-align:center;
}

.menu li {
width:175px;
text-align:center;
float:left;
padding:0px;
}

.menu li a {
background:#333333;
color:#cccccc;
display:block;
font-weight:normal;
line-height:35px;
margin:0px;
padding:0px 25px;
text-align:center;
text-decoration:none;
}

.menu li a:hover, .menu ul li:hover a {
background: #2580a2;
color:#FFFFFF;
text-decoration:none;
}

.menu li ul {
display:none;
height:auto;
padding:0px;
margin:0px;
border:0px;
position:absolute;
width:175px;
z-index:200;
}

.menu li:hover ul {
display:block;

}

.menu li li {
display:block;
float:none;
margin:0px;
padding:0px;
width:175px;
}

.menu li:hover li a {
background:none;
}

.menu li ul a {
display:block;
height:35px;
font-size:12px;
font-style:normal;
margin:0px;
padding:0px 10px 0px 15px;
text-align:left;
}

.menu li ul a:hover, .menu li ul li:hover a {
background:#2580a2;
border:0px;
color:#FFFFFF;
text-decoration:none;
} 
```

任何帮助将不胜感激，或者如果您知道一种将整个网页居中并将内容缩放到观众分辨率的方法，那就太好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:35:28.813

Change `.menu`'s `display` from `inline-block` to `block`.

# php - 需要在 PHP 上“动态”调用静态属性

> ID：16043438
> 
> 赞同：0
> 
> 时间：2013-04-16T17:34:15.530
> 
> 标签：php, laravel, laravel-3

我有以下问题。

在我的横幅课程中，我有：

```
public static $flag_status = array(
                               'Unpublished'
                          ,    'Published'
                          ); 
```

在 Banner 类中，我有一个包含“flag_status”值的数组，该值表示 Banner 类的属性。

假设我从数组中获取这个值并存储在这样的变量中：

```
$name_attr = 'flag_status'; 
```

我需要打电话：

```
Banner::$name_attr; 
```

它应该返回与调用相同的结果：

```
Banner::$flag_status; 
```

有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:36:36.097

使用两个美元符号：

```
Banner::$$name_attr; 
```

例子：

```
class Foo {
    public static $flag_status = array( 'foo', 'bar' );
}

$name_attr = 'flag_status';

print_r(Foo::$$name_attr); 
```

产生：

```
Array
(
    [0] => foo
    [1] => bar
) 
```

# asp.net-mvc - 存在身份验证 cookie 时，Visual Studio 中的 IIS Express 8 不会加载站点

> ID：16043452
> 
> 赞同：1
> 
> 时间：2013-04-16T17:35:03.410
> 
> 标签：asp.net-mvc, debugging, visual-studio-2012, iis-express

我在 VS 2012 中有一个 ASP.NET mvc 应用程序，为调试器运行 IIS Express 8（带有自定义域和 ssl）。直到昨天一切都很好。当我启动调试器时，它会加载主页。然后我登录（并使用 ssl 启动登录页面）。但是，一旦我登录，该站点将无法加载任何非 SSL 页面。SSL 页面仍然可以正常工作，但是一旦我尝试加载非 ssl 页面，什么也没有发生（浏览器只是停留在“等待...”，直到它最终失败）。

当我尝试浏览到非 ssl 页面时，应用程序中没有启动任何代码，也没有在 IISExpress 中创建任何日志。就好像 IIS Express 上的绑定不存在一样。如果我清除浏览器上的 cookie，那么我可以再次浏览该站点没有问题（即使没有重新启动 IISExpress）

我相信当我打开一个具有相同名称的不同项目时问题就开始了 - 导致 IIS Express 或 VS 项目的配置出现某种冲突。这应该可以正常工作，因为 IIS Express 在其配置中创建的站点中添加了 (1)，但问题似乎从那时开始。为了尝试解决问题，我尝试重新创建所有 IIS 设置（删除所有内容并重新添加一个项目，重新生成 applicationHost.config 文件，使用 netsh 删除和重新添加 urlacl 条目，验证 ssl 认证使用网络）。

如果我手动启动 IIS Express (iisexpress.exe /Site:"[site name]") 那么一切正常 - 只有当 IIS Express 由 Visual Studio 2012 调试器启动时才会出现问题。

# php - ZipArchive Library Is Not Enabled When Using PHPExcel

> ID：16043453
> 
> 赞同：5
> 
> 时间：2013-04-16T17:35:03.360
> 
> 标签：php, codeigniter, phpexcel, pecl, ziparchive

I am using CodeIgniter and PHPExcel to read and write to excel files.

Everything worked fine in localhost, but when I uploaded my PHP CodeIgniter application to the server in [pagodabox](http://www.pagodabox.com) I got the below message when I tried to read data from excel files.

```
Fatal error: Uncaught exception 'Exception' with message 'ZipArchive library is not enabled' in /var/www/application/libraries/PHPExcel/Reader/Excel2007.php 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-16T22:23:32.713

对于写作，PHPExcel 确实提供了 PCLZip 作为 ZipArchive 的替代品。您可以通过调用将其配置为使用它

```
PHPExcel_Settings::setZipClass(PHPExcel_Settings::PCLZIP); 
```

但是，如果您想阅读任何压缩的电子表格文件格式（例如 xlsx、ods），那么您确实需要启用 PHP 的 zip 存档扩展

**编辑**

从版本 1.8.0 开始，PCLZIP 选项现在在读取和写入压缩格式时可用

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-16T17:51:42.613

[ZipArchive](http://us3.php.net/manual/en/class.ziparchive.php)是 PHP Excel 的[要求](https://phpexcel.codeplex.com/wikipage?title=Requirements&referringTitle=Home)。您需要按照安装[说明](http://us3.php.net/manual/en/zip.installation.php)在生产服务器上启用它。

它已经在您的开发服务器上启用，这是它在那里工作的原因。联系您的主机以查看它是否已经编译，如果是，如何为您的帐户启用它。

取消注释 PECL 扩展 from`php.ini`将启用它。如果您无权访问该文件，请联系您的主机以启用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-08-12T06:34:48.090

要求

```
PHP version 5.2.0 or higher
PHP extension php_zip enabled *)
PHP extension php_xml enabled
PHP extension php_gd2 enabled (if not compiled in) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-29T08:58:04.040

升级到 PHP 7 时，您应该确保也安装 PHP 7 版本的库。提供 PHP 7 的 PPA 还提供了一个 php7.0-zip 包。您可以使用以下方式安装它：

$ sudo apt-get install php7.0-zip

要查看其他可用的 PHP 7 库，请运行：

$ sudo apt-cache 搜索 php7.0-*

# javascript - jquery - 当我的模态窗口关闭时从图像中删除图像区域选择

> ID：16043454
> 
> 赞同：0
> 
> 时间：2013-04-16T17:35:13.693
> 
> 标签：javascript, jquery

我正在使用 jquery 插件“图像区域选择” [http://odyniec.net/projects/imgareaselect/](http://odyniec.net/projects/imgareaselect/)来裁剪用户上传的图像。

当用户上传图像文件时，我用来上传文件的 php 返回服务器上的文件位置并触发模式窗口。对于这个模态窗口，我使用 .prepend 将图像添加到 #myModal，如下所示：

```
$('#myModal').prepend('<img id="photo" src="../'+success+'" />'); 
```

然后我将图像区域选择代码附加到这个上传的图像。

```
$('#photo').imgAreaSelect({aspectRatio: '1:1', handles: true, fadeSpeed: 200,  onSelectChange: preview}); 
```

我的问题是，如果使用 imgAreaSelect 选择图像的一个区域，然后单击以关闭模态窗口，模态将消失，但图像的轮廓加上裁剪手柄仍然存在！

在关闭我的模态窗口的javascript中，我尝试添加：

```
$('#photo').imgAreaSelect(''); 
```

分离 imgAreaSelect 但那和其他变体不起作用。有人对如何解决这个问题有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:40:05.223

从文档中：

> 选项
> 
> **remove** 如果设置为 true，则插件将被完全删除。

所以我们假设它是

```
$("#photo").imgAreaSelect({remove:true}); 
```

**编辑**：试试这个：

```
var myCroppable = $('#photo').imgAreaSelect({aspectRatio: '1:1', handles: true, fadeSpeed: 200,  onSelectChange: preview}); 
```

无论你现在打电话给你的地方`imgAreaSelect`。现在你有了它的一个实例。然后在关闭按钮或保存缩略图按钮处执行以下操作：

```
myCroppable.cancelSelection(); 
```

那应该行得通。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:40:13.167

试试这个 ：

```
$('#photo').imgAreaSelect({disable:true,hide:true}); 
```

更多选项的 [http://odyniec.net/projects/imgareaselect/usage.html](http://odyniec.net/projects/imgareaselect/usage.html)

# iphone - 移动 iOS GEO 位置轮询和通知

> ID：16043455
> 
> 赞同：1
> 
> 时间：2013-04-16T17:35:16.157
> 
> 标签：iphone, ios, ipad, cordova, mobile

我们正处于规划移动应用程序的早期阶段。我们有一些特定于 GEO 功能和能力的需求。

我们的愿望是创建一个混合体，但是，我知道这可能无法满足以下所有要求。

假设用户已将正确的通知权限授予应用程序：

**客户在前台运行应用程序：**

1.  设备在某些客户端操作时通知服务器 GEO 位置 *（客户执行一些将数据发送到服务器的操作，我们可以包括当前 GEO 位置吗？）*

2.  设备每*n*分钟发送一次当前 GEO 位置的 ping。

3.  发生业务事件，服务器因其 GEO 位置而向设备发送消息*（服务器向 GEO 附近的一个或多个应用程序发送消息*

**客户未在前台运行应用程序**

1.  设备每*n*分钟通知服务器一次 GEO 位置。*（服务器想知道设备的大致位置，以确定是否向其发送了服务器附近事件的通知）*

2.  服务器在设备未运行时由于其 GEO 位置而向设备发送消息。*（由于其 GEO 位置，服务器向设备发送通知消息。我知道如果应用程序未运行，这将作为应用程序警报发送到操作系统，然后用户将单击以在前台运行应用程序）*

目前我的主要关注点是 iOS，但我对上述方面的 Android 功能感兴趣。

我没有移动开发经验。我们正在整理功能规范并尝试确定功能集的可行性。

我们绝大多数的应用都是简单的客户端设备和服务器之间的数据交互，混合就可以了。但是，让我担心的是我们的客户没有运行 GEO 要求。是否有可能创建一个小型 iOS 应用程序来处理混合动力无法处理的事情？如果是这样，这些应用程序可以打包在一起还是单独安装？

**编辑：** 假设用户已正确配置设备，即设备 GPS 已打开并能够接收通知等。核心问题是设备是否可以在应用程序运行时每*n*分钟通知服务器其 GEO 位置，然后与相同的问题应用程序关闭？这在原生/混合之间是否有显着差异。

对于 iOS，当应用程序位于“应用程序托盘”中时，该应用程序是否仍被视为正在运行？或者，一旦应用程序不在前台，它就会被有效地关闭？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:00:39.507

首先，如果客户关闭 GPS，您将无法获得客户的 GEO。

我认为在阅读了您的要求后，您需要 PhoneGap 才能使其工作（如果您想要混合应用程序）。读：

[混合移动应用程序是否支持推送通知？](https://stackoverflow.com/questions/8014849/do-hybrid-mobile-apps-support-push-notifications?rq=1)

在 iOS 上，您不需要也没有任何额外的措施来确保它们是开放的。您唯一能做的就是通知用户“您的 GPS 没有运行”并要求他们打开它。关于通知：你只能使用苹果提供的通知中心，如果你只是想在iOS上开发，这很简单。

在 Android 上，情况有些不同。在最新版本的 Android 上，您无法在后台打开 GPS，但您可以在旧版本中阅读以下内容：

[关闭 GPS 安卓](https://stackoverflow.com/questions/12431598/turn-on-off-gps-android)

所以你最好显示你的用户设置屏幕，让他们打开 GPS。

关于通知：不推荐使用谷歌 GCM，因为某些设备上没有安装谷歌服务。第三方推送服务是一个不错的选择，例如`urbanairship`。

关于后台任务：

在 Android 中，您可以运行此任务后台，在 iOS 中也可以像`Endomondo`之前那样运行。但它一直不稳定，因为如果用户进程达到内存限制，系统可能会杀死你的进程以释放内存。这可能发生在 iOS 和 Android 上。

# c# - EF 5 复合键与其他实体具有多关系

> ID：16043456
> 
> 赞同：0
> 
> 时间：2013-04-16T17:35:17.953
> 
> 标签：c#, entity-framework

在下面的代码中，我首先使用 EF 代码来设置我的数据库模型。

CaseCommunication 实体有一个复合键，包括一个 Id 列。如果我让 EF 完成这项工作，它会尝试将此列用作另一个实体的 FK，尽管有 Many() 规范：

```
HasRequired(x => x.Case).WithMany(x => x.Communications);
HasOptional(x => x.FirstReadBy).WithMany(); 
```

要获得正确的模型，我必须明确设置 FK（请阅读代码中的注释）。

```
HasRequired(x => x.Case).WithMany(x => x.Communications).Map(x => x.MapKey("Case_Id"));
HasOptional(x => x.FirstReadBy).WithMany().Map(x => x.MapKey("FirstReadBy_Id")); 
```

如果我不使用复合键，那么在不使用 Map() 的情况下一切正常。

我的问题是： EF 的逻辑是什么？或者换一种说法，我错过了什么？

```
using System;
using System.Linq;
using System.Data.Entity;
using System.Collections.Generic;
using System.Data.Entity.ModelConfiguration;
using System.Data.Objects.SqlClient;
using System.ComponentModel.DataAnnotations.Schema;

namespace testef {
    //Model
    public partial class Case {
        public Case() {                
            Communications = new List<CaseCommunication>();
        }
        public Int32 Id { get; set; }

        public virtual ICollection<CaseCommunication> Communications { get; set; }
    }

    public class CaseCommunication  {

        public String CComType { get; set; }
        public Int32 Id { get; set; }

        public virtual Case Case { get; set; }

        public virtual User FirstReadBy { get; set; }
    }

    public class User {
        public Int32 Id { get; set; }
    }

    //Configuration for CObj
    public class UserEFCFConfiguration : EntityTypeConfiguration<User> {
        public UserEFCFConfiguration()
            : base() {
            ToTable("Users", "dbo");
            HasKey(x => x.Id);
            Property(x => x.Id).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
        }
    }

    public class CaseEFCFConfiguration : EntityTypeConfiguration<Case> {
        public CaseEFCFConfiguration()
            : base() {
            ToTable("Cases", "dbo");
            HasKey(x => x.Id);
            Property(x => x.Id).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);   
        }
    }

    public class CaseCommunicationEFCFConfiguration : EntityTypeConfiguration<CaseCommunication> {
        public CaseCommunicationEFCFConfiguration()
            : base() {
            ToTable("VCaseCommunications", "dbo");
            Property(x => x.CComType).HasColumnType("char").HasMaxLength(2);

            HasKey(x => new { x.CComType, x.Id });

            // OK
            HasRequired(x => x.Case).WithMany(x => x.Communications).Map(x => x.MapKey("Case_Id"));
            HasOptional(x => x.FirstReadBy).WithMany().Map(x => x.MapKey("FirstReadBy_Id"));

            // KO
            //HasRequired(x => x.Case).WithMany(x => x.Communications);
            //HasOptional(x => x.FirstReadBy).WithMany()
            //EF tries to use the x.Id as FK for both Case and FirstReadBy
            //For FirstReadBy this leads to a Model error as x.Id is not nullable
            //But in each case I can't understand how EF expect to give the many relation by using a part of the PK as FK

            // OK
            //HasKey(x => x.Id);
            //HasRequired(x => x.Case).WithMany(x => x.Communications);
            //HasOptional(x => x.FirstReadBy).WithMany()
        }
    }

    public class TestEFContext : DbContext {
        public IDbSet<Case> Cases { get; set; }

        public TestEFContext(String cs)
            : base(cs) {
            Database.SetInitializer<TestEFContext>(new DropCreateDatabaseAlways<TestEFContext>());
        }

        protected override void OnModelCreating(DbModelBuilder modelBuilder) {
            base.OnModelCreating(modelBuilder);

            modelBuilder.Configurations.Add(new UserEFCFConfiguration());
            modelBuilder.Configurations.Add(new CaseEFCFConfiguration());
            modelBuilder.Configurations.Add(new CaseCommunicationEFCFConfiguration());
        }
    }

    class Program {
        static void Main(String[] args) {
            String cs = @"Data Source=ALIASTVALK;Initial Catalog=TestEF;Integrated Security=True; MultipleActiveResultSets=True";                

            using (TestEFContext c = new TestEFContext(cs)) {
                Console.WriteLine(c.Cases.Count());
            }                                                                
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T09:23:54.867

事实上，这似乎是 EF 的默认行为：如果链接实体键的一部分与引用的实体 PK 具有相同的名称，那么这个如此命名的属性将用作 FK。

# c# - C#图片框以错误的方向显示图片

> ID：16043457
> 
> 赞同：2
> 
> 时间：2013-04-16T17:35:27.190
> 
> 标签：c#, orientation, picturebox

我有一个带有图片框的 winform 应用程序，但是当我加载图片时，它会显示一张在他身边旋转的肖像照片。在 Windows 资源管理器中，图片以正确的方式显示。

这是我用于图片框的唯一代码：

```
Bitmap photo = new Bitmap(file.FullName);                
pbPhoto.Image = photo; 
```

图片框 SizeMode 设置为“缩放”，其他选项设置为默认值。

PS。我使用的图片来自 iPhone。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:40:41.150

旋转由图像的 EXIF 数据中的数据存储处理。图像本身正在正确显示 - Windows 资源管理器会自动为您旋转它，因为 iPhone 在图像中存储信息说它是“旋转的”。

您可以检查 EXIF 数据并自己旋转图像，但这是您在读取图像时需要做的事情。CodeProject 上的[EXIFextractor 库](http://www.codeproject.com/Articles/11305/EXIFextractor-library-to-extract-EXIF-information)将允许您提取信息，然后可以使用这些信息来[旋转图像以纠正方向](http://automagical.rationalmind.net/2009/08/25/correct-photo-orientation-using-exif/)。

# facebook - Cover Photo Preview

> ID：16043460
> 
> 赞同：1
> 
> 时间：2013-04-16T17:35:31.363
> 
> 标签：facebook, photo, facebook-timeline

We have an app that adds a photo to a users' album, then directs them to https://www.facebook.com/[profile_id]?preview_cover=[image_id] so they can save it as their cover photo.

It has been working for months, but as of today, that link ends up with a white box and no photo.

Does anyone know if Facebook changed this functionality? I couldn't find anything about it in their documentation.

# java - 使用 Jsoup 提取 HTML 数据

> ID：16043463
> 
> 赞同：1
> 
> 时间：2013-04-16T17:35:36.677
> 
> 标签：java, html, web-scraping, jsoup

我正在尝试 使用 Jsoup从诺基亚开发者网站[http://www.developer.nokia.com/Devices/Device_specifications/Nokia_Asha_308/提取移动规范数据。](http://www.developer.nokia.com/Devices/Device_specifications/Nokia_Asha_308/)如何获取每个子类别的数据，例如“相机功能”、“图形格式”等。分别地。

```
import java.io.IOException;
import java.sql.SQLException;
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class Nokiareviews {
public static void main(String[] args) throws IOException, SQLException,    InterruptedException {
Document doc = Jsoup.connect("http://www.developer.nokia.com/Devices/Device_specifications/Nokia_Asha_308/").timeout(1000*1000).get();
Elements content = doc.select("div#accordeonContainer");
for (Element spec : content) {
System.out.println(spec.text());
}
}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T02:09:19.453

如果你仔细观察，你会发现每个类别都是一个`<div>`with `class=accordeonContainer`，它的标题在一个`h2`（在那个下面），而子类别列表在`<dl>`一个`"clearfix"`CSS 类下面：

```
<div class="accordeonContainer accordeonExpanded">
    <h2 class=" accordeonTitle "><span>Multimedia</span></h2>
    <div class="accordeonContent" id="Multimedia" style="display: block;">
        <dl class="clearfix">
            <dt>Camera Resolution</dt>
            <dd>1600 x 1200 pixels  </dd>
                ...    
            <dt>Graphic Formats</dt>
            <dd>BMP, DCF, EXIF, GIF87a, GIF89a, JPEG, PNG, WBMP </dd>
            ...
        </dl>
    </div>
</div> 
```

您可以使用以下命令选择特定类型（例如`elm`）和给定 CSS 类（例如`clazz`）的元素列表：

```
Elements elms = doc.select("elm.clazz"); 
```

然后，简而言之，提取您提到的信息的代码可能是：

```
public class Nokiareviews {
    public static void main(String[] args) throws IOException {
        Document doc = Jsoup.connect("http://www.developer.nokia.com/Devices/Device_specifications/Nokia_Asha_308/")
                .timeout(1000 * 1000).get();
        Elements content = doc.select("div.accordeonContainer");
        for (Element spec : content) {
            Elements h2 = spec.select("h2.accordeonTitle");
            System.out.println(h2.text());

            Elements dl = spec.select("dl.clearfix");
            Elements dts = dl.select("dt");
            Elements dds = dl.select("dd");

            Iterator<Element> dtsIterator = dts.iterator();
            Iterator<Element> ddsIterator = dds.iterator();
            while (dtsIterator.hasNext() && ddsIterator.hasNext()) {
                Element dt =  dtsIterator.next();
                Element dd =  ddsIterator.next();
                System.out.println("\t\t" + dt.text() + "\t\t" + dd.text());
            }
        }
    }
} 
```

如果使用 Maven，请确保将其添加到您的`pom.xml`：

```
<dependency>
    <groupId>org.jsoup</groupId>
    <artifactId>jsoup</artifactId>
    <version>1.7.2</version>
</dependency> 
```

# paypal - How to have a single delivery charge with Paypal?

> ID：16043467
> 
> 赞同：0
> 
> 时间：2013-04-16T17:35:47.923
> 
> 标签：paypal

I am working on a page and adding "Add to cart" buttons. Example:

```
<form target="paypal" action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
    <input type="hidden" name="cmd" value="_cart"/>
    <input type="hidden" name="business" value="---------"/>
    <input type="hidden" name="lc" value="US"/>
    <input type="hidden" name="item_name" value="xxxxxxx"/>
    <input type="hidden" name="item_number" value="A11"/>
    <input type="hidden" name="amount" value="35.00"/>
    <input type="hidden" name="currency_code" value="GBP"/>
    <input type="hidden" name="button_subtype" value="products"/>
    <input type="hidden" name="no_note" value="0"/>
    <input type="hidden" name="tax_rate" value="20.000"/>
    <input type="hidden" name="shipping" value="5.00"/>
    <input type="hidden" name="add" value="1"/>
    <input type="hidden" name="bn" value="PP-ShopCartBF:btn_cart_LG.gif:NonHostedGuest"/>
    <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_cart_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!"/>
    <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1"/>
</form> 
```

I would like to adjust it so that I have one fixed delivery charge ... rather than repeating it for each item.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T20:54:52.423

看起来按钮已经按照您的意愿行事。它不会对每件商品重复收取 5 英镑的费用。

# javascript - 适用于 Node.js 和浏览器的模块系统？

> ID：16043470
> 
> 赞同：2
> 
> 时间：2013-04-16T17:35:50.253
> 
> 标签：javascript, node.js, browser, module

您正在编写一个依赖于 lib Y 的 lib X。您希望该库在 node.js 和浏览器上工作。在 node.js 上，您将使用`require('Y')`. 在浏览器上，您可以使用 require.js。实现它的正确方法是什么，以便您的库是跨平台的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T23:20:15.877

这个好像很流行……</p>

[https://github.com/substack/node-browserify](https://github.com/substack/node-browserify)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T01:42:06.363

你可以试试[https://github.com/component/component](https://github.com/component/component)。类似于browserify

# php - 403 Forbidden when I urlencode parameters

> ID：16043471
> 
> 赞同：0
> 
> 时间：2013-04-16T17:35:51.097
> 
> 标签：php, apache

我在 Windows 7 64 位系统上使用 Wamp 和 Apache 2.4.2。在我的测试中，我尝试了`urlencode`我的 url 字符串。

我收到以下 403 禁止错误消息：

> 您无权访问此服务器上的 /chi-linux/membersareaDev.php?doProfile=true。

没有 urlencoding 的链接不会出错。由于这是一个开发框，我确实可以访问 http.conf（没有更改）。我所有的代码都在 c:\wamp\www\chi-linux 如果我不进行 urlencode，我不会遇到权限问题。

这是我的代码：

```
<?php $url1 = urlencode("membersareaDev.php?doStatus=true?statid=10"); 
$url2 = urlencode("membersareaDev.php?doProfile=true");
echo "url=$url1";
?>
<li><a href="membersareaDev.php?doProfile=true">Profiles</a></li>
<li><a href=<?php echo "$url2"; ?> >Profiles Encode</a></li>
<li><a href= "membersareaDev.php?doStatus=true?amp;statid=10">Status</a></li>
<li><a href= <?php echo $url1;?>>Status Encode</a></li> 
```

关于我缺少什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:44:19.810

urlencode() 也对问号进行编码，因此您的 URL 变为：

membersareaDev.php%3FdoProfile%3Dtrue

这是不正确的，如果您担心用户输入，您不需要对整个 URL 进行 urlencode，只需单独传递的参数。

# subset - 如何仅对那些显示正斜率的数据进行子集化

> ID：16043473
> 
> 赞同：0
> 
> 时间：2013-04-16T17:35:59.840
> 
> 标签：subset

我正在尝试评估两个变量之间的相关性，但我的原始数据有很多需要消除的背景噪音。特别是，我只想保留显示正斜率的数据部分。我如何摆脱其他一切？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:50:25.210

我假设您的数据包含一些与您感兴趣的数据点数量非常不同的异常值，这些就是您所说的“噪声”。记住这个假设，我要么：

a) 将它们从我的数据中完全删除，并说明原因（这可能需要进行一些调查）。

b) 添加一个名为“Outlier”之类的变量，并将异常值的值设为 1，将其他值设为 0。然后，您可以根据该变量对分析进行分层或过滤数据。同样，您需要注意为什么您认为那些被标记为异常值的人不属于主要数据点的一部分。

# .htaccess - 如何使用 .htaccess 重定向过时的浏览器

> ID：16043474
> 
> 赞同：0
> 
> 时间：2013-04-16T17:36:02.230
> 
> 标签：.htaccess, redirect, browser, rewrite, obsolete

我尝试了此页面上的所有建议（[使用 .htaccess 重定向过时的浏览器](https://stackoverflow.com/questions/9916486/using-htaccess-to-redirect-obsolete-browsers)），但都没有奏效。我用谷歌搜索但没有找到一个可行的例子。

在处理具有两位数版本号的浏览器时，这些都不起作用。

例如，下面的行阻止了 Opera v.1.x 和 Opera v.12.x：

```
RewriteCond %{HTTP_USER_AGENT} "Opera/1\." [NC,OR] 
```

下面的代码也不起作用：

```
RewriteCond %{HTTP_USER_AGENT} "Opera/[1-11]\." [nc,or]
RewriteCond %{HTTP_USER_AGENT} "Opera/[1-9][0-1]?\." [nc,or] 
```

**重定向 Opera 版本 1.x-11.x 的正确代码是什么？**

我做了更多的测试，发现了一些对我来说很奇怪的东西。如果我尝试使用 Opera 版本 11 访问该站点，则在使用以下内容时，重写规则会不情愿地启动：

```
RewriteCond %{HTTP_USER_AGENT} "Opera/9\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/8\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/7\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/6\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/5\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/4\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/3\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/2\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/1\." [NC,OR] 
```

如果我只是评论...

```
RewriteCond %{HTTP_USER_AGENT} "Opera/9\." [NC,OR] 
```

... Opera 浏览器版本 11 不会被重定向。

更具体地说，如果它们符合规则，我会尝试将具有某些版本的某些浏览器重定向到特定页面。这是一个示例，但它没有按预期工作，我认为必须有一种更简洁的方式来编写每个条件：

```
<ifmodule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTP_USER_AGENT} "Firefox/3\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Firefox/2\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Firefox/1\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/9\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/8\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/7\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/6\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/5\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/4\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/3\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/2\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/1\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 7\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 6\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 5\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 4\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 3\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 2\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE 1\." [NC]
RewriteRule . http://www2.mysite.com/page.php [L]
</ifmodule> 
```

这是我正在尝试做的事情：

```
<ifmodule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTP_USER_AGENT} "Firefox/if less than version 3\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/if less than version 10.1\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE if less than version 7\." [NC]
RewriteRule . http://www2.mysite.com/page.php [L]
</ifmodule> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T02:16:35.250

下面的代码做我想要的：

```
<ifmodule mod_rewrite.c>
RewriteEngine on
RewriteCond %{HTTP_USER_AGENT} "Firefox/[1-3]\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} Opera/9\..*Version/(1[10]|[1-9])\. [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Opera/[1-8]\." [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "MSIE [1-7]\." [NC]
RewriteRule . http://www2.mysite.com/page.php [L]
</ifmodule> 
```

谢谢乔恩林！您的代码建议帮助我更好地理解了一点:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:22:36.057

尝试：

```
RewriteCond %{HTTP_USER_AGENT} Opera/(1[10]|[1-9])\. [NC,OR] 
```

* * *

看到 Opera 的用户代理如何不遵循您期望的格式，只需要这一行来排除 Opera 12：

```
RewriteCond %{HTTP_USER_AGENT} !Opera/9\..*Version/12\. [NC,OR] 
```

# c# - 使用 ASP.NET 播放 MP3 的一部分

> ID：16043475
> 
> 赞同：1
> 
> 时间：2013-04-16T17:36:03.787
> 
> 标签：c#, asp.net, mp3

我有一个巨大的 mp3 文件，可以运行 5 个小时。

我想创建一个 ASP.NET 网站，用户可以在其中在线收听部分内容。比如第 6 分钟到第 10 分钟。

我无法将整个文件下载到客户端。每个用户的文件也是相同的，只是时间会有所不同。

实现这一目标的有效方法是什么。我使用VS 2005。

附带说明一下，我计划在以后将该网站也移植到 Android 应用程序中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:53:53.367

如果您不想加载整个文件（可能很大，我假设大约 300 Mb ？）您可以将其拆分为 1 分钟文件的一部分（或更少...），然后只加载需要的文件部分。

您的文件名为`bigfile_1.mp3; bigfile_2.mp3`...

然后在您的客户端播放器中，如果您需要播放超过一分钟，您可以在用户听完第一个文件 30 秒后开始加载下一个文件，以此类推......

我不确定是否有一个 Flash mp3 播放器的 javascript 可以做到这一点，所以你可能必须自己做

这种技术也被像 Deezer 这样的直播音乐网站使用，以使下载仅用于在网站上收听的文件变得更加困难

# ios - NSMutableDictionary 作为数据源：无法删除单元格

> ID：16043480
> 
> 赞同：0
> 
> 时间：2013-04-16T17:36:22.387
> 
> 标签：ios, objective-c, nsmutabledictionary

我使用 NSMutableDictionary 来填充我的 UITableView，它工作得很好。但是，我想删除行，然后我必须在调用 -reloadData 方法之前从 Dictionary 中删除目标单元格。

我很难找到 NSMutableDictionary 中的正确对象并将其删除。我将在下面发布结构。

```
country = [
{
    citys = [
        {
            id = 4;
            cityName = New York;
        },
        {
            id = 5;
            cityName = LA;
        }
    ];

    id = 2;
    countryName = US;
},
{
    citys = [
        {
            id = 21;
            cityName = Oslo;
        }
    ];

    id = 31;
    countryName = Norway;
} 
```

];

我使用“countryName”值作为标题部分的名称。所以，我知道被点击的单元格，我如何在数组中找到该对象并将其删除。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:10:07.070

**希望你不会介意，如果我为你写一些代码。不要只是复制和粘贴它。试着理解它的方式。以便您将来可以解决此类需求。**

我有你的数据`plist`并将其提取到`NSMutableDictionary`然后`NSMutableArray`像这样。

```
// In the viewDidLoad: method
NSMutableDictionary *plistData = [NSMutableDictionary dictionaryWithContentsOfFile:[[NSBundle mainBundle]pathForResource:@"Countries" ofType:@"plist"]];
sectionedArray = [plistData objectForKey:@"Country"]; 
```

那么下面的`tableView`方法。

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return [sectionedArray count];
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    NSMutableArray *array = [[sectionedArray objectAtIndex:section] objectForKey:@"citys"];
    return [array count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc]initWithStyle:UITableViewCellStyleValue2 reuseIdentifier:CellIdentifier];;
    }
    // Configure the cell...
    NSMutableArray *array = [[sectionedArray objectAtIndex:indexPath.section] objectForKey:@"citys"];
    NSDictionary *dict = [array objectAtIndex:indexPath.row];
    cell.textLabel.text = [dict valueForKey:@"cityName"];
    return cell;
}

// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}

// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        NSMutableArray *array = [[sectionedArray objectAtIndex:indexPath.section] objectForKey:@"citys"];
        [array removeObjectAtIndex:indexPath.row];
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];

        NSLog(@"Sectioned array %@", sectionedArray);
    }   
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:26:28.253

使用新的[Objective-C Literals](http://clang.llvm.org/docs/ObjectiveCLiterals.html)语法：

```
// NSInteger section, row;
NSDictionary *countryData = country[section];
NSMutableArray *cityData = countryData[@"citys"];
[cityData removeObjectAtIndex:row]; 
```

*（注意，它的价值：城市*的英语复数是*城市*。）

# boost - boost::condition_variable 和 boost::mutex::scoped_lock

> ID：16043482
> 
> 赞同：0
> 
> 时间：2013-04-16T17:36:34.963
> 
> 标签：boost, locking, boost-thread

最初我是`boost::mutex::scoped_lock`这样使用的（有效）

```
boost::mutex::scoped_lock lock(mutex_name); 
condition.wait(lock); //where condition = boost::condition_variable 
```

但是后来我将锁更改为以下不起作用

```
boost::lock_guard<boost::mutex> lock(mutex_name)
condition.wait(lock); //Error 
```

有关如何解决问题的任何建议，我都会收到智能感知错误说明`No instance of the overloaded function matches the argument list`。编译错误是

```
Error   7   error C2664: 'void boost::condition_variable::wait(boost::unique_lock<Mutex> &)' : cannot convert parameter 1 from 'boost::lock_guard<Mutex>' to 'boost::unique_lock<Mutex> &' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:57:02.040

`boost::lock_guard`没有`unlock`成员函数，这是`condition`. 改用`unique_lock`：

```
boost::unique_lock<boost::mutex> lock(mut);
condition.wait(lock); 
```

# java - 返回一个空字符串

> ID：16043488
> 
> 赞同：0
> 
> 时间：2013-04-16T17:36:54.257
> 
> 标签：java

我正在通过一个按钮在框中调用一个带有输入的 textField 框，但它返回一个空字符串。这是相同的代码；

```
Panel Class
    //creates the textField
    panel1.add(text.getfname());

Class TextBoxes 

public JTextField getfname(){   
    JTextField fname = new JTextField(80);
    fname.setBounds( 100, 100, 150, 20 );
    fname.setSize(200,30);
    return fname;

    } 
```

以及调用 textField 的类

```
TextBoxes text = new TextBoxes();
String fname = text.getfname().getText(); 
```

我只是有点疑惑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:38:35.500

那么你正在创建一个*新* `JTextField`的内部`getfname`：

```
JTextField fname = new JTextField(80);
fname.setBounds( 100, 100, 150, 20 );
fname.setSize(200,30);
return fname; 
```

你*希望*它有什么内容？

我怀疑你真的打算返回一个*现有的* `JTextField`- 大概是一个已经显示给用户的。

我也会考虑将方法更改为返回 a`String`而不是文本框本身：

```
public String getFirstName() {
     // Or whatever the existing text box variable is called
    return firstNameField.getText();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:38:59.347

您总是在创建一个新的文本字段。

除非您*将*文本字段放在某处并在其中输入数据，否则它将始终为空。

# asp.net-mvc-4 - 糟糕的 WebAPI 性能

> ID：16043494
> 
> 赞同：7
> 
> 时间：2013-04-16T17:36:58.977
> 
> 标签：asp.net-mvc-4, asp.net-web-api, mvc-mini-profiler

我最近将我们现有的 ASP.NET MVC 2 应用程序转换为带有 WebAPI 后端的 MVC 4。不幸的是，我注意到一些关于 WebAPI 的严重性能问题。

我设置了 MiniProfiler 并添加了一些步骤来查看是否可以识别瓶颈，令我惊讶的是，它不是数据库。在转换之前，这样的请求不会超过 50 毫秒，所以看到这些简单的请求需要 2 秒以上的时间有点令人震惊。

![在此处输入图像描述](https://i.stack.imgur.com/xEhC1.png)

奇怪的是，所有这些都是大部分延迟发生在请求甚至到达 SQL 调用本身之前。

我想知道是否有一种已知的方法可以将 MiniProfiler 更深入地绑定到 WebAPI 的调用中，以进一步检查这里实际发生的情况。任何帮助将不胜感激。

FWIW，这是用于此请求的代码

WebAPI 控制器：

```
[HttpGet]
public bool AssetExistsById(string assetId) {
    using (Current.Profiler.Step("WebAPI Call To Model")) {
        return Asset.AssetExists(assetId);
    }
} 
```

资产模型：

```
public static bool AssetExists(string assetId) {
    using (Current.Profiler.Step("WCF call to DataAccess lib")) {
        return WcfEndPoint.AssetExists(assetId);
    }
} 
```

谢谢！

**更新**

所以我发现了这里发生了什么......事实证明我在我的`App_Start/WebApiConfig.cs`文件中启用了系统诊断跟踪。我随机注释掉了下面这行，一切都修复了。

```
config.EnableSystemDiagnosticsTracing(); 
```

我希望这对其他人有帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-04T20:19:31.620

所以我发现了这里发生了什么......事实证明我在我的`App_Start/WebApiConfig.cs`文件中启用了系统诊断跟踪。我随机注释掉了下面这行，一切都修复了。

```
config.EnableSystemDiagnosticsTracing(); 
```

我希望这对其他人有帮助！

# java - 有没有办法使用非 bean 样式对象作为弹簧形式的模型属性？

> ID：16043498
> 
> 赞同：3
> 
> 时间：2013-04-16T17:37:09.920
> 
> 标签：java, spring, spring-mvc

我正在使用第三方库，其中包含我希望能够通过 Spring（3.2 版）表单编辑的对象。问题在于该对象不使用 Java bean 命名约定，因为在某些情况下属性可能是动态的。相反，对象具有类似`object.getAttr("attribute_name")`和的方法`object.setAttr("attribute_name", value)`。我很容易编写 BeanWrapper 的实现来包装这种类型的对象，因为有一些方法可以查询哪些属性可用等。

我也不需要自定义编辑器，因为属性大多是内置类型。我所需要的只是一种自定义数据绑定的方法或找到一些其他方法来插入我的自定义 BeanWrapper，以便 Spring 的表单标记在绑定表单值时知道如何找到对象上的属性。看起来这应该相当容易（这**就是**为什么 BeanWrapper 是一个接口，对吧？）但我只是没有看到它......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T10:05:34.993

对于 3.2 版，您可以：

*   扩展`BeanPropertyBindingResult`和覆盖`createBeanWrapper()`方法。
*   扩展`ExtendedServletRequestDataBinder`和覆盖`getInternalBindingResult()`方法以返回您的`bindingResult`实例。
*   扩展`ServletRequestDataBinderFactory`并返回您的`databinder`实例。
*   扩展`RequestMappingHandlerAdapter`和覆盖`createDataBinder()`方法。
*   在调度程序 servlet 上下文中注册您的处理程序适配器，使用`order < Ordered.LOWEST_PRECEDENCE`.

所以我认为你需要扩展四个框架类来将自定义拉`BeanWrapper`入 Spring MVC。

也许有更简单的选择。

# php - SELECT WHERE IN 不检索所有记录

> ID：16043499
> 
> 赞同：0
> 
> 时间：2013-04-16T17:37:10.893
> 
> 标签：php, mysql, pdo, in-clause

编辑： *为了澄清，我使用 PDO 到 MySQL 数据库*

好的，我的查询有一点问题。我试过谷歌搜索和'stackoverflowing'，但无济于事。我正在尝试从名为*download store*的表中选择所有记录，其中 ownerid = '1'

```
//Partial code
 $sql="SELECT * FROM boughtdownloads WHERE ownerid=:userid";
 $prep=$GlobalDB->prepare($sql);
 $prep->bindParam(':userid',$userid,PDO::PARAM_INT);
 $prep->execute();
 if($prep->rowCount()=='0')
 {
   return 'Error with get owned IDS';
 }
 else
 {
   foreach($prep->fetchAll()as $res)
   {
      $owned[]=$res['fileid'];
   }
    $owned=implode(",",$owned);
    return $owned;
 } 
```

按预期工作，返回*1,2*

```
$OwnedIDS=$this->GetOwnedIDS($userid); // The same code as above ^
//This query doesn't work, even with the following:
//$OwnedIDS="1,2"; //Which is what's expected, and returned, from the above
$sql="SELECT * FROM downloadstore WHERE fileid IN (:owned)";
$prep=$GlobalDB->prepare($sql);
$prep->bindParam(':owned',$OwnedIDS);
$prep->execute();
if($prep->rowCount()=="0")
{
   return 'Error with remaining disk space';
}
 else
{
  echo $prep->rowCount();
} 
```

这仅返回 1 条记录，尽管*下载存储表* `$GlobalDB`中有两条记录= pdo 连接字符串（有效）

`$userid = $_SESSION`, 等于 "1"

[下载商店截图] ![下载存储表](https://i.stack.imgur.com/cU3tE.png)

[购买物品截图]

![购买物品表](https://i.stack.imgur.com/YZ5Xo.png)

如您所见，每个表中有 2 条记录，具有有效的 fileid。

但是在使用 IN 子句查询下载存储时，只提取了 1 条记录。

有人可以帮帮我吗？这可能是我忽略的一些愚蠢简单的事情，但我已经三重检查了，我确信我的查询或表格没有任何问题（尽管显然有）。

谢谢，罗伯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:42:57.600

您需要为数组的每个元素创建一个绑定参数，然后绑定每个元素：

```
$bindParams = array();
foreach ($ownerIds as $index => $ownerId) {
    $bindParams[] = ':ownerId' . $index;
}

$sql = 'select * from downloadstore where fileid in (' . implode(', ', $bindParams) . ')';
$prep = $db->prepare($sql);

foreach ($ownerIds as $index => $ownerId) {
    $prep->bindValue(':ownerId' . $index, $ownerId);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:39:34.047

在`MySQL`中，您不能绑定`IN`列表。

您应该在客户端解析它并在查询文本中传递它，而不是在绑定变量中：

```
# sanity checks for $ownerIds go here
$sql="SELECT * FROM downloadstore WHERE fileid IN (" . implode(',', $ownerIds) . ")"; 
```

或者，最好在服务器端做所有事情：

```
SELECT  ds.*
FROM    boughtdownloads bd
JOIN    downloadstore ds
ON      ds.fileId = bd.fileId
WHERE   bd.ownerId = :userId 
```

# java - Java执行字符串startsWith的最佳方式

> ID：16043507
> 
> 赞同：2
> 
> 时间：2013-04-16T17:37:49.690
> 
> 标签：java, string, tree, trie

我想比较提供的字符串是否以数组中的任何字符串开头。最简单的解决方案是：

```
String b = ...;
boolean matched = false;
for (String a : array) {
  if (b.startsWith(a))
    match = true;
} 
```

但是，直观地说，我想使用类似 trie 的东西来提高效率，因为字符串数组可能会变得非常大，我需要快速运行这些匹配。我可以保证这些字符串都是按字母顺序排列的。我还可以保证数组中的所有字符串的长度都为 2 或更少。在 Java 中实现这种类似 trie 的结构的最佳方法是什么？我找不到任何基于 Java 的库可以做到这一点。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T18:47:12.777

如果您确实有足够的起始字符串使其成为瓶颈，那么尝试可能确实会有所帮助。

这个问题已经在这个网站上被问到并得到了回答：[我在哪里可以找到 Java 中基于 Trie 的标准地图实现？](https://stackoverflow.com/questions/623892/where-do-i-find-a-standard-trie-based-map-implementation-in-java)

这就是答案： [https ://forums.oracle.com/forums/thread.jspa?messageID=8787521](https://forums.oracle.com/forums/thread.jspa?messageID=8787521)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:46:18.113

> 我想比较提供的字符串是否以数组中的任何字符串开头。

好吧-您当然可以改进当前的解决方案：

```
static boolean startsAny(final String b) {
    for (String a : array) {
        if (b.startsWith(a)) {
            return true;
        }
    }
    return false
} 
```

您可以将[String#matches](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#matches%28java.lang.String%29)与正则表达式一起使用，但我不确定这是否更有效。您是否分析了代码并将其确定为瓶颈？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-16T18:29:05.710

一个简单的解决方案是将字符串插入到 a 中`Set<String>`，然后对其执行两次查找，一次查找第一个字符，`b`如果不匹配，则查找前两个字符`b`。

例如，

```
class StartsWithAny {
    private Set<String> set;

    public StartsWithAny(String[] array) {
        set = new HashSet<String>();
        for (String a : array) {
            set.add(a);
        }
    }

    // returns true if b starts with any strings contained in array
    // with the condition that b.length() <= 2
    public boolean startsWithAny(final String b) {
        if (b.length() > 0 && set.contains(b.substring(0, 1))) {
            return true;
        }

        if (b.length() > 1 && set.contains(b.substring(0, 2))) {
            return true;
        }

        return false;
    }
} 
```

对此的一种变体是使用两个单独`Set`的 s，一个用于单字符查找，一个用于两个字符查找，这将稍微提高性能。

另一种类似的方法是实现一种二分搜索算法，该算法将对排序后的数组进行操作并执行类似的功能。

# pg-search - 尝试将文本搜索链接到使用 group_by 的连接表上的搜索时引发错误

> ID：16043512
> 
> 赞同：1
> 
> 时间：2013-04-16T17:37:56.280
> 
> 标签：pg-search

我有三个模型，故事，帖子和标签。Story 与 Post 是一对多的关系，与 Tag 是多对多的关系。

我使用以下范围来搜索至少有一个标签与一组标签匹配的故事：

```
scope :in_tags, lambda {|category_array, tag_array|
                            Story.joins('LEFT OUTER JOIN stories_tags ON stories_tags.story_id  = stories.id').
                                  joins('LEFT OUTER JOIN tags ON tags.id = stories_tags.tag_id').
                                  where("tags.name in (:tag_array)", :tag_array => tag_array ).
                                  group("stories.id")
  } 
```

请注意，我使用 GROUP_BY 以便如果该故事具有多个匹配标签，则范围不会多次返回该故事。

我使用以下 pg_search_scope 搜索具有指定文本的故事或帖子：

```
 pg_search_scope   :with_text, 
                    :against => :title, 
                    :using => { :tsearch => { :dictionary => "english" }},
                    :associated_against => { :posts => :contents } 
```

这两个范围都可以彼此独立地正常工作。但是，当我尝试将它们链接在一起时，我遇到了 postgreSQL 错误：

```
 ActiveRecord::StatementInvalid (PG::Error: ERROR:  column "pg_search_79dd68cf7f962ac568b3d7.pg_search_c5f43d73058486e1799d26" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...e"::text, '')) || to_tsvector('english', coalesce(pg_search_...
                                                             ^
: SELECT  "stories".*, ((ts_rank((to_tsvector('english', coalesce("stories"."title"::text, '')) || to_tsvector('english', coalesce(pg_search_79dd68cf7f962ac568b3d7.pg_search_c5f43d73058486e1799d26::text, ''))), (to_tsquery('english', ''' ' || 'track' || ' ''')), 0))) AS pg_search_rank FROM "stories" LEFT OUTER JOIN stories_tags ON stories_tags.story_id  = stories.id LEFT OUTER JOIN tags ON tags.id = stories_tags.tag_id LEFT OUTER JOIN (SELECT "stories"."id" AS id, string_agg("posts"."contents"::text, ' ') AS pg_search_c5f43d73058486e1799d26 FROM "stories" INNER JOIN "posts" ON "posts"."story_id" = "stories"."id" GROUP BY "stories"."id") pg_search_79dd68cf7f962ac568b3d7 ON pg_search_79dd68cf7f962ac568b3d7.id = "stories"."id" WHERE  (tags.name in (sports') AND (((to_tsvector('english', coalesce("stories"."title"::text, '')) || to_tsvector('english', coalesce(pg_search_79dd68cf7f962ac568b3d7.pg_search_c5f43d73058486e1799d26::text, ''))) @@ (to_tsquery('english', ''' ' || 'track' || ' ''')))) GROUP BY stories.id ORDER BY latest_post_id DESC LIMIT 5000 OFFSET 0): 
```

有没有办法将 pg_search 与需要带有 GROUP_BY 子句的连接表的范围一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T16:08:25.107

我最终不得不从`.group()`方法（我似乎无法使用 pg_search）切换到`select("DISTINCT(stories.id), stories.*)`. 我也利用`ActiveRecords#preload`so 急切地加载相关的标签记录

# sql - SQL Server TRY...CATCH 与 XACT_STATE

> ID：16043513
> 
> 赞同：11
> 
> 时间：2013-04-16T17:37:58.917
> 
> 标签：sql, sql-server, msdn

我对块的 MSDN 文档有疑问`TRY CATCH`。查看这篇文章并向下滚动到示例 C“使用 TRY…CATCH 和 XACT_STATE”

[http://msdn.microsoft.com/en-us/library/ms175976.aspx](http://msdn.microsoft.com/en-us/library/ms175976.aspx)

该示例首先将 a`COMMIT TRANSACTION`放在 Try 块中，然后将第二个放在 Catch 块中 if `XACT_STATE()=1`。

但是我认为 Catch 块只会在出现错误的情况下执行。那么 Catch 块如何执行并`XACT_STATE`返回 1 呢？这似乎很矛盾。

文档中有一条未答复的评论`XACT_STATE`提出了同样的问题

[http://msdn.microsoft.com/en-us/library/ms189797.aspx](http://msdn.microsoft.com/en-us/library/ms189797.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-15T11:51:33.483

@user1181412 我的分析如下： 此评论：

> -- 此表上存在 FOREIGN KEY 约束。
> 
> --该语句会产生约束违规错误

是您问题的答案。发生的情况是，当 DELETE 语句执行时，它会生成约束冲突错误，并且后续的 COMMIT 不会执行。事务的 XACT_STATE 现在为 1，并且正在执行 CATCH 块。

在顶部，您有

> 设置 XACT_ABORT 开；

这会导致事务状态不可提交，因此此代码块将回滚事务：

```
-- Test whether the transaction is uncommittable.
IF (XACT_STATE()) = -1
BEGIN
    PRINT
        N'The transaction is in an uncommittable state.' +
        'Rolling back transaction.'
    ROLLBACK TRANSACTION;
END; 
```

但是，如果您更改为“SET XACT_ABORT OFF;” 然后 CATCH 块将被命中，尽管事务状态**将**是“可提交的”，因为**XACT_STATE = 1**。

注意：仍然不会执行删除，因为约束冲突仍然存在，但您会看到打印出来的内容：

> （1 行受影响）事务是可提交的。正在提交事务。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-04-12T21:17:19.280

> **XACT_STATE**是一个向用户返回正在运行的事务状态的函数。
> **XACT_STATE**指示请求是否有活动的用户事务，以及该事务是否能够被提交。
> 
> （请记住，通常错误发生在更新/插入而不是选择查询上）。

**XACT_STATE 有 3 种状态：**

> **1** : Transaction 块内的查询处于活动状态且有效（未引发错误）。
> **0** : 查询不会抛出错误（例如，事务内的选择查询没有更新/插入查询）。
> **-1** : 事务内部的查询抛出错误（进入 catch 块时）并将进行**完整**的回滚（如果我们有 4 个成功的查询和 1 个抛出错误，则所有 5 个查询都将回滚）。

例子 ：

```
 BEGIN TRY    
    BEGIN TRANSACTION;
        -- A FOREIGN KEY constraint exists on this table.  
        -- This statement will generate a constraint violation error.
        DELETE FROM Production.Product
            WHERE ProductID = 980;

    -- If the delete operation succeeds, commit the transaction. The CATCH
    -- block will not execute.
    COMMIT TRANSACTION; 
    END TRY
    BEGIN CATCH
    -- Test XACT_STATE for 0, 1, or -1.

    -- Test whether the transaction is uncommittable.
    IF (XACT_STATE()) = -1
    BEGIN
        PRINT 'The transaction is in an uncommittable state.' +
              ' Rolling back transaction.'
        ROLLBACK TRANSACTION;
    END;

    -- Test whether the transaction is active and valid.
    IF (XACT_STATE()) = 1
    BEGIN
        PRINT 'The transaction is committable.' + 
              ' Committing transaction.'
        COMMIT TRANSACTION;   
    END;
    END CATCH 
```

参考：
[https ://docs.microsoft.com/en-us/sql/t-sql/functions/xact-state-transact-sql](https://docs.microsoft.com/en-us/sql/t-sql/functions/xact-state-transact-sql) [http://www.advancesharp.com/blog/1017/sql-transaction-status -and-xact-state](http://www.advancesharp.com/blog/1017/sql-transaction-status-and-xact-state)

# sql-server - Ident_current() 是如何工作的

> ID：16043516
> 
> 赞同：0
> 
> 时间：2013-04-16T17:38:23.317
> 
> 标签：sql-server

Ident_Current() 从哪里得到它的返回值？

我想找到保存身份值的系统表。有关 ident_current 如何工作的任何信息也会有所帮助。

请注意，我了解 ident_current 的作用，只是不知道它在哪里获得价值或它是如何做到的。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:50:28.237

您不能完全按照实际操作进行`IDENT_CURRENT()`操作，因为它的操作没有正式记录。你可以得到相同的答案 - 模拟什么`IDENT_CURRENT()`- 从：

```
SELECT COALESCE(last_value, seed_value)
  FROM sys.identity_columns
  WHERE [object_id] = OBJECT_ID('dbo.tablename')); 
```

我 10 分钟前在你[的另一个问题中回答了这个问题](https://stackoverflow.com/questions/16042439/which-is-faster-max-or-ident-current)。

如果你想测试速度有多快`IDENT_CURRENT`，那么 test `IDENT_CURRENT`，不要试图模拟它的功能，因为这不一定是一个有效的测试`IDENT_CURRENT`（例如，它可能可以从内存中检索这些，而你可以' t)。

# java - Java有最奇怪的错误

> ID：16043518
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:38:24.847
> 
> 标签：java, arraylist, binary-tree

当我运行以下代码时：

```
class zTree<T>
{
    ArrayList<ArrayList<T>> table = new ArrayList<ArrayList<T>>();
    int height = 0;

    <T> void zTree(BinaryTree<T> tree)
    {
        recIt((BinaryTree<T>)tree, 1);
    }

    void recIt(BinaryTree<T> tree, int fromRoot)
    {
        if(!(tree.isEmpty()))
        {
            ArrayList<T> tempList = (ArrayList<T>)table.get(fromRoot);
            tempList.add((T)tree.getData()); // add data to table
            recIt(tree.left,fromRoot+1); // recursive left,
            recIt(tree.right,fromRoot+1); // right
        }
        else
        {
            height = fromRoot-1;
        }
    }
} 
```

Javac 返回此错误。

```
zTree.java:15: recIt(structures.tree.BinaryTree<T>,int) in zTree<T> cannot be applied to (structures.tree.BinaryTree<T>,int)
        recIt((BinaryTree<T>)tree, 1);
        ^
1 error 
```

我不关心我的代码的效率。我很想知道出了什么问题，但是 javac 显然没有太大帮助，因为它告诉我 (x,y) 不能应用于 (x,y) ...但是为什么呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T17:40:57.933

问题是`T`in`zTree` *方法*（奇怪地与它的封闭类具有相同的名称 - 不要那样做）与`T`in the `zTree` *class*不同，因为该方法是通用的：

```
<T> void zTree(BinaryTree<T> tree) 
```

如果你让它*不是*通用的，它应该没问题，因为现在方法中的类型参数将与你正在调用的方法中的`T`含义相同。`T`

```
void zTree(BinaryTree<T> tree) 
```

我*强烈*建议 use 开始遵循 Java 命名约定，并且*绝对*不要创建与声明它们的类同名的任何方法。

如果该方法是*一个*构造函数，你应该去掉返回类型：

```
zTree(BinaryTree<T> tree) 
```

（并且仍然修复类名。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T17:41:16.623

当您说时，您声明了`zTree`通用方法

```
<T> void zTree(BinaryTree<T> tree) 
```

我怀疑你想创建一个构造函数。如果是这样，请不要使用返回类型。但是，您已经将您的类声明为泛型；只需使用您的班级`T`：

```
zTree(BinaryTree<T> tree) 
```

此外，按照惯例，Java 类名以大写字母开头，例如`ZTree`.

# html - 嵌套的最小高度不起作用

> ID：16043519
> 
> 赞同：5
> 
> 时间：2013-04-16T17:38:29.157
> 
> 标签：html, css

我有一个固定大小的绝对定位区域，滚动条包含可变大小的内容。

现在我需要将内容包装在两个 div 中，这些 div 至少与 area 一样大，但可以扩展以适应内容。

```
<div id="area">
    <div id="outer">
        <div id="inner">
            <div id="content">content</div>
        </div>
    </div>
</div> 
```

要求：

1.  它们需要扩展，因此它们的高度必须设置为自动。
2.  为了填充容器，它们的最小尺寸必须为 100%

因此，我尝试了以下 CSS（[JsFiddle](http://jsfiddle.net/5aj6k/4/)中的完整示例）：

```
#area {
    /* defined outside */
    position: absolute;
    width: 100%;
    height: 100%;
    padding: 20px;
    box-sizing: border-box;
    overflow: scroll;
}

#outer, #inner {
    min-width: 100%;
    min-height: 100%;
} 
```

它确实有效，`#outer`但对`#inner`. 我该如何解决？

**更新** 如果有帮助，我只对 Chrome 感兴趣。

另外，我可以接受，如果指向一些权威来源并进行解释，这可能是不可能的。

**更新 2**

因此，我分析了 CSS 规范并得出无法满足我的要求的结论：

1.  要使最小高度起作用，它必须绝对定位，或者它包含的块高度不能依赖于内容高度[CSS2(10.7)](http://www.w3.org/TR/CSS2/visudet.html#propdef-min-height)

2.  我需要自动调整大小，因此既`#inner`不能也`#outer`不能绝对定位。这意味着包含块必须具有指定的高度。

3.  因此`#outer`不能包含`#inner`. 这给我留下了`#area`.

4.  根据[CSS2(10.1)](http://www.w3.org/TR/CSS2/visudet.html#containing-block-details)，只有`#inner`当元素绝对定位时才有可能，这与我的目标冲突。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:46:12.873

`#inner`使用百分比高度意味着它基于其父级的高度，`#outer`未指定为精确`%`或`px`：

```
#area {
    position: absolute;
    top:0;
    left:0;
    right:0;
    bottom:0;
    padding: 20px;
    box-sizing: border-box;
}

#outer,#inner {
    min-width: 100%;
    min-height: 100%;
}

#outer {
    height:100%;
    overflow: auto;
} 
```

[这里提供的 jsFiddle](http://jsfiddle.net/YNqkj/2/)，它以颜色显示`#inner`为`#outer`.

我也采取了一些自由。我将您的`#area`CSS 设置为更合适的全高/全宽设置，并且我制作了您的滚动组件`#outer`而不是`#area`，因为`#inner`将是溢出它的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:09:01.807

你的最小高度至少应该基于`px`我`%`解决问题的方法。只用一个合理的`pixel-height`

这样，内部总是和外部一样大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:46:19.017

我不确定我是否正确理解了这个问题，应该扩展内部或内容？

假设您希望内部扩展以填充外部。如前所述，您还需要 100% 的高度，以及内部的绝对位置

然后取决于应该在内部或内容上滚动的内容

```
#outer {
background: red;
position: static;
min-width: 100%;
min-height: 100%;
}
#inner {
background: blue;
position: absolute;
min-width: 100%;
min-height: 100%;
height:100%;
overflow:auto;
}
#content {
height: 200px;
background-color:yellow;
overflow:auto;
} 
```

[此处的示例 - 带有滚动的内容](http://jsfiddle.net/5aj6k/4/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:45:23.723

如果你改变`min-height: 100%;`它`height: 100%;`会工作。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-16T17:46:26.273

```
#outer, #inner {
    height:100%;
    min-width: 100%;
} 
```

# solr - 将 Solr 与 Web 应用程序集成

> ID：16043523
> 
> 赞同：0
> 
> 时间：2013-04-16T17:38:36.900
> 
> 标签：solr, lucene

**上下文：**
我有一个通过 RESTful Web 服务提供内容的 Web 应用程序，
我需要提供搜索功能

这就是我的想法。我是在正确的轨道上还是偏离了方向？

**索引种子客户端：**
此组件将在重复的时间间隔轮询应用程序以获取数据
（我有一个返回 XML 响应的 WS）
，然后将 XML 发布到 EMS

**队列侦听器：**
队列侦听器将域 XML 转换为 Solr doc
并将文档发布到 Solr 以进行索引

**搜索客户端：**
客户端将使用查询参数向我
的 Web 应用程序发出搜索请求 Web 应用程序会将请求转发给 Solr
Solr 将搜索结果返回给我的 Web 应用程序
我的 Web 应用程序将结果返回给客户端

**交替流 ?**
搜索客户端直接与 Solr 对话并进行搜索。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T14:25:31.723

搜索将取决于您对 solr 服务器的实现选择。如果您使用 embbededSolrServer，您将需要通过您的 Web 客户端进行查询，然后调用 sol. 如果您使用的是 httpsolrserver，那么您可以直接查询 solr。

它还取决于您希望如何返回结果。作为solr文件？还是您自己对 solr 文档的解释？后者必须由您的 Web 应用程序提供服务

# mysql - 如何在连接两个表时在一个字段的末尾附加一个变量

> ID：16043525
> 
> 赞同：0
> 
> 时间：2013-04-16T17:38:50.707
> 
> 标签：mysql, sql

我的数据库表中有一个名为commment_user 的字段。在此字段中，我以以下格式存储了 comment_id + user_id

```
110-26 
```

上面第 110 行是 comment_id，第 26 行是 user_id。现在我想 LEFT JOIN 这两个表。

我有一个左加入

```
`comments LEFT JOIN votes on comments.commment_user = votes.comment_id` 
```

但是我想在 votes.comment_id 的末尾附加 user_id 例如

```
`comments LEFT JOIN votes on comments.commment_user(13-10) = (votes.comment_id(13) - user_id(10))` 
```

这不是正确的 SQL 查询，因为我不知道如何在 sql 中执行此操作，只是为了让您理解。

在上面的示例`(votes.comment_id(13) - user_id(10))`中，它没有将“-”显示为减号，而是表示 13-10。那么，是否可以在连接两个表时在一个字段的末尾附加 user_id，如果是，我该如何在 sql 查询中编写它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:41:21.043

我想你想要这个`concat()`功能：

```
comments LEFT JOIN
votes
on comments.commment_user = concat(votes.comment_id, '-', votes.user_id) 
```

尽管这解决了您的问题，但我建议将`comment_id`和`user_id`单独存储在`votes`表中。摆弄这种组合会使数据库效率降低。在这种情况下，问题被放大了，因为引擎必须将 id（可能是数字）与字符串进行比较。

# c++ - 在使用其他图形时使用 SDL_ttf 绘制文本

> ID：16043527
> 
> 赞同：0
> 
> 时间：2013-04-16T17:39:03.483
> 
> 标签：c++, sdl, codeblocks, sdl-ttf, sdl-image

我正在使用 SDL 制作这个游戏，我需要能够为变量和信息等显示文本。问题是我无法渲染任何文本，而 SDL_OPENGL 是 SDL_SetVideoMode() 中的参数。

没有它可以完美地工作，但我无法渲染我的任何图形。显然我需要两者，我宁愿不去为文本绘制图像。

TL;DR 我需要在不从 SDL_SetVideoMode(SCREEN_WIDTH,SCREEN_HEIGHT,32,SDL_SWSURFACE | SDL_OPENGL) 中删除 SDL_OPENGL 的情况下绘制文本；

如果有帮助，我正在使用 C++ 和 code::blocks。还需要什么其他信息吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T16:58:58.970

因此，经过一些工作后，我想出了如何自行修复它，我只是像处理常规图片一样转换了表面。如果其他人有兴趣或有类似问题，这是我使用的功能。

```
GLuint importText(const std::string &text,int font_size,const __int8 red,const __int8 green,const __int8 blue){
SDL_Color font_color = {blue,green,red};
TTF_Font* font=TTF_OpenFont("Font.ttf",font_size);
SDL_Surface *image = TTF_RenderText_Blended(font,text.c_str(),font_color);
SDL_DisplayFormatAlpha(image);
unsigned object(0);
glGenTextures(1,&object);
glBindTexture(GL_TEXTURE_2D, object);
glTexParameterf(GL_TEXTURE_2D,GL_TEXTURE_MIN_FILTER,GL_LINEAR);
glTexParameterf(GL_TEXTURE_2D,GL_TEXTURE_MAG_FILTER,GL_LINEAR);
glTexParameterf(GL_TEXTURE_2D,GL_TEXTURE_WRAP_S,GL_CLAMP_TO_EDGE);
glTexParameterf(GL_TEXTURE_2D,GL_TEXTURE_WRAP_T,GL_CLAMP_TO_EDGE);
glTexImage2D(GL_TEXTURE_2D, 0,GL_RGBA,image->w,image->h,0,GL_RGBA,GL_UNSIGNED_BYTE,image->pixels);
texture_height=image->h; texture_width=image->w;
SDL_FreeSurface(image);
TTF_CloseFont(font);
return object;} 
```

# ember.js - Ember JS CollectionArray 闪烁

> ID：16043529
> 
> 赞同：0
> 
> 时间：2013-04-16T17:39:06.707
> 
> 标签：ember.js

当您在 ArrayController 中有大量对象时，有时您可以在切换到该视图时看到列表逐渐在页面上构建。

有没有办法只在列表构建后显示视图，以避免闪烁的界面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:44:48.700

> Is there a way to only show the view after the list has been built, in order to avoid a flickering interface?

It sounds like what you need is Ember.ListView - it improves performance for very large collections by rendering just enough rows to fill the visible area.

```
{{#collection Ember.ListView contentBinding="controller" height=500 rowHeight=50}}
  <!-- row content here -->
{{/collection}} 
```

*   Demo on jsbin: [http://jsbin.com/ucegit/1/edit](http://jsbin.com/ucegit/1/edit)

*   [https://github.com/emberjs/list-view](https://github.com/emberjs/list-view)

# java - 在 Java 中使用 selenium 等待元素加载的问题

> ID：16043531
> 
> 赞同：0
> 
> 时间：2013-04-16T17:39:18.173
> 
> 标签：java, selenium, webdriver

我正在尝试使用 Selenium 在使用 ajax 和/或 jquery 加载的页面上查找 webElement。

似乎无论我做什么，都找不到该元素。

我正在使用 Firefox 20 和 Selenium 2.31.0。

我试图获取的那个部分的 html 看起来像这样（我使用 firefox 中的 Inspector Tool 得到了这个）：

```
 <form id="file_upload" method="post" enctype="multipart/form-data" action="myAction.php">
    <table class="table table-striped">
      <tbody>
        <tr>
          <td>
            <input class="input-file" type="file" name="file"></input>
            <input class="btn btn-primary" type="submit" value="upload"></input>
          </td>
          <td style="text-align:right;"></td>
        </tr>
      </tbody>
    </table>
  </form> 
```

我努力了：

```
WebDriverWait driverWait = new WebDriverWait(driver, 10000);

WebElement dynamicElement =  driverWait.until(ExpectedConditions.presenceOfElementLocated(By.id("file_upload")));

System.out.println(dynamicElement.getText()); 
```

我试过了：

```
WebElement dynamicElement = new FluentWait<WebDriver>(driver).withTimeout(1,  TimeUnit.MINUTES).pollingEvery(1, TimeUnit.SECONDS)
    .ignoring(NoSuchElementException.class).until(ExpectedConditions.visibilityOfElementLocated(By.id("file_upload")));

System.out.println(dynamicElement.getText()); 
```

但是我尝试的任何东西都找不到它，或者无论我给它多少时间来找到那个元素都会超时。任何帮助将非常感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T09:38:04.590

```
// to make sure you are in the default content
// this is not necessary in the most of the cases
driver.switchTo().defaultContent(); // use only if you are in a frame already

driver.switchto().frame("framename or id");
//driver.switchto().frame(driver.findElement(By.xpath("frame locator")));
//driver.switchto().frame(zero-based frameindex);

// now in the frame
WebDriverWait driverWait = new WebDriverWait(driver, 10000);
WebElement dynamicElement = driverWait.until(ExpectedConditions.presenceOfElementLocated(By.id("file_upload")));
System.out.println(dynamicElement.getText());

// if you want to get out of all frames back to default content
driver.switchTo().defaultContent(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:20:20.067

尝试升级 Selenium。不确定它是否是唯一的问题，但[Selenium 2.32.0](https://code.google.com/p/selenium/downloads/list)支持 FF 20 。

[Selenium 历史](https://code.google.com/p/selenium/wiki/History)- 页面底部的注释显示 FF 20 支持。

# python - 我将什么参数传递给 celery 的 get_task_logger() 函数？

> ID：16043532
> 
> 赞同：8
> 
> 时间：2013-04-16T17:39:21.867
> 
> 标签：python, celery

The [celery 3.x docs on logging](http://docs.celeryproject.org/en/latest/userguide/tasks.html#logging)建议像这样设置任务记录器：

```
from celery.utils.log import get_task_logger
logger = get_task_logger(__name__) 
```

当我这样做时，`CELERYD_TASK_LOG_FORMAT`将被忽略并使用日志语句`CELERYD_LOG_FORMAT`代替，我无法使用`%(task_name)s`and `%(task_id)s`。

`tasks`我的任务在我的应用程序的一个模块中`myapp`。因此，`__name__`是`myapp.tasks`。

我认为问题出在以下几行`celery/utils/log.py`：

```
def get_task_logger(name):
    logger = get_logger(name)
    if logger.parent is logging.root:
        logger.parent = task_logger
    return logger 
```

因此，无论出于何种原因，传递给的模块`get_task_logger()`必须是第一级模块，否则不会附加任务记录器。没有评论解释为什么会这样（我想不出你为什么要添加这个限制，真的）。`__name__`不起作用，因为它引用了二级模块。

我犯了错误还是文档错了？如果是这样，我应该传递给`get_task_logger()`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-05T14:21:19.530

从 2014 年 10 月 5 日起，情况不再如此。现在通过`__name__`似乎工作正常（[当前实现](https://github.com/celery/celery/blob/6ea6f24558df8037931345c1fbb299e947bfee46/celery/utils/log.py#L106)）。

请记住，您的任务记录器仍将被迫从`celery.task`. 默认情况下，它的父记录器`celery`不会传播到根记录器，因此您可能希望`celery.task`在日志配置中定义一个记录器。

# ios - 圆形 CAGradientLayer 蒙版

> ID：16043534
> 
> 赞同：1
> 
> 时间：2013-04-16T17:39:25.507
> 
> 标签：ios, objective-c, uiview, calayer, quartz-core

我有`UIView`一个[使用](https://stackoverflow.com/questions/10399958/iphone-ios-generate-star-sunburst-or-polygon-uibezierpath-programmatically). `UIBezierPath`现在我想通过用渐变遮蔽边缘来扩展它——有效地使每个“突发”从不透明淡化为透明。我认为这可以用`CAGradientLayer`面具来完成，但我不知道如何使它成为圆形。

这就是我正在尝试的——它掩盖了视图，但渐变是线性的：

```
 CAGradientLayer *l = [CAGradientLayer layer];
    l.frame = CGRectMake(0.0f, 0.0f, rect.size.width, rect.size.height);
    l.cornerRadius = rect.size.width/2.0f;
    l.masksToBounds = YES;
    l.colors = [NSArray arrayWithObjects:(id)[UIColor blackColor].CGColor, (id)[UIColor clearColor].CGColor, nil];
    self.layer.mask = l; 
```

`CAGradientLayer`如果有人知道用边缘模糊的圆圈掩盖视图的任何其他方法，我愿意不使用。

**解决方案** 感谢 matt 的洞察力，我最终使用 绘制了一个遮罩视图`CGContextDrawRadialGradient`，将其渲染为`UIImage`，并将其用作遮罩层。如果有人对这个过程感兴趣，它正在[这个测试项目中使用。](http://github.com/meekapps/Sunburst)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:24:33.507

一个明显的方法是手动绘制这种效果。从很小的地方开始，将旭日形画得越来越大，并且（同时）越来越不透明。

另一方面，制作径向渐变并将其用作蒙版（晕影效果）可能就足够了。Core Graphics 将为您绘制径向渐变：

[https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextDrawRadialGradient](https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CGContext/Reference/reference.html#//apple_ref/c/func/CGContextDrawRadialGradient)

我也非常喜欢 CIFilters 添加这样的触摸：你应该查看目录，看看你喜欢什么：

[https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html](https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CoreImageFilterReference/Reference/reference.html)

CIFilter 实际上*为*您提供了可能适合您的目的的旭日形过渡，尤其是在与遮罩和合成结合使用时；这是我的书中对旭日形首饰（在动画中使用）的讨论：

[http://www.aeth.com/iOSBook/ch17.html#_cifilter_transitions](http://www.apeth.com/iOSBook/ch17.html#_cifilter_transitions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:46:15.160

`CAGradientLayer`绘制线性渐变。

您可以尝试设置阴影，看看是否适合您的需求：

```
l.shadowColor = [UIColor blackColor];
l.shadowRadius = rect.size.width / 2; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:16:15.487

您可以通过创建一个 CALayer 实例并给它一个实现 drawLayer:inContext: 的委托并在该方法的实现中绘制一个径向渐变来做到这一点。然后使用那个 CALayer 作为你的面具。

# php - 这个 PDO 代码有效吗？

> ID：16043536
> 
> 赞同：0
> 
> 时间：2013-04-16T17:39:25.727
> 
> 标签：php, sql, pdo

我已经从我的代码中提取了这个片段，因为我担心有更好的方法来做到这一点。我希望有人可以帮助我或为我指明正确的方向。

基本上这段代码检查数据库中的许多表并检查结果是否返回。

```
 $stmt = $conn->prepare('SELECT email FROM 1table WHERE email = :email'); 
    $stmt = $conn->prepare('SELECT email FROM 2table WHERE email = :email');
    $stmt = $conn->prepare('SELECT email FROM 3table WHERE email = :email'); 
    $stmt->bindParam(':email', $email);
$stmt->execute();
    if($stmt->fetch(PDO::FETCH_NUM) > 0){ 
```

有没有更好的办法？或更有效的方式，它可以告诉我结果是在哪个表中找到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:56:13.717

以前的回答者都没有向您展示如何知道数据来自哪个表。所以，如果这是相关的，这是正确的`UNION`

```
$sql  = "SELECT email, '1table' as fromTable  FROM 1table WHERE email = :email"; 
$sql .= " UNION ALL"; 
$sql .= " SELECT email, '2table' FROM 2table WHERE email = :email"; 
$sql .= " UNION ALL"; 
$sql .= " SELECT email, '3table' FROM 3table WHERE email = :email"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:42:20.770

这只会使用最后一个查询。你可以这样做：

```
$stmt = $conn->prepare('
    (SELECT email FROM 1table WHERE email = :email)
    union all
    (SELECT email FROM 2table WHERE email = :email)
    union all
    (SELECT email FROM 3table WHERE email = :email)'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:40:54.667

它是有效的 PHP，但您的逻辑无效：

```
$stmt = $conn->prepare('SELECT email FROM 1table WHERE email = :email'); 
$stmt = $conn->prepare('SELECT email FROM 2table WHERE email = :email');
$stmt = $conn->prepare('SELECT email FROM 3table WHERE email = :email'); 
```

`$stmt`您不断用新值覆盖。这意味着`$stmt`它将只包含最后一个准备语句。

您可以查看`UNION`并修改您的代码，如下所示：

```
$sql = '(SELECT email FROM 1table WHERE email = :email)'; 
$sql .= 'UNION ALL'; 
$sql .= '(SELECT email FROM 2table WHERE email = :email)'; 
$sql .= 'UNION ALL'; 
$sql .= '(SELECT email FROM 3table WHERE email = :email)'; 
$stmt = $conn->prepare($sql); 
```

# c++ - 返回中的“>”是什么意思

> ID：16043537
> 
> 赞同：-3
> 
> 时间：2013-04-16T17:39:27.397
> 
> 标签：c++

我想问一下return中的">"是什么意思

例如

```
 bool Product::is_better_than(Product b) const
   {
     if (price == 0) return true;
     if (b.price == 0) return false;
     return score / price > b.score / b.price;
   } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T17:40:36.340

```
 return score / price > b.score / b.price; 
```

在功能上，它与以下内容相同：

```
if ( score / price > b.score / b.price)
{
   return true;
}
else
{
   return false;
} 
```

速记表达。也与：

```
return (score / price > b.score / b.price); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T17:41:16.807

`>`代表**大于**。这是一个布尔运算符，它返回：

*   `true`如果第一个操作数 ( `score / price`) 大于第二个操作数 ( `b.score / b.price`)。
*   `false`如果第一个操作数小于或等于第二个操作数。

因为`/`优先于`>`你也可以写。-

```
return (score / price) > (b.score / b.price); 
```

使您的代码更具可读性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:42:35.313

逻辑语句的结果，例如`x > y`are `bool`。所以，

```
score / price > b.score / b.price 
```

检查左手项是否大于右手项。如果是，则结果为`true`否则`false`。

确定结果后，它返回该布尔值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:41:18.073

它与其他任何地方的比较相同，如果`score/price`大于，函数将返回 true `b.score/b.price`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T17:41:21.233

大于的意思。像 5 > 4

# intellij-idea - 从 JSMin/JSFormat 导入格式到 intellij idea

> ID：16043538
> 
> 赞同：0
> 
> 时间：2013-04-16T17:39:29.303
> 
> 标签：intellij-idea, notepad++, jsmin

有谁知道哪些格式化规则使用 Notepad++ 的 jsmin/jsformatter 插件？我需要这个，因为我们被迫使用这个格式化程序，但我正在使用 intellij idea 来编写 js 代码。所以有了这个规则，我可以以某种方式导入它，或者至少手动应用。

提前谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T15:12:20.220

此处列出了应用的最小化规则：

[http://www.crockford.com/javascript/jsmin.html](http://www.crockford.com/javascript/jsmin.html)

> JSMin 是一个过滤器，可以省略或修改某些字符。这不会改变它正在缩小的程序的行为。结果可能更难调试。它肯定会更难阅读。
> 
> JSMin 首先用换行符（'\n'）替换回车符（'\r'）。它用空格替换所有其他控制字符（包括制表符）。它将 // 表单中的注释替换为换行符。它用空格替换 /* */ 形式的注释。所有的空格都替换为一个空格。换行的所有运行都替换为单个换行。
> 
> 它省略空格，除非空格前后有非 ASCII 字符或 ASCII 字母或数字，或以下字符之一：
> 
> \ $ _
> 
> 在省略换行方面更为保守，因为换行有时被视为分号。如果换行符位于非 ASCII 字符或 ASCII 字母或数字或以下字符之一之前，则不会省略换行符：
> 
> \ $ _ { [ ( + -
> 
> 如果它跟在非 ASCII 字符或 ASCII 字母或数字或以下字符之一之后：
> 
> \ $ _ } ] ) + - " '
> 
> 没有省略或修改其他字符。

根据插件开发者的页面应用了其他自定义格式规则：

[http://www.sunjw.us/jsminnpp/](http://www.sunjw.us/jsminnpp/)

# c++ - 如何指定 MatExpr 的结果类型？

> ID：16043540
> 
> 赞同：0
> 
> 时间：2013-04-16T17:39:34.243
> 
> 标签：c++, opencv

我的代码中有这个表达式： `*h = ((*R) / ((*G) + (*R)));` 其中 R、G 和 B 是 Mat 指针，`uchar`因为存在除法我想将答案转换为 Mat 指针`float`

所以我尝试了这个 `*h = Mat_<float>((*R) / ((*G) + (*R)));`

但我得到了分段错误。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:20:45.350

您需要将矩阵 *R 转换为浮点数。使用方法`Mat::convert_to`。假设 R8 是 uchar 的矩阵，您可以按如下方式创建浮点矩阵：

```
Mat R32; R8.convertTo(R32,CV_32F); 
```

这在OpenCV[简介](http://docs.opencv.org/modules/core/doc/intro.html)中得到了很好的解释。

Note 1: This expression `*h = Mat_<float>((*R) / ((*G) + (*R)))` performs division using uchars and later re-interpret the result as float, which is wrong. `Mat_<float>` is only to simplify element access for arrays that are already floats.

Note 2: You don't need to use pointers to Mat most of the time.

# c - 保存后 Arduino 代码无法编译

> ID：16043541
> 
> 赞同：4
> 
> 时间：2013-04-16T17:39:37.040
> 
> 标签：c, compilation, arduino

每次我运行下面的代码而不保存时，它都会编译。当我保存它时，我收到错误：

> C:\Program Files (x86)\Arduino\arduino-1.0.4\hardware\arduino\cores\arduino/main.cpp:11：未定义对“设置”的引用
> 
> C:\Program Files (x86)\Arduino\arduino-1.0.4\hardware\arduino\cores\arduino/main.cpp:14：未定义对“循环”的引用

我已经尝试在 中删除我的 Arduino 文件夹`C:\Program Files (x86)`，下载并更新驱动程序。

其他程序似乎运行良好。我该如何解决它，有什么问题？

```
#define m_pin1 13
#define m_pin2 12
#define sensorPin 0

int val1;
int val2;
int avg;
int threshold;
int flipTimer = 100;

void setup(){
    pinMode(m_pin1, OUTPUT);
    pinMode(m_pin2, OUTPUT);
    pinMode(sensorPin, INPUT);
    Serial.begin(9600);
    Serial.println("Sensor 1 Average:");
}

void loop(){
    moisture_val();
}

int moisture_val(){
    setSensorPolarity(true);
    delay(flipTimer);
    int val1 = analogRead(sensorPin);
    delay(flipTimer);
    setSensorPolarity(false);
    delay(flipTimer);
    int avg = reportLevels(val1,val2);
    int val2 = 1023 - analogRead(sensorPin);
}

void setSensorPolarity(boolean flip){
    if(flip){
        digitalWrite(m_pin1, HIGH);
        digitalWrite(m_pin2, LOW);
    }
    else{
        digitalWrite(m_pin1, LOW);
        digitalWrite(m_pin2, HIGH);
    }
}

int reportLevels(int val1,int val2){
    int avg = (val1 + val2) / 2;
    return(avg);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T19:52:46.023

IDE 期望在同名文件夹中找到该文件。查看应有的工作的文件和文件夹的结构。一旦名称匹配，问题就会消失。如果不是这样，请将 IDE 切换为“详细”以进行编译。这将允许您找到处理实际 C 源代码的临时文件夹。然后，您可以查看实际编译和链接的程序。这对于找出真正的问题大有帮助。

在分析详细编译器输出时，您可能还想查看[Arduino 构建过程的详细信息。](http://arduino.cc/en/Hacking/BuildProcess)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-06T02:01:27.477

我发现了问题：INO 文件名不能与类名相同。

我有三个文件： DB1280.ino DB1280.cpp DB1280.h 编译错误出来了。所以我更改了 DB1280.ino 名称。比如 SimpleDB1280.ino。错误消失了。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-21T18:59:18.443

arduino 对您构建的草图的名称有非常具体的要求。如果您将其保存为“Main”或“main”，则需要在其他地方以不同的名称保存它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-19T12:50:20.233

这里同样的问题。通过删除项目名称中的空格字符来修复它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-25T06:00:01.350

# 简化项目名称

我已经使用*Save as* to更改了我的项目名称`my-project`。这导致了您发布的错误。

为了解决这个问题，**简化项目名称，**排除项目名称等特殊字符`-`。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-07-04T08:05:33.450

您必须选择优先选择外部编辑器。说明：当它被选中时，你的页面 arduino 是灰色的，你可以编写程序。因此，当您想从 ardublock 转移到 arduino 时，您的代码不被接受，这很正常，因为 ardublock 不是 arduino 的外部编辑器。取消选择，您的 arduino 页面开始为白色，您可以编写代码并从 ardublock 传输代码。我有同样的问题，我使用它并且它正在运行..玩得开心:)

# android - 带有区域偏移到日期的 Android 毫秒

> ID：16043564
> 
> 赞同：0
> 
> 时间：2013-04-16T17:40:58.950
> 
> 标签：android, datetime

我目前（从服务器）有一个以刻度（.NET 日期）形式返回的日期戳。

一般来说，我设法通过减去 10000 来转换上述内容以产生秒并相应地偏移以获得 EPOC 毫秒。

现在，问题是从服务器传递的 ms 包括区域偏移量，我需要做的是获取区域的 TimeZone 对象（始终相同）并从原始值中减去 ms 偏移量（取决于 DST）以产生正确获取日期的新对象。

没有这么多转换的任何更好的方法？

```
private static long netEpocTicksConv = 621355968000000000L;
public static Date dateTimeLongToDate(long ticks) {
    TimeZone greeceTz = TimeZone.getTimeZone("Europe/Athens");
    Calendar cal0 = new GregorianCalendar(greeceTz); 

    long time = (ticks - netEpocTicksConv)/ 10000;
    time -= greeceTz.getOffset(time);
    cal0.setTimeInMillis(time);

    Date res = cal0.getTime();

    return res; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:21:03.867

这是一些在 DST 转换附近不太正确的代码：

```
private static final long DOTNET_TICKS_AT_UNIX_EPOCH = 621355968000000000L;
private static final TimeZone GREECE = TimeZone.getTimeZone("Europe/Athens");

public static Date dateTimeLongToDate(long ticks) {

    long localMillis = (ticks - DOTNET_TICKS_AT_UNIX_EPOCH) / 10000L;

    // Note: this does the wrong thing near DST transitions
    long offset = GREECE.getOffset(localMillis - GREECE.getRawOffset());
    long utcMillis = localMillis - offset;
    return new Date(utcMillis);
} 
```

这里没有必要使用 a `Calendar`。

除非它实际上是模棱两可的，否则您*可以*使其在 DST 转换中保持准确，在这种情况下，您可以使其始终返回较早版本或始终返回较新版本。这样做很麻烦，但可以做到。

通过减去标准时间的偏移量，我们已经减少了它不正确的时间量。基本上，这段代码现在说：“从本地时间减去标准时间（无夏令时）偏移量，以获得 UTC 时间的近似值。现在计算出该 UTC 时间的偏移量。”

# jsf-2 - p:commandButton 不执行单击操作

> ID：16043570
> 
> 赞同：1
> 
> 时间：2013-04-16T17:41:17.217
> 
> 标签：jsf-2, primefaces

p:commandButton 不执行单击操作我有下表

```
 <p:dataTable id="firmasTabla" var="car" editable="true" editMode="cell" value="#{clientesMB.itemsPersonaFirmanUtil}"  widgetVar="carsTable">  

                        <p:ajax event="cellEdit" listener="#{clientesMB.modiCellPersonaFirma}" update=":form2:growl" />  
                        <p:column headerText="Nro CI" style="width:30%">  
                            <p:cellEditor>  
                                <f:facet name="output"><h:outputText value="#{car.ci}" /></f:facet>  
                                <f:facet name="input"><p:inputText id="modelInput" value="#{car.ci}" style="width:96%"/></f:facet>  
                            </p:cellEditor>  
                        </p:column> 
                        <p:column headerText="Nombre" style="width:60%">  
                            <p:cellEditor>  
                                <f:facet name="output"><h:outputText value="#{car.nombre}" /></f:facet>  
                                <f:facet name="input"><p:inputText id="modelInput2" value="#{car.nombre}" style="width:96%"/></f:facet>  
                            </p:cellEditor>  
                        </p:column> 
                        <p:column style="width:10%">  
                            <p:commandButton id="selectButton256" actionListener="#{clientesMB.deleteSelecPersonaFirmaCliente}" 
                                             icon="ui-icon-trash" title="Eliminar" update="firmasTabla">  
                                <f:setPropertyActionListener value="#{car}" target="#{clientesMB.personaFirmasSelect}" />  
                            </p:commandButton>  
                        </p:column> 
                    </p:dataTable> 
```

而且我必须单击两次才能运行该操作，有时是第一次。在 backingbean 中有以下方法：

```
 public void deleteSelecPersonaFirmaCliente() throws Exception {
    try {
        boolean b = this.getItemsPersonaFirmanUtil().remove(personaFirmasSelect);
        boolean b1 = b; 
    } catch (Exception e) {
        JsfUtil.addErrorMessage(e, "Error: deleteSelecPersonaFirmaCliente() " + e.getMessage());

    }
} 
```

调试时，第一次单击进入方法，但好像在列表中找不到要删除的对象。然后单击 sugundo 删除列表对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T19:01:47.193

在您的**p:commandButton**中使用**action**而不是**actionlistener** ，因为 action 在**f:setPropertyActionListener之后执行**

 ****当**actionlistener**第一次执行时，它没有找到您的对象集，因为它在**f:setPropertyActionListener**完成之前运行，但这并不总是发生。这解释了为什么有时单击会起作用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T20:54:54.033

我在[博客](http://mrj4mes.blogspot.sg/2013/04/fact-order-of-calling-for-action-and.html)中做了一个小实验来解释你的问题。要解决它，您有两个选择：

1.  正如上面 Hidalgo 所说，从使用切换`actionListener`到`action`属性。
2.  否则，更改您的`actionListener`方法如下：

. 按钮：

```
<p:commandButton id="selectButton256" title="Eliminar" update="firmasTabla"
                 actionListener="#{clientesMB.deleteSelecPersonaFirmaCliente(car)}" /> 
```

. 豆方法：

```
public void deleteSelecPersonaFirmaCliente(Car car) throws Exception {
    // Your logic
} 
```****

# hadoop - 使用 Java Mapper/Reducer 进行 Hadoop 流式处理

> ID：16043572
> 
> 赞同：2
> 
> 时间：2013-04-16T17:41:20.370
> 
> 标签：hadoop, jar, hadoop-streaming, wikimedia

我正在尝试使用 java Mapper/Reducer 在一些维基百科转储（以压缩的 bz2 形式）上运行 hadoop 流作业。我正在尝试使用[WikiHadoop](https://github.com/whym/wikihadoop)，这是 Wikimedia 最近发布的一个界面。

WikiReader_Mapper.java

> ```
> package courseproj.example;
> 
> // Mapper: emits (token, 1) for every article occurrence.
> public class WikiReader_Mapper extends MapReduceBase implements Mapper<Text, Text, Text, IntWritable> {
> 
>     // Reuse objects to save overhead of object creation.
>     private final static Text KEY = new Text();
>     private final static IntWritable VALUE = new IntWritable(1);
> 
>     @Override
>     public void map(Text key, Text value, OutputCollector<Text, IntWritable> collector, Reporter reporter)
>             throws IOException {
>         KEY.set("article count");
>         collector.collect(KEY, VALUE);
>     }
> } 
> ```

WikiReader_Reducer.java

> ```
> package courseproj.example;
> 
> //Reducer: sums up all the counts.
> public class WikiReader_Reducer extends MapReduceBase implements Reducer<Text, IntWritable, Text, IntWritable> {
> 
>     private final static IntWritable SUM = new IntWritable();
> 
>     public void reduce(Text key, Iterator<IntWritable> values, OutputCollector<Text, IntWritable> collector,
>             Reporter reporter) throws IOException {
>         int sum = 0;
>         while (values.hasNext()) {
>             sum += values.next().get();
>         }
>         SUM.set(sum);
>         collector.collect(key, SUM);
>     }
> } 
> ```

我正在运行的命令是

> ```
> hadoop jar lib/hadoop-streaming-2.0.0-cdh4.2.0.jar \
>        -libjars lib2/wikihadoop-0.2.jar \
>        -D mapreduce.input.fileinputformat.split.minsize=300000000 \
>        -D mapreduce.task.timeout=6000000 \
>        -D org.wikimedia.wikihadoop.previousRevision=false \
>        -input enwiki-latest-pages-articles10.xml-p000925001p001325000.bz2 \
>        -output out \
>        -inputformat org.wikimedia.wikihadoop.StreamWikiDumpInputFormat \
>        -mapper WikiReader_Mapper \
>        -reducer WikiReader_Reducer 
> ```

我收到的错误消息是

```
Error: java.lang.RuntimeException: Error in configuring object
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:106)
    at org.apache.hadoop.util.ReflectionUtils.setConf(ReflectionUtils.java:72)
    at org.apache.hadoop.util.ReflectionUtils.newInstance(ReflectionUtils.java:130)
    at org.apache.hadoop.mapred.MapTask.runOldMapper(MapTask.java:424)
    at org.apache.hadoop.mapred.MapTask.run(MapTask.java:340)
    at org.apache.hadoop.mapred.YarnChild$2.run(YarnChild.java:157)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:396)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1408)
    at org.apache.hadoop.mapred.YarnChild.main(YarnChild.java:152)

Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.hadoop.util.ReflectionUtils.setJobConf(ReflectionUtils.java:103)

Caused by: java.io.IOException: Cannot run program "WikiReader_Mapper": java.io.IOException: error=2, No such file or directory
    at java.lang.ProcessBuilder.start(ProcessBuilder.java:460)
    at org.apache.hadoop.streaming.PipeMapRed.configure(PipeMapRed.java:209) 
```

与旧的相比，我更熟悉新的 hadoop API。由于我的 mapper 和 reducer 代码在两个不同的文件中，我在哪里定义作业的 JobConf 配置参数，同时遵循 hadoop 流的命令结构（显式设置 mapper 和 reducer 类）。有没有一种方法可以将映射器和化简器代码全部包装到一个类中（扩展配置并实现工具，这是在新 API 中所做的）并将类名传递给 hadoop 流命令行而不是设置分别映射和减少类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T00:02:47.470

流式处理使用旧的 API ( `org.apache.hadoop.mapred`) - 但是您的映射器和归约器类扩展了新的 API 类 ( `org.apache.hadoop.mapreduce`)。

尝试将 mapper 更改为 implement `org.apache.hadoop.mapred.Mapper`，将 reducer 更改为 implementation `org.apache.hadoop.mapred.Reducer`，例如：

```
package courseproj.example;

// Mapper: emits ("article", 1) for every article occurrence.
public class WikiReader_Mapper implements Mapper<Text, Text, Text, IntWritable> {

  // Reuse objects to save overhead of object creation.
  private final static Text KEY = new Text();
  private final static IntWritable VALUE = new IntWritable(1);

  @Override
  public void map(Text key, Text value, OutputCollector<Text, IntWritable> collector, Reporter reporter)
      throws IOException, InterruptedException {
    KEY.set("article count");
    collector.collect(KEY, VALUE);
  }
} 
```

# javascript - 将 drawImage() 作为类中的函数执行

> ID：16043589
> 
> 赞同：0
> 
> 时间：2013-04-16T17:42:23.880
> 
> 标签：javascript, jquery, html, jquery-ui

我无法使用类的功能绘制图像。我已经尝试过 this.img 和 var img 但它们都不起作用。我添加了 jquery-libary 的在线资源以将其置于在线状态，但在我的电脑上，我使用的是一个正在工作的离线资源！

```
<!doctype html>

<head>

    <link rel="stylesheet" href="js\jquery-ui-1.10.1.custom.css"/>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js">      </script>

<script type="text/javascript">

    var canvas;
    var ctx;
    var BurgerArray = new Array(50);

    function burger()
    {
        this.x = 10;
        this.y = 20;
        this.img = new Image();
        img.src='Img/Burger1.png'; 
        img.onload = function()
        {

        }
        this.teken = function()
        {
            ctx.drawImage(img,20,20);

        }

    }

    var b;
    $(document).ready(function() 
    {
        canvas =document.getElementById("MyCanvas");
        ctx =canvas.getContext("2d");

        b = new burger();
        b.teken();

    });

</script>
<style type="text/css">
#MyCanvas
{
    margin:auto; 
    display:block; 
    border:dashed; 
    border-color:#0F0;
}
</style>  
</head>

<body style=" width:100%; height:100%;">

<canvas id="MyCanvas" width="1000" height="600"></canvas>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:51:24.580

当您创建一个新对象时，它的范围与全局范围不同。将实现更改为：

```
function burger(canvas)
{
    this.x = 10;
    this.y = 20;
    this.canvas = canvas;
    this.ctx = canvas.getContext('2d');
    this.teken = function() {
        this.ctx.drawImage(img,20,20);
    };
}

$(document).ready(function() {
    var canvas = document.getElementById("MyCanvas");
    var b = new burger(canvas);
    b.teken();
}); 
```

# c - posix信号量问题

> ID：16043592
> 
> 赞同：0
> 
> 时间：2013-04-16T17:42:28.487
> 
> 标签：c, linux, synchronization, semaphore

我认为我的程序应该像这样工作：1）使用 value = 0 初始化未命名的信号量，`sem_init`（..）的第二个值是 1，所以正如它在 MAN 中所说的那样，信号量在进程之间共享 2）创建子进程，子进程等到信号量值变为 1

父进程增加了信号量的值，所以子进程现在应该退出，但它并没有真正退出，所以这就是问题所在

```
#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <semaphore.h>

pid_t child;

void child_proc(sem_t* sem) {
    sem_wait(sem);
    printf("OK\n");
}

void parent_proc(sem_t* sem) {

    sem_post(sem);
    sleep(2);

    int status;
    waitpid(child, &status, 0);
}

int main(int argc, char* argv[]) {
    sem_t sem;
    sem_init(&sem, 1, 0);

    child = fork();

    if (0 == child) {
        child_proc(&sem);
        return 0;
    }

    parent_proc(&sem);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:47:01.590

问题是两个进程都有信号量结构的本地（非共享）副本，并且一个进程中的更改不会反映到另一个进程。

正如[手册页所说](http://man7.org/linux/man-pages/man3/sem_init.3.html)，如果要跨进程共享信号量，不仅需要将非零值传递给 的第二个参数`sem_init`，而且该`sem_t`结构还需要存在于共享内存区域中。在您的示例程序中，它存在于堆栈中，不共享。

您可以通过使用公共文件映射 (with `mmap`) 或 with来共享内存`shm_open`，特别是。

# java - Android - 使用 onSensorChanged 同步线程以发送 udp 数据包

> ID：16043593
> 
> 赞同：1
> 
> 时间：2013-04-16T17:42:32.017
> 
> 标签：java, android, multithreading, sockets, udp

我正在尝试在 android 上制作多人游戏，其中玩家使用加速度计来移动物体。最初，我使用 TCP 发送数据包，其中包含玩家的 X 和 Y 坐标作为 JSON 字符串，在连接到加速度计的 onSensorChanged() 内（使用 SENSOR_DELAY_GAME）。但由于延迟问题，我决定尝试 UDP。

现在早些时候，我创建了一个单独的线程，它创建了一个新的套接字，我使用了以下代码：

```
public void onSensorChanged(SensorEvent event) {
// Other Stuff
    PrintWriter out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(socket.getOutputStream())),true);
                    out.println(coords.toString());
} 
```

我有：

```
socket = new Socket(serverAddr, Port); 
```

在另一个线程中。

由于UDP没有提供任何这样的方法来从主线程发送数据`NetworkOnMainThreadException`**，**我想我必须在另一个线程中进行数据包传输。但问题是我正在计算要在 内部`onSensorChanged()`发送的数据，并且我想在每次`onSensorChanged()`调用时发送一个数据包。

我对 Java 和多线程比较陌生，并尝试阅读有关同步的内容，但似乎无法在此处正确理解和实现它。因此，如果有人能指出解决此问题的方法，我将不胜感激。我还想知道在每个*SensorChange*发送坐标是否是个好主意，以及是否有办法优化数据，以便我仍然可以使用 TCP 而不会出现延迟问题。而且我还想知道是否有任何可能的方法可以`onSensorChanged()`作为单独的线程运行......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T18:03:12.170

对于最简单的应用程序，它可以很容易地解决：

```
DatagramSocket socket;

public void onSensorChanged() {
    //calculate and create DatagramPacket here
    new Thread(new Runnable() {
        @Override
        public void run() {
            socket.send(packet);    
        }
    });
} 
```

它不漂亮，但它有效（`onSensorChanged()`公平地说，任何计算都不漂亮......）。问题是，发送线程是否必须与`onSensorChanged()`方法同步。我发现，当使用 SENSOR_DELAY_GAME 时，我的 SGS3 上的采样频率约为 20 毫秒，因此它足够长而不会同步。当然，只有当您对传感器读数的计算简单且不耗时时，它才能正常工作。

但是，总而言之，计算任何数据`onSensorChanged()`都不是一个好习惯。来自 developer.android.com：

> 不要阻塞 onSensorChanged() 方法
> 
> 传感器数据可以高速变化，这意味着系统可能会经常调用 onSensorChanged(SensorEvent) 方法。作为最佳实践，您应该尽可能少地在 onSensorChanged(SensorEvent) 方法中执行操作，以免阻止它。如果您的应用程序需要您对传感器数据进行任何数据过滤或缩减，您应该在 onSensorChanged(SensorEvent) 方法之外执行该工作。

因此，我建议将传感器数据放在某个数据容器中（即`List`或...），然后从另一个线程访问这些数据，计算并发送。

最后一个问题：即使有一种方法可以`onSensorChanged()`在单独的线程中运行，这对大多数应用程序来说也是致命的，因为一次可能有数千个线程（就我而言，Java 是一个相当受限的环境，并且API 级别已经有重要的错误预防机制）。

# maven-3 - 多模块 Maven 项目的自定义阶段

> ID：16043597
> 
> 赞同：0
> 
> 时间：2013-04-16T17:42:40.597
> 
> 标签：maven-3, multi-module

我目前正在研究具有以下结构的多模块项目。

```
root
  -module A
  -module B 
```

我要做的是在模块B（模块B依赖于模块A）编译后执行模块B（模块的主要方法）。但我需要使用自定义命令来执行此操作。

前任 -

```
mvn runb 
```

我知道**exec maven 插件**可用于使用 maven 运行项目。我不明白的是如何在 Maven 中创建自定义命令（阶段）。有没有办法在不编写 Maven 插件的情况下实现这一点？

我参考了各种指南，例如[https://community.jboss.org/wiki/CreatingACustomLifecycleInMaven](https://community.jboss.org/wiki/CreatingACustomLifecycleInMaven)试图实现这一目标。但是他们需要在src/resources/META-INF下创建**components.xml**和**lifecycle.xml文件。**我不明白如何将该文件结构应用于我的项目，因为它是一个多模块项目，其中每个模块都有单独的**src**目录。

（我正在使用 Maven 3）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T05:28:52.330

如果不编写 Maven 插件，就无法创建自定义生命周期。

如果不破解 Maven 本身，至少从 Maven 3.0.5 开始，不可能通过插件向 Maven 添加*自定义阶段*。在处理任何插件之前，这些阶段由 Maven 的核心从其配置中加载。

如果你真的决定使用一个命令来做你想做的事，那么编写插件是唯一的方法。在您的 中使用一些[pluginGroup 映射](https://maven.apache.org/settings.html#Plugin_Groups)`settings.xml`，这可以变得更简单（您可以指定`mvn my:plugin`而不是`mvn com.mygroupid:plugin`）。

但是，如果您愿意在命令行上使用稍微冗长的语法，则可以通过配置文件和[exec maven 插件](http://mojo.codehaus.org/exec-maven-plugin/)来实现您想要的。

* * *

将配置文件添加到使用 exec 插件自行运行的模块 B。

像这样的东西：

```
<project>
    ...
    <profiles>
        <!-- This profile uses local webapp security instead of the BlueCoat device, useful for testing -->
        <profile>
            <id>execb</id>

            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>exec-maven-plugin</artifactId>
                        <version>1.2.1</version>

                        <executions>
                            <execution>
                                <id>runb</id>
                                <goals>
                                    <goal>java</goal>
                                </goals>
                                <phase>verify</phase> <!-- Anything after package phase -->
                                <configuration>
                                    <!-- Exec plugin configuration goes here -->
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project> 
```

您需要根据运行 JAR 的方式配置 exec 插件，更多信息请[点击此处](http://mojo.codehaus.org/exec-maven-plugin/examples/example-exec-using-plugin-dependencies.html)。

它的作用是将 exec 插件作为模块 B 构建的一部分运行，但`execb`前提是激活了配置文件。

* * *

现在，当您只想构建您的项目（没有任何执行程序）时，像正常一样构建（例如`mvn install`）。

当您要构建和运行时，请使用命令行：

```
mvn install -Pexecb 
```

它将执行 exec 作为构建的一部分。

# javascript - 刷新slidejs

> ID：16043600
> 
> 赞同：4
> 
> 时间：2013-04-16T17:42:44.783
> 
> 标签：javascript, jquery, on-the-fly

我正在使用[http://www.slidesjs.com/](http://www.slidesjs.com/)中的 slidejs ，我想刷新图像列表，因为我需要动态添加和删除图像。

有没有办法做到这一点？我尝试使用 delete $.fn.pluginName 但没有运气。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T09:41:01.537

我想出了一个（相当时髦的）解决方案。由于使用了繁重的 DOM 操作/启动插件，这可能不是最好的方法，但我希望你明白这一点。结果可以**[在这个 JSFiddle 上找到](http://jsfiddle.net/ddPJG/)**。

**HTML**

```
<input type="button" id="add" value="Add slide!" />

<div id="slides">
    <img src="http://placehold.it/100x100" />
    <img src="http://placehold.it/120x120" />
    <img src="http://placehold.it/140x140" />
    <img src="http://placehold.it/160x160" />
    <img src="http://placehold.it/180x180" />
</div> 
```

**JavaScript**

```
// Create a clone of the images array
var $originalClone = $("#slides").children().clone();

// Remove the parent (we'll create it dynamically)
$("#slides").remove();

// Create the new slides, add the children & add it to the DOM
var $newSlides = $("<div />")
    .append($originalClone)
    .appendTo($("body"));

// Execute the slide plugin
$newSlides.slidesjs({
    width: 940,
    height: 528
});

$("#add").on("click", function() {
    // Remove the old slider
    $newSlides.remove();

    // Create a new slider, add the children & add it to the DOM
    var $newSlides2 = $("<div />")
        .append($originalClone)
        .appendTo($("body"));

    // Add the new image to the newly created slider
    $("<img />")
        .attr("src", "http://placehold.it/200x200")
        .appendTo($newSlides2);

    // Execute the slide plugin
    $newSlides2.slidesjs({
        width: 940,
        height: 528
    });

    // In this demo, the button "add slide" can be clicked once
    $("#add").remove();
}); 
```

我希望这个解决方案能给你一个好的方向提示！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T14:49:45.690

我最近遇到了同样的问题，并设法通过更改插件来解决它。

这是我的解决方案：

在之前添加以下几行`Plugin.prototype.init = function() {`：

```
Plugin.prototype.refresh = function (number){
    var $element=$(this.element);
    var _this = this;
    this.data = $.data(this);
    $(this.element).find(".slidesjs-pagination-item").remove();
    $.data(this, "total", $(".slidesjs-control", $element).children().not(".slidesjs-navigation", $element).length);
    $.each($(".slidesjs-control", $element).children(), function(i) {
        var $slide;
        $slide = $(this);
        return $slide.attr("slidesjs-index", i);
      });
    $.each($(".slidesjs-control", $element).children(), function(i) {
        var $slide;
        $slide = $(this);
        return $slide.attr("slidesjs-index", i);
      });
      if (this.data.touch) {
        $(".slidesjs-control", $element).on("touchstart", function(e) {
          return _this._touchstart(e);
        });
        $(".slidesjs-control", $element).on("touchmove", function(e) {
          return _this._touchmove(e);
        });
        $(".slidesjs-control", $element).on("touchend", function(e) {
          return _this._touchend(e);
        });
      }
      $element.fadeIn(0);
      this.update();
      if (this.data.touch) {
        this._setuptouch();
      }
      $(".slidesjs-control", $element).children(":eq(" + this.data.current + ")").eq(0).fadeIn(0, function() {
        return $(this).css({
          zIndex: 10
        });
      });
      if (this.options.navigation.active) {
        prevButton = $("<a>", {
          "class": "slidesjs-previous slidesjs-navigation",
          href: "#",
          title: "Previous",
          text: "Previous"
        }).appendTo($element);
        nextButton = $("<a>", {
          "class": "slidesjs-next slidesjs-navigation",
          href: "#",
          title: "Next",
          text: "Next"
        }).appendTo($element);
      }
      $(".slidesjs-next", $element).click(function(e) {
        e.preventDefault();
        _this.stop(true);
        return _this.next(_this.options.navigation.effect);
      });
      $(".slidesjs-previous", $element).click(function(e) {
        e.preventDefault();
        _this.stop(true);
        return _this.previous(_this.options.navigation.effect);
      });
      if (this.options.play.active) {
        playButton = $("<a>", {
          "class": "slidesjs-play slidesjs-navigation",
          href: "#",
          title: "Play",
          text: "Play"
        }).appendTo($element);
        stopButton = $("<a>", {
          "class": "slidesjs-stop slidesjs-navigation",
          href: "#",
          title: "Stop",
          text: "Stop"
        }).appendTo($element);
        playButton.click(function(e) {
          e.preventDefault();
          return _this.play(true);
        });
        stopButton.click(function(e) {
          e.preventDefault();
          return _this.stop(true);
        });
        if (this.options.play.swap) {
          stopButton.css({
            display: "none"
          });
        }
      }
      if (this.options.pagination.active) {
        pagination = $("<ul>", {
          "class": "slidesjs-pagination"
        }).appendTo($element);
        $.each(new Array(this.data.total), function(i) {
          var paginationItem, paginationLink;
          paginationItem = $("<li>", {
            "class": "slidesjs-pagination-item"
          }).appendTo(pagination);
          paginationLink = $("<a>", {
            href: "#",
            "data-slidesjs-item": i,
            html: i + 1
          }).appendTo(paginationItem);
          return paginationLink.click(function(e) {
            e.preventDefault();
            _this.stop(true);
            return _this.goto(($(e.currentTarget).attr("data-slidesjs-item") * 1) + 1);
          });
        });
      }
      $(window).bind("resize", function() {
        return _this.update();
      });
      this._setActive();
    if (number){            
        this.goto(number+1);
    } else {
        this.goto(0);
    }

}; 
```

然后，将内容更改为`return $.fn[pluginName] = function(options,the_args) {`：

```
return $.fn[pluginName] = function(options,the_args) {
    var the_return=this.each(function() {
        if (!$.data(this, "plugin_" + pluginName)) {
          return $.data(this, "plugin_" + pluginName, new Plugin(this, options));
        }
    });
    if (typeof options=="string"){
        var element=this.get(0);
        if (arguments.length>1){
            var the_args=Array.prototype.slice.call(arguments);;
            the_args.splice(0,1);
            var plugin=$.data(element, "plugin_" + pluginName);
            return plugin[options].apply(plugin,the_args);
        } else {
            return $.data(element, "plugin_" + pluginName)[options]();
        }
    }
  return the_return;
}; 
```

这样，您可以调用插件的其他功能，例如`goto`.

在代码中，你只需要像这样调用刷新函数：

```
$("#id_of_container").slidesjs("refresh"); 
```

或者，如果你想刷新并跳转到另一张幻灯片，可以这样调用：

```
$("#id_of_container").slidesjs("refresh",number_of_slide); 
```

其中`number_of_slide`是一个从 0 开始的 int 数；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-02T00:13:00.127

这是我的复制和粘贴解决方案。删除单个当前选项卡。

```
$('#SLIDESID').slidesjs({
    //...
});

// ... later somewhere else ... //

var currentIndex = $('#SLIDESID').data().plugin_slidesjs.data.current;

//remove active tab
$('#SLIDESID [slidesjs-index="' + currentIndex + '"]').remove();
$('#SLIDESID [data-slidesjs-item="' + currentIndex  + '"]').parent().remove();

//reindex tabs
var tabs = $('#SLIDESID [slidesjs-index]');
tabs.each(function(idx, elem){
    $(elem).attr('slidesjs-index', idx);
});

//reindex pagination
$('#SLIDESID [data-slidesjs-item]').each(function(idx, elem){
    $(elem).attr('data-slidesjs-item', idx);
    $(elem).text(idx+1);
});

//tweek plugin data
$('#SLIDESID').data().plugin_slidesjs.data.total = tabs.length;
$('#SLIDESID').data().plugin_slidesjs.data.current--;

//animate to new element by clicking on NEXT
$('#SLIDESID .slidesjs-next').click(); 
```

# .htaccess - 将动态错误网址重定向到新网址

> ID：16043606
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:43:03.227
> 
> 标签：.htaccess, redirect, rewrite

尝试重定向这个现在产生 404 的示例格式

存档/主题/t-59411_Nastase_RHIC_produces_black_holes.html

到这种有效的格式：

存档/index.php/t-59411.html

如果它们是查询字符串，我只能找到如何做的示例。数字 59411 是动态 ID

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:48:05.800

```
RedirectMatch 301 ^/archive/topic/t-(\d+)_(?:[0-9a-zA-Z]+)\.html$ http://your.domain/archive/index.php/t-$1.html 
```

# c# - 将图像附加到身体部位

> ID：16043610
> 
> 赞同：0
> 
> 时间：2013-04-16T17:43:16.897
> 
> 标签：c#, wpf, visual-studio-2012, kinect, kinect-sdk

我正在尝试将一些图像附加到用户的头部和拳头，但似乎我无法正确定位它。图像总是在头部和拳头下方太多。

我有这个 XAML：

```
<Page x:Class="KinectD.Game1"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
  xmlns:k="http://schemas.microsoft.com/kinect/2013"
  xmlns:WpfViewers="clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers"
  mc:Ignorable="d" 
  d:DesignHeight="600" d:DesignWidth="800"
Title="Game1">

<Canvas>
    <k:KinectRegion x:Name="kinectRegion" Canvas.Left="630">
            <k:KinectCircleButton Label="Menu" HorizontalAlignment="Right" Height="200" VerticalAlignment="Top" Click="MenuButtonOnClick" >
                <StackPanel>
                    <Image Source="Images/smile.png" Height="30"/>
                </StackPanel>
            </k:KinectCircleButton>

    </k:KinectRegion>

    <k:KinectUserViewer k:KinectRegion.KinectRegion="{Binding ElementName=kinectRegion}" Height="100" HorizontalAlignment="Center" VerticalAlignment="Top" />
    <k:KinectSensorChooserUI HorizontalAlignment="Center" VerticalAlignment="Top" x:Name="sensorChooserUi" /><WpfViewers:KinectColorViewer Canvas.Top="0" Canvas.Left="0" HorizontalAlignment="Left" Height="480" Width="640" Margin="0,0,0,0" VerticalAlignment="Center" Kinect="{Binding ElementName=sensorChooserUi, Path=KinectSensorChooser.Kinect, Mode=OneWay}" BorderThickness="1" BorderBrush="Black"/>
    <Image x:Name="rightEllipse" Canvas.Left="670" Source="Images/glove_right.png" Height="100" Width="70" Margin="0,400,10,0" VerticalAlignment="Top" HorizontalAlignment="Right"/>
    <Image x:Name="leftEllipse" Canvas.Left="670" Source="Images/glove_left.png" Height="100" Width="70" Margin="0,300,10,0" VerticalAlignment="Top" HorizontalAlignment="Right"/>
    <Image x:Name="headImage" Canvas.Left="670" Source="Images/smile.png" Height="70" Width="70" Margin="0,200,10,0" VerticalAlignment="Top" HorizontalAlignment="Right"/>

</Canvas> 
```

而这个 XAML.CS：

```
public partial class Game1 : Page
{
    #region "Kinect"
    private KinectSensorChooser sensorChooser;
    #endregion

    bool closing = false;
    const int skeletonCount = 6;
    Skeleton[] allSkeletons = new Skeleton[skeletonCount];

    public Game1()
    {
        this.InitializeComponent();
        // initialize the sensor chooser and UI
        this.sensorChooser = new KinectSensorChooser();
        //Assign the sensor chooser with the sensor chooser from the mainwindow. 
        //We are reusing the sensorchoosing declared in the first window that can in contact with kinect
        this.sensorChooser = Generics.GlobalKinectSensorChooser;
        //subscribe to the sensorChooserOnKinectChanged event
        this.sensorChooser.KinectChanged += SensorChooserOnKinectChanged;
        //Assign Kinect Sensorchooser to the sensorchooser we got from our static class
        this.sensorChooserUi.KinectSensorChooser = sensorChooser;

        var parameters = new TransformSmoothParameters
        {
            Smoothing = 0.3f,
            Correction = 0.0f,
            Prediction = 0.0f,
            JitterRadius = 1.0f,
            MaxDeviationRadius = 0.5f
        };
        this.sensorChooser.Kinect.SkeletonStream.Enable(parameters);

        this.sensorChooserUi.KinectSensorChooser.Kinect.AllFramesReady += new EventHandler<AllFramesReadyEventArgs>(sensor_AllFramesReady);

        // Bind the sensor chooser's current sensor to the KinectRegion
        var regionSensorBinding = new Binding("Kinect") { Source = this.sensorChooser };
        BindingOperations.SetBinding(this.kinectRegion, KinectRegion.KinectSensorProperty, regionSensorBinding);

        //this.sensorChooser.Kinect.AllFramesReady += new EventHandler<AllFramesReadyEventArgs>(sensor_AllFramesReady);

    }

    private void SensorChooserOnKinectChanged(object sender, KinectChangedEventArgs args)
    {
        bool error = false;
        if (args.OldSensor != null)
        {
            try
            {
                args.OldSensor.DepthStream.Range = DepthRange.Default;
                args.OldSensor.SkeletonStream.EnableTrackingInNearRange = false;
                args.OldSensor.DepthStream.Disable();
                args.OldSensor.SkeletonStream.Disable();

                args.OldSensor.ColorStream.Disable();
            }
            catch (InvalidOperationException)
            {
                // KinectSensor might enter an invalid state while enabling/disabling streams or stream features.
                // E.g.: sensor might be abruptly unplugged.
                error = true;
            }
        }

        if (args.NewSensor != null)
        {
            try
            {
                args.NewSensor.DepthStream.Enable(DepthImageFormat.Resolution640x480Fps30);
                args.NewSensor.ColorStream.Enable(ColorImageFormat.RgbResolution640x480Fps30);
                args.NewSensor.SkeletonStream.Enable();
            }
            catch (InvalidOperationException)
            {
                error = true;
                // KinectSensor might enter an invalid state while enabling/disabling streams or stream features.
                // E.g.: sensor might be abruptly unplugged.
            }
        }

        if (!error)
            kinectRegion.KinectSensor = args.NewSensor;
    }

    void sensor_AllFramesReady(object sender, AllFramesReadyEventArgs e)
    {
        if (closing)
        {
            return;
        }

        //Get a skeleton
        Skeleton first = GetFirstSkeleton(e);

        if (first == null)
        {
            return;
        }

        //set scaled position
        ScalePosition(headImage, first.Joints[JointType.Head]);
        ScalePosition(leftEllipse, first.Joints[JointType.HandLeft]);
        ScalePosition(rightEllipse, first.Joints[JointType.HandRight]);

        GetCameraPoint(first, e);

    }

    void GetCameraPoint(Skeleton first, AllFramesReadyEventArgs e)
    {

        using (DepthImageFrame depth = e.OpenDepthImageFrame())
        {
            if (depth == null ||
                this.sensorChooser.Kinect == null)
            {
                return;
            }

            //Map a joint location to a point on the depth map
            //head
            DepthImagePoint headDepthPoint =
                this.sensorChooser.Kinect.CoordinateMapper.MapSkeletonPointToDepthPoint(first.Joints[JointType.Head].Position, depth.Format);
            //left hand
            DepthImagePoint leftDepthPoint =
                this.sensorChooser.Kinect.CoordinateMapper.MapSkeletonPointToDepthPoint(first.Joints[JointType.HandLeft].Position, depth.Format);
            //right hand
            DepthImagePoint rightDepthPoint =
                this.sensorChooser.Kinect.CoordinateMapper.MapSkeletonPointToDepthPoint(first.Joints[JointType.HandRight].Position, depth.Format);

            //Map a depth point to a point on the color image
            //head
            ColorImagePoint headColorPoint =
                this.sensorChooser.Kinect.CoordinateMapper.MapDepthPointToColorPoint(depth.Format, headDepthPoint, ColorImageFormat.RgbResolution640x480Fps30);

            //left hand
            ColorImagePoint leftColorPoint =
                this.sensorChooser.Kinect.CoordinateMapper.MapDepthPointToColorPoint(depth.Format, leftDepthPoint, ColorImageFormat.RgbResolution640x480Fps30);

            //right hand
            ColorImagePoint rightColorPoint =
                this.sensorChooser.Kinect.CoordinateMapper.MapDepthPointToColorPoint(depth.Format, rightDepthPoint, ColorImageFormat.RgbResolution640x480Fps30);

            //Set location
            CameraPosition(headImage, headColorPoint);
            CameraPosition(leftEllipse, leftColorPoint);
            CameraPosition(rightEllipse, rightColorPoint);
        }
    }

    Skeleton GetFirstSkeleton(AllFramesReadyEventArgs e)
    {
        using (SkeletonFrame skeletonFrameData = e.OpenSkeletonFrame())
        {
            if (skeletonFrameData == null)
            {
                return null;
            }

            skeletonFrameData.CopySkeletonDataTo(allSkeletons);

            //get the first tracked skeleton
            Skeleton first = (from s in allSkeletons
                              where s.TrackingState == SkeletonTrackingState.Tracked
                              select s).FirstOrDefault();

            return first;

        }
    }

    private void CameraPosition(FrameworkElement element, ColorImagePoint point)
    {
        //Divide by 2 for width and height so point is right in the middle 
        // instead of in top/left corner
        Canvas.SetLeft(element, point.X - element.Width / 2);
        Canvas.SetTop(element, point.Y - element.Height / 2);

        //Canvas.SetLeft(element, point.X - element.Width);
        //Canvas.SetTop(element, point.Y - element.Height);

    }

    private void ScalePosition(FrameworkElement element, Joint joint)
    {
        //convert the value to X/Y
        //Joint scaledJoint = joint.ScaleTo(1280, 720); 

        //convert & scale (.3 = means 1/3 of joint distance)
        //Joint scaledJoint = joint.ScaleTo(640, 480, .3f, .3f);
        Joint scaledJoint = joint.ScaleTo(640, 480, .3f, .3f);

        Canvas.SetLeft(element, scaledJoint.Position.X);
        Canvas.SetTop(element, scaledJoint.Position.Y);

    }

    private void MenuButtonOnClick(object sender, RoutedEventArgs e)
    {
        this.sensorChooser.KinectChanged -= SensorChooserOnKinectChanged;
        (Application.Current.MainWindow.FindName("_mainFrame") as Frame).Source = new Uri("MainMenu.xaml", UriKind.Relative);
    }
} 
```

它似乎正确读取骨架，因为图像立即移动到用户区域但不正确。在我看来，图像可以正确水平移动，但不能垂直移动。它们在用户的头部和拳头下方，但我会说低于 200 像素太多。任何想法可能是什么问题？

# java - 使用 SAX 从行集模式中获取列名

> ID：16043612
> 
> 赞同：0
> 
> 时间：2013-04-16T17:43:26.527
> 
> 标签：java, xml, schema, sax, rowset

我正在用 SAX 解析一个 XML，到目前为止一切都很好，但是这个 xml 是一个称为行集的微软模式，因此每列都被命名为 c0、c1、c2 等等，但是列的实际名称存储在模式中，它在同一个 XML 文件中。

请看下面的例子：

```
 <?xml version="1.0" encoding="utf-8"?>
<RS xmlns="urn:schemas-microsoft-com:xml-analysis:rowset">
    <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:saw-sql="urn:saw-sql" targetNamespace="urn:schemas-microsoft-com:xml-analysis:rowset">
        <xsd:complexType name="R">
            <xsd:sequence>
                <xsd:element name="C0" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Opportunity ID" saw-sql:columnID="c55007aeb4fd2c909"/>
                <xsd:element name="C1" type="xsd:string" minOccurs="0" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Opportunity Name" saw-sql:columnID="c9e466deb3ad5a949"/>
                <xsd:element name="C2" type="xsd:string" minOccurs="0" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Closed Flag" saw-sql:columnID="c4f1b71539820e65c"/>
                <xsd:element name="C3" type="xsd:dateTime" minOccurs="0" maxOccurs="1" saw-sql:type="timestamp" saw-sql:columnHeading="Actual Close Date" saw-sql:columnID="c007ad0eb3ebae22d"/>
                <xsd:element name="C4" type="xsd:dateTime" minOccurs="0" maxOccurs="1" saw-sql:type="timestamp" saw-sql:columnHeading="Creation Date" saw-sql:columnID="c8bf417f59e742c63"/>
                <xsd:element name="C5" type="xsd:double" minOccurs="0" maxOccurs="1" saw-sql:type="double" saw-sql:columnHeading="Line Win Probability" saw-sql:columnID="c49c9eb926449bccc"/>
                <xsd:element name="C6" type="xsd:string" minOccurs="0" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="First Name" saw-sql:columnID="c7c2e5dc4832c9e81"/>
                <xsd:element name="C7" type="xsd:string" minOccurs="0" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Last Name" saw-sql:columnID="c0fc239ab56275027"/>
                <xsd:element name="C8" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Current Base Resource Name" saw-sql:columnID="c7c53a4daa37f1637"/>
                <xsd:element name="C9" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Current Level - 1 Resource Name" saw-sql:columnID="ccb4a337a024e6838"/>
                <xsd:element name="C10" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Current Level - 2 Resource Name" saw-sql:columnID="cfbde2b815500dd87"/>
                <xsd:element name="C11" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Current Level - 3 Resource Name" saw-sql:columnID="cef1347354936a6a8"/>
                <xsd:element name="C12" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Current Level - 4 Resource Name" saw-sql:columnID="cbdc3fbd438cafb0f"/>
                <xsd:element name="C13" type="xsd:string" minOccurs="1" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Current Top-Level Resource Name" saw-sql:columnID="c7d7bc50e00cb94ae"/>
                <xsd:element name="C14" type="xsd:string" minOccurs="0" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Name" saw-sql:columnID="c08c8bd262c9cfaac"/>
                <xsd:element name="C15" type="xsd:int" minOccurs="0" maxOccurs="1" saw-sql:type="integer" saw-sql:columnHeading="# Days in Stage" saw-sql:columnID="c5b0dbd396ffe3a62"/>
                <xsd:element name="C16" type="xsd:double" minOccurs="0" maxOccurs="1" saw-sql:type="double" saw-sql:columnHeading="Revenue" saw-sql:columnID="cdc65489635ccdda0"/>
                <xsd:element name="C17" type="xsd:dateTime" minOccurs="0" maxOccurs="1" saw-sql:type="timestamp" saw-sql:columnHeading="Close Date" saw-sql:columnID="c4bd9fe19ff33072d"/>
                <xsd:element name="C18" type="xsd:string" minOccurs="0" maxOccurs="1" saw-sql:type="varchar" saw-sql:columnHeading="Opportunity Number" saw-sql:columnID="c6429e0148a929b79"/>
            </xsd:sequence>
        </xsd:complexType>
    </xsd:schema>
    <R>
        <C0>100000009829205</C0>
        <C1>Upgrading Network Servers</C1>
        <C2>Y</C2>
        <C3>2013-01-16T00:00:00</C3>
        <C4>2012-05-01T00:00:00</C4>
        <C5>100</C5>
        <C6>Lisa</C6>
        <C7>Jones</C7>
        <C8>Pepe papas</C8>
        <C9>Pepe papas</C9>
        <C10>Pepe papas</C10>
        <C11>Pepe papas</C11>
        <C12>Pepe papas</C12>
        <C13>Perro Hunter</C13>
        <C14>Amazing customer (SEATTLE, US)</C14>
        <C15></C15>
        <C16></C16>
        <C17></C17>
        <C18>RUP3-Opty-1</C18>
    </R>
    ... 
```

可以看到，colum 的实际名称存储在模式的 saw-sql:columnHeading 属性中，我可以将 name 属性与列标记名匹配，但我不知道如何从 SAX 访问模式处理程序，

到目前为止我有这个

```
try {

            SAXParserFactory factory = SAXParserFactory.newInstance();
            SAXParser saxParser = factory.newSAXParser();

            DefaultHandler handler = new DefaultHandler() {

                boolean bfname = false;
                boolean blname = false;
                boolean bnname = false;
                boolean bsalary = false;

                public void startElement(String uri, String localName, String qName,
                                         Attributes attributes) throws SAXException {
                    System.out.println("Colum :" + qName);
                }

                public void characters(char ch[], int start, int length) throws SAXException {
                    String value = new String(ch, start, length);
                    System.out.println("value: "+ value);
                }

            };

            InputSource is = new InputSource(new StringReader(xmlContent));
            is.setEncoding("UTF-8");

            saxParser.parse(is, handler);

        } catch (Exception e) {
            e.printStackTrace();
        } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:48:53.863

SAX 处理程序将按`startElement`文档顺序记录事件。第一个将是`RS`, then `xsd:schema`, then`xsd:complexType`等。您需要跟踪每个事件并编写计算表所在位置的逻辑。SAX 是一个低级解析器，默认情况下不保留文档结构。

我希望您将拥有一个用于架构的索引本地数据结构（可能是一个表），并且您将为每一列添加一个条目。然后对于读取的每一行，您将在架构中查找详细信息（例如，通过 getColumn("C1") 等）

对于小问题，您可能希望将整个文档读入 DOM（我使用 XOM），而 XPath 可用于使引用易于编写。

# ios - 带有获取的属性核心数据的 NSSortDescriptor

> ID：16043613
> 
> 赞同：1
> 
> 时间：2013-04-16T17:43:26.567
> 
> 标签：ios, core-data, nsmanagedobject, nsfetchrequest, nssortdescriptor

我有一个`Agency`具有 fetched property 的实体`city`。我正在执行 fetch 请求，我希望我的结果按机构`name`和城市排序`name`。

这是旧代码的一部分。如您所见，与实体存在关系`City`，我可以轻松设置排序描述符。但是现在我已经用获取的属性替换了关系。

请帮助我，我需要如何修改此代码？

```
self.context = //...

NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
NSEntityDescription *callEntity = [NSEntityDescription entityForName:@"Agency" inManagedObjectContext:self.context];
[fetchRequest setEntity:callEntity];

NSSortDescriptor *sortByCityNameDescriptor = [[NSSortDescriptor alloc] initWithKey:@"city.name" ascending:YES selector:@selector(caseInsensitiveCompare:)];
NSSortDescriptor *sortByNameDescriptor = [[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES selector:@selector(caseInsensitiveCompare:)];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortByCityNameDescriptor, sortByNameDescriptor, nil];
[fetchRequest setSortDescriptors:sortDescriptors];

//performing a fetch 
```

# ruby-on-rails - 通过关联在 belongs_to 和 has_many 中排序和搜索

> ID：16043616
> 
> 赞同：0
> 
> 时间：2013-04-16T17:43:39.087
> 
> 标签：ruby-on-rails, sorting, search, ruby-on-rails-3.2, associations

我有两个模型，post 和 book，通过第三个 kms 关联。

关联看起来像：

```
class Post < ActiveRecord::Base
  attr_accessible :name, :year, :author, :book_ids
  has_many :kms
  has_many :books, through: :kms   
end

class Book < ActiveRecord::Base
  attr_accessible :name
  has_many :kms
  has_many :posts, through: :kms
end

class Km < ActiveRecord::Base
  attr_accessible :count, :book_id, :post_id
  belongs_to :book
  belongs_to :post

   def self.search(search)
      if search
        case type
           when "Name of Book"
                where('book.name ILIKE ?', "%#{search}%")
           when "Name OF Post"                                
                where('post.name LIKE ?', "%#{search}%")   
            end
      else
        scoped
      end            
  end
end 
```

这里`_kms.html.erb`看起来像：

```
<%= form_tag list_km_path, :method => 'get', :id => 'kms_search' do %>
    <p style="float:right;display:inline;">
        <%= hidden_field_tag :direction, params[:direction] %>
        <%= hidden_field_tag :sort, params[:sort] %>
        <%= select_tag "fieldtype", options_for_select([ "Name of Book", "Name of Post"], "Name of Book"),  :style => 'width:150px;' %>
        <%= text_field_tag :search, params[:search],  :style => 'width:200px;', :placeholder => "search..." %>
    </p>
<% end %>

<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered">
<thead>
    <tr>
       <th><%= sortable "book.name", "Name of Book" %></th>
       <th><%= sortable "post.name", "Name of Post" %></th>
    </tr>
  </thead >
  <tbody>
    <% for km in @kms %>
    <tr>
      <td><%= km.book.name %></td>
      <td><%= km.post.name %></td>

    </tr>
    <% end %>
  </tbody>
  </table> 
```

这里`kms_controller.rb`看起来像：

```
 def index
     @per_page = params[:per_page] || 10
     @kms  = Km.search(params[:search],params[:fieldtype]).order(sort_column + " " + sort_direction).paginate(:per_page => @per_page, :page => params[:page])
   end

  def sort_column
    Km.column_names.include?(params[:sort]) ? params[:sort] : "book.name"
  end

  def sort_direction
    %w[asc desc].include?(params[:direction]) ? params[:direction] : "asc" 
```

**问题1：**

我想在表单 kms_search 上搜索书名和帖子名称，但是当我选择字段类型书名并在字段上输入书名以及帖子名称时，它不起作用并且没有响应。

**问题2：**

我想对书名和帖子名进行排序，但出现错误：

```
PG::Error: ERROR:  missing FROM-clause entry for table "book"
LINE 1: ...kms" ORDER BY book...
                         ^
: SELECT  "kms".* FROM "kms" ORDER BY book.name asc LIMIT 10 OFFSET 0 
```

任何人都可以帮助我，我该如何解决我的问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:47:43.963

使用 SQL 查询时，将所有表名复数：

```
where('books.name LIKE ?', "%#{search}%") 
```

问题2。

不知道这是否可行，但试试这样：

```
 <th><%= sortable "books.name", "Name of Book" %></th>
   <th><%= sortable "posts.name", "Name of Post" %></th> 
```

和

```
def sort_column
    params[:sort].downcase == "posts.name" ? "posts.name" : "books.name"
end 
```

并在您的索引操作中：

```
Km.search(params[:search],params[:fieldtype]).joins(:book).joins(:post).uniq.order(sort_column + " " + sort_direction) 
```

# asp.net-mvc - Razor.Parse 需要很长时间才能首次解析每个 http 请求（Asp.Net MVC）

> ID：16043618
> 
> 赞同：0
> 
> 时间：2013-04-16T17:43:50.573
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, razor-2

我正在使用`RazorEngine`以下内容解析模板：

```
string parsedText = Razor.Parse(template, model, "cache"); 
```

首先，如果我没有将第三个参数指定为“缓存”，则对该方法的任何调用都将花费 500 - 1000 毫秒，考虑到该方法被频繁调用，这是一个很大的时间。传递该参数后，第一次需要 500 - 1000 毫秒，但任何后续调用都需要可忽略不计的时间（0-1 毫秒）。

这是在 Asp.Net MVC web 应用程序的上下文中执行的。但是，一旦请求被刷新，第一次又需要 500 -1000 毫秒。

任何想法为什么需要这么长时间，可以做什么？

我正在使用 RazorEngine 3.2.0.0 和 .Net 4.5。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:55:33.150

该请求需要很长时间，因为必须编译剃须刀页面......

阅读此[预编译剃须刀页面](http://stacktoheap.com/blog/2013/01/19/precompiling-razor-views-in-asp-dot-net-mvc-3/)

你好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T10:51:34.843

The issue was the third parameter - `cacheName`. This must be a unique cache key, per unique template.

I changed this to a different one each time based on the template, and it is now working perfectly and blazingly fast.

The issue was that I was unit testing it with just one template, however in the actual environment, the template was changing. The cache name key was static, hence the template cache was being invalidated all the time.

# windows-phone-7 - 如何使用 c# 创建 AdDuplex 控件？

> ID：16043620
> 
> 赞同：0
> 
> 时间：2013-04-16T17:43:52.873
> 
> 标签：windows-phone-7, xaml, controls

我有如下 AdDuplex 控件 xaml 代码：

```
<adduplex:AdControl Name="adduplexControl" xmlns:adduplex="clr-namespace:AdDuplex;assembly=AdDuplex.AdControl.Silverlight" AppId="myid" Margin="0,68,0,0" Background="Black" /> 
```

如何使用 c# 创建此控件？

我试过这样：

```
AdDuplex.AdControl a = new AdDuplex.AdControl();
a.AppId = "myid"; 
```

但我不知道如何创建`xmlns:adduplex`财产。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:56:52.610

该属性是一个[XML 名称空间定义](http://en.wikipedia.org/wiki/XML_namespace)。xaml 序列化程序使用它来识别反序列化期间的特定类型。

命名空间遵循特定格式，包含类型 ( `AdDuplex`) 的命名空间，以及可以找到其定义的程序集的名称 ( **AdDuplex.AdControl.Silverlight.dll** )。XML 命名空间的名称是`adduplex`(xmlns: **adduplex** )。使用此信息，xaml 序列化程序可以定位`AdControl`类型 (adduplex:AdControl)。

该属性是在序列化过程中添加的，不会影响`AdControl`.

tl;博士：你不必。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-09T17:19:08.500

以下是创建`AdDuplex.AdControl`in 代码的示例：

```
AdDuplex.AdControl adduplex = new AdDuplex.AdControl();
adduplex.AppId = "YOUR_AD_UNIT_HERE";
adduplex.Width = 480;
adduplex.Height = 80;
adduplex.VerticalAlignment = VerticalAlignment.Top;
adduplex.HorizontalAlignment = HorizontalAlignment.Center;
adduplex.Margin = new Thickness(0, 0, 0, 0); 
```

这将动态创建`AdDuplex`横幅。

在`AppId`不使用您的应用 ID 时，请使用 adUnit 以避免“配置错误”。

# c++ - 使用元编程进行消息队列管理

> ID：16043622
> 
> 赞同：1
> 
> 时间：2013-04-16T17:43:58.663
> 
> 标签：c++, metaprogramming, template-meta-programming

我正在实现一种`C++`使用消息队列和消息类设计的通信机制。也就是说，存在一个方法的抽象父`Message`类和类。该类将消息发送到适当的消息队列，该队列由消息的类型确定。（也就是说，因为它发送到队列并被发送到）每种消息类型都将被创建为来自 的派生类。`Communication``Communication::send(Message&)``Communication``message_queue``Msg1``Queue_Msg1``Msg2``Queue_Msg2``Message`

主要是，我对自动创建队列感兴趣。也就是说，如果我决定添加一个新的消息类型类`newMsg`，那么添加消息队列的过程`Queue_newMsg`将不需要更改`Communication`类中的代码，例如为每种消息类型创建队列的代码。

由于这可以在编译时完成（在编译时，所有派生消息类都是已知的，因此需要的消息队列），我正在尝试考虑一些元编程解决方案，但没有设法找到这样的解决方案。

使用一些已知的 MPL，例如`boost/mpl`，我怎样才能实现上述目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:56:20.950

您可以在运行时注册不同的消息类型，而不是依赖于元编程。注册表可以创建队列向量并提供唯一标识符以最小化查找成本，或者如果您不太关心这一点，您可以始终使用从某个 id 到适当队列的映射。

虽然我不推荐它，但如果您真的想编写一个复杂的模板解决方案，您可以查看类型列表。您需要的所有构建块都在Alexandrescu 的*Modern C++ Design*中（类型列表，如何从中构建层次结构，以及一些花哨的模板技巧）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:13:16.967

将您的类型打包到一个列表中：

```
template<typename... Ts>
struct type_list {}; 
```

使用该列表和参数包解包来创建`std::array`队列。如果您希望队列本身被专门键入，它们将需要位于`tuple`.

上面的列表暗示了索引和类型之间的双射。让每种类型的实例返回索引，您可以使用它来获取队列（在数组中，很容易 -- 在 a 中`tuple`，需要更多工作）。

一个`index_of`特征类，用于在 a 中查找类型的`T`索引`type_list<Ts...>`：

```
template<typename T, typename list, typename=void>
struct index_of {};

template<typename T, typename T0, typename... Ts>
struct index_of<T, type_list<T0, Ts...>, 
                typename std::enable_if<std::is_same<T, T0>::value>::type
               > :  std::integral_constant<size_t, 0> 
{};

template<typename T, typename T0, typename... Ts>
struct index_of<T, type_list<T0, Ts...>, 
                typename std::enable_if<!std::is_same<T, T0>::value>::type
               > :  std::integral_constant<size_t, 
                                   index_of<T, type_list<Ts...>>::value+1> 
{}; 
```

可能实现一个基于 CRTP 的“消息助手”，它同时实现`GetTypeIndex`并确保您的类型位于中央消息列表中。

这需要 C++11，在 C++03 中更难，也更受限制。C++11 编译器也将处理 100 种类型，而无需进行太多额外的模板元编程（严重的元编程，至少在理论上，1000 或更多），而 C++03 编译器即使具有强大的元编程库也可能仅限于10 种类型。

请注意，这种方法的一个优点是，理论上，您可以完全取消抽象父类，或者至少`sendMessage( message const& m )`取消接口（为什么要允许人们发送抽象消息？）。您只能发送实际的具体消息类型。这再次需要一些更多的工作（您创建使用 CRTP 来获取队列的包扩展继承树）。

```
struct MessageBase {
  virtual size_t GetTypeIndex() const = 0;
};
template<typename D, typename List>
struct MessageHelper: public MessageBase {
  static_assert( std::is_base_of< MessageHelper<D,List>, D >::value, "MessageHelper<D> must be inherited from by D" );
  D* self() { return static_cast<D*>(this); }
  D const* self() const { return static_cast<D const*>(this); }
  virtual size_t GetTypeIndex() const final override {
    return index_of<D,List>::value;
  }
};

struct A_Queue {
  std::deque< std::unique_ptr<MessageBase> > data;
};

template<typename type_list>
struct MessageQueues;

template<typename... Ts>
struct MessageQueues<type_list<Ts...>> {
  std::array< A_Queue, sizeof...(Ts) > queues;
  void Enqueue( std::unique_ptr<MessageBase> msg ) {
    size_t index = msg->GetTypeIndex();
    queues[ index ].data.push-back( std::move(msg) );
  }
}; 
```

对于一个非常粗略的实施草案。

# scala - Play 2.0->2.1 迁移后的 SecureSocial 错误

> ID：16043625
> 
> 赞同：1
> 
> 时间：2013-04-16T17:44:07.217
> 
> 标签：scala, playframework, migration, playframework-2.1, securesocial

在 Play 2.0->2.1 迁移后，我在 SecureSocial 中遇到顽固错误。

我正在使用以下依赖项：

```
"securesocial" % "securesocial_2.10" % "master-SNAPSHOT", 
```

我启动了 play 2.1.1，进入*clean*、*update*和*compile*。

编译时出现以下错误：

```
[error] /home/somebody/play/myproject/app/controllers/Application.scala:473: overloaded method value SecuredAction with alternatives:
[error]   (f: securesocial.core.SecuredRequest[play.api.mvc.AnyContent] => play.api.mvc.Result)play.api.mvc.Action[play.api.mvc.AnyContent] <and>
[error]   (ajaxCall: Boolean)(f: securesocial.core.SecuredRequest[play.api.mvc.AnyContent] => play.api.mvc.Result)play.api.mvc.Action[play.api.mvc.AnyContent] <and>
[error]   (authorize: securesocial.core.Authorization)(f: securesocial.core.SecuredRequest[play.api.mvc.AnyContent] => play.api.mvc.Result)play.api.mvc.Action[play.api.mvc.AnyContent] <and>
[error]   (ajaxCall: Boolean,authorize: securesocial.core.Authorization)(f: securesocial.core.SecuredRequest[play.api.mvc.AnyContent] => play.api.mvc.Result)play.api.mvc.Action[play.api.mvc.AnyContent] <and>
[error]   [A](ajaxCall: Boolean, authorize: Option[securesocial.core.Authorization], p: play.api.mvc.BodyParser[A])(f: securesocial.core.SecuredRequest[A] => play.api.mvc.Result)play.api.mvc.Action[A]
[error]  cannot be applied to ()
[error]   def shareKnowledge = SecuredAction() { implicit request =>
[error]                        ^ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T04:02:48.673

您必须删除多余的`()`. 没有采用空的第一个参数列表的方法。

试试这个：

```
def shareKnowledge = SecuredAction { implicit request => 
```

* * *

他们似乎已经删除了默认值，`ajaxCall`因此不再有带有空第一个参数列表的方法签名。

查看此提交更改以了解详细信息：[https ://github.com/jaliss/securesocial/commit/996ec756348c0e150f89358a3d2b447358288609](https://github.com/jaliss/securesocial/commit/996ec756348c0e150f89358a3d2b447358288609)

# php - 将 1 个月添加到 Unix 时间戳的问题

> ID：16043626
> 
> 赞同：2
> 
> 时间：2013-04-16T17:44:15.343
> 
> 标签：php

出于某种原因，我无法让 strtotime('+1 month) 工作。这是我的代码；

```
$Date   = $_REQUEST['date']; //This is a unix time stamp
$Start  = $_REQUEST['start']; //This is a unix time stamp
$End    = $_REQUEST['end']; //This is a unix time stamp 
```

在我的约会上加一个月；

```
$monStart =strtotime('+1 month', $Start);
$monEnd   =strtotime('+1 month', $End);
$monDate  =strtotime('+1 month', $Date); 
```

然后显示我更改的日期；

```
$vEnd = date('m/d/Y', $monEnd);
$vStart = date('m/d/Y', $monStart);
$vDate = date('m/d/Y', $monDate); 
```

我遇到的问题是提供的日期；

```
$Date = 1/31/2013
$Start = 1/01/2013
$End = 1/31/2013 
```

返回;

```
$vDate = 3/03/2013
$vStart = 2/01/2013 //Only correct one
$vEnd = 3/03/2013 
```

请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:04:28.587

它跳到 3 月，因为今天是 1 月 31 日，加上一个月会得到 2 月 31 日，它不存在，所以它正在移动到下一个有效日期。这是一个 PHP 错误。您可以在[https://bugs.php.net/bug.php?id=44073获得更多信息](https://bugs.php.net/bug.php?id=44073)

您可以尝试`DateTime`克服这种情况。您可以根据您的要求使用此功能

```
function add_month($date_value, $months, $format = 'm/d/Y') {
    $date = new DateTime($date_value);
    $start_day = $date->format('j');

    $date->modify("+{$months} month");
    $end_day = $date->format('j');

    if ($start_day != $end_day)
        $date->modify('last day of last month');

    return $date->format($format);
} 
```

现在您可以致电：

```
$vEnd = add_month($monEnd, 1);
$vStart = add_month($monStart, 1);
$vDate = add_month($monDate, 1); 
```

这会给你：

```
$vDate = '02/28/2013';
$vStart = '02/01/2013';
$vEnd = '02/28/2013'; 
```

希望这可以帮助你:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:47:26.467

[DateTime](http://www.php.net/manual/en/book.datetime.php)更*适合*处理日期数学，因为它考虑了月份中的天数：

```
$dt = new DateTime('2013-02-01');
$dt->modify('+1 month');
echo $dt->format('Y-m-d'); 
```

[看到它在行动](http://codepad.viper-7.com/8guw1h)

由于您使用的是时间戳，它可能如下所示：

```
$dt = new DateTime('@'.$_REQUEST['start']);
$dt->modify('+1 month');
echo $dt->format('m/d/Y'); 
```

# javascript - 数据事件的 JavaScript 选择器？

> ID：16043634
> 
> 赞同：1
> 
> 时间：2013-04-16T17:45:00.780
> 
> 标签：javascript

有没有办法根据 data-event 属性选择元素？

这是我所拥有的：

`<button data-event="5456293788" class="id-button-yes greenBtn list-buy-buttons">Buy now!</button>`

寻找类似的东西：

`document.getElementByDataEvent('5456293788')`

可能的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:47:57.227

使用[属性选择器](http://reference.sitepoint.com/css/attributeselector)

[http://jsfiddle.net/QTNzf/](http://jsfiddle.net/QTNzf/)

**JS**

```
document.querySelector('button[data-event="5456293788"]' ); 
```

**CSS**

```
button[data-devent="5456293788"] {
      background-color: #eee;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:48:39.903

在 jQuery 中使用[属性等于选择器：](http://api.jquery.com/attribute-equals-selector/)

```
$('[data-event="5456293788"]') 
```

或与[`document.querySelectorAll`](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)：

```
document.querySelectorAll('[data-event="5456293788"]'); 
```

为了向后兼容，您必须遍历检查属性值的所有元素。在这种情况下，像 jQuery 这样的库确实有帮助。

向后兼容的原始 js：

```
function getElementsByAttr(attr, val) {
    var nodes,
        node,
        i,
        ret;
    val = '' + val;
    nodes = document.getElementsByTagName('*');
    ret = [];
    for (i = 0; i < nodes.length; i += 1) {
        node = nodes[i];
        if (node.getAttribute(attr) === val) {
            ret.push(node);
        }
    }
    return ret;
}
de = getElementsByAttr('data-event', '5456293788'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:49:06.327

像这样的东西？

```
document.querySelector("button[data-event='5456293788']"); 
```

在[JSFiddle中查看](http://jsfiddle.net/MpHms/)

它有相当广泛的[浏览器支持](http://caniuse.com/queryselector)（甚至 IE 8 也支持）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T17:49:41.690

[属性选择器](http://www.w3.org/TR/selectors/#attribute-selectors)确实浮现在脑海中，您不需要 jQuery 来使用它。
不过，它可能不适用于较旧的浏览器。

如果你真的想要，你可以`getElementsByDataEvent`向`document`对象添加一个（不确定是否所有浏览器都允许这样做）：

```
document.getElementsByDataEvent = function(dataEvent)
{
    return document.querySelectorAll('[data-event="'+dataEvent+'"]');
}; 
```

但正如您所看到的，这有点不必要，因为它只是返回`querySelectorAll`调用的返回值。更何况，如果`querySelectorAll`直接使用，还可以做这样的事情

```
document.querySelectorAll('a[data-event="foo"]');//only links will be retured
//or, with some other data-* thing, along the lines of:
document.querySelectorAll('[class="greenBtn"]'); 
```

# c# - 获取数组中所有特定长度的子数组

> ID：16043637
> 
> 赞同：2
> 
> 时间：2013-04-16T17:45:14.533
> 
> 标签：c#, arrays, subset

我需要有关在 C# 中获取数组子集的帮助。所有其他例子对我没有多大帮助。

我想获取特定大小的数组的所有子集。

例如，如果输入数组是 {1,2,3,4} 并且我想要所有大小为 3 的子集，所有唯一子集 {1,2,3},{1,2,4},{2,3,4 },{1,3,4} 必须返回。

我是 C# 新手，非常感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:00:58.483

检查这篇文章。这通过各种编程语言的示例进行了详细描述。我觉得不需要复制其他解决方案，所以我将把它作为一个链接供您从许多应该对您有所帮助的示例中进行选择

[从 n 返回 k 个元素的所有组合的算法](https://stackoverflow.com/questions/127704/algorithm-to-return-all-combinations-of-k-elements-from-n)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:38:44.113

听起来有点像家庭作业……

由于我认为大小是可变的，因此您需要使用递归。就像是：

```
 static void Main(string[] args)
    {
        int[] originalList = new int[] { 1, 2, 3, 4 };
        Stack<int> currentList = new Stack<int>();
        List<int[]> listOfSubsets = new List<int[]>();

        BuildListOfSubsets(originalList, listOfSubsets, 3, 0, currentList);
    }

    private static void BuildListOfSubsets(int[] originalList, List<int[]> listOfSubsets, int sizeOfSubsetList, int currentLevel, Stack<int> currentList)
    {
        if (currentList.Count == sizeOfSubsetList)
        {
            int[] copy = new int[sizeOfSubsetList];
            currentList.CopyTo(copy, 0);
            listOfSubsets.Add(copy);
        }
        else
            for (int ix = currentLevel; ix < originalList.Length; ix++)
            {
                currentList.Push(originalList[ix]);
                BuildListOfSubsets(originalList, listOfSubsets, sizeOfSubsetList, ix + 1, currentList);
                currentList.Pop();
            }
    } 
```

结果将在 listOfSubsets 列表中。看看你是否能找到一个优化来尽早离开 for 循环。

# jquery - 如何在 Firebug 中通过 ajax CORS 请求中的授权？

> ID：16043639
> 
> 赞同：3
> 
> 时间：2013-04-16T17:45:18.093
> 
> 标签：jquery, ajax, cors

我正在尝试通过 ajax jquery 向托管在 https 上的服务器发出管理请求。不知何故，标头身份验证参数未在请求中传递，我收到 401 错误。我无法传递标头授权信息，并且收到 401 未经授权的错误。如何在标头中传递授权？任何机构以前都遇到过这个问题，任何帮助将不胜感激。谢谢。

下面是我的ajax请求::::

```
$.ajax({
    beforeSend: function(xhrObj){
         xhrObj.setRequestHeader("Authorization","Basic YWRtaW46YWRtaW4=");
         xhrObj.setRequestHeader("Access-Control-Allow-Origin","*");
         xhrObj.setRequestHeader("Access-Control-Allow-Methods","POST, GET, OPTIONS, PUT, DELETE");
         xhrObj.setRequestHeader("Access-Control-Allow-Headers","Content-Type");
         } ,
    url: '/test.html',
    type : "POST",
    dataType : "json", 
    crossDomain: true,
    xhrFields: {
        withCredentials: true
        },
    contentType: "application/json" , 
    data: {
        'name'    : 'test123456',
        'description'   : 'test' ,
        'owner'   : 'admin' ,
        'accessRestriction'   : 'VIEW' 
        },
    cache : true, 
     success : function(service_data) {
         alert("success");
      },
     error : function(msg) {
         alert("error");
       }
 }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T15:04:01.530

如果您`content-type`在允许标头中提供，则还需要通过授权。

# javascript - JSHint Eclipse 插件预定义变量抛出未定义警告

> ID：16043641
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:22.453
> 
> 标签：javascript, eclipse, eclipse-plugin, jshint

经过大量的故障排除后，我将我的测试用例简化为……我只使用了全新下载的 Eclipse Juno 和 JSHint 插件。然后我开始一个新项目。选中 JSHint 首选项窗格中的“启用项目特定设置”复选框。我将预定义的全局变量留空。在 JSHint 选项中，我放置了“尾随：真”。我项目中唯一的文件是 foo.js。它有一行：

```
foo.bar(); 
```

此行有一个尾随空格。保存时，尾随空格会引发警告，但未定义的 foo 不会。当我更正尾随空格时， foo is undefined 仍然没有出现。我尝试了许多其他未定义变量的组合，但均无济于事。我什至尝试向预定义的变量添加一些无意义的变量，看看是否有任何作用。没有。

我究竟做错了什么？为什么这不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:12:40.033

您需要在选项中添加“undef: true”以获得未定义的警告。

# ios - NSURL 总是 nil 无视编码

> ID：16043644
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:32.177
> 
> 标签：ios, nsbundle

我正在生成一个 PDF 文件并尝试预览它，如下所示，但 URL 经常返回 NIL，尽管我进行了格式化（这似乎解决了其他所有人对这个常见问题的问题）。我一定错过了更多的东西。有任何想法吗？

```
 NSArray *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);    
NSString *docDirectory = [path objectAtIndex:0];

    docDirectory = [docDirectory stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    NSURL *URL = [[NSBundle mainBundle] URLForResource:docDirectory withExtension:@"pdf"];
if (URL) {
    // Initialize Document Interaction Controller
    self->documentInteractionController = [UIDocumentInteractionController interactionControllerWithURL:URL];
    // Configure Document Interaction Controller
    [self->documentInteractionController setDelegate:self];
    // Preview PDF
    [self->documentInteractionController presentPreviewAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:51:22.590

您的路径创建似乎完全不正常。尝试这样的事情：

```
NSArray *path = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);    
NSString *docDirectory = [path objectAtIndex:0];
NSString *filename = @"myfile.pdf"; // replace with the actual filename you used
NSString *fullPath = [docDirectory stringByAppendingPathComponent:filename];
NSURL *fullURL = [NSURL fileURLWithPath:fullPath]; 
```

在您发布的代码中，您没有提供文件名。您有 Documents 目录和 pdf 扩展名。在这种情况下，不需要对 URL 进行“百分比转义”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:51:13.493

您可能对如何获取文件的路径感到困惑：`NSSearchPathForDirectoriesInDomains`用于获取（例如）您的文档目录的绝对路径。另一方面，在应用程序包装器中搜索具有提供名称的文件`NSBundle`。`URLForResource:withExtension:`

将两者混合使用不会有任何好处。您可能应该只查看文档目录。

# breeze - 如何扩展 BreezeJS 以支持 JSON 请求数据的 Badgerfish 表示法？

> ID：16043645
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:32.860
> 
> 标签：breeze, badgerfish

我正在寻找一个关于如何扩展 BreezeJS（或者如果它甚至可能！）的起点，以支持使用[Badgerfish 表示法](http://www.sklar.com/badgerfish/)从 BreezeJS 向服务器发送 JSON 数据。

我看到 BreezeJS 具有`JsonResultsAdapter`- 从服务器获取响应并对其进行转换 - 这将允许 Breeze 遍历 Badgerfish JSON 结果集并实例化实体。

我需要另一种方式`JsonRequestAdapter`——a（或类似的东西）——获取 Breeze 创建并即将发送到服务器的 JSON，并修改为 Badgerfish 表示法。

对这个问题有任何指导吗？谢谢！

**更新：2013 年 6 月**

我已经采用了实现自定义 Breeze DataService 适配器的方法，该适配器传递到 EntityManager 实例中。老实说，这种方法不适合胆小的人，并且需要一些工作才能真正了解需要发生的事情。我采用了提供的 Web API DataService 适配器并将其“改编”为适用于通用 RESTful 服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:00:45.767

亚当，这是一个**很好的**问题。

我们正在尝试提出一个类似于“JsonResultsAdapter”的标准机制，用于拦截 http“puts”，但我们真的想先了解最常见的用例。我们很乐意提供有关建议和用例的任何反馈。

请为此向[Breeze 用户语音](https://breezejs.uservoice.com/forums/173093-breeze-feature-suggestions)添加“功能请求” 。我们非常认真地对待这些建议，这也是我们认为很重要的一个话题，但我们真的希望从我们的社区获得一些关于其优先级的反馈。

# php - 我将如何延迟 PHP？

> ID：16043646
> 
> 赞同：1
> 
> 时间：2013-04-16T17:45:40.320
> 
> 标签：php, delay

我不是要`sleep()`。我知道那个功能。

```
if(mysql_num_rows($result) == 1){

//DELAY TO OCCUR HERE
echo "You are a validated user.";
    header('Location: usermainpage.php');
    } 
```

如果我使用睡眠功能，它只会延迟加载页面。我希望出现回声，然后发生重定向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:46:52.093

> 如果我使用睡眠功能，它只会延迟加载页面。我希望出现回声，然后发生重定向。

您可以使用良好的旧 HTTP 标头来完成此操作：

```
header('Refresh: 10; URL=usermainpage.php'); 
```

请记住，标头必须在任何其他输出之前发送，否则将触发“标头已发送”错误。要控制输出，您可以查看`ob_*`（输出缓冲区）函数系列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:54:44.340

这真的很恶心，你不应该这样做。只需使用 302 重定向并跳过中间的无用页面：

```
header('Location: usermainpage.php', true, 302); 
```

但是，您可以设置“Refresh”标头，它是非标准的，但非常古老，所有浏览器都可以理解。

```
header('Refresh: 10;URL=usermainpage.php'); 
```

`10`是重定向前的延迟秒数。

但是，如果浏览器不理解此标头，则应在页面上包含指向目标页面的链接。

[来自Stackoverflow](https://stackoverflow.com/questions/283752/refresh-http-header)和[Wikipedia](http://en.wikipedia.org/wiki/Meta_refresh)的更多信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:53:19.877

在输出任何文本*之前*，必须将标头输出到浏览器。如果您首先输出文本，您将失去发送标题的机会，因为页面的正文必须始终最后输出。

如果您希望在显示一些文本后重定向浏览器，您需要使用 Javascript 或 META 重定向：

**Javascript**

```
<script type="text/javascript">
  setTimeout(function() {
    window.location = 'usermainpage.php';
  }, 2000);
</script> 
```

将值 2000 替换为重定向前等待的毫秒数。2000 = 2 秒，10000 = 10 秒。

**元标记**

```
<meta http-equiv="refresh" content="5; URL='usermainpage.php'"> 
```

将数字设置`5`为重定向前等待的秒数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:49:12.083

如果您想在页面加载后执行此操作，则需要使用 javascript 或使用元刷新重定向进行重定向。

# ios - 一个segue - 几个按钮

> ID：16043648
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:50.320
> 
> 标签：ios, objective-c, uibutton, segue

好的，伙计们，这是交易...

我正在尝试将两个视图与一个 segue 连接起来，并在单击按钮的标签中写入标签。我希望你知道我的意思...

这是示例：出现标题视图，您必须选择难度 1-3（按钮的标记值），单击后您将移至游戏视图，但您想在游戏逻辑中使用标题视图按钮的标记值。

这是示例屏幕： ![在此处输入图像描述](https://i.stack.imgur.com/yFHxp.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T22:35:12.377

这就是我发现的，非常适合！

```
// When any of my buttons are pressed, push the next view
- (IBAction)buttonPressed:(id)sender
{
    [self performSegueWithIdentifier:@"Segue" sender:sender];
}

// This will get called before the view appears
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"Segue"]) {

        // Get destination view
        SecondView *vc = [segue destinationViewController];

        // Get button tag number (or do whatever you need to do here, based on your object
        NSInteger tagIndex = [(UIButton *)sender tag];

        // Pass the information to your destination view
        [vc setSelectedButton:tagIndex];
    }
} 
```

这是整个主题的[链接。](https://stackoverflow.com/q/7864371/1911042)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T17:56:25.730

设置您的按钮以触发呈现第二个视图控制器的 segue。

在您的第一个视图控制器中，实现`- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender`并使用发送者来检索标签。

# javascript - 从关联的 html 调用使用 WinJS.UI.Pages.define 定义的函数的语法是什么？

> ID：16043649
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:52.627
> 
> 标签：javascript, windows-8, microsoft-metro, winjs

由于很可能我做错了什么，我想描述一下我正在尝试完成的事情，以防有更好的方法。

平台：使用 HTML5/WinJS 导航模板的 Windows 8 应用程序。

我有一些 PageControls 可以查询数据并使用 d3.js 来可视化结果集。

我有另一个 PageControl(dashboard)，它使用 WinJS.UI.ListView 提供指向这些页面/图表的链接。目前，我在 ListView 中使用了一些静态图像。我要做的是访问图形页面并在选择屏幕上显示图形的“较小”版本。

我尝试过的一些事情： - iFrame 似乎没有滚动（结果看起来很丑陋）。- 我无法弄清楚如何以编程方式进行屏幕截图（这将是最好的选择，因为我可以在使用共享合同共享图表时使用相同的技术）。- 我试过做一个 Page.render，但它似乎只有在我在 html 页面中的某个地方调用我的 draw() 函数时才有效。换句话说，ready() 函数似乎没有作为渲染的一部分被调用。所以，我已经将绘图代码移到了 html 中（我真的不喜欢），这似乎工作正常。我想做的是将绘图函数移回 Page.define 并从 html 中的一行脚本调用它（除非有更好的方法），但我没有

我将不胜感激有关语法的任何指示或有关更好地完成一般任务的方法的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T20:43:29.280

我建议将绘图代码放在一个单独的 .js 文件中，您可以从应用程序的任何位置引用该文件。设置如下：

```
WinJS.Namespace.define('My.App.Namespace', {
    drawingFunction: function () {
        //code goes here
    }
}); 
```

将其保存到名为 drawing.js 的文件中，并将其包含在您的 default.html 中。然后您可以`My.App.Namespace.drawingFunction()`从 html 或 javascript 调用。

# javascript - webkit 外观 - textarea 背景：无

> ID：16043650
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:55.617
> 
> 标签：javascript, jquery, css, webkit

我有一个 webkit 外观问题。我想要完成的是使用一个分区作为一个内容可编辑的分区，并带有一个 textarea 的 webkit 外观。在我尝试删除背景之前，这非常有效。我可以毫无问题地更改颜色，但事实证明删除它是徒劳的。我尝试使用透明图像作为背景，但文本区域的外观似乎将其覆盖为特定颜色。

问题是，是否可以将 css 设置为 background: none; 使用外观时。

我整理了一个 jsfiddle 作为进一步的解释。

```
.div1 {width: 350px;
height: 100px;
-webkit-appearance: textarea;
resize: both;
overflow: auto;} 
```

[jsfiddle](http://jsfiddle.net/eMkv3/2/)

PS。我希望我做对了：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:48:33.403

只需将背景颜色更改为

```
background-color: rgba(255, 255, 255, 0); 
```

这将使背景透明。如果它将是零 alpha（不透明度），您可以使 RGB 成为您想要的任何颜色。

[http://jsfiddle.net/eMkv3/7/](http://jsfiddle.net/eMkv3/7/)

这是我的浏览器上的截图： [![截屏](https://i.stack.imgur.com/Ygnj1.png)](https://i.stack.imgur.com/Ygnj1.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:13:25.540

**不要使用`-webkit-appearance`**.

WebKit 将 textarea 的默认样式应用于您的 div。

**CSS**

```
.div1 {
    width: 350px;
    height: 100px;
    background: none;
    resize: both;
    overflow: auto;
    font-family: monospace;
    border: 1px solid #000;
}

textarea {
    background: none;
    width: 350px;
    height: 100px;
} 
```

**JSFiddle：http: [//jsfiddle.net/howderek/eMkv3/5/](http://jsfiddle.net/howderek/eMkv3/5/)**

# javascript - 选择导航到 URL 上的单选按钮

> ID：16043651
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:58.200
> 
> 标签：javascript, html

我是 java 脚本的新手并试图实现以下目标并正在寻找建议：

创建两个单选按钮，每当我们选择单选按钮时，它应该导航到某个 URL，如下例 XYZ.com 或 ABC.com

```
<html>
<table width="450">
<tr>
<td style="background-color:#FFFFFF;"><h4>Choose a Field</h4></td>
</tr>
</table></br>
<form action="../">
<fieldset>
<input type="RADIO" value="http://xyz.com"     name="userChoice" id="navRadio01">
 <label for="navRadio01">XYZ</label><br> 
<input type="RADIO" value="http://abc.com"    name="userChoice" id="navRadio02" checked>
        <label for="navRadio02">ABC</label><br>  
<input type="BUTTON"  value="Go"    onclick="ob=this.form.userChoice;for(i=0;i<ob.length;i++){
    if(ob[i].checked){window.open(ob[i].value,'_self');};}" style="color:#FFFFF;background-color:#E0E0E5;font-family:verdana;border-style:solid;" />
</fieldset>
</form>
</html> 
```

我在上面的示例中使用了 Go 按钮，如果不使用 Go 按钮并且一旦选择导航到该链接，我们如何做到这一点。？

请指教。

谢谢大家。

- V

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:58:00.230

您可以使用单选按钮的“onclick”事件处理程序来执行此操作，如下所示：

```
<input type="RADIO" value="http://abc.com" onclick="window.open(this.value)" name="userChoice" id="navRadio02" checked> 
```

请注意，正如您对问题的评论中所述，锚标签更适合执行此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:00:03.823

试试这个例子：

```
<html>
<table width="450">
<tr>
<td style="background-color:#FFFFFF;"><h4>Choose a Field</h4></td>
</tr>
</table></br>
<form action="../">
<fieldset>
<input type="RADIO" name="userChoice" id="navRadio01" onclick="window.location='http://google.com'">
<input type="RADIO" name="userChoice" id="navRadio02"  onclick="window.location='http://yahoo.com.com'">
</fieldset>
</form>
</html> 
```

希望能帮助到你...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:56:40.340

看看这里：

[使用 javascript 在单选按钮列表上调用 onclick](https://stackoverflow.com/questions/362614/calling-onclick-on-a-radiobutton-list-using-javascript)

有一点争论，然后在底部有一个完整的例子。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:59:56.463

您可以将单选按钮的引用传递给由单选按钮的 onclick 事件触发的函数。然后在函数中，打开由单选按钮的值指定的链接。

例如，函数`openLink`根据单选按钮的值打开一个链接。

```
<script>
function openLink(radio){
 window.open(radio.value,'_self');
}
</script> 
```

然后在 HTML 页面的正文中，在单击单选按钮时传递一个对函数的引用`openLink`：

```
<fieldset>
<input type="radio" id="fname"  value="http://www.abc.com" name="name1" onclick="openLink(this)">

<input type="radio" value="http://www.xyz.com" id="fname2" name="name1" onclick="openLink(this)">
</fieldset> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-03T07:23:50.767

```
<html>
<table width="450">
<tr>
<td style="background-color:#FFFFFF;"><h4>Choose a Field</h4></td>
</tr>
</table></br>
<form action="../">
<fieldset>
<input type="RADIO" name="userChoice" id="navRadio01" onclick="window.location='http://google.com'">
<input type="RADIO" name="userChoice" id="navRadio02"  onclick="window.location='http://yahoo.com.com'">
</fieldset>
</form>
</html>
```

# vb.net - WCF：生产中的服务引用

> ID：16043652
> 
> 赞同：0
> 
> 时间：2013-04-16T17:45:59.843
> 
> 标签：vb.net, wcf, service-reference

对于将要部署到不同客户的应用程序，我对使用服务引用有一些疑问。它是 vb.net 上的 WCF 服务，将托管在 Windows 服务中，并且将由具有不同 IP 地址的非常不同的客户使用。不同的环境，可以这么说。

我已经制作了服务器和客户端。它们在客户端上使用服务引用工作得很好，但由于这些需要服务的 URL（将具有以下结构：*net.tcp://SomeHost:6666/SomeService*），问题是：我该怎么做才能使用客户环境的服务参考？我正在考虑以编程方式更改其 URL，但我不知道这是否可能。

当然，主机名会因客户而异，但服务引用是静态的。我想过使用不同的方法，例如： http: [//mstecharchitect.blogspot.com.ar/2009/01/invoking-wcf-service-without-service.html](http://mstecharchitect.blogspot.com.ar/2009/01/invoking-wcf-service-without-service.html)。但这会让我失去服务参考的好处，据我了解，它创建了所需的代理，因此我可以在客户端使用它。

无论您需要什么其他信息来帮助我，请不要犹豫。并提前感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:51:45.897

您可以在配置文件（例如 appsettings）中存储您的服务端点地址，在代码中您将只更新主机名。

您的 appsettings 将包含类似 net.tcp://{0}:6666/SomeService 的内容。

创建客户端（代理）实例时 - 您将添加特定主机并传递此构建地址。

就像是：

客户端上的 app.config：

```
 <appSettings>
    <add key="YourService.ClientAddress" value="net.tcp://{0}:6666/SomeService" />
  . . . 
```

然后，在代码中，

```
 string endpointUrl = string.Format(ConfigurationManager.AppSettings["YourService.ClientAddress"], Your_Host_name);
    YourClient client = new YourClient(YourEndpointName, endpointUrl); 
```

# css - 仅设置第一个匹配和最后一个匹配的样式

> ID：16043653
> 
> 赞同：2
> 
> 时间：2013-04-16T17:46:10.513
> 
> 标签：css

如何仅针对 CSS 中选择器的第一个和最后一个匹配项？

**示例**（这只是一个示例，需要通用解决方案）来说明我的要求：

```
<style>
    main>article p:first { /* to select the first p anywhere under article */ }
    main>article p:last { /* to select the last p anywhere under article  */ }
</style>
<main>
    <article>
        <section>
            <p>SHOULD be selected as first element</p>
            <p>SHOULD NOT be selected</p>
        </section>
        <ul>
            <li><p>SHOULD NOT be selected</p></li>
            <li><p>SHOULD NOT be selected</p></li>
        </ul>
        <p>SHOULD be selected as last element</p>
    </article>
</main> 
```

下的 DOM`<article>`可能有`<p>`子级。`<p>`s（包括第一个和最后一个）不需要是`<article>`虽然的直接孩子，并且可以有任何一组父母。是否有任何不必要的优雅 CSS 规则来仅选择第一个和最后一个`<p>`？

不允许使用此问题的标签所指示的 JavaScript，但出于演示目的......以下代码正是我想要实现的：

```
var els   = document.querySelectorAll('main>article p'),
    first = els[0],
    last  = els[els.length - 1]; 
```

现在我已经尝试过使用并且对我没有用的东西：

*   `:first-child`与,的任何选择器组合`:last-child`
    *   无法保证可以使用任何结构来制作防故障选择器，该选择器只会选择第一个和最后`p`一个是`<article>`.
*   `:first-of-type`与,的任何选择器组合`:last-of-type`
    *   因为这也会选择第一个/最后一个`article *>p`
    *   特别是我尝试过`main>article p:first-of-type`和`main>article p:first-of-type`.
*   覆盖`~`和/或`+`

**编辑**

1.  DOM 不一定与示例中给出的相同——毕竟这只是一个示例。
2.  first 和 last`<p>`都是 article 的子项，但并不总是直接子项。`<p>`这意味着在 first/last和 parent之间可能还有其他元素`<article>`。
3.  只记得jQuery。`$('main>article p:first')`并且`$('main>article p:last')`从 jQuery 中可以完全满足我的要求，但我仅限于 CSS。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:54:38.513

您可以使用第一个类型/最后一个类型您可以选择具有元素类型的父级的第一个/最后一个子级

```
p:first-of-type 
```

或者

```
p:last-of-type 
```

这将选择第一个或最后一个段落元素，它是父元素的子元素

```
p:first-child 
```

或者

```
p:last-child 
```

类似于 last-of-type

W3 学校对此也有一些很好的信息

[http://www.w3schools.com/cssref/css_selectors.asp](http://www.w3schools.com/cssref/css_selectors.asp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:58:19.220

不幸的是，不使用 JavaScript 就不可能做你想做的事（如你原来的问题所示）。当前没有可用的全局`nth-of-class`选择器。我相信这是因为元素的样式是一次性计算出来的。选择器无法真正了解 DOM 树的*其他*分支中的元素。

就像您如何使用相邻兄弟 ( `+`) 和一般兄弟 ( `~`) 组合子来应用**在**某个选择器之后而不是在它之前的样式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T18:03:18.957

这解决了这个问题：

```
article section > p:first-child {
    color: red;
}

article > p:last-child{
    color: red;
} 
```

[**小提琴**](http://jsfiddle.net/tdTqD/2/)

或这个：

```
main p:first-child {
    color: red;
}

main article > p:last-child{
    color: red;
}
article > ul p{color:black !important;} 
```

[**小提琴**](http://jsfiddle.net/tdTqD/3/)

# java - 需要帮助捆绑额外服务

> ID：16043665
> 
> 赞同：0
> 
> 时间：2013-04-16T17:46:51.043
> 
> 标签：java, android, nullpointerexception

在我的新 Java 类 (Tap.java) 中实现以下 null 检查：

```
Bundle extras = getIntent().getExtras();
        if (extras == null) {
            Log.e(TAG, "received no extras!"); 
```

结果是：

```
ViewCountry(11637): received no extras! 
```

因此，我相信我需要将附加功能捆绑到我创建的新类 (Tap.java) 以及它当前从 CountryList.java 捆绑到 (ViewCountry.java) 的现有类中。

如何实现？

以下捆绑包是我想要扩展以包含相同数据（ROW_ID、arg3）的捆绑包：

```
Intent viewCon = new Intent(CountryList.this, ViewCountry.class);
          viewCon.putExtra(ROW_ID, arg3);
          startActivity(viewCon); 
```

如何扩展它以将数据也发送到 Tap.java？

```
public class Tap extends Enable {

    private static final String TAG = ViewCountry.class.getName();

    protected Message message;

    NfcAdapter mNfcAdapter;
    private static final int MESSAGE_SENT = 1;
    private long rowID;
    private TextView nameTv;
    private TextView capTv;
    private TextView codeTv;
    private TextView timeTv;
    private TextView ssidTv;
    private TextView combined;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.view_country);
        setDetecting(true);
        startPushing();
        setUpViews();
        Bundle extras = getIntent().getExtras();
        rowID = extras.getLong(CountryList.ROW_ID);
    }

    private void setUpViews() {
        nameTv = (TextView) findViewById(R.id.nameText);
        capTv = (TextView) findViewById(R.id.capText);
        timeTv = (TextView) findViewById(R.id.timeEdit);
        codeTv = (TextView) findViewById(R.id.codeText);
        ssidTv = (TextView) findViewById(R.id.wifiSSID);

    }

    @Override
    public NdefMessage createNdefMessage(NfcEvent event) {
        Log.d(TAG, "Create message to be beamed");
        String a = "";
        String b = "";
        String message1 = a + ssidTv.getText().toString() + ","
                + capTv.getText().toString() + b;

        // create message to be pushed, for example
        Message message = new Message();
        // add text record
        message.add(new TextRecord(message1));
        // add 'my' external type record
    //  message.add(new GenericExternalTypeRecord("com.wifi.demo", "atype",
        //      "My data".getBytes(Charset.forName("UTF-8"))));

        // encode to NdefMessage, will be pushed via beam (now!) (unless there
        // is a collision)
        return message.getNdefMessage();
    }

    /**
     * 
     * Implementation of {@link OnNdefPushCompleteCallback} interface.
     * 
     * This method is called after a successful transfer (push) of a message
     * from this device to another.
     */

    @Override
    protected void onNdefPushCompleteMessage() {
        // make toast
        toast(R.string.nfcBeamed);

        // vibrate
        Vibrator vibe = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);
        vibe.vibrate(500);
    }

    public void toast(int id) {
        toast(getString(id));
    }

    public void toast(String message) {
        Toast toast = Toast.makeText(this, message, Toast.LENGTH_LONG);
        toast.setGravity(Gravity.CENTER_HORIZONTAL | Gravity.CENTER_VERTICAL,
                0, 0);
        toast.show();
    }

    /**
     * 
     * NFC was found and enabled in settings, and push is enabled too.
     * 
     */

    @Override
    protected void onNfcPushStateEnabled() {
        toast(getString(R.string.nfcBeamAvailableEnabled));
    }

    /**
     * 
     * NFC was found and enabled in settings, but push is disabled
     * 
     */

    @Override
    protected void onNfcPushStateDisabled() {
        toast(getString(R.string.nfcBeamAvailableDisabled));
    }

    /**
     * 
     * NFC beam setting changed since last check. For example, the user enabled
     * beam in the wireless settings.
     * 
     */

    @Override
    protected void onNfcPushStateChange(boolean enabled) {
        if (enabled) {
            toast(getString(R.string.nfcBeamAvailableEnabled));
        } else {
            toast(getString(R.string.nfcBeamAvailableDisabled));
        }
    }

    /**
     * 
     * NFC feature was found and is currently enabled
     * 
     */

    @Override
    protected void onNfcStateEnabled() {
        toast(getString(R.string.nfcAvailableEnabled));
    }

    /**
     * 
     * NFC feature was found but is currently disabled
     * 
     */

    @Override
    protected void onNfcStateDisabled() {
        toast(getString(R.string.nfcAvailableDisabled));
    }

    /**
     * 
     * NFC setting changed since last check. For example, the user enabled NFC
     * in the wireless settings.
     * 
     */

    @Override
    protected void onNfcStateChange(boolean enabled) {
        if (enabled) {
            toast(getString(R.string.nfcAvailableEnabled));
        } else {
            toast(getString(R.string.nfcAvailableDisabled));
        }
    }

    /**
     * 
     * This device does not have NFC hardware
     * 
     */

    @Override
    protected void onNfcFeatureNotFound() {
        toast(getString(R.string.noNfcMessage));
    }

    /**
     * An NDEF message was read and parsed
     * 
     * @param message
     *            the message
     */

    @Override
    protected void readNdefMessage(Message message) {
        if (message.size() > 1) {
            toast(getString(R.string.readMultipleRecordNDEFMessage));
        } else {
            toast(getString(R.string.readSingleRecordNDEFMessage));
        }
    }

    /**
     * An empty NDEF message was read.
     * 
     */

    @Override
    protected void readEmptyNdefMessage() {
        toast(getString(R.string.readEmptyMessage));
    }

    /**
     * 
     * Something was read via NFC, but it was not an NDEF message.
     * 
     * Handling this situation is out of scope of this project.
     * 
     */

    @Override
    protected void readNonNdefMessage() {
        toast(getString(R.string.readNonNDEFMessage));
    }

    // mNfcAdapter = NfcAdapter.getDefaultAdapter(this);
    // if (mNfcAdapter == null) {
    // / nameTv = (TextView) findViewById(R.id.nameText);
    // nameTv.setText("NFC is not available on this device.");
    // capTv = (TextView) findViewById(R.id.capText);
    // capTv.setText("NFC is not available on this device.");
    // codeTv = (TextView) findViewById(R.id.codeText);
    // codeTv.setText("NFC is not available on this device.");
    // timeTv = (TextView) findViewById(R.id.timeEdit);
    // timeTv.setText("NFC is not available on this device.");
    // } else {
    // mNfcAdapter.setNdefPushMessageCallback(this, this);
    // mNfcAdapter.setOnNdefPushCompleteCallback(this, this);
    // }
    // }

    // @Override
    // public NdefMessage createNdefMessage(NfcEvent event) {

    // String a="\"";
    // String b="\"";

    // String message1 = a + ssidTv.getText().toString() +"," +
    // capTv.getText().toString()+b;
    // String message2 = nameTv.getText().toString();
    // String message3 = codeTv.getText().toString();
    // String message4 = timeTv.getText().toString();
    // byte[] textBytes1 = message1.getBytes();
    // byte[] textBytes2 = message2.getBytes();
    // byte[] textBytes3 = message3.getBytes();
    // byte[] textBytes4 = message4.getBytes();
    // NdefRecord textRecord1 = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
    // message1.getBytes(), new byte[] {}, textBytes1);
    // NdefRecord textRecord2 = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
    // message2.getBytes(), new byte[] {}, textBytes2);
    // NdefRecord textRecord3 = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
    // message3.getBytes(), new byte[] {}, textBytes3);
    // NdefRecord textRecord4 = new NdefRecord(NdefRecord.TNF_WELL_KNOWN,
    // message4.getBytes(), new byte[] {}, textBytes4);

    // NdefMessage msg = new NdefMessage(new NdefRecord[] {textRecord1,
    // textRecord2, textRecord3, textRecord4,
    // NdefRecord.createApplicationRecord("com.nfc.linked") });
    // return msg;

    // /**
    // * Implementation for the OnNdefPushCompleteCallback interface
    // */
    // @Override
    // public void onNdefPushComplete(NfcEvent arg0) {
    // mHandler.obtainMessage(MESSAGE_SENT).sendToTarget();
    // }

    // /** This handler receives a message from onNdefPushComplete */
    // private final Handler mHandler = new Handler() {
    // @Override
    // public void handleMessage(Message msg) {
    // switch (msg.what) {
    // case MESSAGE_SENT:
    // Toast.makeText(getApplicationContext(),
    // "Core Device Rules Sent!", Toast.LENGTH_LONG).show();
    // break;
    // }
    // }
    // };

    // @Override
    // public void onNewIntent(Intent intent) {

    // setIntent(intent);
    // }

    // void processIntent(Intent intent) {
    // Parcelable[] rawMsgs = intent
    // .getParcelableArrayExtra(NfcAdapter.EXTRA_NDEF_MESSAGES);
    // NdefMessage msg = (NdefMessage) rawMsgs[0];
    // nameTv.setText(new String(msg.getRecords()[0].getPayload()));
    // }

    @Override
    protected void onResume() {
        super.onResume();
        new LoadContacts().execute(rowID);
    }

    private class LoadContacts extends AsyncTask<Long, Object, Cursor> {
        DatabaseConnector dbConnector = new DatabaseConnector(Tap.this);

        @Override
        protected Cursor doInBackground(Long... params) {
            dbConnector.open();
            return dbConnector.getOneContact(params[0]);
        }

        @Override
        protected void onPostExecute(Cursor result) {
            super.onPostExecute(result);

            result.moveToFirst();
            int nameIndex = result.getColumnIndex("name");
            int capIndex = result.getColumnIndex("cap");
            int codeIndex = result.getColumnIndex("code");
            int timeIndex = result.getColumnIndex("time");
            int ssidIndex = result.getColumnIndex("ssid");

            nameTv.setText(result.getString(nameIndex));
            capTv.setText(result.getString(capIndex));
            timeTv.setText(result.getString(timeIndex));
            codeTv.setText(result.getString(codeIndex));
            ssidTv.setText(result.getString(ssidIndex));

            result.close();
            dbConnector.close();
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        super.onCreateOptionsMenu(menu);
        MenuInflater inflater = getMenuInflater();
        inflater.inflate(R.menu.view_country_menu, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case R.id.editItem:
            Intent addEditContact = new Intent(this, AddEditDevice.class);

            // addEditContact.putExtra(CountryList.ROW_ID, rowID);
            // addEditContact.putExtra("name", nameTv.getText());
            // addEditContact.putExtra("cap", capTv.getText());
            // addEditContact.putExtra("code", codeTv.getText());
            startActivity(addEditContact);
            return true;

        case R.id.user1SettingsSave:
            Intent Tap = new Intent(this, ViewCountry.class);
            startActivity(Tap);
            return true;

        case R.id.deleteItem:
            deleteContact();
            return true;

        default:
            return super.onOptionsItemSelected(item);
        }
    }

    private void deleteContact() {

        AlertDialog.Builder alert = new AlertDialog.Builder(Tap.this);

        alert.setTitle(R.string.confirmTitle);
        alert.setMessage(R.string.confirmMessage);

        alert.setPositiveButton(R.string.delete_btn,
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int button) {
                        final DatabaseConnector dbConnector = new DatabaseConnector(
                                Tap.this);

                        AsyncTask<Long, Object, Object> deleteTask = new AsyncTask<Long, Object, Object>() {
                            @Override
                            protected Object doInBackground(Long... params) {
                                dbConnector.deleteContact(params[0]);
                                return null;
                            }

                            @Override
                            protected void onPostExecute(Object result) {
                                finish();
                            }
                        };

                        deleteTask.execute(new Long[] { rowID });
                    }
                });

        alert.setNegativeButton(R.string.cancel_btn, null).show();
    }

} 
```

CountryList.java

```
public class CountryList extends ListActivity {

     public static final String ROW_ID = "row_id";
     private ListView conListView;
     private CursorAdapter conAdapter;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        conListView=getListView();
        conListView.setOnItemClickListener(viewConListener);

        // map each name to a TextView
        String[] from = new String[] { "name" };
        int[] to = new int[] { R.id.countryTextView };
        conAdapter = new SimpleCursorAdapter(CountryList.this, R.layout.country_list, null, from, to);
        setListAdapter(conAdapter); // set adapter
    }

    @Override
    protected void onResume() 
    {
       super.onResume();  
       new GetContacts().execute((Object[]) null);
     } 

    @Override
    protected void onStop() 
    {
       Cursor cursor = conAdapter.getCursor();

       if (cursor != null) 
          cursor.deactivate();

       conAdapter.changeCursor(null);
       super.onStop();
    }    

    private class GetContacts extends AsyncTask<Object, Object, Cursor> 
    {
       DatabaseConnector dbConnector = new DatabaseConnector(CountryList.this);

       @Override
       protected Cursor doInBackground(Object... params)
       {
          dbConnector.open();
          return dbConnector.getAllContacts(); 
       } 

       @Override
       protected void onPostExecute(Cursor result)
       {
          conAdapter.changeCursor(result); // set the adapter's Cursor
          dbConnector.close();
       } 
    } 

    @Override
    public boolean onCreateOptionsMenu(Menu menu) 
    {
       super.onCreateOptionsMenu(menu);
       MenuInflater inflater = getMenuInflater();
       inflater.inflate(R.menu.country_menu, menu);
       return true;
    }   

    @Override
    public boolean onOptionsItemSelected(MenuItem item) 
    {
       Intent addContact = new Intent(CountryList.this, AddEditDevice.class);
       startActivity(addContact);
       return super.onOptionsItemSelected(item);
    }

    OnItemClickListener viewConListener = new OnItemClickListener() 
    {
       public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,long arg3) 
       {         
          Intent viewCon = new Intent(CountryList.this, ViewCountry.class);
          viewCon.putExtra(ROW_ID, arg3);
          startActivity(viewCon);
       }
    };    

} 
```

日志猫：

```
04-16 13:37:22.415: E/AndroidRuntime(10285): FATAL EXCEPTION: main
04-16 13:37:22.415: E/AndroidRuntime(10285): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.wifi.demo/com.wifi.demowifi.demo.Tap}: java.lang.NullPointerException
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.os.Looper.loop(Looper.java:137)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.ActivityThread.main(ActivityThread.java:5041)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at java.lang.reflect.Method.invokeNative(Native Method)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at java.lang.reflect.Method.invoke(Method.java:511)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at dalvik.system.NativeStart.main(Native Method)
04-16 13:37:22.415: E/AndroidRuntime(10285): Caused by: java.lang.NullPointerException
04-16 13:37:22.415: E/AndroidRuntime(10285):    at com.wifi.demo.Tap.onCreate(Tap.java:75)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.Activity.performCreate(Activity.java:5104)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-16 13:37:22.415: E/AndroidRuntime(10285):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-16 13:37:22.415: E/AndroidRuntime(10285):    ... 11 more
04-16 13:37:25.315: D/libEGL(10339): loaded /system/lib/egl/libEGL_tegra.so
04-16 13:37:25.345: D/libEGL(10339): loaded /system/lib/egl/libGLESv1_CM_tegra.so
04-16 13:37:25.355: D/libEGL(10339): loaded /system/lib/egl/libGLESv2_tegra.so
04-16 13:37:25.385: D/OpenGLRenderer(10339): Enabling debug mode 0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:58:44.240

似乎当您开始第二个活动时，您没有通过 Intent 传递任何数据

为了更清楚，您必须执行与调用“ViewCountry”时相同的操作

```
 Intent viewCon = new Intent(CountryList.this, ViewCountry.class);
  viewCon.putExtra(ROW_ID, arg3);
  startActivity(viewCon); 
```

# css - 样式无序列表独立于父无序列表

> ID：16043669
> 
> 赞同：0
> 
> 时间：2013-04-16T17:46:57.027
> 
> 标签：css, wordpress, navigation, html-lists

我不确定我是否正确地提出了这个问题，但让我试着解释一下我想要达到的目标。

我正在尝试设计基于 WordPress 的网站的导航菜单。

我希望子菜单链接沿网站`<body>`标签的整个宽度（960 像素宽）均匀排列。如果特定子菜单的链接不适合一行，我希望它们环绕并排列成整齐的列。

最后，我希望子菜单在悬停时下拉，将网站的其余内容向下推。

**问题：**子菜单无序列表影响父无序列表中链接的位置，移动链接。不知何故，为了保持父菜单链接不变，我唯一能做的就是通过应用将子菜单拉开`margin-right:-965px;`

**问题：**我应该如何修改我的 CSS 以将两个子菜单一直定位到左侧，与主容器的边缘齐平？

（如有必要，我可以分别为每个子菜单分配自定义类，例如：.submenu-about 和 .submenu-investors。）

预先感谢您的帮助！

这是导航菜单的完整 CSS：

```
.main-navigation ul {
list-style-type:none;
margin-top:45px;
}

.main-navigation ul {
display: inline-block;
width:70%;
float:right;
}

.main-navigation ul li {
float:left;
}

.main-navigation ul li a {
display:block;
margin:3px 0 3px 40px;
}

.main-navigation ul ul {
background:#efefef;
display:none;
}

.main-navigation li {
    font-size: 13px;
}

.main-navigation li a {
outline: none;
text-decoration:none;
border-bottom: 0;
color: #6a6a6a;
text-transform: uppercase;
//white-space: nowrap;
}

.main-navigation li a:hover {
color: #000;
}

.main-navigation ul li:hover > ul {
margin:-1px -960px 3px 0;
display:block;
width:960px;
}

.main-navigation li ul li a {
font-size: 11px;
margin: 10px 0 10px 10px;
width:180px;
}

.main-navigation .menu-item > a,
.main-navigation .menu-ancestor > a,
.main-navigation .page_item > a,
.main-navigation .page_ancestor > a {
color: #9a9a9a;
font-weight:bold;
}

.main-navigation .current-menu-item > a,
.main-navigation .current-menu-ancestor > a,
.main-navigation .current_page_item > a,
.main-navigation .current_page_ancestor > a {
color: #636363;
font-weight:bold;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:03:12.867

这应该这样做

将此添加到您的CSS

```
.main-navigation ul li .sub-menu {position:absolute; left:0px;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T20:46:15.807

找到了我自己的答案。

1.  从 中删除背景`ul li:hover ul`。

2.  设置`position:relative`和灰色背景为`ul li:hover >ul li`.

3.  为每个子菜单`li`项单独设置负左边距，以将它们分别向左拉不同数量的像素。

# android-camera-intent - startActivityForResult 拍照并保存但 Intent 为空

> ID：16043670
> 
> 赞同：1
> 
> 时间：2013-04-16T17:46:59.247
> 
> 标签：android-camera-intent

我正在尝试使用`Intent`. 我正在启动`startActivityForResult`，相机应用程序启动。拍完照片后，我按下保存按钮并尝试退回我的申请。但在`onActivityResult` `Intent data`总是`null`。我的应用基于 Android 开发者相机教程。这是我的代码：

```
public class MainActivity extends Activity {
    private static final int CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE = 100;
    private static final int MEDIA_TYPE_IMAGE = 1;
    private static Intent intent;
    private TextView tv;

    private Uri fileUri;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.layout_main);

        // create Intent to take a picture and return control to the calling
        // application
        intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
        fileUri = getOutputMediaFileUri(MEDIA_TYPE_IMAGE); // create a file to save the image
        intent.putExtra(MediaStore.EXTRA_OUTPUT, fileUri); // set the image file name

        Button b = (Button)findViewById(R.id.button1);
        b.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                startActivityForResult(intent, CAPTURE_IMAGE_ACTIVITY_REQUEST_CODE);
            }
        });

        tv = (TextView)findViewById(R.id.textView1);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    /** Create a file Uri for saving an image or video */
    private static Uri getOutputMediaFileUri(int type) {
        return Uri.fromFile(getOutputMediaFile(type));
    }

    /** Create a File for saving an image or video */
    private static File getOutputMediaFile(int type) {
        // To be safe, you should check that the SDCard is mounted
        // using Environment.getExternalStorageState() before doing this.

        File mediaStorageDir = 
                new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_PICTURES), "MyCameraApp");
        // This location works best if you want the created images to be shared
        // between applications and persist after your app has been uninstalled.

        // Create the storage directory if it does not exist
        if (!mediaStorageDir.exists()) {
            if (!mediaStorageDir.mkdirs()) {
                Log.d("MyCameraApp", "failed to create directory");
                return null;
            }
        }

        // Create a media file name
        String timeStamp = new SimpleDateFormat("yyyyMMdd_HHmmss")
                .format(new Date());
        File mediaFile;
        if (type == MEDIA_TYPE_IMAGE) {
            mediaFile = new File(mediaStorageDir.getPath() + File.separator
                    + "IMG_" + timeStamp + ".jpg");
        } else {
            return null;
        }

        return mediaFile;
    }

    @Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {
        if (resultCode == RESULT_OK) {
            // Image captured and saved to fileUri specified in the Intent
            //Toast.makeText(this, "Image saved to:\n" + data.getData(), Toast.LENGTH_LONG).show();
            if(data != null)
                tv.setText("Dosya şuraya kaydedildi:\n" + data.getData());
        } else if (resultCode == RESULT_CANCELED) {
            // User cancelled the image capture
        } else {
            // Image capture failed, advise user
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T21:29:33.260

我在这个问题中找到了答案：
[android camera: onActivityResult() intent is null if it has extras](https://stackoverflow.com/questions/12564112/android-camera-onactivityresult-intent-is-null-if-it-had-extras)
“如果你没有指定 MediaStore.EXTRA_OUTPUT 那么你将有一个意图，其中包含相机保存的文件中的 uri照片。”

# php - 使用 popen、fgets 和 ssh 在两个远程服务器之间发送数据

> ID：16043671
> 
> 赞同：0
> 
> 时间：2013-04-16T17:47:00.397
> 
> 标签：php, ssh, pipe, stdin, popen

我尝试通过 ssh 和管道与两台机器通信以从一台机器获取消息。第二个使用 sdtin 从第一台机器读取消息并写入文本文件。

我有一台机器，我有这个程序，但它不起作用......

```
$message = "Hello Boy";
$action = ('ssh root@machineTwo script.php'); 
$handle = popen($action, 'w');

if($handle){
   echo $message;
   pclose($handle);
} 
```

在另一台机器上， machineTwo 我有：

```
 $filename = "test.txt";    
     if(!$fd = fopen($filename, "w");
     echo "error";
        }
     else {
            $action = fgets(STDIN);
            fwrite($fd, $action);
    /*On ferme le fichier*/
    fclose($fd);} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T15:54:10.697

这是最简单的方法（使用[phpseclib，一个纯 PHP SSH2 实现](http://phpseclib.sourceforge.net/)）：

```
<?php
include('Net/SSH2.php');

$ssh = new Net_SSH2('www.domain.tld');
if (!$ssh->login('username', 'password')) {
    exit('Login Failed');
}

echo $ssh->exec('php script.php');
?> 
```

使用 RSA 私钥：

```
<?php
include('Net/SSH2.php');

$ssh = new Net_SSH2('www.domain.tld');
$key = new Crypt_RSA();
$key->loadKey(file_get_contents('privatekey'));
if (!$ssh->login('username', $key)) {
    exit('Login Failed');
}

echo $ssh->exec('php script.php');
?> 
```

如果 script.php 在标准输入上侦听，您可以执行[read() / write()](http://phpseclib.sourceforge.net/ssh/examples.html#interactive)或使用[enablePTY()](https://github.com/phpseclib/phpseclib/pull/71)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T07:50:43.053

此解决方案有效：

**机器一**

在通过 ssh连接到*机器**二*后，我向机器二发送了一条消息。我使用和*`popen``fwrite`*

 *```
//MACHINE ONE
$message = "Hello Boy";
$action = ('ssh root@machineTwo script.php');  //conection by ssh-rsa
$handle = popen($action, 'w'); //pipe open between machineOne & two

if($handle){
   fwrite($handle, $message); //write in machineTwo
   pclose($handle);
} 
```

**机器二**

我打开一个文件并使用*fgets(STDIN);获取**MACHINE ONE*`fopen`的消息；. 我将消息写入打开的文件中。

 **```
//MACHINETWO
$filename = "test.txt";    
if(!$fd = fopen($filename, "w");
    echo "error";
}

else
{   
    $message = fgets(STDIN);
    fwrite($fd, $message); //text.txt have now Hello World !
    /*we close the file*/
    fclose($fd);    
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T18:10:46.070

Popen 主要用于让两个本地程序使用“管道文件”进行通信。

要实现您想要的，您应该尝试使用 SSH2 PHP 库（一个有趣的链接[http://kvz.io/blog/2007/07/24/make-ssh-connections-with-php/](http://kvz.io/blog/2007/07/24/make-ssh-connections-with-php/)）

在你的情况下，你会在 machineOne 上为你的 php 脚本做类似的事情：

```
if (!function_exists("ssh2_connect")) die("function ssh2_connect doesn't exist");
if (!($con = ssh2_connect("machineTwo", 22))) {
    echo "fail: unable to establish connection\n";
} else {
    if (!ssh2_auth_password($con, "root", "yourpass")) {
        echo "fail: unable to authenticate\n";
    } else {
        echo "okay: logged in...\n";

         if (!($stream = ssh2_exec($con, "php script.php"))) { //execute php script on machineTwo
                echo "fail executing command\n";
            } else {
                // collect returning data from command
                stream_set_blocking($stream, true);
                $data = "";
                while ($buf = fread($stream,4096)) {
                    $data .= $buf;
                }
                fclose($stream);
                echo $data; //text returned by your script.php
            }
    }
} 
```

我认为您有充分的理由这样做，但为什么要使用 PHP 呢？***

# ruby-on-rails - ActiveRecord 的 order 方法对于插入用户输入的字符串是否安全？

> ID：16043673
> 
> 赞同：1
> 
> 时间：2013-04-16T17:47:16.477
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, rails-activerecord, ruby-on-rails-4

我想在 Rails 中做这样的事情：

```
People.order("#{params[:sort]}, first_name, middle_name, last_name") 
```

这安全吗？还是我需要自己解析`params[:sort]`并确保它是一个有效列的列表？我不介意出现数据库错误，但我不能有 SQL 注入的可能性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:09:28.590

你可以这样做：

```
if People.attribute_names.include?(params[:sort].to_s)
  People.order("#{params[:sort]}, first_name, middle_name, last_name")
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:30:48.100

订单默认不安全

看：

*   [rails 3 activerecord order - 什么是正确的sql注入工作？](https://stackoverflow.com/questions/7771103/rails-3-activerecord-order-what-is-the-proper-sql-injection-work-around)
*   [http://railscasts.com/episodes/228-sortable-table-columns](http://railscasts.com/episodes/228-sortable-table-columns)

# html - 从带有非法字符的 XML 描述标签中解析 HTML

> ID：16043674
> 
> 赞同：0
> 
> 时间：2013-04-16T17:47:17.327
> 
> 标签：html, xml, parsing, character, qml

我正在使用 QML XmlListModel 来显示有效的 XML 提要。除了由于 HTML 包含在下面的描述标签中而导致格式关闭。

```
<description>&lt;p&gt;&lt;a href="http://news.yahoo.com/north-korea-issues-military-threats-founders-birthday-000221193.html"&gt;&lt;img src="http://l1.yimg.com/bt/api/res/1.2/aSYzNa8DFZPW0FCALm20Yw--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTg2O3E9ODU7dz0xMzA-/http://media.zenfs.com/en_us/News/Reuters/2013-04-15T141115Z_1_CBRE93E0OEY00_RTROPTP_2_KOREA-NORTH.JPG"
    width="130" height="86" alt="North Korean soldiers, workers and students place flowers before statues of Kim Il-sung and Kim Jong-il at Mansudae in Pyongyang" align="left" title="North Korean soldiers, workers and students place flowers before statues
    of Kim Il-sung and Kim Jong-il at Mansudae in Pyongyang" border="0" /&gt;&lt;/a&gt;By Ju-min Park and Jack Kim SEOUL (Reuters) - North Korea made new threats of military action on Monday as the reclusive nation celebrated the anniversary of its founder&amp;#039;s
    birth, stoking tension on the peninsula with a new &amp;quot;ultimatum&amp;quot; to South Korea in the stand-off over its nuclear program. The latest statement from Pyongyang followed threats of nuclear attacks on the United States, South Korea and Japan,
    after new U.N. sanctions were imposed in response to the North&amp;#039;s latest nuclear test in February. ...&lt;/p&gt;&lt;br clear="all"/&gt;
</description> 
```

我假设由于字符喜欢`<`并且`>`不允许在 XML 中使用，因此 HTML 变成了字符被替换后。

我正在使用下面的模型，除了当描述包含已更改的 HTML 文本时会发生一些问题。

```
XmlListModel {
    id: model
    property string feedUrl: rss.activeFeed
    source: "http://" + feedUrl
    query: "/rss/channel/item"
    property ListModel temp
    property int action
    XmlRole { name: "title"; query: "title/string()" }
    XmlRole { name: "link"; query: "link/string()"}
    XmlRole { name: "description"; query: "description/string()" }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:50:54.780

尝试使用 CDATA 标签包装您的 HTML 和长 URL，XML 将通过这种方式排除非法字符：

```
<description><![CDATA[

&lt;p&gt;&lt;a href="http://news.yahoo.com/north-korea-issues-military-threats-founders-birthday-000221193.html"&gt;&lt;img src="http://l1.yimg.com/bt/api/res/1.2/aSYzNa8DFZPW0FCALm20Yw--/YXBwaWQ9eW5ld3M7Zmk9ZmlsbDtoPTg2O3E9ODU7dz0xMzA-/http://media.zenfs.com/en_us/News/Reuters/2013-04-15T141115Z_1_CBRE93E0OEY00_RTROPTP_2_KOREA-NORTH.JPG"
    width="130" height="86" alt="North Korean soldiers, workers and students place flowers before statues of Kim Il-sung and Kim Jong-il at Mansudae in Pyongyang" align="left" title="North Korean soldiers, workers and students place flowers before statues
    of Kim Il-sung and Kim Jong-il at Mansudae in Pyongyang" border="0" /&gt;&lt;/a&gt;By Ju-min Park and Jack Kim SEOUL (Reuters) - North Korea made new threats of military action on Monday as the reclusive nation celebrated the anniversary of its founder&amp;#039;s
    birth, stoking tension on the peninsula with a new &amp;quot;ultimatum&amp;quot; to South Korea in the stand-off over its nuclear program. The latest statement from Pyongyang followed threats of nuclear attacks on the United States, South Korea and Japan,
    after new U.N. sanctions were imposed in response to the North&amp;#039;s latest nuclear test in February. ...&lt;/p&gt;&lt;br clear="all"/&gt;

]]></description> 
```

# php - PHP 数组返回 null

> ID：16043676
> 
> 赞同：3
> 
> 时间：2013-04-16T17:47:17.943
> 
> 标签：php, ajax, json

我有一个带有 onclick 事件按钮的 html 表单

```
 <form id = "abc" action = "xyz.php" method = "post">
      <input type="button" name="submitButton" value="Submit" 
            id="submitButton" onclick = "Function()">
     </form> 
```

在 JS 代码中，我试图发布一个文本框的值并尝试通过 json_encode 从 PHP 获取数组。

```
var valueToSend = $('#textbox').val();
var imagesReturned = new Array();
$.ajax({
        url: "xyz.php",
        type: "POST",
        data: valueToSend,
        dataType:"json",
        success: function(result) {        
            var data = jQuery.parseJSON(result);
            alert(data);
        }
    }); 
```

这是我的 PHP 代码，

```
 if(isset($_POST['valueToSend'])) 
        {
            $searchValues = explode(' ',$_POST['valueToSend']);
           // Some processing here
            echo (json_encode($responseArray));

        } 
```

当我提醒数据时，我得到空值，我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:50:28.257

问题出在您的 Ajax 请求中，`data`键需要一个键/值对，而不仅仅是一个值。

您正在寻找类似于以下内容的内容：

```
var valueToSend = {
  'valueToSend': $('#textbox').val()
} 
```

此外，您将`dataType`键设置为`json`，因此无需通过 parseJSON 传递数据变量。因此，该`success`函数只需要声明如下：

```
'success': function(result) {
  alert(result);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:50:31.217

```
var valueToSend = $('#textbox').val();
var imagesReturned = new Array();
$.ajax({
        url: "xyz.php",
        type: "POST",
        data: {"valueToSend":valueToSend},
        dataType:"json",
        success: function(result) {        
            var data = jQuery.parseJSON(result);
            alert(data);
        }
    }); 
```

更正`data`ajax的格式

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:50:52.463

你的数据字段在我看来很可疑

```
 $.ajax({
            url: "xyz.php",
            type: "POST",
            data:{valueToSend:valueToSend},
            dataType:"json",
            success: function(result) {        
                alert(result);
            }
        }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T20:25:02.073

问题出在 PHP 代码中。

我删除了检查 if(isset($_POST['valueToSend'])) 及其工作...

# c# - 创建通知图标表单

> ID：16043679
> 
> 赞同：0
> 
> 时间：2013-04-16T17:47:29.523
> 
> 标签：c#, winforms, notifyicon, notification-area

我是 C# 的新手，但我坚持使用它并开始我的第一个适当的程序。该程序由`Notify Icon`存在于通知区域中的一个组成，当单击它时，表单将显示一小段时间。

到目前为止，我已经有了它，所以程序启动了（没有显示表单（这是一个 FixedSingle，所以它只显示为一个灰色框），但是创建了图标），并注册了`MouseClick`事件，但这就是我已经成为的地方卡住。我正在尝试获取它，以便在单击图标时，该框将出现在通知区域上方/旁边（直到发生模糊事件或来自表单上的对象的事件），但在谷歌搜索后半部分一个小时左右，我还没有找到解决方案，可能是因为我不知道正确的词。

那么，有谁知道需要发送哪些命令才能使表单暂时出现在正确的坐标中（相对于通知区域）？

**额外的**

我已修改`static void Main()`为以下内容：

```
Application.EnableVisualStyles();
Application.SetCompatibleTextRenderingDefault(false);
new frmMain();
Application.Run(); 
```

所以`new frmMain()`存在作为它自己的实体，而不是作为一个论点`Application.Run()`

**编辑**

Righto，刚刚发现我可以显示表单，`this.Show()`并且显示表单，而相反的`this.Hide()`会隐藏它。但我仍然无法确定通知区域的坐标，以及如何计算表单的新坐标以使其旁边/上方显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:10:24.867

您可以使用：

1.  [Screen.PrimaryScreen](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.primaryscreen.aspx)
2.  [屏幕.工作区](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.workingarea.aspx)

* * *

```
System.Drawing.Rectangle workingRectangle = Screen.PrimaryScreen.WorkingArea;
this.Left = workingRectangle.Width - this.Width;
this.Top = workingRectangle.Height - this.Height;
this.Show(); 
```

每当单击通知图标时，都需要调用上述代码。

# android - Jsoup空指针异常

> ID：16043685
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:47:57.013
> 
> 标签：android, jsoup

**错误日志：**

```
04-16 23:05:29.133: W/dalvikvm(7474): threadid=1: thread exiting with uncaught exception (group=0x41550930)
04-16 23:05:29.133: E/AndroidRuntime(7474): FATAL EXCEPTION: main
04-16 23:05:29.133: E/AndroidRuntime(7474): java.lang.NullPointerException
04-16 23:05:29.133: E/AndroidRuntime(7474):     at com.example.yo.MainActivity$jsoupexample.onPostExecute(MainActivity.java:74)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at com.example.yo.MainActivity$jsoupexample.onPostExecute(MainActivity.java:1)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at android.os.AsyncTask.finish(AsyncTask.java:631)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at android.os.AsyncTask.access$600(AsyncTask.java:177)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at android.os.Looper.loop(Looper.java:137)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at java.lang.reflect.Method.invokeNative(Native Method)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at java.lang.reflect.Method.invoke(Method.java:511)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-16 23:05:29.133: E/AndroidRuntime(7474):     at dalvik.system.NativeStart.main(Native Method)
04-16 23:05:29.163: D/dalvikvm(7474): GC_CONCURRENT freed 557K, 9% free 8027K/8736K, paused 2ms+4ms, total 28ms 
```

**代码**

```
@TargetApi(Build.VERSION_CODES.GINGERBREAD)
public class MainActivity extends Activity {

    Document doc;
    TextView tv;
    String res="";
    String BLOG_URL = "http://www.google.co.in/";

    @Override
    public void onCreate(Bundle savedInstanceState) {
        // set layout view
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        new jsoupexample().execute(BLOG_URL);
    }
    public class jsoupexample extends AsyncTask<String,Integer,String>
    {
        @Override
        protected String doInBackground(String... BLOG_URL) {
            try {
                doc= Jsoup.connect(BLOG_URL[0]).userAgent("Mozilla/5.0").timeout(20000).get();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            Elements links = doc.select("a[href]");
            for(Element element: links)
            { 
                res = element.attr("href");
            }
            return res;
        }
        @Override
        protected void onPostExecute(String result) {
            // TODO Auto-generated method stub
            super.onPostExecute(result);

            if(result!=null && !result.isEmpty())
            tv.setText(result);
            else
            tv.setText("no value returned");
        }
    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:55:45.643

`tv`一片空白。初始化它`onCreate`：

```
tv = (TextView)findViewById(R.id.<the-id>); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T17:56:16.993

在您的`onPstExecute()`方法中，您有这一行： tv.setText(result);

你从来没有实例化`tv`，因此它是空的。当您尝试在 null 上调用方法时，您会收到 NullPointerException。

# jquery - jQuery "empty:"-selector 是如何工作的？（删除空标签）

> ID：16043693
> 
> 赞同：3
> 
> 时间：2013-04-16T17:48:33.670
> 
> 标签：jquery, regex, jquery-selectors, is-empty

我正在尝试从 DOM 树中删除所有空标签。空意味着完全空（如`<a></a>`）和几个空格（如`<a> ...</a>`）。还应删除内部空标签。例如

```
<p style="text-align:right;">     <a> </a>  <a></a></p><p>Hello</p> 
```

应该离开

```
<p>Hello</p> 
```

因为在删除空之后`<a> </a> <a></a>`，空的`<p style="text-align:right;"> </p>`仍然会保留并且应该被删除。

**我在做什么：**

```
$.(".container>*:empty").remove(); 
```

结果令人困惑。我已经开始使用这样的代码进行调试：

```
console.log($.(".container>*:empty").size()); 
```

1）字符串：

```
Well, though it looks like a paragraph, it's not o_O.
0 (I'm wrapping string in global wrapper .container) 
```

2) 字符串

```
<a></a><a>Well, though it looks like a paragraph, it's not o_O.</a>
1 
```

3) 字符串

```
<a> </a><a>Well, though it looks like a paragraph, it's not o_O.</a>
0 (It seems one whitespace makes a non-empty) 
```

4) 字符串

```
<p> <a></a></p>  <a>Well, though it looks like a paragraph, it's not o_O.</a>
0 (<a></a> is not selected as empty (maybe 'cause it's inside of < p>). 
   Also p is not selected, besides it contains only empty < a>) 
```

**我的问题是：**

*   如何同时`:empty`选择空标签和 1-N 个空格？
*   如何`:empty`选择每个对象内的所有空标签？

我的想法是做`${"*:empty"}.remove() while $('*:empty').size() > 0`。

**更新：**

```
do {
$(".container *").filter(function() {
    return $.trim(this.innerHTML) === ""
}).remove();
} while ($(".container *").filter(function() {
return $.trim(this.innerHTML) === ""
}).size() > 0)
console.log($(".container").html()) 
```

将此代码应用于：

```
<p> <p> <a> <a>  <a><br><hr></a> </p>  <a>Well, though it looks like a paragraph, it's not o_O.</a></p> 
```

我们得到：

```
<p>   <a>Well, though it looks like a paragraph, it's not o_O.</a></p> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T17:52:22.627

你应该看看[filter()](http://api.jquery.com/filter/)和[trim()](http://api.jquery.com/jQuery.trim/)：

[演示](http://jsfiddle.net/pZub2/)

```
$(".container *")
    .filter(function(){
         return $(this).is(':not(br)') 
                && $(this).is(':not(img)') 
                && $.trim(this.innerHTML) === ""
     }).remove(); 
```

# c# - 断开连接时自动重新连接

> ID：16043695
> 
> 赞同：0
> 
> 时间：2013-04-16T17:48:38.513
> 
> 标签：c#, .net, ibm-mq

当连接失败时，我们有一个自动连接的请求（这样消息就不会丢失/它的相关 ID 也不会丢失）。

通过连接到 IBM 6.x 远程 MQ 服务器的 IBM MQ 7x 客户端自动重新连接到消息/MQ 管理器（没有升级 7x MQ 服务器的选项）。

我试着做

> 如果 Manager 断开连接，则停止并重新连接

但这会不断丢失相关 ID 的值。

我正在使用 MQ.NET 类。另外，当出现连接故障时，请告知是否可以手动重新连接？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T14:47:43.990

为 MQ 应用程序创建重新连接逻辑相当简单。我喜欢有一个控制器类和一个工作类来处理重新连接逻辑。查看 Universal File Mover (UFM)，[http://www.capitalware.biz/ufm_overview.html](http://www.capitalware.biz/ufm_overview.html)，尤其是 MQReceive Action。是的，UFM 是用 Java 编写的，但 Java/MQ 代码和 C#/MQ 代码之间也没有区别。UFM 是一个开源项目，源代码可供下载。

特别是查看 MQReceiveAction.java 和 MQGetMsg.java 类。MQReceiveAction.java 是控制器类，MQGetMsg.java 是工作者类。MQReceiveAction 通过 MQGetMsg 类连接到队列管理器。当发生 MQException 时，MQReceiveAction 通过 MQGetMsg 与队列管理器断开连接并休眠 1 分钟，然后尝试重新连接到队列管理器。

> 但这会不断丢失相关 ID 的值。

好吧，您是否将其保存在不会被丢弃/清理的班级中？在我的示例中，如果我需要临时保存 CorrelID，我只需让 MQReceiveAction 从工作类中检索它，当 MQReceiveAction 成功重新连接时，将 CorrelID 推送到新的工作类中。

最好从 10,000 英尺的高度观察问题，并将其阻塞的组件分开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T05:23:31.260

将所有 MQ 方法调用放在 try/catch 块和 catch 块中总是好的，确定异常是否是连接错误，然后重新连接并重新打开之前打开的所有 MQ 对象。例如：

```
 public static void GetQueueName()
    {
        Hashtable mqProps = new Hashtable();
        MQQueueManager qm = null;
        String strCorrelId = "00123456789";
        MQQueue importQ = null;

        Reconnect:
        try
        {
            mqProps.Add(MQC.TRANSPORT_PROPERTY, MQC.TRANSPORT_MQSERIES_MANAGED);
            mqProps.Add(MQC.CHANNEL_PROPERTY, "NET.CHL");
            mqProps.Add(MQC.HOST_NAME_PROPERTY, "localhost");
            mqProps.Add(MQC.PORT_PROPERTY, 2099);

            qm = new MQQueueManager("QM1", mqProps);
        }
        catch (MQException mqex)
        {
            // Handle any exception appropriately
        }

        try
        {
            importQ = qm.AccessQueue("Q1", MQC.MQOO_INPUT_SHARED | MQC.MQOO_OUTPUT | MQC.MQOO_FAIL_IF_QUIESCING);

            MQMessage mqPutMsg = new MQMessage();
            mqPutMsg.WriteString("This is an import message");
            mqPutMsg.CorrelationId = System.Text.Encoding.UTF8.GetBytes(strCorrelId);
            MQPutMessageOptions mqpmo = new MQPutMessageOptions();
            mqpmo.Options = MQC.MQPMO_NEW_CORREL_ID;
            importQ.Put(mqPutMsg,mqpmo);

            MQMessage respMsg = new MQMessage();
            MQGetMessageOptions gmo = new MQGetMessageOptions();
            gmo.WaitInterval = 3000;
            gmo.Options = MQC.MQGMO_WAIT;

                importQ.Get(respMsg, gmo);
            }
            catch (MQException ex)
            {
                switch(ex.ReasonCode)
                {
                    case MQC.MQRC_CONNECTION_BROKEN:
                    case MQC.MQRC_CONNECTION_ERROR:
                    case MQC.MQRC_CONNECTION_QUIESCING:
                        {
                            try
                            {
                                importQ.Close();
                                qm.Disconnect();
                            }
                            catch (Exception ex1)
                            {
                                // Ignore any exception
                            }
                            goto Reconnect;
                        }
                }
            }
            importQ.Close();                
            qm.Disconnect();
    } 
```

# php - 3 列 CSS 中的 Foreach 查询

> ID：16043697
> 
> 赞同：0
> 
> 时间：2013-04-16T17:48:43.340
> 
> 标签：php, html, mysql, css

您好，我想就在 3 列中显示以下查询寻求帮助。我想我需要阅读数组，因为我似乎无法得到任何工作。我的这段代码是否可行，或者我需要在得到我想要的结果之前重写它吗？

```
<?php foreach ($this->items as $item) :?>
<?php if($item->state == 1 || ($item->state == 0 && JFactory::getUser()->authorise('core.edit.own',' com_bryllup'))):$show = true;?>
<input type="checkbox" name="<?php echo $item->felt_titel; ?>" value="<?php echo $item->felt_titel; ?>">
<h3><?php echo $item->felt_titel; ?></h3>
<p><?php echo $iyem->felt_beskrivelse; ?></p>
<?php endif; ?> 
```

我想要实现的是这样的：

```
-Result1------Result2------Result3-
-Result4------Result5------Result6-
-etc-----------etc-----------etc--- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:04:03.867

好吧，既然你已经添加了你喜欢的图表，那就更容易了。你可以用你现有的循环来做

CSS

```
// set width to a third of the width of the containing div
div.result {
    width:250px;
    height:300px;
    float:left;
} 
```

HTML

```
<?php foreach ($this->items as $item) :?>
<?php if($item->state == 1 || ($item->state == 0 && JFactory::getUser()->authorise('core.edit.own',' com_bryllup'))):$show = true;?>
<input type="checkbox" name="<?php echo $item->felt_titel; ?>" value="<?php echo $item->felt_titel; ?>">

<div class="result">
    <h3><?php echo $item->felt_titel; ?></h3>
    <p><?php echo $iyem->felt_beskrivelse; ?></p>
</div>

<?php endif; ?> 
```

# python - 正则表达式在字符串中查找字母数字模式

> ID：16043699
> 
> 赞同：2
> 
> 时间：2013-04-16T17:48:49.733
> 
> 标签：python, regex

我有正则表达式可以在字符串中找到长度为 6 的字母数字。字符串如下所示：

```
PLT\n\nTRAVELLER NAME LIST\n\n     TRAVELLER              RECLOC COMPANY\n   1          TESTNUMBERFIVEQA/TESTN WL9795\n   2 TESTNUMBERONEYQWA/TEST RHFQCD\n   3 TESTNUMBERONEYQWAZZZ/T 1QZ1JF\n   4 TESTNUMBERONEYQWAZZZM/ N3BZW8\n   5 TESTNUMBERONEYQWAZZZMK 05RXPM\n   6 TESTNUMBERONEYQWAZZZMK 2XR9ZR\n   7 TESTNUMBERTHREEZZZ/TES 0Q14S4\n   8 TESTNUMBERTHREEZZZM/TE LRRKW3\n   9 TESTNUMBERTHREEZZZMK/T 949Z4T\n  10 TESTNUMBERTHREEZZZMKJ/ 51WFM2\n  11 TESTNUMBERTWOZZA/TESTN PRGWVT\n  12 TESTNUMBERTWOZZAZZZ/TE SM0BHS\n  13 TESTNUMBERTWOZZAZZZM/T QRJLH1\n  14 TESTNUMBERTWOZZAZZZMK/ R69NHV\n  15 TESTNUMBERTWOZZAZZZMKJ 67XKF7\n  16 TESTNUMBERTWOZZAZZZMKJ 68PV7P\n  17 TESTNUMBERTWOZZAZZZMKJ GCZZ0C\n)>  18 TESTNUMBERTWOZZAZZZMKJ MLMS3L\n  19 TESTNUMBERTWOZZAZZZMKJ 3R1S49\n  20 TESTNUMBERTWOZZAZZZMKJ WB700R\n  21 TESTNUMBERTWOZZAZZZMKJ 718KRC\n  22 TESTNUMBERTWOZZAZZZMKJ RTQH2H\n  23 TESTNUMBERTWOZZAZZZMKJ N2FLM6\n  24 TESTNUMBERTWOZZAZZZMKJ 40M1FR\n  25 TESTNUMBERTWOZZAZZZMKJ 71D3HF\n  26 
```

我尝试过的正则表达式是这样的：

```
for k in mainString:
    m = re.match('([0-9A-Z]{6})', k)
    if (m):
        do something 
```

但它没有按预期工作。有人能指出我可能在哪里犯错吗？我正在寻找的模式就像 WL9795、RHFQCD 等。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T17:51:46.337

该`match`方法仅检查字符串开头的匹配项。

改用这个`search`方法！

此外，这些`()`都是不必要的。

如果`mainString`在您的代码中实际上是问题顶部的字符串，那么您的代码将无法正常工作，因为`for`循环将遍历该字符串中的所有单个字符。

相反，您可以使用

```
m = re.search(r'\b[0-9A-Z]{6}\b', mainString)
if (m):
    print(m.group()) 
```

正`r`则表达式之前的 确保`\b`不被视为字符串转义序列。

`\b`平均单词边界并确保 6 个字母数字字符的前面或后面没有单词字符。没有他们，第一场比赛将是`"TRAVEL"`in `"TRAVELLER"`。

如果您想获取所有匹配项的列表，请使用`findall`or`finditer`而不是`search`.

```
for m in re.finditer(r'\b[0-9A-Z]{6}\b', mainString):
    print(m.group()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T17:56:57.880

在我看来，您可能需要一些单词边界：

```
>>> print re.findall(r'\b\w{6}\b',s)
['RECLOC', 'WL9795', 'RHFQCD', '1QZ1JF', 'N3BZW8', '05RXPM', '2XR9ZR', '0Q14S4', 'LRRKW3', '949Z4T', '51WFM2', 'PRGWVT', 'SM0BHS', 'QRJLH1', 'R69NHV', '67XKF7', '68PV7P', 'GCZZ0C', 'MLMS3L', '3R1S49', 'WB700R', '718KRC', 'RTQH2H', 'N2FLM6', '40M1FR', '71D3HF'] 
```

此正则表达式匹配完全是字符长度的字母数字模式。换句话说，它不匹配任何东西，`"foobarbaz"`但它会匹配`foobar`from`"foobar."`

# ruby-on-rails - Rails link_to :format => :xlsx 未生成指向 .xlsx 路径的链接

> ID：16043702
> 
> 赞同：24
> 
> 时间：2013-04-16T17:48:53.560
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

如果我点击这个网址：`http://localhost:3000/reports/action.xlsx`它会显示一个生成的 xlsx 文件。

如果我有`link_to`这样的：

```
<%= link_to 'Export to Excel', reports_affirmative_action_path, :format => :xlsx %> 
```

它会生成一个指向此页面的链接： `http://localhost:3000/reports/action`

为什么我的 link_to`:format => :xlsx`没有链接到正确的路径？

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-16T18:43:11.103

你的`link_to`和`path`稍有偏差。你要

```
<%= link_to('Export to Excel', reports_affirmative_action_path(format: :xlsx)) %> 
```

其中格式是`path`助手的参数，而不是`link_to`.

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2015-10-29T14:37:21.903

**为我工作**
<%= link_to('Export to Excel', reports_affirmative_action_path(:format => :xls)) %>

**使用 :xls 而不是 :xlsx**

# c++ - 数组中不同数量的字符串

> ID：16043703
> 
> 赞同：2
> 
> 时间：2013-04-16T17:48:59.040
> 
> 标签：c++, arrays, count, distinct

**更新修复**

我只想返回数组中唯一条目的数量。该数组包含一个表示 IP 地址的字符串变量。如果有 10 个，但有 3 种不同的类型，我只想返回 3 个。我整天都在做这个，似乎无法找到一个可行的解决方案。我的代码：

**原始代码**

```
int getUnique(Visitors info[], string url, string startDate, string endDate){

int count = 0;

string temp;

for(int i = 0 ; i < N ; i++){

    if(url == info[i].URL && (dateChecker(startDate, endDate, info[i].dateAccessed))){

    }

}

return count;

} 
```

**更新代码**

```
int getUnique(Visitors info[], string url, string startDate, string endDate){

set<string> ips;

for(int i = 0 ; i < N ; i++){

    if(url == info[i].URL && (dateChecker(startDate, endDate, info[i].dateAccessed))){

       ips.insert(info[i].IP);

    }

}

return ips.size();

} 
```

第一个 if 检查匹配的 URL 是否确实匹配，并且`dateChecker`只是确保特定 IP 转到该 URL 的日期在 2 个传递的日期（`startDate`和`endDate`）之间。在这些条件下，我如何获得不同 IP 的数量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:53:35.710

使用[`std::set`](http://en.cppreference.com/w/cpp/container/set)，它唯一地存储项目并且它是有效的：

```
std::set<string> ips;

for (int i=0; i<N; i++)
  ips.insert(info[i].IP);

int unique_ips = ips.size(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:52:55.713

你可以用 set 懒惰地做到这一点

```
std::set<string> uniq;
if(url == info[i].URL && (dateChecker(startDate, endDate, info[i].dateAccessed))){
        uniq.insert(info[i].URL);
}

return uniq.size(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:59:19.813

如前所述，您需要使用 std::set 但是不需要手动迭代数组，因为 std::map 接受迭代器来构造它的范围。因此

```
std::map<std::string> unique(strinvec.begin(), stringvec.end()); 
```

应该做的伎俩。
如果您只需要知道唯一元素的数量，您可以使用更短的符号。

```
size_t unique_count = std::map<std::string>(strinvec.begin(), stringvec.end()).size(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-16T17:51:58.513

您可以使用 a[`std::set`](http://en.cppreference.com/w/cpp/container/set)来跟踪唯一`string`的 s：

```
std::set<std::string> mySet ; 
```

对于每次迭代，只需执行以下操作：

```
mySet.insert( info[i].IP) ; 
```

最后：

```
return mySet.size() ; 
```

# php - 如何按一个子数组值对数组子数组进行排序？(PHP)

> ID：16043707
> 
> 赞同：0
> 
> 时间：2013-04-16T17:49:20.817
> 
> 标签：php, arrays, sorting

我有一个这样的数组：

```
array(
    'sortBy' => array(0 => 3,   1 => 2,   2 => 1),
    'other'  => array(0 => 'x', 1 => 'y', 2 => 'z'),
    'xxx'    => array(0 => 3,   1 => 2,   2 => 1),
    ...
) 
```

如何按*sortBy*中的值对*其他*子数组的内容进行排序？一个数组中有无限数量的*其他*子数组，但是这些子数组中的键总是相同的（例如在*sortBy*，*other*，*xxx*中，键 0 的值必须全部排序在一起）

 ***排序后的数组如下所示：

```
array(
    'sortBy' => array(0 => 1,   1 => 2,   2 => 3),
    'other'  => array(0 => 'z', 1 => 'y', 2 => 'x'),
    'xxx'    => array(0 => 1,   1 => 2,   3 => 3)
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:57:34.540

你可以使用[`array_multisort()`](http://php.net/array_multisort)效果很好。

```
$array = array(
    'sortBy' => array(3,   2,   1),
    'other'  => array('x', 'y', 'z'),
    'xxx'    => array(3,   2,   1),
);

array_multisort($array['sortBy'], SORT_NUMERIC, $array['other'], $array['xxx']);

var_export($array); 
```

上面的示例打印以下内容：

```
array (
  'sortBy' => 
  array (
    0 => 1,
    1 => 2,
    2 => 3,
  ),
  'other' => 
  array (
    0 => 'z',
    1 => 'y',
    2 => 'x',
  ),
  'xxx' => 
  array (
    0 => 1,
    1 => 2,
    2 => 3,
  ),
) 
```

**编辑**

由于您决定数组的键可以是任何东西（除了一个明确的键: `sortBy`），`array_multisort()`因此仍然可以使用，尽管使用更动态的参数列表调用。

```
$array = array( … );

$args = array(&$array['sortBy'], SORT_NUMERIC);
foreach ($array as $key => $value) {
    if ($key !== 'sortBy') {
        $args[] = &$array[$key];
    }
}
call_user_func_array('array_multisort', $args);
unset($args);

var_export($array); 
```***

# c - 创建一个排序的链表

> ID：16043709
> 
> 赞同：2
> 
> 时间：2013-04-16T17:49:23.773
> 
> 标签：c, linked-list

将近 3 年之后，我开始重新学习`C`.

我创建了一个`Linked list`, 并希望将其扩展为创建一个排序的链表。这是我的代码：

```
typedef struct node{
int data;
struct node *ptr;
}node;

node* insert(node* head, int num){
node *temp,*prev,*next;
temp = (node*)malloc(sizeof(node));
temp->data = num;
temp->ptr = '\0';
if(head=='\0'){
    head=temp;
}else{
    next = head;
    prev = next;
    while(next->data<=num){
        prev = next;
        next = next->ptr;
    }
    if(next==NULL){
        prev->ptr = temp;
    }else{
        temp->ptr = prev->ptr;
        prev-> ptr = temp;
    }

}
return head;
}

void main(){
int num;
node *head, *p;
head = '\0';
do{
    printf("Enter a number");
    scanf("%d",&num);
    if(num!=0)
        head = insert(head,num);
}while(num!=0);
p = head;
printf("\nThe numbers are:\n");
while(p!='\0'){
    printf("%d ",p->data);
    p = p->ptr;
}
} 
```

这是我的想法。我遍历列表，直到找到`>=`输入的数字。我将前一个节点存储在其中`prev`，`next`节点包含当前值。如果 next 是`null`，则列表结束并且列表中的数字是最高的，因此将其插入到最后一个位置，如果数字在中间的某个位置，则上一个节点的地址部分存储在临时节点地址中现在部分临时节点指针保存下一个节点的地址。

**编辑：**我的代码的问题是，如果我输入 1,2，我会收到错误消息`a.exe has stopped working`。我正在使用 MinGW 进行编译。当用户输入 0 时，我正在打破循环。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T18:10:02.453

你必须换行

```
while(next->data<=num) 
```

至

```
while(next!='\0' && next->data<=num) 
```

当您插入第二个元素时，`next`将`'\0'`在第二次迭代中尝试获取该字段`data`将`next->data`导致分段错误。

随着 while 条件的改变 if`next!='\0'`将是假`next=='\0'`的（因此 ） while 被中止并且因为`&&`'s 的短路`next->data`不会被计算。

* * *

编辑

您的代码中有更多问题。

如果您查看输入，`2 1 0`那么具有正确工作程序的输出应该是`1 2`，但它是`2 1`相反的。问题在于，在您的`insert`函数中，您没有考虑插入当前最小元素将成为新头部的情况。

另一个问题是你最后没有释放`malloc`ed 内存，这会导致内存泄漏。

我更改了您的代码以使其行为正确：

```
#include <stdio.h>
#include <stdlib.h>

typedef struct node{
    int data;
    struct node *ptr;
} node;

node* insert(node* head, int num) {
    node *temp, *prev, *next;
    temp = (node*)malloc(sizeof(node));
    temp->data = num;
    temp->ptr = NULL;
    if(!head){
        head=temp;
    } else{
        prev = NULL;
        next = head;
        while(next && next->data<=num){
            prev = next;
            next = next->ptr;
        }
        if(!next){
            prev->ptr = temp;
        } else{
            if(prev) {
                temp->ptr = prev->ptr;
                prev-> ptr = temp;
            } else {
                temp->ptr = head;
                head = temp;
            }            
        }   
    }
    return head;
}

void free_list(node *head) {
    node *prev = head;
    node *cur = head;
    while(cur) {
        prev = cur;
        cur = prev->ptr;
        free(prev);
    }       
}

int main(){
    int num;
    node *head, *p;
    head = NULL;
    do {
        printf("Enter a number");
        scanf("%d",&num);
        if(num) {
            head = insert(head, num);
        }
    } while(num);
    p = head;
    printf("\nThe numbers are:\n");
    while(p) {
        printf("%d ", p->data);
        p = p->ptr;
    }
    free_list(head);
    return 0;
} 
```

请参阅[https://ideone.com/wT5iQ8](https://ideone.com/wT5iQ8)，了解我在测试输入上的代码以及正确的输出。

# php - PHP：在 1 个 php 页面中包含所有重要代码或仅在需要它的页面上包含它

> ID：16043717
> 
> 赞同：1
> 
> 时间：2013-04-16T17:49:40.527
> 
> 标签：php, mysql, security

我要开始做一个开源论坛，我有以下问题：

我应该在一个 php 页面中包含我需要在每个页面上一次的所有重要代码还是在每个页面上都有它。

即：连接到 MySQL 数据库的代码，另一个在执行查询之前保护输入的代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:52:45.387

我个人更喜欢尽可能模块化地做事情。这样，当你需要在几年后改变某些东西时，你不必在 100 个地方改变它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:54:00.447

如果您使用的是过程代码，则应按上下文对函数进行分组。例如变成：`database.php`, `input.php`...

如果您使用类，您应该在一个文件中只有一个类并包含它。使用类，您还可以使用该[`spl_autoload_register`](http://php.net/manual/en/function.spl-autoload-register.php)函数仅在需要时自动加载类。

如果你有你知道你总是需要的通用代码，你应该创建一个[前端控制器](http://en.wikipedia.org/wiki/Front_Controller_pattern)并只在其中包含它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:53:28.897

您应该研究提供工具以实现更好的代码重用、引导等的各种框架。例如，Symfony、Zend Framework、Yii 等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T17:55:58.690

当然，您应该将重复块放在一个文件中，然后将其包含在内。通常它`connect.php`, `functions.php`, `header.php`,`menu.php`和`footer.php`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T17:56:17.997

我相信编程语言中的命名法为您提供了如何构建代码的良好起点。

```
function -> does (only) 1 thing, and that good.
class    -> collection of functions that belong together 
```

至于“all in 1 page”部分..您应该**只**让解析器读取完成当前任务**所需的代码。**如果一个“页面”应该做不止一件事，你应该只`require()`在需要时使用你需要的类/功能。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-16T18:04:11.343

其实没关系，按照自己喜欢的方式去做。在其他答案中给出的原因和很好的例子中，如果您有很多文件，可能您不需要在每个请求上加载所有文件。

将所有内容放在一个文件中可确保在迁移或分发它时，您需要移动或复制单个文件。

如果我没记错的话，RedBeans 只是一个文件，而 Prado 有很多文件。

# ipad - jQuery Mobile 响应式面板和文本区域

> ID：16043718
> 
> 赞同：5
> 
> 时间：2013-04-16T17:49:41.697
> 
> 标签：ipad, textarea, panel, jquery-mobile

我有 jQuery Mobile 应用程序[http://gudulin.ru/test/problem.html](http://gudulin.ru/test/problem.html)。

页面加载后左侧面板打开： `$('#my-panel').panel("open");`

我在我的页面和@media css 内容中添加了一个类`ui-responsive-panel`，因此我可以一起使用面板和页面内容。

笔记本电脑浏览器上一切正常，但 iPad 浏览器（Safari 或其他）出现问题。当左面板打开并且我开始在文本区域中输入文本时，在输入任何符号后会跳转一个页面。当您开始在 textarea 底部输入时（当文本从键盘输入时），问题就出现了。

如果您没有明白我的意思，请观看视频：[http](http://www.youtube.com/watch?v=Q6_kM_FshrQ) ://www.youtube.com/watch?v=Q6_kM_FshrQ 。

如何重现：

1.  用 iPad打开[http://gudulin.ru/test/problem.html](http://gudulin.ru/test/problem.html)
2.  检查左侧面板是否打开
3.  将任何内容写入文本区域，然后按几次 Enter 按钮。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T11:34:05.660

我在 jQuery Mobile 论坛[http://forum.jquery.com/topic/jquery-mobile-responsive-panel-and-textarea](http://forum.jquery.com/topic/jquery-mobile-responsive-panel-and-textarea)上粘贴了相同的问题，并从[ishmaelaz](http://forum.jquery.com/user/ishmaelaz)得到了答案，所以我把它留在这里关闭这个问题。

> 几个月来，我一直在用类似的响应式面板布局来解决同样的问题，尽管使用的是文本字段。我上周找到了原因，但还没有时间组装一个问题的演示。
> 
> 要解决此问题，请编辑 jquery.mobile 并查找`_bindFixListener`：（它是 1.3.0 中的第 8149 行）。在此例程中，注释掉`throttledresize`处理程序。一旦你这样做了，跳跃就会停止。
> 
> 据我所知，这里的问题是 iOS 在您键入输入文本字段时发送调整大小事件。这导致此处理程序触发，它调用 _positionPanel。_positionPanel 试图确保面板是可见的，大概是因为此逻辑针对的是非响应式场景，在这种情况下，面板确实应该始终可见以便有用，但在响应式场景中，它只会导致不断的跳跃。
> 
> 可见的键盘似乎是计算出错的关键部分，因为我发现如果你在页面底部添加一个高 div 以使其更长，那么这个逻辑不会触发，似乎是因为页面底部不在键盘“下方”。不过，我还没有对此进行过测试，因为一旦我找到了一种使跳跃停止的方法，我就很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-26T05:33:57.267

[由于虚拟键盘](https://stackoverflow.com/questions/12879857/window-resize-due-to-virtual-keyboard-causes-issues-with-jquery-mobile)使用此window.resize 会导致 jquery mobile 出现问题

```
it will be great solution.
1) Go into jquery.mobile-1.x.x.js

2) Find $.mobile = $.extend() and add the following attributes:

last_width: null,
last_height: null,
3) Modify getScreenHeight to work as follows:

getScreenHeight: function() {
    // Native innerHeight returns more accurate value for this across platforms,
    // jQuery version is here as a normalized fallback for platforms like Symbian

    if (this.last_width == null || this.last_height == null || this.last_width != $( window ).width())
    {
        this.last_height = window.innerHeight || $( window ).height();
        this.last_width = $(window).width();
    }
    return this.last_height;
} 
```

# c++ - 为什么 C++11 CAS 操作需要两个指针参数？

> ID：16043723
> 
> 赞同：14
> 
> 时间：2013-04-16T17:50:00.720
> 
> 标签：c++, c++11, compare-and-swap

许多 C++11 CAS 操作（例如 , `atomic_compare_exchange_weak`）`atomic_compare_exchange_strong`采用两个指针和一个值，即像这样：

```
bool atomic_compare_exchange(T* pointer, T* expected,       // pseudodeclaration!
                             T desired); 
```

相比之下，来自 Microsoft、gcc 和 Intel 的 CAS 操作都采用一个指针和两个值：

```
long InterlockedCompareExchange(long* pointer, long desired,       // Microsoft
                                long expected);

int __sync_bool_compare_and_swap (T* pointer, T expected,          // gcc and
                                  T desired);                      // Intel 
```

为什么 C++11 CAS 函数采用两个指针和一个值，而不是看起来更传统的一个指针和两个值？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-16T17:57:04.460

C++11 方式更有用：如果交换失败，则`*expected`更新*为*新的当前值。这使得在循环中使用函数变得容易：

```
T value = x.load();
T newvalue = frob(value);

while (!atomic_compare_exchange(&x, &value, newvalue))
{
    newvalue = frob(value);
} 
```

有了微软的签名，测试是否操作成功就比较麻烦了，GCC的`__sync_type`版本也是如此。使用 GCC `__sync_bool`，您甚至需要在每次交换失败时执行另一个加载。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-21T20:59:54.363

我不明白为什么你不会同时拥有两者。在我的用例中，C++ 版本不太有用。我想等到一个变量有某个值然后我想将它设置为一个新值。

使用 GCC 内在函数：

```
while (!__sync_bool_compare_and_swap(&value, expected, desired)) { } 
```

使用 C++11：

```
auto tmp = expected;
while (!value.compare_exchange_weak(tmp,desired)) 
{
  tmp = expected;
} 
```

# asp.net - ASP.NET CalendarExtender 在 IE/Firefox 中工作，但在 chrome 中加载时间很长

> ID：16043724
> 
> 赞同：1
> 
> 时间：2013-04-16T17:50:05.387
> 
> 标签：asp.net, google-chrome, webforms, calendarextender

我在 ASP.NET WebForms 应用程序上使用 ajax calendarextender。

选择与 calendarextender 链接的文本框在 IE 和 Firefox 中工作正常，但在 chrome 中，日历显示之前有很长的延迟。

有谁知道是什么原因造成的？

更多信息

从服务器端导航到页面时会出现此问题（尝试了 server.transfer 和 response.redirect），但当直接从菜单导航到页面时不会出现此问题。同样，一切都适用于 IE/FF，但不适用于 chrome。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-17T15:33:44.153

我今天在最新版本的谷歌浏览器（26.0）中也注意到了这个问题。

我已经在 Chrome 已知问题中搜索了类似问题，但没有出现任何问题，几乎你的问题就是我发现的......我还注意到，在演示站点上，colorpickerextender 示例在 chrome (26.0) 中运行良好，但不是在我的。

不过，我最终在生产/开发环境中都解决了这个问题。

我的问题是我在 tabcontrol 中有 colorpicker 控件，该 tabcontainer 具有`AutoPostBack="true"`. 我必须在 tabcontainer 上将 autopostback 设置为 false 才能解决此问题，尽管它需要我稍微更改逻辑并预加载选项卡。

您的控件是否有可能是控件的子级`AutoPostBack="true"`？也许是ajax控件的孩子？

编辑：我还通过服务器端导航到包含颜色选择器的页面。

# c++ - sqlite3_bind_text SQLITE_STATIC 与 SQLITE_TRANSIENT 用于 c++ 字符串

> ID：16043734
> 
> 赞同：5
> 
> 时间：2013-04-16T17:51:00.417
> 
> 标签：c++, sqlite

我有一个返回 c++ std::string 的方法，然后在将其传递给 sqlite3_bind_text 之前将其转换为 c_str()。我的问题是，这应该使用 SQLITE_STATIC 还是 SQLITE_TRANSIENT？

```
sqlite3_bind_text(insertStatement, 0, suspect->GetIpString().c_str(), -1, SQLITE_STATIC);
// Do some stuff in same function then sqlite3_step 
```

sqlite3_bind_text 的文档说，

> sqlite3_bind_blob()、sqlite3_bind_text() 和 sqlite3_bind_text16() 的第五个参数是一个析构函数，用于在 SQLite 完成后处理 BLOB 或字符串。即使对 sqlite3_bind_blob()、sqlite3_bind_text() 或 sqlite3_bind_text16() 的调用失败，也会调用析构函数来处理 BLOB 或字符串。如果第五个参数是特殊值 SQLITE_STATIC，则 SQLite 假定信息位于静态、非托管空间中，不需要释放。如果第五个参数的值为 SQLITE_TRANSIENT，则 SQLite 在 sqlite3_bind_*() 例程返回之前立即制作自己的数据私有副本。

GetIpString 返回一个 std::string，但如果我没有明确地复制它，该字符串会在调用后继续存在吗？另外，在一般情况下使用没有 SQLITE_TRANSIANT 的 .c_str() 是否安全？我知道 SQLITE_TRANSIENT 将是安全的选择，但如果不需要它，我想避免复制/性能损失，因为此查询将大量运行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T18:26:48.197

在您的情况下，返回的字符串对象`GetIpString()`可能会在查询执行和完成之前被破坏，因此您应该`SQLITE_TRANSIENT`.

一般来说，您不应该为临时副本而烦恼，除非您有实际的性能问题，您认为这是由它引起的。

# deployment - 使用 capistrano 部署 Ruby on Rails 会引发 ssh 错误

> ID：16043740
> 
> 赞同：0
> 
> 时间：2013-04-16T17:51:23.920
> 
> 标签：deployment, ruby-on-rails-3.2, capistrano

我想部署一个 rails 3.2 应用程序，在控制台中我看到这个错误：

```
[deploy:update_code] exception while rolling back: Capistrano::ConnectionError, connection          failed for: IP_ADDRESS (Net::SSH::AuthenticationFailed: deploy)
connection failed for: IP_ADDRESS (Net::SSH::AuthenticationFailed: deploy) 
```

我的部署文件：

```
set :domain , "DOMAIN"
set :application, "APP_NAME"
set :repository,  "MY_REPO"
set :scm, :git
set :scm_verbose, true
set :user, "deploy"
set :use_sudo, false
set :deploy_to, "/var/www/vhosts/default/htdocs/camplist_de/public/#{application}"
set :deploy_via, :remote_cache

set :branch, "master"

role :web, "IP_ADDRESS"
role :app, "IP_ADDRESS"
role :db,  "IP_ADDRESS", :primary => true

after "deploy:restart", "deploy:cleanup"

after "deploy", "deploy:bundle_gems"
after "deploy:bundle_gems", "deploy:restart"

namespace :deploy do
task :bundle_gems do
    run "cd #{deploy_to}/current && bundle install vendor/gems"
end
task :start do ; end
task :stop do ; end
task :restart, :roles => :app, :except => { :no_release => true } do
run "touch #{File.join(current_path,'tmp','restart.txt')}"
end
end 
```

这里的代码中有占位符而不是域和 ip，而不是在我的原始部署文件中。

我无法定位错误，需要一些帮助。

# ajax - Ajax remoteFunction 不调用动作

> ID：16043742
> 
> 赞同：0
> 
> 时间：2013-04-16T17:51:24.927
> 
> 标签：ajax, grails

我目前正在尝试在 Grails 中创建一个动态下拉菜单，并且我有一个 Ajax 语句，该语句应该从单击的选项中检索值，并使用与用户单击的第一个选项相对应的项目填充第二个下拉菜单。这是我的声明并在我的 gsp 文件中调用：

```
<div class="fieldcontain">
    <g:select name="termSelection" from="${Term.list()}" values="${params.id}" optionKey="id" optionValue="semester" noSelection="['':'----Term----']"
                 onchange="${remoteFunction (controller: 'term', action: 'findWeeksForSemester', params: '\'term.id=\' + this.value', update: 'weekSelection')}"/>

</div>
<br>
<td id="weekSelection">
    <select>
        <option>----Week----</option>
        <g:select name="week.id" from="${Week.list()}" optionValue="week" optionKey="id"/>
    </select>
</td> 
```

动作调用的函数是这样的：

```
def findWeeksForSemester = {
    println("Testing for action event")
    println(params)
    def term = Term.get(params.term.id)
    render(template: 'weekSelection', model:  [week: term.week])
} 
```

通过它进行调试时，我发现它甚至没有调用动作函数。有什么办法可以解决这个问题，还是我需要以不同的方式解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T20:00:59.950

您需要 GSP 中的`javascript`库（支持 AJAX）`head`才能完成`remoteFunction`工作。如果您想`sitemesh layout`从 Grails扩展默认设置，如下所示

```
<head>
    <meta name="layout" content="main"/>
    <title>Term</title>
    <g:javascript library="jquery"/>
</head> 
```

我能够使您的用例工作（引导域并做得更多）。如果需要我可以寄过去。有关详细信息，请参阅Grails 文档中的[Ajax 部分](http://grails.org/doc/2.2.1/guide/single.html#ajax)。

# python - 如何使用 Python 3.3 和 Qt 5 构建 GUI 应用程序？

> ID：16043743
> 
> 赞同：7
> 
> 时间：2013-04-16T17:51:29.763
> 
> 标签：python, qt, python-3.x, pyqt

没有 Python 或 Qt 经验我想开始使用最近的版本（我实际上试图大量使用已宣布的一些新功能）但我找不到任何教程（大多数似乎使用 Python 2\. x 和 Qt 4)。您能否分享一个教程的链接，或者只是告诉我我到底需要开始什么？我对其他语言有相当的经验，并且在这个问题上没有询问学习 Python 本身。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T20:28:47.880

看看[PyQt](http://www.riverbankcomputing.com/software/pyqt/intro "PyQt")。

[这是](http://qt-project.org/doc/qt-5.0/qtdoc/qtexamplesandtutorials.html)Qt5 文档。当我需要 PyQt 方面的帮助时，我会查看 Qt 文档并将 C++ 代码“翻译”成 Python。

# php - 删除 wordpress 中的评论功能

> ID：16043744
> 
> 赞同：0
> 
> 时间：2013-04-16T17:51:32.700
> 
> 标签：php, wordpress, comments

我正在为我的公司网站使用wordpress，但我想完全删除评论功能，而不仅仅是取消选中每个页面中的“允许评论”。

我做了一些谷歌搜索，说我应该删除这行代码：

```
<?php comments_template(); // Get wp-comments.php template ?> 
```

此代码应位于 page.php 中，但我无法找到此代码。也许这是在旧版本的 wordpress 中做到这一点的一种方式？

有谁知道我可以如何删除它？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T21:30:02.147

由于您无法`comments_template();`在页面模板中找到，请检查页面使用的内部内容模板。

该`get_template_part`函数看起来像这样：

```
<?php get_template_part( 'content', 'single' ); ?> 
```

通过破折号连接这两个参数并检查该模板（在上述情况下，您将检查 content-single.php）。

如果您仍然找不到`comments_template();`，可能您的页面确实是帖子，因此请在 Single Post 模板 (single.php) 中查找该评论功能并找到其内容模板（与我们处理页面的方式相同）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:05:56.530

您必须删除模板`<?php comments_template(); ?>`中的所有内容以及两者之间的所有内容`content*.php``if ( comments_open() ) .. endif`

# ios - 使用 Parse 登录 Facebook 不起作用

> ID：16043747
> 
> 赞同：1
> 
> 时间：2013-04-16T17:51:40.393
> 
> 标签：ios, objective-c, facebook, parse-platform

我正在尝试使用 Parses SDK 为 Facebook 进行单点登录，但是当我按下登录按钮时出现此错误：

> 哦哦。发生错误：错误域=com.facebook.sdk 代码=2“操作无法完成。（com.facebook.sdk 错误 2。）”UserInfo=0x1d5bac20 {com.facebook.sdk:ErrorLoginFailedReason=com.facebook .sdk:SystemLoginDisallowedWithoutError, com.facebook.sdk:ErrorSessionKey=, expireDate: (null), refreshDate: (null), mappedRefreshDate: 0001-12-30 00:00:00 +0000, permissions:(null)>}

[我点击按钮时的代码与Parse 教程](https://parse.com/tutorials/integrating-facebook-in-ios)中的代码几乎相同

```
- (IBAction)loginButtonTouchHandler {
    // The permissions requested from the user
    NSArray *permissionsArray = @[ @"user_about_me", @"user_birthday"];

    // Login PFUser using Facebook
    [PFFacebookUtils logInWithPermissions:permissionsArray block:^(PFUser *user, NSError *error) {
        [_activityIndicator stopAnimating]; // Hide loading indicator

        if (!user) {
            if (!error) {
                NSLog(@"Uh oh. The user cancelled the Facebook login.");
            } else {
                NSLog(@"Uh oh. An error occurred: %@", error);
            }
        } else if (user.isNew) {
            NSLog(@"User with facebook signed up and logged in!");
        } else {
            NSLog(@"User with facebook logged in!");
        }
    }];
} 
```

我有我的 Facebook 应用程序和一切。

有什么线索吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-31T13:21:27.773

我在我的设备上遇到了同样的问题。同样的错误。

修复很简单：设置 -> 隐私 -> Facebook -> 并在那里检查您的应用状态。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-02T16:11:32.263

我在一台设备（iPhone 5S）上遇到了同样的问题。设置 -> 隐私 -> Facebook 是正确的。我有其他设备以及 iPhone sim 都运行良好。

无论如何，我尝试重新启动并没有解决问题，还删除了应用程序并重新安装。

**最终起作用的是以下内容：**

1.  在设置 -> 隐私 -> Facebook 下关闭应用程序的访问权限。
2.  尝试从应用程序登录 FB。（当然失败了）。
3.  在设置 -> 隐私 -> Facebook 下重新启用应用设置的访问权限。
4.  尝试从现在成功的应用程序登录 FB。

奇怪的错误。

希望这可以帮助某人。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-09-25T21:28:52.980

请参阅下面的答案。有时奇怪的是，开关打开了。它有助于在系统偏好设置中使用 Facebook 重新登录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-17T14:28:11.383

我从解析后端删除了我的 FB 访问密钥和秘密，效果很好。

（解析错误？？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-08T21:23:34.630

传递一个空的权限数组 NSArray *permissionsArray = @[];

确保您的权限已在您的 Facebook 应用程序控制台中设置。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-21T10:42:00.013

请确保您在 AppDelegate.m 上添加

```
- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url sourceApplication:(NSString *)sourceApplication annotation:(id)annotation {

     return [[FBSDKApplicationDelegate sharedInstance] application:application openURL:url sourceApplication:sourceApplication annotation:annotation];
} 
```

并添加

```
[FBSDKAppEvents activateApp];

- (void)applicationDidBecomeActive:(UIApplication *)application {
    [FBSDKAppEvents activateApp];
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-10T14:48:25.907

要使其在**Swift 3.1**和**iOS 10.3.1**上运行，请确保您的应用委托中有以下方法：

**仅适用于 Swift 3.1：**

```
func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -> Bool {
  let configuration = ParseClientConfiguration {
       $0.applicationId = "XXXXX"
       $0.clientKey = "XXXXXX"
       $0.server = "https://yourserverparse.."
   }

   Parse.initialize(with: configuration)
   PFFacebookUtils.initializeFacebook(applicationLaunchOptions: launchOptions)

   return FBSDKApplicationDelegate.sharedInstance().application(application, didFinishLaunchingWithOptions: launchOptions)
} 
```

然后：

```
 func application(_ app: UIApplication, open url: URL, options: [UIApplicationOpenURLOptionsKey : Any] = [:]) -> Bool {

    var isHandled:Bool;

    if #available(iOS 9.0, *) {
        isHandled = FBSDKApplicationDelegate.sharedInstance().application(app, open: url, sourceApplication: options[.sourceApplication] as! String!, annotation: options[.annotation])
    } else {
        // Fallback on earlier versions
        isHandled = FBSDKApplicationDelegate.sharedInstance().application(app, open: url, options: options)
    }

    return isHandled
} 
```

然后：

```
func applicationDidBecomeActive(_ application: UIApplication) {
    FBSDKAppEvents.activateApp()
} 
```

# javascript - JavaScript 单击事件仅在 InfoPath 表单上第一次触发

> ID：16043748
> 
> 赞同：1
> 
> 时间：2013-04-16T17:51:42.543
> 
> 标签：javascript, jquery, infopath2010

我试图让一个按钮在每次单击按钮时显示警报。目前，它仅在我第一次单击时触发，我必须刷新页面才能使其再次工作。因为这是一个提交和新建按钮，所以我需要它能够保留重新加载时会丢失的表单值。警报用于向用户提供反馈。这是我的代码：

```
$('input[value="Submit and New"]').on('click', function(){
alert('The request form has been submitted successfully. To submit a new form for the same user, change the form values and click on either the "Submit" or "Submit and New" button');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:56:12.253

使用文档设置单击，它应该可以正常工作

```
 $(document).on('click','input[value="Submit and New"]', function(){
    alert('The request form has been submitted successfully. To submit a new form for the same user, change the form values and click on either the "Submit" or "Submit and New" button');
    }); 
```

[http://jsfiddle.net/w4QWu/](http://jsfiddle.net/w4QWu/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:01:19.660

您可能在加载文档之前调用该函数，试试这个：

```
$(document).ready(function(){
    $('input[value="Submit and New"]').on('click', function(){
alert('The request form has been submitted successfully. To submit a new form for the same user, change the form values and click on either the "Submit" or "Submit and New" button');
    }
}) 
```

[jsfiddle](http://jsfiddle.net/arcm111/fRrTC/)

# entity-framework - 仅在集合中级联删除

> ID：16043750
> 
> 赞同：0
> 
> 时间：2013-04-16T17:51:43.080
> 
> 标签：entity-framework

如何指示 EF 不要删除 OneToMany 关系而是级联删除集合？

IE：

```
public class Client
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class Order
{
    public int Id { get; set; }
    public int ClientId { get; set; }
    [ForeignKey("ClientId")]
    public Client Client { get; set; }
    public ICollection<OrderItem> OrderItems { get; set; }
}

public class OrderItem
{
    public int Id { get; set; }
    public int OrderId { get; set; }
    [ForeignKey("OrderId")]
    public Order Order { get; set; }
} 
```

在此模型中，当我尝试删除与某些订单关联的客户时，我希望避免删除 (1)。但是，当我尝试删除带有一些 OrderItems 的订单时，我想删除该订单和相关的 OrderItems (2)。

我对 FK 列也有一个限制：它采用 [Model]Id 格式，而不是 EF 默认的 [Model]_Id 格式。

如果我定义

```
modelBuilder.Conventions.Remove<OneToManyCascadeDeleteConvention>(); 
```

(1) 工作正常，但 (2) 触发错误。

除了为每个集合使用 Fluent 之外，还有其他选择吗？无论如何，如何在 Fluent 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:28:03.467

你这两种情况都是一对多的关系。通过删除级联删除约定，您告诉 EF 这两种情况都应该在没有级联删除的情况下处理。

如果要控制每个关系的级联删除，则需要使用 fluent API：

```
modelBuilder.Entity<Order>()
            .HasMany(o => o.OrderItems)
            .WithRequired(i => i.Order)
            .HasForeignKey(i => i.OrderId)
            .WillCascadeOnDelete(true);

modelBuilder.Entity<OrderItem>()
            .Property(i => i.OrderId)
            .HasColumnName("OrderId"); 
```

当您想更改行为时，您还可以使用约定（或删除它）并仅将流式 API 用于关系。

如果您不想拥有 OrderId 属性，您可以使用：

```
modelBuilder.Entity<Order>()
            .HasMany(o => o.OrderItems)
            .WithRequired(i => i.Order)
            .Map(m => m.MapKey("OrderId"))
            .WillCascadeOnDelete(true); 
```

请注意，这两个选项[在 EF 中具有不同的实现](https://stackoverflow.com/a/5282275/413501)。

# jquery - 我的图片无法加载到我的网站上

> ID：16043751
> 
> 赞同：-8
> 
> 时间：2013-04-16T17:51:44.347
> 
> 标签：jquery, html, css, image

我使用 html、css 和 jquery 从头开始​​制作了这个婚礼网站：

www.benandkim.net

由于某种原因，图像一直无法加载。我将对 html 文档进行一些任意调整，然后它们会重新出现。我会将它重新加载到我的 ftp，然后确定几天后同样的错误发生，其中没有图像显示或它们显示一秒钟然后消失。我认为这是我的幻灯片放映中的错误？

任何帮助将不胜感激。

〜金

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:56:06.197

您的所有图像都已`opacity:0;`设置

在 chrome 上按 F12 并转到元素面板以查看此内容

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:56:58.467

您的样式中的不透明度设置为 0。这使得图像完全透明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:20:18.110

这是您在所有 img 标签中将图像设置为不透明度 0 的问题。

```
<img src=​"images/​hearts.png" alt=​"Hearts" style=​"opacity:​ 0;​ visibility:​ visible;​" class> 
```

你需要删除它然后你的图片就会出现

# javascript - TypeScript/Javascript：在代码中的任意位置添加 while 循环会导致未捕获类型错误

> ID：16043752
> 
> 赞同：0
> 
> 时间：2013-04-16T17:51:44.640
> 
> 标签：javascript, typescript

我完全不明白这一点。添加 while 循环会导致变量抛出“未捕获的类型错误无法读取 'perp' 的属性”。我尝试了很多解决方案，分离代码，添加额外的类型，尝试制作：任何类型，我真的很茫然。

小背景信息：我正在尝试制作一个名为“三是犯罪”的快速小游戏，本质上我有一个算法可以显示最多 3 名罪犯，其中最多 2 名可能是真正的肇事者。

所有代码都可以公开查看：[https ://github.com/treehau5/ThreesACrime](https://github.com/treehau5/ThreesACrime)

```
function main(num) {
    var is_over = false;
    var game = new GameObject.Game(shuffled_criminals, num);

    $('body').append(game.display());
    $("#status").text("Turn in progress");
    $('body').append('<div class="container"><p>Enter your guess<p><div class="input-append" id="turn_form"><form>\
         <input class="span2" id="Text1" type="text" />\
         <button class="btn" id="Button1" type="button">Go!</button>\
         </form>\
     </div></div>');

    console.log(game.getThree());
    while (true)          //removing this while loop causes above line to work fine.
    { }
} 
```

这是游戏类中的 getThree 方法

```
 getThree() {
        var result: Criminal[] = [];
        var temp: Criminal[] = _.shuffle(this.criminals);
        var num_perp = 0;
        while (result.length != 3) {
            while ((num_perp != 3) && (result.length != 3)) {
                var x: Criminal = temp.pop();
                result.push(x);
                if (x.perp == true)
                    num_perp++;
                temp = _.shuffle(temp);
            }
            do {
                temp = _.shuffle(temp);
                var y: Criminal = temp.pop();
                if (y.perp == false)
                    result.push(y);
            }
            while (result.length != 3)

        }

        return result;
    }//end displayThree 
```

我正在使用 underscorejs 进行改组，并使用 distinctlyTyped 下划线分型。

随意查看或克隆 repo 以尝试。这个错误发生在 Google Chrome 26 中。所有代码都在 game.ts、gameobject.ts 和 main.ts 中，有很多对外部库的引用，比如下划线和 jquery ui，我打算在我完成后稍微修饰一下 GUI完成主游戏逻辑。

感谢您甚至费心阅读所有这些内容，非常感谢您的帮助。

编辑：所以我试图使用这样的循环在游戏中放置一个“转弯”

```
 while (is_over)
    {
        break;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T19:12:22.333

在您的问题中，您使用的是以下示例：

```
while (true)          //removing this while loop causes above line to work fine.
{ } 
```

这个紧密的循环将阻止几乎任何事情发生（通常浏览器会询问您是否要终止脚本。

如果这不是您正在使用的代码，请显示您正在使用的代码 - 最好是演示问题的缩短版本，而不是整个程序。我已经在 TypeScript 中测试了几种循环变体，并且发现 while 循环没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T05:01:16.480

尝试

```
while(false){
 // Unreachable code
 do_something;
 break;
} 
```

如果条件里面有什么，即。`anything`在您的情况下，永远不会成为错误，那么`while(true)`正如 steve fenton 提到的那样，它实际上会被浏览器停止或崩溃。

更好的循环方式是：

```
function loop(){
   var result = do_something();
   // Repeat 
   if (result) {setTimeout(loop,100);}
   // Break
   else return; 
}
setTimeout(loop,100); 
```

虽然我建议使用游戏引擎而不是 setTimeout。例如[http://www.createjs.com/#!/EaselJS](http://www.createjs.com/#!/EaselJS)

# javascript - 使用 innerHTML 修改 img src

> ID：16043755
> 
> 赞同：2
> 
> 时间：2013-04-16T17:51:47.453
> 
> 标签：javascript, image, innerhtml

我非常接近完成我的代码，但我被困在最后一个小障碍上。我希望代码允许用户输入链接，然后当他们单击按钮时，页面通过修改 img src 来附加实际图像。我还希望它通过使用无序列表来附加图像。

这是我所拥有的：

```
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />

    <title>Images Reveal</title>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.js" type="text/javascript"></script>
    <script>
        window.onload = alert('Welcome to my assignment 2!')

        $(document).keypress(function(e) {
            if (e.which == 13) {
                alert('Please submit text via button');
            }
        });

        var string = "";

        function imageReveal() {
            var rubberDuckie = document.getElementById("textInput");
            var imageReveal = rubberDuckie.value;
            if (imageReveal == "") {
                alert("Please enter some text!");
            } else {
                var li = document.createElement("li");
                rubberDuckie.innerHTML = "<img src=" + rubberDuckie + " />";

                var ul = document.getElementById("listItUp");
                ul.appendChild(li);
            }
            rubberDuckie.value = "";
        }
    </script>

</head>
<body style="background-color:yellow;">
    <div align="center">
        <header>
            <h1>Alan Sylvestre</h1>
        </header>

        <input type="text" id="textInput" size="50" placeholder="Enter Some Text">
        <input type="button" id="clicking" value="Add Image" onclick="imageReveal()">
    </div>

    <ul id="listItUp">

    </ul>

    <p id="pTags">

    </p>

    </div>

</body> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:56:52.507

您正在尝试将图像插入输入（不能导致其为空元素）。只需将图像插入 li。

```
li.innerHTML = "<img src=\"" + imageReveal + "\">"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T17:57:29.697

您已经在使用 jQuery，因此请充分利用它的方法。尝试使用：

```
function imageReveal() {
    var rubberDuckie = $("#textInput");  // Get textbox element
    var imageReveal = rubberDuckie.val();  // Get textbox value
    if (!$.trim(imageReveal)) {  // If textbox is empty (after being trimmed of whitespace)
        alert("Please enter some text!");
    } else {  // If textbox has value
        var li = $("<li>");  // Create <li> element
        li.append($("<img>").attr("src", rubberDuckie));  // Add <img> element with src to the <li>
        $("#listItUp").append(li);  // Add the new <li> to the list
    }
    rubberDuckie.val("");  // Set the textbox value to empty
} 
```

此外，您的 jQuery (1.3.2) 版本已经过时了。从那时起，有很多错误修复、改进等等，因此建议升级到更新的版本。当前的稳定版本是 1.9.1。

*   1.9.1 - [http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js)
*   最新 - [http://code.jquery.com/jquery-latest.js](http://code.jquery.com/jquery-latest.js)

还有其他可以使用的里程碑版本，但我喜欢使用最新版本以获得“最佳”版本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T17:58:50.953

您实际上只添加了一个列表项。

除了图像之外，您还需要添加列表项。例如，与您的代码最相似：

```
 function imageReveal() {
            var rubberDuckie = document.getElementById("textInput");
            var imageReveal = rubberDuckie.value;
            if (imageReveal == "") {
                alert("Please enter some text!");
            } else {
                var li = document.createElement("li");
                var ul = document.getElementById("listItUp");
                ul.appendChild(li);
                li.innerHTML = "<img src=" + imageReveal + " />";
            }
            rubberDuckie.value = "";
        } 
```

# android - 选项菜单（操作栏）未显示

> ID：16043757
> 
> 赞同：2
> 
> 时间：2013-04-16T17:51:50.440
> 
> 标签：android, android-optionsmenu

我有一个显示提要项目的活动，它有一个上下文菜单来完成共享、添加到您的收藏夹等操作。我已将项目从上下文菜单移动到选项菜单，因此可以直接执行操作从操作栏。但是选项菜单没有出现在操作栏中（它之前确实出现过）。我还没有向这些项目添加任何操作，但它们应该显示在选项菜单中。

饲料项目活动：

```
 package com.mfavez.android.feedgoal;

 someimports....
 import com.mfavez.android.feedgoal.storage.SharedPreferencesHelper;

 public class FeedItemActivity extends Activity {

private static final String LOG_TAG = "FeedItemActivity";
private static final int KILL_ACTIVITY_CODE = 1;

private DbFeedAdapter mDbFeedAdapter;
private long mItemId = -1;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //only show bar for honeycomb and over
    int currentAPIVersion = android.os.Build.VERSION.SDK_INT;

    if (currentAPIVersion >= android.os.Build.VERSION_CODES.HONEYCOMB) {

    ActionBar bar = getActionBar();
    bar.setDisplayHomeAsUpEnabled(true);
    bar.show();
    }
    //end of actionbardisplay

    mDbFeedAdapter = new DbFeedAdapter(this);
    mDbFeedAdapter.open();

    TrackerAnalyticsHelper.createTracker(this);

    mItemId = savedInstanceState != null ? savedInstanceState.getLong(DbSchema.ItemSchema._ID) : -1;

    if (mItemId == -1) {
        Bundle extras = getIntent().getExtras();            
        mItemId = extras != null ? extras.getLong(DbSchema.ItemSchema._ID) : -1;
    }

    Item item = mDbFeedAdapter.getItem(mItemId);
    if (item.isFavorite())
        setContentView(R.layout.item_favorite);
    else
        setContentView(R.layout.item_notfavorite);

    /*
     * To test ads in emulator, remove ads:loadAdOnCreate="true" in layout
    if (SharedPreferencesHelper.useAdmob(this)) {
        int resourceId = getResources().getIdentifier("adView", "id", this.getPackageName());
        AdView adView = (AdView)this.findViewById(resourceId);
        //AdView adView = (AdView)this.findViewById(R.id.adView);
        AdRequest request = new AdRequest();
        request.addTestDevice(AdRequest.TEST_EMULATOR);
        adView.loadAd(request);
    }
    */
    AdRequest request = new AdRequest();
    request.addTestDevice(AdRequest.TEST_EMULATOR);

    TextView title = (TextView)findViewById(R.id.title);
    title.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            TrackerAnalyticsHelper.trackEvent(FeedItemActivity.this,LOG_TAG,"Link_Title",mDbFeedAdapter.getItem(mItemId).getLink().toString(),1);
            adjustLinkableTextColor (v);
            startItemWebActivity();
        }
    });

    TextView channel = (TextView)findViewById(R.id.channel);
    channel.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            Feed feed = mDbFeedAdapter.getFeed(mDbFeedAdapter.getItemFeedId(mItemId));
            String channelHomepage = feed.getHomePage().toString();
            TrackerAnalyticsHelper.trackEvent(FeedItemActivity.this,LOG_TAG,"Link_Channel",channelHomepage,1);
            adjustLinkableTextColor (v);
            if (SharedPreferencesHelper.isOnline(FeedItemActivity.this)) {
                Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(channelHomepage));
                startActivity(intent);
            } else
                showDialog(SharedPreferencesHelper.DIALOG_NO_CONNECTION);
        }
    });

    Button read_online = (Button)findViewById(R.id.read);
    read_online.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            TrackerAnalyticsHelper.trackEvent(FeedItemActivity.this,LOG_TAG,"Button_ReadOnline",mDbFeedAdapter.getItem(mItemId).getLink().toString(),1);
            startItemWebActivity();
        }
    });

    registerForContextMenu(findViewById(R.id.item));
}

private void startItemWebActivity() {
    if (SharedPreferencesHelper.isOnline(FeedItemActivity.this)) {
        Intent intent = new Intent(FeedItemActivity.this, FeedWebActivity.class);
        intent.putExtra(DbSchema.ItemSchema._ID, mItemId);
        startActivity(intent);
    } else
        showDialog(SharedPreferencesHelper.DIALOG_NO_CONNECTION);
}

private void adjustLinkableTextColor (View v) {
    TextView textView = (TextView) v;
    textView.setTextColor(R.color.color2);

}

private void displayItemView() {
    if (mItemId != -1) {
        Item item = mDbFeedAdapter.getItem(mItemId);
        TextView titleView = (TextView) findViewById(R.id.title);
        TextView channelView = (TextView) findViewById(R.id.channel);
        TextView pubdateView = (TextView) findViewById(R.id.pubdate);
        TextView contentView = (TextView) findViewById(R.id.content);
        if (titleView != null)
            titleView.setText(item.getTitle());
        if (channelView != null) {
            Feed feed = mDbFeedAdapter.getFeed(mDbFeedAdapter.getItemFeedId(mItemId));
            if (feed != null)
                channelView.setText(feed.getTitle());
        } 
        if (pubdateView != null) {
            //DateFormat df = new SimpleDateFormat(getResources().getText(R.string.pubdate_format_pattern);
            //pubdateView.setText(df.format(item.getPubdate()));
            CharSequence formattedPubdate = DateFormat.format(getResources().getText(R.string.pubdate_format_pattern), item.getPubdate());
            pubdateView.setText(formattedPubdate);
        }
        if (contentView != null) {
            String content_description = item.getContent();
            if (content_description == null)
                content_description = item.getDescription();
            if (content_description != null)
                //contentView.setText(content_description,TextView.BufferType.SPANNABLE);
                contentView.setText(content_description);
        }

        // set item as read (case when item is displayed from next/previous contextual menu or buttons)
        ContentValues values = new ContentValues();
        values.put(DbSchema.ItemSchema.COLUMN_READ, DbSchema.ON);
        mDbFeedAdapter.updateItem(mItemId, values, null);

        TrackerAnalyticsHelper.trackPageView(this,"/offlineItemView");
    }
}

@Override
protected void onStart() {
    super.onStart();
    TrackerAnalyticsHelper.startTracker(this);
}

@Override
protected void onResume() {
    super.onResume();
    displayItemView();
}

@Override
protected void onStop() {
    super.onStop();
    TrackerAnalyticsHelper.stopTracker(this);
}

@Override
protected void onDestroy() {
    super.onDestroy();
    mDbFeedAdapter.close();
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putLong(DbSchema.ItemSchema._ID, mItemId);
}

//---------------------------------------------------------------
//Problems is around here I think!
//---------------------------------------------------------------

public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);

    MenuInflater inflater = getMenuInflater();
    Item item = mDbFeedAdapter.getItem(mItemId);

    if (SharedPreferencesHelper.isDynamicMode(this)) {

        if (item != null) {
            long feedId = mDbFeedAdapter.getItemFeedId(mItemId);
            boolean isFirstItem = false;
            boolean isLastItem = false;
            if (mItemId == mDbFeedAdapter.getFirstItem(feedId).getId())
                isFirstItem = true;
            else if (mItemId == mDbFeedAdapter.getLastItem(feedId).getId())
                isLastItem = true;

            if (item.isFavorite()) {
                if (isFirstItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_notfav_next, menu);
                else if (isLastItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_notfav_prev, menu);
                else
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_notfav_next_prev, menu);
            } else {
                if (isFirstItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_fav_next, menu);
                else if (isLastItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_fav_prev, menu);
                else
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_fav_next_prev, menu);
            }
        }

        MenuItem channelsMenuItem = (MenuItem) menu.findItem(R.id.menu_opt_channels);
        channelsMenuItem.setIntent(new Intent(this,FeedChannelsActivity.class));
    } else {

        if (item != null) {
            long feedId = mDbFeedAdapter.getItemFeedId(mItemId);
            boolean isFirstItem = false;
            boolean isLastItem = false;
            if (mItemId == mDbFeedAdapter.getFirstItem(feedId).getId())
                isFirstItem = true;
            else if (mItemId == mDbFeedAdapter.getLastItem(feedId).getId())
                isLastItem = true;

            if (item.isFavorite()) {
                if (isFirstItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_notfav_next, menu);
                else if (isLastItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_notfav_prev, menu);
                else
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_notfav_next_prev, menu);
            } else {
                if (isFirstItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_fav_next, menu);
                else if (isLastItem)
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_fav_prev, menu);
                else
                    inflater.inflate(R.menu.ctx_menu_item_dyn_offline_fav_next_prev, menu);
            }
        }

        // Channels menu item
        if (mDbFeedAdapter.getFeeds().size() > 1) {
            MenuItem channelsMenuItem = (MenuItem) menu.findItem(R.id.menu_opt_channels);
            SubMenu subMenu = channelsMenuItem.getSubMenu();

            List<Feed> feeds = mDbFeedAdapter.getFeeds();
            Iterator<Feed> feedIterator = feeds.iterator();
            Feed feed = null;
            MenuItem channelSubMenuItem = null;
            Intent intent = null;
            int order = 0;
            while (feedIterator.hasNext()) {
                feed = feedIterator.next();
                channelSubMenuItem = subMenu.add(SharedPreferencesHelper.CHANNEL_SUBMENU_GROUP, Menu.NONE, order, feed.getTitle());

                if (feed.getId() == SharedPreferencesHelper.getPrefTabFeedId(this, mDbFeedAdapter.getFirstFeed().getId()))
                    channelSubMenuItem.setChecked(true);

                intent = new Intent(this, FeedTabActivity.class);
                intent.putExtra(DbSchema.FeedSchema._ID, feed.getId());
                channelSubMenuItem.setIntent(intent);

                order++;
            }

            subMenu.setGroupCheckable(SharedPreferencesHelper.CHANNEL_SUBMENU_GROUP, true, true);
        } else {
            menu.removeItem(R.id.menu_opt_channels);
        }
    }

    // Home menu item
    MenuItem menuItem = (MenuItem) menu.findItem(R.id.menu_opt_home);
    menuItem.setIntent(new Intent(this, FeedTabActivity.class));     

    // Preferences menu item
    MenuItem preferencesMenuItem = (MenuItem) menu.findItem(R.id.menu_opt_preferences);
    preferencesMenuItem.setIntent(new Intent(this,FeedPrefActivity.class));

    return true;
}

public boolean onOptionsItemSelected(MenuItem item) {
      //using icon to go up in honeycomb and higher
       switch (item.getItemId()) 
       {        
          case android.R.id.home:            
             Intent intent = new Intent(this, FeedTabActivity.class);            
             intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP); 
             startActivity(intent);            
             return true;        
          default:            
       }
       //thats it
    switch (item.getItemId()) {
        case R.id.menu_opt_home:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"OptionMenu_Home","Home",1);
            // Kill the FeedTabActivity that started this FeedItemActivity, because tab channel id may have changed and wouldn't be correct (wouldn't be the initial FeedTabActivity channel id) if back button is pressed
            setResult(RESULT_OK);
            startActivity(item.getIntent());
            //finish();
            return true;
        case R.id.menu_opt_channels:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"OptionMenu_Channels","Channels",1);
            if (SharedPreferencesHelper.isDynamicMode(this)) {
                // Kill the FeedTabActivity that started this FeedItemActivity, because tab channel id may have changed and wouldn't be correct (wouldn't be the initial FeedTabActivity channel id) if back button is pressed
                setResult(RESULT_OK);
                startActivityForResult(item.getIntent(),KILL_ACTIVITY_CODE);
            } else {
                //do nothing, default case will be handled
            }
            return true;
        case R.id.menu_opt_preferences:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"OptionMenu_Preferences","Preferences",1);
            startActivity(item.getIntent());
            return true;
        case R.id.menu_opt_about:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"OptionMenu_AboutDialog","About",1);
            showDialog(SharedPreferencesHelper.DIALOG_ABOUT);
            return true;
        default:
            if (item.getGroupId() == SharedPreferencesHelper.CHANNEL_SUBMENU_GROUP) {
                // Kill the FeedTabActivity that started this FeedItemActivity, because tab channel id is now changing and won't be correct (won't be the initial FeedTabActivity channel id) if back button is pressed
                setResult(RESULT_OK);
                startActivity(item.getIntent());
                //finish();
                return true;
            }
    }
    return super.onOptionsItemSelected(item);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent intent) {
    super.onActivityResult(requestCode, resultCode, intent);

    switch(requestCode) {
        case KILL_ACTIVITY_CODE:
            if (resultCode == RESULT_OK)
                finish();
            break;
        }
}

public void onCreateContextMenu (ContextMenu menu, View v, ContextMenuInfo menuInfo) {
    super.onCreateContextMenu(menu, v, menuInfo);

    if (v.getId() == R.id.item) {
        menu.setHeaderTitle (R.string.ctx_menu_title);
        MenuInflater inflater = getMenuInflater();

        Item item = mDbFeedAdapter.getItem(mItemId);

        if (item != null) {
            long feedId = mDbFeedAdapter.getItemFeedId(mItemId);
            boolean isFirstItem = false;
            boolean isLastItem = false;
            if (mItemId == mDbFeedAdapter.getFirstItem(feedId).getId())
                isFirstItem = true;
            else if (mItemId == mDbFeedAdapter.getLastItem(feedId).getId())
                isLastItem = true;

            if (item.isFavorite()) {
                if (isFirstItem)
                    inflater.inflate(R.menu.ctx_menu_item_offline_notfav_next, menu);
                else if (isLastItem)
                    inflater.inflate(R.menu.ctx_menu_item_offline_notfav_prev, menu);
                else
                    inflater.inflate(R.menu.ctx_menu_item_offline_notfav_next_prev, menu);
            } else {
                if (isFirstItem)
                    inflater.inflate(R.menu.ctx_menu_item_offline_fav_next, menu);
                else if (isLastItem)
                    inflater.inflate(R.menu.ctx_menu_item_offline_fav_prev, menu);
                else
                    inflater.inflate(R.menu.ctx_menu_item_offline_fav_next_prev, menu);
            }
        }
    }
}

public boolean onContextItemSelected(MenuItem menuItem) {
    Item item = mDbFeedAdapter.getItem(mItemId);
    ImageView favView = (ImageView) findViewById(R.id.fav);
    ContentValues values = null;
    Intent intent = null;
    long feedId = -1;

    switch (menuItem.getItemId()) {
        case R.id.read_online:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"ContextMenu_ReadOnline",item.getLink().toString(),1);
            startItemWebActivity();
            return true;
        case R.id.add_fav:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"ContextMenu_AddFavorite",item.getLink().toString(),1);
            //item.favorite();
            values = new ContentValues();
            values.put(DbSchema.ItemSchema.COLUMN_FAVORITE, DbSchema.ON);
            mDbFeedAdapter.updateItem(mItemId, values, null);
            favView.setImageResource(R.drawable.fav);
            Toast.makeText(this, R.string.add_fav_msg, Toast.LENGTH_SHORT).show();
            return true;
        case R.id.remove_fav:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"ContextMenu_RemoveFavorite",item.getLink().toString(),1);
            //item.unfavorite();
            Date now = new Date();
            long diffTime = now.getTime() - item.getPubdate().getTime();
            long maxTime = SharedPreferencesHelper.getPrefMaxHours(this) * 60 * 60 * 1000; // Max hours expressed in milliseconds
            // test if item has expired
            if (maxTime > 0 && diffTime > maxTime) {
                AlertDialog.Builder builder = new AlertDialog.Builder(this);
                builder.setMessage(R.string.remove_fav_confirmation)
                       .setCancelable(false)
                       .setPositiveButton(R.string.yes, new DialogInterface.OnClickListener() {
                           public void onClick(DialogInterface dialog, int id) {
                                ContentValues values = new ContentValues();
                                values.put(DbSchema.ItemSchema.COLUMN_FAVORITE, DbSchema.OFF);
                                ImageView favView = (ImageView) findViewById(R.id.fav);
                                favView.setImageResource(R.drawable.no_fav);
                                mDbFeedAdapter.updateItem(mItemId, values, null);
                                Toast.makeText(FeedItemActivity.this, R.string.remove_fav_msg, Toast.LENGTH_SHORT).show();
                           }
                       })
                       .setNegativeButton(R.string.no, new DialogInterface.OnClickListener() {
                           public void onClick(DialogInterface dialog, int id) {
                                dialog.cancel();
                           }
                       });
                builder.create().show();
            } else {
                values = new ContentValues();
                values.put(DbSchema.ItemSchema.COLUMN_FAVORITE, DbSchema.OFF);
                mDbFeedAdapter.updateItem(mItemId, values, null);
                favView.setImageResource(R.drawable.no_fav);
                Toast.makeText(this, R.string.remove_fav_msg, Toast.LENGTH_SHORT).show();
            }
            return true;
        case R.id.next:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"ContextMenu_NextItem",item.getLink().toString(),1);
            feedId = mDbFeedAdapter.getItemFeedId(mItemId);
            intent = new Intent(this, FeedItemActivity.class);
            intent.putExtra(DbSchema.ItemSchema._ID, mDbFeedAdapter.getNextItemId(feedId, mItemId));
            startActivity(intent);
            finish();
            return true;
        case R.id.previous:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"ContextMenu_PreviousItem",item.getLink().toString(),1);
            feedId = mDbFeedAdapter.getItemFeedId(mItemId);
            intent = new Intent(this, FeedItemActivity.class);
            intent.putExtra(DbSchema.ItemSchema._ID, mDbFeedAdapter.getPreviousItemId(feedId, mItemId));
            startActivity(intent);
            finish();
            return true;
        case R.id.share:
            TrackerAnalyticsHelper.trackEvent(this,LOG_TAG,"ContextMenu_Share",item.getLink().toString(),1);
            item = mDbFeedAdapter.getItem(mItemId);
            if (item != null) {
                Intent shareIntent = new Intent(Intent.ACTION_SEND);
                shareIntent.putExtra(Intent.EXTRA_SUBJECT, String.format(getString(R.string.share_subject), getString(R.string.app_name)));
                shareIntent.putExtra(Intent.EXTRA_TEXT, item.getTitle() + " " + item.getLink().toString());
                shareIntent.setType("text/plain");
                startActivity(Intent.createChooser(shareIntent, getString(R.string.share)));
            }
            return true;
        default:
            return super.onContextItemSelected(menuItem);
    }
}

@Override
protected Dialog onCreateDialog(int id) {
    Dialog dialog = null;
    CharSequence title = null;
    LayoutInflater inflater = null;
    View dialogLayout = null;
    AlertDialog.Builder builder = null;
    switch (id) {
        case SharedPreferencesHelper.DIALOG_ABOUT:
            //title = getResources().getText(R.string.app_name) + " - " + getResources().getText(R.string.version) + " " + SharedPreferencesHelper.getVersionName(this);
            title = getString(R.string.app_name) + " - " + getString(R.string.version) + " " + SharedPreferencesHelper.getVersionName(this);

            /*
             * Without cancel button
            dialog = new Dialog(this);
            dialog.setContentView(R.layout.dialog_about);
            dialog.setTitle(title);
            */
            inflater = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
            dialogLayout = inflater.inflate(R.layout.dialog_about, null);
            TextView childView = null;
            if (getString(R.string.website).equals("")) {
                childView = (TextView) dialogLayout.findViewById(R.id.website);
                childView.setVisibility(View.GONE);
            }
            if (getString(R.string.email).equals("")) {
                childView = (TextView) dialogLayout.findViewById(R.id.email);
                childView.setVisibility(View.GONE);
            }
            if (getString(R.string.contact).equals("")) {
                childView = (TextView) dialogLayout.findViewById(R.id.contact);
                childView.setVisibility(View.GONE);
            }
            if (getString(R.string.powered).equals("")) {
                childView = (TextView) dialogLayout.findViewById(R.id.powered);
                childView.setVisibility(View.GONE);
            }
            builder = new AlertDialog.Builder(this);
            builder.setView(dialogLayout)
                   .setTitle(title)
                   .setIcon(R.drawable.ic_dialog)
                   .setNeutralButton(R.string.close, new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int id) {
                            dialog.cancel();
                       }
                   });
            dialog = builder.create();
            break;
        case SharedPreferencesHelper.DIALOG_NO_CONNECTION:
            title = getString(R.string.error);
            inflater = (LayoutInflater) getSystemService(LAYOUT_INFLATER_SERVICE);
            dialogLayout = inflater.inflate(R.layout.dialog_no_connection, null);
            builder = new AlertDialog.Builder(this);
            builder.setView(dialogLayout)
                   .setTitle(title)
                   .setIcon(R.drawable.ic_dialog)
                   .setNeutralButton(R.string.ok, new DialogInterface.OnClickListener() {
                       public void onClick(DialogInterface dialog, int id) {
                            dialog.cancel();
                       }
                   });
            dialog = builder.create();
            break;
        default:
            dialog = null;
        }
      return dialog;
   }
 } 
```

我的旧 FeedItemActivity： [http ://pastebin.com/4rV9uq15](http://pastebin.com/4rV9uq15)

我希望有人能帮助我，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:58:28.960

如果您想在底部的操作栏中设置菜单，请在清单中使用它。

```
android:uiOptions="splitActionBarWhenNarrow" 
```

或者如果你想在顶部操作栏中设置它，你必须使用 xml，否则它只会在单击菜单时显示

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:03:56.710

我认为问题是你从来没有在这里夸大你的菜单

```
public boolean onCreateOptionsMenu(Menu menu) {
super.onCreateOptionsMenu(menu);

MenuInflater inflater = getMenuInflater();
Item item = mDbFeedAdapter.getItem(mItemId); 
```

您创建了充气机，但不使用它。将其更改为

```
public boolean onCreateOptionsMenu(Menu menu) {
super.onCreateOptionsMenu(menu);

MenuInflater inflater = getMenuInflater();
inflater.inflate((R.menu.mainmenu, menu);    // you forgot this line here where mainmenu is your menu xml
Item item = mDbFeedAdapter.getItem(mItemId); 
```

# java - java hibernate实体：允许通过id和对象本身设置相关对象

> ID：16043761
> 
> 赞同：14
> 
> 时间：2013-04-16T17:52:12.220
> 
> 标签：java, hibernate, foreign-keys

我有一个以下 Java 类，它也是一个 Hibernate 实体：

```
@Entity
@Table(name = "category")
public class Category {

    @ManyToOne
    @JoinColumn(name="parent_id")
    private Category parent;

    public Category getParent() {
        return parent;
    }

    public void setParent(Category parent) {
        this.parent = parent;
    } 
```

类别表示类别树中的一个节点。我正在实现一个允许 CRUD 类别的网络服务。例如，该接口能够创建类别树节点，并将类别 ID 作为参数传递。

我只想创建一个新的 Category 对象并将其保存到数据库中而不获取父对象。我的数据提供者类如下所示：

```
public void createCategory(int parent_id, String name, CategoryType type) {
    Category category = new Category();
    category.setName(name);
    // category.setParent(?); <- I don't have this object here
    // category.setParentId(id); <- but I do have the id
    category.setType(type);
    this.categoryDao.save(category);
} 
```

我的问题是：如果假设我不会调用 hibernate 来为我获取父对象（这将是愚蠢的），我该怎么做才能创建一个带有 parent_id 集的新类别对象？我可以为 Category 类提供 setParentId/getParentId 方法吗？它会有哪些休眠注释？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-16T18:09:02.453

`Session.load()`Hibernate为这种场景提供了一个名为（相当混乱）的方法。

`Session.load()`返回具有给定标识符的惰性代理而不查询数据库（如果具有给定标识符的对象已加载到 current`Session`中，则它返回一个对象本身）。

您可以使用该代理来初始化正在保存的实体中的关系：

```
category.setParent(session.load(Category.class, parent_id)); 
```

请注意，此代码不会`Category`使用给定的 id 检查是否存在。但是，如果您的 DB 模式中有外键约束，则在传入无效 id 时会出现约束冲突错误。

这种方法的 JPA 等效称为`EntityManager.getReference()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T12:38:45.277

还有一个解决问题的方法 - 使用您想要引用的实体的默认构造函数并设置 id 和版本（如果它是版本化的）。

```
 Constructor<S> c = entityClass.getDeclaredConstructor();
        c.setAccessible(true);

        S instance = c.newInstance();
        Fields.set(instance, "id", entityId.getId());
        Fields.set(instance, "version", entityId.getVersion());
        return instance; 
```

我们可以使用这种方法，因为我们不使用延迟加载，而是在 GUI 上使用实体的“视图”。这使我们能够摆脱 Hibernate 用来填充所有急切关系的所有连接。视图始终具有实体的 ID 和版本。因此，我们可以通过创建一个在 Hibernate 看来不是瞬态的对象来填充引用。

我尝试了这种方法和使用 session.load() 的方法。他们都工作得很好。我在我的方法中看到了一些优势，因为 Hibernate 不会在代码的其他地方使用它的代理泄漏。如果使用不当，我只会得到 NPE 而不是“没有会话绑定到线程”异常。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-16T18:11:40.650

你可以定义惰性初始化

```
@ManyToOne(fetch=FetchType.LAZY) 
```

猜测该列可以为空，因此在没有父级（根）的情况下保存类别不是问题

# c - 初始化静态多维空终止数组

> ID：16043764
> 
> 赞同：2
> 
> 时间：2013-04-16T17:52:18.693
> 
> 标签：c, multidimensional-array, static

我想初始化一个以空结尾并包含静态以空结尾的数组的静态数组。我还希望能够在以后打印所有内容。

这是我到目前为止的代码，**显然初始化和数据类型不正确**：

```
void print_commands(char *commands[][])
{
    int i, j;
    char *command[];

    for(i = 0; commands[][i] != NULL; i++)
    {
        command = commands[][i];
        printf("Command #%d: %s\n", i, command[0]);
        for(j = 1; command[j] != NULL; j++)
        {
            printf("Argument #%d: %s\n", j, command[j]);
        }
    }
}

int main(int argc, char *argv[])
{
    char *commands[][5] = {
        {"less", 0}, 
        {"sort", 0}, 
        {"cat", "my.txt", 0},
        {"echo", "hello", 0}, 
        NULL};

    print_commands(commands);

    exit( 0 );
} 
```

我将如何正确初始化和使用这种数据？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:56:28.003

由于数组不是指针，因此您不能使用`NULL`. **为什么不选择全零结构**如此普遍和惯用的原理呢？

 **```
char *commands[][5] = {
    { "less", NULL },
    { "sort", NULL },
    { "cat", "my.txt", NULL },
    { "echo", "hello", NULL },
    { NULL }
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:04:25.853

```
void print_commands(char **commands[])
{
    int i, j;
    char **command;

    for(i = 0; commands[i] != NULL; i++)
    {
        command = commands[i];
        printf("Command #%d: %s\n", i, command[0]);
        for(j = 1; command[j] != NULL; j++)
        {
            printf("Argument #%d: %s\n", j, command[j]);
        }
    }
}

int main(int argc, char *argv[])
{
    char **commands[] = {
        (char*[]){"less", 0}, 
        (char*[]){"sort", 0}, 
        (char*[]){"cat", "my.txt", 0},
        (char*[]){"echo", "hello", 0}, 
        NULL};

    print_commands(commands);

    exit( 0 );
} 
```

或者

```
void print_commands(char *commands[][5])
{
    int i, j;
    char **command;

    for(i = 0; *commands[i] != NULL; i++)
    {
        command = commands[i];
        printf("Command #%d: %s\n", i, command[0]);
        for(j = 1; command[j] != NULL; j++)
        {
            printf("Argument #%d: %s\n", j, command[j]);
        }
    }
}

int main(int argc, char *argv[])
{
    char *commands[][5] = {
        {"less", 0}, 
        {"sort", 0}, 
        {"cat", "my.txt", 0},
        {"echo", "hello", 0}, 
        { NULL }
    };

    print_commands(commands);

    exit( 0 );
} 
```**

# android - 连接数据库时android程序出错

> ID：16043768
> 
> 赞同：0
> 
> 时间：2013-04-16T17:52:33.083
> 
> 标签：android, database, sqlite

`String getId=db1.getId().toString();`

和

```
SQLiteDatabase db=this.getReadableDatabase(); 
```

在 logcat 中给出 android 程序错误的行。'Logcat 数据过滤错误'

```
04-16 03:10:09.769: E/dalvikvm(26422): Unable to open stack trace file '/data/anr/traces.txt': Is a directory
04-16 03:10:10.109: E/AndroidRuntime(26422): FATAL EXCEPTION: main
04-16 03:10:10.109: E/AndroidRuntime(26422): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.doctors.prescription/com.doctors.prescription.ThirdActivity}: java.lang.NullPointerException
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1956)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1981)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.ActivityThread.access$600(ActivityThread.java:123)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1147)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.os.Looper.loop(Looper.java:137)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.ActivityThread.main(ActivityThread.java:4424)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at java.lang.reflect.Method.invokeNative(Native Method)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at java.lang.reflect.Method.invoke(Method.java:511)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at dalvik.system.NativeStart.main(Native Method)
04-16 03:10:10.109: E/AndroidRuntime(26422): Caused by: java.lang.NullPointerException
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.database.sqlite.SQLiteOpenHelper.getWritableDatabase(SQLiteOpenHelper.java:157)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.database.sqlite.SQLiteOpenHelper.getReadableDatabase(SQLiteOpenHelper.java:231)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at com.doctors.prescription.ThirdActivityDb.selectOne(ThirdActivityDb.java:67)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at com.doctors.prescription.ThirdActivity.onCreate(ThirdActivity.java:50)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.Activity.performCreate(Activity.java:4465)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)
04-16 03:10:10.109: E/AndroidRuntime(26422):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1920)
04-16 03:10:10.109: E/AndroidRuntime(26422):    ... 11 more 
```

'数据库文件'

```
package com.doctors.prescription;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteDatabase.CursorFactory;
import android.database.sqlite.SQLiteOpenHelper;
import android.provider.BaseColumns;

public class ThirdActivityDb extends SQLiteOpenHelper{

    public static final String KEY_ID = "id";
    public static final String KEY_NAME = "name";
    public static final String KEY_AGE = "age";
    public static final String KEY_GENDER = "gender";
    public static final String KEY_NUMBER = "number";
    public static final String KEY_EMAIL = "email";
    private static final String DATABASE_NAME = "Doctordb";
    private static final String DATABASE_TABLE = "doctor_register";
    private static final int DATABASE_VERSION = 2;

    private static final String CREATE_TABLE_QUERY = "CREATE TABLE "
            + ThirdActivityDb.DATABASE_NAME + " (" + ThirdActivityDb.KEY_ID
            + " INTEGER PRIMARY KEY AUTO INCREMENT , "
            + ThirdActivityDb.KEY_NAME + " VARCHAR," + ThirdActivityDb.KEY_AGE
            + " VARCHAR," + ThirdActivityDb.KEY_GENDER + " VARCHAR,"
            + ThirdActivityDb.KEY_NUMBER + " VARCHAR,"
            + ThirdActivityDb.KEY_EMAIL + " VARCHAR)";

    public ThirdActivityDb(Context context, String name, CursorFactory factory,
            int version) {
        super(context, DATABASE_NAME, factory, DATABASE_VERSION);
        // TODO Auto-generated constructor stub
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        // TODO Auto-generated method stub
        db.execSQL(CREATE_TABLE_QUERY);
        onCreate(db);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub
        onUpgrade(db, 0,DATABASE_VERSION);
    }

    public void InsertData(String name,String age,String gender,String number,String email){
        SQLiteDatabase db=this.getWritableDatabase();
        ContentValues contentvalue=new ContentValues();
        contentvalue.put("name", name);
        contentvalue.put("age", age);
        contentvalue.put("gender", gender);
        contentvalue.put("number", number);
        contentvalue.put("email", email);
        db.insert("doctor_register", null, contentvalue);
        db.close();
    }
    public Cursor selectOne(String id)
    {
        SQLiteDatabase db=this.getReadableDatabase();
        String query = "select id from doctor_register order by id desc limit 1 ";
        Cursor c= db.rawQuery(query, new String[]{id});
        if(c.getCount()!=0)
        {
            return c;
        }
        return null;
    }
    public Cursor select(String id , String name)
    {
        SQLiteDatabase db=this.getReadableDatabase();
        String query = "select name from doctor_register where id="+id+" and name="+name;
        Cursor c= db.rawQuery(query, new String[]{name});
        if(c.getCount()!=0)
        {
            return c;
        }
        return null;
    }
    public Cursor getId(){
        SQLiteDatabase db=this.getReadableDatabase();
        Cursor c = db.rawQuery("select id from doctor_register order by id desc limit 1 " ,null );
        if(c.getCount()!=0)
            return c;
        return null;
    }

} 
```

'第三活动.class'

```
package com.doctors.prescription;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.pm.ActivityInfo;
import android.os.Bundle;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.WindowManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.TextView;

public class ThirdActivity extends Activity {
    Button third_create, third_cancel;
    EditText name, age, number, email;
    TextView generated_id;
    private RadioGroup radio_group;
    RadioButton radio_Gender;
    int  radio_id;
    String KEY_ID="KEY_ID";
    String KEY_GETID="KEY_GETID";
    ThirdActivityDb db1 = new ThirdActivityDb(null, null, null, 2);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_third);
        //requestWindowFeature(Window.FEATURE_NO_TITLE);
        getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
        name = (EditText) findViewById(R.id.third_editText1);
        age = (EditText) findViewById(R.id.third_editText2);
        radio_group=(RadioGroup)findViewById(R.id.radioGroup1);
        number = (EditText) findViewById(R.id.third_editText3);
        email = (EditText) findViewById(R.id.third_editText4);
        String getId=db1.getId().toString();
        SharedPreferences SPref=getPreferences(MODE_PRIVATE);
        SharedPreferences.Editor editor=SPref.edit();
        editor.putString(KEY_ID, getId);
        editor.commit();

        String id = SPref.getString(KEY_GETID, KEY_GETID );
        generated_id = (TextView) findViewById(R.id.generated_id);
        String s=db1.selectOne(id).toString();
        generated_id.setText(s);
        third_create = (Button) findViewById(R.id.third_create_new);
        third_create.setOnClickListener(new OnClickListener() {
            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                if (name.getText().toString().length() == 0
                        || age.getText().toString().length() == 0
                        || number.getText().toString().length() == 0
                /* || email.getText().toString().length() == 0 */) {
                    name.setError("Please enter the name of patient!");
                    age.setError("Please enter the age of patient");
                    number.setError("Please enter the contact number of patient");
                    email.setError("Please enter the email of patient");
                } else {

                    //generated_id.setText(db.getRecord(TRIM_MEMORY_UI_HIDDEN).toString());
                    int selected_id = radio_group.getCheckedRadioButtonId();
                    radio_Gender = (RadioButton) findViewById(selected_id);

                    db1.InsertData(name.getText().toString(), age
                            .getText().toString(), radio_Gender.getText().toString(),
                            number.getText().toString(), email.getText()
                                    .toString());
                    db1.close();
                    Intent intent = new Intent(getApplicationContext(),
                            WriteTextActivity.class);
                    startActivity(intent);

                }
            }
        });
        third_cancel = (Button) findViewById(R.id.third_cancel);
        third_cancel.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                Intent intent = new Intent(getApplicationContext(),
                        SecondActivity.class);
                startActivity(intent);
            }
        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.third, menu);
        return true;
    }

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:47:31.500

我可以在您的代码中看到一些问题，`CREATE_TABLE_QUERY`因为您正在使用`DATABASE_NAME`而不是`DATABASE_TABLE`

```
private static final String CREATE_TABLE_QUERY = "CREATE TABLE "
        + ThirdActivityDb.DATABASE_TABLE + " (" + ThirdActivityDb.KEY_ID
        + " INTEGER PRIMARY KEY AUTO INCREMENT , "
        + ThirdActivityDb.KEY_NAME + " VARCHAR," + ThirdActivityDb.KEY_AGE
        + " VARCHAR," + ThirdActivityDb.KEY_GENDER + " VARCHAR,"
        + ThirdActivityDb.KEY_NUMBER + " VARCHAR,"
        + ThirdActivityDb.KEY_EMAIL + " VARCHAR)"; 
```

`onCreate(db);`从你的`onCreate(SQLiteDatabase db)`方法中删除

```
@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
    db.execSQL(CREATE_TABLE_QUERY);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // Drop older table if existed
    db.execSQL("DROP TABLE IF EXISTS " + DATABASE_TABLE); 
    // Create tables again
    onCreate(db);
} 
```

我不确定这是否会导致问题`implements BaseColumns`尝试将其删除。

**已编辑**

```
public String getId(){
    SQLiteDatabase db=this.getReadableDatabase();
    Cursor c = db.rawQuery("select id from doctor_register order by id desc limit 1 " ,null );
    if(c.getCount() > 0) {
        c.moveToFirst();
        return c.getString(0);
    }
    return null;
} 
```

称呼

```
String getId = db1.getId(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:36:25.283

您只创建表 `Doctordb`，但您尝试查询表`doctor_register`

```
String query = "select name from doctor_register where id="+id+" and name="+name; 
```

# python - 如何在 Python 中压缩字符串以将其存储在 Redis 中？

> ID：16043774
> 
> 赞同：5
> 
> 时间：2013-04-16T17:52:56.543
> 
> 标签：python, string, networking, compression, redis

我可以在 Python 中使用什么库或方法，以便获取一个字符串并将其压缩以存储在 Redis 中？目标是在某些字符串（ d 个对象）通过线路时减小它们的大小，`cPickle`但会以一些计算能力为代价。

我相信生成的对象`str`在存储之前必须是类型。我正在使用[`redis-py`](https://github.com/andymccurdy/redis-py)图书馆。

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-16T18:10:39.523

我推荐你[zlib](http://docs.python.org/2/library/zlib.html)：

```
import zlib

compressedString = zlib.compress(originalString, 9)  # Compress at level 9

decompressedString = zlib.decompress(compressedString) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-16T18:10:11.300

[选一个](http://docs.python.org/2/library/archiving.html)。bz2虽然很酷。

# ruby-on-rails - Ruby/Rails 如何限制用户可以看到其他用户的帖子数量？

> ID：16043777
> 
> 赞同：1
> 
> 时间：2013-04-16T17:53:17.293
> 
> 标签：ruby-on-rails, ruby, limiting

我正在开发一个 Ruby/Rails 应用程序，在该应用程序中，我只希望一个用户能够让所有其他用户一次看到一个帖子。所有用户都可以看到其他用户的所有帖子，但只能看到一篇帖子。这样做的最简单方法是什么？

这将在所有用户共享的提要上。

目标是没有用户在主要提要上发表超过一篇文章。因此，当他们发布新帖子时，它会从共享提要中删除之前的帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:09:41.093

您可以将 post_id 和 post_viewed_at 属性添加到用户记录，并尝试使其保持最新。

但是有几个极端情况可能会导致问题：

*   当用户关闭浏览器窗口时
*   当用户使用后退按钮或键入另一个 URL 离开时

您将需要一些 JavaScript 来确保在用户离开或关闭窗口时将 post_id 和 post_viewed_at 属性清零。

使用 post_viewed_at 时间戳，您还可以实现到期时间，以防在某些情况下您没有发现用户正在离开。

另一个问题是，对于一个拥有许多用户的站点，这可能会导致大量的数据库事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:00:48.177

似乎您必须为帖子提供某种简单的“结帐”系统。当任何用户查看某个帖子时，它会自动“签出”该帖子，其他人无法看到它。在我看来，棘手的部分是重新检查那个帖子。你怎么知道某人什么时候看完了帖子？一种相当确定的方法是，如果用户导航到不同的页面，但这不是唯一的方法，并且仅仅因为有人导航到新页面并不意味着他们没有在不同的选项卡中打开原始帖子。如果查看帖子的用户刚刚起床并离开计算机一天，帖子仍然处于打开状态怎么办？或者，如果他们让帖子保持打开状态，但转而进行其他浏览活动怎么办？

似乎您可能需要一种方法让每次结帐在一段时间后“过期”，并且查看帖子的用户可能会在结帐期即将过期时“更新”帖子。

然后，显然，只有在其他人尚未签出特定帖子时，您才允许用户查看该帖子。

我很乐意提供有关如何实施这样一个系统的具体细节的想法，但我会留到以后，以防其他人有更好的概念，或者我完全误解了你的问题。

# java - 将照片上传到 flickr (Java)

> ID：16043779
> 
> 赞同：0
> 
> 时间：2013-04-16T17:53:21.040
> 
> 标签：java, upload, flickr

我是一个试图弄清楚 Flickr API 的初学者。我正在尝试创建一个将图片上传到 Flickr 的简单应用程序。

在尝试发送上传照片的请求时，我收到“无效签名”响应。

这是我签名的基本字符串：

```
POST&http%3A%2F%2Fapi.flickr.com%2Fservices%2Fupload&oauth_consumer_key%3D3f1e1948c1db9a45ca95febef6f5590e%26oauth_nonce%3D6151b3221a15f56c82ba0df47d57637e%26oauth_signature_method%3DHMAC-SHA1%26oauth_timestamp%3D1366133923%26oauth_token%3D72157633261587382-7dcbe2359dbcfb06%26oauth_version%3D1.0 
```

当我请求用户的身份验证时，我基本上做了同样的事情，但使用访问令牌作为参数。

这是我的请求代码：

```
import java.io.File;
import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.security.NoSuchAlgorithmException;
import java.security.SignatureException;

import org.apache.commons.codec.DecoderException;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.ResponseHandler;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.mime.MultipartEntity;
import org.apache.http.entity.mime.content.FileBody;
import org.apache.http.entity.mime.content.StringBody;
import org.apache.http.impl.client.BasicResponseHandler;
import org.apache.http.impl.client.DefaultHttpClient;

public class Test {

  /**
   * @param args
 * @throws DecoderException 
 * @throws SignatureException 
 * @throws NoSuchAlgorithmException 
   */
  public static void main(String[] args) throws NoSuchAlgorithmException, SignatureException, DecoderException {
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://api.flickr.com/services/upload");

    try {
      FileBody bin = new FileBody(new File("/Users/[MYUSERNAME]/Desktop/Untitled-1.png"));

      MultipartEntity reqEntity = new MultipartEntity();
      reqEntity.addPart("photo", bin);

      reqEntity.addPart("api_key", new StringBody(Utils.consumer_key));
      reqEntity.addPart("oauth_token", new StringBody(Utils.oauth_token));
      reqEntity.addPart("api_sig", new StringBody(Request.sig()));
      httppost.setEntity(reqEntity);

      System.out.println("Requesting : " + httppost.getRequestLine());
      ResponseHandler<String> responseHandler = new BasicResponseHandler();
      String responseBody = httpclient.execute(httppost, responseHandler);

      System.out.println("responseBody : " + responseBody);

    } catch (UnsupportedEncodingException e) {
      e.printStackTrace();
    } catch (ClientProtocolException e) {
      e.printStackTrace();
    } catch (IOException e) {
      e.printStackTrace();
    } finally {
      httpclient.getConnectionManager().shutdown();
    }
  }

} 
```

我对发送 MIME 请求的理解是否有问题，还是只是签名？如果是这样，我应该如何构建我的签名？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-26T13:46:45.483

我相信问题出在 FileBody 构造函数上

> FileBody bin = new FileBody(new File("/Users/[MYUSERNAME]/Desktop/Untitled-1.png"));

如果使用此构造函数，则 MultiPart Encoding 的结果为

> 内容处置：表单数据；名称="照片";

而预期的请求应该是形式

> 内容处置：表单数据；名称="照片"; 文件名="无标题-1.png"

所以这里要使用的正确构造函数是

> new FileBody(new File("/Users/[MYUSERNAME]/Desktop/Untitled-1.png"),ContentType.APPLICATION_OCTET_STREAM, "Untitled-1.png")

虽然我没有尝试自己执行您的代码，但希望这可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-04T15:39:53.417

基本上，要使用 Flickr api 做任何事情，您需要某种类型的授权“令牌”——并且根据您进行身份验证的方式，您可能会获得不同的授权令牌。有两种类型的授权令牌：

1.  **oauth 令牌**- 如果您进行 oauth 身份验证
2.  **身份验证令牌**- 如果您使用旧的[不推荐使用的身份验证方法](http://www.flickr.com/services/api/auth.spec.html)

Flickr 的 api 文档只显示了如何使用**auth 令牌**（#2）上传，但也可以使用 Oauth 上传以获取**oauth 令牌**（只是没有记录）。您的问题似乎是您将**ouath 令牌**与 Flickr 的**身份验证令牌**上传方法混为一谈。

如果要使用 Oauth 身份验证，则需要传递 api_key 和 api_sig 的 Oauth**等效**项**，**即**oauth_consumer_key**和**oauth_signature**。此外，适当的 Oauth 有效负载应包含**oauth_timestamp**、**oauth_nonce**、**oauth_signature_method**和**oauth_version**。

 ******需要注意的另一件事：您还需要在原始 Oauth 身份验证中传递**perms=write**参数，以便为您的**oauth 令牌**启用写入权限- 否则您将缺乏上传权限。******

# python - 如何手动解析入站 GAE 电子邮件？

> ID：16043780
> 
> 赞同：0
> 
> 时间：2013-04-16T17:53:27.740
> 
> 标签：python, google-app-engine, email, python-2.5

由于当电子邮件主题为 UTF-8 编码时，标准 GAE 的电子邮件功能出现问题，因此我尝试手动处理它[：](https://stackoverflow.com/questions/16019811/how-to-receive-inbound-messages-with-unicode-subject)

```
msg_encoding = self.request.headers['Content-Type'].split('charset=')[1] # message/rfc822; charset=UTF-8
msg = email.message_from_string(self.request.body)
if msg:
    logging.debug(msg.get_content_charset()) # None
    logging.debug(msg['to'])
    logging.debug(msg['from'])
    logging.debug(msg['Subject'].decode(msg_encoding)) 
```

我做对了吗？我应该解码主题吗？还是由电子邮件解析器自动完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T07:47:19.763

以下简化代码（仅限文本/纯文本，无附件）对我很有效：

```
class InboundMailHandler(InboundMailHandler):
    def post(self):
        msg = email.message_from_string(self.request.body)
        if msg:
            charset = 'utf-8'
            from_realname, from_emailaddr = email.utils.parseaddr(msg['from'])
            to_realname, to_emailaddr = email.utils.parseaddr(msg['to'])
            # parse e-mail body, look for text/plain part only
            body = ''
            if msg.is_multipart():
                for part in msg.walk():
                    if part.get_content_type() and part.get_content_type()=='text/plain': # ignore text/html
                        charset = part.get_content_charset()
                        body = part.get_payload(decode=True).decode(part.get_content_charset())
            else:
                body = msg.get_payload(decode=True)
                body = body.decode('utf-8')
            subject, encoding = email.header.decode_header(msg['subject'])[0]
            if encoding != None:
                subject = subject.decode(encoding)
            else:
                subject = subject.decode('utf-8') 
```

# java - 是否可以像使用 CakePHP 一样将查询条件传递给 HIbernate？

> ID：16043782
> 
> 赞同：0
> 
> 时间：2013-04-16T17:53:35.677
> 
> 标签：java, hibernate, cakephp

在 CakePHP 中，我可以通过关联数组中的`WHERE`and条件来查询数据库，如下例所示：`ORDER`

```
$cities= $this->City->find('all', 
    array('conditions' => array('state_id' => $stateId), 
    'order'  => 'City.name')
); 
```

现在我开始使用 Java Hibernate 并想知道是否有类似的东西，可能使用 HashMap 或其他集合。

我在文档中没有找到类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:09:48.053

我所知道的最接近的是[Hibernate Criteria API](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/querycriteria.html)。但是，由于 Java 的性质，使用起来有点麻烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T19:19:12.947

您可以使用`Map`.

例如给定这个查询：

```
final Query query = session.createQuery("from MyThing mt where mt.something = :value1 and mt.somethingElse > :value2"); 
```

您可以传递参数`value1`并`value2`使用[`setProperties`](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/Query.html#setProperties%28java.util.Map%29)方法：

```
final Map<String, Object> properties = new HashMap<>();
properties.put("value1", 10);
properties.put("value2", 25);

query.setProperties(properties); 
```

中的值`Map`将由键绑定。

您也可以将 java`Object`与[其他`setProperties`](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/Query.html#setProperties%28java.lang.Object%29)方法一起使用。这里`value1`将绑定到`getValue1()`在传入的 bean 上调用的结果。

# delphi - 关于重构一些糟糕代码的建议

> ID：16043786
> 
> 赞同：1
> 
> 时间：2013-04-16T17:53:52.433
> 
> 标签：delphi, refactoring, delphi-5

考虑以下

```
constructor TSettlement.Assign( const OldInst : TSettlement; const ResetFsToo: Boolean );
begin
  //inherited
  Create;
  if OldInst = nil then
    exit;

  Self.Acceptancedate := OldInst.Acceptancedate;
  // etc etc
end; 
```

并请考虑代码中其他地方的这些调用

```
SettInst.Assign(DisplaySett, False);

DisplaySett := TSettlement.Assign(nil, False);

NewInst := TSettlement.Assign( Displaysett, False ); 
```

和（也许是最糟糕的）

```
 if OldList.Count > 0 then
    for loop := 0 to OldList.Count -1 do  
      Self.Add(TSettlement.Assign(OldList.Data[loop], True)); 
```

这是泄漏代码，我反对将方法名称“分配”用于构造函数，原因我认为很明显，但我**没有**义务修复它。

我想改进它，因为我对自己的工作感到自豪。

我建议将`Assign`方法从构造函数更改为过程，并删除对`Create()`. 这将需要我在应用程序的许多地方更改代码。显然，这样做是有风险的。

在我深入研究并开始破解之前，任何人都可以建议我应该考虑的任何替代方法吗？

有没有我可能没有想到的陷阱我应该注意？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T23:06:36.870

该构造函数不一定泄漏。代码确实有效是合理的。然而，它是不可穿透的，并导致调用代码的语义难以从外部辨别。你应该重构。

有一种简单的重构方法。关键是您将两种操作模式分解为单独的功能：

1.  一个名为 Create 的构造函数，其作用类似于普通的 Delphi 构造函数。你似乎已经有了这个。
2.  将一个实例的内容复制到另一个实例的过程。这很可能被命名为Assign。

所以，这是竞选计划：

1.  将 Assign 更改为过程而不是构造函数。
2.  处理可以在当前分配中找到的对 Create 的调用。您需要从Assign 中删除它，但要确保它所做的一切在Assign 运行时仍然发生。
3.  现在所有对 Assign 的构造函数模式调用都无法编译。所以我们修复它们。
4.  通过 nil 的，转换为 Create 的构造函数调用。
5.  其他的需要调用 Create 构造函数，然后调用 Assign。

您可能需要一个重载的 Create 来接收现有实例并调用 Assign。那可能很方便。

这将使您能够完成您今天所做的所有事情，但会避免在实例上调用构造函数，这总是一个坏主意。

# ruby - 如何在 ruby /watir 中获取元素的类？

> ID：16043788
> 
> 赞同：5
> 
> 时间：2013-04-16T17:53:53.767
> 
> 标签：ruby, watir-webdriver

我有表格标题的代码：

```
<thead>
<tr class="ui-jqgrid-labels ui-sortable" role="rowheader" style="">
    <th id="categories_formName" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 250px;">
        <div id="jqgh_categories_formName" class="ui-jqgrid-sortable">Category Name</div>
    </th>
    <th id="categories_totalClicks" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 99px;">
        <div id="jqgh_categories_totalClicks" class="ui-jqgrid-sortable">Clicks</div>
    </th>
    <th id="categories_avgCpc" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 99px;">
        <div id="jqgh_categories_avgCpc" class="ui-jqgrid-sortable">Avg CPC($)</div>
    </th>
    <th id="categories_totalCost" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr" style="width: 99px;">
        <div id="jqgh_categories_totalCost" class="ui-jqgrid-sortable">Total Cost($)</div>
    </th>
    <th id="categories_convertToSale" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr disabledHeader" style="width: 99px;">
        <div id="jqgh_categories_convertToSale" class="ui-jqgrid-sortable">CTS(%)</div>
    </th>
    <th id="categories_totalOrders" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr disabledHeader" style="width: 99px;">
        <div id="jqgh_categories_totalOrders" class="ui-jqgrid-sortable">Total Orders</div>
    </th>
    <th id="categories_totalSales" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr disabledHeader" style="width: 99px;">
        <div id="jqgh_categories_totalSales" class="ui-jqgrid-sortable">Sales($)</div>
    </th>
    <th id="categories_costOfSale" role="columnheader" class="ui-state-default ui-th-column ui-th-ltr disabledHeader" style="width: 96px;">
        <div id="jqgh_categories_costOfSale" class="ui-jqgrid-sortable">COS(%)</div>
    </th>
</tr> 
```

并且需要找到有多少个标签具有“disabledHeader”类或至少获取特定类（由id寻址）。

当我做：

```
cl = b.th(:xpath, '//th[@id="categories_convertToSale"]')
cl.exist?
=> true
cl.inspect
=> "#<Watir::TableHeaderCell:0x..f9b976cc1015b866a located=true selector={:xpath=>\"//th[@id=\\\"categories_convertToSale\\\"]\", :tag_name=>\"th\"}>"
cl.class
=> Watir::TableHeaderCell 
```

`cl[@class]`或`cl(:class)`返回错误。

`b.element(:class, "disabledHeader").size`返回方法丢失错误。

如何解决`th-s`这个类的所有问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T21:45:03.550

Zeljko 解决了您关于计算与某些模式匹配的标签数量的问题。

关于获得某物的类别，这取决于您所指的“类别”的风格。

**红宝石类**

Ruby 是一种面向对象的语言，对象由语言中的“类”关键字定义。Watir 利用了这一点，并有一个与 HTML 对象平行的内部对象模型。在 Ruby 中， .class 方法返回对象的类，这是硬连线到语言中的。（实际上，您不会在[watir rDocs](http://rubydoc.info/gems/watir-webdriver/frames)`.class`中的任何地方看到描述的方法）这是您在尝试应该看起来像这样的代码时所做的

```
b.th(:id => "categories_convertToSale").class 
```

=> Watir::TableHeaderCell

它告诉您该`.th`方法返回的对象类是 watir 'TableHeaderCell' （有关更多信息，请参阅 watir rdoc for the TableHeaderCell [Object](http://rubydoc.info/gems/watir-webdriver/Watir/TableHeaderCell) 和/或[.th 方法](http://rubydoc.info/gems/watir-webdriver/Watir/Container#th-instance_method)）

**HTML 类属性**

'class' 的另一种风格是 HTML 类属性，它是 HTML 中几乎所有元素类型的标准属性。为此，您需要使用 watir 的`.attribute_value`方法以及要检查的属性，以获取元素的属性值，或 watir 中的任何对象，例如与 HTML 元素类型平行的 TableHeaderCell。

```
b.th(:id => "categories_totalCost").attribute_value("class") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-16T18:12:10.440

这应该这样做：

```
browser.ths(:class => "disabledHeader").size 
```

# shell - 在命令行显示多个文件的单行

> ID：16043794
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:54:28.980
> 
> 标签：shell

我的问题如下：由于 LaTeX 的精彩，我经常收到行号错误，但没有指示正在引用哪个文件：

```
l.127 \end{table} 
```

是否有一个命令可以让我只看到输出第 127 行，比如说，多个文件（最好使用通配符）。

这可能很容易用 Python 或类似的语言编写，我只是想知道是否有一种简单的方法可以使用常见的 shell 命令。

注意：使用单个文件执行此操作的简单方法是（如下所述）

```
head -n 127 filename | tail -n 1 
```

但这对于多个文件失败。

好的，刚刚意识到 bash 循环是一种选择：

```
for i in `ls $1`;
   do echo $i; head -n $2 $1 | tail -n 1;
done; 
```

用语法执行

```
source lineno.sh 127 filenames 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:10:17.610

还有awk：

```
awk 'FNR==127 {print FILENAME ":" $0; nextfile}' *.tex 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:27:17.177

采购这样的 shell 脚本看起来很有趣。使其可执行并运行它：

```
lineno.sh 127 filenames 
```

`.sh`当我将这些命令放在我的目录中时，我删除了，`$HOME/bin`所以我可以简单地运行：

```
lineno 127 filenames 
```

脚本是次优的；你应该避免`ls`这样使用（如果它们中的任何一个包含空格或其他特殊字符，它会对你的文件名造成极大的伤害）。

```
#!/bin/sh
line=${1:?}  # Complains if there is no $1 or if it is an empty string
shift
for file in "$@"
do
    echo "$file";
    head -n $line "$file" | tail -n 1
done 
```

我可能会加强参数检查（报告正确的用法，坚持至少第二个参数），但它会合理地工作。

# php - 为什么ajax请求失败？

> ID：16043795
> 
> 赞同：0
> 
> 时间：2013-04-16T17:54:37.860
> 
> 标签：php, javascript, jquery, html, ajax

我正在尝试使用下面代码中显示的 url 执行一些计算，每次我在错误中运行代码 alert() 时：正在调用函数。PL帮助

```
$("#button").click(function(){
    $("#form1").validationEngine();
    if($('div input[type=text]').val() != "") {
        var textfield2=document.getElementById("textfield2").value;
        var textarea=document.getElementById("textarea").value;
        var dataS=$("#form1").serialize();
        $.ajax({
            type: "POST",
            url: "http://some_site/ppp.php",
            data:dataS,
            crossDomain: true,
            success: function( ){
                $("#result").empty().html("<h2>Your request has been received </h2>"); 
            },
            error: function(){                          
                alert(dataS);
            }
        });
    }
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:54:52.777

我不会搞乱跨域 POST。我发现 CORS 很难在所有浏览器中可靠地工作。有些浏览器会发送请求但忽略结果，有些甚至不会发送请求，有些会正常工作。

相反，请考虑在同一域上使用 PHP 代理，或者使用带有 JSONP 的 GET 来发送请求。

# python - Python：在函数之间传递变量

> ID：16043797
> 
> 赞同：57
> 
> 时间：2013-04-16T17:54:40.267
> 
> 标签：python, function, arguments

在过去的几个小时里，我在这里和其他地方阅读并进行了实验，但我并没有真正理解我确信是一个非常基本的概念：在不同函数之间传递值（作为变量）。

例如，我将一大堆值分配给一个函数中的列表，然后想稍后在另一个函数中使用该列表：

```
list = []

def defineAList():
    list = ['1','2','3']
    print "For checking purposes: in defineAList, list is",list
    return list

def useTheList(list):
    print "For checking purposes: in useTheList, list is",list

def main():
    defineAList()
    useTheList(list)

main() 
```

根据我对函数参数的作用的理解，我希望这样做如下：

1.  将'list'初始化为空列表；打电话给 main （这，至少，我知道我做对了......）
2.  在 defineAList() 中，将某些值分配到列表中；然后将新列表传递回 main()
3.  在 main() 中，调用 useTheList(list)
4.  由于'list'包含在useTheList函数的参数中，我希望useTheList现在将使用defineAList（）定义的列表，而不是调用main之前定义的空列表。

然而，这显然是一种错误的理解。我的输出是：

```
For checking purposes: in defineAList, list is ['1', '2', '3']
For checking purposes: in useTheList, list is [] 
```

所以，既然“回归”显然没有做我认为的那样，或者至少它没有按照我认为应该的方式去做......它实际上做了什么？您能否使用这个示例向我展示我需要做什么才能从 defineAList() 中获取列表并在 useTheList() 中使用它？当我看到事情发生时，我倾向于更好地理解它们，但是我看到的很多正确参数传递的例子也使用了我还不熟悉的代码，在弄清楚发生了什么的过程中，我我并没有真正掌握这个概念。我正在使用2.7。

ETA-在过去，问了一个类似的问题，有人建议我使用全局变量而不仅仅是局部变量。如果它在这里也是相关的——为了我正在上课的目的，我们不允许使用全局变量。

谢谢！

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-04-16T18:00:39.017

这就是实际发生的事情：

```
global_list = []

def defineAList():
    local_list = ['1','2','3']
    print "For checking purposes: in defineAList, list is", local_list 
    return local_list 

def useTheList(passed_list):
    print "For checking purposes: in useTheList, list is", passed_list

def main():
    # returned list is ignored
    returned_list = defineAList()   

    # passed_list inside useTheList is set to global_list
    useTheList(global_list) 

main() 
```

这就是你想要的：

```
def defineAList():
    local_list = ['1','2','3']
    print "For checking purposes: in defineAList, list is", local_list 
    return local_list 

def useTheList(passed_list):
    print "For checking purposes: in useTheList, list is", passed_list

def main():
    # returned list is ignored
    returned_list = defineAList()   

    # passed_list inside useTheList is set to what is returned from defineAList
    useTheList(returned_list) 

main() 
```

您甚至可以跳过临时`returned_list`并将返回值直接传递给`useTheList`：

```
def main():
    # passed_list inside useTheList is set to what is returned from defineAList
    useTheList(defineAList()) 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-16T17:57:40.480

你只是错过了一个关键步骤。您必须将返回值显式传递给第二个函数。

```
def main():
    l = defineAList()
    useTheList(l) 
```

或者：

```
def main():
    useTheList(defineAList()) 
```

或者（尽管您不应该这样做！起初看起来不错，但从长远来看，全局变量只会让您感到悲伤。）：

```
l = []

def defineAList():
    global l
    l.extend(['1','2','3'])

def main():
    global l
    defineAList()
    useTheList(l) 
```

该函数返回一个值，但它不会像您的代码假定的那样在任何类型的全局命名空间中创建符号。您必须实际捕获调用范围内的返回值，然后将其用于后续操作。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-16T17:58:49.770

`return`返回一个值。你给那个值取什么名字并不重要。归还它只是“传递出去”，以便其他东西可以使用它。如果你想使用它，你必须从外面抓住它：

```
lst = defineAList()
useTheList(lst) 
```

`list`从内部返回`defineAList`并不意味着“让它让程序的整个其余部分都可以使用该变量”。这意味着“将这个变量的值传递出去，让程序的其余部分有机会抓住它并使用它”。您需要将该值分配给函数之外的东西才能使用它。此外，正因为如此，没有必要提前定义您的列表`list = []`。在里面`defineAList`，你创建一个新列表并返回它；`list = []`此列表与您在开始时定义的列表无关。

顺便说一句，我将您的变量名称从 更改`list`为`lst`。用作变量名不是一个好主意，`list`因为这已经是 Python 内置类型的名称。如果您自己创建一个名为 的变量`list`，您将无法再访问内置变量。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-16T17:57:59.403

你的回报是没有用的，如果你不分配它

```
list=defineAList() 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-16T18:03:48.273

阅读名称空间的概念。当您在函数中分配变量时，您只在该函数的命名空间中分配它。但显然你想在所有功能之间使用它。

```
def defineAList():
    #list = ['1','2','3'] this creates a new list, named list in the current namespace.
    #same name, different list!

    list.extend['1', '2', '3', '4'] #this uses a method of the existing list, which is in an outer namespace
    print "For checking purposes: in defineAList, list is",list
    return list 
```

或者，您可以传递它：

```
def main():
    new_list = defineAList()
    useTheList(new_list) 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-01-06T20:34:55.007

可以像这样将一个函数的变量作为参数传递给其他函数

定义这样的函数

```
def function1():
    global a
    a=input("Enter any number\t")

def function2(argument):
    print ("this is the entered number - ",argument) 
```

像这样调用函数

```
function1()
function2(a) 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-05T16:10:48.483

尝试执行以下操作：

```
def funa():
    name=("Bob")
    age=("42")
    return name, age

def funb():
    name, age=funa()
    print(name)
    print(age)

funb() 
```

碰巧你必须通过`funa()`而不是调用它`age`。

# sql - sql中是否有任何类型的通配符以避免更新某些字段？

> ID：16043800
> 
> 赞同：0
> 
> 时间：2013-04-16T17:54:50.793
> 
> 标签：sql, json

我刚刚得到一个预定义的 DERBY 查询。假设 HTML 中的表单输入为空，如果它们为空，我不希望它们被更新，例如“跳过”。我只想更新那些！= 到“”。不知道我说清楚了没有。

我所能想象的就是做这样的事情：

```
UPDATE table_name
   SET username = #[json:username], address = #[json:address]
   WHERE #[json:username] <> '' AND address <> ''; 
```

你们能帮我解决这个问题吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:00:18.250

不，没有-您应该根据输入构建查询（或具有三个变体）。

# c++ - 球体的 DirectX 轨道倾角

> ID：16043801
> 
> 赞同：1
> 
> 时间：2013-04-16T17:54:54.413
> 
> 标签：c++, directx

我正在尝试在 Direct X 中制作太阳系模型。我遇到的问题是让行星的轨道倾角正确显示。以下是我操纵行星的顺序：

*   规模
*   旋转
*   轴向倾斜
*   翻译
*   轨道
*   轨道倾角

我也试过：

*   规模
*   旋转
*   轴向倾斜
*   翻译
*   轨道倾角
*   轨道

我已经存储了轨道倾角的数据（即火星的轨道倾角为 1.85 度）。

当我对 Z 或 X 轴进行旋转时，行星只是向上移动，并在太阳上方旋转，而不是在相对于 x 轴的轨道上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:55:09.637

如评论中所述，矩阵应如下所示：

*   `Orbital inclination`- 绕 z 轴旋转
*   `Orbit`- 绕 y 轴旋转
*   `Translate`- 沿 x 轴的平移

# php - 如何编写这个 mysql 查询

> ID：16043802
> 
> 赞同：-4
> 
> 时间：2013-04-16T17:54:56.670
> 
> 标签：php, mysql

我正在开发一个社交网络功能的网站，该网站有一个部分，比如你可能知道的 facebook 人，其中包括不是登录用户朋友的人。

表 1“用户”结构：uid(primary)、fname、lname、dob 等。

表 2 'friend_request' 结构：id(primary) uid、fid、created

表 3 'friends' 结构：与 'friend_request' 相同

我想向登录用户和他/她的朋友以外的人展示。因为我想保持简单。

MYSQL查询如下：

```
 <?php 
   /*
   section for displaying random person who are not friends.
   */
   $q =mysql_query("select * from users where uid!='".$_SESSION["logged"]."'");
   if(mysql_num_rows($q)>0)
     {
        while($fetch=mysql_fetch_array($q))
     {

    $sel=mysql_query("select * from friends where (uid='".$fetch["uid"]."' and
        fid!='".$_SESSION["logged"]."') or                    
     (uid!='".$_SESSION["logged"]."' and fid='".$fetch["uid"]."')") or   
          die(mysql_error());

      $num_rows=mysql_num_rows($sel);
      if($num_rows>0)
        {
        while($rows=mysql_fetch_array($sel))
         {

        $que=mysql_query("select * from users where uid='".$rows['uid']."' or
          uid='".$rows['fid']."'");                    
         if(mysql_num_rows($que)>0)
           {
            while($names=mysql_fetch_array($que))

            {

              ?>
        <li><a href="user_index1.php?id=<?php echo $names['uid']; ?>"><strong>
       <?php echo $names['fname']." ".$names['lname'] ?></strong></a></li>
       <?php }
        }
       }
      }
     }
    }
  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:16:16.750

你有没有尝试过：

```
$sql = "SELECT * FROM `users`
        WHERE `id` NOT IN 
            (SELECT `fid` FROM `friends` WHERE `uid` = ".$_SESSION["logged"].")
        AND `id` != ".$_SESSION["logged"].";";

$que = mysql_query($sql); 
```

* * *

根据你的评论，我认为是错过了彼此的理解。我在我的 MySQL 数据库中重新创建了以下表，如下所示：

**用户**

```
id    fname    lname
1      Bob1     One
2      Bob2     Two
3      Bob3     Three
4      Bob4     Four
5      Bob5     Five 
```

**朋友们**

```
id    uid     fid
1      5       2
2      5       3
3      3       1
4      2       1
5      2       4 
```

然后当我运行以下查询时：

```
SELECT * FROM `users`
WHERE `id` NOT IN 
    (SELECT `fid` FROM `friends` WHERE `uid` = 1)
AND `id` != 1 
```

我得到以下结果：

```
uid    fname    lname
2      Bob2     Two
3      Bob3     Three
4      Bob4     Four
5      Bob5     Five 
```

你能向我解释为什么这不是你要找的吗？或者我没有错误地将数据输入数据库？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T20:10:03.340

解决方案是：

```
 SELECT * FROM `users` WHERE `uid` NOT IN 
   (SELECT `uid` FROM `friends` WHERE `uid` = 1 or 'fid' = 1 union SELECT `fid` FROM 'friends' WHERE 'uid'=1 or 'fid'=1)
   AND `uid` != 1; 
```

这将显示不包含 uid=1 朋友的人，不包括登录用户。感谢@RachelID 的建议。

# twitter-bootstrap - 为什么我的加载 Bootstrap 模式背景加载在页面内容的其余部分之后？

> ID：16043810
> 
> 赞同：0
> 
> 时间：2013-04-16T17:55:12.723
> 
> 标签：twitter-bootstrap, modal-dialog, onload

我的 Bootstrap 模式首先使用以下代码加载到页面上：

```
$(window).load(function(){
$('#myModal').modal('show');
}); 
```

问题是模态背景和它的 css 动画在整个页面加载后加载，因此在模态加载后有点延迟。如何避免这种情况并在模态之后立即加载背景而不是等待整个页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T18:40:41.200

`window.onload`等待所有图像加载。准备好使用文档

```
$(function(){
    $('#myModal').modal('show');
}); 
```

或删除隐藏类并忘记 JavaScript

# c++ - 如何将输入读入 c++ 中的数组？

> ID：16043812
> 
> 赞同：-9
> 
> 时间：2013-04-16T17:55:18.790
> 
> 标签：c++

```
#include<iostream>
Using namespace std;
int main() {
    int i;
    char array[5];
    for (i = 0; i < 5; i++) {
        cin >> array[i];
    }
    for (i = 0; i; < 5; i++) {
        cout << array[i] << endl;
    }
    return 0;
} 
```

这是我的代码。我面临一些编译错误。请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T17:56:49.167

```
Using namespace std;
 //^^typo?: results in syntax error. no keyword `Using` in C++ 
```

应该：

```
using namespace std; 
```

顺便说一句：您不应该更喜欢放在`using namespace std`头文件或源文件的开头，而是尝试使用： `std::cout`和`std::endl`.

# c++ - 模板类中的 typedef-type 给出编译错误

> ID：16043813
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:55:19.480
> 
> 标签：c++, templates

真实代码，剥离到最简单的相关部分：

## 第三方代码

```
template<class T>
class Ptr
{
private:

    typedef Ptr this_type;

public:

    typedef T element_type;
}; 
```

* * *

```
typedef Ptr<DataSet> DataSetPtr; 
```

* * *

## 我的代码 - GPtr.h

```
template<class BaseType>
class GPtr
{
    ///force BaseType to be a Ptr or subclass
    typedef BaseType::element_type WrappedType;
public:
    ...
}; 
```

如果我删除`BaseType::element_type`对它的引用编译正常，但在我得到编译警告/错误：

*   警告 C4346：“BaseType::element_type”：从属名称不是带有“typename”以指示类型的类型前缀
*   错误 C2146：语法错误：缺少“；” 在标识符“WrappedType”之前

我什至没有在我的代码中*使用* `GPtr`任何地方作为特定的模板类型......简单地包括 gptr.h 会导致问题。

这里有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:57:36.913

您必须使用`typename`消歧器：

```
typedef typename BaseType::element_type WrappedType;
//      ^^^^^^^^^ 
```

没有它，编译器将不会解析`element_type`为*type*的名称。

# weka - 交叉验证和单独的“提供的测试集”

> ID：16043817
> 
> 赞同：1
> 
> 时间：2013-04-16T17:55:36.673
> 
> 标签：weka, cross-validation

执行 10 折交叉验证后，使用单独的“提供的测试集”进行重新评估是否合适？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:35:10.243

当然，为什么不呢。您拥有的数据集越多越好。首先，拥有单独的数据集的目的是避免您学习的模型过度拟合数据，并对模型的性能产生误导性印象。使用单独的测试集和交叉验证等技术可确保您更准确、更合理地了解模型的性能。

单独的测试集可用于确认交叉验证期间计算的性能估计。

# jquery - 响应式导航 - 如何在浏览器最小化时打开/关闭导航

> ID：16043818
> 
> 赞同：2
> 
> 时间：2013-04-16T17:55:39.093
> 
> 标签：jquery, html, css, responsive-design

我正在制作自己的响应式导航：http: [//www.hongkiat.com/blog/responsive-web-nav/](http://www.hongkiat.com/blog/responsive-web-nav/)

这是我的小提琴：http: [//jsfiddle.net/2Pqch/](http://jsfiddle.net/2Pqch/)

当窗口最小化并且您按下打开/关闭按钮时，我希望能够通过单击按钮或单击导航外部来关闭它。

如何添加此功能？

这是脚本：

```
$(function() {
            var pull        = $('.btn');
                menu        = $('nav ul');
                menuHeight  = menu.height();

            $(pull).on('click', function(e) {
                e.preventDefault();
                menu.slideToggle();
            });

            $(window).resize(function(){
                var w = $(window).width();
                if(w > 320 && menu.is(':hidden')) {
                    menu.removeAttr('style');
                }
            });
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:08:22.213

你可以这样做：

[http://jsfiddle.net/2Pqch/1/](http://jsfiddle.net/2Pqch/1/)

我添加`e.stopPropagation();`以阻止事件冒泡并添加

```
 $(document).on('click',function(e){
            if(!menu.is(":hidden")){
                menu.slideToggle();
            }
        }); 
```

它检查菜单是否隐藏，如果未隐藏，单击`document`将再次关闭菜单。执行此操作的更好方法可能是定位内容容器以提示关闭，因为单击内容容器上的任何位置`document`都会关闭它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:15:45.383

检测是否单击了导航或窗口，如果单击导航，则切换导航。
否则，如果导航已打开并单击窗口，则切换导航。

      **演示** [http://jsfiddle.net/2Pqch/2/](http://jsfiddle.net/2Pqch/2/)

```
var clickedOnMenu = false;              

$(pull).on('click', function(e) {
    e.preventDefault();
    clickedOnMenu = true;                     
        });

    $(window).on('click', function(e) {

        if(clickedOnMenu)
        {
            menu.slideToggle();
            clickedOnMenu = false;
        }
        else if ((menu).is(":visible")) {
        menu.slideToggle();
      } 
    }); 
```

# java - JUNIT测试void方法

> ID：16043819
> 
> 赞同：71
> 
> 时间：2013-04-16T17:55:44.197
> 
> 标签：java, junit

我有一个充满 void 方法的 java 类，我想进行一些单元测试以获得最大的代码覆盖率。

例如我有这个方法：

```
protected static void checkifValidElements(int arg1,  int arg2) {
    method1(arg1);
    method2(arg1);
    method3(arg1, arg2);
    method4(arg1, arg2);
    method5(arg1);
    method6(arg2);
    method7();
} 
```

它的名字不好是有原因的，因为我翻译了代码以便更好地理解。每种方法都验证参数是否以某种方式有效并且编写得很好。

例子 ：

```
private static void method1(arg1) {
    if (arg1.indexOf("$") == -1) {

        //Add an error message 
        ErrorFile.errorMessages.add("There is a dollar sign in the specified parameter");
    }
} 
```

我的单元测试很好地涵盖了小方法，因为我要求他们检查 ErrorFile 是否包含错误消息，但是我看不到如何测试我的方法 checkIfValidElements，它什么也不返回或什么也不改变。当我使用 Maven 运行代码覆盖率时，它告诉我单元测试并没有涵盖我课程的这一部分。

我看到的唯一方法是更改​​此方法以返回 int 或 bolean 值，如下所示：

```
protected static int checkifValidElements(int arg1,  int arg2) {
    method1(arg1);
    method2(arg1);
    method3(arg1, arg2);
    method4(arg1, arg2);
    method5(arg1);
    method6(arg2);
    method7();
    return 0;
} 
```

使用这种方法，我可以进行断言等于，但在我看来，这样做是徒劳的。问题是我有几个这样设计的类，它降低了我的单元测试覆盖率。

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2013-04-16T18:00:06.757

> 我想做一些单元测试以获得最大的代码覆盖率

代码覆盖率永远不应该是编写单元测试的*目标*。您应该编写单元测试来证明您的代码是正确的，或者帮助您更好地设计它，或者帮助其他人理解代码的用途。

> 但我看不到如何测试我的方法 checkIfValidElements，它什么也不返回或什么也不改变。

好吧，您可能应该进行一些测试，在它们之间检查是否正确调用了所有 7 个方法 - 使用无效参数和有效参数，检查`ErrorFile`每次的结果。

例如，假设有人删除了对以下内容的调用：

```
method4(arg1, arg2); 
```

...或意外更改了参数顺序：

```
method4(arg2, arg1); 
```

你会如何注意到这些问题？从那开始，设计测试来证明它。

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-04-16T19:22:16.753

如果您的方法没有副作用，并且没有返回任何内容，那么它什么也没有做。

如果您的方法进行一些计算并返回该计算的结果，那么您显然可以断言返回的结果是正确的。

如果您的代码没有返回任何内容但确实有副作用，您可以调用该代码，然后断言发生了正确的副作用。副作用是什么将决定您如何进行检查。

在您的示例中，您正在从非返回函数调用静态方法，这使得它变得棘手，除非您可以检查所有这些静态方法的结果是否正确。从测试的角度来看，更好的方法是在您调用方法的地方注入实际对象。然后，您可以使用 EasyMock 或 Mockito 之类的东西在单元测试中创建一个模拟对象，并将模拟对象注入到类中。然后，模拟对象让您断言调用了正确的函数，具有正确的值和正确的顺序。

例如：

```
private ErrorFile errorFile;

public void setErrorFile(ErrorFile errorFile) {
    this.errorFile = errorFile;
}

private void method1(arg1) {
    if (arg1.indexOf("$") == -1) {

        //Add an error message 
        errorFile.addErrorMessage("There is a dollar sign in the specified parameter");
    }
} 
```

然后在你的测试中你可以写：

```
public void testMethod1() {
    ErrorFile errorFile = EasyMock.createMock(ErrorFile.class);
    errorFile.addErrorMessage("There is a dollar sign in the specified parameter");
    EasyMock.expectLastCall(errorFile);
    EasyMock.replay(errorFile);

    ClassToTest classToTest = new ClassToTest();
    classToTest.setErrorFile(errorFile);
    classToTest.method1("a$b");

    EasyMock.verify(errorFile); // This will fail the test if the required addErrorMessage call didn't happen
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-16T18:00:12.360

您仍然可以通过断言它具有适当的副作用来对 void 方法进行单元测试。在您的`method1`示例中，您的单元测试可能类似于：

```
public void checkIfValidElementsWithDollarSign() {
    checkIfValidElement("$",19);
    assert ErrorFile.errorMessages.contains("There is a dollar sign in the specified parameter");
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-11-05T15:30:37.097

你可以学习一些叫做“嘲笑”的东西。例如，您可以使用它来检查是否： - 调用函数 - 调用函数 x 次 - 调用函数至少 x 次 - 使用特定参数集调用函数。例如，在您的情况下，您可以使用模拟来检查 method3 是否被调用过一次，无论您作为 arg1 和 arg2 传递什么。

看看这些： [https ://code.google.com/p/mockito/](https://code.google.com/p/mockito/) [https://code.google.com/p/powermock/](https://code.google.com/p/powermock/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-16T18:06:02.547

我认为你应该避免写副作用的方法。从您的方法返回 true 或 false，您可以在单元测试中检查这些方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-04-17T11:56:18.393

如果您的方法无效并且您想检查异常，您可以使用`expected`： [https ://weblogs.java.net/blog/johnsmart/archive/2009/09/27/testing-exceptions-junit-47](https://weblogs.java.net/blog/johnsmart/archive/2009/09/27/testing-exceptions-junit-47)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-04-09T11:46:14.150

如果在您的情况下可能，您可以使您的方法`method1(arg1)`... `method7()` *受保护*而不是*私有*，这样它们就可以从同一包中的测试类中访问。然后您可以简单地分别测试所有这些方法。

# mongodb - 从 mongodb 迁移到 firebase

> ID：16043822
> 
> 赞同：15
> 
> 时间：2013-04-16T17:55:49.517
> 
> 标签：mongodb, firebase

我的应用程序目前使用 mongodb，我期待将其迁移到 firebase。

做起来有多容易，有什么我需要注意的。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-16T19:13:47.710

鉴于 MongoDB 和 Firebase 本质上都是非关系型的，因此您的大部分数据都应该干净地映射到 Firebase。Firebase REST 端点支持常规 JSON，因此将您的数据输入（以及，如果您选择退出）也应该很容易。您需要注意的主要领域是：

1.  Firebase API 本质上是实时/异步的；具体来说，当客户端正在读取数据时。将后端请求/响应代码迁移到客户端并使用这种方法可能是工作量最大的领域。
2.  MongoDB 和 Firebase 提供的功能集也会存在差异；值得注意的领域包括 Mongo 对 MapReduce、Cursors 和自由文本查询等操作的支持（Firebase 目前不支持这些领域）。

要记住的另一件事是，Firebase 不是一种全有或全无的事业。应用程序绝对可以零碎地利用实时、缩放和平台功能。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-30T09:12:11.840

没有具体回答这个问题，但是如果您发现 Firebase 缺少一些您习惯于使用 Mongo 的功能 -

我找到了一个节点包，它允许您将 Firebase 作为主数据库运行。

**火力基地**

*   安全/认证
*   插座

**MongoDB**

*   查询
*   索引
*   聚合

[https://www.npmjs.org/package/mongofb](https://www.npmjs.org/package/mongofb)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-09-30T10:12:39.730

Firebase 不是将所有数据都存储在 MongoDB 中吗？

*2016 年 5 月更新*

显然，MongoDB 网站中提到 Firebase 的页面已被删除（[http://www.mongodb.org/about/production-deployments/](http://www.mongodb.org/about/production-deployments/)）

在他们的网站上进行了一些搜索后，我在他们的博客 [https://www.mongodb.com/post/45270275688/mongodbs-growth-ecosystem](https://www.mongodb.com/post/45270275688/mongodbs-growing-ecosystem) ( [mirror](https://web.archive.org/web/20160706104439/https://www.mongodb.com/post/45270275688/mongodbs-growing-ecosystem) ) 中找到了另一个页面，他们说：

> 很高兴看到这么多公司在 MongoDB 上构建。这里仅仅是少数：
> 
> *   **模数**。作为 Node.js 平台即服务 (PaaS) 产品，Modulus 将 MongoDB 作为其默认数据存储。这遵循Meteor 和**Firebase****的相关产品**。

 **MongoDB 的替代方案是 RethinkDB，最近 RethinkDB 背后的团队[发布了](https://rethinkdb.com/blog/horizon-release/) [Horizo](http://horizon.io/) ​​n ，这是一个基于 NodeJS 的开源后端平台，它是一种本地托管的 Firebase。这是[关于 Horizo​​n 的精彩演讲](https://www.youtube.com/watch?v=H2PKS8GMsn0)。**

# sql - SQL 声明主键或主键约束

> ID：16043829
> 
> 赞同：2
> 
> 时间：2013-04-16T17:56:00.910
> 
> 标签：sql, oracle, constraints, primary-key

在 Oracle SQL 中，将字段声明为 PRIMARY KEY 有什么区别

```
CREATE TABLE my_tab (
my_var NUMBER PRIMARY KEY,
... 
```

并在表定义的末尾添加一个约束？什么时候应该使用一个而不是另一个？另外，上面的代码中是否需要在 PRIMARY KEY 之前包含 NOT NULL ？

我环顾四周，似乎找不到任何明确的答案来说明为什么我应该使用一个而不是另一个。希望有人可以澄清这一点。谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-16T18:05:37.020

就您的示例而言，没有区别：每个都将成`my_var`为主键。

也就是说，存在一些普遍的差异。想到的两个：

1.  当您将`PRIMARY KEY`单独定义为 a`CONSTRAINT`时，您可以为约束分配一个名称，而使用内联`my_var ... PRIMARY KEY`Oracle 将生成一个名称。

2.  当您`PRIMARY KEY`单独定义时，您可以定义由多个列组成的 PK。

* * *

**附录**：我在帖子中错过了这个问题：

*另外，上面的代码中是否需要在 PRIMARY KEY 之前包含 NOT NULL ？*

答案是：它不需要包含在内，但请注意 Oracle 会自动创建列，`NOT NULL`因为它不允许 PK 值中出现空值。这是一个使用示例`SQLPlus`：

```
SQL> CREATE TABLE c (col1 NUMBER PRIMARY KEY, col2 NUMBER);
Table created.

SQL> DESC c

Name  Null?    Type
----- -------- ------
COL1  NOT NULL NUMBER <-- Oracle automatically made this NOT NULL
COL2           NUMBER 
```

即使您指定`NULL`，Oracle 也会自动将其更改为`NOT NULL`：

```
SQL> CREATE TABLE d (col1 NUMBER NULL PRIMARY KEY, col2 NUMBER);
Table created.

SQL> desc d;
 Name  Null?    Type
 ----- -------- ------
 COL1  NOT NULL NUMBER <-- Oracle automatically made it NOT NULL again
 COL2           NUMBER 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T18:05:15.563

关于约束的[文档](http://docs.oracle.com/cd/B19306_01/server.102/b14200/clauses002.htm)确实涵盖了这一点。

第一种方法称为“内联”。第二种叫做“出格”。

只有一个真正的区别。如果您的主键有多个键，那么您需要使用“out of line”语法。否则，他们会做同样的事情。

# r - 用因素重塑

> ID：16043830
> 
> 赞同：1
> 
> 时间：2013-04-16T17:56:05.340
> 
> 标签：r, reshape

我正在尝试使用熔化和铸造过程重塑包含一个因子和一个数字变量的数据框。以下数据显示了我的问题：

```
library(reshape)

df <- as.data.frame(cbind(c(1,1,2,2,3,3),c(2000,2001,2001,2002,2000,2001),c(2,1,4,3,1,5)))   
names(df) <- c("Id","Year","Var")

df$Fac <- interaction(c(1,1,1,0,0,0),c(0,0,0,1,1,1),drop=TRUE)

MData <- melt.data.frame(df,id=c("Year","Id"))
RSData <- cast(MData, Id ~ Year | ...) 
```

该操作有效，但 RSData 中缺少的观察结果不是应有的 NA，而是字符串（< NA> 而不是 NA）：

```
$Var
  Id 2000 2001 2002
1  1    2    1 <NA>
2  2 <NA>    4    3
3  3    1    5 <NA>

$Fac
  Id 2000 2001 2002
1  1  1.0  1.0 <NA>
2  2 <NA>  1.0  0.1
3  3  0.1  0.1 <NA> 
```

但是，如果我忽略 NA 是正常 NA 的因素：

```
df <- as.data.frame(cbind(c(1,1,2,2,3,3),c(2000,2001,2001,2002,2000,2001),c(2,1,4,3,1,5)))   
names(df) <- c("Id","Year","Var")

MData <- melt.data.frame(df,id=c("Year","Id"))
RSData <- cast(MData, Id ~ Year | ...) 
```

输出变为：

```
$Var
  Id 2000 2001 2002
1  1    1    1   NA
2  2   NA    1    0
3  3    0    0   NA 
```

当我尝试使用我的重铸数据时，字符串 NA 给我带来了问题。当我想要融化和重铸的数据框中有一个因子和数值变量时，如何获得正确的 NA？

谢谢，

米

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-06T16:02:12.037

我相信通过一遍又一遍地阅读评论和文档，我已经找到了自己问题的答案。基本上，问题在于，当使用 melt.data.frame() 方法时，所有变量值都放在 1 列中，并且由于我有字符串和数值，所以数值被隐式转换为字符串。

我看到的唯一解决方法是分别重塑数字变量和因子：

```
MDataNum = melt.data.frame(df[c("Id","Year","Var")],id=c("Year","Id"))
RSDataNum <- cast(MDataNum, Id ~ Year | ...)

MDataFac = melt.data.frame(df[c("Id","Year","Fac")],id=c("Year","Id"))
RSDataFac <- cast(MDataFac, Id ~ Year | ...) 
```

结果变为：

```
> RSDataNum 
$Var
  Id 2000 2001 2002
1  1    2    1   NA
2  2   NA    4    3
3  3    1    5   NA

> RSDataFac 
$Fac
  Id 2000 2001 2002
1  1  1.0  1.0 <NA>
2  2 <NA>  1.0  0.1
3  3  0.1  0.1 <NA> 
```

# iphone - 如何使标签加载内容位于网站上？

> ID：16043833
> 
> 赞同：2
> 
> 时间：2013-04-16T17:56:10.830
> 
> 标签：iphone, cocoa-touch, label

我想制作一个标签，表明乐队是否正在巡演（系统的向下 fyi）

所以我希望界面中的标签可以调整为我的服务器上给定的值。（因此它需要从 (.html) 文件中提取数据并将其显示为标签。）

在我看来，WebView 很混乱，标签看起来更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T22:05:26.787

我建议使用 AFNetworking - [http://afnetworking.com/](http://afnetworking.com/)。它将允许您从服务器中提取数据。

例如，您可以创建一个包含所需数据的 XML 文件。然后你可以使用 NSXMLParser 解析它并对数据做任何你需要的事情。

### 例子：

```
NSURL *feedURL = [[NSURL alloc] initWithString:@"http://yourserver.com/yourxmlfile.xml"];
NSURLRequest *feedRequest = [[NSURLRequest alloc] initWithURL:feedURL];
AFXMLRequestOperation *feedOperation = [AFXMLRequestOperation XMLParserRequestOperationWithRequest:feedRequest success:^(NSURLRequest *request, NSHTTPURLResponse *response, NSXMLParser *XMLParser) {
    NSLog(@"XMLRequest successful - starting parser..");
    [XMLParser setDelegate:self];
    [XMLParser parse];
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, NSXMLParser *XMLParser) {
    UIAlertView *connectionError = [[UIAlertView alloc] initWithTitle:@"Connection Error" message:error.localizedDescription delegate:nil cancelButtonTitle:@"Dismiss" otherButtonTitles:nil, nil];
    [connectionError show];
}]; 
```

### XML 示例：

这是您将上传到服务器的文件。我使用 中的标题`yourxmlfile.xml`，`AFXMLRequestOperation`但可以随意命名。

```
<?xml version="1.0"?>
<band>
    <bandname>The Band</bandname>
    <bandontour>1</bandontour>
</band> 
```

### 使用 NSXMLParser（委托）

创建一个 ivar（在您的 .h 中）以在解析数据时保存数据。

```
@property (nonatomic, retain) NSString *currentProperty; 
```

这将暂时保存元素数据，然后当解析器到达`didEndElement`.

```
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict {    
    if ([elementName isEqualToString:@"bandontour"]) {
        // found the <bandontour> tag
    }    
}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    self.currentProperty = string;
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName {
    if ([elementName isEqualToString:@"bandontour"]) {
        // finished getting the data in <bandontour>

        // do something now that you've got your data retrieved
        if (self.currentProperty) int bandOnTour = self.currentProperty.intValue;
        if (bandOnTour == 1) self.yourLabel.text = @"Band is on tour!";
        else self.yourLabel.text = @"Not on tour.";
    }  
} 
```

有关更多信息，请参阅[NSXMLParser 类参考](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSXMLParser_Class/Reference/Reference.html)。

# c - 如果我使用睡眠，为什么测量的网络延迟会发生变化？

> ID：16043843
> 
> 赞同：11
> 
> 时间：2013-04-16T17:56:36.883
> 
> 标签：c, linux, sockets, network-programming, netbsd

我正在尝试确定机器接收数据包、处理数据包并返回答案所需的时间。

这台机器，我称之为“服务器”，运行一个非常简单的程序，它在缓冲区中接收数据包（`recv(2)`），将接收到的内容（`memcpy(3)`）复制到另一个缓冲区，然后将数据包发回（`send(2)`）。服务器运行 NetBSD 5.1.2。

我的客户多次测量往返时间（`pkt_count`）：

```
struct timespec start, end;
for(i = 0; i < pkt_count; ++i)
{
    printf("%d ", i+1);

    clock_gettime(CLOCK_MONOTONIC, &start);        
    send(sock, send_buf, pkt_size, 0);
    recv(sock, recv_buf, pkt_size, 0);
    clock_gettime(CLOCK_MONOTONIC, &end);        

    //struct timespec nsleep = {.tv_sec = 0, .tv_nsec = 100000};
    //nanosleep(&nsleep, NULL);

    printf("%.3f ", timespec_diff_usec(&end, &start));
} 
```

为了清楚起见，我删除了错误检查和其他小事。客户端在 Ubuntu 12.04 64 位上运行。这两个程序都以实时优先级运行，尽管只有 Ubuntu 内核是实时的 (-rt)。程序之间的连接是 TCP。这工作正常，平均给我 750 微秒。

但是，如果我启用注释掉的 nanosleep 调用（睡眠时间为 100 µs），我的测量值会下降 100 µs，平均为 650 µs。如果我睡了 200 µs，测量值会下降到 550 µs，依此类推。这一直持续到 600 µs 的睡眠，平均为 150 µs。然后，如果我将睡眠时间提高到 700 µs，我的测量值平均会上升到 800 µs。我用 Wireshark 确认了我的程序的措施。

我无法弄清楚发生了什么。我已经在客户端和服务器中设置了 TCP_NODELAY 套接字选项，没有区别。我使用了UDP，没有区别（相同的行为）。所以我猜这种行为不是由于 Nagle 算法。会是什么呢？

**[更新]**

这是客户端与 Wireshark 一起输出的屏幕截图。现在，我在另一台机器上运行我的服务器。我使用具有相同配置的相同操作系统（因为它是笔式驱动器中的 Live System），但硬件不同。这种行为没有出现，一切都按预期工作。但问题仍然存在：为什么它会发生在以前的硬件中？

![输出比较](https://i.stack.imgur.com/vW02b.png)

**[更新 2：更多信息]**

正如我之前所说，我在两台不同的服务器计算机上测试了我的一对程序（客户端/服务器）。我绘制了获得的两个结果。

![两台服务器之间的比较](https://i.stack.imgur.com/ceutV.png)

第一台服务器（奇怪的）是一台[RTD 单板计算机](http://www.rtd.com/PC104/CM/CMX32/CMX32MVD.htm)，具有 1Gbps 以太网接口。第二台服务器（普通服务器）是具有 100Mbps 以太网接口的[Diamond 单板计算机。](http://www.diamondsystems.com/products/rhodeus)他们都从相同的 pendrive 运行相同的操作系统 (NetBSD 5.1.2)。

从这些结果来看，我确实相信这种行为是由于驱动程序或网卡本身造成的，尽管我仍然无法想象为什么会发生这种情况......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-05T20:50:01.730

好的，我得出了一个结论。

我在服务器中使用 Linux 而不是 NetBSD 尝试了我的程序。它按预期运行，即无论我在代码的那个点[nano]睡了多少，结果都是一样的。

这个事实告诉我，问题可能出在 NetBSD 的接口驱动程序上。为了识别驱动程序，我读取了`dmesg`输出。这是相关部分：

```
wm0 at pci0 dev 25 function 0: 82801I mobile (AMT) LAN Controller, rev. 3
wm0: interrupting at ioapic0 pin 20
wm0: PCI-Express bus
wm0: FLASH
wm0: Ethernet address [OMMITED]
ukphy0 at wm0 phy 2: Generic IEEE 802.3u media interface
ukphy0: OUI 0x000ac2, model 0x000b, rev. 1
ukphy0: 10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, 1000baseT, 1000baseT-FDX, auto 
```

所以，如你所见，我的接口被称为`wm0`. 根据[这个](http://ftp.netbsd.org/pub/NetBSD/misc/ddwg/NetBSD-driver_writing-1.0.1e.pdf)（第 9 页），我应该通过查阅文件`sys/dev/pci/files.pci`第 625 行（[此处](http://fxr.watson.org/fxr/source/dev/pci/files.pci?v=NETBSD5#L625)）来检查加载了哪个驱动程序。表明：

```
# Intel i8254x Gigabit Ethernet
device  wm: ether, ifnet, arp, mii, mii_bitbang
attach  wm at pci
file    dev/pci/if_wm.c         wm 
```

然后，搜索驱动程序源代码（`dev/pci/if_wm.c`，[这里](http://fxr.watson.org/fxr/source/dev/pci/if_wm.c?v=NETBSD5#L3888)），我发现了一段可能会改变驱动程序行为的代码片段：

```
/*
 * For N interrupts/sec, set this value to:
 * 1000000000 / (N * 256).  Note that we set the
 * absolute and packet timer values to this value
 * divided by 4 to get "simple timer" behavior.
 */

sc->sc_itr = 1500;              /* 2604 ints/sec */
CSR_WRITE(sc, WMREG_ITR, sc->sc_itr); 
```

然后我将这个 1500 值更改为 1（试图增加每秒允许的中断数）和 0（试图完全消除中断限制），但这两个值产生了相同的结果：

*   没有 nanosleep：延迟约为 400 us
*   具有 100 us 的 nanosleep：约 230 us 的延迟
*   具有 200 us 的 nanosleep：延迟约 120 us
*   具有 260 us 的 nanosleep：约 70 us 的延迟
*   使用 270 us 的 nanosleep：延迟约 60 us（我可以达到的最小延迟）
*   任何超过 300 us 的 nanosleep：~420 us

这至少比以前的情况表现得更好。

因此，我得出结论，该行为是由于服务器的接口驱动程序造成的。我不愿意进一步调查它以找到其他罪魁祸首，因为我正在从 NetBSD 转移到 Linux 以完成涉及这台单板计算机的项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T13:29:28.597

我对如何创建更准确的绩效衡量有一个建议。使用 RDTSC 指令（甚至更好的内在 __rdtsc() 函数）。这涉及在不离开 ring3 的情况下读取 CPU 计数器（无系统调用）。gettime 函数几乎总是涉及减慢速度的系统调用。

您的代码有点棘手，因为它涉及 2 个系统调用（发送/接收），但通常最好在第一次测量之前调用 sleep(0) 以确保非常短的测量不会收到上下文切换。当然，时间测量（和 Sleep()）代码应该通过性能敏感函数中的宏禁用/启用。

一些操作系统可以通过让你的进程释放它的执行时间窗口来提高你的进程优先级（例如sleep(0)）。在下一个计划滴答声中，操作系统（不是全部）将提高您的进程的优先级，因为它没有完成运行其执行时间配额。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-11T09:28:23.357

我认为“量子”是最好的解释理论。在 linux 上，它是上下文切换频率。内核提供处理量子时间。但是进程在两种情况下被抢占：

1.  进程调用系统过程
2.  量子时间结束
3.  硬件中断即将到来（来自网络、硬盘、USB、时钟等...）

未使用的量子时间分配给另一个准备运行的进程，使用优先级/rt等。

实际上上下文切换频率配置为每秒 10000 次，它为 quanta 提供了大约 100us。但内容切换需要时间，这取决于 cpu，请参阅： [http](http://blog.tsunanet.net/2010/11/how-long-does-it-take-to-make-context.html) ://blog.tsunanet.net/2010/11/how-long-does-it-take-to-make-context.html 我不明白，为什么内容交换频率那么高，但它是 linux 内核论坛的讨论。

您可以在这里找到部分类似的问题： [https ://serverfault.com/questions/14199/how-many-context-switches-is-normal-as-a-function-of-cpu-cores-or-other](https://serverfault.com/questions/14199/how-many-context-switches-is-normal-as-a-function-of-cpu-cores-or-other)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-28T11:53:15.440

这是一个（希望是受过教育的）猜测，但我认为它可以解释你所看到的。

我不确定linux内核的实时性。它可能不是完全先发制人的......所以，带着这个免责声明，继续:)......

根据调度程序，一个任务可能会有所谓的“量子”，这只是在另一个相同优先级的任务将被调度之前它可以运行的时间量。如果内核不是完全抢占式的，这也可能是更高优先级任务可以运行的点。这取决于我不太了解的调度程序的详细信息。

在您的第一次 gettime 和第二次 gettime 之间的任何时间，您的任务都可能被抢占。这只是意味着它被“暂停”并且另一个任务在一定时间内使用 CPU。

没有睡眠的循环可能会像这样

```
clock_gettime(CLOCK_MONOTONIC, &start);        
send(sock, send_buf, pkt_size, 0);
recv(sock, recv_buf, pkt_size, 0);
clock_gettime(CLOCK_MONOTONIC, &end);  

printf("%.3f ", timespec_diff_usec(&end, &start));

clock_gettime(CLOCK_MONOTONIC, &start);        

<----- PREMPTION .. your tasks quanta has run out and the scheduler kicks in
       ... another task runs for a little while     
<----- PREMPTION again and your back on the CPU

send(sock, send_buf, pkt_size, 0);
recv(sock, recv_buf, pkt_size, 0);
clock_gettime(CLOCK_MONOTONIC, &end);  

// Because you got pre-empted, your time measurement is artifically long
printf("%.3f ", timespec_diff_usec(&end, &start));

clock_gettime(CLOCK_MONOTONIC, &start);        

<----- PREMPTION .. your tasks quanta has run out and the scheduler kicks in
       ... another task runs for a little while     
<----- PREMPTION again and your back on the CPU

and so on.... 
```

当您将纳秒睡眠置于其中时，这很可能是调度程序能够在当前任务的量子到期之前运行的点（这同样适用于 recv() ，它会阻塞）。所以也许你得到的是这样的

```
clock_gettime(CLOCK_MONOTONIC, &start);        
send(sock, send_buf, pkt_size, 0);
recv(sock, recv_buf, pkt_size, 0);
clock_gettime(CLOCK_MONOTONIC, &end);  

struct timespec nsleep = {.tv_sec = 0, .tv_nsec = 100000};
nanosleep(&nsleep, NULL);

<----- PREMPTION .. nanosleep allows the scheduler to kick in because this is a pre-emption point
       ... another task runs for a little while     
<----- PREMPTION again and your back on the CPU

// Now it so happens that because your task got prempted where it did, the time
// measurement has not been artifically increased. Your task then can fiish the rest of 
// it's quanta
printf("%.3f ", timespec_diff_usec(&end, &start));

clock_gettime(CLOCK_MONOTONIC, &start);        
... and so on 
```

然后会发生某种交错，有时您会在两个 gettime() 之间被抢占，有时由于 nanosleep 而在它们之外。根据 x，您可能会碰巧（偶然）使您的抢占点平均在您的时间测量块之外。

无论如何，这是我的两便士价值，希望它有助于解释事情:)

关于“纳秒”的一点说明，以......

我认为需要对“纳秒”睡眠保持谨慎。我这么说的原因是我认为普通计算机不太可能真正做到这一点，除非它使用特殊的硬件。

通常一个操作系统会有一个常规的系统“tick”，大概在 5ms 生成。这是由 RTC（实时时钟 - 只是一点硬件）生成的中断。使用这个“tick”系统然后生成它的内部时间表示。因此，平均操作系统将只有几毫秒的时间分辨率。这个滴答声不快的原因是要在保持非常准确的时间和不让定时器中断淹没系统之间取得平衡。

不确定我是否与您的普通现代 PC 有点过时了……我认为其中一些确实具有更高的分辨率计时器，但仍不在纳秒范围内，甚至可能在 100uS 时挣扎。

因此，总而言之，请记住，您可能获得的最佳时间分辨率通常在毫秒范围内。

编辑：只是重新审视这一点，并认为我会添加以下内容......并不能解释您所看到的内容，但可能会提供另一种调查途径......

如前所述， nanosleep 的计时精度不太可能优于毫秒。此外，您的任务可能会被抢占，这也会导致时间问题。还有一个问题是数据包上协议栈所需的时间可能会有所不同，以及网络延迟。

您可以尝试的一件事是，如果您的 NIC 支持 IEEE1588（又名 PTP）。如果您的 NIC 支持它，它可以在 PTP 事件数据包离开和进入 PHY 时为其添加时间戳。这将为您提供网络延迟的最佳*估计值。*这消除了您在软件抢占等方面可能遇到的任何问题。恐怕我对 Linux PTP 深有体会，但您可以尝试[http://linuxptp.sourceforge.net/](http://linuxptp.sourceforge.net/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-28T22:58:59.783

如果应用程序发送的数据量足够大且足够快，它可能会填充内核缓冲区，这会导致每个 send() 出现延迟。由于睡眠在测量部分之外，因此它将占用原本会阻塞在 send() 调用上的时间。

帮助检查这种情况的一种方法是运行相对较少的迭代次数，然后进行中等次数的迭代。如果问题发生在具有小数据包大小（例如 <1k）的少量迭代（例如 20 次）中，那么这可能是错误的诊断。

请记住，如果在这样的紧密循环中发送数据，您的进程和内核很容易压倒网络适配器和以太网（或其他媒体类型）的线速。

我在阅读屏幕截图时遇到问题。如果wireshark 在网络上显示出恒定的传输速率，则表明这是正确的诊断。当然，进行数学运算 - 将线速除以数据包大小（+ 标头） - 应该可以了解可以发送数据包的最大速率。

至于导致延迟增加的 700 微秒，那就更难确定了。我对那个没有任何想法。

# windows-8 - 加速计在尝试使用时输出“WinRT 转换错误”

> ID：16043854
> 
> 赞同：0
> 
> 时间：2013-04-16T17:56:58.193
> 
> 标签：windows-8, windows-runtime

在我在 ARM 平板电脑（即 Surface）上运行的 WinRT 应用程序中，我试图从加速度计传感器获取事件，但它不起作用。我以这种方式附加它，基本上来自微软的例子：

```
mAccelerometer = Accelerometer::GetDefault();
mListenerToken = mAccelerometer->ReadingChanged::add(ref new TypedEventHandler<Accelerometer^, AccelerometerReadingChangedEventArgs^>(this, &AccelerometerWin8Delegate::ReadingChanged)); 
```

不幸的是，这不起作用。当加速度计事件发生时，我没有调用我的处理程序，而是在输出中收到一条错误消息。

```
First-chance exception at 0x7539396B (KernelBase.dll) in EAMTestApp.exe: 0x40080202: WinRT transform error (parameters: 0x80004002, 0x00000000, 0x00000027, 0x04B1F280). 
```

在 KernelBase.dll!7539396a() 中抛出异常

知道是什么原因造成的吗？错误消息非常神秘。

我在[这里](http://code.msdn.microsoft.com/windowsapps/Accelerometer-Sensor-Sample-22982671)运行了 Microsoft 示例，在 Surface 上没有任何问题。

# javascript - JQuery表单提交未提交

> ID：16043860
> 
> 赞同：2
> 
> 时间：2013-04-16T17:57:10.087
> 
> 标签：javascript, jquery

我正在以编程方式创建一个表单并尝试提交它。不过，submit() 函数什么也不做。

```
$(".deleteLink").click(function(event) {
    event.preventDefault();

    var form = $("<form></form>");
    form.attr("method", "POST");
    form.attr("action", "http://myurl.com");

    form.submit(function() {
        alert('Handler for .submit() called.');
        return false;
    });
}); 
```

当我在 Firebug 中设置断点时，我看到 click() 函数被调用并且“form”变量被正确填充。一切正常到 submit() 方法。提交处理程序中的 alert() 方法永远不会被调用。

当调用 submit() 时，jquery.js 中的代码确实会执行，但我很难跟踪它以查看它的作用。

我已经确认页面上没有其他名为“提交”的对象。

有人知道发生了什么吗？

**澄清**：在没有 function() 参数的情况下调用 submit() 也没有任何作用。

**进一步澄清**：调用 submit(function(){alert()}) 后跟 submit() 确实调用了 alert()，但表单仍然没有被提交。

**另一个澄清**：我希望整个页面刷新。我不想做一个ajax提交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:59:04.053

您正在附加提交事件处理程序而不是在表单对象上调用提交，使用这个

```
form.submit(); 
```

*你的代码是*

```
$(".deleteLink").click(function(event) {
    event.preventDefault();

    var form = $("<form></form>");
    form.attr("method", "POST");
    form.attr("action", "http://myurl.com");

    form.submit(function() {
        alert('Handler for .submit() called.');       
    });
    form.submit();
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:27:37.483

在提交之前，您必须将新表单注入到文档中：

```
$("body").append(form);
form.submit(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:00:03.833

调用`form.submit()`触发提交表单

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-16T18:07:10.660

你有没有尝试过这样的事情？

```
$(".deleteLink").click(function(event) {

    event.preventDefault();

    $.post(    
        'http://myurl.com',
        function(){
            alert('success');
            // window.location.href = 'other page';
        }
    );

}); 
```

# java - There is an error while using System.out.println when both text and variables

> ID：16043869
> 
> 赞同：2
> 
> 时间：2013-04-16T17:57:35.400
> 
> 标签：java, oop, class, variables, output

I am a beginner in Java so I wrote a program to understand the OOP concepts but it gives me an error when trying to use System.out.println(). Here's the code

```
public static void main(String[] args) {
    sampleClass ADD = new sampleClass();
    Scanner input = new Scanner(System.in);
    int fNum;
    int sNum;
    System.out.println("Enter the first number to Add");
    fNum = input.nextInt();
    System.out.println("Now enter the second number");
    sNum = input.nextInt();
    int sum;
    sum = ADD.add(fNum, sNum);
    System.out.println("The sum of " fNum " and " sNum " is " sum);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:59:17.143

Replace this line `System.out.println("The sum of " fNum " and " sNum " is " sum);` with

```
System.out.println("The sum of " +fNum+ " and " +sNum+ " is " +sum); 
```

**Please Note**: *In Java, the operator "+" normally acts as an arithmetic operator unless one of its operands is a String. If necessary it converts the other operand to a String before joining the second operand to the end of the first operand.*

Examples:

If one of the operands is not a String it will be converted:

```
int age = 12; 
 System.out.println("My age is " + age); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T18:11:01.697

> Sign "+" is used for concatenation and you missed it between your String.

The correct format is:

> System.out.println("The sum of " + fNum + " and " + sNum + " is " + sum);

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T17:58:53.087

You're missing some `+`'s between things like `"The sum of "` and `fNum`, e.g. `"The sum of " + fNum + ....`

# objective-c - 值自动变化

> ID：16043874
> 
> 赞同：0
> 
> 时间：2013-04-16T17:57:42.530
> 
> 标签：objective-c, dictionary

大家好，我有一个问题：我读出了正在播放的媒体歌曲的实际值，并将其添加到字典中。然后变成一个数组。如果我再次按下按钮添加一个新条目，所有条目的所有值都将更改为相同。你有什么想法吗？

这是我的代码：

```
 - (IBAction)ActionButtonLU:(id)sender
{
    MPMediaItem *currentItem = [musicPlayer nowPlayingItem];

    NSString *titleString = [currentItem valueForProperty:MPMediaItemPropertyTitle];
    NSString *artistString = [currentItem valueForProperty:MPMediaItemPropertyArtist];
    NSString *albumString = [currentItem valueForProperty:MPMediaItemPropertyAlbumTitle];

    if (titleString == nil) {
        titleString = @"";
    }
    if (artistString == nil) {
        artistString = @"";
    } 
`  `if (albumString == nil) {
        albumString = @"";
    }

    [_dictCat1 setObject:titleString forKey:@"Titel"];
    [_dictCat1 setObject:artistString forKey:@"Artist"];
    [_dictCat1 setObject:albumString forKey:@"Album"];

    [_countCat1 addObject:_dictCat1];

    [musicPlayer skipToNextItem];

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:18:22.027

`_dictCat1`您在每次调用中都修改同一个字典 , 。您需要在本地创建一个字典并将其添加到`_countCat1`.

```
[_countCat1 addObject:@{ @"Title": titleString, 
                         @"Artist": artistString, 
                         @"Album": albumString }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:21:24.527

当您将对象添加到集合（NSArray、NSDictionary、NSSet 等，包括可变对象）时，集合不会复制它。随着`[_countCat1 addObject:_dictCat1];`你不断添加*相同*的对象，`_countCat1`一遍又一遍。您需要创建新的 NSDictionary 并将其添加到*集合*`_countCat1`中。

# function - 为什么指向函数的指针的值是 0x00000000？

> ID：16043876
> 
> 赞同：-1
> 
> 时间：2013-04-16T17:57:44.523
> 
> 标签：function, pointers, nullpointerexception, visual-c++-6

![在此处输入图像描述](https://i.stack.imgur.com/0tJSa.jpg)

为什么作为函数指针的proc得到空值？

![在此处输入图像描述](https://i.stack.imgur.com/IVIfD.jpg)
![在此处输入图像描述](https://i.stack.imgur.com/eY4yl.jpg)
![在此处输入图像描述](https://i.stack.imgur.com/xUWCt.jpg)

编辑：
![在此处输入图像描述](https://i.stack.imgur.com/TANxI.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T17:58:57.843

我的猜测是您加载的库不会导出名为“StartHook”的函数。

如果库是用 C++ 编写的（看起来就是这样），函数名称将根据其参数类型（例如，类似于`_Z9StartHookv`）进行修改。将定义包装起来`extern "C" { ... }`以防止这种情况发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:02:10.437

NULL 是函数失败时记录的返回值。要了解原因，请调用[GetLastError并](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679360%28v=vs.85%29.aspx)[在此处](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681381%28v=vs.85%29.aspx)查找。

# java - java orm/data access object - 删除记录的接口

> ID：16043881
> 
> 赞同：0
> 
> 时间：2013-04-16T17:58:00.980
> 
> 标签：java, orm, interface, dao

我有一个用作`Category`实体的 DAO 的以下 Java 接口：

```
public interface CategoryDao extends Dao {

    public void save(Category category);

    public void update(Category category);

    public void delete(Category category);

    public List<Category> findAllByType(String type);
} 
```

以上是我设计的，但恐怕`delete`方法不是很好。这是因为如果我想删除一条记录，我必须先从数据库中获取它——这太过分了。SQL 允许仅通过传递主键（在本例中为 id）来删除记录。如果我提供一个`deleteById(int)`方法会更好吗？

任何人都可以就如何为 ORM 实体提供 DAO 删除方法提出正确的方法（可能是最简单/最快的方法）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:17:31.607

你可以做一个，或另一个，或两者兼而有之。在任何情况下，Hibernate 都需要一个实体实例才能使用`session.delete()`. 您可以在不使用从数据库加载实体的情况下获取这样的实例`session.load()`，这会返回一个延迟加载的代理。

所以 deleteById() 方法将使用

```
Category c = (Category) session.load(Category.class, id);
delete(c); 
```

# mysql - sql 关系显示表中每条记录的总和（值）

> ID：16043887
> 
> 赞同：0
> 
> 时间：2013-04-16T17:58:24.140
> 
> 标签：mysql, join, count

我有 2 个表格 1 个用于网页详细信息，另一个用于访问，如下所示

页数

```
pid pname      and-more-columns
1   index      -----------
2   contact    -----------
3   about      ----------- 
```

访问

```
vid   pid    ip          datetime
1      1    222.1.1.1     2013-01-01 11:11:11
2      1    12.12.2.1     2013-01-01 11:21:11 
3      3    222.1.1.1     2013-01-02 10:11:11
4      2    12.12.2.1     2013-02-01 11:21:11 
5      3    222.1.1.1     2013-03-01 11:14:11
6      1    12.12.2.1     2013-04-01 11:55:11 
```

我想显示如下

```
pid pname      and-more-columns   total_visits (shud count from VISITS table)
1   index      -----------           3 
2   contact    -----------           1
3   about      -----------           2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:04:33.493

```
SELECT p.*, COUNT(v.pid)
FROM PAGES p
INNER JOIN VISITS v
ON p.pid = v.pid
GROUP BY p.pid, p.pname, <list all other columns here> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:19:37.693

假设你想要没有匹配的“0”，那么你想要一个左外连接：

```
SELECT p.*, COUNT(v.pid)
FROM PAGES p left outer join
     VISITS v
     ON p.pid = v.pid
GROUP BY p.pid 
```

请注意，这是仅按`group by`子句中的一个字段进行分组。这使用称为“隐藏列”的 MySQL (mis) 功能。此版本还假定该`pages.pid`字段是唯一的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:15:01.160

```
SELECT
    v.*,
    count(p.pid) AS `TotalVisits`
FROM PAGES AS p
INNER JOIN VISITS AS v ON v.pid = p.pid
GROUP BY p.pid 
```

# javascript - 您可以将实例命名为与其构造函数名称相同的名称吗？

> ID：16043889
> 
> 赞同：5
> 
> 时间：2013-04-16T17:58:25.980
> 
> 标签：javascript, constructor, singleton, instance

您可以将实例命名为与其构造函数名称相同的名称吗？

```
var myFunc = new function myFunc(){}; 
```

?

看起来，这用新实例替换了函数对象......这意味着这是一个很好的单例。

我还没有看到有人使用它，所以我想，这有一些我不知道的缺点......

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:01:31.110

是的...

但是，您正在创建一个命名函数但从不按名称引用它，这看起来确实很奇怪。

我见过的更常见的模式是

```
function MyClass(){
    this.val = 5;
};
MyClass.prototype.getValue = function() {
    return this.val;
}
MyClass = new MyClass(); 
```

但是当人们这样做时，我想知道为什么他们不只使用文字对象

```
var MyClass = {
    val: 5,
    getValue: function() {
        return this.val;
    }
} 
```

我什至更愿意在这里使用模块模式

```
var MyClass = (function(){
    var val = 5;
    return {
        getValue: function() {
            return val;
        }
    };     
})(); 
```

**免责声明**

现在是否应该使用单例模式，这是另一个问题（如果您关心测试、依赖管理、可维护性、可读性，答案是否定的）

*   [http://accu.org/index.php/journals/337](http://accu.org/index.php/journals/337)
*   [为什么在 Java 代码中实现单例模式（有时）被认为是 Java 世界中的反模式？](https://stackoverflow.com/questions/11292109/why-is-singleton-considered-an-anti-pattern-in-java-world-sometimes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:09:12.707

> 看起来，这用新实例替换了函数对象

不，它不会取代任何东西。*函数表达式*的名称（这就是你所拥有的）只能在函数本身内部访问，而不是在它外部。这与省略名称完全相同：

```
 var myFunc = new function(){}; 
```

通常，如果您不希望某些符号可访问，请不要将它们设为全局。在函数中定义这些符号，然后返回您想要访问的任何内容，例如：

```
var myobj = (function() {
    function Foo() {};
    // do whatever
    return new Foo();
}()); 
```

但是，如果您只想创建单个对象，则使用*对象字面*量通常更容易：

```
var myobj = {}; 
```

如果您只想从中创建单个实例，则没有理由使用构造函数。如果要建立继承，可以使用[`Object.create` *^([MDN])*](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)

# php - 警告：getimagesize() [function.getimagesize]：文件名不能为空警告信息？

> ID：16043892
> 
> 赞同：2
> 
> 时间：2013-04-16T17:58:31.317
> 
> 标签：php, warnings, getimagesize

直到最近，我一直在使用一些 PHP 将照片上传到网站。但突然它开始触发各种错误消息。

我使用的表单在操作时运行以下代码：

```
$uploaddir = "../../user_content/photo/";
$allowed_ext = array("jpeg", "jpg", "gif", "png");

    if(isset($_POST["submit"])) {
        $file_temp = $_FILES['file']['tmp_name'];   
        $info = getimagesize($file_temp);
    } else {
        print "File not sent to server succesfully!";
        exit;
    } 
```

表单的文件上传部分有以下元素：

```
<input name="file" type="file" class="photo_file_upload"> 
```

上传的提交按钮具有以下属性：

```
<button type="submit" name="submit" class="photo_upload">Upload</button> 
```

但是每当我运行它时，我总是会收到以下警告：

```
Warning: getimagesize() [function.getimagesize]: Filename cannot be empty in (upload PHP file) on line 10 
```

（第 10 行是这部分：$info = getimagesize($file_temp);)

有人对这是什么原因有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T18:06:02.547

您检查了表单是否已提交，但没有检查文件是否已发送。在某些情况下，可以提交表单但不会发送文件（即文件大小大于配置中的文件大小限制）。

用这个：

```
if(isset($_POST["submit"]) && isset($_FILES['file'])) {
    $file_temp = $_FILES['file']['tmp_name'];   
    $info = getimagesize($file_temp);
} else {
    print "File not sent to server succesfully!";
    exit;
} 
```

你看**&& isset($_FILES['file'])**是新的

或者你可以扩展它

```
if(isset($_POST["submit"]) && isset($_FILES['file'])) {
    $file_temp = $_FILES['file']['tmp_name'];   
    $info = getimagesize($file_temp);
} 
elseif(isset($_POST["submit"]) && !isset($_FILES['file'])) {
    print "Form was submitted but file wasn't send";
    exit;
}
else {
    print "Form wasn't submitted!";
    exit;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-10-16T11:21:40.323

在 php.ini 文件中更改这些参数；（目前它只允许上传和发布 2Mb 大小）。有时这是这些错误的原因。

```
upload_max_filesize = 500M
post_max_size = 500M
max_execution_time = 120 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-02-26T02:22:34.033

警告：getimagesize() [function.getimagesize]: 文件名不能为空

验证 MAX_SIZE 变量，例如为 2Mo 图像定义它：

```
define('MAX_SIZE', 2000000);
<form enctype="multipart/form-data" method="post" action="upload.php">
<input type="hidden" name="MAX_FILE_SIZE" value="<?php echo MAX_SIZE; ?>" /> 
<input name="fichier" type="file" id="fichier_a_uploader" /> <br>
<input type="submit" name="submit" value="Uploader" /> 
</form>
```

您还可以验证 PHP 将接受的最大 POST 数据大小和 PHP.ini 中上传文件的最大允许大小： post_max_size = ? 上传最大文件大小 = ?

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-07T09:58:06.927

升级 'upload-max-filesize' 后，重新启动 wamp 或 xampp 的所有服务！会的！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-13T11:32:59.370

您应该将表单 enctype 更改为“multipart/form-data”

```
<form method="post" enctype="multipart/form-data">
     ....
</form> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-11-01T02:44:15.253

注意：未定义索引：第 38 行 D:\xampp\htdocs\public_html\php\form_php\application\process_application.php 中的 fileToUpload

注意：未定义索引：第 43 行 D:\xampp\htdocs\public_html\php\form_php\application\process_application.php 中的 fileToUpload

警告：getimagesize()：第 43 行 D:\xampp\htdocs\public_html\php\form_php\application\process_application.php 中的文件名不能为空 文件不是图像。抱歉，文件已存在。注意：未定义索引：第 58 行 D:\xampp\htdocs\public_html\php\form_php\application\process_application.php 中的 fileToUpload 抱歉，只允许 JPG、JPEG、PNG 和 GIF 文件。抱歉，您的文件没有上传。

如果您遇到这样的错误，您应该检查您是否已将表单 enctype 添加到“multipart/form-data”

```
<form method="post" enctype="multipart/form-data">
     ....
</form> 
```

一开始就经常把我抓出来。

# deployment - SSRS 错误：“尚未指定运行报告所需的一个或多个参数。（rsParametersNotSpecified）”

> ID：16043893
> 
> 赞同：3
> 
> 时间：2013-04-16T17:58:42.653
> 
> 标签：deployment, reporting-services, shared-data

好的，有类似的问题，但这不是重复的。当您有引用共享数据集的参数时，似乎会出现此错误。在我的情况下，从服务器中删除报告并重新部署并不能解决问题。

因此，我正在使用商业智能开发工作室 BIDS 在 VS 2010 Professional 上进行开发，BIDS 受 Team Foundation Server 的源代码控制。我正在部署到我认为可能是问题的 2008R2 服务器。解决方法是更改​​要嵌入的数据集引用，而不是阻止这个错误死在它的轨道上，但在我看来这很糟糕，我希望最终能对共享数据集进行这项工作。

我尝试过的事情：

1.  确保数据集的命名与参考相匹配。EG：“名称是 ClientQuery，共享数据集是 ClientQuery”
2.  确保服务器上的命名与步骤 1 中的引用相匹配。
3.  通过删除对共享数据集的引用，确保这是破坏它的原因，然后立即工作。
4.  确保共享数据集未在服务器上启用某种类型的缓存。
5.  我在第二个共享数据集限制范围上有一个过滤器，我删除了它，但仍然存在错误。
6.  删除了所有参数，只添加了一个共享数据集，它立即给出错误。
7.  为参数绑定添加了一个选项，以说明：“允许空值”。也对 Null 进行了此操作。
8.  重新创建了所有内容，一个全新的 RDL 文件，并仅在报告正文上复制和粘贴元素，但明确创建了参数和数据集，这仍然会发生。

**9\. 更新 - 我已经完成了旧的 RDL 销毁，然后希望重新部署。我在网上发现了很多。这在这种情况下不起作用。它几乎就像 RDL 中的这个参考：**

```
 < DataSet Name="**ClientQuery**">
      < SharedDataSet>
        < SharedDataSetReference>**ClientQuery**</SharedDataSetReference>
      < /SharedDataSet>
      < Fields>
        < Field Name="CUSTOMER_ID">
          < DataField>CUSTOMER_ID</DataField>
          < rd:TypeName>System.String</rd:TypeName>
        < /Field>
        < Field Name="CUSTOMER_NAME">
          < DataField>CUSTOMER_NAME</DataField>
          < rd:TypeName>System.String</rd:TypeName>
        < /Field>
      < /Fields>
    < /DataSet> 
```

似乎以某种方式提及此引用会造成严重破坏。我会检查我的项目下的 bin(environment) 目录。（我为多个环境部署并在解决方案配置下设置 QA、UAT、PROD 等）每次 RDL 都按应有的方式进行更新并发布我正在显示的更新。我认为当人们看到他们的报告文件没有在服务器上更新时，“重建”是很多问题，在我的情况下，重建通常会更新 RDL，而不是先点击部署。

虽然所有这一切都在发生，但困难的部分是它每次都可以无缝地在 BIDS 上进行更改。所以错误完全是在处理源服务器认为 rdl 数据所代表的内容。

非常感谢任何帮助，我会评价自己在 SSRS 上的先进水平，但这让我很难理解错误所指的是它没有得到什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-12-15T16:14:47.013

我知道这是一个老问题，但我刚刚遇到这个问题并能够解决我的问题。认为更新的选项对于其他挣扎于它的人来说是必要的。我的问题与共享数据集属性上的参数设置有关。菜单如下所示：

[![在此处输入图像描述](https://i.stack.imgur.com/L6z9z.png)](https://i.stack.imgur.com/L6z9z.png)

具体来说，请确保在需要时选中“允许空值”选项。这立即解决了我的问题，即数据集在指向共享但嵌入数据集时不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T23:20:15.843

好的，所以 Jeroen 和其他人提出的答案是对的。我的问题是我的源代码位于较旧的 SVN 源代码控制下，该版本部署到 SSRS 2008 服务器，然后我们将代码库迁移到 TFS 源代码控制。问题似乎是共享数据集认为是与实际不同的标识符。除了删除文件之外，简单的解决方法是重新部署共享数据集。在我的情况下，我进入我的项目设置并将它们完全部署到报告结构下的不同位置，以将它们保持在同一区域，因此：报告/数据集而不仅仅是数据集。这似乎解决了我的问题，所以我相信这只是一场完美的风暴。对 SSRS 有疑问，我猜只是删除所有内容并从头开始。

# c++ - FMOD 对非流式样本使用过多的编解码器内存

> ID：16043896
> 
> 赞同：0
> 
> 时间：2013-04-16T17:58:45.373
> 
> 标签：c++, game-engine, fmod

我目前正在使用 FMODEx 4.40.10。我们像这样加载 OGG 样本：

```
uint uiFlags(FMOD_SOFTWARE | FMOD_LOWMEM | FMOD_CREATESAMPLE);
FMOD::SOUND* pSound(NULL);
m_pFMODSystem->createSound(sPath, uiFlags, NULL, &pSound); 
```

通过以下方式查看此声音的内存使用情况时：

```
FMOD_MEMORY_USAGE_DETAILS usage;
pSound->getMemoryInfo(FMOD_MEMBITS_ALL, 0, NULL, &usage); 
```

usage.codec 报告大于 0。这对我来说没有意义，因为 FMOD 文档指出 FMOD_MEMORY_USAGE_DETAILS::codec 是：

```
 codec
  [out] Codecs allocated for streaming 
```

从声音的加载方式可以看出，应该没有流式传输。

加载多个 OGG 文件后，当我查询系统的内存使用情况时，它显示编解码器数量很大 - 所有单个文件编解码器的使用情况加在一起。FMOD 报告的内存数量与我从自己的内存分析中看到的内存使用情况相匹配。

当我加载原始 PCM 数据时，usage.codec 报告为 0。

为什么我在加载非流式 OGG 文件时“编解码器”大于 0？有没有办法禁用这种内存使用？

编辑：作为测试，加载 OGG 后，我提取 PCM 数据并让 FMOD 创建一个新声音。然后我释放 OGG 发出的声音，并用从 PCM 数据加载的新声音替换它。这完美无缺。这进一步证明它分配的编解码器内存是不必要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T03:17:42.263

[http://www.fmod.org/forum/viewtopic.php?f=7&t=15762](http://www.fmod.org/forum/viewtopic.php?f=7&t=15762)

FMOD 证实了我的发现，并表示加载压缩声音、提取 PCM 数据、卸载声音然后从提取的 PCM 数据创建新声音的解决方法很好。

# ios - 当数字在 0 和 1 之间时显示没有整数部分的浮点数

> ID：16043899
> 
> 赞同：0
> 
> 时间：2013-04-16T17:58:49.277
> 
> 标签：ios, floating-point, number-formatting, nsnumberformatter

我想在 iOS 中显示浮点数，例如 .23

我见过人们不想要小数部分的问题。但我没有找到答案。我可以用 NSNumberFormatter 来做吗？我试图设置最小和最大整数位数，但没有用。有任何想法吗？

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:17:02.113

我认为最好的方法是使用 NSNumberFormatter：

```
NSNumberFormatter* numberFormatter = [[NSNumberFormatter alloc] init];
[numberFormatter setPositiveFormat:@"##.00"];
NSString* result = [numberFormatter stringFromNumber:[NSNumber numberWithFloat:0.63f]];; 
```

# paypal - PayPal：你能通过IPN/PDT获取客户（买家）的IP地址吗？

> ID：16043900
> 
> 赞同：3
> 
> 时间：2013-04-16T17:58:49.450
> 
> 标签：paypal, ip-address, paypal-ipn, eclipse-pdt

我从来没有在 Paypal 的网站上找到过这样的功能。我想通过 IPN/PDT 获取地址。PayPal 以外的替代品对我来说毫无用处，我已经有了。谢谢回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T09:14:51.673

PayPal 在可预见的未来由于未知原因不允许此功能。可能最好的解决方案是发送参数`CUSTOM`并在其中输入必要的数据，它们被发送到 PayPal，然后返回到商家的站点。付款订单**必须从商家网站发出**，不同地检测IP地址将不正确。详情[在这里](https://developer.paypal.com/webapps/developer/docs/classic/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables/)。

`CUSTOM`参数限制为最多 256 个字符。

**通过 GET 方法发送**

```
https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=XY&custom=custom_string 
```

**通过 POST 方法发送**

```
<input type="hidden" name="custom" value="custom_string" /> 
```

**回调数据**

回调是通过`NOTIFY_URL`参数执行的。将向指定的 URL 发送交易的详细信息。`NOTIFY_URL`必须包含在配置*“立即购买”按钮*或 URL 链接或 PayPal 帐户中的默认值中。

示例网址链接：

```
https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=XY&custom=custom_string&notify_url=http://site.com/pay.php 
```

数据获取是通过 PayPal 站点的 GET 或 POST 方法使用数组`$keyarray['custom']`（默认）执行的。[在此处](https://github.com/paypal/pdt-code-samples)查看详细信息。

# silverlight - 在 Windows Phone 7 中将样式动态绑定到 StackPanel

> ID：16043912
> 
> 赞同：0
> 
> 时间：2013-04-16T17:59:09.173
> 
> 标签：silverlight, windows-phone-7, windows-phone, datatrigger, stackpanel

我有一个`ListBox`包含`StackPanel`用于绑定的元素。基于一个值，例如 'Overdue' = true，the 的样式`StackPanel`和下面的一些元素应该改变。每个项目之间的唯一区别是 s 的背景`StackPanel`和两个 s 的 Foreground`TextBlock`会改变。我想过为每个模板创建一个单独的模板，但是有 20 个选项，这似乎有点过头了。我`SolidColorBrush`为 20 个项目中的每一个设置了一个。

我以为我可以使用 DataTrigger，但我在某处读到 WP7 不支持它们，因为 WP7 支持 Silverlight 3 及更高版本。

我正在寻找建议。很抱歉，这似乎过于主观，希望有人对这种情况有最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T00:16:21.317

您应该考虑使用基于项目的 DataContext 返回 SolidColorBrush 的 ValueConverter。

查看 Tim 的博客，获取代码示例和详细说明。

[http://timheuer.com/blog/archive/2008/07/30/format-data-in-silverlight-databinding-valueconverter.aspx](http://timheuer.com/blog/archive/2008/07/30/format-data-in-silverlight-databinding-valueconverter.aspx)

希望这可以帮助。

来自家庭开发的代码

# javascript - 如何动态更改页面的 og:title

> ID：16043916
> 
> 赞同：0
> 
> 时间：2013-04-16T17:59:28.570
> 
> 标签：javascript, php, facebook, facebook-like

本质上，我有一个网站，它使用查询字符串根据用户在 url 中输入的内容动态更改内容。我还使用了一个 .htaccess 文件来重写 url 以删除问号，所以它看起来就像另一个页面。例子：

```
www.site.com/233 - loads content associated with the ID 233 
```

我的问题是，当有人点赞facebook上的页面时，虽然我已经使用JS将点赞的url改为当前页面，但我无法看到（在我目前的编码能力范围内）动态更改og:url og:title 等带有查询字符串。

我想要的结果是，当有人喜欢我的页面时，它会在新闻提要上显示用户喜欢的内容。例子

```
user liked www.site.com/231 - instead of it showing just 'site' in the newsfeed
I wish it to show the extention, i.e 'site - content 231' for /231 and 'site -
content 4234' for /4234 
```

目前我被迫设置一个基本的 og:title 并且没有 og:url 因为显然它对于查询字符串的每个扩展都是相同的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:11:41.627

我的评论的简单解释：

```
// router.php

// process URL and blah blah blah here

$config = array(
     "og" => array(
         "title" => "Cool Page"
     )
);
include 'template.php';

// template.php
<html>
    <head>
        <title><?php echo $config["og"]["title"]; ?></title>
    </head>
    <body>
    </body>
</html> 
```

# yui-compressor - YUI Compressor 压缩目录中的所有文件

> ID：16043922
> 
> 赞同：2
> 
> 时间：2013-04-16T17:59:43.220
> 
> 标签：yui-compressor

我有一个 js 文件夹，其中包含`n`许多 javascript 文件（我可能会从该文件夹中添加/删除一些文件）

我可以做这样的事情吗？

`java -jar yuicompressor.jar dev/js/* -o dev/js/main.min.js`

我想将该目录中的所有文件合并为一个缩小文件，`main.min.js`但该命令不起作用。（如果我输入文件名而不是 * 它可以工作）

# android - Android Junit 测试与普通 Junit 测试

> ID：16043931
> 
> 赞同：9
> 
> 时间：2013-04-16T18:00:21.517
> 
> 标签：android, junit, android-testing

我正在接管一个 android 项目，我希望在项目中引入单元测试，以帮助避免可能的回归。

对于普通的 java 项目，我有两个源文件夹：`src`和`test`. 源文件夹包含我所有的`src`源文件，我的`test`源文件夹包含我所有的单元测试，我认为这是将测试与源分开的标准，因此您不必附带它们。

我一直在网上阅读，使用 android 应用程序的方法看起来有点不同。几个示例讨论了为 a 设置第二个项目，`android test project`然后引用`android project`.

我想确认几件事：

1.  在测试 android 项目时，是否有第二个项目来测试合适的事情，或者我只是找到不好的例子？
2.  所有单元测试都应该是android单元测试吗？例如，是的，它们都应该是，或者不，我应该在 android 单元测试和 junit 之间混合，因为 junit 的开销较小。
3.  android 单元测试比 junit 测试有什么额外的好处？例如模拟器的句柄等。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T18:13:56.473

> 在测试 android 项目时，是否有第二个项目来测试合适的事情，或者我只是找到不好的例子？

是的，通常有一个单独的“测试项目”来测试 Android 特定代码。[http://developer.android.com/tools/testing/testing_android.html](http://developer.android.com/tools/testing/testing_android.html)

> 所有单元测试都应该是android单元测试吗？例如，是的，它们都应该是，或者不，我应该在 android 单元测试和 junit 之间混合，因为 junit 的开销较小。

您通常会混合使用，因为您无法使用常规 ole' JUnit 在标准 JVM 上测试 Android 特定代码（不是没有一些帮助库，稍后会详细介绍）。

在实践中，我发现将应用程序划分为普通的 JVM 组件和 Android 部分是有意义的。例如，如果您需要与 REST API 通信，您可以拥有一个单独的组件，该组件仅执行此操作，并且是*纯 Java*。这些类型的组件可以很容易地使用标准 JUnit 进行测试。这种类型的架构还导致更清晰的职责分离，并且通常也更容易理解和维护设计。（这些组件可以作为常规 JAR 包含在您的 Android 应用程序中。）

> android 单元测试比 junit 测试有什么额外的好处？例如模拟器的句柄等。

Android 测试可能会很慢而且很痛苦，因为完整的 Android 测试在模拟器（或设备上）中运行 Android 堆栈。然而，Android 测试对于测试应用程序中特定于 Android 的部分是必要的，例如 Context/Activity/Service 等。

由于原生 Android 测试的繁琐和缓慢的特性，已经创建了几个框架来模拟或存根 SDK 的部分并采用不同的方法来提供帮助。例如，您可能想研究一下 Robolectric 和 Robotium。（这些都有自己的优点和缺点。）

# xpages - 是否可以在 XPages SSJS 中将 @Functions 与 sessionAsSigner 结合使用？

> ID：16043932
> 
> 赞同：1
> 
> 时间：2013-04-16T18:00:28.867
> 
> 标签：xpages, xpages-ssjs

我有一个进程使用 sessionAsSigner 来做一些签名者有权做的事情，但不是当前用户没有。这工作得很好。例如： var db = sessionAsSigner.getDatabase(session.getServerName(),"somedb.nsf");

但是现在我正在尝试将 @ 函数的使用添加到组合中，但是在调用 @ 函数时似乎没有使用该 sessionAsSigner 的方法。有没有办法做到这一点，或者我必须创建自己的替换函数，使用会话来做与@函数相同的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:45:37.110

您可以将评估语句用于您的@DBLookup，fe

```
sessionAsSigner.evaluate('@DbColumn("":"";"":"";"All";1)'); 
```

# javascript - jquery, Slider 只转一次

> ID：16043935
> 
> 赞同：0
> 
> 时间：2013-04-16T18:00:41.840
> 
> 标签：javascript, jquery, slider, intervals

我有这个，这是一个图像滑块，当它到达终点并返回时，它会继续转动：

```
 $(function () {
    var sliderUL = $('div.headslide').children('ul'),
    imgs = sliderUL.find('img'),
    imgWidth = imgs[0].width,
    imgsLenth = imgs.length,
    current = 1,
    totalImgsWidth = imgsLenth * imgWidth,
    direction = 'next',
    loc = imgWidth,
    interval = setInterval(swapBKgnd, 9000);

function swapBKgnd() {

    (direction === 'next') ? ++current : --current;

    if (current === 0) {
        current = imgsLenth;
        loc = totalImgsWidth - imgWidth;
        direction = 'next';
    } else if (current - 1 === imgsLenth) {
        current = 1;
        loc = 0;
    }

    transition(sliderUL, loc, direction);
};

function transition(container, loc, direction) {
    var unit;

    if (direction && loc !== 0 ) {
        unit = (direction === 'next') ? '-=' : '+=';
    }

    container.animate({
        'margin-left': unit ? (unit + loc) : loc,
    });
}
}); 
```

它的意思是继续前进，但是一旦到达终点并回到第一个……它就停止了。我将如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:26:28.670

当您到达图像的末尾时，您设置`loc = 0`然后`current = 1`. 但是，在下一次迭代中，`loc`is still `0`，所以它不会移动。您需要添加一个`else`：

```
if (current === 0) {
    current = imgsLenth;
    loc = totalImgsWidth - imgWidth;
    direction = 'next';
} else if (current - 1 === imgsLenth) {
    current = 1;
    loc = 0;
} else {
    loc = imgWidth;
} 
```

演示：http: [//jsfiddle.net/jtbowden/5W8Av/](http://jsfiddle.net/jtbowden/5W8Av/)

# c++ - 如何从g ++生成的目标代码中去除表示源头绝对路径的字符串

> ID：16043939
> 
> 赞同：4
> 
> 时间：2013-04-16T18:00:53.127
> 
> 标签：c++, gcc

通过运行，`strings`我注意到我的`g++ 4.7.3`编译器生成的目标代码（没有打开调试标志）包含源代码单元中使用的所有头文件的绝对路径。对目标代码执行 a`strip -s`不会删除这些字符串。为什么它们首先包含在目标代码中？其次，如何从目标代码中删除它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:08:52.723

文件名和路径通常来自命令行，因此如果使用绝对路径编译文件，它将显示在二进制文件中。您需要修改编译源文件的方式，可能会更改构建系统。改变：

```
g++ -I/home/frey/mylib/include /home/frey/foo.cpp -o foo 
```

至

```
cd /home/frey
g++ -Imylib/include foo.cpp -o foo 
```

# ios - iOS：拖动效果效果不佳

> ID：16043941
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:00.513
> 
> 标签：ios, objective-c, uiviewcontroller

我已经在图像上实现了拖动效果，但在测试期间，我看到图像仅在单击鼠标事件时移动。

我无法通过拖动事件在屏幕上使用鼠标移动图像。但是当我点击屏幕的一侧时，图像会占据我点击的位置。

我在 youtube 上关注了许多主题，但最后，我没有相同的行为。

这是我的代码：

屏幕视图1.h

```
IBOutlet UIImageView *image; 
```

ScreenView1.m

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    UITouch *touch = [[event allTouches] anyObject];
    CGPoint location = [touch locationInView:touch.view];

    image.center = location;
    [self ifCollision];
}

-(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event{
    [self touchesBegan:touches withEvent:event];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:05:10.683

如果你想拖动一个图像视图，使用 UIPanGestureRecognizer 会更开心*。*它使这种事情变得微不足道。使用`touchesBegan`是如此 iOS 4 ！

```
UIPanGestureRecognizer* p =
    [[UIPanGestureRecognizer alloc] initWithTarget:self
                                            action:@selector(dragging:)];
[imageView addGestureRecognizer:p];

// ...

- (void) dragging: (UIPanGestureRecognizer*) p {
    UIView* vv = p.view;
    if (p.state == UIGestureRecognizerStateBegan ||
            p.state == UIGestureRecognizerStateChanged) {
        CGPoint delta = [p translationInView: vv.superview];
        CGPoint c = vv.center;
        c.x += delta.x; c.y += delta.y;
        vv.center = c;
        [p setTranslation: CGPointZero inView: vv.superview];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:06:10.400

您在 中没有做正确的事情`touchesMoved:withEvent:`，这就是拖动不起作用的原因。这是一个有效的小代码：

```
- (void)touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    UITouch *touch = [touches anyObject];
    CGPoint location = [touch locationInView:self];
    [CATransaction begin];
    [CATransaction setDisableActions:YES];
    [image setCenter:location];
    [CATransaction commit];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T19:54:17.950

对于其他人，我以这种方式实现了我的问题：

```
- (IBAction)catchPanEvent:(UIPanGestureRecognizer *)recognizer{
    CGPoint translation = [recognizer translationInView:self.view];
    recognizer.view.center = CGPointMake(recognizer.view.center.x + translation.x,
                                         recognizer.view.center.y + translation.y);

    [recognizer setTranslation:CGPointMake(0, 0) inView:self.view];

} 
```

再次感谢马特！

# android - 制作一个使用java隐藏文件的android应用程序

> ID：16043942
> 
> 赞同：-1
> 
> 时间：2013-04-16T18:01:04.780
> 
> 标签：android, security

我正在制作一个安卓应用程序。我想知道如何制作一个程序来隐藏 android 手机中的文件。就像“Hide it pro”应用程序一样

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:08:06.277

> “从媒体扫描仪中隐藏您的文件
> 
> 在您的外部文件目录中包含一个名为 .nomedia 的空文件（注意文件名中的点前缀）。这将阻止 Android 的媒体扫描仪读取您的媒体文件并将它们包含在画廊或音乐等应用程序中。”

[http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)

这不会从操作系统（或“Android 手机”）中隐藏文件，但会阻止 MediaScanner 拾取它们并在内置应用程序中显示它们。注意：在 Android 4.0 中存在一个问题，即如果创建新的 .nomedia 文件，现有的索引文件不会被遗忘。要解决此问题，请创建一个新目录，添加 .nomedia 文件，然后将要隐藏的内容移动到那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:03:55.427

我认为有三种选择：

*   将文件移动到其他应用程序看不到的目录中。
*   加密文件并让它们*公开*（这意味着其他应用程序可以访问）
*   添加到文件在文件中的目录中`.nomedia`。但请注意，这只是将文件*隐藏*在`MediaScanner`. 但是，如果其他应用程序查看您的目录，它们将很容易访问。

顺便说一句，您的操作系统无论如何都无关紧要。只有目标平台很重要。

# mysql - 如何禁用 MySQL 查询缓存

> ID：16043943
> 
> 赞同：31
> 
> 时间：2013-04-16T18:01:04.963
> 
> 标签：mysql, caching

我正在尝试对不同列上的不同查询进行一些基准测试，但 MySQL 不允许我这样做。在第一次执行查询后，我再也无法为该查询获得相同的执行时间。例如，如果查询第一次在 0.062 秒内执行，我永远无法在第二次、第三次等运行中获得相同的执行时间。它变为 0 秒或类似 0.015。

我已经阅读了许多关于禁用和清除 MySQL 查询缓存的帖子，但没有一篇对我有任何帮助。

[像这样的帖子在这里](https://stackoverflow.com/questions/181894/mysql-force-not-to-use-cache-for-testing-speed-of-query)

无论我做什么，MySQL 似乎都坚持使用缓存结果。

我重新启动 MySQL Workbench，然后运行；

```
set global query_cache_type=0;
set global query_cache_size=0;
flush query cache;
reset query cache; 
```

执行时间一直显示 0 秒。

只有我无法更改的服务器变量是“have_query_cache”。它的值为“是”，当我尝试将其设置为“否”时，Workbench 说它是只读的。

我也这样做；

```
set profiling=1;
run my select query
show profile for query 2; 
```

分析结果表明：

```
'starting', '0.000077'
'checking permissions', '0.000007'
'Opening tables', '0.000016'
'init', '0.000035'
'System lock', '0.000009'
'optimizing', '0.000013'
'statistics', '0.000094'
'preparing', '0.000008'
'executing', '0.000002'
'Sending data', '0.000016'
'end', '0.000002'
'query end', '0.000003'
'closing tables', '0.000005'
'freeing items', '0.000139'
'cleaning up', '0.000009' 
```

如果我没有错，这表明没有使用缓存对吗？但我仍然看到 0 秒。为执行时间。

**编辑**：我正在运行的查询是使用“SQL_NO_CACHE”的 SELECT 查询，如下所示：

```
SELECT SQL_NO_CACHE col1,now() from mytable where col2="some_value" 
```

（我添加了 now() 函数来帮助我防止查询缓存）

**Edit2**：我正在使用 innoDB，MySQL 5.6.10

有人可以帮助我，因为我看不到这里发生了什么。

非常感谢！

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-16T18:06:44.347

这可能是由于数据本身的缓存，而不是查询缓存。

为了确保这一点，您可以通过在**SELECT**语句后添加**SQL_NO_CACHE**来禁用单个语句的查询缓存。

 **前任：

`SELECT SQL_NO_CACHE field FROM table.`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-16T18:07:49.630

第一次运行查询会使`InnoDB`缓冲池填充表的相关块。

由于重新运行查询需要完全相同的块，因此它使查询无需在重新运行时从磁盘读取它们，从而显着加快速度。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-17T00:11:23.773

您可以验证缓冲池页面读取与必须进入磁盘才能获取页面的页面读取之间的区别：

```
mysql> SHOW SESSION STATUS LIKE 'Innodb_buffer_pool_read%';
mysql> ...run a query...
mysql> SHOW SESSION STATUS LIKE 'Innodb_buffer_pool_read%'; 
```

比较报告中的这些值，并注意它们增长了多少：

```
+---------------------------------------+----------+
| Variable_name                         | Value    |
+---------------------------------------+----------+
| Innodb_buffer_pool_read_requests      | 10327490 |
| Innodb_buffer_pool_reads              | 1133     |
+---------------------------------------+----------+ 
```

read_requests是逻辑页面读取，它可能从缓冲池中已经存在的页面中读取**。**如果这个数字在您的查询后增长，但*读取*数没有增长，那么您的查询仅从缓冲池中获取结果。

**读取**是必须输出到磁盘的页面读取次数，并且会产生 I/O 成本以将页面复制到缓冲池中。如果查询后这个数字增加，那么它必须从磁盘加载数据。

有关内存访问与磁盘访问性能之间差异的更多信息，请阅读[http://everythingisdata.wordpress.com/2009/10/17/numbers-everyone-should-know/](http://everythingisdata.wordpress.com/2009/10/17/numbers-everyone-should-know/)

* * *

回复您的评论：

“打开表”与 InnoDB 表的内存缓存有关，有点像数据字典。表在重新启动后第一次被引用时打开。内存数据字典中给定表的条目无限期地保留在内存中，因此如果您有数千个表，内存使用量可能会变得非常大。在 MySQL 5.6 中，他们有一些调整变量来限制内存使用，并驱逐不经常使用的表。但整个机制与缓冲池是分开的，缓冲池存储数据页和索引。

“统计”也与缓冲池分开。InnoDB 维护有关数据和索引的内存统计信息，用于指导查询优化器。当您第一次访问 InnoDB 表时，当您运行 SHOW TABLE STATUS 或针对 INFORMATION_SCHEMA 运行某些查询时，当您运行 ANALYZE TABLE 时，以及当表的大小发生显着变化时，统计信息会自动刷新。InnoDB 生成这些统计信息，随机从表中读取固定数量的页面，如果您有冷缓冲池，这很可能会影响磁盘。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-16T22:42:12.387

好的。所以我一直在研究这个 innoDB 缓冲池问题。谢谢@Quassnoi，@TheVedge 提到这一点。它对以下工作非常有用。

我试图找到一种方法来禁用或重置 innoDB 缓冲池，但除了重新启动 MySQL 服务器之外，我找不到其他方法。（要在 Windows 框中重新启动服务器，您可以使用 services.msc 或命令提示符。）

我猜所有的配置变量设置和“SQL_NO_CACHE”的使用足以避免使用缓存，并且检查分析结果我也没有看到任何缓存引用（检查原始帖子）。

然后我决定在重新启动 MySQL 服务器后检查相同查询的第 1 次和第 2 次运行的分析。这样我就可以一步一步地看到查询执行过程中发生了什么。

服务器重新启动后的第一次运行产生了以下步骤和时间：

```
'starting', '0.000078'
'checking permissions', '0.000005'
'Opening tables', '0.120329'
'init', '0.000107'
'System lock', '0.000012'
'optimizing', '0.000024'
'statistics', '0.065317'
'preparing', '0.000026'
'executing', '0.000003'
'Sending data', '0.000038'
'end', '0.000005'
'query end', '0.000006'
'closing tables', '0.000014'
'freeing items', '0.000463'
'cleaning up', '0.000039' 
```

这些是第二次运行的结果：

```
'starting', '0.000068'
'checking permissions', '0.000006'
'Opening tables', '0.000019'
'init', '0.000046'
'System lock', '0.000007'
'optimizing', '0.000010'
'statistics', '0.000073'
'preparing', '0.000009'
'executing', '0.000002'
'Sending data', '0.000035'
'end', '0.000003'
'query end', '0.000003'
'closing tables', '0.000006'
'freeing items', '0.000181'
'cleaning up', '0.000015' 
```

如您所见，两次执行之间的“打开表”和“统计”操作的持续时间存在巨大差异，并且没有任何执行引用任何缓存。

这两个动作似乎是第一次执行最耗时的部分（我相信这是创建 innoDB 缓冲池的一部分），并且一旦生成池，这两个动作就不会那么频繁地执行，因此执行时间要短得多缓冲池创建后的查询。

当您总结第二次运行的各个步骤的执行时间时，我们得到 0.000483 秒，我认为 MySQL 工作台将此结果显示为 0.000 秒，这也可能会让您认为第二次运行是缓存使用的结果，但实际上看起来像它不是。这只是查询执行持续时间的显示精度问题。

结果，到目前为止，我发现我实际上已经能够禁用缓存的使用，并且是 innoDB 缓冲池的完成大大加快了第二个查询的速度。这也意味着我可以在 0.000483 秒内找到 200 万行的记录。

你会同意吗？

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-24T12:21:20.900

在 [mysqld] 部分的 .ini/.cfg 中，添加一行`have_query_cache=0 # to prevent using resources from default of yes ccyy/mm/dd your initials`. 使用您的其他更改，关闭/重新启动 MySQL。您不应在概况研究中观察任何 QC 活动。**

# ruby-on-rails - Rails 嵌套模型未通过验证

> ID：16043944
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:10.693
> 
> 标签：ruby-on-rails, rspec

我正在使用`rspec`嵌套模型 3 级深度编写模型规范测试。每个`->`代表一种`has_many`关系。

`Users->Goals->Milestones`

现在，我的`spec/models/milestone_spec.rb`测试未通过`be_valid`检查，我对为什么会发生这种情况感到有些困惑。

```
Failures:

  1) Milestone 
     Failure/Error: it { should be_valid }
       expected valid? to return true, got false
     # ./spec/models/milestone_spec.rb:17:in `block (2 levels) in <top (required)>' 
```

规范本身：

```
describe Milestone do
  let(:user) { FactoryGirl.create(:user) }
  let(:goal) { user.goals.build(content: "Loreum Ipsum", amount: "30", interval: 2) }
  before do
    @milestone = goal.milestones.build(amount: "20") 
  end

  subject { @milestone }

  it { should respond_to(:goal_id) }
  it { should respond_to(:amount) }
  # not sure why this isn't working
  it { should be_valid } 
```

可能与我创建的方式有关`@milestone`吗？我试过`goal.milestones.new`了，这似乎没有什么不同。在规范的下面，我对正确验证的字段进行了一些测试，并且运行良好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T03:32:28.557

尝试这个：

```
it "should be valid" do
  @milestone.valid?
  puts @milestone.errors.full_messages
end 
```

这将运行验证并为您打印出验证错误，以便您查看发生了什么。

# regex - NLTK 正则表达式用于名词短语不匹配以介词结尾

> ID：16043950
> 
> 赞同：2
> 
> 时间：2013-04-16T18:01:33.593
> 
> 标签：regex, parsing, grammar, nltk, regex-negation

我正在尝试使用 NLTK 识别名词短语，但在正则表达式上仍然有点绿色。

我最初使用的是这样的正则表达式：

```
 NP: {<PP\$>?<JJ.*>*<NN.*>+} 
```

但我发现我不断收到以介词结尾的表达式，所以像：“Demonstration projects for”，以介词“for”结尾的东西是匹配的，这是不可取的。（我还没有看到，即使使用上面的语法——据我所知，这应该总是以至少一个名词结尾，对吧？）

因此，我通过将量词更改为：

```
 NP: {<PP\$>?<JJ.*>*<NN.*>+?} 
```

但现在我得到了像“奥尔良”这样的比赛，而不是“新奥尔良”。似乎它不再匹配短语了。

[最后，我尝试使用前瞻（我在这里](https://stackoverflow.com/questions/4973977/regular-expression-matching-only-if-not-ending-in-particular-sequence)了解到）来显式删除终端介词：

```
 NP: {((?!<IN>$)(<PP\$>?<JJ.*>*<NN.*>+))+} 
```

这根本没有效果-我仍然将“示范项目”之类的东西作为匹配项。我怎样才能让我的名词短语没有终结介词？

如果有一种更简单、更优化的方式来获取名词短语，那也将不胜感激！

# ember.js - 每个用户对象一个事务

> ID：16043951
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:34.920
> 
> 标签：ember.js, ember-data

当我`save`提交`User`所有当前的脏`Users`时。我必须更改哪些 a`save`仅提交特定的事务`User`？

**应用程序.js**

```
App = Ember.Application.create();

App.Store = DS.Store.extend({
  revision: 12,
  adapter: 'DS.FixtureAdapter'
})

App.Router.map(function() {
  this.resource('users', function() {
    this.resource('user', { path: ':user_id' })
  })
});

App.UsersRoute = Ember.Route.extend({
  model: function() {
    return App.User.find();
  }
});

App.UserController = Ember.ObjectController.extend({
  startEditing: function() {
    this.transaction = this.get('store').transaction();
    this.transaction.add(this.get('content'));
  },

  save: function( user ) {
    user.transaction.commit();
  }  
})

App.User = DS.Model.extend({
  lastName: DS.attr('string')
})

App.User.FIXTURES = [{
  id: 1,
  lastName: "Clinton"
}, {
  id: 2,
  lastName: "Obama"
}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T02:00:53.887

我的猜测是`startEditing`永远不会调用它，否则这可能没问题。

另一种选择是您多次保存记录。保存记录后，将其移回商店的默认事务。任何后续调用`save`都会实际提交存储的事务。

# iphone - NSJSONSerialization 返回 nil

> ID：16043953
> 
> 赞同：5
> 
> 时间：2013-04-16T18:01:40.670
> 
> 标签：iphone, ios, json, web-services, nsdata

```
{"User":{"id":"42","name":"martin"}} 
```

将我的 NSData 转换为 NSString 会返回这个似乎完全有效的 JSON，但是方法：

```
[NSJSONSerialization isValidJSONObject:data] 
```

说这不是一个有效的 JSON 对象。

谁能指出我犯的错误或想到发生这种情况的原因？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-16T19:07:49.817

我敢打赌，您的字符串中有一个不可打印的字符，例如，使数据无效。

声明一个`NSError* error`变量，然后调用`[NSJSONSerialization JSONObjectWithData:data options:0 error:&error]`方法来尝试转换 JSON：显然，如果您的数据被认为是无效的，它将返回`nil`，但至少您将在此`NSError* error`之后对变量中的错误进行描述。

```
NSData* data = ... // your data
NSError* error = nil; // Declare a variable to hold the error upon return
id obj = [NSJSONSerialization JSONObjectWithData:data options:0 error:&error]; // Try to convert your data
NSLog(@"obj: %@ ; error: %@", error); // Log the decoded object, and the error if any 
```

# actionscript-3 - 使用 TimeLine 动画进行补间

> ID：16043954
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:41.797
> 
> 标签：actionscript-3

对你们来说很容易，但对我来说是新的。我有一个名为 mcPlayer 的动画行走角色。在它的时间轴内，我有各种动画状态“walkingLeft”、“walkingRight”和“Idle”的帧标签。行走动画是他在一个地方行走。我希望能够使用按钮将带有动作脚本的角色移动到舞台上的各种目标，并在它移动时播放相应的动画。所以我能想到的最直接的方法就是这样......

```
import com.greensock.*;

btnRight.addEventListener(MouseEvent.CLICK, moveRight);
btnLeft.addEventListener(MouseEvent.CLICK, moveLeft);

function moveRight(Evt:MouseEvent):void{
TweenLite.to(mcPlayer,2,{x:450});
mcPlayer.gotoAndPlay("walkingRight");
}
function moveLeft(Evt:MouseEvent):void{
TweenLite.to(mcPlayer,2,{x:450});
mcPlayer.gotoAndPlay("walkingLeft");
} 
```

我在 mcPlayer 时间轴上尝试了不同的命令，比如放置一个 stop(); 在每个动画的开头。我试过放一个 gotoandplay(); 在每个动画的结尾，它会转到开头并循环。我想尽可能少地使用时间线。

我该如何... 1\. 在补间运动时让动画连续播放 2\. 当动画到达目的地时停止动画，最后在 mcPLayer 达到其目标后让动画“空闲”播放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T19:02:08.460

要循环动画，您将测试动画的最后一帧然后循环回来，您可以在补间中使用 onUpdate 参数执行此操作，并使用 onUpdateParams 传递更新所需的任何数据。比如动画标签和动画的最后一帧。

如果你想在补间完成后做一些事情，比如改变空闲动画，你会使用 onComplete 参数。

这是您可能会做的一个示例：

```
btnRight.addEventListener(MouseEvent.CLICK, moveRight);
btnLeft.addEventListener(MouseEvent.CLICK, moveLeft);

function moveRight(Evt:MouseEvent):void{

    // lastframe should be replaced with whatever the frame the walk right animation ends on.
    TweenLite.to(mcPlayer, 2, {x:450, onUpdate:updateHandler, onUpdateParams:['walkingRight', lastFrame], onComplete:idleHandler);
    mcPlayer.gotoAndPlay("walkingRight");
}
function moveLeft(Evt:MouseEvent):void{

    // lastframe should be replaced with whatever the frame the walk left animation ends on.
    TweenLite.to(mcPlayer, 2, {x:10, onUpdate:updateHandler, onUpdateParams:['walkingLeft', lastFrame], onComplete:idleHandler);
    mcPlayer.gotoAndPlay("walkingLeft");
}

function updateHandler(loopLabel:String, lastFrame:int):void
{
    if (mcPlayer.currentFrame == lastFrame)
    {
        mcPlayer.gotoAndPlay(loopLabel);
    }

}

function idleHandler():void
{
    mcPlayer.gotoAndPlay("idle");
    // this is also where you'd do anything else you need to do when it stops.

} 
```

我不确定您是如何设置内容的，我只是猜测您在 mcPlayer 的时间线上拥有所有动画，并根据您所说的为每个动画添加了标签。

根据您的内容设置方式，您可能需要以不同方式实施。但概念仍然相同 - 使用 onComplete 和 onUpdate 来处理那些特定事件的事情。

# php - 格式化搜索的输出

> ID：16043955
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:42.913
> 
> 标签：php, html-table

我正在尝试为我的网页创建一个搜索功能，但我在格式化结果时遇到了困难，以便它以表格格式出现，这是我的代码：

```
<?php
    $query = $_GET['query'];      
    $min_length = 10;

    if(strlen($query) >= $min_length){ // if query length is more or equal minimum length then

        $query = htmlspecialchars($query); 

        $query = mysql_real_escape_string($query);

        $raw_results = mysql_query("SELECT * FROM aggrement
            WHERE (`description` LIKE '%".$query."%') OR (`start_date` LIKE '%".$query."%') OR (`end_date` LIKE '%".$query."%') OR (`balance` LIKE '%".$query."%') OR (`tax_value` LIKE '%".$query."%') OR (`amount_paid` LIKE '%".$query."%') OR (`hosting_name` LIKE '%".$query."%') OR (`domain_name` LIKE '%".$query."%') OR (`first_name` LIKE '%".$query."%') OR (`last_name` LIKE '%".$query."%')") or die(mysql_error());

        if(mysql_num_rows($raw_results) > 0){

            while($results = mysql_fetch_array($raw_results)){

                echo "<p><h3>".$results['description']."</h3>".$results['start_date']."</p>";
                         }    
        }
        else{
            echo "No results";
        }
    }
    else{ 
        echo "Minimum length is ".$min_length;
    }
?> 
```

我正在使用 echo 输出结果 `echo "<p><h3>".$results['description']."</h3>".$results['start_date']."</p>";`

但我想使用这种语法：

```
echo "<table>";
echo "<tr>
<th>Id</th>
<th><a href='viewaggrement.php?sort=description'>Description</th>
<th><a href='viewaggrement.php?sort=start_date'>Start Date</th>
<th><a href='viewaggrement.php?sort=end_date'>End Date</th>
<th><a href='viewaggrement.php?sort=balance'>Balance</th>
<th><a href='viewaggrement.php?sort=tax_value'>Tax </th>
<th><a href='viewaggrement.php?sort=amount_paid'>Amount Paid</th>
<th><a href='viewaggrement.php?sort=domain_name'>Domain Name</th>
<th><a href='viewaggrement.php?sort=hosting_name'>Hosting Name</th>
<th><a href='viewaggrement.php?sort=first_name'>First Name</th>
<th><a href='viewaggrement.php?sort=last_name'>Last Name</th>
<th>Edit</th>
<th>Delete</th>
</tr>";
echo "<table>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:17:09.973

这样的事情呢？

在开始循环遍历结果之前打开 table 标记并为每个结果创建一行。然后，当它完成对结果的循环时，关闭 table 标记。

```
<?php
    $query = $_GET['query'];      
    $min_length = 10;

    if(strlen($query) >= $min_length){ // if query length is more or equal minimum length then

        $query = htmlspecialchars($query); 

        $query = mysql_real_escape_string($query);

        $raw_results = mysql_query("SELECT * FROM aggrement
            WHERE (`description` LIKE '%".$query."%') OR (`start_date` LIKE '%".$query."%') OR (`end_date` LIKE '%".$query."%') OR (`balance` LIKE '%".$query."%') OR (`tax_value` LIKE '%".$query."%') OR (`amount_paid` LIKE '%".$query."%') OR (`hosting_name` LIKE '%".$query."%') OR (`domain_name` LIKE '%".$query."%') OR (`first_name` LIKE '%".$query."%') OR (`last_name` LIKE '%".$query."%')") or die(mysql_error());

        if(mysql_num_rows($raw_results) > 0){

        echo "<table>";
            while($results = mysql_fetch_array($raw_results)){

                echo "<tr>";
                    echo "<td>".$results['description']."</td><td>".$results['start_date']."</td>";
                echo "</tr>";
                         }    

        echo "</table>";
        }
        else{
            echo "No results";
        }
    }
    else{ 
        echo "Minimum length is ".$min_length;
    }
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:20:06.740

以下应该得到您需要的结果：

```
if(mysql_num_rows($raw_results) > 0){
    echo "<table>";
    // echo your header row here
    while($results = mysql_fetch_array($raw_results)){
        echo "<tr>";
        echo "<td>".$results['description']."</td>";
        echo "<td>".$results['start_date']."</td>";
        //And so on for each row you require
        echo "</tr>";
    }
    echo "</table>";
} 
```

# android - 同一活动/片段中的两个 ContextMenu

> ID：16043957
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:51.863
> 
> 标签：android, contextmenu

我有两个`ContextMenu`相同`Activity`或`Fragment`。

这是`onCreateContextMenu`我处理它们的地方：

```
@Override
public void onCreateContextMenu(ContextMenu menu, View v,
        ContextMenuInfo menuInfo) {

    menu.setHeaderTitle("Available Actions");

    if (v == listView) {

        AdapterContextMenuInfo info = (AdapterContextMenuInfo) menuInfo;
        position = info.position;

        menu.add(2, 1, 1, "Edit");
        menu.add(2, 2, 2, "Delete");
        menu.add(2, 3, 3, "Share");

    }

    if (v == iPP) {

        menu.add(1, 4, 1, "Pick From Gallery");
        menu.add(1, 5, 2, "Capture Picture");
        menu.add(1, 6, 3, "Remove");

    }

    super.onCreateContextMenu(menu, v, menuInfo);

} 
```

当我舔它时`listView`，它会很好地夸大“编辑、删除、共享”。但是当我点击 iPP 时，它会膨胀所有 6 个选项`iPP`和`listView`?

谁能看到发生了什么？

注： `iPP`是一个`ImageView`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T22:08:39.443

我打电话给两个`registerForContextMenu()`。一为`iPP`，一为`listView`。由于`iPP`在技术上是 的一部分`listView`，它在`header`，我的两个寄存器都在调用。所以我只是按照规则进行测试`listView` `position`而不是`View`类型。

```
 menu.setHeaderTitle("Available Actions");
        AdapterContextMenuInfo info = (AdapterContextMenuInfo) menuInfo;
        position = info.position;
        ListView lv = (ListView) v;
        int firstVisible = lv.getFirstVisiblePosition();
        View rowView = lv.getChildAt(position - firstVisible);

        if (position > 0) {
                    // if NOT in header
                } else {
                    // if Part of Header
                } 
```

# php - PHP表单发送空白邮件

> ID：16043958
> 
> 赞同：0
> 
> 时间：2013-04-16T18:01:52.790
> 
> 标签：php, forms, email

我已经在 SO 上搜索了一段时间，但似乎找不到问题的答案。我有一个 PHP 邮件脚本，可以成功地将电子邮件发送到正确的邮件地址，没有问题。我使用 Gmail 作为我的邮件客户端，它运行良好，但是当我在我的主机站点（mamutmail at active24）检查网络邮件时，我注意到很多电子邮件不会被重定向到 Gmail。

一年前我开始使用我的邮件脚本时，我也收到了很多空白邮件，即使我对表单进行了有效的验证。我每天收到大约 5 到 8 封空白邮件，但在我搜索了很多 Google 并认为这是“随机主机问题”之后，我决定在 Gmail 中过滤掉它们（我知道，这很愚蠢）。

所以，总结一下：

--> 从网站上的表单发送的邮件正在发送到主机 webmail，但有些没有导入到我的 Gmail

--> 我每天都收到很多空白邮件，即使我认为我有验证

这是我的表单代码：

```
<form id="mailForm" method="post" action="sendMailPre.php">
            Ditt namn <span style="color: red;">*</span><br/>
            <input type="text" name="name" class="required" /><br/><br/>

            Din mailadress <span style="color: red;">*</span><br/>
            <input type="text" name="mail" class="required email" /><br/><br/>

            Ditt telefonnummer<br/>
            <input type="text" name="tele" /><br/><br/>

            Din stad<br/>
            <input type="text" name="city" /><br/><br/>

            Ditt meddelande <span style="color: red;">*</span><br/>
            <textarea type="text" name="message" rows="8" class="required"></textarea><br/><br/>

            <input type="submit" class="submit" value="Skicka meddelande" /><br/><br/>
            </form> 
```

这是 PHP 中的邮件脚本：

```
$ToEmail = 'test@mail.com'; 
$EmailSubject = $_POST["name"] . ' - Mail från hemsidan';
$mailheader = 'From: ' . $_POST["name"] . '' . "\n" .
'Reply-To: ' . $_POST["mail"] . '' . "\n" .
"X-Mailer: PHP/" . phpversion()."\n";

$mailheader .= "MIME-Version: 1.0\n";
$mailheader .= "Content-Type: text/html; UTF-8\n";

$message = '<html><head>';
$message .= '<style>';
$message .= 'body{line-height: 60%; padding: 35px; margin: 0;}';
$message .= '</style></head>';
$message .= '<body>';
$message .= '<span style="font-family: Trebuchet MS; font-size: 16px; font-weight: bold; color: #4c7eb0; font-weight: normal;">NAMN</span><br/>';
$message .= str_replace("\n", "<br />", ($_POST["name"])); 
$message .= '<br/><br/>';
$message .= '<span style="font-family: Trebuchet MS; font-size: 16px; font-weight: bold; color: #4c7eb0; font-weight: normal;">MAIL</span><br/>';
$message .= str_replace("\n", "<br />", ($_POST["mail"])); 
$message .= '<br/><br/>';
$message .= '<span style="font-family: Trebuchet MS; font-size: 16px; font-weight: bold; color: #4c7eb0; font-weight: normal;">TELEFONNUMMER</span><br/>';
$message .= str_replace("\n", "<br />", ($_POST["tele"])); 
$message .= '<br/><br/>';       $message .= '<span style="font-family: Trebuchet MS; font-size: 16px; font-weight: bold; color: #4c7eb0; font-weight: normal;">STAD</span><br/>';   $message .= str_replace("\n", "<br />", ($_POST["city"]));  $message .= '<br/><br/>';
$message .= '<span style="font-family: Trebuchet MS; font-size: 16px; font-weight: bold; color: #4c7eb0; font-weight: normal;">MEDDELANDE</span><br/>';
$message .= str_replace("\n", "<br />", ($_POST["message"])); 
$message .= '</span>';
$message .= '</body></html>';
mail($ToEmail, $EmailSubject, $message, $mailheader) or die ("Meddelandet kunde inte skickas."); 
```

真的很感激一些帮助！先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:05:15.310

我敢打赌，您的脚本是这样设置的，任何时候任何人加载该页面都会触发一封电子邮件。我会包括一个隐藏变量：

```
<input type="hidden" name="formEmail" value="1"/> 
```

然后在 sendMailPre.php 页面上的 $_POST["formEmail"] 中检查它，并且仅在该变量存在时才发送电子邮件。

我最好的猜测是您可能正在让搜索引擎机器人访问该页面。

# ruby - Ruby 中的正则表达式问题

> ID：16043962
> 
> 赞同：-1
> 
> 时间：2013-04-16T18:02:13.380
> 
> 标签：ruby, regex

我有一个这样的字符串`/4/LM2301_800.mp4`。

我想使用正则表达式从文件名中删除`/4/`和。`_800`

我目前正在尝试使用 strip 命令。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:31:16.670

您的文件可能深深嵌套在目录结构中：

```
 path =  "/4/LM2301_800.mp4"
 path.sub(/^(\/.)*\/(.*)_\d+\.mp4/, $2)
 => "LM2301"    # you already know these are mp4 files, so you could add the suffix 
```

或者：

```
 path =  "/4/LM2301_800.mp4" 
 path.sub(/^(\/.)*\/(.*)_\d+\.(.*)/, $2+'.'+$3)
 => "LM2301.mp4" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T18:10:50.680

```
" /4/LM2301_800.mp4".scan(/.*\/(.*?)_\d*(.*)/).join
 => "LM2301.mp4" 
```

# block - CSF 防火墙：如何在不重新启动 CSF 的情况下阻止 IP

> ID：16043964
> 
> 赞同：2
> 
> 时间：2013-04-16T18:02:18.700
> 
> 标签：block, cpanel, firewall, whm, abuse

如何使用 Config Server Security & Firewall 动态（以编程方式）阻止 IP 地址？

我在 Centos (linux) 上使用 cPanel 和 WHM

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-04T10:27:04.190

您可以拒绝 csf 中的 ip，如下所示，但需要刷新 csf，因为每个服务在重新启动或刷新后都会应用更改。

拒绝 IP

> csf -d IP地址

刷新：

> 脑脊液 -r

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-23T09:05:11.890

> 如何在不重新启动 CSF 的情况下阻止 IP

通过 csf -r 重启 csf 没什么大不了的。您无需采取任何预防措施来执行此操作。因此，使用或不使用 csf restart 阻止 IP 具有相同的效果。

csf 与 iptables 一起工作，因此对于拒绝 IP，您可以使用“csf -d IP”而不是编写 iptable 规则。

csf 简化了防火墙的工作。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-17T23:05:34.170

这里的其他答案现在似乎已经过时了。阻止 IP 地址后不再需要重新加载 CSF。这是一些示例输出：

```
sudo csf -d 10.0.0.1 do not delete

Adding 10.0.0.1 to csf.deny and iptables DROP...
DROP  all opt -- in !lo out *  10.0.0.1  -> 0.0.0.0/0  
LOGDROPOUT  all opt -- in * out !lo  0.0.0.0/0  -> 10.0.0.1 
```

这[是 CSF 论坛上的一个帖子，](https://forum.configserver.com/viewtopic.php?f=6&t=10248)证实了这一点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-02T00:58:09.967

我已经测试了在不重新启动的情况下阻止几个 IP 并且它可以工作。如果您从 csf.deny 中删除 IP，您只需要重新启动，例如：

```
csf -dr 1.1.1.1
csf -r 
```

# r - 如何在grid.arrange（来自gridExtra）中为tableGrobs指定标题？

> ID：16043971
> 
> 赞同：4
> 
> 时间：2013-04-16T18:02:49.140
> 
> 标签：r, gridextra

看起来`grid.arrange()`忽略了 的`name`属性`tableGrob`。假设我想绘制带有标题的表格......

```
baz<-lapply(seq(3),function(ii)
 tableGrob(format(matrix(runif(8),nrow=2,
    dimnames=list(LETTERS[1:2],letters[1:4])),digits=3),
    name=paste0('n',ii))); 
```

这绘制了它们但没有标题：`do.call(grid.arrange,c(baz,nrow=1))`

创建 textGrobs 列表、计算它们的高度等似乎有点过头了。我只想强制在每个表的标题上方多出一行，显示我给该表的名称。或者一些内置的参数来这样做。

# java - 在 InputStream / Scanner 中发出哔声

> ID：16043972
> 
> 赞同：1
> 
> 时间：2013-04-16T18:02:51.127
> 
> 标签：java, inputstream, java.util.scanner, beep

我正在查看[这个答案](https://stackoverflow.com/a/5445161/1292230)，我注意到分隔符设置为`\\A`，这是哔声，对吗？为什么使用哔哔声`InputStream`？我对什么是哔哔声仍然很模糊（不只是为了文字哔哔声吗？），所以我很困惑为什么它在这里被用作分隔符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T18:08:15.307

`\A`是字符串的开头。它的不同之处`^`在于，大多数正则表达式实现`^`在换行符之后也匹配，而`\A`没有。

`\a`是铃铛字符。

# c# - 使我所有的方法都需要 https 是个好主意吗？

> ID：16043973
> 
> 赞同：4
> 
> 时间：2013-04-16T18:02:52.267
> 
> 标签：c#, asp.net, asp.net-web-api

我正在使用 asp.net web api，并且正在使用基本身份验证来授权我的用户。我在所有需要授权的调用上都需要 HTTPS，但是对于我不需要授权（即注册）的所有调用，我是否也应该在 https 中进行它们以保持一致性？如果我不使用 https 进行这些调用，是否会导致性能提升等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T18:06:21.830

如今，HTTPS 的开销对于大多数系统来说都是微不足道的（请参阅[SSL 会施加多少开销？](https://stackoverflow.com/questions/548029/how-much-overhead-does-ssl-impose)）。我到处都是 HTTPS 的粉丝，因为它端到端更安全，实施起来几乎没有成本，但你的里程可能会有所不同。如果您担心它可能对性能产生影响，请实施它，然后分析您的应用程序，看看有什么区别

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-16T18:05:58.460

`Http`由于 https 中的加密增加了请求和响应的大小，并且加密和解密需要额外的处理，因此提供了更高的性能。今天的机器可以非常快速地处理`https`开销，而没有任何明显的性能下降。安全性比**性能提升更重要**，如果您必须通过用户名/通过注册，那么这可能是对安全性的破坏。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-16T18:19:55.293

根据您的标签，我将假设这里可能正在进行一些 AJAX。如果确实如此，那么坚持使用单一访问方案会更好。否则会引入跨浏览器兼容性问题，并可能引入安全漏洞。

除非您正在做诸如传输大型媒体文件/流之类的事情，否则适度的性能提升可能甚至不值得考虑。

注意：潜在漏洞超出了通过不安全连接发送敏感数据的明显情况。例如，请参阅[https://developer.mozilla.org/en-US/docs/Security/MixedContent](https://developer.mozilla.org/en-US/docs/Security/MixedContent)。

# ruby-on-rails - Rails 控制器——只返回处理后的数据（不要加载到视图中）

> ID：16043975
> 
> 赞同：1
> 
> 时间：2013-04-16T18:03:04.393
> 
> 标签：ruby-on-rails, controller

我是 Ruby 和 Rails 的新手。我刚刚完成了 Laravel 的一门课程，所以我了解 MVC 系统（就基本概念而言不是新手）。

我有一个很简单的问题，

我正在向我的 RAILS REST API 发送 POST 请求，post 请求的主体包含一个像这样的 json 编码字符串--->

```
 Array ( [method] => POST [timeout] => 45 [redirection] => 5 [httpversion] => 1.0 [blocking] => 1 [headers] => Array ( ) [body] => {"post_content":"here is the post","post_title":"here we are ","post_author":"1"} [cookies] => Array ( ) ) 
```

如您所见，它来自我的基于 php 的博客。我的 Rails API 应该通过将单词与我在 SQLite 数据库中的一些内容进行比较来获取帖子内容并自动添加指向某些单词的链接。

好的，所以我的问题是：我只想要来自 Rails 控制器的响应，我不想将任何东西加载到视图中。Rails 控制器 - 返回内容，在我的数据库中找到的单词周围带有“a href”标签。这将作为对我的发布请求的响应发回，我想直接访问它作为响应的正文。截至目前，我不知道该怎么做。Laravel 有能力在控制器动作结束时“返回”任何你想要的东西，但在 Rails 中，一切似乎都想加载到视图中。我在这里研究了一些问题，发现一个说'render：nothing => true'的问题，但根本没有渲染任何东西。这就是我的代码的样子。

```
def process
content = params['post_content']
##perform db function and get back the content with the links embedded.
##HOW TO RETURN THIS CONTENT. 
end 
```

我个人认为，我必须使用 render_to_string 方法，但我不知道该怎么做。

任何帮助表示赞赏。最好的问候，理查德·麦德森。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T18:13:47.850

需要考虑的一些选项：

仅将原始字符串呈现为 http 响应正文：

```
render :text => content 
```

渲染没有默认周围布局的视图：

```
render :layout => false 
```

在这种情况下，您的观点可能只是：

```
<%= @content %> 
```

或者将内容渲染为 json：

```
render :json => { :content => content } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-16T18:11:49.190

问题是，你想要返回什么？文本？XML？JSON？

我将假设您希望根据输入的 JSON 返回 JSON。

```
respond_to do |format|
    format.json { render json: @someobject }
end 
```

查看控制器方法的其余部分可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-16T18:07:56.353

如果我理解正确，相信您正在寻找的是

```
render :text => "response" 
```

还有 - JSON、XML、nothing、js、文件等 - 更多信息在这里[http://guides.rubyonrails.org/layouts_and_rendering.html](http://guides.rubyonrails.org/layouts_and_rendering.html)

# sql - 左连接查询而不是不存在

> ID：16043980
> 
> 赞同：0
> 
> 时间：2013-04-16T18:03:22.757
> 
> 标签：sql, left-join, max, not-exists

我有一个执行不佳的“不存在查询”。所以我认为“左连接查询”会执行得更好，但事实并非如此。我在 VBA 中运行这些查询。

这是我的“不存在查询”

```
SELECT * FROM MyTable AS t1
WHERE t1.ID_person = 1960081947465
and t1.ID_company <> 68550
and t1.FullTime + 26.3 >= 37.33 
and t1.Date <= 20130101
and t1.Code not in (31,28) 
and t1.FullTime < 100          
and not exists (
                  select * from MyTable t2 where 
                  t1.ID_person = t2.ID_person 
                  and t2.ID_company <> 68550
                  and t2.FullTime + 26.3 >= 37.33 
                  and t2.Date <= 20130101 
                  and t2.Code not in (31,28) 
                   and t1.Date< t2.Date 
                 ) 
```

这是我试图达到相同结果但使用“左连接查询”的方式

```
SELECT * FROM MyTable AS t1
LEFT JOIN
(
 select * from MyTable t2 where
 and t2.ID_company <> 68550
 and t2.FullTime + 26.3 >= 37.33
 and t2.Date <= 20130101
 and t2.Code not in (31,28)
 ) subq
 ON t1.ID_person = subq.ID_person and t1.Date < subq.Date 
 WHERE t1.ID_person = 1960081947465
 and t1.ID_company <> 68550
 and t1.FullTime + 26.3 >= 37.33
 and t1.Date <= 20130101
 and t1.Code not in (31,28)
 and t1.FullTime < 100          
 and subq.ID_person IS NULL 
```

为什么“左连接查询”的性能较差？我以为它会更快。我有相同查询的第三个版本，但使用“不在”。该查询与“不存在查询”非常相似，我认为我不需要在这里发布它。

任何人都可以提出更好/更快的“左连接查询”吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T10:06:59.170

我会说您需要以与它们在子句中出现的*顺序相同的顺序对参与 join/where 子句的*`where`所有列进行索引。确保您拥有各自的索引，并且 the`not exists`和 the`join`都应该执行类似且快速的操作。

# c# - 基于 bool 方法的自定义 MVC4 验证

> ID：16043984
> 
> 赞同：3
> 
> 时间：2013-04-16T18:03:44.990
> 
> 标签：c#, asp.net, validation, asp.net-mvc-4

我有一个验证数字的方法，我没有正则表达式，因为创建起来有点复杂。

```
public bool IsRegistrationNumberValid(int number)
{
...

} 
```

在我的表单上，我有一个文本框，我想为此列添加验证。如何创建自定义注释或挂钩到 ModelState 对象以添加错误消息？

我的 POST 控制器操作如下：

```
 [HttpPost]
    public ActionResult Create(UserRegistrationViewData model)
    {
        if (ModelState.IsValid)
        {
        ...
        }
    } 
```

我不确定我有什么选项，我可以创建一个自定义属性来添加到我的模型中吗？和/或我是否应该在检查之前加入模型状态并添加错误消息`ModelState.IsValid`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-16T18:33:17.240

有几种方法可以解决这个问题，最适合您的方法取决于以下几点：

*   `IsRegistrationNumberValid`您的方法位于何处以及逻辑是否被移动？
*   您是否正在验证用户输入或域的完整性（您应该同时检查两者，但每个验证将在不同的位置）？
*   个人喜好。

在我看来，您有以下可用选项：

1.  在您的控制器操作方法中验证。
2.  使用`IValidatableObject`接口进行验证。
3.  使用自定义`ValidationAttribute`.
4.  在您的服务层中验证。

**选项 1：在您的控制器中验证：**

首先，您可以简单地验证控制器操作方法中的值并更新`ModelState`如下：

```
[HttpPost]
public ActionResult Create(UserRegistrationViewData model)
{
    if (ModelState.IsValid)
    {
        if (!someObject.IsRegistrationNumberValid(model.value))
        {
            ModelState.AddModelError("PropertyName", "There is an error..");
            Return View()
        }
        else
        {
            // Carry out successful action here...
        }
    }
} 
```

**选项2：使用`IValidatableObject`接口。**

第二种更简洁的方法是`IValidatableObject`在 viewModel 上实现接口，以便您可以将逻辑移出控制器：

```
public class ViewModel : IValidatableObject
{
    public int Value { get; set; }

    IEnumerable<ValidationResult> IValidatableObject.Validate(ValidationContext validationContext)
    {
        if (!staticClass.IsRegistrationNumberValid(this.Value))
        {
            yield return new ValidationResult("An error occured");
        }
} 
```

**选项 3：创建自定义验证属性。**

如前所述，您可以通过从`ValidationAttribute` [本文中所示](http://msdn.microsoft.com/en-gb/library/cc668224%28v=vs.100%29.aspx)的派生来创建自定义验证属性。

接口和自定义验证属性之间的选择`IvalidatableObject`通常取决于偏好，但是，接口获胜的一种情况`IValidatableObject`是您的验证取决于多个属性（例如检查一个日期是否在另一个之后）。

**选项 4：在您的服务层中验证。**

最后，如果您的验证依赖于数据库中的其他信息，您可能需要查看本教程关于[使用服务层进行验证](http://www.asp.net/mvc/tutorials/older-versions/models-%28data%29/validating-with-a-service-layer-cs)。这篇文章并不完美（服务和控制器的耦合有点太紧了），但它是一个好的开始，通过一些修改，您可以以非常透明和用户的方式将数据库验证错误（例如主键违规）传递到您的用户界面中-友好的方式。

您最终可能会混合使用选项 2、3 和 4。如果可能的话，您并不想使用第一个选项，因为它会使您的控制器方法更复杂，并且更难以在其他地方重用验证逻辑。

我的建议如下：

*   如果您正在验证用户输入的完整性（例如检查日期格式是否正确），请混合使用`IValidatableObject`接口和`ValidationAttribute`类。
*   如果您正在验证域的完整性（确保没有输入重复的实体，或者定义了实体之间的关系），请在服务层中执行验证。

# paypal - PayPal 自适应支付费用付款人和没有银行账户的账户

> ID：16043986
> 
> 赞同：2
> 
> 时间：2013-04-16T18:03:46.210
> 
> 标签：paypal

我的应用程序使用自适应支付服务向用户发送付款。如果用户的 PayPal 账户没有附加银行账户并且他们的账户没有经过验证，PayPal 会向他们发送一封电子邮件，他们需要单击该电子邮件中的“索赔”按钮才能收到他们的付款。

问题是这个过程似乎改变了交易最初设置的费用支付者。我的应用程序将费用支付者设置为“SENDER”，在上面的示例中，PayPal 似乎将其更改为“RECEIVER”。

有谁知道为什么会发生这种情况？这是代码的摘录……对我来说似乎很简单……

```
$payRequest = new PayRequest(new RequestEnvelope("en_US"), 'PAY', $cancelURL, 'USD',     $receiverList, $returnURL);
$payRequest->feesPayer = 'SENDER';
$payRequest->senderEmail = $senderAccount;
$service = new AdaptivePaymentsService();
$response = $service->Pay($payRequest); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T14:57:41.487

我最终将这个问题直接提交给了 PayPal 支持，最终得到了以下回复：

> 根据支付 API 参考； [https://www.x.com/developers/paypal/documentation-tools/api/pay-api-operation](https://www.x.com/developers/paypal/documentation-tools/api/pay-api-operation)，“发送者”不能是单边支付的费用支付者（支付给尚未注册 PayPal 的用户） . 这可能就是您看到它改为“Receiver”的原因。

所以，显然这是设计使然，没有办法绕过它。

# spring - 如何使用 jndi 和 SSL 为 Tibco 配置 Spring App-context.xml？

> ID：16043988
> 
> 赞同：1
> 
> 时间：2013-04-16T18:03:50.450
> 
> 标签：spring, ssl, jms, tibco

有没有人有一个教程/示例，用于 Spring 的 app-context.xml 使用 jndi 通过 ssl 服务器连接到 TIBCO jms 队列？我一直找不到。

# c# - 使用 libgit2sharp 进行导出

> ID：16043991
> 
> 赞同：1
> 
> 时间：2013-04-16T18:04:00.883
> 
> 标签：c#, git, export, clone, libgit2sharp

我在 .net 应用程序中使用 libgit2sharp。我想从 github 获取一个目录。我现在可以通过使用 Repository.Clone 克隆整个目录来做到这一点。但这需要很长时间，而且我获取的文件比我需要的要多。例如 .git-repository 以及一些我不感兴趣的文件夹。

有没有办法可以使用 libgit2sharp 从 git 存储库中导出单个文件夹？还是我应该以另一种方式做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T18:41:43.710

Git 不支持部分拉取（即仅检索一个文件夹）。

但是，git 允许**不**检索存储库的整个历史记录，而是检索它的截断版本，仅包含**n 个**最新版本。此操作称为**[浅克隆](https://www.google.com/search?q=git+clone+shallow)**。

libgit2/LibGit2Sharp 目前没有浅层克隆支持。然而。

但是，它最终会得到支持。甚至在 LibGit2Sharp 问题跟踪器中打开了一个功能请求。您可以通过订阅**[issue 229来跟踪进度](https://github.com/libgit2/libgit2sharp/issues/229)**

# google-maps-api-3 - 根据搜索条件动态设置附近搜索的范围

> ID：16043994
> 
> 赞同：0
> 
> 时间：2013-04-16T18:04:08.210
> 
> 标签：google-maps-api-3, google-places-api

我们已经在我们的页面上实现了一个搜索框和谷歌地图，以允许客户根据地点查询执行搜索，到目前为止它运行良好。然而，使用 TextSearch 我们几乎总是得到 20 个结果（除非它是一个特定的点）。不过，我们更喜欢的是根据用户的搜索返回一组对用户更有意义的结果（即，如果他们正在搜索邮政编码内的教堂，我们不应该显示邮政编码以外的教堂）。

我知道我们可以根据位置和半径对结果进行偏差，甚至使用 NearbySearch 根据位置/半径限制结果。

但是，我们的客户是可能在世界任何地区搜索的国家用户，所以在用户搜索之前，我们不确定要设置什么位置和半径作为限制。我想根据他们的查询动态确定。

例如，在 Google 地图中，如果您搜索“30319 附近的教堂”，您将获得比“乔治亚附近的教堂”更加本地化的结果集

30319 附近的教堂： [https ://maps.google.com/maps?q=churches+near+30319&hl=en&sll=33.772251,-84.296934&sspn=0.049158,0.082312&hq=churches&hnear=Atlanta,+Georgia+30319&t=m&z=14](https://maps.google.com/maps?q=churches+near+30319&hl=en&sll=33.772251,-84.296934&sspn=0.049158,0.082312&hq=churches&hnear=Atlanta,+Georgia+30319&t=m&z=14)

格鲁吉亚附近的教堂： [https ://maps.google.com/maps?q=churches+near+Georgia&hl=en&sll=33.870438,-84.332304&sspn=0.049102,0.082312&hq=churches&hnear=Georgia&t=m&z=8](https://maps.google.com/maps?q=churches+near+Georgia&hl=en&sll=33.870438,-84.332304&sspn=0.049102,0.082312&hq=churches&hnear=Georgia&t=m&z=8)

我已经测试过使用地理编码进行单独的查询以获取查询的单点位置。IE

```
getGeneralVicinity = ->
  address = $('#address').val()
  window.oneq.geocode.geocoder.geocode
    address: address,
    (results, status) ->
      if status is google.maps.GeocoderStatus.OK
        console.log(results[0].types) 
```

似乎通过可能找到地理编码结果的类型（即位置），我们可以确定半径并使用geometry.location 作为位置边界。不幸的是，它并不一致，如果用户只搜索“教堂”，这不会给我们想要的结果。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:45:10.813

你几乎拥有它。我将地理编码 API 称为它的 JSON 提要，而不是它的 Google 实现，因此详细信息将直接来自源代码。地理编码时会返回一些非常有趣的参数。试试看：

*   格鲁吉亚：[http ://maps.googleapis.com/maps/api/geocode/json?address=georgia&sensor=true](http://maps.googleapis.com/maps/api/geocode/json?address=georgia&sensor=true)
*   30319：[http ://maps.googleapis.com/maps/api/geocode/json?address=30319&sensor=true](http://maps.googleapis.com/maps/api/geocode/json?address=30319&sensor=true)

两个第二层地址组件都是乔治亚州。但是，有一些不同的参数，您想要的是`geometry`. 这表示该区域的形状。

以 30319 请求为例。您将获得以下限制：

```
"bounds" : {
           "northeast" : {
              "lat" : 33.9203610,
              "lng" : -84.30943599999999
           },
           "southwest" : {
              "lat" : 33.83286890,
              "lng" : -84.35826589999999
           }
        },
        "location" : {
           "lat" : 33.87309460,
           "lng" : -84.33842899999999
        }, 
```

这告诉你三件事：

*   边界框的角
*   盒子的中心（将是顶点线的交点）

这使您可以计算距中心的最大距离，然后您可以将其作为半径反馈到您的 google 地方 API 搜索中。从纬度/经度到距离的转换是微不足道的：它被称为正向路径。存在两个公式 - 一个用于小距离（[Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)），另一个用于大距离（[this](http://en.wikipedia.org/wiki/Great-circle_distance)）。有人为这些写了一个计算器：[http](http://williams.best.vwh.net/gccalc.htm) ://williams.best.vwh.net/gccalc.htm 。您会很快看到 30319 的边界框跨越 10 公里，而乔治亚州的边界框跨越近 700 公里（这需要多个 Google 地方信息请求才能匹配）。

如果不清楚，请告诉我，我会进一步详细说明。