# StackOverflow 问答 13997000-13997999

# javascript - 如何访问 Require.js 的配置

> ID：13997001
> 
> 赞同：42
> 
> 时间：2012-12-21T20:47:42.423
> 
> 标签：javascript, requirejs

我尝试`baseUrl`在模块中获取 Require.js 的配置，但找不到它的存储位置。

```
define([], function() {
  // Here I'd like to access the `baseUrl` require.js is using
  var baseUrl = requirejs.config().baseUrl;
}); 
```

就我而言，这`baseUrl`是由 Require.js 使用`data-main`脚本文件的属性设置的。

我知道我可以请求`module`访问`config`属性（例如`define(['module'])`），但我找不到如何访问更高级别的配置选项。

* * *

## 回答 #1

> 赞同：98
> 
> 时间：2014-02-05T14:26:03.153

您还可以将配置访问：

```
requirejs.s.contexts._.config 
```

直接检查配置对象。

[https://groups.google.com/forum/#!topic/requirejs/Hf-qNmM0ceI](https://groups.google.com/forum/#!topic/requirejs/Hf-qNmM0ceI)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-05-14T15:39:01.457

在 RequireJS 2.1.5 中，您可以像 epascarello 所说的那样获取基本 URL，除了您需要传递空字符串。

```
var baseURL = require.toUrl(''); 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-12-21T20:58:06.470

你想使用[toUrl](http://requirejs.org/docs/plugins.html#apiload)吗？

```
define({
    load: function (name, parentRequire, load, config) {
           var fullUrl = parentRequire.toUrl("foo/bar.css");
    }
}); 
```

**编辑：**
从 require.js 2.1.3 开始，[调用`toURL`return path without extension](http://jrburke.com/2013/01/22/requirejs-2.1.3-released/)。因此，要获取 baseUrl：

```
var baseURL = require.toUrl(); 
```

# sql - 插入触发器将无法正常工作

> ID：13997002
> 
> 赞同：3
> 
> 时间：2012-12-21T20:48:01.913
> 
> 标签：sql, sql-server, triggers, sql-update

我正在尝试创建一个数据库触发器，当用户将数据插入表中时，它将更新表的字段中的某些字符......例如。

```
ID  EXCHANGE   LEADRT
1    new         L-3
2    new         3
3    new         5 
```

所以我想单独留下 id 1，因为 LEADRT 的格式是正确的，但 ids 2 和 3 不是。

```
CREATE TRIGGER triggerupdate ON PoleUnits FOR INSERT, 
UPDATE AS 
if not exists (select * from Poleunits where LEADRT like '%L-%') 
update PoleUnits set LEADRT = STUFF (LEADRT, 1, 0,'L-'); 
```

有什么想法为什么我不能让它工作或关于如何完成这个的更好的建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T20:56:14.963

在插入和更新触发器中，您可以访问一个特定的表，该表称为`inserted`要插入/更新的行所在的位置。这些不是真正的表，它们只是与触发触发器的表具有相同结构的逻辑表。

您当前的逻辑适用于原始表，因此适用于所有现有数据，但不适用于您实际插入的数据，即它将更新除您实际想要更新的数据之外的所有内容。像这样的东西可以工作：

```
CREATE TRIGGER triggerupdate ON PoleUnits 
FOR INSERT, UPDATE AS 
  update PoleUnits
  set LEADRT = STUFF (PoleUnits.LEADRT, 1, 0,'L-')
  from PoleUnits 
    inner join inserted  -- this is basically a self join
      on PoleUnits.ID = inserted.ID
  where PoleUnits.LEADRT not like '%L-%' 
```

这只会更新正在插入的 PoleUnits 中的那些行，并且仅当它们的 LEADRT 字段不是 L 格式时。

# c#-4.0 - C# 并发、固定大小的队列，能够引用单个项目

> ID：13997004
> 
> 赞同：2
> 
> 时间：2012-12-21T20:48:06.040
> 
> 标签：c#-4.0, collections, queue

我需要以下集合：

1 - 固定尺寸长度。因此，它会在达到固定大小限制时自动将尾部出列。

2 - 可以访问单个元素，不一定只访问头部或尾部。

3 - 先进先出。

4 - 允许安全的并发访问（但是，我现在可以在这个位上妥协）。

5 - 入队和出队方法。

我正在使用 .NET 4.5 并且知道 ConcurrentQueue 类，但是它缺少第 1 点和第 2 点。我正在考虑构建实现 IEnumerable 并在后台使用 IList 的类。

我可以从 ConcurrentQueue 继承，但是我需要不断地访问 body 元素（不仅仅是头部和尾部）并且每次都枚举它是低效的。

你有更好的方法还是你推荐任何做类似工作的集合？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T20:55:55.893

围绕列表或数组构建包装器。提供您想要的队列方法，跟踪大小等。将您自己的并发要求编程到此类中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T20:58:35.183

使用基于 old plain 的队列实现`System.Array`。你的观点：

1 - 数组具有固定长度。

2 - 根据定义可以访问 O(1) 中的单个元素。

3 - 这将是队列，因此它是 FIFO。

4 - 数组将是并发安全的，仅`lock`用于 Enqueue 和 Dequeue 方法。

5 - 轻松实现它们。

# image-processing - 为什么使用 OpenCV 读取 AVI 视频时速度会加快？

> ID：13997005
> 
> 赞同：2
> 
> 时间：2012-12-21T20:48:07.767
> 
> 标签：image-processing, opencv, computer-vision, avi

我正在尝试使用 openCV 读取 AVI 文件。获得捕获后，当我为 while 循环提供一个条件时，问题就出现了，该条件控制 queryFrame 将完成的程度。视频共有 1251 帧。

当我使用`while (counter <= number_of_frames)`时，视频运行良好，当我使用时`while (cvQueryFrame(capture))`，视频运行良好，直到第 200-250 帧，然后突然开始运行更快，并在第 625 帧结束。我打印了 FPS，它一直保持不变。

为什么会这样？？请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-23T05:52:43.637

尝试以下...

**C风格阅读..**

```
#include <opencv2/video/video.hpp>
#include <opencv2/core/core.hpp>
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/imgproc/imgproc.hpp>

using namespace cv;

int main()
{
  CvCapture *video;
  video = cvCreateFileCapture("ADDRESS TO THE FILE");
  IplImage *frame;

  while(true)
  {
    frame = cvQueryFrame(video);
    if(frame->imageData==NULL)
      {
        std::cout<<"END OF VIDEO"<<std::endl;
        break;
      }
    cvShowImage("VIDEO",frame);
    cvWiatKey(25);//SINCE MOST OF THE VIDEOS RUN AT 25 FPS
   }
  return 0;
} 
```

**C++ 风格....**

```
int main()
{
  VideoCapture video("ADDRESS OF VIDEO");
  Mat frame;

  while(true)
  {
    video >> frame;
    if(frame.data==NULL)
      {
         std::cout<<"END OF VIDEO FILE"<<std::endl;
         break;
      }
    imshow("VIDEO",frame);
    waitKey(25);
   }
return 0;
} 
```

试试这个...并检查它是否提供统一的播放速度...

# visual-studio - 如何在 VS 2012 中保存 SQL 模式比较选项？

> ID：13997014
> 
> 赞同：19
> 
> 时间：2012-12-21T20:48:24.597
> 
> 标签：visual-studio, visual-studio-2012, schema-compare

VS 2010 有一种[保存模式比较选项](http://msdn.microsoft.com/en-us/library/aa833234%28v=vs.100%29.aspx)的方法，以便将它们应用于所有模式比较。

VS 2012 似乎只保留了单个比较的选项；一旦我关闭窗口，我的所有选项都会恢复为默认值。

如何在 VS 2012 中保留 SQL 模式比较选项？

**ps**我最终用我的设置保存了架构比较 (.scmp)，现在我只是打开该文件而不是创建“新架构比较”。很遗憾，VS2010 的功能没有进入 VS2012。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-28T09:30:44.877

看看这个 MSDN 线程：

[http://social.msdn.microsoft.com/Forums/en-US/ssdt/thread/3110809b-fa51-485e-91cb-4f530f84c924](http://social.msdn.microsoft.com/Forums/en-US/ssdt/thread/3110809b-fa51-485e-91cb-4f530f84c924)

> 没有全局设置，但您可以将比较保存为 .scmp 文件，其中包含您的比较选项。此外，如果您从 SQL 菜单创建一个模式比较文件（因此它没有选定的源或目标），设置您想要的选项然后保存文件，您可以创建一个模板以供将来比较。

# php - Zend_Mail 中的 UTF-8 发件人名称？

> ID：13997015
> 
> 赞同：5
> 
> 时间：2012-12-21T20:48:30.787
> 
> 标签：php, zend-framework, utf-8, zend-mail

我正在使用 Zend_Mail 并想自定义发件人姓名。

我希望发件人姓名为**FooBar爱你瑞安**（其中 'Ryan' 被替换为收件人姓名，而爱你被替换为收件人语言中的 'loves' 的翻译，[就像 CD Baby 所做](http://goo.gl/1Bwxq)的那样）。

我已经尝试过[base64_encode](https://stackoverflow.com/a/4389755/470749)和[mb_encode_mimeheader()](https://stackoverflow.com/a/4392582/470749)以及其他类似的东西：

```
mb_internal_encoding('UTF-8');
mb_http_output('UTF-8');
iconv_set_encoding("input_encoding", 'UTF-8');
iconv_set_encoding("output_encoding", 'UTF-8');
iconv_set_encoding("internal_encoding", 'UTF-8'); 
header('Content-Type:text/html; charset=' . 'UTF-8'); 
```

它生成这个作为发件人：`'=?UTF-8?B?RXh0cmFidXjniLHkvaByY3dhbHNoQGV4dHJhYnV4LmNvbQ==?= <email@example.com>'`

然后在我的 Gmail 中显示为`(unknown sender)`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-14T10:15:15.043

对我来说，唯一有效的解决方案如下：由于您在通常的 php sendmail 案例中设置了 utf8 主题，您可以像这样创建一个带有 utf8 注释的 base64 字符串：

```
$mail->addFrom($fromEmail, '=?utf-8?B?'.base64_encode($fromName).'?='); 
```

有了这个解决方案，每件事都像魅力一样发挥作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T21:44:06.940

我希望我早点尝试过：当我将中文字符串硬编码为发件人姓名（使用 utf8 字符）时，它工作正常。（我只在 Gmail 中测试过。）

所以我一直走的路是错误的。

我需要弄清楚为什么一个由 utf8 字符组成的动态生成的发件人名称在硬编码的中文字符串起作用时不起作用。但这似乎是一个不同的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-01T04:48:54.530

这是一个很好的问题，答案也很好——但是 ZendFramework 先进，并且引用的接口不幸已经过时了。

因此，这是相同的解决方案，但在 2017 年 6 月测试可以正常工作：

```
private static function ecvt($string)
{
    return mb_convert_encoding($string, 'ISO-2022-JP', 'UTF-8');
}
private static function hcvt($string)
{
    return "=?iso-2022-jp?B?" . base64_encode( self::ecvt($string) ) . "?=";
}
private function sendMail( )
{
    $mail = new Message();

    $content = 'Message body　日本語も';

    $mail->getHeaders()->addHeaderLine('Content-Type', 'text/plain; charset=ISO-2022-JP');

    $mail->setFrom('sender@acme.com', self::hcvt('Sender　日本語も') );
    $mail->addTo('receiver@acme.com', self::hcvt('Receiver 日本語も') );
    $mail->setSubject(self::hcvt('Some subject　日本語も'));

    $mail->setBody( self::ecvt($content) );
    $mail->setEncoding('ISO-2022-JP');

    // this is critical - it works around a bug in zendframework3 where
    // MIME encoding is botched in headers. By switching headers to ASCII,
    // I basically do the encoding myself.
    $mail->getHeaders()->setEncoding('ASCII');

    $this->mailTransport->send( $mail );
} 
```

所有这一切的基础真的在这里 - 很好读，所以你知道发生了什么：RFC2047 [https://www.ietf.org/rfc/rfc2047.txt](https://www.ietf.org/rfc/rfc2047.txt)

# z3 - 在 Z3 中使用证明目标减少使用的子句数量

> ID：13997022
> 
> 赞同：1
> 
> 时间：2012-12-21T20:49:26.240
> 
> 标签：z3, smt, theorem-proving

我正在尝试优化使用 Z3 来证明有关一阶理论的事实。目前，我在 Python 中指定了一个一阶理论，将量词固定在那里，并将所有子句连同证明目标的否定一起发送到 Z3。我有以下想法，希望可以优化结果：我只想将与证明目标*相关的理论公式发送到 Z3。*我不会详细讨论这个概念，但我认为直觉很简单：我的理论是公式的合取，我只想发送可能影响证明目标真值的合取。

我的问题是：这是否会导致效率的提高，或者 Z3 是否已经使用了类似的方法？我猜不会，因为我不认为 Z3 总是假设最后一个断言是证明目标，所以它没有办法对此进行优化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:52:36.247

是的，删除不相关的事实可以产生很大的不同。假设我们有一个形式为 的不可满足的公式`F_1 and F_2 and (not G)`。此外，让我们假设它`F_1 and (not G)`是不可满足的，并且`F_2`是可满足的。`F_2`就是你所说的无关紧要。如果在将配方发送到 Z3 之前有一种便宜的方法可以去除`F_2`，它可能会产生很大的不同。

Z3 具有“忽略”不相关事实的启发式方法，但它们只是启发式方法。对于我们的示例，最坏的情况是`F_2`Z3 很难满足的情况。Z3 本质上是在尝试构建满足输入公式（`F_1 an F_2 and (not G)`我们工作示例中的公式）的解释/解决方案。当 Z3 可以表明不可能建立解释时，公式是不可满足的。在实践中，该公式`F_2`对于 Z3 无关紧要，前提是它可以快速表明它是可满足的，并且对于 的解释/解决方案`F_2`不冲突`F_1 and (not G)`。如果不是这样，Z3 会浪费大量资源`F_2`。

# magento - 为什么我的页面会出现此错误？致命错误：在非对象上调用成员函数 addToChildGroup()

> ID：13997031
> 
> 赞同：0
> 
> 时间：2012-12-21T20:51:12.813
> 
> 标签：magento

这是完整的错误：

```
Fatal error: Call to a member function addToChildGroup() on a non-object in WEBSITE/app/code/core/Mage/Core/Block/Abstract.php on line 759 
```

我得到一个纯白的屏幕，然后打开错误消息，这就是出现的问题。提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-14T09:15:02.547

xml 块有错误。您在哪个页面/网址上遇到此错误？

我在产品的详细信息页面上遇到了这个错误，所以我猜问题出`catalog.xml`在基本布局中。xml 块`<catalog_product_view>`有问题。

`catalog.xml`从默认布局复制以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T06:18:00.643

我的问题是无效的 catalog.xml。首先尝试验证您的 xml 文件。我使用了命令行工具 xmllint。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-26T11:07:03.103

我知道这篇文章差不多一年前了，但我今天遇到了同样的问题。

我所做的是刷新缓存并重建索引。希望这可以帮助将来遇到同样问题的程序员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-01T20:43:31.893

问题在于您的 catalog.xml 文件。从默认文件夹中复制 catalog.xml 文件并将其添加到您当前的主题文件夹中。问题将得到解决。

# scala - Play 2 Scala 使用几个枚举器（PatchPannel？）提供一个 Websocket 输出 Iteratee

> ID：13997037
> 
> 赞同：2
> 
> 时间：2012-12-21T20:51:41.857
> 
> 标签：scala, playframework, websocket, iterate

我想逐步为 WebSocket 输出 Iteratee 提供几个枚举器（例如，当我通过 Websocket 输入 iteratee 接收到特定事件时，我想向输出 Iteratee 添加一个特定的枚举器）。

如果我是对的，如果我只是`(in,out)`在 Websocket 函数参数的末尾返回，这是不可能的，因为 out 已经是一个不可变的枚举器：

```
WebSocket.using[JsValue] { request =>
    val in: Iteratee[JsValue,Unit] = ...
    val out: Enumerator[JsValue] = ...

    (in, out)
} 
```

我认为 Concurrent.PatchPannel 是我正在寻找的，但我无法理解如何使用它。有没有人有使用 Concurrent.PatchPannel 的例子？（如果这确实是我正在寻找的）。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-26T10:01:06.957

我终于自己找到了解决方案。

编辑：请参阅我的博客文章中的“可混合子流”部分：http: [//atamborrino.github.io/play/2013/12/25/play-framework-websocket.html](http://atamborrino.github.io/play/2013/12/25/play-framework-websocket.html)

# autocomplete - Sublimetext2 自动完成没有显示明显的完成

> ID：13997039
> 
> 赞同：1
> 
> 时间：2012-12-21T20:51:50.443
> 
> 标签：autocomplete, sublimetext2

[http://cl.ly/image/3E3a3J0X100N](http://cl.ly/image/3E3a3J0X100N)

例如，我正在尝试输入 currentPosition，但它显示了 3 个其他建议而没有显示 currentPosition，这在之前的行中使用过。

这个问题可能是由包裹或其他原因引起的吗？因为它是自动完成比命中更失败。

谢谢。

套餐：

[http://cl.ly/image/0L1C1L2T2k1w](http://cl.ly/image/0L1C1L2T2k1w)

当然，第二个我输入 P 建议就在那里。

# java - Jersey-请求身份验证

> ID：13997040
> 
> 赞同：1
> 
> 时间：2012-12-21T20:52:03.173
> 
> 标签：java, jakarta-ee, authentication, glassfish, jersey

我在 Glassfish 上有一个工作的 JavaEE 6 Web 应用程序，这个应用程序已经有一个 JSF 前端并有它的身份验证机制（（使用 CDI 和基于注释的安全性）所以有一个登录屏幕，用户输入用户名密码，按下登录按钮和 Java EE身份验证过程开始。

现在我想“也”将我的一些服务类公开为 REST 服务（我可能会使用 Jersey），因此也可以从移动设备访问它。但让我担心的是登录部分。

我将使用完全相同的现有身份验证但现在我希望我的应用程序从休息请求而不是从登录屏幕中获取此凭据。然后继续使用已经存在的现有验证方法（从数据库中检查用户名密码等）

我有点迷路了，我该怎么做，我想我需要使用其中一个过滤器来拦截请求并获取用户名密码，但不确定如何以及哪个？或者我不需要这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:08:04.640

您可以像保护 REST 服务一样保护 REST 服务，例如：

```
@Path("/foo")
@RolesAllowed({"admin", "customer"})
public class Foo {

@GET
@Produces("text/plain")
@RolesAllows("admin")
public void adminOnly() {}

public void adminOrCustomer() {}

} 
```

我猜你已经有了他们的角色和映射，所以只需使用你获得的相同角色，应用程序服务器将负责其余的工作。

# wordpress - 重写 WordPress 主题文件，将所有内容重定向到 httpd.conf 中的 index.php

> ID：13997049
> 
> 赞同：0
> 
> 时间：2012-12-21T20:53:03.773
> 
> 标签：wordpress, apache, .htaccess, mod-rewrite, httpd.conf

我在 RHEL6 上使用 WordPress，并进行了一些重写，以便 CSS 托管在`http://servername/css`而不是`http://servername/wp-content/themes/themename/css/`.

我正在从 Nginx 安装转移到 Apache，并拥有服务器。在这种情况下，我不想使用 htaccess 进行重定向，我只想将它们放在 httpd.conf 中。如果我启用 htaccess 并将其放在那里，一切似乎都可以正常工作。

在我的转换中，我在规则的开头添加了 /。下面的当前代码适用于所有内容，除了未由 css、js、img、字体规则处理的真实文件。例如，实际上托管在 /assets 或其他目录下的东西。我有一种感觉，这是由于 REQUEST_FILENAME，如果有的话，下一条规则缺少斜线 - 但我似乎无法弄清楚。

```
RewriteRule ^/index\.php$ - [L]
RewriteRule ^/css/(.*) /wp-content/themes/themename/css/$1 [QSA,L]
RewriteRule ^/js/(.*) /wp-content/themes/themename/js/$1 [QSA,L]
RewriteRule ^/img/(.*) /wp-content/themes/themename/img/$1 [QSA,L]
RewriteRule ^/font/(.*) /wp-content/themes/themename/font/$1 [QSA,L]
RewriteRule ^/plugins/(.*) /wp-content/plugins/$1 [QSA,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

如果我尝试访问`http://servername/assets/image.png`，我实际上正在从重写日志重写到 /index.php

```
init rewrite engine with requested uri /assets/311.jpg
applying pattern '^/index\.php$' to uri '/assets/311.jpg'
applying pattern '^/css/(.*)' to uri '/assets/311.jpg'
applying pattern '^/js/(.*)' to uri '/assets/311.jpg'
applying pattern '^/img/(.*)' to uri '/assets/311.jpg'
applying pattern '^/font/(.*)' to uri '/assets/311.jpg'
applying pattern '^/plugins/(.*)' to uri '/assets/311.jpg'
applying pattern '.' to uri '/assets/311.jpg'
RewriteCond: input='/assets/311.jpg' pattern='!-f' => matched
RewriteCond: input='/assets/311.jpg' pattern='!-d' => matched
rewrite '/assets/311.jpg' -> '/index.php' 
```

`/assets`是具有真实图像的真实文件夹。通过查看此日志，我会认为`!-f`应该说“是的，这是一个文件”，而不是之后将其传递给 index.php。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T16:40:57.957

经过一番研究和测试，我发现这很容易与 htaccess 和 httpd.conf 的范围不同有关，需要包含`DOCUMENT_ROOT`

如果你在 /var/www/html/test/ 中使用 htaccess，你只会在 /test 中查看，因此像 test/assets/image.jpg 这样的东西会通过，因为 /assets/image.jpg 是有效的。

但是，在 httpd.conf 的情况下，除非您在 Directory 指令中使用这些规则，否则您不会被引导到虚拟主机文件夹。因此，就我而言，它正在从服务器的根目录中寻找 /assets/image.jpg。

为了解决这个问题，我只需要包含`%{DOCUMENT_ROOT}`before `%{REQUEST_FILENAME}`。

我在 httpd.conf 中的最后一个块看起来像：

```
RewriteRule ^/index\.php$ - [L]
RewriteRule ^/css/(.*) /wp-content/themes/themename/css/$1 [QSA,L]
RewriteRule ^/js/(.*) /wp-content/themes/themename/js/$1 [QSA,L]
RewriteRule ^/img/(.*) /wp-content/themes/themename/img/$1 [QSA,L]
RewriteRule ^/font/(.*) /wp-content/themes/themename/font/$1 [QSA,L]
RewriteRule ^/plugins/(.*) /wp-content/plugins/$1 [QSA,L]
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-f
RewriteCond %{DOCUMENT_ROOT}%{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

# jquery - 在 JQUERY Masonry 中加载隐藏的 DIV

> ID：13997051
> 
> 赞同：1
> 
> 时间：2012-12-21T20:53:09.037
> 
> 标签：jquery, jquery-masonry

我在以下格式中使用了 JQuery Masonry：首先我在让我们说一个 for 循环中构建我的内容，如下所示：

```
for (var d = 0; d< contentFourSpace; d++)
  {
     box = document.createElement('div'),
     text = document.createTextNode( cFour[d] );   
     box.className = 'contentfour box col first' ;

     box.className = 'contentfour box col' ;
     box.appendChild( text );
     MainContent.push(box);
  } 
```

然后我把它交给 masonry 在页面上渲染，如下所示：

```
$container.prepend( MainContent ).masonry( 'reload' ); 
```

这很好用。

我想知道以下是否可能。假设我有包含正常内容的 HTML 页面。在该页面中，我有一定数量的 DIV，其中包含一些内容。所有这些 DIV 都是隐藏的。如何在 Masonry 中加载那些隐藏的 DIV？换句话说，那些 DIV 将始终隐藏在页面上，我如何发送给 Masonry 进行显示？

可能有一种方法可以扫描 DIV 并复制它们，但这会产生很大的开销，因为我最终会得到副本……或者我也可能剪切/复制……但这不是一个好的解决方案，因为我需要跟踪周围的所有 DIV。

# php - 无脂肪样本示例失败

> ID：13997053
> 
> 赞同：2
> 
> 时间：2012-12-21T20:53:27.020
> 
> 标签：php, fat-free-framework

我正在尝试运行非常简单的无脂肪示例，但没有成功，

**索引.php：**

```
<?php
        $f3=require('fatfree/lib/base.php');
        $f3->route('GET /',
            function() {
                echo 'Hello, world!';
            }
        );
        $f3->run();
?> 
```

**.htaccess 内容：**

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule .* index.php [L,QSA] 
```

**错误日志：**

```
[Fri Dec 21 20:50:11 2012] [error] [client 127.0.0.1] - /var/www/html/index.php:2 require('/var/www/html/fatfree/lib/base.php')
[Fri Dec 21 20:50:11 2012] [error] [client 127.0.0.1] PHP Fatal error:  Uncaught exception 'ErrorException' with message 'Undefined index: ONERROR' in /var/www/html/fatfree/lib/base.php:1252
Stack trace:\n#0 /var/www/html/fatfree/lib/base.php(790): Base->{closure}(8, 'Undefined index...', '/var/www/html/f...', 790, Array)
#1 /var/www/html/fatfree/lib/base.php(1246): Base->error(500, 'date_default_ti...', Array)
#2 [internal function]: Base->{closure}(Object(ErrorException))
#3 {main}
  thrown in /var/www/html/fatfree/lib/base.php on line 1252 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T22:34:50.670

我遇到了同样的问题，查看我的 /var/log/httpd/error_log 我注意到我只需要设置时区。我发现了两种方法：1）只需在 index.php 文件的开头调用 date_default_timezone_set() 函数，如下所示：

```
 <?php
    date_default_timezone_set('Europe/Rome'); //That's my timezone, choose the right one
    $f3=require('fatfree/lib/base.php');
    $f3->route('GET /',
        function() {
            echo 'Hello, world!';
        }
    );
    $f3->run();
    ?> 
```

但恕我直言，这不是一个很好的解决方案。我更喜欢下一个： 2) 找到您的 php.ini 文件（在我的 Fedora 17 中的 /etc/ 内）并修改这些行：

```
 [Date]
    ; Defines the default timezone used by the date functions
    ; http://php.net/date.timezone
    ;date.timezone = 
```

像这样：

```
 [Date]
    ; Defines the default timezone used by the date functions
    ; http://php.net/date.timezone
    date.timezone = 'Europe/Rome' 
```

保存然后重启httpd服务

```
 sudo service httpd restart 
```

我希望它有帮助：D

# c++ - 更换不升压

> ID：13997059
> 
> 赞同：0
> 
> 时间：2012-12-21T20:54:01.533
> 
> 标签：c++, xml, replace, tags, strip

我必须从文本中删除一些 XML 标记并保留它们的值。

例子

```
text text <tag>tag_value</tag> text text <a href="example.com">example.com</a>
->
text text tag_value text text example.com 
```

到目前为止，我已经使用了 boost_replace 但现在我无法使用该库。

```
std::string src(text);
std::string fmt ="";
std::string ex = "(<tag attribute=\"(.*?)\">)|(</tag>)|(<a href(.*?)\">)|(</a>)|(<tag>)|(</tag>))";
boost::regex expr(ex);
std::string s2 = boost::regex_replace(src, expr, fmt, boost::match_default | boost::format_all); 
```

我怎么能解决这个问题？哪个图书馆可以帮助我做到这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T20:56:43.890

永远不要使用正则表达式来解析 XML！

请参阅[RegEx 匹配打开的标签，XHTML 自包含标签除外](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)

您需要一个真正的 XML 库，例如 expat 或 libxml2。

# html - 我需要帮助才能在 html 页面中显示日文字符

> ID：13997063
> 
> 赞同：3
> 
> 时间：2012-12-21T20:54:49.700
> 
> 标签：html

我需要帮助才能在 html 页面中显示日文字符，我在 html 页面的 head 标记中使用此代码，但字符显示不正确。

```
<META http-equiv="Content-Type" contentType="text/html; charset=EUC-JP" > 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:07:43.170

可能的原因是您的页面实际上没有经过 EUC-JP 编码（或者使用的浏览器不支持该编码，但这种情况很少见）。或者，HTTP 标头（可以从 URL 推断，但不能从代码片段推断）可能会声明另一种编码。也有可能使用的字符在使用的字体中不可用，尽管这在当今并不常见。

需要更多信息来区分这些可能性。请注意，“未正确显示”可能意味着任何事情。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-21T21:03:30.513

检查您的浏览器/操作系统是否支持 UTF-8： [http ://www.joelonsoftware.com/articles/Unicode.html](http://www.joelonsoftware.com/articles/Unicode.html)

# javascript - JQuery 和修改后的自动完成

> ID：13997065
> 
> 赞同：1
> 
> 时间：2012-12-21T20:55:01.297
> 
> 标签：javascript, jquery, jquery-ui, autocomplete, jquery-ui-autocomplete

我只是从 jquery 开始，所以也许有一个非常简单的方法可以做到这一点......但我想要一个带有输入元素的表单，用户可以在其中输入文件名，然后在它旁边有一个列表框或其他东西与显示与输入模式匹配的文件所在的文件夹类似。

理想情况下，在我有 3 个左右的字符之前，我不会开始搜索文件夹，因为可能有很多文件夹。

jquery 开箱即用的自动完成功能似乎有一些东西，我不想要，但作为一个 jquery n00b 我不确定这是否是解决这个问题的正确方法，或者我应该做其他事情。

谢谢！

编辑：这是我获取文件夹的方式：

```
var fso = new ActiveXObject("Scripting.FileSystemObject");
var folder = fso.GetFolder("top/level/directory");

// Iterate over folders
var subFlds = new Enumerator(folder.SubFolders);
var subFolder;

for (; !subFlds.atEnd() ; subFlds.moveNext()) {
    subFolder = subFlds.item() + "";
    if (subFolder.match(/* My input string goes here */)) {
         break;
    }
} 
```

这不是我将其用于我描述的用例的确切方式，但它显示了我正在做什么来遍历文件夹。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T20:58:27.580

听起来您需要熟悉 jQuery UI Autocomplete 文档：

[http://jqueryui.com/autocomplete/](http://jqueryui.com/autocomplete/)

我讨厌只留下 RTFM 回复，但熟悉小部件对您来说很重要，这样您就可以提出更准确的问题。

该页面允许您查看源代码并准确查看他们的演示用于操作的内容。API 文档中有大量示例。

如果您对此有任何具体问题，请告诉我们。

# servicestack - ServiceStack ORMLite

> ID：13997068
> 
> 赞同：1
> 
> 时间：2012-12-21T20:55:14.520
> 
> 标签：servicestack, ormlite-servicestack

我们正在将基于 SProc 的解决方案迁移到 ORMLite，到目前为止一切顺利。今天我写了以下方法：

```
 public AppUser GetAppUserByUserID(int app_user_id)
    {
        var dbFactory = new OrmLiteConnectionFactory(this.ConnectionString, SqlServerOrmLiteDialectProvider.Instance);
        AppUser item = null;

        var rh = new RedisHelper();
        var id=  CacheIDHelper.GetAppUserID( app_user_id );
        item = rh.Get<AppUser>(id);

        if (item == null)
        {
            try
            {
                using (var db = dbFactory.OpenDbConnection())
                {
                    item = db.Single<AppUser>("application_user_id={0}", app_user_id);

                    rh.Set<AppUser>(item, id);
                }
            }
            catch (Exception ex)
            {
                APLog.error(ex, "Error retrieving user!");
            }
        }
        return item;
    } 
```

我已经删除了一些无关的字段，但它们基本上是：

```
[Alias("application_user")]
public class AppUser : APBaseObject
{

    [Alias("application_user_id")]
    [AutoIncrement]
    public int? UserID
    {
        get;
        set;
    }

    [Alias("application_user_guid")]
    public string UserGUID
    {
        get;
        set;
    }

 //MORE FIELDS here.

} 
```

挑战在于他们唯一填充的字段是 ID 字段，并且我已经知道该 ID，因为我将它传递给方法。

我确实调用了最后一个 SQL，并直接针对数据库运行了它，并且所有字段都被正确引用。

我在调试器中单步执行了代码，一切都正确返回，除了返回的唯一字段是 ID。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T17:57:32.910

我有一个类似的问题，这是由于我的类方法没有正确映射到数据库引起的。我的确切问题是由`nullable` `int`数据库中的一个字段引起的，并且类方法被定义为“ `int`”而不是“ `int?`”。

也许你有类似的问题？

# java - 在同一个 JVM 中运行 Apache MINA 和 Netty

> ID：13997069
> 
> 赞同：0
> 
> 时间：2012-12-21T20:55:18.673
> 
> 标签：java, netty, mina

我需要在我的应用程序中运行两个服务。一个是基于文本协议的套接字服务器，另一个是基于 http 协议的服务器。对于套接字服务器，我使用 Apache MINA 作为 NIO 框架，而对于 http 协议，我想使用 Netty HTTP 实现。

我考虑过将其整合到一个框架（Netty）中，但是当涉及到处理大型有效负载时，我遇到了 Netty 的一些性能问题。MINA (2.0.7) 在处理套接字服务器上的此类负载方面做得很好。我还查看了 HTTP 服务器的 MINA AsyncWeb，但这个项目似乎已经死了。

我的问题是，有没有人遇到过这种架构困境。是否可以在不同套接字上的同一 JVM 中运行这两个框架，或者是否有一些我不知道的踩到脚趾。

顺便说一句：我已经在同一个 JVM 中将这两个框架作为套接字服务器运行，并成功地对它们进行了负载测试。我需要做的就是将 Netty 套接字服务器转换为 HTTP 服务器。

谢谢索希尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T20:58:54.117

在同一个JVM中运行它们没有问题。它会起作用的，不用担心

# jquery - jQuery 数据表行分组和固定列

> ID：13997071
> 
> 赞同：0
> 
> 时间：2012-12-21T20:55:24.020
> 
> 标签：jquery, jquery-plugins, datatable

我正在尝试使用[此处](http://jsfiddle.net/nanoquantumtech/RgKPZ/)使用的 jquery rowGrouping 。[使用此处](http://datatables.net/extras/fixedcolumns/)所述的固定列插件

但我无法使用它。任何人都可以举一个例子。我试图在互联网上搜索很多，但都是徒劳的。任何帮助表示赞赏。

这就是我尝试启动它的方式：

```
 var tbl = $('#tbl').dataTable({
                    "sScrollY": "300px",
                    "sScrollX": "100%",
                    "sScrollXInner": "150%",
                    "bScrollCollapse": true,                        
                    oLanguage: { sSearch: "" },
                    bPaginate: false,
                    bSort: false
                })
                new FixedColumns( tbl ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-15T09:22:56.313

好像忘记介绍DataTables的FixedColumn插件了，详细可以看[这里](http://jsfiddle.net/yuuuuc/RgKPZ/163/)

```
var tbl = $('#tbl').dataTable({
                "sScrollY": "300px",
                "sScrollX": "100%",
                "sScrollXInner": "150%",
                "bScrollCollapse": true,                        
                oLanguage: { sSearch: "" },
                bPaginate: false,
                bSort: false
            })
            new FixedColumns( tbl ); 
```

# python - Python：PyEnchant 和 64 位 Python

> ID：13997073
> 
> 赞同：10
> 
> 时间：2012-12-21T20:55:33.993
> 
> 标签：python, text-processing, pyenchant

我正在做文本处理。我需要 PyEnchant 库来验证文本中的特定单词是否是有效的英文单词。但是，它仅适用于 Python 的 32 位安装。我需要 64 位 Python 来处理大型文本文件的内存问题。

有没有办法可以为 64 位 Python 安装 PyEnchant？如果没有，我可以使用其他什么库来完成类似的任务？我查看了 NLTK 的 wordnet，但读到功能不如 PyEnchant。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-15T00:29:35.143

如果你觉得拥有 PyEnchant 绝对必要，你可以在[这里](https://pypi.python.org/packages/source/p/pyenchant/pyenchant-1.6.6.tar.gz#md5=9f5acfd87d04432bf8df5f9710a17358)下载源代码，然后手动安装它，把它放在你喜欢的任何目录中，然后运行

```
import sys
sys.path.append('/path/to/dir') 
```

这应该可以工作，并且应该与正常安装它的人兼容。

# php - Yii 禁用一个控制器的模型行为

> ID：13997076
> 
> 赞同：1
> 
> 时间：2012-12-21T20:55:47.380
> 
> 标签：php, yii

我在 Users.php 模型中使用行为（DateTimeI18NBehavior），但特别是在控制器（ApiController.php）中，我想禁用它。

* * *

模型 - Users.php：

```
public function behaviors()
{
    return array(
        'datetimeI18NBehavior'=>array(
            'class' => 'ext.DateTimeI18NBehavior',
        ),
    );
} 
```

* * *

我知道我可以通过以下方式禁用它：

```
$model->disableBehavior('datetimeI18NBehavior'); 
```

但是如何禁用整个控制器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T21:10:36.000

不确定，但也许这会起作用：

```
class ApiController extends CController
{
    function init()
    {
        Users::model()->disableBehavior('datetimeI18NBehavior');
    }
} 
```

或者您可以尝试在模型中添加一些逻辑：

```
function behaviors()
{
    if (Yii::app()->controller->uniqueId != 'api') {
        return parent::behaviors();
    }
    return array(
        'datetimeI18NBehavior'=>array(
            'class' => 'ext.DateTimeI18NBehavior',
        ),
    );
} 
```

在我看来，这两种方式都不完美。

# c++ - 使用 stl sort() 对二维数组进行排序

> ID：13997083
> 
> 赞同：1
> 
> 时间：2012-12-21T20:56:19.997
> 
> 标签：c++, sorting, stl

我有一个二维数组，仅包含 0 或 1。我想使用 STL 排序算法按行的降序对它进行排序（每列没有变化）。但我不知道如何传递参数以及如何在 sort(first, last, comp); 中编写比较函数；喜欢：

```
0 1 1 1
1 1 0 1
1 0 1 0 
```

将像这样排序：

```
1 1 0 1
1 0 1 0
0 1 1 1 
```

我的数据结构是这样的：

```
int **table = 0;
table = new int *[row];
for(int i=0;i<row;i++)
table[i] = new int[column]; 
```

我只能这样写排序函数：

```
sort(a[0], a[0]+row, compare_function);

bool compare_function(int a[], int b[])
{
    int i =0;
    while(a[i]==0 ||a[i]==1)
    {
        if(a[i]>b[i])
            return true;
        else
            i++;
    }
    return false;
} 
```

但它不起作用。有人能帮我吗？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:01:25.897

将比较功能更改为：

```
bool comp(const int a[], const int b[]){
  int sum1 = std::accumulate(a, a + column, 0);
  int sum2 = std::accumulate(b, b + column, 0);
  return sum1 < sum2;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:49:07.193

您对 sort 的调用在我看来是错误的（尽管您从未说过是什么`a`）。它应该是`sort(table, table+row, compare_function)`

但无论如何我都会做一些不同的事情（`std::lexicographical_compare`来自`<algorithm>`）：

```
struct compare_rows {
  const int cols;
  compare_rows(int cols_) : cols(cols_) {}
  bool operator()(const int a[], const int b[]) const {
    // a b reversed to give descending sort
    return lexicographical_compare(b, b+cols, a, a+cols);
    }
  }; 
```

并像这样使用它：

```
sort(table, table+row, compare_rows(column)) 
```

# php - 通过 PHP 在 Windows Dekstop 上创建警报？

> ID：13997084
> 
> 赞同：0
> 
> 时间：2012-12-21T20:56:28.327
> 
> 标签：php, eventtrigger

我一直在网上搜索，结果一无所获，所以我要求没有人为我做这件事，只问了两个简单的事情。

是否可以通过 Windows 任务计划程序运行 PHP 脚本、捕获输出并显示桌面通知来创建桌面警报？这一切都通过 PHP；还是我必须使用另一种编程语言，例如 C？

我知道可以使用 Linux Cronjob 以设定的时间间隔运行 PHP 脚本，捕获输出`exec();`并用于`mailto();`在找到时发送电子邮件通知，`needle in the haystack`但我想要在 Windows 解决方案上这样的东西，但是我对此的研究/知识没有得出任何结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T20:57:01.970

这通过 PHP 是不可能的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:19:17.513

这是*可能的*，但是可能会很困难，我不知道具体情况。用 php 编写除 web 应用程序以外的任何东西都非常罕见，因此很少有专门知识和很少的绑定可以做到这一点。

您需要的是一种调用本机 os 函数和方法的方法。如果您可以通过 COM 或 .NET 做您需要的事情，您可以使用其中的一种[`windows-only extensions`](http://php.net/manual/en/refs.utilspec.windows.php)to PHP。但是，您仍然需要弄清楚如何执行较低级别的 windows 操作。

或者，如果您只需要一种弹出打开窗口的方法，您可以更上一层楼并使用 GUI 工具包。[wxWidgets](http://www.wxwidgets.org)跨平台 GUI库已作为[wxphp](http://wxphp.org)移植到 PHP 。也许你可以使用这个。

也就是说，您应该考虑使用另一种高级语言，例如 Python。

# python - 带有 NumPy 的 loadtxt() 和 genfromtxt 的 'dtype' 的可用数据类型是什么？

> ID：13997087
> 
> 赞同：45
> 
> 时间：2012-12-21T20:56:57.360
> 
> 标签：python, numpy

用于导入具有不同数据类型的表数据的可用[numpy.loadtxt](http://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html)或[numpy.genfromtxt](http://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html)有哪些，可用的缩写有哪些（例如**i32**表示整数）？

[这篇文章](https://stackoverflow.com/questions/5660612/numpy-using-loadtxt-or-genfromtxt-to-read-a-ragged-structure)演示了条件的使用，我很好奇是否有人可以详细说明。

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2014-09-02T03:53:07.047

除了 之外`np.sctypeDict`，还有以下变量：

```
In [141]: np.typecodes
Out[141]: 
{'All': '?bhilqpBHILQPefdgFDGSUVOMm',
 'AllFloat': 'efdgFDG',
 'AllInteger': 'bBhHiIlLqQpP',
 'Character': 'c',
 'Complex': 'FDG',
 'Datetime': 'Mm',
 'Float': 'efdg',
 'Integer': 'bhilqp',
 'UnsignedInteger': 'BHILQP'}

In [143]: np.sctypes
Out[143]: 
{'complex': [numpy.complex64, numpy.complex128, numpy.complex192],
 'float': [numpy.float16, numpy.float32, numpy.float64, numpy.float96],
 'int': [numpy.int8, numpy.int16, numpy.int32, numpy.int32, numpy.int64],
 'others': [bool, object, str, unicode, numpy.void],
 'uint': [numpy.uint8, numpy.uint16, numpy.uint32, numpy.uint32, numpy.uint64]} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-21T21:20:30.433

有关的一般信息`dtypes`：[http ://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html](http://docs.scipy.org/doc/numpy/reference/arrays.dtypes.html)

来自[http://docs.scipy.org/doc/numpy/reference/arrays.scalars.html#arrays-scalars-built-in](http://docs.scipy.org/doc/numpy/reference/arrays.scalars.html#arrays-scalars-built-in)

> 在 NumPy 中，有 24 种新的基本 Python 类型来描述不同类型的标量。这些类型描述符主要基于编写 CPython 的 C 语言中可用的类型，还有几种与 Python 的类型兼容的附加类型。

而我没有意识到的是：

> 类似 C 的名称与字符代码相关联，如表中所示。但是，不鼓励使用字符代码。

我怀疑`numpy`代码/文档库很快就会消失，所以这就是我猜的全部！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-29T19:10:31.273

`for k, v in np.sctypeDict.iteritems(): print '{0:14s} : {1:40s}'.format(str(k), v)`

```
Q              : <type 'numpy.uint64'>      
U              : <type 'numpy.unicode_'>
a              : <type 'numpy.string_'> 
```

等等

# c++ - 在矩阵实现的 [] 运算符中查找设计缺陷

> ID：13997092
> 
> 赞同：0
> 
> 时间：2012-12-21T20:57:17.250
> 
> 标签：c++, pointers, matrix

在 C++ 程序中，这里有两个运算符标题用作未显示的矩阵实现的 setter 和 getter。

```
double* Matrix::operator[](unsigned int row) const throw (MatrixException);
double* Matrix::operator[](unsigned int row) throw (MatrixException); 
```

在不进一步了解上述运算符的实现的情况下，只需查看上述运算符是如何定义的，如果同时实现这两种方法，矩阵程序中的设计缺陷将是什么。

关于 [] 运算符如何工作的说明： 矩阵设置如下：

```
Matrix *a = new Matrix(1,2); //matrix with one row and two columns
a[0][0] = 3.0; 
a[0][1] = 2.3;

//to access a matrix value
double* b = a[0][1];
delete a; 
```

编辑：您会在运算符定义中进行哪些更改以修复设计缺陷？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:02:14.430

第一个设计缺陷是使用*异常规范，在***C++11**中已弃用。

第二个设计缺陷是您可以从行列中索引，并且类无法检查它。IE，

```
Matrix a( 1, 2 );
double b = a[0][4]; 
```

*使用代理*可以进行边界检查。

```
struct Matrix {
    struct Column {
        double operator[](unsigned int column);
    };

    Column operator[](unsigned int row);
}; 
```

最后，你的例子完全是假的。你声明`a`为一个*指针*，所以当你下标时，`a[0][0]`你实际上是先下标指针，然后是行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:03:19.630

有一些缺陷。

最明显的一个是通过手动内存管理不必要地使用动态内存。任何时候你看到`delete`你几乎都知道有什么不对劲，任何时候你看到`new`你都应该怀疑。

```
Matrix a(1, 2); // no new needed
a[0][0] = 3.0;
a[0][1] = 2.3;
double * b = a[0][1];
// no delete needed 
```

这可以完全防止内存泄漏。它还避免了您包含的未实际索引数组的错误（您需要使用它`(*a)[0][0]`来获取第一个元素）。

其次，您应该返回对值的引用，而不是指针。

第三，您应该使用一个返回值并将两个索引作为参数的函数，而不是重载 an`operator[]`以返回一个您必须再次取消引用的数组。[http://www.parashift.com/c++-faq/matrix-subscript-op.html](http://www.parashift.com/c++-faq/matrix-subscript-op.html)

这允许您检查边界，假设`Matrix`知道它自己的大小是多少（它必须存储两个整数数据成员）。

```
double const & Matrix::at(size_t const row, size_t const column) const {
    check_bounds(row, column);
    return implementation_detail();
} 
```

具有明显的`double &`版本实现。就目前而言，您的`const`成员函数版本返回 a`double *`而不是通过返回 a 来使`const`传递`double const *`（尽管仍然首选引用）。

另一个潜在的缺陷是像 a 这样的泛型类`Matrix`可能应该在类型上参数化：

```
template<typename T>
class Matrix {
public:
    typedef T value_type;
    ...
}; 
```

因此，您的示例实际上将使用 a`Matrix<double>`作为类型。

最后，我要对异常规范说不。它们往往会导致比修复更多的错误，这就是它们在 C++11 中被弃用的原因。

# html - 用复选框排列列表

> ID：13997093
> 
> 赞同：3
> 
> 时间：2012-12-21T20:57:18.160
> 
> 标签：html, css

现在我有这个 html 代码：

```
<ul>
  <li>
    <input checked="checked" id="user_remember_me" name="user[remember_me]" type="checkbox" value="true">
    <div class="login-link">
      Запомнить меня
    </div>
  </li>
  <li>
    <a href="/users/sign_up" class="login-link">Регистрация</a>
  </li>
  <li>
    <a href="/users/sign_up" class="login-link">Забыли пароль?</a>
  </li>
</ul> 
```

都在这里：http: [//jsfiddle.net/4GtKQ/](http://jsfiddle.net/4GtKQ/)

另见图片：

![https://dl.dropbox.com/u/59666091/checkbox.png](../Images/4c345e49b8a433af9b0f0f0276fd15b6.png)

但是为什么我在“Запомнить меня”和“Регистрация”之间有这样的空间？如何将它们设置为正常的线网格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:14:51.310

复选框和相关文本占用不同数量的垂直空间。您指向的额外空间是两个元素沿其*box*的顶部边缘排列的结果。

假设您希望文本和输入具有相同的基线*，并且*文本与左边缘对齐，复选框与右边缘对齐，完成的标记和 CSS 将如下所示：

HTML：

```
<li class="remember">
  <label>Запомнить меня 
    <input checked="checked" id="user_remember_me" name="user[remember_me]" 
           type="checkbox" value="true">
  </label>
</li> 
```

CSS：

```
li.remember { 
    text-align: left;
}
li.remember input { 
    float: right;
} 
```

[http://jsfiddle.net/4GtKQ/1/](http://jsfiddle.net/4GtKQ/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:04:24.260

这显然是因为复选框，我相信你可以绕过它，但我建议你将它们分开为单独的元素，然后将它们与 CSS 对齐。复选框不一定必须有与之关联的标签，只需确保它具有可访问性需求的用户的标题。

对不起，我不能给你一个确切的分辨率，它所写的语言对我来说也很难读，如果你能提供一个实际的网址（完整的网页）我想在这种情况下你会得到更多的回应因为我们可以使用 Chrome 的 Inspect Element 之类的东西。不要误会，JSfiddle 很棒，但这是一个例外。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-12-21T21:14:16.690

```
<li style="position:relative; top: -5px;">
 <a href="/users/sign_up" class="login-link">Регистрация</a>
</li> 
```

# c# - 为什么我的自定义 PropertyItem 无法从图像中拉出？

> ID：13997101
> 
> 赞同：2
> 
> 时间：2012-12-21T20:57:53.443
> 
> 标签：c#, image, bitmap

我有一个自定义的 PropertyItem，我已经“创建”并在图像中存储了一些值。我很肯定它可以正确存储它，因为新图像的大小会增加（取决于我制作的字符串有多大）。

--[问题在底部]--

这是我将 PropertyItem 放入图像的代码。

```
Bitmap bmp = new Bitmap(image); //image is of type Image
string s = "Hello there";
var pi = createPropertyItem();
pi.Id = 40091;
pi.Len = s.Length+1; //don't worry too much about this - this is a test case,
                     //not the real types and lengths. If I put an error in here,
                     //it's not what's making it error out elsewhere. :)
pi.Type = 2;
pi.Value = s;
bmp.SetPropertyItem(pi);

bmp.Save("image.jpg", bmp.RawFormat);//is this actually saving the PropertyItems
                                     //into the file, "image.jpg"? 
```

无论如何，我在其他地方遇到了麻烦 - 我需要从图像的 PropertyItem 中提取值。然而：

```
Bitmap thing = new Bitmap("image.jpg"); // is this the problem code?
String newString = getStringOut(thing);

/////////////////further down in the program//////////////////////////

public String getStringOut(Image image)
{
    var x = image.GetPropertyItem(40091); //this fails because the PropertyItem
                                          //is not in this image.
    string s = x.Value;
} 
```

我的问题是：由于 PropertyItem 在保存的图像中（至少看起来是，因为文件的大小越大，我输入的字符串越长），为什么我的方法（getStringOut）不能访问它，当我回去尝试从保存的图像中检索 PropertyItem 时？当我初始化新的位图时，是不是因为某种原因没有拉取 EXIF 数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:11:23.913

您是否尝试过[这种方法](http://msdn.microsoft.com/en-us/library/system.drawing.image.setpropertyitem.aspx)- 本质上是在设置属性项之前复制属性项并更改其 ID？

另外，您可能想看看[这个问题](https://stackoverflow.com/questions/11396050/set-image-meta-data-before-save)。作者没有尝试（或没有将自己描述为尝试）检索他的属性项，但他使用了一些与您不同的技术和 PropertyItem 属性值（在他的回答中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-02T14:36:37.770

[请参阅此处](https://stackoverflow.com/questions/1050936/resize-an-image-and-keeping-metadata-property-item)的链接。原来我的带有注释的代码行：`// is this the problem code?` **是**问题代码，因为这是删除元数据。

# c - 计算长期移动平均线

> ID：13997106
> 
> 赞同：2
> 
> 时间：2012-12-21T20:58:19.677
> 
> 标签：c, average, smoothing

我目前使用以下函数来计算每个发生的温度读数的移动平均值`200ms`。

```
uint16_t ntc_average(uint16_t adcdata)
{ 

    static uint8_t      first = 1;
    static uint16_t t1,t2,t3,t4,t5;

    if(first == 1)
    {
        first = 0;
        t1 = t2 = t3 = t4 = t5 = adcdata;
    }

    t5 = t4;
    t4 = t3;
    t3 = t2;
    t2 = t1;
    t1 = adcdata;
    adcdata = (t1+t2+t3+t4+t5)/5;

    return(adcdata);
} 
```

但是，5 个点是不够的，我可能需要更长的缓冲才能更平滑。例如，每 10-20 个读数一次或两次，该值可能会向上或向下下降一个点，我需要对其进行平滑处理。增加 tn 变量似乎很难看……我想我可能需要 t1-t50。

谁能建议`C`我可以用来平滑温度读数的另一个功能？请注意，这些值是无符号整数而不是浮点数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:09:22.127

您可以在不进行算术平均的情况下进行平滑处理。例如，与其丢弃从移动窗口中掉出的特定样本，不如在每次迭代中丢弃平均值本身。

```
newAverage = (oldAverage * (windowSize - 1) + newSample) / windowSize; 
```

它可能对您的系统足够好，也可能不够好，但值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:14:32.743

为此通常使用一个简单的过滤器：

```
ave = ave * (1-a) + samp * a; 
```

其中`a`是 0.0 到 1.0 之间的一个小常数

* * *

在 s0.15 定点：

```
int32 bigAverage; 
int16 ave;
int16 sample;
int16 alpha = 32768L*(0.1) //your constant here
int16 oneLessAlpha = 32768L-alpha;

//... in loop ...
bigAverage = (bigAverage>>15)*oneLessAlpha;
bigAverage += sample*alpha;
ave = bigAverage>>15; 
```

您在很长一段时间内进行累积以保持更好的精度。

# c# - 如何在文本框中设置光标位置

> ID：13997110
> 
> 赞同：5
> 
> 时间：2012-12-21T20:58:38.677
> 
> 标签：c#, winforms, textbox

我正在使用以下代码制作一个高度可调且垂直对齐的文本框。我应该这样做的原因是因为虽然我可以使winform文本框高度可调，但我仍然无法垂直对齐文本框中的文本。所以我决定我必须绘制文本 OnPaint 事件。文本框现在显示正确对齐，但光标仍位于文本框顶部。有没有办法控制这个位置？

```
public class TextBoxHeightAdjustable : System.Windows.Forms.TextBox
{

    public TextBoxHeightAdjustable()
    {
        this.AutoSize = false;
        this.TextAlign = System.Windows.Forms.HorizontalAlignment.Center;
        this.SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint | ControlStyles.OptimizedDoubleBuffer | ControlStyles.ResizeRedraw, true);
    }
    protected override void OnPaint(PaintEventArgs e)
    {
        // This never runs no matter what I try!
        base.OnPaint(e);
        // Create a StringFormat object with the each line of text, and the block 
        // of text centered on the page.
        StringFormat stringFormat = new StringFormat();
        stringFormat.Alignment = StringAlignment.Center;
        stringFormat.LineAlignment = StringAlignment.Center;

        e.Graphics.DrawString(Text, Font, new SolidBrush(ForeColor), ClientRectangle, stringFormat);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:44:29.643

尽管有 Hans 的建议，我还是继续进行，因为文本框将包含简单的类似数字的文本。正如汉斯所说，我们没有太多选择来处理原始光标和生动显示的文本。因此，我使用以下扩展方法并禁用双击和按键更新来隐藏它们。

```
 [DllImport("user32.dll")]
    static extern bool HideCaret(IntPtr hWnd);
    public static void HideCaret(this TextBox textBox)
    {
        HideCaret(textBox.Handle);
    } 
```

所以最终以下代码适用于我的目的，但我不能说它是完整的。我可能仍然想出如何绘制自己的光标。希望这可以帮助其他有类似问题的人。

```
public class TextBoxHeightAdjustable : System.Windows.Forms.TextBox
{
    const int WM_DBLCLICK = 0xA3;
    const int WM_LBUTTONDBLCLK = 0x203;

    public TextBoxHeightAdjustable() : base()
    {
        this.AutoSize = false;
        this.TextAlign = System.Windows.Forms.HorizontalAlignment.Center;
        this.SetStyle(ControlStyles.AllPaintingInWmPaint | ControlStyles.UserPaint | ControlStyles.OptimizedDoubleBuffer | ControlStyles.ResizeRedraw, true);
    }
    protected override void OnKeyPress(KeyPressEventArgs e)
    {
        //base.OnKeyPress(e);
        if (e.KeyChar == (char)Keys.Back)
        {
            Text = Text.Remove(Text.Length-1);
        } 
        else
        {
            Text += e.KeyChar;
        }
        e.Handled = true;
    }
    protected override void WndProc(ref Message m)
    {
        if ((m.Msg == WM_DBLCLICK) || (m.Msg == WM_LBUTTONDBLCLK))
        {
        }
        else
        {
            base.WndProc(ref m);
        }
    }
    protected override void OnTextChanged(System.EventArgs args)
    {
        //KeyEventArgs kpe = (KeyEventArgs) args;
        //this.Font = new Font(this.Font.FontFamily, 0);
        using (Graphics g = this.CreateGraphics())
        {
            g.FillRectangle(Brushes.White, ClientRectangle);
            StringFormat stringFormat = new StringFormat();
            stringFormat.Alignment = StringAlignment.Center;
            stringFormat.LineAlignment = StringAlignment.Center;
            g.DrawString(Text, Font, new SolidBrush(ForeColor), ClientRectangle, stringFormat);

        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        this.HideCaret();
        e.Graphics.FillRectangle(Brushes.White, ClientRectangle);
        // This never runs no matter what I try!
        //base.OnPaint(e);
        // Create a StringFormat object with the each line of text, and the block 
        // of text centered on the page.
        StringFormat stringFormat = new StringFormat();
        stringFormat.Alignment = StringAlignment.Center;
        stringFormat.LineAlignment = StringAlignment.Center;

        e.Graphics.DrawString(Text, Font, new SolidBrush(ForeColor), ClientRectangle, stringFormat);
    }
} 
```

# java - 全屏模式不是全屏

> ID：13997111
> 
> 赞同：18
> 
> 时间：2012-12-21T20:58:42.837
> 
> 标签：java, swing

> **可能重复：**
> [Java 全屏模式在 Ubuntu 上不起作用](https://stackoverflow.com/questions/12520658/java-fullscreen-mode-not-working-on-ubuntu)

我正在尝试做 100% 全屏模式，我使用的是 Ubuntu 12.10，左侧是侧边栏，顶部是菜单。当我运行全屏模式时，它不会覆盖这两个菜单栏，它位于它们旁边：

![截屏](../Images/062ba548e832193abbb0ef1314552511.png)

它应该覆盖左侧菜单栏和顶部黑色栏。为什么不呢？

```
package sscce;

import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import javax.swing.JFrame;

public class Main extends JFrame{

    public Main(){
        GraphicsEnvironment ge = GraphicsEnvironment.getLocalGraphicsEnvironment();
        GraphicsDevice myDevice = ge.getDefaultScreenDevice();
        this.setUndecorated(true);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        myDevice.setFullScreenWindow(this);
    }

    public static void main(String[] args){
        Main main = new Main();
    }
} 
```

# php - “关闭其他会话”按钮

> ID：13997116
> 
> 赞同：2
> 
> 时间：2012-12-21T20:59:14.887
> 
> 标签：php, session, sessionid

我想在我的 PHP Web 应用程序中添加一个“关闭其他活动会话”按钮。

我正在考虑在 MySQL 表上跟踪 (userid,sessionid,expiration) 并通过以下方式终止会话：

```
$currentsessionid=session_id();
foreach($othersessions as $session){
    sessionid($session['sessionid']);
    session_start();
    session_destroy();
}
mysql_query("DELETE FROM sessions WHERE userid = $currentuserid AND sessionid <> $currentsessionid");
session_id($currentsessionid);
session_start(); 
```

~~如果用户已登录，则该表还将在每个 session_start() 之后更新，删除过期条目。~~

每次用户登录时都会删除过期的条目。

这是正确的方法吗？有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:01:48.713

在 PHP 中，会话通常是隔离的。您需要创建自己的会话处理程序并将会话（以及一些额外的跟踪信息）写入数据库，以便更易于管理。

例如，就像您在问题中所说的那样，`userid`. 然后，您可以搜索特定用户的会话。

您应该拥有的另一个字段是时间戳，以便您可以让会话过期，例如，如果超过 X 小时，则将它们丢弃。

如果您愿意，您还可以查看用户是否有现有会话并导入旧会话。但是，这可能会产生安全隐患。您需要考虑当攻击者而不是真实用户登录时会发生什么。

那么攻击者甚至可以将有效用户赶出系统吗？应该防止这种情况。

还要考虑到您可以在新的会话 ID 下接管前一个会话的会话数据。这与 类似[`session_regenerate_id()`](http://php.net/session_regenerate_id)，登录应始终重新生成会话 ID，以及注销和其他重要步骤（例如，在更改电子邮件地址之前重新进行身份验证）。

# r - 覆盖基础 R 中的 S3 方法

> ID：13997122
> 
> 赞同：10
> 
> 时间：2012-12-21T21:00:50.097
> 
> 标签：r, r-s3

我试图在教学时使用的本地包中覆盖 R stats 包中的 print.anova() 函数。基本上，我想删除标题的打印并添加一个“总计”行而不用新类创建一个新函数（例如，ANOVA()）。

该函数如下所示：

```
print.anova <- function(x,digits=max(getOption("digits")-2,3),
 signif.stars=getOption("show.signif.stars"),totalSS=TRUE,rm.heading=TRUE,...) {
  if (!any(grepl("Res.Df",colnames(x)))) {         # exclusion for multiple lm objects
    if (!any(grepl("Levene",attr(x,"heading")))) { # exclusion for levenes.test
      if (totalSS) {                               # add total SS row
        x <- rbind(x,c(sum(x$Df),sum(x[,"Sum Sq"]),NA,NA,NA))
        row.names(x)[dim(x)[1]] <- "Total"
      }
    }
  }
  if (rm.heading) attr(x,"heading") <- NULL        # remove heading
  stats::print.anova(x,digits=digits,signif.stars=signif.stars,...)
  invisible(x)
} 
```

我的问题是我不确定是否将其导出为函数、方法、S3 方法、它们的某种组合或完全其他的东西。例如，当我尝试这个（roxygenize 代码的一部分）时：

```
#'@export 
```

运行 Rcmd 检查时收到以下警告：

```
S3 methods shown with full name in documentation object 'print.anova':
  'print.anova' 
```

但是当我加载我的包时，该功能按预期工作。

但是，如果我尝试这个：

```
#'@method print anova
#'@S3method print anova 
```

Rcmd 检查没有收到任何警告或错误，但是当我尝试在 R 中使用该函数时，它会在 stats 包命名空间中找到原始函数。此外，如果我这样做

```
getAnywhere(print.anova) 
```

我明白了

```
2 differing objects matching ‘print.anova’ were found in the following places
  package:stats
  registered S3 method for print from namespace stats
  namespace:NCStats
  namespace:stats 
```

最后，对于这个版本（不是使用export，而是使用method和s3method），我的roxygen-developer命名空间里面有以下项

```
S3method(print,anova) 
```

导致我困惑的是，我似乎已经成功地使用其他函数做了类似的事情（例如，使用 print.summary.lm 的方法和 S3method 版本）。

如果能帮助我理解我在这里做错了什么（或者我如何最终实现这个目标），我将不胜感激。预先感谢您的任何帮助。

ps，就其价值而言，我使用的是 Windows 7（32 位）、R 2.15.2 并使用 RStudio。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T20:28:51.503

`print.anova`您可以创建自己的类，而不是尝试覆盖该函数，该类与 anova 类基本相同。创建一个`as.myanova`函数，它将一个`anova`对象变成一个对象，`mynanova`然后编写你的`print.myanova`函数。

# highlighting - Jekyll Pygments 处理

> ID：13997127
> 
> 赞同：9
> 
> 时间：2012-12-21T21:01:21.973
> 
> 标签：highlighting, jekyll, pygments

我一直在与 Jekyll 和 Pygments 突出显示一段时间。我安装了 pygments 并生成了 css 文件，但是当我运行 Jekyll 生成站点时，代码突出显示似乎无法正确生成。

这是我用于处理的一些示例代码

```
{% highlight php lineos %}
/**
 * Passing by reference
 *
 * Outputs
 *
 * 10 - before add() call
 * 10 - after add() call
 * 15 - after addref() call
 */
$a = 10;
echo $a;
add($a);
echo $a;
addref($a);
echo $a;

function addref(&$a)
{
    $a += 5;
}

function add($a)
{
    $a += 5;
}
{% endhighlight %} 
```

这是 Jekyll 构建我的网站后的样子。

```
<div class="highlight"><pre><code class="php"><span class="x">/**</span>
<span class="x"> * Passing by reference</span>
<span class="x"> *</span>
<span class="x"> * Outputs</span>
<span class="x"> *</span>
<span class="x"> * 10 - before add() call</span>
<span class="x"> * 10 - after add() call</span>
<span class="x"> * 15 - after addref() call</span>
<span class="x"> */</span>
<span class="x">$a = 10;</span>
<span class="x">echo $a;</span>
<span class="x">add($a);</span>
<span class="x">echo $a;</span>
<span class="x">addref($a);</span>
<span class="x">echo $a;</span>
<span class="x"> </span>
<span class="x">function addref(&amp;$a)</span>
<span class="x">{</span>
<span class="x">    $a += 5;</span>
<span class="x">}</span>
<span class="x"> </span>
<span class="x">function add($a)</span>
<span class="x">{</span>
<span class="x">    $a += 5;</span>
<span class="x">}</span>
</code></pre>
</div> 
```

正如你所看到的，Jekyll 似乎将每一行都标记为`class="x"`，我不太清楚为什么。

我尝试过使用 Github repos 中的液体和 jekyll，我什至尝试过使用 redcarpet，即使它与液体模板处理无关。我已经尝试了几乎所有我能想到的，但似乎无法让它发挥作用。

这是我查看我的网站时的实际样子

[http://i.stack.imgur.com/kCvLN.png](https://i.stack.imgur.com/kCvLN.png)

我正在运行以下版本。

红宝石：红宝石1.9.3p327（2012-11-10修订版37606）[x86_64-darwin11.4.2]
rdiscount：rdiscount（1.6.8）redcarpet：redcarpet
（2.2.2）pygments：pygments.rb（0.2.13）
液体：液体（2.4.1）
杰基尔：杰基尔（0.11.2）

我刚刚使用了[redcarpet_markdown.rb](https://github.com/nono/Jekyll-plugins)插件并将配置设置设置为使用 redcarpet2 并设置了 redcarpet 的扩展。

```
markdown: redcarpet2
redcarpet:
  extensions: ["no_intra_emphasis", "fenced_code_blocks", "autolink", "strikethrough", "superscript", "with_toc_data"] 
```

一旦到位，我将代码突出显示更改为这样

```
```php
/**
* Passing by reference
*
* Outputs
*
* 10 - before add() call
* 10 - after add() call
* 15 - after addref() call
*/
$a = 10;
echo $a;
add($a);
echo $a;
addref($a);
echo $a;

function addref(&$a)
{
    $a += 5;
}

function add($a)
{
    $a += 5;
}
``` 
```

然后我尝试再次生成该站点，我得到了相同的结果。我不确定这是 Jekyll 还是 Pygments 造成的，但过去 2 天我一直在与此作斗争。但我现在知道它不是降价处理器。

如果您有任何想法，我将非常愿意尝试任何事情。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-12-13T20:06:53.040

如果你想避免`<?php`标签，你可以指定 Pygment 选项`startinline`

```
{% highlight php startinline %}

phpinfo();

{% endhighlight %} 
```

这样它应该可以正确渲染（它对我有用）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-22T15:09:38.953

看来您不仅必须包含代码块的开始标记，而且使用 PHP 您还必须包含

```
```php
<?php
/**
* Passing by reference
*
* Outputs
*
* 10 - before add() call
* 10 - after add() call
* 15 - after addref() call
*/
$a = 10;
echo $a;
add($a);
echo $a;
addref($a);
echo $a;

function addref(&$a)
{
    $a += 5;
}

function add($a)
{
    $a += 5;
}
``` 
```

# c++ - 超出范围指针的比较是否定义明确？

> ID：13997130
> 
> 赞同：13
> 
> 时间：2012-12-21T21:01:36.300
> 
> 标签：c++, language-lawyer

给定以下代码：

```
char buffer[1024];
char * const begin = buffer;
char * const end = buffer + 1024;
char *p = begin + 2000;
if (p < begin || p > end)
    std::cout << "pointer is out of range\n"; 
```

执行的比较 (`p < begin`和`p > end`) 是否明确？或者此代码是否具有未定义的行为，因为指针已超出数组末尾？

如果比较定义明确，那么该定义是什么？

（额外的功劳：对自身的评估是`begin + 2000`不确定的行为吗？）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T21:10:39.177

我将假设[C++11](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3337.pdf)标准。根据第 5.7 节（加法操作数）第 5 段`*p = begin + 2000`，在您进行比较之前，首先未定义的行为：

> 如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则计算不应产生溢出；否则，行为是未定义的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-21T21:09:13.873

的评估`begin+2000`是未定义的，它超过了数组的末尾 - 你可以在末尾上加一个，但不能更远。

从 C++11 §5.7/5*加法运算符*：

> 当具有整数类型的表达式被添加到指针或从指针中减去时，结果具有指针操作数的类型。如果指针操作数指向数组对象的元素，并且数组足够大，则结果指向与原始元素偏移的元素，使得结果和原始数组元素的下标之差等于积分表达式。[...] 如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则评估不应产生溢出；**否则，行为是 undefined**。

对于要指定的指针比较，假设您有有效的指针以开始，它们本质上需要是指向同一个数组（或末尾的一个）的指针，或者是指向同一访问控制的非静态数据成员的指针对象（除非它是一个联合......）。

详细信息在 §5.9/2*关系运算符*中：

> 可以比较指向相同类型的对象或函数的指针（指针转换后），结果定义如下：
> 
> *   如果相同类型的两个指针 p 和 q 指向同一个对象或函数，或者都指向同一个数组末尾之后的一个，或者都为 null，则 p<=q 和 p>=q 都产生 true 和 p <q 和 p>q 都产生错误。
> *   如果相同类型的两个指针 p 和 q 指向不同的对象，这些对象不是同一对象的成员或同一数组的元素或指向不同的函数，或者如果其中只有一个为空，则 p<q, p 的结果>q、p<=q 和 p>=q 未指定。
> *   如果两个指针指向同一个对象的非静态数据成员，或者这些成员的子对象或数组元素，递归地，如果两个成员具有相同的访问控制（第 11 条）和前提是他们的班级不是工会。
> *   如果两个指针指向具有不同访问控制（第 11 条）的同一对象的非静态数据成员，则结果未指定。— 如果两个指针指向同一个联合对象的非静态数据成员，它们比较相等（如果需要，在转换为 void* 之后）。如果两个指针指向同一个数组的元素或一个超出数组末尾的元素，则指向具有较高下标的对象的指针比较高。
> *   其他指针比较未指定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T22:39:50.627

您的程序的行为是未定义的，但不是因为比较。

表达式的评估`begin + 2000`具有未定义的行为，因为结果将指向超过 1024 个元素数组末尾的多个元素。

引用 C++11（实际上是[N3485](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3485.pdf)草案），5.7p4 [expr.add]：

> 当具有整数类型的表达式被添加到指针或从指针中减去时，结果具有指针操作数的类型。[...] 如果指针操作数和结果都指向同一个数组对象的元素，或者超过数组对象的最后一个元素，则评估不应产生溢出；否则，行为未定义。

简而言之，仅计算越界指针具有未定义的行为；之后您对该指针执行的操作并不重要。

# swing - 为什么这里不显示表的列名？

> ID：13997136
> 
> 赞同：5
> 
> 时间：2012-12-21T21:02:22.627
> 
> 标签：swing, user-interface, clojure, seesaw

我的跷跷板有问题。当我尝试制作并显示一个简单的表格时，它显示没有列名。
我做了什么：

首先，我必须说我正在使用`[seesaw "1.4.2"]`.
然后：

```
;; Clojure 1.4.0
(require '[seesaw.core :as ss])

(ss/native!)

(def main-window
     (-> (ss/frame
           :title "Main window")
       ss/pack!
       (ss/config! :minimum-size [320 :by 240])
       ss/show!))

(def display
     #(ss/config! main-window
                  :content %))

(display
     (ss/table
       :id :dumb-table
       :model [:columns
               [:one :another]
               :rows
               [["1" "2"]
                ["3" "4"]]])) 
```

[![我得到了什么](../Images/50b495113013f10c9f5f41a6fc2fdcef.png)](https://i.stack.imgur.com/kSoeH.png)
[（来源：[leprosorium.com](http://img.leprosorium.com/1663368)）]

出现表，但没有列名，我猜它必须是“一个”和“另一个”。这里出了什么问题？

如果我使用与官方 wiki 中完全相同的代码，也会发生这种情况：[https ://github.com/daveray/seesaw/wiki/Tables](https://github.com/daveray/seesaw/wiki/Tables)

### 更新：

我忘了提，我使用的是 JDK 1.7u10，也许有道理。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-21T10:45:58.743

我不知道如何使用跷跷板。但一般情况下，您需要将 JTable 添加到 JScrollPane。这是因为即使滚动数据，JScrollPane 也会在顶部提供列标题。如果您不想使用 JScrollPane，那么您需要手动将列标题添加到容器中，以便它们保持在顶部。所以尝试添加 JScrollPane。

如果我错了，请告诉我... :)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-11-11T07:37:33.747

好吧，我想你错过了一些东西，（见[参考](https://github.com/daveray/seesaw/wiki/Tables)）

```
(display
 (ss/table
   :id :dumb-table
   :model [:columns
           [{:key :one, :text "One~1"} 
             {:key :one, :text "The Other~2"}]
           :rows
           [["1" "2"]
            ["3" "4"]]])) 
```

# c# - 无法在 .cshtm 文件中将类型“int”隐式转换为“string”

> ID：13997137
> 
> 赞同：0
> 
> 时间：2012-12-21T21:02:32.453
> 
> 标签：c#, sql, database

我正在处理 .cshtm 页面和服务器端编码我面临的异常无法将类型隐式转换`int`为`string`. 代码如下

```
@{
    var id = Request.QueryString["Id"]; //page.cshtml?id=5
    var data="";
    var query = "Select * from products where id="+id;
    data = db.Execute(query).toString();
} 
```

string' 不包含“Name”的定义，并且找不到接受“string”类型的第一个参数的扩展方法“Name”（您是否缺少 using 指令或程序集引用？）

现在我面临这个例外。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:05:10.953

如果您的变量 id 是 type `int`，则您不能将其添加到 a`string`而不先转换为字符串：`id.ToString();`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:04:07.767

假设结果`db.Execute(query)`是一个整数，尝试调用该`ToString`方法：

```
db.Execute(query).ToString(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:06:04.587

尝试 ：

```
var query = "Select * from products where id="+id.ToString(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T21:06:11.767

```
public int Execute(string commandText, params Object[] args) 
```

变量数据是字符串，但执行 return int

```
var query = "Select * from products where id="+id;
int data = db.Execute(query);
//or string data = Convert.ToString(db.Execute(query), formatProvider); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T21:08:18.740

您可以使用`ToString()`将整数转换为字符串。

就个人而言，我更喜欢以下内容，因为它似乎提供了更多控制：

```
var query = String.Format("Select * from products where id={0}", id); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-21T21:10:30.833

您正在尝试做的是成熟的 SQL 注入可能性。

您要使用`SqlCommand`和使用`SqlParameter`以防止注射。

这种方法你也不必担心转换类型，ADO.Net 为你处理。

假设您使用 SqlConnection 连接到 MSSQL 数据库：

```
var id = Request.QueryString["Id"];
var query = "Select * from products where id=@id";
var data = "";

using (SqlCommand command = new SqlCommand(query, db))
{
    command.Parameters.Add(new SqlParameter("@id", id));

    data = command.ExecuteScalar().ToString();
} 
```

# mono - 在共享主机环境中部署 Mono MVC

> ID：13997144
> 
> 赞同：1
> 
> 时间：2012-12-21T21:03:02.883
> 
> 标签：mono, asp.net-mvc-4, shared-hosting

我没有在 serverfault 上发帖，因为该应用程序正在开发中，我需要在 Mono 中对其进行测试，但它也可能适合那里......

我不想问**是否**可以在 Apache2 VirtualHost 上部署一个 ASP.NET MVC 网站，因为它是，而是如果它可以不干扰 PHP 配置。

## 长问题

Apache 的默认 PHP 配置如下所示

```
<IfModule mod_php5.c>
        AddHandler application/x-httpd-php .php4
        AddHandler application/x-httpd-php .php5
        AddHandler application/x-httpd-php .php
        AddHandler application/x-httpd-php-source .php4s
        AddHandler application/x-httpd-php-source .php5s
        AddHandler application/x-httpd-php-source .phps
        DirectoryIndex index.php4
        DirectoryIndex index.php5
        DirectoryIndex index.php
</IfModule> 
```

这告诉 Apache .php 文件是 PHP 脚本。

好的...

现在，如果我`mod_mono`在服务器上启用，它会将 .aspx 文件映射到 Mono。没关系。

但是，当我使用非常适合 PHP 的准系统配置启用测试主机 VirtualHost 时（它基于`mod_macro`您是否介意美元）

```
<VirtualHost *:80>
    ServerName www.$name
    ServerAlias $name

    <IfModule mpm_itk_module>
        AssignUserID $user $user

    </IfModule>

    ErrorLog /path/tp/$name/logs/error_log
    CustomLog /path/to/$name/logs/access_log combined

    DocumentRoot /path/to/$name/htdocs
    ServerAdmin email@email
</VirtualHost> 
```

然后我收到默认控制器的 404 错误。

我知道我可以在我自己的测试服务器上简单地说`SetHandler mono`，瞧。但是这个问题会影响通用托管。另外，我自己可以得到答案：由于 Razor-MVC 中没有 .aspx 文件（或者更好的路径通过路由器映射到控制器），那么对于 Apache 无法识别为文件的所有内容，我显然会收到 404 错误.

如果我想将此 Mono 应用程序部署在由支持 Mono 的通用托管服务提供商运行的服务器上，反之亦然，如果我也想（在生产服务器上）为 PHP 和 Mono 提供托管服务，而无需根据客户的更改配置需求，**我可以使用既满足 Mono 又运行 PHP 的 Apache 配置？**

## 缩短的问题

如何配置**一次**Apache2以便在同一 VirtualHost 上同时运行**PHP**和 Mono MVC，而无需根据应用程序编写的语言更改配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T17:15:02.007

转到此配置器 [http://go-mono.com/config-mod-mono/](http://go-mono.com/config-mod-mono/) 它为 Apache2 提供基于 virtualHost 的自动生成配置。现在我正在联合使用 mod_mono 和 mod_php5。

# r - 加载动物园库时出错

> ID：13997147
> 
> 赞同：0
> 
> 时间：2012-12-21T21:03:08.673
> 
> 标签：r, zoo

我正在尝试使用 zoo 包，但不幸的是，当我尝试使用它时它显示错误。

事实上，我得到的结果在最后一行是错误的。

```
> library(zoo)

Attaching package: ‘zoo’

The following object(s) are masked from ‘package:base’:

    as.Date, as.Date.numeric

> library(zoo)
> sbux=read.csv(file="sbuxPrices.csv",header=TRUE)
> dates.sbx = as.yearmon(sbux.df$Date, format="%m/%d/%Y")
> sbux.z=zoo(x=sbux$Adj.Close, order.by=dates.sbx)
> class(sbux.z)
[1] "zoo"
> head(sbux.z)
Jan 0000 Feb 0000 Mar 0000 Apr 0000 May 0000 Jun 0000 
    7.66     8.41    10.73     7.24     8.14     9.14 
```

编辑：（1）我的数据是[http://faculty.washington.edu/ezivot/econ424/sbuxPrices.csv](http://faculty.washington.edu/ezivot/econ424/sbuxPrices.csv)并相信它没有问题，因为我的讲义可以使用它并获得正确的结果。(2) 删除了 rstudio 标签。我认为我在其中编码的事实有所不同！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:10:10.003

简要地：

1.  您没有显示数据，我怀疑您的格式字符串完全错误。

2.  请重新阅读 zoo 包中详细的完整小插曲。

*编辑：*现在您通过提供数据使其可重现：

```
R> sbux <- read.csv("http://faculty.washington.edu/ezivot/econ424/sbuxPrices.csv",
+                   stringsAsFactors=FALSE)
R> summary(sbux)
     Date             Adj.Close    
 Length:181         Min.   : 1.19  
 Class :character   1st Qu.: 3.94  
 Mode  :character   Median : 9.23  
                    Mean   :12.38  
                    3rd Qu.:18.93  
                    Max.   :37.76  
R> 
R> 
R> sbuxZoo <- zoo(sbux[,"Adj.Close"], 
+                 order.by=as.Date(sbux[,"Date"], "%d/%m/%Y"))
R> 
R> head(sbuxZoo)
1993-01-04 1993-01-06 1993-01-07 1993-01-09 1993-01-10 1993-01-11 
      1.21       1.53       1.48       1.71       1.67       1.39 
R> 
```

# html - 在不同的网站中使用相同的 HTML 生成的奇怪字符

> ID：13997149
> 
> 赞同：3
> 
> 时间：2012-12-21T21:03:15.273
> 
> 标签：html, char

我在同一主机中允许使用相同的 .html 和 .swf 文件，但使用不同的域。[但是，您可以在infinitum.com.es/mr_frosty](http://infinitum.com.es/mr_frosty)中看到“©”之前的字符“Â” ，但在[bluecodestudio.com/mrfrosty 上看](http://bluecodestudio.com/mrfrosty)不到它，因为它应该是这样的。

我想知道为什么它会在 infinitum.com.es 上显示奇怪的字符，而在 bluecodestudio.com 上却完全没有出现，使用相同的文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:06:34.613

Â© 是 è，但前者以 UTF-8 编码并被读取为 iso-8859-1。正如您所看到的，外观和意义方面绝对没有关系，但编码方面是有关系的。

基本上，第一个链接存在编码问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:11:26.263

在[http://infinitum.com.es/mr_frosty/](http://infinitum.com.es/mr_frosty/)，HTTP 标头`Content-Type: text/html; charset=ISO-8859-1`声明了编码，这不能在文档本身中被覆盖。这需要在服务器、全局设置或您的 .htaccess 文件中修复。如果无法更改，则必须将文件的编码更改为 ISO-8859-1。

# java - MVC/MVP 和可扩展性

> ID：13997168
> 
> 赞同：0
> 
> 时间：2012-12-21T21:05:59.900
> 
> 标签：java, model-view-controller, design-patterns, mvp

我一直在做一个项目，同时实现 MVP 设计模式（至少据我所知），我只有一个控制器/演示器类，它使用内部类从 UI 的角度处理所有操作

```
public class PresenterClass {
    public PresenterClass(ViewClass view) {
        view.getButtonComponent().addActionListener(new ButtonListener());
        view.getMenuItem().addActionListener(new MenuItemListener());
    }

    class ButtonListener implements ActionListener {
        public void actionPerformed(ActionEvent e) {
            //Do some action with the button
        }
    }

    class MenuItemListener implements ActionListener {
        public void actionPerformed(ActionEvent e) {
            //Do some action with the menu item
        }
    }

} 
```

值得知道的是，每个新的类侦听器都是为需要它的任何新组件创建的，它不仅仅是所有按钮的通用侦听器，因此您最终会得到很多内部类，这就是我的项目中正在发生的事情. 我的项目并不庞大，但它正在增长，虽然我认为它不会大到完全无法管理，但我想过如果我需要处理数百个不同的组件，我该如何处理它？所以这就引出了一个问题：

在实现 MVC 或 MVP 设计模式时如何处理大的可扩展性？

# iphone - iPhone4(s) 和 5 上的 iOS 应用程序的应用程序背景

> ID：13997170
> 
> 赞同：0
> 
> 时间：2012-12-21T21:06:04.690
> 
> 标签：iphone, objective-c, ios, xcode

我正在尝试为我的第一个 Objective-C 应用程序制作一个 GUI。但是，我有点卡在背景上。

我需要应用一个适用于 iPhone4(s) 和 5 的背景。你是怎么做到的？我猜设备上的分辨率不一样。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:11:32.540

有几种不同的方法可以做到这一点。一种是为每个屏幕尺寸创建单独的故事板/xib。另一种是使用条件：

```
if([[UIScreen mainScreen] bounds].height == 568) {
    //
} 
```

或者，如果您的背景是图案图像，您只需要应用一次它就可以在两种屏幕尺寸上工作，它就像这样简单：

```
[[self view] setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"myImage"]]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:14:28.733

只需为 iPhone 5 的尺寸创建背景图像，并为 iPhone 5 的尺寸设置框架。

当应用程序在 iPhone 4 上打开时，它会截断底部的背景——它不会歪斜它。

如果您使用 Storyboard，当 Storyboard 打开时，右下角有一个非常有用的按钮（在缩放按钮旁边）： ![在此处输入图像描述](../Images/1da97dc2409bee019c68eb3683dced89.png)

切换此选项将扩展/收缩您的 ViewController，以便您可以看到 3.5 英寸（iPhone 4-4s）和 4 英寸（iPhone 5）显示器的外观。

# python-3.x - 导入 hashlib - cxFreeze

> ID：13997171
> 
> 赞同：1
> 
> 时间：2012-12-21T21:06:10.090
> 
> 标签：python-3.x, cx-freeze, hashlib

我编写了一个使用 cxFreeze 的程序，但是如果我尝试使用 cxFreeze 编译它，我会收到错误消息：

> 缺少模块：？从 hashlib 导入的 _md5 ？_sha1 从 hashlib 导入？_sha256 从 hashlib 导入？_sha512 从 hashlib 导入

在我看来，cxFreeze 与 hashlib 模块不兼容，因为该错误很容易重现。你只需要导入 hashlib 并尝试编译它。

示例：cx_test.py：

```
import hashlib 
```

setup.py（用于 cxFreeze）：

```
import sys
from cx_Freeze import setup, Executable
buildOptions = dict(
        compressed = True,
        path = sys.path)
setup(
    name = "Hashlibtest",
    options =   dict(build_exe = buildOptions),
    includes = ["hashlib"],       
    executables = [Executable("cx_test.py")]
    ) 
```

有什么想法可以解决这个问题吗？

我在 Ubuntu 12.04 下使用 Python3.2

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-22T12:26:48.087

这不是问题 - 如果您查看 hashdist 的源代码，它使用不同的模块，具体取决于 Python 是否使用 OpenSSL 编译。其他模块可能会在 Windows 上导入一个东西，在 Linux 上导入另一个，或者一个用于 Python 2，另一个用于 Python 3。

在所有这些情况下，cx_Freeze 都会查看所有`import x`语句，并查找所有模块。如果它找不到，它会给你那个信息。但是它仍然会生成一个程序，并且通常仍然可以工作，除非有其他问题。

我以前看过 hashlib 的这些消息，结果程序运行得很好。

# iphone - 恢复应用内购买

> ID：13997173
> 
> 赞同：1
> 
> 时间：2012-12-21T21:06:21.557
> 
> 标签：iphone, objective-c, ios, ipad, storekit

当应用内购买恢复时，会调用以下委托方法：

```
-(void)paymentQueueRestoreCompletedTransactionsFinished:(SKPaymentQueue *)queue {

    NSLog(@"%@", queue.transactions);

    for (SKPaymentTransaction *transaction in queue.transactions) {

        //restore

    }

} 
```

有很多事务，`queue.transactions`而只有一个产品被恢复（在这个例子中，有超过 20 个事务写入日志）。为什么？**不应该只有一笔交易**吗？如果我开始从我的服务器下载产品，它会下载 20 次，因为阵列中的事务太多！

![在此处输入图像描述](../Images/748dc372af328a89aa3bbd970b7e4a4f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:56:03.777

您应该在方法中处理事务`paymentQueue:updatedTransactions:`。在`paymentQueueRestoreCompletedTransactionsFinished:`那里告诉你它已经完成了。

```
- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions {
    for (SKPaymentTransaction *transaction in transactions)
    {
        switch (transaction.transactionState)
        {
            case SKPaymentTransactionStatePurchased:
                // process purchase
                break;
            case SKPaymentTransactionStateFailed:
                // process error
                break;
            case SKPaymentTransactionStateRestored:
                // process restored IAP
                break;
        }
    }
} 
```

# php - 获取最近 30 天的 mysql 结果

> ID：13997176
> 
> 赞同：9
> 
> 时间：2012-12-21T21:06:47.557
> 
> 标签：php, mysql

> **可能重复：**
> [从数据库中获取但仅持续 30 天](https://stackoverflow.com/questions/9616869/get-from-database-but-only-last-30-days)

嗨，我有一些 php 代码，用于计算过去 30 天数据库中的行数。问题是，如果我更改一段代码以使数字从`-30`变为`-20`，则输出数字会从`272`变为`360`而不是下降。

这是代码：

```
$result = mysql_query("SELECT * FROM all_count WHERE DATEDIFF(date,NOW()) = -30 and member ='000002'");
$num_rows60 = mysql_num_rows($result); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-21T21:21:47.933

试试这个

```
select * from `table` where `yourfield` >= DATE_SUB(CURDATE(), INTERVAL 3 MONTH) 
```

例如，对于天、年，请参见下文。

```
DATE_SUB(CURDATE(), INTERVAL 15 DAY) /*For getting record specific days*/

DATE_SUB(CURDATE(), INTERVAL 1 YEAR) /*for getting records specific years*/ 
```

* * *

对于 Anand，查询

```
BETWEEN DATE_SUB( CURDATE( ) ,INTERVAL 6 MONTH ) AND DATE_SUB( CURDATE() ,INTERVAL 3 MONTH ) 
/* For Getting records between last 6 month to last 3 month 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:31:36.163

比较好

```
`date`< DATE(NOW() - INTERVAL 30 DAY) 
```

而不是

```
 DATEDIFF(date,NOW()) = -30 
```

在第一种情况下，日期计算只进行一次，在查询开始时，数据库可以使用日期列上的任何索引。

第二个查询必须计算`DATEDIFF`每一行，数据库不能使用任何索引。第二个查询强制进行全表扫描。

另外，我强烈建议您不要致电您的专栏`date`。是的，我知道您可以用反引号引用该名称，但这很麻烦，当您忘记时，您的语法错误将很难忘记。为列想出一个更具描述性的名称。什么样的约会？日期代表什么？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T21:11:01.970

您可以改用它：

```
$result = mysql_query("SELECT * FROM all_count WHERE `date`< DATE(NOW() - INTERVAL 30 DAY) and     member ='000002'"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T21:11:57.273

正如您在[此处](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_datediff)的文档中看到的那样，MySQL中的`DATEDIFF`函数会告诉您第一个日期与第二个日期的天数差异。

您的查询仅选择差值正好为 30 天的所有行，而不是最多 30 天前的行。因此，20 天前日期的行数完全有可能高于 30 天前。您最可能想要的是：

```
SELECT * FROM all_count WHERE DATEDIFF(date,NOW()) >= -30 and member ='000002' 
```

# sql - 为什么 where 子句中没有窗口函数？

> ID：13997177
> 
> 赞同：65
> 
> 时间：2012-12-21T21:06:57.907
> 
> 标签：sql, sql-server, tsql, window-functions

标题说明了一切，为什么我不能在 SQL Server 的 where 子句中使用窗口函数？

这个查询很有意义：

```
select id, sales_person_id, product_type, product_id, sale_amount
from Sales_Log
where 1 = row_number() over(partition by sales_person_id, product_type, product_id order by sale_amount desc) 
```

但它不起作用。有比 CTE/子查询更好的方法吗？

**编辑**

值得一提的是带有 CTE 的查询：

```
with Best_Sales as (
    select id, sales_person_id, product_type, product_id, sale_amount, row_number() over (partition by sales_person_id, product_type, product_id order by sales_amount desc) rank
    from Sales_log
)
select id, sales_person_id, product_type, product_id, sale_amount
from Best_Sales
where rank = 1 
```

**编辑**

+1 用于显示子查询的答案，但实际上我正在寻找无法在 where 子句中使用窗口函数的原因。

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-12-21T21:24:58.827

> 为什么我不能在 SQL Server 的 where 子句中使用窗口函数？

一个答案，虽然不是特别有用，是因为规范说你不能。

请参阅 Itzik Ben Gan 的文章 -[逻辑查询处理：它是什么以及它对您意味着什么](https://www.itprotoday.com/microsoft-sql-server/logical-query-processing-what-it-and-what-it-means-you)，尤其[是这里的图像](https://www.itprotoday.com/sites/sqlmag.com/files/uploads/2015/10/Figure%2004%20-%20Logical%20query%20processing%20flow%20chart%20-%20hires.jpg)。窗口函数在处理完所有///子句`SELECT`后剩余的结果集上进行评估（步骤 5.1）。`WHERE``JOIN``GROUP BY``HAVING`

> 真的，我正在寻找无法在 where 子句中使用窗口函数的原因。

条款中不允许使用它们的原因`WHERE`是它会产生歧义。[使用窗口函数从高性能 T-SQL 中](https://rads.stackoverflow.com/amzn/click/com/0735658366)窃取 Itzik Ben Gan 的示例(p.25)

假设你的桌子是

```
CREATE TABLE T1
(
col1 CHAR(1) PRIMARY KEY
)

INSERT INTO T1 VALUES('A'),('B'),('C'),('D'),('E'),('F') 
```

而你的查询

```
SELECT col1
FROM T1
WHERE ROW_NUMBER() OVER (ORDER BY col1) <= 3
AND col1 > 'B' 
```

什么是正确的结果？您是否期望`col1 > 'B'`谓词在行编号之前或之后运行？

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-21T21:12:29.293

不需要 CTE，只需在子查询中使用窗口函数即可：

```
select id, sales_person_id, product_type, product_id, sale_amount
from
(
  select id, sales_person_id, product_type, product_id, sale_amount,
    row_number() over(partition by sales_person_id, product_type, product_id order by sale_amount desc) rn
  from Sales_Log
) sl
where rn = 1 
```

编辑，将我的评论移至答案。

`WHERE`在子句之后的数据被实际选择之前，不会执行窗口函数。因此，如果您尝试`row_number`在`WHERE`子句中使用 a ，则尚未分配该值。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-11-04T12:43:40.503

> [“All-at-once operation”](http://social.technet.microsoft.com/wiki/contents/articles/20724.all-at-once-operations-in-t-sql.aspx#All-at-Once)是指同一逻辑查询过程阶段中的所有表达式同时进行逻辑求值。

和伟大的章节**对窗口功能的影响**：

假设你有：

```
CREATE TABLE #Test ( Id INT) ;

INSERT  INTO #Test VALUES  ( 1001 ), ( 1002 ) ;

SELECT Id
FROM #Test
WHERE Id = 1002
  AND ROW_NUMBER() OVER(ORDER BY Id) = 1; 
```

> **All-at-Once 操作告诉我们这两个条件在同一时间点进行逻辑评估。**因此，SQL Server 可以根据估计的执行计划以任意顺序评估 WHERE 子句中的条件。所以这里的主要问题是首先评估哪个条件。

**情况1：**

`If ( Id = 1002 ) is first, then if ( ROW_NUMBER() OVER(ORDER BY Id) = 1 )`

结果：1002

**案例二：**

`If ( ROW_NUMBER() OVER(ORDER BY Id) = 1 ), then check if ( Id = 1002 )`

结果：空

> **所以我们有一个悖论。**

> 这个例子说明了为什么我们不能在 WHERE 子句中使用窗口函数。您可以对此进行更多思考，并找出为什么只允许在**SELECT**和**ORDER BY**子句中使用窗口函数！

* * *

**附录**

Teradata 支持[`QUALIFY`](https://docs.teradata.com/reader/huc7AEHyHSROUkrYABqNIg/GfvNZ6JRZUcXx0Ai971e5w)子句：

> 根据用户指定的搜索条件过滤先前计算的有序分析函数的结果。

```
SELECT Id
FROM #Test
WHERE Id = 1002
QUALIFY ROW_NUMBER() OVER(ORDER BY Id) = 1; 
```

**附录 2：**

> [雪花 - 合格](https://docs.snowflake.net/manuals/sql-reference/constructs/qualify.html)

> **QUALIFY 对窗口函数的作用与 HAVING 对聚合函数和 GROUP BY 子句的作用相同。**

> 因此，在查询的执行顺序中，QUALIFY 在计算窗口函数之后进行评估。通常，SELECT 语句的子句按如下所示的顺序进行评估：
> 
> 从
> 
> ```
>  Where
> 
>     Group by
> 
>     Having
> 
>     Window
> 
>     QUALIFY
> 
>     Distinct
> 
>     Order by
> 
>     Limit 
> ```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-21T21:12:41.947

不一定需要使用CTE，可以使用row_number() 后查询结果集

```
select row, id, sales_person_id, product_type, product_id, sale_amount
from (
    select
        row_number() over(partition by sales_person_id, 
            product_type, product_id order by sale_amount desc) AS row,
        id, sales_person_id, product_type, product_id, sale_amount
    from Sales_Log 
    ) a
where row = 1 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-05-10T19:25:34.233

这是一个旧线程，但我会尝试具体回答该主题中表达的问题。

> 为什么 where 子句中没有窗口函数？

`SELECT`语句具有以*键入顺序*指定的以下主要子句：

```
SELECT DISTINCT TOP list
FROM  JOIN ON / APPLY / PIVOT / UNPIVOT
WHERE
GROUP BY  WITH CUBE / WITH ROLLUP
HAVING
ORDER BY
OFFSET-FETCH 
```

**逻辑查询处理顺序**，或绑定顺序，是*概念上的解释顺序*，它定义了查询的正确性。此顺序确定一个步骤中定义的对象何时可用于后续步骤中的子句。

```
----- Relational result
  1\. FROM
    1.1\. ON JOIN / APPLY / PIVOT / UNPIVOT
  2\. WHERE
  3\. GROUP BY
    3.1\. WITH CUBE / WITH ROLLUP
  4\. HAVING
  ---- After the HAVING step the Underlying Query Result is ready
  5\. SELECT
    5.1\. SELECT list
    5.2\. DISTINCT
----- Relational result

----- Non-relational result (a cursor)
  6\. ORDER BY
  7\. TOP / OFFSET-FETCH
----- Non-relational result (a cursor) 
```

例如，如果查询处理器可以绑定到（访问）`FROM`子句中定义的表或视图，则这些对象及其列可用于所有后续步骤。

相反，子句之前的所有`SELECT`子句都不能引用子句中定义的任何列别名或派生列`SELECT`。但是，这些列可以被后续子句（例如`ORDER BY`子句）引用。

`OVER`子句在应用关联的窗口函数之前确定行集的分区和排序。也就是说，该子句在***基础查询结果***`OVER`集中定义一个窗口或用户指定的一组行，并且窗口函数根据该窗口计算结果。

 *```
Msg 4108, Level 15, State 1, …
Windowed functions can only appear in the SELECT or ORDER BY clauses. 
```

背后的原因是因为*逻辑查询处理*的工作方式`T-SQL`。由于只有在逻辑查询处理到步骤 5.1时才建立*底层查询结果。*`SELECT`（即在处理`FROM`、`WHERE`和步骤之后） `GROUP BY`，`HAVING`窗口函数只允许在查询的`SELECT`and`ORDER BY`子句中使用。

需要注意的是，即使关系模型不处理有序数据，窗口函数仍然是关系层的一部分。`SELECT`步骤 5.1之后的结果。与任何窗口函数仍然是相关的。

另外，严格来说，子句中不允许使用窗口函数的原因`WHERE`并不是因为它会造成歧义，而是因为*逻辑查询处理*中`SELECT`的语句处理顺序`T-SQL`。

链接：[这里](https://docs.microsoft.com/en-us/sql/t-sql/queries/select-transact-sql?view=sql-server-2017#logical-processing-order-of-the-select-statement)、[这里](http://www.itprotoday.com/microsoft-sql-server/logical-query-processing-what-it-and-what-it-means-you)和[这里](http://www.itprotoday.com/microsoft-sql-server/logical-query-processing-part-8-select-and-order-0)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-21T21:19:47.690

最后，还有老式的 SQL Server 2005 之前的方式，带有一个相关的子查询：

```
select *
from   Sales_Log sl
where  sl.id = (
    Select Top 1 id
    from   Sales_Log sl2
    where  sales_person_id = sl.sales_person_id
       and product_type = sl.product_type
       and product_id = sl.product_id
    order by sale_amount desc
) 
```

我给你这个只是为了完整。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-11-09T11:23:42.130

基本上第一个“WHERE”子句条件由 sql 读取，并且相同的列/值 id 查看了表，但表中的 row_num=1 仍然不存在。因此它不会起作用。这就是我们将首先使用括号然后我们将编写 WHERE 子句的原因。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-21T21:16:30.310

是的，不幸的是，当您执行窗口函数时，即使您的 where 谓词是合法的，SQL 也会生您的气。您在 select 语句中创建一个具有该值的 cte 或嵌套选择，然后稍后使用该值引用您的 CTE 或嵌套选择。应该是不言自明的简单示例。如果您真的讨厌 cte 在处理大型数据集时遇到一些性能问题，您可以随时使用临时表或表变量。

```
declare @Person table ( PersonID int identity, PersonName varchar(8));

insert into @Person values ('Brett'),('John');

declare @Orders table ( OrderID int identity, PersonID int, OrderName varchar(8));

insert into @Orders values (1, 'Hat'),(1,'Shirt'),(1, 'Shoes'),(2,'Shirt'),(2, 'Shoes');

--Select
--  p.PersonName
--, o.OrderName
--, row_number() over(partition by o.PersonID order by o.OrderID)
--from @Person p 
--  join @Orders o on p.PersonID = o.PersonID
--where row_number() over(partition by o.PersonID order by o.orderID) = 2

-- yields:
--Msg 4108, Level 15, State 1, Line 15
--Windowed functions can only appear in the SELECT or ORDER BY clauses.
;

with a as 
    (
    Select
    p.PersonName
,   o.OrderName
,   row_number() over(partition by o.PersonID order by o.OrderID) as rnk
from @Person p 
    join @Orders o on p.PersonID = o.PersonID
    )
select *
from a 
where rnk >= 2 -- only orders after the first one. 
```*

# c# - 使用 GDI+ 进行高级颜色混合

> ID：13997178
> 
> 赞同：8
> 
> 时间：2012-12-21T21:07:22.930
> 
> 标签：c#, winforms, colors, gdi+, blending

将 GDI+ 与 Windows 窗体一起使用，我希望能够用笔绘制并根据目标像素颜色混合颜色。

例如，如果我画一条线并且它通过黑色像素，我希望它是较浅的颜色（例如白色），以便它可见。当同一条线经过白色像素时，它应该是较暗的颜色（例如黑色），以便它仍然清晰可见。

有没有办法用 GDI+ 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T21:26:45.647

正如 Hans Passant 建议的那样，您可以使用画布中当前的内容作为纹理画笔的图像进行绘制（您可能需要双缓冲才能正常工作）并使用 a`ColorMatrix`来修改画布上绘制的颜色。

有一个颜色矩阵可以反转类似于 XOR 的颜色，问题是它不适用于中间灰色。反转 RGB 并保持 alpha 不变的颜色矩阵将是：

```
-1, 0, 0, 0, 0
 0,-1, 0, 0, 0
 0, 0,-1, 0, 0
 0, 0, 0, 1, 0
 1, 1, 1, 0, 1 
```

类似的，虽然速度较慢，将画布复制到图像并使用规则处理每个像素的图像像素，例如颜色是否比 0.5 亮，使其稍暗，否则使其稍亮。然后，您使用该处理后的图像作为纹理画笔进行绘制。这会产生更好的结果，但它会比使用`ColorMatrix`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T17:28:16.803

您可以尝试对笔颜色进行异或运算。Paint.NET 使用选择边框来做到这一点，使其在任何颜色上都可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-24T19:35:01.357

哦，我不认为这太难了。您可以创建一支笔，它会根据它所在的位置自动更改颜色。只需读取笔所在位置的像素（参见示例），获取 Alpha 组件，如果分别大于或小于 255/2，则将笔颜色设置为黑色或白色：)

# php - 选项卡内的纯 CSS 选项卡

> ID：13997183
> 
> 赞同：2
> 
> 时间：2012-12-21T21:07:51.047
> 
> 标签：php, html, css, tabs

被困在这几个小时，不能完全弄清楚出了什么问题。我有 2 个主要选项卡，当您单击它们时，会在内容中打开另一组选项卡。第一个主选项卡及其子选项卡工作正常。但是，第二个选项卡及其子选项卡不起作用。这是代码-感谢您的帮助。

这是 HTML：

```
 <div class="tabs">
    <div class="tab">
        <input type="radio" id="tab-1" name="tab-group-1" checked>
        <label for="tab-1">EVOLVE</label>
        <div class="content">
            <div class="table tab">
                <input type="radio" id="tabchild-1" name="tabchild-group-1" checked>
                <label for="tabchild-1">FOREST</label>
                <div class="content">
                    Forest Cards go Here.
                </div>
            </div>
            <div class="table tab">
                <input type="radio" id="tabchild-2" name="tabchild-group-1">
                <label for="tabchild-2">MOUNTAINS</label>
                <div class="content">
                    Mountain Cards go Here.
                </div>
            </div>
            <div class="table tab">
                <input type="radio" id="tabchild-3" name="tabchild-group-1">
                <label for="tabchild-3">SWAMP</label>
                <div class="content">
                    Swamp Cards go Here.
                </div>
            </div>
            <div class="table tab">
                <input type="radio" id="tabchild-4" name="tabchild-group-1">
                <label for="tabchild-4">PLAINS</label>
                <div class="content">
                    Plains Cards go Here.
                </div>
            </div>
            <div class="table tab">
                <input type="radio" id="tabchild-5" name="tabchild-group-1">
                <label for="tabchild-5">DARKNESS</label>
                <div class="content">
                    Darkness Cards go Here.
                </div>
            </div>
            <div class="table tab">
                <input type="radio" id="tabchild-6" name="tabchild-group-1">
                <label for="tabchild-6">NEUTRAL</label>
                <div class="content">
                    Neutral Cards go Here.
                </div>
            </div>
        </div> 
    </div>

    <div class="tab2">
        <input type="radio" id="tab-2" name="tab-group-1">
        <label for="tab-2">ENHANCE</label>
        <div class="content2">
            <div class="table2 tab2">
                <input type="radio" id="tabchild-1" name="tabchild-group-2" checked>
                <label for="tabchild-1">FOREST</label>
                <div class="content2">
                    Forest Hero Cards go Here.
                </div>
            </div>
            <div class="table2 tab2">
                <input type="radio" id="tabchild-2" name="tabchild-group-2">
                <label for="tabchild-2">MOUNTAINS</label>
                <div class="content2">
                    Mountain Hero Cards go Here.
                </div>
            </div>
            <div class="table2 tab2">
                <input type="radio" id="tabchild-3" name="tabchild-group-2">
                <label for="tabchild-3">SWAMP</label>
                <div class="content2">
                    Swamp Hero Cards go Here.
                </div>
            </div>
            <div class="table2 tab2">
                <input type="radio" id="tabchild-4" name="tabchild-group-2">
                <label for="tabchild-4">PLAINS</label>
                <div class="content2">
                    Plains Hero Cards go Here.
                </div>
            </div>
            <div class="table2 tab2">
                <input type="radio" id="tabchild-5" name="tabchild-group-2">
                <label for="tabchild-5">DARKNESS</label>
                <div class="content2">
                    Darkness Hero Cards go Here.
                </div>
            </div>
       </div> 
   </div>
    <div class="background_tab"></div>
</div> 
```

这是CSS

```
 .tabs {position: relative;min-height: 200px;}
    .tab, .tab2 {float: left;}
    .tab{text-decoration:none;}
    .tab2{text-decoration:none;}
    .tab label, .tab2 label {
        padding: 10px; 
        margin-left: -1px; 
        position: relative;
        left: 1px;
        border-top: 1px solid black;
        border-bottom: 1px solid black;
        border-right: 1px solid #444;
        border-left: 1px solid #333;
        background: #3d3d3e;
        background: -webkit-linear-gradient(#3d3d3e, #2a2a2a);
        background: -moz-linear-gradient(#3d3d3e, #2a2a2a);
        background: -o-linear-gradient(#3d3d3e, #2a2a2a);
        background: linear-gradient(#3d3d3e, #2a2a2a);
        box-shadow: 0 1px 0 #3d3d3d, inset 0 1px 0 #5a5a5a;
        height: 100%;
        line-height: 24px;
        overflow: hidden;
        text-align: center;
        font-size: 12px;
        font-family: verdana;
        font-weight:bolder;
        z-index:1;
        }
    .tab [type=radio], .tab2 [type=radio]{display: none;}
    .content, .content2{
        position: absolute;
        top: 28px;
        left: 0;
        right: 0;
        bottom: 0;
        border-top: 1px solid black;
        border-bottom: 1px solid black;
        border-left: 1px solid #666;
        background: #5d5d5e;
        background: -webkit-linear-gradient(#5d5d5e, #4a4a4a);
        background: -moz-linear-gradient(#5d5d5e, #4a4a4a);
        background: -o-linear-gradient(#5d5d5e, #4a4a4a);
        background: linear-gradient(#5d5d5e, #4a4a4a);
        box-shadow: 0 1px 0 #5d5d5d, inset 0 1px 0 #4a4a4a;
        padding: 0px 25px 25px;
        margin-top:25px;
        z-index:1
        }
    [type=radio]:checked ~ label{
        box-shadow: inset 0 0 10px black;
        text-shadow: -2px -2px 1px #111111, -1px -1px 1px #111111, 1px 1px 1px #111111, 2px 2px 1px #111111, -3px -3px 1px #111111, -1px 1px 1px #111111, -3px 3px 1px #111111, 5px -2px 1px #111111, 5px 3px 1px #111111;
        color:orangered;
        z-index: 2;
        }
    [type=radio]:checked ~ label ~ .content {z-index: 2;}
    [type=radio]:checked ~ label ~ .content2 {z-index: 3;}
    .background_tab{
        float:left;
        padding: 10px 10px 26px; 
        margin-left: -1px; 
        position: relative;
        left: 2px;
        border-top: 1px solid black;
        border-bottom: 1px solid black;
        border-left: 1px solid #333;
        background: #3d3d3e;
        background: -webkit-linear-gradient(#3d3d3e, #2a2a2a);
        background: -moz-linear-gradient(#3d3d3e, #2a2a2a);
        background: -o-linear-gradient(#3d3d3e, #2a2a2a);
        background: linear-gradient(#3d3d3e, #2a2a2a);
        box-shadow: 0 1px 0 #3d3d3d, inset 0 1px 0 #5a5a5a;
        height: 100%;
        line-height: 24px;
        overflow: hidden;
        text-align: center;
        font-size: 12px;
        font-family: verdana;
        margin-top:14px;
        width:729px;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:39:10.160

第二个选项卡组 ( ) 中的`radio`按钮与第一组 ( ) 中的按钮`div.tab2`具有相同`ID`的 's `div.tab`。

更改它们，它会正常工作（例如：）

```
<div class="table2 tab2">
    <input type="radio" id="tab2child-3" name="tabchild-group-2">
    <label for="tab2child-3">SWAMP</label>
    <div class="content2">
        Swamp Hero Cards go Here.
    </div>
</div> 
```

ETC...

请记住还要将`for`属性更改为每个相应的标签。

这是一个有效的[jsfiddle](http://jsfiddle.net/A8P5N/1/)。

# javascript - 用 jquery 隐藏 HTML

> ID：13997187
> 
> 赞同：2
> 
> 时间：2012-12-21T21:08:14.907
> 
> 标签：javascript, jquery

我在这样的页面上写了html，我无法控制，我只能使用jquery访问它，我需要你的帮助来解决。

```
<span class="breadcrumb">
<a href="http://www.example.com" class="breadcrumb"></a>Home / 
<a href="http://www.example.com" class="breadcrumb">Home</a> / 
</span> 
```

我只想隐藏具有空链接的第一行中的“Home /”文本。这个问题是文本没有包含在链接中，而是纯文本。

但我想保持包含链接的第二行可见

```
<a href="http://www.example2.com" class="breadcrumb">Home</a> / 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:16:40.437

您可以获取[.contents()](http://api.jquery.com/contents/) .. 然后使用[.slice()](http://api.jquery.com/slice/)获取您不想要的文本部分

```
$('span.breadcrumb').contents().slice(2,3).remove(); 
```

[http://jsfiddle.net/3gpgY/](http://jsfiddle.net/3gpgY/)

如果您也想删除文本之前的锚点，只需更改起始索引

```
$('span.breadcrumb').contents().slice(1,3).remove(); 
```

[http://jsfiddle.net/eK7F7/](http://jsfiddle.net/eK7F7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:10:19.280

试试这个：

```
$(".breadcrumb a:nth-child(2)").prevAll().remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:11:01.817

请执行下列操作 ：

```
var content = $('.breadcrumb a').eq(1);
$('.breadcrumb').eq(0).html(content); 
```

你可以在这里看到结果：http: [//codepen.io/joe/pen/uoeIh](http://codepen.io/joe/pen/uoeIh)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T21:19:06.120

这是一个肮脏的解决方案

```
 $( '.breadcrumb' ).html( $( '.breadcrumb' ).html().replace( /[^\n]*><\/a>[^\n]*\n/, '' ) ); 
```

如果你想用你必须使用的 DOM 节点来做`$.( '.breadcrumb' ).contents()`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T21:24:24.777

试试这个：

```
$(document).ready(function() {
    var newCont = $('<span>')
    $('.breadcrumb a').each(function (){
        $(newCont).append($(this).html())
    })
    $('.breadcrumb').html(newCont)
})​ 
```

jsfiddle：http: [//jsfiddle.net/hA6gf/2/](http://jsfiddle.net/hA6gf/2/)

# c# - 如何将属性添加到类和函数

> ID：13997197
> 
> 赞同：1
> 
> 时间：2012-12-21T21:09:20.560
> 
> 标签：c#, attributes, annotations

我正在学习 C#。我看到了类似下面的代码。我的问题是：你怎么知道在 [ ] 里面放什么？您是否必须手动添加它们或者有一个工具（例如Visual Studio）来做到这一点？当然，它不仅限于 xml。我在网上搜索，是属性注解。有什么好的参考读物吗？

```
 [XmlRoot("Logs")]
    public class LogConfig {

        [XmlArray("Servers")]
        [XmlArrayItem("Server")]
        public Server[] servers{
         set; get;   
        }

        public LogConfig(){
        }        
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:18:12.873

属性是普通类，这意味着您可以定义自己的！有关如何执行此操作的示例，请参见[此处](http://msdn.microsoft.com/en-us/library/sw480ze8.aspx)。你输入的`[]`是类的名称。您放入的`()`内容由属性类具有的属性定义。

例如（这来自上面链接的 MSDN 文章），对于下面的属性类：

```
[System.AttributeUsage(System.AttributeTargets.Class)]
public class Author : System.Attribute
{
    private string name;
    public double version;

    public Author(string name)
    {
        this.name = name;
        version = 1.0;
    }
} 
```

您可以将此属性添加到类中，如下所示：

```
[Author("P. Ackerman", version = 1.1)]
class SampleClass
{
    // P. Ackerman's code goes here...
} 
```

有关 .NET 框架中已定义属性的列表，请参阅[本页](http://msdn.microsoft.com/en-us/library/system.attribute.aspx)底部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:13:17.507

> 是不是要手动一一添加

是的。

您将了解这些属性以及如何应用它们。

* * *

一些工具可以从 XSD 或 JSON 生成类，这些类可能包含上述属性，但如果您正在编写类，则需要自己添加属性。

没有工具可以猜测类将如何映射到 XML 结构。

# javascript - 禁用移动设备的 Nextgen 灯箱效果？

> ID：13997199
> 
> 赞同：1
> 
> 时间：2012-12-21T21:09:30.083
> 
> 标签：javascript, wordpress

在移动设备上查看时，如何禁用 nextgen wordpress 插件的灯箱效果？

这是该项目：www.brendanbrowne.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-22T22:14:01.590

这是我的解决方案：

请记住，您需要 jQuery 1.9.1 或更低版本，因为据我所知 1.9.1 及更低版本仍然有 jQuery 浏览器（尽管已弃用）。如果您使用的是 jQuery 2.0，您需要下载 jQuery 浏览器作为插件。

```
var isiPad = /ipad/i.test(navigator.userAgent.toLowerCase());
if (isiPad)
{
    $('.ngg-gallery-thumbnail a').removeAttr('rel');
}

if(jQuery.browser.mobile)
{
    $('.ngg-gallery-thumbnail a').removeAttr('rel');
    //alert('You are using a mobile device!');
} 
```

# jquery - 通过 Scala Play 2.0 生成的列表映射的 JQuery 迭代

> ID：13997201
> 
> 赞同：1
> 
> 时间：2012-12-21T21:09:48.030
> 
> 标签：jquery, json, scala, playframework, playframework-2.0

鉴于我的播放控制器中的以下 Scala（为简洁起见而减少）：

```
object Sample {
     def apply(someArgToBeUsedLater: String) = {
          val success = Map("foo" -> List("Things", "Stuff", "Test"))
          Ok(Json.toJson(success)).as("application/json")
     }
} 
```

我想在客户端使用生成的 JSON，如下（JQuery）：

```
jsRoutes.controllers.Application.myFunc(someArgToBeUsedLater).ajax({success:     
     function(data) {
    $(data.foo).each(function(index) {
        $('#unorderedList').add("li").html(this);
    });
}}); 
```

而我想`this`成为一个单一的字符串，看着 FireBug：字符似乎被分割了：`String { 0="T", 1="h", 2="i", more...}`

看来，如果我简单地使用直接 JavaScript 进行迭代（不使用 JQuery each()），那么我不会有问题。因此，看来我只是错误地使用了 JQuery。另一方面，我对 Scala 比较陌生，我也想知道我是否正确构建了 JSON。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:14:21.480

尝试 $.each(data.foo, function(index){ ... })

$('data.foo') 是 JQuery 选择器用来抓取 DOM 的一部分的语法。

# javascript - QUnit - 比较隐藏的输入 - TypeError：输入上的选择方向

> ID：13997203
> 
> 赞同：0
> 
> 时间：2012-12-21T21:09:55.033
> 
> 标签：javascript, unit-testing, qunit

我想比较两个元素块，看看它们是一样的。我要比较的项目有隐藏的输入，我遇到了这个错误，我认为这与隐藏的输入有关：

TypeError：在无法选择的输入元素上访问 selectionDirection。

这是我的代码的简化版本（以及 JSFiddle 中的内容）：

```
test("compare input", function() {
  var input1 = $('<input/>').attr("value", 'cool_play');
  var input2 = $('<input/>').attr("value", 'cool_play');
  deepEqual(input1, input2);
});

test("compare hidden input", function() {
  var input1 = $('<input/>').attr("type", "hidden").attr("value", 'cool_play');
  var input2 = $('<input/>').attr("type", "hidden").attr("value", 'cool_play');
  deepEqual(input1, input2);
});​ 
```

第一个示例通过，但第二个示例引发错误。

这是 jsfiddle 示例：http: [//jsfiddle.net/HLG5y/1/](http://jsfiddle.net/HLG5y/1/)

有没有办法将输入元素与隐藏类进行比较？我是否以错误的方式尝试此操作？谢谢你。我觉得我也应该能够比较隐藏的输入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:44:01.250

这不是一个理想的解决方案，但我通过比较解决了这个问题

```
equal(actual.html(), expected.html()); 
```

其中实际和预期是元素块。

# xml - 自动生成 XML 文档

> ID：13997204
> 
> 赞同：1
> 
> 时间：2012-12-21T21:10:02.430
> 
> 标签：xml, visual-studio-2010, visual-studio-2012

我不太确定这是否可能，但我想知道 Visual Studio 10 (2010) 或 11 (2012) 是否允许您自动生成符合 XML 的文档？

例如，在 Visual Studio 中，如果您使用编程语言 C#，当您创建一个方法并键入 3 个正斜杠`/`时 - 它会在该方法上方生成一个注释，其中包含一个用于填写摘要的位置，以及所有参数的描述。

例子：

```
/// <summary>
/// 
/// </summary>
/// <param name="value1"></param>
/// <param name="value2"></param>
/// <returns></returns>
public int GetSum(int value1, int value2); 
```

如果没有，是否有允许这样做的扩展/工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:15:56.040

是的，它被称为[doxygen](http://www.doxygen.nl)，这种风格的评论实际上被称为“doxygen-comments”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-18T17:57:16.923

I know this is a old thread. But if someone is still looking for this, ghostdoc is what you need [http://submain.com/products/ghostdoc.aspx](http://submain.com/products/ghostdoc.aspx)

# javascript - 如何更改翻转时的边框颜色？

> ID：13997207
> 
> 赞同：0
> 
> 时间：2012-12-21T21:10:19.723
> 
> 标签：javascript, css, html

我正在编写一个包含文本框的网页。我想通过更改边框颜色来突出显示鼠标悬停在文本上的文本，但它一直不起作用。

这是我的html代码

```
 <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
    Remove this if you use the .htaccess -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>main</title>
    <meta name="description" content="" />
    <meta name="author" content="Zolani" />

    <meta name="viewport" content="width=device-width; initial-scale=1.0" />

    <!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <title>canvas</title>
    <meta name="description" content="" />
    <meta name="author" content="Zolani" />
    <link rel="stylesheet" type="text/css" href="canvas.css"/>
    <script type="application/javascript" src="canvas.js"></script>
</head>

<body>
    <div class="title">
        Linear Algebra.
    </div>
    <div>
        <div class="box" onmouseover="light()">
            <h1 class="boxtitle"> Matrix </h1>

            <p>
                Here are some matrixes. They're pretty cool, to
                be honest thing!
            </p>
        </div>
        <div class ="box" onmouseover="light()">
            <h1 class="boxtitle"> Subspaces </h1>

            <p>
                Example
            </p>
        </div>
    </div>

</body> 
```

我的CSS代码

```
body { background: #AC00BF }

.title {
    position: absolute;
    left: 800px;
    top: 20px;
    color: black;
    font-size: 4.8em;
    font-family: sans-serif;
}

.box {
    color: white;
    font-family: sans-serif;
    font-size: 12px;
    background: black;
    border-style: solid;
    border-width: 4px;
    border-color: black;
    margin: 2cm 2cm 2cm 2cm;
    max-width: 300px;
    max-height: 200px;
}

.boxtitle {
    font-size: 18px;
    font-family: Georgia;
} 
```

我想在翻转时将 div 的边框更改为白色。我一直在尝试使用 box: hover 的变体，但它没有奏效。我还使用了 a.box: hover 并实现了标签，但 div 像链接一样显示。

如何在悬停时将此 div 的边框颜色更改为白色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:14:22.163

使用`:hover`on`.box`为我完成了工作：

```
.box:hover{
    border-color: white
} 
```

您必须记下顺序（以下示例不起作用）：

```
.box {
    border-color: black
}

.box:hover{
    border-color: white
} 
```

[演示](http://fiddle.jshell.net/d58K8/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:14:36.400

为什么不使用`:hover`css 选择器？

```
 div.box {
        ...
        border-color: black; (
    }

    div.box:hover {
        border-color: white;
    } 
```

# sql - 从多个表返回空结果

> ID：13997213
> 
> 赞同：0
> 
> 时间：2012-12-21T21:10:54.190
> 
> 标签：sql, sql-server-2008

也许我找不到解决方案的原因是因为我不知道我真正在寻找什么！希望我能解释它足够的答案。我有 3 个表（1 个视图和 2 个表）。该视图包含我需要的所有详细信息，我们将其称为用户表。表 2 和表 3 包含用户的最后一次登录（2 个单独的系统）。我希望结果集显示视图中的每个用户，以及表 2 和 3 中每个用户的最后一次登录。我匹配员工 ID。我遇到的问题是表 2 和表 3 没有列出每个员工 ID，因为他们从未登录过。因此，如果我内部连接表 1 和 2，结果集不会显示视图中的所有用户，只显示匹配的用户。但是，我需要返回视图中的所有用户，如果用户从未登录（员工 ID 不在表 2 中），则将其留空或任何其他文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:13:51.913

不要使用`INNER`连接。改用`OUTER`联接

例如（*表名和列名是虚构的..*）

```
SELECT 
  u.*, t1.logindate, t2.logindate
FROM 
  usertable u
LEFT OUTER JOIN table1 t1 ON u.id = t1.uid
LEFT OUTER JOIN table2 t2 ON u.id = t2.uid 
```

引用[文档](http://msdn.microsoft.com/en-us/library/ms187518%28v=sql.105%29.aspx)

> **仅当两个表中至少有一行与连接条件匹配时，***内部连接才返回行。****内连接消除了与另一个表中的行不匹配的行。*
> ***然而，外部连接***至少从 FROM 子句中提到的一个表或视图返回所有行，只要这些行满足任何 WHERE 或 HAVING 搜索条件。
> 所有行都从左外连接引用的左表中检索，右外连接引用右表中的所有行。两个表中的所有行都在完全外连接中返回。**

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:15:48.787

您要查找的内容称为[左外连接。](http://msdn.microsoft.com/en-us/library/ms187518%28v=sql.105%29.aspx)

像这样的东西：

```
select u.*, s1.*, System2Login.*
from users u
  left outer join System1Login s1 on u.EmployeeID = s1.EmployeeID
  left outer join System2Login s2 on u.EmployeeID = s2.EmployeeID 
```

应该返回表中的**所有**行，`users`以及来自 system1 和 system2 的数据（如果可用）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:15:55.193

```
SELECT <whatever columns you need>
FROM Table1 t1
LEFT OUTER JOIN Table2 t2
ON t1.employeeID = t2.employeeID
LEFT OUTER JOIN Table3 t3
ON t1.employeeID = t3.employeeID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T21:17:09.813

您正在描述“外部连接”的作用。使用 a `LEFT OUTER JOIN`（或 RIGHT）而不是 an `INNER JOIN`，这样即使第二个表中没有匹配项，第一个表的结果也会出现。

请阅读此[http://en.wikipedia.org/wiki/Join_(SQL)#Outer_joins](http://en.wikipedia.org/wiki/Join_(SQL)#Outer_joins)**

# mono - 为多个部署管理多个 Web.config 文件

> ID：13997214
> 
> 赞同：0
> 
> 时间：2012-12-21T21:10:57.203
> 
> 标签：mono, asp.net-mvc-4, web-config, visual-studio-2012

我将在以下环境中进行开发和测试：

*   开发：我的带有 VirtualBox-ed MySQL 数据库的桌面（很快 SQLite 直接在开发机器上）
*   本地测试：VirtualBox 上的 Linux 虚拟机与 Mono 和 MySQL
*   Azure 暂存：带有 SQL Azure 后端的 Azure 网站角色
*   另一个 Azure 暂存：使用 Apache/Mono 堆栈和 SQL Azure 作为后端的 Linux VM

我使用 Visual Studio 2012 发布功能发布到这些环境：例如，我使用 FTP 配置发布到本地测试环境，并且我已经从管理控制台下载了 Azure 发布配置文件。

我必须管理环境的不同设置，**主要是****连接字符串**和方言方面的 NHibernate 配置。但是我迟早会在每个环境中使用不同的 Spring bean（即在云上利用本地文件系统上的 blob 存储）。

由于我在 Web.config 中定义了所有配置，并且当环境随着 Spring 的广泛使用而发生变化时，我将尽我所能不触及代码。

## 如何告诉 Visual Studio 使用不同的 Web.config 文件发布到每个目标，或者更好地使 Web.config 的某些节点适应发布配置文件？

# python - Google 应用引擎中的 Webapp2 会话

> ID：13997215
> 
> 赞同：4
> 
> 时间：2012-12-21T21:11:00.543
> 
> 标签：python, google-app-engine, session, webapp2

我刚刚弄清楚如何使用 python 在我的 Google 应用引擎项目中实现 webapp2 会话。代码如下。我想知道的是最好的方法是什么？我所做的是创建了一个 python 文件并将 BaseHandler 代码放入其中，然后我只需导入它，但我必须不断地在每个 python 应用程序/文件中复制配置键。

我从网站上获得的 BaseHandler 的代码：

```
class BaseHandler(webapp2.RequestHandler):
    def dispatch(self):
        # Get a session store for this request.
        self.session_store = sessions.get_store(request=self.request)

        try:
            # Dispatch the request.
            webapp2.RequestHandler.dispatch(self)
        finally:
            # Save all sessions.
            self.session_store.save_sessions(self.response)

    @webapp2.cached_property
    def session(self):
        # Returns a session using the default cookie key.
        return self.session_store.get_session() 
```

要在会话中设置变量，我只需将 BaseHandler 导入应用程序并像示例中一样调用以下命令：

```
self.session['name'] = name 
```

获取变量就像在示例中一样：

```
name = self.session.get('name') 
```

我必须在每个文件中复制的部分如下：

```
 config = {}
 config['webapp2_extras.sessions'] = {'secret_key': 'some-secret-key-to-use',}

app = webapp2.WSGIApplication([('/hello.*', MainHandler),
                            ], config=config, debug=True) 
```

这是最好的方法还是有更好的方法？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-06T06:34:00.430

我处理会话的方式是创建一个派生自 webapp2.RequestHandler 的 BaseHandler 类。我为 BaseHandler 类配备了所有会话初始化和默认会话值，并重用该类来创建每个处理程序，而不是直接从 webapp2.RequestHandler 派生。

这样做的明显优势是您不必每次必须在文件中使用会话时都重复会话初始化。

```
class BaseHandler(webapp2.RequestHandler):
    def dispatch(self):
        # Get a session store for this request.
        self.session_store = sessions.get_store(request=self.request)
        try:
            # Dispatch the request.
            webapp2.RequestHandler.dispatch(self)
        finally:
            # Save all sessions.
            self.session_store.save_sessions(self.response)
    @webapp2.cached_property
    def session(self):
        # Returns a session using the default cookie key.
        sess = self.session_store.get_session()
        #add some default values:
        if not sess.get('theme'):
            sess['theme']='cosmo'#'slate'
        return sess

class MainPage(BaseHandler):
    def get(self):
        template = JINJA_ENVIRONMENT.get_template('stereo.html')
        if self.request.get('theme'):
            theme=self.request.get('theme')
            self.session['theme']=theme
        else:
            theme=self.session['theme'] 
```

有关详细信息，请参阅我的[文章](http://prahladyeri.wordpress.com/2013/11/21/how-to-handle-sessions-in-google-app-engine/)。

# c++ - 在头文件中使用 void

> ID：13997221
> 
> 赞同：2
> 
> 时间：2012-12-21T21:11:14.003
> 
> 标签：c++

这是我的头文件，auto vs static.h

```
#include "stdafx.h"
#include <iostream>

void IncrementAndPrint()
{
    using namespace std;
    int nValue = 1; // automatic duration by default
    ++nValue;
    cout << nValue << endl;
} // nValue is destroyed here

void print_auto()
{
    IncrementAndPrint();
    IncrementAndPrint();
    IncrementAndPrint();
}

void IncrementAndPrint()
{
    using namespace std;
    static int s_nValue = 1; // fixed duration
    ++s_nValue;
    cout << s_nValue << endl;
} // s_nValue is not destroyed here, but becomes inaccessible

void print_static()
{
    IncrementAndPrint();
    IncrementAndPrint();
    IncrementAndPrint();
} 
```

这是我的主文件，namearray.cpp

```
#include "stdafx.h"
#include <iostream>
#include "auto vs static.h"
using namespace std;

    int main(); // changing this to "int main()" (get rid of ;) solves error 5\. 
    {
    print_static();
    print_auto();
    cin.get();
    return 0;
    } 
```

我正在尝试打印 (cout) 2 2 2 2 3 4

错误：

![错误](../Images/98a4e72fabbfd646db24dbf9f812734b.png)

我觉得我的错误只是在头文件中使用了 void 。如何更改头文件以使我的代码正常工作？

参考：来自[learncpp的代码](http://www.learncpp.com/cpp-tutorial/41-blocks-compound-statements-and-local-variables/)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T21:13:30.777

您不能声明具有相同名称和参数的两个函数。

```
 void IncrementAndPrint() 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-21T21:22:49.323

与变量不同，您不能为函数赋予新值。所以这是编译器的想法：

“哦，好的，当你说 时`IncrementAndPrint`，你的意思是文件顶部的这个函数”。

然后它会看到`print_auto`并了解这意味着什么。但是当你试图告诉它这`IncrementAndPrint`实际上意味着另一个函数时，编译器就会感到困惑。“但你已经告诉我什么`IncrementAndPrint`意思了！”，编译器抱怨道。

这与变量（以某种方式）形成对比，您可以在其中说：

```
int x = 0;
x = 6; 
```

编译器在某一时刻明白，`x`有 value `0`，但是你说“`x`现在不同了，它意味着`6`.”。但是，您不能说：

```
int x = 0;
int x = 6; 
```

因为当您在变量名之前包含类型时，您正在定义一个新变量。如果不包含类型，则只是分配给旧类型。

您将不得不提供`IncrementAndPrint`不同的名称。

或者，您可以让它们采用不同的论点，例如`void IncrementAndPrint(int x);`vs. `void IncrementAndPrint(double y);`。我不建议在这里，因为您不需要参数。

另一种可能性是使用[命名空间](http://www.cplusplus.com/doc/tutorial/namespaces/)。它看起来像这样：

```
namespace automatic_variables {

void IncrementAndPrint() {
    // automatic variable version
}
void print() {
    // automatic version
}
}
namespace static_variables {

void IncrementAndPrint() {
    // static variable version
}
void print() {
    // static version
}
} 
```

# c++ - 自动打印 GDB 中最后一个表达式的值，如 VisualStudio 的“自动”监视窗口

> ID：13997224
> 
> 赞同：3
> 
> 时间：2012-12-21T21:11:18.233
> 
> 标签：c++, linux, gdb

VisualStudio 的调试器有一个名为[Auto Window](http://msdn.microsoft.com/en-us/library/aa290702%28v=vs.71%29.aspx)的功能，它始终显示当前和前一个表达式的值。有没有办法在 GDB 中实现类似的行为，尤其是对于 C++ 应用程序？

我知道 GDB 中的`display`and`commands`命令，但它们似乎不是我想要的。在 VS 中，调试器自动计算出要评估的表达式，然后在程序的每一步中对其进行评估。这个功能——自动找出要评估的表达式——是我希望 GDB 做的。

例如，假设我正在逐步执行此代码：

```
#include <cstdlib>
#include <iostream>
#include <iomanip>
#include <sstream>
using namespace std;

int main()
{
    string s = "Hello";
    s += "World";

    int i = 2;
    i *= 3;
    i *= 7;

    stringstream ss ;
    ss << "The result is " << i << "!\n";
    ss << "Now, what was the question?";

    s += ss.str();

    cout << s << endl;

} 
```

...我即将执行该`i*=7`行。在 VS 的 Autos 窗口中，我看到：

![在此处输入图像描述](../Images/bac3b959687d2207e7c33ba77f172edb.png)

有没有办法让 GDB 向我显示当前和以前的表达式的值，无论它们是什么，如这里的 Autos 窗口所示？ **编辑**请注意，我没有输入`i`上面的屏幕截图——调试器为我做了这些，它在程序的每一步都显示了潜在的差异表达式。我正在寻找那种自动显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:48:26.600

自从我使用“ddd”（这是一个运行在 GDB 之上为您提供 GUI 功能的应用程序）以来已经有很长时间了，但它可能会给您您想要的东西 - 它确实可以很好地显示您正在执行的行并且可以显示本地单独窗口中的变量等 [ddd](http://www.gnu.org/software/ddd/)

如果您去寻找，GDB 可能还有其他 GUI 层。

否则，恐怕显示器可能是您最接近的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:23:55.290

你可以使用[display](http://ftp.gnu.org/old-gnu/Manuals/gdb-5.1.1/html_node/gdb_56.html "展示")命令来做你想做的事。您还可以使用[commands](http://www.ofb.net/gnu/gdb/gdb_35.html "命令")命令在遇到断点时执行命令列表。

# php - 找不到路径“/login_check”的控制器

> ID：13997233
> 
> 赞同：5
> 
> 时间：2012-12-21T21:12:27.180
> 
> 标签：php, symfony, symfony-2.1

我无法在 symfony 上进行用户身份验证。我的`login_path`工作正常，但出现`check_path`故障。我指定的路径给出了著名的`Unable to find the controller for path "/login_check". Maybe you forgot to add the matching route in your routing configuration?`

我看过其他帖子，他们似乎都在做我正在做的事情。我对 symfony 很陌生，并且难以掌握这些概念，因此我将不胜感激。

我正在使用 Symfony 2.1，如果这有什么不同的话。

我相信我已经正确配置了所有内容：

## 安全.yml

```
security:
    encoders:
        Symfony\Component\Security\Core\User\User: plaintext
        Site\CommonBundle\Entity\User: plaintext

    role_hierarchy:
        ROLE_LIGHT:       ROLE_LIGHT
        ROLE_ADMIN:       [ROLE_LIGHT, ROLE_USER]
        ROLE_SUPER_ADMIN: [ROLE_LIGHT, ROLE_USER, ROLE_ADMIN, ROLE_ALLOWED_TO_SWITCH]

    providers:
        database:
            entity: { class: SiteCommonBundle:User }

    firewalls:
        dev:
            pattern:  ^/(_(profiler|wdt)|css|images|js)/
            security: false

        login_firewall:
            pattern:  ^/(login|logout|login_check)
            anonymous: ~

        secured:
            pattern: ^/secured/
            form_login:
                login_path: /login
                check_path: /login_check
            logout:
                path: /logout
                target: /

    access_control:
        - { path: ^/secured/, roles:ROLE_LIGHT }
        - { path: ^/login, roles: IS_AUTHENTICATED_ANONYMOUSLY} 
```

## 路由.yml

```
common_login:
    pattern:  /login
    defaults: { _controller: SiteCommonBundle:Default:login }

common_login_check:
    pattern: /login_check 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-21T22:00:49.187

该`login_check`路径需要在您的安全区域内。

在您的代码中，Pattern 定义了“/secured”前缀，因此您的 login_check 也需要以“/secured”作为前缀。

在您的情况下，安全防火墙定义所有路径都以前缀开头，`/secured`但您的登录检查路径的路径是`/login_check`. 因此防火墙无法处理该表格。

我认为您也应该将其从 login_firewall 中删除。

# c++ - 在扩展 MAPI 中更改帐户

> ID：13997236
> 
> 赞同：0
> 
> 时间：2012-12-21T21:12:40.923
> 
> 标签：c++, mapi

尽管安装了该软件的计算机，但我正在尝试使用扩展 MAPI 使用相同的电子邮件地址从应用程序发送和接收电子邮件。最初我试图登录到一个非默认帐户，但只取得了零星的成功。然后，我阅读了一篇文章，该文章解释了如何使用 oom 搜索默认用户个人资料中的帐户，并自行设置了第二个电子邮件地址。

不幸的是，我没有找到任何关于如何使用扩展 MAPI 来更改正在使用的帐户的信息。使用扩展 MAPI 访问主要配置文件上的辅助帐户需要做什么？

感谢您提供的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:19:13.933

如果您使用的是非默认帐户，Outlook 将使用该帐户的名称和 ID 标记外发邮件：使用 OutlookSpy（单击 IMessage 按钮）查看已发送邮件文件夹中的邮件。如果要更改帐户的顺序，请使用 IOlkAccountManager::SetOrder。如果单击 IOlkAccountManager 按钮，您可以在 OutlookSopy 中查看 edxisting 订单。

# session - 通过服务获取 Symfony 2 版本？

> ID：13997238
> 
> 赞同：1
> 
> 时间：2012-12-21T21:12:41.127
> 
> 标签：session, symfony, request, locale

我需要从服务中获取当前语言环境，包括 Symfony 2.0.x (uses `Session`) 和 Symfony 2.1.x (uses `Request`)。

我会做类似的事情：

```
if(version_compare(Symfony::VERSION, '2.1.0') < 0) {
    $obj = $this->get('session');
}
else {
    $obj = $this->get('request');
}

$locale = $obj->getLocale(); 
```

但是没有`Symfony::VERSION`常数。任何的想法？除了使用`is_callable`或奇怪的东西......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:39:12.870

```
use Symfony\Component\HttpKernel\Kernel;
echo Kernel::VERSION . "\n"; 
```

不确定这是否是推荐的方式，但它有效。内核类实际上是在 bootstrap.cache 类中定义的，因此每当您更新 Symfony 源代码时都会更新 VERSION。

还暴露：

```
const VERSION         = '2.1.4-DEV';
const VERSION_ID      = '20100';
const MAJOR_VERSION   = '2';
const MINOR_VERSION   = '1';
const RELEASE_VERSION = '4';
const EXTRA_VERSION   = 'DEV'; 
```

# c# - 修改目标对象

> ID：13997241
> 
> 赞同：0
> 
> 时间：2012-12-21T21:12:53.857
> 
> 标签：c#, automapper

我有嵌套集合和相应模型的实体。比方说：

```
class Entity
{
    public IList<NestedEntity> Nested { get; set; }
} 
```

和

```
class Model
{
    public IList<NestedModel> Nested { get; set; }
} 
```

我需要类似以下的东西：

```
var existingEntity = service.GetEntity(id);
Mapper.Map<Model, Entity>(model, existingEntity);
// now existingEntity is an updated entity and we can save it
service.SaveEntity(existingEntity); 
```

因此，在映射嵌套集合映射器时，应删除现有实体中不存在的项目，添加新创建的项目并更新其他项目。
我应该如何配置 AutoMapper 以达到这种行为？
我发现 custom `ValueResolver`s`ResolveCore`方法没有目标类参数，所以它只能**创建**不能**更新**集合。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:28:27.140

这是模型->实体映射的解决方案。

```
Mapper.CreateMap<NestedModel, NestedEntity>();
Mapper.CreateMap<Model, Entity>()
      .ForMember(x => x.Nested, opt => opt.ResolveUsing<Resolver>());

public class Resolver : IValueResolver
{
    public ResolutionResult Resolve(ResolutionResult source)
    {
        var targetCollection = ((Entity) source.Context.DestinationValue).Nested;

        // TODO: Custom mapping here.

        return source.New(targetCollection, typeof(NestedEntity[]));
    }
} 
```

# javascript - 单选按钮“选择”切换问题

> ID：13997242
> 
> 赞同：0
> 
> 时间：2012-12-21T21:13:00.737
> 
> 标签：javascript, jquery, html, forms, radio-button

我正在尝试制作一个非常简单的脚本来检查是否单击了某个单选按钮选项，如果是，则显示另一组字段（这很好），但是如果您取消选择该单选按钮选项，它会隐藏额外的字段集（看似简单，但对我不起作用！）

另外我对 JS/JQuery 很陌生，所以调试这一直很困难！谢谢你的帮助 ：）

我的触发字段显示的 HTML 单选按钮 - 想象一下还有 6 个其他单选按钮选项（每个都用 [class="otherFund"] 分类）。

```
<input type="radio" name="ItemName1" id="Relief1" value="Daughters of Penelope Charitable Relief Fund" onclick="set_item('DOP-Relief-Fund', 8)" onchange="relief_fund_handler()" /> 
```

这是文本和字段，我想使用上面按钮的选择进行切换

```
<p id="Earmark1" style="display: none;">
   <strong>Please designate below what relief fund you would like your <em>DOP Charitable Relief</em> donation to go towards (see bulleted examples above).</strong><br />
   <strong>Earmarked for <span class="required">*</span>:</strong><input type="text" name="Earmark1" id="Earmark1" size="50" />
</p> 
```

这是我的 JS 尝试......

*尝试1：*

```
function relief_fund_handler() {

   var relief_elem = document.getElementById("Relief1"),
       earmark_elem = document.getElementById("Earmark1"),
       donate_elem = document.getElementById("ItemName1");

   if (relief_elem.checked) {
       earmark_elem.setAttribute("style", "display: inline;");    
   } else if (".otherFund".checked) {          
       earmark_elem.setAttribute("style", "display: none;");
   }
} 
```

*尝试2：*

```
function relief_fund_handler() {

   var relief_elem = document.getElementById("Relief1"),
       earmark_elem = document.getElementById("Earmark1"),
       donate_elem = document.getElementById("ItemName1");

   if (relief_elem.checked) {  
       earmark_elem.setAttribute("style", "display: inline;");    
   } else {
       earmark_elem.setAttribute("style", "display: none;"); 
   }
} 
```

*尝试3：*

```
$("#Relief1:checked")( 
    function() { 
       $('#Earmark1').toggle();
    } 
); 
```

在尝试 #3 时，我也用 , 替换了`:checked`,并且`.click`没有一个工作......感谢您的帮助！:)`.select``.change`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:33:35.427

尝试这个：

```
$("input.otherFund").change(function() {
    $('#Earmark1').toggle($(this).attr('id') == 'Relief1');
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:33:55.117

尝试从单选按钮中删除所有事件，如下所示：

```
<input type="radio" name="ItemName1" id="Relief1" value="Daughters of Penelope Charitable Relief Fund" /> 
```

并使用以下 jquery 脚本：

```
​$(function(){
    $("#Relief1").change(function(){
        $(this).is(":checked") ? $("#Earmark1").show() : $("#Earmark1").hide();
    });
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:42:52.820

You could iterate through each radio button and assign an event handler to each radio button, so when selected it shows the other fields and when deselected it hides the other fields. 下面的代码可以帮助您得出正确的答案。

```
// Iterate the radio buttons and assign an event listener

$('input[name="ItemName1"]').each( function() {

    // Click Handler

    $(this).live('click', function() {

        // Check for selected

        if ( $(this).is(':checked') )
        {
            $('#EarMark1').show();
        }
        else 
        {
            $('#EarMark1').hide();
        }
    });

}); 
```

它并不完美，也不是最优雅的解决方案。通过一些调整，它应该为您指明正确的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T17:46:06.340

谢谢大家！！！我最终使用了 kennypu 的示例 - ":checked" 似乎工作正常，即使它是一个单选按钮。我不得不对其进行一些调整，最终得到了 2 个单独的函数而不是“else”。出于某种原因，其他示例对我不起作用-尽管我非常怀疑它与您的代码有关，并且可能与页面中发生的其他事情有关。由于我们使用的是外部表单/数据库处理程序，因此我们需要将事件和其他代码保留在那里。

这就是最终的工作..

```
 $(function(){
    $("#Relief1").change(function(){
    if($(this).is(":checked")) {
      $("#Earmark1").show();
      }
      });
    });

  $(function(){
    $("#Radio1, #Radio2, #Radio3, #Radio4, #Radio5, #Radio6, #Radio7").change(function(){
    if($(this).is(":checked")) {
      $("#Earmark1").hide();
      }
      });
    }); 
```

相当笨重，但我让它按我的需要工作。感谢所有贡献的人，它帮助了很多。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-21T21:38:03.407

尝试：

```
<script>
var r=$('input[name="ItemName1"]).is(:checked);
if(r)
{
alert("Item is checked");//replace with any code
}
</script> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-21T21:36:36.810

如果您已经在使用 jQuery，这就像使用`.show()`and一样简单`.hide()`：

```
$('#Relief1').on('change',function() {
  if($(this).is(':checked')) {
    $('#Earmark1').show();
  } else {
    $('#Earmark1').hide();
  }
}); 
```

小提琴示例：http: [//jsfiddle.net/x4meB/](http://jsfiddle.net/x4meB/)

另请注意，不要使用重复的 ID，它们是唯一的（在这种情况下，您有一个重复`#Earmark1`的 p 标签和跨度）。此外，在示例小提琴中，我将其更改为复选框而不是收音机，因为如果只有一个选项，您无法取消选中收音机。

# php - 如何以paypal形式使用php动态变量

> ID：13997243
> 
> 赞同：0
> 
> 时间：2012-12-21T21:13:03.693
> 
> 标签：php, paypal

我想在表单中使用动态变量，我尝试像这样使用但 `<input type="hidden" name="first_name" value=<?php echo $firstname ?> />` 它不起作用，有没有办法使用动态变量？我的观点是，当用户登录我的网站并单击贝宝按钮时，所有这些值都会写在贝宝表单上。

```
$sql = mysql_query("SELECT * FROM members WHERE id=' $userid' LIMIT 1");
while($row = mysql_fetch_array($sql)) {
$firstname = $row['firstname']; 
$lastname = $row['lastname'];`
}

$pp_checkout_btn .= '<form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_cart"><input type="hidden" name="upload" value="1"><input type="hidden" name="business" value="xxxxxxx@xxx.xx">
<input type="hidden" name="first_name"value=<?php echo $firstname ;?> />  
<input type="hidden" name="last_name" value=<?php echo $lastname ;?> /> 
    .........</form>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:58:21.437

我相信您可以使用 paypal 表单发送的唯一“自定义”变量是一个名为“自定义”的变量，它将为您存储一个字符串。

从您的问题来看，您似乎想在贝宝网站上为用户预先填写信息。在这种情况下，您可以为此设置表单元素。见这里：[https ://www.paypal.com/cgi-bin/webscr?cmd=_pdn_xclick_prepopulate_outside](https://www.paypal.com/cgi-bin/webscr?cmd=_pdn_xclick_prepopulate_outside)

如果您想在您的网站上确认付款，并在确认付款后进行操作，您需要在您的网站上设置一个IPN（[https://www.paypal.com/ipn](https://www.paypal.com/ipn)），一旦确认，paypal会通知。

# css - 在 div HTML/CSS 中对齐 div

> ID：13997246
> 
> 赞同：0
> 
> 时间：2012-12-21T21:13:17.023
> 
> 标签：css, html

我已经玩了一段时间的浮动，显示，内联块，内联，块，但似乎无法找到正确的方法来“证明”在 div 中的 div。这是它的 HTML 部分：

```
<body>
<div id="container">
<div align="center" id="header">
    <h1>This is my header area</h1>
</div>

<nav>
  HOME |
  COC |
  ID CARDS |
  SCHEDULE |
  FORMS |
  CFS |
  MEDIA |
  LINKS |
  CONTACT US
</nav>

<div class="boxes">

<div id="box1">
Content box 1
</div>

<div id="box2">
Content box 2
</div>

<div id="box3">
Content box 3
</div>
</div>

<div id="main">
    <h1>This is the main Div</h1>
    <p>This is my paragraph Area</p>
</div>

<div align="center" id="footer">
    <h3>(This is my footer area)<br>
        Copyright 2012-2013 blah blah blah  </h3>
</div>
</div>
</body> 
```

这是我的 CSS：

```
body {
font:"Times New Roman", Times, serif;
background-color:#333;
margin: 0;
padding: 0;
color:#06C;

}
nav {
padding:10px;
}

#container {
width: 80%;
max-width: 1260px;
min-width: 780px;
background-color:#0B0B0B;
margin: 0 auto;
text-align: left;

}
.boxes {
width:100%;
display:inline-block;
margin:10px;
padding:10px;

}

#box1 {
width: 150px;
height: 150px;
border:1px;
border-style:dashed;
float:left;
margin:10px;
padding:10px;
 }

#box2 {
width: 150px;
height: 150px;
border:1px;
border-style:dashed;
float:left;
margin:10px;
padding:10px;
 }

 #box3 {
width: 150px;
height: 150px;
border:1px;
border-style:dashed;
float:left;
margin:10px;
padding:10px;
 }

#main {
clear:both;
} 
```

我已经研究过了，但我似乎无法真正做到正确。

我希望框 1 2 和 3 在任何建议的宽度内均匀分布？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:36:07.003

您可以为 3 个盒子中的每一个赋予 25% 的宽度以适合父 div。

```
#box1 {
  width: 25%;
}

#box2 {
  width: 25%;
}
... 
```

[http://jsfiddle.net/4chjf/1/](http://jsfiddle.net/4chjf/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T09:46:54.163

用下面替换你的CSS -

```
body {
font:"Times New Roman", Times, serif;
background-color:#333;
margin: 0;
padding: 0;
color:#06C;

}
nav {
padding:10px;
}

#container {
width: 80%;
max-width: 1260px;
min-width: 780px;
background-color:#0B0B0B;
margin: 0 auto;
text-align: left;

}
.boxes {
width:100%;
display:inline-block;
margin:10px;
padding:10px;

}

#box1 {
width: 25%;
height: 150px;
border:1px;
border-style:dashed;
float:left;
margin:10px;
padding:10px;
margin-left:60px;
 }

#box2 {
width: 25%;
height: 150px;

border:1px;
border-style:dashed;
float:left;
padding-left:25px;
margin:10px;
padding:10px;
 }

 #box3 {
width: 25%;
height: 150px;
border:1px;
border-style:dashed;
float:left;
margin:10px;
padding:10px;
 }

#main {
clear:both;
} 
```

祝你好运！

# javascript - “null 或 undefined 被强制成为全局对象的情况”

> ID：13997247
> 
> 赞同：2
> 
> 时间：2012-12-21T21:13:27.467
> 
> 标签：javascript, strict

约翰雷西格[写道](http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/)：

> 最后，解决了一个长期存在的（并且非常烦人的）错误：null 或 undefined 被强制成为全局对象的情况。严格模式现在可以防止这种情况发生并引发异常。
> 
> `(function(){ ... }).call( null ); // Exception`

他指的是什么错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:16:08.880

基本上，您使用的`call()`方法 from `Function.prototype`，默认情况下将范围作为第一个参数。如果执行范围为`undefined`或`null`，则默认为全局对象。在某些情况下，使用`call`带有立即调用函数表达式的方法（上面的代码相当少见）不会使用全局对象作为默认的回退执行范围。

如果这是在严格模式代码中评估的，则该`this`值不会被强制转换为对象。or的`this`值不转换为全局对象，原始值不转换为包装对象。通过函数调用（包括使用and进行的调用）传递的 this 值不会将传递的值强制为（ECMA 语言规范的 10.4.3、11.1.1、15.3.4.3、15.3.4.4 条款）。`null``undefined``Function.prototype.apply``Function.prototype.call``this``Object`

# r - 如何在 R 中创建具有所有可能性的摘要数据框

> ID：13997249
> 
> 赞同：2
> 
> 时间：2012-12-21T21:13:30.010
> 
> 标签：r, join, outer-join, summary

如果我有可能的小时数和可能的项目的向量：

```
possible.items = c(12,13,14,15,16)
possible.hours = 0:23 
```

还有一些关于在购买这些商品的时间购买这些商品的客户的数据：

```
frame = data.frame(id=101:105, hour=c(0,0,0,1,1), item=c(12,14,12,12,15)) 
```

我将如何创建一个汇总数据框，其中每个可能的小时都有一行，项目组合中填充了我数据集中的相关行数？

我知道如何创建一个汇总数据框，但不知道如何创建一个包含不在我的原始数据集“框架”中的行：

```
summary = aggregate(id~hour+item, data=frame, FUN=length) 
```

我还看到了一种获得所有可能组合的方法：

```
poss = merge(data.frame(hour=possible.hours), data.frame(item=possible.items), all=TRUE) 
```

我不确定如何将两者结合起来。我也不知道我走的路是否正确。

我想得到一个看起来像这样的数据框：

```
hour item count
   0   12     2
   0   13     0
   0   14     1
   0   15     0
   0   16     0
   1   12     1
...
  23   16     0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:28:26.357

你快到了。合并`hour`并`item`给出你想要的。

使用`poss`和`summary`定义它们：

```
result <- merge(poss, summary, by=c('hour','item'),all=T)
names(result)[3] <- 'count'
result$count[is.na(result$count)] <- 0

> head(result)
  hour item count
1    0   12     2
2    0   13     0
3    0   14     1
4    0   15     0
5    0   16     0
6    1   12     1 
```

如评论中（并在布兰登的回答中建议），`expand.grid`是生成所有组合的适当方法：

```
poss <- expand.grid(list(hour=0:23, item=12:16)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:11:46.217

这就是我使用 plyr 的方式

```
require(plyr)
purchases <- data.frame(id = 101:105, hour = c(0,0,0,1,1), item = c(12,14,12,12,15))
results.table <- merge(expand.grid(list(hour = 0:23, item = 12:16)), purchases, by = c('hour', 'item'), all = TRUE)
summary.table <- ddply(results.table, c("hour", "item"), summarise, count = length(na.omit(id))) 
```

这样您就不需要先创建可能的.* 和汇总表，节省了几个步骤。

# qt - Qt OpenGL - 鼠标拖动旋转 - 负增量

> ID：13997250
> 
> 赞同：2
> 
> 时间：2012-12-21T21:13:33.940
> 
> 标签：qt, opengl, rotation, qglwidget

我有一个 QGLWidget 的 GLWdiget 子类，我想在其中沿 Ox 和 Oy 轴旋转 3D 对象。

为此，我以这种方式重新实现`mousePressEvent`和`mouseMoveEvent`运行：

```
void GLWidget::mousePressEvent(QMouseEvent *event)
{
 lastPos = event->pos();
}

void GLWidget::mouseMoveEvent(QMouseEvent *event)
{
  float dx = (event->x() - lastPos.x()) / 10.0f;
  float dy = (event->y() - lastPos.y())/ 10.0f;

 if (event->buttons() & Qt::LeftButton) 
   {
   glRotatef(dy*0.1, 1.0f, 0.0f, 0.0f);
   glRotatef(dx*0.1, 0.0f, 1.0f, 0.0f);
   }
} 
```

我的问题是，`dx`并且`dy`永远不会是负数，所以无论我用鼠标做什么方向，它总是在同一个方向旋转。

例如，如果我水平向右拖动，我希望对象以正角沿 0y 轴旋转，如果我向左水平拖动，则以负角旋转。

这对于垂直拖动是相同的，但旋转将沿着 Ox 轴。

这个问题来自全球坐标吗？但是，`event->x`并`event->y`给出相对于 GLWidget 的位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T21:28:49.943

您没有在 mouseMoveEvent 结束时更新 lastPos 吗？从 Qt 示例：

```
void GLWidget::mouseMoveEvent(QMouseEvent *event)
{
     int dx = event->x() - lastPos.x();
     int dy = event->y() - lastPos.y();

     if (event->buttons() & Qt::LeftButton) {
         setXRotation(xRot + 8 * dy);
         setYRotation(yRot + 8 * dx);
     } else if (event->buttons() & Qt::RightButton) {
         setXRotation(xRot + 8 * dy);
         setZRotation(zRot + 8 * dx);
     }
    lastPos = event->pos();
} 
```

我建议您看一下似乎与您的用例相匹配的[Qt Hello GL 。](http://qt-project.org/doc/qt-4.8/opengl-hellogl.html)

# sql - sql查询中除、乘、减的执行顺序

> ID：13997255
> 
> 赞同：-6
> 
> 时间：2012-12-21T21:14:01.857
> 
> 标签：sql, sql-server

我在我的 SQL 查询中使用了 Addition '+' 、 Multiplication '*' 和 Divide '/' 运算符。它的执行顺序是什么？

询问

```
Select A * (B) - C * 100 / (D-E) From Table 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:17:20.950

与任何其他相同... 基于 PEMDAS

```
Parenthesis

Exponents

Multiply 
  and 
Divide at same level, left to right

Add 
  and 
Subtract at same level left to right.

(D-E) is done first
(B) is done next, but is left as-is as no other direct relation 
A * B
C * 100
then 
(result of C * 100) / (D - E result)
(A * B result ) - ( entire C * 100 / (D-E) result) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:37:45.057

请看下面的链接

[http://msdn.microsoft.com/en-us/library/ms190276.aspx](http://msdn.microsoft.com/en-us/library/ms190276.aspx)

很明显，如果两个运算符具有相同的优先级，那么左侧的表达式将获得更高的优先级。括号内的表达式也将获得最高的存在

在您的情况下，将首先评估 (D -E)。然后它将是 A * (B) 作为其在左侧。然后是C * 100。然后是除法，最后是减法。

让我知道我是否正确

# wcf - 从具有两个合约和端点的服务创建代理

> ID：13997262
> 
> 赞同：1
> 
> 时间：2012-12-21T21:14:20.887
> 
> 标签：wcf

我在向我的 app.config 添加实现两个合同的服务时遇到问题，因此需要两个端点。

有关我正在尝试做的基本示例，请参阅此问题：

[用于在不同端点上实现多个合同的服务类的 WCF 配置](https://stackoverflow.com/questions/3936239/wcf-config-for-a-service-class-implementing-multiple-contracts-on-separate-endpo)

我真的很想在我的客户端中使用服务参考来为我创建和维护代理，但是当我尝试使用具有两个端点的服务执行此操作时，当它尝试下载元数据时，我在详细信息中收到以下错误：

> 元数据包含无法解析的引用

这是我如何在我的 wcf 服务库的 app.config 中设置服务的示例：

```
 <service name="MyService">
    <endpoint address="Address1" binding="wsDualHttpBinding" bindingConfiguration=""
      name="Service1" contract="IService1" />
    <endpoint address="Address2" binding="wsDualHttpBinding" bindingConfiguration=""
      name="Service2" contract="IService2" />
    <endpoint address="mex" binding="mexHttpBinding" bindingConfiguration=""
      name="mex" contract="IMetadataExchange" />
    <host>
      <baseAddresses>
        <add baseAddress="http://localhost:8732/Design_Time_Addresses/MyService/" />
      </baseAddresses>
    </host>
  </service> 
```

我觉得我错过了一些简单的东西。当我删除一个端点时，一切正常。但是如果我有两个端点，它就无法解析元数据。

我尝试删除基地址并使用完整地址，并且使用不同的端口，但我尝试过的所有路径都会导致相同的错误。

* * *

编辑：我首先应该澄清为什么我想这样做。我有一个单例服务，我希望客户端能够连接到该服务。但是有些方法我不希望客户可以使用。我认为将管理方法和客户端方法分成两个单独的合同将是一个好的开始。

更清楚地说，这是一个游戏服务器。我希望能够启动游戏服务器的新实例并向其发送地图之类的东西。我不希望游戏玩家可以访问诸如 LoadMap() 之类的方法或类似的方法。我真的想将游戏客户端拥有的方法和回调与匹配服务或服务器管理员拥有的方法和回调分开。

我也希望它们是单独的合同，只是为了更容易阅读和维护。

但是，如果有更好的方法可以做到这一点，我愿意接受建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T16:27:19.010

我花了一段时间才弄清楚这一点。我撕毁了我的项目并从头开始重建它，直到它崩溃。

显然，如果您尝试这样做，您的回调合同中不能有两个同名的回调方法。

例子：

```
public interface IService1Callback
{
    [OperationContract(IsOneWay = true)]
    void GetDataDone();
}

public interface IService2Callback
{
    [OperationContract(IsOneWay = true)]
    void GetDataDone();
} 
```

如果您随后将这些设置为服务合同上的回调合同，如下所示：

```
[ServiceContract
(Namespace = "ServiceLib", 
SessionMode = SessionMode.Required, CallbackContract = typeof(IService1Callback))]
public interface IService1
{
    [OperationContract(IsInitiating = true)]
    string GetData(int value);
}

[ServiceContract
(Namespace = "ServiceLib", 
SessionMode = SessionMode.Required, CallbackContract = typeof(IService2Callback))]
public interface IService2
{
    [OperationContract(IsInitiating = true)]
    string GetOtherData(int value);
} 
```

你最终会得到我在原始问题中提到的错误。

我相信这是因为端点无法确定该方法来自哪个回调合约，因为它们具有相同的名称，因此元数据无法解析引用。

幸运的是，我不会有同名的回调，但我被困了一段时间，因为我刚刚设置了一些虚拟方法来让事情顺利进行。

# python - zookeeper 锁保持锁定状态

> ID：13997263
> 
> 赞同：8
> 
> 时间：2012-12-21T21:14:25.190
> 
> 标签：python, locking, celery, apache-zookeeper, kazoo

我正在使用 celery 和 zookeeper (kazoo lock) 来锁定我的工人。当我在释放锁之前杀死（-9）一名工作人员时，我遇到了一个问题，然后该锁将永远保持锁定状态。

所以我的问题是：杀死进程是否会释放该进程中的锁，或者这是zookeeper中的一些错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T14:45:59.460

Zookeeper[锁](http://zookeeper.apache.org/doc/r3.4.5/recipes.html#Shared+Locks)使用[临时节点](http://zookeeper.apache.org/doc/r3.4.5/zookeeperOver.html#Nodes+and+ephemeral+nodes)。临时节点是一个节点，只要创建它的会话还活着，它就会一直存在。会话通过创建会话的进程定期向 Zookeeper 发送心跳消息来保持活动状态。

因此，如果您杀死创建锁的进程，锁最终将被释放，因为会话将随着 Zookeeper 不再接收心跳而终止。

所以在释放锁之前杀死一个工人应该最终释放锁。

如果锁从未被释放，可能会发生一些事情，

1.  其他人注意到锁被释放并获得了它。大概您正在锁定是因为存在争用，而其他一些进程将在释放锁定时尝试获取锁定。
2.  你等待的时间不够长。当你连接到 Zookeeper 时，你应该设置一个会话超时参数，即服务器在不听到任何心跳的情况下保持会话活动多​​长时间，你必须等待这么长时间才能看到锁被释放
3.  kazoo 中有一个错误。这是可能的，但看起来 kazoo[锁配方](https://kazoo.readthedocs.org/en/latest/_modules/kazoo/recipe/lock.html)使用临时节点，而您描述的用例是一个非常基本的用例。

这不太可能是 zookeeper 错误。

你怎么知道锁没有被释放？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:17:52.240

使用终止信号终止进程不会清除“软件锁”，例如 ZooKeeper 锁。

被 KILL 信号杀死的唯一类型的锁是操作系统级别的锁，因为所有文件描述符都被杀死，因此文件描述符锁也被杀死。但就 ZooKeeper 而言，这些不是操作系统级别的锁（仅仅是因为 ZooKeeper 进程，即使在同一台机器上，也不是你的 python 进程之一）。

因此，这不是 ZooKeeper 中的错误，也是您 kill -9 的预期行为。

# regex - 使用参数重定向到其他域

> ID：13997271
> 
> 赞同：3
> 
> 时间：2012-12-21T21:14:55.117
> 
> 标签：regex, apache, .htaccess, mod-rewrite

这是初始网址：

`http://example.net/any/number/folders/param1/param2/value2/value1`

这是我们需要映射到的 url：

`http://example.com/any/number/folders/param1.php?param1=value1&param2=value2`

脚本 param1.php 位于 param1 目录下，并且两者都存在。

我有这些规则，但不工作。通常会收到 404 错误。

```
RewriteEngine On
RewriteBase /param1
RewriteCond %{REQUEST_URI} /param1
RewriteRule ^(.*)(param1)/(.*)/(.*)/(.*)$ http://example.com/$1/$2.php?$2=$5&$2=$3 [L,R=301,QSA] 
```

我一直在努力让它工作几个小时，并且也在寻找类似的东西。在这一点上，我什至不确定这是否可能。

任何建议或解决方案将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:25:28.220

我只是做了一些小的调整，你可以试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_URI} /param1
RewriteRule ^(.*)(param1)/([^/]*)/([^/]*)/([^/]*)$  http://example.com/$1$2.php?$2=$5&$3=$4 [L,R=301] 
```

# html - iOS 上的横向模式有什么作用 ？

> ID：13997274
> 
> 赞同：14
> 
> 时间：2012-12-21T21:15:09.530
> 
> 标签：html, ios, webkit, viewport

我试图了解 iOS 上的缩放属性。

1.  根据[Apple 的 Developer Docs](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html)，声明`<meta name="viewport" content="width=device-width">`将告诉 iOS 在页面加载时（纵向模式）将网页缩放为 1:1 像素比。

2.  根据HTML5Boilerplate 人员[的介绍](https://docs.google.com/present/view?id=dkx3qtm_22dxsrgcf4)`device-width`（参见幻灯片 13） ，无论设备的方向如何，都将始终对应于 iOS 设备屏幕的较小尺寸。

3.  因此，如果您在 iOS 中加载带有`<meta name="viewport" content="width=device-width">`声明的页面，同时将设备保持为横向，iOS 将根据屏幕高度设置视口的宽度，从而产生 1.5:1 (iPhone 4s) 或 2： 1 (iPhone 5) 像素比。

我是正确的，还是我误解了 Apple 使用的“宽度”和“设备宽度”的定义？

此外，当 iOS 设备旋转时，视口保持什么？是宽度，还是比例？它取决于元设置吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T21:26:44.827

根据 Apple 的开发者文档：

“同样，如果只指定视口宽度，则推断高度和初始比例。注意……横向保持宽度等于设备宽度，这会改变初始比例并具有放大时的效果用户更改为横向。”

该文章指出，无论设备方向或旋转如何，iOS 都会保持相同的视口设置。

请参阅[此处](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html)，在“Safari 如何推断宽度、高度和初始比例”下。

# mysql - 授予对导致问题的其他 MySQL 数据库的权限

> ID：13997275
> 
> 赞同：1
> 
> 时间：2012-12-21T21:15:16.303
> 
> 标签：mysql

我有一个用户' `myuser`'和两个数据库。' `db1`' 和 ' `db2`'。

“ `myuser`”已经拥有使用权`db1`，我想`db2`通过使用以下查询授予他使用“ ”的额外权限：

```
GRANT ALL ON db2.* TO 'myuser'@'localhost'; 
```

在我运行授权语句后，' `myuser`'失去了与第一个数据库的连接' `db1`'

恐怕我使用了错误的主机名。我应该使用 '%' 而不是 'localhost'。当我做：

```
 select host from mysql.user where user = 'myuser'; 
```

现在我看到该用户的两条主机记录`'%'`和“ ”`localhost`

当我运行 SHOW GRANT 语句时，我获得了不同主机的权限。“本地主机”和“%”。

```
mysql> SHOW GRANTS FOR 'myuser'@'localhost';
+----------------------------------------------------------------------+
| Grants for myuser@localhost                                      |
+----------------------------------------------------------------------+
| GRANT USAGE ON *.* TO 'myuser'@'localhost'                       |
| GRANT ALL PRIVILEGES ON `beta_version`.* TO 'myuser'@'localhost' |
+----------------------------------------------------------------------+ 
```

和

```
mysql> SHOW GRANTS FOR 'myuser'@'%';
+-----------------------------------------------------------------------------------------------------------+
| Grants for myuser@%                                                                                   |
+-----------------------------------------------------------------------------------------------------------+
| GRANT USAGE ON *.* TO 'myuser'@'%' IDENTIFIED BY PASSWORD '*6ASDFASDFASDF...' 
| GRANT ALL PRIVILEGES ON `myuser`.* TO 'myuser'@'%'                                                
+-----------------------------------------------------------------------------------------------------------+ 
```

发生了什么导致 ' `myuser`' 在我的 PHP 脚本和 phpMyAdmin 中不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:05:10.057

MySQL 通过用户名和主机来识别用户。当 MySQL 在登录时进行身份验证时，MySQL 首先查找一个完全匹配的主机名。如果它没有找到完全匹配，那么它会寻找一个包含“%”通配符的主机。

当您执行 时`GRANT ... TO myuser@localhost`，MySQL 创建了一个新用户（没有密码，因为语句中没有`IDENTIFIED BY`给出。

然后发生了什么，当您尝试`myuser`从 localhost 登录时，mysqld 尝试`'myuser'@'localhost'`在 mysql.user 表中查找匹配的条目并找到它。并且会话获得了分配给该用户的权限。

（更准确地说，mysqld 并没有真正查看 mysql.user 表的内容，它真正查看的是内存中的结构，该结构是在构建时从表中填充的。内存结构由 GRANT、REVOKE 或 FLUSH PRIVILEGES 语句触发。）

在添加新用户之前发生了什么，mysqld 正在寻找用户和主机名的完全匹配，但没有找到。但它确实找到了一个带有 '%' 通配符的条目，所以它与之匹配，因此会话获得了授予 'myuser'@'%' 用户的所有权限。

* * *

两个用户 `'u'@'%'`和`'u'@'localhost'`是分开的并且彼此不同。特权必须单独授予每个用户。授予的任何特权`'u'@'%'`仅适用于该用户而不适用于`'u'@'localhost'`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:26:39.523

[USAGE](http://dev.mysql.com/doc/refman/5.5/en/privileges-provided.html#priv_usage)的意思是“没有权限，这就是您在从 localhost 连接时为用户提供的权限。

我认为 localhost 优先于 % 所以当用户从 localhost 连接时，这就是将使用的授权。

将两种模式的访问权限授予 % （或 localhost，如果您愿意的话），它应该清楚并且工作得更好。

# javascript - jQuery Mobile 中的多页表单丢失单选值

> ID：13997276
> 
> 赞同：0
> 
> 时间：2012-12-21T21:15:17.213
> 
> 标签：javascript, jquery, forms, jquery-mobile

我有一个跨越 jQuery Mobile 中多个页面的表单。我正在使用多页页面，所有页面周围都有一组表单标签。在我将其分成多个页面之前，此表单运行良好。现在它发送文本框数据，但单选按钮的值为空白。有任何解决这个问题的方法吗。以下是带有收音机的 2 页示例。

谢谢！

```
<div id="1" data-role="page" data-theme="c">
<div data-role="header" data-theme="b" data-position="fixed">
<a data-theme="a" class="ui-btn-right" href="#start" data-role="button" data-icon="back" data-transition="pop" data-rel="dialog" data-inline="true">Start Over</a></div>
<div data-role="content">

<form encoding='multipart/form-data' encType='multipart/form-data'>

<div data-role="fieldcontain">
<fieldset data-role="controlgroup" data-type="horizontal">
<legend><a href="#16pop" data-rel="popup" data-inline="true">Azimuth Verification</a></legend>
<input id="_fid_16_a" type="radio" name="_fid_16" value="Yes"/>
<label for="_fid_16_a">Yes</label><input id="_fid_16_b" type="radio" name="_fid_16" value="No"/>
<label for="_fid_16_b">No</label><input id="_fid_16_c" type="radio" name="_fid_16" value="N/A"/>
<label for="_fid_16_c">N/A</label>
</fieldset>
</div>

</div></div>

<div id="sigemail" data-role="page" data-theme="c">
<div data-role="header" data-theme="b" data-position="fixed">
<a data-theme="a" class="ui-btn-right" href="#start" data-role="button" data-icon="back" data-transition="pop" data-rel="dialog" data-inline="true">Start Over</a></div>
<div data-role="content">

<div data-role="fieldcontain"><label for="_fid_210">What email address would you like to use?</label><input type="text"  name="_fid_210" id="_fid_210" /></div>

<input type="button" value="Submit" data-theme="b" id="sendbtn" onclick="$.mobile.loading( 'show', {text: 'Sending... Please Wait', textVisible: true, theme: 'b'});" />

</form>

<script>
$(document).ready( function(){
    getLocationConstant();
    $('#sendbtn').click(function(){
        $.post(
          'fill.php', 
          $('form').serialize(), 
          function() {
            $.post(
              'https://www.quickbase.com/db/dbName?act=API_AddRecord', 
              $('form').serialize()
            );
            $.mobile.changePage('#successpop', {transition: 'pop', role: 'dialog'});
          }
        ).error(function errHandler() {$.mobile.changePage('#failpop', {transition: 'pop', role: 'dialog'})});
    });
});
</script>

</div></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-24T05:47:20.997

实际上，跨多个页面的表单就像一个魅力。
我用普通和 jQuery 提交为你做了一个例子。

该示例共有三个页面：

*   [多页.html](http://jsfiddle.net/pmatseykanets/4CKkc/)
*   [多页结果.php](http://jsfiddle.net/pmatseykanets/YsRpe/)
*   存根.php

stub.php 的内容：

```
<?php
    if (isset($_REQUEST)) {
        print_r($_REQUEST);
    }
?> 
```

希望这会有所帮助。

# python - Libre/Open 和 writer2Latex，从 Python 调用

> ID：13997286
> 
> 赞同：0
> 
> 时间：2012-12-21T21:15:59.977
> 
> 标签：python, latex, openoffice.org, libreoffice

我遇到了 Open/Libre Office 的这个精彩扩展，writer2Latex，它可以将我的整个文档转换为 TeX 格式。它工作得很好，所以我想知道是否可以跳过 open/libre office 应用程序并直接从 Python 调用 writer2Latex？我希望我的 python 应用程序只使用 word 文档作为输入调用 writer2Latex，并获取生成的乳胶文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:43:53.373

这应该可以使用 Python + uno 来实现。该方法与导出为 PDF 非常相似，这比导出为 TeX/Latex 更常见。LibreOffice / OpenOffice 有一组可以更改的导出过滤器。

有关使用 Python + LibreOffice / OpenOffice 的一些一般文档，请参阅[DocumentHacker.com](http://www.documenthacker.com)，例如如何打开文档。您需要修改的食谱中的食谱是“转换为 PDF”。只需将输出过滤器替换为乳胶过滤器名称

```
#already have the document open
from com.sun.star.beans import PropertyValue
outputfiltername = "writer_pdf_Export" #for PDF
property = (
    PropertyValue( "FilterName" , 0, outputfiltername , 0 ),
)
document.storeToURL("file:///home/my_username/output.pdf", property) 
```

但是，我不确定 FilterName 应该是什么，也许您可​​以从 writer3Latex 文档中解决。我发现一个 PDF 表明它应该是：

```
outputfiltername = "org.openoffice.da.writer2latex" 
```

但我还没有测试过（搜索“FilterName”）。

# javascript - 如果不存在则添加选项以下拉值？

> ID：13997287
> 
> 赞同：2
> 
> 时间：2012-12-21T21:16:01.200
> 
> 标签：javascript

如何修改下面的代码以允许将新值添加到下拉列表中，如果在下拉框中找不到指定的值？

现在，我使用下面的给定函数在下拉框中查找给定值（option_name）。

我想修改否定标志 (!flag)，而不是提醒我它没有找到 option_name，而是基本上在现有下拉列表中添加新的 option_name。

IE。

```
get_position( 'drop', 'flower' ) 

<select id="drop" style="width: 200px;">
    <option value="0"></option>
    <option value="1">apples</option>
    <option value="2">oranges</option>
    <option value="3">pears</option>
    <option value="4">mangos</option>
    <option value="5">bananas</option>
    <option value="6">kiwis</option>
</select>

function get_position(id,option_name) {

    var flag = false;

    for ( var i=0; i <= document.getElementById(id).options.length - 1; i++ ) {

        if (document.getElementById(id).options[i].text === option_name)  {

            document.getElementById(id).selectedIndex = i; 
            flag = true;

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T21:37:15.960

如果找到任何匹配项，您可以使用 return false 然后添加记录

```
 function get_position(id,option_name) {

                var flag = false;
            var length=document.getElementById(id).options.length;
                for ( var i=0; i <= length - 1; i++ ) {

                    if (document.getElementById(id).options[i].text == option_name)  {

                        document.getElementById(id).selectedIndex = i; 
                       return false;
                    } 
           }
              //add item on drop down now 
                document.getElementById(id).options[length] = new Option( txt, length );
                document.getElementById(id).selectedIndex = length;

            } 
```

如果你可以使用 Jquery 那么像这样的东西

```
if($("#id option:contains('option_name')").length ==0)
{

$("#id").append(new Option("option text", "value"));

} 
```

# java - 自定义 Java 对象数组

> ID：13997292
> 
> 赞同：2
> 
> 时间：2012-12-21T21:16:26.083
> 
> 标签：java, arrays, object

我正在尝试创建一个 Person 数组（一个具有变量字符串名称和双倍总数的类）。但是由于某种原因，创建第二个 Person 会替换（？）第一个人。. .

```
Person[] p = new Person[40];

p[0] = new Person("Jango", 32);
p[1] = new Person("Grace", 455);

System.out.println( p[0].getName() );
System.out.println( p[1].getName() );
System.out.println( p[0].equals(p[1]) ); 
```

输出是：

```
Grace
Grace
false 
```

为什么不是：

```
Jango
Grace
false 
```

？？？？？？？？？

```
public class Person {

    @SuppressWarnings("unused")
    private Person next;
    private String name;
    private double total;

    public Person(String _name)
    {
        name = _name;
        total = 0.0;
        next = null;
    }

    public Person(String _name, double _total)
    {
        name = _name;
        total = _total;
        next = null;
    }

    public String getName()
    {
        return name;
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T21:22:11.870

您的问题是`name`实例变量被声明为静态，使其成为类变量。该类的每个实例都将更改名称的任何更改。您需要从中删除静态标识符 `name`，`total`您的代码将正常工作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:22:48.550

目前这些变量是`static`这意味着它们将保留最后分配的值。

```
private static String name;
private static double total; 
```

您需要将这些字段设为类*实例*变量：

```
private String name;
private double total; 
```

请参阅[了解实例和类成员](http://docs.oracle.com/javase/tutorial/java/javaOO/classvars.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T21:24:29.783

您的字段是静态的。如果您希望它们能够为类的每个实例存储名称和总数的单独实例，它们不应该是。

# sql - 需要有关 SQL 哲学的建议

> ID：13997293
> 
> 赞同：-2
> 
> 时间：2012-12-21T21:16:29.233
> 
> 标签：sql, database-design, data-modeling

在我询问有关编码的更多问题之前，我想首先找出我可以遵循的最佳方法来制作我的数据库。我遇到了一个问题，我应该如何构建它以保持一切最小化，并且由于它的性质，我有很多我必须代表的重复出现的数据。

我设计定制衬衫，并有各种不同类型的衬衫供人们选择，有成人和儿童两种尺寸可供选择。例如，我有适合男士、女士、男孩、女孩和幼儿的圆领衬衫、插肩袖、戒指袖和连帽衫。每件衬衫的价格相同，从幼儿尺码到成人尺码的 1 倍，然后 2 倍、3 倍、4 倍和 5 倍的价格各不相同。然后是每种衬衫的颜色选择各不相同，有些可能有 4 种颜色选择，有些有 32 种。

因此，让我们仅以圆领衬衫为例。Men s-1x, Women s-1x, Boys xs-1x, Girls xs-1x 和 toddlers NB-18months 共有 22 行，将在表格中表示并且价格相同。2X 及以上仅适用于男性和女性，因此增加了 8 行，仅圆领衬衫总共有 30 行。当它进入颜色选项时，有 32 种不同的颜色可供它们使用。如果我要为所有这些尺寸做每一个尺寸，那么仅针对圆领衬衫的总行数将是 960 行，其中主要是高度重复的数据，只需要一个小改动。

我想了想，认为最好把桌子上的这些物品当作储藏室里的实际物品，因为它们真的在储藏室里……你不会只有一盒可以打孔的衬衫侧面的按钮变成任何尺寸的颜色，你必须处理实际的衬衫和将它们放在某个地方的繁琐任务，所以我决定不要试图用一堆外键和索引来变得离谱，除了它只是很乏味，当您可以将其链接到的数据放在第一个表中时，您最终不得不表示同样多但有更多表的表。

如果我们只取其他 3 种衬衫，并仅针对这 4 种衬衫对所有颜色和尺码应用相同的逻辑，那么将有 3,840 行，剩下的其他衬衫我不算在内，你可以说我是在一张表中查看大约 10,000 行数据。这些数据将随着时间的推移而增长，我想知道它可能会变成什么来保持一切井井有条。所以我认为最好的逻辑可能是像在实际零售店中那样将其分解，将部门分为男性、女性、男孩、女孩和婴儿。这样我就有了 5 个单独的表，只有在用户决定“去那个部门”时才会调用它们，所以如果有人想要男士衬衫，他没有 7,000 多行的额外数据，甚至没有适用于他'

这会是更好的设置方法吗？还是将其全部保留为一张巨大的桌子，然后从男性部分的表中查询 php 中的“男士”衬衫，女性和儿童也一样？

我的下一个问题是所有可能可用的颜色选项，正如我之前所说的，有些衬衫只有 4 种，有些则多达 32 种，所以其中一些数据足以单独形成一个表格，所以我真的可以为每种衬衫单独准备一张桌子。我将在 php 中使用查询来填充表格中的项目，因此我不必在 html 和 javascript 中编写太多代码。这样我就可以将它设置为`SELECT ALL * table WHERE type=men`它会占用所有男士衬衫并自动填充每件衬衫的编码。这样，当我在表格中添加和取走东西时，它会自动更新。我已经对我将如何做到这一点有了一个想法，但我只能想到这么远，因为我还没有决定一个好的方法来设置表格，这是我必须将它构建成的来电。

例如，如果我将每件衬衫的所有颜色选项都放在同一张表上，而不是将其分解并链接到其他表来表示它们的外键。那将是两种完全不同的调用方式，所以我被困在这个问题上，真的不知道该去哪里。有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:35:31.757

通常零售组织是按 SKU（库存单位）。部门和颜色是服装的属性，而不是您出于会计或库存目的识别服装的方式。

```
CREATE TABLE Skus (
  sku BIGINT UNSIGNED PRIMARY KEY,
  description TEXT,
  department VARCHAR(10) NOT NULL,
  color VARCHAR(10) NOT NULL,
  qty_in_stock INT UNSIGNED NOT NULL DEFAULT 0,
  unit_price NUMERIC(9,2) NOT NULL,
  FOREIGN KEY (department) REFERENCES Departments(department),
  FOREIGN KEY (color) REFERENCES Colors(color)
); 
```

这比分成五个表要好，因为：

*   您可以快速获得所有股票总价值的总和。
*   您可以轻松切换给定 SKU 的部门。
*   当某人购买几件衣服时，他们的订单项目引用一个表而不是五个不同的表（这对于关系数据库是无效的）。

*如果类似的实体存储在一个表中*，还有许多其他任务示例会更容易。

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T21:36:02.997

我知道您不想将其分成单独的表格，但我认为采用多表格路线是最好的。不过，我觉得没有你想的那么糟糕。我的建议如下。显然，您想更改字段的名称，但这是一种快速表示：

**衬衫**

```
 - id (primary key)
  - description
  - men (Y/N)
  - women (Y/N)
  - boy (Y/N)
  - girl (Y/N)
  - toddlers (Y/N) 
```

**尺寸**

```
 - id (primary key)
  - shirt_id (foreign key)
  - Size 
```

**颜色**

```
 - id (primary key)
  - shirt_id (foreign key)
  - Color 
```

**价格**

```
 - id (primary key)
  - shirt_id (foreign key)
  - size_id (foreign key)
  - price 
```

有了这三个表，您就不必将所有 10,000 行存储在一个表中并进行维护，但数据仍然存在。将数据分开放置在适当的位置可以避免复制不必要的信息。

想拉所有男士衬衫？

`SELECT * FROM shirts WHERE men = '1'`

老实说，你真的应该至少有 5 或 6 张桌子。一/二包含尺寸和颜色的标签（一张表包含所有标签，或者每个表一张），另外 4 个包含实际数据。这将使您的数据在所有内容中保持统一（例如：`Blue`vs `blue`）。你知道他们说什么，给猫剥皮的方法不止一种。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T21:38:18.680

您需要考虑一个称为“规范化”的数据库术语。规范化意味着一切都在数据库中，不应该列出两次，而是根据需要重用。人们最常犯的错误是不问或不考虑未来会发生什么，他们建立了一个几乎没有规范化、对大型数据类型消耗大量内存、没有做种子、完全不灵活和以后改变要付出很大的代价，因为它是在没有考虑未来的情况下做出的。

标准化有很多级别，但最一致的事情是考虑一个简单的例子，我可以给你解释一些可以在以后应用于更大的事情的简单概念。这是假设您可以访问 SQL 管理工作室、SSMS，但是如果您使用的是 MYSQL 或 Oracle，原理仍然非常相似，评论部分将显示我的意思。如果您有 SSMS，则可以自行运行此示例，只需将其粘贴并按 F5。如果您不只是查看评论部分，尽管这些概念在实践中比试图想象它们的含义更好。

```
Declare @Everything table (PersonID int, OrderID int, PersonName varchar(8), OrderName varchar(8) );

insert into @Everything values (1, 1, 'Brett', 'Hat'),(1, 2, 'Brett', 'Shirt'),(1, 3, 'Brett', 'Shoes'),(2,1,'John','Shirt'),(2,2,'John','Shoes');

-- very basic normalization level in that I did not even ATTEMPT to seperate entities into different tables for reuse.
-- I just insert EVERYTHING as I get in one place.  This is great for just getting off the ground or testing things.
-- but in the future you won't be able to change this easily as everything is here and if there is a lot of data it is hard 
-- to move it.  When you insert if you keep adding more and more and more columns it will get slower as it requires memory 
-- for the rows and the columns
Select Top 10 * from @Everything

declare @Person table ( PersonID int identity, PersonName varchar(8));

insert into @Person values ('Brett'),('John');

declare @Orders table ( OrderID int identity, PersonID int, OrderName varchar(8));

insert into @Orders values (1, 'Hat'),(1,'Shirt'),(1, 'Shoes'),(2,'Shirt'),(2, 'Shoes');

-- I now have tables storing two logic things in two logical places.  If I want to relate them I can use the TSQL language
-- to do so.  I am now using less memory for storage of the individual tables and if one or another becomes too large I can 
-- deal with them isolated.  I also have a seeding record (an ever increasing number) that I could use as a primary key to 
-- relate row position and for faster indexing
Select *
from @Person p 
    join @Orders o on p.PersonID = o.PersonID

declare @TypeOfOrder table ( OrderTypeID int identity, OrderType varchar(8));

insert into @TypeOfOrder values ('Hat'),('Shirt'),('Shoes')

declare @OrderBridge table ( OrderID int identity, PersonID int, OrderType int)

insert into @OrderBridge values (1, 1),(1,2),(1,3),(2,2),(2,3);

-- Wow I have a lot more columns but my ability to expand is now pretty flexible I could add even MORE products to the bridge table
-- or other tables I have not even thought of yet.  Now that I have a bridge table I have to list a product type ONLY once ever and 
-- then when someone orders it again I just label the bridge to relate a person to an order, hence the name bridge as it on it's own
-- serves nothing but relating two different things to each other.  This method takes more time to set up but in the end you need 
-- less rows of your database overall as you are REUSING data efficiently and effectively.
Select Top 10 *
from @Person p 
    join @OrderBridge o on p.PersonID = o.PersonID
    join @TypeOfOrder t on o.OrderType = t.OrderTypeID 
```*

# java - Java 2D 中的可拖动矩形

> ID：13997296
> 
> 赞同：0
> 
> 时间：2012-12-21T21:16:48.617
> 
> 标签：java, swing, uml, java-2d

> **可能重复：**
> [如何拖动对象](https://stackoverflow.com/questions/13220971/how-to-drag-object)

我需要使用 Java 2D 绘制一些 UML 组件（类、包等），然后能够拖动它们。有没有办法做到这一点？我的意思是，使形状“可拖动”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:14:13.130

[`JHotDraw`](http://www.jhotdraw.org/)被设计为“用于技术和结构化图形的 Java GUI 框架”。链接的[*JHotDraw 模式语言：JHotDraw 域概述*](http://softarch.cis.strath.ac.uk/PLJHD/Patterns/JHDDomainOverview.html)说明了如何自定义绘图编辑器。该示例`org.jhotdraw.samples.draw.Main`是一个合理的起点，并且`JModeller`是一个使用该框架构建的简单 UML 编辑器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:44:37.467

你是被迫摇摆的吗？

如果没有，您可能已经看过[draw2d](http://www.eclipse.org/gef/draw2d/index.php)，它是一个在[SWT](http://www.eclipse.org/swt/)画布上工作的 java 库。[您可以在此处](http://nyssen.blogspot.de/2010/12/draw2d-examples-hidden-treasure.html)找到 draw2d 的一些示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:11:03.287

您只能将 MouseListener 添加到 (J) 组件。所有 Java2D 的东西都绘制在组件上。如果您管理列表中的所有形状，您可以在鼠标光标下搜索正确的形状，移动它并重新绘制组件。

# r - 循环遍历R中的变量名

> ID：13997298
> 
> 赞同：6
> 
> 时间：2012-12-21T21:16:49.960
> 
> 标签：r, stata

我有一个循环问题。解决起来应该很简单，但是“Stata 用户的 R”（我在 Stata 中编码已经有几年了）、Roger Peng 的视频和 Google 似乎并没有帮助我。你们中的一个可以向我解释我做错了什么吗？

我正在尝试编写一个遍历“阈值”数据框的循环，以从三组列中提取信息。我可以通过将同一段代码写三遍来做我想做的事情，但是随着代码变得越来越复杂，这将变得相当繁琐。

这是一个“阈值”示例（请参阅`dput`下面的输出，由友好的读者添加）：

```
 threshold_1_name      threshold_1_dir threshold_1_value
1   overweight            >                25
2   possible malnutrition <                31
3   Q1                    >                998
4   Q1                    >                998
5   Q1                    >                998
6   Q1                    >                998
    threshold_1_units threshold_2_name threshold_2_dir threshold_2_value threshold_2_units
1   kg/m^2            obese               >             30                kg/m^2
2   cm                <NA>                >             NA                   
3   <NA>              Q3                  >             998                  
4                     Q3                  >             998                  
5                     Q3                  >             998                  
6                     Q3                  >             998 
```

这段代码做了我想做的事：

```
newvars1 <- paste(thresholds$varname, thresholds$threshold_1_name, sep = "_")
noval <- is.na(thresholds$threshold_1_value)
newvars1 <- newvars1[!noval]

newvars2 <- paste(thresholds$varname, thresholds$threshold_2_name, sep = "_")
noval <- is.na(thresholds$threshold_2_value)
newvars2 <- newvars2[!noval]

newvars3 <- paste(thresholds$varname, thresholds$threshold_3_name, sep = "_")
noval <- is.na(thresholds$threshold_3_value)
newvars3 <- newvars3[!noval] 
```

这是我尝试循环的方式：

```
variables <- NULL
for (i in 1:3) {
  valuevar <- paste("threshold", i, "value", sep = "_")
  namevar <- paste("threshold", i, "name", sep = "_")
  newvar <- paste("varnames", i, sep = "")
  for (j in 1:length(thresholds$varname)) { 
    check <- is.na(thresholds[valuevar[j]])
    if (check == FALSE) {
      newvars <- paste(thresholds$varname, thresholds[namevar], sep = "_")
    }
  }
  variables <- c(variables, newvars)
} 
```

这是我收到的错误：

```
Error: unexpected '}' in "}" 
```

我认为我称“我”的方式有些搞砸了，但我不确定如何正确地做到这一点。当我切换到 R 时，我使用本地人的 Stata 习惯真的让我很痛苦。

编辑以添加`dput`输出，由友好的读者：

```
thresholds <- structure(list(varname = structure(1:6, .Label = c("varA", "varB", 
"varC", "varD", "varE", "varF"), class = "factor"), threshold_1_name = c("overweight", 
"possible malnutrition", "Q1", "Q1", "Q1", "Q1"), threshold_1_dir = c(">", 
"<", ">", ">", ">", ">"), threshold_1_value = c(25L, 31L, 998L, 
998L, 998L, 998L), threshold_1_units = c("kg/m^2", "cm", NA, 
NA, NA, NA), threshold_2_name = c("obese", "<NA>", "Q3", "Q3", 
"Q3", "Q3"), threshold_2_dir = c(">", ">", ">", ">", ">", ">"
), threshold_2_value = c(30L, NA, 998L, 998L, 998L, 998L), threshold_2_units = c("kg/m^2", 
"cm", NA, NA, NA, NA)), .Names = c("varname", "threshold_1_name", 
"threshold_1_dir", "threshold_1_value", "threshold_1_units", 
"threshold_2_name", "threshold_2_dir", "threshold_2_value", "threshold_2_units"
), row.names = c(NA, -6L), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T21:33:09.523

我看到的第一个问题是，如果您正在测试它需要的条件，`if(check = "FALSE")`那是一个任务。此外，引用该单词意味着您正在测试字符串值的变量（字面意思是单词 FALSE），而不是没有引号的逻辑值。`=``==``"FALSE"``FALSE`

@BlueMagister 正确指出了第二个问题，您`)`在结尾处丢失了`for (j in 1:length(...)) {`

### 见#不好！

```
 for (j in 1:length(thresholds$varname)) { 
    check <- is.na(thresholds[valuevar[j]])
    if (check = "FALSE") { # bad!
      newvars <- paste(thresholds$varname, thresholds[namevar], sep = "_")
    }
  } 
```

### 见#好！

```
 for (j in 1:length(thresholds$varname)) { 
    check <- is.na(thresholds[valuevar[j]])
    if (check == FALSE) { # good!
      newvars <- paste(thresholds$varname, thresholds[namevar], sep = "_")
    }
  } 
```

但是因为它是一个 if 语句，所以您可以使用非常简单的逻辑，尤其是在逻辑上（TRUE / FALSE 值）。

### 看#更好！

```
 for (j in 1:length(thresholds$varname)) { 
    check <- is.na(thresholds[valuevar[j]])
    if (!check) { # better!
      newvars <- paste(thresholds$varname, thresholds[namevar], sep = "_")
    }
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:24:17.360

你的 for 循环中显然缺少一个括号。您应该考虑使用支持大括号匹配的编辑器来避免此类错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:36:45.147

我认为最简单的事情就是编写一个函数来完成您想要的非循环代码所做的事情。作为参考，这里是该代码的`dput`输出，使用对您的问题进行编辑的输出。

```
> newvars1 <- paste(thresholds$varname, thresholds$threshold_1_name, sep = "_")
> newvars1 <- newvars1[!is.na(thresholds$threshold_1_value)]
> newvars2 <- paste(thresholds$varname, thresholds$threshold_2_name, sep = "_") 
> newvars2 <- newvars2[!is.na(thresholds$threshold_2_value)]
> c(newvars1, newvars2)
 [1] "varA_overweight"            "varB_possible malnutrition"
 [3] "varC_Q1"                    "varD_Q1"                   
 [5] "varE_Q1"                    "varF_Q1"                   
 [7] "varA_obese"                 "varC_Q3"                   
 [9] "varD_Q3"                    "varE_Q3"                   
[11] "varF_Q3" 
```

这是该函数的外观：

```
unlist(lapply(1:2, function(k) {
  newvars <- paste(thresholds$varname, 
                   thresholds[[paste("threshold", k, "name", sep="_")]], sep = "_")
  newvars <- newvars[!is.na(thresholds[[paste("threshold", k, "value", sep="_")]])]
}))
# [1] "varA_overweight"            "varB_possible malnutrition"
# [3] "varC_Q1"                    "varD_Q1"                   
# [5] "varE_Q1"                    "varF_Q1"                   
# [7] "varA_obese"                 "varC_Q3"                   
# [9] "varD_Q3"                    "varE_Q3"                   
#[11] "varF_Q3" 
```

我试图弄清楚你的循环中发生了什么，但那里有很多对我来说没有意义的东西；如果我要以这种方式循环，这就是我的写法。

```
variables <- NULL
for (i in 1:2) {
  valuevar <- paste("threshold", i, "value", sep = "_")
  namevar <- paste("threshold", i, "name", sep = "_")
  newvars <- c()
  for (j in 1:nrow(thresholds)) { 
    if (!is.na(thresholds[[valuevar]][j])) {
      newvars <- c(newvars, paste(thresholds$varname[j], 
                                  thresholds[[namevar]][j], sep = "_"))
    }
  }
  variables <- c(variables, newvars)
}
variables 
```

# jquery - Jquery 事件仅在文档就绪时工作

> ID：13997299
> 
> 赞同：2
> 
> 时间：2012-12-21T21:16:50.037
> 
> 标签：jquery, events, document, ready

我用 .net MVC 3 开始了一个小网络项目。我的问题：我包含了 Jquery 1.8.3.js。但是我的函数在 javascript 文件中不起作用：

这不起作用：

```
$(document).ready(function() {
    $('input:button').button();
});

$('#testbut').on('click', function (event, ui) {

    alert("CLICK");

}); 
```

这仍然工作正常：

```
$(document).ready(function() {
    $('input:button').button();

    $('#testbut').on('click', function (event, ui) {

    alert("CLICK");

    });
}); 
```

我不知道为什么。

包含的顺序正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T21:18:16.310

第一个示例失败，因为代码在页面加载时正在执行，并且它引用的元素尚未加载。这也是第二个示例起作用的原因。

通过将您的代码放置在文档就绪块中，它会延迟执行它，直到页面加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:21:00.090

当您将代码块放入时`$(document).ready()`，它会在文档加载后等待将侦听器附加到目标。因此，在您的第一个示例中，jquery 附加了侦听`$('#testbut').on('click', function (event, ui) {`器，但 DOM 尚未加载元素。在第二个示例中，它仅在加载文档后附加侦听器。

# git - 如何恢复 GIT 中的最后一次合并

> ID：13997305
> 
> 赞同：1
> 
> 时间：2012-12-21T21:17:41.753
> 
> 标签：git, github, git-gui

我将我的更改提交给本地 master，我将我的更改与另一个也在 master 上工作的开发人员的作品合并，她在我提交之前几乎没有提交。最后，我将我的工作与她的工作合并，现在碰巧我的提交覆盖了她在存储库中的更改。无论如何我可以恢复合并吗？

```
o - bad merge here that I want to get rid off
|\
| o her commit 1 yesterday
| o her commit 2 yesterday
| o her commit 3 yesterday
o | my commit today
\ |
 o 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:22:47.693

您可以将您的主分支向后移一步`git reset <SHA>`（请参阅[手册页](http://git-scm.com/docs/git-reset)），其中 <SHA> 标识当前提交之前的提交（您标记为“我今天的提交”的提交）。之后，您可以查看[git merge 手册页](http://git-scm.com/docs/git-merge)以获取有关如何防止更改覆盖的更多信息。

# html - 内容溢出 div

> ID：13997310
> 
> 赞同：0
> 
> 时间：2012-12-21T21:18:12.437
> 
> 标签：html, css

解决了：

我有[一个适用于 jsFiddle 的演示，但同样的一个在](http://jsfiddle.net/HQgw9/)[其他站点](http://www.edreisstrading.com/)上不起作用。您将看到`.right_side_header class`溢出到下一行，位于`main_container-->header--->class`. 为什么会这样？它是 763px，我已经仔细检查了每个框的像素，但它溢出了。有人可以告诉我为什么吗？如果您检查元素，并取消选中 763px 的宽度，它不会溢出。

这是一些`header`css的代码：

```
.header {
   display: block;
   padding-top: 33px;
   padding-left: 30px;
   padding-right: 30px;
   margin-left:auto;
   margin-right:auto;
   width: 900px;
}

.right_side_header {
   display: inline-block;
   vertical-align: top;
   padding-top: 35px;
   width: 763px;
}

img.globe {
   display: inline;
}

#globe-logo {
   display: inline;
   position: relative;
   z-index: 9000;
}

span.letter_logo {
   font-family: HelveticaBlack;
   font-size: 41px;
   height: 41px;
   line-height: 1;
   margin-left: auto;
   margin-right: auto;
   text-align: center;
   text-shadow: 1px 1px 0px rgba(245, 245, 245, 0.35), -1px -1px 0px rgba(245, 245, 245, 0.35);
}

div.letter_logo_container {
   text-align: center;
   display: block;
   line-height: 1;
   width: 621px;
} 
```

这是`nav_bar`css的代码：

```
div.nav_phone {
   height: 18px;
   padding-top: 3px;
   width: 621px;
   display: inline-block;
}

span.sales_ph_num {
   font-family: HelveticaItalic;
   font-size: 11.5px;
   color: #c10d24;
   text-shadow: 1px 1px 0px rgba(245, 235, 236, 0.4), -1px -1px 0px rgba(245, 235, 236, 0.4);
}

div.sales_ph_num {
   text-align: center;
   display: inline-block;
   vertical-align: top;
   width: 110px;
}

.nav_bar {
   background-image: url("132/nav_bar.png");
   background-repeat: no-repeat;
   height: 18px;
   width: 621px;
   position: relative;
}

div#links {
   line-height: 1;
   position: absolute;
   top: 50%;
   left: 119px;
   margin: -6px auto 0 auto;
   font: 12px HelveticaMedium;
   text-align: center;
   text-shadow: 1px 1px 0px rgba(237, 237, 237, 0.5), -1px -1px 0px rgba(237, 237, 237, 0.5);
}

#Products {
   margin-left: 36px;
}

#Terms, #Terms_Nav {
   margin-left: 36px;
}

a.Terms, a.Terms:visited, #Home a, #Home a:visited, a#About, a#About:visited,
#About a, #About a:visited {
   text-decoration: none;
   color: #000000;
   cursor:pointer;
}

li#line_break {
   margin-top: 12px;
}

#About {
   text-decoration: none;
   color: #000000;
   margin-left: 36px;
   margin-right: 35px;
} 
```

这是`main_body`CSS：

```
html, body {
   width: 100%;
   height: 100%;
   background-color: #fafafa;
   -webkit-overflow-scrolling: touch;
   position: relative;
   overflow-x: hidden;
}

.main_container {
   max-width: 960px;
   margin-left: auto;
   margin-right: auto;
   background-color: #ffffff;
   -webkit-border-radius: 8px 8px 8px 8px;
   -moz-border-radius: 8px 8px 8px 8px;
   -o-border-radius: 8px 8px 8px 8px;
   border-radius: 8px 8px 8px 8px;
   position: absolute;
   left: -9999em;
} 
```

并且有一个可以重置的css：

```
* {
   margin: 0;
   padding: 0;
} 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:23:02.047

`top: -61px;`从中删除`div.ad_banner`。

另外，如果您有一个加载屏幕，我建议您使用一些简单的动画，这样它看起来就不会像页面已经死了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:23:57.970

您已将`right_side_header`班级限制为 763 像素，您的`sales_ph_num`班级也限制为 110 像素。

但是在 jsfiddle 你已经分别设置了 900px 和 137px 。

只需像在 jsfiddle 上一样设置相同的值。=))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T19:00:01.700

解决方案：

好的，这个问题困扰了我一段时间，我不明白为什么会这样。我注意到 sales_ph_num div 和 nav_bar div 之间有一些额外的 1 或 2 像素的空白，不应该有。然后我看到我正在使用 inline-block，在 SO 上搜索 inline-block 和未计入的空白，然后就可以了。我使用了带有 2 或 3 个 div 的内联块，它添加了额外的空白，这使得内容溢出，因为每个框都有一个宽度。

如果您有两个并排的 div，一个 div 作为内联，另一个作为内联块，并且您将 html 中的 div 标签放在单独的行上，则会添加空格：

```
<div class="container_1000px">
    <div class="container">
        My content.
    </div>
    <div class="next_container">
        Next content.
    </div>
</div>

.container_1000px
{
    width: 1000px;
}
.container
{ 
    display: inline;
    width:960px;
}
.next_container
{
    display: inline-block
    width: 40px;
} 
```

这将溢出，因为在内联和内联阻止的 div 之间添加了额外的空格。

解决方案是将每个 div 放在一行上。

```
<div class="container_1000px"><div class="container">My content.</div><div class="next_container">Next content.</div></div> 
```

并且不会添加额外的空格。再次感谢。

谁能向我解释为什么会发生这种情况以及为什么应该/不应该？

# java - JAVA 应用程序必须在 JSP 上运行吗？

> ID：13997311
> 
> 赞同：1
> 
> 时间：2012-12-21T21:18:16.043
> 
> 标签：java, jsp

JAVA 应用程序必须在 JSP 上运行吗？是否有其他方式可以在客户端解释应用程序？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:19:29.533

客户端（假设您指的是 Firefox、IE 等浏览器）只能理解 HTML 和 Javascript。您的 JSP 代码将在服务器上执行，相应的 HTML 代码将发送到浏览器。

有很多替代品，如 JSF、HTML 等。我建议阅读本[教程](http://docs.oracle.com/javaee/5/tutorial/doc/bnadp.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T21:21:21.777

JSP 是一种在服务器端运行并产生响应的技术，该响应通常会在 Web 浏览器中查看。还有许多其他方法可以做到这一点，包括 Java servlet、JSF 等。

Java 可以作为应用程序（即用户下载文件并在本地运行）或作为小程序（在 Web 浏览器中运行）在客户端运行。

# vb.net - VB.net 检查程序是否正在启动？

> ID：13997313
> 
> 赞同：0
> 
> 时间：2012-12-21T21:18:28.647
> 
> 标签：vb.net

所以我有这个代码

```
 My.Computer.Registry.CurrentUser.OpenSubKey("SOFTWARE\Microsoft\Windows\CurrentVersion\Run", True).DeleteValue("WooW") 
```

但是在我执行该代码之前，我想看看该程序/密钥是否正在启动中，有人可以帮我吗？请

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T06:32:23.157

```
Using subKey As RegistryKey = Registry.CurrentUser.OpenSubKey("SOFTWARE\Microsoft\Windows\CurrentVersion\Run", True)
    If subKey.GetValue("WooW") <> Nothing Then
        subKey.DeleteValue("Woow")
    End If
End Using 
```

如果值不存在，*GetValue()*函数将产生**Null** ，使用Visual Basic中的**Nothing**表示。如果需要，您可以将第二个参数传递给*DeleteValue()*，如果该值不存在，它将导致函数抛出`subKey.DeleteValue("Woow", True)`

# android - Android surfaceview/canvas 在线程中睡眠后闪烁

> ID：13997314
> 
> 赞同：0
> 
> 时间：2012-12-21T21:18:31.147
> 
> 标签：android, surfaceview

这是我在此的头一篇博文。抱歉，如果做得不好，请提前致谢。

有件事让我发疯。

我试着画一些东西并在屏幕上慢慢展示。为此，我使用 Thread.sleep，如代码所示。但它在每次迭代中显示了两个不同版本的画布。

谁能解释什么是错的？

我只想画点东西，几秒钟后画点别的东西。等等。

这是我的代码：

```
public class Vista extends SurfaceView implements Callback {
private Hilo hilo;
private SurfaceHolder sf;

class Hilo extends Thread {
    public boolean running;
    private Vista view;
    Canvas c = null;
    Bitmap btm = null;

    public Hilo(SurfaceHolder holder, Vista view) {
        sf = holder;
        btm = Bitmap.createBitmap(480, 800, Config.ARGB_8888);
        c = new Canvas(btm);
    }

    @Override
    public void run() {
        Paint paint = new Paint();
        paint.setStyle(Style.FILL_AND_STROKE);
        paint.setColor(Color.BLUE);

        int k = 0;
        while (running) {
            c = sf.lockCanvas();
            k+= 10;
            c.drawText(String.valueOf(k/10), k, 20, paint);
            sf.unlockCanvasAndPost(c);

          try {
              sleep(1000);
          } catch (InterruptedException e) {
              // TODO Auto-generated catch block
              e.printStackTrace();
          }
        }
    }
}

public Vista(Context context) {
    super(context);
    SurfaceHolder holder = getHolder();
    holder.addCallback(this);
    hilo = new Hilo(holder, this);
}

@Override
public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
    // TODO Auto-generated method stub
}

@Override
public void surfaceCreated(SurfaceHolder holder) {
    hilo.running = true;
    hilo.start();
}

@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    boolean retry = true;
    hilo.running = false;
    while (retry) {
        try {
            hilo.join();
            retry = false;
        } catch (InterruptedException e) {
        }
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:03:32.680

您的代码是`sleep()`主线程，也称为 UI 线程。这是你绝对不能做的事情，因为主线程负责处理 Android 中的所有“东西”：UI 渲染、UI 事件调度等。您可以阅读 Android 开发者网站上的[进程和线程](http://developer.android.com/guide/components/processes-and-threads.html)指南以获取更多信息。选择报价：

> 因此，Android 的单线程模型只有两条规则：
> 
> 1.  不要阻塞 UI 线程
>     
>     
> 2.  不要从 UI 线程外部访问 Android UI 工具包

那么问题就变成了，如何*在不*休眠主线程的情况下为视图设置动画？诀窍是告诉 Android 去做其他事情，过一会儿再回到你身边（重绘你）。每次绘制时，您都会计算推进动画的程度。

一种（粗略的）方法是使用[`postInvalidateDelayed(long)`](http://developer.android.com/reference/android/view/View.html#postInvalidateDelayed%28long%29)，它正是这样做的：在给定的毫秒数后重绘您的视图。这不是一个精确的延迟，它会有点波动，所以你不能假设这正是经过了多少时间。一种方法是将 存储`System.nanoTime()`在实例字段中，以便下次绘制时，您可以将差异用于`nanoTime()`. 这种差异是经过了多少时间，因此告诉您应该更新多少动画状态。如果您的动画应该总共持续 1 秒，并且自上次绘制场景以来已经过去了 100 毫秒，那么您必须将所有内容提前 10%。

Android 提供[了许多实用程序](http://developer.android.com/guide/topics/graphics/overview.html)来简化此操作。

# twitter - 从 Twitter API 仅获取用户时间轴的选定字段

> ID：13997315
> 
> 赞同：3
> 
> 时间：2012-12-21T21:18:34.470
> 
> 标签：twitter

我从 iOS 应用程序中获取用户的时间线，从 API 中提取了大量推文。但是，我正在使用`statuses/user_timeline`端点获取数据，因为我在移动设备上并且只需要推文文本，因此我只想过滤推文的实际文本数据。我已经设置`include_entities`了 to`no`和`trim_user`to `true`，但是即使删除了实体和用户数据，我仍然会得到很多我不需要的数据。这是我从端点获得的示例推文：

```
{
"created_at": "Tue Nov 27 14:13:13 +0000 2012",
"id": 273429272209801200,
"id_str": "273429272209801217",
"text": "you could list #5ThingsIFindAttractive but you can actually find them on Facebook with Social Match on iPhone! http://t.co/zRr1ggbz",
"source": "web",
"truncated": false,
"in_reply_to_status_id": null,
"in_reply_to_status_id_str": null,
"in_reply_to_user_id": null,
"in_reply_to_user_id_str": null,
"in_reply_to_screen_name": null,
"user": {
  "id": 62828168,
  "id_str": "62828168"
},
"geo": null,
"coordinates": null,
"place": {
  "id": "682c5a667856ef42",
  "url": "http://api.twitter.com/1/geo/id/682c5a667856ef42.json",
  "place_type": "country",
  "name": "Turkey",
  "full_name": "Turkey",
  "country_code": "TR",
  "country": "Turkey",
  "bounding_box": {
    "type": "Polygon",
    "coordinates": [
      [
        [
          25.663883,
          35.817497
        ],
        [
          44.822762,
          35.817497
        ],
        [
          44.822762,
          42.109993
        ],
        [
          25.663883,
          42.109993
        ]
      ]
    ]
  },
  "attributes": {}
},
"contributors": null,
"retweet_count": 0,
"favorited": false,
"retweeted": false,
"possibly_sensitive": false 
```

}

我真正需要的是`text`字典的键。其余的目前对我的应用程序没用。我会请求很多这样的推文。如何发送请求以`text`获取推文的密钥？目前，这种方法效率极低*。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T20:58:22.497

你不能。您可以做的最好的事情是设置一个代理，它将请求数据，将其剥离，然后将其转发到移动设备。

如果有什么安慰的话，JSON 将被 gzip 压缩，因此应该仍然相对较小 - 因此不会花费太长时间来传输或占用用户的数据限额。

# ruby-on-rails - Rails 3 中的路由错误

> ID：13997316
> 
> 赞同：0
> 
> 时间：2012-12-21T21:18:36.590
> 
> 标签：ruby-on-rails, routes, nested-routes

我的视图（index.html.erb）代码中有以下内容：

```
<% @projects.each do |project| %>
   <%= link_to (@project) do %>
      <div id="tombstone">
         ...Some HTML here...
      </div>
   <% end %>
<% end %> 
```

目标是让每个项目的概要显示在墓碑 DIV 中，并使整个 DIV 充当项目详细信息页面 (show.html.erb) 的链接。

我的控制器具有以下内容：

```
def show
   @project = Project.find(params[:id])
end 
```

并且路线具有以下内容：

```
resources :projects do
   ...
   resources :updates
end 
```

`@project`指向项目 (index.html.erb) 页面，而`<%= link_to %>`不是控制器定义的项目详细信息页面 (show.html.erb)。我只能猜测 ID 参数没有被传递，但我不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:21:47.443

```
<%= link_to(project) do %> # not @project 
```

从技术上讲，您已被发送到索引，因为@project 可能是新记录。@project == Project.new，因此带有 GET 请求的 link_to(Project.new) 会呈现索引操作的路径。

# c# - C# 精简列表<>

> ID：13997318
> 
> 赞同：0
> 
> 时间：2012-12-21T21:18:42.550
> 
> 标签：c#, list

我有一个清单，可以说 3600 项。我想使用例如因子 5 来精简该列表。因此（新）列表中将保留 720 个项目。但不改变列表的“路线”。起点和终点应始终保持不变。

喜欢：**1** ->*跳过 30* -> **31**

怎么做？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-21T21:20:47.983

应该是这样的：

```
var last = list.Count - 1;
var thin = list.Where ((item, i) => i % 30 == 0 || i == last); 
```

如果我正确理解你的观点。

请注意`thin`will be`IEnumerable<int>`和 not `List<int>`。
*通常*这就足够了——您可以在`foreach`循环中枚举它并使用其他 LINQ 方法。
但它会被懒惰地评估，也就是说，如果你原来的`list`改变，`thin`也会改变。

如果你想得到一个`List<int>`，只需附加一个`ToList ()`调用：

```
var last = list.Count - 1;
var thin = list.Where ((item, i) => i % 30 == 0 || i == last)
               .ToList (); 
```

同样，要获取数组，请使用`ToArray ()`.

不要忘记添加`using System.Linq;`此功能。
另请参阅[101 LINQ 示例](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)，了解更高级的过滤、聚合和分组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:31:09.410

尝试这个：

```
 var thin = list.Where(a => a % 2 == 0).Union(new List<int> { list.Min(), list.Max() }).OrderBy(a => a); 
```

这应该得到第一个和最后一个值，加上中间的一些。

# optimization - 与 WEKA 一起旅行的推销员

> ID：13997325
> 
> 赞同：2
> 
> 时间：2012-12-21T21:19:17.620
> 
> 标签：optimization, weka, traveling-salesman

虽然我对 Python 中的优化问题（以及“R”）感到满意，但我很想知道它是否可以在 WEKA 中完成。

我有几条路线的 X、Y 坐标，我需要优化最佳整体解决方案。

任何帮助，将不胜感激...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T01:41:19.573

Weka 是一个机器学习，而不是优化包。虽然您可以尝试使用 Weka 中的机器学习算法来预测最佳解决方案，但没有什么可以检查预测是否是最佳解决方案，甚至根本就不是解决方案。

在我看来，您绝对是在尝试使用错误的工具来完成这项工作。

# php - 使用 Ajax 的 Json 编码 JavaScript 引发错误消息

> ID：13997331
> 
> 赞同：0
> 
> 时间：2012-12-21T21:20:08.110
> 
> 标签：php, javascript, ajax, json

我有一个 html 文档，其中包含：

```
 <li id="li_273" data-pricefield="special" data-pricevalue="0" >
        <label class="description" for="element_273">Helium Foil Balloon #1 </label>
            <div>
                <input type="text" class="element text medium" id="element_273" name="element_273" size="30" value="" />
                <input type="hidden" id="element_273_price" name="element_273_price" value="">

            </div> 
       </li> 
```

那么，该区域是一个 ajax 下拉菜单。从那个 ajax/php 下拉列表中，我可以执行一个 onclick 命令——这就是我所拥有的：

```
'onclick' => 'document.getElementById(\'li_273\').data(\'pricevalue\',\'1.00\');', 
```

这一切都得到了 json_encoded，这是它返回的部分：

```
"onclick":"document.getElementById('li_273').data('pricevalue','1.00');", 
```

但是，当我从 ajax 菜单中选择某些内容并单击时，我会收到一条错误消息：

```
Uncaught TypeError: Object #<HTMLLIElement> has no method 'data' 
```

我一生都无法弄清楚这一点，我需要做的只是更新页面上的价格。

更新：这是尝试让它实际计算页面上的 JavaScript 的其余代码：

```
 $('#main_body li[data-pricefield="special"]').delegate('onclick','change', function(e) {
        var temp = $(this).attr("id").split('_');
        var element_id = temp[1];

        var pricedef = $(this).data('pricedef');
        if(pricedef == null){
            pricedef = 0;
        }

        $("#li_" + element_id).data("pricevalue",pricedef);
        calculate_total_payment();
           }); 
```

似乎缺少什么？因为它不会更新页面上的总数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:21:41.157

`.data`是一个 jquery 函数，您可能正试图在 dom 对象上调用它。确保您在页面上加载了 jQuery，然后执行以下操作：

```
jQuery('#li_273').data('pricevalue','1.00'); 
```

# java - 何时在 JAVA 中使用静态初始块？

> ID：13997332
> 
> 赞同：0
> 
> 时间：2012-12-21T21:20:10.993
> 
> 标签：java

谁能解释一下我们在哪种情况下使用静态初始块？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T21:24:20.433

您可以将其用作类中静态数据的“构造函数”。例如，常见的情况可能是设置特殊单词列表：

```
private static final Set<String> special = new HashSet<String>();
static {
    special.add("Java");
    special.add("C++");
    ...
} 
```

然后可以稍后使用这些来检查字符串是否匹配有趣的内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:22:23.517

最常见的场景是在类加载时加载一些资源，例如为 JNI 加载库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:23:59.623

另一个常见的情况是当您需要用于创建静态的某些代码引发异常时。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T01:24:12.367

另一个例子是 java.lang.Object

```
public class Object {

    private static native void registerNatives();
    static {
        registerNatives();
    }
... 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-12-21T21:25:46.660

我一直使用它们来初始化列表和地图。

```
List<String> myList = new ArrayList<String>(){{
    add("blah");
    add("blah2");
}};
for(String s : myList){
    System.out.println(s);
} 
```

# java - 如何在 Java 中从日期中删除序数值

> ID：13997333
> 
> 赞同：0
> 
> 时间：2012-12-21T21:20:22.853
> 
> 标签：java, regex, date, substring, ordinals

我想知道当您不知道输入是一位数还是两位数时，是否有人知道在java中删除序数值的最佳方法是什么？

IE

输入：第 23 个

预期产量：23

* * *

输入：第一

预期输出：1

* * *

到目前为止，我尝试使用 regex util 和 substring 方法的组合：

```
String dayValue = "";
String dayPattern = "(?<=[0-9])(?:st|nd|rd|th)";
Pattern dPattern = Pattern.compile(dayPattern);
Matcher dMatch;

dayValue = "23rd";
dMatch = dPattern.matcher(dayValue);
System.out.println("The Pattern is: " + autoBuyDay.substring(dMatch.start())); 
```

但这只是给了我一个`No match available error`. 关于如何修改这个或更好的方法来实现我的目标的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:25:16.270

```
inputString.replaceAll("\\D", ""); 
```

将从字符串中删除所有非数字字符。

# php - 通过 php 从 html 获取链接

> ID：13997343
> 
> 赞同：0
> 
> 时间：2012-12-21T21:21:00.173
> 
> 标签：php, html, html-parsing

如何`<li><a rel="prev" href="/1149/" accesskey="p">&lt; Prev</a></li>`使用 PHP 从 html 文档中获取此链接？如何通过“rel”获取链接？我试图得到`/1149/`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:44:35.120

试图理解你想要什么......如果你想获取 HTML/XML 输入并获取具有属性 rel="prev" 的链接的 href 值，我建议使用 DOMXpath，例如：

```
$html = '<li><a rel="prev" href="/1149/" accesskey="p">&lt; Prev</a></li>';
$dom = new DOMDocument();
$dom->loadHTML($html);
$xpath = new DOMXPath($dom);

foreach ($xpath->query("//a[@rel='prev']") as $node) {
    if ($node->hasAttribute('href')) {
        echo $node->getAttribute('href') . '<br>';
    }
} 
```

# ruby-on-rails - 在 Facebook 上授权应用程序后出现“无效凭据”（使用 Devise、omniauth :facebook）

> ID：13997347
> 
> 赞同：1
> 
> 时间：2012-12-21T21:21:10.867
> 
> 标签：ruby-on-rails, ruby, facebook, devise, omniauth

我已按照[设计 wiki](https://github.com/plataformatec/devise/wiki/OmniAuth%3a-Overview)上的说明使用 Facebook 帐户登录。

大多数情况下，它都有效。

问题是，我将登录 ( `user_omniauth_authorize_path(:facebook)`)，这会将我带到 Facebook 并单击“授权”按钮。然后我被重定向到我的应用程序，就像我应该做的那样，但我没有点击我的回调函数，而是点击了同一页面并出现错误`flash[:notice]`（“无法从 Facebook 授权你，因为“凭据无效”。”）和我看到的后端：

```
(facebook) Callback phase initiated.
(facebook) Authentication failure! invalid_credentials: OAuth2::Error, : {"error":{"message":"Code was invalid or expired. Session is invalid. This could be because the application was uninstalled after the session was created.","type":"OAuthException","code":100}} 
```

之后我被指向`Started GET "/accounts/auth/facebook/callback?code=XXX`，但不是在那个动作 ( `facebook`) 中处理，而是被发送到`Users::OmniauthCallbacksController#failure`.

但是，奇怪的是，当我看到我用我的 Facebook 帐户授权了哪些应用程序时，我的应用程序就在那里。并且下次我点击登录链接时，我立即获得授权（不要重定向到 FB），并通过我的`facebook`操作登录，没问题。

任何想法为什么会发生这种情况，或调试提示？他们将不胜感激。谢谢！

编辑：我的[omniauth_callbacks_controller.rb](https://gist.github.com/4356065)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T16:28:14.323

事实证明，Facebook 没有工作。我今天早上登录很好，没有更改任何代码。壮观。

让这成为你的一个教训：有时，不是你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:47:22.877

可能与此有关：[https ://developers.facebook.com/bugs/419168608133421?browse=search_50c9f80c2dcb35786620246](https://developers.facebook.com/bugs/419168608133421?browse=search_50c9f80c2dcb35786620246)

我必须说，我们使用 Devise 和 Facebook oAuth，而我从未在我们的应用程序中看到过这种情况。您可以发布您的 OmniauthCallbacksController 的代码片段吗？

# visual-studio - 从另一个开发人员添加的 TFS 源代码控制中获取文件而不先签入我的代码？

> ID：13997351
> 
> 赞同：0
> 
> 时间：2012-12-21T21:21:23.560
> 
> 标签：visual-studio, version-control, tfs

我正在与 Acorn 项目的另一位开发人员 Wally 合作。（两个名字都是虚构的）

Acorn 项目是一个 ASP.net Web 项目；源代码在 TFS（Team Foundation Server）中。Wally 告诉我，他昨天签入了新代码，正如我所料。我坐下来运行合并工具，并记下我们处理同一个文件的地方。我使用 Visual Studio 合并工具进行合并，然后继续测试代码。

它没有用。问题是我的机器中丢失了 Wally 签入 TFS 的许多文件。我可以在“源代码管理资源管理器”中看到 Wally 签入了至少一个新文件。当我用鼠标右键单击 Acord 项目并单击“获取最新”时，我仍然没有得到 Wally 的新文件。这是一个问题，因为我已经添加了一些我自己的新文件，所以我不能只使用 Wally 版本的项目文件。

我可以做些什么来使项目文件包含来自 Wally 的代码（已签入）和我的代码（仅保存在 Shelfset 中）的文件添加？

我正在使用 Visual Studio 2010。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:25:32.670

获取最新版本的项目文件，您将有机会合并文件（自动或手动），因为您都对其进行了更改。

项目文件是XML，所以你应该很容易看到它的大部分意思，你只需要了解项目中的文件部分，所以如果你需要手动合并它们真的没有任何问题.

# php - php sql删除按钮

> ID：13997358
> 
> 赞同：2
> 
> 时间：2012-12-21T21:21:51.063
> 
> 标签：php, sql, button, sql-delete

我正在尝试从 sql 中创建一个删除按钮。我启动了一个名为 $del 的函数，但我不知道如何完成它，其形式是在当前回显语句旁边回显一个删除按钮。

```
$con = mysql_connect("localhost", "user", "pass");
if (!$con) {
    die('Could not connect: ' . mysql_error());
}

mysql_select_db("database", $con);
$sql = "INSERT INTO camps (city, map, park, day, details) 
    VALUES ('$_POST[city]','$_POST[map]','$_POST[park]','$_POST[day]','$_POST[details]')";

if (!mysql_query($sql, $con)) {
    die('Error: ' . mysql_error());
}

$number = 0;
$del = mysql_query("DELETE FROM camps WHERE user_id= '$number'");

$result = mysql_query("SELECT * FROM camps");

while ($row = mysql_fetch_array($result)) {
    echo "<a href=\"'" . $row['map'] . "\">" . $row['city'] . "</a>";
    echo "<br />";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:37:24.670

您需要让您的链接将参数传递给将删除该记录的脚本。您的链接看起来像这样

```
 echo "<a href=\"'delete.php?id=" . $user_id"\">" . $row['city'] . "</a>"; 
```

然后你的删除可以从 $_GET 全局中获取参数，然后像这样将它们传递给你的 sql

```
 $del = mysql_query("DELETE FROM camps WHERE user_id=" . $_GET['user_id']); 
```

此当前查询将删除该用户的所有营地（根据需要调整参数/sql）。

However, you should NEVER pass user vars into your sql strings. You leave yourself open for [sql injection attacks](http://en.wikipedia.org/wiki/SQL_injection). I would recommend using [PDO](http://php.net/manual/en/book.pdo.php) to escape your sql. I would also recommend using the post method for any destructive db operation so that you don't accidentally alter something.

# lua - 从 unix 时间戳获取小时数

> ID：13997360
> 
> 赞同：2
> 
> 时间：2012-12-21T21:21:56.523
> 
> 标签：lua, timestamp

如何从 linux 时间戳中获取当前时间？我可以得到年、月、日、分和秒，但不能得到小时。有什么帮助吗？

当前代码：

```
local secondsPassed = os ~= nil and os.time() or tick()
local year = 1970 + math.floor(secondsPassed / (86400 * 365.25))
local days = math.floor((secondsPassed % (365.25 * 86400)) / 86400)
days = days + (year - 2011)
local minutes = math.floor((secondsPassed % 3600) / 60)
local seconds = math.floor(secondsPassed % 60) 
```

破碎的：

```
local hours = math.floor((secondsPassed % 86400) / 3600)-- +1 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:57:13.560

这里有几个问题：

*   UNIX 时间相对于格林威治标准时间 1970 年 1 月 1 日午夜。如果您不在格林威治标准时间，您将看到取决于您所在时区的偏移量。如果您所在的地区采用夏令时，则此偏移量将根据日期以一种可能相当复杂的方式发生变化。

*   年份不是 365.25 天。根据年份，它们有 365 天或 366 天长。（这甚至不平均为 365.25；由于特殊情况下可被 100 和 400 整除的年份，平均为 365.2425。）

除非出于某种原因您不能使用 Lua[`date`和`time`模块](http://www.lua.org/pil/22.1.html)，否则我强烈建议您这样做，而不是尝试自己重新创建它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-06T04:11:35.967

你超级亲密。到目前为止，我的时间正确：

当地小时 = math.floor((secondsPassed % 86400) / 1440) + 1

# java - String.substring 与 String[].split

> ID：13997361
> 
> 赞同：19
> 
> 时间：2012-12-21T21:22:11.303
> 
> 标签：java, memory, garbage-collection

我有一个逗号分层字符串，调用`String.split(",")`它时返回一个大小约为 60 的数组。在特定用例中，我只需要获取将从数组返回的第二个值的值。因此，例如，`"Q,BAC,233,sdf,sdf,"`我想要的只是第一个之后`','`和第二个之前的字符串的值`','`。我对性能的问题是我最好自己使用 substring 或使用 split 方法解析它，然后获取数组中的第二个值？任何输入将不胜感激。此方法每秒会被调用数百次，因此我了解有关性能和内存分配的最佳方法很重要。

-邓肯

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-21T21:24:41.140

由于`String.Split`返回 a `string[]`，使用 60 路`Split`将导致每行大约 60 个不必要的分配。`Split`遍历整个字符串，并创建 60 个新对象以及数组对象本身。在这 61 个对象中，您只保留一个，让垃圾收集器处理剩下的 60 个。

如果你在一个紧密的循环中调用它，一个子字符串肯定会更有效：它遍历你的字符串部分直到第二个逗号`,`，然后创建一个你保留的新对象。

```
String s = "quick,brown,fox,jumps,over,the,lazy,dog";
int from = s.indexOf(',');
int to = s.indexOf(',', from+1);
String brown = s.substring(from+1, to); 
```

以上[印刷品](http://ideone.com/ku21ya) `brown`

当您多次运行此程序时，`substring`按时获胜：1,000,000 次迭代`split`需要 3.36 秒，而 1,000,000 次迭代只需 0.05 秒`substring`。字符串中只有八个组件！六十个组件的差异会更大。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T21:23:46.087

当然为什么要遍历整个字符串，只需使用`substring()`和`indexOf()`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T21:25:29.843

您当然最好手工完成，原因有两个：

*   `.split()`将字符串作为参数，但该字符串被解释为 a `Pattern`，并且对于您的用例`Pattern`而言成本很高；
*   正如你所说，你只需要第二个元素：抓取第二个元素的算法很简单，可以手动完成。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-21T21:28:06.763

我会使用类似的东西：

```
final int first = searchString.indexOf(",");
final int second = searchString.indexOf(",", first+1);
String result= searchString.substring(first+1, second); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-21T21:24:28.427

我的第一个倾向是找到第一个和第二个逗号的索引并获取子字符串。

但是，唯一能确定的真正方法是在您的特定场景中测试每一个。打破适当的秒表并测量两者。

# mysql - sql连接为维恩图

> ID：13997365
> 
> 赞同：68
> 
> 时间：2012-12-21T21:22:34.077
> 
> 标签：mysql, sql, visualization, set-theory

我在理解 sql 中的连接时遇到了麻烦，并且发现了这张我认为可能对我有帮助的图片。问题是我不完全理解它。例如，图像右上角的连接，它将整个 B 圆圈涂成红色，但仅与 A 重叠。图像使圆圈 B 看起来像是 sql 语句的主要焦点，但 sql 语句本身，从 A 开始（从 A 中选择，加入 B），给我传达了相反的印象，即 A 将是 sql 语句的焦点。

同样，下图只包含来自 B 圈的数据，那么为什么 A 包含在 join 语句中呢？

问题：从右上角顺时针工作并在中心完成，有人可以提供有关每个sql图像表示的更多信息，解释

a）为什么在每种情况下都需要连接（例如，特别是在没有从 A 或 B 获取数据的情况下，即只有 A 或 B 而不是两者都是彩色的）

b) 以及任何其他可以阐明为什么图像是 sql 的良好表示的细节

![sql连接图](../Images/95a23a9ac6ad36fb9616d2bbf8420a2d.png)

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-12-23T14:46:35.830

我同意凯德关于维恩图的局限性的观点。更恰当的视觉表示可能是这样。

### 表

![表](../Images/6c62878d5e80362827b4895566385801.png)

### [从 A CROSS JOIN B SQL Fiddle](http://www.sqlfiddle.com/#!6/d41d8/1680)中选择 A.Colour、B.Colour

交叉连接（或笛卡尔积）对两个表中的行的每个组合产生一个结果。每个表有 4 行，因此这会在结果中产生 16 行。

![交叉连接](../Images/02d34ae183490419d3813495d6e3de32.png)

### 从 A.Colour = B.Colour [SQL Fiddle上的 A INNER JOIN B 中选择 A.Colour，B.Colour](http://www.sqlfiddle.com/#!6/d41d8/1681)

内连接从逻辑上返回与连接条件匹配的交叉连接的所有行。在这种情况下，五个做。

![内部联接](../Images/0d5ca3699db0c0ad9c8528c27fd8591e.png)

### SELECT A.Colour, B.Colour 从 A.Colour NOT IN ('Green','Blue') [SQL Fiddle的 A INNER JOIN B](http://www.sqlfiddle.com/#!6/d41d8/1682)

内连接条件不一定是相等条件，也不需要引用两个（甚至任何一个）表中的列。评估`A.Colour NOT IN ('Green','Blue')`交叉连接返回的每一行。

![内部 2](../Images/de9a7e048341ab33491fed604c11b868.png)

`1=1`对于交叉连接中的每一行，内部连接条件的计算结果都为真，因此两者是等价的（ [SQL Fiddle](http://www.sqlfiddle.com/#!6/d41d8/1683)）。

### [从 A.Colour = B.Colour SQL Fiddle](http://www.sqlfiddle.com/#!6/d41d8/1684)的左外连接 B 中选择 A.Colour、B.Colour

外部联接的逻辑评估方式与内部联接相同，只是如果左表中的一行（用于左联接）根本不与右侧表中的任何行联接，则它会保留在结果中，并`NULL`带有右手列。

![洛杰](../Images/cf8911d3ce74b133fa002b8e94a07c26.png)

### SELECT A.Colour, B.Colour 从 A.Colour = B.Colour 的 A LEFT OUTER JOIN B ON A.Colour = B.Colour WHERE B.Colour IS NULL [SQL Fiddle](http://www.sqlfiddle.com/#!6/d41d8/1685)

这只是将先前的结果限制为仅返回`B.Colour IS NULL`. 在这种特殊情况下，这些将是保留的行，因为它们在右侧 table 中没有匹配，并且查询返回 table 中不匹配的单个红色行`B`。这称为反半连接。

为`IS NULL`测试选择一个不可为空的列或连接条件可确保`NULL`排除任何值以使此模式正常工作并避免只带回恰好具有该`NULL`值的行非常重要除了不匹配的行之外的列。

![loj 为空](../Images/4d92da423b70b0cfa68a2254bb478d52.png)

### [从 A.Colour = B.Colour SQL Fiddle](http://www.sqlfiddle.com/#!6/d41d8/1686)的右外部连接 B 中选择 A.Colour、B.Colour

右外连接的作用类似于左外连接，除了它们保留右表中不匹配的行并且空扩展左列。

![罗杰](../Images/51e15718c3a96de1132e7275d6287b2a.png)

### [从 A.Colour = B.Colour SQL Fiddle](http://www.sqlfiddle.com/#!6/d41d8/1687)上的完整外部连接 B 中选择 A.Colour、B.Colour

全外连接结合了左连接和右连接的行为，并保留左右表中不匹配的行。

![FOJ](../Images/3ed4f8038bd23b0b7edb23d7bf56dbbd.png)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-21T21:30:59.033

我认为您的主要潜在困惑是，当（例如）仅以`A`红色突出显示时，您将其理解为“查询仅返回*来自`A`*”的数据，但实际上它意味着“查询仅*在以下情况下返回数据`A`有记录*”。查询可能仍包含来自 B 的数据。（对于*没有*`B`记录的情况，查询将替换为。）*`NULL`*

 *> 同样，下图只包含来自 B 圈的数据，那么为什么 A 包含在 join 语句中呢？

如果你的意思是——图像`A`完全是白色的，并且`B`没有与 重叠的部分有一个红新月形`A`，那么：`A`出现在查询中的原因是，`A`它如何找到`B`需要的记录被排除在外。（如果`A`没有出现在查询中，那么维恩图就没有`A`，它只会显示`B`，并且没有办法区分想要的记录和不需要的记录。）

> 这张图让我觉得圆圈 B 是 sql 语句的主要焦点，但 sql 语句本身以 A 开头（从 A 中选择，加入 B）给我传达了相反的印象，即 A 将是焦点的sql语句。

完全正确。因此，`RIGHT JOIN`s 相对不常见；尽管使用 a 的查询`LEFT JOIN`几乎总是可以重新排序以使用 a`RIGHT JOIN`代替（反之亦然），但通常人们会使用`LEFT JOIN`而不是使用编写查询`RIGHT JOIN`。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2012-12-22T14:39:56.207

维恩图适用于表示集合操作，例如 UNION、INTERSECTS、EXCEPT 等。

仅就 EXCEPT 之类的集合操作使用 LEFT JOIN WHERE rhs.KEY 为 NULL 之类的东西进行模拟时，此图是准确的。

否则会产生误导。例如，如果连接条件不是 1:1，则任何连接都可能导致行成倍增加。但是集合只允许包含不同的成员，因此不能表示为集合操作。

然后是 CROSS JOIN 或 INNER JOIN ON 1 = 1 - 这既不类似于图中所示的 INNER JOIN，也不能用维恩图真正描述所产生的集合。更不用说所有其他可能的三角连接、自连接和反连接，例如：

```
lhs INNER JOIN rhs ON rhs.VALUE < lhs.VALUE (triangular) 
```

或者

```
SELF self1
INNER JOIN SELF self2
    ON self2.key <> self1.key
    AND self1.type = self2.type 
```

（self cross and anti-join 查找除自己之外的所有相似家庭成员 - self1 和 self2 是同一个集合，结果是一个适当的子集）

在教程的前几分钟坚持键上的连接可能很好，但这可能会导致学习连接是什么的糟糕路径。我想这就是你发现的。

维恩图通常可以以这种方式表示 JOIN 的想法需要消除。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-21T21:31:57.850

当您进行连接时，您的两个表可能不会完全匹配。具体来说，A 中的某些行可能与 B 中的任何内容都不匹配，或者 A 中的重复行与 B 中的单行匹配，反之亦然。

发生这种情况时，您可以选择：

1.  对于每个 A，如果有一个 B，则取一个有效的 B。（左上）
2.  取出完全匹配的每一对（丢弃任何缺少 A 或 B--center 的）
3.  对于每个 B，如果有一个，则取一个有效的 A（右上角）
4.  拿走一切（左下）

中左和右在技术上是连接，但没有意义；它们可能会更有效地编写`SELECT <select_list> FROM TableA A WHERE A.Key NOT IN (SELECT B.Key FROM TableB B)`（或相反）。

在直接回答您的困惑时，`RIGHT JOIN`说“以下表达式是此查询的焦点”。右下角相当奇怪，我看不出你为什么想要这样。`NULL`它返回来自两个外部中间查询的结果，与对面表的所有列中的 's混合在一起。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-21T21:38:34.447

对于正确的连接，是的，语法可能会令人困惑，但是的，它看起来就是这样。当您说“TableA RIGHT JOIN TableB”时，确实是在说 TableB 是您所指的主表，而 TableA 只是挂在它具有匹配记录的位置。这在查询中读起来确实很奇怪，因为 TableA 首先列出，所以您的大脑会自动为其分配更多优先级，即使 TableB 确实是查询中更重要的表。出于这个原因，您实际上很少在实际代码中看到右连接。

因此，代替 A 和 B，让我们采用两个易于跟踪的东西。假设我们有两张用于人们信息的表，ShoeSize 和 IQ。你有一些人的鞋码信息，一些人的智商信息。并且在您可以加入的两个表上都有一个 PersonID。

从右上角顺时针方向（即使这从一些更复杂和人为的情况开始）：

*   ShoeSize RIGHT JOIN IQ -> 给我所有的 IQ 信息。如果我们有这些人的任何 ShoeSize 信息，请包括这些信息。
*   ShoeSize RIGHT JOIN IQ WHERE ShowSize.PersonID = NULL -> 给我所有的 IQ 信息，但仅限于没有任何鞋码信息的人
*   ShoeSize FULL OUTER JOIN IQ WHERE ShoeSize.PersonID = NULL AND IQ.PersonID = NULL -> 只给没有 IQ 信息的人的鞋码信息，以及没有鞋码信息的人的 IQ 信息
*   ShoeSize FULL OUTER JOIN IQ -> 给我一切，所有鞋码和所有 IQ 数据。如果任何 ShoeSizes 和 IQ 记录具有相同的 PersonID，请将它们包含在一行中。
*   ShoeSize LEFT JOIN IQ WHERE IQ.PersonID = NULL -> 给我所有的鞋码信息，但仅限于没有 IQ 信息的人
*   ShoeSize LEFT JOIN IQ -> 给我所有的鞋码信息。如果我们有这些人的任何智商信息，请包括这些信息。*

# javascript - 如何检查某个 html 片段是否已经加载？

> ID：13997370
> 
> 赞同：4
> 
> 时间：2012-12-21T21:22:49.763
> 
> 标签：javascript, jquery

有以下代码：

```
 $("#blogs").mouseover(
    function () {
      $(this).addClass("hover");

      $("#home").removeClass("hover");
      $("#homepages").removeClass("hover");
      $("#apps").removeClass("hover");
      $("#facebook").removeClass("hover");
      $("#kontakt").removeClass("hover");

      $("#content").hide().load("blogs.html", function(){
      $("#content").show("slide"); 

    });  
 }); 
```

一切正常，但现在我希望仅在#content 尚未包含 blogs.html 时调用 load() / show() 函数。

换句话说：我想检查 blogs.html 是否已经加载，如果是，则什么也不做，只有在还没有加载的情况下我才会加载并显示它。

用 hasClass() 和一些 if 公式尝试了一些东西，但很难得到这个检查。

试过这样的东西：

```
$("#content section").hasClass("check_blog").hide().load("blogs.html", function(){
$("#content").show("slide"); 
```

基本上我只需要知道如何检查 blogs.html 是否已经是#content 的内容。

非常感谢您的帮助。问候， 安迪

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:28:34.507

向 blogs.html 中的某个元素添加一个 ID，例如`blogsloaded`，然后您可以通过以下方式检查它：

```
if (!$("#blogsloaded").length)
    $("#content").hide().load("blogs.html" ... 
```

如果您已经加载它，另一种方法是存储在变量中：

```
if (!this.blogsloaded)
{
    this.blogsloaded=true;
    $("#content").hide().load("blogs.html" ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:45:56.887

您可以使用[.has()](http://api.jquery.com/has/)来检测内容的后代

```
$("#blogs").mouseover(
    function () {
      $(this).addClass("hover");    
      $("#home,#homepages,#apps,#facebook,#kontakt").removeClass("hover");
      var $c = $("#content");
      if($c.has('.check_blog')){ // if content contains an element with that class
          $("#content").hide().load("blogs.html", function(){
          $("#content").show("slide"); 
      }

    });  
 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:27:54.237

我会将您的鼠标悬停事件拆分为两个命名空间事件。一个只会运行一次。

```
// This event will only run once
$("#blogs").on("mouseover.runonce", function () {
    $("#content").load("blogs.html");
});

// because this event will unbind the previous one
$("#blogs").on("mouseover.alwaysrun", function () {
    $(this).off("mouseover.runonce");

    $(this).addClass("hover");

    $("#home").removeClass("hover");
    $("#homepages").removeClass("hover");
    $("#apps").removeClass("hover");
    $("#facebook").removeClass("hover");
    $("#kontakt").removeClass("hover");

    $("#content").hide();
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T21:42:38.067

`#content`更新包含当前加载内容的 url 或 id 的数据属性。此外，您应该处理用户在前一个部分完成加载之前将鼠标悬停在不同部分上的情况。

```
var request; // use this same var for all, don't re-declare it
$("#blogs").mouseover(function () {

    // exit event if the blog is the current content in #content
    if ( $("#content").data("current") == "blog") return;

    $("#content").data("current","blog");
    $(this).addClass("hover");
    $("#home").removeClass("hover");
    $("#homepages").removeClass("hover");
    $("#apps").removeClass("hover");
    $("#facebook").removeClass("hover");
    $("#kontakt").removeClass("hover");

    // if a previous request is still pending, abort it
    if ($.isFunction(request.abort) && request.state() == "pending") request.abort();

    // request content
    request = $.get("blogs.html");
    $("#content").hide();

    // when content is done loading, update #content element
    request.done(function(result){
        $("#content").html(result); 
    });
}); 
```

我强烈建议不要使用悬停来加载带有 ajax 的内容。

此外，在目前的形式中，此代码不是很可重用，您必须为每个链接提供一个。我建议改为使用类并只使用一个事件绑定来处理所有链接。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-21T21:37:23.817

你可以这样做：

```
$("#blogs").mouseover(
 function () {
   $(this).addClass("hover");

   $("#home").removeClass("hover");
   $("#homepages").removeClass("hover");
   $("#apps").removeClass("hover");
   $("#facebook").removeClass("hover");
   $("#kontakt").removeClass("hover");

   if($('#content').html() == '') {
    $("#content").hide().load("blogs.html", function(){
     $("#content").show("slide"); 
    });  
   }
}); 
```

# android - 调整 SimpleOnGestureListener.onFling() 灵敏度

> ID：13997371
> 
> 赞同：1
> 
> 时间：2012-12-21T21:22:50.957
> 
> 标签：android, android-gesture

我已经实现了 SimpleOnGestureListener.onFling()，但我必须非常快速地触发它。有什么办法让它更敏感吗？

提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:48:17.167

在 GestureDetector中[检查](http://www.grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.1.1_r1/android/view/GestureDetector.java#559)触发`onFling()`事件所需的灵敏度或“魅力”：

```
if ((Math.abs(velocityY) > mMinimumFlingVelocity)
        || (Math.abs(velocityX) > mMinimumFlingVelocity)){
    handled = mListener.onFling(mCurrentDownEvent, ev, velocityX, velocityY);
} 
```

遗憾的是，没有现有的方法可以更改 private 成员`mMinimumFlingVelocity`。但是，您应该能够将整个 GestureDetector 类复制到项目中的一个新类中，并自己硬编码一个新值。

# eclipse - eclipse插件依赖于其他eclipse插件时出现NoClassDefFoundError的运行时错误

> ID：13997376
> 
> 赞同：1
> 
> 时间：2012-12-21T21:23:04.760
> 
> 标签：eclipse, eclipse-plugin

我有一个 Eclipse 插件项目`com.prosseek.asttest`，并且我推出了一个新的插件项目`com.prosseek.impactAnalyzer`，它有一个类`CallHierarchyGenerator.java`。现在 asttest 项目依赖于 ImpactAnalyzer 项目。我别无选择，只能制作 ImpactAnalyzer 项目 Eclipse 插件，因为它使用 JDT 库。

在中设置构建路径后 `com.prosseek.asttest`，它构建没有问题。

![在此处输入图像描述](../Images/1f82057b7b6307fdf9354f224b71f246.png)

但是，当我执行插件时，我收到一个错误缺少`CallHierarchyGenerator.java`类。

![在此处输入图像描述](../Images/979c7ef8ccbfe360755dcaa733ab690b.png)

可能有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:58:30.127

如果您将其作为 OSGI 或 Eclipse 应用程序运行，则需要明确导出包以供其他插件使用，因为默认情况下它们不可用。在插件 1 中打开清单编辑器。单击运行时选项卡并将包添加为“已导出”，然后 blugin 2 中的类加载器将能够找到它。

看起来你可能做错了类路径配置。在插件 2 中，确保将插件 1 添加为清单编辑器的依赖项选项卡中的依赖项。看起来你正在做一个依赖配置，就好像它是一个普通的 java 应用程序一样

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:08:55.797

根据邓肯的回答，我可以解决这个问题。

## 导出包`impactAnalyzer`

![在此处输入图像描述](../Images/c93057ebc0bec73a27fd9f81fd88b2f6.png)

实际上我没有手动添加它，但它已经导出了，因为（我猜）我是用 Quick Assist 自动完成的。

## 所需插件

我不得不添加`com.prosseek.impactAnalyzer`依赖项。 ![在此处输入图像描述](../Images/f8acdde547ba0f1786dcfe2c8aa7082b.png)

## 运行配置更新

我还有一步要做，我必须打开运行配置到`add required plug-ins`.

![在此处输入图像描述](../Images/85ada68a034fc2a51e88082f9d9263b5.png)

## 导出插件

导出`asttest`插件时，我也必须导出`impactAnalyzer`。

![在此处输入图像描述](../Images/e4b16877e5f5ac45bb607b31db2657eb.png) ![在此处输入图像描述](../Images/efd1060bf4a0f6b1de1d7dc47b26f887.png)

# java - 如何在 grails/java 中将 PNG 转换为 jpeg

> ID：13997377
> 
> 赞同：0
> 
> 时间：2012-12-21T21:23:05.537
> 
> 标签：java, image, grails, javax.imageio

我有一个 png 文件并试图将其转换为 jpeg。但是生成的图像有错误的颜色，有很大的粉红色区域。这是我的代码：

```
 BufferedImage image = null
        BufferedImage imageRGB = null

        image = ImageIO.read(new ByteArrayInputStream(imageBytesPng))

        imageRGB = new BufferedImage(image.getWidth(), image.getHeight(), BufferedImage.TYPE_INT_RGB)

        imageRGB.setData(image.getData())

        ByteArrayOutputStream baos=new ByteArrayOutputStream()

        ImageIO.write(imageRGB, "jpeg", baos)
        baos.flush()
        def outImage = baos.toByteArray()
        baos.close()
        return outImage 
```

我可以更改什么以使图像颜色与 png 文件中的一样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:20:38.770

```
InputStream pngInputStream = ...
OutputStream jpgOutputStream = ...

BufferedImage image = ImageIO.read(pngInputStream));
ImageIO.write(image, "jpeg", jpgOutputStream); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:29:18.973

试试这个最好..

```
import javax.media.jai.*;
public class jai_png_jpg 
{
   public static void main(String[] args)throws Exception  
   {
  String filename="input_png.png";
  //Read input PNG as a PlanarImage file
  PlanarImage inputfile = JAI.create("fileload", filename); 
  //write output in JPG Format 
  JAI.create("filestore",inputfile,"jai_jpg_output.jpg","JPEG"); } } 
```

# android - 修复了 HTML 5 Web 应用程序闪烁 (Android) 中的标题

> ID：13997378
> 
> 赞同：1
> 
> 时间：2012-12-21T21:23:08.227
> 
> 标签：android, web, header, fixed

所以我有一个网络应用程序，其中有一个固定的标题。当用户向下滚动页面时，在页面的最顶部，背景（用户向下滚动的内容）以随机间隔闪烁。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:10:18.370

通过添加自己修复它

```
-webkit-backface-visibility: hidden; 
```

到标题和内容 div。现在，如果只有 stackoverflow 会让我接受这个作为答案。

# javascript - 目的 ＃ 没有方法“getUserMedia”

> ID：13997379
> 
> 赞同：2
> 
> 时间：2012-12-21T21:23:16.743
> 
> 标签：javascript, html, api

我正在尝试使用 getUserMedia() 方法，但在我尝试调用它的那一刻，控制台返回了该错误

“对象 # 没有方法 'getUserMedia'”

你知道为什么会这样吗？

我使用的是最新版本的 Chrome

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:32:42.957

当前版本的 Chrome 不支持 unprefixed `navigator.getUserMedia`。您将需要检查是否支持此功能并尝试使用前缀替代方案，例如`navigator.webkitGetUserMedia`, 。

[有关详细信息，请参阅https://developer.mozilla.org/en-US/docs/WebRTC/navigator.getUserMedia](https://developer.mozilla.org/en-US/docs/WebRTC/navigator.getUserMedia)中的示例代码--

```
navigator.getMedia = ( navigator.getUserMedia ||
                       navigator.webkitGetUserMedia ||
                       navigator.mozGetUserMedia ||
                       navigator.msGetUserMedia);

navigator.getMedia (constraints, success, error); 
```

请记住，如果浏览器不支持这些方法，它`navigator.getMedia`可能*仍然是未定义的。*它仍然是一个非常新的功能，并且不是普遍可用的。

# php - 选择不同的经度和纬度值并找到它们的中值

> ID：13997385
> 
> 赞同：3
> 
> 时间：2012-12-21T21:24:03.373
> 
> 标签：php, jquery, mysql, cordova, google-maps-api-3

我正在使用 Google Maps API V3 和 jQuery 创建一个 Phonegap 应用程序。

当检测到坑洞时，应用程序将经度和纬度值分别存储在 MySQL 数据库中。我需要做的是选择任何相对接近并且很可能是同一个坑洼的值。

jQuery/PHP/SQL 中是否有任何方法可以获取相对接近的值，找到它们的均值，然后使用该值继续处理其他一些事情？

基本上我需要的是，一旦一个特定的坑洞被检测到 5 次，它就会在谷歌地图上绘制出来。但是，只有在满足此阈值时。困难在于，在经度和纬度值略有不同的情况下，可能会报告相同的坑洼，具体取决于报告它的设备的准确性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:46:10.160

您需要的是[Haversine 公式](http://en.wikipedia.org/wiki/Haversine_formula)来计算两个给定地点的经纬度坐标之间的距离。基于此，您可以编写一个方法来检查所有接近/接近给定坐标的值，使用以公里为单位的范围。

# Haversine公式计算距离

```
$('some_element').click(function(){
    var location1 = [lat, lon] // Specify Longitude and latitude
    var location2 = [lat, lon] // Specify Longitude and latitude

    var lat1 = location1[0], lon1 = location1[1];
    var lat2 = location2[0], lon2 = location2[1];
    var earth = 6371 // Earth's Radius in Kms

    var dLat = (lat2-lat1) * Math.PI / 180;
    var dLon = (lon2-lon1) * Math.PI / 180;
    var nlat1 = (lat1) * Math.PI / 180;
    var nlat2 = (lat2) * Math.PI / 180;
    // Calculation
    var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(nlat1) * Math.cos(nlat2);
    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    var d = earth * c;
    var distance = Math.round(d*Math.pow(10,2)) / Math.pow(10,2); //Round off to 2 decimal places
    alert(distance);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T08:41:01.127

由于您需要识别新坑附近的坑洼，因此以下代码可以以米为单位执行此操作。它使用带有错误检查的 POD 在 MySQL 查询中使用[**Haversine 公式。**](http://rosettacode.org/wiki/Haversine_formula)

$lat & $lng 是新坑洞的坐标 & $radius 是以米为单位的**搜索半径**。6378160 是地球在赤道处的半径，以米为单位。

为确保此级别的准确性，数据库中的坐标必须至少有 4 位小数[**参见 Wiki**](http://en.wikipedia.org/wiki/Decimal_degrees)

**编辑**

```
 try {
    // Prepare search statement
    $stmt1 = $dbh->prepare("SELECT id, lat, lng, cnt, ( 6378160 * acos( cos( radians(?) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(?) ) + sin( radians(?) ) * sin( radians( lat ) ) ) ) AS  distance FROM potholes  HAVING distance <  ? ORDER BY distance LIMIT 0,10");
    // Assign parameters
    $stmt1->bindParam(1,$lat);
    $stmt1->bindParam(2,$lng);
    $stmt1->bindParam(3,$lat);
    $stmt1->bindParam(4,$radius);
    //Execute query
    $stmt1->setFetchMode(PDO::FETCH_ASSOC);
    $stmt1->execute();
    if ($stmt1->rowCount()>0) {//Existing pothole 
        // fetch row
        $row = $stmt1->fetch();
        $id = $row['id'];
        $lat1 = $row['lat'];
        $lng1 = $row['lng'];
        $cnt = $row['cnt'];
        $meanLat = (($lat1*$cnt)+$lat)/($cnt+1);
        $meanLng = (($lng1*$cnt)+$lng)/($cnt+1);
        ++$cnt;
        // Prepare UPDATE statement existing pothole
        $stmt2 = $dbh->prepare("UPDATE  `potholes` SET  `lat` = ?,`cnt` =  ? WHERE  `potholes`.`id` = ? LIMIT 1");
        // Assign parameters
        $stmt2->bindParam(1,$meanLat);
        $stmt2->bindParam(2,$cnt);
        $stmt2->bindParam(3,$id);
        $stmt2->execute();
    //  }
    }else{//New pothole
        // Prepare INSERT statement new pothole
        $stmt3 = $dbh->prepare("INSERT INTO `potholes` (`id`, `lat`, `lng`, `cnt`) VALUES (NULL, ?, ?, '1')");
        // Assign parameters
        $stmt3->bindParam(1,$lat);
        $stmt3->bindParam(2,$lng);
        $stmt3->execute();

    }
echo json_encode($data);//Echo to calling page if required
}

catch(PDOException $e) {
    echo "Error Message.". $e->getMessage() ;// Remove or modify after testing 
    file_put_contents('PDOErrors.txt',date('[Y-m-d H:i:s]').", data2c.php, ". $e->getMessage()."\r\n", FILE_APPEND);  
 }
//Close the connection
$dbh = null; 
```

# ios - iOS6中的iOS行车路线

> ID：13997388
> 
> 赞同：1
> 
> 时间：2012-12-21T21:24:21.230
> 
> 标签：ios, driving-directions, mkmapview

我一直在搜索如何将行车路线集成到我的应用程序中的 MKMapView 中。是打开 Apple Maps 程序并从那里开始的唯一方法，或者是将它们集成到您自己的应用程序中的一种方式。如果没有，我可能会在获得 API 密钥后立即使用谷歌地图。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T12:11:52.540

如果您的意思是获得与 Apple Maps 应用程序相同的行车方向视图（即逐向导航），那么不……据我所知，没有图书馆（如果不是第 3 方）。但是，正如您所提到的，您可以打开苹果地图或谷歌地图，为应用程序提供指示并启动此类功能。

另外，很高兴知道：如果 iOS6 中有这样的内置功能（我也不相信有），很高兴知道它在 iOS6 之前的版本中不存在。这意味着它不适用于早期的设备。（因此，如果您还想支持这些设备，则需要构建一个备用解决方案）。

有关 iOS 的详细信息：http: [//developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniPhoneOS/Articles/iOS6.html](http://developer.apple.com/library/ios/#releasenotes/General/WhatsNewIniPhoneOS/Articles/iOS6.html)

从该页面引用（这让我相信 API 不支持逐个转弯）：

> ... 提供路线信息的应用程序，例如逐向导航服务，现在可以注册为路线应用程序，并使这些服务可用于整个系统。

文档搜索页面也没有提供更多信息： http: [//developer.apple.com/library/ios/search/ ?q=turn-by-turn](http://developer.apple.com/library/ios/search/?q=turn-by-turn)

有关如何打开地图应用程序的更多信息，请在此处查看答案：[https ://stackoverflow.com/a/12789896/406677](https://stackoverflow.com/a/12789896/406677)

因此，最重要的是，您需要创建自己的逐向导航......或链接到提供此类支持的现有应用程序。

我希望这回答了你的问题。

# delphi - 函数参数中的高效指针处理

> ID：13997397
> 
> 赞同：5
> 
> 时间：2012-12-21T21:24:58.410
> 
> 标签：delphi, pointers

正如上面的主题所示，我想知道在顺序处理数据时是否有一个干净有效的方法来处理函数参数中传递的指针的好例子。我所拥有的是这样的：

```
function myfunc(inptr: pointer; inptrsize: longint): boolean;
   var
     inproc: pointer;
     i: integer;
   begin
     inproc := inptr;
     for i := 1 to inptrsize do
       begin
         // do stuff against byte data here.
         inc(longint(inproc), 1);
       end;
   end; 
```

这个想法是，我希望它能够处理任何被推送的东西，而不是有限的数据，无论大小。

现在，在处理数据方面，我想出了几种成功的方法。

1.  将 parm 指针分配给相同的临时指针，然后使用它们访问每条数据，递增它们以继续。这种方法是最快的，但看起来不是很干净，所有的指针增量都分布在整个代码中。（这就是我上面所说的）
2.  将 parm 指针分配给表示大数组值的指针，然后使用标准表逻辑递增地处理它。干净得多，但比#1 慢了大约 500 毫秒。

是否有另一种方法可以以这种方式有效地处理指针，或者我是否缺少一些既干净又不会时间效率低的方法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-21T21:44:37.070

你这里的代码基本上没问题。我总是选择增加一个指针而不是强制转换为一个假数组。

但是您不应该转换为整数。这在语义上是错误的，只要您在指针大小与整数大小不同的平台上编译，您就会付出代价。始终使用指向正确大小元素的指针。在这种情况下，指向字节的指针。

```
function MyFunc(Data: PByte; Length: Integer): Boolean;
var
  i: Integer;
begin
  for i := 1 to Length do
  begin
    // do stuff against byte data here.
    inc(Data);
  end;
end; 
```

除非编译器遇到了非常糟糕的一天，否则你不会发现比这更容易获得性能更好的代码。更重要的是，我认为这种风格实际上是相当清晰易懂的。大多数清晰度增益来自于避免投射的需要。始终努力从代码中删除强制转换。

如果你想允许传递任何指针类型，那么你可以这样写：

```
function MyFunc(P: Pointer; Length: Integer): Boolean;
var
  i: Integer;
  Data: PByte;
begin
  Data := P;
  for i := 1 to Length do
  begin
    // do stuff against byte data here.
    inc(Data);
  end;
end; 
```

或者，如果您想避免在接口中使用指针，请使用无类型的 const 参数。

```
function MyFunc(const Buffer; Length: Integer): Boolean;
var
  i: Integer;
  Data: PByte;
begin
  Data := PByte(@Buffer);
  for i := 1 to Length do
  begin
    // do stuff against byte data here.
    inc(Data);
  end;
end; 
```

如果需要修改缓冲区，请使用 var 参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T10:29:28.863

我有不同的看法：为了可读性，我会使用数组。Pascal 并非设计为能够直接访问内存。原始的帕斯卡甚至没有指针运算。

这就是我使用数组的方式：

```
function MyFunc(P: Pointer; Length: Integer): Boolean;
var
  ArrayPtr : PByteArray Absolute P;
  I : Integer;

begin
  For I := 0 to Length-1 do 
    // do stuff against ArrayPtr^[I]
end; 
```

但如果性能很重要，我会这样写

```
function MyFunc(P: Pointer; Length: Integer): Boolean;
var
  EndOfMemoryBlock: PByte;

begin
  EndOfMemoryBlock := PByte(Int_Ptr(Data)+Length);
  While P<EndOfMemoryBlock Do begin
    // do stuff against byte data here.
    inc(P);
  end;
end; 
```

# php - 关于使用地理位置确定要显示哪个页面的建议

> ID：13997398
> 
> 赞同：0
> 
> 时间：2012-12-21T21:25:06.113
> 
> 标签：php, html, geolocation

我正在为我正在从事的项目寻找一些友好的建议。它是使用 PHP 和 HTML5 构建的。

我正在为位于德克萨斯州的商店开发电子商务网站。该公司正在考虑为德克萨斯州内的客户提供不同于德克萨斯州以外的客户的不同定价结构。

我想出的方法是使用地理定位来获取用户的位置，并将其与德克萨斯州的地理中心进行核对。如果距离小于 450 英里，则显示一页，或者，如果距离更大，则显示另一页。我知道这不是该州的确切边界，我认为这没关系。

到目前为止，我提出这个想法的唯一问题是用户可以拒绝位置检查。当您在搜索中输入餐馆时，它在 Google 上的工作原理是什么？它会在未经许可的情况下为您提供当地的地方？

大家还有什么建议吗？在我所做的搜索中，我没有找到任何其他似乎适合的想法。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:43:42.950

希望这样做的人通常使用 GeoIP 库，它可以告诉您用户 IP 的来源。请注意，这不会告诉您用户的实际位置。您也可以选择使用其中之一，但是您必须知道，如果他们使用基于 TX 的代理，任何人都可能来自 TX。您必须对订单进行一些严格的检查，以确保人们不会使用代理来欺骗他们的位置并下达将运往德克萨斯州以外的订单。

如果您的客户居住在德克萨斯州边界内，但由于某种原因，他们的 ISP 通过俄克拉荷马州或新墨西哥州的路由器路由他们，会发生什么情况。对于您的 GeoIP，它们看起来像是来自外州。

最好的解决方案（但不是最好的用户体验）是向潜在客户询问他们的位置。如果他们提供了一个位置，如果他们不回退到 GeoIP，就使用它。如果您检测到产品来自州外但提供州内地址，请务必在结帐时更新产品价格。他们可能来自德克萨斯州，但 GeoIP 认为他们不是。

MaxMind - [http://www.maxmind.com/en/geolocation_landing](http://www.maxmind.com/en/geolocation_landing)
这些家伙提供免费和付费的解决方案。我两者都用过，可以告诉你，付费解决方案物有所值，而使用免费版本时会出现不准确的情况。

# ftp - php ftp 返回最后一个命令

> ID：13997399
> 
> 赞同：1
> 
> 时间：2012-12-21T21:25:14.523
> 
> 标签：ftp, php

我想我会为此提出一个新问题，因为它与我也在尝试解决的上一个问题不同。（[严重性：警告消息：ftp_chmod() [function.ftp-chmod]：权限已更改](https://stackoverflow.com/questions/13995494/severity-warning-message-ftp-chmod-function-ftp-chmod-permissions-changed)）

我正在尝试使用 PHP[`ftp_exec`](http://php.net/ftp_exec)重命名文件；但是，它正在输出我运行的最后一个 ftp 命令的结果。以下是错误：

> 遇到 PHP 错误
> 严重性：警告
> 消息：ftp_exec() [function.ftp-exec]: Permissions changed on /public_html/admin/tempUpload/1356124170
> 
> 文件名：models/inventory_model.php
> 行号：80

第 80 行如下：

```
$command = 'rename '.$currentFolder.$imgName.' '.$newFolderFile.$imgName;
ftp_exec($conn_id, $command); 
```

上面的几行是我更改上述目录的权限的地方。此外， rename exec 命令没有做任何事情，但它上面的所有命令都按预期工作。

```
ftp_chmod($conn_id, 0777, $currentDir); 
```

我需要为每个命令重新连接吗？`ftp_exec`或者在运行命令之前我需要做一些清理工作吗？`ftp_exec`此外，当我通过 cmd 连接到 ftp时运行完全相同的操作，它工作正常。

# actionscript-3 - AIR AS3 安卓前置摄像头

> ID：13997409
> 
> 赞同：0
> 
> 时间：2012-12-21T21:25:47.860
> 
> 标签：actionscript-3, air, flash-cs5

我正在尝试使用下面的代码在 Android 设备上使用前置摄像头。权限设置正确，但似乎不起作用。当我删除`CameraPosition.Front from getCamera`它时，它可以正常访问设备标准相机。有什么建议么 ？

```
var cam:Camera = Camera.getCamera(CameraPosition.FRONT); 
var vid:Video = new Video(); 
vid.attachCamera(cam); 
addChild(vid);
if (cam != null) 
{ 
    cam.addEventListener(StatusEvent.STATUS, statusHandler); 
    vid = new Video(); 
    vid.attachCamera(cam); 
} 
function statusHandler(event:StatusEvent):void 
{ 
    if (!cam.muted) 
    { 
        vid.width = cam.width; 
        vid.height = cam.height; 
        addChild(vid); 

    } 
    cam.removeEventListener(StatusEvent.STATUS, statusHandler); 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:05:32.457

这不是参考相机的方式。使用类实例的`position`参数来*确定*Camera 的位置。`Camera`

 *一个例子：

```
var frontCamera:Camera = tryGetFrontCamera();
if (!frontCamera) {
    //Front facing camera unavailable
} 
```

...

```
public function tryGetFrontCamera():Camera {
    var numCameras:uint = (Camera.isSupported) ? Camera.names.length : 0;
    for (var i:uint = 0; i < numCameras; i++) {
        var cam = Camera.getCamera(String(i));
        if (cam && cam.position == CameraPosition.FRONT) {
            return cam;
        }
    } 
    return null;
} 
```

[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Camera.html#position)。*

# xml - 如何匹配元素及其包含的所有属性？

> ID：13997411
> 
> 赞同：1
> 
> 时间：2012-12-21T21:25:58.343
> 
> 标签：xml, xpath

这是我的示例 XML。

```
<root>
  <para indent="yes">First paragraph</para>
  <para indent="no">Second paragraph</para>
  <para indent="yes" level="1">Third paragraph</para>
  <para indent="no" level="2">`Fourth paragraph</para>
</root> 
```

在 altova 中，我可以匹配所有标签（使用`//para`），这给了我结果：

```
para First paragraph 
para Second paragraph
para Third paragraph
para Fourth paragraph 
```

或者我可以匹配 para ( using `//para/@*` ) 的所有属性，这给了我结果：

```
indent yes
indent no
indent yes
level 1
indent no
level 2 
```

但我想组合这些 xpath 并获得以下期望的结果：

```
para Paragraph 1
indent yes
para Paragraph 2
indent no
para Paragraph 3
indent yes
level 1
para Paragraph 4
indent no
level 2 
```

是否有一个 xpath 可以在 altova 或氧气中给我这个结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:35:57.750

您可以在两个选择器之间使用联合：

```
//para|//para/@* 
```

工作示例：[http ://chris.photobooks.com/xml/default.htm?state=Ag](http://chris.photobooks.com/xml/default.htm?state=Ag)

# java - OSGI/SPRING - 将非源文件夹添加到运行时环境

> ID：13997413
> 
> 赞同：0
> 
> 时间：2012-12-21T21:26:15.650
> 
> 标签：java, spring, eclipse-plugin, osgi, eclipse-rcp

我正在运行一个基于包的项目（在 eclipse rcp 中）。在特定的包中，由于基于 jar 的库代码，我需要访问文件夹。所以在实践中，我的要求是在我的项目中有一个包含配置文件的特定文件夹。如果我将我的项目作为普通的 java 应用程序进行测试，一切都运行顺利，但是当我尝试在 osgi 中运行它时，它会失败，因为它找不到文件夹。如何将文件夹添加到运行时环境？我试图添加到捆绑包的运行时类路径配置中，但这并不能解决我的问题。

我的捆绑清单。我正在尝试添加 config/ 文件夹。

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: net.beaconcontroller.datastore
Bundle-SymbolicName: net.beaconcontroller.datastore
Bundle-Version: 1.0.0.qualifier
Bundle-RequiredExecutionEnvironment: JavaSE-1.6
Export-Package: net.beaconcontroller.datastore
Bundle-ClassPath: .,
 lib/bft-smart-hashserver.jar,
 config/ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:45:10.273

打开清单编辑器，选择构建并检查二进制构建视图中的文件夹，以便在导出插件时将其包含在内。

那么很可能您不会正确加载捆绑/插件资源，这需要与常规 java 应用程序不同的方式完成。这是一个代码示例，试一试，让我知道它是否有效。

```
public static String loadResourceAsString(String pluginId,
        String resourcePath) throws IOException {
    Bundle bundle = Platform.getBundle(pluginId);
    URL url = bundle.getResource(resourcePath);
    BufferedReader in = new BufferedReader(new InputStreamReader(
            url.openStream()));
    StringBuilder builder = new StringBuilder();
    String inputLine;
    while ((inputLine = in.readLine()) != null) {
        builder.append(inputLine + System.getProperty("line.separator"));
    }
    in.close();
    return builder.toString();
} 
```

# php - Facebook Graph - 无法在 while 循环中检索性别信息

> ID：13997414
> 
> 赞同：0
> 
> 时间：2012-12-21T21:26:24.387
> 
> 标签：php, facebook, json, facebook-graph-api

我正在使用 Facebook Graph API 从 Facebook 用户列表中获取性别。我有用户的 ID（他们是我的应用程序的当前用户）。为此，我不需要使用 API，因为性别不需要特殊权限（即使我已经获得了基本信息权限）。基本上，我使用while循环来遍历MySQL表上的所有行，该表存储了我在用户使用应用程序时抓取的FB id。当我在 while 循环之外执行 json_decode 代码时，效果很好（但显然只抓取了表中的第一个实例）。然后当我把它放在一个循环中时，页面就不会加载。它只是坐着并试图永远加载。这是代码：

```
$sql = "SELECT * FROM fb_id ORDER BY timestamp DESC";
$result = $mysqli->query($sql);                     

while($row = mysqli_fetch_array($result)){
                    $jsonurl = "https://graph.facebook.com/".$row['fb_id'];
                    $json = file_get_contents($jsonurl,0,null,null);
                    $json_output = json_decode($json);
                    $user_gender = $json_output->gender;
                    echo $user_gender;
                    }

                    while($row = mysqli_fetch_array($result)){
                    echo "<a href='http://www.facebook.com/".$row['fb_id']."' target='_blank'><img src='http://graph.facebook.com/".$row['fb_id']."/picture/' /></a>";
                    } 
```

您会看到代码的顶部是针对性别的。底部循环是显示用户的个人资料图片。那个底部循环工作正常。

任何想法为什么对 Facebook Graph 的调用会卡住？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:19:01.103

> 底部循环是显示用户的个人资料图片。那个底部循环工作正常。

底部循环也是如此。

> 任何想法为什么对 Facebook Graph 的调用会卡住？

Graph API 很好，不用担心。

您正在对数据库查询结果进行一次循环，以获取用户详细信息并回显他们的性别。

之后，数据库查询结果结束，不再需要获取任何行。

这使得第二个`while`循环的条件成为`false`第一次检查，因此循环内容甚至不会执行一次。

你为什么要在那里放第二个while循环？您正在访问与第一个循环中相同的列值 - 那么为什么不将两个代码块的内容放在*一个*关键字之后的一个代码块中*呢？* *`while`*

# autotools - 自动工具用户如何指定静态和动态链接的组合？

> ID：13997415
> 
> 赞同：13
> 
> 时间：2012-12-21T21:26:33.493
> 
> 标签：autotools, static-linking, dynamic-linking, libtool

我正在用 autoconf、automake 和 libtool 构建一个程序。我的工作要求我静态链接（大多数）库。这在过去不是问题，因为我可以将所有内容与 `-all-static`. 现在这是一个问题，因为我必须使用一个只有动态的库；它是由第三方提供给我们的，我们没有来源。

当然，`-all-static`now 会导致构建失败。是否可以告诉 libtool 静态链接除这个库之外的所有内容？是否有可能让 libtool 进行静态和动态链接的任何组合，或者是全部还是全部？

到目前为止，我已经尝试使用 . 创建一个便利库`LDFLAGS = -static`，这取决于我要静态链接的库。但是 libtool 并没有像我希望的那样连接静态库。依赖于便利库的程序仍然动态链接所有内容。

我也试过`--disable-shared`了，但这并不影响构建。

* * *

这些问题很相似，但并没有真正回答我的问题：

[使用 Libtool 强制将静态库链接到共享库](https://stackoverflow.com/questions/10842949/force-linking-a-static-library-into-a-shared-one-with-libtool)

[是否可以使用 libtool 静态链接一些（但不是全部）库？](https://stackoverflow.com/questions/1943834/is-it-possible-to-link-some-but-not-all-libraries-statically-with-libtool)

（我不想从我的系统中删除共享库，并且为所有内容指定完整路径几乎不比手动链接好，但也许这是唯一的方法。）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-25T03:45:52.893

您没有指定操作系统，但让我们假设它是相对较新的 Unix/Linux/OSX。如果不是，则忽略以下警告。

在我回答之前，您应该知道在大多数基于 ELF 的系统（Unix/Linux）上混合静态代码和共享代码是有问题的。一个原因是，如果您忘记重新链接更新的依赖项，可能会导致代码不同步。另一个是由于静态代码与[PIC](http://en.wikipedia.org/wiki/Position-independent_code)的性质。这就是 libtool 试图阻止它的原因。

话虽如此，在 Makefile.am 中（假设您的最终程序是`foo`并且共享库是）：

```
 .
    .
    .
    foo_SOURCES = foo.c abc.c def.c hij.c
    foo_LDFLAGS = -all-static -Wl,-Bdynamic,-L/path/to,-lshared,-Bstatic
    foo_LDADD = -L../path/to -lbar -lbaz 
```

这里重要的是 libtool 允许您通过将参数直接传递给链接器 (GNU ld)来缩短检查和 GNU gcc 的`-static`标志（由 libtool 使用）。`-Wl,`要在参数之间放置空格，请使用逗号`,`分隔符。

两者`-Bstatic`和`-Bdynamic`都记录在 GNU ld 的[信息页面](http://sourceware.org/binutils/docs-2.23.1/ld/Options.html#Options)以及帮助屏幕中。同样，由于您没有提到正在使用的 os 或编译器包，我假设在 Linux 上使用 GNU gcc 和 GNU ld。您可能需要使用`ld --help`to see for yourself 来验证。如果由于某种原因它不是 GNU ld，那么您将需要找到与 and 等效的标志，`-Bstatic`并`-Bdynamic`在适当的地方进行替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-02T19:14:55.483

就我而言，我想`labA`静态链接，但`pthread`动态链接。如果我添加`libA`到`Makefile.am`as

```
my_proc_LDADD = -Wl,-Bstatic -lA -Wl,-Bdynamic 
```

然后`ldd`无法链接`libA`。 `libA`应该指定 in `LDADD`，但 autotools 不允许这样做。

如果我添加到`Makefile.am` `LDADD`评论

```
#my_proc_LDADD = -Wl,-Bstatic -lA -Wl,-Bdynamic 
```

然后它也会`Makefile`作为注释添加到结果中所以我只是在`configure`脚本之后取消注释这个字符串：

```
./configure
sed -i -e 's/#my_proc_LDADD/my_proc_LDADD/g' ./src/Makefile
make 
```

结果，静态链接`libA`被附加到`LDADD`

# breeze - 显式检索metdataStore

> ID：13997418
> 
> 赞同：1
> 
> 时间：2012-12-21T21:26:59.553
> 
> 标签：breeze

我有一个视图模型，它总是会创建一个新实体（分数）；它不需要等待也不需要查询存储库来知道这一点。

我（当前）想在页面加载时创建新实体并使用它来填充（KnockoutJS）视图模型。

我相信实体管理器懒惰地填充元数据并通过进行不必要的查询来欺骗我想要的行为，纯粹是为了强制元数据填充。API 文档没有涵盖这一点：

[http://www.breezejs.com/sites/all/apidocs/classes/EntityManager.html#property_metadataStore](http://www.breezejs.com/sites/all/apidocs/classes/EntityManager.html#property_metadataStore)

**问题** 有没有办法强制管理器在不发出冗余查询的情况下填充元数据？

这是为了显示其意图而展平的欺骗代码：

```
manager.executeQuery(redundantQuery).then(function(data) {
  var viewScore = manager.metadataStore.getEntityType("Score").createEntity();
  viewScore.ID(breeze.core.getUuid());
  viewScore.Value(57);
  ko.applyBindings(viewScore, $ViewScore);
}).fail(function(e){
  ...
}) 
```

我会很高兴：

```
manager.metadataStore.then(function() {

})... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:29:24.343

好的，吸取教训....在询问之前尝试一下。

这实际上有效：

```
manager.metadataStore.fetchMetadata(manager.dataService).then(function () {
  var viewScore = manager.metadataStore.getEntityType("Score").createEntity();
  viewScore.ID(breeze.core.getUuid());
  viewScore.Value(57);
  ko.applyBindings(viewScore, $ViewScore);
}).fail(function (e) {
  ...
}); 
```

我剩下的唯一问题是为什么需要传递 manager.dataService？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T21:50:51.633

单个 MetadataStore 可以存储多个 DataService 的元数据。manager.dataService 只是 EntityManager 的“默认”DataService，可能还有其他的。

# ssl - KeyStore 和 KeyManager/TrustManager 的区别

> ID：13997419
> 
> 赞同：21
> 
> 时间：2012-12-21T21:26:58.973
> 
> 标签：ssl, httpclient, keystore, truststore

将 KeyStore 对象用于密钥库和信任库有什么区别？而不是使用 KeyManager 和 TrustManager？

让我解释一下我为什么要问。我正在使用 RESTEasy，需要使用 SSL 证书通过 HTTPS 进行 REST 调用。我需要增强 RESTEasy 创建 ClientRequest 的方式。这是我最初想到的：

```
public void afterPropertiesSet() throws Exception {
    Assert.isTrue(StringUtils.isNotBlank(getKeystoreName()), "Key Store Name is Blank");
    Assert.isTrue(StringUtils.isNotBlank(getKeystorePassword()), "Key Store Password is Blank.");
    Assert.isTrue(StringUtils.isNotBlank(getKeystorePath()), "Key Store Path is Blank");
    Assert.isTrue(StringUtils.isNotBlank(getTruststoreName()), "Trust Store Name is Blank");
    Assert.isTrue(StringUtils.isNotBlank(getTruststorePassword()), "Trust Store Password is Blank.");
    Assert.isTrue(StringUtils.isNotBlank(getTruststorePath()), "Trust Store Path is Blank");

    // Set the keystore and truststore for mutual authentication
    createKeystore();
    createTruststore();

    if (getHttpClient() == null) {
        // Initialize HTTP Client
        initializeHttpClient();
    }

    Assert.notNull(getHttpClient(), "HTTP Client is NULL after initialization");
}

public ClientRequest createClientRequest(String uri) throws URISyntaxException {
    ClientExecutor clientExecutor = new ApacheHttpClient4Executor(getHttpClient());
    ClientRequestFactory fac = new ClientRequestFactory(clientExecutor, new URI(uri));
    return fac.createRequest(uri);
}

private void createTruststore() throws KeyStoreException, FileNotFoundException, IOException,
        NoSuchAlgorithmException, CertificateException {

    String truststoreFilePath = getTruststorePath() + getTruststoreName();

    KeyStore truststore = KeyStore.getInstance(KeyStore.getDefaultType());
    InputStream truststoreInput = getClass().getClassLoader().getResourceAsStream(truststoreFilePath);
    truststore.load(truststoreInput, getTruststorePassword().toCharArray());
}

private void createKeystore() throws KeyStoreException, FileNotFoundException, IOException,
        NoSuchAlgorithmException, CertificateException {

    String keystoreFilePath = getKeystorePath() + getKeystoreName();
    KeyStore keystore = KeyStore.getInstance(KeyStore.getDefaultType());
    InputStream keystoreInput = getClass().getClassLoader().getResourceAsStream(keystoreFilePath);
    keystore.load(keystoreInput, getKeystorePassword().toCharArray());
}

/**
 * Initializes the HTTP Client
 * 
 * @throws KeyStoreException
 * @throws NoSuchAlgorithmException
 * @throws UnrecoverableKeyException
 * @throws KeyManagementException
 */
private void initializeHttpClient() throws KeyManagementException, UnrecoverableKeyException,
        NoSuchAlgorithmException, KeyStoreException {

    // Register https and http with scheme registry
    SchemeRegistry schemeRegistry = new SchemeRegistry();
    SSLSocketFactory sslSocketFactory = new SSLSocketFactory(getKeystore(), getKeystorePassword(), getTrustStore());
    schemeRegistry.register(new Scheme(HTTP, 80, PlainSocketFactory.getSocketFactory()));
    schemeRegistry.register(new Scheme(HTTPS, 443, sslSocketFactory));

    // Set connection params
    HttpConnectionParams.setConnectionTimeout(httpParameters, serviceConnectionTimeout);
    HttpConnectionParams.setSoTimeout(httpParameters, readTimeout);
    HttpConnectionParams.setStaleCheckingEnabled(httpParameters, true);

    // Create Connection Manager
    PoolingClientConnectionManager clientManager = new PoolingClientConnectionManager(schemeRegistry);
    clientManager.setMaxTotal(maxTotalConnections);
    clientManager.setDefaultMaxPerRoute(defaultMaxConnectionsPerHost);

    httpClient = new DefaultHttpClient(clientManager, httpParameters);
} 
```

我遇到了对等证书的问题并不断收到异常：

> javax.net.ssl.SSLPeerUnverifiedException：对等体未通过身份验证

然后我四处搜索，发现有关设置 HttpClient 但使用 TrustManager 和 KeyManager 的文章/博客。我重构了代码以执行以下操作：

```
public void afterPropertiesSet() throws Exception {
    Assert.isTrue(StringUtils.isNotBlank(getKeystoreName()), "Key Store Name is Blank");
    Assert.isTrue(StringUtils.isNotBlank(getKeystorePassword()), "Key Store Password is Blank.");
    Assert.isTrue(StringUtils.isNotBlank(getKeystorePath()), "Key Store Path is Blank");
    Assert.isTrue(StringUtils.isNotBlank(getTruststoreName()), "Trust Store Name is Blank");
    Assert.isTrue(StringUtils.isNotBlank(getTruststorePassword()), "Trust Store Password is Blank.");
    Assert.isTrue(StringUtils.isNotBlank(getTruststorePath()), "Trust Store Path is Blank");

    if (getHttpClient() == null) {
        // Initialize HTTP Client
        initializeHttpClient();
    }

    Assert.notNull(getHttpClient(), "HTTP Client is NULL after initialization");
}

public ClientRequest createClientRequest(String uri) throws URISyntaxException {
    ClientExecutor clientExecutor = new ApacheHttpClient4Executor(getHttpClient());
    ClientRequestFactory fac = new ClientRequestFactory(clientExecutor, new URI(uri));
    return fac.createRequest(uri);
}

/**
 * Initializes the HTTP Client
 * 
 * @throws KeyStoreException
 * @throws NoSuchAlgorithmException
 * @throws UnrecoverableKeyException
 * @throws KeyManagementException
 */
private void initializeHttpClient() throws Exception {

    if (isCheckPeerCertificates()) {
        checkPeerCerts();
    }

    // Create Trust and Key Managers
    // Use TrustManager and KeyManager instead of KeyStore
    TrustManager[] trustManagers = getTrustManagers(getTruststorePassword());
    KeyManager[] keyManagers = getKeyManagers(getKeystorePassword());

    // Create SSL Context
    SSLContext ctx = SSLContext.getInstance("TLS");
    ctx.init(keyManagers, trustManagers, new SecureRandom());

    // Create SSL Factory
    SSLSocketFactory sslSocketFactory = new SSLSocketFactory(ctx, SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);

    // Register https and http with scheme registry
    SchemeRegistry schemeRegistry = new SchemeRegistry();
    schemeRegistry.register(new Scheme(HTTP, 80, PlainSocketFactory.getSocketFactory()));
    schemeRegistry.register(new Scheme(HTTPS, 443, sslSocketFactory));

    // Set connection params
    HttpConnectionParams.setConnectionTimeout(httpParameters, serviceConnectionTimeout);
    HttpConnectionParams.setSoTimeout(httpParameters, readTimeout);
    HttpConnectionParams.setStaleCheckingEnabled(httpParameters, true);

    // Create Connection Manager
    PoolingClientConnectionManager clientManager = new PoolingClientConnectionManager(schemeRegistry);
    clientManager.setMaxTotal(maxTotalConnections);
    clientManager.setDefaultMaxPerRoute(defaultMaxConnectionsPerHost);

    httpClient = new DefaultHttpClient(clientManager, httpParameters);
}

private TrustManager[] getTrustManagers(String trustStorePassword) throws Exception {
    String truststoreFilePath = getTruststorePath() + getTruststoreName();
    InputStream trustStoreInput = getClass().getClassLoader().getResourceAsStream(truststoreFilePath);
    KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
    trustStore.load(trustStoreInput, trustStorePassword.toCharArray());
    TrustManagerFactory tmfactory = TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmfactory.init(trustStore);
    return tmfactory.getTrustManagers();
}

private KeyManager[] getKeyManagers(String keyStorePassword) throws Exception {
    String keystoreFilePath = getKeystorePath() + getKeystoreName();
    InputStream keyStoreInput = getClass().getClassLoader().getResourceAsStream(keystoreFilePath);
    KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());
    keyStore.load(keyStoreInput, keyStorePassword.toCharArray());
    KeyManagerFactory kmfactory = KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    kmfactory.init(keyStore, keyStorePassword.toCharArray());
    return kmfactory.getKeyManagers();
} 
```

第二个代码工作得很好。那么，这两种用法有什么区别呢？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-11-14T21:09:42.567

我认为这可以帮助您： [Java 中 trustStore 和 keyStore 之间的区别 - SSL](http://javarevisited.blogspot.com/2012/09/difference-between-truststore-vs-keyStore-Java-SSL.html)

> trustStore 和 keyStore 之间的第一个也是主要的区别是 trustStore 由 TrustManager 使用，而 keyStore 由 Java 中的 KeyManager 类使用。KeyManager 和 TrustManager 在 Java 中执行不同的工作，TrustManager 确定远程连接是否应该被信任，即远程方是否是它声称的对象，而 KeyManager 决定在 SSL 握手期间应该将哪些身份验证凭据发送到远程主机进行身份验证。如果您是 SSL 服务器，您将在密钥交换算法期间使用私钥并将与您的公钥对应的证书发送给客户端，该证书是从 keyStore 获取的。在 SSL 客户端，如果它是用 Java 编写的，它将使用存储在 trustStore 中的证书来验证服务器的身份。

阅读更多：JavaRevisited 博客：[http](http://javarevisited.blogspot.com/2012/09/difference-between-truststore-vs-keyStore-Java-SSL.html) ://javarevisited.blogspot.com/2012/09/difference-between-truststore-vs-keyStore-Java-SSL.html （存档[在这里](https://archive.li/hVcuK)。）

# objective-c - SQLite 查询不返回结果

> ID：13997420
> 
> 赞同：1
> 
> 时间：2012-12-21T21:27:05.210
> 
> 标签：objective-c, sqlite

我正在从 xcode 运行以下查询。但是，它没有返回任何结果。我很确定它应该返回结果，并且可以通过从 sqlite 浏览器运行相同的查询来确认相同的结果。然而，在 xcode 中， sqlite3_step 返回代码 101。我在这里做错了什么？

```
 NSMutableArray *pages = [[NSMutableArray alloc] init];

    char *query = " \
    drop table if exists tempT; \
    \
    create temporary table tempT \
    as \
    select \
    Page \
    from \
    ( \
     select 1 as Sort, 'Home' as Page \
     union \
     select 2 as Sort, 'Research' as Page \
     union \
     select distinct 3 as Sort, Category as Page from Researches \
     union \
     select 4 as Sort, 'Drafts' as Page \
     union \
     select 5 as Sort, 'Outbox' as Page \
     union \
     select 6 as Sort, 'Download' as Page \
     union \
     select 7 as Sort, 'Settings' as Page \
     union \
     select 8 as Sort, 'Deleted' as Page \
     ) as Sub \
    ORDER BY Sort, Page \
    ; \
     \
    select Page from tempT order by rowid \
    ";
    sqlite3_stmt *stmt;
    if (sqlite3_prepare_v2(database, query, -1, &stmt, nil) == SQLITE_OK)
    {
        while (sqlite3_step(stmt) == SQLITE_ROW)
        {
            [pages addObject: [NSString stringWithUTF8String: (char *)sqlite3_column_text(stmt, 0)]];
        }

        sqlite3_finalize(stmt);
    }

    return pages; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T02:41:14.830

`sqlite3_prepare_v2`只准备第一条语句，您必须分别运行 3 条语句。

见：[http ://www.sqlite.org/c3ref/prepare.html](http://www.sqlite.org/c3ref/prepare.html)

> 如果 pzTail 不为 NULL，则 *pzTail 指向 zSql 中第一个 SQL 语句末尾之后的第一个字节。这些例程只编译 zSql 中的第一条语句，因此 *pzTail 指向未编译的内容。

# sql - 在日期（没有时间）上处理 SQL 查询的最佳方法是什么？

> ID：13997423
> 
> 赞同：2
> 
> 时间：2012-12-21T21:27:32.487
> 
> 标签：sql, sql-server, datetime, ado.net

我们的数据库中有日期列，它们只是一天——比如出生日期。但是，SQL Server 将它们存储为日期和时间，并且记录中的时间具有各种值（不知道它是如何以这种方式结束的）。

问题是人们将对所有人运行查询，`birthdates <= {some date}`并且不会返回相等的查询，因为`DateTime`（使用 ADO.NET）设置为给定日期的时间为午夜。

我明白发生了什么事。问题是如何最好地处理这个问题。我们可以强制在 23:23:59.999999999 的时间到日期，但这感觉会有问题。

处理此问题的标准最佳做法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T21:32:23.777

只需将 1 天添加到 {some_date} 并使用小于比较。确保是第二天凌晨 12 点...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:45:43.203

如果您需要经常查询，我可能会添加一个计算的、持久的列，将您转换`DATETIME`为一个`DATE`（假设您使用的是 SQL Server **2008**或更高版本）：

```
ALTER TABLE dbo.YourTableName
ADD JustDay AS CAST(YourDateTimeColumn AS DATE) PERSISTED 
```

这样，您现在可以查询`JustDay`，这只是一个`DATE`- 不涉及时间部分。既然是计算出来的，就不需要经常更新了；SQL Server 会自动为您执行此操作。由于它是持久化的，它是表的磁盘结构的一部分，并且与对任何其他列的查询一样快 - 如果需要，它甚至可以被索引。

这是一个经典的*空间与速度*的权衡——因为你现在也存储了所有生日的仅日期部分，你的磁盘结构会更大；另一方面，由于您有一个很好的、可索引的仅日期列，因此您有一个加快搜索速度的好方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T13:08:30.387

你说

> 问题是人们会查询所有的生日 <= {some date}

您可以保持原样，并确保人们通过在他们的`WHERE`条款中使用类似以下内容来摆脱时间：

```
CONVERT(DATETIME,CONVERT(CHAR(8),birthdates,112))<= {some date} 
```

..或在更高版本的 SQL-Server 中：

```
CONVERT(DATE,birthdates)<= {some date} 
```

但这是一种解决方法，最好采用其他建议并摆脱实际目标数据中的时间。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T21:37:37.160

另一种选择是：

```
DATEDIFF(d, birthdates, {some date}) <= 0 
```

# java - HtmlUnit 仅显示 GWT 应用程序的主机 HTML 页面

> ID：13997424
> 
> 赞同：5
> 
> 时间：2012-12-21T21:27:37.123
> 
> 标签：java, gwt, web-crawler, htmlunit

我正在使用 HtmlUnit API 为我的 GWT 应用程序添加爬虫支持，如下所示：

```
PrintWriter out = null;
try {
    resp.setCharacterEncoding(CHAR_ENCODING);
    resp.setContentType("text/html");

    url = buildUrl(req);
    out = resp.getWriter();

    WebClient webClient = webClientProvider.get();

    // set options
    WebClientOptions options = webClient.getOptions();
    options.setCssEnabled(false);
    options.setThrowExceptionOnScriptError(false);
    options.setThrowExceptionOnFailingStatusCode(false);
    options.setRedirectEnabled(true);
    options.setJavaScriptEnabled(true);

    // set timeouts
    webClient.setJavaScriptTimeout(0);
    webClient.waitForBackgroundJavaScript(20000);

    // ajax controller
    webClient.setAjaxController(new NicelyResynchronizingAjaxController());

    // render page
    HtmlPage page = webClient.getPage(url);

    webClient.getJavaScriptEngine().pumpEventLoop(timeoutMillis);

    out.println(page.asXml());

    webClient.closeAllWindows();
}
... 
```

然而; 仅生成我的 GWT 应用程序的纯 HTML 主机页面并将其发送到客户端。

* * *

**更新：**这是 Chrome DevTools 的输出：

```
Request URL:http://127.0.0.1:8888/MyApp.html?gwt.codesvr=127.0.0.1:9997&_escaped_fragment_=myobject%3Bid%3D507ac730e4b0e3b7a73b1b81
Request Method:GET
Status Code:200 OK
Request Headersview source
Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-GB,en-US;q=0.8,en;q=0.6
Cache-Control:max-age=0
Connection:keep-alive
Cookie:__utma=96992031.428505342.1351707614.1351707614.1356355174.2; __utmb=96992031.1.10.1356355174; __utmc=96992031; __utmz=96992031.1351707614.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
Host:127.0.0.1:8888
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11
Query String Parametersview URL encoded
gwt.codesvr:127.0.0.1:9997
_escaped_fragment_:myobject;id=507ac730e4b0e3b7a73b1b81
Response Headersview source
Content-Type:text/html; charset=utf-8
Server:Jetty(6.1.x)
Transfer-Encoding:chunked 
```

**为什么不执行 GWT 代码？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-23T16:44:30.217

在我最终让它工作之前，我不得不尝试许多变体。一个关键是留出足够的时间让 javascript 完全运行。但是还有一些其他的细节我不记得了——你可以在我的过滤器版本下面找到似乎对我有用的，看看我设置的参数，有些是让这个东西工作的关键。除了取决于要执行的代码（以及服务器快速运行它的能力）的计时器参数之外，它非常通用，所以我不明白为什么谷歌不一劳永逸地打包这样的功能！

```
/**
 * Special URL token that gets passed from the crawler to the servlet filter.
 * This token is used in case there are already existing query parameters.
 */
private static final String ESCAPED_FRAGMENT_FORMAT1 = "_escaped_fragment_=";
private static final int ESCAPED_FRAGMENT_LENGTH1 = ESCAPED_FRAGMENT_FORMAT1.length();
/**
 * Special URL token that gets passed from the crawler to the servlet filter.
 * This token is used in case there are not already existing query parameters.
 */
private static final String ESCAPED_FRAGMENT_FORMAT2 = "&"+ESCAPED_FRAGMENT_FORMAT1;
private static final int ESCAPED_FRAGMENT_LENGTH2 = ESCAPED_FRAGMENT_FORMAT2.length();

private class SyncAllAjaxController extends NicelyResynchronizingAjaxController
{
  private static final long serialVersionUID = 1L;
  @Override
  public boolean processSynchron(HtmlPage page, WebRequest request, boolean async)
  {
      return true;
  }
}

private WebClient webClient = null;

private static final long _pumpEventLoopTimeoutMillis = 200;
private static final long _jsTimeoutMillis = 200;
private static final long _pageWaitMillis = 100;
final int _maxLoopChecks = 2;

public void destroy()
{
  if (webClient != null)
    webClient.closeAllWindows();
}

public void doFilter(ServletRequest request, ServletResponse response, FilterChain filterChain)
    throws IOException, ServletException
{
  // Grab the request uri and query strings.
  final HttpServletRequest httpRequest = (HttpServletRequest) request;
  final String requestURI = httpRequest.getRequestURI();
  final String queryString = httpRequest.getQueryString();
  final HttpServletResponse httpResponse = (HttpServletResponse) response;

  if ((queryString != null) && (queryString.contains(ESCAPED_FRAGMENT_FORMAT1)))
  {
    // This is a Googlebot crawler request, let's return a static indexable html page
    // post javascript execution, as rendered in the browser.

    final String domain = httpRequest.getServerName();
    final int port = httpRequest.getServerPort();

    // Rewrite the URL back to the original #! version
    //   -- basically remove _escaped_fragment_ from the query. 
    // Unescape any %XX characters as need be.
    final String urlStringWithHashFragment = requestURI + rewriteQueryString(queryString);
    final String protocol = httpRequest.getProtocol();
    final URL urlWithHashFragment = new URL(protocol, domain, port, urlStringWithHashFragment);
    final WebRequest webRequest = new WebRequest(urlWithHashFragment);

    // Use the headless browser to obtain an HTML snapshot.
    webClient = new WebClient(BrowserVersion.FIREFOX_3_6);
    webClient.getCache().clear();
    webClient.setJavaScriptEnabled(true);
    webClient.setThrowExceptionOnScriptError(false);
    webClient.setRedirectEnabled(false);
    webClient.setAjaxController(new SyncAllAjaxController());
    webClient.setCssErrorHandler(new SilentCssErrorHandler());

    if (_logger.isInfoEnabled())
      _logger.info("HtmlUnit starting webClient.getPage(webRequest) where webRequest = " + webRequest.toString());
    final HtmlPage page = webClient.getPage(webRequest);

    // Important!  Give the headless browser enough time to execute JavaScript
    // The exact time to wait may depend on your application.

    webClient.getJavaScriptEngine().pumpEventLoop(_pumpEventLoopTimeoutMillis);

    int waitForBackgroundJavaScript = webClient.waitForBackgroundJavaScript(_jsTimeoutMillis);
    int loopCount = 0;
    while (waitForBackgroundJavaScript > 0 && loopCount < _maxLoopChecks)
    {
      ++loopCount;
      waitForBackgroundJavaScript = webClient.waitForBackgroundJavaScript(_jsTimeoutMillis);
      if (waitForBackgroundJavaScript == 0)
      {
        if (_logger.isTraceEnabled())
          _logger.trace("HtmlUnit exits background javascript at loop counter " + loopCount);
        break;
      }
      synchronized (page) 
      {
        if (_logger.isTraceEnabled())
            _logger.trace("HtmlUnit waits for background javascript at loop counter " + loopCount);
        try
        {
          page.wait(_pageWaitMillis);
        }
        catch (InterruptedException e)
        {
          _logger.error("HtmlUnit ERROR on page.wait at loop counter " + loopCount);
          e.printStackTrace();
        }
      }
    }
    webClient.getAjaxController().processSynchron(page, webRequest, false);
    if (webClient.getJavaScriptEngine().isScriptRunning())
    {
      _logger.warn("HtmlUnit webClient.getJavaScriptEngine().shutdownJavaScriptExecutor()");
      webClient.getJavaScriptEngine().shutdownJavaScriptExecutor();
    }

    // Return the static snapshot.
    final String staticSnapshotHtml = page.asXml();
    httpResponse.setContentType("text/html;charset=UTF-8");
    final PrintWriter out = httpResponse.getWriter();
    out.println("<hr />");
    out.println("<center><h3>Page non-interactive pour le crawler.");
    out.println("La page interactive est: <a href=\""
        + urlWithHashFragment
        + "\">"
        + urlWithHashFragment + "</a></h3></center>");
    out.println("<hr />");
    out.println(staticSnapshotHtml);
    // Close web client.
    webClient.closeAllWindows();
    out.println("");
    out.flush();
    out.close();
    if (_logger.isInfoEnabled())
      _logger.info("HtmlUnit completed webClient.getPage(webRequest) where webRequest = " + webRequest.toString());
  }
  else
  {
    if (requestURI.contains(".nocache."))
    {
      // Ensure the gwt nocache bootstrapping file is never cached.
      // References:
      //   http://stackoverflow.com/questions/4274053/how-to-clear-cache-in-gwt
      //   http://seewah.blogspot.com/2009/02/gwt-tips-2-nocachejs-getting-cached-in.html
      // 
      final Date now = new Date();
      httpResponse.setDateHeader("Date", now.getTime());
      httpResponse.setDateHeader("Expires", now.getTime() - 86400000L); // One day old.
      httpResponse.setHeader("Pragma", "no-cache");
      httpResponse.setHeader("Cache-control", "no-cache, no-store, must-revalidate");
    }

    filterChain.doFilter(request, response);
  }
}

/**
 * Maps from the query string that contains _escaped_fragment_ to one that
 * doesn't, but is instead followed by a hash fragment. It also unescapes any
 * characters that were escaped by the crawler. If the query string does not
 * contain _escaped_fragment_, it is not modified.
 * 
 * @param queryString
 * @return A modified query string followed by a hash fragment if applicable.
 *         The non-modified query string otherwise.
 * @throws UnsupportedEncodingException
 */
private static String rewriteQueryString(String queryString)
    throws UnsupportedEncodingException
{
  // Seek the escaped fragment.
  int index = queryString.indexOf(ESCAPED_FRAGMENT_FORMAT2);
  int length = ESCAPED_FRAGMENT_LENGTH2;
  if (index == -1)
  {
    index = queryString.indexOf(ESCAPED_FRAGMENT_FORMAT1);
    length = ESCAPED_FRAGMENT_LENGTH1;
  }
  if (index != -1)
  {
    // Found the escaped fragment, so build back the original decoded one.
    final StringBuilder queryStringSb = new StringBuilder();
    // Add url parameters if any.
    if (index > 0)
    {
      queryStringSb.append("?");
      queryStringSb.append(queryString.substring(0, index));
    }
    // Add the hash fragment as a replacement for the escaped fragment.
    queryStringSb.append("#!");
    // Add the decoded token.
    final String token2Decode = queryString.substring(index + length, queryString.length());
    final String tokenDecoded = URLDecoder.decode(token2Decode, "UTF-8");
    queryStringSb.append(tokenDecoded);
    return queryStringSb.toString();
  }
  return queryString;
} 
```

# c# - 两个版本的 C# 应用程序之间的 COM 问题

> ID：13997431
> 
> 赞同：2
> 
> 时间：2012-12-21T21:28:07.320
> 
> 标签：c#, com

我没有与 COM 合作太多，所以请原谅我的无知。

背景：我正在开发 VS 2010 中的一个项目。C# 解决方案中集成了一个 C# COM DLL，还有一个安装/部署项目 - 安装项目设置为在安装时注册 COM .tlb 文件。

问题：当有人决定安装最新版本的 C# 应用程序并因此安装最新的 COM DLL 时，PC 上存在 C# 应用程序的早期版本及其 COM DLL。发生这种情况时，它破坏了 C# 应用程序的两个版本的 COM 功能。或者这就是我假设发生的情况。

这是典型的 COM/DLL 地狱行为吗？当两个 C# 应用程序都被卸载，然后只重新安装一个，一切都恢复正常 - 显然不能同时安装。

我已经尝试更改 COM DLL 项目的 GUID，更改 COM DLL 项目的 AssemblyVersion 和 AssemblyFileVersion - 所有这些都具有不同的结果。当我更改这些项目时，应用程序的新安装工作（很好），但现在旧的 C# 应用程序没有工作功能。

注意：当 COM 功能失败时不会引发错误或异常 - COM 调用似乎什么都不做。所以它“默默地”失败了。

我一直在研究这个并尝试进行各种修改，但没有真正成功……也许我想错了。还有其他人对此有更多经验可以给我一些见解吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:41:09.967

您可以使用合并模块来安装 com 对象及其后续版本。这将允许您在同一台机器上拥有多个版本。来自微软：

> 合并模块就像组件特定版本的快照。应该为组件的每个后续版本创建一个新的合并模块，以避免版本冲突。

查看此链接：[安装程序与合并模块建议](http://msdn.microsoft.com/en-us/library/y0w2est5%28v=vs.90%29.aspx)

# encryption - ColdFusion 的 CFMX_COMPAT 加密算法

> ID：13997434
> 
> 赞同：4
> 
> 时间：2012-12-21T21:28:27.227
> 
> 标签：encryption, coldfusion

在查看一些旧的冷融合代码时，我发现了几个使用 CFMX_COMPAT 算法通过加密/解密函数加密的数据实例。

搜索了一段时间后，我一直无法找到这是一种什么样的算法。文档提到它现在是最不安全的方法，但我想知道为什么会这样。

（其他地方的一些人建议它只是 MD5，但这并没有多大意义，因为数据正在被解密。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T22:54:34.260

它是一种基于 XOR**的**算法，但不是教科书式的，因此一揽子 XOR 算法的答案是不正确的（过去错误地应用于这些 CFMX_COMPAT 问题）。

要详细查看此专有 XOR 的源代码，请查看“Compare Password Hashes Between C# and ColdFusion”的[答案](https://stackoverflow.com/a/4627069/850882)，其中@Leigh（他也评论了其中一个问题）帮助提供了算法的准确端口，直接从 Railo 源中提取。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:03:48.200

这是一个简单的异或算法。从技术上讲，它是加密货币，但它是非常、非常、非常、非常、非常弱的加密货币。我应该在里面多放几个“非常”。

据我了解，明文的每一位都与密钥中的下一个字节进行异或运算，结果是密文。

因此，如果我们逐个查看所有内容：

P: 1 0 1 0 1 0 1 0 0 0 1

克：0 0 1 1 1 0 0 1 0 1 0

C: 1 0 0 1 0 0 1 1 0 1 0

P = 明文

K = 键

C = 密文

如果您不熟悉 XOR，它的工作原理如下：

0 异或 0 -> 0

0 异或 1 -> 1

1 异或 0 -> 1

1 异或 1 -> 0

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:42:07.623

它绝对不是 MD5，因为那是一种散列算法，而不是一种加密算法（正如你所指出的）。

我不知道它使用什么算法，但你可以反编译 cfusion.jar 中的相关 Java 类并看看。我怀疑有比这更好的发现方法。我怀疑即使您向 Adob​​e 开一张支持票，他们实际上会告诉您。

# iphone - 更改数据后重新加载自定义单元格时出错

> ID：13997437
> 
> 赞同：0
> 
> 时间：2012-12-21T21:28:47.697
> 
> 标签：iphone, xcode, uitableview, sdk, cell

我有一个设置好的 tableView 工作正常。正如您在下面看到的，当对象@“sent”的值更改为@“yes”时，我想将图像添加到我的单元格中。完成此操作后，我调用 [sendTable reloadData] 但 tableView 没有任何反应。只有当我重新启动应用程序时，我的图像才会正确显示在单元格中。所以显然 reloadData 在这里没有做任何事情。

任何人都可以找出问题所在吗？

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{

UITableViewCell *cell;

if (tableView == sendTable) {

    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@"savedItems.plist"];
    savedItemsArray = [NSMutableArray arrayWithContentsOfFile:writableDBPath];

    NSDictionary* item = [savedItemsArray objectAtIndex:indexPath.row];

    NSString *temp = [NSString stringWithFormat:@"%@,%@", [[savedItemsArray valueForKey:@"name"]objectAtIndex:indexPath.row],
                      [[savedItemsArray valueForKey:@"message"]objectAtIndex:indexPath.row]];

    UIView *background;

    cell = [self.sendTable dequeueReusableCellWithIdentifier:temp];
    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:temp];
        cell.accessoryType = UITableViewCellAccessoryDetailDisclosureButton;
        cell.selectionStyle = UITableViewCellSelectionStyleGray;

        background = [[UIView alloc] initWithFrame:cell.frame];

        [cell addSubview:background];
        [cell sendSubviewToBack:background];

    }

    if ([[item objectForKey:@"sent"] isEqualToString: @"no"]) {

        UILabel *personLabel = [[UILabel alloc]initWithFrame:CGRectMake(10, 10, cell.frame.size.width-150, 20)];
        personLabel.backgroundColor = [UIColor clearColor];
        personLabel.text = [NSString stringWithFormat: @"%@",[item objectForKey:@"name"]];
        personLabel.font = [UIFont boldSystemFontOfSize:17];

        UILabel *personLabel2 = [[UILabel alloc]initWithFrame:CGRectMake(10, 30, cell.frame.size.width-150, 20)];
        personLabel2.backgroundColor = [UIColor clearColor];
        personLabel2.text = [NSString stringWithFormat: @"(%@)", [item objectForKey:@"number"]];
        personLabel2.font = [UIFont systemFontOfSize:15];

        UILabel *dateLabel = [[UILabel alloc]initWithFrame:CGRectMake(cell.frame.size.width-125, 10, 80, 40)];
        dateLabel.backgroundColor = [UIColor clearColor];
        dateLabel.text = [NSString stringWithFormat: @"%@\n%@",[item objectForKey:@"date"], [item objectForKey:@"time"]];
        dateLabel.textColor = [UIColor darkGrayColor];
        dateLabel.textAlignment = NSTextAlignmentRight;
        dateLabel.font = [UIFont systemFontOfSize:13];
        dateLabel.numberOfLines = 2;

        UILabel *messageLabel = [[UILabel alloc]initWithFrame:CGRectMake(10, 60, cell.frame.size.width-50, 20)];
        messageLabel.backgroundColor = [UIColor clearColor];
        messageLabel.text = [NSString stringWithFormat: @"%@",[item objectForKey:@"message"]];
        messageLabel.textColor = [UIColor lightGrayColor];
        messageLabel.font = [UIFont systemFontOfSize:15];

        [background addSubview:personLabel];
        [background addSubview:personLabel2];
        [background addSubview:dateLabel];
        [background addSubview:messageLabel];
        [cell addSubview:background];

    }else{

        UILabel *personLabel = [[UILabel alloc]initWithFrame:CGRectMake(40, 10, cell.frame.size.width-170, 20)];
        personLabel.backgroundColor = [UIColor clearColor];
        personLabel.text = [NSString stringWithFormat: @"%@",[item objectForKey:@"name"]];
        personLabel.font = [UIFont boldSystemFontOfSize:17];

        UILabel *personLabel2 = [[UILabel alloc]initWithFrame:CGRectMake(40, 30, cell.frame.size.width-170, 20)];
        personLabel2.backgroundColor = [UIColor clearColor];
        personLabel2.text = [NSString stringWithFormat: @"(%@)", [item objectForKey:@"number"]];
        personLabel2.font = [UIFont systemFontOfSize:15];

        UILabel *dateLabel = [[UILabel alloc]initWithFrame:CGRectMake(cell.frame.size.width-125, 10, 80, 40)];
        dateLabel.backgroundColor = [UIColor clearColor];
        dateLabel.text = [NSString stringWithFormat: @"%@\n%@",[item objectForKey:@"date"], [item objectForKey:@"time"]];
        dateLabel.textColor = [UIColor darkGrayColor];
        dateLabel.textAlignment = NSTextAlignmentRight;
        dateLabel.font = [UIFont systemFontOfSize:13];
        dateLabel.numberOfLines = 2;

        UILabel *messageLabel = [[UILabel alloc]initWithFrame:CGRectMake(40, 60, cell.frame.size.width-80, 20)];
        messageLabel.backgroundColor = [UIColor clearColor];
        messageLabel.text = [NSString stringWithFormat: @"%@",[item objectForKey:@"message"]];
        messageLabel.textColor = [UIColor lightGrayColor];
        messageLabel.font = [UIFont systemFontOfSize:15];

        UIImage *checkmarkImage = [UIImage imageNamed:@"done.png"];
        UIImageView *checkmark = [[UIImageView alloc] initWithImage:checkmarkImage];
        [checkmark setFrame:CGRectMake(10, 35, 20, 20)];

        [background addSubview:personLabel];
        [background addSubview:personLabel2];
        [background addSubview:dateLabel];
        [background addSubview:messageLabel];
        [background addSubview:checkmark];
        [cell addSubview:background];

    }

}
return cell;
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T05:22:57.767

当您将几个 UILabel 和 UIView 添加到一个单元格时，我认为您应该自定义您自己的 UITableViewCell。尝试创建一个继承 UITableviewCell 的类，并在实现中添加子视图。希望我的回答有帮助

# wpf - WPF 中 Windows 激活的 Alt-Tab 问题

> ID：13997439
> 
> 赞同：3
> 
> 时间：2012-12-21T21:29:16.090
> 
> 标签：wpf, windows, events, key

在我的应用程序中，我有一个映射到 tab 键的特殊操作。问题是，当您使用快捷方式 Alt-Tab 在不同的应用程序之间切换时，我的应用程序在激活时会获得一个 Tab 键（但不是 Alt 键），我想避免这种情况。这种情况有时会发生（并非总是如此），尤其是当您快速切换应用程序时。

我可以通过检查将其过滤掉`Keyboard.IsKeyDown(Key.LeftAlt)`，但在这种情况下，我的应用程序没有获得 Alt 键。任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T11:20:18.983

我遇到了 KeyUp 事件处理程序未注册的问题`e.Key == Key.LeftAlt`。相反，我不得不使用`e.SystemKey == Key.LeftAlt`. 也许您面临类似的问题（尽管我不知道您是否使用 KeyUp/KeyDown 事件处理程序）？

另一件要尝试的事情是`Keyboard.Modifiers == ModifierKeys.Alt`甚`KeyboardDevice.Modifiers == ModifierKeys.Alt`至可能是为了过滤掉*Alt*。

# r - 打印当前的随机种子，以便我以后可以使用 set.seed() 输入它

> ID：13997444
> 
> 赞同：19
> 
> 时间：2012-12-21T21:29:25.257
> 
> 标签：r, random

我是这里的R新手。

假设我有这行代码

```
set.seed(123456) 
```

然后我想获得值 123456 以便我可以将其打印出来以用于文档目的，如果需要在将来的某个时间重新输入该值。那么如何获得那颗种子呢？

请注意，我可能会将上面的代码行注释掉，所以我实际上不会知道种子在 123456 是什么。因此我需要 r 将当前种子的位置打印为单个整数，而不是作为列表626 个整数。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-21T21:44:59.773

`set.seed()`中使用的种子和 中的信息之间存在有效的单向关系`.Random.seed`；正如`?Random.seed`@MattTenenbaum 的回答所示，`.Random.seed`可以保存和恢复其中的信息。我很欣赏对从 的当前状态派生一个简单整数种子的函数的渴望`.Random.seed`，但在它不存在的情况下，您必须保存和恢复完整信息......例如

```
set.seed(1001)
save(".Random.seed",file="random_state_seed1001.RData") ## save current state
runif(1)
## [1] 0.9856888
runif(1)
## [1] 0.4126285
runif(1)
## [1] 0.4295392
load("random_state_seed1001.RData") ## restore state just after set.seed()
runif(1)
## [1] 0.9856888 
```

正如@JoshuaUlrich 指出的那样，只有在保存和恢复之间不修改 RNG 的类型（和正常偏差生成器的类型）时，这才有效/安全......

更完整的解决方案：

```
save_rng <- function(savefile=tempfile()) {
    if (exists(".Random.seed"))  {
        oldseed <- get(".Random.seed", .GlobalEnv)
    } else stop("don't know how to save before set.seed() or r*** call")
    oldRNGkind <- RNGkind()
    save("oldseed","oldRNGkind",file=savefile)
    invisible(savefile)
}

restore_rng <- function(savefile) {
    load(savefile)
    do.call("RNGkind",as.list(oldRNGkind))  ## must be first!
    assign(".Random.seed", oldseed, .GlobalEnv)
} 
```

试试看：

```
set.seed(101)
RNGstore <- save_rng()  ## save file name
runif(1)
## [1] 0.3721984
runif(10)
## [1] 0.04382482 0.70968402 0.65769040 0.24985572 0.30005483 0.58486663
## [7] 0.33346714 0.62201196 0.54582855 0.87979573
restore_rng(RNGstore)
runif(1)
## [1] 0.3721984 
```

另见： http: [//www.cookbook-r.com/Numbers/Saving_the_state_of_the_random_number_generator/](http://www.cookbook-r.com/Numbers/Saving_the_state_of_the_random_number_generator/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:33:07.927

调用`set.seed`后，您应该可以参考`.Random.seed`（有关更多信息，请参见[http://stat.ethz.ch/R-manual/R-patched/library/base/html/Random.html](http://stat.ethz.ch/R-manual/R-patched/library/base/html/Random.html)）。

一个简单的例子：

```
set.seed(123)
tmp <- .Random.seed
> runif(10)
 [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673 0.0455565 0.5281055 0.8924190 0.5514350 0.4566147
.Random.seed <- tmp
> runif(10)
 [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673 0.0455565 0.5281055 0.8924190 0.5514350 0.4566147 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-27T22:37:52.640

这里有一些在实践中应该可以正常工作的东西（但不应该用于例如密码学）：

```
new.seed <- as.integer(runif(1)*2e9)
cat("Random seed: ", new.seed, "\n")
set.seed(new.seed) 
```

您确实需要实际设置种子才能使其正常工作，因此它不是原始问题的完全答案，但可能是您正在寻找的，因为它可以让您轻松指定随机种子，而无需使用预先指定的手动设置整数。

# javascript - Kendo UI 模板：无效模板错误

> ID：13997445
> 
> 赞同：2
> 
> 时间：2012-12-21T21:29:33.433
> 
> 标签：javascript, asp.net-mvc, razor, kendo-ui

我正在尝试制作剑道 UI 网格模板。当我运行以下 Chrome 时，我会收到错误消息。我省略了其余消息的大部分内容，因为它只是将所有生成的 HTML 和 javascript 打印到控制台。

`Uncaught Error: Invalid template:'<div class="k-widget&#32;k-grid" id="l...`

我正在尝试遵循页面 [http ://demos.kendoui.c​​om/web/grid/detailtemplate.html 上的“detailtemplate.cshtml”示例](http://demos.kendoui.com/web/grid/detailtemplate.html)

我很难弄清楚我做错了什么。如果我删除模板脚本标签之间的所有内容并只放入一些愚蠢的 HTML，那么一切正常，所以我确信问题与我放入剑道网格的方式有关。

这是我的 HTML 页面中的代码。`<script>`问题出在 ID 为“GridDetailsTemplate”的内部某处。

```
<div id="pendingApproval-tab">
    @(Html.Kendo().Grid<Moly.BusinessLogic.Entities.MolyAssayEntity>()
        .Name("pending-approval-grid")
        .HtmlAttributes(new { style = "overflow: auto; height: 600px"})
        .Columns(columns =>
        {
            columns.Bound(x => x.MolyLotID).HtmlAttributes(new {@class = "moly-lot-id"}).Hidden();
            columns.Template(@<div></div>).ClientTemplate("<input class='ready-checkbox' type='checkbox'/>").Title("Ready");
            columns.Bound(x => x.LotNo).Title("Lot").Groupable(false);
            columns.Bound(x => x.DateProduced).Format("{0:MM/dd/yy}").Title("Date");
            columns.Bound(x => x.NetWetWeight).Title("Net Wet Weight");
            columns.Bound(x => x.TareWeight).Title("Tare Weight");
            columns.Bound(x => x.NetDryWeight).Title("Dry Weight");
            columns.Bound(x => x.GrossWeight).Title("Gross Weight");
            columns.Bound(x => x.MolyWeight).Title("Lbs Mo");
            columns.Bound(x => x.MoisturePercent).Title("% H20");
            columns.Bound(x => x.MolyPercent).Title("Mo");
            columns.Bound(x => x.CopperPercent).Title("Cu");
            columns.Bound(x => x.LeadPercent).Title("Pb");
            columns.Bound(x => x.InsolublesPercent).Title("Insol");
            columns.Bound(x => x.ArsenicPercent).Title("As");
            columns.Bound(x => x.CalciumOxidePercent).Title("CaO");
            columns.Bound(x => x.IronPercent).Title("Fe");
            columns.Bound(x => x.MagnesiumOxidePercent).Title("MgO");
            columns.Bound(x => x.SodiumPercent).Title("Na");
            columns.Bound(x => x.BatchID).Title("Batch ID");
            columns.Bound(x => x.DunnageWt).Title("Dunnage Wt.");
            columns.Bound(x => x.Comment).Title("Comments");
        })
        .ToolBar(toolbar =>
        {
            toolbar.Save();
        })
        .Editable(editable => editable.Mode(GridEditMode.InCell))
        .ClientDetailTemplateId("GridDetailsTemplate")
        .DataSource(ds => ds
            .Ajax()
            .Batch(true)
            .Model(model => 
            {
                model.Id(m => m.MolyLotID);       
            })
            .Update(update => update.Action("UpdateMoly", "MolyLot"))
            .Read(read => read
                .Action("PendingApproval", "MolyLot")
                .Type(HttpVerbs.Post)
            )
        )
        .Events(events => events.DataBound("dataBound"))
    )
</div>

<script type="text/javascript">
    function dataBound() {
        this.expandRow(this.tbody.find("tr.k-master-row").first());
    }
</script>

<script id="GridDetailsTemplate" type="text/kendo-tmpl">
    @(Html.Kendo().Grid<Moly.BusinessLogic.Entities.UnroastedContainerEntity>()
        .Name("lot-details-grid")
        .Columns(columns =>
        {
            columns.Bound(x => x.ContainerNumber).Title("Number");
            columns.Bound(x => x.Type).Title("Type");
            columns.Bound(x => x.GrossWeight).Title("Gross Weight");
            columns.Bound(x => x.TareWeight).Title("Tare Weight");
        })
        .DataSource(DataSource => DataSource
            .Ajax()
            .Read(read => read.Action("GetBags", "MolyLot"))
        )
        .ToClientTemplate()
    )
</script> 
```

这是使用我的模板代码生成的“真实”模板：

```
<div class="k-widget&#32;k-grid" id="lot-details-grid">
    <table cellspacing="0">
        <colgroup>
            <col />
            <col />
            <col />
            <col />
        </colgroup>
        <thead class="k-grid-header">
            <tr>
                <th class="k-header" data-field="ContainerNumber" data-title="Number"
                scope="col"><span class="k-link">Number</span>
                </th>
                <th class="k-header" data-field="Type" data-title="Type" scope="col"><span class="k-link">Type</span>
                </th>
                <th class="k-header" data-field="GrossWeight" data-title="Gross&#32;Weight"
                scope="col"><span class="k-link">Gross Weight</span>
                </th>
                <th class="k-header" data-field="TareWeight" data-title="Tare&#32;Weight"
                scope="col"><span class="k-link">Tare Weight</span>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr class="t-no-data">
                <td colspan="4"></td>
            </tr>
        </tbody>
    </table>
</div>
<script>
    jQuery(function () {
        jQuery("\#lot-details-grid").kendoGrid({
            "columns": [{
                "title": "Number",
                "field": "ContainerNumber",
                "encoded": true
            }, {
                "title": "Type",
                "field": "Type",
                "encoded": true
            }, {
                "title": "Gross Weight",
                "field": "GrossWeight",
                "encoded": true
            }, {
                "title": "Tare Weight",
                "field": "TareWeight",
                "encoded": true
            }],
            "scrollable": false,
            "dataSource": {
                "transport": {
                    "read": {
                        "url": "/Moly.Web/controller/action"
                    }
                },
                "serverPaging": true,
                "serverSorting": true,
                "serverFiltering": true,
                "serverGrouping": true,
                "serverAggregates": true,
                "type": "aspnetmvc-ajax",
                "filter": [],
                "schema": {
                    "data": "Data",
                    "total": "Total",
                    "errors": "Errors",
                    "model": {
                        "fields": {
                            "UnroastedContainerID": {
                                "type": "number"
                            },
                            "MolyLotID": {
                                "type": "number"
                            },
                            "GrossWeight": {
                                "type": "number"
                            },
                            "Type": {
                                "type": "string"
                            },
                            "TareWeight": {
                                "type": "number"
                            },
                            "ContainerNumber": {
                                "type": "string"
                            },
                            "Units": {
                                "type": "string"
                            },
                            "MolyLot": {
                                "type": "object"
                            }
                        }
                    }
                }
            },
            "detailTemplate": kendo.template($('\#GridDetailsTemplate').html())
        });
    }); < \ / script >
        ' Generated code:'
    var o, e = kendo.htmlEncode;
    with(data) {
        o = '\n        <div class="k-widget&';
        32;
        k - grid " id="
        lot - details - grid "><table cellspacing="
        0 "><colgroup><col /><col /><col /><col /></colgroup><thead class="
        k - grid - header "><tr><th class="
        k - header " data-field="
        ContainerNumber " data-title="
        Number " scope="
        col "><span class="
        k - link ">Number</span></th><th class="
        k - header " data-field="
        Type " data-title="
        Type " scope="
        col "><span class="
        k - link ">Type</span></th><th class="
        k - header " data-field="
        GrossWeight " data-title="
        Gross & ;
        o += '32;Weight" scope="col"><span class="k-link">Gross Weight</span></th><th class="k-header" data-field="TareWeight" data-title="Tare&';
        32;
        Weight " scope="
        col "><span class="
        k - link ">Tare Weight</span></th></tr></thead><tbody><tr class="
        t - no - data "><td colspan="
        4 "></td></tr></tbody></table></div><script>
    jQuery(function(){jQuery("#lot - details - grid ").kendoGrid({"
        columns ":[{"
        title ":"
        Number ","
        field ":"
        ContainerNumber ","
        encoded ":true},{"
        title ":"
        Type ","
        field ":"
        Type ","
        encoded ":true},{"
        title ":"
        Gross Weight ","
        field ":"
        GrossWeight ","
        encoded ":true},{"
        title ":"
        Tare Weight ","
        field ":"
        TareWeight ","
        encoded ":true}],"
        scrollable ":false,"
        dataSource ":{"
        transport ":{"
        read ":{"
        url ":" / Moly.Web / controller / action "}},"
        serverPaging ":true,"
        serverSorting ":true,"
        serverFiltering ":true,"
        serverGrouping ":true,"
        serverAggregates ":true,"
        type ":"
        aspnetmvc - ajax ","
        filter ":[],"
        schema ":{"
        data ":"
        Data ","
        total ":"
        Total ","
        errors ":"
        Errors ","
        model ":{"
        fields ":{"
        UnroastedContainerID ":{"
        type ":"
        number "},"
        MolyLotID ":{"
        type ":"
        number "},"
        GrossWeight ":{"
        type ":"
        number "},"
        Type ":{"
        type ":"
        string "},"
        TareWeight ":{"
        type ":"
        number "},"
        ContainerNumber ":{"
        type ":"
        string "},"
        Units ":{"
        type ":"
        string "},"
        MolyLot ":{"
        type ":"
        object "}}}}},"
        detailTemplate ":kendo.template($('#GridDetailsTemplate').html())});});
<\/script>
    ;o+=;}return o;' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-07T23:30:17.657

我昨天遇到了这个问题，所以我找到了一个不需要你移除编码器的解决方案。

```
using System.Web;
using System.Web.Mvc;
using System.Web.Security.AntiXss;
using System.Web.Util;

namespace Your.Namespace.Here
{
    public static class KendoMvcExtensions
    {

        public static IHtmlString ToMvcClientTemplate(this MvcHtmlString mvcString)
        {
            if (HttpEncoder.Current.GetType() == typeof (AntiXssEncoder))
            {
                var initial = mvcString.ToHtmlString();
                var corrected = initial.Replace("\\u0026", "&").Replace("%23", "#").Replace("%3D", "=").Replace("&#32;", " ");
                return new HtmlString(corrected);
            }

            return mvcString;
        }
    }
} 
```

它检查 是否`AntiXssEncoder`处于活动状态，如果是，则删除有问题的编码字符。您可以根据需要取出编码器检查，但不要更改替换字符的顺序......它的结构是这样的，因为 .NET 会使某些字符（尤其是验证器文本）具有混合编码（UTF -8 和 Unicode 在同一字符集中，例如：`\u0026#32`，未编码一次变为`&#32`，未编码两次变为`" "`)。

要使用它，只需`.ToMvcClientTemplate()`在任何有问题的控件声明的末尾调用。在 OP 的情况下，您可以在关闭 div 之前将其放在右括号之后。

[我在这里保留了这段代码的副本，](https://gist.github.com/advancedrei/5724537)以防其他地方有人发布更好的解决方案，因为我已经在几个地方发布了这段代码。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T15:45:02.790

对于任何有类似问题的人，我是这样解决的：

我在 Web.config 中删除了这一行

```
<httpRuntime targetFramework="4.5" encoderType="System.Web.Security.AntiXss.AntiXssEncoder, System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-27T13:07:02.720

我之前使用了一个 javascript 函数来清理我的 MVC 部分，我还为 \ 添加了一个卸妆器，因为我发现 MVC 版本添加了很多。

```
 function fixTemplate(template) {
    template = template.replace(/\\u0026/g, "&");
    template = template.replace(/%23/g, "#");
    template = template.replace(/%3D/g, "=");
    template = template.replace(/&#32/g, " ");
    template = template.replace(/\\/g, "");
    return template;
} 
```

我不知道是否有更有效的方法来做到这一点，所以请随时发表评论。

# php - 如何在彼此中包含两个类？

> ID：13997446
> 
> 赞同：0
> 
> 时间：2012-12-21T21:29:35.773
> 
> 标签：php, methods, include, require

假设我有**两个 PHP 类**，一个叫做**gallery**，一个叫做**image**。

在班级图片中我想包含班级画廊，在班级画廊中我想包含班级图片。

怎么能正确地做到这一点 - 或者什么是实现这一目标的最佳方法？我最终想要做的是在类图像的一些方法中使用类库的方法。

**例如：**我在两个类中都有一个“删除”方法。**在类画廊**中，该方法用于删除特定画廊 - 由 id 选择。但是**在类图像**中，方法 delete 还检查删除的图像是否是画廊中的最后一张 - 如果是这样，则应该通过将 id 传递给类画廊的删除方法来删除该画廊。

怎样才能做到最好？- 或者有没有完全不同的更好的方法来做这样的事情？

谢谢你的回答！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:35:56.983

合成 ..`image`实例有一个它所属的画廊实例（如果它可以属于使事情复杂化的多个画廊）。

```
class Image {
   private $gallery;
   private $db;
   public function __construct(Gallery $gallery, DB $db) {
      $this->gallery = $gallery;
      $this->db = $db;
   }

   public function delete($id) {
      $this->db->deleteImage($id);
      if ($this->gallery->isEmpty()) {
         $this->gallery->delete($this->gallery->getID());
      }
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:39:00.747

使您的画廊成为实例化图像类的唯一位置，然后在图像的构造函数中设置一个属性，以便画廊传递对其自身的引用。

例如：

```
// in class Image
...
function Image($gallery) {
    $this->gallery = $gallery;
}
...

// in class Gallery
...
function get_image($id) {
    $img = new Image($this);
    ...
    return $img;
}
...

$image = $gallery->get_image(1); 
```

**编辑：** 看起来 ExplosionPills 用一个更好的例子打败了我

# java - Firefox WebDriver 在调用 findElement() 时不会抛出 NoElementFoundException 而是挂起？

> ID：13997449
> 
> 赞同：1
> 
> 时间：2012-12-21T21:30:03.110
> 
> 标签：java, selenium

我是 Selenium 的新手，我遇到了一个问题，即下面的代码片段在通过 Chrome 驱动程序运行时会引发 NoElementFoundException，但在使用 Firefox 驱动程序时会挂起。预期的行为是 Chrome 和 Firefox 都应该抛出异常。

我尝试将其嵌入到 try-catch 中，但在 Firefox 上没有发现异常。我搜索了互联网，但似乎找不到关于同一问题的其他帖子。

```
public static String getAlbumName(){
    WebElement albumName = Browsers.getCurrentDriver().findElement(By.xpath("//div[contains(@class,...")));
    String albumNameText = albumName.getText();
    return albumNameText;
} 
```

这是Chrome通过的异常：NoSuchElementException：找不到元素（警告：服务器未提供任何堆栈跟踪信息）

我正在使用 Selenium 2.25.0

任何想法为什么我会看到这种差异？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:35:57.827

原来这是 Selenium 中 Firefox 17 的一个已知错误，将在 Selenium 2.27 [http://code.google.com/p/selenium/issues/detail?id=4814中修复](http://code.google.com/p/selenium/issues/detail?id=4814)

降级到 Firefox 16 解决了我的问题。

# java - 类似机器人的 Java 语音识别

> ID：13997454
> 
> 赞同：4
> 
> 时间：2012-12-21T21:30:20.720
> 
> 标签：java, android, speech-recognition

我正在寻找一个更像 android 版本的 Java 语音识别软件，因为它没有 .gram 文件和东西，它只返回一个所说的字符串，我可以对其采取行动。我尝试过使用 sphinx-4，但使用 .gram 文件会使我的程序更难执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:40:16.893

语法文件的重点是提高您返回的内容的准确性。与其尝试想出随机的英文单词串，不如告诉它期待特定的输入。

也就是说，sphinx-4 也可以执行普通的大字典 ASR。[阅读本教程](http://cmusphinx.sourceforge.net/sphinx4/doc/ProgrammersGuide.html)的 N-Gram 部分并查看 sphinx 源代码附带的转录器示例。

此外，您可以训练自己的三元模型，这将增强您获得的结果。（例如，将更多的概率放在检测到“天气”这个词上。）这当然是 Siri 所做的。苹果/谷歌有大量的音频片段，人们通过手机说话，其中一部分是人工转录的，他们从中训练声学和语言模型（因此他们的引擎检测人们通常说的话而不是胡说八道）。

# php - 如何在没有收到错误响应的情况下与 ObjectiveC 中的服务器交互？

> ID：13997455
> 
> 赞同：3
> 
> 时间：2012-12-21T21:30:28.487
> 
> 标签：php, objective-c, ios, nsurlconnection, nsurlrequest

这是我在这里的第一个问题:)

我真的需要一些服务器和 PHP 方面的帮助。这是问题：

我有一个 NSMutableURLRequest 与这样的 php 文件交互：

```
 NSInteger userID = 4;

    NSString * logInString = [NSString stringWithFormat:@"id=%i&mode=HARD", userID];
    NSData * logInData = [logInString dataUsingEncoding:NSUTF8StringEncoding allowLossyConversion:YES];

    NSString *postLength = [NSString stringWithFormat:@"%d", [logInData length]];

    NSMutableURLRequest * logInRequest = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://myurl.lol/login.php"]];
    [logInRequest setValue:@"application/x-www-form-urlencoded" forHTTPHeaderField:@"Content-Type"];
    [logInRequest setValue:postLength forHTTPHeaderField:@"Content-Length"];
    [logInRequest setHTTPMethod:@"POST"];
    [logInRequest setHTTPBody:logInData];

    [NSURLConnection sendAsynchronousRequest:logInRequest queue:[[NSOperationQueue alloc] init] completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
        if ([data length] >0 && error == nil) {
            NSString * responseString = [NSString stringWithUTF8String:data.bytes];
            NSLog(@"%@", responseString);
            [self performSelectorOnMainThread:@selector(responseWasReceived:) withObject:responseString waitUntilDone:YES];
        }
        else if ([data length] == 0 && error == nil) {
            [self performSelectorOnMainThread:@selector(didNotReceivedResponse) withObject:nil waitUntilDone:YES];
        }
        else if (error != nil) {
            [self performSelectorOnMainThread:@selector(errorDidOccurred) withObject:nil waitUntilDone:YES];

            NSLog(@"Error = %@", error);
        }
    }]; 
```

我的PHP是这样的：

```
include("database.php");

if ($_REQUEST['mode'] == 'HARD') {
    $query = mysql_query('SELECT COUNT(*) as total FROM users WHERE id = "' . $_REQUEST['id'] . '"');

    $fetch_username = mysql_fetch_object($query);
    $usernames_coincidences = $fetch_username -> total;

    if ($usernames_coincidences == 1) {
        exit("ACCESS GRANTED");
    } else {
        exit("USER DOES NOT EXIST");
    }
} 
```

我应该收到“ACCESS GRANTED”字符串，有时它会发生，但有时我会收到一个错误的响应，例如“ACCESS GRANTED¿”或“ACCESS GRANTEDOL”。

有什么问题？你认为我应该在方法中使用同步请求并使用 performSelector:inBackground: 执行它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:41:02.650

您正在尝试`responseString`使用不一定以 NULL 结尾的原始数据进行构建。

而不是这个：

```
[NSString stringWithUTF8String:data.bytes]; 
```

改用这个：

```
[[NSString alloc] initWithBytes:data.bytes length:data.length encoding:NSUTF8StringEncoding]; 
```

请注意，我没有考虑您是否使用 ARC。你原来的调用产生了一个自动释放的值；我的没有；确保你不会泄漏。

# eclipse - 由于错误无法部署 Google App

> ID：13997458
> 
> 赞同：0
> 
> 时间：2012-12-21T21:30:53.533
> 
> 标签：eclipse, google-app-engine, eclipse-plugin, java-7

我使用 Google App Engine 创建了一个简单的应用程序

**环境**

*   Eclipse 4.2 (Juno) 插件 - [http://dl.google.com/eclipse/plugin/4.2](http://dl.google.com/eclipse/plugin/4.2)
*   JDK 7

我能够创建一个示例应用程序并在**本地**运行它。

当我尝试**部署**时，它给了我一个错误

**日食中的错误**

将“应用程序名称”部署到 Google 时遇到了问题。无法更新应用程序：应用程序包含 Java 7 类，但尚未设置 --use_java7 标志。

有关更多详细信息，请参阅部署控制台 无法更新应用程序：应用程序包含 Java 7 类，但尚未设置 --use_java7 标志。

**日志显示**

无法更新：java.lang.RuntimeException：应用程序包含 Java 7 类，但尚未设置 --use_java7 标志。在 com.google.appengine.tools.admin.Application.createStagingDirectory(Application.java:576) 在 com.google.appengine.tools.admin.AppAdminImpl.doUpdate(AppAdminImpl.java:370) 在 com.google.appengine.tools .admin.AppAdminImpl.update(AppAdminImpl.java:53) 在 com.google.appengine.eclipse.core.proxy.AppEngineBridgeImpl.deploy(AppEngineBridgeImpl.java:433) 在 com.google.appengine.eclipse.core.deploy.DeployProjectJob .runInWorkspace(DeployProjectJob.java:148) 在 org.eclipse.core.internal.resources.InternalWorkspaceJob.run(InternalWorkspaceJob.java:38) 在 org.eclipse.core.internal.jobs.Worker.run(Worker.java:53 )

我看到有人以前遇到过同样的错误

[未能部署到 Google App Engine，因为尚未设置 --use_java7 标志](https://stackoverflow.com/questions/13848495/failed-to-deploy-to-google-app-engine-because-use-java7-flag-has-not-been-set)

我安装了 JDK 6，但我也无法让应用程序工作。

我有哪些替代方法可以让应用程序正常工作？- 一些想法...

*   **使用以前版本的插件？**

*   **自己安装JDK 6？**

*   **其他一些选择？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:51:09.267

您必须使用 JDK 6。

[类似问题](https://stackoverflow.com/questions/12587432/updating-play-app-from-jdk-6-to-7-on-gae)

[Java 概述文档](https://developers.google.com/appengine/docs/java/overview)

> App Engine 使用 Java 6 虚拟机 (JVM) 运行 Java 应用程序。App Engine SDK 支持 Java 5 及更高版本，Java 6 JVM 可以使用使用 Java 6 之前的任何版本的 Java 编译器编译的类。

# cakephp - CakePHP：在哪里设置默认会话值？

> ID：13997459
> 
> 赞同：0
> 
> 时间：2012-12-21T21:30:57.740
> 
> 标签：cakephp, cakephp-2.2

我有一个使用 CakeSession 来保存不同用户数据的应用程序。现在我想编写一些默认值，`CakeSession::write()`并让它们可用于所有视图（也适用于缓存视图）。因此，在呈现视图之前，应该对每个请求进行检查/写入。

但是在哪里放置符合这些要求的代码呢？到目前为止，我尝试了以下位置使用`CakeSession::write()`但没有成功：

1.  Config/bootstrap.php -> CakeSession 尚未定义
2.  AppController::__construct() -> CakeSession 尚未定义
3.  AppController::beforeFilter() -> 不会为缓存视图调用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:55:20.650

缓存视图不会在任何地方创建会话。缓存视图根本不初始化请求

[文档](http://book.cakephp.org/2.0/en/core-libraries/helpers/cache.html#marking-non-cached-content-in-views)

```
It should be noted that once an action is cached, the controller method for the 
action will not be called. When a cache file is created, the request object, 
and view variables are serialized with PHP’s serialize(). 
```

# c# - 如何逐行读取文本文件 Windows RT？

> ID：13997464
> 
> 赞同：4
> 
> 时间：2012-12-21T21:31:36.590
> 
> 标签：c#, windows-8, io, windows-runtime, windows-store-apps

我只是找不到关于如何在 Windows RT（适用于 Windows 8 商店）中逐行读取文本文件的清晰解释。

假设我有一个文件夹：`MyFolder/Notes.txt`

我想从 Notes.txt 中读取数据并将其添加到字符串数组中。

我如何从该文件中读/写？我之前使用的是 StreamReader，但现在它非常混乱。开发样本并没有太大帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T22:44:05.637

我自己设法找到了答案。谢谢您的帮助。

```
 // READ FILE
    public async void ReadFile()
    {
        // settings
        var path = @"MyFolder\MyFile.txt";
        var folder = Windows.ApplicationModel.Package.Current.InstalledLocation;

        // acquire file
        var file = await folder.GetFileAsync(path);
        var readFile = await Windows.Storage.FileIO.ReadLinesAsync(file);
        foreach (var line in readFile)
        {
            Debug.WriteLine("" + line.Split(';')[0]);
        }
     } 
```

MyFile.txt 有：

测试1；描述1；

测试2;描述2;

//ReadFile() 的输出

测试1

测试2

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:53:50.030

您不必使用`File.ReadLines`. 如果您愿意，可以尝试这样的实现：

> ```
> using (StreamReader reader = new StreamReader("notes.txt"))
> {
>     while (reader.Peek() >= 0)
>     {
>         Console.WriteLine(reader.ReadLine());
>     }
> } 
> ```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T21:41:30.433

```
foreach (var line in File.ReadLines("MyFolder/Notes.txt"))
{
  ...
} 
```

逐行读取文件。这与`File.ReadAllLines`一次读取整个文件不同。

如果您想一次将所有内容读取到数组中，请使用后者。

# c++ - 在 Shift/Reduce 解析器生成器中指定 C++11 语法动作函数？

> ID：13997465
> 
> 赞同：5
> 
> 时间：2012-12-21T21:31:43.550
> 
> 标签：c++, algorithm, parsing, c++11

我正在使用 C++11 中的 shift/reduce 解析器生成器，但我不确定如何指定输入产生式和归约操作函数的接口类型，以便它们保存我想要放入其中的信息。

我想静态指定语法，但使用 C++ 类型（不是单独的构建工具）。

对于每个符号（终端和非终端），用户提供一个字符串名称和一个类型。

然后每个产生式指定一个头部符号名称和一个或多个主体符号名称。

对于每个产生式，用户（硬部分）提供一个动作函数，该函数返回头部非终结符类型，并具有与产生式主体符号（其相应类型）相对应的参数。

**主要问题是将这些动作函数的参数类型和返回类型静态绑定到相应的符号类型**

例如：

假设我们有非终结符`X`，`A` `B` `C`

他们的名字/类型可能是：

```
"X" Foo
"A" string
"B" string
"C" int 
```

在语法中可能有一个产生式：

```
X -> A B C 
```

用户会为该产品提供一个动作函数：

```
Foo f(string A, string B, int C) 
```

如果该生产减少了，则应使用生产主体参数调用函数 f。然后存储 f 返回的值，以供该符号在更高的向上归约中使用时使用。

因此，要为解析器生成器指定语法，我需要提供如下内容：

（我知道以下是无效的）

```
struct Symbol
{
    string name;
    type T;
}

struct Production
{
    string head;
    vector<string> body;

    function<head.T(body[0].T, body[1].T, ..., body[n].T)> action;
}

struct Grammar
{
    vector<Symbol> symbols;

    vector<Production> productions;
} 
```

并指定前面的例子是：

```
Grammar example =
{
    // symbols
    {
        { "X", Foo },
        { "A", string },
        { "B", string },
        { "C", int }
    },

    // productions
    {
        { 
            "X",
            { "A", "B", "C" },
            [](string A, string B, int C) { ... return Foo(...); }
        }
    }
} 
```

这当然行不通，你不能像这样将类型参数与运行时参数混合在一起。

一种解决方案是拥有一些通用基础：

```
struct SymbolBase
{
    ...
}

template<class SymbolType>
struct SymbolDerived<SymbolType> : SymbolBase
{
    SymbolType value;
} 
```

然后制作所有类型的动作函数：

```
typedef function<SymbolBase(vector<SymbolBase>)> ActionFunction; 
```

并在运行时对其进行排序。但这使得使用更加困难，并且所有的铸造都很慢。我宁愿在编译时检查函数签名，并对用户隐藏机制。

如何重组 Symbol、Production 和 Grammar 类型以承载我试图在合法 C++11 中传达的信息？

（是的，我看过 Boost Spirit 和朋友，它是一个很好的框架，但它是递归下降的，因此它可以在单次传递中处理的语言少于 LALR 解析器，并且因为它使用回溯，所以会多次调用归约动作等）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T07:17:01.067

我一直在玩弄这个问题。我一直在研究的一种可能性（看起来应该可行）是使用一堆变体对象，也许是 boost::variant 或 boost::any。由于每个归约都知道它对堆栈的期望，因此访问将是类型安全的；不幸的是，类型检查将在运行时进行，但它应该非常便宜。这具有捕获错误的优势:) 并且它还会在对象从堆栈中弹出时正确地破坏它们。

我将一些示例代码放在一起作为 PoC，可应要求提供。编写归约规则的基本风格是这样的：

```
parse.reduce<Expression(Expression, _, Expression)>
  ( [](Expression left, Expression right){
      return BinaryOperation(Operator::Times, left, right);
  }); 
```

这对应于规则：

```
expression: expression TIMES expression 
```

这里，`BinaryOperation`是 AST 节点类型，并且必须可以转换为`Expression`; 模板参数`Expression(Expression, _, Expression)`正是产生式的左侧和右侧，表示为类型。（因为第二个 RHS 类型是 _，模板不会费心将值提供给归约规则：使用适当的解析器生成器，实际上甚至没有理由首先将标点符号推入堆栈。）使用 . 实现了解析器堆栈的标记联合`Expression`和标记类型`boost::variant`。如果您尝试此操作，则值得知道使用变体作为另一个变体的选项类型之一实际上并不起作用。最后，将较小的联合包装为`struct`. 您还必须阅读有关递归类型的部分。

# php - PHP 在数据库中保存会话。读取方法似乎不起作用

> ID：13997467
> 
> 赞同：2
> 
> 时间：2012-12-21T21:31:57.933
> 
> 标签：php, mysql, session

所以，我试图将会话存储在 mysql 数据库中。一切似乎都很顺利，因为它会将数据写入会话表等。但是，我只是注意到我可以写出会话数据，尽管我的读取方法是空的。因此，如果您查看代码，最终的 echo 语句将写入“值”——即使定义了零逻辑。有任何想法吗？谢谢！

```
class SessionManagement{

    private $_hostname;
    private $_username;
    private $_password;
    private $_database;
    private $_timeout;

    public function __construct() {
        $CI =& get_instance();
        $CI->load->database();

        $this->_hostname = $CI->db->hostname;
        $this->_username = $CI->db->username;
        $this->_password = $CI->db->password;
        $this->_database = $CI->db->database;       
        $this->_timeout  = 60 * 60 * 10;    
    }

    public function _open()
    {
        return TRUE;
    }

    public function _close()
    {
        return TRUE;
    } 

    public function _read($id)
    {
                mysql_connect($this->_hostname, $this->_username, $this->_password);
    mysql_select_db($this->_database);

    $id = mysql_real_escape_string($id);

    $sql = "SELECT session_data
            FROM   sessions
            WHERE  session_id = '$id'";

    if ($result = mysql_query($sql)) {
        if (mysql_num_rows($result)) {
            $record = mysql_fetch_assoc($result);

            return $record['session_data'];
        }
    }

    return '';  
    }

    public function _write($id, $data)
    {

        mysql_connect($this->_hostname, $this->_username, $this->_password);
        mysql_select_db($this->_database);

        $id = mysql_real_escape_string($id);
        $data = mysql_real_escape_string(base64_encode(serialize(strip_tags($data))));  
        $access = time() + $this->_timeout;

        $sql = "REPLACE INTO session (session_id, session_data, session_expires) VALUES('$id','$data', $access)";

        return mysql_query($sql);
    }
    public function _gc($max)
    {
        return TRUE;
    }

    public function _destroy($id)
    {
        mysql_connect($this->_hostname, $this->_username, $this->_password);
        mysql_select_db($this->_database);

        $id = mysql_real_escape_string($id);

        $sql = "DELETE
                FROM   session
                WHERE  session_id = '$id'";

        return mysql_query($sql);
    }
}

ini_set("session.save_handler", "user");

session_name("test");
session_set_cookie_params(0, '/', '.test.com');

$s = new SessionManagement();

session_set_save_handler(
        array($s, '_open'),
        array($s, '_close'),
        array($s, '_read'),
        array($s, '_write'),
        array($s, '_destroy'),
        array($s, '_gc')
); 

session_start();

$_SESSION['test'] = "value";

ECHO $_SESSION['test']; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T13:10:10.837

您正在使用 Codeigniter。它具有将会话存储到已内置数据库中的功能。

只需删除不起作用的代码并改用 Codeigniter 的功能。您只需要配置它。

*   [CodeIgniter 将会话保存在数据库中](https://stackoverflow.com/q/7280056/367456)

* * *

除此之外，如果你真的想“和你在一起”，你的代码还有*很多*问题。如果您遵循以下几点，它们很容易被发现：

1.  阅读会话保存处理程序的每个回调函数。尤其是他们接收的数据和格式（不这样做会导致至少一个错误，该错误能够触发您描述为“不工作”的行为）。
2.  做错误记录。导致错误的保存处理程序出现问题可能会使它们看不见，因为不再可能输出到浏览器。这需要您将错误记录到文件中。当您使用会话保存处理程序进行故障排除时，这一点非常重要。
3.  将数据库交互代码移开。这还允许您在数据库交互失败的情况下提供更好的错误信息（不这样做会隐藏至少一个能够导致您描述为“不工作”的行为的错误）。
4.  删除不需要的代码。我的意思是，它不需要。拥有不需要的代码可能包括导致您在此处遇到的“不工作”场景的错误。因此，您无缘无故地阻碍自己完成工作。一个例子：`ini_set("session.save_handler", "user");`- 只要您不知道自己在做什么，就不要这样做。PHP 中没有调用预定义的保存处理程序`user`，您也没有定义那个。

基本上就是这样。所以我可以发现两个真正的错误导致这个，其他步骤是必要的，这样你就可以处理未来的问题：

1.  确保您始终与同一个数据库表相关。例如，如果您写入 table`MY_SESSIONS`并从 table 读取`SESSIONS`，这将永远不会起作用。
2.  确保您返回给 PHP 的数据与其期望的数据兼容。例如，如果您将 Base64 编码的数据存储到数据库中并将其返回给 PHP Base64 编码，那么 PHP 无法处理该数据。

从您的代码中看不到的其他潜在问题：

1.  您拥有的数据库架构不适合您存储在其中的数据（您尚未提供表架构，因此不能说这是否会导致您出现问题）。
2.  数据库链接标识符可能会更改，因为 codeigniter 本身正在创建数据库连接。这可能会导致潜在的副作用。显式提供数据库连接的链接标识符有助于放松睡眠。
3.  由于缺少对数据库部分的错误处理，SQL 查询中的错误未被注意到。

* * *

示例代码：

```
ob_start();

session_name("test");
session_set_cookie_params(0, '/', '.test.com');

$s = new SessionManagement();
$s->register();

session_start();

ECHO $_SESSION['test'], "\n"; # value 
```

重构`SessionManagement`类：

```
class SessionManagement
{
    private $_timeout;
    private $_db;

    public function __construct() {

        $CI =& get_instance();
        $CI->load->database();

        $this->_db = new LegacyMysqlDatabase(
            $CI->db->hostname, $CI->db->username, $CI->db->password, $CI->db->database
        );

        $this->_timeout = 60 * 60 * 10;
    }

    public function _open() {

        return TRUE;
    }

    public function _close() {

        return TRUE;
    }

    public function _read($session_id) {

        $db         = $this->_db;
        $session_id = $db->escape($session_id);
        $sql        = "SELECT session_data
            FROM   SESSION
            WHERE  session_id = '$session_id'";

        if (!($result = $db->query($sql)) || !$result->getNumberOfRows()) {
            return '';
        }

        $record = $result->fetchAssoc();
        return $record['session_data'];
    }

    public function _write($session_id, $session_data) {

        $db              = $this->_db;
        $session_id      = $db->escape($session_id);
        $session_data    = $db->escape($session_data);
        $session_expires = time() + $this->_timeout;

        $sql = "REPLACE INTO SESSION (session_id,    session_data,    session_expires)
                             VALUES  ('$session_id', '$session_data', $session_expires)";

        return (bool)$db->query($sql); // cast to bool because PHP would cast to int
    }

    public function _gc($max) {

        return TRUE;
    }

    public function _destroy($id) {

        $db         = $this->_db;
        $session_id = $db->escape($id);
        $sql        = "DELETE
                FROM   SESSION
                WHERE  session_id = '$id'";

        return $db->query($sql);
    }

    public function register() {

        $registered = session_set_save_handler(
            array($this, '_open'),
            array($this, '_close'),
            array($this, '_read'),
            array($this, '_write'),
            array($this, '_destroy'),
            array($this, '_gc')
        );
        if (!$registered) {
            throw new Exception('Can not register session savehandler.');
        }
    }
} 
```

带错误处理的数据库交互代码：

```
class LegacyMysqlDatabase
{
    private $_hostname;
    private $_username;
    private $_password;
    private $_database;

    private $_link;
    private $_initError = false;

    public function __construct($hostname, $username, $password, $database) {

        $this->_hostname = $hostname;
        $this->_username = $username;
        $this->_password = $password;
        $this->_database = $database;
    }

    public function query($sql) {

        $link   = $this->getLink();
        $result = mysql_query($sql, $link);
        if ($result === false) {
            trigger_error(sprintf('Query "%s" failed: #%d: %s', $sql, mysql_errno($link), mysql_error($link)));
            throw new Exception('Failed to query Mysql database.');
        }
        return new LegacyMysqlResult($result);
    }

    public function escape($string) {

        return mysql_real_escape_string($string, $this->getLink());
    }

    private function getLink() {

        if ($this->_initError) {
            throw new Exception('Failed to initialize the database.');
        }

        if ($this->_link === null) {
            $this->_initError = true;
            $result           = mysql_connect($this->_hostname, $this->_username, $this->_password);
            if (!$result) {
                throw new Exception('Can not connect to Mysql database.');
            }
            $this->_link = $result;
            $selected    = mysql_select_db($this->_database, $this->_link);
            if (!$selected) {
                trigger_error(sprintf('Can not select Mysql database "%s": #%d: %s', $this->_database, mysql_errno($result), mysql_error($result)));
                throw new Exception(sprintf('Can not select Mysql database "%"', $this->_database));
            }
            $this->_initError = false;
        }
        return $this->_link;
    }
}

class LegacyMysqlResult
{

    private $_result;

    public function __construct($result) {

        $this->_result = $result;
    }

    public function getNumberOfRows() {

        return mysql_num_rows($this->_result);
    }

    public function fetchAssoc() {

        return mysql_fetch_assoc($this->_result);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T12:11:11.960

实际上 _write 函数处理程序直到输出流关闭后才执行。

因此你`$_SESSION['test'] = "value";`只是一个数组所以它打印值，

有关此的详细信息在[这里](http://www.tuxradar.com/practicalphp/10/3/7)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-21T21:57:37.460

我不确定我是否理解你的问题。基本上你的脚本只有三行：

```
session_start();

$_SESSION['test'] = "value";

ECHO $_SESSION['test']; 
```

会话管理的要点是，只要会话处于活动状态（在大多数浏览器中，直到您关闭浏览器），您就不必将值保存在数据库中。

您创建一个会话，php 将向您的浏览器发送一个会话 cookie，如果接受该 cookie，只要会话处于活动状态，您就可以在任何页面上输出 $_SESSION['test']。

编辑：查看[http://php.net/manual/de/function.session-start.php](http://php.net/manual/de/function.session-start.php)

# javascript - 如何使用 WebStorm 进行 Chrome 扩展开发？

> ID：13997468
> 
> 赞同：129
> 
> 时间：2012-12-21T21:32:01.537
> 
> 标签：javascript, autocomplete, google-chrome-extension, intellij-idea, webstorm

我刚刚购买了 WebStorm 5，到目前为止，我一直非常喜欢它的检查功能。我在开发 Chrome 扩展程序时遇到的一个问题是它无法识别`chrome`变量：

![未解析的变量或类型 chrome](../Images/561f357d246ce6062b4d138888eb2e94.png)

有没有办法可以将`chrome`变量添加到 Inspector 以便在我键入时自动完成？我猜我需要将 Chromium 添加为外部库，但我不确定从哪里开始。

* * *

## 回答 #1

> 赞同：274
> 
> 时间：2014-08-23T21:53:22.327

## 首次设置

1.  打开`Settings`对话框 ( `File`> `Settings`)

2.  点击`Languages & Frameworks`> `Javascript`>`Libraries`

3.  点击`Download`

4.  确保`TypeScript community stubs`选中

5.  从列表中选择`chrome`（您只需键入即可快速找到它`chrome`）

6.  点击`Download and Install`

7.  单击`OK`以关闭“设置”对话框。

* * *

步骤 2-6 如下所示：

[![Webstorm 截图](../Images/0f41d66baffbf096bd6caa5f8676ccbc.png)](https://i.stack.imgur.com/n4plD.png)

* * *

## 在后续项目中

在任何后续项目中，您只需：

1.  再次打开`Settings`对话框 ( `File`> `Settings`)

2.  再次单击`Languages & Frameworks`> `Javascript`>`Libraries`

3.  查看`chrome-DefinitelyTyped`

4.  单击`OK`以关闭对话框。

* * *

步骤 2-4 如下所示：

[![网络风暴截图](../Images/bc6946013df736dbed7cf83725c011cd.png)](https://i.stack.imgur.com/3Rh2Q.png)

* * *

## 回答 #2

> 赞同：46
> 
> 时间：2012-12-24T08:38:18.977

**更新 2**：

现在支持开箱即用，请参阅[下面的完整答案](https://stackoverflow.com/a/25466708/104891)。

![下载库](../Images/eb1d3159eb494e8e6ec9a16e6cb63ff1.png)

**更新**：

有一个更完整的存根文件可以添加为库来完成代码。它是 Closure Compiler 项目的一部分。下载[chrome_extensions.js](https://raw.githubusercontent.com/google/closure-compiler/HEAD/externs/browser/chrome.js)。

另请参阅[WebStorm 的功能请求，](http://youtrack.jetbrains.com/issue/WEB-3202)以从 IDE 自动添加此库。

* * *

您需要在某处获取 Chrome API 的 JavaScript 库，或者[使用存根来获得基本的完成](https://github.com/linux-china/chrome_js_api_stub)。

[可以在 WebStorm 中配置](http://www.jetbrains.com/webstorm/webhelp/configuring-javascript-libraries.html)库或存根。

* * *

我找到了[带有 Extension API 的 JSON 文件](https://chromium.googlesource.com/chromium/src.git/+/master/chrome/common/extensions/api/)。可以编写一个脚本，从这些 JSON 文件构建 JS 存根，存根可能看起来像上面 GitHub 上链接的基本版本，但通过自动生成，它们将包含几乎完整的 API 和 JSDoc 注释，以便可以查看[像这里这样的文档](https://developer.chrome.com/extensions/api_index.html)直接在IDE中。

JSON => JavaScript 对象存根映射在这种情况下非常简单，编写这种转换器应该不会超过一天（对于熟练的编码人员来说是几个小时）。

如果有人继续执行它，请在此处发布结果链接。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-21T13:24:47.747

WebStorm 有朝一日应该直接接受 json 定义，以便为定义的函数启用自动完成功能。同时，您可以使用[https://github.com/QuickrWorld/jsgen](https://github.com/QuickrWorld/jsgen)上的程序将 json 文件转换为 js 以启用 chrome 扩展 API 的自动完成功能。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2017-07-01T20:36:02.230

**对于编写 AppScript、 DriveApp**、**SpreadsheetApp**等函数和类，WebStorm 或 Intellij 中有一个名为 google-app-script 的插件。
安装方法同上。另一方面，您应该将 .gs 文件标记或打开为 JavaScript。（2017 年 7 月）

# css-position - 文本没有包裹在绝对定位的容器内

> ID：13997469
> 
> 赞同：0
> 
> 时间：2012-12-21T21:32:07.137
> 
> 标签：css-position, word-wrap, css

我创建了绝对定位的工具提示，其中包含`max-width: 200px;`. 但是，div 中的文本不会换行到下一行。即使文本中有空格，它们也会超出容器，因此这不是断字问题。见下图：

**编辑：**工具提示正在从其触发器元素的`title`属性中提取文本，这似乎是问题所在。如果内容是硬编码的，则文本会很好地换行。

![在此处输入图像描述](../Images/f04092b1551d0d8f937cdbcfddfd9e1e.png)

这是HTML：

```
<div class="tooltip">
    <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis malesuada, lectus eget gravida eleifend, odio libero hendrerit elit.</div>
</div> 
```

和CSS：

```
.tooltip{
    padding: 10px;
    position: absolute;
    background: #303030;
    font-size: .9em;
    color: #ccc;
    -moz-border-radius: 3px;
    border-radius: 3px;
    -webkit-box-shadow: 0 5px 10px rgba(0,0,0,.4);
    -moz-box-shadow: 0 5px 10px rgba(0,0,0,.4);
    box-shadow: 0 5px 10px rgba(0,0,0,.4);
}

.tooltip  div{
    max-width: 200px;
    border: 1px solid red; /* See where element is */
} 
```

这似乎很明显，但我想不出问题是什么。任何帮助，将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T09:32:16.113

它可能与您将文本注入`.tooltip`元素的方式有关。尝试这样的事情（使用 jQuery）：

```
$('.trigger').on('click', function() {
  $('.tooltip div').html($('.trigger').attr('title'));
}); 
```

[http://jsfiddle.net/DyxkA/](http://jsfiddle.net/DyxkA/)

# c# - 实体框架错误：PredicateBuilder 异常并比较空值

> ID：13997474
> 
> 赞同：0
> 
> 时间：2012-12-21T21:32:15.663
> 
> 标签：c#, entity-framework, entity-framework-4, predicatebuilder

我能够让我的方法（如下）在 LinqPad 中运行，但是当切换到我的实际代码（使用实体框架）时，我收到了这个错误：

> “无法将类型 'System.Nullable`1' 转换为类型 'System.Object'。LINQ to Entities 仅支持转换 EDM 基元或枚举类型。”

如果我在此处取消注释两个注释行中的任何一个，则会发生错误（实际错误直到方法中的最后一行运行后才会发生）：

```
public List<LotEquipmentScan> GetLotEquipmentScans(string maximoAssetNumber, decimal? manufacturerId, decimal? partNumber)
{
    var predicate = PredicateBuilder.True<LotEquipmentScanRecord>();

    // Note: Can't use == in where clause because of the possibility of nulls. That's why we're using object.Equals().
    if (maximoAssetNumber != "x") { predicate = predicate.And(scan => object.Equals(scan.MaximoAssetNumber, maximoAssetNumber)); }
    //if (manufacturerId != -1) { predicate = predicate.And(scan => object.Equals(scan.RawMaterialLabel.ManufacturerId, manufacturerId)); }
    //if (partNumber != -1) { predicate = predicate.And(scan => object.Equals(scan.RawMaterialLabel.PartNumber, partNumber)); }

    return Db.LotEquipmentScanRecords.AsExpandable().Where(predicate).ToList().Map();
} 
```

我相信这是因为manufacturerId 和partNumber 是可以为**空**的小数。问题是这些变量**可以**为空，我们甚至希望通过它们为空来过滤结果。这只是不适用于 EF，还是有一种优雅的方法来解决这个问题？

**编辑**

需要明确的是，当manufacturerId 作为null 传入时，使用此行会返回五行（我可以通过查看数据库来验证）：

```
if (manufacturerId != -1) { predicate = predicate.And(scan => object.Equals(scan.RawMaterialLabel.ManufacturerId, manufacturerId)); } 
```

使用这一行，不会返回任何行：

```
if (manufacturerId != -1) { predicate = predicate.And(scan => scan.RawMaterialLabel.ManufacturerId == manufacturerId); } 
```

问题是当我传入一个好的制造商 ID 时，我得到了上面的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:38:58.220

**Bob Horn 的编辑/注释：**这个答案被接受是因为下面的编辑，指定了 EF 中的一个错误。这个答案的第一部分没有用。

通过使用`object.Equals(object, object)`as 比较两个值类型的方法（Nullables 也是值类型），您隐式地将它们装箱。实体框架不支持这一点。

尝试改用`==`运算符：

```
// Since scan.RawMaterialLabel.ManufacturerId and manufacturerId are both Nullable<T> of the 
// same type the '==' operator should assert value equality, whether they have a value, or not.

// (int?)1 == (int?)1
// (int?)null == (int?)null
// (int?)1 != (int?)null

predicate = predicate.And(scan => scan.RawMaterialLabel.ManufacturerId == manufacturerId); 
```

对于值类型，`==`运算符断言值相等，类似于 object.Equals() 对引用类型所做的。

**编辑：**

经过进一步调查，旧版本的 EF（EF5 之前）似乎存在一个[错误](http://data.uservoice.com/forums/72025-ado-net-entity-framework-ef-feature-suggestions/suggestions/1015361-incorrect-handling-of-null-variables-in-where-cl?ref=title#suggestion-1015361)。

使用当前版本进行 Hacky 修复：

```
predicate = predicate.And(scan => 
   manufacturerId.HasValue
     ? scan.RawMaterialLabel.ManufacturerId == manufacturerId
     : scan.RawMaterialLabel.ManufacturerId == null); 
```

但如果您的应用程序允许，请升级到 EF5。

# git - 如何使用“git checkout”命令

> ID：13997478
> 
> 赞同：0
> 
> 时间：2012-12-21T21:32:36.697
> 
> 标签：git

我认为下面的这个命令将检查一个远程分支名称'branch_name'并为我创建一个名为'branch_name'的本地分支。

```
'git checkout -b branch_name "`git remote`"/branch_name' 
```

我的问题是

*   尽管我已经有一个分支名称'branch_name'，我怎么能运行它，我可以要求 git it checkout 到 branch_name 甚至（如果该分支已经存在）？

*   当我执行 'git branch -a' 时，我没有看到分支 'remote/branch_name'，我只看到一个分支 'remotes/ser-git/branch_name'。git 如何从 'git remtoe'/branch_name 中找到正确的删除分支？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:39:54.693

> 尽管我已经有一个分支名称'branch_name'，我怎么能运行它，我可以要求 git it checkout 到 branch_name 甚至（如果该分支已经存在）？

使用`-B`选项而不是`-b`

> 当我执行 'git branch -a' 时，我没有看到分支 'remote/branch_name'，我只看到一个分支 'remotes/ser-git/branch_name'。git 如何从 'git remtoe'/branch_name 中找到正确的删除分支？

git 按以下顺序解析引用名称：

1.  如果`$GIT_DIR/<name>`存在，这就是你的意思（这通常只对`HEAD`, `FETCH_HEAD`, `ORIG_HEAD`,`MERGE_HEAD`和有用`CHERRY_PICK_HEAD`）；
2.  否则，`refs/<name>`如果存在；
3.  否则，`refs/tags/<refname>`如果存在；
4.  否则，`refs/heads/<name>`如果存在；
5.  否则，`refs/remotes/<name>`如果存在；**<-这是你的情况**
6.  否则，`refs/remotes/<name>/HEAD`如果它存在。

这意味着如果您有本地分支`ser-git/branch_name`，它将被 git 首选而不是远程分支。

# svn - 尝试使用 Atlassian FishEye 确定代码行 (LOC)

> ID：13997482
> 
> 赞同：1
> 
> 时间：2012-12-21T21:32:59.277
> 
> 标签：svn, atlassian-fisheye

我想确定 subversion 存储库中的代码行 (LOC)。具体来说，我想确定我的团队在生产中支持多少行代码（这与我们的主干同义）。我听说过关于 Atlassian 的 FishEye 工具的大部分好消息，所以我下载了一个版本并开始爬取存储库以捕获数据。正如您[在此处](http://i.stack.imgur.com/zlfPE.jpg)看到的，LOC 指标不可用，并且有一条错误消息指出：“此插件无权访问 ESM/ 的所有存储库数据。某些数据不可用：存储库可能正在编制索引，可能不支持 LOC 或已关闭“存储差异信息”。”

我已根据[此处](https://confluence.atlassian.com/display/FISHEYE/Configuring+repository+details)提供的信息确认为存储库选择了 Store Diff Info 选项。有没有办法确定我们的存储库是否支持 LOC 或者具体可能是什么问题？

提前感谢，布兰登

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T20:20:45.483

Fisheye 通常支持 Subversion 存储库的 LoC，但它仅收集主干数据；检查对trunk 的提交是否确实被识别——因为Subversion 不要求您使用/trunk 作为trunk，Fisheye 的默认[符号规则](https://confluence.atlassian.com/x/eAbSEQ)可能不起作用。

# android - 将 TextView 设置在垂直和水平中心

> ID：13997483
> 
> 赞同：0
> 
> 时间：2012-12-21T21:33:06.403
> 
> 标签：android

我需要将 textView10 设置在垂直和水平的中心。我尝试了很多都没有结果......我尝试了重力选项但没有......任何想法？textView10 在滚动视图中。感谢帮助。

```
<?xml version="1.0" encoding="utf-8"?>
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="fill_parent"
     android:layout_height="fill_parent"
     android:background="#000000"
     android:orientation="vertical" >

 <LinearLayout 
     xmlns:android="http://schemas.android.com/apk/res/android" 
     android:orientation="horizontal" 
     android:layout_width="fill_parent" 
     android:layout_height="wrap_content" 
     android:layout_weight="1">

  <TextView
      android:layout_width="151dp"
      android:layout_height="fill_parent"
      android:textSize="15pt" />

  <ScrollView
      android:id="@+id/scrollView10"
      android:layout_width="wrap_content"
      android:layout_height="match_parent"
      android:background="#000000" >

  <TextView
      android:id="@+id/textView10"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:background="#000000"
      android:gravity="center_vertical"
      android:textAlignment="center"
      android:textColor="#ffffff"
      android:textSize="13sp"
      android:textStyle="italic" />

  </ScrollView>      

 </LinearLayout>

     <Button
         android:id="@+id/button10"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:text="Chiudi" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:35:38.280

将您的外部布局更改为 RelativeLayout 并将您的 ScrollView 定位在父中心。相对于中心的一个元素定位其他元素

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/RelativeLayout1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:orientation="horizontal" >
    <TextView
        android:id="@+id/TextView1"
        android:layout_width="151dp"
        android:layout_height="fill_parent"
        android:textSize="15pt" />
    <ScrollView
        android:id="@+id/scrollView10"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerInParent="true"
        android:background="#000000" >
        <TextView
            android:id="@+id/textView10"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:background="#000000"
            android:gravity="center_vertical"
            android:textAlignment="center"
            android:textColor="#ffffff"
            android:textSize="13sp"
            android:textStyle="italic" />
    </ScrollView>
</RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:48:59.870

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#000000"
android:orientation="vertical" >

<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1"
    android:orientation="horizontal" >

    <TextView
        android:layout_width="151dp"
        android:layout_height="fill_parent"
        android:textSize="15pt" />

    <ScrollView
        android:id="@+id/scrollView10"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:background="#000000" >

        <TextView
            android:id="@+id/textView10"
            android:layout_width="match_parent"
            android:layout_height="320dp"
            android:background="#000000"
            android:gravity="center"
            android:textColor="#ffffff"
            android:textSize="13sp"
            android:text="Hi What is your name"
            android:textStyle="italic" />
    </ScrollView>
</LinearLayout>

<Button
    android:id="@+id/button10"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:text="Chiudi" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:35:41.017

将TextView 放在RelativeLayout 中，然后将该RelativeLayout 放在ScrollView 中。

然后，在 TextView 中设置 android:layout_centerInParent="true"

# python - Flask 应用程序调用 pysphere 中的 UnicodeDecodeError

> ID：13997488
> 
> 赞同：1
> 
> 时间：2012-12-21T21:33:24.773
> 
> 标签：python, flask

我对 Flask 完全陌生。我有一些代码可以使用 pysphere 库将文件复制到虚拟机。这本身就可以正常工作，但是当我尝试使用 Flask 应用程序时，我得到：

```
UnicodeDecodeError: 'ascii' codec can't decode byte 0x90 in position 2: ordinal not in range(128) 
```

起初我认为这只是因为网络表单传递了它不喜欢的东西。但是，我决定对这些值进行硬编码，但它仍然失败。这是代码：

```
@app.route('/begin_install', methods=['POST'])
def begin_install():
    source_installer_path = app.root_path + '/installers'
    installer_file = str(request.form['installer'])
    option_file_path = app.root_path + '/installers/options'
    option_file = 'testing.options'

    vmserver.start_install( request.form['vm'],
                        source_installer_path,
                        installer_file,
                        option_file_path,
                        option_file)

    return render_template('results.html') 
```

然后，在我的 pysphere 相关文件中：

```
def start_install(self, vmpath, installer_path, installer_file, options_path, options_file):
    vm.revert_to_named_snapshot('python_install')
    vm.power_on()
    while vm.get_tools_status() != 'RUNNING':
        sleep(3)
    vm.login_in_guest(self.guest_user, self.guest_password)
    vm.send_file('C:\\folder\\filetosend.exe', 'c:\\installer\\filename.exe') 
```

直到“vm.send_file”的所有内容都运行良好。如果我从非 Flask 应用程序调用相同的代码，它也可以正常工作。当这部分代码都是 pysphere 时，为什么我会从 Flask 收到错误，我对此感到非常困惑。

编辑：这是回溯

```
Traceback (most recent call last):
  File "C:\Users\username\Flask\lib\site-packages\flask\app.py", line 1701, in __call__
    return self.wsgi_app(environ, start_response)
  File "C:\Users\username\Flask\lib\site-packages\flask\app.py", line 1689, in wsgi_app
    response = self.make_response(self.handle_exception(e))
  File "C:\Users\username\Flask\lib\site-packages\flask\app.py", line 1687, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\username\Flask\lib\site-packages\flask\app.py", line 1360, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "C:\Users\username\Flask\lib\site-packages\flask\app.py", line 1358, in full_dispatch_request
    rv = self.dispatch_request()
  File "C:\Users\username\Flask\lib\site-packages\flask\app.py", line 1344, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "C:\python\PycharmProjects\installtest\installtest.py", line 51, in begin_install
    option_file)
  File "C:\python\PycharmProjects\installtest\testmachines.py", line 56, in start_install
    'c:\\installer\\filename.exe')
  File "C:\Users\username\Flask\lib\site-packages\pysphere\vi_virtual_machine.py", line 1282, in send_file
    resp = opener.open(request)
  File "C:\Python27\Lib\urllib2.py", line 400, in open
    response = self._open(req, data)
  File "C:\Python27\Lib\urllib2.py", line 418, in _open
    '_open', req)
  File "C:\Python27\Lib\urllib2.py", line 378, in _call_chain
    result = func(*args)
  File "C:\Python27\Lib\urllib2.py", line 1215, in https_open
    return self.do_open(httplib.HTTPSConnection, req)
  File "C:\Python27\Lib\urllib2.py", line 1174, in do_open
    h.request(req.get_method(), req.get_selector(), req.data, headers)
  File "C:\Python27\Lib\httplib.py", line 958, in request
    self._send_request(method, url, body, headers)
  File "C:\Python27\Lib\httplib.py", line 992, in _send_request
    self.endheaders(body)
  File "C:\Python27\Lib\httplib.py", line 954, in endheaders
    self._send_output(message_body)
  File "C:\Python27\Lib\httplib.py", line 812, in _send_output
    msg += message_body
UnicodeDecodeError: 'ascii' codec can't decode byte 0x90 in position 2: ordinal not in range(128) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T13:33:30.720

正如您在回溯`pysphere`使用`urllib2`中看到的那样，反过来使用`httplib`.

据我所知，httplib 正在连接整个 http 请求，而无需进一步检查 unicode 字符串。如果一部分是 unicode，python 总是返回 unicode。

我认为您的*pysphere*在方法中`request`或方法中会以某种方式被 unicode污染：`opener``send_file`

```
  文件“C:\Users\username\Flask\lib\site-packages\pysphere\vi_virtual_machine.py”，第 1282 行，在 send_file
    resp = opener.open(请求)

```

你应该检查你是如何创建resp的。配置您的`vm`实例，并可能详细说明哪个标头是 unicode 以及它如何影响`request`或`opener`实例化。

# sql-server - 比较 2 个大型数组的最快方法 - 大数据

> ID：13997490
> 
> 赞同：1
> 
> 时间：2012-12-21T21:33:47.623
> 
> 标签：sql-server, nosql, bigdata

我有一个大约 10 毫米散列的数据集。我需要允许人们将哈希列表与那些进行比较，以查看它们是否匹配。现在我们使用 sql 并基本上扫描它以查找猜测数组中的每个项目。这适用于大约 10K，但用户需要检查更大的集合，例如 200K 哈希与 10mm 哈希字典

在 sql 或 nosql 或其他中，这可能是一个好方法

--

对于意图的上下文，我们管理一个选择退出列表，并允许营销经理上传一张针对它的表格，我们返回一个干净且无邮件的文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:45:55.687

如果您可以在表中提供搜索值，则 EXCEPT 查询可能是您最好的选择。这将为您提供不在表 2（选择退出列表）中的表 1（搜索值）的所有条目。除了示例，请参阅我的帖子：http: [//sqlity.net/en/1401/a-join-a-day-except/](http://sqlity.net/en/1401/a-join-a-day-except/)

如果由于搜索值不在数据库中而无法选择，请创建一个包含所有 1000 万个哈希值的内存驻留哈希表，并使用它来确定给定电子邮件是否是列表的一部分。即使您必须为每个批次重新构建该表，它也会比向数据库发送 200k 请求要快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T06:11:35.990

由于系统负载增加，当前的解决方案似乎无法扩展，即添加更多内存、cpu 等来维持用户所需的响应解决方案不再可能。

保持响应能力的一种方法是实施可扩展的可扩展解决方案，即跨多个系统分布工作负载。

例如，如果您可以有 10 个系统，每个系统在 nosql 中都有 1000 万哈希的本地副本，那么当请求检查 200K 哈希时，工作可能会分布在 10 个系统上，每个系统都处理检查 20K 哈希的请求.

这是经典的分而治之的方法。

伪代码类似于

```
while (1) {                   
    wait for a request to come in;

    for (j = 1; j < 10; j++) {
        spawn(system[j], 1/10 of the request for matching)
    }   

    wait for/collect responses from 10 systems

    return result;
} 
```

当进行任何更改（例如添加/删除）时，系统上的本地副本必须保持一致。

# c# - System.IO.FileNotFoundException: myCSharpDemoCalc\work\MyCSharpDemoCalc.j4n.dll

> ID：13997491
> 
> 赞同：0
> 
> 时间：2012-12-21T21:33:54.027
> 
> 标签：c#, java, jni4net

jni4net 不生成 MyCSharpDemoCalc.j4n.dll。generateProxy 说它有，但文件没有被创建。因此，我得到 System.IO.FileNotFoundException。这是 jni4net 中的错误吗？我正在使用版本 0.8.6.0

```
D:\Temp\jni4net\samples\myCSharpDemoCalc>generateProxies
..\..\lib\jni4net-LGPL-3.0.txt
..\..\lib\jni4net.j-0.8.6.0.jar
..\..\lib\jni4net.n-0.8.6.0.dll
..\..\lib\jni4net.n.w32.v20-0.8.6.0.dll
..\..\lib\jni4net.n.w32.v40-0.8.6.0.dll
..\..\lib\jni4net.n.w64.v20-0.8.6.0.dll
..\..\lib\jni4net.n.w64.v40-0.8.6.0.dll
    7 file(s) copied.
jni4net.proxygen - Copyright (C) 2009 Pavel Savara - licensed under GPLv3
will generate JVM mycsharpdemocalc.icalc
will generate JVM mycsharpdemocalc.democalc
proxygen done
compile classes
MyCSharpDemoCalc.j4n.jar
MyCSharpDemoCalc.j4n.dll
csc: file `/nologo' does not exist
compiling usage

D:\Temp\jni4net\samples\myCSharpDemoCalc>run

D:\Temp\jni4net\samples\myCSharpDemoCalc>cd work 
```

> D:\Temp\jni4net\samples\myCSharpDemoCalc\work>java -cp jni4net.j
> -0.8.6.0.jar;MyCSharpDemoCalc.j4n.jar;。线程“主” System.IO.FileNotFoundException 中的 MyCalcUsageInJava 异常：
> D:\Temp\jni4net\samples\myCSharpDemoCalc\work\MyCSharpDemoCalc.j4n.dll at net.sf.jni4net.Bridge.LoadAndRegisterAssemblyFromClassLoader(File assemblyFile, ClassLoader classLoader) at net .sf.jni4net.Bridge.LoadAndRegisterAssemblyFrom(File assemblyFile)
> at net.sf.jni4net.__Bridge.LoadAndRegisterAssemblyFrom3(IntPtr __envp, JniLocalHandle __class, JniLocalHandle assemblyFile) at net.sf.jni4net.Bridge.LoadAndRegisterAssemblyFrom(Native Method) at MyCalcUsageInJava.main (MyCalcUsageInJava.java:11)

**其他人有同样的问题吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-22T14:24:07.473

问题就在这里

csc: 文件 `/nologo' 不存在

您必须将 DotNet 编译器的路径（在我的情况下为 C:\Windows\Microsoft.NET\Framework64\v4.0.30319）放在变量 environemnet 中。它有效

# macos - Mac 重置密码提示

> ID：13997492
> 
> 赞同：4
> 
> 时间：2012-12-21T21:33:53.970
> 
> 标签：macos, passwords, reset

因此，我将尽我所能解释我正在寻求帮助的内容。

所以我正在寻找一种方法来创建类似于 Windows 的密码重置提示。例如，当 Windows 域上的密码过期时，它会询问当前密码和新密码。

这是我所指的截图：http: [//moritzlaw.osu.edu/technology/training/Windows7/PasswordPrompt.jpg](http://moritzlaw.osu.edu/technology/training/Windows7/PasswordPrompt.jpg)

我正在寻找一种在不在域中的 Mac 上执行相同操作的方法。我希望创建某种类型的工具或脚本来运行，以便下次用户登录时，他们必须更改密码。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T22:26:48.713

当用户密码过期时，loginwindow 会自动执行此操作；唯一的技巧是使本地用户的密码过期。您可以使用以下`pwpolicy`命令执行此操作：

```
pwpolicy -a adminuser -u usertoforcechange -setpolicy "newPasswordRequired=1" 
```

您可以设置一堆策略，包括最小长度、至少一个字母、至少一个数字、有效期等。有关详细信息，请参阅[pwpolicy 手册页](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man8/pwpolicy.8.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:44:14.043

您可以通过更改 com.apple.loginwindow plist 中的默认设置来强制非 activeDirectory 非 OpenDirectory 帐户的密码过期。如果您希望它现在过期，NUMBER 应为 0，或者您希望密码有效的天数为 NUMBER。

```
sudo defaults write /Library/Preferences/com.apple.loginwindow PasswordExpirationDays NUMBER 
```

# c++ - Boost asio串口初始发送坏数据

> ID：13997499
> 
> 赞同：0
> 
> 时间：2012-12-21T21:34:25.783
> 
> 标签：c++, boost, serial-port, boost-asio

我正在尝试使用 boost asio 进行串行通信。我目前在 Windows 中工作，但最终会将代码转移到 Linux 中。当我重新启动我的计算机时，从程序发送的数据不是它应该是的（例如，我发送一个空值，后跟一个回车并得到二进制的“00111111 10000011”）并且它不一致（多个空值产生不同的二进制文件） .

但是，只要我使用任何其他程序将任何数据发送到串行端口并再次运行该程序，它就会完美运行。我想我在端口的初始化中一定遗漏了一些东西，但我的研究没有发现任何东西。

这是我打开端口的方式：

```
// An IOService to get the socket to work
boost::asio::io_service *io;
// An acceptor for getting connections
boost::shared_ptr<boost::asio::serial_port> port;

// Cnstructor Functions
void Defaults() {
    io = new boost::asio::io_service();

    // Set Default Commands
    command.prefix = 170;
    command.address = 3;
    command.xDot[0] = 128;
    command.xDot[1] = 128;
    command.xDot[2] = 128;
    command.throtle = 0;
    command.button8 = 0;
    command.button16 = 0;
    command.checkSum = 131;
}

void Defaults(char * port, int baud) {
    Defaults();

    // Setup the serial port
    port.reset(new boost::asio::serial_port(*io,port));
    port->set_option( boost::asio::serial_port_base::baud_rate( baud ));

    // This is for testing
    printf("portTest: %i\n",(int)port->is_open());
    port->write_some(boost::asio::buffer((void*)"\0", 1));
    boost::asio::write(*port, boost::asio::buffer((void*)"\0", 1));
    boost::asio::write(*port, boost::asio::buffer((void*)"\r", 1));
    boost::asio::write(*port, boost::asio::buffer((void*)"\r", 1));
    Sleep(2000);
} 
```

**编辑：**为了删除不相关的代码，我不小心删除了设置波特率的行，我将其添加回来。此外，我正在使用空调制解调器和 Docklight 检查输出。除了波特率之外，我还使用了为升压串行端口指定的所有默认串行设置（我也尝试过明确设置它们但没有效果）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:02:14.237

您还没有说您如何检查正在发送的内容，但这可能是两端之间的波特率不匹配。

看起来你错过了这个：

```
port->set_option( boost::asio::serial_port_base::baud_rate( baud ) ); 
```

如果数据位数、奇偶校验位、起始位和停止位与默认值不同，也需要配置它们。

如果还是不能排序，就在输出端贴个示波器，对比一下发送端和接收端的波形。你会看到这样[的](http://www.ee.nthu.edu.tw/jcliao/mic97/chap12R/F12_18.JPG)东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-05-15T15:45:44.973

这是查找此问题时的热门搜索结果，所以我想我会给出我认为正确的答案：

在撰写本文时，Boost Asio 存在错误，并且没有为 Windows 平台上的端口设置默认值。相反，它会获取端口上的当前值，然后将它们重新烘焙。重新启动后，端口尚未使用，因此其 Windows 默认值可能对通信没有用（字节大小通常默认为9，例如）。将端口与正确设置值的程序或库一起使用后，Asio 之后获取的值是正确的。

要在 Asio 合并修复之前解决此问题，只需明确设置端口上的所有内容，即：

```
using boost::asio::serial_port;
using boost::asio::serial_port_base;

void setup_port(serial_port &serial, unsigned int baud)
{
    serial.set_option(serial_port_base::baud_rate(baud));
    serial.set_option(serial_port_base::character_size(8));
    serial.set_option(serial_port_base::flow_control(serial_port_base::flow_control::none));
    serial.set_option(serial_port_base::parity(serial_port_base::parity::none));
    serial.set_option(serial_port_base::stop_bits(serial_port_base::stop_bits::one));
} 
```

# c++ - 试图读取整个文本文件

> ID：13997500
> 
> 赞同：1
> 
> 时间：2012-12-21T21:34:33.510
> 
> 标签：c++, objective-c, cocoa

我正在尝试读取 txt 文件的全部内容，而不是逐行读取，而是全部包含

并在 xcode 中的文本字段内的屏幕上打印它

我正在使用 obj-c 和 c++ lang 的混合：

```
while(fgets(buff, sizeof(buff), in)!=NULL){
        cout << buff;  // this print the whole output in the console

         NSString * string = [ NSString stringWithUTF8String:buff ] ;

         [Data setStringValue:string]; // but this line only print last line inside the textfield instead of printing it all
    } 
```

我正在尝试打印文件的全部内容，例如：

1.  某物...
2.  某物...
3.  ETC...

但它只是将最后一行打印到文本字段，请帮助我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:39:01.030

您是否有理由不使用 Obj-C 来读取文件？这很简单：

```
NSData *d = [NSData dataWithContentsOfFile:filename];
NSString *s = [[[NSString alloc] initWithData:d encoding:NSUTF8StringEncoding] autorelease];
[Data setStringValue:s]; 
```

编辑：要使用你现在拥有的代码，我会尝试这样的事情：

```
while(fgets(buff, sizeof(buff), in)!=NULL){
  NSMutableString *s = [[Data stringValue] mutableCopy];
  [s appendString:[NSString stringWithUTF8String:buff]];
  [Data setStringValue:s];
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:36:58.143

读取文件，将内容作为 C++ 字符串返回：

```
 // open the file
  std::ifstream is; 
  is.open(fn.c_str(), std::ios::binary);

  // put the content in a C++ string
  std::string str((std::istreambuf_iterator<char>(is)),
                   std::istreambuf_iterator<char>()); 
```

在您的代码中，您使用的是 C api（`FILE*`来自 cstdio）。在 C 中，代码更复杂：

```
char * buffer = 0; // to be filled with the entire content of the file
long length;
FILE * f = fopen (filename, "rb");

if (f) // if the file was correctly opened
{
  fseek (f, 0, SEEK_END);  // seek to the end
  length = ftell (f);      // get the length of the file
  fseek (f, 0, SEEK_SET);  // seek back to the beginning
  buffer = malloc (length); // allocate a buffer of the correct size
  if (buffer)               // if allocation succeed
  {
    fread (buffer, 1, length, f);  // read 'length' octets
  }
  fclose (f); // close the file
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T02:58:55.817

要回答*为什么*您的解决方案不起作用的问题：

> ```
> [Data setStringValue:string]; // but this line only print last line inside the textfield instead of printing it all 
> ```

假设它`Data`引用一个文本字段，`setStringValue:`用您传入的字符串替换该字段的全部内容。您的循环一次读取并设置一行，因此在任何给定时间，`string`都是文件中的一行。

只有当您没有在主线程上执行任何其他操作时，才会告诉视图显示，因此您的循环（假设您没有在另一个线程或队列上运行它）不会一次打印一行。您读取每一行并用该行替换文本字段的内容，因此当您的循环完成时，该字段将保留您设置的最后一个内容`stringValue`- 文件中的最后一行。

一次性吞下整个文件是可行的，但仍然存在一些问题：

*   文本字段不适用于显示多行。无论您如何阅读文件，您仍然将其内容放在不是为此类内容设计的地方。
*   如果文件足够大，读取它会花费大量时间。如果您在主线程上执行此操作，那么在此期间，应用程序将被挂起。

一个适当的解决方案是：

1.  使用文本视图，而不是文本字段。文本视图是为处理任意行数的文本而构建的，当您在 nib 中创建一个文本视图时，它会免费包含在滚动视图中。
2.  一次读取文件一行或其他有限大小的块，但不是在一个`for`或`while`循环中。使用 NSFileHandle 或`dispatch_source`，它们中的任何一个都会在读取文件的另一块时调用您提供的块。
3.  Append each chunk to the text view's storage instead of replacing the entire text with it.
4.  Show a progress indicator when you start reading, then hide it when you finish reading. For extra credit, make it a determinate progress bar, showing the user how far you've gotten through the file.

# jquery - Jquery AutoComplete - 没有从函数获取返回值

> ID：13997501
> 
> 赞同：1
> 
> 时间：2012-12-21T21:34:40.883
> 
> 标签：jquery, get, return, each

我敢肯定我的编码有一百万个问题......

然而，除了自动完成之外，一切正常。

我似乎无法从我的 searchResults 函数返回值。

我想返回字符串。

现在

```
 alert("t: " + availableTags); 
```

工作但

```
 alert("x: " + availableTags); 
```

才不是

返回行都不返回值。

我究竟做错了什么？

```
$(function(){
    //$("#searchButton").click(function(){
    //$("input").keyup(function(e){

    var availableCompanies = searchResults('CompanyName',false);
    var availableLocations = searchResults('Location',false);
    $("input[id^='CompanyName']").keyup(function(){ 
        //alert("CN");  
        searchResults('CompanyName',true);          
    });//$("input[id=CompanyName]").keyup(function(e){  
    $("input[id^='Location']").keyup(function(){    
        searchResults('Location',true);         
    }); 
    $("input[id^='serving']").keyup(function(){ 
        searchResults('serving',true);          
    });
    $( "#CompanyName" ).autocomplete({
        source: availableCompanies
    });
    $( "#Location" ).autocomplete({
        source: availableLocations
    });
    alert(availableCompanies);

})//$(function(){})  

function searchResults(which,populate,availableTags){
    //clear search results
    $("#searchResults").text("");
    //clear available tags
    //jqxAlert.alert(which);
    //var sSearch = $("#search").val();
    var sSearch =  $("input[id='"+which+"']").val();
    var url = "search.asp?" + which + "=" + sSearch;
    //alert(url);
    var availableTags = "";

    $.get(url, function(data){
        //$('#searchResults').html(data);
        var uid =""
        var company = ""; 
        var location = "";
        var phone1 = "";
        var phone2 = "";
        var phone3 = "";
        var html = "";
        var sql = "";
        var i = 1;

        if ($('company',data).text() == ""){
            $("#searchResults").html("<tr><td>Sorry, there are no results.</td></tr>");
        };

        $.each($('company',data),function(index, el) {  
            uid = $(this).find('uid').text();
            companyName = $(this).find('CompanyName').text();
            location = $(this).find('location').text();
            //phone1 = $(this).find('phone1').text();
            //phone2 = $(this).find('phone2').text();
            //phone3 = $(this).find('phone3').text();
            //serving = $(this).find('serving').text();
            //sql = "<br />" + $(this).find('sql').text() + "<br />";

            //alert(which == "CompanyName");
            if (which == "CompanyName"){
                //availableTags = availableTags + companyName;
                if (availableTags.indexOf(companyName) < 0){
                    if (availableTags == "") {
                        availableTags = companyName;
                    }else{
                        availableTags = availableTags + "," + companyName;
                    }
                }               
            }
            if (which == "Location"){
                if (availableTags.indexOf(Location) < 0){
                    if (availableTags == "") {
                        availableTags = Location;
                    }else{
                        availableTags = availableTags + "," + Location;
                    }
                }
            }   

            if (sSearch != ""){
                if (i % 2 == 0){
                    html = '<div id="c_' + uid + '" class="bgGrey">';
                }else{
                    html = '<div id="c_' + uid + '" class="bgWhite">';
                }
                html = html + "<tr>";
                html = html + "<td><b>&larr;</b>" + companyName + " (" + location + ")</td>";

                //html = html + company + " " + location ;
                html = html + "</tr>";
                html = html + "</div>";

                //$("#searchResults").append(i + ' ' +x + ' ' + y + ' ' + sql + html);
                $("#searchResults").append(html);
            }
            i++;
        }); //$.each($('company',data),function(index, el) {

        if (populate){
            PopulateFields();       
        }else{
            alert("t: " + availableTags);
            return "test";  
        }

    }).error(function() {
        $("#searchResults").html("<tr><td>Results could not be retrieved. Alert T. McDermott</td></tr>");
    }); //$.get(url, function(data){    
    alert("x: " + availableTags);
    return availableTags;   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:39:50.697

您正在返回**ajax request 之外**的值，因此其中的部分`$.get()`仍在从服务器获取数据。你不能这样操作，因为它是一个异步操作。您有 2 个主要选项：

1.  使其同步（不好，这会锁定大多数浏览器）
2.  通过在完成后调用下一个函数来很好地处理异步行为。

你应该做的是`someOtherFunction(availableTags);`在你的函数结束时调用`$.get(url, function(data){ })`，它有数据并且可以将它传递给任何需要它的地方。

您正在查看的是`function(data) { }`服务器将数据发送回浏览器后执行，然后您可以处理它，因此您希望从那里继续。

# get - 如何在不使用完整 URL 的情况下从另一个子域上的文件夹中检索文件

> ID：13997502
> 
> 赞同：1
> 
> 时间：2012-12-21T21:34:59.370
> 
> 标签：get, include

我有一个需要包含在“area2.mysite.com/index.php”中的文件“area1.mysite.com/gallery/settings.php”。问题是我不能使用完整的 url 我需要从 /area2/www/index.php 倒退到 /area1/www/gallery/setting.php ......这会产生气味吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:49:44.113

当然这可以使用相对链接来完成？所以你会包括

```
../../../area1/www/gallery/setting.php 
```

只要这是您在问题中的正确文件设置...但是基本上每个 ../ 都会将您向上移动一个文件夹，然后您可以像使用非相对链接一样向下跳

# java - 同一类中的多个 JComboBox 事件处理

> ID：13997503
> 
> 赞同：0
> 
> 时间：2012-12-21T21:35:14.557
> 
> 标签：java, swing

我有两个 JComboBox 和一个按钮。如果我从两个组合框中分别选择一个项目并按下名为搜索的按钮，我正在尝试这样做。然后从两个组合框中选择的两个项目将保存在一个新的两个单独的字符串中。

请任何人帮助我解决问题。

这是代码片段

```
//here is the strings that in the combo box
String lc[] = {"Kolabagan-Dhaka", "Gabtoli-Dhaka", "Fakirapul-Dhaka", "Shaymoli-Dhaka"};
String rc[] = {"Banani-Bogra", "Rangpur","Shatrasta-Bogra"};

//here is my two jcombo box
JComboBox lcCombo = new JComboBox(lc);
JComboBox rcCombo = new JComboBox(rc);
// here is my search button
JButton searchButton = new JButton("Search"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:45:18.630

有两种方法可以解决这个问题。第一个是有一个实现的类，`ActionListener`并在实现中检查源代码（`ActionEvent.getSource()`）。根据引发事件的组件，您可以采取适当的措施。

另一种选择（也是我的偏好）是`ActionListener`为每个需要一个的组件创建一个。如果您不想为每种情况明确定义一个，则可以使用匿名类。这样，每个侦听器都确切地知道是什么组件导致了事件以及要采取什么行动。

例子：

```
JComboBox lcCombo = new JComboBox(lc);
lcCombo.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent event) {
    //do left stuff
  }
});
JComboBox rcCombo = new JComboBox(rc);
rcCombo.addActionListener(new ActionListener() {
  public void actionPerformed(ActionEvent event) {
    //do right stuff
  }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:15:34.300

要扩展 unholysampler，一旦您开始`ActionListener`工作，您就可以使用`lcCombo.getSelectedIndex()`它来检查已选择的项目。

# extjs - 大规模 EXT JS 应用

> ID：13997507
> 
> 赞同：1
> 
> 时间：2012-12-21T21:35:36.190
> 
> 标签：extjs

我正在启动一个大型 EXT JS 应用程序，想知道是否有人知道任何有用的资源。到目前为止，我所看到的一切都是单页应用程序。我想在前端使用 MVC。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T09:23:52.420

@Sra 的评论是这里最合适的回应。

关于“单页应用程序”当然可以用于更大规模的项目，但需要仔细管理代码和 DOM。

我认为您可能需要提供更多关于您计划如何做事以及您担心什么的信息。

Ext 提供了客户端 MVC 实现，但这确实倾向于以单页应用程序模型为中心。这意味着您编写模型、视图和控制器，并让您的应用程序决定渲染哪个。该应用程序负责创建和处理客户端控制器和视图实例，模型实际上只是为了验证数据并提供从服务器端发送/检索数据的合理机制。

如果您想使用典型的服务器端 MVC 实现，例如 ASP.NET MVC，那么应该注意的是，除非应用程序很大，否则您可能只会得到一个 .NET“视图”，这个视图将包含您的整个 ExtJS 应用程序。

如果您愿意，您“可以”通过 Ext 创建一系列迷你应用程序并在多个服务器端视图中呈现这些应用程序，但您最终会得到大量重复（或共享）的代码，这可能很难管理。

总而言之，是的，您可以将 Ext 用于更大的应用程序，是的，您可以使用 MVC（客户端和服务器端），最后是的，您的前端可能会形成一个单页应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T23:03:01.333

只是为@d​​ougajmcdonald 的出色答案添加一点：Ext JS 4.2 中出现了对 MVC 架构和依赖处理的改进，专门针对手头上有大型应用程序的人。在相关应用程序之间共享代码会容易得多，这也将使编写*多*页应用程序更容易。

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-12-21T22:06:48.783

EXTjs 不应该在单页中编码。EXTjs 4 支持 MVC 架构。

[http://docs.sencha.com/ext-js/4-1/#!/guide/application_architecture](http://docs.sencha.com/ext-js/4-1/#!/guide/application_architecture)

请 sencha 命令也。它可以帮助您创建 MVC 应用程序的主干

[http://docs.sencha.com/ext-js/4-1/#!/guide/command](http://docs.sencha.com/ext-js/4-1/#!/guide/command)

# c# - 将图像添加到图片框

> ID：13997509
> 
> 赞同：2
> 
> 时间：2012-12-21T21:35:39.043
> 
> 标签：c#, winforms, image, transparent, picturebox

我正在写一个简单的游戏 - 蛇。我想有背景和我的蛇。我认为最好的方法是使用两个图片框（一个有背景，第二个 - 透明，上面有蛇）。

这是个好办法吗？以及如何将几个小图像（蛇的片段）放在不同位置的一个图片框上（只需将像素（一个接一个）从图像复制到图片框，或者也许有最快的方法 - 将所有图像放在正确的位置）？我现在有带有背景（父）和另一个透明（子）的图片框。

结果应该是这样的：

![示例图像](../Images/da6ae5835dfb249552bb48793b71865b.png)

我做了类似的东西（感谢@dotTutorials），但我的蛇的片段比原始图像大一点，cookie 更小。哪里可能有问题？

绘图代码：

```
public Bitmap PrinPlayground()
{

    char[,] tempPitch = play.getPitch();

    Graphics g = pb2.CreateGraphics();
    Bitmap bitmap = new Bitmap(512, 512);
    Graphics BBG = Graphics.FromImage(bitmap);

    Bitmap head = CookieSnake.Properties.Resources.head;
    Bitmap body01 = CookieSnake.Properties.Resources.body01;
    Bitmap tail = CookieSnake.Properties.Resources.tail;
    Bitmap cookie = CookieSnake.Properties.Resources.cookie;

    BBG.Clear(Color.Transparent);

    for (int i = 0; i < 16; i++)
        for (int j = 0; j < 16; j++)
        {
            if (tempPitch[i, j] == 'H')
            {
                BBG.DrawImage(head, new Point(32*j, 32*i));
            }
            else if (tempPitch[i, j] == 'B')
            {
                BBG.DrawImage(body01, new Point(32*j, 32*i));
            }
            else if (tempPitch[i, j] == 'T')
            {
                BBG.DrawImage(tail, new Point(32 * j, 32 * i));
            }
            else if (tempPitch[i, j] == 'C')
            {
                BBG.DrawImage(cookie, new Point(32 * j, 32 * i));
            }
        }
    g.DrawImage(bitmap, new Point(0,0));
    return bitmap;
} 
```

结果：

![在此处输入图像描述](../Images/2546347d9cbf4b8280b9b8809a36b69d.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:40:10.420

实现这一点的最佳方法绝对是使用“图形”类。请进一步查看 GDI 和命名空间[`System.Drawing`](http://msdn.microsoft.com/en-us/library/system.drawing.aspx)。

如果你想使用一个代表游戏空间的 Picturebox，你也可以通过调用 member 轻松地将图形实现到一个 Picturebox 中`CreateGraphics`。

我希望这可以帮助你！:) **请注意，当您开始认真的游戏开发时，您必须找到比 GDI 更好的替代方案。我个人更喜欢 XNA 库**

GDI 的用法示例 [这个写得很快，不应该复制粘贴。然而; 这是一个很好的起点:)]

```
 Graphics g = pictureBox1.CreateGraphics();
    Bitmap BB = new Bitmap(pictureBox1.Width, pictureBox1.Height);
    Graphics BBG = Graphics.FromImage(BB);

    Bitmap Background = (Bitmap)Bitmap.FromFile("BackgroundPicture.png");
    Bitmap Head = (Bitmap)Bitmap.FromFile("SnakeHead.png");
    Bitmap Tail = (Bitmap)Bitmap.FromFile("SnakeTail.png");

    Point snakeLocation = new Point((BB.Width / 2) - (Head.Width / 2), (BB.Height / 2) - (Head.Height / 2));

    while (true) {
        #region Update
        // update method here!
        snakeLocation.X += 1;
        #endregion

        #region Draw
        BBG.Clear(Color.CornflowerBlue);
        BBG.DrawImage(Background, new Point(0, 0));

        BBG.DrawImage(Head, snakeLocation);
        BBG.DrawImage(Tail, new Point(snakeLocation.X - Head.Width, snakeLocation.Y));

        g.DrawImage(BB, new Point(0, 0)); // draw to screen
        #endregion
    } 
```

**更新：** DrawImage 方法也接受 RectangleF 输入。一个 RectangleF 包含 4 种数据类型，float X、float Y、float Width 和 float Height。

使用 RectangleF，您可以轻松指定绘制图像的大小。看看下面的代码：

```
public Bitmap PrinPlayground() {

            char[,] tempPitch = play.getPitch();

            Graphics g = pb2.CreateGraphics();
            Bitmap bitmap = new Bitmap(512, 512);
            Graphics BBG = Graphics.FromImage(bitmap);

            Bitmap head = CookieSnake.Properties.Resources.head;
            Bitmap body01 = CookieSnake.Properties.Resources.body01;
            Bitmap tail = CookieSnake.Properties.Resources.tail;
            Bitmap cookie = CookieSnake.Properties.Resources.cookie;

            BBG.Clear(Color.Transparent);

            for (int i = 0; i < 16; i++)
                for (int j = 0; j < 16; j++) {
                    if (tempPitch[i, j] == 'H') {
                        BBG.DrawImage(head, new RectangleF(new Point(32 * j, 32 * i), new SizeF(/*Adjust the size after your pleasure*/32, 32)));
                    }
                    else if (tempPitch[i, j] == 'B') {
                        BBG.DrawImage(body01, new RectangleF(new Point(32 * j, 32 * i), new SizeF(32, 32)));
                    }
                    else if (tempPitch[i, j] == 'T') {
                        BBG.DrawImage(tail, new RectangleF(new Point(32 * j, 32 * i), new SizeF(32, 32)));
                    }
                    else if (tempPitch[i, j] == 'C') {
                        BBG.DrawImage(cookie, new RectangleF(new Point(32 * j, 32 * i), new SizeF(/*Half the size of the head [Adjust after your needs!]*/32 / 2, 32 / 2)));
                    }
                }
            g.DrawImage(bitmap, new Point(0, 0));
            return bitmap;
        }
    } 
```

# ms-access - 关闭表单时会触发什么 VBA 事件？

> ID：13997515
> 
> 赞同：3
> 
> 时间：2012-12-21T21:36:00.043
> 
> 标签：ms-access

如果我没有填写表单中的所有必填字段，当我单击右上角的“x”时会出现一个丑陋的错误。我想用自定义错误消息覆盖默认错误，但我无法确定将此代码与哪个 VBA 事件相关联。当我在其中放置错误处理程序时，Form_Close 事件似乎不起作用。

访问 2010

```
Private Sub Form_Unload(Cancel As Integer)
On Error GoTo Err_Unload          ' Initialize error handling.
    'insert routine
Exit_Unload:                      ' Label to resume after error.
    Exit Sub                      ' Exit before error handler.
Err_Unload:                       ' Label to jump to on error.
    'MsgBox Err & " " & Error$    ' Place error handling here.
    Resume Exit_Unload
End Subenter code here 
```

即使在使用此代码时仍然收到错误。

```
Private Sub Form_Unload(Cancel As Integer)
On Error GoTo Err_Unload          ' Initialize error handling.
    ' Code to do something here.
Exit_Unload:                          ' Label to resume after error.
    Exit Sub                  ' Exit before error handler.
Err_Unload:                           ' Label to jump to on error.
    'MsgBox Err & " " & Error$           ' Place error handling here.
    Resume Exit_Unload
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:50:36.360

从[http://office.microsoft.com/en-us/access-help/order-of-events-for-database-objects-HP005186761.aspx](http://office.microsoft.com/en-us/access-help/order-of-events-for-database-objects-HP005186761.aspx)，

> 同样，当您关闭表单时，会发生以下事件序列：
> 
> Exit（控件）→ LostFocus（控件）→ Unload（表单）→ Deactivate（表单）→ Close（表单）
> 
> 如果您更改了控件中的数据，则控件和窗体的 BeforeUpdate 和 AfterUpdate 事件都会在控件的 Exit 事件之前发生。

当表单尝试保存您的更改但由于您没有填写必填字段而失败时，可能导致您的错误的是 BeforeUpdate 事件。您可以创建一些验证代码并在表单的 BeforeUpdate 事件中运行它，以确保一切正常并向用户发送适当的消息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-23T18:15:00.430

当您尝试关闭对表单的当前记录有未保存更改的表单时，Access 将首先尝试提交这些更改。您无法从`Form_Unload`或拦截该操作`Form_Close`。

顺便说一句，虽然您没有提到它，但如果您要导航的记录包含未保存的更改且必填字段缺少值，我希望您在导航到不同的记录时看到相同的内容。

如果表单的记录源包含带有自动编号字段的表，请使用表单的更新前事件来检查是否存在所需的值。如果不涉及自动编号字段，请考虑从表单的插入前和更新前事件进行检查。

但是，如果这样做的全部目的是为必填字段中的缺失值获取更友好的消息，请查看更改表的属性是否令人满意。例如，您可以设置`Required`为`No`，然后使用`Is Not Null`字段的`Validation Rule`，这将允许您将友好的文本消息分配为字段的`Validation Text`属性。

![表设计必需和验证属性](../Images/d05b18abe125a2ecd98246d46086d1a6.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T21:37:18.797

您可能喜欢使用：

```
Private Sub Form_Unload(Cancel As Integer)

End Sub 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-24T22:17:48.047

实际上有一个名为 的表单事件`On Error`，它有两个参数：错误是什么以及 Access 应该执行什么响应。

# php - PHP Imagick 创建 GIF 动画

> ID：13997518
> 
> 赞同：0
> 
> 时间：2012-12-21T21:36:12.880
> 
> 标签：php, animation, imagick

我有一些 JPEG 文件，我想用它们创建一个 GIF 动画。但是，此代码不起作用。你能看出问题所在吗？

```
// animation
$animation = new Imagick();
$animation->setFormat("GIF");

// frames
foreach($tmpJpegPath as $jpepPath) {
    $frame = new Imagick($jpepPath);
    $frame->thumbnailImage(176, 144);
    $animation->addImage($frame);
    $animation->setImageDelay(100);
    $animation->nextImage();
}

// save gif animation
$animation->writeImages('./animation.gif', true); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T10:59:54.490

问题已解决... imagick 必须 >= 3.1.0RC1

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-17T12:55:12.103

我对 debian wheezy 上的最新 php5-imagick 软件包有同样的问题。

**我的解决方案：**

我们肯定会删除包裹

```
apt-get remove php5-imagick 
```

这是下一步所需要的

```
apt-get install libmagickwand-dev 
```

从 pecl 安装 imagick

```
pecl install imagick
echo "extension=imagick.so" >> /path/to/your/php.ini 
```

完毕

# css - IE8 和 IE9 中的绝对定位

> ID：13997522
> 
> 赞同：0
> 
> 时间：2012-12-21T21:37:02.247
> 
> 标签：css, internet-explorer

以下 HTML/JS 视频库在 Safari、Firefox 和 Chrome 上运行良好，但无法在 IE 中正确呈现（谁会猜到）

[http://vimeography.com/themes/journey/](http://vimeography.com/themes/journey/)

*   缩略图有一个绝对定位的`a`元素，应该出现在鼠标悬停上
*   视频海报框架图像的`span`标题应该出现在海报框架的顶部，但标题却出现在图像的右侧。

如何正确调整此 CSS 以在 IE8 和 9 中兼容？

# php - 警告：session_start() [function.session-start] Wordpress 仪表板上的错误

> ID：13997523
> 
> 赞同：0
> 
> 时间：2012-12-21T21:37:08.623
> 
> 标签：php, html, css, wordpress

> **可能重复：**
> [无法修改标头信息 - 标头已发送，为什么会发生标](https://stackoverflow.com/questions/1827314/cannot-modify-header-information-headers-already-sent-why-its-happening)
> [头已由 PHP 发送](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)

我在我的 wordpress 仪表板上收到以下错误消息。

> 警告：session_start() [function.session-start]：无法发送会话缓存限制器 - 标头已发送（输出开始于 /homez.152/mamouman/www/wp-content/themes/arthur/functions.php:47） /homez.152/mamouman/www/wp-content/themes/modularity/functions/admin-js.php 在第 2 行`

这是我刚刚在我的functions.php文件中添加的内容

```
add_filter('wp_nav_menu_items','add_search_box', 10, 2);
function add_search_box($items, $args) {

    ob_start();
    get_search_form();
    $searchform = ob_get_contents();
    ob_end_clean();

    $items .= '<li>' . $searchform . '</li>';
return $items;
} 
```

这是[我的 admin-js.php](http://codeviewer.org/view/code:2d77)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:49:09.207

这个问题很容易解决： `?>`在functions.php 的末尾有一个空格。

# android - 将引导覆盖添加到 flex 视频组件（移动摄像头）。

> ID：13997524
> 
> 赞同：0
> 
> 时间：2012-12-21T21:37:09.903
> 
> 标签：android, ios, apache-flex, flex4, zxing

我正在开发一个读取 QRCode 的 flex 移动应用程序。为了帮助用户对齐代码，我想在视频面板的中心放置一个引导框。我正在使用一个包含绿色矩形和透明背景的 PNG。我愿意接受所有建议。下面显示了一切是如何工作的。

在 Flash 脚本之外：

```
<s:VGroup width="100%" horizontalAlign="center" id="vg">

        <s:SpriteVisualElement id="sv" width="100%" height="250"/>

    </s:VGroup> 
```

在创建相机方法中：

```
camera = Camera.getCamera();
camera.setMode(360, 360, 24);

videoDisplay.x = 360;
sv.addChild(videoDisplay);

videoDisplay.attachCamera(camera);
videoDisplay.rotation = 90; 
```

任何指针将不胜感激。我已经尝试了几件事，通常图像显示在相机视频窗口附近而不是在它上面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T01:50:39.527

一些位置很好的小组会这样做......就像这样：

```
 <s:Group width="100%" height="250">
        <s:SpriteVisualElement id="sv" width="100%" height="100%"/>
        <!-- nesting in another VGroup will allow you to center the image on the video -->
        <s:VGroup verticalAlign="middle" horizontalAlign="center" 
                  width="100%" height="100%">
            <!-- depending on size of the image, you might want to set scaling/maxWidth etc here -->
            <s:Image source="{yourImagePathOrClass}" />
        </s:VGroup>
    </s:Group> 
```

# git - 如何在 Git 和 Git SCP 中使用 VS 2012 合并工具

> ID：13997532
> 
> 赞同：0
> 
> 时间：2012-12-21T21:37:42.380
> 
> 标签：git, visual-studio-2012, git-extensions

我有 Git。我有 Git 扩展。我有 Visual Studio 2012 的 Git 源代码控制提供程序。我看不出它是如何组合在一起的。

Git SCP 只给了我一个提交 UI，其余的调用 Git 扩展。如果我在 Pending Changes 窗口中右键单击 Conflict 文件，则 VS 合并工具中没有解决选项。

如果我在解决方案资源管理器中右键单击该文件，我在子菜单中有一个选项来解决合并冲突，但这也只会打开 Git 扩展。

到底是怎么回事？我对 Git 束手无策。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T18:13:56.787

我遇到了类似的问题。您可以通过转到 Tools->Options->Source Control 来指定要使用的差异工具。从下拉列表中选择“Git Source Control Provider”。然后，回到左侧的树中，您应该会看到 TFS 选项消失了，并且出现了一个“Git Source COntrol Provider Options”选项。单击它，然后您将看到要使用的差异工具的选项。

# c# - 如何对从 String.Split 创建的字符串列表进行相交

> ID：13997535
> 
> 赞同：2
> 
> 时间：2012-12-21T21:38:06.867
> 
> 标签：c#, linq

我通过执行 String.Split() 创建了 3 个字符串列表。之后，当我在这些列表上进行相交时，结果不是我所期望的。代码 1（不工作）

```
 string a = "AID, BID";
    string b = "[vs|AID|1365]";
    string c = "[vs|BID|1365]";

    List<string> la = new List<string>();
    string[] k = a.Split(",".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
    foreach (string p in k)
    {
        la.Add(p);
    }
    //la.AddRange(k.ToList());
    List<string> lb = new List<string>();
    string[] kk = b.Split("|".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
    foreach (string p in kk)
    {
        lb.Add(p);
    }
    //lb.AddRange(kk.ToList());
    List<string> lc = new List<string>();
    string[] kkk = c.Split("|".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
    foreach (string p in kkk)
    {
        lc.Add(p);
    }
    //lc.AddRange(kkk.ToList());

    var t = la.Intersect(lb, StringComparer.InvariantCultureIgnoreCase);
    Debug.WriteLine(t.Count()); //Prints 1 -- RIGHT
    var tt = la.Intersect(lc, StringComparer.InvariantCultureIgnoreCase);
    Debug.WriteLine(tt.Count()); //Prints 0 -- WRONG!!! 
```

我尝试了 AddRange，但也没有用。我注意到的另一件事是，如果我在“字符串 a”分配中更改了 AID 和 BID 的顺序，则 intersect 会找到 BID 但不会找到 AID。不知道为什么？

上述例程的硬编码版本可以正常工作

```
 List<string> la = new List<string>(); la.Add("AID"); la.Add("BID");
        List<string> lb = new List<string>(); lb.Add("[vs"); lb.Add("AID"); lb.Add("1365]");
        List<string> lc = new List<string>(); lc.Add("[vs"); lc.Add("BID"); lc.Add("1365]");
        var t = la.Intersect(lb, StringComparer.InvariantCultureIgnoreCase);
        Debug.WriteLine(t.Count()); //Prints 1.
        var tt = la.Intersect(lc, StringComparer.InvariantCultureIgnoreCase);
        Debug.WriteLine(tt.Count());//Prints 1. 
```

更新：下面是我最终得到的代码。

```
 string a = "AID, BID";
    string b = "[vs|AID|1365]";
    string c = "[vs|BID|1365]";

    List<string> tla = a.Split(",".ToCharArray(), StringSplitOptions.RemoveEmptyEntries)
                        .Select(s => s.Trim()).ToList();
    List<string> tlb = b.Split("|".ToCharArray(), StringSplitOptions.RemoveEmptyEntries)
                        .Select(s => s.Trim()).ToList();
    List<string> tlc = c.Split("|".ToCharArray(), StringSplitOptions.RemoveEmptyEntries)
                        .Select(s => s.Trim()).ToList();

    var t = tla.Intersect(tlb, StringComparer.InvariantCultureIgnoreCase);
    var tt = tla.Intersect(tlc, StringComparer.InvariantCultureIgnoreCase); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:40:47.160

你的意思

```
string[] k = a.Split(", ".ToCharArray(), StringSplitOptions.RemoveEmptyEntries); 
```

? 因为您的源字符串中有一个空格：

```
string a = "AID, BID"; 
```

顺便说一句，你可以把它写成

```
var la = a.Split(", ".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
var lb = b.Split("|".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);
var lc = c.Split("|".ToCharArray(), StringSplitOptions.RemoveEmptyEntries);

var t = la.Intersect(lb, StringComparer.InvariantCultureIgnoreCase).ToList();
var tt = la.Intersect(lc, StringComparer.InvariantCultureIgnoreCase).ToList(); 
```

您不需要中间列表，因为 LINQ 也有`Intersect`方法。
但值得缓存结果，因此您应该调用`ToList`最终项目。

# node.js - Express 会话和 fs 模块的问题

> ID：13997545
> 
> 赞同：1
> 
> 时间：2012-12-21T21:39:14.687
> 
> 标签：node.js, session, express, mkdir, fs

```
app.post('/register', express.BodyParser(), function (req, res){

   var newu = new UserModel({});

   newu.user = req.body.nuser;
   newu.pass = req.body.npass;
   newu.mail = req.body.nmail;

   var pathu = __dirname + '/users/' + req.body.nuser;

   newu.save(function (err, newu){

       req.session.user = new.user;

       if(err) throw err;

       fs.mkdir(pathu, function (err){

           if (err) throw err;

        });    

   });

   res.redirect('/home);

}); 
```

总是在执行 fs.mkdir 时，我会丢失所有当前的 Express 会话，有没有办法执行 fs.mkdir 并保留所有 Express 会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:48:06.220

不知道它是如何引起你的症状的，但这条线：

```
req.session.user = new.user; 
```

应该是：

```
req.session.user = newu.user; 
```

**更新**

问题的根源是创建目录会触发 nodemon 重新启动应用程序，并且默认的内存会话存储在发生这种情况时会丢失所有会话。解决方法是通过[connect-redis](https://github.com/visionmedia/connect-redis)使用像[Redis](http://redis.io/)这样的持久会话存储。

# php - 我想制作一个具有固定行宽 wordpress 的画廊（伪代码）

> ID：13997546
> 
> 赞同：0
> 
> 时间：2012-12-21T21:39:15.927
> 
> 标签：php, html, css, wordpress, pseudocode

这是我喜欢做的一个例子。 [http://www.davidmielcarek.com/](http://www.davidmielcarek.com/)

我希望这些行的长度是固定的，但我每行可能有 2 或 3 张图像。

我早些时候尝试过，但它并没有真正起作用。

这是伪代码

```
 start loop
       get image width
       calculate rowWidth
       if (rowWidth > maxRowWidth){
          start nested loop
             grab thumbnails for this row only
             resize the thumbnails using the row's aspect ratio so each row is the same width
             call the thumbnails
          end nested loop
          reset some variables for the next row
          check if this is the last post
       }
    end loop 
```

我没有看到问题，但是当我将它放入实际代码中时，我无法让它工作，也许其他人可以更好地编码或指出我的缺陷？

# java - java - 操作失败

> ID：13997549
> 
> 赞同：-1
> 
> 时间：2012-12-21T21:39:27.803
> 
> 标签：java

我有下面的代码，但是当我运行它时，出现一个消息框，提示操作失败，为什么这样做以及它可以运行什么解决方案，代码应该只允许用户从 txt 文件打印

代码 ：

```
import java.io.*;
import javax.swing.JOptionPane;
import javax.print.*;
import javax.print.attribute.DocAttributeSet;
import javax.print.attribute.HashDocAttributeSet;
import javax.print.attribute.HashPrintRequestAttributeSet;
import javax.print.attribute.PrintRequestAttributeSet;

public class printimg
{
    public void printimg() throws FileNotFoundException, PrintException, InterruptedException {
    String filename = ("item.text"); // THIS IS THE TEXT FILE TO PRINT
    try{
    PrintRequestAttributeSet pras = new HashPrintRequestAttributeSet();
    DocFlavor flavor = DocFlavor.INPUT_STREAM.TEXT_PLAIN_UTF_8; //  FILE IS .txt TYPE
    PrintService printService[] =
            PrintServiceLookup.lookupPrintServices(flavor, pras);
    PrintService defaultService =
            PrintServiceLookup.lookupDefaultPrintService();
    PrintService service = ServiceUI.printDialog(null, 200, 200,
            printService, defaultService, flavor, pras);
    if (service != null) {
        DocPrintJob job = service.createPrintJob();
        FileInputStream fis = new FileInputStream(filename);
        DocAttributeSet das = new HashDocAttributeSet();
        Doc doc = new SimpleDoc(fis, flavor, das);
        job.print(doc, pras);

    }
    }
    catch(Exception a){
        JOptionPane.showMessageDialog(null, "OPeration Failed");
    }
}
} 
```

现在收到此错误：

```
java.lang.IllegalArgumentException: services must be non-null and non-empty
    at javax.print.ServiceUI.printDialog(ServiceUI.java:167)
    at printimg.printimg(printimg.java:20)
    at __SHELL8.run(__SHELL8.java:8)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at bluej.runtime.ExecServer$3.run(ExecServer.java:725) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:41:27.063

您看到该消息是因为代码的 try 块中的某些内容引发了异常。在 catch 块内的语句上设置断点，开始调试，并查看到底抛出了什么异常。

这将告诉您哪些代码正在破坏。从那里，您应该能够弄清楚如何解决它。

# android - 使用自定义可打包类解组 Android 应用程序中的错误

> ID：13997550
> 
> 赞同：19
> 
> 时间：2012-12-21T21:39:42.983
> 
> 标签：android, exception, parcelable, runtimeexception

`Parcelable`对于我的 Android 应用程序，我遇到了几个解组错误，尽管我认为我已经完成了通过s正确保存和加载对象所需的一切。你能告诉我我的代码有什么问题吗？

**错误一：**

```
java.lang.RuntimeException: Unable to start activity ComponentInfo
Caused by: java.lang.RuntimeException: Parcel android.os.Parcel@41279860: Unmarshalling unknown type code 6619241 at offset 1372
at android.os.Parcel.readValue(Parcel.java:1922)
at android.os.Parcel.readMapInternal(Parcel.java:2094)
at android.os.Bundle.unparcel(Bundle.java:223)
at android.os.Bundle.getParcelable(Bundle.java:1158)
at android.app.Activity.onCreate(Activity.java:860)
at my.app.package.PlayComputer.onCreate(PlayComputer.java:1012)
at android.app.Activity.performCreate(Activity.java:4465) 
```

第 1012 行 in是对in的`MyActivity`调用。`super.onCreate(savedInstanceState);``Activity``onCreate()`

```
protected void onSaveInstanceState(Bundle savedInstanceState) {
    if (myObject == null) {
        savedInstanceState.putParcelable("myObject", null);
    }
    else {
        savedInstanceState.putParcelable("myObject", myObject);
    }
    savedInstanceState.putInt(...);
    savedInstanceState.putString(...);
    savedInstanceState.putBoolean(...);
    super.onSaveInstanceState(savedInstanceState);
} 
```

`myObject`属于`MyObject`具有以下方法的类：

```
public void writeToParcel(Parcel out, int flags) {
    out.writeIntArray(...);
    out.writeInt(...);
    out.writeStringArray(...);
    out.writeString(...);
    out.writeParcelableArray(..., flags);
}

public static final Parcelable.Creator<MyObject> CREATOR = new Parcelable.Creator<MyObject>() {
    public MyObject createFromParcel(Parcel in) {
        try {
            if (in == null) {
                return null;
            }
            else {
                return new MyObject(in);
            }
        }
        catch (Exception e) {
            return null;
        }
    }
    public MyObject[] newArray(int size) {
        return new MyObject[size];
    }
};

private MyObject(Parcel in) {
    in.readIntArray(...);
    ... = in.readInt();
    in.readStringArray(...);
    ... = in.readString();
    ... = (OtherObject[]) in.readParcelableArray(OtherObject.class.getClassLoader());
} 
```

**错误2：**

```
java.lang.RuntimeException: Unable to start activity ComponentInfo
Caused by: android.os.BadParcelableException: ClassNotFoundException when unmarshalling:
at android.os.Parcel.readParcelable(Parcel.java:1971)
at android.os.Parcel.readValue(Parcel.java:1859)
at android.os.Parcel.readMapInternal(Parcel.java:2099)
at android.os.Bundle.unparcel(Bundle.java:223)
at android.os.Bundle.getParcelable(Bundle.java:1158)
at android.app.Activity.onCreate(Activity.java:905)
at my.app.package.PlayComputer.onCreate(SourceFile:1012) 
```

相同的文件和类。

**错误 3：**

```
java.lang.RuntimeException: Unable to start activity ComponentInfo
Caused by: java.lang.RuntimeException: Parcel android.os.Parcel@4051aff8: Unmarshalling unknown type code 7340149 at offset 1276
at android.os.Parcel.readValue(Parcel.java:1913)
at android.os.Parcel.readMapInternal(Parcel.java:2083)
at android.os.Bundle.unparcel(Bundle.java:208)
at android.os.Bundle.getParcelable(Bundle.java:1100)
at my.app.package.PlayComputer.onCreate(SourceFile:1111) 
```

这一次，导致行 (1111) 是以下行：

```
myObject = (MyObject) savedInstanceState.getParcelable("myObject"); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-30T19:12:12.710

Android 有两种不同的类加载器：框架类加载器（知道如何加载 Android 类）和 APK 类加载器（知道如何加载代码）。APK 类加载器将框架类加载器设置为其父级，这意味着它也可以加载 Android 类。

错误 #2 可能是由使用框架类加载器的 Bundle 引起的，因此它不知道您的类。我认为当 Android 需要保留您的 Bundle 并稍后恢复它时（例如在后台内存不足时），可能会发生这种情况。您可以通过在包上设置 APK 类加载器来解决此问题：

> savedInstanceState.setClassLoader(getClass().getClassLoader());

错误 #1 和 #3 更神秘，您是否可能在 中写入空值`writeToParcel()`？恐怕Android不太喜欢这样。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-19T17:18:00.043

在从 bundle 读取之前，设置 ClassLoader：

```
bundle.setClassLoader(getClass().getClassLoader()); 
```

这节省了我的时间！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T21:54:48.393

看起来，`createFromParcel`and`newArray`应该像这样被覆盖：

```
public static final Parcelable.Creator<MyObject> CREATOR = new Parcelable.Creator<MyObject>() {
    @Override
    public MyObject createFromParcel(Parcel in) {
        MyObject myObj = new MyObject();
        myObj.intArray = in.readIntArray(...);
        myObj.intValue = in.readInt(...);
        // ....
        // IN THE SAME ORDER THAT IS WRITTEN OUT AS PER writeToParcel!
        //
        return myObj;
    }
    @Override
    public MyObject[] newArray(int size) {
        return new MyObject[size];
    }
}; 
```

**编辑：**

我忘了提到要使上述内容起作用，应该有一个空的构造函数！

```
public MyObject(){} 
```

# php - jQuery 序列化由 php 输出创建的表单

> ID：13997554
> 
> 赞同：2
> 
> 时间：2012-12-21T21:39:54.463
> 
> 标签：php, jquery

如何在 jquery 中序列化由 php 输出生成的表单？

```
 $qrform = '<form action="" method="post" id="qrgen">
    <p><strong>Bookmark a Website</strong></p>
    Title<input type="text" name="title"><br />
    Url<input type="text" name="url"><br />
    <input type="submit" value="Generate"></form>';

    echo $qrform ; 
```

现在，此数据由 AJAX 请求显示。一个 php 函数输出数据，然后在浏览器窗口中显示表单。

提交表单时，如何在 jquery 中序列化此表单？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T21:42:16.390

你需要的是

```
jQuery('#qrgen').serialize(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:51:46.033

如果您通过 ajax 获取表单，则更新代码，您需要像这样绑定提交按钮：

```
​$(function () {
    $(document).on('submit', '#qrgen', function (e) {
        e.preventDefault(); //Prevent normal form submittion
        var $form = $(this);

        $.ajax({
            url: $form.attr('action'),
            data : $form.serialize(),
            success: function(data) {
                alert('Ajax was successful');
            },
            type : 'POST' //'POST' or 'GET'
        });
    });
});​ 
```

# c# - 单选按钮不更新服务器端的值

> ID：13997556
> 
> 赞同：0
> 
> 时间：2012-12-21T21:40:02.340
> 
> 标签：c#, javascript, asp.net

我在一个表单中有 3 个单选按钮，它们都是一个组的一部分。单击其中一个非默认单选按钮时，它们会在客户端正确更新（取消选择以前的单选按钮并选择新单选按钮）。我什至在提交表单的按钮上附加了一个 OnClientClick 以对其进行测试，并且在提交表单之前，.checked 值是正确的。但是在服务器端到达的第一行代码检查值，再次用于测试目的，但 .checked 值没有改变。默认还是根据服务器检查。

这是我的一些相关代码：

ASP

```
<asp:RadioButton runat="server" ID="rdoDays" Text=" Days" GroupName="RepeatType" />
<asp:RadioButton runat="server" ID="rdoMonths" Text=" Months" GroupName="RepeatType" />
<asp:RadioButton runat="server" ID="rdoYears" Text=" Years" GroupName="RepeatType" />

<asp:Button runat="server" ID="btnSaveAlert" OnClick="btnSaveAlert_OnClick" 
     Text="Save" OnClientClick="Test()" /> 
```

Javascript - 当点击月份时，javascript 显示“False”，然后为警报框显示“True”。

```
function Test() {
    var rdoDays = document.getElementById("<%= rdoDays.ClientID %>");
    var rdoMonths = document.getElementById("<%= rdoMonths.ClientID %>");
    var rdoYears = document.getElementById("<%= rdoYears.ClientID %>");
    alert(rdoDays.checked);
    alert(rdoMonths.checked);
} 
```

然后对于 C#，我在 Page_Init 的一开始就在 VS 中设置了一个断点，并且单选按钮 .checked 值都是“假”

我不知道是怎么回事。我是否缺少 asp 元素中的标签或其他内容？任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:53:25.300

Viewstate 在 OnInit 和 OnLoad 之间加载。尝试检查是否在页面的 OnLoad 事件中选中了单选按钮。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:06:23.903

也许您可以使用 Fiddler 进行测试以查看从客户端发送到服务器的数据，以尝试缩小实际问题所在：

[http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

# c# - 在 Web 服务调用中创建子线程后停止

> ID：13997557
> 
> 赞同：1
> 
> 时间：2012-12-21T21:40:06.737
> 
> 标签：c#, multithreading, web-services

我有一个 web 服务，当它被调用时会产生一个子线程。子线程本身有一个控制循环，应该一直运行到它被告知在未来某个时间点终止。

我正在使用以下代码：

```
namespace MyService
{
    public class MyService : IMyService
    {
        // Starts a new worker loop on a new thread
        public bool startMyProcess(string Name, Guid ID)
        {
                try
                {
                    // Get DB connection
                    string dbConn = System.Configuration.ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString;
                    TManagement tManagement = new TManagement(dbConn);

                    // If a valid ID has been entered, create a new thread
                    if (tManagement.validateID(ID) == 0)
                    {
                        MainLoop myWorker = new MainLoop();
                        Thread bw = new Thread(() => myWorker.startWebServiceLoop(Name, ID));
                        bw.Start();
                        return true;
                    }
                    else
                    {
                        return false; // The ID is invalid
                    }
                }
                catch
                {
                    // An error has occurred
                    return false;
                }
        }
    }
} 
```

然而，在几个成功的循环（做同样的事情）之后，线程“bw”终止了。

我希望这个子线程无限期地继续下去。我怀疑一旦 web 服务线程终止，子生成的线程就会被杀死。有没有办法避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:36:54.900

更好的设计是使用 Windows 服务来托管长时间运行的线程。您的 Web 服务可以通过 Windows 服务托管的小型 WCF 服务与 Windows 服务通信。

Windows 服务中的线程可以持续所需的时间。Web 服务是为请求/响应范例而设计的，听到它并不总是跟踪并非直接由于来自客户端的请求而发生的事情，我并不感到惊讶。

# android - Android活动和导入问题

> ID：13997559
> 
> 赞同：0
> 
> 时间：2012-12-21T21:40:16.120
> 
> 标签：android, xml

尝试一些到目前为止运行良好的 android 编程。我收到以下错误：

```
Activity cannot be resolved to a type
The import Activity cannot be resolved 
```

在以下类的前两个导入（活动和捆绑）上：

```
package com.example.sqlite;
import android.app.Activity;

import android.os.Bundle;
import android.widget.Button;
import android.widget.EditText;

public class Input extends Activity {

    private EditText txtTitle;
    private EditText txtURL;
    private Button btnOK;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.input);

        txtTitle = (EditText) findViewById(R.id.editText1);
        txtURL = (EditText) findViewById(R.id.editText2);
        btnOK = (Button) findViewById(R.id.button1);    
    }

} 
```

我已经完成了标准的 ctrl + shift + O，它会自动添加这些导入，但错误仍然存​​在。我也一遍又一遍地重建它，但没有任何效果。

谁能看到我在这里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T21:44:53.533

在 Eclipse 中右键单击项目节点并选择 Android Tools->Fix Project Properties。您似乎缺少指向 Android 库的链接。检查的好方法是打开属性-> Java 构建路径-> 库并验证 Android 链接是否存在。如果没有 - 执行 Properties-> Android 并选择您想要使用的项目目标

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:44:54.547

如果您的任何 XML 文件无法构建，您可能偶尔会看到奇怪的错误。检查您的控制台以查看您的任何布局或资源是否有错误。请执行下列操作：

`Project > Clean`

如果这不能解决问题，请验证项目路径中是否确实存在 pour souce：

`com.example.sqlite`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:47:58.817

如果包含活动，请检查您的清单 xml。这有时会导致错误。

# django - 在 django 中建立一对多关系

> ID：13997562
> 
> 赞同：3
> 
> 时间：2012-12-21T21:40:28.313
> 
> 标签：django, database-design, one-to-many

我正在尝试在 django 中建立一对多的关系。

在我的模型中，我有一个类 Person 和一个类 Group ，我想要建立的关系是一个 Group 可以有 N 人，如果没有一个人在里面，一个组就不能存在

在 MER 图中，它会像（想象这些是实体和关系）

|组|1====<>-----N|个人|

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-21T23:19:43.337

正如 Arthur 所说，这在 Django 文档中有很好的记录。

其实很简单：

```
from django.db import models

class Person(models.Model):
    # Some other fields
    group = models.ForeignKey(Group, related_name='people')

class Group(models.Model):
    # Some fields 
```

如您所见，您只需在 person 类中创建一个外键 -> 如果您应该这样做，这与您在数据库中手动设置它的方式非常等效。

Django 会自动添加反向关系，这样你就可以从一个组中找到人：

```
some_group.people 
```

请注意，`related_name`指定反向关系的名称。这是可选的，但我猜你想使用`people`而不是`persons`.

# python - 如何使用 unittest.mock 在单元测试中模拟任意 ConfigParser 调用

> ID：13997571
> 
> 赞同：4
> 
> 时间：2012-12-21T21:41:18.247
> 
> 标签：python, unit-testing, mocking, python-3.3

我正在尝试开始使用[unittest.mock](http://docs.python.org/3/library/unittest.mock.html)的动作/断言模式而不是[mox](https://code.google.com/p/pymox/wiki/MoxDocumentation)的记录/重播/验证模式。

```
# foo.py
def op_1(param):
    pass

def op_2(param):
    pass

def do_stuff(param_1, param_2):
    global config
    global log
    try:
        op_1(param_1)
        if config.getboolean('section','option'):
            op_2(param_2)
    except:
         log.error("an error occured") 
```

而且，这是我的 unittest 文件的示例。

```
# test_foo.py
class TestFoo(unittest.TestCase):
    def test_do_stuff(self):
        param_1 = None
        param_2 = None
        foo.config = MagicMock()
        foo.config.getboolean('section','option', return_value = True)
        foo.op_1 = MagicMock()
        foo.op_2 = MagicMock()
        do_stuff(param_1, param_2)
        foo.op_1.assert_called_once_with(param_1)
        foo.op_2.assert_called_once_with(param_2)
        foo.config.getboolean.assert_called_once_with('section','option') 
```

此测试是否验证以下项目/我是否使用模拟正确？

1.  do_stuff 调用返回没有错误
2.  op_1 是用 param_1 调用的
3.  op_2 是用 param_2 调用的
4.  配置解析器对象已被使用，但具体调用无关紧要

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T17:29:37.567

原来我用`return_value`错了。

当我需要一个`mock.Mock`或`mock.MagicMock`对象来返回一个值时，无论传递的参数如何，它都需要始终返回该值。*不过，根据传递的参数（可能的功能请求*）给出不同的行为可能会很好。

我完成这个的方式是：

```
foo.config.getboolean = mock.MagicMock(return_value = True) 
```

然后我可以这样做：

```
self.assertGreaterThan(len(foo.config.mock_calls), 0)
self.assertGreaterThan(len(foo.config.getboolean(str(),str())), 0) 
```

# java - 无法将数据保存在文本文件中

> ID：13997572
> 
> 赞同：0
> 
> 时间：2012-12-21T21:41:19.360
> 
> 标签：java, printwriter

我正在尝试创建一个从 GUI 获取信息的类，这会将其保存到我用作“数据库”的文本文件中，但由于某种原因，PrintWriter 对象不会将新数据写入文件中。这是我的代码

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Scanner;

public class IO {

    File f = new File("DB.txt");
    PrintWriter write;
    Scanner input;
    String[][] data;
    String nameToSearch;

    // search constructor
    public IO(String name) {
        super();
        nameToSearch = name;
        try {
            input = new Scanner(f);
        } catch (FileNotFoundException e) {
            System.out.println("File not found please restart the program");
        }
        data = new String[linesCounter()][2];
        for (int i = 0; i < linesCounter(); i++) {
            data[i][0] = input.nextLine();
            data[i][1] = input.nextLine();
        }
    }

    public IO(String name, String number) {
        try {
            write = new PrintWriter(new FileWriter(f, true));
        } catch (IOException e) {
            System.out.println("Error");
        }
        write.println(name);
        write.println(number);
    }

    int linesCounter() {
        try {
            input = new Scanner(f);
        } catch (FileNotFoundException e) {
            System.out.println("File not found please restart the program");
        }
        int counter = 0;
        while (input.hasNext()) {
            input.nextLine();
            counter++;
        }
        return counter / 2;
    }

    int contactFinder() {
        for (int i = 0; i < linesCounter(); i++)
            if (data[i][0].equalsIgnoreCase(nameToSearch))
                return i;
        return -1;
    }

    String nameGetter() {
        return data[contactFinder()][0];
    }

    String numGetter() {
        return data[contactFinder()][1];
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:43:13.387

[使用printwriter.close()](http://docs.oracle.com/javase/6/docs/api/java/io/PrintWriter.html#close%28%29)完成写入文件后，您需要关闭 printwriter

```
 try {
            write = new PrintWriter(new FileWriter(f, true));
              write.println(name);
              write.println(number);
              write.close();
        } catch (IOException e) {
            System.out.println("Error");
        }

    } 
```

**编辑：** 对于您的 NoSuchElement 例外，您应该在使用[Scanner.hasNextLine()](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Scanner.html#hasNextLine%28%29)调用 Scanner.nextline() 之前检查文件中是否有下一行。

```
 for (int i = 0; i < linesCounter(); i++) {
      if(input.hasNextLine()){
        data[i][0] = input.nextLine();
        data[i][3] = input.nextLine();
    }
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:45:18.133

PrintWriter 可能永远不会被刷新。您可以手动执行此操作

```
write.flush(); 
```

这将确保缓冲区被写入文件。

# ruby-on-rails - Heroku - 没有路线匹配

> ID：13997578
> 
> 赞同：1
> 
> 时间：2012-12-21T21:42:17.937
> 
> 标签：ruby-on-rails, ruby, heroku

部署到 Heroku 后出现问题。尝试访问 /sign_ups/new 我在日志中看到了这一点。

```
2012-12-21T21:36:21+00:00 app[web.1]: Started GET "/sign_ups/new" for ... at 2012-12-21 21:36:21 +0000
2012-12-21T21:36:21+00:00 app[web.1]: 
2012-12-21T21:36:21+00:00 app[web.1]: ActionController::RoutingError (No route matches {:controller=>"sign_ups", :action=>"referral", :id=>nil}):
2012-12-21T21:36:21+00:00 app[web.1]:   app/helpers/sign_up_helper.rb:3:in `referral_link'
2012-12-21T21:36:21+00:00 app[web.1]:   app/views/sign_ups/show.html.erb:10:in `_app_views_sign_ups_show_html_erb__2538320905600276551_36877720'
2012-12-21T21:36:21+00:00 heroku[router]: at=info method=GET path=/sign_ups/new host=blah.herokuapp.com fwd=... dyno=web.1 queue=0 wait=0ms connect=2ms service=19ms status=404 bytes=728
2012-12-21T21:36:21+00:00 app[web.1]:   app/controllers/sign_ups_controller.rb:10:in `new'
2012-12-21T21:36:21+00:00 app[web.1]: 
2012-12-21T21:36:21+00:00 app[web.1]: 
2012-12-21T21:36:21+00:00 heroku[router]: at=info method=GET path=/favicon.ico host=blah.herokuapp.com fwd=... dyno=web.1 queue=0 wait=0ms connect=2ms service=4ms status=304 bytes=0 
```

但是，如果我在 heroku 上运行 rake 路线，我会看到这一点。

```
 referrals GET  /r/:id(.:format)        sign_ups#referral
   sign_ups POST /sign_ups(.:format)     sign_ups#create
new_sign_up GET  /sign_ups/new(.:format) sign_ups#new
    sign_up GET  /sign_ups/:id(.:format) sign_ups#show
       root      /                       sign_ups#new 
```

即使在生产模式下运行，一切都可以在本地正常运行。有什么我想念的想法吗？

sign_ups_controller.rb

```
class SignUpsController < ApplicationController
  def new
    @sign_up = SignUp.find_by_remember_token(cookies[:remember_token])
    if @sign_up.nil?
      @sign_up = SignUp.new
    else
      render :show
    end
  end

  def create
    @sign_up = SignUp.new(params[:sign_up])
    if @sign_up.save
      cookies.permanent[:remember_token] = @sign_up.remember_token
      flash[:notice] = 'Thanks for signing up!'
      redirect_to root_path
    else
      render action: "new"
    end
  end

  def referral
    @sign_up = SignUp.new
    render action: "new"
  end
end 
```

sign_ups_helper.rb

```
module SignUpHelper
  def referral_link(referral_id)
    URI::join(root_url, referrals_path(referral_id))
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T20:07:28.270

解决了这个问题。它与迁移有关。我在单独的迁移中添加了 refer_id，但没有设置默认值。

# cuda - cudaMalloc 和 cudaFree 是同步调用还是异步调用？

> ID：13997579
> 
> 赞同：5
> 
> 时间：2012-12-21T21:42:32.373
> 
> 标签：cuda

我想测试一下cudaMalloc和cudaFree是否是同步调用，所以我对CUDA SDK中的“simpleMultiGPU.cu”示例代码做了一些修改。以下是我更改的部分（添加的行没有缩进）：

```
float *dd[GPU_N];;
for (i = 0; i < GPU_N; i++){cudaSetDevice(i); cudaMalloc((void**)&dd[i], sizeof(float));}
    //Start timing and compute on GPU(s)
    printf("Computing with %d GPUs...\n", GPU_N);
    StartTimer();

    //Copy data to GPU, launch the kernel and copy data back. All asynchronously
    for (i = 0; i < GPU_N; i++)
    {   
        //Set device
        checkCudaErrors(cudaSetDevice(i));

        //Copy input data from CPU
        checkCudaErrors(cudaMemcpyAsync(plan[i].d_Data, plan[i].h_Data, plan[i].dataN * sizeof(float), cudaMemcpyHostToDevice, plan[i].stream));

        //Perform GPU computations
        reduceKernel<<<BLOCK_N, THREAD_N, 0, plan[i].stream>>>(plan[i].d_Sum, plan[i].d_Data, plan[i].dataN);
        getLastCudaError("reduceKernel() execution failed.\n");

        //Read back GPU results
        checkCudaErrors(cudaMemcpyAsync(plan[i].h_Sum_from_device, plan[i].d_Sum, ACCUM_N *sizeof(float), cudaMemcpyDeviceToHost, plan[i].stream));
cudaMalloc((void**)&dd[i],sizeof(float));
cudaFree(dd[i]);

//cudaStreamSynchronize(plan[i].stream);
    } 
```

通过在大循环中分别注释掉cudaMalloc行和cudaFree行，我发现对于一个2-GPU的系统，GPU处理时间分别是30毫秒和20毫秒，所以得出cudaMalloc是一个异步调用，cudaFree是一个同步调用。不确定这是否正确，也不确定 CUDA 架构的设计关注点是什么。我的计算能力是2.0，我尝试了cuda4.0和cuda5.0。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T22:22:30.953

这两个函数是同步的。

# ruby-on-rails - 更改设计控制器的布局

> ID：13997580
> 
> 赞同：0
> 
> 时间：2012-12-21T21:42:35.430
> 
> 标签：ruby-on-rails

我正在使用 gem `devise`。设计扩展应用程序控制器并将用户管理添加到 Rails 应用程序。

当我查看宝石内部时，我可以看到以下行

```
class Devise::SessionsController < ApplicationController 
```

我正在尝试更改此设置，因为我希望设计控制器从名为`AdminController`. 原因是我已经完成了整个 Web 应用程序，我不希望页面的管理部分使用我的应用程序布局、css、js ...

如何动态更改控制器的基类？或者动态告诉控制器使用`admin.html.erb`布局而不是`application.html.erb`布局。

当我说“动态”时，我的意思是猴子补丁，谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:31:58.720

这解决了我的问题，如果控制器的命名空间是`Devise`使用管理布局。

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  layout :determine_layout

  def determine_layout
    module_name = self.class.to_s.split("::").first
    return (module_name.eql?("Devise") ? "admin" : "application")
  end
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T21:50:52.540

设计是一个[轨道引擎](http://guides.rubyonrails.org/engines.html)。我认为制作站点管理部分的最佳方法是制作 Rails 引擎。或者最好还是使用[rails_admin](https://github.com/sferik/rails_admin)或[activeadmin](http://activeadmin.info/)。它们都是 Rails 引擎有一个关于[Rails 引擎的 railscast](http://railscasts.com/episodes/277-mountable-engines)

我不知道你的应用程序的内部工作，但如果你添加

```
layout "admin" 
```

到您的 AdminController 并将自定义管理布局添加到 view/layouts 文件夹

```
 <%= stylesheet_link_tag 'admin' %>
 <%= javascript_include_tag "admin"%> 
```

AdminController 视图将使用管理样式表和 javascript

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T23:08:23.633

如果您只需要更改布局，我认为您应该可以通过重新打开控制器类来完成。在您的底部`initializers/devise.rb`（在顶层的配置部分下方，您可以编写：

```
Devise::SessionsController.layout :admin 
```

我没有尝试过，但理论上它应该可以工作，因为布局只是 ActionController.base 上的一个类方法。

# ruby-on-rails - 使用 ElasticSearch + Tire 搜索多个术语

> ID：13997581
> 
> 赞同：3
> 
> 时间：2012-12-21T21:42:36.297
> 
> 标签：ruby-on-rails, ruby, mongoid, elasticsearch, tire

将轮胎与 Mongoid 一起使用，我无法弄清楚如何构造查询以使用 ElasticSearch 查找事件。特别是，我试图找到用户正在观看的事件以及用户关注的表演者的事件：

```
# app/models/event.rb
class Event
  include Mongoid::Document
  include Tire::Model::Search
  include Tire::Model::Callbacks

  field :name, type: String

  has_and_belongs_to_many :performers
  has_many :watchers, class_name: 'User'

  mapping do
    indexes :name
    indexes :watcher_ids, type: 'string', index: :not_analyzed
    indexes :performer_ids, type: 'string', index: :not_analyzed
  end
end 
```

以下查询仅适用于观察者或执行者。

```
Tire.search 'events' do
  query do
    string params[:query]
    # Only one of these will work at a time:
    terms :performer_ids, current_user.followed_performers.collect(&:id).map(&:to_s)
    terms :watcher_ids, [current_user.id.to_s]
  end
end 
```

*   小编辑，因为我输入了我的示例错误。

这是一个似乎“有效”的解决方案......但感觉不对

```
Tire.search('events') do
  query do
    boolean do
      should { string params[:query] }
      should { string "performer_ids:#{current_user.followed_performers.collect(&:id).map(&:to_s).join(',')}" }
      should { string "watcher_ids:#{current_user.id.to_s}" }
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T09:52:48.430

You're on a right path, but as advised by Russ Smith, you need to use a `filter` DSL.

Now, if you just repeatedly call `filter`, you'll perform a union: `AND`. If you want to return *either* events user is watching *or* by performers the user follows, you have to use a `or` filter.

Also, for best performance, use the `filtered` query, as opposed to the top level filter -- in the former case, filters run first, slicing your corpus and perform queries only on this subset.

The code should look like this:

```
Tire.search 'events' do
  query do
    filtered do
      query do
        string params[:query]
      end
      filter :or, terms: { organization_ids: current_user.followed_performers.collect(&:id).map(&:to_s) },
                  terms: { watcher_ids:      [current_user.id.to_s] }
    end
  end
end 
```

See the integration tests for more examples:

*   [https://github.com/karmi/tire/blob/master/test/integration/filters_test.rb](https://github.com/karmi/tire/blob/master/test/integration/filters_test.rb)
*   [https://github.com/karmi/tire/blob/master/test/integration/filtered_queries_test.rb](https://github.com/karmi/tire/blob/master/test/integration/filtered_queries_test.rb)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T01:04:04.060

我认为您正在寻找的是过滤器。这不是经过全面测试的代码，但它可能会引导您朝着正确的方向前进。

```
class Event
  include Mongoid::Document
  include Tire::Model::Search
  include Tire::Model::Callbacks

  field :name, type: String

  has_and_belongs_to_many :performers
  has_many :watchers, class_name: 'User'

  mapping do
    indexes :name
    indexes :watcher_ids, type: 'integer', index: :not_analyzed
    indexes :performer_ids, type: 'integer', index: :not_analyzed
  end
end

Tire.search('events') do
  query do
    string 'my event'
  end

  filter :in, :organization_ids, [1,2,3]
  filter :in, :watcher_ids, [1]
end 
```

# php - 从两个嵌套循环返回值

> ID：13997586
> 
> 赞同：0
> 
> 时间：2012-12-21T21:43:06.007
> 
> 标签：php, loops

我有一个 while 循环嵌套在另一个 while 循环中。第一个 while 会给我 5 个元素，对于每个元素，我必须去第二个 while 并获得 2 个元素。

问题是我必须将所有 10 个值返回给一个函数。

我怎样才能做到？

我试图合并两个数组，但没有成功。

```
function ShowCustomers()
{
    while($row2 = mysql_fetch_array($result2))
    {
        while($row3 = mysql_fetch_array($result3))
        {
            $res = array($row2['f_name'], $row3['name'], $row3['s_name']);
            $res1 = array_merge($res1,$res);
        }
    }
    return $res1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:50:21.230

如果您只想将所有结果放入一个数组并返回，您可以使用`array_push()`，或简写：`$your_array[] = ...`：

```
function ShowCustomers()
{
    $result_array = array();
    while($row2 = mysql_fetch_array($result2))
    {
        while($row3 = mysql_fetch_array($result3))
        {
            $res = array($row2['f_name'], $row3['name'], $row3['s_name']);
            $result_array[] = $res;
        }
    }
    return $result_array;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:52:40.443

您需要在循环范围之外声明 $res1 ，以便在每次迭代后保持其值：

```
function ShowCustomers()
{
    $res1 = array();
    while($row2 = mysql_fetch_array($result2))
    {
        while($row3 = mysql_fetch_array($result3))
        {
            $res = array($row2['f_name'], $row3['name'], $row3['s_name']);
            $res1 = array_merge($res1,$res);
        }
    }
    return $res1;
} 
```

# ruby-on-rails - Apache 子路由/符号链接例外规则

> ID：13997589
> 
> 赞同：0
> 
> 时间：2012-12-21T21:43:30.103
> 
> 标签：ruby-on-rails, apache, url-routing

如果没有具体的设置，我不知道如何描述这个问题，所以我不确定帖子标题是否非常有意义。

无论如何，我们有一个名为`marketing`在 Phusion Passenger 上运行的 Rails 应用程序。我们为Passenger`VirtualHost`设置了一个`RailsBaseURI /marketing`条目，以及`/var/www/html/marketing`指向文件系统单独部分中的Rails 目录的符号链接（例如`/home/user1/marketing`）。这一切都很好，我们可以点击应用程序`ourdomain.com/marketing`。Rails 应用程序有几条路线，例如`/marketing/businesses`和`/marketing/certificates`，它们指向与我们营销部门的各种功能相对应的不同“子应用程序”。

现在，我有一个名为`MarketingPeanuts`支持 AIR 自动更新功能的独立 Adob​​e AIR 应用程序。简而言之，自动更新需要 AIR 安装程序包和服务器上的配置文件（“自动更新内容”），并且 AIR 应用程序代码指向此 URL。我希望自动更新的 URL`ourdomain.com/marketing/peanuts`能够保持语义。但是，我不想将自动更新内容放入 Rails 目录，因为 1) `MarketingPeanuts`AIR 应用程序与 Rails 应用程序没有任何关系（除了作为营销部门的另一个功能），以及 2) 任何时候我需要要更新 AIR 应用程序，我必须重新部署 Rails 应用程序才能将最新的自动更新内容放到服务器上。

所以我想要做的是将 AIR 自动更新内容放在文件系统的完全不同的部分（比如`/home/user2/marketing_peanuts`），并以某种方式告诉 Apache，如果它看到特定的子 URL `/marketing/peanuts`，则指向这个位置，否则，发送所有其他`/marketing/*`子Rails 目录的 URL（`/home/user1/marketing`从上面）。虽然没有 Rails 抱怨路由不存在（尽管如果 Apache 可以解决这个问题，那么 Rails 问题甚至不应该存在）。

是否可以在 Apache 中做这种事情（我猜是的），如果可以，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:09:52.007

您应该能够使用[mod_alias](http://httpd.apache.org/docs/2.2/mod/mod_alias.html#alias)（Apache 附带）来执行此操作。启用该模块，然后将其放在 Apache 配置中的某个位置：

```
Alias /marketing/peanuts /home/user2/marketing_peanuts 
```

# php - Jquery javascript ajax - 总价格未更新

> ID：13997595
> 
> 赞同：0
> 
> 时间：2012-12-21T21:43:58.743
> 
> 标签：php, javascript, jquery, ajax

所以我试图让下面的代码用于更新基于 ajax onclick 的价格：

```
$('#main_body li[data-pricefield="special"]').delegate('onclick','change', function(e)
{
    var temp = $(this).attr("id").split('_');
    var element_id = temp[1];

    var pricedef = $(this).data('pricedef');
    if(pricedef == null)
    {
        pricedef = 0;
    }

    $("#li_" + element_id).data("pricevalue",pricedef);
    calculate_total_payment();
}); 
```

到目前为止，一切似乎都很好——当我在控制台中输入时：

```
jQuery('#li_273').data('pricevalue'); 
```

我确实得到了一个返回的值“1.00”，它实际上是在 onclick 命令上设置的：

```
'onclick' => 'jQuery(\'#li_273\').data(\'pricevalue\',\'1.00\');', 
```

我的问题是我的第一个代码块有什么问题，它阻止了它以正确的方式计算价格，我该如何纠正它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:20:25.797

'onclick', 'change' 应该是委托中的 'click change'

编辑： "$('#main_body li[data-pricefield="special"]').delegate('li','change', function(e) { 当您从字段中跳出时实际上有效 - 它添加了 $1给它。”

所以你应该有：

```
$('#main_body li[data-pricefield="special"]').on('li','click change', function(e) { 
```

也许检查

```
if(pricedef == undefined || pricedef == null){ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:29:49.030

您正在使用

```
$('#main_body li[data-pricefield="special"]').delegate('onclick','change', function(e){
   // ...
}); 
```

but`delegate`的语法是`.delegate( selector, eventType, handler(eventObject) )`，在这种情况下你应该写

```
$('#main_body').delegate('li[data-pricefield="special"]','click', function(e){
   // ...
}); 
```

没有`onclick`事件`jQuery`，AFAIK`li`没有`change`事件，所以如果你想使用多个事件，那么你可以使用

```
$('#main_body').delegate('li[data-pricefield="special"]','click another_event', function(e){
   // ...
}); 
```

您也可以使用`on`而不是`delegate`.

[**一个例子**](http://jsfiddle.net/q7GhH/)和[**阅读更多**](http://api.jquery.com/delegate/)。

# java - 在java中使用单链表和冒泡排序进行编码

> ID：13997597
> 
> 赞同：5
> 
> 时间：2012-12-21T21:44:03.810
> 
> 标签：java, bubble-sort, singly-linked-list

我的代码有问题，我创建了一个单链表类，您可以在其中添加、删除、修改、合并等......但是，我正在尝试一个简单的冒泡排序并且遇到了列表存在的问题未正确排序。这里有一些注意事项：

*   它是链表的自定义实现
*   单链表的节点包含两件事：一个包含客户所有数据的 CustomerFile 对象和一个指向列表中下一项的“下一个”节点指针
*   该列表按每个节点的客户文件中存储的姓氏按升序 (AZ) 排序
*   添加记录功能将节点插入到列表中的正确位置，因此列表最初不需要排序 - 但是如果更改姓氏，作为程序的一部分，列表需要再次排序
*   我宁愿不创建一个新列表并在该列表上重新使用此插入记录来创建一个新列表，因为这是内存密集型的，我的任务是尽可能高效
*   链表的结构不能改变 - 已经决定了，我太远了，无法更改为数组之类的东西
*   该列表有一个头节点，它有下一个项目但没有尾节点。它有一个指定的 NULL next 指针来指示列表的结尾

## 编码

```
public static void sortList()
{
    if (isEmpty() == true)
    {
        System.out.println("Cannot sort - the list is empty");
    }
    else if (getHead().getNext() == null)
    {
        System.out.println("List sorted");
    }
    else
    {
        Node current = getHead().getNext();
        CustomerFile tempDat;
        boolean swapDone = true;
        while (swapDone)
        {
            current = getHead().getNext();
            swapDone = false;
            while (current != null)
            {
                if (current.getNext() != null &&
                    current.getData().getSurname().compareTo(
                        current.getNext().getData().getSurname()) >0)
                {
                    tempDat = current.getData();
                    current.setData(current.getNext().getData());
                    current.getNext().setData(tempDat);
                    swapDone = true;
                }
                current = current.getNext();
            }
        }
        if (getHead().getData().getSurname().compareTo(
            getHead().getNext().getData().getSurname()) >0)
        {
            current = getHead().getNext();
            getHead().setNext(current.getNext());
            setHead(current);
        }
    }
} 
```

我会很感激反馈

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T15:33:56.453

您的代码是一种奇怪的混合物，主要是交换数据，但特别对待头部，试图通过切换链接与下一个交换它。

如另一个答案所述，最后一次交换没有正确实现，但是如果您通过交换数据来做事，实际上没有理由特别对待头部。

您所要做的就是在外循环的头部开始对列表的每次遍历。

这产生了一个可行的解决方案：

```
public void sortList()
{
    if (isEmpty())
    {
        System.out.println("An empty list is already sorted");
    }
    else if (getHead().getNext() == null)
    {
        System.out.println("A one-element list is already sorted");
    }
    else
    {
        Node current = getHead();
        boolean swapDone = true;
        while (swapDone)
        {
            swapDone = false;
            while (current != null)
            {
                if (current.getNext() != null && current.getData().getSurname().compareTo(current.getNext().getData().getSurname()) >0)
                {
                    CustomerFile tempDat = current.getData();
                    current.setData(current.getNext().getData());
                    current.getNext().setData(tempDat);
                    swapDone = true;
                }
                current = current.getNext();
            }
            current = getHead();
        }
    }
} 
```

我把这个做成了非静态的，因为正如评论中所指出的，我不清楚你的静态文件是如何工作的。您可以在您的上下文中将其设为静态。

我还更改了其他一些小事情。从来没有必要通过代码检查条件

```
if (isEmpty() == true) 
```

在 Java 中，这完全等价于

```
if (isEmpty()) 
```

并且`tempDat`不需要在使用它的地方之外声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:48:11.523

您没有在排序中包括头部。

```
public static void sortList()
{
    if (isEmpty() == true)
    {
        System.out.println("Cannot sort - the list is empty");
    }
    else if (getHead().getNext() == null)
    {
        System.out.println("List sorted");
    }
    else
    {
        Node current = getHead();
        // Node current = getHead().getNext();
        CustomerFile tempDat;
        boolean swapDone = true;
        while (swapDone)
        {
            current = getHead().getNext();
            swapDone = false;
            while (current != null)
            {
                if (current.getNext() != null && current.getData().getSurname().compareTo(current.getNext().getData().getSurname()) >0)
                {
                    tempDat = current.getData(); // td -> objectA, cd -> objectA
                    current.setData(current.getNext().getData()); // cd -> objectB
                    current.getNext().setData(tempDat); // nd -> td -> objectA
                    swapDone = true;
                }
                current = current.getNext();
            }
        }
        //if (getHead().getData().getSurname().compareTo(getHead().getNext().getData().getSurname()) >0)
        //{
        //  current = getHead().getNext(); // current -> head+1
        //  getHead().setNext(current.getNext()); //head+1 -> head+2
        //  setHead(current); // head -> head+1
        //}
    }
} 
```

上面注释掉的代码也有错误。应用该代码会删除一个节点。

```
// list: a -> b -> c -> d
current = getHead().getNext(); // current = b
getHead().setNext(current.getNext()); // a -> c 
setHead(current); // head = b
// list: b -> c -> d
// and nothing points to 'a' anymore 
```

而不是交换数据，您应该尝试交换节点。如果您采用这种方法，您应该找到更好的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:30:23.363

我认为这里的主要问题是你从

```
current = getHead().getNext() 
```

使用此代码，您将完全将头部排除在排序过程之外，并且可能此处的数据需要转到列表的另一端，但在这种情况下，它将始终是头部中的数据元素，或者是直接在头节点之后的数据（后者是由于你最后的 if 语句）。

尝试从列表的开头开始，看看会带来什么。

# azure - Windows Azure Beast 漏洞利用

> ID：13997599
> 
> 赞同：6
> 
> 时间：2012-12-21T21:44:15.900
> 
> 标签：azure

我有一个客户端正在运行 PCI 合规性扫描并获得以下信息：

```
BEAST (Browser Exploit Against SSL/TLS) Vulnerability
The SSL protocol encrypts data by using CBC mode with chained
initialization vectors. This allows an attacker, which is has gotten
access to an HTTPS session via man-in-the-middle (MITM) attacks or other means, to obtain plain text HTTP headers via
a blockwise chosen-boundary attack (BCBA) in conjunction with
Javascript code that uses the HTML5 WebSocket API, the Java
URLConnection API, or the Silverlight WebClient API. This
vulnerability is more commonly referred to as Browser Exploit Against
SSL/TLS or "BEAST".
CVE: CVE-2011-3389
NVD: CVE-2011-3389
Bugtraq: 49778
CVSSv2: AV:N/AC:M/Au:N/C:P/I:N/A:N(4.30)
Reference: https://bugzilla.mozilla.org/show_bug.cgi?id=665814,
http://httpd.apache.org/docs/trunk/mod/mod_ssl.html#sslciphersuite,
http://technet.microsoft.com/en-us/security/bulletin/ms12-006
Service: http
Evidence:
Cipher Suite: SSLv3 : DES-CBC3-SHA
Cipher Suite: SSLv3 : RC4-SHA
Cipher Suite: SSLv3 : RC4-MD5
Cipher Suite: TLSv1 : AES256-SHA
Cipher Suite: TLSv1 : AES128-SHA
Cipher Suite: TLSv1 : DES-CBC3-SHA
Cipher Suite: TLSv1 : RC4-SHA
Cipher Suite: TLSv1 : RC4-MD5 
```

他们的站点托管在 Windows Azure 上；由于这些服务器是托管的，有没有推荐的方法来填补这个漏洞？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T01:34:18.480

你到底在 Azure 中运行什么？它是 Web 角色吗？Azure 网站？您自己的 IaaS 模式下的 Windows 服务器？

如果您正在运行 Web 角色，您是否正在运行最新的 Windows 操作系统？Microsoft 于 2012 年 4 月在 Web 角色中修补了此问题。

[http://msdn.microsoft.com/en-us/library/windowsazure/hh967599.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh967599.aspx)

如果您通过 IaaS 模式运行 Windows Server，则您自己负责修补服务器。

# javascript - Javascript中的组合延迟函数调用

> ID：13997613
> 
> 赞同：6
> 
> 时间：2012-12-21T21:45:18.993
> 
> 标签：javascript, jquery, node.js, dom-events, settimeout

我不太确定这是什么技术术语。我有一个带有交互式图形的 GUI。用户与 GUI 交互后，我需要执行一些 CPU 密集型操作。但是，用户输入非常频繁，所以我只想在没有用户输入的 1000 毫秒后调用该函数。在我使用的模式下方：

```
scheduler = (function(){
    var timer;
    function exec(call, delay){
        clearTimeout(timer);
        timer = setTimeout(call, delay);
    };
    return exec;
})() 
```

即，如果 3 次调用`scheduler`彼此紧随其后，则实际上只会执行最后一次调用：

```
scheduler(function(){alert('foo')}, 1000);
scheduler(function(){alert('bar')}, 1000);
scheduler(function(){alert('zoo')}, 1000); 
```

它似乎有效，但感觉有点 hacky 我有点担心 Javascript 的任何警告`setTimeout`，尤其是范围问题。这看起来像是我可以在更大范围内使用的可靠模式吗？当我调用它时，我传递的内联函数`scheduler`是否能够像往常一样在其词法范围内查找所有对象`settimeout`？如果我有几个这样的调度程序实例怎么办？他们能互相干扰吗？有没有另一种方法可以做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:51:26.187

您可以选择使用 Web Worker 线程：

[https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers) [http://www.html5rocks.com/en/tutorials/workers/basics/](http://www.html5rocks.com/en/tutorials/workers/basics/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:59:27.023

我会做什么：

[http://jsfiddle.net/gunderson/4XXQ4/1/](http://jsfiddle.net/gunderson/4XXQ4/1/)

```
 var severQueue = [];
    var delay;

    $("#inputSquare").mousemove(onMouseMove);

    function onMouseMove(){
        if (delay){
           clearTimeout(delay);
        }
        serverQueue.push("doSomething")
        delay = setTimeout(sendToServer, 1000);
    }

    function sendToServer(){
        console.log(serverQueue.length);
        delay = null;
        $("#inputSquare").addClass("activated");
        // do some ajax using serverQueue
        // we'll just simulate it with another timeout
        for (var i in serverQueue){
            serverQueue.pop();
        }
        onComplete = setTimeout(onAjaxComplete, 1000);
    }

    function onAjaxComplete(){
        $("#inputSquare").removeClass("activated");
    }

​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T22:02:36.330

从理论上讲，您的解决方案看起来可行。没有与您将回调函数传递给您的`scheduler`函数相关的范围界定问题；回调将关闭它创建的任何环境，就像 JavaScript 中的任何其他函数一样。话虽如此[，JavaScript 中的作用域规则可能有点棘手](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)，因此请务必阅读它。

在实践中，可能存在一些与此相关的特定于浏览器的问题，`setTimeout`这可能会使该解决方案无法使用。例如，某些浏览器执行`setTimeout`回调的频率可能会有所不同，因此您等待执行回调的时间会比预期的要长。所有`setTimeout`回调将按顺序执行；它们永远不会并行执行。但是，您可以保证它们将以什么顺序执行。

话虽如此，您的解决方案中的任何主要问题都可能与您注册的回调有关，而不是与您注册它们的方式有关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-11T02:23:38.860

underscore.js 中的`debounce` [函数正是这样做的：](http://underscorejs.org/#debounce)

> **去抖** `_.debounce(function, wait, [immediate])`
> 
> *创建并返回传递函数的新去抖动版本，该版本将推迟其执行，直到自上次调用以来等待毫秒过去后。对于实现仅在输入停止到达后才应发生的行为很有用。例如：渲染 Markdown 注释的预览，在窗口停止调整大小后重新计算布局等等。*

# html - div 无法做成链接，有什么替代 XHTML 严格的方法吗？

> ID：13997616
> 
> 赞同：1
> 
> 时间：2012-12-21T21:45:37.760
> 
> 标签：html, css, xhtml

我的就职帖子在这里，希望大家能有所帮助。:)

我一直在努力创建一个纯 XHTML 严格的网站，没有图像，但我遇到了一个小问题。我似乎找不到一种方法来制作如下所示的按钮：

![在此处输入图像描述](../Images/4202d8007eef680a3f85a72f6d754a6a.png)

它有一个悬停状态，矩形，当前是

```
<div class="topprodcartadd"><a href="#">Add to Cart</a></div> 
```

我做了一个看起来像这样的小 CSS 类：

```
.topprodcartadd {
    width: 190px;
    height: 50px;
    background-color: #000;
    margin: 10px 0px;
    padding:0px 10px 10px 0px;
    float: left;
    text-align: right;
    vertical-align: middle;
}
.topprodcartadd:hover {
    background-color: #00a7e6;
}
.topprodcartadd a {
    text-decoration: none;
    color: #00a7e6;
}
.topprodcartadd a:hover {
    color: #fff;
} 
```

我想以某种方式使其链接，但是在 XHTML Strict 中，当我像这样摇动代码时，它会给我验证错误：

```
<a href="#"><div class="topprodcartadd">Add to Cart</div></a> 
```

那么有人对我可以做些什么来使按钮以这种方式显示有任何其他想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T21:48:15.977

将锚的 CSS 更改为：

```
.topprodcartadd a {
    text-decoration: none;
    color: #00a7e6;
    display:block;
    width: 190px;
    height: 50px;
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/wZ986/)**

我添加`display:block`了宽度和高度，以便链接占据 div 中的所有空间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T21:51:52.017

所以，如果我解决了你的问题：

1）您可以设置`display: block`它`a`以填充父元素。

2) 你确定你需要 XHTML Strict 吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-21T21:51:41.823

如果您只是需要鼠标光标变成手形，只需添加`cursor:pointer`到您的 DIV 样式中，您不必使用锚点。

# grails - Grails 可搜索的关系

> ID：13997617
> 
> 赞同：2
> 
> 时间：2012-12-21T21:45:38.700
> 
> 标签：grails, searchable

我想知道如何返回可搜索的特定域？例如我们有域A和B。两个域都是可搜索的并且有关系：A有很多B，B属于A。另一种情况A和B有多对多的关系。

现在，当我搜索项目时，我必须始终返回 A 项目。就我而言，假设我在 B 中找到匹配项，我需要为每个 B 返回所有 As。其他方式也应该有效。

目前我做的搜索查询是可搜索的服务：

```
def searchResults = searchableService.search(params.q, params) 
```

有没有办法为任何搜索结果获取所有相关的 A 域？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T06:49:12.010

使您的域（A 和 B）都可搜索，然后添加`DomainObject component:true`可搜索的属性。

```
class A{
  String name

  static hasMany = [bclass: B]
  static searchable = {
     bclass component: true
  }
}

class B{
  String color

  static belongsTo= [aclass: A]
  static searchable = true
} 
```

假设在**B**中有一些**颜色**字段值为“红色”的行

```
A.search("red") 
```

将返回**A 的**所有实例，其子类**B**的**颜色**字段值为“红色”

# php - 安装了 suhosin 时引发的 Amazon AWS PHP SDK 2 PharException

> ID：13997619
> 
> 赞同：1
> 
> 时间：2012-12-21T21:45:46.167
> 
> 标签：php, amazon-web-services, phar

使用由 Amazon AWS 提供并作为 phar 存档发布的 PHP SDK 2，我在 QA 服务器上收到以下错误（开发人员很好）

```
Fatal error: Uncaught exception 'PharException' with message 
    '__HALT_COMPILER(); must be declared in a phar' in /home/www/libs/s3/aws.phar:17 
    Stack trace: #0 /home/www/libs/s3/aws.phar(17): Phar::mapPhar('aws.phar') 
                        #1 /home/www/libs/...
                        ... 
```

环顾四周，我发现这可能与 suhosin 安全扩展有关。我需要保持 eaccelerator 运行，并希望保持加固的服务器。来自 phpinfo() 的详细信息是

```
PHP Version 5.3.19-1~dotdeb.0

This server is protected with the Suhosin Patch 0.9.10
Copyright (c) 2006-2007 Hardened-PHP Project Copyright (c) 2007-2012 SektionEins GmbH

eAccelerator

eAccelerator support    enabled
Version         0.9.6.1
Caching Enabled     true
Optimizer Enabled       true
Check mtime Enabled     true
... 
```

php.ini 确实有 suhosin.executor.include.whitelist="phar"

有没有其他人经历过这个？

（我在 AWS PHP 支持论坛上发布了一个类似的问题）

关于如何让 aws.phar 与 suhosin 一起工作的任何想法？

# oracle - plsql oracle如何不允许员工的奖金大于总量的0.1%？

> ID：13997624
> 
> 赞同：1
> 
> 时间：2012-12-21T21:46:18.247
> 
> 标签：oracle, plsql, triggers

我是 sql 新手，想知道是否有人可以帮助我使用触发器调试我的 sql 查询。

我想要做的是不允许员工的奖金超过他们负责的股票总量的 0.1%。谁能帮帮我吗？

我的代码如下：

```
create or replace trigger check_employee_bonus
before update of Bonus or insert on employee
for each row
Declare
Max_Bonus   products.Quantity%TYPE;     
begin
select st.Quantity * 0.1
INTO MaxBonus
from product p, Stock st
Where
p.warehousenum = st.W_no
AND
p.p_no = st.p_no;
if :new.Bonus > Max_Bonus then
RAISE_APPLICATION_ERROR(-20512, 'sales rep’s yearly bonus may not exceed 0.1%  . ');
end if;
end; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T02:10:31.977

I guess there is a problem with your declaration,

```
Declare
Max_Bonus   products.Quantity%TYPE; ********* it should be product.Quantity      
begin
select st.Quantity * 0.1 
```

Table name is mentioned as `products` instead of `product`

# asp.net-mvc-3 - 如何让 Razor 表单使用路由

> ID：13997629
> 
> 赞同：1
> 
> 时间：2012-12-21T21:47:23.013
> 
> 标签：asp.net-mvc-3, razor

我有一个 Razor 表格

```
using (Html.BeginForm("TermList", "Course", FormMethod.Get))
{

    <div style="text-align:right;display:inline-block; width:48%; margin-right:25px;">
             @Html.DropDownList( "id", (SelectList) ViewBag.schoolId)
    </div>
    <input type="submit" value="Choose school" />
} 
```

我希望此表单发布到以下 URI：

```
http://localhost:56939/Course/TermList/764 
```

相反，路线看起来像：

```
http://localhost:56939/Course/TermList?id=764 
```

该路线未被使用。我想取消参数

```
?id=764 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:53:46.247

附加到 URL的原因`?id=764`是因为您使用的是`FormMethod.Get`. 您将与表单一起传递的任何值都将添加到查询字符串中。你需要使用`FormMethod.Post`.

```
@using(Html.BeginForm("TermList", "Course", FormMethod.Post))
{
    ... Your form stuff here ...
} 
```

这将导致表单操作`http://localhost:56939/Course/TermList/`

如果要发布到`http://localhost:56939/Course/TermList/764`您需要在语句中传递`id`参数：`Html.BeginForm`

```
@using(Html.BeginForm("TermList", "Course", new { @id = 764 }, FormMethod.Post))
{
    ... Your form stuff here ...
} 
```

显然，不是硬编码`764`，而是使用存储该值的任何变量。

# javascript - jQuery show() 不显示幻灯片效果

> ID：13997631
> 
> 赞同：0
> 
> 时间：2012-12-21T21:47:44.237
> 
> 标签：javascript, jquery, html, css, jquery-ui

我想使用幻灯片效果隐藏和显示文章元素。当我加载页面并单击主页时，如果文章在屏幕上可见，则我编写的 js 将其隐藏得很顺利，很好，没有问题。但是当我单击关于Us Link，它立即显示文章，没有幻灯片效果。

**这是显示和隐藏代码 + html + 消失的 CSS：**

**HTML：**

```
<nav>
    <ul class="sf-menu sf-vertical">
        <li><a href=# onclick=home()>Home</a></li>
        <li><a href=#about onclick=about()>About Us</a></li>
        <li><a href=#>Cuisines</a>
            <ul>
                <li><a href=#starters>Starters</a></li>
                <li><a href=#>Main Dishes</a></li>
                <li><a href=#>Desserts</a></li>
                <li><a href=#>Mezes</a></li>
            </ul>
        </li>
        <li><a href=#>Wine List</a></li>
        <li><a href=#gallery>Gallery</a></li>
        <li><a href=#contacts>Contacts</a></li>
    </ul>
</nav>

<article class=vanished id=about>
    <h1>About Us</h1>
    <div class="main-wrapper scroll">
        <div class="wrapper clearfix">
            <img src=img/bazar-place.png alt=bazar-place width=222 height=150 class=about-img>
            <h4>Our Restaurant</h4>
            <p>Bazar is a restaurant located between the districts Haga and Vasastaden in Gothenburg with a focus on Turkish and Persian food of the best quality that creates opportunities for an exciting mix all the way, from appetizer to dessert.</p>
        </div>
        <div class="wrapper clearfix">
            <img src=img/belly.jpg alt=belly-dancing width=222 height=167 class=about-img id=belly>
            <h4>Events</h4>
            <p>Every Saturday from 21, we have Belly dancing at Bazar.</p>
        </div>
        <div class="wrapper clearfix">
            <img src=img/food.jpg alt=food-services width=222 height=167 class=about-img id=food>
            <h4>Food Services</h4>
            <p>Taste our famous pasta dish to the human price of 69 :- We offer 10% discount for take-away at our entire menu.</p>
            <p>At lunchtime you can choose from three Turkish pasta dishes or among two or three different main dishes. Ask about vegetarian options! Drinking, salad and coffee / tea included. Lunch can also be picked up.</p>
        </div>
        <div class="wrapper last clearfix">
            <img src=img/extra.jpg alt=extra-services width=222 height=167 class=about-img id=extra>
            <h4>Extra Services</h4>
            <p>We can help with everything from after work, kick-off to the birthday called with food and drink that lasts all night. Do you want more entertainment we can arrange live music and belly dancing.</p>
        </div>
    </div>
</article> 
```

**Javascript：**

```
function home(){

    if ($(".active") == [])
    {
        return ;
    }
    else
    {
        var active = $(".active");
        active.css("display","inline-block");
        active.hide("slide",{direction:"left"},700);
        active.attr("class","vanished");

    }
}
function about(){
    if ($(".active") == [])
    {
        var hidden = $("#about");
        hidden.css("display","inline-block");
        hidden.show("slide",{direction : "right"},700);
        hidden.attr("class","active");
    }
    else
    {
        if ($("#about").attr("class") == "active")
        {
            return ;
        }
        else
        {
            var active = $(".active");
            active.css("display","inline-block");
            active.hide("slide",{direction:"left"},700);
            active.attr("class","vanished");
            var hidden = $("#about");
            hidden.css("display","inline-block");
            hidden.show("slide",{direction : "right"},700);
            hidden.attr("class","active");
        }

    }
} 
```

**CSS：**

```
.vanished{
    display: none;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:53:39.463

这是在隐藏/显示之前：所以它在那时显示为一个块。

```
 hidden.css("display","inline-block"); 
```

我会为此放入 CSS，然后删除这些行。

# asp.net - 具有自定义列表属性的 WCF DataContract

> ID：13997633
> 
> 赞同：1
> 
> 时间：2012-12-21T21:47:58.887
> 
> 标签：asp.net, wcf, web-services

我有一个 WCF 网络服务，它公开了这些类：

```
 [DataContract]
    public class TemplatesFormat
    {        
        List<DynAttribute> _dynsattributes = new List<DynAttribute>();

        [DataMember]
        public List<DynAttribute> DynsAttributes
        {
            get { return _dynsattributes; }
            set { _dynsattributes = value; }
        }
    }

    [DataContract]
    public class DynAttribute
    {
        string _key = "";
        string _val = "";
        [DataMember]
        public string Key
        {
            get { return _key; }
            set { _key = value; }
        }
        [DataMember]
        public string Value
        {
            get { return _val; }
            set { _val = value; }
        }
    } 
```

基本上是2个班。DynAttribute 具有 2 个字符串属性和 TemplatesFormat，其属性是 DynAttribute 类的列表。到现在为止还挺好。

但是，当我从 ASP.NET 网页引用 Web 服务并尝试使用 TemplatesFormat 时，我看不到 List 属性。

我的意思是，我实际上“看到”了它，但它不是一个列表（不包含“Add()”），我不知道如何使用它。

我认为我缺少与 de [DataContrat] 相关的内容以及它是自定义类型的事实，因为 DynAttribute 类没有相同的问题（我看到 Key 和 Value 属性，因为它们是字符串）但是，我无法将它用于列表...

任何的想法？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:56:30.893

WCF 旨在支持许多其他平台的消费。因为`List<DynAttribute>`不是原始类型，所以很可能将其转换为`DynAttribute[]`.

在您的消费应用程序中。尝试使用您的变量，看看是否可以`.ToList()`将其变回`List<DynAttribute>`您期望的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:01:56.783

添加对 wcf 服务的引用时，您需要将 Collection Type 更改为 Generic List。请参阅我的帖子[wcf-proxy-returning-array-instead-of-list-even-though-collection-type-generic](https://stackoverflow.com/questions/13513027/wcf-proxy-returning-array-instead-of-list-even-though-collection-type-generic/13959223#13959223)了解更多详细信息和截图。

# github - 通过 API 获取私有 github 存储库的拉取请求

> ID：13997638
> 
> 赞同：3
> 
> 时间：2012-12-21T21:48:09.837
> 
> 标签：github, github-api

我想以编程方式获取特定私有 github 存储库的开放拉取请求列表 - 我们的，事实证明。我*假设*我只能通过 github api (http://developer.github.com/) 做到这一点 - 随时告诉我还有另一种方式 - 但我也无法弄清楚 API 是否允许这样做。给定的 API 调用似乎假设目标存储库是公开的，而我们的不是。我原以为会有一种方法可以通过 ssh 密钥验证给定存储库的用户身份（与提交工作的方式相同），但我没有看到任何效果。总而言之，我很困惑，完全不确定我真的能做到这一点。我是否遗漏了文档的关键部分，或者是否有一些我可以利用的替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T18:38:17.487

是的，[GitHub 拉取请求 API](http://developer.github.com/v3/pulls/)也支持私有仓库。您只需要进行身份验证，否则您将收到一条错误消息，指出存储库不存在。

使用 curl 和基本身份验证的示例：

```
curl -u "username" https://api.github.com/repos/:user/:repo/pulls 
```

然后，这将提示您输入密码并返回 API 文档中描述的拉取请求列表。

另请查看有关身份验证的文档：http: [//developer.github.com/v3/#authentication](http://developer.github.com/v3/#authentication)

# html - html 和 href 只点击一次

> ID：13997641
> 
> 赞同：2
> 
> 时间：2012-12-21T21:48:38.543
> 
> 标签：html, href

我有一个链接

```
<a href="new link">click me</a> 
```

当用户单击“单击我”链接时，新链接页面将被重定向并在服务器端执行某些操作。问题是，如果用户单击浏览器上的后退按钮，它将返回到旧链接。如果用户点击链接“点击我”，新的链接页面将被打开，服务器端的处理将再次进行。如何预防这种情况？那就是即使用户回到旧页面，新的链接也不能再点击了

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:53:31.867

在链接上生成一个唯一的 id，例如`therequest.do?id=1234`，并记录`1234`到数据库中，这样请求就不能再次运行。

*   用户转到`mypage.do`，服务器生成 id`1234`并将日志作为未处理的数据库。
*   用户点击链接到`therequest.do?id=1234`
*   服务器进行处理，并将 id 标记`1234`为已处理。
*   用户单击返回按钮。
*   用户再次点击链接。
*   服务器检查并看到请求`1234`已处理，因此在屏幕上生成错误消息：`request has already been processed`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T21:54:04.197

您可以尝试创建一个新窗口，这将阻止最终用户返回，但是，您需要创建已访问状态以使按钮在 CSS 中消失。

```
<a href="new link" target="_blank">click me</a> 
```

除此之外，在纯 HTML 中，没有办法阻止用户点击标准链接上的后退按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T21:56:49.580

您可以使用 Javascript 执行此操作。这是显示一种方法的示例代码：

```
<html>
<body>
<a href="#" onclick="f();">click me</a>
<script>
    var first = true;
    function f() {
        if ( first ) {
            first = false;
            window.open('http://www.google.com');
        }
    }
</script>
</body>
</html> 
```

或者，您可以摆脱全局状态变量，并在单击链接后禁用或隐藏链接。

# node.js - mongoose: shorten attribute names of node.js models for storage

> ID：13997648
> 
> 赞同：3
> 
> 时间：2012-12-21T21:49:44.910
> 
> 标签：node.js, mongodb, mongoose, bson

In C# it is possible to use the MongoDB driver to define a custom BSONElement Name to each attribute in your data model, in order to shorten its stored name, such as

```
[BsonElement("n")]
public String Name { get; set; } 
```

Is there any way to accomplish this with **mongoose** for node.js in a model defined like

```
var Project = new Schema({
    id  : ObjectId,
    name: String,
});
mongoose.model("Project", Project); 
```

so that the attribute "name" will be stored as "n" and be referenced in code as "name"?

Researching the [docs](http://mongoosejs.com/docs/guide.html) did not work very well on this one. Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T19:25:35.140

There is a plugin where you can specify alias names, so that you can store single letter fields in the DB, but have really_long_names in your code:

[https://github.com/ramiel/Alias-Field-Mongoose-plugin](https://github.com/ramiel/Alias-Field-Mongoose-plugin)

# cocos2d-iphone - 在 cocos2d 中渲染动态形状

> ID：13997652
> 
> 赞同：1
> 
> 时间：2012-12-21T21:50:10.960
> 
> 标签：cocos2d-iphone, cocos2d-x

我正在使用 cocos2d-x 并希望创建一个动态形状作为我的用户界面的一部分。我需要一个去掉可调节部分的圆圈。我尝试使用 draw 方法进行此操作，但每帧都会绘制项目，这需要太多的处理能力。在不绘制每一帧的形状的情况下，实现这一目标的有效方法是什么？是否可以剪切圆形精灵以删除部分？

![在此处输入图像描述](../Images/b3ab4bc760148c44088042b45b977f8b.png)

实现背后的数学是好的，我只是在寻找关于我应该如何处理这个问题的高级解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T03:35:41.253

你可以试试 CCTransitionProgressRadialCW。此类包含与您想要的类似的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-27T20:37:27.313

原来有一个专门为此设计的类[CCProgressTimer](http://www.cocos2d-iphone.org/api-ref/0.99.3/interface_c_c_progress_timer.html)。

# php - PHP mysql PDO 在不可为空的列中设置 0 而不是在输入为空时引发异常

> ID：13997655
> 
> 赞同：5
> 
> 时间：2012-12-21T21:50:31.747
> 
> 标签：php, mysql, pdo

使用 PHP PDO for mysql 更新具有空值的不可空字段时，我无法生成错误或异常。直接执行 sql 会产生预期的错误。

**PDO 中的所有内容都会导致status_id**字段的值设置为 0，而不是表示该字段不允许为空的异常或错误。

```
$stmt_handler = $this->db_handler->prepare(
  "UPDATE faxes SET metadata = :metadata, status_id = :status_id, 
  created = :created, updated = :updated, content = :content, 
  vendor_fax_id = :vendor_fax_id WHERE id = :id");
$stmt_handler->bindParam(':id', $fax->id);
$stmt_handler->bindParam(':metadata', $fax->metadata);
$stmt_handler->bindParam(':status_id', $fax->status_id); // tried different combinations
$stmt_handler->bindParam(':created', $fax->created);
$stmt_handler->bindParam(':updated', $fax->updated);
$stmt_handler->bindParam(':content', $fax->content);
$stmt_handler->bindParam(':vendor_fax_id', $fax->vendor_fax_id);
$stmt_handler->execute(); 
```

我尝试了不同的组合并将 PDO::ATTR_EMULATE_PREPARES 设置为 false （正如这个问题[PHP mysql PDO 拒绝设置 NULL 值](https://stackoverflow.com/questions/11692773/php-mysql-pdo-refuses-to-set-null-value)所建议的那样）

我的原始绑定：

```
bindParam(':status_id', $fax->status_id); 
```

试过

```
bindValue(':status_id', null, PDO::PARAM_INT);
bindValue(':status_id', null, PDO::PARAM_NULL);
bindValue(':status_id', 'NULL', PDO::PARAM_INT);
bindValue(':status_id', 'NULL', PDO::PARAM_NULL);
bindValue(':status_id', null);
bindValue(':status_id', 'NULL'); 
```

**PHP版本：PHP 5.3.10-1ubuntu3**

**MYSQL 服务器版本：5.5.28-0ubuntu0.12.10.1**

**编辑每条评论**

```
mysql> show columns from faxes;
+---------------+--------------+------+-----+-------------------+-----------------------------+
| Field         | Type         | Null | Key | Default           | Extra                       |
+---------------+--------------+------+-----+-------------------+-----------------------------+
| id            | char(36)     | NO   | PRI | NULL              |                             |
| vendor_fax_id | char(36)     | YES  | UNI | NULL              |                             |
| metadata      | varchar(255) | NO   |     | NULL              |                             |
| status_id     | int(10)      | NO   | MUL | NULL              |                             |
| created       | datetime     | NO   |     | NULL              |                             |
| updated       | timestamp    | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |
| content       | mediumblob   | NO   |     | NULL              |                             |
+---------------+--------------+------+-----+-------------------+-----------------------------+
7 rows in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:39:53.943

仅当您在 mysql 中启用严格模式时才会产生此更新错误。在您的 .ini 文件中，检查：

```
[mysqld]
..snipped..
sql_mode="some values here" 
```

如果它不存在，请添加它，并确保应用了严格设置，例如：

```
[mysqld]
..snipped..
sql_mode="STRICT_TRANS_TABLES" 
```

重新启动服务器，看看你的新错误:)

当这不存在时，我复制了您的问题，一旦我添加并重新启动 mysql，错误就开始出现。

当不可空字段中已经有值时，Mysql仍然可以运行，因此不会产生硬错误。只有严格模式会强制它抛出一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:37:50.127

我试过这个小例子

```
$host = 'localhost';
$database = 'test';
$dbuser = 'USER';
$dbpasswd = '****';
$dsn = "mysql:host=$host;dbname=$database";
$pdo = new PDO($dsn, $dbuser, $dbpasswd);
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$sth = $pdo->prepare('insert into test values(?, ?)');
$id = 2;
$name = null;
$sth->bindParam(1, $id);
$sth->bindParam(2, $name);
$sth->execute() or die(implode(';', $sth->errorInfo())); 
```

这个测试表

```
create table test (
id int not null,
name text not null); 
```

它给了我

```
PHP Fatal error:  Uncaught exception 'PDOException' with message 'SQLSTATE[23000]: Integrity constraint violation: 1048 Column 'name' cannot be null' in /tmp/a.php:15
Stack trace:
#0 /tmp/a.php(15): PDOStatement->execute()
#1 {main}
  thrown in /tmp/a.php on line 15 
```

在命令行上。

*更新*：

将语句更改为

```
update test set name = ? where id = ? 
```

和

```
$id = 1
$name = null 
```

执行没有错误并设置`name`为空字符串。

*更新 2*：

我终于明白了。这与 PDO 无关，但特定于 MySQL。

请参阅[UPDATE Syntax](http://dev.mysql.com/doc/refman/5.5/en/update.html)，向下搜索“not null”

> 如果通过设置为**NULL**来更新已声明为**NOT NULL**的列，则在启用严格 SQL 模式时会发生错误；否则，该列将设置为该列数据类型的隐式默认值，并且警告计数会增加。数字类型的隐式默认值为 0，字符串类型的默认值为空字符串 ('')，日期和时间类型的默认值为“零”。请参见第 11.5 节，“数据类型默认值”。

 **因此，此行为已记录在案。如果你想得到一个错误，你必须启用严格的 SQL 模式。**

# c# - 在标记中为每个 VB 编码

> ID：13997657
> 
> 赞同：-1
> 
> 时间：2012-12-21T21:50:48.973
> 
> 标签：c#, vb.net

我知道我可以将此代码放在标记中以创建 C# 标记的转发器，但我可以在 VB.net 中做类似的事情吗

```
<% foreach (var c in Contacts) { %>
<div class="footer">
    <% if (c.Custody != null) { %>
        <label>Custody:</label> <%= c.Custody.Name %><br />
    <% } %>
</div>
<% } %> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T21:54:03.150

```
<% For Each itm In tContacts %>
 <div class="footer">
    <% If itm.Custody IsNot Nothing Then %>
        <label>Custody:</label> <%= itm.Custody.Name %><br/>
    <% End If %>
 </div>
<% Next %> 
```

这应该可以解决问题！快乐编码！

# java - 后台线程阻止 Tomcat 7 应用程序启动

> ID：13997667
> 
> 赞同：1
> 
> 时间：2012-12-21T21:51:36.860
> 
> 标签：java, multithreading, web-services, tomcat7

**编辑**：
当前代码是有效的解决方案，它不会阻止应用程序，它包含在批准的答案中提出的建议。

* * *

我想要一个后台线程连续下载 MS Access 数据库，而我的 tomcat 7 Web 应用程序正在运行，该线程确实下载了数据库，但是它似乎阻止了我的应用程序的启动，因为我无法从该服务访问任何页面，这是我正在使用的代码：

```
public class DatabaseUpdater implements ServletContextListener {
    private Thread thread = null;

    private final Runnable updater = new Runnable() {

        private boolean hasExpired(File mdbFile) throws IOException {
            if (!mdbFile.exists())
                return true;

            Long ttl = Long.parseLong(Configuration.getValueForOS("db.http-expiration"));

            Date now = new Date();
            Date fileDate = new Date(mdbFile.lastModified());

            return (now.getTime() - fileDate.getTime()) > ttl;
        }

        @Override
        public void run() {
            while (true) {
                if (Thread.currentThread().isInterrupted())
                    throw new RuntimeException("Application Shutdown");

                try {
                    String databases[] = new String[]{"database1", "database2"};
                    for (String database : databases) {

                        String fileName = database + "." + StringUtil.randomString(8) + ".mdb";
                        String fileLocation = Configuration.getValueForOS("db.path");

                        File mdbFile = new File(fileLocation, fileName);
                        File currentDatabaseFile = new File(fileLocation, database + ".mdb");

                        if (hasExpired(currentDatabaseFile)) {
                            URL url = new URL(Configuration.getValueForOS("db.url." + database));
                            InputStream in = url.openConnection().getInputStream();
                            OutputStream out = new FileOutputStream(mdbFile);

                            FileUtil.streamBridge(in, out);
                            FileUtil.close(in, out);

                            while (currentDatabaseFile.exists() && !currentDatabaseFile.delete()) ;
                            while (!mdbFile.renameTo(currentDatabaseFile)) ;
                       }
                   }
                     // Put the thread to sleep so the other threads do not starve
                    Thread.sleep(Long.parseLong(
                        Configuration.getValueForOS("db.http-expiration"));
                } catch (IOException ioe) {
                    ioe.printStackTrace();
                } catch (InterruptedException ie) {
                    ie.printStackTrace();
                }
            }
        }
    };

    @Override
    public void contextInitialized(ServletContextEvent servletContextEvent) {
        this.thread = new Thread(updater);
        thread.start();
    }

    @Override
    public void contextDestroyed(ServletContextEvent servletContextEvent) {
        if (this.thread.isAlive())
            this.thread.interrupt();
    }
} 
```

可能是什么原因造成的？

我的实现基于这个问题：[Background Thread for a Tomcat servlet app](https://stackoverflow.com/questions/791986/background-thread-for-a-tomcat-servlet-app)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:08:05.343

鉴于您的代码永远循环，您可能会饿死 VM 中的所有其他线程。尝试不时休眠线程。

# c++ - 使用 C++ 计算来自服务的监视器

> ID：13997670
> 
> 赞同：1
> 
> 时间：2012-12-21T21:51:47.360
> 
> 标签：c++, winapi, multiple-monitors

我正在尝试计算从服务应用程序连接到控制台的监视器（即屏幕）的数量。我执行以下操作：

```
int CountMonitors()
{
    int nCnt = 0;

    if(!EnumDisplayMonitors(NULL, NULL, _countMonitorEnumProc, (LPARAM)&nCnt))
    {
        //Error
        nCnt = -1;
    }

    return nCnt;
}

BOOL _countMonitorEnumProc(HMONITOR hMonitor, HDC hdcMonitor, LPRECT lprcMonitor, LPARAM dwData)
{
    int* pCnt = (int*)dwData;
    (*pCnt)++;

    return TRUE;
} 
```

[但计数始终为 1（当我在双显示器 Windows 7 上对其进行测试时。）然后我执行此操作（由于其限制](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724385%28v=vs.85%29.aspx#SM_CMONITORS)，这并不是我所需要的）：

```
int nCnt = GetSystemMetrics(SM_CMONITORS); 
```

结果也是1。

那么如何计算服务中的监视器呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:06:40.283

首先，为什么控制台对服务来说是特殊的，而不是远程会话上附加的显示器数量？那么，显示镜像/扩展桌面/eyefinity呢？

现在，了解[Window Stations 和 Desktops](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687098.aspx)。然后了解粉碎攻击。

最后，如果您真正追求的是硬件枚举，那么有相应的 API。 `SetupDiGetClassDevs`在显示监视器设置类上将告诉您视频卡暴露了多少物理屏幕。

# windows - 失败的 DisconnectEx/AcceptEx 仍会安排重叠的 IOCP 事件

> ID：13997674
> 
> 赞同：0
> 
> 时间：2012-12-21T21:52:22.447
> 
> 标签：windows, sockets, winapi, networking, iocp

视窗 8，x64。

将重叠的 Windows 套接字 Api 与 IOCP 一起使用。

注意到套接字的意外行为：例如，对 DisconnectEx 的调用返回错误 WSAENOTCONN，但后来我在 GetQueuedCompletionStatusEx 中收到一个事件，正是这个断开连接（就像它仍然被安排而不考虑返回的错误一样）。AcceptEx 也会发生同样的情况（返回不同的错误，例如 WSAEINVAL）。

我期望 IOCP 事件仅被安排用于挂起的操作（返回错误代码 WSA_IO_PENDING），而不是其他错误。

**编辑**：我的问题是：即使对 DisconnectEx/AcceptEx 的调用返回不是 WSA_IO_PENDING 的错误（WSAGetLastError），系统能否安排 IOCP 事件？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:30:53.727

[IOCP](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365458%28v=vs.85%29.aspx)往往会在看似奇怪的时间向您充斥状态，包括在您认为句柄已关闭之后...我已经关闭了把手。然后将处理任何排队的系统状态，当我得到自定义的 OVERLAPPED 时，我知道我可以释放与句柄相关的所有内部缓冲区。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T16:50:07.983

上述问题的答案是否定的。我遇到的问题是我在同一个重叠结构上安排了几个 IOCP 事件，这导致了这种奇怪的行为。

# java - 在休眠条件查询中选择“所有列”和“分组依据”

> ID：13997675
> 
> 赞同：12
> 
> 时间：2012-12-21T21:52:31.643
> 
> 标签：java, mysql, hibernate, group-by, hibernate-criteria

我想使用“group by”编写一个条件查询并希望返回所有列。

平面sql是这样的：

```
select * from Tab group by client_name order by creation_time; 
```

我知道它将有`count(distinct client_name)`行数。

我当前的查询似乎没有给出正确的结果，如下所示：

```
Criteria criteria = getSession(requestType).createCriteria(Tab.class);
        criteria.setProjection(Projections.projectionList().add(Projections.groupProperty("client_name")));
        criteria.addOrder(Order.asc("creationTime")); 
```

此查询`"client_name"`仅返回。我不想手动放置所有列名。一定有办法，有什么办法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T15:00:47.863

我认为你误解了一些东西。如果您`GROUP BY`在 SQL 中，那么您需要按所有选定的列进行分组。这同样适用于 Hibernate - 如果您`groupProperty`在 a 中`Projection`，您是在告诉 Hibernate 该列是一个组列。如果没有引用其他列/字段，Hibernate 将假定您不想要它们，因为它们也需要被分组。

退后一步：你想做什么？如果您在表中的*所有*列中都有重复的数据，则您可能有错误的数据，或者不正确地保存数据。至少，你的钥匙会被弄乱。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-16T14:43:41.430

在投影的休眠中，需要将所需的所有列添加到投影列表中。要在实体中获取结果，我们必须使用 setResultTransformer。检查下面的示例以在休眠中获取分组：

```
 ProjectionList projectionList = Projections.projectionList();
    projectionList.add(Projections.groupProperty("column1"));
    projectionList.add(Projections.property("column2"));
    projectionList.add(Projections.property("column3"));
    criteria.setProjection(projectionList);
    criteria.setResultTransformer(Transformers.aliasToBean(Table.class)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-17T04:40:53.560

使用休眠投影时，您应该在投影列表中添加所有需要的列。您只使用了 Projections.projectionList().add(Projections.groupProperty("client_name"))

这个 。所以很明显只返回client_name。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-02T13:44:17.273

使用基于单个列的组是不可能获取数据库的所有列的。**相反，您可以使用group by 子句**中的所有列以及您想要的**select中的所有列。**要在休眠状态下获得结果，如下所示

```
 Criteria criteria = getSession(requestType).createCriteria(Tab.class);
    ProjectionList projectionList = Projections.projectionList();
    projectionList.add(Projections.property("client_name"));
    projectionList.add(Projections.property("column2"));
    projectionList.add(Projections.property("column3"));
    projectionList.add(Projections.groupProperty("client_name"));
    projectionList.add(Projections.groupProperty("column2"));
    projectionList.add(Projections.groupProperty("column3"));
    criteria.setProjection(projectionList);
    criteria.addOrder(Order.asc("creationTime")); 
```

# c# - 为什么我的 WAMS 查询返回其返回类型的详细名称而不是表中的值（在这种情况下应该为 null）？

> ID：13997677
> 
> 赞同：0
> 
> 时间：2012-12-21T21:52:53.863
> 
> 标签：c#, linq, windows-8, windows-store-apps, azure-mobile-services

这个查询：

```
public static async Task<List<string>> GetSenderDeviceIDForSenderIDAndReaderDeviceID(string senderID, string readerDeviceID)
{
    IMobileServiceTable<PLATYPUS_WAMS_INVITATIONS> table = App.MobileService.GetTable<PLATYPUS_WAMS_INVITATIONS>();

    MobileServiceTableQuery<String> query =
        table.Where(i => i.SenderID == senderID).
              Where(i => i.ReaderDeviceID == readerDeviceID).
              Select(i => i.SenderDeviceID).
              Take(1); // the query returns a List, but I only want 1 record (and it should only return 1)
    return await query.ToListAsync();
} 
```

返回“ *System.Threading.Tasks.Task `1[System.Collections.Generic.List`1[System.String]]* ”

它应该为空（在我正在运行的特定测试用例中）和其他时间的值，例如“03-11-BA-22”。

# java - GC 优化：for vs foreach

> ID：13997679
> 
> 赞同：9
> 
> 时间：2012-12-21T21:53:00.293
> 
> 标签：java, android, memory-management, garbage-collection

我一直在尝试优化我的一些代码，并且我对 fors 得出了一个奇怪的结论。

在我的测试用例中，我创建了一个具有主要活动的新项目。该活动初始化一个包含 500 个对象的列表，运行显式 GC 并启动线程。线程循环函数doCalculations。

this.objects 是 500 个 MyObject 的列表，previous 是 MyObject，value 是 int。功能逻辑没有逻辑，它们只是在那里做事。区别在于内部。

功能1

```
public void doCalculations()
{
    for(MyObject o : this.objects)
            for(int i=0; i<this.objects.size(); i++)
                if(this.objects.get(i) == o)
                    o.value = this.objects.get(i).value;
} 
```

功能二

```
public void doCalculations()
{
    for(MyObject o : this.objects)
            for(MyObject o2 : this.objects)
                if(o2 == o)
                    o.value = o2.value;
} 
```

使用功能 2 GC 在我的 nexus 上每 ~10 秒调用一次，释放 ~1.7MB。

使用功能 1 GC 永远不会被看到。

这是为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T21:55:31.313

一个创建迭代器，另一个不创建。

GC 实际上是您应用程序的瓶颈吗？（这似乎不太可能。包括我自己在内的许多开发人员会认为可读性优势超过几微秒的 GC。）

也就是说，无论如何，您的整个循环都是无操作的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T21:58:28.350

我的建议是'因为内部 for 循环为外部 for 循环的每次运行创建一个迭代器（在*函数 2*中）。这个迭代器实例不是在*函数 1中创建的*

# jquery - 在 mouseleave div 上切换 marginTop

> ID：13997681
> 
> 赞同：0
> 
> 时间：2012-12-21T21:53:06.780
> 
> 标签：jquery

我有一个可以上下滑动 div 的切换功能。但是如何让它在 mouseleave 上切换 marginTop -200？

我应该有一个单独的mouseleave函数吗？

```
$(document).ready(function() {
    $('.menu-item-40').toggle(

    function() {
        $('#slidenav').animate({
            marginTop: '0'
        }, 500);
    }, function() {
        $('#slidenav').animate({
            marginTop: '-200px'
        }, 500);
    });
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:07:03.537

使用选择器`mouseleave`上的事件`div`。然后应用`toggleMargin`我为您创建的自定义函数（我使用 +-20px 代替您想要的值）

```
<div id="div"></div>

// CUSTOM TOGGLEMARGIN FUNCTION
var t = true;
jQuery.fn.toggleMargin=function(){
  var lastmargin = $(this).css('margin-top').replace("px", "");
  var newMargin;
  if(t){
    newMargin = parseInt(lastmargin)+20;
    t=false;
  }
  else{
    newMargin = parseInt(lastmargin)-20;
    t=true;
  }
  // Now apply the margi-top css attr
  $(this).css('margin-top', newMargin );
}

// LET'S TOGGLE MARGIN ON YOUR DIV
$('#div').mouseleave(function(){
   $(this).toggleMargin();    
});​ 
```

**[测试](http://jsfiddle.net/UxVHe/2/)**

* *22/12/12 更新 **

因为我只有提供的代码，所以试试这个：

[**测试2**](http://jsfiddle.net/UxVHe/5/)

```
// CUSTOM TOGGLEMARGIN FUNCTION
var t = true;
jQuery.fn.toggleMargin=function(){
var lastmargin = $(this).css('margin-top').replace("px", "");
var newMargin;
if(t){
  newMargin = parseInt(lastmargin)+20;
  t=false;
}
else{
  newMargin = parseInt(lastmargin)-20;
  t=true;
}
// Now apply the margi-top css attr
$(this).css('margin-top', newMargin ); 
}

$('#slidenav').mouseleave(function(){
      $(this).toggleMargin();            
});

$('.menu-item-40').click(function(){
        $('#slidenav').toggle(function() {
        $(this).animate({marginTop: '0'}, 500);
        });        
}); 
```

# php - Laravel 中的 CakePHP 组件替代方案

> ID：13997686
> 
> 赞同：2
> 
> 时间：2012-12-21T21:53:33.383
> 
> 标签：php, cakephp, laravel

CakePHP 具有组件结构 - 库，用于在控制器之间共享逻辑。Laravel 中是否有这样的东西以及放在哪里？我想过图书馆，但不一样。

我在 Laravel 文档中找不到任何内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T12:03:32.797

> 例如，我正在为 index() 函数创建自定义表示逻辑，它将在某些控制器中使用。例如 ControllerA 和 ControllerN 将使用 ComponentA 逻辑来过滤来自 ModelA 或 ModelN 的记录和列

您可以制作 ModelX，它处理您针对特定问题的所有逻辑。

[在此处查看更多信息](http://laravel.io/topic/18/some-tips-for-laravel-newbies)（并滚动到“域建模”）

# visual-c++ - 在 Init() 中加载纹理

> ID：13997694
> 
> 赞同：0
> 
> 时间：2012-12-21T21:54:23.707
> 
> 标签：visual-c++, opengl

尝试对天空盒进行纹理化并使用“ImageLoader::createJPG”加载纹理，它以正确的格式加载纹理文件，如果我在每个显示循环中加载它们，我的代码将其纹理化为多边形就好了（这显然是糟糕的表现受到了打击。）

但是当我在 init() 中尝试相同的代码只是为了加载它们一次时，显示甚至不认为它们存在（我最终得到了一个默认颜色的立方体。）

胶合天前；etc. 在文件顶部 #includes 之后的任何其他内容之前声明。

没有多少 enable 或 texParameters 似乎使 init() 想要加载纹理。有任何想法吗？

```
GLuint skyTop;
GLuint skyFront;
GLuint skyBack;
GLuint skyBottom;
GLuint skyLeft;
GLuint skyRight;

void display()                                  
{
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glMatrixMode(GL_MODELVIEW);

glLoadIdentity();

glTranslatef(0,0,-0.6);
glTranslatef(0, -0.4, -1);        

glPushMatrix(); 
glDisable(GL_DEPTH_TEST);

glDisable(GL_LIGHTING);
glDisable(GL_BLEND);
//glEnable(GL_LIGHT0);
//glTranslatef(camPos.x, camPos.y,camPos.z);
//glDepthMask(GL_FALSE);
glDisable(GL_CULL_FACE);
//draw skybox
glLoadIdentity();
glEnable(GL_TEXTURE_2D);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE);
glColor3f(0.0, 1.0, 0.0);
glTranslatef(0.0,-2.0,-20.0);
        GLuint skyTop = ImageLoader::createJPG("../TestModels/top.jpg");
        GLuint skyBottom = ImageLoader::createJPG("../TestModels/bottom.jpg");
        GLuint skyLeft = ImageLoader::createJPG("../TestModels/left.jpg");
        GLuint skyFront = ImageLoader::createJPG("../TestModels/front.jpg");
        GLuint skyRight = ImageLoader::createJPG("../TestModels/right.jpg");
        GLuint skyBack = ImageLoader::createJPG("../TestModels/back.jpg");

        //FRONT
            glBindTexture(GL_TEXTURE_2D, skyFront);
            glBegin(GL_QUADS);
                glTexCoord2f(0, 0); glVertex3f(-SKYBOXSIZE, SKYBOXSIZE, -SKYBOXSIZE);       //A
                glTexCoord2f(0, 1); glVertex3f(-SKYBOXSIZE, -SKYBOXSIZE, -SKYBOXSIZE);      //B
                glTexCoord2f(1, 1); glVertex3f(SKYBOXSIZE, -SKYBOXSIZE, -SKYBOXSIZE);       //C
                glTexCoord2f(1, 0); glVertex3f(SKYBOXSIZE, SKYBOXSIZE, -SKYBOXSIZE);        //D
            glEnd();

            glBindTexture(GL_TEXTURE_2D, skyLeft);
            //LEFT
            glBegin(GL_QUADS);
                glTexCoord2f(1, 1); glVertex3f(SKYBOXSIZE, SKYBOXSIZE, -SKYBOXSIZE);        //D
                glTexCoord2f(0, 1); glVertex3f(SKYBOXSIZE, -SKYBOXSIZE, -SKYBOXSIZE);       //C
                glTexCoord2f(0, 0); glVertex3f(SKYBOXSIZE, -SKYBOXSIZE, SKYBOXSIZE);        //E
                glTexCoord2f(1, 0); glVertex3f(SKYBOXSIZE, SKYBOXSIZE, SKYBOXSIZE);     //F
            glEnd(); 
```

等等等等

编辑：

init() 代码如下所示：

```
void init()
{
glewInit()

    GLuint skyFront = ImageLoader::createJPG("../TestModels/front.jpg"); //load the texture, damnit

glClearColor(0.0,0.0,0.0,0.0);                      

glShadeModel(GL_SMOOTH);

//light position and colour
GLfloat light_position[] = { 0.0, 0.0, 20.0,0.0 };
GLfloat white_light[] = {0.8,0.8,0.8,0.0};
GLfloat diff_light[] = {1.0,1.0,1.0,0.0};
GLfloat spec_light[] = {1.0,1.0,1.0,0.0};
glLightfv(GL_LIGHT0, GL_AMBIENT, white_light);
glLightfv(GL_LIGHT0, GL_DIFFUSE, diff_light);
glLightfv(GL_LIGHT0, GL_SPECULAR, spec_light);
glLightfv(GL_LIGHT0, GL_POSITION, light_position);

//ambient light
GLfloat ambient[] = {0.3,0.3,0.3};
glMaterialfv(GL_FRONT, GL_AMBIENT, ambient);

//diffuse material component
GLfloat diff[] = {0.6,0.6,0.6};
glMaterialfv(GL_FRONT, GL_DIFFUSE, diff);

//specular material component
GLfloat WhiteSpec[] = {1,1,1};
glMaterialfv(GL_FRONT, GL_SPECULAR, WhiteSpec);

GLfloat shininess = 50;
glMaterialf(GL_FRONT, GL_SHININESS, shininess);

//ENABLE LIGHTING AND DEPTH TEST
glEnable(GL_LIGHTING);
glEnable(GL_LIGHT0);

glEnable(GL_DEPTH_TEST);

cout << " loading model " << endl;
if(objLoader.loadModel("../TestModels/hummer.obj", model))//returns true if the model is loaded, puts the model in the model parameter
{
    cout << " model loaded " << endl;       

    //if you want to translate the object to the origin of the screen,
    //first calculate the centre of the object, then move all the vertices
    //back so that the centre is on the origin.
    model.calcCentrePoint();
    model.centreOnZero();

    model.calcVertNormalsUsingOctree();  //the method will construct the octree if it hasn't already been created.

    //turn on VBO by setting useVBO to true in 3dmodel.cpp default constructor - only permitted on 8 series cards and higher
    if(!model.useImmediateMode || model.useVBO)
    {
        model.initDrawElements();
    }
    if(model.useVBO)
    {
        model.initVBO();
        model.deleteVertexFaceData();
    }

}
else
{
    cout << " model failed to load " << endl;
}
} 
```

所有其余的 GL 命令都通过了，甚至我加载的模型也通过了。TexPerameters等是在ImageLoader中定义的，是的..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T09:49:18.860

这些是全球性的：

```
GLuint skyTop;
GLuint skyFront;
GLuint skyBack;
GLuint skyBottom;
GLuint skyLeft;
GLuint skyRight; 
```

但这设置了一个本地：

```
void init()
{
    glewInit()

    GLuint skyFront = ImageLoader::createJPG("../TestModels/front.jpg"); //load the texture, damnit 
```

您无需重新声明 skyFront 变量，而是使用全局变量。

# ios - 将 MonkeyTalk iOS 代理添加到 XCode 中的目标构建后，项目构建失败

> ID：13997697
> 
> 赞同：1
> 
> 时间：2012-12-21T21:54:48.433
> 
> 标签：ios, xcode, testing

我已将 iOS 代理添加到 XCode 4.5 中的项目中。构建失败并出现以下错误：

```
Undefined symbols for architecture i386:
"_MPMoviePlayerPlaybackStateDidChangeNotification", referenced from:
+[MPMovieView(MTReady) load] in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
"_OBJC_CLASS_$_MPFullScreenTransportControls", referenced from:
l_OBJC_$_CATEGORY_MPFullScreenTransportControls_$_MTDisable in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
"_OBJC_CLASS_$_MPFullScreenVideoOverlay", referenced from:
l_OBJC_$_CATEGORY_MPFullScreenVideoOverlay_$_MTDisable in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
"_OBJC_CLASS_$_MPMovieView", referenced from:
anon in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
l_OBJC_$_CATEGORY_MPMovieView_$_MTReady in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
"_OBJC_CLASS_$_MPSwipableView", referenced from:
l_OBJC_$_CATEGORY_MPSwipableView_$_MTDisable in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
"_OBJC_CLASS_$_MPTransportButton", referenced from:
l_OBJC_$_CATEGORY_MPTransportButton_$_MTDisable in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
"_OBJC_CLASS_$_MPVideoBackgroundView", referenced from:
l_OBJC_$_CATEGORY_MPVideoBackgroundView_$_MTDisable in libMonkeyTalkMediaPlayer-1.0.24.a(MPMovieView+MTReady.o)
ld: symbol(s) not found for architecture i386
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

有人可以帮我吗。没有 iOS 代理的构建可以正常构建。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:08:09.207

听起来你需要链接`MediaPlayer.framework`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T17:13:40.853

如果您尚未使用 MediaPlayer 框架，则可能不需要链接 libMonkeyTalkMediaPlayer-1.0.24.a 库 - 您应该只需要 libMonkeyTalk-1.0.24.a 库。

您可能已经知道，链接 libMonkeyTalk-1.0.xx.a 库的基本说明在[这里](http://www.gorillalogic.com/monkeytalk-documentation/monkeytalk-getting-started/install-agent/ios)。

# twitter - 如何并行查询 Twitter 时间线？

> ID：13997710
> 
> 赞同：0
> 
> 时间：2012-12-21T21:57:01.377
> 
> 标签：twitter

我正在构建一个 Twitter 应用程序，我将从用户的时间线中提取大量数据。为了速度，我需要并行查询时间线。我的目标是从 API 中提取 1000 条用户的推文，但 Twitter API 将每个请求的推文数量上限设置为 200。分页通过指定上一个请求中最后一个（最旧的）推文的 ID 来工作，所以我需要知道上一个 API 调用的结果才能进行下一个调用。此方法不可并行化。是否有任何替代方法可以从 Twitter API 获取用户时间线，我可以在其中发出并行请求（有该`page`属性，但已弃用，并且在不久的将来将无法使用）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T20:55:53.413

你必须记住的是，Twitter 与外部开发人员的关系很艰难。他们根本不允许将他们的 API 用于任何有趣的事情。

您需要的是访问[Firehose](https://dev.twitter.com/discussions/2752)。

然而，[即使你愿意每年支付一百万美元](http://techcrunch.com/2012/12/04/peoplebrowsr-says-twitter-changed-position-on-eve-of-discovery-battle-twitter-wants-federal-jurisdiction/)——Twitter 也不感兴趣。

[您可以尝试从Gnip](http://gnip.com/)之类的第三方获取它，但 - 再次 - 可能很昂贵。

所以，基本上，你不能。Twitter 只是对业余开发者在他们的平台上做任何创新的东西不感兴趣。对不起。

# c# - 我的依赖属性有什么问题？

> ID：13997711
> 
> 赞同：2
> 
> 时间：2012-12-21T21:57:06.243
> 
> 标签：c#, wpf, xaml

编译器和运行时不会抱怨绑定，但 Setter 永远不会在我的 AutoCompleteTextBox 中命中。

```
<Controls:AutoCompleteTextBox   
    Items="{Binding Path=DropDownValues}"
    Width="200" 
    Grid.Column="1" 
    Height="30"
   Tag="{Binding}"
  /> 
```

和

```
 public partial class AutoCompleteTextBox
    {
        public static readonly DependencyProperty ItemsProperty =
            DependencyProperty.Register(
                "Items",
                typeof(ItemCollection),
                typeof(AutoCompleteTextBox),
                new PropertyMetadata(default(ItemCollection), OnItemsPropertyChanged));

       public ItemCollection Items
       {
           get
           {
               return (ItemCollection)GetValue(ItemsProperty);
           }
           set
           {
               SetValue(ItemsProperty, value); //doesn't get hit
           }
       }

//This is how i'm cheating since my Items is always null
        private void CanvasName_Loaded(object sender, RoutedEventArgs e)
        {
            object obj = this.Tag;

            if (obj != null)
            {
                CjisQueryAutoCompleteData at = obj as CjisQueryAutoCompleteData;
                if (at != null)
                {
                    //use the data...
                    PopDropDown(at.DropDownValues);
                }
            }
        }

       //....
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-21T21:59:02.093

没有错。在 XAML 中设置依赖项属性时，WPF 直接访问 DependencyProperty，而不调用 CLR 包装器。把它想象成 WPF 会直接调用 SetValue。

请参阅[XAML 加载和依赖属性](http://msdn.microsoft.com/en-us/library/bb613563.aspx)，自定义依赖属性的含义。

`OnItemsPropertyChanged`但是，您会注意到在调用回调时已设置该属性。

# sql - Excel 2010 数据->“全部刷新”缓慢

> ID：13997716
> 
> 赞同：1
> 
> 时间：2012-12-21T21:57:36.153
> 
> 标签：sql, excel, ms-access

目前正在使用一个 Excel 电子表格，该电子表格至少对外部 Microsoft Access *.mdb 文件进行 10 次数据库查询。对于我公司从事的每个项目，我们都有一个与该项目相关的特定 Excel 文件，因此我们有数百个这样的文件。通常，当分析师打开“数据”选项卡并单击“全部刷新”时，刷新会在一两分钟内完成；但是，对于给定 excel 文件的新项目，完成刷新至少需要一个小时。以下是其中一个连接字符串的示例：

```
DSN=MS Access Database;DBQ=W:\Projects\Analysis\project.mdb;DefaultDir=W:\Projects\Analysis\Analysis;DriverId=25;FIL=MS Access;MaxBufferSize=2048;PageTimeout=5; 
```

这是相关的查询：

```
SELECT Field.FieldNumber, Field.FieldName, Field.GroupMnemonic, Field.ClientFieldID
FROM Field Field
ORDER BY Field.FieldName 
```

我花了很多时间研究各种讨论缓慢 excel 问题的网站，例如[http://msdn.microsoft.com/en-us/library/ff700515.aspx](http://msdn.microsoft.com/en-us/library/ff700515.aspx)；但是，这些网站更多地处理计算和 VBA，而我怀疑性能问题出在访问文件的某个地方。有人对如何解决和解决此问题有任何建议吗？TIA。

更新：正如 JohnFx 在下面的答案中所建议的，我检查了查询，发现它们没有明确的键，所以在 Microsoft Access 数据库生成中添加了这样的键：

```
CREATE UNIQUE INDEX PIndex ON [myTable] ([KEY]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:03:22.457

作为问题的一部分，直接在 Access 中单独运行查询以规则 Excel 输入或输出。如果 Access 中的查询仍然很慢，请考虑在任何正在排序或过滤的列上添加索引。

# javascript - 使用浏览器从服务器拉取消息更新消息

> ID：13997718
> 
> 赞同：0
> 
> 时间：2012-12-21T21:57:43.017
> 
> 标签：javascript, c, asp.net-mvc, node.js, knockout.js

我的任务是创建一个网页（想想 twitter），当新消息添加到数据库时会更新。当一条消息从数据库中删除时，它也必须从客户端中删除。多个客户端可能同时访问相同的消息。可能会发生其他操作，例如在服务器上发出停止命令。一旦发生这种情况，服务器上的所有消息都将停止显示。

我正在寻找的是解决这个问题的架构。

我使用的技术是 .Net 4.5、ASP.Net MVC 和 KnockoutJs。可以使用 Nodejs，但我需要知道使用 nodejs 比使用 SignalR 的好处。

我目前的实现是使用一个 javascript 计时器，它每 30 秒轮询一次服务器以获取新消息。它有效，但投票感觉很脏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:01:32.667

无法对 ASP.NET 发表评论 - 但已为此使用了 Node.js 和 Knockout。我使用了 WebSockets（通过 socket.io 库）和服务器发送事件 (SSE) 来将更新推送到客户端模型。

听起来 SSE 很适合这种情况。关键是您的数据库技术应该支持向节点中间件发送更改事件，以便您可以将其发送到浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T17:38:43.580

经过更多研究，轮询方法是所涉及技术的最佳解决方案。

问题的症结在于没有新消息的通知，这会促使系统发生变化。目前，当它被提交到数据库时会收到一条新消息。SQL Server 没有通知机制（这不是 100% 正确的，但它不是我希望承担的依赖项）。从长远来看，最佳系统是使用 SignalR 或 nodejs 实现发布/订阅 motel，将实时消息传递给客户端。为此，需要对应用程序进行完整的重新架构。

# webbrowser-control - 使用嵌入式 WebBrowser 控件时如何绕过 Internet Explorer 增强安全性？

> ID：13997720
> 
> 赞同：6
> 
> 时间：2012-12-21T21:57:52.500
> 
> 标签：webbrowser-control, twebbrowser, iwebbrowser2

我有一个嵌入的本地 Windows 应用程序`WebBrowser`，即

*   `CLSID_WebBrowser`
*   `8856F961-340A-11D0-A96B-00C04FD705A2`
*   `Shell.Explorer.2`

不幸的是，在 Windows 服务器上运行时，**[Internet Explorer 增强安全](http://msdn.microsoft.com/en-us/library/ms537180.aspx)**模式会干扰**WebBrowser**控件，导致它根本无法呈现：

[![在此处输入图像描述](../Images/8b4caca1d74c1be131ba7a632b40c0e0.png)](https://i.stack.imgur.com/zEUJ1.png)

在这种情况下，软件的 UI 被驱动为**WebBrowser**控件 - 使软件无法使用。

我可以[禁用**Internet Explorer 增强安全**模式](http://4sysops.com/archives/how-to-disable-internet-explorer-enhanced-security-configuration-ie-esc-in-windows-server-2012/)，但这不切实际。

如何指示 Internet Explorer 浏览器允许嵌入式浏览器在没有安全对话框的情况下呈现？

**注意：**我会建议添加`about:security_Application.exe`到**受信任区域**列表”

[![在此处输入图像描述](../Images/da57899b6555ee8dfadbb29dc4de6707.png)](https://i.stack.imgur.com/6DZpP.png)

遗憾的是，这将需要 DRP/FRP 验证、ISO 安全评估，并且必须调用安全组来进行更改。此外，还需要创建一个 RFC，这样 KPMG 就不会进行 hissy-fit 下一次审计。我希望有一个*“好”*的解决方案。

# 也可以看看

*   [自定义（禁用）IE 控件的安全设置](https://stackoverflow.com/questions/9380870/customizing-disabling-security-settings-for-ie-control)
*   [自定义 IInternetSecurityManager 未通过对话框调用](https://stackoverflow.com/questions/4996730/custom-iinternetsecuritymanager-not-being-called-with-dialogs)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:09:43.820

您可以指定不同的 URL。例如，您可以将内容提取到临时文件并导航到它。这不会将您的内容放入受信任区域，但它比您为 about 协议获得的 Internet 区域要好。

如果您不想保存内容，可以先导航到 about:blank，然后在[DocumentComplete](http://support.microsoft.com/kb/q180366)中 QI 文档 for [`IPersistMoniker`](http://msdn.microsoft.com/en-us/library/ms775042%28v=vs.85%29.aspx)，然后使用基本上模拟 url 名字对象的 TInterfacedObject 调用 Load。

1.  [`IMoniker.GetDisplayName`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680754%28v=vs.85%29.aspx)实现需要返回 URL 。url 需要位于受信任的区域中。
2.  [`IMoniker.BindToStorage`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms688738%28v=vs.85%29.aspx)当询问 IStream 时，实现需要发回对 TMemoryStream 的引用。

还有第三种方法，编写一个[进程范围的安全管理器](http://bsalsa.com/ewb_zone.html)，将您的 url 放在受信任的区域中。

* * *

解决方案是实现您自己的 Internet 安全管理器服务，创建一个实现的对象[`IInternetSecurityManager`](https://msdn.microsoft.com/en-us/library/ms537130(v=vs.85).aspx)（请参阅[MSDN：实现自定义安全管理器](https://msdn.microsoft.com/en-us/library/ms537182(v=vs.85).aspx)）。有五个安全区域：

*   本地：`URLZONE_LOCAL_MACHINE`(0)
*   内网：`URLZONE_INTRANET`(1)
*   受信任：`URLZONE_TRUSTED`(2)
*   互联网：`URLZONE_INTERNET`(3)
*   受限：`URLZONE_UNTRUSTED`(4)

您真正需要担心的唯一方法是[`MapUrlToZone`](https://msdn.microsoft.com/en-us/library/ms537133(v=vs.85).aspx)：

```
TEmbeddedSecurityManager = class(TInterfacedObject, IInternetSecurityManager)
public
   //...
   function MapUrlToZone(pwszUrl: LPCWSTR; out dwZone: DWORD; dwFlags: DWORD): HResult; virtual; stdcall;
   //...
end; 
```

此方法检查 Url 是否以`about:security`

> 关于：security_Contoso.exe

如果是，则返回该区域应为**Local**：

```
function TEmbeddedSecurityManager.MapUrlToZone(pwszUrl: LPCWSTR; out dwZone: DWORD; dwFlags: DWORD): HResult;
var
    url: UnicodeString;
begin
    Result := INET_E_DEFAULT_ACTION;

    {
        https://msdn.microsoft.com/en-us/library/ms537133(v=vs.85).aspx
    }
    url := pwszUrl;
    {
        When IE Enchanced Security is enabled, the url goes from 
            about:blank_xxxx
        to 
            about:security_xxxx

        In that case we will put the page in the "Local" zone
    }
    if url.StartsWith('about:security') then
    begin
        dwZone := URLZONE_LOCAL_MACHINE; //Local
        Result := S_OK;
    end;
end; 
```

所有其他方法都**必须**返回`INET_E_DEFAULT_ACTION`（即*不是*S_OK 也不是 E_NOTIMPL），例如：

```
function TEmbeddedSecurityManager.SetSecuritySite(Site: IInternetSecurityMgrSite): HResult;
begin
    Result := INET_E_DEFAULT_ACTION;
end; 
```

当嵌入式 WebBrowser 调用 IServiceProvider.QueryService 时，您会为它提供此服务。以Delphi的TEmbeddedWB控件为例，在`OnQueryService`事件中暴露：

```
function TForm1.EmbeddedWBQueryService(const rsid, iid: TGUID; out Obj: IInterface): HRESULT;
var
    sam: IInternetSecurityManager;
begin
    Result := E_NOINTERFACE;

    //rsid ==> Service Identifier
    //iid ==> Interface identifier
    if IsEqualGUID(rsid, IInternetSecurityManager) and IsEqualGUID(iid, IInternetSecurityManager) then
    begin
        sam := TEmbeddedSecurityManager.Create;
        Obj := sam;
        Result := S_OK;
    end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:49:19.487

也许您可以考虑加载不同的嵌入式浏览器。有：

*   WebKit：[http ://www.webkit.org/](http://www.webkit.org/)
*   SWT（日食）

# c++ - 连接 4 位整数

> ID：13997722
> 
> 赞同：1
> 
> 时间：2012-12-21T21:58:09.130
> 
> 标签：c++, concatenation, bit-manipulation

我正在使用`cpuid`操作码来检索处理器模型和扩展模型的值。我正在使用的文档说我必须将扩展模型的值连接到模型的值，并且我可以获得正确的模型。

```
Ex. Model:         2h
Model:             Eh
Required Output:   2Eh 
```

这是一个例子，但还有更多类似的例子。我如何将这两个数字连接在一起（它们是 4 位无符号整数）以在 C++ 中接收所需的输出？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T21:59:42.303

移位并添加：

```
exModel = 0x2;
model = 0xE;

output = (exModel << 4) + model; 
```

由于在上面的评论中提到过，你也可以使用联合，但我不推荐它——它使代码非常不可移植（我认为违反了严格的别名规则）：

```
union myUnion
{
    unsigned char output;
    struct
    {
        unsigned char model   : 4; // the order of these two fields
        unsigned char exModel : 4; // is system dependent
    };
};

union myUnion u;

u.exModel = 0x2;
u.model = 0xE;

output = u.output; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:01:07.253

转移 - 是的。

联盟 - 没有。

例子：

```
unsigned char ex_model = 0x2;
unsigned char model = 0xe;
unsigned int i = (ex_model << 4) | model; 
```

# regex - 正则表达式去除前导字符直到第一个遇到的数字

> ID：13997723
> 
> 赞同：7
> 
> 时间：2012-12-21T21:58:09.077
> 
> 标签：regex, r

我有一个名为 thisLine 的字符串，我想删除第一个整数之前的所有字符。我可以使用命令

```
regexpr("[0123456789]",thisLine)[1] 
```

确定第一个整数的位置。如何使用该索引来拆分字符串？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-22T02:13:06.640

简短的回答：

```
sub('^\\D*', '', thisLine) 
```

在哪里

*   `^`匹配字符串的开头
*   `\\D`匹配任何非数字（与 相反`\\d`）
*   `\\D*`尝试匹配尽可能多的连续非数字

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-21T22:15:51.517

My personal preference, skipping `regexp` altogether:

```
sub("^.*?(\\d)","\\1",thisLine)
#breaking down the regex
#^ beginning of line
#. any character
#* repeated any number of times (including 0)
#? minimal qualifier (match the fewest characters possible with *)
#() groups the digit
#\\d digit 
#\\1 backreference to first captured group (the digit) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-21T22:03:59.910

你想要这个`substring`功能。

或用于`gsub`一次性完成工作：

```
> gsub('^[^[:digit:]]*[[:digit:]]', '', 'abc1def')
[1] "def" 
```

您可能希望包含第一个数字，这可以通过捕获来完成：

```
> gsub('^[^[:digit:]]*([[:digit:]])', '\\1', 'abc1def')
[1] "1def" 
```

或者正如 florel 和 Alan 所指出的，只需将“所有前导数字”替换为空白即可。见弗洛德尔的回答。

# php - MySQL / WordPress 元查询；结合多个条件

> ID：13997725
> 
> 赞同：0
> 
> 时间：2012-12-21T21:58:22.643
> 
> 标签：php, mysql, database, wordpress

抱歉，如果这是相当基本的，我有点超出我的深度，可以使用一些指导来填补一些空白。

这是情况......我正在查询 WordPress 数据库以返回与一组与元键/值条件相关的特定条件匹配的帖子子集（具体来说，“日期”的键是否包含与下一个匹配的值X 天）。这工作正常 - 代码当前是：

```
$request  = "SELECT DISTINCT ID FROM $wpdb->posts, $wpdb->postmeta";
$request .= " WHERE $wpdb->posts.ID = $wpdb->postmeta.post_id";
$request .= " AND post_status='publish' AND post_type='days'";
$request .= " AND $wpdb->postmeta.meta_key = 'dates' AND $wpdb->postmeta.meta_value >= '$startDate' AND $wpdb->postmeta.meta_value <= '$endDate' AND $wpdb->postmeta.meta_value != '$today'"; 
```

现在，我想介绍另一种情况，并*返回*任何具有 *_dayType* 键和*month*值的帖子，其中*月份*是当前月份。我已经扩展了代码以允许 OR 规则也返回与当月第一天匹配的帖子。扩展代码如下所示：

```
$request  = "SELECT DISTINCT ID FROM $wpdb->posts, $wpdb->postmeta";
$request .= " WHERE $wpdb->posts.ID = $wpdb->postmeta.post_id";
$request .= " AND post_status='publish' AND post_type='days'";
$request .= " AND ";
$request .= " (($wpdb->postmeta.meta_key = 'dates' AND $wpdb->postmeta.meta_value >= '$startDate' AND $wpdb->postmeta.meta_value <= '$endDate' AND $wpdb->postmeta.meta_value != '$today')";
$request .= " OR ";
$request .= " ($wpdb->postmeta.meta_key = 'dates' AND $wpdb->postmeta.meta_value = '$firstDayOfMonth' ))"; 
```

现在我遇到了一个问题。我想通过再次查询 meta_key 变量来扩展返回新月帖子的*条件*。例如，

```
$wpdb->postmeta.meta_key = '_dayType' AND $wpdb->postmeta.meta_value = 'month' 
```

但是，添加它会返回零结果。我已经测试了只查询*一个*条件（匹配一个月的第一天，或者匹配*一个月*），我可以毫无问题地返回一个或另一个。我很确定问题是我在同一个字符串中查询同一个变量两次，没有考虑排序或区分。重建此查询以恢复的最佳方法是什么：

*   与接下来 X 天匹配的帖子或
*   “月”的帖子

这是最后的标记。问题只是我的 AND 嵌套语法吗？

```
$request  = "SELECT DISTINCT ID FROM $wpdb->posts, $wpdb->postmeta";
$request .= " WHERE $wpdb->posts.ID = $wpdb->postmeta.post_id";
$request .= " AND post_status='publish' AND post_type='days'";
$request .= " AND ";
$request .= " (($wpdb->postmeta.meta_key = 'dates' AND $wpdb->postmeta.meta_value >= '$startDate' AND $wpdb->postmeta.meta_value <= '$endDate' AND $wpdb->postmeta.meta_value != '$today')";
$request .= " OR ";
$request .= " (($wpdb->postmeta.meta_key = 'dates' AND $wpdb->postmeta.meta_value = '$firstDayOfMonth') AND ($wpdb->postmeta.meta_key = '_daytype' AND $wpdb->postmeta.meta_value = 'month')) )"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T15:55:36.017

解决; 需要通过 OR 而不是 AND 查询多个键，因为变量现在不能同时具有两个值，可以吗？

```
SELECT DISTINCT ID FROM wp_posts, wp_postmeta 
WHERE (
 wp_posts.ID = wp_postmeta.post_id
 AND post_status = 'publish'
 AND post_type = 'days'
 AND (
  wp_postmeta.meta_key = 'dates' 
  AND wp_postmeta.meta_value >= '$startDate' 
  AND wp_postmeta.meta_value <= '$endDate' 
  AND wp_postmeta.meta_value != '$today'
 )
)
UNION
SELECT DISTINCT ID FROM wp_posts, wp_postmeta 
WHERE (
 wp_posts.ID = wp_postmeta.post_id
 AND post_status = 'publish'
 AND post_type = 'days'
 AND (
 (wp_postmeta.meta_key = '_dayType' AND wp_postmeta.meta_key = 'month')
 OR
 (wp_postmeta.meta_key = 'dates' AND wp_postmeta.meta_value = '$firstDayOfMonth' )
 )
) 
```

# objective-c - 从 Web 表单下载 JSON 数据

> ID：13997726
> 
> 赞同：0
> 
> 时间：2012-12-21T21:58:27.287
> 
> 标签：objective-c, ios, json, web-applications

我正在编写一个应用程序，它要求从基于 Web 的表单中获取一些数据，然后显示返回的 JSON 数据。但我似乎无法掌握如何“填写”表格并返回数据。网站开发人员制作了一个开发表格来测试这个，所以我可以看到它是如何工作的。如果我访问该网站并在字段中输入数据并按“提交”，它会返回 JSON 格式的文本并将其显示在 Web 浏览器的窗口中。

我需要做的是让我的应用程序用数据填充这些字段并将它们提交到服务器。服务器返回 JSON 数据，我在我的应用程序中捕获和处理它。

我将不胜感激有关如何执行此操作的任何建议。您可能已经猜到了，我是 iOS 开发的新手。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:22:42.307

首先，您需要知道您将在 POST 请求中发送哪些表单数据。如果您不知道在哪里可以找到它，请看一下[这个](https://superuser.com/questions/395919/where-is-the-post-tab-in-chrome-developer-tools-network)。

考虑使用[AFNetworking](http://afnetworking.com/)发出带有 JSON 反馈的 POST 请求。[这是](https://stackoverflow.com/questions/7630289/afnetworking-post-request-with-json-feedback)一个很好的例子。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:07:25.010

Matt Long 的这个演练特别好：[http](http://www.cimgf.com/2010/02/12/accessing-the-cloud-from-cocoa-touch/) ://www.cimgf.com/2010/02/12/accessing-the-cloud-from-cocoa-touch/ 。

本质上，您只需要发布数据中的字段来匹配 html 表单中存在的字段。通过在 chrome 中发布表单并在开发人员工具的网络选项卡中查看请求，这些字段应该很明显。

# android - Android开发Usb传输

> ID：13997729
> 
> 赞同：8
> 
> 时间：2012-12-21T21:58:29.757
> 
> 标签：android, usb, transfer

我对 Android 开发相当陌生，最近一直在探索 Usb Host。

谁能告诉我如何使用批量传输，以便我可以看到外部摄像头看到的内容，而是将其显示在我的平板电脑上？

相机：佳能 Powershot A1300 平板电脑：Iconia A200

我查看了堆栈溢出和其他一些论坛，但还没有找到关于如何使用批量传输或使用哪些常量作为检索某些数据的参数的良好解释。

我能够看到端点并与外部摄像头建立连接，但我不知道从这里去哪里。

任何帮助都深表感谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-21T22:23:23.157

Android 中的 USB 主机 API 相当薄，我的意思是，一旦您超越了枚举接口/端点并创建连接，它就不会为您提供更多帮助。然后，您就处于与原始 USB 数据传输进行通信的领域，其格式取决于您的相机所代表的设备类别。您的要求有点像一罐蠕虫，所以我会尽力提供有用的资源。

不幸的是，存储和媒体设备并不是最容易解释的设备类，所以如果你只是在 USB 上沾沾自喜，可能会很困难。我能给出的最好建议是查看您的相机报告的接口类的设备类规范（大多数是大容量存储或 MTP），可以在这里找到：[http ://www.usb.org/developers /devclass_docs](http://www.usb.org/developers/devclass_docs)

规范文档将列举您需要用来与设备通信的命令。我还建议检查一下 USB In a Nutshell，它很好地指出了 USB 请求的一般构造方式，它可以帮助您将您在规范文档中看到的内容映射到以下方法中找到的参数`UsbDeviceConnection`：[http ://www.beyondlogic.org/usbnutshell/usb1.shtml](http://www.beyondlogic.org/usbnutshell/usb1.shtml)

您最初可能需要将一些控制命令发送到“端点 0”以设置相机，然后剩余的传输可能会通过批量端点进行。

在 Android 术语中，控制请求只能使用 同步发送`UsbDeviceConnection.controlTransfer()`，这意味着此方法会阻塞，直到传输完成。填写此方法的参数可在您的设备类的规范文档中找到。

`UsbDeviceConnection.bulkTransfer()`可以使用`UsbRequest`实例通过 OR 异步同步发送批量端点上的请求。您可以对`UsbRequest`传输进行排队，然后稍后返回（通过`UsbDeviceConnection.requestWait()`）查看结果。

我的 Github 页面上有一些使用主机 API 进行基本中断和控制传输以获取设备描述符等信息的示例。也许其中一些对您也有帮助：[https ://github.com/devunwired/accessory-samples](https://github.com/devunwired/accessory-samples)

* * *

关于您关于 USB 示例代码的问题：

此代码中发出的请求只是所有 USB 设备必须响应的通用“获取配置描述符”请求（它是核心命令，而不是特定于类的）。事实上，它是 Android API 获取您可以查询的接口和端点信息的请求。字段值来自核心 USB 规范（此命令在 3.0 规范中的第 9.4.3 和 9.6.3 节专门定义）：[http](http://www.usb.org/developers/docs/) ://www.usb.org/developers/docs/或您提供的更有用的描述可以从 USB in a Nutshell 中找到，其中有更多讨论：[http ://www.beyondlogic.org/usbnutshell/usb5.shtml#ConfigurationDescriptors](http://www.beyondlogic.org/usbnutshell/usb5.shtml#ConfigurationDescriptors)

长度有些随意，它告诉驱动程序要读取或写入多少字节。大多数 USB 主机驱动程序将首先查询设备描述符，其中包括一个告诉主机设备支持的最大数据包大小的字段，然后将使用该大小作为未来请求的长度。一个全功能的驱动程序可能会发出这个命令，然后首先检查长度字节（描述符的 wTotalLength 字段）以查看缓冲区是否足够大，如果没有则修改/重新发送。在示例中，为了简单起见，我只是选择了 64，因为这是协议定义为可支持的“最大”最大数据包大小。

同样，然后请求您的设备必须提供的特定数据，这些命令将在特定的类文档中找到，而不是在核心规范中。

# ruby-on-rails-3.2 - 与 PostgreSQL 9.2.1 的服务器版本和 pg_dump 版本 9.1.4 (Rails 3.2.9) 冲突

> ID：13997732
> 
> 赞同：0
> 
> 时间：2012-12-21T21:58:52.440
> 
> 标签：ruby-on-rails-3.2, rails-postgresql, pgadmin

我最近在我的 Mac Mini Server 上进行了 Lion Server 的全新安装，然后立即升级到 Mountain Lion，而无需从备份文件中复制任何数据。然后我重新安装了我的 Rails 应用程序并将它们部署到生产环境（同一台机器）。我还使用了我在 Lion Server 下创建的 PgAdmin 备份文件，并在升级到 Mountain Lion 后使用它重建了我的数据库。

当我进入 PostgreSQL 终端时，我收到以下消息。我使用它来工作的基本命令没有任何问题。

```
psql (9.1.4, server 9.2.1)
WARNING: psql version 9.1, server version 9.2.
         Some psql features might not work.
Type "help" for help. 
```

我在我的 Rails 应用程序中实现 queue_classic gem 时也遇到了问题，因为它说 psql 的服务器版本是 9.2.1，但 pg_dump 是 9.1.4 版本。

psql --version 产生 psql (PostgreSQL) 9.1.4

pg_dump --version 产生 pg_dump (PostgreSQL) 9.1.4

我在我的 Rails 应用程序中使用 gem pg 0.12.2。现在我使用的是 0.14.1 版本。这个问题是在我升级到 Mountain Lion 后仍然使用 0.12.2 版本之后开始的。当我重建我的 Rails 应用程序时，数据库是在 PgAdmin 中手动创建的。我确实 rake db:migrate 重建表结构和索引。然后我使用我的 PgAdmin tar 备份文件来重建数据。

我试图安装 phpPgAdmin 的最新稳定版本。我遇到了一个问题，因为 PostgreSQL 中缺少一列。来自 PostgreSQL 的文档指出该列已在 9.2 版中删除。此时我确定数据库是9.2.1。我当时还假设那是 Mountain Lion 安装的版本。我的假设是错误的。

然后我重新安装了 PgAdmin 进行数据库维护，以便使用我的备份恢复我的数据库。当我检查 Rails 应用程序中使用的数据库的属性时，它说它是 PostgreSQL 9.2.1 数据库。

这些是我安装的唯一与 PostgreSQL 相关的软件包。我没有在我的机器上安装另一个版本的 PostgreSQL，除非其中一个包做了一些我不知道的事情。

我不使用 Homebrew、MacPorts 或任何类似工具。我可能会在某个时候。

当我在 /usr 中对 psql 进行 Finder 搜索时，我只能在 /usr/bin 中找到一个文件。我猜那是版本 9.1.4。

我读到的所有关于这方面的研究都是关于那些自己安装了另一个版本的 PostgreSQL 的人。这听起来可能很愚蠢，但是我到底如何才能创建一个比当前安装的 PostgreSQL 版本更高的数据库呢？这显然是当我从备份重建数据库时发生的事情，即使我没有指定版本。我该如何解决这个问题？我想使用 9.2.1 版本，因为我相信这是 PostgreSQL 的最新稳定版本。我非常愿意接受建议。我只需要我的数据库以某种方式匹配我正在使用的 PostgreSQL 版本，这样我就不会在使用 gems 或其他检查 psql 和 pg_dump 版本的 PostgreSQL 进程时受到阻碍。我想我有两个选择，要么以某种方式安装 PostgreSQL 9.2.1，要么在 9.1.4 下重新创建我的数据库。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:06:54.227

发生错误是因为无法保证转储将包含新版本中给定新功能的所有内容。事实上，由于系统目录可能发生变化，我们根本无法保证它会正常工作，因此这些工具通常会生成警告，但 pg_dump 会失败。您应该能够手动转储数据。因此，像 Ruby gems 这样的其他工具在处理警告时可能会更加谨慎。

但是，如果您安装了 PostgreSQL 9.2.1，我还希望您也应该拥有所有相关的客户端工具。您可以通过简单地在系统中搜索 pg_dump 和 psql 并查看是否可以找到新版本来解决此问题（您可能同时安装了这两个版本）。但是听起来你这样做了，但请参阅[Postgresql 9.2 pg_dump version mismatch](https://stackoverflow.com/questions/12836312/postgresql-9-2-pg-dump-version-mismatch)，其中有一些特定于 mac 的答案，表明您要使用的版本不在 /usr 中。

下一步实际上是查看 PostgreSQL 是如何安装的，并寻找可能缺少这些工具的原因。

# asp.net-mvc - 如何实现在项目旁边显示图标的标记功能？

> ID：13997737
> 
> 赞同：0
> 
> 时间：2012-12-21T21:59:36.770
> 
> 标签：asp.net-mvc, razor

我想要添加标记对 Web 应用程序中问题的响应的功能？每个响应旁边都会有“标记此响应”。单击 div 时，会在响应旁边放置一个“X”图标（表示已标记），并且 div 现在显示“取消标记此响应”。要删除标志，请再次单击 div（切换效果）。

是否已经存在适用于 mvc 的小部件？我该如何开始？

# ios - UIViewController 视图的默认辅助功能标签

> ID：13997739
> 
> 赞同：2
> 
> 时间：2012-12-21T22:00:16.110
> 
> 标签：ios, label, accessibility, uiaccessibility

Apple 的 UIAccesibility 协议[参考](https://developer.apple.com/documentation/objectivec/nsobject/1615181-accessibilitylabel)指出：

> UIAccessibilityLabel
> 
> ## 讨论
> 
> 此属性的默认值为 nil ，除非接收者是 UIKit 控件，在这种情况下，该值是从控件标题派生的标签。

嗯...... UIView 和 UIViewController 都在 UIKit 框架中，但是我找不到由名为 LoginVC 的 UIViewController 控制的视图的默认可访问性标签。我试图记录它，但得到一个空白字符串。那正确吗？医生错了吗？还是我做错了什么？

我知道我可以手动设置辅助功能标签；如果可能，我想避免混乱并使用默认值 - 如果它们的名称实际上是从它们的控制器派生的，那么它们通常已经是描述性的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T03:10:53.783

默认情况下， a`UIView`和 a`UIViewController`没有为其`title`属性设置任何内容，因此默认`accessibilityLabel`属性（从`title`属性派生）正确且预期返回`nil`. 设置它们的`title`属性（在代码中或在 Interface Builder 中），您将`accessibilityLabel`在运行时登录时看到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:25:33.817

我不认为辅助功能会自动填充，如果这就是你要问的。

如果您要求设置它的方法，您应该能够以编程方式进行：

```
[myButton setAccessibilityLabel:@"Hello"]; 
```

如果您使用 Interface Builder，Identity Inspector 选项卡中有一个字段允许您进行设置。在左侧的对象下选择您的视图。然后单击身份检查器左侧的第三个选项卡。下面的例子：

![在此处输入图像描述](../Images/c9cc069a58a150ace0a16474b2ae1021.png)

# wordpress - 有没有办法用插件覆盖 WordPress 模板？

> ID：13997743
> 
> 赞同：12
> 
> 时间：2012-12-21T22:00:43.610
> 
> 标签：wordpress

我想做一个登陆页面。如果插件检测到一些 GET 或 POST 请求，它应该覆盖 wordpress 主题并显示它自己的。

它会以某种方式工作：

```
if (isset($_GET['action']) && $_GET['action'] == 'myPluginAction'){
    /* do something to maintain action */
    /* forbid template to display and show plugin's landing page*/
} 
```

我熟悉 WP Codex，但我不记得是否有任何功能可以做到这一点。当然，我用谷歌搜索了它，没有结果。

提前感谢您的任何想法。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-22T02:44:22.940

你需要钩子[`template_include`](http://core.trac.wordpress.org/browser/tags/3.5/wp-includes/template-loader.php#L46)。Codex 中似乎没有记录，但您可以在 SO 或[WordPress StackExchange中找到更多示例](https://wordpress.stackexchange.com/search?q=template_include)

## 插件文件

```
<?php
/**
 * Plugin Name: Landing Page Custom Template
 */
add_filter( 'template_include', 'so_13997743_custom_template' );

function so_13997743_custom_template( $template )
{
    if( isset( $_GET['mod']) && 'yes' == $_GET['mod'] )
        $template = plugin_dir_path( __FILE__ ) . 'my-custom-page.php';

    return $template;
} 
```

## 插件文件夹中的自定义模板

```
<?php
/**
 * Custom Plugin Template
 * File: my-custom-page.php
 *
 */

echo get_bloginfo('name'); 
```

## 结果

访问网站的任何 url**`?mod=yes`**都会呈现插件模板文件，例如：`http://example.com/hello-world/?mod=yes`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-04-28T07:36:44.143

> 您需要在插件目录中创建一个文件夹“/woocommerce/”，在 woocommerce 中，您需要为电子邮件“电子邮件”添加一个文件夹，并将所需的模板放在“/电子邮件/”中以覆盖。只需将此代码复制粘贴到插件的 main.php 中即可。

```
<?php
/**
 * Plugin Name: Custom Plugin
 */

function myplugin_plugin_path() {   
  // gets the absolute path to this plugin directory 
  return untrailingslashit( plugin_dir_path( __FILE__ ) ); 
}

add_filter( 'woocommerce_locate_template', 'myplugin_woocommerce_locate_template', 10, 3 ); 
function myplugin_woocommerce_locate_template( $template, $template_name, $template_path ) {

  global $woocommerce;  
  $_template = $template; 
  if ( ! $template_path ) $template_path = $woocommerce->template_url; 
  $plugin_path  = myplugin_plugin_path() . '/woocommerce/'; 
  // Look within passed path within the theme - this is priority 
  $template = locate_template( 
    array( 
      $template_path . $template_name, $template_name 
    ) 
  );

  // Modification: Get the template from this plugin, if it exists 
  if ( ! $template && file_exists( $plugin_path . $template_name ) ) 
    $template = $plugin_path . $template_name;  

  // Use default template 
  if ( ! $template ) 
    $template = $_template; 

  // Return what we found 
  return $template; 
 }
?> 
```

[使用插件](https://www.skyverge.com/blog/override-woocommerce-template-file-within-a-plugin/)参考模板覆盖

# vb.net - JSON 返回 null 和 order 更改

> ID：13997745
> 
> 赞同：0
> 
> 时间：2012-12-21T22:00:51.380
> 
> 标签：vb.net, json, wcf

我有一个返回名字和姓氏的 WCF。它一直运作良好。然后我修改了服务以返回更多数据。它在该字段中返回 null。此外，排序似乎搞砸了。新插入的字段插入在名字和姓氏之间。所以现在它返回：

```
 "firstname": "John",
  "fullname": null,
  "lastname": "Doe", 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:05:23.400

JSON 对象没有键的顺序，永远不要指望特定的顺序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:07:59.460

JSON 对象不实现排序，你不应该依赖它：它不是规范的一部分。

至于为什么“全名”返回为空（假设这是出乎意料的），这似乎可能取决于服务/实现的细节；您没有提供足够的信息来破译与此相关的任何内容。

# ios - 多个配置文件

> ID：13997747
> 
> 赞同：1
> 
> 时间：2012-12-21T22:00:53.153
> 
> 标签：ios, upgrade, profiles

我们有一个安装在大约 2500 台设备上的企业应用程序。我们正处于生产版本 2 升级的最后阶段。我们的企业分发证书即将到期，因此我们创建了新的分发证书和分发配置文件。到目前为止，升级应用程序会导致安装第二个配置文件。

为什么应用程序不覆盖当前配置文件而不是安装第二个配置文件？除了 uuid 之外，关于配置文件（旧的和新的）的一切都是一样的。

我们担心的是，在设备上拥有多个同名配置文件会导致问题。我们希望有人可以为我们阐明这种行为。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:14:10.277

那不是问题。设备可能多次安装了相同的（命名的）配置文件。这完全是关于必须与应用程序所针对的 ID 相匹配的 ID -> 不用担心。

# javascript - 是否可以在 JavaScript 中使用对象文字定义动态命名的属性？

> ID：13997748
> 
> 赞同：10
> 
> 时间：2012-12-21T22:00:59.493
> 
> 标签：javascript, coffeescript

考虑以下

```
var a = {foo: "bar"}; 
```

相当于

```
var a = {};
a.foo = "bar"; 
```

相当于

```
var a = {};
a['foo'] = "bar"; 
```

相当于

```
var a = {}
var b = "foo";
a[b] = "bar"; 
```

### 是否可以做类似的事情

```
var b = "foo";
var a = { [b]: "bar" }; 
```

这样的结果将是

```
// => {foo: "bar"} 
```

* * *

可接受的解决方案是 JavaScript 或 CoffeeScript

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T22:02:22.797

 ~~~~# 不。~~ 

~~没有办法使用对象文字表示法来做到这一点。~~

* * *

**更新：**根据[**ECMAScript 标准 6.0**](http://www.ecma-international.org/ecma-262/6.0/#sec-object-initializer)，您现在可以执行以下操作：

```
var b = 'foo';
var a = { [b]: 'bar' };

console.log( a.foo );  // "bar" 
```

但是，此解决方案不适用于[*不支持 ES6*](https://kangax.github.io/compat-table/es6/)的旧浏览器。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-06-11T19:04:36.103

ES6 支持计算属性。

```
// code from my original question now works in ES6 !
let b = "foo";
let a = { [b]: "bar" };

a.foo; //=> "bar" 
```

可以在 中使用任何表达式`[]`来定义属性名称

```
let a = {
  [(xs => xs.join(''))(['f','o','o'])]: 'bar'
};

a.foo; //=> "bar" 
```

如果您需要在 ES5 世界中依赖这种行为，您可以依靠功能强大的[babel.js](http://babeljs.io/)将您的 ES6 代码转换为 ES5 兼容代码。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-21T22:29:44.923

JSON 解析允许您将 JSON 字符串转换为对象：

```
JSON.parse('{"'+dynamicProperty+'":"bar"}'); 
```

这不完全是一个对象文字，但如果您的目标是输入您的属性名称作为变量，它可以工作。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-22T00:24:08.900

正如其他人所说，不，目前在 CoffeeScript 的对象文字中没有用于插入键字符串的语法；但似乎在某些时候这个功能存在！在这些 GitHub 问题中，有一些关于它的讨论：[#786](https://github.com/jashkenas/coffee-script/issues/786)和[#1731](https://github.com/jashkenas/coffee-script/issues/1731)。

它在[Coco](http://satyr.github.com/cup)和[LiveScript](http://gkz.github.com/LiveScript/)中实现为：

```
b = 'foo'
a = {"#{b}": 'baz'}

# Or..
a = {(b): 'bar'} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-09-19T04:15:36.723

从 CoffeeScript[版本 1.9.1](https://github.com/jashkenas/coffeescript/commit/76c076db555c9ac7c325c3b285cd74644a9bf0d2)开始，这有效：

```
b = "foo"
a = "#{b}": "bar" 
```

它编译为：

```
var a, b, obj;

b = "foo";

a = (
  obj = {},
  obj["" + b] = "bar",
  obj
); 
```

[试试看](http://coffeescript.org/#try:%20%20%20%20b%20%3D%20%22foo%22%0A%20%20%20%20a%20%3D%20%22%23%7Bb%7D%22%3A%20%22bar%22)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-21T22:03:10.700

JavaScript

```
var a, b;
(a = {})[b = 'foo'] = 'bar'; 
```

咖啡脚本

```
(a = {})[b = 'foo'] = 'bar' 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-12-21T22:15:47.653

要回答您的问题，这是我所知道的唯一方法。它使用`eval`. 但要小心，`eval`是邪恶的！

```
var b = "foo";
var a = eval('({ ' + b + ': ' + '"bar"' + ' })'); 
```

这是一个丑陋的解决方案。为了安全起见，你不应该依赖这个。**不要**使用它！~~

# android - 键盘键图标预览

> ID：13997750
> 
> 赞同：2
> 
> 时间：2012-12-21T22:01:16.717
> 
> 标签：android, android-softkeyboard, keypreview

我编辑了 sdk 中的自定义键盘。好吧，我已经完成了。

唯一的问题是我不想显示某些键的图标预览，例如

*   空间
*   进入
*   转移
*   alt
*   删除

现在我知道了如何禁用这些键的图标预览，但是空格键和删除键是可重复的（长按会产生计数操作），所以如果可重复属性为真，那么这些键的预览仍然会显示。

我必须关闭可重复属性，这对这两个键来说非常烦人。因为要删除长度为 5 的单词，我必须按删除按钮 5 次..

# java - 启动活动 Android 时出现致命异常

> ID：13997752
> 
> 赞同：1
> 
> 时间：2012-12-21T22:01:51.117
> 
> 标签：java, android, logcat

我创建了我的 MainActivity 应该午餐的新活动，这也是应用程序在新活动（称为 GamePlayActivity）开始时崩溃的原因。这是java代码：

```
Intent startGameDrill = new Intent(MainActivity.this, GamePlayActivity.class); 
    startActivity(startGameDrill); 
```

这是 startGameDrill：

```
package com.simplemathgame;

import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class GamePlayActivity extends MainActivity {
    int addDrills;
    int subDrils;
    int mulDrills;
    int divDrills;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_game_play);

        try {
            numberOfAddDrills = (TextView) findViewById(R.id.add_drills_number);
            numberOfSubDrills = (TextView) findViewById(R.id.sub_drills_number);
            numberOfMulDrills = (TextView) findViewById(R.id.mul_drills_number);
            numberOfDivDrills = (TextView) findViewById(R.id.div_drills_number);
            minBoundText = (TextView) findViewById(R.id.min_text);
            maxBoundText = (TextView) findViewById(R.id.max_text);
        } catch (Exception e1) {
            // TODO Auto-generated catch block
            Log.w("game","error");
        }

        try {
            addDrills = Integer.parseInt((String) numberOfAddDrills.getText());
            subDrils = Integer.parseInt((String) numberOfSubDrills.getText());
            mulDrills = Integer.parseInt((String) numberOfMulDrills.getText());
            divDrills = Integer.parseInt((String) numberOfDivDrills.getText());
        } catch (NumberFormatException e) {
            Log.w("GameDrills","string to int");
        }
        Log.w("add", "" + addDrills);
        Log.w("add", "" + subDrils);
        Log.w("add", "" + mulDrills);
        Log.w("add", "" + divDrills);
    }

} 
```

这是清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.simplemathgame"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.simplemathgame.Splash"
            android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name="com.simplemathgame.MainActivity"
            android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" >
            <intent-filter>
                <action android:name="com.simplemathgame.MainActivity" />

                <category android:name="android.intent.category.DEFAULT" />
            </intent-filter>
        </activity>

        <activity
            android:name="com.simplemathgame.GamePlayActivity"
            android:theme="@android:style/Theme.Black.NoTitleBar.Fullscreen" >
        </activity>
    </application>

</manifest> 
```

这是logCat：

```
12-21 22:05:53.949: D/dalvikvm(610): GC_EXTERNAL_ALLOC freed 42K, 53% free 2546K/5379K, external 1917K/2137K, paused 41ms
12-21 22:06:32.809: D/AndroidRuntime(610): Shutting down VM
12-21 22:06:32.809: W/dalvikvm(610): threadid=1: thread exiting with uncaught exception (group=0x40015560)
12-21 22:06:32.818: E/AndroidRuntime(610): FATAL EXCEPTION: main
12-21 22:06:32.818: E/AndroidRuntime(610): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.simplemathgame/com.simplemathgame.GamePlayActivity}: java.lang.NullPointerException
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.os.Looper.loop(Looper.java:123)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.ActivityThread.main(ActivityThread.java:3683)
12-21 22:06:32.818: E/AndroidRuntime(610):  at java.lang.reflect.Method.invokeNative(Native Method)
12-21 22:06:32.818: E/AndroidRuntime(610):  at java.lang.reflect.Method.invoke(Method.java:507)
12-21 22:06:32.818: E/AndroidRuntime(610):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-21 22:06:32.818: E/AndroidRuntime(610):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-21 22:06:32.818: E/AndroidRuntime(610):  at dalvik.system.NativeStart.main(Native Method)
12-21 22:06:32.818: E/AndroidRuntime(610): Caused by: java.lang.NullPointerException
12-21 22:06:32.818: E/AndroidRuntime(610):  at com.simplemathgame.GamePlayActivity.onCreate(GamePlayActivity.java:31)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-21 22:06:32.818: E/AndroidRuntime(610):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
12-21 22:06:32.818: E/AndroidRuntime(610):  ... 11 more 
```

这是 GamePlayActivity 的布局：

```
<?xml version="1.0" encoding="utf-8"?>
<TableLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_height="fill_parent" 
    android:layout_width="fill_parent"
    android:background="#000044">
    <TableRow 
        android:layout_marginTop="10dp"
        android:gravity="center_vertical" >
        <TextView 
            android:textColor="#FFFFFFFF"
            android:textSize="16sp"
            android:textStyle="bold"
            android:text="Addition Drills:"/>
    </TableRow>    
</TableLayout> 
```

为什么会崩溃？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:11:25.403

看看这里：

```
12-21 22:06:32.818: E/AndroidRuntime(610): Caused by: java.lang.NullPointerException
12-21 22:06:32.818: E/AndroidRuntime(610):  at com.simplemathgame.GamePlayActivity.onCreate(GamePlayActivity.java:31) 
```

第 31 行`GamePlayActivity.java`是这一行：

```
addDrills = Integer.parseInt((String) numberOfAddDrills.getText()); 
```

由于这一行中唯一引用的成员或方法是`numberOfAddDrills`，因此它必须为空。

`findViewById`考虑到您在使用;时正在检查异常。但是，如果没有找到视图，它只会返回`null`，而不是抛出异常。

看看`activity_game_play.xml`你发布的；没有。`TextView`_ `android:id="@+id/add_drills_number"`您需要创建它，并且对其他五个`TextView`s 进行相同的处理。

哦，还有一个提示：不要只用 捕获通用异常`} catch (Exception e1) {`，*尤其是*在您无意阅读日志的情况下。我无法告诉你有多少次人们因为这样做而错过了错误。

如果你想从另一个布局传递值，你有两个选择：保留对`View`对象的引用（这有点傻，不要这样做）；或将您需要的数据从他们那里传递给您的新`Activity`：

```
startGameDrill.putExtra("myIntExtra", 5); // For example 
```

然后，在 中`GamePlayActivity.onCreate()`，您可以使用[`getIntent()`](http://developer.android.com/reference/android/app/Activity.html#getIntent())的附加功能获取它：

```
Bundle extras = getIntent().getExtras();
int myIntExtra = extras.getInt("myIntExtra"); 
```

然后使用*该*值而不是依赖于先前布局中的视图。[这个答案中](https://stackoverflow.com/a/7325248/1438733)有一个更完整的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:07:23.690

跟踪堆栈跟踪，直到找到对您的类的一些引用：

表明：

```
12-21 22:06:32.818: E/AndroidRuntime(610): Caused by: java.lang.NullPointerException
12-21 22:06:32.818: E/AndroidRuntime(610):  at com.simplemathgame.GamePlayActivity.onCreate(GamePlayActivity.java:31) 
```

所以你`NullPointerException`在 GamePlayActivity.java 的第 31 行创建了一个

第 31 行：

```
addDrills = Integer.parseInt((String) numberOfAddDrills.getText()); 
```

所以也许`numberOfAddDrills`是空的？

# xcode - 使用 Xcode 查找和替换删除文本行

> ID：13997755
> 
> 赞同：9
> 
> 时间：2012-12-21T22:02:02.353
> 
> 标签：xcode

我想知道是否可以使用 Xcode 的查找和替换功能搜索文本的某一行，并完全删除该行，这样就不会留下空白。这可能吗？如果可以，怎么办？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-21T22:10:08.483

通过三次单击复制要删除的行，包括行尾的换行符（选择应该一直到编辑器窗格的最右侧）。执行查找和替换；将该行粘贴到顶部字段中，并将替换字段留空。单击全部替换。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-09-22T08:49:30.887

在最新的 Xcode 上，您可以在搜索字段中插入换行符。单击放大镜图标 -> 插入图案 -> 换行符

[![在此处输入图像描述](../Images/e2eb2149f2b6f0e43edfecfa643a522f.png)](https://i.stack.imgur.com/OZvq2.gif)

# c# - 如何将二进制表示保存到文件

> ID：13997756
> 
> 赞同：0
> 
> 时间：2012-12-21T22:02:09.400
> 
> 标签：c#, sql, pdf, binary

我有以下文本二进制表示：“0x255044462D312E340D0A25FFFFFFF ...”我知道这是一个pdf。我知道这是来自 sql server 列（图像数据类型）的文本表示。

但是我不知道如何将这个二进制文件保存到我的磁盘上的 pdf 文件并查看内容。

也许有人可以提示我正确的方向。

提前致以最诚挚的问候和感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:35:59.310

你是对的，它是一个 PDF 文件（至少它伪装成这样。你有十六进制编码的字节；第一次阅读：

```
255044462D312E340D0A

%PDF-1.4<CR><LF> 
```

所以你似乎有一个 PDF 1.4 字符串。

只需从字符串中取出两个字符，将它们视为十六进制，将它们转换为正确的字节并将它们写入文件。编写二进制，而不是文本（您不想在其中添加额外的换行符，PDF 太二进制，无法让它工作。

（我使用这个网站进行了转换：http: [//www.dolcevie.com/js/converter.html](http://www.dolcevie.com/js/converter.html)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:15:06.093

I'm not sure what database you are working with or how you are getting your string that you have above.

Many databases allow you to save binary data as a `blob` or some other byte array type. I believe in MSSQL this is called an "image" but I am not 100% on that. I would start by looking into the two following links in order. The first link talks about how to pull byte array data from a database. The example is in Visual Basic but should be easily changed to C# if that is what you are using.

The second link contains an example of how to save that byte array data to the file system.

I would also suggest posting some of the code you have tried as well so that the community may comment and point out areas you possibly had misunderstandings on.

1.) [http://support.microsoft.com/kb/308042](http://support.microsoft.com/kb/308042)
2.) [Save and load MemoryStream to/from a file](https://stackoverflow.com/questions/8624071/save-and-load-memorystream-to-from-a-file)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:19:36.787

[http://www.pdfsharp.com/PDFsharp/](http://www.pdfsharp.com/PDFsharp/)可以读取二进制数据，您可以调用 .Save() ，它将为您将 PDF 文件保存到磁盘。

# android - Android 模拟器分段错误

> ID：13997771
> 
> 赞同：27
> 
> 时间：2012-12-21T22:03:50.410
> 
> 标签：android, android-emulator, emulation, avd

从命令行运行它会导致分段错误：

```
$ emulator -avd nexus_s
Segmentation fault (core dumped) 
```

但是，按如下方式直接运行 emulator-arm 可以正常工作。

```
$ emulator-arm -avd nexus_s 
```

我怀疑它正在尝试运行 mips 或 x86 版本的模拟器。有没有办法配置模拟器启动哪个可执行文件？

这一切都是在更新到 android sdk 17 之后开始的。

添加 -verbose 标志会给出以下输出（我认为不会添加任何信息）：

```
$ emulator -verbose -avd nexus_s
emulator: found SDK root at /opt/sdk
emulator: Android virtual device file at: /home/grebulon/.android/avd/nexus_s.ini
emulator: virtual device content at /home/grebulon/.android/avd/nexus_s.avd
emulator: virtual device config file: /home/grebulon/.android/avd/nexus_s.avd/config.ini
emulator: using core hw config path: /home/grebulon/.android/avd/nexus_s.avd/hardware-qemu.ini
emulator: Found AVD target API level: 17
emulator: 'magic' skin format detected: 480x800
emulator: autoconfig: -skin 480x800
emulator: autoconfig: -skindir (null)
emulator: keyset loaded from: /home/grebulon/.android/default.keyset
emulator: found magic skin width=480 height=800 bpp=16

emulator: autoconfig: -kernel /opt/sdk/system-images/android-17/armeabi-v7a//kernel-qemu
emulator: autoconfig: -ramdisk /opt/sdk/add-ons/addon-google_apis-google-17/images/armeabi-v7a//ramdisk.img
emulator: Using initial system image: /opt/sdk/add-ons/addon-google_apis-google-17/images/armeabi-v7a//system.img
emulator: autoconfig: -data /home/grebulon/.android/avd/nexus_s.avd/userdata-qemu.img
emulator: autoconfig: -initdata /home/grebulon/.android/avd/nexus_s.avd/userdata.img
emulator: autoconfig: -cache /home/grebulon/.android/avd/nexus_s.avd/cache.img
emulator: Physical RAM size: 343MB

Content of hardware configuration file:
  hw.cpu.arch = arm
  hw.cpu.model = cortex-a8
  hw.ramSize = 343
  hw.screen = touch
  hw.mainKeys = yes
  hw.trackBall = no
  hw.keyboard = no
  hw.keyboard.lid = no
  hw.keyboard.charmap = qwerty2
  hw.dPad = no
  hw.gsmModem = yes
  hw.gps = yes
  hw.battery = no
  hw.accelerometer = yes
  hw.audioInput = yes
  hw.audioOutput = yes
  hw.sdCard = yes
  disk.cachePartition = yes
  disk.cachePartition.path = /home/grebulon/.android/avd/nexus_s.avd/cache.img
  disk.cachePartition.size = 66m
  hw.lcd.width = 480
  hw.lcd.height = 800
  hw.lcd.depth = 16
  hw.lcd.density = 240
  hw.lcd.backlight = yes
  hw.gpu.enabled = yes
  hw.camera.back = none
  hw.camera.front = none
  vm.heapSize = 32
  hw.sensors.proximity = yes
  hw.sensors.magnetic_field = yes
  hw.sensors.orientation = yes
  hw.sensors.temperature = yes
  kernel.path = /opt/sdk/system-images/android-17/armeabi-v7a//kernel-qemu
  kernel.parameters =  android.checkjni=1
  disk.ramdisk.path = /opt/sdk/add-ons/addon-google_apis-google-17/images/armeabi-v7a//ramdisk.img
  disk.systemPartition.initPath = /opt/sdk/add-ons/addon-google_apis-google-17/images/armeabi-v7a//system.img
  disk.systemPartition.size = 200m
  disk.dataPartition.path = /home/grebulon/.android/avd/nexus_s.avd/userdata-qemu.img
  disk.dataPartition.size = 209m
  avd.name = nexus_s
.
QEMU options list:
emulator: argv[00] = "/opt/sdk/tools/emulator64-arm"
emulator: argv[01] = "-android-hw"
emulator: argv[02] = "/home/grebulon/.android/avd/nexus_s.avd/hardware-qemu.ini"
Concatenated QEMU options:
 /opt/sdk/tools/emulator64-arm -android-hw /home/grebulon/.android/avd/nexus_s.avd    /hardware-qemu.ini
emulator: registered 'boot-properties' qemud service
emulator: nand_add_dev: system,size=0xc800000,initfile=/opt/sdk/add-ons/addon-google_apis-google-17/images/armeabi-v7a//system.img
emulator: mapping 'system' NAND image to /tmp/android-grebulon/emulator-RSuUtb
emulator: rounding devsize up to a full eraseunit, now c810000

emulator: nand_add_dev: userdata,size=0xd100000,file=/home/grebulon/.android/avd/nexus_s.avd/userdata-qemu.img
emulator: rounding devsize up to a full eraseunit, now d116000

emulator: registered 'boot-properties' qemud service
emulator: Adding boot property: 'dalvik.vm.heapsize' = '32m'
emulator: Adding boot property: 'qemu.sf.lcd_density' = '240'
emulator: Adding boot property: 'qemu.hw.mainkeys' = '1'
emulator: Adding boot property: 'qemu.sf.fake_camera' = 'none'
emulator: nand_add_dev: cache,size=0x4200000,file=/home/grebulon/.android/avd/nexus_s.avd/cache.img
emulator: Initializing hardware OpenGLES emulation support
Segmentation fault (core dumped) 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-29T14:17:06.560

在遵循 CommonsWare 的提示后，我终于找到了解决方案。重命名 libOpenglRender.so 使问题消失。

```
mv tools/lib/libOpenglRender.so tools/lib/libOpenglRender.so.xxx 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-11T12:37:52.393

在我的 Ubuntu 12.04 系统上，我通过确保未在 AVD 配置中打开“使用主机 GPU”来解决此问题。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-07-15T09:54:56.027

粘贴到 ~/.android/avd/.avd/config.ini

```
hw.gpu.mode = swiftshader_indirect 
```

在我的情况下，我以这种方式解决了它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-13T12:53:25.363

我在 Ubuntu 20.04 上遇到了同样的问题。重命名 libOpenglRender.so 对我有用，但模拟器需要很长时间才能初始化。此外，我不得不重新安装 Ubuntu（出于不同的原因），然后`emulator: ERROR: Could not load OpenGLES emulation library`在打开模拟器时开始出现错误。

在搜索了有关这些问题的更多信息后，我发现问题出在视频驱动程序上。我使用的是 Nouveau，在更改为 Nvidia 驱动程序后，我不再需要重新命名 libOpenglRender.so，现在模拟器初始化非常快，没有显示任何错误消息。

这是解决问题的驱动程序： [![在此处输入图像描述](../Images/ddd428a4e74143e945687a57dabdeaf7.png)](https://i.stack.imgur.com/uCnQz.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-17T20:28:47.760

我在 Debian Wheezy 上遇到了同样的问题。grebulon 的答案对我来说有点用，但是模拟器太慢了，所以我开始用正确的方式（tm）修复它。

**在这种情况下`Segmentation fault`，可能表明 OpenGL 存在问题。** （注意最后一行日志是“emulator: Initializing hardware OpenGLES emulation support”）

就我而言，通过搜索“GL”`/var/log/Xorg.0.log`显示了一些 NVidia GLX 驱动程序（来自进入数字天堂的旧显卡）。鉴于我有 AMD Radeon，我卸载了每个包含“nvidia”的软件包（列表：）`apt-get search nvidia | grep ^i`并安装：

```
# apt-get install libgl1-fglrx-glx 
```

重新启动模拟器后抱怨缺少`libOpenglRender.so`and `libGL.so`，我这样解决：

```
# echo "/opt/adt/sdk/tools/lib" > /etc/ld.so.conf.d/android_stuff.conf
# ldconfig
# cd /opt/adt/sdk/tools/lib
# ln -s /usr/lib/x86_64-linux-gnu/libGL.so.1 libGL.so 
```

请注意，我的情况可能是独一无二的（当我从 NVidia 转到 AMD 时问题就开始了），但问题的根源可能是相似的（OpenGL）。我希望它可以帮助某人。

更新：仍然不起作用，看起来我的驱动程序不支持 OpenGL 中的 16 位颜色......将进一步调查。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-01-29T17:12:10.350

如果您在这里没有找到答案，您应该订阅：

1.  [问题 34233：模拟器启动在升级到 r20 后产生分段错误](https://code.google.com/p/android/issues/detail?id=34233)
2.  [问题 55325：模拟器因段错误而崩溃](https://code.google.com/p/android/issues/detail?id=55325)
3.  [问题 20952：模拟器启动时出现段错误（与音频无关）](https://code.google.com/p/android/issues/detail?id=20952)

在那里，您将收到有关此问题的更新并找到一些解决方法（例如重命名 lib*.* 文件）。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-01-16T08:51:56.720

通过 android studio 擦除数据和冷启动设备在 ubuntu 16.04 中解决了这个问题

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-11-16T19:27:55.280

键入命令

**$模拟器臂@nexus_s**

希望这可以帮助 ：-）

# django - 以 DRY 方式在 Django 中使用模板语言

> ID：13997775
> 
> 赞同：2
> 
> 时间：2012-12-21T22:04:00.140
> 
> 标签：django, django-templates

我在以 DRY 方式使用 Django 模板语言时遇到了麻烦。

我定义了 base-section.html，它是我网站所有部分的基础。每个部分都必须覆盖此基本模板中的一些代码，以提供正确的标题、图标、描述、部分的正文等 - 始终以相同的方式。

现在，我想在每个部分中编写一些代码，但我不喜欢在每个部分中覆盖大约 10 个块的想法，因为它会一次又一次地编写相同的东西。

而指定部分的关键字是 X：

*   部分的标题也是X
*   浏览器中的网站标题也是 X
*   图标名称为 X+"_icon.png"
*   等等

我会很感激一个解决方案，我可以在每个部分只分配 1 或 2 个变量并让我的模板正常工作。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:12:46.207

很多这些数据可以简单地与视图一起传递。但是，我经常发现编写自定义模板标签可能更可取。

您可以查看 Django 文档中的自定义标签：[https ://docs.djangoproject.com/en/dev/howto/custom-template-tags/](https://docs.djangoproject.com/en/dev/howto/custom-template-tags/)

使用简单标签或包含标签，您可以很容易地重用模板代码。

# string - Powershell，计算文本文件中出现的字符串

> ID：13997777
> 
> 赞同：3
> 
> 时间：2012-12-21T22:04:16.550
> 
> 标签：string, powershell

我得到了一个具有以下布局的文本文件，

```
Lorem Ipsum Lorem Ipsum Ipsum user:john
Lorem Ipsum user:peter
Lorem Ipsum Lorem Ipsum user:george
Lorem Ipsum user:john
Lorem Ipsum  vLorem Ipsum user:george
Lorem Ipsum user:john 
```

我必须在 Powershell V2 上开发一个脚本来计算出现次数并构建一个包含以下内容的 CSV，

```
john,3
george,2
peter,1 
```

我打算循环遍历将每个用户保存在数组中的文件，然后使用 get-content 和模式来计算出现次数，例如：

```
#assumming i was able to fill the array in some way :)
$users =@('john','peter', 'george')
for each ($user in $users)
{
     $count = get-content .\myfile.txt | select-string -pattern "user:$user"
     write-host $count
}
#save the CSV 
```

这有意义吗？我对你的提示和技巧很感兴趣。了解 Powershell 的强大功能，我是一个非常好的用户，有更好的方法。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:09:58.203

使用您当前的方法，您将为每个用户从磁盘读取一次文件。扫描一次文件并一次性收集所有用户可能会更好。

听起来您没有提前获得用户列表，您基本上需要扫描字符串，`user:<username here>`并保持对您找到的不同用户名的运行记录。

这是一个应该完成基本工作的函数：

```
function GetUserCounts($fileName)
{
  $userCounts = @{}

  switch -regex -file $fileName
  {
    '\buser:([a-zA-Z]+)\b' {
       $userName = $matches[1]
       $userCounts[$userName] = [int]$userCounts[$userName] + 1
    }
  }

  $userCounts.GetEnumerator() | select Name,Value
} 
```

那然后你可以像这样创建一个CSV：

```
PS> GetUserCounts .\myfile.txt | Export-Csv .\counts.csv 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T09:14:55.107

`Group-Object`这是使用cmdlet的另一个选项：

```
Get-Content lorem.txt | 
Foreach-Object {$_ -replace '^.+user:(.+)$','$1' } | 
Group-Object -NoElement 
```

# c# - 重置会话超时而不在 ASP.Net 中进行回发

> ID：13997778
> 
> 赞同：1
> 
> 时间：2012-12-21T22:04:17.160
> 
> 标签：c#, asp.net, session, timeout, postback

有没有办法在不回发的情况下重置会话超时？

在这种情况下，我不仅想对用户隐藏回发，还需要在没有回发的情况下重置超时。

在我的页面上，我需要弹出一个对话框并通知用户他的会话超时，如果他想让它保持活动状态，他需要单击一个按钮。现在，当他单击该按钮时，我不想回发该页面，因为这会导致数据出现问题。（不涉及问题）

* * *

根据答案，我已经修改了代码，但它仍然无法正常工作。docs.google.com/open?id=0B-Pl5DH2W9MvMDV6SUNiTXR0Z2M

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:28:05.930

要刷新会话，您需要调用某些内容 - 我建议使用仅显示空 gif 的简单处理程序。这是一个简单的代码：

```
public class JustEmptyGif : IHttpHandler ,IRequiresSessionState 
{
    // 1x1 transparent GIF
    private readonly byte[] GifData = {
        0x47, 0x49, 0x46, 0x38, 0x39, 0x61,
        0x01, 0x00, 0x01, 0x00, 0x80, 0xff,
        0x00, 0xff, 0xff, 0xff, 0x00, 0x00,
        0x00, 0x2c, 0x00, 0x00, 0x00, 0x00,
        0x01, 0x00, 0x01, 0x00, 0x00, 0x02,
        0x02, 0x44, 0x01, 0x00, 0x3b
    };  

    public void ProcessRequest (HttpContext context) 
    {
        context.Response.ContentType = "image/gif";
        context.Response.Buffer = false;
        context.Response.OutputStream.Write(GifData, 0, GifData.Length);        
    }

    public bool IsReusable 
    {
        get {
            return false;
        }
    }
} 
```

这段代码只是一个处理程序，可以说`EmptyImage.ashx`并注意我已经包含了`IRequiresSessionState`使它调用和更新会话的代码。

现在唯一需要做的就是用一些脚本更新隐藏的图像，如：

```
<img id="keepAliveIMG" width="1" height="1" alt="" src="EmptyImage.ashx?" /> 
<script>
var myImg = document.getElementById("keepAliveIMG");
    myImg.src = myImg.src.replace(/\?.*$/, '?' + Math.random());
</script> 
```

我已将随机数放在最后，以避免将其保留在缓存中并强制它再次重新加载。这里没有回发，只是一个小的图像加载。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:06:39.490

我能想到的唯一方法是对这样的虚拟.net页面进行ajax调用：

```
function keepAlive()
{
var xmlHttp = null;

xmlHttp = new XMLHttpRequest();
xmlHttp.open( "GET", "KeepAlive.aspx", false );
xmlHttp.send( null );
} 
```

然后这样称呼它

```
<input type=button onClick='keepAlive();' > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-08T10:55:32.007

这里有许多有用的建议：[How To Keep ASP.NET Session Alive](http://www.beansoftware.com/ASP.NET-Tutorials/Keep-Session-Alive.aspx)。

# c++ - 未定义对 WinMain@16 的引用和未知的编译指示

> ID：13997779
> 
> 赞同：0
> 
> 时间：2012-12-21T22:04:35.927
> 
> 标签：c++, compiler-errors, codeblocks, directx-9

> **可能重复：**
> [未定义对“WinMain@16”的引用](https://stackoverflow.com/questions/5259714/undefined-reference-to-winmain16)

我正在运行最新版本的 CodeBlocks。我尝试编译在教程站点中找到的代码，但由于某种原因出现错误。我将我的项目设置为 DirectX9，并安装了 2010 年 6 月的 DirectX SDK。我还收到警告“未知的编译指示”，告诉​​我代码即使编译也无法正常运行。

```
// include the basic windows header files and the Direct3D header file
#include <windows.h>
#include <windowsx.h>
#include <d3d9.h>

// include the Direct3D Library file
#pragma comment (lib, "d3d9.lib")

// global declarations
LPDIRECT3D9 d3d;    // the pointer to our Direct3D interface
LPDIRECT3DDEVICE9 d3ddev;    // the pointer to the device class

// function prototypes
void initD3D(HWND hWnd);    // sets up and initializes Direct3D
void render_frame(void);    // renders a single frame
void cleanD3D(void);    // closes Direct3D and releases memory

// the WindowProc function prototype
LRESULT CALLBACK WindowProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam);

// this function initializes and prepares Direct3D for use
void initD3D(HWND hWnd)
{
    d3d = Direct3DCreate9(D3D_SDK_VERSION);    // create the Direct3D interface

    D3DPRESENT_PARAMETERS d3dpp;    // create a struct to hold various device information

    ZeroMemory(&d3dpp, sizeof(d3dpp));    // clear out the struct for use
    d3dpp.Windowed = TRUE;    // program windowed, not fullscreen
    d3dpp.SwapEffect = D3DSWAPEFFECT_DISCARD;    // discard old frames
    d3dpp.hDeviceWindow = hWnd;    // set the window to be used by Direct3D

    // create a device class using this information and information from the d3dpp stuct
    d3d->CreateDevice(D3DADAPTER_DEFAULT,
                      D3DDEVTYPE_HAL,
                      hWnd,
                      D3DCREATE_SOFTWARE_VERTEXPROCESSING,
                      &d3dpp,
                      &d3ddev);
}

// this is the function used to render a single frame
void render_frame(void)
{
    // clear the window to a deep blue
    d3ddev->Clear(0, NULL, D3DCLEAR_TARGET, D3DCOLOR_XRGB(0, 40, 100), 1.0f, 0);

    d3ddev->BeginScene();    // begins the 3D scene

    // do 3D rendering on the back buffer here

    d3ddev->EndScene();    // ends the 3D scene

    d3ddev->Present(NULL, NULL, NULL, NULL);    // displays the created frame
}

// this is the function that cleans up Direct3D and COM
void cleanD3D(void)
{
    d3ddev->Release();    // close and release the 3D device
    d3d->Release();    // close and release Direct3D
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:06:09.013

您可能正在使用 C++ 编译器编译 C 程序。如果是这种情况，您需要将导出的函数声明为 extern "C"。例如：

```
extern "C" int CALLBACK WinMain(...); 
```

# scala - 类型不匹配错误：找到 SortedSet[Int]，需要 Set[Int]

> ID：13997782
> 
> 赞同：1
> 
> 时间：2012-12-21T22:04:50.063
> 
> 标签：scala

假设我有以下代码：

```
case class Foo(x: SortedSet[String]) {
  def bar: Set[String] = x
} 
```

（这是我实际代码的简化。）如果我尝试运行它，我会收到以下错误：

```
error: type mismatch;
found   : scala.collection.SortedSet[String]
required: Set[String]
   def bar: Set[String] = x 
```

为什么我会收到此错误？不是`SortedSet[String]`一个子特征`Set[String]`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T22:11:41.210

Set 是不可变的。

```
scala>  import scala.collection.immutable.SortedSet
import scala.collection.immutable.SortedSet

scala> :paste
// Entering paste mode (ctrl-D to finish)

case class Foo(x: SortedSet[String]) {
  def bar: Set[String] = x
}

// Exiting paste mode, now interpreting.

defined class Foo 
```

# elasticsearch - ElasticSearch 路由字段

> ID：13997783
> 
> 赞同：2
> 
> 时间：2012-12-21T22:04:59.213
> 
> 标签：elasticsearch

在 ElasticSearch 中选择用于路由的字段是否有任何指南？以前我们已经成功地使用了`user_id`大约 750K 文档的索引（我们有大约 10K 用户）。

对于第二个索引，我没有使用该`user_id`字段，而是使用了一个更大的不同 ID (750K)。性能似乎低于标准，但如果路由字段是原因（它是必需的），则很难确定，因为存储了 3000 万个文档。

（我承认我认为查询分析器的工作方式与传统的基于 SQL 的分析器类似，但事实可能并非如此。）

# javascript - 生成随机数，在2个数字之间？

> ID：13997793
> 
> 赞同：3
> 
> 时间：2012-12-21T22:06:33.427
> 
> 标签：javascript, random

> **可能重复：**
> [在特定范围内的 Javascript 中生成随机数？](https://stackoverflow.com/questions/1527803/generating-random-numbers-in-javascript-in-a-specific-range)

假设我想生成一个从 50 到 100 的随机数。

我知道有：

```
Math.random() 
```

但我只能找到从 1 到“x”的方法

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T22:07:59.010

从[MDN 上`Math.random()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Math/random)：

```
// Returns a random integer between min and max
// Using Math.round() will give you a non-uniform distribution!
function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T22:18:24.507

I believe this would also work:

```
function randomInt(min,range) {
return Math.floor((Math.random()*(range+1))+min)
} 
```

In your case min would be 50 and range would be 50

# java - HBase 扫描过滤器的 Java 正则表达式不起作用

> ID：13997794
> 
> 赞同：1
> 
> 时间：2012-12-21T22:06:35.133
> 
> 标签：java, regex, hbase

问题：对于 HBase 扫描过滤器，正则表达式未按预期工作。尽管此 RegEx 通过且没有任何错误，但它不会仅返回过滤后的行。

背景：我们将数据作为字符串存储在 HBase 中（我知道它应该在 Avro 中，但现在需要使用它。）

我们的 HBase 列 DataRows 如下所示，管道用作分隔符。

姓名| 10000081 | 10000102 | 13513 | 10102026 |性别| ID名称| 10000081 | 1000013 | 13513 | 10102026 | 10102026 | ID名称| 10000081 | 1000013 | 13513 | 10102026 | ID名称| 10000082 | 10000104 | 13515 | 10102026 |性别|ID 名称|10000082|10000104|13516|10102026|性别|ID

我正在为 HBase 扫描器编写一个 RegEx 过滤器，它将扫描这些行。

我的 RegEx 字符串如下所示：

```
^NAME\\|.*\\|.*\\|.*\\|.*\\|.*\\|.*$ 
```

这是 HBase QualifierFilter 的输入，例如

```
Filter qfilter = new QualifierFilter(CompareFilter.CompareOp.EQUAL,new RegexStringComparator(regexString.toString())); 
```

在上面的正则表达式字符串示例中（我只想过滤 Name=RECKO 和 3rd col = 10000101）。它返回所有行。

正则表达式字符串 = `^NAME\\|.*\\|10000101\\|.*\\|.*\\|.*\\|.*$`

我的正则表达式有什么问题？非常感谢任何指针/建议。

测试程序：

```
 public class RegEx1 {
      public static void main(String[] args) {
        String Str[] = {
        "PC|10000081|10000102|13513|10102026|LOC|ic",
        "PC|10000081|10000101|13512|10102025|LOC|zc",
    "NAME|10000042|10000084|13576|10101626|GENDER|cc",
    "NAME|10000042|10000084|13576|10101626|GENDER|za",
    "NAME|10000042|10000084|13576|10101626|GENDER|zc",
    "NAME|10000061|10000086|13581|10101630|GENDER|ic",
    "NAME|10000061|10000086|13581|10101630|GENDER|za",
    "NAME|10000061|10000086|13581|10101630|GENDER|zc",
    "NAME|10001076|10001744|15106|10123669|GENDER|cc",
    "NAME|10001076|10001744|15106|10123669|GENDER|za",
    "NAME|10001076|10001744|15106|10123669|GENDER|zc",
    "NAME|10000061|10000086|13581|10101630|GENDER|ic",
    "NAME|10000061|10000086|13581|10101630|GENDER|za",
    "NAME|10000061|10000086|13581|10101630|GENDER|zc",
    "NAME|10001075|10001743|15105|10123664|GENDER|ic",
    "NAME|10001075|10001743|15105|10123664|GENDER|za",
    "NAME|10001075|10001743|15105|10123664|GENDER|zc",
    "NAME|10001077|10001745|15239|10123673|GENDER|cc",
    "NAME|10001077|10001745|15239|10123673|GENDER|za",
    "NAME|10001077|10001745|15239|10123673|GENDER|zc",
    "NAME|10002165|10000102|10151364|10151363|GENDER|ic",
    "NAME|10002165|10003668|10151364|10151363|GENDER|za",
    "NAME|10002165|10003668|10151364|10151363|GENDER|zc",
    "NAME|10002167|10003670|10151368|10151367|GENDER|cc",
"NAME|10002167|10003670|10151368|10151367|GENDER|zb"    };

    for (String s : Str){
        System.out.println(s);
        System.out.println(s.matches("^NAME\\|10002167\\|.*\\|.*\\|.*\\|*$"));
    }

   }
 } 
```

对于上述程序，我将所有输入值作为匹配项，实际上它应该只匹配第一列 =“NAME”且第二列是 10002167 的字符串。

**更新：感谢@Aviram Segal。更正正则表达式后，它在 Java 测试程序中有效，但在 HBase 扫描过滤器中无效。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:29:05.187

您忘记转义一个`|`字符，因此将其视为`OR`，也可以使用`[|]`代替`\\|`，我个人更喜欢这种风格。

你的：`^NAME\\|.*\\|10000101|.*\\|.*\\|.*\\|.*$`

固定的：`^NAME\\|.*\\|10000101\\|.*\\|.*\\|.*\\|.*$`

* * *

你的：`System.out.println(s.matches("^NAME\\|10002167|.*\\|.*\\|.*\\|*$"));`

固定的：`System.out.println(s.matches("^NAME\\|10002167\\|.*\\|.*\\|.*\\|*$"));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:19:08.733

`.`代表任何字符因此问题。尝试使用`\w`for word 字符代替`.`.

# objective-c - 无法使用 dateFromString 转换原始日期

> ID：13997798
> 
> 赞同：0
> 
> 时间：2012-12-21T22:06:56.920
> 
> 标签：objective-c, date, nsstring, converter, nsdateformatter

我正在尝试使用以下代码转换时间字符串

```
NSString *origDate = @"2012-12-06T09:27:18+08:00";
NSDateFormatter *df = [[NSDateFormatter alloc] init];
[df setFormatterBehavior:NSDateFormatterBehavior10_4];
[df setDateFormat:@"yyyy-mm-dd HH:mm:ss VVVV"];
NSDate *convertedDate = [df dateFromString:origDate]; 
```

但是，当我打印 convertDate 时，它​​返回 null。我的猜测是你使用的日期格式不匹配。如何修改代码以使其正常工作？我可以使用什么格式来匹配我的字符串？

编辑（参考苹果的文档后）

我检查了苹果页面上的日期格式文档，发现了以下代码

```
NSDateFormatter *rfc3339DateFormatter = [[NSDateFormatter alloc] init];
NSLocale *enUSPOSIXLocale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];

[rfc3339DateFormatter setLocale:enUSPOSIXLocale];
[rfc3339DateFormatter setDateFormat:@"yyyy'-'MM'-'dd'T'HH':'mm':'ss'Z'"];
[rfc3339DateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0]];

// Convert the RFC 3339 date time string to an NSDate.
NSDate *date = [rfc3339DateFormatter dateFromString:rfc3339DateTimeString]; 
```

上面的格式似乎与我在原始日期字符串“2012-12-06T09:27:18+08:00”中的格式相匹配。但是我仍然得到一个空值。我越来越近了吗？我还能如何更新这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:45:11.160

根据您的原始输入，提供给您的日期格式化程序的此格式字符串应该可以完成工作：

```
@"yyyy'-'MM'-'dd'T'HH':'mm':'ssZZZZZ" 
```

注意：我在 Mac OS X 10.8.2 下对此进行了测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-11T21:40:46.290

格式字符串将在 iOS6（不是 iOS5 -> nil）上解析，但它对输出没有用，因为解析的日期会丢失它的时区信息。iOS6 中的输出将类似于“2012-12-06T17:27:18Z”，这可能取决于时区是否设置为 GMT。

我的代码：

 `````
 static NSDateFormatter    *gXmlDateFormatter = nil;
// lazy init
+ (NSDateFormatter *)xmlDateFormatter
{
    // e.g. updateDateTime="2012-09-18T11:06:19+00:00"
    if (gXmlDateFormatter == nil) {
        // prepare for parsinf Arinc-ISO-XML-dates input
        gXmlDateFormatter = [[NSDateFormatter alloc] init];
        gXmlDateFormatter = [NSTimeZone timeZoneForSecondsFromGMT:0];
        gXmlDateFormatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];

        gXmlDateFormatter.dateFormat = @"yyyy'-'MM'-'dd'T'HH':'mm':'ssZZZZZ";    // only parsing! in iOS 6 (iOS5 will parse nil)
//        gXmlDateFormatter.dateFormat = @"yyyy'-'MM'-'dd'T'HH':'mm':'ssZ";        // all iOS but with NO colons in timeZone (add/remove)
    }
    NSLog(@"gXmlDateFormatter:%@",gXmlDateFormatter);
    return gXmlDateFormatter;
}
// there's a problem with the above dateformater and iOS5 creating nil-results
+ (NSDate *)dateFromXMLString:(NSString *)arincDateString
{
    NSString *dateString = arincDateString;

    // xmlDateStrings may contain a ':' in the timezone part. iOS and Unicode DO NOT
    // so always remove the xml-standard colon ':' from the timezone to make it iOS/Unicode compatible
    // xml: http://www.w3schools.com/schema/schema_dtypes_date.asp
    // iOS: http://unicode.org/reports/tr35/tr35-6.html#Date_Format_Patterns)
    NSRange zRange = NSMakeRange(arincDateString.length-3, 1);
    dateString = [arincDateString stringByReplacingOccurrencesOfString:@":" withString:@"" options:0 range:zRange];

    NSDate *date = [self.arincDateFormatter dateFromString:dateString];

    if(!date)NSLog(@"PARSING arincDateString:'%@' -> (NSDate*)%@ ",arincDateString,date);

    return date;
}
+ (NSString *)xmlStringFromDate:(NSDate *)date
{
    if( !date ) return nil;        // exit on nil date

    @autoreleasepool {
        NSString *dateString = [self.arincDateFormatter stringFromDate:date];

        // iOS5 does not use a ':' in the timeZone part but xml needs it
        // so allways add the xml-standard colon ':' into the timezone
        NSMutableString *string = [NSMutableString stringWithString:dateString];
        if( 22 < string.length ) {        // prevent crashing
            [string insertString:@":" atIndex:22];
        } else {
            NSLog(@"date output string too short:%d<22",string.length);
        }
        dateString = string;

        if(!dateString)
            NSLog(@"OUTPUT '%@' -> (NSString*)%@",date,dateString);
        return dateString;
    }
} 
`````

# .net - WPF 后台 Worker 和 ProgressBar

> ID：13997801
> 
> 赞同：3
> 
> 时间：2012-12-21T22:07:22.060
> 
> 标签：.net, wpf, backgroundworker

所以，我有一个 wpf 表单，它发送到一个站点，解析 html，并返回一个强类型的“href”值列表。（是的，这是我自己的网站）

我正在利用后台工作人员来释放 UI 的挂断，并呈现正在运行的进度条。

虽然它只适用于网站的第一页，但如果我决定递归网站，进度条会挂起，而递归正在发生，然后一旦递归完成，进度条就会恢复活力。

你能告诉我我在这里做错了什么吗？并且可能指导我正确使用带有进度条的后台工作人员......基本上，进度条应该在执行任务时运行，但我根据代码假设情况并非如此。

这是正在执行此操作的窗口的代码隐藏：

```
Imports System.Threading.Tasks
Imports System.Threading

Class MainWindow

Private _previousCursor As Cursor = Mouse.OverrideCursor
Private _Spider As New Spider.SpiderIt
Private _Worker As New ComponentModel.BackgroundWorker
Private _RunCount As Integer = 0

Private Sub MainWindow_Loaded(sender As Object, e As System.Windows.RoutedEventArgs) Handles Me.Loaded
    Me.workProgress.Visibility = Windows.Visibility.Hidden
    _Worker.WorkerReportsProgress = True
    _Worker.WorkerSupportsCancellation = True
    AddHandler _Worker.DoWork, New System.ComponentModel.DoWorkEventHandler(AddressOf Spider)
    AddHandler _Worker.ProgressChanged, New System.ComponentModel.ProgressChangedEventHandler(AddressOf worker_ProgressChanged)
    AddHandler _Worker.RunWorkerCompleted, New System.ComponentModel.RunWorkerCompletedEventHandler(AddressOf worker_RunWorkerCompleted)
    Me.SiteParse.Focus()
End Sub

Private Sub SiteParseKeyDown(sender As System.Object, e As System.Windows.Input.KeyEventArgs)
    If (e.Key = Key.Return) Then
        Me.btnParseAll.IsEnabled = False
        Me.btnParseSelected.IsEnabled = False
        Me.SiteParse.IsEnabled = False
        Mouse.OverrideCursor = Cursors.Wait
        Me.workProgress.Visibility = Windows.Visibility.Visible
        _Worker.RunWorkerAsync(New Typing() With {.Url = SiteParse.Text, .Recurse = Recurse.IsChecked})
    End If
End Sub

Private Sub btnParseAll_Click(sender As Object, e As System.Windows.RoutedEventArgs) Handles btnParseAll.Click
    Me.btnParseAll.IsEnabled = False
    Me.btnParseSelected.IsEnabled = False
    Me.SiteParse.IsEnabled = False
    Dim _TL As New List(Of DGTyping)
    Using New WaitCursor
        For Each Item In DG_SiteLinks.Items
            _TL.Add(New DGTyping() With {
                    .SiteUrl = Item.SiteUrl,
                    .SiteTitle = Item.SiteTitle
                })
        Next
    End Using
    Dim _T As New ParseLinks(Me, _TL)
    _T.ShowDialog()
End Sub

Private Sub btnParseSelected_Click(sender As Object, e As System.Windows.RoutedEventArgs) Handles btnParseSelected.Click
    Me.btnParseAll.IsEnabled = False
    Me.btnParseSelected.IsEnabled = False
    Me.SiteParse.IsEnabled = False
    Dim _TL As New List(Of DGTyping)
    Using New WaitCursor
        For Each Item In DG_SiteLinks.SelectedItems
            _TL.Add(New DGTyping() With {
                    .SiteUrl = Item.SiteUrl,
                    .SiteTitle = Item.SiteTitle
                })
        Next
    End Using
    Dim _T As New ParseLinks(Me, _TL)
    _T.ShowDialog()
End Sub

#Region "Get Site Links"

Private Sub Spider(sender As Object, e As System.ComponentModel.DoWorkEventArgs)
    'Do the work here, but need to get the value of SiteParse first
    With _Spider
        .UrlToParse = DirectCast(e.Argument.Url, String)
        .ShouldRecurse = DirectCast(e.Argument.Recurse, Boolean)
        .RecurseLevels = 20
        .SpiderIt(_Worker)
    End With
End Sub

Private Sub worker_ProgressChanged(sender As Object, e As System.ComponentModel.ProgressChangedEventArgs)
    workProgress.Value = e.ProgressPercentage
End Sub

Private Sub worker_RunWorkerCompleted(sender As Object, e As System.ComponentModel.RunWorkerCompletedEventArgs)
    EndRest()
    Dim _IL As List(Of Spider.Typing.InternalLinks)
    _IL = _Spider.InternalLinks()
    Dim _TL As New List(Of DGTyping)
    For Each item In _IL
        _TL.Add(New DGTyping() With {
                .SiteUrl = item.Url,
                .SiteTitle = If(item.Title.Length > 0, item.Title, item.Content)
            })
    Next
    _IL.Clear()
    Me.DG_SiteLinks.ItemsSource = _TL
    EndSync()
End Sub

Private Sub BrowseSite(sender As Object, e As RoutedEventArgs)
    Dim _URL As String = DirectCast(sender, TextBlock).Text
    Dim _T As New Browser(_URL)
    _T.ShowDialog()
End Sub

Private Sub Window_Closing(sender As Object, e As System.ComponentModel.CancelEventArgs)
    If _Worker IsNot Nothing Then
        If _Worker.IsBusy Then
            _Worker.CancelAsync()
        End If
    End If
End Sub

Private Sub EndSync()
    _Worker.CancelAsync()
    _Worker.Dispose()
    _Spider.Dispose()
End Sub

Private Sub EndRest()
    workProgress.Value = 0
    workProgress.Visibility = Windows.Visibility.Hidden
    Me.btnParseAll.IsEnabled = True
    Me.btnParseSelected.IsEnabled = True
    Me.SiteParse.IsEnabled = True
    Mouse.OverrideCursor = _previousCursor
End Sub

Partial Public Class Typing
    Public Property Url As String
    Public Property Recurse As Boolean
End Class

Partial Public Class DGTyping
    Public Property SiteUrl As String
    Public Property SiteTitle As String
End Class

#End Region

End Class 
```

.SpiderIt() 输出指定的站点，将 html 作为 HDocument (SuperstarCoders LinqToHtml) 抓取，解析它以获取内部链接，并将它们放入强类型列表中。这是在一个单独的类程序集中完成的，并且执行得很好。

SpiderIt 方法和包含类：

```
Imports Superstar.Html.Linq
Imports System.Threading.Tasks

Public Class SpiderIt
Implements IDisposable

#Region "Public Properties"

''' <summary>
''' Specify the initial URL to parse
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public Property UrlToParse As String

''' <summary>
''' Should this recurse the internal links of the site
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public Property ShouldRecurse As Boolean = False

''' <summary>
''' Specify the number of levels to recurse
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public Property RecurseLevels As Long = 0

''' <summary>
''' Returns a message from the SpiderIt method
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public ReadOnly Property Message() As String
    Get
        Return _Msg
    End Get
End Property

''' <summary>
''' Returns a strongly typed list of internal links
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public ReadOnly Property InternalLinks() As List(Of Typing.InternalLinks)
    Get
        Return _InternalLinkList
    End Get
End Property

''' <summary>
''' Returns a strongly typed list of external links
''' </summary>
''' <value></value>
''' <returns></returns>
''' <remarks></remarks>
Public ReadOnly Property ExternalLinks() As List(Of Typing.ExternalLinks)
    Get
        Return _ExternalLinkList
    End Get
End Property

#End Region

#Region "Internal Properties"

Private disposedValue As Boolean
Private _Msg As String
Private _Ctr As Long = 0
Private _InternalLinkList As New List(Of Typing.InternalLinks)
Private _ExternalLinkList As New List(Of Typing.ExternalLinks)
Private _DLer As New Downloader
Private _RCt As Long = 0

#End Region

#Region "Public Methods"

''' <summary>
''' Parse with the specified values
''' </summary>
''' <returns>Boolean</returns>
''' <remarks>Returns true or false, based on if it has completed, as well as a message
''' Spits out 2 strongly typed lists.  Both internal and external URLs
''' </remarks>
Public Function SpiderIt(ByVal _Worker) As Boolean
    For i As Integer = 1 To 99
        _Worker.ReportProgress(i)
        System.Threading.Thread.Sleep(50)
    Next
    _Worker.ReportProgress(100)
    Dim _Doc As HDocument = _DLer.DownloadHDoc(UrlToParse)
    With _Doc
        If _Doc Is Nothing Then
            _Msg = "There is no document to parse."
            Return False
        Else
            Try
                Dim _AL = .Descendants("a")
                'Parse the internal links
                ParseLinks(_AL)
                _Msg = "Internal Link List Built"
                Return True
            Catch ex As Exception
                _Msg = ex.Message
                Return False
            End Try
        End If
    End With
End Function

#End Region

#Region "Internal Methods"

#Region "Spider Helpers"

Private Sub ParseLinks(ByVal _AL As IEnumerable(Of HElement))
    Try
        Dim _Link As String, _D As HDocument
        For i As Long = 0 To _AL.Count - 1
            If _AL(i).Attribute("href") IsNot Nothing AndAlso Not (_AL(i).Attribute("href").Value.Contains("//") OrElse
                    _AL(i).Attribute("href").Value.Contains("http://") OrElse
                    _AL(i).Attribute("href").Value.Contains("https://") OrElse
                    _AL(i).Attribute("href").Value.Contains("ftp://") OrElse
                    _AL(i).Attribute("href").Value.Contains("mailto:") OrElse
                    _AL(i).Attribute("href").Value.Contains("#")) Then
                _Link = UrlToParse & "/" & _AL(i).Attribute("href").Value
                If Not (_InternalLinkList.Any(Function(x) x.Url = _Link.Replace("//", "/").Replace("http:/", "http://").Replace("https:/", "https://"))) Then
                    AddInternalLinks(_Link.Replace("//", "/").Replace("http:/", "http://").Replace("https:/", "https://"),
                                     If(_AL(i).Attribute("target") Is Nothing,
                                         String.Empty,
                                         _AL(i).Attribute("target").Value),
                                     _AL(i).Value,
                                     If(_AL(i).Attribute("title") Is Nothing,
                                         String.Empty,
                                         _AL(i).Attribute("title").Value))
                    If ShouldRecurse Then
                        _RCt += 1
                        If _RCt <= RecurseLevels Then
                            _D = _DLer.DownloadHDoc(_Link)
                            ParseLinks(_D.Descendants("a"))
                        End If
                    End If
                End If
            Else
                _Link = _AL(i).Attribute("href").Value
                If Not (_ExternalLinkList.Any(Function(x) x.Url = _Link)) Then
                    AddExternalLinks(_Link,
                                     If(_AL(i).Attribute("target") Is Nothing,
                                         String.Empty,
                                         _AL(i).Attribute("target").Value),
                                     _AL(i).Value,
                                     If(_AL(i).Attribute("title") Is Nothing,
                                         String.Empty,
                                         _AL(i).Attribute("title").Value))
                End If
            End If
        Next
    Catch ex As Exception
        _Msg += ex.StackTrace
    End Try
End Sub

Private Sub AddExternalLinks(ByVal _Link As String, ByVal _Target As String, ByVal _Content As String, ByVal _Title As String)
    Try
        _ExternalLinkList.Add(New Typing.ExternalLinks With {
                            .Url = _Link,
                            .Content = _Content,
                            .Target = _Target,
                            .Title = _Title
                        })
    Catch ex As Exception
        _Msg += ex.StackTrace
    End Try
End Sub

Private Sub AddInternalLinks(ByVal _Link As String, ByVal _Target As String, ByVal _Content As String, ByVal _Title As String)
    Try
        _InternalLinkList.Add(New Typing.InternalLinks With {
                            .Url = _Link,
                            .Content = _Content,
                            .Target = _Target,
                            .Title = _Title
                        })
    Catch ex As Exception
        _Msg += ex.StackTrace
    End Try
End Sub

#End Region

#Region "IDisposable Support"

Protected Overridable Sub Dispose(disposing As Boolean)
    If Not Me.disposedValue Then
        If disposing Then
        End If
        _Msg = String.Empty
        _InternalLinkList.Clear()
        _ExternalLinkList.Clear()
        _DLer.Dispose()
    End If
    Me.disposedValue = True
End Sub

Public Sub Dispose() Implements IDisposable.Dispose
    Dispose(True)
    GC.SuppressFinalize(Me)
End Sub

#End Region

#End Region

End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T04:47:58.710

我将其发布为答案，因为作为评论文本太长了。

也许我遗漏了一些东西（以这种格式阅读代码很痛苦）。

您从 1 数到 99，并每 50 毫秒报告一次进度。在两者之间似乎什么都没有发生，我的意思是工作量会增加一些真正的延迟。然后你报告 100%，然后它似乎实际上是在加载文档和解析，我猜这需要一段时间。

您不应该在 ParseLinks() 方法中的某处抛出 ReportProgress() 吗？当然，您必须能够计算要解析的节点数，以便您可以在工作完成后以与 100% 进度一致的速度报告进度。

编写另一个递归方法，它只提前计算节点的数量（应该很快），然后用这个数字武装你将知道传递给 ReportProgress() 的值（你应该再次在 ParseLinks() 中调用）所以你'将有一个稳定的进展，达到 100%。（显然，您必须将对 BackgroundWorker 的引用传递给 ParseLinks() ）

这可能很困难，但没有人说这会很容易：D。

干杯。

# ruby-on-rails - 在延迟的工作中运行叉子

> ID：13997807
> 
> 赞同：1
> 
> 时间：2012-12-21T22:07:28.960
> 
> 标签：ruby-on-rails, rake, fork, delayed-job

我们在 Web 应用程序中使用延迟作业，我们需要多个延迟作业工人并行发生，但我们不知道需要多少。

我目前尝试的解决方案是运行一名工作人员并在所需任务中调用 fork/Process.detach。

我之前试图直接在 Rails 应用程序中运行 fork，但它对乘客的效果不太好。

这个解决方案似乎运作良好。生产中是否有任何警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T21:44:40.613

今天发生在我身上的一个问题，任何试图解决这个问题的人都应该注意以下问题：

我注意到工人倒下了，所以我开始了它。我没想到的是有 70 个工作在排队等候。并且由于进程是分叉的，因此它们几乎立即启动所有进程并吃掉进程中的所有内存，从而杀死了我们的服务器大约半小时。 :]

所以确保有上帝在看守工人是很重要的。

工人似乎也经常死去，但还不确定它是否与分叉有关。

# html - div 文本垂直对齐

> ID：13997812
> 
> 赞同：1
> 
> 时间：2012-12-21T22:07:49.517
> 
> 标签：html, css

我有 2 个 div：一个父母和一个孩子。用户可以通过单击按钮添加此 div 并设置文本值。我想在边框内联块中显示这些潜水（1 行中的 3 个项目，如 chrome 中的新标签）。我想在边框的中心显示这个文本。有css代码：

```
.parentDiv {
    width: 300px;
    height: 200px;
    margin: 5px;
    border: solid 1px black;
    display: inline-block;
    font-size: 24px;
}
.childDiv {
    text-align: center;
    vertical-align:middle;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:24:26.510

这是一个向您展示解决方案的 jsfiddle：http: [//jsfiddle.net/nfLu3/](http://jsfiddle.net/nfLu3/)

```
.parentDiv {
    ...
    line-height:200px;
    text-align:center;
}

.childDiv {
    display:inline-block;
    line-height:1;
}​ 
```

关键是：

*   将`line-height`父容器的 设置为其高度 ( `200px`)`text-align`和`center`。所以一些文本正好出现在你的盒子的中间。
*   将子容器设置`display`为`inline-block`. 通过这种方式，它面向周围的文本（这很重要！）。周围的文本（我的意思是子容器之前的换行符和空格）有一个`line-height`of`200px`并且子块有`vertical-align:middle`，所以它将居中。

你去吧

# python - Tkinter 和 pyplot 内存不足

> ID：13997820
> 
> 赞同：0
> 
> 时间：2012-12-21T22:08:46.833
> 
> 标签：python, memory, matplotlib, tkinter

我正在运行一个 Tkinter 脚本，它每 5 秒更新一次绘图。它调用每 5 秒绘制一次的函数。在没有那么长时间 python 开始使用大量内存之后，我检查了任务管理器。内存使用量一直在快速增长。它每 24 小时启动一个新文件，因此文件中的行数有限制。该文件开始为空。

我尝试增加 5s 的时间跨度，但它做同样的事情。也许慢一点，也尝试过每 3 行左右绘制一次，但同样的事情又发生了。

知道是什么导致了如此高的内存使用率以及如何解决吗？

谢谢！

```
data = np.genfromtxt(filename)

time_data = data[:,0]
room_temp_data_celsius = data[:,1]
rad_temp_data_celsius = data[:,2]
fan_state_data = data[:,3]
threshold_data = data[:,4]
hysteresis_data = data[:,5]

threshold_up = [] #empty array
threshold_down = []#empty array

for i in range(0,len(threshold_data)):
    threshold_up.append(threshold_data[i]+hysteresis_data[i])
    threshold_down.append(threshold_data[i]-hysteresis_data[i])

# Time formatting
dts = map(datetime.datetime.fromtimestamp, time_data)

fds = matplotlib.dates.date2num(dts)

hfmt = matplotlib.dates.DateFormatter('%H:%M')

# Temperature conversion
room_temp_data_fahrenheit = map(celsius_to_fahrenheit, room_temp_data_celsius)
rad_temp_data_fahrenheit = map(celsius_to_fahrenheit, rad_temp_data_celsius)
threshold_data_fahrenheit = map(celsius_to_fahrenheit, threshold_data)
threshold_up_fahrenheit = map(celsius_to_fahrenheit, threshold_up)
threshold_down_fahrenheit = map(celsius_to_fahrenheit, threshold_down)

f = plt.figure()
a = f.add_subplot(111)

a.plot(fds,room_temp_data_fahrenheit, fds, rad_temp_data_fahrenheit, 'r')
a.plot(fds,fan_state_data*(max(rad_temp_data_fahrenheit)+4),'g_')
a.plot(fds, threshold_up_fahrenheit, 'y--') 
a.plot(fds, threshold_down_fahrenheit, 'y--')

plt.xlabel('Time (min)')
plt.ylabel('Temperature '+unichr(176)+'F')
plt.legend(["Room Temperature","Radiator","Fan State","Threshold Region"], loc="upper center", ncol=2)
plt.ylim([min(room_temp_data_fahrenheit)-5, max(rad_temp_data_fahrenheit)+5])
plt.grid()

a.xaxis.set_major_formatter(hfmt)

data_graph = FigureCanvasTkAgg(f, master=root)
data_graph.show()
data_graph.get_tk_widget().grid(row=6,column=0, columnspan=3)    
root.after(WAIT_TIME, control) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:43:26.907

从您的代码中我不清楚您的情节如何随时间变化。因此，我对您现有的代码没有任何具体建议。然而，这里是一个如何在 Tkinter 应用程序中嵌入动画 matplotlib 图形的基本示例。一旦你了解它是如何工作的，你应该能够适应你的情况。

```
import matplotlib.pyplot as plt
import numpy as np
import Tkinter as tk
import matplotlib.figure as mplfig
import matplotlib.backends.backend_tkagg as tkagg
pi = np.pi
sin = np.sin

class App(object):
    def __init__(self, master):
        self.master = master
        self.fig = mplfig.Figure(figsize = (5, 4), dpi = 100)
        self.ax = self.fig.add_subplot(111)
        self.canvas = canvas = tkagg.FigureCanvasTkAgg(self.fig, master)
        canvas.get_tk_widget().pack(side = tk.TOP, fill = tk.BOTH, expand = 1)
        self.toolbar = toolbar = tkagg.NavigationToolbar2TkAgg(canvas, master)
        toolbar.update()
        self.update = self.animate().next
        master.after(10, self.update) 
        canvas.show()

    def animate(self):
        x = np.linspace(0, 6*pi, 100)
        y = sin(x)
        line1, = self.ax.plot(x, y, 'r-')
        phase = 0
        while True:
            phase += 0.1
            line1.set_ydata(sin(x + phase))
            newx = x+phase
            line1.set_xdata(newx)
            self.ax.set_xlim(newx.min(), newx.max())
            self.ax.relim()
            self.ax.autoscale_view(True, True, True) 
            self.fig.canvas.draw()
            self.master.after(10, self.update) 
            yield

def main():
    root = tk.Tk()
    app = App(root)
    tk.mainloop()

if __name__ == '__main__':
    main() 
```

* * *

这里的主要思想是`plt.plot`应该只调用一次。它返回一个`Line2D`对象，`line1`。然后，您可以通过调用`line1.set_xdata`和/或来操纵绘图`line1.set_ydata`。这种动画“技术”来自[Matplotlib Cookbook](http://www.scipy.org/Cookbook/Matplotlib/Animations)。

技术说明：

这里使用了生成器函数`animate`来允许保存和更新绘图的状态，而不必在实例属性中保存状态信息。请注意，重复调用的是生成器函数的`next`方法（不是生成器）：`self.animate`

```
 self.update = self.animate().next
    master.after(10, self.update) 
```

`self.animate()`因此，我们通过调用生成器's, next 方法逐帧推进情节。

# java - LWJGL 键事件状态不起作用

> ID：13997821
> 
> 赞同：0
> 
> 时间：2012-12-21T22:08:47.393
> 
> 标签：java, keyboard, lwjgl

LWJGL 似乎在骚扰我（或者我又是个笨蛋）。我正在使用以下代码：

```
if(Keyboard.getEventKey() == Keyboard.KEY_Q) {
    if (Keyboard.getEventKeyState()) {
        System.err.println("Pressed");
    }else {
        System.err.println("Released");
    }
} 
```

当我按下并释放“Q”时，它既不会打印出“Pressed”也不会打印出“Released”。帮助？

编辑：问题解决了。在使用 getEventKey() 之前，您首先必须轮询键盘缓冲区。固定代码是：

```
while(Keyboard.next()) {
        if(Keyboard.getEventKey() == Keyboard.KEY_Q) {
            System.out.println("HI");
            if (Keyboard.getEventKeyState()) {
                System.out.println("Pressed");
            }else {
                System.out.println("Released");
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:28:13.587

每个 API：

> 公共静态 int getEventKey()
> 
> **请注意，返回的键码对当前键盘布局无效**。要获取实际按下的字符，请调用 getEventCharacter
> 
> 返回：当前事件的键

尝试更改您的第一条`if`语句以使用`getEventCharacter`menthod 作为：

```
 if(Keyboard.getEventCharacter() == Keyboard.KEY_Q) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-30T20:13:02.420

这就是我在我的程序中所做的......我为角色创建了一个布尔值，然后在游戏循环中运行一个方法来检查它：

```
public static boolean keyboardA;

public static void refresh() {
keyboardA = Keyboard.isKeyDown(Keyboard.KEY_A);
}

public static void game_loop() {
refresh();
} 
```

如果您需要我解释更多，请发表评论：P 希望对您有所帮助

# c# - 使用 jQuery 将 HTML 表格导出为 MS Excel 格式

> ID：13997824
> 
> 赞同：1
> 
> 时间：2012-12-21T22:09:08.330
> 
> 标签：c#, javascript, jquery, asp.net

我正在尝试遵循这个[例子](http://jsfiddle.net/jquerybyexample/xhYcD/)。使用 jQuery 将 HTML 表格导出为 MS Excel 格式。

这是我的.aspx：

```
<head runat="server">
    <title></title>
    <script src="Scripts/jQuery.1.8.3.js" type="text/javascript"></script>
    <script src="Scripts/JScript2.js" type="text/javascript"></script>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:Table ID="tbl" runat="server">
        </asp:Table>
        <input type="button" id="btnExport" value=" Export Table data into Excel " />
    </div>
    </form>
</body> 
```

.js (JScript2.js)：

```
$("#btnExport").click(function (e) {
    window.open('data:application/vnd.ms-excel,' + $('#tbl').html());
    e.preventDefault();
}); 
```

...以及背后的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class JQuery_Export_To_Excel : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        TableRow tr = new TableRow();
        TableCell tc = new TableCell();

        tc.Text = "AAA";
        tr.Cells.Add(tc);

        tc = new TableCell();
        tc.Text = "BBB";
        tr.Cells.Add(tc);

        tbl.Rows.Add(tr);    
    }
} 
```

生成的页面源：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><title>

</title>
    <script src="Scripts/jQuery.1.8.3.js" type="text/javascript"></script>
    <script src="Scripts/JScript2.js" type="text/javascript"></script>
</head>
<body>
    <form method="post" action="JQuery_Export_To_Excel.aspx" id="form1">
<div class="aspNetHidden">
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE2NTA0OTEwODdkZKr9kRtjn1C5sAo2woCwfF/8uHOVcyNi1bu4OtVBNKlS" />
</div>

<div class="aspNetHidden">

    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEdAAIdFUHUqRwMmhFieKB52uC8avDSflAS9b8PVcR1BxTTBqeDRyg6lH5NKPWh6Jt5ee2zX+bYNkguHBdZjCzKvoJa" />
</div>
    <div>
        <table id="tbl">
    <tr>
        <td>AAA</td><td>BBB</td>
    </tr>
</table>
        <input name="btnExport" type="button" id="btnExport" value=" Export Table data into Excel " />
    </div>
    </form>
</body>
</html> 
```

我不知道我做错了什么，但是当我单击*btnExport*时，什么也没有发生。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:26:16.233

把它放在你的表格中

```
<div>
    <div id="container">
        <asp:Table ID="tbl" runat="server">
        </asp:Table>
    </div>
    <input type="button" id="btnExport" value=" Export Table data into Excel " />
</div> 
```

把它放在带有脚本标签的标题部分

```
 $(document).ready(function () {
        $("#btnExport").click(function (e) {
            window.open('data:application/vnd.ms-excel,' + $('#container').html());
            e.preventDefault();
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:26:23.893

我相信您的代码没有任何问题，只是因为您的代码是 asp.net。你不能直接使用 $('#tbl') 。你必须使用 $("#" +'<%=tbl.ClientID%>')

# c++ - 互斥锁优先级

> ID：13997825
> 
> 赞同：5
> 
> 时间：2012-12-21T22:09:11.160
> 
> 标签：c++, multithreading, c++11

在多线程（2线程）程序中，我有以下代码：

```
while(-1)
{
    m.lock();

    (...)

    m.unlock();
} 
```

`m`是一个互斥体（在我的情况下是 c++11 `std::mutex`，但我认为如果我使用不同的库它不会改变）。

假设第一个线程拥有互斥锁并且它`(...)`部分做了一些事情。第二个线程试图获取互斥锁，但它正在等待第一个线程 release `m`。

问题是：当线程 1 结束它的`(...)`执行并解锁互斥锁时，我们能否确定线程 2 获得了互斥锁，或者线程 1 可以在线程 2 之前再次重新获得互斥锁，让它卡在里面`lock()`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:22:31.080

C++ 标准不对互斥锁的顺序锁定做出任何保证。因此，活动线程完全有可能在没有另一个线程尝试获取锁`unlock()`的情况下一直保持访问状态。我不认为 C++ 标准提供了一种控制线程优先级的方法。我不知道您要做什么，但可能还有另一种方法可以避免您遇到的问题。`lock()``std::mutex m`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T22:16:16.450

If both threads are equal priority, there is no such guarantee by standard mutex implementations. Some OS's have a lis of "who's waiting", and will pick the "longest waiting" when you release something, but that is an implementation detail, not something you can reliably depend on.

And imagine that you have two threads, each running something like this:

```
m.lock();

(...)

m.unlock();
(...)    // Clearly not the same code as above (...)
m.lock();

(...)    // Some other code that needs locking against updates. 

m.unlock(); 
```

Would you want the above code to switch thread on the second lock, every time?

By the way, if both threads run with lock for the entire loop, what is the point of a lock?

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T22:25:23.487

没有任何保证，因为线程之间没有以任何方式相互排序。事实上，唯一的同步点*是*互斥锁。

第一个线程完全有可能立即重新获取锁，例如，如果它在紧密循环中运行该函数。如果任何线程在互斥锁上休眠，典型的实现具有通知和唤醒机制，但也可能存在让正在运行的线程继续而不是执行上下文切换的偏见......这在很大程度上取决于实现和细节当时的平台。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T00:02:35.080

C++ 或底层操作系统不提供任何保证。

但是，线程到达临界区（在这种情况下为互斥体）的时间决定了某种合理程度的公平性。这种公平性可以表示为统计概率，但不是严格的保证。这种选择很可能取决于操作系统执行调度程序，它还将考虑许多其他因素。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-21T23:02:47.137

依赖这样的代码不是一个好主意，所以你可能应该改变你的设计。但是，在某些操作系统上， sleep(0) 会产生线程。（Windows 上的睡眠（0））同样，最好不要依赖这个。

# php - php从数组中选择多个随机键

> ID：13997826
> 
> 赞同：3
> 
> 时间：2012-12-21T22:09:15.687
> 
> 标签：php, arrays, random

我一直在尝试从数组中选择随机项目而不重复相同的项目。

样本数组

```
$images=array();
$images[]=array('img'=>'bands.jpg','cat'=>'bands.php');
$images[]=array('img'=>'cake.jpg','cat'=>'cakes.php');
$images[]=array('img'=>'catering.jpg','cat'=>'catering.php');
$images[]=array('img'=>'dj.jpg','cat'=>'djs.php');
$images[]=array('img'=>'dress.jpg','cat'=>'dress_attire.php');
$images[]=array('img'=>'limos.jpg','cat'=>'limos_transportaion.php');
$images[]=array('img'=>'photography.jpg','cat'=>'photography.php');
$images[]=array('img'=>'venues.jpg','cat'=>'venues.php');
$images[]=array('img'=>'wedding_planer.jpg','cat'=>'planning.php'); 
```

我尝试了以下方法，但由于某种原因它无法正常工作。它仅将数组中的第一项收集到呈现的计数中。// $adDisplay 是一个 1-9 之间的数字

```
$rand = array_rand($images, $adDisplay);
foreach($rand as $key => $value){
    echo'<a href="'.$images[$key]['cat'].'"><img src="img/banners/'.$images[$key]['img'].'" border="0" alt="" /></a>';
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:26:32.860

这样做的方法很多，我可能会洗牌然后对数组进行切片：

```
$images = array();
$images[]=array('img'=>'bands.jpg','cat'=>'bands.php');
$images[]=array('img'=>'cake.jpg','cat'=>'cakes.php');
$images[]=array('img'=>'catering.jpg','cat'=>'catering.php');
$images[]=array('img'=>'dj.jpg','cat'=>'djs.php');
$images[]=array('img'=>'dress.jpg','cat'=>'dress_attire.php');
$images[]=array('img'=>'limos.jpg','cat'=>'limos_transportaion.php');
$images[]=array('img'=>'photography.jpg','cat'=>'photography.php');
$images[]=array('img'=>'venues.jpg','cat'=>'venues.php');
$images[]=array('img'=>'wedding_planer.jpg','cat'=>'planning.php');

shuffle($images);

$adDisplay = 5;

foreach( array_slice($images,0,$adDisplay) as $image){
    echo '<a href="' . htmlspecialchars($image['cat']) . '">'
         . '<img src="img/banners/'
         . htmlspecialchars($image['img']) . ' border="0" alt="" />'
         . '</a>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:14:19.440

`array_rand` returns the random *keys* as values. You actually want to use `$images[$value]['cat']`. Also keep in mind that `array_rand` does not return an array if one item is requested; you must handle that specially.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:15:55.020

The key will be the index, value will be the random variable, thus use value instead of key as the index into your images array. Cheers.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T22:40:08.397

`shuffle`如果您希望数组以随机顺序使用，请使用：

```
shuffle($images);

foreach($images as $img) {
    echo($img['cat']);
} 
```

或用于`array_rand`获取随机密钥：

```
$key = array_rand($images);

echo($images[$key]['cat']); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-04T15:44:33.450

替代建议：

```
$images = array();
$images[]=array('img'=>'bands.jpg','cat'=>'bands.php');
$images[]=array('img'=>'cake.jpg','cat'=>'cakes.php');
$images[]=array('img'=>'catering.jpg','cat'=>'catering.php');
$images[]=array('img'=>'dj.jpg','cat'=>'djs.php');
$images[]=array('img'=>'dress.jpg','cat'=>'dress_attire.php');
$images[]=array('img'=>'limos.jpg','cat'=>'limos_transportaion.php');
$images[]=array('img'=>'photography.jpg','cat'=>'photography.php');
$images[]=array('img'=>'venues.jpg','cat'=>'venues.php');
$images[]=array('img'=>'wedding_planer.jpg','cat'=>'planning.php');

for ($i = 0; $i < $adDisplay AND sizeof($images) > 1; $i++) {
    $k = array_rand(0, sizeof($images)-1);
    $image = $images[$k];
    unset($images[$k];
    sort($images);
    echo '<a href="' . htmlspecialchars($image['cat']) . '">'
         . '<img src="img/banners/'
         . htmlspecialchars($image['img']) . ' border="0" alt="" />'
         . '</a>';
} 
```

因此，选择一个随机键，从数组中删除该记录，显示它并为下一轮重新排序数组。继续，直到显示足够多或记录用完为止。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-31T10:38:35.503

您可以简单地使用 array_rand 并将最新的密钥存储在变量或某处

如果 random_key == last_used_key 那么 Random_key+1

不比这更难:-)

# ruby-on-rails - 删除设计的最佳方法？

> ID：13997827
> 
> 赞同：-1
> 
> 时间：2012-12-21T22:09:30.830
> 
> 标签：ruby-on-rails, ruby, devise

我在设计的重置密码部分遇到了一些问题，那么有没有一种简单的方法可以删除它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:30:53.907

尝试重置密码时出现 ArgumentError，因为您没有正确设置设计

在“config/environments/development.rb”中需要设置主机，例如：

```
config.action_mailer.default_url_options = { :host => 'localhost:3000' } 
```

在此处阅读整个入门指南：[https ://github.com/plataformatec/devise#getting-started](https://github.com/plataformatec/devise#getting-started)

* * *

如果您确实需要删除设计：

*   从 Gemfile 中删除 gem
*   如果您运行迁移，请删除表
*   删除生成的视图、控制器、模型和邮件程序（如果您生成了它们）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:25:13.360

不要删除它，我每次需要身份验证时都会使用设计，并且从未遇到任何不容易修复的问题。

我敢打赌，您没有正确遵循说明。运行后

`rails g devise:install`

您需要按照命令行中打印的说明进行操作。

如果您确实需要删除它，请执行以下操作：

1.  从 Gemfile 中删除
2.  从控制器、视图和模型中删除身份验证链接和逻辑（如果有的话）。
3.  从数据库中删除设计表

# javascript - Backbone：管理模板

> ID：13997828
> 
> 赞同：4
> 
> 时间：2012-12-21T22:09:36.800
> 
> 标签：javascript, backbone.js, underscore.js

我正在为骨干应用程序使用下划线模板引擎。截至目前，我在`<head>`. 它越来越难以维护。到目前为止，我看到的大多数管理模板的解决方案最终都需要它们是 js 文件。这也是一个令人头疼的问题，我更喜欢它们是用于编辑目的的 html 文件。

我看了一下 requirejs 并不确定我是否需要它，因为它有点围绕着一种更模块化的方法，我现在不能说我正在使用（尽管我很快会）。

管理模板并根据需要加载/缓存它们的最佳方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T22:20:20.323

就个人而言，我的公司需要一个强大的解决方案，所以我们选择了：

*   Require.js - 用于模块加载
*   Handlebars - 提供比 Underscore 更强大的模板
*   HBS - 来自 Alex Sexton 的出色 require 插件，可处理通过 Require 引入已编译的模板

通过这个设置，我可以将所有模板保存在它们自己的文件中，然后使用它们，我有这样的文件：

```
define(['template!path/to/someTemplate'], function(someTemplate) {
    var MyNewView = BaseView.extend({template: someTemplate});
    $('body').append(new MyNewView().render().el);
} 
```

（你可能猜到我们有一个名为 BaseView 的基本 Backbone 视图，它使用视图的模板属性来呈现视图）。

现在，话虽如此，如果您不需要如此强大的设置，那么 Require 可能不适合您。在这种情况下，我会执行以下操作：

1.  将所有模板放入一个或多个 HTML 文件中；将它们包装在脚本标签中，如下所示：

    ```
    <script id="dummyTemplate" type='text/template'>
    <span>I'm a template!</span>
    </script> 
    ```

2.  在您的服务器端编写一些代码以将这些 HTML 文件包含在您发送给客户端的主 HTML 文件中

3.  编写一个函数，该函数接受模板 ID，获取该元素的文本，将其编译为模板，然后返回该模板（如果需要，可以缓存已编译的模板……当然，我不认为使用 Underscore 模板你甚至需要编译，所以你可以跳过所有这些）。

4.  使用您的函数访问您的模板：`$("#something").html(templateFunc('dummyTemplate').template())`

这将允许您将模板存储在 html 文件中（用于语法着色），但仍然可以在 JS 中方便地访问它们。您还可以根据需要在任意数量的文件之间划分模板，只要您可以编写包含逻辑来引入它们。

但是，如果您确实选择了 Require，请务必查看 HBS 插件。如果您还没有看过 Handlebars 模板，您可能想看一下；它们比下划线的要强大得多（但就像任何好的模板系统一样，不要考虑太多的逻辑）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:17:55.647

Not sure what you mean by it being unmaintainable. Is it just a long list?

You don't need to keep your templates in the head. They can be at the bottom of your body as well. They just need to be defined before you try to use them.

One thing you might look into, depending on the server technology you are using would be to separate your templates into a different HTML file and include it at runtime.

# c# - 是否有任何执行 INET_ATON() 的 .NET Framework 方法

> ID：13997836
> 
> 赞同：3
> 
> 时间：2012-12-21T22:10:20.367
> 
> 标签：c#, inet-aton

在下面做这个计算

```
address = '174.36.207.186'

( o1, o2, o3, o4 ) = address.split('.')

integer_ip =   ( 16777216 * o1 )
             + (    65536 * o2 )
             + (      256 * o3 )
             +              o4 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T22:16:07.103

```
string s = "174.36.207.186";

uint i = s.Split('.')
          .Select(uint.Parse)
          .Aggregate((a, b) => a * 256 + b); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T22:18:20.773

您可以将数字解析为字节数组，然后使用`BitConverter.ToInt32`将它们组合成一个 int：

```
byte[] parts = address.Split('.').Select(Byte.Parse).ToArray();
if (BitConverter.IsLittleEndian) {
  Array.Reverse(parts);
}
int ip = BitConverter.ToInt32(parts, 0); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T22:22:39.867

您可以将字符串解析为 IPAddress 实例，然后访问[地址属性](http://msdn.microsoft.com/en-us/library/system.net.ipaddress.address.aspx)：

```
long result = IPAddress.Parse("174.36.207.186").Address; 
```

请注意，这将产生编译器警告（过时属性），因为它不适用于 IPv6。

# c++ - 如何从日期输入方面创建 Boost ptime 对象

> ID：13997839
> 
> 赞同：2
> 
> 时间：2012-12-21T22:10:40.070
> 
> 标签：c++, boost, boost-date-time

我尝试使用 C++ Boost date_time 库将格式为“2012 年 12 月 12 日 16:43”的字符串加载到日期输入方面为“%H:%M %B %d, %Y”的字符串流中。接下来，我想从 stringstream 创建一个 Boost ptime 对象，这样我就可以进行日期/时间数学运算。我无法让它工作——下面是代码：

```
std::string autoMatchTimeStr(row["message_time"]);
ptime autoMatchTime(time_from_string(autoMatchTimeStr));

date_input_facet* fin = new date_input_facet("%H:%M %B %d, %Y");
stringstream dtss;

dtss.imbue(std::locale(std::locale::classic(), fin));
dtss << msg.getDate(); //msg.getDate() returns “16:43 December 12, 2012”

ptime autoMatchReplyTime;
dtss >> autoMatchReplyTime;

if( autoMatchReplyTime < autoMatchTime + minutes(15)) {
    stats[ "RespTimeLow" ] = "increment";
    sysLog << "RespTimeLow" << flush;
} 
```

autoMatchTime 包含有效的日期/时间值，但 autoMatchReplyTime 不包含。我想了解这应该如何工作，但如果我必须使用 C strptime 为 ptime 构造函数初始化一个 struct tm，我可以这样做。我花了很多时间研究、编码、使用 gdb 调试，但无法弄清楚。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T22:33:01.450

所以......你为什么要使用`date_input_facet`而不是`time_input_facet`？以下示例工作正常。

```
#include <sstream>
#include <boost/date_time/posix_time/posix_time.hpp>

int main()
{
   const std::string time = "16:43 December 12, 2012";
   boost::posix_time::time_input_facet* facet =
   new boost::posix_time::time_input_facet("%H:%M %B %d, %Y");
   std::stringstream ss;
   ss.imbue(std::locale(std::locale(), facet));
   ss << time;
   boost::posix_time::ptime pt;
   ss >> pt;
   std::cout << pt << std::endl;
} 
```

[代码](http://liveworkspace.org/code/4sJpPu%245)

# jquery - 在 HTML 链接中调用 jQuery 函数？

> ID：13997841
> 
> 赞同：0
> 
> 时间：2012-12-21T22:10:54.440
> 
> 标签：jquery, html

我试图让这些 jQuery 命令稍后通过 html 中的链接执行：

```
 $('#mov').click(function() {
                            $('#twastream').hide();
                            $('#ownstream').hide();                                     
                            $('#movstream').fadeIn();
                    } 
```

这应该隐藏两个元素并在单击 id 为“mov”的链接后显示一个，但没有发生任何事情。这是链接：

```
 <a href="test/#" onclick="mov()">Click here!</a> 
```

这是元素；这三个都具有类似的格式。

```
 <div class="movstream" id="movstream"> 
```

我应该如何更改这些格式以使初始代码正确运行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:14:25.867

You need to have an id on your anchor tag for your jquery selector `$('#mov')` to work:

```
<a href="test/#" id="mov">Click here!</a> 
```

Using `onclick="mov()"` on your anchor means to execute a function named `mov`, which is undefined

You also need to wrap your `.click` event in `$(document).ready()`:

```
$(document).ready(function(){
    $('#mov').click(function() {
        $('#twastream').hide();
        $('#ownstream').hide();                                     
        $('#movstream').fadeIn();
    }
}); 
```

Otherwise the element may not exist when the script runs

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:14:52.460

The strength of jQuery is in its ability to make tasks like this mundane.

First, give your link either a **class** or an **id** (a class would work if this can happen on any given number of links) and then bind your event in the background, like this:

HTML

```
<a href="/#" class="test" /> 
<!--OR-->
<a href="/#" id="test" /> 
```

JavaScript

```
$(".test").click(function(){ //Or $("#test")
     $('#twastream').hide();
     $('#ownstream').hide();                                     
     $('#movstream').fadeIn();
}); 
```

It might be helpful to go and review the [jQuery API](http://api.jquery.com/), too.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:16:19.027

Nothing is happening because you don't have an ID specified on the anchor. The jQuery is looking for a click on an element with the id of "mov" but there isn't an element with that id.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T22:35:55.273

您应该在准备好的处理程序中侦听您的事件：

```
$(function() {
   $('#mov').click(function() {
      $('#twastream').hide();
      $('#ownstream').hide();                                     
      $('#movstream').fadeIn();
   });
}); 
```

[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

而且您需要确保该`.click`函数正确指定了选择器。请注意，这是带有of`$('#mov')`的项目的选择器。这也适用于类。`id``mov`

```
<a id="mov">Click here!</a>     
<div class="twastream" id="twastream">Twas</div>
<div class="ownstream" id="ownstream">Own</div>
<div class="movstream" id="movstream">Mov</div> 
```

[http://api.jquery.com/category/selectors/](http://api.jquery.com/category/selectors/)

# jquery - jQuery 脚本在 jsfiddle 上工作，但不在我的网站上？

> ID：13997843
> 
> 赞同：2
> 
> 时间：2012-12-21T22:11:05.783
> 
> 标签：jquery

我有一个无法在我的网站上运行的 jQuery 函数。Firebug 和 Chrome 的检查员都没有报告任何错误。我运行了一个[jsfiddle](http://jsfiddle.net/fTXd6/7/)，它在那里工作得很好。关于问题可能是什么的任何想法？我很困惑。

这是我的功能：

```
$("#totop").hover(
    function(){
        $(this).stop().animate({height: "50px"}, "slow");
    },
    function(){
        $(this).stop().animate({height: "20px"}, "slow");    
    }
); 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:26:43.467

试试这个，会像魅力一样工作:=)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-2" />
<meta name="author" content=""/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<title></title>
<style type="text/css">
*{margin:0px;padding:0px}
#totop{width:400px;
height:20px;
position: absolute;
bottom: 0px;
left: 35%;width: 30%;
background: #78D3D9;
height: 20px;
border-top-left-radius: 10px;
border-top-right-radius: 10px;}
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function(){

$("#totop").hover(
function(){
    $(this).stop().animate({height: "50px"}, "slow");
},
function(){
    $(this).stop().animate({height: "20px"}, "slow");    
}
);

});

</script>
</head>
<body>
<a href="#topofpage"><div id="totop"></div></a>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:33:22.073

这是其他提出相同问题的人的答案：

将代码包装在：

```
$(function() { /* your code here */ }); 
```

# linux - 在 Linux 上监视和记录单个 HTTP 连接的工具？

> ID：13997855
> 
> 赞同：0
> 
> 时间：2012-12-21T22:12:04.517
> 
> 标签：linux, http

我们正在尝试调试必须接收和响应大量持久 HTTP 连接的服务器的问题。

理想情况下，我们想要一个可以（随机）选择单个 HTTP 连接并记录进出它的所有流量的工具，这样我们就可以看到发生了什么。

不幸的是，我们没有能力限制我们必须响应的持久连接的数量（通常是数千个），因此我们确实需要工具将其监控范围缩小到单个连接。

谁能推荐这样一个工具，并指导如何说服它做我们需要的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:12:58.747

Wireshark 是用于此目的的出色开源工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:30:13.650

数据包的实际捕获通常由`libpcap`. 在它之上构建了不同的工具：

*   首先有好老`tcpdump`。它是一个文本工具，允许您指定您感兴趣的数据包并为每个匹配的数据包打印（默认情况下）一行。实际上你有很多选择应该做什么。您还可以将所有流量转储到捕获文件中。

*   然后是`wireshark`（以前称为空灵）。这是一个 GUI，允许您像在 tcpdump 中一样捕获数据包，并且有很多方法可以分析此类数据。它还可以读取和分析 tcpdump 创建的捕获文件。

*   与wireshark 一起出现`tshark`（以前称为tethereal），它几乎是wireshark 的控制台版本。

*   如果您只对数据包中发送的数据感兴趣，请查看`tcpflow`。

还有一些更高级的工具也可以用来攻击其他主机。例如`ettercap`，将列出所有当前连接，其中可以显示在该连接上发送的数据。

您的问题并不完全清楚，您到底想找出什么，但听起来`tcpflow`可能就是您想要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:25:38.583

如果直接使用wireshark不起作用，您可以在防火墙/路由器类型框中摆弄路由，并让受监控的连接通过不同的接口（您可以使用wireshark或其他方式接入它）而不是所有其他接口与服务器的连接。

# internet-explorer - Jquery 帖子在 IE 8 或更早版本中不起作用

> ID：13997857
> 
> 赞同：3
> 
> 时间：2012-12-21T22:12:09.617
> 
> 标签：internet-explorer, jquery, post, internet-explorer-8

所以这个功能适用于除 IE 之外的所有其他浏览器。我只能访问 IE 8，所以不能说新版本是否有效。我无权访问 PHP 或它如何调用 SQL DB，所以我不能确定它是 javascript。警报永远不会在 IE 中触发。

```
$.post( 'http://foo/geo/getGeoResultsByGeoId.php', {geoId: 1}, function(data){
alert('inside');        
    var DBinfo = $.parseJSON(data);
    if(DBinfo.data.length == sites.length) {
        for (var i=0; i<sites.length; i++) {
            sites[i].votesUp = Number(DBinfo.data[i].votesUp);
            sites[i].votesDown = Number(DBinfo.data[i].votesDown);
            sites[i].mag = getMagnitude(Number(DBinfo.data[i].votesUp), Number(DBinfo.data[i].votesDown));
            createGraph(sites[i]);
        }
        setMarkers(map, sites);
     }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-26T03:53:28.090

`head`在 < > 标记开始之后将这一行放在您的 HTML 中

```
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
```

它适用于`IE8+`.

除此之外，不要忘记在您的`$.post`请求中提及数据类型。你可以这样做

```
 $.post(url, 
    function(){
     //your content here
    },'dataType')
    .fail(function(jqXHR,status)
    {
    }); 
```

**dataType**可以是`xml`、`json`、`text`或`jsonp`数据类型的组合。因此，根据您的数据类型进行选择，它会正常工作。它至少对我有用，不知道我是否错了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:22:05.617

我预计问题是两个不同的成功回调的时间。这应该有效：

```
$.post( 'http://fooURL/getGeoResultsByGeoId.php', {geoId: 1}, function(data){
    alert('inside');
    var DBinfo = $.parseJSON(data);
    if(DBinfo.data.length == sites.length) {
      for (var i=0; i<sites.length; i++) {
        sites[i].votesUp = Number(DBinfo.data[i].votesUp);
        sites[i].votesDown = Number(DBinfo.data[i].votesDown);
        sites[i].mag = getMagnitude(Number(DBinfo.data[i].votesUp),    Number(DBinfo.data[i].votesDown));
        createGraph(sites[i]);
      }
      setMarkers(map, sites);
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:22:41.970

如果您的返回数据是 JSON 并且您发出跨域请求，那么这样的事情怎么样：

```
$.ajax({
    url: 'http://fooURL/getGeoResultsByGeoId.php?callback=?',
    data : {geoId: 1},
    dataType : 'JSONP',
    success: function(data) {
        DBinfo = data;
        alert('inside');
        if(DBinfo.data.length == sites.length) {
            for (var i=0; i<sites.length; i++) {
                sites[i].votesUp = Number(DBinfo.data[i].votesUp);
                sites[i].votesDown = Number(DBinfo.data[i].votesDown);
                sites[i].mag = getMagnitude(Number(DBinfo.data[i].votesUp), Number(DBinfo.data[i].votesDown));
                createGraph(sites[i]);
            }

            setMarkers(map, sites);
         }
    },
    type : 'POST' 
}); 
```

# button - 灰色的工具栏按钮

> ID：13997868
> 
> 赞同：0
> 
> 时间：2012-12-21T22:14:01.740
> 
> 标签：button, mfc, toolbar

我在工具栏上添加了一个按钮，当我运行应用程序时，它是灰色的（停用）我无法点击它。单击它时我尝试添加事件，但仍然是灰色的。

我怎样才能让它活跃起来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:41:52.653

好的，现在可以了，我必须将 ID 添加到 Accelerator 表中，这很奇怪，但至少可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:27:17.833

确保有按钮的处理程序。如果没有 ON_COMMAND 处理程序，MFC 将自动禁用按钮。

否则，您需要实施`ON_UPDATE_COMMAND_UI`以启用按钮。

# windows - Sed 或 awk - 需要抓取一个子字符串并将其附加到行尾

> ID：13997875
> 
> 赞同：2
> 
> 时间：2012-12-21T22:14:34.770
> 
> 标签：windows, text, sed, awk, substring

我正在使用 Windows sed / awk 但 unix 命令类似，

文件 1

```
\\FILE09\12GAGE\LOAN CLOSING UNIT;\\FILE09\12GAGE;/fs8_100X/FILE09/bu/12gage
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44
\\FILE15\FILE15\BU\MICROSOFT MACRO REMEDIATION;\\FILE15\FILE15;/fs6_100X/FILE15 
```

所需输出：

```
\\FILE09\12GAGE\LOAN CLOSING UNIT;\\FILE09\12GAGE;/fs8_100X/FILE09/bu/12gage/LOAN CLOSING UNIT
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44/BU/EARPS/FUNDCHECK
\\FILE15\FILE15\BU\MICROSOFT MACRO REMEDIATION;\\FILE15\FILE15;/fs6_100X/FILE15/BU/MICROSOFT MACRO REMEDIATION 
```

我需要抓取第一个字段，例如在第 4 次出现 backslack 之后抓取字符串：

```
\\FILE44\FILE44\BU\EARPS\FUNDCHECK 
```

它将是 \BU\EARPS\FUNDCHECK，然后将反斜杠转换为斜杠： /BU/EARPS/FUNDCHECK 然后将其附加到该行的末尾。

```
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44/BU/EARPS/FUNDCHECK 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:13:31.000

这是一种使用方法`awk`：

```
awk -F ";" '{ a = $0; sub(/^\\\\[^\\]*\\[^\\]*/,""); gsub(/\\/,"/",$1); print a $1 }' file 
```

或简化正则表达式：

```
awk -F ";" '{ a = $0; sub(/^\\(\\[^\\]*){2}/,""); gsub(/\\/,"/",$1); print a $1 }' file 
```

结果：

```
\\FILE09\12GAGE\LOAN CLOSING UNIT;\\FILE09\12GAGE;/fs8_100X/FILE09/bu/12gage/LOAN CLOSING UNIT
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44/BU/EARPS/FUNDCHECK
\\FILE15\FILE15\BU\MICROSOFT MACRO REMEDIATION;\\FILE15\FILE15;/fs6_100X/FILE15/BU/MICROSOFT MACRO REMEDIATION 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:13:59.197

这个单线可能工作：

```
 awk -F';' '{x=$1;sub(/\\\\[^\\]+\\[^\\]+\\/,"",x);gsub(/\\/,"/",x);print $0"/"x}' file 
```

测试

```
kent$  awk -F';' '{x=$1;sub(/\\\\[^\\]+\\[^\\]+\\/,"",x);gsub(/\\/,"/",x);print $0"/"x}' test
\\FILE09\12GAGE\LOAN CLOSING UNIT;\\FILE09\12GAGE;/fs8_100X/FILE09/bu/12gage/LOAN CLOSING UNIT
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44/BU/EARPS/FUNDCHECK
\\FILE15\FILE15\BU\MICROSOFT MACRO REMEDIATION;\\FILE15\FILE15;/fs6_100X/FILE15/BU/MICROSOFT MACRO REMEDIATION 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:18:15.910

使用 sed：

```
sed -e 's/\(\([^\\]*\\\)\{4\}\)\([^;]*\);\(.*\)/\1\3;\4\/\3/' 
    -e ':l s/\([^;]*;[^;]*;[^\\]*\)\\/\1\//;t l' input 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T09:26:22.397

这可能对您有用（GNU sed）：

```
sed -r 'h;s/^(([\\][^\\]*){3})([^;]*).*/\3/;y/\\/\//;H;g;s/\n//' file 
```

*   `h`将原始行复制到保留空间 (HS)
*   `s/^(([\\][^\\]*){3})([^;]*).*/\3/`隔离有问题的字符串
*   `y/\\/\//`用`\`'s替换`/`'s
*   `H`将修改后的字符串附加到 HS 中的原始行（引入换行符）
*   `g`将修改后的行检索到模式空间 (PS)
*   `s/\n//`删除换行符

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T11:19:58.027

```
awk -F";" '{n=split($1,a,"\\");$0=$0"/"a[n];print $0}' your_file 
```

测试如下：

```
 cat temp
\\FILE09\12GAGE\LOAN CLOSING UNIT;\\FILE09\12GAGE;/fs8_100X/FILE09/bu/12gage
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44
\\FILE15\FILE15\BU\MICROSOFT MACRO REMEDIATION;\\FILE15\FILE15;/fs6_100X/FILE15

> awk -F";" '{n=split($1,a,"\\");$0=$0"/"a[n];print $0}' temp
\\FILE09\12GAGE\LOAN CLOSING UNIT;\\FILE09\12GAGE;/fs8_100X/FILE09/bu/12gage/LOAN CLOSING UNIT
\\FILE44\FILE44\BU\EARPS\FUNDCHECK;\\FILE44\FILE44;/fs6_451B/FILE44/FUNDCHECK
\\FILE15\FILE15\BU\MICROSOFT MACRO REMEDIATION;\\FILE15\FILE15;/fs6_100X/FILE15/MICROSOFT MACRO REMEDIATION
> 
```

# c# - StructureMap：如何通过类型而不是名称来指定 Tor 参数

> ID：13997876
> 
> 赞同：2
> 
> 时间：2012-12-21T22:14:33.537
> 
> 标签：c#, .net, dependency-injection, inversion-of-control, structuremap

我想覆盖我的一个存储库的默认 SessionFactory 实例。我使用以下代码来实现这一点，但我不喜欢指定我试图覆盖的构造函数参数的名称。

```
var container = new Container(x =>
{
    x.For(typeof(IRepository<Facility>))
        .Use(typeof(Repository<Facility>))
            .CtorDependency<ISessionFactory("sessionFactory")
                .IsNamedInstance("CoolSessionFactory");
}); 
```

SM 文档建议，只要 ctor 不接受多个相同类型的参数，则`CtorDependency`方法不需要您提供参数名称。但是，使用最新版本的 SM，我看不到`CtorDependency`. 是否有不同的配置选项可以实现相同的效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T07:41:10.540

您需要使用`Child<>`而不是`CtorDependency<>`

```
var container = new Container(x =>
{
    x.For(typeof(IRepository<Facility>))
        .Use(typeof(Repository<Facility>))
            .Child<ISessionFactory>()
                .IsNamedInstance("CoolSessionFactory");
}); 
```

# python - Set default directory of Pydev interactive console?

> ID：13997877
> 
> 赞同：10
> 
> 时间：2012-12-21T22:14:41.320
> 
> 标签：python, eclipse, pydev

The interactive console (aka PyDev console) which I use to run scripts with `Control + Alt + Enter` loads with `C:\Program Files (x86)\eclipse` as the default directory. How can I make it load to the default working directory that the script or project is located in?

I've been researching this all over now and nothing seems to work. It looks like others have been having the same issues with no answers too:

[pydev console path for the active editor](https://stackoverflow.com/questions/13051028/pydev-console-path-for-the-active-editor)

[https://superuser.com/questions/486759/how-can-i-select-a-default-interactive-console-in-pydev](https://superuser.com/questions/486759/how-can-i-select-a-default-interactive-console-in-pydev)

I also tried implementing a custom startup script [found here](http://www.schlamar.org/blog/2010/07/21/pydev-interactive-console-set-working-directory/) to no avail. I've also added my working directory to the PYTHONPATH as [suggested here](https://stackoverflow.com/questions/12343898/pydev-console-working-directory).

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-28T18:06:58.327

这类似于[活动编辑器的 pydev 控制台路径](https://stackoverflow.com/questions/13051028/pydev-console-path-for-the-active-editor)

[https://stackoverflow.com/users/5717589/ptrj](https://stackoverflow.com/users/5717589/ptrj)在上述链接中给出的答案是正确的，我相信这里也适用。它类似于[https://stackoverflow.com/users/5618245/daniel](https://stackoverflow.com/users/5618245/daniel)发布的内容，但我认为提供了更详细的信息。为方便起见，我将在这里再次粘贴。ptrj 应该得到信任。此外，上述链接的 ptrj 答案应该已被 IMO 投票赞成。

**来自ptrj：** 我遇到了同样的问题，刚刚找到了另一个解决方案。它类似于已经提到的那些，但在 eclipse/pydev 中完全可配置（无需修改脚本）。

在 Window -> Preferences -> PyDev -> Interpreters -> Python Interpreter 中选择 tab Environment 并添加一个新变量，名称为 PROJECT_PATH （或您选择的任何内容）和 Value ${project_loc} （这是项目文件夹的绝对路径） . 然后在 Window -> Preferences -> PyDev -> Interactive Console -> Initial Command 添加行 import os; os.chdir(os.environ['PROJECT_PATH'])。（如果您启动“当前工作编辑器的控制台”，它会起作用。）

我使用这种方法，它对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T17:27:02.800

我也为此苦苦挣扎。您链接到的脚本出现在我的搜索中，但直到我意识到它适用于 Python 2.6 并且我猜您使用的是不同的版本时才起作用。

我在 Preferences > Pydev > Interactive Console 下编辑了 Initial解释器命令：

```
import sys; print('%s %s' % (sys.executable or sys.platform, sys.version))
import os
cwd_path = [path for path in sys.path if 'org.python.pydev' not in path and 'python2' not in path]
if len(cwd_path) == 1:
    os.chdir(cwd_path[0]) 
```

（最后有一个换行符）并且效果很好。

不过，我仍然想不出一种设置默认控制台类型的方法。每次伸手去拿鼠标都会很快变老。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-15T14:42:57.513

我将文件夹路径附加到 sys.path 工作正常，在 Preferences > Pydev > Interactive Console 下，添加项目文件夹路径的第二行：

```
import sys; print('%s %s' % (sys.executable or sys.platform, sys.version))
sys.path.append('F:\\projects\\python') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-29T16:10:39.550

PyDev->Window->Preferences->PyDev->Interactive Console -> Initial Commands：

```
import sys; print('%s %s' % (sys.executable or sys.platform, sys.version))
import os
os.chdir('${workspace_loc:MyProject/src}') 
```

为我工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T03:31:58.943

我也是。由于评论有长度限制，我将我的评论粘贴为答案。
我在 Python 2.7.3、Pydev 2.7.0 上工作。
我当前的 sys.path 是：

`['D:\\Aptana Studio 3\\plugins\\org.python.pydev_2.7.0.2013012902\\pysrc',
'D:\\Python27\\lib\\site-packages\\distribute-0.6.30-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\pydap-3.1.rc1-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\coards-1.0.2-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\pastedeploy-1.5.0-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\pastescript-1.7.5-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\paste-1.7.5.1-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\genshi-0.6-py2.7-win32.egg',
'D:\\Python27\\lib\\site-packages\\httplib2-0.7.7-py2.7.egg',
'D:\\Python27\\lib\\site-packages\\virtualenv-1.8.4-py2.7.egg',
'D:\\Aptana Studio 3\\plugins\\org.python.pydev_2.7.0.2013012902\\pysrc',
'E:\\workspace\\pst_python',
'D:\\Python27\\DLLs',
'D:\\Python27\\lib',
'D:\\Python27\\lib\\plat-win',
'D:\\Python27\\lib\\lib-tk',
'D:\\Python27',
'D:\\Python27\\Lib\\site-packages',
'D:\\Python27\\Lib\\site-packages\\requests-0.14.2-py2.7.egg',
'D:\\Python27\\Lib\\site-packages\\extract-1.0-py2.7.egg',
'C:\\Windows\\system32\\python27.zip',
'D:\\Python27\\lib\\site-packages\\setuptools-0.6c11-py2.7.egg-info',
'D:\\Python27\\Lib\\site-packages\\IPython\\extensions']`

作为@ChrisArmstrong 解决方案，这很难。
所以我单独使用 Ipython 作为替代方案。

# c# - Windows Store App Incremental Serialization

> ID：13997897
> 
> 赞同：2
> 
> 时间：2012-12-21T22:16:27.940
> 
> 标签：c#, serialization, windows-8, windows-runtime, windows-store-apps

So I finally got my listview content to serialize and write to a file so I can restore my apps state across different sessions. Now I'm wondering if there is a way I can incrementally serialize and save my data. Currently, I call this method in the SaveState method of my mainpage:

```
 private async void writeToFile()
    {
        var f = await Windows.Storage.ApplicationData.Current.LocalFolder.CreateFileAsync("data.txt", CreationCollisionOption.ReplaceExisting);
        using (var st = await f.OpenStreamForWriteAsync())
        {
            var s = new DataContractSerializer(typeof(ObservableCollection<Item>),
                                   new Type[] { typeof(Item) });
            s.WriteObject(st, convoStrings);
        }
    } 
```

What I think would be more ideal is to write out data to storage as it is generated, so I don't have to serialize my entire list in the small suspend time frame, but I don't know if this is possible to incrementally serialize my collection, and if it is, how would I do it?

Note that my data doesn't change after it is generated, so I don't have to worry about anything other than appending new data to the end of my currently serialized list.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:31:02.430

这取决于您定义何时将数据保存到硬盘驱动器。也许您想在添加或删除新的集合项时保存新的集合状态？或者当项目的内容发生变化时。

将所有内容及时保存到硬盘的主要问题是，这可能会很慢。如果您使用的是`async`编程模型，这不会直接成为问题，因为您的应用程序不会挂起，因为是的，一切都是异步的。

我认为每分钟和用户关闭应用程序时保存集合可能是一个更好的主意。这仅在您处理一定数量的数据时才有效，因为您只有大约 3 秒的时间来执行所有 IO 工作。

如您所见，没有完美的解决方案。这实际上取决于您的要求和数据的大小。没有更多信息，我可以肯定地告诉你。

# axapta - Dynamics AX 添加产品筛选器，无需零售附加功能

> ID：13997899
> 
> 赞同：0
> 
> 时间：2012-12-21T22:16:40.747
> 
> 标签：axapta, x++, microsoft-dynamics, dynamics-ax-2012, ax

从采购订单表单调用时，我需要启用添加产品表单 (RetailAddProducts) 的过滤器部分。据我了解，此功能仅适用于零售目录，但我需要绕过它。这可能吗？如果是这样，我将如何进行此调整？在 Dynamics 方面，我仍然是一名新开发人员。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T07:16:21.703

您很可能必须更改各种元素的 ConfigurationKey 才能公开该功能。这可能包括功能的菜单项、表格和字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T18:41:39.550

我能够通过修改 checkAndAddHierarchy 方法并添加一些额外的逻辑来覆盖它。不过感谢您的指点。

# installation - cannot install openx 2.8.10 localhost past register

> ID：13997900
> 
> 赞同：1
> 
> 时间：2012-12-21T22:16:43.940
> 
> 标签：installation, localhost, openx

Operating Windows7

I downloaded and unzipped Openx 2.8.10 into c:/wamp/www/

I started the OpenX installation into localhost and came to a screen: Do you already have an OpenX.org account?

There were 2 Options: I have an OpenX.org account/ I do not have an OpenX.org account

I clicked: I do not have an OpenX.org account and entered a username.

The username came up as not available.

Tried again with a different username, and again, and again. I typed in a jumble of letters and symbols. Still not available.

AHA!! I went online and registered with www.openx.org. I received an activation key via email, activated my account and successfully registered.

I started the OpenX localhost installation again.

I came to the screen: I have an OpenX.org account I do not have an OpenX.org account

I clicked:I have an OpenX.org account (!!!)

I entered my newly registered username and password and got: Invalid user name or password. Please check that the OpenX User name and password are correct. [Yes, I did check. I re-entered them several times.] If you have recently signed up for a new OpenX.org account, make sure you have gone into your email and activated your OpenX.org account.

I tried again, and again but I can't get past that registration screen.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T21:10:51.377

我意识到问题不在于激活帐户 openx.org，而在于启用了我的浏览器 Firefox 22.0a2（带有附加组件安全性）。

我的解决方案是使用实际上是 QtWeb 浏览器的浏览器和清晰的灯光（无附加组件）。

仅使用 QtWeb 浏览器即可顺利安装。

谢谢！

巴西

# android - Android app that sends and receives data from pc

> ID：13997901
> 
> 赞同：0
> 
> 时间：2012-12-21T22:16:58.217
> 
> 标签：android, flash, remote-access

So ill do my best to explain. I'm wondering how easy (or hard) it would be to make an android app that talks/sends and receives data from a PC or mac, even more so with flash.

so for example, I first make a flash application on my PC / Mac, lets say it has a MovieClip of a square on the stage. That is all for that part. Next I make and android app that consists of one button. when I press that button (on the android app, on the phone) the square on the flash desktop application moves to the right or left by ten pixels.

so ultimately the mobile app is controlling the desktop flash application.

Iv searched and searched but I'm unsure of what keywords to really use to find what im looking for.

Can anybody shed some light on how difficult this is(if its possible), or any documentation / tutorials on this subject?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:30:45.427

蓝牙标准包括一个称为[蓝牙 HID](http://en.wikipedia.org/wiki/Human_interface_device)的配置文件。如果您编写（或下载！）实现此配置文件的 Android 应用程序，然后将您的 Android 设备连接到您的 PC，它基本上就变成了蓝牙鼠标或键盘。它不需要在 PC 端进行编程，因为 Windows 和 Mac 都支持蓝牙外围设备。

在设备端实现网络协议通常是非常底层的东西。如果您的编程经验只是在 Flash 中，您可能会觉得这很困难（您可能会学到很多东西！）。幸运的是，有[Android HID](http://code.google.com/p/androhid/)库。我不知道它有多好（我刚刚为这个答案找到了它），但它看起来已经完成了，所以它可以让你不必做最困难的部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:44:21.177

您可以使用 adb 来完成此操作，这就是有多少网络共享应用程序绕过运营商限制。以下是一些来源：

Adblib 是一个“通过 USB 与 android 设备通信的库，无需 Android SDK”： [http ://code.google.com/p/adblib/](http://code.google.com/p/adblib/)

关于 Adb over USB 的主题： [http ://groups.google.com/forum/?fromgroups=#!topic/android-developers/JsDTBimHpOA](http://groups.google.com/forum/?fromgroups=#!topic/android-developers/JsDTBimHpOA)

adb 本身：http: [//developer.android.com/tools/help/adb.html](http://developer.android.com/tools/help/adb.html)

* * *

以下是其他一些 Android USB 主题的其他链接：

[http://developer.android.com/tools/adk/index.html](http://developer.android.com/tools/adk/index.html)

[http://developer.android.com/guide/topics/connectivity/usb/host.html](http://developer.android.com/guide/topics/connectivity/usb/host.html)

[http://developer.android.com/guide/topics/connectivity/usb/accessory.html](http://developer.android.com/guide/topics/connectivity/usb/accessory.html)

[http://developer.android.com/reference/android/hardware/usb/UsbInterface.html](http://developer.android.com/reference/android/hardware/usb/UsbInterface.html)

[http://developer.android.com/sdk/win-usb.html](http://developer.android.com/sdk/win-usb.html)

# html - HTML5 画布文本调整大小

> ID：13997903
> 
> 赞同：4
> 
> 时间：2012-12-21T22:17:12.927
> 
> 标签：html, canvas

这对你们大多数人来说一定很明显，很抱歉问，但是当我改变我的画布的宽度时，我的文本怎么会调整大小呢？我怎样才能防止这种情况发生？

使用的代码：

```
canvas = document.getElementById('canvas');
context = canvas.getContext('2d');
context.fillText("text",10,10); 
```

顺便说一句：在我被否决/被抨击之前，我试着搜索了大约 20 分钟……没有结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T05:32:16.683

如果您不使用 CSS 重新调整大小，您需要像这样设置[上下文字体](http://www.w3.org/TR/2010/WD-2dcontext-20100304/#dom-context-2d-font)。

**[现场演示](http://jsfiddle.net/loktar/meaU2/)**

```
var canvas = document.getElementById("canvas"),
    ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

function drawText() {
    ctx.font = 'italic 20px Calibri';
    ctx.fillText("HELLO!", 100, 100);
}

window.addEventListener("resize", function() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    drawText()
});
drawText()​ 
```

如果您使用 css 调整画布元素的大小，如下例所示

```
canvas{
    width:200px;
} 
```

那么你可以做的不多。当您使用 CSS 调整画布大小时，您只需拉伸它，但像素密度保持不变。您永远不应该使用 css 来调整画布元素的大小，而应该像我在上面的示例中那样通过 JS使用`width`and属性。`height`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T05:50:02.277

由于使用 CSS 更改属性，可能会出现此问题。当您通过 css 访问其属性时，似乎画布会重新缩放。我认为如果您在 javascript 代码中使用它而不是通过 css 更改它，您的问题可能会得到解决：

```
document.getElementById("yourCanvasId").height = 150; // height you want to change to
document.getElementById("yourCanvasId").width = 150; // width you want to change to 
```

我也发生了同样的问题。我这样做了，问题就解决了。希望能帮助到你 ！

# php - 将所有未显式路由到 CakePHP 中的特定控制器的内容路由

> ID：13997904
> 
> 赞同：0
> 
> 时间：2012-12-21T22:17:28.403
> 
> 标签：php, cakephp, url-routing

在 CakePHP 中我想做特定的路由规则（主要是出于美观和 SEO 的原因）。

因此，例如，我在代码中所做的事情是这样的：

```
Router::connect('/c/:uni.html', array('controller' => 'contents', 'action'=>'index')); 
```

现在如果有人打电话

> MY_SITE/anyController/anyAction

我不希望 CakePHP 去那里，即使这个 Controller 确实存在（当然还有动作......）

例子：

```
class AnyController extends AppController {
    var $helper = array('Html');

    /**
     * landingpage
     */
    private function anyAction() {
        //this action must not be called by /anyController/anyAction
                    //but only by my own defined route
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T11:56:38.930

正如@dogmatic69 指出的那样，复制内容的解决方案通常是一个“规范链接”标签。

在所有页面上放置这样的标签，您可以获得两全其美：保留 Cake 的默认路由，但将搜索引擎指向“正确”的 URL。

这是您在视图中插入规范链接标签的方式：

```
echo $this->Html->meta(
    'canonical',
    'http://example.com',
    array(
        'rel' => 'canonical',
        'type' => null,
        'title' => null,
        'inline' => false
     )
 ); 
```

除了`http://example.com`你可以使用 Cake 的`url()`函数，它可以将一个动作和一个控制器作为参数，并且总是返回你的自定义路由（这称为[反向路由](http://book.cakephp.org/2.0/en/development/routing.html#reverse-routing)）。

```
$this->Html->url(array(
    'controller' => 'foo',
    'action' => 'bar'
)); 
```

把它们放在一起，这应该给你你想要的：

```
echo $this->Html->meta(
    'canonical',
    $this->Html->url(array(
        'controller' => $this->request->params['controller'],
        'action' => $this->request->params['action']
    )),
    array(
        'rel' => 'canonical',
        'type' => null,
        'title' => null,
        'inline' => false
     )
 ); 
```

这会将当前视图的控制器/操作的第一个（您的首选）路由放入规范链接标记中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T14:46:20.620

只需创建一条可以捕获所有内容的路线

```
// your other routes

Router::connect('/*', array('contoler' => '...); 
```

正如评论中所指出的，这不是一个好主意。虽然它确实有用途。

# css - CSS3 flexbox 负弹性如何工作？

> ID：13997909
> 
> 赞同：7
> 
> 时间：2012-12-21T22:18:01.587
> 
> 标签：css, flexbox

我最近开始玩 CSS3 flex box，我已经阅读了很多资源并自己玩弄了它。我浏览过：[http ://www.w3.org/TR/css3-flexbox/](http://www.w3.org/TR/css3-flexbox/)

具体来说，我在子元素上的 flex 属性上遇到了问题：

```
flex: <positive-flex> <negative-flex> <preferred-size> 
```

我似乎无法理解negative-flex 参数是如何工作的。positive-flex 是有意义的，因为它将空间从父元素按比例分配给子元素。

根据我的理解，负弹性应该在元素溢出父元素时缩小元素。但是，我无法让它发挥作用。任何帮助理解将不胜感激！

这是我一直在测试的代码：http: [//jsfiddle.net/nxzQQ/2/](http://jsfiddle.net/nxzQQ/2/)

HTML：

```
<!DOCTYPE html>
<html>
<head>

</head>
<body>

<div id="container">
    <div></div>
    <div></div>
    <div></div>
</div>
</body>
</html> 
```

CSS：

```
#container {
    width: 100%;
    height: 200px;

    display: -webkit-flex;
    display: flex;

    -webkit-flex-direction: row;
    flex-direction: row;
}

#container > :nth-child(1) {
    background-color: red;

    -webkit-flex: 1 0 0px;
    flex: 1 0 0px;
}

#container > :nth-child(2) {
    background-color: blue;

    -webkit-flex: 2 0 0px;
    flex: 2 0 0px;
}

#container > :nth-child(3) {
    background-color: orange;

    -webkit-flex: 1 0 0px;
    flex: 1 0 0px;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T23:48:20.080

在一篇来自 Opera 关于 flexbox 的文章中，负 flex 是这样描述的：

```
#first {
  flex: 1 1 400px;
}

#second {
  flex: 2 3 600px;
}

#third {
  flex: 1 2 400px;
} 
```

> 负 flex 值，尽管它们的名字，是正值——上面声明中的第二个无单位值。只有当子级在主轴方向溢出其父级容器时，这些才会发挥作用。它们也充当比例值，但这次它们指定了“溢出量”（子项溢出其容器的量）的比例，该比例将从每个子项的大小中扣除，以使整体大小降低到等于父级的大小——实际上是为了阻止溢出。
> 
> 假设父容器沿主轴为 1100 像素。在这种情况下，我们上面的孩子会溢出 300 像素（它们总共等于主轴上的 1400 像素）。由于在它们上设置了负 flex 值：
> 
> *   第一个孩子将获得 1/6 的溢出量，即 50 像素。因此，它的计算值将是 350 像素。
> *   第二个孩子将获得 3/6 的溢出量，即 150 像素。因此，它的计算值将是 450 像素。
> *   第三个孩子将获得 2/6 的溢出量，即 100 像素。因此，它的计算值将是 300 像素。
> 
> 因此，较高的负 flex 值实际上会导致较小的元素！

来源： [http ://dev.opera.com/articles/view/flexbox-basics/](http://dev.opera.com/articles/view/flexbox-basics/)

# ruby-on-rails - 如何将旧帖子移动到另一个页面以存档

> ID：13997912
> 
> 赞同：0
> 
> 时间：2012-12-21T22:18:25.360
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我的网站上有一个蝙蝠侠漫画书页面[http://www.batman-fansite.com](http://www.batman-fansite.com)

我想做的是

每个月当新一期出版时，我都希望能够将漫画从最近的漫画移到旧刊，同时仍然保留该页面的所有评论和评论....

如果有人能指出我正确的方向，那将是可怕的，我不知道如何做到这一点。

继承人页面链接[http://www.batman-fansite.com/comics](http://www.batman-fansite.com/comics)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:35:19.003

这都是关于范围界定的。主页应该有这样的查询：

```
@current = Comic.order('published_at DESC').first 
```

档案是这样的：

```
@comics = Comic.order('published_at DESC').all 
```

当您有大量条目时，您最终将需要分页，但对于第一次剪辑来说，这已经绰绰有余了。随着新条目“发布”，它们将自动显示在主页上。

更强大的发布模型是您可以将`published_at`时间设置为未来的地方：

```
@current = Comic.where('published_at<=NOW()').order('published_at DESC').first 
```

你甚至可以`scope`为此做一个进一步清理它，但它具有相同的效果。

# css - 使用 CSS 背景图片作为边框失败

> ID：13997918
> 
> 赞同：1
> 
> 时间：2012-12-21T22:19:27.480
> 
> 标签：css, html, background, border

我正在尝试将图像放置在精美的边框内，以使边框覆盖图像。我已经让它几乎工作了，我希望有人能给我我需要的最后一点。在下面的示例中，如果我从主 div 容器中删除背景，则图像框架效果很好。有了背景，图像是不可见的，大概隐藏在白色容器背景后面。这是一个用于测试的 dabblat：http: [//dabblet.com/gist/4356232](http://dabblet.com/gist/4356232)

```
<style>
div {
    background: #fff;
}
a {
    width: 287px;
    height: 142px;
    display: block;
    position: relative;
    background: url(http://divisioncamera.erentalpro.com/web/list.png) no-repeat;

}
img {
    position: absolute;
    max-height: 287px;
    max-width: 142px;
    top: 0;
    bottom: 0;
    right: 0;
    left: 0;
    margin: auto;
    z-index: -1;
}
</style>
<div>
    <a>
        <img src="http://placekitten.com/300/300"/>
    </a>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:36:24.043

添加`div`

```
position: relative;
z-index: 1; 
```

# css - 以固定位置将孩子放在父母身后

> ID：13997923
> 
> 赞同：0
> 
> 时间：2012-12-21T22:19:50.273
> 
> 标签：css, position, z-index, fixed

所以这是我的问题，我有一个带有音量按钮的音乐播放器。当我按下音量按钮时，按钮下方会出现一个框。由于我的背景不是平坦的，我想把那个盒子放在背景后面。我尝试使用负 z-index，但没有奏效。你们能帮帮我吗？这是一个链接，音乐播放器在顶部屏幕上（位置固定）[http://hateittoo.com/?page=shows](http://hateittoo.com/?page=shows)

PS：该网站目前与谷歌浏览器配合得更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:53:33.970

移动`volume_controls`所以它不嵌套在`music_player`. `z-index`不能低于父元素。

```
<div id="music_player"><!-- has background image you're trying to hide controls under -->
    ... 
    <div class="content" id="volume_controls" style="display: block;">
        ...
    </div>
</div> 
```

把它塞到背景后面而不`z-index`把你的`volume_controls`元素移动到上面`music_player`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:54:24.150

你不能把孩子放在他父母的后面。您需要从播放器 div 中取出音量 div，使它们都固定，然后使用`z-index`.

# algorithm - 用于有效百分位查找的数据结构？

> ID：13997927
> 
> 赞同：14
> 
> 时间：2012-12-21T22:20:24.323
> 
> 标签：algorithm, math, data-structures, statistics, percentile

假设您有大量键/值对集合，其中值是任意实数。您有兴趣创建支持以下操作的数据结构：

*   **Insert**，向集合中添加一个新的键/值对，
*   **Delete**，从集合中删除一个键/值对，
*   **Percentile**，它告诉与给定键关联的值在哪个百分位，以及
*   **Tell-** Percentile ，它接受一个百分位数并返回其值为至少给定百分位数的最小值的键。

例如，可以使用这种数据结构来有效地确定给定学生在接收全国测试分数流时所处的百分位数，或者识别服务质量异常好或差的医院。

有没有办法让这些操作有效地运行（比如，亚线性时间？）

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-21T22:20:24.323

实现此数据结构的一种可能方法是使用[顺序统计树](http://en.wikipedia.org/wiki/Order_statistic_tree)和[哈希表](http://en.wikipedia.org/wiki/Hash_table)的混合。

顺序统计树是一种平衡二叉搜索树，除了正常的二叉搜索树操作外，还支持另外两种操作：

*   **Rank**（键），返回树中小于给定元素的元素数量，以及
*   **Select** (k)，它返回树中第 k 个最小的元素。

顺序统计树可以通过在旋转期间保留额外信息来增加正常的平衡二叉搜索树（例如，[红/黑树](http://en.wikipedia.org/wiki/Red%E2%80%93black_tree)或[AVL 树）来构建。](http://en.wikipedia.org/wiki/AVL_tree)这样，订单统计树上的所有正常 BST 操作都可以在 O(log n) 时间内运行，而额外的操作也可以在 O(log n) 时间内运行。

现在，让我们假设您纯粹存储值分数，而不是关键/百分比分数。在这种情况下，如下实现百分位查找将非常简单。将所有值存储在订单统计树中。要确定给定值的百分位分数，请使用顺序统计树上的**排名**操作来查找该值出现在哪个索引处。这给出了一个数字，范围从 0 到 n - 1（其中 n 是树中元素的数量），表示该分数在顺序统计树中的位置。然后，您可以将该数字乘以 99 / (n - 1)，以根据需要获得在 0 到 99 范围内运行的值的百分位数。

要确定大于某个百分位的最小值，可以使用如下**选择**操作。给定一个介于 0 和 99 之间的百分位数，将该百分位数乘以 99 / (n - 1) 得到一个介于 0 和 n - 1 之间的实数，包括 0 和 n - 1。取该数的上限会产生 0 到 n - 1 范围内的自然数，包括 0 到 n - 1。然后可以使用顺序统计树上的**选择操作来查找范围内等于或高于给定百分位数的第一个值。**

然而，这些操作假设我们在数据结构中有纯粹的值，而不是键/值对。为了使这个操作适用于键/值对，我们将扩充我们的数据结构如下：

1.  我们将在每个节点中存储键/值对，而不仅仅是存储值。顺序统计树将纯粹按值对键/值对进行排序，键作为卫星数据携带。
2.  我们将存储一个二级哈希表，将键映射到它们的关联值。

这两个变化使得为我们的数据结构实现所需的功能成为可能。为了让数据结构通过键进行百分位查找，我们首先使用给定的键查询哈希表以查找其关联值。然后，我们像以前一样对值进行百分位查找。为了让数据结构告诉我们一个键的值是第一个或高于给定百分位数的键，我们如上所述在顺序统计树上执行正常的 find-percentile 操作，然后查找与给定值关联的键。

如果我们假设哈希表使用链式哈希，那么每个操作所需的时间如下：

*   **插入**：将值/键对插入订单统计树的 O(log n) 时间，加上将键/值对插入哈希表的 O(1) 分摊时间。总时间为 O(log n) 摊销。
*   **删除**：从订单统计树中删除值/键对的 O(log n) 时间，加上 (1) 从哈希表中删除键/值对的摊销时间。总时间为 O(log n) 摊销。
*   **百分位数**：O(1) 预期时间来查找与键关联的值，O(log n) 时间来执行**排名**操作，以及 O(1) 额外时间来将排名映射到百分位数。预计总时间为 O(log n)。
*   **Find-** Percentile ：将百分位数映射到排名所需的 O(1) 时间，以及执行**选择**操作所需的 O(log n) 时间。总时间是 O(log n) 最坏情况。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T22:52:40.217

有一个简单而高效的可能性：

如果您只能在最终填满的学生结构中搜索百分位数，那么：

当您不知道元素的数量时，使用 ArrayList 动态构建。
如果您知道它们，则直接从数组开始，否则从动态数组创建数组。（例如java中的ArrayList）。

**插入**：不需要，替换为在末尾添加，并排序一次。
**删除**：没有必要，如果你能忍受的话。
**告诉百分位数**：更简单：非常接近：元素[长度*百分位数]：O（1）

在实践中，数组方法将比平衡树方法快得多，至少在 java 中，当您的应用程序可以构建一次数组时（例如每日学生评估，每天构建它）

我已经使用自写的 ArrayListInt 实现了（我的）上述算法，它与 ArrayList 相同，但使用原始类型（double、int）而不是对象类型。当所有数据都被读取后，我对其进行了一次排序。

此外，您还需要键值：
我只需添加一个树图（平衡树）。现在有点怀疑 TreeMap 和附加的百分位数数组是否有意义：这取决于您必须搜索的频率，以及内存使用量与搜索时间的关系。

**更新：**

结果：treeset vs sorted array（动态构建数组，然后最后排序一次：

```
num elements: 1000 treeSet: 4.55989 array=0.564159
num elements: 10000 treeSet: 2.662496 array=1.157591
num elements: 100000 treeSet: 31.642027 array=12.224639
num elements: 1000000 treeSet: 1319.283703 array=140.293312
num elements: 10000000 treeSet: 21212.307545 array=3222.844045 
```

这个数量的元素（1e7）现在接近限制（1GB 堆空间），在下一步中内存将耗尽（已经发生在 1e7，但是在树集之后清理内存，测量 1e7 的运行也有效。

缺少的是搜索时间，但是带有 binsearch 的排序数组只能被哈希表击败

**最后：** 如果您可以建立学生集一次，例如每天，那么使用数组方法可以提供更简单的百分位搜索。

# html - onChange 事件未触发

> ID：13997930
> 
> 赞同：0
> 
> 时间：2012-12-21T22:20:35.077
> 
> 标签：html, textbox, onchange

我确定此 html 中缺少某些内容。onChange 事件永远不会被触发。有人帮忙吗？？谢谢

```
<!DOCTYPE html PUBLIC "-//W3C/DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>Wake up call</title>
    <script type="text/javascript">
      function v(elementName) {    // Function is defined here
        alert(elementName);
      }
    </script>
  </head>

  <body bgcolor="lightblue">
    <form>
      <input type="text"
        value="Wake me" id="wake"
        onchange="v(wake)">
    </form>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:30:43.817

你没有一个名为`wake`. 要么将其更改为字符串：

```
 <input type="text" value="Wake me" id="wake" onchange="v('wake')"> 
```

或者如果它是一个变量，请将变量设置在某处。

# php - 在提交 joomla 表单之前获取 ID

> ID：13997932
> 
> 赞同：0
> 
> 时间：2012-12-21T22:20:42.830
> 
> 标签：php, mysql, joomla

我正在处理具有文件上传功能的表单。提交表单时，它包含几个字段，其中最重要的是 ID 和文件名。问题是我希望文件名包含 ID。因此，当我使用 ajax 上传器上传文件时，文件名将类似于：FILENAME_ID.txt

该 ID 是 joomla**将要**插入数据库的 ID。ID 将被添加到接收文件的 PHP 脚本内的文件名中。我可以从技术上查询数据库并检查最新的 ID 是什么，但我不确定这是否是正确的方法。

这样做的最佳方法是什么？

我正在使用 joomla 2.5、php 5.3 和 mysql 5.1

PS如果不可能，对不起我的愚蠢问题O:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T01:08:57.863

在插入行之前，您永远不能（安全地）预期主键的值。您将不得不插入然后使用新插入的 id 作为文件名来更新它。用于`$db->insertid()`获取连接的最后插入行的主键。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T04:32:38.200

你能做的和你要做的就是首先插入记录并获取该特定行的ID。为此，您可以使用

```
$new_id = $this->_db->insertId(); 
```

然后就可以进行文件上传了。您可以将它连接到文件名（`$file['name']`）。

如果您有任何问题，请告诉我

# c# - 资源文件中的正则表达式

> ID：13997933
> 
> 赞同：-1
> 
> 时间：2012-12-21T22:20:51.110
> 
> 标签：c#, regex, windows-runtime

我需要在资源文件中保存一个正则表达式，并且应该可以替换字符串中的第一个字符，替换特定的字符串等等

有可能这样做吗？

例如，正则表达式应该如何替换第一个字符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:34:21.857

替换第一个字符：

```
string res = Regex.Replace("text", "^.", "replacement"); 
```

替换最后一个字符：

```
string res = Regex.Replace("text", ".$", "replacement"); 
```

# jquery - 使用 jQuery 打印 JSON 值

> ID：13997934
> 
> 赞同：0
> 
> 时间：2012-12-21T22:20:58.957
> 
> 标签：jquery, json

这应该很简单，但对我不起作用:(
我正在尝试使用 jQuery 将 JSON 中的值打印到 HTML 表中。

```
$('#company1name').html(companies[0].name); 
```

jsFiddle： http: [//jsfiddle.net/S52XP/2/](http://jsfiddle.net/S52XP/2/)

知道有什么问题吗？如果我在表中提醒我需要的 JSON 元素，它就可以工作！但我无法使用 jQuery 将它用于表中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:23:59.820

为什么要使用`<script>`标签来打印名称？如果您使用跨度代替，您的 jQuery 可以工作：

```
<span id="company1name"></span> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T22:31:58.697

设置脚本标签的 html 不能按您预期的方式工作。您可以使用其他元素，例如 a `<p>`or ，在这种情况下，我只是在and节点`<span>`上设置 ID 。`<th>``<td>`

这是循环工作的jsfiddle。 [http://jsfiddle.net/S52XP/3/](http://jsfiddle.net/S52XP/3/)

如果您有 json 格式的数据，为什么不以编程方式构建表格，而不是到处使用 ID 属性呢？

# c - 如何从 C 调用 C++ 函数？

> ID：13997935
> 
> 赞同：1
> 
> 时间：2012-12-21T22:21:10.210
> 
> 标签：c, linker

> **可能重复：**
> [如何从 C 调用用 C++ 编写的库？](https://stackoverflow.com/questions/4014851/how-to-call-a-lib-written-in-c-from-c)

我正在修改[pHash](http://www.phash.org/docs/howto.html)，我想调用该函数以从文件位置生成感知散列。当我尝试调用名为 ph_dct_imagehash 的函数时，编译器会抛出此错误：

```
/usr/include/CImg.h:72:18: fatal error: cstdio: No such file or directory
compilation terminated. 
```

此时我意识到 pHash 是用 C++ 编写的，因此在 C 程序中包含 C++ 标头是行不通的。尽管如此，函数本身似乎应该可以从 C 调用，因为它的参数和返回值都没有使用 C++ 构造。有什么好方法可以从 C 调用 C++ 函数 ph_dct_imagehash？

注意：我这样做主要是为了更好地使用 C（不是 C++）。这就是我将自己限制在 C 的原因。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T22:23:34.503

只要您有一个未损坏的符号名称可以调用，您就可以很容易地将您的 C++ 库与您的 C 程序链接起来。您需要创建一个 C 安全的头文件或其他方式来转发声明函数名称，然后在最后将它们链接在一起（确保使用 C++ 感知链接器！）。

这是一个简单的例子：

```
$ cat cplusplus.cpp 
#include <string>

extern "C"
const char *cplusplusFunction(void)
{
    static std::string a = "Hello, C++";
    return a.c_str();
}
$ cat example.c 
#include <stdio.h>

const char *cplusplusFunction(void);

int main(void)
{
    printf("%s\n", cplusplusFunction());
    return 0;
}
$ c++ -c -o cplusplus.o cplusplus.cpp
$ cc -c -o example.o example.c 
$c++ -o example example.o cplusplus.o
$ ./example 
Hello, C++ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T22:28:39.950

您需要将 C++ 代码函数与 C 代码分开。

通常，这是通过拥有一个仅包含 C（非 C++）函数声明和解决问题所需的 C 数据结构的 .h 文件以及一个包含 C 到 C++ 接口函数的 C++ 文件来完成的。

您还需要使用

```
#ifdef __cplusplus
extern "C" {
#endif
.... your types and functions ... 
#ifdef __cplusplus
}
#endif 
```

在您的头文件中，以确保 C++ 编译器不会“破坏”名称（在函数名称中标记参数的类型，例如函数 Blur(int x, int y) 可能被称为 _Blur_ii，其中常规C 不会在函数名称上添加这种“额外的东西”，因此 C 编译器会调用 _Blur - 当然，当您尝试链接时，链接器会显示“找不到 _Blur”。

编辑：此外，绝对 100% 确保您没有异常“泄漏”到 C 代码中。如果你这样做了，任何事情都可能发生，而且通常不是从天而降的金子，而是一些坏事...... :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:26:27.437

如果您使用 C++ 编译器（例如 g++ 而不是 gcc），您可以从 C 代码无缝调用 C++ 代码，一切都会正常工作。情况就是这样，因为除非你在做一些非常奇怪的事情，否则 C 包含在 C++ 中。

而且如果用g++编译还是不行的话，应该把文件后缀从.c改成.cc、.cpp、.cxx等。最好是.cc

# r - 将具有多个线元素的 SpatialLinesDataframe 转换为 R 中的 KML

> ID：13997936
> 
> 赞同：4
> 
> 时间：2012-12-21T22:21:17.620
> 
> 标签：r, openstreetmap, kml, maptools, osmar

我尝试将具有多行的空间对象（从 OSM 检索到的河流）转换为 KML。对于具有单线的对象，使用 kmlLine 很容易。但是，对于多行，以下方法不起作用，我尝试从[文档](http://www.inside-r.org/packages/cran/maptools/docs/kmlLine)中调整示例是徒劳的：

```
# get OSM data:
library(osmar)
library(maptools)

salzach <- get_osm(relation(408582), full = T)
sp_salzach <- as_sp(salzach, what = "lines")

# convert to KML:
kmlLine(sp_salzach, "salzach.kml", lwd = 3, col = "blue", name = "Salzach")
Warning:
In kmlLine(sp_salzach, "salzach.kml", lwd = 3, col = "blue", name = "Salzach") :
  Only the first Lines object with the ID '23633534' is taken from 'obj'

# shell.exec("salzach.kml") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T02:10:39.803

As it says in the Details of `?kmlLine`, if you provide a `spatialLinesDataFrame` as first argument, it will use only the first element of the `spatialLinesDataFrame` object. Since

```
 sp_salzach@data$id[1]
 [1] 23633534 
```

this is the Lines object with the above ID, therefore the warning. `sp_salzach` contains 74 Lines objects, not 1\. If you want to apply `kmlLines` to each of these lines you would need to do sth. like this:

```
for( i in seq_along(sp_salzach) ) {

    kmlLine(sp_salzach@lines[[i]], kmlfile = paste0("salzach", i, ".kml"), 
            lwd = 3, col = "blue", name = paste0("Salzach", i))

} 
```

This will create 74 `.kml` files in your working directory, one for each Lines object in `sp_salzach`, although I'm not sure if this is what you want.

**EDIT:**

If you don't adapt the name in each iteration, you get all lines in one file, at least if opened with google earth it seems to work, i.e.:

```
for( i in seq_along(sp_salzach) ) {

        kmlLine(sp_salzach@lines[[i]], kmlfile = "salzach.kml", 
                lwd = 3, col = "blue", name = "Salzach")

} 
```

# javascript - 在页面加载时显示模式窗口

> ID：13997937
> 
> 赞同：1
> 
> 时间：2012-12-21T22:21:18.243
> 
> 标签：javascript, jquery, modal-dialog

我知道这个问题已经被问过很多次了，但由于我的 JS 知识几乎为零，我似乎无法让它发挥作用。

我正在使用[Zebra Dialog](http://stefangabos.ro/jquery/zebra-dialog/) jquery 插件来制作一个模式窗口，我想在页面加载时打开它。

Zebra Dialog 网站上的所有示例仅说明了如何在单击链接时加载模式，但我似乎无法让它在页面加载时加载。

我现在正在使用以下代码：

```
<script type="text/javascript">
    $(document).load(function() {

    // show a dialog box when clicking on a link
    $(anchor).bind('click', function(e) {
        e.preventDefault();
        $.Zebra_Dialog('The link was clicked!');
    });

 });

</script> 
```

我知道我在单击链接时使用代码来加载模式，但是我尝试了很多东西，但没有找到成功修改它以在页面加载时加载的方法。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:24:46.457

也许不包括 jQuery？你需要 jQuery，然后是你的插件 js/css `<head>`：

```
<script type="text/javascript" src="path/to/jquery.js"></script>
<script type="text/javascript" src="path/to/zebra_dialog.js"></script>
<link rel="stylesheet" href="path/to/zebra_dialog.css" type="text/css"> 
```

然后是加载代码`<body>`（在脚本标签中或从文件中加载）

```
$(document).ready(function() {
    $.Zebra_Dialog('Page loaded!');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:27:29.910

我会尝试：

```
$(document).ready(function() {
    $.Zebra_Dialog('Page loaded!');
}); 
```

这基本上意味着一旦文档准备好（即加载），打开您的模式对话框。以前您的代码说，当文档准备好时，将处理程序附加到某个元素的单击事件（不确定代码中的“锚”是什么），然后在该事件处理程序中打开对话框。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:23:36.700

```
$(document).load(function() {

   $.Zebra_Dialog('The link was clicked!');

}); 
```

# arrays - 数组作为 PSObject 成员 powershell

> ID：13997938
> 
> 赞同：0
> 
> 时间：2012-12-21T22:21:19.020
> 
> 标签：arrays, powershell

我正在尝试删除我认为是 PSObject 成员的数组元素。

```
$obj = New-Object psobject
$obj | Add-Member -MemberType NoteProperty -Name member -Value @()
$obj.member += $null
$obj.member[0] = "A"
$obj.member += $null
$obj.member[1] = "B" 
```

到目前为止，一切都很好。$obj.member 的行为就像一个数组，因为我可以调用单个元素并使用 -join 转换为字符串。但是，当我尝试删除一个元素时，我发现 $obj.member 根本不是一个数组。$obj.member|gm 告诉我它是一个字符串，当我调用 $obj.member.removeRange() 时，我收到一个错误：说明：[System.Object[]] 不包含名为“removeRange”的方法。

所以..它看起来像一个字符串，行为像一个数组，实际上是一个对象。

我的印象是，如果我将对象的 NoteProperty 类型成员的值定义为 @()，则该成员将是一个数组——显然这不是真的，但我从未想过，因为我能够加入元素。

请解释这里发生了什么。

最终，我试图让一个 Object 成员成为一个数组，这样我就可以添加和删除元素。

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:22:58.063

您正在正确添加成员，它确实是一个数组。

> $obj.member | gm 告诉我这是一个字符串

管道`Get-Member`展开任何集合并显示有关集合*内*对象的信息，而不是集合本身。例如，`1,2,3 | gm`告诉我关于`int`类型的成员。如果我想了解集合本身，您可以这样做：

```
,(1,2,3) | gm
,$obj.Member | gm 
```

> 当我调用 $obj.member.removeRange() 时，出现错误

这是因为数组类型没有`RemoveRange`方法，当您通过管道传递到`gm`. 另请参阅`System.Array` [此处](http://msdn.microsoft.com/en-us/library/system.array_methods%28v=vs.100%29.aspx)的文档。

# tree - 在二叉未排序树中查找路径

> ID：13997939
> 
> 赞同：1
> 
> 时间：2012-12-21T22:21:48.490
> 
> 标签：tree, binary-tree

我需要帮助找到从根到未排序二叉树中节点的路径。我正在尝试预先遍历并推送堆栈中的节点，但我总是得到比实际路径更多的节点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:31:17.060

这样做的一个好方法是在每个节点中保留一个父节点的引用，然后如果您可以访问节点构建路径很容易，只需要遍历所有父节点并构建路径。如果您无法访问该节点并且您唯一拥有的是树根，那么您需要在所有可能的子树中搜索，这是因为树是未排序的。然后，您可以对 DFS（深度优先搜索）使用预排序、后排序、有序，或者使用队列实现一些 BFS（广度优先搜索）。

希望这可以帮助你...

# ajax - 如何将var附加到ajax帖子中的URL

> ID：13997942
> 
> 赞同：0
> 
> 时间：2012-12-21T22:22:17.010
> 
> 标签：ajax, function, jquery, append

循环使用 var westring 给了我最后一个 li。有没有办法将其附加或附加到帖子 URL？

```
 $(document).ready(function() {

    var westring = '0';

    $('#infinite_topic_scroll').scrollLoad({ 
    url : '/challenges_side.php?f=hh&start_res='+westring+'&v=y', 
    getData : function() {  },
    start : function() { $('<div class="loading"><img src="/images/ajax-loader.gif"/></div>').appendTo(this); },
    ScrollAfterHeight : 95,
    onload : function( data ) {
    $(this).append( data );
    $('.loading').remove();     
    },
    continueWhile : function( resp ) {

    var westring = ($(this).children('li').length);

    // alert(westring);

    if( $(this).children('li').length >= 100 ) { return false; }
    return true;
        }
        }); 
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:32:06.037

去掉 continueWhile 函数中的 var。您已经将 var 放在上述范围内。另外，我会将它转换为字符串。它应该只是

```
westring = $(this).children('li').length.toString() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:42:45.190

我在您专门使用的插件上找不到太多内容，但我认为您正在寻找的是...

```
getData : function() {  } 
```

尝试这样的事情......

```
[...]
url : '/challenges_side.php', 
getData : function() 
{  
    return {
        "f" : "hh",
        "v" : "y",
        "start_res" : $(this /* or element selector */).children('li').length.toString()
    };
},
[...] 
```

我可能是错的，但值得一试

# actionscript-3 - 来自本地 XML 文件的 FB 4.6 数据服务 - 如何前进到下一条记录？

> ID：13997944
> 
> 赞同：0
> 
> 时间：2012-12-21T22:22:18.650
> 
> 标签：actionscript-3, apache-flex, flash-builder

我正在使用 flash builder 4.6 并正在构建一个测验应用程序，其中向用户显示来自本地 XML 文件的问题和答案选项。正在使用数据/服务加载 XML（尽管我最初考虑使用另一种方法）...

如果我有如下代码，我如何通过 xml “前进”：

```
label2.text = "{getDataResult.lastResult[0].Text}"; 
```

具体来说，我如何 a) 根据代表数组的节点的名称获取记录的总数。那么在我有了那个整数之后，我该怎么做

b) 将 1 添加到 0 以遍历所有记录？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T13:44:19.373

如果不了解您的 XML 数据结构，就无法为您提供帮助。

通常，您通常会将 XML 存储到[XMLList](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/XMLList.html)或[XMLListCollection](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/collections/XMLListCollection.html)中。我推荐一个 XMLListCollection，因为在使用 Spark 列表时需要一个集合类。MX 列表会自动将 XML 或 XMLList 转换为 XMLListCollection。

从那里，您可以使用标准访问器获取特定项目，例如[getItemAt()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/collections/ListCollectionView.html#getItemAt%28%29)。

# jquery - 按类查找所有元素并用不同的值克隆它们

> ID：13997946
> 
> 赞同：4
> 
> 时间：2012-12-21T22:22:28.383
> 
> 标签：jquery, clone

我正在尝试创建我的第一个 chrome 扩展。基本上我想在当前加载的文档中搜索所有类名为“child”的链接。我需要检索每个链接的 href 值。然后我想将它克隆到另一个名为“child_two”的类中。在新克隆的元素上，href 将被替换为修改过的元素。

这是目标文档。

```
<div class="parent">
    <a href="http://www.example1.com" class="child">name1</a>
</div>
<div class="parent">
    <a href="http://www.example2.com" class="child">name2</a>
</div>
<div class="parent">
    <a href="http://www.example3.com" class="child">name3</a>
</div>
<div class="parent">
    <a href="http://www.example4.com" class="child">name4</a>
</div>
<div class="parent">
    <a href="http://www.example5.com" class="child">name5</a>
</div> 
```

我希望结果是这样的。

```
<div class="parent">
    <a href="http://www.example1.com" class="child">name1</a>
    <a href="preview.php?link=http://www.example1.com" class="child_two">preview</a>
</div>
<div class="parent">
    <a href="http://www.example2.com" class="child">name2</a>
    <a href="preview.php?link=http://www.example2.com" class="child_two">preview</a>
</div>
<div class="parent">
    <a href="http://www.example3.com" class="child">name3</a>
    <a href="preview.php?link=http://www.example3.com" class="child_two">preview</a>
</div>
<div class="parent">
    <a href="http://www.example4.com" class="child">name4</a>
    <a href="preview.php?link=http://www.example4.com" class="child_two">preview</a>
</div>
<div class="parent">
    <a href="http://www.example5.com" class="child">name5</a>
    <a href="preview.php?link=http://www.example5.com" class="child_two">preview</a>
</div> 
```

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:24:44.877

```
$("a.child").each(function (index, elem) { 
    $(elem).clone()
        .attr("href", "preview.php?link=" + $(elem).attr("href")).attr("class", "child_two").text("preview").appendTo($(elem).parent());
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:34:56.600

```
$("a.child").each(function(){
    var newLink = $(this).clone();
    $(newLink).attr("href", "preview.php?link=" + $(this).attr("href"));
    $(newLink).attr("class", "child_two");
    $(newLink).text("Preview");
    $(newLink).insertAfter(this);
}); 
```

[http://jsfiddle.net/bkU4r/2/](http://jsfiddle.net/bkU4r/2/)

已更新 - 我没有注意到您希望第二个链接阅读“预览”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:32:35.153

您可以使用 after() 的函数来完成

```
$('.parent a.child').after(function() {
    var $el = $(this);
    return $el.clone().attr({
        'href': 'preview.php?link=' + $el.attr('href'),
        'class': 'child_two'
    }).text('preview');
});​ 
```

[http://jsfiddle.net/3MFEu/](http://jsfiddle.net/3MFEu/)

# c - 可以不轮询 FreeRTOS taskGetTickCount() 吗？

> ID：13997953
> 
> 赞同：4
> 
> 时间：2012-12-21T22:22:48.247
> 
> 标签：c, embedded, freertos

我想我要么 a) 误解了 FreeRTOS taskGetTickCount() 函数的工作方式，要么 b) 我们的端口不太正确。

我有一些调试，我正在显示 xTaskGetCount() 的输出。每当我完成 vTaskDelayUntil() 时，它似乎都已更新并且是最新的。但是如果我做一个旋转等待，等待它增加，它永远不会。我*认为*中断会触发并增加该值。但我目前只运行一项任务，所以也许它足够聪明，永远不会检查重新安排并且 tickCount 永远不会更新？任何可以让我直接了解 FreeRTOS 滴答计数如何工作的人，我都会非常感激。

编辑：示例片段：

```
void someTask(void * _)
{
    portTickType now = xTaskGetTickCount();
    for( ; xTaskGetTickCount() - now < 25; )
    {
        debug("%u", xTaskGetTickCount();
    }
} 
```

这将永远旋转，远远超过 tick = 1 ms 时暗示的 25 ms。输出将一遍又一遍地不断列出相同的值。如果我在循环底部添加一个 vTaskDelay() ，它会健康地增加，并最终退出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T08:41:57.560

你没有说你正在使用哪个端口。从根本上讲，您的代码没有任何问题，尽管做这种事情是不寻常的。循环永远不会阻塞，因此它将使任何执行时间的所有低优先级任务饿死，并将与具有相同优先级的任务进行时间切片。

以下是一些注意事项：

更好的解决方案是解决这个问题：

```
while( whatever )
{
    vTaskDelay( 25 );
    DoSomething();
} 
```

`debug()`不是 FreeRTOS 声明，我不知道它是如何实现的。如果您使用的是某种半托管，那么调用 debug() 可能会在很长一段时间内停止处理器的执行（您没有说是哪个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-20T12:53:37.253

> *vTaskDelay(25);*

好吧，你有什么建议？！这不是解决方案！VTaskDelay() 是一个函数，它在从调用 vTaskDelay() 开始计算的一段时间内将任务转换为锁定状态。

VTaskDelayUntil () - 这个函数提供一个指定周期的循环执行。

> 循环永远不会阻塞，因此它将使任何执行时间的所有优先级任务都饿死，并将与具有相同优先级的任务进行时间切片。

函数vTaskDelayUntil()专门用来避免这种情况！比如我不能把这个拐杖和vTaskDelay()函数放在一起，因为代码很关键，xTaskGetTickCount()函数总是返回0。我也解决不了这个问题((

几个小时后的折磨：

```
void StartTask01(void const * argument)
{
  portTickType xLastWakeTime;
  xLastWakeTime = xTaskGetTickCount();
  const portTickType xPeriod = pdMS_TO_TICKS(100);

  while(1)
  {
    canInterviewMC_100();                       // Interview CAN Message
    vTaskDelayUntil(&xLastWakeTime, xPeriod);
  }
} 
```

因此，此代码每 100 毫秒执行一次。同时，它的优先级最高，但是对于低优先级的任务，这个任务不会占用 CPU 时间，因为它每 100ms 只执行一次。

# android - LibGDX And roid SpriteBatch 不绘图

> ID：13997962
> 
> 赞同：2
> 
> 时间：2012-12-21T22:23:42.627
> 
> 标签：android, libgdx

> **可能重复：**
> [LibGDX：Android SpriteBatch 未绘制](https://stackoverflow.com/questions/13998369/libgdx-android-spritebatch-not-drawing)

我很难让 spriteBatch 在 LibGDX 中呈现。它显示了我何时在桌面上运行它，但在 Android 上却没有。我要渲染的精灵是星星背景。

桌面： ![在此处输入图像描述](../Images/e2edea751bd84aa4cc61513d655c11d7.png)

安卓： ![在此处输入图像描述](../Images/a1e283090f35f38c0d1898360464663e.png)

这是我的代码：

```
@Override
public void render(float delta) {
    Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
    Gdx.gl.glClearColor(0, 0, 0, 1);

    update(delta);

    spriteBatchBack.begin();
    sprite.draw(spriteBatchBack);
    spriteBatchBack.end();

    stage.act(delta);
    stage.draw();
}

public void update(float delta) {
    scrollTimer += delta * 0.03f;
    if (scrollTimer > 1.0f)
        scrollTimer = 0.0f;

    sprite.setU(scrollTimer);
    sprite.setU2(scrollTimer + 1);
}

int width = Gdx.graphics.getWidth();
int height = Gdx.graphics.getHeight();

@Override
public void resize(int width, int height) {
    if (stage == null) {
        stage = new Stage(width, height, true);
        stage.clear();
        addMusic();
        addBackground();
        addScence();
        stage.addActor(play);
        stage.addActor(options);
        stage.addActor(quit);
        stage.addActor(logoHead);
        stage.addActor(lblPlay);
        stage.addActor(lblOptions);
        stage.addActor(lblQuit);
    }
    Gdx.input.setInputProcessor(stage);
}

public void addBackground() {
    spriteBatchBack = new SpriteBatch();
    Texture spriteTexture = new Texture(
            Gdx.files.internal("pictures/menuBackground.png"));

    spriteTexture.setWrap(TextureWrap.Repeat, TextureWrap.Repeat);
    sprite = new Sprite(spriteTexture, 0, 0, spriteTexture.getWidth(), spriteTexture.getHeight());
    sprite.setSize(width, height);
} 
```

如果我遗漏了任何重要的内容，请发表评论并告诉我。谢谢！

# asp.net - Visual Studio 2012 包管理器控制台名称不能以“<”字符开头

> ID：13997963
> 
> 赞同：2
> 
> 时间：2012-12-21T22:23:43.530
> 
> 标签：asp.net, .net, visual-studio-2012, nuget

有没有人遇到过这个问题或者可以帮助找出这个错误的来源？当我加载项目时（它只发生在这个项目上，我的其他项目都没有），PM 在控制台中给我这个错误：

**名称不能以“<”字符开头，十六进制值 0x3C。第 1 行，位置 2。**

我在 Visual Studio 2012 中为 .net 4 运行 MVC4。这仅在我更新 nuget 包管理器后才开始发生。结果，我无法运行任何 EF 迁移命令来更新数据库。

PMC 在启动项目后立即显示错误。我试图在我的域和 Web 项目中选择“管理 nuget 包”。域项目运行良好，但我在 Web 项目的“已安装包”和“更新”选项卡中看到了同样的错误。如果我从 packages.config 中删除条目，则它不再显示错误并且说没有。但是，除了 install-package 之外，我仍然无法在 PMC 上运行任何命令。即使尝试运行 update-package 也会给我：

**更新包：名称不能以“<”字符开头，十六进制值 0x3C。第 1 行，位置 2。**

我试图检查所有我能找到的 xml、设置和 xml 文件，但没有发现任何异常或损坏。有谁知道我如何追踪这个错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T23:53:57.763

当您最初在 Visual Studio 中打开解决方案时，任何已安装的包都将运行包中的“Init.ps1”脚本（如果有的话）。

听起来 EF 包可能是罪魁祸首，从记忆中我知道它有一个 Init.ps1，因此可能值得完全删除该包（手动，只需删除所有内容）并重新安装它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-06T13:06:32.537

对我来说，这是因为 Topshelf（我认为是 3.1.2 版）包而发生的。通过从 Packages 文件夹中删除它，然后重新构建并允许 Nuget 重新获取它来解决它。

# emacs - 奇怪的 Emacs Tramp Fix

> ID：13997965
> 
> 赞同：9
> 
> 时间：2012-12-21T22:24:03.873
> 
> 标签：emacs, tramp

我正在远程主机上编辑文件并点击`C-x C-s`，突然 Emacs 冻结了。那天早些时候它一直在工作；仅在十分钟前，我在同一会话中从另一个缓冲区保存。击中`C-g`将它从挂起状态中拉出来，但它不再保存了。本地机器是 OS X Leopard，远程机器是 FreeBSD 7.4，Emacs 是 OS X 的预编译下载 24.1 (9.0)。

我做了`M-x tramp-cleanup-all-connections`并再次尝试。没运气。我尝试了很多事情，包括关闭我的工作站和重新启动 emacs。

跳到最后，我在 .emacs 中更改了以下行：

```
(setq tramp-verbose 10); had been 3 
```

我想这样我会得到一些很好的调试信息。所以我重新启动，并试图编辑一个远程文件，我想我会在 *debug tramp/ssh ...* 缓冲区中看到一些东西。

瞧，我能够再次编辑远程文件。

我重置`tramp-verbose`为 3，重新启动，然后再次挂起流浪汉。我把它切换回10，一切正常。即使我设置`tramp-debug-buffer`为`nil`.

有人知道为什么会这样吗？真正让我犹豫的是，在几个月的无故障编辑之后，Emacs 突然停止工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T18:54:09.847

在[stsquad 关于 auto-save 的警告](https://stackoverflow.com/a/16691894/834250)之后，我想我会分享`~/.emacs`禁用自动保存的设置（来自 ）：

```
;; Tramp (http://www.emacswiki.org/emacs/TrampMode) for remote files
(require 'tramp)
(add-to-list 'tramp-remote-path 'tramp-own-remote-path)
(setq tramp-default-method "ssh")
;; Backup (file~) disabled and auto-save (#file#) locally to prevent delays in editing remote files
(add-to-list 'backup-directory-alist
             (cons tramp-file-name-regexp nil))
(setq tramp-auto-save-directory temporary-file-directory)
(setq tramp-verbose 10) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T12:33:08.877

流浪模式很好，但是当 emacs 做其他事情时它有时会引入延迟。两个最大的罪魁祸首是自动保存和 vc 模式。如果这些开始运行并且您的连接速度很慢，这可能会锁定一段时间。你最好的选择是（setq tramp-verbose 5），看看在“冻结”期间流浪汉在做什么。

# php - 检索 facebook 用户 ID ？是否需要签名请求？

> ID：13997966
> 
> 赞同：0
> 
> 时间：2012-12-21T22:24:21.297
> 
> 标签：php, facebook, sdk

我正在阅读有关创建 facebook 应用程序的 facebook 教程，

[http://developers.facebook.com/docs/appsonfacebook/tutorial/](http://developers.facebook.com/docs/appsonfacebook/tutorial/)

这是他们提供给我的代码。他们说在用户接受我的应用程序检索其信息的权限后立即运行它。

```
 <?php 

     $app_id = "YOUR_APP_ID";

     $canvas_page = "YOUR_CANVAS_PAGE_URL";

     $auth_url = "http://www.facebook.com/dialog/oauth?client_id=" 
            . $app_id . "&redirect_uri=" . urlencode($canvas_page);

     $signed_request = $_REQUEST["signed_request"];

     list($encoded_sig, $payload) = explode('.', $signed_request, 2); 

     $data = json_decode(base64_decode(strtr($payload, '-_', '+/')), true);

     if (empty($data["user_id"])) {
            echo("<script> top.location.href='" . $auth_url . "'</script>");
     } else {
            echo ("Welcome User: " . $data["user_id"]);
     } 
 ?> 
```

在教程中，他们说在用户接受您的应用程序后运行代码。这是我唯一一次能够获得用户 ID 吗？？？是否有必要拥有signed_request 或者我可以在他们已经接受我的应用程序权限后检索它

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:11:30.427

我如何解决它是这样的。Facebook 应用程序总是要求提供画布 URL（安全和非安全）。我创建了一个启动 url，当用户进入我的页面时，他们总是输入启动 url。这是我设置以下代码的地方。一旦我获得 user_id，我将其设置为会话并将它们重定向到应用程序的仪表板。在那里我可以检索用户 ID 并做我想做的事。

`www.yourwebsite.com/initiate/`

```
 $app_id = "YOUR_APP_ID";

 $canvas_page = "YOUR_CANVAS_PAGE_URL";

 $auth_url = "http://www.facebook.com/dialog/oauth?client_id=" 
        . $app_id . "&redirect_uri=" . urlencode($canvas_page);

 $signed_request = $_REQUEST["signed_request"];

 list($encoded_sig, $payload) = explode('.', $signed_request, 2); 

 $data = json_decode(base64_decode(strtr($payload, '-_', '+/')), true);

 if (empty($data["user_id"])) {
        echo("<script> top.location.href='" . $auth_url . "'</script>");
 } else {
        $data["user_id"];//Set the data to a session or db then redirect user to the page
         //you want them to be
 } 
```

# r - 从两个 R 数据帧之间的动作时间获取访问时间

> ID：13997969
> 
> 赞同：1
> 
> 时间：2012-12-21T22:24:42.473
> 
> 标签：r, dataframe

我想弄清楚用户访问时发生了什么 profile.views 。用户由对 uid,state 唯一标识。该数据存储在两个数据帧中。

```
visits = data.frame(id=2001:2004, uid=c(1001,1002,1001,1001), state=c('CA','CA','CA','MA'), ts=c(51,52,53,54))
profile.views = data.frame(id=3001:3004, uid=c(1001,1003,1002,1001), state=c('CA','CA','CA','CA'), ts=c(51,57,59,59))

> visits
    id  uid state ts
1 2001 1001    CA 51
2 2002 1002    CA 52
3 2003 1001    CA 53
4 2004 1001    MA 54

> profile.views
id  uid state ts
1 3001 1001    CA 51
2 3002 1003    CA 57
3 3003 1002    CA 59
4 3004 1001    CA 59 
```

对于每个 profile.view，我想弄清楚它来自哪个访问。这是通过使用匹配的 uid 和状态的 ts 小于或等于 profile.views 行上的 ts 的最近访问来完成的。

这是我想要的结果（以某种形式）：

profile.views[1,] 来自于访问[1,]

profile.views[2,] 不是来自任何访问（这可能是由数据记录错误引起的）

profile.views[3,] 来自于访问[2,]

profile.views[4,] 来自于访问[3,]

有谁知道这样做的好方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T02:20:37.410

使用 SQL 风格的语法`sqldf`：

```
library(sqldf)
sqldf("
SELECT a.id, a.uid, a.state, a.ts, MAX(b.ts) AS visit_ts
FROM \"profile.views\" AS a
LEFT OUTER JOIN visits AS b
ON a.uid = b.uid
AND a.state = b.state
AND a.ts >= b.ts
GROUP BY a.id, a.uid, a.state, a.ts
ORDER BY a.id
") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T16:07:39.247

一种更快的`data.table`方法，它将个人资料视图与访问 ID 匹配：

```
visits = data.frame(id=2001:2004, uid=c(1001,1002,1001,1001), state=c('CA','CA','CA','MA'), ts=c(51,52,53,54))
profile.views = data.frame(id=3001:3004, uid=c(1001,1003,1002,1001), state=c('CA','CA','CA','CA'), ts=c(51,57,59,59))
visits <- data.table(visits)
profile.views <- data.table(profile.views)
setkey(visits,uid,state,ts)
#orders columns so that joins are on first three columns
setcolorder(profile.views,c("uid","state","ts","id"))
##set names to avoid name collision
setnames(profile.views,c("uid","state","view.ts","view.id"))
##rolling join
visits[profile.views,roll=TRUE]
    # uid state ts   id view.id
# 1: 1001    CA 51 2001    3001
# 2: 1003    CA 57   NA    3002
# 3: 1002    CA 59 2002    3003
# 4: 1001    CA 59 2003    3004 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:09:04.603

这是一个`data.table`解决方案。有一些事情可能可以做得更好，但这是第一次通过。

```
library(data.table)
visits <- data.table(visits)
profile.views <- data.table(profile.views)
##renames some columns to avoid name collision
##there's probably a better solution to this
setnames(profile.views,c("id","ts"),c("view.id","view.ts"))
setkey(visits,uid,state)
setkey(profile.views,uid,state)
##outer joins visits to profile.views by uid and state
##leaving NA if a row in profile.views has no matches
#visits[profile.views] 
##filters out rows where views happen before visits
#visits[profile.views][view.ts >= ts | is.na(ts)] 
##picks the latest visit timestamp by view
visits[profile.views][view.ts >= ts | is.na(ts), 
  list(visit.ts=max(ts)), 
  by=list(view.id,uid,state,view.ts)][order(view.id)]
#    view.id  uid state view.ts visit.ts
# 1:    3001 1001    CA      51       51
# 2:    3002 1003    CA      57       NA
# 3:    3003 1002    CA      59       52
# 4:    3004 1001    CA      59       53 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-27T04:59:46.870

使用基数 R`merge`和`aggregate`：

```
visits = data.frame(id=2001:2004, uid=c(1001,1002,1001,1001), state=c('CA','CA','CA','MA'), ts=c(51,52,53,54))
profile.views = data.frame(id=3001:3004, uid=c(1001,1003,1002,1001), state=c('CA','CA','CA','CA'), ts=c(51,57,59,59))
##merges data frames based on uid and state
newdf.merged <- merge(visits,profile.views, by=c("uid","state"),all.y=TRUE)
##puts unmatched rows into another dataset
newdf.na <- with(newdf,newdf[is.na(ts.x),])
##filters views that happened after visits (like WHERE)
newdf.filter <- with(newdf,newdf[ts.y >= ts.x,])
##aggregates using the max function, selecting max id and ts
newdf.agg <- aggregate(cbind(id.y,ts.y) ~ uid + state + id.x + ts.x, data = newdf.filter, FUN = max)
##merges aggregated result and na rows
newdf.final <- rbind(newdf.agg,newdf.na)
##optional ordering step
newdf.final <- newdf.final[with(newdf.final,order(uid,state,id.x)),] 
```

# javascript - 使用扩展或 js 将 href 代码注入 chrome 上的 facebook 页面

> ID：13997972
> 
> 赞同：0
> 
> 时间：2012-12-21T22:24:59.837
> 
> 标签：javascript, facebook, google-chrome, html

我在 facebook 上管理一个小组，禁止发布违规帖子的人非常困难。您需要在禁止列表中搜索他们的名字，然后等待结果完成。单击齿轮图标，然后删除用户/禁令。现在我要做的是扩展 chrome，使其具有更简单的禁止按钮。我为 chrome 控制台手动修补了此代码

```
<div class="UFICommentContent" 
id=".reactRoot[77].[1][2][1]{comment393093797435268_406224232788891}.0.[1].0.[1].0.[0]">
<a href="http://www.facebook.com/josh.e.mason.5" 
   data-hovercard="/ajax/hovercard/hovercard.php?id=1207160525" 
   data-ft="{&quot;tn&quot;:&quot;;&quot;}" 
class="UFICommentActorName" 
id=".reactRoot[77].[1][2][1]{comment393093797435268_406224232788891}.0.[1].0.[1].0.[0].[0][0]" 
aria-owns="js_14" 
aria-controls="js_14" 
aria-haspopup="true">Josh Elijah Mason</a>
<span id=".reactRoot[77].[1][2][1]{comment393093797435268_406224232788891}.0.[1].0.[1].0.[0].[0][1]"> 
</span>
<span data-ft="{&quot;tn&quot;:&quot;K&quot;}" 
id=".reactRoot[77].[1][2][1]{comment393093797435268_406224232788891}.0.[1].0.[1].0.[0].[0][2]">
<span class="UFICommentBody" id=".reactRoot[77].[1][2][1]{comment393093797435268_406224232788891}.0.[1].0.[1].0.[0].[0][2].0">
<span id=".reactRoot[77].[1][2][1]{comment393093797435268_406224232788891}.0.[1].0.[1].0.[0].[0][2].0.[0]">Hello nicole
</span>
</span>
</span>
</div> 
```

在此代码的名称之前包含此代码另一个按钮

```
<a href=".
<a class="itemAnchor" href="/ajax/groups/members/remove.php?group_id=392480624163252&amp;uid=100001756455088" rel="dialog-post" role="menuitem" title=""><span class="itemLabel">[x]</span></a> 
```

这将导致像这样“ [x] Sample User” 单击 x 将导致禁止弹出通知。我的问题是创建一个代码来搜索用户 ID 并将其放入该代码中，并为每个 facebook 用户在他们的帖子中插入一个组中的代码。这样会更容易禁止。

[http://i.stack.imgur.com/UNFhm.png](http://i.stack.imgur.com/UNFhm.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:32:37.673

如果您将其实现为用户脚本 (GreaseMonkey)，您可以在所有浏览器中使用它。在脚本中，您可以检查 URL，如果 URL 与您的 FB 组页面相对应，则使用 jQuery，您可以在用户名之前添加该代码：`$("selector-for-user-name").before("<your-code-from-above>");`

实际上，我建议使您的代码通用，在用户名前面添加一个按钮，添加一个单击事件处理程序，您可以在其中检索单击按钮旁边的用户名并调用您的方法。

如果您还有任何问题，请发表评论。

# python - python：读入表并将每列转换为正确的数据类型

> ID：13997973
> 
> 赞同：2
> 
> 时间：2012-12-21T22:25:16.383
> 
> 标签：python

假设我有一个文本文件，如下所示：

```
3, 4.32, hi
7, 3.23, hello 
```

当我读入这个文件时，所有条目都被视为字符串。有没有办法让它们（在我的示例中）自动转换为 int、float 和 string？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T22:39:16.023

一种原始方法：

```
def guess(text):
    for t in text.split(','):
        for typ in (int, float, str):
            try:
                yield typ(t)
                break
            except ValueError as e:
                pass

d = '3, 4.32, hi'

print list(guess(d))
# [3, 4.32, ' hi']
# [<type 'int'>, <type 'float'>, <type 'str'>] 
```

但是 - 如果您知道类型应该是什么，那么这比像这样的暴力破解要好得多......

你可以利用这个`ast`库来做一些工作，这可能会更灵活，对 try/except 机制的点击次数更少（并且读起来更容易，但确实需要在预处理输入方面做一些工作)

```
def guess2(text):
    from ast import literal_eval
    tokens = (t.strip() for t in text.split(','))
    for token in tokens:
        try:
            token_value = literal_eval(token)
            token_type = type(token_value)
            yield token_value, token_type
        except ValueError as e:
            yield token, type(token) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:53:03.480

如果您事先知道类型，您可以这样做：

```
import csv
type_funcs = [int, float, str]
with open('yourfile.csv', 'rb') as f:
    reader = csv.reader(f)
    for row in reader:
        typed_row = [func(val) for func, val in zip(type_funcs, row)] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:49:19.347

如果所有文件中都有固定模式，则另当别论。

```
def update_types():
    f = open("txtfile", "r")
    reader = f.readlines()
    for line in reader:
        parts = line.split(',')
        parts[0], parts[1] = int(parts[0]), float(parts[1])
        for part in parts:
            print type(part)
    f.close() 
```

# django - 在 Django 模板语言中按名称获取块

> ID：13997981
> 
> 赞同：2
> 
> 时间：2012-12-21T22:26:19.053
> 
> 标签：django, django-templates

我正在使用 django (1.4) 开发我的网站。我无法通过其名称获取块（以便对其进行编辑）。

在从我的基本模板继承的每个模板中，我都分配了一个字符串*块名。*我想将一些文本放在一个特定的块中（在扩展模板中定义），其名称等于变量*blockname*的内容。

**编辑：**

例子

*base.html*：

```
{% block b1 %}no changes{% endblock %}
{% block b2 %}no changes{% endblock %}
{% block b3 %}no changes{% endblock %} 
```

*子页面.html*：

```
??? 
```

用这样的视图显示*subpage.html*：

```
def show_subpage(request):
    t = loader.get_template('subpage.html')
    c = RequestContext(request, {'blockname': 'b2'})
    return HttpResponse(t.render(c)) 
```

应该有如下结果：

> 没有变化 CHANGE 没有变化

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T04:51:05.350

如果我理解你的正确，那么这就是你想要的......

```
def show_subpage(request):
    t = loader.get_template('subpage.html')
    c = RequestContext(request, {'blockname': ' Change '})
    return HttpResponse(t.render(c)) 
```

子页面.html

```
{% extends 'base.html' %}

{% block b2%}{{ blockname }}{% endblock %} 
```

# mysql - 选择要计算平均值的特定 MySQL 行出现

> ID：13997988
> 
> 赞同：0
> 
> 时间：2012-12-21T22:26:48.350
> 
> 标签：mysql, sql

我们有一个 MySQL 表，其中包含跟踪用户会话开始和结束时间：

```
UserId      Start                   End
150392  2012-07-11 01:11:28 2012-07-11 01:17:36
150392  2012-07-11 01:19:03 2012-07-11 01:23:47
150393  2012-07-11 01:22:47 2012-07-11 01:38:15
150051  2012-07-11 01:31:03 2012-07-11 01:36:07
150393  2012-07-11 01:37:43 2012-07-11 01:56:41
150392  2012-07-11 01:48:57 2012-07-11 01:54:23 
```

我希望能够**根据用户进入我们系统的次数**来检索平均会话时间。澄清一下，我想知道用户第一次进入我们系统的平均会话时间，第二次进入我们系统的平均会话时间，等等。所以用户ID第一次出现在表格中时，就是用户第一次会议；我们将所有第一次出现的会话时间相加并除以计数。然后对第二次用户 ID 事件执行相同操作并获取平均时间等。

以上表为例，第三次会话的平均时间为 326 秒，因为只有一个用户有第三次会话（用户 ID 150392，最后一行）。

所以我正在寻找这样的输出：

```
SessionCount    AvgTime (seconds)
1               540
2               810
3               326 
```

我希望这是有道理的。任何建议将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:57:09.783

```
SELECT SessionCount, AVG(duration) AS AvgTime FROM (
  SELECT   COUNT(*) AS SessionCount,
           TIMESTAMPDIFF(SECOND, t2.Start, t2.End) AS duration
  FROM     my_table t1
      JOIN my_table t2
        ON t1.UserId = t2.UserId AND t1.Start <= t2.Start
  GROUP BY t2.UserId, t2.Start, t2.End
) t GROUP BY SessionCount 
```

See it on [sqlfiddle](http://sqlfiddle.com/#!2/52276/3/0).

# c# - 列表上的多个操作

> ID：13997989
> 
> 赞同：0
> 
> 时间：2012-12-21T22:26:55.470
> 
> 标签：c#

我有这个列表。我想根据 Order 排序的类别有不同的值。有人可以告诉我该怎么做。

```
public class Item
    {
        public string URL{ get; set; }
        public string Title { get; set; }
        public string Category { get; set; }        
        public string Order{ get; set; }

    }

    var Test = new List<Items>

    var groups = Test.Select(g => g.category).Distinct(); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:32:05.327

```
var groups = Test
    .GroupBy(g => g.Category)
    .Select(g => new
                 {
                     Category = g.Key,
                     Items = g.OrderBy(i => i.Order)
                 })
    .OrderBy(g => g.Category)
    .SelectMany(g => g.Items)
    .ToList(); 
```

或者，在这种情况下基本上是一样的：

```
Test.OrderBy(it => it.Category).ThenBy(it => it.Order) 
```

如果您想要一个组列表，其中包含按顺序排序的该类别中的项目子列表，则可以取出 SelectMany 的第一个代码。

# objective-c - MFMailComposeViewController 获取默认用户电子邮件“来自”邮件

> ID：13997990
> 
> 赞同：0
> 
> 时间：2012-12-21T22:26:56.387
> 
> 标签：objective-c, ios, xcode

我似乎找不到人们特别说您无法从 MFMailComposeViewController 获取默认用户邮件的任何地方。所以我只是创建这个线程来确保。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:17:20.777

不，没有办法在`MFMailComposeViewController`. 您只能设置“收件人”和“抄送”字段。如果您计划设置的“发件人”邮件 ID 未在设备中配置，这是可以理解的。

设备将使用用户的默认邮件 ID 自动填充 from 字段。一旦出现，用户可以在不同的 id 之间切换`MFMailComposeViewController`。

# java - java中的直方图均衡化

> ID：13997996
> 
> 赞同：3
> 
> 时间：2012-12-21T22:27:35.357
> 
> 标签：java, bufferedimage

我尝试编译以下代码，但我发现仅对于我输入用于测试的所有图像，图像都会变成全黑。

PS我是Java新手，除了内置包外，我不允许使用任何包

```
import java.awt.*;
import java.awt.event.*;
import java.awt.image.*;
import javax.swing.*;
import java.util.*;

public class ImageProcessor
{   
public static BufferedImage convert(Image img)
{
    BufferedImage bi = new BufferedImage(img.getWidth(null), img.getHeight(null), BufferedImage.TYPE_INT_RGB);
    Graphics bg = bi.getGraphics();
    bg.drawImage(img, 0, 0, null);
    bg.dispose();
    return bi;
}

public static BufferedImage toGrayScale(Image img)
{
    // Convert image from type Image to BufferedImage
    BufferedImage bufImg = convert(img);

    // Scan through each row of the image
    for(int j=0; j < bufImg.getHeight(); j++)
    {
        // Scan through each columns of the image
        for(int i=0; i < bufImg.getWidth(); i++)
        {
            // Returns an integer pixel in the default RGB color model
            int values=bufImg.getRGB(i,j);
            // Convert the single integer pixel value to RGB color
            Color oldColor = new Color(values);

            int red = oldColor.getRed();        // get red value
            int green = oldColor.getGreen();    // get green value
            int blue = oldColor.getBlue();  // get blue value

            // Convert RGB to gray scale using formula
            // gray = 0.299 * R + 0.587 * G + 0.114 * B
            double grayVal = 0.299*red + 0.587*green + 0.114*blue;

            // Assign each channel of RGB with the same value
            Color newColor = new Color((int)grayVal, (int)grayVal, (int)grayVal);

            // Get back the integer representation of RGB color
            // and assign it back to the original position
            bufImg.setRGB(i, j, newColor.getRGB());
        }
    }
    // return back the resulting image in BufferedImage type
    return bufImg;
}

public static BufferedImage histEqualization(Image img)
{
    //Convert image to BufferedImage
    img = ImageProcessor.toGrayScale(img);
    BufferedImage bufImg = convert(img);

    //Getting information of each pixel;
    int[][] intensity = new int[bufImg.getWidth()][ bufImg.getHeight()];
    int[] counter = new int[256];
    for(int j=0; j < bufImg.getHeight();j++)
        for(int i=0; i < bufImg.getWidth();i++)
        {
            int values=bufImg.getRGB(i,j);              
            Color oldColor = new Color(values);
            intensity[i][j] = oldColor.getBlue();
            counter[intensity[i][j]]++;
        }

    //BEGIN OF Histogram Equalization

    //find out how many rows the table have
    int row=0;

    for(int i=0;i<256;i++)
        if(counter[i]!=0)
            row++;

    //Find out the v column of the table
    //table[row][0] = v column
    //table[row][1] = c column
    int temp=0;
    int[][] table = new int[row][2];

    for(int i=0;i<256;i++)
        if(counter[i]!=0)
        {
            table[temp][0] = i;
            temp++;
        }

    //Find out the c column of the table
    for(int i=0;i<row;i++)
        table[i][1] = counter[table[i][0]];

    //C-> CS

    int sum = 0;

    for(int i=0;i<row;i++)
    {
        sum += table[i][1];
        table[i][1] = sum;
    }

    //CS->NCS
    int min = table[0][1], max = table[row-1][1];

    for(int i=0;i<row;i++)
        table[i][1] = Math.round((table[i][1]-min)/(max-min));

    //Mapping
    for(int j=0;j<bufImg.getHeight();j++)
        for(int i=0;i<bufImg.getWidth();i++)
        {
            for(int k=0;k<row;k++)
                if(intensity[i][j]==table[k][0])
                    intensity[i][j] = table[k][1];

            Color newColor = new Color(intensity[i][j], intensity[i][j], intensity[i][j]);

            bufImg.setRGB(i, j, newColor.getRGB());
        }

    return bufImg;
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-09T09:45:36.323

convert 方法可以简化为：

```
return new BufferedImage(img.getWidth(), img.getHeight(), BufferedImage.TYPE_BYTE_GRAY) ; 
```

因为您只需要灰度（单通道）图像。那么 toGrayScale 的方法是：

```
 BufferedImage bufImg = convert(img);
 byte[] bufferbyte = ((DataBufferByte) bufImg.getRaster().getDataBuffer()).getData() ;
 for(int j=0, pos=0; j < bufImg.getHeight(); j++)
      for(int i=0; i < bufImg.getWidth(); i++, pos++)
           {
           int red   = bufImg().getSample(i, j, 0) ;
           int green = bufImg().getSample(i, j, 1) ;
           int blue  = bufImg().getSample(i, j, 2) ;
           // gray = 0.299 * R + 0.587 * G + 0.114 * B
           bufferbyte[pos] = (byte)(int)(0.299*red + 0.587*green + 0.114*blue) ;
           }
return bufImg ; 
```

我使用 Raster() 来获取 RBG 值，但直接访问 DataBuffer 会快得多（比如缓冲区字节）。

然后你可以做直方图均衡，但是第一行是错误的，应该被删除。

# javascript - JQuery：创建一个由我的选择选项的数据属性组成的数组

> ID：13997998
> 
> 赞同：11
> 
> 时间：2012-12-21T22:27:46.827
> 
> 标签：javascript, jquery

我有一个带有一些选项的选择倍数。每个选项都有多个数据属性。我想创建一个包含其每个数据值的数组。例如我的代码看起来很像这样：

```
<select multiple id='my_select'>
<option data-my_id='1' data-my_parent='3' data-my_name='option1'>My first option</option>
<option data-my_id='2' data-my_parent='3' data-my_name='option2'>My second option</option>
<option data-my_id='3' data-my_parent='3' data-my_name='option3'>My third option</option>
</select> 
```

我正在寻找的结果需要是这样的：

```
[1,3,option1], [2,3,option2], [3,3,option3] 
```

我研究了如何使用每个选项的数据属性值之一创建一个数组，给我这个 [1,2,3]，但我没有成功地想出我需要的东西。

非常感谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-21T22:33:45.663

```
var array = $("#my_select > option").map(function() {
    return [$.map($(this).data(), function(v) {
        return v;
    })];
}).get(); 
```

**演示：http:** [//jsfiddle.net/nQ6mE/](http://jsfiddle.net/nQ6mE/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-21T22:33:16.800

```
var arr = [];
$('#my_select option').each(function(){
  var $this = $(this);
  arr.push([ $this.data('my_id'), $this.data('my_parent'), $this.data('my_name') ]);
}); 
```