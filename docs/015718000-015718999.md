# StackOverflow 问答 15718000-15718999

# iphone - UIScrollView 显示第一张图像正常，但后续图像缩放和平移不正确

> ID：15718002
> 
> 赞同：0
> 
> 时间：2013-03-30T11:26:29.040
> 
> 标签：iphone, ios, objective-c, uiscrollview

我有从 Flickr 提取图像的应用程序，可以在 UIScrollView 中选择并显示它们，并启用缩放和平移。我选择的第一张图像很好，平移和缩放按预期工作。但是，我在第一个之后加载的任何图像都无法正常运行。平移是有限的，当我第一次缩放它时，它总是将图像重置到屏幕的左上角，并且再次平移非常有限，但是它确实会缩放。这是方法：

```
-(void)loadImageFromURLandSetupScrollView{

[self startToolbarActivityIndicator];
dispatch_queue_t downloadQueue = dispatch_queue_create("flickr downloader", NULL);
dispatch_async(downloadQueue, ^{
    UIImage *imageFromFlickr = [UIImage imageWithData:[NSData dataWithContentsOfURL:self.photoURL]];
    dispatch_async(dispatch_get_main_queue(), ^{
        self.photo.image = imageFromFlickr;
        self.photo.frame = CGRectMake(0, 0, self.photo.image.size.width, self.photo.image.size.height);
        self.scrollView.contentSize = self.photo.bounds.size;

        //setup the zoom scale to show best possible
        float zoomScaleWidth = self.scrollView.bounds.size.width / self.photo.image.size.width;
        float zoomScaleHeight = self.scrollView.bounds.size.height / self.photo.image.size.height;

        if(zoomScaleHeight < zoomScaleWidth){
            self.scrollView.minimumZoomScale = zoomScaleHeight;
            self.scrollView.zoomScale = zoomScaleWidth;
        }
        else{
            self.scrollView.minimumZoomScale = zoomScaleWidth; //make sure it can't be zoomed less than longest side at full screen
            self.scrollView.zoomScale = zoomScaleHeight;
        }
        self.scrollView.maximumZoomScale = 10;

        //set scroll view background colour
        self.scrollView.backgroundColor = [UIColor blackColor];
        [self stopToolBarActivityMonitor];
    });
});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T16:11:24.057

因此，这似乎是由新的自动布局功能引起的，我的解决方法是在故事板中没有 UIImageView，而是在需要时以编程方式将其添加到滚动视图中。

```
-(UIImageView *)photo
{
if (!_photo) _photo = [[UIImageView alloc] initWithFrame:CGRectZero];
return _photo;
}

-(void)loadImageFromURLandSetupScrollView{
[self startToolbarActivityIndicator];
dispatch_queue_t downloadQueue = dispatch_queue_create("flickr downloader", NULL);
dispatch_async(downloadQueue, ^{
    UIImage *imageFromFlickr = [UIImage imageWithData:[NSData dataWithContentsOfURL:self.photoURL]];
    dispatch_async(dispatch_get_main_queue(), ^{
        self.photo.image = imageFromFlickr;

        [self.scrollView addSubview:self.photo];
        // Set the min and max:
        self.scrollView.minimumZoomScale = 0.2;
        self.scrollView.maximumZoomScale = 5.0;
        self.scrollView.delegate = self;

        // Set the content:
        self.scrollView.zoomScale = 1.0; // reset zoomScale for new image
        self.scrollView.contentSize = self.photo.image.size;
        self.photo.frame = CGRectMake(0, 0, self.photo.image.size.width, self.photo.image.size.height);

        //setup the zoom scale to show best possible
        float zoomScaleWidth = self.scrollView.bounds.size.width / self.photo.image.size.width;
        float zoomScaleHeight = self.scrollView.bounds.size.height / self.photo.image.size.height;

        if(zoomScaleHeight < zoomScaleWidth)
            self.scrollView.zoomScale = zoomScaleWidth;
        else
            self.scrollView.zoomScale = zoomScaleHeight;

        //set scroll view background colour
        self.scrollView.backgroundColor = [UIColor blackColor];
        [self stopToolBarActivityMonitor];
    });
});
} 
```

# python - Check if directory is symlink?

> ID：15718006
> 
> 赞同：5
> 
> 时间：2013-03-30T11:26:37.680
> 
> 标签：python, python-2.7

In `os` there's a function `os.path.islink(PATH)` which checks if `PATH` is symlink. But if fails when PATH is a symlink to some directory. Instead -- python thinks it is directory (`os.path.isdir(PATH)`). So how do I check if a dir is link?

**Edit**:

Here's what `bash` thinks:

```
~/scl/bkbkshit/Teaching: file 2_-_Classical_Mechanics_\(seminars\)
2_-_Classical_Mechanics_(seminars): symbolic link to `/home/boris/wrk/tchn/2_-_Classical_Mechanics_(seminars)' 
```

and here's what `python` thinks:

```
In [8]: os.path.islink("2_-_Classical_Mechanics_(seminars)/")
Out[8]: False 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-30T11:33:40.903

This happens because you put a slash at the end of the filename.

```
os.path.islink("2_-_Classical_Mechanics_(seminars)/")
                                                  ^ 
```

The trailing slash causes the OS to follow the link, so that the result is the target directory which is not a link. If you remove the slash, `islink` will return `True`.

The same thing happens in Bash as well:

```
g@ubuntu:~$ file aaa
aaa: symbolic link to `/etc'
g@ubuntu:~$ file aaa/
aaa/: directory 
```

# jquery - 自定义jquery-ui tolltip

> ID：15718007
> 
> 赞同：1
> 
> 时间：2013-03-30T11:26:42.087
> 
> 标签：jquery, asp.net, jquery-ui

我在我的项目中使用 HTML 表格并通过 jquery-ui 显示工具提示。但我想在 mouseenter 和 mouseleave 隐藏时添加“mydiv”作为提示。

```
 <div id="mydiv">
    <input type="button"  value="Delete"/>
    <input type="button"  value="Edit"/>
</div> 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:37:30.783

可能你需要[Jquery qTip](http://craigsworks.com/projects/qtip/demos/)

```
$(this).qtip({
      content: divId // Use the contents of the child myqtip-content element.
      style: 'cream'
   }); 
```

*（如果您不想使用任何插件，请忽略）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:48:44.170

演示中有一个非常好的自定义内容示例。

[http://jqueryui.com/tooltip/#custom-content](http://jqueryui.com/tooltip/#custom-content)

点击`view source`查看代码并进行相应调整

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:32:27.987

试试这个示例代码

```
<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>jQuery UI Tooltip - Default functionality</title>
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
  <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
  <script src="http://code.jquery.com/ui/1.10.2/jquery-ui.js"></script>
  <link rel="stylesheet" href="/resources/demos/style.css" />
  <script>
  $(function() {
    $( document ).tooltip();
  });
  </script>
  <style>
  label {
    display: inline-block;
    width: 5em;
  }
  </style>
</head>
<body>

<p><a href="#" title="That's what this widget is">Tooltips</a> can be attached to any element. When you hover
the element with your mouse, the title attribute is displayed in a little box next to the element, just like a native tooltip.</p>
<p>But as it's not a native tooltip, it can be styled. Any themes built with
<a href="http://themeroller.com" title="ThemeRoller: jQuery UI's theme builder application">ThemeRoller</a>
will also style tooltips accordingly.</p>
<p>Tooltips are also useful for form elements, to show some additional information in the context of each field.</p>
<p><label for="age">Your age:</label><input id="age" title="We ask for your age only for statistical purposes." /></p>
<p>Hover the field to see the tooltip.</p>

</body>
</html> 
```

[**演示**：](http://jqueryui.com/tooltip/)

[更多样品](http://api.jqueryui.com/tooltip/)

# php - PHPExcel用while循环替换mysql结果

> ID：15718009
> 
> 赞同：1
> 
> 时间：2013-03-30T11:26:52.293
> 
> 标签：php, phpexcel

我正在使用 PHPEXCEL 类。

所以我从 mysql 数据库中获取行并在我的 excel 文件中打印这些行，这很好。结果是这样的：

![在此处输入图像描述](../Images/a2585a353131a5d3c8ccb46613336777.png)

因此，在上图中，数字顺序实际上是 usuarioxl 表中的 id 列。

我想替换它，因为 de "id" 是不断变化的。我正在考虑计算“id”的最后一个位置，然后进行某种生成数字顺序 1、2、3、4、5、6、7、8 的 while 循环......我该怎么做（替换id 列与我自己的 while 循环与此代码）。

```
$query = "SELECT id,text,util FROM usuarioxl"; 
$headings = array('#', 'Estos son los asuntos pendientes hasta la fecha','fecha de ingreso'); 
if ($result = mysql_query($query) or die(mysql_error())) { 
    // Create a new PHPExcel object 
    $objPHPExcel = new PHPExcel(); 
    $objPHPExcel->getActiveSheet()->setTitle('Asuntos Pendientes'); 
    $rowNumber = 2; 
    $rowNumber2 = 2; 
    $col = 'A'; 
    foreach($headings as $heading) { 
    $objPHPExcel->getActiveSheet()->setCellValue($col.$rowNumber,$heading); 
    $col++; 
    } 
    // Loop through the result set 
    $rowNumber = 3; 
    while ($row = mysql_fetch_row($result)) { 
    $col = 'A'; 
    foreach($row as $cell) { 
    $objPHPExcel->getActiveSheet()->setCellValue($col.$rowNumber,$cell); 
    $col++; 
    } 
    $rowNumber++; 
    $rowNumber2++; 
    } 
$styleArray = array(
      'borders' => array(
             'allborders' => array(
                    'style' => PHPExcel_Style_Border::BORDER_THIN,
                    'color' => array('argb' => 'FFB0c4dE'),
             ),

       ),
);

$styleArray2 = array(
             'fill' => array(
                    'type' => PHPExcel_Style_Fill::FILL_SOLID,
                    'color' => array('argb' => 'FFB0c4dE'),
             ),

);

$objPHPExcel->getActiveSheet()->getStyle('A2:F2')->applyFromArray($styleArray);
$objPHPExcel->getActiveSheet()->getStyle('A1:F1')->applyFromArray($styleArray2);
$objPHPExcel->getActiveSheet()->getSheetView()->setZoomScale(80);
$objDrawing = new PHPExcel_Worksheet_Drawing();
$objDrawing->setName('Logo');
$objDrawing->setDescription('Logo');
$objDrawing->setPath('./images/headerexcel2.png');
$objDrawing->setWorksheet($objPHPExcel->getActiveSheet());
$objDrawing->setCoordinates('A1');
$objDrawing->setOffsetX(30);

    // Freeze pane so that the heading line won't scroll 

$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(5);
$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setWidth(50);
$objPHPExcel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(30);
$objPHPExcel->getActiveSheet()->getRowDimension('1')->setRowHeight(50);
$objPHPExcel->getActiveSheet()->getRowDimension('2')->setRowHeight(15);
$objPHPExcel->getActiveSheet()->getHeaderFooter()->setOddHeader('&C&16');
$objPHPExcel->getDefaultStyle()->getFont()->setName('Arial');
$objPHPExcel->getDefaultStyle()->getFont()->setSize(14); 
$objPHPExcel->getActiveSheet()->freezePane('A2'); 

    // Save as an Excel BIFF (xls) file 

   $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel5'); 
   header('Content-Type: application/vnd.ms-excel'); 
   header('Content-Disposition: attachment;filename="asuntos-pendientes.xls"'); 
   header('Cache-Control: max-age=0'); 

   $objWriter->save('php://output'); 

   exit(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:39:12.640

我会认为：

```
$query = "SELECT text, util FROM usuarioxl";

...

$rowNumber = 3; 
$newId = 0;

while ($row = mysql_fetch_row($result)) { 
    $col = 'B'; 

    $objPHPExcel->getActiveSheet()->setCellValue("A$rowNumber", $newId++);

    foreach($row as $cell) { 
        $objPHPExcel->getActiveSheet()->setCellValue($col.$rowNumber, $cell); 
        $col++; 
    } 

    $rowNumber++; 
    $rowNumber2++; 
} 
```

# xslt - 在 XSLT 中添加名称空间时出现错误

> ID：15718014
> 
> 赞同：0
> 
> 时间：2013-03-30T11:27:18.620
> 
> 标签：xslt

使用添加名称空间代码时出现以下错误。

我已经在 while 循环中添加了命名空间代码。对于第一次迭代，它工作正常。对于第二次迭代，它给出了以下错误。

错误：

```
exception  class="oracle.xml.parser.v2.XMLDOMException">
invalid character : in name
<stack>
<f>oracle.xml.util.XMLUtil.validateQualifiedName#525</f>
<f>oracle.xml.parser.v2.XMLDocument.createElementNS#2705</f>
<f>oracle.xml.parser.v2.XMLDocument.otherImportNode#2350</f>
<f>oracle.xml.parser.v2.XMLDocument.importNode#2326</f>
<f>oracle.xml.parser.v2.XMLDocument.otherImportNode#2459</f>
<f>oracle.xml.parser.v2.XMLDocument.importNode#2326</f>
<f>com.collaxa.cube.xml.dom.DOMUtil.copyElement#558</f>
<f>com.collaxa.cube.xml.dom.DOMUtil.copyObjHelper#300</f> 
```

我正在使用以下在while循环中添加Namesapces代码。while循环为第一次迭代处理多个记录。它能够处理。但是对于第二次迭代它给出了错误。

添加命名空间代码：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:vbs="http://www.w3.org/1999/XSL/Transform" xmlns:msxml="urn:schemas-microsoft-com:xslt">
    <xsl:output omit-xml-declaration="yes" />
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*" />
        </xsl:copy>
    </xsl:template>

<!-- Just change the match="/*" to match="*" ; if you want to add namespace in all elements -->
    <xsl:template match="*">
        <xsl:element name="inp1:{local-name()}"  namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/Call856OutboundProcedure1">
            <xsl:apply-templates select="node()|@*" />
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T15:38:56.953

您在这里提供了相当稀疏的信息，但我建议尝试这种方法（在样式表根目录中指定命名空间 uri，而不是在`<xsl:element>`：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
         xmlns:vbs="http://www.w3.org/1999/XSL/Transform" 
         xmlns:msxml="urn:schemas-microsoft-com:xslt"
         xmlns:inp1="http://xmlns.oracle.com/pcbpel/adapter/db/sp/Call856OutboundProcedure1">
    <xsl:output omit-xml-declaration="yes" />
    <xsl:template match="node()|@*">
        <xsl:copy>
            <xsl:apply-templates select="node()|@*" />
        </xsl:copy>
    </xsl:template>

<!-- Just change the match="/*" to match="*" ; if you want to add namespace in all elements -->
    <xsl:template match="*">
        <xsl:element name="inp1:{local-name()}">
            <xsl:apply-templates select="node()|@*" />
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

# c - GCC changes less than to less than or equal to

> ID：15718021
> 
> 赞同：5
> 
> 时间：2013-03-30T11:28:27.660
> 
> 标签：c, gcc, assembly, gdb

I have the following simple program that I'm using to refresh my memory of GDB (which I haven't touched for many years).

```
#include <stdio.h>

int main()
{
  int i;

  for (i = 0; i < 10; i++)
  {
    printf("Hello World\n");
  }

  return 0;
} 
```

I compile this with `gcc -g for-test.c -o for-test`. Based on the man page, I don't expect any optimisations to be used, since I haven't specified any.

When I load this into GDB and run `disassemble main`, the `i < 10` comparison generates the following:

```
cmp    DWORD PTR [rbp-0x4],0x9
jle    0x4004fe <main+10> 
```

This seems to have effectively changed a comparison of `i < 10` to `i <= 9`. Given that these are integer comparisons, there shouldn't be a difference, but I was wondering if there is any reason why GCC outputs this assembly, instead of comparing against 10 and jumping if less than (JL)?

Edit: This is on a machine with a 64-bit processor, running Ubuntu with GCC 4.6.3 and GDB 7.4-2012.04.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-30T11:44:17.493

There shouldn't be a difference in execution speed. I think gcc generally emits jle for such comparisions and does it for consistency in the generated assembly.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T11:45:05.693

Compilers are allowed to perform optimizations as long as the observable behavior is same. This is known as the **[As-If rule](http://en.cppreference.com/w/cpp/language/as_if)**. Since the observable behavior for both the cases is same, the compiler is allowed to generate the assembly code in either of the two. This is true even if you do not have any optimizations enabled.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T11:39:39.457

It isn't effective optimization, just another way to write the same. Compiling with -O flag generates much more complex optimizations.

# css - css布局 - 打印时的第二个空白页

> ID：15718022
> 
> 赞同：7
> 
> 时间：2013-03-30T11:28:34.020
> 
> 标签：css, printing

我正在使用这个位置的 css 文件：

[http://peterned.home.xs4all.nl/examples/csslayout1.html](http://peterned.home.xs4all.nl/examples/csslayout1.html)

但不知何故，当我打印我的页面时，第一页是完美的，但它开始打印第二页是空白的。

当然我只需要第一页，但我找不到为什么它会打印第二个空白页。以前有人遇到过这种情况，还是知道我应该改变什么？

我认为css文件中有一些属性，这使得我的页面可能有点太大了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-04T23:11:15.430

我刚才遇到了同样的问题，发现 user2624602 的[回答](https://stackoverflow.com/questions/7846346/how-to-avoid-extra-blank-page-at-end-while-printing/19529877#19529877)很糟糕。

在css中添加：

```
@media print { html, body { height: 99%; } } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T11:37:37.753

据我所知，它很大程度上取决于浏览器：使用 firefox 时，它完全独立于您使用的电脑，而使用 chrome 时，它​​取决于您的电脑和当前的页面缩放。

例如在这里我没有看到任何问题（ff 和 chrome）。

无论如何，您可以尝试使用[这个 css2 属性](http://www.w3schools.com/cssref/pr_print_pageba.asp): `page-break-after:avoid;`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T11:46:43.067

在您提供的 php 代码中，您最后有一个错误。

```
</table>

</body></div>
<div id="footer">
<p><img src="images/voet.png" alt="Kop" class="voet"/></p>

</div>

</div>
</html> 
```

应该是这样的：

```
 </table>

        </div>
        <div id="footer">
          <p><img src="images/voet.png" alt="Kop" class="voet"/></p>       
        </div>

      </div>
  </body>
</html> 
```

# ember.js - 从其他控制器访问控制器的功能

> ID：15718023
> 
> 赞同：0
> 
> 时间：2013-03-30T11:28:39.743
> 
> 标签：ember.js

我有两个控制器如下。

```
App.CreditIndexController = Ember.ArrayController.extend({
    viewAll: function(){
        //Some code
    }
})

App.CreditVoucherController = Ember.ArrayController.extend({
    needs: ['creditIndex'],
    viewAllVoucher: function(){
        this.get('controller.controllers.creditIndex').viewAll();
    }
}) 
```

我试图`viewAll`从`CreditVoucherController`. 但它没有奏效。有什么办法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:44:24.507

您必须通过以下方式访问另一个控制器`controllers property`：

```
App.CreditVoucherController = Ember.ArrayController.extend({
    needs: ['creditIndex'],
    viewAllVoucher: function(){
        this.get('controllers.creditIndex').viewAll();
    }
}); 
```

# c# - 计划代理内存泄漏

> ID：15718025
> 
> 赞同：3
> 
> 时间：2013-03-30T11:28:42.510
> 
> 标签：c#, windows-phone-7, memory-leaks, windows-phone-8, scheduled-tasks

大家好，我在我的 WP8 应用程序的 ScheduledAgent 中遇到了内存泄漏问题。我正在尝试做的是在循环中更新应用程序的多个图块，看起来还可以（就内存使用而言），但由于某种原因，更新图块后内存不会释放。

我的代码如下所示（Microsoft.Phone.Info.DeviceStatus.ApplicationCurrentMemoryUsage 测量的内存使用情况）：

```
protected override void OnInvoke(ScheduledTask task)
{
    try
    {
        Deployment.Current.Dispatcher.BeginInvoke(() =>
         {
             // 5MB used
             foreach (int id in myIdsList)
                UpdateTile(id);
         });
    }
    catch (Exception e)
    {
        if (Debugger.IsAttached)
            Debugger.Break();
    }

    NotifyComplete();
} 
```

更新方法如下所示：

```
public void UpdateTile(int id)
{
    MyClass myClassInstance = GetInstanceById(id);

    //~6MB used by now

    Canvas drawingSurface = new Canvas();

    //Add some Image objects to canvas (source to each image is a filePath 
    // contained in myClassInstance)
    //~7MB

    WriteableBitmap bigTileImage = new WriteableBitmap(691, 336);
    bigTileImage.Render(drawingSurface, null);
    bigTileImage.Invalidate();

    //~9MB

    var bigTilePath = string.Format(/*path here*/);

    using (IsolatedStorageFile storage = 
           IsolatedStorageFile.GetUserStoreForApplication())
    {
        if (storage.FileExists(bigTilePath))
            storage.DeleteFile(bigTilePath);

        using (var isoFileStream = new IsolatedStorageFileStream(
            bigTilePath, FileMode.Create, storage))
        {
            bigTileImage.SaveJpeg(isoFileStream, bigTileImage.PixelWidth,
                                  bigTileImage.PixelHeight, 0, 100);
        }
    }

    ShellTile tileToUpdate = ShellTile.ActiveTiles.FirstOrDefault(
        x => x.NavigationUri.ToString().Contains("TileID="+id));
    FlipTileData flipTileData = new FlipTileData()
    {
        //Set fields
        WideBackgroundImage = 
            new Uri(("isostore:/"+bigTilePath, UriKind.Absolute),
    };

    tileToUpdate.Update(flipTileData);

    //~10MB used
    //Shouldn't memory be released by now??
    // calling GC.Collect() has no effect
} 
```

所以，它是一个 PeriodicTask，我有 11MB 的内存上限，只要内存在迭代后没有释放，我就会得到 OutOfMemoryException。

也许我不了解基础知识，但我认为应该在将文件保存到 IS 后释放大部分占用的内存（或者每当 GC 决定收集，但是，正如我所说，即使显式调用`GC.Collect()`也没有效果）？

难道我做错了什么？有没有办法释放内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T14:34:18.633

我不确定这是否是您的内存泄漏问题的唯一原因，但是；您正在创建一个平铺对象，并且 1）您没有使用它 2）您也没有释放它。

> ShellTile tileToipdate = ShellTile.ActiveTiles.FirstOrDefault(x => x.NavigationUri.ToString().Contains("TileID="+id));

这个**tileToidate**对象有什么作用？查询后您没有使用它。如果它没有用，只需将其删除，看看它是否会做出任何改变。

如果你要使用这个对象，调用**tileToipdate.Finalize()**方法（在你完成之后），这里[提到](http://msdn.microsoft.com/en-US/library/windowsphone/develop/microsoft.phone.shell.shelltile%28v=vs.105%29.aspx)，引用“允许对象尝试释放资源并在对象之前执行其他清理操作被垃圾回收回收。（继承自 Object。）"

希望能帮助到你。

# android - 带高亮显示的图像映射

> ID：15718026
> 
> 赞同：1
> 
> 时间：2013-03-30T11:28:58.443
> 
> 标签：android

我有一个图像是建筑物的地图。我希望​​如果用户单击地图的某些部分，例如地图上的房间，那么应该突出显示地图的该部分并在谷歌地图上显示一个气泡。有任何可用于此类静态地图实现的 api？

提前致谢..

# java - Find more than 1 string with Regex

> ID：15718029
> 
> 赞同：0
> 
> 时间：2013-03-30T11:29:01.483
> 
> 标签：java, regex

I'm actually new to java and I'm happy that the regex works that I found^^ But now I need to know, how to get more than 1 string and the best would be if all would be in an array. Actually I do it like this:

```
Pattern p = Pattern.compile("name~(.*?)@");
Matcher m = p.matcher(response);

while (m.find()) {
     System.out.println("Found: " + m.group());
} 
```

Can anyone help?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:42:30.107

You just need to put your results into a `List`:

```
final List<String> results = new LinkedList<>();
while (m.find()) {
    results.add(m.group());
} 
```

You can then access the results in the `List` directly - if you need random access use an `ArrayList` rather than a `LinkedList`. If you need an array then simply convert it

```
final String[] resultArr = results.toArray(new String[results.size()]); 
```

If you're matching multiple items in a `String` you can help the regex engine out a little by matching `[^@]` and making it possessive rather than using a reluctant `.*`

```
Pattern p = Pattern.compile("name~([^@]++)@"); 
```

# iphone - 在 CollectionView -Objective-C 中显示/隐藏单元格

> ID：15718030
> 
> 赞同：0
> 
> 时间：2013-03-30T11:29:44.777
> 
> 标签：iphone, ios, uicollectionview

我有一个 3 列和 20 行的集合视图。我只想显示前 3 行，并在集合视图的底部放置一个“显示更多”按钮。当用户触摸按钮时，其他行将可见。我不能这样做。所以我创建了两个不同的集合视图，第一个集合视图只包含我想第一次显示的 3 行，单击按钮后，其他集合视图显示。有一个更容易做到这一点？我只想用一个collectionview 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T23:14:03.000

如果你有一个 NSMutableArray 作为数据源：

```
-(void)buttonShowMoreClicked {
  [self.collectionView performBatchUpdates:^{
    [self.dataSourceArray addObjectsFromArray:arrayContainingInfoAboutOther17Rows];
    [self.collectionView insertItemsAtIndexPaths:arrayOfIndexPaths];
  } completion:nil];
}

-(NSInteger)collectionView:(UICollectionView *)collectionView numberOfItemsInSection:(NSInteger)section {
    return self.dataSourceArray.count; 
```

# php - 我是否需要多个 ViewHelper 的多个视图？

> ID：15718034
> 
> 赞同：0
> 
> 时间：2013-03-30T11:29:59.827
> 
> 标签：php, model-view-controller, view, view-helpers

在我的应用程序中，我有**一** `View`堂课。它被实例化并注入到执行类似操作的控制器中

```
$this->view->load('sometemplate') 
```

然后在稍后阶段在控制器之外

```
$view->render(); 
```

它可以满足我的需要，但最近我遇到了`ViewHelpers`，我喜欢封装表示逻辑的想法。

问题是我会有多个`ViewHelpers`，我不希望我的单`View`人像

```
private $orderHelper;
private $feedbackHelper;
.... 
```

或者

```
private $helpers = array(); 
```

`View`为每个页面设置不同的页面是否有意义

```
class Feedback extends View {
    private $feedbackHelper;
} 
```

还是有更好的方法来实现这一目标？

我在想的另一种方式是`View`，`HelperFactory`我可以使用它来`Helper`从任何页面创建我需要的任何内容。

实现这些助手的最佳方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T12:10:29.777

作为外行，我是：

仅仅为了处理多个 Helpers 而创建不同的 View 类是没有意义的（不要不必要地重复自己）。

创建一个 HelperFactory 作为一个方法没有意义，因为如果你想*动态地*创建你的 Helper 对象，你仍然必须传递或执行一个“新的 Helper”语句给这个方法，不是吗？那么为什么不将其称为依赖注入并让您的控制器使用一个或多个 Helpers 注入您的 View...

```
class Controller {
    this->view->inject(new ViewHelper($args));
} 
```

...并让您的 View 将它们放在 helper[] 中（为什么不呢？）...

```
class View {
    private $helper;

    public function inject($dependency) {
        $key = lcfirst(get_class($dependency));
        $this->helper[$key] = $dependency;
    }

    public function getHelper($key) {
        return $this->helper[$key];
    }
} 
```

您的助手可以通过您的视图访问。

*尽管如此，我也很好奇，其他人对此有何看法。*

超越此解决方案的一步可能是使用**依赖注入容器**。

这些是有趣且易于理解的**链接**：

*   [http://fabien.potencier.org/article/11/what-is-dependency-injection](http://fabien.potencier.org/article/11/what-is-dependency-injection)

*   [http://r.je/mvc-php-router-dependency-injection.html](http://r.je/mvc-php-router-dependency-injection.html)

# c++ - Why the use of cin, cout or %I64d is preferred over %lld specifier in C++?

> ID：15718039
> 
> 赞同：21
> 
> 时间：2013-03-30T11:30:31.063
> 
> 标签：c++, 64-bit, iostream, format-specifiers, long-long

Why many of the Online Judges advises *"do not use the %lld specifier to read or write 64-bit integers in С++"*

It is preferred to use the cin, cout streams or the `%I64d` specifier?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-30T11:43:56.203

I believe the answer is related to `%lld` means `long long decimal`, which isn't guaranteed to be 64-bit. It could be, for example 128 bit on some systems. (Although if the variable is `long long` rather than, say, `uint64_t`, then I expect `%lld` is the right thing to use - or it would go wrong the other way around)

Unfortunately, the design of `printf` and `scanf` and their siblings is such that the compiler implementation and the format must match.

Obviously, `cout` and `cin` are safe in the sense that the compiler will chose the right output and input translation in itself.

It may also have something to do with what compiler(s) the "online judges" use - I think Microsoft compilers at some point supported 64-bit integers, but not `long long`, and thus didn't have `%lld`, but did have `%l64d`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-30T11:58:30.447

The `<<` and `>>` operators on `cin` and `cout` have versions for every integer and floating-point type. If you use `cin` and `cout`, you just do `cin >> integer_variable` or `cout << integer_variable` and you're done, `cin` and `cout` will figure out what to do.

If you use some sort of `printf()`, then you must be very careful in what you pass to it. If you pass to it an `int`, you must also pass its type specifier `"%d"`, for `unsigned int` it's `"%u"`, for `long` it's `"%ld"`, for `unsigned long long` it's `"%llu"`, for `size_t` it's `"%zu"` and so on. If you pass a type specifier that doesn't match the type of your integer, you'll invoke *undefined behavior*. As a result, your program may print wrong numbers or corrupt itself or hang or crash or misbehave in some other mysterious way.

Now, the C++11 language standard (and C99) has at least one integer type that's 64-bit or longer, `long long` (and its unsigned counterpart, `unsigned long long`). If you use it, you must be aware that it can be longer than 64 bits. If your compiler provides another type, `__int64` or `int64_t` (plus the unsigned version of the same), that's exactly 64-bit, you shouldn't mix and match their type specifiers as it's often mistakenly done. You should still use `"%lld"` and `"%llu"` for `long long` and `unsigned long long` and whatever's appropriate for `__int64` (perhaps, `"%I64d"`) and for `int64_t` (`PRId64` macro).

Basically, you should either avoid using `printf()-like` functions or be very careful with them.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2022-01-11T03:00:41.640

`Ans to 1:` Because in their background they use compiler. `GNU` supports `%l64d`, and `MS` supports `%lld` and `%l64d`.

`Ans to 2:` Yes, it is preferred to use the `cin`, `cout`. Because internally they take decision by their own.

# java - 在 Spring 中使用工厂类

> ID：15718042
> 
> 赞同：0
> 
> 时间：2013-03-30T11:30:54.593
> 
> 标签：java, spring, jakarta-ee

我想创建一个创建 Client 实例的 bean（来自 Elasticsearch）。但是我之前没有在 Spring 中配置过工厂 bean，所以我想知道我是否在阅读后得到了它。因为只有在我认为我必须使用 factory-bean 属性而不是静态版本时才应该打开和关闭连接，因为我想`close`在应用程序关闭时调用该方法。`close`当我使用类属性时，我没有设法调用该方法。

这是正确的用法吗？我只想要一个工厂和一个连接，并且我想在客户端关闭时调用 close 。

```
<bean id="clientFactory" class="my.company.ClientFactory" destroy-method="close" />
<bean id="searchClient" factory-bean="clientFactory" factory-method="getClient" /> 
```

工厂：

```
public class ClientFactory {

    private Client client;

    public Client getClient() {

        if (client != null) {
            return client;
        }

        Client transportClient = new TransportClient().addTransportAddress(new InetSocketTransportAddress("localhost", 9300));
        client = transportClient;

        return client;
    }

    public void close() {
        client.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:37:52.623

它看起来足够接近。我建议通过执行进行验证。也许写一段代码来测试它。这比找人为你做这件事要快。

# php - 在php中上传音频文件未保存在指定文件夹中？

> ID：15718051
> 
> 赞同：0
> 
> 时间：2013-03-30T11:32:03.473
> 
> 标签：php, mysql, file-upload, uploading

这是我的 form.php

```
 <form name="form" action="upload.php" method="post" enctype="multipart/form-data">
                <?php $id=$_REQUEST['id1']; ?>
        <label>Category: </label><?php echo
        '<input type="text" name="category" onfocus="blur()" value='.$id.'>'?></br>
            <label>Name:</label>
            <input type="text" name="name" size="32"></br></br>
            <label>Type:</label>
            <select name="type">
                <option value="Audio">Audio</option>
                <option value="Video">Video</option>
                <option value="Read">Read</option>
                <option value="Quiz">Quiz</option>
            </select>
            <label>Description:</label></br>
            <textarea rows="10" cols="30" name="description"></textarea></br>                  </br>
            <label>File:</label>
            <input type="file" name="files"/></br>
            <input type="submit" value="upload" name="up">
        </form> 
```

和我的upload.php

```
 include("connect.php");

        if(isset($_REQUEST['up']))
        {
        $nagan=$_FILES['files']['name'];    
        $tmp_loc=$_FILES['files']['tmp_name'];

         echo $nagan;
         echo $tmp_loc;
            $bookCover="modules/".$nagan;

            move_uploaded_file($tmp_loc,$bookCover);

            $sql="INSERT INTO modules (name, type, description, filename, category)VALUES('$_POST[name]','$_POST[type]','$_POST[description]','$bookCover','$_POST[category]')";

           mysql_query($sql);

    $count=mysql_affected_rows();

    if($count==1)
    {

      echo "File $nagan Successfully Uploaded!";

    }else
      echo "Error!";

      }

    ?> 
```

上传图像和 pdf 文件工作正常，但是当我尝试上传音频文件时，它不会显示在指定的文件夹（模块文件夹）中，但它会在数据库中保存一个值。此外，当我尝试上传视频文件时，upload.php 根本不起作用。请帮我。我想弄清楚这两天了。帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:38:36.140

`upload_max_filesize`你的和`post_max_size`的价值是什么`php.ini`？您尝试上传的音频文件的大小是多少？

```
 print ini_get('upload_max_filesize').' MBytes (Upload max size) <br/>'.
        ini_get('post_max_size').' MBytes (Post Max Size)'; 
```

这两个以 MBbytes 为单位显示结果。如果这个太小，

```
1) Try: ini_set('upload_max_filesize','the size you need');
        ini_set('post_max_size','the size you need');
2) If the 1) does not works : 
  try to set the value of this properties in your php.ini  
      (on linux use this command to find: locate php.ini, or find / -name php.ini)
      (on windows use the file search tool)
  restart apache /if you use apache/ or the webserver deamon what you use
3) If you could not do 1) or 2)  (because do not have access this property) contact to the server administrator. 
```

而在这些都尝试上传小（小于1MB）的音频和视频文件之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:38:37.053

以下选项是相关的：

PHP: upload_max_filesize (in php.ini or .htaccess only, won't work using ini_set())

PHP: post_max_size

PHP: max_input_time

and possibly

Apache: LimitRequestBody

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T11:41:31.527

There may be permission problem in php.ini for max upload size.

```
upload_max_filesize = 10M 
```

; Must be greater than or equal to upload_max_filesize

```
post_max_size = 10M 
```

You can change it too, and restart the server.

# c# - 如何在 aspx 中循环传递 DataTable 值？

> ID：15718052
> 
> 赞同：2
> 
> 时间：2013-03-30T11:32:26.303
> 
> 标签：c#, javascript, asp.net

我有一个名为 dt5 的 DataTable，它有 4 行。我正在尝试从 dt5 传递 aspx 中的图像 src，但它不起作用。这是我的代码...

```
<%
    for (int i = 0; i < dt5.Rows.Count; i++)
         {
           string   a = dt5.Rows[0]["imageurl"].ToString();
           string b = dt5.Rows[1]["imageurl"].ToString();
           string c = dt5.Rows[2]["imageurl"].ToString();
      %> 
       <div id="Div1"  class="image_stack" style="margin-left:600px" runat="server" >
        <img id="Img1"  class="stackphotos photo1" src="<%a%>"   />
        <img id="Img2"  class="stackphotos photo2" src="<%b%>"  />
          <img id="Img3"   class="stackphotos photo3" src="<%c%>" />
     </div>
         <br /><br /><br /><br /><br /><br /><br />
      <% } %> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T11:56:56.157

你没忘记 (:) 吗？如果它给出任何错误，那么

应该这样写：

```
<%: a %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:49:50.180

`public string a,b,c;`在 html 中使用该变量之前，您需要在后面的代码中声明变量 a、b、c

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T11:53:46.120

我不熟悉您在上面发布的代码。但在我结束时，我已经尝试并找到了解决方案。我创建了一个测试应用程序，它对我有用。请试试：

```
<% for (int i = 0; i < 5; i++)
       {
           string a = "11.png";
           a = "11.png";
           StringBuilder sb = new StringBuilder();
           sb.Append("<div id='Div1' class='image_stack' style='margin-left: 600px' runat='server'>");
           sb.Append("<img id='Img1' class='stackphotos photo1' src='" + a + "'/>");
           sb.Append("  </div>");
    %>
    <% Response.Write( sb.ToString()); %>

    <br />
    <br />
    <br />
    <br />
    <br />
    <% } %> 
```

# c# - 无法枚举 CodeBehind 中的控件

> ID：15718061
> 
> 赞同：0
> 
> 时间：2013-03-30T11:33:56.247
> 
> 标签：c#, asp.net, user-interface, controls, enumeration

我已经在我的`*.aspx`页面中定义了 html 表而不是 asp-tags 之一。然后我在该表的行中添加了一些 asp 控件：`<asp:CheckBox>`.

我已经定义了很多复选框，因为我需要为用户提供大量的选择并且我不能最小化复选框的数量。

在`CodeBehind`我想枚举整个控件以查找我需要的内容`GetType().Name`，然后将其添加到临时列表中以供将来操作。

但是我遇到了麻烦，在调试器中我看不到任何复选框，并且控件的数量非常少。

我正在枚举页面中的控件，如下所示：

```
foreach (var item in Page.Controls)
{
    if (item.GetType().Name == "CheckBox")
    {
         CheckBox checkBox = item as CheckBox;

         if (checkBox.ID != null && checkBox.ID != String.Empty && checkBox.Checked)
         {
             arrayDocs.Add(checkBox.ID);
         }
    }
} 
```

我的页面的完整代码：

aspx： http: [//pastebin.com/gUs2LchL](http://pastebin.com/gUs2LchL)

背后的代码：http: [//pastebin.com/5tfnKJSt](http://pastebin.com/5tfnKJSt)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T19:40:44.363

根据[MSDN ，Control.Controls 属性返回该控件的](http://msdn.microsoft.com/en-us/library/system.web.ui.control.controls.aspx)**子**控件的集合，而不是**后代**。只有**直接**包含在该控件中的服务器端控件才会成为集合的一部分。

如果您想在页面上构建所有控件的集合，您将需要递归地循环遍历控件以添加它们的子控件等等 - 正如 Magnus 正确说明的那样。

最有效/最有效的方法是从复选框的父容器构建集合，在本例中是 HtmlTable“tableDocs”的单元格。

改变-

```
foreach (var item in Page.Controls) 
```

至-

```
foreach (var item in tableDocs.Controls) 
```

然后，在到达复选框之前，您需要将子控件递归循环到至少两个级别（行 -> 单元格 -> 复选框）。

可能更直接的方法是使用泛型并创建一个类型化的 CheckBox 列表，其中包含您希望测试的所有复选框。

就像是-

```
var checkboxes = new List<CheckBox>{checkboxAuctionHistory, checkboxBackSaldo, checkboxBalanceDecrypted}; //And so on

    foreach (var checkbox in checkboxes)
    {
        if (!string.IsNullOrWhiteSpace(checkbox.ID) && checkbox.Checked)
            {
                arrayDocs.Add(checkbox.ID);
            }
        }
    } 
```

这有一个明显的缺陷，即每次向表单添加新复选框时都需要记住更改列表。

或者将复选框移出表或从中删除 runat="server" 属性，从 ASP.NET 控件树中删除表，并使复选框的容器为“form1”。

页面上的大多数其他标记都没有 runat="server"，因此这些元素不是 ASP.NET 控件树的一部分。

# linux - How to autostart jobs when using zsh

> ID：15718062
> 
> 赞同：1
> 
> 时间：2013-03-30T11:33:57.840
> 
> 标签：linux, bash, shell, background, zsh

I switched to zsh for my daily usage recently. One problem that I come across is that how I can autostart some background command line executable(for example, `fetchmail -d 1800`). When I add the line into `~/.zprofile` or `~/.zshrc`, everything goes fine until I open another zsh process instance(in fact, I am using `tmux` so it happens frequently), fetchmail complains that

```
 fetchmail: can't accept options while a background fetchmail is running. 
```

I thought that `~/.zprofile` might only be executed once, but It seems that I was wrong. So how can I handle it properly?

Thanks.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T14:05:52.760

**Edit:** Better than original idea (from comment below):

```
ps -C fetchmail >/dev/null || fetchmail -d 1800 
```

* * *

**Fixed original idea:**

How about checking if there is process in background already running and running `fetchmail` only if it isn't:

```
[ -z `ps aux | grep "fetchmail" | grep -v "grep"` ] && fetchmail -d 1800 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T14:37:58.733

Why do you need to start it in zsh configuration file? All or almost all of window managers and desktop environments support running commands at startup. For example, when using fluxbox you can just add this startup line into `$HOME/.fluxbox/startup`.

Note: `.zprofile` is read each time somebody starts a login shell. `.zshrc` is read each time somebody starts interactive shell. `.zshenv` is read each time somebody starts a shell (no matter which). (Unless explicitly turned off by command-line arguments.) There is really no configuration file which is read only once.

# google-chrome-extension - chrome.runtime.sendMessage not working as expected

> ID：15718066
> 
> 赞同：14
> 
> 时间：2013-03-30T11:34:36.393
> 
> 标签：google-chrome-extension, chromium

I am writing a Chrome plugin with a content script and a background script, and I am trying to make the two communicate.

In my content script, I am doing

```
chrome.runtime.sendMessage({greeting: "hello"}, function(response) {
      console.log(response.farewell);
}); 
```

and in my background script, I am doing

```
chrome.runtime.onMessage.addListener(
    function(request, sender, sendResponse) {
        console.log(sender.tab ?
          "from a content script:" + sender.tab.url :
          "from the extension");
        if (request.greeting == "hello")
            sendResponse({farewell: "goodbye"});
    }
); 
```

My manifest looks like this:

```
{
    "manifest_version": 2,
    "name": "Tesing Phase",
    "version": "1.0",
    "background": {
        "persistent": false,
        "scripts": ["bgscript.js"]
    },
    "content_scripts": [{
        "js": ["contentscript.js"],
        "all_frames": true,
        "run_at" : "document_start",
        "matches": ["*://*/*"]
    }],
    "web_accessible_resources": ["script.js"]
} 
```

When I run my plugin, I get the following error:

```
Uncaught TypeError: Object #<Object> has no method 'sendMessage' 
```

I tried logging `chrome.runtime`, and there was no method `sendMessage`. I am using version 25.0 of Chromium on Ubuntu. I tried using `sendRequest` as well, but it said it's depreciated and `sendMessage` should be used.

Can anyone point me out what I am missing here? Are there any permissions needed for this to work?

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-30T12:01:48.957

[`chrome.runtime.sendMessage`](https://developer.chrome.com/docs/extensions/reference/runtime/#method-sendMessage) / [`onMessage`](https://developer.chrome.com/docs/extensions/reference/runtime/#event-onMessage) (and other related events/methods such as [`connect`](https://developer.chrome.com/docs/extensions/reference/runtime/#method-connect)) were introduced in Chrome 26.

If you want to write an extension which is compatible with Chrome 20 - 25, use `chrome.extension.sendMessage`.

A way to achieve optimal compatibility is to define the `chrome.runtime` methods yourself. For example, run the following code before the rest of your code (background/content script):

```
if (!chrome.runtime) {
    // Chrome 20-21
    chrome.runtime = chrome.extension;
} else if(!chrome.runtime.onMessage) {
    // Chrome 22-25
    chrome.runtime.onMessage = chrome.extension.onMessage;
    chrome.runtime.sendMessage = chrome.extension.sendMessage;
    chrome.runtime.onConnect = chrome.extension.onConnect;
    chrome.runtime.connect = chrome.extension.connect;
} 
```

Then you can just use the latest API format:

```
// Bind event:
chrome.runtime.onMessage.addListener(function(message, sender, sendResponse) {
    // Do something
});

// Send message:
chrome.runtime.sendMessage({greeting: 'hello'}); 
```

If you feel uncomfortable with modifying methods on the `chrome.runtime` object, you can use the following approach *instead*:

```
var runtimeOrExtension = chrome.runtime && chrome.runtime.sendMessage ?
                         'runtime' : 'extension';

// Bind event:
chrome[runtimeOrExtension].onMessage.addListener(
  function(message, sender, sendResponse) {
    // Do something
});

// Send message:
chrome[runtimeOrExtension].sendMessage({greeting: 'hello'}); 
```

# python - 搜索文件并找到精确匹配并打印行？

> ID：15718068
> 
> 赞同：18
> 
> 时间：2013-03-30T11:34:49.233
> 
> 标签：python, file, search, match

我四处搜寻，但找不到任何帖子来帮助我解决此问题，我发现了类似的但无论如何我都找不到任何解决此问题的方法。

这是我遇到的问题，我正在尝试让 python 脚本搜索文本文件，文本文件在列表中有数字，每个数字对应于一行文本，如果 raw_input 匹配是文本文件中的确切数字它打印整行文本。到目前为止它打印包含数字的任何行。

问题示例，用户类型`20`然后输出是包含 a`2`和 a 的所有内容`0`，所以我得到`220 foo` `200 bar`等。我该如何解决这个问题，所以它只找到“20”

这是我的代码

```
num = raw_input ("Type Number : ")
search = open("file.txt")
for line in search:
 if num in line:
  print line 
```

谢谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-10-25T15:29:55.830

**建立匹配行列表 - 几种风格：**

```
def lines_that_equal(line_to_match, fp):
    return [line for line in fp if line == line_to_match]

def lines_that_contain(string, fp):
    return [line for line in fp if string in line]

def lines_that_start_with(string, fp):
    return [line for line in fp if line.startswith(string)]

def lines_that_end_with(string, fp):
    return [line for line in fp if line.endswith(string)] 
```

**构建匹配行的生成器（内存高效）：**

```
def generate_lines_that_equal(string, fp):
    for line in fp:
        if line == string:
            yield line 
```

**打印所有匹配的行（首先找到所有匹配，然后打印它们）：**

```
with open("file.txt", "r") as fp:
    for line in lines_that_equal("my_string", fp):
        print line 
```

**打印所有匹配的行（懒惰地打印它们，因为我们找到它们）**

```
with open("file.txt", "r") as fp:
    for line in generate_lines_that_equal("my_string", fp):
        print line 
```

生成器（*由 yield*生成）是您的朋友，尤其是对于不适合内存的大文件。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-30T11:38:39.247

要检查*完全*匹配，您将使用`num == line`. 但是`line`有一个行尾字符`\n`，或者由于去掉了尾随的换行符`\r\n`而不会出现。因此，在with的末尾删除所有空格可能会很方便`num``raw_input``line`

```
line = line.rstrip() 
```

* * *

```
with open("file.txt") as search:
    for line in search:
        line = line.rstrip()  # remove '\n' at end of line
        if num == line:
            print(line ) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-30T11:58:00.300

你应该使用正则表达式来找到你需要的一切：

```
import re
p = re.compile(r'(\d+)')  # a pattern for a number

for line in file :
    if num in p.findall(line) :
        print line 
```

正则表达式会将一行中的所有数字作为列表返回，例如：

```
>>> re.compile(r'(\d+)').findall('123kh234hi56h9234hj29kjh290')
['123', '234', '56', '9234', '29', '290'] 
```

所以你不匹配 '200' 或 '220' 为 '20'。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-30T11:55:50.080

这很容易：

```
numb = raw_input('Input Line: ')
fiIn = open('file.txt').readlines()
for lines in fiIn:
   if numb == lines[0]:
      print lines 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-30T13:52:26.033

```
num = raw_input ("Type Number : ")
search = open("file.txt","r")
for line in search.readlines():
    for digit in num:
        # Check if any of the digits provided by the user are in the line.
        if digit in line:
            print line
            continue 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-30T11:48:43.650

检查必须是这样的：

```
if num == line.split()[0]: 
```

如果 file.txt 有这样的布局：

```
1 foo
20 bar
30 20 
```

我们分成`"1 foo"`并`['1', 'foo']`只使用第一项，即数字。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-06-04T12:59:20.307

例如，如果您想显示其中包含单词“password”的行，

```
import re;
fpointer = open("access.log", "r");

for i in fpointer.readlines():
   line= re.findall(r'password', i);
   if line:
    print(i);
fpointer.close(); 
```

# php - php清理手机变量

> ID：15718078
> 
> 赞同：1
> 
> 时间：2013-03-30T11:36:24.790
> 
> 标签：php

我想在数据库中记录人们的电话号码。由于人们输入的数字不同（基于区号）等，我想在输入数据库之前将他们输入的任何内容标准化为标准方式，然后当我从数据库中读回它并放在页面上时，它就来了像这样**1-954-999-9999**以这种格式输出，然后我可以附加`<a href="tel:1-954-999-9999">1-954-999-9999</a>`并且可以从网络应用程序/或普通站点单击以拨打电话。

说了这么多，我有一个问题。

在 POST 上，这就是我处理它的方式

```
$compBizNumber = mysqli_real_escape_string($c2d, $_POST['compBizNumber']) ;
$compBizNumber = str_replace("(", "-", $compBizNumber);
$compBizNumber = str_replace(")", "-", $compBizNumber);
$compBizNumber = str_replace(" ", "-", $compBizNumber);
$compBizNumber = filter_var($compBizNumber,FILTER_SANITIZE_NUMBER_INT) ; 
```

有没有办法一次性替换多个字符？

我该怎么办？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T11:39:20.490

[str_replace](http://php.net/str_replace)接受一个数组作为第一个（和第二个参数），所以这样做：

```
$compBizNumber = str_replace(array("(", ")", " "), "-", $compBizNumber); 
```

However, a more flexible way would be to use a regular expression to replace all non-numeric characters:

```
$compBizNumber = preg_replace("/[^0-9]/", "-", $compBizNumber); 
```

This way you don't have to add all possible characters a user would enter into str_replace.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T11:42:16.930

Why not use a regex to remove all except numbers:

```
$myNumber = "+31 (0) 43 - 123 345 67";
preg_replace("/[^0-9]/","", $myNumber); 
```

[http://codepad.org/30vUqWWC](http://codepad.org/30vUqWWC)

However, beware of the `+` I guess you'd have to replace that with 00 instead of nothing in order to make the number work? Not 100% sure about that one.

# php - PHP PDO Select result showing as array

> ID：15718081
> 
> 赞同：-2
> 
> 时间：2013-03-30T11:36:33.600
> 
> 标签：php, mysql, pdo

I am trying to get the (float) value from a database, but when I print the result it is showing as 'Array' instead of the value (20).

Here is the code:-

```
public static function getTourFare($fieldTour) {

       $pdo = new SQL();
       $dbh = $pdo->connect(Database::$serverIP, Database::$serverPort, Database::$dbName, Database::$user, Database::$pass);

       try {

           $query =   "SELECT Fare FROM tbltours
                       WHERE TourName = '$fieldTour'";

           $stmt = $dbh->prepare($query);

           $stmt->execute();

           $result = $stmt->fetchAll();

           $stmt->closeCursor();

           print_r($result[0]);

           return $result;

           $dbh = null;

       }

       catch (PDOException $pe) {
           die("Error: " .$pe->getMessage(). " Query: ".$stmt->queryString);
       }

} 
```

I know it is only selecting one value and shouldn't return an array of values. I believe the issue is `$stmt->fetchAll();`, but I'm not quite sure what this needs to be changed to?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:44:26.187

From [`fetchAll()`](http://php.net/manual/en/pdostatement.fetchall.php) documentation

> **`PDOStatement::fetchAll()`** returns an array containing all of the remaining rows in the result set. The array represents each row as either an array of column values or an object with properties corresponding to each column name.

You can use [`fetchColumn()`](http://www.php.net/manual/en/pdostatement.fetchcolumn.php) to fetch just a string result.

# php - 下载存储在 Amazon S3 php 脚本中的图像

> ID：15718083
> 
> 赞同：-2
> 
> 时间：2013-03-30T11:36:39.207
> 
> 标签：php

我有一个 S3 帐户来存储所有图像。

```
mysite.s3.amazonaws.com/imagename.JPG 
```

这个 URL 是秘密的，我在哪里上传受限用户。我必须为这个秘密图像创建下载 URL。此下载网址仅供上传用户使用。

我如何在 php 中编写代码以安全地下载图像文件。

可能是 url 看起来像：`mysite.com/restrictedimage.php?mid=xyztokens234`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:48:37.833

您可以设计一个简单的数据库表（或配置文件）来记录令牌和受保护 URL 之间的相关性，然后在您的 restrictedimage.php 脚本中，您只需检查令牌并将用户重定向到实际链接。

相反，如果您希望对您的 URL 保密，您应该定期下载图像并将其缓存在您的服务器中，然后直接输出回图像，而不是重定向。

Example code for option 1:

```
$token = isSet($_GET['mid'])?$_GET['mid']:null;
if(!$token) die("No token");
$realURL = retrieveUrlFromToken($token);
if(!$realURL) die("Invalid token");
header("Location: http://mysite.s3.amazonaws.com/" . $realURL); 
```

Example code for option 2:

```
$token = isSet($_GET['mid'])?$_GET['mid']:null;
if(!$token) die("No token");
$realURL = retrieveUrlFromToken($token);
if(!$realURL) die("Invalid token");
$file = file_get_contents("http://mysite.s3.amazonaws.com/".$realURL);
header("Content-Type: application/force-download");
header("Content-Length: " . strlen($file));
header("Content-Transfer-Encoding: binary");
echo $file; 
```

Notice that `retrieveUrlFromToken` could simply be an identity function, if you don't want to hide the real path, but I'd suggest you to do something better, otherwise the whole script is useless.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:44:04.110

使用此代码下载图像文件

```
<a href="download.php?filename='imagename.JPG'>Download</a> 
```

下载.php

```
<?php

    $filename ="http://mysite.s3.amazonaws.com/" . $_GET["filename"];
    $buffer = file_get_contents($filename);
    header("Content-Type: application/force-download");
    header("Content-Type: application/octet-stream");
    header("Content-Type: application/download");
    header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
    header("Content-Type: application/octet-stream");
    header("Content-Transfer-Encoding: binary");
    header("Content-Length: " . strlen($buffer));
    header("Content-Disposition: attachment; filename=$filename");
    echo $buffer; 
?> 
```

# python - 在 Python 中打印简单消息

> ID：15718087
> 
> 赞同：0
> 
> 时间：2013-03-30T11:37:31.593
> 
> 标签：python, windows, printf, ctypes

我已经安装了 Python 2.7.3 和 PyScripter。当我尝试运行这个简单的代码时，interupter 没有显示任何内容：

```
from ctypes import *
msvcrt = cdll.msvcrt
message_string = "Hello world!\n"
msvcrt.printf("Testing: %s".encode('ascii'), message_string.encode('ascii') 
```

（也试过没有编码）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T11:50:55.443

在交互式外壳中为我工作：

```
>>> msvcrt.printf("Testing: %s".encode('ascii'), message_string.encode('ascii'))

Testing: Hello World!
22 
```

尝试将其放入 .py 文件中，然后从 cmd 运行

```
python C:\path\to\file 
```

# java - Exporting to Jar Changes File Hierarchy

> ID：15718090
> 
> 赞同：0
> 
> 时间：2013-03-30T11:37:49.203
> 
> 标签：java, eclipse, jar

I think I may be missing something really obvious here, but I can't seem to find any options in Eclipse or an ANT build script:

My Java Eclipse project looks like this:

```
src/
   com/
res/
   sound/
   font/
docs/
libs/ 
```

so on and so forth, all at the top level. However, when Eclipse exports my project to a runnable jar, inside the jar, the res/ folder doesn't exist, and instead all of the folders inside the res folder (sound, font, etc), are in the top level of the jar.

This causes problems, as my application looks for files in res/sound - which works fine when using Eclipse's debugging tool.

How can I stop Eclipse moving my res/ directory around?

Thanks!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:00:33.500

This behavior is normal. Do not try to avoid it.

Try to get your files as InputStream instead of java.io.File

for example :

```
System.class.getResourceAsStream("/sound/mySound.mp3"); 
```

# c# - 如何实现动作委托？

> ID：15718091
> 
> 赞同：0
> 
> 时间：2013-03-30T11:37:51.850
> 
> 标签：c#, linq

我有一堂课

```
 public class TextBoxConfig
    {
        public string Caption { get; set; }
        public string FieldName { get; set; }
        public int Width { get; set; }
        public string Name { get; set; }
    } 
```

和另一个实用程序类，它有一个接受 TextBoxConfig 作为参数的方法，像这样

```
 public class Util
    {
      public static TextBox ApplySettings(TextBoxConfig  config)
      {
         //Doing something
      }
    } 
```

一般来说，我可以像这样调用 Util 类 ApplySettings 方法

```
 TextBoxConfig config  = new TextBoxConfig();
    config.Caption = "Name";
    config.FieldName = "UserName"
    config.Width = 20;
    config.Name = "txtName";

    TextBox txt = Util.ApplySettings(config); 
```

但我想像这样将参数传递给 ApplySettings

```
 TextBox txt = Util.ApplySettings(o =>
    {
        o.Caption = "Name";
        o.FieldName = "UserName"
        o.Width = 20;
        o.Name = "txtName";
    }); 
```

请建议我该怎么做..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:58:44.060

与您的愿望不完全相同，但非常接近：

```
TextBox txt = Util.ApplySettings(new TextBoxConfig()
{
    Caption = "Name",
    FieldName = "UserName",
    Width = 20,
    Name = "txtName"
}); 
```

请注意每个设置后的逗号。请参阅[http://msdn.microsoft.com/en-us/library/vstudio/bb397680.aspx](http://msdn.microsoft.com/en-us/library/vstudio/bb397680.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:21:28.350

好吧，振作起来：这也是一样的，只是用 lambda 表达式强制执行。

```
TextBox txt = Util.ApplySettings(o =>
{
    o.Caption = "Name";
    o.FieldName = "UserName";
    o.Width = 20;
    o.Name = "txtName";
});

public class Util
{
    public static TextBox ApplySettings(TextBoxConfig config)
    {
        //Doing something
    }

    public static TextBox ApplySettings(Action<TextBoxConfig> modifier)
    {
        var config = new TextBoxConfig();
        modifier(config);

        return ApplySettings(config);            
    }
} 
```

我不得不在语句之后添加一些分号。我更喜欢另一个答案。但我希望这能满足你对 lambda 表达式的渴望。

# keyboard-shortcuts - Sublime Text 2 shortcut to select a sentence

> ID：15718094
> 
> 赞同：0
> 
> 时间：2013-03-30T11:38:19.500
> 
> 标签：keyboard-shortcuts, sublimetext2

Any keyboard shortcut in Sublime Text 2 to select the string in quotation marks:

```
<input type="text" value="i want to select these texts ..." />
alert("i want to select these texts ..."); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T17:43:40.770

Under the `Selection` menu is an option `Expand Selection to Scope`, which should be what you're looking for, since strings enclosed in quotes are defined as a separate scope in most languages, including the default HTML that comes with ST2\.

I tested several languages, including HTML, JavaScript, JSON, Ruby, Perl, and Python, and all except Python selected the quotes along with the text. If you want to change that behavior you'll have to dive into `Packages/Python/Python.tmLanguage`, figure out the regexes involved, and transfer them to the `.tmLanguage` file(s) of your language(s) of choice.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T18:20:27.357

Try the [BracketHighlighter](https://github.com/facelessuser/BracketHighlighter) plugin. Use the command palette command `Select Bracket Content`. I believe that is what you are looking for. If it is, you can create a keymap with the following command (got this from logging the command, but you can also see it by looking through the sublime-commands file)

```
"keys": ["<you choose keys>"],
"command": "bh_key",
"args": {"lines": true, "plugin": {"command": "bh_modules.bracketselect", "type": ["__all__"]}} 
```

# session - OAuth or CAS for lots of domains but just one app?

> ID：15718097
> 
> 赞同：0
> 
> 时间：2013-03-30T11:38:39.120
> 
> 标签：session, oauth, single-sign-on, cas, multiple-domains

We're about to start allowing our users to point their own domains at their profile pages on our website, but I've run into a problem that I can't seem to get around.

We need to make sure that when any user who is logged into the main domain visits one of these custom domains that they are going to be logged in on this site too. I've been reading about a few different approaches. SSO, CAS, OAuth... but I'm not really sure if any of these fits what I need.

I'd love to hear some opinions on it.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:24:32.830

CAS is a SSO, it means that you will authenticate only once (just for the first app) and then you will access all app without re-authenticating. For every app in the "CAS galaxy", you'll get the profile of the authenticated user (a set of user attributes defined according to the app). The main advantages of CAS are its simplicity and its efficiency. I think it meets your needs. OAuth is about authorization : it means you will need to authenticate and authorize, which generally leads to login page for authentication and confirmation screen for authorization.

# ios - UITableView dynamic height is always 0

> ID：15718102
> 
> 赞同：1
> 
> 时间：2013-03-30T11:39:07.783
> 
> 标签：ios, height, tableview

I'm using a TableView and a Collection View in a Scroll View. I set scrolling disabled in the Table View so i need to change the height of the Table View.

I used this code to get the height, but every height was 0

```
//NSUInteger tableViewheight = self.videosArray.count * 60;  //60 is the cell height

NSUInteger tableViewHeight = self.videosTableView.contentSize.height;

CGRect frame;
frame = self.videosTableView.frame;
frame.size.height = tableViewHeight;
self.videosTableView.frame = frame; 
```

I also tried the commented code above.

Anyone an idea how i can get the height or what I'm doing wrong?

Thanks.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:10:49.190

Try this:

```
heightRateTbl = [myArray count] * 60;

rateTableView.frame = CGRectMake(10, 20, 300, heightRateTbl);  

rateTableView.scrollEnabled = NO;

rateTableView.autoresizingMask = UIViewAutoresizingFlexibleHeight;

[rateTableView reloadData]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:08:12.057

You should have try following code to set frame:-

```
[self.videosTableView reloadData];
float tableViewHeight = self.videosTableView.contentSize.height;
CGRect frame = self.videosTableView.frame;
self.videosTableView.frame = CGRectMake(frame.origin.x, tableViewHeight, frame.size.width, frame.size.height);
NSLog(@"tableViewheight height = %f",tableViewheight);
NSLog(@"videosTableView height = %f",self.videosTableView.frame.size.height); 
```

Hope it will works for you.

# iphone - NSMutableArray 包含 nil 指针

> ID：15718109
> 
> 赞同：2
> 
> 时间：2013-03-30T11:39:49.527
> 
> 标签：iphone, objective-c, ipad, nsmutablearray

我正在使用`-insertObject:atIndex:`将一些自定义类的实例添加`DecryptedItem`到`NSMutableArray`. `DecryptedItem`实现它自己的`-hash`和`-isEqual:`方法，但据我所知，当将对象添加到数组时，这无关紧要。

在索引 0 处插入一个对象后，在索引 0 处插入另一个对象，在索引 1 处插入另一个对象后，我得到以下非常奇怪的行为：该数组在调试窗口中显示为 3 个元素的数组，调用`-description`该数组显示它包含三个不同的对象。但是，在调试器中查看数组会发现一个对象为零！当我使用 搜索特定对象时，我注意到了这一点`-indexOfObject:inSortedRange:options:usingComparator:`，它返回了`NSNotFound`.

![奇怪的 NSMutableArray 行为](../Images/d1bfc323d0debaf29219659a3a90e65b.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:24:44.363

结果表明该数组未正确排序，因此`-indexOfObject:inSortedRange:options:usingComparator:`无法正常工作。现在一切似乎都很好。猜猜它实际上只是调试器古怪。

# cookies - Casperjs - thenOpen 后未启用 Cookie

> ID：15718110
> 
> 赞同：3
> 
> 时间：2013-03-30T11:39:56.147
> 
> 标签：cookies, casperjs

我正在尝试在 dom 中寻找资源，以便我关注当前页面的每个链接。问题是第一次效果很好，但是当我开始点击链接时，我收到“cookies are not enabled”。我这样调用脚本： casperjs --cookies-file=/tmp/mycookies.txt script.js 这是脚本：

```
var casper = require('casper').create({
    logLevel: "debug",              // Only "info" level messages will be logged
    verbose:true,
    onError: function(self, m) {   // Any "error" level message will be written
        console.log('FATAL:' + m); // on the console output and PhantomJS will
        self.exit();               // terminate
    },
    pageSettings: {
        javascriptEnabled: true,
        loadImages:  false,        // The WebPage instance used by Casper will
        loadPlugins: false,         // use these settings
        userAgent: 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4'
    }
});
var fs = require('fs');
casper.userAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4');
phantom.cookiesEnabled = true;
var x = require('casper').selectXPath;

function getLinks() {
    var links = document.querySelectorAll('a');
    return Array.prototype.map.call(links, function(e) {
        return e.getAttribute('href')
    });
}

function followLinks(links) {
    casper.each(links, function(self, link) {
          self.thenOpen(link, function() {
              fs.write("pages/" + link+ ".html", this.getHTML(), 'w'); //for debugging
              if (!lookFor(x('//input[@name="Export"]'))) {
                    var links = getLinks();
                    followLinks(links);
              }
         });
  });
}
casper.start('http://www.url.com', function() {
   this.fill('form#formAuth', { 
        login: 'user@url.com', 
        password:  'apass'
    }, true);
});

casper.then(function() {
    links = links.concat(this.evaluate(getLinks));
    followLinks(links);
});

casper.run(function() {
    this.exit();
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T17:35:25.467

问题是其中一个链接是注销链接：D。这就是为什么我突然收到错误

# c++ - 需要澄清以下程序，

> ID：15718120
> 
> 赞同：0
> 
> 时间：2013-03-30T11:41:01.060
> 
> 标签：c++

下面的程序会打印什么？

```
#include <iostream> 
using namespace std;    

static int x = 10;

void main1()    
{      
    cout << x << endl;    
    x = x + 1;    
}    

int main()   
{    
    main1();    
    main1();        
    cout << x << endl;    
} 
```

根据我的理解，上面的程序我们使用了静态变量，所以`x`保留了最后一个初始化的变量。所以输出将是

```
10    
11    
12 
```

但如果我们删除静态，我们应该得到

```
10    
10    
10 
```

但我得到以下输出，即使在删除静态之后。

```
10    
11    
12 
```

请帮我理解。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-30T11:43:27.237

即使`int x`不是静态的，它仍然是一个**全局**`main`变量，在and的范围之外`main1`。

因此，无论您从该文件中的任何位置对 x 所做的任何更改都将永久更改它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T11:32:50.373

由于 x 对 main1 和 main 都是全局可见的，因此 static 是否存在都没有区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T17:15:33.367

the static keyword has several meanings in C depending on where yoi use it. Read this [http://msdn.microsoft.com/en-us/library/s1sb61xd(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/s1sb61xd(v=vs.80).aspx)

# c# - 如何将内存流转换为 System.Data.Linq.Binary？

> ID：15718122
> 
> 赞同：1
> 
> 时间：2013-03-30T11:41:10.187
> 
> 标签：c#, stream, binary, sql-server-ce

我只需要进行[此问题](https://stackoverflow.com/questions/3208580/how-to-convert-system-data-linq-binary-to-a-stream)中公开的反向转换。

我有一个 MemoryStream 并想将它存储在我的 SQL CE 数据库的 System.Data.Linq Binary 字段中（仅供参考，我首先使用的是 EF 代码）。

MemoryStream 实际上是一个 XML，它大于字符串字段的最大大小，所以我发现除了将它存储在二进制文件中之外别无他法（对此主题的建议非常感谢）。

我的代码（改编）

```
 private Stream _userLayout;
   _userLayout = new MemoryStream();
   DXGridControl_Table.SaveLayoutToStream(_userLayout);
   MyDatabse.SomeTable.SomeBinaryField = _userLayout.???? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T11:56:12.637

`MemorySteam`类有`ToArray()`方法：

[`MemoryStream.ToArray Method`](http://msdn.microsoft.com/en-us/library/system.io.memorystream.toarray.aspx)：

> 将流内容写入字节数组，而不考虑 Position 属性。
> 
> 此方法以字节数组的形式返回 MemoryStream 内容的副本。如果当前实例是在提供的字节数组上构造的，则返回该实例有权访问的数组部分的副本。有关详细信息，请参阅 MemoryStream 构造函数。
> 
> *此方法在 MemoryStream 关​​闭时有效。*

有了`byte[]`您可以轻松获取`Binary`实例，因为[`Byte[]`可以使用`Binary`隐式转换](http://msdn.microsoft.com/en-us/library/system.data.linq.binary.op_implicit.aspx)：

```
MyDatabse.SomeTable.SomeBinaryField = (Binary) _userLayout.ToArray(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-30T12:03:38.513

首先有

```
 byte[] buffer = new byte[LENGTH];
        MemoryStream memoryStream  = new MemoryStream(buffer); 
```

在您的示例中，您可以使用

```
 DXGridControl_Table.SaveLayoutToStream(_userLayout);
        byte[] doSomethingwithyourData = _userLayout.GetBuffer();
        var length = _userLayout.Length; 
```

使用该信息，您可以将二进制数据写入任何内容。

> 请注意，缓冲区包含可能未使用的已分配字节。例如，如果将字符串“test”写入 MemoryStream 对象，则从 GetBuffer 返回的缓冲区长度为 256，而不是 4，其中 252 个字节未使用。要仅获取缓冲区中的数据，请使用 ToArray 方法；但是，ToArray 会在内存中创建数据的副本。

或者

```
Binary binary = new Binary(_userLayout.ToArray()); 
```

就像在另一个答案中所说的那样，二进制文件有一个隐式转换：

```
public static implicit operator Binary(byte[] value) {
    return new Binary(value); 
} 
```

你要求的例子。关于用法的一个小例子：

```
namespace Stackoverflow.Hannish.SaveLayout
{
    using System;
    using System.Collections.Generic;
    using System.IO;
    using System.Text;
    using System.Windows.Forms;

    public partial class Form1 : Form
    {
        /// <summary>
        /// Here we store the layout data as a string. This is the data, that
        /// gets saved to disk / database / etc.
        /// </summary>
        private string layoutdata = string.Empty;

        public Form1()
        {
            this.InitializeComponent();
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            // Just some FooBar data.
            var data = new List<DataValue>
                           {
                               new DataValue { Id = 1, Name = "Xyz", IsCool = true }, 
                               new DataValue { Id = 2, Name = "Abc", IsCool = false }
                           };

            this.gridControl1.DataSource = data;
        }

        private void bnLoadLayout_Click(object sender, EventArgs e)
        {
            using (var stream = new MemoryStream())
            {
                var strdata = Encoding.Default.GetBytes(this.layoutdata);
                stream.Write(strdata, 0, strdata.Length);
                stream.Seek(0, SeekOrigin.Begin);
                this.gridView1.RestoreLayoutFromStream(stream);
            }
        }

        private void bnSaveLayout_Click(object sender, EventArgs e)
        {
            using (var stream = new MemoryStream())
            {
                this.gridView1.SaveLayoutToStream(stream);
                this.layoutdata = Encoding.Default.GetString(stream.ToArray());
            }
        }
    }
} 
```

还有一些字节到文件魔术：

```
 private void bnLoadBinLayout_Click(object sender, EventArgs e)
    {
        using (FileStream fstream = File.Open("Layoutdata.bin", FileMode.Open))
        {
            int length = (int)fstream.Length;
            byte[] buffer = new byte[length];
            fstream.Read(buffer, 0, length);

            var memstream = new MemoryStream(buffer);
            this.gridView1.RestoreLayoutFromStream(memstream);
        }
    }

    private void bnSaveBinLayout_Click(object sender, EventArgs e)
    {
        using (FileStream fstream = File.Create("Layoutdata.bin"))
        {
            var memstream = new MemoryStream();
            this.gridView1.SaveLayoutToStream(memstream);
            fstream.Write(memstream.GetBuffer(), 0, (int)memstream.Length);
        }
    } 
```

......就像一个例子。DevExpress GridView 可以使用 SaveLayoutToXml() 保存布局本身；

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T12:43:02.413

对于您的第二个问题和来回转换数据的（可能的）概念错误。

将那个有趣的 DevExpress XML 保存在 ntext 数据列中。

> ntext: Variable-length Unicode data with a maximum length of (2^30–2)/2 (536,870,911) characters. Storage size, in bytes, is two times the number of characters entered.

See [SQL Server Compact 4.0 Data Types](http://msdn.microsoft.com/en-us/library/ms172424.aspx)

# matrix - Numpy加载并保存ijv（行列值）格式

> ID：15718126
> 
> 赞同：2
> 
> 时间：2013-03-30T11:41:35.393
> 
> 标签：matrix, numpy

我想将一个文件读入一个 numpy 矩阵。在这个文件中，每一行都有“行；列；值”的结构，所以像这样的矩阵

```
m = numpy.matrix([[1,2,3],[4,5,6]]) 
```

将位于以以下行开头的文件中：

```
0;0;1
0;1;2
0;2;3
1;0;4
... 
```

我没有发现在 Numpy 中加载和保存此类文件的内置方式，手动执行此操作可能非常慢。你会建议哪种方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T15:00:25.857

没有内置的方法。正如评论中所指出的，保存形状通常要快得多，然后保存矩阵的平面 1D 版本。但是，除非您的矩阵很大，否则手动操作并不是一个巨大的瓶颈。有很多方法可以做到这一点，这里有一个例子`numpy.nditer`：

```
m = np.matrix([[1,2,3],[4,5,6]])
f = open('output.txt', 'w')
it = np.nditer(m, flags=['multi_index'])
while not it.finished:
    f.write('%i;%i;%i\n' % (it.multi_index[0], it.multi_index[1], it[0]))
    it.iternext() 
```

这将给出：

```
0;0;1
0;1;2
0;2;3
1;0;4
1;1;5
1;2;6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T16:36:21.023

您可以构建一些简单的函数来进行这些转换：

```
def to_ijv(a):
    rows, cols = a.shape
    ijv = np.empty((a.size,), dtype=[('i', np.intp),
                                     ('j', np.intp),
                                     ('v', a.dtype)])
    ijv['i'] = np.repeat(np.arange(rows), cols)
    ijv['j'] = np.tile(np.arange(cols), rows)
    ijv['v'] = a.ravel()
    return ijv

def from_ijv(ijv):
    rows, cols = np.max(ijv['i']) + 1, np.max(ijv['j']) + 1
    a = np.empty((rows, cols), dtype=ijv['v'].dtype)
    a[ijv['i'], ijv['j']] = ijv['v']
    return a 
```

If your matrices are large, you can use the built-in `loadtxt` and `savetxt` to read and write to disk:

```
def save_ijv(file_, a):
    ijv = to_ijv(a)
    np.savetxt(file_, ijv, delimiter=';', fmt=('%d', '%d', '%f'))

def read_ijv(file_):
    ijv = np.loadtxt(file_, delimiter=';',
                     dtype=[('i', np.intp),('j', np.intp),
                            ('v', np.float)])
    return from_ijv(ijv) 
```

These functions have a liking for floating point numbers, so you will have to explicitly edit the format if you want e.g. integers. Other than that it works nicely:

```
>>> a = np.arange(1, 7).reshape(3, 2)
>>> a
array([[1, 2],
       [3, 4],
       [5, 6]])
>>> to_ijv(a)
array([(0L, 0L, 1), (0L, 1L, 2), (1L, 0L, 3), (1L, 1L, 4), (2L, 0L, 5),
       (2L, 1L, 6)], 
      dtype=[('i', '<i8'), ('j', '<i8'), ('v', '<i4')])
>>> import StringIO as sio
>>> file_ = sio.StringIO()
>>> save_ijv(file_, a)
>>> print file_.getvalue()
0;0;1.000000
0;1;2.000000
1;0;3.000000
1;1;4.000000
2;0;5.000000
2;1;6.000000

>>> file_.pos = 0
>>> b = read_ijv(file_)
>>> b
array([[ 1.,  2.],
       [ 3.,  4.],
       [ 5.,  6.]]) 
```

# cocos2d-iphone - 在它们之间的小距离内检测 CCSprite 触摸

> ID：15718127
> 
> 赞同：0
> 
> 时间：2013-03-30T11:41:35.613
> 
> 标签：cocos2d-iphone

我在 a 中有一些小精灵（宽度/高度），`CCLayer`我想检测其中哪些被触摸。我使用以下代码。

```
- (BOOL) ccTouchBegan:(UITouch *)touch withEvent:(UIEvent *)event {
    CGPoint touchLocation = [self convertTouchToNodeSpace:touch];

    CGRect rect = sprite.boundingBox;

    // i am doing this because of the small size of the sprites, 
    // so it would be more easy to detect if a sprite is taped and then move it.
    if (rect.size.width > rect.size.height) {
        rect.size.width *= 2.5;
        rect.size.height *= 5;
        rect.origin.y -= rect.size.height / 2;

    } else {
        rect.size.width *= 5;
        rect.size.height *= 2.5;
        rect.origin.x -= rect.size.width / 2;
    }

    CCSprite *s = nil;
    for (CCSprite *sprite in [self children]) {
        if (CGRectContainsPoint(rect, touchPoint)) {
            s = sprite;
            break;
        }
    }

    if (s != nil) {
        // do something here
    }

    return YES;
} 
```

除非两个精灵彼此非常接近（不重叠），否则一切正常。然后由于它们之间的距离很小，检测到错误的精灵。

知道我该如何纠正吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:09:37.207

如果您试图扩大矩形，使其中心保持在原来的位置，您应该使用：

```
 rect.origin.y -= (rectFinalHeight - rectOriginalHeight) / 2; 
```

和

```
 rect.origin.y -= (rectFinalWidth - rectOriginalWidth) / 2; 
```

这将是：

```
if (rect.size.width > rect.size.height) {
    rect.size.width *= 2.5;
    rect.size.height *= 5;
    rect.origin.y -= rect.size.height * 4 / 2;

} else {
    rect.size.width *= 5;
    rect.size.height *= 2.5;
    rect.origin.x -= rect.size.width * 4 / 2;
} 
```

IMO，您应该在两种情况下都沿两个轴调整矩形原点（不仅在一种情况下沿 x 轴，在另一种情况下沿 y 轴），否则您的矩形将不会居中。但是你更了解你想要做什么，在这里......

# c++ - Initialize enum variable in header

> ID：15718130
> 
> 赞同：1
> 
> 时间：2013-03-30T11:41:57.023
> 
> 标签：c++

I'm creating a new enum:

```
enum WState {SLEEPING=2, WAITING_FOR_DATA=3, SENDING=4, IDLE=5, ERROR=6}; 
```

Then I'm trying to initialize a variable of that enum type to a default state straight after.

```
WState CurrentState = WState::ERROR; 
```

I can't figure out the correct syntax or maybe I'm missing some vital keywords when searching for an answer. It says:

> data member initializer not allowed

![enter image description here](../Images/afa1987540a2e880641a0f5886e4a63a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:54:38.643

In C++11, what you are doing is allowed. In C++03, however, you have to perform the initialization in the class constructor (possibly in an initialization list, as shown below):

```
class Wireless
{
public:
    enum WState { /* ... */, ERROR = 6 };
    WState CurrentState;
    Wireless() : CurrentState(WState::ERROR)
    { /* ... */ }

    // ...
}; 
```

# javascript - Node.js - Break out of callback function and return true/false in the parent functon

> ID：15718132
> 
> 赞同：1
> 
> 时间：2013-03-30T11:42:08.243
> 
> 标签：javascript, mysql, node.js, callback, asynccallback

I'm using the Node Express framework to build an API and I run into a problem regarding the Basic Auth functionality. I need to run an SQL query to retrieve information about a user and validate their credentials. The issue occurs after the query has been completed. The SQL data is sent into a callback function as shown below. I want to do all the validation inside that callback but I want to break out of the SQL callback **and** return true/false from the express.basicAuth() function. I have tried setting a global variable and then accessing it outside of the SQL callback but sometimes the query might not have finished by the time that it gets the block that accesses that global variable. Thanks in advance for your help.

```
var auth = express.basicAuth(function(user, pass) {

    // Query to select information regarding the requested user
    /* Query here to find the requested user's data */

    client.query(query, function (err, rows, fields) {
        if (err) throw err;
        GLOBAL.sql = rows; 

        /* I want to break out of this query callback function and return true from this auth variable */

    });

       // Sometimes the query isn't completed when it gets to this stage
       console.log(JSON.stringify(GLOBAL.sql));

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:50:37.337

`express.basicAuth` also supports asynchronous operation:

```
var auth = express.basicAuth(function(user, pass, next) { 
  ...
  client.query(query, function (err, rows, fields) { 
    if (err)
      next(err);
    else
    if (/* authentication successful */)
      next(null, user); // <-- sets 'req.remoteUser' to the username
    else
      next(null, false);
  });
}); 
```

# python-3.x - Python Tkinter 输入字段值比较问题

> ID：15718134
> 
> 赞同：0
> 
> 时间：2013-03-30T11:42:14.660
> 
> 标签：python-3.x, tkinter

我正在尝试开发一个程序，用户输入一些文本然后按提交，它将获取输入字段中的文本并将其与另一个值进行比较。

```
root=Tk()
win1=Frame(root)
txt=Entry(root)
def get_name():
if(txt.get()=="hello"):
    print ("hello")
v=Button(root,text="Submit",command=get_name())

v.pack()
txt.pack()
win1.pack()
root.mainloop() 
```

如果在用户按下提交之前在输入字段中写入“hello”，则该代码旨在打印到控制台“hello”。但是，代码不会将“hello”打印到控制台，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:06:38.323

您应该将对函数的引用（不带括号）传递给`command`选项。如果你不删除括号，你正在做的是调用函数：

```
v=Button(root,text="Submit",command=get_name) 
```

# java - 在 jasperreports 中添加垂直线

> ID：15718138
> 
> 赞同：0
> 
> 时间：2013-03-30T11:42:25.717
> 
> 标签：java, jasper-reports, report, ireport

我使用*JasperReports*作为 Web 应用程序的报告工具。（JSP + 小服务程序）

我开发了一个名为的报告，其中包含名为`Cust`的子报告`CustSub`。在子报告中，我想要某些列的垂直线，所以我添加了一个`line`精确高度的`frame`. 的高度`Bond`，`Frame`和垂直`line`是相同的。

![在此处输入图像描述](../Images/d1d253820b3b303ca75572e8721ec8b6.png)

所以让我知道是否有更好的方法来做到这一点？

**更新1**

这是`styles`我申请的备用行颜色

```
<style name="Detail" mode="Transparent" fontName="Times New Roman" pdfFontName="Times-Roman"/>
<style name="Row" mode="Transparent" fontName="Times New Roman" pdfFontName="Times-Roman">
    <conditionalStyle>
        <conditionExpression><![CDATA[$V{REPORT_COUNT}%2 == 0]]></conditionExpression>
        <style mode="Opaque" backcolor="#F0EFEF"/>
    </conditionalStyle>
</style> 
```

这是`Detail Band`（我只包含了代码中的两个文本字段，所以请不要考虑`x="258"`行，）

```
<detail>
<band height="18" splitType="Stretch">
    <frame>
        <reportElement uuid="aa7987da-d84a-4d11-b079-44005699151d" style="Row" stretchType="RelativeToBandHeight" mode="Opaque" x="1" y="0" width="555" height="18"/>

        <textField isStretchWithOverflow="true" pattern="dd/MM/yy" isBlankWhenNull="true">
            <reportElement uuid="8a0ce8e2-1beb-4300-81ea-f3422abef623" style="Detail" positionType="Float" x="2" y="0" width="60" height="18"/>
            <textElement>
                <font fontName="Times New Roman" size="14"/>
            </textElement>
            <textFieldExpression><![CDATA[$F{TRNDATE}]]></textFieldExpression>
        </textField>

        <textField isStretchWithOverflow="true" isBlankWhenNull="true">
            <reportElement uuid="74be5885-f344-4451-a3a5-62213d3a3dd1" style="Detail" positionType="Float" x="120" y="0" width="68" height="18"/>
            <textElement>
                <font fontName="Times New Roman" size="14"/>
            </textElement>
            <textFieldExpression><![CDATA[$F{AMOUNT}]]></textFieldExpression>
        </textField>

    <line>
        <reportElement uuid="06d698e3-34c2-445a-8787-a54bd38a2121" style="Detail" stretchType="RelativeToBandHeight" mode="Transparent" x="258" y="0" width="1" height="18" backcolor="#FFFFFF"/>
    </line>

    </frame>
</band>
</detail> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T07:42:52.830

只需从调色板中拖动线条元素并拖动该平铺元素的底部中间点以增加大小，然后通过拖动左侧中间点来减小宽度。

# android - 实现接近警报android的最佳方法

> ID：15718141
> 
> 赞同：4
> 
> 时间：2013-03-30T11:43:11.193
> 
> 标签：android, geolocation, batterylevel, proximitysensor

嗨，我正在开发 android 应用程序，在我的应用程序中，我想对几个位置进行邻近警报，这些位置是动态点，意味着位置列表可以根据用户当前位置动态更改。

所以我在我的应用程序中实现了接近警报，它在进入和退出事件时工作正常。但问题是，如果我将过期时间设置为 -1，它会持续使用 GPS，这会耗尽设备电池。

如果我设置了过期时间，那么它会在过期时间过后停止搜索该位置。

另一个问题是设置多个接近警报会导致大量电池消耗？

如何有效地使用接近警报。有没有更好的方法来处理这种情况。

需要帮助。。谢谢。。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T11:53:37.190

看这篇文章，它有一个关于你的问题的很好的例子：[Android Proximity Alerts Tutorial](http://www.javacodegeeks.com/2011/01/android-proximity-alerts-tutorial.html)

来自Greg Milette、Adam Stroud 的 **Professional Android Sensor Programming ：**![图书截图](../Images/69e95f41146c366d4a948695e91d9aa9.png)

# javascript - Python-spidermonkey：如何获取行号。错误的

> ID：15718142
> 
> 赞同：0
> 
> 时间：2013-03-30T11:43:13.253
> 
> 标签：javascript, python

如何检索发生错误的行号？

在下一个脚本中，该行输出（作为最后一次**raise**的结果）但没有行 num。在 JSError 对象中。

```
from spidermonkey import Runtime, JSError

runtime = Runtime()
context = runtime.new_context()

try:
    context.execute( "function test(){ return 'OK' }; \n\ntest2()" )
except JSError as e:
    print "ERROR!"
    print "args = {0}".format( e.args )
    print "message = {0}".format( e.message )
    print "__dict__ = {0}".format( e.__dict__ )
    raise 
```

结果：

```
ERROR!
args = ('ReferenceError: test2 is not defined',)
message = ReferenceError: test2 is not defined
__dict__ = {}
Traceback (most recent call last):
  File "test.py", line 7, in <module>
    context.execute( "function test(){ return 'OK' }; \n\ntest2()" )
  File "<anonymous JavaScript>", line 3, in JavaScript code
spidermonkey.JSError: ReferenceError: test2 is not defined 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:34:55.333

如果您只需要一个行号，您可以从[traceback.extract_tb](http://docs.python.org/2/library/traceback.html#traceback.extract_tb)函数中检索它。

```
import sys, traceback
from spidermonkey import Runtime, JSError

runtime = Runtime()
context = runtime.new_context()

try:
    context.execute( "function test(){ return 'OK' }; \n\ntest2()" )
except JSError as e:
    info = sys.exc_info()

    print "ERROR!"
    for file, lineno, function, text in traceback.extract_tb(info[2]):
        print "line #", lineno, ": ", text 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:06:50.260

或许我们可以进行下一个 hack：

```
from spidermonkey import Runtime, JSError
import traceback # need to get text of exception
import sys

runtime = Runtime()
context = runtime.new_context()

try:
    context.execute( "function test(){ return 'OK' }; \n\ntest2()" )
except JSError as e:
    print "ERROR!"
    """print "args = {0}".format( e.args )
    print "message = {0}".format( e.message )
    print "__dict__ = {0}".format( e.__dict__ )"""

    exc_type, exc_value, exc_traceback = sys.exc_info()
    print "traceback='{0}'".format( traceback.format_exc() ) # we can parse it to get a line 
```

如果您知道更优雅的方法，请发布它。

# android - 使用 Android，如何将控制权传递回主线程？

> ID：15718145
> 
> 赞同：0
> 
> 时间：2013-03-30T11:43:27.860
> 
> 标签：android, multithreading, opencv

我正在使用 OpenCV 教程 3 代码（相机控制）（请参阅[OpenCV4Android 示例](http://opencv.org/platforms/android/opencv4android-samples.html)`onPictureTaken()`）作为我的代码的基础，并且一旦图像保存在该方法中，就需要能够打开和操作图像。在操作过程中，我希望能够显示对图像的更改并使用 发布消息`Toast`，这两者都需要我在主线程中。

根据迄今为止收到的建议，我正在`BroadcastReceiver`尝试使用`Activity`由`sendBroadcast()`.`JavaCameraView`

我已更新 ,`Activity`以包含`BroadcastReceiver`, 并注册和注销它，如下所示：

```
public class Tutorial3Activity extends Activity implements CvCameraViewListener2, OnTouchListener {
    :
    private ActivityReceiver activityReceiver;
    :
    @Override
    public void onCreate(Bundle savedInstanceState) {
        :
        IntentFilter intentFilter = new IntentFilter();
        this.registerReceiver(activityReceiver, intentFilter);
        :
    }
    :
    public void onDestroy() {
        :
        this.unregisterReceiver(activityReceiver);
        :
    }
    :
    private class ActivityReceiver extends BroadcastReceiver {
        @Override
        public void onReceive(Context context, Intent intent) {
            Log.i(TAG, "BroadcastReceiver triggered");
            if (intent.getAction().equals(Tutorial3View.IMAGE_READY)) {
                Log.i(TAG, "BroadcastReceiver received");
            }
        }
    }    
} 
```

`sendBroadcast()`调用`JavaCameraView`如下：

```
public class Tutorial3View extends JavaCameraView {
    :
    public static final String IMAGE_READY = "IMAGE_READY";
    private Context context;
    :
    public Tutorial3View(Context context, AttributeSet attrs) {
        :
        this.context = context;
        :
    }
    :
    public void takePicture(final String fileName) {
        PictureCallback callback = new PictureCallback() {
            private String mPictureFileName = fileName;
            @Override
            public void onPictureTaken(byte[] data, Camera camera) {
                :
                image_read();
                :
            }
        };
        mCamera.takePicture(null, null, callback);
    }
    :
    public void image_read() {
        Log.i(TAG, "BroadcastReceiver - send");
        Intent i = new Intent();
        i.setAction(IMAGE_READY);
        context.sendBroadcast(i);
        Log.i(TAG, "BroadcastReceiver - sent");
    }
} 
```

其中`Manifest`包括`BroadcastReceiver`如下：

```
<receiver android:name="ActivityReceiver">
    <intent-filter android:label="IMAGE_READY"></intent-filter>
</receiver> 
```

当我拍照时，LogCat 显示：

```
03-30 17:22:53.410: I/Sample::Tutorial3View(3174): BroadcastReceiver - send
03-30 17:22:53.410: I/Sample::Tutorial3View(3174): BroadcastReceiver - sent 
```

`BroadcastReceiver triggered`但是or没有日志`BroadcastReceiver received`。

有人可以告知为什么没有收到广播吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:04:51.637

您需要调用该[`runOnUiThread()`](https://developer.android.com/reference/android/app/Activity.html#runOnUiThread%28java.lang.Runnable%29)方法：

```
runOnUiThread(new Runnable() {
    @Override
    public void run() {
        // stuff to be done on UI Thread
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:12:23.827

您可以使用[**AsyncTask**](http://developer.android.com/reference/android/os/AsyncTask.html)来执行此操作。

用于**`doInBackground()`**进行背景图像处理操作，完成后显示里面的 Toast 消息**`onPostExecute()`**。

# php - 在php中编写一个额外的分号

> ID：15718147
> 
> 赞同：-2
> 
> 时间：2013-03-30T11:43:33.563
> 
> 标签：php, javascript

我有一个 php 代码，我在其中使用 php 生成 javascript

```
function FunJavaScriptRedirection($url)
{
echo "<script>";
echo "var x = ";
echo  $url';';
echo "window.open(x)";
echo "</script>";
} 
```

我的问题是在将值存储到变量 x 后我想要分号。我不知道该怎么做我收到 javascript 错误请帮帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:45:02.850

改变

```
echo  $url';'; 
```

到

```
echo  $url . ';'; 
```

请参阅[联系方式](http://www.w3schools.com/php/php_string.asp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:45:43.353

您在 $url 和 ';' 之间缺少一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T11:53:26.427

即使你得到了正确的连接，你的代码仍然不会做你想做的事情，因为你输出的是“x”而不是变量的值。

所以在修复连接之后

```
echo $url . ';'; 
```

您需要更改以下行：

```
echo 'window.open(' . x . ');'; 
```

而且我怀疑您应该在脚本标签中声明使用的语言...

# php - Php 准备好的语句关闭仿真

> ID：15718148
> 
> 赞同：7
> 
> 时间：2013-03-30T11:43:37.780
> 
> 标签：php, prepared-statement, fetchall

将准备好的语句与 pdo 一起使用时，关闭仿真是否有任何副作用？我正在使用 select * 并限制需要作为 int 而不是字符串处理的结果。我可以做两件事之一。

```
$conn->setAttribute( PDO::ATTR_EMULATE_PREPARES, false ); 
```

或者用参数类型显式绑定这些变量：

```
$stm = $pdo->prepare('SELECT * FROM table LIMIT ?, ?');
$stm->bindParam(1, $limit_from,PDO::PARAM_INT);
$stm->bindParam(2, $per_page,PDO::PARAM_INT);
$stm->execute();
$data = $stm->fetchAll(); 
```

有什么优点或缺点吗？显然，关闭仿真会节省大量绑定。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-30T12:16:21.587

准备好的语句是低级数据库驱动程序的一个特性。数据库先接受查询结构，分别接受可变参数。同样，这是数据库本身实际支持的功能。

“模拟准备”意味着您在 PHP 端使用相同的 API，使用单独的`prepare()`和`bind`/`execute`调用，但 PDO 驱动程序只是在内部转义和连接字符串，将一个很好的旧长 SQL 字符串发送到数据库。数据库无法使用其本机参数化查询功能。

关闭仿真准备会强制 PDO 使用数据库的本机参数化查询功能。如果您的数据库（-驱动程序）不支持本机参数化查询，您应该只打开/保留模拟准备。模拟准备仅用于支持旧数据库（-驱动程序），它不会改变您在 PHP 代码中绑定参数的方式。

模拟准备*可能*会在某些情况下暴露安全漏洞，就像所有客户端转义和连接一样。如果查询和数据一直保持分离到数据库，那么这些缺陷是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:45:18.043

不，没有值得一提的优点或缺点。

> 显然，关闭仿真会节省大量绑定。

没有那么多。您可以仅在具有 LIMIT 的情况下使用绑定，并在`execute()`所有其他情况下继续使用延迟绑定，即使打开了仿真也是如此。

# php - 无法从 php 脚本中检索选择选项？

> ID：15718152
> 
> 赞同：0
> 
> 时间：2013-03-30T11:43:59.613
> 
> 标签：php, javascript, forms

我有一个表单，它在提交时将数据发送到外部 .php 脚本。我想禁用将 2 个同名学生插入数据库的可能性。因此，如果输入无效，我希望表单中的输入字段具有最后输入的值。我解决了这个问题，但我不知道如何检索最后选择的选项？这是我的代码：

```
<form action="student.php" name="add-student" method="post" onSubmit="return Validate()">
Firstname:<input type="text" name="firstname" value="<?php  if(isset($_GET['firstname'])){echo $_GET['firstname'];}

Degree:<select name="degree" value="<?php if(isset($_GET['degree'])){echo '<option value=$_GET[["degree"]></option>';} ?>"> **//This is what i can't solve!!!**
<option value="1">First degree</option>
<option value="2">Second degree</option>
<option value="3">Third degree</option>
</select>
</form> 
```

我的外部 php 脚本：

```
<?php
$firtsname=$_POST['firstname'];
$degree=$_POST['degree'];

$duplicate=mysqli_query($con,"SELECT * FROM student WHERE firstname='$firstname'");
if(mysqli_num_rows($duplicate)>0)
{
$row = mysqli_fetch_assoc($duplicate);

echo '<script type="text/javascript">';
echo 'alert("Name already exists in db.")';
echo '</script>'; 
echo "<script>window.location.assign('http://localhost/administrator.php?firstname=".$firstname."&degree=".$degree."'); </script>";
}
else{
$sql="INSERT INTO student (firstname,degree) VALUES('$firstname','$degree')";
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:49:58.673

改成这个

```
 Degree:<select name="degree" value="<?php if(isset($_GET['degree'])){echo '<option
    value='".$_GET["degree"]."' selected></option>';} ?>"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:10:06.677

错误地同时使用输入和下拉表单。试试这个

```
<form action="student.php" name="add-student" method="post" onSubmit="return Validate()">
Firstname:<input type="text" name="firstname" value="<?php  if(isset($_GET['firstname'])){echo $_GET['firstname'];}?>">
</form>
Degree:<select name="degree"> 
<option value="<?php if(isset($_GET['degree'])){echo $_GET["degree"];}?>"></option>
<option value="1">First degree</option>
<option value="2">Second degree</option>
<option value="3">Third degree</option>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:18:25.847

行情问题。这条线

```
<?php if(isset($_GET['degree'])){echo '<option value=$_GET[["degree"]></option>';} ?> 
```

应该 -

```
<?php if(isset($_GET['degree'])){ $v = $_GET['degree']; echo '<option value="$v"></option>';} ?> 
```

**笔记**

*   您可以访问双引号 ( `"$foo"`) 中的变量。
*   您不能访问单引号 (' `$foo`') 中的变量。它将是一个值为 $foo 的字符串。( `'$foo'=="\$foo"`)。

**更新**- 您的标记格式错误。

```
<select name="degree" value="<?php if(isset($_GET['degree'])){echo '<option value=$_GET[["degree"]></option>';} ?>"> 
```

实际上会打印类似 -

```
<select name="degree" value="<option value=x</option>"> <!-- Wrong! --> 
```

试试这个 -

```
 <select name="degree">
    <?php if(isset($_GET['degree'])){$deg = $_GET["degree"]; echo "<option selected="selected" value=\"$deg\"></option>";} ?>"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T12:57:49.750

当数据库能够工作时，让它完成工作。在您的情况下，您将 PHP 用于大部分实际的数据库操作。

1.  确保数据库中的 firstname 列的键设置为唯一。
2.  在查询中使用参数（用于避免 sql 注入）

我会做这样的事情：（我没有测试过）

```
<?php
$firstname=$_POST['firstname'];
$degree=$_POST['degree'];

$stmt = $mysqli->prepare("INSERT IGNORE INTO student (firstname,degree) VALUES(?, ?)");
$stmt->bind_param($firstname, $degree);
$result = $stmt->execute();
$lastInsertID = $stmt->insert_id;

//lastInsertID would be 0 if no execution of INSERT has been made (based on the IGNORE keyword)
if($lastInsertID == 0)  
{
    echo '<script type="text/javascript">';
    echo 'alert("Name already exists in db.")';
    echo '</script>'; 
    echo "<script>window.location.assign('http://localhost/administrator.php?firstname=".$firstname."&degree=".$degree."'); </script>";
}

?> 
```

要解决您在不正确时检索选项的问题，请将您的行更改为：

```
Firstname:<input type="text" name="firstname" value="<?php if(isset($_GET['firstname'])){echo $_GET['firstname'];}?> " />
Degree:<select name="degree" value="<?php if(isset($_GET['degree'])){echo '<option value="' . $_GET["degree"] . '"></option>';} ?>"> 
```

还将您的重定向更改为：

```
echo "<script type=\"text/javascript\">window.location.assign('http://localhost/administrator.php?firstname='.$firstname.'&degree='.$degree); </script>"; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-10T20:49:23.053

我解决了这个问题，谢谢大家的帮助，它应该是这样的：

```
Degree:<select name="degree">
<option value="1" <?php if($_GET['degree']=='1') {?> selected="selected" <?php }; ?> >First degree</option>
<option value="2" <?php if($_GET['degree']=='2') {?> selected="selected" <?php }; ?> >Second degree degree</option>
<select> 
```

# css - 页脚 DIV 不断跳到页面顶部

> ID：15718154
> 
> 赞同：0
> 
> 时间：2013-03-30T11:44:09.140
> 
> 标签：css, html, footer

我正在开发一个小网站：

[http://www.designbyantony.com/David%20Quigley%20www/index.html](http://www.designbyantony.com/David%20Quigley%20www/index.html)

（它在我服务器上我自己网站的一个文件夹中）我希望页脚 div 跟随每个页面末尾的内容，即：不要粘在视口的底部。我已经在所有页面上管理了这个，除了它在主页上不起作用 - 根据上面的链接。我已经度过了美好的一天，试图摆弄 over:hidden 等，但我没有任何运气。我觉得这与主页使用全屏图像有关。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:12:24.950

将标题后`#header`缺少的内容带到外面。从添加到中删除`</div>`
`position: fixed;``#homepage_content``z-index:-1``#bg`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T11:58:56.447

好的，我想我知道你在找什么。

1.  `</div>`通过删除after将 #homepage_content 移到 #header 之外`<!-- InstanceEndEditable -->`。`</div>`而是在第一个清除 div 之前添加一个。

2.  将#homepage_content的css代码修改为position: relative; 或者只是删除位置：固定。

3.  我认为您正在寻找#homepage_content 的透明背景色，对吗？为此，您必须删除 #homepage_wrapper 的 bakcground-color 并在 #header div 上放置白色背景色。

希望它能修复它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:01:14.680

我已经在 jsfiddle 中复制了你的 html。并在 css 中设置背景`background: url`。页脚似乎在底部。

[http://jsfiddle.net/btevfik/hDkQC/](http://jsfiddle.net/btevfik/hDkQC/)

# javascript - underscoreJS groupBy: better field names

> ID：15718156
> 
> 赞同：1
> 
> 时间：2013-03-30T11:44:21.537
> 
> 标签：javascript, underscore.js

I am using underscoreJS to manage a list of wrestler objects, they have a championship object attached that has details or is set to false.

Please take a look at this code snippet: [http://jsfiddle.net/JpPjA/](http://jsfiddle.net/JpPjA/)

```
 var wrestlers = [{"id":60,"alias":"Natalya Hart","male":true,"championship":false,"alias_url":"natalya-hart"},{"id":59,"alias":"Naomi","male":true,"championship":false,"alias_url":"naomi"},{"id":58,"alias":"Layla","male":true,"championship":false,"alias_url":"layla"},{"id":4,"alias":"The Rock","male":true,"championship":{"id":3,"image":"wwe-championship.png","title":"WWE Championship"},"alias_url":"the-rock"},
{"id":3,"alias":"Antonio Cesaro","male":true,"championship":{"id":5,"image":"wwe-united-states-championship.png","title":"WWE United States Championship"},"alias_url":"antonio-cesaro"},{"id":2,"alias":"Wade Barrett","male":true,"championship":{"id":4,"image":"wwe-intercontinental-championship.png","title":"WWE Intercontinental Championship"},"alias_url":"wade-barrett"},
{"id":1,"alias":"Alberto Del Rio","male":true,"championship":{"id":2,"image":"world-heavyweight-championship.png","title":"World Heavyweight Championship"},"alias_url":"alberto-del-rio"}];

var g = _.groupBy(wrestlers, 'championship');

console.log(JSON.stringify(g)); 
```

Unfortunately it outputs it as an array with two key names: "false" and "[object Object]"

Is there a way to give the output predefined key names? [object Object] as a key name bothers me more.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T11:56:57.920

You can pass a function to do your test and apply custom labels:

```
var g = _.groupBy(wrestlers, function champs(o) {
    return o.championship === false ? 'notchamps' : 'champs';
}); 
```

[http://jsfiddle.net/userdude/JpPjA/25/](http://jsfiddle.net/userdude/JpPjA/25/)

Maybe a little more fun...

```
var g = _.groupBy(wrestlers, function has(a) {
    return a.championship !== false ? 'champs' : 'chumps';
}); 
```

# mysql - Apache - MySQL 服务检测到错误的路径。/ 已使用的端口

> ID：15718157
> 
> 赞同：23
> 
> 时间：2013-03-30T11:44:24.593
> 
> 标签：mysql, apache, path, xampp, port

启动 XAMPP 时出现以下错误。

```
12:35:23  [main]    Initializing Control Panel
12:35:23  [main]    Windows Version:   64-bit
12:35:23  [main]    XAMPP Version: 1.8.1
12:35:23  [main]    Control Panel Version: 3.1.0 3.1.0 [ Compiled: September 20th 2012 ]
12:35:23  [main]    Running with Administrator rights - good!
12:35:23  [main]    XAMPP Installation Directory: "c:\xampp\"
12:35:23  [main]    Checking for prerequisites
12:35:23  [main]    All prerequisites found
12:35:23  [main]    Initializing Modules
12:35:23  [Apache]  XAMPP Apache Service is already running on port 80
12:35:23  [Apache]  XAMPP Apache Service is already running on port 443
12:35:23  [mysql]   MySQL Service detected with wrong path
12:35:23  [mysql]   Change XAMPP MySQL settings or
12:35:23  [mysql]   Uninstall/disable the other service manually first
12:35:23  [mysql]   Found Path: "C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" --defaults-file="C:\Program Files\MySQL\MySQL Server 5.5\my.ini" MySQL
12:35:23  [mysql]   Expected Path: c:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysql
12:35:23  [mysql]   Problem detected!
12:35:23  [mysql]   Port 3306 in use by "mysqld.exe"!
12:35:23  [mysql]   MySQL WILL NOT start without the configured ports free!
12:35:23  [mysql]   You need to uninstall/disable/reconfigure the blocking application
12:35:23  [mysql]   or reconfigure MySQL to listen on a different port
12:35:23  [main]    Starting Check-Timer
12:35:23  [main]    Control Panel Ready 
```

我无法在谷歌上找到合适的解决方案，所以我有点'希望有人能帮我解决这个问题。

哦，XAMPP 运行正常。Apache 和 MySQL 服务都在运行..

* * *

## 回答 #1

> 赞同：89
> 
> 时间：2013-06-05T11:55:13.547

1.  转到 cmd 并以管理员模式运行它。
2.  使用以下命令通过命令提示符卸载 mysql 服务。

    ```
     sc delete mysql 
    ```

3.  重启 XAMPP

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2014-02-20T21:52:45.353

删除现有服务对我来说不是一个好的解决方案，因为在端口 3306 上运行 MySQL，需要其他服务。但是可以同时运行两个 MySQL 服务（一个具有其他名称和端口）。我在这里找到了解决方案：http: [//emjaywebdesigns.com/xampp-and-multiple-instances-of-mysql-on-windows/](http://emjaywebdesigns.com/xampp-and-multiple-instances-of-mysql-on-windows/)

这是我修改后的设置： 在 c:\xampp\mysql\bin\ 中编辑您的“my.ini”文件 将所有默认的 3306 端口条目更改为新值 3308

在 c:\xampp\php 中编辑您的“php.ini”并将 3306 替换为 3308

创建服务条目 - 在 Windows 命令行类型中

> sc.exe 创建 "mysqlweb" binPath= "C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysqlweb"

打开Windows服务并设置启动类型：自动，启动服务

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-14T14:17:56.900

这就是我解决类似问题的方法：

1.  启动 XAMPP 控制面板。
2.  **卸载 MySQL 服务：单击服务**列下 MySQL 旁边的“绿色检查”按钮。“绿色检查”按钮将变为“红十字”按钮。
3.  退出 XAMPP，然后重新启动它。
4.  单击开始。

我希望它也可以帮助解决您的问题。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-09-10T08:13:32.950

首先进入`cmd`。

然后写：

```
sc delete MySQL 
```

之后重新启动计算机。重新启动计算机并打开您的`xampp`时，您可以在 上看到十字符号`MySQL`。单击十字符号，然后单击开始。就这样。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-06-07T10:01:41.283

将 XAMPP 控制面板设置为在管理员权限下运行。

在 Win 7 中 1\. 首先确保 XAMPP 控制面板没有运行 2\. SHIFT+右键单击 XAMPP 控制面板 3\. 单击属性 4\. 在属性中选择选项卡“兼容性” 5\. 在选项卡底部的“权限级别”下选中“以管理员身份运行此程序”框 6\. 单击确定

这对我有用

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2013-08-18T20:23:07.950

好的，所以我发现了问题:)

ctrl+alt+delete 启动任务管理器，一旦你进入任务管理器去服务。找到 MySQL 并右键单击它。然后点击停止进程。这对我有用，我希望它对你有用：D

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-05-14T18:20:57.067

这是因为您可能安装了 wamp 服务器并将其卸载，但 wampmysql.exe 仍在运行并使用默认 mysql 端口转到服务选项卡下的 msconfig 取消选中 wampmysqld 以停用它重新启动计算机应该可以工作

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-06-14T21:09:28.173

*   好的，实际上解决这个问题很容易......遇到这个问题的大多数人可能甚至没有意识到你还没有安装完整的软件:) 我尝试在网上查找，但收效甚微，除了一些人提到你需要寻找那些已经运行的服务。例如 filezilla 的问题，您在任务管理器中查看**filezilla**并停止该过程，然后单击 xampp 控制面板中的 X 以安装 filezilla，然后单击运行，它应该会启动服务，通常会显示带有复选标记的绿色 lite。

*   **mysql**问题也是如此。

*   至于**apache**问题，通常是端口被Skype或其他程序占用的问题，但是您可以在网上找到如何轻松解决该问题的信息:)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-03-06T07:43:56.063

这就是我使用上面的[mircea](https://stackoverflow.com/a/59424736/9336757)答案解决我的问题的方法。

从上面的错误中，复制提到的预期路径。

启动 regedit.exe，转到 HKEY_LOCAL_MACHINE，然后是 SYSTEM，然后是 CurrentControlSet，然后是服务，然后是 MySQL。单击 ImagePath、编辑、修改。将从上面复制的预期路径粘贴到值数据字段中，按 OK，关闭 regedit。重新启动 Xampp。

这就是它对我的工作方式，因为我已经安装并运行了 MSSQL 服务器，并且不想取消它。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-12-20T11:42:08.523

关于这个*具体*问题：

```
12:35:23  [mysql]   Found Path: "C:\Program Files\MySQL\MySQL Server 5.5\bin\mysqld" --defaults-file="C:\Program Files\MySQL\MySQL Server 5.5\my.ini" MySQL
12:35:23  [mysql]   Expected Path: c:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysql 
```

请注意，mysqld 末尾的第一行缺少**.exe 。**

要解决此问题，请启动**regedit.exe**并 通过添加**.exe**扩展名来更改 `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\mysql` **ImagePath 。**

 **重新启动*xampp 控制面板*，此错误不应出现。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-05-22T12:37:39.817

您好，我遇到了同样的问题，我用 tommer 做了这些步骤，问题解决了，谢谢

**注意**：

您不必像这样做那样去做；

1)-- 在 c:\xampp\mysql\bin\ 中编辑“my.ini”文件 将所有默认的 3306 端口条目更改为新值 3308

2)--在 c:\xampp\php 中编辑您的“php.ini”并将 3306 替换为 3308

3)--创建服务入口-在Windows命令行类型

sc.exe 创建 "mysqlweb" binPath= "C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysqlweb"

4)--打开Windows服务并设置启动类型：自动，启动服务

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2017-10-02T18:44:43.727

在我的情况下，这个问题是因为我的本地机器使用了之前在 3006 端口安装的一个 MySQL 服务。因此我修改了**my.ini** (C:\xampp\mysql\bin\my.ini) 和**php.ini** (C:\xampp\php\php.ini) 文件将端口 3006 替换为 3008

**之后，我创建了一个运行Tommer**上述命令的新服务：

sc.exe 创建 "mysqlweb" binPath= "C:\xampp\mysql\bin\mysqld.exe --defaults-file=c:\xampp\mysql\bin\my.ini mysqlweb"**

# java - 为什么 Frme windowClosing with ConfirmDialog 在两种情况下都关闭（确定和取消）？

> ID：15718165
> 
> 赞同：0
> 
> 时间：2013-03-30T11:45:24.227
> 
> 标签：java, swing, jframe, windowlistener

这是我的代码：

```
 addWindowListener(new WindowAdapter() {

            @Override
            public void windowClosing(WindowEvent e) {
               int a = JOptionPane.showConfirmDialog(null, 
                            "Are you sure you want to exit the program?", "Exit Program ",
                            JOptionPane.YES_NO_OPTION);
               System.out.println(a);
               if(a==JOptionPane.OK_OPTION){
                   dispose();
               }
           }}); 
```

问题是或者`a==OK_OPTION`框架`a==CANCEL_OPTION`将关闭。

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T11:51:47.877

您可能已将默认关闭操作设置为`JFrame`as `EXIT_ON_CLOSE`。因此，`JFrame`无论您按`OK`或，都会退出`CANCEL`。您应该设置默认关闭操作，就`DO_NOTHING_ON_CLOSE`好像您要手动处理`JFrame`.

```
setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
addWindowListener(new WindowAdapter() {
            @Override
            public void windowClosing(WindowEvent e) {
               int a = JOptionPane.showConfirmDialog(null, 
                            "Are you sure you want to exit the program?", "Exit Program ",
                            JOptionPane.YES_NO_OPTION);
               System.out.println(a);
               if(a==JOptionPane.OK_OPTION){
                   dispose();//You can use System.exit(0) if you want to exit the JVM
               }
           }}); 
```

# mongodb - 如何将文档添加到 Mongo DB 的集合中？

> ID：15718167
> 
> 赞同：0
> 
> 时间：2013-03-30T11:45:46.450
> 
> 标签：mongodb

我一直在研究 Mongo DB，并且正在努力获得正确的基础知识。

以下代码似乎适用于 Mac，但不适用于 Windows。我在 Windows 上没有错误。如果我将用户名/密码更改为不正确的组合，我会收到错误消息。当代码没有问题但根本没有在数据库中创建集合时，它根本不会提供任何输出，而我希望有一个名为`things`.

我从示例中运行代码，`.\node_modules\mongoose\examples`它运行良好。我还尝试将代码放入其中`thing\index.js`，`data.js`以防万一制作模块导致问题但行为没有改变。我究竟做错了什么？

这是我的示例代码：

**数据.js**

```
var loremIpsum = require('lorem-ipsum'),
    mongoose = require('mongoose'),
    Thing = require('./thing');

mongoose.connect('mongodb://username:password@localhost/Test', function (err) {
    if (err) {
        throw err;
    }

    createData();
})

function createData() {
    Thing.model.create({
        id: 1,
        name: loremIpsum({
            count: 5,
            units: 'words',
            format: 'plain'
        }),
        description: loremIpsum({
            count: 100,
            units: 'words',
            format: 'plain'
        })
    }, function (err, thing) {
        if (err) {
            throw err;
        }

        console.log(thing.name);
    });

    mongoose.disconnect();
} 
```

**东西/index.js**

```
var mongoose = require('mongoose');

var thingSchema = mongoose.Schema({
    id: {
        type: Number,
        min: 1
    },
    date: {
        type: Date,
        default: Date.now
    },
    name: {
        type: String,
        trim: true
    },
    description: {
        type: String,
        trim: true
    }
});
var thingModel = mongoose.model('Thing', thingSchema);

exports.schema = thingSchema;
exports.model = thingModel; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:22:22.447

小学生错误！我把这个留在这里让其他菜鸟找到！

本质上，我的代码在创建有机会完成之前就断开了连接。这就是为什么从未调用回调的原因。*`*facepalm*`*

**数据.js**

```
var loremIpsum = require('lorem-ipsum'),
    mongoose = require('mongoose'),
    Thing = require('./thing');

mongoose.connect('mongodb://username:password@localhost/Test', function (err) {
    if (err) {
        throw err;
    }

    createData();
})

function createData() {
    Thing.model.create({
        id: 1,
        name: loremIpsum({
            count: 5,
            units: 'words',
            format: 'plain'
        }),
        description: loremIpsum({
            count: 100,
            units: 'words',
            format: 'plain'
        })
    }, function (err, thing) {
        if (err) {
            throw err;
        }

        console.log(thing.name);

        // this goes here...
        mongoose.disconnect();
    });

    // this does not go here...
    // mongoose.disconnect();
} 
```

# javascript - JavaScript 在 Firefox 的 iframe 中不起作用

> ID：15718168
> 
> 赞同：1
> 
> 时间：2013-03-30T11:46:02.970
> 
> 标签：javascript, firefox, iframe

我正在使用一个 iframe 加载带有表单的页面。使用 javascript 覆盖表单操作。javascript 表单操作在 IE 和 Chrome 中运行。但在 Firefox 中，javascript 不起作用，表单正在提交到[http://example.com/index.php](http://example.com/index.php)

代码如下：

```
<script language='Javascript' type='text/JavaScript'>
function submitFunction() {
document.Insert.action = 'http://example.com/page2.php';
return true;
}
</script>

<FORM ACTION='http://example.com/index.php' METHOD='POST' ENCTYPE='x-www-form-urlencoded' name='Insert' id='Insert' autocomplete='off' onsubmit='return(submitFunction())'>

<input name='num' SIZE='45' MAXLENGTH='45'>

<input name='Submit' type='submit'/>
</FORM> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:47:21.207

改变

```
document.Insert.action = 'http://example.com/page2.php'; 
```

至

```
document.getElementById('Insert').action = 'http://example.com/page2.php'; 
```

但是在onsubmit中更改表单的action URL似乎有点奇怪。你也可以从一开始就定义它。

# php - 如何使用 php 将 xml 文件发送到服务器后端？

> ID：15718173
> 
> 赞同：-1
> 
> 时间：2013-03-30T11:46:26.647
> 
> 标签：php, xml, curl, xmlhttprequest

我已使用此代码从服务器获取数据，`$server = 'LOCALHOST:9000';

```
$headers = array(
"Content-type: text/xml"
,"Content-length: ".strlen($requestXML)
,"Connection: close"
);

$ch = curl_init(); 
curl_setopt($ch, CURLOPT_URL, $server);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_TIMEOUT, 100);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $requestXML);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
$data = curl_exec($ch);

if(curl_errno($ch)){
    print curl_error($ch);
    echo "  something went wrong..... try later";
}else{
echo " request accepted";
    print $data;
    curl_close($ch);
}` 
```

现在我必须做反向，如何使用 php 将数据发送到服务器？curl 方法是唯一的方法，或者是否有任何其他方法可以做到这一点。给我举个例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:01:24.083

使用 cURL 发送/接收是完全相同的事情。cURL 基于向给定 URL 发送数据并可能接收响应。我们举一个获取用户和发送用户的简单例子。

**获得用户将是**

```
$data = array(
  'user_id' => 1
);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://www.site.com/getUser.php");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($ch);
curl_close($ch); 
```

*   getUser.php 只是搜索用户并返回找到的数据。
*   $response 可能包含用户的数据，可能只是包含名称的文本响应。一个序列化的 PHP 数组，一个带有完整用户配置文件的 XML 响应……等等。

**插入/发送数据**

```
$data = array(
  'user_name' => 'Joshua',
  'user_email' => 'my@email.com'
);

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://www.site.com/addUser.php");
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($data));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($ch);
curl_close($ch); 
```

*   addUser.php 对字段进行一些验证，如果验证，则在数据库中插入用户
*   在这种情况下，$response 不包含用户数据（但是：有可能），但 $response 更有可能包含结果。一个`ok`文本响应、一个 json/xml 响应或者可能是一个“200 OK”标头响应

基本上都是一样的。使用 cURL 获取/发送数据没有区别。这一切都基于发送请求，并且在大多数情况下对结果做一些事情。

# c# - 读取文本文件并将这些文件中存在的单词插入到 sql server 中的表中

> ID：15718174
> 
> 赞同：0
> 
> 时间：2013-03-30T11:46:32.903
> 
> 标签：c#, asp.net, .net, sql-server-2008

我有一个包含 25000 个文本文件的文件夹，我想阅读这些文件并将单词放入表中。我的文本文件以以下格式命名 1.txt、2.txt、........和以此类推至 25000.txt。每个文本文件都包含以下形式的单词。

```
sample contents of my file
apple
cat
rat
shoe 
```

这些单词也可能在其他文本文件中重复，我想要可以读取文本文件的 ac# 代码识别重复的单词以及不重复的单词，然后以下列形式将它们插入 Sqlserver 中的数据库。

```
keyword    document name
cat        1.txt,2.txt,3.txt
rat        4.txt,1.txt
fish       5.txt 
```

`

```
using System;

using System.Collections.Generic;

using System.ComponentModel;

using System.Data;

using System.Drawing;

using System.Linq;

using System.Text;

using System.Windows.Forms;

using System.IO;

using System.Data.SqlClient;

namespace RAMESH
 {
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    private void textBox1_TextChanged(object sender, EventArgs e)
    {

    }

    private void button2_Click(object sender, EventArgs e)
    {

        string[] files = Directory.GetFiles(textBox1.Text, "*.txt");
        int i;
        string sqlstmt,str;
        SqlConnection con = new SqlConnection("data source=dell-pc\\sql1; initial         catalog=db; user id=sa; password=a;");
        SqlCommand cmd;
        sqlstmt = "delete from Items";
        cmd = new SqlCommand(sqlstmt, con);
        con.Open();
        cmd.ExecuteNonQuery();
        for (i = 0; i < files.Length; i++)
        {
            StreamReader sr = new StreamReader(files[i]);
            FileInfo f = new FileInfo(files[i]);
            string fname;
            fname = f.Name;
            fname = fname.Substring(0, fname.LastIndexOf('.'));
            //MessageBox.Show(fname);
            while ((str = sr.ReadLine()) != null)
            {
                int nstr=1;
                //int x,y;
                //for (x = 0; x < str.Length; x++)
                //{ 
                //    y = Convert.ToInt32(str.Substring(x,1));
                //    if ((y < 48 && y > 75) || (y < 65 && y > 97) || (y < 97 && y > 122)) ;
                //}
                sqlstmt = "insert into Items values('" + str + "','" + fname + "')";
                cmd = new SqlCommand(sqlstmt, con);                    
                try
                {
                    cmd.ExecuteNonQuery();
                }
                catch (Exception ex)
                {
                    sqlstmt = "update Items set docname=docname + '," + fname + "'   where itemname='" + str + "'";
                    cmd = new SqlCommand(sqlstmt, con);
                    cmd.ExecuteNonQuery();
                }
            }
            sr.Close();
        }
        MessageBox.Show("keywords added successfully");
        con.Close();
    }
} 
```

} `

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:19:26.067

首先，我将向您的数据库添加一个存储过程，以隔离更新或插入的逻辑

```
CREATE PROCEDURE UpsertWords
@word nvarchar(MAX), @file nvarchar(256)
as

    Declare @cnt integer
    Select @cnt = Count(*) from Items where ItemName = @word
    if @cnt = 0 
        INSERT INTO Items (@word, @file)
    else
        UPDATE Items SET docname = docname + ',' + @file where ItemName = @word 
```

现在，我们可以大大简化您的代码

```
.....

// Build the command just one time, outside the loop,
// make it point to the stored procedure above
cmd = new SqlCommand("UpsertWords", con);
cmd.CommandType = CommandType.StoredProcedure;                    

// Create dummy parameters, the actual value is supplied inside the loop
cmd.Parameters.AddWithValue("@word", string.Empty);
cmd.Parameters.AddWithValue("@file", string.Empty);

// Now loop on every file
for (i = 0; i < files.Length; i++)
{
    // Open and read all the lines in the current file
    string[] lines = File.ReadAllLines(files[i]);

    // Get only the filename part without the extension
    string fname = Path.GetFileNameWithoutExtension(files[i])

    // In case of just one line per file, this loop will execute just one time
    // however we also could handle more than one line per file
    foreach(string line in lines)
    {
        // Set the actual value of the parameters created outside the loop
        cmd.Parameters["@word"] = line;
        cmd.Parameters["@file"] = fname;
        // Run the insert or update (the logic is inside the storedprocedure)
        cmd.ExecuteNonQuery();
    } 
```

此时尚不清楚您的行是由单个单词组成，还是由多个字符（制表符、逗号、分号）分隔的多个单词。在这种情况下，您需要拆分字符串和另一个循环。

但是，我发现您的数据库架构错误。最好为每个单词及其出现的文件添加一个新行。这样一个简单的查询就像

```
SELECT  docname from Items where itemname = @word 
```

将输出所有文件而没有任何大的性能问题，并且您拥有一个更易于搜索的数据库。
或者，如果您需要计算某个单词的出现次数

```
SELECT ItemName, COUNT(ItemName) as WordCount 
FROM Items 
GROUP BY ItemName 
ORDER BY Count(ItemName) ASC 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T18:48:41.723

试试这个方法：

首先从您的文件开始，循环并创建一个简单的 XML 文档。

```
 var fname = "File12.txt";
        var keywords = new List<string>(new[]{ "dog", "cat", "moose" });           

        var miXML = new XDocument(new XDeclaration("1.0", "utf-8", "yes"), new XElement("root"));

        foreach (var el in keywords.Select(i => new XElement("item", new XAttribute("key", i))))
        {
            miXML.Root.Add(el);
        }

        using (var con = new SqlConnection("Server=localhost;Database=HT;Trusted_Connection=True;"))
        {
            con.Open();
            using (var cmd = new SqlCommand("uspUpsert", con) {CommandType = CommandType.StoredProcedure})
            {
                cmd.Parameters.AddWithValue("@X", miXML.ToString());
                cmd.Parameters.AddWithValue("@fileName", fname);
                cmd.ExecuteNonQuery();
            }
        } 
```

然后对于您的存储过程，您可以调用此 Proc，它将将该 XML 转换为表，将关键字和文件名插入数据库。

```
CREATE PROCEDURE uspUpsert
    @X xml,
    @Filename varchar(100)
AS
BEGIN
SET NOCOUNT ON;

    WITH KV as (
        select 
            x.v.value('@key', 'varchar(20)') as Keyword
            ,@FileName as FileName
        FROM   @x.nodes('/root/item') x(v) 
    )
    insert into Items 
    select KV.keyWord, KV.FileName
    from KV
    left outer join Items I on I.Keyword=KV.Keyword and I.FileName=KV.FileName
    where I.id is null
END 
```

由于您可能不希望 'file1.txt file2.txt file3.txt' 查找重复项，因此您将使用此查询来查找重复文件中的单词：

```
select * from items where keyword='dog' 
```

或者，现在可以计数并在此表上进行所有其他聚合。

# entity-framework - 实体框架对象不允许将连接字符串作为参数传递

> ID：15718179
> 
> 赞同：0
> 
> 时间：2013-03-30T11:47:18.480
> 
> 标签：entity-framework, connection-string

我正在尝试初始化一个实体对象（ADO.NET EF 对象），但它不允许我选择要使用的连接字符串。我需要更改连接字符串以便为用户提供不同的访问级别。

实体对象中没有覆盖，只是一个无参数的构造函数。

如果有人可以给我任何指示，不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:23:42.270

如果您使用设计器为您生成**.edmx**文件，您将获得如下内容：

```
 public MyEntities() : base("name=MyEntities", "MyEntities")
    {
        this.ContextOptions.LazyLoadingEnabled = true;
        OnContextCreated();
    } 
```

默认情况下，这将从您的配置文件中获取连接字符串。

在这种情况下你可以做的是设置连接字符串

```
 public partial class MyEntities
    {

    partial void OnContextCreated()
    {
       //Dynamically Building a Connection String
       this.Connection.ConnectionString = "myconnectionstring";          
    }
   } 
```

请记住，这将首先使用基本构造函数从配置中提取连接字符串，然后使用您的自定义版本进行设置，基本上覆盖连接字符串。当您总是需要默认连接字符串时，这通常很好。

如果您想要更多控制权，另一种选择是通过构造函数传递连接字符串，如下所示：

```
 public partial class MyEntities
    {   
     public MyEntities(string connectionString) :           
     base(connectionString,"MyEntities")       
     {

       this.OnContextCreated();       
    }
   } 
```

现在您将连接字符串向下传递到基类，这是它将使用的唯一一个。但是，这确实意味着您通常每次都需要提供此信息。

希望这可以帮助...

# android - FragmentManagerImpl.popBackStackImmediate() 中的 NPE

> ID：15718183
> 
> 赞同：2
> 
> 时间：2013-03-30T11:47:42.343
> 
> 标签：android

当我在手机上快速按回、回、回时，出现以下异常：

```
java.lang.NullPointerException
at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1378)
at android.app.FragmentManagerImpl.executePendingTransactions(FragmentManager.java:437)
at android.app.FragmentManagerImpl.popBackStackImmediate(FragmentManager.java:452)
at android.app.Activity.onBackPressed(Activity.java:2123)
at com.swipemaster.activities.CommonActivity.onBackPressed(CommonActivity.java:16)
at com.swipemaster.activities.MainActivity.access$0(MainActivity.java:1)
at com.swipemaster.activities.MainActivity$1.run(MainActivity.java:62)
at android.os.Handler.handleCallback(Handler.java:605)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4424)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:817)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:584)
at dalvik.system.NativeStart.main(Native Method) 
```

在 Android 4.0.4 和 2 设备上测试：Sony Xperia MT27i 和 ST23i。在 2.2.1 和 Galaxy Mini 上不会出现此问题。有谁能够帮助我？

`CommonActivity`班级：

```
public class CommonActivity extends Activity
{
    @Override
    public void onBackPressed()
    {
        MusicPlayer.continueMusic = true;
        super.onBackPressed(); // this is CommonActivity.java:16
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:15:33.377

据我了解，问题`return popBackStackState(mActivity.mHandler, null, -1, 0);`出在以下函数的调用中：

```
 @Override
 public boolean popBackStackImmediate() {
     checkStateLoss();
     executePendingTransactions();
     return popBackStackState(mActivity.mHandler, null, -1, 0);
 } 
```

来自[安卓源](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/4.0.4_r1.2/android/app/FragmentManager.java/)。

所以，我看到的真正问题是：为什么`mActivity`该函数（或某些特定于供应商的字段）为 null？

根据评论，该问题仅在signle设备上观察到，因此我可以提出以下建议：

*   在其他设备上验证问题以检测它是否可重现（因为库存 android 4.0.4 中没有代码`FragmentManager.java:457`）；
*   Try to build app for API 15 or API 16 and check if issue remain;
*   Based on [this question](https://stackoverflow.com/questions/6774505/why-is-npe-thrown-when-finishing-activity) replies, the problem might be in one of `onDestroy()` methods;
*   Investigate applications code to find out if some part of it calls `finish()` for all activities or does some handling to exit from the app (e.g. tries to handle multiple back presses as exit from app);
*   Try to workout some hack (e.g. handling of back with small 100ms delay). But for this way I would suggest You to be sure that the issue is vendor-specific and put that hack under check of [Build.MANUFACTURER](http://developer.android.com/reference/android/os/Build.html#MANUFACTURER);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T14:38:53.600

When you quickly press 2 times back button on your device, the `onBackPressed()` method is also called 2 times. This is causing the problem.

Solution:

Look into all your `onBackPressed()` methods. Do you have something, that can cause problems, because of being called 2 times? For example, this can be a call to `postDelayed()`, which was mine case. If yes, add a flag assuring that your `onBackPressed()` body will be executed only once, despite the number of back button clicks:

```
private boolean backAlreadyPressed = false;

@Override
public void onBackPressed()
{
    if (backAlreadyPressed)
    {
        return;
    }
    backAlreadyPressed = true;

    // old implementation of onBackPressed()
} 
```

# zend-framework2 - 如何将 db 适配器设置为 Validator NoRecordExists 并在控制器中使用它？

> ID：15718188
> 
> 赞同：1
> 
> 时间：2013-03-30T11:48:21.963
> 
> 标签：zend-framework2

我最近开始学习 ZF2，希望有人可以帮助我。

我正在学习 Rob Allen 的 Zend Framework 2 教程（非常感谢@rob-allen）。

我还使用了@AlloVince 和@Maciej [How to set db adapter to Validator RecordExists in Zend Framework 2](/questions/13818525 "例子")的解决方案（非常感谢两位作者），我很困惑，因为没有在**editAction**中使用这个解决方案。

我`Fatal error: Call to a member function get() on a non-object`在`'adapter' => $this->getServiceLocator()->get('Zend\Db\Adapter\Adapter')`.

1）在Module.php中添加

> ```
> public function getServiceConfig()
> {
>     return array(
>         'invokables' => array(
>             'RegionModel' => 'FcLibraries\Model\Region', //<-- added it
>         ),
>         'factories' => array(
>             'FcLibraries\Model\RegionTable' => function ($sm) {
>                 $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
>                 $table = new RegionTable($dbAdapter);
>                 return $table;
>             },
>         ),
>     );
> } 
> ```

2）在Region.php中添加

> ```
> /**
>  * @var
>  */
> protected $serviceLocator;
> /**
>  * @param \Zend\ServiceManager\ServiceLocatorInterface $serviceLocator
>  * @return Library
>  */
> public function setServiceLocator(ServiceLocatorInterface $serviceLocator)
> {
>     $this->serviceLocator = $serviceLocator;
>     return $this;
> }
> /**
>  * @return \Zend\ServiceManager\ServiceLocatorInterface
>  */
> public function getServiceLocator()
> {
>     return $this->serviceLocator;
> } 
> ```

和

> ```
>  $inputFilter->add($factory->createInput(array(
>             'name' => 'name',
>             'required' => true,
>             'filters' => $this->_filters,
>             'validators' => array(
>                 array(
>                     'name' => 'StringLength',
>                     'options' => array(
>                         'encoding' => 'UTF-8',
>                         'min' => 1,
>                         'max' => 30,
>                     ),
>                 ),
>                 array(
>                     'name'    => 'Db\NoRecordExists',
>                     'options' => array(
>                         'table' => $this->table,
>                         'field' => 'name',
>                         //'exclude' => array(
>                         //    'field' => 'id',
>                         //    'value' => $this->id
>                         //),
>                         'adapter' => $this->getServiceLocator()->get('Zend\Db\Adapter\Adapter'),
>                     ),
>                 ),
>             ),
>         ))); 
> ```

3）在 addAction 中的 RegionController.php 中使用

> $model = $this->getServiceLocator()->get('RegionModel');

而不是`$model = new Region();`.

这适用于 addAction，但我不明白应该如何在 editAction 中使用它。

我的

> ```
> public function editAction()
> {
>     $id = (int)$this->params()->fromRoute('id', 0);
>     if (!$id) {
>         return $this->redirect()->toRoute('zfcadmin/region', array(
>             'action' => 'add'
>         ));
>     }
>     $data = $this->getRegionTable()->get($id);
>     $form = new RegionForm();
>     $form->bind($data);
>     $form->get('submitBtn')->setAttribute('value', 'Save');
>     $request = $this->getRequest();
>     if ($request->isPost()) {
>         $form->setInputFilter($data->getInputFilter());
>         $form->setData($request->getPost());
>         if ($form->isValid()) {
>             $this->getRegionTable()->save($form->getData());
>             return $this->redirect()->toRoute('zfcadmin/regions');
>         }
>     }
>     return array(
>         'id' => $id,
>         'form' => $form,
>     );
> } 
> ```

我的 RegionTable 有以下代码：

> ```
> /**
>  * @param \Zend\Db\Adapter\Adapter $adapter
>  */
> public function __construct(Adapter $adapter)
> {
>     $this->adapter = $adapter;
>     $this->resultSetPrototype = new ResultSet();
>     $this->resultSetPrototype->setArrayObjectPrototype(new Region());
>     $this->initialize();
> }
> public function get($id)
> {
>     $id = (int)$id;
>     $rowSet = $this->select(array('id' => $id));
>     $row = $rowSet->current();
>     if (!$row) {
>         throw new \Exception("Could not find row $id");
>     }
>     return $row;
> } 
> ```

非常感谢所有回答我问题的人。

最好的问候，鲁斯兰。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:46:47.070

您应该通过服务管理器实例化一个新实体以使用数据库适配器，而不是使用从表中收集的实体中的表单过滤器。

你有几个选择：

1.  将输入过滤器移动到它自己的类并通过服务管理器进行实例化，以便注入数据库适配器。
2.  将表网关工厂中的原型对象更改为通过服务管理器工厂实例化。
3.  通过服务管理器实例化一个单独的实体并从那里获取输入过滤器。

我个人会选择选项 1，因为它可以更好地分隔代码。

一些例子：

**选项1（我的选择）：**

这涉及将过滤器移动到它自己的文件和类中，在注入数据库适配器的同时为其创建一个工厂。然后，我们将在控制器中通过服务管理器获取过滤器并将过滤器应用于表单。

因此，首先将您的过滤器移动到 ModName\src\ModName\Form\RegionFilter.php 中的文件，显然将 ModName 替换为您的模块名称。

并将代码更改为：

```
<?php
namespace Region\Form;

use Zend\InputFilter\Factory as InputFactory;
use Zend\InputFilter\InputFilter;
use Zend\InputFilter\InputFilterAwareInterface;
use Zend\InputFilter\InputFilterInterface;
use Zend\Db\Adapter\Adapter;

class RegionFilter implements InputFilterAwareInterface {

    /**
     * @var inputFilter
     */
    protected $inputFilter;

    /**
     * @var Database Adapter
     */
    protected $dbAdapter;

    /**
     * @param \Zend\InputFilter\InputFilterInterface $inputFilter
     * @throws \Exception
     */
    public function setInputFilter(InputFilterInterface $inputFilter) {
        throw new \Exception("Not used");
    }

    /**
     * @param \Zend\Db\Adapter $dbAdapter
     */
    public function __construct(Adapter $dbAdapter) {
        $this->dbAdapter = $dbAdapter;
    }

    /**
     * 
     * @return Zend\Db\Adapter
     */
    public function getDbAdapter() {
        return $this->dbAdapter;
    }

    /**
     * @return \Zend\InputFilter\InputFilter
     * 
     * Get the input filter (build it first)
     */
    public function getInputFilter() {
        if (!$this->inputFilter) {

            $inputFilter = new InputFilter();
            $factory = new InputFactory();

            $inputFilter->add($factory->createInput(array(
                'name' => 'name',
                'required' => true,
                'filters' => $this->_filters,
                'validators' => array(
                    array(
                        'name' => 'StringLength',
                        'options' => array(
                            'encoding' => 'UTF-8',
                            'min' => 1,
                            'max' => 30,
                        ),
                    ),
                    array(
                        'name' => 'Db\NoRecordExists',
                        'options' => array(
                            'table' => $this->table,
                            'field' => 'name',
                            //'exclude' => array(
                            //    'field' => 'id',
                            //    'value' => $this->id
                            //),
                            'adapter' => $this->getDbAdapter(),
                        ),
                    ),
                ),
            )));
                    $this->inputFilter = $inputFilter;
        }

        return $this->inputFilter;
    }
}
?> 
```

然后，您将在 Module.php 中创建一个工厂，如下所示：

```
public function getServiceConfig()
{
    return array(
        'factories' => array(
            'ModName\Form\RegionFilter' => function($sm) {
                $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                return new RegionFilter($dbAdapter);
            },
        ),
    );
} 
```

最后在您的控制器中，只需执行以下操作：

```
if ($request->isPost()) {
    $filter = $this->getServiceLocator()->get('ModName\Form\RegionFilter');
    $form->setInputFilter($filter->getInputFilter());
    $form->setData($request->getPost());
    if ($form->isValid()) {
        $this->getRegionTable()->save($form->getData());
        return $this->redirect()->toRoute('zfcadmin/regions');
    }
} 
```

**选项 2：**

这涉及使用`Region`注入的实例构建您的表。然后您可以将原型设置为此。

所以在你的表结构中：

```
public function __construct(Adapter $adapter, Region $region)
{
    $this->adapter = $adapter;
    $this->resultSetPrototype = new ResultSet();
    $this->resultSetPrototype->setArrayObjectPrototype($region);
    $this->initialize();
} 
```

然后你的工厂：

```
public function getServiceConfig()
{
    return array(
        'invokables' => array(
            'RegionModel' => 'FcLibraries\Model\Region', 
        ),
        'factories' => array(
            'FcLibraries\Model\RegionTable' => function ($sm) {
                $region = $sm->get('RegionModel');
                $dbAdapter = $sm->get('Zend\Db\Adapter\Adapter');
                $table = new RegionTable($dbAdapter,$region);
                return $table;
            },
        ),
    );
} 
```

您应该能够保持其余代码不变。例如控制器。现在我还没有测试过这种方法，所以我不是 100% 它会起作用，但我认为它应该。我自己以前使用过的其他两种方法。

**选项3（最简单）：**

这涉及通过服务管理器获取一个单独的区域模型，并使用该模型将输入过滤器应用于表单。

```
public function editAction()
{
    $id = (int)$this->params()->fromRoute('id', 0);
    if (!$id) {
        return $this->redirect()->toRoute('zfcadmin/region', array(
            'action' => 'add'
        ));
    }
    $data = $this->getRegionTable()->get($id);
    $form = new RegionForm();
    $form->bind($data);
    $form->get('submitBtn')->setAttribute('value', 'Save');
    $request = $this->getRequest();
    if ($request->isPost()) {
        $region = $this->getServiceLocator()->get('RegionModel');
        $form->setInputFilter($region->getInputFilter());
        $form->setData($request->getPost());
        if ($form->isValid()) {
            $this->getRegionTable()->save($form->getData());
            return $this->redirect()->toRoute('zfcadmin/regions');
        }
    }
    return array(
        'id' => $id,
        'form' => $form,
    );
} 
```

我没有测试过代码，但你应该明白要点。任何问题都可以问。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-25T09:15:28.377

要对“用户名是否已存在”进行验证，请执行以下简单的 Service Manager 配置设置方法，例如：

// 配置/自动加载/global.php

```
return array(
   'db' => array(
   'driver'   => 'Pdo',
   'dsn'      => 'mysql:dbname=zf2tutorial;host=localhost',
),

 'service_manager' => array(
   'factories' => array(
     'Zend\Db\Adapter\Adapter' => function ($serviceManager) {
        $adapterFactory = new Zend\Db\Adapter\AdapterServiceFactory();
           $adapter = $adapterFactory->createService($serviceManager);

           \Zend\Db\TableGateway\Feature\GlobalAdapterFeature::setStaticAdapter($adapter);

           return $adapter;
     }
  ),
) 
```

);

并将以下数组添加到 getInputFilter() 中：

```
array(
  'table'   => 'users',
  'field'   => 'username',
  'adapter' => \Zend\Db\TableGateway\Feature\GlobalAdapterFeature::getStaticAdapter();
) 
```

# verilog - Verilog 非阻塞赋值序列

> ID：15718192
> 
> 赞同：13
> 
> 时间：2013-03-30T11:48:39.433
> 
> 标签：verilog, synthesis

说出以下代码部分（同一块）：

```
A <= 1
A <= 2 
```

变量 A 总是被赋值为 2 吗？还是会有竞争条件并分配1或2？

我对非阻塞分配的理解是，由硬件在将来分配变量 A ，因此它可能是随机结果。然而，这是不直观的。模拟显示 2 总是被分配，但我想知道这是否*绝对*是硬件综合的情况。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-31T17:35:39.550

A 在模拟中为 2，最后定义的值生效。如果它们不在同一个块中，则可能存在竞争条件，具体取决于模拟器调度程序，该调度程序是在模拟中最后定义的。

我已经看到这种技术被大量使用，并且在合成后从未见过任何意想不到的结果。

来自 Verilog IEEE 1364-2005 第 11.4.1 节确定性

> begin-end 块中的语句应按照它们在该 begin-end 块中出现的顺序执行。特定开始-结束块中语句的执行可以暂停以支持模型中的其他进程；但是，在任何情况下，begin-end 块中的语句都不应以它们在源代码中出现的顺序以外的任何顺序执行。

这也在 SystemVerilog-IEEE1800 2012 中作为第 4.6 节确定性

这可能是一个 FSM，它稀疏地定义了它的输出：

```
always @(posedge clk) begin
  out_one <= 1'b0;
  out_two <= 1'b0;
  out_thr <= 1'b0;
  case (state)
    2'd1 : out_one <= 1'b1;
    2'd2 : out_two <= 1'b1;
    2'd3 : out_thr <= 1'b1;
  endcase
end 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-09-24T04:56:46.103

代码中的最终值没有任何不确定性`A`，不是用于模拟，也不是用于综合。

但是，绝对准确地说，如果设计包含触发器，则可能存在模拟综合不匹配`A`。考虑以下示例：

```
module test(input clk, output reg a, b);
  always @(posedge clk) begin
    a <= 0;
    a <= 1;
  end

  initial b = 0;
  always @(posedge a) begin
    b <= !b;
  end
endmodule 
```

还有一个测试台：

```
module tb;
  reg clk = 0;
  always #5 clk = ~clk;

  wire a, b;
  test uut (clk, a, b);

  initial begin
    $monitor("clk=%b a=%b b=%b", clk, a, b);
    repeat (100) @(posedge clk);
    $finish;
  end
endmodule 
```

在模拟过程中，更新`a <= 0`和`a <= 1`推送到 NBA 事件区域并按顺序执行，因此`a`总是最终被设置。然而，在执行时，每个时钟周期都有一个`a <= 0`宽度为零的负脉冲。`a`该脉冲触发第二个始终阻塞。这是模拟输出（使用 Icarus Verilog 和 Modelsim 测试）：

```
clk=0 a=x b=0
clk=1 a=1 b=1
clk=0 a=1 b=1
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=1
clk=0 a=1 b=1
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=1
clk=0 a=1 b=1
clk=1 a=1 b=0
clk=0 a=1 b=0
... 
```

然而，在综合中，这将简单地分配`a`常数值 1 和`b`常数值零。（使用 Yosys 和 Xilinx Vivado 测试。）所以综合后仿真输出如下所示：

```
clk=0 a=1 b=0
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=0
clk=0 a=1 b=0
clk=1 a=1 b=0 
```

（理论上第一行仍然可以说`a=x`，但是每个像样的综合工具都会优化`a`-flip-flop，就像测试中的两个工具一样。）

Other than that there is no potential issue with that code, and as @Morgan pointed out correctly in his answer, this is a very usual coding technique for defining the "default values" of output signals before encoding the special cases using conditional assignments (using `if` and/or `case`).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T12:55:14.507

根据 IEEE 标准（例如 1800-2009 年）中的“确定性”部分，如果这些语句位于开始-结束块中，则在模拟中将始终为 A 分配值 2。

但是，Std 不保证如何合成代码。结果门可能取决于综合工具。但是，一个好的 RTL linting 工具会识别出这种糟糕的编码。Cadence 的 Hal lint 工具发出警告。

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2013-03-30T19:23:44.523

从 RTL 的角度来看。"A" 将被分配 1 和 2，它可以先是 1，然后是 2，反之亦然，但你无法真正知道在 begin-end 块的末尾将分配哪个值，它可以是 1 或 2（如分配的第二个值）。

# android - 为什么 Android 为图像分配的内存是我预期的两倍？

> ID：15718195
> 
> 赞同：2
> 
> 时间：2013-03-30T11:48:59.590
> 
> 标签：android, bitmap, imageview

我正在使用 setImageResource() 在 Android 应用程序中加载图像资源，出于某种原因，这使用了大量额外的内存。

这是我在加载图像时看到的：

```
03-29 15:16:56.687: D/dalvikvm(23616): GC_FOR_ALLOC freed 42K, 11% free 16175K/18119K, paused 11ms
I/dalvikvm-heap(23616): Grow heap (frag case) to 23.154MB for 7675216-byte allocation
D/dalvikvm(23616): GC_CONCURRENT freed 3K, 8% free 23667K/25671K, paused 1ms+2ms
D/dalvikvm(23616): GC_FOR_ALLOC freed 0K, 8% free 23667K/25671K, paused 10ms
I/dalvikvm-heap(23616): Grow heap (frag case) to 39.624MB for 17272816-byte allocation
D/dalvikvm(23616): GC_CONCURRENT freed 0K, 5% free 40535K/42567K, paused 1ms+2ms 
```

jpg 是 1599x1200，所以我希望第一次分配 - 1599 * 1200 * 4 = 7675200。17MB 分配是怎么回事？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-30T12:14:40.340

很可能您将图像放入`drawable-mdpi`或只是`drawable`目录，但在`hdpi`设备上运行应用程序。在这种情况下，图像的尺寸将按 1.5 缩放。

```
1599 * 1200 * 4 * 1.5 * 1.5 = 17269200b ~ 17mb 
```

您可能应该将图像移动到`drawable-nodpi`目录以避免不必要的缩放。

# c - Valgrind 中的读取大小无效

> ID：15718200
> 
> 赞同：0
> 
> 时间：2013-03-30T11:49:49.890
> 
> 标签：c, valgrind

```
>>Invalid read of size 1
==9464==    at 0x4C28804: __GI_strlen (mc_replace_strmem.c:284)
==9464==    by 0x400C11: dynamicAllocateStr (in /home/xkaya/DomTree/domtree)
==9464==    by 0x400CDC: createElement (in /home/xkaya/DomTree/domtree)
==9464==    by 0x400E50: cloneNode (in /home/xkaya/DomTree/domtree)
==9464==    by 0x4006A2: main (in /home/xkaya/DomTree/domtree)
==9464==  Address 0x51c0461 is 0 bytes after a block of size 1 alloc'd
==9464==    at 0x4C26FDE: malloc (vg_replace_malloc.c:236)
==9464==    by 0x400C21: dynamicAllocateStr (in /home/xkaya/DomTree/domtree)
==9464==    by 0x400CDC: createElement (in /home/xkaya/DomTree/domtree)
==9464==    by 0x40086D: internalReadNode (in /home/xkaya/DomTree/domtree)
==9464==    by 0x4008BB: internalReadNode (in /home/xkaya/DomTree/domtree)
==9464==    by 0x4008BB: internalReadNode (in /home/xkaya/DomTree/domtree)
==9464==    by 0x400A18: internalReadDocument (in /home/xkaya/DomTree/domtree)
==9464==    by 0x400A33: readDocument (in /home/xkaya/DomTree/domtree)
==9464==    by 0x400685: main (in /home/xkaya/DomTree/domtree) 
```

代码：

```
char* dynamicAllocateStr(char* string)
{
int length;
char* result;
int i;

if (string == NULL)
    return NULL;

length = strlen(string);
result = (char*)malloc(length);

for (i = 0; i <  length; i++) {
    result[i] = string[i];
}

return (result);
} 
```

这是 createElement 函数

```
 element* createElement(const char* name, const char* text) {
element* result;

if (name == NULL)
    return NULL;

result =  (element*)malloc(sizeof(element));

if (result == NULL)
    return NULL;

result->parent = NULL;
result->nextSibling = NULL;
result->previousSibling = NULL;
result->firstChild = NULL;
result->lastChild = NULL;     
result->name = dynamicAllocateStr((char*)name);
result->text = dynamicAllocateStr((char*)text);   

return (result);
  } 
```

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:57:17.163

我看到一个问题`dynamicAllocateStr`。

当你复制一个字符串时，你必须为空终止符分配内存`\0`并复制它。

注意：你可以简单地使用`strdup`，你的平台要么已经支持它，要么你可以使用这里的实现：[strdup() - 它在 C 中做了什么？](https://stackoverflow.com/questions/252782/strdup-what-does-it-do-in-c)

# android - android-sql lite- 使用 lat long 值的两点之间的距离

> ID：15718202
> 
> 赞同：0
> 
> 时间：2013-03-30T11:49:51.890
> 
> 标签：android, database, sqlite

我正在尝试计算两个位置之间的距离。一个位置的纬度现在是硬编码的（我稍后将通过考虑 gps 的值来更改它）其他位置存储在数据库中。我正在使用以下查询

```
Cursor c = sampleDB.rawQuery("SELECT NAME, CONTACT,((LAT -" +
        " LATCUR) * (LAT - LATCUR) + ((LONG - LONGCUR) * 2) * ((LONG - LONGCUR) * 2)) " +
        "AS DISTANCE FROM AMBULANCE ORDER BY DISTANCE", null ); 
```

其中`LATCUR`和`LONGCUR`是当前值。我收到错误，因为没有名为 latcur 的列。我该怎么办？

我将 latcur 和 longcur 值声明为 public static double LATCUR = 39.991932; 公共静态双 LONGCUR = -83.012352;

代码：公共类 MainActivity 扩展 ListActivity {

```
private final String DBNAME = "SERVICES";
private final String TABLENAME = "AMBULANCE";
public static double LATCUR = 39.991932;
public static double LONGCUR = -83.012352;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    ArrayList<String> results = new ArrayList<String>();
    SQLiteDatabase sampleDB = null;

    try {

        sampleDB =  this.openOrCreateDatabase(DBNAME, MODE_PRIVATE, null);

        sampleDB.execSQL("CREATE TABLE IF NOT EXISTS " +
                TABLENAME +
                " (NAME VARCHAR, CONTACT VARCHAR," +
                " LAT float, LONG float, LATC double, LONGC double);"); 
```

Cursor c = sampleDB.rawQuery("SELECT NAME, CONTACT,((LAT -" + " LATCUR) * (LAT - LATCUR) + ((LONG - LONGCUR) * 2) * ((LONG - LONGCUR) * 2)) " + "AS DISTANCE FROM AMBULANCE ORDER BY DISTANCE", null );

```
 if (c != null ) {
            if  (c.moveToFirst()) {
                do {
                    String NAME = c.getString(c.getColumnIndex("NAME"));
                    String CONTACT = c.getString(c.getColumnIndex("CONTACT"));
                    results.add("" + NAME + ",CONTACT: " + CONTACT);
                }while (c.moveToNext());
            } 
        }

        this.setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1,results));

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T11:54:25.173

You have them quoted. You need to do all your math outside the quoted SQL string.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:27:16.097

try this.....

```
 Cursor c = sampleDB.rawQuery("SELECT NAME, CONTACT,((LAT -"+LATCUR+") * (LAT - "+LATCUR+") + ((LONG - "+LONGCUR+") * 2) * ((LONG - "+LONGCUR+") * 2)) " +
 "AS DISTANCE FROM AMBULANCE ORDER BY DISTANCE", null ); 
```

hope it helps.

# javascript - Dealing with transformed data in AngularJS

> ID：15718203
> 
> 赞同：3
> 
> 时间：2013-03-30T11:49:54.313
> 
> 标签：javascript, angularjs

I have a list of timestamps. I can list them with AngularJS. However I want to list it as date strings. Those date strings should be editable - and when it's finished I would like to have the related timestamp updated too.

My first question is: what is the AngularJS way of presenting items in a different format (filters?) and still have the bidirectional data binding? (Module, directive, listeners?)

Thank you

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-30T13:10:07.120

If your editable data is the raw data (Timestamp), than you [shall go with filters](http://docs.angularjs.org/api/ng.filter%3afilter).

But if you want it to be editable in date string format, than you'll need to create a directive to augment the `ngModel+input`, by adding custom [`$parsers`](http://docs.angularjs.org/api/ng.directive%3angModel.NgModelController#%24parsers) and [`$formatters`](http://docs.angularjs.org/api/ng.directive%3angModel.NgModelController#%24formatters).

It's quite simple indeed:

```
app.directive('dateFormat', function() {
  return {
    require: 'ngModel',
    link: function(scope, element, attr, ngModelCtrl) {
      ngModelCtrl.$formatters.unshift(function(valueFromModel) {
        // return how data will be shown in input
      });

      ngModelCtrl.$parsers.push(function(valueFromInput) {
        // return how data should be stored in model
      });
    }
  };
}); 
```

In your HTML:

```
<input type="text" ng-model="date" date-format /> 
```

The directive will require `ngModelController` so you can augment its behavior.

Made a [Plunker](http://plnkr.co/edit/WCQvPZY40ot44uwTs5HK?p=preview). Of course, if you need simple date manipulation, consider using Filters programmatically inside your directive, so you don't repeat already implemented filters. I'm using it in Plunker, so you can see how to use.

# java - 确定先前从单个图像拼接到的图像数量的问题

> ID：15718205
> 
> 赞同：1
> 
> 时间：2013-03-30T11:50:19.890
> 
> 标签：java, image, image-processing, jai

我需要从之前拼接在一起的一张图像中提取单个图像并对其进行处理。*例如*，将四个独立的图像拼接成一个图像，如下所示：

![先前拼接的图像](../Images/66e2cb04c69aaa967d6d3f01e24a34c7.png)

作为图像处理的新手，我做了一些研究，发现[Java Image IO](http://docs.oracle.com/javase/6/docs/api/index.html?javax/imageio/package-summary.html)适合我的要求。

这是我到目前为止写的：

**图像提取与处理**

```
ImageInputStream oldImage = ImageIO
            .createImageInputStream(new FileInputStream("Four_Image_Stitched.jpeg"));

    ImageReader imageReader = getImageReader(imageFormat);
    imageReader.setInput(oldImage);

    int nosOfImages = imageReader.getNumImages(true);
    System.out.println("Number of Images = " + nosOfImages);
    if (nosOfImages > 1) {
        for (int i = 0; i < nosOfImages; i++) {
            BufferedImage image = imageReader.read(i);
            // do some processing
        }
    } 
```

**获取图像阅读器实例**

```
private ImageReader getImageReader(String imageFormat) {

    if ("PNG".equalsIgnoreCase(imageFormat)) {
        return new PNGImageReader(new PNGImageReaderSpi());
    }
    if ("JPEG".equalsIgnoreCase(imageFormat)) {
        return new JPEGImageReader(new JPEGImageReaderSpi());
    }
    if ("GIF".equalsIgnoreCase(imageFormat)) {
        return new GIFImageReader(new GIFImageReaderSpi());
    }
    if ("BMP".equalsIgnoreCase(imageFormat)) {
        return new BMPImageReader(new BMPImageReaderSpi());
    }
    return null;
} 
```

这里的问题`imageReader.getNumImages(true)`总是`1`针对每种格式返回，而与拼接图像的数量无关；我想这应该是实际缝合的图像数量，特别`4`是在提到的例子中。

I am not sure what exactly I am missing here!

Any help or pointers in this regard would be highly appreciated.

**P.S.:**
Number of images stitched into single are not know before hand *i.e.* a single image might contain `n` number of stitched images, each with different dimensions.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:00:04.873

您似乎相信拼接图像以某种方式单独存储在完整图像中？情况并非如此（几乎可以肯定），一旦将（比如说）四个图像拼接成一个图像并保存，你就有一个图像 - 一个像素矩阵 - 你不能说它是由 N 个图像组成的，除非你一些图像处理启发式算法来检测颜色的突然变化等，`getNumImages()`如果仅适用于允许内部多个子图像的一些特殊图像格式，例如文本文档中的“页面”；通常它们是动画中的帧。

在像这个例子这样简单的情况下，一个简单的边缘检测器就足够了。

# django - 无法在 django 外键序列化中使用自然键

> ID：15718214
> 
> 赞同：1
> 
> 时间：2013-03-30T11:52:08.463
> 
> 标签：django, serialization, foreign-keys, natural-key

所以问题是我有一个有外键的类。

这是我的代码

```
class Proxy(models.Model):
  class Meta:
    db_table = 'Proxy'
  equipment = models.ForeignKey('Equipment', primary_key=True)      
  pop = models.ForeignKey('Pop') 
```

现在，像往常一样，当我这样做时

```
import django.core.serializers as Serializer
res = Proxy.objects.filter(equipment_id__exact='eq1')
Serializer.serialize('json', res) 
```

json 输出包含 Pop 的“id”而不是我想要的名称。

所以我使用了 Manager 类，这是我现在的 Pop 类-

```
class PopManager(models.Manager):
  def get_by_natural_key(self, name):
    return self.get(name=name)

class Pop(models.Model):
  POP_TYPES = (
    ('phy','phy'),
    ('cloud','cloud'),
  )

  class Meta:
    db_table = 'Pop'
    unique_together = ('name', 'vip')
  objects = PopManager()
  name = models.CharField(max_length=10)
  type = models.CharField(max_length=10, choices=POP_TYPES)

  def natural_key(self):
    return (self.name) 
```

但在此之后，当我这样做时

```
res = Proxy.objects.filter(equipment_id__exact='eq1')
Serializer.serialize('json', res, use_natural_keys=True) 
```

我收到一个错误，TypeError: Equipment: eq1 is not JSON serializable

我也尝试过 wadofstuff 用于外键的序列化，但显然在 Django1.5 中，simplejson 和 json 之间存在冲突，并且查询抛出错误。所以我回到第一方。

任何帮助将不胜感激。我已经把头发分开了好几个小时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T19:22:16.967

无论如何，所以我通过将 QuerySet 转换为原始字典类型格式来解决这个问题。我在过滤器之后附加了一个值子句。并遍历返回的整个查询集以制作字典列表。其余的很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T17:35:25.957

阿尼瓦，

你只需要删除你的行：

db_table = '流行音乐'

# c# - 设置文本框的文本属性（Windows Phone 8 应用程序）

> ID：15718215
> 
> 赞同：0
> 
> 时间：2013-03-30T11:52:20.140
> 
> 标签：c#, xaml, windows-phone-8

基本上我想从为钱包创建的卡中设置一个等于 CustomerName 的文本框值。为了实现这一点，我需要将文本框的文本属性设置为等于什么。这可能吗？谢谢

Product.xaml（文本框在哪里）

编码

```
<TextBoxGrid.Row="1"Grid.Column="0"Name="TodoInput2"Text="{}"Visibility="Collapsed"/> 
```

`Product.xaml.cs` （创建钱包卡的地方，我想将我的文本框设置为等于的值`Pi.CustomerName=member. Name`）

编码

```
PaymentInstrument PI;

PI = new PaymentInstrument("Account")

Pi.CustomerName = member. Name; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T11:59:58.673

您应该将 PI 设置为页面或文本框的数据上下文，然后您可以使用绑定到它

```
<TextBoxGrid.Row="1"Grid.Column="0"Name="TodoInput2"Text="{Binding CustomerName}"Visibility="Collapsed"/> 
```

为了在文本框或任何其他元素中设置数据上下文，您可以为元素命名，并在后面的代码中设置数据上下文

```
<TextBoxGrid x:Name=TxtBox>
   <TextBoxGrid.Row="1"Grid.Column="0"Name="TodoInput2"Text="{Binding CustomerName}"Visibility="Collapsed"/>
</TextBoxGrid> 
```

在代码隐藏中

```
TxtBox.DataContext=PI; 
```

# java - found raw type, missing return arguments for generic class

> ID：15718217
> 
> 赞同：1
> 
> 时间：2013-03-30T11:52:50.477
> 
> 标签：java, swing, class, generics, netbeans

I don't understand this warning:

```
found raw type: javax.swing.DefaultListModel
missing type arguements for generic class javax.swing.DefaultListModel 
```

Netbeans seems to indicate that more information can be found from `alt-enter` but nothing comes up. The type should be ?

![enter image description here](../Images/c7e924ea7b969c439dc8d4874de09788.png)

code:

```
package net.bounceme.dur.nntp.swing;

import java.util.logging.Logger;
import javax.swing.DefaultListModel;

public class MessagesListModel extends DefaultListModel {
    private static final long serialVersionUID = 1L;
    private static final Logger LOG = Logger.getLogger(MessagesListModel.class.getName());

    @Override
    @SuppressWarnings("unchecked")
    public void addElement(Object element) {
        super.addElement(element);
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:00:28.097

*DefaultListModel* is a [generic type](http://docs.oracle.com/javase/7/docs/api/javax/swing/DefaultListModel.html) from *Java 7*.

You should do `DefaultListModel<ClassName>` instead of `DefaultListModel`.

Generally, this is more safe, since you specify what you should and what you shouldn't insert to the list. So if you made mistake, the compiler will arise an error.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:00:52.567

*From **Java 7** DefaultListModel is considered as Generic class*. See [DefaultListModel](http://docs.oracle.com/javase/7/docs/api/javax/swing/DefaultListModel.html) . And while extending it you are not providing generic type to the DefaultListModel that you are extending. That's why your IDE is warning you.
Either you could ignore this warning. or As alternative you provide some `Type parameter` to it like `<Integer>` `<String>` or anything.. for example.

```
public class MessagesListModel extends DefaultListModel<String> 
```

# javascript - 来自javascript的Nan结果

> ID：15718218
> 
> 赞同：1
> 
> 时间：2013-03-30T11:52:53.857
> 
> 标签：javascript

嗨，这是我的第一篇文章，也是我第一次尝试使用 javascript（我喜欢 php）。问题是我从我的 js 中得到了一个 NaN 结果（如果我能得到要移植的代码！）

```
<script type="text/javascript">
    function Running_Total() { 
        alert('firing');
        var cost1 = "'.$_SESSION['75gmcost'].'"+""; 
        var cost2 = "'.$_SESSION['100gmcost'].'"+""; 
        var cost3 = "'.$_SESSION['1kgcost'].'";+""; 
        var cost4 = "'.$_SESSION['c75gmcost'].'"+""; 
        var qty1 = "'.$_SESSION['qty75gm'].'"+""; 
        var qty2 = "'.$_SESSION['qty100gm'].'"+""; 
        var qty3 = "'.$_SESSION['qty1kg'].'"+""; 
        var qty4 = "'.$_SESSION['qtyc75gm'].'"+""; 
        var sum = 0;
        sum += cost1 * qty1;
        sum += cost2 * qty2;
        sum += cost3 * qty3;
        sum += cost4 * qty4;
        $('#tot_cost').empty();
        $('#tot_cost').append(sum);
    }
</script> 
```

我正在尝试对表单输入的订单总数求和，但对 js 的了解不足以解决 Nan 问题。我想我的 php 变量必须更改以适合 js，但不知道该怎么做？##

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:06:34.140

尝试用以下代码替换代码中的 var 分配：

```
var cost1 = {$_SESSION['75gmcost']};
var cost2 = {$_SESSION['100gmcost']};
var cost3 = {$_SESSION['1kgcost']}; 
var cost4 = {$_SESSION['c75gmcost']}; 
var qty1 = {$_SESSION['qty75gm']};
var qty2 = {$_SESSION['qty100gm']}; 
var qty3 = {$_SESSION['qty1kg']};
var qty4 = {$_SESSION['qtyc75gm']}; 
```

连接字符串会产生一个在 JavaScript 中不是解释为数字 (NaN) 的值。

这是一个警告“4”的工作示例

```
<?php
    session_start();
    $_SESSION['75gmcost'] = 1; 
    $_SESSION['100gmcost'] = 1;  
    $_SESSION['1kgcost'] = 1; 
    $_SESSION['c75gmcost'] = 1; 
    $_SESSION['qty75gm'] = 1;  
    $_SESSION['qty100gm'] = 1; 
    $_SESSION['qty1kg'] = 1; 
    $_SESSION['qtyc75gm'] = 1; 

    print <<< HERE
           <script type="text/javascript">
    function Running_Total() { 
            alert('firing');
        var cost1 = {$_SESSION['75gmcost']}; 
        var cost2 = {$_SESSION['100gmcost']};
        var cost3 = {$_SESSION['1kgcost']};
        var cost4 = {$_SESSION['c75gmcost']}; 
        var qty1 = {$_SESSION['qty75gm']};
        var qty2 = {$_SESSION['qty100gm']}; 
        var qty3 = {$_SESSION['qty1kg']};
        var qty4 = {$_SESSION['qtyc75gm']}; 
        var sum = 0;
        sum += cost1 * qty1;
        sum += cost2 * qty2;
        sum += cost3 * qty3;
        sum += cost4 * qty4;
        alert(sum);
    }
    Running_Total();
    </script>
    HERE;
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:03:28.510

我通常会做这样的事情（你可以在这里看到结果：http: [//jorgecardoso.eu/temp/test.php](http://jorgecardoso.eu/temp/test.php)）：

```
<html>
<head>

<?php
     // just to test
session_start();
$_SESSION['75gmcost'] = 1;
$_SESSION['100gmcost'] = 1;
$_SESSION['1kgcost'] = 1;
$_SESSION['c75gmcost'] = 1;
$_SESSION['qty75gm'] = 1;
$_SESSION['qty100gm'] = 1;
$_SESSION['qty1kg'] = 1;
$_SESSION['qtyc75gm'] = 1;
?>

<script type="text/javascript">
    function Running_Total() {
        alert('firing');
        var cost1 = <?php echo $_SESSION['75gmcost'] ?>;
        var cost2 = <?php echo $_SESSION['100gmcost'] ?>;
        var cost3 = <?php echo $_SESSION['1kgcost'] ?>;
        var cost4 = <?php echo $_SESSION['c75gmcost'] ?>;
        var qty1 =  <?php echo $_SESSION['qty75gm'] ?>;
        var qty2 = <?php echo $_SESSION['qty100gm'] ?>;
        var qty3 = <?php echo $_SESSION['qty1kg'] ?>;
        var qty4 = <?php echo $_SESSION['qtyc75gm'] ?>;
        var sum = 0;
        sum += cost1 * qty1;
        sum += cost2 * qty2;
        sum += cost3 * qty3;
        sum += cost4 * qty4;
        alert( sum);
//        $('#tot_cost').empty();
//        $('#tot_cost').append(sum);
    }
</script>

</head>
<body>
<script type="text/javascript">
Running_Total();
</script>
</body>
</html> 
```

# php - 从 Javascript 读取/写入 php 对象的最佳方法

> ID：15718219
> 
> 赞同：0
> 
> 时间：2013-03-30T11:52:54.470
> 
> 标签：php, jquery

我有一个 PHP 类/对象，它充当我网页的主要数据源。我正在使用 jQuery/Javascript 为用户提供动态交互体验。两个部分独立工作非常好。

我现在正试图为我编写的用于访问和更新存储在 PHP 对象中的数据的 javascript 库找到一种优雅而干净的方法。

通信 Javascript -> PHP：我以前总是创建一个 PHP 包装器，它通过 GET/POST 接收输入并将数据路由到适当的 PHP 函数。这工作得很好，但肯定有一种更简洁的方式来从 javascript 到 PHP 的接口？

通信 PHP -> Javascript：我之前编写的网站只看到了从 javascript 到 PHP 的通信。PHP 将输出 Javascript 放置在容器中的 HTML（我猜是标准 javascript 用法）。但是，在这个网站中，我编写的 Javascript 库需要结构化数据作为回报，它会处理这些数据以执行多个 UI 更新。似乎在这里研究 JSON 是正确的，但似乎有多种选择。

我喜欢关于让您的 PHP 和 Javascript 双向通信的最佳方式的建议，这是一种干净而优雅的方式。

谢谢！

# git - 添加 git 子模块时不需要的子文件夹

> ID：15718222
> 
> 赞同：1
> 
> 时间：2013-03-30T11:53:03.900
> 
> 标签：git, subdirectory, git-submodules

我正在尝试添加一个 git 子模块。子模块本身没有任何问题，但我的问题是添加子模块时创建的布局。

我正在添加一个名为 utils 的简单子模块，它只包含一个文件。

我正在使用这个

```
git submodule add --force ssh://myserver/home/git_repositories/utils js/utils 
```

因为我想将子模块 utils 添加到 js/utils 文件夹中

问题是，在执行此操作后，在 js/utils 文件夹中，我找到了另一个名为 utils 的文件夹，例如 js/utils/utils，在那里我找到了我的 javascript。

我想要一个像 js/utils/ 这样的布局，这里是我的 javascript。

我试图消除 git 子模块中的 /utils 添加之类的

```
git submodule add --force ssh://myserver/home/git_repositories/utils js/ 
```

但随后 git 产生

```
'js' already exists in the index 
```

你知道有什么方法可以避免那个次要的 /utils 吗？

提前非常感谢！

普鲁士蓝

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T12:24:26.537

我发现问题出在我原来的 utils repo 中。

显然我忘记在那个特定文件夹中执行 git init 了，因此它将父级作为根级别，从而创建了额外不需要的 /utils

为了解决这个问题，我只需要在 utils 文件夹 git add 中执行 git init 。, git 提交和推送。当作为子模块拉动时，现在它具有正确的布局！

我的错！希望这对某人有所帮助，非常感谢您的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T15:20:45.930

尝试这个：

1.  从`.gitmodules`文件中删除此子存储库的部分；
2.  从`.git/config`文件中删除此子存储库的部分；
3.  `git rm --cached submodule_path`;
4.  `rm -rf submodule_path`

# android - 空指针gridView android

> ID：15718232
> 
> 赞同：0
> 
> 时间：2013-03-30T11:53:43.680
> 
> 标签：android, exception, gridview, null

我得到一个空指针异常`gridView.setOnItemClickListener(new OnItemClickListener()`。我该如何初始化它？这是在 MainActivity 的 `onCreate 方法中。

```
 GridView gridView = (GridView)findViewById(R.id.grid_view);

 gridView.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View v, int position,
                long id) {
            // sending image id to FullScreenActivity
            Intent i = new Intent(getApplicationContext(), FullImage2.class);
            // passing array index
            i.putExtra("id", position);
            startActivity(i);       
        }
    }); 
```

那是日志：

```
03-30 11:51:31.993: E/AndroidRuntime(879): FATAL EXCEPTION: main
03-30 11:51:31.993: E/AndroidRuntime(879): java.lang.RuntimeException: Unable to start activity ComponentInfo{ie.gmit.gmitapp/ie.gmit.gmitapp.MainActivity}: java.lang.NullPointerException
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.os.Looper.loop(Looper.java:137)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.ActivityThread.main(ActivityThread.java:5039)
03-30 11:51:31.993: E/AndroidRuntime(879):  at java.lang.reflect.Method.invokeNative(Native Method)
03-30 11:51:31.993: E/AndroidRuntime(879):  at java.lang.reflect.Method.invoke(Method.java:511)
03-30 11:51:31.993: E/AndroidRuntime(879):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-30 11:51:31.993: E/AndroidRuntime(879):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-30 11:51:31.993: E/AndroidRuntime(879):  at dalvik.system.NativeStart.main(Native Method)
03-30 11:51:31.993: E/AndroidRuntime(879): Caused by: java.lang.NullPointerException
03-30 11:51:31.993: E/AndroidRuntime(879):  at ie.gmit.gmitapp.MainActivity.onCreate(MainActivity.java:184)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.Activity.performCreate(Activity.java:5104)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
03-30 11:51:31.993: E/AndroidRuntime(879):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) 
```

FullImage2.类：

```
public class FullImage2 extends Activity {
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_full_image);
    //get intent data
    Intent i = getIntent();
    // selected image id
    int position = i.getExtras().getInt("id");
    ImageAdapter imageAdapter = new ImageAdapter(this);
    ImageView imageView = (ImageView)findViewById(R.id.full_image_view);
    imageView.setImageResource(imageAdapter.mThumbIds[position]);

    //implement up navigation
    getActionBar().setDisplayHomeAsUpEnabled(true);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.full_image, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    // TODO Auto-generated method stub
    switch (item.getItemId()){
    case android.R.id.home:
        //this is called when the home up button is pressed in the action bar
        Intent parentActivityIntent = new Intent(this, MainActivity.class);
        parentActivityIntent.addFlags(
        Intent.FLAG_ACTIVITY_CLEAR_TOP |
        Intent.FLAG_ACTIVITY_NEW_TASK);
        startActivity(parentActivityIntent);
        finish();
        return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

}

第 184 行是：

```
 gridView.setOnItemClickListener(new OnItemClickListener() { 
```

# javascript - Optimized Algorithm to compare Templates of two URLs

> ID：15718235
> 
> 赞同：1
> 
> 时间：2013-03-30T11:54:03.983
> 
> 标签：javascript, jquery, algorithm, templates, jsoup

**EDITED, Please Read Again, As I added some work of mine**

My task is to compare templates of two URLS. I am ready with my algorithm. But it takes too much time to give final answer.

I wrote my code in *Java* using *Jsoup* and *Selenium*

Here, *Templates* means the way any page presents its contents.

**Example:-**

Any shopping website have page of any Shoes, that contains,

```
Images in the left.
Price and Size in the right.
Reviews in the bottom. 
```

If two URLS are of any specific product , then it return "Both are from same templates". Example , [this link](http://www.jabong.com/Lara-Karen-Full-Sleeve-Black-Polyester-Top-With-Cotton-Lace-196636.html) and [this link](http://www.jabong.com/Puma-Flash-Ind-Black-Running-Shoes-187831.html) have same template.

If one URL shows any product and another URL shows any category ,then it shows "No match". Example, [this link](http://www.jabong.com/Lara-Karen-Full-Sleeve-Black-Polyester-Top-With-Cotton-Lace-196636.html) and [this link](http://www.jabong.com/women/clothing/womens-tops/) are from different template.

I think that this algorithm requires some optimization, that's why I am posting this question in this forum.

**My algorithm**

1.  Fetch, parse two input URLS and make their [DOM trees](http://en.wikipedia.org/wiki/Document_Object_Model).
2.  Then if any page contains , UL and TABLE , then remove that tag. I done this because, may be two pages contains different number of items.
3.  Then, I count number of tags in both URLS. say, initial_tag1, initial_tag2.
4.  Then, I start removing tags that have same position on corresponding pages and same Id and their below subtree, if that tree has number of nodes less than 10.
5.  然后，如果该树的节点数少于 10，我开始删除在对应页面上具有相同位置和相同类名称及其下面子树的标签。
6.  然后，如果该树的节点数少于 10，我开始删除没有 Id 和 No Class name 的标签及其下面的子树。
7.  步骤 4、5、6 具有 (N*N) 复杂度。这里，N 是标签的数量。[这样，每一步DOM树都会收缩]
8.  当它从这个递归中出来时，我检查 final_tag1 和 final_tag2。
9.  如果 final_tag1 和 final_tag2 小于 initial_tag1*(0.2) 和 initial_tag2*(0.2) 那么我**可以**这么说`Two URL matched`，否则`not`。

我对这个算法想了很多，我发现从 DOM 树中删除节点是一个非常缓慢的过程。这可能是减慢该算法的罪魁祸首。

我从一些极客那里讨论过，并且

> they said that use a score for every tag instead of removing them, and add them , and > at the end return (score I Got)/(accumulatedPoints) or something similar, and on the basis of that you decide two URLS are either similar or not.

But I didn't understand this. So can you explain this saying of some geek, or can you give any other optimized algorithm, that solve this problem efficiently.

Thanks in advance. Looking for your kind response.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T09:09:55.900

For comparing webpages there basically two ways, the fast and the slow one :

1.  Compare URLS : fast
2.  Compare DOM : slow (and complicated)

In your case, it appears that the first two items match a similar regular expression and the categories match another regexp.

Here is a short JAVA solution

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class TestRegexp {
public static void main(String[] args) {
    String URL_ITEM_1 = "http://www.jabong.com/Puma-Flash-Ind-Black-Running-Shoes-187831.html";
    String URL_ITEM_2 = "http://www.jabong.com/Lara-Karen-Full-Sleeve-Black-Polyester-Top-With-Cotton-Lace-196636.html";
    String URL_CATEGORY_1 = "http://www.jabong.com/kids/shoes/floaters/";
    String URL_CATEGORY_2 = "http://www.jabong.com/women/clothing/womens-tops/";

    Pattern itemPattern = Pattern.compile("http://www\\.jabong.com/([\\w\\p{Punct}\\d]+)\\.html");
    Pattern categoryPattern = Pattern.compile("http://www\\.jabong.com/([\\w\\p{Punct}]+/)+");

    System.out.println("Matching items");
    Matcher matcher = itemPattern.matcher(URL_ITEM_1);
    System.out.println(matcher.matches());
    matcher = itemPattern.matcher(URL_ITEM_2);
    System.out.println(matcher.matches());
    matcher = itemPattern.matcher(URL_CATEGORY_1);
    System.out.println(matcher.matches());
    matcher = itemPattern.matcher(URL_CATEGORY_2);
    System.out.println(matcher.matches());

    System.out.println("Matching categories");
    Matcher category = categoryPattern.matcher(URL_ITEM_1);
    System.out.println(category.matches());
    category = categoryPattern.matcher(URL_ITEM_2);
    System.out.println(category.matches());
    category = categoryPattern.matcher(URL_CATEGORY_1);
    System.out.println(category.matches());
    category = categoryPattern.matcher(URL_CATEGORY_2);
    System.out.println(category.matches());
}
} 
```

And the output :

```
Matching items
true
true
false
false
Matching categories
false
false
true
true 
```

It validates the first two first URLS as being items, the two last as being categories.

I hope it matches your requirement. Feel free to adapt in JS.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T13:09:59.903

To improve complexity of your algorithm, supposing you are using Jsoup, you must adapt your data structure to your algorithm.

4) What do you mean by position of tag ? the Xpath of the tag ? If yes, precompute this value once for each tag O(n) and store this value in each node. If required you can also store it in a HashMap to retrieve in O(1).

5) Index you tag by class name using MultiMap. You will save lot of computation

6) Index class with no Id, no class name

All these pre computations can be performed in one traversal of the tree so O(n).

Generally if you want to reduce computation, you will have to store more data in the memory. Since DOM page are very small data, this is no problem in your case.

# google-analytics - How can i change the expiry of Google Analytics.js from 12 hours?

> ID：15718240
> 
> 赞同：1
> 
> 时间：2013-03-30T11:54:41.723
> 
> 标签：google-analytics

Can you tell me how to increase the expiry time of the Google Analytics. All the page speed tests are telling me to increase it beyond 12 hours.

So far I have tried setting the expiry in the `.htaccess` file for all `*.js` files but it doesn't have any effect. I have also searched on the Analytics help pages and forum, without success.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:09:03.290

You can download/host it yourself -- just make sure you follow the [Google Analytics ga.js Changelog](https://developers.google.com/analytics/devguides/collection/gajs/changelog#changelog) and update it when applicable.

Note: PageSpeed is a recommendation, not a 100% steadfast rule. I'd be willing to bet you're over-optimizing something seemingly easy and could focus on other internal efforts for better performance gains. Give [Yotta](http://www.yottaa.com/) a shot and see what they say/think.

# wordpress - Is there any way I can add category ID in the URL of a Page in WordPress?

> ID：15718241
> 
> 赞同：0
> 
> 时间：2013-03-30T11:54:44.477
> 
> 标签：wordpress

I have a page that lists posts from a specific category.

Now I need to add another page which needs to list posts from another category.

I could just create a copy of the template that the working page is using and just change category ID.

But since everything else in the template is the same it would probably be better if both pages use the same page template and the category ID is obtained from the URL.

There is probably a way to achieve this but I'm not sure how.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:05:07.973

You can add a Custom Field in the page : `cats` = "1,2,3"

then in page template :

```
$custom_cats = get_post_custom_values('cats');
$args = array(
    'category'        => $custom_cats[0], //like: 1,2,3
    'orderby'         => 'post_date',
    'post_status'     => 'publish',
);
$query = get_posts( $args ); 
```

This is the same page template.

# browser - SWT Browser widget with Eclipse 4 RCP application

> ID：15718242
> 
> 赞同：2
> 
> 时间：2013-03-30T11:54:45.507
> 
> 标签：browser, eclipse-plugin, widget, swt, eclipse-rcp

Please help to get started with Eclipse 4 RCP.
Set task is to create simple application with imbedded browser (using SWT Browser widget)

This [Lars Vogel's Eclipse 4 RCP tutorial](http://www.vogella.com/articles/EclipseRCP/article.html#tutorial_e4wizard) is used. Created [application is on GitHub](https://github.com/PaulVI/Eclipse4RCPwithSWTBrowserWidget). Now I want to [add SWT browser widget](http://www.vogella.com/blog/2009/10/29/javascript-swt-browser-widget/).

I added [class](https://github.com/PaulVI/Eclipse4RCPwithSWTBrowserWidget/blob/master/src/com/example/e4/rcp/browser/View.java).

Unsurprisingly, now application doesn't start:
Added class seems quite of different nature. Seems I am missing some points about Eclipse 4 and SWT connection.

I have read the basics about Eclipse RCP before.

Here are docs: [http://www.eclipse.org/swt/widgets/](http://www.eclipse.org/swt/widgets/) and [JavaDoc](http://help.eclipse.org/juno/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/browser/Browser.html), but they don't explain.

**Where should be my next steps to? What to read?**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T16:39:06.293

1.  `ViewPart` is only used in Eclipse 3 RCP. Instead your part class should 1) be connected to the application model, as described in Vogella's tutorial; 2) create controls in a method annotated with `@PostConstruct`, with a signature like `public void createControls(Composite parent)`. His example in Section 17.2 even contains a `Browser`, but it doesn't matter *which* SWT widgets you want to use: the process is the same.
2.  You can't expect to find anything about RCP in SWT documentation! Look at the RCP documentation instead.
3.  > I have read the basics about Eclipse RCP before.

    Try to forget them, they likely will just confuse you. Eclipse 4 RCP does very many things differently. Of course, SWT and JFace haven't changed, so you can still use what you read about them.

# javascript - 用 javascript 计算中奖

> ID：15718243
> 
> 赞同：0
> 
> 时间：2013-03-30T11:54:53.003
> 
> 标签：javascript

我正在制作一个也有统计数据的小游戏。赢得时间和类似的东西。所以我做了这个html

```
<div id="stats">
    <h2>Stats</h2>
    <p>Win ratio: </p> <!-- Ignore this one -->
    <p><span id="wincount"></span> wins / <span id="lostcount"></span> losses</p>
</div> 
```

这是Javascript代码。我稍微缩短了它，所以你只能看到重要的东西：

```
var wontimes = 0;
var losstime = 0;
function getResult(){
    var tie = "It's a tie!";
    var won = "You have won!";
    var lost = "You lost!";
    switch(user){
    case 1: // rock
        switch(npc){
        case 1: // rock
            result = tie;
            break;
        case 2: // paper
            result = lost;
            break;
        }
        break;
    case 2: // paper
        switch(npc){
        case 1: // rock
            result = won;
            break;
        case 2: // paper
            result = tie;
            break;
        }
        break;
    }
    document.getElementById("gameresult").innerHTML = result;
    if (result === won){
        return wontimes = wontimes++;
    } else if (result === lost){
        return losstime = losstime++;
    } else {
        console.log("Tie");
    }
    document.getElementById("wincount").innerHTML = wontimes;
    document.getElementById("lostcount").innerHTML = losstime;
} 
```

当用户单击按钮时调用函数 getResult 并且它可以工作，但是它存在问题。我点击后。它告诉我我是否赢了等等。但它不算赢。我想让它每次用户获胜，wontimes 得到一个加号，然后它被打印出来`<span id="wincount"></span>`，它甚至不显示默认的 0 获胜。

有人能帮我吗？谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-30T11:57:45.993

如果从函数返回，后面的行将被忽略。

改变

```
 return wontimes = wontimes++; 
```

到

```
 wontimes++; 
```

（对于 也是如此`losstime`）

Note also that `wontimes++` is enough for incrementing a variable. If you do `wontimes = wontimes++`, you give to `wontimes` the value it had before the incrementing, which makes the whole useless.

# java - 覆盖后退按钮以恢复应用程序

> ID：15718244
> 
> 赞同：0
> 
> 时间：2013-03-30T11:54:56.183
> 
> 标签：java, android, android-webview, android-service, back-button

下面是我的应用程序问题的图片。

 ******启动时的应用程序：**

![应用程序启动时的快照](../Images/ad15dfd734ba7e17e38c60b711f2e17d.png)

 ******100% 进展：**

![加载页面](../Images/33fe3275b0a375653f449a2a2550fa4a.png)

 ******现在，如果我按回键并再次返回应用程序：**

![再次加载](../Images/3649ea3ec017c5e429de27185848bf61.png)

 ******我真正想要的：**当用户在按下返回键后返回时，应用程序应该恢复而不是重新加载。

我正在分享下面的代码。请提出解决方案。

```
package com.url.app;

import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.Uri;
import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.ProgressDialog;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.webkit.ValueCallback;
import android.webkit.WebView;
import android.webkit.WebChromeClient;
import android.webkit.WebViewClient;
import android.provider.Settings;

public class MainActivity extends Activity {

 private WebView wv;  

//make HTML upload button work in Webview   
 private ValueCallback<Uri> mUploadMessage;  
 private final static int FILECHOOSER_RESULTCODE=1;

 @Override  
 protected void onActivityResult(int requestCode, int resultCode, Intent intent) {  
  if(requestCode==FILECHOOSER_RESULTCODE)  
  {  
   if (null == mUploadMessage) return;  
            Uri result = intent == null || resultCode != RESULT_OK ? null  
                    : intent.getData();  
            mUploadMessage.onReceiveValue(result);  
            mUploadMessage = null;        
  }  
 }  

 //Check if user is online
 public boolean isOnline() {
     ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
     NetworkInfo netInfo = cm.getActiveNetworkInfo();
     if (netInfo != null && netInfo.isConnected()) {
         return true;
     }
     return false;
 }
 //if not online show alertdialog with settings button
 public void showNoConnectionDialog(Context ctx1) {
     final Context ctx = ctx1;
     AlertDialog.Builder builder = new AlertDialog.Builder(ctx);
     builder.setCancelable(true);
     builder.setMessage(R.string.no_connection);
     builder.setTitle(R.string.no_connection_title);
     builder.setPositiveButton(R.string.settings, new DialogInterface.OnClickListener() {
         public void onClick(DialogInterface dialog, int which) {
             ctx.startActivity(new Intent(Settings.ACTION_WIRELESS_SETTINGS));
         }
     });
     builder.setNegativeButton(R.string.cancel, new DialogInterface.OnClickListener() {
         public void onClick(DialogInterface dialog, int which) {
             return;
         }
     });
     builder.setOnCancelListener(new DialogInterface.OnCancelListener() {
         public void onCancel(DialogInterface dialog) {
             return;
         }
     });
     builder.setCancelable(false);
     builder.show();
 }

 //supress lint coz it cries over javascript enabled
@SuppressLint("SetJavaScriptEnabled") @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    //if not online then show NO CONNECTION Dialog
    if(!isOnline()) {
       showNoConnectionDialog(MainActivity.this);
    }

    //webview
    wv = new WebView(this);

    //loadurl
    wv.loadUrl(getString(R.string.siteurl));

    //Enable JavaScript
    wv.getSettings().setJavaScriptEnabled(true);

    //Zoom
    wv.getSettings().setBuiltInZoomControls(true);
    wv.getSettings().setSupportZoom(true);

    //progressdialog
    final ProgressDialog pd = ProgressDialog.show(this, "", getString(R.string.loading), true);
    pd.setCanceledOnTouchOutside(false);

    wv.setWebViewClient(new WebViewClient(){
        //hide progressdialog when page loads completely
        @Override
        public void onPageFinished(WebView view, String url) {
            if(pd.isShowing() && pd!=null)
            {
            pd.dismiss();
            }
        }
    });

    wv.setWebChromeClient(new WebChromeClient()  {

        // For Android 3.0+
        public void openFileChooser( ValueCallback<Uri> uploadMsg, String acceptType ) {  
            mUploadMessage = uploadMsg;  
            Intent i = new Intent(Intent.ACTION_GET_CONTENT);  
            i.addCategory(Intent.CATEGORY_OPENABLE);  
            i.setType("image/*");  
            MainActivity.this.startActivityForResult( Intent.createChooser( i, getString(R.string.fileselect) ), MainActivity.FILECHOOSER_RESULTCODE ); 
            }

        // For Android < 3.0
        public void openFileChooser( ValueCallback<Uri> uploadMsg ) {
            openFileChooser( uploadMsg, "" );
            }

        // For Android > 4.1
        public void openFileChooser(ValueCallback<Uri> uploadMsg, String acceptType, String capture){

            openFileChooser( uploadMsg, "" );
            }        
                });
      setContentView(wv);      
  }
} 
```

**PS：**上传按钮在我的代码中工作，问题是我如何在后台保持 WebView 处于活动状态，这样如果用户开始上传并退出应用程序，上传会继续。

**更新：**我认为在这种情况下[覆盖后退按钮和通知](https://stackoverflow.com/a/3142471/1331135)可能很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T00:11:16.213

抓住后退按钮表现得像主页键

```
 @Override
 public boolean onKeyDown(int keyCode, KeyEvent event) {
     if (keyCode == KeyEvent.KEYCODE_BACK) {
         moveTaskToBack(true);
         return true;
     }
     return super.onKeyDown(keyCode, event);
 } 
```****************

# indexing - Neo4j：在密码语句中使用索引

> ID：15718247
> 
> 赞同：2
> 
> 时间：2013-03-30T11:55:25.530
> 
> 标签：indexing, neo4j, cypher

我正在努力研究如何在密码中使用索引。

在 java 中创建和索引节点后，我可以在这些节点上执行密码查询。我也可以使用 java 中创建的索引查询这些节点。

但是，当我在 cypher 语句中调用索引时，我得到一个 MissingIndexException。

那么，为什么 cypher 找不到索引呢？我必须创建一个单独的密码索引吗？（我还没有发现任何关于那个）

我正在使用 1.8.2 版本这是我所做的：

```
public class IndexTester {

String DB_PATH = "target/java-query-db";
String resultString ="";

GraphDatabaseService db = new GraphDatabaseFactory().newEmbeddedDatabase( DB_PATH );
ExecutionEngine engine = new ExecutionEngine( db );

IndexManager index = db.index();
Index<Node> personIndex;

Node n;
Node n1;

public static void main( String[] args )
{
    IndexTester indexTester = new IndexTester();
    indexTester.runIndex();
 }

public void runIndex(){

    Transaction tx = db.beginTx();
  try
  {

      personIndex = index.forNodes( "person" );

        n = createAndIndexNode("type", "adult", personIndex, db);         
        addPropertyAndIndexNode("name", "John", personIndex, n);
        addPropertyAndIndexNode("id", "1", personIndex, n);

        n1 = createAndIndexNode("type", "adult", personIndex, db);        
        addPropertyAndIndexNode("name", "Jane", personIndex, n1);
        addPropertyAndIndexNode("id", "2", personIndex, n1); 
```

//这很好用！！

```
 Node foundNode = personIndex.get("name", "John").getSingle();
        System.out.println("Found Node: " + foundNode.getProperty("name")); 
```

//这会抛出一个 MissingIndexException

```
 resultString = engine.execute( "start m=node:personIndex(name= 'John')  return m" ).toString();
            System.out.println(resultString);

      n.delete();
      n1.delete();

      tx.success();
  }
  finally   
  {
      tx.finish();
  }

}

private Node createAndIndexNode(final String property, final String name, Index<Node> nodeIndex, GraphDatabaseService db ) {
    Node node = db.createNode();
    node.setProperty(property , name);
    nodeIndex.add(node, property, name);
    return node;
}

    public Node addPropertyAndIndexNode(String property, String name, Index<Node> nodeIndex, Node node)
    {
          node.setProperty( property, name );
          nodeIndex.add( node, property, node.getProperty( property ) );
          return node;
    } 
```

}

任何想法/建议如何解决这个问题？谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T15:22:11.150

我认为您的索引的实际名称只是`person`（如此处指定：）`index.forNodes( "person" );`，而不是`personIndex`.

尝试：

```
start m=node:person(name= 'John')  return m 
```

# android - Libs 文件夹与构建路径依赖关系（ANDROID）

> ID：15718248
> 
> 赞同：0
> 
> 时间：2013-03-30T11:55:31.227
> 
> 标签：android, dependencies, libs

我有一些我的应用程序依赖的 jar 库。当我将 jar 复制并粘贴到`project/libs`文件夹中时，它会正确构建、编译和执行。

但是，如果我右键单击我的项目 -> `Build path`-> `Configure build path`-> `Libraries tab`->`Add external JARs`并添加完全相同的 jar，它仍然不会给我任何错误，它允许我构建和编译，但是当应用程序执行时它会崩溃。

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:30:26.013

如果您将 jars 放在 libs 文件夹中，它会自动将这些 JAR 添加到您的编译时构建路径中。更重要的是，它将 JAR 的内容放入您的 APK 文件中，因此它们将成为您运行时构建路径的一部分。

手动将 jar 添加到使用 lib 的构建路径将解决编译时问题，但是您的 JAR 内容不在您的 APK 中，因此您在运行时将无法使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:10:16.033

不要使用添加外部 jar 这将添加为绝对路径而不是通过添加 jar 使用相对路径，这样您必须将所有 jar 文件放入 libs 目录。

如果您使用添加外部 Jar，它将根据绝对路径搜索该 jar 文件，因此找不到该路径的设备，您将获得强制关闭。

尝试使用 Add Jar 和 Add External Jar 选项添加相同的 jar 文件。

在此处检查差异[https://stackoverflow.com/a/10679344/760489](https://stackoverflow.com/a/10679344/760489)

# entity-framework - 入门框架 4..5：查询生成器

> ID：15718254
> 
> 赞同：0
> 
> 时间：2013-03-30T11:56:14.670
> 
> 标签：entity-framework, entity

我是入门框架的新手。我正在研究 Julia Lerman 的书，但我坚持使用 Query Builder 方法。我收到以下编译错误：

```
 Error   1   'System.Data.Entity.DbSet<Chapter2ConsoleApp.Contact>' does not 
 contain a definition for 'Where' and the best extension method overload 
'System.Linq.Queryable.Where<TSource>(System.Linq.IQueryable<TSource>, 
System.Linq.Expressions.Expression<System.Func<TSource,bool>>)' has some invalid arguments  
C:\EF\ProgrammingEntityFramework\Chapter2ConsoleApp\Program.cs  59  32  
Chapter2ConsoleApp 
```

有代码。

```
using (SampleEntities context = new SampleEntities())
            {
              var contacts = context.Contacts.Where("it.FirstName = 'Robert'").OrderBy("it.LastName");
                                foreach (Contact contact in contacts)
                {
                    Console.WriteLine("{0} {1}",
                                contact.FirstName.Trim(),
                                contact.LastName);
                }
            }
            Console.Write("Press Enter...");
            Console.ReadLine();
        } 
```

带有 lambda 的 Linq to 实体可以正常工作。当我通过 IntelliSense 查看错误代码时，我可以看到有一个 Where 方法。最后，我尝试了`[(IObjectContextAdapter)]`对上下文的强制转换，但我无法获得 Contact 方法。

有人会帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T15:16:48.620

使用下面的代码（确保导入`System.Data.Entity.Infrastructure`命名空间）

```
var contacts = ((IObjectContextAdapter)context).ObjectContext.CreateObjectSet<Contact>()
                .Where("it.FirstName = 'Robert'")
                .OrderBy("it.LastName"); 
```

谢谢，金维

# c++ - “好像”规则到底是什么？

> ID：15718262
> 
> 赞同：97
> 
> 时间：2013-03-30T11:57:32.053
> 
> 标签：c++, c, optimization, c++-faq, as-if

正如标题所说：

> **[“好像”规则到底是什么？](https://en.cppreference.com/w/cpp/language/as_if)**

一个典型的答案是：

> 允许任何和所有不改变程序可观察行为的代码转换的规则

有时，我们会不断从某些实现中获取行为，这些行为归因于该规则。很多时候都错了。

那么，这个规则究竟是什么？该标准没有明确将这条规则作为一个部分或段落提及，那么究竟什么属于该规则的范围？

对我来说，这似乎是一个标准没有详细定义的灰色区域。有人可以详细说明细节，引用标准中的参考资料吗？

^(注意：将其标记为 C 和 C++，因为它与两种语言都相关。)

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-03-30T11:59:27.263

# **什么是“*好像*”规则？**

“ *as-if* ”规则基本上定义了允许实现在合法 C++ 程序上执行的转换。简而言之，所有不影响程序“*可观察行为*”的转换（具体定义见下文）都是允许的。

目标是让实现自由执行优化，只要程序的行为仍然符合 C++ 标准在抽象机器方面指定的语义。

* * *

# **标准在哪里引入了这个规则？**

C++11 标准在第 1.9/1 段中引入了“ *as-if ”规则：*

> 本国际标准中的语义描述定义了一个参数化的非确定性抽象机。本国际标准对一致性实现的结构没有要求。特别是，它们不需要复制或模仿抽象机器的结构。相反，需要符合要求的实现来模拟（仅）抽象机的**可观察行为**，如下所述。

此外，一个解释性脚注补充说：

> **该规定有时被称为“好像”规则**，因为只要从可观察的行为中可以确定，只要结果是好像已经遵守了要求，实施就可以自由地忽略本国际标准的任何要求的程序。例如，如果一个实际的实现可以推断出它的值没有被使用并且不会产生影响程序可观察行为的副作用，那么它就不需要评估表达式的一部分。

* * *

# **该规则的具体规定是什么？**

第 1.9/5 段进一步规定：

> ***执行格式良好的程序***的一致实现**应产生与具有相同程序和相同输入的抽象机的相应实例的可能执行之一相同的可观察行为**。但是，如果任何此类执行包含未定义的操作，则本国际标准对使用该输入执行该程序的实现没有要求（甚至不考虑第一个未定义操作之前的操作）。

值得强调的是，这种约束仅适用于*“执行格式良好的程序”*，并且执行包含未定义行为的程序的可能结果是不受约束的。第 1.9/4 段也明确说明了这一点：

> 本国际标准中将某些其他操作描述为未定义（例如，尝试修改 const 对象的效果）。[注：**本国际标准对包含未定义行为的程序的行为没有要求**。——尾注]

最后，关于“*可观察行为*”的定义，第 1.9/8 段如下：

> 对一致性实现的最低要求是：
> 
> — 对易失性对象的访问严格按照抽象机的规则进行评估。
> 
> — 在程序终止时，写入文件的所有数据应与根据抽象语义执行程序可能产生的结果之一相同。
> 
> — 交互式设备的输入和输出动态应以这样一种方式发生，即在程序等待输入之前实际提供提示输出。构成交互式设备的内容是实现定义的。
> 
> **这些统称为程序的可观察行为**。[*注意*：抽象和实际语义之间的更严格的对应关系可以由每个实现定义。——<em>尾注]

* * *

# **是否存在此规则不适用的情况？**

*据我所知，“ as-if* ”规则的唯一例外是复制/移动省略，即使类的复制构造函数、移动构造函数或析构函数具有副作用，也是允许的。第 12.8/31 段规定了具体条件：

> 当满足某些条件时，允许实现省略类对象的复制/移动构造，**即使为复制/移动操作选择的构造函数和/或对象的析构函数具有副作用**。[...]

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2017-09-27T19:36:09.667

在 C11 中，从不使用该名称调用该规则。然而，C 就像 C++ 一样，根据抽象机器定义行为。as-if 规则在[C11 5.1.2.3p4 和 p6](http://port70.net/%7Ensz/c/c11/n1570.html#5.1.2.3)中：

> 4.  在抽象机中，所有表达式都按照语义的规定进行评估。**如果一个实际的实现可以推断出它的值没有被使用并且没有产生所需的副作用（包括调用函数或访问易失性对象引起的任何副作用），则它不需要评估表达式的一部分。**
>     
>     
> 5.  [...]
>     
>     
> 6.  对一致性实现的最低要求是：
>     
>     
>     *   对对象的访问`volatile`严格按照抽象机的规则进行评估。
>     *   在程序终止时，写入文件的所有数据应与根据抽象语义执行程序所产生的结果相同。
>     *   The input and output dynamics of interactive devices shall take place as specified in [7.21.3](http://port70.net/%7Ensz/c/c11/n1570.html#7.21.3). The intent of these requirements is that unbuffered or line-buffered output appear as soon as possible, to ensure that prompting messages actually appear prior to a program waiting for input.
>     
>     This is the observable behavior of the program.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-05-28T13:00:32.763

In C, C++, Ada, Java, SML... in any programming language well specified by describing the (usually many possible, non-deterministic) behavior(s) of a program (exposed to series of interactions on I/O ports), **there is no distinct as-if rule**.

An example of *distinct* rule is the one that says that a division by zero raises an exception (Ada, Caml) or a null dereference raises an exception (Java). You could change the rule to specify something *else* and you would end up with a different language (that some people would rather call a "dialect"(*). *A distinct rule is there to specify some distinct uses of a programming language* like a distinct grammatical rule cover *some* syntax constructs.

(*) A dialect according to some linguists is a language with an "army". in that context, that could mean a programming language without a committee and a specific industry of compiler editors.

*The as-if rule is not a distinct rule*; it doesn't cover any program in particular and **is not even a rule that could be discussed, removed, or altered in any way**: the so called "rule" simply reiterates that program semantics is defined, and can only be portably (universally) defined, in term of the visible interactions of an execution of the program with the "external" world.

The external world can be I/O interfaces (stdio), a GUI, even an interactive interpreter that output the resulting value of a pure applicative language. In C and C++ is includes the (vaguely specified) accesses to volatile objects, which is another way of saying that some objects at given point must be represented in memory strictly according to the ABI (Application Binary Interface) without ever mentioning the ABI explicitly.

The definition of what is a **trace of execution**, also called the visible or observable behavior defines what is meant by "as-if rule". The as-if rule *tries* to explain it, but by doing so, it confuses people more than it clarifies things as it gives the expression of being an additional semantic rule giving more leeway to the implementation.

Summary:

*   The so called "as-if rule" does not relax any constraints on implementations.
*   You cannot remove the as-if rule in any programming language specified in term of visible behavior (execution traces composed for interaction with the external world) to get a distinct dialect.
*   You cannot add the as-if rule to any programming language not specified in term of visible behavior.

# iphone - Worklight App 中使用 JQuery Mobile 的内部浏览器

> ID：15718264
> 
> 赞同：0
> 
> 时间：2013-03-30T11:57:45.227
> 
> 标签：iphone, jquery-mobile, ibm-mobilefirst

我想使用内部浏览器在基于 JQueryMobile 的 Worklight 应用程序中打开网页。现在，我正在将用户从 App 推送到 iPhone 上的外部 Safari 浏览器。

我在 JQuery Mobile 方面没有太多经验。

请建议我如何实现这一目标？或者更好的解决方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:31:37.807

这与 jQuery Mobile 无关。使用[Cordova 的 InAppBrowser](http://docs.phonegap.com/en/2.3.0/cordova_inappbrowser_inappbrowser.md.html)（需要 Cordova 2.3，因此请务必使用 Worklight 5.0.6）。

# php - Zend Framework 2 与 zfc-rbac 数据库填充

> ID：15718280
> 
> 赞同：19
> 
> 时间：2013-03-30T11:59:28.010
> 
> 标签：php, zend-framework2

有许多关于如何在 Zend Framework 2 中实现 zfc-user 和 zfc-rbac 的“入门”教程。zfc-user 和 zfc-rbac 的 github 页面 ( [https://github.com/ZF-Commons](https://github.com/ZF-Commons) )很清楚，实现确实很容易（如许多教程中所述）。我还找到了 zfc-user 和 zfc-rbac (/vendor/zf-commons/zfc-[user/rbac]/data/) 所需的 SQL 方案。

在数据库中创建用户很容易，因为 zfc-user 已经为您设置好了（[http://example.com/user](http://example.com/user)）。到目前为止一切都很好。现在我想填充角色，但我不清楚如何正确填充 rbac 表。缺少这方面的信息让我感到惊讶，因为 zfc-rbac 组件是 Zend 框架的一个流行模块。

我了解基于角色的访问控制的原理，并且权限表的填充以及将权限和角色链接在一起的表很清楚，我不清楚的是角色表。我知道您可以拥有一个具有父角色的角色，但不清楚如何使用父角色填充表，因为有一个外键约束指出“parent_role_id”必须是“role_id”。

下面是角色表的 SQL（这是 zfc-rbac 提供的 SQL）：

```
CREATE TABLE `rbac_role` (
  `role_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `parent_role_id` int(11) unsigned NOT NULL,
  `role_name` varchar(32) NULL,
  PRIMARY KEY (`role_id`),
  KEY `parent_role_id` (`parent_role_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

ALTER TABLE `rbac_role`
  ADD CONSTRAINT `rbac_role_ibfk_1` FOREIGN KEY (`parent_role_id`) REFERENCES `rbac_role` (`role_id`); 
```

使用外键添加父角色似乎是不可能的？

```
INSERT INTO `rbac_role` (parent_role_id, role_name) VALUES (NULL, 'admin'); 
```

基本上我的问题是（我觉得问这个很愚蠢）但是插入父角色的样子如何？如果我提出的插入语句实际上是正确的，我是否总是需要在插入父角色之前删除外键？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-19T06:04:09.137

仅供参考：此问题已修复。zfc-rbac 0.2.0 版将允许 NULL 值作为 parent_role_id

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-25T16:46:20.137

将您的创建表更改为以下内容：

```
CREATE TABLE `rbac_role` (
    `role_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
    `parent_role_id` int(11) unsigned NULL,
    `role_name` varchar(32) NULL,
    PRIMARY KEY (`role_id`),
    KEY `parent_role_id` (`parent_role_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1; 
```

注意 parent_role_id 是 NULL 而不是 NOT NULL。如果 parent_role_id 不是 NULL 则意味着它必须有一个父级，但由于外键引用是同一个表，所以无法插入父行！

# xml - 使用批处理解析 XML 文件以从某些特定节点获取值

> ID：15718281
> 
> 赞同：1
> 
> 时间：2013-03-30T11:59:56.423
> 
> 标签：xml, batch-file

对于`Lists`作为其父节点的每个节点列表，我想获取/保存到前三个节点的变量值中，`entry`即`output`和`token`。我知道如何使用 vbscript 来做到这一点，但对我来说批量解决方案更有趣。请问，可以吗？

```
 <list1>
      <entry>myEntry</entry>
      <output>myOut</output>
      <token>4</token>
              <status>1</status>          
              <number>6</number>
      <!-- Comments -->       
       </list1>

     <list2>
      <entry>newEntry</entry>
      <output>thisOutput</output>
      <token>1</token>
              <status>0</status>          
              <number>1</number>
      <!-- Comments -->       
     </list2>

             <list3>
      <!-- repeat nodes as before -->         
     </list3> 
```

任何帮助！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:45:45.850

```
@ECHO OFF
SETLOCAL
CALL :zapvars
FOR /f "tokens=2,3delims=<>" %%i  IN (myxml.xml) DO (
CALL :analyse %%i
IF DEFINED tlist   SET   list=%%i
IF DEFINED tentry  SET  entry=%%j
IF DEFINED ttoken  SET  token=%%j
IF DEFINED toutput SET output=%%j
)

GOTO :eof

:analyse
FOR %%a IN (tlist tentry ttoken toutput) DO (SET %%a=)
ECHO %1|FINDSTR /b "list" >NUL
IF NOT ERRORLEVEL 1 SET tlist=Y&GOTO :EOF 
IF "%1"=="entry" SET tentry=Y&GOTO :EOF 
IF "%1"=="output" SET toutput=Y&GOTO :EOF 
IF "%1"=="token" SET ttoken=Y&GOTO :EOF 
IF NOT "%1"=="/%list%" GOTO :EOF 
:: Found end of list
ECHO list=%list% entry=%entry% output=%output% token=%token%
:zapvars
FOR %%z IN (list entry output token) DO (SET %%z=)
GOTO :eof 
```

真的没那么难。问题是一旦它在环境变量中你想用它做什么。显然，如果你想检查缺失的元素，你需要做的就是只使用结果`if defined list if defined entry if defined output if defined token`

给定输入格式，每行都使用`<`和标记化`>`。第一个选定的标记应用于 ，`%%i`第二个应用于`%%j`。行中的第一个标记是前导空格。

因此 %%i 将是节点名称。对于每一行，节点名称被传递给子例程 :analysis for er, analysis。

:analysis 首先清除每个标志 t`name`表示`token is a`名称`. First cab off the rank is to see whether the token starts`列表`, so the token is`ECHO `ed into`FINDSTR `which looks for a line beginning (`/b`) "list"。如果 findstring 找到它要查找的内容，则 ERRORLEVEL 设置为 0，否则设置为非零。

如果 errorlevel 不是`1 or greater`，则`TLIST`设置为`Y`它可以设置为任何值 - 只要它设置为 SOMETHING。然后子程序退出。

如果它不是一个令牌开始，`list`那么`:analyse`每个目标令牌都会丢失。如果它找到一个，它会设置适当的标志。

最后，如果令牌不是，`/LISTNAMEBEINGPROCESSED`则例程退出。如果`/list...`找到 IS，则显示值标记然后清除。

同时，回到`FOR`循环中，在调用`:analyse`之后，例程的决定最多包含在环境中的 ( `tlist`, `tentry`, `ttoken`, `toutput`) 中的一个中 ( , , , )。如果设置了 tname，则从适当的元变量中分配相应的值标记`%%i`- 如果`tlist`设置了列表名称，并且`%%j`- 其他的数据项。对于不感兴趣的节点，不返回任何标志，`:analyse`因此`FOR`循环简单地进行到下一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T03:03:04.813

下面的批处理文件获取/保存所需节点的值并为每个父节点处理它们。该方法只需在程序中更改一行即可修改处理节点的数量和名称，并且不使用任何外部命令（*.exe文件）或`call`命令，因此速度快。

```
@echo off
setlocal EnableDelayedExpansion
rem Define the names of the desired nodes
set nodes=entry output token
rem Process file lines and get first two tokens separated by <> (ie: %%a=entry, %%b=myEntry)
for /F "tokens=2-3 delims=<>" %%a in (theXMLfile.xml) do (
   set "node=%%a"
   rem If this node is not the end of this record...
   if "!node:~0,5!" neq "/list" (
      rem If this node is one of the desired ones...
      if "!nodes:%%a=!" neq "%nodes%" (
         rem Assign this node into a variable of same name (ie: set entry=myEntry)
         set "%%a=%%b"
      )
   ) else (
      rem ListX node complete: process it, for example:
      ECHO call another.bat !entry! !output! !token!
   )
) 
```

但是，如果输入文件非常大，对*每条*`call`记录执行的命令可能会使程序耗时过长。允许程序运行得更快的修改是将*所有节点*存储在数组中，而不是单个变量，然后将父节点的数量传递给只调用一次的子例程。

 **```
@echo off
setlocal EnableDelayedExpansion
rem Define the names of the desired nodes
set nodes=entry output token
rem Define the index of the next array element
set index=1
rem Process file lines and get first two tokens separated by <> (ie: %%a=entry, %%b=myEntry)
for /F "tokens=2-3 delims=<>" %%a in (theXMLfile.xml) do (
   set "node=%%a"
   rem If this node is not the end of this record...
   if "!node:~0,5!" neq "/list" (
      rem If this node is one of the desired ones...
      if "!nodes:%%a=!" neq "%nodes%" (
         rem Assign this node into THE CURRENT ELEMENT OF AN ARRAY variable of same name (ie: set entry[!index!]=myEntry)
         set "%%a[!index!]=%%b"
      )
   ) else (
      rem ListX node complete: pass to next element of arrays
      set /A index+=1
   )
)
rem Call the subroutine and pass as parameter the number of parent listX nodes
set /A number=index-1
call :anotherSub %number%
goto :EOF

:anotherSub numberOfNodes
rem Process all nodes, for example:
for /L %%i in (1,1,%1) do (
   echo !entry[%%i]! !output[%%i]! !token[%%i]!
)
exit /B 
```

安东尼奥**

# css - 带有折纸适应的chrome css过渡闪烁

> ID：15718283
> 
> 赞同：1
> 
> 时间：2013-03-30T11:59:59.740
> 
> 标签：css, transform, css-transitions

我正在尝试改编最近流行的折纸动画......基本上通过一个没有透视的元素来扩展它，并且只是不倾斜地移动。

[http://jsfiddle.net/nicib83/dhrxU/1/](http://jsfiddle.net/nicib83/dhrxU/1/)

要排除底部面板，请注释掉第 22 行

```
$(existing[existing.length-1]).append($('<div class="panel panel-bottom"></div>')); 
```

但是在 chrome 中，我有一个白色闪烁，这是背景色底部面板的结果。

我真的很想了解底部面板似乎出现在上面的原因

谢谢

# windows - EN_UPDATE 不发送到子类编辑框过程

> ID：15718296
> 
> 赞同：0
> 
> 时间：2013-03-30T12:02:28.930
> 
> 标签：windows, winapi

我对编辑控制窗口过程进行了子类化，然后发现它不再发送 EN_UPDATE。

我错过了什么，有人可以建议我解决这个问题吗？

```
LRESULT CALLBACK EditBoxProc_textbox3( HWND hwnd, UINT message , WPARAM wParam, LPARAM lParam )
{
  int previous_position = 0 ;
  WCHAR previous_text [1024];
  WCHAR current_text [1024];

  switch (message)
  {

    case WM_CREATE:
       previous_text[0] = L'\0';
       current_text[0] = L'\0';
       break;

    case EN_SETFOCUS:
      // :TODO: read the current text of the textbox3 and update textbox2 
      // text according to it.                                             //
      Edit_Enable(hwndTextBox2,FALSE);
      break;

    case EN_UPDATE:
      MessageBox(NULL,L"EN_UPDATE", lpszAppName,MB_OK);
      GetWindowText( hwndTextBox3,  current_text ,1024);
      if( is_valid_textbox3(current_text))
      {
        wcscpy(previous_text,current_text);
        previous_position = LOWORD(Edit_GetSel(hwndTextBox3));
        update_textbox2(NULL);

      }else
      {
        SetWindowText(hwndTextBox3, previous_text );
        Edit_SetSel(hwndTextBox3,previous_position, previous_position);
      }  
      break;

    case EN_KILLFOCUS:
      Edit_Enable(hwndTextBox2,TRUE);
      break;
    default:
      break;
  }
  return CallWindowProc(edit_old_wndproc_textbox3,hwnd,message,\
           wParam,lParam);
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T14:25:32.790

> 然后发现它不再发送 EN_UPDATE

它从来没有发送过 EN_UPDATE。它是实际作为 WM_COMMAND 消息发送的通知消息。它被发送到 Edit 控件的父级，而不是控件本身。EN_SET/KILLFOCUS 也是如此。

The design philosophy here is that an Edit control can simply be put on, say, a dialog. And the custom code that makes the dialog behave in a certain way is written in the parent window's procedure with no requirement to subclass the control. Which is fine but it makes it difficult to create a customized edit control that can have its own behavior. Or in other words, it makes it hard to componentize an edit control. The EN_SET/KILLFOCUS notifications are not a problem, you can simple detect their corresponding WM_SET/KILLFOCUS messages. But you'll hit the wall on EN_UPDATE, the control doesn't send any message like that to itself. Only the parent window can detect it.

Componentizing an edit control is pretty desirable and actively pursued by object-oriented class libraries like Winforms and Qt. They have a class wrapper for the control (TextBox, QLineEdit) that has a virtual method that can be overridden (OnTextChanged, changeEvent) so that the control can be customized into a derived class with its own behavior. And generate an event (aka signal) that anybody can subscribe to, not just the parent (TextChanged, textChanged). To make that work, the parent window needs to participate. When it gets the WM_COMMAND message, it must echo the notification back to the child control. Either by sending a special message back or by calling a virtual method on the child class.

You can of course implement this yourself as well, albeit that you are liable of reinventing such a class library. Consider using an existing one instead.

# c++ - atoi(argv[1]) 的结果是什么？

> ID：15718299
> 
> 赞同：2
> 
> 时间：2013-03-30T12:03:09.200
> 
> 标签：c++

我只想知道这些线实际上做了什么。

```
int main(int argc, char *argv[]) 
```

尤其是这个：

```
int n = atoi (argv[1]); 
```

我在一本书中读到这一点，但我无法理解这些行。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-30T12:04:48.277

这会将第一个命令行参数转换为整数。例如，如果你这样调用你的程序

```
./a.out 123 
```

然后`n`会`123`。

请注意，在访问之前`argv[1]`必须检查`argc`是否大于`1`，即检查是否已在命令行上将至少一个参数传递给您的程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:07:09.027

argc 是参数的计数。argv 是参数变量的缩写。它将包含命令行上传递的所有参数。argv[1] 包含第一个参数，因此 atoi(argv[1]) 会将第一个参数转换为 int

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-31T06:43:58.097

```
int main(int argc, char *argv[]) 
```

The first parameter to main, argc, is the number of command line arguments. For example, if the user enters:

`./a.out 5 6 7`

`argc` will be `4` **(a.out counts as one of the command line arguments, and 5, 6, and 7 as three more).**

`argv` is an array of strings):

```
 -----
argv[0]:| *-|"./a.out"
        -----
argv[1]:| *-| "5"
        -----
argv[2]:| *-| "6"
        -----
argv[3]:| *-| "7"
        -----
argv[4]:| *-| "\0"
        ----- 
```

`atoi()` functionconverts string data type to int data type. since commandline arguments `(argv[])` can only take `strings`, you need to convert that string`into`arithmetic numbers`in order to use it as such. The`atoi` (alphabetical to integer) does that for you where it takes in any **string and converts the numbers inside the string into arithmetic numbers.**

# ef-code-first - 如何以编程方式读取 EF DbContext 元数据？

> ID：15718301
> 
> 赞同：18
> 
> 时间：2013-03-30T12:03:12.167
> 
> 标签：ef-code-first, metadata, entity-framework-5

我有使用 EF-CodeFirst 5 的应用程序（dll 版本 4.4.0.0，在 .net 4.0 上）。

我需要能够读取实体元数据，以便对于给定的条目类型，我可以获得以下信息：

*   哪些属性是一对多关系（引用实体）
*   哪些属性是多对一关系（引用当前实体的集合）
*   也不错但不是绝对必要的：哪些属性是多对多关系（关系集合）

我可以通过在属性列表上编写 foreach 循环然后通过依赖所有虚拟引用来“识别”它们来获取此信息，但我觉得这不是“正确”的方式。我知道`EdmxWriter`可以以 xml 格式提供该信息，但它是通过访问不可公开访问的 InternalContext 来实现的，我想直接获取强类型列表/数组，而不使用该 xml。我应该使用哪个 API（如果有的话，我似乎找不到它）？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-30T15:37:44.360

Gorane，这应该让你开始......
（我没有玩太多 - 它需要在调试器中进行一些试验才能查看哪些属性/信息以及如何获取它）

```
using (var db = new MyDbContext())
{
    var objectContext = ((IObjectContextAdapter)db).ObjectContext;
    var container = objectContext.MetadataWorkspace.GetEntityContainer(objectContext.DefaultContainerName, DataSpace.CSpace);
    foreach (var set in container.BaseEntitySets)
    {
        // set.ElementType.
        foreach (var metaproperty in set.MetadataProperties)
        {
            // metaproperty.
        }
    }

    // ...or... 

    var keyName = objectContext
        .MetadataWorkspace
        .GetEntityContainer(objectContext.DefaultContainerName, DataSpace.CSpace)
        .BaseEntitySets
        .First(meta => meta.ElementType.Name == "Question")
        .ElementType
        .KeyMembers
        .Select(k => k.Name)
        .FirstOrDefault();
} 
```

更具体地说...

```
foreach (var set in container.BaseEntitySets)
{
    var dependents = ((EntitySet)(set)).ForeignKeyDependents;
    var principals = ((EntitySet)(set)).ForeignKeyPrincipals;
    var navigationProperties = ((EntityType)(set.ElementType)).NavigationProperties;
    foreach (var nav in navigationProperties)
    {
        // nav.RelationshipType;
    }
} 
```

其中一些属性似乎没有向“公众”公开，因此您需要使用反射 - 或找到一些更聪明的方法 - 但其中包含大量信息。

* * *

* * *

这些链接中还有更多信息......

[如何在 EF4 中获取实体的第一个 EntityKey 名称](https://stackoverflow.com/questions/3341690/how-to-get-first-entitykey-name-for-an-entity-in-ef4)

[如何为 EF4 实体上的属性提取数据库表和列名？](https://stackoverflow.com/questions/5313008/how-can-i-extract-the-database-table-and-column-name-for-a-property-on-an-ef4-en)

* * *

**编辑**：使用您的 navigationProperties 列表作为起点，我得到了我需要的一切：

```
 ManyToManyReferences = navigationProperties.Where(np =>
            np.FromEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many &&
            np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many)
            .Select(np => Extensions.CreateLambdaExpression<TEntity>(np.Name))
            .ToList();

        OneToManyReferences = navigationProperties.Where(np =>
            (np.FromEndMember.RelationshipMultiplicity == RelationshipMultiplicity.One ||
            np.FromEndMember.RelationshipMultiplicity == RelationshipMultiplicity.ZeroOrOne) &&
            np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many)
            .Select(np => Extensions.CreateLambdaExpression<TEntity>(np.Name))
            .ToList();

        ManyToOneReferences = navigationProperties.Where(np =>
            np.FromEndMember.RelationshipMultiplicity == RelationshipMultiplicity.Many &&
            (np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.One ||
            np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.ZeroOrOne))
            .Select(np => Extensions.CreateLambdaExpression<TEntity>(np.Name))
            .ToList();

        OneToOneReferences = navigationProperties.Where(np =>
            np.FromEndMember.RelationshipMultiplicity == RelationshipMultiplicity.One &&
            np.ToEndMember.RelationshipMultiplicity == RelationshipMultiplicity.One)
            .Select(np => Extensions.CreateLambdaExpression<TEntity>(np.Name))
            .ToList(); 
```

CreateLambdaExpression 方法不是我的礼貌，归功于 Jon Skeet，代码是在[这个答案的帮助下创建的](https://stackoverflow.com/a/7246796/408643)

这是我的 CreateLambdaExpression 方法：

```
public static Expression<Func<TEntity, object>> CreateLambdaExpression<TEntity>(string propertyName)
{
    ParameterExpression parameter = Expression.Parameter(typeof (TEntity), typeof (TEntity).Name);
    Expression property = Expression.Property(parameter, propertyName);

    return Expression.Lambda<Func<TEntity, object>>(property, new[] {parameter});
} 
```

# php - 在 PHP while 循环中获取#hashtag 推文计数

> ID：15718302
> 
> 赞同：0
> 
> 时间：2013-03-30T12:03:20.407
> 
> 标签：php, javascript, jquery, hashtag

我正在创建 twitter #hashtag 搜索的 Web 应用程序，我想在其中集成以下代码。

[https://github.com/henrahmagix/tweetCount/blob/master/total_tweets.html](https://github.com/henrahmagix/tweetCount/blob/master/total_tweets.html)

（注意：只需复制/粘贴以上代码即可获得演示）

上面的链接包含用于获取任何搜索的推文数量的代码（对标签趋势很有用）。

以下是我的代码：

```
<table width="100%">
        <tr>
            <th>#Hashtag</th>
            <th>Description</th>
            <th>Tags</th>           
            <th>Participants</th>
        </tr>

        <?php
        $i = 1;
        $j = 1;
        while ($row = mysqli_fetch_array($result)):            
            ?>

            <tr>                            
                <td class="hashtd"><a href="#"><?php echo "#" . $row['hashtag']; ?></a></td>
                <td class="hashtd"><?php echo $row['description']; ?></td>
                <td class="hashtd"><a href="<?php echo $row['id']; ?>" role="button" data-toggle="modal" class="show_modal_box">Show</a></td>
                <td class="hashtd">                                    
                    <script type="text/javascript">
                        submitTerms("<?php echo $row['hashtag']; ?>","1","0");
                    </script>
                    <div id="totalTweets">Total tweets: <span></span></div>
                    <div id="loading">Loading!</div>
                    <div id="pagesDone">Pages done: <span></span></div>
                </td>
            </tr>

            <?php
            $i++;
            $j++;
        endwhile;
    ?>
</table> 
```

在这里，我为此使用了 tweetCount 脚本：

```
 <td class="hashtd">                                    
                    <script type="text/javascript">
                        submitTerms("<?php echo $row['hashtag']; ?>","1","0");
                    </script>
                    <div id="totalTweets">Total tweets: <span></span></div>
                    <div id="loading">Loading!</div>
                    <div id="pagesDone">Pages done: <span></span></div>
                </td> 
```

在 tweetCount 脚本中，他们使用表单并在提交表单并从中获取 tweetcount 结果后搜索一个关键字`http://search.twitter.com/search.json?q=`

但是我想在页面加载时调用它，这就是为什么我调用该`submitTerms()`函数来获取实时推文计数。因为我在 while 循环中调用脚本，所以我不能将“id”用于 totalTweet、loading 和 pagesDone div 标签。我尝试在那里添加“类”，但最终导致所有不正确的主题标签的推文计数相同。

希望你能得到这个。需要帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T00:28:41.907

我建议您分叉 total_tweets.html 并对 JS 代码进行一些修改。这样你可以传递一个参数来指定你想要定位的#id div。

```
// total_tweets function
function getTweets(search, page, pageTotal, **hashtag**) {
  $.getJSON( url + search + '&page=' + page + '&callback=?',
    function(data) {
      if( data.results.length != 0 && page != pageTotal ) {
        $('#pagesDone'** + hashtag + **' span').html(page);
        getData(data);
      }
      else {
        showTotal(**hashtag**);
      }
    }
  );
}

function showTotal(**hashtag**) {
  $('#totalTweets'** + hashtag + **' span').html(beforeCounter + totalTweets + afterCounter);
  $('#pagesDone'** + hashtag + **' span').html('0');
  totalTweets = 0;
  loading = false;
}

function submitTerms(**hashtag**) {
  $('#totalTweets'** + hashtag + **' span').html('');
  $('#pagesDone'** + hashtag + **' span').html('0');
  search = encodeURIComponent($('#query').prop('value'));
  page = $('#startPage').prop('value');
  pageTotal = $('#pageTotal').prop('value');
  if( search == '' ) {
    alert('Please enter search query');
    return;
  }
  if( page == 0 ) {
    alert('0 not allowed as start page');
    return;
  }
  loading = true;
  getTweets(search, page, pageTotal, **hashtag**);
} 
```

然后在您的 php 文件中，您将调用它：

```
<td class="hashtd">                                    
    <script type="text/javascript">
        **submitTerms("<?php echo $row['hashtag']; ?>");**
    </script>
    <div id="totalTweets<?php echo $row['hashtag'];">Total tweets: <span></span></div>
    <div id="loading<?php echo $row['hashtag'];">Loading!</div>
    <div id="pagesDone<?php echo $row['hashtag'];">Pages done: <span></span></div>
</td> 
```

# opencv - 从 X 射线图像中提取手骨

> ID：15718306
> 
> 赞同：8
> 
> 时间：2013-03-30T12:03:56.757
> 
> 标签：opencv, image-processing, image-segmentation

我有一只手的 X 射线图像。我需要自动提取骨骼。我可以使用不同的技术轻松分割一只手。但是我需要得到骨头并且使用这些技术没有帮助。有些骨头比其他骨头更亮，所以如果我使用阈值，它们中的一些会消失，而另一些会变得更清晰，上升阈值。我想也许我应该只限制手的一个区域？是否可以对不是正方形的 ROI 设置阈值？O也许你有任何其他的解决方案，建议？也许有一些像 OpenCV 这样的库或类似的库？任何帮助都会非常棒！

**扩展：**

![原始图像](../Images/8a66f959252ca6dbfe34ad11ce2da79b.png) ![预期产出](../Images/d2b706ee8c352c822ba7bd05a0a6a06b.png)

                 **原始图像**                      **预期输出**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-31T03:40:15.690

一种方法是从图像中**分割手和手指**：

![在此处输入图像描述](../Images/b018f811b2b3aa6c7ed2fed7e3c8ae84.png)

**然后仅使用手部轮廓**创建另一个图像：

![在此处输入图像描述](../Images/5b5dc9aec1f2db566931e57d5ae87d1a.png)

一旦你有了轮廓，你就可以侵蚀图像以使其更小。这用于从***手和手指*****图像中****减去手***，得到手指：*

 *![在此处输入图像描述](../Images/0a7ef7303d32af2e57639a82c61bef09.png)

下面的代码显示了执行这种方法：

```
void detect_hand_and_fingers(cv::Mat& src);
void detect_hand_silhoutte(cv::Mat& src);

int main(int argc, char* argv[])
{
    cv::Mat img = cv::imread(argv[1]);
    if (img.empty())
    {
        std::cout << "!!! imread() failed to open target image" << std::endl;
        return -1;        
    }

    // Convert RGB Mat to GRAY
    cv::Mat gray;
    cv::cvtColor(img, gray, CV_BGR2GRAY);
    cv::Mat gray_silhouette = gray.clone();

    /* Isolate Hand + Fingers */

    detect_hand_and_fingers(gray);
    cv::imshow("Hand+Fingers", gray);
    cv::imwrite("hand_fingers.png", gray);

    /* Isolate Hand Sillhoute and subtract it from the other image (Hand+Fingers) */

    detect_hand_silhoutte(gray_silhouette);
    cv::imshow("Hand", gray_silhouette);
    cv::imwrite("hand_silhoutte.png", gray_silhouette);

    /* Subtract Hand Silhoutte from Hand+Fingers so we get only Fingers */

    cv::Mat fingers =  gray - gray_silhouette;
    cv::imshow("Fingers", fingers);
    cv::imwrite("fingers_only.png", fingers);
    cv::waitKey(0);

    return 0;
}

void detect_hand_and_fingers(cv::Mat& src)
{        
    cv::Mat kernel = cv::getStructuringElement(cv::MORPH_ELLIPSE, cv::Size(3,3), cv::Point(1,1));
    cv::morphologyEx(src, src, cv::MORPH_ELLIPSE, kernel);    

    int adaptiveMethod = CV_ADAPTIVE_THRESH_GAUSSIAN_C; // CV_ADAPTIVE_THRESH_MEAN_C, CV_ADAPTIVE_THRESH_GAUSSIAN_C
    cv::adaptiveThreshold(src, src, 255, 
                          adaptiveMethod, CV_THRESH_BINARY, 
                          9, -5);

    int dilate_sz = 1;
    cv::Mat element = cv::getStructuringElement(cv::MORPH_ELLIPSE,
                                       cv::Size(2*dilate_sz, 2*dilate_sz),
                                       cv::Point(dilate_sz, dilate_sz) );
    cv::dilate(src, src, element);
}

void detect_hand_silhoutte(cv::Mat& src)
{
    cv::Mat kernel = cv::getStructuringElement(cv::MORPH_ELLIPSE, cv::Size(7, 7), cv::Point(3, 3));
    cv::morphologyEx(src, src, cv::MORPH_ELLIPSE, kernel);        

    int adaptiveMethod = CV_ADAPTIVE_THRESH_MEAN_C; // CV_ADAPTIVE_THRESH_MEAN_C, CV_ADAPTIVE_THRESH_GAUSSIAN_C
    cv::adaptiveThreshold(src, src, 255, 
                          adaptiveMethod, CV_THRESH_BINARY, 
                          251, 5); // 251, 5

    int erode_sz = 5;
    cv::Mat element = cv::getStructuringElement(cv::MORPH_ELLIPSE,
                                       cv::Size(2*erode_sz + 1, 2*erode_sz+1),
                                       cv::Point(erode_sz, erode_sz) );
    cv::erode(src, src, element);

    int dilate_sz = 1;
    element = cv::getStructuringElement(cv::MORPH_ELLIPSE,
                                       cv::Size(2*dilate_sz + 1, 2*dilate_sz+1),
                                       cv::Point(dilate_sz, dilate_sz) );
    cv::dilate(src, src, element);

    cv::bitwise_not(src, src);
} 
```*

# javascript - underscorejs unique does not work

> ID：15718307
> 
> 赞同：3
> 
> 时间：2013-03-30T12:04:09.580
> 
> 标签：javascript, underscore.js

I am trying to use the underscore unique function, but could not get it to work, here is my test code:

```
var foo = [ { "a" : "1" }, { "b" : "2" }, { "a" : "1" } ];

_.unique(foo,  function(item, k, v){
    return item.a;
});
console.log(foo);

_.unique(foo, 'a');
console.log(foo); 
```

As refered here: [Removing duplicate objects with Underscore for Javascript](https://stackoverflow.com/questions/9923890/removing-duplicate-objects-with-underscore-for-javascript), and the test code is here: [http://jsfiddle.net/bingjie2680/wDvpM/2/](http://jsfiddle.net/bingjie2680/wDvpM/2/), both prints out three objects. I could not figure out the problem, can anybody help? thanks a lot.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-30T12:16:35.580

`uniq` returns a new array. And the function doesn't seem to like it when you omit the second argument.

This works :

```
var foo2 = _.unique(foo, false, function(item, k, v){
    return item.a;
}); 
```

[Demonstration](http://jsfiddle.net/syHam/)

# data-structures - Why big O for this equation is n cube?

> ID：15718309
> 
> 赞同：-4
> 
> 时间：2013-03-30T12:04:26.710
> 
> 标签：data-structures

I have this question about why the big O for this equation is n cube ?

```
else if(key == 'x')
   C = matrixMult(A, B); 
```

Thanks very much

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:09:51.190

The resulting matrix has n^2 entries. The computation of each entry can be done by a sum of n products, yielding n^3.

This is only valid for the textbook algorithm, as there exist faster algorithms, e.g. [Strassen's algorithm](https://en.wikipedia.org/wiki/Strassen_algorithm) or [the fastest known algorithm](https://en.wikipedia.org/wiki/Coppersmith%E2%80%93Winograd_algorithm).

# javascript - 始终在 div 内定位固定元素

> ID：15718310
> 
> 赞同：2
> 
> 时间：2013-03-30T12:04:39.493
> 
> 标签：javascript, css, html, css-position

我需要能够始终在 div 内定位固定元素。调整窗口大小时出现问题。然后固定的 div 总是浮动在所有其他元素之上。如何防止这种情况？我需要固定该 div 但位于 div 内。

这是一个例子：

```
<div id="main">
    <div id="one" style="background-color:yellow;"></div>
    <div id="two" style="background-color:black;"></div>
    <div id="three" style="background-color:yellow;">
        <div id="four"></div>
    </div>
</div> 
```

CSS：

```
#main
{
    position:relative;
    width:1200px;
    top:0;
    bottom:0;
    left:100px;
}
#one,#two,#three
{
    position:relative;
    width:100px;
    height:1000px;
    float:left;
    top:0;
    bottom:0;
}
#four
{
    position:fixed;
    top:50px;
    background-color:blue;
    width:100px;
    height:200px;
} 
```

[示例](http://jsfiddle.net/Zjk74/)尝试左右移动水平滚动条，您将看到发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:07:24.617

将位置更改为相对。

**例子**

```
#four {
    background-color: blue;
    height: 200px;
    position: relative;
    top: 50px;
    width: 100px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:12:06.577

在类似问题上查看[此答案](https://stackoverflow.com/questions/14274841/css-position-fixed-for-horizontal-scroll-but-scroll-vertically)。不幸的是，您面临的问题是仅靠 CSS 无法解决的问题。

# css - 即使不是所有浏览器都支持 CSS3，使用它是否理想？

> ID：15718312
> 
> 赞同：0
> 
> 时间：2013-03-30T12:04:43.173
> 
> 标签：css

我今天开始了一个新的 web 项目，从未使用过 CSS3（一直使用 CSS 2，但 1.5 年没有做过 web 开发）我决定在这个项目中使用它。

直截了当，我遇到了问题。我尝试实现线性渐变，发现它需要 6 种不同浏览器的实现——包括最新的浏览器。

现在开始使用 CSS3 项目还为时过早吗，看起来代码太臃肿了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:05:51.670

当然，如果您希望您的页面在每个浏览器中看起来都完全相同，您只需要做出决定（提示：[您不需要](http://dowebsitesneedtolookexactlythesameineverybrowser.com/)）。您可以在此处查看对 CSS3 功能的支持：http: [//html5please.com/](http://html5please.com/)。

您还可以尝试使用[SASS](http://sass-lang.com/)或[LESS](http://lesscss.org/)和函数为您抽象出双/三/六元组实现。

# c++ - 在 C++ 中使用 fread 时出现双重释放或损坏错误

> ID：15718315
> 
> 赞同：0
> 
> 时间：2013-03-30T12:04:52.163
> 
> 标签：c++, fwrite, fread

所以基本上我正在编写一个测试程序，看看我是否可以分别使用 fwrite 和 fread 将队列向量写入和读取到二进制文件中。即使读取和写入部分正确完成并且值正确，我也会收到双重释放或损坏错误。测试代码如下

```
#include <stdio.h>
#include <vector>
#include <queue>

int main(){

vector<queue<unsigned> > hello(17);
vector<queue<unsigned> > here(17);
queue<unsigned> temp;
for(int f=0;f<4;f++){//initialise a random queue
    temp.push(f);
}
for(int i=0;i<hello.size();i++){//assign random queue to every index of vector
    hello[i]= temp;
}
FILE *fo;
fo = fopen("hello","wb");
fwrite(&hello[0],sizeof(queue<unsigned>),hello.size(),fo);
fclose(fo);
printf("Writing done!\n");

FILE *fi;
fi=fopen("hello","rb");
fread(&here[0],sizeof(queue<unsigned>),here.size(),fi);
fclose(fi);
printf("Reading done!\n");
for(int i=0;i<here.size();i++){
    printf("At key %d value at front is is %d",i,here[i].front());
    here[i].pop();
    printf(" value %d ",here[i].front());
    here[i].pop();
    printf(" value %d\n",here[i].front());
}
} 
```

错误似乎是在执行 fread 操作时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:10:08.403

fread 和 fwrite 将原始指针作为第一个参数。在每种情况下，您传入的是队列的地址（队列向量中的第一个元素命名`hello`和队列向量的第一个元素命名为`here`.

What you are writing is the actual queue classes themselves, i.e. the class that contains the queue of elements you want to write. Depending on the implementation of queue, you could be writing anything (or not!). For example, if the queue class contains a pointer pointing to an array of elements, you are writing the value of a pointer, but not the elements themselves.

I would recommend serializing ([Is it possible to serialize and deserialize a class in C++?](https://stackoverflow.com/questions/234724/is-it-possible-to-serialize-and-deserialize-a-class-in-c)) and deserializing your vector of queues.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:15:31.247

What you are doing is essentially equivalent to

```
memcpy(&here[0], &hello[0], sizeof(queue<unsigned>)*here.size()); 
```

So you are making a (shallow) copy of the internal representation of the queues, which includes some pointers. In the destructors of the queues, both the original and the copy try to free the same area of memory. This results in the double free.

The bottom line is: you can't just do a plain shallow `memcpy` of structures which store pointers and expect it to work.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T18:33:34.797

You are copying queues as if they where contiguous in memory, and they aren't. Using fwrite, you **must** copy element by element, because as @reima said, at background you are using *memcpy*.

Best regards.

# javascript - prototype on single instances of functions

> ID：15718319
> 
> 赞同：0
> 
> 时间：2013-03-30T12:05:25.927
> 
> 标签：javascript, oop

If I know that I only will create one instance of the `MyClass` function below, which of my two snippets below would you prefer? Should I stick with the latter, even though I know that I'll only create one instance of the function?

I know that `prototype` is useful from a performance perspective when sharing methods across all instances of a function, but in this case I would like to hear your input.

```
var MyClass = (function () {

    var cls = function () { };

    cls.prototype = {

        init: function(data){

        }
    };

    return cls;
})(); 
```

vs

```
var MyClass = (function () {

    var cls = function () { 

        this.init = function(data){

        }
    };

    return cls;
})(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:07:28.850

~~Your second code snippet is a syntax error, you're trying to put a property initializer where a statement is expected.~~ *(Not anymore)*

If you're only going to have a single object that you need the `init` function on, then:

```
var MyObject = {
    init: function(data) {
        // ...
    }
}; 
```

Then you don't even need to call a function to create it, it's already there.

If you want to have truly private variables and such (which I assume is the reason for your outer anonymous functions), then:

```
var MyObject = (function() {
    var trulyPrivateDataHere;

    return {
        init: function(data) {
            // ...
        }
    };
})(); 
```

I prefer this because it's clear and direct: You're creating the actual object. I don't see any need for a constructor function if you're only ever going to create a single instance.

But if it *has* to be a constructor function, I guess I'd *very marginally* prefer your second option, because it's simpler, and simple is good barring the need for complexity.

# jquery - jQuery dataTables 没有加载到单个 div 上？

> ID：15718328
> 
> 赞同：0
> 
> 时间：2013-03-30T12:06:44.940
> 
> 标签：jquery, datatables, jquery-datatables

我有一个 div 和三个按钮。基于按钮单击，数据表中的列会发生变化。这是我的代码

```
 $('#impfamilydatatable').dataTable({
    "aaSorting": [[ 1, "desc" ]],
    "bDestroy": true,
    "iDisplayLength": 15,
    "aLengthMenu": [[15, 30, 90, -1], [15, 30, 90, "All"]],
  }); 
```

button-1 在数据表中有 3 列，2,3 - 有 4 列

如果我首先单击 button1，则 dataTable 工作正常，但对于其他两个按钮 datatable 未加载。如果我首先单击加载的按钮 2 数据表，那么按钮 3 也是如此，但不是按钮。我得出的结论是，如果表中没有列更改，那么只会出现这个问题。

有什么解决办法吗？

`$('#impfamilydatatable').dataTable().fnDestroy();`（我也试过）

```
 var a="";
   if(a !="") a.fnDestroy();
   a = $('#impfamilydatatable').dataTable({
        "aaSorting": [[ 1, "desc" ]],
        "bDestroy": true,
        "iDisplayLength": 15,
        "aLengthMenu": [[15, 30, 90, -1], [15, 30, 90, "All"]],
   }); 
```

但这些都不起作用

# powershell - 如果我使用 -computerName，powershell 调用命令不起作用

> ID：15718335
> 
> 赞同：1
> 
> 时间：2013-03-30T12:07:21.397
> 
> 标签：powershell, powershell-remoting, invoke-command

我想在当前用户所在的本地或远程机器上执行以下代码。

```
$BackUpSqlAgentAndRemoveOldbackup = {
    param([string]$AppServer,[string]$SqlInstance,[string]$BackupShare,[string]$alias)

    [Environment]::UserName #I got same user name in all cases.

    [System.Reflection.Assembly]::LoadWithPartialName('Microsoft.SqlServer.Smo') | Out-Null

    $server = New-Object ('Microsoft.SqlServer.Management.Smo.Server') $SqlInstance

    $backupName = 'SqlAgentJob_' + $SqlInstance + '_' + (Get-Date –format ‘yyyyMMdd_HHmm’) + '_' + $alias + '.sql'
    $backupPath = join-path $BackupShare $backupName

    $oldBackups = Get-ChildItem $backupShare | where { ( $_.name -like 'SqlAgentJob_*.sql' ) }
    $server.JobServer.Jobs.Script() | Out-File -filepath $backupPath
    foreach ( $item in $oldBackups ) { remove-item $item.fullName }
} 
```

@argList 是

```
@('hafcapp-1', 'hafcsql-1', '\\Host5FileSrv\Backup\test','auto') 
```

我注意到

这个，它运作良好（没有 -comupterName 和 -session）

```
Invoke-Command -ScriptBlock $BackUpSqlAgentAndRemoveOldbackup -argumentList $argList 
```

这个，它抛出执行（我也试过“-session”，得到相同的结果）

```
Invoke-Command -computerName localhost -ScriptBlock $BackUpSqlAgentAndRemoveOldbackup -argumentList $argList 
```

例外如下，它似乎无法访问该文件夹。

```
Cannot find path '\\Host5FileSrv\Backup\test' because it does not exist.
    + CategoryInfo          : ObjectNotFound: (\\Host5FileSrv\Backup\test:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand

You cannot call a method on a null-valued expression.
    + CategoryInfo          : InvalidOperation: (Script:String) [], RuntimeException
    + FullyQualifiedErrorId : InvokeMethodOnNull

Cannot bind argument to parameter 'Path' because it is null.
    + CategoryInfo          : InvalidData: (:) [Remove-Item], ParameterBindingValidationException
    + FullyQualifiedErrorId : ParameterArgumentValidationErrorNullNotAllowed,Microsoft.PowerShell.Commands.RemoveItemCommand 
```

如果我想添加计算机名或会话，有谁知道我该怎么做？（注：[Environment]::UserName 返回相同的用户）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:21:44.023

您遇到了双跳问题。您的凭据可以转移到下一台机器（第一跳），但不能再转移（第二跳）。这意味着您不能使用正在执行 Invoke-Command 的计算机、远程计算机 (localhost) 的凭据连接到文件共享 (\Host5FileSrv\Backup)。即使您使用 localhost 作为计算机名，它仍然是远程处理的。一个解决方案可能是 CredSSP。有关更多信息，请参见[此处](http://www.ravichaganti.com/blog/?p=1230)和[此处](http://blogs.msdn.com/b/clustering/archive/2009/06/25/9803001.aspx)。

![双跳](../Images/babbbfd944ca35aad3575a5ba9d9d23f.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:15:17.373

这看起来像是一个“第二跳”远程问题，您需要在所涉及的计算机上配置 WinRM 才能使用 CredSSP

[http://msdn.microsoft.com/en-us/library/windows/desktop/ee309365(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ee309365(v=vs.85).aspx)

# c# - 如何避免对 UserControl 的参考进行硬编码？

> ID：15718339
> 
> 赞同：4
> 
> 时间：2013-03-30T12:07:31.490
> 
> 标签：c#, asp.net, user-controls, reference

我想知道是否有一种动态方法可以避免硬编码 UserControl 或“USING”的引用？

```
<%@ Reference Control="~/UserControl.ascx" %>
using UserControl; 
```

我正在寻找一种方法来动态地将对 UserControls 的引用从后面的代码添加到页面。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T21:32:12.790

如果我正确理解了你的问题，这应该做你想做的事-

默认.aspx

```
<!DOCTYPE html>
<html>
<head runat="server">
    <title>Dynamic User Control Test</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <h1>Dynamic User Control Test</h1>
        <asp:PlaceHolder ID="UserControlPlaceHolder" runat="server"></asp:PlaceHolder>
    </div>
    </form>
</body>
</html> 
```

默认.aspx.cs

```
using System;
using System.Web.UI;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        UserControl uc = Page.LoadControl("~/UserControl.ascx") as UserControl;

        if (uc != null)
        {
            UserControlPlaceHolder.Controls.Add(uc);
        }
    }
} 
```

用户控件.ascx

```
<%@ Control Language="C#" AutoEventWireup="true" CodeFile="UserControl.ascx.cs" Inherits="UserControl" %>

<p>Here is some content inside the user control</p> 
```

UserControl.ascx.cs（如果 UserControl 是静态的并且不包含特定于解决方案的代码，则不需要）

```
using System;

public partial class UserControl : System.Web.UI.UserControl
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

不过，这仅适用于动态添加到页面的控件。

# javascript - 为什么在外部文件中使用内联代码时不起作用，但在使用函数时起作用

> ID：15718341
> 
> 赞同：0
> 
> 时间：2013-03-30T12:07:42.827
> 
> 标签：javascript

我知道问题的标题可能无法理解，但我会解释一下。

每个人都知道我们可以使用以下任何一种方式。

示例(1)

```
document.getElementById('idofelement').onsubmit = function() {
   alert('Go ahead');
   return false;
} 
```

示例（2）

```
function DisplayMsg(){
   alert('Go ahead');
   return false;
}

// and in HTML
<form action="file.php" method="post" onsubmit="return DisplayMsg();"> 
```

**我的问题（1）：**
两种方式或两个例子有什么区别

**我的问题 (2)：**
为什么`example (1)`在外部 JavaScript 文件中不起作用，但在目标 HTML 代码附近插入时与我一起使用。而`example (2)`工作在任何地方 无论是在外部文件中还是在目标 HTML 代码附近。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:10:26.293

加载文档后，您应该始终调用方法 getElementById。因此，正如@JanDvorak 所建议的，您应该`$.ready()`使用 jQuery 来包装它。如果不是，请`window.onload = function()`改用。

顺便说一句：不要忘记函数定义后的分号，IE 容易受到这种语法的影响

# objective-c - 找不到实例方法“-decrytedWithKey”（将默认 tyoe 返回为“id”）

> ID：15718346
> 
> 赞同：-1
> 
> 时间：2013-03-30T12:08:28.697
> 
> 标签：objective-c, xcode

我有一些加密数据，我想在应用程序启动后对其进行解密。我用这段代码来做：

```
NSMutableData *FR2ENData=[NSMutableData dataWithContentsOfFile:FR2ENFilePath];
        FR2ENData=[FR2ENData decryptedWithKey:@"XXXXXXXX"];
        NSString * FR2ENString = [NSString stringWithUTF8String:[FR2ENData bytes]];
        NSArray *FR2EN0=[FR2ENString componentsSeparatedByString:@"\n"]; 
```

我收到了这条警告信息：

找不到实例方法“-decrytedWithKey”（将默认 tyoe 返回为“id”）

我怎样才能清洁它？

提前致谢 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:19:17.943

您缺少的方法的*类别标题*。看起来您正在使用[用户 Karl 在此页面的第三篇文章中定义](http://www.cocos2d-iphone.org/forum/topic/6982)的扩展类别（我复制了下面的标题）：`decryptedWithKey:``NSData`

```
#import <Foundation/Foundation.h>

@interface NSData (AES256)
- (NSData*) encryptedWithKey:(NSData*) key;
- (NSData*) decryptedWithKey:(NSData*) key;
@end 
```

您的代码需要导入此标头以避免编译错误。您还需要将实现添加到您的项目中，无论是作为源还是作为库，以避免链接错误。

# android - Android & Gson 内存泄漏

> ID：15718350
> 
> 赞同：1
> 
> 时间：2013-03-30T12:09:14.220
> 
> 标签：android, memory-leaks, gson

这个简单的 Android Application 项目示例（在 Eclipse 中）。查看代码示例和内存快照图片之间的差异。似乎调用 com.google.gson.Gson.toJson 会导致内存泄漏。示例 1（注释了调用 printObject 的行）：

```
public class MainActivity extends Activity
{
...
@Override protected void onRestoreInstanceState(Bundle savedInstanceState)
{
    // Log.v(TAG, ">>> ACTIVITY  [onRestoreInstanceState] config:"+printObject(savedInstanceState));
    super.onRestoreInstanceState(savedInstanceState);
}
public String printObject(Object object)
{
    try  { return new Gson().toJson(object); }
    catch (Throwable ex){return "[FAILED to PRINT Object] : "+ex.getMessage();}
}
} 
```

示例 2（简而言之，代码与 1 相同，除了 UNCOMMENTED Log.... 行。所以 WITH 调用 printObjet）：

```
...
@Override protected void onRestoreInstanceState(Bundle savedInstanceState)
{
    Log.v(TAG, ">>> ACTIVITY  [onRestoreInstanceState] config:"+printObject(savedInstanceState));
    super.onRestoreInstanceState(savedInstanceState);
} 
```

这是 Eclipse Memory Analyzer 在 62 次（每种情况下）旋转平板设备导致 Activity 重新启动后分别针对 Sample 1 和 2 的快照：

![对于样品 1：](../Images/421df8e5f5ab438fd7635a72cc064a2e.png)

![对于样本 2：](../Images/73827d9f85c3e72bb5d3e419ffdd9c4c.png)

第二张图像的绿色区域为“泄漏嫌疑人”：

> 问题嫌疑人3
> 
> 由“dalvik.system.PathClassLoader @ 0x416beb30”加载的 62 个“com.example.leaktest.MainActivity”实例占用 1,959,008 (24.72%) 个字节。

用于测试：Eclipse 4.2 / Gson 2.2.2 (and 2.1) / Android 4.2 / Android Tablet with 4.1.1

网上也有一些类似的问题： [here](https://groups.google.com/forum/?fromgroups=#!topic/google-gson/RMvIhv4mAP8)和[here](https://stackoverflow.com/questions/10765831/out-of-memory-exception-in-gson-fromjson)

问题：这是一个问题（在 Android 或 Gson 中）吗？或者我错过了课程:)？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T16:37:32.880

您的问题是`62 instances of "com.example.leaktest.MainActivity"`，与 Gson 无关。有很多关于避免活动泄漏的信息，包括Android 开发者博客上的这篇文章[。](http://android-developers.blogspot.ca/2009/01/avoiding-memory-leaks.html)

# php - 无法将事件绑定到动态创建的元素

> ID：15718352
> 
> 赞同：0
> 
> 时间：2013-03-30T12:09:38.250
> 
> 标签：php, jquery, dynamic, event-handling

我在editstaff.php中有以下html结构：

```
<div id="result" style="display:none">This is result div</div>
<form id="adres" onsubmit="return submitForm();">
<input type="hidden" name="type" value="adrs" />
<input type="submit" value="Address" /></form> 
```

并采用内联样式：

```
#result{
position: absolute;
border: 5px solid gray;
padding: 10px;
background: white;
width: 270px;
height: 190px;
} 
```

这个 html 页面做什么，点击“地址”表单的“地址”按钮，一些帖子数据被发送到另一个 php 页面，该页面根据发送的数据显示信息，如 div （其样式为 display:none）fadeIn从显示：无。用于此目的的 javascript/jquery 代码如下：

```
<script>
function submitForm(){
  var data=$("#adres").serializeArray();
  /* alert(data); */
  data.push(
  {
    name:'sname',value:$("#title").val()
  }
  );
  $.post("geteditdata.php",data,
  function(data){
    $("#result").html(data);
    positionPopup();
    $("#result").fadeIn(1000);

  }
 )
return false;
}
function positionPopup(){
$("#result").css({
left: ($(window).width() - $('#result').width()) / 2,
top: ($(window).width() - $('#result').width()) / 2,
position:'absolute'
});
}

$("#divclose").live('click',function(){
$("#result").fadeOut(500);
});

</script> 
```

即，editstaff.php 中带有获取数据的 div 将弹出如下结构：

```
<div id="result">
some_value
<a href="#" id="divclose">Close</a>
</div> 
```

到了这个阶段，一切都还好。但是，当我单击弹出 div 上的“关闭”链接时，div 没有关闭（淡出） $("#divclose").click(function()

为什么在这种情况下没有发生这种情况？任何人都可以为我提供解决方案吗？我正在提供一个演示页面，您可以在其中看到实际的问题。

1.  请访问[http://raddacentre.org/editstaff.php](http://raddacentre.org/editstaff.php)和
2.  在“按名称搜索”字段中写入“Afsar”，然后
3.  然后按“显示”。
4.  页面加载后，请按页面底部的“地址”按钮。
5.  然后将显示一个弹出 div，其中将有一个名为“关闭”的链接。
6.  按下那个按钮，请检查为什么这个 div 没有淡入其中？

当我使用 jquery 1.3 版时，我使用了 $("#divclose").live 方法而不是 $(selector).on 方法。任何帮助将不胜感激。

在 geteditdata.php 中只有这段代码：

```
<?php
echo $_POST['sname'];
?>
<br /><br /><a href="#" id="divclose">Close Here</a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:12:28.377

您使用的是非常旧的 jQuery 1.2.3（它不是 jq 1.3），我不确定 .live 是否存在于该版本中。所以有两件事：

1.  使用新的 jQuery（我建议 1.9）
2.  使用 .on 而不是 .live （阅读它，语法有点不同）

代码应如下所示：

```
$("body").on('click', "#divclose", function(){
  $("#result").fadeOut(500);
}); 
```

您可以使用绑定事件时存在的其他容器来代替“body”。

# javascript - 在 qml 中删除复杂 div 的 Javascript

> ID：15718355
> 
> 赞同：0
> 
> 时间：2013-03-30T12:09:51.330
> 
> 标签：javascript, html, webview, qml

```
<div class="hh"><div class="ih" onclick="return koya.onEvent(arguments[0]||window.event,'3_2')"><div class="jh kh"></div></div></div> 
```

您好，我正在使用 qml webview 元素，我想从加载的页面中删除一个 div。我使用函数 webView.evaluateJavascript() 来运行 javascript 代码。现在我用谷歌搜索了很多，并尝试了不同的 JavaScript 代码来删除 div，但我失败了。有人可以告诉如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T15:30:30.653

假设您已加载 jquery，您可以执行以下操作：

```
$(".ih").remove(); 
```

哪里。后跟要删除的 div 上存在的类。

如果您没有加载 jquery，请查看使用 getElementsByClassName

`var child = document.getElementsByClassName('ih')[0]; child.parent.removeChild(child);`

# php - php如何访问函数内部的变量

> ID：15718360
> 
> 赞同：0
> 
> 时间：2013-03-30T12:10:24.103
> 
> 标签：php, variables, get

我有功能，说：

```
//file file1.php 
class p{
  function a(){
    global$v1;        
    $v1='';   
    //some processing to $v1 here//
    return $v1;
  }
} 
```

如何访问 $v1？($v1 in `return $v1`)

这是我的尝试（在另一个文件中）：

```
//file file2.php
include 'file1.php';
$obj=new p();
$print=$obj->a()->$v1;
echo $print; 
```

为什么不打印任何东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:14:41.040

```
class p{
  function a($v1){
            ///some processing to $v1 here//
            return $v1;
        }
    } 
```

然后将您的变量作为参数传递给您的函数。

```
//file file2.php
$v1 = 'Test';

require 'file1.php';
$obj=new p();
$print=$obj->a($v1);
echo $print; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:17:54.083

```
<?php
//file file1.php 
class p{
  protected $v1;

    public function setP($v1){
     $this->v1 = $v1;
    }

  public function getP(){

    $this->setP('');   
    ///some processing to $v1 here//
   return $this->v1;
   }
}

$obj = new p();
$print = $obj->getP();
echo $print;
?> 
```

# php - 加速实时搜索js、php、mysql

> ID：15718361
> 
> 赞同：1
> 
> 时间：2013-03-30T12:10:25.067
> 
> 标签：php, javascript

我用 php 和 javascript 制作了一个“实时搜索栏”。如果您在搜索栏中输入一个单词，它将搜索数据库（mysql）。

索引.php：

```
<input type="text" onkeyup="getMovie(this.value)"/>
<div id="movie"></div> 
```

javascript.js：

```
function getMovie(value) {
$.post("getmovie.php",{partialMovie:value},function(data) {
    $("#movie").html(data);
});
} 
```

获取电影.php：

```
include_once "connection.php"; 

if($_POST['partialMovie']){
    $partialMovie = $_POST['partialMovie'];

    $sql = "SELECT title FROM movie WHERE title LIKE '%$partialMovie%'";
    $stm = $db->prepare($sql);
    $result = $stm->execute(array());
    while($row = $stm->fetch(PDO::FETCH_ASSOC)) {
        echo "<li>".$row['title']."</li>";
    }
} 
```

这行得通，但速度很慢。我的数据库中只有 3 部“电影”，但显示结果需要一两秒钟。

三部电影的片名是：een twee drie。但如果我快速输入“een”，一秒钟后你会看到 een、twee、drie。一秒钟后你会看到：een twee。再过一秒钟你就会看到：een。

所以我的问题是：有没有办法加快搜索速度，或者如果你输入另一个字母，有没有办法停止搜索？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:24:49.837

要么降低您的期望，因为请求的往返时间为 1 秒并不是很容易改进，要么在页面加载时以 json 格式获取数据并搜索本地可用的 json 数据。但如果有很多记录，这可能不是一个选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:19:22.537

使用 PDO 时，请绑定参数以避免 sql 注入。

然后在 MySQL 中使用全文搜索（select match against），会比like %% 的方式快很多。

文档：[http ://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:28:51.310

**HTML**：

```
<input type="text" id="movie-autocomplete"/>
<div id="movie"></div> 
```

**JS**：

```
$(document).ready(function(){
    $('#movie-autocomplete').keyup(function(){
        setTimeout(function(){
            $.post(
                "getmovie.php",
                {
                    partialMovie: $(this).val()
                },
                function(data) {
                    $("#movie").html(data);
                }
            );
        }, 500);
    });
}); 
```

这将产生一个小的延迟并在该字段中发布一个实际值。

**PHP**：

```
include_once "connection.php"; 

if(!empty($_POST['partialMovie'])){
    $partialMovie = $_POST['partialMovie'];

    $sql = "SELECT title FROM movie WHERE title LIKE :movie ORDER BY title LIMIT 0, 10";
    $stm = $db->prepare($sql);
    $result = $stm->execute(array(':movie' => "%{$partialMovie}%"));
    while($row = $stm->fetch(PDO::FETCH_ASSOC)) {
        echo "<li>".$row['title']."</li>";
    }
} 
```

我们必须绑定参数以保护 SQL 查询并**防止 SQL 注入**。此外，您应该确保您已将 PDO 设置为使用真正的准备好的语句。

为了进一步加快所有过程，您应该只从 PHP 返回 JSON 数据并`<ul>`在您的 JS 代码中填写...

# jquery - 在 chrome 扩展中使用 jquery

> ID：15718362
> 
> 赞同：6
> 
> 时间：2013-03-30T12:10:25.320
> 
> 标签：jquery, google-chrome, google-chrome-extension

当用户单击弹出窗口中的选择按钮时，我正在构建的 chrome 扩展从打开的选项卡中获取选定的文本。我正在尝试为此使用 jquery。

清单.json

```
 {
  "manifest_version": 2,

  "name": "cap",
  "description": "BLAH",
  "version": "1.0",

  "permissions": [ "tabs",
    "https://*/*","http://*/*"
  ],
  "content_scripts": [
  {
    "matches": ["http://*/*","https://*/*"],
    "js": ["selection.js"],
    "run_at": "document_start",
    "all_frames": true
  }
 ],
  "browser_action": {
    "default_icon": "icon.png",
    "default_popup": "popup_main.html"
  }
} 
```

我在 popup.html 中包含了 jquery 脚本

```
<html><head>
<meta charset="utf-8">
<title>popup</title>
<link rel="stylesheet" href="/popup.css">
<script type="text/javascript" src="popup.js"></script>
<script type="text/javascript" src="jquery-1.9.1.min.js"></script>
<!-- <script type="text/javascript" src="js/tag-it.js"></script> -->
</head>
<body>

</body></html> 
```

popup.js

```
$(document).ready(function(){
  $("p").click(function(){
      chrome.tabs.getSelected(null, function(tab) {
    chrome.tabs.sendRequest(tab.id, {method: "getSelection"}, function (response) {
      var text = document.getElementById('text'); 
      text.innerHTML = response.data;
    });
  });
  });
}); 
```

在执行此脚本时，我收到错误：

未捕获的 ReferenceError：$ 未定义

请帮忙！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-30T12:12:23.793

您需要更改脚本标签的顺序以允许首先加载 jQuery：

```
<script type="text/javascript" src="jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="popup.js"></script> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-30T12:13:18.610

更改顺序。您必须先加载jquery核心插件，然后再加载其他插件

```
<script type="text/javascript" src="jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="popup.js"></script> 
```

# ios - 我可以在 iPhone 上安装 IPA 吗？

> ID：15718364
> 
> 赞同：1
> 
> 时间：2013-03-30T12:10:31.893
> 
> 标签：ios, objective-c, xcode, app-store, app-store-connect

将我的应用程序提交到应用程序商店后，我创建了所有文件的 zip。现在我在下一个版本，我想用以前的版本进行测试，以确保更新正常工作，因为有一些结构变化。不幸的是，一些文件被引用，但没有被复制，因此它们已经被删除或修改。

在无法从项目中再次构建的情况下，有什么办法可以在手机上安装以前的版本吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:29:08.980

打开 Xcode -> Archives，选择您的目标存档，分发 -> Ad-hoc Deployment，保存 .ipa 文件并将其拖入 iTunes。

如果您想将 .ipa 发送给其他人，则还需要 ad-hoc 配置文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T14:44:48.090

归档将创建 IPA 文件的应用程序的不同版本。然后将配置文件和 IPA 文件放到 iTunes 中并从那里安装。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:17:55.620

最简单的方法是从 iPhone 中删除新版本的应用程序，然后从 iTunes App Store 安装旧版本。如果您想同时运行两者，请暂时更改新版本的包标识符，然后通过 Xcode 安装它。

# vb.net - Return just the object type name without preceding "Objects."

> ID：15718372
> 
> 赞同：1
> 
> 时间：2013-03-30T12:11:26.853
> 
> 标签：vb.net

```
 Dim objCar As Car
    objCar = New Car
    Console.WriteLine("{0}", objCar.GetType.ToString()) 
```

Returns this

> Objects.Car

Can I change the code slightly, without using text functions, to just return the following?

> Car

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:38:48.163

Did you Try this.?

```
Dim objCar  As car
objCar  = New car
MsgBox(objCar.GetType.Name) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:16:37.773

Why not just override the `ToString` method on your `Car` class?

```
public class Car
{
    public Car() {}

    public override string ToString()
    {
        return "Car";
    }
} 
```

That way you can return whatever you want to return out of it without having to use `GetType`.

# c++ - 派生类的虚函数从基类调用时导致“不是成员”错误

> ID：15718374
> 
> 赞同：0
> 
> 时间：2013-03-30T12:11:47.073
> 
> 标签：c++, compiler-errors, virtual

```
#include<iostream>

class A {
private :
    int _a;

public :
    A(int i=0) : _a(i){}
    virtual void setA(int i) { _a = i;}
    virtual int getA(){ return _a;}
};

class B : public A
{
private :
    int _b;

public :

    B(int i) : _b(i){}
    virtual void setB(int i) { _b = i;}
    virtual int getB(){ return _b;}
};

int main(){
A* a1 = new B(10);
std::cout << a1->getA() << "\t " << a1->getB() << std::endl;
return 0;
} 
```

编译时出现以下错误：

```
test.cpp(28): error C2039: 'getB' : is not a member of 'A' 
```

不应该`a1`得到`getB`，因为它实际上是一个指针`B`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:42:35.057

编译器会告诉你确切的原因：

```
'getB' : is not a member of 'A' 
```

编译器根据指针的*类型*`A`进行编译时检查，因为它在报告中找不到方法。请注意，在编译时，编译器可能知道也可能不知道指针`a1`指向的对象，它可能是`A`或`B`任何从`A`. 编译器只检查指针的类型并检查被访问的成员是否属于该类。
对你来说，`a1`指向一个对象，`B`因此可以被视为，`B`但对于编译器`a1`来说，它是一个类型的指针，`A`在编译时它只将它视为`A`.

* * *

虽然上面已经很好地涵盖了“为什么这不起作用”的答案，但我认为我应该讨论“你如何解决这个问题”。

简单的答案是实现一个`getB()`for `A`。这通常是正确的做法 - 如果以某种方式“禁止”调用`getB`不具有此属性的对象，则对其进行处理 - 打印错误，退出程序，或者当有人“正确”时在代码中出现问题（最好在某处打印一条消息，然后停止，以便清楚出了什么问题并可以对其进行调试）。

替代方案，例如使用动态转换，也将起作用。但是您仍然必须知道对象是否是`B`类 - 或者检查指针是否返回 NULL。

虚函数的全部意义在于您用派生类中的新变体覆盖基类中的那些。它不支持在派生类中添加新函数。支持“新功能”的方法是例如添加一个参数：

```
class A
{
 public: 
    ...
    virtual int get(char v)
    {
       if (v == 'A') return _a;
       else
       {
          std::cerr << "Error: Requesting invalid variable: '" << v << "'" << std::endl;
          return -1;
      }
    }
    ...
}

class B: public A
{
   ...
   virtual get(char v)
   {
      if (v == 'B')
         return b;
      return A::get(v);
   }

   ...
} 
```

现在，只需稍作修改即可：

```
std::cout << a1->get('A') << "\t " << a1->get('B') << std::endl; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:25:22.293

您必须在 A 类中有一个成员函数：

```
virtual int getB()
{
 // do something or not
} 
```

之后，当您调用`a1->getB()`它时，它将调用 B 类的成员函数。

另一种方法是`dynamic_cast`在 a1 上使用：

```
A* a1 = new B(10);
B* b1=dynamic_cast<B*>(a1);
std::cout << b1->getA() << "\t " << b1->getB() << std::endl; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T12:35:06.987

编译器不知道`a`的动态类型信息。您可以使用以下方法将其转换为动态类型[`dynamic_cast`](http://en.cppreference.com/w/cpp/language/dynamic_cast)：

```
dynamic_cast<B*>(a1)->getB(); 
```

[***现场演示***](http://liveworkspace.org/code/4yc7Hy%243130)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T12:37:35.220

虽然 a1 是指向 B 类对象的指针，但编译器直到运行时才知道 a1 指向 B 对象。所以在编译时会遇到错误，因为 A 类中没有 getB 方法。

# c# - 从数据库中删除包含该图像的记录后从文件夹中删除图像

> ID：15718377
> 
> 赞同：1
> 
> 时间：2013-03-30T12:12:15.550
> 
> 标签：c#, sql

我的数据库中有一个表，其中包含两列 ID 和 Image。将我的图像插入数据库时​​，我使用以下代码。

```
 <pre lang='cs'>

       SqlCommand cmd = new SqlCommand("INSERT INTO info(ID,Img_Image) VALUES(@ID,@Img_image));
       cmd.Parameters.AddWithValue("@ID", txtID.Text);
       cmd.Parameters.AddWithValue("@Image", test_image);
    </pre> 
```

... test_image 从路径加载图像，即 (C:\foldername)。

现在我的问题是，当我删除特定记录时......文件夹中的相应图像应该被删除。

PS：我正在使用标准 SQL 删除代码来删除记录。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:37:18.110

从表中删除记录后，您可以使用 System.IO.File.Delete 或使用 FileInfo 删除物理文件

```
string filePath = "C:\test.txt";
FileInfo file = new FileInfo(filePath);
if (file.Exists)
{
   file.Delete();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-15T10:01:28.047

删除您的物理文件 - 100% 有效

```
File.Delete(Server.MapPath("../App_Themes/UPLOADS/banner_img/5.jpg"));

//if some error occurs like , don't have rights 

//uncheck readonly option in folder properties 
```

# java - 理解方法签名

> ID：15718383
> 
> 赞同：2
> 
> 时间：2013-03-30T12:12:48.983
> 
> 标签：java, generics, javadoc, guava, signature

我试图理解这个方法签名：

```
public final <T> FluentIterable<T> transform(Function<? super E,T> function) 
```

（取自[http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/FluentIterable.html#transform%28com.google.common.base.Function%29](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/FluentIterable.html#transform%28com.google.common.base.Function%29)）

我知道 transform 返回 a `FluentIterable<T>`，但我不明白`<T>`之前的`FluentIterable<T>`意思是什么？

此外，在 中`Function<? super E,T>`，我理解是什么`? super E`意思，但我无法想象编译器如何检查这个 - 在编译时不是 E 未知，那么编译器如何知道，如果`?`是 的超类型`E`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-30T12:20:15.210

`<T>`意味着这是一个带有泛型类型参数的方法`T`。这`<T>`类似于在类名（如`List<T>`）之后，仅用于方法。

`E`在编译时不是未知的。`E`也是类定义中定义的泛型类型参数：

```
public abstract class FluentIterable<E> extends Object implements Iterable<E> 
```

当您创建此类的实例时，编译器会知道`E`.

# ruby-on-rails - The mongoid function "update_attribute" causes all attributes to be re-ordered alphabetically

> ID：15718385
> 
> 赞同：0
> 
> 时间：2013-03-30T12:13:16.073
> 
> 标签：ruby-on-rails, ruby, mongodb, mongoid

Following up on this 1 year old post:

[Mongodb mongoid model attributes sorted by alphabetical order not insertion order](https://stackoverflow.com/questions/5923954/mongodb-mongoid-model-attributes-sorted-by-alphabetical-order-not-insertion-orde)

I have a rails 3.2.8 application that uses mongoid v. 3.0.0\. My application occasionally uses the "update_attribute" function on a database object (e.g. a product), but when it does all attributes gets reordered alphabetically.

When I duplicate this in the console, it looks like this:

```
1.9.3-p385 :001 > product = Product.find("5156bc9b83c3368121000008")
 => [#<Product _id: 5156bc9b83c3368121000008, _type: nil, product_number: "123", product_name: "Some product name", long_description: "<P>Some long product description.</P>", vendor_number: "abc", language_i_d: "1234", currency_i_d: "USD", category_number: "1", image_link: "http://some-external-website.com/image-path.jpg", original_id: "123456">]
1.9.3-p385 :002 > product.update_attribute(:image_link, "http://my-own-website.com/image-path.jpg")
 => true
1.9.3-p385 :003 > exit 
```

I now fire up the console again (for some reason I need to exit and re-open the console before the new order is displayed):

```
1.9.3-p385 :001 > product = Product.find("5156bc9b83c3368121000008")
 => [#<Product _id: 5156bc9b83c3368121000008, _type: nil, category_number: "1", currency_i_d: "USD", image_link: "http://my-own-website.com/image-path.jpg", language_i_d: "1234", long_description: "<P>Some long product description.</P>", original_id: "123456", product_name: "Some product name", product_number: "123", vendor_number: "abc">] 
```

Does anyone know how to avoid this reordering?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T00:17:06.090

This isn't mongoid's fault. If an update causes a document to grow and mongo had to move the document as a result then mongodb itself may reorder the document's fields (see [docs](http://docs.mongodb.org/manual/applications/update/) and a [jira](https://jira.mongodb.org/browse/SERVER-2592) issue where this is described as normal)

# python - Multithreading in pygtk

> ID：15718390
> 
> 赞同：1
> 
> 时间：2013-03-30T12:13:52.363
> 
> 标签：python, pygtk

I am trying to learn pygtk and I am developing a GUI for axel.

My problem is I need to show progress of download in my main window.

1.  I used two threads one for downloading and second for progress calculation. Download is done by axel but my second thread is not running until first thread stops. and second thread is not updating the gui

2.  I used `gobject.idel_add` it stucks the main window upon download start

3.  tried to use `Gtk.gdk.thread_init()/thread_enter()/thread_leave()` it says no module `gdk` in `Gtk`. On top of the page `Gtk` is imported from `gi.repository`

By the way I am using `quickly` to develop the app Is there any way to solve the problem. or any similiar examples.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-03T14:12:48.283

Check this thread [separate threads in pygtk application](https://stackoverflow.com/questions/685224/separate-threads-in-pygtk-application#) may be usefully for you. Here left a pygtk manage multithreading example to you.

```
import threading
import random, time
import gtk
#Initializing the gtk's thread engine
gtk.threads_init()

class FractionSetter(threading.Thread):
    """This class sets the fraction of the progressbar"""

    #Thread event, stops the thread if it is set.
    stopthread = threading.Event()

    def run(self):
        """Run method, this is the code that runs while thread is alive."""

        #Importing the progressbar widget from the global scope
        global progressbar 

        #While the stopthread event isn't setted, the thread keeps going on
        while not self.stopthread.isSet() :
            # Acquiring the gtk global mutex
            gtk.threads_enter()
            #Setting a random value for the fraction
            progressbar.set_fraction(random.random())
            # Releasing the gtk global mutex
            gtk.threads_leave()

            #Delaying 100ms until the next iteration
            time.sleep(0.1)

    def stop(self):
        """Stop method, sets the event to terminate the thread's main loop"""
        self.stopthread.set()

def main_quit(obj):
    """main_quit function, it stops the thread and the gtk's main loop"""
    #Importing the fs object from the global scope
    global fs
    #Stopping the thread and the gtk's main loop
    fs.stop()
    gtk.main_quit()

#Gui bootstrap: window and progressbar
window = gtk.Window()
progressbar = gtk.ProgressBar()
window.add(progressbar)
window.show_all()
#Connecting the 'destroy' event to the main_quit function
window.connect('destroy', main_quit)

#Creating and starting the thread
fs = FractionSetter()
fs.start()

gtk.main() 
```

# python - 两个列表的元素的交换组合

> ID：15718392
> 
> 赞同：2
> 
> 时间：2013-03-30T12:13:54.400
> 
> 标签：python

只是一个风格问题：是否有一种内置方法可以在交换属性的断言下获取组合并排除与自身配对的元素？

```
a = ["1", "2", "3"]
b = ["1", "2", "3"]
seen = []
combinations = []

for v1 in a:
    for v2 in b:
        if v1 != v2:
            if (v2, v1) not in seen:
                combinations.append((v1, v2))
                seen.append((v1, v2))

>> [('1', '2'), ('1', '3'), ('2', '3')] 
```

看起来不是很Python。我知道 itertools.product 是笛卡尔积。我可以将它转换为一个排除身份配对的集合，但它仍然是非交换产品。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:26:19.393

假设`a`和`b`是相同的。

```
>>> import itertools
>>> a = ["1", "2", "3"]
>>> list(itertools.combinations(a,2))
[('1', '2'), ('1', '3'), ('2', '3')] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:27:45.193

[`itertools.combinations`](http://docs.python.org/2/library/itertools.html#itertools.combinations)，如果两个列表都像这里一样。或者在一般情况下[`itertools.product`](http://docs.python.org/2/library/itertools.html#itertools.product)，然后进行一些过滤：

```
In [7]: a = ["1", "2", "3"]
   ...: b = ["a", "b", "c"]

In [8]: list(filter(lambda t: t[0] < t[1], product(a,b)))
Out[8]: 
[('1', 'a'),
 ('1', 'b'),
 ('1', 'c'),
 ('2', 'a'),
 ('2', 'b'),
 ('2', 'c'),
 ('3', 'a'),
 ('3', 'b'),
 ('3', 'c')] 
```

另外，我认为术语*组合*已经意味着结果中元素的顺序无关紧要。

* * *

好的，西奥德罗斯是对的。作为补偿，这是一个适用于任何列表列表的版本：

```
l = [['1','2','3'], ['a','b'], ['x','y']] 

set(tuple(sorted(p)) for p in product(*l) if len(set(p)) > 1) 
```

给出（适当排序）

```
set([('1', 'a', 'x'),
     ('3', 'a', 'y'),
     ('2', 'b', 'y'),
     ('2', 'a', 'y'),
     ('1', 'a', 'y'),
     ('1', 'b', 'y'),
     ('2', 'a', 'x'),
     ('3', 'b', 'y'),
     ('1', 'b', 'x'),
     ('2', 'b', 'x'),
     ('3', 'a', 'x'),
     ('3', 'b', 'x')]) 
```

它也适用于前面的反例`l = [[1,2,3], [1,3,4,5]]`：

```
set([(1, 2), (1, 3), (1, 4), (1, 5), (2, 3), (2, 5), (3, 4), (2, 4), (3, 5)]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T13:02:55.127

如果您不关心结果元组中的排序不映射到输入列表（您不关心是否`(1,2)`或`(2,1)`），这将起作用。在这里，您将首先获得与较小元素的组合：

```
a = [1,2,3]
b = [1,3,4,5]

set([(min(x,y), max(x,y)) for x in a for y in b if x != y]) 
```

给

```
set([(1, 2),
     (1, 3),
     (1, 4),
     (1, 5),
     (2, 3),
     (2, 5),
     (3, 4),
     (2, 4),
     (3, 5)]) 
```

带字符串

```
a = '1 2 3'.split()
b = '1 3 4 5'.split() 
```

你得到

```
set([('2', '3'),
     ('3', '5'),
     ('1', '4'),
     ('3', '4'),
     ('1', '5'),
     ('1', '2'),
     ('2', '5'),
     ('1', '3'),
     ('2', '4')]) 
```

排序的明显差异来自字符串和数字的不同哈希值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-17T21:08:29.550

我不认为这是最不言自明的方式，所以我不推荐它，但为了完整起见，我会包括它。

使用交换对是由两个数组的乘积产生的矩阵的上下三角形这一事实。

numpy 函数[`np.tril_indices`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.tril_indices.html)返回一个元组，其中仅包含数组下三角形的索引。

1.  获取所有产品，不包括可交换对（如您所愿）但包括与其自身配对的元素（不是您想要的）：

```
>>> import numpy as np
>>> n_vars = len(a)
>>> assert len(b) == n_vars  # Only works if len(a) == len(b)
>>> [(a[i], b[j]) for i, j in zip(*np.tril_indices(n_vars))]
[('1', '1'), ('2', '1'), ('2', '2'), ('3', '1'), ('3', '2'), ('3', '3')] 
```

2.  排除与自身配对的元素（您想要的）：

```
>>> [(a[i], b[j]) for i, j in zip(*np.tril_indices(n_vars, k=-1))]
[('2', '1'), ('3', '1'), ('3', '2')] 
```

in的`k`参数`np.tril_indices`是一个偏移参数，因此`k=-1`意味着它不包括对角线项。

由于它是一个 numpy 函数，它可能非常快。

3.  如果您将`a`and转换`b`为 numpy 数组，您也可以这样做：

```
>>> a = np.array(a)
>>> b = np.array(b)
>>> ind = np.tril_indices(n_vars, k=-1)
>>> list(zip(a[ind[0]], b[ind[1]]))
[('2', '1'), ('3', '1'), ('3', '2')]
>>> np.stack([a[ind[0]], b[ind[1]]]).T
array([['2', '1'],
       ['3', '1'],
       ['3', '2']], dtype='<U1') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-17T21:29:18.850

我认为可能最简单和最明确（即不言自明）的解决方案是：

```
>>> for i in range(len(a)): 
...     for j in range(i+1, len(b)): 
...         print(a[i], a[j]) 
... 
1 2
1 3
2 3 
```

除非你在内部循环中做得非常快，否则 python for 循环的低效率几乎不会成为瓶颈。

或这个：

```
>>> [(a[i], b[j]) for i in range(len(a)) for j in range(i+1, len(b))]
[('1', '2'), ('1', '3'), ('2', '3')] 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-03-30T12:24:34.757

你是这个意思？

```
a = ["1", "2", "3"]
b = ["1", "2", "3"]
print [(x,y) for x in a for y in b] 
```

输出：

```
[('1', '1'), ('1', '2'), ('1', '3'), ('2', '1'), ('2', '2'), ('2', '3'), ('3', '1'), ('3', '2'), ('3', '3')] 
```

# javascript - 在调用函数之前等待动画完成

> ID：15718397
> 
> 赞同：0
> 
> 时间：2013-03-30T12:14:20.203
> 
> 标签：javascript, jquery

JS：

```
$.fn.blink = function(times, duration) {
    times = times || 2;

    while (times--) {
        this.fadeTo(duration, 0).fadeTo(duration, 1);
    }      
}; 
```

这使得闪烁的文本。最后眨眼我想执行一个函数，所以我改变了它：

```
$.fn.blink = function(times, duration, callback) {
    times = times || 2;

    while (times--) {
        this.fadeTo(duration, 0).fadeTo(duration, 1);
    }

    if (typeof callback == 'function') { // make sure the callback is a function
        callback.call(this); // brings the scope to the callback
    }
}; 
```

回调的执行不在正确的位置。它似乎在闪烁开始时被触发。任何想法如何在最后闪烁时调用该函数？

[**小提琴**](http://jsfiddle.net/Cnm2f/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:24:42.463

jQuery 动画有一个`complete`回调参数，因为这些方法是异步的

尝试：

```
while (times--) {
        this.fadeTo(duration, 0).fadeTo(duration, 1, function(){
            /*last animation is complete*/
           if (typeof callback == 'function') { // make sure the callback is a function
                callback.call(this); // brings the scope to the callback
            } 

        });
    } 
```

API 参考：[http ://api.jquery.com/fadeTo/](http://api.jquery.com/fadeTo/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:30:03.277

我给你写了一个小提琴。您的代码的问题是，循环通过您闪烁的东西快速迭代，并且立即调用了完整的函数。

```
$(document).ready(function () {
    $('.blink').blink(5, 500, shout);
});

function shout() {
    alert('finished blinking');
}

$.fn.blinkOnce = function (duration, callback) {
    this.fadeTo(duration, 0).fadeTo(duration, 1, function () {
        if (typeof callback == 'function') callback.call(this);
    });
};

$.fn.blink = function (times, duration, callback) {
    var toBlink = this;
    var blinkComplete = function () {
        times--;
        if (times == 0) callback.call(this);
        else toBlink.blinkOnce(duration, blinkComplete);
    }

    toBlink.blinkOnce(duration, blinkComplete);
    return true;
}; 
```

[http://jsfiddle.net/xgeLu/](http://jsfiddle.net/xgeLu/)

# c - 使用 gethostbyaddr() 时出现分段错误

> ID：15718398
> 
> 赞同：0
> 
> 时间：2013-03-30T12:14:25.213
> 
> 标签：c, segmentation-fault, coredump, gethostbyaddr

```
#include <netdb.h>
#include <stdio.h>
#include <sys/socket.h>
int main(int argc, char **argv)
{
    char *ptr = NULL;
    struct hostent *hptr = NULL;
    struct in_addr *hipaddr = NULL;
    ptr = argv[1];
    inet_aton(ptr,hipaddr);
    hptr = gethostbyaddr(hipaddr, 4, AF_INET);
    printf("official hostname:%s\n",hptr->h_name);
    return 0;
} 
```

运行结果显示:segmentation fault (core dumped)。但我不知道如何使它工作。所以我需要一些帮助......

我将代码更改为：

```
#include <netdb.h>
#include <stdio.h>
#include <sys/socket.h>
int main(int argc, char **argv)
{
char *ptr = NULL;
struct hostent *hptr = NULL;
struct in_addr hipaddr ;

ptr = argv[1];
inet_aton(ptr,&hipaddr);
hptr = gethostbyaddr(&hipaddr, sizeof(hipaddr), AF_INET);
printf("official hostname:%s\n",hptr->h_name);
return 0;
} 
```

然后它起作用了！但为什么呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:43:41.357

在第一个版本中，您将空指针传递给`inet_aton`. 然后`inet_aton`尝试写入该地址并导致段错误。

```
inet_aton(ptr,hipaddr);//hipaddr is NULL 
```

`in_addr`调用时需要将指针传递给结构`inet_aton`。这就是你在第二个版本中所做的。

```
struct in_addr hipaddr;
inet_aton(ptr, &hipaddr);&hipaddr is a pointer to struct in_addr 
```

# android - Can I return the id string of an edit text in code?

> ID：15718407
> 
> 赞同：1
> 
> 时间：2013-03-30T12:15:08.737
> 
> 标签：android, android-edittext

Can I get this string in code?

`GetId()` returns an int?

![enter image description here](../Images/8f7daf85ec83af1f6567e3306aa59cdf.png)

EDIT:

If not, is there a way I can assign my textboxes a tag each, which is a string, and then return this in code?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:18:42.457

You are looking for the resource name:

```
getResources().getResourceEntryName(intresid); 
```

If you want the resource name include package name then use:

```
getResources().getResourceName(intresid); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:19:16.130

> Can I get this string in code?

No. You can get only `ID` of resource. Reason is because your `R.class` storing all resources as

```
public static final int fields 
```

Your `R.java` can looks similar like this:

```
public static final class id {
        public static final int DataHallTextField=0x7f09000a;
} 
```

## Update:

> If not, is there a way I can assign my textboxes a tag each, which is a string, and then return this in code?

So i think you are looking for this:

```
String name = getResources().getResourceEntryName(R.id.DataHallTextField); 
```

If you want also package you can use

```
String name = getResources().getResourceName(R.id.DataHallTextField); 
```

# postgresql - PostgreSQL 中的快速标签搜索（数组、GIN、seqscan）

> ID：15718408
> 
> 赞同：3
> 
> 时间：2013-03-30T12:15:17.303
> 
> 标签：postgresql

我有一个表和一个 GIN 索引。

```
CREATE TABLE tags (id SERIAL PRIMARY KEY, tags text[], attrs text); 
CREATE INDEX tags_tags ON tags USING GIN("tags"); 
```

（`enable_seqscan`默认开启）

```
SET enable_seqscan TO on; 
SELECT id FROM tags WHERE tags @> array['category_72']; 
```

查询在**1000-1600 毫秒内运行**

```
SET enable_seqscan TO off; 
SELECT id FROM tags WHERE tags @> array['category_72']; 
```

相同的查询在**1-10 毫秒内**运行（快 100-1000 倍）。

有人可以澄清为什么会发生这种情况，以及是否可以提示 PostgreSQL 在查询中使用 GIN 索引，而不将 enable_seqscan 设置为关闭。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:40:21.093

好的，我发现了一些可以回答我的问题的东西。

当表变大时——PostgreSQL 终于开始使用索引了。

如果表处于持续写入状态 - 则不使用 GIN 索引。

# asp.net - ASP.NET 存储过程错误

> ID：15718410
> 
> 赞同：0
> 
> 时间：2013-03-30T12:15:22.330
> 
> 标签：asp.net, stored-procedures

我有返回“表格数据”并且只有“获取方法”的存储过程。

我取消选中“填充数据表”复选框。并且方法名称是空字段。

所以，我只有一个 Get 方法来从数据库表中获取行。

当我在 SQL 管理工作室中尝试 SQL 代码时，它运行良好。

但是当我创建一个存储过程时，我会收到一个警报：

![在此处输入图像描述](../Images/370d3fba05dd187c64f363eb22e930db.png) 我使用 BLL/BO/DAL 架构

我将我的存储过程称为：

```
MyDataTable dt = myAdapter.MyStoredProcedure(); 
```

我得到一个错误：

“System.Data.ConstraintException：无法启用约束。一行或多行包含违反非空、唯一或外键约束的值”

![在此处输入图像描述](../Images/dca5c676906f39419dbe433074675f0b.png)

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:18:25.263

检查同样的问题

[无法启用约束。一行或多行包含违反非空、唯一或外键约束的值](https://stackoverflow.com/questions/7026566/failed-to-enable-constraints-one-or-more-rows-contain-values-violating-non-null)

[http://forums.asp.net/t/1258783.aspx/2/10](http://forums.asp.net/t/1258783.aspx/2/10)

# javascript - 使用 jQuery 表单插件上传 Ajax 文件 - 无效文件错误

> ID：15718415
> 
> 赞同：0
> 
> 时间：2013-03-30T12:15:53.623
> 
> 标签：javascript, forms, jquery, upload

我正在尝试使用[jQuery 表单插件](http://www.malsup.com/jquery/form/)来执行 ajax 文件上传。我复制了其中一个示例，当我尝试上传时，出现以下文本：

> 100%
> 无效文件

控制台指示：

> XHR 完成加载：

但没有上传任何内容。

我正在使用 XAMPP，并已使用 chmod -R 777 对我的上传文件夹启用了许可。我要上传的文件是 .png。下面是代码：

**索引.html**

```
<form action="upload.php" method="post" enctype="multipart/form-data">
   <input type="file" name="myfile"><br>
   <input type="submit" value="Upload File to Server">
</form>
<div class="progress">
   <div class="bar"></div >
   <div class="percent">0%</div >
</div>
<div id="status"></div>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script>
<script src="http://malsup.github.com/jquery.form.js"></script>
<script src="ajax.js"></script> 
```

**ajax.js**

```
$(document).ready(function() {

var bar = $('.bar');
var percent = $('.percent');
var status = $('#status');

$('form').ajaxForm({
    beforeSend: function() {
        status.empty();
        var percentVal = '0%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
    uploadProgress: function(event, position, total, percentComplete) {
        var percentVal = percentComplete + '%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
    success: function() {
        var percentVal = '100%';
        bar.width(percentVal)
        percent.html(percentVal);
    },
    complete: function(xhr) {
        status.html(xhr.responseText);
    }
}); 
}); 
```

**上传.php**

```
<?php
$allowedExts = array("gif", "jpeg", "jpg", "png");
$extension = end(explode(".", $_FILES["file"]["name"]));
if ((($_FILES["file"]["type"] == "image/gif")
|| ($_FILES["file"]["type"] == "image/jpeg")
|| ($_FILES["file"]["type"] == "image/jpg")
|| ($_FILES["file"]["type"] == "image/png"))
&& ($_FILES["file"]["size"] < 20000)
&& in_array($extension, $allowedExts))
  {
  if ($_FILES["file"]["error"] > 0)
    {
    echo "Return Code: " . $_FILES["file"]["error"] . "<br>";
    }
  else
    {
    echo "Upload: " . $_FILES["file"]["name"] . "<br>";
    echo "Type: " . $_FILES["file"]["type"] . "<br>";
    echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
    echo "Temp file: " . $_FILES["file"]["tmp_name"] . "<br>";

    if (file_exists("upload/" . $_FILES["file"]["name"]))
      {
      echo $_FILES["file"]["name"] . " already exists. ";
      }
    else
      {
      move_uploaded_file($_FILES["file"]["tmp_name"],
      "upload/" . $_FILES["file"]["name"]);
      echo "Stored in: " . "upload/" . $_FILES["file"]["name"];
      }
    }
  }
else
  {
  echo "Invalid file";
  }
?> 
```

**注意**我认为问题出在扩展而不是upload.php，因为我将此php用于其他上传并且工作正常。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-25T11:47:04.133

如果更改插件不打扰您，那么您必须尝试一些更好的插件，例如我正在使用的[这个](http://jsever.blogspot.in/2014/04/jsajaxfileuploader-jquery-plugin.html)插件，它对开发人员和用户也非常友好。

[从这里](https://github.com/JSEver/JSAjaxFileUploader)获取带有演示文件的完整源代码。我敢肯定，您不必进行很多更改即可将此插件集成到您现有的代码中:) 希望这对您有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:25:26.013

如果扩展名正常，则可能是大小问题：脚本正在检查`$_FILES["file"]["size"] < 20000`.

我会尝试根据您的需要调整该参数。大小单位为千字节，因此为 20000KB ~ 20MB。尝试检查您的图像是否更大。

也`$extension = end(explode(".", $_FILES["file"]["name"]))`可能是一个问题，具体取决于您上传的文件：它应该有扩展名。

作为最后一次尝试，检查 的值`$_FILES["file"]["type"]`，也许你有一些 mime 类型的错误。

# php - 如何缓存学说查询？

> ID：15718421
> 
> 赞同：0
> 
> 时间：2013-03-30T12:16:46.743
> 
> 标签：php, caching, symfony-1.4

在 Web 调试工具栏中，我看到了针对我的 index.php 的 109 个 SQL 查询。

一个查询被使用了 40 次：

```
Doctrine::getTable('Configuration')->getConfiguration(); 
```

这是因为许多组件和操作：

```
public function executeImpress(sfWebRequest $request) {
   Doctrine::getTable('Configuration')->getConfiguration();
}

public function executeRightMenu() {
    Doctrine::getTable('Configuration')->getConfiguration();
}

public function executeLeftMenu() {
    Doctrine::getTable('Configuration')->getConfiguration();
} 
```

...

我希望我可以在请求级别缓存这个调用，这样这个查询就不会被触发 40 次而是 1 次。

也许你们中的一些专家对我有一个提示，如何避免讨厌的重复 sql 查询

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:35:24.450

我已经有一段时间没有使用 Symfony 了，但是如果你的菜单在 99% 的时间里都是一样的，为什么不把它放到配置文件而不是数据库中呢（我发现 xml/yml 树结构很好用，快速）？

或者，如果您的表不是那么大，请将其保存到全局变量中并在每次调用配置时重用它？

此外，对于 Doctrine Result Caching，我找到了本手册（对应于您的 symfony 版本）：[Advanced Doctrine Usage](http://symfony.com/legacy/doc/more-with-symfony/1_4/en/08-Advanced-Doctrine-Usage#chapter_08_using_doctrine_result_caching)

# c# - 字节数组到Base64String（图像转换）

> ID：15718423
> 
> 赞同：0
> 
> 时间：2013-03-30T12:17:13.247
> 
> 标签：c#, windows-phone-7, bytearray, image-conversion

我在我的 wp7 应用程序的客户端将图像转换为字节数组，然后将其发送到 Web 服务（服务器），代码如下所示--->

**客户端**

```
private void SendImage(byte[] data, long UserID)
{
    Uri uri = new Uri("some uri");
    IDictionary<string, object> bytesToSend = new Dictionary<string, object>();
    bytesToSend.Add("ImageBytes", Convert.ToBase64String(data));
    PostClient post = new PostClient(bytesToSend);
    post.DownloadStringAsync(uri);
} 
```

**服务器端**

```
[HttpPost]
public bool SaveImage(object ImageBytes, Int64 UserID = 1)
{
    string ImgStr = ((string[])(ImageBytes))[0];
    byte[] ImgBytes = Convert.FromBase64String(ImgStr); ///<----///ERROR
    Image ItemImage;
    using (MemoryStream ms = new MemoryStream(ImgBytes))
    {
        ItemImage = Image.FromStream(ms);
    }
    PostUserItems(ItemImage);
    return true;
} 
```

但在接收端发生错误

**基数 64 字符数组的长度无效**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:57:56.827

您的数据以字符串的形式出现，而不是字符串 []。你可以修复演员表，所以而不是

```
string ImgStr = ((string[])(ImageBytes))[0]; 
```

做

```
string ImgStr = (string)ImageBytes; 
```

如果可以，请更改函数声明，因为您的函数需要 a `String`，而不是`Object`.

```
public bool SaveImage(String ImgStr, Int64 UserID = 1)
{
    byte[] ImgBytes = Convert.FromBase64String(ImgStr);
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-28T08:40:47.597

base64 编码字符串的长度始终是 4 的倍数。如果它不是 4 的倍数，则追加 = 字符，直到它是。?name=value 形式的查询字符串在值包含 = 字符时会出现问题（其中一些将被删除，我不记得确切的行为）。在进行 base64 解码之前，您可能可以通过附加正确数量的 = 字符来摆脱困境。

编辑 1

您可能会发现 UserNameToVerify 的值已将“+”更改为“”，因此您可能需要这样做；

a = a.Replace(" ","+"); 这应该得到正确的长度；

int mod4 = a.Length % 4; 如果 ( mod4 > 0 )

{

a += 新字符串('=', 4 - mod4 );

}

当然，调用 UrlEncode（如 LukeH 的回答）应该让这一切变得毫无意义。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-02-28T08:07:39.107

我已经看到这个错误是由大小合适的视图状态和过度激进的内容过滤设备/防火墙（尤其是在与 K-12 教育机构打交道时）的组合引起的。

我们通过将 Viewstate 存储在 SQL Server 中来解决这个问题。在走这条路之前，我建议尝试通过不在其中存储任何大的东西并为所有不需要它的控件关闭它来限制您对视图状态的使用。

在 SQL Server 中存储 ViewState 的参考资料：MSDN - PageStatePersister ASP 联盟概述 - SQL Server 代码项目中存储视图状态的简单方法 - ViewState Provider Model

# c - 我的 c 程序打印“内存不足”-错误，但有很多可用的内存空间

> ID：15718424
> 
> 赞同：4
> 
> 时间：2013-03-30T12:17:23.827
> 
> 标签：c, memory, dev-c++

我的程序在不使用超过 1 MB 的情况下返回内存错误。我在 dev-cpp 编译器中编写 C。原程序太大，放在这里。这个非常简单的程序对我有用：

`int main(){int a[520076]; return 0;}`

并返回值 0。但是，这个：

`int main(){int a[520077]; return 0;}`

不起作用，原因是内存。我使用的是 Windows 8，但同样的问题出现在 Windows 7 中。看起来系统对进程可以使用的内存空间进行了限制。dev-cpp也可以设置边界吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-30T12:20:47.347

> 看起来系统放了一个最大的内存空间

是的，但这并不完全是这种情况下的问题。您声明的数组是本地和自动的，因此它很可能分配在堆栈上。堆栈空间是有限的，甚至比动态分配的内存（通常在堆上）更有限，而且它的大小只有几兆字节（如果我没记错的话，在 Windows 上它实际上是 1 MB），它很快就会与其他内存发生冲突内存区域。

如果您不想要这个，请将您的变量声明为文件范围（“全局”）变量或`static`（阅读副作用）。

此外，您说得对，操作系统还限制**了所有**内存——它试图保持进程之间的民主。即使您在具有 128 GB RAM 的服务器上运行程序，`malloc()`也可能会失败，例如，如果您尝试分配 32 GB。通常不需要那么多内存，并且操作系统可以保护其他进程免受错误（或故意）占用资源的影响。

# jsp - Display XMLGregorianCalendar Date on JSP page using struts-tags

> ID：15718427
> 
> 赞同：1
> 
> 时间：2013-03-30T12:17:40.940
> 
> 标签：jsp, model-view-controller, date, web, struts2

I am getting Date details in the format of `XMLGregorianCalendar` and I try to display it on the JSP page using struts tags:

```
<td><s:date name="issuedDate" format="dd/MM/yyyy" /></td> 
```

But this date filed display nothing on the JSP page, could anybody help me to know how to get is displayed on the JSP page. I am getting these date objects of this type from a web service.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:21:14.827

Assuming that your `issuedDate` object is `XMLGregorianCalendar` type. You can call `toGregorianCalendar()` method of `XMLGregorianCalendar` right in `<s:date>` tag.

```
<td><s:date name="issuedDate.toGregorianCalendar()" format="dd/MM/yyyy" /></td> 
```

# android - 在android中显示图像使用位图的延迟

> ID：15718428
> 
> 赞同：4
> 
> 时间：2013-03-30T12:17:49.560
> 
> 标签：android, image, bitmap, udpclient, android-drawable

我从我的设备接收到连续的 UDP 数据（RAW 图像）。解码它并使用位图显示

我的 Android 手机，所以它看起来像一个视频。问题是框​​架不显示

不断地。框架变化约。每 2~3 秒，但我想以 1/30 逐帧显示。

以下是我的代码的一部分

```
 public class ArDroneMain extends Activity {
  Bitmap  image = null;
  public ImageView myImageView;
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    animationDrawable = new AnimationDrawable(); 
    myImageView = (ImageView)findViewById(R.id.imageView);
    thread.start();   
  }
}

 Thread thread=new Thread  (new Runnable() {
        Message message;
    String obj="run";      
    @Override
    public void run() {   

    while(true){     
        try { 
            Log.e("enter_video_thread","enter_video_thread");
            receiveVideoRawData();
            Log.e("///receiveVideoRawData ","receiveVideoRawData");
            message = handler.obtainMessage(1,obj);
                    handler.sendMessage(message);
        } catch (IOException e) {
            e.printStackTrace();
        }   
    }
   }
  public Handler handler = new Handler(){   

    @SuppressLint("NewApi")
    @Override
    public void handleMessage(Message msg) {
          super.handleMessage(msg);         
            String MsgString = (String)msg.obj;
            if (MsgString.equals("run"))
            {                                                                                
                          Drawable ardrone_Frame_Drawable =newBitmapDrawable(getResources(),image);
                         animationDrawable.addFrame(ardrone_Frame_Drawable,100);
                         myImageView.setBackground(animationDrawable);                       

            }

    }
};

  public void sendTriggerCommand() throws IOException{
        byte [] ip_bytes = new byte[] {(byte)192,(byte)168,(byte)1,(byte)1};//Drone address  
        byte[] buf_snd = {0x01, 0x00, 0x00, 0x00};//trigger buffer
        inet_addr = InetAddress.getByAddress(ip_bytes );
        DatagramPacket packet_snd = new DatagramPacket(buf_snd, buf_snd.length, i   net_addr, ardrone_video_port);       
        socket_video.send(packet_snd);

}

   public void receiveVideoRawData() throws IOException{
    Log.e("enter_receiveVideoRawData()","enter_receiveVideoRawData()");
    socket_video = new DatagramSocket();
    byte[] buf_rcv = new byte[153600];
    DatagramPacket rawData = new DatagramPacket(buf_rcv, buf_rcv.length);
        sendTriggerCommand();
        Log.e("sendTriggerCommand();","sendTriggerCommand();");
        socket_video.receive(rawData);
        Log.e("socket_video.receive(rawData);","socket_video.receive(rawData);");
        ReadRawFileImage readMyRawData=new ReadRawFileImage();

        image = readMyRawData.readUINT_RGBImage(buf_rcv); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:57:09.607

我真的怀疑您能否尽快接收数据，尤其是原始图像。

你可以做些什么来改进你的程序可能是：

*   发送和接收压缩数据
*   删除 while true 循环，它永远不会手。您应该使用布尔标志来控制您的线程。
*   使用 AsyncTask 接收数据，在后台解码，然后在 ui 线程中显示
*   use 2 thread with thread synchronisation : one that reads data from network, a second one that consumes this data and displays it. That would be a much better architecture that pipelining the 2 tasks.

# java - Eclipse Ant：使用 appbundle 将 .jar 捆绑到 .app

> ID：15718433
> 
> 赞同：1
> 
> 时间：2013-03-30T12:18:17.700
> 
> 标签：java, eclipse, ant, jvm-arguments, jarbundler

**编辑：**可以通过使用内置 jvm 参数创建可执行 jar 来避免上述所有问题。创建后，我可以使用 appbundle 将它捆绑到一个 .app 中。如何将 VM 参数集成到我的可执行 .jar 中？

* * *

我有一个可执行的 jar，我必须使用Oracle 的[appbundler](http://java.net/projects/appbundler)将其捆绑到一个 .app 中（以使其在 OS X 上运行）。如果我从终端使用`java -XstartOnFirstThread -jar PhotoSelector.jar`. 由于 SWT（打包在我的可执行 jar 中）和 Cocoa 限制，我必须设置`-XstartOnFirstThread`为 java 参数。问题是我不知道如何正确配置 Eclipse（Ant！）以将双击设置为 .app 将使用`-XstartOnFirstThread`参数执行我的应用程序。这些是我的 XML 文件：

**构建.xml**

```
 <?xml version="1.0" encoding="UTF-8" standalone="no"?>
    <!-- WARNING: Eclipse auto-generated file.
              Any modifications will be overwritten.
              To include a user specific buildfile here, simply create one in the same
              directory with the processing instruction <?eclipse.ant.import?>
              as the first entry and export the buildfile again. -->
    <project basedir="." default="build" name="PhotoSelector">
    <property environment="env"/>
    <property name="ECLIPSE_HOME" value="../../../eclipse Java"/>
    <property name="debuglevel" value="source,lines,vars"/>
    <property name="target" value="1.7"/>
    <property name="source" value="1.7"/>
    <import file="buildMac.xml"/>
    <path id="PhotoSelector.classpath">
        <pathelement location="bin"/>
        <pathelement location="lib/swt_64_OsX.jar"/>
    </path>
    <target name="init">
        <mkdir dir="bin"/>
        <copy includeemptydirs="false" todir="bin">
            <fileset dir="src">
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
    </target>
    <target name="clean">
        <delete dir="bin"/>
    </target>
    <target depends="clean" name="cleanall"/>
    <target depends="build-subprojects,build-project" name="build"/>
    <target name="build-subprojects"/>
    <target depends="init" name="build-project">
        <echo message="${ant.project.name}: ${ant.file}"/>
        <javac debug="true" debuglevel="${debuglevel}" destdir="bin" includeantruntime="false" source="${source}" target="${target}">
            <src path="src"/>
            <classpath refid="PhotoSelector.classpath"/>
        </javac>
    </target>
    <target description="Build all projects which reference this project. Useful to propagate changes." name="build-refprojects"/>
    <target description="copy Eclipse compiler jars to ant lib directory" name="init-eclipse-compiler">
        <copy todir="${ant.library.dir}">
            <fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar"/>
        </copy>
        <unzip dest="${ant.library.dir}">
            <patternset includes="jdtCompilerAdapter.jar"/>
            <fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar"/>
        </unzip>
    </target>
    <target description="compile project with Eclipse compiler" name="build-eclipse-compiler">
        <property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/>
        <antcall target="build"/>
    </target>
    <target name="Main">
        <java classname="com.selector.Main" failonerror="true" fork="yes">
            <classpath refid="PhotoSelector.classpath"/>
        </java>
    </target>
</project> 
```

**构建Mac.xml**

```
<?eclipse.ant.import?>
<project name="PhotoSelectorBundler">
<taskdef 
name="bundleapp" 
classname="com.oracle.appbundler.AppBundlerTask" 
classpath="lib/appbundler-1.0.jar" />

<target name="bundle">
<bundleapp 
    outputdirectory="dist" 
    name="PhotoSelector" 
    displayname="Photo Selector" 
    identifier="com.selector.Main"
    mainclassname="Main"
    icon="src/com/selector/256.icns">
    <classpath file="dist/PhotoSelector.jar" />
</bundleapp>
</target>
</project> 
```

所以，我的问题是：

1.  双击时如何默认将-XstartOnFirstThread传递给.app？
2.  我必须在 eclipse ant 工具中选择哪些目标才能正确导出我的 .app？

现在我的 .app 已创建，但它立即关闭。我使用 appbundler 因为 Jar Bundler 不支持 Java 1.7（在我的项目中广泛使用）。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-01T21:35:25.630

> 双击时如何默认将-XstartOnFirstThread传递给.app？

`<bundleapp>`在标签中添加以下内容：

```
<option value="-XstartOnFirstThread"/> 
```

> 我必须在 eclipse ant 工具中选择哪些目标才能正确导出我的 .app？

我不确定你在这里问什么。想必这就是你的`bundleapp`目标。请参阅[Jar Bundler 文档](http://docs.oracle.com/javase/7/docs/technotes/guides/jweb/packagingAppsForMac.html)以获取分步指南。

Note that a Mac app is a directory with the extension ".app". Inside of that directory you will find Contents/Info.plist file. This will contains your JVM args and other Java related info. If you continue to have problems this may be a good place to start investigating (and it would help others to answer your question as well).

# string - 如何使用所有字符串运行函数？

> ID：15718434
> 
> 赞同：0
> 
> 时间：2013-03-30T12:18:21.390
> 
> 标签：string, bash

我正在尝试创建一个程序来运行一个创建最大 N 长度字符串的函数，其中包含一些字符
例如输入“AB”（A 和 B 字符可能）和 3（最大长度）：（ `A AA AAA AAB AB ABA ABB ... BB BBA BBB` 顺序无关紧要)

我发现了这个： [Bash string handling (char at index and concatenation)](https://stackoverflow.com/questions/349702/bash-string-handling-char-at-index-and-concatenation)
答案仅适用于 2 长度的字符串，我想以 10 长度和 20 个字符运行它。（我有时间运行这个:)）
有没有办法做到这一点？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T18:39:21.843

一个 Bash 解决方案：

```
chars='{A,B}'                         # characters to use
cnt=6                                 # maximum length
str=''
for (( CNTR=0; CNTR<$cnt; CNTR+=1 )); do
  str=$str$chars
  eval echo "$str"
done 
```

字符列表可以扩展，例如

```
chars='{A,B,C}' 
```

输出：

```
A B
AA AB BA BB
AAA AAB ABA ABB BAA BAB BBA BBB
AAAA AAAB AABA AABB ABAA ABAB ABBA ABBB BAAA BAAB BABA BABB BBAA BBAB BBBA BBB 
```

cnt=20 需要几秒钟并设置 {A,B}。

# c# - BackgroundImage 的大小调整为比原始 *.png 大 130%

> ID：15718442
> 
> 赞同：1
> 
> 时间：2013-03-30T12:19:03.463
> 
> 标签：c#, pdf-generation, aspose

我正在尝试使用 aspose.pdf 为 .NET 5.0.0 版制作一个 pdf 文件。

我的代码如下所示：

```
 var license = new License();
        license.SetLicense("path/My.lic");

        var document = new Pdf();
        document.Security = new Security();
        document.Security.IsAnnotationsModifyingAllowed = false;

        //Restrict contents modification
        document.Security.IsContentsModifyingAllowed = false;

        //Restrict copying the data
        document.Security.IsCopyingAllowed = false;

        //Allow to print the document
        document.Security.IsPrintingAllowed = true;

        //Restrict form filling
        document.Security.IsFormFillingAllowed = false;
        document.GraphInfo.Flatness = 1;

        Section mainSection = document.Sections.Add();
        //var signature = new Image(mainSection);
        //signature.ImageInfo.File = "path/MyBackgroundImage.png";
        //signature.ImageInfo.ImageFileType = ImageFileType.Png;

        mainSection.BackgroundImageFile = "path/MyBackgroundImage.png";
        mainSection.BackgroundImageType = ImageFileType.Png;
        mainSection.PageInfo.PageWidth = 1052*72*32;//PageSize.A4Width;
        mainSection.PageInfo.PageHeight = 744 * 72 * 32;//PageSize.A4Height;
        document.SetUnicode();
        document.Save("path/Name.pdf"); 
```

问题是应该作为背景图像传递的图像即使在我传递精确点值时也会调整大小`PageWidth`（`PageHeight`我发现 aspose 以点而不是像素为单位获取大小。转换取决于图片的 dpi，在我的情况下等于每英寸 32 个，所以：`Points = Pixels * 72 * 32`对于我来说）

我的图片大小为 1052 像素宽 * 744 像素，扩展名为 32 dpi *.png；

我应该在我的代码中进行哪些更改以使其正常工作？

如果需要任何进一步的信息，请询问。

先谢谢了：）

# backbone.js - Why is 'reset' event not triggered on Collection.fetch() in Backbone 1.0.0

> ID：15718443
> 
> 赞同：2
> 
> 时间：2013-03-30T12:19:12.207
> 
> 标签：backbone.js

I have a collection view with the followig code:

```
class FoosCollectionView extends Backbone.View
  el: '#foos'

  initialize: ->
    @collection = new FoosCollection [],
      barId: @options.barId
      foozId: @options.foozId

    @listenTo @collection, 'sync', @render
    @collection.fetch()

  template: MyApp.Templates.foos

  render: (event)->
    $(@el).html @template @collection
    @

FoosCollectionView 
```

Before Backbone 1.0.0 a `reset` event was triggered when `fetch` on a collection completed. Now the `sync` event is triggered, but I dont know if this is due to a bug or if it is new standard behaviour.

Can anyone tell me, why `reset` is not triggered anymore?

Regards Felix

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-30T12:26:16.507

In the 1.0.0 changelog, I see:

> Renamed Collection's "update" to set, for parallelism with the similar model.set(), and contrast with reset. **It's now the default updating mechanism after a fetch.** If you'd like to continue using "reset", pass {reset: true}.

# android - 新的 Android 开发人员，项目/应用程序未运行，AVD 问题

> ID：15718448
> 
> 赞同：1
> 
> 时间：2013-03-30T12:19:27.193
> 
> 标签：android, adt, avd

我是 Android 开发新手，很难运行我的第一个“Hello World”应用程序。[我从http://developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)下载了 ADT Bundle 。创建了一个项目，但根本无法运行它。有2个问题，

1）在Eclipse中，当我点击“运行->运行”时，什么也没有发生。没有运行

2）在互联网上环顾四周，几次，我设法“跑步”。但随后模拟器打开，我可以看到闪亮的“Android”字样出现，但之后没有任何反应。试图从一些互联网提示中解决这个问题并返回问题 1（没有运行）

我下载的 Bundle 适用于 Android 4.2.2，API 级别 17。尝试了 RAM（512MB、256 MB）、内部存储（100MB、200MB、512MB）、SD 卡大小（512MB、2GB）、设备（例如 3.7）的各种设置“ FWVGA 滑块等）。感觉就像我在黑暗中击中。几次从任务管理器中杀死 adb.exe，几次从“c:\Users\.android”中删除“avd”文件夹以解决上述两个问题中的任何一个，但没有运气。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-17T20:10:28.860

我不知道为什么，但我不得不再次关闭并重新打开 Android 虚拟设备管理器，它有一个对话框询问 LogCat。当我按下是时，它开始工作。不知道为什么。一定是处于某种故障 IDE 状态。（测试 Ubuntu 14.04）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T19:59:15.143

我也在 Windows 上编写我的第一个应用程序，但它没有在模拟器上运行，我看到了你的帖子，经过几次尝试和几个小时，它确实有效，所以我来告诉我做了什么，希望它对你：

在尝试并尝试使用模拟器之后，我插入了一个朋友的手机，他有一个 android lg l9，它实际上安装了所有驱动程序，而我没有寻找它们（Windows XP SP3，我知道的坚果，但它是我的工作计算机）。因此，我将其插入并尝试按照文档说明运行，但什么也没有。但是在左侧有一个带有项目名称的“包资源管理器”选项卡（如果不可见，请在“窗口->显示->包资源管理器”中打开它），所以右键单击 urs 和那里我会找到“运行方式”选项，选择“Android 应用程序”（我再次认为是废话，这与我之前按下的那个大播放图标有什么不同），但这次成功了！！！该应用程序显示在真实的手机中。然后我再次尝试使用之前不起作用的播放图标，现在它可以工作了，控制台显示活动和东西。作为记录，我的朋友选择了手机中的“媒体存储”选项，当我们将他的手机插入电脑后立即出现提示时。

但最令人惊讶的是，在那之后，我拔掉了手机，打开了一个 AVD 模拟器，就像手册上说的那样（[http://developer.android.com/training/basics/firstapp/running-app.html](http://developer.android.com/training/basics/firstapp/running-app.html)），瞧，模拟器现在正在运行示例应用程序。所以我真的不想认为开发人员需要这样做才能测试应用程序，当然，如果您希望您的应用程序公开，无论如何您都必须对其进行真实测试，但是要弄清楚留下了多少错误在这个 adt 包里面。

我真的希望这对你有用。

# css - 在 HTML 中，如果一个 div 被显式设置，如何获取宽度的剩余部分？

> ID：15718452
> 
> 赞同：4
> 
> 时间：2013-03-30T12:20:06.320
> 
> 标签：css, html

我试图在 HTML 页面中水平对齐两个 div 元素：一个是左侧的导航菜单，明确设置为 180px 宽，右侧是主页内容。有没有办法让正确的 div 占据剩余的宽度？到目前为止我的代码如下，但将`section`div 放在 div 下方`nav`而不是放在它旁边。

HTML：

```
<div class="nav"> </div>
<div class="section"> </div> 
```

CSS：

```
div.nav {
    float: left;
    height: auto;
    width: 180px;
}

div.section {
    float: right:
    height: auto;
    width: 100%;
    margin-left: 180px; 
```

我最初尝试设置`position`to`fixed`和`height`to `100%`：这给出了正确的布局，但没有垂直滚动！我还尝试将导航 div 设置为`float`在`left`没有设置宽度时起作用，但没有填满屏幕的其余部分（为清楚起见，省略了颜色）。

如果可能的话，我想避免使用表格。另外，我很欣赏这两个 div 元素可以用 HTML5`<nav>`和`<section>`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:25:54.147

我的解决方案是浮动菜单，然后在另一个 div 上设置“补偿”填充。

[http://jsfiddle.net/D5qfY/12/](http://jsfiddle.net/D5qfY/12/)

HTML：

```
<nav class="menu"> </nav>
<section class="something"></section> 
```

CSS：

```
nav.menu {
float: left;
width: 180px;
background: yellow;
height:400px;
}

section.something {
padding-left: 180px;
width: 100%;
height: 400px;
background: red;
box-sizing: border-box;
} 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:37:39.690

试试这个例子。这对你有用。

**CSS**

```
 #left {
    display: table-cell;
    min-width: 160px;
   border:1px solid #000;
}
#right {
    display: table-cell;
    width: 100%;
    vertical-align: top;
    border:1px solid #ccc;
  /*text-align:right;*/
} 
```

**html**

```
<nav id="left">
    Left
</nav>
<section id="right">
    right
</section > 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:57:29.847

You don't need to float both containers. You can float the nav and let the other container automatically fill the full size of the parent. The *overflow* property can help with positioning and spacing.

```
.nav {
    background: lightgrey;
    float: left;
    padding: 10px;
    width: 180px;           
}

.section {
    background: grey;
    overflow: auto;
    padding: 10px;
} 
```

You can wrap both inside a parent container to control the width of both containers.

```
.contain {
    margin: 0 auto;
    width: 980px;
    border: 1px solid;
    overflow: auto;
}

<div class="contain">
    <div class="nav"> nav </div>
    <div class="section"> section </div>    
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-16T09:57:28.480

使用浮动/溢出隐藏方法

HTML：

```
 <nav class="menu">Menu</nav>
    <section class="something">Remainder</section> 
```

CSS：

```
.menu {
    float: left;
    width: 180px;
    background: yellow;
    height:400px;
}

.something {
    background: red;
    float: none;
    overflow: hidden;
    display: block;
    zoom: 1;
} 
```

小提琴：http: [//jsfiddle.net/passionatepaul/YC87B/](http://jsfiddle.net/passionatepaul/YC87B/)

其他方法可以在[http://css-response.com/css-remainder/找到](http://css-response.com/css-remainder/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-30T12:59:06.077

您应该`width: auto;`为您的`section`. 或者设置为：

```
<div class="wrap">
<div class="nav"></div>
<div class="section"></div>
</div> 
```

css...

```
div.wrap{background: red; width: 100%;display: inline-block;}
div.nav {
    float: left;
    height: auto;
    width: 180px;
    background-color: blue;
}

div.section {
    float: right:
    height: auto;
    width: auto;
    margin-lef/t: 180px; /* this need not to place coz you have floated it right*/
} 
```

看到这个**[小提琴](http://jsfiddle.net/ymEK9/1/)**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-30T12:27:40.363

删除`margin-left: 180px;` 这将使正确的 div 适合 remaning 屏幕
[http://jsfiddle.net/D5qfY/embedded/result/](http://jsfiddle.net/D5qfY/embedded/result/)
[http://jsfiddle.net/D5qfY/5/embedded/result/](http://jsfiddle.net/D5qfY/5/embedded/result/)
[http://jsfiddle.net/D5qfY /6/embedded/result/](http://jsfiddle.net/D5qfY/6/embedded/result/) 从 url 中
**移除以查看代码** `embedded/result/`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-30T12:30:33.653

试试这个，它对我有用：

```
div.nav {
    float: left;
    width: 10%;
}

div.section {
    float: right:
    width: 90%;
} 
```

抱歉，帮不了其他人，我不知道导航和部分。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-30T12:31:51.277

最简单的方法是为您的元素提供表格的行为。

[http://jsfiddle.net/AcMc5/2/](http://jsfiddle.net/AcMc5/2/)

```
.container {
    display: table;
    width: 100%;
}

nav, section {
    display: table-cell;
}

nav {
    width: 12em;
    background: #CCC;
}

<div class="container">
    <nav>Nav</nav>
    <section>Lorem ipsum dolor sit amet...</section>
</div> 
```

或者，您不能浮动应该占用剩余宽度的元素：

[http://jsfiddle.net/D5qfY/3/](http://jsfiddle.net/D5qfY/3/)

```
section {
    background: #F00;
    margin-left: /* width of floated sibbling */;
} 
```

# javascript - Content under fixed header and navbar when scrolling

> ID：15718456
> 
> 赞同：0
> 
> 时间：2013-03-30T12:20:34.937
> 
> 标签：javascript, jquery, css

I want the header and navbar to be fixed when scrolling on my site. I can make these both fixed, however the content in the #container div doesn't appear under them.

I currently use the following to make the content of my site appear below the header but not sure how to calculate the margintop for the #header AND #navbar ids.

```
#header{
    width:100%;
    position:fixed;
    top:0px;
}

#navbar{
    width:100%;
    height:50px;
    margin:auto;
    position:fixed;
    top:120px;
}

$(document).ready(function () {
                    $('#container').css('marginTop', $('#header').outerHeight(true) );

                }); 
```

Thanks for your help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:39:23.197

```
 $(document).ready(function () { $('#container').css('marginTop', $('#header').outerHeight(true) + $('#navbar').outerHeight(true) ); }); 
```

# mysql - Java MySQL 查询线程不断增加内存使用量

> ID：15718459
> 
> 赞同：2
> 
> 时间：2013-03-30T12:21:00.147
> 
> 标签：mysql, multithreading, memory

我有一个名为 QueryTest 的方法，它通过网络查询 MySQL 数据库以获取名为 output 的表。从一开始，这个方法在运行时会不断消耗更多的内存，直到最终遇到内存不足的错误。我已经删除了我能想到的所有内容，甚至将查询放入一个有 500 毫秒超时的循环中，但仍然没有运气。

该程序旨在在低内存设备上运行，因此我不能让它继续增加内存使用量。

请在下面查看我的代码。这个类被另一个只包含new Thread(new QueryTest()).start()的类调用，没有其他作用。

编辑1：如果我添加 System.gc (); 就在 Thread.sleep 之前，它为我的程序增加了大约 7mb，但问题消失了。我知道该方法只能暗示垃圾收集器，所以这是一个可靠的解决方法吗？

```
// Add the main package
package DBTest;

// Import List
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.Statement;

public class QueryTest implements Runnable
{
    // Constant Objects
    public static Connection connection = null;
    ResultSet rs;
    ResultSetMetaData rsmd;
    Statement s;

    // Variables
    int portA = 0;
    int size = 0;
    String outputs [][] = new String [0][5];
    boolean isRunning = true;
    boolean isPaused = false;

    // The main method for starting the thread
    public void run ()
    {       
        // Try to connect to the database and query the updates
        try
        {       
            // Load the database driver
            Class.forName("com.mysql.jdbc.Driver").newInstance();       

            // Connect to the database
            connection = DriverManager.getConnection ("jdbc:mysql://192.168.1.103/noah", "root", "0004e5dcb6a");
            System.out.println ("Connection Made");

            // let the loop run while the thread is allowed to run
            while (isRunning)
            {       
                // Query the database if the thread is not paused
                if (!isPaused)
                {
                    // Create a prepared statement
                    s = connection.createStatement ();

                    // Execute the query and store the results
                    rs =  s.executeQuery ("SELECT * FROM outputs");

                    // Get the result set meta data
                    rsmd = rs.getMetaData();

                    // Set the result set to the last row
                    rs.last();

                    // Get the last row number
                    size = rs.getRow();

                    // Set the result set to the last row
                    rs.first();

                    /*// Get port A values
                    for (int a = 0; a < 8; a ++)
                    {
                        // Check if the output is active
                        if (Integer.parseInt(outputs [a][4]) == 1)
                        {
                            // Add to the port
                            portA = portA + Integer.parseInt (outputs [a][3]);
                            System.out.println (portA);
                        }
                    }*/

                    // Set the value of portA
                    portA = 0;
                }

                // Let the thread sleep
                Thread.sleep (500);
            }   

            // Close the connection
            connection.close();
            System.out.println ("Connection Closed");   
        }

        // Catch a error
        catch (Exception queryDatabaseErr)
        {
            System.out.println (queryDatabaseErr);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:23:10.493

关闭语句，并在不需要时释放结果集。在循环的 and 处。

```
 ...
    rs.close();  //free result set
    s.close();   //close the statement
    Thread.sleep(500)
} 
```

我的 java 应用程序中有相同的 propbem。有时我在下面写的解决方案没有帮助。但是在我开始使用其他数据库库后：http: [//sourceforge.net/projects/c3p0/](http://sourceforge.net/projects/c3p0/)，内存使用量急剧下降，应用程序运行速度更快。它使用持久连接，所以我推荐它只使用控制台或桌面应用程序，而不是 Java Servlet Pages。

我推荐阅读这个主题： [Java MySQL JDBC Memory Leak](https://stackoverflow.com/questions/5765990/java-mysql-jdbc-memory-leak) ;)

After you installed or added the C3P0 lib to your project just import:

```
import com.mchange.v2.c3p0.ComboPooledDataSource;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement; 
```

After this you does not have to change your code (as i remember but you should read the manual of this lib [http://www.mchange.com/projects/c3p0/apidocs/com/mchange/v2/c3p0/ComboPooledDataSource.html](http://www.mchange.com/projects/c3p0/apidocs/com/mchange/v2/c3p0/ComboPooledDataSource.html))

# dart - dart (lang) 对停用的 javaScript 没用吗？

> ID：15718460
> 
> 赞同：-1
> 
> 时间：2013-03-30T12:21:04.257
> 
> 标签：dart, server-side-validation

在这种情况下，服务器端功能（例如表单验证）呢？我是否还必须在服务器端实现我用 Dart 编写的所有工作？我绝对需要在服务器端有一个“兼容飞镖”的连接点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T03:54:58.330

Dart 可以在客户端和服务器上运行。

在客户端（在 Web 浏览器中）运行时，您可以在 Dart VM 中运行 Dart 代码，也可以将 Dart 应用程序编译为 JavaScript。

在服务器上运行 Dart 时，可以在 Dart VM 中运行 Dart 代码。Dart VM 在命令行上运行，可以访问文件、目录、套接字、HTTP 服务器，甚至是 Web 套接字。

因此，即使您需要支持已关闭 JavaScript 的 Web 浏览器，Dart 也很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:24:15.177

目前 Dart 编译为 JavaScript，因此如果在浏览器中禁用它，客户端脚本将无法工作。它不会对服务器端脚本产生任何影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:29:21.073

无论您使用什么客户端语言，您总会找到一些没有它的用​​户（即禁用的 javascript）。

因此，服务器端验证是必须的，在小型应用程序中也是如此，尤其是出于安全原因。

# java - java 通过窗口名称/标题访问窗口/Jframe

> ID：15718463
> 
> 赞同：1
> 
> 时间：2013-03-30T12:21:20.533
> 
> 标签：java, swing, pointers, window, setfocus

我有一个字符串数组，我想在 Jframes 中打印字符串。我使用 for 来调用另一个类，它将创建一个带有 Jpanel 的 Jframe。它是这样的：

```
for(int i=0;i!=v.length;i++){  
  (...)
  NewWindow wind = new NewWindow();
} 
```

问题是当我想关闭其中一个 Jframe 时。我知道标题/窗口名称，但我丢失了指针，因为风仅对创建的最后一个 Jframe 有效。

我不知道另一种方法来创建未知数量的 Jframe，而不会丢失指针或获得 Jframe 的焦点。在java中可以吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T12:24:59.783

为什么不只保留对 windows 的引用？

```
NewWindow[] windows = new NewWindow[v.length];
for (int i = 0; i < v.length; i++) {
    // (...)
    windows[i] = new NewWindow();
} 
```

或者，或者：

```
ArrayList<NewWindow> windows = new ArrayList<NewWindow>(v.length);
for (int i = 0; i < v.length; i++) {
    // (...)
    windows.add(new NewWindow());
} 
```

编辑：或者根据skirsch的回答，如果您希望能够通过字符串的值访问窗口，请使用`Map<String, NewWindow>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:24:15.930

有人可能会反对您显示多个 JFrame 的 GUI 设计（相信我，我确实对此有一些重大问题），但暂时搁置这一点，您遇到的基本问题是您正在尝试使用单个引用变量引用一堆对象。解决方案是不使用一个对单个 JFrame 的引用，而是使用一个`ArrayList<JFrame>`或其他集合来引用多个对象。在创建和显示 JFrame 时，将其放入集合中，然后当对象从视图中移除时，当然要确保将对象从集合中移除。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-30T12:27:53.760

您可以使用地图来保留参考。例如定义

```
Map<String,NewWindow> windows = new HashMap<String,NewWindow>();
for (int i=0; i != v.length; i++) {
  NewWindow wind = new NewWindow();
  windows.put(v[i], wind);
} 
```

And later on get a reference to the window with something like that

```
String titleName = ...
NewWindow wind = windows.get(titleName);
// close window 
```

But seriously... how many windows will you open?

# jquery - Zepto JS 使我的 phonegap 应用程序中的滚动无响应

> ID：15718466
> 
> 赞同：5
> 
> 时间：2013-03-30T12:21:41.750
> 
> 标签：jquery, cordova, zepto

其他人以前有这个吗？

滚动工作......但如果你滚动得太快，页面就会保持静止。你需要慢慢来。

我也知道它是 zepto，就好像我*只*使用导入的 zepto 库创建了一个新页面（甚至没有从中调用任何东西），它的行为方式是这样的。删除它，滚动再次完美！

什么给了...我认为 zepto 应该只是一个简约的类 jQuery 库...但即使是完整的 jQuery 库也不妨碍我像这样滚动！

* * *

解决了，反正对我来说。

检查下面的评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-14T01:37:36.073

这确实发生在带有 Zepto Touch 的 Android 上。在PhoneGap应用程序上拉了我几个小时的头发，然后在这里跌跌撞撞，发现问题出在Zepto上。（添加后我在iOS上没有问题`-webkit-overflow-scrolling: touch`）

这是我的解决方法：

```
$('.scrolling').bind('touchmove', function(e) { e.stopPropagation(); } 
```

这阻止了 Zepto 检查意外触摸发生在某些启用了滚动的 div 上（在这种情况下，使用手动“滚动”类）对我来说，但 YMMV。

# c# - HttpRequest vs HttpRequestMessage vs HttpRequestBase

> ID：15718468
> 
> 赞同：60
> 
> 时间：2013-03-30T12:22:11.187
> 
> 标签：c#, asp.net, asp.net-mvc, httprequest

What are differences between these classes in ASP.NET? As I discovered there is no inheritance relationship between these classes.

Below code returns an instance of `HttpRequestWrapper` which `is a` `HttpRequestBase` and `has a` `HttpRequest`

```
HttpRequestMessage request = ...;
HttpRequestBase reqBase = (request.Properties["MS_HttpContext"] as HttpContextWrapper).Request;
// do somthing with reqBase.Cookies 
```

It seems like Microsoft wanted to annoy us while reaching cookies from HttpRequestMessage.

Is it guaranteed that `request.Properties["MS_HttpContext"]` will never be null?

Or think that an ajax request is handled in an action of ApiController. I can reach IP of the client with two different ways.

```
var ip = (request.Properties["MS_HttpContext"] as HttpContextWrapper).Request.UserHostAddress

var ip = HttpContext.Current.Request.UserHostAddress 
```

What is the difference between these two?

Or in general, I can access same request/response data such as Cookie, Header, Requestor Info etc. in different ways. When to use which? Can we say something like "if it is an ajax request, HttpRequest is not guaranteed to work properly because of lack of something so for ajax requests we should use HttpRequestMessage instead"?

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-04T20:28:38.273

[HttpRequest](http://msdn.microsoft.com/en-us/library/system.web.httprequest.aspx) is present on the [Page](http://msdn.microsoft.com/en-us/library/system.web.ui.page.aspx) and [UserControl](http://msdn.microsoft.com/en-us/library/system.web.ui.usercontrol.aspx) classes as a GET-only property. Similarly, most of its own properties are also GET-only (see [1](http://msdn.microsoft.com/en-us/library/system.web.httprequest.aspx)). This class is used by ASP.NET pages to get information about the incoming http request, e.g. read the client IP, cookies, the query string, whatnot. Importantly, it is part of the "Old" System.Web assembly, which has been around since .NET 1.1

[HttpRequestMessage](http://msdn.microsoft.com/en-us/library/system.net.http.httprequestmessage.aspx), on the other hand, is new in .NET 4.5\. It is part of [System.Net](http://msdn.microsoft.com/en-us/library/system.net.aspx). It can be used both by clients and services to create, send and receive requests and responses over HTTP. It replaces [HttpWebRequest](http://msdn.microsoft.com/en-us/library/system.net.httpwebrequest.aspx), which is obsolete in .NET 4.5

On HttpRequestBase and HttpRequestWrapper, best I can do is to just quote the [docs](http://msdn.microsoft.com/en-us/library/system.web.httprequestwrapper.aspx)

> The HttpRequestWrapper class derives from the HttpRequestBase class and serves as a wrapper for the HttpRequest class. This class exposes the functionality of the HttpRequest class and exposes the HttpRequestBase type. The HttpRequestBase class enables you to replace the original implementation of the HttpRequest class in your application with a custom implementation, such as when you perform unit testing outside the ASP.NET pipeline.

# mysql - mysqldump 以错误的字符集导出数据

> ID：15718477
> 
> 赞同：6
> 
> 时间：2013-03-30T12:24:06.677
> 
> 标签：mysql, utf-8, character-encoding, mysqldump, latin1

昨天第一次导出Mysql数据库，发现dump中有一些很奇怪的字符，比如：

```
INSERT INTO `piwik_archive_blob_2013_01` VALUES (15,'Actions_actions_url_6',1,'2013-01-17','2013-01-17',1,'2013-01-20 07:36:53','xuNM0ý/œ#&ÝÕ³\ZõNYpÊÀì#!üw7HÐ¶ïœŽ}°ÀAáZoN*šgµ\'GWª[Yûðe¯57 ÃÁÆ7|Ÿ\'Ü%µDh©-EÛ^ËL±ÕÞtªk@(,b±ßZ.ÒÃ6b²aiÓÍ)87[­ïÎœ,æya¥uÒ<|+íª7MNuïÝ¿8ñ%1Æ±>Ú­X'); 
```

我的服务器 MySQL 的版本是：5.1.66-0+squeeze1 (Debian)。该数据库由[Piwik](http://www.piwik.org)安装脚本自动创建。

这是我试图解决此问题的方法：

**#1** 首先我检查了数据库字符集。

```
> show table status; 
```

26 个表的排序规则 utf8_general_ci 听起来很正常。我猜 mysqldump 以不同的字符集（latin1？）导出，所以我尝试了：

```
mysqldump -u user -p**** --all-databases --default-character-set=utf8 | gzip -9 > dump.sql.gz 
```

**结果**= 我仍然有相同的奇怪字符。

注意）后来我了解到mysqldump的默认字符集是utf8，无论服务器默认字符集如何。所以`--default-character-set=utf8`没用。

**#2** 然后我想我可以通过更新 mysql conf 来解决问题。原来的conf是：

```
mysql> show variables like "%character%";show variables like "%collation%";

+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | latin1                     |
| character_set_connection | latin1                     |
| character_set_database   | latin1                     |
| character_set_filesystem | binary                     |
| character_set_results    | latin1                     |
| character_set_server     | latin1                     |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
+----------------------+-------------------+
| Variable_name        | Value             |
+----------------------+-------------------+
| collation_connection | latin1_swedish_ci |
| collation_database   | latin1_swedish_ci |
| collation_server     | latin1_swedish_ci |
+----------------------+-------------------+ 
```

所以我更新`/var/lib/mysql/my.cnf`并添加了：

```
[mysqld]
init_connect='SET collation_connection = utf8_general_ci'
init_connect='SET NAMES utf8'
character-set-server=utf8
collation-server=utf8_general_ci
default-character-set=utf8
default-collation=utf8_general_ci

[mysqldump]
default-character-set=utf8 
```

然后

```
/etc/init.d/mysql restart
mysql> show variables like "%character%";show variables like "%collation%";

+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | latin1                     |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | utf8                       |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
+----------------------+-------------------+
| Variable_name        | Value             |
+----------------------+-------------------+
| collation_connection | utf8_general_ci   |
| collation_database   | latin1_swedish_ci |
| collation_server     | utf8_general_ci   |
+----------------------+-------------------+ 
```

**结果**= 相同的奇怪字符。

**#3** 我改变`character_set_database`了`collation_database`：

```
mysql> ALTER DATABASE piwik default character SET utf8 collate utf8_general_ci;

mysql> show variables like "%character%";show variables like "%collation%";

+--------------------------+----------------------------+
| Variable_name            | Value                      |
+--------------------------+----------------------------+
| character_set_client     | utf8                       |
| character_set_connection | utf8                       |
| character_set_database   | utf8                       |
| character_set_filesystem | binary                     |
| character_set_results    | utf8                       |
| character_set_server     | utf8                       |
| character_set_system     | utf8                       |
| character_sets_dir       | /usr/share/mysql/charsets/ |
+--------------------------+----------------------------+
+----------------------+-----------------+
| Variable_name        | Value           |
+----------------------+-----------------+
| collation_connection | utf8_general_ci |
| collation_database   | utf8_general_ci |
| collation_server     | utf8_general_ci |
+----------------------+-----------------+ 
```

**结果**= 相同的奇怪字符。

**#4** 我现在明白了，我应该在创建数据库**之前将 MySQL (latin1) 中的默认字符集更改为 utf8。**

排序规则`utf8_general_ci`(#1) 表示数据存储在 utf8 中。但是，mysqldump 是否有可能认为数据存储在 latin1 中并以 utf8 编码数据？这意味着最后数据是双 utf8 编码的（叹气）。在这种情况下，我该如何解决问题？

谢谢你的帮助。

ps) 我想知道为什么 Piwik 不需要将数据库默认字符集更改为 utf8。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-22T22:30:39.407

根据表名“piwik_archive_blob_2013_01 **”**，我猜包含奇怪字符的列是BLOB类型。

BLOB 列包含二进制数据。这就是为什么它包含这些奇怪的字符。这是意料之中的。

别担心，我很确定 MysqlDump 知道如何转储这些数据。

干杯，埃里克。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-18T12:44:01.450

可能是操作系统在导出期间更改了字符集并忽略了默认字符集参数。

要确保导出未使用操作系统字符集，请使用参数 result-file

# web-crawler - 新站点的爬虫/蜘蛛检测

> ID：15718481
> 
> 赞同：3
> 
> 时间：2013-03-30T12:24:26.670
> 
> 标签：web-crawler

我有使用 c# 和 vb.net 的良好开发经验，但我需要一些指导。我想开发类似搜索引擎的蜘蛛和爬虫，但我不知道如何：

1.  如何检测网络中的新网站？就像谷歌在网站启动时检测和抓取网站一样？
2.  如何检测添加到任何网站的新页面？我可以检测和解析网站的所有页面，但需要时间吗？如何检测新添加的页面？
3.  如何检测修改的页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:31:20.897

以下链接可能有用

[http://www.makeuseof.com/tag/build-basic-web-crawler-pull-information-website/](http://www.makeuseof.com/tag/build-basic-web-crawler-pull-information-website/)

[http://www.bitrepository.com/how-to-create-a-simple-web-data-extractor.html](http://www.bitrepository.com/how-to-create-a-simple-web-data-extractor.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:58:51.570

我不太了解 c# id，首先编写在 google 上运行 site:"www.spiderthissite.com" 的代码并记录 /locations/ id 也使 reg ex 可以查看链接页面的 html 并查找链接和文件夹位置。

但是，您的问题相当广泛，我只是先给它一个爆炸，然后在您遇到困难时来这里。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:33:04.380

查找新页面的两种主要方法：

1.  站点地图（谷歌这个词以了解更多信息），它还可以指示页面何时更新。
2.  在您正在抓取的另一个页面上注意到指向新站点/页面的链接。

对于您已经知道的页面，您可以使用“If-Modified-Since”HTTP 标头，它告诉服务器如果自您指定的日期以来该页面没有更改，则返回 304 响应。如果页面没有更改，这可以节省您再次下载和解析页面，尽管显然您仍然必须提出请求才能找到它。这就是为什么首选站点地图的原因，您可以立即获得有关整个站点的信息。当然，网站不需要提供它们。

# r - 如何在R中设置坐标轴？

> ID：15718493
> 
> 赞同：0
> 
> 时间：2013-03-30T12:25:21.480
> 
> 标签：r

我得到一个带有以下代码的graph1.jpg，

```
x = seq(-0.25, 1.25, length = 400)
y1=x
plot(x, y1,type="l",ann=FALSE)
text(0.3,0.2,labels="y=x")
mtext("x", 1, at=1.25, line=1)
mtext("y", 2, at=1.25, line=1) 
```

请比较graph1.jpg和graph2.jpg，它们之间有两个主要区别，如何将graph1更改为graph2？

1.将graph1中的坐标轴更改为graph2的坐标轴如何设置坐标的右原点2.graph1
中坐标轴没有箭头
3.使`y`（graph1.jpg中y轴的mtext）水平

这是一个graph1.jpg。 ![在此处输入图像描述](../Images/f59bc6ab8d32f1e2f74e65d3313a4289.png)

这是一个graph2.jpg，也许graph2.jpg 是由gimp 制作的。 ![在此处输入图像描述](../Images/4f0782907b86a52a1845cb41dd1efa63.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:45:37.777

使用`arrows`，`axis`并设置一些`plot`参数，你可以得到这个：

![在此处输入图像描述](../Images/d70892985e1a1d9a20739db806f1c6f9.png)

```
## you call plot without axes, without box, without axes labels
plot(x, y1,type="l",frame.plot=FALSE,
     axes=FALSE,xlab='',ylab='')
## write some text
text(0.3,0.2,labels="y=x")
text(max(x),-0.1,"x")
text(-0.1,max(x),'y')
## draw axes lines with arrows
arrows(min(x), 0, max(x), 0)
arrows(0, min(x), 0, max(x))
## add axes ticks
axis(1,at=c(0,0.5,1),pos=0)
axis(2,at=c(0,0.5,1),pos=0) 
```

# javascript - 在 jquery 操作后获取 html

> ID：15718497
> 
> 赞同：0
> 
> 时间：2013-03-30T12:26:07.187
> 
> 标签：javascript, jquery, delegates, append

相当新的jQuery。

我有一个页面设置，用户单击按钮，将文本内容添加到 div。

然后我想检索这个 div 的编辑内容，并在页面底部附加另一个 div。

我想过使用：

```
var divcontents = $('#firstdiv').html();
$('#targetDiv').append(divcontents); 
```

但是这不起作用，因为第一个 div 的内容是由 jquery 操作添加的，并且不在核心 HTML 中。

有没有一种简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:54:56.777

I think, you are desynchronized on events executions or your 'firstdiv' is not appended to body. I made this example and works for me. [http://jsfiddle.net/FsrYS/](http://jsfiddle.net/FsrYS/)

```
<div id="targetDiv" style="background-color: red">Target</div>

jQuery(function($) {
    var newDiv = document.createElement("div");
    newDiv.id = 'firstdiv';
    newDiv.innerHTML = 'FirstDiv';
    document.getElementsByTagName('body')[0].appendChild(newDiv);
    var divcontents = $('#firstdiv').html();
    $('#targetDiv').append(divcontents);
}); 
```

# c++ - C++11 why is the move constructor called before returning a temporary object

> ID：15718498
> 
> 赞同：4
> 
> 时间：2013-03-30T12:26:15.203
> 
> 标签：c++, c++11

I'm studying C++11 and I don't understand why in the following code

```
class X
{
    std::vector<double> data;
public:
    // Constructor1
    X():
        data(100000) // lots of data
    {}

    // Constructor2
    X(X const& other): // copy constructor
        data(other.data)   // duplicate all that data
    {}

    // Constructor3
    X(X&& other):  // move constructor
        data(std::move(other.data)) // move the data: no copies
    {}

    X& operator=(X const& other) // copy-assignment
    {
        data=other.data; // copy all the data
        return *this;
    }

    X& operator=(X && other) // move-assignment
    {
        data=std::move(other.data); // move the data: no copies
        return *this;
    }

};

X make_x() // build an X with some data
{
    X myNewObject; // Constructor1 gets called here
    // fill data..
    return myNewObject; // Constructor3 gets called here
}

int main()
{
    X x1;
    X x2(x1); // copy
    X x3(std::move(x1)); // move: x1 no longer has any data

    x1=make_x(); // return value is an rvalue, so move rather than copy
} 
```

in the line

```
return myNewObject; // Constructor3 gets called here 
```

the Constructor3 gets called. Why?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T13:18:53.680

You see a move construction because your compiler is not doing all the optimization that it is permitted to by the standard.

Nominally, the variable `myNewObject` is move-constructed to the temporary that is the return value of `make_x`, and then the temporary is move-assigned to `x1`. This is what you're seeing.

However, in this case the standard permits something called "move constructor elision". It's basically the same thing as "copy constructor elision", which might be familiar to you from C++03\. It means that the variable `myNewObject` and the temporary that is the return value of `make_x` can be transformed by the compiler into a single object. That leaves just the move assignment.

Apparently your compiler has not done the move elision.

If you expected a copy, then the reason it's a move is that in C++11, a return value that is eligible for copy elision (which this one is), is explicitly required to be moved rather than copied where a move is available. I can't remember the reference, and don't have the standard on hand, so you'll just have to take my word for it.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:31:38.320

```
X make_x() // build an X with some data
{
    X myNewObject; // Constructor1 gets called here
    // fill data..
    return myNewObject; // Constructor3 gets called here
} 
```

`myNewObject` gets destroyed at the end of this function scope, so its ok for the compiler to rip its guts out with a move.

# php - 如何在php jqgrid中指定总计、记录和页面

> ID：15718503
> 
> 赞同：0
> 
> 时间：2013-03-30T12:26:28.677
> 
> 标签：php, jqgrid, jqgrid-php

我有这个 php 代码，我使用 getdocuments 方法连接到 Web 服务，我传递了 limit 、 pageNumber 和可选的过滤器数组，除了记录总数和页码之外，它还返回一个数据数组

我想在 jqgrid 中显示结果，我想带上例如 20 条记录，当用户转到下一页时，带上接下来的 20 条记录。

```
<?php

//ini_set("display_errors","1");
require_once 'grid/jq-config.php';
// include the jqGrid Class
require_once "grid/jqGrid.php";
// include the driver class
require_once "grid/jqGridArray.php";

// include the calendar
require_once "grid/jqCalendar.php"; 

// include the document class 
require_once "lib/document.php";
// include heler.php which contain some helper functions
require_once "lib/helper.php";
// create the array connection
$conn = new jqGridArray();
// Create the jqGrid instance
$grid = new jqGridRender($conn);
// prepare array that contains fileds name which user can filter on 
$fields = array("BatchNumber", "SenderCode","ReceiverCode","DocumentNumber","DocumentType","InResponse","SubmitDate");

if(get_magic_quotes_gpc()){
  $d = stripslashes($_REQUEST["filters"]);
}else{
  $d = $_REQUEST["filters"];
}
$d = json_decode($d);

for($i = 0; $i < count($d->rules); $i++){
    foreach ($fields as $value) {
        if($d->rules[$i]->field == $value){
            $option[$value] == $d->rules[$i]->data;
        }
    }
}

if(isset($_GET["page"])){
 $option["PageNumber"] = $_GET["page"];
}
else{
    $option["PageNumber"] = 1;
}

if(isset($_GET["rows"])){
    $option["Limit"]  = $_GET["rows"];
}   
else{
    $option["Limit"] = LIMIT_DOCUMENT;
}

 $results = Document::getDocuments($option);
 $arrResult = _object_to_array($results);

$documents = $arrResult["Documents"]["DocumentDataModel"];
$totalCount = $arrResult["TotalCount"] ;
$totalPages = ceil($totalCount/ $option["Limit"]);
// Always you can use SELECT * FROM data1
$grid->SelectCommand = "SELECT BatchNumber, SenderCode ,ReceiverCode , DocumentNumber, DocumentType, InResponse, SubmitDate,LastModifiedDate FROM documents";
$grid->dataType = 'json';
$grid->setPrimaryKeyId('BatchNumber');

$grid->setColModel();

//enable subgrid
// Set the parameters for the subgrid
$grid->setSubGrid("subgrid_document_attachments.php",
        array('File Name'),
        array(60),
        array('left')); 

// Enable toolbar searching 
$grid->toolbarfilter = true;
$grid->setFilterOptions(array("stringResult"=>TRUE)); 

$grid->setUrl('grid_documents.php');

$grid->setGridOptions(array(
    "width" => 1124,
    "height" => 400,
    "rowList"=>array(10,20,30,40,50,100),
    "sortname"=>"id",
    "caption" => "Documents", 
    "total" => $arrResult["TotalPages"],
    "records" => $arrResult['TotalCount'],
    "page" => $arrResult['PageNumber'],
));

$grid->setColProperty("BatchNumber", array("label"=>"Batch Number"));
$grid->setColProperty("SubmitDate", array(
    "formatter"=>"date",
    "formatoptions"=>array("srcformat"=>"Y-m-d H:i:s","newformat"=>"m/d/Y")
    )
); 
// format the last modified date 
$grid->setColProperty("LastModifiedDate", array(
    "formatter"=>"date",
    "formatoptions"=>array("srcformat"=>"Y-m-d H:i:s","newformat"=>"m/d/Y")
    )
); 

// add date picker to submit date
$grid->setDatepicker("SubmitDate",array("buttonOnly"=>FALSE));
$grid->datearray = array('SubmitDate');

// Enable navigator
$grid->navigator = true;
// Enable search
$grid->setNavOptions('navigator', array("excel"=>TRUE,"add"=>false,"edit"=>false,"del"=>false,"view"=>false,"csv"=>FALSE, "pdf"=>false));
// Activate single search
$grid->setNavOptions('search',array("multipleSearch"=>false));
// Enjoy

$grid->renderGrid('#grid','#pager',true, null, null, true,true);

?> 
```

我检查了firebug的http请求，{“records”：20，“page”：1，“total”：1}，网格只显示20条记录和1页。我想让它显示 20 条记录并启用分页，这样我就可以按下一步并带来接下来的 20 条记录。我希望这些值类似于 {"total":"56","page":"1","re​​cords":"560"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T15:52:24.267

jqGrid 会将所有信息传递给您的 Web 服务，您需要检索需要显示的正确数据页面。排序索引（sidx）、排序顺序（sord）、页（page）和行（rows）。

您的控制器/Web 服务可以获取此信息，然后从您的数据集中获取适当的数据。

```
 public ActionResult getGridData(string sidx, string sord, int page, int rows, bool _search, string filters) {
   ...
   var pagedDataset = fullDataset.OrderBy(sidx + " " + sord).Skip((page - 1) * rows).Take(rows);

  //then format the pagedDataset for the jqGrid and pass it back. 
```

# android - java.lang.IllegalArgumentException: y must be < bitmap.height()

> ID：15718505
> 
> 赞同：6
> 
> 时间：2013-03-30T12:26:42.493
> 
> 标签：android, android-layout, android-image

I have this method to compare to images that are in **xhdpi** but giving me this error **java.lang.IllegalArgumentException: y must be < bitmap.height()** here is code :

```
 private boolean CompareImages(ImageView im1, ImageView im2){

            boolean bool = false;
            int check = 0, v1, v2, v3, ev1, ev2, ev3;
            Bitmap bitmap1 = ((BitmapDrawable)im1.getDrawable()).getBitmap();
            Bitmap bitmap2 = ((BitmapDrawable)im2.getDrawable()).getBitmap();

            for(int j = 50; j < 160; j = j + 50){
                int pixel = bitmap1.getPixel(j,j);
                int pixel2 = bitmap2.getPixel(j,j);

                int redValue = Color.red(pixel);
                int blueValue = Color.blue(pixel);
                int greenValue = Color.green(pixel);

                v1 = (redValue + greenValue + blueValue)/3;

                int redValue1 = Color.red(pixel2);
                int blueValue2 = Color.blue(pixel2);
                int greenValue2 = Color.green(pixel2);

                ev1 = (redValue1 + greenValue2 + blueValue2)/3;

                if(v1 == ev1){
                    bool = true;
                } else{
                    bool = false;
                }
            }

            return bool;
} 
```

here logcat:

```
03-31 10:53:45.192: E/AndroidRuntime(807): FATAL EXCEPTION: main
03-31 11:29:33.352: E/AndroidRuntime(1574): FATAL EXCEPTION: main
03-31 11:29:33.352: E/AndroidRuntime(1574): java.lang.IllegalStateException: Could not execute method of the activity
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.view.View$1.onClick(View.java:3599)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.view.View.performClick(View.java:4204)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.view.View$PerformClick.run(View.java:17355)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.os.Handler.handleCallback(Handler.java:725)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.os.Looper.loop(Looper.java:137)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.app.ActivityThread.main(ActivityThread.java:5041)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at java.lang.reflect.Method.invokeNative(Native Method)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at java.lang.reflect.Method.invoke(Method.java:511)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at dalvik.system.NativeStart.main(Native Method)
03-31 11:29:33.352: E/AndroidRuntime(1574): Caused by: java.lang.reflect.InvocationTargetException
03-31 11:29:33.352: E/AndroidRuntime(1574):     at java.lang.reflect.Method.invokeNative(Native Method)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at java.lang.reflect.Method.invoke(Method.java:511)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.view.View$1.onClick(View.java:3594)
03-31 11:29:33.352: E/AndroidRuntime(1574):     ... 11 more
03-31 11:29:33.352: E/AndroidRuntime(1574): Caused by: java.lang.IllegalArgumentException: y must be < bitmap.height()
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.graphics.Bitmap.checkPixelAccess(Bitmap.java:1158)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at android.graphics.Bitmap.getPixel(Bitmap.java:1107)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at com.example.gusetheplace.ConductQuiz2.CompareImages(ConductQuiz2.java:794)
03-31 11:29:33.352: E/AndroidRuntime(1574):     at com.example.gusetheplace.ConductQuiz2.onClick_rb4(ConductQuiz2.java:630)
03-31 11:29:33.352: E/AndroidRuntime(1574):     ... 14 more 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-30T12:34:16.590

You're are iterating over `int j = 50; j < 160; j = j + 50`, without checking the real size of the images.

You should use `Bitmap.getHeight()` and `Bitmap.getWidth()` in order to call `Bitmap.getPixel(x,y)` with valid coordinates.

# scala - Scala - 如何打印案例类，如（漂亮打印的）树

> ID：15718506
> 
> 赞同：57
> 
> 时间：2013-03-30T12:27:10.457
> 
> 标签：scala, pretty-print, case-class

我正在使用 Scala Combinators 制作解析器。太棒了。我最终得到的是一长串纠缠的案例类，例如：`ClassDecl(Complex,List(VarDecl(Real,float), VarDecl(Imag,float)))`，只是长 100 倍。我想知道是否有一种以树状方式打印此类案例类的好方法，以便更容易阅读..？（或其他形式的*Pretty Print*）

```
ClassDecl
  name = Complex
  fields =
  - VarDecl
      name = Real
      type = float
  - VarDecl
      name = Imag
      type = float 
```

^ 我想以这样的方式结束

**编辑：奖金问题**

还有一种方法可以显示参数的名称..？喜欢：`ClassDecl(name=Complex, fields=List( ... )`？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-30T13:16:46.933

查看一个名为[**sext**](https://github.com/nikita-volkov/sext)的小型扩展库。它完全出于这样的目的导出[这两个函数](https://github.com/nikita-volkov/sext/blob/master/src/main/scala/sext/package.scala#L118-L173)。

以下是它如何用于您的示例：

```
object Demo extends App {

  import sext._

  case class ClassDecl( kind : Kind, list : List[ VarDecl ] )
  sealed trait Kind
  case object Complex extends Kind
  case class VarDecl( a : Int, b : String )

  val data = ClassDecl(Complex,List(VarDecl(1, "abcd"), VarDecl(2, "efgh")))
  println("treeString output:\n")
  println(data.treeString)
  println()
  println("valueTreeString output:\n")
  println(data.valueTreeString)

} 
```

以下是该程序的输出：

```
treeString output:

ClassDecl:
- Complex
- List:
| - VarDecl:
| | - 1
| | - abcd
| - VarDecl:
| | - 2
| | - efgh

valueTreeString output:

- kind:
- list:
| - - a:
| | | 1
| | - b:
| | | abcd
| - - a:
| | | 2
| | - b:
| | | efgh 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2019-03-06T21:00:20.207

开始`Scala 2.13`，`case class`es （它们是 的实现[`Product`](https://www.scala-lang.org/api/2.13.x/scala/Product.html)）现在提供了一个[`productElementNames`](https://www.scala-lang.org/api/2.13.x/scala/Product.html#productElementNames:Iterator[String])方法，该方法返回其字段名称的迭代器。

结合[`Product::productIterator`](https://www.scala-lang.org/api/2.13.x/scala/Product.html#productIterator:Iterator[Any])提供案例类的值，我们有一种简单的方法来漂亮地打印案例类*而无需反射*：

```
def pprint(obj: Any, depth: Int = 0, paramName: Option[String] = None): Unit = {

  val indent = "  " * depth
  val prettyName = paramName.fold("")(x => s"$x: ")
  val ptype = obj match { case _: Iterable[Any] => "" case obj: Product => obj.productPrefix case _ => obj.toString }

  println(s"$indent$prettyName$ptype")

  obj match {
    case seq: Iterable[Any] =>
      seq.foreach(pprint(_, depth + 1))
    case obj: Product =>
      (obj.productIterator zip obj.productElementNames)
        .foreach { case (subObj, paramName) => pprint(subObj, depth + 1, Some(paramName)) }
    case _ =>
  }
} 
```

对于您的具体情况：

```
// sealed trait Kind
// case object Complex extends Kind
// case class VarDecl(a: Int, b: String)
// case class ClassDecl(kind: Kind, decls: List[VarDecl])

val data = ClassDecl(Complex, List(VarDecl(1, "abcd"), VarDecl(2, "efgh")))

pprint(data) 
```

产生：

```
ClassDecl
  kind: Complex
  decls: 
    VarDecl
      a: 1
      b: abcd
    VarDecl
      a: 2
      b: efgh 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2016-10-14T15:11:25.327

使用 com.lihaoyi.pprint 库。

```
libraryDependencies += "com.lihaoyi" %% "pprint" % "0.4.1"

val data = ...

val str = pprint.tokenize(data).mkString
println(str) 
```

您还可以配置宽度、高度、缩进和颜色：

```
pprint.tokenize(data, width = 80).mkString 
```

文档：[https ://github.com/com-lihaoyi/PPrint](https://github.com/com-lihaoyi/PPrint)

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2019-07-17T16:26:05.017

这是我的解决方案，它极大地改进了[http://www.lihaoyi.com/PPrint/](http://www.lihaoyi.com/PPrint/)处理案例类的方式（参见[https://github.com/lihaoyi/PPrint/issues/4](https://github.com/lihaoyi/PPrint/issues/4)）。

例如它打印这个： [![在此处输入图像描述](../Images/eb83be316ec5a1fffb428aaa4315c5f2.png)](https://i.stack.imgur.com/39AAp.png)

对于这样的用法：

```
 pprint2 = pprint.copy(additionalHandlers = pprintAdditionalHandlers)

  case class Author(firstName: String, lastName: String)
  case class Book(isbn: String, author: Author)
  val b = Book("978-0486282114", Author("first", "last"))
  pprint2.pprintln(b) 
```

代码：

```
import pprint.{PPrinter, Tree, Util}
object PPrintUtils {
  // in scala 2.13 this would be even simpler/cleaner due to added product.productElementNames
  protected def caseClassToMap(cc: Product): Map[String, Any] = {
    val fieldValues = cc.productIterator.toSet
    val fields = cc.getClass.getDeclaredFields.toSeq
      .filterNot(f => f.isSynthetic || java.lang.reflect.Modifier.isStatic(f.getModifiers))
    fields.map { f =>
      f.setAccessible(true)
      f.getName -> f.get(cc)
    }.filter { case (k, v) => fieldValues.contains(v) }
      .toMap
  }

  var pprint2: PPrinter = _

  protected def pprintAdditionalHandlers: PartialFunction[Any, Tree] = {
    case x: Product =>
      val className = x.getClass.getName
      // see source code for pprint.treeify()
      val shouldNotPrettifyCaseClass = x.productArity == 0 || (x.productArity == 2 && Util.isOperator(x.productPrefix)) || className.startsWith(pprint.tuplePrefix) || className == "scala.Some"

      if (shouldNotPrettifyCaseClass)
        pprint.treeify(x)
      else {
        val fieldMap = caseClassToMap(x)
        pprint.Tree.Apply(
          x.productPrefix,
          fieldMap.iterator.flatMap { case (k, v) =>
            val prettyValue: Tree = pprintAdditionalHandlers.lift(v).getOrElse(pprint2.treeify(v))
            Seq(pprint.Tree.Infix(Tree.Literal(k), "=", prettyValue))
          }
        )
      }
  }

  pprint2 = pprint.copy(additionalHandlers = pprintAdditionalHandlers)
}

// usage
pprint2.println(SomeFancyObjectWithNestedCaseClasses(...)) 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-03-30T15:20:54.877

就像解析器组合器一样，Scala 已经在标准库中包含了漂亮的打印机组合器。（**注意**：从 Scala 2.11 开始，该库已弃用。类似的漂亮打印库是[kiama](https://github.com/inkytonik/kiama)开源项目的一部分）。

如果您需要执行“反射”的解决方案，或者您想明确构建打印机，您并没有在您的问题中明确地说出来。（尽管您的“额外问题”暗示您可能需要“反思”解决方案）

无论如何，如果您想使用普通的 Scala 库开发简单的漂亮打印机，就在这里。以下代码是可复制的。

```
case class VarDecl(name: String, `type`: String)
case class ClassDecl(name: String, fields: List[VarDecl])

import scala.text._
import Document._

def varDoc(x: VarDecl) =
  nest(4, text("- VarDecl") :/:
    group("name = " :: text(x.name)) :/:
    group("type = " :: text(x.`type`))
  )

def classDoc(x: ClassDecl) = {
  val docs = ((empty:Document) /: x.fields) { (d, f) => varDoc(f) :/: d }
  nest(2, text("ClassDecl") :/:
    group("name = " :: text(x.name)) :/:
    group("fields =" :/: docs))
}

def prettyPrint(d: Document) = {
  val writer = new java.io.StringWriter
  d.format(1, writer)
  writer.toString
}

prettyPrint(classDoc(
  ClassDecl("Complex", VarDecl("Real","float") :: VarDecl("Imag","float") :: Nil)
)) 
```

**额外的问题**：将打印机包装到类型类中以获得更大的可组合性。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-09-28T20:21:37.087

```
import java.lang.reflect.Field
...

/**
  * Pretty prints case classes with field names.
  * Handles sequences and arrays of such values.
  * Ideally, one could take the output and paste it into source code and have it compile.
  */
def prettyPrint(a: Any): String = {
  // Recursively get all the fields; this will grab vals declared in parents of case classes.
  def getFields(cls: Class[_]): List[Field] =
    Option(cls.getSuperclass).map(getFields).getOrElse(Nil) ++
        cls.getDeclaredFields.toList.filterNot(f =>
          f.isSynthetic || java.lang.reflect.Modifier.isStatic(f.getModifiers))
  a match {
    // Make Strings look similar to their literal form.
    case s: String =>
      '"' + Seq("\n" -> "\\n", "\r" -> "\\r", "\t" -> "\\t", "\"" -> "\\\"", "\\" -> "\\\\").foldLeft(s) {
        case (acc, (c, r)) => acc.replace(c, r) } + '"'
    case xs: Seq[_] =>
      xs.map(prettyPrint).toString
    case xs: Array[_] =>
      s"Array(${xs.map(prettyPrint) mkString ", "})"
    // This covers case classes.
    case p: Product =>
      s"${p.productPrefix}(${
        (getFields(p.getClass) map { f =>
          f setAccessible true
          s"${f.getName} = ${prettyPrint(f.get(p))}"
        }) mkString ", "
      })"
    // General objects and primitives end up here.
    case q =>
      Option(q).map(_.toString).getOrElse("¡null!")
  }
} 
```

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2015-07-09T13:04:36.943

我发现的最好、最简洁的“开箱即用”体验是使用[Kiama 漂亮的打印库](https://bitbucket.org/inkytonik/kiama/src/default/wiki/PrettyPrinting.md)。它不会在不使用其他组合符的情况下打印成员名称，但只有`import org.kiama.output.PrettyPrinter._; pretty(any(data))`你有一个很好的开始：

```
case class ClassDecl( kind : Kind, list : List[ VarDecl ] )
sealed trait Kind
case object Complex extends Kind
case class VarDecl( a : Int, b : String )

val data = ClassDecl(Complex,List(VarDecl(1, "abcd"), VarDecl(2, "efgh")))
import org.kiama.output.PrettyPrinter._

// `w` is the wrapping width. `1` forces wrapping all components.
pretty(any(data), w=1) 
```

产生：

```
ClassDecl (
    Complex (),
    List (
        VarDecl (
            1,
            "abcd"),
        VarDecl (
            2,
            "efgh"))) 
```

请注意，这只是最基本的示例。Kiama PrettyPrinter 是一个非常强大的库，具有一组丰富的组合器，专为智能间距、换行、嵌套和分组而设计。很容易调整以满足您的需求。截至本文发布时，它在 SBT 中可用：

```
libraryDependencies += "com.googlecode.kiama" %% "kiama" % "1.8.0" 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2016-02-21T13:23:25.750

使用反射

```
import scala.reflect.ClassTag
import scala.reflect.runtime.universe._

object CaseClassBeautifier  {
  def getCaseAccessors[T: TypeTag] = typeOf[T].members.collect {
    case m: MethodSymbol if m.isCaseAccessor => m
  }.toList

  def nice[T:TypeTag](x: T)(implicit classTag: ClassTag[T]) : String = {
    val instance = x.asInstanceOf[T]
    val mirror = runtimeMirror(instance.getClass.getClassLoader)
    val accessors = getCaseAccessors[T]
    var res = List.empty[String]
    accessors.foreach { z ⇒
      val instanceMirror = mirror.reflect(instance)
      val fieldMirror = instanceMirror.reflectField(z.asTerm)
      val s = s"${z.name} = ${fieldMirror.get}"
      res = s :: res
    }
    val beautified = x.getClass.getSimpleName + "(" + res.mkString(", ") + ")"
    beautified
  }
} 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2019-02-08T14:12:37.847

这是@F 的无耻复制粘贴。P 自由地，但是

*   我添加了缩进功能
*   稍作修改，以使输出具有正确的 Scala 样式（并且将为所有原始类型编译）
*   修复了字符串文字错误
*   添加了对`java.sql.Timestamp`（因为我经常在 Spark 中使用它）

多田！

```
// Recursively get all the fields; this will grab vals declared in parents of case classes.
  def getFields(cls: Class[_]): List[Field] =
    Option(cls.getSuperclass).map(getFields).getOrElse(Nil) ++
      cls.getDeclaredFields.toList.filterNot(f =>
        f.isSynthetic || java.lang.reflect.Modifier.isStatic(f.getModifiers))

  // FIXME fix bug where indent seems to increase too much
  def prettyfy(a: Any, indentSize: Int = 0): String = {
    val indent = List.fill(indentSize)(" ").mkString

    val newIndentSize = indentSize + 2
    (a match {
      // Make Strings look similar to their literal form.
      case string: String =>
        val conversionMap = Map('\n' -> "\\n", '\r' -> "\\r", '\t' -> "\\t", '\"' -> "\\\"", '\\' -> "\\\\")
        string.map(c => conversionMap.getOrElse(c, c)).mkString("\"", "", "\"")
      case xs: Seq[_] =>
        xs.map(prettyfy(_, newIndentSize)).toString
      case xs: Array[_] =>
        s"Array(${xs.map(prettyfy(_, newIndentSize)).mkString(", ")})"
      case map: Map[_, _] =>
        s"Map(\n" + map.map {
          case (key, value) => "  " + prettyfy(key, newIndentSize) + " -> " + prettyfy(value, newIndentSize)
        }.mkString(",\n") + "\n)"
      case None => "None"
      case Some(x) => "Some(" + prettyfy(x, newIndentSize) + ")"
      case timestamp: Timestamp => "new Timestamp(" + timestamp.getTime + "L)"
      case p: Product =>
        s"${p.productPrefix}(\n${
          getFields(p.getClass)
            .map { f =>
              f.setAccessible(true)
              s"  ${f.getName} = ${prettyfy(f.get(p), newIndentSize)}"
            }
            .mkString(",\n")
        }\n)"
      // General objects and primitives end up here.
      case q =>
        Option(q).map(_.toString).getOrElse("null")
    })
      .split("\n", -1).mkString("\n" + indent)
  } 
```

例如

```
case class Foo(bar: String, bob: Int)

case class Alice(foo: Foo, opt: Option[String], opt2: Option[String])

scala> prettyPrint(Alice(Foo("hello world", 10), Some("asdf"), None))
res6: String =
Alice(
  foo = Foo(
    bar = "hello world",
    bob = 10
  ),
  opt = Some("asdf"),
  opt2 = None
) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2020-01-09T08:09:46.010

如果您使用 Apache Spark，您可以使用以下方法打印您的案例类：

```
def prettyPrint[T <: Product : scala.reflect.runtime.universe.TypeTag](c:T) = {
  import play.api.libs.json.Json
  println(Json.prettyPrint(Json.parse(Seq(c).toDS().toJSON.head)))
} 
```

这为您的案例类实例提供了格式良好的 JSON 表示。确保`sparkSession.implicits._`已导入

例子：

```
case class Adress(country:String,city:String,zip:Int,street:String) 
case class Person(name:String,age:Int,adress:Adress) 
val person = Person("Peter",36,Adress("Switzerland","Zürich",9876,"Bahnhofstrasse 69"))

prettyPrint(person) 
```

给出：

```
{
  "name" : "Peter",
  "age" : 36,
  "adress" : {
    "country" : "Switzerland",
    "city" : "Zürich",
    "zip" : 9876,
    "street" : "Bahnhofstrasse 69"
  }
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-27T18:50:28.103

我建议使用您选择的测试框架的 AssertEquals 中使用的相同打印。我正在使用[Scalameta](https://scalameta.org/)并且 成功`munit.Assertions.munitPrint(clue: => Any): String`了。我可以将嵌套类传递给它，并以适当的缩进查看整个树。

# paypal - Paypal Beta developer site, Existing user account not working

> ID：15718507
> 
> 赞同：0
> 
> 时间：2013-03-30T12:27:11.137
> 
> 标签：paypal, paypal-sandbox

I have a developer account in Paypal, It was working perfectly few days back before the new beta developer site launched. I try to logged in with my credential to new website , but it show me error like:

> Please check your Email Address and PayPal Password and try again.

Even when i try to use forgot your password link it show me the error like:

> We couldn't find your email address. Please try again or select I don't know what email address I used.

Both credential was correct, but i don't know why it's not working. I have searched for that and found some thread that suggested to clear your cookies and cache and try to use chrome or Firefox instead of using Internet Explorer. But no luck ,it's not working either. If someone have any suggestion for that how to solve this, please help me.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:28:37.130

Are you using a live PayPal account to log in?

From developer.paypal.com:

> Please log in with a **PayPal account**. After you log in, you can import your Sandbox test accounts using the email address and password you used previously with the Sandbox.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T01:56:26.883

The is a bug with the "import feature", the form validation of email format fails if emails cannot contain a ".". As my original sandbox email contained a "." i cannot import.

# c++ - VS2010 c++: Change CLSID of COM dll

> ID：15718517
> 
> 赞同：1
> 
> 时间：2013-03-30T12:27:57.843
> 
> 标签：c++, dll, com

I need to change the CLSID for my COM DLL.

I tried to simply change the CLSID in the .rgs file. Is this the valid way, or do I have to do something else?

I am asking because it does not work.

When I change the CLSID in the rgs file, and compile it and then try to use it, I get the "the requested class could not be delivered" error.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:36:22.433

You have to change everything:

*   All references to the CLSID in the DLL that implements the COM server.
*   The registration code.
*   The code that instantiates and consumes the COM server.

I suspect that you didn't manage to get every last reference.

# javascript - 在javascript函数中将数据设置为Label的文本

> ID：15718521
> 
> 赞同：0
> 
> 时间：2013-03-30T12:28:56.760
> 
> 标签：javascript, asp.net

我设置了一个javascript函数来点击LinkBut​​ton的事件，并想在这个函数中设置标签的文本，函数调用并将数据传递给它但是之后当我想从后面的代码中读取该标签的文本时，文本是“”

```
//javascript function
function PopUpFunction(code) {
$("#<%= lblStatus.ClientID %>").text = code;
}

//set function to click event
lnk.Attributes.Add("onclick", "PopUpFunction(10);"); 
```

//编辑

当我单击调用 javascript 函数的链接按钮时，我测试标签（lblStatus），标签文本更改但在后面的代码中不显示此文本（例如，如果标签文本在我再次在 javascript 函数中设置新文本后为 5在文本后面的代码中是 5，虽然实际文本是 10）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:56:04.283

这个对我有用。请检查一下。

**代码背后：少量修改**

```
 ` lnk.Attributes.Add("onclick", "return PopUpFunction('10');"); 
```

**Javascript代码**

```
 `<script type="text/javascript">
    function PopUpFunction(code) {
        $("#lblStatus").text(code);
        $("#lblStatus").show();
        return false;
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-01T18:35:00.260

而不是 Label 使用 HiddenField 并更改 javascript 的功能，如下所示

```
function PopUpFunction(code) {
  $("#<%= lblStatus.ClientID %>").val(code);
  return false;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:36:33.597

试试这个**val() 而不是 text**

```
$("#<%= lblStatus.ClientID %>").Val(code) ; 
```

或，更改 text() 而不是 text

```
$("#<%= lblStatus.ClientID %>").text()=code 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T12:38:42.537

PopUpFunction(10) 函数将 10 作为整数数据类型，因此您的调用函数不会得到任何东西。将其转换或将其作为字符串传递，您将获得正确的输出

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-30T12:39:30.807

尝试以下

```
 function PopUpFunction(code) {
    $("#<%= lblStatus.ClientID %>").val(code);
    } 
```

在获得它的价值的同时使用这个

```
string str=Request.Form(lblStatus.UniqueID); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-30T12:55:49.343

尝试这样的事情：

```
document.getElementById('The Control ID').InnerHTML = 'YourText'; 
```

示例：标签 1

```
document.getElementById('Label1').InnerHTML = 'Hello World!'; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-30T12:55:57.313

```
lnk.onclick = function(){
    PopUpFunction('Some_Text'); 
}); 
```

# vb.net - The schema returned by query is differ from base query

> ID：15718525
> 
> 赞同：2
> 
> 时间：2013-03-30T12:29:36.517
> 
> 标签：vb.net

When I Tried to add query by "Query Builder" after selecting data adapter and data set from datagrid view I receive this error "the schema returned by query is differ from base query"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:41:57.023

When you create a TableAdapter in a dataset in the designer, the primary query establishes the columns that can be returned as a part of that specific TableAdapter. If you're getting this error then the new query you're adding doesn't match the columns of the original. For instance, if you establish a dataset with this original query:

```
Select UserId, UserName, UserCreated
From Users 
```

and then try to add the following query:

```
Select UserId, UserName, NumberOfFailedLogins 
```

you'll get this error because the queries don't match what they return. The "Add Query" feature really is meant to group sql queries for like requirements (e.g. CRUD, filtered searches, etc).

# c# - Force Task to different core ?

> ID：15718529
> 
> 赞同：2
> 
> 时间：2013-03-30T12:30:26.213
> 
> 标签：c#, multithreading, .net-4.0, task-parallel-library, task

`Tpl` and `Plinq` automatically assign work to threads (at core/s... {*well ,if `#threads> #cores` then , >1 thread will run on the same core.* }).

However , Let's say I have `MyMethod1(){..}` and `MyMethod2(){..}` and I need to make *sure*(!) that each will run on a *different* core! (e.g. intensive computing)

The nearest solution I found is Plinq's `.WithExecutionMode (ParallelExecutionMode.ForceParallelism)`

But this is for a different situation where Plinq might think that it is better to do it *sequentially* rather then parallel.Also ,I dont use Plinq. I only have 2 methods which needs to run on a different core.

How can I do it ?

*p.s. there was an answer here at SO which suggested to use `TaskCreationOptions.LongRunning` but it is only to hint to the TaskScheduler that it should more aggressively create thread pool threads. but those threads can be on the same core. and my situation required them to be at a different core.*

Thank you.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-30T13:11:27.707

To do this requires breaking down several layers of abstraction and before doing it I would recommend doing quite a bit of profiling to be *certain* that doing this will be better performance than letting the framework handle resource allocation. I am somewhat doubtful (though I can't say I've analyzed it).

The first thing you need to do is to make sure that your two `Task`s get executed on different managed threads. Because this is trying to assert manual control over something the framework handles, to be certain that this is the case you would need to write your own `TaskScheduler`. However, realistically you can do this by specifying the `TaskCreationOptions.LongRunning` flag. On the current desktop CLR, at least, that will always create a new thread. But it's just a hint, API-wise.

The next abstraction to break is that of managed vs native threads. Each of your methods should be wrapped in a [thread affinity](http://msdn.microsoft.com/en-us/library/system.threading.thread.beginthreadaffinity.aspx) block. The framework is allowed to switch the physical thread a managed thread is running on. Since processor affinity is a native thread operation, you have to tell the framework not to do that.

Next, you need to get the native thread that corresponds to the current managed thread. In each method, after calling `BeginThreadAffinity`, get the native thread by calling [GetCurrentThreadId](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683183.aspx) via p/invoke.

Now you can do the rest of this in either native or managed land, but I'll assume you want to do it in .NET. In that case, get the [ProcessThread](http://msdn.microsoft.com/en-us/library/3xf99wt3.aspx) object which corresponds to the native thread, and you can set [processor affinity](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.processoraffinity.aspx) or [ideal processor](http://msdn.microsoft.com/en-us/library/system.diagnostics.processthread.idealprocessor.aspx) from there:

```
Thread.BeginThreadAffinity();
int threadId = GetCurrentThreadId();
Process proc = Process.GetCurrentProcess();
ProcessThread procThread = proc.Threads.Cast<ProcessThread>().Single(
    pt => pt.Id == threadId
);
procThread.ProcessorAffinity = new IntPtr(0x01);
//
// work
//
procThread.ProcessorAffinity = new IntPtr(0xFFFF);
Thread.EndThreadAffinity() 
```

# uitableview - 导航控件和其他控件是否必须在 appDelegate 中？

> ID：15718534
> 
> 赞同：0
> 
> 时间：2013-03-30T12:31:11.347
> 
> 标签：uitableview, uiviewcontroller, uinavigationcontroller

是否可以使用单个视图控制器启动您的项目，然后在第二个或第三个视图控制器上实现导航控制器，然后在第四个视图控制器上实现选项卡视图控制器？还是这种类型的项目需要是故事板项目？

我目前的困境是我只从一个视图控制器开始，它有一个圆形矩形按钮，可将您带到第二个视图控制器。从第二个视图控制器，我想要一个带有嵌入式表格视图的导航控制器，它将带我从第二个到第三个视图控制器返回和第四个。我已经尝试了几个小时将必要的代码放入每个 .h 和 .m 文件中，但我一直在碰壁。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T22:31:58.047

一个。您当然可以呈现几个常规视图控制器，然后`UINavigationController`在稍后阶段添加一个。当您需要显示导航控制器时，可以将您的详细视图控制器嵌入其中，如下所示：

（代码在您想要从中显示详细视图控制器的视图控制器中）

```
DetailViewController *detailVC = [[DetailViewController alloc] init];
UINavigationController *detailNav = [[UINavigationController alloc] initWithRootViewController:detailVC];
[self presentViewController:detailNav animated:TRUE completion:nil]; 
```

湾。不允许有一个`UITabBarController`inside a `UINavigationController`（或任何其他视图控制器）。但是，您仍然可以使用`UITabBar`控件并管理其余部分。有关这方面的示例，请参阅[UINavigationController 中的 UITabBarController](http://www.alexmedearis.com/uitabbarcontroller-inside-a-uinavigationcontroller/)。

# java - Java 读取和加载图像

> ID：15718536
> 
> 赞同：1
> 
> 时间：2013-03-30T12:31:30.803
> 
> 标签：java, image, load

我刚刚完成了一款扫雷游戏，除了一件事，将图像加载到游戏中的速度之外，一切都运行良好。我注意到如果我在游戏中有大量单元格，鼠标单击单元格后加载速度会非常慢，如果单元格数量较少，加载速度会更快。有没有其他方法可以使加载图像比我使用的更快？这是我用来将图像加载到游戏中的方法：

```
 private void draw(Graphics g) {
        BufferedImage gRec =null, flag=null, mine=null, aCount0=null,
            aCount1=null,aCount2 =null,aCount3 =null,aCount4 =null,aCount5 =null,
            aCount6 =null,aCount7 =null,aCount8 = null;
        try {
           gRec = ImageIO.read(new File("/Users/msa_666/Desktop/blank.gif"));
                flag = ImageIO.read(new File("/Users/msa_666/Desktop/bombflagged.gif"));
                mine = ImageIO.read(new File("/Users/msa_666/Desktop/bombdeath.gif"));
                flag = ImageIO.read(new File("/Users/msa_666/Desktop/bombflagged.gif"));
                aCount0 = ImageIO.read(new File("/Users/msa_666/Desktop/open0.gif"));
                aCount1 = ImageIO.read(new File("/Users/msa_666/Desktop/open1.gif"));
                aCount2 = ImageIO.read(new File("/Users/msa_666/Desktop/open2.gif"));
                aCount3 = ImageIO.read(new File("/Users/msa_666/Desktop/open3.gif"));
                aCount4 = ImageIO.read(new File("/Users/msa_666/Desktop/open4.gif"));
                aCount5 = ImageIO.read(new File("/Users/msa_666/Desktop/open5.gif"));
                aCount6 = ImageIO.read(new File("/Users/msa_666/Desktop/open6.gif"));
                aCount7 = ImageIO.read(new File("/Users/msa_666/Desktop/open7.gif"));
                aCount8 = ImageIO.read(new File("/Users/msa_666/Desktop/open8.gif"));
                }
                 catch (IOException e) { 
              e.printStackTrace();
           } 

        if (getCovered() == true && getMarked () == false) {    // gray rectangle
           g.drawImage(gRec,getX(),getY(),w,h,null);

        }
        else if (getCovered()==true && getMarked() ==  true) {  //flag
           g.drawImage(flag,getX(),getY(),w,h,null);

        }
        else if (getCovered()== false && getMined()== true){        //mine
           g.drawImage(mine,getX(),getY(),w,h,null);

        }
        else if ( getCovered() == false && getMined() == false) {   // adjacency count image
            switch (getAdjCount()){
                case 0:
           g.drawImage(aCount0,getX(),getY(),w,h,null);
                break;
                case 1:
           g.drawImage(aCount1,getX(),getY(),w,h,null);
                break;
                case 2:
           g.drawImage(aCount2,getX(),getY(),w,h,null);
                break;
                case 3:
           g.drawImage(aCount3,getX(),getY(),w,h,null);
                break;

                case 4:
           g.drawImage(aCount4,getX(),getY(),w,h,null);
                break;
                case 5:
           g.drawImage(aCount5,getX(),getY(),w,h,null);
                break;
                case 6:
           g.drawImage(aCount6,getX(),getY(),w,h,null);
                break;
                case 7:
           g.drawImage(aCount7,getX(),getY(),w,h,null);
                break;
                case 8:
           g.drawImage(aCount8,getX(),getY(),w,h,null);
                break;

        }
     }
    } 
```

这是单击每个单元格后重新绘制每个单元格的鼠标侦听器：

```
 public void mouseClicked(MouseEvent e) {
      int sRow, sCol;
      sRow= e.getX() / cellHeight;
      sCol = e.getY()/ cellWidth;
      System.out.println(e.getX() +"," +sCol);
      System.out.println(e.getY()+","+sRow);
      if (e.getButton() == MouseEvent.BUTTON1) {
        if( cells[sRow][sCol].getMarked() == false)     
           uncoverCell(cells[sRow][sCol]);
          // cells[sRow][sCol].setCovered(false);
        System.out.println(cells[sRow][sCol].getMined());
        repaint();
     }
     else if (e.getButton() == MouseEvent.BUTTON2) {
     }
     else if (e.getButton() == MouseEvent.BUTTON3) {
        if (cells[sRow][sCol].getMarked() == false){
           cells[sRow][sCol].setMarked(true);
                       repaint();

        }
        else {
           cells[sRow][sCol].setMarked(false);          
           repaint();           
        }
     }

     if (allMinesMarked() && allNonMinesUncovered()){
        System.out.println("You Win");
     }
  }

  public void paintComponent(Graphics g) { 
     for ( int i=0 ; i <rowCount; i++ ) {
        for (int j=0; j<columnCount; j++) {
           cells[i][j].draw(g);
        }
     }

  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:33:05.100

您需要告诉我们：

*   只是在哪里`draw(...)`叫？
*   如何获得传递给 draw 方法参数的 Graphics 对象 g？

我在这里猜测是因为我们没有所有相关代码，但看起来你每次想要显示图像时都在重新阅读图像。如果是这样，请不要这样做。在程序开始时只读取***一次***图像，然后使用图像或更好的 ImageIcons，在您需要它们时获得。

**编辑**
感谢您发布更多代码，这实际上证实了我的怀疑：您在每次重新绘制 GUI 时重新读取图像文件。这是非常低效的，并且会使您的程序慢下来。同样，您应该将图像读入您的程序*一次*，然后多次使用它们。

我自己会从图像中创建 ImageIcons，然后将它们显示在 JLabel 中。当需要交换图像时，只需调用`setIcon(...)`JLabel。这样就不用乱搞了`paintComponent(...)`。

**编辑 2**
例如（编译并运行它）：

```
import java.awt.GridLayout;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseEvent;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.List;

import javax.imageio.ImageIO;
import javax.swing.*;

public class SwapIcons {
   private static final int CELL_SIDE_COUNT = 3;
   private ImageCell[] imageCells = new ImageCell[CELL_SIDE_COUNT * CELL_SIDE_COUNT];
   private JPanel mainPanel = new JPanel();

   public SwapIcons(final GetImages getImages) {
      mainPanel.setLayout(new GridLayout(CELL_SIDE_COUNT, CELL_SIDE_COUNT));
      mainPanel.setBorder(BorderFactory.createEmptyBorder(2, 2, 2, 2));

      for (int i = 0; i < imageCells.length; i++) {
         imageCells[i] = new ImageCell(getImages);
         mainPanel.add(imageCells[i].getImgLabel());
      }
   }

   public JComponent getMainComponent() {
      return mainPanel;
   }

   private static void createAndShowGui(GetImages getImages) {
      SwapIcons swapIcons = new SwapIcons(getImages);

      JFrame frame = new JFrame("Click on Icons to Change");
      frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      frame.getContentPane().add(swapIcons.getMainComponent());
      frame.pack();
      frame.setLocationByPlatform(true);
      frame.setVisible(true);
   }

   public static void main(String[] args) {
      try {
         final GetImages getImages = new GetImages();
         SwingUtilities.invokeLater(new Runnable() {
            public void run() {
               createAndShowGui(getImages);
            }
         });
      } catch (IOException e) {
         e.printStackTrace();
      }
   }
}

class ImageCell {
   private JLabel imgLabel = new JLabel();
   private GetImages getImages;
   private int iconIndex = 0;

   public ImageCell(final GetImages getImages) {
      this.getImages = getImages;
      imgLabel.setIcon(getImages.getIcon(0));
      imgLabel.addMouseListener(new MyMouseListener());
   }

   public JLabel getImgLabel() {
      return imgLabel;
   }

   private class MyMouseListener extends MouseAdapter {
      @Override
      public void mousePressed(MouseEvent e) {
         iconIndex++;
         iconIndex %= getImages.getIconListSize();
         imgLabel.setIcon(getImages.getIcon(iconIndex));
      }
   }
}

// Simply gets a SpriteSheet and subdivides it into a List of ImageIcons
class GetImages {
   private static final String SPRITE_PATH = "http://th02.deviantart.net/"
         + "fs70/PRE/i/2011/169/0/8/blue_player_sprite_sheet_by_resetado-d3j7zba.png";
   public static final int SPRITE_ROWS = 6;
   public static final int SPRITE_COLS = 6;
   public static final int SPRITE_CELLS = 35;

   private List<ImageIcon> iconList = new ArrayList<ImageIcon>();

   public GetImages() throws IOException {
      URL imgUrl = new URL(SPRITE_PATH);
      BufferedImage mainImage = ImageIO.read(imgUrl);

      for (int i = 0; i < SPRITE_CELLS; i++) {
         int row = i / SPRITE_COLS;
         int col = i % SPRITE_COLS;
         int x = (int) (((double) mainImage.getWidth() * col) / SPRITE_COLS);
         int y = (int) ((double) (mainImage.getHeight() * row) / SPRITE_ROWS);
         int w = (int) ((double) mainImage.getWidth() / SPRITE_COLS);
         int h = (int) ((double) mainImage.getHeight() / SPRITE_ROWS);
         BufferedImage img = mainImage.getSubimage(x, y, w, h);
         ImageIcon icon = new ImageIcon(img);
         iconList.add(icon);
      }
   }

   // get the Icon from the List at index position
   public ImageIcon getIcon(int index) {
      if (index < 0 || index >= iconList.size()) {
         throw new ArrayIndexOutOfBoundsException(index);
      }

      return iconList.get(index);
   }

   public int getIconListSize() {
      return iconList.size();
   }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T16:07:30.350

充满鳗鱼的气垫船答案很好并且会起作用。并且适用于独立应用程序，但对于小程序或 Web 启动应用程序可以通过拥有一个大图像然后将其部分复制到可见的图形对象来进一步优化，考虑网格并使用 java.awt.Graphics 对象中的函数（来自javadoc）：

公共抽象布尔drawImage（图像img，int dx1，int dy1，int dx2，int dy2，int sx1，int sy1，int sx2，int sy2，ImageObserver观察者）

绘制当前可用的指定图像的指定区域，动态缩放以适应目标可绘制表面的指定区域。透明像素不会影响已经存在的任何像素。

此方法在所有情况下都会立即返回，即使要绘制的图像区域尚未针对当前输出设备进行缩放、抖动和转换。如果当前输出表示尚未完成，则 drawImage 返回 false。随着更多图像可用，加载图像的进程会通知指定的图像观察者。

此方法始终使用图像的未缩放版本来渲染缩放的矩形并即时执行所需的缩放。它不使用缓存的、缩放版本的图像进行此操作。执行从源到目标的图像缩放，使得源矩形的第一坐标映射到目标矩形的第一坐标，并且第二源坐标映射到第二目标坐标。根据需要对子图像进行缩放和翻转以保留这些映射。

参数： img - 要绘制的指定图像。如果 img 为 null，则此方法不执行任何操作。dx1 - 目标矩形第一个角的 x 坐标。dy1 - 目标矩形第一个角的 y 坐标。dx2 - 目标矩形第二个角的 x 坐标。dy2 - 目标矩形第二个角的 y 坐标。sx1 - 源矩形第一个角的 x 坐标。sy1 - 源矩形第一个角的 y 坐标。sx2 - 源矩形第二个角的 x 坐标。sy2 - 源矩形第二个角的 y 坐标。观察者 - 当更多图像被缩放和转换时要通知的对象。返回： 如果图像像素仍在变化，则返回 false；否则为真。

这更好，因为建立新连接并通过 Internet 下载图像需要几秒钟，所以如果您有一个主图像，其中所有子图像都在一个大表中，那么下载、加载和渲染的总时间会更少。从一个区域复制的额外逻辑是微不足道的，也许 .1KB 的 jar 文件空间:)

# iphone - 获取 iPhone 地理数据

> ID：15718539
> 
> 赞同：3
> 
> 时间：2013-03-30T12:31:43.923
> 
> 标签：iphone, ios, objective-c, geolocation, augmented-reality

我正在开发一个增强现实应用程序，我需要使用 iPhone 传感器来获取以下信息/数据：

*   地理纬度、经度和高度（提供相对于地球表面和平均海平面的位置）
*   手机视点中心航向（0°=N，90°=E，180°=S，270°=W）
*   手机视点中心仰角（0°=水平，-90°=垂直向下，+90°=垂直向上）
*   手机倾斜（0°=纵向/垂直，90°=横向/顶部向左，180°=横向/顶部向下，270°=纵向/顶部向下）
*   垂直对向的电话角度（即沿着标称的顶部到底部）
*   水平对向的电话角度（即沿标称的一侧到另一侧）

我已经知道如何查找纬度、经度和海拔高度，我想知道我可以使用哪种 API 或库来查找其他数据，例如手机角度和手机视点等。我会使用什么 API？一些示例代码？链接？讨论？我只是想弄清楚如何找到这些数据！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T16:11:47.853

您提到的信息可以通过 CoreLocation 和 CoreMotion API 获得（正如 Jeremy 在[iOS Dev Scout Facebook Group](https://www.facebook.com/groups/iosdevscout/)中提到的那样。

你可以得到

*   位置传感器（aGPS、蜂窝塔、WiFi） - 纬度、经度、高度、速度、路线等。
*   陀螺仪和加速度计 - 设备的旋转和平移。
*   磁力计 - 北和真北。

[一个名为pARk](http://developer.apple.com/library/ios/#samplecode/pARk/Introduction/Intro.html#//apple_ref/doc/uid/DTS40011083)的 iOS 开发人员库中提供了一个示例 AR 项目。

产生此示例项目的伴随的 WWDC 会议是 2011 年的会议，名为 423：了解核心运动。

查看与 Core Motion 相关的 WWDC 2012 会议，以加强您在这些领域的知识。

希望这会有所帮助。有了这些信息，不难从 CoreLocation（对于您的第一个点）和 CoreMotion（对于您接下来的 5 个点）得出您需要的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T23:32:11.933

将**Core Motion**框架添加到您的项目中。

创建**CMMotionManager**的实例：

```
_motionManager = [[CMMotionManager alloc] init];
_motionManager.deviceMotionUpdateInterval = 1.00/60.00;
[_motionManager startDeviceMotionUpdates]; 
```

获取 CMDeviceMotion 参考：

```
CMDeviceMotion *currentDeviceMotion = _motionManager.deviceMotion; 
```

要获得**姿态**（Pitch、Roll 和 Yaw 的组合）：

```
CMAttitude *currentAttitude = currentDeviceMotion.attitude; 
```

要获得**音高**（围绕通过 iPhone 的横轴旋转）：

```
currentAttitude.pitch 
```

要获得**滚动**（从上到下围绕纵轴旋转）：

```
currentAttitude.roll 
```

要获得**偏航**（围绕垂直穿过 iPhone 的轴旋转）：

```
currentAttitude.yaw 
```

这应该有助于获取其他设备数据，例如角度和倾斜度，并且当与**核心位置**框架结合使用时，您应该能够获得所需的一切。

# windows-phone-7 - 如何将滚动条添加到 wp7 中动态创建的控件

> ID：15718542
> 
> 赞同：0
> 
> 时间：2013-03-30T12:31:55.773
> 
> 标签：windows-phone-7, scrollbar

我想知道如何使用滚动条为 wp7 动态创建控件。我尝试了很多东西，但我不知道如何为通过代码隐藏创建的控件设置滚动条

# clips - CLIPS 发现事实不起作用

> ID：15718544
> 
> 赞同：0
> 
> 时间：2013-03-30T12:32:18.803
> 
> 标签：clips

我在 CLIPS (6.3) 中有以下 deftemplates：

```
(deftemplate A ( slot a ) (slot b) )
(deftemplate forSearch (slot property)(slot value)) 
```

我需要`(property, value)`从输入中读取该对，然后找到`A`插槽中的`property`值为`value`.

如果我做这样的事情：

```
(defrule r2
(forSearch (property ?c)(value ?d))
(A (?c ?d))
=>
(printout t "debug" crlf)
) 
```

我收到以下错误：

```
[PRNTUTIL2] Syntax Error:  Check appropriate syntax for deftemplate patterns.

ERROR:
(defrule MAIN::r2
   (forSearch (property ?c) (value ?d))
   (A (?c 
```

我现在该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T10:33:04.823

您必须在规则的模式匹配部分写入插槽名称。

正确的语法是：

```
(defrule r2
     (forSearch (property ?c)(value ?d))
     (A (a ?c) (b ?d))
     =>
     (printout t "debug" crlf)
) 
```

我不明白你想要完成什么，我知道已经晚了，但希望它有所帮助。

# facebook - When Facebook removes an App, it puts the site's domain on a blacklist?

> ID：15718545
> 
> 赞同：1
> 
> 时间：2013-03-30T12:32:19.193
> 
> 标签：facebook, oauth-2.0, facebook-apps, facebook-oauth, facebook-access-token

I got my app removed by Facebook last week.

Now I'm trying to build a new one correcting the problems, but I always get an error authenticating the user.

> SECURITY WARNING: Sharing the above URL with anyone is the same as sharing your Facebook password with them - it will give them access to your Facebook account. Despite what you may have been promised, you will not receive cash, a gift card, or free airline tickets in exchange for this URL.

I'm calling the API this way:

```
https://www.facebook.com/dialog/oauth?
client_id=MY_APP_ID
&display=popup
&redirect_uri=http://www.my-url.com/823/
&scope=user_about_me 
```

My Facebok app config is: [http://i.stack.imgur.com/s9WSW.png](http://i.stack.imgur.com/s9WSW.png)

I'm trying to use the same domain used in that removed app.
Does Facebook has a domain blacklist? I can't create a new app with that domain anymore (in the example "www.my-url.com/823/")?
Or am I just missing something in the settings?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:34:59.787

Yes , they probably block all the information related to your App and website.

# java - 我不明白paintComponent方法

> ID：15718547
> 
> 赞同：-3
> 
> 时间：2013-03-30T12:32:37.073
> 
> 标签：java, swing, paintcomponent

谁能给我解释一下`paintComponent`方法？这是什么意思？什么时候叫？它与`paint`方法有何不同？

请解释以下代码：

```
 public RoundButton(String label) {
    super(label);

// These statements enlarge the button so that it 
// becomes a circle rather than an oval.
    Dimension size = getPreferredSize();
    size.width = size.height = Math.max(size.width, 
      size.height);
    setPreferredSize(size);

// This call causes the JButton not to paint 
   // the background.
// This allows us to paint a round background.
    setContentAreaFilled(false);
  }

// Paint the round background and label.
  protected void paintComponent(Graphics g) {
    if (getModel().isArmed()) {
// You might want to make the highlight color 
   // a property of the RoundButton class.
      g.setColor(Color.lightGray);
    } else {
      g.setColor(getBackground());
    }
    g.fillOval(0, 0, getSize().width-1, 
      getSize().height-1);

// This call will paint the label and the 
   // focus rectangle.
    super.paintComponent(g);
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:49:20.693

Jcomponent 除了 paint(...) 之外还有 3 种其他的绘制方法：

```
paintComponent()
paintBorder()
paintChildren() 
```

这些方法以这种方式在paint方法中被调用（来自Jcomponent的paint方法的代码）：

```
 if (!rectangleIsObscured(clipX,clipY,clipW,clipH)) {
        if (!printing) {
        paintComponent(co);
        paintBorder(co);
        }
        else {
        printComponent(co);
        printBorder(co);
        }
            }
    if (!printing) {
        paintChildren(co);
    }
    else {
        printChildren(co);
    } 
```

更改组件的绘制方式时，总是会覆盖 paintComponent () 方法，就像在您的示例中一样。在您的示例中，在调用 super.paintComponent() 之前绘制了一个椭圆。更改边框的原因相同，您只需覆盖paintBorder 方法...

# android - 如何在屏幕上以点击点为中心显示 PopupWindow？

> ID：15718550
> 
> 赞同：2
> 
> 时间：2013-03-30T12:32:53.977
> 
> 标签：android, onclick, popupwindow, gravity

我最近实现了一个 PopupWindow，它恰好显示在我单击 GoogleMapv2 的位置。我将 LatLng 地图位置转换为屏幕位置，将重力设置为中心并显示在屏幕上。然后，在没有任何代码更改的情况下，它开始显示在点击点上方一点，我不知道出了什么问题。请帮忙！我渴望任何解决我的问题的方法，我实际上只是想在地图上的点击点上显示一个进度对话框。

这是我的代码：

```
mMap.setOnMapClickListener(new OnMapClickListener()
        {
            @Override
            public void onMapClick(LatLng point)
            {       
    View popUpView = getLayoutInflater().inflate(R.layout.popup, null); 
    LinearLayout layout = (LinearLayout) popUpView.findViewById(R.id.popup);
      ProgressBar progressBar = new ProgressBar(MainActivity.this);        
          progressBar.setIndeterminateDrawable(getResources().getDrawable(R.drawable.dialog));
    layout.addView(progressBar);

    mpopup = new PopupWindow(popUpView, 30,30, false); //Creation of popup
    mpopup.setOnDismissListener(MainActivity.this);
    mpopup.setAnimationStyle(android.R.style.Animation_Dialog);             
    pinToScreen(point, popUpView);
            }
        });
    }
}

private void pinToScreen(LatLng point, View popupView)
{
    Projection projection = mMap.getProjection();       
    Point pixPoint = projection.toScreenLocation(point);
    LatLng latlng=projection.fromScreenLocation(pixPoint);
    DisplayMetrics dm = getResources().getDisplayMetrics();
    int screenwidth = dm.widthPixels;
    int screenheight = dm.heightPixels;     
    mpopup.showAtLocation(popupView, Gravity.CENTER,
                                  pixPoint.x-screenwidth/2, pixPoint.y-screenheight/2;      
} 
```

R.layout.popup：

```
LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:id="@+id/popup"
 android:layout_width="fill_parent"
 android:orientation="vertical"
 android:background="@android:color/transparent"
 android:layout_height="fill_parent"
 android:gravity="center"
 android:layout_gravity="center">
LinearLayout> 
```

ProgressDialog 可绘制：

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android" 
android:shape="oval"
android:visible="true"
android:innerRadius="60dp"

><solid 
    android:color="@color/skypicker_blue1"       
    />
<stroke android:color="@color/transparent_blue2"
    android:width="1dp"/>

</shape> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T22:02:38.303

The problem was that the application was not displayed on fullscreen, so the screenpoint converted from clicked LatLng did not correspond with the actual screenpoint, the offset was the height of the top panel on Android. When I made the app fullscreen, it helped. However, I still don´t know hot to get height of the Android top panel...

# android - 这个 Android Lint 是什么意思：“方向错误？”

> ID：15718555
> 
> 赞同：7
> 
> 时间：2013-03-30T12:33:44.073
> 
> 标签：android, orientation, lint

我在 Eclipse 中运行 Android lint 并得到一个错误：

> 方向错误？未指定方向，默认为水平，但此布局有多个子级，其中至少一个具有 layout_width="match_parent"
> 
> 问题：检查具有多个子项的 LinearLayouts 是否设置了方向 Id: Orientation

这是错误代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="@dimen/cell_height_1_of_3" >

    <ImageView
        android:id="@+id/item_cover"
        android:layout_width="wrap_content"
        android:layout_height="fill_parent"
        android:layout_gravity="left"
        android:layout_marginLeft="8dp"
        android:scaleType="fitCenter"
        android:src="@drawable/doc_item_icon" />

    <ImageView
        android:layout_width="fill_parent"
        android:layout_height="@dimen/cell_height_1_of_3"
        android:background="#0000"
        android:padding="5dp"
        android:scaleType="centerInside"
        android:visibility="gone" />

    <TextView
        android:id="@+id/item_title"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:ellipsize="end"
        android:gravity="center"
        android:maxLines="1"
        android:text="Add new"
        android:textColor="@color/office_color"
        android:textSize="@dimen/textview_small_size" />

</LinearLayout> 
```

这是什么意思？如果我忽略这个 lint 错误会发生什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-30T12:41:23.453

Android Lint 是 ADT 16（和 Tools 16）中引入的一个新工具，它可以扫描 Android 项目源中的潜在错误。

[http://developer.android.com/tools/help/lint.html](http://developer.android.com/tools/help/lint.html).

You have to specify orientation for your layout.

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:orientation="vertical"   //specify vertical or horizontal depending on your need
    android:layout_height="@dimen/cell_height_1_of_3" > 
```

[http://tools.android.com/tips/lint-checks](http://tools.android.com/tips/lint-checks). list of the checks performed by lint.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:38:10.367

如果您没有在 LinearLayout 中指定方向，则 2 个 ImageView 和 TextView 将彼此并排呈现

```
android:orientation="horizontal" 
```

将被假定

如果您希望它们在彼此下方呈现，请使用

```
android:orientation="vertical" 
```

# javascript - 谷歌地图没有出现

> ID：15718556
> 
> 赞同：1
> 
> 时间：2013-03-30T12:34:05.150
> 
> 标签：javascript, function, google-maps

谷歌地图没有出现。我认为问题在于 lat 和 long 的数据类型。这是代码：当提供 lat long 的硬编码值时，所有函数都可以正常工作。

```
function initialize(a, b, zoom) {
    alert('init called  ' + "lat: " + typeof a + "long: " + typeof b + "zoom: " + typeof zoom);
    //here lat long are string and zoom is number 

    //var zoom =parseInt(zoom);
    var a = parseFloat(a);
    var b = parseFloat(b);
    alert('init called  ' + "lat: " + typeof a + "long: " + typeof b + "zoom: " + typeof zoom);

    //here lat oang and zoom all are number
    var centerLoc = new google.maps.LatLng(a, b);

    var mapProp = {
        center: centerLoc,
        zoom: zoom,
        //   mapTypeId:google.maps.MapTypeId.ROADMAP,
        mapTypeId: google.maps.MapTypeId.SATELLITE
    };
    var map = new google.maps.Map(document.getElementById("googleMap"), mapProp);
    marker = new google.maps.Marker({
        position: centerLoc,
        title: 'Click to zoom'
    });
    google.maps.event.addListener(marker, 'click', function () {
        map.setZoom(map.getZoom() + 1);
        map.setCenter(marker.getPosition());
    });
    marker.setMap(map);
}
google.maps.event.addDomListener(window, 'load', initialize);

</script> 
```

这是html：

```
<html>
<body>
<div id="googleMap" style="width:1000px;height:500px;"></div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:57:20.883

你的代码对我来说很好。唯一的问题是你不能这样做：

```
google.maps.event.addDomListener(window, 'load', initialize); 
```

因为您不能将参数传递给以这种方式调用的函数。如果你在 body 标记中使用它作为 onload 函数，它可以工作：

```
<body onload="initialize(-33.8665433, 151.1956316,5)"> 
```

[工作示例](http://www.geocodezip.com/v3_SO_initializeMap.html)

# c# - 无法在 winForm 上绘制 2 个相同的控件

> ID：15718562
> 
> 赞同：1
> 
> 时间：2013-03-30T12:34:58.850
> 
> 标签：c#, winforms, user-interface

我正在用 winform (tic-tac-toe) 制作一个简单的游戏，但在绘制块控制时遇到了一些问题。

这是我制作的类，代表游戏中的一个块（没有游戏逻辑，只有 UI）。

```
public class UI_Block : Control
{
    private Rectangle block;
    private SIGNS sign;
    public  SIGNS Sign 
    {
        get {return sign;}
        set
        {
            if (sign == SIGNS.EMPTY)
                sign = value;
        } 
    }

    public UI_Block( ) {
        sign = SIGNS.EMPTY;
    }

    public void SetBlockOnBoard(int x, int y)
    {
        this.Location = new Point( x , y );
        this.Size = new Size(Parent.Width /3, Parent.Height / 3);

        block = new Rectangle(this.Location, this.Size);
    }

    public void DrawSign(Graphics g)
    {
        Pen myPen = new Pen(Color.Red);

        if (sign == SIGNS.O)
        {
            drawO(g,new Pen(Brushes.Black));
        }

        if (sign == SIGNS.X)
        {
            drawX(g, new Pen(Brushes.Red));
        }

    }

    protected override void OnPaint(PaintEventArgs e)
    {
        DrawSign(e.Graphics);
        base.OnPaint(e);
    }

    //Draw X
    private void drawX(Graphics g, Pen myPen)
    {
        //draw first daignol
        Point daignolStart = new Point {  X = this.Location.X  ,  Y = this.Location.Y   };
        Point daignolEnd = new Point   {  X = this.Size.Width  ,  Y = this.Size.Height  };

        g.DrawLine(myPen, daignolStart, daignolEnd);

        //draw second daignol
        daignolStart = new Point {  X = Size.Width ,  Y = this.Location.Y  };
        daignolEnd = new Point   {  X = Location.X,   Y = Size.Height      };

        g.DrawLine(myPen, daignolEnd, daignolStart);
    }

    //Draw O
    private void drawO(Graphics g, Pen myPen)
    {
        g.DrawEllipse(myPen, block);
    }

} 
```

我将它们都添加到 winForm 类中，并查看绘制它们时的样子：

```
public partial class Form1 : Form
{
    UI.UI_Block block;
    UI.UI_Block blockX;

    public Form1()
    {
        InitializeComponent();

        block = new UI.UI_Block();
        blockX = new UI.UI_Block();
        Controls.Add(block);
        Controls.Add(blockX);

    }

    protected override void OnLoad(EventArgs e)
    {
        block. SetBlockOnBoard(0, 0);
        blockX.SetBlockOnBoard(0, block.Height);

        block.Sign = SIGNS.X;
        blockX.Sign = SIGNS.O;

        base.OnLoad(e);
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        //block.DrawSign(e.Graphics);
        //block.DrawSign(e.Graphics);
        base.OnPaint(e);
    }

} 
```

我尝试了一些事情，比如不使用该`onPaint`事件，但我仍然得到相同的结果。

这是我运行它时看到的内容：

![enter image description here](../Images/63147341509eba614575b7c204ed74df.png) 知道为什么我不能画他们两个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T15:01:21.927

您没有在其可见区域中绘制控件的内容，因此它绘制得很好，但您看不到它。

Every control has it's own coordinate space (client coords), which starts at 0,0 regardless of where it is positioned within the parent control. You are placing the control in it's parent correctly by setting its Location, but then you are also using the Location to offset the graphics, so they are essentially offset twice.

(If you make your control bigger you'll be able to see the X being drawn further down the screen)

To fix this, do all your drawing in the client coordinate space of your control, i.e. draw in the area (0, 0, width, height)

(P.S. You could just draw all 9 tiles in the parent control, which is a more efficient approach than creating 9 child controls. But what you are doing will work fine)

# c# - Why are nullable boolean values not comparable with the shorthand if(boolean)?

> ID：15718565
> 
> 赞同：-3
> 
> 时间：2013-03-30T12:35:08.243
> 
> 标签：c#

Why can I compare nullable boolean values in C# like this:

```
bool? test = true;
if (test==true)
   //do somethign 
```

but not like this:

```
bool? test = true;
if (test)
   //do somethign 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:40:00.250

The `if` statement in C# can only take a `bool` parameter.

`Nullable<bool>` is not the same as `bool`, and `null` is neither `true` nor `false`.

If you know your `bool?` has a value, you can use:

```
if (test.Value)
    //do something 
```

# c# - Remove File:/// before a folder path

> ID：15718567
> 
> 赞同：-2
> 
> 时间：2013-03-30T12:35:14.570
> 
> 标签：c#, string, path

I have this code

```
string path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase); 
```

This yields a string such as

```
"file://C://Foo//bin" 
```

What I want is

```
"C://Foo//bin" 
```

How do I get that without removing `"file://"` from the beginning manually?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:44:00.003

Use Substring

```
 string path = Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase);
        this.Text = path.Substring(6, path.Length - 6); 
```

or use this

```
this.Text = Application.StartupPath; 
```

# android - 安卓可绘制

> ID：15718571
> 
> 赞同：2
> 
> 时间：2013-03-30T12:35:41.567
> 
> 标签：android

我对可绘制目录有一点问题：我在所有可绘制目录（hdpi、ldpi、mdpi 等）中添加了一个图像，但是在我的文件 xml 中，当我写

```
android:backgroud="@drawable/fond_ecran" 
```

我有这个错误信息：`Error: No resource found that matches the given name (at 'background' with value '@drawable/fond_ecran').`

我不明白为什么，因为图像`fond_ecran.png`在所有可绘制的目录中，所以如果有人有解释要给我，那会很酷:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:38:11.100

> 我不明白为什么，因为图片 fun_ecran.png 在所有可绘制的目录中，所以如果有人有解释要给我，那会很酷:)

`XML`首先检查文件中是否没有错误`Java`（因为如果有，`R.java`则未正确生成）并再次清理并构建您的项目。它应该可以解决您的问题。如果不尝试创建下一个名为的文件夹`drawable`并将图像放入其中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:41:28.083

**在可绘制文件夹中的 Eclipse IDE 中是否可以看到可绘制对象？**

*   不？右键单击项目资源管理器并刷新。

还可以尝试清理项目，以便重新创建生成的文件，例如`R.java`

# c# - 计算 ICMPv6 数据包的校验和

> ID：15718573
> 
> 赞同：2
> 
> 时间：2013-03-30T12:36:12.277
> 
> 标签：c#, checksum, icmp

我正在尝试在**C#**中计算 ICMPv6 数据包的校验和。我遵循了[此处](https://stackoverflow.com/questions/10042069/c-sharp-icmpv6-checksum-calculation)发布的建议，但似乎仍然存在细微差别。

这就是我计算校验和的方式：

```
 //Note: Initial checksum in payload is set to 0x00, 0x00
        //Add ip source bytes (16 bytes)
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 0);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 2);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 4);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 6);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 8);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 10);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 12);
        checksum += Utilities.BitConverterToUInt16(IpV6SourceBytes, 14);

        //Add ip destination bytes (16 bytes)
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 0);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 2);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 4);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 6);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 8);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 10);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 12);
        checksum += Utilities.BitConverterToUInt16(IpV6DestinationBytes, 14);

        //Add length (2 bytes) - tested, value is correct (32 for {0x00, 0x20})
        checksum += Utilities.BitConverterToUInt16(ip6.PayloadLength, 0);

        //Add next-header (1 byte) - tested, value is correct (58)
        checksum += (byte)ip6.NextProtocol;

        //Add ICMPv6 message
        for (int i = 0; i < buffer.Length; i +=2) {
            checksum += Utilities.BitConverterToUInt16(buffer, i);
        }

        checksum += (ushort)(checksum >> 16);
        checksum = (ushort)~checksum;

        Console.WriteLine(checksum);
        Checksum = BitConverter.GetBytes((UInt16)checksum).Reverse().ToArray(); 
```

**Utilities.BitConverterToUint16**方法：

```
 public static ushort BitConverterToUInt16(byte[] value, int startIndex) {
        return BitConverter.ToUInt16(value.Reverse().ToArray(),
          value.Length - sizeof(UInt16) - startIndex);
    } 
```

**Wireshark**对此的看法： *校验和：0x4201 [不正确，应为 0x4209]*

我错过了什么？

**编辑：注意：** Utilities.BitConverterToUInt16 检索接下来的 2 个字节（16 位）。我引用的帖子使用 4 个字节（32 位）作为有效负载长度，即使该字段是 2 个字节长。我不知道为什么其他帖子使用 4 个字节，这就是我如此困惑的原因。

**Edit2：**好的，我几乎到处搜索，但无法确定问题所在。

*   **来自wiki：** *校验和是根据IPv6标准从IPv6头域的伪头开始计算的，它由源地址和目标地址、数据包长度和下一个头域组成，后者设置为值58\. 在这个伪报头之后，校验和与 ICMPv6 消息一起继续，其中校验和最初设置为零。*
*   **来自[ietf](https://www.rfc-editor.org/rfc/rfc2460#section-8.1)：** *校验和是整个 ICMPv6 消息的反码和的 16 位反码，以 ICMPv6 消息类型字段开头，前缀为 IPv6 标头字段的“伪标头”*
*   **从[这个](https://stackoverflow.com/questions/7457863/how-do-i-validate-the-icmpv6-checksum-why-am-do-i-keep-getting-a-checksum-of-0?rq=1)问题：** *“......这是不必要的。len 始终是 16 位。” “...常数总是 00 00 00 58，所以只需加上 58。”*

这让我发疯。同样，如果有人能指出我正确的方向，我将不胜感激。我完全不知道为什么校验和是错误的。再次感谢。

**Edit3：**不确定这是否有帮助，但似乎校验和总是小 8 （即使我更改了 IPv6 标头中的所有值，例如 IP 地址）。

# textmate - Textmate, how to find out which theme I am using?

> ID：15718574
> 
> 赞同：1
> 
> 时间：2013-03-30T12:36:14.150
> 
> 标签：textmate, textmatebundles, textmate2

I am using TextMate version 2.0-alpha.9387, I don't see any options in Preferences.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-31T01:51:23.357

The answer is select View->Theme from menu bar. But I think textmate 2 has bug on that menu item, the menu item is grey and not selectable, I have to make selection of text that I am editing to enable the menu item.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-14T21:35:21.210

Start with an open document

Keyboard:

`Ctrl` + `Command` + `t`, begin typing `variable`, when "`Show TextMate Variables - Bundle Development`" is selected, press `return`.

Mouse:

`Bundles` → `Bundle Development` → `Show TextMate Variables`

Results:

This displays a large tooltip listing all the environment variables available to the TM, you're looking for "`TM_CURRENT_THEME_PATH`". The theme name is the same as filename in this path.

Bonus:

You could create a snippet for this as well: Snippet/Command:

`${TM_CURRENT_THEME_PATH}`

in a snippet with a tab trigger of `theme` would cause the path to replace `theme` with the path.

# google-earth-plugin - 谷歌地球 api 中的多个气球

> ID：15718577
> 
> 赞同：0
> 
> 时间：2013-03-30T12:36:47.107
> 
> 标签：google-earth-plugin

**如何在 Google Earth API 中同时显示多个气球？是否可以制作任何技巧，例如增加地标图标的大小？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T22:14:37.360

AFAIK，Google Earth 桌面程序和浏览器插件都只允许在任何时候显示一个“气球”。

# c++ - ifstream 在不同的目录

> ID：15718579
> 
> 赞同：0
> 
> 时间：2013-03-30T12:36:54.560
> 
> 标签：c++, file, fstream, ifstream

首先，是的，我搜索过 sof 和 google，我能找到的只是使用双斜杠，但这并没有起到作用，所以我在问，我做错了什么。

我的 C 盘上有一个名为 testing.txt 的测试文件。(C:/testing.txt)

我使用的代码是：

```
#include <iostream>
#include <fstream>
using namespace std;
int main()

{
    ifstream failas;
    failas.open("C:\\testing.txt");
    if (!failas)
    {
        cout<<"not today, baby"<<endl;
    }
    else cout<<"yeah, baby, it's open"<<endl;
    string line;
    getline(failas,line);
    cout<<line;
    failas.close();

    return 0;

} 
```

尝试了所有类型的斜线。(\//\///\)（程序远在C盘）谢谢！

[编辑]：文件夹截图 [http://i48.tinypic.com/5xmt86.png](http://i48.tinypic.com/5xmt86.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T18:01:31.397

是的。这是一个特权问题。我也遇到过。临时解决方法是再添加一个间接。在C盘创建一个文件夹并将文件放入其中。改变路径。它应该可以正常工作。

# php - php表单无法识别来自sql db的用户名

> ID：15718580
> 
> 赞同：-3
> 
> 时间：2013-03-30T12:36:58.707
> 
> 标签：php, mysql, sql, forms, login

我的问题是：

```
 <?php
 function user_exists($username) {
$username = sanitize($username);
return (mysql_result(mysql_query("SELECT_COUNT('user_id') FROM `user` WHERE `username` = '$username'"), 0) == 1) ? true : false;
 }
 ?> 
```

如您所见，我已包含正确的数据库名称并且用户确实存在，这就是我调用它以从 sql 中提取的位置：

```
<?php
include 'core/init.php';

if (user_exists('dan') === true) {
echo 'exists';
} 

 die();

if (empty($_POST) === false) {
$username = $_POST['username'];
$password = $_POST['password'];

if(empty($username) === true || empty($password) === true {

    $errors[] = 'You need to enter a username and password';
} else if (user_exists($username) === false) {
    $errors[] = 'Sorry this user does not exist';
}
}
?> 
```

我不知道为什么我得到一个空白页并且它显示的消息是说用户存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:40:51.327

这可能是您无法触发的语法错误

```
(mysql_result(mysql_query("SELECT_COUNT('user_id') FROM `user` WHERE `username` = '$username'"), 0) == 1) ? true : false; 
```

`SELECT COUNT`在删除下划线**“_”**之间留出空格，因为它会给你 mysql 错误

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:51:03.403

除了查询中的那个愚蠢的错字之外，您使用 mysql API 的方式确实很糟糕。
需要注意的一些关键缺陷

*   whatever "sanitize" function used to build a query should add quotes around returned value. Otherwise it will do no good and lead you to injection.
*   you aren't checking for the mysql errors
*   you are writing your code in one line making it extremely hard to read.

What it should be at the very least

```
function user_exists($username) {
    $username = sanitize($username); // remember it should add the quotes
    $sql = "SELECT COUNT(1) FROM `user` WHERE `username` = $username";
    $res = mysql_query($sql) or trigger_error(mysql_error().$sql);
    $row = mysql_fetch_row($res);
    return !empty($row[0]);
 } 
```

> I am not sure why I am getting a blank page.

Most likely it is caused by some PHP error.
Either tell PHP to show them on-screen or peek into server error log to read the error message

Or there is no such user in the database.

So, make your code like this

```
<?php
ini_set('display_errors',1);
error_reporting(E_ALL);

echo "testing<br>";

include 'core/init.php';

if (user_exists('dan')) {
   echo 'exists';
} else {
   echo 'not found';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:42:53.077

问题就在这里

```
 SELECT_COUNT('user_id')
       ^ 
```

应该

```
 SELECT COUNT('user_id') 
```

# c++ - Boost::filesystem，std::sort：在排序过程中无法保留信息

> ID：15718581
> 
> 赞同：2
> 
> 时间：2013-03-30T12:37:04.157
> 
> 标签：c++, sorting, boost, segmentation-fault, boost-filesystem

我正在尝试使用`std::sort`包含从`boost::filesystem::dictionary_iterator`. 看来，由于排序算法已经进行了`n`比较，`n`即目录中的文件数量，该信息会丢失，我最终会出现段错误。Valgrind 说我正在使用未初始化的值并进行无效读取。

如何更改我的`File`数据类型或算法，以便在两次传递之间保留信息？

```
#include <iostream>
#include <algorithm>
#include <vector>
#include <string>
#include <boost/filesystem.hpp>
namespace fs = boost::filesystem;

struct File {
    fs::path path;
    fs::file_status status;
};

bool comp(const File& a, const File& b) {
    static size_t count = 0;
    std::cout << "Compare function called " << ++count << " times" << std::endl;
    std::string a_filename = a.path.filename().native();
    std::string b_filename = b.path.filename().native();
    return a_filename.compare(b_filename);
}

int main() {
    std::vector<File> vec;

    // Read directory
    fs::directory_iterator it("/etc"), end;
    for (; it != end; it++) {
        File f = *(new File);
        f.path = it->path();
        f.status = it->status();
        vec.push_back(f);
    }

    std::sort(vec.begin(), vec.end(), comp);

    // Clean up
    for (std::vector<File>::iterator it = vec.begin(); it != vec.end(); it++)
        delete &(*it);

    return 0;
} 
```

（这不是我的实际程序，但表现出相同的行为。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T14:16:25.717

最后对 compare() 的调用是错误的，它返回一个可以是 -1、0 或 1 的 int，如 strcmp()。改为使用对 std::less()(a_filename, b_filename) 的简单调用。还要确保您有单元测试，以确保比较器创建严格的弱排序，这是 std::sort 所要求的。

带内部检查的比较器：

```
inline bool do_compare(const File& a, const File& b)
{
    /* ... */
} 

bool compare(const File& a, const File& b)
{
    bool const res = do_compare(a, b);
    if(res)
        assert(!do_compare(b, a));
    return res;
} 
```

如果定义了 NDEBUG（即 assert() 停用），编译器应该能够将其优化为与以前相同数量的代码。现在，我希望您在编写按顺序对文件名 9.png、10.png 和 11.png 进行排序的代码时玩得开心。;)

# algorithm - 澄清快速排序中的交换标准？

> ID：15718587
> 
> 赞同：0
> 
> 时间：2013-03-30T12:37:31.423
> 
> 标签：algorithm, sorting, quicksort

在快速排序中，想法是您不断选择一个支点。并且您将在左侧找到的大于枢轴的值与您在右侧找到的小于枢轴的值交换。见：[参考](http://www.vogella.com/articles/JavaAlgorithmsQuicksort/article.html)

只想 100% 确定在以下情况下会发生什么：

*   左边没有值大于枢轴，右边没有值小于枢轴
*   左边的值大于枢轴，右边没有值小于枢轴
*   左边没有值大于枢轴，右边没有值小于枢轴

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T02:38:45.593

交换标准取决于实现。您提到的三种情况会发生什么取决于分区方案。快速排序有很多实现，但主要的两个最著名的（在我看来）是：

*   Hoare 分区：第一个元素是枢轴，两个索引变量 (`i`和`j`) 将数组 ( `a[]`) 向中心移动，而它们遇到的元素小于/大于枢轴。然后`a[j]`和`a[i]`被交换。请注意，在此实现中，交换发生在**等于 pivot**的元素上。当您的数组包含许多相同的条目时，这被认为很重要。After `i`and `j`cross,`a[0]`与 交换`a[j]`，因此枢轴在较小或等于分区和较大或等于分区之间移动。

*   洛穆托的分区。[这是在“就地版本](http://en.wikipedia.org/wiki/Quicksort#In-place_version)”下的当前 Wiki 快速排序条目中以伪代码实现的一种。这里的 pivot 可以是任何东西（比如一个中位数，或者三个的中位数），并与 . 的最后一个元素交换`a`。这里只`i`“走”向数组的末尾：每当`a[i]>=pivot`它被交换`a[j]`并`j`递减时。最后，枢轴与`a[i+1]`

（例如，请参见[此处的插图）。](http://www.cs.bilkent.edu.tr/~atat/473/lecture05.pdf)

Robert Sedgewick 提倡一种[三向分区方案](http://www.sorting-algorithms.com/quick-sort-3-way)，其中数组被分成三个分区：小于、等于和大于枢轴：声称它在具有大量重复值或相同值的数组上具有更好的性能。它的实现方式有所不同（请参阅上面的链接）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:08:18.767

虽然枢轴值的选择对性能很重要，但对排序并不重要。

一旦选择了某个值作为枢轴，然后将所有小于或等于枢轴的值移动到枢轴的左侧，然后将所有大于枢轴的值移到其右侧。

在所有这些移动之后，枢轴值处于其最终位置。

然后，您对枢轴值左侧的子数组以及其右侧的子数组递归地重复上述过程。或者当然，如果子数组中包含 0 或 1 个元素，则与它们无关，无需排序。

因此，通过这种方式，您最终会选择一堆枢轴值，这些枢轴值会在所有移动之后进入它们的最终位置。在这些枢轴值之间是空的或单个元素的子数组，不需要如前所述进行排序。

# java - 将 Servlet 重定向到 div 容器

> ID：15718588
> 
> 赞同：0
> 
> 时间：2013-03-30T12:37:34.160
> 
> 标签：java, google-app-engine, servlets, redirect

我有一个由 Spring 处理的 sevlet，并且还使用 Google App Engine 作为云平台。

我想将此 servlet 重定向到另一个页面：

```
@Controller 
```

公共类客户控制器 {

```
@RequestMapping(value = "/", method = RequestMethod.GET)
public String listAllFeedsOnIndexPage(ModelMap map) throws JSONException {
   return "invite";
}

@RequestMapping(method = RequestMethod.GET)
public ModelAndView add(HttpServletRequest request, ModelMap model) {

    String firstName = request.getParameter("firstName");
    String lastName = request.getParameter("lastName");
    String email = request.getParameter("email");

    System.out.println(email);
    System.out.println(firstName);
    System.out.println(lastName);

    Customer c = new Customer();
    c.setFirstName(firstName);
    c.setLastName(lastName);
    c.setEmail(email);
    c.setDate(new Date());

    PersistenceManager pm = PMF.get().getPersistenceManager();
    try {
        pm.makePersistent(c);
    } finally {
        pm.close();
    }

    return new ModelAndView("redirect:thankYou");

} 
```

> My App Engine output: Initializing App Engine server Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.config.EarHelper logNotAnEar INFO: Directory 'C:\Users\user\workspace\LandingPage\war' is not an EAR directory. File C:\Users\user\workspace\LandingPage\war\appengine-application.xmlappengine-application.xml not detected. Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.config.EarHelper logNotAnEar INFO: Directory 'C:\Users\user\workspace\LandingPage\war' is not an EAR directory. File C:\Users\user\workspace\LandingPage\war\appengine-application.xmlappengine-application.xml not detected. Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.config.EarHelper logNotAnEar INFO: Directory 'C:\Users\user\workspace\LandingPage\war' is not an EAR directory. File C:\Users\user\workspace\LandingPage\war\appengine-application.xmlappengine-application.xml not detected. Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.config.EarHelper logNotAnEar INFO: Directory 'C:\Users\user\workspace\LandingPage\war' is not an EAR directory. File C:\Users\user\workspace\LandingPage\war\appengine-application.xmlappengine-application.xml not detected. Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.config.AppEngineWebXmlReader readAppEngineWebXml INFO: Successfully processed C:\Users\user\workspace\LandingPage\war\WEB-INF/appengine-web.xml Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.config.AbstractConfigXmlReader readConfigXml INFO: Successfully processed C:\Users\user\workspace\LandingPage\war\WEB-INF/web.xml Mär 30, 2013 1:28:26 PM com.google.appengine.tools.development.SystemPropertiesManager setSystemProperties INFO: Overwriting system property key 'java.util.logging.config.file', value 'C:\Users\user\Desktop\eclipse-java-juno-SR1-win32-x86_64\eclipse\plugins\com.google.appengine.eclipse.sdkbundle_1.7.5\appengine-java-sdk-1.7.5\config\sdk\logging.properties' with value 'WEB-INF/logging.properties' from 'C:\Users\user\workspace\LandingPage\war\WEB-INF\appengine-web.xml' Mär 30, 2013 1:28:26 PM com.google.apphosting.utils.jetty.JettyLogger info INFO: Logging to JettyLogger(null) via com.google.apphosting.utils.jetty.JettyLogger Mär 30, 2013 12:28:27 PM com.google.apphosting.utils.jetty.JettyLogger info INFO: jetty-6.1.x Mär 30, 2013 12:28:28 PM com.google.appengine.tools.development.ApiProxyLocalImpl log INFO: javax.servlet.ServletContext log: Initializing Spring root WebApplicationContext Mär 30, 2013 12:28:28 PM org.springframework.web.context.ContextLoader initWebApplicationContext INFO: Root WebApplicationContext: initialization started Mär 30, 2013 12:28:29 PM org.springframework.web.context.support.XmlWebApplicationContext prepareRefresh INFO: Refreshing Root WebApplicationContext: startup date [Sat Mar 30 12:28:29 UTC 2013]; root of context hierarchy Mär 30, 2013 12:28:29 PM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions INFO: Loading XML bean definitions from ServletContext resource [/WEB-INF/mvc-dispatcher-servlet.xml] Mär 30, 2013 12:28:29 PM org.springframework.context.annotation.ClassPathBeanDefinitionScanner registerDefaultFilters INFO: JSR-330 'javax.inject.Named' annotation found and supported for component scanning Mär 30, 2013 12:28:30 PM org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor INFO: JSR-330 'javax.inject.Inject' annotation found and supported for autowiring Mär 30, 2013 12:28:30 PM org.springframework.beans.factory.support.DefaultListableBeanFactory preInstantiateSingletons INFO: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@9b4ed7a: defining beans [customerController,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,mvcContentNegotiationManager,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.view.InternalResourceViewResolver#0,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; root of factory hierarchy Mär 30, 2013 12:28:31 PM org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping registerHandlerMethod INFO: Mapped "{[],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.ModelAndView com.landing.controller.CustomerController.add(javax.servlet.http.HttpServletRequest,org.springframework.ui.ModelMap) Mär 30, 2013 12:28:31 PM org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping registerHandlerMethod INFO: Mapped "{[/],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.String com.landing.controller.CustomerController.listAllFeedsOnIndexPage(org.springframework.ui.ModelMap) throws com.google.appengine.labs.repackaged.org.json.JSONException Mär 30, 2013 12:28:31 PM org.springframework.web.context.ContextLoader initWebApplicationContext INFO: Root WebApplicationContext: initialization completed in 3010 ms Mär 30, 2013 12:28:32 PM com.google.appengine.tools.development.ApiProxyLocalImpl log INFO: javax.servlet.ServletContext log: Initializing Spring FrameworkServlet 'mvc-dispatcher' Mär 30, 2013 12:28:32 PM org.springframework.web.servlet.DispatcherServlet initServletBean INFO: FrameworkServlet 'mvc-dispatcher': initialization started Mär 30, 2013 12:28:32 PM org.springframework.web.context.support.XmlWebApplicationContext prepareRefresh INFO: Refreshing WebApplicationContext for namespace 'mvc-dispatcher-servlet': startup date [Sat Mar 30 12:28:32 UTC 2013]; parent: Root WebApplicationContext Mär 30, 2013 12:28:32 PM org.springframework.beans.factory.xml.XmlBeanDefinitionReader loadBeanDefinitions INFO: Loading XML bean definitions from ServletContext resource [/WEB-INF/mvc-dispatcher-servlet.xml] Mär 30, 2013 12:28:32 PM org.springframework.context.annotation.ClassPathBeanDefinitionScanner registerDefaultFilters INFO: JSR-330 'javax.inject.Named' annotation found and supported for component scanning Mär 30, 2013 12:28:32 PM org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor INFO: JSR-330 'javax.inject.Inject' annotation found and supported for autowiring Mär 30, 2013 12:28:32 PM org.springframework.beans.factory.support.DefaultListableBeanFactory preInstantiateSingletons INFO: Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@1d3f82cd: defining beans [customerController,org.springframework.context.annotation.internalConfigurationAnnotationProcessor,org.springframework.context.annotation.internalAutowiredAnnotationProcessor,org.springframework.context.annotation.internalRequiredAnnotationProcessor,org.springframework.context.annotation.internalCommonAnnotationProcessor,org.springframework.context.annotation.internalPersistenceAnnotationProcessor,mvcContentNegotiationManager,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping#0,org.springframework.format.support.FormattingConversionServiceFactoryBean#0,org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter#0,org.springframework.web.servlet.handler.MappedInterceptor#0,org.springframework.web.servlet.mvc.method.annotation.ExceptionHandlerExceptionResolver#0,org.springframework.web.servlet.mvc.annotation.ResponseStatusExceptionResolver#0,org.springframework.web.servlet.mvc.support.DefaultHandlerExceptionResolver#0,org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping,org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter,org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter,org.springframework.web.servlet.view.InternalResourceViewResolver#0,org.springframework.context.annotation.ConfigurationClassPostProcessor.importAwareProcessor]; parent: org.springframework.beans.factory.support.DefaultListableBeanFactory@9b4ed7a Mär 30, 2013 12:28:32 PM org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping registerHandlerMethod INFO: Mapped "{[],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public org.springframework.web.servlet.ModelAndView com.landing.controller.CustomerController.add(javax.servlet.http.HttpServletRequest,org.springframework.ui.ModelMap) Mär 30, 2013 12:28:32 PM org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping registerHandlerMethod INFO: Mapped "{[/],methods=[GET],params=[],headers=[],consumes=[],produces=[],custom=[]}" onto public java.lang.String com.landing.controller.CustomerController.listAllFeedsOnIndexPage(org.springframework.ui.ModelMap) throws com.google.appengine.labs.repackaged.org.json.JSONException Mär 30, 2013 12:28:32 PM org.springframework.web.servlet.DispatcherServlet initServletBean INFO: FrameworkServlet 'mvc-dispatcher': initialization completed in 520 ms Mär 30, 2013 12:28:32 PM com.google.apphosting.utils.jetty.JettyLogger info INFO: Started SelectChannelConnector@0.0.0.0:8888 Mär 30, 2013 12:28:32 PM com.google.appengine.tools.development.AbstractServer startup INFO: Server default is running at http://`localhost`:8888/ 2013 年 3 月 30 日下午 12:28:32 com.google.appengine.tools.development.AbstractServer 启动信息：管理控制台在 http:// 运行`localhost`:8888/_ah/admin 2013 年 3 月 30 日下午 1:28:32 com.google.appengine.tools.development.DevAppServerImpl 开始信息：开发应用服务器现在正在运行 null null null null null null 2013 年 3 月 30 日 1:28： 39 PM com.google.appengine.api.datastore.dev.LocalDatastoreService 初始化信息：本地数据存储已初始化：类型：高复制存储：C:\Users\user\workspace\LandingPage\war\WEB-INF\appengine-generated\local_db .bin 2013 年 3 月 30 日下午 1:28:39 com.google.appengine.api.datastore.dev.LocalDatastoreService 加载信息：后备存储，C:\Users\user\workspace\LandingPage\war\WEB-INF\appengine -生成\local_db.bin，不存在。它将被创建。null null null null null null null

However, when I press enter in my form. I get one entry of the data and A LOT OF `null` entries. It seems to me that the redirect, does not redirect to the other page, it recursively redirects back.

Any idea how to fix that behaviour?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T19:13:55.883

You can try something like this. I am returning a success page on successful form post.

```
@RequestMapping(value="sendData" ,method = RequestMethod.POST)
public String add(HttpServletRequest request, ModelMap model) {

String firstName = request.getParameter("firstName");
String lastName = request.getParameter("lastName");
String email = request.getParameter("email");

System.out.println(email);
System.out.println(firstName);
System.out.println(lastName);

Customer c = new Customer();
c.setFirstName(firstName);
c.setLastName(lastName);
c.setEmail(email);
c.setDate(new Date());

PersistenceManager pm = PMF.get().getPersistenceManager();
try {
    pm.makePersistent(c);
} finally {
    pm.close();
}

return "successpage";
} 
```

# python - 如何使用 python 增强我的数据集输出

> ID：15718591
> 
> 赞同：0
> 
> 时间：2013-03-30T12:37:56.460
> 
> 标签：python, python-2.7

我有 2 个输入文件，`input.txt`并且`datainput.txt`. 我检查第 2 列是否`input.txt`与 的第 1 列`datainput.txt`匹配，如果匹配，则将其放在`orthodb_id`输出文件中相关行的末尾。

输入.txt：

```
5 21 218
6 11 1931
7 26 173 
```

数据输入.txt：

```
>21|95|28|5
Computer
>11|28|5|5
Cate 
```

代码.py：

```
import csv

with open('input.txt', 'rb') as file1:
    file1_data = dict(line.split(None, 2)[1::-1] for line in file1 if line.strip())

with open('data.txt', 'rb') as file2, open('output.txt', 'wb') as outputfile:
    output = csv.writer(outputfile, delimiter='|')
    for line in file2:
        if line[:1] == '>':
            row = line.strip().split('|')
            key = row[0][1:]
            if key in file1_data:
                 output.writerow(row + [file1_data[key]]) 
```

这是我的代码得到的输出：

```
>21|95|28|5|5
>11|28|5|5|6 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T20:21:41.697

您只需`else`在代码中添加一个块即可获得所需的输出：

```
import csv

with open('input.txt', 'rb') as file1:
    file1_data = dict(line.split(None, 2)[1::-1] for line in file1 if line.strip())

with open('data.txt', 'rb') as file2, open('output.txt', 'wb') as outputfile:
    output = csv.writer(outputfile, delimiter='|')
    for line in file2:
        if line[:1] == '>':
            row = line.strip().split('|')
            key = row[0][1:]
            if key in file1_data:
                output.writerow(row + [file1_data[key]])
        else:
            outputfile.write(line) 
```

# android - TTS 音 - 安卓？

> ID：15718592
> 
> 赞同：2
> 
> 时间：2013-03-30T12:37:57.707
> 
> 标签：android, text-to-speech

我在我的 Android 应用程序中使用 Text to Speech - TTS.. 我已经粘贴了下面的代码.. TTS 工作正常，但是它说的语音/文本不是很清楚.. 它说得很快，所以这不是完全可以理解的。我尝试设置 Locale.US，并使用了 setPitch 或 setSpeechRate，但它并没有真正令人信服。我觉得我的手机（Samsung S2）有问题。所以尝试从 Google Play 商店安装 Google Translate TTS 应用程序。在那个应用程序中，声音非常清晰。

我的应用程序将被孩子们使用..所以要确保声音真的很清晰。在过去的几天里，我一直在努力解决这个问题。如果你能给我一些关于我做错了什么或如何改进的指示，那就太好了？

```
@Override
public void onInit(int status) {

    if (status == TextToSpeech.SUCCESS) {

        int result = tts.setLanguage(Locale.getDefault());

        //tts.setSpeechRate((float) 0.8);
        //tts.setPitch(1.0f);

        if (result == TextToSpeech.LANG_MISSING_DATA
                || result == TextToSpeech.LANG_NOT_SUPPORTED) {
            Log.e("TTS", "This Language is not supported");
        } else {
            speakOut(0);
        }

    } else {
        Intent installIntent = new Intent();
        installIntent.setAction(
            TextToSpeech.Engine.ACTION_INSTALL_TTS_DATA);
        startActivity(installIntent);
    }
}
private void speakOut(int position) {
    tts.speak("Some text goes here", TextToSpeech.QUEUE_FLUSH, null);
} 
```

注意：我尝试在 setPitch 和 setSpeechRate 中将值设置为 0.5f、0.8f 等，但所有语音仍然不像在 GoogleTranslate 应用程序中那样清晰。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T21:07:21.297

你的代码看起来不错。所有 tts 库在整个系统中共享。三星自带 tts 库。其余手机使用 Pico TTS。很棒的是，您的应用程序独立于库，您可以根据需要下载任意数量的 TTS 库，这样当您请求 TTS 意图时，将提示用户选择他们想要的 TTS 合成器你的应用程序。

对我来说，Pico TTS 工作正常。语速/语速是正常的，我只是把语调（音高）调高一点，让这种感觉变得不那么机械化。

```
tts.setPitch(1.1f); 
```

尝试使用 Pico TTS 并回复。

# c++ - std::cout 缓冲区何时可以为非空？

> ID：15718593
> 
> 赞同：1
> 
> 时间：2013-03-30T12:38:03.663
> 
> 标签：c++, buffer, flush

`cout.rdbuf()`例如，我在[这里](http://www.cplusplus.com/reference/ios/ios/rdbuf/)看到过。这意味着，流`cout`有一个与之关联的流缓冲区，在我们刷新它之前它是非空的。

**但是，我怎样才能在 cout 被刷新之前查看 cout 的流缓冲区呢？** IE

```
cout << "I want to read this before this get flushed";
cout.UnknownFunction();  //this would save the buffer into a string variable
cout << flush; 
```

但是在当前的代码形式中，第一行之后的所有内容都将刷新到屏幕上。

那么，什么样的构造可以让我窥视 cout 缓冲区的内部呢？

PS。我在 windows7 上运行 VC++ 2010

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:48:38.323

我认为这不会在第一行之后刷新，但我绝对不确定。我经历过`endl`，但其他人没有，可能是太多角色自动冲洗，但我不知道。我（不小心）创建了一个这样的程序（简而言之）：

```
cout << "x";
while (true) {} 
```

程序运行了这个，输出将是调试，但它没有为我写任何东西，所以我认为程序没有到达那里......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T01:37:16.797

Following link is closely related to this topic [C++ buffered stream IO](https://stackoverflow.com/questions/11392511/c-buffered-stream-io)

(But I'm still not sure how/when to get cout.rdbuf() onto a string.)

# wpf - WPF Lambda 表达式“where” - List 的元素

> ID：15718596
> 
> 赞同：0
> 
> 时间：2013-03-30T12:38:12.410
> 
> 标签：wpf, lambda

我的项目包含一些（带有复选框的组合框）绑定到同一个可观察集合。

如果我从主组合框中检查了一个项目，我应该过滤/更新来自另一个组合的信息

```
TmpFilter.Where(m => m.CarID == "MINI").ToList(); 
```

并且没有问题，但是如果用户检查了多个选项（“MINI”，“AUDI” ... ），选项列表。我不知道如何进行查询。

你能帮我么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:54:59.250

您可以存储第一个组合框中的选定项目列表 -

```
List<string> selectedItems; 
```

并且可以使用简单的查询检查列表中是否存在项目 -

```
TmpFilter.Where(m => selectedItems.Contains(m.CarID)).ToList(); 
```

# emacs - 使用语法表的 emacs 模式下的单行和多行注释

> ID：15718599
> 
> 赞同：3
> 
> 时间：2013-03-30T12:38:29.930
> 
> 标签：emacs, elisp, syntax-highlighting

我正在尝试为注释编写为的语言创建 emacs 语法突出显示

`; A single line comment`

```
;; This comment has
   multipline lines ;; 
```

为此，我需要修改语法表中的条目。我发现以下内容非常适用于多行注释：

```
(modify-syntax-entry ?\; ". 1234" sbgl-mode-syntax-table) 
```

以下内容非常适用于单行注释：

```
(modify-syntax-entry ?\; "< b" sbgl-mode-syntax-table)
(modify-syntax-entry ?\n "> b" sbgl-mode-syntax-table) 
```

有人知道将这些结合起来的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-01T16:44:41.307

如果您可以在每个分号开始单行注释后添加一个空格，则可以将其视为其中一个注释开始序列的第二个字符，然后这是一个适合我的片段：

```
(define-derived-mode sbgl-mode prog-mode "sbgl"
  (set (make-local-variable 'font-lock-defaults)
       '(nil ;; keywords
         nil ;; keywords-only
         nil ;; case-fold
         ((?\; . ". 1234b")
          (?\n . ">")
          (?\  . "- 2"))))) 
```

如果没有，那么您始终可以选择在字体化之前通过`syntax-propertize-function`变量（或Emacs24 之前的变量`font-lock-syntactic-keywords`）进行句法分析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T15:56:51.247

您可以尝试以下方法：

```
(modify-syntax-entry ?\; "< 1234b" sbgl-mode-syntax-table)
(modify-syntax-entry ?\n ">" sbgl-mode-syntax-table) 
```

# c++ - opencv .dll files not found

> ID：15718610
> 
> 赞同：2
> 
> 时间：2013-03-30T12:39:35.973
> 
> 标签：c++, c, eclipse, opencv, codeblocks

I am running windows 8 64 bit and using Code::Blocks as well as Eclipse as IDE for OpenCV v.2.4.4.

I am following the online tutorial at [http://docs.opencv.org/doc/tutorials/core/basic_linear_transform/basic_linear_transform.html#basic-linear-transform](http://docs.opencv.org/doc/tutorials/core/basic_linear_transform/basic_linear_transform.html#basic-linear-transform)

Whenever I include `.dll.a` files in `opencv\build\x64\mingw\lib\` as well as required headers in `opencv\build\include` in my IDE settings and corresponding `opencv\build\x64\mingw\bin` in my PATH variable, I get compile time errors about undefined reference to opencv functions.

Whenever I include the corrosponding 32 bit dll files in my IDE settings and set 32 bit dll files' path in my PATH variable, the program compiles fine. But, when I open the .exe file, it says that '`libopencv_core244.dll` is missing from your computer. Re-install the application.' The PATH variable being set correctly, I don't understand the problem..

I am digging up about this on the web as much as I can but still unable to fix this...please help...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-31T12:44:37.193

Rebooting after updating the PATH variable worked!

# web-services - 无状态 Spring Security 使用

> ID：15718611
> 
> 赞同：3
> 
> 时间：2013-03-30T12:39:42.213
> 
> 标签：web-services, spring-security, access-token, stateless

我需要你对无状态 Spring Security 的帮助。我编写了授权用户的服务，我的**security.xml**：

```
<http use-expressions="true" create-session="stateless" entry-point-ref="restAuthenticationEntryPoint">        
    <intercept-url pattern="/auth/**" access="permitAll" />
    <intercept-url pattern="/**" access="isAuthenticated()" />      
    <custom-filter ref="myFilter" position="FORM_LOGIN_FILTER"/>                         
</http> 

<beans:bean id="myFilter" class="org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter">
      <beans:property name="authenticationManager" ref="authenticationManager"/>    
</beans:bean>

<authentication-manager alias="authenticationManager">
    <authentication-provider user-service-ref="userDetailsService" /> 
</authentication-manager> 
```

它没有说明，这就是为什么在我的身份验证之后，当我想通过另一个 URL 获取任何东西时，它需要我 401 Unauthorized。我听说过令牌，但我不知道如何实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T11:29:42.570

马克西姆斯，

这是我在类似情况下所做的：

使用 OAuth - [http://oauth.net/](http://oauth.net/)

有多个实现 OAuth 规范的库

```
http://tools.ietf.org/html/rfc6749 
```

Spring 有一个易于配置的实现。为此，Spring 提供了两个示例应用程序（服务器和客户端）。教程可在以下位置获得：

```
https://github.com/SpringSource/spring-security-oauth/wiki/tutorial 
```

示例工作配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oauth="http://www.springframework.org/schema/security/oauth2"
    xmlns:ss="http://www.springframework.org/schema/security" xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:jdbc="http://www.springframework.org/schema/jdbc" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:util="http://www.springframework.org/schema/util"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans 
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context 
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/security 
        http://www.springframework.org/schema/security/spring-security-3.1.xsd
        http://www.springframework.org/schema/security/oauth2 
        http://www.springframework.org/schema/security/spring-security-oauth2-1.0.xsd
        http://www.springframework.org/schema/jdbc 
        http://www.springframework.org/schema/jdbc/spring-jdbc-3.1.xsd
        http://www.springframework.org/schema/tx 
        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
        http://www.springframework.org/schema/mvc 
        http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
        http://www.springframework.org/schema/util 
        http://www.springframework.org/schema/util/spring-util.xsd
        ">

    <ss:http pattern="/test/customer/**" create-session="stateless"
        access-decision-manager-ref="accessDecisionManager"
        entry-point-ref="oauthAuthenticationEntryPoint"
        xmlns="http://www.springframework.org/schema/security">
        <ss:anonymous enabled="false" />
        <ss:intercept-url pattern="/test/customer/welcome*"
            access="ROLE_USER" />
        <ss:custom-filter ref="resourceServerFilter" before="PRE_AUTH_FILTER" />
        <ss:access-denied-handler ref="oauth2AccessDeniedHandler" />
    </ss:http>

    <ss:http pattern="/oauth/token" create-session="stateless"
        entry-point-ref="oauthAuthenticationEntryPoint"
        authentication-manager-ref="authenticationManager">
        <ss:intercept-url pattern="/oauth/token" access="IS_AUTHENTICATED_FULLY" />
        <ss:anonymous enabled="false" />
        <ss:custom-filter ref="clientCredentialsTokenEndpointFilter"
            before="BASIC_AUTH_FILTER" />
        <ss:access-denied-handler ref="oauth2AccessDeniedHandler" />
    </ss:http>

    <ss:authentication-manager alias="authenticationManager">
        <ss:authentication-provider ref="myAuthenticationProvider" />
    </ss:authentication-manager>

    <oauth:resource-server id="resourceServerFilter" token-services-ref="tokenServices" />

    <bean id="myAuthenticationProvider" class="com.sachin.test.ws.user.MyUserAuthenticationProvider" />

    <bean id="oauthAuthenticationEntryPoint"
        class="org.springframework.security.oauth2.provider.error.OAuth2AuthenticationEntryPoint">
        <property name="realmName" value="myCustomerAppRealm" />
    </bean>

    <bean id="clientDetailsUserService"
        class="org.springframework.security.oauth2.provider.client.ClientDetailsUserDetailsService">
        <constructor-arg ref="clientDetailsService" />
    </bean>

    <oauth:authorization-server
        client-details-service-ref="clientDetailsService" token-services-ref="tokenServices">
        <oauth:authorization-code />
        <oauth:implicit />
        <oauth:refresh-token />
        <oauth:client-credentials />
        <oauth:password />
    </oauth:authorization-server>

    <oauth:client-details-service id="clientDetailsService">
        <oauth:client client-id="admin"
            authorized-grant-types="password,authorization_code,refresh_token,implicit,client_credentials"
            authorities="ROLE_USER, ROLE_TRUSTED_CLIENT" scope="read,write,trust"
            access-token-validity="60" />
    </oauth:client-details-service>

    <bean id="oauth2AccessDeniedHandler"
        class="org.springframework.security.web.access.AccessDeniedHandlerImpl" />

    <bean id="clientCredentialsTokenEndpointFilter"
        class="org.springframework.security.oauth2.provider.client.ClientCredentialsTokenEndpointFilter">
        <property name="authenticationManager" ref="authenticationManager" />
    </bean>

    <bean id="accessDecisionManager" class="org.springframework.security.access.vote.UnanimousBased"
        xmlns="http://www.springframework.org/schema/beans">
        <constructor-arg>
            <list>
                <bean class="org.springframework.security.oauth2.provider.vote.ScopeVoter" />
                <bean class="org.springframework.security.access.vote.RoleVoter" />
                <bean class="org.springframework.security.access.vote.AuthenticatedVoter" />
            </list>
        </constructor-arg>
    </bean>

    <bean id="tokenStore"
        class="org.springframework.security.oauth2.provider.token.InMemoryTokenStore" />

    <bean id="tokenServices"
        class="org.springframework.security.oauth2.provider.token.DefaultTokenServices">
        <property name="tokenStore" ref="tokenStore" />
        <property name="supportRefreshToken" value="true" />
    </bean>

</beans> 
```

将此添加到 web.xml：

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>
<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
</filter-mapping> 
```

您需要阅读 OAuth 和 Spring 安全性规范以了解我所做的事情。您可以扩展此代码以使用您的数据库在多个服务器之间进行身份验证和令牌共享。

希望这可以帮助。

# java - 将 int 与 2 个值进行比较

> ID：15718612
> 
> 赞同：2
> 
> 时间：2013-03-30T12:39:45.230
> 
> 标签：java

我正在尝试根据 INT 的值更改 JTextField 的背景颜色。为什么下面的比较代码不起作用？

```
if (braincomplete < 0 && > 10){
        //set the colour red        
    }
if (braincomplete > 10 &&  <18){
        //set the colour yellow 
}
if (braincomplete >18){
    //set the colour green
} 
```

我认为 && 对 Java 是正确的？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T12:40:45.077

如果您想比较 if 块内的两个值，您的 if 块应该是这样的

```
if (braincomplete < 0 && braincomplete > 10){
    //set the colour red

}
if (braincomplete > 10 && braincomplete <18){
    //set the colour yellow

}
if (braincomplete >18){
    //set the colour green
} 
```

我不认为你想检查这个条件

```
if (braincomplete < 0 && braincomplete > 10) 
```

您可能想要检查 Braincomplete 的值应该在 0 到 10 之间。所以应该是：

```
if (braincomplete > 0 && braincomplete < 10) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:43:24.187

你应该重写变量

```
if (braincomplete > 0 && braincomplete  <= 10){
        //set the colour red

    }
    if (braincomplete > 10 && braincomplete  <=18){
        //set the colour yellow

    }
    if (braincomplete >  18){
        //set the colour green 
```

# c# - 如何在c#水晶报表中将字符串字段转换为十进制值

> ID：15718617
> 
> 赞同：0
> 
> 时间：2013-03-30T12:40:27.080
> 
> 标签：c#, crystal-reports

我有一个包含一些百分比（如 5）的字符串字段。现在我将该字符串字段转换为十进制值而不是计算总金额。那么如何在水晶报表公式字段中将字符串字段转换为十进制值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:46:09.623

试试 Decimal.TryParse 方法。

```
Decimal.TryParse 
```

请参阅[此处](http://msdn.microsoft.com/en-us/library/system.decimal.tryparse.aspx)的参考。

# php - 使用 jQuery ajax 创建数据库表的问题

> ID：15718630
> 
> 赞同：1
> 
> 时间：2013-03-30T12:41:29.193
> 
> 标签：php, javascript, jquery, sql, ajax

我对 jQuery 和 ajax 完全陌生。目前，我正在尝试从我将语句发布到 .php 文件以执行语句的 javascript 文件在我的本地 sql 服务器上创建一个表。

.js 文件：

```
function executeStatement(sqlStatement){
    $.ajax({
      type: "post",
      data: sqlStatement,
      cache: false,
      url: "api.php",
      dataType: "text",
      error: function(xhr, status, error) {
        var err = eval("(" + xhr.responseText + ")");
        alert(err.Message);
      },
      success: function ()
      {
        alert ("Success!!");
      }
    });
  } 
```

.php 文件：

```
 require_once('PhpConsole.php');
  PhpConsole::start();
  debug('HERE!!!');

  $sqlStatement = $_POST['sqlStatement'];

  $host = "*****";
  $user = "*****";
  $pass = "*****";
  $databaseName = "db_user_data";

  // Create connection
  $con = mysqli_connect($host, $user, $pass, $databaseName);

  // Check connection
  if (mysqli_connect_errno($con)){
    echo "Failed to connect to MySQL: " . mysqli_connect_error();
  }
  else{
    $con->query($sqlStatement);
    header('Location: success.php');  
  } 
```

我使用 PHP 控制台来调试 .php 文件，但在这种情况下，即使是第一个日志“这里！！！” 没有打印到控制台，所以我想知道它是否到达了这个 .php 文件。无论如何，`success`即使数据库中没有更改，也会到达 executeStatement 方法中的事件并打印“成功”。顺便说一下，.php 文件也在本地服务器上执行。有人知道问题出在哪里吗？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:46:01.100

您的 PHP 代码中的“$pass”变量有一个错字：

```
require_once('PhpConsole.php');
PhpConsole::start();
debug('HERE!!!');

$sqlStatement = $_POST['sqlStatement'];

$host = "*****";
$user = "*****";
**$pass = "*****";**
$databaseName = "db_user_data";

// Create connection
$con = mysqli_connect($host, $user, $pass, $databaseName);

// Check connection
if (mysqli_connect_errno($con)){
  echo "Failed to connect to MySQL: " . mysqli_connect_error();
}
else{
  $con->query($sqlStatement);
  header('Location: success.php');  
} 
```

EDIT: Here is my revised JS code - this works perfectly for me as I am able to pass the code from an AJAX call to the PHP code and back. Try this:

```
var sqlStatement = "sqlStatement=SQLSTATEMENTHERE";
$.ajax({
  type: "POST",
  data: sqlStatement,
  cache: false,
  url: "api.php",
  success: function ()
  {
    alert ("Success!!");
  }
}); 
```

Place the variable outside of your function and the ajax call inside to replace the old one. As for the PHP, i'll check that out in a second.

# java - logger4j IsTracingEnabled

> ID：15718632
> 
> 赞同：4
> 
> 时间：2013-03-30T12:41:31.713
> 
> 标签：java, grails, trace

在 IntelliJ 中出现此 Grails 错误，以前从未见过。我正在运行 Grails 2.2.1

```
| Error Fatal error during compilation java.lang.NoSuchMethodError: org.apache.log4j.Logger.isTraceEnabled()Z (NOTE: Stack trace has been filtered. Use --verbose to see entire trace.)
java.lang.NoSuchMethodError: org.apache.log4j.Logger.isTraceEnabled()Z
at org.slf4j.impl.GrailsLog4jLoggerAdapter.isTraceEnabled(GrailsLog4jLoggerAdapter.java:51)
at org.apache.commons.logging.impl.SLF4JLog.isTraceEnabled(SLF4JLog.java:86)
at org.springframework.context.annotation.ClassPathScanningCandidateComponentProvider.findCandidateComponents(ClassPathScanningCandidateComponentProvider.java:230)
at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.doScan(ClassPathBeanDefinitionScanner.java:242)
at org.springframework.context.annotation.ClassPathBeanDefinitionScanner.scan(ClassPathBeanDefinitionScanner.java:220)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrConstructorNewInstance(ReflectiveInterceptor.java:975)
at _GrailsCompile_groovy$_run_closure3_closure8_closure9.doCall(_GrailsCompile_groovy:62)
at _GrailsCompile_groovy$_run_closure3_closure8_closure9.doCall(_GrailsCompile_groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at _GrailsCompile_groovy.withCompilationErrorHandling(_GrailsCompile_groovy:69)
at _GrailsCompile_groovy.this$4$withCompilationErrorHandling(_GrailsCompile_groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:168)
at _GrailsCompile_groovy$_run_closure3_closure8.doCall(_GrailsCompile_groovy:61)
at _GrailsCompile_groovy$_run_closure3_closure8.doCall(_GrailsCompile_groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at _GrailsCompile_groovy$_run_closure3.doCall(_GrailsCompile_groovy:58)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding.withTargetEvent(GantBinding.groovy:90)
at org.codehaus.gant.GantBinding.this$4$withTargetEvent(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.processClosure(GantMetaClass.java:81)
at org.codehaus.gant.GantMetaClass.processArgument(GantMetaClass.java:95)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:128)
at _GrailsCompile_groovy$_run_closure2.doCall(_GrailsCompile_groovy:45)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding.withTargetEvent(GantBinding.groovy:90)
at org.codehaus.gant.GantBinding.this$4$withTargetEvent(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:168)
at _GrailsPackage_groovy$_run_closure2_closure9.doCall(_GrailsPackage_groovy:42)
at _GrailsPackage_groovy$_run_closure2_closure9.doCall(_GrailsPackage_groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at _GrailsPackage_groovy$_run_closure2.doCall(_GrailsPackage_groovy:41)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding.withTargetEvent(GantBinding.groovy:90)
at org.codehaus.gant.GantBinding.this$4$withTargetEvent(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.processClosure(GantMetaClass.java:81)
at org.codehaus.gant.GantMetaClass.processArgument(GantMetaClass.java:95)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:128)
at RunApp$_run_closure1.doCall(RunApp.groovy:30)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantMetaClass.invokeMethod(GantMetaClass.java:133)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16_closure18.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding.withTargetEvent(GantBinding.groovy:90)
at org.codehaus.gant.GantBinding.this$4$withTargetEvent(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy:185)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.codehaus.gant.GantBinding$_initializeGantBinding_closure5_closure16.doCall(GantBinding.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at gant.Gant$_dispatch_closure5.doCall(Gant.groovy:381)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at gant.Gant$_dispatch_closure7.doCall(Gant.groovy:415)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at gant.Gant$_dispatch_closure7.doCall(Gant.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at gant.Gant.withBuildListeners(Gant.groovy:427)
at gant.Gant.this$2$withBuildListeners(Gant.groovy)
at gant.Gant$this$2$withBuildListeners.callCurrent(Unknown Source)
at gant.Gant.dispatch(Gant.groovy:415)
at gant.Gant.this$2$dispatch(Gant.groovy)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at gant.Gant.invokeMethod(Gant.groovy)
at gant.Gant.executeTargets(Gant.groovy:591)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at gant.Gant.executeTargets(Gant.groovy:590)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at org.springsource.loaded.ri.ReflectiveInterceptor.jlrMethodInvoke(ReflectiveInterceptor.java:1243)
at com.intellij.rt.execution.application.AppMain.main(AppMain.java:120)
| Error Fatal error during compilation java.lang.NoSuchMethodError: org.apache.log4j.Logger.isTraceEnabled()Z 
```

关于这是什么的任何想法？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-30T12:48:23.733

似乎 Groovy 正在将它自己的 slf4j-log4j 桥绑定到`Spring`slf4j 日志框架，并且正在调用类路径中不存在的 log4j 版本的方法。

据此，[它](http://mailman.qos.ch/pipermail/slf4j-dev/2007-December/001238.html)要调用的方法，`org.apache.log4j.Logger.isTraceEnabled()`直到 log4j 的 1.2.12 版本才添加，因此请确保您在类路径中拥有的版本是该版本或更高版本。

# java - Oracle JDBC 连接问题

> ID：15718634
> 
> 赞同：1
> 
> 时间：2013-03-30T12:41:51.883
> 
> 标签：java, jdbc

我正在尝试在 Java Web 项目中连接到 Oracle 数据库，这是我得到的例外：

```
 java.sql.SQLException: Exception d'E/S: Got minus one from a read
 call at
 oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134) at
 oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:179) at
 oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:333) at
 oracle.jdbc.driver.OracleConnection.(OracleConnection.java:404) at
 oracle.jdbc.driver.OracleDriver.getConnectionInstance(OracleDriver.java:468)
 at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:314) at
 java.sql.DriverManager.getConnection(Unknown Source) at
 java.sql.DriverManager.getConnection(Unknown Source) at
 mypack1.login.doPost(login.java:60) at
 javax.servlet.http.HttpServlet.service(HttpServlet.java:641) at
 javax.servlet.http.HttpServlet.service(HttpServlet.java:722) at
 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
 at
 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
 at
 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
 at
 org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
 at
 org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
 at
 org.ow2.jonas.web.tomcat7.CheckOpenResourcesValve.invoke(CheckOpenResourcesValve.java:69)
 at
 org.ow2.jonas.web.tomcat7.tx.TransactionValve.invoke(TransactionValve.java:89)
 at
 org.ow2.jonas.web.tomcat7.ResetAuthenticationValve.invoke(ResetAuthenticationValve.java:95)
 at
 org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
 at
 org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
 at
 org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
 at
 org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
 at
 org.ow2.jonas.web.tomcat7.versioning.VersioningValve.invoke(VersioningValve.java:105)
 at
 org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
 at
 org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
 at
 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
 at
 org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:307)
 at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
 at java.lang.Thread.run(Unknown Source) 
```

这是我的连接代码：

```
try {
    Class.forName("oracle.jdbc.OracleDriver");
} catch (ClassNotFoundException e) {
    StringWriter sw = new StringWriter();
    e.printStackTrace(new PrintWriter(sw));
    String exceptionAsString = sw.toString();
    out.println("<html><head><title>Hello World</title></head><body>");
    out.println ("<h1>Where is your Oracle JDBC Driver?</h1>"+exceptionAsString+"</body></html>");      
    return;
}
out.println("<html><head><title>Hello World</title></head><body>");
out.println ("<h1>Oracle JDBC Driver Registered!</h1></body></html>");
Connection connection = null;
try {
    connection = DriverManager.getConnection("jdbc:oracle:thin:@localhost:3010/apex/:XE","JEE","admin");
} catch (SQLException e) {
    StringWriter sw = new StringWriter();
    e.printStackTrace(new PrintWriter(sw));
    String exceptionAsString = sw.toString();
    out.println("<html><head><title>Hello World</title></head><body>");
    out.println ("<h1>Connection Failed! Check output console</h1>"+exceptionAsString+"</body></html>");
    e.printStackTrace();
    return;
}
if (connection != null) {
    out.println("<html><head><title>Hello World</title></head><body>");
    out.println ("<h1>You made it, take control your database now!</h1></body></html>");
} else {
    out.println("<html><head><title>Hello World</title></head><body>");
    out.println ("<h1>Failed to make connection!</h1></body></html>");
} 
```

# php - 如何将 JS 放入 if 语句中

> ID：15718637
> 
> 赞同：-2
> 
> 时间：2013-03-30T12:42:15.957
> 
> 标签：php, javascript, magento

我想在 PHP if 中加入一些 JavaScript。如下所示。但是我不能让它正常工作，建议？

```
 if ($_option->getTitle() == 'Condition') {
            '<script language="javascript">
function displayCondition() {
condition = new Array("Please Select a Condition.","<b>Perfect:</b> Text to explain perfect condition!", "<b>Excellent:</b> Text to explain excellent condition!", "<b>Good:</b> Text to explain good condition!", "<b>Poor:</b> Text to explain poor condition!", "<b>Broken:</b> Text to explain broken condition!");
var getsel = document.getElementById(\'select_'.$_option->getId().'\').value;
document.getElementById("divId").innerHTML = condition[getsel];
}
</script>';
            $extraParams .= ' onchange="opConfig.reloadPrice();displayCondition();"';
        } else if 
            ($_option->getTitle() == 'Original Packaging') {
            $extraParams .= ' onchange="opConfig.reloadPrice();Select(select_'.$_option->getId().',\'divShow\',2);"';
        } else {
            $extraParams .= ' onchange="opConfig.reloadPrice();"';
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:44:57.397

当你混合 PHP 和 HTML（包括 JavaScript）时，你必须注意 PHP 的开始标签：

```
if ($_option->getTitle() == 'Condition') {
    // go out of PHP
    ?>
    <script language="javascript">
       function displayCondition() {
         condition = new Array("Please Select a Condition.","<b>Perfect:</b> Text to explain perfect condition!", "<b>Excellent:</b> Text to explain excellent condition!", "<b>Good:</b> Text to explain good condition!", "<b>Poor:</b> Text to explain poor condition!", "<b>Broken:</b> Text to explain broken condition!");
         var getsel = document.getElementById('select_<?php echo $_option->getId(); ?>').value;
         document.getElementById("divId").innerHTML = condition[getsel];
       }
    </script>
    <?php
    // back to php
    $extraParams .= ' onchange="opConfig.reloadPrice();displayCondition();"'; 
```

您也可以尝试制作大的`echo`，但这涉及处理引号擒纵机构并且通常更重。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T12:50:55.917

只要确保你回显`<script>`.

```
<?php if (condition) {
  echo '<script> //do stuff </script>';
?> 
```

或者使用[控制结构的替代语法](http://php.net/manual/en/control-structures.alternative-syntax.php)将 包含`<script>`到页面中

```
<?php if (condition): ?>
  <script> //do stuff </script>
<?php endif; ?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T12:52:39.300

你可以这样写

```
 $extraParams = "";
if ($_option->getTitle() == 'Condition') {
$extraParams .= '<script>...you script </script>';

$extraParams .= ' onchange="opConfig.reloadPrice();displayCondition();"';
    } else if 
        ($_option->getTitle() == 'Original Packaging') {
        $extraParams .= ' onchange="opConfig.reloadPrice();Select(select_'.$_option->getId().',\'divShow\',2);"';
    } else {
        $extraParams .= ' onchange="opConfig.reloadPrice();"';
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T12:58:37.700

在 PHP 中处理大型标记时，您应该使用[PHP 的 HEREDOC 。](http://php.net/manual/en/language.types.string.php)

```
$script_tage = <<<HEREDOC
<script language="javascript">
    function displayCondition() {
    condition = ["Please Select a Condition.","<b>Perfect:</b> Text to explain perfect condition!", "<b>Excellent:</b> Text to explain excellent condition!", "<b>Good:</b> Text to explain good condition!", "<b>Poor:</b> Text to explain poor condition!", "<b>Broken:</b> Text to explain broken condition!"];
    var getsel = document.getElementById('select_'.{$_option->getId()}).value;
    document.getElementById("divId").innerHTML = condition[getsel];
</script>
HEREDOC;

if ($_option->getTitle() == 'Condition') {
    echo $script_tag;
} 
```

**Note**- there is no need to escape anything in HEREDOC. To enter variables in the HEREDOC string, just put them in a pair of braces like `{$foo}`.

# emacs - 自定义 HTML 标头的面（h1、h2 等）

> ID：15718643
> 
> 赞同：0
> 
> 时间：2013-03-30T12:42:38.490
> 
> 标签：emacs, emacs-faces

我对 emacs 很陌生，尽管有很棒的[在线文档](http://www.gnu.org/software/emacs/manual/html_node/elisp/Syntactic-Font-Lock.html#Syntactic-Font-Lock)，但我不知道如何自定义应用于 HTML 标头标记（例如`<h1>Content here</h1>`）之间的内容的面部，以便在 emacs 中内容不会显示为带下划线或粗体。换句话说，我希望这样的内容完全没有装饰，作为纯默认文本显示。

一般来说，如何定制基于句法（不是基于关键字）的突出显示？

有谁知道如何进行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:35:50.550

这取决于用于编辑 html 文件的模式。但基本上，您可以将光标放在文本上，然后执行`M-x customize-face`- Emacs 会询问面的名称（字体+颜色+ ...），默认情况下它会用面的名称代替光标下的文本，因此您只需按 Enter。之后，Emacs 将打开新的缓冲区，您可以在其中编辑参数。之后，您可以按“应用”（仅为当前会话设置），或“保存”将这些参数保存到带有设置的文件中。

# gwt - GWT: How to determine the height of a text/font as it appears onto a canvas?

> ID：15718644
> 
> 赞同：0
> 
> 时间：2013-03-30T12:42:46.793
> 
> 标签：gwt, canvas

How do you determine the height (in pixels) of a font/line of text as it appears on a canvas? Any ideas how this can be done using GWT are appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T15:24:41.183

GWT translates to Javascript and hence can only work on canvas via javascript api's. So you can either use the javascript solution invoked in GWT JSNI or rewrite the solution in native GWT Java.

I would pick Daniel Earwicker solution on stackoverflow - [How can you find the height of text on an HTML canvas?](https://stackoverflow.com/questions/1134586/how-can-you-find-the-height-of-text-on-an-html-canvas)

# node.js - 如何将 Node.js 制作的网站发布到 Github Pages？

> ID：15718649
> 
> 赞同：133
> 
> 时间：2013-03-30T12:43:41.307
> 
> 标签：node.js, github-pages

我使用 Node.js 作为服务器创建了一个网站。据我所知，node.js 文件应该通过在终端中输入命令开始工作，所以我不确定 Github Pages 是否支持 node.js-hosting。所以我该怎么做？

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2013-03-30T13:32:46.883

GitHub 页面仅托管静态 HTML 页面。不支持服务器端技术，因此 Node.js 应用程序不会在 GitHub 页面上运行。[Node.js wiki](https://github.com/joyent/node/wiki/Node-Hosting)上列出了许多托管服务提供商。

~~应用程序雾似乎是最经济的，因为它为具有 2GB RAM 的项目提供免费托管（如果你问我，这非常好）。~~
*[如此处所述](https://blog.appfog.com/changes-to-appfog-free-plans/)，AppFog 删除了针对新用户的免费计划。*

如果您想在 GitHub 上托管静态页面，请阅读[本指南](https://help.github.com/articles/user-organization-and-project-pages)。如果您打算使用[Jekyll](http://jekyllrb.com/)，那么[本指南](http://www.andrewmunsell.com/tutorials/jekyll-by-example/)将非常有帮助。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2014-12-15T09:50:36.673

我们这些 Javascript 爱好者，不必使用 Ruby（Jekyll 或 Octopress）在 Github 页面中生成静态页面，我们可以使用 Node.js 和[Harp](http://harpjs.com/)，例如：

这些是[步骤](http://harpjs.com/docs/deployment/github-pages)。抽象的：

1.  创建新存储库
2.  克隆存储库

    ```
    git clone https://github.com/your-github-user-name/your-github-user-name.github.io.git 
    ```

3.  初始化 Harp 应用程序（本地）：

    ```
    harp init _harp 
    ```

确保在开头使用下划线命名文件夹；当您部署到 GitHub Pages 时，您不希望提供源文件。

4.  编译你的 Harp 应用程序

    ```
    harp compile _harp ./ 
    ```

5.  部署到 Gihub

    ```
    git add -A
    git commit -a -m "First Harp + Pages commit"
    git push origin master 
    ```

这[是一个很酷的教程](http://kennethormandy.com/journal/start-a-blog-with-harp)，详细介绍了布局、局部、Jade 和 Less 等好东西。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-07-07T03:00:33.703

我能够设置[github 操作](https://github.com/features/actions)，以在将新提交推送到 master 时自动将节点构建命令的结果（`yarn build`在我的情况下，但它也应该与 npm 一起使用）提交到分支。`gh-pages`

虽然不完全理想，因为我想避免提交构建的文件，但这似乎是目前发布到 github 页面的唯一方法，并且应该适用于任何前端 Node.js 应用程序（或使用 React 等前端框架构建的应用程序或 Vue) 可以用作静态文件。

我将我的工作流程基于[本](https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-react-and-next)指南用于不同的反应库，并且必须进行以下更改才能使其为我工作：

*   更新了“设置节点”步骤以使用[此处](https://github.com/marketplace/actions/setup-node-js-environment)找到的版本，因为我基于它的示例中的版本抛出错误，因为它找不到正确的操作。
*   删除包含的行，`yarn export`因为该命令不存在并且它似乎没有添加任何有用的东西（您可能还想更改它上面的构建行以满足您的需要）
*   我还在`env`该步骤中添加了一个指令，`yarn build`以便我可以在我的应用程序中包含生成构建的提交的 SHA 哈希，但这是可选的

这是我完整的 github 操作：

```
name: github pages

on:
    push:
        branches:
        - master

jobs:
    deploy:
        runs-on: ubuntu-18.04
        steps:
        - uses: actions/checkout@v2

        - name: Setup Node
            uses: actions/setup-node@v2-beta
            with:
            node-version: '12'

        - name: Get yarn cache
            id: yarn-cache
            run: echo "::set-output name=dir::$(yarn cache dir)"

        - name: Cache dependencies
            uses: actions/cache@v2
            with:
            path: ${{ steps.yarn-cache.outputs.dir }}
            key: ${{ runner.os }}-yarn-${{ hashFiles('**/yarn.lock') }}
            restore-keys: |
                ${{ runner.os }}-yarn-
        - run: yarn install --frozen-lockfile
        - run: yarn build
            env:
            REACT_APP_GIT_SHA: ${{ github.SHA }}

        - name: Deploy
            uses: peaceiris/actions-gh-pages@v3
            with:
            github_token: ${{ secrets.GITHUB_TOKEN }}
            publish_dir: ./build 
```

# 替代解决方案

next.js的[文档还提供了使用](https://nextjs.org/docs/deployment#getting-started)[Vercel](http://%20https://vercel.com)进行设置的说明，这似乎是类似于 github 页面的 node.js 应用程序的托管服务。不过我还没有尝试过，所以不能说它的效果如何。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-11-24T07:46:54.000

不，您不能在 Github 页面上发布。试试 Heroku 或类似的东西。您只能在 github 页面上部署静态站点。您不能在 github 页面上部署服务器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-09-08T01:59:39.690

我想补充一点，这**很有**可能，因为我现在正在这样做。这是我的做法：

（我假设你有一个准备发布的包和/或目录。）

在你的根目录下`package.json`，添加

```
"homepage": "https://{pages-endpoint}/{repo}", 
```

其中`pages-endpoint`是您在存储库的**Settings** -> **Pages**部分中`blah.github.io`指定的端点，并且是存储库的名称。****`repo`****

 ****然后确定你`npm install --global gh-pages --save-dev`。您需要`--global`确保 bin 文件位于您的 PATH 中，并且`--save-dev`应将其作为依赖项添加到您的`package.json`

之后，只是`npm run build && gh-pages -d build`。指定您的`-d`输出构建目录。标准是`build`，但我的是`public`。如果它不同，只需更改它。

最后，确保在**Settings** -> **Pages**部分中，选择`gh-pages`要托管的分支并将目录保留为`/ (root)`. 构建完成后，您的站点应该在您的 github.io 端点上可用。

快乐的开发！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-10-19T16:03:09.347

不，GitHub 只允许托管静态网站（只有 HTML、CSS、javascript）。

动态网站（具有数据库、服务器等）不能作为 Github 页面托管。而 node.js 应用程序是基于服务器的网站，我们无法将其托管在 Github 上。您可以尝试**Heroku**、**Openshift**来托管您的网站。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-11-22T08:57:03.740

嗯。是的，正如大多数答案所说。Github Pages 只处理 html 和 css 以及一个前端 JS。

但是你可以使用像 Gatsby 这样的 JS 框架，将它连接到你的 Graphql 作为数据库。然后它会给你一个生成的静态文件。然后就是不断更新您的存储库并使用静态文件夹作为您的页面的根目录。

现在你有一个动态静态页面。

我会做一些，因为这是个好主意。

* * *

## 回答 #8

> 赞同：-41
> 
> 时间：2018-06-27T10:01:28.577

将您的 node js 应用程序从本地推送到 GitHub 是非常简单的步骤。

脚步：

1.  首先在 GitHub 上新建一个仓库
2.  打开安装到系统的 Git CMD（安装[GitHub Desktop](https://desktop.github.com/)）
3.  使用以下命令将存储库克隆到您的系统：`git clone repo-url`
4.  现在将所有应用程序文件复制到这个克隆的库中（如果它不存在）
5.  准备好一切准备提交：`git add -A`
6.  提交跟踪的更改并准备将它们推送到远程存储库：`git commit -a -m "First Commit"`
7.  将本地存储库中的更改推送到 GitHub：`git push origin master`****

# continuous-integration - 如何发布以使用 gradle 解决 latest.integration？

> ID：15718652
> 
> 赞同：2
> 
> 时间：2013-03-30T12:43:49.043
> 
> 标签：continuous-integration, gradle

我拥有的是一个 Maven 存储库（nexus），Maven 一直在向其发布。在我的工件存储库文件夹中的每个工件版本文件夹中，都有标准的 maven 工件：maven-metadata.xml、jar 和 pom.xml 等。

现在我想使用 gradle 解决这些问题。在我的 gradle.build 文件中，如果我将它们列为：

```
dependencies {
    compile group: 'com.company', name: 'artifact', version: '1.0-SNAPSHOT'
} 
```

然后他们将正确解决。但是，我想使用“latest.integration”版本，以便我可以自动集成我的依赖项的最新版本。但是，当我这样做时，gradle 无法解决它。

我想gradle正在寻找一些maven没有发布到存储库的常春藤特定文件以解决latest.integration，但我不确定。在尝试解析下游之前，我是否应该返回并使用 gradle 重新发布所有上游依赖项？似乎由于 gradle 在 repositories 元素下支持 maven 存储库，它应该已经知道如何解释该存储库类型的“latest.integration”。

这是我的存储库部分：

```
repositories {
    mavenCentral()
    maven { url "http://<server>/nexus/content/repositories/snapshots" }
} 
```

感谢您提供任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:38:15.873

`latest.integration`是 Ivy 概念，仅适用于 Ivy 存储库。换句话说，出版和消费都必须以与常春藤兼容的方式发生。（Gradle 能够做到这一点；不确定 Nexus。）

The obvious alternative is to use Maven snapshot dependencies. What do you hope to gain from using `latest.integration`?

# makefile - 没有扩展名的Makefile模式规则？

> ID：15718653
> 
> 赞同：24
> 
> 时间：2013-03-30T12:43:51.777
> 
> 标签：makefile, gnu-make

我有一堆使用相同类型的 make 规则构建的应用程序：

```
apps = foo bar baz

all: $(apps)

foo: foo.o $(objects)
    $(link)

bar: bar.o $(objects)
    $(link)

baz: baz.o $(objects)
    $(link) 
```

如果他们有扩展名（例如`.x`），我可以制定一个模式规则，例如：

```
%.x: %.o $(objects)
    $(link) 
```

而且我不必为每个应用程序编写新规则。

但他们没有扩展名，我很确定：

```
%: %.o $(objects)
    $(link) 
```

将不起作用（因为它指定要构建可以使用此规则的*任何文件）。*

无论如何要指定一个涵盖所有`$(apps)`构建规则的规则？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-30T12:49:56.403

这看起来像是[静态模式规则](http://www.gnu.org/software/make/manual/make.html#Static-Pattern)的工作：

```
$(apps) : % : %.o $(objects)
    $(link) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-30T12:51:21.717

```
%: %.o $(objects)
    $(link) 
```

以上应该工作。

You can limit the scope of the rule by converting it into a [static pattern rule](http://www.gnu.org/software/make/manual/make.html#Static-Pattern), so that it is only considered for your list of targets:

```
$(apps) : % : %.o $(objects) # only consider this for $(apps) targets
    $(link) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T20:39:38.243

not an answer to what you are looking for , but a reason that might explain why such level of generic code might not yield good results. ....

static patterns rely on the presence of a stem to match and build a dependency chain. pretty much in the same manner as the implicit rules (which are used for targets that dont have any recipie.)

i see what you were trying to achive , making a generic rule that will satisfy all the target checks for object and link in your code.

something like this ::

```
 % : % : $(rule1)
         echo / generic code ; 
```

so that it gets invoked for all apps in differnt scenarios

since you dont want to add a extension (this becomes the root of some issues ) the issue with this is that the target will get reflected in the dependency as well since there will be no way of differentiating the dependencies form the targets.

hence if you did try that i think you will get here ...

```
 $ make -nf mk.t
   mk.t:18: *** mixed implicit and static pattern rules.  Stop. 
```

:) , i will give this a try again tomorrow to see if i can get this working in a real generic way. Nice question though.

# apache - 房地产大规模301重定向

> ID：15718658
> 
> 赞同：2
> 
> 时间：2013-03-30T12:44:39.920
> 
> 标签：apache, mod-rewrite, url-rewriting

试图弄清楚如何处理新客户房地产网站的重定向。

我们根本无法访问旧站点，并且由于随机生成的属性 ID，新站点的 url 结构强制不同（我们的系统生成与旧站点不同的 ID）

旧的 url 结构是 www.mydomain.com/property/view?=1111

新的 url 结构是 www.mydomain.com/property/street-name/2222

我的直觉是对每个属性（大约 6000 个）进行手动 301，按页面标题匹配，但遗憾的是，我无法访问旧网站的结构，尽管多次爬取它，但我无法获取所有属性离开。

如果有人可以就如何最好地避免糟糕的用户体验和谷歌炒作给我任何建议，我将不胜感激。

提前致谢。

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-16T00:14:44.507

这取决于1111是什么。如果这对应于 MLS ID 号（某种 UID），那么您应该能够使用正则表达式来使其工作。大多数 IDX 供应商都提供了一种通过 MLSID 获取列表的方法。

如果该 1111 只是以前 IDX 供应商的 GUID，那么您可能不走运，需要手动执行所有操作。

# mvvm - 如何使用 MVVM 获取 WPF DataGrid 的 Visual child？

> ID：15718662
> 
> 赞同：1
> 
> 时间：2013-03-30T12:45:22.707
> 
> 标签：mvvm, wpfdatagrid

具有一个 DataGrid 的视图和具有**以下** 功能的**ViewModel**

```
public  DependencyObject ScrollViewer(DependencyObject targetControl)
    {
        if (targetControl is ScrollViewer)
        {
            return targetControl;
        }

        for (int i = 0; i < VisualTreeHelper.GetChildrenCount(targetControl); i++)
        {
            var child = VisualTreeHelper.GetChild(targetControl, i);
            var result = ScrollViewer(child);
            if (result == null)
            {
                continue;
            }
            else
            {
                return result;
            }
        }
        return null;
    } 
```

现在我想使用上述功能获取网格的滚动查看器。

```
var scrolViewer = ScrollViewer(dataGridID) as ScrollViewer; 
```

如果我将数据网格 ID 作为参数传递。我会得到结果。但这在 MVVM 模式中是不可能的。有没有办法获得可视子数据网格？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:55:26.807

我创建了一个快捷`Attached Property`方式，可以让您坚持使用 MVVM 概念，还可以让您滚动到`DataGrid`. 它可以改进（例如，避免使用两个单独的属性并使用 an`IValueConverter`来决定如何滚动），但这应该会给你一个很好的起点。

首先，我们创建附加属性（一个用于滚动到底部，一个用于顶部）

```
public static class Scroller
{
     //Create the attached property and register it
     public static readonly DependencyProperty ScrollToBottomProperty =
        DependencyProperty.RegisterAttached("ScrollToBottom", typeof(bool), typeof(Scroller), new PropertyMetadata(false, ScrollToBottomPropertyChanged));

     //Create the get and set methods for the property
     public static bool GetScrollToBottom(DependencyObject obj)
     {
         return (bool)obj.GetValue(ScrollToBottomProperty);
     }

     public static void SetScrollToBottom(DependencyObject obj, bool value)
     {
         obj.SetValue(ScrollToBottomProperty, value);
     }

     //Get the control that you've attached this to (DataGrid in this case) and find its ScrollViewer 
     private static void ScrollToBottomPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
     {
         var scrollViewer = GetScrollViewer(d) as ScrollViewer;
         if (scrollViewer != null && (bool)e.NewValue)
         {
            //Use built in ScrollToBottom method to scroll to...well...the bottom :)
             scrollViewer.ScrollToBottom();
         }
     }

     //Same as above but for "ScrollToTop" method
     public static readonly DependencyProperty ScrollToTopProperty =
     DependencyProperty.RegisterAttached("ScrollToTop", typeof(bool), typeof(Scroller), new PropertyMetadata(false, ScrollToTopPropertyChanged));

     public static bool GetScrollToTop(DependencyObject obj)
     {
         return (bool)obj.GetValue(ScrollToTopProperty);
     }

     public static void SetScrollToTop(DependencyObject obj, bool value)
     {
         obj.SetValue(ScrollToTopProperty, value);
     }

     private static void ScrollToTopPropertyChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
     {
         var scrollViewer = GetScrollViewer(d) as ScrollViewer;

         if (scrollViewer != null && (bool)e.NewValue)
         {
             scrollViewer.ScrollToTop();
         }
     }

     //Your ScrollViewerMethod (I renamed it to GetScrollViewer for clarity)
     public static DependencyObject GetScrollViewer(DependencyObject targetControl)
     {
         if (targetControl is ScrollViewer)
         {
             return targetControl;
         }

         for (int i = 0; i < VisualTreeHelper.GetChildrenCount(targetControl); i++)
         {
             var child = VisualTreeHelper.GetChild(targetControl, i);
             var result = GetScrollViewer(child);
             if (result == null)
             {
                 continue;
             }
             else
             {
                 return result;
             }
         }
         return null;
     }
} 
```

在您的 XAML 中，您需要添加相关的命名空间（相应地更改您的命名空间）

```
xmlns:custom="clr-namespace:ScrollExampleMVVM" 
```

然后我们可以将属性附加到我们的`DataGrid`

```
<DataGrid custom:Scroller.ScrollToBottom="{Binding ScrollBottom}" custom:Scroller.ScrollToTop="{Binding ScrollTop}" ...? 
```

在您的 ViewModel 中，您可以拥有公共`ScrollBottom`和`ScrollTop`属性

```
private bool _scrollBottom = false;
public bool ScrollBottom 
{
    get { return _scrollBottom; }
    set
    {
         _scrollBottom = value;                
         NotifyPropertyChanged("ScrollBottom");              
    }
}

private bool _scrollTop = false;
public bool ScrollTop
{
     get { return _scrollTop; }
     set
     {
          _scrollTop = value;
          NotifyPropertyChanged("ScrollTop");
     }
} 
```

最后处理你的按钮（我猜你正在使用`ICommands`）来调用滚动

```
private void ScrollBottomCommand(object param)
{
    //Immediately set back to false so that it can be reused
    ScrollBottom = true;
    ScrollBottom = false;
}

private void ScrollTopCommand(object param)
{
    ScrollTop = true;
    ScrollTop = false;
} 
```

那应该行得通。如前所述，您可能可以对其进行改进以避免重置代码，但希望这可以提供一个想法。

# python - Tkinter 图像未显示或出现错误

> ID：15718663
> 
> 赞同：9
> 
> 时间：2013-03-30T12:45:29.863
> 
> 标签：python, user-interface, tkinter

我尝试了两种不同的方法来尝试在标签中显示图像

```
#This gives " TclError: couldn't recognize data in image file "TestImage.gif" "
imgPath = "TestImage.gif"
photo = PhotoImage(file = imgPath)
label = Label(image = photo)
label.image = photo # keep a reference!
label.grid(row = 3, column = 1, padx = 5, pady = 5) 
```

和

```
#This gives no error but the image doesn't show
imgPath = "TestImage.gif"
photo = PhotoImage(imgPath)
label = Label(image = photo)
label.image = photo # keep a reference!
label.grid(row = 3, column = 1, padx = 5, pady = 5) 
```

该图像与所有代码位于同一文件夹中。关于如何显示图像的任何建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T06:17:32.987

Bryan Oakley 是正确的，就其内容而言，图像不是 jpg，即使您的文件系统认为它是 gif。

最后，我尝试使用您的程序打开 jpg 并得到相同的错误“TclError：无法识别图像文件“hello.jpg”中的数据。

所以你可以这样做：用 mspaint 打开你的图像，然后转到文件 > 另存为，然后从“另存为类型”下拉菜单中选择 GIF。然后代码应该可以工作。这是我使用的：

```
from Tkinter import *

root = Tk()

imgPath = r"hello.gif"
photo = PhotoImage(file = imgPath)
label = Label(image = photo)
label.image = photo # keep a reference!
label.grid(row = 3, column = 1, padx = 5, pady = 5)

root.mainloop() 
```

（顺便说一句，如果我将上面的第 7 行更改为`photo = PhotoImage(imgPath)`和你一样，则不会出现任何图像。所以将其保留为`photo = PhotoImage(file = imgPath)`）

# python - 解酸危险

> ID：15718667
> 
> 赞同：1
> 
> 时间：2013-03-30T12:45:51.520
> 
> 标签：python, pickle

在 python3 pickle 模块的文档中它说：

“pickle 模块并非旨在防止错误或恶意构造的数据。切勿取消从不受信任或未经身份验证的来源接收的数据。”

从不受信任的来源提取数据的风险是什么？对不受信任的数据进行分解本身是否危险？或者使用未腌制的物体只是危险吗？那么解开不受信任的数据然后（在对结果对象做任何事情之前）证明它是否是一个保存对象是否安全？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:53:02.443

解开泡菜相当于执行任意代码。攻击者可以创建一个pickle，它将在unpickling期间执行系统命令。

[这是一篇关于该主题的好博客文章](http://nadiana.com/python-pickle-insecure)的示例：

> 这清楚地表明泡菜是不安全的。许多人认为这是因为它可以加载与您预期不同的类，并且可能会欺骗您运行它们的功能。但实际的安全风险要危险得多。**可以利用 Unpickling 在您的机器上执行任意命令！**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:53:19.857

Pickle recreates objects by looking up callables (commonly classes, but really any callable) and calling them with fixed arguments. This means that unpickling may run *any* callable *anywhere*, with *any* arguments. Even if the relevant module hasn't been imported yet, pickle will gladly import it. It takes only a couple dozen characters to [execute `os.system`](http://nadiana.com/python-pickle-insecure), for example. So you're screwed *before you even get an object back*.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T12:53:07.043

pickle 格式使用成熟的虚拟机。如果输入机器的代码由攻击者控制，它可以做的事情远远超出对象序列化（包括执行任意操作系统命令）。

有关讨论，请参阅[Python Pickle 不安全的原因](http://nadiana.com/python-pickle-insecure)。

# ruby-on-rails - Ruby .split() Regular Expression

> ID：15718668
> 
> 赞同：2
> 
> 时间：2013-03-30T12:45:53.257
> 
> 标签：ruby-on-rails, ruby, regex, string, split

I'm trying to split the string `"[test| blah] [foo |bar][test|abc]"` into the following array:

```
[
    ["test","blah"]
    ["foo","bar"]
    ["test","abc"]
] 
```

But I'm have trouble getting my regular expression right.

* * *

Ruby:

```
@test = '[test| blah] [foo |bar][test|abc]'.split(%r{\s*\]\s*\[\s*})
@test.each_with_index do |test, i|
  @test[i] = test.split(%r{\s*\|\s*})
end 
```

I'm not quite there, this returns:

```
[
    [ "[test" , "blah" ]
    [ "foo" , "bar" ]
    [ "test" , "abc]" ]
] 
```

* * *

What would be the correct regular expression to achieve this? It would be great if I could also account for new lines, say: `"[test| blah] \n [foo |bar]\n[test|abc]"`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-30T12:49:59.997

Better to use `String#scan` for this:

```
> "[test| blah] \n [foo |bar]\n[test|abc]".scan(/\[(.*?)\s*\|\s*(.*?)\]/)
=> [["test", "blah"], ["foo", "bar"], ["test", "abc"]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:54:55.173

Here is another sample:

```
'[test| blah] [foo |bar][test|abc]'.scan(/\w+/).each_slice(2).to_a
#=> [["test", "blah"], ["foo", "bar"], ["test", "abc"]]

"[test| blah] \n [foo |bar]\n[test|abc]".scan(/\w+/).each_slice(2).to_a
#=> [["test", "blah"], ["foo", "bar"], ["test", "abc"]] 
```

# android - Android中的图像导航

> ID：15718669
> 
> 赞同：-3
> 
> 时间：2013-03-30T12:45:53.857
> 
> 标签：android

我只是想将多个图像添加到 android 活动中。而且我将不得不使用下一个和上一个按钮来导航这些图像。只需帮助我编写如何存储多个图像以及如何导航它们的代码？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:35:45.960

最简单的解决方案之一是将可绘制 ID 存储在数组中并在 ImageView 中显示其中一个。看这个。

```
public class MainActivity extends Activity implements View.OnClickListener {

    private static final int PREV_BUTTON_ID = 0;
    private static final int NEXT_BUTTON_ID = 1;

    private ImageView mImage;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        mImage = (ImageView) findViewById(R.id.image);
        mImage.setImageResource(getFirstImageId());

        Button prevButton = (Button) findViewById(R.id.btnPrev);
        prevButton.setId(PREV_BUTTON_ID);
        prevButton.setOnClickListener(this);

        Button nextButton = (Button) findViewById(R.id.btnNext);
        nextButton.setId(NEXT_BUTTON_ID);
        nextButton.setOnClickListener(this);
    }

    @Override
    public void onClick(View view) {
        switch (view.getId()) {
            case PREV_BUTTON_ID:
                mImage.setImageResource(getPrevImageId());
                break;
            case NEXT_BUTTON_ID:
                mImage.setImageResource(getNextImageId());
                break;
            default:
                break;
        }
    }

    private static final int[] sImages = { R.drawable.image1, R.drawable.image2, R.drawable.image3 };

    private int mCurrentImageId;

    private int getFirstImageId() {
        return sImages[mCurrentImageId];
    }

    private int getNextImageId() {
        mCurrentImageId++;

        if (mCurrentImageId > sImages.length - 1) {
            mCurrentImageId = sImages.length - 1;
        }

        return sImages[mCurrentImageId];
    }

    private int getPrevImageId() {
        mCurrentImageId--;

        if (mCurrentImageId < 0) {
            mCurrentImageId = 0;
        }

        return sImages[mCurrentImageId];
    }
} 
```

布局是

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="horizontal"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent">
    <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Prev"
            android:id="@+id/btnPrev"
            android:layout_gravity="center_vertical"/>
    <ImageView
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:id="@+id/image"
            android:layout_gravity="center"
            android:layout_weight="1"
            android:scaleType="center"
            android:focusableInTouchMode="false"/>
    <Button
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Next"
            android:id="@+id/btnNext"
            android:layout_gravity="center"/>
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:58:57.673

要实现图像导航，您可以使用官方的[**Android ViewPager**](http://developer.android.com/reference/android/support/v4/view/ViewPager.html)。

但是，您可能会喜欢 Jake Wharton 提供的更加定制的[**ViewPagerIndicator**](http://viewpagerindicator.com/)。

[另外，您可以从这个现有的StackOverflow 问题](https://stackoverflow.com/questions/13796382/android-viewpager-as-image-slide-gallery)中获得很多帮助。

# linux - Qt如何获取分区ID？

> ID：15718675
> 
> 赞同：0
> 
> 时间：2013-03-30T12:46:36.633
> 
> 标签：linux, windows, qt, disk-partitioning

如何在 Qt 中获取分区 ID？

我正在寻找一种在没有分区名称的情况下保留文件目录的好方法

例如，我想保存我闪存中的文件的目录。在我的计算机中可能是“本地磁盘（F:）”，而在另一台计算机中可能是“本地磁盘（G:)”，如果我使用本地磁盘名称保留文件目录，我就走错了路。

那是因为我正在寻找另一种方式，我想获取分区 ID 并使用分区 ID 保存目录。

任何人都可以帮忙吗？有没有人有更好的主意？:)

我正在尝试在linux和windows中做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T18:40:05.860

每个人都使用过[QFileInfo](http://qt-project.org/doc/qt-4.8/qfileinfo.html)类吗？您可以使用它来获取绝对路径，然后在第一个上剪切生成的字符串`/`，您将只剩下分区。

# sql - Sql Query通过table2的值更新table1

> ID：15718679
> 
> 赞同：0
> 
> 时间：2013-03-30T12:46:59.493
> 
> 标签：sql

我有两个名为 Workers 和 Stats 的表

在 Workers 表中，有一个很大的名字和姓氏列表（愚蠢地）放在一列中，其结构类似于：

```
NameID,   Name
  1,      John
  2,      Smith
  3,      McDonald
  4,      Harry 
```

在 Stats 表中是工人的所有统计信息，如下所示：

```
id, firstnameid, secondnameid,  wage,    sold
 1,    4,           3,          1000,    10
 2,    1,           2,          2000,    20 
```

因为这太不方便了，所以我正在尝试编写一个查询或将 Stats 表 nameids 更改为实际名称的东西，例如：

```
UPDATE `Stats` SET `Stats.firstnameid` =  `Workers.Names` 
WHERE `Stats.firstnameid` = `Workers.NameID` 
```

然后对 secondnameid 执行相同的操作

因此，如果这可行，结果将是 Stats 表将更改为如下所示（使用我上面显示的示例表）：

```
 id,  firstnameid, secondnameid,       wage,    sold
 1,    Harry,      McDonald,          1000,     10
 2,    John,       Smith,             2000,    20 
```

有谁可以帮我离开这里吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:50:15.520

不要这样做！

而是创建一个视图：

```
create view v_stats as
    select s.id, fname.name as firstname, lname.name as lastname, s.wage, s.sold
    from stats s left outer join
         workers fname
         on s.firstnameid = fname.nameid left outer join
         workers lname
         on s.lastnameid = lname.nameid; 
```

I have no idea why someone would design a database, splitting up the names like that. Ok, that seems like bad database design or whatever. You don't make it any better by compounding the problem by copying the names over. Presumably, that table is maintained somehow.

If two employees have the same first name, do they have one row or two in the workers table?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:56:22.143

First, you will need to change your table structure. As for as moving the data, something like the below.

```
UPDATE
    Stats
SET
    s.firstName = w1.name,
    s.secondName= w2.name
FROM Stats AS s
INNER JOIN Workers AS w1 ON s.firstnameid = w1.NameID
INNER JOIN Workers AS w2 ON s.secondnameid= w2.NameID 
```

I do like the idea of a workers table, but your workers table is really a name table which is very strange. I would want a workers table which had columns firstname, lastname, address, etc.

# ruby-on-rails - Rails creating wrong table name for model

> ID：15718681
> 
> 赞同：2
> 
> 时间：2013-03-30T12:47:23.170
> 
> 标签：ruby-on-rails, naming-conventions

I'm creating a model named `Stadium` with `rails g model Stadium` but rails is converting table name to `stadia`.

I've manually changed table name to `stadium` in the migration, and added `set_table_name "stadium"` in my model class. But all my routes are looking for `stadia_path`.

I've tried `rails g model Stadium --force-plural` with no success.

I think I should use an inflection for this, but I don't know how to create this inflection. Stadium is singular, I still need the plural stadiums for this model.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-30T13:04:08.513

The dictionary says that both "stadiums" and "stadia" are correct (given that the word is Latin, "stadia" as plural for neuter words ending in -um seems legitimate).

Just add this to config/initializers/inflections.rb:

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.irregular 'stadium', 'stadiums'
end 
```

You can set up all kinds of irregular plurals here.

Destroy your old generation by doing

```
rails d model Stadium 
```

and generate it again doing

```
rails g model Stadium 
```

You will see how it magically creates files like this:

```
db/migrate/20130330130335_create_stadiums.rb 
```

Then run the migration and you're set!

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T12:59:24.137

For inflections you have to something like this in the `config/initializers/inflections.rb`:

```
ActiveSupport::Inflector.inflections do |inflect|
  inflect.irregular 'stadium', 'stadiums'
end 
```

hope it helps!

# c++ - c++ - 在哪里定义嵌套类的函数？

> ID：15718682
> 
> 赞同：1
> 
> 时间：2013-03-30T12:47:27.470
> 
> 标签：c++, scope, nested

我无法理解在 C++ 中使用嵌套类的概念。

我正在尝试为我的链表创建一个迭代器。我已将其声明为 LinkedList.h 私有范围内的嵌套类

但是我在哪里定义迭代器类的函数呢？现在，我正试图在文件的底部以及 LinkedList 的所有函数中这样做。但是无论我如何尝试扭曲和旋转范围定义，我都无法让它工作。我应该以不同的方式做这件事吗？

迭代器类

```
class Iterator {

    private:

        LinkedList<T>* l;
        Node<T>* node;

    public:

        Iterator(LinkedList<T> *ll, Node<T> *n);        
        T get();
        int hasNext();
        void moveNext();

    }; 
```

四个函数定义

```
template <typename T>
typename LinkedList<T>::Iterator<T>::Iterator(LinkedList<T> *ll, Node<T> *n) {
    l = ll;
    node = n;
}

template <typename T>
T LinkedList<T>::Iterator<T>::get() {
    return node->getData();
}

template <typename T>
int LinkedList<T>::Iterator<T>::hasNext() {
    return node->getNext();
}

template <typename T>
void LinkedList<T>::Iterator<T>::moveNext() {
    node = node->getNext();
} 
```

我得到的错误是：

“使用未定义类型：LinkedList::Iterator”

“语法错误：意外类型 LinkedList”

“语法错误：缺少';' 前 '{'”

还有很多。

我非常非常失落。

编辑：

完整的 LinkedList.h 文件：

```
#ifndef LINKEDLIST_H
#define LINKEDLIST_H
#include "Node.h"
#include "List.h"
#include <iostream>

template <typename T>
class LinkedList : public List {

private:

    int n;
    Node<T> *first;
    Node<T> *last;

    template <typename T>
    class Iterator {

    private:

        LinkedList<T>* l;
        Node<T>* node;

    public:

        Iterator(LinkedList<T> *ll, Node<T> *n);        
        T get();
        int hasNext();
        void moveNext();

    };

public:

    LinkedList();
    LinkedList(const LinkedList & ll);
    ~LinkedList();
    int size();
    void clear();
    void addFirst(T data);
    void addLast(T data);
    T removeFirst();
    T removeLast(); 
    T getFirst();
    T getLast();
    Node<T>* getFirstNode() const;
    void addAt(int pos, T data);
    T removeAt(int pos);
    T getAt(int pos);   
    LinkedList& operator=(const LinkedList<T> &right);
    T operator[](int i);
    LinkedList& operator+(const LinkedList<T> &right);
    LinkedList& operator+=(const LinkedList<T> &right);
    friend std::ostream& operator<<(std::ostream &os, const LinkedList<T> & ll);
    typename LinkedList<T>::Iterator<T> getIterator();
    void mergeSort();   
};

template <typename T>
LinkedList<T>::LinkedList() {
        this->n = 0;
        this->first = 0;
        this->last = 0;
    }

template <typename T>
LinkedList<T>::LinkedList(const LinkedList & ll) {
    this-> n = 0;
    this-> first = 0;
    this-> last = 0;

    Node *temp = ll.first;

    while(temp) {
        addLast(temp->getData());
        temp = temp->getNext();
    }

}

template <typename T>
void LinkedList<T>::addFirst(T data) {
    Node<T> *p = new Node<T>(data, first);
    first = p;
    if(!n)
        last = p;
    n++;
}

template <typename T>
void LinkedList<T>::addLast(T data) {
    Node<T> *p = new Node<T>(data, 0);
    if(!n)
        first = last = p;
    else {
        last->next = p;
        last = p;
    }
    n++;
}

template <typename T>
T LinkedList<T>::removeFirst() {
    T a = 0;
    if(!n)
        throw "Can't retrieve element from empty list!";
    a = first->getData();
    Node<T> *p = first->next;
    delete first;
    first = p;
    n--;
    return a;
}

template <typename T>
T LinkedList<T>::removeLast() {
    T a = 0;
    if(!n)
        throw "Can't retrieve element from empty list!";
    if(n == 1) {
        a = last->getData();
        delete first;
        first = last = 0;
    }
    else {
        a = last->getData();
        Node<T> *p = first;
        while(p->next->next != 0)
            p = p->next;
        delete p->next;
        p->next = 0;
        last = p;
    }
    n--;
    return a;
}

template <typename T>
T LinkedList<T>::getFirst() {
    if(n < 1)
        throw "Can't retrieve element from empty list!";
    return first->getData();
}

template <typename T>
T LinkedList<T>::getLast() {
    if(n < 1)
        throw "Can't retrieve element from empty list!";
    return last->getData();
}

template <typename T>
Node<T>* LinkedList<T>::getFirstNode() const {
    return first;
}

template <typename T>
int LinkedList<T>::size() {
    return n;
}

template <typename T>
T LinkedList<T>::getAt(int pos) {
    if(pos >= n)
        throw "Element index out of bounds!";       
    Node<T> *temp = first;
    while(pos > 0) {
        temp = temp->next;
        pos--;
    }
    return temp->getData();     
}

template <typename T>
void LinkedList<T>::clear() {
    Node<T> *current = first;
    while(current) {
        Node<T> *next = current->next;
        delete current;
        if(next)
            current = next;
        else
            current = 0;
    }
}

template <typename T>
void LinkedList<T>::addAt(int pos, T data) {
    if(pos >= n)
        throw "Element index out of bounds!";       
    if(pos == 0)
        addFirst(data);
    else {
        Node<T> *temp = first;
        while(pos > 1) {
            temp = temp->next;
            pos--;
        }
        Node<T> *p = new Node<T>(data, temp->next);
        temp-> next = p;
        n++;
    }
}

template <typename T>
T LinkedList<T>::removeAt(int pos) {
    if(pos >= n)
        throw "Element index out of bounds!";       
    if(pos == 0)
        return removeFirst();
    if(pos == n - 1)
        return removeLast();
    else {
        Node<T> *p = first;
        while(pos > 1) {
            p = p->next;
            pos--;
        }
        T a = p->next->getData();
        Node<T> *temp = p->next;
        p->next = p->next->next;
        delete temp;
        n--;
        return a;
    }       
}

template <typename T>
LinkedList<T>::~LinkedList() {
    clear();
}

template <typename T>
LinkedList<T>& LinkedList<T>::operator=(const LinkedList<T> &right) {
    if(this != &right) {

        n = 0;
        first = 0;
        last = 0;

        Node<T> *temp = right.first;
        while(temp) {
            addLast(temp->getData());
            temp = temp->getNext();
        }           
    }
    return *this;
}

template <typename T>
T LinkedList<T>::operator[](int i) {
    return getAt(i);
}

template <typename T>
LinkedList<T>& LinkedList<T>::operator+(const LinkedList<T> &right) {
    Node<T> *temp = right.first;
    while(temp) {
        addLast(temp->getData());
        temp = temp->getNext();
    }
    return *this;
}

template <typename T>
LinkedList<T>& LinkedList<T>::operator+=(const LinkedList<T> &right) {
    Node<T> *temp = right.first;
    while(temp) {
        addLast(temp->getData());
        temp = temp->getNext();
    }
    return *this;
}

template <typename T>
std::ostream& operator<<(std::ostream &os, const LinkedList<T> &ll) {
    Node<T> *temp = ll.getFirstNode();
    while(temp) {
        os<<temp->getData()<<std::endl;
        temp = temp->getNext();
    }
    return os;
}

template <typename T>
typename LinkedList<T>::Iterator<T>::Iterator(LinkedList<T> *ll, Node<T> *n) {
    l = ll;
    node = n;
}

template <typename T>
T LinkedList<T>::Iterator<T>::get() {
    return node->getData();
}

template <typename T>
int LinkedList<T>::Iterator<T>::hasNext() {
    return node->getNext();
}

template <typename T>
void LinkedList<T>::Iterator<T>::moveNext() {
    node = node->getNext();
}

template <typename T>
typename LinkedList<T>::Iterator<T> LinkedList<T>::getIterator() {
    return new Iterator<T>(*this, *first);
}

#endif 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:24:21.003

您要么需要使用 LinkedList 类的模板类型名（这是有道理的）。这意味着 Iterator 类不需要单独的模板类型名。

```
template <typename T>
class Iterator { 
```

应该只是

```
class Iterator { 
```

然后成员将被定义为

```
template <typename T>
T LinkedList<T>::Iterator::get() { 
```

* * *

**或者**如果你真的需要一个不同的迭代器类型名。然后至少你必须更改名称，`T`因为它会影响`LinkedList`. 就像是

```
template <typename V>
class Iterator {
    ...
    V get();
    ... 
```

成员声明将采用以下形式

```
template <typename T>
template <typename V>
V LinkedList<T>::Iterator<V>::get() { 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:06:19.307

我认为这会做到：

```
template <typename T>
LinkedList<T>::Iterator::Iterator(LinkedList<T> *ll, Node<T> *n) {
  l = ll;
  node = n;
}

template <typename T>
T LinkedList<T>::Iterator::get() {
  return node->getData();
}

template <typename T>
int LinkedList<T>::Iterator::hasNext() {
  return node->getNext();
}

template <typename T>
void LinkedList<T>::Iterator::moveNext()
{
  node = node->getNext();
} 
```

# java - Mysql 5.5 - Prepared Statement 实例数失控（百万）

> ID：15718683
> 
> 赞同：0
> 
> 时间：2013-03-30T12:47:29.263
> 
> 标签：java, ibatis, mysql-5.5

如果有人经历过这种情况或有任何想法，将不胜感激......

我直奔主题：有问题的系统使用 java6、tomcat6 和 ibatis

自从将数据库从Mysql5.1升级到Mysql5.5后，系统变得不稳定。查看 jmap histo 并使用 jhat 分析内存转储后，很明显问题与应用程序的 JDBC 端有关。

系统平均每秒执行 3,000 次选择/插入/更新，并且它一天中最繁忙的时间是 Prepared Statement 实例计数在 10 到 30 之间。我们在正常操作期间看到的最高计数刚刚超过 50。

奇怪的是，崩溃没有规律可循，系统在一小时内多次崩溃，而其他时候崩溃之间可能会经过几天。

崩溃期间观察到的最高实例数超过 500 万。

* * *

这是来自其中一个内存转储的 JDBC4PreparedStatement 的一些 jhat 数据 此转储是在我们开始崩溃时进行的（此时只有 200k 实例） ![在此处输入图像描述](../Images/f6d8203e064f5f60f5f17c78dba26653.png)

# r - 当数据不包含必要值时如何忽略代码？

> ID：15718684
> 
> 赞同：3
> 
> 时间：2013-03-30T12:47:33.700
> 
> 标签：r, na

我对 R 和这里也很陌生，需要一些帮助来修复我的代码，因为有时我的数据会变得很奇怪

所以我有类似的数据

```
Random  Price
11.23   0.68
66.77   0.51
68  0.46
78  0.51
88  0.32
89  0.51
90  0.27
91  0.65 
```

到目前为止，这是我的代码：

```
newdata <- data[ which(data$Random>=30
& data$Random < 50), ]
Pvalue<- lapply(1:length(dat), function(i){
if(length(dat[[i]][[4]])>1){
t.test(newdata$Price,dat[[i]][[4]])$p.value 
}else 'not enough observation'
}) 
```

`'newdata'`我的代码基本上在数据和另一组数据之间进行了 t.test，`'dat'` 但有时我没有`data`与上面的示例数据类似的 30 到 50。因此，我的代码不是返回错误，而是如何更改它以使其仅返回`NA`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T13:00:14.780

您已经知道如何使用该`if/else`构造。您所要做的就是添加一项测试`nrow(newdata)`，或者将两者结合起来，如下所示：

```
newdata <- subset(data, Random >= 30 &
                        Random < 50)
Pvalue <- lapply(dat, function(x){
  if (length(x[[4]]) > 1 & nrow(newdata) > 1) {
    t.test(newdata$Price, x[[4]])$p.value 
  } else NA
}) 
```

You could also replace `lapply(...)` with `sapply(...)` or `vapply(..., numeric(1))` to get a numeric vector instead of a list. For that, it is recommended to replace `'not enough observation'` with `NA` like I did, or you could end up with a character vector.

# dom - Google Chrome 扩展程序：获取页面中的所有链接

> ID：15718686
> 
> 赞同：0
> 
> 时间：2013-03-30T12:48:00.503
> 
> 标签：dom, google-chrome-extension

我正在尝试制作 chrome 扩展，它可以递归地浏览网站并搜索常见的错误消息字符串（如“错误 500”等），用于 Web 开发人员测试。

第一步是从活动选项卡中获取所有链接。所以，在我的扩展程序的后台脚本中，我有这个代码片段：

```
var $html = jQuery(html);

var links = [];
$html.find('a').each(function(){
    console.log(this);      
    console.log(this.href);
    //links.push(this.href); 
}); 
```

但是这个脚本的输出对于相对链接来说很奇怪：

```
<a href=​"/​" id=​"logo">​&lt;/a>​
chrome-extension://kmldadmcjflefibfflbkpmgjdpklghfa/ 

<a href=​"#top">About</a>​
chrome-extension://kmldadmcjflefibfflbkpmgjdpklghfa/background.html#top 

<a href=​"/articles/applications/​1">​Web applications</a>​
chrome-extension://kmldadmcjflefibfflbkpmgjdpklghfa/articles/applications/1 
```

尽管元素的`href`属性值为“/”，但转储`this.href`的输出为“chrome-extension://kmldadmcjflefibfflbkpmgjdpklghfa/”。

如何在没有 'chrome-extension://blahblahblah/' 的情况下获取链接的 href 值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:58:51.147

您正在解析自己的扩展背景页面。这真的是你想做的吗？

如果您打算解析另一个页面，请使用“内容脚本”。它在这里被广泛记录：

[http://developer.chrome.com/extensions/content_scripts.html](http://developer.chrome.com/extensions/content_scripts.html)

发表评论后编辑：

所以你只想摆脱“chrome-extension://...”？

```
var str = 'chrome-extension://kmldadmcjflefibfflbkpmgjdpklghfa/background.html#top';
var out = str.replace('chrome-extension://kmldadmcjflefibfflbkpmgjdpklghfa', ''); 
```

或者更好的是，只需从“this”中获取名称和 URL。

# javascript - res.render、res.write 和 Jade

> ID：15718687
> 
> 赞同：2
> 
> 时间：2013-03-30T12:48:05.380
> 
> 标签：javascript, node.js, express, pug

我正在尝试在 Node.js 中制作简单的 ftp 客户端。一切正常，但我不知道如何在我的 Jade 模板中编写“singleFile.name”。

```
app.post('/ftp/login', function(req, res){
  ftp.ls("/directory", function(err, files){
      if (err) return console.error(err);

      files.forEach(function(singleFile) {
        if (singleFile != null){
        console.log(singleFile.name + "<br>");
        }
      });
  });

 res.render('ftpLogin', { host: fHost, username: fUsername, port: fPort});
}); 
```

没有“res.render”没有问题，但我想将它添加到我的模板中。

```
res.writeHead(200, {"Content-type" : "text/html; charset=utf-8"});
[...]
res.write(singleFile.name + "<br>");
[...]
res.end(); 
```

我是新手（3 天节点学习），所以我会很高兴看到你对错误的所有回应。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:07:21.473

最好将文件数组发送到 Jade 模板。

```
res.render('ftpLogin', { host: fHost, ..., files: files }); 
```

然后在模板中写一个循环。例如：

```
each file in files
    | #{file.name}
    br 
```

请参阅 Jade 循环文档：[https ://github.com/visionmedia/jade#a9](https://github.com/visionmedia/jade#a9)

尝试用类似的东西“预先格式化”你的代码并不是一个很好的做法，`+ "<br>"`因为这本身就是模板引擎的重点。

# c++ - 如何在没有 sprintf() 的情况下将 long 转换为字符串？

> ID：15718689
> 
> 赞同：0
> 
> 时间：2013-03-30T12:48:13.497
> 
> 标签：c++, linux, compilation, printf

我需要将 long 转换为字符串，但我不能使用`sprintf()`.

这是我的代码

```
char *ultostr(unsigned long value, char *ptr, int base)
{
    unsigned long t = 0; 
    unsigned long res = 0;
    unsigned long tmp;
    int count = 0;

    tmp = value;

    if (ptr == NULL)
    {
        return NULL;
    }

    if (tmp == 0)
    {
        count++;
    }

    while(tmp > 0)
    {
        tmp = tmp/base;
        count++;
    }

    ptr += count;
    *ptr = '\0';

    do
    {
        t = value / base;
        res = value - (base*t);

        if (res < 10)
        {
            * -- ptr = '0' + res;
        }
        else if ((res >= 10) && (res < 16))
        {
            * --ptr = 'A' - 10 + res;
        }

        value = t;
    } while (value != 0);

   return(ptr);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T12:55:27.793

You could use stringstream I think.

```
#include <sstream>
...
std::stringstream x;
x << 1123;
cout << x.str().c_str(); 
```

(x.str().c_str() makes it char*) it worked for me.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T12:52:41.440

You can use `stringstream`.

Example:

```
#include <iostream>
#include <sstream>
#include <string>

using namespace std;

int main()
{
    ostringstream ss;
    long i = 10;
    ss << i;
    string str = ss.str();
    cout << str << endl;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T11:59:16.973

```
 #include<iostream>
 #include<string>
 #include<sstream>

 int main(int argc, char *argv[])
  {
    unsigned long d = 1234567;
    std::stringstream m_ss;
    m_ss << d;
    std::string my_str;
    m_ss >> my_str;
    std::cout<<my_str<<std::endl;

    return 0;
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T12:52:21.207

You should take advantage of stream objects like [`std::stringstream`](http://en.cppreference.com/w/cpp/io/basic_stringstream):

```
#include <string>
#include <sstream>

int main()
{
    long int i = 10000;

    std::stringstream ss;
    std::string str;

    ss << i;

    str = ss.str();

    std::cout << str; // 10000
} 
```

[***Live Demo***](http://liveworkspace.org/code/4yc7Hy%243141)

# tsql - cast varchar to float to bigint

> ID：15718694
> 
> 赞同：2
> 
> 时间：2013-03-30T12:48:47.273
> 
> 标签：tsql, casting, varchar, bigint

I am trying to cast varchar to bigint. Then inserting it into an int column. I found that I am not getting expected value. Then I tried the following statements:

```
DECLARE @varData VARCHAR(50)

SET @varData  = '0000019.33'

select cast(@varData *cast(100 as float) as bigint)

select cast(@varData *cast(100 as float) as varchar)

select cast(cast(@varData *cast(100 as float) as varchar) as float) 
```

Results:

```
1932

1933

1933 
```

I am not able to understand why this difference is coming. But when I change the value to `0000029.33` then there is no difference in results.

I am stuck and do not have any idea why it's so happening. Help needed..!!!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T15:48:29.397

please see this [Difference between numeric,float and decimal in sql server](https://stackoverflow.com/questions/1056323/difference-between-numeric-float-and-decimal-in-sql-server)

For you question, you should try CAST @vardata as numeric, like this

```
SELECT CAST(CAST(@varData AS numeric(27,9)) * 100  AS bigint) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T14:51:49.790

it happens because sql round the data, so lets say if u pick the wrong integer instead of 2.97 u will get 3. now try to imagine how much data will be lost if u want to convert just 0.000002 :) hope u understand better now

```
DECLARE @varData VARCHAR(50),
        @float float,
        @bigint bigint

SET @varData  = '0000019.33'    
set @bigint = convert ( bigint, (convert ( float, @vardata )) )
print @bigint
--or
set @float= convert ( float, @vardata )
set @bigint=convert ( bigint, @float)
print @bigint 
```

# android - 替换数据库文件时从不调用 SQLiteOpenHelper 的 onUpgrade 方法

> ID：15718699
> 
> 赞同：2
> 
> 时间：2013-03-30T12:49:35.863
> 
> 标签：android, sqlite

我知道有很多类似的问题，我希望不要重复，但我尝试了不同的方法，但我仍然无法解决问题。我正在开发一个使用 SQLite 在内部存储一些数据的 Android 应用程序。我已经在自己的手机中使用这个应用程序一个月了，我添加了很多我不想丢失的数据，但同时我一直在改进我电脑中的应用程序，但是改进让我更改了一些列名，添加一些列和表。所以，现在我想更新我手机中的应用程序。

以前的版本将数据库设置为 2，新的设置为 3。此外，我的应用程序能够创建数据库的备份，只需将文件复制到 SD 卡，并能够通过替换内部数据库文件来恢复它对于用户从 sd 卡中选择的一个。现在的问题是，我从手机备份了数据库，然后将其移动到我的计算机上，以将其导入在模拟器中运行的新版本应用程序中，以确保应用程序可以在我安装之前按预期升级数据库我手机上的新版本。问题是 SQLiteOpenHelper 的 onUpgrade 永远不会被调用。我做了不同的试验，但没有任何效果。我可以确保手机中的数据库具有版本 2（我使用 sqliteadmin "PRAGMA user_version;" SQL 查询和答案 2）并且我的应用程序会查找版本 3。

这里有导入备份时执行的代码：

```
private boolean importDatabase(String path) {  
    String dbPath = mDbHelper.getDbPath();  
    mDbHelper.close();  

    boolean result = copyFile(path, dbPath);  

    if (result) {  
        mDbHelper = new DbHelper(this);  
        mDbHelper.getWritableDatabase().close();  
    }  
    return result;  
} 
```

我还必须提到，当用户到达在新版本中导入/导出数据库的位置时，已创建一个版本 3 的新空数据库，因为应用程序需要来自声明活动的活动数据库。然后，在导入时，这个空的数据库文件被导入的文件替换。我想知道是否有任何我想清理的缓存数据。

你能给我一些线索来理解为什么在这种情况下永远不会调用 onUpgrade 吗？

# android - 运行应用程序的困难

> ID：15718706
> 
> 赞同：-1
> 
> 时间：2013-03-30T12:50:16.140
> 
> 标签：android, eclipse

我正在制作一个带有按钮和 EditText 的简单 android 应用程序。

在 Eclipse 中，我编写了这个 activity_main.xml 文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"

    android:orientation="horizontal"
    >

    <EditText android:id="@+id/edit_message"
              android:layout_width="wrap_content"
              android:layout_height="wrap_content"
              android:hint="@string/edit_message" />

    <Button android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/button_send" />

</LinearLayout> 
```

在 string.xml 文件中，我编写了以下内容

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <string name="app_name">v1</string>
    <string name="edit_message">Enter a Message</string>
    <string name="button_send">Send</string>
    <string name="menu_settings">Settings</string>
    <string name="title_activity_main">MainActivity</string>

</resources> 
```

这样的代码没有显示任何错误，但是当我尝试运行代码时，它会抛出错误。

我应该怎么办 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T12:56:50.803

What kind of error is thrown? I´m not sure, but here

```
<Button android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="@string/button_send" /> 
```

you dont use `android:id` . If you dont have `id` for button, you can´t use it in java code.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:34:32.610

您需要为将在 java 代码中使用的按钮指定 id。

```
<Button 
    android:id="@id/button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/button_send" /> 
```

# java - SetcontentView 错误 InflateException

> ID：15718708
> 
> 赞同：1
> 
> 时间：2013-03-30T12:50:25.753
> 
> 标签：java, android

我写了一个 xml 文件，每次我写：

```
 setContentView(R.layout.all_items); 
```

它向我显示一个错误并退出我的应用程序（InflateException），

我没有发现我的 xml 文件有任何问题

这是 xml 文件（all_items）：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
     >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:orientation="horizontal"
        android:gravity="center" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <Button
                android:id="@+id/itemsAllItemsBtn"
                android:layout_width="158dp"
                android:layout_height="122dp"
                android:background="@drawable/allthings" />

            <TextView
                android:id="@+id/itemsAllItemsText"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center"
                android:text="All items" >

                <requestFocus />
            </TextView>

        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <Button
                android:id="@+id/items1Btn"
                android:layout_width="wrap_content"
                android:layout_height="122dp"
                android:layout_weight="4"
                android:background="@drawable/1_image_item" />

            <TextView
                android:id="@+id/items1Text"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center"
                android:text="1" />
        </LinearLayout>

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="center"
        android:orientation="horizontal" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <Button
                android:id="@+id/items2Btn"
                android:layout_width="158dp"
                android:layout_height="131dp"
                android:layout_marginTop="20dp"
                android:background="@drawable/2" />

            <TextView
                android:id="@+id/items2Text"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center"
                android:text="2" >

                <requestFocus />
            </TextView>

        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="182dp"
            android:orientation="vertical" >

            <Button
                android:id="@+id/items3Btn"
                android:layout_width="wrap_content"
                android:layout_height="131dp"
                android:layout_marginTop="20dp"
                android:background="@drawable/3" />

            <TextView
                android:id="@+id/items3Text"
                android:gravity="center"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" 
                android:text="3"/>

        </LinearLayout>

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:orientation="horizontal"
        android:gravity="center" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <Button
                android:id="@+id/items4Btn"
                android:layout_width="158dp"
                android:layout_height="130dp"
                android:background="@drawable/4" />

            <TextView
                android:id="@+id/items4Text"
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:gravity="center"
                android:text="4" >

                <requestFocus />
            </TextView>

        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <Button
                android:id="@+id/itemsAuctionBtn"
                android:layout_width="wrap_content"
                android:layout_height="131dp"
                android:background="@drawable/auction_reduced"
                 />

            <TextView
                android:id="@+id/itemsAuctionText"
                android:gravity="center"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" 
                android:text="Auction"/>

        </LinearLayout>

    </LinearLayout>

</LinearLayout> 
```

其中第 128 行是：

```
 <Button
            android:id="@+id/itemsAuctionBtn"
            android:layout_width="wrap_content"
            android:layout_height="131dp"
            android:background="@drawable/auction_reduced"
             /> 
```

这是logcat：

```
03-30 12:43:28.550: E/AndroidRuntime(1319): FATAL EXCEPTION: main
03-30 12:43:28.550: E/AndroidRuntime(1319): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.sal/com.example.sal.AllItemsActivity}: android.view.InflateException: Binary XML file line #128: Error inflating class <unknown>
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.os.Looper.loop(Looper.java:137)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.ActivityThread.main(ActivityThread.java:5041)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at java.lang.reflect.Method.invokeNative(Native Method)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at java.lang.reflect.Method.invoke(Method.java:511)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at dalvik.system.NativeStart.main(Native Method)
03-30 12:43:28.550: E/AndroidRuntime(1319): Caused by: android.view.InflateException: Binary XML file line #128: Error inflating class <unknown>
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.createView(LayoutInflater.java:613)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at com.android.internal.policy.impl.PhoneLayoutInflater.onCreateView(PhoneLayoutInflater.java:56)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.onCreateView(LayoutInflater.java:660)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.createViewFromTag(LayoutInflater.java:685)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:746)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:749)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.rInflate(LayoutInflater.java:749)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.inflate(LayoutInflater.java:396)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.inflate(LayoutInflater.java:352)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:270)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.Activity.setContentView(Activity.java:1881)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at com.example.sal.AllItemsActivity.onCreate(AllItemsActivity.java:23)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.Activity.performCreate(Activity.java:5104)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
03-30 12:43:28.550: E/AndroidRuntime(1319):     ... 11 more
03-30 12:43:28.550: E/AndroidRuntime(1319): Caused by: java.lang.reflect.InvocationTargetException
03-30 12:43:28.550: E/AndroidRuntime(1319):     at java.lang.reflect.Constructor.constructNative(Native Method)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at java.lang.reflect.Constructor.newInstance(Constructor.java:417)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.LayoutInflater.createView(LayoutInflater.java:587)
03-30 12:43:28.550: E/AndroidRuntime(1319):     ... 26 more
03-30 12:43:28.550: E/AndroidRuntime(1319): Caused by: java.lang.OutOfMemoryError
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:502)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:355)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:785)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.content.res.Resources.loadDrawable(Resources.java:1965)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.content.res.TypedArray.getDrawable(TypedArray.java:601)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.view.View.<init>(View.java:3330)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.widget.TextView.<init>(TextView.java:583)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.widget.Button.<init>(Button.java:107)
03-30 12:43:28.550: E/AndroidRuntime(1319):     at android.widget.Button.<init>(Button.java:103)
03-30 12:43:28.550: E/AndroidRuntime(1319):     ... 29 more
03-30 12:43:33.146: I/Process(1319): Sending signal. PID: 1319 SIG: 9
03-30 12:43:34.251: E/Trace(1405): error opening trace file: No such file or directory (2) 
```

这是我的代码：

```
public class AllItemsActivity extends Activity {

    private Button allItemsButton;
    private Button 1Btn,2Btn,auctionBtn,3Btn,4Btn;

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.all_items);

        allItemsButton =(Button) findViewById(R.id.itemsAllItemsBtn);
        saleBtn =(Button) findViewById(R.id.items1Btn);
        2Btn =(Button) findViewById(R.id.items2Btn);
        3Btn =(Button) findViewById(R.id.items3Btn);
        4Btn =(Button) findViewById(R.id.items4Btn);
        auctionBtn =(Button) findViewById(R.id.itemsAuctionBtn);
        }
} 
```

其中第 23 行是：

```
 setContentView(R.layout.all_items); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:58:57.470

我认为你的问题是这样的：

```
Caused by: java.lang.OutOfMemoryError 
```

可能您存储在可绘制对象中的图像尺寸很大，无法正确充气。尝试删除可绘制对象并开始观察会发生什么。

# php - 如何在有或没有 PEAR 的 symfony 1.4 中安装插件？

> ID：15718714
> 
> 赞同：4
> 
> 时间：2013-03-30T12:50:58.020
> 
> 标签：php, symfony1, symfony-1.4, pear

我知道问这个问题不是个好问题，但我没有从 Google 那里找到任何令人满意的答案，即我们能够在 symfony 1.4 中安装插件，无论是否有 PEAR。

如果是，那为什么？如果没有，那么我们如何手动安装它。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-31T06:10:30.760

在 Google 上快速搜索后，[一个结果](http://pramodsivadas.co.in/2011/11/symfony-install-plugin-manually/)显示如何手动安装插件，无需 PEAR（我推荐）：

1.  从 symfony 站点下载插件。
2.  解压缩文件，如果文件夹有版本号，请将其删除。
3.  将插件复制到`projectpath/plugins`
4.  编辑`config/ProjectConfiguration.class.php`以添加

    ```
    $this->enablePlugins('pluginName'); 
    ```

5.  `symfony plugin:publish-assets`在命令行中运行。

# php - 连接被重置但在 PHP 中仍在后台执行？

> ID：15718716
> 
> 赞同：0
> 
> 时间：2013-03-30T12:51:04.327
> 
> 标签：php, hosting, web-hosting

我刚刚更换了主机，现在一切运行顺利，只有一个故障。

我有一个页面（precisely.me/fpl/epl），它为用户提供了刷新分数的选项。这基本上是指向exactly.me/fpl/eplrefresh 的链接，它从另一个站点获取数据，更新表，然后将其重定向回exactly.me/fpl/epl。

问题是我在 Chrome 上收到此错误 - [http://precisely.me/fpl/eplrefresh](http://precisely.me/fpl/eplrefresh)上的网页可能暂时关闭，或者它可能已永久移动到新网址
和 Firefox 上的类似地址 - 连接到服务器在页面加载时被重置。

我试图在 php.ini 中设置 max_execution_time = 300 但这没有用。请注意，尽管出现此错误，但脚本在后台成功运行，并且分数确实会更新。但在它可以重定向用户之前，我得到了错误。

我应该在 php.ini 中进行哪些更改才能使其正常工作？

这真的不需要，因为它适用于 localhost 和我以前的服务器。但无论如何，eplrefresh.php 的片段

```
<?php   
$dbc=mysqli_connect('localhost','root','','fplscore') or die("can't connect");
$team_epl=array("Arsenal","Aston Villa", "Chelsea","Everton"); //Trimmed for now

$teamid_epl=array("24854","17","109276","57");

$playernames_epl=array("Jackoff", "Epic Fail", "ENR", "Beric");

set_time_limit(500); //Minimum time for page to expire
$i=0;
foreach ($teamid_epl as $x)
{$team_name=$team_epl[$i];  

$thisgw = mysqli_fetch_array(mysqli_query($dbc,"select gwno from gameweek"));
$gw=$thisgw['gwno'];
$str2="http://fantasy.premierleague.com/entry/".$x."/event-history/".$gw; 
    $file=fopen($str2,"r") or die("Heavy load on FPL. Please try later");
    while(!feof($file))
            {$str=fgets($file);

            if(preg_match('/(<div class="ismSBValue ismSBPrimary">(.*))/', $str,$ar)) 
                {   $str2=fgets($file);
                    $str2=fgets($file); 
                    $str2 = strip_tags($str2);
                    $str2=str_replace("pts","",$str2);
                    $temp1=(int)$str2;

                }

            if(preg_match('/(<dl class="ismDefList ismSBDefList">(.*))/', $str,$ar)) 
                    {           .....
                                                    $str2=fgets($file);
                            $str2 = strip_tags($str2);
                            $str2=str_replace("pts","",$str2);
                            $str2=str_replace("(-","",$str2);
                            $str2=str_replace(")","",$str2);
                            $temp2=(int)$str2;  
                            $z=$temp1-$temp2;
$gw=$gw-19;         
                            $gw="gw".$gw;
                            $q="update epl_score set ".$gw."=$z  where team='$team_name'" ;
                            $result=mysqli_query($dbc,$q) or die("unable to execute query");

                    }

            }
$i++;
}   
header("Location: epl");        
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:16:34.980

构造单击-> 从远程服务器更新-> 重定向不是一个很好的方法。如果用户数量超过几个，您将遇到严重的问题，因为您将耗尽工作人员。

为什么不设置一个 cronjob 来获取最新分数，将它们保存在某个地方并使用 ajax 提取更新分数。更少的开销（甚至更好，推动它们！）。

我们需要查看您的代码才能知道它有什么问题。

Ps，我的钱在 apache 服务器和 php 后端之间的某个超时/错误上。这可能不是您可以解决的问题。

您现在发布了代码.....尝试添加 exit(); 在标头之后并且不要关闭您的 php 代码（它可以发送换行符，并且您在重定向时不希望这样做）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:36:34.827

我刚刚对您的代码进行了一些重组以提高性能。我做的最重要的事情是`$thisgw = mysqli_fetch_array(mysqli_query($dbc,"select gwno from gameweek"));`从 foreach 中删除，因为它总是一样的。

`update`除此之外，您的查询每个团队执行了多少次？这应该正好是 1 次。因此我会尝试从`while`文件阅读器中删除这部分。

```
<?php   
$dbc=mysqli_connect('localhost','root','','fplscore') or die("can't connect");

$epl_arr = array(
    array('id' => 24854, 'team' => 'Arsenal', 'player' => 'Jackoff'),
    array('id' => 17, 'team' => 'Aston Villa', 'player' => 'Epic Fail'),
    array('id' => 109276, 'team' => 'Chelsea', 'player' => 'ENR'),
    array('id' => 57, 'team' => 'Everton', 'player' => 'Beric'),
);

$thisgw = mysqli_fetch_array(mysqli_query($dbc,"select gwno from gameweek"));

foreach ($epl_arr as $ea)
{
    $gw = $thisgw['gwno'];
    $team_name = $ea['team']; 
    $team_id = $ea['id']; 
    $player_name = $ea['player']; 

    $str2="http://fantasy.premierleague.com/entry/".$team_id."/event-history/".$gw; 
    $file=fopen($str2,"r") or die("Heavy load on FPL. Please try later");

    while(!feof($file))
    {
        $str=fgets($file);

        if(preg_match('/(<div class="ismSBValue ismSBPrimary">(.*))/', $str,$ar)) 
        {   
            $str2 = fgets($file);
            $str2 = fgets($file);
            $str2 = strip_tags($str2);
            $str2 = str_replace("pts","",$str2);
            $temp1 = $str2;

        }

        if(preg_match('/(<dl class="ismDefList ismSBDefList">(.*))/', $str,$ar)) 
        {
                $str2 = fgets($file);
                $str2 = strip_tags($str2);
                $str2 = str_replace("pts","",$str2);
                $str2 = str_replace("(-","",$str2);
                $str2 = str_replace(")","",$str2);
                $temp2 = $str2;  
                $z = $temp1-$temp2;
                $gw = $gw-19;         
                $gw = "gw".$gw;
                $q = "update epl_score set ".$gw."=$z  where team='$team_name'" ;
                $result=mysqli_query($dbc,$q) or die("unable to execute query");
        }
    }
}   

header("Location: epl");        
?> 
```

如果这没有帮助，也看看[`memory_limit`](http://www.php.net/manual/en/ini.core.php#ini.memory-limit)。

也许您也可以删除`header`文件末尾的您以进行测试。之前的输出可能有问题。

也尝试使用设置进行调试[`ini_set('error_reporting', E_ALL);`](http://php.net/manual/de/function.error-reporting.php)

# c# - How do you get or retrieve data from specific row in mysql database to a textbox?

> ID：15718719
> 
> 赞同：0
> 
> 时间：2013-03-30T12:51:20.037
> 
> 标签：c#, mysql, get

I have codes of getting all the datas from mysql to datagrid view but I am stuck in getting data from mysql to the textbox. This textbox has read only property it is where the username of the login user will be displayed.

For further understanding here is the image.

![click image](../Images/237a6bc18e7bd0ad6e6ffcbbd0c804e8.png)

Here is my code on getting mysql database to datagridview.

```
private void frmMain_Load(object sender, EventArgs e)
        {
            a = new ApareceCrudLib("localhost", "root", "", "cashieringdb");
            loadDataGridView_Main();
        }
        public void loadDataGridView_Main()
        {
            dgvMain.Rows.Clear();
            List<string>[] detailList = a.mysqlSelect("Select * From sales");
            for (int i = 0; i < detailList.Length; i++)
            {
                dgvMain.Rows.Add(detailList[i][0], detailList[i][1], detailList[i][2], detailList[i][3]);
            }
        } 
```

This is a personal program I do this for the business of my sister. Actually my plan is to display first the Login User example "Admin123" then I will insert the data "Admin123" to Data Grid view user which is the current user at the time they log in so basically if Admin456 will login then his name will be displayed on Login User textbox and User in DataGridView. ***A sort of monitoring the login activity of different user who login.***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T14:19:45.967

你从哪里为你的文本框赋值？（登录用户）。在您的列表（detailList）中为用户名读取合适的位置并将其分配给文本框（登录用户）。如果要显示属于已登录用户的记录，则必须将查询更改为从用户名 = 用户名YouHaveGivenInLoginPage 的销售中选择 *。

谢谢...

# html - thumbnails transition jumping

> ID：15718723
> 
> 赞同：-1
> 
> 时间：2013-03-30T12:52:00.387
> 
> 标签：html, css, responsive-design, css-transitions

Please take a look at [http://michalpodkowa.pl](http://michalpodkowa.pl) When you hover over thumbnails in last column, images after transition are jumping a bit, especially in firefox. Any ideas how to fix it?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:48:55.223

Try this:

Add following script at the end of your page.

```
<script>
    $("#gallery").css("width",parseInt($(window).width())+0.1);
</script> 
```

# linq - Can LINQ be used in Dynamics CRM to get all Accounts not in a Collection?

> ID：15718731
> 
> 赞同：4
> 
> 时间：2013-03-30T12:53:02.247
> 
> 标签：linq, dynamics-crm-2011

How can a LINQ query be written to return all Accounts where the account number is not in a List?
The list is going to be pulled from an excel document.

```
private bool GetAccounts()
{
        List<String> accountIds = new List<String>();
        accountIds.Add( "[unknown]");
        var query = from accounts in context.AccountSet where !accountIds.Contains(accounts.AccountNumber) select accounts;
} 
```

It does not have to be a List.

**EDIT**

This is what happens when the above query runs - Is this CRM's fault? ![enter image description here](../Images/31f188e6cad4ba18658cf24c3e7b2f97.png)

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-30T16:25:16.410

I don't believe you can via linq. Here is the where clause limitations from the SDK.

> where => The left side of the clause must be an attribute name and the right side of the clause must be a value. You cannot set the left side to a constant. Both the sides of the clause cannot be constants.
> 
> Supports the String functions Contains, StartsWith, EndsWith, and Equals.

You can get around these limitations by using QueryExpression or FetchExpressions. The query you want would look like this using QueryExpression. The only thing I would mention is if you are expecting a lot of record (5000+ I believe) you will most likely need to implement paging for your function as well.

```
private static IEnumerable<Account> GetAccounts(IOrganizationService proxy)
{
    List<String> accountIds = new List<String>(new string[]{"654321", "12345"});

    var results = proxy.RetrieveMultiple(new QueryExpression(Account.EntityLogicalName)
    {
        ColumnSet = new ColumnSet("accountid", "name", "accountnumber"),
        Criteria = new FilterExpression()
        {
            Conditions = { new ConditionExpression("accountnumber", ConditionOperator.NotIn, accountIds) }
        }
    });

    return results.Entities.Select(x=> x.ToEntity<Account>());
} 
```

# php - Synchronize between two arrays

> ID：15718735
> 
> 赞同：0
> 
> 时间：2013-03-30T12:53:13.910
> 
> 标签：php, arrays, loops, foreach, synchronization

i have two arrays in php, one is a list of files and the other has uniqueid() => ("file", uid, meetings)

array 1:

```
$madeFromFilesArray = array(
    "index",
    "contact",
    "reportA",
    "reportB",
); 
```

array 2:

```
$LoadedArray = array(
    5156e1b122c2b => array("index", uid, meetings),
    5156e1b122c2c => array("about", uid, meetings),
    5156e1b122c2d => array("contact", uid, meetings),
    5156e1b122c2e => array("reportB", uid, meetings),
); 
```

array 1 is the updated one. i need to sync array 2 with 1\. for example delete "about" from array 2 because it is not in 1 and add reportA to array 2 because it is in 1 and not in 2. so the final array is:

result array3:

```
$LoadedArray = array(
    5156e1b122c2b => array("index", uid, meetings),
    5156e1b122c2d => array("contact", uid, meetings),
    5156e1b122c2e => array("reportB", uid, meetings),
    5156e1b122c2f => array("reportA", uid, meetings),
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:54:08.047

Here's a solution, but I have no idea where `uid` and `meetings` come from or what they represent, so I used strings

```
$madeFromFilesArray = array(
    "index",
    "contact",
    "reportA",
    "reportB",
);

$LoadedArray = array(
    '5156e1b122c2b' => array("index", 'uid', 'meetings'),
    '5156e1b122c2c' => array("about", 'uid', 'meetings'),
    '5156e1b122c2d' => array("contact", 'uid', 'meetings'),
    '5156e1b122c2e' => array("reportB", 'uid', 'meetings'),
);

$seenFiles = array();
foreach ($LoadedArray as $key => $values) {
    if (!in_array($values[0], $madeFromFilesArray)) {
        unset($LoadedArray[$key]);
    } else {
        $seenFiles[] = $values[0];
    }
}

$missingFiles = array_diff($madeFromFilesArray, $seenFiles);
foreach ($missingFiles as $value) {
    $LoadedArray[uniqid()] = array($value, 'uid', 'meetings');
} 
```

# c# - 405 方法不允许 Web API

> ID：15718741
> 
> 赞同：101
> 
> 时间：2013-03-30T12:53:45.417
> 
> 标签：c#, asp.net-web-api, webdav

这个错误很常见，我尝试了所有的解决方案，但没有一个有效。我在控制面板中禁用了 WebDAV 发布并将其添加到我的 Web 配置文件中：

```
 <handlers>
  <remove name="WebDAV"/>
  </handlers>
  <modules runAllManagedModulesForAllRequests="true">
  <remove name="WebDAVModule"/>
  </modules> 
```

错误仍然存​​在。这是控制器：

```
 static readonly IProductRepository repository = new ProductRepository();

    public Product Put(Product p)
    {
        return repository.Add(p);
    } 
```

方法实现：

```
 public Product Add(Product item)
    {
        if (item == null)
        {
            throw new ArgumentNullException("item");
        }
        item.Id = _nextId++;
        products.Add(item);
        return item;
    } 
```

这就是引发异常的地方：

```
client.BaseAddress = new Uri("http://localhost:5106/");
client.DefaultRequestHeaders.Accept.Add(
new MediaTypeWithQualityHeaderValue("application/json"));      
var response = await client.PostAsJsonAsync("api/products", product);//405 exception 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-03-30T12:58:41.453

您正在从客户端发布：

```
await client.PostAsJsonAsync("api/products", product); 
```

不放。

您的 Web API 方法只接受 PUT 请求。

所以：

```
await client.PutAsJsonAsync("api/products", product); 
```

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2014-02-24T21:20:00.143

我也有同样的例外。我的问题是我使用过：

```
using System.Web.Mvc; // Wrong namespace for HttpGet attribute !!!!!!!!!
[HttpGet]
public string Blah()
{
    return "blah";
} 
```

应该

```
using System.Web.Http; // Correct namespace for HttpGet attribute !!!!!!!!!
[HttpGet]
public string Blah()
{
    return "blah";
} 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2014-09-03T03:14:15.847

我尝试了很多方法来让 DELETE 方法工作（我得到了 405 method not allowed web api），最后我将**[Route("api/scan/{id}")]** 添加到我的控制器并且工作正常。希望这篇文章对某人有所帮助。

```
 // DELETE api/Scan/5
    [Route("api/scan/{id}")]
    [ResponseType(typeof(Scan))]
    public IHttpActionResult DeleteScan(int id)
    {
        Scan scan = db.Scans.Find(id);
        if (scan == null)
        {
            return NotFound();
        }

        db.Scans.Remove(scan);
        db.SaveChanges();

        return Ok(scan);
    } 
```

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-08-14T15:39:09.540

我的问题原来是 WebAPI 中的属性路由。我创建了一个自定义路由，它把它当作一个 GET 而不是 WebAPI 发现它是一个 POST

```
 [Route("")]
    [HttpPost] //I added this attribute explicitly, and it worked
    public void Post(ProductModel data)
    {
        ...
    } 
```

我知道这一定很愚蠢（这会消耗你一整天）

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-07-03T20:48:52.873

Chrome 经常会`OPTIONS`在发帖前先打个电话。它这样做是为了确保 CORS 标头是有序的。如果您不在`OPTIONS`API 控制器中处理调用，则可能会出现问题。

```
public void Options() { } 
```

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2018-02-06T10:19:42.283

当您在服务器处于 https 时尝试连接到 http 时，也会发生此错误。

这有点令人困惑，因为我的 get-requests 没问题，问题只存在于 post-requests 中。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-03-10T17:10:12.147

我在 GET 调用中收到 405，问题是我在 GET 服务器端方法中命名了参数`Get(int formId)`，我需要更改路由或重命名它`Get(int id)`。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2015-09-03T20:37:10.013

如果您的方法需要一个参数并且您没有传递它，您也可能会收到 405 错误。

这不起作用（405错误）

**HTML 视图/Javascript**

```
$.ajax({
         url: '/api/News',
         //..... 
```

**网络接口：**

```
public HttpResponseMessage GetNews(int id) 
```

***因此，如果方法签名与上述类似，那么您必须执行以下操作：***

**HTML 视图/Javascript**

```
$.ajax({
         url: '/api/News/5',
         //..... 
```

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2016-04-06T08:24:28.363

我参加这个聚会迟到了，但在大多数情况下，以上任何内容都不可行或有效，这就是我最终解决的方法。

在托管站点/服务的服务器上，需要一个功能！HTTP 激活！！！

> 服务器管理器 > 管理 > 添加角色和功能 > 下一个下一个直到您到达功能 > 在 .NET（每个版本）下勾选 HTTP 激活。另请注意，>net > WCF 服务下隐藏了一个。

然后立即生效！那正在融化我的大脑

* * *

## 回答 #10

> 赞同：4
> 
> 时间：2017-04-01T10:42:30.773

如果您有类似的路线

```
[Route("nuclearreactors/{reactorId}")] 
```

您需要在方法中使用完全相同的参数名称，例如

```
public ReactorModel GetReactor(reactorId)
{
 ...
} 
```

如果您没有传递完全相同的参数，您可能会收到错误“405 method not allowed”，因为路由将与请求不匹配，并且 WebApi 将使用不同的允许 HTTP 方法访问不同的控制器方法。

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-09-24T10:45:48.980

这不能回答您的具体问题，但是当我遇到同样的问题时，我最终来到了这里，我认为更多的人可能会这样做。

我遇到的问题是我无意中将我的 Get 方法声明为*static*。我错过了整个上午，它没有引起属性或类似的警告。

不正确：

```
public class EchoController : ApiController
{
    public static string Get()
    {
        return string.Empty;
    }
} 
```

正确的：

```
public class EchoController : ApiController
{
    public string Get()
    {
        return string.Empty;
    }
} 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2018-01-19T09:32:09.407

这是一种解决方案：

```
<handlers accessPolicy="Read, Script">
   <remove name="WebDAV" />
</handlers> 
```

[docs.microsoft.com 解决方案文章](https://docs.microsoft.com/en-us/aspnet/web-api/overview/testing-and-debugging/troubleshooting-http-405-errors-after-publishing-web-api-applications)

并从模块中删除 WebDAV

```
<remove name="WebDAVModule" /> 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2014-08-21T10:39:13.737

[HttpPost] 是不必要的！

```
[Route("")]
public void Post(ProductModel data)
{
    ...
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2016-03-09T17:47:16.627

我无法解决这个问题。只要 POST 返回 void (ASP.NET 4.0 - WEBAPI 1)，我就启用了 CORS 并工作。当我尝试返回 HttpResponseMessage 时，我开始收到 HTTP 405 响应。

根据上述 Llad 的回复，我查看了自己的参考资料。

我的 POST 方法上方列出了属性 [System.Web.Mvc.HttpPost]。

我将其更改为使用：

```
[System.Web.Http.HttpPostAttribute]
[HttpOptions]
public HttpResponseMessage Post(object json)        
{
    ...
    return new HttpResponseMessage { StatusCode = HttpStatusCode.OK };
} 
```

这解决了我的困境。我希望这对其他人有帮助。

为了完整起见，我的 web.config 中有以下内容：

```
<httpProtocol>
    <customHeaders>
        <clear />
        <add name="Access-Control-Expose-Headers " value="WWW-Authenticate"/>
        <add name="Access-Control-Allow-Origin" value="*" />
        <add name="Access-Control-Allow-Methods" value="GET, POST, OPTIONS, PUT, PATCH, DELETE" />
        <add name="Access-Control-Allow-Headers" value="accept, authorization, Content-Type" />
        <remove name="X-Powered-By" />
    </customHeaders>
</httpProtocol> 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2019-05-03T10:55:39.113

在我的情况下，我在项目中有一个与 WebAPI 路由（例如沙箱）同名的物理文件夹，并且只有 POST 请求被 IIS 中的静态文件处理程序拦截（显然）。

得到一个误导性的 405 错误而不是更预期的 404，是我花了很长时间进行故障排除的原因。

不容易陷入这种情况，但有可能。希望它可以帮助某人。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-09-03T03:49:52.233

确保您的控制器继承自`Controller`类。

即使没有它，东西也能在本地工作，这甚至可能更疯狂。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2019-11-15T15:29:28.697

就我而言，我的 POST 处理程序是这种形式：

```
[HttpPost("{routeParam}")]
public async Task<ActionResult> PostActuality ([FromRoute] int routeParam, [FromBody] PostData data) 
```

我发现我必须**交换参数**，也就是说首先是 body 数据，然后是路由参数，如下所示：

```
[HttpPost("{routeParam}")]
public async Task<ActionResult> PostActuality ([FromBody] PostData data, [FromRoute] int routeParam) 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2017-01-11T07:15:55.763

签入您的项目 .csproj 文件并更改

```
<IISUrl>http://localhost:PORT/</IISUrl> 
```

像这样到您的网站网址

```
<IISUrl>http://example.com:applicationName/</IISUrl> 
```

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2017-03-06T20:48:43.217

导致相同行为的另一个可能问题是路由中的默认参数。在我的情况下，控制器已正确定位并实例化，但由于`Get`指定了默认操作，POST 被阻止：

```
config.Routes.MapHttpRoute(
    name: "GetAllRoute",
    routeTemplate: "api/{controller}.{ext}"/*,
    defaults: new { action = "Get" }*/ // this was causing the issue
); 
```

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2018-06-28T05:11:03.107

我遇到了完全相同的问题。我看了两个小时没有运气的问题，直到我意识到我的`POST`方法`private`不是`public`.

有趣的是，现在看到该错误消息有点通用。希望能帮助到你！

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-09-24T23:10:38.300

我们有一个类似的问题。我们试图从：

```
[RoutePrefix("api/car")]
public class CarController: ApiController{

    [HTTPGet]
    [Route("")]
    public virtual async Task<ActionResult> GetAll(){

    }

} 
```

所以我们会`.GET("/api/car")`，这会抛出一个`405 error`.

* * *

**修复：**

该`CarController.cs`文件位于目录中，`/api/car`因此当我们请求此 api 端点时，IIS 会返回一个错误，因为看起来我们正在尝试访问我们不允许访问的虚拟目录。

**选项 1：**更改/重命名控制器所在的目录
**选项 2：**将路由前缀更改为与虚拟目录不匹配的内容。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2021-02-04T17:53:18.320

老问题，但没有一个答案对我有用。

[本文](https://www.ryadel.com/en/error-405-methods-not-allowed-asp-net-core-put-delete-requests/)通过添加以下行解决了我的问题`web.config`：

```
<system.webServer>
  <modules runAllManagedModulesForAllRequests="false">
    <remove name="WebDAVModule" />
  </modules>
</system.webServer> 
```

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-05-01T23:28:36.980

函数名称有时会使 c# 变得复杂。更改函数的名称，它将起作用。像 ProductPut 而不是 PutProduct 或 Put。

```
public Product ProductPut(Product p)
{
    return repository.Add(p);
} 
```

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2021-06-17T17:24:55.157

就我而言，405 错误只出现在生产服务器上，而不是我的开发机器上。

我发现问题是由于我只是“手动”将本地发布的文件夹的内容从本地机器传输到在线生产服务器。

所以，对我来说，修复是简单地删除产品服务器上的所有在线文件​​，然后使用 Visual Studio 上的“发布”选项通过 FTP 直接从我的本地计算机发布到产品服务器。

我不知道为什么这会改变一些东西，因为在我看来文件是一样的，但是这个东西解决了这个问题，我希望它也可以帮助其他人。

# paypal - 新的 PayPal API - 如何设置实时应用程序？不是沙盒

> ID：15718742
> 
> 赞同：1
> 
> 时间：2013-03-30T12:53:59.490
> 
> 标签：paypal, paypal-adaptive-payments

自从我上次在网站上设置 PayPal 付款以来已经有一段时间了。

在我打开新的 PayPal API 之后，老实说，我有点困惑。目前，PayPal支持考虑的每个新网站都有哪些？

在下一页[https://developer.paypal.com/webapps/developer/applications](https://developer.paypal.com/webapps/developer/applications)上，我找到了**Test credentials**，但我想设置**Live credentials**。

在带有**Live credentials**的块中，它是这样写的：

```
Live credentials (currently for U.S. businesses)
We'll email you when your live credentials are ready. 
```

一般需要多少？还有，获得批准需要什么？有什么方法可以让它更快或者我唯一能做的就是等待？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T17:26:34.550

实时凭据目前仅适用于美国帐户，因为我们目前仅支持美国。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T17:27:47.540

您关于新网站的问题的第一部分不清楚。但我猜经典 API 可能是您的用例的更好选择，因为新的 RESTful API 仍处于测试阶段，功能有限。

我看到这被标记为 paypal-adaptive-payments。Adaptive Payments 是它自己独立的 API，您可以在此处阅读有关使用它的信息： [https ://www.x.com/developers/paypal/documentation-tools/going-live-with-your-application](https://www.x.com/developers/paypal/documentation-tools/going-live-with-your-application)

对于您问题的第二部分，我不确定需要多长时间，但我对类似流程的最佳猜测是两个工作日（周一至周五）

# java - 我如何 JUnit 测试构造函数？

> ID：15718746
> 
> 赞同：1
> 
> 时间：2013-03-30T12:54:41.490
> 
> 标签：java, unit-testing, junit

此测试运行但失败。不知道为什么？有一个长度为 1 的 Submarine 类。

```
@Test   
public void testShipConstructor() {
    assertTrue(Submarine.length == 1);      
} 
```

这是该类的代码：

```
public abstract class Ship {

    private int size;
    public static int length;

    protected Ship(int size, String type, String shortForm) {
        this.size = size;
        this.setType(type);
        this.shortForm = shortForm;
    }

    public static void setLength(int length) {
    }

    public int getLength() {
        return length;
    }

    int getSize() {
        return size;
    }
}

public class Submarine extends Ship {

    private final static int SIZE = 1;

    /**
     * * Constructor, sets inherited length variable.
     */
    public Submarine() {
        super(SIZE, "Submarine", "#");
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-30T13:00:03.420

您是否在某处实例化了 Ship 类？我假设构造函数采用值 n 来表示长度？

假设`public class Submarine extends Ship`

和一个`Submarine(int size){}`或的构造函数`Ship(int ship){}`

你的测试应该包括：

```
int desiredSize = 1;
Submarine mySub = new Submarine(desiredSize);
assertEquals(mySub.getSize(), desiredSize); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:06:14.543

Submarine 是类名吗？在那种情况下，我认为长度是静态的，因为您以静态方式访问它。所以你应该在构造函数之外初始化长度。此外，您的测试不会测试构造函数。

# angularjs - Angularjs displaying json in Rails

> ID：15718751
> 
> 赞同：0
> 
> 时间：2013-03-30T12:55:17.587
> 
> 标签：angularjs

I am trying to display a list of my donors - the html is:

```
<div class="panel">
<header>
 <h1> Donor Information </h1>
</header>

<div class="content">
 <div ng-app="Donor">
  <div ng-controller="DonorCtrl">

  <ul>
   <li ng-repeat="donor in donors">{{donors.name_last | json}}</li>
  </ul>

   </div>
  </div>
 </div>
</div> 
```

My Donor_controller.js is this:

```
var app;
app = angular.module("Donor", ["ngResource"]);

app.factory("Donors", [
   "$resource", function($resource) {
    return $resource("/donors", {}, {
        update: {
            method: "PUT"
        }
    });
  }
]);

app.factory("Donor", [
"$resource", function($resource) {
    return $resource("/donors/:id", {
        id: "@id"
    }, {
        update: {
            method: "GET"
        }
    });
  }
]);

this.DonorCtrl = [
 "$scope", "Donor", "Donors", function($scope, Donor, Donors) {
    var donor;
    $scope.donor = Donor.query();
    $scope.donors = Donors;
    $scope.addDonor = function() {};
    donor = Donor.save($scope.newDonor)(function() {
        return $scope.donors.push(donor);
    });
    return $scope.newDonor = {};
  }
]; 
```

I am returning from my rails app via donors/1.json this:

```
{
  "donor": {
  "id": 1,
  "tools_id": null,
  "first_name": "Billy",
  "last_name": "Bullard"
  }
} 
```

I get a list of dots when I view and it shows this on inspection (repeated):

```
<li ng-repeat="donor in donors" class="ng-scope ng-binding"></li> 
```

How do I go from the json coming from Rails to the list of names in Angularjs?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:37:47.527

您应该`| json`从绑定中删除，并且您想要`donor`' 姓氏，而不是`donors`'：

```
<li ng-repeat="donor in donors">{{donor.name_last}}</li> 
```

**更新 1**

此外，你应该`$scope.donors = Donors.query();`在你的控制器中，而不是`$scope.donor = ...`.

# bash - Escaping pipe character in rsh

> ID：15718756
> 
> 赞同：7
> 
> 时间：2013-03-30T12:55:49.507
> 
> 标签：bash, rsh

I am trying to run this bash command, but I cant get around the "|" pipe character

`rsh -l user machine "echo "PORTS = 123|456|789" >> conf.cfg"`

Getting:

`bash: 456 >> conf.cfg: No such file or directory`

`bash: 789: command not found`

Would you know how I can echo `PORTS = 123|456|789` into a remote file ?

Thanks!

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-30T12:57:46.237

Just escape the pipes and the quotes:

```
rsh -l user machine "echo \"PORTS = 123\|456\|789\" >> conf.cfg" 
```

# javascript - Object Literal or Modular Javascript Design Pattern

> ID：15718757
> 
> 赞同：12
> 
> 时间：2013-03-30T12:55:51.900
> 
> 标签：javascript, jquery

This may have already been asked lots of times, and I've searched around SO but so far all the answers I read aren't exactly what I'm looking for.

I'm working on a website with moderate DOM elements showing/hiding, some AJAX calls, and probably something else. So I'll be having two main script files (HTML5 Boilerplate standard)

```
plugins.js // third party plugins here
site.js // all my site specific code here 
```

Previously I'm using object literal design pattern, so my `site.js` is something like this:

```
var site = {
  version: '0.1',
  init: function() {
    site.registerEvents();
  },
  registerEvents: function() {
    $('.back-to-top').on('click', site.scrollToTop);
  },
  scrollToTop: function() {
    $('body').animate({scrollTop: 0}, 400);
  }
};

$(function() {
  site.init();
}); 
```

So far so good, it's nicely readable, all methods are public (I kinda like this, as I can test them via Chrome Dev Tools directly if necessary). However, I intend to decouple some of the site's functionality into more modular style, so I want to have something like this below the code above (or in separate files):

```
site.auth = {
  init: function() {
    site.auth.doms.loginButton.on('click', site.auth.events.onLoginButtonClicked);
  },
  doms: {
    loginButton: $('.login'),
    registerButton: $('.register')
  },
  events: {
    onLoginButtonClicked: function() {
    }
  },
  fbLogin: function() {
  }
};

site.dashboard = {
};

site.quiz = {
};

// more modules 
```

As you can see, it is very readable. However there is one obvious downside, which is I have to write code like `site.auth.doms.loginButton` and `site.auth.events.onLoginButtonClicked`. Suddenly it becomes hard to read, and it will only grow longer the more complex the functionality gets. Then I tried the modular pattern:

```
var site = (function() {
  function init() {
    $('.back-to-top').on('click', scrollToTop);
    site.auth.init();
  }

  function scrollToTop() {
    $('body').animate({scrollTop: 0}, 400);
  }

  return {
    init: init
  }
})();

site.auth = (function() {
  var doms = {
    loginButton: $('.login'),
    registerButton: $('.register')
  };

  function init() {
    doms.loginButton.on('click', onLoginButtonClicked);
  }

  function onLoginButtonClicked() {

  }

  return {
    init: init
  }
})();

// more modules 
```

As you can see, those long names are gone, but then I guess I have to init all other modules in the site.init() function to construct them all? Then I have to remember to return the functions that need to be accessible by other modules. Both of them are okay I guess albeit a bit of a hassle, but overall, am I onto a better workflow working with modular pattern?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-30T14:37:13.797

当然，这里的正确答案是：“视情况而定”。

如果您对所有数据和所有方法都完全没问题，对于您网站的每个部分都是 100% 公开的，那么只要使用单个文字（或多个文字），如果需要的话，使用嵌套对象是完全可以的，假设您可以防止它变成一个巨大的代码球。

如果您想要任何类型的私有状态，它具有任何类型的持久性（即：每次运行函数时都不会重置），那么显示模块很棒。

也就是说：
你有一个`.init`方法根本不是揭示模块的要求。
如果您的模块可以是独立的，那么只需专注于导出您想要公开的内容。

为此，当我编写团队可能会查看的代码时，稍后，我发现自己创建了一个`public_interface`对象并返回它（您返回的匿名对象的命名版本）。

这样做的好处是微乎其微的，只是增加了对需要公开的任何内容都需要附加到接口的理解。

您当前使用它的方式：

```
var module = (function () { /* ... */ return {}; }());

module.submodule = (function () { /*...*/ return {}; }()); 
```

没有比文字更好或更差，因为您可以很容易地做到这一点：

```
var module = {
    a : "",
    method : function () {},
    meta : { }
};

module.submodule = {
    a : "",
    method : function () {},
    meta : { }
}; 
```

直到你遇到对你不起作用的东西，才能满足你的需求。

就个人而言，我通常会将任何纯数据对象构建为文字：配置对象、来自其他连接的对象等...

任何可能需要一种或两种方法的简单对象，并且可以通过仅嵌套一层或两层来构建，我也可以按字面意思构建（只要它不需要初始化）。

```
// ex:
var rectangle = {
    width  : 12,
    height : 24,
    area : 0,
    perimeter : 0,
    init_area : function () { this.area = this.width * this.height; return this; }, // buh...
    init_perimeter : function () { this.perimeter = (this.width * 2) + (this.height * 2); return this; } // double-buh...
}.init_area().init_perimeter(); 
```

如果我需要其中的几个，也许我会创建一个构造函数。
但是，如果我只需要像这样独特的东西之一，那么做这样的事情不会让我头疼吗：

```
var rectangle = (function (width, height) {
    var public_interface = {
        width  : width,
        height : height,
        area   : width * height,
        perimeter : (2 * width) + (2 * height)
    };
    return public_interface;
}(12, 24)); 
```

如果需要更高级的计算，我可以将任何额外的变量保密，并从内部处理它们。
如果我需要在对象内部拥有敏感数据以及处理该数据的函数，那么我可以拥有调用这些私有函数并返回结果的公共函数，而不是提供访问权限。

此外，如果我重构我的代码，并决定`rectangle`在某个时候重命名，那么任何嵌套 3 层或更深的函数（所引用的）`rectangle`也必须进行修改。
同样，如果您正在构建您的方法，以便它们不需要直接请求任何比 更远的对象`this`，那么您将不会遇到这个问题......

...但如果你有一个看起来像这样的界面：

```
MyApp.myServices.webService.send(); 
```

它期待找到：

```
MyApp.appData.user.tokens.latest;  // where personally, I might leave tokens in a closure 
```

如果您更改 appData 模块的结构，您的 webService 模块中将会出现各种错误，直到您找到对旧格式的所有引用，并将它们全部重命名。

# php - mysql_insert_id() 没有返回值 -

> ID：15718761
> 
> 赞同：1
> 
> 时间：2013-03-30T12:56:04.390
> 
> 标签：php, mysql, mysql-insert-id

我需要从我的数据库表中检索自动增量字段。我尝试了以下但`$id`总是空的。

插入也有效。

我的表如下： `id`int(9) NOT NULL auto_increment,``

 `并`id`设置为主要

我究竟做错了什么？$conn = mysql_connect($host,$username,$password); mysql_select_db($database, $conn) or die("无法选择数据库"); 包括“update_activity.php”；updateActivity("登录", "休息时");

```
 $date = date("m/d/y"); $starttime = time();
    $sesh = $_SESSION['fname']." ".$_SESSION['lname'];
    $q = "INSERT INTO `breaks` (date, starttime, user) VALUES ('".$date."', '".$starttime."', '".$sesh."')";

    $query = mysql_query($q, $conn);
    $id = mysql_insert_id($conn);

    echo var_dump($id); exit; 
```

编辑以显示我最近的尝试

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T13:36:51.273

已阅读所有评论以及您对每条评论的回复。只有其中一种是可能的：

1.  查询正常工作或
2.  您没有获得生成的主键。

这两者永远不可能是真的。

定义，你怎么知道查询正在工作？你知道运行查询前后的最大PK吗？插入是从其他地方或线程甚至其他用户发生的吗？查询从代码或您的 mysql 客户端正常工作？

为了诊断问题，我们必须走正常的路。

1.  Dump your generated query before calling `mysql_query`.
2.  Wrap a error checking system around your query call so php can tell you if the query worked or not. I am sure just by these two steps you will realize the root cause of the problem.

    ```
    error_reporting(E_ALL);
    ini_set('display_errors','on');

    echo "before calling: $q\n";
    $query = mysql_query($q, $conn);
    if(!$query)
    {
        echo "Error:" . mysql_error($conn);
        return;
    }
    echo " generated id:" . mysql_insert_id($conn); 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:08:34.490

@adelphia 据我所知，执行的查询存在问题。请正确检查查询

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:06:37.460

从这里提取的代码中借用线索：

[http://php.net/manual/en/function.mysql-insert-id.php](http://php.net/manual/en/function.mysql-insert-id.php)

```
<?php
$link = mysql_connect('localhost', 'mysql_user', 'mysql_password');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('mydb');

mysql_query("INSERT INTO mytable (product) values ('kossu')");
printf("Last inserted record has id %d\n", mysql_insert_id());
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-30T13:06:39.313

插入查询的问题

```
$q = "INSERT INTO `breaks` (date, starttime, user) 
      VALUES ('".$date."', 
              '".$starttime."',
              '".$_SESSION['fname'] $_SESSION['lname']."')"; 
```

试试这个

主要是您使用了大多数已弃用的“mysql”之类的东西，例如“mysql_insert_id()”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-30T13:21:11.563

将您要传递的值存储到数组或变量中，并将其传递到插入查询中。它应该可以正常工作......`

# jquery - Jscrollpane + Fancybox + Bootstrap

> ID：15718768
> 
> 赞同：0
> 
> 时间：2013-03-30T12:56:44.667
> 
> 标签：jquery, ajax, twitter-bootstrap, fancybox, jscrollpane

I'm trying to solve a problem that does not show the JScrollPane on a window ajax Fancybox with row within a structure-fluid bootstrap.

I saw on the net almost all the posts related to the problem, I have tried almost everything, but it really is a problem you can not solve?

I used a file main.js : specific code for fancybox whit jscrollpane (no work in firefox)

```
$(".various").attr('rel', 'gallery').fancybox({
        maxWidth: 900,
        maxHeight: 400,
        fitToView: false,
        autoSize: false,
        closeClick: false,
        openEffect: 'fade',
        closeEffect: 'fade',

        'onComplete': (function(){
           scrollpane = $('.row-fluid #span4project').jScrollPane({showArrows: true, scrollbarWidth : '50'});
        }),
        'onStart' : (function() {

        }),
        'onClose' : (function() {
            scrollpane.destroy();
        })

    }); 
```

Code for the content in home page (good work in firefox)

```
 if (!$.browser.webkit) {
      $('#content1').jScrollPane();
      $('#content2').jScrollPane();
      $('#content3').jScrollPane();
      $('#content4').jScrollPane();

          } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T21:46:37.630

感谢您的回答，我尝试使用 fancybox 2 的代码支持

这是 .various 的代码

```
 /* fancybox        ---------------------------------------------         */
    /* profile, research */
    $(".various").attr('rel', 'gallery').fancybox({
        maxWidth: 900,
        maxHeight: 400,
        fitToView: false,
        autoSize: false,
        closeClick: false,
        openEffect: 'fade',
        closeEffect: 'fade',
         afterLoad:function(){

          $('.rowfluid').jScrollPane({width:265, scrollbarWidth:17, scrollbarMargin:10, showArrows:true, arrowSize: 17, wheelSpeed:71});
        } 
```

# spring - Spring MVC 验证自定义消息

> ID：15718771
> 
> 赞同：3
> 
> 时间：2013-03-30T12:56:53.567
> 
> 标签：spring, jakarta-ee, spring-mvc, validation, bean-validation

我的问题是我有一个表单，其中包含带有一些选择选项值的 html 选择元素，我想使用以下方法验证这些值：

```
org.hibernate.validator.constraints
or
javax.validation.constraints 
```

注释。在这里您可能会看到我的表单和我的选择元素：

```
<form:form action="../agents/add" method="POST" commandName="myAgent">
     <form:select path="state">
            <form:option value="ACTIVE" path="state">ACTIVE</form:option>
            <form:option value="LISTEN" path="state">LISTEN</form:option>
            <form:option value="DOWN" path="state">DOWN</form:option>
    </form:select>
</form:form> 
```

我已经像这样定义了我的控制器方法：

```
 @RequestMapping(value = "agents/add", method = RequestMethod.POST)
    public String addAgentSubmit(@ModelAttribute("myAgent") @Valid final AgentValidator agent, BindingResult result, RedirectAttributes redirect) {
      if (result.hasErrors()) {
        return "admin/agent/add";
      } 
       ...
    } 
```

我还定义了一个 ModelAttribute 像这样：

```
@ModelAttribute("myAgent")
 public AgentValidator getLoginForm() {
    return new AgentValidator();
 } 
```

这也是我的 AgentValidator 类：

```
public class AgentValidator {
    @NotEmpty(message = "your state can not be empty !")
    private AgentState state;
        getter & setter ...
} 
```

这是我的代理状态：

```
public enum AgentState {
    ACTIVE, DOWN, PAUSED
 } 
```

当我在表单中输入错误的值时（类似这样）：

```
<form:form action="../agents/add" method="POST" commandName="myAgent">
     <form:select path="state">
            <form:option value="ACTIVE!NVALID" path="state">ACTIVE</form:option>
            <form:option value="LISTEN" path="state">LISTEN</form:option>
            <form:option value="DOWN" path="state">DOWN</form:option>
    </form:select>
</form:form> 
```

提交表单后，我的 JSP 中没有显示自定义消息，而是看到以下消息：

> 无法将 java.lang.String 类型的属性值转换为属性状态所需的类型 tm.sys.validator.AgentState；嵌套异常是 org.springframework.core.convert.ConversionFailedException: 无法从 java.lang.String 类型转换为 @javax.validation.constraints.NotNull tm.sys.validator.AgentState 值 ACTIVE!NVALID；嵌套异常是 java.lang.IllegalArgumentException: No enum constant tm.sys.validator.AgentState.ACTIVE!NVALID

我为此问题进行了很多搜索，但没有一个解决方案可以帮助我向用户提供我的自定义消息。如果您对此有任何解决方案，请提供完整的解决方案，因为我还不是那么先进的程序员。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T14:18:08.417

You need to add one of the following keys: typeMismatch, typeMismatch.state or typeMismatch.agentValidator.state into your Messages.properties (or ValidationMessages.properties - whichever messages properties file you have configured with your validator).

```
typeMismatch.state=You provided invalid state 
```

Exact key name(s) that you need add to message properties can be found from BindingResult. Take a look at result.getFieldError().getCodes() (this should contain codes for the first field error if there is any).

This will override default message (the one which you are seeing) for situations when form submitted value cannot be converted to required type (enum in your case).

# javascript - In localStorage how do we save similar tuples with index?

> ID：15718774
> 
> 赞同：0
> 
> 时间：2013-03-30T12:57:29.447
> 
> 标签：javascript, arrays, html, local-storage

In our extension, we are getting values of username( eg: Johnny123), accname (eg: Facebook). I want to store this for multiple accounts and usernames in the localStorage.

We have written this code :

```
var i = Number(localStorage.usercounter);   // counter for number of users
localStorage.username(i) = username.value; // textbox value
localStorage.accname(i) = accname.value; // textbox value 
```

this code is not executing, what is the right way to store the values?

```
localStorage.username = username.value;
localStorage.accname = accname.value; 
```

this is executing and allowing us to retrieve values. Please Help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T16:03:16.823

[这就是我使用 truStorage ( https://github.com/andresgallo/truStorage](https://github.com/andresgallo/truStorage) )读写它的方式

```
truStorage.setItem('a',{});//This will be the main key, the one localStorage is aware of

truStorage.setItem('a.b',[1,2,3]);//Now we can store variable 'b' inside object a

truStorage.getItem('a'); //returns entire object {a : {b: [1,2,3]}}
truStorage.getItem('a.b') //returns child object {b: [1,2,3]} 
```

您可以按照建议的方式直接写入子项。

```
truStorage.setItem('a.b.c', 'value of third level nested object c'); 
```

在后台，这确实为您执行 JSON 解析/字符串化和递归，如果您使用大量 localStorage，这将大量清理您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:09:28.710

`localStorage`在数据属性上存储字符串...

...您的选择是：

1.  存储包含用户对象的数组的 JSON 表示

    ```
    var userdata = [{ name : "Bob",  account : "Facebook" },
                    { name : "Doug", account : "LinkedIn" }],

    userjson = JSON.stringify(userdata);

    localStorage.setItem("users", userjson);

    console.log(JSON.parse(localStorage.getItem("users")[0].name); 
    ```

2.  将 JSON/字符串表示存储到后缀键

    ```
    localStorage.setItem("user_0_name",    "Bob"   );
    localStorage.setItem("user_0_account", "Tumblr");

    localStorage.setItem("user_1_name",    "Doug"   );
    localStorage.setItem("user_1_account", "MySpace");

    // ... 
    ```

如您所见，第一个选项更有意义。

# javascript - Why do we need the create and construct functions

> ID：15718776
> 
> 赞同：0
> 
> 时间：2013-03-30T12:57:32.110
> 
> 标签：javascript

Why is it useful to have these two functions, create and construct

```
if (!Object.create) {
  Object.create = function(base) {
    function F() {};
    F.prototype = base;
    return new F();
  }
}

if (!Object.construct) {
  Object.construct = function(base) {
    var instance = Object.create(base);
    if (instance.initialize)
      instance.initialize.apply(instance, [].slice.call(arguments, 1));
    return instance;
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:23:58.823

[Object.create](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)仅在 JavaScript 1.8.5 中引入，它允许创建具有指定原型和一组属性的新对象。您可能想要发布代码的原因是在不支持的旧浏览器中填充该功能`Object.create`。但是，要小心，因为 polyfill 实现只支持第一个参数。

以下是您可以使用它的方法：

```
var parentObject = { name: 'test' },
    childObject = Object.create(parentObject);

console.log(childObject.name); // -> test 
```

至于，我在规范中没有找到对这个函数`Object.construct`的任何引用，但是据我所知，`Object.create`它和将向它传递您可能在参数之后传递的附加参数。`initialize``base``base`

例如：

```
var parentObject = {
    initialize: function (name) {
        this.name = name;
    }
};

var childObject = Object.construct(parentObject, 'test');

console.log(childObject.name); // -> test 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:41:12.277

“我们”没有。 `Object.create`是一种在现代浏览器（按照规范运行 ES5 的这一部分）中创建对对象具有非常低级访问权限的对象的方法。

```
var bob = Object.create(Person.prototype, { name : {
                                                writeable : false,
                                                configurable : false,
                                                value : "Bob"          }}); 
```

`bob`继承自`Person`。

`bob.name`现在等于“鲍勃”。
`bob.name`不能改写。
`bob.name`不能更改为不同的数据类型（数字/布尔值/NaN/null/等）。
`bob.name`不能被删除，除了，也许，完全摆脱`bob`, 。

这仅适用于现代浏览器。

polyfill`Object.create`只做继承部分，因为旧版本的 JavaScript 不允许访问对象的枚举，或者它们是可写的还是特定类型的等等。
因此，它们不能被填充。

没有人***需要*** `Object.create`。没有人不做系统架构（无论是 AJAX 库还是新的基于 NodeJS 的银行系统或云操作系统或其他），就是这样。即使这样，它也只有在您可以保证浏览器使用的是现代版本的 JS 时才有用。

# javascript - JQuery-使用函数范围之外的变量

> ID：15718779
> 
> 赞同：-2
> 
> 时间：2013-03-30T12:57:57.627
> 
> 标签：javascript, jquery

我有以下 JQuery 函数：

```
jQuery(function() {
                jQuery("#datepicker").datepicker({ 
                    onSelect: function(value) { 
                        alert('The chosen date is ' + value); 
                        currentDate= Math.round(Date.parse(value)/ 1000);

                    } 
                });

                // TODO
                // on select of a time value trigger the action 
                jQuery("#timepicker").timepicker({ 'timeFormat': 'H:i'}) 
                val = jQuery("#timepicker").val();
                currentTime= Math.round(Date.parse(val)/ 1000);

                var t1 = new Date(currentTime * 1000);
                var t2 = new Date(1364598000 * 1000);
                var t3 = new Date(t2.getFullYear(), t2.getMonth(),   t2.getDate(),
                                     t1.getHours(),    t1.getMinutes(), t1.getSeconds(), t1.getMilliseconds());
                console.log(t3);
                var timestamp = t3.getTime() / 1000;
                }); 
```

我的问题是：

在“ **var t2** ”而不是固定值中，如何使用“ **var currentDate** ”？

更准确地说，我想使用t2中的**值**`onSelect: function(value)` 。

**这意味着每当为currentDate**分配一个新值时，我希望它在**t2 中传递。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T12:59:37.963

只需在函数外声明它：

```
 var currentDate; //declare outside function
            jQuery("#datepicker").datepicker({ 
                onSelect: function(value) { 
                    alert('The chosen date is ' + value); 
                    currentDate= Math.round(Date.parse(value)/ 1000);

                } 
            }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:00:33.450

```
jQuery(function() {

var currentDate;//declaration of currentDate 

          jQuery("#datepicker").datepicker({ 
                onSelect: function(value) { 
                    alert('The chosen date is ' + value); 
                    currentDate= Math.round(Date.parse(value)/ 1000);

                } 
            }); 
```

你可以这样声明。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:13:33.640

试试这个 -

```
jQuery(function() {
    var currentDate; //just declare it here.
    jQuery("#datepicker").datepicker({ 
        onSelect: function(value) { 
            alert('The chosen date is ' + value); 
            currentDate= Math.round(Date.parse(value)/ 1000);
        } 
    });

    // TODO
    // on select of a time value trigger the action 
    jQuery("#timepicker").timepicker({ 'timeFormat': 'H:i'}) 
    val = jQuery("#timepicker").val();
    currentTime= Math.round(Date.parse(val)/ 1000);

    var t1 = new Date(currentTime * 1000);
    var t2 = new Date(1364598000 * 1000);
    var t3 = new Date(t2.getFullYear(), t2.getMonth(),   t2.getDate(),
                         t1.getHours(),    t1.getMinutes(), t1.getSeconds(), t1.getMilliseconds());
    console.log(t3);
    var timestamp = t3.getTime() / 1000;
}); 
```

只需在外部声明它，以便可以在 datepicker 方法之外访问它。

# ubuntu - Sonar Installation on Ubuntu and Windows

> ID：15718781
> 
> 赞同：-1
> 
> 时间：2013-03-30T12:58:07.903
> 
> 标签：ubuntu, installation, sonarqube

I am trying to install Sonar on ubuntu but there is always an error coming up. I couldnt find any installation guide explaining the installation step by step completely. Is there any?

Here is the latest log output.

```
INFO   | jvm 1    | 2013/03/30 10:30:31 | 2013-03-30 10:30:31.075:INFO::Stopped SelectChannelConnector@0.0.0.0:9000
INFO   | jvm 1    | 2013/03/30 10:30:31 | 2013-03-30 10:30:31.192:INFO::Shutdown hook complete
STATUS | wrapper  | 2013/03/30 10:30:32 | <-- Wrapper Stopped
STATUS | wrapper  | 2013/03/30 10:30:32 | --> Wrapper Started as Daemon
STATUS | wrapper  | 2013/03/30 10:30:32 | Launching a JVM...
INFO   | jvm 1    | 2013/03/30 10:30:32 | Wrapper (Version 3.2.3) http://wrapper.tanukisoftware.org
INFO   | jvm 1    | 2013/03/30 10:30:32 |   Copyright 1999-2006 Tanuki Software, Inc.  All Rights Reserved.
INFO   | jvm 1    | 2013/03/30 10:30:32 | 
INFO   | jvm 1    | 2013/03/30 10:30:32 | 2013-03-30 10:30:32.957:INFO::Logging to STDERR via org.mortbay.log.StdErrLog
INFO   | jvm 1    | 2013/03/30 10:30:33 | 2013-03-30 10:30:33.012:INFO::jetty-6.1.25
INFO   | jvm 1    | 2013/03/30 10:30:33 | 2013-03-30 10:30:33.204:INFO::NO JSP Support for /, did not find org.apache.jasper.servlet.JspServlet
2013.03.30 10:30:34 INFO  o.s.c.p.Database  Create JDBC datasource
2013.03.30 10:30:34 ERROR o.s.s.p.Platform  
### Error opening session.  Cause: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))
### The error may exist in org/sonar/core/dashboard/WidgetPropertyMapper.java (best guess)
### The error occurred while processing mapper_resultMap[resourceResultMap]
### Cause: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))
org.apache.ibatis.exceptions.PersistenceException: 
### Error opening session.  Cause: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))
### The error may exist in org/sonar/core/dashboard/WidgetPropertyMapper.java (best guess)
### The error occurred while processing mapper_resultMap[resourceResultMap]
### Cause: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))
    at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:8) ~[mybatis-3.0.6.jar:3.0.6]
    at org.apache.ibatis.session.defaults.DefaultSqlSessionFactory.openSessionFromDataSource(DefaultSqlSessionFactory.java:83) ~[mybatis-3.0.6.jar:3.0.6]
    at org.apache.ibatis.session.defaults.DefaultSqlSessionFactory.openSession(DefaultSqlSessionFactory.java:40) ~[mybatis-3.0.6.jar:3.0.6]
    at org.sonar.core.persistence.MyBatis.openSession(MyBatis.java:142) ~[sonar-core-3.1.jar:na]
    at org.sonar.core.persistence.DatabaseVersion.getVersion(DatabaseVersion.java:51) ~[sonar-core-3.1.jar:na]
    at org.sonar.server.platform.DefaultServerUpgradeStatus.start(DefaultServerUpgradeStatus.java:40) ~[classes/:na]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.7.0_15]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) ~[na:1.7.0_15]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.7.0_15]
    at java.lang.reflect.Method.invoke(Method.java:601) ~[na:1.7.0_15]
    at org.picocontainer.lifecycle.ReflectionLifecycleStrategy.invokeMethod(ReflectionLifecycleStrategy.java:110) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.lifecycle.ReflectionLifecycleStrategy.start(ReflectionLifecycleStrategy.java:89) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.injectors.AbstractInjectionFactory$LifecycleAdapter.start(AbstractInjectionFactory.java:84) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.behaviors.AbstractBehavior.start(AbstractBehavior.java:169) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.behaviors.Stored$RealComponentLifecycle.start(Stored.java:132) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.behaviors.Stored.start(Stored.java:110) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.DefaultPicoContainer.potentiallyStartAdapter(DefaultPicoContainer.java:1009) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.DefaultPicoContainer.startAdapters(DefaultPicoContainer.java:1002) ~[picocontainer-2.14.1.jar:na]
    at org.picocontainer.DefaultPicoContainer.start(DefaultPicoContainer.java:760) ~[picocontainer-2.14.1.jar:na]
    at org.sonar.api.platform.ComponentContainer.startComponents(ComponentContainer.java:70) ~[sonar-plugin-api-3.1.jar:na]
    at org.sonar.server.platform.Platform.startDatabaseConnectors(Platform.java:153) ~[classes/:na]
    at org.sonar.server.platform.Platform.init(Platform.java:102) ~[classes/:na]
    at org.sonar.server.platform.PlatformLifecycleListener.contextInitialized(PlatformLifecycleListener.java:33) [classes/:na]
    at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:548) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:136) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1272) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:489) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jetty-util-6.1.25.jar:6.1.25]
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.jetty.Server.doStart(Server.java:224) [jetty-6.1.25.jar:6.1.25]
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50) [jetty-util-6.1.25.jar:6.1.25]
    at org.sonar.application.JettyEmbedder.start(JettyEmbedder.java:72) [sonar-application-3.1.jar:na]
    at org.sonar.application.StartServer.main(StartServer.java:48) [sonar-application-3.1.jar:na]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.7.0_15]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) ~[na:1.7.0_15]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.7.0_15]
    at java.lang.reflect.Method.invoke(Method.java:601) ~[na:1.7.0_15]
    at org.tanukisoftware.wrapper.WrapperSimpleApp.run(WrapperSimpleApp.java:240) [wrapper-3.2.3.jar:3.2.3]
    at java.lang.Thread.run(Thread.java:722) [na:1.7.0_15]
Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1549) ~[commons-dbcp-1.3.jar:1.3]
    at org.apache.commons.dbcp.BasicDataSource.createDataSource(BasicDataSource.java:1388) ~[commons-dbcp-1.3.jar:1.3]
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:1044) ~[commons-dbcp-1.3.jar:1.3]
    at org.apache.ibatis.session.defaults.DefaultSqlSessionFactory.openSessionFromDataSource(DefaultSqlSessionFactory.java:73) ~[mybatis-3.0.6.jar:3.0.6]
    ... 38 common frames omitted
Caused by: java.sql.SQLException: Access denied for user 'sonar'@'localhost' (using password: YES)
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1073) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3609) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:3541) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:943) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.MysqlIO.secureAuth411(MysqlIO.java:4113) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.MysqlIO.doHandshake(MysqlIO.java:1308) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2336) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2369) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2153) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:792) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47) ~[mysql-connector-java-5.1.18.jar:na]
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method) ~[na:1.7.0_15]
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57) ~[na:1.7.0_15]
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45) ~[na:1.7.0_15]
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525) ~[na:1.7.0_15]
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:381) ~[mysql-connector-java-5.1.18.jar:na]
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305) ~[mysql-connector-java-5.1.18.jar:na]
    at org.apache.commons.dbcp.DriverConnectionFactory.createConnection(DriverConnectionFactory.java:38) ~[commons-dbcp-1.3.jar:1.3]
    at org.apache.commons.dbcp.PoolableConnectionFactory.makeObject(PoolableConnectionFactory.java:582) ~[commons-dbcp-1.3.jar:1.3]
    at org.apache.commons.dbcp.BasicDataSource.validateConnectionFactory(BasicDataSource.java:1556) ~[commons-dbcp-1.3.jar:1.3]
    at org.apache.commons.dbcp.BasicDataSource.createPoolableConnectionFactory(BasicDataSource.java:1545) ~[commons-dbcp-1.3.jar:1.3]
    ... 41 common frames omitted
INFO   | jvm 1    | 2013/03/30 10:30:34 | 2013-03-30 10:30:34.963:WARN::Failed startup of context org.mortbay.jetty.webapp.WebAppContext@7bf194a7{/,file:/usr/local/sonar-3.1/war/sonar-server}
INFO   | jvm 1    | 2013/03/30 10:30:34 | org.apache.ibatis.exceptions.PersistenceException: |### Error opening session.  Cause: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))|### The error may exist in org/sonar/core/dashboard/WidgetPropertyMapper.java (best guess)|### The error occurred while processing mapper_resultMap[resourceResultMap]|### Cause: org.apache.commons.dbcp.SQLNestedException: Cannot create PoolableConnectionFactory (Access denied for user 'sonar'@'localhost' (using password: YES))
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:8)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.apache.ibatis.session.defaults.DefaultSqlSessionFactory.openSessionFromDataSource(DefaultSqlSessionFactory.java:83)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.apache.ibatis.session.defaults.DefaultSqlSessionFactory.openSession(DefaultSqlSessionFactory.java:40)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.core.persistence.MyBatis.openSession(MyBatis.java:142)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.core.persistence.DatabaseVersion.getVersion(DatabaseVersion.java:51)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.server.platform.DefaultServerUpgradeStatus.start(DefaultServerUpgradeStatus.java:40)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at java.lang.reflect.Method.invoke(Method.java:601)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.lifecycle.ReflectionLifecycleStrategy.invokeMethod(ReflectionLifecycleStrategy.java:110)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.lifecycle.ReflectionLifecycleStrategy.start(ReflectionLifecycleStrategy.java:89)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.injectors.AbstractInjectionFactory$LifecycleAdapter.start(AbstractInjectionFactory.java:84)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.behaviors.AbstractBehavior.start(AbstractBehavior.java:169)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.behaviors.Stored$RealComponentLifecycle.start(Stored.java:132)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.behaviors.Stored.start(Stored.java:110)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.DefaultPicoContainer.potentiallyStartAdapter(DefaultPicoContainer.java:1009)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.DefaultPicoContainer.startAdapters(DefaultPicoContainer.java:1002)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.picocontainer.DefaultPicoContainer.start(DefaultPicoContainer.java:760)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.api.platform.ComponentContainer.startComponents(ComponentContainer.java:70)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.server.platform.Platform.startDatabaseConnectors(Platform.java:153)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.server.platform.Platform.init(Platform.java:102)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.server.platform.PlatformLifecycleListener.contextInitialized(PlatformLifecycleListener.java:33)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:548)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1272)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:489)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.jetty.Server.doStart(Server.java:224)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.application.JettyEmbedder.start(JettyEmbedder.java:72)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.sonar.application.StartServer.main(StartServer.java:48)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at java.lang.reflect.Method.invoke(Method.java:601)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at org.tanukisoftware.wrapper.WrapperSimpleApp.run(WrapperSimpleApp.java:240)
INFO   | jvm 1    | 2013/03/30 10:30:34 |   at java.lang.Thread.run(Thread.java:722)
INFO   | jvm 1    | 2013/03/30 10:30:34 | 2013-03-30 10:30:34.985:INFO::Started SelectChannelConnector@0.0.0.0:9000 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T01:00:37.827

基本上，在这里您试图让 Sonar 连接到 MySQL 数据库，但 sonar 没有正确的写入权限。您需要登录 mysql 并键入命令：

`GRANT ALL PRIVILEGES ON sonar TO 'sonar'@'localhost' WITH GRANT OPTION;`

这是提供您的声纳数据库称为“声纳”。

# c - What does a i2c_new_dummy do?

> ID：15718783
> 
> 赞同：8
> 
> 时间：2013-03-30T12:58:18.293
> 
> 标签：c, linux-kernel, linux-device-driver

I am working on an mfd driver. There is a single i2c bus, shared by four i2c client devices (on s single IC). The `i2c_new_dummy` API is used when attaching an adapter to each of the clients.

Why is it necessary to have a different adapter logic for different clients? How does an mfd device actually work?

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-30T13:24:16.610

As we know, the `I2C` bus will have 127 clients from the spec definition; a `7bit` *address* with `1bit` for *read/write*.

The first byte will be the `I2C` device *address*, and the device matching this address, will pull down the `ACK` bit. Next follows the **data**, most of the time this will be the address of a register.

So, if you have four `I2C` clients, you will get four devices and four client handles, even if they are contained in the **SOC**.

But sometimes you don't need so much.

Another case is on current **SOC**, one chip (like tps65910) will have lots of function, include turning on voltage, **CODEC**, and so on. Every driver will use `I2C` to set the register. You can not request one handle for one driver so this is why it call `i2c_new_dummy`.

Comments from kernel *i2c-core.c*,

```
/**
 * i2c_new_dummy - return a new i2c device bound to a dummy driver
 * @adapter: the adapter managing the device
 * @address: seven bit address to be used
 * Context: can sleep
 *
 * This returns an I2C client bound to the "dummy" driver, intended for use
 * with devices that consume multiple addresses.  Examples of such chips
 * include various EEPROMS (like 24c04 and 24c08 models).
 *
 * These dummy devices have two main uses.  First, most I2C and SMBus calls
 * except i2c_transfer() need a client handle; the dummy will be that handle.
 * And second, this prevents the specified address from being bound to a
 * different driver.
 *
 * This returns the new i2c client, which should be saved for later use with
 * i2c_unregister_device(); or NULL to indicate an error.
 */ 
```

# android - 处理服务被破坏

> ID：15718800
> 
> 赞同：0
> 
> 时间：2013-03-30T12:59:44.023
> 
> 标签：android, android-intent, service, location

在 UI 线程上运行一个服务，这不是我第一个有更多时间来使用 android 和 JAVA 但没有时间对其进行排序的方法。

我认为问题是当系统破坏它尝试重新启动的服务但启动它时发送的原始意图导致空指针异常不知道我是否应该做一些事情来保存活动实例或在服务中做一些事情解决问题。

如果我可以避免多线程，那就寻找最轻松的方法来确保它现在重新启动。下面的代码部分包含导致问题的行。

对 log-cat 格式感到抱歉

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.d(TAG, "started");

    if(deviceId==null){
        Log.d(TAG, "in if");
        deviceId=intent.getStringExtra("device_id");
        contact=intent.getStringExtra("carers_num");
    }

    Log.d(TAG, "num =" +contact);
    Log.d(TAG, "id = "+deviceId);

    if(deviceId.equalsIgnoreCase("carersD")){
        Log.d(TAG, "The carers device has been selected");

    }else if (deviceId.equalsIgnoreCase("patientsD")) {

        Log.d(TAG, "The patients device has been selected");
        registerListener();
    }

    return START_STICKY; 
} 

03-30 13:03:23.983: E/AndroidRuntime(25132): FATAL EXCEPTION: main
03-30 13:03:23.983: E/AndroidRuntime(25132): java.lang.RuntimeException: Unable to start service com.sblyit.finder.LocationService@41f6ee18 with null: java.lang.NullPointerException
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2571)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.app.ActivityThread.access$2000(ActivityThread.java:140)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1334)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.os.Looper.loop(Looper.java:137)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.app.ActivityThread.main(ActivityThread.java:4921)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at java.lang.reflect.Method.invokeNative(Native Method)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at java.lang.reflect.Method.invoke(Method.java:511)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1027)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:794)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at dalvik.system.NativeStart.main(Native Method)
03-30 13:03:23.983: E/AndroidRuntime(25132): Caused by: java.lang.NullPointerException
03-30 13:03:23.983: E/AndroidRuntime(25132):    at com.sblyit.finder.LocationService.onStartCommand(LocationService.java:83)
03-30 13:03:23.983: E/AndroidRuntime(25132):    at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2554)
03-30 13:03:23.983: E/AndroidRuntime(25132):    ... 10 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:47:53.980

如果您不希望重新启动服务，请返回`START_NON_STICKY`.

If you want to stop your service if intent doesn't contain appropriate data, call `stopSelf()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T15:46:22.027

START_REDELIVER_INTENT seems to have solved the error for anyone having similar issue

# c# - 如何为流文档实现逐字导航器？

> ID：15718806
> 
> 赞同：1
> 
> 时间：2013-03-30T13:00:28.707
> 
> 标签：c#, wpf

我想创建一个逐字导航器，这样我可以使用左右箭头键在每次击键时移动 1 个单词。选择的单词将具有自定义颜色以标记它正在被选中。这是为了逐字操作功能。

我计划`FlowDocument`通过用`<Span Name="selected" Foreground="color">`. 但是，我相信`FlowDocument`只允许我提取纯文本，而不是 xaml 源。另一方面，我找不到任何可以让我用标签元素封装现有文本的函数，例如`<Span>`.

否则，我只能想如果把所有东西都清理干净，然后用正确的`<Span>`位置重写整个东西。但是，预计此事件会经常发生（每次我按向右或向左箭头键时）。

有更好的解决方案吗？

谢谢

# asp.net-mvc-3 - Asp.net MVC 3 HttpContext.Current.Session 空

> ID：15718809
> 
> 赞同：0
> 
> 时间：2013-03-30T13:00:46.217
> 
> 标签：asp.net-mvc-3, session, reportviewer

我正在开发 Asp.net Mvc3 应用程序并使用自定义身份验证`IPrinciple`，使用 IIdentity 并将经过身份验证的用户详细信息存储在`HttpContext.Current.Session`（`SimpleSessinPessister`静态类）中。在不同的操作/视图（在同一控制器中）（使用 RedirectToAction）之间导航后`HttpContext.Current.Session`变为空。

另一个观察结果是，很快我们使用`miscrosoft.reportviewer`它生成的 PDF`HttpContext.Current.Session`变为 null 并且应用程序被迫重新登录。

如果 `HttpContext.Current.Session 变为 null 那么 TempData 也变为 null 吗？

提前致谢。杰姆斯

# hbase - 为什么 HBase Thrift API 总是返回 Thrift 客户端连接

> ID：15718811
> 
> 赞同：0
> 
> 时间：2013-03-30T13:00:59.433
> 
> 标签：hbase, thrift

对于每个 thrift API 调用（在 Erlang 中使用 HBase Thrift），API 返回一个 thrift 连接：

*二郎示例：*

```
% creating the initial connection

{ok, TFactory}          = thrift_socket_transport:new_transport_factory( "localhost", 9090, []),
{ok, PFactory}          = thrift_binary_protocol:new_protocol_factory(TFactory, []),
{ok, Protocol}          = PFactory(),
{ok, ThiftConnection1}  = thrift_client:new(Protocol, hbase_thrift),    

%calling a row mutation

{ThriftConnection2, Result} = thrift_client:call( ThriftConnection1, mutateRow, ["MYTABLE", Row1Id, MutationList1, dict:new()]),
{ThriftConnection3, Result} = thrift_client:call( ThriftConnection2, mutateRow, ["MYTABLE", Row2Id, MutationList2, dict:new()]), 
```

这引发了以下相关查询：

1.  我应该总是使用返回的连接还是只使用第一个？
2.  这些连接是否相同？
3.  这种传递连接方法会导致连接泄漏吗？
4.  有没有办法关闭这些连接，或者它们对于使用它们的每种 API 调用都有自己的生命周期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T01:01:46.550

我意识到这不是一个连接，而是一个节俭的运输参考。我将它们相互比较，它们是相同的。在 Erlang 中，打印它们的内容（序列化）关于每个结果的事实表明**它们是相同的**

```
ThriftConnection2 :
{tclient,hbase_thrift,
 {protocol,thrift_binary_protocol,
    {binary_protocol,
        {transport,thrift_buffered_transport,
            {buffered_transport,
                {transport,thrift_socket_transport,
                    {data,#Port<0.25469>,infinity}},
                []}},
        true,true}},
    0}

ThriftConnection3 :
{tclient,hbase_thrift,
{protocol,thrift_binary_protocol,
    {binary_protocol,
        {transport,thrift_buffered_transport,
            {buffered_transport,
                {transport,thrift_socket_transport,
                    {data,#Port<0.25469>,infinity}},
                []}},
        true,true}},
    0} 
```

# actionscript-3 - 逆向工程 - Flash 应用程序

> ID：15718812
> 
> 赞同：0
> 
> 时间：2013-03-30T13:01:17.797
> 
> 标签：actionscript-3, flash, actionscript-2

我有那个代码：

```
private function handleFlashVarsXmlLoaded(event:Event) : void
    {
        var secondsplit:String = null;
        var item:Array = null;
        var string:* = XML(String(event.target.data)); 
        var notsplited:* = string.vars_CDATA;  //what is .vars_CDATA?
        var splitted:* = notsplitted.split("&");
        var datacontainer:Object = {}; 
        var index:Number = 0;

        item = secondsplit.split("="); 
        datacontainer[item[0]] = item[1];

        this.parseFlashVars(datacontainer); // go next
        return;
    } 
```

该函数在加载 URLLoader 时加载。我认为此函数将 XML 文件解析为字符串（fe. `param1=arg1&param2=arg2`），然后将其拆分为“&”，然后拆分为“=”，然后将数据添加到数据容器中

```
datacontainer["param1"] = "arg1" 
```

但是 XML 文件应该是什么样子，什么是字符串。**vars_CDATA**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T07:52:54.380

我认为，vars_CDATA 只是 XML 字段的名称，becourse 名为“string”的变量包含整个 XML。所以 var "notsplitted" 包含该字段的字符串类型的数据（我认为是这样，因为行 "var splitted:* = notsplitted.split("&");"，它将字符串拆分为数组）。

# lua - 碰撞检测：myName nil 值

> ID：15718813
> 
> 赞同：0
> 
> 时间：2013-03-30T13:01:20.377
> 
> 标签：lua, sdk, null, coronasdk

我正在尝试使用 Corona SDK 示例中名为“碰撞检测”的代码为我的游戏设置碰撞。每次球与某物碰撞时，我都会遇到这个非常奇怪的错误-

> 运行时错误 ...er 1\documents\corona projects\earthyball\level1.lua:114: 尝试连接字段“myName”（一个 nil 值）堆栈回溯：[C]：？...er 1\documents\corona projects\earthyball\level1.lua:114: 在函数 <...er 1\documents\corona prRuntime 错误 ...er 1\documents\corona projects\earthyball\level1.lua: 118：尝试连接字段'myName'（一个零值）堆栈回溯：[C]：？

这是我的代码

```
 display.setStatusBar(display.HiddenStatusBar)

local storyboard = require "storyboard"
local scene = storyboard.newScene()

local physics = require "physics"
physics.start()

physics.setScale( 60 )
physics.setGravity( 0, 12 )

system.setAccelerometerInterval( 100 )

function scene:createScene(event)
   local screenGroup = self.view

   bkg = display.newImage("bkg.png")
    screenGroup:insert(bkg)

    finish = display.newImage("finishflag.png")
    finish.x = 400
    finish.y = 260
    finish.myName ="flag"
    physics.addBody(finish,"static",element)

   blockl1 = display.newImage("blockl1.png")
   blockl1:setReferencePoint(display.CentreReferencePoint)
   blockl1.x = 165
   blockl1.y = 230
   physics.addBody(blockl1,"static",element)
   screenGroup:insert(blockl1)

   l1block2 = display.newImage("l1block2.png")
   l1block2:setReferencePoint(display.CentreReferencePoint)
   l1block2.x = 300
   l1block2.y = 90
   physics.addBody(l1block2,"static",element)
   screenGroup:insert(l1block2)

   line1 = display.newImage("line1.png")
   line1:setReferencePoint(display.CentreReferencePoint)
   line1.x = 230
   line1.y = 300
   physics.addBody(line1, "static", element)
   line1.myName = "pod"
   screenGroup:insert(line1)

   line2 = display.newImage("line1.png")
   line2:setReferencePoint(display.CentreReferencePoint)
   line2.x = 230
   line2.y = 10
   physics.addBody(line2, "static", element)
   line2.myName = "pod2"
   screenGroup:insert(line2)

   line1Ver = display.newImage("lineVer.png")
   line1Ver:setReferencePoint(display.CentreReferencePoint)
   line1Ver.x = 20
   line1Ver.y = 230
   physics.addBody(line1Ver, "static", element)
   screenGroup:insert(line1Ver)

   line2Ver = display.newImage("lineVer.png")
   line2Ver:setReferencePoint(display.CentreReferencePoint)
   line2Ver.x = 440
   line2Ver.y = 230
   physics.addBody(line2Ver, "static", element)
   screenGroup:insert(line2Ver)

   ball = display.newImage("ball.png")
   ball.x = 50
   ball.y = 30
   physics.addBody(ball,"dynamic",{density=3.1, bounce=0.6, friction=0.5, radius=17})
   finish.myName ="ball"
   screenGroup:insert(ball)

end

function scene:enterScene(event)

finish.collision = onLocalCollision
finish:addEventListener( "collision", finish )

line1.collision = onLocalCollision
line1:addEventListener( "collision", line1 )

line2.collision = onLocalCollision
line2:addEventListener( "collision", line2 )

ball.collision = onLocalCollision
ball:addEventListener( "collision", ball )

end

function onLocalCollision( self, event )
    if ( event.phase == "began" ) then

        print( self.myName .. ": collision began with " .. event.other.myName )

    elseif ( event.phase == "ended" ) then

        print( self.myName .. ": collision ended with " .. event.other.myName )

    end
end

function onTilt( event )
    physics.setGravity( ( 12.5 * event.xGravity ), ( -12.5 * event.yGravity ) )
end

function scene:exitScene(event)

end

function scene:destroyScene(event)

end

Runtime:addEventListener( "accelerometer", onTilt )

element = { friction=0.5, bounce=0.3 }

scene:addEventListener("createScene",scene)
scene:addEventListener("enterScene",scene)
scene:addEventListener("exitScene",scene)
scene:addEventListener("destroyScene",scene)

return scene 
```

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T12:17:32.527

你所有的物体都是物理学的一部分。这意味着，它们都相互碰撞。这就是为什么在每次碰撞中，都可以调用碰撞事件监听器。我想说的是，你的球对象、line1、line2 和finish 上有一个碰撞事件监听器。而且您认为如果这些对象之间发生冲突，您的事件侦听器将被调用。但是例如，当球对象与 line2ver、line1ver 等碰撞时，您的事件侦听器 ball() 正在调用并且该函数试图到达不存在的 line1ver.myName。

因此，您必须将 .myName 部分添加到所有对象中，或者只是没有打印 .myName 部分。

给你一个小提示：我认为你想检测与球的碰撞 - 其他物体。为此，您可以只使用一个碰撞事件侦听器，即 ball()

希望能帮助到你...

# c# - 使用 ServiceStack 中的编号键反序列化 Json

> ID：15718818
> 
> 赞同：1
> 
> 时间：2013-03-30T13:02:06.760
> 
> 标签：c#, json, deserialization, servicestack

我有这样的Json：

```
{
  data:{
    "50":{"id":"50","name":"test", etc...},
    "51":{"id":"51","name":"test", etc...},
    "53":{"id":"53","name":"test", etc...},
    ...
  }
} 
```

反序列化此 Json 的正确方法是什么？

**[更新]**

我想我必须调整我的问题。是否可以使用带有对象描述的类来解析 Json。例如，我有这样的类和 Json，我用*.FromJson()*解析：

```
public class Data
{
    public ...
}

public class Category
{
    public int Id{get;set;}

    public string Name{get;set;}
} 
```

什么应该是三个点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T18:32:10.390

您的 json 包含一个 object `O`。该对象有一个成员`data`，它是从字符串或整数到类别对象的字典。所以尝试类似：

```
class Root
{
    public Dictionary<int, Category> data;
}

var o = JavaScriptSerializer.Deserialize<Root>(json); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T14:15:07.670

如果您使用的是 servicestack.text 就做

var v = myJson.FromJson();

不要忘记，最好在使用 servicestack 进行序列化时使用 servicestack。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T06:51:23.333

在 JSON.NET 项目中将 Json 对象反序列化为 c# 类的最佳方法（在 codeplex 上找到）

the deserialize example is:

```
JsonConvert.DeserializeObject<Category>(jsonString); 
```

# c++ - 关于 posix_memalign 的一些问题

> ID：15718820
> 
> 赞同：-1
> 
> 时间：2013-03-30T13:02:27.257
> 
> 标签：c++, memory

我了解到您使用“new”在堆上创建了一个位置，并且您必须在 Windows 操作系统上使用“delete”显式释放它。但现在我必须在 Linux 操作系统上执行此操作。我只是不知道。例如

```
char str[] = new char[512];
delete[] char; 
```

我应该为 Linux 操作系统做什么？我想我应该使用 posix_memalign 但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T13:07:14.993

首先，您的代码既不是有效的 C 也不是有效的 C++。

也许你的意思是：

```
 char str* = new char[512];
 delete[] str; 
```

它是有效的 C++（不是 C，因为`new`and`delete`是 C++ 关键字，而不是 C 关键字），并且可以在 Linux 上像在 Windows 或任何标准 C++ 实现上一样工作。

然后，`str`在[堆中](http://en.wikipedia.org/wiki/Memory_management)分配 （在 Windows 和 Linux 上，相同的程序在堆中分配）。

在您的情况下，不需要[posix_memalign(3)](http://man7.org/linux/man-pages/man3/posix_memalign.3.html)（请查看我刚刚链接的手册页）。

如果出于某种特定原因您希望指针对齐，您可能想要使用`posix_memalign`，例如是 1024 的倍数。

^(这个例子是故意的，因为它要求对 512 字节的内存区域进行 1024 字节的对齐。)

那么请有

```
 #define _GNU_SOURCE
 #include <new>
 #include <stdlib.h> 
```

稍后在同一个 C++ 源文件中：

```
 char* str = NULL;
 void* ad = NULL;
 if (posix_memalign(&ad, 1024, 512)) 
    { perror("posix_memalign failed"); exit (EXIT_FAILURE); }
 str = new(ad) char[512]; 
```

but you should have some particular reason to want an aligned pointer (here, a multiple of 1Kbyte). Usually you don't want pointer to be aligned more than the default. (You may require a large alignment, e.g. if doing arithmetic on `(intptr_t)` casts of your pointers; but this is very unusual). Notice the [placement new](http://en.wikipedia.org/wiki/Placement_new) (provided by the `<new>` standard header).

I recommend reading [Advanced Linux Programming](http://advancedlinuxprogramming.com/) (which is more focused on C than on C++). And always compile on Linux with all warnings requested by the compiler and debugging info (e.g. `g++ -Wall -g`). Learn to use the `gdb` debugger and the `valgrind` memory leak detector. Once your program has no bugs, consider asking the compiler to optimize its produced object code with `g++ -Wall -O2` instead of `g++ -Wall -g`.

actually, the real [syscalls](http://en.wikipedia.org/wiki/Syscall) done by your application to the [Linux kernel](http://en.wikipedia.org/wiki/Linux_kernel) (whose list is on [syscalls(2)](http://man7.org/linux/man-pages/man2/syscalls.2.html)) for memory management are [mmap(2)](http://man7.org/linux/man-pages/man2/mmap.2.html) and `munmap(2)` (and perhaps `sbrk(2)` which is nearly obsolete). You should use the `strace` command to find out the many syscalls done by a process.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:04:50.770

首先，`new[]`并且`delete[]`是 C++ 结构，而不是 C。

它们可在任何兼容的平台上使用，因此您可以在 Linux 上使用它们。

请注意，您的语法不正确。它应该是：

```
char *str = new char[512];
delete[] str; 
```

如果您使用 C 而不是 C++ 进行编码，则可以使用`malloc()`and `free()`.

# android - 位图壁纸每10秒更换一次android

> ID：15718822
> 
> 赞同：0
> 
> 时间：2013-03-30T13:02:34.577
> 
> 标签：android, wallpaper

您好我正在尝试创建位图壁纸。但此位图每 10 秒更改一次。我怎样才能做到这一点？

这是我尝试过的：

```
 // I have declared 
 int[] images = {R.drawable.donna, R.drawable.donna1, R.drawable.marian,
        R.drawable.marian1, R.drawable.marian};

 Handler mHandler = new Handler();

 ImageView imgView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    imgView =  (ImageView) findViewById(R.id.imageView1);

                new Thread(new Runnable() {
                    public void run() {
                        // TODO Auto-generated method stub
                        while (true) {
                            try {
                                Thread.sleep(10000);
                                mHandler.post(new Runnable() {

                                    public void run() {
                                        // TODO Auto-generated method stub
                                        // Write your code here to update the UI.
                                        Random ran = new Random();
                                        imgView.setImageResource(images[ran.nextInt(images.length)]);
                                    }
                                });
                            } catch (Exception e) {
                                // TODO: handle exception
                            }
                        }
                    }
                }).start(); 
```

但我的问题是如何集成将其设置为墙纸的功能/方法？

任何帮助都非常感谢。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:08:08.517

您可以使用`postDelayed()`在指定时间范围内更改图像：

```
Handler mHandler = new Handler(); 
Runnable __runnable = new Runnable()
{
    @Override
    public void run() 
    {
        Random ran = new Random();
        imgView.setImageResource(images[ran.nextInt(images.length)]);
        mHandler.postDelayed(this, 10000);              
    }
};
new Thread(__runnable).start(); 
```

对于您的第二个问题，请参阅以下链接：

[如何从 ImageViev 将图像设置为墙纸](https://stackoverflow.com/questions/15424157/how-to-set-image-as-wallpaper-from-the-imageviev)

# tomcat - OpenShift、Tomcat7 和 JDBC 领域

> ID：15718830
> 
> 赞同：2
> 
> 时间：2013-03-30T13:03:23.877
> 
> 标签：tomcat, jdbc, openshift, jdbcrealm

我正在尝试将基于 JaveEE Tomcat7 的应用程序部署到 OpenShift。整个配置基于 Tomcat 7 (JBoss EWS 2.0) catridge。到目前为止，我已经在本地开发了我的应用程序，并且一切正常，包括基于 JDBCRealm 的用户身份验证。

项目规范，pom.xml 附在帖子末尾：

*   完全基于 Maven
*   通过工件**org.apache.tomcat.maven使用的 tomcat**

但是现在我需要让我的应用程序在网络上可用，所以我决定去 OpenShift，在那里我创建了 Tomcat7 应用程序（它也是基于 maven 的）。部署成功，但我现在遇到了本地工作的 JDBCRealm 问题。问题是 tomcat 无法找到 MySQL 驱动程序来打开领域连接。通过指定我的 context.xml 并添加 mysql 依赖项，我用**org.apache.tomcat.maven**解决了这个问题。但是**maven-war-plugin**似乎没有注入依赖项的选项。所以我遇到了这样的错误：

```
mar 30, 2013 8:59:08 AM org.apache.catalina.realm.JDBCRealm authenticate
SEVERE: Exception performing authentication
java.sql.SQLException: com.mysql.jdbc.Driver
    at org.apache.catalina.realm.JDBCRealm.open(JDBCRealm.java:706)
    at org.apache.catalina.realm.JDBCRealm.authenticate(JDBCRealm.java:352)
    at org.apache.catalina.authenticator.BasicAuthenticator.authenticate(BasicAuthenticator.java:158)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:544)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:310)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.ClassNotFoundException: com.mysql.jdbc.Driver
    at java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:188)
    at org.apache.catalina.realm.JDBCRealm.open(JDBCRealm.java:702)
    ... 14 more 
```

和 pom.xml 像这样，它不能完成这项工作：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>majekwms</groupId>
    <artifactId>majekwms</artifactId>
    <packaging>war</packaging>
    <version>1.0</version>
    <name>majekwms</name>

    <developers>
        <developer>
            <id>kornicameister</id>
            <email>kornicameister@gmail.com</email>
            <name>Tomasz Trębski</name>
        </developer>
    </developers>

    <repositories>
        <repository>
            <id>eap</id>
            <url>http://maven.repository.redhat.com/techpreview/all</url>
            <releases>
                <enabled>true</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </repository>
    </repositories>

    <pluginRepositories>
        <pluginRepository>
            <id>eap</id>
            <url>http://maven.repository.redhat.com/techpreview/all</url>
            <releases>
                <enabled>true</enabled>
            </releases>
            <snapshots>
                <enabled>true</enabled>
            </snapshots>
        </pluginRepository>
    </pluginRepositories>
    <properties>
        <maven.compiler.source>1.6</maven.compiler.source>
        <maven.compiler.target>1.6</maven.compiler.target>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <json-simple.version>1.1.1</json-simple.version>

        <jdk.version>1.7</jdk.version>
        <log4j.version>1.2.17</log4j.version>
        <mysql.version>5.1.9</mysql.version>
        <tomcat.maven.version>2.0</tomcat.maven.version>
        <maven.compiler.version>3.0</maven.compiler.version>
        <junit.version>4.11</junit.version>
        <hibernate.version>4.2.0.CR1</hibernate.version>
        <hibernate-annotations.version>3.5.6-Final</hibernate-annotations.version>
        <hibernate-common-annotations.version>3.3.0.ga</hibernate-common-annotations.version>
        <gson.version>2.2.2</gson.version>
        <slf4j-log4j12.version>1.7.2</slf4j-log4j12.version>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.jboss.spec</groupId>
            <artifactId>jboss-javaee-6.0</artifactId>
            <version>3.0.0.Final-redhat-1</version>
            <type>pom</type>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>${junit.version}</version>
        </dependency>
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <version>${log4j.version}</version>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <version>${slf4j-log4j12.version}</version>
        </dependency>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
            <version>${mysql.version}</version>
        </dependency>

        <!--json-->
        <dependency>
            <groupId>com.googlecode.json-simple</groupId>
            <artifactId>json-simple</artifactId>
            <version>${json-simple.version}</version>
        </dependency>
        <dependency>
            <groupId>com.google.code.gson</groupId>
            <artifactId>gson</artifactId>
            <version>${gson.version}</version>
        </dependency>
        <!--json-->

        <!--hibernate-->
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-core</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-entitymanager</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-ehcache</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-annotations</artifactId>
            <version>${hibernate-annotations.version}</version>
        </dependency>
        <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-c3p0</artifactId>
            <version>${hibernate.version}</version>
        </dependency>
        <dependency>
            <groupId>javax.persistence</groupId>
            <artifactId>persistence-api</artifactId>
            <version>1.0.2</version>
        </dependency>
        <!--hibernate-->

        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>javax.servlet-api</artifactId>
            <version>3.0.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet.jsp</groupId>
            <artifactId>javax.servlet.jsp-api</artifactId>
            <version>2.2.1</version>
            <scope>provided</scope>
        </dependency>
        <dependency>
            <groupId>javax.servlet</groupId>
            <artifactId>jstl</artifactId>
            <version>1.2</version>
            <scope>provided</scope>
        </dependency>

        <dependency>
            <groupId>org.apache.tomcat</groupId>
            <artifactId>tomcat-servlet-api</artifactId>
            <version>7.0.21</version>
            <scope>provided</scope>
        </dependency>
    </dependencies>

    <profiles>
        <profile>
            <!-- When built in OpenShift the 'openshift' profile will be used when
                invoking mvn. -->
            <!-- Use this profile for any OpenShift specific customization your app
                will need. -->
            <!-- By default that is to put the resulting archive into the 'webapps'
                folder. -->
            <!-- http://maven.apache.org/guides/mini/guide-building-for-different-environments.html -->
            <id>openshift</id>
            <build>
                <finalName>majekwms</finalName>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-compiler-plugin</artifactId>
                        <version>${maven.compiler.version}</version>
                        <configuration>
                            <source>${jdk.version}</source>
                            <target>${jdk.version}</target>
                            <encoding>${project.build.sourceEncoding}</encoding>
                        </configuration>
                    </plugin>
                    <plugin>
                        <groupId>org.apache.tomcat.maven</groupId>
                        <artifactId>tomcat7-maven-plugin</artifactId>
                        <version>${tomcat.maven.version}</version>
                        <configuration>
                            <url>http://127.6.35.1:8080/MajekWMS/</url>
                            <mode>both</mode>
                            <path>/MajekWMS</path>
                            <uriEncoding>UTF-8</uriEncoding>
                            <contextReloadable>true</contextReloadable>
                            <contextFile>src/main/tomcat/context.xml</contextFile>
                        </configuration>
                        <dependencies>
                            <dependency>
                                <groupId>mysql</groupId>
                                <artifactId>mysql-connector-java</artifactId>
                                <version>${mysql.version}</version>
                            </dependency>
                        </dependencies>
                    </plugin>
                    <plugin>
                        <artifactId>maven-war-plugin</artifactId>
                        <version>2.1.1</version>
                        <configuration>
                            <attachClasses>true</attachClasses>
                            <classesClassifier>classes</classesClassifier>
                            <containerConfigXML>src/main/tomcat/context.xml</containerConfigXML>
                            <outputDirectory>webapps</outputDirectory>
                            <warName>ROOT</warName>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project> 
```

当然，我的 context.xml 似乎已被检测到，并且 tomcat 尝试从中读取配置，但由于缺少 mysql 驱动程序，它失败并出现 SQLException：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context
        className="org.apache.catalina.core.StandardContext"
        reloadable="true"
        antiJARLocking="true"
        swallowOutput="true">
    <Realm connectionName="user_name_here"
           connectionPassword="pass_here"
           connectionURL="jdbc:mysql://localhost:3306/majekwms?useUnicode=true&amp;characterEncoding=utf8"
           roleNameCol="role"
           userCredCol="secPassword"
           userNameCol="login"
           userRoleTable="userRole"
           userTable="user"
           driverName="com.mysql.jdbc.Driver"
           digest="md5"
           className="org.apache.catalina.realm.JDBCRealm"/>
</Context> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-01T06:21:35.673

感谢您在我们的论坛上发帖：[https ://www.openshift.com/forums/openshift/openshift-tomcat7-and-jdbc-realm#comment-28951](https://www.openshift.com/forums/openshift/openshift-tomcat7-and-jdbc-realm#comment-28951)

这是一个涵盖该主题的论坛主题：[https](https://www.openshift.com/kb/kb-e1040-using-your-own-jar-files-in-a-java-applica) ://www.openshift.com/kb/kb-e1040-using-your-own-jar-files-in-a-java-applica ...

你能看看它，看看它是否有帮助？然后，如果您仍然无法连接，请告诉我们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T16:41:45.167

鉴于在 openshift 中您只能部署一个 webapp，您必须编辑全局**context.xml**和**server.xml**以配置数据源。

此外，您还需要在您具有写入权限的地方添​​加**数据库 jar 驱动程序，并且 tomcat 可以找到它。**

[在这里](http://whyjava.wordpress.com/2012/11/21/configuring-jndi-datasource-with-openshift-tomcat-cartridge/)你可以展示如何。

# java - 在 Java 中检测端口可用性失败

> ID：15718835
> 
> 赞同：2
> 
> 时间：2013-03-30T13:03:59.010
> 
> 标签：java, networking, webserver, port

我尝试使用以下方法检查端口 80 是否可用：

[套接字：使用 Java 发现端口可用性](https://stackoverflow.com/questions/434718/sockets-discover-port-availability-using-java)

我有一个 Java 应用程序，它检查端口 80 是否可用，如果是，它运行一个小型 Web 服务器侦听端口 80。它可以很好地检测另一个 Java 应用程序是否在端口 80 上侦听，例如，如果我运行我的应用程序两次，第二个实例将正确地告诉我正在使用端口 80。

**问题**是我正在运行 WAMP 并在端口 80 上侦听，如果我在启动 WAMP 后运行 Java 应用程序，它不会告诉我端口 80 忙。似乎它只告诉我另一个 Java 应用程序是否使用端口 80。

这超出了我的理解......非常感谢任何帮助！

代码片段：

```
int port = 80;
if(!Connection.isPortAvailable(port)) {
    logger.info("Port " + port + " is already in use");
}
// in Connection class
public static boolean isPortAvailable(int port) {
    ServerSocket ss = null;
    DatagramSocket ds = null;
    try {
        ss = new ServerSocket(port);
        ss.setReuseAddress(true);
        ds = new DatagramSocket(port);
        ds.setReuseAddress(true);
        return true;
    } catch (IOException e) {
    } finally {
        if (ds != null) {
            ds.close();
        }

        if (ss != null) {
            try {
                ss.close();
            } catch (IOException e) {
                /* should not be thrown */
            }
        }
    }

    return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-31T00:06:53.227

这种性质的所有问题的正确答案是尝试使用它并捕获异常。不要尝试查看是否可用，然后尝试使用它仍然要处理异常，这有几个明显的问题：

1.  在“看”和“尝试”之间有一个时间窗口，在此期间情况可以改变（双向）。
2.  无论如何，您仍然必须在“使用”部分捕获故障。
3.  它基本上只是试图预测未来。这应该是计算机科学，而不是算命。

这适用于“it”的大多数值，包括网络端口、文件、任何资源。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T18:22:44.880

我能够通过运行[WampServer](http://www.wampserver.com/en/)（通过访问 localhost:80 验证它是否正在运行）并根据您的示例代码运行一个最小的 java 程序来重现您的问题。

当 WampServer 运行时，try 块中的代码没有抛出异常。但是，像这样修改 try 块的前几行

```
ss = new ServerSocket();
ss.bind(new InetSocketAddress("127.0.0.1", port)); 
```

并将`isPortAvailable`正确检测 WampServer 何时运行以及何时不运行。使用`"0.0.0.0"`代替`"127.0.0.1"`不适用于 WampServer，但可以正确检测 IIS 何时运行。您可以通过关闭第一个套接字来检查两者

```
ss = new ServerSocket();
ss.bind(new InetSocketAddress("0.0.0.0", port));
ss.close();

ss = new ServerSocket();
ss.bind(new InetSocketAddress("127.0.0.1", port)); 
```

# android - 如何使用具有正确布局的 textview 而不是 ListView 创建列表？

> ID：15718836
> 
> 赞同：0
> 
> 时间：2013-03-30T13:04:04.983
> 
> 标签：android, android-layout, android-listview

我想要两个并排的文本视图，我想要 KEY_TITLE 和 KEY_CDATE 是标题和日期从数据库到我的文本视图中。我已经通过使用 android 默认布局使用 ListView 做到了这一点，但我想创建自己的布局，它应该包含两个 TextView 和一行中的一个复选框（彼此并排）。所以谁能告诉我如何使用数据库来做到这一点？
这是xml文件

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="fill_parent"
android:background="@drawable/myyellow"
>

<ListView android:id="@+id/android:list"
      android:layout_width="wrap_content"
        android:layout_height="wrap_content"/>
</LinearLayout> 
```

这是填写列表的代码

```
private void fillData() {  
    Cursor notesCursor = mDbHelper.fetchAllNotes();  
    startManagingCursor(notesCursor);

    String[] from = new String[]{NotesDbAdapter.KEY_TITLE,NotesDbAdapter.KEY_CDATE};

    int[] to = new int[]{android.R.id.text1,android.R.id.text2};

    SimpleCursorAdapter notes =
        new SimpleCursorAdapter(this,android.R.layout.simple_list_item_2, notesCursor, from, to);
    setListAdapter(notes);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:29:35.063

[http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)

上面的教程应该可以帮助您做您想做的事，它是创建自定义列表视图的指南。我要做的是创建一个类，并为数据库中的每一行创建实例，然后使用自定义布局在 ListView 中显示数据。与使用图像和复选框设置它应该有最小的差异。

# javascript - Simplify JavaScript

> ID：15718839
> 
> 赞同：-3
> 
> 时间：2013-03-30T13:04:20.720
> 
> 标签：javascript, dom

For my site I wrote a small piece of JavaScript that updates some elements in the browser when a button is clicked but this code seems to be redundant and inefficient. Is there any way to clean this up?

```
$(function () {
    $('#switch').click(function () {
        if ($('#header').text() == 'Sign In') {
            $('#header').text('Sign Up');
            $('#switch').text('Sign In');
            $('#submit').text('Sign Up');
            $('#submit').attr('form', 'sign_up');
        } else {
            $('#header').text('Sign In');
            $('#switch').text('Sign Up');
            $('#submit').text('Sign In');
            $('#submit').attr('form', 'sign_in');
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:07:03.200

I can see a small improvement: don't query the jQuery objects each time you use them. Instead, store them in variables:

```
var $switch = $('#switch')
var $submit = $('#submit')
etc. 
```

Then use those instead of querying for the same objects so many times.

```
$switch.click(function() {
        if ($header.text() == 'Sign In') {
            $header.text('Sign Up');
            $switch.text('Sign In');
            $submit.text('Sign Up');
            etc. 
```

# ios - iOS，在单独的线程上运行 openGLES 会导致帧速率降低？

> ID：15718840
> 
> 赞同：1
> 
> 时间：2013-03-30T13:04:22.580
> 
> 标签：ios, multithreading, opengl-es, nsthread

我是 iPhone 上 openGL 编程和多线程的新手，我正在尝试编写一个小型 openGL 游戏，但我面临一个小性能问题。

游戏将图形渲染为单独的 openGL 视图（我现在使用 ES 1.1），我的渲染引擎根据用户的方向更新图形（如指南针）。在经历了人们在网上的经历后，我决定：

1.  在单独的线程上运行所有与 openGL 相关的操作（线程之间没有与 openGL 相关的操作）。
2.  在主线程上从位置服务运行回调
3.  使用委托在位置控制器和我的 openGLViews 之间传达航向更新。

    ```
    -(void)loadGame{

    //other loading operations

    [self loadThreads];

    [graphicsThread start];

    }

    -(void)loadThreads{

    //graphics thread is an ivar          
        graphicsThread = [[NSThread alloc] initWithTarget:self selector:@selector(loadGameViews) object:Nil];

        //load other thread related stuff

    }

    -(void)loadGameViews{

         //create and load all openGLViews

        } 
    ```

编辑 ：

```
 -(void)loadGameViews{

         //create and load all openGLViews
        [self.openGLView performSelector:@selector(startAnimation) onThread:graphicsThread withObject:NULL waitUntilDone:NO];

        } 
```

该代码工作正常，但我注意到帧速率（在 iPad 上测试）下降到 40 FPS（在单线程上运行时，iot 为 60）。我想知道：

1.  如果 40 FPS 是游戏可接受的帧速率。
2.  如果我的线程逻辑是正确的（或者有更好的方法吗？）
3.  如果有办法将我的帧速率提高到 60 FPS

# jquery - jQuery触发无限点击

> ID：15718843
> 
> 赞同：0
> 
> 时间：2013-03-30T13:04:49.913
> 
> 标签：jquery, triggers, click, carousel, autoscroll

我制作了一个简单的 jQuery 滑块，带有下一个和上一个按钮来移动幻灯片。我现在想让它在未手动按下按钮时自动滚动。然后我希望它在有人悬停在幻灯片上时停止滚动，并在他们没有悬停在幻灯片上时重新开始。

我在这里使用了这段代码，但它只滚动第一张幻灯片，它不会继续这样做。

```
setTimeout(function() {
    jQuery('#next').trigger('click');
}, 1000);
} 
```

我怎样才能让它不断地滑动，但我怎样才能让它在悬停在幻灯片上时停止？

我的 html 标记是这样的：

```
<ul class="nav">
    <li><a id="prev" onclick="prev()"></a>Prev</li>
    <li><a id="next" onclick="next()"></a>Next</li>
</ul>
<div id="viewport">
<ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
</ul>
</div> 
```

在这里也可以看到使用中的脚本：http: [//www.samskirrow.com/projects/carousel](http://www.samskirrow.com/projects/carousel)

现在我正在使用这个 jQuery 代码。滑块会自行更改并在悬停时停止......但它不会在页面加载时开始。我需要做哪些改变？？

```
jQuery('#viewport').hover(function() {
window.clearInterval(timer);    
}, function() {
timer = window.setInterval(function(){ jQuery('#next').trigger('click');
}, 1000);
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T13:08:04.440

您可以使用[setInterval](http://www.w3schools.com/jsref/met_win_setinterval.asp)函数，它为您提供一个计时器实例。然后，您可以在需要停止触发时（即在悬停期间）调用[clearInterval函数。](http://www.w3schools.com/jsref/met_win_clearinterval.asp)

```
var timer = setInterval(function(){...}, 1000); //whenever you need the periodical call
...
...
clearInterval(timer); //whenever you want to clear it 
```

在您的情况下，您可以定义三个函数和一个变量：

```
var timer = null;
var triggerFunc = function(){ jQuery('#next').trigger('click');};
var periodicFunc = function() {timer = window.setInterval(triggerFunc , 1000);};
var clearFunc = function() {window.clearInterval(timer);}; 
```

那么你的逻辑就会变得非常简单：

```
jQuery('#viewport').hover(clearFunc ,periodicFunc);
periodicFunc(); 
```

注意最初的调用`periodFunc();`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:26:14.587

您几乎可以使用相同的语法。

**超时：**

```
timeoutvariable = setTimeout(function(){},1000);
clearTimeout(timeoutvariable); 
```

**有间隔**

```
intervalvariable = setTimeout(function(){},1000);
clearInterval(intervalvariable); 
```

然而，话虽如此，我建议以 html 元素与行为更加分离的方式对滑块的行为进行编码。

与其经常触发点击事件，不如`next()`直接从区间内调用。这允许您通过按钮以外的东西使用下一个功能，而不是总是依赖于按钮在那里。（更多可重用的代码）

# c# - C# ef inheritance

> ID：15718845
> 
> 赞同：0
> 
> 时间：2013-03-30T13:05:05.773
> 
> 标签：c#, entity-framework, inheritance, entity

Considering OOP it should not be possible but considerring EF and the way of inheritance works on a DB level, i am wondering if EF allows to jave to child class objects inherit from the same object at the same time. I mean.... Lets consider i have a table named person as the parrent table and have two tables that inherit from it named user and another named enployee. Since the inheritance mapping works in EF works by tracking the same primary key in the child table and parrent table, it should be possible to have the person class and be able to cast it either to the employee or user class. I suposse that some modifications would have to be made to the EF generated code.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T13:00:05.953

If polymorphism is a must then you need to use table per type (TPT) or table per hierarchy (TPH) inheritance. Use TPH for domain models with a lot tables and TPT when there are less tables as queries can become messy the larger a domain model is.

TPT represents the *is a* part of a relationship. A user is a person and a user is an employee. Going on what you've said in your question, you could use TPT like so:

```
public abstract class Person
{
    public int PersonId     { get; set; }   // EF will set this as PK
    public string FirstName { get; set; }
    public string LastName  { get; set; }
}

[Table("User")]
public class User : Person
{
    public string SomeUserProperty { get; set; }
}

[Table("Employee")]
public class Employee : Person
{
    public string SomeEmployeeProperty { get; set; }
} 
```

Then in your `Context` class you only create one `DbSet` which is of type base class:

```
public class MyDbContext: DbContext
{
    public DbSet<Person> Person { get; set; }
} 
```

Then in some part of you application where you want to create instances of User or Employee:

```
using (var db = new MyDbContext())
{
    var user = db.Person.Create<User>();
    user.SomeUserProperty = "I'm a user";

    var emp = db.Person.Create<Employee>();
    emp.SomeEmployeeProperty = "I'm an employee";

    db.Person.Add(user);
    db.Person.Add(emp);
    db.SaveChanges();
} 
```

# java - 为什么侦听器在 Java 中相互依赖？

> ID：15718848
> 
> 赞同：2
> 
> 时间：2013-03-30T13:05:59.710
> 
> 标签：java, swing, actionlistener, mouselistener

我写了扫雷游戏。因为我有两个监听器作为一个按钮，

```
 class SampleClass extends MouseAdapter implements ActionListener  {

         //Some code here

          public void actionPerformed(ActionEvent event){ // Buttons listener..
               System.out.println("I came here to actionPerformed.");
               //Some Code
          }

         public void mouseClicked(MouseEvent event) { //Mouse listener..
               System.out.println("I came here to MouseClicked.");
              //Some Code
               if(event.getButton() == MouseEvent.BUTTON3){..}//If Right Mouse Button Is Clicked!!
               else if(event.getButton() == MouseEvent.BUTTON1){..}//If Left Mouse Button Is Clicked!!
         }
 } 
```

我观察到的是，每当**单击鼠标左键时，都会调用唯一的 actionPerformed 而不是 mouseClicked**。但是在单击鼠标右键时，会调用 mouseClicked（正常情况下不会调用 actionPerformed）。

但是，**当我删除 ActionListener**时，**同时单击**鼠标左键和右键**mouseClicked 都会被调用**并且工作得很好。

我想，这两个监听器是两个不同的独立线程，监听事件，**但是为什么一个依赖于另一个呢？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T13:11:15.530

没有两个听众不相互依赖。它是`JButton`触发的属性，`Action`如果它被按下，无论是通过`space bar`，或调用`doClick`或通过`left click`鼠标。这就是为什么当您按下鼠标左键但在被调用之前`actionperformed`，默认调用（假设`ActionListener`已注册） ，事件被调用。如果未在 中注册,就会发挥作用并执行所需的操作。两个 Listener 彼此独立工作。实际上，动作是按适当的顺序触发的。例如，如果 ActionListener 和 MouseListener 都已注册.. 那么触发的动作顺序如下：`JButton``actionPerformed``mousePressed``ActionListener``JButton``MouseEvent``JButton`

1.  鼠标按下（）
2.  动作执行（）
3.  鼠标释放（）
4.  鼠标点击()

此代码将使您清楚这些要点。：

```
import javax.swing.*;
import java.awt.event.*;
import java.util.*;
class Listeners extends JFrame
{
    public void prepareAndShowGUI()
    {
        setTitle("Listeners dependency");
        JButton button = new JButton("Click");
        button.addActionListener(new ActionListener()
        {
            @Override
            public void actionPerformed(ActionEvent evt)
            {
                System.out.println("Action Listener has listened.");
            }
        });
        button.addMouseListener(new MouseAdapter()
        {
            public void mouseClicked(MouseEvent evt)
            {
                System.out.println("Mouse Clicked.");
            }
            public void mousePressed(MouseEvent evt)
            {
                System.out.println("Mouse pressed.");
            }
            public void mouseReleased(MouseEvent evt)
            {
                System.out.println("Mouse Released.");
            }
        });
        getContentPane().add(button);
        pack();
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLocationRelativeTo(null);
        setVisible(true);
    }
    public static void main(String stp[])
    {
        SwingUtilities.invokeLater(new Runnable()
        {
            public void run()
            {
                Listeners listen = new Listeners();
                listen.prepareAndShowGUI();
            }
        });
    }
} 
```

在单击 JButton 时获得以下输出：

```
Mouse pressed.
Action Listener has listened.
Mouse Released.
Mouse Clicked. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:56:57.817

AWT 的`MouseListener`处理`MouseMotionListener`行为有时非常奇怪。但作为我认为事件不应该相互干扰。

如果组件没有鼠标侦听器，则鼠标事件将被提升到父容器。这意味着您可以摆脱监听父组件，并且仍然接收其所有子组件的事件。在上面的用例中，如果其他一些代码将鼠标侦听器添加到子组件，那么鼠标事件将不会冒泡到父容器. 这真是一个糟糕的设计。

I prefer to use mouse listener if and only if I am writing a subclass of a JComponent or a PL&F because they can get overidden by other events listeners.So i guess this is what happened in your case.And one suggestion is to use [EventQueue](http://docs.oracle.com/javase/6/docs/api/java/awt/EventQueue.html) that should serve your purpose.

# php - 在codeigniter中将变量传递给默认控制器

> ID：15718850
> 
> 赞同：2
> 
> 时间：2013-03-30T13:06:12.467
> 
> 标签：php, codeigniter

我在 codeigniter 中有一个默认控制器

```
class Welcome extends CI_Controller {

    public function index()
    {
        $this->load->view('welcome_message');
    } 
```

如你所知，我们可以调用这个函数

```
sitename/index.php 
```

或者

```
sitename/ 
```

**因为我在 .htaccess 中有 url 重写**

现在我想用参数传递调用相同的索引函数，比如

```
sitename/seo-services 
```

其中 seo-services 将参数传递给 index 函数以加载 seo-services 页面。

因为codeigniter的默认语法是

example.com/class/function/ID

我想要这种形式

example.com/class/ID

我想跳过类的默认（索引）函数的函数

我怎样才能做到这一点？

谢谢

正如你所看到的，我正在尝试这个以实现 seo 的目的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T13:12:00.647

附加到您的 url 的参数会自动转换为您的方法的参数。

For example if you have a method called index index in your welcome controller, then http://www.example.com/index.php/welcome/index/[parametervalue] will automatically pass [parametervalue] to your method, assuming that you define your function to receive the parameter

```
class Welcome extends CI_Controller {

    public function index($parameterValue=null)
    {
      //do whatever you need here
      //note the default value just in case it is null
    }
} 
```

If you want to make things shorter, you will have to define an alias in the config/routes.php file. Also, if you want to get rid of the index.php, you will have to configure your web server accordingly (either through .htaccess if using apache or web.config if using iis)

# sql - 添加加入后 SELECT 计数不起作用

> ID：15718852
> 
> 赞同：-1
> 
> 时间：2013-03-30T13:06:15.090
> 
> 标签：sql, sql-server-2008, select, join, count

我有这个查询：

```
select Keyword, Keywords.QuoteId, count(*) AS TotalTags 
from [QuotesTemple].[dbo].Keywords 
join [QuotesTemple].[dbo].QuoteImages 
ON QuoteImages.QuoteId=Keywords.QuoteId
group by Keyword, Keywords.QuoteId 
```

该查询有效，除了 TotalTags 始终为 1，在我添加它工作的联接之前。

对于应具有 TotalTags=5 的关键字，它会显示关键字 5 次，计数为 1。

如果我`Keywords.QuoteId`从组中删除该查询将返回错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T19:41:27.943

这行得通吗？

```
select Keyword, count(QuoteImages.QuoteId) AS TotalTags 
from [QuotesTemple].[dbo].Keywords 
join [QuotesTemple].[dbo].QuoteImages 
ON QuoteImages.QuoteId=Keywords.QuoteId
group by Keyword 
```

正如@Nenad 指出的那样，可能是 QuoteId 导致了问题。您不想看到每个 QuoteId 的单独结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T20:28:27.037

You've added an additional column to your grouping, so if you have 5 unique quotes for any keyword, of course the count for each combination will be 1\. Try:

```
select k.Keyword, k.QuoteId, 
  count(*) OVER (PARTITION BY k.Keyword) AS TotalTags 
from [enter_your_database_name_here].[dbo].Keywords AS k
INNER JOIN [enter_your_database_name_here].[dbo].QuoteImages AS q
ON k.QuoteId = q.QuoteId
group by k.Keyword, k.QuoteId; 
```

If you don't want to see a row for each `QuoteId`, then take it out of both the `SELECT` list and the `GROUP BY`. You might also not care about the join at all, why not gamble to maybe get slightly better performance (or, at worst, the same):

```
SELECT k.Keyword, COUNT(*) AS TotalTags
FROM [enter_your_database_name_here_if_you_want_to
  run_from_another_database_for_some_reason].dbo.Keywords AS k
WHERE EXISTS
(
  SELECT 1 FROM [enter_your_database_name_here_if_you_want_to
  run_from_another_database_for_some_reason].dbo.QuoteImages
  WHERE QuoteID = k.QuoteID
)
GROUP BY k.Keyword; 
```

If you don't care about the individual Quotes then I have no idea why you added . You say you got an error, but is this because you added it only to the SELECT list or only to the GROUP BY list? Why would you introduce it to either list?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:09:38.647

当你`join`用 a替换时会发生什么`left outer join`：

```
select Keyword, Keywords.QuoteId, count(*) AS TotalTags 
from [QuotesTemple].[dbo].Keywords 
left outer join [QuotesTemple].[dbo].QuoteImages 
ON QuoteImages.QuoteId=Keywords.QuoteId
group by Keyword, Keywords.QuoteId 
```

我能想到两件事。一个是您在添加联接`keywords.QuoteId`时也添加了。每个报价都有一个标签。

另一个是只有一些关键字有引号。

# php - JS使用数组在下拉选择后显示文本

> ID：15718854
> 
> 赞同：0
> 
> 时间：2013-03-30T13:06:19.470
> 
> 标签：php, javascript, magento

好的，所以我有一些代码非常适合我添加到商店中的第一个产品。但是当我添加下一个产品时，下拉选项会自动增加选择中的 ID 值。我需要找到解决此问题的方法，以便它适用于任何已加载的产品。

这是Javascript：

```
 <script language="javascript">
   function displayCondition() {
     condition = new Array("Please Select a Condition.","<b>Perfect:</b> Text to explain perfect condition!", "<b>Excellent:</b> Text to explain excellent condition!", "<b>Good:</b> Text to explain good condition!", "<b>Poor:</b> Text to explain poor condition!", "<b>Broken:</b> Text to explain broken condition!");
     var getsel = document.getElementById('select_<?php echo $_option->getId();?>').value;
     document.getElementById("divId").innerHTML = condition[getsel];
   }
</script> 
```

这是工作产品代码，请注意 ID 为 1-5：

```
 <select name="options[1]" id="select_1" class=" required-entry product-custom-option" 
title="" onchange="opConfig.reloadPrice();displayCondition()">
<option value="" >-- Please Select --</option>
<option value="1"  price="0" >Perfect </option>
<option value="2"  price="-35" >Excellent </option>
<option value="3"  price="-105" >Good </option>
<option value="4"  price="-140" >Poor </option>
<option value="5"  price="-252" >Broken </option>
</select> 
```

以及第二个产品的代码。在此之后的每个产品都将不断增加：

```
 <select name="options[6]" id="select_6" class=" required-entry product-custom-option" 
title=""  onchange="opConfig.reloadPrice();displayCondition();">
<option value="" >-- Please Select --</option>
<option value="13"  price="0" >Perfect </option>
<option value="14"  price="-35" >Excellent </option>
<option value="15"  price="-105" >Good </option>
<option value="16"  price="-140" >Poor </option>
<option value="17"  price="-252" >Broken </option>
</select> 
```

我需要的帮助在 javascript 中。我无法更改选择中的值，因为它们控制会影响每种产品的定价。先感谢您。

# javascript - 如何使用javascript和coldfusion填充动态创建的下拉框

> ID：15718857
> 
> 赞同：0
> 
> 时间：2013-03-30T13:06:37.823
> 
> 标签：javascript, cfml, cfquery, coldfusion-7

我在一行中有一个动态创建的下拉框。我在屏幕上填充那个框。有没有办法可以使用 cfquery 从 sql server 获取信息并填充下拉框。我想在javascript中做吗？

这是我的代码：

```
<script language="javascript" type="text/javascript">
function addRow() {

    var tbl = document.getElementById('tblSample');
    var lastRow = tbl.rows.length;  
    var iteration = lastRow;
    var row = tbl.insertRow(lastRow);

  // left cell
    var cellLeft = row.insertCell(0);
    var textNode = document.createTextNode(iteration-3);
    cellLeft.appendChild(textNode);

      // select cell
    var cellRightSel = row.insertCell(1);
    var sel = document.createElement('select');
    sel.name = 'sectCode' + iteration;
    sel.id = 'sectCode' + iteration;    
    sel.options[0] = new Option('---Any---', '0');
    sel.options[1] = new Option('Level 0.5: test1, '1');
    sel.options[2] = new Option('Level I: test2', '2');
    sel.options[3] = new Option('Level I.D: test3', '3');
    sel.options[4] = new Option('Level II.1: test4', '4');
    sel.options[5] = new Option('Level II.5: test5', '5');
    cellRightSel.appendChild(sel);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:59:15.307

好吧，如果您的页面是**.cfm**（我假设是），为什么不直接使用 ColdFusion 直接生成整个选择 HTML？你有什么特别的理由要避免这种情况吗？

```
<select name="test">
    <cfoutput query="yourQuery">
        <option value="#yourQuery.value#">#yourQuery.text#</option>
    </cfoutput>
</select> 
```

但是，如果您想将数据结构从 ColdFusion 传递给 JavaScript，则可以使用 JSON 等数据交换格式来完成。您的 JavaScript 代码可以进行 Ajax 调用来检索数据，或者您可以直接在页面中输出 JSON 并使其在 JS 中可访问，如下所示：

```
<script>
    var optionsData = <cfoutput>#serializeJson(yourQuery)#</cfoutput>;
</script> 
```

在这种情况下，`optionsData`JS 变量将引用一个包含查询数据的对象。[您可以在此处](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_s_03.html)找到有关序列化查询的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T14:34:35.190

另一种方法是使用`cfform`and `cfselect`：

```
<cfform>
    <cfselect name="something" 
              query="yourquery" 
              value="AFieldFromTheQuery" 
              display="AnotherFieldFromTheQuery">

    ... etc
</cfform> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T20:30:32.567

plalx 的回答很好，但如果你真的想用 Javascript 来做，你可以简单地做这样的事情：

```
sel.options[0] = new Option('---Any---', '0');
<cfoutput query="yourQuery">
    sel.options[#yourQuery.CurrentRow#] = new Option('#yourQuery.value#', '#yourQuery.text#');
</cfoutput> 
```

您可能还想使用 ColdFusion 的 JSStringFormat 函数来防止查询中这些值中的撇号之类的东西导致您的 Javascript 出现任何问题：

```
sel.options[0] = new Option('---Any---', '0');
<cfoutput query="yourQuery">
    sel.options[#yourQuery.CurrentRow#] = new Option('#JSStringFormat(yourQuery.value)#', '#JSStringFormat(yourQuery.text)#');
</cfoutput> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-31T22:17:58.030

You can do as plalx mentioned or you can use the CFSELECT tag similar to this.

```
 <!--- Get data --->
    <CFQUERY DATASOURCE="datasource" NAME="qData">
    SELECT fieldname, ID
    FROM qTable
    ORDER BY ID
    </CFQUERY>

  <cfform>  
    <CFSELECT NAME="name"
    query="qData" 
    display="fieldname"
    width="250" 
    value="ID"><option value="" selected="selected">default value</option></CFSELECT>
  </cfform> 
```

# c++ - Is there any standard to create console applications?

> ID：15718863
> 
> 赞同：-1
> 
> 时间：2013-03-30T13:06:57.610
> 
> 标签：c++, linux, command-line-interface

I want to create console applications for linux and I was wondering if there is any standard for the output of applications?

Should I follow some guidelines, or can I do whatever I want?

If there is a standard, does anyone know if there is a library I can use to output properly? I;m programming in C++.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:21:30.013

Almost all (Linux) command line utilities follow the [posix guidelines](http://pubs.opengroup.org/onlinepubs/009695399/basedefs/xbd_chap12.html), although this is mostly about command line parameters and not so much output.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:42:16.390

I recommend to follow most of the [GNU coding standards](http://www.gnu.org/prep/standards/). In particular, from a naive user's point of view, I really like the `--help` and `--version` options (which are sadly not mandated by Posix). You may want to use, for parsing of program arguments, the [argp](http://www.gnu.org/software/libc/manual/html_node/Argp.html) functions provided by GNU Libc.

You may want to use `ncurses` for full-screen console input & output, or GNU `readline` to read an editable line of input. See also [this](https://stackoverflow.com/a/8286514/841108) and [this](https://stackoverflow.com/a/15715874/841108) answers.

I also suggest you to make your console applications [free software](http://www.gnu.org/philosophy/free-sw.html) (e.g. [GPL](http://www.gnu.org/licenses/gpl.html) licensed) and publish them on some versioned repository like [github](http://github.com) or [gitorious](http://gitorious.org) etc etc...

# php - 使用我的提供商上传 .csv 文件时出现问题

> ID：15718866
> 
> 赞同：0
> 
> 时间：2013-03-30T13:07:08.153
> 
> 标签：php, file, file-upload, csv

大家好，自从从 Winhost 切换到 Media Temple 后，我的 .csv 上传器一直没有工作。我正在运行一个完全专用的服务器，它都是自我管理的，当我检查系统 error_logs.file 时，我得到：

```
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Notice:  Undefined variable: seterror in mysite/getAccountsCSV.php on line 40, referer: mysite/memberinterface.php
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Notice:  Undefined index: csvfile in mysite/getAccountsCSV.php on line 42, referer: mysite/memberinterface.php
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Warning:  fopen(): Filename cannot be empty in mysite/getAccountsCSV.php on line 44, referer: mysite/memberinterface.php
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Warning:  fgetcsv() expects parameter 1 to be resource, boolean given in mysite/getAccountsCSV.php on line 46, referer: mysite/memberinterface.php
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Warning:  array_map(): Argument #2 should be an array in mysite/getAccountsCSV.php on line 48, referer: mysite/memberinterface.php
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Warning:  array_map(): Argument #2 should be an array in mysite/getAccountsCSV.php on line 48, referer: mysite/memberinterface.php
[Sat Mar 30 04:47:53 2013] [warn] [client ip] mod_fcgid: stderr: PHP Warning:  array_search() expects parameter 2 to be array, null given in mysite/getAccountsCSV.php on line 50, referer: ./memberinterface.php
and it keeps going.... 
```

这是我的代码：

```
if (!empty($_FILES['csvfile']['error'] ) )
    {

        $seterror = 1;
        returnBack();

    } 
    if (empty($_POST['firstname'])){

        $seterror =1;
        returnBack();
    }
    if (empty($_POST['lastname'])){
        $seterrro =1;

        returnBack();
    }
    if (empty($_POST['email'])){
        $seterror =1;

        returnBack();
    }
    if ($seterror != 1){

    $file = $_FILES['csvfile']['tmp_name']; 
    var_dump($file);
    $handle = fopen($file , "r");

    $fileop = fgetcsv($handle,1000,",");

    $fileop=array_map("strtoupper",array_map("trim",$fileop));

    $firstname_index = array_search(strtoupper($_POST["firstname"]),$fileop);
    if ($firstname_index===false){
        returnBack();
    }
    $lastname_index = array_search(strtoupper($_POST['lastname']),$fileop);
    if ($lastname_index===false){

        returnBack();
    }
    $email_index = array_search(strtoupper($_POST['email']),$fileop);
    if ($email_index===false){

        returnBack();
    }
        //open file and store values
        while (($fileop=fgetcsv($handle)) !== false)
        {

            $fileop=array_map("trim",$fileop);
            $firstname[$j] = $fileop[$firstname_index];
            if (empty($firstname[$j])){ 
            exit;
            returnBackfile();

            }

            $lastname[$j] = $fileop[$lastname_index];
                if (empty($lastname[$j])){
                    exit;
            returnBackfile();

            }
            $email[$j] = $fileop[$email_index];
                if (empty($email[$j])){
            exit;
            returnBackfile();

            }
            $j++;
        }

        print_r($firstname);

    } 
```

我有一个从 jquery ui-dialog div 发送的表单.....用户可以上传文件和信息并发送到这里。如果您知道我能做些什么来解决这个问题，我将不胜感激！我不知道它是否是服务器问题，例如某些需要更改的设置或什么？

编辑：

这是 if(!empty($_FIL .....

```
$setereror = 0;
$j = 0;
function returnBack(){

    header("Location:../memberinterface.php?getmsg=15");
    exit;

}
function returnBackfile(){

    header("Location:../memberinterface.php?getmsg=16");
    exit;

} 
```

# mysql - How fast is COUNT in MySQL?

> ID：15718868
> 
> 赞同：4
> 
> 时间：2013-03-30T13:07:16.027
> 
> 标签：mysql

I am planning the table structuring and programming for a table which will have have about a billion rows.

Very often I would like to do a `SELECT COUNT(*) ON mytable WHERE somecol="5"`. `somecol` will have an index on it and is an `INT`.

Option 1 is that I just have my one giant table and use `SELECT COUNT(*)` as above.

Option 2 is I alternatively could have an additional table, called `mytableofcounts` in which I have only two columns: `somecol` and `num` and in which I keep a record of the total counts for `somecol`. This table would only have about a few hundred thousand rows and `somecol` will be unique. Then I can `SELECT num FROM mytableofcounts WHERE somecol="5"` instead.

I would prefer option 1 because it's both easier and more efficient in terms of storage and programming, however my concern is that it might be slow. Would I save on processing speed by going with the extra table of option 2, or is it equally fast to go with option 1?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T13:12:47.163

If you have an index on `somecol`, then the database is basically implementing your second method.

When it scans the index, there are two approaches the engine can take. It can get the count from the index directly, or it can use the index to fetch the pages. If you have this:

```
select count(anothercol)
from mytable
where somecol = 5; 
```

Then the engine can identify the rows where `somecol = 5`, but it still has to read the data pages to determine whether or not `anothercol` is NULL.

I'm pretty sure `count(*)` will just scan the index and not read the data pages. If you wanted to be sure then use:

```
select count(somecol)
from mytable
where somecol = 5; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:12:22.067

Option 2 could be an idea of indexing... there are several types of indexing ...I strongly recomment you to read them. then you can make your own dicision.

I used your second option long time ago in counting rows and putting the value in another table. and it was really faster than the option 1... especially if the data is huge. but you need to keep updating it.

Regards

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:16:41.690

It very depends on the type of application.

If you have more updating than reading operations (i.e. a backend system) the first solution is easier and actually faster, since you don't have to perform the COUNT operation at each update.

The second option is better for a frontend application, where you have a lot of views that require that counting result, therefore working on a billion-rows table is not very convenient. With this solution, you could have an automatic trigger to manage the counter update, provided that the counter is not updated thousand times a day.

# android - 如何将 Android 应用的方向锁定为手机中的纵向和平板电脑中的横向？

> ID：15718869
> 
> 赞同：98
> 
> 时间：2013-03-30T13:07:19.357
> 
> 标签：android, user-interface

我正在开发一个 Android 应用程序，当用户旋转设备时，我不想将其方向更改为横向模式。另外，我希望锁定方向在手机上为纵向模式，在平板电脑上为横向模式。这可以实现吗，如果可以，如何实现？谢谢。

* * *

## 回答 #1

> 赞同：178
> 
> 时间：2013-03-30T13:11:03.687

您只需在文件的[活动](http://developer.android.com/guide/topics/manifest/activity-element.html)元素内定义以下属性`AndroidManifest.xml`。它会将您的方向限制为纵向。

> 安卓：screenOrientation="人像"

*例子：*

```
 <activity
            android:name="com.example.demo_spinner.MainActivity"
            android:label="@string/app_name"
            android:screenOrientation="portrait" >
        </activity> 
```

如果您希望它适用于整个应用程序，请在应用程序标记内定义以下属性，如下所示：

```
 <application>
         android:screenOrientation="sensorPortrait"
        </application> 
```

另外，根据 Eduard Luca 在下面的评论，`screenOrientation="sensorPortrait"`如果您想启用 180 度旋转，也可以使用。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2013-03-30T13:09:28.953

你必须[`android:screenOrientation="portrait"`](http://developer.android.com/guide/topics/manifest/activity-element.html#screen)在你的`AndroidManifest.xml`. 这将在您的[`<activity>`](http://developer.android.com/guide/topics/manifest/activity-element.html)标签中完成。

此外，Android 开发者指南指出：

> [...] 您还应该明确声明您的应用程序需要纵向或横向的元素。例如，`<uses-feature android:name="android.hardware.screen.portrait" />`。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2014-11-12T11:30:32.247

我可以看到您已经接受了一个不能完全解决您的问题的答案：

```
android:screenOrientation="portrait" 
```

这将强制您的应用在手机和平​​板电脑上都是纵向的。

您可以通过使用将应用程序强制设置为设备的“首选”方向

```
android:screenOrientation="nosensor" 
```

这将导致您的应用程序在大多数手机上强制为纵向，而在平板电脑上强制为横向。有许多带有键盘的手机是为横向模式设计的。强制您的应用纵向显示可能使其在此类设备上几乎无法使用。Android 最近也在迁移到其他类型的设备。最好让设备选择首选方向。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-03-30T13:23:14.040

可能是..您必须以编程方式识别它是平板电脑还是手机...首先检查设备是手机还是平板电脑

[确定设备是智能手机还是平板电脑？](https://stackoverflow.com/questions/9279111/determine-if-the-device-is-a-smartphone-or-tablet)

[平板电脑或手机 - Android](https://stackoverflow.com/questions/5832368/tablet-or-phone-android)

然后......

```
if(isTablet)
{
      setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_LANDSCAPE);      
}else
{
      setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-30T13:13:05.760

```
<activity android:name=".yourActivity"
          android:screenOrientation="portrait" ... /> 
```

添加到主要活动并添加

```
android:configChanges="keyboardHidden" 
```

以防止您的程序在调用键盘时更改模式。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2020-05-09T11:12:27.693

在活动标签下的清单文件中将屏幕方向设置为纵向。

这里的例子

您需要输入每个活动

### 在活动中添加以下行

肖像用

```
android:screenOrientation="portrait"
tools:ignore="LockedOrientationActivity" 
```

景观

```
android:screenOrientation="landscape"
tools:ignore="LockedOrientationActivity" 
```

### 这里是 MainActivity 的例子

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    package="org.thcb.app">

    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/AppTheme">

        <activity android:name=".MainActivity"
            android:screenOrientation="portrait"
            tools:ignore="LockedOrientationActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

<activity android:name=".MainActivity2"
            android:screenOrientation="landscape"
            tools:ignore="LockedOrientationActivity">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-05-14T13:36:19.377

在活动标签下的清单文件中将屏幕方向设置为纵向。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-03-23T09:59:53.830

```
android:screenOrientation="locked" 
```

用于 实际活动`<application>`的所有应用程序 `<activity>`

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2019-12-17T12:47:00.127

只需添加：

```
android:screenOrientation="portrait" 
```

在“ **AndroidManifest.xml** ”中：

```
<activity
android:screenOrientation="portrait"
android:name=".MainActivity"
android:label="@string/app_name">
</activity> 
```

# ios - 编辑后保存文本字段中的文本

> ID：15718871
> 
> 赞同：1
> 
> 时间：2013-03-30T13:07:38.223
> 
> 标签：ios, objective-c

我有 2 个文本字段，当用户输入内容并按下导航控制器上的返回按钮或返回按钮时，它会保存文本字段。我已经尝试过这个：

```
-(BOOL)textFieldShouldEndEditing:(UITextField *)textField
{
   [textField resignFirstResponder];
   NSLog(@"textFieldShouldEndEditing");

   return YES;
} 
```

但这不会打印出任何东西。我的两个文本字段的名称是 self.CellOne.textField 和 self.CellTwo.textField，我还在`<UITextFieldDelegate>`我的班级中添加了委托。我真正想要的是每当焦点离开文本字段时，都需要保存它。

# android - Android 4.0 > 错误：[google-api-translate-java] 检索翻译时出错

> ID：15718873
> 
> 赞同：0
> 
> 时间：2013-03-30T13:07:48.063
> 
> 标签：android, google-translate

我在设备 > 4.0 的翻译中遇到错误，而在 2.2 n 其他设备中同样适用。

我收到以下错误：

```
 try {
                String system_lang      =Locale.getDefault().getLanguage(); 

                Log.v("------","system_lang: "+system_lang+"Lang: "+lang_from+" to "+lang_to);

                String translatedText = Translate.DEFAULT.execute(originalMsg,lang_from, lang_to);
                Log.v("------","trnslate "+translatedText);
                messageText.setText(translatedText);
                translate_flag = true;
            } catch (GoogleAPIException e) {
                // TODO Auto-generated catch block
                e.printStackTrace(); 
```

## }

```
 03-30 18:25:05.248: V/------(722): system_lang: enLang: nl to fr
03-30 18:25:05.248: I/System.out(722): Error: [google-api-translate-java] Error retrieving translation.
03-30 18:25:05.248: W/System.err(722): com.google.api.GoogleAPIException: java.lang.Exception: [google-api-translate-java] Error retrieving translation.
03-30 18:25:05.248: W/System.err(722):  at com.google.api.translate.TranslateV2.execute(TranslateV2.java:68)
03-30 18:25:05.248: W/System.err(722):  at com.credencys.globr.ChatActivity$2.onClick(ChatActivity.java:1018)
03-30 18:25:05.248: W/System.err(722):  at android.view.View.performClick(View.java:4198)
03-30 18:25:05.248: W/System.err(722):  at android.view.View$PerformClick.run(View.java:17158)
03-30 18:25:05.248: W/System.err(722):  at android.os.Handler.handleCallback(Handler.java:615)
03-30 18:25:05.248: W/System.err(722):  at android.os.Handler.dispatchMessage(Handler.java:92)
03-30 18:25:05.248: W/System.err(722):  at android.os.Looper.loop(Looper.java:137)
03-30 18:25:05.258: W/System.err(722):  at android.app.ActivityThread.main(ActivityThread.java:4918)
03-30 18:25:05.258: W/System.err(722):  at java.lang.reflect.Method.invokeNative(Native Method)
03-30 18:25:05.258: W/System.err(722):  at java.lang.reflect.Method.invoke(Method.java:511)
03-30 18:25:05.258: W/System.err(722):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
03-30 18:25:05.258: W/System.err(722):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
03-30 18:25:05.258: W/System.err(722):  at dalvik.system.NativeStart.main(Native Method)
03-30 18:25:05.258: W/System.err(722): Caused by: java.lang.Exception: [google-api-translate-java] Error retrieving translation.
03-30 18:25:05.258: W/System.err(722):  at com.google.api.GoogleAPI.retrieveJSON(GoogleAPI.java:99)
03-30 18:25:05.258: W/System.err(722):  at com.google.api.translate.TranslateV2.execute(TranslateV2.java:62)
03-30 18:25:05.258: W/System.err(722):  ... 12 more
03-30 18:25:05.258: W/System.err(722): Caused by: java.lang.NullPointerException
03-30 18:25:05.258: W/System.err(722):  at libcore.net.http.HttpEngine.writeRequestHeaders(HttpEngine.java:646)
03-30 18:25:05.258: W/System.err(722):  at libcore.net.http.HttpEngine.readResponse(HttpEngine.java:800)
03-30 18:25:05.258: W/System.err(722):  at libcore.net.http.HttpURLConnectionImpl.getResponse(HttpURLConnectionImpl.java:274)
03-30 18:25:05.258: W/System.err(722):  at libcore.net.http.HttpURLConnectionImpl.getInputStream(HttpURLConnectionImpl.java:168)
03-30 18:25:05.258: W/System.err(722):  at libcore.net.http.HttpsURLConnectionImpl.getInputStream(HttpsURLConnectionImpl.java:271)
03-30 18:25:05.258: W/System.err(722):  at com.google.api.GoogleAPI.retrieveJSON(GoogleAPI.java:93)
03-30 18:25:05.258: W/System.err(722):  ... 13 more
03-30 18:25:19.183: D/SMACK(722): 06:25:19 PM SENT (1116687320): 
```

我用谷歌搜索但找不到解决方案。任何提示或帮助都会被应用。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:22:47.367

这可能是因为某些默认值在 android 更改时更改了尝试设置没有默认值的东西。

# php - 代码错误“检查是拆分后的电子邮件”

> ID：15718875
> 
> 赞同：1
> 
> 时间：2013-03-30T13:07:52.840
> 
> 标签：php

这是代码

```
<?php
function is_email($input) {
  $email_pattern = "/^([a-zA-Z0-9\-\_\.]{1,})+@+([a-zA-Z0-9\-\_\.]{1,})+\.+([a-z]{2,4})$/i";
  if(preg_match($email_pattern, $input)) return TRUE;

}
$emails = "xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com
xx@xx.com";
$split_emails = split("\n",$emails);
$split_n = count($split_emails);
for ($x=0;$x<$split_n;$x++) {
if(is_email($split_emails[$x]){
echo $split_emails[$x];
}
}
?> 
```

我确定该功能可以正常工作，因为我在一封电子邮件中对其进行了测试 ps：$emails 来自“POST Form”，但我对其进行了编辑以将其放在这里，没有 HTML 代码，我猜是拆分中的错误，所以请帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:12:44.230

您应该使用`explode`而不是，`split`您还需要修剪空格，`trim`您可以使用它`filter_var`来验证您的电子邮件

```
$emails = explode("\n", $emails);
foreach ( $emails as $email ) {
    $email = trim($email);
    filter_var($email, FILTER_VALIDATE_EMAIL) and print($email . "\n");
} 
```

[观看现场演示](http://eval.in/13952)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:12:25.160

我将它复制到 usbwebserver 以进行测试。

第一个错误出现在第 28 行，您没有关闭 if 语句。

```
if(is_email($split_emails[$x]){ 
```

应该

```
if(is_email($split_emails[$x])){ 
```

除此之外，我不能去，因为拆分语句已被弃用

*请参阅 baba 的示例以获得更好的电子邮件验证*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:14:31.267

1.  使用`explode()`而不是`split`.

2.  Testing email using regex is discouraged as PHP provides `filter_var()`.

* * *

```
$split_emails = explode( "\n",$emails );
foreach( $split_emails as $mail )
  echo filter_var( $mail, FILTER_VALIDATE_EMAIL ); 
```

# javascript - 将 CKEditor 重新聚焦在正确的光标位置

> ID：15718880
> 
> 赞同：2
> 
> 时间：2013-03-30T13:08:12.767
> 
> 标签：javascript, jquery, content-management-system, editor, ckeditor

我正在构建一个 CMS 系统，我在其中使用 jQuery 和 CKEditor 在线编辑内容。当编辑器模糊时，要求用户确认他/她想要丢弃编辑。如果选择“否”，则应取消模糊事件，并且编辑器保持焦点而不更改光标位置。因为在我看来这是不可能的，所以我尝试在模糊完成后重新调整编辑器的焦点。以下代码片段来自 blur 事件处理程序：

```
var $this = $(this);
if (confirm('Discard your changes?')) {
    $this.html($this.data('previous'));
} else {
    // Optimally prevent the blur event, but alternatively
    // reintroduce focus at correct position...
    $this.data('editor').focus();
} 
```

请注意，`focus`调用是在 中包含的编辑器实例上完成的`$this.data('editor')`，但结果似乎与我直接在`$this`.

这个解决方案的问题在于，虽然它重新引入了焦点，但光标现在位于文本的开头，这对最终用户来说非常不直观和烦人，他们认为没有任何改变。另一方面，仅仅放弃焦点不是一种选择，因为我不希望用户能够阻止重置内容然后继续进行其他更改，认为这些更改是持久的。

因此，我想要一个解决方案，我可以完全防止模糊，或者将光标重新引入它的最后一个位置。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-30T15:13:01.977

本机解决方案（通过`window.getSelection()...`）是不安全的，因为浏览器以不同的方式或/和错误实现此 API。问题是选择系统、范围和内容可编辑（通常）的“标准”非常差、模糊和被忽视。CKEditor 绕过了这些问题（许多 kLOC），并通过其自己的 API 保持了可移植性和可预测性。

So don't reinvent the wheel and go ahead with this code (tested in latest Chrome and IE10):

```
var editor = CKEDITOR.instances.editor1;

editor.on( 'blur', function() {
    console.log( 'Editor blurred.' );

    var range = editor.getSelection().getRanges()[ 0 ]; // store the selection

    if ( confirm( 'Discard your changes?' ) ) {
        console.log( 'Changes discarded.' );
    } else {
        editor.focus(); // focus the instance again
        range.select(); // restore previous selection
    }   
} ); 
```

If you mix this code with cached data check (`editor.getData()`), you can easily avoid `confirm()` when nothing has really changed:

```
var editor = CKEDITOR.instances.editor1, cached;

editor.on( 'blur', function() {
    console.log( 'Editor blurred.' );
    var range = editor.getSelection().getRanges()[ 0 ]

    if ( editor.getData() != cached && confirm( 'Discard your changes?' ) ) {
        console.log( 'Changes discarded.' );
    } else {
        editor.once( 'focus', function( event ) { 
           event.cancel();  // cancel the *very next* event, nothing will be cached
        }, null, null, 0 );

        editor.focus();
        range.select();
    }   
} );

editor.on( 'focus', function() {
    console.log( 'Cached editor contents.' );
    cached = editor.getData();
} ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:12:59.900

我不确定它是否适用于 CKEditor，但例如使用 textarea，您可以使用以下方法获取当前光标位置：

var cursor = window.getSelection().getRangeAt(0).startOffset;

在这个问题中有一个 jQuery 函数：[Cursor position in a textarea (character index, not x/y coordinates)](https://stackoverflow.com/questions/1891444/how-can-i-get-cursor-position-in-a-textarea)

将光标设置在正确的位置与选择文本的特定部分相同，更多信息在这里：[使用 JavaScript 突出显示文本范围](https://stackoverflow.com/questions/6240139/highlight-text-range-using-javascript)

我想这需要一点思考，因为 CKEditor 很可能会取代 textarea。

# python - 我的 python 代码有问题：从文件加载不能作为函数工作，必须在游戏循环中。为什么？

> ID：15718887
> 
> 赞同：0
> 
> 时间：2013-03-30T13:08:47.297
> 
> 标签：python, function, readline

我正在用 python 编写一个简单的基于文本的冒险游戏。我将包含所有代码，因为我不知道问题出在哪里（它不会太长而且很简单）。

为了保存，我正在将“currentRoom”的名称和“you.inventory”中的每个项目写入一个文本文件。然后，当我加载时，我使用“readline()”来检索该数据并重置变量。我有一个“游戏循环”，我可以在其中获取下一个命令并执行与该命令匹配的任何功能。当我为“加载”编写以下代码时，它无法正常工作。为了测试保存/加载，我开始游戏拿起一些物品然后向北进入一个不是起始房间的位置，然后保存。然后我退出，再次运行游戏，当然输入相同的名称，然后给出命令'load'。注意，保存的文件是正确的。我什至在打印 currentRoom.name 的加载函数中包含了一个打印语句，它是正确的，但是当我调用look函数并且它执行完全相同的'print currentRoom.name'时，我已经被移回了起始房间！？有趣的是，库存加载正常，只是位置错误。我这辈子都想不通。

为了解决这个问题，我不得不将 load() 函数移动到游戏循环体中，在 'elif com == "load"... 下，而不是将其作为函数调用，然后它就可以工作了！？我怀疑我在全局变量和局部变量方面做错了什么，但我看不出是什么。

这是代码：（抱歉缩进错误，剪切和粘贴效果不佳）

```
class Character(object):
inventory = []
hitPoints = 20
def __init__(self, name):
    self.name=name

class Room(object):
  def __init__(self, name, exits):
    self.name=name
    self.exits=exits
    self.contents=[]

class Item(object):
  def __init__(self, name, itemType, keyWords):
    self.name = name
    self.itemType = itemType
    self.keyWords = keyWords
def __repr__(self):
    return self.name
#Item types: weapon1 (one handed), weapon 2 (2handed), head, body, hands, feet, arms,     legs, ring, necklace
#****************** I T E M S *************************

sword1 = Item("A short sword", "weapon1", ["sword1","sword","shortsword"])
sword1.roomDescription = "A short sword made of steel lies here."
sword1.description = "It is a small sword of average quality, made of steel."

helmet1 = Item("A metal helmet", "head", ["helmet1", "helmet", "metal"])
helmet1.roomDescription = "A simple metal helmet sits on the ground."
helmet1.description = "It's a simple helmet with a few dings and dents, but otherwise     good condition."

coat1 = Item("A leather coat", "body", ["coat1", "coat", "leather"])
coat1.roomDescription = "A rugged leather coat lies crumpled at your feet."
coat1.description = "It's a thick leather coat.  It looks like it might offer some protection."

ring1 = Item("A brass ring", "ring", ["ring1", "ring", "brass"])
ring1.roomDescription = "A small brass ring is here."
ring1.description = "It's a simple brass ring.  Not very exciting."

necklace1 = Item("A silver necklace", "necklace", ["necklace1", "necklace", "brass"])
necklace1.roomDescription = "A thin silver necklace has been cast aside."
necklace1.description = "It's a shiny silver necklace."

#****************** PEOPLE AND NPC's *************************

you = Character("Monty")

#****************** R O O M S *************************

r0 = Room("Purgatory", [])

r1 = Room("Home",["north"])
r1.description = "You are in your home.  It's a small room.  There is a door in the north wall."
r1.contents = [sword1, sword1, ring1, necklace1, coat1]
r1.id = "r1"

r2 = Room("Main Street", ["south"])
r2.description = "You are north of your home in Main street.  The only exit is south."
r2.contents = [helmet1, coat1, sword1, sword1, coat1, coat1, coat1, coat1, coat1, coat1,  coat1, coat1, coat1, coat1, coat1]
r2.id = "r2"

#****************** E X I T S *************************

r1.n = r2
r2.s = r1

#****************** V A R I A B L E S *************************

nextRoom=0
nextMove="z"
quitVar=0
currentRoom = r1

#****************** F U N C T I O N S *************************

def printExits():
  print currentRoom.exits
  return

def look():
  print currentRoom.name
  print currentRoom.description
  if currentRoom.contents != []:
    for i in currentRoom.contents:
        print "- "+i.roomDescription

def save():
f = open(you.name+"saved.txt","w")
f.write(currentRoom.id+"\n")
for i in you.inventory:
    f.write(i.keyWords[0]+"\n")
f.write("*end*")
f.close()
print "Saved!"

def load():
f = open(you.name+"saved.txt","r")
currentRoom=eval(f.readline())
tempItem="none"
while tempItem != "*end*":
    tempItem = f.readline()
    if tempItem != "*end*":
        inventoryItem=eval(tempItem)
        you.inventory.append(inventoryItem)
f.close()
print "Loaded!"
print"****",
print currentRoom.name
look()

def printInventory():
print "You are carrying:"
if you.inventory ==[]:
    print "Nothing!"
    return
for i in you.inventory:
    print i

def getItem(itemKeyword0, typed_string): #itemKeyword0 is first keyWord (same as variable name for object) in first item in room that matches typed input
                                                   #typed_string is exactly what the user types following 'get '
if len(you.inventory)>=15:
    print "You can't carry any more!"
    return
currentRoom.contents.remove(eval(itemKeyword0)) #remove picked up item from room
you.inventory.append(eval(itemKeyword0))  #add picked up item to inventory
print 'You get the %s.' % (typed_string)

def dropItem(itemKeyword0, typed_string): #itemKeyword0 is first keyWord in first item in inventory that matches typed string
you.inventory.remove(eval(itemKeyword0)) #remove object from inventory that matches keyword0
currentRoom.contents.append(eval(itemKeyword0)) #add object to room that matches keyword0
print 'You drop the %s.' % (typed_string)
you.name = (raw_input("What is your name?")).lower()

look()
while quitVar < 1:
  com = (raw_input(">>")).lower() #get next command in lower case
  nextMove="z" #reset nextMove
  print ""
  if com == "help":
    print"north(n), south(s), east(e), west(w), quit, help, look(l), exits,   inventory(i), get, drop"
elif com == "load":
    load()
elif com == "quit":
    quitVar += 10
elif com == "exits":
    printExits()
elif com == "look" or com == "l":
    look()
elif com == "get all":
    itemGotCounter = 0 #needed counter to make it not say 'There's nothing here!' after getting all
    while len(currentRoom.contents)>0 and len(you.inventory)<15: #for some reason the following for i excluded the last item in the room.
        for i in currentRoom.contents:
            getItem(i.keyWords[0],i.keyWords[1])
            itemGotCounter = 1
    else:
        if len(currentRoom.contents)==0 and itemGotCounter == 0:
            print "There's nothing here!"
        if len(you.inventory) >= 15:
            print "You can't carry any more!"       
elif com[0:4] == "get " and com != "get all":
    gottenItem = com[4:] #set equal to string user typed
    for i in currentRoom.contents: #loop through room items, setting equal to i
        if gottenItem in i.keyWords: #if typed string matches with i.keywords
            getItem(i.keyWords[0], gottenItem) #send first keyword of item to getItem function, and send typed string
            break
    else:
        print "You do not see that here!"
elif com == "drop all":
    while len(you.inventory)>0:
        for i in you.inventory:
            dropItem(i.keyWords[0], i.keyWords[1])
elif com[0:5] == "drop " and com != "drop all":
    droppedItem = com[5:] #equal to string user typed
    if you.inventory == []: #check if user is carrying anything to drop
        print "You aren't carrying anything!"
    for i in you.inventory: #cycle through users inventory
        if droppedItem in i.keyWords: #if typed string matches keywords in users inventory
            dropItem(i.keyWords[0], droppedItem) #send first keyWord of that inventory item to dropItem function, and typed string
            break
    else:
        print "You don't have one!"
elif com == "inventory" or com == "i":
    printInventory()
elif com == "n" or com == "north":
    if "north" in currentRoom.exits:
        nextMove="n"
        nextRoom=currentRoom.n
    else:
        print "You can't go that way!"
elif com == "s" or com == "south":
    if "south" in currentRoom.exits:
        nextMove="s"
        nextRoom=currentRoom.s
    else:
        print "You can't go that way!"
elif com == "e" or com == "east":
    if "east" in currentRoom.exits:
        nextMove="e"
        nextRoom=currentRoom.e
    else:
        print "You can't go that way!"
elif com == "w" or com == "west":
    if "west" in currentRoom.exits:
        nextMove="w"
        nextRoom=currentRoom.w
    else:
        print "You can't go that way!"
elif com == "":
    pass
elif com == "save":
    save()

else:
    print "Huh?"
print "****"
print nextMove
print currentRoom.name
print "****"

if nextMove !="z": #If a move has occurred, move to nextRoom and look
    currentRoom = nextRoom
    look()

print "See ya later, alligator!", 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T15:25:57.793

范围！

```
def update ():
    a=2
    print (a)

a=1
update ()
print (a)
# prints 2 then 1 
```

然而

```
def update ():
    global a
    a=2
    print (a)

a=1
update ()
print (a)
# prints 2 then 2 
```

# boolean - 处理代码不起作用

> ID：15718889
> 
> 赞同：0
> 
> 时间：2013-03-30T13:08:54.847
> 
> 标签：boolean, processing, collision, rectangles

我今天开始用 Processing 编程并写了一个小程序来创建 10 个随机矩形现在我想让它们在鼠标悬停时消失，但我的实际代码不起作用

我会欣赏一些小费...

```

`import java.awt.Rectangle;

Rectangle rect[] = new Rectangle[10];
int xpos[] = new int[10];
int ypos[] = new int[10];
int size = 25;
boolean visible[] = new boolean[10];

void setup()
  {

    size(640,480);
    frameRate(60);
    smooth();
    background(0);
    stroke(255); 
    fill(255);
    textAlign(CENTER);
    textSize(200);
    text("Catch", width/2, 280);
    textSize(100);
    text("them", width/2, 380);

// 10 Random positions for the rectangles  
    for (int i=0; i < 10; i++) {
         xpos[i] =  int(random (615));
         ypos[i] =  int(random (455));
         visible[i] = true;

    }
     for (int i=0; i < 10; i++) {
         rect[i] = new Rectangle(xpos[i],ypos[i],size,size);

  }        
}

  void draw()
  {    
      for (int i=0; i < 10; i++) {

        if (visible[i] == true){
           fill(255,0,0);
           rect(rect[i].x,rect[i].y,rect[i].width,rect[i].height);}

        else if (rect[i].contains(mouseX,mouseY)){
             visible[i] = false; }

      }}` 

            回答 #1

赞同：0

时间：2013-03-30T18:53:49.903

为什么`else if`？它的编写方式，它只会检查鼠标是否在 rect if`visible[i] == false`上。它们都是可见的，因此它永远不会被执行。

同样要查看效果，您必须`background(0);`在 draw 方法的顶部调用。否则，您永远不会清除屏幕以查看结果。

您还应该考虑清理缩进和大括号 {} 以确保您以一致的方式格式化代码。这将使它更容易阅读。

```

# python - Django：在同一个表中使用条件引用聚合编写查询

> ID：15718893
> 
> 赞同：1
> 
> 时间：2013-03-30T13:09:32.727
> 
> 标签：python, sql, django

我有一个类似的表：

```
id  name   added     count  flag
---------------------------------
01  abcd1  09.02.13    4    false
02  abcd1  10.02.13    1    true  
03  abcd1  11.02.13    3    false
04  abcd1  12.02.13    4    false 
```

我需要在以下条件下找到给定名称的计数总和：

*   对于给定的名称
*   标志应该是假的
*   应在该名称的最后一个 flag=true 条目之后添加条目

在这种情况下，我想要条目 03 和 04 的计数总和。

我应该如何在 Django 中做到这一点？

**编辑**：
我正在寻找创建这样的查询：

```
SELECT id from sample
WHERE 
  name = 'abcd1' AND
  added > (SELECT MAX(added) FROM sample WHERE name = 'abcd1' AND flag = TRUE) 
```

**编辑**：另外，如果没有带有 flag=true 的条目，那么我需要该名称的所有条目。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T00:17:37.803

怎么样

```
select name, sum(count) as count
from T as t
where flag = 'false'
and exists (
    select 1
from T
where name = t.name
and flag = 'true'
group by name, flag
having max(added) < t.added
)
group by name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T00:36:22.117

如果您使用一点子查询，这相当简单：

```
select
    name,
    sum(count)
from sample s
where flag = false
and (added > (select max(added)
    from sample
    where name = 'abcd1'
    and flag = true)
    OR
    not exists (
        select *
        from sample
        where name = 'abcd1'
        and flag = true)
    )
and name = 'abcd1' 
```

`OR not exists`请注意，当没有带有 . 的条目时，使用该子句来处理这种情况`flag=true`。

# php - 从 Youtube 电影中隐藏框架、进度条和按钮

> ID：15718894
> 
> 赞同：4
> 
> 时间：2013-03-30T13:09:36.070
> 
> 标签：php, jquery, html, youtube

在一个页面上，我正在灯箱中播放一部 Youtube 电影。

然后我只想显示原始视频电影 - 没有控件、播放/暂停按钮、全屏选项、进度条等。现在它看起来像这样：

![优酷示例](../Images/8b68fe12663f066279bc0a11ec107de7.png)

我只需要删除带有图标的顶部和底部闪光条。我知道电影放映时它会滑落，但我希望始终将它们隐藏起来。

这可以从电影中隐藏吗？

**更新**

从下面@Sven 的答案中，我添加`controls=0&showinfo=0&rel=0`到 URL 中`iframe`并得到以下信息：

![优酷示例 2](../Images/99d09ef7aa83cbb63ef1687d9d573594.png)

这可以很好地达到目的。似乎在右下角可以看到一个 Youtube 徽标，而不是在删除其他内容时。此徽标仅在悬停时显示。

有什么想法可以隐藏最后一点吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-30T13:13:33.383

根据您插入视频的方式，有几个配置选项。 [https://developers.google.com/youtube/player_parameters](https://developers.google.com/youtube/player_parameters)

如果您直接将链接作为 iframe 插入，则大多数选项都用作`GET`参数。在您的情况下，添加`controls=0&showinfo=0`到视频网址。

# android - 在 onClick() 方法中创建文件

> ID：15718901
> 
> 赞同：0
> 
> 时间：2013-03-30T13:10:11.573
> 
> 标签：android, file

我有一个按钮，我想在 onClick 方法中创建一个文件，但我总是得到一个`FileNotFoundException`. 写入内部存储的权限已经在 manifest.xml 中

这是代码：

```
registerButton.setOnClickListener(new OnClickListener() 
    {
        @Override
        public void onClick(View v) 
        {
            try 
            {
                bufferedWriter = new BufferedWriter(new FileWriter("sample.txt"));
                bufferedWriter.write(getString(R.string.emailString));
                bufferedWriter.newLine();
                bufferedWriter.write(getString(R.string.passwordString));
                System.out.println("Done!");
            } 
            catch (IOException e) 
            {
                e.printStackTrace();
                Log.d("MainActivity", "Bad luck!");
            }
            finally
            {
                try
                {
                    if(bufferedWriter != null)
                        bufferedWriter.close();
                }
                catch (IOException e) 
                {
                    e.printStackTrace();
                    Log.d("MainActivity", "Sorry for that!");
                }
            }
        }
    }); 
```

以下是错误日志

```
03-28 01:00:11.537: W/System.err(2610): java.io.FileNotFoundException: /sample.txt: open failed: EROFS (Read-only file system)
03-28 01:00:11.557: W/System.err(2610): at libcore.io.IoBridge.open(IoBridge.java:406)
03-28 01:00:11.557: W/System.err(2610): at java.io.FileOutputStream.<init>(FileOutputStream.java:88)
03-28 01:00:11.567: W/System.err(2610): at java.io.FileOutputStream.<init>(FileOutputStream.java:73)
03-28 01:00:11.588: W/System.err(2610): at java.io.FileWriter.<init>(FileWriter.java:80)
03-28 01:00:11.588: W/System.err(2610): at
org.eirich.way.MainActivity$1.onClick(MainActivity.java:34)
03-28 01:00:11.607: W/System.err(2610): at android.view.View.performClick(View.java:3480)
03-28 01:00:11.607: W/System.err(2610): at android.view.View$PerformClick.run(View.java:13983)
03-28 01:00:11.628: W/System.err(2610): at android.os.Handler.handleCallback(Handler.java:605)
03-28 01:00:11.628: W/System.err(2610): at android.os.Handler.dispatchMessage(Handler.java:92)
03-28 01:00:11.647: W/System.err(2610): at android.os.Looper.loop(Looper.java:137)
03-28 01:00:11.667: W/System.err(2610): at android.app.ActivityThread.main(ActivityThread.java:4340)
03-28 01:00:11.667: W/System.err(2610): at java.lang.reflect.Method.invokeNative(Native Method)
03-28 01:00:11.687: W/System.err(2610): at java.lang.reflect.Method.invoke(Method.java:511)
03-28 01:00:11.687: W/System.err(2610): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T13:18:26.807

在内部存储中创建文件为：

```
bufferedWriter = new BufferedWriter(new FileWriter(new 
                            File(getFilesDir()+"/sample.txt"))); 
```

因为目前您没有使用 file.use [getFilesDir()](http://developer.android.com/reference/android/content/ContextWrapper.html#getFilesDir%28%29)传递目录路径，它返回文件系统上目录的绝对路径

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:19:28.167

这是因为您没有将目录路径传递给`FileWriter`.

采用：

```
bufferedWriter = new BufferedWriter(new FileWriter(newFile(getFilesDir()+File.separator+"sample.txt"))); 
```

反而：

```
bufferedWriter = new BufferedWriter(new FileWriter("sample.txt")); 
```

甚至检查下面的链接，它可以帮助你。

[向/从 Android 手机的内部存储器写入/读取文件](https://stackoverflow.com/a/9306962/646806)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:21:25.827

您可以使用以下功能写入*内部存储*[`openFileOutput`](http://developer.android.com/reference/android/content/Context.html#openFileOutput%28java.lang.String,%20int%29)：

```
String string = "My data";

FileOutputStream os = openFileOutput("sample.txt", Context.MODE_PRIVATE);
os.write(string.getBytes());
os.close(); 
```

And make sure you have the [following permission](http://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE) :

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

# c++ - MinGW 和 std::thread

> ID：15718904
> 
> 赞同：11
> 
> 时间：2013-03-30T13:10:28.807
> 
> 标签：c++, windows, c++11, mingw, stdthread

所以我一直在尝试使用 MinGW 编译器让以下代码在 Windows 上编译和运行。

```
#include <iostream>
#include <thread>

void test()
{
    std::cout << "test" << std::endl;
}

int main()
{
    std::thread t(test);
} 
```

我正在使用以下命令进行编译：

```
g++ -std=c++11 test.cpp -o test.exe 
```

现在的问题是应该使用的 MinGW 版本，我已经尝试了所有我知道的版本。

1.  MinGW 构建：[thread-win32](http://sourceforge.net/projects/mingwbuilds/files/host-windows/releases/4.8.0/32-bit/threads-win32/sjlj/)
2.  MinGW 构建：[thread-posix](http://sourceforge.net/projects/mingwbuilds/files/host-windows/releases/4.8.0/32-bit/threads-posix/sjlj/)
3.  MinGW-w64：[stdthread 实验性 rubenvb](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/gcc-4.8-experimental-stdthread/)
4.  MinGW-w64：[标准线程实验 rubenvb 4.7](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/gcc-dw2-4.7-experimental-stdthread/)

数字 1 不起作用，因为 GCC[显然只在](http://www.cplusplus.com/forum/general/76836/#msg412938)内部支持 pthread 的东西。

编号 2 确实编译并且它基本上甚至输出`test`（参见输出的最后一行），但它也因错误而崩溃：

```
terminate called without an active exception

This application has requested the Runtime to terminate it in an unusual way.
Please contact the application's support team for more information.
test 
```

3 号和 4 号再次编译，但它们不输出`test`，而是立即崩溃，但输出更具描述性：

```
terminate called after throwing an instance of 'std::system_error'
  what():  Enable multithreading to use std::thread: Operation not permitted

This application has requested the Runtime to terminate it in an unusual way.
Please contact the application's support team for more information. 
```

谷歌当然把我带到了[GCC bug tracker](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=52681)和其他一些建议使用的帖子，`-pthread`这根本没有帮助。

我也尝试过手动链接`winpthread`and `pthread`，但这也无济于事。

`-std=c++11`和之间也没有区别`-std=gnu++11`...

我现在真的很迷茫，不知道是否有可能获得支持 的 MinGW 版本，`std::thread`但也许我只是忽略了一些编译器标志。我希望有人可以帮助我！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-30T13:23:20.213

你忘了加入你的线程：

```
t.join(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-11T11:34:47.570

FYI, there is already a native win32 implementation of std::thread and sync primitives. It is a header-only library and works on any C++11 compliant version of MinGW. [https://github.com/meganz/mingw-std-threads](https://github.com/meganz/mingw-std-threads)

# sql-server - 如何拆分 ntext 数据类型数据以存储在数据库中

> ID：15718906
> 
> 赞同：0
> 
> 时间：2013-03-30T13:10:42.813
> 
> 标签：sql-server, vb.net

我有一个`ntext`名为的列`Emp_details_list`，它包含类似的数据

```
 emp1#@#emp2#@#emp3... 
```

最多它有 20,000 个字符作为字符串，我存储在该列中，我需要将其拆分并保存在其他表`EmpDet`和其他列（`Single_Emp_det`）中但是在拆分时我不能`ntext`像`nvarchar`使用局部变量并声明as `nvarchar(max)`和拆分，但我只能存储 8000 个字符，只有当我有 8001 个字符时它显示异常，因为它无法存储所以我如何`ntext`使用 SQL Server 中的拆分概念将整个数据存储在其他列中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T08:54:47.833

正如其他人已经提到的那样，您可以轻松地将 20000 个字符存储在 nvarchar(max) 中。转换这些类型时，您可能做错了什么。

这是一个从 nvarchar(max) 转换为 nvarchar(max) 的示例，它清楚地显示了如何在其中存储 20000 个字符。

```
DECLARE @v1 nvarchar(max)

DECLARE @v2 nvarchar(max)

create table #textExample

(

    id int,

    t1 ntext

)

declare @count int

set @v1 = ''

SET @count = 0

while @count < 20000

begin  

   set @v1 = @v1 + '1'

   set @count = @count + 1

end

--converting nvarchar(max) to ntext

insert into #textExample

values (1, CONVERT(ntext,@v1))

select * from #textExample

-- converting ntext back to nvarchar(max)

SET @v2 = CONVERT(nvarchar(max), (select t1 from #textExample where id = 1))

select @v2, LEN(@v2)

drop table #textExample 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-31T02:23:45.927

所以你可能被 Sql server 2000 卡住了。如果你不能使用 nvarchar(max)，一种可能的方法是使用 substring 函数并在循环中将你的 ntext 复制到可管理的 varchar(8000) 块中。在每次迭代中，保存“最后一个 # 之后的部分块”，以在下一次迭代中使用。所以你基本上循环你的表，在那个循环中再次循环 ntext 字段值，以 8k 为单位，然后做剩下的事情。希望它足够清楚。

# android - 如何为 Android 项目创建 build.xml？

> ID：15718907
> 
> 赞同：26
> 
> 时间：2013-03-30T13:10:54.297
> 
> 标签：android, ant, android-build

我一直在尝试运行直接从“Beginning Android 4”一书的源代码下载中获得的简单程序。但是，我对 build.xml 文件有很多问题（请参阅前面的问题，这些问题没有得到解答）。我最新的是，它来自一个简单的标签演示程序：

```
# ant debug
Buildfile: /home/me/src/ANDROID/MyProjects/Label/build.xml

BUILD FAILED
Target "debug" does not exist in the project "LabelDemo". 
```

然后我检查了其他工作的 build.xml 文件，据我所知，通过文件的文本进行搜索，那里也不存在“调试”。但他们工作。

所以，我显然必须错误地创建 build.xml 文件。为 Android 项目创建构建文件的正确方法是什么（从命令行）。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-03-30T13:13:34.807

Run **`android update project -p ...`**，其中`...`是项目的路径。这将创建或更新`build.xml`相关的命令行构建文件。这假设您的 SDK`tools/`目录位于您的`PATH`; 否则，您将需要完全限定**`android`**命令的路径。

# python - 在 R 和 pandas 中保持秩序的同时合并

> ID：15718908
> 
> 赞同：1
> 
> 时间：2013-03-30T13:10:56.863
> 
> 标签：python, r, dataframe, pandas

我使用这个（有点笨拙的）R 函数来合并 data.frames 并保持其中一个的顺序：

```
MergeMaintainingOrder = function(Ordered,Unordered,ByWhatColumn){
  Ordered$TEMPINDEX = 1:length(Ordered[,1])
  MergedData = merge(Ordered,Unordered,by=ByWhatColumn)
  MergedData = MergedData[order(MergedData$TEMPINDEX),]
  MergedData$TEMPINDEX = NULL
  return(MergedData)
} 
```

我怎样才能在熊猫中完成同样的事情？有没有一种不那么笨拙的方法，还是我应该重写相同的函数？

谢谢，

-N

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:39:23.243

*在 pandas 中，合并会重置索引，但您可以通过在合并之前*重置索引来轻松解决此问题。重置索引将创建一个名为“索引”的新列，然后您可以在合并后使用该列重新创建索引。例如：

```
Ordered.reset_index().merge(Ordered, Unordered, on=ByWhatColumn).set_index('index') 
```

有关更多讨论，请参阅此[问题/答案](https://stackoverflow.com/questions/11976503/how-to-keep-index-when-using-pandas-merge)（@WouterOvermeire 的帽子提示）

# java - 春季 MVC 3.2.1 中未出现 Json 响应

> ID：15718913
> 
> 赞同：0
> 
> 时间：2013-03-30T13:11:18.807
> 
> 标签：java, spring, spring-mvc

我正在使用 soring MVC 3.2.1。我正在使用一个应该返回 json 的控制器，我也包含了 jackson jars。但是没有返回 json。它给出错误**此请求标识的资源只能生成具有特征的响应根据请求“接受”标头（）不可接受。**

```
@RequestMapping(value = "/search.json", method = RequestMethod.POST, produces = "application/json;charset=UTF-8")
    protected @ResponseBody
    LoginDto searchDeals(@ModelAttribute Deal deal) {
        /*
         * DealDao dealdao = new DealDao(); List<Deal> deals =
         * dealdao.search(deal);
         */
        return new LoginDto("sdadas", "asdasdas");
    } 
```

配置

```
<!--
    <bean name="/UploadEmployeeServlet.do"
    class="com.etnow.UploadEmployeeServlet" />
-->
<context:component-scan base-package="com.etnow.*" />
<mvc:annotation-driven
    content-negotiation-manager="contentNegotiationManager" />
<bean id="contentNegotiationManager"
    class="org.springframework.web.accept.ContentNegotiationManagerFactoryBean">
    <property name="favorPathExtension" value="false" />
    <property name="favorParameter" value="false" />
    <property name="ignoreAcceptHeader" value="false" />
    <property name="mediaTypes">
        <value>
            json=application/json
        </value><!--
    -->
    </property>
</bean>

<mvc:view-controller path="/one.do" view-name="SignUp" />
<bean id="viewResolver"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/WEB-INF/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean> 
```

请帮助它在 3.0 中可以正常工作而无需设置 contentNogotiation Manager 但不能在最新版本的 spring MVC 中

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:39:29.423

听起来您需要在发出 http 请求时在标头中发送“Accept= application/json”。

您还可以通过创建 ObjectMapper 对象并检查返回类型上的 canSerialize(class) 来检查您是否可以获得 json 以及您的 jar 是否已正确安装。

你如何发布数据？

删除 "produces = "application/json;charset=UTF-8" " 也可以解决问题，但如果您想包含该行，则需要在 http 请求中包含接受标头。

# neo4j - neo4jclient where clause not putting in parameters

> ID：15718916
> 
> 赞同：0
> 
> 时间：2013-03-30T13:11:56.563
> 
> 标签：neo4j, cypher, neo4jclient

I'm having an issue with the Where clause not pulling out the values and putting them as parameters.

```
return 
   startingNode
   .StartCypher("startNode")
   .Match(matchQuery)
   .Where<TSourceNode>(otherStartNodes => otherStartNodes.Id != startingNode.Data.Id)                
   .Return<TSourceNode>("otherStartNodes").Results; 
```

The Query string comes out looking like "WHERE (Id <> Id)". I can fix the problem easily by not using lambdas and just using the code below but I'm interested to see why it didn't work

```
.Where("startNode.Id <> otherStartNodes.Id") 
```

I've also tried the below line but that didn't work either.

```
.Where<TSourceNode, TSourceNode>((otherStartNodes, startNode) => otherStartNodes.Id != startNode.Id) 
```

**Edit** Tatham - I've created an issue in Bitbucket for this.

You are correct the right way for the Where clause should be.

```
.Where<TSourceNode, TSourceNode>((otherStartNodes, startNode) => otherStartNodes.Id != startNode.Id)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T04:23:06.083

**Update: This is [issue 73](https://bitbucket.org/Readify/neo4jclient/issue/73/where-clause-not-building-correctly-with), fixed in 1.0.0.525 and above.**

From what I understand of your rather dynamic query, the third option you mentioned (`.Where<TSourceNode, TSourceNode>((otherStartNodes, startNode) => otherStartNodes.Id != startNode.Id)`) is the correct one.

This should work. I even added more unit tests in Neo4jClient to assert that it does: [https://bitbucket.org/Readify/neo4jclient/commits/cc73ce253ddce89e69785caa68f5e4660a622b96](https://bitbucket.org/Readify/neo4jclient/commits/cc73ce253ddce89e69785caa68f5e4660a622b96)

Can you explain why you think it didn't work? What was the resulting query text?

* * *

The value you're getting for `.Where<TSourceNode>(otherStartNodes => otherStartNodes.Id != startingNode.Data.Id)` is wrong. It should evaluate `startingNode.Data.Id` once in .NET, then send something like `WHERE otherStartNodes.Id <> {p1}` over the wire. I'll test this separately.

# java - Parsing String with JSONTokener to JSONObject OR JSONArray

> ID：15718919
> 
> 赞同：1
> 
> 时间：2013-03-30T13:12:09.803
> 
> 标签：java, json, parsing, rest

I'm using the following code to handle REST responses from my server:

```
if (response.getEntity() != null) {
        BufferedReader reader = new BufferedReader(new InputStreamReader(response.getEntity().getContent(), "UTF-8"));
        StringBuilder builder = new StringBuilder();
        for (String line = null; (line = reader.readLine()) != null;) {
            builder.append(line).append("\n");
        }           
        JSONTokener tokener = new JSONTokener(builder.toString());
        try {
            rr.jsonObject = new JSONObject(tokener);                
        } catch (JSONException e) {             
            e.printStackTrace();

            Log.d("parsing", "creating json array");
            try {
                rr.jsonArray = new JSONArray(tokener);
            } catch (JSONException e1) {                    
                e1.printStackTrace();
            }

        }
    } 
```

If the response is an JSONObject, it works perfectly but if the server returns a JSONArray, the second try block also throws although it's correct json.

```
03-30 14:09:15.069: W/System.err(6713): org.json.JSONException: End of input at character 314 of [{"__className":"stdClass","char3code":"DEU","fips_name":"Germany","alternate_names":"Germany, Deutschland, Allemagne, Alemania"},{"__className":"stdClass","char3code":"USA","fips_name":"United States","alternate_names":"United States of America, Vereinigte Staaten von Amerika, \u00c9tats-Unis, Estados Unidos"}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:38:46.140

I expect the reason that this is failing is that when you call `new JSONArray(tokener)` the `tokener` is no longer positioned at the start of the token stream. Try creating a new `JSONTokener` instance for the 2nd attempt at parsing..

# python - 为列表或字典中的每个项目添加年份

> ID：15718922
> 
> 赞同：1
> 
> 时间：2013-03-30T13:12:26.660
> 
> 标签：python, dictionary, count, add

这个问题可能微不足道。如何添加从 1903 开始​​到 2009 到列表中的 106 个项目的年份，而不创建一个长长的**年份**列表 **但是**用年份绕过那些？

例如：

```
 States : Boston Americans, World Series Not Played in 1904, New York,  
           Chicago, Chicago, Chicago
           Pittsburgh, Philadelphia, Philadelphia,
           Boston, Philadelphia, Boston, Boston,Boston]` 
```

对此：

```
 States : [Boston Americans:1903], [World Series Not Played:1904], [New York:1905],  
           [Chicago:1906],[Chicago:1907:],[Chicago:1908]....ect 
```

虽然我知道您可以为列表中的每个项目添加一个数字计数

```
 d = defaultdict(int)
 for word in words.split():
     d[word] += 1 
```

我试过：

```
 d = {}
 for i in new_list:
     d[1903 + i] += 1 # I know this looks crazy but this is all I have
     print(d) 
```

我明白了

`TypeError: 'function' object is not iterable`

但这对我来说是新的。我通常会展示更多内容，但我真的不知道如何编写代码。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T13:27:40.530

如果您有获奖者名单，例如：

```
>>> winners
['Boston Americans', 'World Series Not Played in 1904', 'New York', 'Chicago', 'Chicago', 'Chicago', 'Pittsburgh', 'Philadelphia', 'Philadelphia', 'Boston', 'Philadelphia', 'Boston', 'Boston', 'Boston'] 
```

您可以使用`enumerate`这些与数字相关联：

```
>>> list(enumerate(winners, 1903))
[(1903, 'Boston Americans'), (1904, 'World Series Not Played in 1904'), (1905, 'New York'), (1906, 'Chicago'), (1907, 'Chicago'), (1908, 'Chicago'), (1909, 'Pittsburgh'), (1910, 'Philadelphia'), (1911, 'Philadelphia'), (1912, 'Boston'), (1913, 'Philadelphia'), (1914, 'Boston'), (1915, 'Boston'), (1916, 'Boston')] 
```

从这里你可以制作一个字典，或者一个字符串列表，或者其他任何东西：

```
>>> dict(enumerate(winners, 1903))
{1903: 'Boston Americans', 1904: 'World Series Not Played in 1904', 1905: 'New York', 1906: 'Chicago', 1907: 'Chicago', 1908: 'Chicago', 1909: 'Pittsburgh', 1910: 'Philadelphia', 1911: 'Philadelphia', 1912: 'Boston', 1913: 'Philadelphia', 1914: 'Boston', 1915: 'Boston', 1916: 'Boston'}
>>> ['{}:{}'.format(winner, year) for year, winner in enumerate(winners, 1903)]
['Boston Americans:1903', 'World Series Not Played in 1904:1904', 'New York:1905', 'Chicago:1906', 'Chicago:1907', 'Chicago:1908', 'Pittsburgh:1909', 'Philadelphia:1910', 'Philadelphia:1911', 'Boston:1912', 'Philadelphia:1913', 'Boston:1914', 'Boston:1915', 'Boston:1916'] 
```

您可以轻松地去掉“in YYYY”部分，但最好的方法取决于短语的可变性。

例如，如果您知道它是`in YYYY`，那么您可以使用类似

```
def strip_year(winner, year):
    in_year = ' in {}'.format(year)
    if winner.endswith(in_year):
        winner = winner[:-len(in_year)]
    return winner 
```

然后使用字典理解（python >= 2.7）：

```
>>> {year: strip_year(winner, year) for year, winner in enumerate(winners, 1903)}
{1903: 'Boston Americans', 1904: 'World Series Not Played', 1905: 'New York', 1906: 'Chicago', 1907: 'Chicago', 1908: 'Chicago', 1909: 'Pittsburgh', 1910: 'Philadelphia', 1911: 'Philadelphia', 1912: 'Boston', 1913: 'Philadelphia', 1914: 'Boston', 1915: 'Boston', 1916: 'Boston'} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-30T13:24:11.030

认为：

```
my_dict = {"States" : ["Boston Americans", "World Series Not Played in 1904", "New York",  
           "Chicago", "Chicago", "Chicago"
           "Pittsburgh", "Philadelphia", "Philadelphia",
           "Boston", "Philadelphia", "Boston", "Boston","Boston"]} 
```

那么这将做到这一点：

```
years = 1906
for key in my_dict.keys():
  year_list = []
  for year in my_dict[key][0].split(","):
    if re.search(start,year):
      year_list.append(year)
    else:
      year_list.append(year + ":" + years)
    years += 1
  my_dict[key] = year_list 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T13:26:37.267

类似的东西：

```
>>> a = ['a','b','c','d in 1906','e']
>>> b = range(1903,1903+len(a))
>>> b
[1903, 1904, 1905, 1906, 1907]
>>> zip(a,b)
[('a', 1903), ('b', 1904), ('c', 1905), ('d in 1906', 1906), ('e', 1907)]
>>> c = zip(a,b)
>>> d = [(i[0][:-7],i[1]) if i[0].endswith(str(i[1])) else (i[0],i[1]) for i in c]
>>> d
[('a', 1903), ('b', 1904), ('c', 1905), ('d ', 1906), ('e', 1907)] 
```

之后你可以`dict(d)`用来获取字典

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-30T13:32:14.517

使用 Python 的列表推导并定义一个辅助函数，如果它们尚未出现，则将文本与年份连接起来。

您可以使用可选的第二个参数[`enumerate`](http://docs.python.org/3.3/library/functions.html#enumerate)来指示*起始值*- 您的第一年。

```
def add_year_to(state, year):
    year = str(year)
    return state if state.endswith(year) else ':'.join((state, year))

states_with_years = [add_year_to(state, year) 
                     for year, state
                     in enumerate(states, 1903)] 
```

# visual-studio-2010 - gsoap : 插入 stlvector

> ID：15718925
> 
> 赞同：0
> 
> 时间：2013-03-30T13:12:37.303
> 
> 标签：visual-studio-2010, import, gsoap

我正在使用 gsoap v 2.8 编写地狱程序并尝试在 Visual Studio 2010 中编译它。我想使用 stl-vector 功能。但是指令中有导入错误

```
#import "import/stlvector.h" 
```

错误：

> 错误 C1083：无法打开类型库文件：'r:\work\vs2010\xmlme\xmlme\import\stlvector.h' 加载库 r:\work\vs2010\xmlme\xmlme\xmlme.h 时出错

和后果：

> IntelliSense：无法打开源文件“R:/Work/VS2010/XmlMe/XmlMe/Debug/stlvector.tlh”r:\work\vs2010\xmlme\xmlme\xmlme.h

无法弄清楚 Intellisense 想从我这里得到什么。我将导入文件夹从 gsoap 目录复制到我的项目中，并按照我的想法正确引用它。

[我的解决方案存档（链接可能过期）](http://tbf.me/a/DlQEN)

**更新：**

我已经尝试了 wsdl2h 实用程序的 -s 参数以从 xmlme.h 文件中排除 stl 依赖项。现在我有类似的错误：

> 错误 C1083：无法打开类型库文件：soap12.h：加载库时出错。xmlme\xmlme.h

...产生同样奇怪的后果：

> IntelliSense：无法打开源文件“XmlMe/Debug/soap12.tlh”\xmlme\xmlme.h

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T15:29:30.113

问题是不要在项目中包含 XmlMe.h（使用 wsdl2h.exe 工具生成的文件）。它使用符合 soapcpp2 的语言（基于 C 而不是 C，这就是为什么 VS10 编译器在包含此类文件时会产生错误）。

您还需要包含 .nsmap 文件，例如在您的主函数定义文件中。

# facebook-graph-api - 使用graph api收集facebook中的所有公开帖子

> ID：15718927
> 
> 赞同：0
> 
> 时间：2013-03-30T13:12:45.837
> 
> 标签：facebook-graph-api

我正在尝试使用 twitter 流等 Graph api 从 facebook 收集所有公开帖子。但我找不到方法，我检查了 graph api 搜索功能 [https://graph.facebook.com/search?q=anyword](https://graph.facebook.com/search?q=anyword)

它需要一个参数或关键字进行搜索，但我需要所有不特定于任何关键字或任何用户或任何页面的公共帖子。请帮我找出这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-29T06:13:31.447

不可能进行如此模糊的搜索。任何类型的搜索查询都需要至少一个参数/条件进行搜索。即使有可能，这就像在单个对象中接收数百万个数组（这实际上是不可能的）

在您的情况下，它应该是来自单个用户、组或页面的所有帖子。您可以从 Graph API 接收实时更新，但这也需要对象订阅其他对象。检查以下链接。 [实时更新](https://developers.facebook.com/docs/reference/api/realtime/)

# c# - 支持 lower_bound 的 C# 结构，如 std::set

> ID：15718947
> 
> 赞同：2
> 
> 时间：2013-03-30T13:14:30.703
> 
> 标签：c#, c++, map, lower-bound

我需要一个内置的数据结构，`C#`它的功能类似于c++ 中的`std::set`（或`std::map`）。对我来说重要的是结构应该被排序（因此`Dictionary`不会在这里做）并且有一个类似的方法`lower_bound`（即返回至少具有值的第一个元素`v`）。我还需要从结构中插入和删除元素。如果可能的话，我需要这些操作具有复杂性`O(log(n))`。你能指出我合适的数据结构`C#`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:17:40.660

我怀疑您正在寻找与 std::set 类似的数据结构的[SortedSet](http://msdn.microsoft.com/en-us/library/dd412070.aspx)。

[本文](http://msdn.microsoft.com/en-us/vstudio/ee906600.aspx)将介绍其性能特征。

根据[此讨论，使用](https://stackoverflow.com/questions/9850975/why-sortedsett-getviewbetween-isnt-olog-n)[SortedSet.GetViewBetween](http://msdn.microsoft.com/en-us/library/dd381801.aspx)`lower_bound`似乎可以实现功能，但其复杂性比所需的 O(log(n)) 更差。

# ios - 使用 Quartz 绘制折线图？

> ID：15718950
> 
> 赞同：1
> 
> 时间：2013-03-30T13:14:44.457
> 
> 标签：ios, ios6, quartz-graphics

我正在尝试为 ipad 制作一个简单的图表。我需要使用 QUARTZ 绘制 sin(x)、cos(x) 和 tan(x) 函数。我知道如何制作网格和线条，但不知道如何开始。任何帮助表示赞赏。

请注意，我对核心情节和其他框架不感兴趣，所以请不要将此作为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:29:15.893

很简单：你决定你想要什么分辨率/精度，然后你根据它把函数的域分成区间，你计算每个区间中函数的值，然后用直线连接它们：

```
// Within a subclass of UIView
- (void)drawFunction:(double (*)(double))fn from:(double)x1 to:(double)x2
{
    [super drawRect:rect];

    CGContextRef ctx = UIGraphicsGetCurrentContext();

    CGFloat comps[] = { 1.0, 0.0, 0.0, 1.0 };
    CGContextSetStrokeColor(ctx, comps);
    CGContextSetLineWidth(ctx, 2.0);

    const double dx = 0.01; // precision
    double scale_x = self.bounds.size.width / (x2 - x1);
    double off_x = 0.0;
    double scale_y = scale_x;
    double off_y = self.bounds.size.height / 2;

    CGContextMoveToPoint(ctx, x1 * scale_x - off_x, off_y - fn(x1) * scale_y);

    for (double x = x1 + dx; x <= x2; x += dx) {
        double y = fn(x);
        CGFloat xp = x * scale_x - off_x;
        CGFloat yp = off_y - y * scale_y;
        CGContextAddLineToPoint(ctx, xp, yp);
    }

    CGContextStrokePath(ctx);
} 
```

从以下位置调用`- drawRect:`：

```
- (void)drawRect:(CGRect)rect
{
    [super drawRect:rect];
    [self drawFunction:sin from:0.0 to: 2 * M_PI];
} 
```

# java - Applet 错误中的 JSuggestField

> ID：15718960
> 
> 赞同：0
> 
> 时间：2013-03-30T13:16:20.807
> 
> 标签：java, jsp, applet, noclassdeffounderror

我写了一个执行得很好的小程序。我使用 JSuggestField 进行自动完成。然后我想在 JSP 项目中使用这个小程序。当我运行 web 项目时，applet 没有在浏览器上执行并且出现错误。我的 JSP 代码是；

```
 <body>
            <applet archive="KitapAraApplet.jar,suggest.jar" code="KitapAra.class"
                    height="250" width="300"></applet>
        </body> 
```

错误是：

```
java.lang..NoClassDefFounderError: ch/rakudave/suggest/JSuggestField 
```

# php - 连接两个元键？

> ID：15718968
> 
> 赞同：0
> 
> 时间：2013-03-30T13:17:17.260
> 
> 标签：php, wordpress

我有一个学校时间表作为自定义帖子类型。每个帖子都是一个学校课程，其中包含一个包含两个文本字段的帖子元框，用于指定课程以 24 小时时间格式开始的小时和分钟：

```
_start_hour
_start_minute 
```

我正在尝试按时间顺序输出帖子，例如

```
 // the args
$args = array(
    'post_type' => 'my-cpt',
    'meta_key' => '???????',
    'orderby' => 'meta_value_num',
    'order' => 'ASC',
    'posts_per_page' => -1,
);

// The Query
$the_query = new WP_Query( $args );

    while ( $the_query->have_posts() ) : $the_query->the_post();

            // ordered output according to time

           endwhile; 
```

在'meta_key'中，有什么方法可以连接两个元键吗？

我已经尝试过`'meta_key' => '_start_hour' && '_start_minute'`，但这会破坏查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-30T13:31:23.250

不幸的是，wordpress 不支持此功能，您必须在从数据库中获取它之后和循环之前自行对其进行排序。

*Disclaimer note* This is extremely ugly by design, but this is Wordpress so you have to play with what you get, you can make it less ugly if you fallback to writing the SQL queries yourself, depends on performance in my opinion, as Wordpress can be a performance degrader beast if not handled properly you should consider making it with SQL queries instead.

```
// Fetch all posts - (1 SQL Query)
$query = new WP_Query(array(
    'post_type' => 'my-cpt',
    'order' => 'ASC',
    'posts_per_page' => -1,
));

foreach ($query->posts as &$post) { // N queries as the number of posts you have - totally inefficient 
 $post->meta = get_post_meta($post->ID);
}

usort($query->posts, function($a, $b) {
   $a_time = strtotime($a->meta['_start_hour'][0] . ':' . $a->meta['_start_minute'][0]);
   $b_time = strtotime($b->meta['_start_hour'][0] . ':' . $b->meta['_start_minute'][0]);
   if ($a_time > $b_time)
      return 1;
   else if ($a_time < $b_time)
      return -1;
   else
      return 0;
}); // Sorting by date

... the_loop ... 
```

note that this is totally untested so it should just give you pointers on hour should you do it, and again I say, you should refactor this to join the meta keys in advance, that way you can perhaps already sort it with the SQL instead of the PHP...

# sql-server - 从日期选择器到 sql vb10 的日期

> ID：15718969
> 
> 赞同：0
> 
> 时间：2013-03-30T13:17:27.693
> 
> 标签：sql-server, visual-studio-2010

*晚上好，我想将日期从日期选择器插入到 sql 中，它如何使 2013 年 1 月 1 日而不是 2013 年 1 月 1 日上午 12:00 在表中？我希望它理解非常感谢你*

# java - How to combine Java assert and (JUnit) Tests for public postconditions?

> ID：15718973
> 
> 赞同：2
> 
> 时间：2013-03-30T13:18:06.013
> 
> 标签：java, unit-testing, testing, assert, design-by-contract

I read the Oracle recommendations concerning Java's assert and it says that you should use assert for public postconditions, too ([http://docs.oracle.com/javase/1.4.2/docs/guide/lang/assert.html#postconditions](http://docs.oracle.com/javase/1.4.2/docs/guide/lang/assert.html#postconditions)).

How would I combine this assert with a automated test, that actually does this check, too?

Example: After invoking the "push" method of a class "Stack" you want to check whether the stack is now not empty. You can use assert and you can use a test.

Is there any best practice, I could do both and the unit test with some more checks, but anyhow I would do things twice, which seems not to be good.

I have already read these questions:

[https://softwareengineering.stackexchange.com/questions/18288/are-asserts-or-unit-tests-more-important](https://softwareengineering.stackexchange.com/questions/18288/are-asserts-or-unit-tests-more-important)

[assert vs. JUnit Assertions](https://stackoverflow.com/questions/2966347/assert-vs-junit-assertions)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-30T13:42:07.273

The decision to code assertions is an *implementation* choice.
The decision to run your JVM with assertions turned on is a *runtime* choice.

JUnit tests should test behaviour, regardless of implementation or runtime choices.

To be clear, the answer is that your JUnit tests should assert (through code) that the method(s) have the expected outcome. If assertions are in the code that effectively do the same thing, that's irrelevant and should not be relied upon as a justification to not write the corresponding JUnit test, because:

*   the person coding the implementation is quite free to remove the assert statements
*   the JVM may not (ever) run with assertions turned on

# neo4j - Neo4j Recommendation Engine

> ID：15718974
> 
> 赞同：1
> 
> 时间：2013-03-30T13:18:15.220
> 
> 标签：neo4j

I am new user on Neo4J.. Just one week of reading.

I am looking into using NEO4J for creating recommendations.

We have product catalog and on product details page we would like to show similar products based on features of different products, cumulative rating, price range.

These products as such don't have relationship with each other except that they share common features.

For example Product : iphone Feature: camera, 4g etc

product: Samsung Note Feature: camera, 4g etc

Any thoughts if Neo4J is correct choice for this type of data? We want list of similar products based on feature set, price rang, rating for each prodct

And how wold data model will look?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-30T14:47:32.077

You might take a look at [http://www.reco4j.org/](http://www.reco4j.org/), a recommondation engine framework working on top of Neo4j.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T15:04:02.590

I'd suggest looking at a site like Amazon.com (or similar) and see how they organize their SKU. If you open up any item on Amazon you will "facets" (or ways to categorize items) like:

*   Department
*   Sub-Category
*   Brand
*   User Rating
*   Price Range
*   Features (as keywords)

You then have to determine whether each of these facets is better modeled as a hierarchy or as a property. Department and Sub-Category look like better candidates for a hierarchy, whereas Brand and Features look like better candidates for properties.

Department and Sub-Category would look like trees, and the leaves of the tree would be all your SKUs.

Then your "similarity" function could be as easy as if a "product falls within the same Department/Sub-Category and it matches at least 50% of the features".

Hope this helps, this is just my initial thoughts.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T16:07:45.560

There are several options:

*   you can do recommendations by finding similar users (via their actions/purchase history/ratings) and recommend things that those similar users have bought, see: [http://docs.neo4j.org/chunked/milestone/cypher-cookbook-similar-favorites.html](http://docs.neo4j.org/chunked/milestone/cypher-cookbook-similar-favorites.html)
*   you can simple list other products that are in the same category and have similar attributes (it is good if you can pull out attributes as nodes instead of properties so it is easier to match them)
*   you can list products that would be useful accessories for already bought products (it doesn't make sense to suggest a camera to someone who just bought a camera, rather accessories for what he bought)
*   if you have no initial purchase data you can just list products with high rankings in similar demographics (gender, age, etc)

# android - how can I can keep my variable stop resting when i move to a different activity?

> ID：15718975
> 
> 赞同：0
> 
> 时间：2013-03-30T13:18:15.393
> 
> 标签：android, android-date

Hello I have couple of activities in my app and I want to be able to move between them without to worry that my variable values will get restart every time. I tried to use share permanences but it create my a lot of bugs in the app because they wont go beck to default.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:21:50.477

AFAIK your variable values will not be affected As long as you don't finish your activity or explicitly reset/change variables values.If you meant to keep variable values you must use some storage machanism. (File / SharedPreference etc)

Vogella has written very good post on Persistence

[http://www.vogella.com/articles/AndroidFileBasedPersistence/article.html#overview_fileAPI](http://www.vogella.com/articles/AndroidFileBasedPersistence/article.html#overview_fileAPI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:23:41.900

You could begin with things like understanding what a "variable" is. Then gradually move to concepts like classes, attributes and methods. When you get those, try and learn developing for Android - things like life cycle of an application will be of interest to you. After some time you will be able to ask the right questions.

Without all these steps you will not be able to get any help, unless you get someone to rewrite your application.

# html - Is it semantically correct to include two elements on a page for primary AND secondary navigation?

> ID：15718976
> 
> 赞同：4
> 
> 时间：2013-03-30T13:18:15.910
> 
> 标签：html

My page has two sections where there are a "list of links". The first is the primary i.e.

```
<nav>
    <ul>
        <li><a href="/">Homepage</a></li>
        <li><a href="/testimonies.html">Testimonies</a></li>
        <li><a href="/contact-us.html">Contact Us</a></li>
        ...
    </ul>
</nav> 
```

This is a no brainer, ‘nav‘ is suitable here.

The second list of links is a list of categories such as:

```
Rock Music
Dubstep Music
Dance Music
Hip Hop Music
Electro Music
Classical Music
... 
```

Is it semantically correct to use a element for the secondary list?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-30T13:20:48.200

Depending on the documentation...seems legit. There is an example with two `nav` elements for primary and secondary navigation as well.

[http://www.w3.org/html/wg/drafts/html/master/sections.html#the-nav-element](http://www.w3.org/html/wg/drafts/html/master/sections.html#the-nav-element)

# opencv - opencv 2.4.4没有gpu支持错误

> ID：15718979
> 
> 赞同：1
> 
> 时间：2013-03-30T13:18:25.110
> 
> 标签：opencv, configuration, cuda

在帖子[OpenCV 2.4.3rc 和 CUDA 4.2: "OpenCV Error: No GPU support"](https://stackoverflow.com/questions/13228762/opencv-2-4-3rc-and-cuda-4-2-opencv-error-no-gpu-support)中，据说必须添加 C:\opencv\build\gpu\x86... 库而不是 C:\opencv\build\ x86...那些。但是 2.4.4 realese 没有 gpu 文件夹。我在 vs 2010 conf 上添加了用于发布的 opencv_gpu244.lib 库文件和用于调试模式的 opencv_gpu244d.lib。它们位于 C:\opencv\build\x64\vc10\lib 中。但我得到 opencv 错误（不支持 gpu）：该库是在没有 cuda 支持的情况下编译的。顺便说一句，我正在使用 cuda 工具包 5.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T19:15:40.053

给定答案中描述的过程仍然适用于 OpenCV 的当前分布。只有1个小差异。OpenCV 2.4.4 的预构建发行版不包含 GPU 二进制文件。要添加 GPU 支持，您必须使用 CMake 自己构建库。

OpenCV 2.4.4 针对 Kepler 架构 GPU 进行了优化。在 2.4.3 版本中，只有 GPU 二进制文件大约为 1.4 GB。所以你可以猜到，添加 Compute capabilty 3.0 和 3.5 的代码会使它变得更大。所以发布这些二进制文件是不可行的，这就是为什么**gpu**文件夹不存在于 2.4.4 版预构建发行版中的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T14:57:03.263

您应该使用支持 CUDA 的 CMake 编译 OpenCV 库（有一个复选框）。之前的版本包括预编译的 gpu 文件。

# java - 无法使用 CountDownTimer 类创建处理程序

> ID：15718989
> 
> 赞同：1
> 
> 时间：2013-03-30T13:19:31.710
> 
> 标签：java, android, countdowntimer

我正在做一个学校项目，我们正在制作一个炸弹人游戏。操场上有 2 个轰炸机，用户和 AI。

当用户放置炸弹并离开它时，炸弹会在时间结束时闪烁并爆炸。

但是，这不适用于 AI。

当 AI 放置炸弹并离开它时，当它应该闪烁然后爆炸时，应用程序会因留下以下错误而崩溃：

```
FATAL EXCEPTION: Timer-0
 java.lang.RuntimeException: Can't create handler inside thread that has not called Looper.prepare() 
```

`CountDownTimer`代码如下。

```
public void explodeAIBomb(){

    //Starts countdown 2-4 seconds

    new CountDownTimer(new Random().nextInt(2000) + 2000, 300) {
        //test for onTick; bomb flashes
        boolean test = false;

    public void onFinish() {
        //on explosion{
        gameBoard[locateAIX][locateAIY] = new Blast();          
        explosionSide(locateAIX, locateAIY);
        explosionVert(locateAIX, locateAIY);
        updateView();

        //Clear all blasts after 1 second
        new CountDownTimer(1000, 1000){
            public void onFinish(){
                for (int x = 0; x < XasLength + 1; x++) {
                    for (int y = 0; y < YasLength + 1; y++) {
                        if(gameBoard[x][y] != null){
                            if(gameBoard[x][y].getTileId() == BLAST || gameBoard[x][y].getTileId() == BLAST_SIDE || gameBoard[x][y].getTileId() == BLAST_VERT){
                                gameBoard[x][y] = null;
                            }
                        }
                    }
                }
                aiBombPlanted = false;
                updateView();
            }
            @Override
            public void onTick(long millisUntilFinished) {
            }                   
        }.start();
        updateView();
    }

    //Flashes the bomb every 0.3 second
    public void onTick(long millisUntilFinished) {              
        if(test){
            loadTile(BOMB, r.getDrawable(R.drawable.bomb));
            test = false;
        }
        else{
            loadTile(BOMB, r.getDrawable(R.drawable.bomb2));
            test = true;
        }
        updateView();
    }
}.start(); 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:25:00.347

您在某个工作线程中进行 UI 工作的地方。您需要从主线程中调用处理 UI 的东西。

我认为以前已经回答了同样的问题。

[stackoverflow.com/questions/6354740/how-is-countdowntimer-accessing-ui-inside-ontick-method](https://stackoverflow.com/questions/6354740/how-is-countdowntimer-accessing-ui-inside-ontick-method)

# azure - SQLAzure 数据库 (3) 消失了。如何与微软沟通？

> ID：15718992
> 
> 赞同：-1
> 
> 时间：2013-03-30T13:20:03.043
> 
> 标签：azure, azure-sql-database

几分钟前，一台 SQLAzure 服务器上的 3 个数据库消失了，管理控制台告诉我，在检索有关西欧地区特定 SQL Server 上的数据库的信息时出现问题。

在“支持”部分，我们无法发送技术问题，只能发送计费问题。但这不是一个问题，这是一个信号！！！！（微软正在变成一堵口香糖墙？）

任何人都可以通过任何方式通知 MS，他们 99.95% 的正常运行时间服务已关闭？？？

提前谢谢了。周末愉快。戴维德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T13:38:50.447

如果您在支持表单的下拉列表中没有看到“技术”选项，您可能会在表单下方看到“您的支持计划：免费 - 仅计费支持您当前的计划不包括 Microsoft 的技术支持” ."。这意味着您尚未购买 Web 事件提交随附的支持。它还将具有指向以下页面的链接[https://www.windowsazure.com/en-us/support/plans/](https://www.windowsazure.com/en-us/support/plans/)，该页面描述了支持级别。

[可悲的是，在免费支持级别上，除了发布到论坛](http://social.msdn.microsoft.com/Forums/en-US/category/windowsazureplatform,azuremarketplace,windowsazureplatformctp)之外，似乎没有办法告诉他们似乎有问题。如果您是 MSDN 订阅者，那么在同一个支持论坛上有一个链接可以引导您使用不同的表单，我相信该表单会开始在线聊天。

此外，当发现问题并且他们有信息要发布时，服务仪表板会更新。仅仅因为某些事情还没有出现并不意味着他们没有意识到问题。

# javascript - 如何将淡入淡出过渡添加到交换图像

> ID：15718994
> 
> 赞同：1
> 
> 时间：2013-03-30T13:20:32.793
> 
> 标签：javascript, html

我发现了各种向翻转图像添加漂亮的淡入淡出过渡的方法，但没有一个真正说明如何将脚本应用于 html 文档

这就是我到目前为止所得到的......我怎样才能添加一个淡入淡出，淡出脚本呢？而不是只是在图像之间轻弹

```
<img src="images/portfolio.jpg" alt="" width="155" height="150" id="portfolio" 
onmouseover="MM_swapImage('portfolio','','images alt/index-alt_12.jpg',1)"
    onmouseout="MM_swapImgRestore()" /> 
```

这是 HTML 文档中的全部内容。

```
<td colspan="2" rowspan="5" align="left" valign="top"><a href="portfolio.html"><img src="images/portfolio.jpg" alt="" width="155" height="150" id="portfolio" onmouseover="MM_swapImage('portfolio','','images alt/index-alt_12.jpg',1)"
    onmouseout="MM_swapImgRestore()" /></a></td> 
```

如何隔离“index-alt_12.jpg”并为其创建 ID 标签？我在哪里放那个代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T13:49:40.617

由于您使用鼠标悬停和移出，我假设您只有两个图像，对吗？

您可以在没有 javascript 的情况下执行此操作。它仍然可以在旧版浏览器中使用，但动画淡入淡出仅适用于 webkit、ie10 和 mozilla。如果您必须在旧版本的 IE 上使用此功能，这只是一个问题。

你可以做的是放置两张图片，一张在另一张上面。

例如 - 假设这是通过 css 将一个放在另一个之上

```
<img class="imageA" src="a.jpg" />
<img src="b.jpg" /> 
```

在 css 上

```
.imageA {
   -webkit-transition: all 300ms ease;
   -moz-transition: all 300ms ease;
   -o-transition: all 300ms ease;
   transition: all 300ms ease;
   opacity: 1;
}

.imageA:hover {
   opacity: 0;
} 
```

您也可以使用转场动画从任何一个 css 属性到另一个。除了两张图片，下面的一张也可以是容器的背景图片，如下所示，但仍然纯粹通过 css 完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T13:37:57.543

你在使用jQuery吗？如果是这样，有一个很好的解决方案给你！在 HTML 页面的底部（包含 jQuery 的地方），您可以使用如下内容：

```
$(document).ready(function() {
  $("#portfolio").mouseover(function() {
    $("#img1").fadeTo(200, 1); 
    // The above means take 200ms to fade to an opacity of 1.0 (fully opaque).
    $("#img2").fadeTo(200,0);
    // The above says the same thing, but for fading out
  });
}); 
```

如果您稍微尝试一下，您可以让它们根据显示的内容来回切换，但这是一般的想法。

瞧！我知道您正在寻找 javascript 答案，但 jQuery 对此类问题非常有帮助，并且强烈推荐给您。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-30T13:48:24.543

您尝试使用硬编码图像执行此操作的方式存在错误，但您可以切换到 CSS 作为解决方法。

首先，我会设置一个 div 并将portfolio.jpg 设置为背景图片：

HTML：

```
<div id="portfolio"></div> 
```

CSS：

```
#portfolio {
    background:url('images/portfolio.jpg') no-repeat;
    height: 150px;
    width: 155px;
} 
```

这是一种`#portfolio`在鼠标悬停时淡出，换入新背景图像，然后将 div 淡入的方法。需要 jQuery 1.0+

```
$('#portfolio').mouseover(function() {
    var self = $(this);
    self
        .fadeOut('slow', function() {
            self
                .css('background-image', 'url("images alt/index-alt_12.jpg")')
                .fadeIn('slow');
        });
}); 
```

# javascript - Html 将 div 追加到另一个 div

> ID：15718996
> 
> 赞同：0
> 
> 时间：2013-03-30T13:20:39.743
> 
> 标签：javascript, jquery, html

我对我的 HTML 设计有疑问。我有`<div> ... </div>`一个固定位置的部分。我希望在标签`<div></div>`内的任何地方重用它。`body`

我用 jQuery 和 JavaScript 用 , , 的方法尝试`innerhtml('...')`了`after('...')`它`append('...')`。它有效，但我不想用引号解释这 100 行，还有一件事。我希望不止一次地包括这`<div></div>`一点。

示例代码格式。

```
<html>
<head>
....
</head>

<body>
...
   <div id='includes_div'>       <!-- It hides on form load -->
      ...
      ...     <!-- having 100 of lines -->
   </div>

   <div id='div1'>
       <!-- want to include here -->
      ...
   </div>

   <div id='div2'>
       <!-- want to include here -->
      ...
   </div>
</body>
</html> 
```

jQuery或JavaScript可以吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-30T13:26:03.927

这应该工作：

```
var cont = $('#includes_div').html();
$('#div1').append(cont);
$('#div2').append(cont); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-30T13:35:10.613

有很多方法可以做到这一点，以下只是我看到常用的两种。

第一个是使用 jQuery 'clone()' 方法：

```
var toClone = $('#includes_div');
var cloneContainers = $('#div1, #div2');

cloneContainers.each(function() {
    var clonedDiv = toClone.clone();
    clonedDiv.attr('id', '');
    this.append(clonedDiv);   
}); 
```

This will give you an exact clone of the original div and put it in each container. As it is an exact clone you need to prevent id conflicts.

Another way is to just use the content of the first div, rather than the whole of it.

```
var content = $('#includes_div').html();
var containers = $('#div1, #div2');

containers.each(function() {
    this.append(content);   
}); 
```

Obviously the code above is written to help break down the process, it's possible to write them both in a more compact form.

# iphone - ASIHTTPRequest vs AFNetworking vs NSUrlRequest

> ID：15718998
> 
> 赞同：29
> 
> 时间：2013-03-30T13:20:57.560
> 
> 标签：iphone, ios, afnetworking

过去我用过`ASIHTTPRequest`，但现在有`NSURLRequest`。我们应该使用`NSURLRequest`现在吗？有什么缺点吗？

对于现在阅读本文的人：我最终使用`AFNetworking`了答案中提到的

[https://github.com/AFNetworking/AFNetworking](https://github.com/AFNetworking/AFNetworking)

谢谢，

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-30T13:27:14.530

`NSURLConnection`并且`NSURLRequest`是提供的用于管理连接的 Cocoa 类。在 iOS 7 中，Apple 添加了`NSURLSession`.

但我想你会发现[`AFNetworking`](https://github.com/AFNetworking/AFNetworking)它是一个进一步简化网络请求（尤其是复杂的 HTTP 请求）的框架。如果出于任何原因不想使用第三方框架，可以使用`NSURLConnection`和/或`NSURLSession`直接使用。它只需要更多的编码。

如果您正在寻找一个好的`ASIHTTPRequest`替代品，`AFNetworking`是一个很好的人选。

有关`NSURLConnection`并`NSURLSession`查看[URL 加载系统编程指南](https://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/URLLoadingSystem/URLLoadingSystem.html)的信息。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-03-30T13:31:58.697

`NSURLRequest`自 iOS2.0 以来一直存在（请参阅[文档](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableURLRequest_Class/Reference/Reference.html)），因此它并不完全是新的。`ASIHTTPRequest`已停产，[最后一次更新](http://allseeing-i.com/ASIHTTPRequest/)是在 2011 年 5 月 15 日，所以你不应该使用它。[AFNetworking 是他们自己](https://github.com/AFNetworking/AFNetworking)描述的*适用于 iOS 和 Mac OS X 的令人愉快的网络库*，并且确实让您的生活更轻松，在我的情况下，它是我包含在我的网络所需项目中的第一个框架。

你应该使用哪一个？，我认为这取决于你的要求，`NSURLRequest`你`NSURLConnection`可以做任何事情，事实上 AFNetworking*我们建立在 NSURLConnection 之上*。但是我之前告诉过你，AFNetworking 有我的支持。

**编辑发布iOS7**

如果你的目标是 iOS7，你应该看看 NSURLSession，查看[官方文档](https://developer.apple.com/library/ios/documentation/Foundation/Reference/NSURLSession_class/Introduction/Introduction.html)和本[教程](http://www.raywenderlich.com/51127/nsurlsession-tutorial)。

**编辑斯威夫特**

看看[Alamofire](https://github.com/Alamofire/Alamofire)项目中的 Swift 实现，它也是由 mattt（AFNetworking 的主要作者）创建的。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-30T17:56:18.813

asihttprequest 是过时的库，现在不支持开发。不要使用它。

NSURLRequest 是要使用的默认 iOS (cocoa) 类。我建议很少使用它，因为您需要编写大量代码来处理连接响应。最重要的是构建所有 http 库。

AFNetwoking 现在是 http 的标准，恕我直言。它使用块进行回调，它支持不同类型的数据 json、xml 等。它设计得很好，可以很容易地被子类化。这是最好的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-02-13T16:26:05.370

> **Native (NSURLSession) vs AFNetworking 或任何其他库。**

I would recommend you to use NSURLSession because it gives you a lot of customization on app end. Recently I was working on a project, I have to use **multipart form data** some where in the app. I have to provide my request body to the backend guy, I did use AfNetworking logger to print my body but it did not help me. so I did move to cocoa native library and got my solution.

so I would suggest you to use iOS native networking because it gives you a lot of customization but if you would need less code then you can use any 3rd party library.

# linear-algebra - 用小 A 求解多个线性系统 Ax=b 的最有效方法（最小 3x3 最大 8x8）

> ID：15718999
> 
> 赞同：2
> 
> 时间：2013-03-30T13:21:08.513
> 
> 标签：linear-algebra, performance

我需要解决数千次 Ax=b 类型的小线性系统。这里 A 是一个不小于 3x3 且最大为 8x8 的矩阵。我知道这个[http://www.johndcook.com/blog/2010/01/19/dont-invert-that-matrix/](http://www.johndcook.com/blog/2010/01/19/dont-invert-that-matrix/)所以我认为即使矩阵很小，反转矩阵也不明智吗？那么最有效的方法是什么？我正在用 Fortran 编程，所以我应该使用 lapack 库对吗？我的矩阵是完整的并且通常是非对称的。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T09:05:22.327

警告：我没有对此进行广泛研究，但我很乐意分享一些经验。

以我的经验，解决 3x3 系统的最快方法基本上是使用[Cramer 规则](http://en.wikipedia.org/wiki/Cramer%27s_rule)。如果您需要求解具有相同矩阵 A 的多个系统，则需要预先计算 A 的逆矩阵。这仅适用于 2x2 和 3x3。

如果您必须用相同的矩阵求解多个 4x4 系统，那么再次使用逆运算明显快于 LU 的正向和反向替换。我似乎记得它使用的操作更少，实际上差异更大（再次，根据我的经验）。随着矩阵大小的增长，差异缩小，并且渐近差异消失。如果您正在求解具有差异矩阵的系统，那么我认为计算逆矩阵没有优势。

在所有情况下，与使用 LU 分解相比，使用逆解系统的准确度可能会低得多，因为 A 是相当病态的。因此，如果准确性是一个问题，那么 LU 分解绝对是要走的路。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-02T06:12:00.007

The [LU factorization](http://en.wikipedia.org/wiki/LU_factorization) sounds like just the ticket for you, and the lapack routine `dgetrf` will compute this for you, after which you can use `dgetrs` to solve that linear system. Lapack has been optimized to the gills over the years, so in all likelihood you are better using that than writing any of this code yourself.

The computational cost of computing the matrix inverse and then multiplying that by the right-hand side vector is the same if not more than computing the LU-factorization of the matrix and then forward- and back-solving to find your answer. Moreover, computing the inverse exhibits even more bizarre pathological behavior than computing the LU-factorization, the stability of which is still a fairly subtle issue. It can be useful to know the inverse for small matrices, but it sounds like you don't need that for your purpose, so why do it?

Moreover, provided there are no loop-carried dependencies, you can parallelize this using OpenMP without too much trouble.