# StackOverflow 问答 14885000-14885999

# c - strncmp() 表达式中的 strlen() 是否会破坏使用 strncmp() 而不是 strcmp() 的目的？

> ID：14885000
> 
> 赞同：7
> 
> 时间：2013-02-14T22:11:48.243
> 
> 标签：c, buffer-overflow, strcmp, strncmp

据我了解，`strcmp()`（没有“n”）在任一参数中看到空字符后，会立即停止处理并返回结果。
因此，如果 100% 确定其中一个参数是空终止的（例如，它是一个字符串文字），那么使用(with 'n')和`strncmp()`调用`strlen()`参数将比较限制为已知字符串长度，因为`strcmp()`将永远不会读取比该已知终止字符串中更多的字符。

事实上，在我看来，`strncmp()`其长度参数是`strlen()`前两个参数之一的调用与这种情况的不同之处在于，它通过评估表达式`strcmp()`来浪费与已知终止字符串的大小成线性关系的时间。`strlen()`

考虑：

**示例代码 A：**

```
if (strcmp(user_input, "status") == 0)
    reply_with_status(); 
```

**示例代码 B：**

```
if (strncmp(user_input, "status", strlen("status")+1) == 0)
    reply_with_status(); 
```

前者比后者有什么好处吗？因为我经常在其他人的代码中看到*它*。

我对这些功能的工作原理有错误的理解吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T22:19:33.357

在您的特定示例中，我会说使用它是有害的，`strncmp`因为：

*   仍然使用`strlen`扫描
*   重复字符串文字`"status"`
*   加 1 以确保字符串确实相等

`user_input`所有这些都增加了混乱，如果它确实短于 6 个字符并且包含与测试字符串相同的字符，那么在任何情况下都不会防止溢出。

那将是例外。如果您知道输入字符串的内存总是比测试字符串中的字符数多，请不要担心。否则，您*可能*需要担心，或者至少考虑一下。 `strncmp`对于测试大缓冲区内的东西很有用。

我的偏好是代码可读性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T22:13:42.047

是的，它确实。如果在 strncmp 中使用 strlen，它将遍历指针，直到在字符串中看到 null。这使得它在功能上等同于 strcmp。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-14T22:27:43.613

在您给出的特定情况下，它确实没用。然而，轻微的改变更常见：

```
if (strncmp(user_input, "status", strlen("status")) == 0)
    reply_with_status(); 
```

这个版本只检查是否`user_input` *以 开头*，`"status"`所以它有不同的语义。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-07T21:35:01.710

除了检查字符串开头是否与输入匹配的技巧之外，strncmp 只有在您不能 100% 确定字符串在其分配空间结束之前是否以空结尾时才会有用。

所以，如果你有一个固定大小的缓冲区，你可以使用你的用户输入：

```
strncmp(user_input, "status", sizeof(user_input)) 
```

因此确保您的比较不会溢出。

但是在这种情况下，您必须小心，因为如果您的 user_input 不是以 null 终止的，那么它确实会检查 user_input 是否与状态的开头匹配。

更好的方法可能是说：

```
if (user_input[sizeof(user_input) - 1] != '\0') {
  // handle it, since it is _not_ equal to your string
  // unless filling the buffer is valid
}
else if (strcmp(user_input, "status")) { ... } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T22:27:13.967

现在，我同意这不是 strncmp() 的特别有用的用法，而且我看不出它比 strcmp() 有什么好处。

但是，如果我们通过删除`+1`after来更改代码`strlen`，那么它就开始有用了。

```
 strncmp(user_input, "status", strlen("status")) 
```

因为这会将前 6 个字符`user_input`与“状态”进行比较——这至少有时是有意义的。

因此，如果`+1`存在，它将成为常规`strcmp`- 计算长度只是浪费时间。但如果没有`+1`，这是一个非常有用的比较（在适当的情况下）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-14T22:32:22.727

strncmp() 的用途有限。如果在两个字符串中的任何一个上遇到 NUL，正常的 strcmp() 将停止。（在这种情况下字符串不同） Strncmp() 将停止并返回零（“字符串在前 N 个字符中相等”）

stncmp() 的一种可能用途是解析选项，直到非重要部分，例如

```
if (!strncmp("-st", argv[xx], 3)) {} 
```

，对于“-string”或“-state”或“-st0”将返回零，但对于“-sadistic”则*不会*。

# python - 也使用 python 函数 arg 作为默认参数

> ID：14885002
> 
> 赞同：2
> 
> 时间：2013-02-14T22:12:01.727
> 
> 标签：python

我想编写一个函数，它的默认值是函数的另一个输入。我想要这样的东西：

```
def pythag_thm(a, b=a):
    return (a**2 + b**2)**.5 
```

但我得到一个`NameError: name 'a' is not defined`. 我意识到我可以做类似的事情：

```
def pythag_thm(a, b=False):
     if b==False:
         return (a**2 + a**2)**.5
     else:
         return (a**2 + b**2)**.5 
```

但这似乎不是很“pythonic”。有没有一种干净的方法可以做到这一点？我只是以错误的方式思考这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:13:44.003

人们通常做的是

```
def pythag_thm(a, b=None):
    if b is None:
        b = a

    return (a ** 2 + b ** 2) ** .5 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:13:50.623

默认参数是在函数定义时评估的，所以没有办法这样做。

```
import math
def pythag_thm(a, b=None):
    if b is None:
        b = a
    return math.hypot(a, b) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T22:20:58.677

1.  人们通常`None`为此使用：

    ```
    def pythag_thm(a, b=None):
        b = b if b is not None else a
        ... 
    ```

2.  如果`None`对您来说是一个有效值，您`b`可以创建自己的`DEFAULT`值：

    ```
    DEFAULT = object()

    def pythag_thm(a, b=DEFAULT):
        b = b if b is not DEFAULT else a
        ... 
    ```

3.  如果你有心情，你也可以`*args`自己处理`**kwargs`：

    ```
    def pythag_thm(a, *args, **kwargs):
        try
            b = args[0]
            assert len(args) == 1
        except IndexError:
            try:
                b = kwargs.pop('b')
                assert not kwargs
            except KeyError:
                b = a
        ... 
    ```

您可能想要坚持使用变体 1 或 2，因为它是最 Pythonic 的并且不需要您摆弄`args`and `kwargs`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T22:14:40.953

输入中没有 b 知道 a 是什么的范围。它们只有在函数体中才存在

我能想到的最pythonic的方式是：

```
def example(a, b=None):
    if not b: b = a
    // code here 
```

编辑：与@pavel 的答案相同 - 必须学习更快的打字。对于潜伏者：存在行为差异。帕维尔的回答更好，我的不会正确处理类似的事情：

```
example (2, 0) 
```

因为 b is None 测试是更正确的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T22:41:51.753

在提供默认值时要格外小心，例如，当您希望默认值是一个列表时，这是一个错误：

```
>>> def function_with_default(arg=[]):
...    return arg
... 
```

这是一个产生意外结果的示例：

```
>>> ret = function_with_default()
>>> ret
[]
>>> ret.append(2)
>>> # unexpected side-effects ...
>>> ret2 = function_with_default()
>>> ret2
[2] 
```

上面示例中发生的情况是您可以实际修改对象。这是没有副作用的方法：

```
>>> def function_with_default(arg=None):
...    if arg is None:
...       arg = []
...    return arg
... 
```

同样的例子，不同的输出：

```
>>> ret = function_with_default()
>>> ret
[]
>>> ret.append(2)
>>> # no unexpected side-effects this time ...
>>> ret2 = function_with_default()
>>> ret2
[] 
```

要回答你的问题，你可以使用。

```
def pythag_thm(a, b=None):
   if b is None:
      b = a
   return (a**2 + b**2)**.5 
```

# javascript - JS 中 2 个字符串文字的比较。它有效吗？

> ID：14885008
> 
> 赞同：0
> 
> 时间：2013-02-14T22:12:28.033
> 
> 标签：javascript, qt4.8

JS 不允许比较 2 个字符串文字吗？例如：

```
"Some String" == "Some String" 
```

如果不是，在以前的一些版本中是否有所不同？

问题的背景：我在 Qt 4 中使用 ECMA 脚本。我的 DSL 引擎将部分 DSL 脚本转换为 JS 并对其进行评估。由于我从 Qt4.7.4 (LGPL) 迁移到 Qt4.8.4 (Commercial)，因此对上述代码的评估失败。在 Qt4.7.4 中，我曾经得到真/假。现在 QScriptEngine::evaluate 说语法不正确。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:18:41.607

是的，js 允许比较 2 个字符串文字。

`"Some String" == "Some String"`应始终返回 true。周围代码的一些示例可能有助于提供更多见解。

# php - 订购一个 XML 记分牌并用 PHP 返回它

> ID：14885012
> 
> 赞同：1
> 
> 时间：2013-02-14T22:12:48.863
> 
> 标签：php, javascript, jquery, xml, ajax

我正在创建一个游戏，当计时器结束时，用户可以输入他们的名字。我使用 AJAX 将名称和分数传递给 PHP 文件。该 PHP 文件将其添加到 XML 文件中。我循环遍历它以创建一个保存分数的表，然后将其返回到 AJAX，然后使用 jQuery 将其输出到屏幕上。我现在所有这些工作都很好。

我想要完成的是： 1\. 将分数添加到 XML 文件后，我想根据分数按降序对节点进行排序 2\. 然后我想用值按顺序填充表。我还想将其限制为仅前 10 名。

基本上，我在提出解决方案时遇到的问题是订购。一旦对 XML 进行排序，填充表并将其限制为 10 应该非常简单。关于我应该如何做到这一点的任何建议？

XML： http: [//people.rit.edu/lxl1500/Prog4/Project%202/scoreboard.xml](http://people.rit.edu/lxl1500/Prog4/Project%202/scoreboard.xml)

jQuery Ajax 调用：

```
function addScore(score,name){
    var url = 'scoreboard.php';
    $.post(url,{Score:score, Name:name},function(data){
    $('#score').html(data).show();
   });
} 
```

记分牌.php：

```
<?php
$score = $_POST['Score'];
$name = $_POST['Name'];

if($name == ''){
    $name = 'Player'.rand(0,5000);
}

$scoreboard = new domDocument;
$scoreboard->load('scoreboard.xml');

$root=$scoreboard->documentElement;

$entry = $scoreboard->createElement('entry');

$userScore = $scoreboard->createElement('score',$score);

$userName = $scoreboard->createElement('name',$name);

$entry->appendChild($userName);
$entry->appendChild($userScore);

$root->appendChild($entry);

$scoreboard->save('scoreboard.xml');

$scores = $scoreboard->getElementsByTagName('entry');

$string = '<table id="score-table" cellspacing="10"><tbody><tr><th align="left">User</th><th align="left">Score</th></tr>';

foreach($scores as $score){
    $getScore = $score->getElementsByTagName('score')->item(0)->nodeValue;
    $getPlayer = $score->getElementsByTagName('name')->item(0)->nodeValue;
    $string.="<tr><td>$getPlayer</td><td>$getScore</td></tr>";
}

$string.='</tbody></table>';

echo $string;

?> 
```

任何帮助将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:31:59.737

您可以构建一个排序的 XML 文件，即按排序顺序将节点添加到 xml 文件中，例如

```
$entries = $root->getElementsByTagName('entry');

$added = false;
foreach ($entries as $item) {
    if ($score <= $item->getElementsByTagName('score')->item(0)->nodeValue) continue;
    $root->insertBefore($entry, $item);
    $added = true;
    break;
}

// if not yet added, add it
if (!$added) {
    $root->appendChild($entry);
} 
```

为此，必须对文件进行排序（或为空）。

# winapi - API SendMessage() 不适用于外部应用程序对话框

> ID：14885013
> 
> 赞同：0
> 
> 时间：2013-02-14T22:12:53.810
> 
> 标签：winapi, sendmessage

我创建了一个有 2 个按钮的表单。一个按钮弹出一个 msgbox，另一个从下面列出的 frmAPI（代码在下面列出）中运行。如果我打开 msgbox 并将其保持打开状态，然后运行 ​​frmAPI，它将列出 msgbox 及其文本，然后将其关闭。这是我期望它做的。如果我打开另一个应用程序并在该应用程序中生成一个 msgbox，而我的 frmAPI 仍在运行，它实际上会列出其他应用程序 msgbox 和文本，但它不会从其他应用程序关闭 msgbox。如果我从另一个应用程序运行 frmAPI 并执行相同的测试，结果将相反。所以简而言之，它只会从同一个应用程序中关闭对话框。

我希望能够从任何应用程序中关闭一个对话框，因为它是一个对话框并且具有符合我标准的文本。对我做错了什么有帮助吗？

谢谢

```
Imports System.Runtime.InteropServices
Imports System.Text

Partial Public Class TestMSgBoxStuff
    Inherits Form
    Public Sub New()
        InitializeComponent()
    End Sub

    <DllImport("user32.dll", SetLastError:=True)> _
    Private Shared Function FindWindow(lpClassName As String, lpWindowName As String) As IntPtr
    End Function

    <DllImport("user32.dll", SetLastError:=True)> _
    Private Shared Function FindWindowEx(hwndParent As IntPtr, hwndChildAfter As IntPtr, lpszClass As String, lpszWindow As String) As IntPtr
    End Function

    <DllImport("user32.dll", CharSet:=CharSet.Auto, SetLastError:=True)> _
    Private Shared Function GetWindowText(hWnd As IntPtr, lpString As StringBuilder, nMaxCount As Integer) As Integer
    End Function

    <DllImport("user32.dll", SetLastError:=True, CharSet:=CharSet.Auto)> _
    Private Shared Function GetWindowTextLength(hWnd As IntPtr) As Integer
    End Function

    <DllImport("user32.dll", SetLastError:=True)> _
    Private Shared Function SendMessage(hWnd As HandleRef, Msg As UInteger, wParam As IntPtr, lParam As IntPtr) As IntPtr
    End Function
    <DllImport("user32", CharSet:=Runtime.InteropServices.CharSet.Auto, SetLastError:=True, ExactSpelling:=True)>
    Private Shared Function SetForegroundWindow(ByVal hwnd As IntPtr) As IntPtr
    End Function

    Private Const WM_IME_NOTIFY As Integer = &H282
    Private Const WM_DESTROY As Integer = &H2
    Private Const WM_NCDESTROY As Integer = &H82
    Private Const WM_CLOSE As Integer = &H10
    Private Const IMN_CLOSESTATUSWINDOW As Integer = &H1
    Private Const WM_KILLFOCUS As Integer = &H8
    Private Const WM_COMMAND As Integer = &H11

    Private Sub TestMSgBoxStuff_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
        Dim timer As New Timer()
        Timer1.Interval = 10000
        'detect the MessageBox every seconds
        'Timer1.Tick += New EventHandler(Timer1_Tick)
        Timer1.Start()
    End Sub

    Private Sub Timer1_Tick(sender As System.Object, e As System.EventArgs) Handles Timer1.Tick
        'Get the MessageBox handle
        Dim handle As IntPtr = FindWindow("#32770", Nothing)
        Me.RichTextBox1.AppendText("Handle: " + handle.ToString() + vbLf)

        'Get the Text window handle
        Dim txtHandle As IntPtr = FindWindowEx(handle, IntPtr.Zero, "Static", Nothing)
        Me.RichTextBox1.AppendText(vbTab & "text handle: " + txtHandle.ToString() + vbLf)
        Dim len As Integer = GetWindowTextLength(txtHandle)
        Dim sb As New StringBuilder()

        'Get the text
        GetWindowText(txtHandle, sb, len + 1)
        Me.RichTextBox1.AppendText(vbTab & "text: " + sb.ToString() + vbLf & vbLf)
        Me.RichTextBox1.ScrollToCaret()

        SetForegroundWindow(handle)

        'close the messagebox WM_CLOSE
        Dim lResults As Integer = SendMessage(New HandleRef(Nothing, handle), WM_NCDESTROY, IntPtr.Zero, IntPtr.Zero)

    End Sub
End Class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:34:19.053

您可能遇到了[User Interface Privilege Isolation](http://en.wikipedia.org/wiki/User_Interface_Privilege_Isolation)。这将阻止您的消息进入更高权限的进程。也可以看看[`ChangeWindowsMessageFilter()`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms632675%28v=vs.85%29.aspx)

我建议尝试发送 a[`WM_COMMAND`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms647591%28v=vs.85%29.aspx)而不是 a `WM_CLOSE`; `WM_COMMAND`通常被系统更温和地对待并且可能通过。使用 BN_CLICKED 作为 WPARAM 的高位字，IDOK 作为低位字（假设它有一个 OK 按钮），以及 LPARAM 中 OK 按钮的句柄。其他按钮消息在[这里](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775941%28v=vs.85%29.aspx)。

# python - 使用 cygwinreg 的 Cygwin Python 脚本，可以在 Windows Python 上运行

> ID：14885016
> 
> 赞同：0
> 
> 时间：2013-02-14T22:13:00.173
> 
> 标签：python, cygwin, winreg

Python新手在这里。

我正在使用 Cygwin 的 2.7.3 发行版在 Python 中编写一个简单的脚本。我想从此脚本访问/修改 Windows 注册表。我发现该`_winreg`模块在 cygwin python 上不可用，但存在替代[cygwinreg](http://pypi.python.org/pypi/cygwinreg/)。

这个脚本的用户没有 cygwin python，他们有 windows python 安装。是否可以编写一个适用于两者的python脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:18:05.370

当然，只需这样做：

```
try:
    import _winreg
except ImportError:
    import cygwinreg as _winreg 
```

或者可能

```
import sys

if sys.platform == 'win32':
     import _winreg
elif sys.platform == 'cygwin':
     import cygwinreg as _winreg
else:
     # non-windows support 
```

# matlab - Pspice模拟窗口不存在？

> ID：14885019
> 
> 赞同：1
> 
> 时间：2013-02-14T22:13:12.497
> 
> 标签：matlab, circuit

出于某种原因，我在运行模拟时没有“**文件编辑跟踪图查看工具窗口帮助**”选项，在哪里可以重置它？

![在此处输入图像描述](../Images/7e87e9291e1b49616d87dfa69e7e4804.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T09:27:12.823

作为快速修复，您可以使用 Alt+F、Alt+T ... Alt+（您要运行的命令菜单选项的首字母）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-10T11:30:32.507

如果文件，跟踪，绘图，编辑等按钮没有显示，这意味着你已经交替显示，同样的问题发生在我身上，所以要解决你只需这样做。

我会告诉你两种方法，但对于许多人来说，第一种方法不起作用，所以第二种方法请看。

1.按alt+12，如果你进入了之前的界面，那么如果不是很好，请通过下面的2个方式

Alt+o，然后单击 cutomize ，您将看到一个包含工具栏、命令和键盘的界面。转到键盘，然后在“选择一个命令”中，您必须向下滚动并找到名为替代显示的键，然后如果您单击替代显示，它会显示快捷键 shift+f12 但由于某些原因我的不起作用，所以只需将快捷键更改为你想要的键，就像我给了 alt + l，然后好的，然后做 alt+l 或你给的键，它会起作用。谢谢。

# powershell - 使用 Powershell 确定 Exchange 2013 中的 Exchange Server 版本

> ID：14885020
> 
> 赞同：2
> 
> 时间：2013-02-14T22:13:18.653
> 
> 标签：powershell, exchange-server, activesync

希望有人可以帮助我理解以下内容：在 Exchange 2013 环境中，当我在 powershell 会话中发出 Get-ExchangeServer cmdlet 时，我看到将 AdminDisplayVersion 属性报告为“版本 15.0”的输出。这对于 2013 Exchange Server 是正确的。

但是，当我在同一 2013 环境中发出 Get-ActiveSyncOrganizationSettings cmdlet 时，我看到 ExchangeVersion 属性报告为“0.10 (14.0.100.0)”。这表示 2010 Exchange Server。

这是 Microsoft cmdlet 中的一个缺陷，还是这些是正确的，但针对 Exchange 环境的不同组件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:16:54.263

我创建了一个 PowerShell 函数来检索 Exchange 2007、2010 和 2013 的正确版本信息。我的博客[文章](http://binarynature.blogspot.com/2013/04/get-exchange-server-version-and-update-info-with-powershell.html)包括代码和一些使用示例。由于该函数超过 200 行，我将不在这里包含它。以下是该函数的一些示例用法和输出：

### 获取单个服务器的已安装更新（累积和更新汇总）

```
[PS] Get-ExchangeServerPlus -cn exch01 | select -ExpandProperty update | ft inst*,upd*,desc* -AutoSize

InstallDate UpdateBuild Description
----------- ----------- -----------
11/11/2012  8.3.279.5   Update Rollup 8-v2 for Exchange Server 2007 Service Pack 3 (KB2756497)
02/18/2013  8.3.298.3   Update Rollup 10 for Exchange Server 2007 Service Pack 3 (KB2788321) 
```

### 输出所有已安装更新的 Exchange Server 对象属性

```
Get-ExchangeServerPlus | % {"Name`t: $($_.Name)"; "Version`t: $($_.Version)"; "Edition`t: $($_.Edition)"; "Build`t: $($_.Build)"; "Role`t: $($_.Role)"; "OSVer`t: $($_.OSVer)"; "OSSP`t: $($_.OSSP)"; "OSArch`t: $($_.OSArch)"; if ($_.Update) { $_ | select -ExpandProperty update | ft inst*,upd*,desc* -auto } else { [Environment]::NewLine }}

...
Name    : EXCH160-02
Version : 2013
Edition : Enterprise
Build   : 15.0.620.29
Role    : MB,CAS
OSVer   : Microsoft Windows Server 2012 Datacenter
OSSP    : 0
OSArch  : 64-bit

InstallDate UpdateBuild Description
----------- ----------- -----------
04/21/2013  15.0.620.29 Microsoft Exchange Server 2013 Cumulative Update 1
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-28T19:18:16.083

您可以通过检查已安装位的文件版本来获取交换版本。我无法访问 2013 环境，但我敢打赌有几个文件（.exe 或 .dll）会有这个版本。要提取它：

```
[System.Diagnostics.FileVersionInfo]::GetVersionInfo("somefilepath").FileVersion 
```

# sql - 有谁知道如何对 Worklight SQL 适配器进行故障排除？

> ID：14885021
> 
> 赞同：1
> 
> 时间：2013-02-14T22:13:20.470
> 
> 标签：sql, adapter, ibm-mobilefirst

我是 Worklight 的新手。我已经从 developerWorks 导入了模块 6.1，开始使用 Worklight 示例[http://www.ibm.com/developerworks/mobile/worklight/getting-started/](http://www.ibm.com/developerworks/mobile/worklight/getting-started/)

我在 javascript“无法获取城市列表。检查数据库连接”中配置的错误中收到错误

有谁知道如何排除故障？“SQLAdapter.xml”中的连接参数非常简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T12:18:54.143

对于到达 MySQL 数据库的 Worklight MySQL 适配器请求，您需要将 mysql-connector-java-5.1.23-bin.jar 添加到您的项目中。

您可以通过以下 URL 下载 MySQL Connector/J 文件：http: [//dev.mysql.com/downloads/connector/j/](http://dev.mysql.com/downloads/connector/j/)

在下拉列表中选择“平台无关”，然后单击 .zip 选项的下载按钮。解压 .zip 文件并将 mysql-connector-java-5.1.23-bin.jar 复制到 yourProject\server\lib。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T16:14:31.803

得到它的工作。似乎我的 Eclipse 安装或 Windows 上的 Java 存在问题。所以我切换回导致我的 Eclipse 和 Java 安装在 IOS 上并且一切正常。此外，IBM 文档还不清楚，但现在我在我的 Project\server\lib 文件夹中使用 mysql-connector-java-5.1.23-bin.jar。

# python - 如何在 Django 中识别 url 中的锚点？

> ID：14885023
> 
> 赞同：2
> 
> 时间：2013-02-14T22:13:26.313
> 
> 标签：python, django, django-urls

我正在制作幻灯片，每张幻灯片都有这样的 url 格式：`articles/1234#slide=5`. 我想`slide=5`从我的 url.py 文件中的 url 中检索部分，然后将其传递给相应的视图函数，最后将其传递给模板并渲染正确的幻灯片。网址设置如下：

```
url(r'^(?P<article_id>\d+)#slide=(?P<current_slide>\d{1,2})$', 'articles.views.show_article') 
```

但它似乎无法`current_slide`从 url 中获取变量。我猜它与锚部分有关，因为它没有传输到服务器。但是，如果我在我的 url 设置中忽略锚部分并使用 javascript 来处理这个标签，似乎每次我在浏览器中输入 url 时，它首先呈现没有锚部分的页面，然后跳转到我想要的正确幻灯片。它无法直接渲染右侧幻灯片。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T22:16:39.840

你在你的问题中碰到了它。URL 的锚点部分不传递给服务器，它仅用于客户端。为什么不使用标准获取参数：

```
articles/1234?slide=5 
```

由于您坚持使用这种 url 格式，您可能想要使用某种动画滚动，这可能会使这不那么烦人，请查看这个问题的答案[jquery smooth scroll to an anchor？](https://stackoverflow.com/questions/4198041/jquery-smooth-scroll-to-an-anchor)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:18:15.397

没有浏览器将“主题标签”发送到服务器。

解决此问题的一种常见方法是让 javascript 在 load/read 上捕获主题标签，并调用一个函数来初始化页面（通过 ajax）。

此外，对此的常用术语是“hashbang url”。如果您搜索该术语，您会发现更多相关信息。

页面跳来跳去，因为 # 用于指向 HTML 规范中的页面锚点。 `http://example.com/gallery/1234#slide5`告诉浏览器转到`slide5`锚点`http://example.com/gallery/1234`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:23:35.243

锚点（# 之后的位）不是匹配的 URL 位的一部分。它们用于页面内的锚点（即链接）。它们通常是为了浏览器的利益（因此浏览器可以滚动到页面的那一点）而不是服务器，但这些天人们似乎在滥用它们。Django 不选择它们并不奇怪，因为它们不被认为是服务器 URL 的有用部分。

这是来自旧版 HTML 规范的文档，但它仍然有效：[http ://www.w3.org/TR/html4/struct/links.html#h-12.2.3](http://www.w3.org/TR/html4/struct/links.html#h-12.2.3)

**怎么做：**

如果您想在您的视图中获取此信息，请查看 Request 对象。查看`request.path_info`或`request.path`。这将为您提供完整的 URL。您可以使用正则表达式从那里提取它。

```
import re

input = "articles/1234#slide=5"

m = re.search("#slide=([0-9]*)", input)
try:
    print int(m.group(1))
except ValueError:
    print "didn't get a number" 
```

正如 Rob 所说，您应该为此使用 get 参数。

# html - 如何使用 CSS 和 HTML 布局列表项，如网格？

> ID：14885026
> 
> 赞同：15
> 
> 时间：2013-02-14T22:13:28.830
> 
> 标签：html, css

*我有一个没有*固定宽度的 div 块。

在里面，我有一个`<ul> <li>..</li>`有 11 个项目的块。我希望将这些`<li>`项目列在 div 中，所有项目的宽度都相同，如下所示：

```
##item##  ##item##  ##item##
##item##  ##item##  ##item##
##item##  ##item##  ##item##
##item##            ##item## 
```

但是，我根本无法解决它。

我试过左右浮动，但中心的 3 个元素不会居中。

我该怎么做才能让它工作？

谢谢！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2014-02-10T13:40:03.313

[Jordan 发布](https://stackoverflow.com/a/14885204/1430996)的[“Inline Blocks”链接](http://blog.mozilla.org/webdev/2009/02/20/cross-browser-inline-block/)是一个很好的资源，尤其是在涉及到旧版浏览器支持时。为了让其他人从 google 登陆此页面的快速参考，用于创建居中的内联块网格的基本 css 是：

```
ul {
    margin: 0 auto;
    text-align: center;
}

li {
    display: inline-block;
    vertical-align: top;
} 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-02-14T22:23:59.227

最简单的解决方案是使用[CSS 列](https://developer.mozilla.org/en-US/docs/Web/CSS/columns)：

[http://jsfiddle.net/6tD2D/](http://jsfiddle.net/6tD2D/)（不包括前缀）

```
ul {
    columns: 3;
}

<ul>
    <li>a</li>
    <li>b</li>
    <li>c</li>
    <li>d</li>
    <li>e</li>
    <li>f</li>
    <li>g</li>
    <li>h</li>
    <li>i</li>
    <li>j</li>
    <li>k</li>
</ul> 
```

这将尽可能平衡列。但是，如果没有足够的元素完全相等，它将开始从右侧而不是中心删除它们。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-14T22:25:17.213

根据[这个](https://stackoverflow.com/questions/2712350/ulcss-for-grid-layout)StackOverflow 问题，[内联块](http://blog.mozilla.org/webdev/2009/02/20/cross-browser-inline-block/)可能正是您所需要的。

哦，如果您还没有实现它，请务必查看[CSS Grids](http://css-tricks.com/dont-overthink-it-grids/)。如果您不想自己构建 CSS 网格，[那么这个](http://cssgrid.net/)非常棒。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-06-14T06:08:09.527

## CSS

```
ul {
  display: grid; 
  grid-auto-columns: 1fr; 
  grid-auto-rows: 1fr; 
  grid-template-columns: 1fr 1fr 1fr; 
  grid-template-rows: 1fr 1fr 1fr 1fr; 
  gap: 0px 0px; 
  grid-template-areas: 
    "col1-item1 col2-item1 col3-item1"
    "col1-item2 col2-item2 col3-item2"
    "col1-item3 col2-item3 col3-item3"
    "col1-item4 col2-item3 col3-item4"; 
}

/* Assign a class to each li */
    /* Column 1 */
.col1-item1 { grid-area: col1-item1; }
.col1-item2 { grid-area: col1-item2; }
.col1-item3 { grid-area: col1-item3; }
.col1-item4 { grid-area: col1-item4; }
    /* Column 2 */
.col2-item1 { grid-area: col2-item1; }
.col2-item2 { grid-area: col2-item2; }
.col2-item3 { grid-area: col2-item3; }
    /* Column 3 */
.col3-item1 { grid-area: col3-item1; }
.col3-item2 { grid-area: col3-item2; }
.col3-item3 { grid-area: col3-item3; }
.col3-item4 { grid-area: col3-item4; } 
```

## HTML

```
<ul>
    <!-- Column 1 -->
    <li class="col1-item1">col1 item 1</li>
    <li class="col1-item2">col1 item 2</li>
    <li class="col1-item3">col1 item 3</li>
    <li class="col1-item4">col1 item 4</li>

    <!-- Column 2 -->
    <li class="col2-item1">col2 item 1</li>
    <li class="col2-item2">col2 item 2</li>
    <li class="col2-item3">col2 item 3</li>

    <!-- Column 3 -->
    <li class="col3-item1">col3 item 1</li>
    <li class="col3-item2">col3 item 2</li>
    <li class="col3-item3">col3 item 3</li>
    <li class="col3-item4">col3 item 4</li>
</ul> 
```

这是小提琴：[https](https://jsfiddle.net/omarjuvera/p3wajehs/2/)
://jsfiddle.net/omarjuvera/p3wajehs/2/你也可以在这里运行代码

```
ul {
  display: grid; 
  grid-auto-columns: 1fr; 
  grid-auto-rows: 1fr; 
  grid-template-columns: 1fr 1fr 1fr; 
  grid-template-rows: 1fr 1fr 1fr 1fr; 
  gap: 0px 0px; 
  grid-template-areas: 
    "col1-item1 col2-item1 col3-item1"
    "col1-item2 col2-item2 col3-item2"
    "col1-item3 col2-item3 col3-item3"
    "col1-item4 col2-item3 col3-item4"; 
}

/* Assign a class to each li */
  /* Column 1 */
.col1-item1 { grid-area: col1-item1; }
.col1-item2 { grid-area: col1-item2; }
.col1-item3 { grid-area: col1-item3; }
.col1-item4 { grid-area: col1-item4; }
  /* Column 2 */
.col2-item1 { grid-area: col2-item1; }
.col2-item2 { grid-area: col2-item2; }
.col2-item3 { grid-area: col2-item3; }
  /* Column 3 */
.col3-item1 { grid-area: col3-item1; }
.col3-item2 { grid-area: col3-item2; }
.col3-item3 { grid-area: col3-item3; }
.col3-item4 { grid-area: col3-item4; }
```

```
<ul>
  <!-- Column 1 -->
  <li class="col1-item1">col1 item 1</li>
  <li class="col1-item2">col1 item 2</li>
  <li class="col1-item3">col1 item 3</li>
  <li class="col1-item4">col1 item 4</li>

  <!-- Column 2 -->
  <li class="col2-item1">col2 item 1</li>
  <li class="col2-item2">col2 item 2</li>
  <li class="col2-item3">col2 item 3</li>

  <!-- Column 3 -->
  <li class="col3-item1">col3 item 1</li>
  <li class="col3-item2">col3 item 2</li>
  <li class="col3-item3">col3 item 3</li>
  <li class="col3-item4">col3 item 4</li>
</ul>
```

# ruby-on-rails - 如何在 Rails 中包含作用域模型？

> ID：14885027
> 
> 赞同：1
> 
> 时间：2013-02-14T22:13:38.617
> 
> 标签：ruby-on-rails, rails-activerecord

如果我只是在查询中包含嵌套模型，这样

```
@projects = current_user.projects.all(include: :reviews) 
```

一切都好。但是 Review 模型有一些范围，我需要在上面的查询中实现。我试试这个

```
@projects = current_user.projects.all(include: :reviews.unreaded) 
```

并得到错误。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:48:56.427

一种选择是根据范围创建关联，大致如下：

```
@projects = current_user.projects.all(include: :unread_reviews) 
```

然后创建一个`unread_reviews`关联，大致：

```
class Project < ...
  has_many :unread_reviews, :conditions => ['read=?', true], :class_name => "Review" 
```

（显然，将上面的内容替换为`has_many`您的协会详细信息。）

该技术在[关联文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#label-Eager+loading+of+associations)中进行了讨论。

# ruby-on-rails - 未定义的方法“redirect_back_or”

> ID：14885035
> 
> 赞同：1
> 
> 时间：2013-02-14T22:14:07.670
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我一直在关注 Michael Hartl 的 Rails 教程，对于那些熟悉的人，我在“第 10 课：更新、显示和删除用户”（使用 LiveLessons 视频版本）。

我想我可能会提到我已经将'redirect_back_or'的def添加到我的sessions_helper中，并将Include SessionsHelper函数添加到我的Applications_controller中。

我希望我们能解决这个问题，我在下面提供了日志。注意：谁能解决这个问题本身就是一个天才，因为在 Stack over flow 上这似乎是一个未解之谜:-)

登录时的错误：

# SessionsController#create 中的 NoMethodError

```
undefined method `redirect_back_or' for #<SessionsController:0x007fdcdf04ba78>

Rails.root: /Users/user/Sites/rails_projects/sample_app1
Application Trace | Framework Trace | Full Trace

app/controllers/sessions_controller.rb:15:in `create'

Request

Parameters:

{"utf8"=>"✓",
 "authenticity_token"=>"/SEaqnrMf5X0pd4FVWbu8uWVAjTNw4LPKiXg+8Hl0PQ=",
 "session"=>{"email"=>"user",
 "password"=>"[FILTERED]"},
 "commit"=>"Sign in"} 
```

## session_conrtoller.rb

```
class SessionsController < ApplicationController

  def new
  end

  def create
    user = User.find_by_email(params[:session][:email])
    if user && user.authenticate(params[:session][:password])
       sign_in user
       redirect_back_or user
    else
       flash.now[:error] = "Invalid email/password combination"
       render 'new'
    end
  end

  def destroy
    sign_out
    redirect_to root_path
  end
end 
```

完整跟踪：

```
pp/controllers/sessions_controller.rb:15:in `create'
actionpack (3.2.11) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.11) lib/active_support/callbacks.rb:414:in `_run__1623305808682769517__process_action__2997016911314885603__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.11) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.11) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.11) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.11) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.11) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.11) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.11) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.11) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.11) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.11) lib/action_dispatch/routing/route_set.rb:601:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.4) lib/rack/etag.rb:23:in `call'
rack (1.4.4) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.4) lib/rack/session/abstract/id.rb:210:in `context'
rack (1.4.4) lib/rack/session/abstract/id.rb:205:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/cookies.rb:341:in `call'
activerecord (3.2.11) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.11) lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `_run__3609576242730521204__call__105225653498443597__callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.11) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.11) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.11) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.11) lib/rails/rack/logger.rb:32:in `call_app'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `block in call'
activesupport (3.2.11) lib/active_support/tagged_logging.rb:22:in `tagged'
railties (3.2.11) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.4) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.4) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.11) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.4) lib/rack/lock.rb:15:in `call'
actionpack (3.2.11) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.11) lib/rails/engine.rb:479:in `call'
railties (3.2.11) lib/rails/application.rb:223:in `call'
rack (1.4.4) lib/rack/content_length.rb:14:in `call'
railties (3.2.11) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.4) lib/rack/handler/webrick.rb:59:in `service'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/usr/local/rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

## 编辑新增内容//应用程序控制器：

```
class ApplicationController < ActionController::Base
  protect_from_forgery
  include SessionsHelper
end 
```

## // 会话助手

```
module SessionsHelper

  def sign_in(user)
    cookies.permanent.signed[:remember_token] = [user.id, user.salt]
    current_user = user
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
     @current_user ||= user_from_remember_token
   end

   def signed_in?
     !current_user.nil? 
   end

   def sign_out
     cookies.delete(:remember_token)
     self.current_user = nil
   end 

   def current_user?(user)
     user == current_user
   end

   def deny_access
     store_location
     redirect_to signin_path, :notice => "Please sign in to access this page." 
   end

   def store_location
     session[:return_to] = request.fullpath

     def redirect_back_or(default)
         redirect_to(session[:return_to] || default)
         clear_return_to
   end

   def clear_return_to
     session[:return_to] = nil
   end

  end

   private

   def user_from_remember_token
     User.authenticate_with_salt(*remember_token)
   end

   def remember_token
     cookies.signed[:remember_token] || [nil, nil]
   end

end 
```

更新：

## 问题已解决，感谢 Beerlington 注意到 Store 定位器连接。+1。

### 这个：

```
 module SessionsHelper

  def sign_in(user)
    cookies.permanent.signed[:remember_token] = [user.id, user.salt]
    current_user = user
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
     @current_user ||= user_from_remember_token
   end

   def signed_in?
     !current_user.nil? 
   end

   def sign_out
     cookies.delete(:remember_token)
     self.current_user = nil
   end 

   def current_user?(user)
     user == current_user
   end

   def deny_access
     store_location
     redirect_to signin_path, :notice => "Please sign in to access this page." 
   end

   def store_location
     session[:return_to] = request.fullpath

     def redirect_back_or(default)
         redirect_to(session[:return_to] || default)
         clear_return_to
   end

   def clear_return_to
     session[:return_to] = nil
   end

  end

   private

   def user_from_remember_token
     User.authenticate_with_salt(*remember_token)
   end

   def remember_token
     cookies.signed[:remember_token] || [nil, nil]
   end

end 
```

### 应该：

```
module SessionsHelper

  def sign_in(user)
    cookies.permanent.signed[:remember_token] = [user.id, user.salt]
    current_user = user
  end

  def current_user=(user)
    @current_user = user
  end

  def current_user
     @current_user ||= user_from_remember_token
   end

   def signed_in?
     !current_user.nil? 
   end

   def sign_out
     cookies.delete(:remember_token)
     self.current_user = nil
   end 

   def current_user?(user)
     user == current_user
   end

   def deny_access
     store_location
     redirect_to signin_path, :notice => "Please sign in to access this page." 
   end

  def store_location
     session[:return_to] = request.fullpath
end 

     def redirect_back_or(default)
         redirect_to(session[:return_to] || default)
         clear_return_to
   end

   def clear_return_to
     session[:return_to] = nil
   end

   private

   def user_from_remember_token
     User.authenticate_with_salt(*remember_token)
   end

   def remember_token
     cookies.signed[:remember_token] || [nil, nil]
   end

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:37:26.270

您的辅助方法应如下所示

```
def redirect_back_or(default)
  redirect_to(session[:return_to] || default)
  session.delete(:return_to)
end 
```

not clear_return_to

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:30:21.857

您已`def redirect_back_or(default)`在 Helper 中定义。您不能像现在这样从控制器访问它。

试试这个来称呼它：`@template.redirect_back_or(...)`或者`@view_contest.redirect_back_or(...)`（其中一个应该可以工作 - 我忘记了哪个是哪个版本的 Rails）。

另一种选择是将该方法移动到控制器中。（更好，国际海事组织）

# python - 在 sqlalchemy 中，当子表对父表有多个外键时，如何使用多态连接表继承？

> ID：14885042
> 
> 赞同：11
> 
> 时间：2013-02-14T22:14:39.070
> 
> 标签：python, inheritance, orm, sqlalchemy, polymorphism

我有一个名为的父表`pbx_point`，它有一`point_type`列。我还有一个名为的子表`pbx_route`，其中有一列名为`point_id`指向`pbx_point`。

我想使用 sqlalchemy 的连接表继承通过声明性基础来关联这两个表，并使用多态继承

这很好用 - 或者更确切地说，如果没有以下附加约束，它会：`pbx_point`还有一个称为`initial_route_id`指向的外键`pbx_route`。

我也在下面使用反射，但数据库就像我上面描述的那样。我得到的错误是`sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'pbx_point' and 'pbx_route'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly.`.

这是有道理的，因为“幕后”描述性基础是在两个映射类上创建一个 relationship() 属性。我希望它选择`pbx_route.point_id`作为 parent_id 链接，但它也可以看到该`pbx_point.initial_route_id`列。如果我正在创建这个关系（），这将很容易解决，但我不是 - 声明式继承系统是。

是否有其他参数可以传递给`__mapper_args__`，例如`polymorphic_parent_col`可以让我指定我想要的外键？如果没有，我该如何解决这个问题？

谢谢。

```
class MyBase(DeferredReflection):
    @declared_attr
    def __tablename__(cls):
        return cls.__name__.lower()

Base = declarative_base(cls=MyBase)

class pbx_point(Base):
    __mapper_args__ = dict(
        polymorphic_on='point_type',
        with_polymorphic='*',
    )

class pbx_route(pbx_point):
    __mapper_args__ = dict(polymorphic_identity='pbx.route') 
```

这是我得到的堆栈跟踪：

```
Traceback (most recent call last):
  File "db.py", line 50, in <module>
    Base.prepare(engine)
  File "env/local/lib/python2.7/site-packages/sqlalchemy/ext/declarative/api.py", line 431, in prepare
    thingy.map()
  File "env/local/lib/python2.7/site-packages/sqlalchemy/ext/declarative/base.py", line 379, in map
    **mapper_args
  File "env/local/lib/python2.7/site-packages/sqlalchemy/orm/__init__.py", line 1147, in mapper
    return Mapper(class_, local_table, *args, **params)
  File "env/local/lib/python2.7/site-packages/sqlalchemy/orm/mapper.py", line 213, in __init__
    self._configure_inheritance()
  File "env/local/lib/python2.7/site-packages/sqlalchemy/orm/mapper.py", line 517, in _configure_inheritance
    self.local_table)
  File "env/local/lib/python2.7/site-packages/sqlalchemy/sql/util.py", line 397, in join_condition
    "join explicitly." % (a.description, b.description))
sqlalchemy.exc.AmbiguousForeignKeysError: Can't determine join between 'pbx_point' and 'pbx_route'; tables have more than one foreign key constraint relationship between them. Please specify the 'onclause' of this join explicitly. 
```

这表明它[在 mapper.py](https://github.com/sqlalchemy/sqlalchemy/blob/rel_1_3_11/lib/sqlalchemy/orm/mapper.py#L1032) * 的第 1032 行死亡。上面几行引用了 mapper kwarg `inherit_condition`，这似乎是我需要的。

[*]：源链接调整为 1.3.11 版本（以前的 URL 现在是 404s）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T19:18:17.213

关键是[`inherit_condition`](https://docs.sqlalchemy.org/en/14/orm/mapping_api.html#sqlalchemy.orm.mapper.params.inherit_condition)映射器的参数。多态信息实际上与这一步没有任何关系。

修正模型：

```
class MyBase(DeferredReflection):
    @declared_attr
    def __tablename__(cls):
        return cls.__name__.lower()

Base = declarative_base(cls=MyBase)

class pbx_point(Base):
    __mapper_args__ = dict(
        polymorphic_on='point_type',
        with_polymorphic='*',
    )
    id = Column(Integer, primary_key=True)

class pbx_route(pbx_point):
    point_id = Column(Integer, ForeignKey(pbx_point.id))
    __mapper_args__ = dict(
        polymorphic_identity='pbx.route',
        inherit_condition=(point_id == pbx_point.id)
    ) 
```

我需要添加`id`和`point_id`列以在`inherit_condition`参数中使用它们。可能有一种方法可以只使用反射来做到这一点，但这并不是一个可怕的障碍。

# sharepoint - SharePoint 内容类型和列表定义之间的区别

> ID：14885047
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:14:54.550
> 
> 标签：sharepoint, sharepoint-2010

我正在观看一些 SharePoint 2010 培训 DVD，讲师刚刚介绍了内容类型和列表定义。我有点失落。在我看来，它们都像是列表模板。MSDN 的解释不是很有帮助。任何人都可以解释其中的区别，或者给我一些你会使用每个例子的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:43:34.043

内容类型是一种结构化数据的方式。例如，可以通过具有内容类型“会议报告”或“销售演示文稿”来组织文档。每种内容类型都定义了适用于该文档类型的特定元数据集，并可能包含一个模板。例如，该模板可以是空的会议报告（Word 文档）。

列表定义是列表或库的蓝图。示例是文档库、图片库、讨论板……列表定义定义了哪些内容类型（可能是多个）在创建时附加到列表/库（用户可以稍后修改）并确定哪些列表视图是默认创建。

自定义列表/库后，您可以从中生成列表模板以供以后重复使用。您可以将其视为用户创建的列表定义。（这不是一个真正的定义，但概念几乎相同。）

# maven - 在多模块 Maven 项目中共享特定的 PMD 规则集

> ID：14885048
> 
> 赞同：4
> 
> 时间：2013-02-14T22:14:57.627
> 
> 标签：maven, checkstyle, pmd

我正在尝试在我的所有子模块中共享相同的 pmd 配置。我正在寻找实现这一目标的最佳方法

我认为我可以将它放在父项目中，就像我为 checkstyle 插件所做的那样

## 父 pom.xml

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-checkstyle-plugin</artifactId>
            <version>2.9.1</version>
            <configuration>
                 <configLocation>/src/main/config/checkstyle.xml</configLocation>
            </configuration>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-pmd-plugin</artifactId>
            <version>2.7.1</version>
            <configuration>
                <rulesets>
                    <ruleset>pmd.xml</ruleset>
                </rulesets>
                <linkXref>true</linkXref>
                <sourceEncoding>${project.build.sourceEncoding}</sourceEncoding>
                <targetJdk>${maven.compiler.target}</targetJdk>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

## 多模块结构

这是我的结构

```
parent
|-- src
|   `-- main
|       `-- resources
|           |-- pmd.xml
|           `-- checkstyle.xml
|-- pom.xml
|-- model
|   `-- pom.xml
`-- webapp
    `-- pom.xml 
```

## 错误

使用此配置，我只会收到以下错误：

```
 [ERROR] Failed to execute goal org.apache.maven.plugins:maven-pmd-plugin:2.7.1:pmd (default-cli) on project model: An error has occurred in PMD Report report generation. Could not find resource 'pmd.xml'. -> [Help 1] 
```

## 解决方案 1

我尝试了这个对我有用的解决方案，因为我在子模块上只有一个级别：但在不久的将来，我可能会有更多级别，所以我不相信这是方法 ${basedir}/../src/main /资源/pmd.xml

## 解决方案 2

在不编写所有解决方案的情况下，我可以使用程序集来压缩我的配置并在我的所有子模块中使用它作为依赖项。这适用于任何级别，但这太过分了！

这里有一个可以解释它的链接：[如何将资源从战争中包含到另一个 Maven 项目中](https://stackoverflow.com/questions/10828754/how-to-include-resources-from-war-to-another-maven-project/10887695#10887695)

所以我正在寻找一个 Maven 技巧，但我不知道什么或如何！欢迎每个建议/线索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:38:29.980

有一个单独的模块，其中包含那些通用配置文件，如构建工具。然后，您可以将此模块作为依赖项添加到您的插件配置并加载它。

我已经在 ksoap2-android 项目的多个模块中使用 checkstyle 配置文件实现了一个示例。

[https://github.com/mosabua/ksoap2-android/blob/master/pom.xml](https://github.com/mosabua/ksoap2-android/blob/master/pom.xml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T22:11:09.110

我正在阅读[规则集标签的文档](http://maven.apache.org/plugins/maven-pmd-plugin/examples/usingRuleSets.html)，它说

> 规则集可能驻留在类路径、文件系统或 URL 中。对于与 PMD 工具捆绑的规则集，您无需指定文件的绝对路径。它将由插件解决。但如果规则集是自定义规则集，则需要指定其绝对路径。

通过在我的父 pom.xml 中指定规则集文件的 URL，我解决了在我的多 maven 构建中共享我的 PMD 设置的问题。（我的仓库是 http 可访问的）。不幸的是，如果您没有可访问的 repo http，这将不起作用，但很多人可以。

# linux - 关于 bash 脚本中的系统时间

> ID：14885053
> 
> 赞同：0
> 
> 时间：2013-02-14T22:15:07.273
> 
> 标签：linux, bash

我正在开始编写一个 bash 脚本，该脚本将在一天中的某个时间关闭我的计算机，但我不确定具体需要什么。有人可以发布一个他们将如何做的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:20:19.823

如果你想每天22:15关机，是root，运行`crontab -e`，然后添加

```
15 22 * * * shutdown -h 5 
```

自己在一条线上。

然后保存。每天 22 点 15 分，您会收到系统将在 5 分钟后关闭的警告，而在 5 分钟后，言归正传，它会关闭。如果要中止关闭，`shutdown -c`请在警告后以 root 身份运行。

# ios - CCMoveTo 不工作，节点/场景问题？

> ID：14885055
> 
> 赞同：0
> 
> 时间：2013-02-14T22:15:15.557
> 
> 标签：ios, objective-c, cocos2d-iphone

我有一个名为 SuccessLayer 的 CCLayer 类。当关卡完成时，它会被添加到场景中，如下所示：

```
SuccessLayer *successLayer = [SuccessLayer node];
[self addChild:successLayer]; 
```

在 SuccessLayer 中，我想飞过去，我试图通过以下方式实现：

```
-(void)onEnter{
    Asteroid *asteroid = [Asteroid spriteWithFile:@"rocks.png"];
    asteroid.position = ccp(0, 500);
    [self addChild:asteroid];
    CCMoveTo *move = [CCMoveTo actionWithDuration:2.0 position:ccp(1000, 0)];
    [asteroid runAction:move];} 
```

但是，它似乎`CCMoveTo`不起作用。我看到精灵坐在它的初始坐标上，但仅此而已。我在这里想念什么？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:13:26.387

[超级 onEnter];

任何 coco 的 onSomething，你都应该超级 onSomething。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T05:48:02.397

通过将其转换为 CCSprite 来解决问题（这是正确的说法吗？）

```
CCSprite *asteroid = [Asteroid spriteWithFile:@"rocks.png"]; 
```

`Asteroid`已经是 CCSprite 的子类，所以我不知道为什么会这样，但它允许我现在对其运行操作。

# jquery - 使用 on() 删除 jQuery 生成的内容

> ID：14885063
> 
> 赞同：1
> 
> 时间：2013-02-14T22:15:48.827
> 
> 标签：jquery

我有一些这样的标记：

```
<div class="large-image">
    <img src="foo.jpg" class="original-size"> <--This persists
    <img src="foo-fullsize.jpg" class="zoomed"> <--injected by jQuery zoom plugin
    <img src="bar-fullsize.jpg" class="zoomed"> <--also injected
</div>

<div class="thumbnails">
    <a href="foo-fullsize.jpg" class="thumb"><img src="foo-thumb.jpg"></a>
    <a href="bar-fullsize.jpg" class="thumb"><img src="bar-thumb.jpg"></a>
</div> 
```

我有一些代码，例如：

```
$(window).load(function() {
   $('a.thumb').click(function(){
      $('#main-image').zoom({url: this.href}); // jQuery zoom
   });
}); 
```

每次我单击拇指链接时，缩放插件都会将新图像注入`<div class="large-image">`容器中。我希望能够在创建新图像之前删除所有具有缩放类的现有图像。我知道我需要使用 on() 来完成此操作，但我似乎无法让它与生成的图像一起使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:18:19.430

这应该这样做：

```
$(window).load(function() {
  $('a.thumb').on('click', function() {
    $('img.zoomed', this).remove(); 
  });
}); 
```

这将删除`.zoomed`与单击的缩略图相关的所有图像。如果要定位`.zoomed`页面上的每个图像，则需要删除上下文：

```
$('img.zoomed'). 
```

* * *

## 编辑

我没有意识到它是生成的内容。试一试：

```
$(window).load(function() {
  $(document).on('click', 'a.thumb', function() {
    $('img.zoomed').remove(); 
  });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:18:18.063

选择器`$('img.zoomed')`将在执行时将所有当前`<img>`元素与`zoomed`类名匹配，而与添加方式无关。

```
$(window).load(function() {
   $('a.thumb').click(function(){
      $('img.zoomed').remove();
   });
}); 
```

* * *

由于 jQuery Zoom 插件在原始图像旁边创建了额外的元素。您应该尝试删除`<img>`下面的所有元素`div.large-image`。

```
$(window).load(function() {
   $('a.thumb').click(function(){
      $('div.large-image img').remove();
   });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:20:40.153

使用jquery`.remove()`方法：

```
$("img[class='zoomed']").remove(); 
```

或者：

```
$("img.zoomed").remove(); 
```

# scala - 调用内部函数？

> ID：14885066
> 
> 赞同：0
> 
> 时间：2013-02-14T22:15:55.173
> 
> 标签：scala

我试图这样调用内部函数......

```
scala> def myouter() = {
     |   def myInner() {
     |     println("In inner now")
     |   }
     |   this
     | }
myouter: ()type

scala> myouter().myInner()
    <console>:9: error: value myInner is not a member of object $iw
          myouter().myInner()
                    ^ 
```

关于我如何实现这一目标的任何提示？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T22:29:16.123

你不能。内部函数对于声明它们的范围是私有的。

# c++ - 二进制文件位操作

> ID：14885068
> 
> 赞同：0
> 
> 时间：2013-02-14T22:16:01.467
> 
> 标签：c++, c, image-processing

我有一个图像数据的二进制文件，其中每个像素**正好是 4 位**。图像数据布局如下：

有 N 个图像，其中第一个图像是 1x1，第二个图像是 2x2，第三个是 4x4，依此类推（如果您想知道它们是 mipmaps）。

给定一个指向数据缓冲区开始的指针，我想跳到最大的图像。

现在我知道我想跳过多少字节，但是开头有一个烦人的 1x1 图像，它是 4 位。无论如何，我都不知道要逐位递增指针。

我怎样才能成功地检索数据而一切都被关闭 4 位？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:28:51.143

假设您可以更改文件格式，您可以执行以下任一操作：

*   为 1x1 图像添加填充
*   以相反的顺序存储图像（实际上与上面相同，但不适用于 mip-map，因为您不一定知道将拥有多少张图像）

如果您无法更改格式，您有以下选择：

*   转换数据
*   接受缓冲区偏移半个字节并相应地使用它

你说：

> 我怎样才能成功地检索数据而一切都被关闭 4 位？

所以这意味着你需要转换。当您以字节为单位计算偏移量时，您会发现第一个包含前一个图像的半个字节。所以在紧要关头，你可以像这样洗牌：

```
for( i = start; i < end; i++ ) {
    p[i] = (p[i] << 4) | (p[i+1] >> 4);
} 
```

假设第一个像素是 4-7 位，第二个像素是 0-3 位，依此类推……如果反过来，只需反转这两个移位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:38:42.427

```
// this assumes pixels points to bytes(unsigned chars)
index = ?;// your index to the pixel

byte_t b = pixels[index / 2];
if (index % 2) pixel = b >> 4;
else pixel = b & 15; 

// Or you can use
byte_t b = pixels[index >> 1];
if (index & 1) pixel = b >> 4;
else pixel = b & 15; 
```

无论哪种方式，只需计算文件的逻辑索引。除以二会将您带到像素所在字节的开头。然后只需读取正确的一半字节。

所以做一个函数

```
byte_t GetMyPixel(unsigned char* pixels, unsigned index) {
  byte_t b = pixels[index >> 1];
  byte_t pixel;
  if (index & 1) pixel = b >> 4;
  else pixel = b & 15; 
  return pixel; 
} 
```

读取第一张图片。

```
Image1x1 = GetMyPixel(pixels,0);

Image2x2_1 = GetMyPixel(pixels,1);// Top left pixel of second image
Image2x2_2 = GetMyPixel(pixels,2);// Top Right pixel of second image
Image2x2_3 = GetMyPixel(pixels,3);// Bottom left pixel of second image
... etc 
```

所以这是解决问题的一种方法。您可能需要考虑您正在使用的字节序，所以如果它看起来错误，那么切换像素读取的逻辑......

```
byte_t GetMyPixel(unsigned char* pixels, unsigned index) {
  byte_t b = pixels[index >> 1];
  byte_t pixel;
  #if OTHER_ENDIAN
  if (index & 1) pixel = b >> 4;
  else pixel = b & 15; 
  #else
  if (index & 1) pixel = b & 15;
  else pixel = b >> 4; 
  #endif
  return pixel; 
} 
```

# c# - 多个按钮调用一个方法

> ID：14885069
> 
> 赞同：0
> 
> 时间：2013-02-14T22:16:02.653
> 
> 标签：c#, asp.net

我正在尝试根据用户选择的六个按钮中的哪一个将 CSS 用户首选项保存到我的数据库中。为了做到这一点，我试图为每个按钮点击事件分配一个整数值；无论单击哪个，都会将相应的整数作为参数传递给我的数据访问对象以更新数据库。

我的方法是这样的：

```
 protected void SetCSS(object sender, EventArgs e)
    {
        Users setCss = new Users();
        if (IsPostBack)
        {
            if (sender.ToString() == "Blue")
            {
                setCss.StylePreference = 0;
            }
            else if (sender.ToString() == "Khaki")
            {
                setCss.StylePreference = 1;
            }
            else if (sender.ToString() == "Night")
            {
                setCss.StylePreference = 2;
            }
            else if (sender.ToString() == "Pink")
            {
                setCss.StylePreference = 3;
            }
            else if (sender.ToString() == "White")
            {
                setCss.StylePreference = 4;
            }
            else if (sender.ToString() == "Yellow")
            {
                setCss.StylePreference = 5;
            }

            setCss.UserLoginName = Session["eMail"].ToString(); // current user
            setCss.SetStylePreference(setCss.UserLoginName, setCss.StylePreference);
        } 
```

在每个按钮的点击事件中：

```
 protected void btnBlue_Click(object sender, EventArgs e)
    {
        SetCSS(btnBlue, null);
    }

    protected void btnKhaki_Click(object sender, EventArgs e)
    {
        SetCSS(btnKhaki, null);
    } 
```

ETC...

I put a watch on the sender object and, when the Pink button is selected, the value assigned to the sender reads {Text="Pink"} However, as I step through the if statement in the SetCSS method, when I come to the else if (sender.ToString() == "Pink") 条件不满足，而不是按照应有的方式将样式偏好设置为 3，程序继续到语句的末尾，最后总是分配一个值0 到属性。

我究竟做错了什么？非常感谢帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:19:17.993

你需要使用`sender.Id.ToString()`

调用`sender.ToString()`ASP.NET 按钮将返回“System.Web.Ui.Button”或类似的东西。

粘贴与您如何设置按钮相关的代码，我将进一步澄清我的答案，因为您可能需要 Id 或 Text，具体取决于您在按钮上设置名称的方式。

实际上，您可以将此代码重构为更简单。

您应该将`Click`所有按钮上的事件映射到`SetCSS()`. 有很多分散的方法来只包装调用是没有用的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:19:10.640

更改 if / else 块以检查 sender.Text

```
if (sender.Text.ToString() == "Blue")
        {
            setCss.StylePreference = 0;
        } 
```

并对其余的语句执行相同的操作。

# excel - Excel VBA 类型不匹配

> ID：14885073
> 
> 赞同：0
> 
> 时间：2013-02-14T22:16:24.137
> 
> 标签：excel, vba

在该行中`If infl > (fc - WC(j)) * dz(j) Then`，我不断收到错误“类型不匹配”，它突出显示了`-`该行。我现在知道什么会导致这个错误？

```
Option Explicit

Dim dz() As Double
Dim WC() As Double
Dim fc() As Double
Dim NL, i As Integer

Dim sumdrain As Double
Dim infl As Double

Sub infilt()
  Dim j As Integer
  j = 1

  While (infl > 0) And (j <= NL)
    If infl > (fc - WC(j)) * dz(j) Then
      infl = infl - (fc - WC(j)) * dz(j)
      WC(j) = fc
    Else
      WC(j) = WC(j) + infl / dz(j): infl = 0
    End If
    j = j + 1
  Wend

  If infl > 0 Then
    sumdrain = sumdrain + infl
    infl = 0
  End If

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:22:07.310

`fc`是一个数组。你不能从中减去。你可能的意思是`fc(something)`。

# blogger - Blogger API 检索使用限制

> ID：14885074
> 
> 赞同：0
> 
> 时间：2013-02-14T22:16:24.467
> 
> 标签：blogger

我正在使用 Google 的博客 API 自动发布博客条目。限制是 50，但是当超过限制时它只会抛出错误。

有没有办法从 50 中检索使用情况，以便我可以在进程失败之前停止进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T11:38:40.850

一种方法是创建一个变量，然后在每个请求中简单地增加它。代码将是这样的：

```
if (numberOfSentRequests<=50) {
    sendBloggerRequest();
} 
```

您也可以使用 try/catch 块。我认为 Blogger API 不会有跟踪请求数量的功能。

# python - Jenkins 可以处理 gui/非 gui 交互式 python 或 java 程序吗？

> ID：14885079
> 
> 赞同：2
> 
> 时间：2013-02-14T22:16:50.213
> 
> 标签：python, jenkins, jenkins-plugins, user-interaction, build-pipeline

我想创建一个构建管道，开发人员需要在属性文件中设置一些东西，该文件使用前端 GUI 填充。

我尝试使用 python 运行示例 CLI 交互式脚本，该脚本只要求输入一个名称并在之后将其打印出来，但 Jenkins 只是等待了很长时间然后就挂了。我看到它要求输入，但用户无法输入数据。

**编辑**：目前将Jenkins作为服务运行..或者有没有人推荐的好插件，或者它是我创建python脚本的方式？

**偏好：** 我更喜欢使用 Python，因为它有点轻量级，但如果人们使用其他语言取得成功，我可以组成。

使用 GUI 菜单来填充数据会很酷，因为我可以使用选项框、下拉菜单并使其变得花哨，但这不是必需的，CLI 比我们当前的部署要好得多。

顺便说一句，在运行 Python 2.7 和 Java 1.7 的 Windows 7 笔记本电脑上运行所有这些

对论文感到抱歉！希望人们可以帮助我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:34:13.650

抱歉，Jenkins 不是交互式应用程序。它是为自动执行而设计的。

获取 Jenkins 作业（以及从该作业执行的所有内容）的输入的唯一可行方法是使用在作业开始*之前*填充的作业参数。诚然，用于参数输入的 Jenkins GUI 不是最好的，但它可以完成这项工作。一旦 Jenkins 作业在作业开始时收集了作业参数，它就可以在作业期间的任何时间将这些参数传递给它执行的任何东西（Python、shell 等）。要做到这一点，必须有两件事是真实的：

*   您需要在作业开始*之前收集所有输入数据*
*   无论您的工作调用什么（Python、shell 等）都需要能够以交互方式而不是通过命令行接收它们的输入。

## 如何获取程序的输入

一个设计良好的脚本应该能够简单地接受命令行上的参数：

`./goodscript.sh MyName`将是最简单的方法，其中值`MyName`将存储在`$1`脚本的第一个参数中。后续命令行参数将在 variables`$2`等中可用`$3`。

`./goodscript.sh -name MyName -age 30`将是一种更好的方法，脚本可以通过在参数值之前指定参数名称来获取多个参数，而不管它们的顺序如何。您可以阅读有关使用[getopt](http://wiki.bash-hackers.org/howto/getopts_tutorial)进行这种参数传递方法的信息

上面的两个示例都假设`goodscript.sh`编写得足够好，能够处理这些命令行参数。如果脚本没有显式处理命令行参数，那么做上面的事情是没有用的。

您可以将一些输出“管道”到一个交互式脚本，该脚本并非旨在显式处理命令行参数：
`echo MyName | ./interactivescript.sh`将值传递给提供给用户`MyName`的第一个交互式提示。`interactivescript.sh`这样做的问题是您只能将值传递给第一个交互式提示。

## Jenkins 作业参数 GUI

就像我上面说的，您可以使用 Jenkins GUI 来收集各种作业参数（下拉列表、复选框、文本输入）。我假设您知道如何使用参数设置 Jenkins 作业。如果没有，请在作业配置中单击**“此构建已参数化”**复选框。如果您不知道如何设置，那就是另一个问题，需要单独解释。

但是，一旦您的 Jenkins 作业预先收集了所有参数，您就可以在**“执行 shell”**步骤中引用它们。如果您使用的是 Windows，则将它们称为`%PARAM_NAME%`，而对于 Linux，则称为`$PARAM_NAME`.

解释你需要什么帮助：让你的脚本接受命令行参数，或者从詹金斯作业 GUI 传递这些命令行参数，我将进一步扩展这个答案

# ios - Phonegap 2.3 watchposition ios 后台数据上传到服务器

> ID：14885080
> 
> 赞同：0
> 
> 时间：2013-02-14T22:16:52.537
> 
> 标签：ios, cordova, upload, geolocation, position

我为 IOS 创建了一个 phonegap 应用程序来跟踪用户的位置。此时可以在后台使用它。但是，如果我想将这些数据上传到服务器，它只会在应用程序处于前台时工作。

当应用程序在后台时，是否可以在后台调用 js 函数或以其他方式将这些数据以连续的间隔传输到 REST 服务器？

关于这个问题我已经搜索了很多次，但我并不是说过去没有人遇到过。我阅读了很多关于电话间隙插件的信息，但不明白如何创建对我有帮助的。

对不起，我的英语不好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:58:15.967

简而言之，没有 - IOS 仅对 3rd 方应用程序进行有限的后台处理。

您可以使用 VOIP 应用程序或使用推送通知获得有限的后台处理，但我想这不适合您

# node.js - npm peerDependency 问题与 grunt 和 flatiron peer

> ID：14885084
> 
> 赞同：28
> 
> 时间：2013-02-14T22:17:02.217
> 
> 标签：node.js, npm, gruntjs, nodejitsu

*在发布这个问题时，我想出了答案，但我会在这里发布，以防它帮助其他人，也许有人可以帮助了解发生的**原因**。*

当我运行时：

```
sudo npm install -g grunt 
```

它的最后一部分说：

```
/usr/bin/grunt -> /usr/lib/node_modules/grunt/bin/grunt
npm ERR! peerinvalid The package flatiron does not satisfy its siblings' peerDependencies requirements!
npm ERR! peerinvalid Peer flatiron-cli-config@0.1.3 wants flatiron@~0.1.9
npm ERR! peerinvalid Peer flatiron-cli-users@0.1.1 wants flatiron@~0.1.9

npm ERR! System Linux 3.5.0-23-generic
npm ERR! command "nodejs" "/usr/bin/npm" "install" "-g" "grunt"
npm ERR! cwd /home/explunit
npm ERR! node -v v0.8.19
npm ERR! npm -v 1.2.9
npm ERR! code EPEERINVALID
npm ERR! 
npm ERR! Additional logging details can be found in:
npm ERR!     /home/explunit/npm-debug.log
npm ERR! not ok code 0 
```

正如您在上面看到的，我在节点 0.8.19 和 npm 1.2.9 上（来自 Ubuntu 12.10 上的 ppa:chris-lea 的最新版本）。

我尝试过的其他事情：

*   在全新的 Ubuntu 安装上做了同样的事情。没有错误。在最后几个错误行之前，脚本输出看起来是一样的。
*   跑“sudo npm cache clean”并再次尝试。没运气。
*   跑“npm list”，没有其他列出

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-02-14T22:17:02.217

我的错误是没有在 npm list 命令上附加 -g 。

```
npm list -g 
```

一旦我这样做了，我就看到了我的全局安装模块列表（例如 bower、jshint、mocha），最后：

```
npm ERR! peer invalid: flatiron@0.3.0 /usr/lib/node_modules/jitsu/node_modules/flatiron
npm ERR! not ok code 0 
```

然后我运行这个命令来查看哪些正在使用 flatiron：

```
npm list -g flatiron 
```

在这种情况下，它是 jitsu，一个我不再使用的模块。我跑了

```
sudo npm uninstall -g jitsu
sudo npm uninstall -g grunt 
```

然后再次运行原始命令。*[请注意稍后提出此问题的任何人：在0.4 发布](http://gruntjs.com/blog/2013-02-18-grunt-0.4.0-released)**后全局重新安装 grunt 命令行的正确模块是 now ，不像我问原始问题时那样。`grunt-cli``grunt`*

如果我真的想保留 jitsu，我可以更新它而不是卸载它（感谢@BenAtkin）：

```
npm install -g jitsu 
```

然后再次运行原始命令。有关更多背景信息，请参阅[有关在节点 0.8.19 中添加 peerDependency 的博客文章。](http://blog.nodejs.org/2013/02/07/peer-dependencies/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-20T06:50:03.687

如果您不介意安装 jitsu，您可以升级 jitsu，这应该可以。

```
npm install -g jitsu
npm install -g grunt-cli 
```

# mercurial - Mercurial：我怎样才能只在本地保存东西？

> ID：14885086
> 
> 赞同：0
> 
> 时间：2013-02-14T22:17:08.957
> 
> 标签：mercurial, mercurial-queue, mercurial-extension

我们对允许放入中央 Mercurial 存储库的内容有一些限制。

有什么方法可以将东西保存在本地 Hg 存储库中，而无需将其推送到中央存储库？

笔记：

1.  这些文件可能连接到中央存储库（例如分支）中的文件。
2.  本地的东西以后可能会被合并到中央存储库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:50:46.817

如果您使用分支，则可以将其可见性设置为`secret`. 这将防止他们被推动。

```
hg phase --secret --force my-branch 
```

当您想分享时，您将它们的阶段更改为`draft`，然后它们将在推送操作期间自动收集。

有关`hg help phases`更多信息，请参阅。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:03:37.803

您也可以使用[Mercurial Queues](http://mercurial.selenic.com/wiki/MqExtension)。使用 MQ，您可以使用补丁（它们是变更集）并根据官方存储库中的更改更新或重新排序它们。这也将使您更容易将部分或全部更改合并到主存储库中，或者稍后丢弃它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:21:08.243

提交到本地仓库，完成后推送到远程仓库。

您也可以推送到您的本地仓库，但据我了解，这就是您当前的发展所在？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T22:32:05.753

我想你想要[Shelve Extension](http://mercurial.selenic.com/wiki/ShelveExtension)或[Attic Extension](http://mercurial.selenic.com/wiki/AtticExtension)。

另一种选择是，如果您使用具有更好分支的较新 Hg，您可以在 bitbucket 之类的某个地方分叉中央存储库，并将其用作临时内容的存储库，并可能对其进行分支。

最后，您也可以只使用`.hgignore`，但稍后当有人签入具有相同名称的文件时可能会出现问题。

# java - Java社交网络节点集合解决方案

> ID：14885090
> 
> 赞同：3
> 
> 时间：2013-02-14T22:17:20.607
> 
> 标签：java, collections, social-networking

Java 有点新。我之前非常成功地使用过各种 Java 集合（treeset、hashmap、arraylist）。我的问题类似于类似 Facebook 的网络。我在会员组织中有各种用户，我想为我们会员中的每个人存储一个集合，这些其他成员通过兴趣链接到该成员。我认为最简单的解决方案是为每个具有其他成员名称（现有或新）链接的成员按名称动态分配一个新的简单集合，但似乎 Java 不允许动态分配新集合。

我可以在哈希图中有一个串联的字符串，列出与键名关联的所有名称，但这似乎是一个错误的解决方案。我认为这是一个社交常见的类似网络的问题，有一个优雅的解决方案。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:21:24.463

为什么不将其建模为图形？

```
class Node {
    private String name;
    // TODO: Write your getters / setters.
}

class Edge {
    private Edge source, destination;
    // TODO: Write your getters / setters.
}

List<Node> nodes = new ArrayList<Node>();
List<Edge> edges = new ArrayList<Edge>(); 
```

然后，如果您遇到关系，您可以执行以下操作：

```
Node alice = new Node("Alice Kentucky");
if (!nodes.contains(alice)) { nodes.add(alice); }
edges.add(new Edge(bob, alice)); // where Bob is already in the node list 
```

# java - 递归查找树/最深节点的高度

> ID：14885093
> 
> 赞同：1
> 
> 时间：2013-02-14T22:17:32.680
> 
> 标签：java, algorithm, tree

任何人都可以通过使用递归深度优先搜索来帮助我找到树的高度吗？即找到最深的分支节点？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:27:45.937

伪代码：

**dfs( v )** :
**1.visited** [ v ] = true
**2.** max_child_depth = 0
**3\. 对于每个**u st 都有边 (v,u)
        **如果**未访问 [u]
        **那么**max_child_depth = max( max_child_depth, dfs( u ))
**4 . 返回**max_child_depth + 1

# python - Python - 字符串索引必须是整数

> ID：14885094
> 
> 赞同：0
> 
> 时间：2013-02-14T22:17:33.987
> 
> 标签：python, json, string

如果这是基本修复和帖子的长度，我深表歉意，但我是 Python 新手。出于上下文目的，我还包含了大部分脚本。

我正在使用脚本将扫描数据从 JSON 提取到 MySQL 数据库中。在发布更新之前，该脚本运行良好。

现在，当我运行脚本时，我收到错误：

结果在 resultc['response']['results']: TypeError: string indices must be integers

在此更新之前，我知道每个值的数据类型，但这已经改变，我无法确定在哪里。有没有办法将每个值转换为字符串？

```
# Send the cumulative JSON and then populate the table
cumresponse, content = SendRequest(url, headers, cumdata)
resultc = json.loads(content)
off = 0
print "\nFilling cumvulndata table with vulnerabilities from the cumulative database. Please wait..."
for result in resultc['response']['results']:
    off += 1
    print off, result
    cursor.execute ("""INSERT INTO cumvulndata(
offset,pluginName,repositoryID,
severity,pluginID,hasBeenMitigated,
dnsName,macAddress,familyID,recastRisk,
firstSeen,ip,acceptRisk,lastSeen,netbiosName,
port,pluginText,protocol) VALUES 

(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s,(FROM_UNIXTIME(%s)),%s,%s,(FROM_UNIXTIME(%s)),%s,%s,    %s,%s)""" , (off,result["pluginName"],result["repositoryID"]),result["severity"]),
result["pluginID"]), result["hasBeenMitigated"]),result["dnsName"],
result["macAddress"],result["familyID"]),result["recastRisk"]),
result["firstSeen"],result["ip"],result["acceptRisk"],result["lastSeen"],
result["netbiosName"],result["port"],result["pluginText"],result["protocol"])) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:20:01.330

将其放在 for 循环之前以找出哪个对象是字符串（我猜它可能是第二个）

```
print type(resultc)
print type(resultc['response']) 
```

# ruby-on-rails - ActionMailer 观察者不工作

> ID：14885098
> 
> 赞同：1
> 
> 时间：2013-02-14T22:17:56.333
> 
> 标签：ruby-on-rails, actionmailer, observer-pattern

我定义了一个 ActionMailer Observer 并且它没有被调用。我该如何解决这个问题？导轨 3.1.3，红宝石 1.9.2。或者，我想要一个在从某个 ActionMailer 子类发送电子邮件时调用的方法。这是我能找到的唯一干净的实现方式（我可以从 ActionMailer 子类中的每个邮件方法调用一个方法，但这不是很干）。欢迎任何其他关于如何实现这一点的建议。

```
config/initializers/mail_observer.rb:
  class MailObserver
    def self.delivered_email(message)
      require 'ruby-debug' ; debugger
      user = User.find_by_email(message.to[0])
      if user
        email_type = caller[1]
        UserMailerLogging.create!(user_id: @user.id, email_type: email_type, contents: self.body)
      end
    end
  end

  ActionMailer::Base.register_observer(MailObserver)

app/mailers/user_mailer:
  class UserMailer < ActionMailer::Base
    default from: "no-reply@testing.com"
    ...
    def unfinished_setup(user)
      @user = user
      mail to: user_email(user), subject: "Testing..."
    end
    ...
  end 
```

而且，在 Rails 控制台中：

```
irb(main):001:0> UserMailer.unfinished_setup(User.find(1))    
=> #<Mail::Message:70192154395900, Multipart: false, Headers: <From: no-reply@testing.com>, <To: Test User<user@testing.com>>, <Subject: Testing...>, <Mime-Version: 1.0>, <Content-Type: text/plain>> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:56:08.673

我相信在你真正传递信息之前，观察者不会开火。您在 rails 控制台中的代码只是创建电子邮件，而不是发送它。添加`.deliver`到最后应该传递消息并执行观察者代码。

# html - 边距规则如何应用于不在 DOM 流中的元素？

> ID：14885101
> 
> 赞同：8
> 
> 时间：2013-02-14T22:18:06.813
> 
> 标签：html, css, browser

所以我问了这个问题： google chrome issue with fixed position and [margin-top](https://stackoverflow.com/questions/14883333/google-chrome-issue-with-fixed-position-and-margin-top)这最终让我意识到这不是一回事。我不知道这些年来我是怎么错过的。`top``margin-top`

无论如何，这让我思考和之间到底有什么区别`margin-top`，`top`这就是我发现这个问题的方式：[CSS：Top vs Margin-top](https://stackoverflow.com/questions/4036176/css-top-vs-margin-top)。

我已经知道做了什么`margin-top`。但我从来没有推断出这样的想法“嗯，这个元素不在 DOM 流中，那么究竟是什么`margin-top`将它推开？”

从我问的问题中，我知道`margin-top`当应用于具有`fixed`位置的元素时，它的行为方式非常出乎意料。至少在 Chrome 中，这可能会导致一些疯狂的规则（如`margin-top: -273%;`）。

所以我的问题是：浏览器如何将*规则*`margin`应用于不在 DOM 流中的元素（即`position`值为`fixed`or的元素`absolute`。以及它们的应用和呈现方式如何导致规则，就像上面描述的那样，实际呈现元素*在*视口内？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:45:40.957

该`top`属性只是确定框模型应该开始渲染的距离包含元素的顶部多远。在 的情况下`position: fixed`，那是窗口本身。在 的情况下`position: absolute`，它是具有非静态位置的下一个父元素。

另一方面，边距是盒子模型本身的一部分。在框的顶部添加边距会增加框上方的空白空间。

* * *

考虑一个`position: fixed`盒子的以下层：

```
 top:10px
            margin-top:10px
------------border-top:1px------------
           padding-top:10px
  content 
```

所有的边距、边框和内边距都是盒子模型的一部分。定位时，整个元素或“一块”只是一个大正方形。因此，如果您在框的顶部有 10px 的边距，并且将元素放置在距离顶部 10px 的位置，那么它将在窗口顶部和可见框开始的位置之间具有 20px 的边距。

我还在[jsFiddle 中做了一个非常简单的例子](http://jsfiddle.net/ZQsQQ/)。

* * *

如果您喜欢图形，请看这个例子，红色框有一个`position: fixed`：

![视觉示例](../Images/929d96669f592feb2374799a527d8e67.png)

正如您在第一部分中看到的那样，*仅对*元素进行设置`position: fixed`实际上不会将其移动到任何地方。它只是将其从文档流中删除。

在 section 部分中，添加 a`margin-top: 10px`会使元素*向下移动*10px，因为框现在顶部有 10px 的边距。但是，**它实际上并没有移动到任何地方**。盒子刚刚变高了，因为盒子模型已经改变了。

在第三部分中，使用 a`top: 10px` **实际上将框移动**到距离窗口容器顶部 10px 的位置。它具有与第一部分完全相同的盒子模型。

第四部分与上面的第二部分类似，除了负边距导致它向上移动十个像素。盒子模型仍然更高，盒子仍然没有移动。

* * *

当您在元素上设置绝对位置时，**如果您不设置任何其他位置属性，则该元素根本不会移动**。因此，如果没有`top`、`right`、`bottom`或`left`属性集，元素将保持在它作为流的一部分呈现时的位置，现在它刚刚从流中移除。因此，添加一个边距，无论是正数还是负数，都会使其看起来从该位置向上或向下移动。实际上，您只是在更改元素的盒子模型。

您还必须意识到，在顶部和底部边距（甚至填充）上使用百分比**与高度无关**。它实际上使用**宽度**来计算有多少边距。说`margin-top: 10%`将使该值成为可用宽度的 10%，而不是可用高度，并将其设为负只会否定该值。我提到这一点是因为它与您在使用百分比的位置链接的第一个问题相关`margin-top`。

我希望这涵盖了您正在寻找的内容。我不知道你*到底*对什么感到困惑，所以我只是尽可能多地解释。

# r - R使用值列表作为色标

> ID：14885107
> 
> 赞同：5
> 
> 时间：2013-02-14T22:18:17.617
> 
> 标签：r, colors, plot, scale

我想将变量的值表示为 R 中散点图的颜色。

```
x <- rnorm(100) + 5
y <- rnorm(100) + 5
plot(x, y) 
```

在这里，我想使用一个变量作为着色的输入。但如果我尝试

```
plot(x, y, col = x) 
```

我得到了一些奇怪的东西，可能很明显。现在我可以像这样得到我想要的：

```
x_norm = (x - min(x)) / (max(x) - min(x))
col_fun <- colorRamp(c("blue", "red"))
rgb_cols <- col_fun(x_norm)
cols <- rgb(rgb_cols, maxColorValue = 256)
plot(x, y, col = cols) 
```

![在此处输入图像描述](../Images/9d3416b79838447edb7fb31a42a49611.png)

但这似乎有点复杂，并且要使其与 NA 或 NaN 值一起使用，例如通过将它们赋予黑色作为颜色，并不是那么容易。为了我。有没有一种我忽略的简单方法可以做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T22:23:35.890

您应该使用[`cut`](http://stat.ethz.ch/R-manual/R-patched/library/base/html/cut.html)将 x 分成间隔并`colorRampPalette`创建固定大小的调色板：

```
x <- rnorm(100) + 5
y <- rnorm(100) + 5
maxColorValue <- 100
palette <- colorRampPalette(c("blue","red"))(maxColorValue)
plot(x, y, col = palette[cut(x, maxColorValue)]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T15:55:22.440

您可以使用预定义的灰度颜色`gray0`，...，`gray99`如下所示：

```
x <- rnorm(100) + 5
y <- rnorm(100) + 5
x.renormed <- floor(100*((x-min(x))/(diff(range(x))+1e-2)))
colors.grayscale <- paste("gray",x.renormed,sep="")
plot(x, y, col=colors.grayscale, bg=colors.grayscale,pch=21) 
```

结果：

![灰度散点图](../Images/b2c3b5260df0d77beba4acaad0b263f1.png)

# c# - NHibernate 左外连接名称到地址

> ID：14885110
> 
> 赞同：2
> 
> 时间：2013-02-14T22:18:19.070
> 
> 标签：c#, nhibernate

我对 NHibernate 有点陌生，我在尝试加入两个表时遇到了问题。我有一个姓名表和地址表。无论地址记录是否返回任何结果，我都想提取名称记录。如果我在下面的代码中有地址记录有效，但是一旦地址记录被删除，我将不再收到姓名记录。我正在尝试这个（[NHibernate Left Outer Join](https://stackoverflow.com/questions/2756148/nhibernate-left-outer-join)），但它对我不起作用。有任何想法吗？

**映射：**

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping 
    xmlns="urn:nhibernate-mapping-2.2" 
    namespace="Portlet.IncomingStudentInfo.Data.BusinessObjects" 
    assembly="Portlet.IncomingStudentInfo">
    <class name="ISINameMasterRecord" table="NAME_MASTER">
         <id name="NM_ID_NUM" column="ID_NUM" type="Int32">
            <generator class="native" />
        </id>
        <property name="NM_ID_NUM" column="ID_NUM" />
        <property name="NM_EMAIL_ADDRESS" column="EMAIL_ADDRESS" />
        <property name="NM_MOBILE_PHONE" column="MOBILE_PHONE" />
        <many-to-one name="LHP" class="ISILHPAddress" 
            column="ID_NUM" fetch="join" 
            foreign-key="ID_NUM" 
            outer-join="true" not-found="ignore" />
    </class>

    <class name="ISILHPAddress" table="ADDRESS_MASTER">
        <composite-id>
            <key-property name="AD_ID_NUM" column="ID_NUM" type="Int32" />
        </composite-id>
        <property name="AD_ID_NUM" column="ID_NUM" />
        <property name="AD_ADDR_CDE" column="ADDR_CDE" />
        <property name="AD_ADDRESS" column="ADDR_LINE_1" />
        <property name="AD_CITY" column="CITY" />
        <property name="AD_STATE" column="STATE" />
        <property name="AD_ZIP" column="ZIP" />
        <property name="AD_PHONE" column="PHONE" />
    </class>   
</hibernate-mapping> 
```

**正面：**

```
public class ISINameMasterRecordFacade : JICSBaseFacade<ISINameMasterRecord>
{
    public ISINameMasterRecord FindIDCriteria(int id)
    {
        ICriteria criteria = this.CreateCriteria();
        criteria.Add(Expression.Eq("NM_ID_NUM", id));

        criteria.CreateAlias(
            "LHP", 
            "lhp", 
            NHibernate.SqlCommand.JoinType.LeftOuterJoin);
        criteria.Add(
            Expression.Or(
                Expression.IsNull("lhp.AD_ADDR_CDE"), 
                Expression.Eq("lhp.AD_ADDR_CDE", "*LHP")));

        return criteria.UniqueResult<ISINameMasterRecord>();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T15:06:06.023

感谢大家对此的帮助。我正在与另一位开发人员交谈，他提供了以下答案，这确实有效。以下是有关该问题的一些附加信息。NAME_MASTER 表保存主键为 ID_NUM 的记录的名称信息。ADDRESS_MASTER 表包含一条记录的所有地址，主键为 ID_NUM 和 ADDR_CDE（它们的地址类型是：合法居住地、电子邮件、夏季地址等）。记录可能没有 *LHP（合法居住地地址），但可能有其他地址记录。无论*LHP 地址记录是否存在，我们都想拉取 NAME_MASTER 记录，所以这实际上是连接的另一个条件。下面正在工作，无论 ADDRESS_MASTER 中是否存在 *LHP 记录，都将提取 NAME_MASTER 记录。

**映射.hbm.xml**

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" namespace="Portlet.IncomingStudentInfo.Data.BusinessObjects" assembly="Portlet.IncomingStudentInfo">
  <class name="ISINameMasterRecord" table="NAME_MASTER">
    <id name="NM_ID_NUM" column="ID_NUM" type="Int32">
      <generator class="native" />
    </id>
    <property name="NM_ID_NUM" column="ID_NUM" />
    <property name="NM_EMAIL_ADDRESS" column="EMAIL_ADDRESS" />
    <property name="NM_MOBILE_PHONE" column="MOBILE_PHONE" />

    <bag name="Addresses" cascade="all" where="ADDR_CDE='*LHP'" lazy="false" fetch="join">
      <key column="ID_NUM"/>
      <one-to-many class="ISILHPAddress"/>
    </bag>
  </class>

  <class name="ISILHPAddress" table="ADDRESS_MASTER" lazy="false">
    <id name="AD_ID_NUM" column="ID_NUM" type="Int32">
      <generator class="native" />
    </id>
    <property name="AD_ID_NUM" column="ID_NUM" />
    <property name="AD_ADDR_CDE" column="ADDR_CDE" />

    <property name="AD_ADDRESS" column="ADDR_LINE_1" />
    <property name="AD_CITY" column="CITY" />
    <property name="AD_STATE" column="STATE" />
    <property name="AD_ZIP" column="ZIP" />
    <property name="AD_PHONE" column="PHONE" />
  </class>

</hibernate-mapping> 
```

**ISINameMasterRecordFacade.cs**

```
public ISINameMasterRecord FindIDCriteria(int id)
        {
            ICriteria criteria = this.CreateCriteria();
            criteria.Add(Expression.Eq("NM_ID_NUM", id));

            return criteria.UniqueResult<ISINameMasterRecord>();
        } 
```

**ISINameMasterRecord.cs**

```
public class ISINameMasterRecord : EXBase
    {
        public virtual int NM_ID_NUM { get; set; }
        public virtual String NM_EMAIL_ADDRESS { get; set; }
        public virtual String NM_MOBILE_PHONE { get; set; }

        public virtual ISILHPAddress LHP
        {
            get { return Addresses != null && Addresses.Any() ? Addresses[0] : null; }
            set
            {
                if (Addresses == null)
                    Addresses = new List<ISILHPAddress>();

                if (Addresses.Any())
                    Addresses[0] = value;
                else
                    Addresses.Add(value);
            }
        }

        //for mapping purposes
        protected virtual IList<ISILHPAddress> Addresses { get; set; }

        public ISINameMasterRecord()
        {

        }
    } 
```

**ISILHPAddress.cs**

```
public class ISILHPAddress : EXBase
    {
        public virtual int AD_ID_NUM { get; set; }
        public virtual String AD_ADDR_CDE { get; set; }
        public virtual String AD_ADDRESS { get; set; }
        public virtual String AD_CITY { get; set; }
        public virtual String AD_STATE { get; set; }
        public virtual String AD_ZIP { get; set; }
        public virtual String AD_PHONE { get; set; }

        public ISILHPAddress() { }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T16:23:34.247

在您的映射中使用`fetch="join"`将导致地址急切加载左外连接。我不认为这`outer-join="true"`是一个有效的属性。如果`not-found="ignore"`外键无效（即如果 ID_NUM 存在但地址表中不存在记录），则可以防止 NHibernate 引发异常。

因为您已设置`fetch="join"`为急切加载地址，

```
ISession.Get<ISINameMasterRecord>(id); 
```

将使用左外连接返回对象和地址。如果地址不存在，则该地址将为空。

可能导致问题的一件事是您已将 AD_ID_NUM 映射为复合键。这似乎没有必要。

# java - 使用全局 onCLickListener

> ID：14885111
> 
> 赞同：0
> 
> 时间：2013-02-14T22:18:19.693
> 
> 标签：java, android, onclicklistener

是否可以将 onClickListener 应用程序设为全局？

我基本上有几个片段将使用相同的数字键盘按钮进行输入，而不是为每个片段中的每个按钮注册和过滤点击事件，我想问是否可以在整个应用程序中共享一个 onClickListener。

这是设置：

```
public class LoginFragment extends Fragment {

  @Override
  public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle states) {
    this.context = getActivity();

    // TODO: Register onClickListener...somehow

    context.registerReceiver(receiver, filter); //For the intent listening
    view = inflater.inflate(R.layout.layout_login_screen, container, false);
    buildUI(null);
    return view;
  } 
```

（以及与此类似的两个不同片段）

然后的想法是：

```
public class NumPadListener implements OnClickListener {

  @Override
  public void onClick(View v) {
    System.out.println("Yup...I'm listening?");

    // TODO: Do funny intent stuff here
  }

} 
```

这甚至可能吗？如果是，如何？:) 如果不是，您对如何以最佳方式实现这一点有任何建议吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:36:57.957

是的，正如 dymmeh 所展示的那样。但正确的方法可能是创建自己的包含所有小键盘按钮的视图组件。您需要定义一个布局文件，并创建一个可以扩展某种类型的类`ViewGroup`（请参阅[复合控件](http://developer.android.com/guide/topics/ui/custom-components.html#compound)）。

这个自定义组件将处理其中按钮的 onClick 事件。然后，如果您需要它们对更高级别的事件做出反应，您可以为要附加的活动和片段公开某种接口（侦听器）。

然后，您只需将自定义组件包含在您需要的任何布局中，而不是复制粘贴一堆按钮和 onClick 侦听器附加代码。

# c# - Windows Media Player 对象 c# - 播放缓冲区值

> ID：14885112
> 
> 赞同：0
> 
> 时间：2013-02-14T22:18:22.900
> 
> 标签：c#, windows, buffer, windows-media-player

我想在通过无线链接在网络上流式传输视频时查看当前的播放缓冲区值，

我找不到任何可以做到这一点的软件，所以我决定编写一个可以显示当前缓冲区大小的小应用程序。

我已经将一个 Windows 媒体播放器对象放在一个表单中，该对象从我指定的 URL 播放视频，有没有办法显示当前缓冲区大小以播放视频？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:27:26.603

您可以使用`bufferingProgress`以下代码访问该属性：

```
int progressPercent = axWindowsMediaPlayer1.network.bufferingProgress; 
```

IWMPNetwork 接口 [http://msdn.microsoft.com/en-us/library/windows/desktop/dd563492(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd563492(v=vs.85).aspx)

# objective-c - 在 cellForRowAtIndexPath 之外更新 detailTextLabel？

> ID：14885113
> 
> 赞同：1
> 
> 时间：2013-02-14T22:18:32.860
> 
> 标签：objective-c, uitableview, ios6, reloaddata, detailtextlabel

我正在使用具有可重用原型的动态单元格，并且始终在 cellForRowAtIndexPath 中设置单元格。

对于其中一个单元格，我想多次更新详细文本标签（正在运行测试，我想在每个阶段发生时更新用户）。

这可能吗？

我试过这个：

detaillabel 当前设置为“statusText”的值，开始时为空白。我的想法是使用委托，将字符串传递给它，然后重新加载表数据，但这不起作用。

目前我有：

状态更改时的代码：

```
[self currentStatus:@"Speed Test Initialized"]; 
```

当前状态方法：

```
- (void) currentStatus:(NSString *)status {

    [statusDelegate currentStatus:status];
    statusText = status;
    NSLog(@"Current status: %@", statusText);
    [self.tableView reloadData];
} 
```

现在 statusText 等于我希望单元格在重新加载时更新的值，但事实并非如此。

有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:29:26.893

我对此进行了简化，还需要将我的 tableview 重新连接为 IB 插座！这解决了这个问题。

# entity-framework - 实体框架 - MVC 4 - 存储库架构

> ID：14885114
> 
> 赞同：1
> 
> 时间：2013-02-14T22:18:34.400
> 
> 标签：entity-framework, asp.net-mvc-4

我想知道是否有人可以给我一些关于我的存储库代码的输入，并对我如何改进代码提出任何建议？下面我将包括存储库类和控制器。另外，如果我想在列表顶部插入一个值，有什么好的方法呢？

```
 public static List<ChartApp> ListApplications()
    {
        using (var db = new LatencyDBContext())
        {
            var appNames = db.LoginApplications.Select(item => new ChartApp()
              {
                  LoginApplicationID = item.LoginApplicationID,
                  LoginAppName = item.LoginAppName,
              });
            return appNames.ToList();
        }
    } 
```

并且，控制器：

```
 var listApps = LoginApplicationRepository.ListApplications().OrderBy(item => item.LoginAppName);

        var myCharts = new ChartsViewModel();
        myCharts.AppsForChart = listApps.ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:12:21.127

首先，代码的结构对我来说看起来不错，OrderBy 可以在存储库中完成 - 特别是如果列表通常应按 LoginAppName 排序。不需要在控制器中的 listApps 上调用 ToList()，因为这已经在存储库中完成，所以 listApps 已经是一个列表。

要在列表的开头插入一个项目，请使用 Insert 方法，例如：

```
listApps.Insert(0, newAppItem); 
```

# java - 用于排序和返回数组的java程序

> ID：14885120
> 
> 赞同：-4
> 
> 时间：2013-02-14T22:18:56.223
> 
> 标签：java, arrays, sorting

所以我正在处理的代码看起来像这样

```
import java.util.Scanner;
public class ReadStrings{
public static String main(String[] args) {
Scanner in = new Scanner(new File("input3.txt"));
String [] array = new String[100];
int nextSpot = 0;

while( in.hasNext()){
  array[nextSpot++] = in.next();
}
//use the sort function
selectionSort(array, nextSpot);
//print the results

}

public static void selectionSort(String [] array, int nextSpot){
  String tmp;
  for (int i = 0; i < nextSpot; i++) {
    for (int j = i + 1; j < nextSpot; j++) {
      if( array[i].equals(array[j])){
        tmp = array[i];
        array[i] = array[j];
        array[j] = tmp;
      }
    }
  }
}
} 
```

假设文本文件存在我的代码有问题吗？我也不知道如何打印结果数组

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:31:06.780

你的问题**不清楚**。我假设您想将结果打印到文件本身。您可以`BufferedWriter`像这样使用类：

```
BufferedWriter writer = new BufferedWriter(new FileWriter(new File("input3.txt"))); 
```

并使用它的`write()`方法打印数组。

不过，您可能想检查您的[selectionSort()](http://www.leepoint.net/notes-java/data/arrays/31arrayselectionsort.html)。

# jquery - 彩盒上的彩盒

> ID：14885121
> 
> 赞同：1
> 
> 时间：2013-02-14T22:18:59.000
> 
> 标签：jquery, jquery-plugins, colorbox

假设我有以下链接：

```
<p><a class='iframe' href="iframe.html">Outside Webpage (Iframe)</a></p> 
```

和脚本：

```
$(".iframe").colorbox({iframe:true, width:"800px", height:"600px"}); 
```

在那`iframe.html`我有另一个颜色框链接：

```
<a class="group1" href="../content/ohoopee1.jpg">Grouped Photo 1</a> 
```

：

```
$(".group1").colorbox({rel:'group1', width:"800px", height:"600px"}); 
```

现在第二个颜色框内容显示在第一个颜色框内容中。颜色框是“嵌套的”：

![在此处输入图像描述](../Images/f391fc9d86ba60461f1592c3f8c2a466.png)

从该 iframe 调用的颜色框是否可能会弹出第一个颜色框。我想覆盖第一个颜色框，并在第二个颜色框关闭时再次显示它。

希望你明白我想要达到的目标，因为我不是英语母语，解释我的目标似乎有点复杂。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T07:27:30.900

您不能将其弹出第一个，因为在文档中只能打开一个颜色框实例，您只能替换第一个。要在关闭第二个时重新打开第一个，您必须编写一个简短的脚本来替换 colorbox 的 close 方法，以便它采取不同的操作。

# android - 以编程方式添加到自定义视图中的 AttributeSet

> ID：14885122
> 
> 赞同：0
> 
> 时间：2013-02-14T22:19:00.577
> 
> 标签：android, android-view, android-custom-view

我编写了一个自定义视图，它覆盖了 onMeasure() 和 onLayout() 来完成一项非常具体的任务，忽略了某些属性，如 layout_height 和 layout_width。由于指定这些属性不再有意义，我想在我的布局 XML 中省略它们。但如果我这样做，我会收到异常说属性是必需的：

```
RuntimeException: Binary XML file line #49: You must supply a layout_width attribute. 
```

有没有办法不再需要某些必需的属性？

我打算在我的视图的构造函数中尝试以编程方式添加这些属性，但 AttributeSet 似乎只有检索值的方法，而不是设置它们。我研究了是否可以使用 attrs.xml 找到解决方案，但没有看到任何有希望的东西。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T06:33:41.800

为了结束这个问题，我将继续总结到目前为止的讨论，以及一些额外的见解。

简单地说，layout_width 和 layout_height 应该总是被设置，不管它们是否被它们设置的视图所尊重。即使 Android 提供的忽略这些属性的视图仍然需要在布局 XML 中设置它们。

当布局膨胀时，自定义视图是在引发验证异常之前构建的。当我记录提供给 View 的构造函数的 AttributeSet 类时，我看到它是一个 XmlBlock$Parser。我相信我可以通过转换 AttributeSet 并调用 setProperty() 来设置一个虚拟的 layout_height 和 layout_width 值，从而允许验证成功而无需在 XML 中指定这些属性。 **但是**，该方法假定所提供的 AttributeSet 始终是特定实现，适用于所有情况和所有 Android 版本。

# c++ - 将值存储在链表中的结构中

> ID：14885133
> 
> 赞同：0
> 
> 时间：2013-02-14T22:19:40.730
> 
> 标签：c++, list, parsing, pointers

我想知道如何将值存储到作为结构链接列表一部分的结构中。我有：

```
struct polynomial
{
    polynomial(string newCoefficient, string newPower, polynomial *nextPtr);
    string coefficient;
    string power;
    polynomial *next; 
};

class linkedList
{
public:
    void createList();

private:
    polynomial *head;
}; 
```

对于这个赋值，我们需要在收集输入值时进行一些解析。例如，我们要输入两个用空格隔开的数字（例如 7 9 或 10 8）。因此，在 void createList() 中，我想使用字符串读取一行，将其转换为 char 数组以剥离值，然后将该值存储到链表中每个节点的 polynomial.coefficient 和 polynomial.power .

或者，我正在搜索一些信息，我在想也许我可以输入两个 int 值，然后使用 stringstream 将它们转换为字符串并将它们存储为系数和幂。

无论哪种方式，您能帮我介绍一下将值存储到链接列表结构中的概念吗？

编辑：我添加了重载的构造函数：

```
polynomial:: polynomial ( string newCoefficient, string newPower, polynomial *nextPtr )
{
    coefficient = newCoefficient;
    power = newPower; 
    next = nextPtr; 

}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:58:54.440

您将 C 风格的练习与 C++ 的练习混合在一起。

在 C++ 中，您通常将数据与容器分开。看看效果如何`std::list`。

即使你不想进入模板，你仍然可以这样做：

```
struct polynomial {
   string coefficient;
   string power;
};

struct listnode {
   polynomial data;
   listnode *next;
}; 
```

如果您真的想拥有这个`head`概念，您可以保留一个“假头”，在其中存储一个`listnode`没有任何内容的头。

或者，如果你真的想要`next`指针`polynomial`并且你想要一种方法来复制现有元素而不用核对指针，只需创建一个 setter 函数：

```
void polynomial::set( const string& inCoeff, const string & inPower ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:43:47.917

我测试了以下代码，可能会对您有所帮助：

```
struct Polynomial {
        string coefficient;
        string power;
        Polynomial* next;

        Polynomial(const string& coeff, const string& pow) : coefficient(coeff), power(pow), next(NULL) {}
};

// linked-list of Polynomials
struct LinkedList {
    Polynomial* head;

    LinkedList() : head(NULL) {}

    // add to end of list        
    void add(const string& coeff, const string& pow) {
        if(head == NULL)
            head = new Polynomial(coeff, pow);
        else {
            Polynomial* n;
            for(n = head; n->next != NULL; n = n->next);
            n->next = new Polynomial(coeff, pow);
        }
    }

    // check if results are correct
    void print() {
        for(Polynomial* n = head; n != NULL; n = n->next)
            cout << n->coefficient << " " << n->power << endl;
    }
};

// somewhere in main()
LinkedList ll;
...
// read input values
ll.add(coeff1, pow1);
ll.add(coeff2, pow2);
ll.add(coeff3, pow3);
// check results
ll.print(); 
```

请注意，您的多项式结构成员不必是字符串。相反，您可以只解析您的输入并将其存储`cofficient`为`float`和存储`power`（`int`所有多项式指数都是整数）。

# java - Java BMP 头文件

> ID：14885134
> 
> 赞同：1
> 
> 时间：2013-02-14T22:19:45.103
> 
> 标签：java, image, header, bitmap, bmp

我尝试从 BufferedImage 制作 BMP 文件。这是我尝试在 bmp 文件中写入标题和像素的功能。

我有一个错误，但我找不到。我需要你的帮助。

```
static void writeToBMP(BufferedImage img, String name)
{
    //File header
    int bfType = 0x424d;
    int bfSize = (img.getHeight()*img.getWidth()*3)+54; // File size
    short bfReserved1 = 0; // Reserved
    short bfReserved2 = 0;
    int bfOfBytes = 54; // Header size

    //Header info
    int biSize = 40; // Header 2 size
    int biWidth = img.getWidth(); // Width in pixels
    int biHeight = img.getHeight(); // Height in pixels
    short biPlanes = 1; // Nr of planes
    short biBitCount = 24; // Nr bites per pixel
    int biCompression = 0;
    int biSizeImage = (img.getHeight()*img.getWidth()*3); // Image size
    int biXPelsPerMeter = 0;
    int biYPelsPerMeter = 0;
    int biClrUsed = 0;
    int biClrImportant = 0;

    File file = new File(name);

    try {
        OutputStream stream = new FileOutputStream(file);
        fOut = new DataOutputStream(stream);
        fOut.writeShort(bfType);
        fOut.writeInt(bfSize);
        fOut.writeShort(bfReserved1);
        fOut.writeShort(bfReserved2);
        fOut.writeInt(bfOfBytes);

        //Write Header Info
        fOut.writeInt(biSize);
        fOut.writeInt(biWidth);
        fOut.writeInt(biHeight);
        fOut.writeShort(biPlanes);
        fOut.writeShort(biBitCount);
        fOut.writeInt(biCompression);
        fOut.writeInt(biSizeImage);
        fOut.writeInt(biXPelsPerMeter);
        fOut.writeInt(biYPelsPerMeter);
        fOut.writeInt(biClrUsed);
        fOut.writeInt(biClrImportant);
        for(int x=0; x<img.getWidth(); x++)
        {
            for(int y=0; y<img.getHeight(); y++)
            {
                Color c = new Color(img.getRGB(x,y));
                fOut.writeByte(c.getRed());
                fOut.writeByte(c.getBlue());
                fOut.writeByte(c.getGreen());
            }
        }
        fOut.close();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

我试图只写标题，标题大小 = 54 字节。

我不知道我计算的 bfSize 和 biSizeImage 是否正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:24:13.453

尝试使用 ImageIO

```
File outImage = new File(name);
ImageIO.write(img, "bmp", outImage); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T18:43:38.923

要解决我的问题，我需要使用 LITTLE_ENDIAN 字节顺序。为此，我使用：

```
 ByteBuffer buffer = ByteBuffer.allocate(54);
    buffer.putInt(bfSize);
    buffer.putShort(bfReserved1);
    buffer.putShort(bfReserved2);
    buffer.putInt(bfOfBytes);
    buffer.putInt(biSize);
    buffer.putInt(biWidth);
    buffer.putInt(biHeight);
    buffer.putShort(biPlanes);
    buffer.putShort(biBitCount);
    buffer.putInt(biSizeImage);
    buffer.putInt(biXPelsPerMeter);
    buffer.putInt(biYPelsPerMeter);

    buffer.order(ByteOrder.LITTLE_ENDIAN);
    buffer.flip(); 
```

# php - 在我自己的类中运行 mysqli 准备语句

> ID：14885135
> 
> 赞同：0
> 
> 时间：2013-02-14T22:19:54.540
> 
> 标签：php, class, mysqli, inner-classes, prepare

有一个类似的主题（[How to access mysqli connection in another class on another page?](https://stackoverflow.com/questions/11113080/how-to-access-mysqli-connection-in-another-class-on-another-page)）但它并没有完全回答我的问题，或者我错过了重点。我正在尝试构建一个类，它允许我通过从数据库中提取一组图像 url 和 div id 来快速构建幻灯片的骨架。这是我所管理的：

```
 class make_slide 
  {
    private $slide_mysqli;
    public $get_slide;
    public $single_slide;
    public $get_imgurl1; 
    public $get_imgurl2; 
    public $get_imgurl3; 
    public $get_imgurl4; 
    public $get_imgurl5; 
    public $get_imgid1; 
    public $get_imgid2; 
    public $get_imgid3; 
    public $get_imgid4; 
    public $get_imgid5; 

    function __construct(){
    $this->slide_mysqli = new mysqli('localhost','user', 'password','database') or die($this->mysqli->error);
    }

    function get_slides ($page) 
    {
      if ($this->get_slide = $this->slide_mysqli->prepare('SELECT IMAGE_URL1, IMAGE_URL2, IMAGE_URL3, IMAGE_URL4, IMAGE_URL5, IMAGE_ID1, IMAGE_ID2, IMAGE_ID3, IMAGE_ID4, IMAGE_ID5 FROM Page WHERE ID=? AND IMAGE_URL1 != NULL')) 
      {
        $this->get_slide->bind_param('s', $page);
        $this->get_slide->bind_result($this->get_imgurl1, $this->get_imgurl2, $this->get_imgurl3, $this->get_imgurl4, $this->get_imgurl5, $this->get_imgid1, $this->get_imgid2, $this->get_imgid3, $this->get_imgid4, $this->get_imgid5); 
        $this->get_slide->execute();
        $this->get_slide->store_result();         
        $this->get_slide->fetch();
        $this->get_slide->free_result();
        $this->get_slide->close();  
      }
      //print the slideshow out here... for example
      print '<br><img src="http://***.com/'.$this->get_imgurl1.'" alt="'.$this->get_imgid1.'" height="200"/></div>';
      print '<br><img src="http://***.com/'.$this->get_imgurl1.'" alt="'.$this->get_imgid2.'" height="200"/></div>';

    }
  } 
```

所以现在如果我运行以下命令，班级将为我完成所有工作：

```
 $slide = new make_slide();
  $slide->get_slides('home'); 
```

只是它在打印图像，但忽略了我从数据库中提取的内容。我检查了错误日志，我被告知

> PHP 注意：使用未定义的常量 IMAGE_ID5 - 在 /var/www/ ***/*** .com/httpdocs/index.php 中的第 216 行假定为“IMAGE_ID5”，引用者：http://***.com/index.php

拜托，关于我做错了什么的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T06:26:57.523

答案很简单：除非您不打算使用准备好的语句或将自己限制在初学者手册中非常简单的语句，否则**不要使用 mysqli 。**
mysqliprepared statements 的任何复杂用法，比如在你自己的类中使用它**都是一场噩梦。**

请改用 PDO。
使用 PDO ALL，您的代码将采用一个小功能：

```
function get_slides ($page) 
{
    global $pdo;
    $pdo->prepare('SELECT * FROM Page WHERE ID=? AND IMAGE_URL1 != NULL');
    $stm = $pdo->execute(array($page));
    $row = $stm->fetch();
    foreach ($row as $img) {
        print "<br><img src='http://***.com/$img' alt='$img' height='200'/></div>";
    }
} 
```

但是，正如您在评论中被告知的那样，您的错误与您在此处发布的代码无关。

# r - 使用 R 进行磁盘空间预测

> ID：14885136
> 
> 赞同：0
> 
> 时间：2013-02-14T22:19:50.753
> 
> 标签：r, prediction

```
I have 2 vectors 
days = c(1, 2, 3, 4, 5, 6, 7)
pct_used = c(22.3, 22.1, 22.1, 22.1, 55.660198413, 56.001746032, 55.988769841)

fit <- lm(days ~ poly(pct_used,2,raw=TRUE))
prediction <- predict(fit, data.frame(pct_used=85))
days_remain <- (prediction - tail(days,1)) 
```

pct_used 基本上是磁盘空间。所以这段代码预测磁盘空间何时达到 85。
返回的预测值为 325。我觉得这很奇怪。这是否意味着需要 325 天才能达到 pct_used = 85 ？
我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:57:27.070

试试这个看看发生了什么：

```
plot(pct_used, days)
lines(pct_used, predict(fit 
```

![在此处输入图像描述](../Images/361c857a06533050c730531985c81242.png)

```
plot(pct_used, days, xlim=c(min(pct_used), 85) ,ylim= c(-50,350))
lines(seq(min(pct_used), 85, length=50), predict(fit, newdata=data.frame( 
                                        pct_used=seq( min(pct_used), 85, length=50)))) 
```

![在此处输入图像描述](../Images/a1a1e26694702fb5eaf13de422653eca.png)

# mysql - mySQL - 与此 SELECT 查询匹配相同记录的 INSERT 查询？

> ID：14885137
> 
> 赞同：0
> 
> 时间：2013-02-14T22:19:56.377
> 
> 标签：mysql

我有一个选择查询，用于在我的数据库中挑选一段时间未联系的联系人。我想运行一个 INSERT 查询，为使用此选择查询返回的所有记录输入一个重复的注释...问题是我不完全确定该怎么做。

SELECT 查询本身可能有点复杂。我基本上希望选择每个合作伙伴的最新注释，然后只选择在某个日期并没有收到注释的合作伙伴...... SELECT 查询如下：

```
SELECT * FROM
(
SELECT * FROM
(
SELECT
partners.partners_id,
partners.CompanyName,
notes.Note,
notes.DateCreated
FROM
notes
JOIN
partners ON notes.partners_id = partners.partners_id
ORDER BY notes.DateCreated DESC
) AS Part1
GROUP BY partners_id
ORDER BY DateCreated ASC
) AS Part2
WHERE
DateCreated <= '2013-01-15' 
```

如何运行只进入与此 SELECT 相同的记录的 INSERT 查询？

插入将输入以下记录：

```
INSERT INTO notes
(
notes_id,
partners_id,
Note,
CreatedBy,
DateCreated
)
SELECT
UUID(),
partners.partners_id,
'Duplicated message!',
'User',
'2013-02-14'
FROM
partners 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:25:35.303

如果您想在 SQL 中完成这一切，您可以使用 UPDATE 语句。

```
UPDATE tablename SET note='duplicate' where id in ( your statement here); 
```

请注意，为了使其工作，'id' 需要是来自 'tablename' 的列。然后，您的语句必须返回单列，而不是 *。返回的列必须是让您的更新语句知道要在“表名”中更新哪些行的 id。

# linux - SSL 的透明代理问题

> ID：14885142
> 
> 赞同：0
> 
> 时间：2013-02-14T22:20:23.827
> 
> 标签：linux, ssl, openssl, transparentproxy

我在私有区域中有一个 RHEL5 服务器。我为端口 80 和 443 设置了透明代理。当我在 443 上尝试 wget 时，我得到以下信息：

```
# wget -O- https://www.google.com
  --2013-02-14 15:16:50--  https://www.google.com/
  Resolving www.google.com... 74.125.129.147, 74.125.129.104, 74.125.129.106, ...
  Connecting to www.google.com|74.125.129.147|:443... connected.
  OpenSSL: error:140770FC:SSL routines:SSL23_GET_SERVER_HELLO:unknown protocol
  Unable to establish SSL connection. 
```

我认为代理可以工作，因为它正在连接。我不知道还有什么可能导致这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T22:38:35.573

此 OpenSSL 错误表明`wget`发送了初始 SSL ClientHello 消息，但从服务器（或代理）获得了非 SSL ServerHello 消息的意外响应。

这可能是因为代理与客户端使用纯 HTTP 而不是 HTTPS，因为配置错误（例如，如果端口 443 被重定向到 a`http_port`而不是`https_port`透明选项，则使用 squid），或者因为它不支持透明代理完全没有 SSL。要调试，您可以尝试连接到`http://www.google.com:443/`以查看会发生什么。要知道发生了什么，您可能希望`tcpdump`在连接时运行以查看服务器响应的内容。还要检查透明代理的错误日志。

如果没有透明代理配置，很难说出问题所在。

# ruby - 如何告诉 STDIN 停止阅读？

> ID：14885143
> 
> 赞同：1
> 
> 时间：2013-02-14T22:20:24.887
> 
> 标签：ruby

所以我正在研究用 Ruby 构建很棒的命令行应用程序。在第 81 页，我们应该使用 STDIN 将多个任务输入到项目中。

```
 File.open(global_options[:filename], 'a+') do |todo_file|
  if task_names.empty?
    puts "Reading new tasks from stdin..."
    task_names = STDIN.readlines.map {|a| a.chomp}
  end
  tasks = 0
  task_names.each do |task|
    todo_file.puts [task, Time.now].join(', ')
    tasks+=1
  end
  if tasks == 0
    raise "You must provide tasks on the command-line or standard input"
  end
end 
```

将任务输入项目的常用方法是这样的，`$todo new "Rake leaves`但是使用上面的代码，我们可以了解下面示例中的内容。

它确实有效。但是我如何告诉 STDIN 停止收听？如何使用它的示例是这样的......

```
$ todo new
Rake leaves
Take out trash
Clean garage
Put away dishes
^D 
```

代表什么`^D`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:25:30.943

这是一个[文件结束符](https://en.wikipedia.org/wiki/End-of-file)。您可以在 Unix 系统上使用`Ctrl`+`D`或在 Windows 上使用`Ctrl`+逐字键入`Z`。显示`Ctrl`修饰符的传统方式是使用`^`前缀，例如`^D`.

请注意，这会完全关闭标准输入。如果您想在输入这些行后读取更多数据，则需要检查输入本身是否有不同的分隔符，例如空行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T22:25:22.597

您可以通过在类 Unix 系统上按 Ctrl-d 或在 Windows 上按 Ctrl-z 来关闭 STDIN。

> ^6 代表什么？

你确定它说`^6`而不是`^d`？如果是这样，那可能是一个错字。

# vb.net - 除非用户查看过，否则标签页上的 VB.Net datagridview 不会返回行数

> ID：14885149
> 
> 赞同：1
> 
> 时间：2013-02-14T22:20:50.793
> 
> 标签：vb.net, datagridview, tabcontrol, rowcount

我有一个选项卡控件。tabcontrol 上的每个tabpage 都包含一个datagridview。这些是以编程方式创建的。

后来我从 datagridviews 读取值并将它们写入 Word 文档。

如果用户点击了标签页，datagridview 会报告其正确的行数。

如果用户没有查看标签页，datagridview .rowcount = 0

**我可以做些什么来强制 datagridview 反映其实际行数吗？**

我使用以下代码导航到包含按名称 (tcPlanFeeTab) 的 datagridview 的选项卡：

```
 For Each tp As TabPage In frmSvcFee.tcPlanFee.TabPages
            'find the fee tab
            If tp.Text = tcPlanFeeTab Then 'this is the fee tab
                'select the tp so the datagridview is activated
                tp.Select()
                For Each ctl As Control In tp.Controls  'find the datagridview on the rates tab
                    If TypeOf ctl Is DataGridView Then
                        Dim D As DataGridView = ctl
                        MessageBox.Show(D.RowCount) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:13:24.020

没有办法（据我所知）在显示网格之前强制网格完成数据绑定。

这是 DataGridView 本身的优化。

最好的办法是转而使用底层数据源。

# r - 错误：找不到函数“单位”

> ID：14885150
> 
> 赞同：78
> 
> 时间：2013-02-14T22:20:53.817
> 
> 标签：r, ggplot2

在尝试修改主题设置时，这个简单的代码会出现以下错误：

```
library(ggplot2)
theme_nogrid <- theme_set(theme_update(  
                  plot.margin=unit(c(.25, .25, .25, .25), "in"),))

Error in do.call(theme, list(...)) : could not find function "unit" 
```

`R`对于使用“单位”的任何元素，都会给我这个错误。任何其他不称为“单位”的设置都可以正常工作。我正在运行 R v.2.15.2（64 位 Windows）。

我在网上广泛搜索了这个问题，但一无所获。我很感激对这个问题的任何建议。

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2013-02-14T23:07:24.037

[这与ggplot2 不再支持的 arrow()](https://stackoverflow.com/questions/14677035/arrow-in-ggplot2-no-longer-supported)密切相关，但并不完全相同，它表示：

> [the] `grid`[package] 由以前的版本自动加载`ggplot[2]`（使 `grid`功能对用户可见/可访问）；现在它通过导入来引用，因此如果您想使用函数（或 [to] 查看它们的帮助页面），则`NAMESPACE`需要显式加载。`grid``grid`

这里的“显式加载”是指`library("grid")`或`require("grid")`（`grid`是一个基础包，所以不需要单独安装）。

`unit()`是`grid`包中的一个函数，所以上面的答案（大约`arrow()`）适用。

或者，您可以指定`grid::unit(...)`或`grid::arrow(...)`不明确加载整个包。

# java - 找不到符号 java

> ID：14885156
> 
> 赞同：1
> 
> 时间：2013-02-14T22:21:16.453
> 
> 标签：java, jsf

我试图让用户在两个选项之间进行选择，然后在 `aset.add(MediaSizeName.ISO_A4);`

我有一个页面，用户在 a3 和 a4 之间进行选择，但是我无法传递这个变量，好像我尝试`aset.add(MediaSizeName.variable);`得到错误一样`cannot find symbol`，即使它已经声明`public String paperSize;`并且在用户提交值时传递，基本上怎么能我使用变量来更改`.ISO`位？

谢谢

编辑

```
<p:selectOneMenu value="#{printerSettings.paperSize}">
    <f:selectItem itemValue="ISO_A5" itemLabel="A5" />
    <f:selectItem itemValue="ISO_A4;" itemLabel="A4" />
    <f:selectItem itemValue="ISO_A3" itemLabel="A3" />
</p:selectOneMenu> 
```

以上是用户选择尺寸的地方

现在我传递值：

```
<p:commandButton type="submit"
    action="#{printInTen.countDown(printerSettings.t, printerSettings.p, printerSettings.paperSize)}"
    onclick="Thankyou()" value="Print" /> 
```

并试图传递价值`paperSize`

```
public String paperSize;
    public String orienation;

    public void countDown(int t, int p, String paperSize) {

 System.out.println("Now setting up attributes such as page size");
        System.out.println ("Copies " + p);
        aset.add(new Copies(p)); //having issues, will not work currently although code is fine// NOW WORKING :D
        aset.add(MediaSizeName.paperSize);// will not let me use the variable here, 
        aset.add(Sides.DUPLEX);
        aset.add(OrientationRequested.PORTRAIT); 
```

`aset.add(MediaSizeName.paperSize);`但无论我尝试什么，我传递的变量值在我得到错误时都不起作用 `cannot find symbol`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:34:50.703

```
if (paperSize.equals("ISO_A3")) {
    aset.add(MediaSizeName.ISO_A3);
} else if (paperSize.equals("ISO_A4")) {
    ....
} 
```

# vim - 隐藏关键字没有任何效果

> ID：14885158
> 
> 赞同：1
> 
> 时间：2013-02-14T22:21:27.313
> 
> 标签：vim

`has('conceal') == 1`我正在尝试为以前定义为 的单词设置隐藏（仅限 vim 7.3， if ） `keywords`，但关键字似乎无法隐藏。干净缓冲区中的最小示例：

```
:set cole=2
:set ft=none
:syntax keyword Function foo baz qux
:syntax match Function "foo" conceal cchar=%
:syntax match Function "bar" conceal cchar=& 
```

现在，如果您键入`foo bar`并移至下一行，您应该会看到`foo &`. 我怎样才能让它显示出来`% &`？

如果答案是您无法隐藏关键字，是否有可靠地定义多个关键字的替代方法？在我的用例中，我有大约 5k 个关键字，但我希望隐藏的只有大约 10-20 个。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:37:53.543

`conceal``keyword`参数也可以用于

替换这一行：

```
:syntax match Function "foo" conceal cchar=% 
```

和

```
:syntax keyword Function foo conceal cchar=% 
```

你可以得到你想要的。

希望能帮助到你

# javascript - javascript - 将函数转换为变量

> ID：14885168
> 
> 赞同：1
> 
> 时间：2013-02-14T22:22:12.050
> 
> 标签：javascript, variables, scope

我用谷歌搜索了一下，似乎我要么不知道我在问什么，要么这是不可能的。我想应该是前者吧。

如果我有一个对象

```
obj = {
  func : function(){
    return 'hello';
  }
} 
```

我通常会做`alert(obj.func())`我当然得到`"hello"`

但是，如果我只想`obj.func`成为一个变量，那有可能吗？我永远不会将参数传递给函数，我只想将其返回值作为普通变量引用`alert(obj.func)`，而不是函数调用。

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T22:24:09.923

试试这个 ：

```
obj = {
  func : (function(){
    return 'hello';
  })()
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:24:46.517

是的，这很容易！

```
var obj = {
  func :  'hello'
};

alert(obj.func); 
```

看到这个工作[小提琴](http://jsfiddle.net/XyxGM/)

如果您希望它是计算值或某事。你仍然可以让它成为一个函数，但可以像一个简单的属性一样调用：

```
var obj = {
  func :  (function(){return 'hello';})()
}; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T23:00:47.910

你在说的是一个 getter ：它是一个作为属性工作的函数。它是自 javascript 1.8.5 以来的标准，这意味着旧浏览器将无法处理它。
语法如下，使用您的示例：

```
obj = {
   get func() {  return "hello" ; }
};
// use like this :
console.log(obj.func); 
```

您很可能还想定义一个 setter：这也是一个行为类似于属性的函数。语法将是：

```
obj = {
    get func()    { return this._innerText ; },
    set func(txt) { this._innerText = txt  ; },
    _innerText  : "hello" 
};

console.log(obj.func) ;   // output is hello
obj.func = "godd bye" ;
console.log(obj.func) ;   // output is good bye 
```

显然，就像通常的简单示例一样，这个没有太大用处：

让我们看看使用 getter / setter 的角度到弧度的转换器：

```
 var Angle = {
        get degree ()        { return this._degree ; },
        set degree (dg)      { this._degree = dg   ; },
        get radian ()        { return 2*Math.PI*this.degree/360 ; },
        set radian (rd)      { this._degree = rd * 360 / (2*Math.PI) ; },
        _degree  : 0
} ;
// you can use :
Angle.radian = Math.PI / 2;
console.log ( Angle.degree );    // -->> output is 90
Angle.degree=45 ;
console.log(Angle.radian) ;      // --> output is 0.7853... which is PI/4 
```

您还可以查看 Object.defineProperty，它允许定义标准属性和 getter/setter，但有更多选项，尤其是“隐藏”属性的选项，它允许不枚举它。

更多信息：
[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/get](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/get) [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/set](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/set) [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/defineProperty)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-14T22:24:48.460

```
 var varFunc = function() { alert("hello"); }
    varFunc(); 
```

# build - 如何获取使用 hadoop1 分类器构建的 MRUnit 1.0.0-SNAPSHOT jar？

> ID：14885169
> 
> 赞同：0
> 
> 时间：2013-02-14T22:22:24.470
> 
> 标签：build, hadoop, mrunit

MRUnit 的最新版本是 0.9。此版本不支持 DistributedCache。这个[https://issues.apache.org/jira/browse/MRUNIT-98](https://issues.apache.org/jira/browse/MRUNIT-98)显示 1.0.0 支持 DistributedCache。我想获得一个为 hadoop1 构建的 MRUnit 1.0.0 jar，但我找不到。所以我尝试自己构建它，但是 maven repo 中缺少所需的 jar。

这是我正在使用的命令： `mvn package -DenvClassifier=hadoop1 -DspecificHadoopVersion=1.0.3`

它因依赖错误而失败。我可以手动获取所需的 jar，但我不知道如何让构建使用它们。

我怎样才能得到我想要的 jar（或者自己构建，或者下载它）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:31:06.207

在我发布问题后，我发现了这一点。

答案很简单。签出 hadoop1 分支，并构建它：

```
$ git checkout -b local/trunk-hadoop1 remotes/origin/trunk-hadoop1
$ mvn package 
```

# mysql - MySQL 奇数连接问题

> ID：14885170
> 
> 赞同：0
> 
> 时间：2013-02-14T22:22:24.610
> 
> 标签：mysql

我*有*以下代码：

```
select DB.T1.ID,
DB.T1.B,
DB.T1.C,
DB.T2.ID,
DB.T2.B,
DB.T2.R,
DB.T3.ID,
DB.T3.Q
DB.T1.DUP,
DB.T2.DUP,
DB.T3.DUP
from DB.T1, DB.T2, DB.T3
where DB.T1.id = DB.T2.ID
and DB.T1.id = DB.T3.ID
and DB.T2.id = DB.T3.id
and DB.T1.DUP = 'not_duplicate'
and DB.T2.DUP = 'not_duplicate'
and DB.T3.DUP = 'not_duplicate'
; 
```

但是，输出返回 0 行。因此，我将每个表中“DUP”列的值从重复/不重复更改为 0/1。我尝试了这段代码并且它有效：

```
select DB.T1.ID,
DB.T1.B,
DB.T1.C,
DB.T2.ID,
DB.T2.B,
DB.T2.R,
DB.T3.ID,
DB.T3.Q
DB.T1.DUP,
DB.T2.DUP,
DB.T3.DUP
from DB.T1, DB.T2, DB.T3
where DB.T1.id = DB.T2.ID
and DB.T1.id = DB.T3.ID
and DB.T2.id = DB.T3.id
and DB.T1.DUP = 1
and DB.T2.DUP = 1
and DB.T3.DUP = 1
; 
```

第二个代码完美运行，第一个返回 0 行。有谁知道为什么会这样？值“not_duplicate”和“duplicate”是与我导入数据库的 csv 完全相同的字符串。我无法解释为什么会这样，我真的很好奇。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:26:39.407

因为他们在 DUP 列中没有这个`not_duplicate`字段。他们有 1 然后它与您的查询不匹配。

查询返回存储在 DUP 列中的值。

# python - 检查时间跨度之间的重叠

> ID：14885188
> 
> 赞同：5
> 
> 时间：2013-02-14T22:24:21.073
> 
> 标签：python, python-2.7

我有一个时间条目列表（HHMM 格式），其中包含开始时间和停止时间。我无法弄清楚如何在 Python 中对其进行编码，如果列表中有重叠，它会返回哪里。

例子

```
条目 1：1030、1245；
条目 2：1115、1300
== 真

条目 1：0900、1030；
条目 2：1215、1400
== 错误

```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T22:44:08.400

首先，我们按开始时间对列表进行排序。

然后我们循环检查下一个开始时间是否低于上一个结束时间。

这将检查 x+1 是否与 x 重叠（不是 x+2 是否与 x 重叠等）

```
intervals = [[100,200],[150,250],[300,400]]
intervalsSorted = sorted(intervals, key=lambda x: x[0]) # sort by start time
for x in range(1,len(intervalsSorted)):
    if intervalsSorted[x-1][1] > intervalsSorted[x][0]:
        print "{0} overlaps with {1}".format( intervals[x-1], intervals[x] )

# result: [100, 200] overlaps with [150, 250] 
```

以下内容应为您提供整个列表中的所有重叠部分。

```
intervals = [[100,200],[150,250],[300,400],[250,500]]

overlapping = [ [x,y] for x in intervals for y in intervals if x is not y and x[1]>y[0] and x[0]<y[0] ]
for x in overlapping:
    print '{0} overlaps with {1}'.format(x[0],x[1])

# results:
# [100, 200] overlaps with [150, 250]
# [250, 500] overlaps with [300, 400] 
```

请注意，这是一个 O(n*n) 查找。（如果我错了，任何人都在这里纠正我！）

这可能比第一个慢（没有测试它，但我认为它是），因为它会迭代每个单个索引的整个列表。应该类似于 arbarnert 的嵌套 for 循环示例。但话又说回来，这确实给了你所有的重叠值，而不是我展示的第一种方法，它只检查它旁边的重叠时间（按开始时间排序）。

**扩展测试给出：**

```
intervals = [[100,200],[150,250],[300,400],[250,500],[10,900],[1000,12300],[-151,32131],["a","c"],["b","d"],["foo","kung"]]

overlapping = [ [x,y] for x in intervals for y in intervals if x is not y and x[1]>y[0] and x[0]<y[0] ]
for x in overlapping:
    print '{0} overlaps with {1}'.format(x[0],x[1])

# results:
# [100, 200] overlaps with [150, 250]
# [250, 500] overlaps with [300, 400]
# [10, 900] overlaps with [100, 200]
# [10, 900] overlaps with [150, 250]
# [10, 900] overlaps with [300, 400]
# [10, 900] overlaps with [250, 500]
# [-151, 32131] overlaps with [100, 200]
# [-151, 32131] overlaps with [150, 250]
# [-151, 32131] overlaps with [300, 400]
# [-151, 32131] overlaps with [250, 500]
# [-151, 32131] overlaps with [10, 900]
# [-151, 32131] overlaps with [1000, 12300]
# ['a', 'c'] overlaps with ['b', 'd'] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-12-03T21:55:35.377

为了将来参考，@Roy 的解决方案不适用于具有相同结束或开始时间的间隔。以下解决方案可以：

```
intervals = [[100, 200], [150, 250], [300, 400], [250, 500], [100, 150], [175, 250]]
intervals.sort()
l = len(intervals)
overlaps = []
for i in xrange(l):
  for j in xrange(i+1, l):
    x = intervals[i]
    y = intervals[j]
    if x[0] == y[0]:
      overlaps.append([x, y])
    elif x[1] == y[1]:
      overlaps.append([x, y])
    elif (x[1]>y[0] and x[0]<y[0]):
      overlaps.append([x, y]) 
```

此外，[间隔树](https://en.wikipedia.org/wiki/Interval_tree)可用于此类问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-01T15:04:11.690

要扩展@Roy的答案以包括某些事物具有相同时隙并且您需要区分的情况：

```
intervals = [[100,200, "math"],[100,200, "calc"], [150,250, "eng"],[300,400, "design"],[250,500, "lit"],[10,900, "english"],[1000,12300, "prog"],[-151,32131, "hist"]]

overlapping = [ [x,y] for x in intervals for y in intervals if x is not y and x[1]>y[0] and x[0]<y[0] or x[0]==y[0] and x[1]==y[1] and x is not y]
for x in overlapping:
    print '{0} overlaps with {1}'.format(x[0],x[1])

# Prints
#[100, 200, 'math'] overlaps with [100, 200, 'calc']
#[100, 200, 'math'] overlaps with [150, 250, 'eng']
#[100, 200, 'calc'] overlaps with [100, 200, 'math']
#[100, 200, 'calc'] overlaps with [150, 250, 'eng']
#[250, 500, 'lit'] overlaps with [300, 400, 'design']
#[10, 900, 'english'] overlaps with [100, 200, 'math']
#[10, 900, 'english'] overlaps with [100, 200, 'calc']
#[10, 900, 'english'] overlaps with [150, 250, 'eng']
#[10, 900, 'english'] overlaps with [300, 400, 'design']
#[10, 900, 'english'] overlaps with [250, 500, 'lit']
#[-151, 32131, 'hist'] overlaps with [100, 200, 'math']
#[-151, 32131, 'hist'] overlaps with [100, 200, 'calc']
#[-151, 32131, 'hist'] overlaps with [150, 250, 'eng']
#[-151, 32131, 'hist'] overlaps with [300, 400, 'design']
#[-151, 32131, 'hist'] overlaps with [250, 500, 'lit']
#[-151, 32131, 'hist'] overlaps with [10, 900, 'english']
#[-151, 32131, 'hist'] overlaps with [1000, 12300, 'prog'] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T22:31:41.730

假设你有一个`intervals_overlap(interval1, interval2)`函数……</p>

第一个想法是对列表中的每一对间隔进行简单的迭代：

```
for interval1 in intervals:
    for interval2 in intervals:
        if interval1 is not interval2:
            if intervals_overlap(interval1, interval2):
                return True
return False 
```

但是你应该能够找出更聪明的方法来解决这个问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-11-30T06:33:36.610

简单的方法：

我将数字更改为字符串，因为条目 3 包含无效的 0900。

```
entry01 = ('1030', '1245')
entry02 = ('1115', '1300')

entry03 = ('0900', '1030')
entry04 = ('1215', '1400')

def check(entry01, entry02):
    import itertools
    input_time_series = list(itertools.chain.from_iterable([entry01, entry02]))
    if input_time_series != sorted(input_time_series):
        return False
    return True

>>> check(entry01, entry02)
False
>>> check(entry03, entry04)
True 
```

# ruby-on-rails - 当用户访问网页时，Rails 在会话中创建购物车

> ID：14885189
> 
> 赞同：0
> 
> 时间：2013-02-14T22:24:23.350
> 
> 标签：ruby-on-rails, ruby

我需要做购物车，但是为什么当我第一次去页面时，我没有看到@cart 对象，但如果刷新，一切都好。如果简单地说：购物车不是在第一页加载时创建的，而是在第二个页面加载时创建的，这很糟糕.... 怎么办，当我在页面的浏览器 url 中打开时，我立即看到购物车对象？

我的代码：（app_controller）

```
 before_filter :current_cart 
private
    def current_cart
      Cart.find(session[:cart_id])
      @cart = Cart.find(session[:cart_id])
      rescue ActiveRecord::RecordNotFound
      cart = Cart.create
      session[:cart_id] = cart.id
      cart
    end 
```

并查看：

```
%li
              = link_to "Перейти в корзину", @cart 
```

但是如何在页面打开时创建购物车对象......而不是当我在页面上时，完成某事......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:27:07.773

简单地说，在救援块中（当购物车尚未在数据库中时），您需要将新创建的购物车分配给实例变量`@cart`，而不是局部变量`cart`。

```
before_filter :current_cart 

private

def current_cart
  @cart = Cart.find(session[:cart_id])
rescue ActiveRecord::RecordNotFound
  @cart = Cart.create
  session[:cart_id] = @cart.id
  @cart
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:28:36.913

尝试这个：

```
 before_filter :current_cart 
private
    def current_cart
      @cart = Cart.where(id: session[:cart_id]).first #this will return nil if the Cart with id session[:cart_id] does not exist
      @cart = Cart.create if @cart.nil?
      session[:cart_id] = @cart.id
      @cart
    end 
```

# python - 迭代一个numpy数组，有选择地选择一个或两个值，给定一个标准

> ID：14885198
> 
> 赞同：1
> 
> 时间：2013-02-14T22:25:07.357
> 
> 标签：python, numpy, linear-algebra

给定一个像这样包含任意数据的 numpy 数组：

```
>>> data
array([  1,   172,   32, ..., 42, 189, 29], dtype=int8) # SIGNED int8 
```

...我需要构造一个 numpy 数组“结果”，如下所示：

（请原谅伪代码实现。如果我知道该怎么做，我不会问。如果我有一个有效的 numpy 实现，我会将我的问题直接提交给 CodeReview。）

```
for value in data, check:
    if value & 0x01:
        result.append((value >> 1 << 8) + next(value).astype(numpy.uint8))
        # that is: take TWO values from 'data', one signed, the next un-signed, glue them together, appending ONE int16 to result
    else:
        result.append(value >> 1)
        # that is: take ONE value from 'data', appending ONE int8 to result 
```

我已经在“普通”Python 中实现了这一点。它工作得很好，但希望可以使用 numpy 及其非常有效的数组操作进行优化。我想摆脱列表和附加。可悲的是，我不知道如何完成它：

```
# data is a string of 'bytes' received from a device
def unpack(data):
    l = len(data)
    p = 0
    result = []

    while p < l:
        i1 = (((ord(data[p]) + 128) % 256) - 128)
        p += 1
        if i1 & 0x01:
            # read next 'char' as an uint8
            #
            # due to the nature of the protocol,
            # we will always have sufficient data
            # available to avoid reading past the end
            i2 = ord(data[p])
            p += 1
            result.append((i1 >> 1 << 8) + i2)
        else:
            result.append(i1 >> 1)

    return result 
```

* * *

**更新：**感谢@Jaime，我设法实现了一个高效的解包功能。它与他的非常相似，尽管速度更快。while 循环当然是关键部分。我把它贴在这里以防有人感兴趣：

```
def new_np_unpack(data):
    mask = (data & 0x01).astype(numpy.bool)

    true_positives = None

    while True:
        # check for 'true positives' in the tentative mask
        # the next item must by definition be a false one
        true_positives = numpy.nonzero(numpy.logical_and(mask, numpy.invert(numpy.concatenate(([False], mask[:-1])))))[0]

        # loop until no more 'false positives'
        if not numpy.any(mask[true_positives+1]):
            break

        mask[true_positives+1] = False

    result = numpy.empty(data.shape, dtype='int16')
    result[:] = data.astype('int8') >> 1
    result[true_positives] = (result[true_positives] << 8) + data[true_positives + 1]
    mask = numpy.ones(data.shape, dtype=bool)
    mask[true_positives + 1] = False
    return result[mask] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:25:18.863

我得到了一些矢量化的工作。为了比较，我取出`ord(...)`了你的代码，并给它提供了如下数据：

```
data = np.random.randint(256, size=(1000000,)).astype('uint8')
data[-1] = 0 # to avoid errors with last element 
```

我的功能版本：

```
def np_unpack(data) :
    # find where condition is met
    mask = (data & 0x01).astype(bool)
    # Keep only 1st, 3rd, 5th... consecutive occurrences of True in mask
    new_mask = mask[:]
    mult = -1
    while new_mask.sum() :
        new_mask = np.logical_and(new_mask,
                                  np.concatenate(([False], new_mask[:-1])))
        mask +=  new_mask * mult
        mult *= -1
    del new_mask
    cond = np.nonzero(mask)[0]
    result = np.empty(data.shape, dtype='int16')
    result[:] = data.astype('int8') >> 1
    result[cond] <<= 8
    result[cond] += data[cond + 1]
    mask = np.ones(data.shape, dtype=bool)
    mask[cond + 1] = False
    return result[mask] 
```

还有一些使用 1M 元素列表的测试：

```
In [4]: np.all(unpack(data) == np_unpack(data))
Out[4]: True

In [5]: %timeit unpack(data)
1 loops, best of 3: 7.11 s per loop

In [6]: %timeit np_unpack(data)
1 loops, best of 3: 294 ms per loop 
```

# xml - XSLT 中的加/减时间

> ID：14885199
> 
> 赞同：4
> 
> 时间：2013-02-14T22:25:09.063
> 
> 标签：xml, xslt

我正在使用 xpath 2.0。

我想在变量中添加 30 分钟`$orario`。

```
 <tempi id="ID_1">
    <orario_part>09:20:00</orario_part>
    ...
  </tempi> 
```

这是我的代码，但它不起作用。

```
<xsl:template match="tempi">
   <xsl:variable name="orario" select="./orario_part"/>
   <xsl:variable name="totale" select="xs:time($orario)+xs:time('00:30:00')"/>
   <time>
       <xsl:value-of select="$totale"/>
   </time>
</xsl:template> 
```

以下是期望的结果：

```
<time>09:50:00</time> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T01:34:14.363

尝试这个：

```
<?xml version="1.0" encoding="UTF-8"?>
<tempi id="ID_1">
    <orario_part>09:20:00</orario_part>
</tempi> 
```

和

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    version="2.0" exclude-result-prefixes="#all">
    <xsl:template match="tempi">
        <xsl:variable name="orario" select="./orario_part" />
        <xsl:variable name="totale" select="xs:time($orario)"/>
        <time>
            <xsl:value-of select="$totale +  xs:dayTimeDuration('P0DT0H30M')"/>
        </time>
    </xsl:template>
</xsl:stylesheet> 
```

给

```
<time>09:50:00</time> 
```

# c - 如何在 C 中读取文本文件中的特定行（整数）

> ID：14885202
> 
> 赞同：3
> 
> 时间：2013-02-14T22:25:14.250
> 
> 标签：c, file, scanf

我的程序（程序的一部分）有问题。要继续进行，我需要以某种方式读取文件的一行，但这必须是特定的行。我对C和文件真的很陌生......

我想要做的是要求用户输入他们想要阅读的特定行，然后将其显示给他们。目前，当我尝试从该行打印文本时，它只给我第 1 行的文本。请注意，文本是指整数，因为该文件在一列中包含 55 个整数。所以它看起来像这样：12 18 54 16 21 64 .....

有什么办法可以达到我的需要吗？

```
#include <stdio.h>

FILE *file;

char name[15];
int line;
int text;

file = fopen("veryimportantfile.txt","r");
if(file==NULL)
{
    printf("Failed to open");
    exit(1);
}

printf("Your name: ");
scanf("%s",&name);
printf("\Enter the line number you want to read: ");
scanf("%d",&line);

fscanf(pFile, "%d", &line);
printf("The text from your line is: %d",line); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T22:27:40.913

怎么样：

*   使用 , 从文件中逐个读取字符`getc`，直到遇到所需数量的换行符减 1
*   使用循环读取整数和`fscanf("%d", ...)`

就像是：

```
int ch, newlines = 0;
while ((ch = getc(fp)) != EOF) {
    if (ch == '\n') {
        newlines++;
        if (newlines == line - 1)
            break;
    }
}

if (newlines != line - 1)
    /* Error, not enough lines. */

/* fscanf loop */ 
```

# sql-server - 从一个 SQL 数据库中导出大量二进制数据，并将其导入另一个相同架构的数据库中

> ID：14885203
> 
> 赞同：2
> 
> 时间：2013-02-14T22:25:18.297
> 
> 标签：sql-server, image, import, export, sql-server-2008

我有一个数据库，其中包含一个包含 37,000 多条记录的图像表。每条记录都包含一个二进制数据形式的图像。我需要将所有这 37,000 条记录放入另一个数据库中，该数据库包含相同的表和模式，大约有 12,500 条记录。我需要使用 IF NOT EXISTS 方法将这些图像插入数据库，以确保完成后没有重复。

我尝试将数据导出到 excel 中并将其格式化为脚本。（我以前用其他表做过。）问题是，excel 不支持二进制数据。

我还尝试了 SSMS 中的“生成脚本”向导，但它不起作用，因为 .sql 文件远远超过 18GB，而我的电脑无法处理它。

是否有其他 SQL 工具可以做到这一点？我已经用谷歌搜索了几个小时，但无济于事。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:39:01.043

您为什么不尝试“导出数据”功能？这应该有效。

右键单击源数据库，选择“任务”，然后选择“导出数据”。然后按照说明进行操作。您还可以保存设置并定期执行任务。

此外，bcp.exe 实用程序可以从一个数据库读取数据并插入另一个数据库。

但是，我建议使用第一种方法。

更新：为了避免重复，您必须能够比较图像。不幸的是，您无法直接比较图像。但是您可以将它们投射到`varbinary(max)`比较。

所以这是我的建议：
1\. 将表复制到名称下的新数据库`tmp_images`
2\. 使用`merge`命令仅插入新图像。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:49:16.900

为此，我使用了[SQL Workbench/J](http://www.sql-workbench.net/)。

您可以通过文本文件使用[WbExport](http://www.sql-workbench.net/manual/command-export.html)和[WbImport](http://www.sql-workbench.net/manual/command-import.html)（二进制数据将作为单独的文件写入，文本文件包含文件名）。

或者您可以使用[WbCopy](http://www.sql-workbench.net/manual/command-copy.html)直接复制数据而无需中间文件。

为了实现您的“如果不存在”方法，您可以使用更新/插入模式，尽管这会改变现有行。

我认为没有“仅在不存在模式下插入”，但您应该能够通过定义唯一索引并忽略错误来实现这一点（虽然这不会很快，但应该可以这么少的行数）。

如果“存在”检查更复杂，您可以将数据复制到目标数据库中的临时表中，然后使用 SQL 将其合并到真实表中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-20T18:56:54.677

```
INSERT INTO DB1.dbo.table_name
SELECT  * FROM DB2.dbo.table_name
WHERE column_name NOT IN
(   
  SELECT column_name FROM DB1.dbo.table_name
) 
```

# mysql - 标有“使用 btree”的 InnoDB 列为什么？

> ID：14885209
> 
> 赞同：0
> 
> 时间：2013-02-14T22:25:26.513
> 
> 标签：mysql

不明原因：

```
CREATE TABLE  `orders_products` (
  `ORDER_ID` int(10) unsigned NOT NULL,
  `PRODUCT_ID` int(10) unsigned NOT NULL,
  `QUANTITY` tinyint(3) unsigned NOT NULL,
  `USER_ID` int(10) unsigned NOT NULL,
  PRIMARY KEY (`ORDER_ID`,`PRODUCT_ID`,`USER_ID`) USING BTREE,
  KEY `FK_orders_products_3` (`USER_ID`),
  KEY `FK_orders_products_2` (`PRODUCT_ID`) USING BTREE,
  CONSTRAINT `FK_orders_products_1` FOREIGN KEY (`ORDER_ID`) REFERENCES `orders` (`ID`) ON DELETE CASCADE,
  CONSTRAINT `FK_orders_products_2` FOREIGN KEY (`PRODUCT_ID`) REFERENCES `products` (`ID`) ON DELETE CASCADE,
  CONSTRAINT `FK_orders_products_3` FOREIGN KEY (`USER_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

主键和 FK_orders_products_2 得到了 BTREE。怎么知道？SHOW INDEX 和 DESCRIBE TABLE 都没有描述谁使用 BTREE 而谁不使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:31:01.583

您可以使用以下方式获取有关密钥的信息

```
 SHOW KEYS FROM orders_products 
```

该结果集中有一个 INDEX_TYPE 列。

# drupal-7 - Drupal 7 视图上下文过滤器根据当前用户角色限制内容

> ID：14885210
> 
> 赞同：1
> 
> 时间：2013-02-14T22:25:32.690
> 
> 标签：drupal-7, views, arguments

我想根据当前用户角色限制对视图的访问。不是作者。例如，如果用户具有授权用户角色，那么他们可以看到视图的内容。如果用户是匿名的，那么他们将被显示为视图的无结果行为。我不敢相信没有办法做到这一点。我知道有访问设置，但我不希望匿名用户收到拒绝访问的消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T00:13:46.240

我能想到的一种方法：

使用 hook_views_query_alter()。检查当前用户是否属于您感兴趣的角色集。如果他不属于，请添加一个始终为假的条件，例如 0 = 1。要查看如何在代码中添加这样的条件，请参阅示例在此页面上： http: [//api.drupal.org/api/views/views.api.php/function/hook_views_query_alter/7](http://api.drupal.org/api/views/views.api.php/function/hook_views_query_alter/7)。添加此条件后，生成的视图将不会有任何结果。

尼拉夫·梅塔。 [Drupal 开发](http://redcrackle.com)

# apache-flex - 无法解决 添加 AIR 3.6 后的组件实现

> ID：14885218
> 
> 赞同：6
> 
> 时间：2013-02-14T22:25:45.967
> 
> 标签：apache-flex, air, flash-builder, flex4.6

自从更改为 AIR 3.6 以来，我遇到了很多错误，例如：

无法将 <s:Sequence> 解析为组件实现。

![在此处输入图像描述](../Images/5910b30726eda6ee3a91678cd548f75f.png)

如果我切换到内置的 Flex SDK 4.6.0 它工作正常。我正在使用 Flash Builder 4.6。

**更新**
我认为这是因为有一个新的 ActionScript 编译器，并且 SDK 中包含了新的编译器，这会导致 Flex 项目出现问题。我在 AIR SDK 下载页面上读到了这个（我之前没有注意到）：

*`Note : Flex users will need to download the original AIR SDK without the new compiler.`*

[来源](http://www.adobe.com/devnet/air/air-sdk-download.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T17:35:09.460

我正在使用带有编译器的 AIR SDK 3.6。我只需要使用 AIR SDK 3.6（没有编译器）。在文本“注意：Flex 用户需要下载原始 AIR SDK 而不使用新编译器”之后，[页面](http://www.adobe.com/devnet/air/air-sdk-download.html)下方有一个指向它的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:45:23.283

您确定您正确升级到 AIR 3.6 吗？您必须将它与您当前的 Flex SDK 合并（确保先复制它）。Flash 中有三种不同的 SDK：Flash、Flex 和 AIR。要使用 AIR SDK，您必须将其与其他两个 SDK 之一结合使用。您不能只将您的项目属性指向您从 Adob​​e 获得的 AIR SDK。那是行不通的。

还值得注意的是，3.6 仍处于测试阶段。3.5 是最新的稳定版本，除非您有使用 3.6 的特定原因（即您是测试人员），否则您应该避免使用它。

# z3 - Z3：设置起始值

> ID：14885220
> 
> 赞同：0
> 
> 时间：2013-02-14T22:26:08.713
> 
> 标签：z3

我可以要求 Z3 从某些起始值搜索以满足约束吗？

说，如果我有两个`RealExprs` `x`and `y`，并且我有`x==y`作为约束。我可以要求 Z3 搜索`x=-9999, y=-9997`这样 Z3 可能会返回给我的模型`x=-9998 and y=-9998`并说“SAT”吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T08:26:53.017

据我了解您的问题，您正在寻找最大化/最小化问题的解决方案，即以下函数

```
f(x, y) = |x + 9999| + |y + 9997| 
```

与约束一起`x = y`。[如该问题](https://stackoverflow.com/questions/11934545/minimum-and-maximum-value-of-variable)的答案所述，Z3 目前不直接支持此功能。但是，如前所述，您可以尝试通过在 Python 循环中查询 Z3 来解决此类问题，该循环将先前找到的解决方案添加为下一个查询的新约束。

# asp.net-mvc - 设置 Azure 持续部署时出错

> ID：14885225
> 
> 赞同：2
> 
> 时间：2013-02-14T22:27:02.360
> 
> 标签：asp.net-mvc, azure, continuous-integration, azure-web-roles

每次尝试使用我的 Azure 云服务帐户设置 TFS plublishing 时，我都会收到此错误：

> 找不到 AzureContinuousDeployment.11.xaml

以及这篇文章的链接：http: [//blogs.msdn.com/b/bharry/archive/2012/06/07/announcing-continuous-deployment-to-azure-with-team-foundation-service.aspx](http://blogs.msdn.com/b/bharry/archive/2012/06/07/announcing-continuous-deployment-to-azure-with-team-foundation-service.aspx)

我已将 BuildProcessTemplates 文件夹删除到 TFS 内的另一个路径。正如文章所说，我刚刚将其恢复为“$//BuildProcessTemplates”，但我不断从 Windows Azure 管理门户收到相同的错误。

发布模板尚未修改。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:36:26.210

好吧，显然，我需要在 Team Explorer 的“构建”部分中定义至少一个构建配置才能使其正常工作。

我添加了一个名为 TEMP 的新配置，并将流程模板 xaml 定向到根文件夹。

配置完成后，我返回 Azure 管理站点，重试“设置 TFS 发布”选项，一切正常。

# javascript - 从 google docs 电子表格中获取单元格的值到 javascript

> ID：14885231
> 
> 赞同：6
> 
> 时间：2013-02-14T22:27:23.627
> 
> 标签：javascript, google-sheets, google-docs

我有一个javascript函数

```
function calculate() {
  var interestRate=4.5;
  ...
} 
```

我希望interestRate 来自谷歌文档电子表格中的一个单元格。我创建了一个谷歌文档电子表格，并将利率存储在单元格 B2

我使用 Google Docs 中的“获取已发布数据的链接”功能来获取到单元格 B2 的链接。链接看起来像这样。

[https://docs.google.com/spreadsheet/pub?key=....c&single=true&gid=0&range=b2&output=html](https://docs.google.com/spreadsheet/pub?key=....c&single=true&gid=0&range=b2&output=html)

有没有办法从链接中获取值到我的 javascript 函数中？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:15:31.643

首先，我建议将“获取已发布数据的链接”作为 csv，因为它只是 1 个字段，因此您不必解析它。如果制作了这个[电子表格](https://docs.google.com/spreadsheet/ccc?key=0Auwt3KepmdoudE1iZFVFYmlQclcxbW85YzNZSTYyUHc&usp=sharing)，并[使用“获取已发布数据的链接”](https://docs.google.com/spreadsheet/pub?key=0Auwt3KepmdoudE1iZFVFYmlQclcxbW85YzNZSTYyUHc&single=true&gid=0&range=b5&output=csv)链接，则在这种情况下，第二个链接将获得一个只有一个字段的 csv。您将能够使用以下 js 代码获得此信息（注意我使用的是 jQuery）

```
$.ajax("https://docs.google.com/spreadsheet/pub?key=0Auwt3KepmdoudE1iZFVFYmlQclcxbW85YzNZSTYyUHc&single=true&gid=0&range=b5&output=csv").done(function(result){
    alert(result);
}); 
```

问候

**编辑：**完整代码

```
<!doctype>
<html>
    <head>
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js">    </script>
    </head>
    <body>
        <script>
            $.ajax("https://docs.google.com/spreadsheet/pub?key=0Auwt3KepmdoudE1iZFVFYmlQclcxbW85YzNZSTYyUHc&single=true&gid=0&range=b5&output=csv").done(function(result){
                alert(result);
            });
        </script>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T14:16:57.917

这是可能的，但它有点邋遢，尽管存在跨站点问题。

步骤如下：

首先，您需要在 google 电子表格中创建一个读取您要使用的值的单元格，例如，如果您想要的值在电子表格的单元格 A1 中，您可以将其作为公式放入单元格 B1 中，如下所示：

```
="interestrate="&text(A1,"0.0")&";" 
```

这样做是创建一个包含文本的单元格（为了说明，我假设包含 5.7 作为数字）：

```
interestrate="5.7"; 
```

这是 javascript 中的有效语句。

然后将以下内容放入 html 页面的头部（或任何地方）：

```
<script src="https://docs.google.com/spreadsheet/pub?key=0AgLSs-sWp9JUdDgxV3VXbUZhZ3BXUGQ3MEtyVWhYRnc&single=true&gid=0&output=txt&range=b1"></script> 
```

（显然，为包含该新功能的电子表格设置键值）。

现在，当页面加载时，用户的浏览器将从 google 电子表格中获取单行 javascript 并执行它。因此，变量，在本例中为“interestrate”，设置为原始单元格中的值（作为字符串，因此您需要 parseFloat 来进行计算）。

这将需要一些时间，因此您需要确保在脚本尝试使用该值之前对其进行操作。

另外，我怀疑如果您尝试使用大量数字，这会变得非常慢。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:42:24.023

[您可能会在使用同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)时遇到问题。通常，作为安全措施，Web 浏览器不允许对不同域的 AJAX 请求。我有点惊讶ultraklon 的解决方案在firefox 中工作，所以也许这在较新的浏览器中发生了变化。不过，它似乎在 IE8 中不起作用，所以如果您需要支持该浏览器，请继续阅读。

通常，[JSONP](http://en.wikipedia.org/wiki/JSONP)被用作绕过相同来源策略的一种方式，但在您的情况下这不是一个选项，因为谷歌文档不提供这种格式的数据。

或许最好的解决方案是通过您自己的服务器将请求代理到 google 文档，正如[这个问题](https://stackoverflow.com/questions/8469875/how-to-load-file-contents-from-another-domain-using-just-js)中所建议的那样。在您的 Web 服务器上创建一个将单元格（或单元格范围）作为参数的方法。让服务器方法从谷歌文档请求单元格数据，然后让它以 JSON 格式将此数据返回给调用者。

代理请求后，您可以使用一些 ajax 将其放入您的 javascript 代码中，如 ultraklon 的回答：

```
$.get('/google-docs-proxy?cell=B1', function(data) {
    alert('data');
}); 
```

# ios6 - iPhone：如何将链接的电话号码合并到联系人

> ID：14885232
> 
> 赞同：1
> 
> 时间：2013-02-14T22:27:24.543
> 
> 标签：ios6, abperson

正如[这篇](https://stackoverflow.com/questions/13032565/ios-6-address-book-empty-kabpersonphoneproperty)文章中所建议的，可以通过使用链接的联系人数组 (ABPersonCopyArrayOfAllLinkedPeople) 在 ios 6 上检索联系人的“丢失”电话号码（当 kABPersonPhoneProperty 为空时，但电话号码在地址簿中可见）。如何测试数组中的特定联系人，并合并/覆盖联系人的电话号码？

# twitter-bootstrap - 无法从引导程序中的活动列表项中删除边框颜色

> ID：14885235
> 
> 赞同：1
> 
> 时间：2013-02-14T22:27:35.063
> 
> 标签：twitter-bootstrap, navbar

我无法从导航栏中的活动列表项中删除边框。见附图。仅当我单击列表项以显示下拉列表然后再次单击它以关闭下拉列表时，才会出现这种情况。然后，当我将光标从列表项上移开时，它会显示这个蓝色边框。

任何帮助，将不胜感激。注意我正在使用 Less。

![在此处输入图像描述](../Images/a8e461d57e1ad2ffd7a2abe132d7f2da.png)

```
<div class="nav-collapse pull-right">
        <ul class="nav">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">DROPDOWN<b class="caret"></b></a>
            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
              <li><a href="#">PLANS</a></li>
              <li><a href="#">PLANS</a></li>
              <li><a href="#">PLANS</a></li>
            </ul>
          </li></ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-16T11:34:06.877

我相信当您激活下拉菜单时，具有“下拉菜单”类的 LI elememt 会添加“开放”类。尝试使用该“开放”类来关闭边框。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-23T13:24:33.830

使用上面具有以下样式的相同标记将从链接中删除蓝色边框。

`.dropdown a { outline: none; }`

# ruby-on-rails - Rails Forem 安装协助

> ID：14885241
> 
> 赞同：0
> 
> 时间：2013-02-14T22:27:54.310
> 
> 标签：ruby-on-rails, ruby, gem, forem

所以我对rails等很陌生，过去几个小时我一直在尝试安装它，并且在尝试运行时遇到以下错误`rails s`，或者如果我尝试安装它`rails g forem:install`

> /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load': /home/forem/config/initializers/session_store.rb:3: 语法错误，意外 ':'，期待 $end (SyntaxError) ...sion_store :cookie_store, key: '_forums_session' ^ 来自 /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/依赖项.rb:245:in
> 
> > `load' from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in` load_dependency' 来自 /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:245:in `load' from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/engine.rb:588 from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/engine.rb:587:in` each' 来自 /usr/lib64/ruby/gems/1.8/gems/railties -3.2.11/lib/rails/engine.rb:587 来自 /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:30:in `instance_exec' from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:30:in` run' 来自 /usr /lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:55:in `run_initializers' from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/initializable.rb:54:in` each' 来自 /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/ lib/rails/initializable.rb:54:in `run_initializers' from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/application.rb:136:in` 初始化！来自 /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `send' from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in` method_missing' 来自 /home/forem/config/environment.rb:5 来自 /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in `require' from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in` 要求'来自 / usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:236:in `load_dependency' from /usr/lib64/ruby/gems/1.8/gems/activesupport-3.2.11/lib/active_support/dependencies.rb:251:in` require' 来自 /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11 /lib/rails/application.rb:103:in `require_environment!' from /usr/lib64/ruby/gems/1.8/gems/railties-3.2.11/lib/rails/commands.rb:25 from script/rails:6:in`需要'来自脚本/rails:6

那么我在这里遗漏了什么还是......？

我下载的是这个：`https://github.com/radar/forem.heroku.com`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:07:08.040

您收到的错误是由于您在不支持它的旧版本 Ruby 中使用 Ruby 1.9+ 哈希语法。您需要将 Ruby 升级到 1.9.2 或 1.9.3，或者将 session_store.rb 文件的第二行更改为：

```
# Be sure to restart your server when you modify this file.
Forums::Application.config.session_store :cookie_store, :key => '_forums_session' 
```

# html - 内容更改时垂直对齐

> ID：14885242
> 
> 赞同：0
> 
> 时间：2013-02-14T22:27:57.197
> 
> 标签：html, richfaces, ajax4jsf

嗨我正在尝试垂直对齐两个元素

代码是

```
<h:panelGrid columns="2">
        <a4j:outputPanel layout="block">
            <h:form>
                <h:inputText id="text1" label="text1" value="#{opBean1.text}">
                    <f:validateLength maximum="10" />
                    <a4j:ajax event="keyup" execute="@this" render="out1" onerror="return false;" />
                </h:inputText><br/>
                <h:outputText id="out1" rendered="#{not empty opBean1.text}" value="Approved Text: #{opBean1.text}" />
            </h:form>
        </a4j:outputPanel>

        <a4j:outputPanel layout="block">
            <h:form>
                <h:inputText id="text2" label="text2" value="#{opBean1.text2}">
                    <f:validateLength maximum="10" />
                    <a4j:ajax event="keyup" execute="@this" render="out2" onerror="return false;" />
                </h:inputText><br/>
                <h:outputText id="out2" rendered="#{not empty opBean1.text2}" value="Approved Text: #{opBean1.text2}" />
            </h:form>
        </a4j:outputPanel>
</h:panelGrid> 
```

如您所见，其中`<h:panelGrid>`包含两列。每列都有一个`<a4j:outputPanel>`元素。

问题是罐子的垂直尺寸`<a4j:outputPanel>`会发生变化。（`<h:outputText id="xxx" rendered="#{not empty opBean1.xxx}" value="Approved Text: #{opBean1.xxx}" />`仅当托管 bean opBean1 中的 xxx 值不为空时，才会呈现该元素）

因此，如果我在第一个 a4j 面板中输入一些文本，它将垂直包含两行，而另一个 a4j 面板将只包含一个。因此，第二个面板的 inputText 字段将不再与第一个面板的文本字段对齐。

我知道如果没有任何图形表示，这可能很难理解，所以我会告诉你我的意思：在输入文本之前：

```
inputText1  inputText2 
```

输入文字后：

```
inputText1
            inputText2
outputText1 
```

我希望它是：

```
inputText1 inputText2

outputText1 
```

编辑（对不起识别......我不知道如何让它变得更好）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"><head>

<title>Mission Page</title><link type="text/css" rel="stylesheet" href="/FlightFAQ/rfRes/skinning.ecss.jsf?db=eAHjW!XqPQAE!QKS" /><script type="text/javascript" src="/FlightFAQ/javax.faces.resource/jsf.js.jsf?ln=javax.faces&amp;stage=Development"></script><script type="text/javascript" src="/FlightFAQ/javax.faces.resource/jquery.js.jsf"></script><script type="text/javascript" src="/FlightFAQ/javax.faces.resource/richfaces.js.jsf"></script><script type="text/javascript" src="/FlightFAQ/javax.faces.resource/richfaces-base-component.js.jsf"></script><script type="text/javascript" src="/FlightFAQ/javax.faces.resource/richfaces-event.js.jsf"></script><script type="text/javascript" src="/FlightFAQ/javax.faces.resource/message.js.jsf?ln=org.richfaces"></script><link type="text/css" rel="stylesheet" href="/FlightFAQ/rfRes/msg.ecss.jsf?db=eAHjW!XqPQAE!QKS&amp;ln=org.richfaces" /></head><body><table>

<tbody>

<tr>

<td><div id="j_idt6">

<form id="j_idt7" name="j_idt7" method="post" action="/FlightFAQ/debug.jsf" enctype="application/x-www-form-urlencoded">

<input type="hidden" name="j_idt7" value="j_idt7" />

<span style="font-weight: bold;">Name: </span><input id="j_idt7:clientName" type="text" name="j_idt7:clientName" onblur="av_aea6d620643bb708da4bf66b58ae27d6(event,&quot;j_idt7:clientName&quot;,this)" />

<br /><span class="rf-msg " id="j_idt7:j_idt10"></span><input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="-6739208697542802203:-2950524051097537124" autocomplete="off" />

</form></div></td>

<td><div id="j_idt11">

<form id="j_idt12" name="j_idt12" method="post" action="/FlightFAQ/debug.jsf" enctype="application/x-www-form-urlencoded">

<input type="hidden" name="j_idt12" value="j_idt12" />

<span style="font-weight: bold;">Contact: </span><input id="j_idt12:contact" type="text" name="j_idt12:contact" /><input type="hidden" name="javax.faces.ViewState" id="javax.faces.ViewState" value="-6739208697542802203:-2950524051097537124" autocomplete="off" />

</form></div></td>

</tr>

</tbody>

</table>

<script type="text/javascript" src="/FlightFAQ/javax.faces.resource/richfaces-csv.js.jsf?ln=org.richfaces"></script><script type="text/javascript">

//<![CDATA[

window.av_aea6d620643bb708da4bf66b58ae27d6=function(event,id,e,da){var p={da:da,v:[{f:RichFaces.csv.validateRequired,p:{} ,m:{"detail":"name cannot be null","severity":0,"summary":"name cannot be null"} }]};

RichFaces.csv.validate(event,id,e,p);

}

$(document).ready(function() {

new RichFaces.ui.Message("j_idt7:j_idt10",{"forComponentId":"j_idt7:clientName","showSummary":false,"showDetail":true} )

});

//]]>

</script></body>

</html> 
```

# button - 输入标签中不同的鼠标悬停和鼠标悬停图像

> ID：14885245
> 
> 赞同：0
> 
> 时间：2013-02-14T22:28:15.620
> 
> 标签：button, hover, onmouseover, onmouseout

我有一个自定义（即我在互联网上找到的）PayPal 捐赠按钮。我希望它有 2 个不同的图像 - mouseout 图像和 mouseover 图像。我变了

```
<input type="image" src='/images/icons/donate.png' border="0" name="submit" alt=""> 
```

至

```
<input type="image" onmouseout="this.src='/images/icons/donate.png'" onmouseover="this.src='/images/icons/hover_donate.png'" border="0" name="submit" alt=""> 
```

这两个不同的图像正常工作，但是，当页面最初加载时，两个图像都不会出现，直到我将鼠标悬停至少一次。在那之后，他们找到了，它应该如何工作。我想知道是否有办法解决这个问题，最好是使用 CSS。这是我正在谈论的完整代码部分（减去识别信息），以及我正在谈论的图像（或链接，因为我没有发布图像的代表）。

```
 <form action="https://www.paypal.com/cgi-bin/webscr" method="post">
            <input type="hidden" name="cmd" value="_s-xclick">
            <input type="hidden" name="hosted_button_id" value="valueHere">
            <input type="image" onmouseover="this.src='/images/icons/hover_donate.png'" onmouseout="this.src='/images/icons/donate.png'" border="0" name="submit" alt="PayPa$
            <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
            </form> 
```

[图片](http://i.imgur.com/7Oze5jp.png)

顶部是我在新页面上看到的（使用 ctrl+f5，以确保它从服务器而不是我的缓存中提取它），底部分别是按钮和悬停按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-30T15:21:04.930

在输入字段上提供 id 并为其提供背景图像（您希望默认显示而不悬停的图像）

```
<style type="text/css">
   #donation{background-image:url(images/icons/donate.png);}
</style>

<input type="image" id="donation" onmouseout="this.src='/images/icons/donate.png'" onmouseover="this.src='/images/icons/hover_donate.png'" border="0" name="submit" alt=""> And 
```

# c - 简单的 Linux Shell。停止命令

> ID：14885249
> 
> 赞同：1
> 
> 时间：2013-02-14T22:28:40.740
> 
> 标签：c, shell

我正在尝试在 linux 中实现一个简单的 shell，它应该具有的功能之一是让用户能够按下`<ctrl+D>`并使其停止它正在做的任何事情 - 基本上正是`<ctrl+C>`Bash 中所做的。

现在我想知道最简单的方法来做到这一点，并且我正在考虑某种可以使当前任务停止的关键侦听器。现在我能想到的唯一方法是拥有一个单独的线程，该线程将强制停止并将主线程返回到基本状态，在那里它可以接受新的输入。

单独的线程将是“不断”侦听正确按键的唯一方法。

我希望对此有一些想法，并可能有更好的解决方法。

[编辑] 我正在尝试制作一个简单的 shell，它可以执行外部程序、打印/更改目录、打印/设置路径、打印命令历史记录、从历史记录调用命令和打印/设置/删除命令别名。CTRL-D 相当于 Bash 中的 CTRL-C，它允许用户立即退出当前正在运行的程序，而不是退出 shell 本身。[/编辑]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:46:17.330

你为什么不直接处理`Ctrl-C`？

这只是关于捕获信号的许多 SO 讨论之一： [Catch Ctrl-C in C](https://stackoverflow.com/questions/4217037/catch-ctrl-c-in-c/4217052#4217052)

`Ctrl-D`一般代表`EOF`标准输入。你不应该惹它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T03:59:52.783

如果您希望`Control-D`角色为您生成中断，则：

1.  您需要将 EOF 字符映射到`Control-D`.
2.  您需要将中断字符映射到`Control-D`.

您可以在 POSIX 中使用[`<termios.h>`](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/termios.h.html#tag_13_74)标题和函数执行此操作：

*   [`tcgetattr()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/tcgetattr.html)
*   [`tcsetattr()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/tcsetattr.html)

您将在`struct termios`using中检索当前属性`tcgetattr()`。您将制作该结构的副本，并修改（为了参数）该副本，更改由and`c_cc`索引的数组元素（以及您想要进行的任何其他更改），然后使用. 您还需要确保在 shell 退出之前恢复原始终端设置（通过另一个调用使用通过 检索的原始属性集）。这可以通过注册的处理程序或其他机制来完成。在所有情况下，您都应该努力重置终端属性。对于 SIGKILL 杀死你，你无能为力。`VINTR``VEOF``tcsetattr()``tcsetattr()``tcgetattr()``atexit()`

在测试时，为自己编写一个小脚本：

```
echo stty $(stty -g) > sane
chmod u+x sane 
```

`stty`它以一种专为可靠读取而设计的形式记录当前（可能是健全的）终端设置。如果（何时）您的 shell 有问题，您可以使用`Control-J``sane``Control-J`运行脚本并将终端重置为已知的健全设置。`curses`如果您正在开发使用该库的程序，这也很有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:32:19.877

除非我对其他答案的评论不正确，否则我认为您应该做的是：

```
 if (!fgets(input, sizeof(input), stdin) == NULL)
 {
    ... do cleanup here ... 
    exit(0);
 } 
```

或与之等效的东西。

# jquery - 如何克隆节点，复制数据但不复制事件处理程序？

> ID：14885256
> 
> 赞同：4
> 
> 时间：2013-02-14T22:29:04.383
> 
> 标签：jquery, jquery-1.8, jquery-clone

jQuery 的`clone`函数如下所示：

> .clone( [withDataAndEvents ] [, deepWithDataAndEvents ] )
> 
> **withDataAndEvents**：一个布尔值，指示是否应将事件处理程序和数据与元素一起复制。
> 
> **deepWithDataAndEvents**：一个布尔值，指示是否应复制克隆元素的所有子元素的事件处理程序和数据。

这两个参数都会影响`data` *和* `events`。是否可以只保留数据而不保留事件？基本上，我的理想`clone`功能如下所示：

> .idealClone( [withData] [, withEvents ] [, deepWithData ] [, deepWithEvents ])
> 
> **withData**：一个布尔值，指示数据是否应与元素一起复制。
> 
> **withEvents**：一个布尔值，指示是否应将事件处理程序与元素一起复制。
> 
> **deepWithData**：一个布尔值，指示是否应复制克隆元素的所有子元素的数据。
> 
> **deepWithEvents**：一个布尔值，指示是否应复制克隆元素的所有子元素的事件处理程序。

有没有办法实现这一点？

注意我正在使用 1.8.1，但欢迎所有版本的答案

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:33:53.283

您可以使用理想的克隆方法轻松扩展 jQuery 对象，并使用 和 的各种组合[`data`](http://api.jquery.com/data)来[`off`](http://api.jquery.com/off)仅保留您想要的东西。我个人认为这样做很容易：

```
// clones with data and events, then unbinds all events (bound with .on)
$(element).clone(true).off(); 
```

# string-concatenation - 如何在 Puppet .pp 文件中连接字符串？

> ID：14885263
> 
> 赞同：55
> 
> 时间：2013-02-14T22:29:35.353
> 
> 标签：string-concatenation, puppet

这是我天真的方法：

```
# puppet/init.pp
$x = 'hello ' + 
     'goodbye' 
```

这不起作用。如何在 Puppet*中*连接字符串？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-02-15T17:09:33.017

关键字变量插值：

```
$value = "${one}${two}" 
```

来源：[http ://docs.puppetlabs.com/puppet/4.3/reference/lang_variables.html#interpolation](http://docs.puppetlabs.com/puppet/4.3/reference/lang_variables.html#interpolation)

请注意，虽然它可能在没有花括号的情况下工作，但您应该始终使用它们。

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2014-10-22T12:29:20.190

我使用将值放入数组然后“加入”它们的构造。在这个例子中，我的输入是一个数组，在它们与 ':2181' 连接后，结果值再次放入一个数组中，该数组与一个空字符串作为分隔符连接。

```
$zookeeperservers = [ 'node1.example.com', 'node2.example.com', 'node3.example.com' ]
$mesosZK = join([ "zk://" , join($zookeeperservers,':2181,') ,":2181/mesos" ],'') 
```

$mesosZK 的结果值

```
zk://node1.example.com:2181,node2.example.com:2181,node3.example.com:2181/mesos 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2015-02-24T12:15:05.860

其他答案中未提及的另一个选项是使用[Puppet 的`sprintf()`](https://docs.puppet.com/puppet/latest/reference/function.html#sprintf)函数，该函数的功能与其背后的[Ruby 函数相同。](http://apidock.com/ruby/Kernel/sprintf)一个例子：

```
$x = sprintf('hello user %s', 'CoolUser') 
```

经验证可与 puppet 完美配合。正如*chutz*所提到的，这种方法还可以帮助您连接函数的输出。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-15T01:09:11.553

以下对我有用。

```
puppet apply -e ' $y = "Hello" $z = "world" $x = "$y $z" notify { "$x": } '
notice: Hello world
notice: /Stage[main]//Notify[Hello world]/message: defined 'message' as 'Hello world'
notice: Finished catalog run in 0.04 seconds 
```

以下也有效：

```
$abc = "def"

file { "/tmp/$abc": 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-27T06:05:08.093

您可以使用 puppetlabs-stdlib 中的 join() 函数。我在想那里应该有一个字符串 concat 函数，但我没有看到它。写一个很容易。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-11-23T03:27:37.620

如[docs](https://puppet.com/docs/puppet/4.6/lang_data_string.html#interpolation)中所述，您可以只使用 ${varname} 插值。这也适用于函数调用：

```
$mesosZK = "zk://${join($zookeeperservers,':2181,')}:2181/mesos"
$x = "${dirname($file)}/anotherfile" 
```

但无法将 {} 与函数参数一起使用：得到`Syntax error at '}'`.

# configuration - 为什么不应该使用 Chef / Puppet 逐行更改配置文件？

> ID：14885267
> 
> 赞同：9
> 
> 时间：2013-02-14T22:29:46.407
> 
> 标签：configuration, chef-infra, puppet

为什么在 Chef 或 Puppet 中更改配置文件中的行被视为反模式？据我了解，这有点像坏习惯。我假设这种文件编辑是以某种幂等方式和使用高级工具（例如 augeas）完成的。

为什么使用 ERB 模板部署整个文件被视为首选方法？

您可以找到很多示例，其中 dev-ops 建议使用模板而不是文件编辑。例如[这里](https://stackoverflow.com/questions/10984084/is-this-the-correct-way-to-change-a-config-file-using-puppet)、[这里](https://stackoverflow.com/questions/12806902/using-chef-puppet-and-managing-hand-made-changes)、[这里](https://stackoverflow.com/questions/14848110/how-i-can-change-a-file-with-chef)等。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-14T22:56:53.623

实际上，有很大一部分 DevOps 社区认为接受配置文件的系统/包默认值，并且只修改您需要`augeas`的内容作为首选方法，Github devops 就是其中之一（如果您碰巧在 Puppet Conf 2012 上发现它们）。

我认为始终使用模板的默认模式会产生过高的维护负担，并且几乎总是需要您锁定堆栈中所有内容的特定版本，否则您可能会面临模板与该资源的较新版本不兼容的风险。

这两种选择都有用例，但总的来说，我更喜欢“尽可能少地拥有”实践而不是“即使你不必拥有一切”的实践。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T22:37:59.840

就将系统设置为已知状态而言，部署整个文件比编辑要好，因为您确定完成后文件完全符合预期。

如果您正在修补寻找问题的潜在解决方案并手动编辑一些配置文件，您不必担心您所做的手动编辑会成为环境中不受控制的一部分。下次运行 chef-client 时，您知道状态将与 Chef 配方中指定的完全相同，并且不会包含您的编辑。

此外，一般而言，稳健地编辑文件比仅生成文件更难、更复杂。在基本情况下，您可能会编写一些幂等的东西，但如果文件包含语法错误或无效的东西，那么您的编辑将不再有效。

不过，与往常一样，有时您别无选择，而编辑是唯一的出路。

# android - 方向更改时未保留应用程序标签字体

> ID：14885268
> 
> 赞同：2
> 
> 时间：2013-02-14T22:29:47.637
> 
> 标签：android, android-actionbar, actionbarsherlock

我无法在屏幕方向更改时为我的应用程序标签保留字体。目前我在 SherlockFragmentActivity 的 onCreate 方法中使用以下代码设置字体。

```
titleId = Resources.getSystem().getIdentifier("action_bar_title", "id", "android");
if(titleId == 0)
    titleId = com.actionbarsherlock.R.id.abs__action_bar_title; 
mAppName = (TextView) findViewById(titleId);
Typeface face = Typeface.createFromAsset(getAssets(), "fonts/handsean.ttf");
mAppName.setTypeface(face); 
```

在方向更改时，字体恢复为默认值。我尝试使用 manifest.xml 保留状态，但没有帮助。它保留了除标签字体之外的所有内容。有人可以建议如何做到这一点吗？

感谢您停下来阅读这篇文章。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:51:33.927

您是否尝试过设置`android:configChanges="orientation"`和处理方向更改`onConfigurationChanged()`？

编辑：[这里也解释了](https://stackoverflow.com/questions/10589676/actionbar-scherlock-is-not-refreshed-when-the-orientation-is-changed?rq=1)为什么它不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-29T13:09:40.553

```
**Yes we can do this.

Override onConfigurationChanged
set the action bar title inside a handler with a delay of 200.**

@Override
    public void onConfigurationChanged(Configuration newConfig) {
        super.onConfigurationChanged(newConfig);
        new Handler().postDelayed(new Runnable() {

            @Override
            public void run() {
                //your code to set the action bar title
                setActionBarTitle(title);
            }
        }, 200);
    } 
```

# java - 扩展 ascii 表的 ReadLine 和编码

> ID：14885271
> 
> 赞同：3
> 
> 时间：2013-02-14T22:30:05.790
> 
> 标签：java, android

再会。

我有一个带有西班牙语单词的 ASCII 文件。它们仅包含 A 和 Z 之间的字符，外加 Ñ，ASCII 码 165 ( [http://www.asciitable.com/](http://www.asciitable.com/) )。我用这个源代码得到这个文件：

```
InputStream is = ctx.getAssets().open(filenames[lang_code][w]);
InputStreamReader reader1 = new InputStreamReader(is, "UTF-8");
BufferedReader reader = new BufferedReader(reader1, 8000);

try {
    while ((line = reader.readLine()) != null) {
                 workOn(line);
                 // do a lot of things with line
            }
    reader.close();
    is.close();
} catch (IOException e) { e.printStackTrace(); } 
```

我在这里所说的 workOn() 是一个应该从字符串中提取字符代码的函数，类似于：

```
 private static void workOn(String s) {      
    byte b;
    for (int w = 0; w < s.length(); w++) {
        b = (byte)s.charAt(w);
                    // etc etc etc
            }
} 
```

不幸的是，当 b 代表 Ñ 字母时，我无法将 b 识别为 ASCII 码。b 的值对于任何 ascii 字母都是正确的，并且在处理 Ñ 时返回 -3，即带符号的 253 或 ASCII 字符 ²。没有什么类似于Ñ...

这里会发生什么？我应该如何获得这个简单的 ASCII 码？

让我生气的是我找不到正确的编码。甚至，如果我去浏览 UTF-8 表（[http://www.utf8-chartable.de/）Ñ](http://www.utf8-chartable.de/)是 209dec，253dec 是 ý，165dec 是 ¥。同样，不是我需要的事件亲戚。

所以……请帮帮我！:(

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T22:57:11.593

您确定您正在阅读的源文件是 UTF-8 编码的吗？在 UTF-8 编码中，所有大于 127 的值都保留给多字节序列，而且它们永远不会独立存在。

我的猜测是您正在阅读的文件是使用“代码页 237”编码的，这是原始 IBM PC 字符集。在该字符集中，Ñ 由十进制 165 表示。

许多现代系统使用 ISO-8859-1，它恰好相当于 Unicode 字符集的前 256 个字符。其中，Ñ 字符是十进制的 209。在评论中，作者澄清说 209 实际上在文件中。

如果文件真的是 UTF-8 编码的，那么 Ñ 将被表示为一个两字节的序列，既不是值 165 也不是值 209。

基于上述文件是 ISO-8859-1 编码的假设，您应该能够使用以下方法解决这种情况：

```
InputStreamReader reader1 = new InputStreamReader(is, "ISO-8859-1"); 
```

这将转换为 Unicode 字符，然后您应该找到由十进制 209 表示的字符 Ñ。

# svn - 颠覆安全问题

> ID：14885277
> 
> 赞同：0
> 
> 时间：2013-02-14T22:30:22.323
> 
> 标签：svn, tortoisesvn

在 SVN 我有一个文件夹测试

```
/testing 
```

和三个子文件夹

```
/testing
  /t1
  /t2
  /t3 
```

`testing`我最初为所有三个子文件夹分配了读写权限。签出时，`testing`我可以按预期看到本地计算机上的`t1`, `t2`,`t3`文件夹。

我从我的机器上删除了文件夹，然后只删除了 svn 文件夹`t2`的读写权限。`t2`在更新时，`testing`我仍然看到`t2`里面的文件夹`testing`与我的预期相反。

在新的测试结帐时，我没有看到`t2`里面的文件夹`testing`。

如何确保在更新时我`t2`在删除权限后也看不到文件夹？

# mysql - 当返回的列数是动态的时，如何计算 MySQL 查询的列数？

> ID：14885279
> 
> 赞同：3
> 
> 时间：2013-02-14T22:30:37.747
> 
> 标签：mysql

是否可以检索查询返回的列数？这可以使用绑定的脚本语言（例如 php）轻松完成，但我正在寻找仅 db 的解决方案。

例子：

```
CountCols(SELECT 'a','b','c')
    => 3
CountCols(SELECT * FROM information_schema.session_variables)
    => 2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:37:20.240

这对你有用吗？

```
select 
    count(*)
from
    `information_schema`.`columns`
where
    `table_schema` = 'my_table_schema' and `table_name` = 'my_table_name'; 
```

`table_schema`仅当表名存在于多个数据库中时才需要使用。

* * *

根据您的回复评论，您正在寻找动态的列数。您可以使用临时表执行此操作，但如果不[安装补丁](http://venublog.com/2010/02/03/show-temporary-tables)，则无法访问临时表的数据。

值得注意的是，有[一个类似的未解决的 SO 问题](https://stackoverflow.com/questions/10443672/list-of-temporary-table-columns-mysql)询问如何从临时表中选择列。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:35:01.550

好吧，如果您想知道表中的列，只需执行以下操作：

```
DESCRIBE `table_name` 
```

否则，没有“真正”的方法来获取选择查询中的列数，因为除了选择`*`您选择某些列之外 - >因此**您**将知道您正在选择多少列。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T22:38:00.067

您最有可能在这里找到答案：http: [//dev.mysql.com/doc/refman/5.0/en/columns-table.html](http://dev.mysql.com/doc/refman/5.0/en/columns-table.html)

写出一个带有表名参数的查询，然后查询该表的列并将其汇总。

# javascript - IE8-非 HTML 元素上的 jQuery html

> ID：14885280
> 
> 赞同：0
> 
> 时间：2013-02-14T22:30:36.407
> 
> 标签：javascript, jquery, internet-explorer

我正在使用数据库中的一些 XML 并使用 jQuery 解析它。除了我需要支持的 IE8- 之外，这在任何地方都可以正常工作。我有类似的元素`<stem>`，我可以通过添加让 IE 在某种程度上支持它们

```
document.createElement('stem'); 
```

等问题是其中一些元素可能包含我需要附加到页面上另一个元素的 HTML。就像是

```
$("#page-element").append($xml.find('stem')); 
```

我可以`$xml.find('stem').text()`很好地使用，但是每当我使用`.html`或任何 DOM 操作方法（包括`.append`上面的行）时，IE 都会给出非常有用的错误

> 未指定的错误（jquery-min.js 的第 4 行）

根据我尝试做的事情，我可以得到

> 无法获取属性“替换”的值：对象为空或未定义（第 4 行）

反而。

是否有任何解决方法可以从 IE8- 中的非 HTML 元素（甚至 HTML5 元素）获取 HTML？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T13:52:18.620

IE8- 将允许您毫无怨言地获取这些非 HTML 元素的*文本值。*然后，您可以使用该`.html`方法将其作为普通 html 应用，有趣的是：

```
$("#bar").html($("stem").text()); 
```

[http://jsfiddle.net/ExplosionPIlls/UTHpy/](http://jsfiddle.net/ExplosionPIlls/UTHpy/)

# bash - 在 Bash shell 脚本中发现 2 列 CSV 数据的第一个局部最小值

> ID：14885281
> 
> 赞同：0
> 
> 时间：2013-02-14T22:30:32.883
> 
> 标签：bash, shell, csv, minimum

我想编写一个 Bash shell 脚本函数来返回简单的 2 列 CSV 数据中第一个局部最小数据点的 x、y 坐标。

该函数将一个 Bash 变量（比如“${myData}”）作为输入，该变量存储如下数据：

```
10, 0.14665
20, 0.144971
30, 0.14262
40, 0.142424
50, 0.142370
60, 0.142375
70, 0.142375
80, 0.142375
90, 0.142375
100, 0.142375
110, 0.142306
120, 0.142017
130, 0.141054
140, 0.140148
150, 0.139993
160, 0.139972
170, 0.139958
180, 0.139932
190, 0.139886
200, 0.139876
210, 0.13987
220, 0.139865
230, 0.139861
240, 0.13986
250, 0.139857
260, 0.139855
270, 0.139853
280, 0.139852
290, 0.139847
300, 0.139847 
```

我希望函数找出第一个局部最小点（在这种情况下，这将对应于坐标 50, 0.142370）并返回该点的坐标。你能建议一个简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:55:37.420

您可以在一行上使用 awk，也可以像这里一样缩进：

```
awk '
  NR > 1 { 
    if ($2 > n) { 
      print line; 
      exit(0); 
    } 
  }  
  { 
    line=$0; 
    n=$2 
  }
' <<< "${myData}" 
```

您也可以取出`exit(0);`显示所有局部最小值。

# ruby - 如何正确地将 domain.com/subfolder 指向带有 Rack 的 Ruby 中的静态网站？

> ID：14885283
> 
> 赞同：4
> 
> 时间：2013-02-14T22:30:51.957
> 
> 标签：ruby, static, config, rack

我使用本指南将静态网站部署到 Heroku：[https ://devcenter.heroku.com/articles/static-sites-ruby](https://devcenter.heroku.com/articles/static-sites-ruby)

我创建了这个文件夹结构：

```
- site
  |- config.ru
  |- Gemfile
  |- public
     |- index.html
     |- images
     |- js
     |- css
     |- subfolder
        |- images
        |- js
        |- css 
```

并写信给`config.ru`：

```
use Rack::Static, 
  :urls => ["/images", "/js", "/css"],
  :root => "public"

use Rack::Static, 
  :urls => ["/images", "/js", "/css"],
  :root => "public/subfolder"  

run lambda { |env|
  [
    200, 
    {
      'Content-Type'  => 'text/html', 
      'Cache-Control' => 'public, max-age=86400' 
    },
    File.open('public/index.html', File::RDONLY)
  ]
}

map '/subfolder' do
  run Proc.new { |env|
    [
      200, 
      {
        'Content-Type'  => 'text/html', 
        'Cache-Control' => 'public, max-age=6400' 
      },
      File.open('public/subfolder/index.html', File::RDONLY)
    ]
  }
end 
```

现在我想要`domain.com`指向`public/index.html`和`domain.com/subfolder`指向`public/subfolder/index.html`。登陆页面似乎工作正常，我似乎无法将他们的请求提供给正确的目录（即正确`images`的`js`和`css`文件夹）。

任何想法如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T19:23:50.037

我认为问题在于您在分歧中使用路由：

```
use Rack::Static, 
  :urls => ["/images", "/js", "/css"],
  :root => "public" 
```

例如，上述内容应从`/js/jquery-min.js`文件`public`夹中提供。

```
use Rack::Static, 
  :urls => ["/images", "/js", "/css"],
  :root => "public/subfolder" 
```

现在，如果您尝试以`public/subfolder`相同的方式使用，`/js/jquery-min.js`现在应该从`public/subfolder/js/jquery-min.js`. 这是不一致的。

相反，请尝试以下操作：

```
use Rack::Static, root: 'public',
  urls: %w( /images /js /css /subfolder ) 
```

`/js/*`然后在您需要基本目录、`/subfolder/js/*`需要子文件夹或仅`js/*`在您想要获取与 html 页面的相同目录级别的脚本时路由到资产。

让我知道是否可以解决它！

# javascript - 与 DOM 交互的 jQuery 语句仅适用于“软”刷新，但控制台日志语句是

> ID：14885284
> 
> 赞同：1
> 
> 时间：2013-02-14T22:30:59.297
> 
> 标签：javascript, jquery

我觉得我现在正用头撞墙；我知道据报道，在 jQuery 1.8.0 中，该`document.ready`函数在 IE 9 和 10 中触发得太早了。但是我在 jQuery 最新（1.9.1）下运行了以下代码片段：

```
<script type="text/javascript">
    $(document).ready(function() {
        window.ie = (function(){
            var undef, v = 3, x = 9, div = document.createElement('div'), div2 = document.createElement("div"), all = div.getElementsByTagName('i'), bs = div2.getElementsByTagName("b");
            while ( div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->', all[0] );
            while ( div2.innerHTML = '<!--[if lte IE ' + x + ']><b></b><![endif]-->', bs[0] ) {
                $("body").addClass("lteie" + x--);
            }
            if(v > 4) $("body").addClass("isie" + v);
            return v > 4 ? v : undef;
        }());
    });
</script> 
```

这在我从服务器刷新时有效，但在我使用`ctrl + R`or时无效`f5`。我在本地运行这个应用程序。不确定这是否重要，但我尝试将其设置为始终通过开发工具从服务器刷新，成功刷新一次，然后禁用此设置，它仍然没有完全运行此脚本 - 似乎如果我在其中发出警报在那里，或console.log，它工作正常（不添加类，但即使放在while循环中也会向控制台发出警报或写入*）*。如果它从 server 或 using 刷新`ctrl + f5`，肯定应该替换缓存的副本，对吗？

提前致谢， 问候， 理查德

# c# - 使用 serialport.open() 时出现 I/O 异常错误

> ID：14885288
> 
> 赞同：26
> 
> 时间：2013-02-14T22:31:10.610
> 
> 标签：c#, winapi, serial-port, ioexception, baud-rate

**最后更新**

它一直是我们的固件。在某种程度上令人尴尬，但我很高兴我们可以继续前进，我可以推迟一天学习 Java。我的答案如下。

**更新**

所以我或多或少地放弃了这一点。我认为这是一个归结为 API 的错误，但我既没有时间、资源也没有技能来深入了解它。我认为存在一些 Windows 只是竖起中指的硬件。我已经下载了 Eclipse，切换到 Java 并尝试看看是否可行。如果没有，你会在这里看到我。但是，我绝对很想解决这个问题，所以如果有人有时间或有兴趣深入研究这个问题，我很想看看你想出了什么。显然我会不时回来这里查看。请确保您在评论中“@”我，以便我收到提醒。

* * *

**原帖**

我知道还有其他一些人在处理这个问题，但我希望有人能帮助我。我正在尝试连接到[COM 端口](http://en.wikipedia.org/wiki/COM_%28hardware_interface%29)，但是当我尝试使用以下`serialport.Open()`命令时出现 I/O 异常：

```
System.IO.IOException: The parameter is incorrect.

   at System.IO.Ports.InternalResources.WinIOError(Int32 errorCode, String str)
   at System.IO.Ports.InternalResources.WinIOError()
   at System.IO.Ports.SerialStream.InitializeDCB(Int32 baudRate, Parity parity, Int32 dataBits, StopBits stopBits, Boolean discardNull)
   at System.IO.Ports.SerialStream..ctor(String portName, Int32 baudRate, Parity parity, Int32 dataBits, StopBits stopBits, Int32 readTimeout, Int32 writeTimeout, Handshake handshake, Boolean dtrEnable, Boolean rtsEnable, Boolean discardNull, Byte parityReplace)
   at System.IO.Ports.SerialPort.Open()
   at *programtitlehere.cs*:line 90 
```

我正在使用 Stellaris LM4F232 来模拟 COM 端口。我可以使用 Termite（终端程序）打开、访问并获得良好的结果，但是每当我尝试使用 Visual Studio 时，它甚至都无法连接，并且出现此错误。现在我什至不知道这个错误是什么意思，尽管尝试在其他地方阅读，我仍然感到迷茫。

谁能向我解释这里发生了什么，也许我可以开始尝试解决这个问题？我可以包含更多代码，但老实说那里没有多少；串行端口设备的所有属性都正常，并且仅在此设备上发生（我可以使用 MSP430 没有问题，细节相同）。

我的代码如下所示，供希望查看的人使用（请注意，这只是一个“沙箱”，不是实际程序，但症状是相同的）：

```
try
{
    serialPort1.PortName = "COM5";
    serialPort1.Open();
    if (serialPort1.IsOpen == true)
    {
        textBox1.Text = "CONNECTED";
    }
    else
    {
        textBox1.Text = "NOT CONNECTED";
    }
}
catch (Exception ex)
{
    MessageBox.Show("Error: " + ex.ToString(), "ERROR");
} 
```

其他设置由属性管理器完成（唯一的区别是波特设置为 230400；所有其他设置为默认值）。我可以用这个（一个 MSP430）打开 COM4，从所有意图和目的来看，它都是一个相同的设备。我可以用 Termite 打开 COM5，所以我知道连接良好）。不，我不想同时打开它们。如果您需要更多信息，请告诉我，我可以发布更多信息。

编辑：我在第三天试图解决这个问题，但仍然没有运气。我真的不明白为什么我可以通过终端程序而不是我自己的程序访问这个 COM 端口，而在我所见的情况下，绝对没有区别。是否有可以“检查” COM 端口以查看其属性的程序（我的意思是 Windows 管理器除外）？我变得非常沮丧并且在我的项目中处于停滞状态，直到我弄清楚这一点......

EDIT2：我找到了一个明显的解决方法，但我还没有让它在[这里](http://zachsaw.blogspot.ca/2010/07/serialport-ioexception-workaround-in-c.html)工作。现在我得到了一些不同的 I/O 错误，但至少它是运动（不确定它是否是进度）。我还了解到这是一个 .NET 错误，自 2.0 以来就存在。我仍然希望得到任何帮助，但如果我弄清楚了，我会报告回来。Zach 的代码（上面链接的解决方法）如下所示：

```
using System;
using System.IO;
using System.IO.Ports;
using System.Runtime.InteropServices;
using System.Text;
using Microsoft.Win32.SafeHandles;

namespace SerialPortTester
{
    public class SerialPortFixer : IDisposable
    {
        public static void Execute(string portName)
        {
            using (new SerialPortFixer(portName))
            {
            }
        }

        #region IDisposable Members

        public void Dispose()
        {
            if (m_Handle != null)
            {
                m_Handle.Close();
                m_Handle = null;
            }
        }

        #endregion

        #region Implementation

        private const int DcbFlagAbortOnError = 14;
        private const int CommStateRetries = 10;
        private SafeFileHandle m_Handle;

        private SerialPortFixer(string portName)
        {
            const int dwFlagsAndAttributes = 0x40000000;
            const int dwAccess = unchecked((int) 0xC0000000);

            if ((portName == null) || !portName.StartsWith("COM", StringComparison.OrdinalIgnoreCase))
            {
                throw new ArgumentException("Invalid Serial Port", "portName");
            }
            SafeFileHandle hFile = CreateFile(@"\\.\" + portName, dwAccess, 0, IntPtr.Zero, 3, dwFlagsAndAttributes,
                                              IntPtr.Zero);
            if (hFile.IsInvalid)
            {
                WinIoError();
            }
            try
            {
                int fileType = GetFileType(hFile);
                if ((fileType != 2) && (fileType != 0))
                {
                     throw new ArgumentException("Invalid Serial Port", "portName");
                }
                m_Handle = hFile;
                InitializeDcb();
            }
            catch
            {
                hFile.Close();
                m_Handle = null;
                throw;
            }
        }

        [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern int FormatMessage(int dwFlags, HandleRef lpSource, int dwMessageId, int dwLanguageId,
                                                StringBuilder lpBuffer, int nSize, IntPtr arguments);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool GetCommState(SafeFileHandle hFile, ref Dcb lpDcb);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool SetCommState(SafeFileHandle hFile, ref Dcb lpDcb);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool ClearCommError(SafeFileHandle hFile, ref int lpErrors, ref Comstat lpStat);

        [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern SafeFileHandle CreateFile(string lpFileName, int dwDesiredAccess, int dwShareMode,
                                                        IntPtr securityAttrs, int dwCreationDisposition,
                                                        int dwFlagsAndAttributes, IntPtr hTemplateFile);

        [DllImport("kernel32.dll", SetLastError = true)]
        private static extern int GetFileType(SafeFileHandle hFile);

        private void InitializeDcb()
        {
            Dcb dcb = new Dcb();
            GetCommStateNative(ref dcb);
            dcb.Flags &= ~(1u << DcbFlagAbortOnError);
            SetCommStateNative(ref dcb);
        }

        private static string GetMessage(int errorCode)
        {
            StringBuilder lpBuffer = new StringBuilder(0x200);
            if (
                FormatMessage(0x3200, new HandleRef(null, IntPtr.Zero), errorCode, 0, lpBuffer, lpBuffer.Capacity,
                              IntPtr.Zero) != 0)
            {
                return lpBuffer.ToString();
            }
            return "Unknown Error";
        }

        private static int MakeHrFromErrorCode(int errorCode)
        {
            return (int) (0x80070000 | (uint) errorCode);
        }

        private static void WinIoError()
        {
            int errorCode = Marshal.GetLastWin32Error();
            throw new IOException(GetMessage(errorCode), MakeHrFromErrorCode(errorCode));
        }

        private void GetCommStateNative(ref Dcb lpDcb)
        {
            int commErrors = 0;
            Comstat comStat = new Comstat();

            for (int i = 0; i < CommStateRetries; i++)
            {
                if (!ClearCommError(m_Handle, ref commErrors, ref comStat))
                {
                     WinIoError();
                }
                if (GetCommState(m_Handle, ref lpDcb))
                {
                     break;
                }
                if (i == CommStateRetries - 1)
                {
                     WinIoError();
                }
            }
        }

        private void SetCommStateNative(ref Dcb lpDcb)
        {
            int commErrors = 0;
            Comstat comStat = new Comstat();

            for (int i = 0; i < CommStateRetries; i++)
            {
                 if (!ClearCommError(m_Handle, ref commErrors, ref comStat))
                 {
                     WinIoError();
                 }
                 if (SetCommState(m_Handle, ref lpDcb))
                 {
                     break;
                 }
                 if (i == CommStateRetries - 1)
                 {
                     WinIoError();
                 }
            }
        }

        #region Nested type: COMSTAT

        [StructLayout(LayoutKind.Sequential)]
        private struct Comstat
        {
            public readonly uint Flags;
            public readonly uint cbInQue;
            public readonly uint cbOutQue;
        }

        #endregion

        #region Nested type: DCB

        [StructLayout(LayoutKind.Sequential)]
        private struct Dcb
        {
            public readonly uint DCBlength;
            public readonly uint BaudRate;
            public uint Flags;
            public readonly ushort wReserved;
            public readonly ushort XonLim;
            public readonly ushort XoffLim;
            public readonly byte ByteSize;
            public readonly byte Parity;
            public readonly byte StopBits;
            public readonly byte XonChar;
            public readonly byte XoffChar;
            public readonly byte ErrorChar;
            public readonly byte EofChar;
            public readonly byte EvtChar;
            public readonly ushort wReserved1;
        }

        #endregion

        #endregion
    }

    internal class Program
    {
        private static void Main(string[] args)
        {
            SerialPortFixer.Execute("COM1");
            using (SerialPort port = new SerialPort("COM1"))
            {
                port.Write("test");
            }
        }
    }
} 
```

EDIT3：第 6 天：我仍在努力解决这个问题。我的饮水量很低，但我仍然在努力。我觉得帮助肯定就在眼前。谁找到了这本日记，就把我的遗体带回加拿大并找到妮可。告诉她我爱她。

但说真的，我不知道是什么导致了这个问题。我想知道它是否纯粹在嵌入式方面；可能是因为它是[USB On-The-Go](https://en.wikipedia.org/wiki/USB_On-The-Go) (OTG)，或者因为该设备也能够成为主机。有没有人遇到过这个问题？但它并没有解释为什么我可以使用 Termite（一个终端程序，对于那些刚刚加入我们的观众）。我一直在尝试找到一个开源终端程序，它 a) 可以工作并且 b) 参见 a)。像往常一样，如果我在这里发现这个问题，我会报告回来，因为我现在发现了无数的论坛，听起来人们可以追溯到 2006 年。

EDIT4：所以根据给出的建议，我下载了一个端口监控软件应用程序（我得到了[Eltima Serial Port Monitor](https://www.eltima.com/products/serial-port-monitor/)），它看起来确实像一个波特问题：

![Eltima 的屏幕截图](../Images/50091deaadb21276af2186420eeb55ca.png)

但奇怪的是，无论我设置什么波特，它仍然失败。也有人可以解释上/下的意思吗？我试着用谷歌搜索它，但关键字太笼统了。像往常一样，我会继续报告任何变化。

另外，作为记录，我可以使用 Eltima 以 115200 的波特率（与 Termite 相同）进行连接。不幸的是，这在 Visual Studio 中不起作用。

EDIT5：我们的情节出现了意外的转折。我正在监视当 Termite 连接到有问题的 COM 端口和 BLAM 时会发生什么！Termite 会抛出与我的程序完全相同的错误，但它会*忽略*它。天才，对吧？马虎，但它的工作原理。现在我需要学习如何忽略 IOExceptions。等我弄明白了再汇报。

EDIT6：所以事实证明这是一个波特率问题，但它更深入。我一直在使用 Eltima 串口监控软件，它非常直观易用。我会推荐它。经过[一些研究](https://stackoverflow.com/questions/15014137/how-to-ignore-an-exception-and-complete-the-try)，我了解到您不能忽略此异常并仍然使用 .NET 的库连接到串行端口。

所以我必须深入了解 Win32 API 并编写自己的 API。我找到了一些涉及到这一点的页面，但老实说我以前从未做过这样的事情，所以我可能需要一段时间才能报告，但我一定会弄清楚这一点并回复给大家。受这个问题困扰的人太多了。

我找到了很多论坛和网站，在那里我可以看到完全相同的症状，但除了说“是的，.NET 很烂”之外，没有人真正做过很多事情。我计划编写一个完整的静态库类，然后在我的网站、这里和其他任何我可以发布的地方发布。希望 .NET 会引起注意（这个错误自 2.0 以来就存在）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T01:29:47.330

这来自于串口驱动；它对其中一种设置不满意。由于波特率是一个很好的选择，驱动程序往往只允许高达 115200。尽管当这是一个专用的 CAN 总线产品时，这不应该是一个限制。

解决这个问题的最好方法是使用 Sysinternals 的[Portmon](https://docs.microsoft.com/en-us/sysinternals/downloads/portmon)实用程序；您可以看到正在发送给驱动程序的内容。首先观察它是否终止；这是您已知的工作基线。然后修改 SerialPort 属性，直到初始化命令（如您在 PortMon 中看到的）由您的程序发送的与 Termite 的匹配。只是值，而不是顺序。如果这也没有成功，那就把它带到停车场，然后用你的车把它倒过来几次，然后再买一个品牌。

* * *

更新：它肯定看起来像一个波特率问题。这是 .NET 中的一个问题。它不会像您的终端模拟器程序那样忽略驱动程序的错误返回代码。实际值无关紧要，因为您正在与*模拟*串行端口通信。然而，CAN 总线速度可能存在问题；费率是可变的，我不清楚它们是如何协商的。在过去，这往往是通过 DIP 开关完成的，很可能是驱动程序希望您通过波特率设置来指定速度。盒子上或说明书上应该有关于它的东西。典型速度为 40、250 或 500 kbit/s。制造商肯定会知道；给他们打电话。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-14T08:10:53.980

我遇到了这个帖子中报告的类似问题，但我设法解决了这个问题！

我正在为 VCP 使用 STM32F2xx！

确实是我的固件问题。我忘记在我的 USB 回调中包含串行端口设置！

从 PC 和固件连接串口的过程：

1.  当PC打开串口通讯时，PC会向“配置端点”发送一些命令
2.  在固件中，它将有一个回调，固件将提供所有 USB 信息（他们称之为 USB 描述符）
3.  USB 信息是每个端点的配置，（例如，延迟、数据大小传输和 USB 类型 - 高速或低速）
4.  固件发送完所有信息后，PC 将确认并成功打开 USB 通信
5.  然后，PC 将发送命令从固件中获取串行端口设置
6.  串行端口设置为波特率、数据奇偶校验和位长。
7.  在固件中，它应该将串口设置回复给PC（**我的错误发生在这里；我没有将任何串口设置发送回PC**）
8.  如果成功，PC将启动串口通讯！
9.  如果失败，PC 将给出一个打开的串行端口错误（但请注意，有时会绕过此错误）

在STM32固件代码中：

```
static int8_t CDC_Control_FS (uint8_t cmd, uint8_t* pbuf, uint16_t length)
{
    switch (cmd) {
       case CDC_GET_LINE_CODING:
        {
            // I was missing this part
            uint32_t baudrate = 9600;
            pbuf[0] = (uint8_t)(baudrate);
            pbuf[1] = (uint8_t)(baudrate >> 8);
            pbuf[2] = (uint8_t)(baudrate >> 16);
            pbuf[3] = (uint8_t)(baudrate >> 24);
            pbuf[4] = 0;
            pbuf[5] = 0;
            pbuf[6] = 8;
            break;
        }:
.... 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-01-08T14:34:12.690

我遇到了同样的情况。我正在尝试在 /dev/ttyUSB0 将串行通信连接到我的 3G USB 加密狗（华为 E303F）。我在[Raspbian](http://en.wikipedia.org/wiki/Raspberry_Pi#Software) ( [Raspberry Pi 2](https://en.wikipedia.org/wiki/Raspberry_Pi#Generations_of_released_models) )中使用[Mono 。](http://en.wikipedia.org/wiki/Mono_%28software%29)在我的开发 PC 和 macOS 上，我的程序运行良好。但是当我将它部署到 Raspbian 中时，我在 Serial.Open() 上遇到了*IOException Broken Pipe错误。*

 *我花了三天时间调试，尝试了所有可能的解决方案。最后我发现我必须设置...

```
serialPort.DtrEnable = true;
serialPort.RtsEnable = true; 
```

在调用 .Open() 之前。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-19T19:36:57.407

至此，我们惊心动魄的故事就此画上句号。它一直是固件（即嵌入式设备上的代码）。我们改变了一些功能，基本上是四处寻找、切碎、添加并完全清理了代码，瞧，代码正在工作。[这张图](http://weknowmemes.com/2012/09/the-truth-behind-programming-problems/)总结的很好。诅咒你的固件！！

但是，我的（冗长的）问题中描述的错误对于很多人来说仍然存在，我知道还有很多人仍然拥有它。我只能说祝你好运并四次检查你的固件（显然现在三次检查还不够）。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2018-05-08T15:54:47.667

我有同样的问题并将波特率设置为 1*修复它*！*

# objective-c - 是否可以使用公共 API 在 Web 视图中启用本地存储？

> ID：14885291
> 
> 赞同：0
> 
> 时间：2013-02-14T22:31:11.073
> 
> 标签：objective-c, xcode, webview, xcode4.5

我是 Xcode 和 Objective-C 的新手。我之前问过一个问题，为什么我的本地存储代码不起作用，但现在根据进一步的研究，Xcode 4.5.2 中的公共 API 似乎不支持本地存储？

我按照本教程进行操作：[http](http://www.lostdecadegames.com/completing-your-native-mac-osx-app-built-in-h/) ://www.lostdecadegames.com/completing-your-native-mac-osx-app-built-in-h/尝试启用本地存储，但它适用于 Xcode 4.0.1，我是使用 Xcode 4.5.2 版本。我得到了 web 视图来加载我的 HTML5 web 应用程序，但我还没有弄清楚如何启用本地存储。

我的问题是，是否可以使用 Xcode 4.5.2 中的公共 API 在 Web 视图中启用本地存储？我已经阅读了是和否以及有人会如何做到这一点，但还没有找到一个实际的工作示例？我还在 Stack Overflow 上发现了一些关于它的问题，但它们引用了旧版本的 Xcode，因此它们不再工作了。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T22:39:07.193

不，与本地存储相关的 WebPreferences 上的两种方法都是 SPI。

# php - 如何检查日期是否超过 PHP 中的数值

> ID：14885295
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:31:37.360
> 
> 标签：php, date

嘿伙计们，可以说我有一个成员放了 20 天。因此，如果有会员 20 天后，可以说没有登录，它将改变那里的状态。但仅基于在 MySQL 数据库中写入的状态更改日期为`year-month-day`. 因此，如果他的状态更改日期已经过去了 20 天，那么他的状态就会发生变化。

如果您能帮助我了解如何执行此操作，我将不胜感激！

大卫

更新：

代码：

```
$newStatus = "Non-Active - Driver Chose Non-Compliance";

    $sql = "SELECT username,ATF FROM members WHERE username = 'test'";
    $getcsvuser = $DBH->prepare($sql);
    $getcsvuser->execute();
    while($row = $getcsvuser->fetch(PDO::FETCH_ASSOC)){

        $memusername = $row['username'];
        $memATF = $row['ATF'];
        if ($memATF != 0 || $memATF != "0")
        {
        $tsql = "SELECT username,status,memberview ,statuschangedate FROM csvdata WHERE memberview =:user";
        $tgetcsvuser = $DBH->prepare($tsql);
        $tgetcsvuser->execute(array(':user' => $memusername));
        while($trow = $tgetcsvuser->fetch(PDO::FETCH_ASSOC)){

            $csvstatus = $trow['status'];
            $csvusername = $trow['username'];
            $csvdate = $trow['statuschangedate'];

            if($csvstatus == "Open" || $csvstatus == "Enrolled - Policyholder Follow-Up Required" || $csvstatus == "Enrolled - Employee Follow-Up Required" || $csvstatus == "Non-Active - Insurance Cancelled" || $csvstatus == "Non-Active, Unable to Monitor - Incidental Business use Exclusion" || $csvstatus == "Non-Active - Employee Not Covered Under Listed Policy" || $csvstatus == "Non-Active - PolicyHolder Cancelled Additional Interest")
            {

                $newsql = "UPDATE csvdata SET status = :newstatus WHERE statuschangedate < NOW() - INTERVAL :atf DAY AND username =:mem";
                $newgetcsvuser = $DBH->prepare($newsql);
                $newgetcsvuser->execute(array(':newstatus' => $newStatus, ':atf' => $memATF, ':mem' => $csvusername));
                while($rrow = $newgetcsvuser->fetch(PDO::FETCH_ASSOC)){
                    echo "working";
                }
            }

        }
        }

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:36:35.190

它可以是两件事的组合：

mysql 更新要更改的用户：

```
update
  members
set
  status = 'foo'
where
  status_change_date < NOW() - INTERVAL 20 DAY 
```

第二部分将是一个 cron 作业，每天运行该查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:36:45.777

那个怎么样：

```
UPDATE tablename
SET inactive = 1
WHERE date_field < DATE_SUB(NOW(), INTERVAL 20 DAY) 
```

`cronjob`您可以每晚运行一次此查询。

所以这可以在不使用 PHP 逻辑的情况下完成，除了执行这个 SQL 查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T22:37:30.747

我没有对此进行测试，但它应该很接近。

```
//$dbVal = $row["databaseColumn"];
$dbVal = "2013-01-24";  //For example
$now = Date();

$diff = abs($now - strtotime($dbVal));

$daysSince = floor(($diff/(60*60*24));
if ($daysSince >20){
    //Set status in DB;
} 
```

合并@popnoodles 解决方案：

```
//$dbVal = $row["databaseColumn"];
$dbVal = "2013-01-24";  //For example
$expireTime = 20;

$diff = strtotime($dbVal) - strtotime("today - $expireTime days");
if ($diff < 0 ){
    //Set status in DB;
} 
```

# jira - 如何根据下拉列表使必填字段“不需要”？

> ID：14885296
> 
> 赞同：1
> 
> 时间：2013-02-14T22:31:33.133
> 
> 标签：jira

我几乎觉得问这个很傻，但我必须尝试：

我们有一个包含许多必填字段的屏幕。但是，如果在下拉列表中进行了某个选择，我们不再需要它们。这甚至可以在 JIRA 中做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T09:42:27.790

您可以使用[JIRA 行为插件](https://marketplace.atlassian.com/plugins/com.onresolve.jira.plugin.Behaviours)根据下拉菜单更改必填字段，例如：

```
FormField dropdown = getFieldByName("My Dropdown")
FormField other= getFieldByName("Other field")

if (dropdown.getFormValue() == 'A') {
   other.setRequired(false)
} else {
   other.setRequired(true)
} 
```

正如@mdoar 提到的，行为插件不能很好地工作，因为在 JIRA 5.2 中引入了内联编辑。一种解决方法是使用 JS 作为字段进行客户端验证和显示（禁用该字段），以及使用工作流验证脚本（例如使用[脚本](https://marketplace.atlassian.com/plugins/com.onresolve.jira.groovy.groovyrunner)运行器）进行服务器端验证。

# python - Django 1.4 未知命令：'runserver'

> ID：14885299
> 
> 赞同：11
> 
> 时间：2013-02-14T22:31:47.270
> 
> 标签：python, django, python-2.7

我的 python 路径中的某些内容必须更改，因为现在我无法运行。

```
python app/manage.py runserver 
```

我得到的输出是

```
Unknown command: 'runserver'
Type 'manage.py help' for usage. 
```

我查看了我的环境的 PYTHONPATH 和 PATH 变量，但我无法弄清楚它为什么不运行。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-15T18:08:39.647

我找到了我的问题的答案。

*   如果您的设置有错误，manage.py 将吞下异常并报告该命令不存在。
*   这导致我错误地假设我的 python 路径或 venv 环境被搞砸了。

如果要诊断此问题，请运行...

```
python app/manage.py help 
```

...它会显示异常。当然，这是 django shell 在告诉我找不到该命令后所推荐的。

这显然是 Django 1.4 中的一个错误。在我看来，无论您运行什么管理命令，都应该报告异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T11:27:46.397

浏览`manager.py`代码，`django.core.management`我可以提出一些建议。

首先，检查文件是否`<some_path>/django/core/management/commands/runserver.py`存在。

二、运行：

```
>>> import sys
>>> sys.path 
```

如果上述`<some_path>`内容不在此列表中，则必须设置`PYTHONPATH`变量。

第三，（这是所有镜头中最长的）如果您已更改 的`DEFAULT_PORT`，请`runserver`尝试将其更改回`8000`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-27T09:29:29.360

我同意OP。我遇到了同样的问题，结果发现是一个错误`settings.py`：
在我使用的settings.py中`os.environ[something]`，那些环境变量被加载到apache启动脚本中。如果我从命令行运行`manage.py`，它不知道`os.environ[something]`会发生什么错误。

因此，对于在这里寻找解决方案的任何人，建议检查运行 django 项目和纯 manage.py 之间的**情况差异**，也许您会发现问题所在。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-05T07:27:52.927

我将把我的答案添加到我遇到的同样问题上。这与 Django 版本无关，但在我的项目的一个旧实例中，我提供了自己的 Django 副本，而不是从 pip 安装。后来我决定用 Pip 安装 Django。

当我在服务器上拉取更改时，我的存储库的 Django 文件副本被删除，但 .pyc 文件没有被删除。`manage.py`仍然会导入旧的 .pyc 文件，使导入中断一半，错误是相同的“未知命令：运行服务器”。

自然，完全删除包含 .pyc 文件的文件夹可以解决问题。

# wordpress-theming - 似乎无法为自定义 Wordpress 主题小部件化侧边栏

> ID：14885303
> 
> 赞同：0
> 
> 时间：2013-02-14T22:32:00.903
> 
> 标签：wordpress-theming, wordpress

我被请来为客户的现有网站制作一个快速的 Wordpress 主题。使用现有网站的 CSS 和 JS 以及 HTML 框架，我能够让主题以几乎所有方式工作，除了一些。对于初学者，我似乎无法“小部件化”侧边栏。

在尝试注册小部件之前，侧边栏的 HTML 如下：

```
<div class="wms-column wms-column-nav">
    <div class="wms-column-nav-body">
      <h2><a href="/">Blog</a></h2>
    </div>
</div> 
```

请记住，我可以在内部 div 中添加 html，但不能更改两个外部 div。他们必须留下。

在阅读了[http://codex.wordpress.org/Widgetizing_Themes](http://codex.wordpress.org/Widgetizing_Themes)并尝试了几个示例之后，我得到的只是错误。自然，小部件区域因此拒绝在仪表板 > 外观中显示。

如何将上述代码转换为接受小部件的侧边栏？有 id="sidebar" 有必要吗？需要标题吗？Codex 页面似乎暗示您格式化标题的方式取决于整体方法（例如：div 与列表）。我得到的印象是您正在制作一个小部件反复使用的模板来踢出内容。我认为您只是在告诉 WP 将小部件放在哪里（并且它们的所有内容/格式/复杂性都在小部件的代码中处理）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:19:45.843

小部件化主题基本上分为两个步骤。

1.  注册您的侧边栏
2.  将注册的侧边栏添加到主题

## 在`functions.php`

[来自 Codex 页面`register_sidebar`](http://codex.wordpress.org/Function_Reference/register_sidebar)；

```
 register_sidebar(array(
   'name' => __( 'Right Hand Sidebar' ),
   'id' => 'right-sidebar',
   'description' => __( 'Widgets in this area will be shown on the right-hand side.' ),
   'before_title' => '<h1>',
   'after_title' => '</h1>'
 )); 
```

## 在您的主题模板中

添加对 的调用[`dynamic_sidebar`](http://codex.wordpress.org/Function_Reference/dynamic_sidebar)。这可能会在`sidebar.php`

```
<div class="wms-column wms-column-nav">
    <div class="wms-column-nav-body"><?php
      dynamic_sidebar( 'right-sidebar' ); // your widgets will go here ?>
    </div>
</div> 
```

请注意，其中使用的参数与注册侧边栏时使用的参数`dynamic_sidebar`匹配。`id`应该是这样的。当然，实现可能更复杂——包括例如硬编码的后备侧边栏或多个侧边栏——但这是基本的启动包。

# .htaccess - .htaccess php_value auto_prepend_file 产生 500 错误。我怎样才能解决这个问题？

> ID：14885311
> 
> 赞同：5
> 
> 时间：2013-02-14T22:32:44.937
> 
> 标签：.htaccess, php

我的 .htaccess 如下：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /school
RewriteRule ^([a-zA-Z0-9]+)/$ index.php?page=$1
RewriteRule ^([a-zA-Z0-9]+)$ index.php?page=$1

php_value auto_prepend_file ./inc/library.php

ErrorDocument 404 /school/index.php?page=404 
```

截至`./`，我读到表示相对路径。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T00:05:47.287

注意：此信息几乎是从[另一个网站](http://support.tigertech.net/php-value)逐字获取的，我认为它很好地解释了这个问题，我高度怀疑这是问题所在：

* * *

### 在 .htaccess 文件中使用 php_flag 或 php_value

一些 PHP 脚本建议在 .htaccess 文件中使用“php_value”或“php_flag”命令，如下例所示：

```
php_value  include_path         ".:/usr/local/lib/php" 
php_flag   display_errors       Off
php_value  upload_max_filesize  2M
php_value  auto_prepend_file    "./inc/library.php" 
```

但是，有些服务器以“CGI 模式”运行 PHP（不是作为 Apache 模块），因此您不能在 .htaccess 文件中使用“php_value”或“php_flag”命令。如果您尝试这样做，您将看到“内部服务器错误”消息。

不过，您可以修改 php.ini 文件以获得相同的效果。事实上，修改 php.ini 实际上比使用 php_value 或 php_flag 更灵活：有很多东西不能使用 .htaccess 文件覆盖，但几乎可以覆盖 php.ini 文件中的任何 PHP 设置。

要获得与上述 .htaccess 行相同的效果，您只需将这些行添加到您的自定义 php.ini 文件中：

```
include_path = ".:/usr/local/lib/php" 
display_errors = Off
upload_max_filesize = 2M
auto_prepend_file = "./inc/library.php" 
```

注意：有些系统需要在路径周围加上引号，有些则不能使用引号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-03T09:37:38.737

如果您想在将 php 作为 CGI/FastCGI 应用程序运行时在 .htaccess 文件中使用，您可以使用[htscanner PHP 模块。](http://pecl.php.net/package/htscanner)`php_value`

# javascript - 在 Safari 5.1.7 中创建 WebWorker 引发 DOM 异常 18

> ID：14885313
> 
> 赞同：2
> 
> 时间：2013-02-14T22:32:47.997
> 
> 标签：javascript, web-worker

我正在尝试创建一个网络工作者，但在尝试在 Safari 5.1.7 中构建工作者时遇到了 DOM 异常。这发生在某些域上，并且仅在 Safari 中。例如，如果您访问 CNN.com 并输入 var `test = new Worker("foo.js")`，您将收到 DOM 异常 18。有人知道为什么会发生这种情况吗？谢谢

只是添加更多细节..我已经在新版本的 Safari 上测试过，它没有同样的问题。另一个似乎存在类似问题的域示例是 nordstrom.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:53:14.160

这是旧版本 WebKit 中的一个错误：[https ://bugs.webkit.org/show_bug.cgi?id=67978](https://bugs.webkit.org/show_bug.cgi?id=67978)

当您设置“document.domain”并在设置域后尝试创建工作人员时会发生这种情况。唯一的解决方法是在设置“document.domain”之前创建工作者。

# ruby - 设置 Ruby 运行时配置参数？

> ID：14885314
> 
> 赞同：1
> 
> 时间：2013-02-14T22:32:51.653
> 
> 标签：ruby, configuration

我希望将运行时参数传递给我的 Ruby 代码。我有 Java 背景，在大多数情况下，如果我想覆盖配置，我会使用具有合理默认值的系统属性。

例如，如果我针对 localhost 的 REST API 编写了一个测试，然后想要针对集成环境运行它并想要调整基本 URL：

```
$ rake -Cbaseurl=https://i-env.company.com/tbse/ test 
```

Ruby中是否有系统属性的等价物？人们正在使用标准模式吗？

我知道如何使用/加载 YAML 配置，以及参考环境变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:57:45.607

Ruby 来自 UNIX 世界，这里是命令行参数和环境变量。

命令行参数应用于通常更改且依赖于运行的内容。这些是诸如详细标志、输出文件或目标 URL 之类的东西。使用 Ruby stdlib OptionParser 访问这些。

环境变量适用于更改频率较低的事物，并且通常跨应用程序。诸如系统可执行路径（`$PATH`）之类的东西。使用内置的 Ruby`env`对象来访问这些。

对于其他事情，例如配置，请使用配置文件。在 Ruby 中，这些通常采用 YAML 格式。为这些使用 Ruby stdlib`yaml`库。

# java - 正则表达式：在 .java 文件中查找 Java 类的模式

> ID：14885315
> 
> 赞同：2
> 
> 时间：2013-02-14T22:32:52.340
> 
> 标签：java, regex

我想在阅读 .java 文件时找到一个类的名称。我现在使用这个正则表达式没有返回匹配项：

```
\\s*[public][private]\\s*class\\s*(\\w*)\\s*\\{ 
```

到目前为止，这是我的代码：

```
import java.io.*;
import java.util.*;
import java.util.regex.*;

public class HW4Solution {

    public static void main(String [] args){
        //Prompt user for path to file.
        File file = null;
        Scanner pathScan = new Scanner(System.in);
        while (file == null || !file.exists())
        {
            System.out.print("Enter valid file path: ");
            file = new File(pathScan.next());
        }
        pathScan.close();
        System.out.println("File: " + file.getPath() + " found.");

        //Read file line by line into buffered reader
        StringBuffer componentString = new StringBuffer(100);
        String currentLine;
        BufferedReader bufferedReader = null;
        try {
            bufferedReader = new BufferedReader(new FileReader(file.getPath()));
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }

        //TODO: Find class declarations
        //TODO: Find superclasses
        //TODO: Find instance variable declarations
        //TODO: Find method signatures
        //TODO: Find access modifier
        //TODO: Find return type
        //TODO: Find method name

        //Creating patterns to look for!
        //Class declarations
        Pattern classDeclarationPattern = Pattern.compile("\\s*[public][private]\\s*class\\s*(\\w*)\\s*\\{");
        try {
            while((currentLine = bufferedReader.readLine()) != null){
                Matcher classDeclarationMatcher = classDeclarationPattern.matcher(currentLine);
                if(classDeclarationMatcher.group(1) != null){
                    componentString.append("Found class declaration: " + classDeclarationMatcher.group(3) + "\n");
                    /*if(classDeclarationMatcher.group(5) != null){
                        componentString.append("\tsuperclass: " + classDeclarationMatcher.group(5) + "\n");
                    }*/
                    System.out.println(classDeclarationMatcher.group());
                }
            }
        }
        catch (IOException e) {
            e.printStackTrace();
        }
        finally{
            try{
                if (bufferedReader !=null) {
                    bufferedReader.close();
                }
            }
            catch(IOException e){
                e.printStackTrace();
            }
        }

        System.out.println(componentString.toString());

    }
} 
```

我最终希望能够确定一个类声明是否有一个超类并得到它，但现在我在获取类名时遇到了足够的麻烦（我不应该这样做）。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T22:39:20.480

`[public]`与您认为的不匹配。它是一个字符类，匹配`public`. 您应该使用`pipe`来匹配替代词。

您可以使用以下正则表达式，扩展以考虑`super`类或接口：-

```
Pattern.compile("\\s*(public|private)\\s+class\\s+(\\w+)\\s+((extends\\s+\\w+)|(implements\\s+\\w+( ,\\w+)*))?\\s*\\{"); 
```

请注意，在匹配和关键字之间的空格时，应使用`\\s+`with`+`量词。因为您希望那里至少有空间。将匹配空格，这是不正确的，因为它是无效的。`public|private``class``1``\\s*``0``publicclass`

除此之外，这里还可以考虑更多选项。像`static inner classes`, 或`generic classes`, 这将需要在那里进行小的修改，您可以自己进行。我刚刚对如何处理提供了一些见解。

* * *

此外，还有一件更重要的事情。在从组中获取结果之前，您应该调用`Matcher#find()`方法来进行实际匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-20T13:13:34.313

类声明的正则表达式：

```
private String classRegExp = "(((|public|final|abstract|private|static|protected)(\\s+))?(class)(\\s+)(\\w+)(<.*>)?(\\s+extends\\s+\\w+)?(<.*>)?(\\s+implements\\s+)?(.*)?(<.*>)?(\\s*))\\{$"; 
```

对于接口声明：

```
private String interfaceRegExp = "(((|public|final|abstract|private|static|protected)(\\s+))?interface(\\s+)(\\w+)(<.*>)?(\\s+extends\\s+\\w+)?(<.*>)?(\\s+implements\\s+)?(.*)?(<.*>)?(\\s*))\\{$"; 
```

对于枚举声明：

```
private String enumRegExp = "((((public|final|private|static|protected)(\\s+))?enum(\\s+)(\\w+)?(\\s+implements\\s+\\w+)?(.*)?\\s*))\\{$"; 
```

# cakephp - CakePHP - 一页上有两个模型，无法获取this->request->data automagic field population

> ID：14885321
> 
> 赞同：1
> 
> 时间：2013-02-14T22:33:13.153
> 
> 标签：cakephp, cakephp-2.0

我有两个控制器：事件和结果。事件有很多结果，结果属于事件。我可以保存得很好，但是当我去编辑时，我只能获取表单的事件部分的信息，自动进入。

我像这样构建结果表单信息：

```
$option_number = 5;
        for ($i = 0; $i < $option_number; $i++) {
           echo $this->Form->select("Result.{$i}.object_id", $qual_options, array('empty' => false, 'class' => 'result-name'));
           echo $this->Form->hidden("Result.{$i}.id");
           echo $this->Form->hidden("Result.{$i}.type", array('value' => 'qual'));
           echo $this->Form->hidden("Result.{$i}.action", array('value' => 'add')); ?>
} 
```

在后端，当我这样做以获得自动人口时：

```
if ($this->request->is('get')) {
            $this->request->data = $this->Event->findById($id);
} 
```

它工作得很好，但我不知道如何让它显示结果。我尝试了很多事情，最有可能是：

```
$this->request->data['Result'] = $this->Result->findAllByEventId($id); 
```

有了这个，我最终得到了一个数据结构，如：

```
[Result] => Array
        (
            [0] => Array
                (
                    [Result] => Array
                        (
                            [id] => 1
                            [object_id] => 1
                            [type] => qual
                            [action] => add
                            [amt] => 10
                            [event_id] => 1
                        )

                )

            [1] => Array
                (
                    [Result] => Array
                        (
                            [id] => 2
                            [object_id] => 2
                            [type] => qual
                            [action] => add
                            [amt] => 1
                            [event_id] => 1
                        )

                )         

            ... etc.

        )

) 
```

这绝对看起来很可疑，我似乎无法操纵它来工作。

**更新**我应该提到这一点；这就是我保存数据时的样子，我想模仿它！

```
[Result] => Array
    (
        [0] => Array
            (
                [object_id] => 1
                [type] => qual
                [action] => add
                [amt] => 0
                [event_id] => 3
            )

        [1] => Array
            (
                [object_id] => 1
                [type] => qual
                [action] => add
                [amt] => 1
                [event_id] => 3
            ) 
```

可以看到后面的每个数字键都有信息；相反，我的数字键在它们名称 Result 中也有一个数组，我不知道如何让它正确消失！:} 我总是可以循环并以 CakePHP 想要的格式构建它，但我想正确地做到这一点。上面那一行是需要改变的，但我已经没有想法了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T00:54:59.947

仅仅`find('first')`对事件使用呢？由于它是 hasMany，它会在一个`[Result]`带有许多数字键的键中返回 Result 模型。

```
$this->request->data = $this->Event->find('first', array(
  'conditions' => array(
    'Event.id' => $id
  ),
  'contain' => array(
    'Result'
  )
)); 
```

这将返回如下内容：

```
array(
  'Event' => array(
    'id' => 1,
    'name' => 'event name'
  ),
  'Result' => array(
    0 => array(
      'id' => 1,
      ...
    ),
    1 => array(
      'id' => 2,
      ...
    )
  )
); 
```

如果需要，您可以取消设置 Event 键。

# javascript - Ember.js：根据访问方式从我的固定装置数组中清除数据

> ID：14885322
> 
> 赞同：0
> 
> 时间：2013-02-14T22:33:24.110
> 
> 标签：javascript, arrays, binding, ember.js, fixtures

我有 2 个控制器。第一个，KeywordsIndexController 看起来像这样：

```
App.KeywordsIndexController = Em.ArrayController.extend({

    contentBinding: "App.Keyword.FIXTURES"

}); 
```

...另一个，KeywordsNewController 是一个空白数组控制器：

```
App.KeywordsNewController = Em.Controller.extend({
}); 
```

我也有 2 个视图，KeywordsIndexView 和 KeywordsNewView，每个视图中都有一个函数。KeywordsIndexController 负责列出关键字并删除单个关键字。KeywordsNewController 负责添加一个新关键字，然后路由回关键字列表（索引）。它们看起来像这样：

```
App.KeywordsIndexView = Em.View.extend({

    templateName: 'templates/keywords/index',

    delKeyword: function(e){
        var obj = App.Keyword.FIXTURES.findProperty("name", e._data.attributes.name);
            App.Keyword.FIXTURES.removeObject(obj);
        }

});

----------------------------------------

App.KeywordsNewView = Em.View.extend({

    templateName: 'templates/keywords/new',

    addKeyword: function(){
        App.Keyword.FIXTURES.pushObject({

            id: App.Keyword.length,
            name: newKey.value,
            scode: '55678',
            campaign: null

        });
        this.get('controller.target.router').transitionTo('keywords.index');
    }

}); 
```

**问题**

这两个事件都按预期自行工作。如果您直接进入新的关键字页面，它会很好地工作。当您在尝试添加新关键字之前访问关键字列表页面时会出现问题。当您通过该路线时，当它尝试添加新关键字时会出现以下错误：

```
Uncaught TypeError: Cannot call method 'hasOwnProperty' of undefined
Uncaught TypeError: Cannot read property 'name' of undefined 
```

此外，当我尝试打印出 App.Keyword.FIXTURES 数组时，它会作为一个空类返回。

我不确定什么会导致这种行为，非常感谢任何想法/帮助。

**额外学分**

在测试环境（即FIXTURES）中，除了“App.Keyword.FIXTURES”之外，还有更好的方法来引用该对象吗？

**谢谢！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T09:43:28.927

> 在测试环境（即FIXTURES）中，除了“App.Keyword.FIXTURES”之外，还有更好的方法来引用该对象吗？

`App.Keyword.all()`在`model`您的路线方法中使用：

```
model: function(controller){
    return App.Keyword.all();
} 
```

这是一个*实时*数组，如果稍后添加一些模型，它将被更新。

另外，不要将对象推入`FIXTURES`，只需用于`createRecord`创建一个新对象：

```
App.Keyword.createRecord({
    id: App.Keyword.length,
    name: newKey.value,
    scode: '55678',
    campaign: null
}); 
```

# javascript - 检测图像下载完成的最佳方法是什么 - onload 或 addEventListener()？

> ID：14885324
> 
> 赞同：16
> 
> 时间：2013-02-14T22:33:39.283
> 
> 标签：javascript

为了检测图像何时完成下载，我应该使用哪种方法？

```
image.onload = function () {} 
```

或者

```
image.addEventListener("load", function () {} ); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T22:35:30.880

`onload:`

1.  仅支持单个侦听器。
2.  适用于所有浏览器。
3.  `onload`您可以通过清除该属性来取消绑定事件处理程序。

`addEventListener:`

1.  支持多个监听器。
2.  不适用于较旧的 IE 浏览器（它们使用`attachEvent`）。
3.  您取消绑定`removeEventListener()`需要标识原始事件侦听器的信息的侦听器。

如果`addEventListener`支持并且您只需要一个侦听器，那么您可以使用其中任何一个。

如果它是一段简单的自包含代码，没有其他人会弄乱，那么使用`onload`. 如果它是其他开发人员可能会弄乱的更复杂的软件，并且需要任何类型的可扩展性，并且您对事件侦听器具有跨浏览器支持，那么`addEventListener()`它更灵活并且可能更理想。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:43:06.990

`image.addEventListener("load", function() {} );`不适用于所有浏览器，但假设您有备份并使用`image.attachEvent("onload", function() {})`

```
if(image.addEventListener) { image.addEventListener("load",function() {}); }
else { image.attachEvent("onload", function() {}); } 
```

这样做的好处是您不会覆盖图像上已经存在的任何 onload 事件，并且您的 onload 事件不会被任何其他代码覆盖。

通常不建议直接修改 DOM Element 的“onload”属性，因为你可能会想“嘿，我可以通过设置节省几行代码，而且我只需要一个侦听器，所以我只是设置它而不是而不是使用 addEventListener/attachEvent”——但它总是会导致“如果我以后需要添加其他东西怎么办？”

出于这个原因，javascript 开发人员通常使用库来附加事件，因此您可以用一行代码自信地添加侦听器，它可以在所有浏览器中工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-09-24T14:55:27.200

尝试

```
if(image.complete){
  //....
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-09-20T10:08:59.847

两者，`Image.complete`以及`image.onload`似乎在 Webkit 中都不起作用，至少在我的手机上是这样。他们`false`无限返回。虽然它在歌剧中工作，所以代码可能没问题。

因此，我目前正在使用至少在 Opera 和 webkit 中有效的技巧。我准备好了一个 1x1 像素的占位符图像。现在我将 设置`src`为要加载的图像并且（通常是一个不好的做法，但这是一个没有该图像就无法启动的游戏）我进入一个更新一些“正在加载”的启动画面 gfx 的循环，但基本上只是检查宽度图像，是否`image.width`大于 1 像素。

就像我说的，只用 opera 和 webkit 测试过。我使用它来加载地图集图像并将包含的图块复制到画布上的单个图像。完成后，`src`atlas 图像的 设置回 1x1 占位符，因此可以再次以这种方式使用它。为了完全节省，还应该等到占位符再次宽度为 1 像素，然后再以这种方式重用它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-03T17:12:28.750

```
const handleImage=()=>{}
image.addEventListener("load",handleImage);  //adding a eventListener
image.removeEventListener("load",handleImage);  //removeing a eventListener 
```

# .net - EventInfo.GetRaiseMethod() 始终为空

> ID：14885325
> 
> 赞同：12
> 
> 时间：2013-02-14T22:33:48.560
> 
> 标签：.net, events, reflection

我有：

```
event EventHandler MyEvent;

MyEvent += new EventHandler(someHandler);

if(this.GetEvent("MyEvent").GetRaiseMethod() == null)
{
  // Always true...
} 
```

但为什么？添加处理程序后，不`GetRaiseMethod()`应该设置为`someHandler`'s`MethodInfo`吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T02:07:25.023

这是 C# 的一个怪癖，它不支持 raise 访问器。仅添加和删除。其他 .NET 语言，如 VB.NET、F# 和 C++/CLI 确实支持它们，并且在 CLI 规范中对其进行了很好的定义，在该规范中命名为“fire”。

很难解释为什么 C# 团队跳过了它，我从来没有见过一个很好的解释。纯粹的猜测：这可能与他们希望避免为没有人订阅的事件构建事件参数的成本有关。在 GUI 框架中很常见。有点损失，C# 程序员编写标准 raise 事件模式以及在忘记检查 null 时诊断 NRE 肯定已经浪费了数十万小时。C# v6 中的 elvis 运算符 ( `?.`) 终于让它变得更容易了。

无论如何，如果您反映用 C# 编写的代码，您将永远不会从 GetRaiseMethod() 获得任何内容。但是，当它用 VB.NET、F# 或 C++/CLI 编写时，您总是会得到一个非空值。如果您需要通过反射引发事件，则必须挖掘支持委托变量，这可能会很痛苦。如果使用了自动生成的添加/删除访问器，则支持变量与事件具有相同的名称，您可以使用 Type.GetField() 检索它，使用 BindingFlags.NonPublic | BindingFlags.Instance。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T22:54:19.840

raise 方法是 CLI 规范中提到的除“add”和“remove”之外的访问器之一——但是，大多数事件根本不实现此功能。特别是，c# 明确不支持这一点 - 所以是的：那将始终返回 null。

# python - 使用 gdb 7 对调试 Python 程序的支持需要什么？

> ID：14885328
> 
> 赞同：16
> 
> 时间：2013-02-14T22:33:55.073
> 
> 标签：python, debugging, ubuntu, gdb, centos

我想使用 gdb 7 对调试 Python“劣质进程”的支持。

我需要什么才能做到这一点？

例如：

*   运行劣质 Python 的配置脚本需要使用哪些标志？

*   劣质 Python 进程是否必须是 Python 2.7 或更高版本（我看到那是 Python 源代码树中的 gdb 支持的部分提交的时候）？还是只有 gdb 进程本身需要 Python 2.7？

*   需要安装哪些文件可能不会被所有发行版打包？例如，在 packages.ubuntu.com 上，我没有得到 python-gdb.py 的任何点击，我认为这是需要的。

知道特定发行版需要什么会非常方便。我对 Ubuntu 和 Centos 的需求特别感兴趣。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-16T00:01:39.313

Python 似乎需要编译`--with-pydebug`（在 Ubuntu 12.04 上，包`python-dbg`包含一个合适的 Python 可执行文件，本身称为`python-dbg`）。劣质的 Python 不需要是 Python 2.7 -- 2.6 可以成功加载 2.7 gdb 扩展（请参阅下面的调试会话）。至少在 Ubuntu 12.04 上，安装的定义 gdb 扩展的文件称为`libpython.py`，而不是`python-gdb.py`（由于某种原因，构建 Python 会产生一个包含这两个文件的构建目录——它们是相同的）。

但是，我认为目前无法使用生产核心文件进行调试：看起来 Python 劣质进程的 gdb 扩展试图获取在生产二进制文件中得到优化的变量（例如，中的 f 变量`PyEval_EvalFrameEx`） . 似乎 Linux / gdb 和 Python 尚未达到在 Illumos 上实现 JavaScript 的出色水平，Bryan Cantrill 在此处报告说能够以这种方式调试生产核心转储：

[http://www.infoq.com/presentations/Debugging-Production-Systems](http://www.infoq.com/presentations/Debugging-Production-Systems)

这是 Ubuntu 12.04 上的调试会话，显示 gdb 使用 Python 2.7 的 gdb 扩展运行 Python 2.6 劣质进程来调试段错误。首先是导致段错误的代码：

```
~/Downloads/Python-2.6.4$ cat ~/bin/dumpcore.py
class Foo:

    def bar(self):
        from ctypes import string_at
        string_at(0xDEADBEEF) # this code will cause Python to segfault

def main():
    f = Foo()
    f.someattr = 42
    f.someotherattr = {'one':1, 'two':2L, 'three':[(), (None,), (None, None)]}
    f.bar()

if __name__ == "__main__":
    main() 
```

和调试会话：

```
~/Downloads/Python-2.6.4$ gdb --args ./python ~/bin/dumpcore.py
GNU gdb (Ubuntu/Linaro 7.4-2012.04-0ubuntu2.1) 7.4-2012.04
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
For bug reporting instructions, please see:
<http://bugs.launchpad.net/gdb-linaro/>...
Reading symbols from /home/john/Downloads/Python-2.6.4/python...done.
(gdb) run
Starting program: /home/john/Downloads/Python-2.6.4/python /home/john/bin/dumpcore.py
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".

Program received signal SIGSEGV, Segmentation fault.
0x0000000000468d67 in PyString_FromString (str=0xdeadbeef <Address 0xdeadbeef out of bounds>) at Objects/stringobject.c:116
116             size = strlen(str);
(gdb) py-bt
Undefined command: "py-bt".  Try "help".
(gdb) python
>import sys
>sys.path.insert(0, "/home/john/Downloads/Python-2.7/Tools/gdb")
>import libpython
>(gdb) py-bt
#10 Frame 0x8f0f90, for file /home/john/Downloads/Python-2.6.4/Lib/ctypes/__init__.py, line 496, in string_at (ptr=3735928559, size=-1)
    return _string_at(ptr, size)
#14 Frame 0x8ebf90, for file /home/john/bin/dumpcore.py, line 5, in bar (self=<Foo(someattr=42, someotherattr={'three': [(), (None,), (None, None)], 'two': 2L, 'one': 1}) at remote 0x7ffff6e03240>, string_at=<function at remote 0x7ffff6e1c990>)
        string_at(0xDEADBEEF) # this code will cause Python to segfault
#17 Frame 0x8ebd80, for file /home/john/bin/dumpcore.py, line 12, in main (f=<Foo(someattr=42, someotherattr={'three': [(), (None,), (None, None)], 'two': 2L, 'one': 1}) at remote 0x7ffff6e03240>)
    f.bar()
#20 Frame 0x8eb680, for file /home/john/bin/dumpcore.py, line 16, in <module> ()
    main()
(gdb) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-28T16:23:42.510

对于 Centos 6，您只需执行以下操作：

```
yum install gdb python-debuginfo
debuginfo-install python 
```

然后，您可以通过简单地使用 gdb 附加到它们来调试正在运行的 python 进程：

```
gdb python [process id] 
```

连接后，只需键入：

```
py-bt 
```

# python - 基于感兴趣的日期范围作为参数输入限制在 Pig Latin 中加载日志文件

> ID：14885333
> 
> 赞同：0
> 
> 时间：2013-02-14T22:34:22.590
> 
> 标签：python, hadoop, apache-pig

我在根据参数输入加载日志文件时遇到问题，想知道是否有人能够提供一些指导。有问题的日志是 Omniture 日志，存储在基于年、月和日的子目录中（例如 /year=2013/month=02/day=14），并在文件名中带有日期戳。对于任何一天，都可能存在多个日志，每个日志有数百 MB。

我有一个 Pig 脚本，它当前处理整个月的日志，月份和年份指定为脚本参数（例如 /year=$year/month=$month/day=*）。它运行良好，我们对此非常满意。也就是说，我们希望切换到每周处理日志，这意味着以前的 LOAD 路径 glob 将不起作用（几周可以包含几个月甚至几年）。为了解决这个问题，我有一个 Python UDF，它需要一个开始日期并为一周的日志吐出必要的 glob，例如：

```
>>> log_path_regex(2013, 1, 28)
'{year=2013/month=01/day=28,year=2013/month=01/day=29,year=2013/month=01/day=30,year=2013/month=01/day=31,year=2013/month=02/day=01,year=2013/month=02/day=02,year=2013/month=02/day=03}' 
```

然后将这个 glob 插入到适当的路径中：

```
> %declare omniture_log_path 's3://foo/bar/$week_path/*.tsv.gz';
> data = LOAD '$omniture_log_path' USING OmnitureTextLoader(); // See http://github.com/msukmanowsky/OmnitureTextLoader 
```

不幸的是，我一生都无法弄清楚如何根据 $year、$month 和 $day 脚本参数填充 $week_path。我尝试使用 %declare 但 grunt 抱怨说它的日志记录但从不这样做：

```
> %declare week_path util.log_path_regex(year, month, day);
2013-02-14 16:54:02,648 [main] INFO  org.apache.pig.Main - Apache Pig version 0.10.1 (r1426677) compiled Dec 28 2012, 16:46:13
2013-02-1416:54:02,648 [main] INFO  org.apache.pig.Main - Logging error messages to: /tmp/pig_1360878842643.log % ls  /tmp/pig_1360878842643.log
ls: cannot access /tmp/pig_1360878842643.log: No such file or directory 
```

如果我在参数前加上美元符号或在前缀参数周围加上引号，也会产生同样的错误。

如果我尝试使用define（我相信它只适用于静态Java函数），我会得到以下信息：

```
> define week_path util.log_path_regex(year, month, day);
2013-02-14 17:00:42,392 [main] ERROR org.apache.pig.tools.grunt.Grunt - ERROR 1200: <file script.pig, line 11, column 37>  mismatched input 'year' expecting RIGHT_PAREN 
```

与 %declare 一样，如果我在参数前面加上美元符号或在前缀参数前面加上引号，我会得到同样的错误。

我已经四处寻找并没有提出解决方案。我可能正在寻找错误的东西。调用 shell 命令可能会起作用，但会很困难，因为这会使我们的脚本部署复杂化，并且可能不可行，因为我们正在从 S3 而不是挂载的目录中检索日志。同样，将生成的 glob 作为单个参数传递可能会使实例化 MapReduce 集群上的自动化作业复杂化。

除了使用 glob 之外，还可能有一种对 Pig 友好的方式来限制 LOAD。也就是说，我仍然必须使用我的 UDF，这似乎是问题的根源。

这真的归结为我想在我的 LOAD 语句中包含一个内置在 Pig 中的动态路径 glob。猪似乎没有那么容易。

我需要将我的 UDF 转换为静态 Java 方法吗？或者我会遇到同样的问题吗？（如果它会起作用，我会犹豫不决。它是一个 8 行 Python 函数，与等效的 Java 代码相比，它易于部署并且更容易被其他人维护。）

自定义 LoadFunc 是答案吗？有了这个，我大概必须指定 /year= */month=* /day=* 并强制 Pig 测试每个文件名的日期戳，它位于两个日期之间。这似乎是一个巨大的黑客攻击和资源浪费。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-22T17:02:38.840

我[将此问题发布到 Pig 用户列表](http://mail-archives.apache.org/mod_mbox/pig-user/201302.mbox/browser)。我的理解是，在构建 DAG 之前，Pig 将首先预处理其脚本以替换参数、导入和宏。这使得基于现有变量构建新变量有点不可能，并解释了我未能构建 UDF 来构建路径 glob。

如果您是 Pig 开发人员，需要基于现有参数构建新变量，您可以使用另一个脚本来构建这些变量并将它们作为参数传递给您的 Pig 脚本，或者您可以探索需要在哪里使用这些新变量并根据您的需要将它们构建在单独的构造中。

就我而言，我不情愿地选择创建[Cheolsoo Park 所描述](http://mail-archives.apache.org/mod_mbox/pig-user/201302.mbox/%3CCAO8ATY3B2ZGPeOkHWOFqLoOw6TVvv_wmY=B_ecedfZeQvACaaA@mail.gmail.com%3E)[的自定义`LoadFunc`](http://mail-archives.apache.org/mod_mbox/pig-user/201302.mbox/%3CCAO8ATY3B2ZGPeOkHWOFqLoOw6TVvv_wmY=B_ecedfZeQvACaaA@mail.gmail.com%3E)。这`LoadFunc`在其构造函数中接受报告期间开始的日、月和年，并构建一个`pathGlob`属性以匹配该期间的路径。然后将其`pathGlob`插入到. `setLocation()`例如。

```
/**
 * Limit data to a week starting at given day. If day is 0, month is assumed.
 */
public WeeklyOrMonthlyTextLoader(String year, String month, String day) {
    super();
    pathGlob = getPathGlob(
        Integer.parseInt(year),
        Integer.parseInt(month),
        Integer.parseInt(day)
    );
}

/**
 * Replace DATE_PATH in location with glob required for reading in this
 * month or week of data. This assumes the following directory structure:
 *
 * <code>/year=&gt;year&lt;/month=&gt;month&lt;/day=&gt;day&lt;/*</code>
 */
@Override
public void setLocation(String location, Job job) throws IOException {
    location = location.replace(GLOB_PLACEHOLDER, pathGlob);
    super.setLocation(location, job);
} 
```

然后从 Pig 脚本中调用它，如下所示：

```
DEFINE TextLoader com.foo.WeeklyOrMonthlyTextLoader('$year', '$month', '$day'); 
```

请注意，构造函数接受`String`，而不是`int`。这是因为 Pig 中的参数是字符串，不能在 Pig 脚本中强制转换或转换为其他类型（在 MR 任务中使用时除外）。

`LoadFunc`虽然与包装脚本相比，创建自定义可能显得过大，但我希望解决方案是纯 Pig 以避免迫使分析师在使用他们的脚本之前执行设置任务。在为计划作业创建 Amazon MapReduce 集群时，我还想在不同时期轻松使用库存 Pig 脚本。

# actionscript-3 - 为什么在自定义 Flash 滚动条中使用鼠标滚轮滚动仅在单击一次 swf 后才起作用？

> ID：14885340
> 
> 赞同：0
> 
> 时间：2013-02-14T22:34:55.247
> 
> 标签：actionscript-3

为什么在自定义 Flash 滚动条中使用鼠标滚轮滚动仅在单击一次 swf 后才起作用？有没有办法不用先点击就可以在 swf 中滚动？提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:37:16.463

浏览器控制鼠标/键盘事件——flash 容器只有在焦点对准时才能控制它们。

它只能在单击/选项卡进入时获得焦点。

# java - 固定（在世界坐标中）LWJGL 中的照明位置？

> ID：14885343
> 
> 赞同：2
> 
> 时间：2013-02-14T22:35:01.730
> 
> 标签：java, lwjgl, lighting

我在“世界”中有一些立方体模型和一个灯笼模型（带有法线）和一个放置在特定坐标中的光源。当我尝试在模型中移动时出现问题，光源的位置每帧都会更改为视口位置。这是我的代码的初始化部分，其中包含照明初始化：

```
GL11.glEnable(GL11.GL_TEXTURE_2D);
            GL11.glShadeModel(GL11.GL_SMOOTH);
            GL11.glClearDepth(1.0f);
            GL11.glClearColor(0.0f, 0.75f, 1.0f, 1);
            GL11.glEnable(GL11.GL_CULL_FACE);
            GL11.glEnable(GL11.GL_BLEND);  
            GL11.glEnable(GL11.GL_DEPTH_TEST);
            GL11.glDepthFunc(GL11.GL_LESS);
            GL11.glMatrixMode(GL11.GL_PROJECTION);
            GL11.glLoadIdentity();

            GL11.glHint(GL11.GL_PERSPECTIVE_CORRECTION_HINT, GL11.GL_NICEST);
            ByteBuffer temp = ByteBuffer.allocateDirect(16);
            temp.order(ByteOrder.nativeOrder());
            byf = temp;
            GL11.glLight(GL11.GL_LIGHT1, GL11.GL_AMBIENT, (FloatBuffer)temp.asFloatBuffer().put(lightAmbient).flip());              // Setup The Ambient Light
            GL11.glLight(GL11.GL_LIGHT1, GL11.GL_DIFFUSE, (FloatBuffer)temp.asFloatBuffer().put(lightDiffuse).flip());              // Setup The Diffuse Light
            GL11.glLight(GL11.GL_LIGHT1, GL11.GL_POSITION,(FloatBuffer)temp.asFloatBuffer().put(lightPosition).flip());         // Position The Light
            GL11.glEnable(GL11.GL_LIGHT1);
            GL11.glEnable(GL11.GL_LIGHTING);

            GL11.glMatrixMode(GL11.GL_MODELVIEW);
            GL11.glLoadIdentity();

            GL11.glFogi(GL11.GL_FOG_MODE, fogMode[fogfilter]);                 
            temp.asFloatBuffer().put(fogColor).flip();
            GL11.glFog(GL11.GL_FOG_COLOR, temp.asFloatBuffer());             
            GL11.glFogf(GL11.GL_FOG_DENSITY, 0.35f);                           
            GL11.glHint(GL11.GL_FOG_HINT, GL11.GL_DONT_CARE);                  
            GL11.glFogf(GL11.GL_FOG_START, 1.0f);                               
            GL11.glFogf(GL11.GL_FOG_END, 5.0f);                                
            GL11.glEnable(GL11.GL_FOG); 
```

我见过一些类似的问题，但他们的解决方案根本没有帮助我。我知道问题在于设置矩阵的不规则顺序，但我不知道哪个（矩阵）以及我应该在哪里更改。我试图在光照初始化之前设置 Modelview 矩阵，但它对我不起作用。

顺便说一句，我不想​​在每一帧都设置正确的灯光位置，它对我有用，但它会减慢渲染速度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T01:26:42.037

您可能正在使用与此或 glulookat() 类似的代码。

```
GL11.glTranslatef(Camera.x, Camera.y, Camera.z);
GL11.glRotatef(Camera.roatationz, 0.0f, 0.0f, 1.0f);
GL11.glRotatef(Camera.roatationx, 1.0f, 0.0f, 0.0f);
GL11.glRotatef(Camera.roatationy, 0.0f, 1.0f, 0.0f);

//Render stuff here 
```

你的光也必须移动。:)

# jquery - 如何在cakephp中每秒自动刷新div数据

> ID：14885344
> 
> 赞同：0
> 
> 时间：2013-02-14T22:35:02.347
> 
> 标签：jquery, cakephp

我快疯了，我在 cakephp 表中有这段代码：

```
<td style="width:50%">
    <div id="progress<?=$turnTime['TurnTime']['name'];?>">
        <?php if ($turnTime['TurnTime']['end_time'] < date('Y-m-d H:i:s')) {
                echo __('Waiting...');
            }else{
                $percent = ((strtotime($turnTime['TurnTime']['end_time']) - strtotime(date('Y-m-d H:i:s')))/
                (strtotime($turnTime['TurnTime']['end_time']) - strtotime($turnTime['TurnTime']['start_time'])))*100;
                $p = 'width: '.round($percent, 2).'%';
                //show the time left
                $current_date = new DateTime(date('Y-m-d H:i:s'));
                $since_current = $current_date->diff(new DateTime($turnTime['TurnTime']['end_time']));

                echo $since_current->h.' hours - '.$since_current->i.' minutes - '.$since_current->s.' seconds Left';
        ?>
        <div class="progress progress-striped active" id="bar">
            <div class="bar" style= "<?php echo $p; ?>"></div>
        </div>
        <?php } ?>
    </div>  
</td> 
```

我想每秒自动刷新 div 数据

```
<div id="progress<?=$turnTime['TurnTime']['name'];?>"> 
```

我尝试了几种方法，但是....请帮助我，谢谢

我尝试像这样使用 jQuery：

```
<script>
    $(document).ready(function(){
        setInterval(showText(), 1000);
        function showText(){
            //alert("11");
            $("#progress<?=$turnTime['TurnTime']['name'];?>").html(....some codes here...);
        }
    });
    </script> 
```

但它不起作用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T05:48:32.227

## setInterval 调用错误

在问题中有这样的：

> setInterval(showText(), 1000);

它将调用每秒*的结果* ，但是没有返回值（更不用说，返回一个函数），因此它只会在文档准备好时有效地调用一次。`showText``showText``showText`

要修复此错误，请使用：

```
setInterval(showText, 1000); 
```

它将每秒调用一次*该函数。* `showText`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-15T05:07:27.247

尝试

```
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript">

    function showText()
    {
        var hidden_field = $('#progress_get_me').val();
        $("#progress"+hidden_field).html(....some codes here...);
    }

    $(function()
    {
        setInterval(showText, 1000);
    });

</script>

<input type="hidden" value="<?=$turnTime['TurnTime']['name'];?>" id="progress_get_me" /> 
```

**解释**

程序员创建的函数必须在外面声明，`$(document).ready`所以我在那里纠正了你。

其次，不要`php`在里面使用`jQuery`它不是一个好主意，从个人经验来看，它经常不起作用，我不知道原因。

第三，当你想在`php`里面使用隐藏字段时，你`jQuery`也可以使用 ajax 调用服务器，然后从响应对象中使用这些值`jQuery`。

# macos - 在 Mac OSX 上使用终端自定义排序

> ID：14885345
> 
> 赞同：0
> 
> 时间：2013-02-14T22:35:05.843
> 
> 标签：macos, sorting, terminal

**背景**

我有一个包含一堆文件的文件夹。它们被标记如下：

1.  YO_c1
2.  gg_d1
3.  繁荣_a5
4.  head_v4
5.  shot_o0

**问题**

我想使用下划线后的字母按字母顺序对文件进行排序。有没有办法在 MAC OSX 上使用终端来做到这一点？

最后，它应该如下所示：

1.  繁荣_a5
2.  YO_c1
3.  gg_d1
4.  shot_o0
5.  head_v4

谢谢！这些是虚拟文件，我有大约 600 个文件要以这种方式排序，请帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:08:03.873

你为什么不试试：

ls | 排序 -k 2 -t "_"

# toggle - ToggleGroup.selectToggle 错误？

> ID：14885346
> 
> 赞同：3
> 
> 时间：2013-02-14T22:35:10.223
> 
> 标签：toggle, javafx-2

当调用`ToggleGroup.selectToggle(Toggle toggle)`实际上已被选中的 RadioButton 时，此 RadioButton 将变为未选中状态。我觉得这是一个错误，任何人都可以确认这一点吗？

**切换.fxml：**

```
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import java.util.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.paint.*?>

<VBox prefHeight="400.0" prefWidth="600.0" xmlns:fx="http://javafx.com/fxml" fx:controller="com.example.ToggleDemoController">
  <children>
    <RadioButton mnemonicParsing="false" selected="true" text="First RadioButton">
      <toggleGroup>
        <ToggleGroup fx:id="myToggleGroup" />
      </toggleGroup>
    </RadioButton>
    <RadioButton mnemonicParsing="false" text="Second RadioButton" toggleGroup="$myToggleGroup" />
  </children>
</VBox> 
```

切换演示控制器：

```
package com.example;

import javafx.fxml.FXML;
import javafx.scene.control.ToggleGroup;

public class ToggleDemoController 
{
    @FXML
    private ToggleGroup myToggleGroup;

    // Implementing Initializable Interface no longer required according to
    // http://docs.oracle.com/javafx/2/fxml_get_started/whats_new2.htm
    @SuppressWarnings("unused") // only called by FXMLLoader
    @FXML
    private void initialize()
    {
        // Select the currently selected toggle (that is the first RadioButton) again.
        // This unselects the first RadioButton, while one would expect it to stay selected.
        myToggleGroup.selectToggle(myToggleGroup.getSelectedToggle());
    }

} 
```

代码也可在[http://codestefan.googlecode.com/svn/trunk/ToggleDemo](http://codestefan.googlecode.com/svn/trunk/ToggleDemo)

感谢您的任何提示！

**更新：**

**这是我想出的解决方法：**

代替

```
myToggleGroup.selectToggle(myToggleGroup.getSelectedToggle()); 
```

利用

```
Toggle selectedToggle = myToggleGroup.getSelectedToggle();
int selectedToggleIndex = myToggleGroup.getToggles().indexOf(selectedToggle);
myToggleGroup.getToggles().get(selectedToggleIndex).setSelected(true); 
```

或者换句话说：而不是`ToggleGroup.selectToggle`使用`Toggle.setSelected`. 猜猜在这种情况下不需要所有索引的东西，但是给定一个存储在数据库中的索引，我需要在恢复我的应用程序时选择一个切换，所以这针对我的情况进行了调整。

**可能（！）解决方法2：**

访问 Toggle 后面的控件，例如 RadioButton，然后以编程方式取消选择该控件。请参阅[Toggle 和它背后的 RadioButton 之间的链接？](https://stackoverflow.com/questions/14885608/link-between-toggle-and-e-g-the-radiobutton-behind-it/14891063).

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:55:24.363

是的。你发现了一个错误。

将其与运行时项目归档在：http: [//javafx-jira.kenai.com](http://javafx-jira.kenai.com)

确保您包含返回此案例的链接，该链接提供了一些可重现的示例代码，因为似乎一些[类似的问题](http://javafx-jira.kenai.com/browse/RT-22168)已经关闭，因为开发人员无法重现该问题。

这是一些示例代码，它仅使用 Java 而不使用 FXML 来复制错误 - JavaFX 2.2.5 和 Java8b76 的行为是奇怪和错误的 IMO：

```
import javafx.application.Application;
import static javafx.application.Application.launch;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.scene.*;
import javafx.scene.control.Button;
import javafx.scene.control.RadioButton;
import javafx.scene.control.ToggleGroup;
import javafx.scene.layout.VBox;
import javafx.stage.Stage;

public class ToggleTest extends Application {
    @Override public void start(Stage primaryStage) {
        final ToggleGroup tg = new ToggleGroup();
        RadioButton radio1 = new RadioButton("1");
        radio1.setId("1");
        radio1.setToggleGroup(tg);
        RadioButton radio2 = new RadioButton("2");
        radio2.setId("2");
        radio2.setToggleGroup(tg);

        tg.selectToggle(radio1);
//        radio1.setSelected(true);

        Button button = new Button("Select 1");
        button.setOnAction(new EventHandler<ActionEvent>() {
            @Override public void handle(ActionEvent t) {
                System.out.println("Selected Toggle Before Select: " + tg.getSelectedToggle() + " isSelected? " + tg.getSelectedToggle().isSelected());
                tg.selectToggle(tg.getSelectedToggle());
                System.out.println("Selected Toggle After Select:  " + tg.getSelectedToggle() + " isSelected? " + tg.getSelectedToggle().isSelected());
            }
        });

        VBox layout = new VBox(10);
        layout.getChildren().addAll(radio1, radio2, button);
        layout.setStyle("-fx-background-color: cornsilk; -fx-padding: 10;");

        primaryStage.setScene(new Scene(layout));
        primaryStage.show();
    }
    public static void main(String[] args) { launch(args); }
} 
```

重复按键后的程序输出：

```
Selected Toggle Before Select: RadioButton[id=1, styleClass=radio-button] isSelected? true
Selected Toggle After Select:  RadioButton[id=1, styleClass=radio-button] isSelected? false
Selected Toggle Before Select: RadioButton[id=1, styleClass=radio-button] isSelected? false
Selected Toggle After Select:  RadioButton[id=1, styleClass=radio-button] isSelected? false
Selected Toggle Before Select: RadioButton[id=1, styleClass=radio-button] isSelected? false
Selected Toggle After Select:  RadioButton[id=1, styleClass=radio-button] isSelected? false 
```

# python - 如何实现粒子引擎

> ID：14885349
> 
> 赞同：5
> 
> 时间：2013-02-14T22:35:25.483
> 
> 标签：python, refactoring, pygame, particle-system

所以我为烟雾制作了一个粒子引擎，我对此非常满意，我认为它非常适合我的游戏。
我现在需要将它实现到我的游戏中，但我遇到了一些麻烦。我想知道是否有人可以解释我将如何在我的游戏中使用我的粒子引擎。
我在下面添加了我的代码（用于烟雾和我的游戏文件）。
我想将粒子与游戏文件分开，但在我的游戏中调用它。
最终，我想在引擎中制作更多我也可以调用的粒子效果。

有人可以帮忙吗？它可能需要一些调整才能工作。

**颗粒代码：**

```
import pygame,random
from pygame.locals import *

xmax = 1000    #width of window
ymax = 600     #height of window

class Smoke():
    def __init__(self, startx, starty, col):
        self.x = startx
        self.y = random.randint(0, starty)
        self.col = col
        self.sx = startx
        self.sy = starty

    def move(self):
        if self.y < 0:
            self.x = self.sx
            self.y = self.sy
        else:
            self.y -= 1
        self.x += random.randint(-1, 2)

def main():
    pygame.init()
    screen = pygame.display.set_mode((xmax,ymax))
    black = (0,0,0)
    grey = (145,145,145)
    light_grey = (192,192,192)
    dark_grey = (183, 183, 183)

    clock = pygame.time.Clock()

    particles = []
    for part in range(600):
        if part % 2 > 0: col = grey
        #elif part % 5 > 0: col = dark_grey
        elif part % 3 > 0: col = dark_grey
        else: col = light_grey
        particles.append( Smoke(0, 500, col) )

    exitflag = False
    while not exitflag:
        for event in pygame.event.get():
            if event.type == QUIT:
                exitflag = True
            elif event.type == KEYDOWN:
                if event.key == K_ESCAPE:
                    exitflag = True

        screen.fill(black)
        for p in particles:
            p.move()
            pygame.draw.circle(screen, p.col, (p.x, p.y), 15)

        pygame.display.flip()
        clock.tick(80)
    pygame.quit()

if __name__ == "__main__":
    main() 
```

**游戏代码**

```
import pygame
from pygame import *

WIN_WIDTH = 1120 - 320
WIN_HEIGHT = 960 - 320
HALF_WIDTH = int(WIN_WIDTH / 2)
HALF_HEIGHT = int(WIN_HEIGHT / 2)

DISPLAY = (WIN_WIDTH, WIN_HEIGHT)
DEPTH = 0
FLAGS = 0
CAMERA_SLACK = 30

levels = {0: {'level': [
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                         E  ",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "               PPPPP        PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPP           P",
                    "                            PPPP           P",
                    "                            PPPP     PPPPPPP",
                    "                      PPPPPPPPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "       PPPP                 PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "PPPPP                       PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP         PPPPP           PPPP     PPPPPPP",
                    "PPP                                     PPPP",
                    "PPP                                     PPPP",
                    "PPP                                     PPPP",
                    "PPP                       PPPPPPPPPPPPPPPPPP",
                    "PPP                       PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",],
             'enemies': [(9, 38)]},
             1: {'level': [
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                         E  ",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "               PPPPP        PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPP           P",
                    "                            PPPP           P",
                    "                            PPPP     PPPPPPP",
                    "                      PPPPPPPPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "       PPPP                 PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "PPPPP                       PPPP     PPPPPPP",
                    "PPP                  PPPPPPPPPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP             PPPPPPPP    PPPP     PPPPPPP",
                    "PPP                                     PPPP",
                    "PPP                                     PPPP",
                    "PPP          PPPPP                      PPPP",
                    "PPP          P            PPPPPPPPPPPPPPPPPP",
                    "PPP          P    PPPPPPPPPPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",],
             'enemies': [(9, 38), (18, 38), (15, 15)]}}

class Scene(object):
    def __init__(self):
        pass

    def render(self, screen):
        raise NotImplementedError

    def update(self):
        raise NotImplementedError

    def handle_events(self, events):
        raise NotImplementedError

class GameScene(Scene):
    def __init__(self, levelno):
        super(GameScene, self).__init__()
        self.bg = Surface((32,32))
        self.bg.convert()
        self.bg.fill(Color("#0094FF"))
        up = left = right = False
        self.entities = pygame.sprite.Group()
        self.player = Player(5, 40)
        self.player.scene = self
        self.platforms = []

        self.levelno = levelno

        levelinfo = levels[levelno]
        self.enemies = [Enemy(*pos) for pos in levelinfo['enemies']]

        level = levelinfo['level']
        total_level_width = len(level[0]) * 32
        total_level_height = len(level) * 32

        # build the level
        x = 0
        y = 0
        for row in level:
            for col in row:
                if col == "P":
                    p = Platform(x, y)
                    self.platforms.append(p)
                    self.entities.add(p)
                if col == "E":
                    e = ExitBlock(x, y)
                    self.platforms.append(e)
                    self.entities.add(e)
                x += 32
            y += 32
            x = 0

        self.camera = Camera(complex_camera, total_level_width, total_level_height)
        self.entities.add(self.player)
        for e in self.enemies:
            self.entities.add(e)

    def render(self, screen):
        for y in range(20):
            for x in range(25):
                screen.blit(self.bg, (x * 32, y * 32))

        for e in self.entities:
            screen.blit(e.image, self.camera.apply(e))

    def update(self):
        pressed = pygame.key.get_pressed()
        up, left, right = [pressed[key] for key in (K_UP, K_LEFT, K_RIGHT)]
        self.player.update(up, left, right, self.platforms)

        for e in self.enemies:
            e.update(self.platforms)

        self.camera.update(self.player)

    def exit(self):
        if self.levelno+1 in levels:
            self.manager.go_to(GameScene(self.levelno+1))
        else:
            self.manager.go_to(CustomScene("You win!"))

    def die(self):
        self.manager.go_to(CustomScene("You lose!"))

    def handle_events(self, events):
        for e in events:
            if e.type == KEYDOWN and e.key == K_ESCAPE:
                self.manager.go_to(TitleScene())

class CustomScene(object):

    def __init__(self, text):
        self.text = text
        super(CustomScene, self).__init__()
        self.font = pygame.font.SysFont('Arial', 56)

    def render(self, screen):
        # ugly! 
        screen.fill((0, 200, 0))
        text1 = self.font.render(self.text, True, (255, 255, 255))
        screen.blit(text1, (200, 50))

    def update(self):
        pass

    def handle_events(self, events):
        for e in events:
            if e.type == KEYDOWN:
                self.manager.go_to(TitleScene())

class TitleScene(object):

    def __init__(self):
        super(TitleScene, self).__init__()
        self.font = pygame.font.SysFont('Arial', 56)
        self.sfont = pygame.font.SysFont('Arial', 32)

    def render(self, screen):
        # ugly! 
        screen.fill((0, 200, 0))
        text1 = self.font.render('Crazy Game', True, (255, 255, 255))
        text2 = self.sfont.render('> press space to start <', True, (255, 255, 255))
        screen.blit(text1, (200, 50))
        screen.blit(text2, (200, 350))

    def update(self):
        pass

    def handle_events(self, events):
        for e in events:
            if e.type == KEYDOWN and e.key == K_SPACE:
                self.manager.go_to(GameScene(0))

class SceneMananger(object):
    def __init__(self):
        self.go_to(TitleScene())

    def go_to(self, scene):
        self.scene = scene
        self.scene.manager = self

def main():
    pygame.init()
    screen = pygame.display.set_mode(DISPLAY, FLAGS, DEPTH)
    pygame.display.set_caption("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
    timer = pygame.time.Clock()
    running = True

    manager = SceneMananger()

    while running:
        timer.tick(60)

        if pygame.event.get(QUIT):
            running = False
            return
        manager.scene.handle_events(pygame.event.get())
        manager.scene.update()
        manager.scene.render(screen)
        pygame.display.flip()

class Camera(object):
    def __init__(self, camera_func, width, height):
        self.camera_func = camera_func
        self.state = Rect(0, 0, width, height)

    def apply(self, target):
        try:
            return target.rect.move(self.state.topleft)
        except AttributeError:
            return map(sum, zip(target, self.state.topleft))

    def update(self, target):
        self.state = self.camera_func(self.state, target.rect)

def complex_camera(camera, target_rect):
    l, t, _, _ = target_rect
    _, _, w, h = camera
    l, t, _, _ = -l + HALF_WIDTH, -t +HALF_HEIGHT, w, h

    l = min(0, l)                           # stop scrolling left
    l = max(-(camera.width - WIN_WIDTH), l)   # stop scrolling right
    t = max(-(camera.height-WIN_HEIGHT), t) # stop scrolling bottom

    return Rect(l, t, w, h)

class Entity(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)

class Player(Entity):
    def __init__(self, x, y):
        Entity.__init__(self)
        self.xvel = 0
        self.yvel = 0
        self.onGround = False
        self.image = Surface((32,32))
        self.image.fill(Color("#0000FF"))
        self.image.convert()
        self.rect = Rect(x*32, y*32, 32, 32)

    def update(self, up, left, right, platforms):
        if self.rect.top > 1440 or self.rect.top < 0:
            self.scene.die()
        if self.rect.left > 1408 or self.rect.right < 0:
            self.scene.die()
        if up:
            if self.onGround:
                self.yvel = 0
                self.yvel -= 10 # only jump if on the ground
        if left:
            self.xvel = -10
        if right:
            self.xvel = 10
        if not self.onGround:
            self.yvel += 0.3 # only accelerate with gravity if in the air
            if self.yvel > 80: self.yvel = 80 # max falling speed
        if not(left or right):
            self.xvel = 0

        self.rect.left += self.xvel # increment in x direction
        if self.collide(self.xvel, 0, platforms): # do x-axis collisions
            self.rect.top += self.yvel # increment in y direction
            self.onGround = False; # assuming we're in the air
            self.collide(0, self.yvel, platforms) # do y-axis collisions

    def collide(self, xvel, yvel, platforms):
        for p in platforms:
            if pygame.sprite.collide_rect(self, p):
                if isinstance(p, ExitBlock):
                    self.scene.exit()
                    return False
                if xvel > 0: self.rect.right = p.rect.left
                if xvel < 0: self.rect.left = p.rect.right
                if yvel > 0:
                    self.rect.bottom = p.rect.top
                    self.onGround = True
                if yvel < 0:
                    self.rect.top = p.rect.bottom
        return True

class Enemy(Entity):
    def __init__(self, x, y):
        Entity.__init__(self)
        self.yVel = 0
        self.xVel = 2 # start moving immediately
        self.image = Surface((32,32))
        self.image.fill(Color("#00FF00"))
        self.image.convert()
        self.rect = Rect(x*32, y*32, 32, 32)
        self.onGround = False

    def update(self, platforms):
        if not self.onGround:
            self.yVel += 0.3

        # no need for right_dis to be a member of the class,
        # since we know we are moving right if self.xVel > 0
        right_dis = self.xVel > 0

        # create a point at our left (or right) feet 
        # to check if we reached the end of the platform
        m = (1, 1) if right_dis else (-1, 1)
        p = self.rect.bottomright if right_dis else self.rect.bottomleft
        fp = map(sum, zip(m, p))

        # if there's no platform in front of us, change the direction
        collide = any(p for p in platforms if p.rect.collidepoint(fp))
        if not collide:
            self.xVel *= -1

        self.rect.left += self.xVel # increment in x direction
        self.collide(self.xVel, 0, platforms) # do x-axis collisions
        self.rect.top += self.yVel # increment in y direction
        self.onGround = False; # assuming we're in the air
        self.collide(0, self.yVel, platforms) # do y-axis collisions

    def collide(self, xVel, yVel, platforms):
        for p in platforms:
            if pygame.sprite.collide_rect(self, p):
                if xVel > 0: 
                    self.rect.right = p.rect.left
                    self.xVel *= -1 # hit wall, so change direction
                if xVel < 0: 
                    self.rect.left = p.rect.right
                    self.xVel *= -1 # hit wall, so change direction
                if yVel > 0:
                    self.rect.bottom = p.rect.top
                    self.onGround = True
                if yVel < 0:
                    self.rect.top = p.rect.bottom

class Platform(Entity):
    def __init__(self, x, y):
        Entity.__init__(self)
        #self.image = Surface([32, 32], pygame.SRCALPHA, 32) #makes blocks invisible for much better artwork
        self.image = Surface((32,32)) #makes blocks visible for building levels
        self.image.convert()
        self.rect = Rect(x, y, 32, 32)

    def update(self):
        pass

class ExitBlock(Platform):
    def __init__(self, x, y):
        Platform.__init__(self, x, y)
        self.image = Surface((32,32)) #makes blocks visible for building levels
        self.image.convert()
        self.rect = Rect(x, y, 32, 32)

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-15T10:23:22.963

谨防！长帖！

## 粒子

首先，让我们看看你的`Smoke`班级。它包含一些*烟雾*行为，但你的主循环也包含。让我们通过创建一个`Particle`只代表一个粒子的泛型类来解决这个问题：

```
class Particle():
    def __init__(self, col, size, *strategies):
        self.x, self.y = 0, 0
        self.col = col
        self.alive = 0
        self.strategies = strategies
        self.size = size

    def kill(self):
        self.alive = -1 # alive -1 means dead

    def move(self):
        for s in self.strategies:
            s(self) 
```

这门课做的不多。它是通用的，它的所有行为（简单函数）都传递给它的`__init__`函数，并且粒子在方法中将这些函数应用于自身`move`。

## 粒子的行为

现在我们的粒子类是灵活的，让我们考虑一下粒子应该如何表现，以使一堆看起来像烟雾。

烟雾粒子应该上升，所以让我们创建一个向上移动粒子的函数：

```
def ascending(speed):
    def _ascending(particle):
        particle.y -= speed
    return _ascending 
```

烟雾粒子应该会在某个时候死亡，所以让我们编写一个在特定条件下杀死的函数：

```
def kill_at(max_x, max_y):
    def _kill_at(particle):
        if particle.x < -max_x or particle.x > max_x or particle.y < -max_y or particle.y > max_y:
            particle.kill()
    return _kill_at 
```

我们需要跟踪粒子的存活时间（稍后会派上用场），因此我们需要一个让粒子*老化*的函数：

```
def age(amount):
    def _age(particle):
        particle.alive += amount
    return _age 
```

当烟雾上升时，它不应该直线上升（多么无聊！），但它应该呈扇形散开：

```
def fan_out(modifier):
    def _fan_out(particle):
        d = particle.alive / modifier
        d += 1
        particle.x += random.randint(-d, d)
    return _fan_out 
```

好的！现在我们的烟雾可以扇出来了，但是还是有点无聊，所以我们来写一个模拟一点风的函数：

```
def wind(direction, strength):
    def _wind(particle):
        if random.randint(0,100) < strength:
            particle.x += direction
    return _wind 
```

我们现在有一堆描述粒子行为的函数。它们都是小而独立的。您可以创建无限数量的它们并根据需要组合它们以创建不同的粒子。

## 烟

是时候实际创建一些粒子了：进入烟雾机！

```
def smoke_machine():
    colors = {0: grey,
              1: dark_grey,
              2: light_grey}
    def create():
        for _ in xrange(random.choice([0,0,0,0,0,0,0,1,2,3])):
            behaviour = age(1), ascending(1), fan_out(400), wind(1, 15), kill_at(1000, 1000)
            p = Particle(colors[random.randint(0, 2)], random.randint(10, 15), *behaviour)
            yield p

    while True:
        yield create() 
```

那么这是什么鬼？简单的。它是一个不断发射新粒子的发生器。每次有人想要检索下一个项目时，它都会调用它的嵌套`create`函数。该函数根据输入列表依次返回 0 到 3 个粒子`random.choice`。这是一个很好的说法，它以 70% 的机会返回 0 个粒子，以 10% 的机会返回 1、2 或 3 个粒子。

在下一行中，我们定义了粒子的行为。它只是一个函数元组。注意每个函数调用如何返回其嵌套函数。这样，这些函数就被参数化了。

最后一步是为粒子随机分配颜色和大小。

你可以从命令行测试它，看看它是如何工作的：

```
>>> s=smoke_machine()
>>> list(next(s))
[]
>>> list(next(s))
[<particle.Particle instance at 0x02AD94B8>, <particle.Particle instance at 0x02
AD9030>]
>>> list(next(s))
[]
>>> list(next(s))
[]
>>> list(next(s))
[<particle.Particle instance at 0x02AD9030>]
>>> list(next(s))
[<particle.Particle instance at 0x02AD9418>, <particle.Particle instance at 0x02
AD93C8>]
>>> list(next(s))
[<particle.Particle instance at 0x02AD9030>] 
```

看看我们每次在生成器上调用 next 时，它如何返回最多 3 个粒子。

## 把它们放在一起

我们如何将烟雾机与游戏结合起来？让我们编写一个为我们处理它的类：

```
class Emitter(object):
    def __init__(self, pos=(0, 0)):
        self.particles = []
        self.pos = pos
        self.factories = []

    def add_factory(self, factory, pre_fill=300):
        self.factories.append(factory)
        tmp = []
        for _ in xrange(pre_fill):
            n = next(factory)
            tmp.extend(n)
            for p in tmp:
                p.move()
        self.particles.extend(tmp)

    def update(self):
        for f in self.factories:
            self.particles.extend(next(f))

        for p in self.particles[:]:
            p.move()
            if p.alive == -1:
                self.particles.remove(p)

    def draw(self, screen, position_translater_func):
        for p in self.particles:
            target_pos = position_translater_func(map(sum, zip((p.x, p.y), self.pos)))
            pygame.draw.circle(screen, p.col, target_pos, int(p.size)) 
```

发射器可以保存一堆工厂函数（如我们的`smoke_machine`），每次更新时，它都会将这些工厂的粒子添加到它的中，`self.particles`以便将它们绘制到屏幕上。让我们详细看看一些函数：

如果我们添加一个带有 的新工厂`add_factory`，我们调用它并提前`factory`移动它的粒子 300（或其他）次。`pre_fill`这样，一些粒子已经存在。

如果我们想绘制粒子，我们必须使用 的位置来计算它们的位置`Emitter`。此外，我们需要使用游戏的相机来调整这个位置，所以我们只接受一个函数作为参数，将我们的位置转换为正确的最终位置，以便我们的粒子在游戏中相应地滚动。

我们不需要对游戏类进行大的更改即可使用`Emitter`now。`GameScene`我们只需在被调用`self.emitter`的和 an中创建一个新列表`Emitter`并将`smoke_machine`工厂添加到其中。

在`render`我们调用的方法中

```
for e in self.emitter:
    e.draw(screen, self.camera.apply) 
```

在`update`我们调用的方法中

```
for e in self.emitter:
   e.update() 
```

我们完成了！

## 行动 ！

![在此处输入图像描述](../Images/a77964aa3ad32a8129acfc9890562763.png)

## 完整清单：

### 游戏.py

*省略了一些课程，因为我达到了 30000 个字符的限制:-)*

```
import pygame
from pygame import *
from particle import Emitter, smoke_machine
WIN_WIDTH = 1120 - 320
WIN_HEIGHT = 960 - 320
HALF_WIDTH = int(WIN_WIDTH / 2)
HALF_HEIGHT = int(WIN_HEIGHT / 2)

DISPLAY = (WIN_WIDTH, WIN_HEIGHT)
DEPTH = 0
FLAGS = 0
CAMERA_SLACK = 30

levels = {0: {'level': [
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                         E  ",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "               PPPPP        PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPP           P",
                    "                            PPPP           P",
                    "                            PPPP     PPPPPPP",
                    "                      PPPPPPPPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "       PPPP                 PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "PPPPP                       PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP         PPPPP           PPPP     PPPPPPP",
                    "PPP                                     PPPP",
                    "PPP                                     PPPP",
                    "PPP                                     PPPP",
                    "PPP                       PPPPPPPPPPPPPPPPPP",
                    "PPP                       PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP    S      PPPPPPPPPPPPPPPPPP",],
             'enemies': [(9, 38)]},
             1: {'level': [
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                            ",
                    "                                         E  ",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "               PPPPP        PPPPPPPPPPPPPPPP",
                    "                            PPPPPPPPPPPPPPPP",
                    "                            PPPP           P",
                    "                            PPPP           P",
                    "                            PPPP     PPPPPPP",
                    "                      PPPPPPPPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "       PPPP                 PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "                            PPPP     PPPPPPP",
                    "PPPPP                       PPPP     PPPPPPP",
                    "PPP                  PPPPPPPPPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP                         PPPP     PPPPPPP",
                    "PPP             PPPPPPPP    PPPP     PPPPPPP",
                    "PPP                                     PPPP",
                    "PPP                                     PPPP",
                    "PPP          PPPPP                      PPPP",
                    "PPP          P            PPPPPPPPPPPPPPPPPP",
                    "PPP          P    PPPPPPPPPPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",
                    "PPPPPPPPPPPPPPP           PPPPPPPPPPPPPPPPPP",],
             'enemies': [(9, 38), (18, 38), (15, 15)]}}

...

class GameScene(Scene):
    def __init__(self, levelno):
        super(GameScene, self).__init__()
        self.bg = Surface((32,32))
        self.bg.convert()
        self.bg.fill(Color("#0094FF"))
        up = left = right = False
        self.entities = pygame.sprite.Group()
        self.player = Player(5, 40)
        self.player.scene = self
        self.platforms = []

        self.levelno = levelno

        levelinfo = levels[levelno]
        self.enemies = [Enemy(*pos) for pos in levelinfo['enemies']]

        level = levelinfo['level']
        total_level_width = len(level[0]) * 32
        total_level_height = len(level) * 32

        self.emitter = []

        # build the level
        x = 0
        y = 0
        for row in level:
            for col in row:
                if col == "P":
                    p = Platform(x, y)
                    self.platforms.append(p)
                    self.entities.add(p)
                if col == "E":
                    e = ExitBlock(x, y)
                    self.platforms.append(e)
                    self.entities.add(e)
                if col == "S":
                    e = Emitter((x, total_level_height))
                    e.add_factory(smoke_machine())
                    self.emitter.append(e)
                x += 32
            y += 32
            x = 0

        self.camera = Camera(complex_camera, total_level_width, total_level_height)
        self.entities.add(self.player)
        for e in self.enemies:
            self.entities.add(e)

    def render(self, screen):
        for y in range(20):
            for x in range(25):
                screen.blit(self.bg, (x * 32, y * 32))

        for e in self.emitter:
            e.draw(screen, self.camera.apply)

        for e in self.entities:
            screen.blit(e.image, self.camera.apply(e))

    def update(self):
        for e in self.emitter:
            e.update()

        pressed = pygame.key.get_pressed()
        up, left, right = [pressed[key] for key in (K_UP, K_LEFT, K_RIGHT)]
        self.player.update(up, left, right, self.platforms)

        for e in self.enemies:
            e.update(self.platforms)

        self.camera.update(self.player)

    def exit(self):
        if self.levelno+1 in levels:
            self.manager.go_to(GameScene(self.levelno+1))
        else:
            self.manager.go_to(CustomScene("You win!"))

    def die(self):
        self.manager.go_to(CustomScene("You lose!"))

    def handle_events(self, events):
        for e in events:
            if e.type == KEYDOWN and e.key == K_ESCAPE:
                self.manager.go_to(TitleScene())

...

if __name__ == "__main__":
    main() 
```

### 粒子.py

```
import pygame,random

def ascending(speed):
    def _ascending(particle):
        particle.y -= speed
    return _ascending

def kill_at(max_x, max_y):
    def _kill_at(particle):
        if particle.x < -max_x or particle.x > max_x or particle.y < -max_y or particle.y > max_y:
            particle.kill()
    return _kill_at

def age(amount):
    def _age(particle):
        particle.alive += amount
    return _age

def fan_out(modifier):
    def _fan_out(particle):
        d = particle.alive / modifier
        d += 1
        particle.x += random.randint(-d, d)
    return _fan_out

def wind(direction, strength):
    def _wind(particle):
        if random.randint(0,100) < strength:
            particle.x += direction
    return _wind

class Particle():
    def __init__(self, col, size, *strategies):
        self.x, self.y = 0, 0
        self.col = col
        self.alive = 0
        self.strategies = strategies
        self.size = size

    def kill(self):
        self.alive = -1 # alive -1 means dead

    def move(self):
        for s in self.strategies:
            s(self)        

black = (0,0,0)
grey = (145,145,145)
light_grey = (192,192,192)
dark_grey = (183, 183, 183)

def smoke_machine():
    colors = {0: grey,
              1: dark_grey,
              2: light_grey}
    def create():
        for _ in xrange(random.choice([0,0,0,0,0,0,0,1,2,3])):
            behaviour = ascending(1), kill_at(1000, 1000), fan_out(400), wind(1, 15), age(1)
            p = Particle(colors[random.randint(0, 2)], random.randint(10, 15), *behaviour)
            yield p

    while True:
        yield create()

class Emitter(object):
    def __init__(self, pos=(0, 0)):
        self.particles = []
        self.pos = pos
        self.factories = []

    def add_factory(self, factory, pre_fill=300):
        self.factories.append(factory)
        tmp = []
        for _ in xrange(pre_fill):
            n = next(factory)
            tmp.extend(n)
            for p in tmp:
                p.move()
        self.particles.extend(tmp)

    def update(self):
        for f in self.factories:
            self.particles.extend(next(f))

        for p in self.particles[:]:
            p.move()
            if p.alive == -1:
                self.particles.remove(p)

    def draw(self, screen, position_translater_func):
        for p in self.particles:
            target_pos = position_translater_func(map(sum, zip((p.x, p.y), self.pos)))
            pygame.draw.circle(screen, p.col, target_pos, int(p.size)) 
```

## 结论

我们已经成功地将粒子集成到游戏中。为此，我们编写了描述不同行为模式的小型、独立的函数，并使用工厂函数组合它们。

在此过程中，我们了解了[闭包](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)、[生成器](http://en.wikipedia.org/wiki/Generator_%28computer_science%29)、[SRP](http://en.wikipedia.org/wiki/Single_responsibility_principle)、[工厂](http://en.wikipedia.org/wiki/Factory_pattern)模式和[策略模式](http://en.wikipedia.org/wiki/Strategy_pattern)。

我们现在可以轻松添加新行为，例如更改颜色，或创建行为完全不同的新粒子工厂，但使用我们现有的函数。

例如，尝试使用让粒子生长的函数

```
def grow(amount):
    def _grow(particle):
        if random.randint(0,100) < particle.alive / 20:
            particle.size += amount
    return _grow 
```

通过添加`grow(0.5)`到行为列表中`smoke_machine`

![在此处输入图像描述](../Images/c3abc3d8480eb199783d75eb67a547d9.png)

小小的改变，令人印象深刻的效果。

多好的一天啊！

[PS：您可以在此存储库](https://bitbucket.org/BigYellowCactus/particlegame)中找到更快的版本（和错误修复）。它使用[`numpy`](http://www.numpy.org/)、[`itertools`](http://docs.python.org/2/library/itertools.html)和[`psyco`](http://psyco.sourceforge.net/)并[`pygame.surfarray`](http://www.pygame.org/docs/ref/surfarray.html)避开`random`模块以大幅提高速度。

# c# - 授权 Vimeo 高级 API

> ID：14885350
> 
> 赞同：5
> 
> 时间：2013-02-14T22:35:26.143
> 
> 标签：c#, oauth, vimeo

我在通过 OAuth 授权我的 Vimeo 帐户时遇到了一些麻烦。我正在使用以下 .NET 包装器： http: [//afsharious.wordpress.com/vimeo-for-windows/vimeodotnet/](http://afsharious.wordpress.com/vimeo-for-windows/vimeodotnet/)

我了解用户必须打开浏览器才能获取验证码，然后通过 API/wrapper 登录所需的验证码。但是，我需要在网页上简单地列出我的 Vimeo 帐户中的视频，所以我不希望用户打开一个新窗口并执行教程中描述的所有验证码操作。

还有其他方法吗？我尝试过简单地使用我的消费者密钥、消费者密码、我的访问令牌和我通过在 Vimeo 上注册一个新应用程序获得的访问令牌密码。但是，这不起作用，似乎我无法那样登录:-(

我尝试的代码如下：

```
Vimeo.API.VimeoClient vimeoClient = new VimeoClient(MyConsumerKey, MyConsumerSecret);

// Login to Vimeo
vimeoClient.Login(MyAccessToken, MyAccessTokenSecret);

// Get videos
Videos videos = vimeoClient.vimeo_videos_getAll(true, null, null, VimeoClient.VideosSortMethod.Default, MyUserId); 
```

有人知道怎么做吗？:-)

# ios - JSON Objective-C 解析失败

> ID：14885360
> 
> 赞同：1
> 
> 时间：2013-02-14T22:36:01.873
> 
> 标签：ios, objective-c, json, sbjson

我已经编写了以下代码，但我不断得到零。我已经尝试了许多不同的变体，但我失败得异常艰难。

这是我从服务器得到的。两个对象。

> [{"description":"yolo.","name":"ye","id":1},{"description":"sMITH","name":"John","id":2}]

任何帮助将不胜感激......谢谢。

```
 NSData *response = [NSURLConnection sendSynchronousRequest:request returningResponse:&urlResponse error:&requestError];
    SBJsonParser *jsonParser = [[SBJsonParser alloc] init];
    NSArray *jsonObjects = [jsonParser objectWithData:response];
    NSMutableString *yolo = [[NSMutableString alloc] init];

            for ( int i = 0; i < [jsonObjects count]; i++ ) {
                NSDictionary *jsonDict = [jsonObjects objectAtIndex:i];
                NSString *IDID = [jsonDict objectForKey:@"id"];
                NSString *name = [jsonDict objectForKey:@"name"];

                NSLog(@"ID: %@", IDID); // THIS DISPLAYS

                [yolo appendString: IDID];    // THIS seems to be causing the new error...
                [yolo appendString:@": "];
                [yolo appendString: name];
                NSLog(@"%@", yolo);           // RETURNS NIL    
    } 
```

编辑：

目前我的新错误是......

> 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“-[NSDecimalNumber 长度]：无法识别的选择器发送到实例 0x81b89f0”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:10:06.987

看起来你`[jsonDict objectForKey:@"id"]`是一个`NSNumber`（或`NSDecimalNumber`）而不是一个`NSString`。您应该将行更改`NSString *IDID = [jsonDict objectForKey:@"id"];`为，

```
id myObject = [jsonDict objectForKey:@"id"];
NSString *IDID = nil;

if ([myObject isKindOfClass:[NSNumber class]]) {
   IDID = [[jsonDict objectForKey:@"id"] stringValue];
} else {
   IDID = [jsonDict objectForKey:@"id"];
} 
```

这个错误现在出现了，因为之前你没有初始化`NSMutableString *yolo`并且你`appendString:`在一个 nil 对象上使用。因为现在它被初始化，因为`NSMutableString *yolo = [[NSMutableString alloc] init];`它试图调用只接受类型作为其输入`appendString`的对象，当你在其中传递一个时。是一种内部调用的方法。所以你也需要改变它。`NSMutableString``NSString``NSNumber``length``appendString:`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:40:09.440

你从不初始化`yolo`，所以它只是`nil`你调用`-appendString:`它的整个时间。试试这个：

```
NSMutableString *yolo = [NSMutableString string]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T22:40:26.500

您是否尝试过初始化 NSMutableString？

```
NSMutableString *yolo = [[NSMutableString alloc] init]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T23:16:40.957

看起来您并没有真正检查通过 JSON 提要进入您的应用程序的数据类型。当用户实际使用您的应用程序时，这可能是随机崩溃的情况。这也可能是 App Store 被拒绝的原因，是否在您的 App 审核期间发生此类崩溃。

在调用它们的方法之前，您应该检查从 JSON 接收的所有对象的类型:)

通过实施最佳实践，您将拥有一个稳定且可用的应用程序。构建数据模型以验证您的数据。你也可以像 JSONModel 这样的 JSON 数据模型框架：http: [//www.jsonmodel.com/](http://www.jsonmodel.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-18T15:17:30.153

从您的数据中可以明显看出，“id”不是字符串，而是数字。将指针分配给 NSString* 并不会神奇地将其转换为 NSString*。很明显，当您认为某个对象是 NSString 时，您会发现某个对象是 NSDecimalNumber。

所以：IDID​​ 是一个 NSNumber*，假装它是一个 NSString* 会导致崩溃。

# c++ - 设计需要暂存空间的算法

> ID：14885361
> 
> 赞同：16
> 
> 时间：2013-02-14T22:36:19.280
> 
> 标签：c++, algorithm, boost, boost-gil

C++ 标准库将数据结构与算法分开，例如`std::sort`：

```
template< class RandomAccessIterator >
void sort( RandomAccessIterator first, RandomAccessIterator last ); 
```

**当算法需要中间暂存空间时，我想保持算法和数据结构的分离。**

考虑到这个目标，我想实现一种图像算法，该算法需要输入和输出图像之间的中间暂存空间。可以在函数调用中分配必要的暂存空间，但是由于这些调用的大小和频率相同，图像大小相同，这会严重降低性能。这使得将数据结构与算法分离变得更加困难。

实现此目的的一种可能方法如下：

```
// Algorithm function
template<typename InputImageView, typename OutputImageView, typename ScratchView>
void algorithm(
  InputImageView inputImageView, 
  OutputImageView outputImageView, 
  ScratchView scratchView
);

// Algorithm class with scratch space
template<typename DataStructure>
class Algorithm {
public:
  template<typename InputImageView,typename OutputImageView>
  void operator()(
  InputImageView inputImageView, 
  OutputImageView outputImageView
  ){
    m_scratch.resize(inputImageView.size());
    algorithm(inputImageView,outputImageView,makeView(m_scratch));
  }

private:
  DataStructure m_scratch;
} 
```

**以上是一种有效的算法+暂存空间设计，还是有更好的方法？**

*旁注：我正在使用[boost::gil](http://boost.org/libs/gil)库*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:01:28.747

我认为在这种情况下，我会让算法允许您传递（引用或指向）暂存空间的结构，并为该参数提供默认值。这样，当/如果分配结构的额外时间不是问题时，用户可以在不传递结构的情况下调用函数，但是如果（例如）构建可以从重复重用相同空间中受益的处理管道，则可以传递一个.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T14:50:27.653

如果你使用一个函数对象，你可以携带任何你需要的状态。

两个有用的算法是`transform`和`accumulate`。

[`transform`](http://en.cppreference.com/w/cpp/algorithm/transform)可以带一个函数对象对序列中的每个对象进行转换：

```
class TransformerWithScratchSpace {
public:
    Target operator()(const Source& source);
};

vector<Source> sources;
vector<Target> targets;
targets.reserve(sources.size());

transform(sources.begin(), sources.end(),
          back_inserter<Target>(targets),
          TransformerWithScratchSpace()); 
```

[`accumulate`](http://en.cppreference.com/w/cpp/algorithm/accumulate)可以采用一个函数对象，它将所有对象累积到自身中。结果是累积的对象。蓄能器本身不必产生任何东西。

```
class Accumulator {
public:
    Accumulator& operator+()(const Source& source);
};

vector<Source> sources;

Accumulator accumulated = accumulate(sources.begin(), sources.end(),
                                     Accumulator()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T17:59:00.767

您最初的问题使用的设计`resize()`效率不高，因为调整大小可能不仅需要分配，而且还会将现有内容从旧分配复制到新分配。它还需要在释放旧空间之前分配和填充新空间，从而增加最大峰值内存使用量。

最好为客户端代码提供某种方法来计算必须提供多大的结构作为暂存空间，然后断言传递的暂存空间满足库例程在入口处的需要。计算可以是算法类的另一种方法，或者暂存空间对象的分配/工厂可以采用适当的代表性参数（正确的大小/形状，或大小本身）并返回合适且可重用的暂存空间对象。

一旦被要求使用，工作者算法不应该以任何方式“操纵”暂存空间以使其适合，因为这种操纵往往很昂贵。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-15T05:24:55.877

正如你所提到的，这个问题真的可以被认为远远超出了暂存空间中的图像。我实际上以许多不同的形式遇到过这种情况（内存部分、类型化数组、线程、网络连接......）。

所以我最终做的是给自己写一个通用的“ `BufferPool`”。它是一个管理任何形式的缓冲区对象的类，无论是字节数组、其他一些内存，还是（在您的情况下）分配的图像。我从`ThreadPool`.

这是一个相当简单的类，它维护一个对象池，当您需要一个`Buffer`对象时，您可以从中缓冲，当您完成它时，它会返回到池中。该函数将检查池中是否有可用的缓冲区，如果没有，将创建一个新的。如果池中有一个，它将清除它，即清除它，以便其行为与新创建的相同。`acquire``release``acquire``reset``Buffer`

然后我有几个 this 的静态实例，一个用于我使用`BufferPool`的每种不同类型：一个用于数组，一个用于数组，......（我正在用 Java 编码，以防你想知道...... :) 我然后在我正在编写的**所有**库函数中使用这些静态实例。例如，这允许我的加密函数可以与我的二进制展平函数或我的应用程序中的任何其他代码共享字节数组。通过这种方式，我可以最大限度地重用这些对象，并且在许多情况下它给了我**很大的性能提升。**`Buffer``byte``char`

 ****在 C++ 中，您可以通过基于这种池技术为所需的数据结构编写[自定义分配器来非常优雅地实现这种无处不在的方案（感谢 Andrew 指出这一点；请参阅评论）。](http://en.cppreference.com/w/cpp/concept/Allocator)

我为我的字节数组缓冲区做的一件事是该`acquire`函数将接受一个`minimumLength`参数，该参数指定我需要的缓冲区的最小大小。然后，它只会从池中返回一个至少具有此长度的字节数组，或者如果池为空或其中只有较小的图像，则创建一个新的。您可以对图像缓冲区使用相同的方法。让`acquire`函数接受一个`minWidth`和`minHeight`参数，然后从池中返回至少具有这些尺寸的图像，或者创建具有这些尺寸的图像。然后，您可以让该`reset`功能仅清除图像的 (0, 0) 到 ( `minWidth`, `minHeight`) 部分，如果您甚至需要清除它。

我决定在我的代码中不担心的一个功能，但您可能需要考虑取决于您的应用程序将运行多长时间以及它将处理多少不同的图像大小是您是否想以某种方式限制缓冲区大小并释放缓存的图像以减少应用程序的内存使用。

举个例子，这是我用于我的代码`ByteArrayPool`：

```
public class ByteArrayPool {

    private static final Map<Integer, Stack<byte[]>> POOL = new HashMap<Integer, Stack<byte[]>>();

    /**
     * Returns a <code>byte[]</code> of the given length from the pool after clearing
     * it with 0's, if one is available. Otherwise returns a fresh <code>byte[]</code>
     * of the given length.
     * 
     * @param length the length of the <code>byte[]</code>
     * @return a fresh or zero'd buffer object
     */
    public static byte[] acquire(int length) {
        Stack<byte[]> stack = POOL.get(length);
        if (stack==null) {
            if (CompileFlags.DEBUG) System.out.println("Creating new byte[] pool of lenth "+length);
            return new byte[length];
        }
        if (stack.empty()) return new byte[length];
        byte[] result = stack.pop();
        Arrays.fill(result, (byte) 0);
        return result;
    }

    /**
     * Returns a <code>byte[]</code> of the given length from the pool after optionally clearing
     * it with 0's, if one is available. Otherwise returns a fresh <code>byte[]</code>
     * of the given length.<br/>
     * <br/>
     * If the initialized state of the needed <code>byte[]</code> is irrelevant, calling this
     * method with <code>zero</code> set to <code>false</code> leads to the best performance.
     * 
     * @param length the length of the <code>byte[]</code>
     * @param zero T - initialize a reused array to 0
     * @return a fresh or optionally zero'd buffer object
     */
    public static byte[] acquire(int length, boolean zero) {
        Stack<byte[]> stack = POOL.get(length);
        if (stack==null) {
            if (CompileFlags.DEBUG) System.out.println("Creating new byte[] pool of lenth "+length);
            return new byte[length];
        }
        if (stack.empty()) return new byte[length];
        byte[] result = stack.pop();
        if (zero) Arrays.fill(result, (byte) 0);
        return result;
    }

    /**
     * Returns a <code>byte[]</code> of the given length from the pool after setting all
     * of its entries to the given <code>initializationValue</code>, if one is available.
     * Otherwise returns a fresh <code>byte[]</code> of the given length, which is also
     * initialized to the given <code>initializationValue</code>.<br/>
     * <br/>
     * For performance reasons, do not use this method with <code>initializationValue</code>
     * set to <code>0</code>. Use <code>acquire(<i>length</i>)</code> instead.
     * 
     * @param length the length of the <code>byte[]</code>
     * @param initializationValue the
     * @return a fresh or zero'd buffer object
     */
    public static byte[] acquire(int length, byte initializationValue) {
        Stack<byte[]> stack = POOL.get(length);
        if (stack==null) {
            if (CompileFlags.DEBUG) System.out.println("Creating new byte[] pool of lenth "+length);
            byte[] result = new byte[length];
            Arrays.fill(result, initializationValue);
            return result;
        }
        if (stack.empty()) {
            byte[] result = new byte[length];
            Arrays.fill(result, initializationValue);
            return result;
        }
        byte[] result = stack.pop();
        Arrays.fill(result, initializationValue);
        return result;
    }

    /**
     * Puts the given <code>byte[]</code> back into the <code>ByteArrayPool</code>
     * for future reuse.
     * 
     * @param buffer the <code>byte[]</code> to return to the pool
     */
    public static byte[] release(byte[] buffer) {
        Stack<byte[]> stack = POOL.get(buffer.length);
        if (stack==null) {
            stack = new Stack<byte[]>();
            POOL.put(buffer.length, stack);
        }
        stack.push(buffer);
        return buffer;
    }
} 
```

然后，在我需要的**所有**代码的其余部分中`byte[]`，我使用类似的东西：

```
byte[] buffer = ByteArrayPool.acquire(65536, false);
try {
    // Do something requiring a byte[] of length 65536 or longer
} finally {
    ByteArrayPool.release(buffer);
} 
```

请注意，我是如何添加 3 个不同的`acquire`函数的，这些函数允许我指定我需要的缓冲区的“干净”程度。例如，如果我无论如何都要覆盖所有它，则无需浪费时间先将其归零。****

# sql - 有没有办法在 UPDATE 查询中包含不可更新的查询？

> ID：14885363
> 
> 赞同：1
> 
> 时间：2013-02-14T22:36:41.303
> 
> 标签：sql, ms-access, sql-update, subquery, union-all

对于以下查询：

```
UPDATE tempSpring_ASN AS t
SET t.RECORD_TYPE = (
        SELECT TOP 1 RECORD_TYPE
        FROM (
            SELECT "A" AS RECORD_TYPE
            FROM TABLE5
            UNION ALL
            SELECT "B" AS RECORD_TYPE
            FROM TABLE5
            )
        ); 
```

我得到了，“操作必须使用可更新的查询。” 我不明白。我不是要更新联合查询。我只是想用联合查询的输出（单个值）更新一个可更新的记录集。

（[Access SQL Update One Table In Join Based on Value in Same Table](https://stackoverflow.com/questions/14862694/access-sql-update-one-table-in-join-based-on-value-in-same-table)（下面也提供）提供的解决方案不适用于这种情况，这与本页顶部的说明相反。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:40:36.117

这个问题是对之前发布的问题、数据和代码示例的参考：

[根据同一表中的值访问 SQL 更新联接中的一个表](https://stackoverflow.com/questions/14862694/access-sql-update-one-table-in-join-based-on-value-in-same-table)

嗨，AYS，

在 Access 中，需要对表运行更新查询。由于 UNION 查询是多组记录的组合，结果集不再是一个表，也不能成为 Update 查询的对象，因为结果集中的记录不再与任何一个特定表唯一标识（甚至如果理论上可以的话）。访问被硬编码以将每个 UNION 查询视为只读，这在有多个基础表时是有意义的。还有许多其他条件（例如 SELECT 语句中的子查询）也会触发此条件。

可以这样想：如果您没有使用 TOP 1 并且您的 UNION 查询返回了多个结果，JET 将如何知道将哪个结果应用于您的表中的唯一记录？因此，JET 对所有此类情况一视同仁。

不幸的是，即使所有数据都来自同一个表，情况也是如此。在这种情况下，JET 优化器很可能根本不够聪明，无法意识到这种情况并以不使用 UNION 的方式重新表述查询。

在这种情况下，您仍然可以通过重新声明查询以使所有内容都引用您的基表来获得所需的内容。例如，您可以使用以下内容作为 SELECT 查询来获取先前 SHP_CUSTOM_5 记录的 PO_NUM 值：

```
SELECT
t1.SHP_CUSTOM_5
, t1.PO_NUM
, t1.SHP_CUSTOM_5 -1 AS PREV_RECORD

, (SELECT
t2.PO_NUM
FROM
tempSpring_ASN As t2
WHERE
t2.SHP_CUSTOM_5 = (t1.SHP_CUSTOM_5 -1)
) AS PREV_PO

FROM
tempSpring_ASN AS t1
; 
```

然后，您可以将其表述为更新查询，如下所示，以执行“LIN”更新：

```
UPDATE
tempSpring_ASN AS t1 

SET 
t1.RECORD_TYPE = "LIN"

WHERE
t1.PO_NUM=

(
SELECT 
t2.PO_NUM

FROM
tempSpring_ASN As t2

WHERE
t2.SHP_CUSTOM_5 = (t1.SHP_CUSTOM_5 -1)
)
; 
```

这段代码在我使用虚拟数据运行的测试中是成功的。

关于您的“HDR”更新，您实际上是在执行两个单独的更新。1) 如果 PO_NUM 与上一条记录的 PO_NUM 匹配，则将 RECORD_TYPE 设置为“LIN” 2) 如果是第一条记录，则将 RECORD_TYPE 设置为“HDR”

我不清楚为什么在一个查询中执行这些操作会有好处。我建议使用您在原始 SELECT 查询示例中使用的 SHP_CUSTOM_5 方法的“TOP 1”执行 HDR 更新，因为这将是一个相对简单的 UPDATE 查询。可以在 Update 查询中使用 IIF()，但我不知道您会从所需的额外时间和复杂性中获得什么额外好处（它很可能只是可读性低得多）。

祝你好运！

# android - 更新通知文本，而不是整个通知

> ID：14885368
> 
> 赞同：63
> 
> 时间：2013-02-14T22:37:10.693
> 
> 标签：android, android-notifications

**序幕**

我正在尝试在通知上添加计时器。计时器是一项服务。每秒调用此行（继续 Thread 是“正在运行”的布尔值，timeString 是显示时间的详细字符串）：

```
NotificationChrono.updateNotification(getApplicationContext(), continueThread, 
NOTIF_ID, timeString, "Chronometer", notificationManager); 
```

这是 NotificationChrono 类：

```
public class NotificationChrono {

    static public void updateNotification(Context context, boolean running,
        int id, String title, String text,
        NotificationManager notificationManager) {

        Intent stopIntent = new Intent("com.corsalini.david.barcalc.STOP");
        PendingIntent stopPendingIntent = PendingIntent.getBroadcast(context,
            0, stopIntent, 0);

    Intent startIntent = new Intent(
            "com.corsalini.david.barcalc.STARTPAUSE");
    PendingIntent startPendingIntent = PendingIntent.getBroadcast(context,
            0, startIntent, 0);

    NotificationCompat.Builder builder = new NotificationCompat.Builder(
            context)

            .setContentText(context.getString(R.string.notif_text))

            .setContentTitle(title)

            .setSmallIcon(R.drawable.ic_action_alarm_2)

            .setAutoCancel(false)

            .setOngoing(running)

            .setOnlyAlertOnce(true)

            .setContentIntent(
                    PendingIntent.getActivity(context, 10, new Intent(
                            context, FrontActivity.class)
                            .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP), 0))
            .addAction(
                    running ? R.drawable.ic_action_pause
                            : R.drawable.ic_action_play,
                    running ? context.getString(R.string.pause) : context
                            .getString(R.string.start), startPendingIntent)
            .addAction(R.drawable.ic_action_stop,
                    context.getString(R.string.stop), stopPendingIntent);

    notificationManager.notify(id, builder.build());
}
} 
```

**问题**

每隔一秒就会删除并重新创建通知，从视觉上看，这意味着每隔一秒通知就会消失并重新出现在通知列表中。

我想要的只是更新 TITLE 文本，而不是每秒完全重新创建通知。是否可以？

* * *

## 回答 #1

> 赞同：130
> 
> 时间：2013-05-08T07:48:24.680

确保`NotificationCompat.Builder`每次都使用相同的构建器来创建`Notification`！

虽然第一次您必须设置所有内容，但第二次使用`Builder`您只需设置要更新的值。之后它`notificationManager.notify(id, builder.build())`就像你一样调用。如果您使用相同`ID`的，则通知会更新（重要！）。

例子：

```
//First time
NotificationCompat.Builder builder = new NotificationCompat.Builder(context)
            .setContentText(context.getString(R.string.notif_text))
            .setContentTitle(title)
            .setSmallIcon(R.drawable.ic_action_alarm_2)
            .setAutoCancel(false)
            .setOngoing(running)
            .setOnlyAlertOnce(true)
            .setContentIntent(
                    PendingIntent.getActivity(context, 10, 
                            new Intent(context, FrontActivity.class)                                 
                            .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP),
                    0)
            )
            .addAction(running ? R.drawable.ic_action_pause 
                               : R.drawable.ic_action_play,
                       running ? context.getString(R.string.pause)
                               : context.getString(R.string.start),
                       startPendingIntent)
            .addAction(R.drawable.ic_action_stop, context.getString(R.string.stop),
                    stopPendingIntent);

notificationManager.notify(id, builder.build());

//Second time
builder.setContentTitle(title);
notificationManager.notify(id, builder.build()); 
```

但是你也可以使用类的[`setUsesChronometer`](http://developer.android.com/reference/android/support/v4/app/NotificationCompat.Builder.html#setUsesChronometer%28boolean%29)方法`NotificationCompat`。这会使用给定的时间戳自动显示一个计时器（可以使用[setWhen](http://developer.android.com/reference/android/app/Notification.Builder.html#setWhen%28long%29)设置）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-05-18T13:57:40.317

感谢 PieterAelse 的想法！

在我的情况下，我不得不在第二次和以下时间使用这个（建立一个新的通知）：

```
 builder.setContentText(getConvertedTime(millisUntilFinished));
        Notification notification = builder.getNotification();
        notification.flags = Notification.FLAG_ONGOING_EVENT;            
        nm.notify(R.string.app_name,notification); 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-02-21T12:47:45.047

您需要将通知标记为“仅触发一次”

```
Builder#setOnlyAlertOnce(true) 
```

# html - Response.Write 中的 html 代码

> ID：14885371
> 
> 赞同：-2
> 
> 时间：2013-02-14T22:37:10.920
> 
> 标签：html, asp-classic

嗨，我需要在 Response.Write 中包含一个 html 代码。我的代码是这样的

```
Response.Write "<table><tr><td><label style=""width: 61px""><font size=""2"">Candidate:&nbsp; </font></label></td>
                <td>
                <input name="pcfname" value="<%=session("Fname")%>"  maxlength="255" size="14" style="width:79%"/>
                <label style="width: 41px">First</label></td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <td>
                <input name="pclname" value="<%=session("Lname")%>" class="" maxlength="255" size="14" style="width:39%"/>
                <label>Last</label></td></tr></table>&nbsp;&nbsp;&nbsp;<br />
                <label><font size="2">Classification:&nbsp; </font></label>
                <input name="pclassif" value="<%=session("classification")%>" class="" maxlength="255" size="14" style="width:13%"/><br /><br />
                <label><font size="2">Degree Sought:&nbsp; </font></label>
                <input name="pdsought" value="<%=session("degree_sought")%>" class="" maxlength="255" size="14" style="width:16%"/><br /><br />
                <label><font size="2">Completion Date:&nbsp; </font></label>
                <input name="pdsought" value="<%=session("completion_date")%>" class="" maxlength="255" size="14" style="width:16%"/><br /><br />" 
```

它向我显示错误“未终止的字符串常量”，我无法弄清楚。

一些建议会有很大帮助。

-谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:39:59.777

使用单引号来封装您的 HTML，这样 HTML 中的双引号就不会终止字符串。

```
Response.Write '<table><tr><td><label style=""width: 61px""><font size=""2"">Candidate:&nbsp; </font></label></td>
                <td>
                <input name="pcfname" value="<%=session("Fname")%>"  maxlength="255" size="14" style="width:79%"/>
                <label style="width: 41px">First</label></td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <td>
                <input name="pclname" value="<%=session("Lname")%>" class="" maxlength="255" size="14" style="width:39%"/>
                <label>Last</label></td></tr></table>&nbsp;&nbsp;&nbsp;<br />
                <label><font size="2">Classification:&nbsp; </font></label>
                <input name="pclassif" value="<%=session("classification")%>" class="" maxlength="255" size="14" style="width:13%"/><br /><br />
                <label><font size="2">Degree Sought:&nbsp; </font></label>
                <input name="pdsought" value="<%=session("degree_sought")%>" class="" maxlength="255" size="14" style="width:16%"/><br /><br />
                <label><font size="2">Completion Date:&nbsp; </font></label>
                <input name="pdsought" value="<%=session("completion_date")%>" class="" maxlength="255" size="14" style="width:16%"/><br /><br />' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T16:54:23.033

如果我纠正一条线，你可以解决其余的问题，这可能是最好的

```
<input name="pcfname" value="<%=session("Fname")%>"  maxlength="255" size="14" style="width:79%"/> 
```

应该改写为

```
 response.write "<input name=""pcfname"" value="""&session("Fname")&"""  maxlength=""255"" size=""14"" style=""width:79%""/>" &vbcrlf 
```

笔记

1.  html属性的双引号
2.  <%=objectname%> 是一个小的 asp scriptlet，所以你不能把它放在另一个 scriptlet 中。将对象名称与 & 号连接起来

我不确定你为什么要在 response.write 语句中做所有这些。为什么不直接关闭你的 asp scriptlet，把它写成 html 然后打开一个新的 scriptlet

# visual-studio-2010 - 这个配置转换有什么问题？

> ID：14885372
> 
> 赞同：1
> 
> 时间：2013-02-14T22:37:13.807
> 
> 标签：visual-studio-2010, .net-4.0

我有 web.base.config 的以下部分：

```
 <system.serviceModel>
    <client>
      <!--   Reporting Services -->
      <endpoint name="ReportExecutionEndpoint" address="http://~MACHINENAMEREPLACEMENTTOKEN~/ReportServer/ReportExecution2005.asmx" binding="basicHttpBinding" behaviorConfiguration="AuthenticatedBehavior" bindingConfiguration="ReportingServicesConfiguration" contract="ReportingWebService.ReportExecutionServiceSoap" />
      <!--   Custom Services    -->
      <endpoint name="Blah1Endpoint" address="net.tcp://~MACHINENAMEREPLACEMENTTOKEN~/DomainServices/blah1.svc" binding="netTcpBinding" behaviorConfiguration="AuthenticatedBehavior" bindingConfiguration="LargerMessagesConfiguration" contract="Fully.Qualified.IBlah1" />
      <endpoint name="Blah2Endpoint" address="net.tcp://~MACHINENAMEREPLACEMENTTOKEN~/DomainServices/blah2.svc" binding="netTcpBinding" behaviorConfiguration="AuthenticatedBehavior" bindingConfiguration="LargerMessagesConfiguration" contract="Fully.Qualified.IBlah2" />
      <endpoint name="Blah3Endpoint" address="net.tcp://~MACHINENAMEREPLACEMENTTOKEN~/DomainServices/blah3.svc" binding="netTcpBinding" behaviorConfiguration="AuthenticatedBehavior" bindingConfiguration="LargerMessagesConfiguration" contract="Fully.Qualified.IBlah3" />
    </client>
  </system.serviceModel> 
```

我想`<identity><dns /></identity>`为所有*CustomServices*添加一个 in，但不是*ReportingServices*。为此，我有以下转换段：

```
 <system.serviceModel>
    <client>
      <endpoint xdt:Locator="Condition(contains(@address, 'net.tcp'))">
        <identity xdt:Transform="Insert">
          <dns value="~MACHINENAMEREPLACEMENTTOKEN~" />
        </identity>
      </endpoint>
    </client>
  </system.serviceModel> 
```

问题在于，这仅适用于**第一个** *CustomService*而不是所有其他的（尽管它正确地跳过了*ReportingServices*）。如何更改此转换以使其到达我的所有*CustomServices*端点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:05:56.580

插入转换的设计方式是供一次性使用的。因此，它将仅插入第一个匹配项。

在这种情况下，您的解决方法是为每个 net.tcp 端点创建一个插入转换。

如果您确实需要完成此操作，您可以创建自己的自定义转换，该转换可以插入多个匹配项。[我在http://sedodream.com/2010/09/09/ExtendingXMLWebconfigConfigTransformation.aspx](http://sedodream.com/2010/09/09/ExtendingXMLWebconfigConfigTransformation.aspx)上写了关于如何做到这一点的博客 。

# php - 如果用户选择不上传文件，则将 NULL 值插入 mySQL

> ID：14885376
> 
> 赞同：0
> 
> 时间：2013-02-14T22:37:28.887
> 
> 标签：php, mysql, sql, upload

我网站上的用户可以选择上传几个不同的文件。代码上传文件并将指向该文件的链接保存在 mySQL 数据库中。

如果用户没有选择要上传的文件，我正在尝试在我的 sql 数据库中插入一个空值。

下面的代码只是输入一个空值，无论是否选择了要上传的文件......请帮助。（位置变量在代码中较早建立并且工作正常）

这是我的代码：

```
if (is_null($_POST['imgfile'])) {
$imglink = NULL;
} else {
$imglink = mysql_real_escape_string($imglocation);
}
if (is_null($_POST['vidfile'])) {
$vidlink = NULL;
} else {
$vidlink = mysql_real_escape_string($vidlocation);
}

$sql="INSERT INTO db (imgfile, vidfile)
VALUES(
'$imglink',
'$vidlink')"; 
```

正确代码：

```
if (empty($_FILES['imgfile']['name'])) {
$imglink = '';
} else {
$imglink = mysql_real_escape_string($imglocation);
}
if (empty($_FILES['vidfile']['name'])) {
$vidlink = '';
} else {
$vidlink = mysql_real_escape_string($vidlocation);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T22:55:13.967

1.  您确定用户选择的文件在**$_POST**中可用- 而不是在**$_FILES**中？

2.  您可以只允许 NULL 并将它们设置为存储图像和视频文件链接的表的 db 字段（使用**DEFAULT NULL**子句）中的默认值 - 因此在没有这些值的表中插入新记录，会自动将它们设置为 NULL。

# python - Python - 从字符串中提取数字/单词时速度慢

> ID：14885381
> 
> 赞同：0
> 
> 时间：2013-02-14T22:37:30.457
> 
> 标签：python, regex

菜鸟在这里尝试通过做一个项目来学习python，因为我从书本上学得不好。

我正在使用大量代码来执行对我来说似乎是一个小操作 -

我想从以下字符串中提取 4 个变量

```
'Miami 0, New England 28' 
```

（变量为 home_team、away_team、home_score、away_score）

我的程序运行得很慢，我认为可能是这段代码。我想我正在寻找最快/最有效的方法。

正则表达式会更快吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:39:59.450

您的文本似乎可以拆分两次。首先`,`是空格，然后是空格：

```
info1,info2 = s.split(',')
home,home_score = info1.rsplit(None,1)
away,away_score = info2.rsplit(None,1) 
```

例如：

```
>>> s = 'Miami 0, New England 28'
>>> info1,info2 = s.split(',')
>>> home,home_score = info1.rsplit(None,1)
>>> away,away_score = info2.rsplit(None,1)
>>> print [home,home_score,away,away_score]
['Miami', '0', ' New England', '28'] 
```

您*可以*使用 regex 轻松做到这一点——但您要为它的可读性付出代价。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:19:02.023

```
import re

reg = re.compile('\s*(\D+?)\s*(\d+)'
                 '[,;:.#=@\s]*'
                 '(\D+?)\s*(\d+)'
                 '\s*')

for s in ('Miami 0, New England 28',
          'Miami0,New England28  ',
          '  Miami    0   . New England28',
          'Miami 0 ; New England 28',
          'Miami0#New England28  ',
          '  Miami 0   @ New England28'):

    print reg.search(s).groups() 
```

结果

```
('Miami', '0', 'New England', '28')
('Miami', '0', 'New England', '28')
('Miami', '0', 'New England', '28')
('Miami', '0', 'New England', '28')
('Miami', '0', 'New England', '28')
('Miami', '0', 'New England', '28') 
```

`'\D'`意思是“没有数字”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:01:11.520

如果您确实需要正则表达式：

```
import re

s='Miami 0, New England 28'
l=re.findall(r'^([^\d]+)\s(\d+)\s*,\s*([^\d]+)\s(\d+)',s)
hm_team,away_team,hm_score,away_score=l[0]

print l 
```

打印`[('Miami', '0', 'New England', '28')]`并将这些值分配给变量。

# java - 泽西岛不支持嵌套资源中的声明性超链接是否正确？

> ID：14885383
> 
> 赞同：4
> 
> 时间：2013-02-14T22:37:36.203
> 
> 标签：java, jersey, hypermedia

```
public class Widget {
    @Ref(resource=WidgetResource.class)
    URI url;

    ...

    public URI getUrl() {
        return url;
    }

    public Wonkle getWonkle() {
        return wonkle;
    }

}

public class Wonkle {
    @Ref(resource=WonkleResource.class)
    URI url;

    public URI getUrl() {
        return url;
    }

   ...
} 
```

Wonkle 类型的 JSON 表示具有一个具有适当值的 url 属性。但是，当Wonkle作为Widget类型中的嵌套属性使用时，其url属性为空值。

我做错了什么，还是这正是 LinkFilter 的工作方式？

谢谢！

# feed - 简单的 set_feed_url 提要

> ID：14885384
> 
> 赞同：0
> 
> 时间：2013-02-14T22:37:47.407
> 
> 标签：feed, simplepie

并提前感谢您的帮助。我正在使用 Simplepie 来尝试引入这个提要：

[http://www.p2rx.org/webservices/rssNews.cfm?Type=Tribal&getall=true](http://www.p2rx.org/webservices/rssNews.cfm?Type=Tribal&getall=true)

进入这个页面：

[http://www.tribalp2.org/events/news.php](http://www.tribalp2.org/events/news.php)

如您所见，它不起作用。尽管我输入了许多其他提要网址：

```
$feed->set_feed_url('http://www.p2rx.org/webservices/rssNews.cfm'); 
```

工作得很好。我已经添加

```
$feed->force_feed(true); 
```

也是。问题可能是什么？完整的代码是：

```
<?php
require_once('../php/autoloader.php');
$feed = new SimplePie();
$feed->set_feed_url('http://www.p2rx.org/webservices/rssNews.cfm?Type=Tribal&getall=true');
$feed->force_feed(true);
$feed->init();
$feed->handle_content_type();
?>

<?php foreach ($feed->get_items(0,30) as $item): ?>
    <div class="item">
        <h4><a href="<?php echo $item->get_permalink(); ?>"><?php echo $item->get_title(); ?></a> - <?php echo $item->get_date('F j, Y'); ?></h4>
        <p><?php echo $item->get_description(); ?></p>
    </div>
<?php endforeach; ?>
<?php unset($feed); ?> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T03:14:18.013

SimplePie 无法显示所有提要。有一些不符合标准的垃圾提要，即使你试图强制它，SimplePie 也无法破译它们。但是检查[http://validator.w3.org/feed/](http://validator.w3.org/feed/)您的提要会验证。

尝试不强制进给，也尝试在初始化后调用强制进给。如果提要验证 SimplePie 应该处理它。

# winjs - 带有选择选项的 WinJS 应用栏

> ID：14885390
> 
> 赞同：1
> 
> 时间：2013-02-14T22:38:29.987
> 
> 标签：winjs

我有一个具有自定义控件的应用栏，如下所示：

```
<div class="appBarMain" data-win-control="WinJS.UI.AppBar" aria-label="Navigation Bar" 
    data-win-options="{layout:'custom',placement:'top'}">
    <header class="upperNavBar">
        <div class="divHome item">
            <img class="image" src="/images/storelogo.png"/>
            <div class="overlay">
                <h4 class="title">Go Home</h4>
            </div>
        </div>
         <div class="div1 item">
            <img class="image" src="/images/storelogo.png"/>
            <div class="overlay">
                <h4 class="title">First Item</h4>
            </div>
        </div> 
        <div class="div2 item">
            <img class="image" src="/images/storelogo.png"/>
            <div class="overlay">
                <h4 class="title">Second Item</h4>
            </div>
        </div> 
    </header>
</div> 
```

“第一项”和“第二项”是 div，点击导航到 1 或 2 的页面。我们的要求已经改变，我们现在需要从“第一项”和“第二项”中显示一种下拉菜单。因此，当用户单击“第一项”中的下拉菜单时，它会在“子项 1”和“SunItem 2”下方显示两个按钮，当用户单击“第二项”时，它会显示两个按钮“子项 3”和“子项 4”。

此实现位于 Windows 8 天气应用程序中。如果您有多个地点，则顶部导航栏“地点”有此选项。

我的应用栏与天气应用上部导航栏完全相同。我们也想要这个下拉选项。

我只是不确定在这种情况下我必须使用什么控件（如果我想下拉）。

任何帮助表示赞赏。

*   吉里哈

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:56:05.467

@GotDibbs 推荐了[`WinJS.UI.Flyout`](http://msdn.microsoft.com/en-us/library/windows/apps/br211726.aspx)，但我认为更具体地说，你应该看看[`WinJS.UI.Menu`](http://msdn.microsoft.com/en-us/library/windows/apps/hh700921.aspx)。两者密切相关，但 Flyout 将要求您构建所有子菜单功能，而 Menu 已为您完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:51:58.390

您正在寻找的是`WinJS.UI.Flyout`控件。[您可以在 MSDN](http://msdn.microsoft.com/en-us/library/windows/apps/hh465354.aspx)上查看有关控件以及如何在此处实现的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-21T05:54:10.517

我推荐结合使用 WinJS NavBar 和 Flyout 来实现 Windows 8 天气应用顶部导航栏。MSDN NavBar 示例场景 #6 显示了如何启用此场景：[http ://code.msdn.microsoft.com/windowsapps/HTML-NavBar-control-sample-4472d92a/view/SourceCode#content](http://code.msdn.microsoft.com/windowsapps/HTML-NavBar-control-sample-4472d92a/view/SourceCode#content)

这是示例中的代码：

```
<div id="useSplit" data-win-control="WinJS.UI.NavBar">
        <div class="globalNav" data-win-control="WinJS.UI.NavBarContainer">
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Home', icon: 'url(../images/homeIcon.png)' }"></div>
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Favorite', icon: 'favorite', splitButton: 'true' }"></div>
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Your account', icon: 'people' }"></div>
        </div>
    </div>
    <div id="contactFlyout" data-win-control="WinJS.UI.Flyout" data-win-options="{ placement: 'bottom' }">
        <div id="contactNavBarContainer" data-win-control="WinJS.UI.NavBarContainer"}">
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Family' }"></div>
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Work' }"></div>
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Friends' }"></div>
            <div data-win-control="WinJS.UI.NavBarCommand" data-win-options="{ label: 'Blocked' }"></div>  
        </div>
    </div> 
```

# php - 如何在 PHP 中使用 JavaScript 变量？

> ID：14885391
> 
> 赞同：-7
> 
> 时间：2013-02-14T22:38:36.860
> 
> 标签：php, javascript, wordpress

我正在制作一个使用许多不同 php 文件的网站。我的网站使用 Wordpress，是一个音乐博客。我在屏幕顶部有一个 jPlayer 播放列表，对于每个单独的帖子，我都希望有一个播放按钮来播放那首歌。

我在几个不同的 php 文件中用 php 和 javascript 制作了一些函数。如何在我的一个 php 文件中声明一个全局 JavaScript 变量并在另一个 php 文件中访问它？我知道这措辞很糟糕，所以让我解释一下。

**文件 1：** my_functions.php（我在其中设置我的 jPlayer 播放列表。变量 song_index 是我想要的全局变量。

```
<script type = "text/javascript">
    var song_index = 0;
    var theTitles = new Array();
    var theMP3s = new Array();
    var jplayer_playlist;

    function add_song(title, mp3)
    {
        theTitles[song_index] = title;
        theMP3s[song_index] = mp3;
        song_index++;
    }

    function play_song(index)
    {
        alert("You want to play song " + index);
        //jplayer_playlist.play(index);
    }

    function get_playlist()
    {
        var playlist = new Array();

        for(var i = 0; i < theTitles.length; i++)
        {
            playlist[i] = {title: theTitles[i], mp3: theMP3s[i]};
        }
        return playlist;
    }

    $(document).ready(function()
    {
        var playlist = get_playlist();
        jplayer_playlist = new jPlayerPlaylist({
            jPlayer: "#jquery_jplayer_1",
            cssSelectorAncestor: "#jp_container_1",
            oggSupport:false
        }, playlist, {
            swfPath: "/js",
            supplied: "mp3",
            wmode: "window"
        }
        );
    });
    //]]>
    </script> 
```

这会为每个页面动态设置我的 jPlayer 播放列表。

**文件 2** shortcodes.php（这是我使用 Wordpress 的短代码添加歌曲的地方。这是我想在播放列表中添加歌曲时使用的代码......）

```
 function player_function($args)
{
    $url = $args['url'];
    $title = $args['title'];

    if(!$title)
    {
        $title = get_the_title();
    }

    add_song($title, $url);

    $ret = "<a href = '" . $url . "'></a><br><a href=\"javascript:void(0)\" onclick = \"play_song(".$_GET['window.song_index'].")\">Play</a>";

    return "$ret";
} 
```

几乎我只需要从第一个文件访问**song_index**到一个 php 变量中，这样我就可以传递它。如您所见，我尝试使用 $_GET ，因为有人说您可以通过这种方式访问​​ JS 变量，但它不起作用。有人有任何线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:45:16.197

Javascript 和 PHP 实际上对彼此一无所知。但是，您可以使用 PHP 来编写 JavaScript。所以在 my_functions.php 你可以这样做：

```
<?php
  $myGlobalSongIndex = '0'; // or however you want to assign this else....
?>
<script type = "text/javascript">
    var song_index = <?php print myGlobalSongIndex; ?>; 
```

然后在写链接行的 shortcodes.php 中，打印`$myGlobalSongIndex`而不是`$_GET['window.song_index']`你现在正在做的。您需要确保的一件事是这`$myGlobalSongIndex`两个地方都在范围内。这意味着如果它在函数或类中，则需要使用`global`关键字。

这种确切的方法有一个缺点。您将无法将 javascript 分离到一个单独的文件中，这在许多情况下可能非常好。您可以在 php 中编写以下内容，作为 html 部分的`head`一部分：

```
<?php
  $myGlobalSongIndex = '0'; // or however you want to assign this else....
?>
<script type = "text/javascript">
    var song_index = <?php print myGlobalSongIndex; ?>;
</script> 
```

并确保之后加载外部 javascript 文件。然后，当您`song_index`在 javascript 文件中使用 时，您可能希望确保它确实为您可能包含它的任何页面初始化，而无需在 php.ini 中呈现该字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:44:34.227

您必须将 js 变量放入 url 查询字符串（本质上是发送一个 GET 请求，您可以在其中从 PHP 访问这些变量）或使用[AJAX](http://api.jquery.com/jQuery.ajax/)

所以 www.yoursite.com?song_index=5

或建立一个ajax调用并在数据中发送你的变量

# django - Django / Celery / Kombu worker 错误：收到并删除了未知消息。目的地错误？

> ID：14885396
> 
> 赞同：2
> 
> 时间：2013-02-14T22:39:08.617
> 
> 标签：django, message-queue, celery, worker, kombu

似乎消息没有正确放入队列。

我将 Django 与 Celery 和 Kombu 一起使用，以利用 Django 自己的数据库作为代理后端。我只需要一个非常简单的 Pub/Sub 设置。它最终会部署到 Heroku，所以我使用 foreman 在本地运行。以下是相关代码和信息：

**点冻结**

```
Django==1.4.2
celery==3.0.15
django-celery==3.0.11
kombu==2.5.6 
```

**档案**

```
web: source bin/activate; python manage.py run_gunicorn -b 0.0.0.0:$PORT -w 4; python manage.py syncdb
celeryd: python manage.py celeryd -E -B --loglevel=INFO 
```

**设置.py**

```
# Celery configuration
import djcelery
CELERY_IMPORTS = ("api.tasks",)
BROKER_URL = "django://localhost//"
djcelery.setup_loader() 
```

**put_message**

```
with Connection(settings.BROKER_URL) as conn:
  queue = conn.SimpleQueue('celery')
  queue.put(id)
  queue.close() 
```

**api/tasks.py**

```
@task()
def process_next_task():
  with Connection(settings.BROKER_URL) as conn:
    queue = conn.SimpleQueue('celery')
    message = queue.get(block=True, timeout=1)
    id = int(message.payload)
    try:
      Model.objects.get(id=id)
    except Model.DoesNotExist:
      message.reject()
    else:
      # Do stuff here
      message.ack()
    queue.close() 
```

在终端中，`foreman start`工作正常并显示：

```
started with pid 31835
17:08:22 celeryd.1 | started with pid 31836
17:08:22 web.1     | /usr/local/foreman/bin/foreman-runner: line 41: exec: source: not found
17:08:22 web.1     | 2013-02-14 17:08:22 [31838] [INFO] Starting gunicorn 0.16.1
17:08:22 web.1     | 2013-02-14 17:08:22 [31838] [INFO] Listening at: http://0.0.0.0:5000 (31838)
17:08:22 web.1     | 2013-02-14 17:08:22 [31838] [INFO] Using worker: sync
17:08:22 web.1     | 2013-02-14 17:08:22 [31843] [INFO] Booting worker with pid: 31843
17:08:22 web.1     | 2013-02-14 17:08:22 [31844] [INFO] Booting worker with pid: 31844
17:08:22 web.1     | 2013-02-14 17:08:22 [31845] [INFO] Booting worker with pid: 31845
17:08:22 web.1     | 2013-02-14 17:08:22 [31846] [INFO] Booting worker with pid: 31846
17:08:22 celeryd.1 | [2013-02-14 17:08:22,858: INFO/Beat] Celerybeat: Starting...
17:08:22 celeryd.1 | [2013-02-14 17:08:22,870: WARNING/MainProcess] celery@myhost.local ready.
17:08:22 celeryd.1 | [2013-02-14 17:08:22,873: INFO/MainProcess] consumer: Connected to django://localhost//.
17:08:42 celeryd.1 | [2013-02-14 17:08:42,926: WARNING/MainProcess] Received and deleted unknown message. Wrong destination?!?
17:08:42 celeryd.1 | The full contents of the message body was: body: 25 (2b) {content_type:u'application/json' content_encoding:u'utf-8' delivery_info:{u'priority': 0, u'routing_key': u'celery', u'exchange': u'celery'}} 
```

最后两行不会立即显示，但会在我的 API 收到运行上述**put_message**部分中的代码的 POST 请求时显示。我已经尝试过使用 Kombu 完全成熟的 Producer 和 Consumer 类，结果相同。

Kombu 的 SimpleQueue 示例：[http](http://kombu.readthedocs.org/en/latest/userguide/examples.html#hello-world-example)
://kombu.readthedocs.org/en/latest/userguide/examples.html#hello-world-example 芹菜文档：[http ://docs.celeryproject.org/en/latest/index.html](http://docs.celeryproject.org/en/latest/index.html)

有任何想法吗？

**已编辑**

`--loglevel=DEBUG`在 procfile 中更改为将终端输出更改为以下内容：

```
08:54:33 celeryd.1 | started with pid 555
08:54:33 web.1     | started with pid 554
08:54:33 web.1     | /usr/local/foreman/bin/foreman-runner: line 41: exec: source: not found
08:54:36 web.1     | 2013-02-15 08:54:36 [557] [INFO] Starting gunicorn 0.16.1
08:54:36 web.1     | 2013-02-15 08:54:36 [557] [INFO] Listening at: http://0.0.0.0:5000 (557)
08:54:36 web.1     | 2013-02-15 08:54:36 [557] [INFO] Using worker: sync
08:54:36 web.1     | 2013-02-15 08:54:36 [564] [INFO] Booting worker with pid: 564
08:54:36 web.1     | 2013-02-15 08:54:36 [565] [INFO] Booting worker with pid: 565
08:54:36 web.1     | 2013-02-15 08:54:36 [566] [INFO] Booting worker with pid: 566
08:54:36 web.1     | 2013-02-15 08:54:36 [567] [INFO] Booting worker with pid: 567
08:54:37 celeryd.1 | [2013-02-15 08:54:37,480: DEBUG/MainProcess] [Worker] Loading modules.
08:54:37 celeryd.1 | [2013-02-15 08:54:37,484: DEBUG/MainProcess] [Worker] Claiming components.
08:54:37 celeryd.1 | [2013-02-15 08:54:37,484: DEBUG/MainProcess] [Worker] Building boot step graph.
08:54:37 celeryd.1 | [2013-02-15 08:54:37,484: DEBUG/MainProcess] [Worker] New boot order: {ev, queues, beat, pool, mediator, autoreloader, timers, state-db, autoscaler, consumer}
08:54:37 celeryd.1 | [2013-02-15 08:54:37,489: DEBUG/MainProcess] Starting celery.beat._Process...
08:54:37 celeryd.1 | [2013-02-15 08:54:37,490: DEBUG/MainProcess] celery.beat._Process OK!
08:54:37 celeryd.1 | [2013-02-15 08:54:37,491: DEBUG/MainProcess] Starting celery.concurrency.processes.TaskPool...
08:54:37 celeryd.1 | [2013-02-15 08:54:37,491: INFO/Beat] Celerybeat: Starting...
08:54:37 celeryd.1 | [2013-02-15 08:54:37,506: DEBUG/MainProcess] celery.concurrency.processes.TaskPool OK!
08:54:37 celeryd.1 | [2013-02-15 08:54:37,507: DEBUG/MainProcess] Starting celery.worker.mediator.Mediator...
08:54:37 celeryd.1 | [2013-02-15 08:54:37,507: DEBUG/MainProcess] celery.worker.mediator.Mediator OK!
08:54:37 celeryd.1 | [2013-02-15 08:54:37,507: DEBUG/MainProcess] Starting celery.worker.consumer.BlockingConsumer...
08:54:37 celeryd.1 | [2013-02-15 08:54:37,508: WARNING/MainProcess] celery@myhost.local ready.
08:54:37 celeryd.1 | [2013-02-15 08:54:37,508: DEBUG/MainProcess] consumer: Re-establishing connection to the broker...
08:54:37 celeryd.1 | [2013-02-15 08:54:37,510: INFO/MainProcess] consumer: Connected to django://localhost//.
08:54:37 celeryd.1 | [2013-02-15 08:54:37,628: DEBUG/Beat] Current schedule:
08:54:37 celeryd.1 | <Entry: celery.backend_cleanup celery.backend_cleanup() {<crontab: * 4 * * * (m/h/d/dM/MY)>}
08:54:37 celeryd.1 | [2013-02-15 08:54:37,629: DEBUG/Beat] Celerybeat: Ticking with max interval->5.00 minutes
08:54:37 celeryd.1 | [2013-02-15 08:54:37,658: DEBUG/Beat] Celerybeat: Waking up in 5.00 minutes.
08:54:38 celeryd.1 | [2013-02-15 08:54:38,110: DEBUG/MainProcess] consumer: basic.qos: prefetch_count->16
08:54:38 celeryd.1 | [2013-02-15 08:54:38,126: DEBUG/MainProcess] consumer: Ready to accept tasks!
08:55:08 celeryd.1 | [2013-02-15 08:55:08,184: WARNING/MainProcess] Received and deleted unknown message. Wrong destination?!?
08:55:08 celeryd.1 | The full contents of the message body was: body: 26 (2b) {content_type:u'application/json' content_encoding:u'utf-8' delivery_info:{u'priority': 0, u'routing_key': u'celery', u'exchange': u'celery'}} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T16:19:39.897

问题是双重的：

消息格式错误。[根据@asksol 提供的http://docs.celeryproject.org/en/latest/internals/protocol.html](http://docs.celeryproject.org/en/latest/internals/protocol.html)上的文档，它需要是一本字典，并遵循该页面底部的示例。

*示例消息*

```
{"id": "4cc7438e-afd4-4f8f-a2f3-f46567e7ca77",
 "task": "celery.task.PingTask",
 "args": [],
 "kwargs": {},
 "retries": 0,
 "eta": "2009-11-17T12:30:56.527191"} 
```

**put_message**

```
with Connection(settings.BROKER_URL) as conn:
  queue = conn.SimpleQueue('celery')
  message = {
    'task': 'process-next-task',
    'id': str(uuid.uuid4()),
    'args': [id],
    "kwargs": {},
    "retries": 0,
    "eta": str(datetime.datetime.now())
  }
  queue.put(message)
  queue.close() 
```

Procfile 进程是运行任务的消费者，因此无需在任务中设置消费者。我只需要使用发布消息时发送的参数。

**api/tasks.py**

```
@task(serializer='json', name='process-next-task')
def process_next_task(id):
  try:
    Model.objects.get(id=int(id))
  except Model.DoesNotExist:
    pass
  else:
    # Do stuff here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-02-09T09:58:16.557

**这不是这个问题的解决方案，
而是标记使用 celery4.0.2 中的问题**

输出如：

```
[2017-02-09 17:45:12,136: WARNING/MainProcess] Received and deleted unknown message.  Wrong destination?!?

The full contents of the message body was: body: [[], {}, {u'errbacks': None, u'callbacks': None, u'chord': None, u'chain': None}] (77b)
{content_type:'application/json' content_encoding:'utf-8'
  delivery_info:{'consumer_tag': 'None4', 'redelivered': False, 'routing_key': 'test2', 'delivery_tag': 1L, 'exchange': ''} headers={'\xe5\xca.\xdb\x00\x00\x00\x00\x00': None, 'P&5\x07\x00': None, 'T\nKB\x00\x00\x00': '3f6295b3-c85c-4188-b424-d186da7e2edb', 'N\xfd\x17=\x00\x00': 'gen23043@hy-ts-bf-01', '\xcfb\xddR': 'py', '9*\xa8': None, '\xb7/b\x84\x00\x00\x00': 0, '\xe0\x0b\xfa\x89\x00\x00\x00': None, '\xdfR\xc4x\x00\x00\x00\x00\x00': [None, None], 'T3\x1d ': 'celeryserver.tasks.test', '\xae\xbf': '3f6295b3-c85c-4188-b424-d186da7e2edb', '\x11s\x1f\xd8\x00\x00\x00\x00': '()', 'UL\xa1\xfc\x00\x00\x00\x00\x00\x00': '{}'}} 
```

解决方案： [https ://github.com/celery/celery/issues/3675](https://github.com/celery/celery/issues/3675)

```
# call this command many times, until it says it's not installed
pip uninstall librabbitmq 
```

感谢[https://github.com/ask](https://github.com/ask)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-07T10:41:58.413

显然 librabbitmq 问题与 celery 4.x 中的新默认协议有关。`CELERY_TASK_PROTOCOL = 1`如果您正在使用 Django，您可以通过输入您的设置来切换到以前的协议版本，或者`app.conf.task_protocol = 1`在`celeryconf.py`

然后，您将能够将任务与另一个任务排队。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-07T10:39:43.870

*我的：[芹菜 3.1.25；django=1.11]*

```
ADD celery exchange in settings.py

CELERY_QUEUES = {
   "celery":       {"exchange": "celery",
                    "routing_key": "celery"}
} 
```

**或**由此使用

```
# I declare queue 
ch = settings.CELERY_APP.connection().channel()
ex = Exchange("implicit", channel=ch)
q = Queue(name="implicit", routing_key="implicit", channel=ch, exchange=ex)
q.declare()   # <-- here
producer = ch.Producer(routing_key=q.routing_key, exchange=q.exchange)
# publish
producer.publish("text") 
```

或者你可以使用
kombu docs的第二个版本

```
from kombu import Exchange, Queue
task_queue = Queue('tasks', Exchange('tasks'), routing_key='tasks')

producer.publish(
    {'hello': 'world'},
    retry=True,
    exchange=task_queue.exchange,
    routing_key=task_queue.routing_key,
    declare=[task_queue], # <-- declares exchange, queue and binds.
) 
```

# mysql - 使用随机的 SQL 查询

> ID：14885397
> 
> 赞同：0
> 
> 时间：2013-02-14T22:39:13.607
> 
> 标签：mysql

嗨，有人可以帮我做点什么吗？

我需要一个 mysql 查询，它可以从某个表的列中返回 4 个值，还可以从每一行中选择所有字段。

就像是：

```
SELECT * FROM dadoslivros WHERE RAND() =1 limit 100; 
```

但我只想要随机表单行 ID。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:43:50.513

似乎您只想使用`ORDER BY RAND()`：

```
select *
from dadoslivros
order by rand()
limit 100 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/480be/1)

# javascript - 访问 JSON 的对象值以将它们发送到另一个 servlet 或 jsp

> ID：14885398
> 
> 赞同：1
> 
> 时间：2013-02-14T22:39:12.797
> 
> 标签：javascript, facebook, facebook-graph-api, facebook-javascript-sdk, dom-events

我是使用 Facebook 应用程序环境的新手。我正在开发一个小型应用程序。我正在尝试在我的项目中使用一些社交数据来检查一些条件。我不知道我是否以正确的方式访问 FB 返回的 JSON 对象，但这是我的问题。

我想从当前文件将名字发送到另一个 jsp 或 servlet。因此，我创建了 jsp 变量并尝试在从 Facebook 获得的响应对象中分配“名称”的值。

尝试在 jsp 文件末尾打印名字时，名字输出为空。如何在对象中使用名称和性别值并将其发送到另一个 jsp 文件或 servlet 文件？

敲我的头寻找解决方案。有人请帮忙！

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                       "http://www.w3.org/TR/html4/loose.dtd">

<html>
  <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Facebook authentication usage</title>
  </head>
  <body>

  <%! String firstname="";
        String lastname="";
        String middlename="lynne";

    %>

  <div id="fb-root"></div>
<script>
  window.fbAsyncInit = function() {
                                        // init the FB JS SDK
                                        FB.init({
                                        appId      : '532238706811106', // App ID from the App Dashboard
                                        //channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File for x-domain communication
                                        status     : true, // check the login status upon init?
                                        cookie     : true, // set sessions cookies to allow your server to access the session?
                                        frictionlessRequests : true,
                                        xfbml      : true  // parse XFBML tags on this page?

                                            });

    // Additional initialization code such as adding Event Listeners goes here

    FB.getLoginStatus(function(response) {
                                            if (response.status === 'connected') 
                                            {

                                                // the user is logged in and has authenticated your
                                                // app, and response.authResponse supplies
                                                // the user's ID, a valid access token, a signed        
                                                // request, and the time the access token 
                                                // and signed request each expire   
                                                var uid = response.authResponse.userID;
                                                var accessToken = response.authResponse.accessToken;
                                                 FB.api('/me', function(response) 
                                                            {
                                                                console.log(response); 
                                                                console.log('Good to see you, ' + response.name + '.');
                                                                 firstname=firstname+response.name;
                                                                 lastname=lastname+response.last_name;
                                                                 document.write(response.name+middlename);
                                                            });
                                            } 
                                            else if (response.status === 'not_authorized') 
                                            {
                                                // the user is logged in to Facebook, 
                                                // but has not authenticated your app
                                                var oauth_url = 'https://www.facebook.com/dialog/oauth/';
                                              oauth_url += '?client_id=532238706811106'; //Your Client ID
                                              oauth_url += '&redirect_uri=' + 'https://apps.facebook.com/newjsp'; //Send them here if they're not logged in
                                              //oauth_url += '&scope=user_about_me,email,user_location,user_photos,publish_actions,user_birthday,user_likes';

                                              window.top.location = oauth_url;

                                            } 
                                            else 
                                            {
                                                // the user isn't logged in to Facebook.

                                                window.top.location ='https://www.facebook.com/index.php';
                                            }
                        });

  };
  // Load the SDK's source Asynchronously
  // Note that the debug version is being actively developed and might 
  // contain some type checks that are overly strict. 
  // Please report such bugs using the bugs tool.
  (function(d, debug)
          {
                var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                if (d.getElementById(id)) {return;}
                js = d.createElement('script'); js.id = id; js.async = true;
                js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
                ref.parentNode.insertBefore(js, ref);
            }(document, /*debug*/ false));

</script>
  <h1>this is a sample to test facebook authentication
        Welcome <%=firstname+""+lastname+middlename%></h1>

        <%out.print(firstname+""+lastname+""+middlename); %>

   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T11:15:49.450

这是因为您设置`firstname`为`""`但从不更改该值。

在您的 JavaScript 代码中，`firstname=firstname+response.name;`不设置先前在您的 Java 代码中定义的 String 变量。相反，它设置了一个只能由您的 JavaScript 代码看到的新变量。

您的 Java 代码在服务器端运行，而 JavaScript 在客户端运行。它们是两个完全不同的程序，在完全不同的位置在不同的时间执行。出于诸如此类的原因，不建议在同一个文件中同时编写客户端和服务器端代码。

至于您的问题的解决方案，我建议您为 Facebook 寻找一个 Java API，以便您可以在呈现 JSP 之前使用它，或者您可以仅在 JavaScript 代码中访问从 FB 返回的数据。阅读 Java、JavaScript、服务器端和客户端代码之间的差异可能也是一个好主意。

# ios - iOS：如何在 iCloud 中合并有冲突的 UIDocument？

> ID：14885404
> 
> 赞同：1
> 
> 时间：2013-02-14T22:39:31.813
> 
> 标签：ios, icloud, uidocument

我无法理解合并`UIDocument`存储在 iCloud 中的 2 个或更多冲突版本的选项。在检测到文档冲突后，我目前使用`removeOtherVersionsOfItemAtURL`简单地保留文档数据的最新版本。但是，我想支持合并有冲突的文档。

我发现的唯一资源和教程提到了用于合并的核心数据和持久存储，示例使用了类似的东西`SQLite`，我不使用。就我而言，每个文档都是一个单独的文件。

背景：我的应用程序使用自定义`NSObject`子类（具有相关属性）来存储数据。它们在 a 内进行编码和解码（使用`NSCoding`+ `NSKeyedArchiver/NSKeyedUnarchiver`）`UIDocument`。我已经设置了我的应用程序以完全使用 iCloud。它可以使文件无处不在，反之亦然，编辑和删除它们。

请帮助我了解我可以做些什么来合并冲突`UIDocument's`！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:36:05.037

您将用于`NSFileVersion`获取文件的冲突版本。当您进入冲突状态时，`+unresolvedConflictVersionsOfItemAtURL`将为您`NSFileVersion`提供任何不被视为“当前”的版本的实例。然后，您可以使用 的`URL`属性`NSFileVersion`来获取那些冲突版本的内容。

现在您拥有多个版本的文档。如何解决冲突取决于您——检查冲突的版本并以任何对您的文档结构有意义的方式合并更改。如果您可以在代码中解决它，您可能会从其中一个冲突版本中获取一些数据并将其复制到当前版本中，直到当前版本包含最终合并版本。

完成后，保存文档，删除冲突版本 ( `removeOtherVersionsOfItemAtURL:error:`)，并将当前文件版本标记为已解决。您可能还想用它`removeAndReturnError:`来真正摆脱旧版本。

有关这方面的更多详细信息，请参阅[Apple 解决文档版本冲突的指南](https://developer.apple.com/library/ios/#documentation/DataManagement/Conceptual/DocumentBasedAppPGiOS/ResolveVersionConflicts/ResolveVersionConflicts.html)。

# python - 使用 SQLite 和 Python 量化值（sqlite3 包）

> ID：14885408
> 
> 赞同：0
> 
> 时间：2013-02-14T22:39:52.780
> 
> 标签：python, sqlite

我有一个包含 252 行的表，其中一列的值范围为 0 - 93，并且想要对它们进行分位数。我正在使用 SQLiite、Python 和 sqlite3 python 包来创建和操作这些表。

使用 SQLite 和/或 Python 对值进行分位数的最佳方法是什么？我曾考虑使用 RANK() 但此函数在 SQLite 中不可用。

# asp.net - ASP.NET 附加 QueryString 一旦它具有特定的值

> ID：14885415
> 
> 赞同：0
> 
> 时间：2013-02-14T22:40:15.133
> 
> 标签：asp.net, mobile, query-string

我有一个移动网站和一个普通网站。在移动设备上，它在正常网站上检测到移动设备并重定向到移动网站。我也可以通过添加查询字符串从移动网站返回到普通网站：no_redirect=true

这样 JS 就不会再次执行移动检测代码了。

我的主页只有这个（移动检测），所以当我导航到我正常网站中的其他页面时，QueryString 不再存在。一旦我回到主页，我将再次被重定向到移动站点（没有 QueryString，所以移动检测启动）。

移动网站到普通网站的示例 URL： [http ://www.mysite.com/default.aspx?no_redirect=true](http://www.mysite.com/default.aspx?no_redirect=true)

我正在寻找一种在设置/存在后将 QueryString no_redirect=true 添加到所有页面的方法。这只发生在我从移动网站导航回标准网站时。这将避免我每次访问主页时都需要从移动设备到正常状态来回切换。

有人对此有任何想法或解决方案。

提前谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:07:40.373

感谢您的快速回复！但我让它像这样工作。

也许人们想知道为什么我的主页上只有移动检测？这是因为它是一个响应式网站，但最初我想展示移动网站，因为它在 3G 上加载速度非常快。当然，当有人输入另一个 URL 时，它只会立即显示响应式网站。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)

If Request.QueryString("no_redirect") IsNot Nothing AndAlso Not String.IsNullOrEmpty(Request.QueryString("no_redirect").ToString()) Then
Dim cookie As New HttpCookie("no_redirect")
    cookie.Value = Request.QueryString("no_redirect").ToString()
    cookie.Expires = DateTime.Now.AddMinutes(10)
    Response.Cookies.Add(cookie)
Else
    If Request.Cookies("no_redirect") IsNot Nothing Then
        Response.Redirect("/default.aspx?no_redirect=true")
    End If
End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T06:37:53.667

既然您使用的是 asp.net，为什么不使用 IIS 提供的功能呢？

IIS 有一个 Url Rewrite 模块，非常适合这种情况。

是否要将变量附加到 url，这取决于你，但我强烈建议不要这样做，因为人们倾向于为 url 添加书签并共享这些书签。某人最初共享在不同类型的设备上使用的链接的可能性非常大，并导致糟糕的用户体验。

stackoverflow 中已经有一个问题可以解决您面临的问题。

[带有“nomobile”cookie 的移动设备的 IIS URL 重写规则](https://stackoverflow.com/questions/13182287/iis-url-rewrite-rule-for-mobile-with-nomobile-cookie)

在请求被传递到 ASP.NET 管道之前，规则的处理发生在服务器上，这意味着您不需要“最初”加载任何页面然后重定向。这与您目前提出的解决方案完全相反。

请参阅我链接的问题，如果您真的希望附加查询字符串，只需在 web.config 上将 appendQueryString 属性更改为 true。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:46:20.637

我建议为此使用 Session 变量，而不是尝试修改每个链接。但是，这里有一些可能有帮助的 jquery

```
$(document).ready(function() {
    $('a').each(function(i,o) {
        var href = $(o).attr('href');
        if (href.indexOf('?') > 0) href = href + '&no_redirect=true';
        else href = href + '?no_redirect=true';
        $(o).attr('href', href);
    });
}); 
```

[http://jsfiddle.net/cEKeK/](http://jsfiddle.net/cEKeK/)

# ruby - 如何在 Ruby 程序中创建保留字列表？

> ID：14885418
> 
> 赞同：0
> 
> 时间：2013-02-14T22:40:29.650
> 
> 标签：ruby, reserved-words

我知道我可以在网上浏览这些词，但是有没有办法让 Ruby 为我做呢？你不必给我一个完整的程序，只是一些提示让我去做。提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:58:36.663

好吧，您可以随时查看 ruby​​ 的源代码：[keywords](https://github.com/ruby/ruby/blob/trunk/defs/keywords)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T22:53:39.483

你不能让 Ruby 为你做这件事。

然而，这里是来自 Dave Thomas 的*Programming Ruby 1.9，The Pragmatic Programmers' Guide*（也称为 Pickaxe）的列表：

> `__FILE__`, `__LINE__`, BEGIN, END, alias, and, begin, break, case, class, def, defined?, do, else, elsif, end, ensure, false, for, if, in module, next, nil, not, or,重做、救援、重试、返回、自我、超级、那么、真、undef、除非、直到、何时、而、屈服

# java - 如何获取联系人号码的组 ID (Android)

> ID：14885419
> 
> 赞同：0
> 
> 时间：2013-02-14T22:40:37.407
> 
> 标签：java, android, sql, call, contacts

如何在**知道联系人号码的情况下获取组 ID**

我想它必须是这个里面的另一个查询，但我不知道该怎么做

这是我尝试过的：

```
String[] projection = new String[]{ ContactsContract.Groups._ID };

Cursor cursor = getContentResolver().query(
        ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
        projection,
        ContactsContract.CommonDataKinds.Phone.NUMBER +" = "+ number,
        null,
        null);

cursor.moveToNext();
String id = cursor.getString(cursor.getColumnIndex(ContactsContract.Groups._ID)); 
```

*（查询不返回任何内容）*

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-23T06:38:35.277

`Groups._ID`您的查询不返回任何内容，因为dataset中没有这样的列`CommonDataKinds.Phone`。

尝试这样的事情：

```
String sPhoneNumber = "+48123456789";    
Cursor cursor = getApplicationContext().getContentResolver().query(
                Data.CONTENT_URI, new String[] {CommonDataKinds.GroupMembership._ID}, 
                ContactsContract.CommonDataKinds.Phone.NUMBER+"='"+sPhoneNumber+"'", null, null); 
```

`sPhoneNumber`带有所需电话号码的字符串在哪里。请记住，您的光标仍可能返回 0，具体取决于：

1.  您的电话号码是如何格式化的，即您希望找到给定号码的联系人的组 ID，`+49123456789`而号码的格式是这样的`+49 123 456 789`。空格使这完全不同`String`。
2.  您的联系人不属于任何组。

此外，光标仍然可以返回更多结果，主要是在您的联系人属于多个组的情况下。

# java - 非法密钥大小或默认参数

> ID：14885420
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:40:39.160
> 
> 标签：java, encryption

基本上，我试图将用户指定的字符串散列到一个 256 位字节数组中，以在使用 Java 的 AES256 实现加密数据时用作密钥。我不断收到此运行时异常：

```
java.security.InvalidKeyException: Illegal key size or default parameters 
```

我怀疑这是因为某些字节不是 8 位长，所以整体密钥大小不是 256 位。我想知道如何在左边用 0 填充它们，所以确保密钥的长度？

编辑：

这是从值到消息摘要的转换：

```
MessageDigest hasher = MessageDigest.getInstance("SHA-256");
// Use the factory method to get the SHA-256 instance of a MessageDigest object.
hasher.update(input.getBytes());
// Update the message digest object with the bytes of the value to hash.
return hasher.digest();
// Hash the value and return the string representation. 
```

这是加密，使用“hasher”的输出。

```
SecretKeySpec key = new SecretKeySpec(keyBytes, "AES");
cryptoTool.init(Cipher.ENCRYPT_MODE, key); // This is where the error fires.

return String.valueOf(cryptoTool.doFinal(plaintext.getBytes())); 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T22:47:31.873

我猜也许字符串不是 32 个字符？或者您有一个可能包含非 ASCII 字符的字符串？

以下函数将获取一个字符串并从中生成一个 32 字节的数组。

```
String to32Bytes(String s) {
   return Arrays.copyOf(s.getBytes(), 32);
} 
```

请注意，这不是进行加密的好方法，因为字符串散列算法通常会提供更安全的密钥。

# excel - Excel VBA：读取10行数据，运行条件 循环，打印输出值

> ID：14885421
> 
> 赞同：0
> 
> 时间：2013-02-14T22:40:39.213
> 
> 标签：excel, vba

我正在尝试将值读入子函数，运行条件​​循环，然后在工作表中打印输出值。但是，我遇到了一些问题。在子函数 infiltPrint 中，我似乎无法获取要在单元格中打印的值。

```
Option Explicit

Dim dz() As Double
Dim WC() As Double
Dim fc() As Double
Dim NL, i As Integer

Dim sumdrain As Double
Dim infl As Double

Sub main()
    Call InfiltRead
    Call infilt
    Call Infiltprint
End Sub

Sub InfiltRead()
    Dim dz() As Double
    Dim WC() As Double
    Dim fc() As Double
    Dim NL, i As Integer
    Dim sumdrain As Double
    sumdrain = 0
    Dim infl As Double

'read inputs 
    NL = 10
    infl = Cells(2, 1)

    Application.ScreenUpdating = False
    Worksheets("Sheet1").Activate

    ReDim dz(NL)
    ReDim WC(NL)
    ReDim fc(NL)

    For i = 1 To NL
        dz(i) = Cells(1 + i, 3)
        WC(i) = Cells(1 + i, 7)
        fc(i) = Cells(1 + i, 5)
    Next i    
End Sub

Sub infilt()
    Dim j As Integer
    j = 1
    While (infl > 0) And (j <= NL)
        If infl > (fc(i) - WC(j)) * dz(j) Then
            infl = infl - (fc(i) - WC(j)) * dz(j)
            WC(j) = fc(i)
        Else
            WC(j) = WC(j) + infl / dz(j): infl = 0
        End If
        j = j + 1
    Wend
    If infl > 0 Then
        sumdrain = sumdrain + infl
        infl = 0
    End If
End Sub

Sub Infiltprint()
    Dim col As Double
    Dim rw As Double
    col = 7
    For rw = 2 To 11
        Cells(rw + 1, col).Value = WC()
    Next rw
End Sub 
```

我在“Cells(Row + 1, col) = WC()”行中不断收到类型不匹配

我知道这可能不是我的代码中唯一的错误。坦率地说，我不知道如何从渗透子打印我的值。我试图使用子主...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T04:31:50.247

将打印以下版本的代码。它改变了下面提到的几件事。

您遇到的主要问题是将 WC 数组复制到工作表中。您试图将整个数组分配给单个单元格。

解决方法是将整个 WC 数组分配给您想要放入的全套单元格。为此，必须转置 WC。通常需要将 WC 标注为 Variant（“Dim WC As Variant”）以将数组分配给范围，新代码反映了这一点。

我还清除了一些变量的重新声明，并更改了对三个数组进行索引的方式，以使数组的下限和上限与您的计数器对齐。

在 intfilt() 子程序中，您使用 i 作为循环中的索引，但没有初始化或迭代它，这也发生了变化。

[cpearson.com](http://www.cpearson.com/ "cpearson.com")是一个组织良好且深入的 VBA 编码资源 - 包括使用数组。你可能想检查一下。

```
 Option Explicit

  Dim dz() As Double
  Dim WC As Variant
  Dim fc() As Double
  Dim NL As Long, i As Long       '<- Integer gets converted to Long internally, so do it directly
                                  '<- Way you did it results in Variant type for i
  Dim sumdrain As Double
  Dim infl As Double

  Sub main()
     InfiltRead  <- "Call" not needed
     infilt
     Infiltprint
  End Sub

  Sub InfiltRead() 
     sumdrain = 0   '<- variables in this sub are already declared, don't redeclare
     'read inputs
     NL = 10
     infl = Cells(2, 1).Value
     Application.ScreenUpdating = False ' <- if processing lots of data, would want to turn off auto sheet recalculation as well
     Worksheets("Sheet1").Activate  
     ReDim dz(1 To NL)                    '<- set lower bound to avoid default value of 0
     ReDim WC(1 To NL)        '
     ReDim fc(1 To NL)
     For i = 1 To NL
        dz(i) = Cells(1 + i, 3).Value     '<- could assign each range directy to an array, but this ok
        WC(i) = Cells(1 + i, 7).Value
        fc(i) = Cells(1 + i, 5).Value
     Next i
     Application.ScreenUpdating = True     '<- cleanup code
  End Sub

  Sub infilt()
     Dim j As Long
     i = 1                     '<- DEBUG placeholder - you used i in this sub, but did not initialize or iterate it
     j = 1
     While (infl > 0) And (j <= NL)
        If infl > (fc(i) - WC(j)) * dz(j) Then
           infl = infl - (fc(i) - WC(j)) * dz(j)
           WC(j) = fc(i)
        Else
           WC(j) = WC(j) + infl / dz(j)
           infl = 0
        End If
        j = j + 1
        i = i + 1             '<- DEBUG placeholder iteration
     Wend
     If infl > 0 Then
        sumdrain = sumdrain + infl
        infl = 0
     End If
  End Sub

  Sub Infiltprint()
     Dim col As Long
     Dim rw As Long
     rw = 2
     col = 9                   '<- Changed from 7 to 9 for debugging (so original values would not be overwritten)
     Range(Cells(rw, col), Cells(rw + NL - 1, col)).Value = _
        Application.Transpose(WC)                   '<- needed to get proper references for assignment
  End Sub 
```

# android - 如何在我的 android 项目中使用 htmlunit

> ID：14885422
> 
> 赞同：5
> 
> 时间：2013-02-14T22:40:52.053
> 
> 标签：android, htmlunit

我已经下载了 htmlunit 2.11 zip。我已经提取了它。然后我试图将它们粘贴到我项目的 libs 文件夹中。从 libs 文件夹中，我已将它们添加到构建路径中。然后我在尝试运行我的应用程序时收到此错误

`conversion to dalvik format failed with error 1`

然后，从stackoverflow我发现，一个说删除`xalan` `xercesImpl` `xml-apis`。我删除了它们。但收到此错误：

`Error generating final archive: Found duplicate file for APK: about.html`

错误消息还显示哪些文件有冲突。然后`jetty-http` `jetty-io` `jetty-util` `jetty-websocket`我再次运行我的应用程序。这次它显示了一些警告。我忽略了他们。但我的应用程序崩溃说`classNotFound`

顺便说一句，我也删除了`httpclient`jar。因为有人说`httpclient`已经内置在android中。

这是我的问题。现在，任何人都可以帮助我吗？我真的很想在我的应用程序中使用 htmlunit

**编辑：**

如果您向我展示“如何在我的项目中添加 htmlunit”的步骤，这将非常有帮助

**编辑2：**

主要是我有一个链接，我在登录后获得（我通过网络视图登录）这个链接给了我一个简单的页面。在该页面中有一个文本区域和一个提交按钮。还有一些javascript（我认为这些javascript运行，当我按下提交按钮时）。我可以通过 webview 做到这一点，但由于某种原因我不想使用 webview。当我按下提交按钮时，它会提供 textarea 的值和带有现有 cookie 的隐藏字段的一些值（当我通过 webview 登录时获取） Post 方法。我需要在没有 webview 的情况下执行此操作。现在除了 htmlunit 还有其他选择吗？我听说过 HttpClient、HttpUrlConnection。还有一件事，提交它会将我重定向到另一个页面。我不需要对这个重定向页面做任何事情。

**注意：**如果这个问题不适合我之前真正问的问题，那么你可以建议我，我会发布一个新问题。谢谢你

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-02-04T19:49:34.347

这一切都不起作用，因为他正试图将 HtmlUnit 包含到一个 android 项目中。HtmlUnit 与 android 不兼容，因为它引用了一些在 android 中不可用的 java.* 和 javax.* 类。

希望会有安卓版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-07T22:00:39.363

抱歉，我对 HTMLUNIT 失去了所有希望。:( 为了实现我的目标，我使用了 HttpUrlConnection 和 Jsoup ...这对我有用。[这是我的程序](https://stackoverflow.com/questions/14925061/how-to-get-all-cookies-or-cookies-url-from-android-webkit-cookiemanager/#14927665)，我已经发布了我的代码作为答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T00:27:41.787

以下是要遵循的步骤：

1.  [从http://sourceforge.net/projects/htmlunit/files/htmlunit/2.11/](http://sourceforge.net/projects/htmlunit/files/htmlunit/2.11/)下载最新版本的 HtmlUnit
2.  解压下载的文件
3.  转到 lib 文件夹 --> 右键单击**​​ htmlunit-core-js-2.11.jar**并选择“复制”
4.  转到 Eclicse 中的 Package Explorer --> 选择您的项目 --> 右键单击​​ libs 文件夹并选择“粘贴”
5.  右键单击新添加的文件，然后单击“添加为库...”并选择您的项目。
6.  **对htmlunit-2.11.jar**文件重复步骤 3、4 和 5
7.  将这两个导入添加到您的项目中：

    导入 com.gargoylesoftware.htmlunit.WebClient；

    导入 com.gargoylesoftware.htmlunit.html.HtmlPage；

8.  清理项目。

另请查看此链接[http://www.aviyehuda.com/blog/2011/05/16/htmlunit-a-quick-introduction/](http://www.aviyehuda.com/blog/2011/05/16/htmlunit-a-quick-introduction/)以获取 htmlUnit 快速介绍

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-02T18:58:31.200

我知道现在回答为时已晚，但希望我的回答能帮助像我这样的其他新手，他们试图在他们的 android 应用程序中进行 webscrape 并偶然发现这个线程以在 android studio 中找到 htmlUnit 的工作解决方案。我使用了以前版本的 htmlUnit (2.14)，它对我有用。为什么我要尝试 htmlUnit，而不是 Jsoup ？因为我的目标网页有 javascript 调用，它没有提供完全加载的 html。所以，简而言之：使用以前版本的 htmlUnit。

# javascript - 它是如何计算的？

> ID：14885424
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:41:00.347
> 
> 标签：javascript, jquery

我想知道为什么这个脚本的答案是

```
var h1Array = $('h1').first().text().split(' '),
                        h1Last = h1Array[h1Array.length-1],
                        answerElem = $('#jschl_answer');

                    answerElem.val(22+14*10);
                    answerElem.val(parseInt(answerElem.val())+(h1Last.substr(0,h1Last.length-1)).length); 
```

这个总和是多少？我知道 10*14 = 140 + 22 = 162 但为什么在这种情况下总和是 179

那么我们从哪里得到额外的 17 个呢？

另一个例子

```
var h1Array = $('h1').first().text().split(' '),
                        h1Last = h1Array[h1Array.length-1],
                        answerElem = $('#jschl_answer');

                    answerElem.val(46+36*8);
                    answerElem.val(parseInt(answerElem.val())+(h1Last.substr(0,h1Last.length-1)).length); 
```

sum = 347 而 answerElem.val(46+36*8) 的总和；实际上等于 334 那么我们从哪里得到额外的 13？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:45:53.240

```
answerElem.val(22+14*10); // 162
answerElem.val(
  parseInt(answerElem.val()) + // 162
  (h1Last.substr(0,h1Last.length-1)).length // guess this must be 17
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:46:19.640

它是最后一个标记的长度，由“”标记，

*   从文本值
    *   first() 字段的
        *   名为“h1”的元素

# wordpress - WordPress - 如何在自定义分类术语列表中执行“当前页面项”类？

> ID：14885426
> 
> 赞同：1
> 
> 时间：2013-02-14T22:41:20.027
> 
> 标签：wordpress

我有以下代码生成分类术语中的术语列表，然后在每个术语下生成 POSTS。

我想在当前项目中添加一个 current-page-item 类，这样当您在分类术语下的页面上时，导航中的相关项目会被样式化。这是我的代码：

```
<?php $terms = get_terms('benefit-cats');
        echo "<ul>";
        foreach ($terms as $term) {
            $wpq = array ('taxonomy'=>'benefit-cats','term'=>$term->slug,'order'=>'asc','orderby'=>'title');
            $query = new WP_Query ($wpq);
            echo "<li class=".$term->slug."><span class=\"list-item\"><span class=\"text-arrow\">&#9658;</span> ".$term->name."</span>"; //<a href=\"".get_term_link($term->slug, 'benefit-cats')."\"></a>//
            echo "<ul class=\"children\">";
            ?>

            <?php
if ($query->have_posts() ) : while ($query->have_posts() ) : $query->the_post(); ?>
<li><span class="text-arrow">&#9658;</span> <a href="<?php the_permalink();?>"><?php the_title();?></a></li>
<?php endwhile; endif; wp_reset_query(); ?>

            <?php   
            echo "</ul></li>";
        }
    echo "</ul>";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T02:47:32.490

你可以尝试这样的事情......在你的循环之前指定当前的post_id，然后判断post循环是否包含你的post_id。

```
// before loop
$page_id = $wp_query->get_queried_object_id();

// replace <li><span class="text-arrow">&#9658;</span> 
if($page_id ==$query->post->ID ) $class = " current-page-item";
<li><span class="text-arrow<?php echo $class; ?>">&#9658;</span> 
```

# xcode - xib 中的 appdelegate 对象

> ID：14885435
> 
> 赞同：0
> 
> 时间：2013-02-14T22:42:42.260
> 
> 标签：xcode, uinavigationcontroller, xib

我正在尝试遵循 apple photopicker 示例，该示例在 .xib 文件中有一个 appdelegate 对象。appdelegate 对象如何进入 xib 文件，为什么它很重要？

在我的应用程序中，我想要一个像 photopicker 示例那样的导航控制器。我的测试工作没有包含导航控制器，我很难将导航控制器插入到我的测试工作中，因为它只有一个视图控制器，因为界面构建器似乎已经决定不允许添加。对我来说，最简单的方法是从一个具有导航控制器架构的新应用程序开始，然后添加我的测试工作方法和类的副本。还是没有必要重新开始？我怀疑将 appdelegate 对象插入 xib 将允许我更直接地使用现有测试工作。

**更新 0**

我想我按照您的回答中的说明进行了操作。Xcode 建议`_viewController`，我改变了它。我的应用程序适用于 iPad 和 iPhone（我现在只在 iPad 上工作），所以我认为它有点复杂。我编译得很好，但我的 xib 文件中仍然没有 appdelegate 对象，即使 PhotoPicker 的 xib 文件有一个。

我怀疑我仍然需要连接一些对象，但我也可以使用一些帮助。在 PhotoPicker 中，Navigation Controller 的 Connections Inspector 表示引用 Outlet 在`navController`and之间`AppDelegate`，而 AppDelegate 的 Connections Inspector 表示 Reference Outlet 在`delegate`and之间`File's Owner`。但是因为我的 xib 文件没有 (BS)AppDelegate 对象，所以我不知道如何连接没有它。

```
@interface BSAppDelegate ()
@property (nonatomic, retain) IBOutlet UINavigationController *navigationController;
@end

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.viewController = [[BSViewController alloc] initWithNibName:@"BSViewController_iPhone" bundle:nil];
    } else {
        self.viewController = [[BSViewController alloc] initWithNibName:@"BSViewController_iPad" bundle:nil];
    }
    UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:_viewController];
    self.window.rootViewController = navigationController;

    [self.window makeKeyAndVisible];
    return YES;
} 
```

**更新 0**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:24:16.650

在 (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions 中，您可以像这样添加 uinavigationcontroller：

```
UIViewController *viewController = … //load your first view controller with the initial xib here
UINavigationController *navigationController = [[UINavigationController alloc] initWithRootViewController:viewController];
self.window.rootViewController = navigationController; 
```

# c++ - 如何解释 32 位浮点 wav 数据

> ID：14885436
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:42:56.510
> 
> 标签：c++, c, floating-point, wav

如何解释 32 位浮点 wav 数据？我将 wav 数据读取为 I32，然后将其除以 2^31，但没有得到正确的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:48:18.440

值是浮动的。您必须将它们分配给浮点值并按原样使用它们。如果您将浮点值读入 int32 值，则相当于进行了 reinterpret_cast。

```
float f1 = 1.0e5;
int   i1 = *reinterpret_cast<int*>( &f1 );
// i1 = 1203982336, not 100000 
```

如果你无法避免得到错误的值，那么为了得到“正确”的值，你需要反向重新解释

```
float f2 = *reinterpret_cast<float*>( &i1 );
// f2 = 1.0e5 
```

数据的字节顺序可能仍需要调整。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:03:01.877

查看您的[RIFF 标头](https://ccrma.stanford.edu/courses/422/projects/WaveFormat/)。这将告诉您 Wav 文件的字节顺序。

使用该字节序正确读取 32 位浮点数。例如：如果您的系统是 little endian（例如，基于 x86 处理器）并且您的 wav 文件是 big endian（例如，在旧的 PPC mac 上创建），您需要在阅读后进行[32 位 endian 交换](https://stackoverflow.com/questions/2182002/convert-big-endian-to-little-endian-in-c-without-using-provided-func)在数据中，以便您的浮点变量实际上包含有意义的数据（这通常是 -1.0f 和 1.0f 之间的值）

# c++ - 我可以从静态 const char* 数组中定义以下宏“取消字符串化”吗？

> ID：14885438
> 
> 赞同：0
> 
> 时间：2013-02-14T22:43:03.993
> 
> 标签：c++, c, boost, macros, c-preprocessor

我在一个`.c`文件中有以下内容（这是一个小得多的数组来举例说明）：

```
static const char* __someNames[] =
{
    "Fox",
    "Wulf",
    "Cat"
}; 
```

后来我定义了一个这样的宏：

```
#define EXAMPLE(N) XXX 
```

我希望在`__someNames[N]`没有`"`..ie的情况下替换 XXX

```
#define EXAMPLE(1) 
```

扩大到：

```
Wulf 
```

我该怎么办？

**编辑**

一些很酷的想法。这更多是出于求知欲，我想这样做。我喜欢 #include "file.h# 两次使用重新定义的宏的想法。如果我也可以使用 boost 预处理器（我添加了 c++ 和 boost 标签来提问）会怎样——我是否能够绕过额外的“file.h”？每个字符串都有一个#define 的那个也很酷，虽然考虑到我会有多少个#define，但想法稍微少一些......

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T22:51:28.163

我认为您的 X 问题的解决方案（您曾询问 Y 解决方案）是扭转局面并使用宏将字符串放入，然后使用重新定义的相同宏来执行您想做的任何其他事情.

例如：

```
#define EXAMPLE(x)   #x,

static const char* __someNames[] =
{

#include "file.h"
};

#undef EXAMPLE
#define EXAMPLE(x)   x,

enum animals 
{
#include "file.h"
}; 
```

其中 file.h 包含：

```
EXAMPLE(Fox)
EXAMPLE(Wulf)
EXAMPLE(Cat) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T22:49:11.730

使用标准 C 或 C++ 预处理器无法做到这一点。

预处理器扫描您的代码中的标识符，如果标识符与宏匹配，它会扩展宏。在这种情况下，扩展宏实际上是数组名称，后跟括号中的输入数字。

这是预处理器工作方式的限制！

解决方法是这样的......

```
#define EXAMPLE_1  Wolf
#define EXAMPLE_2  Dog
#define EXAMPLE_3  Cat

#define EXAMPLE_X(n) EXAMPLE_##n

// Then say 

EXAMPLE_X(1); // will put Wolf;

int EXAMPLE_X(2) = 0;// expands to int Dog = 0; 
```

不幸的是，只有当你传入诸如`1`or之类的常量时才有效`2`……变量不起作用。

或者 ...

```
static const char* __someNames[] =
{
    #define __someNames_1 Fox
    "Fox",
    #define __someNames_2 Wulf
    "Wulf",
    #define __someNames_3 Cat
    "Cat"
};    

#define EXAMPLE_X(n) __someNames_##n 
```

这将按照您期望的方式工作并保持相同的方案，但它会为大数组放置很多定义！

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-14T22:46:24.803

```
 #define EXAMPLE(_x)  __someNames[(_x)] 
```

# asp.net-mvc - Orchard CMS 1.5 中的媒体花园（MediaGarden 模块）错误

> ID：14885445
> 
> 赞同：1
> 
> 时间：2013-02-14T22:43:57.857
> 
> 标签：asp.net-mvc, orchardcms

我在跑步`Orchard 1.5`。我安装`Media Garden module`并收到此错误：

> 无法为模块“MediaGarden”加载程序集引用“Downplay.Mechanics”。

我在安装 Media Garden 时确实检查了安装依赖模块，所以它实际上安装了 Origami。然后我去发现`Mechanics 0.9.0`（它已安装`Origami 0.9.0`）并且我也手动安装了它。

我仍然收到无法找到 Mechanics 的错误。有人可以建议我如何解决此问题或为视频库推荐另一种方法吗？理想情况下，我想将 flowplayer 用于视频库。

如果您有一种方法可以为没有模块的视频设置单独的页面，这也将有助于了解。

谢谢！

# c++ - C++“列表迭代器不可取消引用”错误

> ID：14885446
> 
> 赞同：1
> 
> 时间：2013-02-14T22:44:03.400
> 
> 标签：c++, stl, visual-studio-2012, iterator

我正在尝试编写将链表中的字符串按字母顺序排列的代码。这是我写的：

```
void main() {
list<string> myList;
list<string>::iterator pos;

string newData;
myList.push_back("Anna");

pos = myList.begin();

for (int i = 0; i < 5; i++){
    cin >> newData;
    while(newData > *pos)
        pos++;

    myList.insert(pos, newData);
}

system("pause");
} 
```

这段代码编译得很好，但我得到一个错误，当我运行它时列表迭代器不可取消引用。

我对链表和迭代器很陌生，所以我真的不知道如何解决它。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:49:24.853

问题出在这个循环中：

```
while(newData > *pos)
    pos++; 
```

根据您的输入，您可能会不断增加`pos`，直到到达列表末尾。此时，在检查`while`循环条件时取消引用它会导致**Undefined Behavior**。

要修复您的程序，请按如下方式重写您的循环：

```
while ((pos != myList.end()) && (newData > *pos))
{
    pos++;
} 
```

PS：另请注意，如果您的意图是以逆字典顺序插入项目（看起来是这样），您很可能希望将`pos = myList.begin();`语句移动到循环内。`for`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:49:40.637

```
while(newData > *pos)
    pos++; 
```

当 时`pos++`，它可能指向`list::end()`并取消引用它`*pos`是**未定义的行为。**

无论如何，您的列表都没有排序，只能 list::push_back

```
for (int i = 0; i < 5; i++){
    cin >> newData;
    myList.push_back(newData);
} 
```

然后稍后对其进行排序：

```
 myList.sort(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:48:10.307

在执行`pos++`时，您可能会到达列表的末尾，即`pos == myList.end()`。

在这一点上，进一步`*pos`或是`pos++`非法的。

需要修改循环逻辑以避免此类非法指令。

# .net - 在 F# 中的 Vector2 上重载相等运算符 ("=") - 不同的向量被报告为相等

> ID：14885448
> 
> 赞同：3
> 
> 时间：2013-02-14T22:44:08.917
> 
> 标签：.net, f#, xna, operator-overloading

[由于重载](http://msdn.microsoft.com/en-us/library/bb199663.aspx)，使用数学运算符适用于 XNA Vector2s，例如：

```
new Vector2(1.0f, 2.0f) + new Vector2(2.0f, 3.0f) // {X:3 Y:5} 
```

（非常便利）

但是看看这个：

```
// Okay, this works fine.
new Vector2(1.0f, 2.0f) = new Vector2(1.0f, 2.0f) // true
// Is it checking for type equality?
new Vector2(1.0f, 2.0f) = new Vector2(6.0f, 5.0f) // true 
```

那么为什么它不调用 Vector2 上的重载`op_Equality`（对于`op_Inequality`）？如果直接调用，它们会按预期工作。

PS：如果它很重要，我认为它不重要，我在 Mono 和 Monogame 下运行它。

PPS：这主要是烦人，我不能使用`=`，但如果我真的需要，我*可以使用 Vector2.Equals。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:13:55.887

看起来 MonoGame 程序集的不同版本之间肯定存在一些差异，因为当我`WindowsGL`在 F# Interactive 中的 Windows（使用版本）上运行代码时，我得到了预期的结果：

```
> #r @"C:\Program Files (x86)\MonoGame\v3.0\Assemblies\WindowsGL\MonoGame.Framework.dll" 
  open Microsoft.Xna.Framework;;

> new Vector2(1.0f, 2.0f) = new Vector2(1.0f, 2.0f);;
val it : bool = true
> new Vector2(1.0f, 2.0f) = new Vector2(6.0f, 5.0f);;
val it : bool = false 
```

我还尝试引用`Linux`目录中的程序集（尽管我在 Windows 上这样做了）并且它也可以工作，所以发生了一些奇怪的事情。您使用的是哪个平台？您可以尝试仅在 F# 交互中运行上述脚本来测试它是否在您的应用程序之外工作？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:05:18.350

F# 相等运算符不能被覆盖，但对于非 F# 类型，它应该等效于使用非静态`Equals`方法（如[规范中的伪代码所述](http://research.microsoft.com/en-us/um/cambridge/projects/fsharp/manual/spec.html#_Toc335818970)）。也许你的例子中还有其他事情发生？

# jquery - 根据字数Jquery设置字体大小

> ID：14885452
> 
> 赞同：4
> 
> 时间：2013-02-14T22:44:39.210
> 
> 标签：jquery, fonts, resize

我有多篇文章，但它们都需要放在同一个空间中。字符限制为 140 个。我要做的是根据段落中的字符调整字体大小。因此，如果该段落的字符较少，我希望字体大小变大，反之亦然。

我下面的代码似乎不起作用，想知道是否有人可以帮助我？

目前发生的事情，似乎是最后一个，因为所有段落的字体大小都是 8em :(

非常感谢任何帮助和提前感谢！

这是代码：

```
 $(function(){
    var $quote = $(".question p");
    var $numWords = $quote.text().split("").length;     
    if (($numWords >= 1) && ($numWords < 20)) {
        $quote.css("font-size", "2.2em");
    }
    else if (($numWords >= 20) && ($numWords < 60)) {
        $quote.css("font-size", "1.8em");
    }
    else if (($numWords >= 60) && ($numWords < 100)) {
        $quote.css("font-size", "1.2em");
    }
    else if (($numWords >= 100) && ($numWords < 140)) {
        $quote.css("font-size", "0.9em");
    }
    else {
        $quote.css("font-size", "0.8em");
    }           
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T22:55:02.863

您的问题是您没有单独处理每个段落：请参阅[http://jsfiddle.net/wkEMK/1/](http://jsfiddle.net/wkEMK/1/)

```
$(function(){
    $(".question p").each(function () {
        var numChars = $(this).text().length;     
        if ((numChars >= 1) && (numChars < 20)) {
            $(this).css("font-size", "2.2em");
        }
        else if ((numChars >= 20) && (numChars < 60)) {
            $(this).css("font-size", "1.8em");
        }
        else if ((numChars >= 60) && (numChars < 100)) {
            $(this).css("font-size", "1.2em");
        }
        else if ((numChars >= 100) && (numChars < 140)) {
            $(this).css("font-size", "0.9em");
        }
        else {
            $(this).css("font-size", "0.8em");
        }           
    });
}); 
```

您的原始代码正在获取与“.question p”匹配的所有段落的字符数。例如，如果你有两个段落，一个有 10 个字符，另一个有 20 个字符，你的 JS 将运行一次，总共有 30 个字符，而不是依次处理每个段落。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T22:58:18.963

使用[.css](http://api.jquery.com/css/)函数这样做。这样它将根据每个 p 元素内的字符数更改每个 p 元素的字体大小

```
$(function(){         
    $(".question p").css('font-size',function(){
        var $numWords = $(this).text().length; // get length of text for current p element
        if (($numWords >= 1) && ($numWords < 20)) {
            return "2.2em";
        }
        else if (($numWords >= 20) && ($numWords < 60)) {
            return "1.8em";
        }
        else if (($numWords >= 60) && ($numWords < 100)) {
            return "1.2em";
        }
        else if (($numWords >= 100) && ($numWords < 140)) {
            return "0.9em";
        }
        else {
            return "0.8em";
        }           
    });    
}); 
```

[小提琴](http://jsfiddle.net/AHMXf/)

# python - 从调用 python 脚本的 bash 脚本返回

> ID：14885453
> 
> 赞同：2
> 
> 时间：2013-02-14T22:44:52.883
> 
> 标签：python, bash

我有一个`Controller.sh`调用 python 脚本 () 的 bash 脚本 ( `MyDaemon.py`)。后者接受一个参数和一个命令，并且可以像这样从命令行调用：

```
/usr/bin/python /opt/stuff/MyDaemon.py -p Blue start 
```

或者

```
/usr/bin/python /opt/stuff/MyDaemon.py -p Blue stop 
```

或者

```
/usr/bin/python /opt/stuff/MyDaemon.py -p Blue status 
```

我正在尝试`Controller.sh`调用`MyDaemon.py`然后以状态退出。python 脚本应该被启动并`Controller.sh`返回。这是我的`Controller.sh`代码：

```
COLOR=$1
COMMAND=$2

DIRNAME=`dirname $0`
RESULT="/tmp/$COLOR.$COMMAND.result"

# remove any old console output
rm -f $RESULT 2>/dev/null

#start with CPU affinity for anything other than CPU 0.
sudo taskset -c 1-8 /usr/bin/python /opt/stuff/MyDaemon.py -p $COLOR $COMMMAND</dev/null >$RESULT 2>&1

STATUS=$?

# print output
cat $RESULT

# check on success
if [ $STATUS -ne 0 ]
then
        echo "ERROR: $COLOR $COMMAND failed"
        exit 1
fi 
```

现在，如果我在命令行上调用`Controller.sh blue start`它会启动 python 脚本，但`Controller.sh`不会返回状态。另一方面，如果我运行以下命令，它会返回：

```
[nford@myserver]# sudo taskset -c 1-8 /usr/bin/python /opt/stuff/MyDaemon.py -p blue start</dev/null >/tmp/blah.log 2>&1
Started with pid 1326
[nford@myserver]# 
```

我不得不得出结论，bash 脚本有一些东西阻止它返回。

应该注意的`MyDaemon.py`是fork进程，这就是我需要重定向输出的原因。还应该注意的是，我从另一个与 php 脚本执行类似操作的脚本中提取了大部分内容；我对某些含义很模糊（例如`STATUS=$?`）。也就是说，即使我在`sudo taskset`调用行之后删除了所有内容，它仍然无法干净地返回。如何让 bash 脚本正确执行此命令？

后记：我有点困惑这个问题如何“太具体”并且被否决/投票结束。试图变得一清二楚；我试图了解分叉进程脚本在命令行上下文中与 bash 脚本的运行方式之间的差异。我在上面提供了一个具体的例子，但这是一个普遍的概念。

更新：当我使用 运行脚本时，这会导致结果`bash -x`，进一步表明它`sudo taskset`在线上死掉了。它离开`start`命令的事实令人困惑。

```
[nford@myserver]# bash -x Controller.sh Blue start
+ COLOR=Blue
+ COMMAND=start
++ dirname Controller.sh
+ DIRNAME=.
+ RESULT=/tmp/Blue.start.result
+ rm -f /tmp/Blue.start.result
+ sudo taskset -c 1-8 /usr/bin/python /opt/stuff/MyDaemon.py -p Blue 
```

更新： `bash -x`揭示问题：`start`命令没有被传递：变量名中的拼写错误会产生静默 bash 错误。外卖：`bash -x`用于调试！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:49:47.327

由于您的拼写错误-您应该`set -u`在脚本的顶部使用它，它可以挽救生命，并且可以避免不眠之夜以及消除头发的拉扯。

`set -u`会给你...

```
myscript.sh: line 11: COMMMAND: unbound variable 
```

`bash -u myscript.sh arg1 arg2`请记住，您也可以像这样运行脚本`-x`，它们都有助于跟踪脚本问题。

# php - 将匿名函数绑定到 PHP 中的现有函数

> ID：14885454
> 
> 赞同：2
> 
> 时间：2013-02-14T22:44:55.310
> 
> 标签：php, anonymous-function

有没有办法将现有函数绑定到 php 中的匿名函数？就像是

```
$my_func = strip_tags(); 
```

或者我必须用适当的参数和返回值将它重新定义为一种匿名包装器吗？

我试着用谷歌搜索这个，但我想我没有正确地找到正确的搜索短语，因为我没有在第一页找到结果。

**编辑**我正在制作一种函数管道（？），我可以在其中传递数据和函数，并且我想将函数作为变量传递。我想保持语法相同并且能够使用`$output = $function($data)`而不必为本地函数编写一堆匿名包装。另外我想避免使用`call_user_func`，所以我不必重新编写我现有的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T01:50:51.560

简单的。

```
$my_func = 'strip_tags';
$output = $my_func($data); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T22:47:59.170

您可以通过函数的名称绑定函数。看看来自 php的[可调用接口](http://php.net/manual/en/language.types.callable.php)

上述手册中的代码

```
<?php 

// An example callback function
function my_callback_function() {
    echo 'hello world!';
}

// An example callback method
class MyClass {
    static function myCallbackMethod() {
        echo 'Hello World!';
    }
}

// Type 1: Simple callback
call_user_func('my_callback_function'); 

// Type 2: Static class method call
call_user_func(array('MyClass', 'myCallbackMethod')); 

// Type 3: Object method call
$obj = new MyClass();
call_user_func(array($obj, 'myCallbackMethod'));

// Type 4: Static class method call (As of PHP 5.2.3)
call_user_func('MyClass::myCallbackMethod');

// Type 5: Relative static class method call (As of PHP 5.3.0)
class A {
    public static function who() {
        echo "A\n";
    }
}

class B extends A {
    public static function who() {
        echo "B\n";
    }
}

call_user_func(array('B', 'parent::who')); // A
?> 
```

# android - 无法读取钛加速器中 null 的属性长度

> ID：14885460
> 
> 赞同：0
> 
> 时间：2013-02-14T22:45:26.447
> 
> 标签：android, titanium

我正在使用钛检索 json 数据。但问题是，每当我计算 json 数据的长度时，它说无法读取 null 的长度这是我的代码：

```
 Ti.UI.setBackgroundColor('#000');

 var win1 = Ti.UI.createWindow({
backgroundColor : '#fff',
title : 'Tab 1'
 });
var tab1 = Ti.UI.createTab({
icon : 'KS_nav_views.png',
title : 'Tab 1',
window : win1
 });

var JsonTable = Ti.UI.createTableView({
height : Ti.UI.FILL,
width : Ti.UI.FILL
});
win1.add(JsonTable);

 function getData() {
var myfontsize = '14dp';
// I needed to add this to test
var tableData = [];
var Json, Story;
var xhr = Ti.Network.createHTTPClient({
    onload : function() {
        var json = JSON.parse(this.responseText);
        // declare your variables :-)
        //alert(JSON.stringify(Story));
    //  alert(Story.nombre);
        alert(json.length);
        // only one . between things
        for (var i = 0; i < json.length; i++) {
            Story = json[i];
            //Ti.API.info('Story', JSON.stringify(Story));
            //Ti.API.info('Story.nombre', Story.nombre);
            var row = Ti.UI.createTableViewRow({
                backgroundColor : 'yellow',
                height : '85dp',
                width : Ti.UI.FILL
            });
            var labTitle = Ti.UI.createLabel({
                backgroundColor : 'orange',
                color : 'black',
                font : {
                    fontSize : myfontsize,
                    fontWeight : 'bold'
                },
                height : Ti.UI.SIZE,
                left : '25%',
                text : Story.nombre,
                top : '2%',
                width : Ti.UI.FILL
            });

            row.add(labTitle);
            tableData.push(row);
        }
        JsonTable.setData(tableData);
    },
    onerror : function(e) {
        Ti.API.debug("STATUS: " + this.status);
        Ti.API.debug("TEXT: " + this.responseText);
        Ti.API.debug("ERROR: " + e.error);
        alert('There was an error retrieving the remote data. Try again.');
    },
    timeout : 5000
});
JsonTable.addEventListener('click', function(e) {
    var index = e.index;
});
xhr.open("GET", "http://aplicaciones4.sct.gob.mx/sibuac_internet/SerEscogeRuta?estados");
xhr.send();
  }

 var btnGo = Ti.UI.createButton({
title : 'Go'
 });
 btnGo.addEventListener('click', function(e) {
getData();
  });
  //win1.setRightNavButton(btnGo);
win1.add(btnGo);

var img = Ti.UI.createImageView({
height : 32,
image : 'activity_indicator.gif',
width : 32
});
//win1.add(img);

 var tabGroup = Ti.UI.createTabGroup();
 tabGroup.addTab(tab1);
 tabGroup.open(); 
```

你能帮我吗

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:30:49.053

尝试将结果命名为“json”以外的名称。

此外，还有草率的 var 声明......

“var Json，故事；” << "J"son 大写，从未使用过

# html - TD 高度 = 包含的 div 的总高度？

> ID：14885471
> 
> 赞同：1
> 
> 时间：2013-02-14T22:46:17.563
> 
> 标签：html, css, position

我不敢相信我在这里或谷歌上找不到这个问题——这似乎是一个我不好意思问的愚蠢问题，但是今天早上它让我发疯了……

想象一下用这样的 div 制作的单列堆叠条形图看起来有点像温度计：

```
<div id="thermo">
  <div id="thermored"></div>
  <div id="thermogreen"></div>
</div> 
```

#thermo 是包含的 div，#thermored 是全高背景，#thermogreen 是将更改以反映数据的叠加层 - 在现实世界中，它显示任务的完成百分比。

就目前而言，它有效。但是，它需要在表格单元格内工作（不是我的选择 - 这是对 CMS 的系统限制）。问题是包含 TD 的高度是（尽管尝试固定高度）两个 div 的总和，即使它们相对定位并重叠。

这是当前的 css - 它并不漂亮，因为在过去的几个小时里我一直在尝试这么多的定位组合

```
#thermo{
    width:140px;
    height:500px;
    position:relative;
}
#thermored{
    width:50px;
    height:100%;
    margin-left: 20px;
    background-color: red;
}
#thermogreen{
    width:50px;
    height:280px;
    margin-left: 20px;
    background-color: green;
    position:relative;
    bottom: 280px;
    float:left;
} 
```

*编辑有关信息，我遇到的问题是在 Chrome 和 FF 中 - IE(8) 按照我想要的方式设置 TD 高度

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:49:42.053

我认为您遇到的问题来自于`relative`定位使元素保持正常流动的事实。您是否尝试过设置`position: absolute;`内部`thermogreen`div？绝对定位使元素脱离正常流动，因此`td`标签只会考虑您的`thermo`div 的高度，该高度设置为 500px。（编辑：您实际上可以`thermored`不使用 position 属性离开。它设置为 div 高度的 100% `thermo`，这意味着无论您`td`的高度是 500px，并且您不必担心 CSS）。

看看我想出的 jsfiddle：http: [//jsfiddle.net/dgRCu/3/](http://jsfiddle.net/dgRCu/3/)

这能解决您的问题吗？似乎`td`一直保持在 500 像素高度，而不是现在扩展到 700+。

我不确定这些 div 的预期用途是什么，所以我`bottom: 0;`在`thermogreen`div 上进行了设置，因为看起来你想要的是绿色条在高度上扩展，而红色条是背景色。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:56:39.547

TD 单元格将折叠/展开到“最高”高度的大小。在单元格中使用 css 会导致不同的浏览器或特别是电子邮件阅读器出现不同的问题。

所以，你已经尝试过：

```
<tr>
<td height="500"></td>
</tr> 
```

然后，把那些块元素放在那里？使表格的第一个 td 单元格的高度超过两个 div 的总和。

您正在浮动一个，因此最大的应该强制高度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:51:28.207

您是否使用过 IE 中的开发工具来查看表格单元格是如何呈现的？您是否有机会仅使用 html 表和 css 代码制作 jsfiddle.net？

# javascript - 如何使背景图像在缩放时保持不变？

> ID：14885473
> 
> 赞同：3
> 
> 时间：2013-02-14T22:46:19.367
> 
> 标签：javascript, jquery, html, css, background-image

就像当有人放大网页时，它会保留为原始图像（如果可以的话，最好在 CSS 中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:53:28.057

我在身体上设置了一个背景图像，并使用`background-size: 100%`它来填充屏幕。这将完成您正在尝试做的事情。我不确定除了身体之外的任何元素都会有一个好的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T13:12:53.267

**试试这个**：

```
background-size: cover;      
background-attachment: fixed; 
```

[此链接](http://www.netmagazine.com/tutorials/take-advantage-css-background-size-property)上的其他功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:04:32.093

我认为这需要 javascript，因为您需要弄清楚视口本身有多大...每当该视口发生更改时，css 无法检测到...这就是 javascript 的来源。您应该查看 javascript /jquery 调整浏览器事件大小。[jQuery 通过http://api.jquery.com/resize/](http://api.jquery.com/resize/)上的一些示例很好地实现了这一点，您应该可以很容易地使用它们。

他们给出的示例是在调整窗口大小时添加正文的新宽度......这与缩放窗口时的触发器相同。

看看这个[jsfiddle](http://jsfiddle.net/nbatothemax/5acyN/26/)。我所做的是首先插入新视口的宽度。然后我还重新调整了框的宽度和高度，使其相对于视口的 1/5。

神奇的代码是：

```
$(window).resize(function() {
    $('#log').append('<div>' + $(this).width() + '</div>');
}); 
```

宽度的变化是：

```
if (logWidth == width/3) {
    console.log("hooray.");
}
else {
    console.log("resize the log please.");
    logWidth = width/3;
    $('#log').width(logWidth);
} 
```

可以根据您的背景图像需要修改此 if else 语句。

这给了我新的宽度，我可以用它来设置背景图像/宽度/任何我想要的任何调整大小事件的元素。

# android - 清单文件中的问题

> ID：14885476
> 
> 赞同：1
> 
> 时间：2013-02-14T22:46:30.050
> 
> 标签：android, exception, android-manifest, syntax-error

我正在使用 novoda 项目来使用 jar gps 定位器（[https://github.com/novoda/Novocation](https://github.com/novoda/Novocation)），所以我继续在清单文件上收到相同的错误 - “属性缺少 android 命名空间前缀”，无法弄清楚为什么，想法？这是一个非常糟糕的事情，因为通过文档和示例应用程序，我真的可以使用他的 gps 定位器......

这是我的清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
  package="com.mappermate"
  android:versionCode="1"
  android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="13" />
<!-- Permissions -->
<uses-permission android:name="android.permission.INTERNET" >
</uses-permission>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" >
</uses-permission>
<uses-permission android:name="android.permission.CALL_PHONE" >
</uses-permission>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" >
</uses-permission>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" >
</uses-permission>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" >
</uses-permission>
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

<application
    android:name="com.mappermate.application.MappermateApp"
    android:icon="@drawable/ic_launcher"
    android:theme="@android:style/Theme.NoTitleBar.Fullscreen" >
    <uses-library android:name="com.google.android.maps" />

    <!-- Uploader Activity -->
    <activity android:name="com.mappermate.ui.phone.UploaderActivity" >
    </activity>

    <!-- Login Activity -->
    <activity android:name="com.mappermate.ui.phone.LoginActivity" />

    <!-- Register Activity -->
    <activity android:name="com.mappermate.ui.phone.RegisterActivity" />

    <!-- Authentication Activity -->
    <activity android:name="com.mappermate.ui.phone.AuthenticationActivity" />

    <!-- Exit Activity -->
    <activity android:name="com.mappermate.ui.phone.ExitActivity" />

    <!-- Main Menu Activity -->
    <activity android:name="com.mappermate.ui.phone.Delete_MainMenuActivity" />

    <!-- Preferences Activity -->
    <activity
        android:name="com.mappermate.ui.phone.PreferencesActivity"
        android:theme="@style/PreferencesTheme" >
    </activity>

    <!-- My Location Activity -->
    <activity
        android:name="com.mappermate.ui.phone.MapperMateScreen"
        android:screenOrientation="portrait" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

    <receiver android:name="com.novoda.location.receiver.ActiveLocationChanged" >
        <intent-filter>
            <action android:name="com.novoda.location.ACTIVE_LOCATION_UPDATE_ACTION" />
        </intent-filter>
    </receiver>
    <receiver android:name="com.novoda.location.receiver.PassiveLocationChanged" />
    <receiver
        android:name="com.novoda.location.receiver.RestorePassiveListenerOnRestoredConnectivity"
        enabled="false" >
        <intent-filter>
            <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
        </intent-filter>
    </receiver>
    <receiver android:name="com.novoda.location.receiver.StopPassiveLocationUpdatesOnLowBattery" >
        <intent-filter>
            <action android:name="android.intent.action.BATTERY_LOW" />
            <action android:name="android.intent.action.BATTERY_OKAY" />
        </intent-filter>
    </receiver>
    <receiver android:name="com.novoda.location.receiver.RestorePassiveListenerBoot" >
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
        </intent-filter>
    </receiver>
</application> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:00:03.833

我能看到的错误是

```
enabled="false" 
```

需要是

```
android:enabled="false" 
```

此外，您需要添加

```
</manifest> 
```

在清单的末尾。

# mysql - MySQL 存储函数 SELECT INTO 意外结果

> ID：14885480
> 
> 赞同：1
> 
> 时间：2013-02-14T22:46:47.613
> 
> 标签：mysql

我正在尝试在 mysql 5.1 中编写一个存储函数，该函数返回给定房间的值“AccountIDref”。如果我只查询内部的 SELECT 语句，这可行（返回房间的值）。但是调用该函数我得到了响应：

'#1172 - 结果包含多于一行'

```
CREATE FUNCTION getAccountId (room INT) RETURNS INT
BEGIN
    DECLARE refID INT DEFAULT NULL;
    SELECT AccountIDref INTO refID FROM Allocation
    WHERE Room = room;
    RETURN refID;
END 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T07:12:59.023

字段名称和参数名称必须不同 -

```
CREATE FUNCTION getAccountId (room_param INT) RETURNS INT
BEGIN
    DECLARE refID INT DEFAULT NULL;
    SELECT AccountIDref INTO refID FROM Allocation
    WHERE Room = room_param;
    RETURN refID;
END 
```

在您的函数中，您将获取所有表记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:09:54.277

我要建议的内容与您所拥有的内容不会有太大不同，但是我对`where`下一行中的子句持怀疑态度，并且让我们使用它`limit 1`来明确设置限制。

尝试这个 ：

```
CREATE FUNCTION getAccountId (room INT) RETURNS INT
BEGIN
    DECLARE refID INT DEFAULT NULL;
    SELECT AccountIDref INTO refID FROM Allocation WHERE Room = room LIMIT 1;
    RETURN refID;
END 
```

# c++ - 如何突出显示 QTextEdit 中的一串文本

> ID：14885481
> 
> 赞同：6
> 
> 时间：2013-02-14T22:46:49.367
> 
> 标签：c++, qt, stylesheet, qstring, qtextedit

我是一名学生程序员，目前正在使用 Qt4 开发一个工作应用程序。我正在构建一个方程式编辑器，但在尝试突出显示[QTextEdit](http://doc.qt.digia.com/stable/qtextedit.html)字段中的字符串时遇到问题。我有一个函数可以解析 QTextEdit 字符串并返回错误所在位置的开始和结束整数。我最初的策略是在这两点使用 HTML 标签来突出显示错误。不幸的是，html 标记和公式语法似乎存在问题。

我认为我需要的是一种依靠 Qt 库在这两个索引之间设置背景颜色的策略。我开始寻找[QSyntaxHighlighter](http://qt-project.org/doc/qt-4.8/qsyntaxhighlighter.html)；但是我认为这更多地是为了使用一组预定义的法律来突出显示，而不是仅仅为了抓住 a & b 之间的任何东西并设置背景颜色。如果我可以使用语法荧光笔，请为我提供示例或参考，因为我已经阅读了文档并且没有找到任何内容。

提前感谢您的帮助！

PS只是强调html兼容性问题；由于使用了多个 < 和 > 符号，因此 html 变得有问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-15T06:18:05.783

你可以使用`QTextCursor`它`QTextCharFormat`：

```
QTextEdit *edit = new QTextEdit;
...
int begin = ...
int end = ...
...

QTextCharFormat fmt;
fmt.setBackground(Qt::yellow);

QTextCursor cursor(edit->document());
cursor.setPosition(begin, QTextCursor::MoveAnchor);
cursor.setPosition(end, QTextCursor::KeepAnchor);
cursor.setCharFormat(fmt); 
```

# jquery - 使用 jquery 忽略 JSON 调用中的部分键

> ID：14885482
> 
> 赞同：5
> 
> 时间：2013-02-14T22:46:57.070
> 
> 标签：jquery, json

我目前正在用 json 填充一些元素。但是，如果加载了新的 json。json 看起来略有不同。我怎样才能忽略密钥的第一部分以便它工作。我在想我可以使用星号，但这给了我在萤火虫中的错误。

这是我的 jQuery

```
var items = [];
    $.each(data[0].attributes['*.dyn.prop.current.profile'], function (key, val) {
        items.push(val);
    });
    displaySortLabel(items, "type-details"); 
```

示例 JSON 1

```
[
   {
    "avatarDefinitionId":1,
    "avatarName":"edge",
    "attributes":{
       "examplePrefixToSkipOver.act.halt":"1",
       "examplePrefixToSkipOver.dyn.prop.current.profile":"1",
       "examplePrefixToSkipOver.dyn.prop.firmware":"1.0",
       "examplePrefixToSkipOver.dyn.prop.ip.address.3g":"192.168.1.1",
       "examplePrefixToSkipOver.dyn.prop.ip.address.cloud.com":"192.168.1.1",
       "examplePrefixToSkipOver.dyn.prop.ip.address.lan":"10.0.0.1",
       "examplePrefixToSkipOver.dyn.prop.ip.address.wifi":"192.168.1.1",
       "examplePrefixToSkipOver.dyn.prop.location":"Chicago Office",
       "examplePrefixToSkipOver.dyn.prop.name":"examplePrefixToSkipOver",
       "examplePrefixToSkipOver.dyn.prop.priority":"1",
       "examplePrefixToSkipOver.dyn.prop.status.detail":"Placeholder-Text",
       "examplePrefixToSkipOver.dyn.prop.timestamp":"2010-01-01T12:00:00Z"

   }
 }
 ] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T23:03:36.210

您可以使用`for`循环：

```
for ( key in data[0].attributes ) {
    if (key.match('.dyn.prop.firmware')) {
       items.push(data[0].attributes[key]);
    }
} 
```

[http://jsfiddle.net/cSF5w/](http://jsfiddle.net/cSF5w/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:48:05.697

对象假设：

```
var my1 = [{
    "attributes": {
        "edgebox.act.halt": "1",
            "edgebox.dyn.prop.current.profile": "1",
            "edgebox.dyn.prop.firmware": "1.0"
    }
}];
var my2 = [{
    "attributes": {
        "qln220.act.halt": "1",
            "qln220.dyn.prop.current.profile": "1",
            "qln220.dyn.prop.firmware": "1.0"
    }
}];

var items = [];

function pdata(data) {
    $.each(data, function (key, val) {
        items.push({mykey:val});
    });
}
pdata(my1[0].attributes);
pdata(my2[0].attributes);
alert(items[2].mykey);//alerts "1.0", 
```

在这个例子中，数组中有 6 个对象

编辑：使用相同的对象但保留键：

```
var items = [];

function pdata(data) {
    $.each(data, function (key, val) {
        items.push({mykey:val,origkey:key});
    });
}
pdata(my1[0].attributes);
pdata(my2[0].attributes);
alert(items[2].mykey+ ":"+items[2].origkey);// alerts "1.0:edgebox.dyn.prop.firmware" 
```

EDIT2：剥离第一部分：

```
function pdata(data) {
    $.each(data, function (key, val) {
        items.push({
            mykey: val,
            origkey:(key.substring(key.indexOf(".")+1))
        });
    });
} 
```

取悦您的小提琴：http: [//jsfiddle.net/ThXHd/1/](http://jsfiddle.net/ThXHd/1/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-26T04:12:57.853

```
var items = [];
for (key in data[0].attributes) {
    if (key.match('.stat.prop.type')) {
        items.push(data[0].attributes[key])
    }
}

displaySortLabel(items, "type-details"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T23:35:00.473

由于我无法在较早的答案中添加评论。您可以使函数通用。像这样：

```
function getAttributesArray(obj, matchKey) {
   var items = [];
   for ( key in obj ) {
      if (key.match(matchKey)) {
          items.push(obj[key]);
      }
   }
   return items;
}

var label = getAttributesArray(data[0].attributes, '.dyn.prop.firmware')

displaySortLabel(label, "type-details"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-22T16:48:43.567

如果您只想删除键的第一部分，您可以在 '.' 的第一个索引之后对键进行切片。并使用修改后的值映射到您的模型。

`var newKey = key.slice(key.indexOf('.') + 1)`

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-01T22:29:01.943

以 Bonnarooster 的示例为基础：

```
function getAttribute(attr, item) {
    var items = [];
    $.each(item.attributes, function (key, val) {
        if (key.slice(key.indexOf('.') + 1) == attr) 
            items.push(val);
    });
    return items;
}; 
```

现在您可以致电：

```
getAttribute('dyn.prop.current.profile', data[0]); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-03T17:25:05.337

不幸的是，我还不能对答案发表评论，但@undefined 的想法完全正确（尽管它应该检查它是否只匹配属性名称的结尾）。这是您将其放入函数中的方法。

要获取单个属性：

```
function getOneWithSuffix(obj,suffix){
    for(var key in obj){
        if(key.substr(key.length-suffix.length)===suffix){
            return obj[key];
        }
    }
    return undefined;
}
// usage: myValue = getOneWithSuffix( data[0].attributes, '.dyn.prop.current.profile' ) 
```

或者获取所有匹配属性值的数组：

```
function getManyWithSuffix(obj,suffix){
    var ret=[];
    for(var key in obj){
        if(key.substr(key.length-suffix.length)===suffix){
            ret.push(obj[key]);
        }
    }
    return ret;
}
// usage: myValuesArray = getManyWithSuffix( data[0].attributes, '.dyn.prop.current.profile' ) 
```

如果您想要更大的灵活性，也可以在匹配中使用正则表达式。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-03-04T14:51:56.557

查看其他一些答案，我认为您需要一些“复制和粘贴”解决方案。

这就是我所拥有的。

```
$.each(data[0].attributes, function(key, val){
     if(key.substr(key.indexOf('.',1)+1) === 'dyn.prop.current.profile')
         items.push(val);
}); 
```

我刚刚把一些人已经回答的内容放在了这个小提琴中，希望它有效：D

[http://jsfiddle.net/n3jca/1/](http://jsfiddle.net/n3jca/1/)

# xml - 使用 XSLT 从 Xpath 查询创建无序列表

> ID：14885483
> 
> 赞同：0
> 
> 时间：2013-02-14T22:46:57.633
> 
> 标签：xml, xslt, xpath

当它是一个直接的 XPath 查询时，我可以在 XSLT 中创建一个列表，但是当我想创建一个 name = something 的所有子元素的列表时，我无法让它工作。这是我的 XML：

```
<?xml version="1.0" encoding="UTF-8"?>

<flights
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="flights.xsd">

<flight flightid="1">
    <flightno>EK98</flightno>
    <callsign>UAE98</callsign>
    <airline>Emirates Airline</airline>

    <plane planeid="1">
        <name>Airbus</name>
        <registereddate>07-06-10</registereddate>
    </plane>

    <registration>3A6-EDJ</registration>
    <altitude height="feet">41000</altitude>
    <speed ratio="mph">564</speed>
    <distance unit="miles">erf</distance>

    <route>
    <routename>FCO-DXB</routename>
        <from>
            <iatacode>FCO</iatacode>
            <airport>Fiumicino</airport>
            <country>Italy</country>
            <city>Rome</city>
            <latitude>41.8044</latitude>
            <longitude>12.2508</longitude>
        </from>

        <to>
            <iatacode>DXB</iatacode>
            <airport>Dubai Intl</airport>
            <country>UAE</country>
            <city>Dubai</city>
            <latitude>25.2528</latitude>
            <longitude>55.3644</longitude>
        </to>
    </route>

    <course bearing="degrees">154</course>

    <journey>
        <distance type="miles">2,697</distance> 
        <time>PT5H30M</time>
    </journey>

</flight> 
```

当它等于空客时，我想创建一个包含飞机/名称节点的子元素文本的无序列表。这是我在 XSLT 文件中的尝试：

```
<?xml version="1.0"?>
<xsl:stylesheet version="1.0"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="html" omit-xml-declaration="yes" />

<xsl:template match="/">
    <xsl:element name="html">
        <xsl:element name="head">
            <xsl:element name="title">flights</xsl:element>
        </xsl:element>

        <xsl:element name="body"> 
            <xsl:element name="ul">
                <xsl:attribute name="style">
                    <xsl:text>width:100px; margin:0 auto; padding: 0;</xsl:text>
                </xsl:attribute>
                <xsl:apply-templates select="flights/flight/plane[name='Airbus']"> 

            </xsl:element>
        </xsl:element>
    </xsl:element>

</xsl:template>

<xsl:template match="name">
    <xsl:element name="li">
        <xsl:attribute name="style">
            <xsl:text>list-style-type:none; width:100px; margin:0 auto;</xsl:text>
        </xsl:attribute>

    <xsl:value-of select="name" />

    </xsl:element>
</xsl:template>

</xsl:stylesheet> 
```

所以结果会是这样的：

```
Name: Airbus
Registered Date: 07-06-10 
```

有人可以告诉我我哪里出错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:57:33.943

首先，您应该了解什么是“文字结果元素”和“属性值模板”。它们将使您的 XSLT 代码更加简洁。

回答您的问题：您的代码不起作用，因为您调用`apply-templates`了一个`plane`元素但有一个模板匹配`name`元素。尝试匹配`plane`元素的模板：

```
<xsl:template match="/">
    <html>
        <head>
            <title>flights</title>
        </head>

        <body>
            <ul style="width:100px; margin:0 auto; padding: 0;">
                <xsl:apply-templates select="flights/flight/plane[name='Airbus']"/> 
            </ul>
        </body>
    </html>
</xsl:template>

<xsl:template match="plane">
    <li style="list-style-type:none; width:100px; margin:0 auto;">
        <xsl:value-of select="name"/>
    </li>
</xsl:template> 
```

# css - Bootstrap Div 高度随内容大小而变化

> ID：14885484
> 
> 赞同：2
> 
> 时间：2013-02-14T22:47:21.053
> 
> 标签：css, html, twitter-bootstrap, positioning

我正在尝试使用 Twitter Bootstrap 创建一个网站，它基本上是一个位于背景容器 div 顶部的垂直居中的单个列（因此我可以对边缘的背景进行着色/图像处理）。

我一直遇到这个问题，我可以让背景 div 填充输入屏幕，但是居中的列 div 将其高度设置为内容的大小。我希望它始终至少与屏幕尺寸一样高。我以为 min-height 会这样做，但事实并非如此。

这是它现在的样子：（它只是一个布局的测试页面）

![在此处输入图像描述](../Images/58fb2b44d4c652ef507f21883f8042ec.png)

这是它的代码：

HTML

```
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Baileysaurus -- Dinosaurs &amp;&amp; Logic in your face!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
    <LINK href="header.css" rel="stylesheet" type="text/css">
    <LINK href="forum.css" rel="stylesheet" type="text/css">
    <!-- jQuery (Bootstrap requires jQuery!) -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <!-- Bootstrap -->
    <LINK href="/bootstrap/css/bootstrap.min.css" rel="stylesheet"
        media="screen">

        <!-- A file of PHP utility functions -->
        <?php
            include 'functions.php';
        ?>
</head>
<body>
    <!-- Bootstrap -->
    <script src="bootstrap/js/bootstrap.min.js"></script>

    <div id='background' class='row-fluid'>
        <div class='span12'>
            <div id='site-column' class='row-fluid span10 offset1 column-wrap'>

                           <img src="/PipeDog.jpg" alt="ARGUMENT INVALID" />

                       <hr>

                       <p>
                        Put a blog here!
                       </p>

            </div> <!-- END of outermost span12 div -->
        </div> <!-- END - "site-column" div --> 
    </div>  <!-- END - "background" div -->

</body>

</html> 
```

CSS

```
html, body
{
    height: 100%;
    margin: 0;
}

#background
{
    position: absolute;
    top:0;
    bottom: 0;
    min-height: 100%;
    min-width: 100%;
    background-color: Gainsboro;
}

#site-column
{
    top: 0;
    bottom: 0;
    min-height: 100%;
    border-left: 2px solid;
    border-right: 2px solid;
    background-color: white;
}
.column-wrap
{
    overflow: hidden;
} 
```

我试图让那张照片中的白色栏至少伸展到屏幕底部，即使内容不是那么长。有人对我缺少的东西有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:54:36.037

尝试使您的外部`<div>`扩展到页面底部。

所以在css中试试这个：

```
.row-fluid
{
position:absolute;    
bottom:0;
} 
```

我不确定，但你可能需要移动你的

```
<script src="bootstrap/js/bootstrap.min.js"></script> 
```

行到`<head>`页面的一部分。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:04:49.320

您还应该能够添加以下 CSS：

```
.span12 {
   height:100%;
} 
```

# c++ - 显示简单 Oracle 查询字符串时出现“访问冲突”错误（VS10 Exp C++）

> ID：14885487
> 
> 赞同：1
> 
> 时间：2013-02-14T22:47:35.320
> 
> 标签：c++, oracle, database-connection, resultset, occi

我正在努力解决有关使用 occi 通过 C++ 向 Oracle 数据库运行 SQL 语句的问题。我的代码如下：

```
#include <iostream>
#include "occi.h"

namespace oc = oracle::occi;

int main() {
    std::cout << "Setting up environment...\n";
    oc::Environment * env = oc::Environment::createEnvironment();

    std::cout << "Setting up connection...\n";
    oc::Connection * conn = env->createConnection("user","pass","server");

    std::cout << "Creating statement...\n";
    //Very simply query... 
    oc::Statement * stmt = conn->createStatement("SELECT '1' FROM dual");

    std::cout << "Executing query...\n";
    oc::ResultSet * rs = stmt->executeQuery();

    while(rs->next()) {
            std::cout << rs->getString(1) << std::endl; //Error is thrown at this line, but after printing since I can see '1' on the console.
    }

    stmt->closeResultSet(rs);
    conn->terminateStatement(stmt);
    env->terminateConnection(conn);
    oc::Environment::terminateEnvironment(env);

    return 0;
} 
```

显示的错误是：

> MyDatabaseApp.exe 中 0x1048ad7a (msvcp100d.dll) 处的未处理异常：0xC0000005：访问冲突读取位置 0xccccccd0。

我的程序在以下代码行的“xstring”内停止：

```
 #if _ITERATOR_DEBUG_LEVEL == 0

    ....

    #else /* _ITERATOR_DEBUG_LEVEL == 0 */
    typedef typename _Alloc::template rebind<_Elem>::other _Alty;

    _String_val(_Alty _Al = _Alty())
            : _Alval(_Al)
            {   // construct allocator from _Al
            ....
            }

    ~_String_val()
            {   // destroy the object
            typename _Alloc::template rebind<_Container_proxy>::other
                    _Alproxy(_Alval);  

            this->_Orphan_all(); //<----------------------Code stops here

            _Dest_val(_Alproxy, this->_Myproxy);
            _Alproxy.deallocate(this->_Myproxy, 1);
            this->_Myproxy = 0;
            }
    #endif /* _ITERATOR_DEBUG_LEVEL == 0 */ 
```

如果我将查询更改为：

```
oc::Statement * stmt = conn->createStatement("SELECT 1 FROM dual"); 
```

和循环语句：

```
std::cout << rs->getInt(1) << std::endl; 
```

它工作正常，没有错误。我认为这是因为获取整数只是返回一个原语，但是当一个对象被返回时它会爆炸（我认为是析构函数，但我不确定为什么......）

我今天已经玩了几个小时了，我很困惑。

关于我的系统的一些信息：

*   操作系统 - Windows XP
*   甲骨文版 - 10g
*   IDE - Microsoft Visual Studio 2010 Express C++

我的项目属性如下：

*   C/C++ - 常规 - 附加包含目录 = C:\oracle\product\10.2.0\client_1\oci\include;%(AdditionalIncludeDirectories)
*   C/C++ - 代码生成 - 多线程调试 DLL (/MDd)
*   链接器 - 常规 - 附加库目录 = C:\oracle\product\10.2.0\client_1\oci\lib\msvc\vc8;%(AdditionalLibraryDirectories)
*   链接 - 输入 - 附加依赖项 = oraocci10.lib;oraocci10d.lib;%(AdditionalDependencies)

我希望我没有对太多信息感到困惑......任何帮助或见解都会很棒，在此先感谢！

**编辑**如果我重写循环，将值存储在局部变量中，则在循环结束时抛出错误：

```
while(rs->next()) {
    std::string s = rs->getString(1); //s is equal to "1" as expected
    std::cout << s << std::endl; //This is executed successfully
} //Error is thrown here 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-02T11:40:23.497

通常此类问题来自最终用户和提供者的构建环境（IDE）的差异。

检查[这个](http://support.microsoft.com/kb/168958)。

相关问题：

*   [0x523d14cf (msvcr100d.dll) 处未处理的异常？](https://stackoverflow.com/questions/4241882/unhandled-exception-at-0x523d14cf-msvcr100d-dll)
*   [为什么这个程序会崩溃：在 DLL 之间传递 std::string](https://stackoverflow.com/questions/2322095/why-does-this-program-crash-passing-of-stdstring-between-dlls)

首先尝试使用正确的 lib 和 dll。如果在调试模式下编译，那么所有的库和 dll 都必须是调试的。使用 VC++ Modules 视图确保加载了正确的 DLL。

我很幸运我的应用程序为 MSVC2010 编译了所有库。所以我只是检查调试和发布模式 DLL 并得到工作应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-07-02T14:59:21.927

大约一个月前我重新审视了这个问题，发现 MSVC2010 occi 库是为 Oracle 11g 构建的。我们正在运行 Oracle 10g，所以我不得不使用 MSVC2005 库。所以我安装了过时的 IDE 并加载了 Debug 库并且它工作了（由于某种原因，发布版本不起作用）。

**编辑**

对于遇到相同问题的任何人，如果使用适当的库将 IDE 从 MSVC2010 降级到 MSVC2005 不起作用，您可以尝试将 Oracle 客户端从 10g 升级到 11g 并使用 MSVC2010 库，如 harvyS 所建议的那样。回想起来，这可能是更好的解决方案。

# ruby-on-rails - Rails 3.2.x 路由被调用两次

> ID：14885488
> 
> 赞同：1
> 
> 时间：2013-02-14T22:47:38.563
> 
> 标签：ruby-on-rails, ruby

我有一个奇怪的问题，任何获取请求都被调用了两次。这是日志输出

第一次通话

```
Started GET "/admin/dashboard" for 127.0.0.1 at 2013-02-14 17:42:33 -0500
Processing by Admin::DashboardController#index as HTML 
```

紧接着第二个电话

```
Started GET "/admin/dashboard" for 127.0.0.1 at 2013-02-14 17:42:34 -0500
Processing by Admin::DashboardController#index as */* 
```

这是我的路线输出

```
 admin_dashboard_index GET    /admin/dashboard(.:format)                       admin/dashboard#index
                           POST   /admin/dashboard(.:format)                       admin/dashboard#create
       new_admin_dashboard GET    /admin/dashboard/new(.:format)                   admin/dashboard#new
      edit_admin_dashboard GET    /admin/dashboard/:id/edit(.:format)              admin/dashboard#edit
           admin_dashboard GET    /admin/dashboard/:id(.:format)                   admin/dashboard#show
                           PUT    /admin/dashboard/:id(.:format)                   admin/dashboard#update
                           DELETE /admin/dashboard/:id(.:format)                   admin/dashboard#destroy 
```

还有我的 routes.rb

```
 namespace :admin do
    resources :pages do
      member do
        get 'visual'
      end
    end
    resources :dashboard, :posts, :help
  end 
```

这是正常的吗？它发生在开发和产品中，因此每个 GET 调用也在进行数据库查询。

更新：添加控制器输出

这是我的管理员/dashboard_controller

```
class Admin::DashboardController < AdminController
  def index
    @authentications = current_user.authentications
    @has_facebook = @authentications.find_by_provider(:facebook)
    if @has_facebook
      @fb_me = FbGraph::User.me(@has_facebook.token)
      @fb_me.fetch
    end
  end 
```

还有我的 admin_controller

```
class AdminController < ApplicationController
  before_filter :authenticate_user!
  layout "admin/layouts/application"
end

end 
```

还有我的application_controller：

```
class ApplicationController < ActionController::Base
  before_filter :set_locale
  before_filter :set_company
  before_filter :subdomain_view_path

  protect_from_forgery

  prepend_view_path "app/views/admin"
  rescue_from CanCan::AccessDenied do |exception|
    redirect_to root_path, :alert => exception.message
  end

  rescue_from ActiveRecord::RecordNotFound do |exception|
    redirect_to root_path, :alert => exception.message
  end

  def set_locale
    I18n.locale = I18n.default_locale
  end

  def set_company
    if current_user
      @current_account = current_user.company
      return
    end
    if request.subdomain.present? and request.subdomain != 'www'
      @current_account = Company.find_by_subdomain(request.subdomain)
    else
      if request.domain.present?
        @current_account = Company.find_by_subdomain(request.domain.split('.')[0])
      end
    end
    if not @current_account
      @current_account = Company.find_by_subdomain('default')
    end
  end

  def subdomain_view_path
    if request.subdomain.present? and request.subdomain != 'www'
      prepend_view_path "app/views/#{request.subdomain}_subdomain"
    else
      if request.domain.present?
        prepend_view_path "app/views/#{request.domain.split('.')[0]}_subdomain"
      else
        prepend_view_path "app/views/default_subdomain"
      end
    end
  end

  def check_addon_product
    if @current_account.addons.find_by_title('products')
      return true
    else
      redirect_to root_path, :alert => "Products addon not enabled for this account."
    end
  end

end 
```

我怀疑我在 application_controller 中做错了什么。

更新 2：

所以我尝试了三种不同的方法，除了谷歌浏览器之外的所有方法都发出了一次请求。我不知道这是否是一个已知问题，但感谢评论者为我指明了正确的方向。

更新 3：

发现这个相关的错误[http://code.google.com/p/chromium/issues/detail?id=39402](http://code.google.com/p/chromium/issues/detail?id=39402)

除了提供网站图标之外，还有其他方法吗？

# java - IntelliJ12 中的模块依赖项不适用于包

> ID：14885496
> 
> 赞同：1
> 
> 时间：2013-02-14T22:47:52.600
> 
> 标签：java, intellij-idea

我有一个在 Intellij (Java) 中工作的基本客户端/服务器/通用项目。我试图用谷歌搜索这个问题，虽然人们似乎有同样的问题，或者类似的问题，但我还没有找到一个可行的解决方案。

server、client 和 common 都是各自的模块。我已经为客户端和服务器设置了对 Common 模块的模块依赖项。

![项目结构](../Images/0539c90fc44fcd8dca22ccf57c242e16.png)

在不与任何包关联且位于 src 根目录的 RunServer 类中，我可以使用也不与任何包关联且位于 src 根目录中的坐标。但是我不能为播放器使用坐标，因为播放器嵌套在一个包中。

为什么会这样？如果将 Common 模块指定为另一个模块的依赖项，我是否应该能够使用它？有谁知道解决这个问题？

谢谢

# php - PHP分页链接增量

> ID：14885503
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:48:21.633
> 
> 标签：php, pagination

基本上我想限制在我的页面上显示的数字数量，但目前它显示 31 个数字，因为它们是 31 页的结果，我想显示 5 个链接并在每页后增加，

以下是它们当前的显示方式

`[1] [2] [3] [4] [5] [6] [7] [8] etc..`

这就是我想要的

`[1] [2] [3] [4] [5]`

我想要什么，但是一旦您选择例如数字 8，它就会将该数字放在中间，并在两侧放置 2 个链接，例如这样

```
[6] [7] [8] [9] [10] 
```

这是我正在使用的当前代码

```
function showPageNumbers($totalrows,$page,$limit){  
    $query_string = $this->queryString();   
    $pagination_links = null;       
    $numofpages = $totalrows / $limit;      
    for($i = 1; $i <= $numofpages; $i++){               
      if($i == $page){
            $pagination_links .= '<li class="active"><a href="#">'.$i.'</a></li>';
        }else{ 
            $pagination_links .= '<li><a href="?page='.$i.'&'.$query_string.'" title="go to page '.$i.'">'.$i.'</a></li>'; 
        }
    }

    if(($totalrows % $limit) != 0){          
        if($i == $page){
            $pagination_links .= '<li class="active"><a href="#">'.$i.'</a></li>';
        }else{
            $pagination_links .= '<li><a href="?page='.$i.'&'.$query_string.'" title="go to page '.$i.'">'.$i.'</a></li>';
        }
    }   
    return $pagination_links;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:17:46.460

您可以修改功能，例如：

```
function showPageNumbers($totalrows, $page, $limit){

    $query_string = $this->queryString();
    $pagination_links = null;
    $numofpages = $totalrows / $limit;

    $linksPerPage = 5;

    $firstNum = $page - round(($linksPerPage)/2);
    if($firstNum < 1) 
        $firstNum =1;

    $lastNum = $firstNum + $linksPerPage -1;
    if($lastNum > $numofpages)
         $lastNum = $numofpages;

    for($i = $firstNum; $i <= $lastNum; $i++){
        if($i == $page){
            $pagination_links .= '<li class="active"><a href="#">'.$i.'</a></li>';
        }else{
            $pagination_links .= '<li><a href="?page='.$i.'&'.$query_string.'" title="go to page '.$i.'">'.$i.'</a></li>';
        }
    }

    return $pagination_links;
} 
```

# php - php函数中的混合数组（文本和字符串）

> ID：14885508
> 
> 赞同：0
> 
> 时间：2013-02-14T22:48:48.797
> 
> 标签：php, arrays, string, function, text

我试图掌握 php （相当不成功）。我一直对定义和调用函数的语法感到困惑

我写的代码是

```
$alpha = array(1, "alpha");
$beta = array(2, "beta");

function find_best_provider($provider1, $provider2){
    if($provider1 > $provider2){
        return array($provider1[0], $provider1[1]);
    }
    else {
        return array($provider2[0], $provider2[1]);
    }
}

$winner = find_best_provider($alpha, $beta);
echo $winner; 
```

**但我不断收到此通知 -** 注意：第 17 行数组 /Applications/MAMP/htdocs/find_best_provier_func.php 中的数组到字符串转换

我知道问题是什么，但我不太确定如何解决它，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:51:11.403

如果您尝试评估数组中的第一个元素，请尝试以下操作：

```
function find_best_provider($provider1, $provider2)
{
    if($provider1[0] > $provider2[0])
    {
        return array($provider1[0], $provider1[1]);
    }
    else 
    {
        return array($provider2[0], $provider2[1]);
    }
} 
```

# c++ - 打印机端口设置

> ID：14885510
> 
> 赞同：0
> 
> 时间：2013-02-14T22:48:58.497
> 
> 标签：c++, printing, marshalling

需要在 XPS 打印机上设置端口。我在 Stackoverflow 上找到了一些示例，但它不起作用。这是一个代码（很多垃圾）：

```
 LPTSTR pDeviceName = _T("Microsoft XPS Document Writer");
    HANDLE phPrinter(nullptr);
    PRINTER_DEFAULTS defaults;
    defaults.DesiredAccess = PRINTER_ACCESS_USE;
    defaults.pDatatype = 0;

    PORT_INFO_3 pInfo3;;

    DWORD needed;
    DWORD XcvResult;

    DWORD err = OpenPrinter(pDeviceName,&phPrinter,NULL);
    //const BYTE* portValue = reinterpret_cast<const BYTE*>("TestPort");
    PBYTE port = (PBYTE)_T("Test1");

    if(err) {
        int res =    XcvData(phPrinter,_T("AddPort"),port,sizeof(port),NULL,0,&needed,&XcvResult);
                }
    else {
        AfxMessageBox(_T("ERROR."),MB_OK);
    }
    ClosePrinter(phPrinter); 
```

最有趣的是这段代码只工作了一次（XcvData func 的第一次启动）！

另一个相同行为的例子：

```
 BOOL AddPortX(void)
    {
        DWORD cbneed,cbstate;
        PBYTE pOutputData;
        HANDLE hXcv = INVALID_HANDLE_VALUE;
        PRINTER_DEFAULTS Defaults = { NULL,NULL,SERVER_ACCESS_ADMINISTER };     

        WCHAR pszPortName[]=L"UTReportPDFPort:"; 
        pOutputData=(PBYTE)malloc(MAX_PATH);

        if(!OpenPrinter(_T("Microsoft XPS Document Writer"),&hXcv,NULL ))
        {
            LPVOID lpMsgBuf; 
            GetLastError();
            FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,
                NULL, GetLastError(), NULL,(LPTSTR) &lpMsgBuf, 0, NULL );
            ::MessageBox(NULL,(LPCTSTR)lpMsgBuf,_T("ERROR"),MB_OK|MB_ICONINFORMATION);
            free(pOutputData);
            LocalFree( lpMsgBuf );
            return FALSE;

        }
// False
        if(!XcvData(hXcv,L"AddPort",(PBYTE)pszPortName,sizeof(pszPortName),(PBYTE)pOutputData,MAX_PATH,&cbneed,&cbstate))
        {
            LPVOID lpMsgBuf; 
            SetLastError(cbstate);
            FormatMessage(FORMAT_MESSAGE_ALLOCATE_BUFFER | FORMAT_MESSAGE_FROM_SYSTEM | FORMAT_MESSAGE_IGNORE_INSERTS,
                NULL, GetLastError(), NULL,(LPTSTR) &lpMsgBuf, 0, NULL ); 
            ::MessageBox(NULL,(LPCTSTR)lpMsgBuf,_T("ERROR"),MB_OK|MB_ICONINFORMATION);       
            LocalFree( lpMsgBuf ); 
            free(pOutputData);
        }

        free(pOutputData);
        ClosePrinter(hXcv);

        return TRUE;

    } 
```

那么，如何设置正确的添加打印机端口，并在添加后自动选择呢？也许，有人知道为什么它只工作一次？我的意思是 - XcvData 函数。下一次它返回错误代码 6。.NET 解决方案也很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T17:05:43.993

```
 public static class Winspool
{
    [StructLayout(LayoutKind.Sequential)]
    private class PRINTER_DEFAULTS
    {
        public string pDatatype;
        public IntPtr pDevMode;
        public int DesiredAccess;
    }

    [DllImport("winspool.drv", EntryPoint = "XcvDataW", SetLastError = true)]
    private static extern bool XcvData(
        IntPtr hXcv,
        [MarshalAs(UnmanagedType.LPWStr)] string pszDataName,
        IntPtr pInputData,
        uint cbInputData,
        IntPtr pOutputData,
        uint cbOutputData,
        out uint pcbOutputNeeded,
        out uint pwdStatus);

    [DllImport("winspool.drv", EntryPoint = "OpenPrinterA", SetLastError = true)]
    private static extern int OpenPrinter(
        string pPrinterName,
        ref IntPtr phPrinter,
        PRINTER_DEFAULTS pDefault);

    [DllImport("winspool.drv", EntryPoint = "ClosePrinter")]
    private static extern int ClosePrinter(IntPtr hPrinter);

    public static int AddLocalPort(string portName)
    {
        PRINTER_DEFAULTS def = new PRINTER_DEFAULTS();

        def.pDatatype = null;
        def.pDevMode = IntPtr.Zero;
        def.DesiredAccess = 1; //Server Access Administer

        IntPtr hPrinter = IntPtr.Zero;

        int n = OpenPrinter(",XcvMonitor Local Port", ref hPrinter, def);
        if (n == 0)
            return Marshal.GetLastWin32Error();

        if (!portName.EndsWith("\0"))
            portName += "\0"; // Must be a null terminated string

        // Must get the size in bytes. Rememeber .NET strings are formed by 2-byte characters
        uint size = (uint)(portName.Length * 2);

        // Alloc memory in HGlobal to set the portName
        IntPtr portPtr = Marshal.AllocHGlobal((int)size);
        Marshal.Copy(portName.ToCharArray(), 0, portPtr, portName.Length);

        uint needed; // Not that needed in fact...
        uint xcvResult; // Will receive de result here

        XcvData(hPrinter, "AddPort", portPtr, size, IntPtr.Zero, 0, out needed, out xcvResult);

        ClosePrinter(hPrinter);
        Marshal.FreeHGlobal(portPtr);

        return (int)xcvResult;
    }
} 
```

[资源来自 CodeProject](http://www.codeproject.com/Tips/92982/Adding-a-Local-Port-through-XcvData-and-C)

OpenPrinter() 中的第一个参数必须是 - XcvMonitor 本地端口。我们可以使用 .NET 管理对象来选择默认端口。

# sql-server - T-SQL 写入文件 txt 或 csv

> ID：14885521
> 
> 赞同：6
> 
> 时间：2013-02-14T22:49:50.737
> 
> 标签：sql-server, tsql, file-io, ole, bcp

我花了一整天的时间在网上搜索答案。显然 tsql 没有自己漂亮的写入文件命令。这是我的困境

我有一个正在创建的加载文件，其中单行的长度可以达到 10K+。在 SQL Server varchar(MAX) 上，限制为 8000（所以我相信），所以我将这些行分成几个变量。我尝试进行 PRINT，但窗口窗格允许 4000。解决方法是一次打印一个变量的那些虚线，但这对于体力劳动来说可能会很乏味，所以我选择考虑将它写入一个 txt 文件中的一个变量时间。

我通过 xpcommandshell 查看了 BCP，它看起来很有希望。问题是我可以让这一行在命令提示符下工作，但完全相同的行在 TSQL 查询中不起作用：

```
declare @cmd varchar(8000)
select @cmd = 'bcp Client_DB "Select name from dbo.t_TagBuild_set" queryout "Desktop\LAMB\dummy.txt" -c -t, -T'
exec master..xp_cmdshell @cmd 
```

`bcp Client_DB "Select name from dbo.t_TagBuild_set" queryout "Desktop\LAMB\dummy.txt" -c -t, -T`在命令提示符下工作得很好

尽管取得了微小的进步，但我的经理并不想走那条路。因此，通过在 SQL 上执行此行启用 sp_configure 后，我选择了 sp_OACreate 和 sp_OAMethod： sp_configure 'Ole Automation Procedures', 1

这条路线的第一行是这样的：

```
EXECUTE @hr = sp_OACreate  'Scripting.FileSystemObject' , @objFileSystem OUT 
```

@hr 给出一个 0 ，这很好，但 @objFileSystem 产生 16711422 并且 @hr 最终变成 -2146828218 我相信这是权限。

我真的很茫然找不到简单的事情，但我自己越来越难以找到具体的事情，只是在添加新行并重复该过程之前连续写入几个变量。

如果有人能熟练地帮助我找出 BCP 或 sp_OACreate，那么我将非常感激，因为网络几乎没有帮助（这是在我花了很多时间浏览微软自己的网站寻找答案之后）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-20T22:53:57.703

创建查询视图并使用 选择它`sqlcmd`。

```
declare @cmd varchar(8000)
select @cmd = 'sqlcmd -h-1 -W -S servername -d database -U username -P password -Q "SET NOCOUNT ON; select * from VIEW_NAME " -o "C:\OUTPUT\query.csv" '
exec master..xp_cmdshell @cmd 
```

`-h-1`删除标题

`SET NOCOUNT ON`删除受影响的页脚行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:10:41.353

您的 BCP 不起作用的原因是您从 xp_cmdshell 与受信任的用户一起运行它。xp_cmdshell 不在运行脚本的用户下运行。您可以 a) 更改您的 bcp 命令以使用 sql 登录名/密码或 b) 创建一个作业来运行它（不是 xp_cmdshell），因为您可以通过使用 run as 和凭据来控制它以什么用户身份运行。然后，您可以使用 sp_start_job 在脚本中启动该作业。

您的另一个不错的选择是创建一个 SSIS 包并通过命令行运行它（比如在 bat 文件中）或再次通过作业运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-05T22:42:12.907

您可以使用此方法在 T-SQL 上写入文件（它适用于触发器）：

--char(9) = \t

```
 DECLARE @filename nvarchar(1000);

    SET @filename = ' (echo '+@parameterA+ char(9) +@parameterB+ ... + char(9) +@ParameterN+') > e:\file1.txt && type e:\file1.txt >> e:\file2.txt';

    exec DatabaseName..xp_cmdshell @filename, no_output 
```

# python - 将字符串转换为嵌套列表中的浮点数

> ID：14885527
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:51:21.287
> 
> 标签：python, list, nested

我有一个列表列表，其中包含数字字符串和单词我只想将那些数字字符串转换为浮点数

```
aList= [ ["hi", "1.33"], ["bye", " 1.555"] ] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:53:05.227

首先，您需要一个函数来执行“如果可能，将字符串转换为浮点数，否则将其保留为字符串”：

```
def floatify(s):
    try:
        return float(s)
    except ValueError:
        return s 
```

现在，您可以在每个值上调用它，或者生成一个新列表，或者修改旧列表。

由于您有一个嵌套列表，这意味着嵌套迭代。您可能希望首先分两步明确地执行此操作：

```
def floatify_list(lst):
    return [floatify(s) for s in lst]

def floatify_list_of_lists(nested_list):
    return [floatify_list(lst) for lst in nested_list] 
```

您当然可以通过创建`floatify_list`一个本地函数将其组合成一个函数：

```
def floatify_list_of_lists(nested_list):
    def floatify_list(lst):
        return [floatify(s) for s in lst]
    return [floatify_list(lst) for lst in nested_list] 
```

您也可以通过用内部表达式代替函数调用来做到这一点。如果您自己无法弄清楚如何做到这一点，我建议您不要这样做，因为您不太可能理解它（复杂的嵌套列表理解对于专家来说很难理解），但如果您必须：

```
def floatify_list_of_lists(nested_list):
    return [[floatify(s) for s in lst] for lst in nested_list] 
```

或者，如果您希望您的 Python 看起来像伪装得很糟糕的 Haskell：

```
def floatify_list_of_lists(nested_list):
    return map(partial(map, floatify), nested_list) 
```

# python - 集群环境中的会话管理

> ID：14885533
> 
> 赞同：1
> 
> 时间：2013-02-14T22:51:27.927
> 
> 标签：python, cassandra, pyramid, gevent-socketio

我需要在具有各种服务器和数据库的集群环境中实现一个站点（HAProxy -> Varnish -> nginx -> uWSGI -> Pyramid，gevent-socketio，gevent -> Cassandra），我可以使用的最佳会话管理技术是什么. 我知道 gevent-socketio 使会话管理变得困难，我不确定 Beaker、memchached 或任何其他是否有/将支持它。

1.  带有中央服务器的 memcached 来处理会话（我最初并不期望有太多负载）

2.  将会话复制到每个节点（我想 Redis 或 Cassandra 可能能够支持开箱即用的复制）

3.  cookie-only 会话（我认为这是有风险的）

Pyramid 支持的会话管理解决方案，支持 Cassandra 并能够与 gevent-socketio 一起使用会很酷。

# bash - 使用带有命令行参数的 sed？

> ID：14885535
> 
> 赞同：20
> 
> 时间：2013-02-14T22:51:31.360
> 
> 标签：bash, sed

我需要运行这样的 sed 命令作为 shell 脚本的一部分

```
sed 's/brad/pitt/g' 
```

我应该提供 brad 作为命令行参数并运行这样的命令

```
sed s/$1/pitt/g 
```

虽然此命令有效，但我想知道如何在不删除引号的情况下执行此命令，因为我可能在替换字符串中有一些需要引号的内容。

我对报价不太自信，这就是为什么我想看看稍微调整一下会如何工作？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-02-14T22:55:45.777

你可以`sed "s/$1/pitt/g"`或`sed 's/'$1'/pitt/g'`

或者，如果命令行参数不是一个简单的单词，`sed 's/'"$1"'/pitt/g'`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T22:59:20.333

有两种方法可以做到：

1）使用双引号

```
 sed "s/$1/pitt/g" 
```

2) 将命令构造为字符串并使用 eval 运行它

```
SEDCMD="s/$1/pitt/g"
eval sed $SEDCMD 
```

eval 方法有效并且非常灵活，但被认为是危险的，因为它容易受到代码注入的影响。如果您不信任您的输入，请不要使用 #2

更新：评论是正确的，使用 eval 没有任何好处（我以前一直以这种方式使用 eval 和 sed，我不知道为什么....）构建 sed 字符串以供以后使用，但是，是强大：所以我将添加一个新的 3) 并留下 2 供人们模拟

3) 将命令构造为字符串，然后运行其中的 1 个或多个

```
FOO='s/\(.*\)bar/\1baz/'
BAR="s/$1/pitt/g"
sed -e $BAR -e $FOO <infile >outfile 
```

# php - 从字符串中取出一部分

> ID：14885541
> 
> 赞同：0
> 
> 时间：2013-02-14T22:51:54.903
> 
> 标签：php

```
http://www.webpage.ee/xxx-galerii/event-02-02-13 
```

如何使用 php 从该 url 中获取“xxx”部分？左边总是有“ee/”，右边总是有“-galerii”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:54:50.290

```
$path = parseurl($url, PHP_URL_PATH);
list($xxx) = explode('-', $path, 2); 
```

# r - 使用条件计数创建函数

> ID：14885543
> 
> 赞同：0
> 
> 时间：2013-02-14T22:51:58.603
> 
> 标签：r, conditional

我想开发一个功能来自动化成绩分析的过程。

在一栏中，有一个学生的辅导小时数，在下一栏中是他或她的成绩。

对于三个组，我必须计算 As（A+s 和 As）、Bs（B+s 和 As）、Cs、Ds、Fs、Ws 的数量并计算每个组的 GPA。这些组是那些有 6 小时或更多小时的人，那些没有时间的人，以及那些有辅导的总人数。

是否可以在 R 中创建一个简单的函数，例如**Grades(Hours,Mark)**，类似于**Summary()**函数，它将打印三个类别，每个类别具有以下信息：

1.  A、B、C、D、F、W任意类型（As包括As、As、A+s等）的学生人数
2.  计算 GPA：(4*A+3*B+2*C+1*D+0*F+0*W)/(A + B+ C + D+ F - W)

这甚至可以在R中做到吗？我从哪里开始？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:46:09.790

```
> Hours=c(0,5,6,10,0);Grades=c("F","A-","A","A+","C-") 
> grpHrs <- Hours >= 6
> table( substr(Grades, 1,1), grpHrs)
   grpHrs
    FALSE TRUE
  A     1    2
  C     1    0
  F     1    0 
```

很难知道需要什么样的 GPA 计算，因为很明显这些是不同的学生。如果这些都来自同一个学生，那么：

```
grdABCDFW <- substr(Grades,1,1)

sum( 4* (grdABCDFW=="A")+
     3*(grdABCDFW=="B")+
     2*(grdABCDFW=="C")+ 
     1*(grdABCDFW=="D")+ 
     0*(grdABCDFW=="F")+ 0*(grdABCDFW=="W") )/
                 length(Grades[ !is.na(Grades)] )
#[1] 2.8 
```

对你的评论。也许：

```
Hours.time=function(Hours, Grades, cutpt){  
                 grpHrs <- Hours >= cutpt
                 tbl <- table( substr(Grades,1,1), grpHrs)
                 colnames(tbl) <- c(  paste("Fewer than ", cutpt),
                                     paste( cutpt, "or more") )
                  tbl }
 Hours.time(Hours, Grades,6)
 #-------
   grpHrs
    Fewer than  6 6 or more
  A             1         2
  C             1         0
  F             1         0 
```

# php - 无法让这个 MySQL 查询工作

> ID：14885544
> 
> 赞同：0
> 
> 时间：2013-02-14T22:52:00.653
> 
> 标签：php, mysql

得到这个查询：

```
mysql_query("INSERT INTO leaderboard (user_id, lines) 
    VALUES (". $rowUser['id'] .",". $linesDone .")") or die("ERROR 29: ". mysql_error()); 
```

给出这个错误：

```
ERROR 29: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'lines) VALUES (1,50)' at line 1 
```

我已经尝试了所有类型的语法，比如在查询中使用 ´´ 和 ''，但所有的结果都是大约。同样的错误。

任何人都可以看到有什么问题吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T22:54:28.477

Lines 是 MySQL 中的保留字 - 你必须用反引号转义这个词

```
mysql_query("INSERT INTO leaderboard (user_id, `lines`) 
VALUES (". $rowUser['id'] .",". $linesDone .")") or die("ERROR 29: ". mysql_error()); 
```

顺便说一句.. mysql_* 如[手册](http://www.php.net/manual/en/function.mysql-query.php)中所述已弃用。最好使用 mysqli_* 或 pdo

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:04:25.290

保护您的查询。

```
mysql_query(
         sprintf("INSERT INTO leaderboard (user_id,`lines`) 
                  VALUES ('%d','%s')",
        mysql_real_escape_string($rowUser['id']),
        mysql_real_escape_string($linesDone)
) or die("ERROR 29: ". mysql_error()); 
```

# jquery - signalR-1.0.0-rc2 用户身份不起作用

> ID：14885545
> 
> 赞同：1
> 
> 时间：2013-02-14T22:52:03.960
> 
> 标签：jquery, asp.net, signalr, signalr-hub, signalr.client

我试图使用 signalR 1.0.0 RC2，因为我注意到自 0.5.3 以来很多事情都发生了变化，其中一件不起作用的是“ **Context.User.Identity.Name** ”，它给了我空值，我不确定，这仍然是访问 Windows 用户身份的正确方法吗？

```
 [HubName("chatroom")]
 public class ChatRoomHub : Hub
 {
    public void Join()
    {
      User newUser = new User();

      newUser.ClientID = Context.ConnectionId;
      newUser.Login = Context.User.Identity.Name.Split('\\')[1];
      newUser.Content = " joined discussion";
      newUser.DateTime = DateTime.Now.ToString("dd/MM/yyyy hh:mm:ss");

      this.Clients.Join(newUser);
    }       
  } 

string name = Context.User.Identity.Name; // name is blank here 
```

在 1.0.0 RC2 中，Context.User.Identity.Name 为 null

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T19:59:21.613

在我的项目中，这解决了这个问题：

（文件：Web.config）

```
<system.web> 
    <authorization>
        <deny users="?" />
    </authorization>
</system.web> 
```

希望这可以帮助。

# crystal-reports - 在报告页面的一侧记录按列报告的标题

> ID：14885551
> 
> 赞同：0
> 
> 时间：2013-02-14T22:52:51.343
> 
> 标签：crystal-reports, crystal-reports-2008

我正在使用“水平”记录制作报告，以便每条记录中的数据显示在单个列中，并且列在页面的长度上重复，因此数据如下所示：

![在此处输入图像描述](../Images/a9d89887d8d1d473bd93106733f1f459.png)

这些字段确实需要页面左侧的标签，但是我看不到如何在页面侧面制作“标题”。Excel 中的原始报告是这样的：

![在此处输入图像描述](../Images/3b3a41d50ab8f230e478150485e64a74.png)

虽然我的列记录工作正常，但我很困惑如何将最右边的列变成标签/标题区域。它也需要在每一页上重复。我正在使用 Section Expert 中的“多列格式”功能。我在标题部分看不到这样的“列”功能，如果我只是将一个文本对象插入到数据左侧的详细信息列中，我会将该文本复制到每条记录中，如下所示：

![在此处输入图像描述](../Images/6ff7b6e337620cc4871813954d24657b.png)

如何在 Crystal 页面的左侧/右侧制作这些“侧面”标题？

# html - 将 HTML 表格转换为 Div

> ID：14885552
> 
> 赞同：0
> 
> 时间：2013-02-14T22:52:50.807
> 
> 标签：html, css, css-tables

在将编码表从表转换为 Div 设置方面，我有一个良好的开端，但在这部分的某些地方似乎有问题。这就是网站的样子： [http](http://db.tt/YeUZiiBy) ://db.tt/YeUZiiBy 。

这是代码和 CSS 链接：http: [//jsfiddle.net/8WKR9/1/](http://jsfiddle.net/8WKR9/1/)。

这是我的 HTML `

```
<div id="container">
    <article>
        <div class="item">
            <img src="4-cute-cats.jpg" class="centerImage" width="300" height="300"
            />
            <p class="centerText">They hunt in packs.</p>
        </div>
        <div class="item">
            <img src="cat_sniping.jpg" class="centerImage" width="256" height="192"
            />
            <p class="centerText">Sniper Cat</p>
            </a>
        </div>
        <div class="item">
            <img src="LOL1.jpg" class="centerImage" width="300" height="298" />
            <p class="centerText">Sneaking Cat</p>
        </div>
        <div class="item">
            <img src="hammercat.jpg" class="centerImage" width="300" height="163"
            />
            <p class="centerText">80s Cat</p>
        </div>
    </article>
    <article>
        <div class="item">
            <img src="kittytrap.jpg" class="centerImage" width="200" height=492 />
            <p class="centerText">It's a trap!</p>
        </div>
        <div class="item">
            <img src="chop-cats.jpg" class="centerImage" width="300" height="140"
            />
            <p class="centerText">They can strip a car to the frame in under 2:00 minutes.</p>
        </div>
        <div class="item">
            <img src="smartkat.jpg" class="centerImage" width="200" height="338" />
            <p class="centerText">Intelligent cat.</p>
            </a>
        </div>
        <div class="item">
            <img src="narniacat.jpg" class="centerImage" width="200" height="337"
            />
            <p class="centerText">Once a cat of Narnia always a cat of Narnia.</p>
        </div>
    </article>
    <article>
        <div class="item">
            <img src="lolcats3.jpg" class="centerImage" width="300" height="108" />
            <p class="centerText">Tired cat.</p>
        </div>
        <div class="item">
            <img src="lol_cats_1.jpg" class="centerImage" width="300" height="142"
            />
            <p class="centerText">Gollum Cat.</p>
        </div>
        <div class="item">
            <img src="Magical-Kitty.png" class="centerImage" width="300" height="180"
            />
            <p class="centerText">Super Cat.</p>
        </div>
        <div class="item">
            <img src="sad-kitty.jpg" class="centerImage" width="300" height="188"
            />
            <p class="centerText">Sad Kitty.</p>
        </div>
    </article>
    <article>
        <div class="item">
            <img src="cat-in-your-wallpaper.jpg" class="centerImage" width="300" height="200"
            />
            <p class="centerText">Wallpaper cat.</div>
        <div class="item">
            <img src="thinking-cat.jpg" class="centerImage" width="300" height="475"
            />
            <p class="centerText">Thinking cat.</p>
        </div>
        <div class="item">
            <img src="http://3.bp.blogspot.com/_znuneBeHigk/TSOOr5DuoQI/AAAAAAAABFY/-Rpe8S1uRo8/s1600/000.jpg&w=823&h=618&ei=_A4VUfP7L4Gy2QXJ-oHIDQ&zoom=1&ved=1t:3588,r:79,s:0,i:354&iact=rc&dur=2621&sig=108293906633680688065&page=3&tbnh=172&tbnw=231&start=67&ndsp=38&tx=64&ty=72"
            class="centerImage" width="300" height="225" />
            <p class="centerText">Gamer Kitty.</p>
        </div>
        <div class="item">
            <img src="http://www.dumpaday.com/wp-content/uploads/2013/01/funny-lol-cats-playing-with-toilet-paper1.jpg"
            class="centerImage" width="300" height="504" />
            <p class="centerText">Couch cat.</p>
        </div>
    </article>
    </article>
    <article>
        <div class="item">  <a href="morekitties.html">More Kitties</a>

        </div>
    </article>
</div>` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:52:27.943

我认为你对标记的想法是正确的，但需要在 CSS 方面做一些工作。关键是清除您的浮动，否则该项目将转到下一个可用位置。我建议对浮动以及它们如何影响块元素和父元素进行更多阅读。

我为您做了一个快速的“基本”示例，您应该能够适应。

[http://jsfiddle.net/ZbfXU/2/](http://jsfiddle.net/ZbfXU/2/)

```
<html></html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T01:38:31.103

尝试在标签 img 中设置高度

```
.item > img {
width: 100%;
height: 100%;    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T07:01:38.827

您可以在 img 标签上使用 max-width 和/或 max-height 以确保它们保持比例而不是转换。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-14T23:57:42.000

浏览您的代码并整理它，您有正确的想法，即分成几行，然后在每行中使用 div。

这是我很快模拟出来的一个，[http://jsfiddle.net/8WKR9/5/](http://jsfiddle.net/8WKR9/5/)第一个和第三个高度相同，第二个和第四个相同，我没有收到任何显示错误，所以最好通过你的 HTML & CSS 并整理它，这样您就可以看到每个部分在做什么并找出哪里出了问题，而不是尝试快速修复，它还可以使您的代码更清晰，更易于阅读。

```
<html></html> 
```

# scala - 从 Scala Breeze 中的文件中读取矩阵

> ID：14885553
> 
> 赞同：7
> 
> 时间：2013-02-14T22:52:53.787
> 
> 标签：scala, scalala, scala-breeze

我想将制表符分隔的文本文件读入 Breeze DenseMatrix。我在 ScalaDoc 中看到这应该是可能的，并且有一整套 I/O 类，但是我找不到任何示例并且很难消化 ScalaDoc。

有人可以提供一个简单的读/写示例吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-04-06T11:35:09.280

有一种方法可以将 csv 文件读入densematrix

```
import breeze.linalg._
import java.io._
val matrix=csvread(new File("your file localtion"),',') 
```

api：[http ://www.scalanlp.org/api/breeze/index.html#breeze.linalg.package](http://www.scalanlp.org/api/breeze/index.html#breeze.linalg.package)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:28:28.697

您可以使用`scala.io.Source`从文件中读取制表符分隔的数据。

一些样本数据：

```
0       1       2       3       4       5
6       7       8       9       10      11 
```

其中一个`DenseMatrix`构造函数具有这种形式`new DenseMatrix(rows: Int, data: Array[V], offset: Int = 0)`，所以我将使用它。

获取行数：

```
scala> scala.io.Source.fromFile("TabDelimited.txt").getLines.size
res 0:Int = 2 
```

然后将数据作为`Array[Int]`：

```
scala> scala.io.Source.fromFile("TabDelimited.txt").getLines.toArray.flatMap(_.split("\t")).map(_.toInt)
res1: Array[Int] = Array(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11) 
```

然后`res0`又`res1`可以用来创建一个新的`DenseMatrix`.

# shell - 从多个文件的 grep 搜索中获取最后一行

> ID：14885554
> 
> 赞同：44
> 
> 时间：2013-02-14T22:52:58.297
> 
> 标签：shell, unix, grep

我目前在使用 grep 命令时遇到了一些问题。

我找到了只显示 grep 搜索的最后一行的方法：

```
grep PATERN FILE_NAME | tail -1 
```

我还找到了在多个选定文件中进行 grep 搜索的方法：

```
find . -name "FILE_NAME" | xargs -I name grep PATERN name 
```

现在我只想获取每个文件的 grep 结果的最后一行。我试过这个：

```
 find . -name "FILE_NAME" | xargs -I name grep PATERN name | tail -1 
```

这仅返回我希望为每个文件提供最后一个匹配模式的最后一个文件的最后一个值。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-02-14T23:04:18.913

```
for f in $(find . -name "FILE_NAME"); do grep PATTERN $f | tail -1; done 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2020-02-01T17:25:22.067

Sort 有一个 uniq 选项，允许您从多行中选择一行。试试这个：

```
grep PATTERN FILENAMES* | tac | sort -u -t: -k1,1 
```

说明：Grep 将为文件中的每个匹配项返回一行。这看起来像：

```
$ grep match file*
file1.txt:match
file1.txt:match2
file2.txt:match3
file2.txt:match4 
```

我们想要的是输出中的两行：

```
$ ???
file1.txt:match2
file2.txt:match4 
```

您可以将其视为一种表，其中第一列是文件名，第二列是匹配项，其中列分隔符是“：”字符。

我们的第一个管道反转输出：

```
$ grep match file* | tac
file2.txt:match4
file2.txt:match3
file1.txt:match2
file1.txt:match 
```

我们要排序的第二个管道说：拉出第一个唯一行（-u），其中分组的键是第一个（-k1,1，从第 1 列到第 1 列的键），我们将数据拆分为以 ':' 作为分隔符 (-t:) 的列。它也会对我们的输出进行排序！及其输出：

```
$ grep match file* | tac sort -u -t: -k1,1
file1.txt:match2
file2.txt:match4 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T22:59:12.147

你也可以使用 find 来执行命令：

```
find . -name "<file-name-to-find>" -exec grep "<pattern-to-match>" "{}" ";" | tail -1 
```

“{}”是文件名，写命令时注意shell globing和expasion

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-06-12T19:44:08.287

可以使用 awk 而不是 grep 来替代此方法。Posix 版本会这样写：

```
awk '(FNR==1)&&s{print s; s=""}/PATTERN/{s=$0}END{if(s) print s}' file1 file2 file3 ... 
```

使用 GNU awk，您可以使用 ENDFILE

```
awk 'BEGINFILE{s=""}/PATTERN/{s=$0}ENDFILE{if(s) print s}' file1 file2 file3 ... 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-17T00:47:50.527

您可以从 grep 的 -B（之前）参数开始。例如在比赛前获得 5 行：

```
duli@i5 /etc/php5/apache2 $ grep -i -B5 timezone php.ini 
[CLI Server]
; Whether the CLI web server uses ANSI color coding in its terminal output.
cli_server.color = On

[Date]
; Defines the default timezone used by the date functions
; http://php.net/date.timezone
;date.timezone = 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-06-12T19:20:56.950

获取每个文件的最后一行（以文件名为前缀）。然后，根据模式过滤输出。

```
find . -name "*" -exec tail -v -n1 {} \; | grep "some_string" -B1 
```

在 macOS 上，您必须以稍微不同的方式进行操作

```
find . -name "*" | xargs tail -1 | grep "some_string" -B1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-02-27T21:32:42.293

晚会晚了 7 年。修改命令行的慢方法：

```
find . -name "FILE_NAME" | xargs -I name sh -c "grep PATERN name | tail -1" 
```

如果需要在每一行显示文件名：

```
find . -name "FILE_NAME" | xargs -I name sh -c "grep -H PATERN name | tail -1" 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-02-14T23:51:01.873

有一个不需要循环的解决方案，这给出了 OP 想要的。

```
find . -type f -exec sh -c "fgrep print {} /dev/null |tail -1" \;

./tway.pl:print map(lambda x : x[1], filter(lambda x : x[0].startswith('volume'), globals().items()))
./txml.py:           print("%s does not exist: %s\n" % (host, error))
./utils.py:print combine_dicts(a, b, operator.mul)
./xml_example.py:print ET.tostring(root, method="text") 
```

与没有`tail -1`给出每个文件**太多行**相比，但证明了上述工作。

```
find . -type f -exec sh -c "fgrep print {} /dev/null" \; 
```

给出：

```
./tway.pl:print map(lambda x : x[1], filter(lambda x : x[0].startswith('volume'), globals().items()))
./txml.py:           print("%s resolved to --> %s\n" % (host, ip))
./txml.py:           print("%s does not exist: %s\n" % (host, error))
./utils.py:print "a", a
./utils.py:print "b", b
./utils.py:print combine_dicts(a, b, operator.mul)
./xml_example.py:    print ">>"
./xml_example.py:    print ET.tostring(e, method="text")
./xml_example.py:    print "<<"
./xml_example.py:print ET.tostring(root, method="text") 
```

**编辑**-*如果您不希望文件名包含在输出中，请删除 /dev/null 。*

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-07-17T13:39:01.813

最快的方法是从文件中获取最后 1 （或更多）行的输出，然后通过 grep 执行该操作。所以 -

```
tail -1 filenames.* | grep "what you want to grep for" 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-07-17T14:58:40.617

找到*最后*一行的另一种方法是反转文件并输出第*一个*匹配项。

```
find . -name "FILE_NAME" | xargs -I name sh -c 'tac name|sed -n "/PATTERN/{p;q}"' 
```

# ruby-on-rails - vcr 不知道如何处理这个请求

> ID：14885557
> 
> 赞同：4
> 
> 时间：2013-02-14T22:53:10.360
> 
> 标签：ruby-on-rails, cucumber, google-oauth, vcr

嗨，我正在尝试使用带有标签的 vcr 用黄瓜测试谷歌身份验证。

一切都很好，直到令牌过期。我认为当它到期时会发生这种情况

![在此处输入图像描述](../Images/788aa64ccdd149f9aa848c1ec4d4ecf5.png)

但我有一个包含此内容的文件

```
http_interactions:
- request:
  method: post
  uri: https://accounts.google.com/o/oauth2/token
  body: 
```

如果我允许 vcr 录制新请求，则此磁带的内容会更改。我不明白为什么，如果方法和 uri 没有将 POST 更改为[https://accounts.google.com/o/oauth2/token](https://accounts.google.com/o/oauth2/token)。

我更改了标签以录制新剧集，现在测试通过了……我一无所知。

我再次运行测试，现在当 POST 到令牌 url 完成时我有了这个：

```
Completed 500 Internal Server Error in 449ms

Psych::BadAlias (Unknown alias: 70317249293120): 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-14T15:46:23.017

好的，这是一个解决方案......正如我在评论中所说，问题来自刷新令牌。使用 oauth 时，您有一个令牌，该令牌可能已过期（或未过期）。如果您运行测试并且令牌是新的，则不会调用该请求。但如果令牌已过期，则必须刷新它，因此 vcr 会引发错误。为了解决这个问题，我所做的是将刷新令牌 url 添加到 vcr 的忽略请求中：

```
VCR.configure do |c|
  c.cassette_library_dir = 'fixtures/vcr_cassettes'
  c.hook_into :webmock # or :fakeweb
  c.ignore_request {|request| request.uri == 'https://accounts.google.com/o/oauth2/token' }
end 
```

这不是最好的解决方案，因为有时令牌会在测试中刷新......但这是我能找到的最好的解决方案......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-30T08:44:52.023

也许您在帖子中有一些参数，每个请求都不同？`match_requests_on: [:method, VCR.request_matchers.uri_without_params("your_param")]`如果是这样，您可以通过添加到您的 VCR 配置来告诉 VCR 忽略此参数。

深入分析您的请求，并找出哪些参数正在发生变化。您也可以告诉 VCR 匹配其他标准，请看这里[https://www.relishapp.com/vcr/vcr/v/2-4-0/docs/request-matching](https://www.relishapp.com/vcr/vcr/v/2-4-0/docs/request-matching)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-24T20:53:17.633

我在相同的 URL 上遇到了同样的问题。对我来说，问题是我的代码试图`https://accounts.google.com/o/oauth2/token`不止一次地进行相同的调用。

VCR 错误消息中给出的潜在解决方案之一告诉您解决方案：

> 磁带包含与此请求匹配的 HTTP 交互，但它已被播放。如果您希望允许多次播放单个 HTTP 交互，请设置`:allow_playback_repeats`盒式磁带选项

在我的例子中，添加这个选项解决了这个问题，因为它告诉 VCR 恢复到其 1.x 功能，即不重新记录重复请求，而只是回放先前记录的重复请求的结果。

我正在使用 Cucumber，所以我的解决方案是将以下内容添加到我的`features/support/vcr.rb`：

```
VCR.cucumber_tags do |t|
  t.tag  '@vcr', use_scenario_name: true
  t.tag  '@new_episodes', record: :new_episodes
  t.tag  '@allow_playback_repeats', use_scenario_name: true, allow_playback_repeats: true, record: :new_episodes
end 
```

注意`@allow_playback_repeats`标签。我只是用这个标签标记了我的场景，此后一切正常：

```
@allow_playback_repeats
Scenario: Uploading a video initiates an upload to YouTube 
```

`@vcr`请注意，如果同时指定和，则它不起作用`@allow_playback_repeats`。

如果您使用的是 RSpec，则需要相应地调整解决方案，但是，它[应该很简单](https://www.relishapp.com/vcr/vcr/v/2-9-0/docs/test-frameworks/usage-with-rspec-metadata)：

```
it "does something", :vcr => { allow_playback_repeats: true } do
   ...
end 
```

# amazon-web-services - 无法使用亚马逊 ec2 托管内容

> ID：14885559
> 
> 赞同：0
> 
> 时间：2013-02-14T22:53:37.800
> 
> 标签：amazon-web-services, amazon-ec2, cloud

这是我所做的：

我在 amazon e2 安全设置中打开了 post 80, 22,21

我有腻子和腻子

我有 putty 和 pem 键

我使用 Win_SCP 在 public_html 目录中创建了一个 index.html 文件

没有加载

[http://ec2-107-20-57-133.compute-1.amazonaws.com/](http://ec2-107-20-57-133.compute-1.amazonaws.com/)

腻子一直告诉我，无论我在里面放什么，连接都会拒绝。如果没有断开我的连接，我什至无法登录。这是我自己的网络设置在工作中的问题吗，这是腻子配置的问题，我的亚马逊帐户有问题..我不知道

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T20:00:14.870

对于拒绝连接的实例，我遇到了类似的问题。我建议您检查打开的端口以及它们是否允许来自所有 IP 的流量。此外，如果您使用默认安全设置并且它拒绝连接，请尝试创建您的自定义安全配置文件并打开所需的端口并允许 IP。

另外，您在创建实例时选择了哪个操作系统映像？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T16:54:57.483

首先，您允许来自哪些 IP 地址的 HTTP、FTP 和 SSH 流量？

接下来，ec2-107-20-57-133.compute-1.amazonaws.com 是否仍然是正确的实例名称？

那么，您的网络是否已启动并正在运行？index.html 是实际的默认文档吗？

# python - 剥离一个冗长的 python 正则表达式

> ID：14885567
> 
> 赞同：10
> 
> 时间：2013-02-14T22:54:13.993
> 
> 标签：python, regex

我有一个冗长的 python 正则表达式字符串（有很多空格和注释），我想将其转换为“正常”样式（用于导出到 javascript）。特别是，我需要这个非常可靠。如果有任何明显正确的方法可以做到这一点，这就是我想要的。例如，一个幼稚的实现会破坏一个像 regex 这样的正则表达式`r' \# # A literal hash character'`，这是不行的。

做到这一点的最好方法是强制 python re 模块给我一个我的正则表达式的非详细表示，但我看不到这样做的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T08:13:24.387

我相信您只需要解决这两个问题即可去除冗长的正则表达式：

1.  删除行尾的评论
2.  删除未转义的空格

试试这个，它用单独的正则表达式替换链接 2：

```
import re

def unverbosify_regex_simple(verbose):
    WS_RX = r'(?<!\\)((\\{2})*)\s+'
    CM_RX = r'(?<!\\)((\\{2})*)#.*$(?m)'

    return re.sub(WS_RX, "\\1", re.sub(CM_RX, "\\1", verbose)) 
```

上面是一个简化版本，保留转义空格原样。结果输出会有点难以阅读，但应该适用于正则表达式平台。

或者，对于“取消转义”空格（即'\'=>''）并返回我认为大多数人所期望的稍微复杂一点的答案：

```
import re

def unverbosify_regex(verbose):
    CM1_RX = r'(?<!\\)((\\{2})*)#.*$(?m)'
    CM2_RX = r'(\\)?((\\{2})*)(#)'
    WS_RX  = r'(\\)?((\\{2})*)(\s)\s*'

    def strip_escapes(match):
        ## if even slashes: delete space and retain slashes
        if match.group(1) is None:
            return match.group(2)

        ## if number of slashes is odd: delete slash and keep space (or 'comment')
        elif match.group(1) == '\\':
            return match.group(2) + match.group(4)

        ## error
        else:
            raise Exception

    not_verbose_regex = re.sub(WS_RX, strip_escapes,
                          re.sub(CM2_RX, strip_escapes,
                            re.sub(CM1_RX, "\\1", verbose)))

    return not_verbose_regex 
```

**更新：**添加注释以解释偶数 v. 奇数斜线计数。修复了 CM_RX 中的第一组以在斜线计数为奇数时保留完整的“注释”。

**更新 2：**修正了评论正则表达式，它没有正确处理转义的哈希。应该同时处理 "\# #escaped hash" 以及 "# comment with \# escaped hash" 和 "\\# comment"

**更新 3：**添加了不清理转义空格的简化版本。

**更新 4：**进一步简化以消除可变长度的负后视（和反向/反向技巧）

# python - Python初学者，一个简单计算器程序的数学函数

> ID：14885570
> 
> 赞同：0
> 
> 时间：2013-02-14T22:54:26.600
> 
> 标签：python, string, function, math, integer

我正在为编程课程制作一个基本计算器，并且我已经阅读了 PDF，但我不知道如何制作一个函数，然后用它来打印两个数字相加的结果。有人可以帮我吗？

```
def addition(intFirstOperand, intSecondOperand):
    addition = intFirstOperand + intSecondOperand

print ('What mathematical operation would you like to perform? Enter a number:')
print ('1 - addition')
print ('2 - subtraction')
print ('3 - multiplication')
print ('4 - division')

intOperation = input()
intOperation = int(intOperation)

addition = '1'
subtraction = '2'
multiplication = '3'
division = '4'

if intOperation == 1 :
    print ('Please enter the first operand for addition:')
    intFirstOperand = input()
    print ('Please enter the second operand for addition:')
    intSecondOperand = input()
    print addition(intFirstOperand, intSecondOperand)

if intOperation == 2 :
    print ('Please enter the first operand for subtractiom:')
    intFirstOperand = input()
    print ('Please enter the second operand for subtraction:')
    intSecondOperand = input()

if intOperation == 3 :
    print ('Please enter the first operand for multiplication:')
    intFirstOperand = input()
    print ('Please enter the second operand for multiplication:')
    intSecondOperand = input()   

if intOperation == 4 :
    print ('Please enter the first operand for division:')
    intFirstOperand = input()
    print ('Please enter the second operand for division:')
    intSecondOperand = input() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:05:24.760

我建议在您的函数中选择不同的变量名称，因为函数和变量具有相同的名称可能会造成混淆。您可以选择从函数内部打印，也可以返回一个值，然后在函数外部打印返回的值。

```
def addition(first,second):
    result = int(first) + int(second)
    #print result
    return result

print(addition(5,3)) #prints 8 in python 3.x 
```

或者，您可以跳过为“结果”分配值，而只返回第一+第二。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:58:16.587

```
def addition(intFirstOperand, intSecondOperand):
    addition = intFirstOperand + intSecondOperand
    return addition 
```

您想要返回您计算的值。那么您的打印语句应该可以工作。

# ravendb - EventStore 在使用 RavenDB 时抛出 ConcurrencyException

> ID：14885573
> 
> 赞同：2
> 
> 时间：2013-02-14T22:54:31.810
> 
> 标签：ravendb, cqrs, neventstore

我的电线看起来像这样。

```
return Wireup.Init()
      .UsingRavenPersistence("RavenDB")
      .ConsistentQueries()
      .InitializeStorageEngine()
      .UsingJsonSerialization()
      .Build(); 
```

当我尝试保存事件时，如下所示：

```
using (eventStore)
using (var stream = eventStore.CreateStream(myEvent.AggreagateId))
{
    stream.Add(new EventMessage { Body = myEvent });
    stream.CommitChanges(myEvent.Id);
} 
```

它抛出一个`EventStore.ConcurrencyException`

我正在使用 eventstore 3.0 和 RavenDB 2.0

我究竟做错了什么？

这是堆栈跟踪：

```
EventStore.ConcurrencyException was unhandled by user code
  HResult=-2146233088
  Message=Exception of type 'EventStore.ConcurrencyException' was thrown.
  Source=EventStore.Persistence.RavenPersistence
  StackTrace:
       at EventStore.Persistence.RavenPersistence.RavenPersistenceEngine.Commit(Commit attempt) in c:\Code\public\EventStore\src\proj\EventStore.Persistence.RavenPersistence\RavenPersistenceEngine.cs:line 135
       at EventStore.OptimisticEventStore.Commit(Commit attempt) in c:\Code\public\EventStore\src\proj\EventStore.Core\OptimisticEventStore.cs:line 98
       at EventStore.OptimisticEventStream.PersistChanges(Guid commitId) in c:\Code\public\EventStore\src\proj\EventStore.Core\OptimisticEventStream.cs:line 166
       at EventStore.OptimisticEventStream.CommitChanges(Guid commitId) in c:\Code\public\EventStore\src\proj\EventStore.Core\OptimisticEventStream.cs:line 147
       at TeamHabits.Web.Habit.CreateHabitModule.<>c__DisplayClass6.<.ctor>b__1(Object _) in c:\Users\Emil\Dropbox\Active projects\TeamHabits\Source\TeamHabits.Web\Habit\CreateHabitModule.cs:line 41
       at Nancy.Routing.Route.Invoke(DynamicDictionary parameters)
       at Nancy.Routing.DefaultRouteInvoker.Invoke(Route route, DynamicDictionary parameters, NancyContext context)
       at Nancy.Routing.DefaultRequestDispatcher.Dispatch(NancyContext context)
  InnerException: 
```

# c# - 是否可以强制将所有 DateTime 属性建模为 DateTime2？

> ID：14885578
> 
> 赞同：5
> 
> 时间：2013-02-14T22:55:04.317
> 
> 标签：c#, .net, entity-framework, ef-code-first, datetime2

在 Entity Framework 6 Code First 中，有没有办法强制将所有`DateTime`属性建模为`DateTime2`？

我知道我能做到

```
.HasColumnType("datetime2") 
```

在每个单独`DateTime`的属性上，但我想知道是否有办法将其设置为*所有* `DateTime`属性的默认值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-19T18:25:04.603

是的。

在 Entity Framework 6 的 Fluent API 中，您可以`DateTime`使用这一行更新所有属性：

```
modelBuilder.Properties<DateTime>().Configure(c => c.HasColumnType("datetime2")); 
```

# ruby-on-rails - Rails 中的排名算法优化

> ID：14885583
> 
> 赞同：0
> 
> 时间：2013-02-14T22:55:24.580
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, mongodb, mongoid

我需要使用 Mongoid 对 Rails 应用程序中的帖子进行排名，并且我正在寻找有关如何高效准确地执行此操作的输入。

现在，我编造的方式非常低效。

现在我正在根据这样的方法对模型进行排序：

```
def hotness
  return (self.confidence*(self.popularity+0.3))/Math.sqrt((Time.now - Time.at(self.created_at)))
end 
```

因此，我根据热度对数组进行排序并将其打印到页面上。这是错误的做法，而且性能现在还没有发生。

不过，我不确定有什么更好的方法。

还有其他不需要时间调用的函数，我可以想象不同的方法来做这些，但仍然需要输入。优化对我很重要。

提前非常感谢。如果需要，我可以澄清任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T12:54:39.843

继您上面的评论之后 - 如果这是可以缓存在字段中并定期更新的结果，或者每当模型被保存时 - 那么这是最好的方法（就 MongoDB 中的查询性能而言）。

因此，您最终会得到以下结果：

```
class Post
  include Mongoid::Document

  field :hotness, :type => Float, :default => 0
  field :confidence, :type => Float, :default => 0
  field :popularity, :type => Float, :default => 0

  before_save :refresh_hotness

  scope :hottest, desc(:hotness)

  protected
  def refresh_hotness
    self.hotness = (self.confidence*(self.popularity+0.3))/Math.sqrt((Time.now - Time.at(self.created_at)))
  end
end 
```

然后，您可以使用 获取已排序的“最热门”帖子`Post.hottest`。

# asp.net-mvc - ASP.NET MVC [必需] 不会触发

> ID：14885597
> 
> 赞同：0
> 
> 时间：2013-02-14T22:57:00.553
> 
> 标签：asp.net-mvc, validation

正如标题所说，我的必填字段不会触发。

这是我的 ViewModel 类，它的名字是**SignUpForm.cs**

```
public class SignUpForm
{
    [Required]
    [StringLength(100,ErrorMessage="You must enter a your firstname!", 
    MinimumLength = 1)]
    public string FirstName { get; set; }
    [Required]
    [StringLength(100, ErrorMessage = "You must enter a your surname!", 
    MinimumLength = 1)]
    public string SurName { get; set; }      
} 
```

这是我的剃刀观点！视图名称为**Step2.cshtml**

```
@model MvcApplication2.Models.ViewModel.SignUpForm
@{
ViewBag.Title = "Step2";
 }

<div id="content-header">
<h1 class="title">Complete your registration</h1>   
</div>  
<div id="content-area">
    <h4>Fill in the form below to complete your registration
    </h4>
@using(Html.BeginForm("testar","Interested", FormMethod.Post))
{

<h3>Personal information</h3>
<p class="app-label">Surname<span class="requiredField">*</span></p>
<div class="editor-label">
    @Html.EditorFor(model => model.FirstName)
    @Html.ValidationMessageFor(m => m.FirstName)
</div>
<p class="app-label">Surname<span class="requiredField">*</span></p>
<div class="editor-label">
    @Html.EditorFor(model => model.SurName)
    @Html.ValidationMessageFor(m => m.SurName)
</div>
} 
```

**按要求提供来源**

```
<script src="/Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="/Scripts/modernizr-2.5.3.js" type="text/javascript"></script>
<link href="/Content/remigium.css" rel="stylesheet" />

 <h3>Personal information</h3>
 First name<span class="requiredField">*</span>
<div class="editor-label">
<input class="text-box single-line" data-val="true" data-val-length="You must enter a your firstname!" data-val-length-max="100" data-val-length-min="1" data-val-required="The FirstName field is required." id="FirstName" name="FirstName" type="text" value="" />
<span class="field-validation-valid" data-valmsg-for="FirstName" data-valmsg-replace="true"></span>
</div>
<p class="app-label">Surname<span class="requiredField">*</span></p>
<div class="editor-label">
<input class="text-box single-line" data-val="true" data-val-length="You must enter a your surname!" data-val-length-max="100" data-val-length-min="1" data-val-required="The SurName field is required." id="SurName" name="SurName" type="text" value="" />
<span class="field-validation-valid" data-valmsg-for="SurName" data-valmsg-replace="true"></span>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:12:14.360

我错过了这些脚本参考，我添加了它们，一切都很酷！

```
<script src="/Scripts/jquery.validate.min.js" type="text/javascript"></script>
<script src="/Scripts/jquery.validate.unobtrusive.min.js" type="text/javascript"></script> 
```

# bash - Bash脚本检查特定进程的cpu使用情况

> ID：14885598
> 
> 赞同：6
> 
> 时间：2013-02-14T22:57:02.753
> 
> 标签：bash, integer, arithmetic-expressions

首先，我是新手。我对 Windows 脚本和苹果脚本有一些经验，但对 bash 没有太多经验。我想要做的是获取特定进程的 PID 和 %CPU。然后将 %CPU 与设定的数字进行比较，如果更高，则终止该进程。我觉得我很接近，但现在我收到以下错误：

[[：0.0：语法错误：算术运算符无效（错误标记为“.0”）

我究竟做错了什么？到目前为止，这是我的代码：

```
#!/bin/bash
declare -i app_pid
declare -i app_cpu
declare -i cpu_limit
app_name="top"
cpu_limit="50"
app_pid=`ps aux | grep $app_name | grep -v grep | awk {'print $2'}`
app_cpu=`ps aux | grep $app_name | grep -v grep | awk {'print $3'}`
if [[ ! $app_cpu -gt $cpu_limit ]]; then
     echo "crap"
else
     echo "we're good"
fi 
```

显然，我将替换 if/then 语句中的回声，但无论 cpu 负载实际是什么，它都表现得好像该语句是真的（我通过将 -gt 更改为 -lt 进行了测试，它仍然回显“废话” "

谢谢大家的帮助。哦，如果这很重要，这是在 OS X 10.7 上。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T23:08:14.960

我建议您查看 的设施，`ps`以避免您做多种可怕的事情。

在我的系统上（`ps`来自 linux 上的 procps，GNU awk）我会这样做：

```
ps -C "$app-name" -o pid=,pcpu= | 
    awk --assign maxcpu="$cpu_limit" '$2>maxcpu {print "crappy pid",$1}' 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-14T23:00:26.060

问题是 bash 不能处理小数。您可以将它们乘以 100 并使用普通整数代替：

```
#!/bin/bash
declare -i app_pid
declare -i app_cpu
declare -i cpu_limit
app_name="top"
cpu_limit="5000"
app_pid=`ps aux | grep $app_name | grep -v grep | awk {'print $2'}`
app_cpu=`ps aux | grep $app_name | grep -v grep | awk {'print $3*100'}`
if [[ $app_cpu -gt $cpu_limit ]]; then
     echo "crap"
else
     echo "we're good"
fi 
```

请记住，CPU 百分比是衡量应用程序运行状况的次优指标。如果你有两个进程在一个单核系统上运行无限循环，那么没有其他具有相同优先级的应用程序将永远不会超过 33%，即使它们正在乱扔垃圾。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-02-28T07:56:10.327

```
#!/bin/sh
PROCESS="java"
PID=`pgrep $PROCESS | tail -n 1`
CPU=`top -b -p $PID -n 1 | tail -n 1 | awk '{print $9}'`
echo $CPU 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-02T22:32:23.393

我`top`用来检查一些细节。它提供了更多详细信息，例如 CPU 时间。

在 Linux 上，这将是：

```
top -b -n 1  | grep $app_name 
```

在 Mac 上，使用其 BSD 版本的 top：

```
top -l 1  | grep $app_name 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-27T13:30:01.973

我想出了这个，使用top和bc。

通过传入 ex 来使用它：`./script apache2 50 # max 50%`

如果有许多 PID 与您的程序参数匹配，则将根据 top 列出它们的方式仅计算一个。我可以通过捕获所有这些并平均百分比或其他东西来扩展脚本，但这必须这样做。

您还可以传入一个数字 ，`./script.sh 12345 50`这将强制它使用精确的 PID。

```
#!/bin/bash

# 1: ['command\ name' or PID number(,s)] 2: MAX_CPU_PERCENT

[[ $# -ne 2 ]] && exit 1
PID_NAMES=$1
# get all PIDS as nn,nn,nn
if [[ ! "$PID_NAMES" =~ ^[0-9,]+$ ]] ; then
    PIDS=$(pgrep -d ',' -x $PID_NAMES)
else
    PIDS=$PID_NAMES
fi
#  echo "$PIDS $MAX_CPU"
MAX_CPU="$2"
MAX_CPU="$(echo "($MAX_CPU+0.5)/1" | bc)"
LOOP=1
while [[ $LOOP -eq 1 ]] ; do
    sleep 0.3s
    # Depending on your 'top' version and OS you might have
    #   to change head and tail line-numbers
    LINE="$(top -b -d 0 -n 1 -p $PIDS | head -n 8 \
        | tail -n 1 | sed -r 's/[ ]+/,/g' | \
        sed -r 's/^\,|\,$//')"
    # If multiple processes in $PIDS, $LINE will only match\
    #   the most active process
    CURR_PID=$(echo "$LINE" | cut -d ',' -f 1)
    # calculate cpu limits
    CURR_CPU_FLOAT=$(echo "$LINE"| cut -d ',' -f 9)
    CURR_CPU=$(echo "($CURR_CPU_FLOAT+0.5)/1" | bc)
    echo "PID $CURR_PID: $CURR_CPU""%"
    if [[ $CURR_CPU -ge $MAX_CPU ]] ; then
        echo "PID $CURR_PID ($PID_NAMES) went over $MAX_CPU""%"
        echo "[[ $CURR_CPU""% -ge $MAX_CPU""% ]]"
        LOOP=0
        break
    fi
done
echo "Stopped" 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-12T20:20:58.717

Erik，我使用您的代码的修改版本创建了一个执行类似操作的新脚本。希望你不要介意。

一个 bash 脚本，用于按进程使用情况获取 CPU 使用情况：

```
nohup ./check_proc bwengine 70 & 
```

`bwegnine`是我们要监控的进程名称 70 是仅在进程使用超过 70% 的 CPU 时记录。

检查日志：`/var/log/check_procs.log`

输出应该是这样的：

```
DATE | TOTAL CPU | CPU USAGE | Process details 
```

例子：

```
03/12/14 17:11 |20.99|98| ProdPROXY-ProdProxyPA.tra

03/12/14 17:11 |20.99|100| ProdPROXY-ProdProxyPA.tra 
```

链接到完整的博客： http: [//felipeferreira.net/?p=1453](http://felipeferreira.net/?p=1453)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-08-29T02:03:05.130

`app_user`提供可用信息来测试当前用户是否有权终止/修改正在运行的进程也很有用。此信息可以与所需的信息一起获得，`app_pid`并且`app_cpu`可以通过`read`消除对`awk`或任何其他第 3 方解析器的需要来获得：

```
read app_user app_pid tmp_cpu stuff <<< \
$( ps aux | grep "$app_name" | grep -v "grep\|defunct\|${0##*/}" ) 
```

然后你可以得到你`app_cpu * 100`的：

```
app_cpu=$((${tmp_cpu%.*} * 100)) 
```

**注意：**包括`defunct`and `${0##*/}`in`grep -v`可以防止多个进程匹配`$app_name`。

# android - 使用 windowActionBarOverlay 时 ActionBarSherlock 变得透明

> ID：14885603
> 
> 赞同：1
> 
> 时间：2013-02-14T22:57:28.897
> 
> 标签：android, styles, actionbarsherlock, transparent

我正在将 ActionBarSherlock 用于我正在制作的 Android 应用程序，并在我的一个屏幕上显示图像。在此屏幕上，我希望操作栏在用户按下屏幕时消失并返回，而不会拉伸图像。这部分我正在工作，但为此我创建了以下样式并将其应用于该屏幕。. .

```
<style name="DarkActionBar.ActionBarOverlay" parent="@style/Theme.Sherlock">
    <item name="android:windowActionBarOverlay">true</item>
    <item name="windowActionBarOverlay">true</item>
</style> 
```

问题是，现在我的操作栏是透明的，我不知道为什么。如果我将我的样式的父级更改为 Theme.Sherlock.Light.DarkActionBar，它不再透明但看起来与 Theme.Sherlock 不同，因此它将与我的应用程序的其余部分不一致。

我也试过以下。. .

```
<style name="MyActionBar" parent="@style/Theme.Sherlock.Light.DarkActionBar">
    <item name="android:background">@color/black</item>
    <item name="background">@color/black</item>
</style>

<style name="DarkActionBar.ActionBarOverlay" parent="@style/Theme.Sherlock">
    <item name="android:windowActionBarOverlay">true</item>
    <item name="windowActionBarOverlay">true</item>
    <item name="android:actionBarStyle">@style/MyActionBar</item>
</style> 
```

谁能告诉我为什么 windowActionBarOverlay 项目使我的操作栏透明，以及我能做些什么来解决它？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-24T23:24:10.143

由于透明的 ActionBar 是一个名为“Actionbar Overlay”的功能，我认为问题出在这一行：

```
<item name="windowActionBarOverlay">true</item> 
```

您可能需要将其设置为`false`.

请阅读以下段落：

> 要为操作栏启用覆盖模式，您需要创建一个扩展现有操作栏主题的自定义主题，并将 android:windowActionBarOverlay 属性设置为 true

另请查看在[Android 开发人员上叠加操作栏](http://developer.android.com/training/basics/actionbar/overlaying.html)

# wpf - MVVM Light 将参数传递给子视图模型

> ID：14885606
> 
> 赞同：1
> 
> 时间：2013-02-14T22:57:57.290
> 
> 标签：wpf, datagrid, viewmodel, mvvm-light, viewmodellocator

我是 MVVM 和 WPF 的新手。

我正在使用 MVVM Light 制作一个应用程序，该应用程序在一个窗口中包含一个 DataGrid，该窗口具有一个视图模型 (MainViewModel) 和另一个用于在 DataGrid 中添加和编辑记录的窗口，该窗口也有自己的视图模型 (EditViewModel)。

我担心的是我用来从 MainViewModel 打开添加/编辑窗口的方法。在 MainViewModel 中，我有一个属性 SelectedItem，它绑定到 DataGrid 的 SelectedItem 属性和一个 IsEdit 布尔属性，指示是否应在添加或编辑模式下启动添加/编辑窗口。

当添加/编辑窗口在编辑模式下打开时，在其视图模型的构造函数中，我有以下行：

```
 MainViewModel mainViewModel = ServiceLocator.Current.GetInstance<MainViewModel>(); 
```

这显然检索了 MainViewModel 的当前实例，它工作得非常好，但我不确定这是不是最好的方法。

此外，如果我有多个主窗口实例，它们使用相同的 MainViewModel 实例，并且我从它们两者中打开一个添加/编辑窗口的实例，则添加/编辑窗口将从同一个实例获取数据MainViewModel 这可能是一个问题。

如果我尝试为打开的每个 MainWindow 创建一个新的 MainViewModel 实例，那么我不知道如何将当前使用的 MainViewModel 的实例传递给 EditViewModel。

我希望我清楚我需要做什么。告诉我我是否遗漏了什么，我会添加它：）

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T02:14:15.860

嗨，如果我没有误解你的问题不正确，你可以这样做： **因为我在 MainView 和 EditView 中都需要 IsRequired 依赖属性，所以我创建了一个扩展 Window 类的类**

```
public class ExtendedWindow:Window
{
    public static readonly DependencyProperty IsRequiredProperty = DependencyProperty.Register("IsRequired", typeof(bool), typeof(ExtendedWindow));

    public bool IsRequired
    {
        get { return (bool)GetValue(IsRequiredProperty); }
        set { SetValue(IsRequiredProperty, value); }
    }
} 
```

**主视图和视图模型**

```
 public partial class MainWindow:ExtendedWindow
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = new MainViewModel();
    }
    private void Button_Click(object sender, RoutedEventArgs e)
    {
        EditView editView = new EditView();
        **((EditViewModel)editView.DataContext).IsRequired = this.IsRequired;**
        editView.Show();
    }
}

public class MainViewModel : INotifyPropertyChanged
{
    public MainViewModel()
    {
        IsRequired = true;
    }
    private bool isRequired;
    public bool IsRequired
    {
        get { return isRequired; }
        set { isRequired = value; Notify("IsRequired"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void Notify(string propName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propName));
    }
} 
```

**编辑视图和视图模型**

```
public partial class EditView:ExtendedWindow
{
    public EditView()
    {
        InitializeComponent();
        DataContext = new EditViewModel();
    }
}

public class EditViewModel : INotifyPropertyChanged
{
    private bool isRequired;
    public bool IsRequired
    {
        get { return isRequired; }
        set { isRequired = value; Notify("IsRequired"); }
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void Notify(string propName)
    {
        if (PropertyChanged != null)
            PropertyChanged(this, new PropertyChangedEventArgs(propName));
    }
} 
```

这只是一种假动作，但可以让您了解如何做到这一点。我已经在假人中尝试过它并且工作正常。

# javascript - Ace 编辑器设置语言模式和主题时出错

> ID：14885607
> 
> 赞同：2
> 
> 时间：2013-02-14T22:58:08.590
> 
> 标签：javascript, cloud9-ide, ace-editor

我通过 bower 加载了[ace](https://github.com/ajaxorg/ace-builds/)，我可以创建一个编辑器就好了。但是，我似乎无法设置主题和语言模式。这些是我的包含行：

```
 script(src='components/ace-builds/src/ace.js')
    script(src='components/ace-builds/src/mode-xml.js')
    script(src='components/ace-builds/src/theme-solarized_light.js') 
```

这是我的错误：

```
Uncaught TypeError: Cannot read property 'cssText' of null ace.js:12316
afterLoad ace.js:12316
(anonymous function) ace.js:12307
_require ace.js:94
req ace.js:152
(anonymous function) ace.js:12303

Uncaught TypeError: Cannot read property 'Mode' of null ace.js:5309
done ace.js:5309
_require ace.js:94
req ace.js:152
(anonymous function) ace.js:5302 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-26T10:14:24.100

该错误是由您设置模式的方式引起的。很可能您正在做类似的事情，`session.setMode("components/ace-builds/src/mode-xml.js")`但 ace 找不到该路径的模式。你应该这样称呼它`session.setMode("ace/mode/xml")`。

# radio-button - Toggle 和它背后的 RadioButton 之间的链接？

> ID：14885608
> 
> 赞同：0
> 
> 时间：2013-02-14T22:58:04.170
> 
> 标签：radio-button, toggle, javafx-2

成像，例如共享一个 ToggleGroup 的 2 个 RadioButtons。使用

```
ToggleGroup.getToggles() 
```

可以访问 ToggleGroup 的所有切换。但是是否有任何从 Toggle 到链接到的 RadioButton 的引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T08:56:22.207

如果我正确理解了您正在寻找的问题：

```
RadioButton button = (RadioButton) toggleGroup.getSelectedToggle(); 
```

不幸的是，ToggleGroup 还没有“通用”，所以你需要演员表。

> 但是是否有任何从 Toggle 到链接到的 RadioButton 的引用？

或者换句话说： RadioButton 是一个（实现）切换，没有任何参考。

# java - 访问java中私有类中声明的变量

> ID：14885611
> 
> 赞同：-1
> 
> 时间：2013-02-14T22:58:19.510
> 
> 标签：java, class, private, accessor

这是我的代码。

```
private void btnloginActionPerformed(java.awt.event.ActionEvent evt) {                                         
    String username = "";
    String sql = "select * from userinfo where uname=? and pword=?";
    try{
        pst = conn.prepareStatement(sql);
        pst.setString(1, txt_username.getText());
        pst.setString(2, txt_password.getText());

        rs=pst.executeQuery();
        if(rs.next()){
            afterLogin pwcorrect = new afterLogin();
            pwcorrect.setVisible(true);
            this.setVisible(false);
            username = txt_username.getText();
        }
        else{
            JOptionPane.showMessageDialog(null, "Username and Password are Incorrect.");
        }
    }
    catch(Exception e){

        JOptionPane.showMessageDialog(null, e);
    }
} 
```

我需要从另一个类访问用户名的值。有什么办法吗？？？请帮我写代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:02:34.730

这不仅仅是在类中定义的，而是在类中的*方法*中定义的。

这不是“私有”变量（或类），就其他类而言，它是一个*不可见的变量。*使用公共 getter 公开它，或提供一种机制，代码可以将其设置在其他东西上。

由于这是一个动作处理程序，您还需要确保仅在设置变量后才能访问该变量，或者尽管访问它，但可以处理它*没有*值。

* * *

```
public class WhateverClassThisIs {

    private String username;

    public String getUsername() { return username; }

    private void btnloginActionPerformed(java.awt.event.ActionEvent evt) {                                         
        String sql = "select * from userinfo where uname=? and pword=?";
        try {
            // As before, but:
            if (rs.next()) {
                username = txt_username.getText();
            }
        }
    }
}

public class SomeOtherClass {

    private WhateverClassThisIs theOtherClass;

    public void setTheOtherClass(WhateverClassThisIs theOtherClass) {
        this.theOtherClass = theOtherClass;
    }

    public void whatever() {
        String username = theOtherClass.getUsername();
    }
} 
```

另一种机制将依赖于`WhateverClassThisIs`使用用户名设置器传递一些东西，大致：

```
public class WhateverClassThisIs {

    private SomeOtherClass someOtherClass;

    public WhateverClassThisIs(SomeOtherClass someOtherClass) {
        this.someOtherClass = someOtherClass;
    }

    private void btnloginActionPerformed(java.awt.event.ActionEvent evt) {                                         
        String sql = "select * from userinfo where uname=? and pword=?";
        try {
            // As before, but:
            if (rs.next()) {
                someOtherClass.setUsername(txt_username.getText());
            }
        }
    }
}

public class SomeOtherClass {

    private String username;

    public void setUsername(String username) {
        this.username = username;
    }

    public void whatever() {
        // Do something with username--but either try
        // after you know it's been set, or by being
        // able to handle it being null/empty/whatever
    }
} 
```

此外，您可以使用一个`Observer`，任何几个 Swing-ish 机制，等等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:03:23.567

是的，有办法使用反射来做到这一点......如果变量是一个字段。

但最好的解决方案是更改另一个类，使其具有可访问的 getter 和/或 setter 方法……在您考虑了所有含义之后。

打破类封装以访问私有状态是您在不得已的情况下才应该做的事情。

* * *

如果变量是局部变量，则其他类或方法无法更新它。如果该类是本地声明的匿名内部类并且变量声明为`final`. 这听起来不像你在这里想要做的......

# javascript - 跨文件覆盖 js 函数的计时问题

> ID：14885615
> 
> 赞同：0
> 
> 时间：2013-02-14T22:58:24.937
> 
> 标签：javascript, jquery

在我的 rails 项目中，我编写了一个 javascript 函数来覆盖另一个文件中定义的另一个对象的默认行为。执行此操作的行看起来像：

```
window.someObject.methodToOverride = function... 
```

最初这会给我一个`cannot set property 'methodToOverride' of undefined`错误，我假设这与时间问题有关（`someObject`尚未设置）。我能够通过将其放入 jQuery`$(document).ready`函数中来解决该问题，但是虽然这可行，但对我来说似乎有点 hacky。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:23:08.120

这听起来像您正在寻找[require.js](http://requirejs.org)。它的作用是让您以模块化方式设置代码，定义哪个模块取决于哪个模块。在您的情况下，一旦设置好，通过放置一个包装器，例如

```
require(["someObject"], function (someObject) {
    someObject.methodToOverride = function...
} 
```

当你使用这个函数时，require.js 会动态加载你的 someObject 文件，当它完全加载时，将 someObject 作为参数传递给你提供的函数。它可以处理更复杂的示例，具有任何级别和任何数量的依赖项，根据需要加载它们不超过一次。

您可以在整个 SO 中找到有关 require.js 的更多信息，例如：

*   [使用 require.js 的简单示例](https://stackoverflow.com/questions/10485039/simple-example-for-using-require-js)
*   [Require.js 嵌套需求](https://stackoverflow.com/questions/10719355/require-js-nested-requires)

# css - 浏览器 - 插入 td 导致嵌套表上方的空间

> ID：14885616
> 
> 赞同：0
> 
> 时间：2013-02-14T22:58:30.607
> 
> 标签：css, html, html-table

我有以下标记（简化了，但存在同样的问题）

```
<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>table test</title>
</head>

<body>
<table style="border:2px blue solid; border-collapse:collapse; border-spacing:0;">
    <tr>
        <td >root table cell</td>
    </tr>
    <tr>
        <td style="border:2px green solid;">
        <table style="border:2px red solid; border-collapse:collapse; border-spacing:0;">
                <tr>
                    <td>some content</td>
                </tr>
                <tr>
                    <td><a href="ruleDoc.html">some link</a></td>
                </tr> 
            </table>
        </td>
    </tr>
</table>
</body>
</html> 
```

问题是，嵌套表上方有一个空间。查看使用 Chrome 开发人员工具的实时标记，这是嵌套表的上方：

```
 &nbsp; 
```

这是一个不间断的空格，后面有一个回车符，导致该空格。但在我的标记中它不存在。我怎样才能让它消失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:09:53.427

弄清楚了。`</tr>`标签后有一个不间断的空格。它不是常规空格，因为我无法通过在 tr 标签后输入空格来重现问题。但我可以削减空间，刷新页面，然后它就消失了。粘贴在空间中，它又回来了。

从字面上看，一个看不见的问题！

# html - 如何写这个：不是“在其他元素中”CSS规则？

> ID：14885621
> 
> 赞同：3
> 
> 时间：2013-02-14T22:59:09.700
> 
> 标签：html, css, css-selectors

这是html布局

```
<div class="wrap">
    <div class="section">
        <span class="text">text1</span>
    </div>
    <span class="text">text2</span>
<span class="not-text">don't color me!</span>
</div> 
```

我试图为不在“部分”div中的所有“文本”跨度赋予样式。我试过这个，但它似乎不起作用

```
.wrap :not(.section) .text 
```

[小提琴](http://jsfiddle.net/4zns2/34/)

任何帮助是极大的赞赏！

编辑：这种情况有几种解决方法，包括在“.wrap > .text”中使用 > 运算符，但我想知道如何使 :not 选择器工作，以便将来使用它

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:42:33.540

当您使用 时`.wrap :not(.section) .text`，这就是您告诉浏览器的内容：

1.  查找具有类的元素`.text`
2.  它存在于一个没有类的元素中`.section`
3.  它存在于具有类的元素中`.wrap`

如果您仔细查看您的标记，您的元素都不符合该选择器标准。

在您提供的标记中，我认为您不能专门选择那些`.text`不是`.section`using后代的元素`:not()`。

最接近的方法是使用直接后代选择器，如下所示：

```
.wrap > .text 
```

您还可以选择并设置 的所有`.text`后代`.wrap`（无论是否直接），然后取消`.text`内部任何元素的这些样式`.section`，如下所示：

```
.wrap .text {
  // your styles here
}

.wrap .section .text {
  // your cancelled styles here
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:09:58.973

您可能可以使用：

```
.wrap > span
.wrap > *:not(div)
.wrap > *:not(.section) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:01:16.777

鉴于 CSS 的约束，最好的选择是为所有文本编写规则，然后将它们覆盖回 .section 中的先前值。所以

```
.wrap .text {
   // the styles you want
}

.wrap .section .text {
  // styles undoing the styles above... depending on what the styles are it may not always be possible

} 
```

# php - RewriteRule 中是否有 Apache 的 END 标志的替代方法？

> ID：14885622
> 
> 赞同：0
> 
> 时间：2013-02-14T22:59:10.340
> 
> 标签：php, apache, mod-rewrite

我的应用程序的根目录中有这个简单的 .htaccess：

```
RewriteEngine on

RewriteCond $1 !^(index\.php)(/.*)?$
RewriteRule ^(.*)$ index.php/$1 
```

我想删除该`RewriteCond`行，以便始终重写请求，即使请求 uri 是`/index.php/foo/bar`例如。我认为它会是这样的：

```
RewriteEngine on

RewriteRule ^(.*)$ index.php/$1 [END] 
```

该`END`标志是必要的，因此服务器不会进入永恒循环。问题是我的 Apache（2.22.22 -wamp）不支持这个标志（只有 2.3.9 及更高版本）。我可以获得更新的服务器或其他东西，但我想确保我的应用程序也不会在旧服务器上刹车。我可以在这里做什么？

# javascript - 本地实例参考

> ID：14885628
> 
> 赞同：0
> 
> 时间：2013-02-14T22:59:42.530
> 
> 标签：javascript, design-patterns

在javascript中说我有：

```
var Person = (function () {

    function Person(data) {
        data = $.extend({
            name: "",
            age: 0
        }, data);

        this.name = data.name;
        this.age = data.age;
    }

    return Person;
})();

Person.prototype.getName = function () {
    return this.name;
}; 
```

...如果我在 javascript 中正确理解了“this”关键字，它可以引用几乎任何东西，从窗口对象到自身，再到介于两者之间的任何东西（例如对象的调用者）。我的问题是我到底如何编写像 .getName() 这样的方法，以便我知道如果我永远无法确定“this”将指的是什么，我将始终引用存储在 person 对象的 name 属性中的值那个方法？假设 .getName() 被调用并且“this”引用了窗口对象——那么我如何获得我需要的值呢？

我之所以问，是因为我已经使用相当繁重的原型设计继承了一些代码，并且我遇到了各种各样的问题，试图从它们内部引用对象的属性和方法。好像我遗漏了一些东西，但我整天都在研究范围、闭包和其他模式，但我无法解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:22:51.047

的值`this`由语言根据函数/方法的调用方式设置。

如果您有一个带有方法的对象并且您这样做：

```
obj.method() 
```

然后，`this`将被设置为指向`method()`函数里面的对象。

但是，如果你只是像这样单独获得该方法：

```
var p = obj.method;
p(); 
```

然后，因为在实际的函数调用中没有对象引用，`this`将设置为`window`或者`undefined`取决于您是否处于严格模式。

此外，调用者可以使用或什至或从前面的示例准确指定他们想要`this`设置的内容。您可以在 MDN 上查看这些方法，以了解有关它们如何工作的更多详细信息。`obj.method.call()``obj.method.apply()``p.call()``p.apply()`

因此，在您之前的代码中，这应该有效：

```
function Person(data) {
    data = $.extend({
        name: "",
        age: 0
    }, data);

    this.name = data.name;
    this.age = data.age;
}

Person.prototype.getName = function () {
    return this.name;
};

var p = new Person({name:"John"});
var n = p.getName();   // will return "John" 
```

工作演示：http: [//jsfiddle.net/jfriend00/a7MkP/](http://jsfiddle.net/jfriend00/a7MkP/)

* * *

如果您需要传递`getName()`给不会使用对象上下文调用它的第三方库，那么有如下几个选项：

匿名函数：

```
var myPerson = new Person("John");
callThirdParty(function() {
    // callback that calls getName with the right object context
    return myPerson.getName();
}); 
```

使用`.bind()`（在某些较旧的浏览器中不支持）：

```
var myPerson = new Person("John");
var boundFn = myPerson.getName.bind(myPerson);
callThirdParty(boundFn); 
```

从你自己的方法：

```
var self = this;
callThirdParty(function() {
    // callback that calls getName with the right object context
    return self.getName();
}); 
```

* * *

`Person`仅供参考，您的构造函数周围的自执行函数确实没有理由。它只是使代码更复杂，在这种情况下没有任何价值。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-14T23:18:30.227

是的，您正确理解了[`this`关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)。

> 我到底是如何编写 .getName() 之类的方法，以便我知道我将始终引用存储在 person 对象的 name 属性中的值

您只能通过不使用`this`, 和不使用原型来做到这一点。给每个对象一个始终引用原始对象的唯一函数：

```
function Person(data) {
    data = $.extend({
        name: "",
        age: 0
    }, data);

    this.name = data.name;
    this.age = data.age;

    var that = this; // a reference variable always pointing to this instance
    this.getName = function() {
        // using the variable from the constructor closure
        return that.name; // a quite useless getter
    };
}

var john = new Person({name:"John"}),
    getter = john.getName;
getter(); // "John" 
```

> 我遇到了各种各样的问题，试图从自身内部引用对象的属性和方法

因此，通过上述方法，您可以通过使所有方法都特定于实例来解决它。但是，这会破坏原型设计的所有优势，因此**不应使用**.

相反，调用函数（或方法）的人应该负责在正确的上下文中调用它：

```
john.getName(); 
```

如果你真的必须将一个函数传递给忽略它的人（比如`addEventListener`），你可以使用类似的魔法东西[`.bind()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)或者只是应用上面的模式：

```
// from
addEventListener("click", john.sayHello); // will call the function in context of the DOM
// to
addEventListener("click", function() {
    john.sayHello(); // correct thisValue
}); 
```

# clojure - 如何找到连接重置错误的来源

> ID：14885631
> 
> 赞同：1
> 
> 时间：2013-02-14T22:59:47.037
> 
> 标签：clojure, iis-6

我在哪里可以找到连接重置错误的来源？以下是详细信息：

我有一个使用`clj-http.client`.

我需要追踪发送以下错误的原因

```
Feb 14, 2013 5:16:04 PM 
org.apache.http.impl.client.DefaultRequestDirector execute
INFO: I/O exception (java.net.SocketException) 
caught when processing request: Connection reset
Feb 14, 2013 5:16:04 PM 
org.apache.http.impl.client.DefaultRequestDirector execute
INFO: Retrying request 
```

我们查看了服务器的 IIS 日志，找不到任何表明连接重置的错误。我们还查看了服务器的事件日志，找不到与我在客户端中遇到的错误相匹配的错误。事实上，IIS 日志看起来还不错。我可以在日志中看到我的地址验证“GET”请求。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:12:34.680

这只是一个猜测，尽管当 Web 服务器配置为响应错误的主机名时，我经常收到该错误消息。如果它为 www.example.com/my/service 提供服务，并且我打开到 1.2.3.4/my/service 的连接，那么它会挂起“连接重置”。

# javascript - for循环后代码恢复

> ID：14885632
> 
> 赞同：0
> 
> 时间：2013-02-14T22:59:50.333
> 
> 标签：javascript

我在使用以下代码时遇到问题。当我点击一个链接时，我应该只能看到相应的部分。通过添加警报，我看到脚本隐藏了正确的元素，但在循环运行后一切都恢复正常。此外，如果我将 onClick 事件更改为 onMouseOver，则隐藏元素会在循环完成后保持隐藏状态。

```
<html>

<head>
<script>

function switchTabs(clicked)
{
    var tab = clicked.innerHTML;
            var content = document.getElementsByTagName('section');

    for(var i=0; i<content.length; i++)
    {
        if(content[i].id && content[i].id.indexOf(tab) !=  -1)
        {
            content[i].style.display = 'inline';
        }
        else
        {
            content[i].style.display = 'none';
        }
    }

}

</script>

</head>

<body>
<nav>
    <ul>
        <li><a href='' onClick='switchTabs(this);'>Javascript</a></li>
        <li><a href='' onClick='switchTabs(this);'>Ajax</a></li>
        <li><a href='' onClick='switchTabs(this);'>PHP</a></li>
    </ul>
</nav>
<section id='JavascriptSection'>
    <h1>Javascript Section</h1>
</section>

<section id='AjaxSection'>
    <h1>AJAX Section</h1>
</section>

<section id='PHPSection'>
    <h1>PHP Section</h1>
</section>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:10:25.967

添加 return false 并提供适当的 href。发生的事情是由于超链接默认操作，页面每次都重新加载。另请注意，这仅适用于第一次，因为第二次其他部分将无法用于 id 比较。

```
<html>

<head>
<script>

function switchTabs(clicked)
{
    var tab = clicked.innerHTML;
            var content = document.getElementsByTagName('section');

    for(var i=0; i<content.length; i++)
    {
        if(content[i].id && content[i].id.indexOf(tab) !=  -1)
        {
            content[i].style.display = 'display';
        }
        else
        {
            content[i].style.display = 'none';
        }
    }
    return false;
}

</script>

</head>

<body>
<nav>
    <ul>
        <li><a href='#' onClick='switchTabs(this);'>Javascript</a></li>
        <li><a href='#' onClick='switchTabs(this);'>Ajax</a></li>
        <li><a href='#' onClick='switchTabs(this);'>PHP</a></li>
    </ul>
</nav>
<section id='JavascriptSection'>
    <h1>Javascript Section</h1>
</section>

<section id='AjaxSection'>
    <h1>AJAX Section</h1>
</section>

<section id='PHPSection'>
    <h1>PHP Section</h1>
</section>
</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:05:38.567

将您的“onclick”属性更改为：

```
<a href='' onClick='return switchTabs(this);'>Javascript</a> 
```

并添加

```
 return false; 
```

到函数结束。通过这样做，您可以防止`<a>`标签的默认行为发生。

（正如我在评论中指出的那样，您还需要使用“块”而不是“显示”来使部分可见。）

# assembly - 如何从键盘读取字符并将其保存到 DOS 程序集中的文件中？

> ID：14885635
> 
> 赞同：2
> 
> 时间：2013-02-14T23:00:05.153
> 
> 标签：assembly, input, x86, dos

我正在使用 3Ch 函数创建文件并使用 40h 函数保存字符（我在[这里](http://spike.scu.edu.au/~barry/interrupts.html#ah01)阅读过）

我不明白如何将读取字符放入`DS:DX`.

这是我的代码：

```
org 100h
bits 16

section .data
    file DB 'file.txt',0

section .bss
    file_handle resw 1

; CREATE FILE
section .text
    mov DX, file 
    mov CX, 0000h
    mov AH, 3Ch
    int 21h

; START INPUT
INPUTSTART:
    mov AH,01h
    int 21h

    ; SAVE INPUT TO FILE
    mov SI, file_handle
    mov BX, [SI]
    mov CX, 0001h
    mov AH, 40h
    int 21h

   jmp INPUTSTART

    mov AH,4Ch
    int 21h 
```

如您所见，程序旨在循环工作并编写与用户类型一样多的字符。请帮助获取 40h 函数的文件句柄并将数据放入`DS:DX`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:06:56.840

根据代码的语法，我猜您正在使用 NASM 并尝试创建一个 .COM 程序。

.COM 程序的代码从文件的最开头开始，也没有将文件划分为逻辑部分，因此您不能首先放置数据部分（例如 .data 或 .bss），它不会甚至定义这样的部分也很有意义。

因此，您的代码应如下所示：

```
org 100h
bits 16

; code begins here
; then goes data 
```

或者

```
org 100h
bits 16

jmp start
; here goes data
start:
; here goes the rest of code 
```

接下来，函数 3Ch 返回一个文件句柄在`AX`. 您可以使用此句柄对文件执行进一步的操作（例如读取、写入、关闭）。您的代码没有将这个句柄隐藏在 中`file_handle`，我猜这正是为此目的而定义的，并且它通过覆盖`AX`with的值来丢弃它`mov AH,01h`。你需要解决这个问题。

在程序结束时，您必须使用函数 3Eh 关闭文件。如果您不这样做，该文件最终可能只包含已写入其中的部分数据，在您重新启动 PC 之前，该文件可能无法访问，并且您也可能无法打开（或创建）更多文件如果您积累了足够多的未关闭文件句柄。所以，最后关闭文件。

至于将字符保存在文件中，没有什么能阻止您定义一个字节变量，例如`key`，存储`AL`到其中，然后将地址传递`key`给函数 40h，例如：

```
...
mov AH,01h
int 21h
mov [key], AL

; SAVE INPUT TO FILE
mov BX, [file_handle]
mov DX, key
mov CX, 0001h
mov AH, 40h
int 21h
...
file_handle dw 0
key db 0
... 
```

另外，不要忘记指定一些键来打破您现在在程序中拥有的无限循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T00:08:29.167

实际上，您没有将字符*放入 中* `ds:dx`，而是`ds:dx`用于*引用*存储字符或任何数据的内存地址，在 Intel 语法中它会是`[ds:dx]`（但`dx`不能用于内存寻址）。

因此，您需要做的是：使用 DOS 中断`21h`/存储从键盘读取的值`ah = 01h`，返回`al`到某个内存地址，然后使用`ds:dx`.

在您的代码中，您根本不存储文件句柄，并`file_handle`在写入文件调用之前从变量中加载 0，因为这就是您初始化它的方式。然后您尝试从`ds:0`（`si`等于0）读取文件句柄，这根本没有意义。您需要对文件句柄做的就是存储它（`ax`在文件创建/截断后返回值）并在随后引用同一文件时始终将其加载到相关寄存器`int 21h`（写入文件、从文件读取、关闭文件等） .)。

所以，通过下面的修复它应该可以工作（没有测试）。我还将函数调用参数按照 Ralf Brown 的中断列表使用的顺序进行了组织，以便于理解。

```
.section data
file db 'file.txt',0
character_read db 0 
```

...

```
% create file:
    mov ah,3Ch             % create or truncate a file
    mov dx,file            % ds:dx points to ASCIIZ filename
    xor cx,cx              % file attributes.
    int 21h

    mov [file_handle], ax  % file handle must be stored in memory or in a register!

INPUTSTART:
    mov ah,1               % read character from STDIN, with echo.
    int 21h
    mov [character_read], al  % store the ASCII code to memory.

    % unless you want to loop eternally, you can check the ASCII code and exit.

    cmp al,20h             % space.
    je  EXIT

    mov ah,40h             % write to file or device
    mov bx,[file_handle]   % file handle is just a number.
    mov cx,1               % number of bytes to write.
    mov dx,character_read
    int 21h

    jmp INPUTSTART

EXIT:
    % here you can add some clean-up code, if needed.

    mov ah,3Eh             % close file.
    mov bx,[file_handle]   % here you need the file handle again.
    int 21h

    mov ah,4Ch
    int 21h 
```

# angularjs - 如何测试必须用 testacular 和 jasmine 呈现的 HTML

> ID：14885637
> 
> 赞同：4
> 
> 时间：2013-02-14T23:00:15.003
> 
> 标签：angularjs, jasmine, karma-runner

我想测试一个指令是否将正确的 jquery 函数绑定到 DOM 并且它们是否有效。

例如，我想测试一个元素在使用 $.slideUp() 向上滑动后是否可见，或者我想在 html 输入上执行单击事件。

看来我需要以某种方式将编译后的指令附加到 DOM 以实现这一点。我[在 youtube](http://www.youtube.com/watch?v=rB5b67Cg6bc)上观看了测试指令视频，他说这是可能的，但他没有提到你是如何做到的。

我有点卡住了。

这是失败测试的链接：[http ://plnkr.co/edit/PojXf8?p=preview](http://plnkr.co/edit/PojXf8?p=preview)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:50:11.307

几件事：

首先，如果你想在 Angular 中使用 jQuery，它需要在 Angular 之前加载，所以将它的 script 标签移到 Angular 之前。

其次，将指令附加到 DOM 是正确的。在`beforeEach`调用中，您可以使用 jQuery 创建主机 div，然后在`afterEach`调用中删除该 div。

[这是你的一个叉子](http://plnkr.co/edit/PT0AdW?p=preview)。

也就是说，您只需要 DOM 中的 div 来检查可见性，我什至不确定在大多数情况下您是否需要这样做。例如，您可以使用 Sinon 监视`slideUp`调用以确保它发生并依赖 jQuery 的测试它确实有效。

而且你总是可以直接通过`elm.click()`使用 jQuery 调用来触发点击。

# c# - 用于多个客户端数据库和 FTP 帐户的通用 Windows 服务

> ID：14885639
> 
> 赞同：0
> 
> 时间：2013-02-14T23:00:23.377
> 
> 标签：c#, .net, multithreading, windows-services

我必须构建一个 Windows 服务，从 n 个客户端数据库中获取数据，将结果集转换为 XLS 格式并以客户端指定的时间间隔将其发送到相应的（客户端特定的）FTP 帐户，

这是另一种说法：相同的 Windows 服务将连接到多个数据库，将文件发送到不同的 FTP 帐户，并根据它连接到的客户端数据库以不同的时间间隔运行。

我的问题是，我应该如何设计它才能灵活地处理多种场景并且更具可配置性。

这背后的基本思想是，当新客户要求相同的服务时，最大限度地减少未来的实施时间。

我正在考虑以下想法，其中可以将单个客户端设置为单独的工作线程。我知道这种方法存在严重问题，但似乎无法找出最佳方法。

这是部分代码：

```
private static void Main(string[] args)
{
// Initialize the first worker thread.
        NewUserThread newUserThread     = new NewUserThread();

        // Specify properties of this worker thread.
        newUserThread.Name      = "New User Check";
        newUserThread.Delay     = 0;
        newUserThread.Interval  = 2 * 60 * 1000;

// Initialize the second worker thread.
        UserUpdateThread    userUpdateThread    = new UserUpdateThread();

// Specify properties of this worker thread.
        userUpdateThread.Name   = "User Update Check";
        userUpdateThread.Delay  = 30 * 1000;
        userUpdateThread.Interval= 5 * 60 * 1000;

// Initialize the first Windows service objects.
        WindowsService userCheckService = new WindowsService();
        userCheckService.ServiceName = UserCheckServiceName;

        // Initialize the second Windows service objects.
        WindowsService emailService = new WindowsService();
        emailService.ServiceName = EmailServiceName;

        // Add services to an array.
        ServiceBase[] services = new ServiceBase[] 
        { 

            userCheckService,
            emailService,
        };

        // Launch services.
        SendFiles("Launching services...");
        Run(services, args);

}

    internal static void (string message, params object[] args)
    {
        // Call to DB
        // Convert dataset to XLS
        // Send to FTP
    } 
```

如果我没有任何意义，请告诉我，我愿意探索一种全新的方法。

代码示例将有所帮助。

提前谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:47:38.963

好吧，我将编写架构的东西，以便应用程序在未来保持可扩展性。

使用的模式：依赖注入

创建一个名为*IDatabaseSources*的接口并在不同的数据源类中实现该接口

IDatabaseSource 接口的示例方法是 Connect(),FetchData()。当您在实现的类中编写 connect 方法时，从 web.config 中获取连接字符串。

**public class SQLDataSource:IDatabaseSources { 将拥有接口中定义的所有方法}**

**public class SQLDataSource2:IDatabaseSources{ 将拥有接口中定义的所有方法}**

创建一个名为*IFTPSources*的接口并在不同的类中实现该接口。

IDatabaseSource 接口的示例方法是 Connect(),SendData()。当您在实现的类中编写 connect 方法时，从 web.config 中获取 FTP 信息。

**public class FTPSource1:IFTPSources{ 将拥有接口中定义的所有方法}**

**public class FTPSource2:IFTPSources{ 将拥有接口中定义的所有方法}**

此外，这些依赖项应该根据您的调度程序注入到 Windows 服务中

虽然如果有 10 个 FTP 目标，那么您将有 10 个 FTP 源类。是的，它增加了类的数量，但这就是单一责任原则加上这样您就可以维护/扩展应用程序的方式。

# c++ - 如何在 C++ 中复制 const_iterator

> ID：14885641
> 
> 赞同：1
> 
> 时间：2013-02-14T23:00:29.093
> 
> 标签：c++, iterator

在我的头文件中，我有

```
template <typename T>
class Vector {
   public:
       typedef T* iterator;
       typedef const T* const_iterator;

       Vector(const_iterator start, const_iterator end);

       // other stuff ...

} 
```

在 .cpp 文件中我有

```
template <typename T>
Vector< T >::Vector( const_iterator start, const_iterator end ) : theSize( 0 ), theCapacity( 1 )
{
    array = new T[ theCapacity ];
    typename Vector< T >::iterator itr = start; // this is line 29
    for( iterator itr = start; itr != end; itr++ ){
        push_back( *itr );
    }
} 
```

但是编译器告诉我

```
Vector.cpp:29: error: invalid conversion from ‘const int*’ to ‘int*’ 
```

如何在将参数保留为 const_iterator 的同时解决此问题？

注意：如果它有帮助，我会尝试在开始和结束之间使用来自另一个 Vector 的元素构建一个 Vector。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:03:33.950

我也没有看到不在`const_iterator`循环中使用的原因。此外，您的`push_back`函数不应接受迭代器，而应接受值。

因此，我将相关部分重写如下：

```
typename Vector< T >::const_iterator itr = start;
for(const_iterator itr = start; itr != end; itr++ ){
    push_back(*itr);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:05:47.100

你应该做`push_back(*itr)`而不是`push_back(itr)`，这将解决你的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:40:59.740

for 循环只需要使用一个 const_iterator。迭代器的 const-ness 仅适用于它的值，它仍然可以递增。你也可以使用你已经拥有的。

```
Vector(const_iterator pos, const_iterator end)
{
    for( ; pos != end; pos++ ){
        push_back( *pos );
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T00:16:01.773

正如安迪所说，您需要一个 const 迭代器。如果您的编译器支持 C++11，您的代码将变为：

```
template <typename T>
Vector< T >::Vector( const_iterator start, const_iterator end ) : 
theSize( 0 ), 
theCapacity( 1 )
{
    array = new T[ theCapacity ];
    for( auto itr = start; itr != end; itr++ ){
        push_back( *itr );
    }
} 
```

我还要问：你确定要手动滚动你自己的 Vector 吗？你有充分的理由不使用 std::vector 吗？

# android - 在 Intellij UI Designer 中显示片段的默认内容

> ID：14885642
> 
> 赞同：3
> 
> 时间：2013-02-14T23:00:30.373
> 
> 标签：android, android-layout, intellij-idea, android-fragments, android-listfragment

有什么方法可以为通常在运行时加载的 Android 片段中的 xml 元素设置某种类型的占位符，以便我可以预览布局？例如，我正在使用扩展 Android ListFragment 的自定义片段，并且我需要一些占位符列表项才能使用 IntelliJ UI 设计器设计布局。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T19:21:26.063

将图像放在您想要测试的任何分辨率的可绘制文件夹中。[可以在Placehold.it](http://placehold.it/)等网站上快速创建图像。对于 listView，您可以多次引用图像的 id。

# c - void数组，C中的动态大小变量

> ID：14885643
> 
> 赞同：1
> 
> 时间：2013-02-14T23:00:39.487
> 
> 标签：c, pointers, void

好的，所以我会尝试清楚地解释我的问题。

我想要一个函数，它可以根据元素的大小以及元素中变量的偏移量和大小（用于结构）对任何数组进行排序。

所以我的功能看起来像：

```
void sort(void* array, size_t elem_size, int elem_count, size_t operand_offset, size_t operand_size) 
```

array 是指向数组开头的指针

elem_size 是数组中一个元素的大小

elem_count 是数组中元素的计数

operand_offset 是元素内作为排序基础的变量的偏移量（如果元素只有一个变量，则为 0，但如果元素是结构，则可能更多）

操作数大小是该变量的大小

在这个函数中，我需要创建一个临时变量，我会这样做：

```
void* temp = malloc(elem_size);
*temp = *(array+ i*elem_size); 
```

但编译器不同意：取消引用 void* 指针，他不知道我的临时变量的大小......

我知道我可以逐个字节地做到这一点，但我想知道是否有更好的方法。

所以我的问题是：如何将指针的“大小”设置为 elem_size ？

附加问题：如果大小已知，我可以键入 array[i] 来访问元素吗？

* * *

**编辑** 好的，所以我的问题解决了我必须使用 memcpy

但现在我遇到了另一个我没想到的问题。

给定元素内操作数的大小和偏移量，我如何提取它并进行比较？

有点像：

```
void *a = malloc(operand_size);
void *b = malloc(operand_size);
memcpy(a, array+i*elem_size + operand_offset, operand_size);
memcpy(b, array+j*elem_size + operand_offset, operand_size);

if (a < b)
...
else
... 
```

我怎样才能做到这一点？

* * *

**编辑 2: ** 好吧，最后为每个大小的操作数管理一个 if 语句太复杂了，所以我做了一些完全不同的事情

所以基本上我有一个`void *array`包含 n 个元素的元素，我正在编写一个函数来对其进行排序。

但是我没有直接给出元素内操作数的偏移量和大小，而是给了函数另一个函数来比较两个元素。效果很好

```
int compareChar(void* a, void* b);
int compareShort(void* a, void* b);
int compareInt(void* a, void* b);
int compareLong(void* a, void* b);
int compareFOO(void* a, void* b);

void sort(void* array, size_t elem_size, int elem_count, int (*compare)(void*,void*)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:05:01.207

你不能只使用 memcpy 吗？这可能会以最有效的方式进行。

```
uint8_t* temp = malloc(elem_size);
memcpy(temp, array + i * elem_size, elem_size); 
```

# vim - 在 vim 中映射 Alt-j 和 Alt-k

> ID：14885647
> 
> 赞同：0
> 
> 时间：2013-02-14T23:01:02.983
> 
> 标签：vim

所以我的`.vimrc`文件中有这个：

```
nnoremap <A-j> 5j
nnoremap <A-k> 5k 
```

我期望这样做是允许我按 Alt+j / Alt+k 以便一次上下移动 5 行，或使用`5<A-j>`向下移动 25 行（5 * 5 = 25）。相反，它什么都不做。谁能让我知道我在这里做错了什么？

**编辑：**我已经通过使用以下代码解决了这个问题：[https ://stackoverflow.com/a/10216459/2061838](https://stackoverflow.com/a/10216459/2061838)

# iphone - iPhone 模拟器继续无法加载带有错误 sigabrt 的网页

> ID：14885649
> 
> 赞同：1
> 
> 时间：2013-02-14T23:01:08.957
> 
> 标签：iphone, browser, sigabrt

我正在从头开始构建一个 Web 浏览器，除了最重要的事情之外，大多数东西都可以正常工作。浏览器将因错误 sigabrt 而失败，虽然我是 iPhone 编程的新手，但我很确定这意味着我没有正确发送 URL。

这是通过按下按钮加载网页的代码。

```
- (IBAction)getURLButton:(NSString *)aString {
NSURL *URL = [NSURL URLWithString:aString];
NSURLRequest *URLRequest = [NSURLRequest requestWithURL:URL];
BOOL load = [addressBar webView: (goButton) shouldStartLoadWithRequest:URLRequest navigationType:UIWebViewNavigationTypeFormSubmitted];
if (load) {
    error = nil;
    [goButton loadRequest:URLRequest];
    //currentURLString = [UIWebView stringByEvaluatingJavaScriptFromString:@"document.location.href"];
    //It's not in Xcode? It continues to get an error after I write the above statement.
} else {
    NSString *message = NSURLErrorFailingURLErrorKey;
    NSLog(@"%@",message);
} 
```

}

这是错误消息：

```
2013-02-14 16:49:28.724 WebBrowser[1265:c07] -[ViewController getURL:]: unrecognized selector sent to instance 0x716f1d0
2013-02-14 16:49:28.727 WebBrowser[1265:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[ViewController getURL:]: unrecognized selector sent to instance 0x716f1d0' 
```

我知道某处的错误，我只是不知道在哪里。帮助？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-15T00:14:54.190

```
 2013-02-14 16:49:28.724 WebBrowser[1265:c07] -[ViewController getURL:]: unrecognized selector sent to instance 0x716f1d0
 2013-02-14 16:49:28.727 WebBrowser[1265:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[ViewController getURL:]: unrecognized selector sent to instance 0x716f1d0' 
```

如果您看到您的异常，您正在调用**getURL:**，因为您的方法名称是**getURLButton:**。

# c# - C# Winforms 与 Mono SQL Server 故障

> ID：14885652
> 
> 赞同：0
> 
> 时间：2013-02-14T23:01:10.907
> 
> 标签：c#, winforms, sql-server-2008, mono

我是 Mono 的新手，我正在尝试做一些非常基本的概念验证测试，以使用 Mono 运行 winforms 应用程序。我在 VS2012 中构建了一个非常简单的应用程序（基本上只有一个按钮和一些数据访问代码），然后通过 MoMA 运行它，一切都检查出来了。但是，当我尝试使用 Mono（使用 Mono-2.10.9 命令提示符）运行我的 .exe 时，我在错误日志中收到以下错误：

```
Unhandled Exception: System.NullReferenceException: Object reference not set to an  
instance of an object
at Mono.Data.Tds.Protocol.TdsConnectionPool.GetConnection () [0x00000] in <filename
unknown>:0
at System.Data.SqlClient.SqlConnection.Open () [0x00000] in <filename unknown>:0
at MonoWinForm1.DataAccess.ExecuteSQLSelect (ConnectionStrings connectionString,
System.String sql) [0x00000] in <filename unknown>:0 
at MonoWinForm1.Form1..ctor () [0x00000] in <filename unknown>:0
at (wrapper remoting-invoke-with-check) MonoWinForm1.Form1:.ctor ()
at MonoWinForm1.Program.Main () [0x00000] in <filename unknown>:0 
```

我使用这篇文章作为模型：[http](http://www.mono-project.com/Guide:_Porting_Winforms_Applications) ://www.mono-project.com/Guide:_Porting_Winforms_Applications 。这似乎表明您可以使用 C# 在 VS2012 中编写和构建，并且只需使用 Mono 运行，但显然数据代码并非如此。这是导致异常的方法：

```
DataSet results = new DataSet();

using (SqlConnection connection = new SqlConnection(GetConnectionString(connectionString)))
{
    using (SqlCommand command = new SqlCommand(sql, connection))
    {
        connection.Open();
        command.CommandType = CommandType.Text;
        command.CommandTimeout = Int32.Parse(ConfigurationManager.AppSettings["SQLCommandTimeout"]);

         SqlDataAdapter adapter = new SqlDataAdapter(command);
         adapter.Fill(results);
    }
} 
```

我确信它比仅仅构建你的应用程序并在 Mono 中运行它更复杂，所以如果有人能引导我朝着正确的方向前进，我将非常感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:37:03.713

我现在开始工作了，对列出的代码没有任何更改！我在一个类中定义了其他几个 SQL 访问方法，它一定是其中之一导致了错误。不知道为什么我没有调用的方法会导致异常，但这就是正在发生的事情，并且异常只是没有提供任何指导。无论如何，感谢您提供帮助。对不起，莫诺不公正地指责你。

# html - 语义标记：地址，em

> ID：14885653
> 
> 赞同：0
> 
> 时间：2013-02-14T23:01:11.207
> 
> 标签：html, semantic-markup

我正在写一个标记并对这部分有疑问：
![主要联系人](../Images/fb1f81e756808bda63a64a19167bd472.png)

这是我的标记：

```
 <ul class="primaryContacts">
        <li><address>Phone: <em class="headerPhone">1.800.corp</em></address></li>
        <li><address>Email: <em class="headerEmail">office@corpora.com</em></address></li>
        <li><address>Follow Us: <a href="#" class="headerRSS"></a><a href="#" class="headerTwitter"></a><a href="#" class="headerFacebook"></a></address></li>
    </ul> 
```

我是否以正确的方式使用了标签`address`，`em`或者可能有更多的语义标签？也许还有其他错误..感谢大家的帮助。
**[编辑]：**
根据我写的答案：

```
 <ul class="primaryContacts">
            <li>Phone: <span class="headerPhone">1.800.corp</span></li>
            <li>Email: <span class="headerEmail">office@corpora.com</span></li>
            <li>Follow Us: <a href="#" class="headerRSS"></a><a href="#" class="headerTwitter"></a><a href="#" class="headerFacebook"></a></li>
        </ul> 
```

这个联系信息真的不是我的，据我所知`address`，这里没有任何关系。我也改变了`em`'s on `span`'s。感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:09:56.060

我认为你使用`<address>`错误的方式。根据您可以[从规范](http://www.w3.org/html/wg/drafts/html/master/sections.html#the-address-element)中读取的内容，拥有代码的更好方法是将其`<address>`作为父级。此外，这`<em>`是[指定强调重点](http://html5doctor.com/i-b-em-strong-element/)，但事实并非如此。所以你应该摆脱它。但是，如果你想要它的样式不同，你可以使用一个`<span>`元素来让你的 CSS 挂钩：

```
<address>
  <ul class="primaryContacts">
   <li>Phone: <span class="headerPhone">1.800.corp</span></li>
   <li>Email: <span class="headerEmail">office@corpora.com</span></li>
   <li>Follow Us: <a href="#" class="headerRSS"></a><a href="#" class="headerTwitter"></a><a href="#" class="headerFacebook"></a></li>
  </ul>
</address> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:10:46.887

该`address`元素被定义为提供有关文档作者的联系信息。这看起来不像这样的联系信息。然而，`address`除了某些浏览器中的一些默认样式（例如，斜体字体）之外，几乎没有任何软件以任何特定方式使用元素。

该`em`元素有多种解释，而 HTML5 草案使事情变得更加混乱。在实践中，这并不重要。使用`em`使字体默认为斜体。就是这样。有传言说搜索引擎会`em`在页面中赋予元素更大的相对权重。这在这里是否有用值得怀疑。

# google-cloud-storage - 批量删除云存储对象

> ID：14885656
> 
> 赞同：4
> 
> 时间：2013-02-14T23:01:33.250
> 
> 标签：google-cloud-storage

删除许多云存储对象的最佳方法是什么？我有一个包含约 500K 个对象的存储桶，我想将它们全部删除。

您是否必须为要删除的每个对象发出 1 个 api 请求，或者是否有某种批处理方法？我目前正在使用 gsutil 一次删除一个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T00:01:12.523

您需要为每个对象发出 1 个 api 请求。最简单的方法是使用[gsutil](https://developers.google.com/storage/docs/gsutil)：

```
$ gsutil -m rm gs://bucket_with_many_objects/** 
```

-m 选项启用多线程，这将并行删除许多对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-15T16:45:10.017

请注意，使用 gsutil 时，“*”通配符将仅匹配顶级对象（直到路径名中的下一个“/”）。如果要删除所有对象，可以使用：

```
$ gsutil -m rm -R gs://bucket_with_many_objects 
```

或者

```
$ gsutil -m rm gs://bucket_with_many_objects/** 
```

Mike Schwartz，谷歌云存储团队

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-10T16:39:20.430

我有一个类似的问题，一个包含超过 800,000 个对象的存储桶，**gsutil -m rm gs://bucket-name**方法确实有效，但需要很长时间，因为它基本上仍然一次删除每个对象。

在与 Google 的 Cloud Storage 团队联系后，他们向我指出了存储桶生命周期策略的方向，虽然不是即时的，但它们允许您以更有效的方式批量删除对象。

我写了[一篇关于](http://blog.iangsy.com/2014/04/google-cloud-storage-deleting-full.html)使用这种方法删除完整存储桶的博客文章。

# python - Numpy loadtxt 四舍五入数字

> ID：14885660
> 
> 赞同：5
> 
> 时间：2013-02-14T23:02:28.410
> 
> 标签：python, numpy

我正在使用 numpy loadtxt 函数来读取大量数据。数据似乎四舍五入。例如：文本文件中的数字是 -3.79000000000005E+01 但 numpy 读取的数字为 -37.9。我在 loadtxt 调用中将 dypte 设置为 np.float64 。无论如何要保持原始数据文件的精度？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T23:09:10.370

`loadtxt`不是四舍五入的数字。您看到的是 NumPy 选择*打印*数组的方式：

```
In [80]: import numpy as np

In [81]: x = np.loadtxt('test.dat', dtype = np.float64)

In [82]: print(x)
-37.9 
```

实际值是最接近输入值的 np.float64。

```
In [83]: x
Out[83]: array(-37.9000000000005) 
```

* * *

或者，在更有可能的情况下，你有一个更高维的数组，

```
In [2]: x = np.loadtxt('test.dat', dtype = np.float64) 
```

如果`repr`of`x`看起来被截断：

```
In [3]: x
Out[3]: array([-37.9, -37.9]) 
```

你可以`np.set_printoptions`用来获得更高的精度：

```
In [4]: np.get_printoptions()
Out[4]: 
{'edgeitems': 3,
 'infstr': 'inf',
 'linewidth': 75,
 'nanstr': 'nan',
 'precision': 8,
 'suppress': False,
 'threshold': 1000}

In [5]: np.set_printoptions(precision = 17)

In [6]: x
Out[6]: array([-37.90000000000050306, -37.90000000000050306]) 
```

（感谢@mgilson 指出这一点。）

# c# - 注入 linq 表达式

> ID：14885664
> 
> 赞同：1
> 
> 时间：2013-02-14T23:02:47.473
> 
> 标签：c#, asp.net, asp.net-mvc, linq, entity-framework

我在数据库中有父实体和子实体。我需要让一些孩子和他们的父母分别作为 ChildBrief 和 ParentBrief 对象，它们只包含相应实体的一些字段。因此，ParentBrief 和 ChildBrief 是一种底层实体的映射。
我可以写：

```
IQueriable<ChildBrief> result = Childs.Select(x => new ChildBrief
    {
        Id = x.Id,
        Name = x.Name,
        Parent = new ParentBrief
        { 
            Id = x.Parent.Id, 
            Name = x.Parent.Name
        }
    }); 
```

它将被完美地编译成生成的 SQL。但我希望 ParentBrief 映射器成为一个单独的静态函数，可以在其他地方重复使用，例如这里，我执行以下操作：

```
IQueriable<ChildBrief> result = Childs.Select(x => new ChildBrief
    {
        Id = x.Id,
        Name = x.Name,
        Parent = mapper.Compile()(x.Parent)
    });

private static readonly Expression<Func<Parent, ParentBrief>> mapper =
    m => new ParentBrief
    {
        Id = x.Parent.Id, 
        Name = x.Parent.Name}
    }; 
```

EF5 引发一个错误，说明无法调用方法或类似的东西（可能在编译阶段）。
有什么方法可以将简单的表达式（只是平面映射）注入 EF 并使它们正确编译到 SQL 中？我还想在不预先执行的情况下获得 IQueryable 结果。

# javascript - 保存可拖动div jQuery的位置

> ID：14885669
> 
> 赞同：0
> 
> 时间：2013-02-14T23:03:07.943
> 
> 标签：javascript, jquery, cookies, save

我有一个网站，我正在为它制作小部件。这些小部件是可拖动的。我想知道如何保存小部件的位置（以及它是否隐藏[禁用或启用]），并加载位置以及当您再次加入网站时它是否隐藏（使用同一用户） . 感谢您的宝贵时间，如果您不明白我需要什么，请发表评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:40:22.283

我假设你的小部件在一个`<ul>`，`<li>`每个小部件一个，这是很正常的。

**能够定位它们**
您首先需要按特定顺序排列小部件。想象一下，您已经完成了艰苦的工作并拥有了用户将拥有的数据。对其进行硬编码并让您的模块正确显示。更改数据，查看模块是否按预期显示。
用户需要拖动它们。jQuery 可拖动是你的朋友。

**证明您可以获取您的数据**
能够在它们移动后从页面获取小部件的顺序。可拖动示例显示了一个 .serialize() 函数。
您还需要知道哪个打开，哪个关闭。你可以使用 jQuery 创建另一个列表`.map()`，如果你问得好，它可以返回他们的 ID 和状态。
提醒屏幕，写入文档，或者最好使用`console.log()`.

**与服务器交互**
如果您只想使用 cookie 进行测试，您可以跳过此步骤，因为浏览器可以设置它们。
但是，如果您想将其与用户信息一起存储以防他们注销、启动新会话或使用另一台计算机，您将需要使用数据库。
您需要了解如何使用 ajax 从浏览器向服务器发送数据。jQuery 是你的朋友。
您需要了解如何在数据库中存储用户信息。

**恢复位置**
您希望能够从非硬编码的列表中设置小部件的位置，以便能够使用您保存的数据在页面加载时正确排序小部件。您在第一步中执行了此操作，但使用的是硬编码数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:09:35.220

您需要做的是：
在给定时间保存状态。例如，当您更改它时。

```
$('#toBeDragableId').draggable({
   // options...
   drag: funciton(event,ui){
      theUserposition = ui.position;
   }
}); 
```

您需要以`theUserposition`一致的方式进行保存，例如数据库或使用 cookie 或客户端存储。之后，您需要在加载页面时将其恢复并设置。

[使用 Cookie 的类似问题](https://stackoverflow.com/questions/12575573/jquery-draggable-image-with-saved-position)
[示例](https://stackoverflow.com/questions/6903376/remember-position-and-size-in-a-cookie)

# emacs - 在 Emacs 中创建新模式

> ID：14885670
> 
> 赞同：6
> 
> 时间：2013-02-14T23:03:16.153
> 
> 标签：emacs, elisp

我对 Emacs Lisp（或任何 Lisp，就此而言）一无所知。我想做一些看起来很简单的事情，但我没有在线指南。我想为`.packet`文件创建“packet-mode.el”。我想做以下事情：

*   启用 C++ 模式
*   创建`packet`一个关键字，同时保持 C++ 模式的其余部分不变

```
(define-derived-mode packet-mode fundamental-mode
  (font-lock-add-keywords 'c++-mode `(("packet" . font-lock-keyword-face)))
  (c++-mode))

  (add-to-list 'auto-mode-alist '("\\.packet\\'" . packet-mode)
  (provide 'packet-mode) 
```

我也尝试在数据包模式下切换语句的顺序，但随后 C++ 突出显示中断。

我想`packet`表现`struct`得像

```
packet foo {
  int bar;
} 
```

`struct`以与代替.时相同的方式突出显示`packet`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-15T01:41:19.407

这是您需要放入的内容`packet-mode.el`：

```
(defvar packet-mode-font-lock-keywords
  '(("\\<packet\\>" . font-lock-keyword-face)))
(define-derived-mode packet-mode c++-mode "Packet"
  "A major mode to edit GNU ld script files."
  (font-lock-add-keywords nil packet-mode-font-lock-keywords))
(add-to-list 'auto-mode-alist '("\\.packet\\'" . packet-mode))
(provide 'packet-mode) 
```

放入`packet-mode.el`您的目录中`load-path`并（可选）字节编译它。

现在，添加`(require 'packet-mode)`到您的`.emacs.el`.

# extjs - Ext.form.field.ComboBox 在 Firefox 中显示 HTML

> ID：14885680
> 
> 赞同：2
> 
> 时间：2013-02-14T23:04:04.727
> 
> 标签：extjs

我有以下代码适用于除 Firefox 之外的所有浏览器：

```
{
    xtype: 'gridcolumn',
    dataIndex: 'action',
    flex: 1,
    text: 'Action',
    editor: new Ext.form.field.ComboBox({
        typeAhead: true,
        triggerAction: 'all',
        selectOnTab: true,
        store: [
            ['Update','Update'],
            ['Suspend','Suspend'],
            ['Cancel','Cancel']
        ],
        lazyRender: true,
        listClass: 'x-combo-list-small',
        listeners: {
            change:{
                scope: me,
                fn: me.processAction
            },
            focus: function(combo) {
                combo.expand();
            },
            collapse: function(combo) {
                //combo.setVisible(false);
            }
        }
    })
} 
```

问题是当您单击组合框时，列表中的第一项是`<div id="ext-gen1584" class="x-grid-cell-inner " style="text-align: left; ;">&nbsp;</div>`.

有人遇到过这种情况么？它是 Ext 还是 Firefox 中的错误？

目前在 Firefox 18.0.2 中进行测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-28T08:17:10.227

我有这个错误，就像其他人说的那样，当你在模型中没有 dataIndex 的字段时会发生这种情况。但这里有一个小时刻，您必须在模型中初始化该字段，即使是空值，然后它将呈现正确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-17T13:25:44.060

是的，< 5.0 版本在 firefox 中存在错误 - 当 dataIndex 的名称无效时，编辑器的值错误。

* * *

[**看看例子**](https://fiddle.sencha.com/#fiddle/but)

* * *

```
header: 'Relationship',
dataIndex: 'relationshipWRONG', // rename this on 'relationship'
flex: 2,
getEditor: function() {
    return Ext.create('Ext.grid.CellEditor', {
        field: Ext.create('Ext.form.field.ComboBox', {
            store: relativeStore,
            displayField: 'name',
            valueField: 'name',
            editable: false
        })
    });
} 
```

在 chrome 和 firefox 中查看这个，在 firefox 中您会看到 dom 元素而不是 null 值。在 5 版本中一切都很好。重命名此数据索引和值将是正确的。

但是当dataIndex在datacolumn上正确时我看到了这个错误，我还没有找到如何解决它并且只是在**beforestartedit**事件中更改值（ofc这是不好的做法）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-06-25T11:03:22.987

我在网格中遇到过类似的问题，如果 dataIndex 没有值，那么单元格将显示您所看到的内容..所以请检查 dataIndex 的内容：Action；

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-01-23T01:55:43.277

这是我今天在我的情况下发现的......

在你有的情况下

1 - 具有字段 'id'、'name'、'displayName' 的商店，在 displayName 字段上有一个组合。

> 响应 daixfnwpu: **AND dataIndex 为每个字段设置。**

2 - 要添加的记录，其中包含字段 'id'、'name' 但没有 displayName。

如果您执行 store.add(record)，这似乎有效，并且 displayName 将设置为空字符串“”

但是，如果您拖放记录，则拖放操作似乎没有设置 displayName 并且它保持未定义......这是问题的根源......

我通过过滤添加的 onDrop 记录来解决这个问题...

```
Ext.each(records, function(record) {
    var displayName = record.get('displayName');
    record.set('displayName', displayName ? displayName : '');
    record.commit();
}); 
```

# php - PHP可以用来操作handlebarsjs表达式吗

> ID：14885682
> 
> 赞同：0
> 
> 时间：2013-02-14T23:04:07.370
> 
> 标签：php, javascript, jquery, handlebars.js

大约一个小时前，我开始使用 Handlebars.js 进行 javascript 模板化。到目前为止，一切都很好。我有一些项目，单击时会向我的控制器发出 ajax 请求，然后通过相关模型获取数据，然后将其传递回 jquery ajax 调用`json_encode()`。

此时，我将返回的数据传递给一个 js 函数，该函数将把手模板与新接收的数据一起呈现。

到目前为止，一切都运行良好。

我的问题和疑问与模板创建本身有关。我想做一些简单的事情，`<?=number_format({{Savings}});?>`但这似乎会引发一个大错误，以至于页面甚至不会完全渲染。

有没有办法集成一些 PHP 操作？根据我的小试验和错误以及正在进行的服务器与客户端交易，我想这是不可能的，但想问一下以防万一。如果不是，在这种情况下进行此类数据熨烫（数字、日期、字母大小写等）的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:20:34.507

不，它不能。请记住，PHP 正在生成 HTML，在本例中是车把模板。模板被发送到客户端（浏览器），由车把库处理它。

对于 PHP`{{ Savings }}`来说就是这样，它不是服务器上的数字。它只会成为客户端上的数字。因此，这会给你一个 PHP 解析错误。

您需要使用帮助程序使用车把格式化数字。您可能需要编写自定义帮助程序，这在文章[“Handlebars.js 第 2 部分：Partials 和帮助程序”](http://blog.teamtreehouse.com/handlebars-js-part-2-partials-and-helpers)中进行了描述。

# ruby-on-rails - rails 3中的twitter bootstrap下拉菜单

> ID：14885684
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:04:11.750
> 
> 标签：ruby-on-rails, ruby-on-rails-3, twitter-bootstrap

我无法使用 twitter bootstrap 在导航栏中使用下拉菜单，我有：

```
<div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>     
      <div class="nav-collapse collapse">
        <ul class="nav">
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
              Dropdown <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="#">Action</a></li>
              <li><a href="#">Another action</a></li>
              <li><a href="#">Something else here</a></li>
              <li class="divider"></li>
              <li><a href="#">Separated link</a></li>
            </ul>
          </li>
        </ul>
      </div><!--/.nav-collapse -->
    </div><!--/.container-fluid -->
  </div><!--/.navbar-inner -->
</div><!--/.navbar --> 
```

并且头部中包含的javascript如下：

```
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
    <link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css" />
    <link href="/assets/custom.css?body=1" media="all" rel="stylesheet" type="text/css" />
<script src="/assets/jquery.js?body=1" type="text/javascript"></script>
    <script src="/assets/jquery_ujs.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-transition.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-affix.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-alert.js?body=1" type="text/javascript"></script> 
    <script src="/assets/bootstrap-button.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-carousel.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-collapse.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-dropdown.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-modal.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-scrollspy.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-tab.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-tooltip.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-popover.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap-typeahead.js?body=1" type="text/javascript"></script>
    <script src="/assets/bootstrap.js?body=1" type="text/javascript"></script>
    <script src="/assets/application.js?body=1" type="text/javascript"></script>
    ... 
```

所以 jquery 被包含在 bootstrap.js 之前，我缺少什么？我做错了什么？

编辑：我已经清理了我的 application.js，所以现在头部看起来像这样：

```
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link href="/assets/application.css?body=1" media="all" rel="stylesheet" type="text/css" />
    <link href="/assets/custom.css?body=1" media="all" rel="stylesheet" type="text/css" />
    <script src="/assets/application.js?body=1" type="text/javascript"></script>
... 
```

现在出现了一个向上的白色三角形，以前没有出现过，但没有出现在整个下拉列表中......

![在此处输入图像描述](../Images/a881a8fc0808962dbca1ccdf75a85da2.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:20:43.490

1.  在隔离环境中检查您的标记：http: [//jsfiddle.net/handtrix/9992A/](http://jsfiddle.net/handtrix/9992A/)（看起来不错）

2.  也许您应该在页面底部包含 Javascript 文件。

3.  你用了脚手架（`$ rails g controller ...`）吗？如果是，请记住 rails 脚手架生成器通常会添加 css 文件，这些文件会破坏您的引导 css。尝试删除它们。

4.  清除浏览器缓存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T23:05:47.920

问题原来是我在布局中使用的一些 twitter 引导模式，如下所示：

```
<div class="modal fade" id="modal_terms"> 
```

而不是我改为：

```
<div class="modal hide" id="modal_terms"> 
```

现在一切正常，我希望这对其他人有帮助

# sql-server - 在 SQL Server Management Studio 中删除数据库时，是否所有空间都释放回 O/S？

> ID：14885687
> 
> 赞同：8
> 
> 时间：2013-02-14T23:04:22.827
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, filesystems

当SQL Server Management Studio的Treeview中的一个数据库被右击并脱机然后选择Delete选项时，分配给该数据库的所有空间是否都释放回了o/s文件系统池？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-15T18:35:29.647

如果在删除数据库之前使数据库脱机，则不会从磁盘中删除数据文件。请在线查看本书的这一部分。

[http://msdn.microsoft.com/en-us/library/ms178613.aspx](http://msdn.microsoft.com/en-us/library/ms178613.aspx)

> 删除数据库会从 SQL Server 实例中删除数据库，并删除数据库使用的物理磁盘文件。**如果数据库或其任何文件在删除时处于脱机状态，则不会删除磁盘文件。**可以使用 Windows 资源管理器手动删除这些文件。要从当前服务器中删除数据库而不从文件系统中删除文件，请使用 sp_detach_db。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:19:15.547

是和不是。只要与数据库相关的所有数据库文件都被删除（在选择删除选项时发生），那么是的，该空间现在被释放回操作系统。但是系统数据库中有一些与数据库相关的数据。最好的例子是备份历史记录（您也可以在删除数据库时选择删除它）。这看起来并不多，但几年备份的数据可以加起来。特别是如果您正在执行事务日志备份，请说每 5 分钟一次。

当然，您的备份文件仍将存在并占用驱动器上的空间。

# android - 卸载后开发Android应用程序安装正常不会重新安装

> ID：14885691
> 
> 赞同：0
> 
> 时间：2013-02-14T23:04:39.337
> 
> 标签：android

我有一个我一直在开发的小应用程序。我想在运行 4.2.1 的 Galaxy Nexus 上运行全新安装。我卸载了该应用程序，然后尝试通过 Eclipse 重新安装它。它安装得很好，logcat、控制台等没有错误……但是当你点击运行应用程序时，它只是在打开时关闭。我在两部不同的手机上试过这个，同样的事情。

在 Galaxy Nexus 上，如果我在卸载之前恢复我的 ROM，我可以从 eclipse 中运行它。只有在卸载并重新安装后，我才能强制关闭。它安装在 ROM 备份上。

有任何想法吗？！我怎样才能知道这里发生了什么？

编辑：：：

活动只在清单中声明一次......

尝试更改版本号...没有效果

在 MainActivity 中添加了一些 Log.e()：

```
protected void onCreate(Bundle savedInstanceState) {
        Log.e(TAG,"STARTING APP");
        super.onCreate(savedInstanceState);
        // show no back arrow
        Log.e(TAG,"AFTER ONCREATE");
        setContentView(R.layout.activity_firstload);
        Log.e(TAG,"AFTER SETCONTENTVIEW");

        getPrefs();
        Log.e(TAG,"GET PREFS");
        finish();
        Log.e(TAG,"AFTER FINISH");
    } 
```

LogCat 中显示的唯一标签是“AFTER FINISH”

如果我摆脱完成，MainActivity 保持打开状态。主要活动所做的就是检查首选项。这是我的 GetPrefs()

```
private void getPrefs() {
        // Get the xml/preferences.xml preferences
        Log.e(TAG,"GET PREFS 1");
        SharedPreferences prefs = PreferenceManager
                .getDefaultSharedPreferences(getBaseContext());
        lp = prefs.getString("defaultreport", "");
        Log.v(TAG, lp);

        if (lp.equals("esac")) {
//          Toast.makeText(MainActivity.this, "ESAC", Toast.LENGTH_SHORT)
//                  .show();
            Intent i = new Intent(MainActivity.this, ESACActivity.class);
            startActivity(i);
        } else if (lp.equals("sac")) {
//          Toast.makeText(MainActivity.this, "SAC", Toast.LENGTH_SHORT)
//                  .show();
            Intent i = new Intent(MainActivity.this, SACActivity.class);
            startActivity(i);
        } else if (lp.equals("msar")) {
//          Toast.makeText(MainActivity.this, "MSAR", Toast.LENGTH_SHORT)
//                  .show();
            Intent i = new Intent(MainActivity.this, MSARActivity.class);
            startActivity(i);
        }

    } 
```

啊>>> 可能发现了什么。首选项最初设置为 "" (null) 那么它会加载什么？！所以我需要一个屏幕来询问他们想在第一次运行时设置哪个我猜......

编辑编辑::: 需要检查首选项中的首次运行...

```
if (prefs.getString("defaultreport", null) == null)
        {
            startActivity(new Intent(this, Preferences.class));
            return;
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:32:01.410

如果没有偏好，您决定运行什么的字符串将设置为空。

```
lp = prefs.getString("defaultreport", ""); 
```

而且由于您在这种情况下没有任何选择，所以什么都不会运行，初始活动将在不启动任何其他活动的情况下关闭。

# actionscript-3 - 你如何将一个向量反映在另一个向量上？

> ID：14885693
> 
> 赞同：1
> 
> 时间：2013-02-14T23:04:56.693
> 
> 标签：actionscript-3, vector, physics

我正在使用 AS3 为 Flash 游戏编写一些碰撞检测程序，但在弄清楚如何将球从线上弹起时遇到了麻烦。我跟踪表示球的 2D 速度的向量，并试图将其反映在垂直于球碰撞线（也称为法线）的向量上。我的问题是我不知道如何找出新向量（这反映在法线上）。我认为您可以使用 Math.atan2 来查找法线向量和球向量之间的差异，但我不确定如何扩展它来解决我的问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:45:05.787

**矢量代数 -**你想要“反弹”矢量：
vec1 是球的运动矢量，vec2 是表面/线矢量：

```
// 1\. Find the dot product of vec1 and vec2
// Note: dx and dy are vx and vy divided over the length of the vector (magnitude)
var dpA:Number = vec1.vx * vec2.dx + vec1.vy * vec2.dy;

// 2\. Project vec1 over vec2
var prA_vx:Number = dpA * vec2.dx;
var prA_vy:Number = dpA * vec2.dy;

// 3\. Find the dot product of vec1 and vec2's normal
// (left or right normal depending on line's direction, let's say left)
var dpB:Number = vec1.vx * vec2.leftNormal.dx + vec1.vy * vec2.leftNormal.dy;

// 4\. Project vec1 over vec2's left normal
var prB_vx:Number = dpB * vec2.leftNormal.dx;
var prB_vy:Number = dpB * vec2.leftNormal.dy;

// 5\. Add the first projection prA to the reverse of the second -prB
var new_vx:Number = prA_vx - prB_vx;
var new_vy:Number = prA_vy - prB_vy; 
```

将这些速度分配给球的运动矢量并让它弹跳。

**PS:**
**vec.leftNormal** --> vx = vec.vy; vy = -vec.vx；
**vec.rightNormal** --> vx = -vec.vy; vy = vec.vx;

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T10:40:24.673

可以使用投影张量计算任何向量**v**从具有法线**n**在任何维度上的线/（超）曲面的镜面反射。**v**在**n**上的平行投影为：**v** || = ( **v** . **n** ) **n** = **v**。**nn**。这里**nn**是法线与自身的外（或张量）乘积。在笛卡尔坐标中，它是一个包含元素的矩阵：`nn[i,j] = n[i]*n[j]`。垂直投影只是原始向量与其平行投影之间的差异：**v** - **v**||。当矢量被反射时，它的平行投影被反转，而垂直投影被保留。所以反射向量为：

**v** ' = - **v** || + ( **v** - **v** ||) = **v** - 2 **v** || = **v**。( **I** - 2 **nn** ) = **v**。**R** ( **n** )，其中
**R** ( **n** ) = **I** - 2 **nn**

（**I**是单位张量，在笛卡尔坐标中只是对角单位矩阵*diag(1)*）

**R**称为反射张量。在笛卡尔坐标系中，它是一个具有分量的实对称矩阵`R[i,j] = delta[i,j] - 2*n[i]*n[j]`，其中`delta[i,j] = 1`if`i == j`和`0`else。它也是关于**n**对称的：

**R** ( - **n** ) = **I** - 2(- **n** )(- **n** ) = **I** - 2 **nn** = **R** ( **n** )

因此，使用向外或向内的法线**n**并不重要- 结果是相同的。

在二维和笛卡尔坐标中，`R`（**R**的矩阵表示）变为：

```
 [ R00  R01 ]   [ 1.0-2.0*n.x*n.x     -2.0*n.x*n.y ]
R = [          ] = [                                  ]
    [ R10  R11 ]   [    -2.0*n.x*n.y  1.0-2.0*n.y*n.y ] 
```

然后将反射向量的分量计算为行向量矩阵乘积：

```
v1.x = v.x*R00 + v.y*R10
v1.y = v.x*R01 + v.y*R11 
```

或扩展后：

```
k = 2.0*(v.x*n.x + v.y*n.y)
v1.x = v.x - k*n.x
v1.y = v.y - k*n.y 
```

在三个维度：

```
k = 2.0*(v.x*n.x + v.y*n.y + v.z*n.z)
v1.x = v.x - k*n.x
v1.y = v.y - k*n.y
v1.z = v.z - k*n.z 
```

找到球击中线/墙的确切点更复杂 - 请参见[此处](https://stackoverflow.com/a/13891655/1374437)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:25:21.510

计算向量的两个分量。

一个组件将是您的矢量在反射表面上的投影，另一个组件将是在表面法线上的投影（您说您已经拥有）。使用点积来获得投影。通过对两个向量求和来将这两个分量相加。你会有你的答案。

您甚至可以将第二个分量 A2 计算为原始向量减去第一个分量，因此：A2 = A - A1。然后你想要的向量是 A1 加上反射的 A2 （这只是 -A2 因为它垂直于你的表面）或：

Ar = A1-A2

或者

Ar = 2A1 - A 与 Ar = -(2A2 - A) 相同

如果 [Ax,Bx] 是你的球速度并且 [Wx,Wy] 是代表墙壁的单位向量：

A1x = (Ax*Wx+Ay*Wy)*Wx；

A1y = (Ax*Wx+Ay*Wy)*Wy；

Arx = 2*A1x - Ax;

Ary = 2*A1y - Ay；

# c++ - 如何设置gtkmm窗口在屏幕中央打开？

> ID：14885694
> 
> 赞同：1
> 
> 时间：2013-02-14T23:04:59.980
> 
> 标签：c++, gtkmm

我正在尝试让我在 GTKmm 中的窗口在屏幕中央打开，但我在网上的任何地方都找不到有效的解决方案。有什么见解吗？

我一直在尝试我能想到的一切，但没有结果......

这是我的代码：

```
#include "viewMenu.h"
#include <iostream>
#include <fstream>
#define MAX_BUF 10

viewMenu::viewMenu()
: frmMenu("cuTAES Review Menu"), 
  lblChooser("Select Course : "), 
  lblCourses(""),
  lblView(" View "),
 lblAppInfo(" Application Info "), 
  lblStuInfo(" Student Info "), 
  btnView(" View this Application "), 
  btnBack(" Back "),
  frameTable(4,4,true)
{
  set_title("cuTAES Review Menu ");
  //set_border_width(50);
  add(frameTable);

  window.set_position(Gtk::WIN_POS_CENTER);

  //frmMenu.add(lblChooser);
  //frameTable.attach(frmMenu,0,1,0,0);

  frameTable.attach(lblChooser, 1,2,0,1);
  char text[MAX_BUF];
  std::ifstream inFile("courses.txt", std::ios::in);
  if(!inFile){
    exit(1);
  }
  while(!inFile.eof()) {
    inFile.getline(text,MAX_BUF);
    cboCourse.append(text);
  }

  frameTable.attach(cboCourse, 2,3,0,1);

  //set up my table
  frameTable.attach(lblView, 0,1,0,1);
  frameTable.attach(lblStuInfo, 0,1,1,2);
  frameTable.attach(lblAppInfo, 2,3,1,2);
  btnView.signal_clicked().connect(sigc::mem_fun(*this,&viewMenu::btnView_clicked));
  frameTable.attach(btnView,3,4,0,1);

  btnBack.signal_clicked().connect(sigc::mem_fun(*this, &viewMenu::btnBack_clicked));
  frameTable.attach(btnBack,3,4,3,4);

  show_all_children();
} 
```

和我的头文件：

```
#ifndef VIEWMENU_H
#define VIEWMENU_H

#include <gtkmm.h>

class viewMenu : public Gtk::Window
{

public:
  viewMenu();
  virtual ~viewMenu();

protected:
  //Signal handlers:
  void btnView_clicked();

  void btnBack_clicked();

  //Member widgets:
  Gtk::Table frameTable;
  Gtk::Label lblChooser,lblCourses, lblView, lblAppInfo, lblStuInfo, lblCourseDrop;  
  Gtk::Frame frmMenu;
  Gtk::Button btnView, btnBack;
  Gtk::ComboBoxText cboCourse;
  Gtk::Window window;
};

#endif // MAINMENU_H 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-12T15:53:37.410

您的 viewMenu 类继承自 Gtk::Window 类。只需使用 set_position 函数来设置窗口的位置。代替：

```
window.set_position(Gtk::WIN_POS_CENTER); 
```

利用：

```
set_position(Gtk::WIN_POS_CENTER); 
```

# .htaccess - htaccess 404重定向不起作用

> ID：14885700
> 
> 赞同：0
> 
> 时间：2013-02-14T23:05:19.457
> 
> 标签：.htaccess, mod-rewrite, http-status-code-404, errordocument

我正在尝试使用以下方法为我的网站设置自定义 404 页面：`ErrorDocument 404 /404.html`但是当我添加它时，转到 domain.com/dslkjflsdkjflskdjf 不会重定向到 404 页面。相反，它重定向到我的主页，页面上的大部分内容都被破坏了。

我想知道这个 mod_rewrite.c 模块是否是造成这种情况的原因，我尝试过修改它（取出 L，在模块内添加重定向等）但没有运气。

```
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ /index.php?url=$1 [QSA,L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:32:04.700

我对此不确定，但我认为您的服务器无法识别 404 错误，因为每个请求都被重定向到您的 index.php。您必须在 index.php 中确定是否存在 404 错误并使用 header() 函数发送标头。

# asp.net-mvc - Razor 视图中的自定义类？

> ID：14885703
> 
> 赞同：0
> 
> 时间：2013-02-14T23:05:29.177
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

在我的控制器中，我有一个名为“ObjectData”的类，其中包含一个 ID 和一个字符串：

```
public class ObjectData
{
    public int ObjectId { get; set; }
    public string Name { get; set; }
} 
```

我试图通过 ViewBag 将这些列表传递给视图，但我不知道如何循环遍历数组中的项目，因为类类型不正常。我这样做是因为我不想将一堆对象及其数据传递给视图，而我只需要 ID 和名称（这是一个有效的问题吗？）。

我正在考虑这样循环：

```
foreach (ObjectData i in ViewBag.ParentSetIds)
{
    @Html.ActionLink(i.Name, "Detail", new { objectId = i.ObjectId }, null)
} 
```

但 Razor 无法识别该类类型。如何实现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:27:09.193

你可以使用：

```
foreach (var i in ViewBag.ParentSetIds) 
```

并让编译器根据 ViewBag.ParentSetIds 确定命名空间

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:23:40.177

您必须在该行中完全限定您的类型名称：

```
foreach (Put.Your.Namespaces.Here.ObjectData i in ViewBag.ParentSetIds) 
```

Razor 不使用与`using`控制器相同的声明。您可以`web.config`在 View 目录中使用来添加这样的命名空间，而不是每次都完全限定它。

关于您是否应该担心将此类对象传递给查看的问题。不，没有必要担心。我建议将对象从控制器移动到名为或在此处创建类`ObjectData`的控制器文件夹旁边的文件夹。这就像公开接受的“hack”，拥有代表对某些“真实”模型的另一种看法的模型。就像您生成 MVC3 项目时它为您创建的包含完全相同类型的模型的文件一样。但是你在文件夹中找到它，而它是否应该在文件夹中可以讨论。此外，如果它不仅仅是帮助数据，则将此数据作为模型而不是作为部分 ViewBag 传递。`ModelView``ViewModel``AccountModels.cs``Model``ViewModel`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:37:45.953

> 在我的**控制器**中，我有一个名为“ObjectData”的**类**，其中包含一个 ID 和一个字符串：

等等，什么？为什么你的控制器中有一个类？

> 我正在尝试通过 ViewBag 将这些列表传递给视图，

只需使用视图模型。如果你是，你可以`List<ObjectData>`参与其中。在您的控制器中，您加载该列表（让我们调用它`ObjectDataList`），并将其发送到您的视图。

在视图（剃刀）中，你会有类似的东西：

```
@model MyProject.MyModel

@foreach(var i in Model.ObjectDataList)
{
   @Html.ActionLink(i.Name, "Detail", new { objectId = i.ObjectId }, null)
} 
```

编辑：

为了澄清起见，您的视图模型可能是：

```
public class MyModel
{
     public string Title {get;set;}
     public List<ObjectData> ObjectDataList {get;set;}

} 
```

# exception - 由于未捕获的异常，SecurityAgent 终止应用程序

> ID：14885707
> 
> 赞同：2
> 
> 时间：2013-02-14T23:05:43.357
> 
> 标签：exception, osx-lion

到目前为止，我管理的三个系统都无法让用户登录。我们使用 PolicyBanner 文件（并且已经在数十台 Mac 上这样做了几个月或几年，是的，我们已经尝试从问题机器中删除 /Library/Security/PolicyBanner.rtf），这些系统卡在那里……点击接受按钮，而不是被带到登录屏幕，系统搅动片刻并将它们返回到横幅。我们已经尝试了大多数或所有常见的嫌疑人，唯一的“解决方案”是恢复较旧的 Time Machine 备份。

所有三个有问题的系统都运行 10.8.2 一个是 iMac12,2，一个是 MacBook Pro，一个是更大的塔式 Mac（现在无法登录）我能想到的唯一模糊的可能性是，我非常相信尽可能多地从命令行执行...我编写了许多脚本，包括更新 Java、Adobe Reader、MS Office 等。我想安装一个或多个来自shell 引入了一些 99.9% 的 Mac 用户永远不会看到的奇怪问题。我有另一台运行 10.8.2 的 MacBook Pro，但没有出现此问题，另一台运行 10.7.5 的 MacBook Pro 没有，还有另一台较旧的 MacBook，我从未在网上看到或从用户那里听到 :-)

另一个数据点……在启用了 File Vault 的系统上，启动机器并解锁磁盘的用户最终被登录。他们看到 PolicyBanner，被提示输入他们的 Apple ID，然后收到一条关于如何存在的消息一些问题，他们是否想打开以前打开的应用程序。一旦他们登录，如果他们注销，系统就会再次卡在横幅上。

所以，这里是 system.log 输出。崩溃报告让我超过了 30K 个字符的限制，但我很乐意提供。

```
Feb 14 14:12:05 sahara SecurityAgent[1452]: MacBuddy was run = 0
Feb 14 14:12:05 sahara SecurityAgent[1452]: *** WARNING: -[NSImage compositeToPoint:operation:fraction:] is deprecated in MacOSX 10.8 and later. Please use -[NSImage drawAtPoint:fromRect:operation:fraction:] instead.
Feb 14 14:12:05 sahara SecurityAgent[1452]: *** WARNING: -[NSImage compositeToPoint:fromRect:operation:fraction:] is deprecated in MacOSX 10.8 and later. Please use -[NSImage drawAtPoint:fromRect:operation:fraction:] instead.
Feb 14 14:12:05 sahara SecurityAgent[1452]: *** WARNING: -[NSImage compositeToPoint:operation:] is deprecated in MacOSX 10.8 and later. Please use -[NSImage drawAtPoint:fromRect:operation:fraction:] instead.
Feb 14 14:12:05 sahara SecurityAgent[1452]: *** WARNING: -[NSImage compositeToPoint:fromRect:operation:] is deprecated in MacOSX 10.8 and later. Please use -[NSImage drawAtPoint:fromRect:operation:fraction:] instead.
Feb 14 14:12:05 sahara SecurityAgent[1452]: -[__NSCFString bytes]: unrecognized selector sent to instance 0x7fdc61222c40
Feb 14 14:12:05 sahara SecurityAgent[1452]: NSExceptionHandler has recorded the following exception:
    NSInvalidArgumentException -- -[__NSCFString bytes]: unrecognized selector sent to instance 0x7fdc61222c40
    Stack trace:  0x1057a5637  0x7fff8ac183f0  0x7fff8f0f06ea  0x7fff8f0485ce  0x7fff8f0483b8  0x7fff8b40ce8f  0x7fff90b521b4  0x7fff9109d18a  0x10594d919  0x10595c10e  0x7fff910a36cb  0x7fff910a1767  0x7fff910a141c  0x7fff8e3de29d  0x7fff8f052a46  0x7fff8e3ddfdd  0x7fff8e3de29d  0x7fff8f052a46  0x7fff8e3ddfdd  0x7fff8e468b75  0x7fff8e3de29d  0x7fff8f052a46  0x7fff8e3ddfdd  0x7fff8e3de29d  0x7fff8f052a46  0x7fff8e3ddfdd  0x7fff8e3de29d  0x7fff8f052a46  0x7fff8e3ddfdd  0x7fff8e3de29d  0x7fff8f052a46  0x7fff8e3ddfdd  0x7fff8e3dd634  0x7fff8e3a9a61  0x7fff8e533f44  0x7fff8e466b18  0x7fff8e466138  0x7fff8e465d1f  0x7fff9108d0c5  0x105959e50  0x105948a94  0x7fff8c879a2d  0x7fff8c8740b6  0x7fff8c8790c8  0x7fff8effc0fe  0x7fff8effb6b2  0x7fff8cae00a4  0x7fff8cadfe42  0x7fff8cadfcd3  0x7fff8e3a6613  0x7fff8e3a5ed2  0x7fff8e39d283  0x10577c544  0x7fff878ac7e1  0x1
Feb 14 14:12:05 sahara SecurityAgent[1452]: An uncaught exception was raised
Feb 14 14:12:05 sahara SecurityAgent[1452]: -[__NSCFString bytes]: unrecognized selector sent to instance 0x7fdc61222c40
Feb 14 14:12:05 sahara SecurityAgent[1452]: (
        0   CoreFoundation                      0x00007fff8f05a0a6 __exceptionPreprocess + 198
        1   libobjc.A.dylib                     0x00007fff8ac183f0 objc_exception_throw + 43
        2   CoreFoundation                      0x00007fff8f0f06ea -[NSObject(NSObject) doesNotRecognizeSelector:] + 186
        3   CoreFoundation                      0x00007fff8f0485ce ___forwarding___ + 414
        4   CoreFoundation                      0x00007fff8f0483b8 _CF_forwarding_prep_0 + 232
        5   CoreGraphics                        0x00007fff8b40ce8f CGDataProviderCreateWithCFData + 133
        6   LoginUICore                         0x00007fff90b521b4 LUICreateImageFromJPEGData + 12
        7   LoginUIKit                          0x00007fff9109d18a +[NSImage(LUIHelpers) imageForUserFromJPEGData:avatarType:] + 69
        8   loginwindow                         0x000000010594d919 APMechanismSetResult + 31889
        9   loginwindow                         0x000000010595c10e UserListOfUserWithPrimaryGroupGUID + 44376
        10  LoginUIKit                          0x00007fff910a36cb -[LUIUserListViewController stripView:itemForColumn:] + 525
        11  LoginUIKit                          0x00007fff910a1767 -[LUIStripView loadItemsForView] + 635
        12  LoginUIKit                          0x00007fff910a141c -[LUIStripView viewWillDraw] + 160
        13  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        14  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        15  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        16  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        17  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        18  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        19  AppKit                              0x00007fff8e468b75 -[NSScrollView viewWillDraw] + 45
        20  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        21  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        22  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        23  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        24  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        25  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        26  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        27  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        28  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        29  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        30  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        31  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        32  AppKit                              0x00007fff8e3dd634 -[NSView _sendViewWillDrawInRect:clipRootView:] + 1525
        33  AppKit                              0x00007fff8e3a9a61 -[NSView displayIfNeeded] + 1044
        34  AppKit                              0x00007fff8e533f44 -[NSNextStepFrame displayIfNeeded] + 84
        35  AppKit                              0x00007fff8e466b18 -[NSWindow _reallyDoOrderWindow:relativeTo:findKey:forCounter:force:isModal:] + 1377
        36  AppKit                              0x00007fff8e466138 -[NSWindow _doOrderWindow:relativeTo:findKey:forCounter:force:isModal:] + 940
        37  AppKit                              0x00007fff8e465d1f -[NSWindow orderWindow:relativeTo:] + 159
        38  LoginUIKit                          0x00007fff9108d0c5 -[LUIWindowController showWindow] + 498
        39  loginwindow                         0x0000000105959e50 UserListOfUserWithPrimaryGroupGUID + 35482
        40  loginwindow                         0x0000000105948a94 APMechanismSetResult + 11788
        41  libdispatch.dylib                   0x00007fff8c879a2d _dispatch_barrier_sync_f_slow_invoke + 77
        42  libdispatch.dylib                   0x00007fff8c8740b6 _dispatch_client_callout + 8
        43  libdispatch.dylib                   0x00007fff8c8790c8 _dispatch_main_queue_callback_4CF + 275
        44  CoreFoundation                      0x00007fff8effc0fe __CFRunLoopRun + 1614
        45  CoreFoundation                      0x00007fff8effb6b2 CFRunLoopRunSpecific + 290
        46  HIToolbox                           0x00007fff8cae00a4 RunCurrentEventLoopInMode + 209
        47  HIToolbox                           0x00007fff8cadfe42 ReceiveNextEventCommon + 356
        48  HIToolbox                           0x00007fff8cadfcd3 BlockUntilNextEventMatchingListInMode + 62
        49  AppKit                              0x00007fff8e3a6613 _DPSNextEvent + 685
        50  AppKit                              0x00007fff8e3a5ed2 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128
        51  AppKit                              0x00007fff8e39d283 -[NSApplication run] + 517
        52  SecurityAgent                       0x000000010577c544 SecurityAgent + 70980
        53  libdyld.dylib                       0x00007fff878ac7e1 start + 0
        54  ???                                 0x0000000000000001 0x0 + 1
    )
Feb 14 14:12:05 sahara SecurityAgent[1452]: *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString bytes]: unrecognized selector sent to instance 0x7fdc61222c40'
    *** First throw call stack:
    (
        0   CoreFoundation                      0x00007fff8f05a0a6 __exceptionPreprocess + 198
        1   libobjc.A.dylib                     0x00007fff8ac183f0 objc_exception_throw + 43
        2   CoreFoundation                      0x00007fff8f0f06ea -[NSObject(NSObject) doesNotRecognizeSelector:] + 186
        3   CoreFoundation                      0x00007fff8f0485ce ___forwarding___ + 414
        4   CoreFoundation                      0x00007fff8f0483b8 _CF_forwarding_prep_0 + 232
        5   CoreGraphics                        0x00007fff8b40ce8f CGDataProviderCreateWithCFData + 133
        6   LoginUICore                         0x00007fff90b521b4 LUICreateImageFromJPEGData + 12
        7   LoginUIKit                          0x00007fff9109d18a +[NSImage(LUIHelpers) imageForUserFromJPEGData:avatarType:] + 69
        8   loginwindow                         0x000000010594d919 APMechanismSetResult + 31889
        9   loginwindow                         0x000000010595c10e UserListOfUserWithPrimaryGroupGUID + 44376
        10  LoginUIKit                          0x00007fff910a36cb -[LUIUserListViewController stripView:itemForColumn:] + 525
        11  LoginUIKit                          0x00007fff910a1767 -[LUIStripView loadItemsForView] + 635
        12  LoginUIKit                          0x00007fff910a141c -[LUIStripView viewWillDraw] + 160
        13  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        14  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        15  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        16  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        17  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        18  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        19  AppKit                              0x00007fff8e468b75 -[NSScrollView viewWillDraw] + 45
        20  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        21  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        22  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        23  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        24  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        25  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        26  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        27  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        28  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        29  AppKit                              0x00007fff8e3de29d __22-[NSView viewWillDraw]_block_invoke_0 + 307
        30  CoreFoundation                      0x00007fff8f052a46 __NSArrayEnumerate + 582
        31  AppKit                              0x00007fff8e3ddfdd -[NSView viewWillDraw] + 244
        32  AppKit                              0x00007fff8e3dd634 -[NSView _sendViewWillDrawInRect:clipRootView:] + 1525
        33  AppKit                              0x00007fff8e3a9a61 -[NSView displayIfNeeded] + 1044
        34  AppKit                              0x00007fff8e533f44 -[NSNextStepFrame displayIfNeeded] + 84
        35  AppKit                              0x00007fff8e466b18 -[NSWindow _reallyDoOrderWindow:relativeTo:findKey:forCounter:force:isModal:] + 1377
        36  AppKit                              0x00007fff8e466138 -[NSWindow _doOrderWindow:relativeTo:findKey:forCounter:force:isModal:] + 940
        37  AppKit                              0x00007fff8e465d1f -[NSWindow orderWindow:relativeTo:] + 159
        38  LoginUIKit                          0x00007fff9108d0c5 -[LUIWindowController showWindow] + 498
        39  loginwindow                         0x0000000105959e50 UserListOfUserWithPrimaryGroupGUID + 35482
        40  loginwindow                         0x0000000105948a94 APMechanismSetResult + 11788
        41  libdispatch.dylib                   0x00007fff8c879a2d _dispatch_barrier_sync_f_slow_invoke + 77
        42  libdispatch.dylib                   0x00007fff8c8740b6 _dispatch_client_callout + 8
        43  libdispatch.dylib                   0x00007fff8c8790c8 _dispatch_main_queue_callback_4CF + 275
        44  CoreFoundation                      0x00007fff8effc0fe __CFRunLoopRun + 1614
        45  CoreFoundation                      0x00007fff8effb6b2 CFRunLoopRunSpecific + 290
        46  HIToolbox                           0x00007fff8cae00a4 RunCurrentEventLoopInMode + 209
        47  HIToolbox                           0x00007fff8cadfe42 ReceiveNextEventCommon + 356
        48  HIToolbox                           0x00007fff8cadfcd3 BlockUntilNextEventMatchingListInMode + 62
        49  AppKit                              0x00007fff8e3a6613 _DPSNextEvent + 685
        50  AppKit                              0x00007fff8e3a5ed2 -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 128
        51  AppKit                              0x00007fff8e39d283 -[NSApplication run] + 517
        52  SecurityAgent                       0x000000010577c544 SecurityAgent + 70980
        53  libdyld.dylib                       0x00007fff878ac7e1 start + 0
        54  ???                                 0x0000000000000001 0x0 + 1
    )
Feb 14 14:12:06 sahara ReportCrash[1492]: DebugSymbols was unable to start a spotlight query: spotlight is not responding or disabled.
Feb 14 14:12:06 sahara ReportCrash[1492]: failed looking up LS service ( scCreateSystemService returned MACH_PORT_NULL, called from SetupCoreApplicationServicesCommunicationPort, so using client-side NULL calls.
Feb 14 14:12:06 sahara ReportCrash[1492]: LaunchServices/5123589: Unable to lookup coreservices session port for session 0x186a0 uid=0 euid=0
Feb 14 14:12:06 sahara ReportCrash[1492]: failed looking up LS service ( scCreateSystemService returned MACH_PORT_NULL, called from SetupCoreApplicationServicesCommunicationPort, so using client-side NULL calls.
Feb 14 14:12:06 sahara ReportCrash[1492]: LaunchServices/5123589: Unable to lookup coreservices session port for session 0x186a0 uid=0 euid=0
Feb 14 14:12:06 sahara ReportCrash[1492]: failed looking up LS service ( scCreateSystemService returned MACH_PORT_NULL, called from SetupCoreApplicationServicesCommunicationPort, so using client-side NULL calls.
Feb 14 14:12:06 sahara ReportCrash[1492]: LaunchServices/5123589: Unable to lookup coreservices session port for session 0x186a0 uid=0 euid=0
Feb 14 14:12:06 sahara ReportCrash[1492]: failed looking up LS service ( scCreateSystemService returned MACH_PORT_NULL, called from SetupCoreApplicationServicesCommunicationPort, so using client-side NULL calls.
Feb 14 14:12:06 sahara ReportCrash[1492]: LaunchServices/5123589: Unable to lookup coreservices session port for session 0x186a0 uid=0 euid=0
Feb 14 14:12:06 sahara ReportCrash[1492]: failed looking up LS service ( scCreateSystemService returned MACH_PORT_NULL, called from SetupCoreApplicationServicesCommunicationPort, so using client-side NULL calls.
Feb 14 14:12:06 sahara ReportCrash[1492]: LaunchServices/5123589: Unable to lookup coreservices session port for session 0x186a0 uid=0 euid=0
Feb 14 14:12:06 sahara com.apple.SecurityServer[20]: Engine::authorize: Rule::evaluate returned 4294907288 returning errAuthorizationInternal
Feb 14 14:12:06 sahara loginwindow[1440]: Login Window - Returned from Security Agent
Feb 14 14:12:06 sahara loginwindow[1440]: AuthorizationRef doesn't have a username (<LoginAuthRefMgr: 0x7f9e4c220640>). Exiting.
Feb 14 14:12:06 sahara WindowServer[1441]: CGXRestartSessionWorkspace: session workspace exited for session 256 (on console)
Feb 14 14:12:06 sahara WindowServer[1441]: Session 256 released (1 references)
Feb 14 14:12:06 sahara WindowServer[1441]: Session 256 released (0 references)
Feb 14 14:12:06 sahara WindowServer[1441]: loginwindow connection closed; closing server.
Feb 14 14:12:06 sahara com.apple.launchd[1] (com.apple.SecurityAgent.00000000-0000-0000-0000-0000000186AC[1452]): Job appears to have crashed: Abort trap: 6
Feb 14 14:12:06 sahara loginwindow[1493]: Login Window Application Started
Feb 14 14:12:06 sahara WindowServer[1494]: Server is starting up
Feb 14 14:12:06 sahara WindowServer[1494]: Session 256 retained (2 references)
Feb 14 14:12:06 sahara WindowServer[1494]: Session 256 released (1 references)
Feb 14 14:12:06 sahara WindowServer[1494]: Session 256 retained (2 references)
Feb 14 14:12:06 sahara WindowServer[1494]: init_page_flip: page flip mode is on
Feb 14 14:12:06 sahara WindowServer[1494]: mux_initialize: Mode is dynamic
Feb 14 14:12:06 sahara WindowServer[1494]: GLCompositor enabled for tile size [256 x 256]
Feb 14 14:12:06 sahara WindowServer[1494]: CGXGLInitMipMap: mip map mode is on
Feb 14 14:12:06 sahara WindowServer[1494]: WSMachineUsesNewStyleMirroring: true
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x04272d80: GL mask 0x11; bounds (0, 0)[1680 x 1050], 14 modes available
    Main, Active, on-line, enabled, built-in, boot, Vendor 610, Model 9cb6, S/N 0, Unit 0, Rotation 0
    UUID 0x0000061000009cb60000000004272d80
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x003f003f: GL mask 0x8; bounds (0, 0)[0 x 0], 1 modes available
    off-line, enabled, Vendor ffffffff, Model ffffffff, S/N ffffffff, Unit 3, Rotation 0
    UUID 0xffffffffffffffffffffffff003f003f
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x003f003e: GL mask 0x4; bounds (0, 0)[0 x 0], 1 modes available
    off-line, enabled, Vendor ffffffff, Model ffffffff, S/N ffffffff, Unit 2, Rotation 0
    UUID 0xffffffffffffffffffffffff003f003e
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x003f003d: GL mask 0x2; bounds (0, 0)[0 x 0], 1 modes available
    off-line, enabled, Vendor ffffffff, Model ffffffff, S/N ffffffff, Unit 1, Rotation 0
    UUID 0xffffffffffffffffffffffff003f003d
Feb 14 14:12:06 sahara WindowServer[1494]: Created shield window 0x4 for display 0x04272d80
Feb 14 14:12:06 sahara WindowServer[1494]: Created shield window 0x5 for display 0x003f003f
Feb 14 14:12:06 sahara WindowServer[1494]: Created shield window 0x6 for display 0x003f003e
Feb 14 14:12:06 sahara WindowServer[1494]: Created shield window 0x7 for display 0x003f003d
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x04272d80: GL mask 0x11; bounds (0, 0)[1680 x 1050], 14 modes available
    Main, Active, on-line, enabled, built-in, boot, Vendor 610, Model 9cb6, S/N 0, Unit 0, Rotation 0
    UUID 0x0000061000009cb60000000004272d80
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x003f003f: GL mask 0x8; bounds (2704, 0)[1 x 1], 1 modes available
    off-line, enabled, Vendor ffffffff, Model ffffffff, S/N ffffffff, Unit 3, Rotation 0
    UUID 0xffffffffffffffffffffffff003f003f
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x003f003e: GL mask 0x4; bounds (2705, 0)[1 x 1], 1 modes available
    off-line, enabled, Vendor ffffffff, Model ffffffff, S/N ffffffff, Unit 2, Rotation 0
    UUID 0xffffffffffffffffffffffff003f003e
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x003f003d: GL mask 0x2; bounds (2706, 0)[1 x 1], 1 modes available
    off-line, enabled, Vendor ffffffff, Model ffffffff, S/N ffffffff, Unit 1, Rotation 0
    UUID 0xffffffffffffffffffffffff003f003d
Feb 14 14:12:06 sahara WindowServer[1494]: CGXPerformInitialDisplayConfiguration
Feb 14 14:12:06 sahara WindowServer[1494]:   Display 0x04272d80: MappedDisplay Unit 0; Alias(4, 0x11); Vendor 0x610 Model 0x9cb6 S/N 0 Dimensions 13.03 x 8.15; online enabled built-in, Bounds (0,0)[1680 x 1050], Rotation 0, Resolution 1
Feb 14 14:12:06 sahara WindowServer[1494]:   Display 0x003f003f: MappedDisplay Unit 3; Vendor 0xffffffff Model 0xffffffff S/N -1 Dimensions 0.00 x 0.00; offline enabled, Bounds (2704,0)[1 x 1], Rotation 0, Resolution 1
Feb 14 14:12:06 sahara WindowServer[1494]:   Display 0x003f003e: MappedDisplay Unit 2; Vendor 0xffffffff Model 0xffffffff S/N -1 Dimensions 0.00 x 0.00; offline enabled, Bounds (2705,0)[1 x 1], Rotation 0, Resolution 1
Feb 14 14:12:06 sahara WindowServer[1494]:   Display 0x003f003d: MappedDisplay Unit 1; Vendor 0xffffffff Model 0xffffffff S/N -1 Dimensions 0.00 x 0.00; offline enabled, Bounds (2706,0)[1 x 1], Rotation 0, Resolution 1
Feb 14 14:12:06 sahara WindowServer[1494]: CGXMuxBoot: Boot normal
Feb 14 14:12:06 sahara WindowServer[1494]: GLCompositor: GL renderer id 0x01022647, GL mask 0x0000000f, accelerator 0x00003237, unit 0, caps QEX|QGL|MIPMAP, vram 1024 MB
Feb 14 14:12:06 sahara ReportCrash[1492]: Saved crash report for SecurityAgent[1452] version 7.0 (55116.8) to /Library/Logs/DiagnosticReports/SecurityAgent_2013-02-14-141206_sahara.crash
Feb 14 14:12:06 sahara ReportCrash[1492]: Removing excessive log: file://localhost/Library/Logs/DiagnosticReports/SecurityAgent_2013-02-05-100201_sahara.crash
Feb 14 14:12:06 sahara WindowServer[1494]: GLCompositor: GL renderer id 0x01022647, GL mask 0x0000000f, texture units 8, texture max 16384, viewport max {16384, 16384}, extensions FPRG|NPOT|GLSL|FLOAT
Feb 14 14:12:06 sahara WindowServer[1494]: GLCompositor: GL renderer id 0x01024400, GL mask 0x00000010, accelerator 0x000048c7, unit 4, caps QEX|QGL|MIPMAP, vram 420 MB
Feb 14 14:12:06 sahara WindowServer[1494]: GLCompositor: GL renderer id 0x01024400, GL mask 0x00000010, texture units 8, texture max 16384, viewport max {16384, 16384}, extensions FPRG|NPOT|GLSL|FLOAT
Feb 14 14:12:06 sahara loginwindow[1493]: **DMPROXY** Found `/System/Library/CoreServices/DMProxy'.
Feb 14 14:12:06 sahara WindowServer[1494]: Created shield window 0x8 for display 0x04272d80
Feb 14 14:12:06 sahara WindowServer[1494]: Display 0x04272d80: MappedDisplay Unit 0; ColorProfile { 2, "Color LCD"}; TransferTable (256, 3)
Feb 14 14:12:06 sahara launchctl[1496]: com.apple.findmymacmessenger: Already loaded
Feb 14 14:12:06 sahara com.apple.SecurityServer[20]: Session 100013 created
Feb 14 14:12:06 sahara hidd[69]: CGSShutdownServerConnections: Detaching application from window server
Feb 14 14:12:06 sahara hidd[69]: CGSDisplayServerShutdown: Detaching display subsystem from window server
Feb 14 14:12:06 sahara helpd[1503]: Could not find access page in directory /Library/Documentation/Help/Norton Help Scripts
Feb 14 14:12:06 --- last message repeated 1 time ---
Feb 14 14:12:06 sahara locationd[1505]: Incorrect NSStringEncoding value 0x8000100 detected. Assuming NSASCIIStringEncoding. Will stop this compatiblity mapping behavior in the near future.
Feb 14 14:12:06 sahara locationd[1505]: NOTICE,Location icon should now be in state 0
Feb 14 14:12:06 sahara UserEventAgent[1500]: cannot find useragent 1102
Feb 14 14:12:06 sahara loginwindow[1493]: Login Window Started Security Agent
Feb 14 14:12:06 sahara WindowServer[1494]: 3891612: App SecurityAgent cannot order in untagged windows before login.
Feb 14 14:12:06 sahara WindowServer[1494]: kCGErrorInvalidOperation: CGXOrderWinsAndPanels: error ordering window
Feb 14 14:12:07 sahara com.apple.launchd.peruser.92[1406]: Background: Bug: 12C3012: launchd + 80370 [7DCC9489-2DF5-3807-83FA-EF5666EE8078]: 0x0
Feb 14 14:12:07 sahara com.apple.launchd.peruser.92[1406]: Background: This API can only be used by a process running within an Aqua session.
Feb 14 14:12:07 sahara SecurityAgent[1506]: spawn_via_launchd() failed, errno=5 label=[0x0-0x5a05a].com.apple.AppleSpell path=/System/Library/Services/AppleSpell.service/Contents/MacOS/AppleSpell flags=0
Feb 14 14:12:07 --- last message repeated 1 time ---
Feb 14 14:12:07 sahara SecurityAgent[1506]: Error launching spell checker for U.S. English:  Error Domain=NSCocoaErrorDomain Code=256 "The application “AppleSpell.service” could not be launched because a miscellaneous error occurred (OSStatus -10810)." UserInfo=0x7fc6d8c60940 {NSURL=file://localhost/System/Library/Services/AppleSpell.service/, NSLocalizedDescription=The application “AppleSpell.service” could not be launched because a miscellaneous error occurred (OSStatus -10810)., NSUnderlyingError=0x7fc6d8c62330 "The operation couldn’t be completed. (OSStatus error -10810.)"}
Feb 14 14:12:08 sahara WindowServer[1494]: **DMPROXY** (2) Found `/System/Library/CoreServices/DMProxy'.
Feb 14 14:12:08 sahara WindowServer[1494]: Display 0x04272d80: MappedDisplay Unit 0; ColorProfile { 2, "Color LCD"}; TransferTable (256, 3)
Feb 14 14:12:09 --- last message repeated 1 time ---
Feb 14 14:12:09 sahara WindowServer[1494]: MPAccessSurfaceForDisplayDevice: Set up page flip mode on display 0x04272d80 device: 0x105604320  isBackBuffered: 1 numComp: 3 numDisp: 3 
```

# java - 将 Httpurl 连接的响应正确返回到 Web 浏览器

> ID：14885710
> 
> 赞同：0
> 
> 时间：2013-02-14T23:05:51.547
> 
> 标签：java, http, proxy

问题：如果页面在使用字符串时有图像，则将 http 消息的响应写回客户端（Web 浏览器）不会返回完整页面，所以我决定使用字节，但我仍然有同样的问题。我已经能够从请求中获取标头作为字符串并将其刷新到客户端，但我不确定如何处理该消息以确保它正确显示在 Web 浏览器上。

```
 //This portion takes the message from the Httpurl connection inputstream
        //the header has already been exttracted
        //uc here represents a httpurlconnection
       byte[] data = new byte[uc.getContentLength()];
        int bytesRead = 0;
        int offset = 0;
        InputStream in = new BufferedInputStream(uc.getInputStream());
        while (offset < uc.getContentLength()) {
        bytesRead =in.read(data, offset, data.length-offset);
        if (bytesRead == -1) break;
        offset += bytesRead; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:32:53.577

我建议您在阅读时将字节写入响应，并使用小缓冲区，这样您的服务器就不会受到大内存使用的影响。将所有字节加载到服务器内存中的数组中并不是一个好习惯。

这是一个快速示例：

```
response.setContentType("text/html;charset=UTF-8");
    OutputStream out = response.getOutputStream();
    HttpURLConnection uc;

// Setup the HTTP connection...

InputStream in = uc.getInputStream();
byte[] b = new byte[1024];
int bytesRead = 0;
while ( bytesRead != -1 ) {
    bytesRead = in.read(b);
    out.write(b);;
}

// Close the streams... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:04:18.157

您似乎正在使用图像代理 HTML 页面，并且您似乎期望 HTML 页面中的图像以某种方式自动内联在 HTML 源代码中。因此这是绝对不正确的。HTML 中的图像由具有指向 Web 浏览器必须单独调用和下载的 URL`<img>`的属性的元素表示。`src`完全相同的故事也适用于 CSS 和 JS 文件等其他资源。

您基本上需要解析获得的 HTML，扫描所有`<img src>`（必要时还扫描）元素`<link href>`并将`<script src>`它们的 URL 更改为您的代理的 URL，以便它可以单独提供所需的图像（和 CSS/JS）资源。

您可以在此答案中找到一个相关问题的启动示例：[Make HttpURLConnection load web pages with images](https://stackoverflow.com/questions/6280655/make-httpurlconnection-load-web-pages-with-images/6283394#6283394)

# php - 我可以授权用户，但不能将他们重定向到会员页面

> ID：14885711
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:06:14.183
> 
> 标签：php, wordpress

我为我的插件设计了一个登录页面，它可以完美运行并检查用户凭据，但是当用户被授权时，我无法移动到 px_member234.php 页面。

第一个页面是 px_myplugin234.php 然后它使用用于身份验证的 include(px_login234.php) 打开 px_login234.php 文件，我想这就是标题不起作用的原因。还有其他选择吗？

```
<form method="post" action="">
    ....
 </form>

 authorizer(){
  ........
  if(user_is_authorized)
    {
       //go to member.php page
       header ("Location:px_member234.php");  << does not work

    }
 } 
```

我也使用了以下但它不起作用

```
 echo '<script type="text/javascript">window.top.location="px_member234.php";</script>'; 
  echo '<script type="text/javascript">window.location="px_member234.php";</script>'; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:10:06.077

您可以使用标头重定向。要使用它，您必须确保在 header 命令之前没有输出任何内容。如果标头已发送，则此代码将不起作用

```
header("Location:member.php"); 
```

在您的示例中，身份验证代码必须位于页面顶部。如果您无法在标头函数调用之前阻止输出，您仍然可以向 html 页面添加元重定向标头或使用 JavaScript 设置新的`window.location`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T23:11:05.703

这是因为您在标题之前回显 HTML 内容。

当 PHP 看到实际输出时，它必须将所有的头刷新到 apache（后者将它们发送到客户端）。PHP 发送了标头并开始输出后，*无法*添加更多标头。

您的代码需要重构才能`header('Location: ...')`在输出任何内容之前调用

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:18:32.613

`header()`除了在页面中提到的其他输出之前调用该函数之外，您还应该`Location:`在 URL 和 URL 之间留一个空格。

你有什么：

```
header("Location:member.php"); 
```

什么会起作用：

```
header("Location: member.php"); 
```

## **更新**

尝试根据[HTTP/1.1 Header Field Definition](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)包含完整的 URI 而不是您的相对 URI 。

来自 php.net：

HTTP/1.1 需要绝对 URI 作为 » Location 的参数：包括方案、主机名和绝对路径，但有些客户端接受相对 URI。您通常可以使用`$_SERVER['HTTP_HOST']`,`$_SERVER['PHP_SELF']`并`dirname()`自己从相对的 URI 中创建一个绝对 URI。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T23:10:17.540

在您的表单标记中，您可以添加

```
<form method="post" action="?noheader=true">. 
```

?noheader=true 将阻止 Wordpress 输出任何标题。您可以在此处查看详细信息：http: [//www.lessthanweb.com/blog/wordpress-and-wp_redirect-function-problem](http://www.lessthanweb.com/blog/wordpress-and-wp_redirect-function-problem)

此外，在 wordpress 开发中，wp_redirect 优于 php 标头函数，因为它包含的钩子可以让它与其他插件很好地配合使用。

请注意，它需要您要重定向用户的绝对网址。由于您正在制作插件，因此可以使用 get_option('siteurl') 来获取根 url，以便：

```
<?php 
     wp_redirect(get_option('siteurl').'px_member234.php');
     exit;
?> 
```

# c - 获取环境变量的地址

> ID：14885716
> 
> 赞同：3
> 
> 时间：2013-02-14T23:06:39.810
> 
> 标签：c, linux, shell, gdb

我有一个环境变量，我正在尝试获取它的内存地址。我有

```
memset(&buffer, 0x90, 517);
memcpy(&buffer[517-strlen(shellcode)],shellcode,strlen(shellcode));
setenv("EGG",buffer,1);
putenv(buffer);
printf("EGG address: 0x%1x\n", getenv("EGG"));
system("bash"); 
```

它打印出来的内存地址是`0x804b00c`。那看起来不正确。我用 GDB x/x 检查了它`0x804b00c`。它说无法访问内存`0x804b00c`。所以`getenv`基本上是给我垃圾内存。我打电话`env`来确保`EGG`变量已设置，确实如此。

为什么我不能得到内存地址`EGG`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-30T23:21:18.037

感谢这个问题，另一个学习机会！

已将您的代码提炼为以下内容：

```
 #include <stdio.h>
    #include <stdlib.h>

    void main()
    {
      const char shellcode[] = "EGG=whatever";

      putenv(shellcode);

      printf("EGG address @%08X\n", getenv("EGG"));

      printf("EGG value is <%s>.", getenv("EGG"));

    } 
```

此代码在 Eclipse/Microsoft C 编译器环境中工作。请注意，我不必调用 setenv 或 bash 或发出系统命令。在此示例中，为进程设置了环境变量 EGG。

另外，请注意 EGG 的地址与其实际值之间的差异。在第一种情况下，getenv 返回 a ，它是指向printf 语句部分`char *`定义的存储的指针，而本质上是取消引用 getenv 返回的 char 指针。此外，通过语句找到 getenv()。`%08X``%s``#include <stdlib.h>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-29T23:31:56.603

初步的答案是你几乎没有 Endian 硬件。因此，字（4 个字节，在字边界处对齐）与半字和半字内的字节一起存储，SWAPPED。0x0804b00c 更可能真的在 0x0cb04b80。

将尝试编写我自己的 c 代码来做你想做的事情，并会发布第二个注释。

# php - 从 Android 接收 JSON 对象到 PHP Webservice

> ID：14885717
> 
> 赞同：0
> 
> 时间：2013-02-14T23:06:40.093
> 
> 标签：php, android, json

我试过查看几个链接，但我似乎无法正确理解。我正在尝试从我的 android 应用程序发送一个包含“用户名”和“密码”的 JSON 对象。但我不确定这些数据是否真的被发送到网络服务。我不太确定我是否获得了正确读取 php 脚本中 JSON 对象的代码。

```
 JSONObject jsonObject = new JSONObject();

    String userID = "";

    HttpClient httpClient = new DefaultHttpClient();
    HttpPost httpPost = new HttpPost(loginURI);
    HttpParams httpParams = new BasicHttpParams();
    HttpConnectionParams.setConnectionTimeout(httpParams, 10000);
    HttpConnectionParams.setSoTimeout(httpParams,10000);

    try {

        jsonObject.put("username", username);
        jsonObject.put("password", password);

        JSONArray array = new JSONArray();

        StringEntity stringEntity = new StringEntity(jsonObject.toString());
        stringEntity.setContentEncoding(new BasicHeader(HTTP.CONTENT_TYPE, "application/json"));
        httpPost.setEntity(stringEntity);
        HttpResponse httpResponse = httpClient.execute(httpPost);

        HttpEntity entity = httpResponse.getEntity();

        if (entity != null) {
            userID = EntityUtils.toString(httpResponse.getEntity());
            Log.i("Read from server", userID);
         }

    }catch (IOException e){
        Log.e("Login_Issue", e.toString());
    }catch (JSONException e) {
        e.printStackTrace(); 
    } 
```

这是 PHP 脚本的开始。

```
<?php

include('dbconnect.php'); 

$tablename = 'users';

 //username and password sent from android
$username=$_REQUEST['username'];
$password=$_REQUEST['password'];

 .....
 ?> 
```

你能告诉我我在这里做错了什么吗？我似乎无法弄清楚。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:18:31.043

`NameValuePairs`您应该为您的对象添加一个列表`HttpPost`，这样您就知道可以使用哪些键来检索 PHP 脚本中的数据。请参阅下面的示例代码片段。

爪哇：

```
List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
nameValuePairs.add(new BasicNameValuePair("username", username));
nameValuePairs.add(new BasicNameValuePair("password", password));
httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs)); 
```

PHP：

```
$username = $_POST['username']
$password = $_POST['password'] 
```

# coffeescript - Coffeescript 语法错误

> ID：14885721
> 
> 赞同：0
> 
> 时间：2013-02-14T23:07:00.487
> 
> 标签：coffeescript

这里有什么问题？

> ExecJS::ProgramError: Error: Parse error on line 11: Unexpected '.'

。咖啡

```
Person = Ember.Object.extend(
  firstName: null
  lastName: null
  fullName: ->
    firstName = @get("firstName")
    lastName = @get("lastName")
    firstName + " " + lastName
  .property("firstName", "lastName")
) 
```

原始.js

```
Person = Ember.Object.extend({
  // these will be supplied by `create`
  firstName: null,
  lastName: null,

  fullName: function() {
    var firstName = this.get('firstName');
    var lastName = this.get('lastName');

   return firstName + ' ' + lastName;
  }.property('firstName', 'lastName')
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:16:42.940

调用方法时需要添加大括号。

```
Person = Ember.Object.extend(
  firstName: null
  lastName: null
  fullName: (->
    firstName = @get("firstName")
    lastName = @get("lastName")
    firstName + " " + lastName
  ).property("firstName", "lastName")
) 
```

确实，它们在 Coffeescript 中是可选的，但在这种情况下，我认为您需要显式添加它们。至少这是我编译它的唯一方法。也许 Coffeescript 专家可以解释为什么。

# sql-server - 一个实体可以包含两个相同类型、唯一可访问的不同实体吗？

> ID：14885725
> 
> 赞同：0
> 
> 时间：2013-02-14T23:07:24.393
> 
> 标签：sql-server, asp.net-mvc, database, entity-framework, database-design

暂时忘记数据库和表格。假设我有一个 class`Spaceship`和一个 class `Person`。如果我正在编写`Contract`模型，我可能会这样做：

```
public class Spaceship {
  public string LicensePlate { get; set; } //
  public string Destination { get; set; }  //Regular old data
  public Person Captain { get; set; }
  public Person Engineer { get; set; }
} 
```

因为船长和工程师都是人，虽然他们的相关信息可能略有不同，但如果他们是同一类型，他们会保持最干燥。

但是如果我想在实体框架中建立这种关系呢？如果我在实体设计器中绘制它，我会建立这样的关系：

```
 ---------------------                   ---------------------
|      Spaceship      |                 |        Person       |
|---------------------|                 |---------------------|
|    LicensePlate     |                 |    Name             |
|    Destination      |                 |    PhoneNumber      |
|---------------------|                 |---------------------|
|Navigation Properties|                 |Navigation Properties|
|    People           |1---------------*|    Spaceship        |
 ---------------------                   --------------------- 
```

但这不是一回事。因为虽然两者`People`可以准确地共享同一个类，但它们之间的关系却有着`Spaceship`根本的不同。我想要一个 dbContext 我可以说

```
Spaceship Enterprise = new Spaceship();
Enterprise.Captain = People.Find("Kirk");
Enterprise.Engineer = People.Find("Scotty"); 
```

那是过分的要求？我的意思是，当然，还有其他方法。`Person`可能有一个`Role`“船长”或“工程师”，然后你可以将它们全部归为`Enterprise.People`. 如果您需要经常访问船长，您甚至可以制定一个`GetCaptain()`方法。`Spaceship`

但是，为了教育，

1.  **那可能吗？**
2.  **如果是这样，对实际数据库模式有什么影响？**
3.  **最好的方法是什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T03:44:24.647

您可以添加与 Person 表具有零或一对一关系的 Engineer 和 Captain 表，这将为您提供 Spaceship 的两个导航属性。如果您的模型发生更改并且任一子类型最终需要新的属性或方法，则此方法可能很有用。

# powershell - Powershell 按多个字段分组

> ID：14885728
> 
> 赞同：2
> 
> 时间：2013-02-14T23:07:49.423
> 
> 标签：powershell, powershell-3.0

以下脚本将返回两列。是否可以在显示文件名的列前面添加另一列？

```
ls | select -First 10 |
% { 
    cat $_ | Select-String `, -AllMatches | 
        Select-Object LineNumber, @{n="Count"; e={$_.Matches.Count}} | 
        Group-Object Count | 
        % {
            New-Object psobject -Property @{
                "Count" = $_.Name
                "LineNumbers" = ($_.Group | Select-Object -ExpandProperty LineNumber) 
            }
        }
} 
```

```
计算行号                            
----- ------------                            
77 {1, 2, 3, 4...}                        
78 {7, 15, 22, 43...}                     
79 {16、32、37、90...}                    
77 {1, 2, 3, 4...}                        
78 {7, 15, 22, 43...}                     
79 {16、32、37、90...}                    
77 {1, 2, 3, 4...}                        
78 {7, 15, 22, 43...}                     
79 {16、32、37、90...}                    
77 {1, 2, 3, 4...}                        
78 {7, 15, 22, 43...}                     
79 {16、32、37、90...}                    
77 {1, 2, 3, 4...}                        
78 {7, 15, 22, 43...}                     
79 {16、32、37、90...}                    
77 {1, 2, 3, 4...}                        
78 {7, 15, 22, 43...}                     
79 {16、32、37、90...}                    
89 {1, 2, 3, 4...}                        
89 {1, 2, 3, 4...}                        
89 {1, 2, 3, 4...}                        
89 {1, 2, 3, 4...}                        

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:11:52.460

试试这个（未经测试）：

```
ls | select -First 10 |
% {
    $filename = $_.Name 
    cat $_ | Select-String `, -AllMatches | 
        Select-Object LineNumber, @{n="Count"; e={$_.Matches.Count}} | 
        Group-Object Count | 
        % {
            New-Object psobject -Property @{
                "FileName" = $filename
                "Count" = $_.Name
                "LineNumbers" = ($_.Group | Select-Object -ExpandProperty LineNumber) 
            }
        }
} 
```

如果您想要文件路径而不仅仅是文件名，请将第 3 行更改为`$filename = $_.FullName`

# cryptography - Shamir 秘密共享和拉格朗日插值 (OpenSSL BIGNUM)

> ID：14885737
> 
> 赞同：3
> 
> 时间：2013-02-14T23:08:27.427
> 
> 标签：cryptography, openssl, bignum

我以前发布过类似的问题，所以我提前道歉，但我只是无法在这里找到我哪里出错了。

我正在使用 C 中的 OpenSSL 的 BIGNUM 库实现 Shamir 秘密共享。

在我进行一轮拉格朗日插值之后，我乘以`key * numerator`然后我需要除以分母。

因为没有`BN_mod_div`函数，所以我改为`BN_mod_inverse()`在分母上使用，然后相乘，如下所示：

`(key * numerator) * (inverse of denominator)`

我注意到的是，如果我使用`BN_mod_inverse(denom, denom, q, ctx);`，那么应该反转的值保持不变：

```
Round Key: 2E
Numerator: 14
Denominator: 6  **<---- ORIGINAL DENOMINATOR**
Multiply key with numerator: 398 (POSITIVE)
Invert Denominator: 6 (POSITIVE) **<---------- INVERSE IS THE SAME???**
(Key*Numerator)*inv.Denom: 3FC (POSITIVE)

Round Key: 562
Numerator: A
Denominator: -2
Multiply key with numerator: 118 (POSITIVE)
Invert Denominator: -2 (NEGATIVE)
(Key*Numerator)*inv.Denom: 3AC (POSITIVE)

Round Key: 5D1
Numerator: 8
Denominator: 3
Multiply key with numerator: 584 (POSITIVE)
Invert Denominator: 3 (POSITIVE)
(Key*Numerator)*inv.Denom: 4D4 (POSITIVE)
Recovered Key: C4 (POSITIVE)
Key should = 4D2 
```

如果我将其更改为`BN_mod_inverse(newBN, denom, q, ctx);`它只会变成零：

```
Round Key: 2E
Numerator: 14
Denominator: 6 **<---- ORIGINAL DENOMINATOR**
Multiply key with numerator: 398 (POSITIVE)
Invert Denominator: 0 (NEGATIVE)  **<------------ DENOMINATOR IS NOW ZERO??**
(Key*Numerator)*inv.Denom: 0 (NEGATIVE)

Round Key: 562
Numerator: A
Denominator: -2
Multiply key with numerator: 118 (POSITIVE)
Invert Denominator: 0 (NEGATIVE)
(Key*Numerator)*inv.Denom: 0 (NEGATIVE)

Round Key: 5D1
Numerator: 8
Denominator: 3
Multiply key with numerator: 584 (POSITIVE)
Invert Denominator: 0 (NEGATIVE)
(Key*Numerator)*inv.Denom: 0 (NEGATIVE)
Recovered Key: 0 (NEGATIVE)
Key should = 4D2 
```

在任何一种情况下，组合键都是错误的。这里发生了什么？有解决方法吗？

这是我的代码：

```
BIGNUM *int2BN(int i)
{   
    BIGNUM *tmp = BN_new();
    BN_zero(tmp);

    int g;
    if(i < 0) { //If 'i' is negative
        for (g = 0; g > i; g--) {
            BN_sub(tmp, tmp, one);
        }
    } else { //If 'i' is positive
        for (g = 0; g < i; g++) {
            BN_add(tmp, tmp, one);
        }
    }
    return(tmp);
}   

static void
blah() {
int denomTmp, numTmp, numAccum, denomAccum;
int s, j;   
BIGNUM *accum[3], *bnNum, *bnDenom;
bnNum = BN_new();
bnDenom = BN_new();

/* Lagrange Interpolation */
for (s = 0; s < 3; s++) {
    numAccum = 1;
    denomAccum = 1;
    for (j = 0; j < 3; j++) {
        if(s == j) continue;
        else {
            /* 0 - i[k] = numTmp */
            numTmp = 0 - key[j].keynum;

            /* share - i[k] = denomTmp */
            denomTmp = key[s].keynum - key[j].keynum;

            /* Numerator accumulation: */
            numAccum *= numTmp;

            /* Denominator accumulation: */
            denomAccum *= denomTmp;
        }
    }
    accum[s] = BN_new();
    bnNum = int2BN(numAccum);
    bnDenom = int2BN(denomAccum);

    /* Multiply result by share */
    BN_mod_mul(accum[s], key[s].key, bnNum, q, ctx);

    /* Invert denominator */
    BN_mod_inverse(bnDenom, bnDenom, q, ctx);

    /* Multiply by inverted denominator */
    BN_mod_mul(accum[s], accum[s], bnDenom, q, ctx);

}

int a;
BIGNUM *total = BN_new();
BN_zero(total);
for(a = 0; a < 3; a++) { 
    BN_mod_add(total, total, accum[a], q, ctx);
}   

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-02T09:17:01.480

使用`BN_div`. 余数是模数。即，`rem = a % d`。

```
int BN_div(BIGNUM *dv, BIGNUM *rem, const BIGNUM *a, const BIGNUM *d, BN_CTX *ctx);

BN_div() divides a by d and places the result in dv and the remainder in rem
(dv=a/d, rem=a%d). Either of dv and rem may be NULL, in which case the respective
value is not returned. The result is rounded towards zero; thus if a is negative,
the remainder will be zero or negative. For division by powers of 2, use
BN_rshift(3). 
```

# python - BeautifulSoup 的编码问题

> ID：14885742
> 
> 赞同：1
> 
> 时间：2013-02-14T23:08:52.653
> 
> 标签：python, beautifulsoup

我遇到了 BeautifulSoup 的编码问题。我正在尝试解析 Open Graph 标题，但它忽略了非 ascii 字符。

```
from bs4 import BeautifulSoup
doc = BeautifulSoup(html,"lxml")
doc.html.head.findAll('meta',attrs={'property':'og:title'}) 
```

对于[http://mattilintulahti.net/mediablogi/2013/02/11/19-asiaa-joita-et-tieda-mediayhtiosta-nimeltaan-red-bull/](http://mattilintulahti.net/mediablogi/2013/02/11/19-asiaa-joita-et-tieda-mediayhtiosta-nimeltaan-red-bull/)它打印出以下内容

```
19 asiaa joita et tied mediayhtist nimeltn Red Bull 
```

正确的在哪里

```
19 asiaa joita et tiedä mediayhtiöstä nimeltään Red Bull 
```

关于如何让 utf-8 正常工作的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:16:07.223

我无法重现该问题：

```
import urllib2
import bs4 as bs
url = 'http://mattilintulahti.net/mediablogi/2013/02/11/19-asiaa-joita-et-tieda-mediayhtiosta-nimeltaan-red-bull/'
html = urllib2.urlopen(url).read()
doc = bs.BeautifulSoup(html, 'lxml')
for meta in doc.html.head.findAll('meta', attrs={'property': 'og:title'}):
    print(meta.attrs['content']) 
```

产量

```
19 asiaa joita et tiedä mediayhtiöstä nimeltään Red Bull 
```

如果这没有帮助，请显示您的代码。

# java - 如何删除字符串末尾的正在运行的字符？

> ID：14885747
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:09:31.930
> 
> 标签：java

假设我已经将大量数据解析`130,233,320,000,000,000`为`130,233,320,,,`如何递归删除运行逗号的子字符串以获得输出`130,233,320`

递归算法看起来很简单，例如：

```
public String parseEnd(String s) {
  if(s.substring(s.length-1) == ",") {
     return s.substring(0, s.length-2);
  }
  return s;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:11:33.597

你去：

```
str = str.replaceAll(",+$", ""); 
```

`,`这将在末尾替换一个或多个，用空字符串。

*   `,+`匹配 1 个或多个`commas`
*   `$`表示字符串的结束。

现在，我不明白的一件事是，你是怎么`consecutive commas`从那个字符串中得到的？你不能直接替换所有的`000`吗`comma`？这将是这样的：

```
str = str.replaceAll("(?:,0+)+$", ""); 
```

# linux - ssh 脚本返回 255 错误

> ID：14885748
> 
> 赞同：57
> 
> 时间：2013-02-14T23:09:35.137
> 
> 标签：linux, bash, shell, ssh

在我的代码中，我有以下内容来运行远程脚本。

```
ssh root@host.domain.com "sh /home/user/backup_mysql.sh" 
```

出于某种原因，我一直在 255'ing。有任何想法吗？

我可以 SSH 进入盒子就好了（无密码设置）

远程脚本：

```
MUSER='root' 
MPASS='123123'
MHOST="127.0.0.1"
VERBOSE=0

### Set bins path ###
GZIP=/bin/gzip
MYSQL=/usr/bin/mysql
MYSQLDUMP=/usr/bin/mysqldump
RM=/bin/rm
MKDIR=/bin/mkdir
MYSQLADMIN=/usr/bin/mysqladmin
GREP=/bin/grep

### Setup dump directory ###
BAKRSNROOT=/.snapshots/tmp

#####################################
### ----[ No Editing below ]------###
#####################################
### Default time format ###
TIME_FORMAT='%H_%M_%S%P'

### Make a backup ###
backup_mysql_rsnapshot(){
        local DBS="$($MYSQL -u $MUSER -h $MHOST -p$MPASS -Bse 'show databases')"
        local db="";
        [ ! -d $BAKRSNROOT ] && ${MKDIR} -p $BAKRSNROOT
        ${RM} -f $BAKRSNROOT/* >/dev/null 2>&1
#       [ $VERBOSE -eq 1 ] && echo "*** Dumping MySQL Database ***"
#       [ $VERBOSE -eq 1 ] && echo -n "Database> "
        for db in $DBS
        do
                local tTime=$(date +"${TIME_FORMAT}")
                local FILE="${BAKRSNROOT}/${db}.${tTime}.gz"
#               [ $VERBOSE -eq 1 ] && echo -n "$db.."
                ${MYSQLDUMP} --single-transaction -u ${MUSER} -h ${MHOST} -p${MPASS} $db | ${GZIP} -9 > $FILE
        done
#               [ $VERBOSE -eq 1 ] && echo ""
#               [ $VERBOSE -eq 1 ] && echo "*** Backup done [ files wrote to $BAKRSNROOT] ***"
}

### Die on demand with message ###
die(){
        echo "$@"
        exit 999
}

### Make sure bins exists.. else die
verify_bins(){
        [ ! -x $GZIP ] && die "File $GZIP does not exists. Make sure correct path is set in $0."
        [ ! -x $MYSQL ] && die "File $MYSQL does not exists. Make sure correct path is set in $0."
        [ ! -x $MYSQLDUMP ] && die "File $MYSQLDUMP does not exists. Make sure correct path is set in $0."
        [ ! -x $RM ] && die "File $RM does not exists. Make sure correct path is set in $0."
        [ ! -x $MKDIR ] && die "File $MKDIR does not exists. Make sure correct path is set in $0."
        [ ! -x $MYSQLADMIN ] && die "File $MYSQLADMIN does not exists. Make sure correct path is set in $0."
        [ ! -x $GREP ] && die "File $GREP does not exists. Make sure correct path is set in $0."
}

### Make sure we can connect to server ... else die
verify_mysql_connection(){
        $MYSQLADMIN  -u $MUSER -h $MHOST -p$MPASS ping | $GREP 'alive'>/dev/null
        [ $? -eq 0 ] || die "Error: Cannot connect to MySQL Server. Make sure username and password are set correctly in $0"
}

### main ####
verify_bins
verify_mysql_connection
backup_mysql_rsnapshot 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-14T23:30:28.763

这通常发生在遥控器关闭/不可用时；或者远程机器没有安装 ssh；或者防火墙不允许与远程主机建立连接。

`ssh`发生错误或远程脚本返回 255 时返回 255：

```
 EXIT STATUS

     ssh exits with the exit status of the remote command or
     with 255 if an error occurred. 
```

通常您会收到类似于以下内容的错误消息：

```
ssh: connect to host host.domain.com port 22: No route to host 
```

或者

```
ssh: connect to host HOSTNAME port 22: Connection refused 
```

**清单：**

*   如果直接从命令行运行 ssh 命令会发生什么？

*   你能用`ping`那台机器吗？

*   遥控器是否安装了 ssh？

*   如果已安装，那么 ssh 服务是否正在运行？

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-07-11T01:59:05.130

将 pdsh 用于“known_hosts”文件中未包含的主机时也会发生此错误。

我可以通过手动 SSH 连接到每个主机并接受“你想将它添加到已知主机”的问题来纠正这个问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-14T23:28:35.363

如果身份验证或连接出现问题，例如无法从终端读取密码，ssh 将以 255 退出，而无法运行您的实际脚本。验证以确保您可以改为运行“true”，以查看 ssh 连接是否已成功建立。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-18T21:59:42.677

我被这件事难住了。一旦我通过了 255 问题......我最终得到了一个神秘的错误代码 1。这是解决这个问题的 foo：

```
 pssh -x '-tt' -h HOSTFILELIST -P "sudo yum -y install glibc" 
```

-P 表示随心所欲地写出输出，并且是可选的。但是**-x '-tt'**技巧是强制分配伪 tty 的原因。

如果您尝试以下操作，您可以了解错误代码 1 的含义：

```
ssh AHOST "sudo yum -y install glibc" 
```

你可能会看到：

```
[slc@bastion-ci ~]$ ssh MYHOST "sudo yum -y install glibc"
sudo: sorry, you must have a tty to run sudo
[slc@bastion-ci ~]$ echo $?
1 
```

请注意，它的返回码是 1，这是 pssh 向您报告的。

[我在这里](https://www.shell-tips.com/2014/09/08/sudo-sorry-you-must-have-a-tty-to-run-sudo/)找到了这个 -x -tt 技巧。另请注意，在这些情况下打开详细模式 (pssh --verbose) 对您没有任何帮助。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-12-23T10:54:29.993

这很可能是一个 ssh-agent 问题。检查当前是否有 ssh-agent PID 正在运行`eval "$(ssh-agent -s)"`

检查您的身份是否已添加，`ssh-add -l`如果没有，请添加`ssh-add <pathToYourRSAKey>`。

然后再次尝试返回 255 的 ssh 命令（或任何其他生成 ssh 守护进程的命令，例如**autossh**）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-11-03T21:01:07.037

问题不在于：

```
### Die on demand with message ###
die(){
  echo "$@"
  exit 999
} 
```

如果我错了，请纠正我，但我认为退出 999 超出了退出代码的范围，导致退出状态为 255。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-29T23:22:28.913

如果以上没有帮助：检查客户端和服务器上的语言环境是否有效：
[https ://www.linuxbabe.com/linux-server/fix-ssh-locale-environment-variable-error](https://www.linuxbabe.com/linux-server/fix-ssh-locale-environment-variable-error)
[如何不通过 ssh 传递语言环境](https://stackoverflow.com/questions/29609371/how-do-not-pass-locale-through-ssh)

# c# - 乘法表显示不正确

> ID：14885760
> 
> 赞同：0
> 
> 时间：2013-02-14T23:10:14.560
> 
> 标签：c#, multiplication

我必须编写一个代码来制作一个 10x10 乘法表，它的显示必须如下所示：

![在此处输入图像描述](../Images/fbc2e4c701bda85cec08a3d6be50c039.png)

但是，我不知道如何正确显示我的代码。下面是我的代码。我知道我很接近，我只是不确定我做错了什么。

```
/*
 * This program displays a multiplication table of the product of every integer from 1 through 10
 * multiplied by every integer from 1 through 10.
 * 
 */

using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace DisplayMultiplicationTable
{
    class Program
    {
        static void Main(string[] args)
        {
            int value = 10;

            for (int x = 1; x <= value; ++x)

                Console.Write("{0, 4}", x);
            Console.WriteLine();
            Console.WriteLine("_________________________________________");

            for (int x = 1; x <= value; ++x)

                Console.WriteLine("{0, 4}", x);

            for (int row = 1; row <= value; ++row)
            {
                for (int column = 1; column <= value; ++column)
                {

                    Console.Write("{0, 4}", row * column);

                }
                Console.WriteLine();

            }
            Console.ReadLine();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:16:06.997

添加 ：

```
Console.Write("{0, 4}", row); 
```

在`row`for 语句开始之后

固定代码：

```
 static void Main(string[] args)
    {
        int value = 10;

        Console.Write("    ");
        for (int x = 1; x <= value; ++x)
            Console.Write("{0, 4}", x);

        Console.WriteLine();
        Console.WriteLine("_____________________________________________");

        for (int row = 1; row <= value; ++row)
        {
            Console.Write("{0, 4}", row);
            for (int column = 1; column <= value; ++column)
            {
                Console.Write("{0, 4}", row * column);
            }
            Console.WriteLine();
        }
        Console.ReadLine();
    } 
```

结果 ：

![展示](../Images/da65aae36c7328be3b9efbd0785f5b09.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:18:51.753

```
 int value = 10;

    // Indent column headers
    Console.Write("{0, 4}", null);

    // Write column headers
    for (int x = 1; x <= value; ++x)
        Console.Write("{0, 4}", x);

    // Write column header seperator
    Console.WriteLine();
    Console.WriteLine("_____________________________________________");

    // Write the table
    for (int row = 1; row <= value; ++row)
    {
        // Write the row header
        Console.Write("{0, 4}", row);

        for (int column = 1; column <= value; ++column)
        {
            // Write the row values
            Console.Write("{0, 4}", row * column);
        }
        // Finish the line
        Console.WriteLine();

    } 
```

![在此处输入图像描述](../Images/2453aea9b2d1d09805b720cfa4acc9b6.png)

# node.js - 从移动客户端执行 oAuth 的“正确”方式

> ID：14885762
> 
> 赞同：9
> 
> 时间：2013-02-14T23:10:16.800
> 
> 标签：node.js, oauth, xamarin.ios, xamarin.android, passport.js

我正在构建一个跨平台移动应用程序（使用 Xamarian 工具、MonoTouch / MonoDroid）。我正在尝试完成身份验证工作流程，但遇到了绊脚石。我已经到处寻找一个明确的答案，但还没有找到。

这是我当前设置的概述。

我有一个用 nodejs 构建的网站。我使用 passport.js 在网站上进行 oAuth 登录。这很好用，用户可以使用 Twitter 或 Facebook 登录我的网站。

现在我想将同样的登录功能扩展到我的移动客户端。

我看到 2 个选项

1.  在移动客户端中嵌入应用程序 ID 和应用程序密码，并从移动应用程序直接向 FB 或 Twitter 进行 oAuth 调用

2.  通过我现有的 nodejs Web 服务器代理 oAuth 调用（将密钥保存在服务器上）

选项 2 似乎是首选方式（因为它避免了在移动应用程序中“传送”秘密）。

我有代理方法主要工作。

1.  我在我的移动客户端中打开一个 WebView 并将其指向`http://mysever/auth/twitter`
2.  这将贯穿我现有的 passport.js 代码，并将移动 WebView 重定向到 Twitter 登录页面。
3.  然后，用户在设备上的推特网页上输入他们的信用。
4.  Twitter 然后调用我的 oAuth 回调 URL（这是我的 nodejs 网络服务器）。
5.  我的服务器和 Twitter 处理获取用户个人资料信息的第四次握手（**据我了解，这是这种方法的关键，我的服务器和 Twitter 处理握手，移动客户端无需执行任何操作或通过此过程中的任何令牌**）

**这是我的问题**：

1.  正是这最后一步让我难过。在我的服务器上完成握手后，我在服务器上就有了我需要的用户信息，并且**需要将其发送回移动客户端应用程序**

    我无法在 WebView 控件中找到任何方法来获取响应对象并获取 cookie 或标头值（例如）（这对于 Android 和 iOS 来说似乎是正确的）。我不认为它是特定于平台的。我想我正在尝试做一些移动平台中的 WebView 小部件不支持的事情。这让我觉得我错过了一些明显的东西。

我唯一想出的就是让我的网络服务器将移动客户端浏览器“重定向”到一个在查询字符串中包含用户信息的虚假 URL。类似 myapp://info?userid=1234

然后在移动应用程序中，我可以劫持 URL 加载并获取此 url 并获取我需要的数据。然后，我可以存储此用户信息，关闭 WebView 控件并转到我的移动应用程序中的本机屏幕，并在对我的 nodejs 服务器的任何后续 REST 调用中使用用户信息，作为识别用户的一种方式。

由于多种原因，这非常笨拙。其中最大的原因是 url 是通过未加密的线路发送的，并且所有数据都是纯文本的。

**必须有更好的方法将数据从 Web 服务器返回到移动客户端？**

还是我做错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:55:29.020

为 Xamarin（适用于 iOS 和 Android）实现 oauth 的最直接方法是使用[Xamarin.Auth](https://github.com/xamarin/Xamarin.Auth)。客户端的入门文档在[这里](https://github.com/xamarin/Xamarin.Auth/blob/master/GettingStarted.md)。我认为它应该安全地维护一切，您不必担心必须将节点服务器用作代理。

您需要在调用过程中提供您的应用程序 ID，但我不需要担心太多或任何安全问题。

我知道这与您已经实现的内容背道而驰，但也许这有助于简化一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T08:07:11.540

这与我一直在处理的困境相同。这就是我目前的处理方式。在我的应用程序中，客户可以直接来，也可以通过其他服务来，例如 facebook，这是我的主要服务，因此也是我专注的服务。

Facebook 可以通过 POST（桌面应用程序）或 GET（移动设备）重定向。

我检查初始请求，看看是否有服务标识符 - 例如，这里是 facebook GET。

```
app.get('/', function(req, res) {
var paraUrl = URL.parse(req.url,true).query;
//The fb_source is shown - 
//i need to go striaght to the facebook authorization since 
//its coming from
//from a mobile device.
if (paraUrl.fb_source){
res.redirect('/auth/facebook'); //this is the passport part
return;
}
res.sendfile('index.html');
} 
```

facebook POST 略有不同，因为您在 base64url 中获得了访问令牌编码。GET 为您提供了一个代码，您可以用它交换访问令牌，但我遇到了问题，只是选择绑定到护照系统。

如果客户直接来，我会检查会话或与本地策略相关的加密 cookie。然后，这会检查数据库中的访问令牌，例如，该令牌可用于访问 facebook api。

如果客户无法识别，他们可以选择通过 facebook、google 等进行身份验证。

主要的是客户端只存储了2条信息，护照会话ID和我的应用程序用户ID

connect.sid - 加密的 cookie

userId - 加密的 cookie

我很想知道其他人是如何处理问题的

# xcode - 分析 POST 请求 PhoneGap

> ID：14885765
> 
> 赞同：0
> 
> 时间：2013-02-14T23:10:39.340
> 
> 标签：xcode, networking, cordova

我正在使用 PhoneGap 制作应用程序，并向 Web 服务发送 POST 请求。现在我需要分析正在发送的请求。我应该使用什么工具来做到这一点 - Wireshark？

我正在使用 Mac。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:12:18.090

Wire Shark 可以做到这一点，但它不仅仅监控基于 HTTP 的请求。

尝试为此使用**Fiddler**。

[http://www.fiddler2.com/fiddler2/version.asp](http://www.fiddler2.com/fiddler2/version.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:12:52.203

查看帖子外观的一种简单方法是将其发布到[http://requestb.in/](http://requestb.in/)之类的地方。这样您就可以从您的应用程序本身对其进行测试。基本上将您的发帖位置更改为您创建的帖子箱。

# c# - Writeline 未将某些选项卡写入输出文件

> ID：14885768
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:10:48.247
> 
> 标签：c#, string-formatting, delimiter

我正在尝试编写一个制表符分隔的文本文件，其数据类似于以下内容：

```
ColHead1 ColHead2 ... Colhead10

Row1Dat1 Row1Dat2 ... Row1Dat10

Row2Dat1 Row2Dat2 ... Row2Dat10 
```

但是，在调试我的代码时，我注意到有几个选项卡没有出现。这是我目前正在尝试的代码：

```
string columnHeaders = string.Format("ColHead1\tColHead2\tColHead3\tColHead4\tColHead5\tColHead6\tColHead7\tColHead8\tColHead9\tColHead10");
fileW.WriteLine(columnHeaders);
string row1 = string.Format("{0}\t{1}\t{2}\t{3}\t{4}\t{5}\t{6}\t{7}\t{8}\t{9}", val1, val2, val3, val4, val5, val6, val7, val8, val9, val10);
fileW.WriteLine(row1);
string row2 = string.Format("{0}\t{1}\t{2}\t{3}\t{4}\t{5}\t{6}\t{7}\t{8}\t{9}", val11, val12, val13, val14, val15, val16, val17, val18, val19, val20);
fileW.WriteLine(row2); 
```

具体来说，当我查看 row1 或 row2 中的值时，它的格式如下（在任一行上）：

```
dat1    dat2(noTabHere)dat3    dat4    dat5    dat6    dat7    dat8    dat9(noTabHere)dat10 
```

为什么没有插入这两个选项卡，我该怎么做才能确保它们正确插入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:20:56.103

也许这些选项卡变得太小了，因为前面的值太宽了？

```
0   1   2   15  162 102819201924
.   .   .   .   .   .   .   . 
```

# javascript - Ypipes 和 wookmark jquery 插件

> ID：14885769
> 
> 赞同：0
> 
> 时间：2013-02-14T23:10:57.990
> 
> 标签：javascript, image-resizing, yahoo-pipes

我正在尝试将雅虎管道与 wookmark jquery 结合起来。我遇到的问题是一些图像没有正确调整大小。我在[http://justawebbie.com/wookmark-ypipe/](http://justawebbie.com/wookmark-ypipe/)上有。该页面非常干净，只是上面有 wookmark 和管道的代码。

有人可以帮我弄清楚我在将这些组合到脚本时做错了什么吗？

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-16T14:13:48.393

只需将“.tiles li img { width: 200px !important; height: auto; }” 添加到您的 CSS 中，就可以了。

# c# - IsFacing 和 IsBehind 计算

> ID：14885770
> 
> 赞同：0
> 
> 时间：2013-02-14T23:11:01.883
> 
> 标签：c#

我正在寻找更好的方法来计算一个对象是面向另一个对象还是一个对象在另一个对象后面。到目前为止，我已经能够创建它，但它似乎不能 100% 正确工作:(

我也认为它应该是弧度而不是度数。

```
public static float GetAngle(float x1, float y1, float x2, float y2)
{
    float xDiff = x2 - x1;
    float yDiff = y2 - y1;
    var angle = RadianToDegree((float)Math.Atan2(yDiff, xDiff));

    if (angle < 0)
        return 360 + angle;

        return angle;
    }

public static bool IsFacing(Point obj, float rotationAngle, Point target, float arcDegree = 180)
{
    var angleBetweenPoints = GetAngle(obj, target);

    return rotationAngle >= angleBetweenPoints - arcDegree / 2 && rotationAngle <= angleBetweenPoints + arcDegree / 2;
}

public static bool IsBehind(Point obj, float rotationAngle, Point target, float arcDegree = 180)
{
    var angleBetweenPoints = GetAngle(obj, target);
    var backViewAngle = rotationAngle > 180 ? rotationAngle - 180 : 180 - rotationAngle;
    return backViewAngle >= angleBetweenPoints - arcDegree / 2 && backViewAngle <= angleBetweenPoints + arcDegree / 2;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:15:01.677

乍一看，您的问题似乎出在方法中的`rotationAngle`vs测试中。`angleBetweenPoints``IsFacing()`

鉴于：

```
rotationAngle = 0, angleBetweenPoints = 350, arcDegree = 180 
```

那么测试将是：

```
test = 0 >= (350 - 180 / 2) && 0 <= (350 + 180 / 2)
     = 0 >= 260 && 0 <= 440
     = false 
```

这会经常发生，这是由于您的角度使用了范围 [0..360]。虽然这在某些情况下很有用，但这不是其中一种情况。这里更有用的是在 [-180..180] 范围内获得航向角和目标角的差异，然后比较`arcDegree`变得简单得多。

尝试这个：

```
// Adjust a value to fit in the specified range
public static float Clamp(float v, float low, float high)
{
    float range = high - low;
    float modifier = ((int)((v - low) / range) - (v < low ? 1 : 0)) * range;
    v -= modifier;
    return v;
}

// Get the angle between a point+heading and another point
// Returns an angle in the range (-180..180) where:
//  res < 0     target clockwise from heading
//  res == 0    target at heading
//  res > 0     target counter-clockwise from heading
static float RelativeAngle(float heading, float x1, float y1, float x2, float y2)
{
    // get angle between points in world coordinates
    float angle = RadianToDegree((float)Math.Atan2(y2 - y1, x2 - x1));
    // adjust to local coordinates and normalize
    return Clamp(angle - heading, -180, 180);
}

public static bool IsFacing(Point obj, float rotationAngle, Point target, float arcDegree = 180)
{
    var angleBetweenPoints = RelativeAngle(rotationAngle, obj.x, obj.y, target.x, target.y);
    return angleBetweenPoints >= -(arcDegree / 2) && angleBetweenPoints <= (arcDegre / 2);
} 
```

# hash - md5哈希值变化

> ID：14885773
> 
> 赞同：0
> 
> 时间：2013-02-14T23:11:21.397
> 
> 标签：hash, md5

我已经使用 md5 为文件生成了哈希值。如果文件中有任何更改，则哈希值会更改。当文件权限被修改时它也会改变吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:12:06.777

不会。文件的 MD5 哈希与其内容有关，而不是与其权限有关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:15:10.180

如果您输入到 MD5 散列函数的任何数据发生任何变化，MD5 散列就会发生变化。如果你给它提供了权限并且权限改变了，那么 MD5 哈希值就会改变。如果你只给它提供内容，那么 MD5 哈希只有在内容改变时才会改变。

你得到什么取决于你投入了什么。你没有告诉我们你投入了什么。所以我们不能告诉你输出取决于什么。

# sql-server - 用户“NT AUTHORITY\ANONYMOUS LOGON”的 IIS 登录失败

> ID：14885776
> 
> 赞同：2
> 
> 时间：2013-02-14T23:11:45.230
> 
> 标签：sql-server, security, iis-6

我有一个 iis6 框，该应用程序池配置为使用 Active Directory 服务帐户。

我正在运行一个经典的 asp 应用程序，我想使用服务帐户连接到数据库，所以我将其作为连接字符串：“provider=SQLOLEDB.1;server=myserver;database=mydb;Integrated Security= SSPI"

我究竟做错了什么？

# java - Java Apache HTTPClient 不编码 POST 实体

> ID：14885780
> 
> 赞同：0
> 
> 时间：2013-02-14T23:11:55.500
> 
> 标签：java, apache, httpclient

我有一个端点需要一个“authenticity_token”，其格式如下：

```
Iq2rNXN+OxERv+s6TSloJfKkPZVvqnWe1m0NfODB5OI= 
```

但是，有时它具有“特殊”字符，例如：

```
E7IzeP73OgPGgXM&#47;up295ky1mMQMio2Nb8HMLxJFyfw= 
```

这被编码为：

```
E7IzeP73OgPGgXM%26%2347%3Bup295ky1mMQMio2Nb8HMLxJFyfw%3D 
```

出于某种原因，端点不喜欢那些特殊字符的编码，会认为令牌无效。是否可以添加不编码特定值的 POST 变量？我目前正在做类似的事情：

```
 HttpPost post = new HttpPost(URL + NEW_FINDING);
    List <NameValuePair> nvps = new ArrayList <NameValuePair>();
    nvps.add(new BasicNameValuePair("foo", foo));
    nvps.add(new BasicNameValuePair("authenticity_token", authenticityToken));
    post.setEntity(new UrlEncodedFormEntity(nvps)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:08:59.407

您始终可以使用`ByteArrayEntity`or`StringEntity`代替`UrlEncodedFormEntity`并自己进行编码。它应该看起来像`foo=var1&bar=var2`.
您必须设置`Content-Type=application/x-www-form-urlencoded`
您可能想要找出您的端点期望作为`application/x-www-form-urlencoded`Content-Type 标头值的字符集参数。然后将其作为参数传递给`UrlEncodedFormEntity`构造函数。这应该是正确的解决方法。

# android - 颁发测试许可

> ID：14885781
> 
> 赞同：0
> 
> 时间：2013-02-14T23:11:55.873
> 
> 标签：android, google-play, android-lvl

请看下图...

我正在尝试设置响应，以便我可以测试我的许可逻辑。但我想我把自己画到了一个角落。当我第一次注册我的开发者帐户时，我使用了我的真实电子邮件地址 gary@deanblakely.com。当我拿到我用于测试的 android 手机时，我必须使用 gmail 帐户，因此设置 deanblakelyuser@gmail.com 并且该地址用于我的手机帐户。

现在，如果您查看右下方的图形，其中显示“此许可证测试响应将使用 gary@deanblakely.com 发送到设备......”

但是，如果我理解正确，我的安卓测试手机上的帐户必须是 gmail 帐户，并且我选择的回复不起作用。

然后我想我会简单地更改我的开发者帐户上的电子邮件地址，但不会改变它。

我该如何解决这种情况？

![在应用计费剪辑](../Images/a3239638697975506918aa6279d9151f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T22:49:17.903

当您注册开发者帐户时，您使用的电子邮件地址是该帐户的主要地址，就像您猜到的那样。详细信息页面上的电子邮件帐户主要用于通信。不幸的是，如果不上传 apk，就无法将测试响应发送到测试设备。它只会将其发送到与您的主要开发者帐户关联的设备。

如果您只想测试响应，您所要做的就是：

*   将您的 gmail（测试）帐户添加到测试帐户字段
*   将 apk 上传到 Google Play

注意我说的是上传，而不是发布。您不必拥有“实时”应用程序，只需上传即可。

# .htaccess - htaccess - 测试一个重写的 url

> ID：14885783
> 
> 赞同：1
> 
> 时间：2013-02-14T23:12:02.253
> 
> 标签：.htaccess, mod-rewrite

我有以下代码，它采用像“www.example.com/foo”这样的网址并将其重写为“www.example.com/html/foo.php”

```
RewriteCond %{REQUEST_FILENAME} !-d [NC]
RewriteRule ^([^\.]+)$ html/$1.php [NC] 
```

我想修改这个，如果重写的 url: 'www.example.com/html/foo.php' 不存在，则 url 被重写为 'www.example.com/html/fallback.php?query=富'

我已经转了几个小时了。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:26:28.980

您可以尝试先检查文件是否存在（使用`-f`），然后再进行您拥有的重写：

```
RewriteCond %{REQUEST_FILENAME} !-d [NC]
RewriteCond %{REQUEST_FILENAME} !-f [NC]
RewriteCond %{REQUEST_URI} ^([^\.]+)$
RewriteCond %{DOCUMENT_ROOT}/html/%1.php !-f
RewriteRule ^ html/fallback.php?query=%1 [L,QSA]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^\.]+)$ html/$1.php [L] 
```

# iphone - 附加到正在运行的进程时出现 iPhone GDB 分段错误

> ID：14885787
> 
> 赞同：0
> 
> 时间：2013-02-14T23:12:18.450
> 
> 标签：iphone, ios, gdb, jailbreak

我有一台运行 iOS 6.0.1 的越狱 iPhone 5。我在这里使用 pod2g 的教程安装了 gdb：[www.pod2g.org/2012/02/working-gnu-debugger-on-ios-43.html](http://www.pod2g.org/2012/02/working-gnu-debugger-on-ios-43.html)

所有步骤都奏效了，我将 gdb 复制到我越狱的 iPhone 上，这样我就可以在那里使用它了。gdb 启动得很好，但是当我尝试使用附加到 SpringBoard（或任何其他正在运行的进程，如 Twitter）时

```
(gdb) attach SpringBoard 
```

有时候是这样的：

```
Attaching to process 7366.
Segmentation fault:11 
```

然后我返回到 MobileTerminal 或 ssh 提示符（不是 gdb 提示符）。看起来 gdb 已经崩溃，而不是 SpringBoard，因为我的 iPhone 没有重新启动（就像 SpringBoard 崩溃或被杀死时通常那样）。我也尝试使用来自 cydia.radare.org 源的 gdb 连接到 SpringBoard，每次都会发生完全相同的事情。大约一周前，来自 cydia.radare.org 源的 gdb 工作得很好，但现在来自 pod2g 教程的 gdb 和来自 Cydia 源的 gdb 都产生了上述输出。我尝试以 root 身份运行 gdb 并且发生了同样的事情。我用谷歌搜索，我似乎找不到这样的东西。出了什么问题，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T20:03:34.963

Apple 添加了一个 PTrace 选项来防止调试器（如 GDB）附加到进程。幸运的是，您也可以使用 GDB 来规避这一点。这是一个很好的描述：http: [//iphonedevwiki.net/index.php/Crack_prevention#PT_DENY_ATTACH](http://iphonedevwiki.net/index.php/Crack_prevention#PT_DENY_ATTACH)

# java - Android - Canvas.drawBitmap 在某些设备上无法正常工作

> ID：14885789
> 
> 赞同：1
> 
> 时间：2013-02-14T23:12:54.287
> 
> 标签：java, android, android-canvas, buffering, drawbitmap

我的 android 应用程序在飞机上绘制函数图时遇到问题。为此，我使用自定义视图。用户可以通过触摸平移坐标系。在 onDraw 方法中，坐标系和标签直接绘制在视图的画布上，但是图形本身被缓冲到一个额外的位图上（出于性能原因） - 在手指移动期间，这个位图被绘制到视图的画布上翻译以匹配坐标系，只有在用户松开触摸时才重绘功能。

```
public void onDraw(Canvas canvas){
    if (start) {
        bitmap = Bitmap.createBitmap(getWidth(), getHeight(), Bitmap.Config.ARGB_4444);
        hCanvas = new Canvas(bitmap);
        start = false;
    }
    drawCoordinateSystem(canvas);
    drawFunctions(canvas,bitmap,hCanvas);
} 
```

在 onTouch 事件监听器中，我调用了 invalidate()。有一个布尔“移动”，对于 ACTION_UP 设置为 true，对于 ACTION_DOWN 设置为 false。

```
public void drawFunctions(Canvas canvas,Bitmap bitmap,Canvas hCanvas){
    if (moving) canvas.drawBitmap(bitmap,left+translateX,top+translateY,paint);
    else {
        hCanvas.drawColor(Color.TRANSPARENT,PorterDuff.Mode.CLEAR);

        //code for drawing the functions on hCanvas

        canvas.drawBitmap(bitmap,0,0,paint);
    }   
} 
```

在 ACTION_MOVE 中，我适当地计算 translateX 和 translateY 值。

现在问题出在哪里：如果我为 sdk 10 编译应用程序，它在我测试过的所有设备上都可以正常工作（android 2.2-4.2 智能手机和平板电脑，虚拟和物理）。但是，当我为 sdk 14 编译它时，它适用于许多设备，除了某些平板电脑，其中坐标系绘制正确，但不知何故，包含函数的位图未绘制在视图的画布上，并且函数不可见. 奇怪的是，如果我尝试用视图的画布制作位图：

```
Bitmap bmp = this.getDrawingCache();
bmp.compress(Bitmap.CompressFormat.PNG, 100, out); 
```

在保存的位图中，功能是可见的。

另一件事是 - ia Nexus 7 出现问题，同时在使用预设 Nexus 7 创建的 AVD 上一切正常。

可能是什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T04:44:01.333

[http://developer.android.com/reference/android/graphics/Bitmap.Config.html](http://developer.android.com/reference/android/graphics/Bitmap.Config.html)

我将复制并粘贴相关部分：Bitmap.Config ARGB_4444 This field was deprecated in API level 。由于此配置质量较差，建议改用ARGB_8888。
Bitmap.Config ARGB_8888 每个像素存储在 4 个字节上。

将您的 4444 更改为 8888，它应该可以工作。

# angularjs - Angularjs切换图像onclick

> ID：14885794
> 
> 赞同：4
> 
> 时间：2013-02-14T23:13:18.790
> 
> 标签：angularjs

当用户单击它时，我正在尝试切换按钮图像。如果可能的话，我更喜欢使用 angularjs 而不是 jquery。现在我有一个工作版本，可以在单击时切换图像，唯一的问题是它会在单击时更改所有图像。如何缩小范围或传入 img 元素的 src 属性？

```
 <div ng-repeat="merchant in merchants">
      <div class="followrow">
        <a ng-click="toggleImage()"><img id="followbutton" ng-src="{{followBtnImgUrl}}"  /></a>
      </div>
    </div>

app.controller('FollowCtrl', function CouponCtrl($scope) {
    $scope.followBtnImgUrl = '/img1'

    $scope.toggleImage = function () {
        if ($scope.followBtnImgUrl === '/img1.jpg') {
            $scope.followBtnImgUrl = baseUrl + '/img2.jpg';
        } else {
            $scope.followBtnImgUrl = 'img1.jpg';
        }
    }
}); 
```

我可以将 img src 属性传递给 toggleImage(this.img.src) 或类似的函数吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T06:58:20.183

```
<div ng-repeat="merchant in merchants">
  <div class="followrow">
    <a ng-click="toggleImage(merchant)"><img id="followbutton" ng-src="{{merchant.imgUrl}}"  />
    </a>
  </div>
</div> 
```

.

```
app.controller('FollowCtrl', function CouponCtrl($scope) {
    $scope.followBtnImgUrl = '/sth.jpg'
    $scope.merchants = [{imgUrl: "img1.jpg", name:"sdf"}, 
                         {imgUrl: "img2.jpg", name: "dfsd"}];

     $scope.toggleImage = function(merchant) {
         if(merchant.imgUrl === $scope.followBtnImgUrl) {
             merchant.imgUrl = merchant.$backupUrl;
         } else {
             merchant.$backupUrl = merchant.imgUrl;
             merchant.imgUrl = $scope.followBtnImgUrl;
         }
    };
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T23:24:05.463

您想要的是每个`followrow`. 正如您的代码所代表的那样，所有`followrow`s 都只引用一个范围。

一个简单的答案是创建一个附加到每个控制器的新控制器`followrow`：

```
<div class="followrow" ng-controller="ImageToggleCtrl">...</div> 
```

然后将图像切换逻辑移动到该新控制器：

```
app.controller('ImageToggleCtrl', function($scope) {
  $scope.followBtnImgUrl = '/img1';
  $scope.toggleImage = function() { /* the toggling logic */ };
}); 
```

现在，将为每一行实例化一个新范围，并且图像将独立切换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-04T07:58:21.937

我刚刚添加了两个可点击的图像：

```
<div ng-app="FormApp" ng-controller="myController" max-width="1150px;" width="1150px;" >
    <input ng-show="ShowDown" type="image" style="width:250px; height:40px;" src="~/Content/Images/contactShow.png" ng-click="ShowHide()"/>
    <input ng-show="ShowUp" type="image" style="width:250px; height:40px;" src="~/Content/Images/contactHide.png" ng-click="ShowHide()" />
</div> 
```

他们切换彼此的可见性。在页面加载时，一个可见，一个不可见，两个可点击的图像都调用相同的函数：

```
<script type="text/javascript">
    var app = angular.module('FormApp', [])
    app.controller('myController', function ($scope) {
        $scope.ShowDown = true;
        $scope.ShowUp = false;

        $scope.ShowHide = function () {
            $scope.ShowDown = $scope.ShowDown ? false : true;
            $scope.ShowUp = $scope.ShowUp ? false : true;
        }
    });
</script> 
```

# django - Django 模型 - 将词组链接到词典/字典中的单个词

> ID：14885796
> 
> 赞同：1
> 
> 时间：2013-02-14T23:13:30.677
> 
> 标签：django, django-models

抱歉没有更好的标题。我不知道如何命名我正在尝试做的事情。无论如何，Django noob 尝试执行以下操作：

我正在建立一个词典/词典。您搜索一个词，并显示有关该词的信息。但该信息还包含相关词，分组为某种逻辑集群。

例如，您搜索“自行车”一词。在同一页上，像“unicycle”和“tricycle”这样的词（它们与主词来自同一个表）在集群名称“bicycle types”下分组在一起。单词的分组是通过创建一个组并添加单词来完成的。为此，我有以下模型（简化）：

**模型.py**

```
class Word(models.Model):
    word = models.Charfield()

class WordGroup(models.Model):
    name = models.CharField()
    words = models.ManyToManyField(Word) 
```

然后在管理员中，我可以从内联中选择组。

我不确定这在概念上是否是这样做的。它使python（本地）崩溃，所以我可以想象它不是:)

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T19:13:08.620

在同事的帮助下，我设法获得了我正在寻找的输出。解决方案是为关系定义一个 inlinemodeladmin 对象（[https://docs.djangoproject.com/en/dev/ref/contrib/admin/#working-with-many-to-many-models](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#working-with-many-to-many-models)）。

无法访问 wordgroupadmin 的问题似乎在于 MySQL。相同的设置在 sqlite3 中有效，但在 MySQL 中挂起。我将不得不进一步调查。

# sql-server - 计算日期之间的分钟数

> ID：14885797
> 
> 赞同：1
> 
> 时间：2013-02-14T23:13:30.630
> 
> 标签：sql-server

我需要帮助将下面的以下 excel 逻辑转换为 SQL 子查询。非常感激您的帮忙。

C栏

*   第 2 行) 2012 年 10 月 1 日下午 4:24
*   第 3 行) 2012 年 10 月 1 日下午 4:25
*   第 4 行) 2012 年 10 月 1 日下午 4:26
*   第 5 行) 2012 年 10 月 1 日晚上 7:27

累积分钟数

*   行 2) 2
*   第 3 行）1
*   第 4 行）1
*   第 5 行）45

Excel公式

*   第 2 行) =IF((C3-C2)>45,45,(C3-C2)*1440)
*   第 3 行) =IF((C4-C3)>45,45,(C4-C3)*1440)
*   第 4 行) =IF((C5-C4)>45,45,(C5-C4)*1440)
*   第 5 行) =IF((C6-C5)>45,45,(C6-C5)*1440)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T10:19:24.643

这个怎么样：

```
WITH CTE(RowNumber, Date) AS(
select 1, '2012-01-10 16:22' union
select 2, '2012-01-10 16:24' union
select 3, '2012-01-10 16:25' union
select 4, '2012-01-10 16:26' union
select 5, '2012-01-10 19:27'
)
select b.Date, IIF(DATEDIFF(minute, a.Date, b.Date) > 45, 45, DATEDIFF(minute, a.Date, b.Date)) as AccumulatedMinutes
from CTE b left outer join CTE a on a.RowNumber = b.RowNumber - 1 
```

它返回：

```
2012-01-10 16:22    NULL
2012-01-10 16:24    2
2012-01-10 16:25    1
2012-01-10 16:26    1
2012-01-10 19:27    45 
```

# haskell - 使用程序员 dvorak 键盘布局（移位数字）在 xmonad 中切换工作区

> ID：14885806
> 
> 赞同：8
> 
> 时间：2013-02-14T23:14:21.983
> 
> 标签：haskell, keyboard, xmonad, ergonomics

好吧，我实际上并没有使用 Dvorak 而是[Neo2](http://neo-layout.org)，但是当我使用矩阵型键盘（[真正符合人体工程学](http://www.trulyergonomic.com/)）时**，我也改变了数字。**

因此，我的这种结构`xmonad.hs`不符合人体工程学：

```
-- mod-[1..9], Switch to workspace N
-- mod-shift-[1..9], Move client to workspace N
--
[((m .|. modMask, k), windows $ f i)
    | (i, k) <- zip (XMonad.workspaces conf) [xK_1 .. xK_9]
    , (f, m) <- [(W.greedyView, 0), (W.shift, shiftMask)] 
```

我想改变它，以便能够**使用键 2 到 0 访问工作区 1 到 9。**

我怎么能做到这一点？我试图将第三行更改为

```
 | (i, k) <- zip (XMonad.workspaces conf) [xK_2 .. xK_0] 
```

但后来我无法访问第 9 个工作区。我该如何改变这个？一个简短的解释会很好，所以学习一些关于这个结构的东西（我很多年前学习了 Haskell，但大部分都忘记了）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T23:30:40.463

您的问题是`xK_2`大于`xK_0`，因此列表`[xK_2 .. xK_0]`为空：

```
Prelude XMonad> xK_2
50
Prelude XMonad> xK_0
48
Prelude XMonad> [xK_2 .. xK_0]
[] 
```

你会想要使用比这更长的列表。至少有两种合理的方法可以做到这一点；一种是自己手动指定所有键：

```
Prelude XMonad> [xK_2, xK_3, xK_4, xK_5, xK_6, xK_7, xK_8, xK_9, xK_0]
[50,51,52,53,54,55,56,57,48] 
```

我可能会使用更短一些：

```
Prelude XMonad> [xK_2 .. xK_9] ++ [xK_0]
[50,51,52,53,54,55,56,57,48] 
```

如果它是更大表达式的一部分，请记住添加一些括号。

# asp.net-mvc - 创建一个新的模型条目

> ID：14885807
> 
> 赞同：1
> 
> 时间：2013-02-14T23:14:51.800
> 
> 标签：asp.net-mvc, entity-framework

我这样做正确吗？

```
 using (UserContext context = new UserContext())
        {
            User user = context.Users.Create();

            user.Username = username;
            user.Email = email;
            user.IsDisabled = false;

            context.SaveChanges();
        } 
```

当我通过这段代码时，我的数据库永远不会用新条目更新。没有错误被抛出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:40:17.497

在 EF 中创建不会将实体添加到 DBSet。您可以附加它，但使用 Add() 方法更方便：

```
using (UserContext context = new UserContext())
        {
             context.Users.Add( new User {

          Username = username,
          Email = email,
          IsDisabled = false
                });

            context.SaveChanges();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:18:25.983

在`context.SaveChanges()`添加此之前

```
context.Entry(User ).State = EntityState.Modified; 
```

# java - 按降序对对象列表进行排序

> ID：14885809
> 
> 赞同：0
> 
> 时间：2013-02-14T23:15:01.753
> 
> 标签：java, collections, comparator

我想按降序对列表对象进行排序，并面对 classCastException。

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;

     class Student implements Comparator<Student>{
     private int id;
         private String name;

        public Student(int id, String name){
    this.id = id;
    this.name = name;
}

public int getId(){
    return id;
}
public String getName(){
    return name;
}

}

public class CollectionSearchDemo {

public static void main(String[] args) {

    List<Student> list = new ArrayList<Student>();
    list.add(new Student(3, "ouier"));
    list.add(new Student(2, "fdgds"));
    list.add(new Student(7, "kiluf"));
    list.add(new Student(1, "6trfd"));
    list.add(new Student(8, "hjgas"));
    list.add(new Student(5, "ewwew"));

    Collections.sort(list, new Comparator<Student>() {

        @Override
        public int compare(Student arg0, Student arg1) {

            return arg0.getId() - arg1.getId();
        }
    });

    Iterator iterator = list.iterator();
    while(iterator.hasNext()){
        Student student = (Student) iterator.next();
        System.out.print(student.getId()+":"+student.getName()+" ");
    }

    System.out.println("\nSorting in reverse order:");

//  Collections.reverse(list);
    Comparator<Student> collections = Collections.reverseOrder();
    Collections.sort(list, collections);     // here getting classCastException.

    Iterator iterator1 = list.iterator();
    while(iterator1.hasNext()){
        Student student = (Student) iterator1.next();
        System.out.print(student.getId()+":"+student.getName()+" ");
    }
}

} 
```

想知道几件事。1) bet'n Collection.reverse(list) 和 Comparator collections = Collections.reverseOrder() 有什么区别；Collections.sort（列表，集合）；2）为什么我面临classCastException。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:20:39.640

你需要使用`reverse()` 方法，

`reverseOrder()`

> 返回一个比较器，它对实现 Comparable 接口的对象集合施加自然顺序的逆向。

所以`ClassCastException`

# perl - 将 SVG 网格转换为坐标网格

> ID：14885814
> 
> 赞同：0
> 
> 时间：2013-02-14T23:15:26.900
> 
> 标签：perl, svg

```
#!/usr/bin/perl
use DBI;
use CGI::Carp qw(fatalsToBrowser);

#Set content type
print "Content-Type: image/svg-xml\n\n";

#Establish connection to database
$dbh = DBI->connect ('dbi:Oracle:geosgen','USER','PASS')
|| die "Man down! Man down!: $DBI::errstr";

#Send SQL query for mountains
$sth1 = $dbh->prepare("select table_alias.mot.sdo_point.X, table_alias.mot.sdo_point.Y, table_alias.name 
from X.mounts table_alias");

$sth1->execute;

#Send SQL query for tourist attraction 
$sth2 = $dbh->prepare("select table_alias.mot.sdo_point.X, table_alias.mot.sdo_point.Y 
from   s1227289.tours table_alias");

$sth2->execute;

#Set content type
print qq(<?xml version="1.0" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 20001102//EN" 
"http://www.w3.org/TR/2000/CR-SVG-20001102/DTD/svg-20001102.dtd">);

print qq(<svg width="20cm" height="20cm" viewBox="-5.8 56 0.8 2">);

#print mountains
while (@data = $sth1->fetchrow_array()) {
print qq(
  <circle cx="$data[1]" cy="$data[0]" r="0.002" fill="green">
  </circle> 
  <text x="$data[1]" 
    y="$data[0]" 
    fill="black" 
    style='font-size:0.01px;font-family:Arial'>$data[2]</text>  

       );   
  }

#print tourist attractions
while (@data = $sth2->fetchrow_array()) {
print qq(
  <circle cx="$data[1]" cy="$data[0]" r="0.002" fill="red">
  </circle>   
       );   
  }

print qq(</svg>); 
```

我一直在尝试解决这个问题，但无法解决这个问题！问题在于转型。绘制的点是颠倒的，需要翻转。我之前已经修复过与此类似的问题，但这次 y 值都是负数（即 -5.8）

我该如何解决这个问题？总而言之，我基本上想要执行转换，但是对于如何使用 -ve 数字执行此操作感到困惑。我搜索了类似的问题，但没有一个处理过 -ve 数字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T08:43:38.503

添加一个 transform="scale(1, -1)" 属性会翻转。或者可能更简单，在您的 php 输出中将 y 值作为 -1 * $data[0]

# osgi - 开始大规模 OSGi 迁移的初学者 - osgi.wiring.package=android.dalvik？

> ID：14885815
> 
> 赞同：0
> 
> 时间：2013-02-14T23:15:30.703
> 
> 标签：osgi, apache-felix

我有一个大型 Java 应用程序，它主要是网络和文件处理，具有大量数据库访问权限。没有用户界面。我们暴露了一些 Web 服务（嵌入式 Netty）并调用了一些外部的 REST Web 服务。该项目是用 Ant 构建的。它大约有 10 个不同的罐子加上 30-40 个库。

我当前的任务是将项目移至 OSGi 框架。我慢慢地吓了一跳。

按照“OSGi In Action”第 6 章中的示例，我使用 BND ant 任务将整个项目放入一个巨大的 jar 文件中。这行得通。我可以使用 java -jar 运行程序。这是我当前的 .bnd 文件：

```
-output: bundle/MerchantServicesBundle.jar
-include: manifest/merchantservices.manifest
Bundle-Name: MerchantServices
Bundle-SymbolicName: com.shopping.services.merchant
Bundle-Version: 4.1
Main-Class: com.shopping.merchant.services.netty.MerchantServices
Class-Path: /home/ppantera/repositories/MerchantJava/modules/MerchantServices/conf/

Private-Package: * 
```

我正在使用 Apache Felix 4.0.3。从 Gogo shell 我可以安装包，但是当我启动它时，我得到了这个：

org.osgi.framework.BundleException：捆绑com.shopping.services.merchant [8]中未解决的约束：无法解决8.0：缺少要求[8.0] osgi.wiring.package；(osgi.wiring.package=android.dalvik)

为什么 Felix 认为这是一个 Android 项目？

网上好像没有太多关于这个的。你会推荐使用旧版本的 Felix，这样我就不会受到可能导致我困惑的新 OSGi 功能的影响吗？

我尝试将其添加到我的 .bnd 文件中：

需求能力：osgi.ee；过滤器：=“（&（osgi.ee=JavaSE）（版本>=1.7））”

那没有帮助。我究竟做错了什么？还有其他指针吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:42:54.293

看起来 bnd 以某种方式检测到对 Android 包的要求，并将其添加到 MANIFEST.MF，它可能在您的代码中，但也可能在您的第 3 方库之一中。

检查你的清单以确保，我想你会发现类似的东西

```
Import-Package:android.dalvik. 
```

如果是这种情况，您可以通过手动删除该标头来测试捆绑包，看看是否有帮助。当你明白这一点后，你可以解决它，例如通过在 bnd 中将该导入设为可选。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T11:42:18.787

一种简单的解决方案是：

转到 FuseESB 控制台：

键入命令：

osgi:安装 mvn:commons-io/commons-io/2.1

将 'common's-io' 替换为您的依赖项的组 ID 和工件 ID（Maven），例如我的依赖项是：

```
<dependency>
    <groupId>commons-io</groupId>
    <artifactId>commons-io</artifactId>
    <version>2.1</version>
    <scope>provided</scope>
</dependency> 
```

干杯

# perl - 为什么“\n”没有在 Windows 中添加静默打印？

> ID：14885817
> 
> 赞同：1
> 
> 时间：2013-02-14T23:15:46.840
> 
> 标签：perl

根据 Simon Cozens 的Beginning Perl，\n 应该在 Windows 下的 Perl 中添加静默打印，这在我发现的大多数脚本中都是如此。但是，由于我不知道的原因，Perl 在以下示例中看不到 \n。它显然与括号的使用有关，但我找不到太多信息来理解这些差异。

脚本1

```
#!usr/bin/perl
#ranges.pl
use warnings;
use strict;

print reverse (1 .. 6), "\n"; 
```

输出是

```
654321
       <--
c:\Users\Brenden\desktop\begperl 
```

所以对我来说 \n 被 Perl 读取并导致了一个新的空间。现在

脚本2

```
#!usr/bin/perl
#ranges.pl
use warnings;
use strict;

print reverse (1 .. 6), "\n";
print reverse qw(1 2 3 4 5 6), "\n"; 
```

输出是

```
654321
      <--  
654321
C:Users\Brenden\Desktop\Begperl> 
```

对我来说，因为有两个“\n”参数，所以应该有两个空格。我只看到一个。

脚本3

```
#!usr/bin/perl
#ranges.pl
use warnings;
use strict;

print reverse (1 .. 6), "\n";
print "\n"; 
```

输出是

```
654321
      <--
      <--
C:\\Users\Brenden\Desktop\Begperl 
```

由于创建了两个空格，这意味着 Perl 不会将两个空格压缩为一个。因此，对我来说，很可能在 script2 中，2 个“654321”之间创建的空间是由于第一个“\n”而第二个“\n”被忽略了。如果脚本 2 中没有忽略第二个“\n”，则输出应该是

```
654321
      <-- 
654321
      <--
C:\\Users\Brenden\Desktop\Begperl 
```

或者

```
654321
      <--
      <--
654321
C:\\Users\Brenden\Desktop\Begperl 
```

现在，如果我在第二个打印中添加一个括号。

脚本4

```
#!usr/bin/perl
#ranges.pl
use warnings;
use strict;

print reverse (1 .. 6), "\n";
print reverse (qw(1 2 3 4 5 6)), "\n"; 
```

输出显示

```
654321
654321
      <--
C:Users\Brenden\Desktop\Begperl> 
```

此输出中的第一个“\n”会发生什么？对我的唯一解释是该空间被下一个打印输出占用，其中包括“654321”和一个空格（无论顺序如何）。但这个解释听起来不太对。对我来说，无论是 qw( 1 2 3 4 5 6 ) 还是 (qw(1 2 3 4 5 6),"\n") 传递给反向，在脚本 2,3,4 中我不应该仍然看到 2空格，不管“\n”是否反转？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:20:31.077

所以你知道这些是一样的

```
print reverse (1 .. 6), "\n";
print reverse (qw(1 2 3 4 5 6)), "\n"; 
```

然后你改变了其中一个。

```
print reverse (1 .. 6), "\n";
print reverse qw(1 2 3 4 5 6), "\n";  <-- 
```

那么为什么你会惊讶他们不再提供相同的输出呢？

* * *

删除标识`reverse`参数的括号后，`"\n"`开始传递给`reverse`.

以下两行将结果传递`qw( 1 2 3 4 5 6 )`给反转：

```
print reverse (qw(1 2 3 4 5 6)), "\n";
print(reverse(qw(1 2 3 4 5 6), "\n")); 
```

以下两行将结果传递`qw( 1 2 3 4 5 6 ), "\n"`给反转：

```
print reverse qw(1 2 3 4 5 6), "\n";
print(reverse(qw(1 2 3 4 5 6), "\n")); 
```

* * *

OP 用错误注释的片段重写了他的问题。这是正确的注释输出。

script1 输出`"654321\n"`：

```
654321           <== "654321\n" newline one
                 <== prompt
C:\>             <== prompt 
```

script2 输出`"654321\n\n654321"`：

```
654321           <== "654321\n" newline one
                 <== "\n"       newline two
654321           <== "654321" + prompt
C:\>             <== prompt 
```

script3 输出`"654321\n\n"`：

```
654321           <== "654321\n" newline one
                 <== "\n"       newline two
                 <== prompt
C:\>             <== prompt 
```

script4的第一个可能的预期输出，`"654321\n\n654321\n"`：

```
654321           <== "654321\n" newline one
                 <== "\n"       newline two
654321           <== "654321\n" newline three
                 <== prompt
C:\>             <== prompt 
```

script4 的第二个可能的预期输出，`"654321\n\n\n654321"`：

```
654321           <== "654321\n" newline one
                 <== "\n"       newline two
                 <== "\n"       newline three
654321           <== "654321" + prompt
C:\>             <== prompt 
```

script4 输出`"654321\n654321\n"`：

```
654321           <== "654321\n" newline one
654321           <== "654321\n" newline two
                 <== prompt
C:\>             <== prompt 
```

# c++ - C++ 编译器错误：“构造函数的返回类型规范无效”

> ID：14885819
> 
> 赞同：22
> 
> 时间：2013-02-14T23:16:02.247
> 
> 标签：c++

这是我的代码。编译所有文件时出现此错误，我不确定自己做错了什么。请指教。

> Molecule.cpp:7:34：错误：构造函数的返回类型规范无效

```
//Sunny Pathak
//Molecule.cpp    
#include <iostream>
#include "Molecule.h"    
using namespace std;

inline void Molecule::Molecule(){
       int count;
       count = 0;
}//end function

bool Molecule::read(){
    cout << "Enter structure: %c\n" << structure << endl;
    cout << "Enter full name: %c\n" << name << endl;
    cout << "Enter weight   : %f\n" << weight << endl;
}//end function

void Molecule::display() const{
    cout << structure << ' ' << name << ' ' << weight << ' ' << endl;
}//end function 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-14T23:16:56.147

构造函数没有返回类型：

```
class Molecule
{
 public:
  Molecule();  // constructor. No return type.
  bool read();
  void display() const;
};

Molecule::Molecule(){
       int count;
       count = 0;
}//end constructor 
```

另请注意，它`count`是构造函数主体的局部变量，并且您没有将它用于任何事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T23:17:12.207

您正在编写具有返回类型的构造函数。**构造函数没有返回类型**。只需将构造函数定义更改为：

```
/* void */ Molecule::Molecule()
// ^^^^ Remove this
{
    int count;
    count = 0;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T23:17:16.850

**构造函数不能有返回类型**。

更新：

```
inline void Molecule::Molecule(){
       ^^^
       int count;
       count = 0;
}//end function 
```

至：

```
Molecule::Molecule(){
       int count;
       count = 0;
}//end function 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-10-11T07:42:07.307

在以下情况下可能会出现同样的错误消息：

*   类在 H 文件中定义但缺少分号
*   您的 CPP 文件包括 H 文件，并且还以类构造函数的定义开始。

然后编译器会将您的类定义视为构造函数方法的返回类型，并抛出此错误。如果是这种情况，那么解决方法是添加分号。

注意：在 OP 的示例中情况并非如此，但报告的错误（以及因此该问题帖子的标题）将是相同的。

# c++ - c ++中的short和SHORT有什么区别？

> ID：14885823
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:16:10.020
> 
> 标签：c++, types

c ++中的short和SHORT有什么区别？一种数据类型全小写，一种全大写。有区别吗？

我想我明白了。那么 SHORT 有点像 Java 中的类吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:16:59.880

C++ 没有`SHORT`数据类型。Win32 的头文件定义了一个，但这是一个特定于平台的定义，而不是 C++ 的一部分。

至于区别，Win32 保证`SHORT`大小为 16 位。C++ 对`short`.

`SHORT`在 Windows 生命周期的早期，它得到了最大的利用。它现在没有太多用处，因为`short`对于大多数平台，编译器通常已标准化为 16 位。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:18:00.793

最明显的区别是它`short`实际上是 C++ 的一部分，而`SHORT`不是。全大写版本无疑来自某个库或该顺序的某些东西。

# php - 如何在我的 preUpdate 方法中重置学说实体？

> ID：14885826
> 
> 赞同：1
> 
> 时间：2013-02-14T23:16:45.850
> 
> 标签：php, doctrine-orm

我试图弄清楚如何在`preUpdate`方法中回滚已更改实体的状态（如果有区别，我将使用注释方法）。

我尝试使用`EntityManager::refresh($entity)`and 虽然它似乎确实恢复了实体，但它仍然继续并将更改保存到数据库中。

我读过我需要通过调用重新计算更改集，`$em->getUnitOfWork()->computeChangeSet($em->getClassMetaData(get_class($this)), $this);`但这并不能解决问题。

反正有没有让`UnitOfWork`忽略更改/重新计算正确？

```
<?php 
class Status extends Entity {

    /**
     * @PreUpdate
     */
    public function preUpdate() {
        if (!$this->canSave()) {
            $this->reset();
        }
    }

    public function reset() {
        $em = self::getEntityManager();
        $em->refresh($this);
        $em->getUnitOfWork()
           ->computeChangeSet($em->getClassMetaData(get_class($this)), $this);
    }

    public function canSave() { return false; }
?>

<?php
// Bootstrap for testing/debugging
include 'common.php';

$log = \Zend_Registry::get('log');

$x = Status::find(31); // Retrieve entity from DB
$log->debug("Original: " . $x->getDateLastSeen() . "\n");

$x->setDateLastSeen(new \DateTime());
$log->debug("Set to: " . $x->getDateLastSeen() . "\n");

$x->save();
$log->debug("Saved to: " . $x->getDateLastSeen() . "\n"); 
```

输出：

```
2013-02-14T23:13:22+00:00 DEBUG (7): Original: 2013-02-14 23:08:22
2013-02-14T23:13:22+00:00 DEBUG (7): Set to: 2013-02-14 23:13:22
2013-02-14T23:13:22+00:00 DEBUG (7): Saved to: 2013-02-14 23:08:22 
```

一切*看起来都很好*，但是当我查看我的数据库日志时，我看到：

```
409705 Query    UPDATE devices_statuses SET date_last_seen = '2013-02-14 23:13:22' WHERE id = 31
409705 Query    commit 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T08:56:51.447

这已经由 ORM 本身处理（参见[https://github.com/doctrine/doctrine2/blob/2.3.2/lib/Doctrine/ORM/UnitOfWork.php#L970-L974](https://github.com/doctrine/doctrine2/blob/2.3.2/lib/Doctrine/ORM/UnitOfWork.php#L970-L974)）

这里的问题是`DateTime`分配给的实例`date_last_seen`（或更好的映射到它的字段）具有不同的对象哈希（用 进行检查[`spl_object_hash()`](http://php.net/manual/en/function.spl-object-hash.php)）。

对于 ORM，这是一个变更集。要有效地重置您的实例，您需要手动调用[`Doctrine\ORM\UnitOfWork#clearEntityChangeSet(spl_object_hash($this))`](https://github.com/doctrine/doctrine2/blob/2.3.2/lib/Doctrine/ORM/UnitOfWork.php#L2889-L2898).

此外，考虑将此代码从实体移出到专用的事件侦听器中：您的实体不应该`EntityManager`以任何方式了解持久层或关于持久层。

# php - 使用ajax不断收到未定义的请求

> ID：14885827
> 
> 赞同：0
> 
> 时间：2013-02-14T23:16:48.370
> 
> 标签：php, javascript, ajax

使用 ajax 代码：

```
$.ajaxSetup({
    url: "last-id-test.php",
    type: "POST",
});

$.ajax({
    data: {theinfo: 'forminfo'},      
    success: function(data) {alert(data)},
    error: function (XMLHttpRequest, textStatus, errorThrown){alert('Error submitting request.')}   
}); 
```

然后是last-id-test.php的简单php：

```
$showme = $_GET['theinfo']; 
```

我总是收到错误“未定义的索引 - theinfo”...

我看不到我的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:20:58.943

尝试以下操作：

```
$.ajaxSetup({
    url: "last-id-test.php",
    type: "POST",
});

$.ajax({
    data: {'theinfo': 'forminfo'},      
    success: function(data) {alert(data)},
    error: function (XMLHttpRequest, textStatus, errorThrown){alert('Error submitting request.')}   
}); 
```

**请注意，单引号用于变量名周围。**

现在您需要使用 POST 数组访问传递变量，因为您的类型设置为`POST`

```
$showme = $_POST['theinfo']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:26:50.623

正如评论中提到的 GET 和 POST 方法导致数据被传递到 PHP 中的不同全局变量 - GET == $_GET POST == $_POST

所以在这种情况下，试试你的 php：

`$showme = $_POST['theinfo'];`

对调试有用的是

`print_r($_GET); // or $_POST or $_COOKIE`

有关这些全局变量的更多信息：[http ://www.php.net/manual/en/reserved.variables.php](http://www.php.net/manual/en/reserved.variables.php)

# perl - Perl pod2html 无法解析电子邮件链接

> ID：14885828
> 
> 赞同：0
> 
> 时间：2013-02-14T23:16:51.487
> 
> 标签：perl, perldoc

也许我做的不对，但是对于很多[POD](http://perldoc.perl.org/perlpod.html) [链接示例](http://perldoc.perl.org/perlpod.html#Formatting-Codes)，代码在[pod2html](http://perldoc.perl.org/pod2html.html)中不起作用。

例如：

```
Owner: L<Eric Fossum|mailto:myemail@gmail.com> 
```

似乎与`C:\perldoc filename`and一起使用`C:\pod2text filename`，但`C:\pod2html --title=SomeText --outfile=filename.html filename`输出：

```
pod2html.bat: filename: cannot resolve L<Eric Fossum|mailto:myemail@gmail.com> in paragraph 6. 
```

你们认为这是我的安装或代码的问题吗？我如何解决它？

**更新：**

这是我的模块版本：

```
Can't locate Pod.pm in @INC (@INC contains: ...) at (eval 1) line 2.
Pod::Html           : 1.09
Pod::Simple         : 3.14
Pod::Simple::XHTML  : 3.14 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:29:00.493

使用 Perl v5.16.2 对我来说效果很好。我正在使用以下 Pod：

```
=pod

Owner: L<Eric Fossum|mailto:myemail@gmail.com>

=cut 
```

在 HTML 正文中，它返回：

```
<p>Owner: <a href="mailto:myemail@gmail.com">Eric Fossum</a></p> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T23:53:00.993

我对 perl 5.14.2 中的 Lhttp://svitsrv25.epfl.ch/R-doc/library/RColorBrewer/html/ColorBrewer.html> 等链接也有同样的问题。正如 oalders 评论的那样，pod2html 使用 Pod::Html，它自 perl 5.4 以来一直是核心模块。因此，我测试了不同版本的 perl，发现问题在 perl 5.14.2 和 perl 5.16.2 之间得到了解决。

因此，解决方案是简单地升级 perl。

# mysql - MYSQL 多查询还是单查询——哪个更高效

> ID：14885836
> 
> 赞同：0
> 
> 时间：2013-02-14T23:17:29.770
> 
> 标签：mysql

我有一个有 3 列的表：`Animal`, `key`, `owner`. 例子

```
Cat     1     Bob
Bird    2     Bob
dog     3     Bob
dog     4     Andy
Lizard  5     Andy
Bird    6     Andy
Cat     7     Andy 
```

以及每只动物一张相关的表格（列键、重量）。例如，表 CAT_WEIGHT：

```
1   12
7   17 
```

我想为每种动物类型找到`Min`、`Max`、`Average`、`Total`和`Count`，但仅针对特定所有者。

这是否可以使用单个 MYSQL 查询来计算这些？我知道我可以在多个查询中做到这一点，但我正在寻找最好的方法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:21:14.997

是的，只使用一个查询就可以做到这一点。

在所有其他条件相同的情况下，您希望使用尽可能少的查询。到数据库的往返通常是您在程序中会遇到的一些更昂贵的事情。

```
select 
  animal, 
  min(weight)   min_weight, 
  max(weight)   max_weight, 
  avg(weight)   avg_weight, 
  sum(weight)   tot_weight, 
  count(weight) cnt_weight
from 
  your_table
group by 
  animal 
order by animal; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:21:56.190

怎么样：

> 选择 min(Weight), max(Weight), sum(Weight), count(*) from animals_table group by animal

# android - Android 创建布局，如默认操作系统菜单

> ID：14885842
> 
> 赞同：0
> 
> 时间：2013-02-14T23:17:54.057
> 
> 标签：android, menu

我想在我的应用程序中创建一个菜单布局，它需要与默认的操作系统菜单相同。我想从查看 Android 操作系统代码开始，但我不知道在哪里可以找到与菜单相关的任何帮助，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:14:04.653

[如何在 Android 中更改菜单主题](https://stackoverflow.com/questions/12076863/how-to-change-menu-theme-in-android)

在您的清单中：

您也可以尝试阅读以下内容： [http ://staticallytyped.wordpress.com/2011/05/05/android-how-can-you-implement-a-custom-menu-class/](http://staticallytyped.wordpress.com/2011/05/05/android-how-can-you-implement-a-custom-menu-class/)

我希望它会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T05:06:33.087

您可以使用自定义的网格视图！

# meteor - 将 Google Adsense 添加到 Meteor 应用程序

> ID：14885846
> 
> 赞同：3
> 
> 时间：2013-02-14T23:18:03.400
> 
> 标签：meteor

尝试了几种方法，但仍然无法让 Google Ad 呈现。目的是根据窗口宽度响应式放置广告。但我什至无法放置一个广告。

这是我能想到的最可靠的方法：

```
/* templates.html */
<head>
    <script type="text/javascript">
        var googletag = googletag || {};
        googletag.cmd = googletag.cmd || [];
    </script>
    <script type="text/javascript" src="http://www.googletagservices.com/tag/js/gpt.js">       </script>
</head>

<body>
    <div class="container">
        {{> page}}
    </div>
</body>

<template name="page">
    <div class="page_ad"></div>
</template>

/* client.js */
Template.page.rendered = function(){
    googletag.cmd.push(function() {
        googletag.defineSlot('LEADERBOARD', [728, 90], 'AD-CODE-ID').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
    });

    $('.page_ad').html("<div id='AD-CODE-ID' style='width:728px; height:90px;'>");

    googletag.cmd.push(function() { googletag.display('AD-CODE-ID')});
}; 
```

感谢您的考虑。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-08-16T21:52:52.383

这是我的做法。**[您可以在此博客文章中了解更多信息](http://journal.gentlenode.com/meteor-18-how-to-add-google-adsense-to-your-application/)。**

```
Template.MyAds.rendered = function() {  
  $.getScript("//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js", function() {
    var ads, adsbygoogle;
    ads = '<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-72414***074839" data-ad-slot="4009***57" data-ad-format="auto"></ins>';
    $('.leaderboard').html(ads);
    return (adsbygoogle = window.adsbygoogle || []).push({});
  });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-01T02:50:14.853

Check out the iframe solution here; [Meteor JS: use external script](https://stackoverflow.com/questions/14389766/meteor-js-use-external-script)

Check out the information about that method being against TOS; [http://productforums.google.com/forum/#!category-topic/adsense/adsense-basics-and-policies/JP6vrWxFMVg](http://productforums.google.com/forum/#!category-topic/adsense/adsense-basics-and-policies/JP6vrWxFMVg)

# objective-c - 异或反转objective-c中的字符串得到错误

> ID：14885849
> 
> 赞同：0
> 
> 时间：2013-02-14T23:18:29.787
> 
> 标签：objective-c, exc-bad-access, xor

我想使用以下代码来反转objective-c中的char *类型字符串：

```
- (char *)reverseString:(char *)aString
{

    unsigned long length = strlen(aString);
    int end = length - 1;
    int start = 0;
    while (start < end) {
        aString[start] ^= aString[end];
        aString[end] ^= aString[start];
        aString[start] ^= aString[end];

        ++start;
        --end;
    }

    return aString;
} 
```

但我在这一行收到错误 EXC_BAD_ACCESS

```
aString[start] ^= aString[end] 
```

我用谷歌搜索，发现人们说我不能修改文字字符串，因为它是只读的。我是 C 新手，所以我想知道在这个例子中我可以使用什么简单的数据类型（无对象）？当我使用 (char []) aString 替换 (char *) aString 时，我得到了同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:22:40.210

我假设你这样称呼

```
[myObj reverseString:"foobar"]; 
```

这里的字符串`"foobar"`是一个常量文字字符串。它的类型*应该*是`const char *`，但是因为 C 是无脑死的，所以它是`char *`. 但它仍然是不变的，所以任何修改它的尝试都会失败。

将方法声明为采取`char[]`实际上没有任何区别。当用作参数类型时，`char[]`与`char*`.

你在这里有两个选择。第一种是在将字符串传递给方法之前复制字符串。第二个是更改方法，根本不修改其输入字符串，而是返回一个新字符串作为输出。两者都可以使用`strdup()`. 请记住，从后面返回的字符串`strdup()`需要'd 。`free()`

# ruby-on-rails - 自定义 rails 路由辅助方法

> ID：14885856
> 
> 赞同：1
> 
> 时间：2013-02-14T23:19:01.843
> 
> 标签：ruby-on-rails, routes

我在让我的辅助方法名称正常工作时遇到问题，任何建议都会很棒：

```
#config/routes.rb
resources :junkie, only: [:show, :index, :destroy], as: :junkie do
  get :merge, on: :collection
end 
```

所以我遇到了问题，因为我的单数形式是`junkies`is `junky`，但是当我进行此更改并查看路线时，它会将`#merge`助手更改为：

```
merge_junkie_index GET    /junkies/merge(.:format)              junkies#merge 
```

有什么办法可以将其更改为 just`merge_junkie`吗？我尝试从资源黑色中删除它并使用匹配语法：但出于某种奇怪的原因，即使路线是正确的，这也会`get "junkies/merge" => "junkies#merge", as: :junkie`将我引向该方法。`show`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:49:48.100

该解决方案是一个丑陋的解决方案，但它有效，因为显示路线是唯一受此影响的路线，`as: :junkie`您可以将其拆分出来，将`merge`路线放在单独的块中。出于某种原因，资源的顺序也很重要，如果您不将合并放在首位，它会将 url 解释`/junkie/merge/`为 id 并执行`show`操作。所以它在你的路由文件中应该是这样的：

```
resources :junkies, only: [:index] do
  get :merge, on: :collection
end
resources :junkies, only: [:show, :destroy], as: :junkie 
```

# html - 用于打印和“报告”样式格式的优秀 CSS 库

> ID：14885862
> 
> 赞同：6
> 
> 时间：2013-02-14T23:20:07.283
> 
> 标签：html, css, django, printing, web-publishing

什么是一个好的 CSS 库，可以用来生成报告，预览和打印形式？

“报告”的关键在于它们看起来更像是一份正式的（和可打印的）文档，而不是一个实际的网页。

好的功能：

1.  支持分页，适用于网页和打印
2.  打印支持
3.  任何可以节省页面格式时间的东西（例如，横向与纵向、A4 与字母等）
4.  PDF 支持

# amazon-web-services - 是否有 ASIN 到 UPC 的 API？

> ID：14885864
> 
> 赞同：4
> 
> 时间：2013-02-14T23:20:24.740
> 
> 标签：amazon-web-services, amazon

像[http://asintoupc.com/](http://asintoupc.com/)这样的网站如何能够如此轻松地抓取 UPC？

在我缺少的任何地方都有可用的开放 API 吗？我是一名 php 开发人员，我从亚马逊 API 中获得的运气并不好。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-16T15:21:31.193

不知道为什么这个问题已经过去了六个月并获得了 120 多个视图而没有人回答，但希望这会有所帮助：

根据：[http ://docs.aws.amazon.com/AWSECommerceService/2011-08-01/DG/RG_ItemAttributes.html](http://docs.aws.amazon.com/AWSECommerceService/2011-08-01/DG/RG_ItemAttributes.html)

UPC 被列为可能从查询返回的潜在项目属性之一。对于具有多个相关 UPC 的项目，UPCList（将包含多个 UPCListElement 对象）也是如此。

它说：

> ItemAttributes 响应组可能返回大量描述项目的属性。例如，相机和照片搜索索引中的项目可能会返回属性、高度、宽度、重量、标题、UPC、价格、制造、缩放比例、百万像素数和手提箱。
> 
> 所有搜索索引都可以返回所有项目属性。但是，返回的商品属性数量因 ASIN 而异。通常，同一搜索索引中的 ASIN 返回相同的商品属性。例如，您会期望为“书籍”搜索索引中的项目返回的项目属性与为“相机和照片”搜索索引中的项目返回的项目属性不同。但单个搜索索引中的所有项目不一定返回相同的属性。因此，无法准确预测响应中将返回哪些项目属性。

对于您的问题，这意味着他们的数据库中的每个项目都没有 UPC，因此它不会为所有项目返回它 - 仅适用于具有适用 UPC 的项目。并且您需要确保您使用的是适用的响应组 - 您可以检查他们文档中的响应组，以确保您使用的组包括 UPC。

我刚刚开始一个项目，该项目将涉及获取 UPC 的过程，但还没有实现，所以我现在唯一能提供的帮助来自我在文档中看到的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-12-19T09:55:06.760

在我自己对此进行了研究之后，我发现亚马逊很可能已经禁用了一些可能声称已将 ASIN 转换为 UPC 的服务。

从 ASIN 编号获取 UPC 的最简单、最便宜的方法是注册一个免费的亚马逊卖家账户。这将允许您按 ASIN 搜索产品，亚马逊将详细说明适用的 UPC 和 EAN 编号。例如在英国：[https ://sellercentral.amazon.co.uk/productsearch?q=B004EAIWMA](https://sellercentral.amazon.co.uk/productsearch?q=B004EAIWMA)

请注意，您必须注册卖家账户才能访问上面的链接

# c++ - 通过将最小的数字放在第一位将两个数组组合成一个

> ID：14885867
> 
> 赞同：0
> 
> 时间：2013-02-14T23:20:31.943
> 
> 标签：c++, function, sorting

我需要遍历 a 和 b 数组，将 a 和 b 中的元素复制到组合中，以使组合最终被排序。

例如，如果 a 是 {3, 5, 7, 7, 9}，b 是 {2, 5, 8, 1234}（所以 combo 必须有 9 个元素），那么这个函数会将 combo 设置为 {2, 3, 5、5、7、7、8、9、1234}。我需要有效地做到这一点：当我将值放入组合中时，我需要将它们放在正确的位置；不要随意，稍后重新排列它们。

我在 while 循环中尝试了一个嵌套的 for 循环，但我得到了一些奇怪的结果。我似乎无法找到超越最低数字的方法。例如，一旦我将最小的数字添加到组合数组中，我就无法弄清楚如何丢弃它本身。谢谢您的帮助。

```
void merge( 
    unsigned combo[], 
    const unsigned a[],
    unsigned aElements,
    const unsigned b[],
    unsigned bElements 
){

    if (mySort(a, aElements) == 0) {
        cout << "The first array is not sorted";
        exit(1);
    }

    if (mySort(b, bElements) == 0) {
        cout << "The second array is not sorted";
        exit(1);
    }

    unsigned combinedElements;
    unsigned lowest = 0;
    unsigned i = 0;

    combinedElements = aElements + bElements;

    while (i < combinedElements) {
        for (int n = 0; n < combinedElements; n++) {
            if (a[i] < b[n]) {
                lowest = a[i];
            }

            else {
                lowest = b[n];
            }
        }

        combo[i] = lowest;
        i++;
        cout << combo[i] << endl;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:24:22.533

除非这是家庭作业，否则请使用[`std::merge`](http://en.cppreference.com/w/cpp/algorithm/merge)

```
void merge( 
    unsigned combo[], 
    const unsigned a[],
    unsigned aElements,
    const unsigned b[],
    unsigned bElements 
){
    std::merge(a, a+aElements, b, b+bElemnts, combo);
} 
```

如果这*是*家庭作业，试试这个算法：

```
index_result = 0; index_a = 0; index_b = 0;
while(index_a < size_a && index_b < size_b)
  if(a[index_a] < b[index_b])
    result[index_result++] = a[index_a++]
  else
    result[index_result++] = b[index_b++]
while(index_a < size_a)
  result[index_result++] = a[index_a++]
whle(index_b < size_b)
  result[index_result++] = b[index_b++] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:27:53.410

我假设这是某种类型的作业，如果不是，请使用`std::merge`.

如果要手动推出此功能，则需要考虑使用三个游标：两个是两个不同数组的输入游标，另一个是输出（写入）游标。

在决定要从哪个数组中移动下一个元素后，您需要复制和更新两个游标，即该数组中的读取游标（因为该元素已被消耗）和最终数组中的写入游标（因为位置已被写入）。

我希望这足以引导您找到解决方案:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:26:04.163

这是您可以尝试的标准内容列表：[http ://www.cplusplus.com/faq/sequences/sequencing/sort-algorithms/](http://www.cplusplus.com/faq/sequences/sequencing/sort-algorithms/)

另外，您是否考虑过类似的伪代码：

创建一个新数组[旧数组的大小减一] mempcy(新数组，开始到删除点-1) mempcy(新数组，删除点+1到结束)

从新数组排序

再次罚款最低的数字...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T23:29:36.180

这是一个非常紧凑的解决方案，应该易于阅读和理解。

我假设`combo`有足够的空间来容纳结果并且`a`已经`b`订购（如您的示例所示）：

```
void merge(unsigned combo[], 
           const unsigned a[],
           unsigned aElements,
           const unsigned b[],
           unsigned bElements)
{
    while(aElements + bElements > 0)
    {
      if(bElements == 0 || (aElements > 0  && *a < *b))
      {
          aElements--;
          *combo++ = *a++;
      }
      else
      {
          bElements--;
          *combo++ = *b++;
      }
   }
} 
```

它可以稍微调整以获得更好的性能，但它非常优雅和可读。另外，此代码同时兼容 C 和 C++。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T23:35:33.357

假设这是用于家庭作业或类似的事情，并且您不允许使用标准的东西`std::merge`，例如 2 个排序列表的合并算法可以以线性复杂度完成，如下所示：

```
void merge( unsigned combo[], const unsigned a[], unsigned aElements, const unsigned 
b[],    unsigned bElements ){

    if (mySort(a, aElements) == 0) {
        cout << "The first array is not sorted";
        exit(1);
    }

    if (mySort(b, bElements) == 0) {
        cout << "The second array is not sorted";
        exit(1);
    }

    int i,j,k =0;
    while (i<aElements && j<bElements)
    {
        if (a[i]<=b[j])
        {
            combo[j++]=a[i++];
        } else
        {
            combo[j++]=b[j++];
        }
    }

    //add remaining elements. at least one of these loops will not happen
    while (i < aElements) combo[j++]=a[i++];
    while (j < bElements) combo[j++]=b[j++];
} 
```

# php - PHP在一个字符串中查找多个大括号并替换里面的文本

> ID：14885871
> 
> 赞同：0
> 
> 时间：2013-02-14T23:20:50.480
> 
> 标签：php, string

我的数据库中有字符串，例如

```
Label is {input:inputvalue} and date is {date:2013-2-2} 
```

如何从第一个大括号中提取 input 和 inputvalue，从第二个大括号中提取 date 和 2013-2-3 等等？所以显示像

```
Label is <input name="input" value="input_value"> and date is <input name="date" value="2013-2-2"> 
```

以下函数仅在字符串具有 {input} 或 {date} 时才有效

```
function Replace_brackets($rec){
    $arr = array(" <input name="input" value='input'> ",
                 " <input name="date" value='date'> ");
    $arr1 = array('{input}','{date}');
    $itemvalue=str_replace($arr1,$arr,$rec);
    return $itemvalue;
} 
```

文本上可能有或多或少的大括号，例如 2 个输入大括号和 4 个日期大括号。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T23:31:17.570

在这种情况下，带有反向引用的 preg_replace() 将起作用[http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)：

```
<?php
$s = "Label is {input:inputvalue} and date is {date:2013-2-2}";
print preg_replace( "/{([^:}]*):?([^}]*)}/", "<input name='\\1' value='\\2'>", $s );
?> 
```

或者，如果您需要解析名称和值对，正如@Jack 指出的那样，您可以使用 preg_replace_callback() 版本（尽管您实际上不需要在属性值上使用 htmlspecialchars() 。用任何东西替换 htmlspecialchars()解析功能适用）：

```
print preg_replace_callback( "/{([^:}]*):?([^}]*)}/", "generate_html", $s );

function generate_html( Array $match )
{
return "<input name='".htmlspecialchars($match[1])."'    value='".htmlspecialchars($match[2])."'>";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:29:17.870

您可以使用正则表达式和 preg_replace_callback 函数

```
preg_replace_callback('~(\\{[^}]+\\})~', $callback, $subject); 
```

其中主题是您的文本并回调一个处理给定输入字符串并返回您的替换的函数

对于简单的表达式，您可以使用下一个示例，但这可以转换为单个 preg_replace（没有回调）

```
$callback = function($string) {
    preg_match('~\\{([^:]):(.*)\\}~', $string, $m);
    return "<input name=\"{$m[1]}\" value=\"{$m[2]}\">";
}; 
```

# c++ - OpenCV 问题。

> ID：14885874
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:21:09.023
> 
> 标签：c++, opencv, codeblocks, windows-7-x64

我是新来的，我一直在尝试在我的代码块 IDE 上设置 OpenCV。我不确定有什么问题。我使用的是 Windows 7、64 位系统和代码块，我还下载了 2-4.3 版本的 OpenCV。

我尝试按照[此处](http://opencv.willowgarage.com/wiki/CodeBlocks)的手册说明进行操作，但这没有帮助：[http ://opencv.willowgarage.com/wiki/CodeBlocks](http://opencv.willowgarage.com/wiki/CodeBlocks)

即使我尝试使用代码块，我也尝试过： [Installing OpenCV 2.4.3 in Visual C++ 2010 Express](https://stackoverflow.com/questions/10901905/installing-opencv-2-4-3-in-visual-c-2010-express)

我的路径设置为：C:\OpenCV\build\x64\vc10\bin

对于“搜索目录”选项卡下的编译器设置：“编译器”：C:\OpenCV\build\include “链接器”：C:\OpenCV\build\x64\vc10\lib

然后在“链接器设置”选项卡下，我拥有来自 C:\OpenCV\build\x64\vc10\lib 的所有 .lib 文件

我尝试将它作为我的测试程序运行，它给了我一个连接到 operations.hpp 头文件的错误读数：

```
#include "opencv2/highgui/highgui.hpp"
#include "iostream" 

using namespace cv;
using namespace std;

int main()
{
   Mat im = imread("c:/full/path/to/lena.jpg");
   if (im.empty())
   {
       cout << "Cannot load image!" << endl;
       return -1;
   }
   imshow("Image", im);
   waitKey(0);
} 
```

错误说：

```
C:\OpenCV\build\include\opencv2\core\operations.hpp|3915|error: expected primary-expression before '>' token|
C:\OpenCV\build\include\opencv2\core\operations.hpp|3915|error: expected primary-expression before ')' token| 
```

....还有很多其他的东西，但这些是前两个错误。

所以我的两个问题是：
1）我是否正确设置了我的 IDE？
2) OpenCV 代码有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:34:42.690

这个问题的解决方法是编辑 operations.cpp 文件的第 3915 行。正确的返回参数是

返回 _create(name).Ptr<_Tp>();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-19T14:37:00.263

你试过包含opencv核心吗？

```
#include "opencv2/core/core.hpp" 
```

我的假设是您不使用核心功能，因此您的代码无法识别某些功能。

# c# - 如何判断 LINQ 扩展方法是否遭受双重枚举？

> ID：14885875
> 
> 赞同：6
> 
> 时间：2013-02-14T23:21:14.287
> 
> 标签：c#, .net, linq

我想知道有什么规则可以判断一部分 LINQ 代码是否遭受双重枚举？

例如，以下代码可能重复枚举的迹象是什么？还有哪些需要注意的其他迹象？

```
public static bool MyIsIncreasingMonotonicallyBy<T, TResult>(this IEnumerable<T> list, Func<T, TResult> selector)
    where TResult : IComparable<TResult>
{
    return list.Zip(list.Skip(1), (a, b) => selector(a).CompareTo(selector(b)) <= 0).All(b     => b);
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-15T00:06:24.687

传入其中之一：

```
public class OneTimeEnumerable<T> : IEnumerable<T>
{
  public OneTimeEnumerable(IEnumerable<T> source)
  {
    _source = source; 
  }

  private IEnumerable<T> _source;
  private bool _wasEnumerated = false;

  public IEnumerator<T> GetEnumerator()
  {
    if (_wasEnumerated)
    {
      throw new Exception("double enumeration occurred");
    }
    _wasEnumerated = true;
    return _source.GetEnumerator();
  }

} 
```

# javascript - 使用 jquery 在后台添加事件

> ID：14885878
> 
> 赞同：1
> 
> 时间：2013-02-14T23:21:24.080
> 
> 标签：javascript, jquery

我有一个包含 10,000 多个元素的 html ul 列表，并且想要添加自定义悬停工具提示事件并对每个元素进行一些其他处理。在 document.ready 上执行此操作需要 2-3 秒并冻结浏览器。如何异步执行此操作以使浏览器不会冻结？

我一直在阅读有关 setTimeout、jQuery 队列和延迟的内容，但也许我太密集了，无法理解这一切。这家伙有有趣的东西[http://erickrdch.com/2012/05/asynchronous-loop-with-jquery-deferred.html](http://erickrdch.com/2012/05/asynchronous-loop-with-jquery-deferred.html)

这是我的 each() 循环，它添加了悬停。

```
$('#biglist li').each(function(index) {
    $(this).hover(function(e){
        ...do stuff...
    });
}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:25:44.697

为什么你把它包裹在一个循环中？[尝试使用.on()](http://api.jquery.com/on/)将悬停应用到#biglist ，然后委托给每个 li：

```
$('#biglist').on('hover','li', function(){
    // do crap
}); 
```

.each() 循环可能会通过对每个项目进行处理而造成严重破坏。附带说明一下，如果您需要为 mouseenter 和 mouseleave 执行不同的功能，您需要使用 XML 格式（使用 .on() 方法与传统的 .hover() 方法略有不同）：

```
$('#biglist').on({
    mouseenter: function(){
        // do mouseenter crap
    },
    mouseleave: function(){
        // do mouseleave crap
    }
},'li'); 
```

无论哪种方式，这都应该大大减少处理过程中的 CPU 消耗。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:26:04.270

您应该将其绑定到`#bigList`using [`.on()`](http://api.jquery.com/on/)，而不是 10,000 多个元素：

```
$('#bigList').on('hover', 'li', function(e) {
  // ...
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:25:46.483

浏览器 JavaScript 不支持真正的并发（即除了尖端的 HTML5 功能），因此您不能在页面继续正常工作的同时在后台运行一个进程。

您可以做的最好的 AFAIK 是将您的处理代码切成尽可能小的块，然后使用`setTimeout`or执行它们`setInterval`，使用较低的延迟值（但最好是非零，因此页面的其余部分不会冻结）。

撇开您不需要`hover`为每个元素使用不同的处理程序这一事实不谈，正如其他人指出的那样，如果您需要对接收到的数据进行大量处理（并且这种处理不能由服务器完成），一种方法是使用队列：

```
var queue = [];
setInterval(function() {
    var next = queue.shift();
    if ( next ) next();
},50);

...

$.each(lotsOfData, function(index, value) {
    queue.push(function() {
        // Code for processing the value
    });
}); 
```

# java - 超级女王拼图数组异常

> ID：14885883
> 
> 赞同：-1
> 
> 时间：2013-02-14T23:22:08.517
> 
> 标签：java, arrays, puzzle, indexoutofboundsexception

我正在尝试`N*N`用一些扭曲来实现女王算法。在这个版本中，皇后也可以像骑士一样在国际象棋中移动。

检查对角线和行似乎很好，但是当我尝试在远离我当前位置的“L”位置检查女王时，我得到一个“arrayindexoutofboundexception”。我不完全确定我的 check_Knight 移动是否正确。我似乎无法在我的代码中找到导致问题的错误。

```
public class QueenGame {

  /**
   * @param args
   */
  static int solution =0;
  static boolean check_Queen(int row, int col, int queens[])
  {     
    for(int i =1; i<col; i++)
    {
      if (queens[col-i] == row   ||
          queens[col-i] == row-i ||
          queens[col-i] == row+i) 
      {
        //flag = false;
        return false;
      }

    }
    return true;

  }

  static boolean  check_KnightMove(int row, int col, int queens[])
  {
    if(queens[col-2] == (row -1) || queens[col-2] == (row+1))
    {
      return false;
    }
    return true;

  }

  static void placement(int col, int queens[], int n){
    //int solution =0; 
    for (int row = 1; row <= n; row++) {
      queens[col] = row;
      if((check_Queen(row,col,queens)) ==  true)
      {
        if((check_KnightMove(row,col,queens)) == true)
        {
          if(col == n)
          {
            solution++;
          }
          else
          { 
            placement(col+1,queens,n);   
          }
        }
      }
    }
    queens[col] = 0;
  }

  public static void main(String[] args) {
    int solution =0;
    Scanner scanner=new Scanner(System.in);
    //System.out.print("Please enter N");
    int n =10;
    //int n = scanner.nextInt();// TODO Auto-generated method stub
    //System.out.print(n);
    int queens[] = new int[n+1];
    placement(1,queens,n);
    System.out.println("nQueens: solution=" + solution);
  }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:24:45.437

如果`col`是 0 或 1，那么你会得到一个`ArrayIndexOutOfBoundsException`. 在访问数组之前添加检查。

```
if ((col >= 2) && (queens[col-2] == (row-1) || queens[col-2] == (row+1))) 
```

# c++ - 如何实现移动场景

> ID：14885884
> 
> 赞同：0
> 
> 时间：2013-02-14T23:22:10.490
> 
> 标签：c++, opengl

我想在 OpenGL 中实现一个移动的场景。

场景描述：地形是静态的，但所有其他对象都在向 -x 轴移动。

地形是 xz 平面中的一个平面。

我有一个网格，它会在几个地方的地形上出现很多次。
但是它们都将以特定的速度向 -x 轴移动。

我想到了这些可能的实现：

1.  只创建一个网格并显示多次（我更喜欢这个）
2.  创建多个网格，将它们保存到矢量，然后移动它们。在他们离开视口之后，也许摧毁他们？

第一种方法的问题在于，我将创建具有 ax% 可能性的网格，因此这需要不知道需要的网格数量。那么如何显示它们呢？

例如，如果我知道我会创建 3 个网格，我会这样做：

```
glPushMatrix();
glTranslatef(mesh1 position + speed)
mesh.dray();
glPopMatrix();

glPushMatrix();
glTranslatef(mesh2 position + speed)
mesh.dray();
glPopMatrix();

glPushMatrix();
glTranslatef(mesh3 position + speed)
mesh.dray();
glPopMatrix(); 
```

现在，如果我们需要在动画继续的情况下创建网格，我将如何实现呢？其次，离开视口的网格怎么办？它们是否继续存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:30:40.993

如果您打算在纯 openGL 中对此进行编码，则此答案毫无用处。

但是，如果您愿意尝试 3rd 方库，请尝试 www.ogre3d.org - 我会发现这在 ogre 中非常容易做到。

事实上，*如果*我没记错的话，“中级教程一”的挑战应该解决您在使用 openGL 时遇到的问题的等效 Ogre 概念。

[http://www.ogre3d.org/tikiwiki/tiki-index.php?page=Intermediate+Tutorial+1&structure=Tutorials](http://www.ogre3d.org/tikiwiki/tiki-index.php?page=Intermediate+Tutorial+1&structure=Tutorials)

*（本来会将此作为评论，直到最近才变得活跃！）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:42:55.533

使用选项 2。只是不要删除它们，只需将它们移回并再次使用它们。例如，如果我想数绵羊……我不会创建 1,000,000 个绵羊网格，我可能会创建 1 或 2 个，然后在使用它们之间进行轮换。

# ios - iOS 将 PKRevealController 与 Storyboard & Auto Layout 集成

> ID：14885887
> 
> 赞同：8
> 
> 时间：2013-02-14T23:22:43.333
> 
> 标签：ios, objective-c, ios5, storyboard, viewcontroller

我正在尝试将 PKRevealController 集成到我的现有项目中。

[https://github.com/pkluz/PKRevealController](https://github.com/pkluz/PKRevealController)

如果我使用情节提要，如何设置左视图控制器、右视图控制器和前视图控制器？自述文件说要做...

```
PKRevealController *revealController = [PKRevealController revealControllerWithFrontViewController:frontVC leftViewController:leftVC options:options];

self.window.rootViewController = revealController; 
```

我会将这些代码行放在我现有的故事板项目中的什么位置？或者有没有其他方法可以设置它？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-10T14:17:39.233

只需将 segue 目标控制器的类型设置为`PKRevealController`并为前、左和右视图控制器设置故事板 ID。

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{

  if ([segue.identifier isEqualToString:@"ToMain"]) {

    PKRevealController* prc = segue.destinationViewController;

    prc.frontViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"FrontViewController"];
    prc.leftViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"LeftViewController"];
    prc.rightViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"RightViewController"];

  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-26T07:39:53.753

我知道这是一个旧线程，但无论如何我都会在这里发表:)

要使**PKRevealController**基本上与故事板一起使用，您将需要三个视图控制器。

1.  **BaseController**（我称之为），它被 PKRevealController 扩展，它将如何充当主要内容控制器和导航控制器的基础。

2.  **MainController**，它被设置为 fronViewController。

3.  **NaviController**，我们基本上将其用作 leftViewController，也就是导航菜单。

仅供参考：您可以从 stroyboard 设计和编码 MainController 和 NaviController。

所以我们就是这样做的；首先，我们需要像这样使用 PKRevealController 扩展我们的 BaseController；

```
@interface MainController : PKRevealController 
```

其次，还是在 BaseController 中，将这些行添加到 viewDidLoad 方法中；

```
//init the fonrViewController
UIViewController *homeController = [self.storyboard instantiateViewControllerWithIdentifier:@"homeScreen"];
//init the leftViewController
UIViewController *naviContrlller = [self.storyboard instantiateViewControllerWithIdentifier:@"quickNaviScreen"];

[self setFrontViewController:homeController];
[self setLeftViewController:naviContrlller]; 
```

然后将 PKRevealController 委托设置为；

```
self.delegate = self; 
```

就是这样。

# wpf - 在画布 wpf 上的单击点处绘制一个矩形

> ID：14885890
> 
> 赞同：0
> 
> 时间：2013-02-14T23:22:51.877
> 
> 标签：wpf

在这里失去理智。过去几天我在 WinForms 中编写了一个 Windows 应用程序的开始......昨天做了 90 度大转弯，出于审美原因不得不切换到 WPF。在转换某些东西时遇到了一些麻烦......即任何与图形相关的东西。在 wpf 版本中，我使用以下 C# 代码在用户单击面板的位置创建了一个黑色圆圈和白色矩形，并显示一个消息框，显示 x 坐标是什么：

```
Graphics g;

private void panel1_MouseClick(object sender, MouseEventArgs e)
    {
        SolidBrush s2 = new SolidBrush(Color.Black);
        g.FillRectangle(s2, e.X + 3, e.Y + 3, 10, 10);
        SolidBrush s = new SolidBrush(Color.White);
        g.FillPie(s, e.X + 4, e.Y + 4, 7, 7, 0, 360);

        float x_cord = e.X;
        MessageBox.Show("X is:  " + x_cord.ToString());
    } 
```

我尝试通过以下代码在 wfb 中执行此操作：

```
 Graphics g;
    private void Canvas_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
    {
        System.Windows.Point position = e.GetPosition(this);
        double pX = position.X;
        double pXint = Convert.ToInt32(pX);
        MessageBox.Show(pX.ToString());
        SolidBrush s2 = new SolidBrush(System.Drawing.Color.Black);
        g.FillRectangle(s2, pXint, 5, 10, 10);
    } 
```

这可以正确编译并运行，但是当我单击画布时，什么也没有发生！消息框主要用于测试事件是否正在触发，显然不是。这是其中包含画布的窗口的相应 XML：

```
<Grid>
        <Canvas Name="Surface" Height="Auto" Width="Auto" Background="White"> </Canvas>
    </Grid> 
```

我在这里做错了什么？实际上，在大多数情况下，我实际上更喜欢 WPF，但某些事情绝对令人讨厌。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:36:29.920

问题是您试图将`System.Drawing`对象绘制到 WPF 上`Canvas`，您不能这样做。

解决此问题的一种方法是向`Rectangles`您添加`Canvas`.

```
<Grid>
    <Canvas Name="Surface" Height="Auto" Width="Auto" Background="White" MouseLeftButtonDown="Surface_MouseLeftButtonDown"></Canvas>
</Grid>

private void Surface_MouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    Rectangle rect = new Rectangle { Width = 10, Height = 10, Fill = Brushes.Black };
    Surface.Children.Add(rect);
    Canvas.SetLeft(rect, e.GetPosition(this).X);
    Canvas.SetTop(rect, e.GetPosition(this).Y);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T19:18:50.483

知道了。不敢相信我花了 6 个小时才画了一个矩形。不完全确定是什么使它起作用，但认为它必须与摆脱某些原因有关。`using System.Drawing;` 当我尝试 sa_ddam213 的代码时，我收到一条错误消息，说“无法从 System.Drawing.Rectangle 转换为 System.Windows.UIElement”，原因不明。在谷歌搜索号 5007 之后，我看到了这篇文章：

[http://msdn.microsoft.com/en-us/library/ms747393.aspx](http://msdn.microsoft.com/en-us/library/ms747393.aspx)

我以前看过它，但无法为直线或椭圆编译代码，我认为这是 System.Drawing 程序集导致问题。

非常感谢大家的帮助！！

# android - Android：卸载卡前关闭数据库

> ID：14885892
> 
> 赞同：0
> 
> 时间：2013-02-14T23:23:06.477
> 
> 标签：android, android-sdcard, unmount

我的 Android 应用程序中有以下问题。假设我正在运行使用 SQLite DB 的服务。并且用户决定卸载数据库文件所在的 SD 卡（连接到 USB 或手动）。我从广播接收器收到通知意图：

```
 IntentFilter MIF = new IntentFilter(Intent.ACTION_MEDIA_REMOVED);
    MIF.addAction(Intent.ACTION_MEDIA_UNMOUNTED);
    MIF.addAction(Intent.ACTION_MEDIA_EJECT);
    MIF.addDataScheme("file");
    registerReceiver(MediaReceiver,MIF); 
```

所以我能够检测到卡卸载。在此接收器的 onReceive 块中，我在用于查询的对象上显式调用 database.close()。但是我的应用程序崩溃了。不写它就停止工作，只是切换到主屏幕，仅此而已。

```
 02-14 23:23:30.586: E/ProcessKiller(127): Process cz.cuni.mff.drozi.Metro (27598) has open file /mnt/secure/staging/Android/data/cz.cuni.mff.drozi.Metro/files/database.db
    02-14 23:23:31.826: E/ProcessKiller(127): Process cz.cuni.mff.drozi.Metro (27598) has open file /mnt/secure/staging/Android/data/cz.cuni.mff.drozi.Metro/files/database.db
    02-14 23:23:33.056: E/ProcessKiller(127): Process cz.cuni.mff.drozi.Metro (27598) has open file /mnt/secure/staging/Android/data/cz.cuni.mff.drozi.Metro/files/database.db
    02-14 23:23:34.276: E/ProcessKiller(127): Process cz.cuni.mff.drozi.Metro (27598) has open file /mnt/secure/staging/Android/data/cz.cuni.mff.drozi.Metro/files/database.db
    02-14 23:23:35.496: E/ProcessKiller(127): Process cz.cuni.mff.drozi.Metro (27598) has open file /mnt/secure/staging/Android/data/cz.cuni.mff.drozi.Metro/files/database.db
     02-14 23:23:36.706: E/ProcessKiller(127): Process cz.cuni.mff.drozi.Metro (27598) has open file /mnt/secure/staging/Android/data/cz.cuni.mff.drozi.Metro/files/database.db 
```

这以应用程序崩溃结束。但我很确定我已经在数据库上明确调用了 close() 。

关闭数据库以使系统不会杀死我的应用程序的方法是什么？

非常感谢大家！

# sql-server - SQL Server 2008 可变位数

> ID：14885894
> 
> 赞同：1
> 
> 时间：2013-02-14T23:23:11.057
> 
> 标签：sql-server, sql-server-2008, bit-manipulation, bit, varbinary

使用 SQL Server 2008。

假设我有 3 个数字要存储。

*   第一个数字是任何 6 位数字
*   二是任意4bit
*   第三也是任何6位数字

例如：

```
declare @firstNumber_6bit  tinyint = 50
declare @secondNumber_4bit tinyint = 7
declare @thirdNumber_6bit  tinyint = 63 
```

我需要将这 3 个数字存储在`2 byte binary`（16 位）变量中。因此，该示例的二进制值为：

*   50 是`110010`，
*   7 是`0111`
*   63 是`111111`
*   要存储的 2 个字节是`11001001` `11111111`

因此，以下任一行都应存储这些值：

```
declare @my3NumbersIn2Bytes binary(2) = 51711 
```

或者

```
declare @my3NumbersIn2Bytes binary(2) = 0xC9FF 
```

（对不起，如果我在大/小端弄乱了字节顺序，但这不是重点）。

使用 .net CLR 存储和检索这些数字是一项微不足道的任务，但我试图在纯 T-SQL 中解决这个问题，我们知道`bit shifting`SQL Server 中没有。我看到了很多使用内存表来解决此类问题的示例，但是对于进行简单的位移位来说，这似乎完全是多余的……我在想更像`substring`for bits 的东西可以解决问题。我只是想确定在过度杀伤之前没有其他方法可以解决这个问题。

所以我的问题是，存储这 3 个数字并恢复它们的最有效方法是什么？

谢谢。-

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T04:57:24.033

```
declare @firstNumber_6bit  tinyint = 50
declare @secondNumber_4bit tinyint = 7
declare @thirdNumber_6bit  tinyint = 63

declare @my3NumbersIn2Bytes binary(2)

select @my3NumbersIn2Bytes = @firstNumber_6bit*1024 + @secondNumber_4bit *64 + @thirdNumber_6bit
--extract values
select @firstNumber_6bit = @my3NumbersIn2Bytes/1024
select @secondNumber_4bit = (@my3NumbersIn2Bytes%1024)/64
select @thirdNumber_6bit = (@my3NumbersIn2Bytes%1024)%64

select convert(varchar(max), @my3NumbersIn2Bytes, 1) -- just for display
, @firstNumber_6bit
, @secondNumber_4bit
, @thirdNumber_6bit 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!6/d41d8/2575)

# python - Matplotlib 中按列值着色

> ID：14885895
> 
> 赞同：63
> 
> 时间：2013-02-14T23:23:12.467
> 
> 标签：python, pandas, matplotlib, seaborn

我最喜欢`ggplot2`在 R 中使用库的一个方面是能够轻松指定美学。我可以快速制作一个散点图并应用与特定列相关的颜色，我希望能够使用 python/pandas/matplotlib 来做到这一点。我想知道人们是否有任何便利功能可以使用熊猫数据框和 Matplotlib 将颜色映射到值？

```
##ggplot scatterplot example with R dataframe, `df`, colored by col3
ggplot(data = df, aes(x=col1, y=col2, color=col3)) + geom_point()

##ideal situation with pandas dataframe, 'df', where colors are chosen by col3
df.plot(x=col1,y=col2,color=col3) 
```

编辑：感谢您的回复，但我想包含一个示例数据框来澄清我的要求。两列包含数字数据，第三列是分类变量。我正在考虑的脚本将根据此值分配颜色。

```
np.random.seed(250)
df = pd.DataFrame({'Height': np.append(np.random.normal(6, 0.25, size=5), np.random.normal(5.4, 0.25, size=5)),
                   'Weight': np.append(np.random.normal(180, 20, size=5), np.random.normal(140, 20, size=5)),
                   'Gender': ["Male","Male","Male","Male","Male",
                              "Female","Female","Female","Female","Female"]})

     Height      Weight  Gender
0  5.824970  159.210508    Male
1  5.780403  180.294943    Male
2  6.318295  199.142201    Male
3  5.617211  157.813278    Male
4  6.340892  191.849944    Male
5  5.625131  139.588467  Female
6  4.950479  146.711220  Female
7  5.617245  121.571890  Female
8  5.556821  141.536028  Female
9  5.714171  134.396203  Female 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2013-02-15T01:37:49.507

## 导入和数据

```
import numpy 
import pandas
import matplotlib.pyplot as plt
import seaborn
seaborn.set(style='ticks')

numpy.random.seed(0)
N = 37
_genders= ['Female', 'Male', 'Non-binary', 'No Response']
df = pandas.DataFrame({
    'Height (cm)': numpy.random.uniform(low=130, high=200, size=N),
    'Weight (kg)': numpy.random.uniform(low=30, high=100, size=N),
    'Gender': numpy.random.choice(_genders, size=N)
}) 
```

## 2021 年 8 月更新

*   使用`seaborn 0.11.0`，建议使用新的图形级别功能，例如直接[`seaborn.relplot`](https://seaborn.pydata.org/generated/seaborn.relplot.html)使用[`FacetGrid`](https://seaborn.pydata.org/generated/seaborn.FacetGrid.html)。

```
seaborn.relplot(data=df, x='Weight (kg)', y='Height (cm)', hue='Gender', hue_order=_genders, aspect=1.61)
plt.show() 
```

## 2015 年 10 月更新

Seaborn 出色地处理了这个用例：

*   映射`matplotlib.pyplot.scatter`到[`seaborn.FacetGrid`](https://seaborn.pydata.org/generated/seaborn.FacetGrid.html)

```
fg = seaborn.FacetGrid(data=df, hue='Gender', hue_order=_genders, aspect=1.61)
fg.map(plt.scatter, 'Weight (kg)', 'Height (cm)').add_legend() 
```

立即输出：

[![在此处输入图像描述](../Images/986895795a105a8a912ae1864cf147d0.png)](https://i.stack.imgur.com/GnmJP.png)

## 旧答案

在这种情况下，我会直接使用 matplotlib。

```
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

def dfScatter(df, xcol='Height', ycol='Weight', catcol='Gender'):
    fig, ax = plt.subplots()
    categories = np.unique(df[catcol])
    colors = np.linspace(0, 1, len(categories))
    colordict = dict(zip(categories, colors))  

    df["Color"] = df[catcol].apply(lambda x: colordict[x])
    ax.scatter(df[xcol], df[ycol], c=df.Color)
    return fig

if 1:
    df = pd.DataFrame({'Height':np.random.normal(size=10),
                       'Weight':np.random.normal(size=10),
                       'Gender': ["Male","Male","Unknown","Male","Male",
                                  "Female","Did not respond","Unknown","Female","Female"]})    
    fig = dfScatter(df)
    fig.savefig('fig1.png') 
```

这给了我：

![具有分类颜色的比例图](../Images/a4bc622feb9af63884e0469ad459ff14.png)

据我所知，该颜色列可以是任何与 matplotlib 兼容的颜色（RBGA 元组、HTML 名称、十六进制值等）。

除了数值之外，我无法获取与颜色图一起使用的任何内容。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2015-12-02T14:17:24.203

实际上，您可以将[ggplot 用于 python](http://ggplot.yhathq.com/)：

```
from ggplot import *
import numpy as np
import pandas as pd

df = pd.DataFrame({'Height':np.random.randn(10),
                   'Weight':np.random.randn(10),
                   'Gender': ["Male","Male","Male","Male","Male",
                              "Female","Female","Female","Female","Female"]})

ggplot(aes(x='Height', y='Weight', color='Gender'), data=df)  + geom_point() 
```

[![python中的ggplot](../Images/e13a6e1574ac824b73ca1d9defab5de5.png)](https://i.stack.imgur.com/dO2oA.png)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2020-02-03T11:34:47.780

[https://seaborn.pydata.org/generated/seaborn.scatterplot.html](https://seaborn.pydata.org/generated/seaborn.scatterplot.html)

```
import numpy 
import pandas
import seaborn as sns

numpy.random.seed(0)
N = 37
_genders= ['Female', 'Male', 'Non-binary', 'No Response']
df = pandas.DataFrame({
    'Height (cm)': numpy.random.uniform(low=130, high=200, size=N),
    'Weight (kg)': numpy.random.uniform(low=30, high=100, size=N),
    'Gender': numpy.random.choice(_genders, size=N)
})

sns.scatterplot(data=df, x='Height (cm)', y='Weight (kg)', hue='Gender') 
```

[![在此处输入图像描述](../Images/b53ec5fdbab9e6aaa591b8d035c68a92.png)](https://i.stack.imgur.com/EDiXg.png)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-15T02:51:58.620

您可以使用绘图方法的***颜色***参数来定义每列所需的颜色。例如：

```
from pandas import DataFrame
data = DataFrame({'a':range(5),'b':range(1,6),'c':range(2,7)})
colors = ['yellowgreen','cyan','magenta']
data.plot(color=colors) 
```

![三行自定义颜色](../Images/b0cedc33ee091532ec47c464cb7757db.png)

您可以使用颜色名称或颜色十六进制代码，例如“#000000”来表示黑色。您可以在 matplotlib 的 color.py 文件中找到所有定义的颜色名称。下面是 matplotlib 的 github 存储库中 color.py 文件的链接。

[https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/colors.py](https://github.com/matplotlib/matplotlib/blob/master/lib/matplotlib/colors.py)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-08-15T23:35:43.530

*   添加此答案是因为该问题是规范的，并且许多用户正在寻求分类或数字数据的答案。
    *   OP 按分类列着色，但此答案适用于按**numeric**列着色，或者可以解释为数字，例如 a **`datetime dtype`**。
*   [`pandas.DataFrame.plot`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.plot.html)并且[`matplotlib.pyplot.scatter`](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.scatter.html)可以采用`c`or`color`参数，它必须是颜色、颜色序列或数字序列。
*   **在`python 3.8`、`pandas 1.3.1`和中测试`matplotlib 3.4.2`**
*   为其他有效`cmap`选项[选择 Matplotlib 中的颜色图。](https://matplotlib.org/stable/tutorials/colors/colormaps.html)

## 导入和测试数据

*   `'Date'`已经是`datetime64[ns] dtype`来自`DataReader`
*   `conda install -c anaconda pandas-datareader`或`pip install pandas-datareader`取决于您的环境。

```
import pandas as pd
import matplotlib.pyplot as plt
import pandas_datareader as web  # for data; not part of pandas

tickers = 'amzn'
df = web.DataReader(ticker, data_source='yahoo', start='2018-01-01', end='2021-01-01').reset_index()
df['ticker'] = ticker

        Date        High          Low         Open        Close   Volume    Adj Close ticker
0 2018-01-02  1190.00000  1170.510010  1172.000000  1189.010010  2694500  1189.010010   amzn
1 2018-01-03  1205.48999  1188.300049  1188.300049  1204.199951  3108800  1204.199951   amzn 
```

## `c`作为一个数字

### `pandas.DataFrame.plot`

*   `df.Date.dt.month`创建`pandas.Series`一个月的数字

```
ax = df.plot(kind='scatter', x='Date', y='High', c=df.Date.dt.month, cmap='Set3', figsize=(11, 4), title='c parameter as a month number')
plt.show() 
```

### `matplotlib.pyplot.scatter`

```
fig, ax = plt.subplots(figsize=(11, 4))
ax.scatter(data=df, x='Date', y='High', c=df.Date.dt.month, cmap='Set3')
ax.set(title='c parameter as a month number', xlabel='Date', ylabel='High')
plt.show() 
```

[![在此处输入图像描述](../Images/288618e46f2fe5b1451439544376a794.png)](https://i.stack.imgur.com/qmGzS.png)

## `c`作为一个`datetime dtype`

### `pandas.DataFrame.plot`

```
ax = df.plot(kind='scatter', x='Date', y='High', c='Date', cmap='winter', figsize=(11, 4), title='c parameter as a datetime dtype')
plt.show() 
```

### `matplotlib.pyplot.scatter`

```
fig, ax = plt.subplots(figsize=(11, 4))
ax.scatter(data=df, x='Date', y='High', c='Date', cmap='winter')
ax.set(title='c parameter as a datetime dtype', xlabel='Date', ylabel='High')
plt.show() 
```

[![在此处输入图像描述](../Images/122707dfb347e5f6d82e5a1d6a04ae8f.png)](https://i.stack.imgur.com/J6hbj.png)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-08-16T02:12:28.537

虽然不是 matplotlib，但您可以使用[plotly express](https://plotly.com/python/plotly-express/)实现此目的：

```
import numpy as np
import pandas as pd
import plotly.express as px

df = pd.DataFrame({
    'Height':np.random.normal(size=10),
    'Weight':np.random.normal(size=10),
    'Size': 1,  # How large each point should be?
    'Gender': ["Male","Male","Male","Male","Male","Female","Female","Female","Female","Female"]})

# Create your plot
px.scatter(df, x='Weight', y='Height', size='Size', color='Gender') 
```

**如果在笔记本中创建，您将获得如下交互式输出：** [![在此处输入图像描述](../Images/4d67c8db3bfadf7cbda623be74c71ba8.png)](https://i.stack.imgur.com/5J3Kc.gif)

# batch-file - 我的批处理文件提示不断将所有答案作为第一个标签

> ID：14885897
> 
> 赞同：0
> 
> 时间：2013-02-14T23:23:47.833
> 
> 标签：batch-file, cmd, exe

当我按提示之间的任何数字时，我的批处理文件总是返回插件而不是转到所需的位置。问题可能源于什么？

> @echo off ECHO 控制面板已初始化。
> 
> ：开始
> 
> CHOICE /N /C:1234 /M "选择一个数字 (1(PLUGINS), 2(MOTD), 3(LOGS), 4(END)"%1
> 
> 如果 %%ERRORLEVEL ==1 转到 1
> 
> 如果 %%ERRORLEVEL ==2 转到两个
> 
> 如果 %%ERRORLEVEL ==3 转到三
> 
> 如果 %%ERRORLEVEL ==4 转到结束
> 
> ：一
> 
> 回声插件
> 
> explorer \\192.168.1.16\Server\Server-Dedicated Slightly\Here is the Actual Server dir\plugins
> 
> 转到开始
> 
> ：二
> 
> 回声MOTD
> 
> notepad \\192.168.1.16\Server\Server-Dedicated Slightly\Here is the Actual Server dir\plugins\Essentials\motd
> 
> 转到开始
> 
> ：三
> 
> 回声日志
> 
> notepad \\192.168.1.16\Server\Server-Dedicated Slightly\Here is the Actual Server dir\server
> 
> 转到开始
> 
> ：结尾
> 
> 暂停

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:27:10.700

三个问题：

1.  ERRORLEVEL 检查给定值或以上，因此您必须将它们从高到低排序，而不是相反
2.  这是 ERRORLEVEL，而不是 %%ERRORLEVEL
3.  这只是 ERRORLEVEL 编号

所以，简而言之，你会得到

```
IF ERRORLEVEL 4 GOTO END 
...
IF ERRORLEVEL 1 GOTO ONE 
```

# sql - 逻辑合并4列相同信息

> ID：14885902
> 
> 赞同：0
> 
> 时间：2013-02-14T23:24:16.670
> 
> 标签：sql, tsql

我正在查询 3 个不同的数据库（总共 4 个字段）的“用户名”字段，给定我们环境中的特定机器名称：SCCM、McAfee EPO 和 ActiveDirectory。

四列分别是 SCCM_TOP、SCCM_LAST、EPO、AD

我得到的一些元组看起来像：

```
JOE, JOE, ADMINISTRATOR, JOE

or
JOE, SARAH, JOE, JOE

or
NULL, NULL, JOE, JOE

or
NULL, NULL, JOE, SARAH 
```

最后一个例子是最难编写代码的。

我正在编写 CASE 语句，以帮助以附加方式合并信息，以给出“最佳猜测”的最后一列。目前，我正在根据另一列权衡最有效的用户名，即每个数据库中的“记录年龄”。

```
CASE 
 WHEN ePO_Age <= CT_AGE AND NOT ePO_UN IS NULL THEN ePO_UN 
 WHEN NOT (SCCM_AGE) IS NULL AND NOT (SCCM_LAST_UN) IS NULL THEN SCCM_LAST_UN
 WHEN NOT (SCCM_AGE) IS NULL AND NOT (SCCM_TOP_UN) IS NULL THEN SCCM_TOP_UN 
 WHEN NOT (AD_UN) IS NULL THEN AD_UN 
 ELSE NULL 
 END                  AS BestName, 
```

但是必须有一种更好的方法将这些记录合并为一个。我的下一步是权衡“平均年龄”，然后从那里选择用户名，丢弃“管理员”。

有什么想法或技巧吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T00:17:32.247

您可以从 COALESCE 函数中受益一点，以获取第一个 NON-NULL 值并执行以下操作：

```
COALESCE(CASE WHEN ePO_Age<=CT_AGE THEN ePO_UN END,
         CASE WHEN SCCM_AGE IS NOT NULL THEN COALESCE(SCCM_LAST_UN, SCCM_TOP_UN) END,
         AD_UN) AS BestName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:12:25.420

如果您只想获取不为空的最新用户名，请尝试使用`UNION`来组合每个表的结果。

```
SELECT TOP 1 qry.UserName
FROM(
  SELECT UserName, CreateDate
  FROM UserNames_1
  UNION ALL
  SELECT UserName, CreateDate
  FROM UserNames_2
  UNION ALL
  SELECT UserName, CreateDate
  FROM UserNames_3
 ) AS qry
WHERE qry.UserName IS NOT NULL
ORDER BY qry.CreateDate DESC 
```

有一个[SQL Fiddle](http://sqlfiddle.com/#!3/73f3e/5/0)

# python - 使用 BeautifulSoup 抓取产品名称

> ID：14885907
> 
> 赞同：0
> 
> 时间：2013-02-14T23:24:45.460
> 
> 标签：python, python-2.7, beautifulsoup

我正在使用 BeautifulSoup (BS4) 构建一个抓取工具，它允许我从位于“h1”标签之间的任何 TopShop.com 产品页面中提取产品名称。无法弄清楚为什么我编写的代码不起作用！

```
from urllib2 import urlopen
from bs4 import BeautifulSoup
import re

TopShop_URL = raw_input("Enter a TopShop Product URL")
ProductPage = urlopen(TopShop_URL).read()

soup = BeautifulSoup(ProductPage)

ProductNames = soup.find_all('h1')

print ProductNames 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:45:45.740

我使用请求（[http://docs.python-requests.org/en/latest/](http://docs.python-requests.org/en/latest/)）得到这个工作

```
from bs4 import BeautifulSoup
import requests

content = requests.get("TOPShop_URL").content
soup = BeautifulSoup(content)
product_names = soup.findAll("h1")
print product_names 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:01:00.230

您的代码是正确的，但问题是包含产品名称的 div 是通过 JavaScript 动态生成的。为了能够成功解析此元素，您应该介意使用[Selenium](http://seleniumhq.org/)或类似工具，这将允许您在所有 dom 完全加载后解析网页。

# python - 从 CSV 文件中去除空格

> ID：14885908
> 
> 赞同：37
> 
> 时间：2013-02-14T23:24:48.670
> 
> 标签：python, csv, data-munging

我需要从读取的 CSV 文件中删除空格

```
import csv

aList=[]
with open(self.filename, 'r') as f:
    reader = csv.reader(f, delimiter=',', quoting=csv.QUOTE_NONE)
    for row in reader:
        aList.append(row)
    # I need to strip the extra white space from each string in the row
    return(aList) 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-06-14T21:34:22.573

还有嵌入的格式化参数：skipinitialspace（默认为false） [http://docs.python.org/2/library/csv.html#csv-fmt-params](http://docs.python.org/2/library/csv.html#csv-fmt-params)

```
aList=[]
with open(self.filename, 'r') as f:
    reader = csv.reader(f, skipinitialspace=False,delimiter=',', quoting=csv.QUOTE_NONE)
    for row in reader:
        aList.append(row)
    return(aList) 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-09-09T18:08:32.480

**就我而言**，我只关心在使用[`csv.DictReader`](https://docs.python.org/2/library/csv.html#csv.DictReader).

创建一个基于 的类`csv.DictReader`，并覆盖该`fieldnames`属性以从每个字段名称（又名列标题，又名字典键）中去除空格。

通过获取字段名的常规列表，然后对其进行迭代，同时创建一个从每个字段名中去除空格的新列表，并将基础`_fieldnames`属性设置为这个新列表。

```
import csv

class DictReaderStrip(csv.DictReader):
    @property                                    
    def fieldnames(self):
        if self._fieldnames is None:
            # Initialize self._fieldnames
            # Note: DictReader is an old-style class, so can't use super()
            csv.DictReader.fieldnames.fget(self)
            if self._fieldnames is not None:
                self._fieldnames = [name.strip() for name in self._fieldnames]
        return self._fieldnames 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-02-14T23:27:19.587

```
with open(self.filename, 'r') as f:
    reader = csv.reader(f, delimiter=',', quoting=csv.QUOTE_NONE)
    return [[x.strip() for x in row] for row in reader] 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-14T23:26:20.887

你可以做：

```
aList.append([element.strip() for element in row]) 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-08-04T17:29:57.300

解析后格式化单元格的最节省内存的方法是通过[生成器](https://wiki.python.org/moin/Generators)。就像是：

```
with open(self.filename, 'r') as f:
    reader = csv.reader(f, delimiter=',', quoting=csv.QUOTE_NONE)
    for row in reader:
        yield (cell.strip() for cell in row) 
```

但可能值得将它移到一个函数中，您可以使用它来保持变化并避免即将进行的迭代。例如：

```
nulls = {'NULL', 'null', 'None', ''}

def clean(reader):
    def clean(row):
        for cell in row:
            cell = cell.strip()
            yield None if cell in nulls else cell

    for row in reader:
        yield clean(row) 
```

或者它可以用来分解一个类：

```
def factory(reader):
    fields = next(reader)

    def clean(row):
        for cell in row:
            cell = cell.strip()
            yield None if cell in nulls else cell

    for row in reader:
        yield dict(zip(fields, clean(row))) 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-05-30T14:41:57.877

您可以在文件周围创建一个包装器对象，在 CSV 阅读器看到它们之前去除空格。这样，您甚至可以将 csv 文件与 cvs.DictReader 一起使用。

```
import re

class CSVSpaceStripper:
  def __init__(self, filename):
    self.fh = open(filename, "r")
    self.surroundingWhiteSpace = re.compile("\s*;\s*")
    self.leadingOrTrailingWhiteSpace = re.compile("^\s*|\s*$")

  def close(self):
    self.fh.close()
    self.fh = None

  def __iter__(self):
    return self

  def next(self):
    line = self.fh.next()
    line = self.surroundingWhiteSpace.sub(";", line)
    line = self.leadingOrTrailingWhiteSpace.sub("", line)
    return line 
```

然后像这样使用它：

```
o = csv.reader(CSVSpaceStripper(filename), delimiter=";")
o = csv.DictReader(CSVSpaceStripper(filename), delimiter=";") 
```

我硬编码`";"`为分隔符。将代码推广到任何定界符留给读者作为练习。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-05-02T10:49:50.983

使用 Pandas 读取 CSV（或 Excel 文件）并使用此自定义函数对其进行修剪。

```
#Definition for strippping whitespace
def trim(dataset):
    trim = lambda x: x.strip() if type(x) is str else x
    return dataset.applymap(trim) 
```

您现在可以像这样将修剪（CSV/Excel）应用于您的代码（作为循环的一部分等）

```
dataset = trim(pd.read_csv(dataset))
dataset = trim(pd.read_excel(dataset)) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-26T15:25:21.110

我想出了一个非常简单的解决方案：

```
import csv

with open('filename.csv') as f:
  reader = csv.DictReader(f)
  rows = [ { k.strip(): v.strip() for k,v in row.items() } for row in reader ] 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-02-22T10:37:29.763

这是适用于 Python3 的 Daniel Kullmann 出色的解决方案：

```
import re

class CSVSpaceStripper:
    """strip whitespaces around delimiters in the file
    NB has hardcoded delimiter ";"
    """

    def __init__(self, filename):
        self.fh = open(filename, "r")
        self.surroundingWhiteSpace = re.compile(r"\s*;\s*")
        self.leadingOrTrailingWhiteSpace = re.compile(r"^\s*|\s*$")

    def close(self):
        self.fh.close()
        self.fh = None

    def __iter__(self):
        return self

    def __next__(self):
        line = self.fh.readline()
        line = self.surroundingWhiteSpace.sub(";", line)
        line = self.leadingOrTrailingWhiteSpace.sub("", line)
        return line 
```

# cocoa - Mac OS X Cocoa 多视图应用程序导航

> ID：14885909
> 
> 赞同：5
> 
> 时间：2013-02-14T23:24:50.477
> 
> 标签：cocoa, multiview, nsviewcontroller

我已经花了整整 2 天的时间试图弄清楚如何使用 NSViewControllers 来创建多视图应用程序。

这就是我所做的。

我有 2 个视图控制器和 MainMenu.xib 的窗口。我还有一个 AppController，它是两个视图控制器的代表。

当我启动应用程序时，我首先看到 MainMenu.xib 的窗口视图，其中包含一个按钮。单击此按钮时，将向 appController 发送 IBAction 并要求 SecondViewController 显示它的 nib。到目前为止，一切都很好，并且 nib 文件显示正确。

在 secondViewController 上，有另一个按钮将另一个 IBAction 发送到 appController 并要求显示 FirstViewController 但没有任何反应，没有崩溃，没有警告......任何帮助将不胜感激......提前感谢您的耐心等待。 ..

这是 AppController.h 的代码：

```
#import <Foundation/Foundation.h>
#import "SecondViewController.h"
#import "FirstViewController.h"

@interface AppController : NSObject

@property (strong) IBOutlet NSWindow *mainWindow;

@property (strong) IBOutlet SecondViewController *secondViewController;
@property (strong) IBOutlet FirstViewController *firstViewController;

- (IBAction)secondButtonfromsecondViewControllerClicked:(id)sender;

- (IBAction)buttonClicked:(id)sender;

@end 
```

这是 AppController.m 的代码：

```
#import "AppController.h"

@implementation AppController
@synthesize mainWindow = mainwindow;
@synthesize secondViewController;
@synthesize firstViewController;

- (IBAction)buttonClicked:(id)sender {

     NSLog(@"button from second View Controller clicked");

     self.secondViewController = [[SecondViewController  
     alloc]initWithNibName:@"SecondViewController" bundle:nil];
     self.mainWindow.contentView = self.secondViewController.view;
     [self.secondViewController.view setAutoresizingMask:NSViewWidthSizable | 
     NSViewHeightSizable];
}

 - (IBAction)secondButtonfromsecondViewControllerClicked:(id)sender {

     NSLog(@"button from first ViewController clicked");

     self.firstViewController = [[FirstViewController 
     alloc]initWithNibName:@"FirstViewController" bundle:nil];
     self.mainWindow.contentView = [self.firstViewController view];

}

@end 
```

好吧，任何人都可以帮助我，我只需要一个视图应用程序，它显示第一个 ViewController 和第一个 viewController 上的按钮，将我带到第二个视图控制器，第二个按钮带我回到我的第一个视图控制器......我'已经花了一个多星期了......徒劳无功...... PS：我不想要mainMenu.xib窗口或选项卡上的任何按钮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T22:04:45.923

这是我的问题的解决方案。

这是 AppDelegate.h 的代码：

```
 //  AppDelegate.h

 #import <Cocoa/Cocoa.h>
 #import "FirstViewController.h"
 #import "SecondViewController.h"

 //We need to declare the AppDelegate class as being the delegate for both 
 //FirstViewController and SecondViewController

 @interface AppDelegate : NSObject <NSApplicationDelegate, 
 FirstViewControllerDelegate, SecondViewControllerDelegate>

 @property (strong, nonatomic) NSWindow *window;
 @property (strong) FirstViewController *firstViewController;
 @property (strong) SecondViewController *secondViewController;

 -(void) goToSecondView;
 -(void) goToFirstView;

 @end 
```

现在，这是 AppDelegate.m：

```
 //  AppDelegate.m

 #import "AppDelegate.h"

 @implementation AppDelegate

 @synthesize window = _window;
 @synthesize firstViewController;
 @synthesize secondViewController;

 -(void) awakeFromNib {

 [self goToFirstView];
 self.firstViewController.delegate = self;

 }

 -(void) goToSecondView {

        if (self.secondViewController ==nil) {
            self.secondViewController =[[SecondViewController alloc] 
            initWithNibName:@"SecondViewController" bundle:nil];
        }

        self.window.contentView = [self.secondViewController view];
  }

 -(void) goToFirstView {

 if (self.firstViewController ==nil) {
     self.firstViewController =[[FirstViewController alloc] 
     initWithNibName:@"FirstViewController" bundle:nil];
   }

    self.window.contentView = [self.firstViewController view];

 }

 @end 
```

接下来我们需要在 FirstViewController 和 SecondViewController 中设置委托

```
//  FirstViewController.h

#import <Cocoa/Cocoa.h>
#import "SecondViewController.h"

//We declare the delegation protocole:

@protocol FirstViewControllerDelegate <NSObject>

-(void)goToSecondView;

@end

@interface FirstViewController : NSViewController

- (IBAction)firstViewControllerButtonClicked:(id)sender;

@property (nonatomic, strong) id <FirstViewControllerDelegate> delegate;

@end 
```

这是 FirstViewController.m：

```
 //  FirstViewController.m

 #import "FirstViewController.h"

 @implementation FirstViewController
 @synthesize delegate;

 - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil{
   self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
   if (self) {

    self.delegate = [NSApp delegate];

    }

   return self;
 }

 - (IBAction)firstViewControllerButtonClicked:(id)sender {

   NSLog(@"button from first View Controller clicked");

   if ([self.delegate respondsToSelector:@selector(goToSecondView)]) {
    [self.delegate goToSecondView];
   }
 }

 @end 
```

现在，SecondViewController 也一样：

```
 //  SecondViewController.h

 #import <Cocoa/Cocoa.h>

 @protocol SecondViewControllerDelegate <NSObject>

 -(void)goToFirstView;

 @end

 @interface SecondViewController : NSViewController

 @property (nonatomic, strong) id <SecondViewControllerDelegate> delegate;

 - (IBAction)goToFirstViewControllerButtonClicked:(id)sender;

 @end 
```

这是 SecondViewController.m：

```
 //  SecondViewController.m

  #import "SecondViewController.h"

  @interface SecondViewController ()

  @end

  @implementation SecondViewController

  - (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil{
  self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
  if (self) {

      self.delegate = [NSApp delegate];
   }

    return self;
  }

  - (IBAction)goToFirstViewControllerButtonClicked:(id)sender {

    NSLog(@"button from Second View Controller clicked");

    if ([self.delegate respondsToSelector:@selector(goToFirstView)]) {
    [self.delegate goToFirstView];
  }

 }
 @end 
```

好吧，我想这段代码可能会得到改进，如果您有任何建议，请随时告诉我。希望它会帮助别人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T18:07:14.587

**问题：** 当用户在 View2 中按下按钮时，您希望 View1 出现。它不是。

第 1 步：您说按钮*应该*调用 AppController 上的操作。在该操作中设置断点（或添加诊断日志），只是为了验证它实际上是否被调用。

第 2 步：准确地考虑您希望该操作做什么。我的猜测是你想隐藏 View2 并显示 View1。也许

```
 [view2 setHidden: YES];
 [view1 setHidden: NO]; 
```

（当然，我在这里没有使用您的名字。）或者您可以为过渡设置动画，或者交叉淡化视图或移动它们。

第 3 步：我的猜测是第 2 步将解决您的问题。如果不是，请再次使用调试器来验证 view1 和 view2 是否不为空。（如果它们为空，您可能有弱变量需要它们变强。）

第 4 步：万一您仍然卡住，请检查 view1 和 view2 的框架。也许 view1 不是你想的那样。

第 5 步：如果仍然卡住，请检查 view1 的 alphaValue。也许你将它设置为透明的，并且它被透明地绘制在正确的位置。

第 6 步：我敢打赌没有第 6 步！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T11:30:06.087

目前这不是一个很好的答案，但是我对你的代码有些担心，我想和你一起工作。

*   您确定已在 Interface Builder 中连接了出口和操作。请验证这一点。

*   您不需要`mainWindow`，因为已经有一个`window`指向主窗口的属性（在 Interface Builder 中验证这一点）。这看起来也是错误的：

    ```
    @synthesize mainWindow = mainwindow;
                                 ^
                                 W 
    ```

    所以转储它并使用`window`Xcode 提供的现有插座。

*   如果视图控制器已经存在，请不要重新创建它们：

    ```
    if (self.secondViewController == nil)
    {
        self.secondViewController = [[SecondViewController alloc] initWithNibName:@"SecondViewController"
                                                                           bundle:nil];
    }
    self.window.contentView = self.secondViewController.view; 
    ```

# jquery - 一种停止 ajax.complete 的方法

> ID：14885910
> 
> 赞同：0
> 
> 时间：2013-02-14T23:24:52.330
> 
> 标签：jquery, ajax, recursion

有没有办法阻止 .complete 调用触发？done 和 fail 还不够好，因为完整部分存在递归。（我希望它再做一次，即使它失败了）

```
request.complete(function(){
                myrefresh = setTimeout(function(){updateMenu(ID);}, 5000);
            }); 
```

是我的 ajax 调用的完整方法，每 5 秒运行一次。最后，当这个更新完成时，我会收到 request.done 的回复，它会给我一个条件标记。即，我想做这样的事情：

```
if(flag=0) {  request.complete(function(){
                myrefresh = setTimeout(function(){updateMenu(ID);}, 5000);
            });
} else { clearInterval(myrefresh) } 
```

但在构建一个大

```
 var request = $.ajax({  
            url: etc 
```

设置。

有任何想法吗？

关于如何设置？我似乎无法让 .done return (text) var 在 .complete 区域中工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:08:35.250

我认为您正在寻找[setInterval()](https://developer.mozilla.org/en-US/docs/DOM/window.setInterval#Example)和[clearInterval()](https://developer.mozilla.org/en-US/docs/DOM/window.clearInterval)。它们是原生 JavaScript 函数，允许您在给定的时间间隔内重复执行一个函数。

```
var intervalId = setInterval(updateMenu, 5000, ID);
// When you want to stop....
clearInterval(intervalId); 
```

# html - @media 查询用于内联以在电子邮件中使用？

> ID：14885911
> 
> 赞同：0
> 
> 时间：2013-02-14T23:24:51.103
> 
> 标签：html, css, email, media

我正在构建一个 HTML 电子邮件，并希望使用 @media 查询来显示一个用于移动设备的横幅和另一个用于桌面/网络邮件屏幕的横幅。我知道大多数电子邮件客户端都会去掉标签中的 CSS。有没有办法将css内联？这是当前..中的代码示例

```
<style type="text/css">

  @media (max-width: 1000px){
    /* rules defined inside here are only applied to browsers that support CSS media queries and the browser window is 480px or smaller */
    img#standardBanner{display:none !important}
    img#mobileBanner{display:block !important} 
  }

</style> 
```

还有其他方法可以做到这一点吗？我运气不太好。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:47:08.860

要回答您的问题，对于纯 css 解决方案，答案是否定的，这是不可能的。

您可以通过服务器提供图像并使用 PHP 等脚本语言来获取用户的设备信息，然后使用 PHP 函数标头根据该信息提供适当的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:48:04.800

```
<style type="text/css">

    img#standardBanner{display:block !important}
    img#mobileBanner{display:none !important} 

    @media (max-width: 1000px){

    img#standardBanner{display:none !important}
    img#mobileBanner{display:block !important} 
  }

</style> 
```

# mysql - 选择当时的情况（选择）

> ID：14885912
> 
> 赞同：7
> 
> 时间：2013-02-14T23:24:59.070
> 
> 标签：mysql, select, case

我正在尝试根据产品类型为产品选择一组不同的结果。因此，如果我的产品应该是一本书，我希望它查找普通产品的 UPC 和 Artist，但是这些细节无关紧要，而对于另一种产品，我想要一组完全不同的结果。

```
SELECT CASE Product.type_id
    WHEN 10 THEN (
        SELECT 
        Product.product_id, 
        Product.type_id, 
        Product.product_name, 
        Product.UPC,
        Product_Type.type,
        CONCAT_WS(' ' , first_name, middle_name, last_name ) AS artistC 
        FROM Product, Product_Type, Product_ArtistAuthor 
        WHERE Product.type_id = Product_Type.type_id 
        AND Product.product_id = $pid
        AND Product.artist_id = Product_ArtistAuthor.artist_id
    )
    ELSE (
        SELECT 
        Product.product_id, 
        Product.type_id, 
        Product.product_name,
        Product_Type.type 
        FROM Product, Product_Type 
        WHERE Product.type_id = Product_Type.type_id 
        AND Product.product_id = $pid
    )
END
FROM Product 
WHERE Product.product_id = $pid 
```

我不确定我哪里出错了

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-15T00:10:35.100

您可以尝试其他格式的案例陈述

```
CASE WHEN Product.type_id = 10
THEN
(
  Select Statement
)
ELSE
(
  Other select statement

)  
END
FROM Product 
WHERE Product.product_id = $pid 
```

有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/ms181765.aspx](http://msdn.microsoft.com/en-us/library/ms181765.aspx)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-25T08:33:42.660

您应该避免使用嵌套选择，我会说您永远不应该在语句的实际选择部分中使用它们。您将为返回的每一行运行该选择。这是一个非常昂贵的操作。而是使用连接。它更具可读性，性能也更好。

在您的情况下，下面的查询应该会有所帮助。请注意，case 语句仍然存在，但现在它是一个简单的比较操作。

```
select
    p.product_id,
    p.type_id,
    p.product_name,
    p.type,
    case p.type_id when 10 then (CONCAT_WS(' ' , first_name, middle_name, last_name )) else (null) end artistC
from
    Product p

    inner join Product_Type pt on
        pt.type_id = p.type_id

    left join Product_ArtistAuthor paa on
        paa.artist_id = p.artist_id
where
    p.product_id = $pid 
```

因为我不知道业务逻辑，所以我使用了左连接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:33:23.263

首先，第一个选择有 6 列，第二个选择有 4 列。也许使两者具有相同数量的列（添加空值？）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-24T21:25:12.260

我最终离开了 SELECT 查询中的公共属性，并稍后在页面中进行了第二个 SELECT 查询。我使用 php IF 命令根据第一个 SELECT 查询调用不同的脚本，这些脚本包含第二个 SELECT 查询。

# sql-server-2008-r2 - 当使用 SSMS 中的 File Shrink 选项来收缩日志时，什么时候将空间释放回 O/S

> ID：14885913
> 
> 赞同：0
> 
> 时间：2013-02-14T23:25:08.527
> 
> 标签：sql-server-2008-r2, sql-server-2008, shrink

我在 SSMS 2008 中缩小了数据库的日志文件：

```
 treeview
           mydatabase (right-click)
                 tasks -> shrink -> files : choose log from dropdown
      (*) reorganize pages before releasing unused space
               shrink file from 6999MB to 417MB

       click OK 
```

当我回去查看时，当前为日志分配的空间是 417.38MB，所以似乎减少了。但我根本没有看到驱动器的可用空间增加。它应该增加了 6GB 以上。释放的空间何时放回 O/S 文件系统？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T02:27:06.883

如果收缩操作成功，则立即释放磁盘空间。文件现在以预期大小显示的事实意味着收缩操作确实成功了。缺少空格有两种选择：

1.  您正在查看错误的驱动器。日志文件可能与数据文件位于不同的驱动器上。
2.  其他东西（例如另一个数据库）迅速占据了新的可用空间。

# java - JmsCorrelationId 用于异步消息发送

> ID：14885917
> 
> 赞同：0
> 
> 时间：2013-02-14T23:25:37.557
> 
> 标签：java, jms

是否有任何 JMSCorrId 应设置的规范。我的应用程序只是将消息异步发送到队列，它并不关心等待任何确认。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T00:01:09.913

当JMS客户端收到回复消息时，可以将新消息的JMSCorrelationID与其发送的消息对应的JMSMessageID进行匹配，从而知道哪条消息收到了回复。

JMSCorrelationID 可以是任何值，而不仅仅是 JMSMessageID。

例如，您可以使用 JMSCorrelationID 来识别发件人。

如果您决定使用自己的 ID，请注意您不应使用 ID: 启动特定于应用程序的 JMSCorrelationID。该前缀是为 JMS 提供程序生成的 ID 保留的。

通常实现：

```
public void onMessage(Message message){
try {
        TextMessage textMessage = (TextMessage)message;
        Queue replyQueue = (Queue)textMessage.getJMSReplyTo();

        Message replyMessage = session.createMessage();
        replyMessage.setJMSCorrelationID(message.getJMSMessageID());
        sender.send(replyQueue, replyMessage);
    } catch (JMSException jmse){jmse.printStackTrace();}
} 
```

# asp.net - 该页面包含过多的服务器重定向

> ID：14885918
> 
> 赞同：1
> 
> 时间：2013-02-14T23:25:37.357
> 
> 标签：asp.net, html, asp.net-mvc

当我从桌面访问它时，我的网站运行良好。但是当我从任何移动设备访问它时，如 android 手机、iphone 和 ipad，它不起作用。它给了我

```
error:The page contains too many server redirects 
```

而且当我从移动设备访问它时，网址会自动更改。

```
it changes to: http://mypage.com/?area=Mobile. 
```

怎么变了！！我没有编写任何可以强制它更改为该 url 的代码。我试过谷歌，但没有找到任何具体的答案......有什么想法吗？

## 编辑

现在问题已经解决了。谢谢大家的评论。有两个帮助类将页面重定向到不存在的移动页面。并因此创建一个无限循环。

# entity-framework - 带有桌面应用程序和本地数据库的短命 DbContext

> ID：14885919
> 
> 赞同：2
> 
> 时间：2013-02-14T23:25:38.493
> 
> 标签：entity-framework, ef-code-first, sql-server-ce, desktop-application

[这个问题的灵感来自我在这里](https://stackoverflow.com/questions/14817102/disposing-disposable-dependencies-with-windows-desktop-applications/)提出的一个较早的问题，我从那个问题中了解到 DbContext 实例应该是短暂的依赖关系。现在鉴于我使用 SQL CE 使用本地数据库开发 LOB 桌面应用程序，我有几个问题：

1.  在我的情况下（本地数据库、单用户、桌面应用程序），DbContext 真的应该存在很短的时间吗？
2.  如果我在每次操作时都处理掉我的 DbContext，那会让我丢失在其生命周期中收集的所有跟踪信息吗？
3.  如果 2 的答案是真的（麻烦！），如何以正确的方式去做，我应该开发一个 UnitOfWork 来保持更改跟踪信息还是什么？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-10-13T09:34:46.497

老问题，但它可能对某人有所帮助。

如[本文](https://social.msdn.microsoft.com/Forums/windowshardware/en-US/ee58c0ec-8899-4b57-bf63-4a2c89d43523/short-lived-dbcontext-in-wpf-application-reasonable?forum=adodotnetentityframework)所述，dbContext 对象的生存取决于它在 Web 或桌面应用程序中使用的天气。

Web应用程序

*   现在，对于 Web 应用程序，每个请求都使用上下文是一种常见且最佳的做法。

*   在 Web 应用程序中，我们处理非常短但
    包含所有服务器事务的请求，因此它们是
    上下文存在的适当持续时间。

桌面应用程序

*   ***对于桌面应用程序，如 Win Forms/WPF 等，上下文用于每个表单/对话框/页面。***

*   由于我们不希望将上下文作为应用程序的单例，因此当我们从一种形式移动到另一种形式时，我们将处理它。

*   通过这种方式，我们将获得很多上下文的能力，并且不会受到长期运行上下文的影响。

基本上，上下文应该是短暂的对象，但始终保持适当的平衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:41:04.580

**1）**是的，短是好的。但是每个用户输入/交互都是极端的

**2)**显然是的。但是除了来自客户端交互的逻辑工作单元之外，丢弃上下文的模式非常适合。例如更改订单。可能是 Header、Items 和 cust 已加载。新地址添加到 cust、Order 标头更改和 SaveChanges。新的逻辑交互从客户端开始。不要忘记你可以有几个较小的上下文。事实上，有界上下文是性能的关键。也许您有 1 个长时间运行的上下文，其中包含系统配置和其他非易失性设置，数量很少但经常访问。我会保持这样的上下文更长时间。

* *3)* *不确定到底是什么问题。但是具有 Commit 方法然后处理上下文的 LUW 类型的 Class 是一种这样的模式。

如果经常重新加载，不要忘记在 DbContexts 上生成视图。

# expression - 等号左边的表达式不是赋值的有效目标

> ID：14885920
> 
> 赞同：0
> 
> 时间：2013-02-14T23:25:36.250
> 
> 标签：expression

```
I= 0.299*C1(:,:,1)+0.587*C1(:,:,2)+0.114*C1(:,:,3);
NumberOfGrayLevels=32;
I' =C ln (I+1);
new=uint8(mat2gray(I')*(NumberOfGrayLevels-1));

[m,n]= size(new);
rgb = zeros(m,n,3);
rgb(:,:,1) = new;
rgb(:,:,2) = rgb(:,:,1);
rgb(:,:,3) = rgb(:,:,1);
new = rgb/255;
imshow(new,[]);

no6=figure;
image(new); 
```

这是图像生成的代码。错误在 I' = 。它表明 + 是错误的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:40:25.550

我假设这是matlab。您在错误的行中缺少运算符：将第三行更改为： I=(C*ln(I+1))';

# sql - 用于计算列条目的 SQL 语句

> ID：14885924
> 
> 赞同：1
> 
> 时间：2013-02-14T23:25:51.670
> 
> 标签：sql, pivot

鉴于以下数据，

```
TEST_SET_1   TEST_1     PASSED

TEST_SET_1   TEST_1     NOT COMPLETED

TEST_SET_1   TEST_1     PASSED

TEST_SET_1   TEST_1     FAILED

TEST_SET_1   TEST_1     FAILED 
```

如何使用 SQL 对其进行格式化以显示如下？

```
TEST SET    TEST      PASSED   FAILED   NOT COMPLETED

TEST_SET_1   TEST_1      2         2           1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:32:27.613

像这样的东西：

```
SELECT
    [TEST SET],
    [TEST],
    SUM(CASE WHEN [state]='PASSED' THEN 1 ELSE 0 END) AS PASSED,
    SUM(CASE WHEN [state]='FAILED' THEN 1 ELSE 0 END) AS FAILED,
    SUM(CASE WHEN [state]='NOT COMPLETED' THEN 1 ELSE 0 END) AS [NOT COMPLETED]
FROM
    table
GROUP BY
    [TEST SET],
    [TEST] 
```

或者，如果您想使用`PIVOT`并使用 MSSQL 2005+。然后你可以这样做：

```
SELECT
    *
FROM
(
    SELECT
        [TEST SET],
        [TEST],
        [state],
        1 AS StaticNbr
    FROM
        table
) AS SorceTable
PIVOT
(
    SUM(StaticNbr)
    FOR [state] IN ([PASSED], [FAILED], [NOT COMPLETED])
) AS pvt 
```

# msbuild - 使用 MSBuild 扩展包启动 Windows 服务时的权限问题

> ID：14885928
> 
> 赞同：2
> 
> 时间：2013-02-14T23:26:16.667
> 
> 标签：msbuild, windows-services, user-permissions

我有一个 MSBuild 项目文件来部署 Windows 服务。

在复制文件后尝试启动服务时，该命令返回以下错误：

```
error : Start Service failed with return code '[2] AccessDenied' 
```

我使用以下方法来实现这一点，但都返回相同的错误：

1.  MSBuild 服务控制器
2.  MSBuild.ExtensionPack.Computer.WindowsService Exec Command="net
3.  开始 $(WindowsServiceName)"

谢谢。

# coffeescript - 我可以在咖啡控制台启动之前将功能附加到它吗？

> ID：14885930
> 
> 赞同：2
> 
> 时间：2013-02-14T23:26:26.327
> 
> 标签：coffeescript

假设我想要一个`pp`功能：

```
coffee> pp = (obj) -> JSON.stringify(obj)                      
[Function]                                                     
coffee> pp({cat: "fancy"})                                     
'{"cat":"fancy"}'                                              
coffee> 
```

有没有办法让我在控制台加载时立即使用该功能？我正在查看`coffee -r "utils.coffee"`，但没有看到任何方法可以将所需的库放入命令行中可用的对象中。看起来我可以改变`repl.js`，但这似乎是个坏主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:37:21.970

您可以将这些函数放入`global`变量中（这是 Node 的版本`window`），然后使用该`-r`选项。

```
# utils.coffee
global.pp = (obj) -> JSON.stringify(obj) 
```

然后运行，同样直接 utils.coffee 的：

```
coffee -r ./utils 
```

它应该启动一个 CoffeeScript REPL 并具有`pp`可用作全局变量的函数：

```
coffee> pp ohmy: 'neat'
'{"ohmy":"neat"}' 
```

**更新**：似乎`-r`命令行选项[已在 CoffeeScript 的 master 中删除](https://github.com/jashkenas/coffee-script/commit/33140259b85dc52a4dad3b89f171db9a0917ef4d)。它可能不应该以这种方式使用:(

**更新 2**：还有另一种方法可以做到这一点！而且它不依赖于任何特定于命令的参数：

```
{ echo "require './utils'"; cat; } | coffee 
```

但是，它不会像 Coffee REPL 那样 100% 工作。例如，箭头键似乎不起作用。

**编辑（jc）**：使用此方法可以为节点进行卸载，这很方便：

```
# utils.coffee
global.unload = (moduleName) -> 
  cacheName = require.resolve(moduleName)
  delete require.cache[cacheName]

$ coffee -r ~/Dev/utils.coffee    
coffee> unload                             
[Function] 
```

**更新 3**：另一种可能性是“创建自己的 REPL”。并没有真正重新实现任何东西。基于[这个 hacky 解决方案](https://stackoverflow.com/a/12813186/581845)，您可以执行以下操作：

```
#! /usr/bin/env coffee

# REPL functions.
global.pp = (obj) -> JSON.stringify(obj)

# Start the REPL.
require 'coffee-script/lib/coffee-script/repl' 
```

然后将该脚本用作您的新 REPL。它将像普通的 Coffee REPL 一样工作，加上新功能（箭头键和 TAB 完成都没有问题 :)

顺便说一句，我认为您需要安装 CoffeeScript 而没有启用该`-g`选项的选项`npm`。

这是一个非常hacky的解决方案。它依赖于内部的 CoffeeScript 实现文件结构及其功能，并且随时可能改变（事实上，我知道在基于 Node 的新改版的 Coffee REPL 中已经完成了一些工作......我希望该功能被公开以编程方式使用，因此这些黑客不再是黑客）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-02T21:03:57.677

看看@Daniel's (Daniel Taylor's) 的优秀`nesh`，一个增强的节点外壳，也说 CoffeeScript：[http ://danielgtaylor.github.io/nesh/](http://danielgtaylor.github.io/nesh/)

以下是将`pp`函数加载到 CoffeeScript REPL 中的方法：

```
nesh -c -e 'pp = (obj) -> JSON.stringify(obj)' 
```

同样，如果您想`~/.nesh_profile.coffee`在启动时加载文件（类似于加载 shell 配置文件），请使用：

```
nesh -c -e ~/.nesh_profile.coffee 
```

小警告：*REPL 语言 - JavaScript v. CoffeeScript - 和您正在加载的代码的语言必须相同*。**编辑**：唯一的例外是您始终可以通过扩展名为的*文件*`.js`加载 JavaScript ，即使在启动 CoffeeScript REPL 时也是如此。（相比之下，您不能在启动 CoffeeScript REPL 时指定 JS*字符串）。*

要将“nesh 配置文件”自动加载到 CoffeeScript REPL 中，您可以在 shell 配置文件中定义一个别名；例如：

```
alias neshc='nesh -c -e ~/.nesh_profile.coffee' 
```

更新：以下是您如何使用与*JavaScript* REPL 完全相同的“nesh 配置文件”；[使用进程替换](http://tldp.org/LDP/abs/html/process-sub.html)即时执行 JavaScript 编译：

```
alias neshj='nesh -e <(coffee -bp ~/.nesh_profile.coffee)' 
```

`nesh`以`npm`包的形式提供，因此您可以按如下方式轻松安装它：

```
sudo npm install nesh -g 
```

# c# - Bitmap.GetPixel() 返回错误值

> ID：14885933
> 
> 赞同：4
> 
> 时间：2013-02-14T23:26:32.223
> 
> 标签：c#, graphics, bitmap

我在从正在生成的位图中读回像素值时遇到了一些问题。我首先使用以下代码在我的类中生成一个名为 maskBitmap 的位图：

```
 void generateMaskBitmap()
    {
        if (inputBitmap != null)
        {
            Bitmap tempBitmap = new Bitmap(inputBitmap.Width, inputBitmap.Height, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
            using (Graphics g = Graphics.FromImage(tempBitmap))
            {
                Brush brush = Brushes.Black;
                for (int y = 0; y < tempBitmap.Height; y += circleSpacing)
                {
                    for (int x = 0; x < tempBitmap.Width; x += circleSpacing)
                    {
                        g.FillEllipse(brush, x, y, circleDiameter, circleDiameter);
                    }
                }
                g.Flush();
            }

            maskBitmap = (Bitmap)tempBitmap.Clone();
        }
    } 
```

然后我尝试使用以下代码将蒙版应用于我的原始图像：

```
 void generateOutputBitmap()
    {
        if (inputBitmap != null && maskBitmap != null)
        {
            Bitmap tempBitmap = new Bitmap(inputBitmap.Width, inputBitmap.Height);
            for (int y = 0; y < tempBitmap.Height; y++)
            {
                for (int x = 0; x < tempBitmap.Width; x++)
                {
                    Color tempColor = maskBitmap.GetPixel(x, y);

                    if (tempColor == Color.Black)
                    {
                        tempBitmap.SetPixel(x, y, inputBitmap.GetPixel(x, y));
                    }
                    else
                    {
                        tempBitmap.SetPixel(x, y, Color.White);
                    }
                }
            }
            outputBitmap = tempBitmap;
        }
    } 
```

掩码位图已成功生成并在图片框中可见，但是测试“ `tempColor`”时每个像素的颜色值显示为空（A = 0，R = 0，G = 0，B = 0）。我知道 getpixel/setpixel 的性能问题，但这不是这个项目的问题。我也知道这`"tempColor == Color.Black"`不是一个有效的测试，但这只是我的比较代码的占位符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:59:30.207

我无法重现您的问题。我复制并粘贴了您的代码并进行了一些修改以使其适合我。我可以确认`tempColor`有时是#FF000000。

我怀疑您在某处混淆了位图引用。你*真的*确定除了#00000000 之外你*没有*得到任何价值吗？你`circleDiameter`和`circleSpacing`有合理的价值观吗？最重要的是：您绝对确定您正在从正确的位图中读取吗？

这是我的代码版本，我知道它有效：

```
using System;
using System.Drawing;

namespace Test
{
    class Program
    {
        static void Main()
        {
            var bitmap = GenerateMaskBitmap(100, 100);
            TestMaskBitmap(bitmap);
        }

        const int CircleDiameter = 10;
        const int CircleSpacing = 10;

        static Bitmap GenerateMaskBitmap(int width, int height)
        {
            Bitmap maskBitmap = new Bitmap(width, height, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
            using (Graphics g = Graphics.FromImage(maskBitmap))
            {
                Brush brush = Brushes.Black;
                for (int y = 0; y < maskBitmap.Height; y += CircleSpacing)
                {
                    for (int x = 0; x < maskBitmap.Width; x += CircleSpacing)
                    {
                        g.FillEllipse(brush, x, y, CircleDiameter, CircleDiameter);
                    }
                }
                g.Flush();
            }

            return maskBitmap;
        }

        static void TestMaskBitmap(Bitmap maskBitmap)
        {
            for (int y = 0; y < maskBitmap.Height; y++)
            {
                for (int x = 0; x < maskBitmap.Width; x++)
                {
                    Color tempColor = maskBitmap.GetPixel(x, y);

                    if (tempColor.ToArgb() != 0)
                        throw new Exception("It works!");
                }
            }
        }
    }
} 
```

# php - Paypal 与 Zend 框架的集成

> ID：14885939
> 
> 赞同：0
> 
> 时间：2013-02-14T23:26:56.047
> 
> 标签：php, zend-framework, paypal

我想知道如何将 PayPal 与 Zend 框架集成？

我将使用大约 5-15（+10 个可选）产品构建一个小的应用内市场，我将在数据库中存储这些产品的信息。

但是我希望用户看到有关产品的信息，当他单击“购买”按钮输入数量然后直接重定向到 PayPal 时（我知道这是一个常规过程，我可以用普通的 PHP 代码实现它）我正在考虑使用html方式，但我知道它不够安全（因为用户可以使用开发人员控制台或任何其他方式修改HTML。）所以我的实际问题是：

如何将数据发送到我自己的控制器，该控制器获取用户填写的数量和项目代码，并生成所有信息以提供给 PayPal 以供进一步处理？

PS：请不要投票，我是采埃孚的新手信息：采埃孚 1.12

# java - 在jsp中上传jquery图片

> ID：14885943
> 
> 赞同：0
> 
> 时间：2013-02-14T23:27:19.750
> 
> 标签：java, jquery, file-upload

我正在寻找从客户端上传的图片。所以我尝试了下面的教程，它在 Firefox 和 Chrome 上的效果非常好。

[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

但它不适用于 IE9，因为它不支持 API。非常痛苦的浏览器:'(

所以我寻找其他插件，我发现了以下网站：

[https://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)

但他们提到它适用于Java，但我不知道如何实现它，因为他用php编写了代码，我不需要。如果有人帮助我如何使用Java实现那个插件。我需要任何可以帮助我的解决方案，请帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:38:58.663

该网站声明它`Works with any server-side platform that supports standard HTML form file uploads`。在 Java 中，这通常使用[Commons Fileupload](http://commons.apache.org/fileupload/)来解决，这是一个文档齐全且相当易于使用的库。

编辑：实际上，使用 Commons FileUpload 的非常详细的概述以及 Servlet 3.0 的内置文件上传支持可以[在 SO 上找到](https://stackoverflow.com/questions/2422468/how-to-upload-files-to-server-using-jsp-servlet)

# .net - 新的 .NET 2.0 C++/CLI 项目隐含依赖于 mscorlib v4？

> ID：14885944
> 
> 赞同：6
> 
> 时间：2013-02-14T23:27:32.667
> 
> 标签：.net, visual-studio-2012, interop, c++-cli, .net-framework-version

我在 Visual Studio 2012 中创建了一个新的 C++/CLI 项目，在项目创建页面上选择了 .NET 2.0 作为框架。我已验证“外部依赖项”（mscorlib.dll、System.Data.dll、System.dll 和 System.XML.dll）将“路径”显示为`c:\Windows\Microsoft.NET\Framework\v2.0.50727\*`.

在同一解决方案中从 C# .NET 2.0 项目添加对此项目的引用时，编译器在构建时无法链接到我的 C++ 库，并出现以下错误：

> 警告 2 无法解析主要引用“D:\GIT\EasyBCD\Release\Win32Interop.dll”，因为它间接依赖于 .NET Framework 程序集“mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken= b77a5c561934e089”，其版本“4.0.0.0”高于当前目标框架中的“2.0.0.0”版本。C:\Windows\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.Targets 1578

但是，就像我说的那样，“Win32Interop”项目中的引用清楚地表明使用了 v2.0，并且项目文件本身包含`<TargetFrameworkVersion>v2.0</TargetFrameworkVersion>`它应该包含的内容。

为什么 Visual Studio 2012 给我带来如此困难？

编辑

谜团加深。尝试在 C++/CLI 项目中删除所有然后重新添加 .NET 引用时，显示如下：

![添加新的依赖](../Images/eb8f3a5f62e09e864fa3017024bcb4ea.png)

如您所见，顶部显示“目标：.NET Framework 2.0”，“版本”列表示我选择的是“2.0.0.0”版本。

但是，单击“确定”后，参考列表如下所示：

![.NET 依赖项列表](../Images/f3df8f2f5a6c2aa20c396994c612783b.png)

目标框架仍然是“.NETFramework,Version=v2.0”，但每个引用都表明正在使用版本“4.0.0.0”（以及该文件版本的公钥标记）。

然而，选择每个参考时的属性对话框绝对保持 v2.0 文件正在被使用。相信谁？该怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T09:38:34.483

似乎不支持创建 .NET 2.0 CLR 项目。这是 Microsoft Connect 上的链接：

[https://connect.microsoft.com/VisualStudio/feedback/details/780602/compiling-c-clr-dll-in-vs-2012-targeting-net-2-0-introduces-indirect-dependency-on-net- 4-0#标签](https://connect.microsoft.com/VisualStudio/feedback/details/780602/compiling-c-clr-dll-in-vs-2012-targeting-net-2-0-introduces-indirect-dependency-on-net-4-0#tabs)

# windows - 如何使用 Powershell 清除“应用程序和服务日志”？

> ID：14885945
> 
> 赞同：2
> 
> 时间：2013-02-14T23:27:43.537
> 
> 标签：windows, powershell, event-log

有人知道如何使用 Powershell 清除“应用程序和服务日志”吗？我可以使用 Clear-EventLog 轻松清除 Windows 日志，但无法清除 Windows 事件日志中“应用程序和服务日志”下的子文件夹。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:37:18.160

这看起来像你需要的

[http://gallery.technet.microsoft.com/scriptcenter/4502522b-5294-4c31-8c49-0c9e94db8df9](http://gallery.technet.microsoft.com/scriptcenter/4502522b-5294-4c31-8c49-0c9e94db8df9)

更新 - 该链接有一个登录名。这是其中的脚本-

```
Function Global:Clear-Winevent ( $Logname ) { 
<# 

.SYNOPSIS  
Given a specific Logname from the GET-WINEVENT Commandlet 
it will clear the Contents of that log 

.DESCRIPTION  
Cmdlet used to clear the Windows Event logs from Windows 7 
Windows Vista, Server 2008 and Server 2008 R2 

.EXAMPLE  
CLEAR-WINEVENT -Logname Setup 

.EXAMPLE  
GET-WINEVENT -Listlog * | CLEAR-WINEVENT -Logname $_.Logname 

Clear all Windows Event Logs 

.NOTES  
This is a Cmdlet that is not presently in Powershell 2.0 
although there IS a GET-WINEVENT Command to list the 
Contents of the logs.  You can utilize this instead of 
WEVTUTIL.EXE to clear out Logs.  Special thanks to Shay Levy 
(@shaylevy on Twitter) for pointing out the needed code 

#> 

[System.Diagnostics.Eventing.Reader.EventLogSession]::GlobalSession.ClearLog("$Logname") 

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-19T05:14:34.893

PowerShell - 针对性能进行了优化：

**版本 1：**

```
function Clear-EventLogs-Active
{
    ForEach ( $l in ( Get-WinEvent ).LogName | Sort | Get-Unique )
    {
        [System.Diagnostics.Eventing.Reader.EventLogSession]::GlobalSession.ClearLog("$l")
    }
    Clear-EventLog -LogName "System"
} 
```

.

版本 2：

```
function Clear-EventLogs-All
{
    ForEach ( $l in Get-WinEvent -ListLog * -Force )
    {
        if ( $l.RecordCount -gt 0 )
        {
            $ln = $l.LogName
            [System.Diagnostics.Eventing.Reader.EventLogSession]::GlobalSession.ClearLog("$ln")
        }
    }
    Clear-EventLog -LogName "System"
} 
```

.

两个版本都适用于 514 日志：

*   版本 1（0.3007762 秒）- 仅检索包含事件的日志

*   版本 2（0.7026473 秒）- 检索所有日志，并且只清除有事件的日志

# matlab - Matlab中if语句中值的误差范围？

> ID：14885947
> 
> 赞同：1
> 
> 时间：2013-02-14T23:27:51.327
> 
> 标签：matlab, loops, error-handling, margins

我有一个简单的 for 循环：

```
for n=0:0.001:100
  if x<100
    do something
  end
end 
```

然而，由于代码的复杂性，x 的最终值约为 100.345，因此循环中断。

我想应用一个误差范围，`if x<100 ± 0.4`以便语句为真并且循环重新启动。

这怎么可能 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:33:12.760

使用逻辑和 ( `&&`) 运算符创建一个范围。只有当两个语句都为真时，才会执行条件代码。

```
e = 0.4;    
v = 100;
if x<v+e && x>v-e
    do something
end 
```

您可以根据需要`n=0`在条件代码中设置以重新启动循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T04:16:41.110

检查两个浮点数是否在彼此的某个容差范围内的标准方法是计算绝对差，然后将其与容差进行比较。在您的情况下，它看起来像这样：

```
expected = 100;
tolerance = 0.4;
if abs(x - expected) < tolerance
    % do something
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T09:08:03.273

我很惊讶没有人提到这一点，但如果你想添加一个误差范围，你只需要在一个方向上做。

这是因为您只检查 x 是否小于比较值。因此，您可以简单地这样做：

```
for n=0:0.001:100
  if x<100+0.4
    % do something
  end
end 
```

当然你也可以只使用`x<100.4`

# php - 按下后退按钮时未发送变量

> ID：14885949
> 
> 赞同：0
> 
> 时间：2013-02-14T23:27:53.610
> 
> 标签：php, javascript, jquery, html, variables

我有一个在一组复选框上运行的 javascript 来过滤通过 PHP 显示的一些项目。

当某人过滤信息然后单击一个项目时，他会被定向到该项目的描述。我的问题是当该用户单击浏览器中的“返回”按钮时，因为我的过滤已经消失了。

发生这种情况是因为我的脚本加载了 .php 但仅在 DIV 内（因此我不需要重新加载整个页面）。这意味着我发送的变量只是在 DIV 级别而不是在 URL 级别加载，因此当它们转到特定产品的描述然后返回时，这些变量不再存在并且过滤消失了。

这是我的 JS：

```
$(function() {
    $("input[type='checkbox']").on('change', function() {
        var boxes = [];
        // You could save a little time and space by doing this:
        var name = this.name;
        // critical change on next line
        $("input[type='checkbox'][name='"+this.name+"']:checked").each(function() {
            boxes.push(this.value);
        });
        if (boxes.length) {
            $(".loadingItems").fadeIn(300);
            // Change the name here as well
            $(".indexMain").load('indexMain.php?categ=<?php echo $category; ?>&'+this.name+'=' + boxes.join("+"),
            function() {
                $(".indexMain").fadeIn('slow');
                $(".loadingItems").fadeOut(300);
            });

        } else {
            $(".loadingItems").fadeIn(300);
            $(".indexMain").load('indexMain.php?categ=<?php echo $category; ?>', function() {
                $(".indexMain").fadeIn('slow');
                $(".loadingItems").fadeOut(300);
            });
        }
    });
}); 
```

有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:32:42.457

在新窗口中打开项目描述，或者（更优雅地）在模式对话框中打开项目描述（例如使用[jQuery UI 对话框](http://jqueryui.com/dialog/)）。

# sql - xml 路径的混合元素和 SQL

> ID：14885952
> 
> 赞同：0
> 
> 时间：2013-02-14T23:28:08.467
> 
> 标签：sql, xml, path

我有一个为我们数据库中的一堆实体生成 xml 的存储过程；不是我写的，写的那个人已经回家了，所以我被困住了，需要帮助。

它生成的 xml 如下所示：

```
<Updates>
   <Update>....stuff....</Update>
   <Update>....stuff....</Update>
   <Update>....stuff....</Update>
   <Update>....stuff....</Update>
</Updates> 
```

我需要它看起来像这样：

```
<Updates>
   <CommentUpdate>....stuff....</CommentUpdate>
   <AttachmentUpdate>....stuff....</AttachmentUpdate>
   <CommentUpdate>....stuff....</CommentUpdate>
   <OtherTypeOfUpdate>....stuff....</OtherTypeOfUpdate>
</Updates> 
```

取决于特定列的值。目前，生成此 xml 的存储过程的部分是这样的：

```
 (select 
    u.ID as '@ID',
    u.CreatedDate as '@CreatedDate',
    (select * 
    from dbo.fsn_GetUserRef(u.CreatedBy, 
          case when @RetDepth = 'COMPLETE' 
           THEN 'FULL' 
           ELSE '' END) CreatedBy
    for xml auto, type),
    u.Type as 'Type',
    u.Text as 'Text',
    u.DocumentId as 'DocumentId'    
   from fusion_Updates u
   where u.atom_id=atom.ID
   for xml path('Update'), root('Updates'), type), 
```

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:30:34.040

[Sql XML Path with different children](https://stackoverflow.com/a/3246587/864341)问题的答案包含一个适合您的解决方案。

我不完全理解您指定的查询返回的数据结构。因此，我将给您一个结构更简单的示例，您应该能够对其进行调整以满足您的需求。

假设您有一个`UpdateEvent`表，其中包含 、 和 列，`UpdateEventKey`以下查询将为您提供所需的内容。`EventDateTime``UpdateType`

请注意，该表被使用了两次，在外部选择中生成记录节点中的变量标签名称，并在子选择中生成字段节点。此外，`PATH('')`用于省略记录节点（因为这已经在外部选择中生成）。

```
CREATE TABLE UpdateEvent (
        UpdateEventKey INT,
        EventDateTime DATETIME,
        UpdateType VARCHAR(50)
        );
INSERT INTO UpdateEvent (UpdateEventKey, EventDateTime, UpdateType)
        VALUES (1, GETDATE(), 'Comment');
INSERT INTO UpdateEvent (UpdateEventKey, EventDateTime, UpdateType)
        VALUES (2, GETDATE() + (1 / 1440.0), 'Attachment');
INSERT INTO UpdateEvent (UpdateEventKey, EventDateTime, UpdateType)
        VALUES (3, GETDATE() + (2 / 1440.0), 'Comment');
INSERT INTO UpdateEvent (UpdateEventKey, EventDateTime, UpdateType)
        VALUES (4, GETDATE() + (3 / 1440.0), 'OtherTypeOf');

SELECT CAST('<' + U1.UpdateType + 'Update>'
        + (SELECT * FROM UpdateEvent AS U2
                    WHERE U2.UpdateEventKey = U1.UpdateEventKey FOR XML PATH(''))
        + '</' + U1.UpdateType + 'Update>' AS XML)
        FROM UpdateEvent AS U1 FOR XML PATH(''), ROOT('Updates'), TYPE; 
```

这会生成以下 XML。

```
<Updates>
    <CommentUpdate>
        <UpdateEventKey>1</UpdateEventKey>
        <EventDateTime>2013-02-14T20:32:41.803</EventDateTime>
        <UpdateType>Comment</UpdateType>
    </CommentUpdate>
    <AttachmentUpdate>
        <UpdateEventKey>2</UpdateEventKey>
        <EventDateTime>2013-02-14T20:33:41.767</EventDateTime>
        <UpdateType>Attachment</UpdateType>
    </AttachmentUpdate>
    <CommentUpdate>
        <UpdateEventKey>3</UpdateEventKey>
        <EventDateTime>2013-02-14T20:34:41.727</EventDateTime>
        <UpdateType>Comment</UpdateType>
    </CommentUpdate>
    <OtherTypeOfUpdate>
        <UpdateEventKey>4</UpdateEventKey>
        <EventDateTime>2013-02-14T20:35:41.777</EventDateTime>
        <UpdateType>OtherTypeOf</UpdateType>
    </OtherTypeOfUpdate>
</Updates> 
```

# scala - Scala：映射字符串时类型推断错误？

> ID：14885956
> 
> 赞同：1
> 
> 时间：2013-02-14T23:28:40.403
> 
> 标签：scala, type-inference

我正在尝试在 Scala 中编译简单的 helloworld，并得到错误“scala: value capitalize is not a member of Char” 为什么编译器认为 newW 是 Char？

```
val dict = Map(
    "hello" -> "olleh",
    "world" -> "dlrow"
  )

def translate(input: String): String = {
  input.split( """\s+""").map(w => dict.getOrElse(w.toLowerCase, w).map(newW => 
    (if (w(0).isUpper) newW.capitalize else newW))
  ).mkString(" ")
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:47:54.033

这是正在发生的事情：

```
input // is a string
.split( """\s+""") // is an Array[String]
.map(w => // w is a String, for each String in the Array[String]
  dict.getOrElse(w.toLowerCase, w) // is a String (returned by dict.getOrElse)
  .map(newW => // is a Char, for each Char in the String returned by dict.getOrElse 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:51:12.137

`map`对in的第二个调用`translate`是跨从 的返回值进行映射`dict.getOrElse(...)`，其类型为`String`，可以隐式处理为`Iterable[Char]`。因此，当您尝试调用它时，编译器会正确推断出它`newW`的类型并抱怨。你可能正在寻找类似的东西`Char``capitalize`

```
def translate(input: String): String = {
  input.split( """\s+""").map(w => {
    val newW = dict.getOrElse(w.toLowerCase, w)
    (if (w(0).isUpper) newW.capitalize else newW)
  }).mkString(" ")
} 
```

**更新：**顺便说一句，如果`input`是一个空字符串，它将在运行时失败 - 它至少需要再次检查安全性。

# delphi - Delphi：在 TCoolBar 中设置样式的 TMainMenu 和 TToolBar

> ID：14885963
> 
> 赞同：5
> 
> 时间：2013-02-14T23:29:29.603
> 
> 标签：delphi, toolbar, vcl, menubar

我正在尝试在 Delphi XE3 中创建一个应用程序菜单和工具栏，如下所示（来自我拥有的程序）：

![TCoolBar 中的主菜单和工具栏](../Images/e98b598b0c2e6febc87126bc2cdf4ded.png)

我可以通过执行以下操作来复制这种外观的一部分：

1.  创建一个新的 VCL Forms 应用程序
2.  为文件/编辑/等添加`TMainMenu`和插入模板菜单。
3.  `TCoolBar`在表单中添加一个
4.  添加一个`TToolBar`到`TCoolBar`
5.  `TToolButton`为`TToolBar`每个文件/编辑/等添加一个。并选择 Group 属性
6.  从表单中删除 Menu 属性（因此不显示程序菜单）
7.  将每个的 MenuItem 属性分配`TToolButton`给相应的文件/编辑/等。
8.  `TToolBar`在`TCoolBar`第一个下方添加第二个

这是它的样子：

![我在 TCoolBar 中的主菜单和工具栏](../Images/d980fd797269b669902a2d58f2a7dd83.png)

它有点相似，但仍然缺少所有样式元素来修改新应用程序菜单的外观。

我的问题是，有谁知道如何获得类似的外观，也许是使用第三方组件库？最初的开发人员似乎使用了第三方 VCL 库。除了样式菜单和`TCoolBar`.

我已经尝试过 Raize 组件、TMS 高级工具栏和菜单，并且正在尝试 DevExpress VCL 组件。他们似乎都没有提供解决方案，但也许我对他们还不够熟悉，还没有弄清楚。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T00:05:41.103

Delphi 附带了一个演示，它可以向您展示如何使用(and )[`ActionBands`](http://docwiki.embarcadero.com/CodeExamples/XE3/en/VCL.ActionBands_Sample)为您的菜单“开箱即用”地获得这种外观。只需将菜单更改为演示中的：[`TActionMainMenuBar`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ActnMenus.TActionMainMenuBar)[`TActionToolBar`](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.ActnCtrls.TActionToolBar)`Style``XP Style`

![ActionBands 演示](../Images/882ff16f223f6761d5220d8938203bf9.png)

您的其余步骤似乎非常完整。有关菜单项和工具栏按钮上的图像，请参阅演示中与菜单和工具栏上的`ImageList`相关组件的使用。`TActions`

# android - phonegap 有一个主要的 webview 对象吗？

> ID：14885967
> 
> 赞同：0
> 
> 时间：2013-02-14T23:29:53.387
> 
> 标签：android, ios, cordova, mobile

在 phonegap 项目中，我们可以添加多个 webview，分别加载 html、css 和 javascript。

例如，webview1 将加载 first.html 文件，而 webview2 可以加载 second.html。

此外，如果我这样做将有助于提高应用程序的性能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:33:27.273

您只需要一个 WebView - 在那里您可以加载不同的 html 文件，但这绝对不会提高性能。

为了获得更好的性能，您可以压缩 js 和 css 文件。

# php - jQuery关于提交问题

> ID：14885972
> 
> 赞同：0
> 
> 时间：2013-02-14T23:30:23.237
> 
> 标签：php, jquery

由于某种原因，我的提交事件不起作用，但是，如果我将其更改为单击表单，它会起作用，这是我的代码：

**查询：**

```
 <script>
(function(){
        $('form').on('click',function(){

                $.post("../includes/register.php",  $('form').serialize(),
                function(data){
                    $('body').append(data);                 
                });
        });
    })();
</script> 
```

**注册.PHP：**

```
<?php 

if(isset($_POST['username'])){
echo $_POST['username'];
}
?> 
```

这工作得很好，每当我点击表单文本输入时，它都会附加用户名，但是，当我尝试使用提交方法时，它不会输出任何内容：

```
<script>
(function(){
        $('form').submit(function(){

                $.post("../includes/register.php",   $('form').serialize(),
                function(data){
                    $('body').append(data);                 
                });
        });
    })();
</script> 
```

事实上，当我使用 button.on('click') 时它甚至都不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:41:18.610

您正在使用立即调用的函数而不是文档就绪处理程序，您还应该阻止事件的默认操作，请尝试以下操作：

```
$(function(){
    $('form').on('submit',function(event){
        event.preventDefault();
        $.post("../includes/register.php",  $(this).serialize(),
        function(data){
            $('body').append(data);                 
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:35:14.510

默认情况下，表单将提交到表单的操作。您需要防止这种情况发生。您正在通过 ajax 等待服务器响应，因此您很可能永远不会在默认操作发生之前看到您的回调执行。

```
$('form').submit(function(e){
            e.preventDefault(); // put this first
            $.post("../includes/register.php",   $('form').serialize(),
            function(data){
                $('body').append(data);                 
            });
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T23:36:17.217

这是现在的猜测，因为我不知道您的 HTML 代码是什么样的。

但是在提交时表单将被提交，并且任何活动的 ajax 请求都将被取消。尝试类似的东西

```
<script>
(function(){
   $('form').submit(function(){    
     $.post("../includes/register.php",   $('form').serialize(),
       function(data){
         $('body').append(data);                 
     });
     return false;
   });
  })();
</script> 
```

这将停止提交事件，您应该让发布事件发生。虽然它实际上不会提交表单。因此，您必须手动执行此操作。

# r - 使用 gWidgets 在 R 中加载和保存变量

> ID：14885973
> 
> 赞同：2
> 
> 时间：2013-02-14T23:30:25.813
> 
> 标签：r, user-interface, load, save, gwidgets

在过去的几个月里，我一直在 RI 中构建一个模拟，希望能够打包。它由两个可用函数和许多内部函数组成，两个可用函数之一在循环时调用这些函数来执行模拟阶段。

一个简单的概念示例是：

```
# Abstract representation 1st Usable function, generates object containing settings for simulation.
settings <- function(){
  matrix(c(1:4),nrow=2,ncol=2)
}

# Abstract representation of one of many internal functions, does some action in simulation.
int.func <- function(x){
  out <- x*2
  return(out) 
}

# Abstract representation of second usable function, takes settings & invokes internal functions generates results & saves as R object files.
sim.func <- function(x){
  ans <- int.func(x)
  ans2 <- ans-2
  save(ans2, file="outtest")
} 
```

到目前为止，使用我的包，在使用 library() 加载和附加包后使用它：

```
INPUT <- settings()
fix(settings) # If you want to change from the defaults.
sim.func(INPUT) 
```

没有什么需要从模拟函数返回，因为结果和数据转储被保存为一个带有`save()`命令的对象，然后可以读取这些对象。

现在我希望它有一个可以与命令行结合使用的简单 GUI——想想 Rcmdr 但更简单，让我从未接触过 R 的同事使用它。gui 需要能够编辑设置 - 就像上面的修复命令一样，将设置对象保存到文件，并从对象文件中读取设置。我用 gWidgets 构建了这个：

```
gui <- function(){
  INPUT <- matrix(c(1:4),nrow=2,ncol=2)

  mainwin <- gwindow("MainWindow")

  button1 <- gbutton("Edit Settings", cont=mainwin, handler=
                       function(h,...){
                         fix(INPUT)
                         print("Settings Edited")
                       })

  button2 <- gbutton("RUN", cont=mainwin, handler=
                       function(h,...){
                         sim.func(INPUT)
                         print("The run is done")
                       })

  savebutton <- gbutton("Write Settings to File",cont=mainwin, handler=
                          function(h,...){
                            setfilename <- ginput("Please enter the filename")
                            save(INPUT, file=setfilename)
                          })

  loadutton <- gbutton("Load Settings from File", cont=mainwin,
                   handler=function(h,...){
                     fname <- gfile(test="Choose a file", 
                                    type="open", 
                                    action="print",
                                    handler = 
                                      function(h,...){
                                        do.call(h$action, list(h$file))
                                      }
                     )
                     load(fname)})
} 
```

请注意，`settings`之前函数的工作现在在这个 gui 函数的第一行完成。我将它添加到与上述三个函数相同的 R 文件中，`gui`作为导出添加到命名空间，将 gWidgets 和 gWidgetstcltk 设置为导入，然后重新构建，然后`library()`打包并执行`gui()`.

界面出现。但是我有一些问题： gui 显示正常，但是如果我单击 button1（“编辑设置”）通过修复（输入）编辑设置，更改值，关闭编辑器并再次单击按钮以查看更改是否已经持久化并存储在 INPUT 中，但它们没有。读取对象也是如此，它不会覆盖函数 gui() 第一行默认生成的 INPUT 对象。

我认为这与功能环境有关，但我不太确定。在我的包的无 gui 版本中，用户生成包含设置的对象，该对象位于工作区中，并将其作为参数提供给模拟函数。但是，由于使用 gui 版本，所有内容都在函数 gui() 中运行，并且 gWidgets 处理程序使用函数(h,...) 我不禁觉得环境是这里的问题。奇怪的是，当单击按钮 1 时，它会从 gui() 环境中找到 INPUT，但不会在此处进行更改。

有人可以帮忙解决这个问题并建议我需要做什么吗？

很抱歉问了一个很长的问题，但我试图解释清楚。代码是可重现的，这也是问题所在，只需拥有 library(gWidgets, gWidgetstcltk) 并复制和粘贴我在此处提供的代码，以定义函数然后运行`gui()`​​. 然后单击“编辑设置”按钮，更改单元格，退出，然后再次单击按钮以查看更改是否仍然存在（它们没有）。我提供的抽象示例忠实地再现了我在使用适当的模拟功能时遇到的相同问题，所以如果我不能让它工作，我就不会让真实的东西工作。

谢谢，

本·W。

UEA

塞恩斯伯里实验室。

[编辑] 这是使用 .GlobalEnv 的修复/解决方法：

```
gui <- function(){
  INPUT <- matrix(c(1:4),nrow=2,ncol=2)
  .GlobalEnv$INPUT <- INPUT
  mainwin <- gwindow("MainWindow")
  button1 <- gbutton("Set", cont=mainwin, handler=
                       function(h,...){
                         INPUT <- .GlobalEnv$INPUT
                         fix(INPUT)
                         print("Settings have been edited...")
                       })
  button2 <- gbutton("RUN", cont=mainwin, handler=
                       function(h,...){
                         sim.func(.GlobalEnv$INPUT)
                         print("The run is done")
                       })
  writebutton <- gbutton("Write Settings to File",cont=mainwin, handler=
                          function(h,...){
                            setfilename <- ginput("Please enter the filename")
                            INPUT <- .GlobalEnv$INPUT
                            save(INPUT, file=setfilename)
                          })

  loadutton <- gbutton("Load Settings from File", cont=mainwin,
                   handler=function(h,...){
                     fname <- gfile(test="Choose a file", 
                                    type="open", 
                                    action="print",
                                    handler = 
                                      function(h,...){
                                        do.call(h$action, list(h$file))
                                      }
                     )
                     load(fname)
                     .GlobalEnv$INPUT <- INPUT})
} 
```

# sql - Cast int to SmallDateTime

> ID：14885984
> 
> 赞同：0
> 
> 时间：2013-02-14T23:32:12.590
> 
> 标签：sql, sql-server, tsql, casting, smalldatetime

I am trying to compare `L.LoanDueDate` (which is a `smalldatetime`) to the return value of `ufnARCUGetLatestProcessDate()` (which is an `int`) to see how many days the loan due date is past the last process date.

I receive an

> Arithmetic overflow error converting expression to data type smalldatetime

error and can't seem to figure it out. Any help would be useful. Thank you in advance.

```
CAST(L.LoanDueDate - CAST(CAST((SELECT ProcessDate FROM ufnARCUGetLatestProcessDate()) AS VARCHAR(10)) AS smalldatetime) AS INT) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:48:45.867

You can't compare an int to a smalldatetime. You need to compare two dates and for that you'd have to use [datediff](http://msdn.microsoft.com/en-us/library/ms189794.aspx).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:54:06.070

You can cast the date column to int. It will give you the aproximate (rounded) date, without the time part, as an int.

**Edit:**

This will give you the date as a number for you to compare:

```
SELECT FLOOR(CAST(L.LoanDueDate as float)) -
(SELECT ProcessDate FROM ufnARCUGetLatestProcessDate()) AS myValue
FROM ... 
```

The key is to cast the date to number and not the number to date.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:01:57.777

I was able to figure out the issue. DigCamare's comment on DATEDIFF reminded me that is what I needed to do even though you can cast a int to a smalldatetime so you can compare it.

```
DATEDIFF(d,L.LoanDueDate,CONVERT(smalldatetime,convert(varchar(10),(SELECT ProcessDate FROM ufnARCUGetLatestProcessDate())))) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-23T15:05:01.163

Just wanted to add the following. This is what I am using to do a simple int to smalldatetime conversion. Hope it helps other people.

```
(SELECT CAST(CAST(ProcessDate AS VARCHAR(10)) AS SMALLDATETIME) FROM ufnARCUGetLatestProcessDate()) 
```

# java - Netbeans java创建jar

> ID：14885988
> 
> 赞同：0
> 
> 时间：2013-02-14T23:32:27.177
> 
> 标签：java, class, netbeans, jar, jaas

我需要你的帮助！我有一些类，我必须在 Netbeans 中为所有类创建一个 jar 文件。有人知道吗？非常感谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:49:19.350

右键单击项目节点，选择“清理并构建”。

完成后，该`Jar`文件将位于`dist`您的项目文件夹的文件夹中

# sql - T-SQL IF-ELSE

> ID：14885989
> 
> 赞同：0
> 
> 时间：2013-02-14T23:32:29.523
> 
> 标签：sql, sql-server, sql-server-2008, tsql

是否可以使用 IF-ELSE 或类似的东西来做这样的事情：

```
SELECT
MemberID,
ProfileTypeID
PrCountryID,    -- 3
PrStateID,      -- 4
PrStateInt
FROM Member
WHERE PrCity IS NOT NULL
IF @ShowUnclaimed = 'N'
    AND Claimed = 'Y'
    AND SBIcon = 'N'
END
AND Viewable = 'Y'
AND SystemID = 2 
```

非常感谢您提供任何信息。

新杰克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:39:56.190

无需为此使用案例

```
SELECT
    MemberID,
    ProfileTypeID
    PrCountryID,    -- 3
    PrStateID,      -- 4
    PrStateInt
FROM Member
WHERE PrCity IS NOT NULL
AND Viewable = 'Y'
AND SystemID = 2
AND ( @ShowUnclaimed != 'N' 
      OR ( Clamed = 'Y' AND SBIcon = 'N' )
    ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T23:33:34.783

您正在寻找`case`表达式 ( [MSDN](http://msdn.microsoft.com/en-us/library/ms181765.aspx) )

```
SELECT MemberID,
       ProfileTypeID
       PrCountryID,    -- 3
       PrStateID,      -- 4
       PrStateInt

FROM   Member

WHERE  PrCity IS NOT NULL
       AND CASE
               WHEN @ShowUnclaimed = 'N' AND Claimed = 'Y' AND SBIcon = 'N' THEN 1
           END = 1
       AND Viewable = 'Y'
       AND SystemID = 2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T23:41:13.357

如果我正确理解您的意图，则无需`IF`, 或`CASE`就此而言。

就像这样的事情似乎是你想要做的......？

```
WHERE PrCity IS NOT NULL
AND (@ShowUnclaimed = 'Y'
    OR (Claimed = 'Y'
    AND SBIcon = 'N'))
AND Viewable = 'Y'
AND SystemID = 2 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T23:37:15.820

尝试使用`CASE`：

```
SELECT
    MemberID,
    ProfileTypeID
    PrCountryID,    -- 3
    PrStateID,      -- 4
    PrStateInt
FROM Member
WHERE PrCity IS NOT NULL
    AND Viewable = 'Y'
    AND SystemID = 2
    AND Claimed = CASE WHEN  @ShowUnclaimed = 'N' THEN 'Y' ELSE Claimed END
    AND SBIcon = CASE WHEN  @ShowUnclaimed = 'N' THEN 'N' ELSE SBIcon END 
```

这只是一种方法。祝你好运。

# sql - 我需要外键来相互引用表吗

> ID：14885990
> 
> 赞同：0
> 
> 时间：2013-02-14T23:32:30.647
> 
> 标签：sql, database

使用外键时，我不确定是否要在包含相同字段的两个表中使用外键。例如：

选项表：

```
OptionId (PK auto)  OptionType
1                   A-C 
2                   A-D
3                   A-E 
```

问题表：

```
QuestionId (PK auto)  Question  OptionId (FK Option)
1                      2+2       2
2                      3+3       1 
```

我将问题表中的 OptionId 设为外键，但我是否想将选项表中的 OptionId 设为外键以及引用问题表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:37:20.317

不。

外键是一种约束：它旨在确保数据库的完整性。您不希望有人能够删除问题所在的选项，因为该问题将不再有效。但是，即使它所加入的选项仍然存在，删除一个问题也是非常有意义的——该选项很可能适用于其他现有或未来的问题。

# ruby-on-rails - 如何不将格式（json、html、xml）传递给 REST URL

> ID：14885991
> 
> 赞同：2
> 
> 时间：2013-02-14T23:32:41.367
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我正在使用 Rails 3，并且我正在使用它可以与 respond_to 和 respond_with 一起做的这个新的 Rails 3 东西，所以它是我的控制器，我有这样的东西：

[http://davidwparker.com/2010/03/09/api-in-rails-respond-to-and-respond-with/](http://davidwparker.com/2010/03/09/api-in-rails-respond-to-and-respond-with/)

```
respont_to :json

def show

    @organization = Organization.includes([:tableNamesBlah]).find(params[:id])

    respond_with(@organization)

  end 
```

我将它传递给 JBUILDER 的视图，....

所以在 URL 如果我去

```
http://localhost:3000/manager/1.json 
```

它工作正常并以 JSON 格式返回数据，但如果我转到相同的 URI 而不指定 .json 作为它的结尾，那么它将不会返回任何内容。

**如何以可以看到数据但不需要在 URL 末尾键入 .json 的方式修改我的代码？**

这是我应该在控制器中做的事情吗？或者我应该改变 JBUILDER 处理数据的方式还是与路由有关？如果您需要查看代码的其他部分，请告诉我

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:57:13.250

如果您希望设置默认格式，可以在您的 routes.rb 文件中进行设置：

```
resources :things, defaults: { format: :json } 
```

这应该给你你想要的行为（如果我正确理解你的问题）：

```
/things/1       # returns json
/things/1.json  # returns json
/things/1.html  # returns html 
```

# java - 如何指定要在 Java 中使用的打印机？

> ID：14885993
> 
> 赞同：4
> 
> 时间：2013-02-14T23:32:45.190
> 
> 标签：java, printing

目前正在检索我的机器上安装的默认打印机进行打印。我希望能够选择文件去哪台打印机。这样做的最佳方法是什么？

代码：

```
 PrintService[] services =
                PrintServiceLookup.lookupPrintServices(psInFormat, null);
        System.out.println("Printer Selected " + services[Printerinx]);

        //PrintService defaultService = PrintServiceLookup.lookupDefaultPrintService();

        DocFlavor[] docFalvor = services[Printerinx].getSupportedDocFlavors();
        for (int i = 0; i < docFalvor.length; i++) {
            System.out.println(docFalvor[i].getMimeType());
        } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-10-07T13:28:11.870

该`PrintServiceLookup.lookupPrintService()`方法提供了一种按名称查找打印机的方法。准备一个`HashAttributeSet`带有`PrinterName`属性对象的 a 并将其传递给查找方法。

使用如下代码：

```
AttributeSet aset = new HashAttributeSet();
aset.add(new PrinterName("MyPrinter", null));
PrintService[] pservices = 
    PrintServiceLookup.lookupPrintServices(null, aset); 
```

使用 CUPS 在 Linux 上工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T23:50:01.020

在下面创建`PrintUtility`类，将其导入并尝试调用`PrintUtility.findPrintService("name_of_my_printer");`，如果您知道您的打印机名称；如果您不知道您可以访问哪些打印机，请`PrintUtility.getPrinterServiceNameList();`要求`List`包含所有可行的已注册打印机名称。

或者，请参阅[我对这个 SO 问题的回答以](https://stackoverflow.com/questions/11230502/printing-on-network-printer-which-is-not-installed-localy-in-java/11232987#11232987)获取更多详细信息：

```
package com.stackoverflow.print;

import java.awt.print.PrinterJob;
import javax.print.PrintService;
import java.util.List;
import java.util.ArrayList;

public final class PrintUtility {

    /**
     * Retrieve a Print Service with a name containing the specified PrinterName; will return null if not found.
     * 
     * @return
     */
    public static PrintService findPrintService(String printerName) {

        printerName = printerName.toLowerCase();

        PrintService service = null;

        // Get array of all print services
        PrintService[] services = PrinterJob.lookupPrintServices();

        // Retrieve a print service from the array
        for (int index = 0; service == null && index < services.length; index++) {

            if (services[index].getName().toLowerCase().indexOf(printerName) >= 0) {
                service = services[index];
            }
        }

        // Return the print service
        return service;
    }

    /**
     * Retrieves a List of Printer Service Names.
     * 
     * @return List
     */
    public static List<String> getPrinterServiceNameList() {

        // get list of all print services
        PrintService[] services = PrinterJob.lookupPrintServices();
        List<String> list = new ArrayList<String>();

        for (int i = 0; i < services.length; i++) {
            list.add(services[i].getName());
        }

        return list;
    }

    /**
     * Utility class; no construction!
     */
     private PrintUtility() {}
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-01-10T09:38:29.037

```
int i ;

DocFlavor fl= null;

PrintService printService[]= PrintServiceLookup.lookupPrintServices(fl,null); 

for(i=0;i<printService.length;i++)
{
    System.out.println(printService[i]);

} 
```

# javascript - 如何将函数的主体作为字符串获取？

> ID：14885995
> 
> 赞同：12
> 
> 时间：2013-02-14T23:32:50.593
> 
> 标签：javascript, function

我想知道如何将函数体转换为字符串？

```
function A(){
  alert(1);
}

output = eval(A).toString() // this will come with  function A(){  ~ }

//output of output -> function A(){ alert(1); }

//How can I make output into alert(1); only??? 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-14T23:45:06.397

如果你要做一些丑陋的事情，用正则表达式来做：

```
A.toString().match(/function[^{]+\{([\s\S]*)\}$/)[1]; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-06-12T22:25:08.693

不要使用正则表达式。

```
const getBody = (string) => string.substring(
  string.indexOf("{") + 1,
  string.lastIndexOf("}")
)

const f = () => { return 'yo' }
const g = function (some, params) { return 'hi' }
const h = () => "boom"

console.log(getBody(f.toString()))
console.log(getBody(g.toString()))
console.log(getBody(h.toString())) // fail !
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T23:47:56.973

您可以将函数字符串化并通过删除其他所有内容来提取主体：

```
A.toString().replace(/^function\s*\S+\s*\([^)]*\)\s*\{|\}$/g, ""); 
```

但是，没有充分的理由这样做，而且[`toString`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/toString)实际上并非在所有环境中都有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-22T02:55:42.910

目前，开发人员在 Ecmascript 的新版本中使用**箭头函数。**

因此，我想[在这里分享答案，这是弗兰克的答案](https://stackoverflow.com/a/38466463/747579)

```
 function getArrowFunctionBody(f) {
      const matches = f.toString().match(/^(?:\s*\(?(?:\s*\w*\s*,?\s*)*\)?\s*?=>\s*){?([\s\S]*)}?$/);
      if (!matches) {
        return null;
      }

      const firstPass = matches[1];

      // Needed because the RegExp doesn't handle the last '}'.
      const secondPass =
        (firstPass.match(/{/g) || []).length === (firstPass.match(/}/g) || []).length - 1 ?
          firstPass.slice(0, firstPass.lastIndexOf('}')) :
          firstPass

      return secondPass;
    }

    const K = (x) => (y) => x;
    const I = (x) => (x);
    const V = (x) => (y) => (z) => z(x)(y);
    const f = (a, b) => {
      const c = a + b;
      return c;
    };
    const empty = () => { return undefined; };
    console.log(getArrowFunctionBody(K));
    console.log(getArrowFunctionBody(I));
    console.log(getArrowFunctionBody(V));
    console.log(getArrowFunctionBody(f));
    console.log(getArrowFunctionBody(empty));
```

**原始[问题在这里](https://stackoverflow.com/questions/38453881/how-to-get-an-arrow-functions-body-as-a-string)**

# php - jquery/PHP：从 curl 字符串获取 NULL 返回

> ID：14885998
> 
> 赞同：1
> 
> 时间：2013-02-14T23:32:58.143
> 
> 标签：php, jquery, ajax, curl

我看到一些奇怪的行为，将 JSON 字符串从 PHP 发送回 Jquery 的 $.ajax 函数。

当我从浏览器访问我的 php 脚本或通过命令行使用 php 调用它时，它返回完全有效的 JSON（使用 jsonlint.com 测试）。但是，当我从我的 HTML 文件中进行 AJAX 调用时，我总是会返回 NULL。

基本上从PHP我这样做：

```
// case in a switch that handles command 'getinfo':
$url = "http://someapi.com:1234/api/entity/" . $tagid;
$ch = curl_init( $url );
curl_setopt( $ch, CURLOPT_HEADER, 0 );
curl_setopt( $ch, CURLOPT_USERPWD, "user:pass" );
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );

$reply = curl_exec( $ch );

header('Content-Type: application/json');
echo $reply; 
```

这吐出这个：

```
[ {
  "class" : "entity",
  "guid" : "IT_EQUIPMENT_abcdef12345677890",
  "retired" : false,
  "deletable" : true,
  "$aAssetTamper" : false
} ] 
```

我尝试了设置和不设置 RETURNTRANSFER 以及设置和不设置 header() 行。在 HTML 方面，我使用 Ajax 调用：

```
$.ajax({
    url: "gimmedata.php",
    dataType: "json",
    cache: false,
    async: false,
    data: { 'cmd' : 'getinfo', 'tagid' : $('#tag').val },
    success: function( data, textStatus ) {
        // rfcode location
        console.log(data);
    }
}); 
```

状态始终返回“成功”，数据始终为“[]”。

奇怪的是，如果我从 PHP 脚本复制输出，然后将其粘贴回脚本本身，然后在不经过 curl 的情况下回显该字符串，那么我的 AJAX 调用工作正常：

```
echo '
[ {
  "class" : "entity" 
  "guid" : "IT_EQUIPMENT_abcdef12345677890",
  "retired" : false,
  "deletable" : true,
  "$aAssetTamper" : false
} ]';
return;

$ch = curl_init( $url );
curl_setopt( $ch, CURLOPT_HEADER, 0 );
curl_setopt( $ch, CURLOPT_USERPWD, "user:pass" );
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, 1 );

$reply = curl_exec( $ch );

header('Content-Type: application/json');
echo $reply; 
```

我不知道它会是什么。有什么线索吗？curl_exec 是否对文本做奇怪的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:41:27.030

php 有一个漂亮的函数：json_encode。也许您可以看看将其集成到您的代码中是否有助于确保您的 json 的有效性？ [http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)

其次，您的请求是同步的，除非您必须这样做，否则这通常不是最好的，关于该主题的内容很多

也尝试调整你的ajax代码：

```
$.ajax({
    url: "gimmedata.php",
    async: false,
    data: { 'cmd' : 'getinfo', 'tagid' : $('#tag').val() },
    success: function( data, textStatus ) {
        // rfcode location
        console.log(data);
    }
}); 
```

另外，您能否发布一些有关您的 PHP 代码如何接收 te ajax 请求的更多信息？我希望在某个地方看到 $_POST ......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:49:07.907

您从 JavaScript 传递的数据是错误的：

```
data: { 'cmd' : 'getinfo', 'tagid' : $('#tag').val }, 
```

您应该`.val`用作函数，而不是属性：

```
data: { 'cmd' : 'getinfo', 'tagid' : $('#tag').val() }, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T18:34:09.930

万一有人发生在这篇文章上，我也遇到了这个问题......

在我的情况下，我用来执行 curl 请求的变量没有被正确分配。因此，当我使用硬编码信息测试我的 php curl 时，它正在回显正确的 JSON 响应。但是当我通过 JQuery Ajax 调用运行它时，它返回 null 作为 JSON 数据。我挠了挠头，尝试了一堆东西，认为 curl 可能会从响应中附加一些不良数据。但是，当我终于沮丧到检查我的关键 curl 请求参数是否在发出请求之前实际上被正确识别时，低头看吧......好吧，他们没有。

始终检查以确保正确分配了传入的 GET / POST 变量！

# linux - grep 在文本文件中查找特定结果 | 常用表达？

> ID：14885999
> 
> 赞同：0
> 
> 时间：2013-02-14T23:33:15.610
> 
> 标签：linux, grep, expression

我无法理解一些正则表达式。我正在尝试在文本文件中搜索 2 个竖线字符之间的特定字段，例如

```
|nope|target|tree|
|target|nope|nah| 
```

我会使用什么样的 grep 正则表达式来只返回第一行？更具体地说，仅在第二个字段中找到“目标”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:38:34.700

打印第二个字段是目标的行：

```
kent$  echo "|nope|target|tree|
|target|nope|nah|"|awk -F'|' '$3=="target"'
|nope|target|tree| 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T23:49:53.363

这个问题有点不清楚，但我想你想要这样的东西：

```
grep '|.*|target|.*|' my_file.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-15T00:15:43.827

要匹配第二个字段：

```
grep "^|[^|]*|target|" file 
```

结果：

```
|nope|target|tree| 
```

解释：

```
^          # match start of line
|          # a pipe symbol
[^|]*      # anything not a pipe symbol any number of times
|          # a pipe symbol
target     # the word 'target'
|          # a pipe symbol 
```