# StackOverflow 问答 13884000-13884999

# ember.js - Ember.js 中的条件菜单

> ID：13884006
> 
> 赞同：1
> 
> 时间：2012-12-14T18:05:32.043
> 
> 标签：ember.js

在我的 Ember 应用程序中，我需要根据用户所在的应用程序部分显示几个不同的菜单或菜单。推荐的执行方式是什么？我试图做的是在我的模板中查看：

```
{{view App.NavbarView controllerBinding="App.CurrentNavbarController.nav"}} 
```

在我看来，我正在检查路径：

```
App.NavbarView = Ember.View.extend({ 
    templateName: function() {
        path = App.getPath('router.currentState.path');
        //change navbar
    }
}); 
```

这就是我卡住的地方。如何动态切换视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T14:21:46.670

一种方法是使用路由器进行设置。

```
someRoute:
  connectOutlets: (router, model)->
     # ... normal stuff here
     App.set 'section', 'theNameOfThisSection'
  exit: (router)->
     App.set 'section', ''

  subRoute:
    # ... in the sub route, App.section will still be set 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T14:26:55.307

另一种方法是使用路由器将一些插座连接到导航视图。

在你`application.handlebars`放一个命名的插座：

```
{{outlet nav}} 
```

在您的路由器中，输入路由时连接插座：

```
userRoute: 
  connectOutlets: (router, model)->
    # normal stuff here
    router.get('applicationController').connectOutlet('navbar', 'userNav', model)
  exit: (router)->
    router.get('applicationController').disconnectOutlet 'navbar'

  subRoute:
    # still has the navbar outlet connected in a subroute 
```

# c++ - C++ 致命错误 C1382：PCH 文件 'file' 自 'obj' 生成后已重建。请重建此对象

> ID：13884009
> 
> 赞同：3
> 
> 时间：2012-12-14T18:05:46.623
> 
> 标签：c++, visual-studio-2005

有人在用 C++ 编译时遇到这个错误吗？

```
Fatal Error C1382: the PCH file 'file' has been rebuilt since 'obj' was generated. Please rebuild this object 
```

我用谷歌搜索解决方案，msdn 建议我必须做两件事：

> 1.  使用 /LTCG 时，编译器检测到 .pch 文件比指向它的 CIL .obj 文件新。CIL .obj 文件中的信息已过期。重建对象。
>     
>     
> 2.  如果使用 /Yc 进行编译，也可能会出现 C1382，但也会将多个源代码文件传递给编译器。要解决此问题，请不要在将多个源代码文件传递给编译器时使用 /Yc。

我做了选项1，但编译器自己打开它。

对于选项 2，我如何知道我是否将多个源代码文件传递给编译器？

我无法关闭 /Yc 选项，因为我的工作应用程序中的所有其他项目都打开了 /Yc 选项......只有我的项目有这个问题。

有谁知道更好的解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:07:41.020

只需重建整个解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T12:53:39.290

VS2005 中存在已知错误（不幸的是，我没有什么可参考的）。要解决此问题，您应该将 stdafx.cpp 放在 vcproj 文件中的其他 cpp 文件之上。此错误已在 VS2008 及更高版本中修复。

例如在 vcproj 你会有这样的东西：

```
<Files>
  <Filter Name="Source Files" ...>
    <File RelativePath=".\file1.cpp"> .. </File>
    <File RelativePath=".\file2.cpp"> .. </File>
    <File RelativePath=".\stdafx.cpp"> .. </File>
...
</Filter>    
...
</Files> 
```

你应该做到：

```
<Files>
  <Filter Name="Source Files" ...>
    <File RelativePath=".\stdafx.cpp"> .. </File>
    <File RelativePath=".\file1.cpp"> .. </File>
    <File RelativePath=".\file2.cpp"> .. </File>
...
</Filter>    
...
</Files> 
```

附言

这是不时发生的浮动问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-26T21:48:01.950

我们一直在工作中遇到这个问题，当我们使用 QT Moc 在预构建步骤中制作 moc 文件并且 stdafx.h 内容更改时，通过 /fi 命令参数包含这些内容，我们发现 VS2008 Win32 编译器没有不会引发此错误，但 VS2008 ARMv4i 编译器会引发此错误。

我们可以在预构建步骤规则中添加对 stdafx.h 的依赖，但是如果 stdafx.h 包含的内容发生更改，这并不能解决，所以现在重新强制清理/重建是我们的解决方案。

# sql - 如何通过 Row_Number 更新列，每行具有不同的值？

> ID：13884011
> 
> 赞同：6
> 
> 时间：2012-12-14T18:05:48.870
> 
> 标签：sql, sql-server, stored-procedures, sql-update, row-number

我现在有这张桌子

```
CREATE TABLE [dbo].[DatosLegales](
    [IdCliente] [int] NOT NULL,
    [IdDatoLegal] [int] NULL,
    [Nombre] [varchar](max) NULL,
    [RFC] [varchar](13) NULL,
    [CURP] [varchar](20) NULL,
    [IMSS] [varchar](20) NULL,
    [Calle] [varchar](100) NULL,
    [Numero] [varchar](10) NULL,
    [Colonia] [varchar](100) NULL,
    [Pais] [varchar](50) NULL,
    [Estado] [varchar](50) NULL,
    [Ciudad] [varchar](50) NULL,
    [CodigoPostal] [varchar](10) NULL,
    [Telefono] [varchar](13) NULL,
    [TipoEmpresa] [varchar](20) NULL,
    [Tipo] [varchar](20) NULL,
 CONSTRAINT [PK_DatosLegales] PRIMARY KEY CLUSTERED 
(
    [IdCliente] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) 
```

我需要更新 IdDatoLegal 列。现在我在那个表上有 80 行，所以我需要用数字 1、2、3... 79、80 更新每一行。

我尝试了对存储过程的简单查询，但根本没有成功。

我现在有这个存储程序：

```
ALTER PROCEDURE dbo.ActualizarDatosLegales
@RowCount int 
AS 
DECLARE @Inicio int
SET @Inicio = 0
WHILE @Inicio < @@RowCount
SET @Inicio += 1;
BEGIN
UPDATE DatosLegales SET IdDatoLegal = @Inicio WHERE (SELECT ROW_NUMBER() OVER (ORDER BY IdCliente) AS RowNum FROM DatosLegales) = @Inicio;
END 
```

当我运行它时它会返回此消息

```
Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression. 
```

我猜这是因为在子查询中 (SELECT ROW_NUMBER() OVER (ORDER BY IdCliente) AS RowNum FROM DatosLegales) 它返回 80 行，它应该只返回一个（但每次它应该是一个不同的数字。

你知道我必须向子查询添加什么才能使其工作吗？最重要的是，循环和其余程序是否正确？

提前致谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-14T18:09:16.880

您可以使用 CTE 更新一条语句中的所有行，如下所示。

```
;WITH T
     AS (SELECT IdDatoLegal,
                Row_number() OVER (ORDER BY IdCliente ) AS RN
         FROM   dbo.DatosLegales)
UPDATE T
SET    IdDatoLegal = RN 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-14T18:14:02.230

```
UPDATE D
SET IdDatoLegal = RN 
FROM DatosLegales D JOIN 
 (
   SELECT IdCliente, Row_number() OVER (ORDER BY IdCliente) AS RN
   FROM   DatosLegales
 ) Temp
ON D.IdCliente = Temp.IdCliente 
```

# date - 如何获得 SSRS 图表以使用特定月份或每年的最后一个月？

> ID：13884013
> 
> 赞同：2
> 
> 时间：2012-12-14T18:05:56.707
> 
> 标签：date, reporting-services, charts

我在 Microsoft Visual Studio 2008 中有下面的图表，用于 SSRS 报告。

x 轴中的日期使用每年的一月，但我希望它使用我的数据集（来自 SQL Server）中可用的最新月份。例如，我们目前是 2012 年 12 月，所以我希望 x 轴为 Dec-06、Dec-07、Dec-08、Dec-09、Dec-10、Dec-11、Dec-12而不是 Jan-06、Jan-07 等。

我已经尝试在 SQL Server 查询中颠倒日期的顺序（更改为降序），但它对图表没有影响（但是数据更改为 desc，图表只是强制日期为一月） .

任何帮助将非常感激。

![我有的图表](../Images/89520dfbdedef582385b782dee8ae41e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T12:34:57.630

尝试在 x 轴本身上使用比例和迭代。您的数据不会改变，但您应该能够详细设置。

**更新的答案：** 您将不得不忍受将图表上的最小值设置为当前月份之前的 x 年，这样会迫使月份开始，比如 12 月。

以下[Microsoft 站点](http://msdn.microsoft.com/en-us/library/dd239363%28v=sql.105%29.aspx)指定自动使用这些最小值和最大值标签。然后基于此设置间隔。您唯一的选择是手动设置最小值和最大值。

# php - 在 IE7/8 中提供 PDF 文件下载失败

> ID：13884016
> 
> 赞同：1
> 
> 时间：2012-12-14T18:06:05.440
> 
> 标签：php, internet-explorer, zend-framework, http-headers, file-handling

我正在使用 Zend，并且在 webroot 之外有一些我希望能够提供的文件。我尝试了两种方法，这两种方法都适用于除 IE 8 或更低版本之外的所有浏览器。

我尝试过的两种（工作）方法如下：

```
 // Approach #1
  header('Content-Type: application/pdf');
  header("Pragma: ");
  header("Content-Disposition: attachment; filename=\"$filename\"");
  //header('Content-Transfer-Encoding: binary');
  header("Pragma: no-cache");
  header("Expires: 0");
  readfile($file);      

  // Approach #2
  $this->getResponse()
   ->setHeader('Content-Disposition', "attachment; filename=$filename")
  ->setHeader('Content-type', 'application/x-pdf');
  fpassthru($file); 
```

就像我说的，这两种方法都适用于现代浏览器（甚至是 IE9），但不适用于旧版本的 IE。我得到的错误如下：[http ://cl.ly/image/1G3x370b1s09](http://cl.ly/image/1G3x370b1s09)

我已经查看了有关该主题的几篇文章，并尝试了更多不同的标题组合，我什至无法计算。是否有更安全的方法来处理不会导致旧浏览器出现问题的此功能？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:39:02.917

我以前曾与此斗争过，我认为它源于缓存标头。

共有三个：`Expires`、`Cache-Control`（HTTP 1.1）和`Pragma`（HTTP 1.0）。我的经验是旧版本的 IE 喜欢看到所有这三个标题。在您发送的任何其他标题和内容之前尝试使用以下内容：

```
header("Cache-control: no-cache");
header("Pragma: no-cache");
header("Expires: -1"); 
```

Microsoft 的这篇[文章](http://support.microsoft.com/kb/234067)进一步讨论了缓存标头。

这是我过去为使其正常工作所做的工作：

```
$file = $fileInfo->openFile('r');
header("Pragma: public");
header("Cache-Control: public");
header('Content-type: application/pdf');
header('Content-Disposition: attachment; filename="'.$file->getFilename().'"');
print $file->fpassthru() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T16:19:42.240

[遵循http://support.microsoft.com/default.aspx?scid=KB;EN-US;q316431&](http://support.microsoft.com/default.aspx?scid=KB;EN-US;q316431&)的建议，这些标题对我有用：

```
header("Cache-control: max-age=3600, must-revalidate");
header("Pragma: public");
header("Expires: -1"); 
```

我总是被这个抓住！:(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T20:22:03.347

违背我的意愿，我放弃了与标题作斗争的尝试，并彻底改变了我处理文件下载的方式。当用户现在请求一个文件时，它会被临时散列，复制到网络服务器可以看到的区域，用户被重定向到该文件，一旦他们离开下载区域，文件就会被删除。如果它们处于非活动状态，则文件会以设定的时间间隔自动删除。

感谢您对 kulishch 的所有投入，您也来自明尼苏达州，这太讽刺了！？节日快乐！

——尼古拉斯

# internet-explorer - ImageMapster 1.2.6 的浏览器兼容性问题

> ID：13884017
> 
> 赞同：0
> 
> 时间：2012-12-14T18:06:13.603
> 
> 标签：internet-explorer, cross-browser, imagemapster

我正在尝试在每个图像映射区域上创建鼠标悬停弹出气泡。但 ImageMapster 1.2.6 似乎只能在 IE8、Firefox、Chrome 上运行，但不能在 IE8 兼容模式或 IE7 上运行。

javascript 显示错误：'null' 为空或不是对象

如果有人遇到过这种情况，请让我知道该讨论的链接或请帮助我！

是否有强制页面以 IE8 模式（而不是 Compat 模式）打开？……

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:11:03.900

回答我自己的问题......在挖掘和调试时，我在 javascript 文件中遇到了对象为空的正确行，并且简单地包含了一个代码以避免空值。例如：

```
if(text != null)
{
  Enter your code....
}
else
{
arr=0;
}
return arr; 
```

# sql - 在 MS SQL 中插入上标数字

> ID：13884018
> 
> 赞同：5
> 
> 时间：2012-12-14T18:06:14.473
> 
> 标签：sql, insert, varchar, superscript

尝试将值插入到`varchar`最后上标数字为 4（4 的幂）的数据字段中。

我可以使用上标 2 和 3（即平方和立方）插入/更新值，但我无法获得 4 的幂来正确输入`varchar`字段？

如果我将字段切换到 a ，它确实有效`nvarchar`，但我试图避免这种情况。

这适用于平方或 2 的幂

```
update mytable
set myfield = 'test'+NCHAR(0xb2) 
```

然而，试图让它在最后使用 4 来工作......

```
update mytable
set myfield = 'test'+NCHAR(0x2074) 
```

它只是将其更新为数字 4 而不是上标 4。这是因为`VarChar`数据类型识别平方和立方，但不识别任何其他类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:11:20.680

超过 3 的上标只能作为 Unicode 字符使用，因此很遗憾，您需要在数据字段中使用 an`NVARCHAR`而不是 a `VARCHAR`。

请参阅[ASCII 表](http://www.theasciicode.com.ar/)以获取不使用的允许字符`NVARCHAR`- 您只会看到 2 和 3 的上标。

# database - 如何在 access 2010 中为 BrowseTo 指定 PathToSubformControl

> ID：13884021
> 
> 赞同：0
> 
> 时间：2012-12-14T18:06:29.767
> 
> 标签：database, ms-access, database-design, vba

有人可以帮我处理 BrowseTo 宏吗？我无法弄清楚 ACCESS 2010 中 this 宏中的一个参数，即*PathToSubformControl*。我有这个名为“frm_navigation”的表格： ![在此处输入图像描述](../Images/069d5dabbd4d53210f358e7bad731dd2.png)

所有Tab的名称为：nav_vacancies、nav_contacts、nav_organizations等。图中的“Organization name”字段将保存另一个表tbl_organizations的名称。但是，“组织”选项卡（左起第三个）将显示表 tbl_organizations 中的所有信息。

我想编写一个按钮，将我带到组织选项卡并根据“组织名称”字段中显示的名称设置当前记录。

到目前为止，我是通过 DoCmd.OpenForm 完成的，但它会过滤掉所有其他记录并打开一个新窗口。我尝试将 BrowseTo 操作设置如下：

```
 DoCmd.BrowseTo acBrowseToForm, "frm_Organizations", "frm_navigation.nav_organizations", "[tbl_organizations].[PR_ID]=" & Me.cb_org_name.Value 
```

但我有运行时错误，因为我的 PathToSubformControl 是错误的。我应该如何指定路径？我无法理解结构。它应该遵循这种模式： MainForm1.Subform1 > Form1.Subform1 但它没有解释什么是什么。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-18T17:37:30.913

很晚才回复，但是...

在您的代码中，**“frm_navigation.nav_organizations”**需要指定 NavigationSubForm 子表单控件的名称（默认为 NavigationSubForm）。

让我尝试用通用名称重新说明您的命令：

```
DoCmd.BrowseTo acBrowseToForm, "frmToDisplayInNavSubCtl", "frmMainFormContainingNavSubFrmCtl.NavSubFrmCtl", ....criteria.... 
```

因此，简而言之，您需要进入 frm_navigation 表单的设计视图并确定 NavigationSubForm 控件的名称，而不是导航按钮的名称（例如，nav_organizations、nav_vacancies 等）并在点之后使用它，而不是.nav_organizations（按钮控件的名称）。

# objective-c - 按日期和时间跨度核心数据搜索

> ID：13884028
> 
> 赞同：0
> 
> 时间：2012-12-14T18:06:59.900
> 
> 标签：objective-c, core-data, nsdate

我正在处理一个核心数据项目，我有一个带有 modify_date 字段的表，我需要提取过去*n*天的所有条目，这些条目在（比如说）下午 1 点和晚上 9 点之间也有一个 modify_date。

我已经整理出部分解决方案，仅提取过去*n*天内的条目，如：[Core Data-predicate with dates](https://stackoverflow.com/questions/6812725/core-data-predicate-with-dates)

```
NSDate *today = [NSDate date];
NSDate *end_day = [today addTimeInterval: (days*86400.0f)];
day_st = [NSString stringWithFormat: @"(timestamp >= %@) AND (timestamp <= %@) AND ", today, end_day]; 
```

我现在唯一的问题是按时间跨度添加过滤器。但是，除了做一个 foreach 来检查结果中每个元素的时间之外，我想不出任何聪明的办法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T01:58:02.937

我会说你希望得到一个谓词，如：

```
((timestamp >= <startTimeOnDayOne>) AND (timestamp <= <endTimeOnDayOne>)) OR
((timestamp >= <startTimeOnDayTwo>) AND (timestamp <= <endTimeOnDayTwo>)) OR
[...] 
```

就如何制定适当的 Cocoa 日期对象而言，您可能想要播种两个`NSDateComponents`，一个用于开始时间，一个用于结束时间，第三个简单地表示“一天”。然后使用一个`NSCalendar`（如果你对它很模糊，只使用当前日历）及其`dateFromComponents:`和`dateByAddingComponents:toDate:options:`方法——前者获取第一天的日期，然后后者将每一天提前一天。

如果您试图在每个关键时刻增加 24 小时，那么在任何有夏令时的地区，您每年都会得到两次错误的结果。

您可以将`NSPredicate`每个相关日期的 s 构建到一个数组中，然后在最后将它们全部粘合到一个谓词中，这样您就*可以*`NSCompoundPredicate +orPredicateWithSubpredicates:`担心运行时有多少天。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T01:20:16.997

如果您在数据模型中存储日期类型的字段，则没有好的方法可以做到这一点。这些被存储为自参考日期以来的秒数 - 因此过滤`NSDate`作品，因为它是同一件事。但是，您不能基于日期组件（例如一天中的小时）构建谓词，因为数据存储对此一无所知。在大多数情况下，从数据存储中获取结果后过滤结果是一种合理的方法。

如果这是您经常做的事情，您可能会考虑添加一个或多个新属性——例如，存储一天中的小时的整数字段。然后你可以在你的`NSPredicate`. 每当日期字段更改时，设置这些字段的值。而且，**请确保您知道这些字段所在的时区**。UTC 更可取。当地时间是自找麻烦。使用 UTC，在设置字段值和获取之前，您可以将“1PM”、“9PM”等转换为 UTC 中的等价物。

最后（您可能已经意识到这一点，但从您的问题中并不明显），请注意，您链接到的另一个问题是`NSPredicate`在您`NSString`那里建立一段时间。*

# zend-framework - 如何在zend框架中定义自己的函数

> ID：13884029
> 
> 赞同：0
> 
> 时间：2012-12-14T18:07:04.453
> 
> 标签：zend-framework, zend-studio

其实我想知道有没有什么方法可以在 Zend 框架中定义和调用一个函数，它不需要像蛋糕 php 中的 pr() 函数一样放入 $this。我想定义一个这样的函数，可以在zend框架的所有控制器和视图中直接调用。是否可以通过将所有函数放在 helper 中并使用它们而不在它们前面写 $this 来完成。

例如，我想创建一个函数 arrprint() 来打印帮助器中的数组，并仅通过简单地编写 arrprint(); 来全局使用它。

请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:05:02.053

您可以在任何地方创建一个文件并将函数放在那里。就像包含任何其他文件一样包含它。

或者创建一个名为 Utils 的库，并将您的自定义函数作为静态函数放在那里，并使用以下命令调用它们：

```
Utils::myFunction(); 
```

与 cake zf 不同，它并没有强制执行任何操作。您可以利用该框架做任何您想做的事情。

BTW $this 只是一个指向当前类的指针，当你使用 $this->myFunction(); 这是因为该函数是当前类（或其父类）的成员。

# java - 在 @ModelAttribute 注释方法中返回 Spring 模型

> ID：13884031
> 
> 赞同：3
> 
> 时间：2012-12-14T18:07:14.923
> 
> 标签：java, model-view-controller, spring-mvc, modelattribute

我可以在使用 @ModelAttribute 注释的方法中使用 Spring 模型作为模型吗？我收到一条错误消息，说它在模型中找不到该属性。

这是我将对象添加到模型的方法：

```
@ModelAttribute("survivor")
public Model getSurvivors(Model m) {
    m.addAttribute("decedent", new Decedent());

    return m;
} 
```

这是渲染方法。它打印“模型包含死者=真”

```
@RenderMapping(params="render=survivors")
public String showSurvivors(Model model, RenderRequest request, RenderResponse response) throws Exception {
    logger.info("in showSurvivors");
    logger.debug("model contains decedent={}, mode.containsAttribute("decedent");
    return "survivors";
} 
```

这是jsp：

```
<form:form commandName="survivor" action="${submitAction}">
<form:input path="decedent.firstName" /> 
```

错误：

> org.springframework.web.servlet.tags.RequestContextAwareTag doStartTag bean 类 [org.springframework.validation.support.BindingAwareModelMap] 的无效属性“decedent”：Bean 属性“decedent”不可读或具有无效的 getter 方法：是否返回getter 的类型是否匹配 setter 的参数类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T12:31:06.933

您实质上是在这样做：

```
model.addAttribute("survivor", model); 
```

您在 中看到的问题`form:input`是它期望`decedent`模型上有一个不存在的吸气剂。修复可能是在普通 Map 之上使用另一种包装器类型：

```
public class MyCommand{
    private Map<String, Decedent> decedents;
...getters and setters.
} 
```

..

```
model.addAttribute("survivor", ..); //Add MyCommand type.. 
```

..

```
<form:form commandName="survivor" action="${submitAction}">
<form:input path="decedents['decedent']" /> 
```

# .htaccess - 自定义 404 页面

> ID：13884033
> 
> 赞同：0
> 
> 时间：2012-12-14T18:07:25.063
> 
> 标签：.htaccess, http-status-code-404, errordocument

我正在使用具有页面的 html5 样板，`404.html`但如果我导航到错误的 URL，它不会显示。浏览器显示默认的 404 页面。htaccess 文件已经有这一行：

```
ErrorDocument 404 /404.html 
```

一些帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:26:57.537

您是否已在目录指令中设置`AllowOverride All`？这必须在您的服务器配置中的某个位置。例如虚拟主机配置：

```
<Directory /path/to/htdocs>
    Options Indexes FollowSymLinks Includes ExecCGI
    AllowOverride All # this All here is important, default is none
    Order allow,deny
    Allow from all
</Directory> 
```

# objective-c - IOS6构建链接错误

> ID：13884034
> 
> 赞同：4
> 
> 时间：2012-12-14T18:07:26.070
> 
> 标签：objective-c, ios

我用静态库构建我的应用程序链接，发现错误如下

```
Undefined symbols for architecture armv7:
"std::_List_node_base::hook(std::_List_node_base*)", referenced from:
      std::list<TSendBuf, std::allocator<TSendBuf> >::_M_insert(std::_List_iterator<TSendBuf>, TSendBuf const&) in libCardAnalyLib1.a(SendRecvThread.o)
"std::_List_node_base::unhook()", referenced from:
      std::list<TSendBuf, std::allocator<TSendBuf> >::_M_erase(std::_List_iterator<TSendBuf>) in libCardAnalyLib1.a(SendRecvThread.o)
ld: symbol(s) not found for architecture armv7
clang: error: linker command failed with exit code 1 (use -v to see invocation) 
```

谁能告诉我这是什么错误？谢谢你。
应用程序和库中有 C++ 代码。我的演示应用程序无法链接库，显示此错误，并且 TSendBuf 是

```
typedef struct {
    unsigned char szBuf[1200];//1000 fah  char
} TSendBuf; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:12:26.077

您可能需要将`libstdc++.dylib`应用程序链接到的框架/二进制文件添加到列表中。

您可以从目标设​​置/“构建阶段”选项卡/“将二进制文件与库链接”部分执行此操作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:51:27.423

链接设置中的库和应用程序可能不匹配。

在您的库和应用程序的 Xcode**构建设置中的****Apple LLVM 编译器**下，专门检查**C++ 标准库**设置。那些需要匹配。

 ****假设有问题的库不是您自己构建的，并且如果该库是前一段时间构建的（Xcode 4.5/LLVM 4.1 之前），那么您的应用程序的“正确”设置将是**libstdc++ (GNU C++ standard library)**。****

# php - 为 20.000 个或更多用户优化 MySQL 数据库

> ID：13884035
> 
> 赞同：0
> 
> 时间：2012-12-14T18:07:31.560
> 
> 标签：php, mysql, database, optimization

我一直在寻找一些优化技巧，因为我正在做一个使用 MySQL 通过 PHP 存储数据的 RPG 修改。

我正在使用一个唯一的表通过他的唯一 ID 将所有用户信息存储在列中，并且我必须为每个用户存储（很多？）数据。武器和其他信息。

我正在使用爆炸和内爆作为存储武器的方法，例如，在具有“文本”值的列中。我不知道这是否是一个好的做法，我不知道如果我让成千上万的玩家执行大量的 UPDATES 、 SELECT 等请求，我是否会遇到性能问题。

我读到一个 Junction 表可能更好地存储武器和所有这些信息，但我不知道这是否会获得您通过 explode 方法请求的更好的信息。

我的意思是，我应该将所有武器存储在一个不同的表中，每个武器都有他的信息（每个武器都有一些信息，比如不同的列，我在主爆炸中使用多次爆炸）和该武器的用户所有者来识别武器不仅仅是将它们放在一列中。

至少可以存储 100 个项目，我不知道在不同的表上为每个用户创建 100 条记录并始终调用所有记录是否比仅调用列并使用爆炸更好。

此外，我想提高我的技能和知识，以制作性能最好的 MySQL 数据库。

我希望有人可以告诉我一些事情。

谢谢，并为我愚蠢的英语语法感到抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:31:50.137

规范化表数据几乎总是最佳实践。这条规则有一些例外（尤其是在容量非常大的数据库中），但您可能不需要担心这些例外，直到您首先了解如何正确规范化和索引您的表。

通常，尝试以模仿现实世界对象及其相互关系的方式排列您的表格。

因此，在您的情况下，您有用户 - 那是一张桌子。每个用户可能拥有多种武器。所以，你现在有一个武器表。由于多个不同的用户可能拥有相同的武器并且每个用户可能拥有多个武器，因此他们之间存在多对多的关系，因此您应该有一个表“users_weapons”或类似的表，它只会将用户 ID 与武器 ID 关联起来.

现在说用户都可以拥有盔甲。所以现在你添加一个 Armor 表和一个 users_armor 表（因为这也可能是多对多的）。

只需考虑游戏的不同方面并尝试了解它们之间的关系。在您编写任何代码来实际实现功能之前，请确保您可以在数据库表中对这些关系进行建模。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:15:11.437

是的，最好使用几张桌子而不是一张。更好的 db 性能，更容易理解，更容易维护和更简单的使用。

让我们建议一位用户拥有多种具有多种功能的武器（但在所有武器中并非独一无二）。在你的游戏中，你只需要知道一个特定功能的价值：

*   以您的方式执行此操作，您需要在用户表中找到用户行，在列上获取，将其分解几次，然后您就有了您的价值，但如果您想更改它并保存，它会变得更加复杂。

*   更好的方法是有一个用于用户详细信息（登录名、密码、电子邮件等）的表格，另一个保存用户武器的表格（武器名称，可能是图像）和一个表格，其中将保留所有功能，武器的特殊能力。您也可以将所有武器的所有可能功能保留在额外的表格中。这样，如果您已经从用户表中知道用户 ID，则只需在 sql 查询中加入 2 个表，您就可以获得用户特定武器的特征值。

表的示例伪模式：

```
users
    user_id
    user_name
    password
    email

weapons
    weapon_id
    user_id
    weapon_name
    image

weapons_features
    feature_id
    weapon_id
    feature_name
    feature_value 
```

如果您真的想在数据库的文本字段中使用一些有序数据，请将其编码为`JSON`或`serialize`。这样你就不必爆炸和内爆它！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:54:31.807

正如所有人所说，通常您应该从规范化的数据库结构开始。如果性能还可以，那就太好了，没什么可做的。

如果没有，您可以尝试许多不同的方法：

1.  查找并优化运行缓慢的查询。
2.  非规范化查询 - 有时连接会扼杀性能。
3.  更改应用程序中使用的数据访问模式。
4.  将数据存储在文件系统中或使用 NoSQL/多语言持久性解决方案。

# java - 识别扩展类对象

> ID：13884036
> 
> 赞同：5
> 
> 时间：2012-12-14T18:07:31.670
> 
> 标签：java

在 Java 中，我有一个类`Num`，以及一些扩展的类`Num`，比如`Num_int`和`Num_double`。我想知道一种方法是否可以识别给定`Num`对象是否为 a `Num_int`。

我有以下代码：

```
void test(Num_int x) {
  System.out.println("int");
} // test
void test(Num x) {
  System.out.println("other");
} // test

Num_int A = new Num_int( );
Num B     = new Num_int( );
Num C     = new Num_double( );

test(A); // prints "int"
test(B); // prints "other"
test(C); // prints "other" 
```

不幸的是，当 A 作为参数给出时，方法“test”只打印“int”。我不想在传递 B 时也打印“int”的函数，因为 B 是通过`Num B = new Num_int( );`. 这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:10:16.840

```
if (x instanceof Num_int) {
  System.out.println("int");
} else {
  System.out.println("other");
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-14T18:11:52.457

如果您想要多态行为，则使测试方法成为 Num 类的可覆盖方法。

重载的方法不会根据参数的运行时类型进行多态解析。它们在编译时根据声明的参数类型进行解析。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-14T18:10:03.760

这可以使用`instanceof`运算符和强制转换来完成。但是，这是一种糟糕的编程习惯。

更好的选择是创建`test()`一个非`final`成员`Num`，并在每个类中适当地覆盖它。然后您只需调用`A.test()`，Java 的动态调度将为您处理一切。

```
public class Num {
  public void test() {
    System.out.println("other");
  }
}

public class Num_int extends Num {
  public void test() {
    System.out.println("int");
  }
}

public class Num_double extends Num {
  // inhertis Num.test()
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T18:18:01.347

The problem is that method signatures are binded at compile time in Java, so the declared type determines which method is called.

See also the puzzler "Making a Hash of It" in the book [Java Puzzlers](http://www.javapuzzlers.com/).

You could use double-dispatching and the Visitor pattern. It would look something like this:

```
Num_int A = new Num_int( );
Num B     = new Num_int( );
Num C     = new Num_double( );

Num_printer p = new Num_printer();

A.accept(p);
B.accept(p);
C.accept(p); 
```

The `Num_int.accept(...)` and `Num_double.accept(...)` methods would both look like this:

```
public class Num_int extends Num {
    public void accept(Num_visitor v) {
        v.visit(this); // from this scope, `this` has a declared type of `Num_int`
                       // so at compile time this is binded to signature visit(Num_double)
    }
}

public class Num_double extends Num {
    public void accept(Num_visitor v) {
        v.visit(this); // from this scope, `this` has a declared type of `Num_double`
                       // so at compile time this is binded to signature visit(Num_double)
    }
} 
```

Even though these methods are almost identical, it's important that the method isn't extracted into the parent class. I'd go so far as to make it abstract in the parent class:

```
public class Num {
    public abstract void accept(Num_visitor);
} 
```

From within class `Num`, `this` is of declared type `Num`. If the `accept` method were defined here, the compile-time binding would be to signature `visit(Num)` - giving you the same original problem all over again.

Lastly, the `Num_printer` would look like this:

```
public class Num_printer implements Num_visitor {

    public void visit(Num_int n) {
        System.out.println("int");
    }

    public void visit(Num_double n) {
        System.out.println("double");
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T18:12:07.170

您可以使用`instanceof`运算符。阅读[本文档中的“](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op2.html)*类型比较运算符 instanceof* ”部分。

```
if (x instanceof Num_int) {
  // do something
} else if (x instanceof Num_double) {
  // do something else
} 
```

# excel - 在 Access 2010 中创建 Excel 2010 实例

> ID：13884037
> 
> 赞同：1
> 
> 时间：2012-12-14T18:07:36.600
> 
> 标签：excel, ms-access, vba

这里很疯狂，但我正在尝试从 Access 2010 初始化 Excel 2010 实例。（我之前在 07 / 03 做过很多次）。无论我使用后期绑定还是早期绑定，我都会在该行收到一条错误消息，`Set`指出

`Excel has stopped working`

`A problem caused the program to stop working correctly. Please close the program.`

有人有想法么？

这是我的绑定代码以防万一：

```
'late binding
Dim xlApp As Object
Set xlApp = CreateObject("Excel.Application")

'Early Binding (of course I have my reference set to Microsoft Excel Object Library
Dim xlApp As Excel.Application
Set xlApp = New Excel.Application 
```

哦对了，我也是win7的。

**更新**

我通过尝试初始化 Word 和 Access 实例进行了一些测试，它没有失败。此外，我尝试在远程桌面连接上初始化 XL 并得到同样的错误。

这使我远离了完整的 XL 重新安装，因为此时问题与两台不同机器上的 XL 有关，但与其他应用程序无关。

**更新2**

我办公室的所有 2010 XL Win7 安装似乎都会出现此错误。

这是错误的事件日志描述：

```
Faulting application name: EXCEL.EXE, version: 14.0.6126.5003, time stamp: 0x505b0834
Faulting module name: mso.dll, version: 14.0.6123.5001, time stamp: 0x4fe1743b
Exception code: 0xc0000005
Fault offset: 0x000d44e9
Faulting process id: 0x1ac0
Faulting application start time: 0x01cdda417700ac49
Faulting application path: C:\Program Files\Microsoft Office\Office14\EXCEL.EXE
Faulting module path: C:\Program Files\Common Files\Microsoft Shared\office14\mso.dll
Report Id: b51c3820-4634-11e2-b879-e4115b51637e 
```

# php - 将数据库结果返回到数组问题

> ID：13884041
> 
> 赞同：0
> 
> 时间：2012-12-14T18:07:57.803
> 
> 标签：php

我正在尝试将数据库结果推送到数组。

我的目标是使数组如下所示

```
array('test1'=>2, 'test2'=>3); 
```

我有如下声明：

```
$results=DB::call($statement, $parameter); 
```

我需要使用`foreach`循环

```
foreach ($ids as $id){

  $results[]=DB::call($statement, $id);

} 
```

没有`foreach`循环，我的结果数组将是

```
array('test1'=>2, 'test2'=>3) 
```

但是使用`foreach`循环，我的数组将变成二维

```
//loop twice in my case

array(
     array(
      'test1'=>2,  
       test2'=>3,        
     ),
     array(
       'test3'=>4    
       'test4'=>5    
     )    
) 
```

反正有没有将我的结果连接起来只创建一维数组？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:12:49.677

```
$results = array();    
foreach ($ids as $id){

  $results=array_merge($results,DB::call($statement, $id));

} 
```

# linq - 使用带有谓词和 OR 条件自动生成的查询的错误结果

> ID：13884044
> 
> 赞同：0
> 
> 时间：2012-12-14T18:08:04.993
> 
> 标签：linq, entity-framework, lambda, predicate

我将此谓词与 EF 和 lamdba 表达式一起使用：

```
public class PredicateBuilder
{
    public static Expression<Func<T, bool>> True<T>() { return f => true; }
    public static Expression<Func<T, bool>> False<T>() { return f => false; }
}

public static class ExpressionExtensions
{
    public static Expression<Func<T, bool>> And<T>(this Expression<Func<T, bool>> first, Expression<Func<T, bool>> second)
    {
        return first.Compose(second, Expression.And);
    }

    public static Expression<Func<T, bool>> Or<T>(this Expression<Func<T, bool>> first, Expression<Func<T, bool>> second)
    {
        return first.Compose(second, Expression.Or);
    }
} 
```

现在我只想动态构建这个查询：

```
Query(ufe => (ufe.FilmEtat.filmetat_code == etatString && ufe.user_id == 2) || (ufe.FilmEtat.filmetat_code == etatString && ufe.user_id == 11)).ToList(); 
```

我已经尝试过：

```
var predicate = PredicateBuilder.True<UtilisateurFilmEtat>();
int i = 0;
foreach (int utilisateurId in listUtilisateurId)
{
    if (i == 0)
        predicate = ufe => (ufe.FilmEtat.filmetat_code == etatString && ufe.user_id == utilisateurId);
    else
        predicate.Or(ufe => ufe.FilmEtat.filmetat_code == etatString && ufe.user_id == utilisateurId);

    i++;
} 
```

查询正在运行，但没有返回良好的结果...

我快疯了:(

需要你的帮助。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:50:37.297

您的问题似乎与这个问题非常相似： [Linq to SQL how to do "where [column] in (list of values)"](https://stackoverflow.com/questions/1075540/linq-to-sql-how-to-do-where-column-in-list-of-values)，尽管不是完全重复的。

我可以看到您正在尝试通过将其他查询与 组合来动态构建查询，`||`如果您只有一个比较运算符，这就是您想要做的......

相反，这样的事情怎么样：`ufe => listUtilisateurId.Contains(ufe.user_id)`

# asp.net-mvc-4 - Microsoft 是否更改了 ASP.NET MVC 处理重复操作方法名称的方式？

> ID：13884048
> 
> 赞同：2
> 
> 时间：2012-12-14T18:09:00.320
> 
> 标签：asp.net-mvc-4

我可能在这里遗漏了一些东西，但在 ASP.NET MVC 4 中，我无法让以下工作。

给定以下控制器：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    [HttpPost]
    public ActionResult Index(string order1, string order2)
    {
        return null;
    }
} 
```

它的观点：

```
@{
    ViewBag.Title = "Home";
}

@using (Html.BeginForm())
{
    @Html.TextBox("order1")<br />
    @Html.TextBox("order2")
    <input type="submit" value="Save"/>
} 
```

启动应用程序时，我得到的只是：

> 当前对控制器类型“HomeController”的操作“Index”的请求在以下操作方法之间不明确： System.Web.Mvc.ActionResult Index() on type ViewData.Controllers.HomeController System.Web.Mvc.ActionResult Index(System. String, System.String) 在 ViewData.Controllers.HomeController 类型上

现在，在 ASP.NET MVC 3 中，上述工作正常，我刚刚尝试过，那么在 ASP.NET MVC 4 中发生了什么改变来打破这个？

好的，我可能在这里做一些愚蠢的事情，而没有注意到它。

编辑：

我注意到在 MVC 4 应用程序中，Global.asax.cs 文件不包含以下内容：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapRoute(
        "Default", // Route name
        "{controller}/{action}/{id}", // URL with parameters
        new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
    );
} 
```

默认情况下，MVC 3 应用程序会执行此操作。所以我将上述内容添加到 MVC 4 应用程序中，但它失败并出现同样的错误。请注意，MVC 3 应用程序确实适用于上述路线。我通过 Request.Form 传递“订单”数据。

编辑：在`RouteConfig.cs`我可以看到的文件`RegisterRoutes`中执行，具有以下默认路由：

```
routes.MapRoute(
    name: "Default",
    url: "{controller}/{action}/{id}",
    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }); 
```

我仍然得到原始错误，关于`Index()`调用哪个方法之间的歧义。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-15T17:02:38.117

因为 MVC4 附带 ASP.Net Web.API，您可以潜在地引用两个`HttpPostAttribute`（这同样适用于其他属性`HttpGet`，例如 等）：

*   [`System.Web.Mvc.HttpPostAttribute`](http://msdn.microsoft.com/en-us/library/system.web.mvc.httppostattribute(v=vs.108).aspx) **由 ASP.Net MVC 使用，**因此您需要在`Controller`派生控制器内的操作上使用它

*   [`System.Web.Http.HttpPostAttribute`](http://msdn.microsoft.com/en-us/library/system.web.http.httppostattribute(v=vs.108).aspx) **由 ASP.Net Web.API 使用，**因此您需要在 `ApiController`派生控制器内的操作上使用它

您已在代码中明确引用`System.Web.Http.HttpPostAttribute`。将其更改为使用正确的属性，它应该可以正常工作：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    [System.Web.Mvc.HttpPost]
    public ActionResult Index(string order1, string order2)
    {
        return null;
    }
} 
```

# mysql - 使用复合键和 EF 5 创建 MVC 控制器时出错

> ID：13884055
> 
> 赞同：0
> 
> 时间：2012-12-14T18:09:17.473
> 
> 标签：mysql, asp.net-mvc, entity-framework, composite-key

使用实体框架工具，我首先将 MySQL 数据库的 POCO 类逆向工程到类库中。我创建了一个引用此类库的 MVC 项目，并且我正在尝试创建一个具有读/写操作和视图的控制器。设置模型和数据上下文类并单击“添加”后，我收到此错误：

EntityType xxx 没有定义键。定义此 EntityType 的键。

问题是，在地图中它被正确标记：

```
 public UserApplicationMap()
    {
        // Primary Key
        this.HasKey(t => new { t.UserID, t.AppID });
        ... 
```

我试着在课堂上这样做：

```
public class UserApplication
{
    [Key, Column(Order = 0)]
    public int UserID { get; set; }

    [Key, Column(Order = 1)]
    public int AppID { get; set; } 
```

但是编译器适合 Column 属性并将其标记为无效。

所以我有点难过。如果我只能使用复合键，我真的不想在此表中添加自动增量字段。

我正在使用 Visual Studio 2012、EF 5、MVC 4 和 MySQL 连接器 6.6.4

# c# - DataContractJsonSerializer 返回空对象

> ID：13884062
> 
> 赞同：0
> 
> 时间：2012-12-14T18:09:42.227
> 
> 标签：c#, json, windows-phone-8

我已经为这个问题苦苦挣扎了很长一段时间，但无法解决。我有以下 JSON 字符串：

```
 {"Search":[{"Title":"somestring","Year":"somestring","imdbID":"somestring"}]}, {"Title":"somestring","Year":"somestring","imdbID":"somestring"} etc 
```

该字符串可以重复多次，所以我想将这些值存储在一个列表中。为此，我创建了以下两个类： SuggestionListener 类：

```
[DataContract]
class SuggestionLister
{
    public List<MovieResults> suggestionlist {get;set;}
} 
```

其中包含我想要返回的列表。

和 Movieresults 类：

```
[DataContract]
class MovieResults
{
    [DataMember]
    public string Title { get; set; }
    [DataMember]
    public string Year { get; set; }
    [DataMember]
    public string imdbID { get; set; }

} 
```

其中包含需要存储的数据。我尝试使用以下代码对其进行反序列化：

```
byte[] data = Encoding.UTF8.GetBytes(resp);
MemoryStream memStream = new MemoryStream(data);
DataContractJsonSerializer serializer = new    DataContractJsonSerializer(typeof(SuggestionLister));
SuggestionLister suggestionMovies = (SuggestionLister)serializer.ReadObject(memStream); 
```

其中 'resp' 变量是 JSON 字符串。但是，当我尝试此代码时，SuggestMovies 对象仍然为空。怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:23:02.137

好的，所以有几个问题：

```
[DataContract]
public class SuggestionLister
{
     [DataMember]
    public List<MovieResults> Search { get; set; }
} 
```

您的列表属性上没有 DataMember 属性，它需要匹配数组值的名称，即“搜索”。

编辑：我使用您的代码测试了所有这些。您发布的 JSON 格式也不正确，但我假设这是一个粘贴错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:17:43.877

尝试

```
[DataContract]
class SuggestionLister
{
   public List<MovieResults> Search {get;set;}
} 
```

由于您的 json 似乎是这种格式：

```
{
  "Search": [ { "Title": ... }]
} 
```

# html - iFrame - 用于删除元素的 JavaScript

> ID：13884065
> 
> 赞同：0
> 
> 时间：2012-12-14T18:09:56.763
> 
> 标签：html, iframe, relative-path

我有以下问题：我们有两个站点，一个基于 elgg 的社区页面和一个基于typo3 的第二个页面。我们要做的是在typo3 子页面中创建一个简单的iframe，其中包含社区页面。由于社区页面有自己的带有徽标等的页眉，因此看起来很愚蠢。我试图删除所有期望的内容，但这是不可能的，因为 iframe 源看起来像“http://myiFramePage.org”，所以它们的来源不同。幸运的是，这两个系统在同一台服务器上，但我无法创建相对 url。你能帮我找到正确的网址吗？

*   /
    *   public_html
        *   埃尔格
            *   索引.php
        *   错字3
            *   索引.php

另外我想问一下你怎么看？剪掉页面的正文/最重要的部分是否有意义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T12:08:02.073

如果你只是从 elgg 中剪下 body 并在拼写错误中调用它，它就行不通了。因为它缺少 css、必要的 js 文件等。最好的解决方案是也为社区站点创建一个类似的主题。这将使两个站点看起来相同，并且您不会失去社区站点的任何功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T13:35:08.817

我不喜欢破解东西的解决方案，它们有破坏的倾向，而且几乎无法测试。我会尝试从系统内部自定义内部页面（如 Webgalli 的回答中所建议的那样），使其看起来像外部页面。

# asp.net-mvc-4 - WebAPI 中的自定义 IActionFilter 返回状态码未经授权

> ID：13884067
> 
> 赞同：26
> 
> 时间：2012-12-14T18:10:05.793
> 
> 标签：asp.net-mvc-4, asp.net-web-api, action-filter

我正在使用 asp.net WebAPI，我需要创建一个自定义 ActionFilter 来快速检查请求 URI 的用户是否真的应该能够取回数据。

他们已经被授权通过基本身份验证使用 Web 服务，并且他们的角色已经通过自定义角色提供程序进行了验证。

我需要做的最后一件事是检查他们是否有权使用 URI 中的参数查看他们请求的数据。

这是我的代码：

```
public class AccessActionFilter : FilterAttribute, IActionFilter
    {

        public System.Threading.Tasks.Task<System.Net.Http.HttpResponseMessage> ExecuteActionFilterAsync(HttpActionContext actionContext, System.Threading.CancellationToken cancellationToken, Func<System.Threading.Tasks.Task<System.Net.Http.HttpResponseMessage>> continuation)
        {

            var result = //code to see if they have permission returns either 0 or 1

            if (result==0) {
               throw new ArgumentException("You do not have access to this resource");
            }
            return continuation();
        }
    } 
```

目前我只是抛出一个不是我想要的错误，我宁愿返回`System.Net.HttpStatusCode.Unauthorized`，但我对我覆盖的方法有点恼火，我并不完全理解它。

我将如何返回该值？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-14T18:38:20.853

您可能最好坚持一个异常，但使用 HttpResponseException 也会返回一个 Http 状态代码。

```
throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized)); 
```

关于这个的好[问题](https://stackoverflow.com/questions/10660721/what-is-the-difference-between-httpresponsemessage-and-httpresponseexception)。

ps

实施起来可能更简单/更干净`ActionFilterAttribute`

```
public class AccessActionFilter : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        var result = //code to see if they have permission returns either 0 or 1

        if (result==0) 
        {
            throw new HttpResponseException(new HttpResponseMessage(HttpStatusCode.Unauthorized));
        }
        base.OnActionExecuting(actionContext);
    } 
```

}

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-02-08T04:46:06.150

您可以设置状态代码，而不是抛出异常

```
public class ExecutionFilterAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(HttpActionContext actionContext)
    {
        var result = 0;//code to see if they have permission returns either 0 or 1

        if (result == 0)
        {
            actionContext.Response = new HttpResponseMessage()
            {
                StatusCode = HttpStatusCode.Unauthorized,
                Content = new StringContent("Unauthorized User")
            };
        }
        base.OnActionExecuting(actionContext);
    }
} 
```

# php - 如何防止 PHP 在 saveHTMLFile 中对 HTML 编码标签？

> ID：13884073
> 
> 赞同：0
> 
> 时间：2012-12-14T18:10:18.287
> 
> 标签：php, dom, character-encoding

我有一个小问题：`<br>`提交 PHP DomDocument 时不解析标签，例如标签。这是我的PHP代码：

```
$doc = new DOMDocument();
$doc->loadHTMLFile("Test.html");
$doc->formatOutput = true;
$node = new DOMElement('p', 'This is a test<br>This should be a new line in the same paragraph');
$doc->getElementsByTagName('body')->item(0)->appendChild($node);
$doc->saveHTMLFile("Test.html");
echo 'Editing successful.'; 
```

这是 HTML 代码（编辑前）：

```
<!DOCTYPE html>
<html>
    <head>
        <title>Hey</title>
    </head>
    <body>
        <p>Test</p>   
    </body>
</html> 
```

（修改后）

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Hey</title>
</head>
<body>
    <p>Test</p>   
<p>This is a test&lt;br&gt;This should be a new line in the same paragraph</p>
</body>
</html> 
```

为什么它不起作用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:21:42.483

您正在尝试附加一个[片段](http://www.php.net/DOMDocumentFragment)，该片段不能作为“正常”字符串工作（它怎么会知道您希望它编码什么而不是什么？）。

您*可以*使用该`DOMDocumentFragment::appendXML()`函数，但正如名称所述，它需要`XML`，而不是`HTML`，因此`<br>` *需要*自动关闭（因为我们在 XML 模式下工作）：

```
<?php
$doc = new DOMDocument();
$doc->loadHTMLFile("Test.html");
$doc->formatOutput = true;
$node = new DOMElement('p');
$p =  $doc->lastChild->lastChild->appendChild($node);
$fragment = $doc->createDocumentFragment();
$fragment->appendXML('This is a test<br/>This should be a new line in the same paragraph');
$p->appendChild($fragment);
$doc->saveHTMLFile("Test.html"); 
```

另一个不涉及更改字符串的解决方案是将单独的文档加载为 HTML (so, `$otherdoc->loadHTML('<html><body>'.$yourstring.'</body></html>')`, 然后循环通过它导入到主文档中：

```
<?php
$doc = new DOMDocument();
$doc->loadHTMLFile("Test.html");
$doc->formatOutput = true;
$node = new DOMElement('p');
$p =  $doc->lastChild->lastChild->appendChild($node);
$otherdoc = new DOMDocument();
$yourstring = 'This is a test<br>This should be a new line in the same paragraph';
$otherdoc->loadHTML('<html><body>'.$yourstring.'</body></html>');
foreach($otherdoc->lastChild->lastChild->childNodes as $node){
    $importednode = $doc->importNode($node);
    $p->appendChild($importednode);
}
$doc->saveHTMLFile("Test.html"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:14:03.263

你试过`<br/>`而不是`<br>`？它可能与标记的有效性有关。`<br>`是无效的。

# php - 控制器功能中的 codeigniters 辅助功能未执行

> ID：13884075
> 
> 赞同：0
> 
> 时间：2012-12-14T18:10:31.420
> 
> 标签：php, codeigniter

这是对控制器功能的调用：

```
function downloadFile(fn,con)
        {
            var loadUrl = "/Fast-Docs/index.php/Docs/downloadFile";
                alert('hi');
        $.post(  
            loadUrl,  
            {content: con, filename: fn});  
        } 
```

控制器功能：

```
public function downloadFile()
{
    $this->load->helper('download');
    $content=$this->input->post('content');
    $fn=$this->input->post('filename');
    return force_download($fn,$content);
} 
```

但文件没有下载。

我知道它不工作的原因，但我不知道如何解决它。那么解决方案是什么。您需要更多信息，请随时询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:51:48.130

我不完全理解你想要做什么。无论如何，您的代码中存在一个基本问题。

您正在对`"/Fast-Docs/index.php/Docs/downloadFile"`URL 进行 ajax 请求，但您忽略了响应。

我的建议是：忘记 ajax 并使用简单的链接。

```
<a href="/Fast-Docs/index.php/Docs/downloadFile/myfile.png">Download file</a> 
```

然后在控制器中：

```
public function downloadFile($filename)
{
    //Validate file name
    if($filename != 'validFileName') die('Invalid file name');

    //Set headers
    $this->load->helper('download');
    $content = file_get_contents('/images/' . $filename);
    force_download($filename, $content);
} 
```

如果由于某种原因您不能使用链接，您可以重定向到下载页面（通过设置`window.location`）。

如果你真的需要使用 ajax，看看[这个](http://kdelchev.com/2012/07/send-file-download-ajax/)。

# java - 在运行 H2 数据库时，它正在侦听 0.0.0.0： 我怎样才能阻止这个？

> ID：13884078
> 
> 赞同：0
> 
> 时间：2012-12-14T18:10:40.033
> 
> 标签：java, database, h2

当包含我与数据库的连接的应用程序正在运行时，我注意到有服务器端口开始侦听 0.0.0.0 并且我需要它不要以这种方式侦听，我只希望允许/侦听本地主机的连接。

有没有办法阻止数据库创建这些连接？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:14:10.677

您需要将 h2.bindAddress 设置为适当的值，根据您的要求，您的接口的 IP[4|6] 地址可能是 localhost。

# python - Python：如果字符串中有子字符串，则返回字符串

> ID：13884079
> 
> 赞同：1
> 
> 时间：2012-12-14T18:10:40.487
> 
> 标签：python, string, list, substring

我有两个列表，一个有一堆路径，例如：“C:\vol001\ABC123.xls”，另一个有一堆名称，例如：“ABC123”。如果名称在路径中，我正在寻找路径。所以对于上面的例子，程序会输出“C:\vol001\ABC123.xls”。

到目前为止，我一直在尝试使用 in 运算符，但我不确定如何返回路径。

```
for name in list1:
    if name in list2:
        return path in list2 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:26:40.967

您的初始解决方案不正确。实际上，您是在问“是否有'名称'**等于**列表中的项目之一”。但是如果你想测试**遏制**，即“'name'是否是列表**中任何项目的一部分**”，你应该使用类似下面的代码：

```
for name in l2:
    return [x for x in l1 if name in x] 
```

它返回匹配路径的列表。实际上，以更 Python 的方式重写*的*循环只有 2 个（我记得它被称为“列表理解”，如果我错了，那些更熟悉术语的人会帮我解决）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T14:15:03.293

考虑到您的评论，名称出现在路径中的哪个位置并不重要（即“C:\ABC123\test.png”和“C:\vol01\ABC123.xml”都与查询“ABC123”匹配） ，我们不考虑文件系统路径的结构，但可以进行纯字符串匹配。

成为`paths`所有路径`names`的列表，成为所有名称的列表，然后成为`name`您正在寻找的名称

```
(path for path in paths if name in path) 
```

是生成所有与名称匹配的路径的生成器。

```
dict ( ( (name, [path for path in paths if name in path] ) for name in names) ) 
```

创建一个字典，其键是名称，其值是包含相应名称的所有路径。你可以像这样使用它：

```
paths = [....]
names = [....]
d = dict ( ( (name, [path for path in paths if name in path] ) for name in names) )
print ('The name "ABC" is contained in: {}'.format (d ['ABC'] ) )
print ('The name "XYZ" is contained in: {}'.format (d ['XYZ'] ) )
print ('The name "pron" is contained in: {} different paths'.format (len (d ['pron'] ) if 'pron' in d else 0) ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:53:48.600

我认为这就是你想要的：

```
for path in list1:
    for name in list2:
        if name in path:
            return path
else:
    return None # not found 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T19:43:48.723

这对你有用吗？

```
new_paths = []                          # create list for the paths to be kept
for path in paths:                      # cycle through paths
    for name in names:                  # cycle through names
        if name in path:                # check if path contains the name
            new_paths.append(path)      # path is good, so add to the list 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-14T18:14:34.653

`return os.path.dirname(name)`

请记住，`import os.path`如果您还没有运行，则必须运行。请参阅[os.path 模块的文档](http://docs.python.org/2/library/os.path.html)。

# ms-access - 损坏的访问 .accdb 文件：“无法识别的数据库格式”

> ID：13884080
> 
> 赞同：9
> 
> 时间：2012-12-14T18:10:49.680
> 
> 标签：ms-access, ms-access-2010

我有问题。我们共享网络上的一个数据库不会对任何用户开放。它说“无法识别的数据库格式”。

我以前遇到过这个问题，但仍然能够打开数据库、压缩和修复，或者将所有数据库对象导入新数据库。

这里的问题是——我什至无法打开它。这里有没有不使用第三方软件修复数据库的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T18:15:25.487

打开访问，转到数据库工具选项卡，选择压缩和修复数据库。您可以从那里选择数据库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-30T23:23:59.970

我们在一台机器上而不是另一台机器上遇到了这个问题......解决方案是在控制面板中查看 Access Database Engine 2007 组件的版本。如果是 12.0.45 版本，需要运行 service pack 3 [http://www.microsoft.com/en-us/download/confirmation.aspx?id=27835](http://www.microsoft.com/en-us/download/confirmation.aspx?id=27835)

上面的链接将安装 12.0.66 版……这解决了问题……我想我会发布它，因为我没有在任何其他论坛上看到这个解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-28T19:56:49.297

在与同样的问题进行了多次斗争之后，我能够通过安装**32 位版本**的 2010 Access 数据库引擎来解决该问题。出于某种原因，64 位版本会生成此错误...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-18T08:22:36.667

好吧，我尝试了一些我希望它有所帮助的东西..

他们稍微改变了架构..

**使用以下内容：**

1- 在工具箱中将 AccessDataSource 更改为 SQLDataSource。

2- 在**下拉菜单**中选择您的访问数据库（xxxx.accdb 或 xxxx.mdb）

3-下一步->下一步->测试查询->完成。

为我工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-09T10:48:49.313

尝试创建一个新数据库并将每个表、查询等导入到这个新数据库中。通过此导入，Access 从头开始​​重新创建所有对象。如果对象中存在某种损坏，则应该解决它。

如果你很幸运，只有损坏的物品会丢失（如果有的话）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-17T09:23:43.573

有时这可能取决于您是否使用代码来访问数据库。如果您在代码中使用“DriverJet”而不是“DriverACE”（或旧版本的 DAO 库），则极有可能发生此类问题。您只需将“DriverJet”替换为“DriverACE”并进行测试。

# java - Java XML Schema 验证：前缀未绑定

> ID：13884084
> 
> 赞同：10
> 
> 时间：2012-12-14T18:11:05.330
> 
> 标签：java, xml, xsd

我已按照[本教程](http://www.w3schools.com/schema/schema_example.asp)验证 XML 文件。但是我在验证 XML 文件时收到异常。我做错了什么？我的代码：
XML 模式：

```
<?xml version="1.0" encoding="utf-8" ?>

<!-- definition of simple elements -->
<xs:element name="first_name" type="xs:string" />
<xs:element name="last_name" type="xs:string" />
<xs:element name="phone" type="xs:string" />

<!-- definition of attributes -->
<xs:attribute name="type" type="xs:string" use="required"/>
<xs:attribute name="date" type="xs:date" use="required"/>

<!-- definition of complex elements -->

<xs:element name="reporter">
    <xs:complexType>
        <xs:sequence>
            <xs:element ref="first_name" />
            <xs:element ref="last_name" />
            <xs:element ref="phone" />
        </xs:sequence>
    </xs:complexType>
</xs:element>

<xs:element name="report">
    <xs:complexType>
        <xs:attribute ref="type"/>
        <xs:attribute ref="date" />
        <xs:sequence>
            <xs:element ref="reporter" />
        </xs:sequence>
    </xs:complexType>
</xs:element> 
```

要验证的 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<report type="5" date="2012-12-14">
    <reporter>
        <first_name>FirstName</firstname>
        <last_name>Lastname</lastname>
        <phone>+xxxxxxxxxxxx</phone>
    </reporter>
</report> 
```

用于验证的 Java 源代码：

```
import javax.xml.XMLConstants;
import javax.xml.transform.Source;
import javax.xml.transform.stream.StreamSource;
import javax.xml.validation.*;
import org.xml.sax.SAXException;
import java.io.*;

public class ProtocolValidator
{
    public static void main(String [] args) throws Exception
    {
        Source schemaFile = new StreamSource(new File("schema.xsd"));
        Source xmlFile = new StreamSource(new File("test_xml.xml"));

        SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
        Schema schema = schemaFactory.newSchema(schemaFile);
        Validator validator = schema.newValidator();

        try{
            validator.validate(xmlFile);
            System.out.println(xmlFile.getSystemId() + " is valid");
        }
        catch (SAXException e) 
        {
            System.out.println(xmlFile.getSystemId() + " is NOT valid");
            System.out.println("Reason: " + e.getLocalizedMessage());
        }
    }
} 
```

我收到的例外情况：

```
Exception in thread "main" org.xml.sax.SAXParseException; systemId: file:/root/test/schema.xsd; lineNumber: 4; columnNumber: 50; The prefix "xs" for element "xs:element" is not bound.
    at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:198)... 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-14T18:17:12.040

XML 模式文件本身需要是有效的 XML 文档。您缺少外部架构元素和`xs`前缀的命名空间声明。

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema">
    <!-- schema elements here -->
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:18:06.360

将此行添加到您的架构中，就在第一行的下方：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"> 
```

...和一个结束标记作为架构中的最后一行：

```
</xs:schema> 
```

# vba - 如何将 excel 切片器链接到 excel 滑块（滚动条）？

> ID：13884086
> 
> 赞同：2
> 
> 时间：2012-12-14T18:11:06.240
> 
> 标签：vba, scrollbar, excel-2010, pivot-table

Excel 2010 具有称为切片器的数据透视表功能。切片机不错。但是，当您对具有大量唯一值的列进行切片时，切片器很糟糕。

我想知道如何将切片器绑定到“滑块”（滚动条），这样我就可以将宏链接到滚动条，该滚动条选择小于或等于滚动条上的值的所有切片器值。当我通过单击更改滚动条时，值会更改，因此切片器的选定值会更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:39:32.067

找到了一种方法来做到这一点并避免中间人（切片机）。这可能与我自己的特定数据的结构有关，但我认为它通常会起作用。

1.  使用宏记录器，记录自己在要设置切片器的列上设置值过滤器。在我的情况下，该列是`% of Sales with Vendor`
    我们使用值过滤器 -> 大于。选择列，然后输入值。您的数据透视表将发生变化。停止宏记录器。

2.  我们需要另一段代码。录制新宏。使用此宏，清除您刚刚在数据透视表上设置的过滤器，然后停止记录器。

3.  开发人员 -> 插入 -> 滚动条。现在只需将滚动条放在任何地方。

4.  `% of Sales with Vendor`在A1 等单元格中输入值范围内的值。虽然我的数据透视表将数据显示为百分比，但基础数据源使用小数。对于 20%，我将输入 2。为什么？您不能在非整数值上滚动条。我真的想要 0.2 但是通过输入`=A1/10`相邻的单元格，我总是可以引用我真正想要的值

5.  您只需要创建一个看起来像这样的宏（从您录制的两个中）。

* * *

```
Sub sliderfilter()  
    '  
    ' sliderfilter Macro  
    '  
    '  

    ActiveSheet.PivotTables("PivotTable2").PivotFields("Vendor"). _  
    ClearAllFilters  

    ActiveSheet.PivotTables("PivotTable2").PivotFields("Vendor").PivotFilters. _  
        Add Type:=xlValueIsGreaterThan, DataField:=ActiveSheet.PivotTables( _  
        "PivotTable2").PivotFields("% of Sales with Vendor"), Value1:=Range("B1").Value

End Sub 
```

6.  A1 是您拥有价值的地方`2`。滚动条应该有 Cell Link $A$1。但是，您的宏参考 B1... 您除以 10 的位置处于适当的`% of Sales with Vendor`值范围内。

7.  当然，您将宏分配给滚动条。

当您更改滚动条时，它会更改 A1 和 B1，并告诉宏使用 B1 中的值执行值过滤器。您因此创建了一个 SLIDER，因为不，您可以单击或滑动滚动条值（PS。长边水平的滚动条是一个滑块）

# delphi - 如何以编程方式更改 Firemonkey 控件中的字体属性

> ID：13884089
> 
> 赞同：2
> 
> 时间：2012-12-14T18:11:23.073
> 
> 标签：delphi, fonts, firemonkey, firemonkey-fm2

我有一些代码可以绘制一组放置在 TImage 之上的控件。然后我抓取 TImage 的 MakeScreenshot 以保存文件。这现在完美无缺。我现在正在努力改变一个或多个标签/文本样式控件的字体属性。无论我尝试什么，标签都不会改变。以下是我的示例代码：-

```
procedure TfrmSnapshot.Process;
var
  LRect1, LRect2, LRect3, LRect4: TRectF;
  X, Y, W, H: Integer;

begin
//
X := Round(Label1.Position.X);
Y := Round(Label1.Position.Y);
W := Round(X + Label1.Width);
H := Round(Y + Label1.Height);
LRect1.Create(X, Y, W, H);

X := Round(Label2.Position.X);
Y := Round(Label2.Position.Y);
W := Round(X + Label2.Width);
H := Round(Y + Label2.Height);
LRect2.Create(X, Y, W, H);

X := Round(Label3.Position.X);
Y := Round(Label3.Position.Y);
W := Round(X + Label3.Width);
H := Round(Y + Label3.Height);
LRect3.Create(X, Y, W, H);

X := Round(Rect1.Position.X);
Y := Round(Rect1.Position.Y);
W := Round(X + Rect1.Width);
H := Round(Y + Rect1.Height);
LRect4.Create(X, Y, W, H);

Label1.Text := fTitle;
Label1.Font.Size := 40.0;
Label2.Text := fSub;
Label3.Text := fSite;

With imgSnap.Bitmap Do
Begin
  Label1.Font.Size = 40; //Does not work
  Label1.Font.Family = 'Arial'; //Does not work
  Label1.PaintTo(Canvas, LRect1);
  Label2.PaintTo(Canvas, LRect2);
  Label3.PaintTo(Canvas, LRect3);
  Rect1.PaintTo(Canvas, LRect4);
End;

imgSnap.MakeScreenshot.SaveToFile('test.jpg');
end; 
```

如何设置标签的字体以便正确绘制并包含在屏幕截图中？

问候安东尼

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-28T14:09:10.153

在 firemonkey TLabel 属性 Font.Family 和 Font.Size 中设置样式。如果要更改代码中的字体大小或系列，则需要禁用此属性的样式。要更改此设置，请正确设置属性 StyledSettings。

例子：

```
Label1.StyledSettings:=Label1.StyledSettings -[TStyledSetting.ssFamily,TStyledSetting.ssSize] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T07:46:58.813

好的，这就是对我有用的方法。
我需要做的是将我想要在图像中显示的内容包裹在 TRectangle 中，然后将 Rectangle 绘制到图像上。我还必须更改 Rectangle 内控件的默认属性，例如我必须更改字体名称和字体大小。然后我可以把它们改成我想要的。还需要确保显示要快照的图像的表单是可见的（form.show）

这对我有用，并且在公共使用中，我没有任何错误。

帕斯卡源代码：

```
unit FormSnap;

interface

uses
  System.SysUtils, System.Types, System.UITypes, System.UIConsts, System.Rtti, System.Classes,
  System.Variants, FMX.Types, FMX.Controls, FMX.Forms, FMX.Dialogs, FMX.Objects, FMX.Layouts, AVConverter;

type
  TfrmSnapshot = class(TForm)
    lblMainTitle: TLabel;
    lblSubTitle: TLabel;
    lblWebsite: TLabel;
    imgSnap: TImage;
    RectMainTitle: TRectangle;
    RectSubTitle: TRectangle;
    RectWebsite: TRectangle;
    AVConvert: TAVConverter;

    procedure FormCreate(Sender: TObject);
    procedure FormPaint(Sender: TObject; Canvas: TCanvas; const ARect: TRectF);
    procedure FormDestroy(Sender: TObject);
    procedure AVConvertComplete(Sender: TObject);

  private
    fBitmap: TBitmap;
    fSub: String;
    fTitle: String;
    fSite: String;
    fShown, fProcessingVideo: Boolean;
    fSaveTo, fSaveVideoTo: String;
    fColorBack: Cardinal;
    fColorSub: Cardinal;
    fColorTitle: Cardinal;
    fColorSite: Cardinal;
    fOnReady, fOnFinished: TNotifyEvent;

    Procedure zp_CreateImage;
    Function zp_GetLRect(Const AControl: TControl): TRectF;
  public
    Property ColorBack: Cardinal read fColorBack write fColorBack;
    Property ColorTitle: Cardinal read fColorTitle write fColorTitle;
    Property ColorSub: Cardinal read fColorSub write fColorSub;
    Property ColorWebsite: Cardinal read fColorSite write fColorSite;
    Property SaveTo: String read fSaveTo write fSaveTo;
    Property SaveVideoTo: String read fSaveVideoTo write fSaveVideoTo;
    Property SlideTitle: String read fTitle write fTitle;
    Property SlideSubTitle: String read fSub write fSub;
    Property SlideWebsite: String read fSite write fSite;

    Procedure Process;
    Procedure ProcessVideo;
    Property OnFinished: TNotifyEvent read fOnFinished write fOnFinished;
    Property OnReady: TNotifyEvent read fOnReady write fOnReady;
  end;

var
  frmSnapshot: TfrmSnapshot;

implementation
Uses uShared.Project, AVCodec, AVLib;

{$R *.fmx}
procedure TfrmSnapshot.AVConvertComplete(Sender: TObject);
begin
  //
  if Pos('temp', Lowercase(fSaveTo)) <> 0 then
    DeleteFile(fSaveTo);

  if Assigned(fOnFinished) then
    fOnFinished(Self);
end;

procedure TfrmSnapshot.FormCreate(Sender: TObject);
begin
  //
  imgSnap.Bitmap := TBitmap.Create(Round(imgSnap.Width), Round(imgSnap.Height));
  fColorBack := claYellow;
  fColorSub := claBlack;
  fColorTitle := claBlack;
  fColorSite := claBlue;
  fTitle := 'Simple slide';
  fSub := 'Another slide';
  fSite := '';

  fBitmap := TBitmap.Create(0, 0);
  Height := 360;
  Width := 640;
end;

procedure TfrmSnapshot.FormDestroy(Sender: TObject);
begin
  //
  fBitmap.Free;
end;

procedure TfrmSnapshot.FormPaint(Sender: TObject; Canvas: TCanvas; const ARect: TRectF);
begin
  //
  if (Assigned(fOnReady)) AND (NOT fShown) then
  Begin
    fOnReady(Self);
    fShown := True;
  End;
end;

procedure TfrmSnapshot.Process;
begin
  //
  fProcessingVideo := False;
  zp_CreateImage;
  if Assigned(fOnFinished) then
    fOnFinished(Self);
end;

procedure TfrmSnapshot.ProcessVideo;
begin
  //
  fProcessingVideo := True;
  fSaveTo := Project.FolderTemp + 'snap.jpg';

  With AVConvert Do
  Begin
    if State <> csRunning then
    Begin
      zp_CreateImage;
      fBitmap.LoadFromFile(fSaveTo);

      ConvertOptions.InputFormats.Text:='bmpcap';
      InputFiles.Add(IntToStr(Integer(fBitmap)));
      OutputFiles.Text:= fSaveVideoTo;
      ConvertOptions.RecordingTime:=30*AV_TIME_BASE;
      Convert();
    End;
  End;
end;

procedure TfrmSnapshot.zp_CreateImage;
begin
  //
  RectMainTitle.Fill.Color := fColorBack;
  RectSubTitle.Fill.Color := fColorBack;
  RectWebsite.Fill.Color := fColorBack;

  With lblMainTitle Do
  Begin
    FontColor := fColorTitle;
    Text := fTitle;
  End;

  With lblSubTitle Do
  Begin
    FontColor := fColorSub;
    Text := fSub;
  End;

  With lblWebsite Do
  Begin
    FontColor := fColorSite;
    Text := fSite;
  End;

  With imgSnap.Bitmap Do
  Begin
    Clear(fColorBack);
    RectMainTitle.PaintTo(Canvas, zp_GetLRect(RectMainTitle));
    RectSubTitle.PaintTo(Canvas, zp_GetLRect(RectSubTitle));
    RectWebsite.PaintTo(Canvas, zp_GetLRect(RectWebsite));
  End;

  imgSnap.MakeScreenshot.SaveToFile(fSaveTo);
end;

function TfrmSnapshot.zp_GetLRect(const AControl: TControl): TRectF;
var
  X, Y, W, H: Single;

begin
  //
  X := AControl.Position.X;
  Y := AControl.Position.Y;
  W := X + AControl.Width;
  H := Y + AControl.Height;
  Result := TRectF.Create(X, Y, W, H);
end;

end. 
```

表单源代码：

```
object frmSnapshot: TfrmSnapshot
  Left = 0
  Top = 0
  BorderStyle = bsNone
  ClientHeight = 360
  ClientWidth = 640
  Position = poScreenCenter
  FormFactor.Width = 1920
  FormFactor.Height = 1080
  FormFactor.Devices = [dkDesktop]
  OnCreate = FormCreate
  OnDestroy = FormDestroy
  OnPaint = FormPaint
  object imgSnap: TImage
    Align = alClient
    Height = 360.000000000000000000
    Width = 640.000000000000000000
  end
  object RectMainTitle: TRectangle
    Height = 90.000000000000000000
    Position.X = 8.000000000000000000
    Position.Y = 60.000000000000000000
    Stroke.Kind = bkNone
    Width = 625.000000000000000000
    object lblMainTitle: TLabel
      Align = alClient
      Font.Family = 'Impact'
      Font.Size = 40.000000000000000000
      FontColor = claAliceblue
      StyledSettings = []
      Height = 90.000000000000000000
      Text = 'I am just some silly information. Testing Wordwrap'
      TextAlign = taCenter
      Width = 625.000000000000000000
    end
  end
  object RectSubTitle: TRectangle
    Height = 90.000000000000000000
    Position.X = 8.000000000000000000
    Position.Y = 200.000000000000000000
    Stroke.Kind = bkNone
    Width = 625.000000000000000000
    object lblSubTitle: TLabel
      Align = alClient
      Font.Family = 'Impact'
      Font.Size = 20.000000000000000000
      FontColor = claAliceblue
      StyledSettings = []
      Height = 90.000000000000000000
      Text = 'More Information'
      TextAlign = taCenter
      Width = 625.000000000000000000
    end
  end
  object RectWebsite: TRectangle
    Height = 17.000000000000000000
    Position.Y = 340.000000000000000000
    Stroke.Kind = bkNone
    Width = 640.000000000000000000
    object lblWebsite: TLabel
      Align = alClient
      Font.Family = 'Impact'
      FontColor = claAliceblue
      StyledSettings = [ssSize]
      Height = 17.000000000000000000
      Text = 'Just a website'
      TextAlign = taCenter
      Width = 640.000000000000000000
    end
  end
  object AVConvert: TAVConverter
    ConvertOptions.LimitFileSize = 9223372036854775807
    ConvertOptions.AudioOptions.AudioChannels = 0
    ConvertOptions.AudioOptions.AudioSampleRate = 0
    ConvertOptions.AudioOptions.AudioVolume = 256
    ConvertOptions.AudioOptions.AudioSyncMethod = 0
    ConvertOptions.AudioOptions.AudioDisable = False
    ConvertOptions.AudioOptions.AudioSampleFmt = sfAuto
    ConvertOptions.AudioOptions.AudioStreamCopy = False
    ConvertOptions.AudioOptions.AudioCodecTag = 0
    ConvertOptions.AudioOptions.AudioQScale = -99999.000000000000000000
    ConvertOptions.AudioOptions.AudioDriftThreshold = 0.100000001490116100
    ConvertOptions.AudioOptions.Bitrate = 0
    ConvertOptions.AudioOptions.MaxFrames = 9223372036854775807
    ConvertOptions.SubtitleOptions.SubtitleDisable = False
    ConvertOptions.SubtitleOptions.SubtitleCodecTag = 0
    ConvertOptions.VideoOptions.FrameWidth = 0
    ConvertOptions.VideoOptions.FrameHeight = 0
    ConvertOptions.VideoOptions.VideoDisable = False
    ConvertOptions.VideoOptions.VideoStreamCopy = False
    ConvertOptions.VideoOptions.VideoCodecTag = 0
    ConvertOptions.VideoOptions.IntraOnly = False
    ConvertOptions.VideoOptions.TopFieldFirst = -1
    ConvertOptions.VideoOptions.ForceFPS = False
    ConvertOptions.VideoOptions.FrameRate.num = 0
    ConvertOptions.VideoOptions.FrameRate.den = 0
    ConvertOptions.VideoOptions.MeThreshold = 0
    ConvertOptions.VideoOptions.Deinterlace = False
    ConvertOptions.VideoOptions.Pass = 0
    ConvertOptions.VideoOptions.MaxFrames = 2147483647
    ConvertOptions.VideoOptions.Bitrate = 0
    ConvertOptions.MuxerOptions.MuxPreload = 0.500000000000000000
    ConvertOptions.StartTime = 0
    ConvertOptions.RecordingTime = 9223372036854775807
    OnComplete = AVConvertComplete
    Left = 304
    Top = 200
  end
end 
```

希望这可以帮助遇到此问题的其他人。

问候安东尼

PS：抱歉忘记添加，请忽略 AVConvertor 组件，它允许我创建组件（mp4）的实际视频，以便我可以将它与另一个合并。

# javascript - Javascript 定义模块方法分配

> ID：13884092
> 
> 赞同：0
> 
> 时间：2012-12-14T18:11:54.830
> 
> 标签：javascript, module, namespaces

我正在尝试将定义模块方法添加到我的顶级命名空间，它首先定义命名空间。例如，

```
APP.define('modules.moduleName', function () { 
    return {name: 'Module 1' }; 
}); 
```

但似乎通过我的实现，存在分配问题。这是我的实现的简化示例。

```
var APP = APP || {};
APP.namespace = function( nsString ) {

    var parts  = nsString.split('.'),
        parent = this,
        i;

    if (parts[0] === 'APP') {
        parts = parts.slice(1);
    }

    for ( i = 0; i < parts.length; i++ ) {
        if (typeof parent[parts[i]] === 'undefined') {
            parent[parts[i]] = {};
        }
        parent = parent[parts[i]];
    }

    return parent;
};

// Simplified example of my define function
APP.define = function( name, definition ) {
    var namespace = APP.namespace( name );

    namespace     = definition();
    return namespace;
};

// Example Module
APP.define('modules.example', function () {

    return {
        name   : 'Application',
        module : 'APP.module'
    };
}); 
```

但是，在将命名空间分配给`definition()`. 但是`var module = APP.define('module.example', function () { /*...*/ })`有效。这也有效：

```
APP.define = function( name, definition ) {
    var namespace = APP.namespace( name );
    var module    = definition();

    for (var prop in module) {
        if (module.hasOwnProperty[prop]) {
            namespace[prop] = module[prop];
        }
    }
    return namespace;
}; 
```

一定有一些关于我缺少的对象引用或回调范围的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:58:45.763

当您将 var namespace 分配给 APP.namespace( name ) 时，您会通过引用获得命名空间的最后一部分，但这`namespace = definition()`只是将您的命名空间变量重新定义为`definition`函数的结果。

您可以合并您的`APP.namespace`，`APP.define`因此您的前父母将命名空间的最后一部分作为属性分配给`definition`功能

代码是：

```
var APP = APP || {};
APP.define = function( nsString, definition) {

    var parts  = nsString.split('.'),
        parent = this,
        i;

    if (parts[0] === 'APP') {
        parts = parts.slice(1);
    }

    for ( i = 0; i < parts.length - 1; i++ ) {
        if (typeof parent[parts[i]] === 'undefined') {
            parent[parts[i]] = {};
        }
        parent = parent[parts[i]];
    }

    parent[parts.pop()] = definition();
}; 
```

# intellij-idea - 在共享的 .iml 文件中，IntelliJ IDEA 插件 SDK 的 jdkName 应该是什么？

> ID：13884101
> 
> 赞同：2
> 
> 时间：2012-12-14T18:12:28.083
> 
> 标签：intellij-idea

我在一个团队中工作，我们在版本控制中提交我们的`.iml`文件，以便每个人都可以使用它们。我们有`.iml`一个插件模块的文件，其中包括以下内容：

```
<orderEntry type="jdk" jdkName="IDEA IC-117.798" jdkType="IDEA JDK" /> 
```

但是，这只适用于使用`IC-117.798`IntelliJ 的那个版本 (

是否有任何类型的变量`$INTELLIJ_SDK`可以用于值，`jdkName`以便`.iml`无论您使用哪个版本的 IntelliJ，文件都是有效的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T23:00:54.343

您应该同意要使用的名称，例如`IDEA SDK`或`PLUGINS SDK`。如果所有的开发者都将有一个 SDK 在`Project Structure`| `SDKs`使用相同的名称，它可以在所有机器上运行而无需更改。

# javascript - if 条件块记录一条消息，但仍在 else 块中设置变量

> ID：13884104
> 
> 赞同：0
> 
> 时间：2012-12-14T18:12:34.470
> 
> 标签：javascript, jquery

所以我有这个javascript函数reOrderJSON，它对数组排序，如果参数`order`等于“反转”，它会在数组排序后立即反转数组。

我还有一个绑定到关联链接的点击事件的函数。

```
function reOrderJSON(subj,att,order,limit){

    subj.sort(function (a, b,order) {

        a = a[att],
        b = b[att];

        return a.localeCompare(b);

    });

    if(order === "reverse"){
        subj.reverse();
        console.log("Reverse passed a parameter to reOrderJSON")
    }

    layoutDate(subj,limit)
    return depos = subj;
}

function clickReorder(e){
        var orderingLink = e.target;
        var reverseOrder = "";

        var order = $(orderingLink).attr('data-order');
        if(order === "desc" || order === "undefined"){
            $(orderingLink).attr('data-order','asc');
            console.log("Order detected as "+order)
            reverseOrder = false;

        }else{
            $(orderingLink).attr('data-order','desc');
            console.log("Order detected as "+order)

            reverseOrder = "reverse";
        }

        var limit = $('.entries-per-page').val();

        reOrderJSON(e.data.orderedObject,$(e.target).data('assoc'),reverseOrder,limit);

        $('.result th').css('background','transparent');
        $(orderingLink).closest('th').css({'background':'pink'});

        return false;
}

$('.result').on("click", "th a", { orderedObject: depos }, clickReorder); 
```

链接一开始是这样的：

```
<th><a href="#" data-assoc="county">County</a></th> 
```

如您所知，我正在记录一些调试文本以说明发生了什么。第一次单击链接时，我总是在日志中返回这两行： `Order detected as undefined` `Reverse passed a parameter to reOrderJSON`

我不明白这是怎么回事，`order`不应该作为`"reverse"`第一次通过。我在这里想念什么？

`depos`是一个数组对象，如果这有什么不同的话。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:16:25.160

你的比较

```
order === "undefined" 
```

当前正在检查字符串“ `undefined`”，但您实际上想要检查变量中的未定义值。

你真的想要：

```
order == undefined   // no quotes -- it's not a string 
```

或者，甚至更好：

```
typeof order == "undefined" 
```

因为`undefined`可以在非严格模式下被覆盖。

# android - Android Google Maps v2 - 将对象添加到标记

> ID：13884105
> 
> 赞同：25
> 
> 时间：2012-12-14T18:12:44.750
> 
> 标签：android, google-maps-markers, google-maps-android-api-2

我们如何在新的**Google Maps Android API v2**中将对象添加到标记？所以如果我们点击`InfoWindow`，我们可以对这个对象做点什么吗？

```
public void addSpotOnMap(Spot spot) {
    getMap().addMarker(new MarkerOptions()
            .position(new LatLng(spot.getParseGeoPoint().getLatitude(), spot.getParseGeoPoint().getLongitude()))
            .title(spot.getName())
            .snippet(spot.getCategory())
            .draggable(false));

} 
```

这会设置对象的位置、标题和片段。但是，如果我单击`InfoWindow`

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-16T15:17:29.770

不确定这是否是正确的答案，但请查看我针对此问题所做的这篇博文：

因为`Marker`is `final`，所以这可以通过将数据与`Marker`a链接来轻松解决`Map`，例如`HashMap<Marker, YourDataClass>`或`HashMap<Marker, String>`

这是一个解释所有内容的教程：http: [//bon-app-etit.blogspot.be/2012/12/add-informationobject-to-marker-in.html](http://bon-app-etit.blogspot.be/2012/12/add-informationobject-to-marker-in.html)

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-10-28T09:49:59.640

从 Play Services v9.4.0 开始，您现在可以直接在标记上设置任何对象！

要保存数据：

```
Marker marker = getMap().addMarker(new MarkerOptions()
        .position(lat, lng)
        .title(spot.getName());

CustomObject myData = new CustomObject();
marker.setTag(myData); 
```

然后检索您的数据：

```
CustomObject myRestoredData = (CustomObject)marker.getTag(myData); 
```

有关标记数据的更多信息，[请参阅文档](https://developers.google.com/maps/documentation/android-api/marker#marker-data)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-01T12:25:02.213

尝试[android-maps-extensions](https://github.com/mg6maciej/android-maps-extensions)它的库，您可以在其中添加对象以通过 setdata 方法标记并检索数据调用方法 getData

[阅读更多](https://github.com/mg6maciej/android-maps-extensions/wiki)

```
Object getData() and setData(Object) on Marker, Circle, GroundOverlay, Polygon, Polyline or TileOverlay 
```

从 Gradle 您可以使用任何版本的 Google Play 服务

```
dependencies {
    compile 'com.androidmapsextensions:android-maps-extensions:2.2.0'
    compile 'com.google.android.gms:play-services-maps:8.1.0'
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-12T22:55:29.400

将对象添加到地图上后，您可以在标记内绑定对象，例如：

```
MarkerOptions markerOptions = new MarkerOptions().position(YOUR_LANG_LAT).title(YOUR_TITLE);
Marker addedMarker = mMap.addMarker(markerOptions);
CustomObject obj = new CustomObject();
addedMarker.setTag(obj); 
```

然后在地图上单击例如，您可以将对象检索为：

```
mMap.setOnMarkerClickListener(marker -> {
    CustomObject obj = (CustomObject) marker.getTag();

    return false;
}); 
```

# bash - 如何连接标准输入和字符串？

> ID：13884108
> 
> 赞同：133
> 
> 时间：2012-12-14T18:12:49.683
> 
> 标签：bash

如何将标准输入连接到一个字符串，像这样？

```
echo "input" | COMMAND "string" 
```

并得到

```
inputstring 
```

* * *

## 回答 #1

> 赞同：156
> 
> 时间：2012-12-14T18:24:31.707

有点hacky，但这可能是执行您在问题中提出的最短方法（使用管道从`stdout`另一个进程/命令接受：`echo "input"``stdin`

```
echo "input" | awk '{print $1"string"}' 
```

输出：

```
inputstring 
```

你到底想完成什么任务？更多上下文可以为您提供更好的解决方案的更多方向。

**更新 - 回复评论：**

@诺姆罗斯

做你想做的事的更惯用的方法是：

```
echo 'http://dx.doi.org/'"$(pbpaste)" 
```

该`$(...)`语法称为[命令替换](http://tldp.org/LDP/abs/html/commandsub.html)。简而言之，它执行包含在新子 shell 中的命令，并将其`stdout`输出替换为`$(...)`在父 shell 中调用的位置。所以你会得到，实际上：

```
echo 'http://dx.doi.org/'"rsif.2012.0125" 
```

* * *

## 回答 #2

> 赞同：69
> 
> 时间：2012-12-14T20:51:05.303

用于`cat -`从标准输入读取，并将其放入`$()`以丢弃尾随的换行符

```
echo input | COMMAND "$(cat -)string" 
```

但是，为什么不放下管道并在命令替换中获取左侧的输出：

```
COMMAND "$(echo input)string" 
```

* * *

## 回答 #3

> 赞同：61
> 
> 时间：2015-10-15T03:04:10.567

我经常使用管道，所以这往往是一种为标准输入添加前缀和后缀的简单方法：

```
echo -n "my standard in" | cat <(echo -n "prefix... ") - <(echo " ...suffix")
prefix... my standard in ...suffix 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2014-12-05T12:05:20.440

There are some ways of accomplish this, i personally think the best is:

```
echo input | while read line; do echo $line string; done 
```

Another can be by substituting "$" (end of line character) with "string" in a sed command:

```
echo input | sed "s/$/ string/g" 
```

Why i prefer the former? Because it concatenates a string to stdin instantly, for example with the following command:

```
(echo input_one ;sleep 5; echo input_two ) | while read line; do echo $line string; done 
```

you get immediatly the first output:

```
input_one string 
```

and then after 5 seconds you get the other echo:

```
input_two string 
```

On the other hand using "sed" first it performs all the content of the parenthesis and then it gives it to "sed", so the command

```
(echo input_one ;sleep 5; echo input_two ) | sed "s/$/ string/g" 
```

will output both the lines

```
input_one string
input_two string 
```

after 5 seconds.

This can be very useful in cases you are performing calls to functions which takes a long time to complete and want to be continuously updated about the output of the function.

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2014-02-15T08:29:54.073

You can do it with sed:

```
seq 5 | sed '$a\6'
seq 5 | sed '$ s/.*/\0 6/' 
```

In your example:

```
echo input | sed 's/.*/\0string/' 
```

* * *

## 回答 #6

> 赞同：10
> 
> 时间：2015-09-29T15:50:16.727

我知道这已经晚了几年，但您可以使用 xargs -J 选项完成此操作：

```
echo "input" | xargs -J "%" echo "%" "string" 
```

由于它*是*xargs，因此您可以一次在文件的多行上执行此操作。如果文件“名称”有三行，例如：

```
Adam
Bob
Charlie 
```

你可以这样做：

```
cat names | xargs -n 1 -J "%" echo "I like" "%" "because he is nice" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2012-12-14T18:23:26.387

您发布的命令会将字符串“input”用作 COMMAND 的 stdin 流，除非 COMMAND 首先打印出其 stdin 的内容，然后打印出其命令行参数，否则不会产生您正在寻找的结果。

您想要做的似乎更接近命令替换。

[http://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html#Command-Substitution](http://www.gnu.org/software/bash/manual/html_node/Command-Substitution.html#Command-Substitution)

使用命令替换，您可以使用如下命令行：

```
echo input `COMMAND "string"` 
```

这将首先使用“字符串”作为输入评估 COMMAND，然后将该命令执行的结果展开到一行，替换 '`' 字符之间的内容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2019-03-25T09:40:32.510

猫将是我的选择：`ls | cat - <(echo new line)`

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-04-01T18:31:43.560

也有效：

```
seq -w 0 100 | xargs -I {} echo "string "{} 
```

将生成如下字符串：

```
string 000
string 001
string 002
string 003
string 004 
```

...

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2021-03-18T10:24:09.657

我想在运行之前在我的 sql 脚本前面加上“set”语句。所以我回应了“set”指令，然后将它传递给 cat。命令 cat 有两个参数：标记为“-”的 STDIN 和我的 sql 文件，cat 将它们都连接到一个输出。接下来，我将结果传递给 mysql 命令以将其作为脚本运行。

```
echo "set @ZERO_PRODUCTS_DISPLAY='$ZERO_PRODUCTS_DISPLAY';" | cat - sql/test_parameter.sql | mysql 
```

ps mysql登录名和密码存储在`.my.cnf`文件中

# php - 为什么 php cli 在 `echo` 命令后不添加换行符？

> ID：13884109
> 
> 赞同：0
> 
> 时间：2012-12-14T18:12:53.967
> 
> 标签：php, interactive-shell

自从升级到 php 5.4，发出 echo 命令不再包括自动换行符。为了获得类似的行为，您现在必须附加自己的行为；否则，您会在与输出相同的行上得到提示。

```
php > echo "some output";
some outputphp >

some outputphp > echo "some output", "\n";
some output
php > 
```

是否有配置选项可以打开它们？

# ruby-on-rails - 无法更改 rbenv 全局 ruby 版本

> ID：13884110
> 
> 赞同：2
> 
> 时间：2012-12-14T18:12:53.860
> 
> 标签：ruby-on-rails, rbenv

我最近从 RVM 切换到 rbenv，我似乎无法在 ruby​​ 版本之间切换，即使“rbenv 版本”告诉我我有想要切换到的版本。

这是我在做什么：

```
ruby -v
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0] 
```

我想切换到 1.9.2-p290，所以请确保我的版本中有它：

```
ruby versions
1.8.7-p370
1.9.2-p290
1.9.3-p125
1.9.3-rc1 
```

好的，现在我看到我拥有它了，让我们尝试更改全局 rbenv：

```
rbenv global 1.9.2-p290
ruby -v
ruby 1.8.7 (2012-02-08 patchlevel 358) [universal-darwin12.0] 
```

似乎 1.8.7 仍然是活跃的全球红宝石。

因此，让我们尝试在我的项目中将其本地化。rbenv 本地 1.9.2-p290

这会在我的 rails 项目中创建一个 .rbenv-versions 文件。太好了，让我们尝试运行 bundle：

```
Gem::InstallError: factory_girl requires Ruby version >= 1.9.2.
An error occurred while installing factory_girl (4.1.0), and Bundler cannot continue.
Make sure that `gem install factory_girl -v '4.1.0'` succeeds before bundling. 
```

我不确定下一步该怎么做...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-09-12T20:45:28.273

我今天在朋友的（OSX）电脑上解决了这个问题，问题可能是你同时安装了RVM和Rbenv，首先你必须确保RVM被删除；

在终端执行：

```
sudo rm -rf ~/.rvm 
```

完成后，重新打开终端。那就试试看`ruby -v`，你看到的版本大概是系统版本**ruby 1.8.7**。然后再次尝试使用 Rbenv 选择正确的 Ruby 版本：

```
rbenv global 2.0.0-p247 
```

另外，请确保 Rbenv 在您的路径中：

```
echo $PATH
=> /Users/jankeesvw/.rbenv/bin:/Users/jankeesvw/.rbenv/shims:/Users/jankeesvw/.rbenv/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/mysql/bin 
```

如果此 Rbenv 不在您的路径中，请按照[Rbenv github 页面上的说明进行操作](https://github.com/sstephenson/rbenv)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-24T18:39:29.370

如果`$ echo $PATH`

没有 .rbenv 然后执行：

```
$ echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.bash_profile
$ echo 'eval "$(rbenv init -)"' >> ~/.bash_profile 
```

并重新启动外壳。

# c# - 即使指定了“return”，方法中的验证也会继续运行其余代码

> ID：13884112
> 
> 赞同：1
> 
> 时间：2012-12-14T18:13:03.287
> 
> 标签：c#, .net, methods, return

如果从另一个方法调用，我的代码不会在真实条件下终止。例如，

```
void RunValidation()
{
    if (NameEntered == string.Empty)
    {
        MessageBox.Show("No name has been entered");
        return;
    }
}

void CreateUser()
{
    RunValidation();

    //Run more code
} 
```

如果我在 create user 方法中调用验证方法，则会显示消息框，但即使指定了“return”，其余代码也会被执行。

如果验证代码不在方法内并直接在 CreateUser 方法中调用，则其余代码不会运行（这是我想要的）。我希望能够在许多其他方法中调用验证方法，如果条件为真，则停止执行方法中的其他代码。

这样做的正确方法是什么？我必须使用某种尝试和捕捉吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:15:55.513

您是从`RunValidation`方法返回，而不是从`CreateUser`方法返回。如果要`CreateUser`根据 的结果控制方法的流程`RunValidation`，请执行以下操作：

```
bool Validate()
{
    if (NameEntered.Equals(string.Empty))
    {
        MessageBox.Show("No name has been entered");
        return false;
    }
    return true;
}

void CreateUser()
{
    if (Validate())
    {
        // Run more code
    }
} 
```

该`return`语句仅影响当前方法。[在此处](http://msdn.microsoft.com/en-us/library/1h3swy84.aspx)阅读有关该`return`声明的更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:15:42.787

`return;`退出`RunValidation()`方法。
它对调用它的函数没有影响。

相反，您应该`RunValidation()`返回一个布尔值，指示验证是否成功。
在调用方法中，您可以检查它是否返回`false`以及`return;`从那里返回。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:17:32.563

you can do something like:

```
bool RunValidation()
{
    if (NameEntered == string.Empty)
    {
        MessageBox.Show("No name has been entered");
        return false;
    }
    return true;
}

void CreateUser()
{
    if(RunValidation())
    {

        //Run more code
     }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T18:19:38.333

你在谈论这个代码块吗？

```
void RunValidation()
{
    if (NameEntered == string.Empty)
    {
        MessageBox.Show("No name has been entered");
        return;
    }
} 
```

因为如果你是，我不知道它正在执行什么“其余代码”，因为在 return 语句之后没有代码。

如果你在谈论这个

```
void CreateUser()
{
    RunValidation();

    //Run more code
} 
```

那么是的，仅仅因为`RunValidation`有一个 return 语句并不意味着它的调用方法会返回。这种行为会导致疯狂的错误。

* * *

现在，为了实现 yoru 预期的行为，您可以更改`runValidation`为

```
bool RunValidation()
{
    if (NameEntered == string.Empty)
    {
        MessageBox.Show("No name has been entered");
        return false;
    }
    return true;
} 
```

然后像这样称呼它

```
void CreateUser()
{
    if(RunValidation())
    {

        //Run more code
    }
} 
```

# java - Joda - 确定当前时间是否在指定的每周时间段内

> ID：13884113
> 
> 赞同：2
> 
> 时间：2012-12-14T18:13:12.873
> 
> 标签：java, scala, datetime, jodatime

我在一周中的不同时间收到订单，并且我有一套规则来确定我们何时可以接受和不能接受订单。例如，我们不接受星期三下午 4:45 到 5:15 之间的订单。因此，如果在下午 3 点收到订单，一切都很好。如果在下午 5 点收到订单，我们将需要拒绝它。这些规则基于星期几，并且每天都在变化。

我的问题是使用 joda 时间，检查当前时间是否在此时间窗口内的最佳方法是什么？

我对其他技术持开放态度，但是我目前正在通过 scala 工具时间包装器使用 joda time。

我目前正在处理这样的事情：

```
 val now = DateTime.now
  val wednesdayNoTradeInterval:Interval = ??

  now.getDayOfWeek match {
    case WEDNESDAY => wednesdayNoTradeInterval.contains(now)
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:03:58.297

你可以尝试这样的事情：

```
implicit def dateTimeToLocalTime(dateTime: DateTime) = dateTime.toLocalTime
type Interval[T] = (T, T)
def during(interval: Interval[LocalTime])(time: LocalTime) = interval match {
  case (start, end) => start < time && time < end
}

def day(day: Int)(time: DateTime) = time.dayOfWeek.get == day

val fourish = new LocalTime(16, 45)
val afternoon = during((fourish, (fourish + (30 minutes)) )) _
val wednesday = day(WEDNESDAY) _
val thursday = day(THURSDAY) _
def acceptingOrders = !{
  val now = DateTime.now
  wednesday(now) && afternoon(now)
  thursday(now) && afternoon(now)
} 
```

并像这样使用它：

```
acceptingOrders  // ? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:30:03.947

For each day of the week, store a list of pairs of LocalTime instances between which orders are rejected.

Then when an order is placed at a given DateTime, get the pairs associated with the dateTime's day of week, transform the DateTime into a LocalTime, and check if this LocalTime is contained between the start and end of at least one pair.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:27:48.647

查看 JChronic 中的 Span 类：[https ://github.com/samtingleff/jchronic/blob/master/src/main/java/com/mdimension/jchronic/utils/Span.java](https://github.com/samtingleff/jchronic/blob/master/src/main/java/com/mdimension/jchronic/utils/Span.java)

创建类似的东西并执行 !<> 检查以毫秒为单位的时间将是微不足道的。

# jquery - 主干.js 一次获取页面

> ID：13884128
> 
> 赞同：1
> 
> 时间：2012-12-14T18:14:10.900
> 
> 标签：jquery, backbone.js

我正在创建一个单页滚动站点。这意味着来自 json 的所有数据都会一次加载，并且每次哈希更改时都不需要多次获取数据。

```
var AppRouter = Backbone.Router.extend({
routes: {
    ""          : "index",
    ":page" : "page"
},

index: function() {
    console.log('list');
    this.init = new WH.ExperienceCollection();
    this.book = new WH.ExperienceBook({model: this.init});
    this.init.fetch();
},

page: function(page) {
    this.init = new WH.ExperienceCollection();
    this.book = new WH.ExperienceBook({model: this.init});
    this.init.fetch({success: function(data){
        WH.utils.resize();
        $('html,body').stop(true, true).animate({scrollTop: $('#'+page).offset().top}, 500);
    }});
} 
```

});

是我的路线。当哈希更改时，我希望它向下滚动到该部分。现在页面继续获取并添加到页面上已有的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:03:43.517

如果集合已被提取，您应该存储在一个变量中。然后，根据这个变量，是否重新获取。

例如：

```
var AppRouter = Backbone.Router.extend({

    init: new WH.ExperienceCollection(),
    book: new WH.ExperienceBook({model: this.init}),
    fetched: false,

    routes: {
        ""          : "index",
        ":page" : "page"
    },

    index: function() {
        console.log('list');
        this.init = new WH.ExperienceCollection();
        this.book = new WH.ExperienceBook({model: this.init});
        this.init.fetch();
    },

    page: function(page) {
        var self = this;
        if( this.fetched ) {
            render();
        } else {
         this.init.fetch({success: render});
        }

        function render(){
            self.fetched = true;
            Westin.utils.resize();
            $('html,body').stop(true, true).animate({scrollTop: $('#'+page).offset().top}, 500);
        }
    }
}); 
```

*根据您的收藏中的内容，可能还有其他解决方案。但作为一个全球性的答案，这是最普遍的情况。但是例如，您还可以测试集合长度以查看它是否已填满，或者检查模型上是否存在值等等。这个想法是让一些东西告诉您集合/模型是否获取与否。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T20:10:34.607

如果每条路由（或许多路由）都需要它，则将[其放入路由器的`initialize`函数](http://jsfiddle.net/j2mF4/3/)中：

```
var AppRouter = Backbone.Router.extend({
    initialize: function() {
        if (!this.init) {
            console.log("fetching init...");
            this.init = WH.ExperienceCollection();
            this.book = new WH.ExperienceBook({ model: this.init });
            this.init.fetch();
        } else {
            console.log("init already fetched!");
        }
    },
}); 
```

这将在第一次加载页面时运行一次。

# jquery - 图像滑块滑入/滑出

> ID：13884129
> 
> 赞同：1
> 
> 时间：2012-12-14T18:14:11.003
> 
> 标签：jquery, jquery-animate

我试图让动画滑出第一张图像，然后滑入第二张图像，滑出第二张图像，滑入第三张图像等等，因为代码表示每个图像都可以很好地滑出但淡入而不是滑动。

```
var s = 0,
    t = 2000;

$(document).on('ready', slide);

function slide(){
 var speed = setInterval(slider, t);
}

function slider(){
 s++;
 var sld  = $('#slider img'),
     imgs = sld.length;
 if(s == imgs){
 s = 0;
 }

sld.animate({'marginLeft': '+=750px'}, t).fadeOut('fast').animate({'marginLeft': '-=750px'}, t).eq(s).fadeIn(t);
} 
```

[jFiddle 演示](http://jsfiddle.net/EVSkT/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:24:20.703

尝试用 .slideToggle 替换 .fadeOut/.fadeIn

```
sld.animate({'marginLeft': '+=750px'}, t)
    .slideToggle('fast')
    .animate({'marginLeft': '-=750px'}, t)
    .eq(s)
    .slideToggle(t); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:12:46.343

我们应该首先使用无序列表 ( `<ul>`) 稍微改变一下结构：

```
<div id="slider">
    <ul>
        <li><img src="http://placehold.it/750x250/75c8c8/fff&text=1"></li>
        <li><img src="http://placehold.it/750x250/b775c8/fff&text=2"></li>
        <li><img src="http://placehold.it/750x250/c8bd75/fff&text=3"></li>
        <li><img src="http://placehold.it/750x250/c87575/fff&text=4"></li>
    </ul>
</div>​ 
```

然后我们应该使用 a`setTimeout()`而不是 setInterval 以确保在动画完成后启动下一张幻灯片：

```
var s = 0,
    t = 2000,
    timer;

$(document).on('ready', slide);

function slide(){
    timer = setTimeout(slider, t);
}

function slider(){
    s++;
    var sld  = $('#slider li'),
    imgs = sld.length;
    if(s == imgs){
        s = 0;
    }
    sld.eq(s-1).animate({'left': '750px'}, t, function() {
        sld.eq(s).animate({'left': '0px'}, t, function() {
            speed = setTimeout(slider, t);
        });
    });
} 
```

这样，我们将图像向右滑动，然后向左滑动下一张，最后再次调用“slider()”函数并超时。

为了完成这项工作，我们需要像这样更改 css 代码：

```
#slider {
    height:250px;
    width:750px;
    margin:20px auto;
}

#slider ul {
    width: 100%;
    height: 100%;
    list-style: none;
    overflow: hidden;
    border: 1px solid grey;
    position: relative;
}

#slider​ ul li {
    position: absolute;
    left: 750px;
}

#slider ul li​:first-child {
    left: 0px;
}​ 
```

在这里你可以看到一个**[DEMO](http://jsfiddle.net/Dim13i/EVSkT/13/)**

# linq-to-sql - LINQ to SQL：基于用户输入的 where 子句过滤器

> ID：13884130
> 
> 赞同：0
> 
> 时间：2012-12-14T18:14:23.330
> 
> 标签：linq-to-sql

在 UI 中，有一个为参数“字段”取值的下拉菜单。它可以是一个特定的值，或者“全部”是默认值，其中需要检索所有行而不考虑“字段”值。

如何在 LINQ 中编写 Where 子句，以便如果用户为字段列提供值，则将其用作过滤器，否则从数据库中获取所有行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:21:14.097

您可以将`IQueryable<T>`其用作 LINQ 查询的基础并附加到您需要的所有内容：

例子：

```
 string userInput = "";
        using (var context = new EntityModel())
        {
            IQueryable<MyEntity> query = context.MyEntities;

            if (!String.IsNullOrWhiteSpace(userInput))
                query = query.Where(x => x.MyFilterableProperty == userInput);

            return query.ToList();
        } 
```

# c++ - 在 QSpinBox 中以编程方式“全选”

> ID：13884131
> 
> 赞同：1
> 
> 时间：2012-12-14T18:14:24.637
> 
> 标签：c++, qt, qt4

有没有办法做到这一点？要手动执行此操作，我右键单击旋转框内部并选择“全选”。最终目标是将旋转框呈现在“选定”状态。我想知道这是否可以在不继承 QSpinBox 的情况下完成（出于纯粹的懒惰）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:48:23.500

QSpinBox 继承了 QAbstractSpinBox，它有一个名为`selectAll()`.

[http://doc.qt.io/qt-4.8/qspinbox.html](http://doc.qt.io/qt-4.8/qspinbox.html)

[http://doc.qt.io/qt-4.8/qabstractspinbox.html#selectAll](http://doc.qt.io/qt-4.8/qabstractspinbox.html#selectAll)

[http://doc.qt.io/qt-4.8/qspinbox-members.html](http://doc.qt.io/qt-4.8/qspinbox-members.html)

希望有帮助。

# jquery - 不允许通过 REST api 和 jquery 405 方法创建 Jira 问题

> ID：13884132
> 
> 赞同：3
> 
> 时间：2012-12-14T18:14:27.047
> 
> 标签：jquery, rest, jira, http-status-code-405

使用以下 jquery 调用时，我收到 http 405 method not allowed 错误消息。有谁知道如何解决这个问题？是因为https吗？我也尝试使用 GET 和 PUT 类型，结果相同

```
 function make_base_auth(user, password) {
        var tok = user + ':' + password;
        var hash = btoa(tok);
        return "Basic " + hash;
    }   
function createJiraIssue() {

        var datos = {
            "fields": {
                "project":
              {
                  "key": "HELP"
             },
                "summary": "Test Ticket",
                "description": "Creating of an issue using project keys and issue type  names using the REST API",
                "issuetype": {
                    "name": "Bug"
                },
                "assignee": { "name": "sim" }
            }
        };

        var parameters = JSON.stringify(datos);
        var req = $.ajax({
            url: 'https://xxx.jira.com/rest/api/2/issue/',
            type: "POST",
            data: parameters,
            contentType: 'application/jsonp',
            dataType: 'jsonp',
            async: false,
            processData: false,
            beforeSend: function (xhr) {
            xhr.setRequestHeader('Authorization', make_base_auth(user, password));
            },
            error: function (errmsg) {
                alert('error ocured:' + errmsg.responseText);
            },
            success: function (text) {
                alert(text);
            },

        });
    } 
```

编辑它必须是 contentType: 'application/json', dataType: 'json' 并且 405 错误消失。

但现在代码最终出现在错误回调中。我将其中的警报功能更改为 alert('error ocured:' + errmsg.error); 它给了我这个：错误发生：

```
function (){
if(!e){
  var c=arguments,g,h,i,j,k;b&&(k=b,b=0);
  for(g=0,h=c.length;
        g<h;g++)i=c[g],j=d.type(i),j==="array"?f.done.apply(f,i):j==="function"&&a.push(i);
        k&&f.resolveWith(k[0],k[1])
 }return this
} 
```

在 chrome 中，我在控制台中收到错误： XMLHttpRequest cannot load `https://xxx.jira.com/rest/api/2/issue/`。Access-Control-Allow- Origin`http://localhost:49592`不允许 Origin。有人知道错误是什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T09:05:11.693

I'm not sure if it's possible. The error you got is saying that you can't do cross domain XMLHttp Request. you can find more information on [this answer](https://stackoverflow.com/questions/7098662/still-confused-about-using-xmlhttprequest-cross-domain).

One way to go around it, is to create a local API, using php (or any other language), that will serve the ajax calls made by jQuery.

For example, write a [PHP page](https://bitbucket.org/miknight/atlassian-example-scripts/src/e2f2dea9e8ed/jira_create_issue.php) that will create issues via the [REST API](http://docs.atlassian.com/jira/REST/latest/), then use the javascript to post to this page all the needed details.

Let me know if you need any help.

**EDIT**

to do it using C#, The easiest way ill probably be using something like [JiraRestClient.NET](https://bitbucket.org/MikeJansen/jirarestclient.net/wiki/Home).

If you prefer to code it yourself, here is some info about [connecting to Jira using REST](http://maffelu.net/jira-basic-cjira-connection-using-rest).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:17:19.767

Your content type should be `'application/json'`, not `'application/jsonp'`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-30T15:38:50.453

I had the same issue and was due to the fact I was using HTTP instead of HTTPS.

# tomcat - InteliJ 10 + Tomcat 7：无法访问 localhost:8080/manager/status

> ID：13884134
> 
> 赞同：1
> 
> 时间：2012-12-14T18:14:33.217
> 
> 标签：tomcat, intellij-idea, tomcat7

目前有 InteliJ10 + Tomcat 7 + Hibernate + Oracle 的设置。我通常通过 InteliJ 和调试器进行开发和测试。

我正在尝试导航到`http://localhost:8080/manager/status`

但是，我收到错误消息：401 Unauthorized。我按照页面上的说明去解决创建“manager-gui”角色的问题。我已尝试按照说明将其添加到 conf/tmocat-users.xml 文件中，并尝试再次在调试中运行我的应用程序。

但是，我仍然无法访问该页面。在 InteliJ 中查看我的 Tomcat 日志输出，我看到以下内容：

```
org.apache.catalina.realm.JAASRealm authenticate
SEVER: Unexpected error
java.lang.SecurityException: Unable to locate a login configuration
... 
```

现在我想这意味着我需要在我的 vm 参数中添加一些参数，以便在调试中启动服务器或进入我的调试环境变量并在那里添加一些内容以附加 JAVA_OPTS && CATALINA_OPTS。

问题是在哪里？任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T23:15:00.663

请注意，IDEA 会在[%SYSTEM%](http://devnet.jetbrains.net/docs/DOC-181)`\Tomcat\%CONFIGURATION%\conf`目录下复制您的 Tomcat 配置。

更改原始Tomcat配置后需要重新启动服务器，重新启动后临时目录`tomcat-users.xml`中应该可以找到修改后的副本。`CATALINA_BASE`

我已经验证它工作正常。另一件要检查的事情`<user...`是没有注释的行。使用一些带有语法突出显示的编辑器，以确保您的用户是在注释块之外定义的：

![tomcat-users.xml](../Images/28c608d90f19023c2687dafa8804da26.png)

# rest - HTTP 响应标头通知客户端已弃用 API 的约定

> ID：13884141
> 
> 赞同：97
> 
> 时间：2012-12-14T18:14:47.230
> 
> 标签：rest, http, http-status-codes, deprecation-warning

我正在升级我们的 REST API 端点，并且我想在客户端调用将被弃用的端点时通知他们。
我应该在响应中使用什么标头，并带有类似于“此 API 版本已被弃用，请查阅最新文档以更新您的端点”的消息

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2015-04-14T09:29:16.470

我不会更改状态代码中的任何内容以向后兼容。我会在响应中添加一个“警告”标题：

```
Warning: 299 - "Deprecated API" 
```

您还可以在发出警告的“代理”中指定“-”，并在警告文本中更明确：

```
Warning: 299 api.blazingFrog.com "Deprecated API: use betterapi.blazingFrog.com instead. Old API maintained until 2015-06-02" 
```

此处指定了警告标头：[https](https://www.rfc-editor.org/rfc/rfc7234#section-5.5) ://www.rfc-editor.org/rfc/rfc7234#section-5.5 。警告代码 299 是通用的，“已弃用”不是标准的。

您必须告诉您的 API 客户端记录 HTTP 警告并对其进行监控。

直到现在我才使用它，但是当我的公司在 Rest API 方面更加成熟时，我会集成它。

> 编辑（2019-04-25）：正如@Harry Wood 提到的那样，警告标头位于文档中与缓存相关的一章中。但是，RFC 很明确`Warnings can be used for other purposes, both cache-related and otherwise.`
> 
> 如果您更喜欢替代方法，此草案[https://datatracker.ietf.org/doc/html/draft-dalal-deprecation-header-00](https://datatracker.ietf.org/doc/html/draft-dalal-deprecation-header-00)建议使用新标题“弃用”。

> 编辑（2021-01-04）：正如@Dima Parzhitsky 提到的那样，MDN 说这个[标头已被弃用](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Warning)

* * *

## 回答 #2

> 赞同：42
> 
> 时间：2013-03-01T15:17:24.687

您可以使用[410 (Gone)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4.11)。

以下是 W3C 的[状态代码定义](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)对它的描述：

> ## 410（消失）
> 
> 请求的资源在服务器上不再可用，并且不知道转发地址。预计这种情况将被视为永久性的。具有链接编辑能力的客户端应该在用户批准后删除对 Request-URI 的引用。如果服务器不知道或无法确定条件是否是永久的，则应该使用状态代码 404（未找到）。除非另有说明，否则此响应是可缓存的。
> 
> 410 响应的主要目的是通过通知接收者该资源故意不可用并且服务器所有者希望删除到该资源的远程链接来协助 Web 维护任务。这种事件对于限时促销服务和属于不再在服务器站点工作的个人的资源很常见。不必将所有永久不可用的资源标记为“已消失”或将标记保留任意时间——这由服务器所有者自行决定。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2012-12-14T18:20:47.547

我会/已经选择[301](https://www.rfc-editor.org/rfc/rfc2616)（永久移动） 300 系列代码应该告诉客户他们有行动要做。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2019-03-25T16:45:23.213

完善@dret 的回复。有两个相关的 HTTP 标头用于弃用：( `Deprecation`https://datatracker.ietf.org/doc/html/draft-dalal-deprecation-header-00 [)](https://datatracker.ietf.org/doc/html/draft-dalal-deprecation-header-00)和`Sunset`.

要通知用户计划的弃用，`Deprecation`应使用 HTTP 标头。这表明端点将在未来*某个时间被丢弃。*它还允许您指明发布日期，并描述替代资源。

为了通知用户已弃用资源的计划日落日期，`Sunset`除了 Deprecation 标头之外，还应使用标头。这在第 #5 节[https://datatracker.ietf.org/doc/html/draft-dalal-deprecation-header-00#section-5](https://datatracker.ietf.org/doc/html/draft-dalal-deprecation-header-00#section-5)中进行了描述。

标题草案 #11 [https://datatracker.ietf.org/doc/html/draft-wilde-sunset-header-11](https://datatracker.ietf.org/doc/html/draft-wilde-sunset-header-11)在第 1.4 节[https://datatracker.ietf.org/doc/html](https://datatracker.ietf.org/doc/html/draft-wilde-sunset-header-11#section-1.4)`Sunset`中也阐明了这一方面[/draft-wilde-sunset-header-11#section-1.4](https://datatracker.ietf.org/doc/html/draft-wilde-sunset-header-11#section-1.4)。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-03-16T21:14:23.970

我会推荐一个[`207 Multi-Status`](https://httpstatuses.com/207)响应，表明它是一个成功的响应，但它也可能具有第二个弃用状态。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2019-01-15T00:20:58.783

有一个名为的 HTTP 标头字段`Sunset`旨在表示即将弃用的资源。[https://datatracker.ietf.org/doc/html/draft-wilde-sunset-header](https://datatracker.ietf.org/doc/html/draft-wilde-sunset-header)正处于成为 RFC 的最后阶段。理想情况下，您的 API 应该记录它将要使用`Sunset`的 ，以便客户可以查找它并根据需要采取行动。

# android - 当活动在“主页”按钮后暂停时如何暂停服务？

> ID：13884144
> 
> 赞同：0
> 
> 时间：2012-12-14T18:15:12.973
> 
> 标签：android, android-service

我有一个看起来 gps 坐标的服务。我希望当用户单击主页按钮时 gps 停止工作（省电）。

我使用的策略是这样的：

```
 @Override
public void onPause() { 
    super.onPause();
    doUnbindService();
}

@Override
public void onResume() {
    super.onResume();
    doBindService();  
} 
```

在使用该服务的每个 Activity 上。问题是每次我切换活动时它都会停止并恢复。是否有一种策略可以让我的服务始终处于运行状态，直到我的应用程序处于前台状态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:27:16.693

我有一个包含 3 个活动的应用程序，这些活动使用服务来处理 GPS。在每个活动的 onStart() 我有形式的代码

```
bindService(new Intent(..., ..., Context.BIND_AUTO_CREATE); 
```

在每个 onStop() 我有

```
unbindService(..); 
```

您应该会发现活动 2 的 onStart() 将在活动 1 的 onStop() 之前执行。因此，只有在没有活动运行时，服务才会停止。

# jquery - 有没有人在 jquery validate 之上构建了自己的进度条

> ID：13884147
> 
> 赞同：0
> 
> 时间：2012-12-14T18:15:18.740
> 
> 标签：jquery, jquery-validate, progress-bar

看起来验证器已经在做所有的工作来了解表单填写的程度。所以我只想将它与进度条联系起来。

在多表单场景中也很好，我可以告诉它已经从以前的表单中减少了多少......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:24:12.170

`valid`jQuery validate 会在某事通过验证时抛出一个类。

只需快速计算它们，每隔几秒钟启动一次，或者在文本框的任何模糊事件上启动它。

[jsFiddle 演示](http://jsfiddle.net/R49hh/)

```
var progressInterval = setInterval(function () {

    var progress = $('.required.valid').length,
        total    = $('.required').length;

    $('#progress').html('Progress: ' + progress + ' / ' + total);

}, 1000); 
```

# wpf - WPF 在视图中为根元素的属性定义资源

> ID：13884150
> 
> 赞同：0
> 
> 时间：2012-12-14T18:15:26.120
> 
> 标签：wpf, resources

我有一个看法：

```
<ad:DockingManager x:Class="Proj.UI.View.DockingManagerView"
                           ... a lot of xmlns ...
                           ActiveContent="{Binding Path=ActiveDocument, Mode=TwoWay, Converter={StaticResource ActiveDocumentConverter}}">
    <ad:DockingManager.Resources>
        <ad:BoolToVisibilityConverter x:Key="ActiveDocumentConverter"/>
    </ad:DockingManager.Resources>
</ad:DockingManager> 
```

这行不通。

我应该将资源移到哪里才能在根元素的属性中可用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:42:33.803

将转换器移动到 App.xaml - 资源，以便您可以拥有资源的中央存储库。

查看以下链接，了解共享转换器的其他方面。

[我应该在 App.xaml 中声明转换器还是作为每个文件的资源？](https://stackoverflow.com/questions/1659285/should-i-declare-converters-in-app-xaml-or-as-a-per-file-resource)

# android - Android 应用程序：下载/上传 Google Drive

> ID：13884152
> 
> 赞同：0
> 
> 时间：2012-12-14T18:15:39.180
> 
> 标签：android, google-drive-api

我的目标很简单：我正在开发一个 Android 应用程序并希望在 Google Drive 上上传文件，并且我还希望能够读取它们的属性并下载它们。那么有没有不使用已弃用的 JSon 对象并且可以做到的解决方案呢？

*   连接
*   读取文件属性（修改日期）
*   下载
*   上传

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:23:15.600

您必须使用[Google Drive SDK](https://developers.google.com/drive/)提供的 REST API 。

对于连接，您可以使用 OAuth 2.0： [https ://developers.google.com/drive/about-auth](https://developers.google.com/drive/about-auth)

要检测文件是否已更改，请参阅： [https ://developers.google.com/drive/manage-changes](https://developers.google.com/drive/manage-changes)

如需下载文件，请参阅： [https ://developers.google.com/drive/manage-downloads](https://developers.google.com/drive/manage-downloads)

如需上传文件，请参阅： [https ://developers.google.com/drive/manage-uploads](https://developers.google.com/drive/manage-uploads)

有关如何在 Android 中正确使用 REST API 的信息，请参阅：

[使用 android 发出 HTTP 请求](https://stackoverflow.com/questions/3505930/make-an-http-request-with-android)

[RESTful API 服务](https://stackoverflow.com/questions/3197335/restful-api-service)

希望这可以帮助.....

# jquery - 如何向 jQuery selectList 插件添加删除按钮

> ID：13884154
> 
> 赞同：2
> 
> 时间：2012-12-14T18:15:42.250
> 
> 标签：jquery, jquery-plugins, selectlist

我想删除单击列表项上任意位置以将其删除的默认功能。相反，我想添加一个删除列表项的自定义删除按钮。这是我到目前为止所得到的。

```
<pre>
var sl = $('select#api_product').selectList({
  instance: true,
  clickRemove: false,
  onAdd: function (select, value, text) {
    $('.selectlist-item').last().after('<span class="delete"></span>');
  }
});
$('<span class="delete"></span>').insertAfter('.selectlist-item').last();
</pre> 
```

使用此代码，我可以删除列表项上的单击目标并添加具有删除图标的跨度标记作为 bg 图像。但是，我不知道如何在单击 span 标签后删除列表项和选择选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:46:44.087

我以前没有使用过 selectList，但是快速浏览和一些快速[的 jsfiddle 工作](http://jsfiddle.net/DwUN5/43/)（我借用了一个 selectList 示例）使它看起来像向 selectList 类添加委托事件处理程序`ul`应该能够处理它。

一个警告：最简单的选择方法是将 .delete 跨度放在适当的`li`. 就我个人而言，我认为它也是最接近语义正确的，因为删除“属于”那个特定`li`的 . 有几种不同的方法可以处理删除在外部的方法，`li`并且应该不难弄清楚，但这对我来说更快地达到工作演示：

```
var sl = $('select#simple-usage-select-1').selectList({
  instance: true,
  clickRemove: false,
  onAdd: function (select, value, text) {
    $('.selectlist-item').last().append('<span class="delete"></span>');
  }
});

$('.selectlist-list').on('click', '.delete', function(event) {
 sl.remove($(this).parent().data('value'));
}); 
```

基本上 selectList 有一个特定的`remove(value)`函数，然后删除元素并在列表中取消选择它，您只需要返回到您的 selectList 元素并使用要删除的项目的值调用该删除函数， selectList 通过数据存储() 作为值。

我也删除了你的`insertAfter`，因为它似乎完全没有必要。请注意函数中对“附加”的更改`onAdd`。如果您的 .delete 跨度必须位于以下而不是包含的元素中，则您将需要使用同级选择器或在创建跨度时将数据附加到跨度，或使用一些类似的方法。

注意：如果您正在动态创建选择列表，则需要将 附加`.on`到包含它们的东西上，并且可能将选择器更改为`'.selectlist-item .delete'`使其保持特定。

# javascript - 如何在接近右边距时将 jQuery aToolTip 插件修改为向左“翻转”？

> ID：13884160
> 
> 赞同：0
> 
> 时间：2012-12-14T18:16:10.787
> 
> 标签：javascript, jquery, css, flip, tooltip

我正在使用 aToolTip 并且需要将工具提示从正常的左下方位置翻转到右侧位置，以防止它们离开页面。

我做了一些研究，在一些帮助下，我能够稍微修改代码以允许对单个图像进行有效的“翻转”。该图像称为 hat_icon，代码如下：

```
 $(function() {

            //$("#wrap a[title]").tooltips();
            //$("#page-wrap a[title]").tooltips();

        //    $('a').aToolTip({  
        //    $('a').aToolTip({       
     $("a:not(.tooltipquestion, .accountnav, #hat_icon)").aToolTip({ 
        // no need to change/override  
        closeTipBtn: 'aToolTipCloseBtn',  
        toolTipId: 'aToolTip',  
        // ok to override  
        //   fixed: false,                   // Set true to activate fixed position  
        fixed: false,                   // Set true to activate fixed position   -- chris/peter 12/9
        clickIt: false,                 // set to true for click activated tooltip  
        //   inSpeed: 200,                   // Speed tooltip fades in  
        inSpeed: 400,                   // Speed tooltip fades in   --chris/peter 12/9
        outSpeed: 400,                  // Speed tooltip fades out  
        tipContent: '',                 // Pass in content or it will use objects 'title' attribute  
        toolTipClass: 'defaultTheme',   // Set class name for custom theme/styles  
        xOffset: 15,                     // x position  
        yOffset: -50,                     // y position  
        onShow: null,                   // callback function that fires after atooltip has shown  
        onHide: null                    // callback function that fires after atooltip has faded out      
    });

    jQuery('a.accountnav,#hat_icon').hover(function(){

        setTimeout(function(){
            jQuery('#aToolTip').css({'border-radius':'12px 0 12px 12px'});
        }, 1000);
    }, function(){
        setTimeout(function(){
            jQuery('#aToolTip').css({'border-radius':'12px 12px 12px 0'});
        },500);
    });

    jQuery('a.accountnav,#hat_icon').aToolTip({

        fixed: false,
        xOffset: -250,
        yOffset: -50, 
    });
    jQuery('#hat_icon').aToolTip({

        fixed: false,
        xOffset: -250,
        yOffset: -80, 
    });

}); 
```

我知道有一种方法可以使用 position: (collision: "flipfit flip") 来检测碰撞，但我不知道如何正确实现它。你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T23:01:48.683

**反转**

找到这个：

```
$('#'+settings.toolTipId).css({
    top: (el.pageY - $('#'+settings.toolTipId).outerHeight() - settings.yOffset),
    left: (el.pageX + settings.xOffset)
}); 
```

并替换为：

```
A_TOP = (el.pageY - $('#'+settings.toolTipId).outerHeight() - settings.yOffset);
if(A_TOP<0){
    A_TOP = 40;
}
A_LEFT = (el.pageX + settings.xOffset);
WindowWidth = ($(window).width()-$('#'+settings.toolTipId).outerWidth());
if(A_LEFT>WindowWidth){
     A_LEFT -= $('#'+settings.toolTipId).outerWidth();
}
$('#'+settings.toolTipId).css({
    top: A_TOP,
    left: A_LEFT,
    whiteSpace:"nowrap"
}); 
```

# sql-server - 超过 SQL_ATTR_QUERY_TIMEOUT 时，SQL Server 是否停止工作？

> ID：13884161
> 
> 赞同：0
> 
> 时间：2012-12-14T18:16:11.940
> 
> 标签：sql-server, timeout, odbc

当使用 ODBC 从客户端调用 SQL Server 时，如果运行长时间运行的查询导致超出[SQL_ATTR_QUERY_TIMEOUT](http://msdn.microsoft.com/en-us/library/ms712631%28VS.85%29.aspx)中指定的时间，我会看到控制权返回给应用程序。我的问题是 SQL Server 引擎中的工作是否继续。如果它确实继续，可以做些什么来中止/取消/停止服务器上的请求？是否有需要牢记的最佳实践注意事项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:13:44.953

客户端向服务器发送一个[注意](http://msdn.microsoft.com/en-us/library/dd341449.aspx)信号：

> 客户端可以通过发送 Attention 消息来中断和取消当前请求。这也称为带外数据，但当前正在发送的任何 TDS 数据包必须在发送注意消息之前完成。在客户端发送一个注意消息后，客户端必须读取直到它收到一个注意确认。

引擎将在第一时间中止[批处理](http://msdn.microsoft.com/en-US/library/ms189267%28v=sql.105%29.aspx)（出于所有实际原因，立即）并发送回[Attention ack](http://msdn.microsoft.com/en-us/library/dd304229.aspx)。在某些状态下，批次不能被中断，例如。在回滚事务时。在这种情况下，客户端可能会请求中止，但只有在服务器终止不可中断的工作后才会有响应。

以上对于任何 SQL Server 客户端堆栈都是正确的，例如。完全相同的[`SqlCommand.CommandTimeout`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout.aspx)工作方式。

该[`KILL`](http://msdn.microsoft.com/en-us/library/ms173730.aspx)命令以非常相似的方式工作，只是不是客户端-服务器通信，而是 kill-SPID -> 受害者-SPID 通信。

# tfs - 什么是独立开发人员的理想 TFS ALM 环境设置？

> ID：13884164
> 
> 赞同：0
> 
> 时间：2012-12-14T18:16:25.483
> 
> 标签：tfs

我是一名独立开发人员，评估 TFS 2012 的源代码控制、构建管理和客户端服务器应用程序测试。我对它的实验室管理功能感到特别兴奋，它允许我针对不同的环境手动或自动测试我的应用程序。但是，在阅读文档后，我更加困惑。

似乎我必须部署几个物理或虚拟主机才能使用它。如果不需要，我想避免维护额外机器的麻烦。假设我有以下开发机器：

*   16GB 内存
*   i7 四核处理器
*   1TB高清硬盘
*   1 个 128GB SSD 驱动器

TFS ALM 2012 对于物理或虚拟主机最小化且性能影响最小的独立开发人员的理想设置是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:43:11.383

如果硬件资源有限，我建议您查看[TFS 服务](http://tfs.visualstudio.com/)，它将为您提供所有好处，而无需支持硬件。另一个好处是该服务似乎更新得更频繁，并且作为实验室管理是相对较新的，最终可能会提供真正的帮助。

# java - 休眠延迟初始化异常

> ID：13884165
> 
> 赞同：1
> 
> 时间：2012-12-14T18:16:28.877
> 
> 标签：java, hibernate, annotations

我的代码出现异常，该代码运行良好。将调用一个操作方法，但是在方法调用完成后我得到了这个异常。

我尝试了网络上所有可用的选项，但似乎没有什么能真正帮助我。

```
12/14 23:30:17 INFO  er.SessionDetectionInterceptor  - as dualauth is disabled. session interceptor doesnt validate
12/14 23:30:22 ERROR te.LazyInitializationException  - failed to lazily initialize a collection of role: com.apalya.model.User.broadband, no session or session was closed
org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.apalya.model.User.broadband, no session or session was closed
    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)
    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)
    at org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:343)
    at org.hibernate.collection.AbstractPersistentCollection.read(AbstractPersistentCollection.java:86)
    at org.hibernate.collection.PersistentSet.equals(PersistentSet.java:406)
    at java.util.Vector.indexOf(Vector.java:361)
    at java.util.Vector.contains(Vector.java:320)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:109)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.array(JSONWriter.java:441)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:150)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.write(JSONWriter.java:94)
    at org.apache.struts2.json.JSONUtil.serialize(JSONUtil.java:115)
    at org.apache.struts2.json.JSONResult.createJSONString(JSONResult.java:200)
    at org.apache.struts2.json.JSONResult.execute(JSONResult.java:172)
    at com.opensymphony.xwork2.DefaultActionInvocation.executeResult(DefaultActionInvocation.java:362)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:266)
    at com.apalya.filter.SessionDetectionInterceptor.intercept(SessionDetectionInterceptor.java:117)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.apalya.filter.UserDetectionInterceptor.intercept(UserDetectionInterceptor.java:53)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:165)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:252)
    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:179)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:94)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:165)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:179)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParameterFilterInterceptor.intercept(ParameterFilterInterceptor.java:135)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.CreateSessionInterceptor.intercept(CreateSessionInterceptor.java:93)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:488)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at com.apalya.filter.XSSFilter.doFilter(XSSFilter.java:29)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.tuckey.web.filters.urlrewrite.UrlRewriteFilter.doFilter(UrlRewriteFilter.java:738)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:615)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662)
org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.apalya.model.User.broadband, no session or session was closed
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:230)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.write(JSONWriter.java:94)
    at org.apache.struts2.json.JSONUtil.serialize(JSONUtil.java:115)
    at org.apache.struts2.json.JSONResult.createJSONString(JSONResult.java:200)
    at org.apache.struts2.json.JSONResult.execute(JSONResult.java:172)
    at com.opensymphony.xwork2.DefaultActionInvocation.executeResult(DefaultActionInvocation.java:362)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:266)
    at com.apalya.filter.SessionDetectionInterceptor.intercept(SessionDetectionInterceptor.java:117)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.apalya.filter.UserDetectionInterceptor.intercept(UserDetectionInterceptor.java:53)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.DefaultWorkflowInterceptor.doIntercept(DefaultWorkflowInterceptor.java:165)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.validator.ValidationInterceptor.doIntercept(ValidationInterceptor.java:252)
    at org.apache.struts2.interceptor.validation.AnnotationValidationInterceptor.doIntercept(AnnotationValidationInterceptor.java:68)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor.intercept(ConversionErrorInterceptor.java:122)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.StaticParametersInterceptor.intercept(StaticParametersInterceptor.java:179)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.FileUploadInterceptor.intercept(FileUploadInterceptor.java:235)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ModelDrivenInterceptor.intercept(ModelDrivenInterceptor.java:89)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ChainingInterceptor.intercept(ChainingInterceptor.java:126)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.PrepareInterceptor.doIntercept(PrepareInterceptor.java:138)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.ServletConfigInterceptor.intercept(ServletConfigInterceptor.java:164)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParametersInterceptor.doIntercept(ParametersInterceptor.java:195)
    at com.opensymphony.xwork2.interceptor.MethodFilterInterceptor.intercept(MethodFilterInterceptor.java:87)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.MultiselectInterceptor.intercept(MultiselectInterceptor.java:75)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.CheckboxInterceptor.intercept(CheckboxInterceptor.java:94)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.I18nInterceptor.intercept(I18nInterceptor.java:165)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.AliasInterceptor.intercept(AliasInterceptor.java:179)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ExceptionMappingInterceptor.intercept(ExceptionMappingInterceptor.java:176)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at com.opensymphony.xwork2.interceptor.ParameterFilterInterceptor.intercept(ParameterFilterInterceptor.java:135)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.interceptor.CreateSessionInterceptor.intercept(CreateSessionInterceptor.java:93)
    at com.opensymphony.xwork2.DefaultActionInvocation.invoke(DefaultActionInvocation.java:237)
    at org.apache.struts2.impl.StrutsActionProxy.execute(StrutsActionProxy.java:52)
    at org.apache.struts2.dispatcher.Dispatcher.serviceAction(Dispatcher.java:488)
    at org.apache.struts2.dispatcher.FilterDispatcher.doFilter(FilterDispatcher.java:395)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.displaytag.filter.ResponseOverrideFilter.doFilter(ResponseOverrideFilter.java:125)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at com.apalya.filter.XSSFilter.doFilter(XSSFilter.java:29)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.tuckey.web.filters.urlrewrite.UrlRewriteFilter.doFilter(UrlRewriteFilter.java:738)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:615)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:293)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:859)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:602)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)
    at java.lang.Thread.run(Thread.java:662)
Caused by: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.apalya.model.User.broadband, no session or session was closed
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:230)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.array(JSONWriter.java:441)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:150)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    ... 86 more
Caused by: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.apalya.model.User.broadband, no session or session was closed
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:230)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    ... 93 more
Caused by: org.apache.struts2.json.JSONException: org.apache.struts2.json.JSONException: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.apalya.model.User.broadband, no session or session was closed
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:230)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    ... 97 more
Caused by: org.apache.struts2.json.JSONException: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.mypersonal.model.User.broadband, no session or session was closed
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:230)
    at org.apache.struts2.json.JSONWriter.process(JSONWriter.java:160)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:126)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    ... 101 more
Caused by: org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: com.mypersonal.model.User.broadband, no session or session was closed
    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:358)
    at org.hibernate.collection.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:350)
    at org.hibernate.collection.AbstractPersistentCollection.initialize(AbstractPersistentCollection.java:343)
    at org.hibernate.collection.AbstractPersistentCollection.read(AbstractPersistentCollection.java:86)
    at org.hibernate.collection.PersistentSet.equals(PersistentSet.java:406)
    at java.util.Vector.indexOf(Vector.java:361)
    at java.util.Vector.contains(Vector.java:320)
    at org.apache.struts2.json.JSONWriter.value(JSONWriter.java:109)
    at org.apache.struts2.json.JSONWriter.add(JSONWriter.java:352)
    at org.apache.struts2.json.JSONWriter.bean(JSONWriter.java:215)
    ... 105 more 
```

我的模特班

```
@Entity
@Table(name = "user")
public class User implements Serializable {

    private static final long serialVersionUID = 1L;
    private Long id;

    private Boolean approved;
    private Boolean subscribed;
    private Date createdOn;

    private Set<UserBroadband> broadband;
    private Set<UserBussinessModel> userBussinessModel;

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    @Column(name = "approved")
    public void setApproved(Boolean approved) {
        this.approved = approved;
    }

    public Boolean getApproved() {
        return approved;
    }

    @Column(name = "createdOn")
    public void setCreatedOn(Date createdOn) {
        this.createdOn = createdOn;
    }

    public Date getCreatedOn() {
        return createdOn;
    }

    /*@OneToMany(targetEntity = com.apalya.model.UserBussinessModel.class, cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = "id")
    @JsonIgnore*/
    @OneToMany( fetch = FetchType.LAZY, cascade = { CascadeType.PERSIST, CascadeType.MERGE }, mappedBy = "user"  )
    @org.hibernate.annotations.Cascade({org.hibernate.annotations.CascadeType.SAVE_UPDATE})
    @Basic( optional = false )
    @Column( nullable = false  )
    public Set<UserBussinessModel> getUserBussinessModel() {
        return userBussinessModel;
    }

    public void setUserBussinessModel(Set<UserBussinessModel> userBussinessModel) {
        this.userBussinessModel = userBussinessModel;
    }

    @Column(name = "company")
    public String getCompany() {
        return company;
    }

    public void setCompany(String company) {
        this.company = company;
    }

    @Column(name = "status")
    public String getStatus() {
        return status;
    }

    public void setStatus(String status) {
        this.status = status;
    }

    @Column(name = "subscribed")
    public Boolean getSubscribed() {
        return subscribed;
    }

    public void setSubscribed(Boolean subscribed) {
        this.subscribed = subscribed;
    }

    @Column(name = "auto_provision")
    public Boolean getAutoProvision() {
        return autoProvision;
    }

    public void setAutoProvision(Boolean autoProvision) {
        this.autoProvision = autoProvision;
    }

    /**
     * @param fname the fname to set
     */
    public void setFname(String fname) {
        this.fname = fname;
    }

    /**
     * @return the fname
     */
    @Column(name = "first_name")
    public String getFname() {
        return fname;
    }

    /**
     * @param lname the lname to set
     */
    public void setLname(String lname) {
        this.lname = lname;
    }

    /**
     * @return the lname
     */
    @Column(name = "last_name")
    public String getLname() {
        return lname;
    }

    /**
     * @param lastLoggedOn the lastLoggedOn to set
     */
    public void setLastLoggedOn(Date lastLoggedOn) {
        this.lastLoggedOn = lastLoggedOn;
    }

    /**
     * @return the lastLoggedOn
     */
    public Date getLastLoggedOn() {
        return lastLoggedOn;
    }

    @Column(name = "from_date")
    public Date getFromDate() {
        return fromDate;
    }

    public void setFromDate(Date fromDate) {
        this.fromDate = fromDate;
    }
    @Column(name = "to_date")
    public Date getToDate() {
        return toDate;
    }

    public void setToDate(Date toDate) {
        this.toDate = toDate;
    }
    /*@OneToMany(targetEntity = com.apalya.model.UserBroadband.class, cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = "id")
    @JsonIgnore*/
    @OneToMany( fetch = FetchType.LAZY, cascade = { CascadeType.PERSIST, CascadeType.MERGE }, mappedBy = "userId"  )
    @org.hibernate.annotations.Cascade({org.hibernate.annotations.CascadeType.SAVE_UPDATE})
    @Basic( optional = false )
    @Column( nullable = false  )
    public Set<UserBroadband> getBroadband() {
        return broadband;
    }

    public void setBroadband(Set<UserBroadband> broadband) {
        this.broadband = broadband;
    }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:53:23.170

当您在对象之间建立关系时会发生延迟初始化异常，例如，（一对多）客户有很多汽车。所以发生的情况是，您进行查询，获取客户列表，然后关闭会话。在此之后，如果您尝试访问客户端对象内的汽车集合（未加载），您将获得异常。你没有发布你的代码......这将有更多帮助。

编辑：这正是你的例外所说的

> 未能延迟初始化角色集合：com.mypersonal.model.User.broadband，没有会话或会话已关闭

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:23:10.990

You should either make eager fetch

`public Set<UserBroadband> getBroadband()` `@OneToMany( fetch = FetchType.EAGER`

or do your JSON serializing before session is closed.

When you are serializing your entity object after session is closed, it is not able to fetch lazy collection in that object.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T04:45:30.903

人们需要问的第一个问题是他们是否需要这些收藏品。如果他们需要这些集合，那么最好将其设置为 EAGER 加载。

如果不需要集合，则在序列化过程发生之前，将所有集合设置为空。

我通过将所有集合设置为空来开始工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T17:27:14.147

复制以下已回答的问题：

您可以使用[HibernateFullPlugin](http://code.google.com/p/full-hibernate-plugin-for-struts2/)或使用拦截器实现的此[解决方案（与 HibernateFullPlugin 相同但更简单）。](https://stackoverflow.com/questions/15269786/struts2-jsonresult-hibernate-lazyinitialization-how-to-deserialize-within-a-hi)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T18:58:31.560

您需要在用户中急切地加载属性“宽带”。应该很容易修复。Hibernate默认懒加载集合，你只需要在注解中添加 fetch = FetchType.EAGER 还是在xml中做类似的事情。

另一种选择是在宽带属性尚未从会话中分离时调用它。为此，您需要知道您的交易在哪里结束，因为您的会话之前已关闭。然后 Hibernate 将填充该字段而不会引发错误，因为它仍然可以访问数据库。

了解 Hibernate 出于性能原因这样做。如果您在一个查询中获取所有内容，您最终可能会获取整个数据库（披萨效应）。

# sql - 查询问题

> ID：13884166
> 
> 赞同：0
> 
> 时间：2012-12-14T18:16:39.147
> 
> 标签：sql

我有`TContractForm`带字段的表`idcontract(primary key),idcntrtype(foreign key),date_begin,date_end,cost`。我还有 3 种类型的合同：

`TRentWhouseContract`带字段`idcontract,idclient,idpdtwhs`

`TRentShoppointContract`带字段`idcontract,idclient,idshoppoint,idshoptype`

`TRentEquipContract`带字段`idcontract,idclient,ideq,amount`

`idcntrtype`- 合同类型。`TContractType`- `idcntrtype(primary key),idcntrclass(foreign key),name`。`TContractClass`- `idcntrclass,name`。

我想用 columns 创建一个视图 `idcontract,idclient,contract_type(name of type),contract_class(name of class),date_begin,date_end,cost`。

但是我的查询什么也没返回（我知道我在 TRentWhouseContract 表中有几个合同（其他表没有行）（它没有 idclient，因为如果某些表为空，我不知道如何从不同的表中获取相同的 idclient） .

```
select TCF.idcontract,
   --idclient
   TCF.date_begin,
   TCF.date_end,
   TCT.name as [type],
   TCC.name as class,
   TCF.cost
from TContractForm as TCF,
 TRentEquipContract as TREC,
 TRentShopPointContract as TRSPC,
 TRentWhouseContract as TRWC,
 TContractType as TCT,
 TContractClass as TCC
where TCF.idcontract = TREC.idcontract or TCF.idcontract = TRSPC.idcontract
  or TCF.idcontract = TRWC.idcontract and TCT.idcntrtype = TCF.idcntrtype
  and TCT.idcntrclass = TCC.idcntrclass 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:29:25.963

如果我理解正确，这就是我会做的

```
select TCF.idcontract,
   --idclient
   TCF.date_begin,
   TCF.date_end,
   TCT.name as [type],
   TCC.name as class,
   TCF.cost
from TContractForm as TCF
JOIN TContractType as TCT
   ON TCT.idcntrtype=TCF.idcntrtype
JOIN TContractClass as TCC
   ON TCT.idcntrclass = TCC.idcntrclass
UNION
select TCF.idcontract,
   --idclient
   TCF.date_begin,
   TCF.date_end,
   TCT.name as [type],
   TCC.name as class,
   TCF.cost
from TRentWhouseContract as TCF
JOIN TContractType as TCT
   ON TCT.idcntrtype=TCF.idcntrtype
JOIN TContractClass as TCC
   ON TCT.idcntrclass = TCC.idcntrclass
UNION
select TCF.idcontract,
   --idclient
   TCF.date_begin,
   TCF.date_end,
   TCT.name as [type],
   TCC.name as class,
   TCF.cost
from TRentShoppointContract as TCF
JOIN TContractType as TCT
   ON TCT.idcntrtype=TCF.idcntrtype
JOIN TContractClass as TCC
   ON TCT.idcntrclass = TCC.idcntrclass
UNION
select TCF.idcontract,
   --idclient
   TCF.date_begin,
   TCF.date_end,
   TCT.name as [type],
   TCC.name as class,
   TCF.cost
from TRentEquipContract as TCF
JOIN TContractType as TCT
   ON TCT.idcntrtype=TCF.idcntrtype
JOIN TContractClass as TCC
   ON TCT.idcntrclass = TCC.idcntrclass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:28:06.083

如何获取idclient：

```
coalesce(TREC.idclient, TRSPC.idclient,TRWC.idclient) as idclient 
```

合并返回第一个非缺失值。

至于其余的 - 我认为你应该做左外连接而不是逗号连接，因为你没有所有表中的一些记录（好吧，所有表中都没有记录！）。

```
select...
from TCF,TCT,TCC ... A
 left join ... TREC on A.idcontract=TREC.idcontract
 left join ... TRSPC 
```

等等

# algorithm - 增强 AVL 树，序列

> ID：13884167
> 
> 赞同：1
> 
> 时间：2012-12-14T18:16:44.437
> 
> 标签：algorithm, data-structures

我在书中找到了这个：

```
Design a data structure for maintaining dynamic sequence x_1, x_2,... , x_n 
which provides operations:
Insert(a,i) - inserts a as x_i, indexes from i+1 to n go up by 1
Delete(i) - deletes x_i, indexes from i+1 to n go down by 1
Find(i) - returns element x_i
Sum_even() - returns sum of the elements with even indexes 
```

序列是动态的，所以我想使用 AVL 树来保留它。所以我认为我可以使用标准技巧来查找、删除和插入 - 只需保留以该节点为根的子树的每个节点大小。然后我可以轻松地导航树以在 O(log n) 时间内找到第 i 个元素。然后按顺序给我：x_1，x_2，...，x_n。

但是对于 Sum_even() 我可能还应该在每个节点中包含具有偶数和奇数索引的元素的总和。虽然在插入或删除时很难更新。它应该如何工作，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:47:17.720

您不必在节点中存储子树的大小。AVL 树只存储左右子树的高度差：-1、0 或 +1。

为了便于维护`sum_even`，您需要为每个节点存储`sum_even`和`sum_odd`。它将是子树的偶数/奇数索引上的值的总和。

所以每个节点都会有变量：

*   `difference`左右子树的高度差
*   `value`
*   `parity`子树大小的奇偶校验（0 或 1）
*   `sum_even`
*   `sum_odd`

对于插入和删除，使用标准算法[http://en.wikipedia.org/wiki/AVL_tree](http://en.wikipedia.org/wiki/AVL_tree)。但是对于每个受影响的节点（到达根节点和旋转节点的节点）更新值：

```
parity := (left.parity + right.parity + 1) % 2
if left.parity == 0
    sum_even := left.sum_even + right.sum_odd
    sum_odd := left.sum_odd + right.sum_even + value
else
    sum_even := left.sum_even + right.sum_even + value
    sum_odd := left.sum_odd + right.sum_odd 
```

# sql - 更新和删除新添加的行时并发冲突

> ID：13884172
> 
> 赞同：0
> 
> 时间：2012-12-14T18:17:11.900
> 
> 标签：sql, sql-server, c#-4.0, concurrency

我一直在使用C# 和 Sql Server 2012 中的**数据集**开发一个 CRUD 应用程序。该项目基本上是一个议程，其中包含有关神奇宝贝的信息（名称、能力、类型、图像等）。几个月来，我一直面临与**并发冲突**有关的问题。换句话说，当我尝试删除或更新在同一程序执行期间添加的行时，会生成并发异常，并且无法在数据库中执行任何其他更改。所以我需要重新启动程序才能再次执行更改（**重要提示：此异常仅发生在通过 C# 添加的新行）**。我'**，但我找不到可以在 C# 的源代码中添加的任何内容。有谁知道如何处理这个？我应该在我的源代码中实现什么？SQL Server 中有什么可以帮助它的事情吗？**

 **这是我的项目的链接，来自数据库的备份，主窗体的图像和数据库图：

[http://www.mediafire.com/download.php?izkat44a0e4q8em（C#](http://www.mediafire.com/download.php?izkat44a0e4q8em)源代码）

[http://www.mediafire.com/download.php?rj2e118pliarae2（Sql](http://www.mediafire.com/download.php?rj2e118pliarae2)备份）

imageshack .us /a /img 708/38 23/pokmonform .png（主表格）

imageshack .us /a /img 18/95 46/kantopokdexdiagram .png（数据库图）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T21:58:47.750

我查看了您的代码，似乎您在数据表 daKanto 上不一致地使用 AcceptChanges。实际上你使用AcceptChangesDuringUpdate，这也很好，虽然我更喜欢`datatable.AcceptChanges()`在更新后显式调用方法，但你的方式也很好。无论如何，我注意到，您在 Delete_Click 和 Update__Click 方法中使用 AcceptChangesDuringUpdate，但不要在 Save_Click 中使用它，而且我认为您应该在 MainForm_Load 中使用 AcceptChangesDuringFill，您可以在其中填充数据集。我不能向您保证，这会有所帮助，但我知道整个应用程序中数据访问的一致性可以降低意外数据一致性错误的风险。**

# android - Android：通过 USB 挂载 Windows 共享的通用方法

> ID：13884175
> 
> 赞同：0
> 
> 时间：2012-12-14T18:17:17.380
> 
> 标签：android, windows, mount

我正在寻找一种通过 USB 电缆（不是 WiFi）安装 Windows 共享的*通用方法。*泛型是指一种不需要设备特定内核模块的方法。

如果这无法实现，我对其他想法持开放态度，但 WiFi/互联网连接完全不可能。

我的开发机器位于域上，共享可能位于另一台机器上，不一定是我的主机上的本地机器。

非常欢迎任何想法或建议。

非常感谢，P

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:21:13.757

如果没有内核模块，这是不可能的，因为内核模块是完成整个工作的东西。所以你的问题就像“我正在寻找将水放入玻璃的方法，但没有玻璃部分”。所以应用程序可能会提供 SMB 支持，但那是因为这些应用程序包含了内部处理 SMB 的所有代码。因此，如果您想在文件系统级别挂载 samba 共享，您需要内核模块和足够的权限。否则，您只需要寻找支持 SMB 并执行您想要的操作的应用程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-12-29T02:37:33.060

I'm definetly considering to use a chroot of some linux installation to implement a smb arm linux server on android, you can run all sorts of ARM linux tools inside an android machine trough chroot, once in linux there's not much you can't do, and the simplest distro available can pretty much install whatever you want. Of course, you can strip just the server binaries inside a package and run that just like an android app of some sort, or install the binaries in /system/bin and xbin in android and add some init script. Whatever rocks your boat. BTW, my implementation involves a USB-ramdrive, i want my 2GB RAM MK809II android device to store a 1GB img file in a tmpfs ramdisk, mounted in a place accessible by all apps like /sdcard/ram/ram.img, where i can create a smb share to a windows machine, that connection will be made via USB, i'll use adb reverse to connect to the SMB share and redirect the server ports to my local tcp 7777 1137 1138 1139, my smb filesharing server has already been disabled, so these relevant ports are free to use in my pc, that's important because windows will only recognize servers running in the same ports. I'll access the smb share from windows and mount the img file in the share trough ImDisk to have my virtual ramdrive under windows. I have a pc with only 1.5gb of ram, and sometimes this thing run out of memory, i want to have a readyboost drive that's lightning fast compared to a solid state usb drive, i want to have usb as a bottleneck in my transfer speed..... some time ago i saw a 50MB/s usb2.0 hdd then i wondered what would happen if i can bottleneck the fck out of usb2.0, that's completely inviable via it's original solid state bottlenecked drives, but ram in the other hand has almost no speed limit... so i got my little project, out of some need and mostly curiosity. I'm chasing for a way into store the pagefile in that ramdisk, though i think windows readyboost already stores virtual memory pages in the readyboost file.

# python - Python中*in*运算符的复杂性

> ID：13884177
> 
> 赞同：123
> 
> 时间：2012-12-14T18:17:22.617
> 
> 标签：python, time-complexity

`in`Python中运算符的复杂性是多少？是θ（n）吗？

和下面的一样吗？

```
def find(L, x):
   for e in L:
       if e == x:
           return True
   return False 
```

`L`是一个列表。

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2012-12-14T18:20:09.793

的复杂性`in`完全取决于是什么`L`。`e in L`会变成`L.__contains__(e)`.

有关几种内置类型的复杂性，请参阅此[时间复杂度文档。](http://wiki.python.org/moin/TimeComplexity)

以下是以下内容的摘要`in`：

*   列表 - 平均：O(n)
*   set/dict - 平均：O(1)，最差：O(n)

集合和 dicts 的 O(n) 最坏情况非常罕见，但如果`__hash__`实施不当，可能会发生这种情况。仅当您的集合中的所有内容都具有相同的哈希值时，才会发生这种情况。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-12-14T18:19:24.543

这完全取决于容器的类型。散列容器 ( `dict`, `set`) 使用散列并且本质上是 O(1)。典型的序列 ( `list`, `tuple`) 是按照您的猜测实现的，并且是 O(n)。树将是平均 O(log n)。等等。这些类型中的每一种都将具有`__contains__`具有其大 O 特征的适当方法。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-14T18:20:15.483

这取决于您正在测试的容器。这通常是您所期望的——有序数据结构是线性的，无序数据结构是常数。当然，有两种类型（有序或无序）可能由树的某些变体支持。

# php - str_word_count() 函数无法正确显示阿拉伯语

> ID：13884178
> 
> 赞同：6
> 
> 时间：2012-12-14T18:17:22.600
> 
> 标签：php, function

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:31:25.180

Try with this function for word count:

```
// You can call the function as you like
if (!function_exists('mb_str_word_count'))
{
    function mb_str_word_count($string, $format = 0, $charlist = '[]') {
        mb_internal_encoding( 'UTF-8');
        mb_regex_encoding( 'UTF-8');

        $words = mb_split('[^\x{0600}-\x{06FF}]', $string);
        switch ($format) {
            case 0:
                return count($words);
                break;
            case 1:
            case 2:
                return $words;
                break;
            default:
                return $words;
                break;
        }
    };
}

echo mb_str_word_count("القاهرة هى عاصمة مصر وباريس هى عاصمة فرنسا") . PHP_EOL; 
```

### Resources

*   [Unicode list for arabic](http://www.ssec.wisc.edu/~tomw/java/unicode.html#x0600)
*   [A Rule-Based Arabic Stemming Algorithm](http://www.wseas.us/e-library/conferences/2011/Paris/ECC/ECC-66.pdf)
*   [A Rule and Template Based Stemming Algorithm for Arabic Language](http://www.naun.org/multimedia/NAUN/m3as/20-805.pdf) (seems more complete)

### Recommentations

*   Use the tag `<meta charset="UTF-8"/>` in HTML files
*   Always add `Content-type: text/html; charset=utf-8` headers when serving pages

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-18T13:59:11.883

也接受 ASCII 字符：

```
if (!function_exists('mb_str_word_count'))
{
    function mb_str_word_count($string, $format = 0, $charlist = '[]') {
        $string=trim($string);
        if(empty($string))
            $words = array();
        else
            $words = preg_split('~[^\p{L}\p{N}\']+~u',$string);
        switch ($format) {
            case 0:
                return count($words);
                break;
            case 1:
            case 2:
                return $words;
                break;
            default:
                return $words;
                break;
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-28T19:55:39.743

前段时间我想计算一段的阅读时间并且遇到了同样的问题，我只是简单地计算了段落中的空格:)（请注意，它不会那么准确，但它适合我）

像这样：

```
substr_count($text, ' ') + 1; 
```

# authorization - FB.login returns Invalid OAuth access token

> ID：13884179
> 
> 赞同：4
> 
> 时间：2012-12-14T18:17:28.013
> 
> 标签：authorization, facebook-javascript-sdk, facebook-php-sdk, facebook-login, facebook-access-token

I've been developing an app for the past few weeks and up until now there have been no issues. Just a couple days ago a strange bug has started occurring:

My application uses the PHP SDK and implements the Javascript SDK for user authorization. The user is allowed to roam the application freely, but when they click on a video, FB.login is called to request permissions from the user and get an access token.

**jQuery Code**

```
FB.login(function(response) {

    if (response.authResponse) {

        //Set global vars
        fb_uid = response.authResponse.userID;
        fb_token = response.authResponse.accessToken;

        //If user has already authorized the app
        if (response.status === 'connected') {

            //Create the user record
            $.ajax(site_url + '/facebook/create_fb_user', {
                type: 'POST',
                dataType: 'json',
                data: {fb_uid: fb_uid, token: fb_token},
                success: function (data) {
                    user = data.resp.fb_user;
                    viewVideo(item);
                }
            });
        };
    };
}, {scope: "publish_stream"}); 
```

**PHP Code**

```
try {

    $this->_fb->setAccessToken($this->request->post('token'));

    $data = $this->_fb->api("/me");

    $model = new Model_Fbuser;
    $model->data = array(
        'fb_uid' => $data['id'],
        'fb_token' => $extended_token
    );
    $resp = $model->update();

    return $this->render_json(array(
        'success' => TRUE,
        'resp' => $resp
    ));

} catch (Exception $e) {

    return $this->render_json(array(
        'success' => FALSE,
        'error' => $e->getMessage(),
        'token' => $this->request->post('token')
    ));

} 
```

The first time the user does this, the FB.login call returns a valid access token, the PHP SDK is able to set the token, and everything works as expected.

However, should the user revoke the application's access in their App Settings, and then return to the application, they are presented with the FB.login once more, but this time, the call returns the same access token they were previously given, which has already had its access revoked. Trying to set the access token with the PHP SDK throws the exception: "Invalid OAuth access token."

Yet if I then check the token in the Facebook debugger, is says it is valid.

**Edit:** Further investigation reveals that the user is issues the same access token every time in the same session. If the user logs out, then logs back in, then they will receive a new valid token. But if they try to get a new token without logging out first, Facebook reissues them the same invalid one. When trying to use this access token to query information about the user, this is the response:

```
{"error":{"type":"OAuthException","message":"Error validating access token: The session was invalidated explicitly using an API call."}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-14T13:07:26.167

如果你以这种方式得到“无效的 OAuth 访问令牌”错误，我通常会调用 FB.logout()，然后在回调中立即调用 FB.login()。

```
FB.logout(function(response) {
  // user is now logged out
  FB.login(...)
}); 
```

不理想，但解决此类用例的最佳方法。

# android - Attribute Already Defined When Using HoloEverywhere and UnifiedPreference

> ID：13884188
> 
> 赞同：1
> 
> 时间：2012-12-14T18:18:29.993
> 
> 标签：android, actionbarsherlock, android-holo-everywhere

I have a project that is currently using ActionBarSherlock, Crouton, and UnifiedPreference which works (compiles, runs without issue on devices and emulator for Android 2.3.3+). I want to add HoloEverywhere so that I can keep a unified interface when it runs on Gingerbread devices. Once I added HoloEverywhere to the mix I get the following AAPT errors:

```
[2012-12-14 12:47:04 - MyApp] C:\git\myrepo\UnifiedPreference\library\res\values\atrs.xml:7: error: Attribute "id" has already been defined
[2012-12-14 12:47:04 - MyApp] C:\git\myrepo\UnifiedPreference\library\res\values\atrs.xml:11: error: Attribute "summary" has already been defined
[2012-12-14 12:47:04 - MyApp] C:\git\myrepo\UnifiedPreference\library\res\values\atrs.xml:13: error: Attribute "breadCrumbTitle" has already been defined
[2012-12-14 12:47:04 - MyApp] C:\git\myrepo\UnifiedPreference\library\res\values\atrs.xml:15: error: Attribute "breadCrumbShortTitle" has already been defined
[2012-12-14 12:47:04 - MyApp] C:\git\myrepo\UnifiedPreference\library\res\values\atrs.xml:19: error: Attribute "fragment" has already been defined 
```

The AAPT errors reference whichever library project is *first* (either UnifiedPreference OR HoloEverywhere) in my android library dependency list. I've also discovered that all of the offending attributes are defined as part of `<declare-styleable name="PreferenceHeader">` My current Android Dependency order and structure is:

```
MyApp
   ActionBarSherlock
   HoloEverywhere
   UnifiedPreference
   Crouton
HoloEverywhere
   ActionBarSherlock
UnifiedPreference
   ActionBarSherlock
Crouton 
```

I have tried changing the order of HoloEverywhere and UnifiedPreference, removing ActionBarSherlock from one and making it dependent on the other, and tried pulling them down from git again.

Does anyone know how to get UnifiedPreference and HoloEverywhere to play nicely together since they both have attributes with the same name?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:26:44.180

是的，你将不得不重命名一些属性来摆脱那个 AAPT 问题。一旦资源合并到您的项目中，您就不能拥有同名的属性。如果实际上这些是重复的属性（意思是那些碰巧在其各自的项目中从头开始定义并且实际上与另一个相同的属性），那么只需将它们删除并保留在包含这些属性的最高依赖项中并从较低的依赖项中删除它们。

# java - 缺少新的官方 Google App Engine Maven 原型？

> ID：13884189
> 
> 赞同：5
> 
> 时间：2012-12-14T18:18:44.237
> 
> 标签：java, google-app-engine

我刚刚阅读了 App Engine 1.7.4 发布公告：

[http://googleappengine.blogspot.com/2012/12/app-engine-174-released.html](http://googleappengine.blogspot.com/2012/12/app-engine-174-released.html)

在链接的发行说明中，它指向有关使用 Maven 的新功能的指南：

[https://developers.google.com/appengine/docs/java/tools/maven](https://developers.google.com/appengine/docs/java/tools/maven)

该指南谈到使用 Maven 原型，例如：

```
mvn archetype:generate 
```

并过滤

```
com.google.appengine.archetypes:guestbook-archetype 
```

由于某种原因，我找不到原型，当我单击链接时，指南必须在 Maven Central 中搜索原型，但没有得到任何结果：

[http://search.maven.org/#search%7Cga%7C1%7Ccom.google.appengine.archetype](http://search.maven.org/#search%7Cga%7C1%7Ccom.google.appengine.archetype)

我错过了什么吗？谁能让我知道如何使用该原型？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T09:04:11.303

好像是同步延迟。原型已经存在：

[http://search.maven.org/#search%7Cga%7C1%7Cguestbook-archetype](http://search.maven.org/#search%7Cga%7C1%7Cguestbook-archetype)

尝试清除本地存储库并再次执行原型：生成：

```
mvn archetype:generate -DarchetypeGroupId=com.google.appengine.archetypes -DarchetypeArtifactId=guestbook-archetype -DarchetypeVersion=1.7.4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-08T15:51:14.713

添加 Maven 中央目录文件

1.  下载此文件 [http://search.maven.org/remotecontent?filepath=archetype-catalog.xml](http://search.maven.org/remotecontent?filepath=archetype-catalog.xml)

2.  首选项 -> Maven -> 添加目录信息

# string - 尝试使用 VB 脚本保存时出现类型错误

> ID：13884190
> 
> 赞同：0
> 
> 时间：2012-12-14T18:18:46.467
> 
> 标签：string, vbscript, save, filenames, typeerror

我正在尝试使用以下脚本，它在以下粗体代码行上给我一个类型错误。

```
 Option Explicit

 Dim xlApp
 Dim xlBook
 Dim Filename
 Dim Format

 Set xlApp = CreateObject("Excel.Application")
 Set xlBook = xlApp.Workbooks.Open("\\denfs1\home\davidvan\desktop\shane spread sheet 2.xlsm", 0, True)

 xlApp.Run "Mail_Body"
 **xlBook.SaveAS Filename=("H:Contrabutions spread sheet" & Format(Date,"MM/DD/YYYY")& ".xlsm")**
 xlBook.close
 xlApp.Quit

 Set xlBook = Nothing
 Set xlApp = nothing 
```

我觉得我需要将文件名定义为字符串，但不确定如何在不出错的情况下做到这一点

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:25:07.343

1.  VBScript 中没有 Format() 函数（相对于 VBA），请查找 FormatDateTime() 代替
2.  VBScript 中没有命名参数（VBA 中的语法涉及“:=”），使用纯字符串作为 .SaveAs 方法的第一个参数
3.  VBScript 解析器在字符串连接运算符周围不需要空格

# c++ - 以整数形式获取线段和 2^n 网格之间的所有交点

> ID：13884200
> 
> 赞同：1
> 
> 时间：2012-12-14T18:19:30.090
> 
> 标签：c++, algorithm, math, geometry

我有一条从 (x0, y0) 到 (x1, y1) 的线穿过由 2^n 宽的方形瓷砖组成的网格。我不仅需要找到线相交的瓷砖，还需要找到相应的入口和出口点。我可以找到的所有关于此的 SO 问题都处理“1x1”瓷砖，而不关心瓷砖内交叉点的位置。

![在此处输入图像描述](../Images/66dca80142104f1b056b2e8119c69f43.png)

这些点并不总是精确地在一个整数上，在某些情况下我会使用自然地板，而另一些我会想要四舍五入。但是现在让它在所有情况下都自然下降是可以的。

[我找到了一个示例](http://playtechs.blogspot.com/2007/03/raytracing-on-grid.html)，该示例最终得到了一个非常简单的整数光线跟踪案例，但它不跟踪交点，也不适用于穿过中心的线（假设为 0.5、0.5 偏移） 1x1 瓷砖。

```
void raytrace(int x0, int y0, int x1, int y1)
{
    int dx = abs(x1 - x0);
    int dy = abs(y1 - y0);
    int x = x0;
    int y = y0;
    int n = 1 + dx + dy;
    int x_inc = (x1 > x0) ? 1 : -1;
    int y_inc = (y1 > y0) ? 1 : -1;
    int error = dx - dy;
    dx *= 2;
    dy *= 2;

    for (; n > 0; --n)
    {
        visit(x, y);

        if (error > 0)
        {
            x += x_inc;
            error -= dy;
        }
        else
        {
            y += y_inc;
            error += dx;
        }
    }
} 
```

它如何适应找到相交的 2^nx 2^n 网格图块，同时还抓住 2 个相关的交点？似乎在一个 tile 中“任何地方”开始的能力真的搞砸了这个算法，我的解决方案最终使用除法，并且可能设置为在每次迭代中累积错误。而且这样不好...

另外我认为对于第一个和最后一个图块，可以假设端点是“其他”交点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:36:43.083

有一篇有用的文章“ [Fast Voxel Traversal Algorithm...](http://www.cse.yorku.ca/~amana/research/grid.pdf) ”，作者 Woo, Amanatides。也看看实际的实现（[网格遍历部分](http://www.flipcode.com/archives/Raytracing_Topics_Techniques-Part_4_Spatial_Subdivisions.shtml)）。我已经使用了这种方法，效果很好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T12:58:17.730

您可以通过将整个坐标系除以 2^n来**将 2^n X 2^n 平铺大小减小到 1 X 1 。**

准确地说，在我们的例子中，这意味着您将线的起点和终点的坐标除以 2^n。从现在开始，您可以将问题视为 1X1 大小的瓦片问题。在问题结束时，我们将 2^n 乘回到我们的解决方案中，从而得到 2^n X 2^n 解决方案的答案。

现在是在每个图块中查找入口和出口点的部分。假设该行从 (2.4, 4.6 ) 开始并在 (7.9, 6.3) 结束

*   由于线的起点和终点的 x 坐标是 2.4 和 7.9，因此，它们之间的所有整数值都将与我们的线相交，即 x 坐标为 3、4、5、6、7 的图块将相交。我们可以使用输入线的方程计算这些 x 坐标对应的 y 坐标。
*   类似地，线的起点和终点的 y 坐标之间的所有整数都将导致线和图块之间的另一组交点。
*   根据它们的 x 坐标对所有这些点进行排序。现在成对挑选它们，第一个将是入口点，第二个将是出口。
*   将这些点乘以 2^n 以获得原始问题的解决方案。

**算法复杂度： O(nlog n )**其中 n 是线的开始坐标和结束坐标之间的整数范围。通过小的修改，这可以进一步减少到 O(n)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:27:47.727

在 x0..x1 范围内插入 x 的每个整数值，并求解每个 y。这将为您提供瓷砖两侧的交叉点的位置。

在 y0..y1 范围内插入 y 的每个整数值，并求解 x。这将为您提供瓷砖顶部/底部的交叉点的位置。

**编辑**

当处理不同的图块大小并从图块内部开始时，代码会变得有点难看，但想法是一样的。这是 C# 中的一个解决方案（在[LINQPad](http://www.linqpad.net/)中按原样运行）：

```
List<Tuple<double,double>> intersections = new List<Tuple<double,double>>();

int tile_width = 4;

int x0 = 3;
int x1 = 15;
int y0 = 1;
int y1 = 17;

int round_up_x0_to_nearest_tile = tile_width*((x0 + tile_width -1)/tile_width);
int round_down_x1_to_nearest_tile = tile_width*x1/tile_width;

int round_up_y0_to_nearest_tile = tile_width*((y0 + tile_width -1)/tile_width);
int round_down_y1_to_nearest_tile = tile_width*y1/tile_width;

double slope = (y1-y0)*1.0/(x1-x0);
double inverse_slope = 1/slope;

for (int x = round_up_x0_to_nearest_tile; x <= round_down_x1_to_nearest_tile; x += tile_width)
{
    intersections.Add(new Tuple<double,double>(x, slope*(x-x0)+y0));
}

for (int y = round_up_y0_to_nearest_tile; y <= round_down_y1_to_nearest_tile; y += tile_width)
{
    intersections.Add(new Tuple<double,double>(inverse_slope*(y-y0)+x0, y));
}

intersections.Sort();

Console.WriteLine(intersections); 
```

这种方法的缺点是，当直线与一个瓦片正好在一个角上相交时（即交叉点的 x 和 y 坐标都是整数），那么相同的交叉点将从 2 个中的每一个添加到列表**中**循环。在这种情况下，您可能希望从列表中删除重复的交点。

# service - 如何在其他 portlet 中使用 Liferay 服务构建器 jar

> ID：13884201
> 
> 赞同：4
> 
> 时间：2012-12-14T18:19:32.147
> 
> 标签：service, liferay, jndi, builder

我有一个使用服务构建器构建的 Liferay 门户项目。在生成 portlet 时，还创建了一个 jar，我想在其他 portlet 中使用该 jar。从这里和其他地方的帖子中，建议的方法是将 myPortletName-portlet-services.jar 放在另一个 portlet 的 WEB-INF/lib 文件夹中。我还看到了 *-portlet-services.jar 放在 Tomcat 的 /lib/ext 文件夹中的位置。我还阅读了应该使用依赖项更新 liferay-plugin-package.properties 的位置。

我尝试了每种方法，每种方法都产生了非常接近工作的结果。服务构建器构建的 jar 引用了与 LR 数据库不同的 jndi/jdbc 全局资源，当从该 jar 调用方法时，我收到“用户缺少权限或找不到对象：”错误（我已在其他地方发布过有关此内容）。

我的预感是 jar 对 Spring/Hibernate 的一些依赖没有得到满足。那，或者当 jar 放置在服务构建器部署的门户之外时，jndi/jdbc 资源不“可见”。无论如何，很明显找到了 jar 的方法（否则可怕的 beanLocator 错误），所以现在它只是一个 DB 连接问题。

问题是：当服务构建器生成的 jar 放置在其他门户中的原始门户之外时，是否存在一些结构依赖关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-12T07:00:02.697

要在其他 portlet 中使用 Liferay 服务构建器 jar，请尝试：

1.  在 Tomcat（或其他应用程序服务器）的 lib 中创建放置在 jar 中的[ServiceLocator 。](http://en.wikipedia.org/wiki/Service_locator_pattern)
2.  通过setter将您的bean从服务构建器设置为服务定位器作为spring上下文中的静态字段（setter必须设置静态字段）
3.  接下来实现 bean，它将使用来自服务定位器的 bean 并将 delagate 调用

    *   只需通过放置在 tomcat lib 中的类静态字段从服务构建器传递您的 bean（随处可见）
    *   将所需的接口也放在 lib 的 jar 中

# html - 你能有一个单一的逻辑 拆分为多个 年代？

> ID：13884204
> 
> 赞同：17
> 
> 时间：2012-12-14T18:19:43.763
> 
> 标签：html

在我现有的网页布局中，涉及多个文件，一个指定高级布局，有两个元素，一个用于左列，一个用于右列。

我想要一个单一的逻辑`<form>`（带有一个动作），其中`<input>`元素分布在左列和右列。做到这一点的唯一方法是让元素成为两个`<div>`s 的父级（并重构我的布局代码），还是可以`<form [something]>`在两个 div 中执行类似的操作，以便在一个表单中单击提交提交来自两个表单的所有输入？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-14T19:15:22.697

我认为人们错过了这个问题。A`<form>`可以包含它需要的任何元素。如果您的页面布局类似于：

```
<body>
    <div id="leftColumn"><input name="foo" type="text"></div>
    <div id="rightColumn"><input name="bar" type="text"></div>
<body> 
```

您不需要单独`foo`的和`bar`表格。您可以愉快地将这两个`<div>`s 包含在一个`<form>`元素中：

```
<body>
    <form name="onlyOneForm">
        <div id="leftColumn"><input name="foo" type="text"></div>
        <div id="rightColumn"><input name="bar" type="text"></div>
    </form>
<body> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-14T18:21:04.537

提交这两个表单的唯一方法是将两个`<div>`s 包装在一个`<form>`标记中。或者，您可以使用 jQuery/JavaScript 聚合数据并将它们作为一个提交一起提交。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-15T00:39:08.277

（很抱歉不接受答案并发布我自己的答案，但我发现我得到的答案显然不是 HTML5 最新的！）

HTML5为元素 [1]引入了一个`form=`属性。`<input>`这样你就可以做`<input form="form1" name="input1" /> and have it in a nested inner form, or even outside of the``元素。

[1] [http://www.w3.org/TR/html5/association-of-controls-and-forms.html#attr-fae-form](http://www.w3.org/TR/html5/association-of-controls-and-forms.html#attr-fae-form)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T18:21:42.327

简短的回答是**不**，你不能有两个单独`form`的标签作为 1 形式，而是将整个东西包装在一个包装 div 标签内

```
<form>
  <!-- some content with input elements has no relation with other form tag on this page, it just ends where you specify the end tag -->
</form>

<form>
  <!-- Has  no relation with the first form -->
</form> 
```

# java - 检查地图中的键

> ID：13884205
> 
> 赞同：-3
> 
> 时间：2012-12-14T18:19:48.463
> 
> 标签：java

我有这个方法应该检查一个键是否在地图中，然后增加一个值。

```
 papers.add(paper); //add a paper to the paper collection
    papersOrdered.get(papers); //returns the papers
    if(!(papersOrdered.containsKey(paper))) {
        paperNo = 1;
        String noPaper = Integer.toString(paperNo); //convert the paperNo integer to a String
        papersOrdered.put(papers,noPaper); //put the rooNo and the paper collection into the HashMap
        System.out.println("'" + paper + "'" + " has been added to the paper order. " + noPaper + " copy ordered" ); //a message to say a paper has been added
    }
    else{
        paperNo = paperNo ++;
        String noPaper = Integer.toString(paperNo); //convert the paperNo integer to a String
        papersOrdered.put(papers,noPaper); //put the rooNo and the paper collection into the HashMap
        System.out.println("'" + paper + "'" + " has been added to the paper order." + noPaper + " copies ordered" ); //a message to say a paper has been added
    }
    System.out.println("======================================================="); ; //a line to seperate text 
    System.out.println(" "); //a blank line 
```

但是它不起作用，我不知道为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:34:40.367

查看 Google Guava 的 Multiset，它就是这样做的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:02:24.157

基于您的原始代码，但将整数而不是字符串放入 HashMap 值中，并在为该类型的纸张添加新订单时递增键的当前值。

```
int paperNo;
String paper;
HashMap papersOrdered;
...
papers.add(paper); //add a paper to the paper collection
papersOrdered.get(papers); //returns the papers
if(!(papersOrdered.containsKey(paper))) {
    paperNo = 1;
    papersOrdered.put(papers, new Integer(paperNo)); //put the rooNo and the paper collection into the HashMap
    System.out.println("'" + paper + "'" + " has been added to the paper order. " + paperNo + " copy ordered" ); //a message to say a paper has been added
} else{
    paperNo = papersOrdered.get(paper) + 1; //get the current value, and add 1 to it
    papersOrdered.put(papers, new Integer(paperNo)); //put the rooNo and the paper collection into the HashMap
    System.out.println("'" + paper + "'" + " has been added to the paper order." + paperNo + " copies ordered" ); //a message to say a paper has been added
}
System.out.println("======================================================="); ; //a line to seperate text 
System.out.println(" "); //a blank line 
```

# silverlight - 基于 Windows 用户的 Lightswitch 表单身份验证问题？

> ID：13884211
> 
> 赞同：0
> 
> 时间：2012-12-14T18:20:01.403
> 
> 标签：silverlight, iis-7, forms-authentication, visual-studio-lightswitch

首先，如果我未能找到答案，我深表歉意 - 我尝试了各种搜索主题，但没有一个直接相关。

我部署了一个 Lightswitch 应用程序并且工作正常，在 IIS 7 和 Windows Server 2008 上运行。它只是一个内部 Intranet 应用程序。

我只使用FORMS AUTHENTICATION，所有其他人都被禁用。

该应用程序适用于大多数 Windows 用户。然而，一些 Windows 用户只得到一个空白屏幕 - 没有登录，没有“正在加载...”，也没有 silverlight“98%”显示。

在 IIS 日志中，当他们尝试加载应用程序时，我什至看不到它在哪里被访问？

所以，我的问题是，由于这只是 FORMS 身份验证，根据哪个 Windows 用户尝试运行该应用程序，是什么导致它无法工作？

换句话说，在同一台 Windows 7 机器上，它适用于 10 个用户，但不适用于其他用户。顺便说一句，应用程序是远程的——它没有在本地机器上运行。

用户能够访问由同一 IIS 服务器托管在同一根 inetpub 文件夹中的其他 ASP.NET 应用程序。

lightswitch 应用程序在 calssic 托管管道模式下使用 ASP.NET v4.0 Classic 应用程序池。

非常感谢任何帮助！！！很高兴发布任何详细信息/配置/日志 - 我还没有这样做，因为我不确定什么最有用....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T14:22:43.477

在用户计算机上，您需要使用 Fiddler 或 Internet Explorer 中的 F12 工具来准确查看正在对服务器进行哪些调用以及哪些调用失败了。LightSwitch 只是一个启动 Silverlight 应用程序的 ASP.net 网站。

所以我唯一能想到的另一件事是那些用户没有在他们的机器上安装 Silverlight？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T17:45:06.980

用户需要安装最新版本的 Silverlight。使用 LightSwitch 2011 构建的应用程序需要 v4 或更高版本，使用 LightSwitch for Visual Studio 2012 构建的应用程序需要 v5

[银光安装](http://www.microsoft.com/getsilverlight/get-started/install/default.aspx)

# git - 使用 Web 界面设置 Git 服务器

> ID：13884212
> 
> 赞同：0
> 
> 时间：2012-12-14T18:20:08.887
> 
> 标签：git, version-control

我已经使用 WebDav 在 apache 下的 Ubuntu 服务器上安装了 git。现在，当我通过 127.0.0.1/myproject.git 访问网络时，我会看到 git 的目录和文件，即分支、配置、描述、信息、参考等。

我已经安装了 git-core 和 gitweb，但我仍然看不到在 web 上提交的代码，也看不到那里的修订。我需要做什么才能看到所有这些代码文件并浏览它们以及查看最新提交。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:10:10.400

gitweb 应该让您了解您的需求。确保您已正确设置它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T09:03:24.240

我得到了答案。我需要安装 ViewVC 或 Rhodecode

# php - 更改 jQuery 选项卡上的固定内容

> ID：13884216
> 
> 赞同：0
> 
> 时间：2012-12-14T18:20:19.977
> 
> 标签：php, javascript, jquery, ajax

遇到问题 jQuery 如此`$('#tabs').tabs();`处所示[JSFIDDLE](http://jsfiddle.net/qTXnN/4/)包含外部 php 文件的内容

```
 <li class="files">

                <a href="msg_inbox.php">Compose Message</a>
            </li> 
```

即使在其他选项卡上悬停时也会不断显示。我想最终更改所有锚标记并将它们链接到其他 php 文件。我想了解为什么这个固定内容会如此，以及如何消除这个问题以及可能有的其他提示。我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:23:27.183

代替

`event:'mouseover'`

和

`event:'click'`

演示 - [http://jsfiddle.net/qTXnN/5/](http://jsfiddle.net/qTXnN/5/)

## 更新

那是因为`<a href="msg_inbox.php">`应该是`<a href="#one">`

# java - 忽略聊天中的 ChatState 数据包并在 SMACK 中的控制台中登录聊天状态

> ID：13884228
> 
> 赞同：0
> 
> 时间：2012-12-14T18:21:18.100
> 
> 标签：java, smack

我开发了一个简单的聊天客户端，它可以发送和接收消息以及用户在 2 个用户（userx 和 usery）之间输入 CHatState 通知。在调试窗口中，我看到包含正文或带有聊天状态的数据包。所有数据包都被正确记录。

**问题 1：**但我的窗口同时显示在聊天（JLabel）中。正因为如此，每当一个用户开始打字时，另一个用户会在他的窗口中看到一条空消息，这实际上是一个包含聊天状态通知的数据包，没有任何正文。我尝试了各种条件，但都失败了。我尝试了以下荒谬的 if 条件，但它显示空数据包。

```
if (message != null || message.getBody().isEmpty() == false
                    || message.getBody() != null
                    || message.getBody().toString().compareTo("null") == 1
                                            && message.getError() == null) 
```

**问题 2：**我无法记录发送的通知聊天状态。我的代码如下：

```
import java.applet.Applet;

public class ChatBoard extends JFrame implements MessageListener {

    private static final long serialVersionUID = 1L;
    private JPanel contentPane;
    static String username, password;
    static XMPPConnection connection;
    private JTextField textField;
    static JLabel board = new JLabel("<html>");
    static Chat chat;
    String message;
    static ChatState status;
    static String to;
    static boolean flag = false;
    JLabel typingStat;

    public class typingStatus implements ChatStateListener {

        @Override
        public void stateChanged(Chat arg0, ChatState arg1) {
            // TODO Auto-generated method stub

            System.out.println(arg1.name());

        }

        @Override
        public void processMessage(Chat arg0, Message arg1) {
            // TODO Auto-generated method stub
            System.out.println(arg1.getBody());

        }

    }

    public void sendChat(String msg) {
        try {
            to = "harsh00008";
            if (username.compareTo(to) == 0)
                to = "usery@xyz";
            else
                to = "userx@xyz";

            chat = connection.getChatManager().createChat(to, this);

            chat.sendMessage(msg);
        } catch (XMPPException e) {

            e.printStackTrace();
        }

    }

    public void changeStatus() {
        // TODO Auto-generated method stub
        if (username.compareTo("harsh00008") == 0)
            chat = connection.getChatManager().createChat("test@prc.p1.im",
                    this);
        else
            chat = connection.getChatManager().createChat(
                    "harsh00008@prc.p1.im", this);

        if (textField.getText().isEmpty() == false && flag == false) {
            try {
                ChatStateManager.getInstance(connection).setCurrentState(
                        ChatState.composing, ChatBoard.chat);

                flag = true;
            } catch (XMPPException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
        } else {
            if (textField.getText().isEmpty() == true && flag == true) {
                try {
                    ChatStateManager.getInstance(connection).setCurrentState(
                            ChatState.paused, ChatBoard.chat);

                    flag = false;
                } catch (XMPPException e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
            }

        }

    }

    public ChatBoard(String user, String pass) {

        setVisible(true);

        username = user;
        password = pass;

        //JFRAME CREATION CODE OMITTED

        textField.getDocument().addDocumentListener(new DocumentListener() {

            @Override
            public void removeUpdate(DocumentEvent e) {
                // TODO Auto-generated method stub
                changeStatus();

            }

            @Override
            public void insertUpdate(DocumentEvent e) {
                // TODO Auto-generated method stub
                changeStatus();

            }

            @Override
            public void changedUpdate(DocumentEvent e) {
                // TODO Auto-generated method stub
                changeStatus();

            }
        });

        sendButton.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                if (textField.getText().isEmpty() == false) {
                    sendChat(textField.getText().toString());
                    board.setText(board.getText() + "<br>me : "
                            + textField.getText());
                    changeStatus();
                    textField.setText("");
                }

            }
        });

        JLabel info = new JLabel("Press Enter or click");

        JButton exit = new JButton("Exit");
        exit.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                setVisible(false);
                WelcomeUser w = new WelcomeUser();
                connection.disconnect();
                w.setVisible(true);
            }
        });

        // ////////////////////////////////////////////

        XMPPConnection.DEBUG_ENABLED = true;

        ConnectionConfiguration config = new ConnectionConfiguration(
                "prc.p1.im", 5222, "prc.p1.im");

        connection = new XMPPConnection(config);

        try {
            connection.connect();

        } catch (XMPPException e) {

            e.printStackTrace();
            System.out.println("Not Connected. Error :" + e.getMessage());
        }

        try {
            connection.login(username, password);

        } catch (XMPPException e) {

            flag = false;

            textField.setVisible(false);
            sendButton.setVisible(false);

            info.setText("Invalid Login!");

            welcomeLabel.setText("Invalid user!");

        }

        connection.getChatManager().addChatListener(new ChatManagerListener() {

            public void chatCreated(final Chat chat,
                    final boolean createdLocally) {

                chat.addMessageListener(new MessageListener() {

                    public void processMessage(Chat chat, final Message message) {
                        try {
                            SwingUtilities.invokeAndWait(new Runnable() {

                                @Override
                                public void run() {

                                    String sender = message.getFrom();
                                    if (username.compareTo("usery") == 0)
                                        sender = "h";
                                    else
                                        sender = "t";

                                    if (message != null
                                            || message.getBody().isEmpty() == false
                                            || message.getBody() != null
                                            || message.getBody().toString()
                                                    .compareTo("null") == 1
                                            && message.getError() == null)
                                        board.setText(board.getText()
                                                + "<br> <font color=red>"
                                                + sender
                                                + " </font>:<font color=black> "
                                                + message.getBody() + "</font>");
                                    URL url = getClass().getResource(
                                            "resource/ultrakill_ultimate.wav");
                                    AudioClip clip = Applet.newAudioClip(url);
                                    clip.play();
                                }
                            });
                        } catch (InvocationTargetException e) {

                            e.printStackTrace();
                        } catch (InterruptedException e) {

                            e.printStackTrace();
                        }

                    }

                });

            }

        });

    }

    @Override
    public void processMessage(Chat arg0, Message arg1) {

        message = arg1.getBody();
        try {
            SwingUtilities.invokeAndWait(new Runnable() {

                @Override
                public void run() {

                }
            });
        } catch (InvocationTargetException e) {

            e.printStackTrace();
        } catch (InterruptedException e) {

            e.printStackTrace();
        }

    }

} 
```

**详细信息：** 正常的消息包是这样的：

```
<message id="5KE6T-11" to="usery@xyz" from="userx@xyz/Smack" type="chat">
  <body>hi people</body>
  <thread>fqw5912</thread>
  <active xmlns="http://jabber.org/protocol/chatstates"/>
</message> 
```

聊天状态数据包是这样的：

```
<message id="IgIbv-13" to="userx@xyz" from="usery@xyz/Smack" type="chat">
  <thread>fqw5913</thread>
  <composing xmlns="http://jabber.org/protocol/chatstates"/>
</message> 
```

**截屏 ：** ![在此处输入图像描述](../Images/d011b85729fe19a399fbebb08146570a.png)

任何意见？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:37:56.980

1）你是对的，这种情况很荒谬，而且非常错误。

```
if (message != null || message.getBody().isEmpty() == false
                        || message.getBody() != null
                        || message.getBody().toString().compareTo("null") == 1
                                                && message.getError() == null) 
```

总会有一条消息传入，因此消息永远不会为空，并且此条件将始终通过，这是一件好事，因为如果正文为空，它将抛出 NPE。

你想要做的是：

```
if (message.getBody() != null)  // getBody() returns null if there is no body so check for empty is unnecessary. 
```

所有其他检查要么是不必要的，要么是多余的。

2）您实际上并没有创建您的 ChatStateListener 或将其注册到 Chat (addMessageListener)。这就是您收不到聊天状态消息的原因。

除了这些之外，您每次发送消息或调用 DocumentListener 时都会创建一个新的聊天。我不认为这是你真正想要的。我认为您想在同一个聊天中发送和接收。

**提示和技巧**

您的代码在编码标准方面也存在很多明显的问题，因此我还将添加一些提示（请不要认为这是一种侮辱，我只是想帮助您提高 Java 技能）。

```
if (<boolean condition> == false) // It is already evaluated to true or false 
```

应该

```
if (!<boolean condition>) 
```

例如

```
if (message.getBody().isEmpty() == false) 
```

应该

```
if (!message.getBody().isEmpty()) 
```

如果 ( == true)

应该

```
if (<boolean condition>) 
```

*   不要把你的内部类和方法混在一起，要么把它们都放在之前或之后。
*   类名总是以大写字母开头。
*   不要将静态变量用于基于实例的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-28T05:20:27.223

对于第二个问题，你可以参考这个例子来使用 ChatStateListener ：

```
/**
* 
* listening for chat state change from server and change that state in
* model
* 
* */
private class DefaultChatStateListener implements ChatStateListener {

public void stateChanged(Chat user, ChatState event) {
    System.out.println("Getting called here...");
    System.out.println(user.getParticipant() + " is " + event.name());

    String state = event.name();
    TypingStateType typingState = null;
    if (state.equals("active")) {
        typingState = TypingStateType.ACTIVE;
    } else if (state.equals("composing")) {
        typingState = TypingStateType.TYPING;
    } else if (state.equals("paused")) {
        typingState = TypingStateType.PAUSED;
    } else if (state.equals("inactive")) {
        typingState = TypingStateType.INACTIVE;
    } else if (state.equals("gone")) {
        typingState = TypingStateType.GONE;
    }
    controller.typingStateUpdated(genericConnection, typingState, user
            .getParticipant().toString());
}

public void processMessage(Chat arg0, Message arg1) {
    // Do nothing

}

} 
```

使用 DefaultChatStateListener ：

```
lastChat = connection.getChatManager().createChat(
                                    connection.getHost(),
                                    new DefaultChatStateListener()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-28T09:25:07.723

这是一个更简单的演示，您可以参考：

```
import org.jivesoftware.smack.Chat;
import org.jivesoftware.smack.ChatManager;
import org.jivesoftware.smack.ChatManagerListener;
import org.jivesoftware.smack.ConnectionConfiguration;
import org.jivesoftware.smack.MessageListener;
import org.jivesoftware.smack.XMPPConnection;
import org.jivesoftware.smack.XMPPException;
import org.jivesoftware.smack.packet.Message;

public class Test {
    public static void main(String args[]) throws XMPPException {
        ConnectionConfiguration config = new ConnectionConfiguration("127.0.0.1", 5222);
        XMPPConnection connection = new XMPPConnection(config);             
        connection.connect();       
        connection.login("userx", "123456");    
        ChatManager cm = connection.getChatManager();   
        Chat chat = cm.createChat("usery", null);   
        /**
         * add listener
         */
        cm.addChatListener(new ChatManagerListener() {
            @Override
            public void chatCreated(Chat chat, boolean create) {
                chat.addMessageListener(new MessageListener() {
                    @Override
                    public void processMessage(Chat chat, Message msg) {
                        System.out.println(chat.getParticipant() + ":" + msg.getBody());
                    }
                });
            }
        });
        chat.sendMessage("test");   
        while(true);            //keep this chat
        //connection.disconnect();  
    }
} 
```

# java - Spring MVC 3.0 - 多种形式还是一种形式？

> ID：13884241
> 
> 赞同：0
> 
> 时间：2012-12-14T18:21:58.177
> 
> 标签：java, spring, spring-mvc, web-deployment

我正在构建一个具有搜索框的页面，该搜索框将在同一页面上填充网格。还有一个按钮，用户可以选择打开一个“窗口”（同一页面中的 JQuery UI“弹出”），让用户配置所述网格。

这是两个单独的表单，但我不希望作为其中一部分提交的内容撤消另一个（因此当用户提交以更改网格布局时，搜索也需要重新运行。

我宁愿不为此在会话中存储东西，因为这会带来它自己的问题（搜索结果可能很大，以后重新进入页面时不应该保存，等等）。

我考虑过为由表单支持 bean 支持的整个页面执行“一个大型表单”（即围绕所有输入）。然后，我将使用单击哪个按钮来确定要采取的操作。页面上最终还会有其他按钮来添加更多功能。这类似于 .NET（非 MVC）处理事物的方式。

我对其他人如何解决类似的挑战很感兴趣。我的方法是否存在我没​​有看到的潜在问题？与框架一起工作的更好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:33:34.370

你是什​​么意思：

> 但我不希望作为其中一部分提交的内容撤消另一个

. 您是指发布表单并加载整个页面，这反过来会“重置”另一个表单？

如果是这种情况，我仍然会保留一个包含两个表单的页面并使用 Ajax 发布帖子（您可能知道 jQuery 让这变得轻而易举）。在收到任何一个电话的回复后，您需要相应地更新另一个表格。

请注意，如果有助于保持代码整洁，然后将带有 Ajax 调用的 html 拉到另一个视图中，您可能仍会将表单放在两个单独的视图中。但我的观点是，最后我仍然会将两者都保留在一个页面中，因为听起来它们彼此依赖，所以当其他更改时更新一个可能更容易这样，

如果我误解了你的问题，请告诉我。

# javascript - 如何让jQuery在窗口调整大小时动态添加css

> ID：13884242
> 
> 赞同：0
> 
> 时间：2012-12-14T18:22:08.737
> 
> 标签：javascript, jquery, css

我目前正在水平和垂直对齐一个 div。它的宽度和高度取决于其孩子的大小。我正在使用此代码成功地做到这一点。

```
$('.tiles-wrapper').css({top:'50%',left:'50%',margin:'-'+($('.tiles-wrapper').height() / 2)+'px 0 0 -'+($('.tiles-wrapper').width() / 2)+'px'}); 
```

我希望它在调整页面窗口大小时继续工作，因为它目前没有。任何帮助都会很棒。谢谢

在你的帮助下，我得到了它的工作。这是布置代码的最佳方式吗？

```
<script>
    $('.tiles-wrapper').css({top:'50%',left:'50%',margin:'-'+($('.tiles-wrapper').height() / 2)+'px 0 0 -'+($('.tiles-wrapper').width() / 2)+'px'});

    $(window).resize(function() {
        $('.tiles-wrapper').css({top:'50%',left:'50%',margin:'-'+($('.tiles-wrapper').height() / 2)+'px 0 0 -'+($('.tiles-wrapper').width() / 2)+'px'});
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:24:06.827

您是否尝试过使用[jQuery 窗口调整大小](http://api.jquery.com/resize/)功能`$(window).resize(function() {} );`？每当调整页面大小时，都会调用此函数中的任何内容：

```
$(window).resize(function() {
    $('.tiles-wrapper').css({top:'50%',left:'50%',margin:'-'+($('.tiles-wrapper').height() / 2)+'px 0 0 -'+($('.tiles-wrapper').width() / 2)+'px'});

}); 
```

您也可以通过手动调用此函数`$(window).resize();`

# asp.net - Sitecore 6.x /sitecore/login 解析器错误

> ID：13884246
> 
> 赞同：2
> 
> 时间：2012-12-14T18:22:29.513
> 
> 标签：asp.net, iis-7.5, sitecore

如果我在 web conашп 目标中设置为 4.5 框架是下一个，我发现了 sitecore 管理页面的一个有趣问题

```
>  compilation defaultLanguage="c#" debug="true" targetFramework="4.5"
> enablePrefetchOptimization="true" 
```

我得到下一个错误：

```
Parser Error 
Description: An error occurred during the parsing of a resource required to service this request. Please review the following specific parse error details and modify your source file appropriately. 

Parser Error Message: The base class includes the field 'StartPage', but its type (System.Web.UI.HtmlControls.HtmlGenericControl) is not compatible with the type of control (System.Web.UI.HtmlControls.HtmlIframe).

Source Error: 

Line 71:             </div>
Line 72:             <div id="SDN">
Line 73:                 <iframe id="StartPage" runat="server" allowtransparency="true" frameborder="0" scrolling="auto"
Line 74:                     marginheight="0" marginwidth="0" style="display: none"></iframe>
Line 75:             </div> 
```

如果 targetFramework arrrib 是 4.0 一切正常。如何解决？我的目标是在完整的 4.5 FW 模式下工作，我已经另外设置了

```
<httpRuntime 
encoderType="System.Web.Security.AntiXss.AntiXssEncoder,System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"   
maxRequestLength="512000" 
executionTimeout="600" 
enableKernelOutputCache="false" 
targetFramework="4.5" 
requestValidationMode="4.0"/> 
```

和`<add key="ValidationSettings:UnobtrusiveValidationMode" value="None"/>`

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T00:46:20.490

在 Sitecore 6.6 中找到了一个超级简单的解决方案。只需将 iFrame 重命名为 div！

```
 <div id="SDN">
            <div id="StartPage" runat="server" allowtransparency="true" frameborder="0" scrolling="auto"
                marginheight="0" marginwidth="0" style="display: none"></div>
        </div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T00:31:41.140

您的目标框架必须为 4.0，Sitecore 才能正常工作。尚不支持 4.5 版

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-04-01T22:01:55.423

首先，您需要在 Website\sitecore\login 中找到并编辑文件 default.aspx。

改变这个：

```
<div id="SDN">
    <iframe id="StartPage" runat="server" allowtransparency="true" frameborder="0" scrolling="auto"
                marginheight="0" marginwidth="0" style="display: none"></iframe>
</div> 
```

对此：

```
<div id="SDN">
    <div id="StartPage>   </div>
</div> 
```

保存此文件。

The iframe displays browser compabitibilty information from sitecore on the right side of the login page.

What happens is that when you use .NET 4.5, the iframe compiles to an HtmlIframe control. The code behind file from sitecore however has the iframe as an HtmlGeneric control. Hence the message.

By changing the iframe to a div, ASP.NET will generate an HtmlGeneric from the .aspx page which matches what is in the compiled code behind and the login page is then able to load.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-20T01:04:04.980

我遇到了同样的错误，并在 web.config 文件的复杂条目中添加了“targetFrameowkr=4.5.1”并修复了问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-07T09:51:04.797

I have faced the same problem and i have changed the target framework from 4.0 to 4.5 in web.config file.

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2012-12-15T06:58:16.030

我找到了解决方案，我只需要自定义登录页面。

# regex - Nutch regex-urlfilter 语法

> ID：13884249
> 
> 赞同：4
> 
> 时间：2012-12-14T18:22:33.337
> 
> 标签：regex, web-crawler, nutch

我正在运行 Nutch v. 1.6，它正在正确地抓取特定站点，但我似乎无法为该文件获取正确的语法`NUTCH_ROOT/conf/regex-urlfilter.txt`。

我要抓取的网站有一个类似这样的 URL：

```
http://www.example.com/foo.cfm 
```

在该页面上有许多与以下模式匹配的链接：

```
http://www.example.com/foo.cfm/Bar_-_Foo/Extra/EX/20817/ID=6976 
```

我也想抓取与上面第二个示例匹配的链接。在我的`regex-urlfilter.txt`我有以下内容：

```
+^http://www.example.com/foo.cfm$
+^http://www.example.com/foo.cfm/(.+)*$ 
```

Nutch 匹配第一个并正确抓取它，但似乎没有使用另一个过滤器获取链接。如何让 Nutch 像上面第二个那样抓取 URL？

我试过以下没有运气：

```
+^http://www.example.com/foo.cfm/(.+)*$
+^http://www.example.com/foo.cfm/(.)*$
+^http://www.example.com/foo.cfm/.+$
+^http://www.example.com/foo.cfm/(.*)*$ 
```

在我的`NUTCH_ROOT/urls/nutch`我有：

```
http://www.example.com/foo.cfm/ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T10:32:36.267

根据[http://wiki.apache.org/nutch/FAQ#What_happens_if_I_inject_urls_several_times.3F](http://wiki.apache.org/nutch/FAQ#What_happens_if_I_inject_urls_several_times.3F)你不能有多个 URL（它们将被忽略）。**只**放什么：

```
+^http://www.example.com/foo.cfm/(.+)*$ 
```

这应该涵盖您的第一行：`+^http://www.example.com/foo.cfm$`以及，或者，如果有问题，请`/`尝试：

```
+^http://www.example.com/foo.cfm//?(.+)*$ 
```

哪里`//?`应该代表性格`/`或

# jquery - JSONP 和 ASMX 网络服务

> ID：13884253
> 
> 赞同：5
> 
> 时间：2012-12-14T18:22:53.670
> 
> 标签：jquery, asp.net, jsonp, asmx

我正在努力弄清楚如何使用 jQuery 对 ASMX Web 服务进行 JSONP 调用。这些只是我已经阅读但没有找到任何解决方案的一些页面：

[如何使用 jquery“jsonp”调用外部 web 服务？](https://stackoverflow.com/questions/729771/how-to-call-external-webservice-using-jquery-jsonp)

[使用 jQuery 将跨域 JSON 发布到 ASP.NET](https://stackoverflow.com/questions/2022878/posting-cross-domain-json-to-asp-net-with-jquery)

[使用 JQuery 访问 ASP.net Web 服务时出错 - JSONP](https://stackoverflow.com/questions/635547/error-while-accessing-asp-net-webservice-using-jquery-jsonp)

[使用 jQuery.ajax 和 JSONP 设置标题？](https://stackoverflow.com/questions/3073287/set-headers-with-jquery-ajax-and-jsonp)

[http://www.codeproject.com/Articles/43038/Accessing-Remote-ASP-NET-Web-Services-Using-JSONP](http://www.codeproject.com/Articles/43038/Accessing-Remote-ASP-NET-Web-Services-Using-JSONP)

[http://encosia.com/using-jquery-to-consume-aspnet-json-web-services/](http://encosia.com/using-jquery-to-consume-aspnet-json-web-services/)

ETC...

这是我的示例 .NET Web 方法：

```
[WebMethod]
[ScriptMethod(UseHttpGet = true, ResponseFormat = ResponseFormat.Json)]
public void GetEmployee(string employeeId, string callback)
{
    // Get the employee object from the Factory.
    Employee requestedEmployee = EmployeeFactory.GetEmployee(employeeId);

    if(requestedEmployee != null)
    {
        // Return the padded JSON to the caller.
        CrossDomainUtility.SendJsonP(callback, requestedEmployee.ToJson());
    }
} 
```

这是 SendJsonP()：

```
public static void SendJsonP(string callback, string json)
{
    // Clear any response that has already been prepared.
    HttpContext.Current.Response.Clear();

    // Set the content type to javascript, since we are technically returning Javascript code.
    HttpContext.Current.Response.ContentType = "application/javascript";

    // Create a function call by wrapping the JSON with the callback function name.
    HttpContext.Current.Response.Write(String.Format("{0}({1})", callback, json));

    // Complete this request, to prevent the ASMX web service from doing anything else.
    HttpContext.Current.ApplicationInstance.CompleteRequest();
} 
```

这是一些示例 jquery 代码：

```
$.ajax({
    url: 'http://devserver/service/service.asmx/GetEmployee',
    dataType: 'jsonp',
    contentType: 'application/json',
    data: { employeeId: '123456789' }
}); 
```

我有用 [ScriptService] 装饰的 Web 服务，并且我的 web.config 配置为使用 ScriptHandlerFactory 处理 *.asmx。

我尝试过使用 ASMX 在 Content-Type 为“application/json”时使用的内置 JSON 序列化，但有几个问题：由于需要包裹填充，它不能用于 JSONP .NET 不支持的 JSON。它也不起作用，因为为了序列化 JSON，ASMX 需要一个 'ContentType: application/json' 标头，但 jQuery 在发送 GET 请求时会忽略 ContentType 标头（可能是因为它不发送任何内容）。我尝试在 Global.asax Application_BeginRequest() 中设置 Request.ContentType = "application/json" 但这没有做任何事情。我还尝试使用 beforeSend() 在 jQuery 中设置请求标头，但没有成功。

因此，由于我无法使用内置的 .NET 管道轻松地使其工作，因此我推出了自己的技术，该技术对 Response 主体执行原始写入（因此使用了 SendJsonP() 方法）。不过我仍然遇到问题，因为即使 GetEmployee() Web 方法没有返回值，.NET 也会引发序列化错误，因为它试图将对象序列化为 XML，因为我无法传递“应用程序”的 ContentType /json' 带有 GET 请求。

因此，由于无论我做什么我都无法让 jQuery 添加 ContentType，我想通过使用 Fiddler2 创建手动请求来测试我的 Web 服务：

```
GET http://devserver/service/service.asmx/GetEmployee?callback=createMember&memberId=123456789
User-Agent: Fiddler
Content-Type: application/json
Host: devserver 
```

...它给出了以下错误，因为我的参数不是 JSON：

```
{"Message":"Invalid JSON primitive: createMember [....] } 
```

所以毕竟，我有几个问题：

1.  有没有办法使用内置的 .NET 序列化将填充应用于 JSON 并将其返回给客户端？

2.  由于看来我必须自己动手，所以在将带有参数的 JSONP 查询发送到 ASMX 页面时，我的查询字符串应该如何？它必须是 JSON 格式，但我尝试了以下操作并收到“无效的 JSON 原语”错误：

    GetEmployee?{callback:"createMember", memberId:"99999999"}

    GetEmployee?callback={callback:"createMember"}&memberId={memberId:"123456789"}

3.  有没有办法让 jQuery 发送带有 JSONP GET 请求的 ContentType 标头？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T17:34:32.567

我刚刚决定手动处理 JSONP 请求。在我的解决方案中，用户必须通过 GET 请求提供两个查询字符串参数，以表明他们想要 JSONP 结果：callback=callbackFunctionName 和 jsonp=true。如果这两个都收到了，我将手动处理它，否则请求将继续到标准 ASMX 处理器上。

我创建了一个新的 JsonPUtility 帮助器类，我已将其添加为 HttpApplication.BeginRequest 事件中的调用：

```
public class Global : System.Web.HttpApplication
{
    protected void Application_BeginRequest(object sender, EventArgs e)
    {
        // Requests for JSONP requests must be handled manually due to the limitations of JSONP ASMX.
        JsonPUtility.ProcessJsonPRequest();
    }
} 
```

这是 JsonPUtility 类：

```
/*
 *  JSON is Javascript Object Notation, a standard way of serializing objects in Javascript and
 *  other languages.  For more information see http://www.json.org/.
 * 
 *  JSONP is a technique to enable the execution of Javascript that resides in a different domain.  It 
 *  works by exploiting the exception granted to the <script> tag which allows content to be loaded
 *  from a different domain.  By contrast, making "regular" AJAX calls to a different domain will
 *  not work, usually throwing an "Access Denied" or "No Transport" error.
 *  
 *  JSONP (the "P" stands for "Padding") is regular JSON wrapped in a Javascript function call (the
 *  "Padding").  Take for example this standard JSON object:
 *      { "Name" : "John", "Age" : 14, "Gender" : "Male" }
 *      
 *  JSONP will turn that JSON into a valid Javascript function call by using the JSON as an argument
 *  to the callback function provided by the caller.  For example, if the caller provides a callback
 *  value of 'processResults', the resulting JSONP looks like this:
 *      processResults({ "Name" : "John", "Age" : 14, "Gender" : "Male" });
 *      
 *  The processResults() function will then be able to use the JSON object just like a regular object.
 *  Note that the callback function must be implemented on the page that receives the JSONP, otherwise
 *  a standard Javascript error will occur.
 *  
 *  The real "trick" to cross-domain script execution is dynamically creating a "script" tag on the
 *  client for every JSONP request, using the web service URL as the "src" attribute.  This will cause
 *  the browser to automatically download and execute the script that is loaded from the URL,
 *  effectively bypassing the same-domain origin policy.
 */
public static class JsonPUtility
{
    /*
     * SendJsonP(string callback, string json)
     *  
     *  This method takes the provided 'json' string, wraps it so that it is a parameter to the 'callback'
     *  function, clears any existing response text, writes the resulting Javascript code to the 
     *  response, and ends the response.
     *  
     *  For example, given these two parameters...
     *      callback    = "callbackFunction"
     *      json        = "{ 'FOO': 'BAR', 'JOO': 'MAR' }"
     *  
     *  ... the following code is returned to the client in an HTTP response with a content-type of
     *  'application/javascript':
     *      callbackFunction({ 'FOO': 'BAR', 'JOO': 'MAR' });
     *      
     */
    public static void SendJsonP(string callback, string json)
    {
        // Clear any response that has already been prepared.
        HttpContext.Current.Response.Clear();

        // Set the content type to javascript, since we are technically returning Javascript code.
        HttpContext.Current.Response.ContentType = "application/javascript";

        // Create a function call by wrapping the JSON with the callback function name.
        HttpContext.Current.Response.Write(String.Format("{0}({1});", callback, json));

        // Complete this request, to prevent the ASMX web service from doing anything else.
        HttpContext.Current.ApplicationInstance.CompleteRequest();
    }

    /*
     * bool IsJsonPRequest()
     * 
     *  Determines whether or not the current request is for JSONP javascript code.
     *  
     *  This is the criteria for making a JSONP request to this web service:
     *      1\. Include the jsonp parameter.  Its value is not important - we recommend using jsonp=true
     *         to increase clarity.
     *      2\. Include the callback=string parameter so we know what function call to wrap around
     *         the requested JSON.
     */
    public static bool IsJsonPRequest()
    {
        // Store the context to the current request.
        var request = HttpContext.Current.Request;

        // If a 'jsonp' or a 'callback' parameter was not provided, this isn't a JSONP request.
        if (request.QueryString["jsonp"] == null || String.IsNullOrEmpty(request.QueryString["callback"]))
            return false;

        // Since both parameters were provided, this is a jsonp request.
        return true;
    }

    /*
     * ProcessJsonPRequest()
     * 
     *  Manual processing is required for JSONP requests due to limitations in ASMX web services.
     */
    public static void ProcessJsonPRequest()
    {
        // If this isn't a JSONP request, simply return and continue regular request processing.
        if (!IsJsonPRequest())
            return;

        // Store the context to the HTTP request.
        var request = HttpContext.Current.Request;

        // Store the callback function that will be wrapped around the JSON string.
        string callback = request.QueryString["callback"];

        // Create a place to store the object that will be serialized into JSON.
        object objectForJson = null;

        // Store the web service method name that is being requested.  It is always going to follow the
        // final slash after the .asmx extension, and will continue until the question mark that marks
        // the query string.
        int     methodNameStartIndex = request.RawUrl.ToUpper().IndexOf(".ASMX/") + 6;
        int     methodNameLength = (request.RawUrl.IndexOf("?")) - methodNameStartIndex;
        string  requestMethod = request.RawUrl.Substring(methodNameStartIndex, methodNameLength);

        // Create a place to store the string ID of the object that is going to be looked-up.
        string lookupId = null;

        // Based on the request URL, figure out the method that will create a reference for the objectForJson variable.
        switch (requestMethod)
        {
            case "GetEmployee":
                // Get the employee's ID from the query string.
                lookupId = request.QueryString["employeeId"];

                // If the employee ID was provided, get a Employee object.
                if (!String.IsNullOrEmpty(lookupId))
                    objectForJson = Factory.GetEmployee(lookupId);

                break;

            case "GetManager":
                // Get the manager's ID from the query string.
                lookupId = request.QueryString["managerId"];

                // If the manager ID was provided, get a Manager object.
                if (!String.IsNullOrEmpty(lookupId))
                    objectForJson = Factory.GetManager(lookupId);

                break;

            case "GetOrder":
                // Get the order ID from the query string.
                lookupId = request.QueryString["orderId"];

                // If the order ID was provided, get the  object.
                if (!String.IsNullOrEmpty(lookupId))
                    objectForJson = Factory.GetOrder(lookupId);

                break;

            default:
                // If the request method wasn't handled, throw an exception.
                throw new ArgumentException("Unknown request method '" + requestMethod + "'.");
        }

        // Create a .NET framework object to serialize the object into JSON.
        JavaScriptSerializer jsonSerializer = new JavaScriptSerializer();

        // Serialize the object into JSON.  If objectForJson is null, the callback function will be passed a parameter of null (e.g. callback(null)).
        string json = jsonSerializer.Serialize(objectForJson);

        // Send the JSONP string back to the caller.
        SendJsonP(callback, json);
    }
} 
```

我希望这可以帮助将来的人。

谢谢，文斯

# javascript - 使用 replaceChild 更改输入类型在 IE8 中不起作用

> ID：13884258
> 
> 赞同：3
> 
> 时间：2012-12-14T18:23:15.083
> 
> 标签：javascript

我正在使用以下代码更改输入类型 onfocus 并将其重置为文本 onblur。但这不起作用

HTML

```
 <input type="password" onfocus="changeInputType(this,'text')"
                        onblur="changeInputType(this,'password')"> 
```

JS

```
 function changeInputType(oldObject, oType) {
     var newObject = document.createElement('input');
     var wrapper= document.createElement('div');
     wrapper.innerHTML= oldObject.outerHTML.replace('type=password','type=text');
     var newObject = wrapper.firstChild;
     oldObject.parentNode.replaceChild(newObject,oldObject);
     return newObject;
  } 
```

[这](http://jsfiddle.net/WfRFB/21/)是小提琴。它不工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-10T21:36:17.220

假设您想将 type 属性更改为模糊时的密码和焦点时的文本，那么您的代码不起作用的原因不止一个。

1.  您在替换调用中缺少双引号：`replace('type=password','type=text')`

2.  当您调用`replaceChild`标记被删除并触发另一个模糊事件时导致错误。

3.  您没有在`oType`任何地方使用该变量。

使用 type 属性更容易，如下面的代码：

```
function changeInputType(oldObject, oType) {
    oldObject.type = oType;
} 
```

# tsql - 复制从闰年到非闰年

> ID：13884263
> 
> 赞同：0
> 
> 时间：2012-12-14T18:23:26.677
> 
> 标签：tsql, copy, leap-year

我需要使用 T-SQL 2008 R2 复制从 2012 年到 2013 年的所有班次。每天有 3 个班次。开始日期和班次日期始终相同。结束日期（对于班次 c）是第二天。

![在此处输入图像描述](../Images/86ce14506e49caa772eea938a7225beb.png)

如您所见，如果我只使用 dateadd(year, 1, Col)，我会得到 2013-02-28 的 2 组记录。第 4、6 和 8 行不应该存在（并且会导致 PK 违规）。第 8 行是错误的，因为 C 班的结束时间应该是前一个日历日。

我总共有 67,000 行要复制

我唯一能想到的就是插入临时表，然后以某种方式识别重复/不正确的记录，删除然后插入回班次表。我相信一定有更好的方法

有人有一个狡猾的计划吗？

我想创建一个通用存储过程，可以将闰年复制到非闰年，反之亦然

问候

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T23:05:55.830

I figured it out BUT then found some resources were missing shifts for 2012

Ended up creating with tally table and just doing fresh inserts for every shift for the year

```
SELECT
                    rh.PlanPressID
                    ,DATEADD(hh,(24 / @NoOfShifts) * (t.N - 1),@StartDateTime) AS ShiftStart
                   ,DATEADD(hh,(24 / @NoOfShifts) * (t.N),@StartDateTime) AS ShiftEnd
                   ,CHAR((t.N - 1) % @NoOfShifts + 65) AS ShiftCode
                   ,DATEADD(dd,0,DATEDIFF(dd,0,DATEADD(hh,(24 / @NoOfShifts) * (t.N - 1),@StartDateTime))) AS ShiftDate
                   ,0 AS Personnel
                  FROM
                    dbo.Tally t
                  CROSS JOIN dbo.ResourceHeader AS rh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:13:30.483

也许尝试一个`DISTINCT`与 a 结合的列表`WHERE End > Start`，如这个简化的例子：

```
CREATE TABLE Shifts(ShiftCode CHAR, ShiftStart DATETIME, ShiftEnd DATETIME);
GO

INSERT Shifts
VALUES('A','2/26/2012 07:00:00','2/26/2012 15:00:00')
, ('B','2/26/2012 15:00:00','2/26/2012 23:00:00')
, ('C','2/26/2012 23:00:00','2/27/2012 07:00:00')
, ('A','2/27/2012 07:00:00','2/27/2012 15:00:00')
, ('B','2/27/2012 15:00:00','2/27/2012 23:00:00')
, ('C','2/27/2012 23:00:00','2/28/2012 07:00:00')
, ('A','2/28/2012 07:00:00','2/28/2012 15:00:00')
, ('B','2/28/2012 15:00:00','2/28/2012 23:00:00')
, ('C','2/28/2012 23:00:00','2/29/2012 07:00:00')
, ('A','2/29/2012 07:00:00','2/29/2012 15:00:00')
, ('B','2/29/2012 15:00:00','2/29/2012 23:00:00')
, ('C','2/29/2012 23:00:00','3/1/2012 07:00:00')
, ('A','3/1/2012 07:00:00','3/1/2012 15:00:00')
, ('B','3/1/2012 15:00:00','3/1/2012 23:00:00')
, ('C','3/1/2012 23:00:00','3/2/2012 07:00:00');
GO

SELECT DISTINCT ShiftCode
, ShiftStart = DATEADD(YYYY,1,ShiftStart)
, ShiftEnd = DATEADD(YYYY,1,ShiftEnd)
FROM Shifts
WHERE DATEADD(YYYY,1,ShiftEnd) > DATEADD(YYYY,1,ShiftStart)
ORDER BY DATEADD(YYYY,1,ShiftStart), ShiftCode
GO 
```

结果：

```
A         2013-02-26 07:00:00.000 2013-02-26 15:00:00.000
B         2013-02-26 15:00:00.000 2013-02-26 23:00:00.000
C         2013-02-26 23:00:00.000 2013-02-27 07:00:00.000
A         2013-02-27 07:00:00.000 2013-02-27 15:00:00.000
B         2013-02-27 15:00:00.000 2013-02-27 23:00:00.000
C         2013-02-27 23:00:00.000 2013-02-28 07:00:00.000
A         2013-02-28 07:00:00.000 2013-02-28 15:00:00.000
B         2013-02-28 15:00:00.000 2013-02-28 23:00:00.000
C         2013-02-28 23:00:00.000 2013-03-01 07:00:00.000
A         2013-03-01 07:00:00.000 2013-03-01 15:00:00.000
B         2013-03-01 15:00:00.000 2013-03-01 23:00:00.000
C         2013-03-01 23:00:00.000 2013-03-02 07:00:00.000 
```

# c - 核心转储和 IPC 包

> ID：13884273
> 
> 赞同：1
> 
> 时间：2012-12-14T18:24:14.057
> 
> 标签：c, semaphore

我的程序有小问题。不知道为什么启动程序的时候会弹出`Segmentation fault (core dumped)` My code for client.c

```
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sys/ipc.h>
#include <stdlib.h>
#include <string.h>

#define receiveKey 21
#define sendKey 11

int main(int argc, char *argv[])
{
    char msg[512];
    strcpy(msg, argv[1]);
    key_t key;
    key=ftok("/Downloads/zad6", getpid());

    int senQueue=msgget(sendKey,0777);
    int recQueue=msgget(receiveKey,0777);

    msgsnd(senQueue,&msg,strlen(msg),0);
    msgrcv(recQueue,&msg,sizeof(msg),0,0);

    printf("Translate result: %s\n", msg);
    return 0;    } 
```

# caching - 使用 ESI 作为用户菜单有意义吗？

> ID：13884274
> 
> 赞同：0
> 
> 时间：2012-12-14T18:24:14.587
> 
> 标签：caching, symfony, esi

用户菜单的 ESI 对您有意义吗？

我用 s-maxage 缓存的主页：

```
 $response = $this->render('MySiteBundle:Welcome:index.html.twig');
    $response->setSharedMaxAge(600);
    return $response; 
```

我通过 ESI 用户菜单包含的位置：

```
{% render 'MySiteBundle:Site:userMenu' with {}, {'standalone': true} %} 
```

登录用户的用户菜单不同。

```
 $response = $this->render('MySiteBundle:Site:userMenu.html.twig');
    $response->setPrivate();
    return $response; 
```

为此使用 ESI 有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:05:00.287

是的，这就是我在所有网站上的做法！

否则，人们将分享第一个点击它的菜单......他们会看到登录错误等......

顺便说一句，如果您使用共享缓存缓存您的主要操作，然后如果您在内部使用 ESI（独立为真），即使它是合乎逻辑的，请注意 Symfony 2.1 目前有一些麻烦！Symfony 2.0 不存在该错误，我希望它会被快速修复！ [https://github.com/symfony/symfony/issues/6227](https://github.com/symfony/symfony/issues/6227)

# html - 如何在 IE8 中使用高度 100%

> ID：13884280
> 
> 赞同：7
> 
> 时间：2012-12-14T18:24:37.040
> 
> 标签：html, css

我正在尝试使用 css 属性 height 100% 以便 div 占用浏览器中的所有可用空间。我可以让它与 Chrome 和 Firefox 一起工作，但不能与 IE8 一起工作。实际上，我知道在 IE8 中高度 100% 意味着 100% 的直接父级大小，这与 Firefox 或 Chrome 不同，它意味着 100% 的可用空间。

我想出了这个示例[http://jsfiddle.net/GdqjK/](http://jsfiddle.net/GdqjK/)

```
html, body {
  margin: 0; padding: 0;
  bottom:0px;
  height:100%;
}

.grid {
  display : table;
  width:100%;
}

.tablerow {
  display : table-row;
}

.tablecell {
  display : table-cell;
}

.grow {
  bottom:0px;
  height:100%;
} 
```

```
<div class="grid grow"> 
    <div class="tablerow">
        <div class="tablecell">
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
        </div>
    </div> 

    <div class="tablerow grow">
        <div class="tablecell grow" style="border: solid 3px">
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
        </div>
    </div> 

</div> 
```

您可以看到使用 IE8 运行它，第二行要大得多。有没有不使用固定高度的解决方法？我想保持 div 占用所有可用空间的相同行为。如果没有解决方案使其适用于 IE8，那么最好的降级解决方案是什么（可能是 IE8 的条件 css）。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T18:56:06.010

这个适用于 IE8+

[http://jsfiddle.net/DNEb3/2/](http://jsfiddle.net/DNEb3/2/)

```
<div class="grid"> 
    <div class="tablerow">
        <div class="tablecell" style="border: solid 3px">
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
        </div>
    </div> 

    <div class="tablerow grow">
        <div class="tablecell" style="border: solid 3px">
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
            a<br>
        </div>
    </div> 

</div> 

</body></html>​

html, body {
  margin: 0; padding: 0;
  bottom:0px;
  height:100%;
}

.grid {
  display : table;
  width:100%;
    height: 100%
}

.tablerow {
  display : table-row;
}

.tablecell {
  display : table-cell;
}
.grow {
  bottom:0px;
  height:100%;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-04-28T19:11:04.027

100% 高度可以使用表格完成。

只要确保你的`<html>`和`<body>`都是 100% 的高度。

**完整的工作示例：**

```
<!doctype html>
<html style='height:100%;'>
<body style='margin:0; height:100%;'> <!-- margin:0 is optional -->

<table style='background:green; height:100%;'>
    <tr>
        <td>Content</td>
    </tr> 
</table>

</body>
</html> 
```

# php - 使用 PHP 解析 HTML 时出错

> ID：13884282
> 
> 赞同：1
> 
> 时间：2012-12-14T18:24:44.153
> 
> 标签：php, xml, parsing

我正在尝试解析一些 HTML。这是我的代码：

```
xml_parse_into_struct($p, $initpage, $values);
foreach ($values as $key => $val) {
    if (($val['tag'] == 'INPUT') && ($val['attributes']['name'] == 'authenticity_token')) {
        $token = $val['attributes']['value'];
        break;
    }
}
echo $token; 
```

curl 或 XML 解析没有问题......我知道 $values 包括好东西，因为将`print_r($values)`输出，除其他外，这个：

> ```
> [48] => Array
>    (
>        [tag] => INPUT
>        [type] => complete
>        [level] => 8
>        [attributes] => Array
>             (
>                 [NAME] => authenticity_token
>                 [TYPE] => hidden
>                 [VALUE] => d76a4bec329537ac3322
>             )
> 
>     ) 
> ```

但是，当我尝试运行代码时，出现此错误：

> PHP 注意：未定义变量：第 49 行 /media/.sda3/pjotr/scripts/tweet.php 中的令牌

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:26:57.270

键是区分大小写的。您检查`name`，不匹配`NAME`。当然，同样适用`value`，所以你也需要解决这个问题。

# javascript - 在gridview中选择日期时间并在gridview中选择日期时更改下一个文本框值

> ID：13884283
> 
> 赞同：1
> 
> 时间：2012-12-14T18:24:57.587
> 
> 标签：javascript, asp.net

场景是我在网格视图中有一个日期时间列，在选择日期时间列后，我需要在网格视图的下一列文本框中显示计算值

我无法根据日期选择计算值，尽管我可以通过 jquery 选择日期并将其放在文本框中。但它不会根据选择更改下一个文本框值。代码如下

```
 <asp:TemplateField HeaderText="Issue Date">
        <ItemStyle Width="140px" />
        <ItemTemplate>
            <asp:TextBox ID="txtIssueDate" runat="server" Width="110px" Text='<%#Eval("RequirementIssueDate") %>'
                ReadOnly="true" class="Calender" OnTextChanged="txtIssueDate_TextChanged"></asp:TextBox>
            <img id="imgIssueDate" src="../KelshawImages/calender.png" />
        </ItemTemplate>
    </asp:TemplateField>
    <asp:TemplateField HeaderText="Expiration Date">
        <ItemStyle Width="140px" />
        <ItemTemplate>
            <asp:TextBox ID="txtExpiration" runat="server" Text='<%#Eval("RequirementExpirationDate") %>'
                ReadOnly="true" class="Calender" Width="110px"></asp:TextBox>
            <img src="../KelshawImages/calender.png" />
        </ItemTemplate>
    </asp:TemplateField> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:52:15.443

不是 100% 肯定，但我认为如果您将 ReadOnly 属性放在控件上，您将无法在 textchanged 事件中修改它。尝试删除 ReadOnly=True 属性并简单地将 HTML disabled 属性添加到控件并尝试一下。

# c# - 代码契约 - 不重写不变量

> ID：13884284
> 
> 赞同：0
> 
> 时间：2012-12-14T18:25:13.793
> 
> 标签：c#, .net, runtime, code-contracts, invariants

我正在使用带有代码合同的 VS2010 Ultimate。在得到意外的运行时行为后，我查看了反射器中的源代码，并意识到我的不变量没有被编译。生成的`__ContractsRuntime`类仅包含`Assert`、`Ensures`、`ReportFailure`和`Requires<TException>`的定义`TriggerFailure`。对于我的所有子句，我对每种类型都使用`[ContractInvariantMethodAttribute]`了一个私有方法。`Contract.Invariant(...)`我对配置为装配模式的“标准合同要求”进行了完整的合同检查。

我的程序集文件包含以下程序集属性：

```
[assembly: RuntimeContracts(RuntimeContractsFlags.InheritContracts | RuntimeContractsFlags.StandardMode | RuntimeContractsFlags.ThrowOnFailure | RuntimeContractsFlags.Assumes | RuntimeContractsFlags.Asserts | RuntimeContractsFlags.Invariants | RuntimeContractsFlags.Ensures | RuntimeContractsFlags.Requires | RuntimeContractsFlags.RequiresWithException | RuntimeContractsFlags.LegacyRequires)]` 
```

有没有人有这个问题或任何见解为什么我的不变量没有按预期工作？

# matlab - 使用特定代码在二进制数组中查找行号

> ID：13884285
> 
> 赞同：2
> 
> 时间：2012-12-14T18:25:21.097
> 
> 标签：matlab

我正在构建一个播放 Connect 4 的程序，要检查的一件事是你的对手有以下棋盘位置的情况：

[0,1,1,0,0] 或 [0,1,0,1,0] 或 [0,0,1,1,0]

你的对手距离连续三张棋子只有一步之遥，两边都是空白。如果您在下一步行动中没有填充中间元素之一，您的对手可以去那里并迫使将死。

我有一个 42 个方格的棋盘，编号为 1:42。我创建了一个名为 FiveCheck 的矩阵，其中每一行映射到五个连续的棋盘位置。例如：

```
 FiveCheck(34,:) = [board(7),board(14),board(21),board(28),board(35)];
    FiveCheck(35,:) = [board(14),board(21),board(28),board(35),board(42)]; 
```

是棋盘的两条对角线。

我可以测试可能的将死

```
 (sum(FiveCheck(:,2:4),2) == 2 + sum(FiveCheck,2) == 2) == 2 
```

这给了我一个带有 1 的向量，表示相应的 FiveCheck 行有一个可能的将死。假设该向量的第 34 个元素具有 1，并且该对角线的模式（来自上面给出的示例）是 [0,0,1,1,0]。我如何返回 14，我应该移动到的棋盘位置？

另一个单独的示例，如果该向量的第 35 个元素为 1，并且该对角线的模式是 [0,1,0,1,0]，我如何返回 28？

编辑：我刚刚意识到，如果没有某种地图，这是不可能的。所以我创建了 FiveMap，一个与 FiveCheck 大小相同的矩阵，除了删除了单词“board”之外，使用相同的公式。例如：

```
 FiveMap(34,:) = [(7),(14),(21),(28),(35)];
    FiveMap(35,:) = [(14),(21),(28),(35),(42)]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:52:38.940

由于您正在处理大小为 5 的二进制向量，因此一个非常有效的解决方案可能是使用查找表。

考虑`board`为二进制矩阵。您可以使用 4 个过滤器（长度为 5）对其进行过滤，分别代表水平、垂直和两条对角线，以识别您正在寻找的可能位置。然后，对于似是而非的位置，您可以提取 5 个二进制位并使用大小为 32 的查找表来获取到您应该放置作品的位置的偏移量。

一个小例子：

```
% construct LUT
LUT = zeros(32,2); % dx and dy offsets for each entry
LUT(12,:) = [ 1 0 ]; % covering the case [0 1 1 0 0] - put piece 1 to the right of center
% continue constructing LUT here...

horFilt = ones(1, 5);
resp = imfilter( board, horFilt ); % need to think about board''s boundaries here...
[yy xx] = find( resp == 2 ); all locations where filter caught 2 out of 5
pat = board( yy, xx + [ -2 1 0 1 2] ); % I assume here only one location was found
pat = bin2dec( '0'+char( pat ) ); % convert binary pattern to decimal entry
board( yy + LUT(pat,2) , xx + LUT(pat, 1) ) = ... ; % your move here... 
```

# jquery - 防止封闭网络上的身份验证失败弹出窗口（http 401） - http 基本

> ID：13884286
> 
> 赞同：1
> 
> 时间：2012-12-14T18:25:27.770
> 
> 标签：jquery, firefox, basic-authentication

我在工作的封闭网络上面临这个问题。

我正在构建类似 LastPass 的东西，如果存储在我的数据存储中的用户的用户/通行证凭据不再正确，当我的代码通过 ajax (jQuery) 登录应用它时，会出现讨厌的 401 弹出窗口。

在我的情况下，我不能要求我登录的网站更改他们的 http 错误响应。

我想优雅地向用户展示客户定义的错误处理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T08:36:24.593

（引自[http://techfuzionwithsam.wordpress.com/2012/09/17/avoiding-browser-popup-for-401/](http://techfuzionwithsam.wordpress.com/2012/09/17/avoiding-browser-popup-for-401/)）

*   将服务器响应更改为不返回 401。改为返回 200 代码并在您的 JQuery 客户端中处理此问题。
*   将您用于授权的方法更改为标题中的自定义值。浏览器将显示 Basic 和 Digest 的弹出窗口。您必须在客户端和服务器上都进行更改。
*   标头：{“授权”：“基本自定义”}
*   或者，如果您可以自定义服务器响应，则可以返回 403 Forbidden。
*   浏览器不会打开身份验证弹出窗口，并且会调用 jquery 回调。

# r - R在保留空白的同时提取数字

> ID：13884287
> 
> 赞同：0
> 
> 时间：2012-12-14T18:25:31.407
> 
> 标签：r

考虑输入`c("foo 1", "bar 2", "baz")`。我想把它变成`c(1,2,NA)`（基本上从每个字符串中提取数字，或者如果不存在将它变成一个`NA`）。我的第一遍看起来像这样：

```
funNums = as.numeric(
                  regmatches(x$Fun,
                    regexpr('\\d+', x$Fun, perl = T))) 
```

`x$Fun`我的输入向量在哪里。我从中得到的输出是`c(1,2)`因为`regmatches`扔掉了不匹配的东西。我怎样才能让它包含`NA`s？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:29:47.587

```
X <- c("foo 1", "bar 2", "baz")
as.numeric(gsub("([^[:digit:]]*)", "", X))
# [1]  1  2 NA 
```

（请注意，当传递一个类似的字符串时`"1 to 2"`，这将返回数字`12`，这可能不是您想要的。）

# c# - 将音频播放到 .net 中的非默认播放设备

> ID：13884288
> 
> 赞同：1
> 
> 时间：2012-12-14T18:25:32.670
> 
> 标签：c#, vb.net, audio, multimedia

如何将音频播放到 .net 中的非默认播放设备？帮助会很棒！将音频播放到默认播放设备很容易，但是出于多种原因，机器可能有多个播放设备，并且许多常见应用程序允许选择非默认设备进行播放和录制。有没有办法做到这一点，希望避免 pinvoke？媒体基础还是核心音频？先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:37:22.513

善良的现实，

[这](http://naudio.codeplex.com/)可能对你有用。NAudio 似乎已经为您封装了一些 API（而且，我想，它会处理那些低级调用，因此您不必这样做）。向下滚动到“NAudio 功能”很可能会显示这是否是您正在寻找的内容。

# asp.net-mvc - 使用带有剃刀的 html 选择框

> ID：13884293
> 
> 赞同：11
> 
> 时间：2012-12-14T18:25:56.117
> 
> 标签：asp.net-mvc, razor

我有一个 html 选择器，我想在我的表单中为我的“model => model.type”使用选定的值。有没有办法将 my`@Html.EditorFor(model => model.type)`中的值设置为选择器的值？

```
@using (Html.BeginForm()) {
@Html.ValidationSummary(true)
<fieldset>
    <legend>Bet</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.type)
    </div>
    <div class="editor-field">

        <select id ="type">
  <option value="Football">Football</option>
  <option value="Rugby">Rugby</option>
  <option value="Horse Racing">Horse Racing</option>
</select>

        @Html.EditorFor(model => model.type)
        @Html.ValidationMessageFor(model => model.type)

    </div>

    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-14T21:19:43.800

您可以尝试使用以下选项：

模型：

```
public string Type { get; set; }

public IEnumerable<SelectListItem> TypeList
{
    get
    {
        return new List<SelectListItem>
        {
            new SelectListItem { Text = "Football", Value = "Football"},
            new SelectListItem { Text = "Rugby", Value = "Rugby"},
            new SelectListItem { Text = "Horse Racing", Value = "Horse Racing"}
        };
    }
} 
```

HTML（剃刀）：

```
@Html.DropDownListFor(model => model.Type, Model.TypeList) 
```

或者

HTML（剃刀）：

```
@Html.DropDownListFor(model => model.Type, new SelectList(new string[] {"Football", "Rugby", "Horse Racing"}, Model.Type)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-11-19T21:03:40.907

@andresdescalzo 的解决方案（最后一个）只需稍作改动即可：

```
@Html.DropDownListFor(model => model.Type, new SelectList(new string[] {"Football", "Rugby", "Horse Racing"}, "Rugby"), htmlAttributes: new { @class = "form-control" }) 
```

**第一：**为下拉列表添加一个选定的项目（例如“橄榄球”）
**第二：**删除最后一个`Model.Type`并添加`htmlAttributes`

*PS：SelectedList 打开括号在列表的选定项目后关闭（这里是“ `Rugby`”）*

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-03T04:15:39.323

@andresdescalzo 提供的解决方案仅在我们将模型从 Controller 传递到视图时才有效。

```
public class SomeController : Controller
{
  public ActionResult SomeAction()
  {
    return View(new SomeModelWithIEnumerationsSelectListItem())
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-06-22T18:28:02.143

现有答案的补充：如果在实现@andresdescalzo 的解决方案时遇到异常“对象引用未设置为对象的实例”，则需要：

1.  如@diwas 所述，返回您正在使用的模型
2.  在 razor 页面上实例化一个模型，以便您可以调用该方法。如果您使用 ViewModel 而不是简单的 EF 模型，这将很有帮助。

第二个可以这样做：

```
@{ var tempModel = new YourNameSpace.Models.YourModel(); }
@Html.DropDownListFor(model => model.Type, tempModel.TypeList, Model.Type)) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-08-01T05:29:44.507

这是剃刀视图

```
 <div class="editor-field col-md-3">          
        @Html.DropDownListFor(model => model.Servers, 
          Model.AvailableServers,new { @class = "form-control" })  
         @Html.ValidationMessageFor(model => model.SqlServerName)
    </div> 
```

来自控制器的动态下拉菜单

```
 List<SelectListItem> ServersAvailable = new List<SelectListItem>();
            bool IdSelected = false;
            ServersAvailable.Add(new SelectListItem { Text = "......Select your server name......", Value = "" });
            for (int i = 0; i < dt.Rows.Count; i++)
            {
                ServersAvailable.Add(new SelectListItem
                {

                    Text = dt.Rows[i].ItemArray[0].ToString(),
                    Value = dt.Rows[i].ItemArray[0].ToString(),
                    Selected = IdSelected
                });
            } 
```

# asp.net-mvc - Linq 语句返回每个部分中问题的答案

> ID：13884295
> 
> 赞同：0
> 
> 时间：2012-12-14T18:26:09.720
> 
> 标签：asp.net-mvc, linq, entity-framework-4

将 MVC 3 与 EF 4.1 一起使用。我有一个动态问卷，其中包含包含问题的部分（用户通过文本框回答）。当我处于编辑表单时，我想用问题提取用户答案。我的查询如下。我的问题，我是否会提取特定于 userId 的答案？例如：“在哪里 Answers.userID=999”

```
**Answer Model:**
public int AnswerID { get; set; }
public int UserID { get; set; }
public int QuestionID { get; set; }
public string AnswerValue { get; set; }
public int ReviewID { get; set; }

var steps = from b in db.Section.Include(s => s.Questions.Select(q => q.Answers))
            orderby b.SectionOrder
            select b; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:48:17.227

这将返回用户 ID 对每个问题的回答。这是你要找的吗？

```
var steps = from b in db.Section.Include(s => s.Questions.Select(q => q.Answers.Where(a => a.userID == 999))
            orderby b.SectionOrder
            select b; 
```

# django - django-social-auth 的 OAuthException 异常

> ID：13884308
> 
> 赞同：0
> 
> 时间：2012-12-14T18:27:12.453
> 
> 标签：django, facebook, facebook-graph-api, django-socialauth

我正在使用 django-social-auth 对用户进行身份验证，以便登录我的网站。

```
<a href="{% url socialauth_begin 'facebook' %}?redirect_uri={{SITE_URL}}complete/facebook/"> 
```

这正确地引导我进入身份验证对话框，但是当我在对话框中单击“转到应用程序”时，我从社交身份验证中收到此错误：

```
Request Method: GET
Request URL:    http://[site_url]/complete/facebook/?state=DHlD9efEDau286xRGn2HtVpZ9AbooD3y&code=AQCACZRE3WYGMyBSII1eD-H8Sl8yDUtL6VoZ4qJPKSQ_NDBAoE_6JE7-4Ef353utpAygCZVJMUKiLNs_evC-y2oezOKRsH_njtFZW4FwPE2XoaFm14sdbtUkj1QsqivY6DSpGpsmTNCCs3twYxx-6_C-e1OWEcnd4x6SoBg59LmCUsWhocu739h_ppdLRR_wPjY
Django Version: 1.3.1
Exception Type: AuthFailed
Exception Value:    
Authentication failed: There was an error authenticating the app
Exception Location: /app/.heroku/src/social-auth/social_auth/backends/facebook.py in auth_complete, line 131Request Method: GET
Request URL:    http://[site_url]/complete/facebook/?state=DHlD9efEDau286xRGn2HtVpZ9AbooD3y&code=AQCACZRE3WYGMyBSII1eD-H8Sl8yDUtL6VoZ4qJPKSQ_NDBAoE_6JE7-4Ef353utpAygCZVJMUKiLNs_evC-y2oezOKRsH_njtFZW4FwPE2XoaFm14sdbtUkj1QsqivY6DSpGpsmTNCCs3twYxx-6_C-e1OWEcnd4x6SoBg59LmCUsWhocu739h_ppdLRR_wPjY 
```

我的需求文件指向 django-social-auth 的分叉版本，因此我可以在错误周围放置一些打印语句。失败似乎发生在拨打电话后

```
https://graph.facebook.com/oauth/access_token?code=AQCc6tIfxJTQN64GGQsDVbT4BCK1hYGypw2oMFQjjMQf-kfJqrWtI-vGe78fJJJHTL6w5yuau90vQu8msVGDpZh30HgUYkwdXhAKJcC9MCf8h6bp1e23wxkkMzP5eaT2j7xOCorn-KgeRv-ZJA40U87GDx1_592amAlSemS4zhXaoAv7JWRHl9NzBFtJ6cuGdbg&client_secret=[app_secret]&redirect_uri=http%3A%2F%2F[site_url]%2Fcomplete%2Ffacebook%2F%3Fredirect_state%3DDHlD9efEDau286xRGn2HtVpZ9AbooD3y&client_id=[app_id] 
```

我从中得到的错误是

```
{
      "error": {
      "message": "Error validating verification code. Please make sure your redirect_uri is identical to the one you used in the OAuth dialog request",
      "type": "OAuthException",
      "code": 100
   }
} 
```

但是，如果我在 url 的末尾添加一个斜杠，我会收到此错误：

```
{
   "error": {
     "message": "Error validating application. Invalid application ID.",
     "type": "OAuthException",
     "code": 101
  }
} 
```

我向你保证 app_id 是正确的

我知道这已经读了很长时间，但是有人对如何解决这个问题有任何建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T17:05:41.267

@omab was correct, my issue was attaching the `redirect_uri`. It addition to that I had edited django-social-auth to append a backslash to the url. This was also incorrect.

# c# - 将 UTF-8 字符 C# 发送到 C 无法正常工作

> ID：13884311
> 
> 赞同：0
> 
> 时间：2012-12-14T18:27:27.487
> 
> 标签：c#, sqlite, utf-8, com-interop

我使用 SQLite for C。我尝试从 c# 应用程序将 UTF-8 字符发送到 .dll，但每次它的工作方式都不同。例如，有时它会添加“değirmenci”，而另一次使用相同的代码会添加“değirmencil”，但我不会更改这个词。有时它会在 UNIQUE 列中添加相同的内容（我认为有一个字符，但它不像 ascii 中的 0x01 那样可见）对不起我的英语。

这是我的 C# 代码；

```
 [DllImport("dllfile.dll", CharSet = CharSet.Unicode)]

static void Main()
{
    byte[] bytes = System.Text.Encoding.UTF8.GetBytes("değirmenci");
    int r;
    //
    IntPtr unmanagedPointer = Marshal.AllocHGlobal(bytes.Length);
    Marshal.Copy(bytes, 0, unmanagedPointer, bytes.Length);

    IntPtr ch = Tahmin_Baslat();

    r = Sozcuk_Ekle(unmanagedPointer);
    Console.WriteLine(r);
    Console.Read();
    //
} 
```

这是我的 C 代码

```
 int Sozcuk_Ekle(const char* kok,int tip_1=1,int tip_2=0,int tip_3=0)
{
    sqlite3 *ch; 
    int rc; 
    char *HataMsj = 0; 

    rc = sqlite3_open(veritabani, &ch); // Veritabanının açılması

    if( rc )
    {
        return HATA_DEGERI;
    }

    char buff[strlen(kok) + 64];
    sprintf(buff,"INSERT INTO kokler (kok,tip_1,tip_2,tip_3) VALUES('%s',%d,%d,%d)",kok,tip_1,tip_2,tip_3); // Verilerin Birleştirilmesi
    sqlite3_exec(ch,buff,GeriBildirim,0,&HataMsj); // Komutun Yürütülmesi
    sqlite3_close(ch); // Veritabanını kaynaklarının serbest bırakılması
    return DOGRU_DEGERI; // Doğru Dönder
} 
```

（包括头文件等）它就是这样：http: [//i.stack.imgur.com/BJ4fE.png](http://i.stack.imgur.com/BJ4fE.png)

**解决方案**
在字节末尾添加 NULL 终止符。byte[] bytes = System.Text.Encoding.UTF8.GetBytes("değirmenci\0"); 像这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:19:41.880

检查**DllImport**属性中的[调用约定](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.callingconvention%28v=vs.80%29.aspx)（应为**Cdecl**）。并为您的 UTF-8 字符串添加一个 NULL 终止符：

 ****```
byte[] bytes = System.Text.Encoding.UTF8.GetBytes("değirmenci" + '\0'); 
```

这会将 NULL 终止符添加到**生成**的UTF-8 字符串（本机 .NET 字符串不需要）。****

# jquery - jquery悬停与css下拉菜单在页面加载时不在位置

> ID：13884312
> 
> 赞同：0
> 
> 时间：2012-12-14T18:27:31.467
> 
> 标签：jquery, css, drop-down-menu

我有一个使用无序列表并使用 jQuery 悬停方法的 CSS 下拉菜单：它运行良好，除非用户在页面加载时将光标放在绑定到悬停的元素上。

发生这种情况时，当光标离开“悬停”区域时，下拉菜单会显示在位置之外。当光标回到悬停区域时，菜单返回到原来的位置。

IE

水果 蔬菜 苹果 胡萝卜 梨 甜菜

* * *

用户将鼠标悬停在水果上，菜单会在正确的位置下拉。如果用户在页面加载时将光标放回“Fruits”上，则当光标离开“Fruits”时，下一个下拉菜单会出现位置不正确。离开“Fruits”，然后回到“Fruits”，菜单重新定位正确。

* * *

我尝试使用 $(document).ready 包装所有内容，认为这可能会有所帮助，因为这似乎只有在页面加载期间将菜单选项悬停在鼠标上方时才会发生。没运气。

* * *

这是我正在进行的 jquery 调用：

```
$("ul.dropdown li.navMainFmt").hover(function(){
    $(this).addClass("hover");
    $('ul:first',this).fadeIn(); 
```

// }， 功能（）{

```
 $(this).removeClass("hover");
$('ul:first',this).toggle(); 
```

});

* * *

我确实在 stackoverflow 上搜索了答案，但不太确定如何表达这个问题。感谢您对先前解决方案的任何想法或帖子。

# visual-studio-2008 - 链接错误：函数____cudaRegisterAll中引用的未解析的外部符号___cudaRegisterLinkedBinary

> ID：13884317
> 
> 赞同：3
> 
> 时间：2012-12-14T18:27:47.990
> 
> 标签：visual-studio-2008, cuda

我正在使用 CUDA 5.0 开发 Visual Studio 2008。我使用 CUDA Runtime API 作为构建规则。
我正在尝试编译一个包含 main 函数和一个**全局**内核的 test.cu 文件。主函数和内核都包含我使用相同的 CUDA 环境编译的外部库函数调用，启用了可重定位设备代码标志，NVCC 编译类型为 -c。test.cu 编译良好，但在链接过程中输出以下错误：

```
1>Linking...
1>test.cu.obj : error LNK2019: unresolved external symbol ___cudaRegisterLinkedBinary_43_tmpxft_00001888_00000000_8_test_cpp1_ii_98e63e3a referenced in function "void __cdecl __sti____cudaRegisterAll_43_tmpxft_00001888_00000000_8_test_cpp1_ii_98e63e3a(void)" (?__sti____cudaRegisterAll_43_tmpxft_00001888_00000000_8_test_cpp1_ii_98e63e3a@@YAXXZ) 
```

我搜索了__cudaRegisterLinkedBinary，发现它是在CUDA v5.0的crt/host_rintime.h中定义的，但是在v4.2中并没有这样的东西。

```
crt/host_runtime.h:#define __REGISTERFUNCNAME_CORE(X) __cudaRegisterLinkedBinary##X 
crt/host_runtime.h:#define ____cudaRegisterLinkedBinary(X) 
```

所以我怀疑它可能与 v5.0 添加的单独编译功能有关，对吗？

谁能帮我解决错误？如果是单独编译 .cu 文件导致的问题，那么是否意味着我必须将所有内核放在一个 .cu 文件中才能解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-13T08:14:24.943

这个问题已经在以下两个线程中遇到过：

[关于**函数_** _cudaRegisterAll中引用的cudaRegisterLinkedBinary的问题](https://devtalk.nvidia.com/default/topic/525616/question-about-___cudaregisterlinkedbinary-referenced-in-function-____cudaregisterall/?offset=3#3942819)

和

[device-link.obj / cudaRegisterLinkedBinary 错误](https://devtalk.nvidia.com/default/topic/525061/cuda-programming-and-performance/device-link-obj-cudaregisterlinkedbinary-error/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-08-15T22:56:25.377

我遇到了同样的错误。看来我的问题与单独编译有关。（我是 CUDA 的新手，所以如果有人可以确认或提供更好的解释，我将不胜感激。）

首先，我对 Visual Studio 的修复是转到***属性 -> CUDA C/C++ -> 通用***并将“是”切换为“***生成可重定位设备代码***”。根据[https://forums.developer.nvidia.com/t/how-to-separately-compile-a-kernel-in-visual-studio/80385](https://forums.developer.nvidia.com/t/how-to-separately-compile-a-kernel-in-visual-studio/80385)，您还需要确保“ ***NVCC 编译类型***”是“***生成混合目标文件***”。

根据 NVCC 文档，与第一个修复相关的问题是 NVCC 将可重定位设备代码嵌入到主机对象中，并调用 nvlink 链接设备 cade，然后将其与主机对象链接以形成最终程序。第二个修复的问题是从“.cu”文件隐式生成了 CUDA 主机代码。此主机代码需要传递给主机链接器。

文档链接是：[https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#nvcc-options-for-separate-compilation](https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#nvcc-options-for-separate-compilation)和[https://docs.nvidia.com/cuda /cuda-compiler-driver-nvcc/index.html#implicit-cuda-host-code](https://docs.nvidia.com/cuda/cuda-compiler-driver-nvcc/index.html#implicit-cuda-host-code)

# extjs - EXT.JS 从字段集中获取项目列表

> ID：13884322
> 
> 赞同：0
> 
> 时间：2012-12-14T18:28:29.457
> 
> 标签：extjs

如何从 a 中获取项目列表`Ext.form.Fieldset`？我正在尝试根据其中一个属性找到一个组件，这就是我到目前为止所得到的：

```
Ext.each(container.items, function (component) {

    if (component.name == config.name) {
        component.doUpdate(config);
    }

}, me); 
```

当然，项目是未定义的......那么我可以做些什么来访问包含在我的容器中的组件，它是一个字段集？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:40:54.423

您可以使用 container.down(selector)，或者如果它是表单字段，则使用 form.findField(name)。

请参阅有关在 extjs 应用程序中“查找”事物的不同方法的答案： [测试 extjs 应用程序](https://stackoverflow.com/questions/13727481/testing-extjs-apps/13730075#13730075)

对于表单字段，这是一个列出不同技巧的答案：[访问相邻组件/字段的最佳方式](https://stackoverflow.com/questions/13190870/best-way-to-access-adjacent-components-fields/13202813#13202813)

**编辑**：使用[container.query(selector](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.grid.Panel-method-query) ) 方法获取对象数组。作为 down() 方法返回首先找到的。

# jquery - 浮动饼图不显示（修改后的代码）

> ID：13884325
> 
> 赞同：0
> 
> 时间：2012-12-14T18:28:54.233
> 
> 标签：jquery, flot

我需要一个饼图并找到[Flot](http://www.flotcharts.org/)。它看起来简单而强大，但我发现的所有示例都使用固定值（例如 [1,2]）描述“数据”，但我需要显示动态数据。我有五个变量最终必须加起来为 100。我只想包括值 > 0 的变量，如果它们的总和不等于 100，我想添加一个显示缺失百分比的元素。问题是我不知道如何动态构造数据参数。

我的代码如下。它有两个问题：1） $.plot 什么都不做 - 没有错误也没有 grapy 2）我不知道如何添加标签文本

```
function updatePieChart() {
    var total = 0;
    var data = new Array();
    var verb = "";
    var dataIndex = 0;

    for (var dataIndex = 0; dataIndex < 5; dataIndex++) {
        var duty = "DUTY_" + (dataIndex + 1);
        var d = getData(duty + "_PERCENTAGETIMESPENT");
        if (isNumeric(d)) {
            d = parseInt(d);
            if (d > 0) {
                total += d;
                data[dataIndex] = new Array();
                data[dataIndex].push(d);
                verb = getData(duty + "_SKILL");
                if (verb == "") verb = duty + dataIndex;
                log(duty + dataIndex + ' value: ' + d);
            }
        }
    }

    var count = data.length;
    if (total != 100) {
        if (total < 100) {
            var missingDataNum = 100 - total;
            data[count] = new Array();
            data[count].push(missingDataNum);
            verb = '**MISSING**';
            log(verb + missingDataNum);
        }
    }

    $.plot($('#pieChart'), data,
        {
        series: {
            pie: {
                show: true,
            }
        },
        legend: {
            show: false
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:40:47.557

```
var ary = new Array();

ary.push(1); // this is where you would push the numbers that are supposed to add to 100
ary.push(2); 
ary.push(23); 
ary.push(40); 
ary.push(10); 
ary.push(8); 

var result = 0;
for (var i = 0; i< ary.length; i++) {
result += ary[i];
} 
```

现在`result`应该包含总数。下一个：

```
if (result < 100){
    var missing = 100 - result;
    ary.push(missing); 
} 
```

然后我只是推`missing`到数组的末尾。因此数组的内容将精确到 100，而“空”（在本例中为 16）是图中的最后一个元素。

那是你要找的吗？

**编辑** ——我会做以下事情来防止 + 在 JS 中混淆。

```
if (total != 100) {
    if (total < 100) {
        var missinDataNum = 100 - total;
        series.push('{label: **MISSING**,data: ' + missingDataNum + '}');
    }
} 
```

***第二次编辑***

```
if (d1 > 0) series.push('{label: "' + d1v + '",data: ' + d1 + '}');
if (d2 > 0) series.push('{label: "' + d2v + '",data: ' + d2 + '}');
if (d3 > 0) series.push('{label: "' + d3v + '",data: ' + d3 + '}');
if (d4 > 0) series.push('{label: "' + d4v + '",data: ' + d4 + '}');
if (d5 > 0) series.push('{label: "' + d5v + '",data: ' + d5 + '}'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T22:33:35.553

固定的。请参阅[将数据作为变量传递时 jQuery Flot 数据的格式是什么](https://stackoverflow.com/questions/13888131/what-is-the-format-of-jquery-flot-data-when-passing-in-the-data-as-variables)。问题是我没有正确地将数据对象格式化为 JSON 对象。

# ruby-on-rails - 如何在现有“唯一键”旁边的 Rails 3、PostgreSQL 中指定“唯一”值？

> ID：13884327
> 
> 赞同：1
> 
> 时间：2012-12-14T18:29:08.693
> 
> 标签：ruby-on-rails, database, postgresql

我现有的 Rails 应用程序是用 Rails 3.2 编写的，并使用 PostgreSQL 作为数据库引擎。我们的产品表包含来自多个网站的产品。目前，每个产品在进入时都会获得一个唯一的 ID。

这是模型：

```
class Platform < ActiveRecord::Base
  attr_accessible :name, :url, :country, :email
  validates :name, :presence => true, 
        :length => { :minimum => 1 }
  has_many :sectors
end 
```

和来自 schema.rb 的该表的数据库模式

```
create_table "platforms", :force => true do |t|
    t.string   "name"
    t.string   "url"
    t.datetime "created_at",                               :null => false
    t.datetime "updated_at",                               :null => false
    t.string   "country"
    t.string   "email"
  end 
```

是否可以使用“URL”参数添加另一个禁止进入或新产品的“唯一键”？我不确定在`Rails g migration`不破坏现有记录的情况下实现这样的事情（如果已经存在重复）。

所以基本上：如果新产品的 url 对应于数据库中已有的 url，我希望 rails 禁止添加新产品，类似于如果有 id= 的产品，我不允许输入 id=1 的产品1 已经在数据库中了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:59:30.077

您可以在模型上执行此操作：

```
class MyModel < ActiveRecord::Base
  validates_uniqueness_of :url
end 
```

或者（取决于您的数据库，MySQL 的反应可能与 PGsql 不同）：

```
# migration file
t.string :url, :null => false, :unique => true 
```

# python - What is the type of parameter, and what does this function do?

> ID：13884328
> 
> 赞同：1
> 
> 时间：2012-12-14T18:29:18.820
> 
> 标签：python

I am having trouble with the code below:

```
def myprogram(x):
    if x == []:
        return x
    else:
        return myprogram(x[1:]) + [ x[0] ] 
```

What is the parameter type `(x)`? What does this function do?

I'm supposed to write code that calls this function with a parameter and find the return value, but i can't do that without understanding what is going on here. any help/feedback would be appreciated.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T18:31:41.310

Since this is clearly homework, I'll limit my answer to a hint.

> I'm supposed to write code that calls this function

It is clear that the function is expecting a list. I leave it to you to figure out the rest.

If you are unsure how to proceed, you could try to call it with various lists to see what it returns. However, ultimately you will have to read and understand the source code to be certain about what the function does.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:27:46.643

那是一个递归函数，它继续调用自己，直到终止条件停止它

例如，如果您运行以下代码：

```
def factorial(n):
    if n == 0:
        return 1
    else:
        return n * factorial(n -1) 
```

如果您调用 with ，您期望返回`factorial(5)`什么？

关于如何在此处制作它们的另一篇文章：[如何在 python 中构建递归函数？](https://stackoverflow.com/questions/479343/how-can-i-build-a-recursive-function-in-python)

# php - PHP Minifier for JS and CSS

> ID：13884329
> 
> 赞同：2
> 
> 时间：2012-12-14T18:29:21.657
> 
> 标签：php, javascript, css, minify

I want to have both a minified and an expanded version on this site (it's for delivering to another developer, not production). I want to be able to have a JS file running PHP that has a list of expanded files to go through that will create a minified file *if necessary* from the original expanded file without modifying the expanded file at all.

I have looked at the [minify](http://code.google.com/p/minify/) project as a potential library, but from my understanding, that *always* minifies the files when they are requested. If this is not the case, could you please tell me how to implement it so that I can save the contents appropriately?

I'm imagining what I want to do like this:

```
$files = Array('filename', 'filename', 'filename');

for($i = 0; $i < count($files); $i++) {
    // does $file[i].js exist?
    // does $file[$i].min.js exist?
    //    if both exist, check if the timestamp of min > js - if it's younger, we need to minify
    //    if min does not exist we need to minify

    // to minify:
    //    get the contents of js, minify it, save it as .min.js
} 
```

I would *like* to be able to do this with CSS as well, but I can always run two different sass watch consoles, one with expanded and the other with compact if there is not something like this for CSS.

# jquery - 我的网站没有“看到”我正在编写的任何 Jquery，即使是最简单的功能

> ID：13884334
> 
> 赞同：3
> 
> 时间：2012-12-14T18:29:37.943
> 
> 标签：jquery, web, webpage, web-hosting

我使用 localhost 和 godaddy 服务器。我将所有文件都链接到了正确的位置。我的 jquery 在我的 javascripts 文件夹中的 script.js 文件中，与我的 index.php 文件位于同一目录中。这是我在标题中的链接，它包含在我网站上每个页面加载的开头。

```
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script> 
```

我什至不确定图书馆是否是必要的，但我添加它是为了拒绝任何愚蠢的建议。为什么我的本地主机或实时网站都不能识别 jquery？

举个简单的例子。我的 script.js 文件中有

```
$(document).ready(function(){
$('#jscriptprac').mouseenter(function(){
$(this).fadeTo('fast', 1);
});
$('#jscriptprac').mouseleave(function(){
$(this).fadeTo('fast', 0.25);
});
}); 
```

我只是在更改不透明度但它不会改变，我还更改了我的 .css 文件以确保 id 看到更改（如果它实际上已更改）以及数百个其他简单的 jquery 函数，但未能成功进行任何动态更改网页。

和html

```
 <div id="jscriptprac">text</div> 
```

非常简单。

通常我什至不会在 html 中编写文本，因为我网站上的每一点内容都是从我的数据库中加载的，并且我使用我构建的 cms 对其进行管理。但这是描述我的问题的最简单方法。

任何人都知道为什么我的网站拒绝执行 jquery 事件/处理程序/函数？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T18:36:12.070

我不认为 jquery-ui 包括 jquery 本身。在 ui 之前，您需要 jquery 本身的第二个脚本标记：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:40:45.297

尝试做基本的调试技术。

在你的第一行`script.js`输入一个简单的`alert('script.js is loaded');` （如果你熟悉控制台，如果你用对调用替换调用就不会那么讨厌`alert`了`console.log`）。如果您看到，那么您的脚本正在正确加载。如果不知道为什么不这样做——例如，查看 chrome 中的源代码，看看是否可以单击并查看 JS 文件的文本。

如果您看到该消息，接下来检查是否加载了 jquery？`var jquery_ver = $.fn.jquery; alert("I am running jquery:" jquery_ver)`在脚本顶部尝试类似的东西。你看到那条信息了吗？如果不是 jquery 没有加载，所以你需要加载 jquery 类似的东西：

```
 <script src="/path/to/jquery.min.js" type="text/javascript"></script> 
```

或来自[谷歌的 CDN](https://developers.google.com/speed/libraries/devguide#jquery)：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script> 
```

# java - Auto_Increment with PreparedStatement

> ID：13884335
> 
> 赞同：0
> 
> 时间：2012-12-14T18:29:39.567
> 
> 标签：java, mysql, auto-increment

I have a fragment of code in Java which inserts data into my database.

I was advised to put AUTO_INCREMENT and give each row a unique number.

But it now gives me an error:

> java.sql.SQLException: Incorrect integer value: 'DEFAULT' for column 'usersID' at row 1

I assume this is because it's casting the AUTO_INCREMENT value into a string?

How do I get around this as it's not my java program that creates the unique number, but the database itself.

```
pst.setString(1, "DEFAULT");

String query_to_update = "INSERT INTO `evidence_db`.`mcases` ("
                        + "`PID`,"
                        + "`Name`) "
                        + "VALUES (?,?);"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:43:43.223

```
pst.setInt(1, 0); 
```

上面是我需要的线。感谢所有*试图*提供帮助的人。

# linux - 传递一个额外的参数来制作

> ID：13884336
> 
> 赞同：1
> 
> 时间：2012-12-14T18:29:42.843
> 
> 标签：linux, makefile

我有一个像这样的 Makefile：

```
baud=19200
src=dimmer
avrType=attiny13
programmerDev=/dev/ttyUSB003
programmerType=stk500v1

object:
        avr-gcc -g -DF_CPU=$(avrFreq) -Wall -Os -mmcu=$(avrType) -c -o $(src).o $(src).cpp

read:
        @for memory in calibration eeprom efuse flash fuse hfuse lfuse lock signature application apptable boot prodsig usersig; do \
                avrdude -p $(avrType) -c$(programmerType) -P$(programmerDev) -b$(baud) -v -U $$memory:r:./$(avrType).$$memory.hex:i; \
        done 
```

哪个按预期工作。当我键入`make read`几个文件时，从微控制器中提取。由于连接速度慢和数据量大，这可能需要一些时间，所以我认为能够只键入 会很好`make read flash`，但我不知道该怎么做。

当然，我可以输入类似`read_flash`, `read_hfuse`... 但我觉得它可以做得更聪明。

我还希望能够运行一个命令，该命令`make read all`将依次从控制器执行每个文件。

现在我是创建 Makfile 的新手，所以也许我一起走错了路。请随时解释应该如何做。

我在 Linux 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T22:12:37.507

如果您可以接受高度特定于 GNU 的 makefile（并且我认为使用可移植`make`的 GNU 文件比编写可移植的 makefile 要好得多），您可以很容易地实现这一点：

```
ALL = calibration eeprom efuse flash fuse hfuse lfuse lock signature \
      application apptable boot prodsig usersig

ifeq (read,$(firstword $(MAKECMDGOALS)))
  WANT := $(wordlist 2,$(words $(MAKECMDGOALS)),$(MAKECMDGOALS))
  ifneq ($(WANT),)
    $(eval $(WANT):;@:)
  endif
  UNKNOWN := $(filter-out $(ALL),$(WANT))
  ifneq ($(UNKNOWN),)
    $(error Invalid arguments: $(UNKNOWN))
  endif
endif

read-one = avrdude -p $(avrType) -c$(programmerType) -P$(programmerDev) \
        -b$(baud) -v -U $1:r:./$(avrType).$1.hex:i

.PHONY: read
read:
    $(foreach w,$(or $(WANT),$(ALL)),$(call read-one,$w) &&) : 
```

如果命令行中的第一个参数是“读取”，这会将`WANT`变量设置为第一个之后的参数列表。然后它将这些名称转换为无操作目标，并使目标为每个名称`read`调用函数，或者如果没有指定名称。`read-one``$(ALL)`

我经常使用它的变体，例如`make print VARIABLE...`，它只会打印`$(VARIABLE)`或`make help TOPIC`显示有关目标的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:37:22.357

我会做：`make flash`或`make hfuse`或`make all`使用以下Makefile：

```
baud=19200
avrType=attiny13
programmerDev=/dev/ttyUSB003
programmerType=stk500v1

all: calibration eeprom efuse flash fuse hfuse lfuse lock signature \
    application apptable boot prodsig usersig

%:
        avrdude -p $(avrType) -c$(programmerType) -P$(programmerDev) -b$(baud) \
        -v -U $@:r:./$(avrType).$$memory.hex:i || rm ./$(avrType).$@.hex; 
```

这可能不是可移植的 Make，但它适用于 gnu make。这不允许任何其他规则，但您可以命名此文件`read`并执行`make -f read flash`. 这将允许将其他规则放置在其他 make 文件中。

请注意，这并不是特别安全，因为它将在 avrdude 上运行`make foo`。要更严格地控​​制目标，您可以执行以下操作：

```
.SUFFIXES: .ph
.PHONY: efuse.ph eeprom.ph ...
all: efuse eeprom ...
.ph:
        avrdude ... 
```

这样，只有被列为 PHONY 的目标才是有效目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:55:12.157

如何使模块列表成为具有默认值的可配置列表：

```
LIST = calibration eeprom efuse flash fuse \
       hfuse lfuse lock signature application \
       apptable boot prodsig usersig

read:
        @for memory in $(LIST); do \
             avrdude -p $(avrType) -c$(programmerType) -P$(programmerDev) \
               -b$(baud) -v -U $$memory:r:./$(avrType).$$memory.hex:i; \
        done 
```

然后调用 make 作为`make`默认值，或者`make LIST="eeprom efuse"`只调用两个模块。

# excel - Excel 公式或 VBA 执行此操作的策略。

> ID：13884341
> 
> 赞同：0
> 
> 时间：2012-12-14T18:30:12.783
> 
> 标签：excel, vba

我有一张关于汽车零部件信息的 Excel 表格。

零件编号在 A2 上。它适合的第一辆车在 B3 上。它适合的第二辆车在 B4 上。它适合的第三辆车在 B5 上。依此类推，直到下一个零件的下一个零件编号。有些零件有数百辆适合的车辆。有些有 0（非美国汽车的零件）。

我需要 A3、A4、A5 等上的零件号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:37:10.593

解决此问题的绝妙技巧 - 执行以下操作：

1.  选择A列中要填写的整个区域
2.  按下`F5`键
3.  选择`Special`
4.  选择`Blanks`并单击`Ok`

现在应该选择所有空白单元格

1.  输入`=`并按下`up arrow`
2.  点击`ctrl`+`enter`

应该这样做

# php - Facebook评论循环非常非常慢

> ID：13884342
> 
> 赞同：1
> 
> 时间：2012-12-14T18:30:14.510
> 
> 标签：php, facebook, json

我有这个函数来检索 Facebook 对博客帖子的评论计数：

```
function comment_count($url) { 

 $json = json_decode(file_get_contents('https://graph.facebook.com/?ids=' . $url));
 return ($json->$url->comments) ? $json->$url->comments : 0;
} 
```

但是，如果我将它插入一个循环以获取查询结果以检索页面上的五个帖子，则此功能会严重影响网站的速度（页面加载最多需要 6-7 秒）。

有没有办法避免这种情况？为什么这么慢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:02:10.563

将逗号分隔的 URL 列表传递给 ids 参数以一次获取所有计数，或者将它们缓存在服务器端并使用这些值。

示例：[https ://graph.facebook.com/?ids=http://www.google.com,http://www.bing.com,http://www.yahoo.com](https://graph.facebook.com/?ids=http://www.google.com,http://www.bing.com,http://www.yahoo.com)

这在 Facebook 的[Graph API Reference](https://developers.facebook.com/docs/reference/api/)中的“选择”部分中指定

示例实现如下：

```
<?php
function comment_count($urls) {
    $json = json_decode(file_get_contents('https://graph.facebook.com/?ids=' . implode(',', array_map("rawurlencode", $urls))));
    $output = Array();
    foreach($json as $url=>$data)
    {
        $output[$url] = isset($data->comments) ? $data->comments : 0;
    }
    return $output;
}
var_dump(comment_count(Array('http://www.facebook.com/', 'http://www.google.com'))); 
```

我希望这有帮助！

# xml - incomplete prefix in an XML node

> ID：13884344
> 
> 赞同：0
> 
> 时间：2012-12-14T18:30:22.463
> 
> 标签：xml, delphi, delphi-xe2, delphi-xe, msxml

need a node with prefix, but he does it the right way, is a failure of the way I do? or is a compiler bug?

main module code

```
 function Generar_Addenda(PathCFD : String; ValidaOnly : Integer) : Integer;
const
  xmlns = 'xmlns=""';             (* Cadena String a Borrar, (se genera al obtener la interaz Factura) *)
var
  XMLFactura : IXMLDocument;
  Factura : IXMLFactura;
  CFD : TCFD;
begin

  Try
    CFD := TCFD.Create(cfdV22);       // AQUI CREO UNA INSTANCIA DEL CFD, PARA TENER LA CLASE COMPLETA
    CFD.LoadFromFile(PathCFD);       // AQUI CARGO EL XML YA SELLADO, LISTO PARA PEGAR LA ADDENDA

    XMLFactura := TXMLDocument.Create(Nil);
    XMLFactura.Active := True;

    Factura := GetFactura(XMLFactura);

// ************* PERSONALIZAR ADDENDA CHRYSLER PPY  **********************             AQUI LLENO LA ADDENDA CON LOS DATOS DE LA BASE DE DATOS
    With Factura do
     begin
       TipoDocumento := cds_cliente.FieldByName('TipoDocumento').AsString;
       TipoDocumentoFiscal := cds_Cliente.FieldByName('TipoDocumentoFiscal').AsString;   
       Version := cds_Cliente.FieldByName('Version').AsString;
      ......
      .....
    end;

    FACTURA.OwnerDocument.Options := [doAutoPrefix];

    CFD.Datos.Addenda.ChildNodes.Add(Factura);

    Factura.SetAttributeNS('xmlns:PPY','', 'http://www.dfdchryslerdemexico.com.mx/Addenda/PPY');
    Factura.Attributes['xsi:schemaLocation'] :=  'http://www.dfdchryslerdemexico.com.mx/Addenda/PPY http://www.dfdchryslerdemexico.com.mx/Addenda/PPY/PPY.XSD';

    CFD.SaveToFile('C:\Paso\CFD_PRUEBA_ADDENDA_CHRYSLER.XML');
  Finally
     ......
     ......

  End; 
```

I made ​​changes in the interface Intf_PPY I made were the following, in PPY prepend node name will factura

```
 function Getfactura(Doc: IXMLDocument): IXMLFactura;
function Loadfactura(const FileName: string): IXMLFactura;
function Newfactura: IXMLFactura;

const
  TargetNamespace =
   'http://www.dfdchryslerdemexico.com.mx/Addenda/PPY'; // xsi:schemaLocation="http://www.dfdchryslerdemexico.com.mx/Addenda/PPY http://www.dfdchryslerdemexico.com.mx/Addenda/PPY/PPY.XSD"';

implementation

{ Global Functions }

function Getfactura(Doc: IXMLDocument): IXMLFactura;
begin
  Result := Doc.GetDocBinding('PPY:factura', TXMLFactura, TargetNamespace) as IXMLFactura;
end;

function Loadfactura(const FileName: string): IXMLFactura;
begin
  Result := LoadXMLDocument(FileName).GetDocBinding('PPY:factura', TXMLFactura, TargetNamespace) as IXMLFactura;
end;

function Newfactura: IXMLFactura;
begin
  Result := NewXMLDocument.GetDocBinding('PPY:factura', TXMLFactura, TargetNamespace) as IXMLFactura;
end; 
```

and this is what I find, with the **nodes note, otroscargos, part** no prefix, but with the namespace included within them

```
 <Addenda>
      <PPY:factura tipoDocumento="PPY" TipoDocumentoFiscal="FA" version="1.0" serie="A" folioFiscal="451" fecha="2012-06-20" montoTotal="9960.98" referenciaProveedor="A 451" xmlns:PPY="http://www.dfdchryslerdemexico.com.mx/Addenda/PPY" xsi:schemaLocation="http://www.dfdchryslerdemexico.com.mx/Addenda/PPY http://www.dfdchryslerdemexico.com.mx/Addenda/PPY/PPY.XSD">
         <PPY:moneda tipoMoneda="USD" tipoCambio="1.0000"/>
         <PPY:proveedor codigo="20215" nombre="NOMBRE DE LA EMPRESA S.A. DE C.V."/>
         <PPY:destino codigo="8476" nombre="PLANTA DE MOTORES 4 CILINDROS - SALTILLO"/>
         <nota xmlns="http://www.dfdchryslerdemexico.com.mx/Addenda/PPY">Addenda de Prueba</nota>
         <otrosCargos xmlns="http://www.dfdchryslerdemexico.com.mx/Addenda/PPY" codigo="V6" monto="1373.93"/>
         <PPY:partes>
            <part xmlns="http://www.dfdchryslerdemexico.com.mx/Addenda/PPY" numero="123456" cantidad="1.0000" unidadDeMedida="EA" precioUnitario="8587.0500" montoDeLinea="8587.05">
               <references ordenCompra="XYZ6675" releaseRequisicion="XYZ4218000" ammendment="A"/>
               <nota>Probando Addenda</nota>
            </part>
         </PPY:partes>
      </PPY:factura>
   </Addenda> 
```

I'm doing something wrong? or is there another way that works?

thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T21:55:09.757

您必须确保命名空间广告前缀已在 DOM 中注册，然后才能在子节点和属性上有效使用它们。如果您在创建它们时指定命名空间，但您之前没有在节点上注册该命名空间，则您的、`nota`和`ostrosCargos`节点`part`最终将具有自己的属性。像您目前所做的那样仅手动创建属性是不够的。您需要向 DOM 实际注册命名空间，以便它知道它并在需要时使用它。`xmlns``factura``xmlns`

查看 Embarcadero 论坛上的讨论，了解如何在 XML 数据绑定向导创建的实现代码中使用命名空间节点的提示：

[创建具有两个命名空间的文档](https://forums.embarcadero.com/thread.jspa?threadID=64760)

# objective-c - App crashes on iPad 6.0.1 only

> ID：13884346
> 
> 赞同：0
> 
> 时间：2012-12-14T18:30:29.510
> 
> 标签：objective-c, ios, ipad, webview, crash

I've a very strange problem with my app. It runs perfectly on all Devices (even on iPad) running iOS 6.0\. And with iOS 6.0.1 it runs also as expected on iPhone and iPod. But on iPad with 6.0.1 it crashes.

It's a very simple Single-View Application with a webView. This is my ViewControler.m:

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    NSURL *url = [NSURL URLWithString:@"http://telefonecke.tumblr.com"];
    NSURLRequest *req = [NSURLRequest requestWithURL:url];
    [_webView loadRequest:req];

    [super viewDidLoad];

}

-(BOOL) webView:(UIWebView *)inWeb shouldStartLoadWithRequest:(NSURLRequest *)inRequest             navigationType:(UIWebViewNavigationType)inType {
if ( inType == UIWebViewNavigationTypeLinkClicked ) {
    [[UIApplication sharedApplication] openURL:[inRequest URL]];
    return NO;
}

return YES;
}

- (void)viewDidAppear:(BOOL)animated{
[super viewDidAppear:animated];

[_webView reload];
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(willEnterForeground) name:UIApplicationWillEnterForegroundNotification object:nil];
}

- (void)viewDidDisappear:(BOOL)animated{
[super viewDidDisappear:animated];

[[NSNotificationCenter defaultCenter] removeObserver:self         name:UIApplicationWillEnterForegroundNotification object:nil];
}

- (void)willEnterForeground {
    [_webView reload];
}

- (void)didReceiveMemoryWarning
{

    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

I actually don't know why it's not working, especially because it runs perfectly on iOS 6.0 and all other devices.

I'm thankful for every suggestion. Thanks in advance!

Edit: I also have a crash report, if it's helpful: [click here for the crash report](http://cargo.bplaced.net/cargo/temp..njrwusip.crash)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T21:01:56.823

这是您崩溃的符号化 Last Exception Backtrace：

```
Last Exception Backtrace:
0   CoreFoundation                  0x327fb29e __exceptionPreprocess + 158
1   libobjc.A.dylib                 0x394dd97a objc_exception_throw + 26
2   UIKit                           0x38897d54 +[UIStoryboard storyboardWithName:bundle:] + 436
3   UIKit                           0x386da406 -[UIApplication _loadMainStoryboardFileNamed:bundle:] + 38
4   UIKit                           0x38563794 -[UIApplication _runWithURL:payload:launchOrientation:statusBarStyle:statusBarHidden:] + 524
5   UIKit                           0x3850bc34 -[UIApplication handleEvent:withNewEvent:] + 1000
6   UIKit                           0x3850b6c8 -[UIApplication sendEvent:] + 68
7   UIKit                           0x3850b116 _UIApplicationHandleEvent + 6150
8   GraphicsServices                0x35c8759e _PurpleEventCallback + 586
9   CoreFoundation                  0x327d067e __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 10
10  CoreFoundation                  0x327cfee4 __CFRunLoopDoSources0 + 208
11  CoreFoundation                  0x327cecb2 __CFRunLoopRun + 642
12  CoreFoundation                  0x32741eb8 CFRunLoopRunSpecific + 352
13  CoreFoundation                  0x32741d44 CFRunLoopRunInMode + 100
14  UIKit                           0x38562478 -[UIApplication _run] + 664
15  UIKit                           0x3855f2f4 UIApplicationMain + 1116
16  DieTelefonecke                  0x84f4e 0x83000 + 8014 
```

您的应用程序调用`0x84f4e`是主要功能，因此无需担心。

所以加载主故事板时会发生异常。这就是您应该开始关注的地方，例如故事板是否是应用程序包的一部分等。

# fortran90 - difference results between 10**-2 and E-2

> ID：13884347
> 
> 赞同：1
> 
> 时间：2012-12-14T18:30:38.830
> 
> 标签：fortran90, gfortran, fortran95

The following program print 1 for `100E-2` and gives 0 for `100*10**(-2)`, that means that the operator exponent doesnot work for negative `**`, is that correct. Thanks in advance

```
program testme

implicit none

print*,100E-2

print*,100*10**(-2)

end program 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:41:34.920

你会注意到第二个打印语句打印`0`——没有小数点，等等。例如，整数零。那是因为`10`它本身就是一个整数文字，并且将其提高到负 2 次方正确地给出了零；将它乘以整数 100 仍然给出整数零。

如果您改为使用

```
print*,100*10.**(-2) 
```

你会得到你期望的答案。

这个问题不会出现，`100e-2`因为任何用科学计数法表示的数字都是浮点 ( `real`) 文字。

# knockout.js - Kendo-Knockout：关闭窗口会破坏绑定

> ID：13884348
> 
> 赞同：1
> 
> 时间：2012-12-14T18:30:46.397
> 
> 标签：knockout.js, kendo-ui

我正在使用 RPNiemeyer 的 kendo-knockout 库。我有一个 onclick 实例化 javascript 对象的按钮，将 div 绑定到该对象并打开一个弹出窗口。当我从右上角的 x 按钮关闭窗口时（我没有导入图像并且在小提琴中没有正确显示它。），绑定被破坏并且按钮不会再次打开窗口。这是我的html：

```
<button onclick="openPopUp()">OpenPopUp</button>

<div id="productionStates" class="hidden">
    <div data-bind="kendoWindow: { isOpen: isOpen, title:'States', center:true, width: 600, height: 150, modal: true, resizable: false, actions: ['Maximize', 'Close'] }" >
        <fieldset>
            <legend>Change state:</legend>
            <table>
                <tr data-bind="foreach: productionStates">
                    <td><button class="k-button" data-bind="value: ProductionState, text: ProductionState" /></td>
                </tr>
            </table>
        </fieldset>
    </div>

</div> 
```

javascript:

```
var ProductionStatesList = function() {
    var
        self = this;

    ProductionStatesList.prototype.productionStates =
        ko.observableArray([ { ProductionState: ko.observable("Pending") } ]);

        ProductionStatesList.prototype.openPopUp = function () {
            self.isOpen(true);
        };     

        ProductionStatesList.prototype.isOpen = ko.observable(false);
        ProductionStatesList.prototype.openPopUp = function () {
                    self.isOpen(true);                    
                };
        ProductionStatesList.prototype.close = function () {
            self.isOpen(false);
        }
};
    var elementIsBound = function (elementId) {
                return !!ko.dataFor(document.getElementById(elementId));
            };

    var openPopUp = function(){
        var productionStatesList = new ProductionStatesList();
        if (!elementIsBound("productionStates")){
            ko.applyBindings(productionStatesList, document.getElementById("productionStates"));
        }

        productionStatesList.openPopUp();
    } 
```

这是 jsfiddle 中的代码：http: [//jsfiddle.net/5Zkyg/40/](http://jsfiddle.net/5Zkyg/40/)

重现步骤：

1.单击按钮。弹出窗口打开。

2.从右上方的图像关闭窗口（x按钮不可视化，因为图像未导入）。

请解释这不起作用的原因，任何解决方案将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:50:43.000

主要问题是后续调用`openPopup`正在创建 a 的新实例`ProductionStatesList`并调用`openPopup`它，而元素绑定到原始实例。

一种解决方案是在函数之外创建您的实例，例如：http: [//jsfiddle.net/rniemeyer/bZF9k/](http://jsfiddle.net/rniemeyer/bZF9k/)

否则，如果您有一个`ProductionStatesList`实例数组并想用 Knockout 管理整个事情，那么您可能希望创建一个`selectedProductionStatesList`可观察对象并`with`在窗口内的区域周围使用绑定，以便每次都重新反弹。

# shell - Finding files containing occurrences of a string

> ID：13884349
> 
> 赞同：2
> 
> 时间：2012-12-14T18:30:49.737
> 
> 标签：shell, unix, grep

One of my tasks is to count the number of files that match a certain date pattern. Really what I need to do is loop through the directory, examine each file name, find the 2nd period in that file name, and then examine the next 4 characters to see if there is a match on the date string I am assembling.

November of 2012 would be represented as "1211". Using the first four characters after the 2nd period in the file names below, this would give us a hit on the first file name ("o.tt.121113150804") since it matches that pattern. I would count that file and then leave the other two alone.

The files below are just a sampling. They can be named in many different ways. They usually are just variations of the below 99% of the time. The fact that there are 2 periods and I need to check the 4 digits after the 2nd one is a definite constant though.

File names I need to check:

```
o.tt.121113150804
o.stpw.101209092541
i.rtat.120831045704 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:40:47.233

这可以单独完成，`ls`但这也将匹配目录：

```
$ ls
i.rtat.120831045704  o.stpw.101209092541  o.tt.121113150804

$ ls *.*.1121*
o.tt.121113150804 
```

然而`find`更强大和更灵活：

```
$ find . -maxdepth 1 -type f -iname "*.*.1211*"
./o.tt.121113150804 
```

选项：

`-maxdepth 1`只看这个目录。

`-type f`只查找文件，不查找目录。

`-iname`使用模式匹配匹配任何内容的文件名，`*`因此`*.*.1211*`匹配任何内容，`.`然后是任何内容，然后是第二个`.`，然后是您的日期字符串和`*`其他任何内容。

**编辑：**

要计算匹配数，您可以通过管道传输`wc -l`并使用命令替换`$(...)`将值存储在变量中：

```
$ ls
i.rtat.120831045704  o.stpw.101209092541  o.tt.121113150804  
o.tt.121113150804c1  o.tt.121113150804c2

$ find . -maxdepth 1 -type f -iname "*.*.1211*" | wc -l
3

$ found=$(find . -maxdepth 1 -type f -iname "*.*.1211*" | wc -l)

$ echo $found
3 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T20:37:37.203

请注意，该模式`*.*.1211*`将匹配固定字符串前*多于两个点的文件。*例如，`a.b.c.1211`将匹配。

使用 bash，您可以编写：

```
shopt -s extglob
ls  +([^.]).+([^.]).1211* 
```

如果您只想计算它们：

```
files=( +([^.]).+([^.]).1211* )
echo "${#files[@]} files matched" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T22:50:57.300

@sudo_O 和 @glennjackman 回答了您的问题，但作为替代方案，如果您想一次获得所有日期的计数，您可以这样做

```
ls | awk -F'.' '{count[substr($3,1,4)]++} END{for (date in count) print date, count[date]}' 
```

# c# - Is it Possible to upload/download files from the Terminal Server Client in .NET

> ID：13884350
> 
> 赞同：1
> 
> 时间：2012-12-14T18:30:52.023
> 
> 标签：c#, .net, vb.net

i need my application to get a file from a Terminal Server Client (my C drive) and move it to the server, is it at all possible to do with .NET?

i can't seem to find any help online. how would i write out the file path?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:42:27.460

您可以使用 RDS API 实现对终端服务器（现在称为远程桌面服务）的支持：http:
[//msdn.microsoft.com/en-us/library/aa383015.aspx](http://msdn.microsoft.com/en-us/library/aa383015.aspx)

协议：http:
[//msdn.microsoft.com/en-us/library/aa383015%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa383015%28v=vs.85%29.aspx)

还要检查虚拟频道：http:
[//msdn.microsoft.com/en-us/library/aa383509%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa383509%28v=vs.85%29.aspx)

# sql-server - SELECT RADIANS(47) vs SELECT RADIANS(47.0)

> ID：13884354
> 
> 赞同：0
> 
> 时间：2012-12-14T18:31:24.907
> 
> 标签：sql-server, tsql, radians

Ran into this issue with a Store Locator that I'm building. The Radians function returns a Zero (0) when executing SELECT RADIANS(47), but it returns 0.83... when executing SELECT RADIANS(47.0).

The ending result is causing the distance calculated by the sql statement to be Zero (0). I'm running on the following system:

*   OS Name Microsoft(R) Windows(R) Server 2003 Standard x64 Edition
*   Version 5.2.3790 Service Pack 2 Build 3790
*   System Model VMware Virtual Platform
*   System Type x64-based PC
*   SQL Server Microsoft SQL Server 2005

Here is the SQL statement that I'm using the radians function with.

```
SELECT TOP 15 i.* FROM ( 
    SELECT [id],[storeName],[storeNumber],[latitude],[longitude],

    ROUND((3959*acos(cos(radians([latitude])) * cos(radians( 47 )) 
    * cos(radians( -122.915 ) - radians([longitude])) + sin(radians([latitude])) 
    * sin(radians( 47 )))) , 2) AS distance 

    FROM [Public].[dbo].[stores] WHERE [latitude] <> 0 AND [longitude] <> 0 
) i WHERE distance < '50' ORDER BY i.distance 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:36:31.417

它按设计工作。根据文档，此函数返回与参数相同的类型。与简单运算符相同：select 5/2, 5.0/2 -- 返回 2 和 2.5

# api - Graph API /threads messages usage limitations

> ID：13884356
> 
> 赞同：1
> 
> 时间：2012-12-14T18:31:24.963
> 
> 标签：api, facebook-graph-api, facebook-recommendations, facebook-batch-request, facebook-messages

With regards of using the /threads object from Graph API I want to know if a public figure account has some limitation regarding the amount of received messages / day and to know if a Facebook application that reads them using /threads has limitation to access the entire list.

Suppose I develop an app used by a public figure that would receive 500k(or above) messages a day. Can I access all the messages (using a paging technique, of course)? Is there any chance to have the account removed or app disabled because of extensive usage of messages? If there is a need to pay for an account (and-or application) with such a usage, where do I find the pricing list?

Thank you.

# ios - 从 UIBarButtonItem 问题中显示 UIActionSheet

> ID：13884363
> 
> 赞同：2
> 
> 时间：2012-12-14T18:31:46.677
> 
> 标签：ios, uiactionsheet

所以我设置了我的故事板文件和诸如此类的东西，并为我的 UIBarButton 做了一个动作。在这种方法中，我创建了一个操作表并显示它。但似乎无论我做什么，它总是从底部显示。你不能让它从导航栏弹出，边框上有一个小箭头指向你点击的按钮吗？好吧，我很难找到正确的方法。这是我尝试过的：

```
- (IBAction)actionBtnPressed:(UIBarButtonItem *)sender {
    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Options" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:@"Report User" otherButtonTitles: nil];
    actionSheet.actionSheetStyle = UIActionSheetStyleBlackOpaque;
    [actionSheet showFromBarButtonItem:sender animated:YES];
} 
```

我也试过

```
[actionSheet showFromToolbar:self.navigationController.toolbar]; 
```

而不是 showFromBarButtonItem，但这些方法并没有读懂我希望它从按钮显示的想法。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:12:32.543

对于 iPhone，actionsheet 总是从屏幕底部显示。您的意思是`UIPopover`仅适用于iPad。但是，如果您想在您的应用程序中使用相同的功能，您可以使用自定义弹出框。检查[WEPopover](https://github.com/werner77/WEPopover)。它允许您在 iPhone 中创建弹出框，并且可以安全地用于在您的应用中绘制弹出框。您可以在此弹出框内显示所需的项目。

# c# - 如何在 PowerShell C# cmdlet 中使用 WriteProgressCommand？

> ID：13884366
> 
> 赞同：4
> 
> 时间：2012-12-14T18:31:55.437
> 
> 标签：c#, powershell, .net-4.0

**更新。**`cmdlet`我在 Visual Studio 2010 中使用 C#/.Net 4.0创建了一个 PowerShell 3.0 。它工作正常。但这`cmdlet`需要一段时间，我想添加一个进度条。

MSDN 文档在 WriteProgressCommand 上含糊不清。这是链接： http: [//msdn.microsoft.com/en-us/library/microsoft.powershell.commands.writeprogresscommand.completed (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/microsoft.powershell.commands.writeprogresscommand.completed%28v=vs.85%29.aspx)

下面的代码显示了我想要做什么。基本上在`ProcessRecord()`. 然后每秒更新进度条。不知道如何显示进度条。帮助？

```
[System.Management.Automation.Cmdlet(System.Management.Automation.VerbsCommon.Get, "StatusBar")]
public class GetStatusBarCommand : System.Management.Automation.PSCmdlet
{
    /// <summary>
    /// Provides a record-by-record processing functionality for the cmdlet.
    /// </summary>
    protected override void ProcessRecord()
    {
        WriteProgressCommand progress = new WriteProgressCommand();

        for (int i = 0; i < 60; i++)
        {
            System.Threading.Thread.Sleep(1000);
            progress.PercentComplete = i;
        }

        progress.Completed = true;
        this.WriteObject("Done.");
        return;
    }
}

// Commented out thanks to Graimer's answer 
// [System.Management.Automation.CmdletAttribute("Write", "Progress")]
// public sealed class WriteProgressCommand : System.Management.Automation.PSCmdlet { } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-14T19:25:48.757

我已经测试了开发 10 分钟的 cmdlet，并弄清楚了进度条是如何工作的。我什至不能添加那个 WriteProgressCommand 类（但我又是一个编程菜鸟）。我确实开始工作的是以下内容：

```
protected override void ProcessRecord()
      {
         ProgressRecord myprogress = new ProgressRecord(1, "Testing", "Progress:");

          for (int i = 0; i < 100; i++)
          {
              myprogress.PercentComplete = i;
              Thread.Sleep(100);
              WriteProgress(myprogress);
          }

             WriteObject("Done.");
      } 
```

ProgressRecord 存储进度定义，您调用 WriteProgress 命令以使用新更新的进度数据更新 shell（powershell 窗口）。构造函数中的“1”只是一个 id。

# php - 是否有基于邮政编码返回 lat、lng 信息的 Google 服务？

> ID：13884368
> 
> 赞同：0
> 
> 时间：2012-12-14T18:32:02.940
> 
> 标签：php, javascript, html, google-maps

我查看了 Google 的[Geocoding](https://developers.google.com/maps/documentation/geocoding/) API，但他们特别指出：

> 注意：Geocoding API 只能与谷歌地图一起使用；禁止在未在地图上显示的情况下对结果进行地理编码。

Google 是否提供一项服务，该服务将返回给定邮政编码的 lat、lng 坐标以及城镇和州？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:06:36.800

我希望这是你想要的

[http://maps.google.com/maps/api/geocode/json?address=302001&sensor=false](http://maps.google.com/maps/api/geocode/json?address=302001&sensor=false)

这里 302001 是邮政编码。这将为您提供城市国家、纬度和经度、格式化地址。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:36:01.840

不，但是还有许多[其他服务](https://www.google.com/search?q=geocode+web+service&oq=geocode+web+service)可以让您这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:59:19.797

当我必须进行大量地理编码时，我会使用[这个网站。](http://www.gpsvisualizer.com/geocoder/)

# asp.net-mvc - 防止网站重定向到登录 URL

> ID：13884374
> 
> 赞同：0
> 
> 时间：2012-12-14T18:32:45.283
> 
> 标签：asp.net-mvc, iis-7.5, basic-authentication

我使用 ASP.NET MVC 开发了一组简单的页面 - 然后将它们托管在 IIS 7.5 中。这些只是视觉页面，背后没有数据。服务器在线，我不希望随便的观察者能够访问它们，所以只需使用基本身份验证设置 IIS。然后我创建了一个有限的模拟账户，以便我可以将详细信息发送给客户，以便他们查看这些可视页面。

访问网址时：www.myserver/mysite/home/index

浏览器用户名和密码框如我所料弹出。然后我输入我的模拟账户的详细信息。

然而，在成功的身份验证之后，而不是被带到 www.myserver/mysite/home/index

相反，我的浏览器试图将我带到类似于以下内容的内容：www.myserver/mysite/home/index/login.aspx?ReturnURL=.....

如果我然后返回到它正确加载的原始 URL。如何防止成功登录后的重定向？

# knockout.js - 嵌套对象的剔除自定义映射

> ID：13884377
> 
> 赞同：5
> 
> 时间：2012-12-14T18:32:51.463
> 
> 标签：knockout.js, knockout-mapping-plugin

我有一个 JSON 对象，例如：

```
{
    id:"a",
    type:"simple",
    children:[
        {
            id:"a.1",
            type:"simple",
            children:[
                {
                    id:"a.1.1",
                    type:"simple",
                },
                {
                    id:"a.1.2",
                    type:"simple",
                }
            ]
        },
        {
            id:"a.2",
            type:"simple",
        },
        {
            id:"a.2",
            type:"simple",
        }
    ]
} 
```

我正在尝试使用敲除映射插件为所有子对象创建自定义选定属性，如下所示：

```
{
    id:"a",
    type:"simple",
    children:[
        {
            id:"a.1",
            type:"simple",
            selected:true,
            children:[
                {
                    id:"a.1.1",
                    type:"simple",
                    selected:true
                },
                {
                    id:"a.1.2",
                    type:"simple",
                    selected:true
                }
            ]
        },
        {
            id:"a.2",
            type:"simple",
            selected:true
        },
        {
            id:"a.2",
            type:"simple",
            selected:true
        }
    ]
} 
```

我的代码现在看起来像这样：

```
getMapping : function() {
    var childModle = function(data) {
        data.selected = false;
        ko.mapping.fromJS(data, {}, this);
        };
        var mapping = {
            "children" : {
                create : function(options) {
                    return new childModle(options.data);
                }
            }
        };
    return mapping;
},

var mapping =  this.getMapping();
var mappedModel = ko.mapping.fromJS(model, mapping); 
```

这仅适用于顶级儿童。2-n 级子级不是使用我的映射创建的。

*** 我的模型可以有无限数量的嵌套级别 ***

我的问题是如何让孩子创建适用于所有嵌套的孩子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T15:11:56.157

您可能希望将映射选项传递`ko.mapping.fromJS`给您在`childModle`构造函数内部进行的调用。

# python - Python：试图折叠第二个参数的函数映射

> ID：13884378
> 
> 赞同：4
> 
> 时间：2012-12-14T18:32:52.570
> 
> 标签：python, functional-programming

注意：请在评论之前阅读下面的更好的更新部分。这里有一些微妙之处。据我所知，给出的答案都没有在上下文中起作用。

我试图找到一个功能略有不同的python'map'函数的模拟。这最好通过例子来解释。“地图”功能执行以下操作：

```
In [1]:    def f(x,y):
               return x+y
In [2]:    map(f, ['a','b','c'],['1','2','3'])

Out[2]:    ['a1', 'b2', 'c3'] 
```

所以，map 把 f 变成了一个新的函数，我们称之为 f_zipper。f_zipper 压缩其参数并将 f 应用于每个压缩对。

我想要构建的是一个我称之为“magical_map”的函数，其行为如下：

```
In [1]:    def f(x,y):
               return x+y
In [2]:    magical_map(f, ['a','b','c'],'1')

Out[2]:    ['a1', 'b1', 'c1'] 
```

所以 magic_map 对 f 进行了一堆调用（第一个参数列表中的每个元素一个），但是它将它们全部折叠到第二个参数上。

注意：可以这么说，我需要一个真正实用的解决方案，因为我无法访问第二个参数。

即我稍后要做的是构建以下函数：

```
intermed_func = functools.partial(magical_map, f)
final_func = functools.partial(intermed_func, arg_I_know) 
```

那么 final_func 可以称为

```
final_func(last_min_arg) 
```

并返回

```
[f(arg_I_know[0], last_min_arg), f(arg_I_know[1], last_min_arg), ...] 
```

我基本上对如何构建“magical_map”感到困惑。任何帮助都会很棒。我没有太多运气找到关于这个主题的任何东西。

谢谢！

更好的更新：

在上下文中解决问题比简单地编写一个在两个参数同时已知时起作用的函数要困难得多。问题是，它们在这种情况下并不为人所知。更准确地说，我需要能够将以下“final_func”应用于所有三个字符串。现在，使用“地图”会产生以下行为。

```
def splitfunc(string, arg):
    return string.split(arg)

intermed_func = functools.partial(map, splitfunc)
final_func = functools.partial(intermed_func, ["a_b","v_c","g,g"])

final_func("_")

Out[xx]: [['a', 'b'], ['v_c'], ['g,g']] 
```

但是当我按照建议（以下面的所有方式）定义magic_map时，我会得到错误或不正确的行为。例如。

```
def magical_map(func, mylist, arg):
   return map(f, mylist, [arg]*len(mylist)) 
```

然后我运行：

```
intermed_func = functools.partial(magical_map, splitfunc)
final_func = functools.partial(intermed_func, ["a_b","v,c","g,g"])

final_func("_") 
```

我得到：

```
['a_b_', 'v,c_', 'g,g_'] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T18:46:35.670

这个懒惰的版本怎么样：

```
>>> def add(x,y):
...     return x+y
... 
>>> def magic_map(func,*args):
...     return itertools.starmap(func,itertools.izip(*args))  #just zip in python 3.
...
>>> list(magic_map(add,['a', 'b', 'c'], itertools.repeat('1')))
['a1', 'b1', 'c1'] 
```

请注意，我们要求`zip`采用两个系列中较短的一个，以便我们可以将无限迭代传递给任一参数，这允许我们使用 扩展一个`itertools.repeat`。这也懒惰地评估，所以我想你甚至可以传递 2 个无限迭代，它会正常工作——只要你不尝试实际迭代整个返回的对象;-)

* * *

这是在与您正在做的事情类似的上下文中使用它的尝试（尽管我不完全理解您在做什么，所以这可能是一种方式）：

```
import itertools
import functools

def magic_map(func,*args):
    return itertools.starmap(func,itertools.izip(*args))  #just zip in python 3.

lst = ["a_b","v_c","g,g"]
print list(magic_map(str.split, lst, itertools.repeat('_')))

intermed_func = functools.partial(magic_map,str.split)
print list(intermed_func(lst ,itertools.repeat('_')))

final_func = functools.partial(intermed_func,lst)
print list(final_func(itertools.repeat('_'))) 
```

输出是：

```
[['a', 'b'], ['v', 'c'], ['g,g']]
[['a', 'b'], ['v', 'c'], ['g,g']]
[['a', 'b'], ['v', 'c'], ['g,g']] 
```

这就是你想要的（我认为）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-14T18:35:41.190

在 Python 3 中：

像往常一样，这是[`itertools`为了救援](http://docs.python.org/2/library/itertools.html#itertools.repeat)：

```
>>> import itertools
>>> list(map(f, ['a','b','c'], itertools.repeat("1")))
['a1', 'b1', 'c1'] 
```

对于多个值，使用[`itertools.cycle()`](http://docs.python.org/2/library/itertools.html#itertools.cycle)

```
>>> list(map(f, ['a','b','c','d'], itertools.cycle("12")))
['a1', 'b2', 'c1', 'd2'] 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-14T18:36:43.383

使用[`itertools.repeat`](http://docs.python.org/2/library/itertools.html#itertools.repeat).

```
def magic_map(f, l, v):
    return map(f, l, itertools.repeat(v, len(l)) 
```

像这样使用它：

```
>>> magic_map(f, ['a', 'b', 'c'], '1')
['a1', 'b1', 'c1'] 
```

**编辑：**

`map`，正如[thg435 所](https://stackoverflow.com/questions/13884378/python-trying-to-collapse-a-function-mapping-on-the-second-argument/13884433#comment19125398_13884417)指出的，一直持续到更长的参数结束。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-14T18:35:59.800

这个怎么样？

```
def magical_map(func, list, arg):
    return map(func, list, [arg]*len(list)) 
```

其实既然是单行函数，不如直接写出来，不要单独定义。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-14T18:42:19.867

怎么样

```
from functools import partial
def map_with(f, it, **kwargs):
    return map(partial(f, **kwargs), it)

def f(x,y): 
    return x+y

print map_with(f, ['a', 'b', 'c'], y='1') # ['a1', 'b1', 'c1'] 
```

# java - 如何将数字的 Unicode 转换为 Java 中的数字本身？

> ID：13884380
> 
> 赞同：1
> 
> 时间：2012-12-14T18:33:02.600
> 
> 标签：java, unicode

如何将数字的 Unicode 转换为 Java 中的数字本身？

```
char c ='2';
int x =c;
// here x=unicode of 2, how can I put the 2 itself in x? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:38:49.007

最通用的解决方案是

```
int x = Character.digit(c, 10); // interpret c as a digit in base 10 
```

最快的解决方案，虽然它没有做任何事情来处理错误的输入，是

```
int x = c - '0'; // subtracts the Unicode representation of '0' from c 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:37:23.500

采用

```
int x = Character.getNumericValue(c); 
```

或者

```
int x = Integer.valueOf(String.valueOf(c)); 
```

请注意，第二种方法需要两次转换，因为 Integer.valueOf 只能处理其他整数和字符串。

# java - 将文件从共享文件夹复制到 javaservlet 中的本地文件夹

> ID：13884381
> 
> 赞同：0
> 
> 时间：2012-12-14T18:33:14.897
> 
> 标签：java, servlets, copying, shared-directory

我正在开发一个 servlet，我必须将文件 (*.doc) 从其他计算机的共享文件夹复制到我的 servlet webapp 空间，但我不能。问题不是在我的 Apache 服务器上写入，而是我期待从远程文件夹（局域网中的共享文件夹）复制文件时遇到麻烦。有什么建议或想法吗？

```
File inFile = new File( "\\\\192.168.2.103\\CompartidaMatias\\tablaEstudios.txt");
        out.println("<p> AbsolutePath --> " + inFile.getAbsolutePath() + "</p>");
        out.println("<p> Path --> " + inFile.getPath() + "</p>");
        out.println("<p> Nombre --> " + inFile.getName() + "</p>");
        out.println("<p> WEBAPP_ROOT --> " + WEBAPP_ROOT + "</p>");

        File outFile = new File(WEBAPP_ROOT + "mydoc3a.txt");

        if (inFile.exists())
            out.println("<p>FILE FOUND</p>");
        else
            out.println("<p>FILE NOT FOUND</p>"); 
```

我总是找不到文件:(谢谢你的时间朋友！！我希望它可以解决，但我已经用尽了我所有的想法。再次感谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T03:34:50.263

这不是`java.io.File`工作方式。它仅适用于本地磁盘文件系统，不适用于网络资源。

你最好的办法是让你的操作系统平台创建一个指向网络资源的本地映射（一种虚拟磁盘），并且如果你在 Windows 上，也给它分配一个磁盘号。这是[有关该主题的 Microsoft Windows 7 指南](http://windows.microsoft.com/is-IS/windows7/Create-a-shortcut-to-map-a-network-drive)：

![在此处输入图像描述](../Images/cf4eb863a8f596165e97b017664b1f22.png)

您只需映射`\\192.168.2.103`到 eg `Z:\`。完成后，您应该能够按如下方式找到该文件：

```
new File("Z:/CompartidaMatias/tablaEstudios.txt"); 
```

*（请注意，它`/`的效果`\\`与您避免逃避它们一样好）*

请注意，此问题与 servlet 完全无关。这只是一个基本的Java问题。在使用方法的普通 Java 应用程序中执行此操作时，您会遇到完全相同的问题`main()`（顺便说一下，与 servlet 相比，它可以更快、更容易地进行测试）。请记住这一点，以备将来的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:42:34.997

尝试：

```
URL url = new URL( "file:///192.168.2.103//CompartidaMatias//tablaEstudios.txt" );
File inFile = new File( url.getFile() ); 
```

# php - 将 SVG 保存为 PNG

> ID：13884382
> 
> 赞同：0
> 
> 时间：2012-12-14T18:33:20.980
> 
> 标签：php, javascript, html, canvas, svg

> **可能重复：**
> [使用 PHP 将 SVG 图像转换为 PNG](https://stackoverflow.com/questions/4809194/convert-svg-image-to-png-with-php)

我有一堆`SVG`动态的文本，我需要保存为 PNG。我不能使用`canvg`，因为它不支持路径（我有弧形文本）。我想避免在服务器端安装任何东西，但如果有原生 PHP 函数，那么我可以使用它。我有什么选择来完成我需要做的事情？

# c# - 检查 Telerik RadGrid 中的所有复选框

> ID：13884383
> 
> 赞同：1
> 
> 时间：2012-12-14T18:33:23.183
> 
> 标签：c#, telerik, radgrid

我从下面的链接中复制了代码 [Check all CheckBoxes in Telerik nested Grid in C#](https://stackoverflow.com/questions/12685944/check-all-checkboxes-in-telerik-nested-grid-in-c-sharp/13883592#13883592)

当我运行代码时，我得到了这个错误：

`0x800a01b6 - Microsoft JScript runtime error: Object doesn't support this property or method`

并且在`'checkAll(this, gridToCheckAll);'`带有错误的动态运行代码中突出显示。

任何帮助，将不胜感激。

```
<script>
var gridToCheckAll = '<%= rgFiles.ClientID %>';

    function checkAll(sender, containerID) {
        var checked = sender.checked;
        var container = document.getElementById(containerID);
        var checkboxes = container.getElementsByTagName('input');
        for (var i = 0, l = checkboxes.length; i < l; i++) {
            if (checkboxes[i] != sender && !checkboxes[i].disabled)
                checkboxes[i].checked = checked;
        }
    }
</script>

<telerik:RadGrid id="rgFiles" runat="server" HorizontalAlign="NotSet" BackColor="darkgray"
    AllowPaging="True" PageSize="50" AllowSorting="True"
    EnableEmbeddedScripts="true" 
    OnNeedDataSource="rgFiles_NeedDataSource"  
    OnItemCommand="rgFiles_ItemCommand" 
    OnItemDataBound="rgFiles_ItemDataBound" 
    OnItemEvent="rgFiles_ItemEvent"
    AllowMultiRowSelection="true" Skin="" 
    AllowFilteringByColumn="true" EnableLinqExpressions="false" >
    <MasterTableView  HorizontalAlign="NotSet" AutoGenerateColumns="false" AllowSorting="True"
        Font-Size="7pt" AllowCustomSorting="true" CellPadding="2" CellSpacing="1" BorderWidth="0px"
        TableLayout="Fixed" AlternatingItemStyle-Wrap="false" ItemStyle-Wrap="false" 
        CommandItemStyle-Wrap="false" >
        <FooterStyle CssClass="datagrid-footerstyle" HorizontalAlign="Right" />
        <ItemStyle CssClass="datagrid-itemstyle" Wrap="false" Font-Size="XX-Small" Height="15px"/>
        <EditItemStyle BackColor="#2461BF" />
        <PagerStyle BackColor="#E0E0E0" ForeColor="DimGray" HorizontalAlign="Left" Mode="NextPrevAndNumeric"
            NextPageText="next" PrevPageText="prev" AlwaysVisible="True" />
        <HeaderStyle CssClass="datagrid-headerstyle" ForeColor="White" />
        <FilterItemStyle BackColor="#a9a9a9" />
        <AlternatingItemStyle CssClass="datagrid-alternatingitemstyle" />
        <ExpandCollapseColumn Visible="False">
            <HeaderStyle Width="19px" />
        </ExpandCollapseColumn>
        <RowIndicatorColumn Visible="False">
            <HeaderStyle Width="20px" />
        </RowIndicatorColumn>
        <Columns>
            <telerik:GridTemplateColumn SortExpression="Reviewed"  DataField="Reviewed" HeaderText="<input type='checkbox' id='checkAll' onclick='checkAll(this, gridToCheckAll);'>" 
                UniqueName="Reviewed" AllowFiltering="false" >
                <ItemTemplate>
                    <asp:CheckBox ID="cbReviewed" runat="server" OnCheckedChanged="cbReviewed_CheckedChanged" />
                </ItemTemplate>
                <ItemStyle Wrap="False" HorizontalAlign="Center" VerticalAlign="Top"></ItemStyle>
                <HeaderStyle Width="50px"></HeaderStyle>
            </telerik:GridTemplateColumn> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T21:10:37.910

也许您应该使用 Telerik:GridClientSelectColumn 代替您的 templateColumn，Telerik 具有您正在寻找的内置功能。

API：[http ://www.telerik.com/help/aspnet-ajax/grid-column-types.html](http://www.telerik.com/help/aspnet-ajax/grid-column-types.html)

```
<radgrid...>
<masterTableView ... >
   <columns>
      <telerik:GridClientSelectColumn UniqueName="ClientSelectColumn">
           <HeaderStyle Width="35px" />
       </telerik:GridClientSelectColumn>
    </columns>
</MasterTableView>
 <ClientSettings>
       <ClientEvents OnRowSelected="RowSelected" OnRowDeselected="RowDeselected"/>
 </ClientSettings>
</radgrid>

       function RowDeselected(sender, eventArgs){
            //your code
        }

        function RowSelected(sender,eventArgs)
        {
            var MasterTable = sender.get_masterTableView();
            var selectedRows = MasterTable.get_selectedItems();
            var selectedRowsCount = selectedRows.length;
            //etc
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-06T19:16:12.003

我知道我来不及回答最初的问题。但仍然想为其他开发人员提供我的反馈。

在这两个地方将您的 java 脚本方法名称从 checkAll() 更改为其他任何名称，您将不会看到这个讨厌的 JS 错误:)

# java - 按值排序树形图

> ID：13884384
> 
> 赞同：-1
> 
> 时间：2012-12-14T18:33:26.367
> 
> 标签：java

> **可能重复：**
> [如何对 Java 中的值对 Map<Key, Value> 进行排序？](https://stackoverflow.com/questions/109383/how-to-sort-a-mapkey-value-on-the-values-in-java)

我有一个`treemap<Integer,Float>`. 如何根据浮点数对地图进行排序？

有什么快速的方法吗？或者我必须为地图编写比较器？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:36:15.620

在实践中，您不能（正确、可靠地）`Map`按值对实现进行排序。（您可能会看到声称否则的实现是骇人听闻的，不可靠的，并且行为*非常奇怪*- 拒绝重复值，在尝试查看不在映射中的键时抛出异常，如果支持映射发生更改，则会出现不可恢复的损坏......）

相反，明确地对条目列表进行排序：

```
List<Map.Entry<Integer, Float>> list = new ArrayList<>(map.entrySet());
Collections.sort(list, new Comparator<Map.Entry<Integer, Float>>() {
  public int compare(Map.Entry<Integer, Float> e1, Map.Entry<Integer, Float> e2){
    return e1.getValue().compareTo(e2.getValue());
  }
}); 
```

如果你喜欢，你可以把它放到一个`LinkedHashMap`：

```
Map<Integer, Float> sortedMap = new LinkedHashMap<Integer, Float>();
for (Map.Entry<Integer, Float> entry : list) {
  sortedMap.put(entry.getKey(), entry.getValue());
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:39:59.313

最简单的解决方案可能是改用 LinkedHashMap，并按值对其进行排序。请参阅： [如何按其值类的字段对 LinkedHashMap 进行排序？](https://stackoverflow.com/questions/1117553/how-to-sort-a-linkedhashmap-by-its-value-classs-field)

# mysql - 如何在 MySQL 中执行多个 LEFT JOIN？

> ID：13884385
> 
> 赞同：0
> 
> 时间：2012-12-14T18:33:27.630
> 
> 标签：mysql, select, left-join

让我先描述一些背景。我们有一个包含我们所有产品的表，一个包含“产品标签”列表（材料/尺寸/类型）的表，以及一个包含分配给产品的标签列表的表（“tag_id”= > 1 (材料), '价值' => '黄金', '产品' => 123)

我正在尝试使用与此类似的查询来过滤掉某些产品，但它似乎不起作用。任何人都可以提供一些正确方向的指示吗？

```
SELECT DISTINCT `products`.* FROM `products`,`product_assigned_tags`
LEFT JOIN `product_assigned_tags`   AS tags_0 ON tags_0.`tag_id` = 1
LEFT JOIN `product_assigned_tags`   AS tags_1 ON tags_1.`tag_id` = 2
WHERE (
    ((tags_0.`value` = 'silver' ) AND (tags_0.`value` != 'gold' ) ) AND
    ((tags_1.`value` = 'small' ) AND (tags_1.`value` != 'large' ) )
) AND (`products`.`type` = '2' OR `products`.`type` = '1' ) LIMIT 0, 30 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:56:37.880

您的查询存在一些问题。

首先，您有一个 CROSS JOIN，它将生成一个笛卡尔积，从中返回的每一行都`products`将与`product_assigned_tags`.

此外，由于 WHERE 子句中的谓词，您接下来的两个联接实际上根本不是 LEFT 联接（它们不是外部联接）。的检查`value = 'foo'`有效地否定了外部连接。

此外，您的某些谓词是多余的。

如果`value = 'silver'`计算结果为真，则`value != 'gold'`保证为真，则无需包含该不等式谓词。

* * *

看起来该`product_assigned_tags`表确实与产品相关，其中一`product_id`列作为`products.id`. （没有任何模式定义，我只是在猜测。

```
SELECT DISTINCT p.*
  FROM `products` p
  JOIN `product_assigned_tags` tags_0
    ON tags_0.product_id = p.id
   AND tags_0.`tag_id` = 1
   AND tags_0.`value` = 'silver'
  JOIN `product_assigned_tags` tags_1 
    ON tags_1.product_id = p.id 
   AND tags_1.`tag_id` = 2
   AND tags_1.`value` = 'small'
 WHERE p.`type` IN ('1','2')
 ORDER BY 1
 LIMIT 0,30 
```

* * *

**问：** 我将如何处理带有 JOIN 的“OR”案例？例如：客户选择查看材质为“金”或“银”的所有产品？

**A：**`OR`在连接谓词中 表达条件，例如

```
 AND tags_0.`value` IN ('silver','gold') 
```

这相当于：

```
 AND ( tags_0.`value` = 'silver' OR tags_0.`value` = 'gold') 
```

# sass - 如何在不同的导入文件之间共享变量？

> ID：13884389
> 
> 赞同：26
> 
> 时间：2012-12-14T18:33:39.263
> 
> 标签：sass

我想以模块化的方式使用 SASS。在下面的代码段中，您可以看到我考虑组织页面布局的一种方式。

我想到的是[C 等语言中的外部变量](https://stackoverflow.com/questions/1433204/what-are-extern-variables-in-c)。

```
// file: some_page.scss  
//   
// I want some variables from the fonts, colors partials  
// to be visible to the buttons partial  
// Is it possible?   
// error: _buttons.scss (Line X: Undefined variable: "$color_blue")

@import "colors"  
@import "fonts"  
@import "buttons" 

// in file: _colors.scss  
$color_blue: blue;

// in file: _buttons.scss  

.button {
    background-color: $color_blue;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-14T18:37:29.427

是的，它就是这样工作的。

只要`_colors.scss`是在其他文件之前导入。

你可以在这里查看 Twitter Bootstrap 到 Sass 的端口：[https](https://github.com/thomas-mcdonald/bootstrap-sass) ://github.com/thomas-mcdonald/bootstrap-sass它以类似的方式使用变量。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-14T00:58:16.380

您需要`;`在行尾添加一个`@import`。

# jquery - 自定义验证规则以在 javascript 中设置特定字符串

> ID：13884391
> 
> 赞同：-1
> 
> 时间：2012-12-14T18:34:04.573
> 
> 标签：jquery, custom-validators

有一个文本字段**id_number**并且要在该字段中输入的数据应满足以下条件

1.  前 2 个字母必须是“MU”或“mu”

2.  不允许使用空格或特殊字符

如果**id_number**中的值与上述条件 2 不匹配，则会显示**“请输入有效 ID，例如 MUXYZ001”**。

为此，我编写了一个简短的自定义验证规则：

```
{literal}
jQuery.validator.addMethod("checkId", function(value, element) {
var id_val = $("#id_number").val();
var string1=id_val.substr(0,2);
var badchars = /[<>$@&+()[\]{},` ]/;

if ( (string1=='mu') && (!(badchars.test(id_val)))){ 
               return false;
          }else{
              return true;
          }
}, "Please enter valid ID e.g, MUXYZ001");{/literal} 
```

和自定义规则：

```
rules: {
         id_number: {checkId: true}
       } 
```

但它不工作..

有人请为我修好它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:55:37.820

**更新**

请改用正则表达式，请参阅此示例片段以了解想法：

```
{literal}
jQuery.validator.addMethod("checkId", function(value, element) {
var id_val = $("#id_number").val(); 
       var reg= new RegExp("^mu\\d{2}\\D+$","i"); 
       if (reg.test(id_val)){ 
                   return true;
       }else{
           return false;
       }
}, "Please enter valid ID e.g, MUXYZ001");{/literal} 
```

# vb.net - 生成 VB.NET 代码来运行 SSIS 包？

> ID：13884393
> 
> 赞同：2
> 
> 时间：2012-12-14T18:34:14.543
> 
> 标签：vb.net, ssis, dts

我自己是一名系统程序员，对 DTS 或任何 ETL 等都是全新的。我在这里遇到了一个情况，非常感谢您的支持。

到目前为止，我们在项目中使用 MS SQL 2000，现在正在努力转移到 2008 年。

我可以看到一些很久以前用 MSSQL2000 创建的 .dts 文件。VB 脚本 (.bas) 文件是从这些 .dts 文件生成的，它们一直在 VB 程序中运行，直到现在。

问题:: 现在我们正在迁移到 MS SQL 2008 ==> 我需要确保 VB 程序（从之前的 .dts 文件生成）即使使用 MSSQL 2008 R2 也可以很好地运行和维护。

问题：首先这些程序即使在MSSQL2008（没有MSSQL2000）中也可以维护吗？如果是，我是否需要任何 dll 或引用等？

我可以看到我的一名团队成员将 .dts 迁移到 .dtsx 文件，有没有办法从 .dtsx 生成 VB 文件（.bas）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T13:08:38.003

SQL Server 2000 (DTS) 和 SQL Server 2008 (SSIS) 中的 ETL 解决方案不兼容，但您可以使用SSIS 包中的[执行 DTS](http://msdn.microsoft.com/en-us/library/ms137907%28v=sql.105%29.aspx)任务。你不需要任何dll。

在你有机会重写你的系统之前，这会给你一些时间。您最终必须这样做，因为“执行 DTS”是不推荐使用的组件，并且在未来的版本中将不受支持。

# javascript - 根据分配给它的特定 css 类的另一个 div #id 隐藏带有 css #id 的 div

> ID：13884394
> 
> 赞同：0
> 
> 时间：2012-12-14T18:34:16.423
> 
> 标签：javascript, jquery, css, class, variables

我是一个 jscript 新手，我正在使用一个已经包含一些 js 的 html 模板。基本上我的问题是这个....

更改的类别`div#header-container`取决于您在屏幕上的滚动位置。如果 div#header-container CLASS 不等于 .intro。然后我需要在具有 ID 的页面上隐藏另一个 div `#intro`。

`#header-container`课程在`.intro`开头，然后当您`div#intro`在开头的 ( ) 下方滚动时，`#header-container`课程会从`.intro`变为`.main`- 这就是我需要隐藏预先存在的`div#intro`.

本质上，我希望重新创建[http://www.mountaindew.com](http://www.mountaindew.com)在您滚动经过第一个屏幕时所做的事情

我猜我需要在`document.getElementByClassName`某个地方使用？

任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:50:10.420

您需要将窗口对象与滚动绑定并检查**`header-container`**有类**`intro`**。

```
$(window).scroll(function() {
  if ($('#header-container').hasClass('intro')) {
     $('#intro').show();
  } else {
     $('#intro').hide();
  } 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:50:28.437

试试 jQuery

就像滚动事件中的以下代码一样。

```
if(jQuery("#header-container").hasClass('intro')){
  jQuery("#intro").hide();
  jQuery("#header-container").removeClass('intro');
  jQuery("#header-container").addClass('main');

} 
```

像这样的东西？？？

# php - 我的循环做错了吗 - WordPress

> ID：13884395
> 
> 赞同：0
> 
> 时间：2012-12-14T18:34:17.320
> 
> 标签：php, wordpress, loops, wordpress-theming

上次我检查时，我知道如何编写一个循环来显示我所有的帖子.....但是当我写这个时：

```
if (have_posts()){
    while (have_posts()): the_post();
    ?>
    <div clas="span6">
        <h3><a href="<?php echo the_permalink(); ?>"><?php echo the_title(); ?></a></h3>
        <p><?php echo the_excerpt(); ?></p>
    </div>
    <?php
    endwhile;
} 
```

我遇到了一个问题：

如果我有以下帖子：

**帖子 1、帖子 2、​​帖子 3**

帖子 1 - 2 将显示在列表中，直到我写了一篇新帖子（帖子 4）并发布它，帖子 3 才会显示在该列表中。

那么我的循环有什么问题？

以前从未有过这个问题。

**注意：**正在使用 WordPress 3.5。

我检查了[WordPress 文档](http://codex.wordpress.org/The_Loop_in_Action)，以确保我做的事情是正确的，并且据我所知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:08:33.517

我看到了一些可能导致您的问题的事情。首先，您有一组`{ }`不需要的。您对循环的开放应该是：

```
<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?> 
```

代替：

```
<?php if (have_posts()){ while (have_posts()): the_post(); ?> 
```

看到循环中的大括号了吗？

然后正如 McNab 所说，只需通过添加“s”来修复您的 div 类并`echo`从内容拉取器中删除。

您还需要`endif;`在`endwhile;`.

所以你的完整循环应该像这样循环：

```
<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

    <div class="span6">
        <h3><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
        <p><?php the_excerpt(); ?></p>
    </div>

<?php endwhile; endif; ?> 
```

我认为这应该可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:59:56.053

你可以像下面这样使用它。这主要用于wordpress。

```
if (have_posts()) :  // your code if (have_posts()){
   while (have_posts()): the_post();
   ?>
   <div clas="span6">
      <h3><a href="<?php echo the_permalink(); ?>"><?php echo the_title(); ?></a></h3>
      <p><?php echo the_excerpt(); ?></p>
   </div>
   <?php
   endwhile;
endif; //your code here } 
```

希望它可以工作。

# api - 通过 API 登录网站

> ID：13884399
> 
> 赞同：0
> 
> 时间：2012-12-14T18:34:49.327
> 
> 标签：api, theory

我们允许开发人员让他们的用户通过 API 登录我们的网站/平台。登录将通过 HTTPS 访问我们的 API，因此它至少会安全地传递用户名和密码。

但在那之后，通过 API “登录”此人的最有效方法是什么？这就是我的想法。

// 应用程序将用户名和密码传递给 API

// 我们的 API 处理用户名和密码。

// 如果登录失败，输出失败代码

// 如果登录成功，则创建一个 authcode 并将其保存在用户表中。将 authcode 和 user_id 发送回应用程序

现在，每次用户执行操作（例如发表评论）并访问我们的 API 时，我们都需要 user_id 和 authcode 来进行身份验证。

我错过了什么吗？我应该在 X 小时后包含一个过期列以“注销”用户吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:09:53.520

一般来说，你的过程很好。这与互联网上一些主要 API 的工作方式相同。

您可以考虑添加一些内容（现在或将来）：

*   *created-on*（用于注销功能）。我建议在特定时期后将它们过期（即使是一个月）
*   *miss*，每次在 API 中使用“未验证”身份验证码命中 user_id 时都会计数。通过这种方式，您可以检测暴力破解并决定是否还要添加其他对策（例如将 authcode 锁定到 IP）。
*   *ip*，将验证码锁定到 IP 以防止暴力破解

# javascript - 如何从 Javascript 访问 Django 多对多模型？

> ID：13884402
> 
> 赞同：0
> 
> 时间：2012-12-14T18:34:51.137
> 
> 标签：javascript, django

给定一个具有多对多模型的 Django 模板变量，是否可以将其传递给 Javascript 函数并访问它？

（我想要得到的是当前用户所属的组列表，包括 pk）。

例如，如果我有一个用户*jsmith*属于两个组，*alpha*和*beta*：

```
<html>
<script type="text/javascript">
    mangle_data("{{ user.name }}", "{{ user.groups }}", "{{ user.groups.all }"");
</script>
</html>

function mangle_data(username, groups, all) {
    alert("username = " + username); // works. output = "jsmith"
    alert("user.groups = " + groups); // output = "django.db.models.fields.related.ManyRelatedManager object"
    alert("all = " + all); // output = "[Group alpha; Group beta;]"
} 
```

在所有情况下，传递给 Javascript 的参数都是单个扁平化字符串。理想情况下，我会得到一个对象，甚至是一个包含组名和组 pk 的列表。

诚然，我可以*找到*一个组的 pk，给出它的名字 - 但这是更多的步骤。如果我可以将 Django 模板中的数据直接获取到 Javascript 中，那就更简洁了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:38:34.327

在上下文变量中[序列化`user.groups`](https://docs.djangoproject.com/en/dev/topics/serialization/#serializing-django-objects)怎么样？

如果将这些序列化为 JSON，则可以轻松地从页面的 JS 中检索解析它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T15:27:50.660

我最终解决这个问题的方法是使用上下文处理器来格式化数据，并将其传递给模板变量：

```
context_processors.py

def site_settings(request):
    if request.user.is_authenticated():
        user_groups = "+".join(['{"id":%s, "name":"%s"}' % 
            (grp['id'], grp['name']) for grp in rquest.user.groups.values()])
    else:
        user_groups = ''
    return {'USER_GROUPS': user_groups, }

template.html

<html>
<script type="text/javascript">
    mangle_data("{{ USER_GROUPS|safe }"");
</script>
</html>

handle_data.js

function mangle_data(groups) {
    var groups_json = '[' + groups.split('+').join(',') + ']';
    var groups_OBJ = JSON.parse(groups_json); // this is now a Javascript object.
} 
```

# javascript - 如何在 Backbone.js 中设置单个属性（验证）

> ID：13884411
> 
> 赞同：1
> 
> 时间：2012-12-14T18:35:14.543
> 
> 标签：javascript, validation, backbone.js

昨天，经过大量研究后，我发现如果我不想在我的主干模型上设置单个属性（并进行验证），那么我需要发送`{silent: true}`. 话虽如此，我们还发现在下一个版本中，backbone.js`silent: true`实际上仍将运行验证。

这样做的问题是，从实际设置属性中设置的验证块。因此，如果我们没有silent:true，那么设置一个接受单个属性的方法就没有意义了。为了解决这个问题，我们的 validate 方法看起来像这样：

```
validate : function(attrs) {
    var errors = {};
    if (typeof attrs.first_name !== 'undefined' && !attrs.first_name) {
        errors.first_name = "First name can't be empty";
    }
    ...
    if (!_.isEmpty(errors)) {
        return errors;
    }
} 
```

这会导致保存不起作用。所以我们决定写这样的东西：

```
if (_.isEmpty(attrs)) {
    attrs = this.attributes;
} 
```

这样做的问题是，如果您在保存时发送了属性，那么您需要将它们合并，我想这没问题，但这都是一项相当多的工作，可以让一些简单的验证工作/或不运行。此外，除非我覆盖 _validate，否则我需要在每个模型上都这样做。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:15:54.077

Backbone 默认使用旧属性扩展旧属性：[https ://github.com/documentcloud/backbone/blob/master/backbone.js#L574](https://github.com/documentcloud/backbone/blob/master/backbone.js#L574)

因此，只有新属性才能破坏验证方法。

在这里，我认为您的问题是您将太多的验证与所有属性的存在联系在一起，而您并没有同时设置它们。因此，您应该确保允许将其他属性设置为`undefined`.

例子：

```
// Check if name is set, ignore otherwise
if( attr.name && attr.name !== "Santa" ) { return "Can't be Santa"; } 
```

另一种解决方案是给每个属性一个有效的默认值。

# r - 使用 knitr 制作两倍于屏幕大小的图形

> ID：13884413
> 
> 赞同：3
> 
> 时间：2012-12-14T18:35:25.120
> 
> 标签：r, ggplot2, knitr

使用以下`ggplot2`代码，我可以使绘图的大小是屏幕上的两倍。

```
ratings <- qplot(rating, data=movies, geom="histogram")
ggsave(ratings, file="ratings.pdf", scale=2) 
```

我想知道如何在屏幕上显示两倍大的绘图`knitr`。

```
<< label = test, fig.width  = 6, fig.height = 6, out.width  = '.6\\linewidth'>>=
ratings <- qplot(rating, data=movies, geom="histogram")
@ 
```

但没有得到两倍于屏幕上的情节。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:47:20.233

通过写 out.width = '.6\linewidth' 你强制缩小。你试过把这个排除在外吗？

# c# - 注册用户自定义热键

> ID：13884418
> 
> 赞同：1
> 
> 时间：2012-12-14T18:35:57.103
> 
> 标签：c#

# 我的解决方案

```
[DllImport("user32.dll")]
public static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, int vk);
[DllImport("user32.dll")]
public static extern bool UnregisterHotKey(IntPtr hWnd, int id);
public enum KeyModifiers : uint { None = 0, Alt = 1, Control = 2, Shift = 4, Windows = 8, }
Actions<int, string> Directories = new Dictionary<int, string>();
const string MessageTitle = "Opps, Somthing Happened!";
const MessageBoxButtons msgButtons = MessageBoxButtons.OK;
const MessageBoxIcon msgIcon = MessageBoxIcon.Information;

private void btnCreateShortcut_Click(object sender, EventArgs e)
{
    if (cboModifier.SelectedIndex > 0)
    {
        uint key = (uint)Enum.Parse(typeof(KeyModifiers), cboModifier.SelectedItem.ToString());
        if (txtShortcutKey.Text != "")
            CreateHotKey(key, txtShortcutKey.Text.ToString());
        else
            MessageBox.Show("Please enter a Hot key to use", MessageTitle, msgButtons, msgIcon);
    }
    else
        MessageBox.Show("Please Select a Base Key", MessageTitle, msgButtons, msgIcon);
}

private void btnDestroyShortcuts_Click(object sender, EventArgs e)
{
    destroyShortcuts();
}

private void quickActions_FormClosing(object sender, FormClosingEventArgs e)
{
    destroyShortcuts();
}

protected override void WndProc(ref Message msg)
{
    switch (msg.Msg)
    {
        case 0x0312:
            if (Actions.ContainsKey((int)msg.WParam))
                // Preform Action
            break;
    }
    base.WndProc(ref msg);
}

public void destroyShortcuts()
{
    foreach (KeyValuePair<int, string> pair in Actions)
        UnregisterHotKey(this.Handle, pair.Key);

    lstActiveKeys.Items.Clear();
    Actions.Clear();
}

public void CreateHotKey(uint modifier, string key)
{
    int keyID = (Actions.Count + 1) * 100;
    Actions.Add(keyID, txtAction.Text.ToString());
    lstActiveKeys.Items.Add(modifier + "+" + key[0] + " - " + txtAction.Text.ToString());
    RegisterHotKey(this.Handle, keyID, modifier, (int)((char)key[0]));
} 
```

我想知道如何制作它，以便我的用户可以根据选择控制键和字母的选项定义自己的热键。

我发现的所有代码都显示了如何定义一个热键，但一个用户可能有 3 个，另一个用户可能有 5 个，而且它们可能不是同一个键。

我想要的是一个控制键和一个字母数字键，我可以创建一个 Windows 热键。

我还需要能够在应用程序关闭时销毁注册的密钥。

**PS：**这些需要是系统范围的，而不仅仅是在应用程序中。感谢@scott-chapman 指出这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:59:25.990

这是一个 VS2010 项目的链接。我去年写的。文件托管在 SkyDrive 上。

[http://sdrv.ms/Wc2R5H](http://sdrv.ms/Wc2R5H)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T16:13:50.200

这是我开发的解决方案，这是一种看起来运行良好的 C# 方法。

```
[DllImport("user32.dll")]
public static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, int vk);
[DllImport("user32.dll")]
public static extern bool UnregisterHotKey(IntPtr hWnd, int id);
public enum KeyModifiers : uint { None = 0, Alt = 1, Control = 2, Shift = 4, Windows = 8, }
Actions<int, string> Directories = new Dictionary<int, string>();
const string MessageTitle = "Opps, Somthing Happened!";
const MessageBoxButtons msgButtons = MessageBoxButtons.OK;
const MessageBoxIcon msgIcon = MessageBoxIcon.Information;

private void btnCreateShortcut_Click(object sender, EventArgs e)
{
    if (cboModifier.SelectedIndex > 0)
    {
        uint key = (uint)Enum.Parse(typeof(KeyModifiers), cboModifier.SelectedItem.ToString());
        if (txtShortcutKey.Text != "")
            CreateHotKey(key, txtShortcutKey.Text.ToString());
        else
            MessageBox.Show("Please enter a Hot key to use", MessageTitle, msgButtons, msgIcon);
    }
    else
        MessageBox.Show("Please Select a Base Key", MessageTitle, msgButtons, msgIcon);
}

private void btnDestroyShortcuts_Click(object sender, EventArgs e)
{
    destroyShortcuts();
}

private void quickActions_FormClosing(object sender, FormClosingEventArgs e)
{
    destroyShortcuts();
}

protected override void WndProc(ref Message msg)
{
    switch (msg.Msg)
    {
        case 0x0312:
            if (Actions.ContainsKey((int)msg.WParam))
                // Preform Action
            break;
    }
    base.WndProc(ref msg);
}

public void destroyShortcuts()
{
    foreach (KeyValuePair<int, string> pair in Actions)
        UnregisterHotKey(this.Handle, pair.Key);

    lstActiveKeys.Items.Clear();
    Actions.Clear();
}

public void CreateHotKey(uint modifier, string key)
{
    int keyID = (Actions.Count + 1) * 100;
    Actions.Add(keyID, txtAction.Text.ToString());
    lstActiveKeys.Items.Add(modifier + "+" + key[0] + " - " + txtAction.Text.ToString());
    RegisterHotKey(this.Handle, keyID, modifier, (int)((char)key[0]));
} 
```

# javascript - 解析html输出并执行javascript

> ID：13884422
> 
> 赞同：0
> 
> 时间：2012-12-14T18:36:05.667
> 
> 标签：javascript, html, ajax

我有这个功能：

```
function parseScript(_source) {
    var source = _source;
    var scripts = new Array();

    while(source.indexOf("<script") > -1 || source.indexOf("</script") > -1) {
        var s = source.indexOf("<script");
        var s_e = source.indexOf(">", s);
        var e = source.indexOf("</script", s);
        var e_e = source.indexOf(">", e);

        scripts.push(source.substring(s_e+1, e));
        source = source.substring(0, s) + source.substring(e_e+1);
    }
    for(var i=0; i<scripts.length; i++) {
        try {
            eval(scripts[i]);
        }
        catch(ex) {
        }
    }
    return source;
} 
```

它很好地解析和执行 Javascript，除了`<script type='text/javascript' src='scripts/gen_validatorv31.js'></script>`src 文件中的 when 永远不会被执行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T08:17:05.453

解析器只能评估您打开的文件中的内联脚本。要评估外部脚本，您必须找到它们的来源，可能使用类似：

```
var scripts = source.match(/<script[^>]*src=[^>]*>/g);
if (scripts) {
    for (var i = 0; i < scripts.length; i++) {
        src = scripts[i].match(/src=("([^"]*)"|'([^']*)')/);
        src = src[2] || src[3];
        if (src) {
            addScriptTag(src);
        }
    }
}
else console.log('no external scripts found'); 
```

[这个答案](https://stackoverflow.com/a/7293359/567595)`addScriptTag`中描述了哪里。如果可能，将脚本添加到头部。如果您需要将脚本添加到正文，则需要对其进行调整。`addScriptTag`

然而……为什么要这样做？解析整个 HTML/Javascript 页面以获取脚本是缓慢而混乱的；例如，您最终可能会加载两次相同的脚本或加载两个不能很好地协同工作的脚本。此外，如果将脚本插入头部或身体的不同点，脚本可能无法正常工作。使用 AJAX，您应该只加载您需要的特定元素。通常这意味着加载要添加到页面的数据或 HTML 位。如果您有开始时不需要但稍后可能需要的长脚本，那么动态地将新脚本添加到页面可能是合理的。但在许多情况下，最好在开始时加载所有需要的脚本。如果您真的需要完全切换页面，那么使用链接到另一个页面的老式方法不是更好吗？

# java - 处理来自外部网站的请求

> ID：13884423
> 
> 赞同：0
> 
> 时间：2012-12-14T18:36:05.700
> 
> 标签：java, http, playframework, twitter

我正在编写一个向 Twitter API 发送请求的应用程序。流程的一部分需要重定向到 Twitter 登录页面。用户登录后，会向回调 url 发送一个请求，其中包含我需要继续流程的信息。问题是，登录后，我的应用程序会在 url 栏中弹出相关信息。因此，例如，url 看起来像这样：

{http://localhost:9000/?oauth_token=KlQrT7YoFC2j3wAVGK57JRRI5h6LFI08H1zkhm8uEo&oauth_verifier=dU1H8D1no1wmKNRdpecHDrWegTQm4dvI15rnUblqxM}

我需要 {'http://localhost:9000'} 之后的信息，所以我的问题是，我如何得到它？

我能在 HTTP 请求上找到的唯一信息是制作它们，关于接收它们的信息很少。甚至我在收到它们时发现的东西也没有涵盖我遇到的问题。我想这个问题的解决方案可能非常有用，因为它涉及任何想要使用 Twitter 实现登录的应用程序的核心。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T20:26:10.840

创建一个服务于 / 的控制器，示例`routes`文件

```
GET     /                                        Twitter.authorize 
```

然后在控制器中你可以使用参数：

```
public static void authorize(String oauth_token, String oauth_verifier) {
  .... do something ....
} 
```

# iphone - 如何使uiview约束无效

> ID：13884427
> 
> 赞同：4
> 
> 时间：2012-12-14T18:36:22.810
> 
> 标签：iphone, objective-c, ios6, nslayoutconstraint

我想使代码中的 uiview 约束无效，以强制所有字段根据视图中的特定更改重新布局。

例如，假设我有两个 UILabel，它们被赋予了一个固定的 VerticalSpace 约束。在某些用户事件中，我正在调整顶部标签的大小。我希望能够强制约束使代码无效。

这是我第一次使用约束，我不明白如何从代码中做到这一点。我知道当设备旋转时，UIViews 上的约束无效。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T08:31:11.453

您调用`setNeedsLayout`相关视图，通常是您的视图控制器的`.view`. ：

```
[self.view setNeedsLayout]; 
```

您并没有真正使约束无效，这是用于自定义视图的稍微不同的东西，它可能需要根据其他更改删除和重新计算约束。你所做的是让视图知道它用来计算其布局的一些因素现在已经改变了。约束仍然有效，但结果发生了变化。

要为您的新布局设置动画，您可以`layoutIfNeeded`在动画块内调用。

# ios - 从推入的 ViewController 中解除 Modal NavigationController

> ID：13884428
> 
> 赞同：10
> 
> 时间：2012-12-14T18:36:28.547
> 
> 标签：ios, xcode, uinavigationcontroller, storyboard

我有一个 iPad 应用程序，我正在使用情节提要。我正在展示一个模态视图，我将其包装在`UINavigationController`. 这是一个带有自己导航的模式“设置”视图。

我有一个委托设置，可以使用“设置”视图中的“完成”按钮关闭模态视图本身，该按钮工作正常，但即使在用户点击设置时它已推送另一个视图后，我也需要能够将其关闭。

因此，基本上是推送视图中导航栏右侧的“取消”按钮。不必返回第一个“设置”视图来点击完成按钮。

我尝试为推送视图设置第二个委托，但没有成功：

![在此处输入图像描述](../Images/b2ee9ccb3dab87702094585fe8510308.png)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-14T18:53:55.923

只需添加一个条形按钮项并将此行放入其操作方法中：

```
[self.presentingViewController dismissViewControllerAnimated:YES completion:nil]; 
```

呈现视图控制器将是呈现模态的控制器，而不是导航控制器。

# r - events.chart y 实验室文本大小

> ID：13884431
> 
> 赞同：0
> 
> 时间：2012-12-14T18:36:38.570
> 
> 标签：r, charts, axis, hmisc

嗨，我有以下 Hmisc 包中的 events.chart。

```
 event.chart(events,
    subset.c = c('D2BMET','T2Fail','Cens','zero'),
    x.lab = 'Progression Time for Breast Cancer Patients (months)',
    y.lab = 'Subjects (sorted by time to 1st Brain Metastasis)',
    y.idlabels = 'Pt', 
    titl = 'Breast Cancer Brain Metastasis Events Chart',
    point.pch = c(1,2,17,124), point.cex = c(1,1,1,1),
    legend.plot = TRUE, legend.location = 'i', legend.cex = 1,
    legend.point.text = c('Time to 1st Brain Metastasis', 'Last Followup', 'Death'),
    x.julian = TRUE,
    legend.bty='o', legend.point.at = list(c(400,400), c(14,14))) 
```

我尝试使用

```
 axis(2,cex.axis= 0.5) 
```

使 y 轴文本更小，但没有任何反应。正在做

```
 axis(1,cex.axis= 0.5) 
```

使 x 轴文本更小，但在 y 轴上似乎没有任何效果。

任何建议，将不胜感激。

谢谢，埃德

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:33:33.387

在没有测试集的情况下，建议您更仔细地阅读帮助页面，并特别注意：

“y轴：

字符串，指定程序是否将控制 y 轴的标签（使用参数“auto”），或者用户是否将控制标签（使用参数“custom”）。如果选择“自定义”，用户必须分别使用 y.axis.custom.at 和 y.axis.custom.labels 参数指定标签的位置和文本，如下所列。如果指定了 y.idlabels，则不会使用此参数。”

因此，随着您选择设置`y.idlabels = "Pt"`，您将放弃进一步的控制可能性。事实证明，即使设置`y.axis="custom"`仍然没有机会更改 y.axis cex.axis。我在查看代码后发现了这一点。所以你需要破解代码。它组织得很好，您可以选择添加参数或硬编码一次性更改。

# jquery - jQuery 验证和自定义 id

> ID：13884435
> 
> 赞同：1
> 
> 时间：2012-12-14T18:36:57.353
> 
> 标签：jquery, jquery-validate

我正在使用 jquery validate，当我像这样进行验证时

```
$("#form").validate({
            // errorLabelContainer: $("div#error"),
            errorElement: "p",
            errorClass: "form-error",
            rules: {
                name: {
                    required: true,
                    minlength: 5
                }
            }
}); 
```

一切正常，但如果我有这样的 div id “x.child.1.0.t”，我必须使用这样的东西

```
$("#form").validate({
            // errorLabelContainer: $("div#error"),
            errorElement: "p",
            errorClass: "form-error",
            rules: {
                x.child.1.0.t: {
                    required: true,
                    minlength: 5
                }
            }
}); 
```

这不起作用，怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:38:11.673

把它放在`"`or里面`'`，就像 a 一样`string`，别忘了使用`name`attr。

```
$("#form").validate({
            // errorLabelContainer: $("div#error"),
            errorElement: "p",
            errorClass: "form-error",
            rules: {
                'x.child.1.0.t': {
                    required: true,
                    minlength: 5
                }
            }
}); 
```

`A validation rule associates an element with a validation method, like "validate input with name "primary-mail" with methods "required" and "email".`
[参考](http://docs.jquery.com/Plugins/Validation)

 **具有复杂名称的字段（括号、点）**

`If your form consists of fields using names that aren't legal JavaScript identifiers, you have to quote those names when using the rules option: `
[参考](http://docs.jquery.com/Plugins/Validation/Reference#Fields_with_complex_names_.28brackets.2C_dots.29)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-14T18:47:39.173

> ...但是如果我有这样的 div id `x.child.1.0.t`... 不工作...

你必须做两件事...

*   使用`name`你的属性`input`，而不是`id`. 默认情况下，`.validate()`插件正在寻找's的`name`属性，而不是它们的. [请参阅项目下的文档](http://docs.jquery.com/Plugins/Validation/validate#toptions)[。](http://docs.jquery.com/Plugins/Validation/validate#toptions)`input``id`[`rules:`](http://docs.jquery.com/Plugins/Validation/validate#toptions)

*   将名称放在`.validate()`选项中的引号内。 [请参阅有关复杂命名的文档。](http://docs.jquery.com/Plugins/Validation/Reference#Fields_with_complex_names_.28brackets.2C_dots.29)

**HTML：**

```
<input name="x.child.1.0.t" /> 
```

**jQuery：**

```
$("form").validate({
    // errorLabelContainer: $("div#error"),
    errorElement: "p",
    errorClass: "form-error",
    rules: {
        'x.child.1.0.t': {
            required: true,
            minlength: 5
        }
    }
});​ 
```

[jsFiddle 演示](http://jsfiddle.net/c6xKq/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T18:54:07.867

如果你想验证`id`而不是`name`你必须做这样的事情：

```
$("form").validate({
    errorElement: "p",
    errorClass: "form-error"
});

// This part is ugly because of your strange id
$("#x\\.child\\.1\\.0\\.t").rules("add", {
    required: true,
    minlength: 5
});​ 
```

演示：http: [//jsfiddle.net/eyKW9/3/](http://jsfiddle.net/eyKW9/3/)

反斜杠的原因是你必须转义`.`字符，否则 jQuery/Sizzle 认为它是一个类选择器。

一般来说，最好避免使用`id`这样的值，因为您会遇到 javascript 和 css 的问题。如果可能，坚持使用字母破折号和下划线。

# c# - 使用 async/await 进行堆栈跟踪

> ID：13884437
> 
> 赞同：60
> 
> 时间：2012-12-14T18:37:07.033
> 
> 标签：c#, logging, stack-trace, async-await, visual-studio-debugging

很清楚为什么堆栈跟踪会受到微软新的编程范式的影响。我们现在有一个语义堆栈和几个物理堆栈（我选择的单词）。

我看到的是异常的`StackTrace`属性（在调试器中）是物理属性，串联：

```
private async Task CheckFooAndBar()
{
    var log = LogManager.GetLogger("Test");
    log.Info("CheckFooAndBar");
    try
    {
        await Foo();
    }
    catch (Exception ex)
    {
        log.Info("StackTrace of last exception: " + ex.StackTrace);
    }
    Console.ReadKey();
}
private async Task Foo()
{
    await Task.Factory.StartNew(() => Thread.Sleep(1000));
    await Bar();
    await Task.Factory.StartNew(() => Thread.Sleep(1000));
}
private async Task Bar()
{
    await Task.Factory.StartNew(() => Thread.Sleep(1000));
    throw new Exception();
    await Task.Factory.StartNew(() => Thread.Sleep(1000));
} 
```

这给出了：

```
StackTrace of last exception:    at NLogAsyncExceptionTestCase.Program.<Bar>d__d.MoveNext() in c:\Users\Jens\Documents\Visual Studio 2012\Projects\NLogAsyncExceptionTestCase\NLogAsyncExceptionTestCase.Console\Program.cs:line 53
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.GetResult()
   at NLogAsyncExceptionTestCase.Program.<Foo>d__8.MoveNext() in c:\Users\Jens\Documents\Visual Studio 2012\Projects\NLogAsyncExceptionTestCase\NLogAsyncExceptionTestCase.Console\Program.cs:line 44
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter.GetResult()
   at NLogAsyncExceptionTestCase.Program.<CheckFooAndBar>d__0.MoveNext() in c:\Users\Jens\Documents\Visual Studio 2012\Projects\NLogAsyncExceptionTestCase\NLogAsyncExceptionTestCase.Console\Program.cs:line 30 
```

我的问题是：是否有一种（方便的、标准的）方法可以将其转换为语义上的适当回溯，例如：

```
CheckFooAndBar
Foo
Bar 
```

当然，堆栈中可能混合有等待和内联路径片段。

我尝试使用带有异步目标包的 .NET 4.5 和 SL5 查看堆栈，但尚未使用 WinRT。输出来自 .NET 4.5。

在我主要做的 SL5 中，情况更成问题：您不会在 Silverlight 中的堆栈跟踪中获得行号（即使具有提升的权限），这使得对上下文的需求变得更加重要。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-04T18:17:14.160

使用 Visual Studio 2013 和 .NET 4.5.1，这个问题似乎得到了解决——而且不仅在 .NET 中。

**进一步阅读**：[在 Visual Studio 2013 中调试异步代码 - 调用堆栈增强功能](https://devblogs.microsoft.com/devops/debugging-asynchronous-code-in-visual-studio-2013-call-stack-enhancements/)。

# python - 将音频输出从一个函数重定向到python中的另一个函数

> ID：13884439
> 
> 赞同：1
> 
> 时间：2012-12-14T18:37:09.450
> 
> 标签：python, audio

假设我有两个函数来自两个不同的 API，函数 A 和 B。

默认情况下，函数 A 将音频数据输出到 wav 文件。

默认情况下，函数 B 从 wav 文件中获取音频输入并进行处理。

是否可以将数据从函数 A 流式传输到 B？如果是这样，我该怎么做？如果相关的话，我在 lubuntu 上工作。

这是我从 PJSUA python API 考虑的函数 A：

**create_recorder(self, filename)** 创建 WAV 文件记录器。

关键字参数文件名 -- WAV 文件名

返回：WAV 录音机 ID

这是来自 Pocketsphinx Python API 的函数 B

**解码原始（...）**

从文件中解码原始音频。参数： fh (file) - 从中​​读取音频的文件句柄。uttid (str) - 赋予此话语的标识符。maxsamps (int) - 要读取的最大样本数。如果未指定或 -1，则将读取文件的其余部分。

更新：

当我尝试传递套接字或命名管道的文件名时，它会输出此错误消息，似乎 python 绑定使用的 C 函数除了 .wav 文件之外什么都不喜欢......为什么会这样？

pjsua_aud.c .pjsua_recorder_create() 错误：无法确定 /tmp/t_fifo 的文件格式。例外：对象：LIb，操作=创建（记录器），错误=不支持选项/操作（PJ_ENOTSUP）

我需要使用 create_recorder() 返回的值，它是一个 int，用于获取 wav 记录器 id（它不直接传递给 decode_raw()，而是传递给其他函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T18:44:37.310

答案高度依赖于平台，需要更多细节。不同的操作系统具有不同的处理进程间通信或 IPC 的方式。

如果您使用的是类 UNIX 环境，则可以使用一组丰富的 IPC 原语。管道、SYS V 消息队列、共享内存、套接字等。在您的情况下，我认为使用管道或套接字是有意义的，具体取决于 A 和 B 是否在同一进程中运行。

更新：

在您的情况下，我会使用 python 的`subprocess`and or`os`模块和管道。这里的想法是为共享父进程的进程中的两个 API 创建调用上下文，该父进程还创建了一个单向命名管道并将其传递给它的子进程。然后，写入命名管道的数据`create_recorder`将立即可用于命名管道中的 read()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:18:52.227

您可以使用命名管道[`os.mkfifo()`](http://docs.python.org/2/library/os.html#os.mkfifo)并将函数移动到不同的线程/进程，例如：

```
import os
from multiprocessing import Process

os.mkfifo(filename)
try:
    Process(target=obj.create_recorder, args=[filename]).start()
    decode_raw(filename, ...)
finally:
    os.remove(filename) 
```

# ruby - 如何使用 S3 和 sdk 将整个“文件夹”复制到另一个路径？

> ID：13884444
> 
> 赞同：9
> 
> 时间：2012-12-14T18:37:32.280
> 
> 标签：ruby, amazon-s3

当我为单个文件执行此操作时：

```
 aws_s3 = AWS::S3.new(S3_CONFIG)
    bucket = aws_s3.buckets[S3_CONFIG["bucket"]]

    object = bucket.objects["user/1/photos/image_1.jpg"]
    new_object = bucket.objects["users/1/photos/image_1.jpg"]
    object.copy_to new_object, {:acl => :public_read} 
```

但我想移动整个“/photos”文件夹 throws `No Such Key`。s3 键可能只是每个文件的完整路径。怎么做？

```
 aws_s3 = AWS::S3.new(S3_CONFIG)
    bucket = aws_s3.buckets[S3_CONFIG["bucket"]]

    object = bucket.objects["user/1/photos"]
    new_object = bucket.objects["users/1/photos"]
    object.copy_to new_object, {:acl => :public_read} 
```

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T20:03:02.520

做到了：

```
bucket.objects.with_prefix("user/1/photos").each do |object|
   ...
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-27T08:14:49.253

我需要额外的代码才能让它工作。基本上从源前缀中切掉基础，然后将其添加到目标前缀：

```
def copy_files_s3(bucket_name, source, destination)
  source_bucket = @s3.buckets[bucket_name]
  source_bucket.objects.with_prefix(source).each do |source_object|
    new_file_name = source_object.key.dup
    new_file_name.slice! source
    new_object = source_bucket.objects["#{destination}#{new_file_name}"]
    source_object.copy_to new_object, {acl: :public_read}
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-03-05T14:52:31.733

“文件夹”在 S3 中不是对象，这就是为什么您无法通过键获取它的原因，但文件夹路径实际上是文件夹包含的对象的所有键的前缀。

另一件重要的事情是，您必须对密钥进行 url 编码，否则您可能会遇到未知密钥错误。

```
require 'aws-sdk'
require 'aws-sdk-s3'
require 'securerandom'
require 'uri'
require "erb"
include ERB::Util

def copy_folder(folder, destination)
    bucket_name = 'your_bucket'
    credentials = Aws::Credentials.new('key', 'secret')
    s3_client = Aws::S3::Client.new(region:'the_region', credentials: credentials)
    enumerate_keys_with_prefix(source).each do |source_object|
       source_key = url_encode(source_object.key)
       destination_key = source_object.key.dup.sub(source, "")
       s3_client.copy_object({bucket: bucket_name, copy_source: bucket_name+'/'+source_key, key: destination+'/'+destination_key, acl: "public-read"})
    end
end

def enumerate_keys_with_prefix(prefix)
    bucket_name = 'your_bucket'
    credentials = Aws::Credentials.new('key', 'secret')
    s3 = Aws::S3::Resource.new(region:'the_region', credentials:credentials)
    return s3.bucket(bucket_name).objects(prefix: prefix)
end 
```

# web-applications - 如何在 WebMatrix 中使用 Razor 将数据注入对象？

> ID：13884447
> 
> 赞同：0
> 
> 时间：2012-12-14T18:37:55.497
> 
> 标签：web-applications, data-binding, razor, webmatrix

我最近一直在使用 WebMatrix，我一直在想是否可以将数据注入对象。

我曾经使用 Struts2，如果你熟悉它，如果你有一个输入，比如`<s:textfield name="model.property" .../>`插入到该文本字段中的值将被注入到模型对象中，或者模型对象中的值将被注入到文本字段中时页面已加载（这取决于处理到网页中的逻辑）。

到目前为止，在 WebMatrix 中，我已经看到了这种类型的数据注入`value="@Request.QueryString["searchGenre"]"`，您可以在其中访问 Razor 代码中的变量的值并将其分配给 html 控件，但是可以反向完成吗？我可以在 html 控件内的 Razor 代码中放置对对象的引用，并在提交页面时将值注入到对象中吗？

我知道我可以访问请求中的查询字符串值，但我想知道这种方法是否可行。

那么可以做到吗？还是我可以采取不同的方法？我想缩短我的编码时间，所以我愿意接受建议。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:14:39.717

是的，您可以为 HTML 表单控件提供任何您喜欢的默认值。约定是将值设置为相应的 Request.Form 或 QueryString 值，这样如果表单验证失败，用户提供的值将被持久化：

```
<input type="text" name="color" value="@Request["color"]" /> 
```

但是，您可以将其设置为默认值，并在表单发布时将其重置，以便您获取用户提供的任何内容：

```
@{
    var color = Request["color"].IsEmpty() ? "Red" : Request["color"];
}
<input type="text" name="color" value="@color" /> 
```

或者，如果您想[为表单使用 Html Helpers 以](http://www.mikesdotnetting.com/Article/184/HTML-Helpers-For-Forms-In-Razor-Web-Pages)获得更“敏捷”的感觉：

```
@{
    var color = Request["color"].IsEmpty() ? "Red" : Request["color"];
}
@Html.TextBox("color", color) 
```

# iphone - Xcode 单元测试

> ID：13884456
> 
> 赞同：16
> 
> 时间：2012-12-14T18:38:32.677
> 
> 标签：iphone, objective-c, ios, unit-testing

我从未使用过单元测试，我了解它的用途，但我真的不知道何时以及如何使用它。

我想知道什么时候值得使用单元测试，也许有一些例子。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2015-07-22T17:57:30.277

其他答案告诉*何时*但不是真的*如何*，所以让我也添加一个答案。

# 什么时候

每当您编写要保留的生产代码时，都应该对其进行单元测试。我在这方面看到的最有用的培训是以下两部分视频系列：

*   [了解测试驱动开发](https://www.youtube.com/watch?v=q5Xd1tmIgec)（第 1 部分）
*   [Roy Osherove 的单元测试最佳实践](https://www.youtube.com/watch?v=dJUVNFxrK_4)（第 2 部分）

前五分钟左右只是介绍，因此您可以跳到结尾。

# 如何

我将 Xcode 7 与 Swift 一起使用。

**启动一个新项目并添加一个单元测试。**

我打电话给我`MyProject`的。如果您在 Project Navigator 中打开 MyProjectTests 组，您将看到 Xcode 已经为您创建了一个名为 MyProjectTest.swift 的单元测试文件。

[![在此处输入图像描述](../Images/ffb22f56d943215f1e1fe76760da6443.png)](https://i.stack.imgur.com/9uhMX.png)

您现在可以删除所有示例方法并添加一个新`func`方法来测试您自己的类方法。请务必`@testable import MyProject`在顶部添加该行。如果您的项目名称中包含空格，则将空格替换为下划线。（例如，“我的示例项目”将使用`@testable import My_Example_Project`.）

我遵循`testMethodNameBeingTested_Senario_ExpectedBehavior`. 单元测试名称必须以“test”开头。

我会做这样的事情：

```
import XCTest
@testable import MyProject

class MyProjectTests: XCTestCase {

    func testSum_TwoNumbers_ReturnsSum() {
        // Arrange (set up the needed objects)
        let myClass = MyClass()

        // Act (run the method you want to test)
        let sum = myClass.sum(1, 2)

        // Assert (test that the behavior is as expected)
        XCTAssertEqual(sum, 3)

    }
} 
```

当然，构建失败是因为我们还没有添加`MyClass`类。

**添加你的班级。**

我正在将 Swift 文件添加到`MyProject`被调用的`MyClass`.

```
class MyClass {

    func sum(a: Int, _ b: Int) -> Int {
        return a + b
    }
} 
```

按测试单元类或方法旁边的测试按钮再次运行测试，它应该通过。

要看到它失败（单元测试的一个重要部分） ，您可以`return 0`在`sum`. `MyClass`然后你会在运行测试时看到以下内容：

[![在此处输入图像描述](../Images/e0aa63a551fd575b773bb8d32fff46d3.png)](https://i.stack.imgur.com/GF8JM.png)

您可以返回并修复此问题，然后添加更多单元测试。如果您愿意，您还可以为不同的类制作其他单元测试文件。只需右键单击 Project Navigator 中的 MyProjectTest 组并选择“New File”，然后选择 Test Case Class。

[![在此处输入图像描述](../Images/e3a457af4ea01a368605b8f541b65ff5.png)](https://i.stack.imgur.com/s3DmY.png)

# 有关的

[Xcode UI 测试示例](https://stackoverflow.com/questions/31600777/xcode-ui-test-example)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-14T19:51:16.557

您几乎应该总是进行单元测试，并且您应该在编写代码时考虑到单元测试。极端分子甚至在编写代码之前就编写测试（称为 TDD - 测试驱动开发）。

我会给你一个真实的例子：我最近不得不编写一个支持“间隔”的排序 NSArray。意思是，数组应该知道如何插入一个区间并保持排序。

例如，数组看起来像这样：[1-3, 5-9, 12-50]。在这个例子中，数组中有 3 个区间，如您所见，它们已排序。在我编写完我的类（我称之为 IntervalsArray）之后，我**必须**编写测试以确保它正常工作，并且如果我或其他人将来对代码进行更改，我不会“破坏”它。

以下是一些示例测试（伪代码）：

测试1：

```
- Create a new IntervalsArray
- Insert a new interval to the array
- (TEST) make sure the array has 1 object in it 
```

测试 2：

```
- Create a new IntervalsArray
- Insert 2 intervals into the array: [1-3] and [5-9]
- (TEST) make sure there are 2 items in the array
- (TEST) make sure interval [1-3] comes before interval [5-9] 
```

最后，我进行了大约 15 个测试来涵盖新阵列的各个方面。

这是一个[很好的 Xcode 单元测试教程](http://www.impigermobile.com/blog/introduction-to-xcode-unit-testing-in-ios/)。

您还可以编写逻辑测试（比单元测试更复杂）来测试您的 UI。阅读一些关于 UIAutomation 的内容，这是 Apple 测试 UI 的方式。它并不完美，但它非常好。[这是一个很好的教程](http://blog.manbolo.com/2012/04/08/ios-automated-tests-with-uiautomation)。

如果你认为自己是一个优秀的程序员，你应该为你的代码编写单元测试。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-17T01:39:50.197

每当您编写必须维护的代码时，都要编写单元测试。也就是说，如果你想重构任何东西——改变代码但保持行为。这几乎是所有生产代码。

“Hello, World”的反例是不要打扰你打算丢弃的代码。“尖峰解决方案”只是为了弄清楚您如何解决问题。一旦你弄清楚了，就把它扔掉，然后重新开始。只有这一次，您从测试开始。

将 TDD 称为“极端主义”听起来不合理且不切实际。事实上，一旦你学会了 TDD，它就可以节省时间/金钱。

有关 TDD 如何工作的示例，请参阅[使用 OCUnit](https://stackoverflow.com/questions/13711911/unit-testing-example-with-ocunit)的单元测试示例。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T19:58:33.443

任何时候你编写一个有类的应用程序，这不是你自己的。这是添加单元测试、测试这些类的好时机。

除了最基本的应用程序之外，所有应用程序都有自己的类，因此单元测试几乎总是一个好主意。

如果您正在创建其他程序员将使用的库，或者您将在多个项目中使用的库，那么这些库应该始终具有单元测试。

当事情发生变化时，单元测试可以为您节省大量时间，例如，新版本的操作系统问世，使用单元测试进行测试比只测试应用程序要好得多。

# c# - RequestStart() 方法后如何回滚 MongoDB 请求？

> ID：13884460
> 
> 赞同：0
> 
> 时间：2012-12-14T18:38:41.567
> 
> 标签：c#, mongodb, mongodb-.net-driver

使用**MongoDB C# 驱动程序**（正式形式 10gen），我正在执行以下代码：

```
using (database.RequestStart()) {    
    collection.Save(object);    
} 
```

我想知道如何停止请求并在`RequestStart()`方法之后回滚现有的执行操作。

提前谢谢各位！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:20:14.790

好吧，我在网上搜索，发现这些方法只是提高连接性能，但不存储任何操作。

*MongoDB*操作的概念是通过单个操作执行的。

该`RequestStart()`方法仅获取当前连接状态以重用它。如果没有打开现有连接，它会打开一个新连接并告诉驱动程序所有以下操作 - 直到`RequestDone()`调用该方法 - 将使用当前打开的连接。

另一方面，*MongoDB*有能力进行[***两阶段提交***](http://docs.mongodb.org/manual/tutorial/perform-two-phase-commits/#phase-commits-step-1)，在我们的“SQL 概念”中，这是一种**类似事务的模式**。在这种情况下，*MongoDB C# Driver*需要实现这种模式，或者我们可以自己开发命令适配器来实现。

# jquery - 使用 jQuery 将不同的 HTML 附加到表格的特定单元格中

> ID：13884463
> 
> 赞同：-1
> 
> 时间：2012-12-14T18:38:50.047
> 
> 标签：jquery, dynamic

我有一个表格，其中提示位于第一列，页面参考位于第二列。基于 XML 文件中“命中”的数量，我希望追加一个新列。每个单元格都有不同类型的输入，其 id 基于 XML 文件的循环。

![在此处输入图像描述](../Images/3a355a3cdb9444d8c083d9dfff1ae54e.png)

我计划将每个输入作为 HTML 片段读入，更改每个输入的 id，然后将更改后的片段加载到所需的单元格中。在我展示的示例中，XML 文件中有 2 个命中。

如何使用*特定*代码加载*特定*单元格？我见过“第一个”和“最后一个”，但它们都是通用的。

 ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:43:06.560

使用[`eq()`](http://api.jquery.com/eq/)允许您定位列表中特定元素的方法：

```
ThirdRowFourthCol = $("tr").eq(2).find("td").eq(3); 
```*

# visual-studio-2010 - 如何在 Visual Studio 2010 的整个解决方案中查找所有出现的特定 DLL

> ID：13884466
> 
> 赞同：1
> 
> 时间：2012-12-14T18:39:11.410
> 
> 标签：visual-studio-2010

我想知道是否有可能在大型项目解决方案的许多项目中找到所有引用的特定程序集。

Visual Studio 应本机支持该功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T10:40:54.440

解决方案是在解决方案资源管理器中单击需要程序集上的右键，然后选择“项目层次结构”选项，最后在出现的对话框窗口中单击刷新按钮...

VS 原生支持。我喜欢 ：） ！

# c - GETS - C 不适合我

> ID：13884467
> 
> 赞同：0
> 
> 时间：2012-12-14T18:39:21.630
> 
> 标签：c, function, printf, gets

我在将字符串插入 char 变量时遇到问题。当我将其投入使用时出现问题。当我调试我的程序时，它会显示`printf`但它会跳过`gets`

这是我的代码：

```
int uloz(SPRAVA *p){

    char string[200];

    printf("Your message here: ");
    gets(string);
    printf("You have entered: %s", string);
    getchar();

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:05:29.420

采用`scanf(" %30[^\n]%*c",string);`

1.  `[^\n]`将接受任何东西直到`\n`。

2.  `30`将字符数的长度限制为最大 30。

3.  initial`space(' ')`将消耗任何`\n`已经在标准输入流中的内容。（可选且我尚未验证）

4.  & 最后，输入字符串后`%*c`会消耗pressed。`\n`

我认为，`scanf(" %30[^\n]%*[^\n]%*c",string);`丢弃输入的剩余字符（30 个之后）是一个不错的选择。然而，这是完全未经证实的。只是作为一个可能的想法添加。使用前进行测试。:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:44:09.630

stdio 缓冲区中有一个换行符（由之前的一些保留`scanf`），因此`gets`立即感到满意。

没有简单的方法可以解决它，但您可以尝试在以下之前丢弃输入`fgets`：

```
while((c = getchar()) != '\n' && c != EOF)
    /* discard the character */; 
```

真正的解决方案是避免混合`scanf`和`fgets`。

* * *

使用`fgets`而不是`gets`.

# javascript - 这个 JavaScript 到底在做什么？

> ID：13884468
> 
> 赞同：0
> 
> 时间：2012-12-14T18:39:23.433
> 
> 标签：javascript, activex

### 历史

我的任务是构建一个新的 ActiveX 控件来替换旧的——但我没有旧的代码，所以我必须对它进行一些逆向工程——这不是什么大不了的事。但是，我得到了这段 JavaScript 代码片段，它调用了这个 ActiveX 控件的入口点。

### 问题

不过，我也不是很了解，所以希望大家可以帮忙。

*   和 到底发生了什么`&lt;`，`&gt;`它们在发送到 ActiveX 对象时是否被编码？
*   `%printContent`表演是什么？这只是他们的 JavaScript 函数之一吗？

### 代码

```
o.setDirectory("&lt;%printContent(util.Utility.getFormattedLocation(), false)%&gt;") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T15:49:05.530

代码片段中的代码实际上是对 Java 模块的调用，由 Java 虚拟机执行。这很像旧的 ASP 引擎，以及较新的 ASP.NET 和 MVC 引擎，但它***实际上在 JavaScript 内部工作！***

此 JavaScript 作为 Java 执行，当 JavaScript 发送到客户端时，返回值被静态放置在它的位置。

# wcf - 最简单的控制台托管 WCF 服务在浏览到它时会生成 404

> ID：13884474
> 
> 赞同：2
> 
> 时间：2012-12-14T18:39:39.017
> 
> 标签：wcf, http-status-code-404

我有一个非常简单的基于控制台的主机，用于简单的 WCF 服务。该服务的应用程序配置是：

```
<system.serviceModel>
    <services>
      <service name="MagicEightBallServiceLib.MagicEightBallService"
               behaviorConfiguration="EightBallServiceMEXBehavior">
        <endpoint address=""
                  binding = "basicHttpBinding"
                  contract = "MagicEightBallServiceLib.IEightBall" />
        <!-- Enable the MEX endpoint-->
      <endpoint address="mex"
                binding ="mexHttpBinding"
                contract ="IMetadataExchange" />
      <!--Need to add this so MEX knows the address of our service -->
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:8080/MagicEightBallService"/>
        </baseAddresses>
      </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="EightBallServiceMEXBehavior">
          <serviceMetadata httpGetEnabled="true"/>
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

主机程序显示其完美运行： **** 基于控制台的 WCF 主机*****

```
***** Host Info ******
Address: http://localhost:8080/MagicEightBallService
Binding: BasicHttpBinding
Contract: IEightBall

Address: http://localhost:8080/MagicEightBallService/mex
Binding: MetadataExchangeHttpBinding
Contract: IMetadataExchange

**************************************************
The service is ready 
```

当我尝试浏览或生成代理时，我得到：HTTP Error 404.0 - Not Found

我不知道出了什么问题。没有比这更简单的了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T12:10:06.977

我在阅读 Troelsen 的书时遇到了同样的问题，在网上找不到任何答案。无论如何，问题似乎出在 MagicEightBallLib 的项目类型中。Troelsen 建议您创建一个 Visual C# -> Windows -> 类库项目，但他没有解释您需要进行哪些修改才能使其正常工作。如果您改为使用 Visual C# -> WCF -> WCF 服务库项目，它将自动启动 WcfTestClient.exe，并在项目的首选项中添加名为“WCF 选项”的新选项卡。我试图比较这两种项目的 .csproj 文件之间的差异，但实在太多了。所以**解决方案是从 WCF 服务库项目类型**而不是类库开始，

如果有人知道 .csproj 文件的哪些特定部分负责启用此功能，我非常想听听。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-20T21:52:18.763

而不是使用 localhost:8080 使用 127.0.0.1:8080。这就是我如何让示例在我的 Windows 10 机器上工作。

# google-app-engine - 写 app.yaml 库指令一直出错

> ID：13884479
> 
> 赞同：1
> 
> 时间：2012-12-14T18:39:59.413
> 
> 标签：google-app-engine, python-2.7

我使用谷歌提供的 worldcount 程序。(https://developers.google.com/appengine/docs/python/dataprocessing/helloworld?hl=en) 编译没有错误。

但是将以下内容添加到`app.yaml`：

```
libraries:
- Name: numpy
  version: "1.6.1" 
```

我得到错误：

```
Traceback (most recent call last):
  File "C:\Program Files\Google\google_appengine\lib\webapp2\webapp2.py", line 1536, in __call__
    rv = self.handle_exception(request, response, e)
  File "C:\Program Files\Google\google_appengine\lib\webapp2\webapp2.py", line 1530, in __call__
    rv = self.router.dispatch(request, response)
  File "C:\Program Files\Google\google_appengine\lib\webapp2\webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "C:\Program Files\Google\google_appengine\lib\webapp2\webapp2.py", line 1101, in __call__
    handler = self.handler(request, response)

TypeError: __init__() takes at most 2 arguments (3 given) 
```

我不知道为什么？请帮帮我。谢谢

我的代码来自[https://developers.google.com/appengine/docs/python/dataprocessing/helloworld?hl=zh-tw#Downloading_the_Sample_Application](https://developers.google.com/appengine/docs/python/dataprocessing/helloworld?hl=zh-tw#Downloading_the_Sample_Application)

这是谷歌提供的代码。我只是将以下内容添加到`app.yaml`：

```
libraries:
- Name: numpy
  version: "1.6.1" 
```

这是我的 app.yaml

```
application: continue-tset
version: 20
runtime: python27
api_version: 1
threadsafe: no

handlers:

- url: /favicon.ico
  static_dir: static/images

- url: /mapreduce/pipeline/images
  static_dir: mapreduce/lib/pipeline/ui/images

- url: /static/js/custom.js
  static_files: static/js/custom.js
  upload: static/js/custom.js

- url: /mapreduce(/.*)?
  script: mapreduce/main.py

- url: .*
  script: main.py
  login: required

- url: /.*
  script: main.app

libraries:
- Name: numpy
  version: "1.6.1" 
```

帮帮我。谢谢。

# java - 常春藤在 URL 中为示例 Maven 工件生成错误的修订版

> ID：13884480
> 
> 赞同：0
> 
> 时间：2012-12-14T18:40:02.393
> 
> 标签：java, ivy

我在 Ivy 为 Maven 工件解决错误的 latest.integration 时遇到了一些麻烦。它正在读取 Maven 元数据（显然）并确定存在 0.0.3-SNAPSHOT 版本。奇怪的是，它然后尝试检索同时使用元数据中的 0.0.3-SNAPSHOT 版本和它只能使用该特定版本的元数据发现的 0.0.1-SNAPSHOT 版本的 POM，如下所示. 据我所知，Maven 元数据很好。

我已经整理了一个样本。一个简单的空 Maven 工件，以及解决它的 Ivy 构建。

我在 0.0.1-SNAPSHOT 部署了三个版本的 Maven 工件。每次我要求Ivy解决，都成功了。当我将版本更新为 0.0.2-SNAPSHOT 时，它开始混合 URL：

**ant resolve 的输出**

```
[ivy:resolve] == resolving dependencies for com.lashpoint.sandbox#maven-test;working@titan [default]
[ivy:resolve] == resolving dependencies com.lashpoint.sandbox#maven-test;working@titan->com.lashpoint.sandbox#test-api;l
atest.integration [default->*]
[ivy:resolve] don't use cache for com.lashpoint.sandbox#test-api;latest.integration: checkModified=true
[ivy:resolve]           tried http://maven.lashpoint.com/content/repositories/public-snapshots/com/lashpoint/sandbox/tes
t-api/[revision]/test-api-[revision].pom
[ivy:resolve]   listing revisions from maven-metadata: http://maven.lashpoint.com/content/repositories/public-snapshots/
com/lashpoint/sandbox/test-api/maven-metadata.xml
[ivy:resolve] CLIENT ERROR: Not Found url=http://maven.lashpoint.com/content/repositories/public-snapshots/com/lashpoint
/sandbox/test-api/0.0.2-SNAPSHOT/test-api-0.0.1-20121214.120300-3.pom
[ivy:resolve]   m2: found md file for com.lashpoint.sandbox#test-api;latest.integration
[ivy:resolve]           => http://maven.lashpoint.com/content/repositories/public-snapshots/com/lashpoint/sandbox/test-a
pi/0.0.1-SNAPSHOT/test-api-0.0.1-20121214.120300-3.pom (0.0.1-SNAPSHOT)
[ivy:resolve]   default-cache: revision in cache (not updated): com.lashpoint.sandbox#test-api;0.0.1-SNAPSHOT
[ivy:resolve]   found com.lashpoint.sandbox#test-api;0.0.1-SNAPSHOT in m2
[ivy:resolve]   [0.0.1-SNAPSHOT] com.lashpoint.sandbox#test-api;latest.integration 
```

**常春藤设置.xml**

```
<ivysettings>
    <settings defaultResolver="m2" />   
    <resolvers>
            <ibiblio name="m2" m2compatible="true" changingPattern=".*SNAPSHOT"
                checkmodified="true" root="http://maven.lashpoint.com/content/repositories/public-snapshots"  />
    </resolvers>
</ivysettings> 
```

**常春藤.xml**

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<ivy-module version="2.2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="http://ant.apache.org/ivy/schemas/ivy.xsd">
    <info organisation="com.lashpoint.sandbox" module="maven-test"
        status="integration">
    </info>

    <dependencies>
        <dependency name="test-api" org="com.lashpoint.sandbox"
            rev="latest.integration" />
    </dependencies>
</ivy-module> 
```

**构建.xml**

```
<project name="maven-test" xmlns:ivy="antlib:org.apache.ivy.ant">

    <property name="ivy.jar.dir" value="${user.home}/.ivy2/jars" />
    <property name="ivy.jar.file" value="${ivy.jar.dir}/ivy.jar" />

    <!-- ================================= 
                target: load-ivy  
             ================================= -->
    <target name="load-ivy">
        <mkdir dir="${ivy.jar.dir}" />
        <path id="ivy.lib.path">
                <fileset dir="${ivy.jar.dir}" includes="*.jar"/>
        </path>
        <taskdef resource="org/apache/ivy/ant/antlib.xml"
                            uri="antlib:org.apache.ivy.ant" classpathref="ivy.lib.path"/>
    </target>    

    <ivy:settings file="ivysettings.xml" />

    <target name="resolve">
        <mkdir dir="lib"/>

        <ivy:resolve file="ivy.xml" refresh="true" />
        <ivy:retrieve pattern="lib/[artifact].[ext]" />
    </target>

</project> 
```

**pom.xml**

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <groupId>com.lashpoint.sandbox</groupId>
    <artifactId>test-api</artifactId>
    <version>0.0.2-SNAPSHOT</version>

    <distributionManagement>
        <repository>
            <id>lashpoint-snapshots</id>
            <uniqueVersion>true</uniqueVersion>
            <name>Lashpoint Public Snapshots</name>
            <url>http://maven.lashpoint.com/content/repositories/public-snapshots</url>
        </repository>
    </distributionManagement>

    <build>
        <plugins>
            <plugin>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>2.3.2</version>
                <configuration>
                    <compilerId>javac</compilerId>
                    <source>1.6</source>
                    <target>1.6</target>
                </configuration>
            </plugin>
        </plugins>
    </build>

</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:50:44.423

我报告了一个错误，它已针对 2.3.0 进行了修复：[https ://issues.apache.org/jira/browse/IVY-1396](https://issues.apache.org/jira/browse/IVY-1396)

# android - 9Patch 的平铺替代品？

> ID：13884485
> 
> 赞同：4
> 
> 时间：2012-12-14T18:40:38.503
> 
> 标签：android, nine-patch

在 iOS 上进行了一年开发后，我是一名学习 Android 的设计师/开发人员。

iOS 中的 NinePatch/9patch 被称为 resizableImageWithCapInsets。它允许开发人员采用常规 PNG 并以编程方式指定 9patch 信息 - 即 Android .9.png 文件周围 1 像素边框中的信息。

但有一个关键区别。在 Android 上，9patch 中间的位是*scaled*，而在 iOS 上是*tiled*。对于某些类型的图像，这无关紧要。但是对于任何具有纹理或图案的缩放都会破坏图像。

以编程方式指定区域还允许设计人员使用[http://macrabbit.com/slicy](http://macrabbit.com/slicy)等工具，将复杂的主 Photoshop 文件拆分为单独的图像资产；据我所知，目前还没有适用于 Android 9 补丁的等效工具。（SDK 附带的 draw9patch 工具不起作用，因为每次从 Photoshop 主文件导出时都必须重复使用它。）

我猜一个人可以创建一个模仿 iOS 行为的 Drawable 子类：你将一个普通的旧 PNG 和一组 9patch 尺寸传递给它，它会适当地绘制自己，平铺中间部分。你甚至可以提供一个在平铺和拉伸之间切换的开关（我希望 iOS 能做到）。

作为一个新手，我需要一些时间来弄清楚如何做到这一点。类似的东西是否已经作为开源组件或样本存在？

谢谢！

# javascript - extjs4 在控制器中获取视图实例？

> ID：13884493
> 
> 赞同：1
> 
> 时间：2012-12-14T18:41:19.383
> 
> 标签：javascript, model-view-controller, extjs, extjs4, extjs4.1

我正在尝试在控制器中获取我的视图实例。我怎样才能做到这一点。我尝试这样做的主要原因是我的视图中有一个网格，我想禁用它，直到从组合框中进行选择，所以我需要访问视图的实例。

帮助？

我的控制器：

```
Ext.define('STK.controller.SiteSelectController', {
    extend: 'Ext.app.Controller',

    stores: ['Inventory', 'Stacker', 'Stackers'],
    models: ['Inventory', 'Stackers'],
    views: ['scheduler.Scheduler'],

    refs: [{
        ref: 'stackerselect',
        selector: 'panel'
    }],

    init: function () {
        this.control({
            'viewport > panel': {
                render: this.onPanelRendered
            }
        });
    },
    /* render all default functionality */
    onPanelRendered: function () {
        var view = this.getView('Scheduler'); // this is null?
    }
}); 
```

我的观点：

```
Ext.Loader.setConfig({
    enabled: true
});
Ext.Loader.setPath('Ext.ux', '/extjs/examples/ux');
Ext.require([
    'Ext.ux.grid.FiltersFeature',
    'Ext.ux.LiveSearchGridPanel']);

var filters = {
    ftype: 'filters',
    autoReload: false,
    encode: false,
    local: true
};

Ext.define('invtGrid', {
    extend: 'Ext.ux.LiveSearchGridPanel',
    alias: 'widget.inventorylist',
    title: 'Inventory List',
    store: 'Inventory',
    multiSelect: true,
    padding: 20,
    viewConfig: {
        plugins: {
            ptype: 'gridviewdragdrop',
            dragGroup: 'invtGridDDGroup',
            dropGroup: 'stackerGridDDGroup'
        },
        listeners: {
            drop: function (node, data, dropRec, dropPosition) {
                var dropOn = dropRec ? ' ' + dropPosition + ' ' + dropRec.get('ordNum') : ' on empty view';
            }
        }
    },
    features: [filters],
    stripeRows: true,
    columns: [{
        header: 'OrdNum',
        sortable: true,
        dataIndex: 'ordNum',
        flex: 1,
        filterable: true
    }, {
        header: 'Item',
        sortable: true,
        dataIndex: 'item',
        flex: 1,
        filterable: true
    }, {
        header: 'Pcs',
        sortable: true,
        dataIndex: 'pcs',
        flex: 1,
        filterable: true
    }]
});

Ext.define('stackerGrid', {
    extend: 'Ext.grid.Panel',
    alias: 'widget.stackerselect',
    title: 'Stacker  Select',
    store: 'Stacker',
    padding: 20,
    viewConfig: {
        plugins: {
            ptype: 'gridviewdragdrop',
            dragGroup: 'stackerGridDDGroup',
            dropGroup: 'invtGridDDGroup'
        },
        listeners: {
            drop: function (node, data, dropRec, dropPosition) {
                var dropOn = dropRec ? ' ' + dropPosition + ' ' + dropRec.get('ordNum') : ' on empty view';
            }
        }

    },
    columns: [{
        header: 'OrdNum',
        dataIndex: 'ordNum',
        flex: 1
    }, {
        header: 'Item',
        dataIndex: 'item',
        flex: 1
    }, {
        header: 'Pcs',
        dataIndex: 'pcs',
        flex: 1
    }],
    dockedItems: [{
        xtype: 'toolbar',
        dock: 'bottom',
        items: [{
            text: 'Submit',
            action: 'submit'
        }, {
            text: 'Reset',
            action: 'reset'
        }]
    }, {
        xtype: 'toolbar',
        dock: 'top',
        items: [{
            id: 'combo',
            xtype: 'combobox',
            queryMode: 'local',
            fieldLabel: 'Stacker',
            displayField: 'stk',
            valueField: 'stk',
            editable: false,
            store: 'Stackers',
            region: 'center',
            type: 'absolute'
        }]
    }]
});

Ext.define('STK.view.scheduler.Scheduler', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.schedulerview',
    title: "Scheduler Panel",
    layout: {
        type: 'column'
    },

    items: [{
        xtype: 'inventorylist',
        width: 650,
        height: 600,
        columnWidth: 0.5,
        align: 'stretch'
    }, {
        xtype: 'stackerselect',
        width: 650,
        height: 600,
        columnWidth: 0.5
    }]
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T20:35:46.300

正如我所说，Extjs 为您的视图（控制器视图数组中列出的视图）创建 getter，并且您可以访问它们：

```
var view = this.getSchedulerSchedulerView(); 
```

获得视图参考后，您可以执行此操作以访问包含的网格：

```
var grid = view.down('.inventorylist');
grid.disable(); 
```

# c++ - 如何使构造函数采用非常量对象？

> ID：13884494
> 
> 赞同：2
> 
> 时间：2012-12-14T18:41:31.777
> 
> 标签：c++, constructor, type-conversion

当谈到 C++ 中的 const 类型时，我总是迷失方向，而我的问题本质上与这些有关。

我有以下情况：我有一个类 Matrix 本质上是一个二维链表（带有标记的环）和一个类似迭代器的类，它可以选择一行（选择一行的方法）然后通过它（运算符++）。为了获得它，迭代器存储了 3 个指针：主标记、选定子列表（行）的标记和当前选定的节点（我们将其命名为插入符号）。如果 operator++ 命中子列表哨兵 - 则到达行的末尾，如果行选择命中主哨兵，那么我们已经到达矩阵的末尾。

现在，由于列表是单链接的，并且我希望迭代器提供删除功能，因此我决定将`Node**`当前节点字段的类型存储在迭代器中。但这会给构造函数带来一些问题。

我决定只允许两种类型的构造函数——一种采用 Matrix，另一种采用其他迭代器。这是我的问题。从矩阵创建的迭代器的初始状态具有其所有指针在同一点 - 主哨兵。现在，从 g++ 告诉我的内容看来，我的构造函数`Matrix`必须采用 type `const Matrix&`。但如果是这样，我不能为我的插入符号（作为`Node**`）分配指向 Matrix 自己的指针的指针，因为它是 const 而插入符号不能是 const。

我怎么可能解决这个问题？为什么构造函数不能采用非常量实体？我可以在构造函数中将我的矩阵从常量转换为非常量吗？提前感谢您对此的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:48:02.847

您必须将 Matrix 和迭代器分开，以便仅迭代不会以任何方式更改 Matrix，并且迭代所需的任何数据都存储在迭代器类中。

此外，如果您需要迭代器对 const Matrix 对象进行操作，您还需要提供一个 const 迭代器，然后它可以具有指向 Matrix 的 const 引用/指针。但是在复制构造函数中你不一定需要这个，你可以直接访问字段，毕竟它是同一个类。

要让迭代器类访问 Matrix 的内部，您可以使用friend关键字，或者（最好）您可以使迭代器类成为 Matrix 的内部类。

# python - 什么是 Python Whitespace，它是如何工作的？

> ID：13884499
> 
> 赞同：19
> 
> 时间：2012-12-14T18:42:07.030
> 
> 标签：python, whitespace

我一直在搜索谷歌和这个网站一段时间，但我似乎无法找到关于这个主题的直接答案。

**Python中的空格是什么？**我知道这与每行缩进有关，但我不确定如何使用它。它是如何工作的？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-14T18:48:56.833

空格用于表示块。在其他语言中，大括号 (`{`和`}`) 很常见。当您缩进时，它成为上一行的子代。除了缩进之外，父级后面还有一个冒号。

```
im_a_parent:
    im_a_child:
        im_a_grandchild
    im_another_child:
        im_another_grand_child 
```

在我的头顶上，`def`, `if`, `elif`, `else`, `try`, `except`, `finally`, `with`, `for`, `while`, 和`class`所有起始块。要结束一个块，你只需简单的 outdent，你就会有兄弟姐妹。在上面`im_a_child`和`im_another_child`是兄弟姐妹。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-14T18:49:42.170

空白仅表示用于间距的字符，并具有“空”表示。在 python 的上下文中，它表示制表符和空格（它可能还包括奇异的 unicode 空格，但不要使用它们）。最终参考在这里：[http ://docs.python.org/2/reference/lexical_analysis.html#indentation](http://docs.python.org/2/reference/lexical_analysis.html#indentation)

> 我不确定如何使用它。

将它放在要缩进的行的前面。如果您混合使用空格和制表符，您可能会看到奇怪的结果，因此请坚持使用其中一种。（python社区通常遵循PEP8风格，规定缩进四个空格）。

您需要在每个冒号后创建一个新的缩进级别：

```
for x in range(0, 50):
    print x
    print 2*x

print x 
```

在这段代码中，前两个`print`语句在语句的“内部”，`for`因为它们的缩进比包含`for`. 第三个`print`在外面，因为它的缩进小于前一个（非空白）行。

如果你没有一致地缩进/取消缩进，你会得到缩进错误。此外，所有复合语句（即带有冒号的语句）都可以在同一行提供正文，因此不需要缩进，但正文必须由单个语句组成。

最后，某些语句，例如`lambda`以冒号为特征，但不能以多行块作为主体。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-27T05:40:13.033

它充当大括号。我们必须在整个程序中保持空格的数量一致。

示例 1：

```
def main():
     print "we are in main function"
     print "print 2nd line"

main() 
```

结果：

> 我们在主要功能
> 打印第二行

示例 2：

```
def main():
    print "we are in main function"
print "print 2nd line"

main() 
```

结果：

> 打印第 2 行
> 我们在 main 函数中

在这里，在第一个程序中，两个语句都在 main 函数下，因为它们都有相同数量的空格，而在第二个程序中，第一行稍后打印，因为 main 函数在第二行之后调用 注意 - 第二行没有空格，所以它独立于主函数。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-02T16:06:44.317

```
something
{
 something1
 something2
}
something3 
```

在 Python 中

```
Something
    something1
    something2
something3 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-05T08:24:31.937

每种编程语言都有自己的代码结构方式。
每当你编写一段代码时，它必须以一种所有人都能理解的方式组织起来。

通常用于条件和类并定义定义。
它代表父母、孩子和孙子，甚至更远。

例子：

```
def example()
    print "name"
    print "my name"
example() 
```

在这里你可以说`example()`是父母，其他人是孩子。

# java - 使用模拟对象进行 junit 测试：存根内部函数调用

> ID：13884502
> 
> 赞同：0
> 
> 时间：2012-12-14T18:42:10.867
> 
> 标签：java, unit-testing, junit, mockito

所以我试图测试`ping()`方法并确保它调用`connect()`和`disconnect()`. 我嘲笑了 object`foo`和 object `Connection`。然后我确实`stub(mockFoo.connect()).toReturn(mockConn)`希望 then`ping()`应该返回 true 让我断言。但是，不知何故，这种存根并没有通过。我怀疑可能在内部调用 connect 时， mockFoo 实际上并没有调用`connect()`，因此没有返回模拟 Connection，但我不确定。

```
public class foo{
    public boolean ping(){
        bool ping = false; 
        Connection conn = null;
        try{
           conn = connect();
           ping = true;
        }catch(Exception e){
        }finally{
           disconnect(conn);
        }
        return ping;
    }

    public Connection connect(){
        //some implementation
        return connect
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:45:27.110

通常你不会模拟被测单元本身。Mockito 将对所有方法使用默认的存根行为。所以调用 to`ping()`只会返回默认值`false`，不会`foo`调用其他方法。

您可以通过在 foo 上进行间谍活动来进行部分模拟，然后像您一样对 connect 方法进行存根。虽然我不会推荐这个。理想情况下，您将注入对协作者（在本例中为连接）的依赖项。建立连接和使用连接是不同的职责，实际上属于不同的类。

所以更像这样：

```
public class Foo {

    private final ConnectionProvider connectionProvider;

    private Foo(ConnectionProvider connectionProvider) {
        this.connectionProvider = connectionProvider;
    }

    public boolean ping(){
            boolean ping = false;
            Connection connection = null;
            try{
                connection = connectionProvider.getConnection();
                ping = true;
            }catch(Exception e){
                // TODO handle this exception
            }finally{
                try {
                    connection.close();
                } catch (SQLException e) {
                    // TODO handle this exception
                }
            }
            return ping;
        }

}

public interface ConnectionProvider {

    Connection getConnection();
}

@org.junit.Test
public void testConnection() throws Exception {
    ConnectionProvider mockProvider = mock(ConnectionProvider.class);
    Connection mockConnection = mock(Connection.class);
    when(mockProvider.getConnection()).thenReturn(mockConnection);

    Foo foo = new Foo(mockProvider);

    assertTrue(foo.ping());

    verify(mockConnection).close();
} 
```

# c# - 当位图为一定大小时，Bitmap.LockBits 错误“参数无效”？

> ID：13884503
> 
> 赞同：6
> 
> 时间：2012-12-14T18:42:11.790
> 
> 标签：c#, .net, system.drawing

我已经创建了一种方法，我想在其中获取图像蒙版并将其应用于另一个图像。如果你看一下这篇[文章](https://stackoverflow.com/questions/13349507/overlay-image-with-png-as-mask-using-net-and-javascript)，你会看到一个框架图像。该帖子中的框架图像是 ，`maskingImage`背景图像是`imageToMask`。掩蔽图像实际上是具有粉红色中心的图像。这是该方法所经历的过程：

1.  屏蔽图像是 PNG，要屏蔽的图像是 JPG。
2.  该方法跟踪掩蔽图像并在其上绘制要掩蔽的图像。这有助于保持外部透明度完好无损。
3.  然后在遮罩图像下方绘制的输出表单，我们使粉红色透明。

该行`var bitsimageToMask = imageToMask.LockBits...`是我得到错误的地方。如果要屏蔽的图像的宽度或高度小于屏蔽图像，则会出现“参数无效”错误。在使用位图时，我是新手。

```
public Bitmap RenderMaskedImage(Bitmap maksingImage, Bitmap imageToMask, Point imageToMaskOffset, ImageFormat imageFormat)
{
    using (var newImageToMaskGraphic = Graphics.FromImage(imageToMask))
    {
    newImageToMaskGraphic.DrawImage(imageToMask, imageToMaskOffset);
    }

    var output = new Bitmap(maksingImage.Width, maksingImage.Height, PixelFormat.Format32bppArgb);
    var rect = new Rectangle(0, 0, maksingImage.Width, maksingImage.Height);
    var bitsMask = maksingImage.LockBits(rect, ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);
    var bitsimageToMask = imageToMask.LockBits(rect, ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb);
    var bitsOutput = output.LockBits(rect, ImageLockMode.WriteOnly, PixelFormat.Format32bppArgb);

    unsafe
    {
        for (int y = 0; y < maksingImage.Height; y++)
        {
            var ptrMask = (byte*)bitsMask.Scan0 + y * bitsMask.Stride;
            var ptrimageToMask = (byte*)bitsimageToMask.Scan0 + y * bitsimageToMask.Stride;
            var ptrOutput = (byte*)bitsOutput.Scan0 + y * bitsOutput.Stride;
            for (int x = 0; x < maksingImage.Width; x++)
            {
                ptrOutput[4 * x] = ptrimageToMask[4 * x];           // blue
                ptrOutput[4 * x + 1] = ptrimageToMask[4 * x + 1];   // green
                ptrOutput[4 * x + 2] = ptrimageToMask[4 * x + 2];   // red
                ptrOutput[4 * x + 3] = ptrMask[4 * x + 3];        // alpha 
            }
        }
    }

    maksingImage.UnlockBits(bitsMask);
    imageToMask.UnlockBits(bitsimageToMask);
    output.UnlockBits(bitsOutput);

    using (var outputGraphic = Graphics.FromImage(output))
    {
        outputGraphic.DrawImage(maksingImage.ToTransparentColor(255,0,192), 0, 0);
    }

    return output;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T19:00:21.123

原因是您在 imageToMask 上使用的矩形比位图本身大。

```
var rect = new Rectangle(0, 0, maksingImage.Width, maksingImage.Height);
var bitsimageToMask = imageToMask.LockBits(rect, ImageLockMode.ReadOnly, PixelFormat.Format32bppArgb); 
```

rect用于指定需要锁定的位图区域。此矩形可以与位图大小相同或小于位图，但不能更大。在您的情况下，因为您使用基于 maskingImage 的矩形，所以矩形变得比您使用它的位图大，这会给您带来该错误。

# windows - 一台计算机上的多个主机

> ID：13884504
> 
> 赞同：0
> 
> 时间：2012-12-14T18:42:15.103
> 
> 标签：windows, apache, xampp, host

我是一名开发人员，我通常在我的 PC 上一次开发多个 Web 应用程序。我有 Vista 和 XAMPP。如何在我的 PC 上同时拥有多个“本地主机”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:42:15.103

Apache 支持基于名称的虚拟主机来托管多个站点。您需要在每个站点的两个文件中创建条目。例如，使用 XAMPP 1.8.1 和 Vista，如果您想使用常规 localhost 进行开发，并单独使用 Zend 2 框架：

在 C:\xampp\apache\conf\extra\httpd-vhosts.conf

```
##<VirtualHost *:80>
    ##ServerAdmin postmaster@dummy-host.localhost
    ##DocumentRoot "C:/xampp/htdocs/dummy-host.localhost"
    ##ServerName dummy-host.localhost
    ##ServerAlias www.dummy-host.localhost
    ##ErrorLog "logs/dummy-host.localhost-error.log"
    ##CustomLog "logs/dummy-host.localhost-access.log" combined
##</VirtualHost>

##add these two entries

<VirtualHost *:80>
    DocumentRoot "[path to]/xampp/htdocs/"
    ServerName localhost
    ServerAlias localhost
    ErrorLog "logs/localhost-error.log"
    CustomLog "logs/localhost-access.log" combined
</VirtualHost>

<VirtualHost *:80>
    ServerName zf2-tutorial.localhost
    DocumentRoot [path to]\xampp\htdocs\zf2-tutorial\public
    SetEnv APPLICATION_ENV "development"
    <Directory [path to]\xampp\htdocs\zf2-tutorial\public>
        DirectoryIndex index.php
        AllowOverride All
        Order allow,deny
        Allow from all
    </Directory>
</VirtualHost> 
```

在 C:\Windows\System32\drivers\etc\hosts

```
# For example:
#      102.54.94.97     rhino.acme.com          # source server
#      38.25.63.10      x.acme.com              # x client host
#add two entries where name matches ServerName in httpd-vhosts.conf
127.0.0.1       localhost
127.0.0.1       zf2-tutorial.localhost 
```

您可能需要在管理员模式下使用文本编辑器打开主机文件以保存更改。

并在您进行更改后关闭并重新启动 Apache 以使其生效。

# html - 跨浏览器在 HTML 选择元素中垂直对齐文本

> ID：13884507
> 
> 赞同：1
> 
> 时间：2012-12-14T18:42:26.217
> 
> 标签：html, css

我有一个带有以下 CSS 的 HTML 选择元素：

```
.MySelect{
    padding: 0px 0px 0px 4px;
    background: white;
    width:180px;
    border: 2px solid red;
    box-shadow: 2px 2px 10px lightgray;
    border-radius: 5px;
    height: 26px;
    line-height: 26px;
    font-family: "Trebuchet MS";
    font-size: 13px;
    margin:20px 20px;} 
```

问题是文本在 Firefox 中没有垂直对齐，即使它在 Chrome 中也是如此。**请参阅此处的[jsfiddle](http://jsfiddle.net/rkpLB/7/)进行演示。**

如何使文本在所有浏览器中垂直对齐？

*编辑：我在问这个问题之前尝试修改填充，但这不起作用。*

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:47:21.807

添加的填充有助于 FFox 和 chrome 似乎并不介意。

```
.MySelect{
        padding: 2px 0px 2px 4px;
        background: white;
        width:180px;
        border: 2px solid red;
        box-shadow: 2px 2px 10px lightgray;
        border-radius: 5px;
        font-family: "Trebuchet MS";
        font-size: 13px;
        margin:20px 20px;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T21:34:36.277

如果您想要完全控制，我建议您输入“-webkit-appearance:none;”

这是重新创建外观的 CSS：

```
.MySelect {
width: 180px;
height: 26px;
padding:0px 0px 0px 4px;
border: 2px solid red;
box-shadow: 2px 2px 10px lightgray;
border-radius: 5px;
font-family: "Trebuchet MS";
font-size: 13px;
-webkit-appearance: none;
background: #E7E7E7;
background: url("http://www.412webdesigns.com/upload/arrows.png") no-repeat right, -moz-linear-gradient(top, #E7E7E7 0%, #FEFEFE 100%);
background: url("http://www.412webdesigns.com/upload/arrows.png") no-repeat right, -webkit-gradient(linear, left top, left bottom, color-stop(0%,#E7E7E7), color-stop(100%,#FEFEFE));
background: url("http://www.412webdesigns.com/upload/arrows.png") no-repeat right, -webkit-linear-gradient(top, #E7E7E7 0%,#FEFEFE 100%);
background: url("http://www.412webdesigns.com/upload/arrows.png") no-repeat right, -o-linear-gradient(top, #E7E7E7 0%,#FEFEFE 100%);
background: url("http://www.412webdesigns.com/upload/arrows.png") no-repeat right, -ms-linear-gradient(top, #E7E7E7 0%,#FEFEFE 100%);
background: url("http://www.412webdesigns.com/upload/arrows.png") no-repeat right, linear-gradient(to bottom, #E7E7E7 0%,#FEFEFE 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e7e7e7', endColorstr='#fefefe',GradientType=0 );
} 
```

然后，如果那个像素在 FireFox 中打扰了您，请使用以下内容：

```
@-moz-document url-prefix() {
.MySelect {
    padding:1px 0px 0px 4px;
}
} 
```

使用 webkit 外观，您可以在任何浏览器中使其看起来像您想要的任何东西。

编辑：确保您从我的网站下载 arrows.png，然后在本地使用它，我只会在那里使用一段时间。

# magento - 自定义 Magento 扩展。如何添加启用或禁用它的选项？

> ID：13884508
> 
> 赞同：0
> 
> 时间：2012-12-14T18:42:28.680
> 
> 标签：magento, module

感谢这里的每一个人，我终于完成了我的第一个扩展！我也设法将扩展添加为管理区域中的选项卡。我有一个显示启用或禁用的菜单。我想让这个功能发挥作用，让客户通过这个扩展获得更多的控制权。在提及之前，我知道您可以在高级菜单下启用和禁用扩展。但是，大多数 Magento 客户不是。我想将此直接添加到我的扩展程序中。

如果启用了该模块，我想用我自己的自定义运输模板覆盖位于 checkout/cart/shipping.phtml 中的 shipping.phtml 文件。

1.  如何使我的启用或禁用下拉框工作？下面是我的代码：

等/system.xml

```
<?xml version="1.0"?>
<config>
<tabs>
    <beckinconfig translate="label" module="dropdownshipping">
        <label>Beckin Extensions</label>
        <sort_order>100</sort_order>
    </beckinconfig>
</tabs> 
<sections>  
    <dropdownshipping translate="label" module="dropdownshipping">
        <label>Drop Down Shipping Options</label>
        <tab>beckinconfig</tab>
        <frontend_type>text</frontend_type>
        <sort_order>1000</sort_order>
        <show_in_default>1</show_in_default>
        <show_in_website>1</show_in_website>
        <show_in_store>1</show_in_store>

        <groups>            
                  <general>
            <label>General</label>
            <frontend_type>text</frontend_type>
            <sort_order>1</sort_order>
            <show_in_default>1</show_in_default>
            <show_in_website>1</show_in_website>
            <show_in_store>1</show_in_store>       
              <fields>
                            <enable translate="label">
                            <label>Enable</label>
                            <comment>
                            <![CDATA[Enable or Disable this extension.]]>
                            </comment>
                            <frontend_type>select</frontend_type>
                                 <source_model>adminhtml/system_config_source_yesno</source_model>
                            <sort_order>1</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>                    
                            </enable>           
             </fields>                 
        </general>
        </groups>
    </dropdownshipping>
</sections>     
</config> 
```

等/config.xml

```
<?xml version="1.0"?>
<config>    
<modules>
<Beckin_DropDownShipping><version>1.0.0</version></Beckin_DropDownShipping>
    </modules>

<global>

            <blocks>
                 <beckin_dropdownshipping>
                      <class>Beckin_DropDownShipping_Block</class>
                 </beckin_dropdownshipping>
            </blocks>

    <helpers>
         <beckin_dropdownshipping>
         <class>Beckin_DropDownShipping_Helper</class>
         </beckin_dropdownshipping>
    </helpers>      
</global>

<frontend>
    <layout>
        <updates>
            <beckin>
                <file><!-- beckin_dropdownshipping.xml --></file>
            </beckin>
        </updates>
    </layout>
    <routers>
        <dropdownshipping>
            <use>standard</use>
            <args>
                <module>Beckin_DropDownShipping</module>
                <frontName>dropdownshipping</frontName>
            </args>
        </dropdownshipping>
    </routers>  
</frontend>

<adminhtml>
    <acl>
        <resources>
            <admin>
                <children>
                    <system>
                        <children>
                            <config>
                                <children>
                                    <dropdownshipping_options>
                                        <title>Beckin Drop Down Shipping Extension</title>
                                    </dropdownshipping_options>
                                </children>
                            </config>
                        </children>
                    </system>
                </children>
            </admin>
        </resources>
    </acl>
</adminhtml>

</config> 
```

助手/Data.php

```
<?php
class Beckin_DropDownShipping_Helper_Data extends Mage_Core_Helper_Abstract
{   

} 
```

块/购物车/Shipping.php

```
<?php

class Beckin_DropDownShipping_Block_Cart_Shipping extends Mage_Checkout_Block_Cart_Shipping
{

protected function _construct()
{

      if(Mage::getStoreConfig('beckin/dropdownshipping_options/enable', Mage::app()->getStore()->getId()){
     {
     $this->setTemplate('Beckin/dropdownshipping/drop_down_shipping.phtml');
     }
        else
        {
        $this->setTemplate('checkout/cart/shipping.phtml');
        }
}
} 
```

感谢您提供的任何帮助！！当我转到我的扩展所在的系统/配置部分时，我现在得到一个空白的管理页面。我敢肯定，我缺少一些简单的东西。除了我认为不相关的模板文件之外，我已经包含了上面我正在使用的每个文件。你能发现我的错误吗？我希望它会显示一个错误而不是页面空白:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:48:50.563

不知道你的模块做了什么，在哪里以及如何加载它。假设它不是自定义运输扩展。你可以做

例如。1

```
if((Mage::getStoreConfig('deckin/dropdownshipping_options/beckin_enable', Mage::app()->getStore()->getId()){
   module enable/display .phtml
   assuming that beckin_enable value are 0 or 1
} 
```

我不是 100% 确定您所说的“...模板 xml 文件以设置模板以覆盖 shipping.phtml 文件...”是什么意思`您可能需要找到并重写设置模板文件的块构造运费

例如。2

```
protected function _construct()
{
    if(Mage::getStoreConfig('deckin/dropdownshipping_options/beckin_enable', Mage::app()->getStore()->getId()){
        $this->setTemplate('.../my_custom_shipping.phtml');
     }
     else{
        $this->setTemplate('.../regular_shipping.phtml');
     }
} 
```

此外，您不需要为是/否创建自己的“源模型”，magento 已预先构建

```
<beckin_enable>
    ....
    <source_model>dropdownshipping/enable</source_model>                           
    ...                    
</beckin_enable> 
```

你本来可以做的

```
<beckin_enable>
    ....
    <source_model>adminhtml/system_config_source_yesno</source_model>                          
    ...                    
</beckin_enable> 
```

# php - 无法使用 PHP 在 html 中显示 png 图像

> ID：13884509
> 
> 赞同：0
> 
> 时间：2012-12-14T18:42:29.213
> 
> 标签：php, image, gd

尽管无数次尝试让这个工作我很难过。我已经在许多其他帖子中解释过，我对 PHP 非常陌生，不熟悉强大的功能，并且知道我几乎可以使用它，但似乎无法实现。我已经有一个非常乐于助人的人尝试为我简化它 [链接] [https://stackoverflow.com/a/13872071/1880796](https://stackoverflow.com/a/13872071/1880796)但现在我只需要有人纠正我的代码中的错误即可工作。我认为 url 的末尾有问题，因为当我尝试查看图像并查看 url 时，一切都搞砸了，所以我不知道我做错了什么。我已经两次和三次检查了所有的数学，因为它是如此令人困惑，但这里是 result.php：

```
<?php
    $filename = "Results.txt";
    $lines = file($filename);

    $q1 = $_POST['q1']; // stores checked button value
    $q2 = $_POST['q2'];
    $q3 = $_POST['q3'];
    $q4 = $_POST['q4'];
    $q5 = $_POST['q5'];
    $q6 = $_POST['q6'];
    $q7 = $_POST['q7'];
    $q8 = $_POST['q8'];

    $qN = 1;  //question number

    $newLines = '';

    $total = array();

        foreach($lines as $line) {

            $line = trim($line);  //remove excess newlines etc.
            $lineArr = explode(',',$line);  //split line into array by commas
            $index = ${'q'.$qN}-1; //zero based
        if (isset($lineArr[$index])){
            $lineArr[$index]++;  //add to position by one vote.
            $total = array_sum($lineArr); //number of clicks 

            $newLines .= implode(',',$lineArr) . "\r\n"; //newLines contains numbers then also
        $qN++;
        }
    }
//write contents back to file.
file_put_contents($filename, $newLines);

//frequencies for each line without strings
$l[1] = explode(',',$lines[0]);
$l[2] = explode(',',$lines[1]);
$l[3] = explode(',',$lines[2]);
$l[4] = explode(',',$lines[3]);
$l[5] = explode(',',$lines[4]);
$l[6] = explode(',',$lines[5]);
$l[7] = explode(',',$lines[6]);
$l[8] = explode(',',$lines[7]);

//multiply each 
$result = array();
$values = array(1,2,3,4,5);
for($i=0;$i<count($l);$i++){
    for($j=0;$j<count($values);$j++){
    $result[$i+1][$j] = $l[$i+1][$j] * $values[$j];
    }
}
//calculate percentages

$p1 = (explode(',',$lines[0]));
$p2 = (explode(',',$lines[1]));
$p3 = (explode(',',$lines[2]));
$p4 = (explode(',',$lines[3]));
$p5 = (explode(',',$lines[4]));
$p6 = (explode(',',$lines[5]));
$p7 = (explode(',',$lines[6]));
$p8 = (explode(',',$lines[7]));

// calculate averages *****For some reason most recent frequency item updated is off by one, possibly bc not up to date yet???? figure out later!!!
$f1avg = round((array_sum($result[1])/($total-1)),2);
$f2avg = round((array_sum($result[2])/($total-1)),2);
$f3avg = round((array_sum($result[3])/($total-1)),2);
$f4avg = round((array_sum($result[4])/($total-1)),2);
$f5avg = round((array_sum($result[5])/($total-1)),2);
$f6avg = round((array_sum($result[6])/($total-1)),2);
$f7avg = round((array_sum($result[7])/($total-1)),2);
$f8avg = round((array_sum($result[8])/($total-1)),2);
//pie chart question 1 information
$p1f0 = round((($p1[0]/($total-1))*360),0);
$p1f1 = round((($p1[1]/($total-1))*360),0);
$p1f2 = round((($p1[2]/($total-1))*360),0);
$p1f3 = round((($p1[3]/($total-1))*360),0);
$p1f4 = round((($p1[4]/($total-1))*360),0);
//_____________$a0________$a1______________$a2___________________$a3__________________________$a4_______________
$pC1 = array(($p1f0),($p1f0+$p1f1),($p1f0+$p1f1+$p1f2),($p1f0+$p1f1+$p1f2+$p1f3),($p1f0+$p1f1+$p1f2+$p1f3+$p1f4));
print_r ($pC1); 
```

这是饼图脚本：

```
header("Content-type: image/png");

//create pie charts
$image=imagecreatetruecolor(51,51);
//_____________________colors____________________________
$my_colorA=imagecolorallocate($image,51,51,255);
$my_colorB=imagecolorallocate($image,100,150,215);
$my_colorC=imagecolorallocate($image,20,20,151);
$my_colorX=imagecolorallocate($image,216,216,255);

$red = imagecolorallocate($image, 255, 0, 0);
$orange = imagecolorallocate($image, 191, 64, 0);
$dark_yellow = imagecolorallocate($image, 128, 128, 0);
$dark_green = imagecolorallocate($image, 64, 191, 0);
$green = imagecolorallocate($image, 0, 255, 0);
//_______________________________________________________
imagefill($image,0,0,$my_colorX);

//__________________ , center,  w , h , st, end, clr  ,    type______
imagefilledarc($image,25,25, 50, 50,  0,  $a0, $red, IMG_ARC_PIE);
imagefilledarc($image,25,25, 50, 50, $a0,  $a1, $orange, IMG_ARC_PIE);
imagefilledarc($image,25,25, 50, 50, $a1, $a2, $dark_yellow , IMG_ARC_PIE);
imagefilledarc($image,25,25, 50, 50, $a2,  $a3, $dark_green, IMG_ARC_PIE);
imagefilledarc($image,25,25, 50, 50, $a3,  $a4, $green, IMG_ARC_PIE);
//___________________________________________________________________

imagepng($image);
imagedestroy($image); 
```

我不知道为什么它不起作用，但是当我单击查看图像时，我得到了这个： PieChart.php?a0=33&a1=66&a2=230&a3=263&a4=361/%3E%3C/td%3E%3Ctd%20style=

所以是的，我不知道我做错了什么！请帮忙！

哦，最后这就是我要放入我的 html 的内容。

img src=\"PieChart.php?a0=".$pC1[0]."&a1=".$pC1[1]. "&a2=".$pC1[2]。"&a3=".$pC1[3]."&a4=".$pC1[4]."/"

是的，我知道它需要 img 标签和 php 和 echo 我只是无法在表单中发布它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T20:56:32.570

所以解决方案碰巧是某种形式的语法错误，但对于任何想要了解上述代码的人来说......

1) 通过硬编码输入值并查看结果来检查脚本。
2）检查从调用函数传递的参数。

之后，上面的代码示例与您在 php 手册中找到的非常相似。

# android - 如何为非 Maven 项目创建 apklib

> ID：13884512
> 
> 赞同：6
> 
> 时间：2012-12-14T18:42:37.423
> 
> 标签：android, maven, android-library, android-maven-plugin

我的 android 应用程序依赖于来自第 3 方的 android 库项目。我正在将我的构建环境切换到 maven 并遵循示例进行得相当顺利，但最后一步是这个。我不明白我实际上需要***做什么***。我在[这里](http://code.google.com/p/maven-android-plugin/wiki/ApkLib)阅读了 apklib 页面。我从来没有见过一个文件围绕着你实际上做得比这个文件更好。它包含 1 个片段，说明您如何引用 apklib，但根本没有关于您如何实际生成它的信息？

另外，我的项目结构看起来像这样

```
/projectroot/app   (main application android project source code)
/projectroot/shared/lib1  
/projectroot/shared/lib2 (3rd party lib i don't want to create pom.xml for) 
```

我有 projectroot/pom.xml 的模块部分，如下所示：

```
<modules>
    <module>shared/lib1</module>
    <module>shared/lib2</module>
    <module>app</module>
</modules> 
```

这是正确的吗？在我看到的所有模块示例中，它们指的是文件夹直接子级，而我的则嵌套更深。

我正在寻找的主要内容是如何使 lib2 成为从 app/pom.xml 引用的 apklib。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T00:29:11.913

[您引用的链接](http://code.google.com/p/maven-android-plugin/wiki/ApkLib)中提到了它：

> ## 兼容非 Maven Android 库项目！
> 
> 生成的 .apklib 文件将具有标准 Android/Eclipse 库项目的布局。这意味着无论您的 Maven 布局如何，.apklib 文件中的布局都将是源代码位于“src/”而不是“src/main/java/”中，但在 Android/Maven 应用程序中使用时仍能正确解释项目。这是为了兼容非 Maven 开发者的库项目，这对于发展 Android 开发者社区很重要。
> 
> ## 使用其他非 Maven 开发者的库
> 
> 这也意味着我们可以获取任何外部 Android 库项目 zip 文件（来自非 Maven 开发人员）并对其执行 mvn install:install-file ... 并开始使用它作为依赖项。
> 
> ## 与非 Maven 开发人员共享您的 .apklib
> 
> 要与非 Maven 开发人员共享您的 .apklib 文件，如果您将其重命名为 .zip，他们可能会感觉更舒服。然后，他们可以简单地将其解压缩到一个目录中并从那里使用它。

如果它是一个 mavenized Android 库项目，只需运行`mvn clean install`以创建 apklib 并将其安装在本地 Maven 存储库中。

如果是常规的 Android 库项目，只需压缩项目文件夹（最好去掉所有不必要的 IDE 生成的文件），将 my-lib.zip 重命名为 my-lib.apklib，然后运行[`mvn install:install-file`](http://maven.apache.org/plugins/maven-install-plugin/usage.html)将 my-lib.apklib 安装到本地Maven 存储库。

请注意，在你的多模块maven项目中，如果子模块lib2没有maven化，运行maven build时可能会出现配置错误，毕竟它被称为多模块Maven项目，所以包含一个非-mavenized子项目。如果 lib2 尚未 mavenized，请将其 mavenize 作为 mutli-module maven 项目的一部分，或者将其从 mutli-module maven 项目中删除并单独维护它（通过 apklib 的命令行构建和通过源代码的 IDE 开发）。

Also note that project building in Maven and Eclipse are totally different story, if you are creating/importing the project into IDE, you need the library project source anyway. If lib2 is mavenized as part of the multi-module project, it will be imported and setup automatically when import the parent project, otherwise, you may need import and setup the standalone project manually. Check out [this answer](https://stackoverflow.com/questions/8831481/apklib-does-not-get-installed-in-maven-repo/8831891#8831891) and [this answer](https://stackoverflow.com/questions/8823392/android-maven-plugin-apklib-mojo-doesnt-include-compiled-r-in-resulting-apklib/8826739#8826739) for more details.

# android - Android - 是否可以在服务中运行 DefaultHTTPClient？

> ID：13884514
> 
> 赞同：0
> 
> 时间：2012-12-14T18:42:49.567
> 
> 标签：android, service, httpclient

我在 Android 服务中运行 DefaultHttpClient，但即使出现错误也无法得到任何结果。可能吗？通过上网，我发现将HTTPClient作为服务，但我在服务中找不到调用HTTPClient。期待帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:45:52.477

您是否查看过如何在 Java 中使用 HTTP 客户端、发布和响应？这是一个基本示例，可能会在 AsyncTask doInBackground 函数中使用：

```
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

//in doInBackground() or other thread outside of main
InputStream myStream;
HttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(url_select);

List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);

try {
    nameValuePairs.add(new BasicNameValuePair("currentUser", currentUserVar));
    httpPost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
    HttpResponse response = httpClient.execute(httpPost);

    myStream = response.getEntity().getContent();

} catch (ClientProtocolException e) { e.printStackTrace(); 
} catch (IOException e) { e.printStackTrace(); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:53:16.143

是的，您可以在 Android 服务中“运行 DefaultHttpClient”。您可以通过多种方式将结果（响应代码、响应等）返回给您的其他组件（活动等）。

您可以使用[ResultReceiver](http://developer.android.com/reference/android/os/ResultReceiver.html)。

或者，您可以使用 Otto 之类的服务总线（如果您愿意了解一些有关总线的知识并进行设置，这会容易得多，而且它在许多地方都很方便，而不仅仅是服务）。

要真正提供帮助，您需要让问题更清楚一些。您的服务是否已经在工作并发出 HTTP 请求，您只需要将结果发送给其他组件，或者您根本无法让 DefaultHTTPClient 工作，服务与否？

此外，如果您不想自己处理线程，您应该查看[IntentService](http://developer.android.com/reference/android/app/IntentService.html)。它通常是“服务中的 HTTP 客户端”之类的理想选择。

这个问题有更多的一般信息：[Android - httpclient as a backgroundservice](https://stackoverflow.com/questions/5682632/android-httpclient-as-a-backgroundservice)

# tfs - 对迭代中的积压项目进行排序

> ID：13884515
> 
> 赞同：0
> 
> 时间：2012-12-14T18:42:52.177
> 
> 标签：tfs

是否可以按名称对板上的项目进行排序？似乎他们想通过任务编号来安排自己，但这并不总是有用的......

![在此处输入图像描述](../Images/9d5876e1ede844ec76f08b09da42481a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T14:53:06.780

似乎迭代中的排序是由**积压优先级**值驱动的。

![在此处输入图像描述](../Images/318a925df5a80fef2aedd0aa6434f93c.png)

这是部分排序，因为**Backlog Priorty**值不需要是唯一的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T09:09:20.650

您可能可以编写一个 tfs Web 访问插件来执行此操作。这些插件是用 javascript 编写的，因为 jQuery 已经包含在页面中，所以它应该是相当简单的。

有关示例插件，请参阅 Tiago Pascoal 的任务板增强器。

[http://pascoal.net/2012/12/team-foundation-task-board-enhancer-version-0-4-released/](http://pascoal.net/2012/12/team-foundation-task-board-enhancer-version-0-4-released/)

# javascript - 使用 Javascript 原型的最佳实践

> ID：13884519
> 
> 赞同：1
> 
> 时间：2012-12-14T18:43:10.120
> 
> 标签：javascript, function-prototypes

我知道有很多关于使用原型的材料，但似乎有很多不同的建议方法，我正在尝试找到我的方法。我真的只是在寻找有关以下结构的反馈，如果您发现它有任何问题。提前致谢。

```
function Class(){}

Class.prototype = {
    MethodOne: function() {

    },
    MethodTwo: function() {

    },
    MethodThree: function() {

   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:21:11.300

Overall perfect! This is how I create my classes too. Here are a few minor edits:

```
function Class() {
   return this;
}

Class.prototype = {
    methodOne: function() {

    },
    methodTwo: function() {

    },
    methodThree: function() {

   }
} 
```

1) Changed the method names to start with lowercase. Just for convention.
2) Made your constructor return this (the newly create object).
3) Once you have created the Class you can use it like:

```
 var obj = new Class();  
 obj.methodOne(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:21:36.620

You're example is really simple and syntax correct. However, I'd like to share my thoughts with you.

First of all, you completely replace prototype object of your `Class` constructor. It's fine, but you lose reference to constructor from objects created with `Class`. Using you code:

```
var a = new Class();
a.constructor; // => function Object() { [native code] } 
```

Wouldn't it be better if `constructor` property points to `Class` as it's a real constructor? To fix it, you need to add `constructor` property to `Class` prototype. Like: `Class.prototype.constructor = Class`.

Secondly, I usually see object methods starting from lower case letter. It's rather a convention, but that's how all native object's methods are defined. For instance, look at methods defined in default `Date` object (`Date.prototype.*`). All of them start with lower case letter.

# c++ - 单击按钮查看图像。qt

> ID：13884524
> 
> 赞同：1
> 
> 时间：2012-12-14T18:43:22.537
> 
> 标签：c++, image, qt, pixmap

我在主窗口中创建了一个标签，其大小设置为 200x300px。现在单击按钮，我需要查看其中的图像。这是按钮的插槽功能。

```
 void MainWindow::function1(){
QImage img;
img.loadFromData("test.jpg");
img = img.scaled(200, 300, Qt::KeepAspectRatio, Qt::SmoothTransformation);
label->setPixmap(QPixmap::fromImage(img));
} 
```

问题是编译没有错误，但不显示图像。按下按钮时插入，它`QImage::scaled: Image is a null image`在 IDE 中显示，我在 qt 中是新的。我会非常感谢任何建议。

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:20:57.977

`QImage`如果您在 GUI 线程之外处理图像，则必须使用 a 。此外，该`loadFromData()`函数看起来像是用于传递大量字节数组，而不是文件名。

这是我将如何使用 QPixmap 来完成的。

```
QPixmap pix;

bool loaded = pix.load("test.jpg");

if(loaded == false)
{
    label->setText("Failed to load test.jpg from" + QDir::currentPath());
}
else
{
    pix = pix.scaled(200, 300, Qt::KeepAspectRatio, Qt::SmoothTransformation);
    label->setPixmap(pix);
} 
```

您可能还想用`label->width()`and替换 200 和 300 `label->height()`。以这种方式缩放像素图看起来最好，但您也可以设置像素图然后使用`label->setScaledContents(true)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:18:54.157

代替

`img.loadFromData("test.jpg");`

采用

`img.load("test.jpg");`

如果您从 QIODevice 加载。

# c# - 无法在 WPF 应用程序 C# VS2010 中使用 SendKeys

> ID：13884525
> 
> 赞同：1
> 
> 时间：2012-12-14T18:43:26.747
> 
> 标签：c#, wpf, visual-studio-2010

我想用这个命令发送一个简单的 Enter 键：

```
System.Windows.Forms.SendKeys.Send("{ENTER}"); 
```

但是，我没有得到 System.Windows.Forms ...命名空间中不存在“表单”？该应用程序是在 VS2010 中开发的，我相信它是 WPF，MainWindow.xaml.cs。

我该如何解决？

基本上，我的应用程序中的一个按钮将启动一个 exe，然后我想发送一个“ENTER”命令。

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:48:06.487

您需要引用 System.Windows.Forms.dll - WPF 应用程序默认不引用它

# android - 从 Github 到现有的 Android 项目

> ID：13884526
> 
> 赞同：0
> 
> 时间：2012-12-14T18:43:35.737
> 
> 标签：android, github, android-widget

我是android开发的新手，如果问题不清楚，很抱歉。我想使用小部件“数字选择器”，它可以在 Github 的这个[链接](https://github.com/SimonVT/android-numberpicker/tree/master/library)中找到。我知道有一种方法可以将 git 项目导入 eclipse，但我想做的是将它添加到我已经存在的项目中。我已经尝试手动将类和所有包含的文件夹添加到该小部件到我的项目中，问题是没有解释如何将此数字选择器元素添加到活动的 xml 文件。我是这样做的： 1\. 将 Scroller 和 NumberPicker 类添加到项目包下的 src 文件夹中。2.添加了可绘制的xmls、值和图像。3.将jar文件添加到Android Dependencies文件夹。4\. 已将此添加到活动 xml 文件中：

```
<com.example.mathgame.NumberPicker
android:id="@+id/numberPicker"
android:layout_width="wrap_content"
android:layout_height="wrap_content" /> 
```

这是主要活动类：

```
package com.example.mathgame;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;
import com.example.mathgame.NumberPicker;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final NumberPicker np = (NumberPicker) findViewById(R.id.numberPicker);
        np.setMaxValue(24);
        np.setMinValue(1);
        np.setFocusable(true);

        np.setFocusableInTouchMode(true);

    }

} 
```

当我运行应用程序时，这是 logCat 中的异常：

```
12-14 20:23:26.283: E/AndroidRuntime(29792): FATAL EXCEPTION: main
12-14 20:23:26.283: E/AndroidRuntime(29792): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.mathgame/com.example.mathgame.MainActivity}: java.lang.ClassCastException: android.widget.NumberPicker cannot be cast to com.example.mathgame.NumberPicker 
```

我想知道处理导入的 github 项目的正确方法是什么，以及我应该如何解决这个问题。谢谢！！！

* * *

我找到了应用程序崩溃的原因。这是因为 number_picker.xml 文件，我在某些地方已更改为 com.example.mathgame.NumberPicker。现在应用程序启动了，但数字选择器看起来很奇怪（我有按钮和它附近的一些元素）。现在的样子如下：

```
<merge xmlns:android="http://schemas.android.com/apk/res/android">

    <ImageButton android:id="@+id/np_increment"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        style="?attr/numberPickerUpButtonStyle"
        android:contentDescription="@string/np_number_picker_increment_button" />

    <view class="com.example.mathgame.NumberPicker$CustomEditText"
        android:id="@+id/np_numberpicker_input"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        style="?attr/numberPickerInputTextStyle" />

    <ImageButton android:id="@+id/np_decrement"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        style="?attr/numberPickerDownButtonStyle"
        android:contentDescription="@string/np_number_picker_decrement_button" />

</merge> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:07:47.540

这是一个库项目。所以你可以直接在你的android项目中添加这个项目。只需导入一个库项目。然后进入项目属性->android->向下滚动添加库项目。毕竟使用这个库类来创建对象。

# google-apps-script - 我不能使用应用程序脚本在谷歌电子表格中使用从一张到另一张的单元格值

> ID：13884527
> 
> 赞同：0
> 
> 时间：2012-12-14T18:43:40.737
> 
> 标签：google-apps-script

我正在尝试使用应用程序脚本为 goole 电子表格中的单元格设置公式....

一切都很好，直到我在同一个工作表中工作，但我试图使用来自同一个电子表格的另一个工作表来更新一个单元格，如下所示，

```
sheet.getRange(1,1,1,1).setValue("=Ref!A15"); 
```

但它显示`error:Unknown range name Ref!A15`

我不知道这里缺少什么，任何人都可以帮我解决这个问题...

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:54:37.683

您收到此错误是因为它正在尝试查找命名范围并失败。相反，使用：`sheet.getRange(1,1,1,1).setFormula("=Ref!A15");`为单元格设置公式。

# php - 在下一页显示while循环结果？

> ID：13884535
> 
> 赞同：0
> 
> 时间：2012-12-14T18:44:16.470
> 
> 标签：php, mysql

嗨，我有一个功能可以收集用户添加的帖子列表，并在页面中循环显示它。

我限制了显示的结果数量，即 LIMIMT 15，因此它不会在页面上溢出。但我现在想要做的是让所有其他结果（无论用户可以添加多少）显示在下一页上。每页只显示 15 个结果。因此，您最终会得到第 1 页、第 2 页、第 3 页等。

这是如何实现的？

```
function get_forum() {
            global $connection;
            global $profile_id;
            $query = "SELECT *
                        FROM ptb_forum
                        WHERE ptb_forum.deleted ='0'
                        ORDER BY ptb_forum.date_added DESC
                        LIMIT 0 , 16";
            $forum_set = mysql_query($query, $connection);
            confirm_query($query, $connection);
            return $forum_set;
        }

<?php
    $forum_set = get_forum();

    ?>
    <br/>
    <h3>Latest Forum Posts</h3>
    <br/> 

    <?php
    if(mysql_num_rows($forum_set) > 0) {
        while ($forum = mysql_fetch_array($forum_set)) {
            $age = days_from_date($forum['date_added']);
            ?>
            <div class="prof-content-box-forum" id="reviews">
             <div class="forum-content">
             <?php echo "{$forum['content']}"; ?>
             </div>
             <div class="message_pic">
             <?php echo "<a href=\"profile.php?id={$forum['from_user_id']}\"><img width=\"50px\" height=\"50px\"  src=\"{$prof_photo}\"></a>";?>

             </div>

             <div class="forum-text">
             <?php echo "Posted by {$forum2['display_name']}"; ?> <?php echo "".$age." days ago"; ?>
          </div>

             </div>

             <? } } ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:53:55.433

`get_forum();`需要考虑它所在的页面。

```
 $page = $_GET['page'];
    $page or $page = 1;
    $offset = ($page * 15) - 15;
    // obviously you need to sanitize this

    "SELECT *
    FROM ptb_forum
    WHERE ptb_forum.deleted ='0'
    ORDER BY ptb_forum.date_added DESC
    LIMIT $offset , 16" 
```

您还需要写出分页，以便您的用户可以浏览这些页面。一个关于 php 分页的基本 google 搜索将为您提供许多为此准备的功能。此示例假定您使用 $_GET var "page" 来表示您所在的页面。例如，`yoursite.com/forum.php?page=2`

另外，我只是把查询本身作为一个例子在这里，因为有很多方法可以不使用 mysql_ 函数来执行它。

你应该停止使用 mysql_ 函数。[PDO](http://php.net/manual/en/class.pdo.php)和[mysqli](http://php.net/manual/en/book.mysqli.php)非常容易实现，并且整个站点以及整个互联网都存在大量支持。

# multithreading - 使用工作线程的多线程库无法与 UI 线程通信

> ID：13884537
> 
> 赞同：1
> 
> 时间：2012-12-14T18:44:29.680
> 
> 标签：multithreading, communication, windowsformsintegration

我正在使用第 3 方库将数据从第 3 方输入设备传送到 Windows 窗体。我要做的是从设备收集输入数据，对其进行处理并在特定条件下向 Windows UI 线程报告正在发生的事情。我无权访问第 3 方 DLL 的源代码，但我知道主要方法在后台进程中，并且我无法将我的发现传达回我认为的主 UI 线程，因为我没有创建它？

窗体：

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();

        // create instance of my listener
        MyListener listener = new MyListener(this);
        Controller controller = new Controller(listener);
   }
} 
```

MyListener 类扩展了第 3 方类监听器：

```
public class MyListener : Listener
{
    public Form1 form;
    private Frame frame;

    // overloaded constructor
    public LeapListener(Form1 f)
    {
        form = f;
    }

    /// <summary>
    /// onFrame is the main method that runs every milisecond to gather relevant information 
    /// </summary>
    public override void onFrame(Controller controller)
    {
        // Get the most recent frame and report some basic information
        frame = controller.frame();
     }
 } 
```

问题是我可以从 MyListener 类中的任何位置与主 UI 线程进行通信，但我无法从 onFrame 方法进行通信，因为它在后台线程上运行。有没有办法从我没有创建的后台线程中获取主线程？

我尝试了 ReportProgress，我尝试在 MyListener 上创建一个事件，并且所有尝试从 onFrame 与主 UI 线程对话都会使应用程序崩溃并给我无效的内存位置错误。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T20:38:59.667

通常，尝试从处理 UI 的线程以外的线程访问 UI 对象是有问题的。这不是唯一的 Windows 问题，而是更普遍的模式。

通常的解决方案是设置某种形式的事件传播机制，其中包含更新 UI 所需的数据，并让主线程处理该任务。

我们称UI线程为UI，后台线程为BT。

你可以有一个函数从 BT 向 UI 发布事件，然后阻止 BT 直到事件被 UI 处理。这是一个使用信号量阻止 BT 直到 UI 释放它的简单系统。这种系统的优点是它很简单，您不需要一次处理来自任一线程的多个事件。不利的一面是，如果处理事件需要很长时间，则应用程序的设备采样分辨率会很差。另一种（更好的）方法是创建一个事件队列，让 BT 发布到它，然后 UI 轮询它以更新自身。它需要更多的工作，但它对 UI 长时序更具弹性。

对于第二种技术，您必须为您的事件建立一个格式，在 BT 和 UI 之间设置一个共享和互斥保护的队列，其余的应该很容易做到。

队列可能如下所示：

```
#include <queue>

template <typename EVENT>
class EventQueue {
   protected:
     typedef EventQueue<EVENT> self_type;
     typedef std::queue<EVENT> queue_type;
     Mutex m_;
     queue_type q_;
     void lock(){
         // lock the mutex
     }
     void unlock(){
         // unlock the mutex
     } 
   public:
     EventQueue() {
        // initialize mutex
     }
     ~EventQueue() {
        // destroy mutex
     }

     void push(EVENT &e){
         lock();
         q_.push(e);
         unlock();
     }
     EVENT &pop(){
         EVENT &e;
         lock();
         e = q_.pop();
         unlock();
         return e;
     }
     int size(){
         int i;
         lock();
         i = q_.size();
         unlock();
         return i;
     }
}; 
```

如您所见，这非常简单，您只需将上面的模板与您需要的任何 EVENT 类一起使用。

我省略了处理互斥锁的代码，这取决于您要依赖的 api。如上所述，UI 必须只轮询队列，即检查队列的大小，并在有可用事件时取出事件。在 BT 方面，您需要做的就是在您的`MyListener`课程中包含事件推送调用，而不是直接访问表单。

这种方法非常有效地让两个线程一起工作而不会互相踩到脚趾。

# java - Grails 映射基本集合类型

> ID：13884540
> 
> 赞同：2
> 
> 时间：2012-12-14T18:45:05.347
> 
> 标签：java, hibernate, jakarta-ee, grails

Grails 支持基本集合类型的映射，例如：

```
static hasMany = [nicknames: String] 
```

那么，执行上述操作与仅将类型的数组（或列表）添加到域类之间究竟有什么区别`String`- 即

```
List<String> nicknames 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T19:14:45.003

不同之处在于：

```
List<String> nicknames 
```

Grails 并不知道您实际上想要映射（通过 Hibernate）。Grails 使用`static hasMany`告诉 Hibernate 如何在不需要 Hibernate 映射文件的情况下工作。

从技术上讲，您不需要定义`List<String>`. 你只需要`hasMany`. 这将默认在`Set<String>`. 如果您需要索引列表，那么与 保持一致`List<String>`也是`hasMany`可以的。

# c# - 如何使用asp net mvc 4从AjaxOptions中的控制器获取返回的数据

> ID：13884542
> 
> 赞同：1
> 
> 时间：2012-12-14T18:45:20.730
> 
> 标签：c#, .net, ajax, asp.net-mvc, asp.net-mvc-4

我有这个表格

```
@using (Ajax.BeginForm("opImportFile", "Operacao", new AjaxOptions { HttpMethod = "POST",
OnSuccess = "LimparCampos('true')", OnFailure = "LimparCampos('false')" }, 
new { id = "formUpdStoringSettings" }))
{ ... } 
```

我想传递 /Operacao/opImportFile 返回的字符串，而不是 true 或 false

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:51:27.623

根据[文档](http://msdn.microsoft.com/en-us/library/system.web.mvc.ajax.ajaxoptions.onsuccess%28v=vs.90%29.aspx)，回调提供了返回的 ajax 内容，它本身具有“`get_data()`从服务器获取响应的方法”。

在您的定义中，您可能只需要指向回调方法，而不是自己实际调用它（意思是，不包括参数）：

```
OnSuccess = "LimparCampos" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:05:52.187

我非常倾向于避免使用 AjaxForm。我会编写普通表单并让我的 javascript 来处理单独发布的表单。简单干净。

```
@using(Html.Beginform("opImportFile","Operaco"))
{
  //some elements here
  <input type="submit" value="Save" id="btnSave" />
} 
```

还有一些 javascript 让我们的表单提交到 ajaxified 版本

```
$(function(){
  $("#btnSave").click(function(e){
     var _form=$(this).closest("form");
     e.preventDefault();
     $.post(_form.attr("action"),_form.serialize(),function(response){
         // now response variable has the return item from the action method.
         // and do some fun stuff with that.
         alert(response);

     });
  });
}); 
```

您可以从您的操作方法返回任何内容。字符串、JSON 或部分视图。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:57:31.633

尝试像这样设置回调函数：

```
OnSuccess = "LimparCampos" 
```

并通过以下方式访问数据：

```
 function LimparCampos(response) {
     var jsonResult = response.get_response().get_object();

  } 
```

# javascript - 我可以为弧的结束角度设置动画吗？

> ID：13884543
> 
> 赞同：1
> 
> 时间：2012-12-14T18:45:26.123
> 
> 标签：javascript, html, animation, canvas, html5-canvas

我正在尝试使我的弧的结束角度从 X 变为 Y。

这就是我所拥有的：http: [//jsfiddle.net/97dUJ/](http://jsfiddle.net/97dUJ/)

我可以做：

```
var endAngle = 0 * Math.PI; 
```

动画到：

```
var endAngle = 0.5 * Math.PI; 
```

不只是跳到那个角度，而且实际上是动画，很简单，比如 easeInOut 或其他东西......这可能吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-02T14:21:55.343

您可以为 endAngle 属性设置动画，然后清除画布并使用最新值重新绘制弧线，就像这样..

```
var canvas = document.getElementById('myCanvas');
var context = canvas.getContext('2d');
var props = {
    x : canvas.width / 2,
    y : canvas.height / 2,
    radius : 75,
    startAngle : 0,
    endAngle : 0,
    counterClockwise : false
}

function drawArc() {
    context.clearRect(0, 0, canvas.width, canvas.height);

    context.beginPath();
    context.arc(props.x, props.y, props.radius, props.startAngle, props.endAngle, props.counterClockwise);
    context.lineWidth = 15;

    // line color
    context.strokeStyle = 'black';
    context.stroke();    
}

TweenMax.to(props, 1, {endAngle: Math.PI * 2, yoyo:true, repeat:-1, ease:Quad.easeInOut, onUpdate:drawArc}); 
```

[http://jsfiddle.net/B8XCw/8/](http://jsfiddle.net/B8XCw/8/)

注意：这是使用 Tweenmax 为属性设置动画

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T14:52:22.320

它很容易做到，你只需要添加一个`setTimeout`或`requestAnimationFrame`并增加你想要乘以结束角度的值。

**[现场演示](http://jsfiddle.net/loktar/97dUJ/1/)**

```
 var canvas = document.getElementById('myCanvas');
      var context = canvas.getContext('2d');
      var x = canvas.width / 2;
      var y = canvas.height / 2;
      var radius = 75;
      var startAngle = 1.5 * Math.PI;
      var curVal = 0;
      var endAngle = 0 * Math.PI;
      var counterClockwise = false;

function animate(){
    if(curVal < 0.5){
      curVal+= 0.01;
    }
      endAngle = curVal * Math.PI;
      context.beginPath();
      context.arc(x, y, radius, startAngle, endAngle, counterClockwise);
      context.lineWidth = 15;
      // line color
      context.strokeStyle = 'black';
      context.stroke();
    setTimeout(animate,30);
}

animate();
​ 
```

# php - Codeigniter/Datamapper 未正确生成关系查询

> ID：13884553
> 
> 赞同：0
> 
> 时间：2012-12-14T18:46:12.320
> 
> 标签：php, codeigniter, codeigniter-datamapper

我有一个使用 Codeigniter/Datamapper 的应用程序。有一个医生表，一个专业表，模型设置为多对多关系。

我注意到尝试按专业查询医生导致它只查询所有医生。以前有人遇到过这个问题吗？这是我正在使用的代码：

```
$s = new Specialty();
$s->where('id',$id)->get(); //thought maybe get_by_id($id) was causing the issue, it wasnt...
$this->out['query'] = $s->doctor->order_by('last_name','asc')->get_sql();
$docs = $s->doctor->order_by('id')->get_iterated(); 
```

$this->out['query'] 响应以下 sql 查询：

```
"SELECT * FROM (`doctors`) ORDER BY `doctors`.`last_name` asc" 
```

另一个奇怪的事情是结果不是按姓氏排序的，但我假设它是如何将数组传递给 json_encode 函数的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T22:12:27.707

您需要向该`get_sql`方法添加一些参数，因为您在相关对象上使用它。

从[文档](http://datamapper.wanwizard.eu/pages/getalt.html)：

```
$object->get_sql()

This method returns the SQL for the currently built query, as if get() was called. It clears the current query immediately.

Arguments

$limit: (Optional) Sets the limit on the query.
$offset: (Optional) Sets the offset on the query.
$handle_related: (Optional) If TRUE, and this object is referenced from a parent object, the parent object will automatically to the where statement.

$u = new User();
$u->where('name', 'Bob');
echo $u->get_sql();
// outputs the raw SQL
Example with relationship
$group = new Group(1); // load Group #1

echo $group->user->get_sql();
// SELECT `users`.*
// FROM `users`

echo $group->user->get_sql(NULL, NULL, TRUE);
// SELECT `users`.*
// FROM `users`
// LEFT OUTER JOIN `groups` groups ON `users`.`group_id` = `groups.id`
// WHERE `groups`.`id` = 1 
```

所以你需要这样做才能输出正确的查询：

```
$this->out['query'] = $s->doctor->order_by('last_name','asc')->get_sql(NULL, NULL, TRUE); 
```

# bash - 将值/参数传递给带有空格的 Shell 脚本

> ID：13884554
> 
> 赞同：0
> 
> 时间：2012-12-14T18:46:14.493
> 
> 标签：bash, shell, unix

下面是一个用于获取 2 个输入参数值的 shell 脚本，

1.  `asd#@#g#@#h#@#j@#@k`

2.  候选人ID

这给了我们输出

```
string0 asd
string1 g
string2 h 
.
.
.

candidateid

.
.
. 
```

（& 然后在 Oracle 查询中使用这两个参数）

现在的问题是，当我尝试用空格传递第一个参数时，上面的代码失败了。

例如：`/TOM/Process Folders/System Drive/a.jpg`

上述给定位置应被视为第一个字符串。如果我在双引号内给出上述内容，那么它可以正常工作。但是我得到的上述参数没有引号。

```
#!/bin/bash
input=$1

input1=$2

IFS='#' read -a arr <<< "${input//#@#/#}"

for((i=0;i<${#arr[@]};i++))
do
        echo "String$i ${arr[i]}"
done

read passportphotos <<< "${arr[0]}"
read academiccertificates <<< "${arr[1]}"
read dateofbirth <<< "${arr[2]}"
read addressproof <<< "${arr[3]}"
read pancard <<< "${arr[4]}"
read pfnominationform <<< "${arr[5]}"
read gratuitynomination <<< "${arr[6]}"
read investmentdeclaration <<< "${arr[7]}"
read resignationletter <<< "${arr[8]}"
read acceptanceoffer <<< "${arr[9]}"
read acceptancecodeofconduct <<< "${arr[10]}"
read medicalnomination <<< "${arr[11]}"
read backgroungverification <<< "${arr[12]}"
read personaldataform <<< "${arr[13]}"

echo $passportphotos
echo $academiccertificates
echo $dateofbirth
echo $addressproof
echo $pancard
echo $pfnominationform
echo $gratuitynomination
echo $investmentdeclaration
echo $resignationletter
echo $acceptanceoffer
echo $acceptancecodeofconduct
echo $medicalnomination
echo $backgroungverification
echo $personaldataform

instant_client="/root/ora_client/instantclient_11_2"
view=`$instant_client/sqlplus -s HRUSER/HRUSER@TOMLWF <<EOF

set heading off

set feedback off

set lines 10000

set pagesize 10000

insert into EMPLOYEEDOCUMENTS VALUES ((SELECT EMPLOYEEID FROM EMPLOYEE WHERE CANDIDATEID='$input1'),'Resume','Doc','$passportphotos','Y','HR',(SELECT SYSDATE FROM DUAL),'HR',(SELECT SYSDATE FROM DUAL),'HR',(SELECT SYSDATE FROM DUAL));
`

echo $view 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:17:46.933

以这种方式调用您的脚本：

```
delimiter_new.sh 'company_home/TOM/Proc_joingchecklist_test/Process Instance Documents/Instance.jpg' 14492 
```

您需要在文件名周围加上引号，以便将其视为单个参数。

此外，您不需要`sh`明确指定，`#!/bin/bash`脚本中的行告诉操作系统运行 bash。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T18:53:23.320

我想您实际上不必发布所有代码来说明您在参数中遇到空格问题。

作为补充，在任何编程语言中，使用数组或将值映射到容器（在 bash 的情况下使用关联数组）比创建数十个变量更有用。

*编辑*：

对不起; 正如 Barmar 所指出的，我误读了这篇文章，并且我提出了一些确实改变了你的程序的执行的东西。事实是，如果问题出在命令行参数上，那么您必须将双引号括起来；这就是阅读论点的方式。

但是，您可以将所有参数读入一个数组，然后`IFS`像您所做的那样更改 。请注意，您的论点必须用手头已知的东西分隔开来，以及在使用`IFS='#'`.

# android - 我的 Android 通知计划功能出了什么问题？

> ID：13884555
> 
> 赞同：0
> 
> 时间：2012-12-14T18:46:27.407
> 
> 标签：android, android-notifications, localnotification

我正在尝试制作一个在 Android 中安排本地通知的简单功能，但它不起作用。我错过了什么吗？即清单中的许可或类似的东西？我是android编程的新手。

```
static int notificationId = 0;

public void scheduleLocalNotification(String text, int seconds)
{
    Context context = getApplicationContext();
    long when = System.currentTimeMillis() + seconds * 1000;
    NotificationManager notificationManager = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);

    Intent notificationIntent = new Intent(context, MyApp.class);

    // set intent so it does not start a new activity
    notificationIntent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP
            | Intent.FLAG_ACTIVITY_SINGLE_TOP);
    PendingIntent intent = PendingIntent.getActivity(context, 0,
            notificationIntent, 0);
    Notification notification = new Notification();
    notification.setLatestEventInfo(context, "My application", text, intent);
    notification.flags |= Notification.FLAG_AUTO_CANCEL;
    notification.when = when;
    notificationManager.notify(notificationId, notification);
    notificationId ++;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:00:05.020

我认为您忘记在 android 清单文件中输入新活动，所以只需输入下面给出的活动

```
 <activity
        android:name=".your activity name"
         /> 
```

并运行程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T17:39:32.063

我找到了。问题是我没有将图标资源传递给通知构造函数。

```
notification = new Notification(R.drawable.icon, text, when); 
```

# amazon-web-services - 将证书上传到 AWS 时出错

> ID：13884559
> 
> 赞同：2
> 
> 时间：2012-12-14T18:46:51.513
> 
> 标签：amazon-web-services

我正在尝试将证书从我的 UNIX 服务器上传到 IAM，以附加到 AWS 中的负载均衡器。

当我发出命令时： iam-servercertupload -b new.server.cert.pem -k new.server.pem -s mysite.cert.com -v -d 我得到以下错误：

```
Unable to load version information for the running SDK: com/amazonaws/sdk/versionInfo.properties not found on classpath
Set parameter http.useragent = Jakarta Commons-HttpClient/3.0.1
Set parameter http.protocol.version = HTTP/1.1
Set parameter http.connection-manager.class = class org.apache.commons.httpclient.SimpleHttpConnectionManager
Set parameter http.protocol.cookie-policy = rfc2109
Set parameter http.protocol.element-charset = US-ASCII
Set parameter http.protocol.content-charset = ISO-8859-1
Set parameter http.method.retry-handler = org.apache.commons.httpclient.DefaultHttpMeth 
```

我以 sudo 用户身份运行此命令。网络上没有太多关于此错误的信息。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-04T21:54:42.853

我相信 versionInfo.properties 会在你这样做的时候设置`aws configure`。`aws configure`因此，在尝试上传证书之前，请确保您已完成上述操作。

以下命令对我有用，可以将证书上传到 IAM。 `aws iam upload-server-certificate --server-certificate-name MyCertName --certificate-body file://STAR.mydomain.com.pem --private-key file://https_keys.pem --certificate-chain file://chain.cer`

# c# - 分层窗口、UpdateLayeredWindow、alpha 混合和鼠标事件

> ID：13884561
> 
> 赞同：1
> 
> 时间：2012-12-14T18:47:04.327
> 
> 标签：c#, .net, winforms, alphablending, layered-windows

在 Windows 窗体和 C# 中，我使用具有 WS_EX_LAYERED 样式的窗体，并调用*UpdateLayeredWindow*将背景设置为透明/alpha 混合的图像：

```
NativeMethods.BLENDFUNCTION blend = new NativeMethods.BLENDFUNCTION();
blend.BlendOp = NativeMethods.AC_SRC_OVER;
blend.BlendFlags = 0;
blend.SourceConstantAlpha = 255;
blend.AlphaFormat = NativeMethods.AC_SRC_ALPHA;

NativeMethods.UpdateLayeredWindow(form.Handle, screenDc, ref topPos, ref size, 
    memDc, ref pointSource, 0, ref blend, NativeMethods.ULW_ALPHA); 
```

在图像透明的窗体区域上，窗体不接收鼠标事件。他们转到表格下方的窗口。

是否可以设置窗口样式或选项以使表单能够在其整个表面上接收鼠标事件（鼠标移动、鼠标按下等）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:52:31.860

从[分层窗口](http://msdn.microsoft.com/en-us/library/ms997507.aspx#layerwin_topic2b)

# 命中测试

分层窗口的命中测试基于窗口的形状和透明度。这意味着窗口的颜色键或 alpha 值为零的区域将让鼠标消息通过。如果分层窗口具有 WS_EX_TRANSPARENT 扩展窗口样式，分层窗口的形状将被忽略，鼠标事件将传递给分层窗口下面的其他窗口。

我会尝试重新调整 WS_EX_TRANSPARENT 风格

# jquery - 播放css动画后jquery删除类？

> ID：13884563
> 
> 赞同：13
> 
> 时间：2012-12-14T18:47:17.790
> 
> 标签：jquery, css, html, animation, webkit

我有CSS代码：

```
body.start{-webkit-animation:srcb ease-in .4s 1;} 
```

进入网站后只玩一次

但问题是动画完成时

我网站上的按钮不起作用

动画完成后如何删除正文类“开始”

或在动画播放后删除类延迟 x 秒？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-14T18:52:56.400

您可以绑定到[transitionend](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_transitions?redirectlocale=en-US&redirectslug=CSS/CSS_transitions#Detecting_the_completion_of_a_transition)事件（实际上是所有事件）：

```
$("body").on(
    "transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",
    function() {
        $(this).removeClass("start");
    }
); 
```

如果要实现延迟，可以[queue()](http://api.jquery.com/queue/)类移除操作：

```
$("body").on(
    "transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd",
    function() {
        $(this).delay(1000).queue(function() {  // Wait for 1 second.
            $(this).removeClass("start").dequeue();
        });
    }
); 
```

*注意：* [on()](http://api.jquery.com/on/)仅在 jQuery 1.7 之后才存在，如果您使用的是旧版本，则必须使用[bind()](http://api.jquery.com/bind/)来代替上面的代码。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-29T11:24:32.687

尝试

```
webkitAnimationEnd oanimationend msAnimationEnd animationend 
```

代替

```
transitionend MSTransitionEnd webkitTransitionEnd oTransitionEnd 
```

这对我有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-14T18:52:41.417

也许是另一种方式？

```
$(window).load(function(){
    setTimeout(function(){
        $('body.start').removeClass('start')
    }, 4000);
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T18:58:56.923

这是代码：

```
var div = document.querySelector('div');

function callback() {
    div.classList.remove('start'); // or modify div.className
}

div.addEventListener("webkitAnimationEnd", callback, false); 
```

在 jsbin 上查看这个[实时示例。](http://jsbin.com/omujos/3/edit)

请注意，您的动画和我的解决方案仅适用于基于 webkit 的浏览器。在生产环境中，您应该考虑其他浏览器**并**强制提供无前缀的解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-08T04:30:37.553

对我有用的是始终在事件侦听器开始时删除动画类，在中间运行一些小代码，然后再次添加动画类并且它起作用了。它现在将始终触发动画。就我而言，如果密码错误，我希望触发摆动动画。不确定你的推理。我希望删除动画，这样动画总是会再次触发，即使他们反复点击提交并且这是错误的。

```
$j('#submitLogin').on('click',function(){    
    if(true){
       //login
    }else{
       $j('.lockIcon').removeClass('wobble-hor-top');
       $j(this).prev().prev().addClass('invalid');
       $j('.loadIconKey').hide();
       $j('.lockIcon').addClass('wobble-hor-top');
    }
}); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-07-20T21:02:36.107

```
$("#mydiv").removeClass("start",
    function() {
        alert("do something");
    }); 
```

# c++ - 模板化函数不接受原始类型？

> ID：13884566
> 
> 赞同：1
> 
> 时间：2012-12-14T18:47:33.697
> 
> 标签：c++, templates

此代码无法编译，但我不知道为什么，该`typeid()`函数也可以`int`作为输入参数，因此问题必须与模板机制有关，但我不明白此失败背后的原因。

```
#include <iostream>
#include <typeinfo>

template<typename T> void func(T)
{
  std::cout << typeid(T).name() << std::endl;
}

int main()
{
  func(int);  
  return(0);
} 
```

这个模板/代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T18:49:54.087

您需要传递 type 的实例`int`，而不是类型本身：

```
func(int());
        ^^ note the parentheses 
```

如果您不想传递一个实例，您可以像这样更改您的代码：

```
#include <iostream>
#include <typeinfo>

template<typename T> void func()
{
  std::cout << typeid(T).name() << std::endl;
}

int main()
{
  func<int>();
  return(0);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T18:50:07.477

你必须传递一些类型的“实例” `int`......不仅仅是类型本身......

```
func(int(123)); 
```

会好的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-14T18:51:05.973

trmplate 代码没有任何问题，但是

```
func(int); 
```

无效。你可能是说

```
func(int()); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T18:54:50.583

如果您想显式实例化并使用`T`set to调用您的函数`int`，则必须将其`int`作为*模板*参数传递`foo<int>`：

这并不能成为您提供“普通”参数的借口，因为您使用类型的一个“普通”参数声明了您的函数`T`。

因此，使用明确指定的模板参数的有效调用`foo`可能如下所示

```
foo<int>(0);
foo<int>(true);
foo<int>('a'); 
```

（显式指定模板参数的目的是覆盖模板参数推导机制）。

如果您的意图是将“普通”参数保留为虚构参数（因为您甚至没有费心给它命名），您可以为其提供默认参数

```
template<typename T> void func(T = T())
{
  std::cout << typeid(T).name() << std::endl;
} 
```

在这种情况下，您的函数将变为可调用的

```
foo<int>(); 
```

或者您可以完全摆脱普通参数（因为无论如何您都没有在函数内部使用它）

```
template<typename T> void func()
{
  std::cout << typeid(T).name() << std::endl;
} 
```

尽管这将迫使您始终明确指定模板参数。

如果您有其他想法，则必须解释它是什么。

# triggers - 是否可以从构建参数安排作业而不是设置触发器？

> ID：13884568
> 
> 赞同：4
> 
> 时间：2012-12-14T18:47:45.147
> 
> 标签：triggers, teamcity

我想在单击 run|... 作业选项并在构建参数中设置运行此作业的时间时提供该选项。将此设置为触发器不是一个选项，1）每天可能不同，但它是在晚上，所以设置它会很好。2) 用户无权配置此作业。所以我想为用户添加一个窗口，以便能够从构建参数选项卡中进行选择，例如上午 12:00、上午 1:00 等……这可能吗？在这种情况下，我也无法将依赖项链接到另一个工作。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:23:04.610

这是不可能的——该`Run...`按钮将构建排队等待下一个可用代理，并且不能将代理限制为仅在特定时间段内运行。计划的构建触发器是否不足以满足您的需求？如果是这样，您可以随时向 JetBrains[请求此功能](http://devnet.jetbrains.net/community/teamcity)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-07-21T11:02:10.637

相关请求：[https](https://youtrack.jetbrains.com/issue/TW-6439) ://youtrack.jetbrains.com/issue/TW-6439 ，请投赞成票。[作为当前的解决方法，您可以使用REST API](https://confluence.jetbrains.com/display/TCD9/REST+API#RESTAPI-TriggeringaBuild)触发具有所需参数的构建，然后在 cron 作业中或从另一个计划触发的 TeamCity 构建中使用该逻辑。

# mysql - MySQL Join 使用多个表的父记录

> ID：13884569
> 
> 赞同：0
> 
> 时间：2012-12-14T18:47:53.257
> 
> 标签：mysql, join, left-join, parent

我有三个表：menu、menu_data、languages。第一个用于存储不需要本地化的菜单信息，第二个包含基于语言的本地化数据（如标题），最后一个包含语言 ID。菜单可以由父母拥有，我想在选择子菜单时提取这个父母。我可以使用这样的嵌套 LEFT JOIN 查询来做到这一点：

```
SELECT la.title, la.permaname, menu.edittime, menu.id, la2.title AS parent_title, pmenu.id AS parent_id 
FROM fm_menu AS menu 
LEFT JOIN fm_menu_data AS la ON ( menu.id = la.targetid and la.languageid = 1 ) 
LEFT JOIN fm_menu AS pmenu ON pmenu.id = menu.parentmenu 
LEFT JOIN fm_menu_data AS la2 ON ( pmenu.id = la2.targetid and la2.languageid = 1 ) 
```

但是，我的问题是，有更紧凑、更快或更正确的方法来做这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:07:56.387

您的查询看起来不错。

您可以通过从连接条件中删除不必要的括号并删除可选关键字来使其*更加紧凑。*`AS`

这是相同的，但用更少的字符表示：

```
SELECT la.title, la.permaname, menu.edittime, menu.id, la2.title AS parent_title, pmenu.id AS parent_id 
FROM fm_menu AS menu 
LEFT JOIN fm_menu_data la ON menu.id = la.targetid and la.languageid = 1
LEFT JOIN fm_menu pmenu ON pmenu.id = menu.parentmenu 
LEFT JOIN fm_menu_data la2 ON pmenu.id = la2.targetid and la2.languageid = 1 
```

# wpf - TextBlock 在 180 度 PlaneProjection 动画后变得模糊

> ID：13884571
> 
> 赞同：0
> 
> 时间：2012-12-14T18:48:01.123
> 
> 标签：wpf, silverlight, windows-8, 3d, rotation

我正在使用以下网格在网格中进行 3D 旋转`PlaneProjection`：

```
<Storyboard>
    <DoubleAnimation Storyboard.TargetProperty="RotationY" 
                     Storyboard.TargetName="projection" 
                     Duration="0:0:1" To="180" />
</Storyboard>

<Grid.Projection>
    <PlaneProjection x:Name="projection" />
</Grid.Projection> 
```

问题是，在这个动画的结尾，我`TextBlock`变得有点像这样模糊：

旋转前： ![在此处输入图像描述](../Images/a30d0b6a4f8e159c6d16828c9db4650d.png)

旋转后：![在此处输入图像描述](../Images/ae1cf3a1088cbb4cb880ba0deb03b270.png)

请注意，我已经反转了图像。基本上我做了 2 个动画（1 到 90 度），然后我应用`scaleX`到 -1，然后我结束动画。

已经尝试了一些解决方案来解决这个问题，比如[这个 stackoverflow 主题](https://stackoverflow.com/questions/1719746/silverlight-planeprojection)甚至[这个论坛](http://social.msdn.microsoft.com/Forums/en-US/silverlightnet/thread/9d9f2a00-0444-4981-89e9-ced263fd964e)中建议的解决方案。

但是，我找不到解决此错误的方法。我相信我的解决方案需要一个`PlaneProjection`（或者是吗？），但实际上我想在相反的方向上同时旋转两列图像和文本，而 PlaneProjection 有点简化了这种方法（因为我可以旋转一个完整的网格）。此外，根据我的阅读，这种方法使用 GPU 加速：/。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T09:57:17.683

您是否已经尝试过[UseLayoutRounding](http://www.switchonthecode.com/tutorials/wpfs-most-important-property-uselayoutrounding)属性？

# php - 在php中将日期格式更改为数字

> ID：13884582
> 
> 赞同：-3
> 
> 时间：2012-12-14T18:48:53.103
> 
> 标签：php, format

请，我如何在php中更改日期格式

来自类似 2012-12-14 08:40:26

格式化数字，如 28124629523

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:49:35.660

仅供参考，您要查找的内容称为[Unix 时间戳](http://www.unixtimestamp.com/index.php)

采用[`strtotime()`](http://us3.php.net/manual/en/function.strtotime.php)

```
echo strtotime('2012-12-14 08:40:26'); 
```

或者[`DateTime`](http://us3.php.net/manual/en/book.datetime.php)

```
$datetime = new DateTime('2012-12-14 08:40:26');
echo $datetime->getTimestamp(); 
```

# chef-infra - 厨师刀给 GSSAPI C 库警告

> ID：13884588
> 
> 赞同：5
> 
> 时间：2012-12-14T18:49:31.540
> 
> 标签：chef-infra

花一天时间更新我所有的工具：

厨师 10.16.2 Ruby 1.9.3-p327 Mac OSx Lion XCode 4.5.2

现在每个刀命令都会产生这些烦人的警告：

```
WARNING: Could not load IOV methods. Check your GSSAPI C library for an update
WARNING: Could not load AEAD methods. Check your GSSAPI C library for an update 
```

刀似乎工作正常。我找不到任何有关查找或更新 GSSAPI C 库的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-06T01:29:52.757

这太烦人了，我无法忽视。经过大量谷歌搜索后，我得出了相同的结论`@Mojo`- 注释掉警告。

在 OS X 我正在使用`homebrew`和`rbenv`- 我的宝石位于这里：

```
~/.rbenv/versions/1.9.3-p448/lib/ruby/gems/1.9.1/gems/ 
```

您可以使用该`gem environment`命令获取有关您的存储位置的信息。

我两者都`gssapi-1.0.3`安装`gssapi-1.1.2`了 - 后者似乎是本文发布时的最新版本，它似乎也是我的错误的来源。我必须更改的文件是：

```
gems/1.9.1/gems/gssapi-1.1.2/lib/gssapi/lib_gssapi.rb 
```

我的完整路径是：

```
~/.rbenv/versions/1.9.3-p448/lib/ruby/gems/1.9.1/gems/gssapi-1.1.2/lib/gssapi/lib_gssapi.rb 
```

对于第一个错误，请注释掉周围某处的警告，例如`288`：

```
rescue FFI::NotFoundError => ex
  # warn "WARNING: Could not load IOV methods. Check your GSSAPI C library for an update"
end 
```

对于第二个错误，请注释掉周围某处的警告，例如`300`：

```
rescue FFI::NotFoundError => ex
  # warn "WARNING: Could not load AEAD methods. Check your GSSAPI C library for an update"
end 
```

希望很快会有更好的解决方案，因为我真的不相信修改已安装的 gem - 但这个错误有点太烦人了，不能忽略。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T19:13:49.887

这是来自 WinRM，遗憾的是没有简单的方法来抑制它。只需要`winrm`gem（在 Windows 上工作所必需的）会产生此错误。您可以放心地忽略它。

# iphone - 在现有表视图上创建新行

> ID：13884601
> 
> 赞同：0
> 
> 时间：2012-12-14T18:50:09.910
> 
> 标签：iphone, objective-c, ios, ipad

我有一个 Person 类

```
@interface Person : NSObject

@property (nonatomic, strong) NSString * name;
@property (nonatomic, strong) NSString * area;
@property (nonatomic, strong) int pin;
- (id) initWithName:(NSString *)anName andAreaName:(NSString *)anArea andPin:(int)aPin; 
```

首先，我正在读取一个 sqlite DB 并获取数据列表，即名称、区域和引脚。然后我创建一个 Person 类的对象并将这些获取的项目添加到其中。最后我将此对象添加到一个数组中。现在基于这个数组，我正在创建一个表视图并在表视图的不同行中显示所有这 3 个数据.

但是现在我有一个添加新名称选项，在选择哪个弹出窗口时会出现一个带有文本字段的弹出窗口，并且在选择提交选项时，将在我的表格视图中创建一个只有名称字段的新行。

所以为此我必须更新我的旧数组或更新 initWithName: ？

请指导我如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:16:50.053

您可以按如下方式执行此操作，

步骤1：-

创建一个 Person 对象如下，

```
Person *person = [[Person alloc] initWithName:@"Name" andAreaName:@"" andPin:0]; 
```

您可以稍后添加`area`，`pin`

```
person.area = @"Area";
person.pin = 10;

//or just do, 
Person *person = [[Person alloc] initWithName:@"Name" andAreaName:@"Area" andPin:10];
//if you have Area and Pin already available, you can use the above line itself. 
```

第2步：-

将此添加到表的数据源数组中，

```
[self.array addObject:person]; 
```

第 3 步：-

```
[self.tableView reloadData];//or do an insert row call on this tableview 
```

# android - 动态按钮文字大小

> ID：13884603
> 
> 赞同：0
> 
> 时间：2012-12-14T18:50:21.463
> 
> 标签：android

我想知道如何使按钮文本大小填充按钮的高度。当使用 sp 或 dp 大小的文本时，它适用于小屏幕分辨率（例如 4 英寸屏幕），但在平板电脑屏幕（10 英寸）上，按钮尺寸更大，按钮文本看起来很小）我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-03T07:43:27.543

您可以尝试设置相对于按钮高度的按钮文本大小。

例如：在 XML 中使用按钮的权重来填充整个屏幕（不管屏幕大小）：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" >

 <Button
    android:id="@+id/button1"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1"/>

 <Button
    android:id="@+id/button2"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1" />

</LinearLayout> 
```

在通过覆盖 onwindowfocuschanged 绘制布局后，您可以设置按钮文本的高度（例如按钮高度的 1/3）：

```
 @Override
  public void onWindowFocusChanged (boolean hasFocus) { // the layout is set                
     button1 = (Button)findViewById(R.id.button1);
     int text_height = button1.getHeight()/3;   // define text_height as 1/3 of button height in px
     button1.setTextSize(TypedValue.COMPLEX_UNIT_PX, text_height);  // set text height in px

     button2 = (Button)findViewById(R.id.button2);
     int text_height = button2.getHeight()/3;                   
     button2.setTextSize(TypedValue.COMPLEX_UNIT_PX, text_height);  
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T00:17:41.523

您可以`onDraw()`在 Button 的子项中重载该方法。此[示例](http://catchthecows.com/?p=72)显示如何使用`getTextBounds()`android Paint 类来确定绘制时文本的大小。使用此信息，您可以计算 textSize 和 textScaleX 以用于使您的文本达到您想要的大小。

目标是找到 和 的值，`textSize`这`textScaleX`将调整我们的文本大小以填充我们的视图。我们不会在每次调用 onDraw 时都计算这个值，而是观察大小变化并预先计算值。为此，我们重写 onSizeChanged 以获取新的视图宽度和高度。

```
@Override
protected void onSizeChanged(int w, int h, int oldw, int oldh) {
    super.onSizeChanged(w, h, oldw, oldh);

    // save view size
    mViewWidth = w;
    mViewHeight = h;

    // first determine font point size
    adjustTextSize();
    // then determine width scaling
    // this is done in two steps in case the
    // point size change affects the width boundary
    adjustTextScale();
} 
```

从`onSizeChanged`你必须调用两种方法。第一个确定 textSize 我们使用`getTextBounds()`Paint 对象的方法来确定已知 textSize 的文本大小。从那里我们做一个简单的计算来确定使用什么 textSize 来产生我们想要的文本边界。

```
void adjustTextSize() {
    mTextPaint.setTextSize(100);
    mTextPaint.setTextScaleX(1.0f);
    Rect bounds = new Rect();
    // ask the paint for the bounding rect if it were to draw this
    // text
    mTextPaint.getTextBounds(mText, 0, mText.length(), bounds);

    // get the height that would have been produced
    int h = bounds.bottom - bounds.top;

    // make the text text up 70% of the height
    float target = (float)mViewHeight*.7f;

    // figure out what textSize setting would create that height
    // of text
    float size  = ((target/h)*100f);

    // and set it into the paint
    mTextPaint.setTextSize(size);
} 
```

第二种方法以相同的方式确定 textScaleX 值。我们找到 a`textScaleX`为 1.0 时的大小，然后做一些简单的数学运算来确定什么比例会导致我们想要的边界宽度。这是在文本大小计算的单独调用中完成的，以防万一设置 textSize 影响缩放结果。改变`textScaleX`绝对不会改变绘制文本的高度。

```
void adjustTextScale() {
    // do calculation with scale of 1.0 (no scale)
    mTextPaint.setTextScaleX(1.0f);
    Rect bounds = new Rect();
    // ask the paint for the bounding rect if it were to draw this
    // text.
    mTextPaint.getTextBounds(mText, 0, mText.length(), bounds);

    // determine the width
    int w = bounds.right - bounds.left;

    // calculate the baseline to use so that the
    // entire text is visible including the descenders
    int text_h = bounds.bottom-bounds.top;
    mTextBaseline=bounds.bottom+((mViewHeight-text_h)/2);

    // determine how much to scale the width to fit the view
    float xscale = ((float) (mViewWidth-getPaddingLeft()-getPaddingRight())) / w;

    // set the scale for the text paint
    mTextPaint.setTextScaleX(xscale);
} 
```

最后一个细节是确定在视图中垂直绘制文本的位置。getTextBounds 返回的边界矩形可以帮助解决这个问题。bounds.top 值实际上是一个负值，它表示文本的大小，不包括任何下降部（延伸到基线以下的字母部分）的大小。bounds.bottom 值是下降器的大小。使用这些信息，我们可以决定如何在视图中定位文本。调用 drawText 中的 y 值表示基线。下降线将绘制在这条线的下方。对于这个例子，我们调整 y 值，以便我们显示完整的下降。此值保存为`mTextBaseline`并在 onDraw 中使用。

```
@Override
protected void onDraw(Canvas canvas) {
    // let the ImageButton paint background as normal
    super.onDraw(canvas);

    // draw the text
    // position is centered on width
    // and the baseline is calculated to be positioned from the
    // view bottom
    canvas.drawText(mText, mViewWidth/2, mViewHeight-mTextBaseline, mTextPaint);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:27:30.730

使用 layout_height 中的 wrap_content 来比较 sp 和 dp

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T20:39:35.797

我想通了！

我创建了文件夹：values-ldpi

值-小

正常值

值-大

值-xlarge

在每个文件夹中，我创建了 dimens.xml 文件。

例如 values-small 中的 dimens.xml 文件如下所示：

```
<resources>

 <dimen name="text_button">10sp</dimen>

</resources> 
```

值正常中的 dimens.xml 文件，如下所示：

```
<resources>

<dimen name="text_button">12sp</dimen>

</resources> 
```

然后，您只需将其指向 text_button，而不是使用带有 unit(10sp,10px,10dp) 的按钮文本大小。

# php - 奇怪的 %MINIFYHTML 代码显示在标签之前

> ID：13884604
> 
> 赞同：1
> 
> 时间：2012-12-14T18:50:22.527
> 
> 标签：php, wordpress, minify, cloudflare

以下代码显示在我的 wordpress 网站的某些页面上。

`%MINIFYHTMLba8fd15a026c51b9ab71a637e3fe71401%%MINIFYHTMLba8fd15a026c51b9ab71a637e3fe71402%%MINIFYHTMLba8fd15a026c51b9ab71a637e3fe71403%%MINIFYHTMLba8fd15a026c51b9ab71a637e3fe71404%`

我正在使用论文 2.0 和 wordpress 3.5

由于 % 符号，我无法正确搜索错误。

我已禁用 cloudflare 性能和 w3 总缓存，因此不应进行缓存或缩小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-08T07:56:09.120

尝试禁用您的 W3 缓存（部分：缩小 HTML），然后再次检查。

# forms - 从自定义标签访问 spring:form 对象

> ID：13884605
> 
> 赞同：1
> 
> 时间：2012-12-14T18:50:24.083
> 
> 标签：forms, spring, spring-mvc, jstl

我试图编写一个自定义 jstl 标记以在标记内使用，它需要访问 modelAttribute 对象的属性。到目前为止，我可以将属性的名称传递给我的标签处理程序，但不知道如何访问 modelAttribute。非常感谢任何帮助！NFV

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:54:07.833

在自定义标记上创建一个属性，并使用 JSP EL 将其设置为模型属性。

`<my:customTag modelprop=${modelPropName}/>`

在您的自定义标签中：

```
<%@ attribute name="modelprop" type="com.x.y.MyObj" %> 
```

# android - android 3.0蜂窝，查找和激活小部件

> ID：13884606
> 
> 赞同：0
> 
> 时间：2012-12-14T18:50:25.117
> 
> 标签：android, android-widget, android-3.0-honeycomb, launcher

Android 3.0 激活小部件的方式与 2.x 和 4.x 不同

我试图弄清楚人们如何适应这一点。

基本上在 android 2.x 上，预期的功能是下载小部件并立即可用，并且该`onUpdate`方法已准备好使小部件按需要运行/

在 Android 3.x 上，似乎有几件事不会以同样的方式发生：

*   下载小部件后，它并不总是出现在小部件列表中，直到重新启动后。（我已经看到详细说明“为什么”会发生这种情况的事情，但没有看到为什么其他小部件似乎没有这个问题）

*   在其他情况下，小部件已下载并在小部件列表中可见，但将其添加到启动器屏幕不会激活它。`onUpdate`似乎不起作用，并且触摸事件不活跃，直到重新启动后。

我看过一些帖子，讨论了启动器屏幕首次加载时引导加载程序如何激活小部件，但我看到的小部件没有这个问题。

同样，我使用该逻辑通过更改手机的区域设置来强制启动器屏幕重新加载。但是我希望我创建的小部件可以在没有任何故障排除的情况下使用，这将如何完成？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:09:51.337

对于 HC+，您必须在安装应用程序后至少启动一次与应用程序关联的任何活动，然后它应该会显示在列表中。编辑：SD卡上的应用程序也有问题，请参阅[http://code.google.com/p/android/issues/detail?id=8555](http://code.google.com/p/android/issues/detail?id=8555)

编辑你的也是[App Widget 的副本在启动器重新启动之前不会出现在 Honeycomb 设备上的小部件列表中](https://stackoverflow.com/questions/7736313/app-widget-does-not-appear-in-the-widget-list-on-honeycomb-devices-until-launche)

# mysql - 日志中每天的每周活跃用户

> ID：13884609
> 
> 赞同：2
> 
> 时间：2012-12-14T18:50:36.447
> 
> 标签：mysql, sql, usage-statistics

我想知道是否有人可以帮助我使用一些 SQL 来返回在两天或更长时间内登录到数据库表的唯一用户数量（让我们使用 7 天作为参考）。

我的日志表在每一行中都包含一个时间戳 (ts) 和 user_id，表示当时该用户的活动。

以下查询从此日志返回每日活跃用户或 DAU：

```
SELECT FLOOR(ts / 86400) AS day, COUNT(DISTINCT user_id) AS dau
FROM log
GROUP BY day ORDER BY day ASC 
```

现在假设我想在这个单一查询中添加（或至少以最有效的方式检索）每周活跃用户，或在 7 天内登录的唯一用户总数。但是，我不想在不重叠的几周内分配我的时间。我需要每天计算当天和前 6 天看到的不同 user_id。

例如：

```
day users wau
1   1,2   2
4   1,3   3
7   3,4,5 5
8   5     4    (user_id 2 lost from count)
15  2     2    (user_ids 1,3,4 lost from count) 
```

感谢您提供的任何帮助，如果您需要进一步说明，请随时通过评论询问。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T19:39:52.560

要获得“每周平均用户”计数（根据我对您的规范的理解......“对于每一天，当天和前六天看到的不同 user_ids 的计数”），请按照以下行进行查询可用于。（查询还返回“每日平均用户”计数。

```
SELECT d.day
     , COUNT(DISTINCT u.user_id) AS wau
     , COUNT(DISTINCT IF(u.day=d.day,u.user_id,NULL)) AS dau
  FROM ( SELECT FLOOR(k.ts/86400) AS `day`
           FROM `log` k
          GROUP BY `day`
       ) d
  JOIN ( SELECT FLOOR(l.ts/86400) AS `day`
              , l.user_id
           FROM `log` l
          GROUP BY `day`, l.user_id
       ) u
    ON u.day <= d.day
   AND u.day > d.day - 7
 GROUP BY d.day
 ORDER BY d.day 
```

（我还没有对此进行测试；但我稍后会，如果需要任何更正，我会更新此声明。）

此查询将给定日期（来自行`u`源）的用户列表连接到来自日志表（行`d`源）的一组天。请注意出现在连接谓词（ON 子句）中的文字“7”，这就是使用户列表与前 6 天“匹配”的原因。

请注意，这也可以扩展以获取过去 3 天的不同用户计数，例如，通过在 SELECT 列表中添加另一个表达式。

```
 , COUNT(DISTINCT IF(u.day<=d.day AND u.day>d.day-3,u.user_id,NULL)) AS 3day 
```

可以增加字面“7”以获得更大的范围。并且上面表达式中的文字 3 可以更改为任意天数......我们只需要确保我们有足够的前一天行（来自`d`）连接到来自 的每一行`u`。

性能说明：由于内联视图（或派生表，如 MySQL 所称），此查询可能不会很快，因为这些内联视图的结果集必须具体化到中间 MyISAM 表中。

别名为 as 的内联视图`u`可能不是最佳的；直接加入日志表可能会更快。我正在考虑获取给定日期的唯一用户列表，这就是内联视图中的查询让我得到的。我更容易概念化正在发生的事情。而且我在想，如果一天有数百个相同的用户输入，那么在我们加入其他日子之前，内联视图会清除一大堆重复项。一个 WHERE 子句来限制我们返回的天数最好添加到`u`内`d`联视图中。（`d`内联视图需要包含额外的前 6 天。）

* * *

另一方面，如果 ts 列是 TIMESTAMP 数据类型，我会更倾向于使用`DATE(ts)`表达式来提取日期部分。但这将在结果集中返回 DATE 数据类型，而不是整数，这与您指定的结果集不同。）

```
SELECT d.day
     , COUNT(DISTINCT u.user_id) AS wau
     , COUNT(DISTINCT IF(u.day=d.day,u.user_id,NULL)) AS dau
  FROM ( SELECT DATE(k.ts) AS `day`
           FROM `log` k
          GROUP BY `day`
       ) d
  JOIN ( SELECT DATE(l.ts) AS `day`
              , l.user_id
           FROM `log` l
          GROUP BY `day`, l.user_id
       ) u
    ON u.day <= d.day
   AND u.day > DATE_ADD(d.day, INTERVAL -7 DAY)
 GROUP BY d.day
 ORDER BY d.day 
```

* * *

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:48:42.160

这是另一个很好的例子，说明为什么应该使用日期、日期时间或时间戳字段类型来表示数据库中的时间值而不是 unix 时间戳。总是有人想实际查询该字段，然后您不得不进行一堆时间戳转换，因为整数时间戳值没有时间段的固有概念，您需要根据时间段进行查询。在此过程中，您将失去任何利用字段索引的能力。

无论如何，这是您想要做的一个相当复杂的查询。可能有比我建议的更好的方法，但希望我的建议至少是有意义的。在这种方法中，您将通过将表连接到自身来执行笛卡尔连接。然后，您通过使用`ON`条件来限制记录数，以确保第二个日志表中的日期在第一个日志表中日期的 7 天期限内。最后，您进行聚合和分组。查询可能如下所示：

```
SELECT DATE(FROM_UNIXTIME(log1.ts)) as `day`, COUNT(DISTINCT log2.user_id) as `dau`
FROM log AS log1
INNER JOIN log AS log2
ON DATE(FROM_UNIXTIME(log2.ts)) <= DATE(FROM_UNIXTIME(log1.ts))
AND DATE(FROM_UNIXTIME(log2.ts)) >= DATE_SUB(DATE(FROM_UNIXTIME(log1.ts)), INTERVAL 7 DAY)
GROUP BY `day`
ORDER BY `day` ASC 
```

虽然是一个警告。如果您有相当数量的日志条目，则此查询将需要很长时间才能运行，因为您将结果集中的记录数乘以某个因子，并且您不会使用索引。

您最好的选择可能是在表中实际创建一个新的日期格式列并运行更新以填充该值。确保您在该字段上有一个索引。然后您的查询可能如下所示：

```
SELECT log1.date_field as `day`, COUNT(DISTINCT log2.date_field) as `dau`
FROM log AS log1
INNER JOIN log AS log2 
ON log2.date_field <= log1.date_field
AND log2.date_field >= DATE_SUB(log1.date_field, INTERVAL 7 DAY)
GROUP BY `day`
ORDER BY `day` ASC 
```

然后，您可以在以后的所有日志条目中填充此字段。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T04:27:38.903

获取整周活跃用户的方法简单明了：

从日志组中选择 yearweek(ts) 作为 yearwk，user_id，count(user_id) 作为weeklyactiveusers 由 1,2 具有 count(user_id) =7；

# ruby-on-rails - Rails：按实例方法过滤的模型范围

> ID：13884614
> 
> 赞同：3
> 
> 时间：2012-12-14T18:50:58.880
> 
> 标签：ruby-on-rails

我有一个 Cover 模型，在`cover.rb`文件中，我还定义了一个名为的方法，该方法`size`返回一个表示“小、中、大”的整数。我的问题是如何检索所有小/中/大封面？我的猜测是使用`scope`，但我不知道如何将`size`方法作为条件传递。

```
class Cover < ActiveRecord::Base
  attr_accessible :length, :width

  # TODO
  scope :small
  scope :intermediate
  scope :large

  # I have simplified the method for clarity.
  # 0 - small; 1 - intermediate;  2 - large
  def size
    std_length = std_width = 15
    if length < std_length && width < std_width
      0
    elsif length > std_length && width > std_width
      2
    else
      1
    end
  end

end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:55:33.080

这可以工作：

```
class Cover < ActiveRecord::Base
  attr_accessible :length, :width

  scope :of_size, lambda{ |size| 
                          case size
                            when :small
                              where('width < 15 AND height < 15')
                            when :large
                              where('width > 15 AND height > 15')
                            when :intermediate
                              where('(width < 15 AND height > 15) OR (width > 15 AND height < 15)')
                            else
                              where(id: -1) # workaround to return empty AR::Relation
                        }

  def size
    std_length = std_width = 15
    return :small if length < std_length && width < std_width
    return :large if length > std_length && width > std_width
    return :intermediate
  end

end 
```

并像这样使用它：

```
Cover.of_size(:small) # => returns an array of Cover with size == small 
```

为了使它与几个参数一起工作：

```
# in the model:
scope :of_size, lambda{ |*size| all.select{ |cover| [size].flatten.include?(cover.size) } }
# how to call it:
Cover.of_size(:small, :large) # returns an array of covers with Large OR Small size 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T18:57:39.200

我认为您最简单的解决方案是类方法：

```
def self.small
  Cover.all.select {|c| c.size == 0}
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T23:08:22.910

如果您正在考虑传递三种尺寸之一，您不妨调用三种范围之一。它会更具可读性。

```
scope :small, where('width < 15 AND height < 15')
scope :large, where('width > 15 AND height > 15')
scope :intermediate, where('(width < 15 AND height > 15) OR (width > 15 AND height < 15)') 
```

# c# - 通过 TaskScheduler.dll 创建的任务因异常而失败 - 传递给系统调用的数据区域太小

> ID：13884617
> 
> 赞同：0
> 
> 时间：2012-12-14T18:51:04.817
> 
> 标签：c#, scheduled-tasks

我使用`TaskScheduler.dll`(1.0) 创建和注册任务。它注册任务并在我的机器上运行。但是当我将可执行文件部署到它抛出的差异机器时，异常 - 传递给系统调用的数据区域太小。（例外`HRESULT: 0x8007007A`）。

我能弄清楚的是用户信息未能传递给 API，但不知道为什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T18:56:58.713

该错误是由于操作系统的限制（取决于使用的 Windows 版本！）对于具有用户凭据的任务......基本上你需要停止任务计划程序服务并重新启动它，等待 10-15 分钟，然后再试一次。 ..

有关详细信息，请参阅此[MS 知识库文章](http://support.microsoft.com/kb/264522/en-us)。

# ruby-on-rails - flash helper 中的 html 显示在我的 Rails 3 显示页面中

> ID：13884620
> 
> 赞同：0
> 
> 时间：2012-12-14T18:51:33.367
> 
> 标签：ruby-on-rails

我在 application_helper 中创建了一个助手来显示我的 Flash 消息。该代码基于我在 Stack Overflow 上找到的代码，并进行了修改：

```
 def show_flash
     flash_names = [:notice, :warning, :message, :error]
     flash_html = ''
     for name in flash_names
       if flash[name]
         flash_html = flash_html + "<div class=\"#{name}\">#{flash[name]}</div>"
       end
       flash[name] = nil;
     end
     flash_html
   end 
```

当我运行它时，我得到的不是我的页面上的 flash 消息，而是我的 show_flash 助手生成的实际 html，包括所有标记：

```
 <div class="notice">Item was successfully updated.</div> 
```

我的 application.html.erb 文件如下所示：

```
 <!DOCTYPE html>
 <html>
 <head>
   <title>My Application</title>
   <%= stylesheet_link_tag    "application" %>
   <%= javascript_include_tag "application" %>
   <%= csrf_meta_tags %>
 </head>
 <body>
<h1 align="center">Welcome to XYZ Application</c></h1>
<%= show_flash %>

 <%= yield %>

 </body>
 </html> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:58:23.693

您需要添加`.html_safe`以使其视为 HTML 元素

```
def show_flash
   flash_names = [:notice, :warning, :message, :error]
   flash_html = ''
   for name in flash_names
     if flash[name]
       flash_html = flash_html + "<div class=\"#{name}\">#{flash[name]}</div>"
     end
     flash[name] = nil;
   end
   flash_html.html_safe # added this to make it appear as an HTML element instead of as real string
 end 
```

您可以在这个问题中看到不同的选项，[raw vs. html_safe vs. h to unescape html](https://stackoverflow.com/questions/4251284/raw-vs-html-safe-vs-h-to-unescape-html)。您提到的代码可能是在 Rails 2 中编写的。在 Rails 3 中，在 html 页面中输出的任何字符串默认都是 HTML 转义的。在 Rails 2 中，我们需要使用`h`helper 来转义 HTML，但在 Rails 3 中，它默认是转义的。因此，如果您确实需要显示未转义的 HTML，则需要使用`raw`或`.html_safe`. `raw`只能从视图和控制器中调用，因此在帮助程序中，您可以使用`html_safe`.

# memory - 转换虚拟地址和物理地址

> ID：13884622
> 
> 赞同：1
> 
> 时间：2012-12-14T18:51:42.387
> 
> 标签：memory, memory-address

所以我真的不明白这个。谁能解释如何解决这些问题？

假设我们有一个带有基于分页的内存系统的 32 位 CPU。页面大小为 4KB(2^12)。现在 CPU 生成一个虚拟地址 0x0000AAA

1.) 这个虚拟地址的虚拟页号是多少？什么是页面偏移量？

2.) 使用下面的页表，将上述虚拟地址转换为物理地址 - 以十六进制表示。页表显示前 5 个条目。

0 - 0xAAAAA 1 - 0xBBBBB 2 - 0xCCCCC 3 - 0xDDDDD 4 - 0xEEEEE

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:24:36.807

如果一个页面的大小是 4KB（= 4096 字节），这意味着从 0 到包括 4095 (0x00000fff) 的所有地址都在第一页中。

0x0000aaa 小于 0x00000fff，所以这仍然在第一页（第 0 页）。

要获取与虚拟地址 0x00000aaa 对应的物理地址，请查找页面 #0 的前缀，即 0xAAAAA。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-28T08:09:30.387

由于给定页面大小为 4 KB，这意味着一个页面有 4K 个地址。因此，我们需要 12 位来到达页面中的每个地址。
因此，页偏移量 = 12 位。
由于系统是 32 位的，因此 20 位将用作页码。
由于页面大小等于帧大小，因此帧偏移量 = 12 位。
现在，使用页表来获取物理地址。

# jquery - 将数组保存到 cookie，然后将其加载回数组

> ID：13884623
> 
> 赞同：0
> 
> 时间：2012-12-14T18:52:03.537
> 
> 标签：jquery, jquery-ui, jquery-plugins

这是交易。此代码应该将变量 'item' 推送到数组 'savedList'

```
 $(document).ready(function() {
var savedList = [];
 $('#button').click(function (){
    var toAdd = $('input[id=newItem]').val();
    if (toAdd =="") 
    {
        return toAdd
    } else {
    var item = '<div class="item">'+toAdd+'</div>';
    $('.shoppingScroll').prepend(item);
    $('#counter').html('You have ' + $('.item').size() + ' item(s) in you   list');
            savedList.push(item);

    } 
```

});

据我了解，这应该将所有“.items”推送到我的数组中，包括类规范。问题是如何将其保存到 cookie 中，然后在页面开始时加载。我将 jQuery cookie 插件附加到我的页面，但在查看文档后无法弄清楚如何使用它。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T18:59:17.393

非常基本和粗略的代码看起来像：

```
$(document).ready(function() {
    var savedList = [];
    $('#button').on('click', function (){
        var toAdd = $('input[id=newItem]').val();
        if (toAdd =="") {
            return toAdd
        } else {
            var item = '<div class="item">'+toAdd+'</div>';
            $('.shoppingScroll').prepend(item);
            $('#counter').html('You have ' + $('.item').size() + ' item(s) in you   list');
            savedList.push(item);
            $.cookie('list', savedList);
        }
    });

    if($.cookie('list')) {
        $.each($.cookie('list'), function(index, val){
            console.log(val)
        });
    }
}); 
```

# c# - 实体框架：手动设置实体状态恢复值

> ID：13884624
> 
> 赞同：4
> 
> 时间：2012-12-14T18:52:11.813
> 
> 标签：c#, asp.net, .net, entity-framework

我以断开连接的方式使用 EF5。我有一个名为`Cases`查找表的主表，用于定义关联的各种事物。例如，该列`SOURCE_ID`与一个`Sources`表相关联，该表包含查找。

在我的实体中，`Cases`我有 Source_ID 列以及调用关联和导航属性`Source`以导航到关联表。

由于我以断开连接的方式使用事物，所以当我想保存实体时，我手动将状态设置为`Added`至`Modified`。这很好用（遵循 Julie Lermon 书中的一些例子）。

但是发生的情况是，如果我将`SOURCE_ID`列更改为不同的值并且关联的表加载了实体，当我将状态更改为 时`MODIFIED`，`SOURCE_ID`恢复到原始值，大概是因为关联。

我正在加载关联的`SOURCES`表，因为我想显示该表中的其他内容，但我只想更改`SOURCE_ID`并保存它。好像不太喜欢。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T23:35:37.733

需要更多代码，但我会试一试。

尝试更新您对 Sources 查找的引用，而不是仅仅更新 SOURCE_ID。

所以代替....

```
Case.Source.ID = 1; 
```

也许....

```
Case.Source = db.Sources.Where(x => x.SOURCE_ID == 1).FirstOrDefault(); 
```

（编辑：哦，这是一个月前问的？哎呀。好吧，仍然。）

# gridview - 在 ASP.NET 中使用 VS 2010 在 Gridview 中检查 CheckBoxField

> ID：13884627
> 
> 赞同：1
> 
> 时间：2012-12-14T18:52:23.120
> 
> 标签：gridview, checkbox

我正在尝试有一个带有复选框字段的gridview，用于标识该行是否已完成。但是，当 gridview 加载时，复选框显示为灰色，并且当我使用“编辑”链接通过检查更新记录时，检查不会保存在复选框中。有任何想法吗？

# dynamic - 动态帮助页面内容应该存储在数据库还是 HTML 文件中？

> ID：13884633
> 
> 赞同：0
> 
> 时间：2012-12-14T18:52:41.780
> 
> 标签：dynamic, asp.net-webpages

因此，我试图想出一种更好的方法来创建一个动态帮助模块，该模块为网站的每个页面显示一个不同的帮助页面。目前有一个 help.aspx，它有一个标题和 div 部分，由获取数据库记录的方法填充。每个 DB 记录都存储为带有特定帮助内容的 html。现在，这是可行的，但是当您必须查找并更新 1 个或多个 DB 记录时，例如图像、更改或文本必须被编辑时，维护起来是一件非常痛苦的事情。相反，我在想，我可以构建一个基本上显示/隐藏面板的 html 页面，并且每个面板内部都有适当的帮助内容。只要您遵循正确的命名约定（将面板 ID 命名为它所代表的页面/内容），使用 ctrl + f 就会将您带到您需要去的地方，并使您更容易找到所需的内容。我什么 我很好奇这会对性能产生影响吗？html 页面将是一个相当大的文件，将在服务器上托管/运行，但它也将消除对数据库调用的需要。这项工作是否值得在这里受益，或者我是否正在重新发明轮子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:10:01.900

动态的任何东西都应该存储在数据库中。一个真正可用的 Web 应用程序永远不需要修改代码来更改内容。隐藏内容通常不是一个好主意，想象一下，如果您将应用程序扩展到 100 个需要自己的帮助页面的不同页面。然后当有人点击帮助时，他们的浏览器必须加载 99 个隐藏页面才能获得 1 个它会显示。您需要将帮助页面分解为多个部分，并将纯文本存储在数据库中。我需要更多地了解您使用的语言以及您使用的架构来进一步阐述，但请看下面。

您描述的需求几乎就是 MVC（Web 应用程序架构类型）的构建目的。

如果您已经在使用 ASP.net 并且您的项目还不太远，我会考虑切换到 MVC。这是一个专门为动态页面内容而构建的架构。您构建不同的“视图”（MVC 中的 V），它们将根据从控制器（MVC 中的 C）接收到的内容动态构建 HTML，控制器从数据库/模型（M）中提取数据并对其进行修改风景。此外，一旦您进入 MVC，您可以将它与 Razor 结合使用，并且一半的代码会为您编写。这是一件美妙的事情。

[http://www.asp.net/mvc](http://www.asp.net/mvc)

# javascript - 使用 javascript 和 jQuery .each() 循环应用 CSS 转换属性的问题

> ID：13884634
> 
> 赞同：3
> 
> 时间：2012-12-14T18:52:45.383
> 
> 标签：javascript, jquery, css, css-transitions, webkit-transition

为了创建一些 swooshey 菜单，我正在尝试`<li>`使用 jQuery 在元素上设置 CSS 过渡属性。HTML 如下所示：

```
<ul class="main-nav">
  <li>
    <a href="#">Top Level 1</a>
    <ul class="main-nav-child">
      <li><a href="#">Second Level 1</a></li>
      <li><a href="#">Second Level 2</a></li>
      <li><a href="#">Second Level 3</a></li>
      <li><a href="#">Second Level 4</a></li>
      <li><a href="#">Second Level 5</a></li>
    </ul>
  </li>
  <li>
    <a href="#">Top Level 2</a>
    <ul class="main-nav-child">
      ...
    </ul
  </li>
</ul> 
```

我正在尝试对 中的`"transform 0.3s ease-in-out XXXXs, padding-left 0.1s ease"`每个元素应用过渡`.main-nav-child`，其中 XXX 为菜单中的每个项目增加。

我正在使用一个`.each()`循环来迭代每个顶级列表项，然后在其中的另一个循环迭代内部列表中的项目。然后我尝试使用 javascript 设置转换：

```
$('.main-nav > li').each(function(i, child) {
  $(child).find(".main-nav-child li").each(function(j, c) {
    c.style.WebkitTransition = "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
    c.style.MozTransition    = "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
    c.style.MsTransition     = "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
    c.style.OTransition      = "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
    c.style.transition       = "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease"
  });
}); 
```

读完后[，](https://stackoverflow.com/questions/10237731/css3-transitions-inside-jquery-css)我尝试使用 jQuery 的`.css`方法：

```
$('.main-nav > li').each(function(i, child) {
  $(child).find(".main-nav-child li").each(function(j, c) {
    $(c).css({
      WebkitTransition : "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
      MozTransition    : "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
      MsTransition     : "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
      OTransition      : "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease",
      transition       : "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease"
    });
  });
}); 
```

我也尝试过使用 CSS 样式而不是 DOM 样式属性名称：

```
$('.main-nav > li').each(function(i, child) {
  $(child).find(".main-nav-child li").each(function(j, c) {
    $(c).css("-webkit-transition", "transform 0.3s ease-in-out " + 2*(j+1) +"s, padding-left 0.1s ease");
  });
}); 
```

## 问题

The loops seem to work fine, and after much fiddling with Chrome's web inspector, it seems that when I try to set `c.style.WebkitTransition` to something, it works, but the property isn't stored. It does the same in the console (se here: [http://cl.ly/Lbau](http://cl.ly/Lbau))

I'm been playing around with this for the better part of half a day, so if anyone can help me out I'd be most appreciative!

Cheers.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:04:21.533

Transform isn't a supported animation property yet. [Source](http://www.w3.org/TR/css3-transitions/#animatable-properties)

Take out the transform setting and it should set just fine.

# java - 使用 spring-data-mongodb 持久化包含原始数组的对象

> ID：13884637
> 
> 赞同：0
> 
> 时间：2012-12-14T18:53:05.960
> 
> 标签：java, arrays, spring-data, mongodb-java, spring-data-mongodb

我正在使用`spring-data-mongodb`版本`1.1.1.RELEASE`。如果所有成员变量都是原始类型，即使参数的名称与使用和注释 `@PersistenceConstructor`的成员变量的名称不完全匹配，我也能够持久化一个对象。`@Field("foo")``@Value("#root.foo")`

但是，`MappingInstantiationException`当我尝试持久化包含原始数组的对象时，我得到一个（构造函数的非法参数）。无论原始数组是否包含原始数组或对象，这都是正确的。这是一个错误`spring-data-mongodb`还是我做错了什么？

我在下面包含了三个依赖于`junit`and的单元测试`spring-data-mongodb`。测试显示了三件事：

*   包含对象集合的持久对象按预期工作
*   包含基元数组的持久对象*无法*按预期工作
*   包含对象数组的持久对象*无法*按预期工作

.

```
public class SpringSourceTest {

    private static final String DATABASE_HOST = "localhost";
    private static final String DATABASE_NAME = "testdb";
    private static Mongo s_mongo = null;
    private static MongoOperations s_mongoOperations;

    @BeforeClass
    public static void setUpBeforeClass() {
        try {
            s_mongo = new Mongo(DATABASE_HOST);
        }
        catch (UnknownHostException e) {
            e.printStackTrace();
        }
        assertNotNull(s_mongo);
        s_mongoOperations = new MongoTemplate(s_mongo, DATABASE_NAME);
        assertNotNull(s_mongoOperations);
    }

    @AfterClass
    public static void tearDownAfterClass() {
        s_mongo.dropDatabase(DATABASE_HOST);
        s_mongo.close();
    }

    @Test
    public void testCollectionContainer() {
        System.out.println("---------------testCollectionContainer-----------------");
        List<Integer> intList = new ArrayList<Integer>();
        intList.add(1);
        intList.add(2);
        CollectionContainer collectionContainer = new CollectionContainer(intList);
        testObject(collectionContainer);
    }

    @Test
    public void testArrayContainer() {
        int[] properties = new int[]{100, 50};
        System.out.println("----------------testArrayContainer----------------");
        ArrayContainer arrayContainer = new ArrayContainer(properties);
        testObject(arrayContainer);
    }

    @Test
    public void testArrayObjectContainer() {
        System.out.println("----------------testArrayObjectContainer----------------");
        Integer[] properties = new Integer[]{new Integer(100), new Integer(50)};
        ArrayObjectContainer arrayObjectContainer = new ArrayObjectContainer(properties);
        testObject(arrayObjectContainer);
    }

    private void testObject(Object a_object) {
        assertNotNull(a_object);
        System.out.println("OLD OBJECT: " + a_object);
        Class<?> objectClass = a_object.getClass();
        s_mongoOperations.dropCollection(objectClass);
        s_mongoOperations.createCollection(objectClass);
        s_mongoOperations.insert(a_object);
        List<?> createdObjects = null;
        try {
            createdObjects = s_mongoOperations.findAll(objectClass);
            for (Object createdObject : createdObjects) {
                System.out.println("NEW OBJECT: " + createdObject);
                assertNotNull(createdObject);
                assertEquals(a_object, createdObject); 
            }   
        }
        catch (Exception e){
            System.out.println("FAILED TO RETRIEVE: " + objectClass);
            System.out.println(e.getMessage().toString());
            fail();
        }
        s_mongoOperations.dropCollection(objectClass);
    }

    @Document
    public static class CollectionContainer {
        @Field("property") private final List<Integer> m_property;

        @PersistenceConstructor
        public CollectionContainer(@Value("#root.property") List<Integer> a_property) {
            validateNotNull(a_property);
            m_property = a_property;
        }

        private void validateNotNull(List<Integer> a_property) {
            assertNotNull(a_property);
        }

        public List<Integer> property() {
            return m_property;
        }

        @Override
        public boolean equals(Object a_obj) {
            if (this == a_obj) {
                return true;
            }
            if ((a_obj == null) || getClass() != a_obj.getClass()) {
                return false;
            }
            final CollectionContainer other = (CollectionContainer) a_obj;
            for (int i = 0; i < m_property.size(); i++) {
                if (!m_property.get(i).equals(other.property().get(i))) {
                    return false;
                }
            }
            return true;
        }

        @Override
        public int hashCode() {
            final int prime = 31;
            int result = 1;
            result = prime * result + m_property.hashCode();
            return result;
        }

        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append("CollectionContainer={")
                    .append("m_property=").append(m_property)
                    .append("}").toString(); 
            return sb.toString();
        }
    }

    @Document
    public static class ArrayContainer {
        @Field("property") private final int[] m_property;

        @PersistenceConstructor
        public ArrayContainer(@Value("#root.property") int[] a_property) {
            validateNotNull(a_property);
            m_property = a_property;
        }

        private void validateNotNull(int[] a_property) {
            assertNotNull(a_property);
        }

        public int[] property() {
            return m_property;
        }

        @Override
        public boolean equals(Object a_obj) {
            if (this == a_obj) {
                return true;
            }
            if ((a_obj == null) || getClass() != a_obj.getClass()) {
                return false;
            }
            final ArrayContainer other = (ArrayContainer) a_obj;
            for (int i = 0; i < m_property.length; i++) {
                if (m_property[i] != other.property()[i]) {
                    return false;
                }
            }
            return true;
        }

        @Override
        public int hashCode() {
            final int prime = 31;
            int result = 1;
            result = prime * result + m_property.hashCode();
            return result;
        }

        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append("ArrayContainer={");
            sb.append("m_property=[");
            for (int i = 0; i < m_property.length; i++) {
                sb.append(m_property[i]).append(",");
            }
            sb.append("]}").toString(); 
            return sb.toString();
        }
    }

    @Document
    public static class ArrayObjectContainer {
        @Field("property") private final Integer[] m_property;

        @PersistenceConstructor
        public ArrayObjectContainer(@Value("#root.property") Integer[] a_property) {
            validateNotNull(a_property);
            m_property = a_property;
        }

        private void validateNotNull(Integer[] a_property) {
            assertNotNull(a_property);
        }

        public Integer[] property() {
            return m_property;
        }

        @Override
        public boolean equals(Object a_obj) {
            if (this == a_obj) {
                return true;
            }
            if ((a_obj == null) || getClass() != a_obj.getClass()) {
                return false;
            }
            final ArrayObjectContainer other = (ArrayObjectContainer) a_obj;
            for (int i = 0; i < m_property.length; i++) {
                if (!m_property[i].equals(other.property()[i])) {
                    return false;
                }
            }
            return true;
        }

        @Override
        public int hashCode() {
            final int prime = 31;
            int result = 1;
            result = prime * result + m_property.hashCode();
            return result;
        }

        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append("ArrayObjectContainer={");
            sb.append("m_property=[");
            for (int i = 0; i < m_property.length; i++) {
                sb.append(m_property[i]).append(",");
            }
            sb.append("]}").toString(); 
            return sb.toString();
        }
    }
} 
```

我得到的异常的堆栈跟踪也在下面列出。

```
org.springframework.data.mapping.model.MappingInstantiationException: Could not instantiate bean class [com.recorder.SpringSourceTest$ArrayContainer]: Illegal arguments for constructor; nested exception is java.lang.IllegalArgumentException: argument type mismatch
        at org.springframework.data.convert.ReflectionEntityInstantiator.createInstance(ReflectionEntityInstantiator.java:77)
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:229)
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:209)
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:173)
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:169)
        at org.springframework.data.mongodb.core.convert.MappingMongoConverter.read(MappingMongoConverter.java:72)
        at org.springframework.data.mongodb.core.MongoTemplate$ReadDbObjectCallback.doWith(MongoTemplate.java:1820)
        at org.springframework.data.mongodb.core.MongoTemplate.executeFindMultiInternal(MongoTemplate.java:1542)
        at org.springframework.data.mongodb.core.MongoTemplate.findAll(MongoTemplate.java:1064)
        at com.recorder.SpringSourceTest.testObject(SpringSourceTest.java:82)
        at com.recorder.SpringSourceTest.testArrayContainer(SpringSourceTest.java:62)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:601)
        at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:44)
        at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
        at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:41)
        at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
        at org.junit.runners.BlockJUnit4ClassRunner.runNotIgnored(BlockJUnit4ClassRunner.java:79)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:71)
        at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:49)
        at org.junit.runners.ParentRunner$3.run(ParentRunner.java:193)
        at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:52)
        at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:191)
        at org.junit.runners.ParentRunner.access$000(ParentRunner.java:42)
        at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:184)
        at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
        at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:31)
        at org.junit.runners.ParentRunner.run(ParentRunner.java:236)
        at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
        at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
        at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
    Caused by: org.springframework.beans.BeanInstantiationException: Could not instantiate bean class [com.recorder.SpringSourceTest$ArrayContainer]: Illegal arguments for constructor; nested exception is java.lang.IllegalArgumentException: argument type mismatch
        at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:158)
        at org.springframework.data.convert.ReflectionEntityInstantiator.createInstance(ReflectionEntityInstantiator.java:75)
        ... 35 more
    Caused by: java.lang.IllegalArgumentException: argument type mismatch
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
        at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:147)
        ... 36 more 
```

# ironpython - 未解决的导入 PyDev/IronPython

> ID：13884640
> 
> 赞同：3
> 
> 时间：2012-12-14T18:53:16.453
> 
> 标签：ironpython, pydev

我在 Windows XP (SP3) 系统上安装了 Aptana Studio 3 和 Eclipse 4.2.1（带 PyDev 和 PyDev 扩展）。我未能成功加载外部 .NET 程序集。给定包含命名空间的程序集 myassembly.dll `myNameSpace`，我设置了一个新项目，并选择了 IronPython 解释器。在我的项目的 src 文件夹中，我创建了一个包含 3 个语句的 Python 文件“Test.py”：

```
import clr
clr.AddReferenceToFile('myassembly.dll')
import myNameSpace 
```

我总是在 Aptana Studio 和 Eclipse 的第三条语句中得到一个未解决的导入

1.  我修改了第二条语句以使用`clr.AddReferenceToFileAndPath('Fully qualified path and file name')`

2.  我还尝试将路径添加到外部库并将我的程序集放在该库中，结果相同。

这 3 条语句在 IronPython 控制台中执行良好。此外，.NET System 和其他模块的导入工作正常。但大概这些模块已在 GAC 中注册。

这似乎是 IronPython 解释器和 final 所独有的`PYTHONPATH`。我有对项目 src 文件夹和外部源文件夹的路径引用，它们都包含程序集。我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T18:18:46.900

[我还没有实际测试过，但是强制内置函数通常是这种情况（请参阅http://pydev.org/manual_101_interpreter.html](http://pydev.org/manual_101_interpreter.html)上的强制内置函数部分）。

不过，它不会这样做：

```
import clr
clr.AddReferenceToFile('myassembly.dll') 
```

所以，如果这不是真的需要，你可以编辑文件：eclipse\plugins\org.python.pydev_XXX\pysrc\pycompletionserver.py

并添加该代码（在 if sys.platform == "darwin" 之前）以便导入在强制内置函数中工作。

# c++ - 在另一个类中初始化的类，它如何生存？

> ID：13884641
> 
> 赞同：0
> 
> 时间：2012-12-14T18:53:21.280
> 
> 标签：c++, class

所以我有一个名为 List 的类，它存储一个指向 Object 类型的类的指针向量。List 有一个名为 add 的函数，它初始化一个 Object 类并将它的指针添加到向量。我认为一旦 add 函数结束，Object 类将被破坏并且访问指针会导致异常。当我编写一个测试程序来测试它时，结果证明 Object 类从未被破坏。

一旦函数结束，函数内部初始化的类是否会被销毁？

类什么时​​候自动销毁？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T18:57:15.120

取决于您如何创建对象。如果你这样做：

```
void add() {
  Object obj;
  vec.push_back(&obj);
} 
```

然后，您将`obj`使用*自动存储持续时间*进行创建。这意味着它将在`add`函数结束时被销毁。您推入向量中的指针将不再指向有效的`Object`，因此绝对不要这样做。

但是，您可能会这样做：

```
void add() {
  Object* obj = new Object();
  vec.push_back(obj);
} 
```

如果是，则您正在创建`Object`具有*动态存储持续时间*的对象，并且它不会在函数结束时被销毁。您推入向量的指针将保持有效。但是，如果您这样做，您需要在`delete`以后记住该对象。如果你不这样做，你就会有泄漏。

如果可以的话，最好的选择是完全避免使用指针。只需制作向量 a`std::vector<Object>`并将对象复制到其中：

```
void add() {
  vec.push_back(Object());
} 
```

或者在 C++11 中：

```
void add() {
  vec.emplace_back();
} 
```

如果您真的需要指针，请选择智能指针。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-14T19:07:08.827

在 C++ 中，如果您不使用任何内存管理器、智能指针或某种“托管”环境，则使用关键字*new*创建的类。为避免误解，您能否发布 Object 和方法 List.Add 的构造函数？

因此，当您创建新对象时，例如：

```
Object* o = new Object(); 
```

您在堆中保留空间并将指向该空间的指针存储在指针'o'中。如果你从不打电话

```
delete o; 
```

明确地你的对象永远不会被删除。

# c# - XNA-寻找算法

> ID：13884645
> 
> 赞同：2
> 
> 时间：2012-12-14T18:53:42.437
> 
> 标签：c#, algorithm, xna-4.0

在过去的几周里，我一直在努力寻找一种可以帮助我完成的算法，乍一看，关于`Vector3's`. 所以，我得到了这个由 5 个立方体组成的物体（2 个**侧面**，1 个**顶部**，1 个**底部**，1 个**背面**，（并且可能会有**前面**的立方体））。现在我想做到这一点，所以当我想要`Scale(2,1,1);`整个对象时，让我们说仅在**顶部的****X**轴上，**底部**的立方体会被缩放。**侧面**立方体应该只改变它们的位置（所以它们的X**尺寸**保持完全相同）。问题出在**后面************边。因为它没有完全覆盖背面，所以如果我要`Scale(2,1,1);`它，它会在每一侧留下这个间隙，这是我不想要的。所有轴都应遵循相同的原则。对于**Y**，我会`Scale();`使用侧面立方体，只移动顶部和底部的立方体，并在背面应用这个不同的比例。对于**Z**轴，我会`Scale();`同时使用**侧边**、**顶部**和**底部**立方体，并且只移动**后**立方体。**********

 ****以下是示例对象的图像：

**物体背面：**

[http://img33.imageshack.us/img33/3125/backyd.png](http://img33.imageshack.us/img33/3125/backyd.png)

**物体侧面：**

[http://img801.imageshack.us/img801/6796/fromtheside.png](http://img801.imageshack.us/img801/6796/fromtheside.png)

**物体正面：**

[http://img688.imageshack.us/img688/281/frontxh.png](http://img688.imageshack.us/img688/281/frontxh.png)

希望你能帮忙，

* * *

**编辑：** 对不起，我不够清楚，当我`Scale();`是一个对象时，让我们在**X**轴上说，就像我之前说的那样只想`Scale();`顶部**和**底部**的**立方体。现在，关于**侧面立方体，我想移动它们，以便它们像以前一样定位，在本例中位于****顶部**和**底部**立方体的两端。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T05:15:40.650

为整个数组创建一个父矩阵并对其进行缩放是否可以接受？或者您是否担心保留墙壁的厚度？****

# ffmpeg - 高清 FLV 视频播放缓慢

> ID：13884648
> 
> 赞同：0
> 
> 时间：2012-12-14T18:53:50.027
> 
> 标签：ffmpeg, flv

我有一些从实时流媒体服务器捕获的视频，它们是 FLV 格式的。现在，问题是，虽然视频被完全捕获，但是当我在 VLC 媒体播放器中播放它们时，它们播放得非常慢，几乎像幻灯片一样逐帧播放。

以下是我使用 ffmpeg 获得的视频的视频编解码器、音频编解码器、比特率和其他详细信息的详细信息：

```
[flv @ 0051e9a0] Invalid keyframes object, skipping.
[flv @ 0051e9a0] Keyframe index parsing failed
Input #0, flv, from 'tofix.flv':
  Metadata:
    audiodelay      : 0
    audiosize       : 6607344
    canSeekToEnd    : false
    datasize        : 271773993
    hasAudio        : true
    hasCuePoints    : false
    hasKeyframes    : true
    hasMetadata     : true
    hasVideo        : true
    lastkeyframetimestamp: 424
    lasttimestamp   : 425
    metadatacreator : inlet media FLVTool2 v1.0.6 - http://www.inlet-media.de/fl
vtool2
    videosize       : 265143027
  Duration: 00:07:04.62, start: 0.000000, bitrate: 1903 kb/s
    Stream #0:0: Video: flv1, yuv420p, 960x540, 5112 kb/s, 29.97 tbr, 1k tbn, 1k
 tbc
    Stream #0:1: Audio: mp3, 44100 Hz, stereo, s16, 112 kb/s
At least one output file must be specified 
```

比特率为 1903 kbps，编解码器为 flv1。

我还从服务器捕获了一些其他视频，这些视频采用 h.264 编解码器，比特率为 563 kbps，并且可以正常播放。

有没有办法可以在我的媒体播放器中流畅地播放这些高清 FLV 文件？

如果这是可能的，那就太好了。

我曾尝试使用 ffmpeg 将 FLV 视频转换为 AVI，但问题仍然存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T23:36:23.457

你的容器说 1 fps [1 tbn] 所以它以 1 fps 播放。将它们与 29.97 重新混合，并修复您的捕获机制。问题更适合堆栈溢出。

# javascript - JavaScript 中变量的局部和全局范围

> ID：13884655
> 
> 赞同：0
> 
> 时间：2012-12-14T18:54:18.677
> 
> 标签：javascript, jquery, html

我曾尝试阅读有关该主题的其他帖子，但还没有运气。在下面的这段代码中，为什么 f2() 不能访问 f1() 中定义的 var。var "name" 不是函数 f2() 的全局变量吗？f2() 不应该看到 var "name" 吗？

```
 function f1() {
     var name = "david";
     function f2() {
        document.writeln(name);
     }
     document.writeln(name);
  }                   

  f2(); // does not write out "david". 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-14T18:56:41.960

your`f2()`仅在`f1()`范围内定义。你不能全局调用它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:04:58.477

Javascript 是函数级别范围的，而不是块范围的。一个函数可以访问它的父函数变量，但不能访问在它的函数中定义的变量。您可以从 f1 返回 f2 并以这种方式调用它

```
 function f1() {
         var name = "david";

         document.writeln(name);

         return f2

         function f2() {
            document.writeln(name);
         }

      } 

var f2 = f1();
f2(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T18:59:23.493

您需要阅读 Javascript 闭包。

这是您的代码片段的一个版本，它演示了如何在内部函数中从外部函数访问变量（如果您想全局调用内部函数）。

```
function f1()
{
   var name = "david";
   return function()
   {
      console.log(name);
   }
}
var f2 = f1();
f2(); 
```

# dart - 任何最大值和最大参数？

> ID：13884666
> 
> 赞同：2
> 
> 时间：2012-12-14T18:55:21.503
> 
> 标签：dart

我想在集合上使用 max 和 argmax。我看到了max 但不是 argmax 的[问题](http://code.google.com/p/dart/issues/detail?id=1319&q=max&colspec=ID%20Type%20Status%20Priority%20Area%20Milestone%20Owner%20Summary)，它看起来与我的想法不同。这里的一切也适用于 min 和 argmin。具有等效行为的代码示例（减去错误处理）：

```
import 'dart:html';
import 'dart:math' as math;

void main() {
  final nums = [3, 1, 2];
  final animalNames = ['cat', 'turtle', 'sheep'];
  final highest = nums.reduce(nums[0], (stored, curr) => math.max(stored, curr));
  final longest = animalNames.reduce(animalNames[0], longerString); 
  print('highest: $highest');
  print('longest: $longest');
}

String longerString(final String first, final String second) {
  if (first.length < second.length) {
    return second;
  } else {
    return first;
  }
} 
```

我一直在搜索 API，但没有找到类似的东西：

```
final highest = nums.max;
final longest = animalNames.argmax((name) => name.length); 
```

类似于 Ruby [max 和 max_by](http://ruby-doc.org/core-1.9.3/Enumerable.html#method-i-max)。

问题：

1.  是否已经有这样的 API 调用（以我尚未检查的某个名称）？
2.  有没有计划制作它们？
3.  我应该提出问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T04:29:35.527

我认为没有，但是根据您的示例，这是一个非常简单的实现：

```
animalNames.reduce("", (prev, cur) => prev.length > cur.length ? prev : cur); 
```

如果您只想查找一次，这比排序要快，但如果您的 argmax 有复杂的逻辑，这可能会有点笨拙。

在 Dartisans 的一个视频中，其中一位开发人员提到了他们如何尝试使许多常见模式变得简单，所以我认为如果你制作一个类似这样的东西很有可能将其纳入标准库足够好的案例。

# ruby - Geektool 和 TextMate 错误

> ID：13884669
> 
> 赞同：1
> 
> 时间：2012-12-14T18:55:36.127
> 
> 标签：ruby, textmate, geektool

我在寒假期间给自己一些小项目，并尝试编写可用于桌面的小 geektool 脚本。我为 ruby​​ 编写了这个，它在终端中工作，但是当我在 textmate 中运行它时，我得到一个主机已关闭错误，当我将它放在 geektool 中时它不会运行。

```
 #!/usr/bin/ruby

require 'open-uri'
require 'nokogiri'

def fetch_xml()
  open("http://weather.yahooapis.com/forecastrss?w=2424766&u=f")
end

def parse_xml()
    source = Nokogiri::XML(fetch_xml)
    location = source.xpath("//yweather:location")
    condition = source.xpath("//item//yweather:condition")
    forecast = source.xpath("//item//yweather:forecast")
    [location[0]['city'], location[0]['region'], condition[0]['temp'].to_i, condition[0]['text'], forecast[0]['high'], forecast[0]['low']]
end

def display_weather()
  result = parse_xml()
  print "#{result}\n"
end

display_weather 
```

它在终端中运行并给我正确的输出： ["Houston", "TX", 64, "Cloudy", "69", "63"]

但是就像我之前提到的，它不会在 textmate 中运行，并且在 geektool 中什么也没有显示。提前感谢您的帮助。

# c++ - 如何安装 cc-mode-5.32.3？（在 emacs 的 C++ 模式下高亮）

> ID：13884670
> 
> 赞同：2
> 
> 时间：2012-12-14T18:55:36.107
> 
> 标签：c++, emacs

我正在使用 emacs 在 unix 集群上编辑我的 C++ 程序。我想用 emacs 突出显示 C++ 中的关键词。网上搜索后，决定安装cc-mode-5.3.3。但我卡在这里：

按照[http://cc-mode.sourceforge.net/src/README上的自述说明进行操作](http://cc-mode.sourceforge.net/src/README)

字节编译后看不懂

> 将编译后的文件放在某个地方 (X)Emacs 会找到它们，即在 load-path 变量中的某个路径中。您必须确保在与 (X)Emacs 一起分发的任何 CC 模式文件之前找到它们。一个目录的优先级高于加载路径列表中它之后的所有目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T09:16:01.287

GNU Emacs 自带了默认安装的 cc-mode，所以你不需要手动安装。要启用符号突出显示，您需要将变量设置`global-font-lock-mode`为真值，例如，使用`M-x customize-variable global-font-lock-mode`，将其切换为 t，然后按`Apply and Save`。

PS 你是在控制台还是图形模式下运行 Emacs？如果在控制台中，那么您可能需要设置相应的字体锁定面。使用`M-x customize-face`命令设置名称以`font-lock-`

# iphone - 键盘显示然后在显示 MFMessageComposeViewController 时立即隐藏自身

> ID：13884672
> 
> 赞同：11
> 
> 时间：2012-12-14T18:55:38.463
> 
> 标签：iphone, objective-c, ios, xcode, cordova

我正在使用 Cordova 2.2 for IOS 构建一个 PhoneGap 应用程序。在调用我编写的用于显示 MFMessageComposeViewController 的本机 obj-c 插件时，我遇到了一些奇怪的行为。

设置非常简单 - 我在 UI 元素上附加了一个点击事件，当按下该事件时，将调用我的 PhoneGap 插件，传递一个数字和一条短信，然后显示带有预先填充的参数的 MFMessageComposeViewController .

我的 javascript 看起来像这样：

```
$(document).bind('deviceready', function(){ 

    $(".theButton").tap(function(){     

        cordova.exec(function(){}, function() {}, "PhoneGapSms", "SendSms", [db.getItem("profile_sms"), db.getItem("profile_emergency")]);

    }); 
}); 
```

我的 obj-c 代码如下所示：

```
- (void)SendSms:(CDVInvokedUrlCommand*)command
{

    CDVInvokedUrlCommand* myCommand = command;

    MFMessageComposeViewController *picker = [[MFMessageComposeViewController alloc] init];

    NSString* body = [command.arguments objectAtIndex:0];
    NSString* toRecipientsString = [command.arguments objectAtIndex:1];

        if(body != nil)
            picker.body = body;

        if(toRecipientsString != nil)
            [picker setRecipients:[ toRecipientsString componentsSeparatedByString:@","]];

    picker.messageComposeDelegate = self;

    [self.viewController presentModalViewController:picker animated:YES];
    [[UIApplication sharedApplication] setStatusBarHidden:YES];

    [picker release];

} 
```

所以，总而言之，非常简单的东西。

**我的问题是这样的：**

当我的 iPhone**插入我的 Mac 并从 XCode 运行应用程序时**，Message Composer 覆盖看起来很棒，我的值已预先填充。下图展示了插入 XCode 时 SMS 界面看起来很好：

![在此处输入图像描述](../Images/4ac07530e87cc49438c02d2b48b82cad.png)

当我的 iPhone**从我的 Mac 上拔下，并且应用程序从弹簧板运行时**，覆盖层向上滑动，键盘开始向上滑动，**然后立即向下滑动**- 使得无法输入或发送消息。这是未连接到 Mac/Xcode 时的样子 - 键盘开始向上滑动然后立即向下滑动（~ < 1 秒），留下以下界面：

![在此处输入图像描述](../Images/0a0e4a4eba332521eb0d8b71680ed900.png)

我一生都无法弄清楚当不从 XCode 运行时会导致键盘隐藏的原因，但是当它运行时可以很好地工作。

有没有办法“强制”键盘显示，或者可能以某种形式或方式将整个 modalviewcontroller 作为第一响应者？

任何建议表示赞赏！

**编辑：**

如果您单击联系人区域，键盘将再次出现

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T05:34:36.787

您必须添加`MessageUI.framework`到您的 Xcode 项目并包含一个

`#import <MessageUI/MessageUI.h>`在你的头文件中。

试试这个代码可能对你有帮助..

```
[self presentModalViewController:picker animated:YES];
//[self becomeFirstResponder];//try picker also instead of self 
```

另请参阅此波纹管教程并检查演示..

1.  [新教程-开发和架构-a-phonegap-应用程序](http://coenraets.org/blog/2012/11/new-tutorial-developing-and-architecting-a-phonegap-application/)

2.  [短信编辑器](https://github.com/phonegap/phonegap-plugins/tree/master/iPhone/SMSComposer)

我希望这可以帮助你...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-07T15:33:25.510

我在使用 Sencha Touch 2.2 和 Cordova 2.6.0 设置（特别是 iOS 6+ 设备）时遇到了这些症状。

问题在于 Web 框架将焦点从本机 SMS Composer 模式转移，通常发生在第一个 SMS Composer 模式成功显示和关闭之后。

一旦事件被触发（或在 Sencha 土地），A`event.preventDefault()`并调用解决了这个问题。`event.stopPropagation()``event.stopEvent()`

希望这可以帮助，

-詹姆士

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T03:14:32.220

**第一**：最可能的罪魁祸首，没有看到你的代码，是你的父（呈现）视图控制器可能有一个动作，`viewWillDisappear`或者`viewDidDisappear`影响谁拥有“第一”响应者。这些方法在模态显示视图控制器时被调用。由于时序的原因，它在模拟器上的行为可能与设备上的不同 - 通常非常接近的时序条件在 ARM 设备和 i386 处理器上是不同的。

**第二**：您的应用程序中的任何地方是否注册了`UIKeyboardWillShowNotification`或`UIKeyboardDidShowNotification`？如果是这样，请在结果调用的方法中放置断点 - 您的视图层次结构中的其他一些控制器可能会干扰这个控制器。

要回答你的问题...

> 有没有办法“强制”键盘显示，或者可能以某种形式或方式将整个 modalviewcontroller 作为第一响应者？

对两者都没有。使键盘显示的唯一方法是调用`becomeFirstResponder`输入视图的方法。由于 Apple 不公开文本视图，因此您无法向其发送消息。设置`modalViewController`为第一响应者将设置错误的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T14:22:08.400

我发现了相同类型的问题，但不确定它是否会解决您的问题只需查看以下链接：1\. [http://community.phonegap.com/nitobi/topics/keyboard_is_not_triggerd_in_my_ios_build](http://community.phonegap.com/nitobi/topics/keyboard_is_not_triggerd_in_my_ios_build) 2\. [https://github .com/phonegap/build/issues/31](https://github.com/phonegap/build/issues/31)

如果它不能解决您的问题，那么您可以在[此处](https://github.com/phonegap/phonegap-plugins/tree/master/iPhone/SMSComposer)下载示例代码。

链接：[https ://github.com/phonegap/phonegap-plugins/tree/master/iPhone/SMSComposer](https://github.com/phonegap/phonegap-plugins/tree/master/iPhone/SMSComposer)

# objective-c - 如何识别从两个可用的 UITableView 中选择了哪个

> ID：13884675
> 
> 赞同：0
> 
> 时间：2012-12-14T18:56:08.053
> 
> 标签：objective-c, ios, xcode4.5

我有一个 UITabView iPad 应用程序，使用 XCode 4.5、Storyboards 和 iOS 6。我有一个 UIView 场景，有两个 UITableViews（一个在左上象限，另一个在 UIVIew 的下半部分）。我的问题是我需要确定**numberOfRowsInSection**和**cellForRowAtIndexPath**引用了哪个 UITableView 。我已经给出了两个 UITableViews 的名称：

![显示 id 的图片](../Images/86e0610249692b1109c2e03034518afc.png)

我认为这是不正确的，因为当我在**numberOfRowsInSection**上设置断点时，它会任意选择较低的 UITableView（previousAppointments），而不是选择较高的 UITableView（clientList）。代码如下：

```
//------------------------------------------------
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {

    if (tableView == clientList)  {
        int y = listOfClients.count;
        return 1;  //  return list of clients          <---------  TODO
    }
    else if(tableView == previousAppointments) {
        return 2;  //  return number of appointments for this client    <------------ TODO
    }

    return 1;
} 
```

我需要能够识别选择了哪个 UITableView，以便我可以用正确的数据填充它。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T18:58:59.653

您应该为每个表视图设置 IBOutlets，并在 if 语句中使用该出口名称

# android - Android自定义键盘，无法实例化以下类：

> ID：13884677
> 
> 赞同：5
> 
> 时间：2012-12-14T18:56:26.293
> 
> 标签：android, android-layout

我为我的应用程序创建了一个自定义键盘。您可以在下面看到我的键盘的代码。我在 xml 查看器中遇到错误 [Android - Unsupported Service: audio](https://stackoverflow.com/questions/11090629/android-unsupported-service-audio) 但没有人回答类似的问题。

我的自定义键盘的代码

```
public class KeyboardViewExtend extends KeyboardView implements KeyboardView.OnKeyboardActionListener
    {

    private SymjaBase _parent = null;
    private Keyboard _myKeyboard = null;

    public KeyboardViewExtend(Context c, AttributeSet atts, int defStyle) {
        super(c, atts, defStyle);
        // Tip: Use View.isInEditMode() in your custom views to skip code when shown in Eclipse
        if (!isInEditMode()) {
            _parent = (SymjaBase)c; 
        }
        init(c);
    }

    public KeyboardViewExtend(Context c, AttributeSet atts) {
        super(c, atts);
        // Tip: Use View.isInEditMode() in your custom views to skip code when shown in Eclipse
        if (!isInEditMode()) {
            _parent = (SymjaBase)c; 
        }
        init(c);
    }

    private void init(Context c) {
        setOnKeyboardActionListener(this);
        setEnabled(true);  
        setPreviewEnabled(true);   
        setFocusable(false);
        setFocusableInTouchMode(false);
        setBackgroundColor( Color.BLACK );
        LinearLayout.LayoutParams lp = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.WRAP_CONTENT, LinearLayout.LayoutParams.WRAP_CONTENT, 0);
        lp.gravity = Gravity.BOTTOM;
        setLayoutParams(lp);
        makeKeyboardView();
    } 
```

xml 图形查看器中的错误

```
The following classes could not be instantiated:
- org.matheclipse.android.KeyboardViewExtend (Open Class, Show Error Log)
See the Error Log (Window > Show View) for more details.
Tip: Use View.isInEditMode() in your custom views to skip code when shown in Eclipse

java.lang.UnsupportedOperationException: Unsupported Service: audio
    at com.android.layoutlib.bridge.android.BridgeContext.getSystemService(BridgeContext.java:448)
    at android.inputmethodservice.KeyboardView.<init>(KeyboardView.java:376)
    at android.inputmethodservice.KeyboardView.<init>(KeyboardView.java:279)
    at org.matheclipse.android.KeyboardViewExtend.<init>(KeyboardViewExtend.java:35)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(    at sun.reflect.NativeConstructorAccessorImpl.newInstance(    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(    at java.lang.reflect.Constructor.newInstance(    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.instantiateClass(ProjectCallback.java:413)
    at com.android.ide.eclipse.adt.internal.editors.layout.ProjectCallback.loadView(ProjectCallback.java:170)
    at android.view.BridgeInflater.loadCustomView(BridgeInflater.java:207)
    at android.view.BridgeInflater.createViewFromTag(BridgeInflater.java:135)
    at android.view.LayoutInflater.rInflate_Original(LayoutInflater.java:746)
    at android.view.LayoutInflater_Delegate.rInflate(LayoutInflater_Delegate.java:64)
    at android.view.LayoutInflater.rInflate(LayoutInflater.java:718)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:489)
    at android.view.LayoutInflater.inflate(LayoutInflater.java:372) 
```

这个你能帮我吗。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-28T21:56:21.710

请参阅此问题和答案：[Android - 不支持的服务：音频](https://stackoverflow.com/questions/11090629/android-unsupported-service-audio)

简而言之：这是android源代码的错误。但我找到了解决方案如何解决它。

用作`KeyboardViewFix`替换`KeyboardView`：

```
public class KeyboardViewFix extends KeyboardView {
    public static boolean inEditMode = true;

    @TargetApi(21) // Build.VERSION_CODES.L
    public KeyboardViewFix(Context context, AttributeSet attrs, int defStyleAttr, int defStyleRes) {
        super(inEditMode ? new ContextWrapperInner(context) : context, attrs, defStyleAttr, defStyleRes);
    }

    public KeyboardViewFix(Context context, AttributeSet attrs, int defStyleAttr) {
        super(inEditMode ? new ContextWrapperInner(context) : context, attrs, defStyleAttr);
    }

    public KeyboardViewFix(Context context, AttributeSet attrs) {
        super(inEditMode ? new ContextWrapperInner(context) : context, attrs);
    }

    public static class ContextWrapperInner extends ContextWrapper {
        Context base;
        public ContextWrapperInner(Context base) {
            super(base);
            this.base = base;
        }
        public Object getSystemService(String name) {
            return Context.AUDIO_SERVICE.equals(name) ? null : base.getSystemService(name);
        }       
    }
} 
```

注意：在启动您的应用程序时，在您需要设置任何其他代码之前，`KeyboardViewFix.inEditMode = false;`否则您可能会遇到一些错误。

# c# - 当连接在 .NET 远程服务器上的远程调用过程中终止时会发生什么？

> ID：13884678
> 
> 赞同：2
> 
> 时间：2012-12-14T18:56:27.383
> 
> 标签：c#, .net-4.0, locking, .net-remoting

当连接的客户端在远程调用过程中断开连接时，.NET Remoting 服务器的服务器端行为是什么？具体来说，如果客户端应用程序在等待远程调用返回时调用 myThread.Abort()？

有什么特别需要我确保处理的吗？如果这发生在锁定块的中间，这将如何影响服务器的行为？由于任何原因，这可能会导致死锁吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T05:56:48.293

客户端可以随时与 .NET Remoting 服务器断开连接。这是正常情况，对服务器没有影响。服务器将完成调用的处理，然后丢弃结果而不将它们发送回客户端。在任何情况下，所有的锁都会优雅地退出。

# raphael - RaphaelJS 隐藏形状 onmouseout

> ID：13884682
> 
> 赞同：2
> 
> 时间：2012-12-14T18:56:50.347
> 
> 标签：raphael, onmouseover, onmouseout

我使用 for 循环创建了 4 个矩形。如果您将鼠标悬停在这些矩形中的任何一个上，则会在旁边显示一个矩形。但问题是新显示的矩形不会在鼠标移出时隐藏。我的代码有什么问题？

[JS小提琴](http://jsfiddle.net/TL78u/21/)

```
window.onload = function() {
var paper = Raphael(0, 0, 640, 540);    

function aa(h1,h2){
    var showbox = paper.rect(h1+300,h2,100,100);
}
function ab(){
    showbox.hide();
}

for (i = 0; i < 2; i++) {
    for (j = 0; j < 2; j++) {
        (function(i, j) {
            var boxes = paper.rect(0 + (j * 100), 0 + (i * 100), 100, 100).attr({
                fill: '#303030',
                stroke: 'white'
            });
            boxes.node.onmouseover = function() {
                var h1 = boxes.getBBox().x;
                var h2 = boxes.getBBox().y;
                aa(h1,h2);
            };

            boxes.node.onmouseout = function() {
                ab();
            };
        })(i, j);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T19:26:30.107

您遇到了 javascript 范围问题（以及另外两个较小的问题，见下文）。

该变量`showbox`在 function 中定义`aa`。所以你的 onmouseout 功能看不到它。启动 Firebug 或您的浏览器的等价物，您会看到一堆`showbox is not defined`错误。

**提示：**在使用 Raphael 时，我通常会创建一个对象或数组，其中包含我创建的所有对象，键入以便于访问，并在所有与 Raphael 相关的函数之上限定范围，以便所有人都可以访问它（参见下面的 jsfiddle 示例）。

如何访问您的 Raphael 对象是您需要**尽早决定**的应用程序设计，否则您将需要进一步进行大量重构（去过那里，很痛苦！）。

这是适用于您的代码的改编版本：

## [jsfiddle](http://jsfiddle.net/TL78u/23/)

编辑：我添加了解释每个更改的注释。

* * *

它还解决**了另外两个问题**：

*   （在 jsfiddle 代码中）没有，例如`attr`在`display: none;`Raphael 中，尝试`.attr({opacity:0})`或`.hide()`...
*   ...但是...不要！您的 mouseover 事件创建矩形，您的 mouseout 事件...*隐藏*它们...？您将拥有越来越多的不可见矩形堆栈，最终可能会使某人的浏览器崩溃。要么显示，然后隐藏，要么创建，然后删除 - 不要创建然后隐藏！

mouseover / mouseout 事件本身实际上很好！:-)

# php - Wordpress 钩子过滤按钮

> ID：13884696
> 
> 赞同：0
> 
> 时间：2012-12-14T18:58:19.783
> 
> 标签：php, wordpress

我正在[这个](http://fvquotes.com/)网站上工作。如果它是首页，我正在尝试过滤每个图像上方显示的两个箭头（上一个和下一个）。我为它创建了以下钩子，

```
function removal() {
return null;
}

if(is_front_page()){
    add_filter('prev', 'removal');
    add_filter('next', 'removal');
} 
```

问题是图像仍在显示。任何想法为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:19:39.370

> **编辑：**在 CSS 样式表中有一种更优雅的方式，利用 WP 为主页的主体提供`home`类的事实：
> 
> ```
> body.home .prev,
> body.home .next { display: none } 
> ```
> 
> **这仅**针对主页上的“上一个”和“下一个”按钮。

**旧答案：**`if(is_front_page())`在您的通话中输出 CSS 。

在页面的`<head>`部分中，执行

```
 <?

  if(is_front_page())
   echo "<style type='text/css'>.prev, .next { display: none }</style>";

  ?> 
```

# javascript - 是否可以使用变量作为函数名

> ID：13884701
> 
> 赞同：2
> 
> 时间：2012-12-14T18:58:43.977
> 
> 标签：javascript, variables, contextmenu, var

我有一个上下文菜单，它返回单击的菜单项作为变量中的值，就像这样。

```
var m = key; 
```

变量可以是我编程的任何东西，例如；编辑、剪切、粘贴或任何我想要的。

是否可以将此变量用作函数名？例如：函数 m() 其中 m 可以是变量的内容。

任何建议将不胜感激。

谢谢

克里斯

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-14T19:02:05.210

您可以使用所需的函数创建一个对象，然后使用该变量调用函数：

```
var funcs = {
   "cut": function(){
      console.log("Cutting");
    },
    "paste": function(){
      console.log("Pasting");
    }
};

var m = "cut";
funcs[m](); 
```

[http://jsfiddle.net/WVBNV/](http://jsfiddle.net/WVBNV/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:04:50.387

当然可以！

```
var onComplete = fadeOut;

function fadeOut(){
   $(this).animate({
      opacity: "0"
   },400);
} 
```

巧合的是，您也可以使用这种方式来伪制作类。

```
function myClass(){
    this.publicVar = "" //<-- this is a public var
    var privateVar = ""; //<-- this is private

   this.myPublicMethod = myPublicMethod;

   function myPublicMethod(){ // <-- public because of the line above

   } 

   function _myPrivateMethod(){ // <-- if just this it's private

   }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:11:53.103

## 其他方式

```
function my_generic_function(m) {
    switch (m) {
    case "cut":
        console.log("cutting");
        break;
    case "copy":
        console.log("copying");
        break;
    default:
        return false;

    }
}

var m = "cut";
my_generic_function(m);

var m = "copy";
my_generic_function(m);
​ 
```

# xml - 如何在 Mule 3 中高效（流）处理 XML 文件？

> ID：13884714
> 
> 赞同：1
> 
> 时间：2012-12-14T18:59:31.993
> 
> 标签：xml, stream, mule, stax

我的要求是（有效地）使用流（Stax）读取 XML 文件，而不是将整个 DOM 加载到内存中（JAXB）。

任何人都知道如何使用 XmlToXMLStreamReader 处理 XML？
像往常一样， [Mule 文档](http://www.mulesoft.org/documentation/display/MULE3USER/XmlToXMLStreamReader+Transformer)非常节俭。

我有一个

```
<custom-transformer class="org.mule.module.xml.transformer.XmlToXMLStreamReader"/> 
```

在我的流程中。怎么办？
如何一次处理一个开始标签？
它生成什么样的有效载荷？在调试器中，我可以看到它是一个 org.mule.module.xml.util.XMLUtils。我以为我会得到一个 Stax XmlStreamReader。

任何帮助/示例将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:03:48.357

将`org.mule.module.xml.transformer.XmlToXMLStreamReader`当前有效负载转换为`javax.xml.stream.XMLStreamReader`. 现在由您来添加另一个自定义转换器/组件来对此进行处理`XMLStreamReader`。

# javascript - 使用 FileUpload 上传文件后使链接可见

> ID：13884723
> 
> 赞同：0
> 
> 时间：2012-12-14T19:00:23.227
> 
> 标签：javascript, asp.net

我正在使用 FileUpload 上传文件。文件上传后，我希望用户看到一个“删除”链接，该链接将从服务器中删除该文件。

只有在文件完全上传后，我才能使这样的链接可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T20:42:35.477

我曾尝试使用数据控件来实现这一点。

```
 <asp:Panel ID="pnlUpload" runat="server">
    <asp:FileUpload ID="fup1" runat="server" ClientIDMode="Static" />
    <asp:Button ID="btnServer" runat="server" Text="Submit" OnClick="btnSubmit_Click"
        ClientIDMode="Static" CssClass="none" />
</asp:Panel>
<asp:Repeater ID="rptUploads" runat="server" OnItemCommand="rptUploads_ItemCommand">
    <HeaderTemplate>
        <table width="100%">
            <th>
                File Name
            </th>
            <th>
                Actions
            </th>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td>
                <%# Container.DataItem %>
            </td>
            <td>
                <asp:LinkButton ID="LinkButton1" runat="server" Text="Remove" CommandName="Delete"
                    CommandArgument="<%# Container.DataItem %>"></asp:LinkButton>
            </td>
        </tr>
    </ItemTemplate>
    <FooterTemplate>
        </table>
    </FooterTemplate>
</asp:Repeater>
<style>
    .none
    {
        display: none;
    }
</style>
<script type="text/javascript">
    (function () {
        if (document.getElementById('fup1') != null) {
            document.getElementById('fup1').onchange = function () { document.getElementById('btnServer').click(); };
        }
    })();
</script> 
```

和后面的代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

using System.IO;

public partial class _Default : System.Web.UI.Page
{
    public List<string> Files
    {
        get
        {
            if (ViewState["files"] == null)
            {
                ViewState["files"] = new List<string>();
            }
            return (List<string>)ViewState["files"];
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        if (fup1.HasFile && !Files.Contains(fup1.FileName))
        {
            fup1.SaveAs(Server.MapPath("~/App_Data/") + fup1.FileName);
            Files.Add(fup1.FileName);
            rptUploads.Visible = true;
            rptUploads.DataSource = Files;
            rptUploads.DataBind();
            pnlUpload.Visible = false;
        }
    }

    protected void rptUploads_ItemCommand(object sender, RepeaterCommandEventArgs e)
    {
        if (e.CommandName == "Delete")
        {
            var filename = Server.MapPath("~/App_Data/") + e.CommandArgument;
            if (File.Exists(filename))
            {
                File.Delete(filename);
                Files.Remove(e.CommandArgument.ToString());               
                rptUploads.Visible = false;
                pnlUpload.Visible = true;
            }
        }
    }
} 
```

# scala - Scala Akka AMQP，多个路由键

> ID：13884728
> 
> 赞同：1
> 
> 时间：2012-12-14T19:00:50.560
> 
> 标签：scala, akka, amqp

现在你可以创建一个队列消费者

```
AMQP.ConsumerParameters(...routingKey="key"...) 
```

有没有办法指定多个键。我知道在 rabbitmq Web 界面中，我可以为队列指定多个路由键。有没有办法在 Akka/AMQP 中以编程方式执行此操作

# c# - 如何检测 TFS 项目源代码已被修改

> ID：13884733
> 
> 赞同：4
> 
> 时间：2012-12-14T19:01:31.383
> 
> 标签：c#, windows, visual-studio-2010, tfs

我在 TFS 中有一个可编译为 DLL 的 Visual Studio C# 项目。我需要知道项目内的任何文件是否在一段时间内被修改过。像这样的东西：

```
"from date 01/01/2011 to today,  check if the project has been modified." 
```

在 C# 中使用 TFS API 执行此操作的最佳方法是什么？

我的想法：从 TFS 获取所有项目项目，为每个项目检查它的更改历史记录。根据给定的范围时段过滤历史记录。如果在那段时间有变化，那么那个文件就被修改了，因此项目也被改变了。它是否正确？

是否有可能做同样的事情，但不是在一段时间之间搜索，而是在一系列变更集中？例如：

```
"from changeset 1071 to latest,  check if the project has been modified." 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T20:40:43.017

您可以使用该[`QueryHistory`](http://msdn.microsoft.com/en-us/library/bb138960%28v=vs.100%29.aspx)方法解决这些问题：

```
var tfs = new TfsTeamProjectCollection(new Uri(@"http://tfs.example.com:8080"));
var vc = tfs.GetService<VersionControlServer>();

// DateTime fro, to;
var changesets = from cs in vc.QueryHistory(
    "$/YourProject",
    VersionSpec.Latest,
    0,    /* deletion ID, 0 otherwise */
    RecursionType.Full,
    null, /* user, null for all */
    null, /* from changeset, null because these aren't by date */
    null, /* to changeset, null because these aren't by date   */
    Int32.MaxValue, /* get them all */
    false, /* just metadata */
    false /* just the current stuff */
    )
    where cs.CreationDate >= fro && cs.CreationDate <= to
    select cs; 
```

获得变更集列表后，您可以查询它们以获取与它们关联的文件。在这一点上，如果你真的想排除误报，我会添加[Roslyn](http://msdn.microsoft.com/en-us/vstudio/roslyn.aspx)对阅读项目和解决方案的支持，并使用它来过滤有趣的文件名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:33:55.030

您在这里遇到的问题是该项目可能包含不在同一个根文件夹中的文件。在大型解决方案中包含位于项目目录之外的文件是很常见的。

您将面临的另一个问题是，并非项目目录下的源代码管理中的所有文件实际上都必须包含在项目中。

现在，如果您不关心这些情况，最简单的方法是使用 tf 命令行 tf folderdiff。您可以将两条路径传递给它（都可以在服务器上），尽管文档没有明确指定它，但您可以像这样添加一个版本规范：

```
 tf folderdiff $/Path/To/Project;C1071 $/Path/To/Project;T /recursive 
```

[此处记录](http://msdn.microsoft.com/en-US/library/cc31bk2e.aspx#versionspec)了您可以使用的示例。它包括日期、变更集编号、标签名称等。

如果您想知道这是如何完成的，请考虑查看 Reflector.NET 或 JustDecompile（或类似应用程序）中的 tf.exe 实用程序。他们使用与您相同的 API。或者`tf folderdiff`直接使用 Process 类直接调用命令。

我有一篇[博文详细解释了 tf folderdiff 命令](http://blog.jessehouwing.nl/2012/06/generating-changelog-from-tfs.html)以及如何使用它。

拥有魔法的班级在这里：

```
 internal class FolderDiff : IEnumerable<FolderDiffFolder>, IEnumerable, IDisposable

 Name:     Microsoft.TeamFoundation.VersionControl.Controls.FolderDiff 
 Assembly: Microsoft.TeamFoundation.VersionControl.Controls, Version=11.0.0.0 
```

它是内部的，因此您可以窥视它是如何完成的，但是无法轻松访问 API 来获得相同的结果。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:55:22.550

我不太清楚为什么@Alex 删除了他的答案，因为这基本上是一个好的开始。

正如他所建议的，您可以运行[tf.exe 来获取](http://msdn.microsoft.com/en-us/library/yxtbh4yh%28v=vs.100%29.aspx)文件或整个文件夹层次结构的历史记录，并且可以将结果限制在两个版本、**变更集**或日期之间。因此，如果您的项目是“正常的”并且几乎​​所有项目都位于一个根文件夹下，那么一种简单的方法就是`tf history`在根文件夹上获取已更改文件的列表。您将不得不解析输出以确定哪些文件受到影响，但这是一项非常容易的任务 - 如果您只想知道“有什么改变吗？”就更容易了。

正如@jessehouwig 所说，可能有您希望从其他位置考虑的文件，以及您不想考虑的项目文件夹中的文件。在这种情况下，您可能希望编写一个批处理文件或应用程序，多次调用 tf.exe 以更具体的方式收集信息。

# c++ - 写入文件时出现堆损坏

> ID：13884734
> 
> 赞同：2
> 
> 时间：2012-12-14T19:01:46.663
> 
> 标签：c++, ifstream, heap-corruption, powerset

我试图将 powerset 写入文件，但如果我的起始数组大于大小 6，我会得到堆损坏，我不知道为什么。它适用于任何大小的数组 6 或以下。想不通这个。

此外， test.txt 是我在数组中读取的位置。如果文件包含“1,2,3,4,5,6”它工作正常，但它包含“1,2,3,4,5,6,7”我得到堆损坏。

```
#include <stdio.h>
#include <stdlib.h>
#include <string>
#include <iostream>
#include <fstream>
#include <sstream>
#include <algorithm>
#include "N26.h"
#include <math.h>

using namespace std;

void increaseArray(int* theArray, int size)  
{  
    int i = size;  
    int n = i+1;  
    int* newArray = new int[n];  

    for(int cnt=0;cnt<n;cnt++)
    {  
        newArray[cnt] = theArray[cnt];  
    }  

    newArray[n-1]= NULL;
    theArray = newArray;

    return;  
} 

void printPowerSet(int *s, int n)
{
    int i=0,j=0;
    ofstream myFile;
    double SetSize=pow(2.0,n);

    myFile.open("powerset1.txt", std::ios_base::app);

    cout<<"{size of  original}"<< n <<endl;
    cout<<"{number of sets}"<< SetSize-1 <<endl;

    for(i=1;i<SetSize;++i)
    {
        for(j=0;j<n;++j)
        {
            if(((i>>j)&1)==1)
            {           
                myFile << s[j] <<",";
            }
        }

        myFile<<endl;
    }

    return;
}

int main()
{
   ifstream myFile;
   int item;
   string input ="";

   string fileName = "test.txt";

    myFile.open(fileName);
    while(myFile)
    {   
        int k = 1;
        int* transaction= new int[1];

        if(!getline(myFile,input))
            break;

        istringstream ss(input);
        while(ss)
        {
            if(!getline(ss,input, ','))
                break;

            input.erase(remove_if(input.begin(), input.end(), isspace), input.end());
            item = atoi(input.c_str());
            transaction[k-1] = item;
            increaseArray(transaction,k);

            k++;
        }

        for(int i =0; i<k-1;i++)
        {
            cout << transaction[i];
        }
        printPowerSet(transaction, k-1);
            cout << endl;
        transaction=NULL;
}

    system("Pause");
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:05:49.777

您的`increaseArray()`函数不起作用，因为您只是在更改指针的本地副本。你必须传递一个双指针或指针引用来做你想做的事。

指针引用示例：void increaseArray(int*& theArray, int size)

相反，我建议使用 a `std::vector`，因为它会自动增长。

我怀疑这对您的问题有任何影响，但我也没有看到您删除过。您正在泄漏内存。在使用新分配重新分配指针之前，请删除旧分配：

```
delete [] theArray; // The "[]" is important!
theArray = newArray; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:09:33.050

除了弗雷德的回答。

看看里面发生了什么`increaseArray()`，特别是这些行：

```
int i = size;  
int n = i+1;  
int* newArray = new int[n];  

for(int cnt=0;cnt<n;cnt++)
{  
    newArray[cnt] = theArray[cnt];  
} 
```

您分配一个元素数组`size + 1`，然后遍历原始元素。那是一回事，即您正在访问原始数组之外的一个元素。根据堆的布局方式，这*可能会给您带来分段错误，但肯定是*[**未定义的行为**](http://en.wikipedia.org/wiki/Undefined_behavior)。`new`[](http://en.wikipedia.org/wiki/Undefined_behavior)

# c# - 光线相交无法正常工作

> ID：13884738
> 
> 赞同：0
> 
> 时间：2012-12-14T19:02:09.597
> 
> 标签：c#, xna

好吧，所以我一直在研究类似 Minecraft 的建造者，其想法是能够快速建造巨大的结构，而无需采矿等。这是为了学习经验。

所以现在我被困在一个恼人的地方......

如果我从一侧摧毁一个街区。它工作正常。

![在此处输入图像描述](../Images/356107d0d40b6ec63f4c190fa972dde5.png) ![在此处输入图像描述](../Images/9073f10254c24b8d7895f2843c8cea04.png)

但是一旦我把相机移到另一边，一切都错了。

![在此处输入图像描述](../Images/e1931a226ac4fe9956a8d47903e2163c.png) ![在此处输入图像描述](../Images/364d03a6627b4f80f9c233a2cc7c53b0.png)

所以基本上我被困在这一点上，不知道如何解决它。

我计算射线：

```
Ray getRay(MouseState mouseState)
        {
            Viewport vp = mainController.engine.graphics.GraphicsDevice.Viewport;

            Vector3 nearPoint = new Vector3(mouseState.X, mouseState.Y, 0);
            Vector3 farPoint = new Vector3(mouseState.X, mouseState.Y, 1);

            nearPoint = vp.Unproject(nearPoint, camera.getProjectionMatrix(), camera.getViewMatrix(), Matrix.Identity);
            farPoint = vp.Unproject(farPoint, camera.getProjectionMatrix(), camera.getViewMatrix(), Matrix.Identity);

            Vector3 direction = Vector3.Normalize(farPoint - nearPoint);

            return new Ray(nearPoint, direction);
        } 
```

然后用所有模型的边界框粗暴地检查它：

```
for (int y = world.settings.regionHeight - 1; y >= 0; y--)
    {
          gotblock = false;
          for (int x = 0; x < world.settings.regionWidth; x++)
              for (int z = 0; z < world.settings.regionLenght; z++)
              {
                  f = ray.Intersects(block[x, y, z].boundingBox);
                  if (f != null)
                  {
                       if (f < lowestDistance && world.block[(int)position.X * world.settings.regionWidth + x, y, (int)position.Y * world.settings.regionLenght + z] != BlockTypes.none)
                           {
                               result = new intVector3((int)position.X * world.settings.regionWidth + x, y, (int)position.Y * world.settings.regionLenght + z);
                                    gotblock = true;
                           }
                  }
              }
         if (gotblock)
             break;
    } 
```

如果您需要更多信息，请告诉。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T06:53:13.950

问题是，在检查最低距离时，距离可以用射线中的负数来计算。因此，我只需要比较距离的绝对值，而不仅仅是正数。

像这样：

```
for (int y = world.settings.regionHeight - 1; y >= 0; y--)
                {
                    gotblock = false;
                    for (int x = 0; x < world.settings.regionWidth; x++)
                        for (int z = 0; z < world.settings.regionLenght; z++)
                        {
                            f = ray.Intersects(block[x, y, z].boundingBox);

                            if (f != null)
                            {
                                f = Math.Abs((float)f);
                                if (f < lowestDistance && world.block[(int)position.X * world.settings.regionWidth + x, y, (int)position.Y * world.settings.regionLenght + z] != BlockTypes.none)
                                {
                                    lowestDistance = (float)f;
                                    result = new intVector3((int)position.X * world.settings.regionWidth + x, y, (int)position.Y * world.settings.regionLenght + z);
                                    gotblock = true;
                                }
                            }
                        }
                    if (gotblock)
                        break;
                } 
```

# php - 获取按钮属性的输入值

> ID：13884740
> 
> 赞同：0
> 
> 时间：2012-12-14T19:02:10.783
> 
> 标签：php, jquery, ajax

我有输入类型和按钮，插入时需要

```
<input type="text" name="bills_ID" id="bills_ID" value="2"> 
```

我会得到这个项目的 id 并把它放在这里

```
BillsPrint.php?bills_ID=id 
```

这是完整的代码

```
<form id="wrapper">
    <input type="text" name="bills_ID" id="bills_ID" value="2">
    <input name="print" type="submit" id="print" value="print" class="css3buttonblue"  onclick="window.open('BillsPrint.php?bills_ID='this.id, '_blank')" />
</form>
​ 
```

如何在不刷新页面的情况下将 ID 放在此链接 BillsPrint.php?bills_ID=2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:08:06.567

```
<form id="wrapper">
    <input type="text" name="bills_ID" id="bills_ID" value="2">
    <input name="print" type="submit" id="print" value="print" class="css3buttonblue"  
onclick="window.open('BillsPrint.php?bills_ID=' + $("#bills_ID").val(), '_blank')" /> 
</form> 
```

​</p>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:08:48.250

删除 onclick 等。并使用 get 方法。使用这个简单的代码，变量将作为查询字符串出现在 URL 中。

```
<form action="BillsPrint.php" method="get" id="wrapper">
<input type="text" name="bills_ID" id="bills_ID" value="2">
<input name="print" type="submit" id="print" value="print" class="css3buttonblue">
</form> 
```

您忘记指定表单的操作。使用此代码它将起作用。:) 希望它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:08:51.120

试试这个：

```
$(document).ready(function(){
   $('form').submit(function(){
      var id = $('input[name="bills_ID"]').val();
      window.open('BillsPrint.php?bills_ID='+id, '_blank');
      return false;
   });
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T19:08:55.080

你可以这样做：

```
 <form id="wrapper">
            <input type="text" name="bills_ID" id="bills_ID" value="2">
            <input name="print" type="submit" id="print" value="print" class="css3buttonblue"   />
        </form>
    <script>
       $(function(){
           $('#print').click(function(){
              window.open('BillsPrint.php?bills_ID='+$('#bills_ID').val(), '_blank')  
           }); 
       });
    </script> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-14T19:09:05.063

```
$("#print").click(function(){

   var id = $("#bills_ID").val();

    $.ajax({
      url: 'BillsPrint.php?bills_ID=' + id,
      success: function(data) {
        $('.result').html(data);
           alert(data); //alerts output from the BillsPrint.php page
      }
    });
}); 
```

# python - 如何在 Python Script Mongodb 中替换变量

> ID：13884741
> 
> 赞同：0
> 
> 时间：2012-12-14T19:02:20.757
> 
> 标签：python, mongodb

我正在尝试使用变量值替换以下代码段中的“值”，但没有运气。

```
last_error = posts.update(
    {'permalink':permalink}, 
    { '$inc': 
        { 'comments."value".num_likes': 1 }
    }, 
    upsert=False, 
    manipulate=False, safe=True
) 
```

该变量包含 0、1、2、3 等值，需要根据数组位置更新数组（此处数组位置由数组值确定）。

不确定如何将变量值传递给更新命令。我在评论和 numlikes 之间尝试了 {value} ...[value] 之类的东西。没有任何效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:17:17.137

你不能把它连接到字符串吗？

```
last_error = posts.update(
    {'permalink':permalink},
    {'$inc': {'comments.' + str(value) + '.num_likes': 1}},
    upsert=False,
    manipulate=False,
    safe=True) 
```

这里还有另外两种写上面第 3 行的方法：

```
 {'$inc': {'comments.%s.num_likes' % value: 1}}, 
```

或者：

```
 {'$inc': {'comments.{value}.num_likes'.format(value=value): 1}}, 
```

# regex - 如何在 Sublime-Text2 中的每个非 ascii 单词之前添加换行符？

> ID：13884742
> 
> 赞同：2
> 
> 时间：2012-12-14T19:02:21.730
> 
> 标签：regex, csv, sublimetext2, replace

我有一个格式很差的带有英文定义的韩语单词 csv 文件。我想在每个韩语单词之前添加一个新行。例如：

```
# I'd like to change this
하다,to do,크기,size,대기,on hold,

# Into this
하다,to do,
크기,size,
대기,on hold, 
```

使用正则表达式 ([^\x00-\x7F]*) 我能够突出显示韩语单词的所有实例，但是当我尝试用 \n$1 替换它们时，它仅适用于我最后一个光标位置之后的第一个单词，然后插入每个字符后换行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:07:08.877

用,`+`代替`*`, （前者表示 1 或更多，后者表示 0 或更多）。否则，您会在每个位置获得零宽度匹配：

```
[^\x00-\x7F]+ 
```

# ruby-on-rails - 单一语言（非英语）rails 应用程序

> ID：13884750
> 
> 赞同：1
> 
> 时间：2012-12-14T19:03:01.543
> 
> 标签：ruby-on-rails, internationalization

我有一个关于单一语言 Rails 应用程序的一般性问题。用应用程序的语言（例如德语）命名表是否有意义？或者我应该把我的模型翻译成英文。什么是正确的方法？

# forms - 在 ExtJS 中，如何将对象加载到表单字段中？

> ID：13884751
> 
> 赞同：2
> 
> 时间：2012-12-14T19:03:01.433
> 
> 标签：forms, extjs, extjs4

如果我有类似的 JSON 响应，

```
{
    "something": "foo",
    "subobject": {
        "id": "bar",
        "name": "baz"
    }
} 
```

我正在使用将响应加载到表单中`form.setValues(responseObject)`。

如果我`displayfield`的表单是子对象，如何将子对象中的名称放入该字段？或者更好的是，我如何将名称和 id 放入该字段？

我尝试了自定义渲染器，但传入渲染器的 value 参数是一个包含`"[object Object]"`.

我正在使用 ExtJS 4.1.3。有人有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:59:33.803

通过将以下内容添加到我的显示字段配置中使其工作

```
valueToRaw: function(value) {
    return value;
} 
```

标准 valueToRaw 将对象转换为字符串，这对任何人都没有用。

然后我添加了这个自定义渲染器以将我的字段显示为链接，

```
renderer: function(value, field) {
    if (!value) { 
        return; 
    }
    return "<a href='" + value.id + "'> " + value.name + "</a>";
} 
```

我觉得我应该能够使用模板而不是自定义渲染器，但我没有运气让它工作。

# java - PowerMock - @PrepareForTest 上的 NPE

> ID：13884754
> 
> 赞同：3
> 
> 时间：2012-12-14T19:03:47.927
> 
> 标签：java, powermock

问题：PowerMock 中的检测类没有被初始化。我正在通过 @Rule 注释加载库。我已经有了 VM 参数：-javaagent:project_path/libs/powermock-module-javaagent-1.5.jar

当我使用调试器进行操作时，会调用 PowerMockAgent#premain 并设置检测对象，但是在测试设置期间调用它时，检测对象为空，从而引发以下错误。

为什么检测变量在调用 PowerMockAgent#premain 和调用 PowerMockClassRedefiner.redefine 之间不保持其值？

**加载时仪器在此处正确设置：**

```
 private static void initialize(String agentArgs, Instrumentation inst) throws IOException {
    instrumentation = inst;
    inst.addTransformer(new DefinalizingClassTransformer(), false);
    inst.addTransformer(classTransformer, true);
} 
```

**但是当从@PrepareForTest({ Logger.class }) 再次调用时，为空**

```
public class PowerMockClassRedefiner {

public static void redefine(Class<?> cls) {
    if(cls == null) {
        throw new IllegalArgumentException("Class to redefine cannot be null");
    }

    PowerMockAgent.getClasstransformer().setClassesToTransform(Arrays.asList(cls.getName()));

    try {            
        PowerMockAgent.instrumentation().retransformClasses(cls);
    } catch(Exception e){
        throw new RuntimeException("Failed to redefine class "+cls.getName(), e);
    }
} 
```

导致错误：

```
java.lang.RuntimeException: Failed to redefine class com.testapp.Logger
at org.powermock.modules.agent.PowerMockClassRedefiner.redefine(PowerMockClassRedefiner.java:33)
at org.powermock.modules.agent.PowerMockClassRedefiner.redefine(PowerMockClassRedefiner.java:42)
at com.testapp.testFramework.PowerMockRuleAgentSetup.redefine(PowerMockRuleAgentSetup.java:29)
at com.testapp.testFramework.PowerMockRuleAgentSetup.initialize(PowerMockRuleAgentSetup.java:19)
at com.testapp.testFramework.PowerMockOverriderRule.apply(PowerMockOverriderRule.java:19)
at org.junit.runners.BlockJUnit4ClassRunner.withMethodRules(BlockJUnit4ClassRunner.java:341)
at org.junit.runners.BlockJUnit4ClassRunner.withRules(BlockJUnit4ClassRunner.java:330)
at org.junit.runners.BlockJUnit4ClassRunner.methodBlock(BlockJUnit4ClassRunner.java:248)
at com.xtremelabs.robolectric.RobolectricTestRunner.methodBlock(RobolectricTestRunner.java:287)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
at org.eclipse.jdt.internal.junit4.runner.JUnit4TestReference.run(JUnit4TestReference.java:50)
at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:467)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:683)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:390)
at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:197)
Caused by: java.lang.NullPointerException
at org.powermock.modules.agent.PowerMockClassRedefiner.redefine(PowerMockClassRedefiner.java:31)
... 22 more 
```

这是我的测试设置：

```
@RunWith(RobolectricTestRunner.class)
@PrepareForTest({ Logger.class })  // THIS IS WHERE THE ERROR GETS THROWN
public class LoggerTest {
@Rule public PowerMockOverriderRule rule = new PowerMockOverriderRule();
public LoggerConfig config;

@Before
public void setUp() {
    config = mock(LoggerConfig.class);
} 
```

更新：删除 @RunWith(RobolectricTestRunner.class) 解决了这个问题，但不是我的项目的选项。（这是一个Android项目）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-29T22:03:37.463

我很抱歉地问，但你为什么还要模拟一个 Logger 类？如果要确保将输出记录到控制台，可以将记录器包装在可以模拟的抽象中。

```
class LogWraper {
   void someMethod() {
     logger.log()
   }
} 
```

然后你可以创建一个你的 FooWraper 的模拟。根本不需要使用 Powermock ......

# java - 将一些文本写入文件 - 异常

> ID：13884758
> 
> 赞同：1
> 
> 时间：2012-12-14T19:04:05.857
> 
> 标签：java, filewriter, bufferedwriter

我想将数据写入文本文件。但是，在我的应用程序中，我希望继续将项目写入文本文件（这意味着，我要写入的文本应该附加到文件中 - 而不是每次都创建一个新文件）

我的代码如下；但是下次我在文件中写入内容时如何附加文本？

1.）下面代码的问题是，第一次写入文件，但是当我第二次尝试写入时，出现以下异常；

```
java.io.IOException: Stream closed 
```

2.) 我希望能够写入同一个文件，直到应用程序关闭。因此，当应用程序关闭时如何关闭 Stream ？

```
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

public class WriteToFileExample {
    public void writeToFile(String stuff) {
        try {
                File file = new File("../somefile.txt");

            if (!file.exists()) {
                file.createNewFile();
            }

            FileWriter fw = new FileWriter(file.getAbsoluteFile(),true);
            BufferedWriter bw = new BufferedWriter(fw);
            bw.write(stuff);
            bw.close();

        } catch (IOException e) {
            e.printStackTrace();
        }
    }
} 
```

**更新 1**

```
private File file;
public WriteToFileExample(){
                 file = new File("../somefile.txt");

}

public void writeToFile(String stuff) {
            try {

                if (!file.exists()) {
                    file.createNewFile();
                }

                FileWriter fw = new FileWriter(file.getAbsoluteFile());
                BufferedWriter bw = new BufferedWriter(fw);
                bw.write(stuff);
                bw.close();

            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    } 
```

例外

```
Exception in thread "main" java.lang.NullPointerException
    at com.proj.example.Log.WriteToFile(WriteToFileExample.java:3) 
```

这指向`if (!file.exists()) {`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:07:35.590

```
FileWriter fw = new FileWriter(file.getAbsoluteFile(), true); 
```

对 FileWriter 构造函数使用 true 参数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:07:41.303

您应该`FileWriter`使用[带有额外布尔参数的构造函数](http://docs.oracle.com/javase/7/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File,%20boolean%29)创建您的，这表明您要追加。

```
FileWriter fw = new FileWriter(file.getAbsoluteFile(), true); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T19:06:59.290

检查 api，表示 FileWriter 构造函数需要一个布尔值来标记是否附加。那回答你的问题？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-14T19:10:26.280

您永远不会在代码中关闭 FileWriter。并从该类的文档中：

> 文件是否可用或是否可以创建取决于底层平台。特别是某些平台，允许一次仅由一个 FileWriter（或其他文件写入对象）打开文件以进行写入。在这种情况下，如果所涉及的文件已经打开，则此类中的构造函数将失败。

在退出您的方法之前关闭文件编写器，无论如何它都是很好的做法。是的，如果您不希望每次调用您的方法时文件内容都被吹走，那么一定要以附加模式打开编写器。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-14T19:10:27.747

而不是这样做：

`FileWriter fw = new FileWriter(file.getAbsoluteFile());`

执行以下操作：

`FileWriter fw = new FileWriter(file.getAbsoluteFile(),true);`

至于附加到现有文件[FileWriter](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/FileWriter.html#FileWriter%28java.io.File,%20boolean%29)需要一个额外的参数作为 true 这里

> 文件编写器
> 
> ```
> public FileWriter(File file, boolean append) throws IOException 
> ```
> 
> 在给定 File 对象的情况下构造一个 FileWriter 对象。如果第二个参数为真，那么字节将被写入文件的末尾而不是开头。
> 
> **参数**：
> 
> file - 要写入的 File 对象
> 
> append - 如果为真，那么字节将被写入文件的末尾而不是开头
> 
> **抛出：** IOException - 如果文件存在但是是目录而不是常规文件，不存在但无法创建，或者由于任何其他原因无法打开
> 
> 自：1.4

# c# - 实体框架的关系问题

> ID：13884761
> 
> 赞同：1
> 
> 时间：2012-12-14T19:04:30.190
> 
> 标签：c#, entity-framework

我需要帮助在实体框架中创建关系，因为我在尝试添加迁移时尝试的所有操作都会给我错误，或者如果我通过了，那么我会尝试更新数据库并收到关于同名索引的错误。

```
public class Profile
{
    public Profile()
    {
        Environments = new HashSet<Environment>();
    }

    [Key]
    public int Id { get; set; }

    public string VersionCreated { get; set; }

    public string DiskLocation { get; set; }

    public string Name { get; set; }

    public DateTime DateTime { get; set; }

    public virtual Product Product { get; set; }

    public virtual Instance OriginalInstance { get; set; }

    public virtual ICollection<Environment> Environments { get; set; } 
}

public class Instance
{
    public Instance()
    {
        TestResults = new HashSet<TestResult>();
        Environments = new HashSet<Environment>();
    }

    [Key]
    public int Id { get; set; }

    public string Name { get; set; }

    public string Version { get; set; }

    public string UserFriendlyName { get; set; }

    public virtual Product Product { get; set; }

    public virtual Profile LastKnownProfile { get; set; }

    public virtual Computer Computer { get; set; }

    public virtual ICollection<TestResult> TestResults { get; set; }

    public virtual ICollection<Environment> Environments { get; set; } 
} 
```

上述类的问题在于 Profile 类中的 OrginalInstance 属性和 Instance 类中的 LastKnownProfile 应该只是这些特定表的外键，并且它们可能不会经常相同。它们也可能都为空。

我试过了：

```
modelBuilder.Entity<Instance>().HasRequired(i => i.LastKnownProfile);
modelBuilder.Entity<Profile>().HasRequired(p => p.OriginalInstance); 
```

这给了我一个`Unable to determine the principal end of an association between the types 'EcuWeb.Data.Entities.Instance' and 'EcuWeb.Data.Entities.Profile'. The principal end of this association must be explicitly configured using either the relationship fluent API or data annotations.`错误。

与：

```
modelBuilder.Entity<Instance>().HasRequired(i => i.LastKnownProfile).WithOptional();
modelBuilder.Entity<Profile>().HasRequired(p => p.OriginalInstance).WithOptional(); 
```

数据库将外键引用添加回自身。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:24:58.840

> ... Profile 类中的 OrginalInstance 属性和 Instance 类中的 LastKnownProfile 应该只是这些特定表的外键，并且它们可能不会经常相同。它们也可能都为空。

在这种情况下，如果我没有误解您上面的报价，您实际上需要*两个一对多的关系*。这意味着许多 Profiles 可以具有相同的，并且许多 Instances 可以具有相同的. 正确的映射将如下所示：`Profile``Instance``OriginalInstance``LastKnownProfile`

```
modelBuilder.Entity<Profile>()
    .HasOptional(p => p.OriginalInstance)
    .WithMany()
    .Map(m => m.MapKey("OriginalInstanceId"));

modelBuilder.Entity<Instance>()
    .HasOptional(i => i.LastKnownProfile)
    .WithMany()
    .Map(m => m.MapKey("LastKnownProfileId")); 
```

带有的行`MapKey`是可选的。没有它们，EF 将创建一个具有默认名称的外键。

另请注意，如果“两者都可能为空” ，则必须使用`HasOptional`（而不是）。`HasRequired`

# perl - 简单的 CGI/Perl 脚本不显示背景图像

> ID：13884762
> 
> 赞同：0
> 
> 时间：2012-12-14T19:04:32.530
> 
> 标签：perl, cgi

```
#!/usr/local/bin/perl
use warnings;
use strict;

use CGI qw(:standard);
print header;
print start_html(-title=>"Hello World", 
-bgcolor=>"#cccccc", -text=>"#999999",
-background=>"healo.jpg"); 
```

颜色显示，但不显示图像。我有 healo.jpg 位于 bin 文件夹和我的主文件夹中。我从[http://www.cgi101.com/book/ch1/text.html 获取](http://www.cgi101.com/book/ch1/text.html)此代码 请帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:12:12.777

如果您的 CGI 脚本是标准`cgi-bin`的，则该文件`healo.jpg`不能存储在那里，因为它不是 CGI 脚本。试着把它放在别的地方。

例如，您可以将图像文件放在您的 wwwroot 中，这样您就可以在[http://csvlife.com/healo.jpg](http://csvlife.com/healo.jpg)找到它（那里已经有一些东西了），然后将那部分代码更改为`-background=>"/healo.jpg"`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:07:59.123

检查您生成的 HTML。这将生成表单的背景属性：

```
background = 'healo.jpg' 
```

这意味着 healo.jpg 需要与您当前所在的目录位于同一目录中，这可能与您的主文件夹不同。

您要么需要将图像复制到 webroot（您可能不能这样做），要么将参数更改为`start_html`绝对路径，例如`background ='/healo.jpg'`

# .net - AXWebBrowser 进度条错误

> ID：13884763
> 
> 赞同：0
> 
> 时间：2012-12-14T19:04:38.297
> 
> 标签：.net, vb.net, com

我无法让工具条中的进度条 1 正常工作。我打算在页面加载时显示该栏。我的代码是这样的：

```
Private Sub Webframe_ProgressChange(ByVal sender As Object, ByVal e As AxSHDocVw.DWebBrowserEvents2_ProgressChangeEvent) Handles Webframe.ProgressChange

    If e.progress > -1 Then

        ToolStripProgressBar1.Maximum = Convert.ToInt32(e.progressMax)

        ToolStripProgressBar1.Value = Convert.ToInt32(e.progress)

    End If

End Sub 
```

它适用于几个页面加载，然后我收到以下错误：

System.ArgumentOutOfRangeException {“‘1020000’的值对‘值’无效。‘值’应介于‘最小值’和‘最大值’之间。参数名称：值”}

当我查看 e.progress 时，该值为 1020000，而 progressmax 仍为 1000000。即使我将最大值指定为该数量的两倍，问题仍然存在并且 value 参数上的错误。不确定我是否真的能做些什么，因为我没有分配 e.progress 或 e.progressmax 的值

# php - ajax将链接文本移动到链接标签之外

> ID：13884768
> 
> 赞同：0
> 
> 时间：2012-12-14T19:05:00.060
> 
> 标签：php, jquery, ajax

我有一个 ajax 请求来加载一个带有过滤信息的表。

例如：选择一名员工，点击“开始”以仅查看该员工的结果。

数据过滤正确。PHP 在 ajax 加载的文件中显示：

```
echo "<td><a href=\"creditcard.php?type=Edit&cc_id=".$cc_id."\" />Edit</a></td>"; 
```

加载数据后，DOM 显示：

```
<td><a href="creditcard.php?type=Edit&cc_id=8"></a>Edit</td> 
```

我的 AJAX 调用如下所示：

```
$('#go').live('click', function(e){
        e.preventDefault();
        $(this).hide();
        $(".Results").hide();
        $(".loading").html("<p>Loading...</p>");
        var employee = $('.employee').val();
        var cardtype = $('.cardtype').val();
        var startdate = $('.startdate').val();
        var enddate = $('.enddate').val();
        dataString = "ajax_employee="+employee+"&ajax_cardtype="+cardtype+"&ajax_startdate="+startdate+"&ajax_enddate="+enddate;
        $.ajax({
            type: "POST",
            url: "includes/creditcardsearch.php",
            data: dataString,
            success: function(result){
                $('.Results').html(result);
            },
            complete: function() {
                $(".loading").html('');
                $('.Results').fadeIn('slow');
                $("#go").show();
            }
        });
    }); 
```

有谁知道它为什么这样做？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T19:07:37.980

你有`a self closing anchor tag`

```
.$cc_id."\" />Edit</a>  
            ^----    Need to remove this Forward Slash 
```

将其更改为

```
.$cc_id."\" >Edit</a> 
```

由于`Extra closing tag`，它被解释为元素的结尾并将文本推到外面`Anchor Tag`

# json - 使用队列反序列化一个类 使用 Newtonsoft.Json

> ID：13884777
> 
> 赞同：2
> 
> 时间：2012-12-14T19:05:45.487
> 
> 标签：json, c#-4.0, queue, deserialization, json.net

我有一个具有队列类型属性的类。尝试反序列化 JSON 时，出现以下错误：

> **JSON** 'ConsoleApplication1.Task[], ConsoleApplication1, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'**中指定的类型与**'System.Collections.Generic.Queue`1[[ConsoleApplication1.Task, ConsoleApplication1, Version =1.0.0.0，文化=中性，PublicKeyToken=null]]，系统，版本=4.0.0.0，文化=中性，PublicKeyToken=b77a5c561934e089'。路径“Tasks.$type”，第 1 行，位置 140。

我已经包含了下面的示例应用程序，并且我使用的是 Newtonsoft.Json 4.5.10.15407。

我使用队列而不是列表或字典的原因是因为我必须保留插入顺序。我也尝试在文档和其他问题中进行搜索，但还没有真正找到任何具体的东西。任何帮助深表感谢。谢谢你。

```
namespace ConsoleApplication1
{
    using System;
    using System.Collections.Generic;
    using System.Text;
    using Newtonsoft.Json;

    class Program
    {
        static void Main(string[] args)
        {
            Message message = new Message
                {
                    MessageID = 1,
                    Tasks = new Queue<Task>()
                };
            message.Tasks.Enqueue(new Task{TaskId = 1, Message = "Test1", Parameters = "Param1"});
            message.Tasks.Enqueue(new Task{TaskId = 2, Message = "Test2", Parameters = "Param2"});

            byte[] bSerialized = SerializeJsonWithPrefix(message);
            Message deserializedMessage = DeserializeJson(bSerialized, typeof (Message));
        }

        public static byte[] SerializeJsonWithPrefix(Message item)
        {
            JsonSerializerSettings jss = new JsonSerializerSettings();
            jss.TypeNameHandling = TypeNameHandling.All;
            return Encoding.UTF8.GetBytes(JsonConvert.SerializeObject(item, jss));
        }

        public static Message DeserializeJson(byte[] ueaData, Type concreteType)
        {
            JsonSerializerSettings jss = new JsonSerializerSettings();
            jss.TypeNameHandling = TypeNameHandling.All;

            // --- Error occurs here ---
            var result = JsonConvert.DeserializeObject(Encoding.UTF8.GetString(ueaData), concreteType, jss);
            return (Message)result;
        }
    }

    public class Message
    {
        public int MessageID { get; set; }
        public Queue<Task> Tasks { get; set; } 
    }

    public class Task
    {
        public int TaskId { get; set; }
        public string Message { get; set; }
        public string Parameters { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-10T10:14:14.733

版本 5 解决了您的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-16T06:00:30.520

我坚持使用 JSON.NET 序列化时，其中 T 是一些 JSON 可序列化类型`List<T>`。`Dictionary<string, T>`这些很好地对应于 JSON 数组和对象类型（参见[json.org](http://json.org/)）。

如果你序列化 a`List<T>`然后反序列化它，JSON.NET 当然会保持顺序。我建议只在您`Queue<T>`和 a之间进行转换以`List<T>`进行序列化，而不是尝试添加行为以直接序列化`Queue<T>`.

# c# - DirectoryInfo.Delete 与 Directory.Delete

> ID：13884781
> 
> 赞同：3
> 
> 时间：2012-12-14T19:06:07.823
> 
> 标签：c#, .net, directory

我想删除一些临时文件的内容，所以我正在开发一个为我删除它们的小程序。我有这两个代码示例，但我很困惑：

1.  哪个代码示例更好？
2.  第一个示例 code1 删除文件 1 和 2 但第二个示例 code2 将删除文件夹 1 和 2 的包含？

代码1

```
 public void DeleteContains(string Pathz)
    {
        List<DirectoryInfo> FolderToClear = new List<DirectoryInfo>();
        FolderToClear.Add(new DirectoryInfo(@"C:\Users\user\Desktop\1"));
        FolderToClear.Add(new DirectoryInfo(@"C:\Users\user\Desktop\2"));

        foreach (DirectoryInfo x in FolderToClear)
        {
            x.Delete(true);
        }
    } 
```

代码 2

```
 private void DeleteContents(string Path)
    {
        string[] DirectoryList = Directory.GetDirectories(Path);
        string[] FileList = Directory.GetFiles(Path);

        foreach (string file in FileList)
        {
            File.Delete(file);
        }
        foreach ( string directoryin DirectoryList)
        {
            Directory.Delete(directory, true);
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:24:12.210

EDIT: I believe the OP wants a comparison of DirectoryInfo.Delete and Directory.Delete.

If you look at the decompiled source for each method (I used resharper to show me), you can see that DirectoryInfo.Delete and Directory.Delete both call the Delete method with 4 arguments. IMHO, the only difference is that Directory.Delete has to call Path.GetFullPathInternal to get the fullpath. Path.GetFullPathInternal is actually a very long method with lots of checks. Without doing a series of tests for performance, it would be unlikely to determine which is faster and by how much.

Directory.Delete

```
 [ResourceExposure(ResourceScope.Machine)]
    [ResourceConsumption(ResourceScope.Machine)]
    public static void Delete(String path, bool recursive)
    { 
        String fullPath = Path.GetFullPathInternal(path);
        Delete(fullPath, path, recursive, true); 
    } 
```

DirectoryInfo.Delete

```
 [ResourceExposure(ResourceScope.None)] 
    [ResourceConsumption(ResourceScope.Machine, ResourceScope.Machine)]
    public void Delete(bool recursive) 
    {
        Directory.Delete(FullPath, OriginalPath, recursive, true);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:10:02.913

第一个代码示例将只删除文件夹“C:\Users\user\Desktop\1”和“C:\Users\user\Desktop\2”，而不管参数中传递了什么。

第二个代码示例将删除参数指定的目录内的所有文件和文件夹。

# java - 使用 JAXB 创建 spring bean 和必要的属性

> ID：13884782
> 
> 赞同：1
> 
> 时间：2012-12-14T19:06:09.303
> 
> 标签：java, jaxb

我无法自定义我的 JAXB Marshaller。我有我的编组器代码：

```
public void marshaller(AddressMap addMap, File file) {
    try {
        JAXBContext jaxbContext = JAXBContext.newInstance(AddressMap.class);
        Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

        jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        jaxbMarshaller.marshal(addMap, System.out);

    } catch (JAXBException e) {
        e.printStackTrace();
    }
} 
```

输出如下所示：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ObjectMap>
 <Prop> Indiana</Prop>
 <Prop1>39.0</Prop1>
 <Prop2>-85.0</Prop2>
 <Prop3> United States</Prop3>
 <Prop4> Hueseman Rd</Prop4>
 <Prop5> 8540-8704</Prop5>
 <Prop6> 47001</Prop6>
</ObjectMap> 
```

相反，我需要它看起来像这样：

```
<bean class="classname">
    <property name="PropName" value="object value" />
    <property name="PropName1" value="object value" />
    <property name="PropName2" value="object value" />
    <property name="PropName3" value="object value" />
    <property name="PropName4" value="object value" />
    <property name="PropName5" value="object value" />
    <property name="PropName6" value="object value" />
</bean> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:56:06.170

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

您可以使用 MOXy`@XmlDesciminatorNode`和`@XmlPath`扩展来映射此用例。下面是一个基于我假设您的对象模型外观的示例。

**对象映射**

注释允许您指定您希望特定的`@XmlDescriminatorNode`XML 属性用作继承指示符。

```
package forum13884782;

import javax.xml.bind.annotation.XmlRootElement;

import org.eclipse.persistence.oxm.annotations.XmlDiscriminatorNode;

@XmlRootElement(name="bean")
@XmlDiscriminatorNode("@class")
public class ObjectMap {

} 
```

**地址映射**

`@XmlDescriminatorValue`注释用于指定与实例类相关的描述符节点上的值。在这个类中，我们还使用`@XmlPath`注释来指示`property`我们希望根据其`name`属性值映射到哪个元素。

```
package forum13884782;

import javax.xml.bind.annotation.*;

import org.eclipse.persistence.oxm.annotations.*;

@XmlRootElement(name="bean")
@XmlAccessorType(XmlAccessType.FIELD)
@XmlDiscriminatorValue("AddressMap")
public class AddressMap extends ObjectMap {

    @XmlPath("property[@name='PropName']/@value")
    String prop;

    @XmlPath("property[@name='PropName1']/@value")
    String prop1;

    @XmlPath("property[@name='PropName2']/@value")
    String prop2;

    @XmlPath("property[@name='PropName3']/@value")
    String prop3;

    @XmlPath("property[@name='PropName4']/@value")
    String prop4;

    @XmlPath("property[@name='PropName5']/@value")
    String prop5;

    @XmlPath("property[@name='PropName6']/@value")
    String prop6;

} 
```

**jaxb.properties**

要将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`在与您的域模型相同的包中调用的文件，其中包含以下条目。

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

以下演示代码会将 XML 消息转换为 XML 的实例，`AddressMap`然后再转换回 XML。

```
package forum13884782;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(AddressMap.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum13884782/input.xml");
        AddressMap addressMap = (AddressMap) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(addressMap, System.out);
    }

} 
```

**输入.xml/输出**

```
<bean class="AddressMap">
    <property name="PropName" value="Indiana" />
    <property name="PropName1" value="39.0" />
    <property name="PropName2" value="-85.0" />
    <property name="PropName3" value="United States" />
    <property name="PropName4" value="Hueseman Rd" />
    <property name="PropName5" value="8540-8704" />
    <property name="PropName6" value="47001" />
</bean> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/11/jaxb-and-inheritance-moxy-extension.html](http://blog.bdoughan.com/2010/11/jaxb-and-inheritance-moxy-extension.html)
*   [http://blog.bdoughan.com/2011/03/map-to-element-based-on-attribute-value.html](http://blog.bdoughan.com/2011/03/map-to-element-based-on-attribute-value.html)
*   [http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)

# php - PHP if 语句忽略变量检查

> ID：13884785
> 
> 赞同：0
> 
> 时间：2012-12-14T19:06:29.727
> 
> 标签：php, if-statement

我的 if 语句不断查看我的一个变量并查看 or 语句并返回 true。我讨厌在展示之前描述编码......

```
if($relLoc[1] <= "32" AND $map['locationpadding'] == "0px 0px -32px 0px" OR $map['locationpadding'] == "0px 0px -32px -32px" OR $map['locationpadding'] == "0px -32px -32px 0px")
{
    die();
} 
```

因此，如果我在并且`$map['locationpadding'] == "0px 0px -32px -32px"`仍然 执行。`$relLoc[1] == "380"``die();`

但是，如果我在`0px 0px -32px 0px`它不会执行，直到我在该`32`位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:09:33.007

您没有正确分组逻辑语句。我不知道 PHP 所以语法可能是关闭的，但你基本上想要这个：

```
if($relLoc[1] <= "32"  AND **(** $map['locationpadding'] == "0px 0px -32px 0px" OR $map['locationpadding'] == "0px 0px -32px -32px" OR $map['locationpadding'] == "0px -32px -32px 0px"**)** ){
            die();
        } 
```

注意表示正确的布尔语句组的附加括号。您在原始帖子中所做的是：

```
if relLoc == 32 AND  $map['locationpadding'] == "0px 0px -32px 0px

  +  
OR $map['locationpadding'] == "0px 0px -32px -32px"   
  + 
OR $map['locationpadding'] == "0px -32px -32px 0px 
```

因此，在您提供的示例中，它将是这样的：

```
$map['locationpadding'] == "0px 0px -32px -32px" and the $relLoc[1] == "380" 
```

这是：

```
 False + True + False = True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:09:41.797

看起来你想要：

```
if($relLoc[1] <= "32" AND ($map['locationpadding'] == "0px 0px -32px 0px" OR $map['locationpadding'] == "0px 0px -32px -32px" OR $map['locationpadding'] == "0px -32px -32px 0px")){
//                        ^ added                                                                                                                                                ^ added 
```

使用括号分隔子条件，否则您的第一个条件变得不那么相关，因为在那之后您有 OR x OR x OR x，因此只有一个 OR 必须评估为真，整个条件才能评估为真。

# c++ - 在 C++ 中使用友元函数

> ID：13884788
> 
> 赞同：2
> 
> 时间：2012-12-14T19:06:39.107
> 
> 标签：c++, class, friend, friend-class

刚刚阅读了朋友函数，我正在尝试使用 B 类的朋友函数“打印”访问 A 类中的私有变量“数字”。我正在使用 Visual Studio。我的代码的编译给了我很多各种各样的错误，比如：

> C2011：“A”：“类”类型重新定义
> C2653：“B”：不是类或命名空间名称

请耐心等待我，并展示实现我目标的正确方法。

这是我的文件啊：

```
class A
{
public:
    A(int a);
    friend void B::Print(A &obj);
private:
    int number;
}; 
```

A.cpp：

```
#include "A.h"

A::A(int a)
{
    number=a;
} 
```

乙：

```
#include <iostream>
using namespace std;
#include "A.h"
class B
{
public:
    B(void);
    void Print(A &obj);
}; 
```

B.cpp：

```
#include "B.h"

B::B(void){}

void B::Print(A &obj)
{
    cout<<obj.number<<endl;
} 
```

主.cpp：

```
#include <iostream>
#include <conio.h>
#include "B.h"
#include "A.h"

void main()
{
    A a_object(10);
    B b_object;
    b_object.Print(A &obj);
    _getch();
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:25:57.327

...其次，您可能需要`B`在头文件中对类进行前向声明以作为朋友`A.h`引用：`B`

```
#ifndef _A_H_
#define _A_H_
class B;

class A
{
     friend class B;
};
#endif 
```

**更新**
~~我目前不太确定是否可以将成员函数声明为朋友，我会看看。~~

无法创建成员函数`friend`声明，您可以将全局函数或整个类声明为朋友，另请参阅：[C++ ref、友谊和继承](http://www.cplusplus.com/doc/tutorial/inheritance/)。

一般来说，使用它根本不是一个好的设计理念`friend`，因为它将类强耦合在一起。更好的解决方案是耦合接口（无论如何都不需要公开可见）。
在极少数情况下，这可能是一个好的设计决策，但几乎总是适用于内部细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:14:10.197

首先你需要把

```
#ifndef A_H
#define A_H
.... your A-class definition
#endif 
```

在你的 Ah 和 Bh 中类似，这样就可以防止同一文件的多个包含（这是你的重复定义错误）......

# java - 测量通过套接字发送的数据的大小

> ID：13884793
> 
> 赞同：0
> 
> 时间：2012-12-14T19:07:26.107
> 
> 标签：java, sockets, bandwidth

我在考虑如何读取通过 Socket 发送的数据量。例如，如果我创建了一个聊天应用程序，然后想知道一条消息需要多少（以千字节或字节为单位），我将如何衡量这个？

我发送一条消息，例如“你好，世界！”。如何测量发送所需的带宽量？

我知道有一些程序可以监控通过网络发送和接收的数据量等等，但我想自己尝试做这件事来学习一些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T21:01:46.480

将套接字的输出流包装在[CountingOutputStream](http://commons.apache.org/io/apidocs/org/apache/commons/io/output/CountingOutputStream.html)中：

```
CountingOutputStream cos = new CountingOutputStream(socket.getOutputStream());
cos.write(...);
System.out.println("wrote " + cos.getByteCount() + " bytes"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:16:35.217

如果您发送没有标头（协议）的原始字符串对于您拥有的字符串

```
String hello = "Hello World";
hello.getBytes().length //size of the message 
```

为了在发送文件时向用户显示进度，您可以这样做

```
Socket s = new Socket();
//connect to the client, etc...

//supose you have 5 MB File
FileInputStream f = new FileInputStream( myLocalFile );

//declare a variable
int bytesSent = 0;
int c;
while( (c = f.read()) != -1) {
   s.getOutputStream().write(c);
   bytesSent++; //One more byte sent!
   notifyGuiTotalBytesSent(bytesSent);
} 
```

好吧，这只是一个非常简单的实现，不使用缓冲区来读取和发送数据，只是为了让你明白。方法 nitify.... 将在 GUI 线程（不是这个）中显示 bytesSent 值

# url - Lightbox2 fb:comments img id

> ID：13884794
> 
> 赞同：1
> 
> 时间：2012-12-14T19:07:26.947
> 
> 标签：url, image, facebook-social-plugins, lightbox2

如何获取 facebook href 的照片 ID？每张照片都有自己的评论？在 .lb-caption 中的照片链接是通过 php 里面的，在 "fb:comments" 的 href 中大约有 java

谢谢您的帮助！

**灯箱.js**

```
 if (typeof this.album[this.currentImageIndex].title !== 'undefined' && this.album[this.currentImageIndex].title !== "") {
    $lightbox.find('.lb-caption').html(this.album[this.currentImageIndex].title).fadeIn('fast');
        $lightbox.find('.lb-facebook').load('facebook.php'); 
```

**脸书.php**

```
<meta property="fb:admins" content="{markus.luttinger}"/>
<div id="fb-root"></div>
<fb:comments href="" num_posts="2" colorscheme="dark" width="460"></fb:comments>
<script>FB.XFBML.parse();</script> 
```

# iphone - 如何在 Interface Builder 中创建 NSToggleButton？

> ID：13884795
> 
> 赞同：0
> 
> 时间：2012-12-14T19:07:30.330
> 
> 标签：iphone, ios, xcode, button, interface-builder

我想制作一个 NSToggleButton，因为它非常适合我的需求：打开时显示一个图像，关闭时显示另一个图像。

来自 Apple 的开发者网站：

“第一次单击后，按钮显示其备用图像或标题；第二次单击使按钮返回其正常状态。此选项在 Interface Builder 的按钮检查器中称为“切换”。在 OS X v10.0 及更高版本中可用。“ -[来源](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSButtonCell_Class/Reference/Reference.html#//apple_ref/doc/c_ref/NSToggleButton)

但是，当查看我在 Interface Builder 中创建的圆形矩形按钮时，我找不到“切换”属性。我的 google 和 StackOverflow 搜索只产生有关控件属性的问题，但我还没有找到专门用于创建此按钮的教程。

如何在 Interface Builder 中创建 NSToggleButton？它在对象库中的什么位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:13:01.590

您提供的源代码用于 OSX 编程。不是 iOS，但是这可以自己实现。一个 UIButton 只是一个 UIView 所以添加一个 UIImageView 作为子视图然后当按钮被点击时设置`hidden`为 YES 或 NO

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:13:18.330

NSToggleButton 是一个 AppKit 类——仅限 MacOS X。如果您正在构建 iOS 应用程序，您将找不到它。Foundation 框架中的类具有`NS`前缀并且在 iOS 中可用（NSArray、NSDictionary 等），但 iOS 中的用户界面类在 UIKit 中并具有`UI`前缀。看看 [UISwitch](http://developer.apple.com/library/ios/ipad/#documentation/uikit/reference/UISwitch_Class/Reference/Reference.html)是否有类似的功能。

# php - 为什么 hash_hmac 为这两个大数做不同的哈希？

> ID：13884803
> 
> 赞同：0
> 
> 时间：2012-12-14T19:08:04.153
> 
> 标签：php, type-conversion, gmp, hmac

为什么hmac值不同？$a 等于 $b。我不确定是哪种错误导致了这种情况，或者我的逻辑是否正确。Hmac_hash 应该将任何输入转换为字符串到字节或十六进制并完成它的工作，告诉我我是否错了。

下面的示例代码。

谢谢你。

```
<?php

$a = 1234567890000*1234567890000;
$b = gmp_mul("1234567890000","1234567890000");
$b = gmp_strval($b);

echo $a."<br/>".$b."<br/>";

$c = 2525;

echo ($a==$b)."<br/>";

echo hash_hmac("SHA512",$a,$c);
echo "<br/>";
echo hash_hmac("SHA512",$b,$c);

?> 
```

结果

```
1.5241578750191E+24
1524157875019052100000000
1
973967436d3562150d60769b70a9010db21f89b114b9897430663dd195115b7893b9a6bd0e141cee301d23e2229afd6d39546630cd38f6fe7842073749f9ce3d
8bd1e7c837efaf8d51ed2d40354a020ee3c9663aa6bd4425c02b21ed02343185070216d37e54478ee78332af8e6fdecd51445fcee8cb04d4e51e4cc31283f9a9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:04:29.537

当你比较`$a`and`$b`时，里面的字符串`$b`被转换成一个整数。因为该值大于 PHP 可以表示为整数的值，所以它被默默地转换为浮点数。 `$a`是一个浮点数。浮点数相等，这就是比较成功的原因。

`hash_hmac`将浮点数`$a`转换为字符串，而不是将字符串`$b`转换为整数，然后溢出成浮点数。这就是哈希值不同的原因。

如果您希望比较失败以使其之间的行为`hash_hmac`保持一致，则您需要先`$a`转换为字符串，或者要使用它`===`来避免转换数据类型。

# sql - Microsoft SQL MAX() 不包括具有 NULL 的行

> ID：13884805
> 
> 赞同：0
> 
> 时间：2012-12-14T19:08:09.330
> 
> 标签：sql, sql-server, null, max

我在一家拥有案例管理系统的律师事务所工作，该系统将接口链接到 SQL 数据库。我正在 SSRS 中编写查询以运行报告。我正在尝试对案例信息进行报告。一些信息在“cases”表（或 vcases 视图）中是正确的，但我也在尝试从“demands_offers”表中链接信息。每个案例可以有多个需求和报价，因此我在连接中使用 MAX 函数来仅提取每个案例的最新需求记录。不幸的是，这样做消除了没有要求的情况。我需要所有的案例都出现。

我尝试使用嵌套在 MAX 函数中的 CASE 语句将 NULLS 或空字段转换为随机的早期日期，但我仍然无法让所有案例都出现在报告中。

有任何想法吗？我是 SQL 的相对新手，没有受过正规培训。任何帮助将不胜感激。你可以看到下面的代码。（PS 我不认为我有权创建临时表。）

```
SELECT vc.case_number AS "Matter ID", vc.style, vc.atty2_name AS "Handling Attorney", m.max_demands_date, do.demands, do.demands_notes, sa.authorized,      
(SELECT TOP 1 vl.computename        
FROM vcases vca     
LEFT OUTER JOIN case_parties cp     
ON vca.case_sk = cp.case_sk     
JOIN case_parties cpp       
ON cp.parent_sk = cpp.case_parties_sk       
JOIN vlegal_entity vl       
ON vl.legal_entity_sk = cp.entity_sk        
JOIN vlegal_entity vlp      
ON vlp.legal_entity_sk = cpp.entity_sk      
WHERE (vca.case_sk = vc.case_sk) AND (cpp.role_sk = '3557') AND (cp.role_sk = '3986') ) AS "Plaintiff//'s Attorney",        
(SELECT cp.reference_number     
    FROM cases AS ca    
        LEFT OUTER JOIN case_parties AS cp
        ON ca.case_sk = cp.case_sk
    WHERE (cp.role_sk = '3706')     
        AND (ca.case_sk = vc.case_sk)) AS "Claim Number"

FROM        
vcases vc       
LEFT OUTER JOIN     
case_parties cp ON vc.case_sk = cp.case_sk      
LEFT OUTER JOIN     
vlegal_entity vl ON cp.entity_sk = vl.legal_entity_sk       
LEFT OUTER JOIN     
settle_authority sa ON vc.case_sk = sa.case_sk      
LEFT OUTER JOIN         
demands_offers do ON vc.case_sk = do.case_sk        

INNER JOIN      
 (SELECT DISTINCT max(
(CASE WHEN do.demands_date = '' THEN '1/1/1900 00:00:00'
             ELSE do.demands_date
              END)
  ) as "max_demands_date", vc.case_sk       
   FROM vcases AS vc        
   JOIN demands_offers AS do ON vc.case_sk = do.case_sk     
   GROUP BY vc.case_sk) AS m        
  ON vc.case_sk = m.case_sk  AND        
  do.demands_date = m.max_demands_date      

WHERE (vc.closed_ind = 'O') AND (cp.role_sk = '3816') AND (vl.client_number = 'EAS-01') AND (vc.lawtype_code <> 'FA')       
ORDER BY vc.case_number 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:17:54.400

您的查询可能会写得更紧凑，性能更好，但首先，这是在没有要求的情况下删除行的部分：

```
INNER JOIN      
 (SELECT DISTINCT max(
(CASE WHEN do.demands_date = '' THEN '1/1/1900 00:00:00'
             ELSE do.demands_date
              END)
  ) as "max_demands_date", vc.case_sk       
   FROM vcases AS vc        
   JOIN demands_offers AS do ON vc.case_sk = do.case_sk     
   GROUP BY vc.case_sk) AS m        
  ON vc.case_sk = m.case_sk  AND        
  do.demands_date = m.max_demands_date 
```

它需要是

```
LEFT JOIN      
 (SELECT DISTINCT max(
(CASE WHEN do.demands_date = '' THEN '1/1/1900 00:00:00'
             ELSE do.demands_date
              END)
  ) as "max_demands_date", vc.case_sk       
   FROM vcases AS vc        
   JOIN demands_offers AS do ON vc.case_sk = do.case_sk     
   GROUP BY vc.case_sk) AS m        
  ON vc.case_sk = m.case_sk  AND        
  do.demands_date = m.max_demands_date 
```

原因是an`(A INNER JOIN B)`只在A中的行可以匹配到B中的行时才保留记录。当没有需求时，派生表（子查询）返回NULL `max_demands_date`，这是无法匹配的`do.demands_date = m.max_demands_date`。这会导致`case`记录被删除。

# jquery - 链接正则表达式用新的替换 HTML

> ID：13884806
> 
> 赞同：0
> 
> 时间：2012-12-14T19:08:32.500
> 
> 标签：jquery, html, css, regex

我正在尝试运行正则表达式来执行此操作：

替换文档中 apk 文件的所有实例：

```
<a href="http://download.mydomain.com/files/androidfile.apk"> 
```

和：

```
<a target="_blank" href="http://mydomain.com?f=http://download.mydomain.com/files/androidfile.apk"> 
```

使用此 JQUERY 代码：

```
$('body').contents().filter(function() {
    return this.nodeType === 3;
}).each(function() {
    $(this).replaceWith($(this).text().replace(/<a href~/^.*\.(apk)$/i, 'http://mydomain.com?f=">$1</a>'));
}); 
```

所以本质上，删除之前的代码`download.mydomain.com/files/androidfile.apk`，也就是`<a href="http://` 替换为`<a target="_blank" href="http://mydomain.com?f=http://`. 一个页面中可能有几个这样的，所以我需要一个可以匹配并替换所有的解决方案。

正则表达式和替换似乎不起作用，这可能是一个解决方案。

所以总而言之，我希望能够在 JQuery 中做到这一点：

```
<html>

<a href="http://download.domain.com/files/androidfile1.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://download.domain.com/files/androidfile2.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://download.domain.com/files/androidfile3.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://download.domain.com/files/androidfile4.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://download.domain.com/files/androidfile5.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

</html> 
```

对此：

```
<html>

<a href="http://mydomain2.com?f=http://download.domain.com/files/androidfile1.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://mydomain2.com?f=http://download.domain.com/files/androidfile2.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://mydomain2.com?f=http://download.domain.com/files/androidfile3.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://mydomain2.com?f=http://download.domain.com/files/androidfile4.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

<a href="http://mydomain2.com?f=http://download.domain.com/files/androidfile5.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:22:29.537

The code below should do the trick. Rather than use regex, I used the [ends with selector](http://api.jquery.com/attribute-ends-with-selector/). This should serve the same purpose, and execute quicker. Instead of rewriting the tag completely, I just modified the attributes using [jQuery.attr()](http://api.jquery.com/attr/). A live example is [here](http://jsfiddle.net/TjYR6/2/).

```
<!DOCTYPE html>
<html>

<head>
<title>test</title>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">
$(document).ready(function()
{
    $('a[href$=apk]').each(function()
    {
        var mydomain = "http://mydomain2.com?f=";
        var $this = $(this);

        $this.attr("href", mydomain+$this.attr("href"));
        $this.attr("target", "_blank");
    });
});
</script>
</head>

<body>
<a href="http://download.domain.com/files/androidfile1.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>
<a href="http://download.domain.com/files/androidfile2.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>
<a href="http://download.domain.com/files/androidfile3.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>
<a href="http://download.domain.com/files/androidfile4.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>
<a href="http://download.domain.com/files/androidfile5.apk"><img src="theme/download.gif" border=0 alt="download" height="120px" width="130px"></a><br/>

</body>
</html> 
```

The resulting output is:

```
<a target="_blank" href="http://mydomain2.com?f=http://download.domain.com/files/androidfile1.apk"><img src="theme/download.gif" alt="download" height="120px" border="0" width="130px"></a><br>
<a target="_blank" href="http://mydomain2.com?f=http://download.domain.com/files/androidfile2.apk"><img src="theme/download.gif" alt="download" height="120px" border="0" width="130px"></a><br>
<a target="_blank" href="http://mydomain2.com?f=http://download.domain.com/files/androidfile3.apk"><img src="theme/download.gif" alt="download" height="120px" border="0" width="130px"></a><br>
<a target="_blank" href="http://mydomain2.com?f=http://download.domain.com/files/androidfile4.apk"><img src="theme/download.gif" alt="download" height="120px" border="0" width="130px"></a><br>
<a target="_blank" href="http://mydomain2.com?f=http://download.domain.com/files/androidfile5.apk"><img src="theme/download.gif" alt="download" height="120px" border="0" width="130px"></a><br> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:17:44.813

您正在做的是*矫枉过正*，虽然它不起作用，为什么要选择页面上的所有元素？如果您想选择`a`元素，为什么不使用选择它们`$('a')`？要向属性添加字符串`href`，可以使用`attr`方法。

```
$('a').filter(function() {
    return this.href.indexOf('apk')
}).attr('href', function(i, href) {
    return 'http://mydomain.com?f=' + href
}).attr('target', '_blank'); 
```

[http://jsfiddle.net/NCC7u/](http://jsfiddle.net/NCC7u/)

# ruby-on-rails - 使用项目的资产文件夹进行缓慢的 HTTP 加载 - Ruby on Rails、Webrick、Localhost、Firefox

> ID：13884810
> 
> 赞同：0
> 
> 时间：2012-12-14T19:08:48.963
> 
> 标签：ruby-on-rails, firefox, ruby-on-rails-3.2, webrick, firefox4

# HTTP 协议：

***注意：**在录制 HTTP 协议之前缓存已经被清除。*

这是***Firefox***的***HTTP Watch***插件的***HTTP 协议***：[http ://www.mediafire.com/view/?wccimru3qdu19s2#](http://www.mediafire.com/view/?wccimru3qdu19s2#)

 ****HTTP***负载***约为.`5 seconds`

状态***码***是。`200 OK`

# 问题：

`assets`将文件夹加载到`cache`Firefox 中并不`GET`仅仅在***第一次***渲染 Web 应用程序时执行请求 - 它还在每次页面加载时重复执行，因此***每个页面渲染***都变得太慢。

# 问题：

1.  ***Webrick、Ruby 或 Rails***中是否有特定内容可能导致 Firefox 执行重复`GET`请求？

2.  ***HTTP 加载***在 Web 应用程序的第一次渲染中进行，因此可以在 Firefox 中加载该文件`5 seconds`夹***-***`assets`是否`cache`有***提高***加载速度的程序？

# 附录：

安装的`rails-dev-tweaks`速度从大约`5 seconds`到大约增加了一次`2.5 seconds`。到目前为止，重复`GET`请求仍然是一个持续存在的问题，这意味着`2.5 seconds`每个***页面的加载***仍然太慢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:10:24.300

添加

```
rails-dev-tweaks 
```

[https://github.com/wavii/rails-dev-tweaks](https://github.com/wavii/rails-dev-tweaks)

到您的 Gemfile 用于“开发”环境...

目前问题应该只在开发环境中，在生产中它应该已经可以正常工作了****

# wcf - WCF 服务库 Agatha 初始化容器

> ID：13884813
> 
> 赞同：1
> 
> 时间：2012-12-14T19:08:53.127
> 
> 标签：wcf, inversion-of-control, agatha-rrsl

我开发了一个使用 Agatha RRSL 的 WCF 服务库，但我不知道如何初始化容器。如果我在 ASP.NET Web 应用程序中重新创建此服务，我可以从 Global.asax.cs Application_Start() 调用初始化代码，并且一切正常。初始化代码为：

```
public static class ComponentRegistration
{
    public static void Register()
    {
      new ServiceLayerConfiguration(Assembly.GetExecutingAssembly(),
      typeof(HelloWorldRequest).Assembly,
      typeof(Agatha.Castle.Container)).Initialize();
    }
} 
```

在 WCF 服务库中，我添加了一个 App_Code 文件夹，其中包含一个调用：

```
public static void AppInitialize()
{
    ComponentRegistration.Register();
} 
```

这不起作用，因为我的客户端应用程序抛出了一个异常，即该类型没有响应。我还尝试向 web.config 文件添加一个组件，但我从来没有接近工作。

我还尝试创建一个执行初始化的自定义 ServiceHost：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ServiceModel;
using System.ServiceModel.Activation;
using Agatha.ServiceLayer;
using System.Reflection;
using Sample.Common.RequestsAndResponses;

namespace Sample.ServiceLayer.WCFHost
{
    public class CustomServiceHostFactory : ServiceHostFactory
    {
        public CustomServiceHostFactory()
        {
            new ServiceLayerConfiguration(Assembly.GetExecutingAssembly(), typeof(HelloWorldRequest).Assembly,
                typeof(Agatha.Castle.Container)).Initialize();
        }

        protected override ServiceHost CreateServiceHost(Type serviceType, Uri[] baseAddresses)
        {
            return new CustomServiceHost(serviceType, baseAddresses);
        }
    }

    public class CustomServiceHost : ServiceHost
    {
        public CustomServiceHost()
        {
        }

        public CustomServiceHost(Type serviceType, params Uri[] baseAddresses)
            : base(serviceType, baseAddresses)
        {
        }

        protected override void OnOpening()
        {
            base.OnOpening();
        }

        protected override void OnClosing()
        {
            base.OnClosing();
        }

        protected override void ApplyConfiguration()
        {
            base.ApplyConfiguration();
        }
    }
} 
```

但是，我的客户遇到了同样的异常：

```
System.InvalidOperationException was unhandled
  Message=There is no response with type Sample.Common.RequestsAndResponses.HelloWorldResponse. Maybe you called Clear before or forgot to add appropriate request first.
  Source=Agatha.Common
  StackTrace:
       at Agatha.Common.RequestDispatcher.Get[TResponse]() in c:\src\Agatha\Agatha.Common\RequestDispatcher.cs:line 125
       at Agatha.Common.RequestDispatcher.Get[TResponse](Request request) in c:\src\Agatha\Agatha.Common\RequestDispatcher.cs:line 150
       at ConsoleApplication1.Program.Main(String[] args) in C:\Users\ultraviolet\Documents\Visual Studio 2010\Projects\AgathaHelloWorld\ConsoleApplication1\Program.cs:line 20
       at System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
       at System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
       at Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
       at System.Threading.ThreadHelper.ThreadStart_Context(Object state)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
       at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
       at System.Threading.ThreadHelper.ThreadStart()
  InnerException: 
```

我应该采取什么方法让 WCF 服务库运行我的初始化代码，以便主机返回正确的类型？任何指导将不胜感激。谢谢。

# python - Python/GAE 属性错误 - webapp2

> ID：13884815
> 
> 赞同：3
> 
> 时间：2012-12-14T19:08:57.283
> 
> 标签：python, google-app-engine, jinja2, webapp2

我正在使用[Nick Johnsons Webapp & Templates](http://blog.notdot.net/2011/11/Migrating-to-Python-2-7-part-2-Webapp-and-templates)应用程序作为我正在尝试做的事情的基础。当我尝试调用 render_template 时，我收到“AttributeError：'NoneType' 对象没有属性 'write'”。我知道这是因为当我将对象“Capture”实例化为 X 时，它没有响应属性。我到处寻找解决方案，但在任何地方都找不到。

注意：还有其他方法可以做到这一点，但我需要它与我的设置方式一样紧密！

追溯：

```
Traceback (most recent call last):
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1535, in __call__
    rv = self.handle_exception(request, response, e)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1529, in __call__
    rv = self.router.dispatch(request, response)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 1102, in __call__
    return handler.dispatch()
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 572, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/Applications/GoogleAppEngineLauncher.app/Contents/Resources/GoogleAppEngine-default.bundle/Contents/Resources/google_appengine/lib/webapp2/webapp2.py", line 570, in dispatch
    return method(*args, **kwargs)
  File "/Users/userx/Documents/_FRESHCUTZ MEDIA/Google/GAE - Test web form 1 /testwebform1/main.py", line 41, in post
    x.calculateYear(name, age)
  File "/Users/userx/Documents/_FRESHCUTZ MEDIA/Google/GAE - Test web form 1 /testwebform1/main.py", line 49, in calculateYear
    self.response.write(self.render_template('index.html', **template_args))
AttributeError: 'NoneType' object has no attribute 'write' 
```

主文件

```
import os
import webapp2
from webapp2_extras import jinja2

class BaseHandler(webapp2.RequestHandler):
  @webapp2.cached_property
  def jinja2(self):
        return jinja2.get_jinja2(app=self.app)

  def render_template(self, filename, **template_args):
        self.response.write(self.jinja2.render_template(filename, **template_args))

class MainPage(BaseHandler):
  def get(self):
    template_args = {}
    self.render_template('index.html', **template_args)

class CaptureDetails(BaseHandler):
  def post(self):
    name = self.request.get("name").strip()
    age = self.request.get("age").strip()

    x = Calculate()
    x.calculateYear(name, age)

class Calculate(BaseHandler):
    def calculateYear(self, name, age):
       template_args = {"age": age} 
       self.render_template('name.html', **template_args) 

app = webapp2.WSGIApplication([
      ('/', MainPage),
      ('/capture', CaptureDetails),
      ('/age', Calculate)
    ], debug=True) 
```

我究竟做错了什么？非常感谢任何帮助/建议！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T20:00:54.133

`calculateYear`如果您为您的`BaseHandler`班级提供功能（或其他地方，如果更适用），它是否符合您的标准？如您所料，您`x`没有被视为适当的`response`. 当您调用`webapp2.RequestHandler`处理程序时，它会调用与请求类型关联的方法（因此，在您的情况下，由于您正在发布表单，它将调用`post()`，如您所知）。当您实例化`x`和调用`calculateYear`时，您没有指定特定的方法（`def get(self)`、`def post(self)`等），因此没有准备 a `response`（当我有机会时，我会稍微挖掘一下以确认情况确实如此 - 我可能是错误的:) )。

现在无法对此进行测试，但假设您需要调用`calculateYear`的不仅仅是`CaptureDetails`处理程序，这可行吗？在这里，您将`self`在方法的上下文中引用`post`，这将调用`response`处理：

```
class BaseHandler(webapp2.RequestHandler):
  @webapp2.cached_property
  def jinja2(self):
      return jinja2.get_jinja2(app=self.app)

  def render_template(self, filename, **template_args):
      self.response.write(self.jinja2.render_template(filename, **template_args))

  def calculateYear(self, name, age):
      template_args = {"age": age} 
      self.render_template('name.html', **template_args) 
```

然后您可以从您的`CaptureDetails`处理程序中调用它，例如：

```
class CaptureDetails(BaseHandler):
  def post(self):
    name = self.request.get("name").strip()
    age = self.request.get("age").strip()

    # Call the function and write the response
    self.calculateYear(name, age) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T20:02:23.413

通过在您的方法中实例化`Calculate`自己，您`CaptureDetails.post`不会以与创建方法相同的方式创建它`WSGIApplication`，因此属性不可用。具体来说，您没有将 a 传递`response`给它，因此尝试引用它不起作用也就不足为奇了。

在这种情况下，我会将 的内容复制`calculateYear`到您的 post 方法中——您并没有真正通过创建实例然后调用它的方法来保存任何东西。如果`calculateYear`变得更复杂，并且您不希望重复，那么我将介绍一种可以由您的两个处理程序方法调用的新方法。（虽然这个类为什么存在，但从这个例子中并不清楚`Calculate`——它没有“get”方法，所以`/age`按照你所做的映射它是行不通的。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:36:13.517

尝试使用`self.response.out.write`而不是`self.response.write`.

# php - 致命错误：找不到类“Zend\Form\Element”

> ID：13884819
> 
> 赞同：0
> 
> 时间：2012-12-14T19:09:06.293
> 
> 标签：php, zend-framework2

在我的 webapp/index.php 中，我定义了 include_path，如下所示：

```
<?php
    set_include_path(implode(PATH_SEPARATOR, array(
        'C:\Program Files\NetBeans 7.1.2\php\library',
        get_include_path()
    )));
    require_once 'Zend\Form\Fieldset.php';
?>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title></title>
    </head>
    <body>
       <?php
            #do something with Fieldset class;
       ?>
    </body>
</html> 
```

但是当我运行文件时，我不断收到此错误消息：

```
 Fatal error: Class 'Zend\Form\Element' not found in C:\Program Files\NetBeans 7.1.2\php\library\Zend\Form\Fieldset.php 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:21:30.030

我从来没有尝试过像那样使用 zf（在它的 mvc 之外），但我猜你需要设置自动加载器，以便 Zend 可以找到它的不同类。

通常 Zend 的自动加载器会在 \Zend\Form\Element\Text.php 中寻找 Zend_Form_Element_Text 类

看看[文档](http://framework.zend.com/manual/1.12/en/zend.loader.autoloader.html)

# c - 如果 pthread_cond_wait 不是原子的会发生什么？

> ID：13884820
> 
> 赞同：1
> 
> 时间：2012-12-14T19:09:09.713
> 
> 标签：c

场景一：释放互斥体然后等待场景二：等待然后释放互斥体

试图从概念上理解它的作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T19:19:09.833

如果互斥锁在调用线程被认为在条件变量上“阻塞”之前被释放，那么另一个线程可以锁定互斥锁，更改谓词所基于的状态，并在等待线程永远不会醒来的情况下调用（因为它`pthread_cond_signal` **不是**仍然被阻止）。那就是问题所在。

场景 2，等待然后释放互斥体，是任何现实世界实现必须在内部工作的方式，因为没有必要行为的原子*实现*。但是从应用程序的角度来看，如果不释放互斥锁，就无法观察到线程是阻塞集的一部分，因此在“抽象机器”的意义上，它是原子的。

**编辑：**更详细地说，条件变量等待的实际实现通常如下所示：

1.  修改条件变量对象的一些内部状态，使得调用者被认为是它的阻塞集的一部分。
2.  解锁互斥锁。
3.  执行阻塞等待操作，其特殊属性是如果步骤 1 中的条件变量对象的状态由于来自任何其他线程的信号而发生更改，它将立即返回。

因此，“阻塞”行为分为两个步骤，其中一个发生在互斥锁解锁之前（获得阻塞集中的成员资格），另一个发生在互斥锁解锁之后（可能休眠并将控制权交给其他人）线程）。正是这种拆分能够使抽象机器中的“条件等待”操作“原子”。

# javascript - 关闭javascript时如何隐藏div

> ID：13884821
> 
> 赞同：2
> 
> 时间：2012-12-14T19:09:22.040
> 
> 标签：javascript, html

我想建议用户在关闭 js 时打开 js 以获得更好的浏览体验。我想用一个绝对的 div 来做这件事，在我声明这个之后，直接通过 js 隐藏它（欢迎任何其他想法如何做到这一点）。但是，当 js 关闭时，如何让用户通过按钮隐藏此 div？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-14T19:13:35.380

使用 CSS3，您可以使用表单输入[伪类](http://www.w3.org/wiki/CSS/Selectors#The_UI_element_states_pseudo-classes)。例如，选中复选框后的 div 可以以特定方式设置样式（或隐藏）。有关简单示例，请参阅[此 jsfiddle](http://jsfiddle.net/fXebt/)。

```
<style>
:checked + div {
    display: none;
}
</style>
…
<input type="checkbox" name="foo">
<div id="hideme">Hide me by checking the checkbox</div> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:12:12.773

div 是个好主意。

无需隐藏 div，只需创建一个链接将用户定向到其中没有 div 的页面。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-14T19:10:58.840

除非您使用帖子重新加载页面或获取对服务器的请求，否则无法在没有 js 的情况下以编程方式“隐藏” div。

`noscript`如果你真的想，你可以使用标签。

```
<noscript>FOO BAR</noscript> 
```

但是没有javascript就没有办法隐藏它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T19:39:11.583

您可以通过 CSS3 来做到这一点，如@kojiro 的解决方案所示。但是，您还希望在下次页面加载时隐藏该 div，否则您会惹恼您的访问者。出于这个原因，您可能希望在该 div 中加载一个 iframe，其中包含一个不仅可以执行 CSS3 技巧而且还可以在提交时让系统知道用户不想再显示该 div 的表单。然后，您的业务逻辑需要在提交 iframe 表单时记录用户的 IP。在 PHP 中，这是例如

```
$_SERVER['REMOTE_ADDR']; 
```

由于 .js 已关闭，因此您无法使用会话，因此您必须将其记录在数据库表中。当用户加载下一页时，记录用户的 IP 并在该表中查找。当它存在时，禁用 div 解析。铁

```
<?php
if (!$disableDiv)
echo "put the div";
?> 
```

# c# - OnNavigatedTo() 事件是否知道谁导航到它？

> ID：13884824
> 
> 赞同：0
> 
> 时间：2012-12-14T19:09:27.883
> 
> 标签：c#, windows-8, navigation, windows-store-apps, eventargs

如果必须，我会在导航到页面时将 arg 传递给页面，但是否有必要 - 有没有办法知道哪个页面称为 Navigate() 而无需这样做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:51:01.467

在 Application 对象中保留一个名为 PreviousPage 的静态属性。在每个页面（或在基类中）的 OnNavigatedFrom 事件中，将 PreviousPage 设置为“this”（当前页面）。在 OnNavigatedTo 事件中，您可以检查 Application.PreviousPage 属性并按照您认为合适的方式使用它。这是访问前一页的最有效方式，因为 Windows 应用商店应用程序的框架中没有 Frame.BackStack 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:21:05.233

您可以使用[`GetNavigationState`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.frame.getnavigationstate.aspx)，但它有一些不良的副作用（它导航离开当前页面并且字符串是内部的，不保证它可能/可能不会改变）。我认为你最好通过它。

> 调用此方法将使用 NavigationMode.Forward 为当前页面调用 Page.OnNavigatedFrom。GetNavigationState 通常在应用程序被挂起时调用，因此当前页面被导航离开。
> 
> 笔记：
> 
> 这些方法使用的序列化格式仅供内部使用。您的应用程序不应对其形成任何依赖关系。此外，此格式仅支持基本类型（如字符串、字符、数字和 GUID 类型）的序列化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T20:35:07.920

我遇到了这个确切的问题，Caleb 的回答非常有帮助。我只是想发布一些代码来阐明我如何使用他的解决方案。

**免责声明**我对 C# 有点（非常！）新手，我确信有更好的方法可以做到这一点，但我想提供它作为起点，以防其他人正在寻找更多细节。

我在应用程序的命名空间中创建了一个全局变量来保存上一页状态：

```
public static class global_vals{
    static object _previousPage;
    public static object previousPage
    {
        get
        {
            return _previousPage;
        }
        set
        {
            _previousPage = value;
        }
    }
} 
```

我每个页面上的 OnNavigatedFrom 方法如下所示：

```
protected override void OnNavigatedFrom(NavigationEventArgs e)
{
    base.OnNavigatedFrom(e);
    global_vals.previousPage = this;
} 
```

OnNavigatedTo 方法检查全局变量，如下所示：

```
protected override void OnNavigatedTo(NavigationEventArgs e)
{
    base.OnNavigatedTo(e);
    if (global_vals.previousPage.GetType().ToString() == "AppName.SomePage")
    {
        //do something
    }
} 
```

# java - 如何在 MSSQL 中获取 CURRENT_DATE？

> ID：13884830
> 
> 赞同：0
> 
> 时间：2012-12-14T19:09:50.523
> 
> 标签：java, date

我正在将 jpa 3.o 与 Hibernate 一起使用。我有一个命名查询：

```
SELECT COUNT(wt.id) FROM WPSTransaction wt WHERE wt.createdDate>= CURRENT_DATE 
```

WPSTransaction 是我的实体类， createdDate 是我类中的列之一。

它在 Mysql 数据库中运行良好。但是，我正在迁移到 SQL Server 2012，而 SQL Server 似乎没有编译该`CURRENT_DATE`值。我已经尝试过方法和`GETNOW()`方法，但没有任何运气。`NOW()``current_date()``CURRENT_TIMESTAMP`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-30T07:52:30.637

MS SQL Server[不符合](http://msdn.microsoft.com/en-us/library/hh501296%28v=sql.105%29.aspx)此处的标准 - 它不提供`current_date`关键字。

`GETDATE()`如链接的文档所示，您必须改为使用 SQL 服务器特定的功能。

因为`current_date`是规范中的一个关键字，所以您不能只`current_date()`在 MS SQL 中创建一个用户定义的函数并期望它能够以同样的方式工作。所以不幸的是，您在这里遇到了特定于数据库的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T06:36:24.740

怎么样：

```
Query q = entityManager.createQuery("SELECT COUNT(wt.id) FROM WPSTransaction wt WHERE wt.createdDate>= :d");
q.setParam("d", new Date()); 
```

不需要特定于数据库的代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-14T19:11:53.457

在 MS SQL 中返回当前日期的函数是 GETDATE()，所以你的查询应该是

```
SELECT COUNT(wt.id) FROM WPSTransaction wt WHERE wt.createdDate >= GETDATE() 
```

# matlab - 如何导入 eps 文件并将图像插入到图形的某个位置？

> ID：13884832
> 
> 赞同：2
> 
> 时间：2012-12-14T19:09:58.927
> 
> 标签：matlab, plot, eps

我正在做一个降维实验，想根据降维的结果来演示低维（2D）空间中的人脸。当人脸为 PNG 格式时，我的 MATLAB 脚本运行良好。但它不适用于 EPS 文件，至少`imread`无法识别 EPS 格式。那么我该怎么做呢？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T05:05:43.140

EPS files cannot be read using imread or any other image processing function. What you could do instead (just a suggestion) is

1.  Using this code, convert your EPS into PNG first.

    [EPS2XXX](http://www.mathworks.com/matlabcentral/fileexchange/6858-eps2xxx)

2.  Then, you can do your usual processing using this PNG file. You mentioned you can deal with PNG's. So I am not elaborating in it.

I hope that helps (thanks to the author of the File Exchange Author too).

# c++ - c++ 重载运算符和 const

> ID：13884836
> 
> 赞同：1
> 
> 时间：2012-12-14T19:10:03.800
> 
> 标签：c++, templates, operator-overloading

以下代码返回此错误：

> main.cpp|80|错误：将 'const matrix' 作为 'T& matrix::at(size_t, size_t) [with T = int, size_t = long unsigned int]' 的 'this' 参数传递，丢弃限定符 [-fpermissive]' </p>

任何想法为什么以及如何修复它？

```
#include <vector>

template <typename T>
class matrix
{
    std::vector< std::vector<T> > data;
    size_t N, M;    
public:
        T& at(size_t x, size_t y);
        matrix<T> operator+(const matrix<T>& m2) const;
};

template<class T>
T& matrix<T>::at(size_t x, size_t y)
{ return data[x][y]; }

template<class T>
matrix<T> matrix<T>::operator+(const matrix<T>& m2) const
{    
    matrix<T> res; //initialization of internals not related to error
    for(unsigned int i=0; i<N; ++i)
        for(unsigned int j=0; j<M; ++j)
            res.at(i,j) = this->at(i, j) + m2.at(i, j);    
    return res;
}

int main()
{
    matrix<int> a, b; //initialization of internals not related to error
    a = a + b;
    return 0;
} 
```

[http://ideone.com/5OigTP](http://ideone.com/5OigTP)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-14T19:13:34.630

您还需要超载`at`：`const matrix<>`

```
template<class T>
const T& matrix<T>::at(size_t x, size_t y) const
{
    return data[x][y];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:14:54.780

您是否尝试`const`过为`at()`???

如：

```
const T& at(size_t x, size_t y) const; 
```

# silverlight - 从文本文件填充 silverlight 网格

> ID：13884837
> 
> 赞同：0
> 
> 时间：2012-12-14T19:10:06.710
> 
> 标签：silverlight, c#-4.0, grid, readfile

朋友们，我有一个要求，给我一个固定编号的文本文件。列但行不同，我应该阅读它并使用 Silverlight 在网格/表格中填充它 文本文件将包含类似这样的数据

0, 0, 2, 1, "url1", 描述1 1, 0, 2, 2, "url2", 描述2 1, 1, 4, 2, "url3", 描述2

正如我们所看到的，列是固定的，但行可以变化

现在我希望我的 silverlight 应用程序从系统中读取此文件并填充到网格/表格中

行号 列号 宽度 高度 ImageURL 描述 0 0 2 1 url1 描述1 1 0 2 2 url2 描述2 1 1 4 2 url3 描述3

我尝试使用 Streamreader 读取文件，但它显示 SecurityException 错误 'SecurityExceptionHandler 未被用户代码处理 不允许文件操作。拒绝访问路径“c:\path\file.txt”。

希望我的问题很清楚

请帮助我提前谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:48:06.267

显示一个[OpenFileDialog 并从中创建一个 StreamReader](http://msdn.microsoft.com/en-us/library/cc221415%28v=vs.95%29.aspx)。使用 StreamReader.ReadLine() 逐行读取。String.Split(',') 获取列或使用更复杂的正则表达式，如果列可以在其引号中包含逗号。

我能帮助你的就这么多。没有用过DataGrid，但是它的[MSDN 文档](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid%28v=vs.95%29.aspx)看起来异常详细，界面也很简单。

# haskell - 在haskell中构建一个非确定性的monad转换器

> ID：13884838
> 
> 赞同：1
> 
> 时间：2012-12-14T19:10:09.027
> 
> 标签：haskell, monad-transformers, non-deterministic, monadplus

我想在 haskell 中构建一个不确定的 monad 转换器，我相信它的行为与 ListT 和[http://www.haskell.org/haskellwiki/ListT_done_right](http://www.haskell.org/haskellwiki/ListT_done_right)提出的替代 ListT 不同。其中第一个将 monad 与项目列表相关联；第二个将 monad 与单个项目相关联，但具有给定元素中的 monadic 动作影响列表后续槽中的 monadic 元素的属性。目标是建立一个单子变压器的形式

```
data Amb m a = Cons (m a) (Amb m a) | Empty 
```

这样列表中的每个元素都有自己的 monad 与之关联，并且连续的元素具有独立的 monad。在这篇文章的最后，我稍微演示了这个 monad 应该给出的那种行为。如果您知道如何获得 ListT 的一些变体来提供这种行为，那也会很有帮助。

下面是我的尝试。它不完整，因为`unpack`函数未定义。我该如何定义它？这是定义它的一次不完整的尝试，但它没有处理 monad m 包含`Empty`Amb 列表的情况：

```
unpack :: (Monad m) => m (Amb m a) -> Amb m a                                                                                                                 
unpack m = let first = join $ do (Cons x ys) <- m                                                                                                             
                                 return x                                                                                                                     
               rest =  do (Cons x ys) <- m                                                                                                                    
                          return ys                                                                                                                           
           in Cons first (unpack rest) 
```

**完整（不完整）代码：**

```
import Prelude hiding  (map, concat)                                                                                                                          
import Control.Monad                                                                                                                                          
import Control.Monad.Trans       

data Amb m a = Cons (m a) (Amb m a) | Empty                                                                                                                   

infixr 4 <:>                                                                                                                                                  
(<:>) = Cons                                                                                                                                                  

map :: Monad m => (a -> b) -> Amb m a -> Amb m b                                                                                                              
map f (Cons m xs) = Cons y (map f xs)                                                                                                                         
    where y = do a <- m                                                                                                                                       
                 return $ f a                                                                                                                                 
map f Empty = Empty                                                                                                                                           

unpack :: m (Amb m a) -> Amb m a                                                                                                                              
unpack m = undefined                                                                                                                                          

concat :: (Monad m) => Amb m (Amb m a) -> Amb m a                                                                                                             
concat (Cons m xs)  = (unpack m) `mplus` (concat xs)                                                                                                          
concat  Empty = Empty                                                                                                                                         

instance Monad m => Monad (Amb m) where                                                                                                                       
    return x = Cons (return x) Empty                                                                                                                          
    xs >>= f = let yss = map f xs                                                                                                                             
               in concat yss                                                                                                                                  

instance Monad m => MonadPlus (Amb m) where                                                                                                                   
    mzero = Empty                                                                                                                                             
    (Cons m xs) `mplus` ys = Cons m (xs `mplus` ys)                                                                                                           
    Empty `mplus` ys = ys                                                                                                                                     

instance MonadTrans Amb where                                                                                                                                 
    lift m = Cons m Empty 
```

**期望行为示例**

在这里，基本单子是`State Int`

```
instance Show a => Show (Amb (State Int) a) where                                                                                                             
    show m = (show .  toList) m                                                                                                                               

toList :: Amb (State Int) a -> [a]                                                                                                                            
toList Empty = []                                                                                                                                             
toList (n `Cons` xs) = (runState n 0 : toList xs)                                                                                                             

x = (list $ incr) >> (incr <:> incr <:> Empty)                                                                                                                
y = (list $ incr) >> (incr <:> (incr >> incr) <:> Empty)                                                                                                      

main = do                                                                                                                                                     
  putStr $ show x -- | should be [2, 2]                                                                                                                       
  putStr $ show y -- | should be [2, 3] 
```

谢谢。

**更新：为什么 LogicT 不做我想做的事的一个例子。**

这是 LogicT 在上面的简单示例中所做的：

```
import Control.Monad                                                                                                                                          
import Control.Monad.Logic                                                                                                                                    
import Control.Monad.State                                                                                                                                    

type LogicState = LogicT (State Int)                                                                                                                          

incr :: State Int Int                                                                                                                                         
incr = do i <- get                                                                                                                                            
          put (i + 1)                                                                                                                                         
          i' <- get                                                                                                                                           
          return i'                                                                                                                                           

incr' = lift incr                                                                                                                                             
y =  incr' >> (incr' `mplus` incr')                                                                                                                           

main = do                                                                                                                                                     
  putStrLn $ show (fst $ runState (observeAllT y) 0)   -- | returns [2,3], not [2,2] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T17:52:21.670

我相信你可以使用`StateT`. 例如：

```
import Control.Monad.State

incr = modify (+1)
sample1 = incr `mplus` incr
sample2 = incr `mplus` (incr >> incr)

monomorphicExecStateT :: StateT Int [] a -> Int -> [Int]
monomorphicExecStateT = execStateT

main = do
    print (monomorphicExecStateT sample1 0) -- [1, 1]
    print (monomorphicExecStateT sample2 0) -- [1, 2] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:20:36.887

I don't think this is possible in the general case (and a monad transformer should be able to transform any monad). The unpack option you mention is not possible for monads in general - it corresponds to the operation:

```
extract :: (Comonad w) => w a -> a 
```

Which is an operation on a comonad (the mathematical dual of a monad).

There are things you can do to 'unpack' it by taking the (m (Amb m a)) and mapping it several times to produce a single (m a) in each case, but this requires you to know in advance (or rather, from outside the monad) how many choices are being created, which you cannot know without some form of extract operation.

The reason that in the second ListT the tail of the list depends on a monadic action is because we need to perform a monadic action in some cases in order to find out how many choices are being produced (and thus how long the list is).

# wcf - 使用 HttpWebRequest 禁止 403 错误

> ID：13884842
> 
> 赞同：2
> 
> 时间：2012-12-14T19:10:31.040
> 
> 标签：wcf, httpwebrequest, iis-8

我已经设法解决了这个问题，但我需要帮助理解它，因为我不喜欢这个解决方案。

我有一个向 Azure REST API 服务发出 HttpWebRequest 的 WCF 服务。但是，当调用这行代码时

```
HttpWebResponse response = (HttpWebResponse) request.GetResponse(); 
```

返回 403 Forbidden 错误。内容长度为 0，错误代码和描述都说“禁止”。

现在，如果我将代码复制到控制台应用程序中，它可以正常工作。所以这让我相信它归结为应用程序池标识中的权限。

果然，如果我将应用程序池的身份更改为自己，我的代码就开始工作了。

我的问题是如何授予内置**ApplicationPoolIdentity**帐户的权限，以便我可以执行 HttpWebRequest？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T16:01:50.127

该问题很可能是由于**ApplicationPoolIdentity**用户无法使用用户设置。

我已经测试了一个创建 WebRequest 的 WCF 方法，并且**在**服务作为**控制台**应用程序**自托管**以及使用**ApplicationPoolIdentity****在 IIS 下托管时都可以工作**

 ******我已经在 Windows 7 机器上对其进行了测试。

可能导致问题的一种可能设置是**HTTP 代理**，通常用于公司环境。

如果您的登录用户有代理设置，您可以尝试：

1\. 以编程方式设置 WebRequest 的 Proxy 属性。

有关文档，请参见[此处](http://msdn.microsoft.com/en-us/library/system.net.webrequest.proxy.aspx)。

或者

2.通过在Web.config中设置defaultProxy元素来设置要使用的代理

有关文档，请参见[此处](http://msdn.microsoft.com/en-us/library/kd3cf2ex.aspx)。

希望这可以帮助******

# sql - 当打开查询返回错误时返回零

> ID：13884843
> 
> 赞同：0
> 
> 时间：2012-12-14T19:10:42.223
> 
> 标签：sql

select * from openQuery(XYZ,'abc');

如果链接服务器可用，查询将正确执行。如果链接服务器关闭，我想显示零。有什么办法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:20:35.527

You can use a try / catch statement. Explained [here](http://msdn.microsoft.com/en-us/library/ms175976.aspx).

# excel - 如何将两个脚本合二为一？

> ID：13884844
> 
> 赞同：1
> 
> 时间：2012-12-14T19:10:52.617
> 
> 标签：excel, vbscript, vba

请阅读以下模板：

```
PID     Status      LPID

10       Closed      25
11       Open        25
31       Open        31
25       Closed      25
54       Open        31
17       Open        17
20       Closed      31
88       closed      77
77       closed      77
201      open       202
205      open        500 
```

现在当 PID!= LPID 时，该 PID 被定义为 CPID（子进程 ID），否则它是一个 PPID（父进程 ID）

现在我正在寻找一个代码，它将告诉哪个是父级，哪个是子级 - 意味着在另一张表中标记它们。同时我想列出所有 CPID，PPID 在同一行，如果任何 PPID 有子进程他们自己。输出如下所示

```
PID   Type Of Process?    Child List
10       Child
11       Child
31       Parent              54 20
25       Parent              10 11
54       Child
17       Parent
20       Child
88       Child
77       Parent              88 
```

我已经使用 VBScript 编写了一个代码，但是使用实际工作表太慢了。对于 2500 个数据，它需要将近 1 小时。所以我想要一个比我的更快的过程。

您能在这里使用 VBscript 帮忙吗？

***代码1：***

```
 Set objExcel1 = CreateObject("Excel.Application")'Object for W2W Report Dump

  strPathExcel1 = "D:\VA\CopyofGEWingtoWing_latest_dump_21112012.xls"
  objExcel1.Workbooks.open strPathExcel1

  Set objSheet1 = objExcel1.ActiveWorkbook.Worksheets(2)
  Set objSheet2 = objExcel1.ActiveWorkbook.Worksheets(1)

    IntRow1=1
 Do While objSheet1.Cells(IntRow1, 1).Value <> ""

    IntRow2=4
    IntChildListColumn=3

    If objSheet1.Cells(IntRow1,2).Value="Parent" Then

        Do While objSheet2.Cells(IntRow2, 1).Value <> ""

             If objSheet2.Cells(IntRow2,11).Value=objSheet1.Cells(IntRow1,1).Value And objSheet2.Cells(IntRow2,11).Value <> objSheet2.Cells(IntRow2,1).Value Then

                 objSheet1.Cells(IntRow1,IntChildListColumn).Value=objSheet2.Cells(IntRow2,1).Value
                 IntChildListColumn=IntChildListColumn+1

             End If

      IntRow2=IntRow2+1

      Loop

   End If

 IntRow1=IntRow1+1

Loop 
```

***代码2：***

```
 Flag=0
 IntColTemp=1
 IntRowTemp=3

 Set objExcel1 = CreateObject("Excel.Application")'Object for Condition Dump

 strPathExcel1 = "D:\VA\CopyofGEWingtoWing_latest_dump_21112012.xls"
 objExcel1.Workbooks.open strPathExcel1

 Set objSheet1 = objExcel1.ActiveWorkbook.Worksheets(1)
 Set objSheet2 = objExcel1.ActiveWorkbook.Worksheets(2)

 IntRow1=4
 IntRow2=1

Do While objSheet1.Cells(IntRow1, 1).Value <> ""

  objSheet2.Cells(IntRow2, 1).Value = objSheet1.Cells(IntRow1, 1).Value

   IntColTemp=1
   Flag=0
  'This will travarse to the Parent Business Process ID column horizantally in the excel.
  Do While Flag=0

  If objSheet1.Cells(IntRowTemp,IntColTemp).Value="Parent Business Process ID" Then

      Flag=1       

  End If

      IntColTemp=IntColTemp+1

Loop
      IntColTemp=IntColTemp-1
      'MsgBox(IntColTemp)

  Strcmp1=trim(objSheet1.Cells(IntRow1, 1).Value)
  Strcmp2=trim(objSheet1.Cells(IntRow1,IntColTemp).Value)

  If Strcmp1=Strcmp2 Then

      objSheet2.Cells(IntRow2, 2).Value="Parent" 

  Else

      objSheet2.Cells(IntRow2, 2).Value="child"

  End If

   IntRow1=IntRow1+1
   IntRow2=IntRow2+1

  Loop 
```

***编辑***看到两个 ID 201 和 205 具有子父关系。但是子 id 将需要出现在输出列中，但父 202 和 500 不应该出现在输出列表中，因为主表中没有条目`202 close/open 202`和`500 open/close 500`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T10:13:35.427

两个想法/策略：

1.  将 Range 加载到数组中，而不是访问单元格（（c）@DanielCook）
2.  如果您必须处理有关（一组）元素的数据，请使用字典。

在代码中：

```
Option Explicit

Class cP
  Public m_sRel
  Public m_dicC
  Private Sub Class_Initialize()
    m_sRel     = "Child"
    Set m_dicC = CreateObject("Scripting.Dictionary")
  End Sub
  Public Function show()
    show = m_sRel & " " & Join(m_dicC.Keys)
  End Function
End Class

Dim oFS   : Set oFS  = CreateObject("Scripting.FileSystemObject")
Dim oXls  : Set oXls = CreateObject("Excel.Application")
Dim oWb   : Set oWb  = oXls.Workbooks.Open(oFs.GetAbsolutePathName(".\00.xlsx"))
Dim aData : aData    = oWb.Worksheets(1).Range("$A2:$C10")
Dim dicP  : Set dicP = CreateObject("Scripting.Dictionary")

Dim nRow
For nRow = LBound(aData, 1) To UBound(aData, 1)
    Set dicP(aData(nRow, 1)) = New cP
Next

For nRow = LBound(aData, 1) To UBound(aData, 1)
    If aData(nRow, 1) = aData(nRow, 3) Then
       dicP(aData(nRow, 1)).m_sRel = "Parent"
    Else
       dicP(aData(nRow, 3)).m_dicC(aData(nRow, 1)) = 0
    End If
Next

Dim nP
For Each nP In dicP.Keys()
    WScript.Echo nP, dicP(nP).show()
Next

oWb.Close
oXls.Quit 
```

输出：

```
10 Child
11 Child
31 Parent 54 20
25 Parent 10 11
54 Child
17 Parent
20 Child
88 Child
77 Parent 88 
```

# solaris - 让 clang/llvm 在 Solaris 上使用 crle 路径？

> ID：13884847
> 
> 赞同：0
> 
> 时间：2012-12-14T19:11:07.240
> 
> 标签：solaris, llvm, clang, openindiana

我正在尝试配置 OpenIndiana 构建机器，而且对于 (Open)(Solaris|Indiana) 如何处理构建过程的（不那么）细微差别，我通常是新手。虽然我现在明白了，在 Solaris 上，即使在 64 位内核上运行时，默认也是将应用程序构建为 m32，除非`-m64`明确提供；我似乎无法正确配置 的默认搜索路径`clang`，但`gcc`工作得很好而且花花公子。

我安装了`llvm`和`gcc`via `pkg`，无需手动编译。

编译基本 C 文件`gcc`在默认 ( `-m32`) 和 64 位`-m64`配置中都可以正常工作，正确使用以下设置的搜索路径`crle`：

```
mqudsi@openindiana:~/random$ crle

Default configuration file (/var/ld/ld.config) not found
  Platform:     32-bit LSB 80386
  Default Library Path (ELF):   /lib:/usr/lib  (system default)
  Trusted Directories (ELF):    /lib/secure:/usr/lib/secure  (system default)
mqudsi@openindiana:~/random$ crle -64

Default configuration file (/var/ld/64/ld.config) not found
  Platform:     64-bit LSB AMD64
  Default Library Path (ELF):   /lib/64:/usr/lib/64  (system default)
  Trusted Directories (ELF):    /lib/secure/64:/usr/lib/secure/64  (system default) 
```

但是，`clang`似乎忘记了系统配置，并且需要我`-L ....`在编译时手动设置。全局设置`LD_LIBRARY_PATH`失败，因为在尝试使用它编译 64 位二进制文​​件时，clang 本身是 32 位的。

我怎样才能`crle`像 gcc 一样让 clang 尊重 Solaris 配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T16:39:19.303

好吧，鉴于 clang 对 Solaris 了解甚少，不幸的是，答案很简单：应该有人在 clang 中实现 crle 支持。

# php - 使用php构建时间间隔数组

> ID：13884848
> 
> 赞同：1
> 
> 时间：2012-12-14T19:11:06.720
> 
> 标签：php, mysql, json

我正在尝试使用 php 和 json 构建延迟区域图，以获取我在 MySQL 数据库中的数据点，并将它们平均为 5 分钟间隔。我想知道这样的事情是否可能。

当前代码：

```
mysql_select_db($mysql_db);
$query = ("select date, (delta_msec * .001) from www where agent_id in (45517,45655,42189,38583,45872,38678,38289,39074,38069,42096,37987,45182,38974,44956,38630,38297,38571,39181,39063,41992,38293,37978) and date >='" . date("Y-m-d H:i:s", strtotime("30 minutes ago")) . "' and date <= '" . date("Y-m-d H:i:s", strtotime("now"))  . "' order by date asc");
$result = mysql_query($query) or die($query. "<br/><br/>" .mysql_error());
while ($row = mysql_fetch_array($result)){
    $www[$q] = array("label" => $row[0], "value" => $row[1]);
    $q++;
} 
```

使用时

```
print_r ($www); 
```

我能够看到以下（正确的）多维数组：

```
Array
(
[0] => Array
    (
        [label] => 2012-12-14 12:47:17
        [value] => 0.618
    )

[1] => Array
    (
        [label] => 2012-12-14 12:47:17
        [value] => 0.890
    )

[2] => Array
    (
        [label] => 2012-12-14 12:47:22
        [value] => 1.908
    )

[3] => Array
    (
        [label] => 2012-12-14 12:47:37
        [value] => 2.912
    )

[4] => Array
    (
        [label] => 2012-12-14 12:48:18
        [value] => 1.275
    )

[5] => Array
    (
        [label] => 2012-12-14 12:48:25
        [value] => 0.449
    )

[6] => Array
    (
        [label] => 2012-12-14 12:48:30
        [value] => 7.831
    )
) 
```

Array 比这大得多，但我想给出它的外观片段。

有了这些信息，我可以将其转换为 JSON，FusionCharts 将完美地读取所有值。然而，它实际上只是一个重新格式化的“散点图”图，读起来不太好。我希望能够从这个数组创建另一个数组，这样我基本上可以制作 5 分钟的存储桶并对所有值进行平均，并在过去 4 小时内执行此操作。

我现在才开始学习 PHP、MySQL 和 fusioncharts 大约 2-3 周，这远远超出了我所学到的。任何人都可以协助创建这样的数组吗？（或任何其他方法？）或者我只能通过重新格式化我的 SQL 查询以提取已经平均的数据，然后再次调用较小版本的图形来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T12:23:32.313

您只需要一个函数来遍历您的数组并将 5 个项目组合在一起并计算平均值。我把这个放在一起：-

```
function get5MinAv(array $times)
{
    $result = array();
    $counter = 0;
    $temp['sum'] = 0;
    foreach($times as $time){
        if($counter == 0)$temp['start'] = $time['label'];
        $temp['sum'] += $time['value'];
        $counter ++;
        if($counter  == 5){
            $temp['av'] = $temp['sum']/5;
            $temp['end'] = $time['label'];
            $result[] = $temp;
            $temp['sum'] = 0;
            $counter = 0;
        }
    }
    return $result;
} 
```

为了测试这一点，我生成了一个类似于你的数组：-

```
$interval = new DateInterval('PT1M');
$date = new DateTime();
$times = array();

for($i = 0; $i < 120; $i++){
    $times[$i]['label'] = $date->format('Y-m-d h:i:s');
    $times[$i]['value'] = 1;
    $date->add($interval);
} 
```

并这样称呼它：-

```
var_dump(get5MinAv($times)); 
```

我刚刚输入了一个值 1 以使检查变得容易，我已经用一两个其他值对其进行了测试，并且一切似乎都可以正常工作。

如果你希望你可以给它播种`$times[$i]['value'] = rand(0, 1000)/100`以提供更好的值范围，但检查会更难。

输出样本：-

```
array (size=24)
  0 => 
    array (size=4)
      'sum' => int 5
      'start' => string '2012-12-28 12:13:24' (length=19)
      'av' => int 1
      'end' => string '2012-12-28 12:17:24' (length=19)
  1 => 
    array (size=4)
      'sum' => int 5
      'start' => string '2012-12-28 12:18:24' (length=19)
      'av' => int 1
      'end' => string '2012-12-28 12:22:24' (length=19)
  2 => 
    array (size=4)
      'sum' => int 5
      'start' => string '2012-12-28 12:23:24' (length=19)
      'av' => int 1
      'end' => string '2012-12-28 12:27:24' (length=19) 
```

显然，您可以根据自己的喜好进行调整，但这应该会让您走上正确的道路。此功能将忽略最后不形成一组 5 的任何剩余时间。如果您想改变这种行为，这对您来说将是一个很好的练习。

# mysql - mysql 双引号表名

> ID：13884854
> 
> 赞同：8
> 
> 时间：2012-12-14T19:11:39.230
> 
> 标签：mysql, double-quotes

我正在做一个mysql查询，如：

```
Select * from "User"; 
```

它返回：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“用户”附近使用正确的语法

该错误与双引号有关`"`，我可以保持select语句原样，并使mysql应对双引号吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-14T19:21:13.593

取自[这篇文章](https://stackoverflow.com/questions/214309/do-different-databases-use-different-name-quote)：

```
SET GLOBAL SQL_MODE=ANSI_QUOTES; 
```

就个人而言，当我测试时，我必须这样做：

```
SET SQL_MODE=ANSI_QUOTES; 
```

我不认为有任何其他方式。

> [http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html#sqlmode_ansi_quotes](http://dev.mysql.com/doc/refman/5.0/en/server-sql-mode.html#sqlmode_ansi_quotes)
> 
> ### ANSI_QUOTES
> 
> 对待“” 作为标识符引号字符（如“`”引号字符）而不是字符串引号字符。在启用此模式的情况下，您仍然可以使用“`”来引用标识符。启用 ANSI_QUOTES 后，您不能使用双引号来引用文字字符串，因为它被解释为标识符。

# backbone.js - 如何使用骨干网在 IE8 和 IE10/现代浏览器之间获得一致的 PushState 链接？

> ID：13884855
> 
> 赞同：2
> 
> 时间：2012-12-14T19:11:42.473
> 
> 标签：backbone.js, pushstate, backbone-routing

我在 Chrome 中，我复制我的网址：“http://www.example.com/a/123456789”并将其粘贴到 IE8 中。它工作正常，因为我的路线设置正确。

如果我然后导航到其他地方，我会得到预期的 IE8 后备 URL：“http://www.example.com/a#a/123456789”（注意哈希），一切都很好。

**这就是问题所在...**

现在，如果我复制带有哈希的链接 (http://www.example.com/a#a/123456789) 并将其粘贴到现代浏览器中，它会将我转储到[http://www.example.com/a#一个](http://www.example.com/a#a)。

**有人有这种行为的经验吗？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T19:28:27.057

我想出了一个解决方法，所以我想我会分享它，以防它可以帮助其他人......

```
// Make urls copied from IE8 work when pasted in modern browsers
if (history.pushState && location.hash.match(/#a{1}/)) {
    location.href = location.href.replace('a#a', 'a');
} 
```

基本上，我只是检查浏览器是否支持推送状态，以及我们要查找的哈希是否在 URL 中。由于我们的哈希值与我们在 pushState 中使用的相同，因此只需快速替换即可。

# php - 无法连接到网络共享

> ID：13884857
> 
> 赞同：0
> 
> 时间：2012-12-14T19:11:50.463
> 
> 标签：php, iis, network-share

我正在尝试从浏览器连接到网络共享（通过它是 UNC），但无法连接。

如果我从命令行运行我的脚本，一切都很好，我可以访问共享。我还可以通过 Windows 的文件资源管理器导航到它，所以我认为我的代码或我的 Windows 帐户的权限没有任何问题。

我的脚本如下所示：

```
$dir = '\\\\some\path';

if (is_dir($dir))
{
    echo 'dir exists';
} 
else
{
    echo 'dir does not exist';
} 
```

我也尝试过使用`DirectoryIterator($dir)`，但这会引发此异常错误： `PHP Warning: opendir(...): Access is denied. (code: 5)`

这是我的设置：
- Windows Server 2008 R2
- IIS 7.5
- PHP 5.3.13
- 禁用匿名身份验证
- 启用 Windows 身份验证

我的 php.ini 中有这些配置设置：

```
cgi.force_redirect=0
cgi.fix_pathinfo=1
fastcgi.impersonate=1 
```

为了增加混乱，我能够在以下情况下通过浏览器进行连接：

1 - using`system("net use \"".$dir."\" ".$pass." /user:".$user." /persistent:no>nul 2>&1");`但这需要硬编码用户的 Windows 身份验证密码，我不能这样做。

2 - 设置`fastcgi.impersonate=0`但这意味着用户每次点击脚本时都必须进行身份验证，这是不可接受的。

3 - 启用匿名身份验证，禁用 Windows 身份验证，但我需要启用 Windows 身份验证才能知道谁在访问该站点。

我不知道这是否与我的问题有关，但是`$_SERVER['USERNAME']`从浏览器和命令行运行脚本时，我得到不同的值。

这是权限问题吗？是否存在未传递的身份验证令牌？

**不幸的是，在这种情况下，编辑**
将共享映射到网络驱动器不是一种选择。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:19:32.580

它应该可以工作，但您需要运行 php 进程的用户才能访问该路径。

在您的情况下，如果不在域中，您可以尝试在您的服务器上创建一个用户并将其设置为应用程序池所有者。然后，您在另一台计算机上创建相同的用户/密码并授予对共享文件夹的访问权限。

看起来很难看，我同意，但应该可以。

**编辑**

或者是的，正如尼尔所建议的，创建一个映射文件夹。可能会更容易。

**编辑 2**

假设您不在域中，要创建用户并将其分配给运行应用程序，请执行以下操作：

1.  创建用户 ![创建用户](../Images/6a1cb5508efc7f8f0c04d04b9c119d98.png)

2.  运行 iismanager 并设置用户运行应用程序

![分配用户运行您的应用程序](../Images/50562aeddee328ff6749e69d41b0139d.png)

最后一步是在您共享路径的远程服务器上创建完全相同的用户（以及密码），并在安全选项卡中添加该用户，并具有您需要的权限。

您可能需要重新启动 iis：`iisreset`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:14:19.753

您不能在 PHP 中使用 UNC 路径轻松访问文件。

尝试制作映射的网络驱动器。

# excel - excel文本到时间

> ID：13884864
> 
> 赞同：3
> 
> 时间：2012-12-14T19:12:30.803
> 
> 标签：excel, vba

我有一个 Excel 表格，其中的时间格式如下例所示。我需要将时间从文本字符串转换为可用格式。如果我能在几秒钟内以相同的格式获取所有内容并从那里开始工作，我会很高兴。我知道我可以使用辅助列和一个很长的丑陋的 IF 左、右、中间公式来做到这一点，然后除以所有内容，但我每天都在处理数千个这样的问题，并且希望使用动态公式或 VBscript 更好地自动化它，使这些更容易使用。

```
 A         B
1 Server(A)  15d 3h 39m
2 Server(E)  3h 36m 44s
3 Server(C)  4m 3s
4 Server(B)  44s 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:29:22.267

这并不优雅，但只要您的格式符合描述，它就可以作为 UDF 工作：

```
Public Function timeStringToSeconds(strIn As String) As Long
    Dim values
    values = Split(strIn, " ")
    For Each v In values
        Select Case Right$(v, 1)
            Case "d"
                timeStringToSeconds = timeStringToSeconds + CLng(Left$(v, Len(v) - 1)) * 86400
            Case "h"
                timeStringToSeconds = timeStringToSeconds + CLng(Left$(v, Len(v) - 1)) * 3600
            Case "m"
                timeStringToSeconds = timeStringToSeconds + CLng(Left$(v, Len(v) - 1)) * 60
            Case "s"
                timeStringToSeconds = timeStringToSeconds + CLng(Left$(v, Len(v) - 1))
        End Select
    Next
End Function 
```

您可以简单地通过这样做来使用它：例如在 C1 中：`timeStringToSeconds(B1)` 或者通过执行以下操作在一个范围内运行它： `range.value = timeStringToSeconds(range.value)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T22:34:33.487

另一种将字符串转换为**可用格式**的方法，如 dd:hh:mm:ss。当然，如果您只需要几秒钟，我们也可以即兴发挥；）

试用后请发表评论。我将这种情况称为**多分隔符拆分组合**:) 我们将`d, h, m, s`其视为分隔符。也可以使用`split`函数和`regexp`

**dd:hh:mm:ss**

代码：

```
Function multiSplitCombine(ByVal strTime As String) As String
Dim delimsArray(0 To 3) As Variant
Dim i As Long, j As Long, k As Long

    'set delimiters
    delimsArray(0) = "d"
    delimsArray(1) = "h"
    delimsArray(2) = "m"
    delimsArray(3) = "s"

    If Len(strTime) = 0 Then
        multiSplitCombine = "00:00:00:00"
        Exit Function
    End If

    For i = LBound(delimsArray) To UBound(delimsArray)
        '-- get the position of the delimiter
        j = InStr(1, strTime, delimsArray(i))

        '-- if the delimiter is not found
        If j = 0 Then
            '-- insert 00: into the position after earlier previous delimiter replacement
            strTime = Left(strTime, k) & "00:" & Right(strTime, Len(strTime) - k)
        Else
            k = j
           '-- replace delimiter with semicolon
            strTime = Replace(strTime, delimsArray(i), ":")
        End If
    Next i

    '-- strip that last extra semi colon
    strTime = Trim(Left(strTime, Len(strTime) - 1))

    '-- remove internal white spaces
    strTime = Replace(strTime, " ", "")

    '-- back to sheet
    multiSplitCombine = Application.WorksheetFunction.Text(strTime, "dd:hh:mm:ss")
End Function 
```

**片刻之间**

这是您需要在上面的代码中更改的内容，

*   将函数名称更改为`splitToSeconds`
*   `strTime = Replace(strTime," ", "")`通过添加以下代码替换所有内容

    ```
    '-- dd:hh:mm:ss format
    strTime = Application.WorksheetFunction.Text(strTime, "dd:hh:mm:ss")    

    '-- split by semicolon
    s = Split(strTime, ":")

    '-- it has to be 4 elements since the format we insert is d:h:m:s
    splitToSeconds = CDbl(s(0)) * 24 * 60 * 60 + _ 
                     CDbl(s(1)) * 60 * 60 + CDbl(s(2)) * 60 + CDbl(s(3)) 
    ```

输出：

![在此处输入图像描述](../Images/ab580dd38c0feaa16b46e0e43ab6485a.png)

# java - 提交后HTML消失

> ID：13884871
> 
> 赞同：0
> 
> 时间：2012-12-14T19:13:04.943
> 
> 标签：java, html, jsp, servlets

我有这个表格：

```
<div id="tudo">
    <div id="sige">
        <div id="voltar_sair">
                    <a href="ServletListarEventosInscricoesAbertas.do" id="voltar">Voltar</a>
        </div>
        <h1>SIGE - Sistema de Gerenciamento de Eventos </h1>
            <form name="form" method="post" action="" id="sige">
                <input type="hidden" name="codigoEvento" value="<%=codigoEvento%>">
                <input type="hidden" name="tela" value="<%=tela%>"> <input
                    type="hidden" id="hidden" value="<%=cpf%>">

                <fieldset>
                    <legend>Consultar Eventos do Participante</legend>
                    <p>
                        <label for="cpf">CPF:</label> <input id="cpf" name="cpf" class="mascara-cpf" type="text" onblur="if(this.value != ''){ValidarCPF(this);}" value="<%=cpf%>"/>
                    </p>

                </fieldset>

                <p>
                    <input class="botoes_form" value="Consultar" id="reemitir" type="button" onClick="javascript:consultarEventosParticipante()"/>
                    <input class="botoes_form" value="Limpar" id="limpar" type="reset" onclick="$('#cpf').val()"/>
                </p> 
```

并且，在提交表单后，带有标签和输入（文本）的整个 p 消失了。

我能做些什么来解决这个问题？

编辑：

```
function consultarEventosParticipante(){

    if(document.form.cpf.value == ""){
        alert("Por favor, digite o campo C.P.F.");
        return;
    }
    document.form.action="ServletInicioConsultarEventosParticipante";
    document.form.submit();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T16:09:44.847

显然问题已经解决了。我将表单标签放在字段集中，问题就消失了。我不明白它的原因，但这是修复错误的方法。

# c# - 如何使用属性正确建模 XML 节点？

> ID：13884872
> 
> 赞同：0
> 
> 时间：2012-12-14T19:13:11.200
> 
> 标签：c#, model, xml-serialization

我正在尝试使用 XML 提要并将其转换为模型。

一些 XML 看起来像这样。

```
<guid isPermaLink="false">
    http://example.com/foo/bar
</guid> 
```

在尝试对此建模时，我正在使用

```
[XmlElement("guid")]
public string Guid { get; set; }

[XmlElement("guid")]
public m_Guid Guid { get; set; }
public class m_Guid
{
    [XmlAttribute("isPermaLink")]
    public bool isPermaLink { get; set; }
} 
```

但显然VS抛出一个错误

> 该成员被多次定义。

我只是想弄清楚如何对此进行建模，以便在这一切结束时，我可以使用

```
var theGuid = someItem.Guid;
var guidIsPermaLink = someItem.Guid.isPermaLink; 
```

只是希望有人可以帮助我指出正确的方向。我对这样的建模有点陌生。

* * *

这是另一个需要以类似方式建模的混淆标记示例。

```
<link>http://example.com/foo/bar/</link>
<atom:link rel="self" type="application/rss+xml" href="http://example.com/foo/bar/&format=rss"/> 
```

需要建模以便我们可以做到这一点

```
var link = someItem.Link;
var linkType = someItem.Link.type;
var linkHref = someItem.Link.href; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:20:52.917

你可以这样建模：

```
public class Guid 
{
    [XmlAttribute]
    public bool IsPermaLink { get; set; }

    // and the element value
    [XmlTextAttribute]
    public string Value;
}

public class Item
{
    [XmlElement]
    public Guid Guid { get; set; }
}
...
var theGuid = someItem.Guid.Value;
var guidIsPermaLink = someItem.Guid.IsPermaLink; 
```

# php - 从 wordpress 图像中提取替代文本

> ID：13884875
> 
> 赞同：0
> 
> 时间：2012-12-14T19:13:26.797
> 
> 标签：php, wordpress

我正在尝试从图像数组中提取替代文本以在其他地方使用，但我无处可去..

这是代码：

```
 global $post;
        $args = array( 'numberposts' => 12, 'post_type' => 'clientes', 'orderby' => 'ASC');
        $myposts = get_posts( $args );
        $alt_text = get_post_meta($args , '_wp_attachment_image_alt', true);
        foreach( $myposts as $post ) :  setup_postdata($post); 

        ?>
        <li>
            <!--BEGIN .hentry -->
            <div class="post_box">
                <div class="post-thumb left gallery">
                    <a href="<?php the_permalink() ?>">
                        <?php the_post_thumbnail('full'); ?>
                        <div class="overlay"><img src="<?php echo $alt_text; ?>.jpg" /></div>
                    </a>

                </div>    
            <!--END .hentry-->  
            </div> 
```

我很确定我的错在于这条线：

```
 $alt_text = get_post_meta($args , '_wp_attachment_image_alt', true); 
```

但我缺乏修复它的知识......

谢谢

b

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T19:18:56.470

您误[`get_post_meta`](http://codex.wordpress.org/Function_Reference/get_post_meta)用了：第一个参数应该是帖子标识符*而不是*参数数组。

您需要`get_post_meta`在循环内部调用`foreach`以提取每个帖子的唯一数据：

```
foreach( $myposts as $post ) :
$alt_text = get_post_meta($post->ID , '_wp_attachment_image_alt', true);
endforeach; 
```

# mysql - 如何在网络服务器上存储许多图像？

> ID：13884883
> 
> 赞同：0
> 
> 时间：2012-12-14T19:13:38.853
> 
> 标签：mysql, filesystems, storage

我计划在网络服务器上存储许多图像（>100,000）。

文件名将是前。

> 324-2012-07-25-143544.jpg

文件名是这样构建的：

> 用户 ID-年-月-日-HHMMSS.jpg

此文件名将保存在 mysql 数据库中，并将被读取，并且从文件名中您知道文件路径 ->

> 图片/用户ID/年/月/日/用户ID-年-月-日-HHMMSS.jpg

所以在这个例子中

> 图片/324/2012/07/25/324-2012-07-25-143544.jpg

将所有内容保存在基本文件夹 /images 中时可能出现的任何性能问题？

谢谢你！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T19:33:25.900

像您正在做的那样，分片文件是避免在一个目录中包含许多文件时出现性能问题的好方法：在这种方法中，您可以确保在任何给定目录中只有少数条目（目录或文件）。如果需要，也可以轻松拆分多个卷 - 您只需将一些高级目录安装在不同的位置。

不过，您应该考虑几件事。

## 身份

如果您要对这些图像进行基本永久存储，则可能需要基于 id 进行分片。这在数据库方面更容易处理（出于同样的原因，我们在数据库设计中使用任意主键）。

就像@Veger 建议的那样： imageid`123456`变成`/12/1234/123456.jpg`.

### 安全

但是，使用日期、用户 ID 或自动递增数字可能会带来安全风险，因为它们相对容易猜到，因此有人很容易收集所有图像。

此外，如果用户没有理由知道上传日期，则在 URL 中包含日期可能会泄露信息。

如果您使用的是一个非常难以猜测的密钥，它可以提供一定程度的安全性，防止收集和信息泄露。例如，您可以使用 GUID：图像 ID`6f33395e-eda8-4486-8b8e-51ea0f91751b`存储为`/6/6f33/6f33395e/6f33395e-eda8-4486-8b8e-51ea0f91751b.jpg`.

有大量的 GUID（它是 128 位），因此有人可能需要数百万年才能收获所有东西（即使您不采取任何额外的步骤，例如限制每小时每个 IP 的连接等）。

### 易失性图像

如果您的图像是不稳定的——也就是说，它们会在一段时间后过期——那么实际上最好根据日期结构进行分片，例如`/2012/12/14/2012-12-14-hhmmss-userid.jpg`，或者您可以将它与 guid 结合并获取`/2012/12/14/6f/6f33395e-eda8-4486-8b8e-51ea0f91751b.jpg`。

如果你想删除所有 2011 的文件，你只需`rm -rf 2011`. 使用它的一个很好的例子是日志文件。

您必须记住，这仅对大量图像才有意义*，*因为您可以在数据库中进行查询以根据日期查找过时的图像，然后将它们一一删除。

## 分片粒度

对您计划最终存储的图像使用更高粒度的分片，但请记住，如果您太细化，您将失去大量用于目录条目的开销磁盘空间。

目标是将每个目录的条目数保持在文件系统可以处理的范围内；好的经验法则似乎是最大约 10,000。您必须预测您的网站将在接下来的一段时间内获得的流量。不过不要发疯，想想在某个时候你可能每天会拥有数百万用户。重新分片并非不可能，但这很痛苦。预测未来几年的增长并处理好。如果你增长得更快并且因此不得不重新分片，那么，这是一个很好的解决问题。如果由于目录条目占用的空间多于图像而导致磁盘空间不足，那么这是一个愚蠢的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:23:23.457

我会这样做：

*   只需为您存储的每个图像使用唯一的 id（只是一个数字，如表 id 字段）
*   检查您的网络服务器上一个目录中的最大文件数是多少
*   将 id 除以该数字以获取目录名称
*   将图像（带有数字）存储在此目录中

例如，图像编号`1`存储为`/0/1.jpg`，图像编号`1234567`存储为`/123/1234567.jpg`（假设您可以在一个目录中存储 10000 个文件）。

最简单，噪音最少，并优化目录中的文件数量（而不是浪费大量半满的目录）。

如果您*真的*要存储*大量*图像，请使用 2 个子目录！像，`/0/0/1.jpg`和`/1/12345/123456789.jpg`

# facebook-graph-api - facebook没有抓取我打开的图表内容

> ID：13884884
> 
> 赞同：2
> 
> 时间：2012-12-14T19:13:42.083
> 
> 标签：facebook-graph-api

当我使用 heroku 服务器时，事情进展顺利。facebook 应用程序正在抓取我的内容并创建开放图形对象等。我正在转换到不同的安全服务器，并在 facebook 开发人员应用程序设置页面中输入了有关新服务器的所有相关详细信息。我之前使用的简单 php 脚本看起来工作得很好（没有错误），但我没有看到任何新内容出现在 facebook 的打开图表或我以前的个人活动中。

我怀疑在切换服务器时，除了更新应用程序设置页面之外，我还需要做其他事情。

对于我设置的应用程序域： [https ://secure96.hostgator.com](https://secure96.hostgator.com)

（即使这是一个共享站点。）

非常感谢您的任何见解。

这是我试图让 facebook 识别的测试 URL：

[https://secure96.hostgator.com/~projectx/AMR/repeater.php?fb:app_id=360058754075871&og:type=allmyrecipes:recipe&og:title=Five%20Alarm%20Chili&og:description=A%20crowd%20favorite%20during%20the %20ballgame.&allmyrecipes:rating=4&allmyrecipes:servings=8&allmyrecipes:genres=&allmyrecipes:recipeingredients=1%20lb.%20Italian%20sausage%7C1%20t.%20basil%7C3%20cubes%20beef%20boullion%7C28%20ounces%20canned%20dic %20西红柿%20英寸%20果汁%7C1%20吨.%20辣椒%20胡椒%7C3%20茎%20芹菜%20（切碎）%7C45%20盎司%20辣椒%20豆%7C0.33%20杯%20辣椒%20粉末%7C1%20绿色%20胡椒%20切碎%7C3%20吨.%20干%20孜然%7C1%20T%20干%20牛至%7C12%20盎司%20好%20黑%20啤酒%7C3%20%20绿色%20辣椒%20辣椒%20（铜）%7C2%20吨.% 20ground%20black%20pepper%7C2%20t.%20hot%20pepper%20sauce%7C2%20lbs.%20lean%20ground%20chuck%7C1%20T%20minced%20garlic%7C1%20large%20onion%20（切碎）%7C1%20t.%20paprika%7C1%20t.%20paprika%7C1%20red%20pepper%20（切碎） %7C3%20pinches%20salt%7C4%20ounces%20tomato%20paste&allmyrecipes:procedure=1.)%20Brown%20ground%20chuck%20and%20sausage%20in%20a%20large%20pot%20over%20medium-high%20heat.2.) %20Drain%20off%20excess%20fat.3.)%20Add%20all%20remaining%20ingredients%20and%20bring%20to%20a%20boil.4.)%20reduce%20heat%20and%20simmer%20for%20about%20three%20hours .5.)%20Let%20cool%20for%20an%20hour%20and%20refrigerate%20over%20night.6.)%20The%20following%20day,%20warm%20to%20serving%20temperature%20and%20optional%20serve%20with% 20sour%20cream,%20shredded%20sharp%20cheese,%20and/or%20corn%20chips.&allmyrecipes:shareflag=1&allmyrecipes:postername=Bill%20Chapman&allmyrecipes:posterid=1942295&body=1。)%20棕色%20地面%20夹头%20和%20香肠](https://secure96.hostgator.com/~projectx/AMR/repeater.php?fb:app_id=360058754075871&og:type=allmyrecipes:recipe&og:title=Five%20Alarm%20Chili&og:description=A%20crowd%20favorite%20during%20the%20ballgame.&allmyrecipes:rating=4&allmyrecipes:servings=8&allmyrecipes:genres=&allmyrecipes:recipeingredients=1%20lb.%20Italian%20sausage%7C1%20t.%20basil%7C3%20cubes%20beef%20boullion%7C28%20ounces%20canned%20diced%20tomatoes%20in%20juice%7C1%20t.%20cayenne%20pepper%7C3%20stalks%20celery%20(chopped)%7C45%20ounces%20chili%20beans%7C0.33%20cup%20chili%20powder%7C1%20green%20pepper%20chopped%7C3%20t.%20dried%20cumin%7C1%20T%20dried%20oregano%7C12%20ounces%20good%20dark%20beer%7C3%20%20green%20chili%20peppers%20(copped)%7C2%20t.%20ground%20black%20pepper%7C2%20t.%20hot%20pepper%20sauce%7C2%20lbs.%20lean%20ground%20chuck%7C1%20T%20minced%20garlic%7C1%20large%20onion%20(chopped)%7C1%20t.%20paprika%7C1%20t.%20paprika%7C1%20red%20pepper%20(chopped)%7C3%20pinches%20salt%7C4%20ounces%20tomato%20paste&allmyrecipes:procedure=1.)%20Brown%20ground%20chuck%20and%20sausage%20in%20a%20large%20pot%20over%20medium-high%20heat.2.)%20Drain%20off%20excess%20fat.3.)%20Add%20all%20remaining%20ingredients%20and%20bring%20to%20a%20boil.4.)%20reduce%20heat%20and%20simmer%20for%20about%20three%20hours.5.)%20Let%20cool%20for%20an%20hour%20and%20refrigerate%20over%20night.6.)%20The%20following%20day,%20warm%20to%20serving%20temperature%20and%20optionally%20serve%20with%20sour%20cream,%20shredded%20sharp%20cheese,%20and/or%20corn%20chips.&allmyrecipes:shareflag=1&allmyrecipes:postername=Bill%20Chapman&allmyrecipes:posterid=1942295&body=1.)%20Brown%20ground%20chuck%20and%20sausage)

# orm - 在 Kohana 3.3 中跳过 ORM 验证

> ID：13884902
> 
> 赞同：0
> 
> 时间：2012-12-14T19:14:51.583
> 
> 标签：orm, kohana

如何在不删除我的 ORM 模型规则功能的情况下跳过对特定 orm 保存的验证？

我正在使用 kohana 3.3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T21:41:16.567

看看`rules()`方法。您可以轻松添加自定义检查，如下所示：

```
// required by default
protected $_validation_required = TRUE;

public function rules()
{
    if ($this->validation_required())
    {
         // return all model rules
         return array(
              // default rules here
         );
         // or 
         // if extending model with existing rules
         return parent::rules(); 
    }
    else
    {
         // skip validation 
         return array();
    }
}

public function validation_required($required = TRUE)
{
     if ($required === NULL)
     {
           // work as getter
           return $this->_validation_required;
     }

     // set value
     $this->_validation_required = (bool)$required;
     return $this;
} 
```

当然，您可以使用针对不同事件（插入/更新等）的自定义规则来扩展此代码。

**附言**。您也可以覆盖`check()`方法并返回`TRUE`when `$this->validation_required() == TRUE`。但我更喜欢发送空规则（因为`rules()`是专门为定制而设计的，而`check()`它是一种系统方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T10:28:44.517

在接受的答案中，使用像 à getter 这样的 $this->validation_required() 函数似乎是错误的（$required 参数的默认值是！= NULL）

```
public function validation_required($required = TRUE)
{
    if ($required === NULL)
    {
       // work as getter
       return $this->_validation_required;
    }
... 
```

# android - LocationManager minDistance 设置问题

> ID：13884905
> 
> 赞同：0
> 
> 时间：2012-12-14T19:14:59.143
> 
> 标签：android, locationmanager

[我知道这与 2010 年提出的问题重复，但该问题从未真正得到答案]

我正在将我的一些 Windows Phone 应用程序转换为 Android。这些应用程序都围绕运动跟踪。在 WP7 中，位置观察器有一个“MovementThreshold”属性，用于设置 GPS 需要多少移动才能触发移动事件。通常，我们希望步行时的阈值较低，而在喷气式飞机中的阈值较高。它可以通过这样的代码进行节流，如果速度发生变化，每次我们移动时都会改变它。

```
 if (mph < 7) watcher.MovementThreshold = 5;
            else if (mph < 15) watcher.MovementThreshold = 20;
            else if (mph < 30) watcher.MovementThreshold = 100;
            else if (mph < 50) watcher.MovementThreshold = 400;
            else if (mph < 100) watcher.MovementThreshold = 800;
            else if (mph < 120) watcher.MovementThreshold = 1200;
            else if (mph < 200) watcher.MovementThreshold = 2400;
            else if (mph < 400) watcher.MovementThreshold = 4800;
            else watcher.MovementThreshold = 9000; 
```

目前在我的应用程序的 Android 版本中，当我的位置服务启动时，我会进行以下调用... locMgr.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locLstnr);

第三个参数是 minDistance（现在设置为零），听起来很像 WP7 中的 MovementThreshold。

我的第一个问题是：我可以像在我的 WP7 应用中限制 MovementThreshold 一样限制我的 Android 应用中的 minDistance 吗？我的第二个问题是：什么样的调用最有效地进行节流？- 我会重复上述 requestLocationUpdates 调用更改 minDistance 参数吗？谢谢，加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T02:02:36.550

最有效的节流方法是基于时间。该文档已在另一个答案中被引用，但很明显，设备必须先进行距离测量并对其进行过滤，然后才能计算距离阈值，而时间阈值允许设备避免进行位置测量。

我鼓励您使用固定时间进行轮询，因此只需设置一次更新。问自己这个问题——“我的应用需要多快知道距离的变化（任何距离）？” 如果您可以在其上添加一个数字（1 秒、100 秒等），请将其用作您的更新时间。如果你想避免额外调用你的回调函数，你也可以使用 minDistance。

请注意，您的阈值已经在“时间”中。您正在计算速度（mph）并且您有一个距离阈值（米，我假设，因为 WP7 中的“MovementThreshold”以米为单位），您可以轻松计算在阈值中移动距离所需的时间（距离 /速度和单位变化的帐户）并将该数字用作您的 minTime，因为您知道该时间之前的任何测量不应大于您的距离阈值，除非设备已改变速度。这为您提供了您正在寻找的滑动比例，但使用更有效的 minTime。

如果速度发生变化，您的轮询时间将关闭，直到您以新的速度进行第一次读取。我怀疑这对您来说并不重要，因为如果以高分辨率检测这些变化很重要，您可能已经根据时间而不是距离进行轮询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T20:29:40.970

> 我可以像在我的 WP7 应用中限制 MovementThreshold 一样限制我的 Android 应用中的 minDistance 吗？

恕我直言，不是真的。速度会有所不同，因此您需要持续的 GPS 定位来确定速度，以便您可以调整节流，从而消除节流。特别是，当喷气式飞机降落时，您可能需要一段时间才能发现这一点，因为您正在等待用户先步行（或开车）几公里。

当然，你在 WP7 中也需要它，所以我不知道你是如何将它拉到那里的。

就个人而言，我会自己进行过滤，而不是使用`minDistance`它。

> 什么样的调用最有效地进行节流？- 我会重复上述 requestLocationUpdates 调用更改 minDistance 参数吗？

原则上，是的。但是，引用文档：

> minDistance 参数还可用于控制位置更新的频率。如果它大于 0，那么位置提供程序将仅在位置已更改至少 minDistance 米并且至少 minTime 毫秒已过去时向您的应用程序发送更新。然而，位置提供者使用 minDistance 参数来节省电量更加困难，因此 minTime 应该是节省电池寿命的主要工具。

（请注意，此处有关的文档评论`minTime`仅与较新版本的 Android 真正相关；Android 1.x/2.x 用作`minTime`提示，而不是过滤器）

# jquery - jQuery UI - 对表格行进行排序并允许同时删除表格行？

> ID：13884906
> 
> 赞同：1
> 
> 时间：2012-12-14T19:15:08.060
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable, jquery-ui-draggable, tablerow

我正在开发一个任务管理应用程序。每个任务都显示在单独的表格行中。我希望用户能够对表行进行排序，以及将一行放入另一个嵌套任务的行中。

到目前为止，我已经弄清楚如何对元素进行排序。没什么大不了的。问题是我还需要能够将表​​行放在其他表行上，这似乎有点棘手。我知道我需要使用`draggable`并`droppable`结合`sortable`? 或者也许我根本不需要`sortable`，我不知道。

我尝试实施`draggable`，但似乎没有任何反应。[检查出来](http://jsfiddle.net/bRbSn/2/)。

谁能指出我正确的方向或给我一些建议？

**编辑：**当您将行放在另一行上时，我实际上并不想嵌套行，而是隐藏拖动的行。在它被删除后，我将进行 ajax 调用，将“捕手行”设置为数据库中的父级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T14:02:25.043

可以将 draggable 和 droppable 与 sortable 结合起来，查看这个[JQFAQ.com](http://jqfaq.com/how-to-use-jquery-sortable-and-droppable-in-single-table/)主题，这里他们在列表中启用了 droppable 和 sortable。

# mysql - mysql外键约束

> ID：13884907
> 
> 赞同：0
> 
> 时间：2012-12-14T19:15:12.660
> 
> 标签：mysql, sql

我对mysql不是很熟悉，当我尝试更新数据库时，它给了我以下错误：

> *无法添加或更新子行：外键约束失败 ( `lhollowa`. `Concert`, CONSTRAINT `Concert_ibfk_1`FOREIGN KEY ( `BandID`) REFERENCES `Bands`( `BandID`))*

我对自己做错了什么一无所知，有人能指出我正确的方向吗？

这是我拥有的一些东西（其余的会占用太多空间）。

```
 DROP TABLE IF EXISTS `Bands`;
 /*!40101 SET @saved_cs_client     = @@character_set_client */;
 /*!40101 SET character_set_client = utf8 */;
 CREATE TABLE `Bands` (
   `BandID` int(11) NOT NULL AUTO_INCREMENT,
   `BandName` varchar(30) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
   PRIMARY KEY (`BandID`)
 );

 DROP TABLE IF EXISTS `Songs`;

 CREATE TABLE `Songs` (
   `SongID` int(11) NOT NULL AUTO_INCREMENT,
   `SongTitle` varchar(50) COLLATE utf8_unicode_ci NOT NULL DEFAULT '',
   PRIMARY KEY (`SongID`)
 ) ENGINE=InnoDB AUTO_INCREMENT=481 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

 CREATE TABLE `Concert` (
 `ConcertID` int (40) NOT NULL AUTO_INCREMENT,
 `BandID` INT (40) NOT NULL DEFAULT '0',
 `Concert_Time` varchar (20) COLLATE utf8_unicode_ci DEFAULT NULL,
 `Venue_Name` varchar (40) COLLATE utf8_unicode_ci DEFAULT NULL,
 `Number_Seats` int (10) NOT NULL DEFAULT '0',
 `Number_Tickets` int (10) NOT NULL DEFAULT '0',
 PRIMARY KEY (ConcertID),
 FOREIGN KEY (BandID) REFERENCES Bands(BandID)
 );

 INSERT INTO `Concert` VALUES (82838283,1111111, 'noon', 'the razz', 139, 138); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:18:50.807

该错误告诉您您正在尝试在表中存在`Concert`之前将记录插入表中。 `BandId``Bands`

外键是两个表之间的约束。外键标识一个表中的列，该列引用另一个表中的列。

`Concert`由于您在和表之间设置了外键`Bands`，因此记录必须存在，`Bands`否则您将收到错误消息。`1111111`因此，您必须先插入带 id 的乐队，`Bands`然后才能为他们创建音乐会记录。

请参阅[SQL Fiddle with Demo 以](http://sqlfiddle.com/#!2/9d71e/1)显示工作版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:19:51.523

您正在尝试使用表中未找到的 插入或更新`concert`表`bandid`，`bands`或删除具有与其关联的现有音乐会的乐队。

这通常是因为您以错误的顺序执行操作；您必须确保在每个点上我们的数据都是一致的。

“以正确的顺序进行更新”还有另一种选择：您可以暂时关闭此类约束，以任何顺序进行更改，然后再次打开约束：

```
SET foreign_key_checks = 0;
-- update, insert whatever
SET foreign_key_checks = 1; 
```

这并不意味着您避免保持数据的一致性，但这确实意味着您不必担心对 dara 进行更改的顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T19:18:27.870

在插入 Concert 表之前将乐队插入到 Bands 表中。

# php - 计数器时间结束后刷新页面

> ID：13884913
> 
> 赞同：0
> 
> 时间：2012-12-14T19:15:41.280
> 
> 标签：php, javascript

我有一个脚本，用户可以在一段时间内编辑他们的内容，所以我添加了这个时间计数器：

```
 function StartCountDown(myDiv,myTargetDate)
{
var dthen   = new Date(myTargetDate);
var dnow    = new Date("<?php echo $targetdate ?>");
ddiff       = new Date(dthen-dnow);
gsecs       = Math.floor(ddiff.valueOf()/1000);
CountBack(myDiv,gsecs);
}

function Calcage(secs, num1, num2)
{
s = ((Math.floor(secs/num1))%num2).toString();
if (s.length < 2) 
{   
  s = "0" + s;
}
return (s);
}

function CountBack(myDiv, secs)
{
var DisplayStr;

var DisplayFormat = "%%D%% %%H%%:%%M%%:%%S%%";

if(secs>86400)
{

DisplayStr = DisplayFormat.replace(/%%D%%/g,    Calcage(secs,86400,100000)+' Days');

}
else
{

    DisplayStr = DisplayFormat.replace(/%%D%%/g,"");

}
if(secs>3600)
{

DisplayStr = DisplayStr.replace(/%%H%%/g,       Calcage(secs,3600,24));
}
else
{

    DisplayStr = DisplayFormat.replace(/%%D%% %%H%%/g,"00");

}
DisplayStr = DisplayStr.replace(/%%M%%/g,       Calcage(secs,60,60));
DisplayStr = DisplayStr.replace(/%%S%%/g,       Calcage(secs,1,60));
if(secs > 0)
{   
  document.getElementById(myDiv).innerHTML = DisplayStr;

  setTimeout("CountBack('" + myDiv + "'," + (secs-1) + ");", 990);
}
else
{
  document.getElementById(myDiv).innerHTML = "Period Over";
}
} 
```

计数器工作正常，并计算剩余时间，但如果用户没有离开页面并且剩余时间达到 0，他将收到此消息（Period Over），他将能够编辑他的内容。

我正在寻找的是一个代码，而不是 (Period Over) 在计数器达到目标时间时重新加载或刷新寻呼机。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:20:13.530

如果我对您的理解正确，您正在点击“Period Over”文本，所以只需将该行替换为：

```
window.location.reload(); 
```

# bash - shell 脚本 - 同时将结果打印到文件和命令提示符

> ID：13884915
> 
> 赞同：1
> 
> 时间：2012-12-14T19:15:53.253
> 
> 标签：bash, shell

有没有办法同时将结果打印到命令提示符和文件？

例如：

```
 echo a >test.log 
```

输出“a”必须同时写入 test.log 文件和命令提示符。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T19:17:02.363

该命令`tee`执行此操作，大多数 Linux 发行版默认安装此命令。

> tee - 从标准输入读取并写入标准输出和文件

用法：

```
echo abc | tee test.log 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:18:56.187

你想使用命令 tee

> 回显 |tee test.log

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-14T21:01:57.963

使用`tee`which 从标准输入读取并写入标准输出和文件。

# javascript - 下划线模板变量 - 刚刚开始

> ID：13884917
> 
> 赞同：0
> 
> 时间：2012-12-14T19:15:57.730
> 
> 标签：javascript, templates, underscore.js

下划线模板看起来很简单，但我正在尝试我的第一次尝试并且很难过。

我只是想在 H1 中显示一个人的名字。

这是我的模板：

```
<script id="tmpl-index-list" type="text/template">
<% _.each(data, function(item){  %>
    <li>
        <a href="#person" data-transition="slide">
            <h1><%=item.personName%></h1>
        </a>    
    </li>
<% }); %> 
```

这是我的 JS：

```
var tmplMarkup = $('#tmpl-index-list').html();
var compiledTmpl = _.template( tmplMarkup, {data: IndexList.listEntries} );
$('#index-list-wrapper').html(compiledTmpl); 
```

IndexList.listEntires 是 ListEntry 对象的数组，简单的键/值对象。

例如，这里是“类”：

```
function ListEntry(){
    this.img_url = '';
    this.personName = '';
    this.personID = '';
}; 
```

当我对其执行 console.dir 时，数据就在那里，但对于模板中的 item.personName，它显示为未定义。

我错过了什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:25:52.917

我相信问题出在您传入的数据上。您正在使用`IndexList.listEntries`，但您没有提供任何示例数据。

根据您的评论，这`listEntries`是一个对象数组，例如`ListEntry`，我汇总了一些示例数据。

```
var IndexList = {
    listEntries : [
        {
            "img_url" : "http://www.gravatar.com/avatar/72b3fbc4d71d3955deca44483322da23?s=32&d=identicon&r=PG",
            "personName" : "Tim",
            "personId" : "Tim76"
        },
        {
            "img_url" : "http://www.gravatar.com/avatar/0927a92a180a7552e2119742ede9b9cf?s=128&d=identicon&r=PG",
            "personName" : "Rob",
            "personId" : "Robert Price"
        }
    ]
}; 
```

使用此数据，您的模板在运行时正确地将“Tim”和“Rob”显示为列表项。

我建议你再去看看`IndexList`你试图使用的数据，问题几乎肯定存在。

# python - 通过 bash 向 pic18f2550 中继电路发送命令

> ID：13884927
> 
> 赞同：1
> 
> 时间：2012-12-14T19:16:35.437
> 
> 标签：python, ubuntu, usb, circuit

我有一个使用 pic18f2550 的 USB 中继电路，其供应商 ID：0461 和产品 ID：0020 我试图通过 python 通过 pyusb 与此设备通信，我可以连接设备但无法发送任何命令，总是出现忙错误。

如何在 ubuntu 中通过 bash 或 pyusb 向该电路发送命令？

我的python代码是

```
import usb.core
import usb.util
import struct
dev = usb.core.find(idVendor=0x0461, idProduct=0x0020)
if dev is None:
    raise ValueError('Device not found')
cfg = dev[0]
intf = cfg[(0,0)]

ep = usb.util.find_descriptor(
    intf,
    custom_match = \
    lambda e: \
        usb.util.endpoint_direction(e.bEndpointAddress) == \
        usb.util.ENDPOINT_OUT
)
assert ep is not None

buff = [0x80]
ep.write(buff) 
```

我的 lsusb -v 详细信息；

```
Bus 003 Device 002: ID 0461:0020 Primax Electronics, Ltd 
Device Descriptor:
  bLength                18
  bDescriptorType         1
  bcdUSB               1.10
  bDeviceClass            0 (Defined at Interface level)
  bDeviceSubClass         0 
  bDeviceProtocol         0 
  bMaxPacketSize0        64
  idVendor           0x0461 Primax Electronics, Ltd
  idProduct          0x0020 
  bcdDevice            1.00
  iManufacturer           1 SAC
  iProduct                2 ----arena----
  iSerial                 0 
  bNumConfigurations      1
  Configuration Descriptor:
    bLength                 9
    bDescriptorType         2
    wTotalLength           41
    bNumInterfaces          1
    bConfigurationValue     1
    iConfiguration          0 
    bmAttributes         0xc0
      Self Powered
    MaxPower              100mA
    Interface Descriptor:
      bLength                 9
      bDescriptorType         4
      bInterfaceNumber        0
      bAlternateSetting       0
      bNumEndpoints           2
      bInterfaceClass         3 Human Interface Device
      bInterfaceSubClass      0 No Subclass
      bInterfaceProtocol      0 None
      iInterface              0 
        HID Device Descriptor:
          bLength                 9
          bDescriptorType        33
          bcdHID               1.00
          bCountryCode            0 Not supported
          bNumDescriptors         1
          bDescriptorType        34 Report
          wDescriptorLength      32
         Report Descriptors: 
           ** UNAVAILABLE **
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x81  EP 1 IN
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
      Endpoint Descriptor:
        bLength                 7
        bDescriptorType         5
        bEndpointAddress     0x01  EP 1 OUT
        bmAttributes            3
          Transfer Type            Interrupt
          Synch Type               None
          Usage Type               Data
        wMaxPacketSize     0x0040  1x 64 bytes
        bInterval               1
Device Status:     0x0001
  Self Powered 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T19:24:39.823

Try setting something like the below in your /etc/udev/rules.d file:

SUBSYSTEM !="usb_device", ACTION !="add", GOTO="device_rules_end" SYSFS{idVendor} =="1532", SYSFS{idProduct} =="0017", SYMLINK+="mydevice" MODE="0666", OWNER="", GROUP="root" LABEL="device_rules_end"

# registry - 如何知道Windows注册表中的ActiveX条目是否未被使用并且可以删除？

> ID：13884930
> 
> 赞同：0
> 
> 时间：2012-12-14T19:16:38.197
> 
> 标签：registry, activex

我正在实施一个注册表清理器，`Windows 8`并且我知道在我的注册表中有一些关于`ActiveX`. 但是我不确定如何保证该条目真的不再需要了。

有人知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T23:19:46.110

只有附带 ActiveX 的程序知道。例如依赖于ActiveX的组件可能被设置为“首次使用时安装”状态，除了实际安装组件并在获取文件后对组件进行逆向工程之外，您无法找出依赖关系。

# jquery - Jquery Slider UI 范围，用过几次

> ID：13884934
> 
> 赞同：1
> 
> 时间：2012-12-14T19:16:50.810
> 
> 标签：jquery, class, user-interface, slider, range

我需要在一个页面中多次使用函数 jquery（UI 滑块范围）。不幸的是，我做不到！你能帮助我吗？

我有一个脚本“main.js”，如下所示：

```
jQuery(function($){
$('.range').each(function(){
   var cls      = $(this).attr('class');  
   var matches  = cls.split(/([a-zA-Z]+)\-([0-9]+)/g);
   var elem     = $(this).parent(); 
   var options  = {};
   var values   = new Array();
   var input    = elem.find('input'); 
   elem.append('<div class="uirange"></div>');

   options.range = true;
   options.orientation = "horizontal";
   options.disabled = false;
   for(i in matches){
       i = i * 1;
       if (matches[i] == 'min') {
           options.min = matches[i+1]*1;
       } 
       if (matches[i] == 'max') {
           options.max = matches[i+1]*1;
       } 
       if (matches[i] == 'prem') {
           options.values[0] = matches[i+1]*1;
       }
       if (matches[i] == 'dern') {
           options.values[1] = matches[i+1]*1;
       } 
       if (matches[i] == 'step') {
           options.step = matches[i+1]*1;
       } 
   }

   options.slide = function(event, ui){
       elem.find('label span').empty().append(ui.values[0] + "€ - " + ui.values[1] + "€");
       input.val(ui.values[0] + "€ - " + ui.values[1] + "€");
   }

   elem.find('.uirange').slider(options); 
   elem.find('label span').empty().append(input.val()); 
   input.hide(); 
}); 
```

});

这个函数被调用一次 chauqe 如下：

```
 <div class="choix">
            <div class="rubrique">Rubrique 01</div>
            <div class="input">
                <label for="">Valeur : <span></span></label>
                <input type="text" class"range min-0 max-100 prem-10 dern-80 step-10" />
            </div>
        </div>
        <div class="choix">
            <div class="rubrique">Rubrique 02</div>
            <div class="input">
                <label for="">Valeur : <span></span></label>
                <input type="text" class"range prem-1000 dern-10000 step-100" />
            </div>
        </div>
        <div class="choix">
            <div class="rubrique">Rubrique 03</div>
            <div class="input">
                <label for="">Valeur : <span></span></label>
                <input type="text" class"range prem-0 dern-1 step-0.1" />
            </div>
        </div> 
```

# ember.js - 在获取 ember 数据模型时寻求客户端模拟服务器错误的建议

> ID：13884937
> 
> 赞同：0
> 
> 时间：2012-12-14T19:17:09.820
> 
> 标签：ember.js, ember-data

我将 ember-data (v10) 与 RESTAdapter 一起使用。当从服务器（即 App.Model.CalendarWeek.find(2)）获取数据时，我希望能够在客户端模拟 HTTP 4xx 和 5xx 错误。但我不知道如何做到这一点。

目前我使用 Jasmine 和 jasmine-fake-ajax 进行客户端测试。

我想知道其他开发人员如何测试这些异常情况？

有什么建议或最佳实践吗？

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T14:40:48.177

看起来 jasmine-fake-ajax 支持[配置 HTTP 响应状态码。](https://github.com/mileskin/jasmine-fake-ajax#passing-data-to-successerror-handlers).

或者，[sinon](http://sinonjs.org/docs/#server)框架支持在伪造的 XHR 操作中配置 HTTP 响应状态代码。

# ruby - 集合对象很简单时的 Collection_select 问题

> ID：13884942
> 
> 赞同：0
> 
> 时间：2012-12-14T19:17:23.667
> 
> 标签：ruby, ruby-on-rails-3

我正在使用 RoR，我有一个 StateCity 对象，它有 2 个变量，州和城市。在我的 for 我有这段代码。

```
<%= collection_select( :state_city , :state , 
                          us_states , :id , :state_abbrev ) %> 
```

我的集合是由这样的助手中的数组提供的。

```
def us_states
[
    {'state_name' => 'Alabama', 'state_abbrev' => 'AL'},
    ....
] 
```

现在collection_set 方法需要一个value_method，但是如果你看到us_states，你可以知道我并不需要完整的模型。将低使用率类添加到应用程序中以便选择状态是不合适的。

PS 我正在使用 collection_select 完成所有这些操作，因为我希望我的表单在用户编辑时已经选择了 StateCity 模型的状态。如果有人认为我走错了路，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T06:31:36.043

解决方案是这样做。

```
 <%= form_for (@state_city) do |s| %>
      <div class="field">
        <%= s.label :city %><br />
        <%= s.text_field :city %>
       </div>
      <div class="field">
        <%= s.label "State" %><br />
        <%= select_tag("state", options_for_select(us_states ,@state_city.state )) %>
      </div>
    <% end %> 
```

# android - 如何在谷歌驱动器上创建空文件夹？

> ID：13884943
> 
> 赞同：4
> 
> 时间：2012-12-14T19:17:24.983
> 
> 标签：android, google-drive-api

我正在尝试为我的 android 应用程序创建空文件夹..

```
File body = new File();

body.setTitle("title");

java.io.File fileContent = new java.io.File("title");

FileContent mediaContent = new FileContent("application/vnd.google-apps.folder", fileContent);

File file = service.files().insert(body, mediaContent).execute(); 
```

这似乎不起作用......

获取异常：

java.io.FileNotFoundException:/title open failed ENOENT（没有这样的文件或目录）

引起：libcore.io.ErrnoException：打开失败：ENOENT（没有这样的文件或目录）

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-17T14:27:55.277

解决了...

```
File body = new File();
body.setTitle("title");
body.setMimeType("application/vnd.google-apps.folder");
File file = service.files().insert(body).execute(); 
```

它将在谷歌驱动器中创建名为**title的文件夹。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-25T08:55:45.593

嗯，我收到“权限不足 [403]”错误

# php - php简单的xml元素：其中没有显示

> ID：13884944
> 
> 赞同：0
> 
> 时间：2012-12-14T19:17:27.683
> 
> 标签：php, xml, simplexml

> **可能重复：**
> [SimpleXML 和命名空间](https://stackoverflow.com/questions/6843025/simplexml-and-namespaces)

我正在使用简单 XML 来尝试处理响应 XML。

我注意到许多元素丢失，并注意到它们的元素名称中都有一个“：”。

例如：

*   <更新>2012-12-14T18:17:53.670Z</更新>"
*   <app:edited>2012-12-14T18:17:53.670Z</app:edited>

<updated> 出现在对象中

<app:edited>**没有**

只需删除 : 即可显示该元素，但是我对这样的解决方案印象不深。

从响应的角度来看，我使用的 php 代码是：

$response = simplexml_load_string($xmlResponse); var_dump($response);

非常感谢任何帮助和解释这种行为。

谢谢

# java - 如何知道我们是否收到了带有 DatagramPacket 的东西？

> ID：13884946
> 
> 赞同：2
> 
> 时间：2012-12-14T19:17:37.637
> 
> 标签：java, sockets, networking, udp, datagram

我正在实现一个客户端-服务器程序，并希望我的客户端在没有来自服务器的 ACK-Answer 的情况下等待 5 秒后，发送回相同的数据包......

我是这样做的，所以请告诉我是否可以..

```
dp = new DatagramPacket(packet , packet.length , host , port);
        sock.send(dp);
        time = System.currentTimeMillis();
        while ((System.currentTimeMillis() - time < 5000) && ack_dp.getLength() == 0) {
            sock.receive(ack_dp);
        }

        if (ack_dp.getLength() == 0)
            sock.send(dp); 
```

所以我的程序将等待 5 秒的 ACK，如果他没有收到任何东西，他将重新发送相同的数据包。我检查他是否收到了带有数据包长度的确认..如果它保持为0，那么他没有收到任何东西..如果它比0长，那么超出while序列并发送一个新数据包..（ ps: ack_dp 是 2bytes)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-14T19:27:59.687

`receive()`套接字上的默认情况下会阻塞，因此您的循环在这里没有意义（即使套接字设置为非阻塞，在 99.99% 的情况下忙等待也是一个坏主意）^。

使用[`setSoTimeout()`](https://docs.oracle.com/javase/7/docs/api/java/net/DatagramSocket.html#setSoTimeout(int)), 和 catch`SocketTimeoutException`代替。

# html - CSS 列显示不正确

> ID：13884952
> 
> 赞同：0
> 
> 时间：2012-12-14T19:17:58.993
> 
> 标签：html, css, layout

我有一个`column-count`设置为的 div `3`。里面有很多`ul`s。我在右侧看到第 4 列的开头 - 为什么在我指定 3 列时会出现这种情况？

![截屏](../Images/55002caceb2c20035d583425003f1fdf.png)

**HTML**（这里提琴：http: [//jsfiddle.net/B6zDR/3/](http://jsfiddle.net/B6zDR/3/)）

```
<!DOCTYPE html>

<html>
    <head>
        <title></title>
        <style type="text/css">
            div
            {
                height: 150px;
                width: 835px;
                padding: 20px;
                overflow: hidden;
                text-overflow: ellipsis;
                -moz-column-count: 3;
                -webkit-column-count: 3;
                column-count: 3;
                background-color: lightblue;
            }

            h2
            {
                margin: 0;
            }
        </style>
    </head>
    <body>
        <div>
            <h2>UL #1</h2>
            <ul>
                <li>1</li>
                <li>2</li>
            </ul>
            <h2>UL #2</h2>
            <ul>
                <li>1</li>
                <li>2</li>
                <li>3</li>
                <li>4</li>
                <li>5</li>
                <li>6</li>
            </ul>
            <h2>UL #3</h2>
            <ul>
                <li>1</li>
                <li>2</li>
                <li>3</li>
                <li>4</li>
                <li>5</li>
            </ul>
            <h2>UL #4</h2>
            <ul>
                <li>1</li>
                <li>2</li>
                <li>3</li>
                <li>4</li>
                <li>5</li>
            </ul>
            <h2>UL #5</h2>
            <ul>
                <li>1</li>
                <li>2</li>
                <li>3</li>
                <li>4</li>
                <li>5</li>
            </ul>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:34:30.523

唯一可以覆盖`column-count`声明的是`height`声明。在您的示例中，您限制`height`了`div`元素的，但指定了 3 列布局。因此，您`div`试图强制采用 3 列布局，空间不足，并向右溢出。

查看[http://www.quirksmode.org/css/multicolumn.html上的“测试#6”](http://www.quirksmode.org/css/multicolumn.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-14T19:31:57.417

好的，所以这只是一个猜测，所以请记住这一点。

由于更改 HTML 5`column-count`属性不会改变 Firefox 17 中的任何内容，但`moz-column-count`确实如此，这似乎意味着它仍处于开发阶段。这很可能是一个错误。

# visual-studio - Visual Studio 2012 或 2013 中的 Emacs 键绑定

> ID：13884953
> 
> 赞同：56
> 
> 时间：2012-12-14T19:18:03.050
> 
> 标签：visual-studio, emacs, visual-studio-2012, key-bindings

我希望在 MSVS 中有 Emacs 键绑定。在 MSVS 2008 中，这是本机支持的，在 MSVS2010 中，有一个扩展来实现这一点

[http://blogs.msdn.com/b/visualstudio/archive/2010/09/01/emacs-emulation-extension-now-available.aspx](http://blogs.msdn.com/b/visualstudio/archive/2010/09/01/emacs-emulation-extension-now-available.aspx)

我可以在 MSVS 2012 中安装这个扩展吗？（到目前为止，我一直没有成功......）是否有另一种方法来实现 Emacs 键绑定？

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2012-12-30T02:17:44.517

我想出了如何让 VS 2010 的 emacs 仿真扩展在 VS 2012 上安装和运行。这有点来自记忆，但这就是我所做的。

1.  下载[Emacs 仿真扩展](http://visualstudiogallery.msdn.microsoft.com/09dc58c4-6f47-413a-9176-742be7463f92)。

2.  将其从 EmacsEmulations.vsix 重命名为 EmacsEmulations.zip 并解压缩到一个文件夹中。

3.  编辑`<VisualStudio Version="10.0">`extensions.vsixmanifest 文件 (XML) 上的值：

    ```
    <SupportedProducts>
        <VisualStudio Version="11.0">
        <Edition>Pro</Edition>
        </VisualStudio>
    </SupportedProducts> 
    ```

注意：Visual Studio 2013 通过设置`Version="12.0"`. 并且可以通过设置使用 VS Express`<Edition>Express_All</Edition>`

4.  压缩**文件夹内的内容**备份并将其重命名为 EmacsEmulations.vsix。

5.  以管理员身份运行 vsix 文件。这是必需的，以便扩展可以将 Emacs.vsk 写入程序文件夹。我不确定执行此操作的最佳方法，因此我以管理员身份运行命令提示符，然后`start emacsemulations.vsix`从提示符处执行。

6.  以管理员身份启动 VS 2012（仅限一次）。此时，扩展程序应显示为已安装在扩展程序管理器中，并且键绑定应列在`Tools/Options/Keyboard`. 选择 emacs 键绑定。

7.  此时它应该可以工作。虽然它对我不起作用，但我忽略了以管理员身份运行第 5 步，因此不得不手动**将 emacs.vsk 复制到正确的位置**。当它仍然不起作用时，我打开了 VS 命令窗口（Windows/Other Windows/Command Window）并输入了 Edit.EmacsBreakLine 和提示符，瞧。

我没有比这更多的信息了，所以 YMMV。祝你好运！

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-06-23T10:08:00.760

仅供参考：emacs 仿真扩展现在是开源的。

*   [https://github.com/zbrad/EmacsKeys](https://github.com/zbrad/EmacsKeys)
*   [http://zbrad.github.io/tools/EmacsKeys/](http://zbrad.github.io/tools/EmacsKeys/)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-05-24T16:48:23.367

如果您想让它与 VS2013 的 Express 版本一起使用，请确保还将 Edition 行更改为`<Edition>Express_All</Edition>`. 另请参见[Edition 元素的描述](http://msdn.microsoft.com/en-us/library/vstudio/ee822857.aspx)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-06-29T17:24:48.717

Jaket 的方法最初对我有用，但几天后就停止了。在绝望中寻找解决方案后，我通过一篇博文[2]找到了XKeymacs [1]。XKeymacs 将 keymacs 样式的键绑定添加到整个 windows 环境，并且在 Visual Studio 中也可以使用。可能需要一些时间来适应（例如 Ctr-T 不再在 IE 中工作），但我很高兴能够在任何地方使用 emacs 键绑定 :)

1.  [http://www.cam.hi-ho.ne.jp/oishi/indexen.html](http://www.cam.hi-ho.ne.jp/oishi/indexen.html)
2.  [http://lexicalclosures.blogspot.com/2010/10/emacs-resharper-visual-studio-xkeymacs.html](http://lexicalclosures.blogspot.com/2010/10/emacs-resharper-visual-studio-xkeymacs.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-08-25T15:55:15.923

我不相信接受的答案中的所有步骤都是正确的。反而：

1.  按照上面的 1-4 生成一个合适的`EmacsEmulations.vsix`文件。
2.  以需要绑定的用户*而非*管理员身份安装扩展。
3.  手动将`Emacs.vsk`文件从扩展的解压缩内容复制`Common7\IDE`到 Visual Studio 程序目录中的文件夹（您需要提升权限）。

以管理员身份运行扩展程序不会获得所需的文件副本，也不会允许其他用户成功使用新的键绑定。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-04-07T21:09:47.720

对我有用的技巧是将 Emacs.vsk 文件复制到：

```
C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE> 
```

目录。不知何故，当我第一次安装它时，它已被复制到

```
C:\Program Files\Microsoft Visual Studio 12.0\Common7\IDE> 
```

目录

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-04-17T05:21:56.280

要为**Microsoft Visual Studio Community 2015**（报告其版本为 14.0）安装 EmacsEmulations.vsix 文件，文件夹中有一个安装工具**VSIXInstaller.exe**：

C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE>

按照上述修改 vsix 文件（在我的情况下插入版本“14.0”和版本“社区”）后，以下内容从管理命令行为我工作（填写您自己的完整路径）：

**VSIXInstaller.exe /a EmacsEmulations.vsix**

请注意，在工具/选项/环境中的键盘映射下拉列表中选择 Emacs 后，更改似乎并没有立即生效。我重新启动了 Visual Studio，但也没有。

然后我搜索了名称中带有“emacs”的已安装键绑定，它们就在那里。似乎在那之后他们在编辑器中处于活动状态，所以我不能 100% 确定是什么触发了激活。

# vb.net - Webkitdotnet Pagesetting.margin 设置错误

> ID：13884959
> 
> 赞同：2
> 
> 时间：2012-12-14T19:18:46.793
> 
> 标签：vb.net, webkit.net

我是 vb 的新手，我不明白错误，此代码使用 webkitdotnet，我制作了一个浏览器，我想更改打印页面设置边距值。

代码是，

```
Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
    WebKitBrowser1.Navigate("http://localhost:78/print/printer.asp")
    WebKitBrowser1.PageSettings.Margins(set="5, 5, 5, 5")

End Sub 
```

结束错误是

```
Property access must assign to the property or use its value. 
```

如何设置新的页边距？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T20:30:23.267

```
With WebKitBrowser1.PageSettings.Margins
        .Bottom = 5
        .Left = 5
        .Top = 5
        .Right = 5
End With 
```

# c - 指针递增后变为 NULL

> ID：13884970
> 
> 赞同：1
> 
> 时间：2012-12-14T19:19:24.763
> 
> 标签：c, module

我使用 vmalloc 分配一个连续的虚拟内存块。然后我使用 memset 将此块的所有字节设置为 0。然后，我用我创建的 16 字节大小的数据结构填充这个内存区域。

然后，在我的一个函数中，我放置一个指向其中一个结构的指针，并开始沿着内存区域查找第一个 0 字节，以便我可以在此处放置另一个数据结构。我的第一个指针正确地获取了先前放置的结构，并且我可以看到地址。这是打印输出：

point's filename / //文件名 ffffc9001095b500 //地址

那是这个结构的正确内存区域（因为我把它放在这里）。

然后我增加我的指针，这应该将我带到内存区域 ffffc9001095b510，但我的指针返回的地址为 NULL。为什么是这样？

这是代码：

```
void * check_aux(char * upPath, int index, int location){
struct directory * point;       
int i = 0;
int dirnum = 0;
//int lastaddr;
printk("Inside check_aux\n");   

if(location > 117){
    return NULL;
}
else if(upPath == NULL){
    return NULL;
}
else{
    point = getLocation(index, location);
    printk("This is point's filename %s\n%p\n", point->filename, point);        
    while(point != NULL && dirnum < 16){

        while(point->filename[i] == upPath[i] || (point->filename[i] == 0 && (upPath[i] =='/' || upPath[i] == 0))){
            printk("%c == %c\n", point->filename[i], upPath[i]);
            if(point->filename[i] == 0 && upPath[i] == 0){
                return NULL;
            }
            else if(point->filename[i] == 0 && upPath[i] == '/'){
                if(nodes[point->index].type[0] == 'd'){
                    return check_aux(&upPath[i+1], point->index, 0);
                }
                else{
                    return NULL;
                }

            }
            else{
                i++;
            }

        }
        dirnum++;
        (point++);
    }
    if(dirnum == 16){
        return check_aux(upPath, index, location+1);
    }
    printk("Returning point %p\n", point);
    return point;
}

} 
```

数据结构定义为

```
struct directory{
char filename[14];
short index;

}; 
```

并且文件名不能以 0 开头。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-14T19:53:15.390

除了 Sebastian 分析的仅返回 NULL 的逻辑之外，您可能还需要查看其他一些内容...

考虑替换`point = (point++);`为...

```
++point;
point++;
point += 1; 
```

此外，这个函数的[圈复杂度](http://en.wikipedia.org/wiki/Cyclomatic_complexity)似乎有点高。如果真的没有办法简化该逻辑，那么至少将其分解为两个或三个功能，每个功能做出更少的决定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-14T19:31:38.677

您在 2 种情况下离开循环：

*   如果 point 为 NULL，则在这种情况下返回 NULL。
*   如果 dirnum 为 16。在这种情况下，您将递归调用该函数，并且还将返回 NULL。

所有其他返回语句也返回 NULL。

# php - 在禁用 cookie 时使用会话？

> ID：13884971
> 
> 赞同：0
> 
> 时间：2012-12-14T19:19:25.030
> 
> 标签：php, html, session, cookies, sessionid

我必须制作一个时间表系统，并且我在页面中进行了登录，但随后我需要使用会话来了解谁的登录以及他们是否仍然登录但`cookies`必须被禁用所以我尝试将`SessionID`'s保存到数据库，`MySQL`但我不知道如何在另一个页面上检索该会话 ID，所以任何想法都会有所帮助？不确定我是否也完全正确

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T19:20:53.403

You'd need to pass the session ID through the url, like so:

`http://local.domain/index.php?sessionID=7387837rhdfjfytyfegwfvkewbf`

Obviously the above `GET` request makes the session ID fairly obvious. Really though, in normal circumstances, only the users themselves will see it. So the security implications aren't terribly bad, but they are there for the malicious, to spoof a session.

**Tips for using this approach:**

*   Don't use incremental sessionIDs (100, 101, 102) - [Generate random ID's](http://php.net/manual/en/function.uniqid.php)
*   Although you could use a `POST` request on every page, it doesn't help security and it'll probably upset/antagonise your user (Consider back button presses)
*   Still maintain your session in the database, using the unique session ID from `$_GET` as the key
*   Ensure that the session times out, and **quickly**. Update the `last_access` time with each refresh to ensure an active user doesn't time out.

# ruby-on-rails - Rails：使用控制器进行导入

> ID：13884979
> 
> 赞同：0
> 
> 时间：2012-12-14T19:19:48.883
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, controller

我有很多 JSON 数据，想将其导入我的数据库。我的问题是，我的控制器中有几个`after_create`和`after_update`方法，其他东西被写入数据库。

所以我在考虑使用控制器来导入数据。我可以将我的数据格式化为与 params 哈希相同的格式。但是当我创建控制器的一个实例时，设置参数哈希并调用`create`它并没有找到一些类变量。

然后我试图强制 RSpecs 控制器测试通过一个帖子来完成这项工作，但我也在那里失败了。也许这是不可能的，或者甚至有更好的选择来使用我的控制器中的所有钩子导入数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-14T22:30:35.723

您可以使用[RestClient](https://github.com/archiloque/rest-client)之类的东西将数据发布到网站本身。

至于处理身份验证，devise 支持 HTTP 基本身份验证，但[必须启用](https://github.com/plataformatec/devise/wiki/How-To%3a-Use-HTTP-Basic-Authentication)。如果可以的话，您可以轻松地将 RestClient 与 HTTP 基本身份验证一起使用。另一种选择是将[令牌身份验证](https://github.com/plataformatec/devise/wiki/How-To%3a-Simple-Token-Authentication-Example)与 Devise 一起使用。

# java - 使用无状态会话保存 ManyToMany 集合

> ID：13884981
> 
> 赞同：4
> 
> 时间：2012-12-14T19:19:57.033
> 
> 标签：java, hibernate, hql

我有：

```
@Entity
public class EmailAndName {
...
} 
```

和

```
@Entity
public class MessageDetails {
    @ManyToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JoinTable(name = "MessageDetails_to")
    public Set<EmailAndName> getTo() {
        return to;
    }
} 
```

当我

```
public static void main(String []a)
{
    StatelessSession sess = HibernateUtils.getSessionFactory().openStatelessSession();
    sess.beginTransaction();
    MessageDetails messageDetails = new MessageDetails();
    messageDetails.setTo(new HashSet<EmailAndName>());
    EmailAndName emailAndName = (EmailAndName) sess.get(EmailAndName.class, 1L);
    if (emailAndName == null ) throw new RuntimeException();
    messageDetails.getTo().add(emailAndName);
    sess.insert(messageDetails);
    sess.getTransaction().commit();
} 
```

未填充 MessageDetails_to 表。我应该怎么办？我不想编写本机查询。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T08:41:19.300

您还没有通读[hibernate-doc](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html/batch.html#batch-statelesssession)的无状态会话

它明确指出：

```
Operations performed using a stateless session never cascade to associated instances. Collections are ignored by a stateless session. 
```

你正在尝试添加一个`Set<EmailAndName>`. 无状态会话是一种较低级别的抽象，更接近底层的 JDBC。所以如果你真的想让你的代码工作并填充 MessageDetails_to.. 你需要去 Session。您将需要为您的 POJO 定义 equals 和 hashCode 方法:)

所以您修改后的代码将是：

```
public static void main(String []a)
{
   try{
    Session sess = HibernateUtils.getSessionFactory().openSession();
    sess.beginTransaction();
    MessageDetails messageDetails = new MessageDetails();
    messageDetails.setTo(new HashSet<EmailAndName>());
    EmailAndName emailAndName = (EmailAndName) sess.get(EmailAndName.class, 1L);
    if (emailAndName == null ) throw new RuntimeException();
    messageDetails.getTo().add(emailAndName);
    sess.save(messageDetails);
    sess.getTransaction().commit();
 }
catch(HibernateException e)
 {
   sess.getTransaction.rollback();
   e.printStackTrace();
 }
  finally{
       sess.close();
  } 
```

您必须始终包含一个 try catch，以便您可以识别异常（如果有）并使其工作:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T19:22:03.713

First, are you sure that the transaction is commited?

Second, you are using a `Set`. Do you have sure that the `equals` and `hashCode` method of the `EmailAndName` class are well-defined?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:05:20.930

好吧，我认为您的代码无法正常工作的主要原因是由于使用了无状态会话，但无论如何我建议您在实现 1-N 和 NM 关系时定义关系的反面并更新双方。

另外，不要让外部类直接操作集合，因为它破坏了封装。不要为您的集合公开 set 方法，这可能会导致难以调试的非常讨厌的异常。使用*添加*和*删除*方法来更新您的集合。

```
@Entity
public class MessageDetails {

    private Set<EmailAndName> to = new HashSet<EmailAndName>();

    @ManyToMany(fetch = FetchType.LAZY, cascade = CascadeType.ALL)
    @JoinTable(name = "MessageDetails_to", 
       joinColumns = {@JoinColumn(name = "MESSAGE_DETAILS_ID"},
       inverseJoinColumns = {@JoinColumn(name = "EMAIL_AND_ADDRESS_ID")})
    public Set<EmailAndName> getTo() {
        return Collections.unmodifiableSet(to);
    }

    public void addEmaiAndName(EmailAndName emailAndName) {
       emailAndName.setMessageDetails(this);
       to.add(emailAndName);
    }

    public void removeEmailAndName(EmailAndName emailAndName) {
       emailAndName.setMessageDetails(null);
       to.remove(emailAndName);
    }

} 
```

代码的另一部分应该是这样的：

```
Session sess = HibernateUtils.getSessionFactory().openSession();
sess.beginTransaction();
MessageDetails messageDetails = new MessageDetails();
EmailAndName emailAndName = (EmailAndName) sess.get(EmailAndName.class, 1L);
if (emailAndName == null ) throw new RuntimeException();
messageDetails.addEmailAndName(emailAndName);
sess.save(messageDetails);
sess.getTransaction().commit(); 
```

# c# - C# 正则表达式忽略末尾的额外数据

> ID：13884988
> 
> 赞同：5
> 
> 时间：2012-12-14T19:20:20.500
> 
> 标签：c#, regex

我正在尝试在 C# 中构建具有以下特征的正则表达式。

1.  字符串以零个或多个数字开头
2.  后跟字母“ABC”
3.  紧跟在字符串的结尾

我试过了

```
\d?ABC 
```

但仍然匹配`ZABC`, `ABCD`, `2ZABC`.

任何指针？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-14T19:21:22.610

您需要[锚点](http://www.regular-expressions.info/anchors.html)来表示字符串的开始和结束：

```
^\d?ABC$ 
```

此外，`?`表示 0 或 1。0 或更多是`*`：

```
^\d*ABC$ 
```

另请注意，根据`Culture`.NET 中的活动情况，`\d`可以将其解释为“任何 Unicode 数字字符”。如果您真的只想要 ASCII 数字，请使用字符类：

```
^[0-9]*ABC$ 
```

该网站上的[教程](http://www.regular-expressions.info/tutorial.html)是学习正则表达式的绝佳资源。

# iphone - 在 iOS 中显示像素矩阵的最佳方式

> ID：13884995
> 
> 赞同：3
> 
> 时间：2012-12-14T19:20:54.950
> 
> 标签：iphone, ios, matrix, draw, pixel

嗨，我正在为 iPhone 开发 VNC 客户端应用程序（用于学校项目），我正在使用 RFB 协议。

我正在接收像素矩阵（每像素 32 位）并且我需要显示它们，但我需要它快速并且作为 VNC 客户端我需要在发生更改时快速更新图像。

我试过了`CGBitmapContextCreate`，我可以创建图像并显示它，但每次我需要更新它时，我都必须创建一个新图像，所以这不是一个很好的解决方案。

我想知道是否有更有用或更好的方法来显示我的像素矩阵。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-14T20:04:26.170

我假设您的服务器发送部分更新，并且不会在每次更新时发送全屏快照。

简单的技术是创建一个[`CGBitmapContext`](https://developer.apple.com/library/mac/#documentation/graphicsimaging/reference/CGBitmapContext/Reference/reference.html)并保留它。当您获得新像素时直接更新其数据（使用`CGContextFillRect`会慢得多），然后使用它创建图像`CGBitmapContextCreateImage`并将该图像分配给`view.layer.contents`. （不要忘记将图像存储在该属性中后释放它！）

但是，正如您所发现的，您必须每次都创建一个新图像。为什么？A`CGImage`是不可变的。为了强制执行不变性，Core Graphics 在创建`CGImage`. 然后，当您在图层中显示图像时，iOS 必须再次将像素数据复制到窗口服务器（这是一个单独的过程）。复制整个屏幕的像素数据很慢：根据设备，您要复制的大小从 614 KB（iPhone 3GS 及更早版本）到 12.6 MB（Retina iPad）不等。

在仍然停留在 UIKit 和 Core Animation 的世界中的同时，您可以加快速度的一种方法是使用图层网格平铺屏幕。假设您使用每个 64x64 像素的图层平铺它。您为每个图层创建一个`CGBitmapContext`。然后，当您从服务器接收到像素数据时，您会更新相应`CGBitmapContext`s 的数据，然后仅更新需要它的图层的内容。当屏幕的一小部分区域发生变化时，您只会更新一个或几个图块，因此您将复制更少的数据。在 64x64 像素时，您将复制每个图块 16 KiB。您可能想尝试几种不同的尺寸，以找出最适合的尺寸。

如果这还不够快，您将需要离开 UIKit 和 Core Animation 的世界并使用 OpenGL ES。在 iOS 上，OpenGL ES 提供了对视频卡的最直接访问，除非您的电子邮件地址以`@apple.com`. 您可以使用像素数据创建纹理，并使用该纹理绘制两个三角形（排列形成一个矩形），覆盖`CAEAGLLayer`. `glTexSubImage2D`当您获得新的像素数据时，您可以使用并重新绘制三角形将其写入纹理。如果你没有做过太多的 OpenGL 编程，这将是一个相当大的努力。