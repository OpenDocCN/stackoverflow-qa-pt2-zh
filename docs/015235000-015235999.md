# StackOverflow 问答 15235000-15235999

# javascript - 为什么我的 console.log 语句没有显示？

> ID：15235000
> 
> 赞同：0
> 
> 时间：2013-03-05T22:01:02.060
> 
> 标签：javascript, jquery, dom, cgi

我在[http://jonathanhayward.com/powerbible.cgi](http://jonathanhayward.com/powerbible.cgi)有一个圣经搜索和段落查找工具。这个工具相对成熟，已经看到了很多有效的使用，但它有点[像 EMERAC](http://www.ronaldbieber.de/Interface_Hall_of_Shame/metaphors.html#METAPHOR8)的搜索隐喻：它一开始提供了太多的选项，如果用户想要更具体的搜索，则显示应该推迟到渐进式披露的内容。

目前左窗格有[EMERAC 综合征](http://www.ronaldbieber.de/Interface_Hall_of_Shame/metaphors.html#METAPHOR8)；它提供了许多选择。并且所有“除非被询问，否则不显示”选项都在具有 CSS 类“advanced_search”的容器中，但尝试调用 simple_or_advanced_search() 似乎会导致调用该函数，并在控制台中使用参数。 log() 如果我执行 console.log()，但似乎没有隐藏具有“advanced_search”类的 tr。该函数是，无需修饰旧的 Tcl 多行字符串：

```
 <script language="JavaScript">
     <!--
     function simple_or_advanced_search(advanced_value)
     {
     if (advanced_value == "advanced")
     {
     jQuery('.advanced_search').show();
     jQuery('.advanced_search_alternate').hide();
     }
     else
            {
     jQuery('.advanced_search').hide();
     jQuery('.advanced_search_alternate').show();
     }
     document.bibletool.advancedSearch.value = advanced_value;
     }
     // -->
     </script> 
```

调试输出显示这是按预期使用“simple”参数调用的，但到目前为止我还没有看到输入的任何部分隐藏/显示。Chrome 和 Firebug 不会报告错误。

来源在[http://jonathanhayward.com/powerbible.txt](http://jonathanhayward.com/powerbible.txt)。

# asp.net - 如何在 mvc 3 razor 视图中将可空小数格式化为货币仅用于显示目的

> ID：15235001
> 
> 赞同：2
> 
> 时间：2013-03-05T22:01:02.660
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-4

我需要帮助在 mvc 应用程序的 razor 视图中将可为空的十进制字段格式化为货币（带有美元符号和逗号）。下面是我的模态和视图代码。

**型号**：

```
[Display(Name = "Eligible Amount")]
[RequiredIfProjectEngineerSelected("ProjectEngineerId", "", ErrorMessage = "Eligible Amount field is Required")]        
[DisplayFormat(DataFormatString = "{0:c}")]        
public decimal? EligibleAmount { get; set; } 
```

**查看**：

```
@{var formated = String.Format("{0:c}",  decimal)decimal.Parse(@Model.project.ProjectTotalCost.HasValue ? @Model.project.ProjectTotalCost.Value.ToString() : ""));}
@Html.TextBoxFor(model => model.project.ProjectTotalCost, new { @Value = formatted}) 
```

它在 TextBoxFor 控件中显示格式化的货币值。但是我在这里面临的问题是，当我尝试更新值时，出现验证错误，提示“值与格式不匹配”​​。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T22:07:47.023

首先，您应该用一行代码替换您在视图中显示的 2 行代码：

```
@Html.EditorFor(x => x.EligibleAmount) 
```

这将考虑`DisplayFormat`您在模型上定义的属性，您无需在视图中重复此格式。您只需将`ApplyFormatInEditMode`属性设置为以在编辑模式下启用它`true`：

```
[Display(Name = "Eligible Amount")]
[RequiredIfProjectEngineerSelected("ProjectEngineerId", "", ErrorMessage = "Eligible Amount field is Required")]        
[DisplayFormat(DataFormatString = "{0:c}", ApplyFormatInEditMode = true)]        
public decimal? EligibleAmount { get; set; } 
```

好的，这解决了显示部分。但是模型绑定部分仍然是一个问题。为此，您可以编写一个自定义模型绑定器，该绑定器将考虑您的`DisplayFormat`属性中定义的格式。我已经展示了一个带有 DateTime at 的模型绑定器的示例[`this post`](https://stackoverflow.com/a/7836093/29407)。您所要做的就是适应它的`decimal`时间，这应该是一项微不足道的任务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-02T19:28:48.887

感谢您在这方面给我的所有建议。我可以通过使用 ModelBinder 来解决这个问题。

根据[Darin 的回答](https://stackoverflow.com/a/15235103/712526)，我无法将控件从 TextBoxFor 更改为 EditorFor，因为我需要对其应用样式。ModelBinder 也适用于 TextBoxFor 控件。

~ 巴拉吉

# sql - 如何根据某些数据限制条件摆脱 oracle 中的重复行？

> ID：15235005
> 
> 赞同：1
> 
> 时间：2013-03-05T22:01:16.533
> 
> 标签：sql, oracle11g

我正在使用 Oracle 11G 并有 2 个名为 RES 和 TES 的源数据表，我使用它们根据数据规则规范为“CREATED”列创建新值。

```
Tables:RES
Number
entry
name
by

TES
Number
Completed
Machine
On

SELECT DISTINCT RES.TES_NUMBER,
RES.NAME,
RES.ENTRY,

CASE
WHEN REGEXP_LIKE(RES.NAME,'Created By','i') AND RES.ENTRY IS NOT NULL THEN RES.ENTRY
WHEN NOT REGEXP_LIKE(RES.NAME,'Created By','i') AND RES.BY IS NOT NULL THEN RES.BY 
END AS CREATED_BY,

CASE
WHEN REGEXP_LIKE(RES.NAME,'Created Date','i') THEN RES.ENTRY
ELSE TO_CHAR(TES.ON)
END AS CREATED_DATE,

CASE
WHEN TES.Machine IS NOT NULL THEN TES.Machine
WHEN REGEXP_LIKE(RESULT.NAME,'Machine|Manual G/H','i') THEN RES.ENTRY
END CREATED_MACHINE_ID

FROM RES, TES
WHERE RES.NUMBER = TES.NUMBER; 
```

如果某些内容在 NAME 中有某个字符串或者某些值为空，我正在尝试根据上述规则为上述某些列创建新的数据值。主键是两个表之间的 NUMBER。当我运行此选择时，在 case 语句中创建新值就好了，但它可以创建重复项，因为 NUMBER 可以有多个条目。以下是来自查询的一些示例数据：

```
NUMBER  NAME    BY   CREATED_BY  ON  CREATED_DATE  MACHINE  CREATED_MACHINE_ID   ENTRY
458920  Machine JONS1 JONS1   13-Apr-11 13-Apr-11  B30ST5   B30ST5
458920  Created By   MARY DOE 13-Apr-11 13-Apr-11                                  MARY DOE
458920  Calc    BEN90 BEN90   13-Apr-11 13-Apr-11                                    0
458920  Created Date TWING2 TWING2 13-Apr-11 8/2/2010                          8/2/2010
458920  EquipName  TWING2 TWING2 13-Apr-11 13-Apr-11                           DELTA 45
458920  Calc    DANNY3S DANNY3S 13-Apr-11 13-Apr-11                       98

DESIRED DATA                                
NUMBER  CREATED_BY  CREATED_DATE    CREATED_MACHINE_ID                  
458920  MARY DOE    8/2/2010    B30ST5 
```

我的问题是我只想获得第一个 case 语句要求的值，而不是为单个测试的“创建”列获得多行。任何帮助将不胜感激。抱歉，示例数据有点混乱，但我需要 10 分才能发布屏幕截图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:23:10.193

如果`number`是两个表之间的链接，则需要使用显式`JOIN`或至少一个`WHERE`子句。如果没有它们中的任何一个，您将创建一个**笛卡尔 Join**。

`WHERE res.number = tes.number`在您的声明底部添加

# tsql - 使用多个外键对同一个表进行排序

> ID：15235006
> 
> 赞同：1
> 
> 时间：2013-03-05T22:01:22.420
> 
> 标签：tsql

对不起，如果这是一个 n00b 问题。我不是 T-SQL 专家，但我有一个工作理解。我会试着把这一点说清楚，但一开始有点令人困惑。

# 问题

我有两张桌子。表 A 表示一个项目，表 B 表示项目之间的关系。

表 A：项目 ID、名称、...

表 B：ParentID、ThisID、ChildID

我面临的问题是表 B 中的所有三个 ID 都指向表 A 中的主键，但是我需要按 A.Name 为每个关系角色按组对结果进行排序（如果有意义的话）。

所以，如果表 A 有：

```
1 ItemZ
2 ItemA
3 ItemD
4 ItemX
5 ItemT 
```

表 B 有：

```
1 3 5
1 2 4
1 3 4
1 2 3
2 4 5
1 2 5 
```

我希望返回的结果按父项目的名称分组，然后是“这个”项目名称，然后是子项目的名称......在这种情况下：

```
2(A) 4(X) 5(T)
1(Z) 2(A) 3(D)
1(Z) 2(A) 5(T)
1(Z) 2(A) 4(X)
1(Z) 3(D) 5(T)
1(Z) 3(D) 4(X) 
```

# 问题

如何`ORDER BY`在保持分组的同时在同一字段（表 A.Name）上使用？

# 笔记

我读过这个：[SQL Ordering by Date but Maintain Foreign Key Groupings](https://stackoverflow.com/questions/3165999/sql-ordering-by-date-but-maintain-foreign-key-groupings)，但我认为答案不适合我的问题。我在此处和 Google 上查找了我的问题，但找不到重复项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:11:58.093

您需要将表连接在一起，以便可以将 Table 中的 ID 与 Table`B`中的名称链接起来`A`。由于您在 Table 中有三个不同的 ID`B`链接到 Table `A`，因此您需要加入 Table`A`三次。为了使事情井井有条，我建议使用别名，如`A_Parent`, `A_Child`, `A_This`。这是一个应按预期排序的示例：

```
select
  B.ParentID, B.ThisID, B.ChildID
from
  TableB B
join
  TableA A_Parent on A_Parent.ItemID = B.ParentID
join
  TableA A_This on A_This.ItemID = B.ThisID
join
  TableA A_Child on A_Child.ItemID = B.ChildID
order by
  A_Parent.Name, A_This.Name, A_Child.Name 
```

样本输出（[**演示**](http://www.sqlfiddle.com/#!3/a45e0/1)）：

```
PARENTID | THISID | CHILDID
-----------------------
  2      |  4     |  5
  1      |  2     |  3
  1      |  2     |  5
  1      |  2     |  4
  1      |  3     |  5
  1      |  3     |  4 
```

# rdf - 如何将 MathML 嵌入到本体中并引用它的部分

> ID：15235012
> 
> 赞同：0
> 
> 时间：2013-03-05T22:01:41.610
> 
> 标签：rdf, ontology, owl, mathml

我对 MathML 还很陌生，所以如果这是一个愚蠢的问题，我深表歉意。我想将 MathML 3.0 嵌入到本体（RDF/OWL 等）中。但我希望等式中的变量引用本体中的实体。

例如，对于方程式 ( **a** + **b** )，其中**a**由**exampleontology#a**表示，**b**由**exampleontology#b**表示，我会执行以下操作：

<apply> <csymbol cd="arith1">加号</csymbol>

<ci id='exampleontology#a'>a</ci>

<ci id='exampleontology#b'>b</ci>

</申请>

我不确定嵌入这些引用的最合适方法是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T19:23:01.250

[semanticweb.com](http://web.archive.org/web/20140525064410/http://answers.semanticweb.com:80/questions/871/mathematical-expressions-in-rdf)上有关在 RDF 中编码数学表达式的相关问题的答案可能有助于实现预期目标。

它为数学对象以及数学表达式和 RDF 资源和属性之间的交叉引用引入了基于 OpenMath 的词汇表（另请参见[RDF 的 OpenMath 内容字典](http://www.openmath.org/cd/contrib/cd/rdf.xhtml)）。由于 OpenMath 还与严格内容 MathML 完全兼容，因此很容易在两种表示之间进行转换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T09:16:44.507

传统上，MathML 和 OWL 都使用它们自己独立的特定标签（例如：）序列化为 XML `<owl:Class rdf:about="exampleontology#A"/>`。所以这是不可能的，你必须找到一个解决方法。

您可以做的是创建一个本体，然后通过 OWL 注释属性（例如`mathml`）链接一些 MathML 代码。然后，您可以稍后通过访问注释属性的值来检索 MathML 代码。

例如，如果您将以下代码块保存为 .owl 文件并使用 Protege 4 打开它，您应该能够理解该模式：

```
<?xml version="1.0"?>
<!DOCTYPE rdf:RDF [
<!ENTITY owl "http://www.w3.org/2002/07/owl#" >
<!ENTITY demo "http://www.example.org/demo.owl#" >
<!ENTITY xsd "http://www.w3.org/2001/XMLSchema#" >
<!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#" >
<!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#" >
]>
<rdf:RDF xmlns="http://www.example.org/demo.owl#"
 xml:base="http://www.example.org/demo.owl"
 xmlns:demo="http://www.example.org/demo.owl#"
 xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
 xmlns:owl="http://www.w3.org/2002/07/owl#"
 xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<owl:Ontology rdf:about="http://www.example.org/demo.owl"/>

<owl:AnnotationProperty rdf:about="&demo;mathml"/>

<owl:Class rdf:about="&demo;a">
    <mathml rdf:datatype="&xsd;string">&lt;ci&gt;a&lt;/ci&gt;</mathml>
</owl:Class>
</rdf:RDF> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T21:03:55.717

```
<apply> <csymbol cd="arith1">plus</csymbol>
<ci id='exampleontology#a'>a</ci>
<ci id='exampleontology#b'>b</ci>
</apply> 
```

`#`不是 XML ID 中的有效字符，我认为这里最自然的方法是将您的本体等同于 OpenMath 内容字典然后您可以去

```
<apply> <csymbol cd="arith1">plus</csymbol>
<csymbol cd='exampleontology'>a</csymbol>
<csymbol cd='exampleontology>b</csymbol>
</apply> 
```

csymbol 的内容作为内容字典中的符号名称。

您可以但不必使用 OpenMath 内容字典语法来描述系统，或者您可以直接将本体作为 OWL 进行管理。

例如，有一些旧文件开始了 rdf/owl 和 openmath 世界视图之间的一些映射

[http://www.openmath.org/ontology/README](http://www.openmath.org/ontology/README)

[http://www.openmath.org/lists/index.html](http://www.openmath.org/lists/index.html)上的 openmath 列表可能是与对 OpenMath/MathML 和 RDF/OWL 感兴趣的人联系的最佳场所

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-12T21:01:07.947

最简单的方法是为 MathML 文字定义新的数据类型。假设[http://www.w3c.org/datatypes/mathMLLiteral](http://www.w3c.org/datatypes/mathMLLiteral)。（理想情况下它应该由 W3C 定义）

在 Turtle 格式中，它看起来像这样：

```
@prefix math:<http://example.org/ont/math#>

:APlusB a math:Addition
   math:serialization """<apply> <csymbol cd="arith1">plus</csymbol>
                         <ci id='exampleontology#a'>a</ci>
        <ci id='exampleontology#b'>b</ci>

        </apply> """^^<http://www.w3c.org/datatypes/mathMLLiteral> . 
```

[GeoSPARQL](http://en.wikipedia.org/wiki/GeoSPARQL)标准中使用了类似的编码模式，其中几何以 WKT 或 GML 编码。Geosparql 为每个引入了两种不同的数据类型：[http](http://www.opengis.net/ont/geosparql#wktLiteral) ://www.opengis.net/ont/geosparql#wktLiteral和 < [http://www.opengis.net/ont/geosparql#gmlLiteral](http://www.opengis.net/ont/geosparql#gmlLiteral)

# mysql - 自动从相关表中检索数据

> ID：15235013
> 
> 赞同：0
> 
> 时间：2013-03-05T22:01:43.033
> 
> 标签：mysql

我正在使用一个数据库，该数据库包含一个名为的表，该表`model_meta`包含有关应用程序使用的所有各种模型的元数据。下面是相关的数据结构：

```
CREATE TABLE model_meta (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(64),
  oo INT(11),
  om INT(11),
  mo INT(11),
  mm INT(11),
  INDEX (name)
);

CREATE TABLE inventory (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  type VARCHAR(255),
  customers_id INT(11)
);

CREATE TABLE customers (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  name VARCHAR(255),
  contact VARCHAR(255)
); 
```

表中的`oo`、`om`、`mo`和列包含一个逗号分隔的 id 列表，该模型与其具有指定的关系（即一对一、一对多等）。`mm``model_meta`

当客户请求数据时，我得到的只是他们请求的表的名称（例如“库存”）——据此，我需要确定存在哪些关系并查询这些表以返回适当的结果集。

给定一个`$input`包含请求模型名称的变量（我们称之为它），以下是步骤：

1.  获取模型元数据：`SELECT model_meta.* FROM model_meta WHERE model_meta.name = $input;`

2.  确定关系列（oo、om、mo、mm）中的哪些（如果有）包含值 - 请记住，它们可以包含以逗号分隔的值列表。

3.  使用步骤 2 中的值来确定相关模型的名称 - 例如，假设它只`mo`包含一个值，我们将其称为`$mo`.

    所以：`SELECT model_meta.name FROM model_meta WHERE model_meta.id = $mo;`

    我们称之为结果`$related`。

4.  最后，从请求的表和与之相关的所有表中选择数据 - 请记住，我们可能正在处理一对一、一对多、多对一或多对-很多关系。对于这个具体的例子：

    在伪 SQL 中：`SELECT $input.*, $related.* FROM $input LEFT JOIN $related ON ($related.id = $input.$related_id);`

此方法使用三个单独的查询 - 第一个收集有关请求表的元数据，第二个收集相关表的名称，第三个查询这些表并返回实际数据。

**我的问题：**有没有一种优雅的方式来组合这些查询中的任何一个，将它们的数量从 3 个减少到 2 个 - 甚至减少到一个查询？

当然，真正的目标是以某种方式自动从相关表中检索数据（而客户端不必知道这些表是如何相关的）*。*这就是目标。

# ruby - 避免在 Jekyll Ruby 插件中重复调用 API

> ID：15235023
> 
> 赞同：1
> 
> 时间：2013-03-05T22:02:37.130
> 
> 标签：ruby, api, jekyll, garb-gem

我编写了一个 Jekyll 插件，通过使用 garb gem 调用 Google Analytics API 来显示页面上的浏览量。我的方法唯一的问题是它会为每个页面调用 API，从而减慢构建时间，并且可能会达到 API 的用户调用限制。

可以在一次调用中返回所有数据并将其存储在本地，然后查找每个页面的综合浏览量，但我的 Jekyll/Ruby-fu 并没有达到标准。我不知道如何编写插件运行一次以获取所有数据并将其存储在本地我当前的函数可以访问它的地方，而不是逐页调用 API。

基本上我的代码被写成一个液体块，可以放入我的页面布局中：

```
 class GoogleAnalytics < Liquid::Block
    def initialize(tag_name, markup, tokens)
      super # options that appear in block (between tag and endtag)
      @options = markup # optional optionss passed in by opening tag
    end
    def render(context)
      path = super
      # Read in credentials and authenticate 
      cred = YAML.load_file("/home/cboettig/.garb_auth.yaml")
      Garb::Session.api_key = cred[:api_key]
      token = Garb::Session.login(cred[:username], cred[:password])
      profile = Garb::Management::Profile.all.detect {|p| p.web_property_id == cred[:ua]}

      # place query, customize to modify results
      data = Exits.results(profile, 
                           :filters => {:page_path.eql => path}, 
                           :start_date => Chronic.parse("2011-01-01"))

      data.first.pageviews
    end 
```

[我的插件的完整版在这里](https://github.com/cboettig/labnotebook/blob/8c4c407d125ab1ba290cbe5a8db202b5f889f4aa/_plugins/jekyll-labnotebook-plugins/google_analytics.rb)

如何将所有对 API 的调用移动到其他函数并确保 jekyll 在开始时运行一次，然后调整上面的标签以读取该本地数据？

**编辑**看起来这可以通过生成器完成并将数据写入文件。请参阅[此分支](https://github.com/cboettig/labnotebook/blob/site-search/_plugins/jekyll-labnotebook-plugins/google_analytics.rb)上的示例现在我只需要弄清楚如何对结果进行子集化：[https ://github.com/Sija/garb/issues/22](https://github.com/Sija/garb/issues/22)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T18:13:09.553

要存储数据，我必须：

1.  编写一个生成器类（参见[Jekyll wiki 插件](https://github.com/mojombo/jekyll/wiki/Plugins)）来调用 API。

2.  将数据转换为散列（为了便于按路径查找，请参见 5）：

    ```
    result = Hash[data.collect{|row| [row.page_path, [row.exits, row.pageviews]]}] 
    ```

3.  将数据哈希写入 JSON 文件。

4.  从我现有的 Liquid 块类中的文件中读取数据。

    *请注意，块标签从`_includes`目录工作，而生成器从根目录工作。*

5.  匹配页面路径，将数据转换为哈希后很容易：

    ```
    result[path][1] 
    ```

[完整插件的代码，显示如何创建生成器和写入文件等，here](https://github.com/cboettig/labnotebook/blob/master/_plugins/jekyll-labnotebook-plugins/google_analytics.rb)

感谢GitHub 上的[Sija](https://github.com/Sija/garb/issues/22#issuecomment-14569475)提供的帮助。

# python - Python中函数声明的语法错误

> ID：15235024
> 
> 赞同：1
> 
> 时间：2013-03-05T22:02:38.807
> 
> 标签：python, function, raspberry-pi

我正在尝试用 Python 编写一个简单的网络服务器，不幸的是，我遇到了让函数工作的简单障碍！

```
import os, socket

class serv:
    def __init__(self):
        self.host
        self.port = 'localhost', 58008
        self.socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        self.socket.bind((self.host, self.port)

    def send(self, msg):
        self.conn.send(msg + end)

    def run(self):
        self.socket.listen(1)
        self.conn
        self.addr = self.socket.accept()
        send(self, msg="Hello, world")

S = serv()
S.run() 
```

此代码在函数调用 send 上给出以下错误：

```
File "server.py", line 10
def send(self, msg):
  ^
SyntaxError: invalid syntax 
```

如果它有帮助（我相信它不会），我正在使用 Adafruit WebIDE 在 Raspberry Pi 上执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T22:03:25.420

您之前忘记了该行中的右括号。

但是，一旦解析阶段幸存下来，您还会遇到其他错误。例如，您正在引用未定义的名称（这会给您`NameError`s）：`self.host`或`self.conn`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T03:16:47.163

所有关于右括号。下一行还不够：

```
self.socket.bind((self.host, self.port) 
```

# javascript - 如何加载角度模块

> ID：15235026
> 
> 赞同：1
> 
> 时间：2013-03-05T22:02:43.000 标记“现在”
> 
> 标签：javascript, angularjs

我刚刚开始使用 Angular 和 javascript，我真的不知道如何构建我的应用程序。

我开始编写一个控制器，我的第一个反应是将我称之为模型的东西放入不同文件的类中。我有不同的选择

1 - 将所有内容（模型 + 控制器）放在一个文件中

2 - 使用 requireJS 所以我的控制器可以“包含”我的模型。我已经设法做到了，说它不是直截了当的，我仍然无法使 yeoman dist 版本正常工作。

3 - 使用角度模块，这似乎是推荐的方式，但如果选择此解决方案，我需要在主 html 文件中明确加载我的模型文件。我知道不对文件之间的依赖关系进行硬编码可能是一件好事，因此您可以例如交换或更改某些组件，但是当例如子类需要其父类时，这似乎是错误的。如果我需要将一个模块拆分为许多角度子模块，我是否需要明确加载它们？这似乎是完全错误的。

我错过了什么吗？这样做的标准方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T08:31:32.663

我发现非常有用的是 MTV 聚会。他们很好地概述了如何在 AngularJS 中应用最佳实践：

*   **最佳实践**：[http ://www.youtube.com/watch?v=ZhfUv0spHCY](http://www.youtube.com/watch?v=ZhfUv0spHCY)
*   **角+约曼**：[http ://www.youtube.com/watch?v=XOmwZopzcTA](http://www.youtube.com/watch?v=XOmwZopzcTA)

youtube 上还有很多视频。我希望这有助于给出第一个想法。

# magento - 如何从 Magento 中的 SKU 获取产品的 Url

> ID：15235029
> 
> 赞同：6
> 
> 时间：2013-03-05T22:03:03.067
> 
> 标签：magento

问题很简单。如果我知道我的产品的 sku 而没有别的，我怎样才能检索到该项目的 url。这对于远程服务的唯一 ID 与产品 ID 不匹配的第三方集成通常很有用。或者，也许您想创建一个搜索框以仅按 sku 搜索。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T17:16:45.403

你可以这样做：

```
$sku = 'ecco'; // SKU you want to load. 'ecco' is a sku in the Magento demo data

$url =  Mage::getModel('catalog/product')->loadByAttribute('sku',$sku)->getProductUrl();
echo $url; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-03-10T13:48:11.630

另外....您可以将其添加到magento根目录中名为“geturlbysku.php”的文件中。此代码可以轻松提取代表产品的少量 json，从而实现小型 javascript 集成。产品 URL 是数据集的一部分

```
<?php

require_once '/app/Mage.php';
umask(0);
Mage::app('admin');

$actual_link = "http://$_SERVER[HTTP_HOST]";

$sku = $_GET['sku'];
$product =  Mage::getModel('catalog/product')->loadByAttribute('sku',$sku);
$fullUrl = "/catalog/product/view/id/" . $product->getId();

header("Content-Type: application/json");

    echo $_GET['callback'] . '('.json_encode($product->getData()).')';
?> 
```

像这样使用... www.yoursite.com/geturlbysku.php?sku=theskuoftheproduct

返回的部分数据包括“url_path”：“your-product-name.html”，它对应于真实的url。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-06T04:53:35.820

您可以使用加载方法。这比所有其他解决方案更快、更容易。

```
Mage::getModel('catalog/product')->load('sku', 'sku'); 
```

有关加载产品的更多信息，请[单击此处](http://fishpig.co.uk/blog/load-a-category-or-product-by-an-attribute.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:03:03.067

```
$product = Mage::helper('catalog/product')->getProduct($this->getData('sku'), Mage::app()->getStore()->getId(), 'sku');

$url = Mage::getUrl($product->getUrlPath()); 
```

您可以根据产品的 sku 访问产品的完整 url，方法是将此添加到方法中，然后将类上的 sku 属性设置为您希望搜索的 sku。

# node.js - 无法运行简单的 HelloWorld node.js 脚本

> ID：15235039
> 
> 赞同：2
> 
> 时间：2013-03-05T22:03:29.677
> 
> 标签：node.js, ubuntu-12.04

我刚刚在我的 ubuntu 笔记本电脑上安装了 node.js。

我按照此处的说明进行操作：http: [//davidtsadler.com/archives/2012/05/06/installing-node-js-on-ubuntu/#application](http://davidtsadler.com/archives/2012/05/06/installing-node-js-on-ubuntu/#application)并从 git 存储库安装

安装没有错误，但是当我运行 server.js 示例应用程序时，什么也没发生。

更糟糕的是，我尝试运行一个名为 hello.js 的非常基本的 hello world 脚本

```
console.log("hello world"); 
```

当我输入： node hello.js

没有任何反应，没有错误消息，没有任何内容写入控制台窗口。

ubuntu 上的节点是否有任何已知问题？

谢谢

**编辑**

如果我输入，就会在终端中注意到：

```
node console.log("hello world"); 
```

我明白了

> > $ 节点控制台.log("hi");

bash：意外标记'（'附近的语法错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-01-21T01:12:43.773

要么像这样运行你的文件

`node <your_file>.js`

或将其添加到顶部 `#!/usr/bin/env node`

# .net - JsonConvert.SerializeObject 与 JsonSerializer.Serialize

> ID：15235042
> 
> 赞同：7
> 
> 时间：2013-03-05T22:03:36.907
> 
> 标签：.net, json.net

好吧，我不明白为什么`JsonConvert.SerializeObject`序列化`DateTime`对象与 JsonSerializer.Serialize 不同。

给定班级

```
public class Test
{
     [JsonConverter(typeof(JavaScriptDateTimeConverter))]
     public DateTime DeliveryDate { get { return DateTime.Now; } }
} 
```

`@Html.Raw(JsonConvert.SerializeObject(new Test()))`

输出：

```
"DeliveryDate": "2013-03-01T07:00:00.000Z" 
```

但是当我在 JsonNetResult 中使用 JsonSerializer.Serialize 时：http: [//james.newtonking.com/archive/2008/10/16/asp-net-mvc-and-json-net.aspx](http://james.newtonking.com/archive/2008/10/16/asp-net-mvc-and-json-net.aspx)

我得到以下输出：

```
"DeliveryDate": new Date(1362520794703) 
```

我无法弄清楚为什么会出现这种不一致。我原以为`JsonConvert.SerializeObject`会在`JsonSerializer`内部使用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T23:07:51.467

好吧，我已经想通了，我想分享一下，以防有人遇到这种情况。

所以很久以前我在 MVC4 中序列化`DateTime`对象时遇到了麻烦。`JsonResult`基本上我的`DateTime`对象被序列化为`"\/Date(1239018869048)\/"`我想我读到了作者对 JSON.NET 的回答，关于 SO 建议添加 `[JsonConverter(typeof(JavaScriptDateTimeConverter))]`到`DateTime`模型类的属性并`@Html.Raw(JsonConvert.SerializeObject(Model)`在视图中使用。果然我做到了，这解决了我**当时的短期问题**

时间过去了，今天我需要支持在用户向服务器发布一些内容后即时更新 javascript viewModel。这引起了我今天的错误。事实证明，我的所有`DateTime`属性都用该属性装饰，当我尝试将它们序列化回客户端时，序列化程序的行为与预期的一样。这让我相信`JsonConvert.SerializeObject`实际上是**不**尊重属性。

在我删除了有问题的属性后，一切都开始运转良好。调整周围的东西，我发现我可以使用默认值`DateTimeZoneHandling = DateTimeZoneHandling.RoundtripKind`，我可以忘记`Z`我的日期时间字符串。

# java - Android开发班组织

> ID：15235045
> 
> 赞同：0
> 
> 时间：2013-03-05T22:03:49.207
> 
> 标签：java, android, subclass

我正在开发我的第一个 Android 应用程序。我想组织我的 java 源代码。

```
public class MainActivity extends Activity {

    protected void onCreate(Bundle savedInstanceState) {

    }

    //more functions here

} 
```

我希望能够在同一个包中创建子类来组织我的代码。我只是想知道我是否可以扩展`MainActivity`并仍然在我的主要活动中引用它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:04:53.077

是的，您*可以*扩展`MainActivity`，但这通常是个坏主意——尤其是如果您是初学者。您创建的所有活动都应直接从`Activity`.

也许**静态变量**和**意图传递**是您在活动之间交换信息的选项。

# php - php 有人可以告诉我我做错了什么吗

> ID：15235050
> 
> 赞同：-3
> 
> 时间：2013-03-05T22:04:07.037
> 
> 标签：php, json, phpmyadmin

我遇到的问题是，当我从数据库中获取信息时，我只得到两个 raws 而不是 4 。有人可以帮我吗，因为我找不到任何问题

这是代码

```
$sql = mysql_query("SELECT INCIDENT_ID FROM appreports WHERE POSTCODE = 'CF14' ");

while($row=mysql_fetch_assoc($sql))
{
    $output[] = $row;
}

print(json_encode($output));

mysql_close(); 
```

**这是数据库中 appreports 表的屏幕截图** ![在此处输入图像描述](../Images/1e9d4d09d5c5c6a64f54d1c2ac020bb5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:07:24.907

您正在使用“INNER”连接连接*两个数据库表。*如果连接表中没有对应`POSTCODE`的，则不会返回该行。

`appregistrations`要使用指定的手机号码返回所有内容，**可以选择**使用`appreport`，使用此；

```
SELECT * FROM appregistration
LEFT JOIN
    `appreports`
     ON `appreports`.`POSTCODE` = `appregistration`.`POSTCODE`

WHERE `appregistration`.`MOBILE_NUMBER` = '$mobile' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:17:38.743

您正在内部加入 POSTCODE，并且从该集合中您正在过滤给定的 MOBILE_NUMBER。您在这里有 4 个相同的 POSTCODES，所以我猜问题是 MOBILE_NUMBER。删除 WHERE 子句，您可能会回到 4 行。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-05T22:20:39.593

如果您想在 appreports 表中返回所有手机号码为 $mobile 的行，请使用以下命令：

```
SELECT `INCIDENT_ID`, `INVESTIGATION`, `TYPE_OF_INCIDENT`, `DESCRIPTION`
FROM `appreports`                    
WHERE `appregistration`.`MOBILE_NUMBER` = '$mobile'" 
```

如果您想在 appreports 表中返回所有手机号码为 $mobile 的行，并且如果存在 appregistration 表中的信息，请使用以下命令：

```
 SELECT `INCIDENT_ID`, `INVESTIGATION`, `TYPE_OF_INCIDENT`, `DESCRIPTION`
   FROM `appreports`
   FULL OUTER JOIN `appregistration` 
   ON `appreports`.`POSTCODE` = `appregistration`.`POSTCODE`
   WHERE `appregistration`.`MOBILE_NUMBER` = '$mobile'") 
```

# ruby - rspec 上下文块未按正确顺序执行

> ID：15235051
> 
> 赞同：2
> 
> 时间：2013-03-05T22:04:07.583
> 
> 标签：ruby, rspec

使用 rspec 和 selenium webdriver for chrome，我编写了具有以下格式的代码：

```
describe x do
  [some code]
  context y do
    [some code]
    it a do
      [more code]
    end
  end
  context z do
    [some other code]
    it b do
      [even more code]
    end
  end
end 
```

从直觉上看，程序流程应该直接沿着程序运行，进入上下文 y，然后执行“it a do”语句。但是，在它完成上下文 y 中的 [some code] 后，它会立即跳到上下文 z 而不会碰到 it 块。

是否需要包含命令行参数或其他一些代码才能使程序流在代码中线性工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:13:56.797

Rspec 随机化测试的顺序。

每个测试都应该正常工作，并且与其他测试相比，不应依赖于其顺序。

但是，如果您使用该`--order default`选项运行 rspec，则可以绕过此行为

# c - 是否有任何编译器/预处理器技巧来调试打印枚举的名称？

> ID：15235052
> 
> 赞同：16
> 
> 时间：2013-03-05T22:04:09.083
> 
> 标签：c, debugging, clang

我经常发现自己在编写帮助调试器方法，这些方法返回一个可打印的字符串，给定一些枚举值。原因是当你通常记录一个枚举时，你得到的只是一个数字。我讨厌不得不回到我的源头来弄清楚那个枚举是什么。所以我会做类似的事情

```
typedef enum
{
   kOne = 1,
   kTwo,
   kThree,
}
MyEnum;

NSString *debugStringForEnum(MyEnum e)
{
    switch ( e )
        case kOne:
            return @"One";
        case kTwo:
            return @"Two";
        ....
}

....
NSLog(@"My debug log: %@", debugStringForEnum(someVariable)); 
```

所以我的问题是，有没有办法避免编写所有这些帮助代码，只是为了查看枚举的标签值？

谢谢

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-05T22:19:01.693

如果您愿意编写让其他开发人员哭泣的“顽皮”代码，那么可以。试试这个：

```
#define ENUM(name, ...) typedef enum { M_FOR_EACH(ENUM_IDENTITY, __VA_ARGS__) } name; \
char * name ## _DEBUGSTRINGS [] = { M_FOR_EACH(ENUM_STRINGIZE, __VA_ARGS__) };

#define ENUM_IDENTITY(A) A,
#define ENUM_STRINGIZE(A) #A,

ENUM(MyEnum,
        foo, bar, baz, boo
        ) 
```

您显然需要一个 for-each 宏来完成这项工作。这是一个简单的：

```
#define M_NARGS(...) M_NARGS_(__VA_ARGS__, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0)
#define M_NARGS_(_10, _9, _8, _7, _6, _5, _4, _3, _2, _1, N, ...) N

#define M_CONC(A, B) M_CONC_(A, B)
#define M_CONC_(A, B) A##B

#define M_FOR_EACH(ACTN, ...) M_CONC(M_FOR_EACH_, M_NARGS(__VA_ARGS__)) (ACTN, __VA_ARGS__)

#define M_FOR_EACH_0(ACTN, E) E
#define M_FOR_EACH_1(ACTN, E) ACTN(E)
#define M_FOR_EACH_2(ACTN, E, ...) ACTN(E) M_FOR_EACH_1(ACTN, __VA_ARGS__)
#define M_FOR_EACH_3(ACTN, E, ...) ACTN(E) M_FOR_EACH_2(ACTN, __VA_ARGS__)
#define M_FOR_EACH_4(ACTN, E, ...) ACTN(E) M_FOR_EACH_3(ACTN, __VA_ARGS__)
#define M_FOR_EACH_5(ACTN, E, ...) ACTN(E) M_FOR_EACH_4(ACTN, __VA_ARGS__)
#define M_FOR_EACH_6(ACTN, E, ...) ACTN(E) M_FOR_EACH_5(ACTN, __VA_ARGS__)
#define M_FOR_EACH_7(ACTN, E, ...) ACTN(E) M_FOR_EACH_6(ACTN, __VA_ARGS__)
#define M_FOR_EACH_8(ACTN, E, ...) ACTN(E) M_FOR_EACH_7(ACTN, __VA_ARGS__)
#define M_FOR_EACH_9(ACTN, E, ...) ACTN(E) M_FOR_EACH_8(ACTN, __VA_ARGS__)
#define M_FOR_EACH_10(ACTN, E, ...) ACTN(E) M_FOR_EACH_9(ACTN, __VA_ARGS__) 
```

应该很明显如何扩展该循环以具有更长的上限，但是......这个答案的空间考虑。只要您愿意将额外的迭代复制并粘贴到该位中，该循环就可能存在。

对于非调试版本，让#ifdef 选择不带第二行的 ENUM 版本。

* * *

**编辑：**为了从 teppic 窃取指定的初始化器想法，这里有一个更可怕的版本，它也适用于无序初始化器值：

```
#define ENUM(name, ...) typedef enum { M_FOR_EACH(ENUM_ENAME, __VA_ARGS__) } name; \
char * name ## _DEBUGSTRINGS [] = { M_FOR_EACH(ENUM_ELEM, __VA_ARGS__) };

#define ENUM_ENAME(A) M_IF(M_2ITEMS(M_ID A), (M_FIRST A = M_SECOND A), (A)),
#define ENUM_ELEM(A) M_IF(M_2ITEMS(M_ID A), ([M_FIRST A] = M_STR(M_FIRST A)), ([A] = M_STR(A))),

#define M_STR(A) M_STR_(A)
#define M_STR_(A) #A
#define M_IF(P, T, E) M_CONC(M_IF_, P)(T, E)
#define M_IF_0(T, E) M_ID E
#define M_IF_1(T, E) M_ID T
#define M_2ITEMS(...) M_2I_(__VA_ARGS__, 1, 0)
#define M_2I_(_2, _1, N, ...) N
#define M_FIRST(A, ...) A
#define M_SECOND(A, B, ...) B
#define M_ID(...) __VA_ARGS__

ENUM(MyEnum,
        foo, bar, baz, boo
        )

ENUM(NotherEnum,
        A, B, (C, 12), D, (E, 8)
        ) 
```

如果您在其他人必须维护的代码中使用这种东西，我无法保证您的人身安全。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-05T22:16:51.140

一种更简单的方法是设置一个字符串字面量数组，根据标签在数组中的位置复制标签，例如

```
char *enumlabels[] = { NULL, "KOne", "KTwo", "KThree"}; 
```

在这里，您需要填补空白以使枚举值与数组位置匹配。

或者，更好的是，对于具有指定初始化程序的 C99：

```
char *enumlabels[] = { [1] = "KOne", [2] = "KTwo", [3] = "KThree"}; 
```

在这种情况下，只要枚举声明在前，您可以直接将数组下标交换为枚举值，以使其更清晰，例如`{ [kOne] = "kOne", ... }`.

那么`MyEnum e`你可以只使用`printf("%s\n", enumlabels[e]);`或类似的东西。

我写了一些代码来更好地证明这一点：

```
typedef enum {
   white = 1,
   red   = 2,
   green = 4,
   blue  = 8,
   black = 16
} Colour;   // be sure to update array below!

char *enum_colours[] = { [white] = "white", [red] = "red", [green] = "green",
                         [blue] = "blue", [black] = "black" };

Colour c = blue;
printf("The label for %d is %s\n", c, enum_colours[c]); 
```

`Output: The label for 8 is blue`

如果您有巨大的枚举常量（例如 32767），这显然不是一个理想的解决方案，因为所需的数组大小。如果没有指定的初始化程序，您可以直接分配数组值，如果更费力的话，使用`enum_colours[white] = "white";`等等，但只能在函数中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-06T00:39:42.520

您无法在运行时获取枚举名称，因为那时这些符号早已不复存在，但您可以使用多字符常量为您的枚举创建更有意义的值。

```
#import <Foundation/Foundation.h>

NSString* debugString(int en) {
    return [NSString stringWithFormat:@"%c%c%c%c",
            (en>>24) & 0xff,
            (en>>16) & 0xff,
            (en>>8) & 0xff,
            en & 0xff];
}

typedef enum {
    kOne = 'One.',
    kTwo = 'Two.',
    kThree = 'Thre',
} MyEnum;

int main(int argc, const char * argv[])
{
    @autoreleasepool {
        NSLog(@"kOne = %@", debugString(kOne));
        NSLog(@"kTwo = %@", debugString(kTwo));
        NSLog(@"kThree = %@", debugString(kThree));
    }
    return 0;
} 
```

将打印

```
kOne = 一。
kTwo = 二。
k三 = 三

```

在控制台上。

为了`debugString`避免产生垃圾，每个枚举必须恰好是四个字符长（无论如何在 OSX 上）。这非常依赖于编译器和平台。这对调试很有用，但除此之外就没什么了。

当然，如果您需要枚举具有特定值或相互关联的值，这将不起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:28:34.540

名称本身不可用，但通常给它们一个明确的数字就足够了：

```
enum{
   dog = 100,
   cat = 200,
   problem = dog+cat, //trailing comma legal in C and C++11
}; 
```

# database - 如何使用 DBI 在 Perl 中解析 FASTA 文件并将序列提交到 SQLite db 文件？

> ID：15235055
> 
> 赞同：0
> 
> 时间：2013-03-05T22:04:18.553
> 
> 标签：database, perl, sqlite, dbi

我有一个 FASTA 文件如下

```
>header1
AAAAA
AAA
>header2
BBBBB 
```

我已经能够使用 DBI 通过 perl 创建一个 SQLite 表。

```
#!/usr/bin/perl
use strict;
use warnings;
use DBI;

my $dbh = DBI->connect( "DBI:SQLite:dbname=gene.db" , "" , "" ,
                    { PrintError => 0 , RaiseError => 1 } );
$dbh->do("DROP TABLE IF EXISTS genes");
$dbh->do("CREATE TABLE genes(gene_name VARCHAR(50) PRIMARY KEY, sequence TEXT)");

parse();
sub parse{
my $fasta_file = 'example.faa';
my $header='';
my $sequence='';

open(INPUT, $test_file) || die "ERROR: can't read input file: $!";
    while(<INPUT>){
        if(/^>(.+?)/){
           $header=$1;
          #$dbh->do("INSERT INTO genes VALUES('$header','$sequence')");
           $sequence='';
        }else{
           $sequence.=$_;
        }
     }
}
$dbh->disconnect(); 
```

现在我知道`$dbh->do("INSERT INTO genes VALUES('$header','$sequence')");`会将标题和序列插入数据库，但我遇到了第一个条目的问题，特别是如果第一个条目具有多行序列。第一个条目的顺序似乎被移到了第二个。我试图将`$dbh->do`语句移到 else 中，但我可能会出错。想法？

```
sqlite> select * from Genes;
header      sequence
----------  ----------  
header1      
header2     AAAAAAAA 
```

如果我将`do()`语句放在`else`子句中，我会收到以下错误。

```
DBD::SQLite::db do failed: column header is not unique 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:12:48.197

第一个条目对 $sequence 没有任何价值，所以我会以这种方式重构您的代码：

```
if(/^>(.+?)/) {
   $header=$1;

} else{
   $sequence = $_;
   $dbh->do("INSERT INTO genes VALUES(?, ?)", undef, $header, $sequence );  
} 
```

注意 $dbh->do 语法，这种模式避免了 sql 注入问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T00:56:22.430

我认为您在 while 循环中的语句顺序不正确。并且您需要添加 a`chomp`来删除新行（除非您打算保留它们）。

```
open(INPUT, $test_file) || die "ERROR: can't read input file: $!";
    while(<INPUT>){
        chomp;
        if(/^>(.+)/){
            $dbh->do("INSERT INTO genes VALUES('$header','$sequence')") if $sequence;
            $header=$1;
            $sequence='';
        }else{
           $sequence.=$_;
        }
     }
     $dbh->do("INSERT INTO genes VALUES('$header','$sequence')") if $sequence;

         } 
```

**更新：**在 while 循环之后添加了 last $dbh->do 以获取最后一条记录。

# c - 旋转编码器防溢出

> ID：15235060
> 
> 赞同：3
> 
> 时间：2013-03-05T22:04:38.567
> 
> 标签：c, assembly, embedded, microcontroller, avr

我正在为 AVR Atmega328p 微控制器编写代码。微控制器应该读取编码器并根据编码器的旋转增加或减少 r23。不幸的是，此时，无论我转动编码器的方向如何，输出只会减少直到达到 0，然后从 255 开始。

我的代码相当简单，并且基于结合了编码器先前状态和当前状态的表查找值。如果前一个状态和当前状态没有结合起来创建一个有效的回合，则会返回一个错误并且代码什么也不做。如果发生有效的状态更改，则通过 r24 将 1 或 -1 添加到 r23。

我让微控制器读取编码器没有问题，但我不知道如何防止 r23 溢出。我的问题是当我达到 255 并加 1 时，寄存器溢出并变为 0。我不希望寄存器变为 0；我希望它保持在 255，直到我沿相反方向旋转编码器。我对 0 也有同样的问题。如果寄存器为 0 并且我添加 -1，我不希望寄存器转到 255，我希望它保持在 0 直到我沿相反方向旋转它。

我对跳出框框思考没有问题。如果您有解决方案或想法，请随时发布。

```
;**** A P P L I C A T I O N   N O T E  *************************************
;*
;* Title:       
;* Version:     
;* Last updated:    
;* Target:  AVR Dragon  
;*
;*
;* DESCRIPTION
;*
;*.device   ATmega328P @ 1M  clock speed
;* 
;* This is a simple program to test an optical encoder
;***************************************************************************

.include "m328Pdef.inc"
.org 0x0000
    jmp RESET   ;Reset Handle

.org 0x0008
    jmp Interrupt1 ; PCINT1 Handler

enc_states:
.db 0,-1,1,0,1,0,0,-1,-1,0,0,1,0,1,-1,0 

RESET:

;Setup stack pointer
    ldi temp, low(RAMEND)   
    out SPL, temp
    ldi temp, high(RAMEND)
    out SPH, temp

//Set Port B pins to output
    ser     temp            ; Set Register Rd <-- 0xff (output)
    out     DDRB,temp       ; set all PORTB bits as output

//Clear analog input pins and enable pull ups on Pin 0 and 1 (Port C)
    clr     temp
    out     DDRC, temp      ;all pins input
    ldi     temp, (1<<PC1)|(1<<PC0)
    out     PORTC,temp      ;Enable pullups on Pin 0 and 1

//Set Port D pins to output
    ser     temp            ; Set Register Rd <-- 0xff
    out     DDRD,temp       ; set all PORTD bits as output

//Enable encoder pins interrupt sources (Encoder 1)
    ldi     temp, (1<<PCINT9)|(1<<PCINT8)
    sts     PCMSK1, temp

//Enable encoder pins interrupt sources (Encoder 2)
//  ldi     temp, (1<<PCINT11)|(1<<PCINT10)
//  sts     PCMSK1, temp

//Enable pin change interrupts
    ldi     temp, (1<<PCIE1)
    sts     PCICR, temp

//Enable global interrupts
    sei

//Lookup table initial value
    ldi     ZL, 0x00   ;lookup table index and initial state

.def temp   = r16
    clr     r25
    clr     r24
    clr     r23

loop:
    out PORTB, r23
    jmp loop

Interrupt1:
// Push SREG, etc
    in      r25, PORTC  ;encoder value from PORTC

    ldi   ZH, High(enc_states*2)   ; setup Z pointer hi
    ldi   ZL, Low (enc_states*2)   ; setup Z pointer lo
    rol     r22     ;remember previous state and shift left twice
    rol     r22
    cbr     r25, 0xFC  ;clear encoder bits 7:2
    mov     r21,r25
    or      r25, r22   ;combine encoder bits with old bits
    cbr     r25, 0xF0  ;clear bits 7:4 for table lookup
    mov     r22, r25   ;save table lookup value
    mov     ZL, r25    ;load index value into table
    lpm     r24, z      ;get result
    add     r23,r24

// Pop SREG, etc.
    reti 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T13:24:55.640

通过利用进位标志可以非常简单地完成“饱和”，例如：

```
 mov __tmp_reg__, r23
  add __tmp_reg__, r24   ; do the addition

  brcs saturated          ; if the carry flag is set we have an overflow and should discard the result

    mov r23, __tmp_reg__ ; there was no overflow so we store the result

  saturated: 
```

用上面的代码替换`add r23,r24`ISR 末尾的 ，你应该没问题。（显然，您可能需要更改`__tmp_reg__`一些可以用作临时存储的寄存器。）

考虑到`r24`可能是正数、负数或零，所有情况都可以通过稍微扩展上述原则来正确处理：

```
 mov __tmp_reg__, r23

  tst r24 

  breq doreturn  ; if r24 == 0 we have nothing to do and may just return

  brmi subtract  ; if r24 is 'negative' we need to subtract

    add __tmp_reg__, r24  ; if r24 is not negative we just add
    rjmp store            ; and go to where the result may be stored

  subtract:

    neg r24  ; r24 := -r24
    sub __tmp_reg__, r24   ; do the subtraction

  store:

  brcs doreturn          ; if the carry flag is set we have an overflow and should discard the result

    mov r23, __tmp_reg__ ; there was no overflow so we store the result

  doreturn: 
```

仔细查看您的代码，在我看来，当 Z 指针的计算完成时，其中还有另一个“故障”：

```
ldi   ZH, High(enc_states*2)   ; setup Z pointer hi
ldi   ZL, Low (enc_states*2)   ; setup Z pointer lo 
```

和

```
mov     ZL, r25    ;load index value into table 
```

看起来有问题：Z地址的下部只是被忽略并被索引值覆盖。`Low (enc_states*2)`如果碰巧没有，这将造成麻烦`0`；您可能需要做`add ZL, r25`and `adc ZH, __zero_reg__`（16 位加法）而不是`mov ZL, r25`.

另一个可能会降低您日常工作复杂性的想法：

增量旋转编码器的输出可以解释为某种同步串行数据：一个输出（比如“A”）代表“时钟”信号，而另一个输出（“B”）代表“数据”信号。

您可以自由选择哪个输出用于哪个信号，以及您选择的“时钟”极性。那么算法就相当简单了：

1.  （去抖动和）检测“时钟”信号上的上升（或下降，您可以选择）*转换*
2.  一旦检测到“时钟”边沿，只需读取“数据”信号的电平 - 这里不需要去抖动
3.  然后读取的单个“数据”位直接指示编码器刚刚进入的方向：“0”或“1”，一个方向或另一个方向。

在伪代码中，这可能看起来像：

```
bit lastClockState;

void readEncoder() {

    bit currentClockState = readClockPin();

    if ( lastClockState == 1 && currentClockState == 0 ) {
        // A (falling) edge was detected...

        // Get the direction of the rotation:
        bit direction = readDataPin();

        if ( direction == 1 ) {
            value++;
        } else {
            value--;
        }
    }

    lastClockState = currentClockState; // Update the lastClockState for the next iteration

} 
```

例如，让它每 10 毫秒执行一次，您已经“免费”拥有了一些简约的去弹跳。

（顺便说一句，总结许多其他人之前吸取的教训：不要尝试使用一些外部/引脚更改中断来检测由任何机械开关或机械编码器产生的（非去抖动）信号转换。机械元件的弹跳特性将确保这*永远不会*按预期工作。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:26:58.543

您只需要为边界情况添加一些测试。多年来我没有进行任何组装，这段代码可能与您的架构无关，但它类似于：

```
 lpm     r24, z      ;get result
    cmp     r23, 0
    je      rot_lo      ; if val is 0
    cmp     r23, 255
    je      rot_hi      ; if val is 255
    jmp     rot_add

rot_lo:
    cmp     r24, 0
    jl      rot_ret     ; don't add if delta less than 0
    jmp     rot_add

rot_hi:
    cmp     r24, 0
    jg      rot_ret     ; don't add if delta greater than 0
    jmp     rot_add     ; (or just fall through here)

rot_add:
    add     r23, r24

rot_ret:
    reti 
```

# ssrs-2008 - SSRS 获取每一页的最后一行

> ID：15235062
> 
> 赞同：0
> 
> 时间：2013-03-05T22:04:48.583
> 
> 标签：ssrs-2008, reporting-services, ssrs-grouping

在 SQL Server Reporting Services 中，我有一个带有虚线底部边框的行组分隔每一行。我想从每页的最后一行删除那个虚线边框。如何计算每页的最后一行？

我在第一页上数了 25 行，所以我尝试了这个：

```
iif((rownumber(nothing) MOD 25)=0,nothing,"Dotted") 
```

但是在第 2 页上，某些行在一列中有太多文本，最终页面只有 24 行，因此行号会根据文本量而变化。我需要一种新方法。有没有人遇到过这种问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:17:11.867

你为什么不只是呈现一个行分组，然后确定它的属性？选择详细信息行，然后选择“行组”并选择“添加组”>“父组”。定义获取总数的逻辑，如果需要在底部添加页脚。选择“分页符”，然后报告将在新页面分组时中断。解决页脚的属性。

# algorithm - 如何迭代 k-ary 树？

> ID：15235066
> 
> 赞同：2
> 
> 时间：2013-03-05T22:05:12.487
> 
> 标签：algorithm, tree, iteration

假设你有一个[像这个](http://vivin.net/2010/01/30/generic-n-ary-tree-in-java/)或[这个这样的通用 k-ary 树](https://stackoverflow.com/questions/205945/why-does-the-c-stl-not-provide-any-tree-containers/15230597#15230597)

在这里重复后者：

```
template <typename T>
struct TreeNode
{
  T* DATA ; // data of type T to be stored at this TreeNode

  vector< TreeNode<T>* > children ;

  void insert( T* newData ) ;

  // runs f on this and all children of this
  void preorder( function<void (T*)> f )
  {
    f( this->DATA ) ; // exec f on this
    for( int i = 0 ; i < children.size(); i++ )
      children[i]->preorder( f ) ; // exec f on each child
  }

} ;

template <typename T>
struct Tree
{
  TreeNode<T>* root;

  // TREE LEVEL functions
  void clear() { delete root ; root=0; }

  void insert( T* data ) { if(root)root->insert(data); } 
} ; 
```

现在通常，您将前序和后序遍历作为递归成员函数，`TreeNode`如上所示。 **但是假设您不想传递函数**，您想*从类外部*访问树中的每个节点（即只给定一个`Tree`对象）。

你怎么能这样做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:08:20.920

我将通过定义一个`PreorderIterator`维护它在遍历中的状态的类来解决这个问题。它将具有返回当前节点和在遍历中前进一步的方法。

如果树结构可能在迭代器的生命周期内发生变异，您将必须小心。也许这棵树可以保持一个修改计数；迭代器可以在开始时捕获计数并检查每次访问时的更改（如果找到则抛出异常）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T00:29:48.433

一种简单的方法是将树加载到列表中，然后在需要时遍历列表。该列表将只是一个指针列表，因此不会那么昂贵。为此，您将使用[trie 遍历算法](http://www.geekviewpoint.com/java/trie/word_list)的修改版本：

```
void traverse(Node n){
  if(null == n) return;

  for( Node c: n.children){
    visit( c );
    traverse( c );
  }
} 
```

您将使用`visit`来实际加载您的列表。所以像

```
List<Node> getListToIterate(Node n){
   List<Node> result = new ArrayList<Node>();
   traverse(n,resutl);
   return result;
}

void traverse(Node n, List list){
  if(null == n) return;

  for( Node c: n.children){
    list.add( c );
    traverse( c );
  }

} 
```

此外，如果您决定，您可以将此算法包装在一个`TreeIterator`类中，该类将跟踪您在列表中的位置。

# python - 使用单个 Zip 的路径压缩多个子目录

> ID：15235068
> 
> 赞同：0
> 
> 时间：2013-03-05T22:05:24.450
> 
> 标签：python, zip, winzip

我需要帮助编辑以下压缩目录内容的脚本。我的最终目标是创建一个脚本，该脚本将查看 C:\Test（其中将有多个目录）并使用 C:\Test 中每个目录的内容创建一个新的 zip 文件。棘手的部分是我需要路径是 C:\ 即使目录的真实路径是 C:\Test。这是可能的还是我在做梦？

谢谢

```
import zipfile, os

def makeArchive(fileList, archive):

    try:
        a = zipfile.ZipFile(archive, 'w', zipfile.ZIP_DEFLATED)
        for f in fileList:
            print "archiving file %s" % (f)
            a.write(f)
        a.close()
        return True
    except: return False

def dirEntries(dir_name, subdir, *args):

    fileList = []
    for file in os.listdir(dir_name):
        dirfile = os.path.join(dir_name, file)
        if os.path.isfile(dirfile):
            if not args:
                fileList.append(dirfile)
            else:
                if os.path.splitext(dirfile)[1][1:] in args:
                    fileList.append(dirfile)
        # recursively access file names in subdirectories
        elif os.path.isdir(dirfile) and subdir:
            print "Accessing directory:", dirfile
            fileList.extend(dirEntries(dirfile, subdir, *args))
    return fileList

if __name__ == '__main__':
    folder = r'C:\test'
    zipname = r'C:\test\test.zip'
    makeArchive(dirEntries(folder, True), zipname) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:24:36.760

您可以更改存档中文件的路径，如下所示：

```
a.write(PATH_ON_FILESYSTEM, 
        DESIRED_PATH_IN_ARCHIVE
) 
```

# ruby - 为什么括号会影响哈希？

> ID：15235070
> 
> 赞同：8
> 
> 时间：2013-03-05T22:05:34.917
> 
> 标签：ruby, hash, syntax

当我使用`respond_with`并传递一个文字哈希时，它给了我错误：

```
syntax error, unexpected tASSOC, expecting '}'
`respond_with {:status => "Not found"}` 
```

但是，当我将文字哈希括在括号中时，如下所示：

```
respond_with({:status => "Not found"}) 
```

该功能运行顺利。为什么括号有区别？哈希不是封闭的调用吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T22:13:03.520

调用方法时，直接在方法名称之后的左大括号被解释为块的开始。这优先于作为哈希的解释。规避该问题的一种方法是使用括号将解释强制为方法参数。例如，请注意这两个方法调用的含义不同：

```
# interpreted as a block
[:a, :b, :c].each { |x| puts x }

# interpreted as a hash
{:a => :b}.merge({:c => :d}) 
```

另一种方法是去掉大括号，因为你总是可以跳过方法最后一个参数的括号。Ruby 足够“聪明”，可以将参数列表末尾看起来像关联列表的所有内容解释为单个哈希。请看一下这个例子：

```
def foo(a, b)
  puts a.inspect
  puts b.inspect
end

foo "hello", :this => "is", :a => "hash"
# prints this:
# "hello"
# {:this=>"is", :a=>"hash"} 
```

# java - 自 Java 7 以来 HttpServer 延迟 1 秒

> ID：15235075
> 
> 赞同：8
> 
> 时间：2013-03-05T22:05:58.100
> 
> 标签：java, java-7, com.sun.net.httpserver

我们`HttpServer`在项目中使用内部类通过 HTTP 在客户端和服务器之间交换数据。当我们切换到 Java 7 时，我们意识到交付结果的延迟。我们可以将问题简化为以下示例：

类`EchoServer`创建上下文，该上下文`/echo`仅在每个请求时返回当前日期和请求 URI。然后，该服务由客户端循环调用。

```
import java.io.IOException;
import java.io.OutputStream;
import java.net.InetSocketAddress;
import java.util.Date;

import com.sun.net.httpserver.HttpExchange;
import com.sun.net.httpserver.HttpHandler;
import com.sun.net.httpserver.HttpServer;

public class EchoServer {

    public static void main(String[] args) throws IOException {
        HttpServer server = HttpServer.create(new InetSocketAddress(80), 0);
        server.createContext("/echo", new EchoHandler());
        server.start();
    }

    static class EchoHandler implements HttpHandler {
        public void handle(HttpExchange httpExchange) throws IOException {
            httpExchange.getResponseHeaders().add("Content-type", "text/html");
            String response = "<b>" + new Date() + "</b> for "  + httpExchange.getRequestURI();
            httpExchange.sendResponseHeaders(200, response.length());
            OutputStream os = httpExchange.getResponseBody();
            os.write(response.getBytes());
            os.close();
        }
    }
} 
```

以下客户端使用类在无限循环中调用服务，`URL`并打印返回流中的第一个字符（这将是`<`符号）。此外，客户端打印当前时间。

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.URL;

public class EchoClient {

    public static void main(String[] args) throws Exception{
        while(true) {
            URL url = new URL("http://localhost:80/echo");

            BufferedReader rd = new BufferedReader(new InputStreamReader(url.openStream()));
            int res = rd.read();
            System.out.println((char)res);
            System.out.println(System.currentTimeMillis());
        }
    }
} 
```

如果此代码在 Java6 上执行，则一切正常，并且大约会打印一个结果。每 5 毫秒。

```
% java -version
java version "1.6.0_24"
Java(TM) SE Runtime Environment (build 1.6.0_24-b07)
Java HotSpot(TM) 64-Bit Server VM (build 19.1-b02, mixed mode)

% java EchoClient
<
1362515635677
<
1362515635682
<
1362515635687
<
1362515635691 
```

如果代码在 Java7 上执行，那么每个请求大约使用 1000 毫秒。

```
% java -version
java version "1.7.0_17"
Java(TM) SE Runtime Environment (build 1.7.0_17-b02)
Java HotSpot(TM) 64-Bit Server VM (build 23.7-b01, mixed mode)

% java EchoClient
<
1362517297845
<
1362517298844
<
1362517299845
<
1362517300845 
```

似乎在某处隐藏了 1000 毫秒的超时。`InputStreamReader`如果字符是在 上而不是在上读取的，则会`BufferedReader`发生相同的延迟。如果直接从输入流中读取一个字节，则看不到延迟。另一方面，如果`EchoClient`程序是针对 servlet 运行的，那么一切正常，与是否使用 the`BufferedReader`或 the无关`InputStreamReader`。

看来，该类`InputStreamReader`期望来自服务器的某些东西不再由 HttpServer 的 Java 7 实现提供。你知道这里到底发生了什么以及如何解决这个问题吗？一种解决方法？或者这是一个错误？

谢谢！

* * *

我在客户端代码中添加了更多时间：

```
public static void main(String[] args) throws Exception{
    while(true) {
        System.out.println("0: "+System.currentTimeMillis());
        URL url = new URL("http://localhost:80/echo");
        System.out.println("1: "+System.currentTimeMillis());
        InputStream in = url.openStream();
        System.out.println("2: "+System.currentTimeMillis());
        InputStreamReader isr = new InputStreamReader(in);
        System.out.println("3: "+System.currentTimeMillis());
        char res = (char)isr.read(); // character read is `<`
        System.out.println(res + ": "+System.currentTimeMillis());
    }
} 
```

结果如下：

```
% java EchoClient
0: 1362532555535
1: 1362532555537
2: 1362532555608
3: 1362532555609
<: 1362532555611
0: 1362532555612
1: 1362532555613
2: 1362532556608
3: 1362532556609
<: 1362532556610
0: 1362532556611
1: 1362532556612
2: 1362532557609
3: 1362532557610
<: 1362532557611
0: 1362532557612
1: 1362532557613 
```

第一次调用`openStream`需要一些时间（70 毫秒），但所有进一步的调用`openStream`需要更长的时间（大约 996 毫秒）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T14:23:04.923

刚刚向 Oracle 提交了错误报告。对于两个 Java 版本（SE 6 或 7），我在这里得到了 38 毫秒的延迟。

```
/**
 * @test
 * @bug 
 * @summary  pipelining delay on Ubuntu 12.04.01 LTS / amd64
 */

import com.sun.net.httpserver.*;

import java.util.*;
import java.util.concurrent.*;
import java.io.*;
import java.net.*;

public class Bug {

    static int iterations = 20;
    static long requiredMinimumDelay = 10L;

    public static void main (String[] args) throws Exception {
        Handler handler = new Handler();
        InetSocketAddress addr = new InetSocketAddress (0);
        HttpServer server = HttpServer.create (addr, 0);
        HttpContext ctx = server.createContext ("/test", handler);
        ExecutorService executor = Executors.newCachedThreadPool();
        server.setExecutor (executor);
        server.start ();

        long minDelay = requiredMinimumDelay * 1000L;

        try {
            for(int i = 0; i < iterations; i++) {
                URL url = new URL ("http://localhost:"+server.getAddress().getPort()+"/test/foo.html");
                HttpURLConnection urlc = (HttpURLConnection)url.openConnection ();
                InputStream is = urlc.getInputStream();
                InputStreamReader isr = new InputStreamReader(is);
                BufferedReader br = new BufferedReader(isr);
                String res = br.readLine();
                br.close();

                // skip first few
                if(i < iterations/2) {
                    continue;
                }

                long delay = System.currentTimeMillis() - Long.parseLong(res);
                System.out.println("delay: "+delay+" ms");
                if(delay < minDelay) {
                    minDelay = delay;
                }
            }
        } catch (Exception ex) {}

        server.stop(2);
        executor.shutdown();

        if(minDelay > requiredMinimumDelay) {
            throw new Exception("minimum delay too large: "+minDelay);
        }
    }

    static class Handler implements HttpHandler {
        public void handle (HttpExchange t)
            throws IOException
        {
            InputStream is = t.getRequestBody();
            Headers map = t.getRequestHeaders();
            Headers rmap = t.getResponseHeaders();
            while (is.read () != -1) ;
            is.close();
            String response = Long.toString(System.currentTimeMillis())+"\n";
            t.sendResponseHeaders (200, response.length());
            OutputStream os = t.getResponseBody();
            os.write (response.getBytes());
            t.close();
        }
    }    
} 
```

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=8009548](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=8009548)

更新：原来甲骨文将其归类为“两个不同的错误”，一个针对 38 毫秒（他们强调？），一个针对 1000 毫秒，他们在这里解决了这个问题：

[http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014254](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014254)

因此，1000ms 希望基于链接的反向端口在版本“8b91”和“7u85”中得到修复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:17:14.147

您似乎没有关闭 BufferedReader 或由`url.openStream()`. 不关闭流可能会导致无法在后续迭代中重用连接（并且通常是错误的行为）。

`rd.close()`显式调用and有不同的结果`stream.close()`吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-20T20:44:18.117

我遇到了同样的问题，但是 user1050755 的评论指出了这个[错误](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8014254)，它有一个解决方案：

> ...当服务器使用线程池时这不是问题，但是对于单线程服务器，此超时会导致瓶颈..

因此，制作一个多线程服务器：

```
 final Executor multi = Executors.newFixedThreadPool(10);
        final HttpServer server = HttpServer.create(new InetSocketAddress(s_HTTP_PORT), 5);
        //... do your REST bindings here
        server.setExecutor(multi);
        server.start(); 
```

对我来说就像一个魅力。

PS。像“com.sun.net.httpserver 很糟糕”这样的评论并没有提供任何帮助——这与“使用 Apache 代替”是一样的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-08-06T17:51:25.580

一种解决方法（最初来自 user1050755）是在 sendResponseHeaders() 方法之前添加这个：

```
 httpExchange.getResponseHeaders().add("Connection", "close"); 
```

这基本上禁用了“保持活动”功能，但至少对我来说，每个请求从 1000 毫秒到 50 毫秒，因为我没有轻松升级我的 JRE 的选项。虽然它确实失去了 FWIW 的“保持活力”功能。

# javascript - 如何使用 JQuery 获取选定选项的属性？

> ID：15235076
> 
> 赞同：-2
> 
> 时间：2013-03-05T22:06:05.303
> 
> 标签：javascript, jquery

```
<select id="hello">
    <option data-title="foo" value="1" selected="selected">Abcdefg</option
</select> 
```

为了获得选择的价值，我通常这样做：

```
$("#hello").val(); // returns 1 
```

但是如果我想获得数据标题怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T22:07:21.337

尝试如下，

```
$('#hello option:selected').data('title'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T22:07:15.523

尝试：

```
$('option:selected', '#hello').attr('data-title'); 
```

**更新**

虽然上述方法*有效*，但正如其他人所说，处理此问题的首选方法是使用[数据 API](http://api.jquery.com/data/)。

```
$('option:selected', '#hello').data('title'); 
```

**更新 2**

在进一步研究这一点时，我发现[这个页面](http://lookfirst.com/2011/12/dont-use-jquery-data-method-use-attr.html)解释了为什么使用`attr`更可取，并概述了`data`行为不端的情况。

**更新 3**

[jsPerf](http://jsperf.com/jquery-data-vs-attr/2)证明这`attr`比使用`data`. 我仍在尝试找到有关原因的规范文档，或者 using`data`是否比 using 更可取`attr`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:08:00.657

这应该可以正常工作：

```
$('#hello :selected').data('title'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:07:39.160

```
var title = $('#hello').find(':selected').data('title'); 
```

# html - MathJax 自动换行

> ID：15235077
> 
> 赞同：6
> 
> 时间：2013-03-05T22:06:24.790
> 
> 标签：html, ios, css, mathjax

我已经使用下面的代码为 MathJax 配置了额外的处理

```
<script type="text/x-mathjax-config">

    MathJax.Hub.Config({
    tex2jax: { inlineMath: [["$","$"],["\\(","\\)"]] },
    "HTML-CSS": {
       linebreaks: { width: "container" }          
    }              
    });

</script> 
```

正如我假设它必须与我的 HTML 代码中的自动换行容器一起使用。

我有这个用自动换行设置的 CSS

```
.col {
        background: #f0f0f0; 
        width: 230px; 
        padding: 10px; 
        font-size: 1.5em; 
        word-wrap: break-word; 
    } 
```

这是我的身体：

```
<body>

        <div class = 'col'>

        $$
           Pr [( G \bigcup B \bigcup S)^e ] = 1 - Pr ( G \bigcup B \bigcup S)                
           = 1 - [Pr(G)+Pr(B)Pr(S)-Pr(G \bigcap B) - Pr(G \bigcap S) - Pr(B \bigcap S)]
           Pr [( G \bigcup B \bigcup S)^e ] = 1 - Pr ( G \bigcup B \bigcup S)
           = 1 - [Pr(G)+Pr(B)Pr(S)-Pr(G \bigcap B) - Pr(G \bigcap S) - Pr(B \bigcap S)]
           = 1 - (0.28 + 0.29 + 0.19 - 0.14 - 0.10 -0.12 + 0.08) = 1 - 0.48 = 0.52
        $$

        </div>

</body> 
```

但在我的情况下，自动换行不起作用。

我附上了屏幕截图，它在 iPad 上的 Safri 中的外观

![在此处输入图像描述](../Images/44dbef31484e6231167319162034c681.png)

单词必须换行到第二行，但它们不会显示您可以看到的广告。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T01:24:21.353

编辑如果您使用的是 iOS6，那么您可能会遇到[这个 MathJax 错误](https://github.com/mathjax/MathJax/issues/368)。

MathJax 使用自己的换行算法（[实现 MathML 规范](http://docs.mathjax.org/en/latest/whats-new-2.0.html?highlight=linebreaking#automatic-line-breaking-of-long-displayed-equations)）。设置`word-wrap: break-word;`不会改变它的行为。

除非缺少某些信息，否则您的代码可以按预期工作，即 MathJax 会进行换行。

这是一个完整的例子。

```
<!doctype HTML>
<head>
<title>Break!</title>
<script type="text/x-mathjax-config">

MathJax.Hub.Config({
tex2jax: { inlineMath: [["$","$"],["\\(","\\)"]] },
"HTML-CSS": {
  linebreaks: { automatic: true, width: "container" }          
}              
});

</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<style>
.col {
    background: #f0f0f0; 
    width: 230px; 
    padding: 10px; 
    font-size: 1.5em; 
    word-wrap: break-word; 
}  
</style>

</head>
<body>

    <div class = 'col'>

    $$
      Pr [( G \bigcup B \bigcup S)^e ] = 1 - Pr ( G \bigcup B \bigcup S)                
      = 1 - [Pr(G)+Pr(B)Pr(S)-Pr(G \bigcap B) - Pr(G \bigcap S) - Pr(B \bigcap S)]
      Pr [( G \bigcup B \bigcup S)^e ] = 1 - Pr ( G \bigcup B \bigcup S)
      = 1 - [Pr(G)+Pr(B)Pr(S)-Pr(G \bigcap B) - Pr(G \bigcap S) - Pr(B \bigcap S)]
      = 1 - (0.28 + 0.29 + 0.19 - 0.14 - 0.10 -0.12 + 0.08) = 1 - 0.48 = 0.52
    $$

    </div>

</body> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-22T05:49:36.297

我也遇到过类似的问题，但我无法使用该自动换行来解决。
这个问题是由 MathJax 的默认类引起的，因此我们需要覆盖它们，以便它根据父级的宽度工作：

```
.mjx-chtml {
   font-size: ${IS_MOBILE ? '100%' : '120%'} !important;
}
.mjx-table {
   white-space: pre-line !important;
}
.mjx-table .mjx-char {
   white-space: ${IS_MOBILE ? 'pre-line' : 'inherit'} !important;
}
.mjx-full-width {
   width: 0em !important;
} 
```

# xml - 使用 XSL 删除 XML 元素

> ID：15235080
> 
> 赞同：1
> 
> 时间：2013-03-05T22:06:29.537
> 
> 标签：xml, xslt

我有一个 XSL 脚本，它读取 XML 文件以获取元素中的值，创建另一个 XML 以供下游使用。

原始 XML 文件的输出示例如下：

```
<e:OnboardingProcess>
    <e:Assignment>
        <e:Assignment>
            <e:Application>
                <e:Application>
                    <e:CandidateIndentificationNo>7047961</e:CandidateIndentificationNo>
                </e:Application>
            </e:Application>
            <e:Offer>
                <e:Offer>
                    <e:UDFs>
                        <e:UDF name="FRB_5fOnboarding_5fLocation">
                            <e:CustomSelectionElement>
                                <e:Code>1204</e:Code>
                            </e:CustomSelectionElement>
                        </e:UDF>
                    </e:UDFs>
                </e:Offer>
            </e:Offer>
            <e:TalentMasterFile>
                <e:TalentMasterFile>
                    <e:User>
                        <e:User>
                            <e:EmployeeID></e:EmployeeID>
                            <e:FirstName>Peter</e:FirstName>
                            <e:LastName>Griffin</e:LastName>
                        </e:User>
                    </e:User>
                </e:TalentMasterFile>
            </e:TalentMasterFile> 
```

我的 XSL 脚本有代码来引用一些值，它看起来像这样：

```
<xsl:variable name="CandidateNumber" select="../../e:Assignment/e:Assignment/e:Application/e:Application/e:CandidateIndentificationNo"/>
<xsl:variable name="FirstName" select="../../e:Assignment/e:Assignment/e:TalentMasterFile/e:TalentMasterFile/e:User/e:User/e:FirstName"/>
<xsl:variable name="LastName" select="../../e:Assignment/e:Assignment/e:TalentMasterFile/e:TalentMasterFile/e:User/e:User/e:LastName"/>
<xsl:variable name="Location" select="../../e:Assignment/e:Assignment/e:Offer/e:Offer/e:UDFs/e:CustomSelectionElement/e:Code"/> 
```

它适用于除“位置代码”之外的所有内容，唯一的区别是位置之前有一个特殊元素`<e:UDF name="FRB_5fOnboarding_5fLocation">`。有谁知道如何映射到位置代码或者我如何编写一个程序来获取原始 XML 文件，删除所有出现的`<e:UDF name="FRB_5fOnboarding_5fLocation">`元素，并输出一个看起来与第一个相同的新 XML 文件，除了不需要的元素.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:43:41.783

Your XPath to the location element is missing the e:UDF element step.

```
<xsl:variable name="Location" select="../../e:Assignment/e:Assignment/e:Offer/e:Offer/e:UDFs/e:CustomSelectionElement/e:Code"/> 
```

should actually be

```
<xsl:variable name="Location" select="../../e:Assignment/e:Assignment/e:Offer/e:Offer/e:UDFs/e:UDF/e:CustomSelectionElement/e:Code"/> 
```

# c# - 内向螺旋算法不起作用

> ID：15235083
> 
> 赞同：2
> 
> 时间：2013-03-05T22:06:39.140
> 
> 标签：c#, algorithm, spiral

我有这个 c# 代码可以像这样以向内螺旋的方式遍历网格：

```
1 2 3
8 9 4
7 6 5 
```

这是代码，但它有问题，由于某种原因，它的计算时间比预期的要长得多。有谁知道为什么会这样？

```
 static void create_spiral_img(int width, int height)
    {
        Bitmap img = new Bitmap(width, height);
        Graphics graph = Graphics.FromImage(img);

        int x = 0;
        int y = 0;
        int size = width * height;
        int max = size;
        int count = 1;
        int i, j;
        while (size > 0)
        {
            for (i = y; i <= y + size - 1; i++)
            {
                draw_pixel(count++, x, i, graph);
            }

            for (j = x + 1; j <= x + size - 1; j++)
            {
                draw_pixel(count++, j, y + size - 1, graph);
            }

            for (i = y + size - 2; i >= y; i--)
            {
                draw_pixel(count++, x + size - 1, i, graph);
            }

            for (i = x + size - 2; i >= x + 1; i--)
            {
                draw_pixel(count++, i, y, graph);
            }

            x = x + 1;
            y = y + 1;
            size = size - 2;
            Console.Write(100 * ((float)(count) / (float)max) + "% ");
        }

        graph.Dispose();
        img.Save("./" + width + "x" + height + "_spiril.png", System.Drawing.Imaging.ImageFormat.Png);
        img.Dispose();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:48:49.673

假设一个正方形（宽度=高度），看起来你有一个 O(x^4) 实现 - 这将非常缓慢。

我建议尝试将其降低到 O(x^2)。不要以螺旋方式绘制它，而是重写您的算法以将其绘制成矩形 - 也就是说，按行和列，计算每个像素应该是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T01:15:48.977

假如说

```
draw_pixel(c,x,y,g) 
```

在图 g 中的 (x,y) 坐标处以颜色 c 绘制一个点，你走得太远了。你正在做的

```
for (i = y; i <= y + size - 1; i++) 
```

打印一条应该有长度宽度的线，但你正在打印一条长度大小的线。

我想我不明白你的算法。如果这没有意义，你能解释一下draw_pixel的语义吗？

# python - Python 脚本不会在任务计划程序中运行“无论用户是否登录都运行”

> ID：15235085
> 
> 赞同：0
> 
> 时间：2013-03-05T22:06:41.950
> 
> 标签：python, automation, task, scheduler

我已经编写了一个 python 脚本，并希望使用任务计划程序让它每天在设定的时间段内运行。在创建此任务之前，我在注销时运行程序的任务计划程序没有任何问题。

如果我选择“仅在用户登录时运行”，我的脚本将按预期运行，并获得所需的结果并且没有错误代码 (0x0)。

如果我用“以最高权限运行”选择“无论用户是否登录都运行”，然后让它过夜或注销以测试它，它不会做任何事情并且错误代码为 0x1。

我有“启动程序”的操作，详细信息如下：

**程序/脚本**：C:\Python27\python2.7.exe **添加参数**：“C:\Users\me\Desktop\test.py”

我认为这与注销时使用 python 的权限有关，但我无法弄清楚这一点。想知道是否有人对此有建议或经验。

***这是在 Windows 7 上（仅供参考）***

谢谢，JP

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T16:56:28.543

我想我已经找到了解决这个问题的方法。我的脚本是用来制作powerpoint幻灯片的，需要打开MS PPT。

我偶然发现了另一个论坛的帖子，其中包含 MS 对此政策的链接。它基本上归结为以下几点：

“微软目前不推荐也不支持任何无人值守、非交互式客户端应用程序或组件（包括 ASP、ASP.NET、DCOM 和 NT 服务）的 Microsoft Office 应用程序自动化，因为 Office 可能表现出不稳定的行为和/或在此环境中运行 Office 时出现死锁。

当使用“无论用户是否登录时运行”选项运行计划任务时，从计划任务自动化 PowerPoint 属于不受支持的方案。但是，将它与“仅在用户登录时运行”选项一起使用属于受支持的类别。”

从[这里](http://social.msdn.microsoft.com/Forums/en-US/officegeneral/thread/d0fee207-846b-4908-bc85-a2fad8408c37/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:15:48.603

我会尝试使用不在您的用户目录中的脚本

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2017-01-15T04:12:21.673

我有通过名为 p3icli 的 C++ 应用程序（可在 sourceforge 上获得）在任务计划程序下支持 PowerPoint 自动化的经验。这是我成功使用的方法：

1) 添加一个命令行 (-T) 开关，指示 p3icli 将在任务计划程序下运行。

2) 命令行开关强制 p3icli 使用**CreateProcess()**启动 powerpnt.exe 的实例，然后等待 X 毫秒以使该实例稳定。

3) X 毫秒后，p3icli 连接到在步骤 2 中创建的正在运行的 PPT 实例并处理自动化命令。

我猜想 Python 也可以使用类似的方法。

任务计划程序兼容性很容易成为我添加到 p3icli 的最麻烦的功能。例如，通过更改活动窗口来操作多个演示文稿根本不起作用。而且我相信您已经发现，调试问题一点也不好玩。

注意：您的 python 解决方案必须包含强制 PowerPoint 在您的 python 脚本完成时无条件关闭的代码（以 python 崩溃为模）。否则，孤立的 PowerPoint 实例将出现在任务管理器中。

单击链接以从 p3icli[的角度了解](http://p3icli.sourceforge.net/p3icli_help.html#task_scheduler_caveats)有关任务计划程序的一些想法。

# java - Java JButton addActionListener and get the own name

> ID：15235086
> 
> 赞同：1
> 
> 时间：2013-03-05T22:06:44.803
> 
> 标签：java, swing, jbutton, actionlistener

I'm trying to generate buttons dynamically and add an ActionListener that put the name of the button into a TextArea. My code is like:

```
 int numnotas = model.getColumnCount();
    JButton[] notasbot = new JButton[numnotas];

    BotonesNotas.setLayout(new GridLayout());
    for( int k = 1; k < numnotas; k++){
        variables.add(model.getColumnName(k));
        notasbot[k-1]=new JButton(variables.get(k-1));
        notasbot[k-1].setSize(new Dimension(80,23));
        notasbot[k-1].setLocation(80, 350);
        notasbot[k-1].setMargin(new Insets(2,14,2,14));
        notasbot[k-1].setAlignmentX(0);
        notasbot[k-1].setAlignmentY(1);
        notasbot[k-1].setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        notasbot[k-1].setVerticalAlignment(javax.swing.SwingConstants.CENTER);
        notasbot[k-1].addActionListener(new ActionListener() {
             @Override
             public void actionPerformed(ActionEvent e) {
                entrada.insert(????,entrada.getSelectionEnd());
            }
        });
        notasbot[k-1].setLayout(null);
        BotonesNotas.add(notasbot[k-1]);
        notasbot[k-1].setVisible(true);
    } 
```

What can I set in ???? to get the name of the button. If I put something like "notasbot[k-1].getName()" it's give me an error: local variable k is accessed from within inner class; needs to be declared final

What should I do ? Thanks

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:09:10.977

You can use the ActionEvents getSource method. Here you would do:

```
JButton eventSourc = (JButton)e.getSource(); 
```

inside of your actionPerformed method.

# c - 二维字符串数组和Strcpy故障？

> ID：15235092
> 
> 赞同：0
> 
> 时间：2013-03-05T22:07:16.057
> 
> 标签：c, arrays, strcpy

我在将值分配给二维字符串数组时遇到问题。这是代码：

```
 Char array[]= "Nary had a little lamb";
  int chunkSize = 4;
  char inventory[totalRuns][chunkSize];

  subString(result, array,0,0+chunkSize);
  printf("CHUNK 1 = %s\n",result);          //Prints "Nary"
  strncpy(inventory[0],result,chunkSize);
  memset(result, '\0', strlen(result));

  subString(result, array,pos,pos+chunkSize);
  printf("CHUNK 2 = %s\n",result);          // Prints " had"
  strncpy(inventory[1],result,chunkSize); 
```

和函数子字符串：

```
char *subString(char* putHere, char* request,int start,int end){
    char* loc = request+start;
    char* end_loc = request+end;

    memcpy(putHere, loc, end_loc-loc);

    return putHere; 
```

}

当我运行这段代码时，输​​出是

CHUNK 1 = Nary

CHUNK 2 = 有

这是正确的，但是当我打印库存时，我得到

```
inventory[0]=Nary had       //Should be just "Nary"
inventory[1]= had           //correct 
```

任何想法我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:14:40.647

您`subString`不会 0 终止目标缓冲区，`strncpy`如果给定范围内没有 0 字节，也不会 0 终止。因此，您`inventory`包含未终止的`char`序列，并且打印打印直到`printf`在某处找到 0 字节或由于访问冲突而崩溃。

的内存布局`inventory`直接`inventory[1]`在`inventory[0]`'s last之后`char`，因此`printf("%s", inventory[0]);`打印两个块，因为第一个块不是 0 终止的。在您的情况下，之后似乎有一个 0 字节，但由于`inventory`没有初始化，这是巧合。

# php - 使用按钮加载更多 mysql 结果

> ID：15235098
> 
> 赞同：0
> 
> 时间：2013-03-05T22:07:27.293
> 
> 标签：php, javascript, mysql

我正在制作一个图像共享网站，用户可以在其中注册并上传他们自己的图片或他们在互联网上找到的图片。文件路径被上传到 MySQL 数据库。然后我使用 MySQL 查询将所有图像路径拉出，并使用 while 循环将图像放到页面上。随着更多图像被上传，页面加载所需的时间越长。我想在 5 张图片后添加一个加载更多按钮，按下该按钮会加载另外 5 张图片。我似乎在任何地方都找不到这方面的教程。

该表称为图像，列名称为路径。

```
<?php
$sql = mysql_query("SELECT * FROM `images` ORDER BY `id` DESC");
while($row = mysql_fetch_array($sql)){
    $path = $row['path'];
?>
    <img src="<?php echo $path; ?>" alt="" />
<?php
}
?> 
```

这是我用来获取文件路径的来。这不是我有问题的。问题是，页面上的图片太多，加载速度很慢。所以这就是为什么我想一次加载 5 个。如果您认为在用户滚动时加载会更好，请帮助我知道如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:33:15.687

你想要的是分页。我开始告诉你用谷歌搜索它，但在我自己做了之后，我发现有很多不好的建议，不值得。

首先，您想使用更现代的方法连接到 mysql 数据库。这些`mysql_*`函数在 PHP 中已被弃用，它们被认为存在安全风险。我更喜欢[PDO](http://php.net/PDO)，它为您提供了许多不同数据库的良好一致接口。另一种选择是[MySQLi](http://php.net/mysqli)，如果您习惯了这些`mysql_*`功能，它会更容易一些

从那里开始，只需限制查询，然后让您的脚本知道要返回哪组值。这就是我的做法（注意我没有对此进行测试，因此可能存在错误！您还需要决定如何处理输出和错误）

```
// Database connection stuff goes here

$start = $_GET['start'];
$per_page = 10; // or config value of your choice

// first find out how many you have
try {
    $res = $dbh->prepare( "SELECT COUNT(*) FROM `images`" );
    $res->execute();
}
catch(PDOException $e) {
    // do something with errors!
}

list($count) = $res->fetch(PDO::FETCH_NUM);

$end = $start + $per_page;
if( $count < $end ) {
    $end = $count;
}

// next and previous values. Just create links and these 
// become the "start" parameter
$next = $end + 1;
$prev = $start - $per_page;
if( $prev < 0 ) {
    $prev = 0
}

// now get the results
try {
    $res = $dbh->prepare("SELECT * FROM `images` 
        ORDER BY `id` DESC LIMIT $start, $end");
    $res->execute();

    while( $image = $res->fetch(PDO::FETCH_ASSOC) ) {
        // store or output the results
    }
}
catch(PDOException $e) {
    // do something with errors!
} 
```

要在滚动时自动执行此操作，您可以使用 jQuery 检查滚动事件，然后调用后端代码以自动加载更多结果（通过将 $prev 和 $next 值设置到调用中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:30:49.707

如果您只想要 5 个，请使用[Select Top 5](http://www.w3schools.com/sql/sql_top.asp)，如果您想在滚动时上传新文件，您可以使用 Ajax。希望你能找到方法并分享它。

# java - SAX 解析器和字符串实习

> ID：15235104
> 
> 赞同：0
> 
> 时间：2013-03-05T22:07:56.680
> 
> 标签：java, sax

我注意到`DefaultHandler`事件方法中的所有字符串都是实习的。看看字符串是否等于`==`而不是更好`equals()`？

```
@Override
public void startElement(String uri, String localName, String qName,
     Attributes attributes) throws SAXException {

if(localName == "element")
// do something

// or

if(localName.equals("element"))
// do something

} 
```

由于所有 String 文字都是实习的，它应该会提高性能。但是我见过的所有教程和示例都使用`equals()`

我可以看到的一个问题是您是否需要使用`equalsIgnoreCase()`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T22:14:04.310

至少在 Oracle JDK7 中，String.equals(Object) 所做的第一件事是检查对象引用是否与 String 实例相同：

```
public boolean equals(Object anObject) {
    if (this == anObject) {
        return true;
    }
    ... 
```

因此，即使`==`在这些情况下会产生正确的结果，您实现的唯一节省是（几乎）立即返回的方法调用。我怀疑在任何类型的测量中都可以明显地节省成本。

即使有一些可衡量的成本节省，这似乎也是一个非常冒险的优化——总是假设`==`这些字符串的比较是正确的。如果 SAX 类的未来版本改变了行为怎么办？字符串实习是其 API 的记录功能吗？听起来很可疑。

# javascript - jQuery Mobile 加载包含对 servlet 脚本的 ajax 调用的外部 HTML，并且只执行一次

> ID：15235105
> 
> 赞同：1
> 
> 时间：2013-03-05T22:07:57.440
> 
> 标签：javascript, jquery, html, jquery-mobile

我有一个用于网络应用程序 POS 的 iphone 样式菜单，当我按下客户端按钮时，它会显示一个包含所有客户端的页面，这是对 java servlet 进行 ajax 调用，我在主页中使用 load() 函数将 GetCustomers.html 文件与包含带有 ajax 和 UL 标记的 jquery 代码的脚本一起引入，当我在我的主页中调用它（加载它）时，它仅在我使用带有 with 的 firebug 调试器时格式化 UL 及其分别生成的 LI触发器中的断点（'create'）；这是“pagebeforeshow”函数中的最后一条指令。但！如果我在不调试的情况下运行它，它会格式化和风格化它并显示 2 毫秒，然后它会在没有 jquery-mobile Listview 样式的情况下显示它。我正在使用 $(this).trigger('create'); 和 that.listview('refresh'); 它仍然不能很好地工作......有什么建议吗？

这是主页代码：

```
$(document).on("pagebeforeshow", "#pagewelcomeclientes", function(){
  if( navigationInitialized == 'X'){
    var newItems = '<li data-role="list-divider">Page Options</li>';
    newItems += '<li><a href="#" class="time">Time</a></li>';
    newItems += '<li><a href="#pageclientenuevo" id="botonclientenuevo" data-icon="plus" class="clientenuevo" data-transition="fade">Agregar Cliente</a></li>';
    $(".pageOpts").empty();
    $(".pageOpts").append(newItems).listview("refresh");

    $.ajaxSetup ({  
        cache: false  
    });  

    var loadUrl = "GetCustomers.html";
    $("#contentwelcomeclientes").load(loadUrl,function(){
    BringClientes();

    $(this).trigger('create');

    });

    var list = $('ul[data-autodividers="true"][data-sort="true"]');

    list.each(function (i, item) {

      var that = $(item);

        // Gel all the list items into an array (excluding te dividers)
        var lis = that.find('li').not('.ui-li-divider').get();

        // Sort the list items alphabetically, descending
        lis.sort(function (a, b) {
            var valA = $(a).text(),
                valB = $(b).text();
            if (valA < valB) {
                return -1;
            }
            if (valA > valB) {
                return 1;
            }
            return 0;
        });

        // Remove all list items
        that.empty();

        // Rebuild the list with the ordered items
        $.each(lis, function (i, li) {
            that.append(li);
        });

        // Refresh/rebuild the listview
       that.listview('refresh');

    }); 

  $(this).trigger('create');

  }

}); 
```

这里是所谓的 HTML：

```
 <script type='text/javascript'>
        BringClientes = function() {

            $.ajax({
            type: "POST",
            url: "GetCustomers",
            dataType: "json",
            success: function (data) {
                if (data.Customers.length) {
                    $.each(data.Customers, function (i, data) {
                        var temp = null;    
                        var temp = "#cd-dropdown";
                        var temp = temp+data.msg_id;
                        var msg_data = 

                        '<li><a href="#">'+data.first_name+'</a><a href="#paginaclientesolo2"></a></li>';
                        $(msg_data).appendTo("#juntar");

                    });

                } else {
                    $("#content").html("No Results");
                }
            }
        });

    }

    </script>

  <ul   data-role="listview" 
        data-inset="true" 
        data-filter="true"
        data-autodividers="true" 
        data-sort="true" 
        data-theme="c"
        data-divider-theme="c"
        data-split-icon="grid" 
        data-split-theme="d"
        id="juntar"
        >

   </ul> 
```

我认为它在第二页执行了两次脚本，我试图修复它，命名函数，然后只调用一次，但它仍然不起作用......如果你需要示例图像，我可以发送它通过邮件，这是我在这里的第一个问题，stacky 不允许我上传图片......

提前致谢！！=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T04:34:48.567

让我们将以下行更改 `$(document).on("pagebeforeshow", "#pagewelcomeclientes", function(){});`为如下

```
$('#pagewelcomeclientes').on('pagebeforeshow',function(event){
   // your code goes here
}); 
```

也将`$(this).trigger('create');`其更改为`$('#pagewelcomeclientes').trigger('create');`，看看会发生什么

如果您怀疑该服务被调用了两次，那么更好的解决方法是使用`.html()`而不是使用`.append()`.

你可以改变你的脚本如下

```
$.ajax({
        type: "POST",
        url: "GetCustomers",
        dataType: "json",
        success: function (data) {
            if (data.Customers.length) {
            var myListstring = "";
                $.each(data.Customers, function (i, data) {
                    var temp = null;    
                    var temp = "#cd-dropdown";
                    var temp = temp+data.msg_id;
                          myListstring += '<li><a href="#">'+data.first_name+'</a><a href="#paginaclientesolo2"></a></li>';
                  });
                  $("#juntar").html(myListstring);
                  $("#juntar").listview();

            } else {
                $("#content").html("No Results");
            }
        }
}); 
```

我建议您不要使用使事情复杂化，`.load()`而是可以在页面本身中调用服务并呈现列表视图。这将产生很多可读的代码。

希望这可能会让你更接近修复。

# jquery - 文本动画，其中两个单词组合在一起并创建一个新单词

> ID：15235107
> 
> 赞同：1
> 
> 时间：2013-03-05T22:07:59.473
> 
> 标签：jquery, css, animation

我公司的名称是另外两个词的缩写。过去，我在 Flash 中创建了一个动画，其中两个单词“碰撞”产生了新单词（公司名称）。现在可以使用 CSS 和 JQuery 的某种组合来实现类似的动画吗？

**一个例子：**

**京瓷**（表面上以其打印机而闻名）通过收缩两个词来获得它的名字 -**京都**和**陶瓷**。如果这是我的公司，我希望看到**Kyoto与****Ceramics**的碰撞，to**从**Kyoto 的末端**掉落**，**麦克风从****Ceramics**的末端掉落，由此产生的**京瓷**留在屏幕上。可行吗？

提前感谢您提供的所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:16:07.800

有淡出。可能将京都分成两个跨度“Kyo”和“to”，换句话说，为要淡出的“to”“mics”部分激活淡出，同时做这样的事情让你隐藏项目和剩余项目一起滑动：

```
$(".con .item").click(function() {
  $('.kill').hide("slow");    
}); 
```

**如果 div 之间没有空格，效果会更好，当然这些可能是一系列组成您的徽标的图像：**

```
<div class="con">
    <div class="item keep">DIV 1</div><div class="item kill">DIV 2</div><div class="item kill">DIV 3</div><div class="item keep">DIV 4</div>
</div>

.item
{ 
    width:50px; 
    height:50px;
    margin:0;
    padding:0;
    display:inline-block;
    position:relative;            
    background:lime;
    cursor:pointer;        
} 
```

**更新**小提琴：http: [//jsfiddle.net/M8scf/31/](http://jsfiddle.net/M8scf/31/)

单词之间的空间将作为一个淡出的部分包含在内，以便在项目淡出时，剩余的项目一起滑动。当然，任何默认样式的边距/填充都需要调整以使最后两个部分足够接近，或者您可以在最后两个部分组合在一起时立即隐藏它们，并且完整的单词淡入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:34:39.903

添加了 CSS3 [http://jsfiddle.net/wRREe/2/](http://jsfiddle.net/wRREe/2/)的效果，仅适用于现代浏览器。**对于非 CSS3 的简单效果，请参见下文，**

**JS**

```
$('.kyoto').animate({
    left: $('.ceramics').position().left - 27
}, 1000, function () {
    $('.break_this').addClass('break_off');
}); 
```

**CSS3：**

```
.break_this {
    position: absolute;
    top: 0px;
    -moz-transition: all 2s;
    -webkit-transition: all 2s;
    -ms-transition: all 2s;
    -o-transition: all 2s;
    transition: all 2s;
}
.break_off {
    top: 50px;
    opacity:0;
    filter:alpha(opacity=0);
    transform: rotate(180deg);
    -ms-transform: rotate(180deg);
    -webkit-transform: rotate(180deg);
    -o-transform: rotate(180deg);
    -moz-transform: rotate(180deg);
} 
```

**使用 CSS3 演示：http:** [//jsfiddle.net/wRREe/2/](http://jsfiddle.net/wRREe/2/)

**没有 CSS3 的演示：http:** [//jsfiddle.net/wRREe/1/](http://jsfiddle.net/wRREe/1/)

* * *

您可以在 javascript 中付出一些努力来实现几乎任何效果。请参阅下面的方法，

**HTML**

```
<span class="kyoto">Kyo<span class="break_this">to</span></span>
<span class="ceramics">Cera<span class="break_this">mics</span> 
```

CSS：

```
.kyoto {
    position: absolute;
    left: 10px;
    top: 10px;
}
.ceramics {
    position: absolute;
    left: 200px;
    top: 10px;
}

.break_this { position: absolute; } 
```

**JS：**

```
$('.kyoto').animate({
    left: $('.ceramics').position().left - 27
}, 1000, function () {
    $('.break_this').animate({
        top: '+=100',
        opacity: 0
    }, 2000, function () {
        $(this).remove();
    });
}); 
```

**演示：http:** [//jsfiddle.net/wRREe/1/](http://jsfiddle.net/wRREe/1/)

# python - PyOpenCL 矩阵乘法

> ID：15235109
> 
> 赞同：2
> 
> 时间：2013-03-05T22:08:13.383
> 
> 标签：python, opencl, ati, pyopencl

我有这个代码用于使用 pyopenCL 进行矩阵乘法。我的问题是某些矩阵的结果是错误的，我不明白为什么。经过一些研究，我认为它与类似的全球规模有关，但我不明白如何设置这些值。

例如：

使用 numpy dtype = float32 的矩阵

矩阵 1：

```
[[ 0.99114645  0.09327769  0.90075564  0.8913309 ]
[ 0.59739089  0.13906649  0.94246316  0.65673178]
[ 0.24535166  0.68942326  0.41361505  0.5789603 ]
[ 0.31962237  0.17714553  0.49025267  0.21861202]] 
```

矩阵2：

```
[[ 0.41509482  0.82779616  0.74143827  0.37681136]
[ 0.88058949  0.01039944  0.4342753   0.45752665]
[ 0.60375261  0.21243185  0.88312167  0.97394323]
[ 0.60855824  0.69482827  0.61627114  0.57155776]] 
```

预期结果：

```
[[ 1.57981943  1.63210835  2.12016045  1.80288424]
[ 1.3391085   1.15248911  1.7403561   1.58199609]
[ 1.31099532  0.70041376  1.20338154  1.14162762]
[ 0.71769556  0.52246746  0.88158722  0.8039138 ]] 
```

脚本结果：

```
[[ 1.20828819  0.73175305  1.64546931  1.42526579]
[ 1.13179159  0.46403384  1.20692348  1.14317513]
[ 1.25328159  0.86723316  1.58679342  1.40186214]
[ 1.35214019  0.6795128   1.73811913  1.48048854]] 
```

脚本：

```
def openCL_multiplication(matrix1, matrix2, res):

import pyopencl as cl
import numpy as np
import numpy.linalg as la

ctx = cl.create_some_context()
queue = cl.CommandQueue(ctx)

mf = cl.mem_flags
a_buf = cl.Buffer(ctx, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=matrix1)
b_buf = cl.Buffer(ctx, mf.READ_ONLY | mf.COPY_HOST_PTR, hostbuf=matrix2)
dest_buf = cl.Buffer(ctx, mf.WRITE_ONLY, matrix1.nbytes )

prg = cl.Program(ctx, """
    __kernel void multiplymatrices(const unsigned int size, __global float * matrix1, __global float * matrix2, __global float * res) {

    int i = get_global_id(1); 
    int j = get_global_id(0);

    res[i + size * j] = 0;

    for (int k = 0; k < size; k++)
    {
        res[i + size * j] += matrix1[i + size * k] * matrix2[k + size * j];
    }

    }
    """).build()

t0 = datetime.datetime.now()

prg.multiplymatrices(queue, matrix1.shape, None,np.int32(len(matrix1)) ,a_buf, b_buf, dest_buf)

final_matrix = np.empty_like(matrix1)
cl.enqueue_copy(queue, final_matrix , dest_buf)

print  final_matrix

delta_t = datetime.datetime.now() - t0
print 'OpenCL Multiplication: ' + str(delta_t)

return final_matrix 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T16:42:32.010

好吧，我认为内核做得很好。我什至可以称脚本结果正确。这完全取决于您如何处理矩阵:-) 如果您想要预期的结果。我会改变这个：

```
res[i + size * j] += matrix1[i + size * k] * matrix2[k + size * j]; 
```

对此：

```
res[i + size * j] += matrix1[k + size * i] * matrix2[j + size * k]; 
```

希望这可以帮助。

# sql-server - SQL Server sp_execute - 动态 SQL 中的 DateTime 变量出错

> ID：15235112
> 
> 赞同：1
> 
> 时间：2013-03-05T22:08:22.430
> 
> 标签：sql-server, sql-server-2008, tsql, dynamic-sql, sp-executesql

我尝试使用创建动态 SQL `sp_executesql`，但它给了我这个错误消息：

> *Msg 137, Level 15, State 2, Line 20
> 必须声明标量变量“@start”。*

这是我的存储过程脚本

```
CREATE PROCEDURE sp_test (@start datetime, @end datetime)
AS
BEGIN
   DECLARE @sql nvarchar(MAX)

   SET @sql = 'SELECT * FROM table1 WHERE '
   SET @sql = @sql + N'startDate BETWEEN @start AND @end'

   EXEC sp_executesql @sql 
```

任何输入将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T05:40:07.770

下面的 T-SQL 应该可以解决您的问题。虽然，我不建议您在存储过程名称前加上“sp_”，因为系统存储过程使用此命名约定。您不希望您的存储过程与系统存储过程混淆，或者更糟糕的是，Microsoft 决定用您的名称命名他们未来的系统存储过程之一。

注意事项：

*   您可以在 @ParameterDefinition 变量中定义/声明要传递到动态 SQL 语句中的所有自定义参数。
*   您将每个自定义变量添加到 sp_executesql 调用中，就好像它们已经是过程的一部分一样。

    ```
    IF OBJECT_ID('sp_test', 'P') IS NOT NULL DROP PROCEDURE sp_test
    GO
    -- ============================================================================
    -- CALLING EXAMPLE:
    -- EXEC sp_test '01/01/1901', '01/02/1901'
    -- ============================================================================
    CREATE PROCEDURE sp_test (@start datetime, @end datetime)
    AS
    BEGIN

    DECLARE @sql nvarchar(max)

    SET @sql = 'SELECT * FROM table1 WHERE '
    SET @sql = @sql + N'startDate BETWEEN @start AND @end'

    -- Build the Parameter Definition list for the dynamic SQL statement below  
    DECLARE @ParameterDefinition nvarchar(1000);
    SELECT @ParameterDefinition = ''  
    + ' @start datetime'  
    + ',@end datetime' 

    EXEC sp_executesql  
        @statement  = @sql  
       ,@params     = @ParameterDefinition  
       -- Assign values to any of custom parameters defined in @ParameterDefinition:  
       ,@start      = @start  
       ,@end        = @end  

    END
    GO 
    ```

# c++ - 用户定义函数的返回值有问题

> ID：15235113
> 
> 赞同：1
> 
> 时间：2013-03-05T22:08:26.257
> 
> 标签：c++, function, return

我正在做一个简单的毕达哥拉斯函数用户输入两个数字，这两个数字都被运送到一个名为 Hypo 的用户定义函数中，hypo 应该返回一个值 C，这就是答案。

这是我的脚本。

```
#include <stdio.h>
#include <stdlib.h>
#include <math.h>

int hypo(double a, double b);

int main(void)
{ 
   double one, two;
   //user inputs two variables
   scanf("%lf %lf", &one, &two );
   printf("Your C number is: %.2lf\n", hypo(one, two));

   system("PAUSE"); 
   return 0;
}

/*-------------------------------------------------------------------------*/

int hypo(double a, double b)
{
    double c;
    c = sqrt((a*a)+(b*b));
    printf("Currently, A = %.2lf, and B = %.2lf, C = %.2lf\n", a, b, c);

    return c;
} 
```

在我的电脑上，它一直工作到最后，Return c; 由于某种原因，它将值 0 返回给 Main 函数。（我测试了错误在哪里，因此在低函数中进行了打印筛选。）

我想明白这一点。

我很确定我的语法有误，或者有些我还没有读过的东西让我不知所措，但是在浏览书籍和检查 youtube 视频一个小时后，我不明白为什么这不起作用.

编辑：

谢谢大家的快速回复！我把它改成了双倍，（也意识到我在这个过程中的错误 xD ）现在它就像一个魅力。很高兴你们都回答得这么快，我一定会转发的:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:11:47.500

您的返回类型是`int`您可能想要的`double`- 小值将被强制转换并导致 0（即 0.5 存储在 0 时为 0 `int`）。

您得到 0 的确切原因是格式不匹配 - 您使用浮点格式打印整数值。对于打印整数使用`%d`，但如果您`hypo`正确指定返回类型 ( `double`)，此问题将消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:12:11.507

您需要将返回类型更改为双精度：

```
double hypo(double a, double b)
{
    double c;
    c = sqrt((a*a)+(b*b));
    printf("Currently, A = %.2lf, and B = %.2lf, C = %.2lf\n", a, b, c);

    return c;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:11:10.153

您`hypo`返回了一个`int`，但您正在使用它，就好像它是一个`double`. 您应该将其切换为：

```
double hypo(double a, double b); 
```

并且，在实施中：

```
double hypo(double a, double b)
{
    double c;
    // ... 
```

当您以 形式返回时`int`，结果值`c`将被截断为 ，`int`而不是显示完整值。对于小于 1.0 的任何正数，这将导致它转换为 0。此外，您的格式字符串指定了一个双精度，并且您传递了一个 int，这将导致显示始终打印错误的答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:11:44.393

您已将变量定义`c`为 double 类型：

```
double c; 
```

但是您正在尝试返回`int`：

```
int hypo(double a, double b); 
```

您应该更改 to 的返回类型`hypo`或`double`强制`c`转换为`int`。但是，强制转换会丢弃任何分数（将 2.678 变为 2）：

```
return (int)c; 
```

因此，我建议您将返回类型更改为`double`，这在尝试计算斜边（可能包含小数）时也更合乎逻辑：

```
double hypo(double a, double b); 
```

# php - 有条件的数组排列

> ID：15235116
> 
> 赞同：0
> 
> 时间：2013-03-05T22:08:48.593
> 
> 标签：php, arrays, permutation

这一定很简单，但我的大脑在一天结束时被炒了..请帮助：

```
<?php

    $arr = array(
        array(1, 2, 3),
        array(10, 20, 30),
        array(100, 200, 300),
    );

?> 
```

我需要内部数组的所有可能排列，唯一的例外是每个内部数组的每个元素每个排列只能使用一次。例如：

好的：

```
1-10-100
1-100-10
200-1-10 
```

坏的：

```
1-2-3
30-20-200 
```

可以更改原始布局。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:47:07.830

这适用于任意数量的数组：

```
<?php

$arr = array(
    array(1, 2, 3),
    array(10, 20, 30),
    array(100, 200, 300),
    array(1000, 2000, 3000)
);

function permute($a, $b) {
    $perms = array();
    foreach($a as $va) {
        foreach($b as $vb) {
            $perms[] = sprintf('%s-%s', $va, $vb);
        }
    }
    return $perms;
}

$i=2;
$perms = permute($arr[0], $arr[1]);
while($i<count($arr)) {
    $perms = permute($perms, $arr[$i++]);
}

print_r($perms); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T01:11:42.610

这应该适用于任意数量的数组：

```
<?php
$arr = array(
    array(1, 2, 3),
    array(10, 20, 30),
    array(100, 200, 300),
);
print_r(foo(array(), $arr));

function foo($arr1 = array(), $arr2 = array()) {
    $perm_arr = array();

    // case 1: empty array vs outer array
    // eg: array() vs array(array(1, 2, 3), array(10, 20, 30), array(100, 200, 300))
    // recursively reduce the size of outer array via case 2
    if(empty($arr1) && (isset($arr2[0]) && is_array($arr2[0]))) {
        $arr_top = array();
        $arr_bot = $arr2;

        // get possible arrangements for further reduction
        // eg:
        // array(1, 2, 3) vs array(array(10, 20, 30), array(100, 200, 300)),
        // array(10, 20, 30) vs array(array(1, 2, 3), array(100, 200, 300)),
        // array(100, 200, 300) vs array(array(1, 2, 3), array(10, 20, 30)),
        // ...
        while(0 < count($arr_bot)) {
            $arr = array_shift($arr_bot);
            $arr_edge = array_merge($arr_top, $arr_bot);
            $foo_arr_edge = foo($arr, $arr_edge);

            // append permutations of reduced array
            foreach($foo_arr_edge as $e_edge) {
                $perm_arr[] = $e_edge;
            }

            $arr_top[] = $arr;
        }
    }
    // case 2: inner array vs outer array
    // eg: array(1, 2, 3) vs array(array(10, 20, 30), array(100, 200, 300))
    // reduce the size of outer array until it reaches the base case
    else if(isset($arr1[0]) && (isset($arr2[0]) && is_array($arr2[0]))) {
        $foo_arr2 = array();

        $n_arr2 = count($arr2);
        // if the size of outer array is greater than 2 then reduce it until the size is 2
        if(2 < $n_arr2) {
            $arr_top = array();
            $arr_bot = $arr2;

            // get possible arrangements for further reduction
            // eg:
            // array(1, 2, 3) vs array(10, 20, 30),
            // array(1, 2, 3) vs array(100, 200, 300),
            // array(10, 20, 30) vs array(100, 200, 300),
            // ...
            while(0 < count($arr_bot)) {
                $arr = array_shift($arr_bot);
                $arr_edge = array_merge($arr_top, $arr_bot);
                $foo_arr_edge = foo($arr, $arr_edge);

                foreach($foo_arr_edge as $e_edge) {
                    $foo_arr2[] = $e_edge;
                }

                $arr_top[] = $arr;
            }
        }
        // if the size of outer array is 2 then get the permutations of its elements via the base case
        else if(2 == $n_arr2) {
            $foo_arr2 = foo($arr2[0], $arr2[1]);
        }

        // generate permutations from reduced array
        foreach($arr1 as $e1) {
            foreach($foo_arr2 as $e2) {
                $perm = $e1 .'-'. $e2;
                $perm_arr[] = $perm;
            }
        }
    }
    // base case: inner array vs inner array
    // eg: array(1, 2, 3) vs array(10, 20, 30)
    // generate permutations of two inner arrays
    else if(isset($arr1[0]) && (isset($arr2[0]) && !is_array($arr2[0]))) {
        foreach($arr1 as $e1) {
            foreach($arr2 as $e2) {
                $perm = $e1 .'-'. $e2;
                $perm_arr[] = $perm;
            }
        }
        foreach($arr2 as $e2) {
            foreach($arr1 as $e1) {
                $perm = $e2 .'-'. $e1;
                $perm_arr[] = $perm;
            }
        }
    }

    return $perm_arr;
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:18:33.050

我相信这是您正在寻找的答案：

```
<?php

$nL =   '
';
$arr = array(
        array(1, 2, 3),
        array(10, 20, 30),
        array(100, 200, 300),
    );

foreach ($arr[0] as $key => $val1) {
    foreach ($arr[1] as $val2) {
        foreach ($arr[2] as $val3) {
            echo $val1 . '-' . $val2 . '-' . $val3 . $nL;
        }
    }
}

foreach ($arr[0] as $key => $val1) {
    foreach ($arr[2] as $val2) {
        foreach ($arr[1] as $val3) {
            echo $val1 . '-' . $val2 . '-' . $val3 . $nL;
        }
    }
}

foreach ($arr[1] as $key => $val1) {
    foreach ($arr[0] as $val2) {
        foreach ($arr[2] as $val3) {
            echo $val1 . '-' . $val2 . '-' . $val3 . $nL;
        }
    }
}

foreach ($arr[1] as $key => $val1) {
    foreach ($arr[2] as $val2) {
        foreach ($arr[0] as $val3) {
            echo $val1 . '-' . $val2 . '-' . $val3 . $nL;
        }
    }
}

foreach ($arr[2] as $key => $val1) {
    foreach ($arr[0] as $val2) {
        foreach ($arr[1] as $val3) {
            echo $val1 . '-' . $val2 . '-' . $val3 . $nL;
        }
    }
}

foreach ($arr[2] as $key => $val1) {
    foreach ($arr[1] as $val2) {
        foreach ($arr[0] as $val3) {
            echo $val1 . '-' . $val2 . '-' . $val3 . $nL;
        }
    }
}

echo    'finished';
?> 
```

享受。=)

# c - 在C中释放结构的动态链接列表

> ID：15235120
> 
> 赞同：3
> 
> 时间：2013-03-05T22:09:15.157
> 
> 标签：c, linked-list, memory-management

我有一堆看起来像的结构

```
typedef struct {
  A[1..100] *next; // this is not an array, just indicating A1 or A2 or A3 and so on
  //other stuff that varies from struct to struct
} A[1..100] // A1, A2, and so on 
```

我生成了一些不同的相同类型结构的链表。在函数的某个地方，我用类似的东西分配内存

```
A55 *struct_list;
A55 *next_in_list;

struct_list = (A55 *)malloc(sizeof(A55));
(*struct_list).next = NULL;

//some loop
  next_in_list = (A55 *)malloc(sizeof(A55));
  (*next_in_list).next = struct_list;
  struct_list = next_in_list; 
```

在循环的末尾，`struct_list`是一个指向链表末尾的指针。

我希望有一个函数可以释放任何列表，而不管填充它的结构如何。我觉得以下可能有效，但我需要一些不会违反任何规则并且可能安全实施的东西：

```
void freeStruct(*void start){

     void ** current, * next;
     current = (void **) start;

     do{
       next = *current;
       free(current);
       current = (void **) next;
     }while(current != NULL)
    } 
```

我的问题是 NULL 对于所有类型的所有指针是否具有相同的数值，包括`struct`. 而且，有没有更好的方法来做到这一点，而不必为不同的`struct`定义复制相同的函数 100 次？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:12:54.750

`NULL`始终具有相同的值：0。

你可以做你想做的。这样做的方法是将“下一个”指针放在结构的最开头，因此对于每个结构来说它总是在同一个位置。

如果你有比单个“next”指针更多的结构，你可能应该用它制作一个结构，然后将结构放在每个结构的开头。例如，如果您将使用“prev”和“next”指针创建一个双向链表，我建议使用这两个指针创建一个结构。

如果可以简单地释放每个结构，则只需`free()`在每个指针上调用该函数。如果你有时需要运行一个清理函数，你应该让你的通用链表释放函数获取一个指向清理函数的指针，并在每个结构体在列表中到达时调用清理函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T02:14:50.760

您需要遍历整个列表，同时一次释放一个指针。

# mysql - Perl如何在循环外声明标量变量（my），在循环内增加标量变量，并在循环外使用增加的变量名

> ID：15235122
> 
> 赞同：-2
> 
> 时间：2013-03-05T22:09:18.173
> 
> 标签：mysql, perl, loops, foreach

我对 Perl 很陌生。我正在编写一个 CGI，调用一个调用另一个子例程并显示 HTML 的子例程，在第二个调用的子例程中，我正在执行一个 mysql select 语句并将其设置为一个带有 fetchrow_array 的数组。我将该数组返回为显示 HTML 的子例程。

```
my @agentval = &GetAgent();
my $agentval1;

foreach (@agentval) {
    $agentval1 = $_;
} 
```

我声明了我的变量，然后尝试将 erray 的每个值打印到一个标量变量中，但没有声明所有 26 个标量变量。我正在使用变量来设置显示的 CGI 上的字段值。

我在想我可以用

```
my @agentval = &GetAgent();
my $agentval1;

foreach (@agentval) {
    $agentval1 = $_;
    $agentval1++;
} 
```

我在 $agentval1 ($agentval2...n) 之后的任何内容上都需要明确的包名称

就像我说的，我是一个完全的新手。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:30:32.857

在 Perl 中“增加变量名”是可能的，甚至很容易做到。但这很少是适合这项工作的方法。

您在一个名为 的 Perl 数组中有大约 26 个值`@agentval`，并且您希望将它们加载到 26 个相关的标量中。好吧，您已经这样做了，因为数组只是标量的集合。当您想要访问特定值时，请使用以下`$array[index]`符号：

```
print "<input type='text' name='field10' value='$agentval[9]'>\n"; 
```

在这里，`$agentval[9]`指的是数组的第 10 个元素（因为索引 0 是数组的第一个元素，就像在许多其他语言中一样）`@agentval`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:20:24.267

您是否尝试使用 @agentval 数组的所有内容组成一个变量？在这种情况下，更改 foreach 循环：

```
foreach (@agentval) {
    $agentval1 .= $_;
} 
```

# lucene - Lucene 4.1：索引时如何拆分包含“点”的单词？

> ID：15235126
> 
> 赞同：2
> 
> 时间：2013-03-05T22:09:54.973
> 
> 标签：lucene, lexical-analysis

我试图弄清楚我应该怎么做才能索引包含“。”的关键字。.

例如：this.name

我想索引这些术语：这个和我的索引中的名称。

我使用标准分析仪。我尝试扩展 WhitespaceTokensizer 或扩展 TokenFilter，但我不确定我的方向是否正确。

如果我使用 StandardAnalyser，我将获得“this.name”作为关键字，这不是我想要的，但分析器会为我正确完成其余的工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T06:51:51.400

您可以在 StandardTokenizer 前面放置一个 CharFilter，它将句点和下划线转换为空格。MappingCharFilter 将起作用。

这是添加到精简的 StandardAnalyzer 的 MappingCharFilter（请参阅[此处](http://svn.apache.org/repos/asf/lucene/dev/tags/lucene_solr_4_1_0/lucene/analysis/common/src/java/org/apache/lucene/analysis/standard/StandardAnalyzer.java)的原始 4.1 版本）：

```
import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.charfilter.MappingCharFilter;
import org.apache.lucene.analysis.charfilter.NormalizeCharMap;
import org.apache.lucene.analysis.core.LowerCaseFilter;
import org.apache.lucene.analysis.core.StopAnalyzer;
import org.apache.lucene.analysis.core.StopFilter;
import org.apache.lucene.analysis.standard.StandardFilter;
import org.apache.lucene.analysis.standard.StandardTokenizer;
import org.apache.lucene.analysis.util.StopwordAnalyzerBase;
import org.apache.lucene.util.Version;

import java.io.IOException;
import java.io.Reader;

public final class MyAnalyzer extends StopwordAnalyzerBase {
  private int maxTokenLength = 255;
  public MyAnalyzer() {
    super(Version.LUCENE_41, StopAnalyzer.ENGLISH_STOP_WORDS_SET);
  }

  @Override
  protected TokenStreamComponents createComponents
      (final String fieldName, final Reader reader) {
    final StandardTokenizer src = new StandardTokenizer(matchVersion, reader);
    src.setMaxTokenLength(maxTokenLength);
    TokenStream tok = new StandardFilter(matchVersion, src);
    tok = new LowerCaseFilter(matchVersion, tok);
    tok = new StopFilter(matchVersion, tok, stopwords);
    return new TokenStreamComponents(src, tok) {
      @Override
      protected void setReader(final Reader reader) throws IOException {
        src.setMaxTokenLength(MyAnalyzer.this.maxTokenLength);
        super.setReader(reader);
      }
    };
  }

  @Override
  protected Reader initReader(String fieldName, Reader reader) {
    NormalizeCharMap.Builder builder = new NormalizeCharMap.Builder();
    builder.add(".", " ");
    builder.add("_", " ");
    NormalizeCharMap normMap = builder.build();
    return new MappingCharFilter(normMap, reader);
  }
} 
```

这是一个快速测试来证明它是有效的：

```
import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.BaseTokenStreamTestCase;

public class TestMyAnalyzer extends BaseTokenStreamTestCase {
  private Analyzer analyzer = new MyAnalyzer();

  public void testPeriods() throws Exception {
    BaseTokenStreamTestCase.assertAnalyzesTo
    (analyzer, 
     "this.name; here.i.am; sentences ... end with periods.",
     new String[] { "name", "here", "i", "am", "sentences", "end", "periods" } );
  }

  public void testUnderscores() throws Exception {
    BaseTokenStreamTestCase.assertAnalyzesTo
        (analyzer,
         "some_underscore_term _and____ stuff that is_not in it",
         new String[] { "some", "underscore", "term", "stuff" } );
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:41:29.710

您被[此处记录](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/analysis/standard/StandardTokenizer.html)的行为所吸引：

> 但是，后面没有空格的点被视为标记的一部分。

`StandardTokenizer`引入了一些比您可能不想要的更复杂的解析规则。尤其是这个，旨在防止对 URL、IP、标识符等进行标记化。更简单的实现可能会满足您的需求，例如[`LetterTokenizer`](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/analysis/LetterTokenizer.html).

如果这不能真正满足您的需求（结果很可能是把婴儿和洗澡水一起扔出去），那么您可能需要修改`StandardTokenizer`自己，Lucene 文档明确鼓励这样做：

> 许多应用程序都有特定的标记器需求。如果此分词器不适合您的应用程序，请考虑将此源代码目录复制到您的项目并维护您自己的基于语法的分词器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T02:49:31.500

Sebastien Dionne：我不明白如何拆分单词，我必须逐个 char 解析文档吗？

Sebastien Dionne：我仍然想知道如何将令牌拆分为多个部分，并将它们全部索引

* * *

您可能必须编写自定义分析器。

Analyzer 是 Tokenizer 和可能的 TokenFilter 实例链的组合。

Tokenizer ：接收您可能作为 java.io.Reader 传递的输入文本。它
只是分解文本。不改变，只是分解。

TokenFilter : 接受 Tokenizer 发出的令牌，添加/删除/更改令牌并一一发出相同的令牌，直到全部完成。

如果它根据要求用多个令牌替换一个令牌，则将所有令牌缓冲，将它们一一发送到索引器。

您可以查看以下资源，不幸的是，您可能需要注册试用会员资格。

通过编写自定义分析器，您可以按照自己的方式分解文本。您甚至可以使用一些现有的组件，例如 LowercaseFilter。幸运的是，如果您无法在内置或 Web 上找到它，则可以使用 Lucene 提供一些可以满足您的目的的分析器。

“[编写自定义过滤器：Lucene in Action 2](http://my.safaribooksonline.com/book/web-development/seo/9781933988177/extending-search/ch06lev1sec4) ”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:23:58.553

如果我理解正确，您需要使用删除点的标记器 - 也就是说，任何包含点的名称都应在该点拆分（“here.i.am”变为“here”+“i”+“是”）。

# sencha-touch-2 - 无法编辑来自 Sencha Touch Architect 商店的容器上的数据

> ID：15235128
> 
> 赞同：0
> 
> 时间：2013-03-05T22:09:59.390
> 
> 标签：sencha-touch-2, sencha-architect

我正在使用 Sencha Architect 2.1

我有一个 Store 和一个 Container，但如何使用容器呈现来自 Store 的数据？

我制作了一个 1 分钟的视频来解释这个问题：

[http://www.youtube.com/watch?v=_HpR9h80D94](http://www.youtube.com/watch?v=_HpR9h80D94)

换句话说，这就是我想在 Secha Designer 2 中做的事情：

```
data: ordersStoreId.getData(), 
```

完成：

```
 xtype: 'container',
            title: 'MyContainer6',
            iconCls: 'info',
            data: ordersStoreId.getData(),
            tpl: [
                'Testing: {status}'
            ] 
```

任何想法？谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:37:58.197

所以这看起来像一个错误。我想解决此问题的一种方法是将`show`侦听器添加到您的容器中，然后您可以从`store`.

```
listeners: {
    show: function(this, opts){
        this.setData( Ext.getStore('yourStore').getData() );
    }
} 
```

所以在建筑师：

1) 选择您的容器

2）在您的配置窗口中，`Event Bindings`通过单击`+`图标添加一个并选择`Basic Event Binding`

`show`3）按照我的建议选择事件名称。然后，您将看到一个可编辑的代码视图，您可以在其中放置代码。前任：

```
this.setData( Ext.getStore('yourStore').getData() ); 
```

希望这可以帮助。

# c# - 使用 peek 的线程安全重入队列

> ID：15235130
> 
> 赞同：1
> 
> 时间：2013-03-05T22:10:14.320
> 
> 标签：c#, thread-safety, queue, peek

我的基本问题是，如果队列为空，则需要立即处理队列中的项目，或者如果已处理项目，则将项目添加到队列中并离开。

我正在尝试一种使用 peek 来简化事情的技术，并且想知道可能会遇到什么问题。谢谢！

```
 void SequenceAction(Action action) {
       bool go = false;

       lock (_RaiseEventQueueLock) {
          _RaiseEventQueue.Enqueue(action);
          go = (_RaiseEventQueue.Count == 1); 
       }

       // 'go' can only be true if queue was empty when queue 
       //  was locked and item was enqueued.
       while (go) {
          #if naive_threadsafe_presumption 
          // Peek is threadsafe because in effect this loop owns
          //  the zeroeth item in the queue for as long as the queue 
          //  remains non-empty.
          (_RaiseEventQueue.Peek())();

          #else
          Action a;
          lock (_RaiseEventQueueLock) {
             a = _RaiseEventQueue.Peek();
          }
          a();
          #endif   

          // Lock the queue to see if any item was enqueued while
          //  the zeroeth item was being processed.
          // Note that the code processing an item can call this 
          //  function reentrantly, adding to its own todo list
          //  while insuring that that each item is processed 
          //  to completion.
          lock (_RaiseEventQueueLock) {
             _RaiseEventQueue.Dequeue();
             go = (_RaiseEventQueue.Count > 0); 
          }
       }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T03:56:54.563

实际上，您`Peek`的不是线程安全的。将项目添加到队列可能会导致后备存储（最终是一个数组）被调整大小。我想队列是在循环缓冲区中实现的，带有用于插入和删除的头和尾索引。

所以想象一下如果队列中有 16 个项目会发生什么。Insert 在 8，Remove 在 9。队列已满。然后会发生这种情况：

1.  线程 A 调用 Peek，检索删除索引 (9)。
2.  线程 A 被换出。
3.  线程 B 调用 Enqueue 并看到它必须增加队列。
4.  线程 B 分配一个包含 32 项的新数组并从现有数组中复制数据。数据按顺序复制，从 Remove 开始并环绕。
5.  线程 B 将 Remove 设置为 0 并将 Insert 设置为 16。
6.  线程 A 获取下一个时间片并返回位置 9 处的项目。
7.  你刚刚处理了一个乱序的事件，你最终会再次处理它。
8.  更糟糕的是，您将删除位置 0 处的项目而不对其进行处理。

您*可能*可以通过以下方式解决该问题：

```
Action nextAction;
lock (_RaiseEventQueueLock)
{
    nextAction = _RaiseEventQueue.Peek();
}
nextAction(); 
```

不过，我不会把我的职业生涯押在上面。我建议使用[BlockingCollection](http://msdn.microsoft.com/en-us/library/dd267312.aspx)和生产者/消费者设计。

**可能的修复**

在我看来，以下内容应该符合您的预期。

```
private readonly object _queueLock = new object();
private readonly object _processLock = new object();

void SequenceAction(Action action)
{
    lock (_queueLock)
    {
        _RaiseEventQueue.Enqueue(action);
    }
    if (Monitor.TryEnter(_processLock))
    {
        while (true)
        {
            Action a;
            lock (_queueLock)
            {
                if (_RaiseEventQueue.Count == 0) return;
                a = _RaiseEventQueue.Dequeue();
            }
            a();
        }
        Monitor.Exit(_processLock);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T01:19:10.360

```
 // If action already in progress, add new
    //  action to queue and return.
    // If no action in progress, begin processing
    //  the new action and continue processing
    //  actions added to the queue in the meantime.
    void SequenceAction(Action action) {
       lock (_SequenceActionQueueLock) {
          _SequenceActionQueue.Enqueue(action);
          if (_SequenceActionQueue.Count > 1) {
             return;
          }
       }
       // Would have returned if queue was not empty
       //  when queue was locked and item was enqueued.
       for (;;) {
          action();
          lock (_SequenceActionQueueLock) {
             _SequenceActionQueue.Dequeue();
             if (_SequenceActionQueue.Count == 0) {
                return;
             }
             action = _SequenceActionQueue.Peek();
          }
       }
    } 
```

# php - str_getcsv 到关联数组？

> ID：15235132
> 
> 赞同：0
> 
> 时间：2013-03-05T22:10:23.507
> 
> 标签：php, multidimensional-array

我有以下代码可以生成一个非常好的索引数组 -

```
<?php
// reads csv file and returns an array of rows
function read_csv($filename){
$rows = array();
foreach (file($filename, FILE_IGNORE_NEW_LINES) as $line){
$rows[] = str_getcsv($line, $delimiter = '; ', $escape = '\''); 
} 
return $rows;
}        
?> 
```

输出看起来像 -

```
Array
        (
            [0] => Array
                (
                [0] => value
                [1] => value
                [2] => value
                [3] => value
                [4] => value
                [5] => value
                [6] => value
                [7] => value
                [8] => value
                [9] => value
                [10] => value
                [11] => value
                [12] => value
                [13] => value
                [14] => value
                [15] => value
                [16] => value
                [17] => value
                [18] => value
                [19] => value
                [20] => value
) 
```

是否可以将内部数组的指针设置为如下所示 -

```
Array
        (
        [0] => Array
            (
                [label 1] => value
                [label 1] => value
                [label 2] => value
                [label 3] => value
                [label 4] => value
                [label 5] => value
                [label 6] => value
                [label 7] => value
                [label 8] => value
                [label 9] => value
                [label 10] => value
                [label 11] => value
                [label 12] => value
                [label 13] => value
                [label 14] => value
                [label 15] => value
                [label 16] => value
                [label 17] => value
                [label 18] => value
                [label 19] => value
                [label 20] => value
) 
```

我不确定如何让 str_getcsv 做到这一点。也许在 str_getcsv 函数之前定义数组的元素（不知道该怎么做）？？？寻找类似于关联数组的东西......

# javascript - JavaScript：用表单字段填充数组

> ID：15235135
> 
> 赞同：1
> 
> 时间：2013-03-05T22:10:39.397
> 
> 标签：javascript, arrays, forms

我正在尝试使用 JavaScript 和 HTML 表单元素填充和解析数组。以下测试产生预期结果（“Test1 Test2 Test3”呈现在目标 div 中）。这是工作测试代码：

```
<div>
    <span id="put-stuff-here"></span>
    <span id="put-stuff-here2"></span>
    <span id="put-stuff-here3"></span>
</div>

<script type="text/javascript">
    var itemSelected = { 'fields': [ 'Test1', 'Test2', 'Test3' ] }
    document.getElementById('put-stuff-here').innerHTML = itemSelected.fields[0];
    document.getElementById('put-stuff-here2').innerHTML = itemSelected.fields[1];
    document.getElementById('put-stuff-here3').innerHTML = itemSelected.fields[2];      
    })
</script> 
```

但是，当我尝试使用表单字段定义变量“itemSelected”时，目标 div 中没有呈现任何内容。这是非工作代码：

```
<div>
    <form>
        <select id="getItem">
            <option value="{ 'fields': [ 'Test1', 'Test2', 'Test3' ] }">ItemName</option>
            <option value="{ 'fields': [ 'Test4', 'Test5', 'Test6' ] }">ItemName2</option>
        </select>
    </form>
</div>

<div>
    <span id="put-stuff-here"></span>
    <span id="put-stuff-here2"></span>
    <span id="put-stuff-here3"></span>
</div>

<script type="text/javascript">
    $("#getItem").change(function () {
        var itemSelected = $(this).val();
        document.getElementById('put-stuff-here').innerHTML = itemSelected.fields[0];
        document.getElementById('put-stuff-here2').innerHTML = itemSelected.fields[1];
        document.getElementById('put-stuff-here3').innerHTML = itemSelected.fields[2];      
    })
    .change();
</script> 
```

由于某种原因，传递给“itemSelected”的值不会作为数组处理。我希望这里的人会好心看看，也许会提出一个解决方案。

谢谢，

-迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:19:45.277

它不起作用的原因是因为值`select`是 a`string`而不是 a`object` 你可以用`jQuery.parseJSON`它来把它变成一个对象。

更改 `var itemSelected = $(this).val();` 为 `var itemSelected = $.parseJSON($(this).val());`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:23:49.533

来自您的表单的值是一个字符串，这就是为什么它没有按照您的意愿去做。我建议更改您的表单值：

```
<select id="getItem">
  <option value="Test1,Test2,Test3">ItemName</option>
  <option value="Test4,Test5,Test6">ItemName2</option>
</select> 
```

然后修改您的事件处理程序：

```
var itemSelected = $(this).val().split(','); 
```

那会给你你的数组。假设`fields`只是达到目的的一种手段，如果您出于其他原因仍然需要它，`itemSelected.fields`当然只需将您的数组分配给即可。

# ios - 使用背景颜色绘制 GMSPolyline

> ID：15235136
> 
> 赞同：1
> 
> 时间：2013-03-05T22:10:42.543
> 
> 标签：ios, google-maps-sdk-ios, mkpolygon

我看到`GMSPolyline`协议已经`color`为其描边颜色定义了一个属性，但是有没有办法对其多边形内部进行着色（最好是透明的）？我正在寻找相当于`MKPolygon`和朋友的谷歌地图。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T19:54:38.443

There is a way, you can get something like this:

![Polygons example](../Images/aa93626ce62bce5a390c21994ec2d912.png)

The approach is rather simple:

*   Add transparent noninteracting UIView with overriden drawing code and pass it CGPoints for drawing polygons
*   Get your `CLLocationCoordinate2D` coordinates for polygons and convert them to `CGPoints` for drawing
*   Update those `CGPoints` every time map moves so you can redraw them in the right position and make that `UIView` redraw itself.

So, what you want to do is add an `UIView` on top of your mapview, which is transparent and non-userinteractive, which has overridden `drawRect` method. It is provided with a double array of CGPoints, like `CGpoint **points,` acccessed with `points[i][j]` where *i* is each of closed polygons and *j* are individual points of each polygon. The class would be, let's call it OverView:

```
#import "OverView.h"

@interface OverView ()
{
    CGPoint **points;
    int *pointsForPolygon;
    int count;
}

@end

@implementation OverView

- (id)initWithFrame:(CGRect)frame andNumberOfPoints:(int)numpoints andPoints:(CGPoint **)passedPoints andPointsForPolygon:(int *)passedPointsForPolygon;{
    self = [super initWithFrame:frame];
    if (self) {

        // You want this to be transparent and non-user-interactive

        self.userInteractionEnabled = NO;
        self.backgroundColor = [UIColor clearColor];

        // Passed data

        points = passedPoints; // all CGPoints
        pointsForPolygon = passedPointsForPolygon; // number of cgpoints for each polygon
        count = numpoints; // Number of polygons
    }
    return self;
}

// Only override drawRect: if you perform custom drawing.
// An empty implementation adversely affects performance during animation.

- (void)drawRect:(CGRect)rect
{

    for(int i=0; i<count; i++) // For each of polygons, like blue ones in picture above
    {
        if (pointsForPolygon[i] < 2) // Require at least 3 points
            continue;

        CGContextRef context = UIGraphicsGetCurrentContext();

        CGContextSetStrokeColorWithColor(context, [UIColor redColor].CGColor);
        CGContextSetRGBFillColor(context, 0.0, 0.0, 1.0, 1.0);

        CGContextSetLineWidth(context, 2.0);

        for(int j = 0; j < pointsForPolygon[i]; j++)
        {
            CGPoint point = points[i][j];

            if(j == 0)
            {
                // Move to the first point
                CGContextMoveToPoint(context, point.x, point.y);
            }
            else
            {
                // Line to others
                CGContextAddLineToPoint(context, point.x, point.y);
            }
        }

        CGContextClosePath(context); // And close the path
        CGContextFillPath(context);
        CGContextStrokePath(context);
    }
}

@end 
```

Now, in original `UIViewController` with mapview, you need to have access to all coordinates that make all the polygons (same array as points, but consisting of `CLLocationCoordinate2D`, and several others:

```
@interface ViewController () <GMSMapViewDelegate>
{
    CGPoint **points;
    int howmanypoints;
    int *pointsForPolygon;
    CLLocationCoordinate2D **acoordinates;
} 
```

`acoordinates` is populated wherever you get your coordinates for polygons, I parse the response string from Fusion Tables, part of my parser method

```
- (void)parseResponse2
{
    NSMutableArray *fullArray = [[self.fusionStringBeaches componentsSeparatedByString:@"\n"] mutableCopy];

    howmanypoints = fullArray.count; // This is number of polygons

    pointsForPolygon = (int *)calloc(howmanypoints, sizeof(int)); // Number of points for each of the polygons
    points = (CGPoint **)calloc(howmanypoints, sizeof(CGPoint *));
    acoordinates = (CLLocationCoordinate2D **)calloc(howmanypoints, sizeof(CLLocationCoordinate2D *));

    for(int i=0; i<fullArray.count; i++)
    {

        // Some parsing skipped here

        points[i] = (CGPoint *)calloc(koji, sizeof(CGPoint));
        acoordinates[i] = (CLLocationCoordinate2D *)calloc(koji, sizeof(CLLocationCoordinate2D));
        pointsForPolygon[i] = koji;

        if (koji > 2)
        {
            // Parsing skipped                
            for (int j=0; j<koji; j++)
            {
                CLLocationCoordinate2D coordinate = CLLocationCoordinate2DMake(coordinates[j].latitude, coordinates[j].longitude);

                // Here, you convert coordinate and add it to points array to be passed to overview
                points[i][j] = [self.mapView.projection pointForCoordinate:coordinate];
                // and added that coordinate to array for future access
                acoordinates[i][j] = coordinate;
            }
        }
    }

    // Finally, allocate OverView passing points array and polygon and coordinate counts
    self.overView = [[OverView alloc] initWithFrame:self.view.bounds
                                  andNumberOfPoints:howmanypoints
                                          andPoints:points
                                andPointsForPolygon:pointsForPolygon];

     // And add it to view
    [self.view addSubview:self.overView];

} 
```

Now, you have Polygons where you want them, but must observe `- (void)mapView:(GMSMapView *)mapView didChangeCameraPosition:(GMSCameraPosition *)position` delegate method as drawn polygons won't move with map. The trick is that you have your 2D array of coordinates `acoordinates` and you can user helper function `(CGPoint *)[self.mapview.projection pointForCoordinate:(CLLocationCoordinate2D)coordinate]` to recalculate the positions, like:

```
- (void)mapView:(GMSMapView *)mapView didChangeCameraPosition:(GMSCameraPosition *)position
{    
    if (points != nil)
    {
        // Determine new points to pass
        for (int i=0; i<howmanypoints; i++)
        {
            for(int j=0; j<pointsForPolygon[i]; j++)
            {
                // Call method to determine new CGPoint for each coordinate
                points[i][j] = [self.mapView.projection pointForCoordinate:acoordinates[i][j]];
            }
        }

        // No need to pass points again as they were passed as pointers, just refresh te view    
        [self.overView setNeedsDisplay];
    }

} 
```

And that's it. Hope you got the gist of it. Please, comment if I need to clarify something. I can also make a small complete project and upload it to github so you can research it better.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T23:34:59.197

折线不同于多边形。折线没有填充颜色的概念。提交将多边形添加到 SDK的[功能请求。](https://code.google.com/p/gmaps-api-issues/issues/entry?template=Maps%20SDK%20for%20iOS%20-%20Feature%20Request)

# php - .htaccess RewriteRule 用于 URL Shortener

> ID：15235137
> 
> 赞同：0
> 
> 时间：2013-03-05T22:10:48.253
> 
> 标签：php, .htaccess, mod-rewrite, url-shortener

我正在尝试建立一个非常基本的 URL 缩短网站。我在本教程中使用了几乎所有 basixnick 的编码（[https://www.youtube.com/watch?v=ZnthmFQKlVY](https://www.youtube.com/watch?v=ZnthmFQKlVY)所有 3 个部分），但我遇到了问题。

当您在缩短收件箱中输入 URL 时，例如 www.google.com，您将获得相应的缩短代码。然后，当您复制并粘贴 URL（例如 www.mysite.com/xyz123）时，它会将您重定向到 www.mysite.com/www.google.com 而不是简单的 www.google.com。

.htaccess 看起来像这样。RewriteRule 有问题吗？

```
<Files .htaccess>
order allow,deny
</Files>

Options +FollowSymLinks
RewriteEngine On

RewriteRule ^(\w+)$ ./load.php?code=$1 
```

编辑提问：

这是我的 load.php 文件：

```
<?php
$code = $_GET['code'];

require("./connect.php");

$query = mysql_query("SELECT * FROM items WHERE code='$code'");
$numrows = mysql_num_rows($query);

if ($numrows == 1) {
    $row = mysql_fetch_assoc($query);
    $url = $row['url'];

    header("Location: $url");
}
else
    echo "No shortened url was found.";

mysql_close();

?> 
```

当我删除 'header(...)' 代码并将其替换为 'echo "$url";' 长网址会很好地回显。所以到目前为止一切正常。也许它是“标题（...）”行。你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:24:10.243

有问题`load.php`，重写规则没有问题。看起来重定向代码正在重定向到`/www.google.com`而不是`www.google.com`.

* * *

编辑：

如果`$url`变量是字面意思`www.google.com`，那么这就是问题所在。浏览器将假定这`www.google.com`是一个相对 URI，并将其附加到它用于发出请求的 URL 路径中，`http://www.mysite.com/www.google.com`.

您要么需要使缩短的 URL 包含协议（例如`http://`或`https://`），要么将协议设置为一个或另一个：

```
header("Location: http://$url"); 
```

# java - 显示标签未在 jsp 中显示详细信息

> ID：15235138
> 
> 赞同：1
> 
> 时间：2013-03-05T22:10:50.760
> 
> 标签：java, jsp, jsp-tags, displaytag

无法在我的显示标签中获取 bean 的值.. 显示以下错误

```
 String sql;
        List<AcceptBean> list = new ArrayList<AcceptBean>();

        PreparedStatement prest = (PreparedStatement) conn.prepareStatement(occQuery);
        ResultSet rs = prest.executeQuery(occQuery);

        System.out.println(rs);
        String first = "";
        String last = "";
        String vill = "";
        String son = "";
        String dist = "";
        while (rs.next()) {

           AcceptBean bean = new AcceptBean();

           bean.setFirstName(rs.getString("FirstName"));

           bean.setLastName(rs.getString("LastName"));
           bean.setVillage(rs.getString("Village"));
           bean.setSonOf(rs.getString("SonOf"));
           bean.setDistrict(rs.getString("District"));
           list.add(bean);
}

       // list.add(objBean);
        System.out.println("list vlues in servelet" + list.get(0));
        System.out.println("list detials inserted");
        request.setAttribute("list1", list);

        ServletContext context = getServletContext();
        RequestDispatcher rd = context.getRequestDispatcher("/Report.jsp");
        System.out.println("request dispatched");
        rd.forward(request, response); 
```

这是我的jsp代码

```
 <display:table name="requestScope.list1"  >
               <display:column property="firstname" title="First Name"></display:column>
                <display:column property="lastname" title="Last Name"   ></display:column>
                <display:column property="sonof" title="Father's Name"  ></display:column>
                <display:column property="district" title="District"  ></display:column>
                <display:column property="village" title="Village"  ></display:column>
            </display:table> 
```

错误异常：[.LookupUtil] 在对象类型“ColdStorage.AcceptBean”中查找属性“firstname”时出错。原因：类'class ColdStorage.AcceptBean'上的未知属性'firstname'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:36:58.287

1.  当然。如果您不能将对象放入其中，那么列表的意义何在？它应该被声明和初始化为

    ```
    List<AcceptBean> list = new ArrayList<AcceptBean> 
    ```

    尽管。

2.  问题是您告诉标签在名为“list”的请求属性中查找列表，但它存储在名为“list1”的请求属性中。

3.  就像您所做的那样，当然您应该在 wile 循环内创建一个新的 AcceptBean，并将其添加到 while 循环内的列表中。否则，您的列表中将只有一个对象，其中包含从数据库中检索到的最后一行：

    ```
    List<AcceptBean> list = new ArrayList<AcceptBean>();

    PreparedStatement prest = (PreparedStatement) conn.prepareStatement(occQuery);
    ResultSet rs = prest.executeQuery();
    while (rs.next()) {
        AcceptBean bean = new AcceptBean();
        bean.setFirstName(rs.getString("FirstName"));
        bean.setLastName(rs.getString("LastName"));
        bean.setVillage(rs.getString("Village"));
        bean.setSonOf(rs.getString("SonOf"));
        bean.setDistrict(rs.getString("District"));
        list.add(bean);
    }

    request.setAttribute("list1", list); 
    ```

4.  不。你为什么不阅读标签文档？它解释了如何使用它，属性是什么，并包含大量示例。

5.  往上看。

# python - 如何使用 Python 密钥环检索用户名？

> ID：15235139
> 
> 赞同：6
> 
> 时间：2013-03-05T22:10:54.473
> 
> 标签：python, windows, python-keyring

我的 Windows 7 机器上有一个 Mercurial 密钥环。我正在使用 Python[`keyring`](https://pypi.python.org/pypi/keyring)库从 Mercurial 密钥环获取用户凭据。

我可以通过以下方式检索给定用户名的密码：

```
keyring.get_password('Mercurial', 'user@@etc') 
```

是否有类似的功能来检索用户名？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2018-02-16T16:39:46.323

虽然`keyring`仅设计用于存储密码，但您可以滥用`get_password`单独存储用户名。

```
import keyring

# store username & password
keyring.set_password("name_of_app", "username", "user123")
keyring.set_password("name_of_app", "password", "pass123")

# retrieve username & password
username = keyring.get_password("name_of_app", "username")
password = keyring.get_password("name_of_app", "password") 
```

或者，如果您想保持用户名与密码配对：

```
import keyring

service_id = "name_of_app"
username = "user123"

# store username & password
keyring.set_password(service_id, "username", username)
keyring.set_password(service_id, username, "pass123")

# retrieve username & password
username = keyring.get_password(service_id, "username")
password = keyring.get_password(service_id, username) 
```

感谢Dustin [Wyatt](https://stackoverflow.com/a/31882203/3357935)和[Alex Chan](https://twitter.com/alexwlchan/status/964531327096717312)的解决方案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-05T22:13:06.010

您应该将用户名存储在其他地方。

密钥环仅存储密码，由应用程序名称和用户名键入。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2019-01-08T12:25:03.457

在 Windows 上，我能够使用获得用户名和密码（即“凭据”）

`c = keyring.get_credential("servicename", None)`

请注意，这在 macOS 上不起作用，`keyring`后端没有搜索条目的功能 - 即您需要知道用户名。不过，我想本机代码可以让你这样做，请参阅[官方文档](https://developer.apple.com/documentation/security/keychain_services/keychain_items/searching_for_keychain_items)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-10-07T10:11:45.543

如果您还想在脚本中隐藏您的用户名，您可以使用密钥环模块的凭据。另外我建议使用 getpass 库来输入密码；这可以防止将密码打印到屏幕上。最后，一旦发现登录失败，您可能希望在代码中的某处删除凭据。否则脚本会在不提示用户的情况下重新启动。作为一个完整的例子。这是您检索用户名和密码的方法

```
import getpass
import keyring
import requests

service_name = "Name of the keyring"
credentials = keyring.get_credential(service_name, None)
if credentials is None:
    username = input("Username: ")
    password = getpass.getpass()
    keyring.set_password(service_name,username, password)
else:
    username = credentials.username
    password = credentials.password 
```

然后你可以做你的事，例如使用对 api 的请求来发帖。如果失败，请删除密钥环以强制再次询问凭据。

```
response = requests.post('url_to_api', auth=requests.auth.HTTPBasicAuth(username, password))
try:
    response.raise_for_status()
except requests.exceptions.HTTPError as err:
    keyring.delete_password(service_name, username)
    raise 
```

如果登录成功，下次就不用再输入用户名和密码了。

# linux - 当函数运行的命令中有空格时，如何在 .bashrc 中创建一个可以正常工作的函数？

> ID：15235141
> 
> 赞同：0
> 
> 时间：2013-03-05T22:11:10.933
> 
> 标签：linux, bash, unix, terminal

我在 ~/.bashrc 中有这个函数，用于从终端创建一个永久别名：

```
function permalias ()
{
  alias "$*";
  echo alias "$*" >> ~/.bashrc
} 
```

问题是它没有考虑到我正在为其创建别名的命令中可能有空格，所以`permalias ll='ls -l'`下次我打开终端时类似的东西将无法正常工作。

如何让它发挥作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:23:20.113

只需将引号添加到 ~/.bashrc：

```
 echo alias "'$*'" >> ~/.bashrc 
```

# php - 打开可执行文件

> ID：15235143
> 
> 赞同：3
> 
> 时间：2013-03-05T22:11:21.800
> 
> 标签：php, exec, executable

我有这个代码来打开一个可执行文件：

```
exec("C:/Users/Affex/Desktop/Blockland/".$session->username."/".$session->username.".exe        ptlaaxobimwroe -dedicated"); 
```

它会打开我希望它打开的文件，但它会一直加载页面，直到 php.ini 以最大执行时间启动。

我正在尝试为我的免费托管服务 BIOHazardHosting.co.uk 设置一个游戏面板，除此之外，我们已经对其他所有内容进行了排序。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T22:14:48.603

`start`尝试在命令的开头添加一个：

```
exec("start C:/Users/Affex/Desktop/Blockland/".$session->username."/".$session->username.".exe        ptlaaxobimwroe -dedicated"); 
```

* * *

作为 linux 中的旁注，您可以`&`在命令末尾附加一个以实现相同的结果：

```
exec("/Users/Affex/Desktop/Blockland/".$session->username."/".$session->username.".exe        ptlaaxobimwroe -dedicated &"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:18:28.563

您可以禁用脚本中的限制：

```
set_time_limit(0); 
```

# python - 使用 __import__ 获取“没有属性”错误

> ID：15235145
> 
> 赞同：3
> 
> 时间：2013-03-05T22:11:34.763
> 
> 标签：python

我遇到了一个奇怪的问题，我在搜索中没有发现任何类似的问题；这可能意味着这个问题很明显，我只是没有看到它。我有一个名为 modulefile.py 的类模块，位于名为 modulefolder 的文件夹中。这是模块文件.py：

```
class moduleclass(object):
    def __init__(self):
        self.parameter = 5 
```

现在，在我的 test1.py 文件中，我这样做：

```
from modulefolder.modulefile import moduleclass
myobj = moduleclass()
print myobj.parameter 
```

这很好用 - 它按预期打印值 5。

现在，我的问题是，在我的应用程序中，直到运行时我才知道模块文件夹、模块文件和模块类。它们将以字符串的形式提供给我。所以我试了一下，这是test2.py：

```
module = __import__("modulefolder.modulefile", fromlist=["moduleclass"])
myobj = getattr(module, "moduleclass")
print myobj.parameter 
```

这不起作用，我得到一个错误`AttributeError: type object 'moduleclass' has no attribute 'parameter'`。

所以，这就是让我困惑的地方。在 test1.py 和 test2.py 中，我将打印语句更改为`print dir(myobj)`，我得到了这个：

对于 test1.py：

```
['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'parameter'] 
```

对于 test2.py

```
['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__'] 
```

因此，很明显，第二种导入方法缺少我的“参数”属性。问题是，我不知道为什么。

为什么这种动态导入方法会影响实例化对象的工作方式？我能做些什么来解决它？

我已经搜索了高低寻找答案，所以这可能是我忽略的一些简单的事情，或者只是不完全理解。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:14:02.503

您不会在以下位置实例化您的课程`test2.py`：

```
myobj = getattr(module, "moduleclass")() 
```

# c - 我可以使用 C-preprocssor 将整数转换为字符串吗？

> ID：15235149
> 
> 赞同：5
> 
> 时间：2013-03-05T22:11:42.023
> 
> 标签：c

必须有办法做到这一点...

我有一个头文件，version.h，一行...

```
#define VERSION 9 
```

并且一些文件使用 VERSION 的定义值作为整数。没关系。

在不改变 VERSION 的定义方式的情况下，我需要构建一个包含该值的初始化“what”字符串，所以我需要这样的东西......

```
char *whatversion = "@(#)VERSION: " VERSION; 
```

显然这不会编译，所以我需要以某种方式获取 VERSION 的预处理值的字符串，基本上给出这个......

```
char *whatversion = "@(#)VERSION: " "9"; 
```

有任何想法吗？这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T22:19:12.283

它不是数据类型，而是令牌。一团文字。

`K & R`谈论连接值：

```
 The preprocessor operator ## provides a way to concatenate actual arguments
 during macro expansion. If a parameter in the replacement text is adjacent
 to a ##, the parameter is replaced by the actual argument, the ## and
 surrounding white space are removed, and the result is re-scanned. For example,
 the macro paste concatenates its two arguments:

    #define paste(front, back) front ## back

    so paste(name, 1) creates the token name1. 
```

——试试看。#在你到达之前定义字符串`char *version=`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T00:11:18.090

在宏中，您可以使用“stringify”运算符 ( `#`)，它会完全按照您的要求进行操作：

```
#define STR2(x) #x
#define STR(x) STR2(x)
#define STRING_VERSION STR(VERSION)

#define VERSION 9

#include <stdio>
int main() {
  printf("VERSION = %02d\n", VERSION);
  printf("%s", "@(#)VERSION: " STRING_VERSION "\n");
  return 0;
} 
```

是的，您确实需要宏调用中的双重间接。没有它，你会得到`"VERSION"`而不是`"9"`.

[您可以在gcc 手册](http://gcc.gnu.org/onlinedocs/cpp/Stringification.html)中阅读更多相关信息（尽管它是完全标准的 C/C++）。

# flash - Adobe Flex 闪存屏幕在启动前有 4 秒的延迟

> ID：15235150
> 
> 赞同：1
> 
> 时间：2013-03-05T22:11:43.110
> 
> 标签：flash, apache-flex, internet-explorer, actionscript, flash-builder

我有一个系统，它有一个加载 Flex 模块的应用程序。我看到的是我发出加载应用程序的请求，并且在应用程序中调用 Initialize 之前有 4 秒的延迟。然后一切正常运行，直到我发出网络请求，然后在请求发出之前还有 4 秒的延迟。

我发现 IE 9 上的 Flash 11.5 很慢，甚至最新的 11.6 在 IE 8 上也很慢。但是如果我将 IE9 更新到 11.6，或者从 firefox 运行它，一切都会毫无延迟地工作。

我使用的是 FlashBuilder 4.6，但使用的是 4.5.1A SDK。

有人有想法么？

# qt - 如何在不缩放的情况下显示/屏蔽图像的一部分 - QtQuick/QML

> ID：15235160
> 
> 赞同：1
> 
> 时间：2013-03-05T22:12:19.073
> 
> 标签：qt, audio, qml, qt-quick, qtquick2

我正在尝试用 QtQuick 制作一个简单的音频表。仪表图形来自PNG文件，当级别发生变化时，我想更改图像显示部分的高度，根本不缩放它。我只是想掩盖一些图像而不改变它。

我尝试了以下代码：

```
import QtQuick 2.0

Rectangle {
    width: 360
    height: 482
    Image {
        x: 165
        source: "meter.png"
        fillMode: Image.Pad
        anchors.bottom: parent.bottom
        height: 482
    }
    Image {
        x: 175
        source: "meter.png"
        fillMode: Image.Pad
        anchors.bottom: parent.bottom
        height: 440
    }
    Image {
        x: 185
        source: "meter.png"
        fillMode: Image.Pad
        anchors.bottom: parent.bottom
        height: 400
    }
} 
```

但这会产生以下不良结果，并发生某种缩放。我希望所有 3 幅图像中黄色和绿色相交的位置相同。

![仪表尝试](../Images/0cf5eb4b23d7216c41703337ac580f3a.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-26T14:41:23.357

Image 组件默认从上到下填充，但不是将 Image 包装在外部 Item 中，并且使用不利于性能的剪辑，只需添加到所有 Image 项目：

```
width: sourceSize.width; // to be sure the width is the exact same as the source
verticalAlignment: Image.AlignBottom; // to force image to start from the bottom 
```

所以内容不会被缩放并对齐到图像的底部。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T08:28:14.890

该`Image`项目自上而下填充其内容，因此如果要将其锚定到底部，则需要一个额外的容器项目来剪裁图像的顶部：

```
Item {
  x: 165
  width: childrenRect.width
  height: 482

  clip: true  // This is the key

  Image {
      source: "meter.png"
      anchors.bottom: parent.bottom
  }
} 
```

# c++ - 为什么“在定义（而不是声明）静态数据成员时不能使用'static'”？

> ID：15235161
> 
> 赞同：17
> 
> 时间：2013-03-05T22:12:31.733
> 
> 标签：c++, static

我正在寻找在 C++ 中初始化静态映射的方法，并找到了以下代码：

```
struct A{
static map<int,int> create_map()
    {
      map<int,int> m;
      m[1] = 2;
      m[3] = 4;
      m[5] = 6;
      return m;
    }
static const map<int,int> myMap;

};

const map<int,int> A:: myMap =  A::create_map(); 
```

但是，如果我将最后一行更改为

```
const static map<int,int> A:: myMap =  A::create_map(); 
```

编译器投诉：在定义（而不是声明）静态数据成员时可能不会使用“静态””？

我想知道为什么？这背后的逻辑或推理是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-05T22:16:21.847

```
static int    a = 0; // grandfathered and still useful, provides static *LINKAGE*
                     // and static STORAGE DURATION
static int X::a = 0; // confusing and illegal, is it static LINKAGE
                     // or static STORAGE DURATION
                     // or static MEMBERSHIP? 
```

`static`用于变量定义时已经具有含义（在 C 中）。对于学习 C++ 的 C 程序员来说，发现含义有时会发生变化，但并非总是如此，这将是非常令人惊讶的。

所以新的含义（静态成员）只在类定义中有效（C 不允许`static`关键字）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T22:16:29.327

这和没区别

```
struct A
{
   static int x;
}

int A::x;         //legal
static int A::x;  //illegal 
```

其他一切都只是在这个最小的、概念上相同的示例中抛出的更多关键字。`static`成员只能在类`static`定义中声明。

这

```
const map<int,int> A:: myMap =  A::create_map(); 
```

类之外只是`static`成员的定义`A::myMap`。额外的`static`在那里没有意义。

这背后的原因可能是为了避免混淆 -`static`自由变量是一种“私有”变量（对于翻译单元）。一个成员`static`则相反。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-05T22:19:54.010

声明一个类成员`static`意味着它在该类的所有对象之间共享。

当您添加`static`到类之外的变量定义时，这意味着该变量具有文件范围并且在该文件之外不可见。

如果允许

```
const static map<int,int> A:: myMap =  A::create_map(); 
```

这意味着，您有一个静态成员变量，该变量在此文件之外不可见。这没有任何意义。

# bash - 如何在 SED 中使用空格作为变量

> ID：15235165
> 
> 赞同：0
> 
> 时间：2013-03-05T22:12:43.973
> 
> 标签：bash, sed

我需要将文件中的“a”替换为“”（单个空格），作为“”（单个空格）一个变量。我不明白。以下命令不起作用：

```
SRC="a" DST=" "; sed -i 's/'$SRC'/'$DST'/g' test.txt 
```

我尝试了'\'，“\”，''等但没有成功。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:16:32.603

```
sed -i 's/'$SRC'/'$DST'/g' test.txt 
```

与以下内容完全相同：

```
sed -i 's/a/' '/g' test.txt 
```

所以你将两个不同的参数传递给 sed。你可以这样做：

```
sed -i "s/$SRC/$DST/g" test.txt 
```

但如果你坚持使用`sed`它可能会更好：

```
sed -i "y/$SRC/$DST/" test.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:16:46.430

你能试试这个吗？

```
$SRC="a" DST=" "; sed -i "s/$SRC/$DST/g" test.txt 
```

shell var 将在双引号之间展开。

# javascript - 尝试将自定义 javascript 谷歌地图嵌入到 wordpress 网站

> ID：15235174
> 
> 赞同：-2
> 
> 时间：2013-03-05T22:13:07.680
> 
> 标签：javascript, google-maps-api-3, wordpress

我正在尝试将自定义谷歌地图嵌入到 worpress 网站中。自定义，因为我不能只是复制和粘贴谷歌为其基本谷歌地图之一提供的 html 代码，它是动态的并用 javascript 编写。我现在尝试这样做的方法是在侧边栏中的文本小部件中输入 javascript 代码，并在 javascript 中使用 id 为“map_canvas”的页面上`google.maps.Map(document.getElementById("map_canvas"), mapOptions);`生成地图。`<div>`在加载页面并检查它时，`<div>`加载和 javascript 运行没有任何错误，但页面上没有显示地图。直觉上，地图似乎太大而无法放入`<div>`，当我检查 map_canvas 的样式标签时，`<div>`它确实有`overflow: hidden`作为CSS的一部分。因此将其更改为可见的，但仍然没有解决问题。所以现在我被困住了......有没有人有使用 javascript 和 wordpress 的经验并且可以帮助我？我试图尽可能详细，但如果您需要了解更多信息，请告诉我。非常感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:33:13.653

将 JavaScript 添加到标头的正确方法是使用 wp_register_script() 和 wp_enqueue_script()。您可以将其添加到 functions.php 文件中。

我不完全确定 JS 是否在文本小部件中执行，所以你最好将它添加到你需要它出现的页面模板中。

无法判断您是否有覆盖包含地图的 div 的样式，因此发布链接可能是个好主意？

# joomla - joomla 和 nivo 滑块问题

> ID：15235175
> 
> 赞同：0
> 
> 时间：2013-03-05T22:13:12.240
> 
> 标签：joomla, nivo-slider

所以简而言之，我根本不会和 Joomla 混在一起（已经有几年了），今天我遇到了一个“嘿，你能解决这个问题吗”的问题，我花了太多时间来解决这个问题，我似乎无法弄清楚这个问题。我绝对需要帮助

该网站是[http://www.inrecordtime.net](http://www.inrecordtime.net)

问题是，滑块不能完全工作，“*完全*”我的意思是，一切都到位，我检查了路径并用更新版本替换了原始文件，还用 google 托管 cdn 版本的 jquery本地副本，检查图像路径等......什么都没有。

发生的情况是，当页面加载时，滑块上的第一个图像会加载，但滑块不会“滑动”它只是一个图像。

*   我已经在萤火虫上测试了图像，它们加载得很好。
*   我已经删除了滑块中的参数，并将其保留为常规函数调用，就像`jQuery('#slider').nivoSlider();`什么都没有。

*   我放回了参数并在滑块内，其中一个参数是`startSlide` ，此参数指示滑块从列表中的特定图像开始。

当前它位于“0”，这是第一张图片，`startSlide: 2`例如，当我像这样更改它，然后重新加载页面时，滑块从第二张图片开始（这表明它没有完全工作）但同样，滑块不“滑动”。

我建议上级不要把它们混在一起，而是让我对其进行硬编码，但这被否决了，因为他们希望他们能够更改图像。

我真的迷路了，所以任何帮助、代码或建议等，我都非常感激。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:47:53.480

根据我的控制台中弹出的错误，您可能需要将`jquery.nivo.slider.pack.js`文件更新到更高版本，您可以从这里获取：[https ://github.com/gilbitron/Nivo-Slider/blob/master/jquery .nivo.slider.pack.js](https://github.com/gilbitron/Nivo-Slider/blob/master/jquery.nivo.slider.pack.js)

您正在运行的版本依赖`live`于 jquery 中的函数，该函数已被弃用，我认为现在已被删除，因此现在您使用最新的 jquery 版本会引发错误。新版本的 nivo 滑块已更新为依赖`on`jquery 的新功能，应该可以运行。

看起来您的版本位于此处： http: [//www.inrecordtime.net/templates/IRT/scripts/nivo-settings/jquery.nivo.slider.pack.js](http://www.inrecordtime.net/templates/IRT/scripts/nivo-settings/jquery.nivo.slider.pack.js)

# python - 将交替行的 .txt 文件添加到 wx.ListCtrl 的简单方法？

> ID：15235180
> 
> 赞同：0
> 
> 时间：2013-03-05T22:13:44.970
> 
> 标签：python, wxpython, listctrl

我想知道是否有一种简单的方法可以将文本文件中的数据添加到 wxPython`wx.ListCtrl`并设置它，以便交替行进入三个单独的列。例如，第 1、4、7 和 10 行将添加到第 1 列，第 2、5、8 和 11 行将添加到第 2 列，第 3、6、9 和 12 行将添加到列3……以此类推。我已经使用打开了 .txt 文件 `with open("file.txt", 'r') as f:` ，然后使用`f.readlines()[1]`它读取第一行并将其设置为变量`a`，然后手动将变量添加`a`到列表中，但我认为必须有一种更有效的方法来做到这一点。

或者，回想起来，是否有另一种方法可以将数据写入 .txt 文件？现在，当用户单击提交按钮时，我正在将三个项目写入文件。这些是应该在三列中显示的项目。现在每个都在文本文件中单独一行，但也许我应该简单地用逗号或其他东西分隔它们？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:10:44.323

如果您想获取列表中的每三个项目，您可以执行 myList[::3]。

例如，

```
Python 2.7 (r27:82525, Jul  4 2010, 09:01:59) [MSC v.1500 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
>>> a = []
>>> for i in xrange(1,22):
...     a.append(i)
...
>>> a
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
>>> b = a       # start index of b will be the first item
>>> b = b[::3]
>>> b
[1, 4, 7, 10, 13, 16, 19]
>>> c = a[1:]   # start index of c will be the second item
>>> c = c[::3]
>>> c
[2, 5, 8, 11, 14, 17, 20]
>>> d = a[2:]   # start index of d will be the third item
>>> d = d[::3]
>>> d
[3, 6, 9, 12, 15, 18, 21] 
```

因此，您可以像这样将您的 readlines() 列表拆分为 3 个单独的列表，然后将它们添加到您的 ListCtrl。

Readlines 只返回一个列表，其中列表中的每个项目都是文件中的一行。因此，如果您将文件打开为 f，它看起来像这样，

```
with open("file.txt", 'r') as f:
    lines = f.readlines()
list1 = lines
list1 = list1[::3]
list2 = lines[1:]
list2 = list2[::3]
list3 = lines[2:]
list3 = list3[::3] 
```

现在`list1`保持每三行 (0,3,6,9)，`list2`保持 (1,4,7,10) 和`list3`保持 (2,5,8,11)。

# kendo-ui - 带有 NumericTextbox 的 Observable 的 KendoUI 模板

> ID：15235181
> 
> 赞同：0
> 
> 时间：2013-03-05T22:13:51.017
> 
> 标签：kendo-ui, kendo-template, kendonumerictextbox, kendo-observable

我将以下 KendoUI 模板绑定到可观察对象。当我将新项目推送到可观察数组时，如何将 kendoNumericTextBox 仅应用于模板中的新项目？

如果我按类申请，它会产生一种奇怪的效果，即现有数字文本框上的微调器加倍。

```
<div id="slots">
        <table class="table table-striped table-condensed" style="width:auto;">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Time</th>
                    <th>Volunteers Needed</th>
                    <th>
                        Reservation Passcode <i class="icon-question-sign" title ="Only people with the reservation passcode can signup."></i>
                    </th>
                </tr>
            </thead>
            <tbody data-template="row-template" data-bind="source: slots">
            </tbody>
        </table>

    </div>

 $(document).ready(function () {
          var viewModel = kendo.observable({
                slots: [{DateText:'1/8/1969', ShiftLabel: "3:00 to 5:00",Slots:2,ReservationCode:"ABC" }]
              });
          kendo.bind($("#slots"), viewModel);
          $(".numeric").kendoNumericTextBox({
              format: "n0"
          });

          viewModel.slots.push({DateText:'1/8/1969', ShiftLabel: "3:00 to 5:00",Slots:2,ReservationCode:"ABC" });

          $(".numeric").kendoNumericTextBox({
              format: "n0"
          });  
 }); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:08:16.847

尝试将您的模板定义为：

```
<script type="text/x-kendo-tmpl" id="row-template">
    <tr>
        <td>#= DateText #</td>
        <td>#= ShiftLabel #</td>
        <td class="numeric"><input data-role="numerictextbox" data-format="n0" data-bind="value: Slots"></td>
        <td>#= ReservationCode #</td>
    </tr>
</script> 
```

并删除`$(".numeric").kendoNumericTextBox(...)`初始化。这样做您应该在`NumericTextBox`每次运行模板时都有一个（每行一个）。

你的 JavaScript 是这样的：

```
$(document).ready(function () {
    var viewModel = kendo.observable({
        slots: [
            {DateText: '1/8/1969', ShiftLabel: "3:00 to 5:00", Slots: 2, ReservationCode: "ABC" }
        ]
    });
    kendo.bind($("#slots"), viewModel);

    viewModel.slots.push({DateText: '1/8/1969', ShiftLabel: "3:00 to 5:00", Slots: 3, ReservationCode: "ABC" });
}); 
```

看到它在这里运行[http://jsfiddle.net/OnaBai/BV48W/](http://jsfiddle.net/OnaBai/BV48W/)

**原因：** 您使用 CSS 类 ( ) 的事实`.numeric`导致您最终在另一个内部拥有一个 KendoUI 数字文本框。

*示例*：您有以下 HTML：

```
<label>Number 1: <input id="number1" class="numeric"/></label>
<label>Number 2: <input id="number2" class="numeric"/></label> 
```

And the JavaScript

```
$(document).ready(function () {
    $(".numeric").kendoNumericTextBox({
        format: "n0"
    });
    $(".numeric").kendoNumericTextBox({
        format: "n0"
    });
}); 
```

You will see what you called *strange effect of doubling the spinners on the existing numeric textboxes*.

Each time that you invoke `kendoNumericTextBox` using `.numeric` selector you add one extra spinner to the element. If it does not have a spinner (data just added to `viewModel`) it gets one *but* if then you add data and invoke `kendoNumericTextBox` using `.numeric` selector, that previous element gets another.

# ruby - 需要一个类导致双重执行

> ID：15235182
> 
> 赞同：1
> 
> 时间：2013-03-05T22:13:54.113
> 
> 标签：ruby

我在一个单独的文件中定义了一个类并需要它并创建了一个对象。但似乎初始化函数执行了两次。

a.rb：

```
Dir["#{File.dirname(__FILE__)}/*.rb"].each do |f| require(f) end
object = First.new 
```

b.rb（这是必需的）：

```
class First
  def initialize
    p "Hello"
  end
end 
```

结果：

```
"Hello"
"Hello" 
```

如果我说我测试了其他东西，它会变得更有趣。我将 b.rb 代码放在 a.rb 中（我的意思是我在 a.rb 中定义了 First class），结果是一样的：

a.rb：

```
Dir["#{File.dirname(__FILE__)}/*.rb"].each do |f| require(f) end #I now this line is useless

class Second
  def initialize
    p "Hello"
  end
end
object = Second.new

 "Hello"
 "Hello" 
```

**但是当我删除第一行（需要代码）（这在第二次测试中没用（因为我们在 a.rb 中定义了类，所以 b.rb 变得无用））一切都很好**：

a.rb：

```
#Dir["#{File.dirname(__FILE__)}/*.rb"].each do |f| require(f) end #now it is not executed.

class Second
  def initialize
    p "Hello"
  end
end
object = Second.new

"Hello" 
```

任何的想法？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:24:41.273

为什么不只需要你需要的文件而不是该路径中的所有 .rb 文件？如果你改变

```
Dir["#{File.dirname(__FILE__)}/*.rb"].each do |f| require(f) end 
```

到

```
require 'b.rb' 
```

它应该按预期工作

问题是您至少会同时包含 a 和 b rb 文件，这可能就是问题所在

您也可能在该文件夹中有另一个 .rb 文件，该文件在初始化时也会发送“Hello”作为输出。

请记住，您的要求包括该文件夹中的所有 rb 文件。即结果`ls *.rb`

# android - 我怎么能这样放我的按钮？

> ID：15235194
> 
> 赞同：0
> 
> 时间：2013-03-05T22:14:39.823
> 
> 标签：android, layout

![在此处输入图像描述](../Images/5e41ab9bdd72dc7f24d7ffe1cfeb7f98.png)

我想把我的数字按钮那样。这是我的代码：

```
LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(LinearLayout.VERTICAL);

        LinearLayout layout2 = new LinearLayout(this);
        layout2.setOrientation(LinearLayout.HORIZONTAL);

        TextView titleView = new TextView(this);
        titleView.setText("Hello World!");
        layout.addView(titleView);

        android.widget.LinearLayout.LayoutParams param = new LinearLayout.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.FILL_PARENT, 1);
        android.widget.TableLayout.LayoutParams params = new TableLayout.LayoutParams(
                LayoutParams.MATCH_PARENT, LayoutParams.FILL_PARENT, 1);

        Button btnConnect = new Button(this);
        btnConnect.setText("Connect");
        btnConnect.setLayoutParams(param);
        layout2.addView(btnConnect);

        Button btnDisconnect = new Button(this);
        btnDisconnect.setText("Disconnect");
        layout2.addView(btnDisconnect);
        btnDisconnect.setLayoutParams(param);

        layout.addView(layout2);

        TableLayout tblLayout = new TableLayout(this);
        tblLayout.setOrientation(TableLayout.HORIZONTAL);
        TableRow tblrow = null;

        for (int i = 1; i <= 9; i++) {
            if (i % 3 == 1) {
                tblrow = new TableRow(this);
                tblLayout.addView(tblrow);

            }

            Button b = new Button(this);
            b.setText("" + i);
            tblrow.addView(b);
        }

        TableRow tr = new TableRow(this);
        Button btnZero = new Button(this);
        btnZero.setText("0");
        Button btnHash = new Button(this);
        btnHash.setText("#");
        Button btnStar = new Button(this);
        btnStar.setText("*");
        tr.addView(btnZero);
        tr.addView(btnHash);
        tr.addView(btnStar);
        tblLayout.addView(tr);

        layout.addView(tblLayout);
        setContentView(layout); 
```

这符合：

![在此处输入图像描述](../Images/088fa4043e42152269f2daba3ce91ef8.png)

为了让我的专栏像那样。我使用了这段代码：

```
android.widget.TableLayout.LayoutParams params = new TableLayout.LayoutParams(
                LayoutParams.MATCH_PARENT, LayoutParams.FILL_PARENT, 1);
tblLayout.setLayoutParams(param); 
```

但没有任何变化。我需要做什么？Layoutparams 还不足以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:18:34.127

您需要设置 、 、 、 each 和 to 的宽度`layout`，`layout2`并且`tblLayout`每个`tblRow`Button`tr`必须`MATCH_PARENT`具有相等的`layout_weight`。

# c# - 在 IIS 下保持 WCF 服务处于活动状态

> ID：15235197
> 
> 赞同：6
> 
> 时间：2013-03-05T22:14:48.463
> 
> 标签：c#, wcf, iis-7.5

我已经彻底搜索了互联网（大多数链接将我发送到 stackoverflow ;)）尝试提出一个解决方案，如何在 IIS（7.5）下保持 WCF 服务处于活动状态。

这里的许多响应都建议编写一个应用程序，该应用程序将定期向 WCF 服务发送虚拟请求以使其保持活动状态。

我的问题是：如果我在 WCF 中创建一个线程，该线程将在首次调用服务时启动（在静态构造函数中），它会定期使用 WCF 本身？

我的意思是例如在 c# 中：

```
while (true)
{
     WebClient client = new WebClient();
     string returnString = client.DownloadString("http://...");
     Thread.Sleep(1000 * 5);
} 
```

假设“http://...”是提供的 WebMethod 的 URI，例如返回某个整数。

那行得通吗？

基本上我需要某种在执行某些操作并更新 SQL Server 数据库中的内容的服务器上运行的 Web 服务（不是特别是 WCF，但不是 Windows 服务）。因此，如果所描述的方法不起作用，那么实现这一目标的最佳方法可能是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T00:59:11.713

转到您的 IIS -> 应用程序池（或创建新的）-> 高级设置并设置常规时间间隔 = 0

![在此处输入图像描述](../Images/a566c92b2280b98737a8fe1be613f58e.png)

[在此处](https://stackoverflow.com/questions/1732181/how-to-keep-a-wcf-site-online)查看相关线程。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T22:27:58.383

AppFabric 允许您创建可以自动启动并长期存在的 wcf 服务 - 这可能值得作为托管选项检查（它只是 IIS 的插件）

[自动开启](http://msdn.microsoft.com/en-us/library/ee677260%28v=azure.10%29.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-12-08T17:39:17.070

你所做的从一开始就基本上是错误的。

问题是这样的：IIS 基本上是一个用于 http 请求的无状态请求代理（基本 IIS）和一个用于服务请求的请求代理（IIS w. AppFabric）。

您要问的是如何将固有的无状态 IIS 转变为有状态的服务器，并运行永恒的线程。

这不是 IIS 所做的，IIS 处理请求，并且它的 AppDomain 始终受到拆除（破坏所有线程）的影响。

这使得最赞成的答案很危险，因为它教您如何影响回收过程，而不控制 IIS 本身将间歇性执行的拆卸（关闭应用程序域和线程）。

请求者对 IIS 本身来说是“外来的”。

不过，服务的内部生命周期完全由 IIS（及其应用程序的配置）本身管理。

因此，如果“保持活力”的意思是：不断请求某些服务，然后按照 Andreas 的建议进一步进行（创建计划的工作）。

如果“保持活动”是指：确保类的同一个实例处理请求，那么您需要查看 WCF 生命周期。

如果“保持活动”是指：使您创建的代码“有状态”并使 f.eks 静态变量保持活动状态等等，那么您不接受 IIS 基本上是无状态的 pr。请求具有内部生命周期管理的代理。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:23:37.590

尽量避免使用 while 循环。也许[http://quartznet.sourceforge.net/](http://quartznet.sourceforge.net/)是您正在寻找的东西。在 WCF 开始每 10 分钟创建一个任务，这将调用 WCF 本身。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-05T22:28:52.497

我建议您创建一个调用 Web 服务的小程序（控制台应用程序）。该程序应将 Web 服务的 url 作为参数。然后您创建一个运行该程序的 Windows 计划任务。通过这种方式，与您查询的嵌入式方法相比，您具有很大的灵活性，因为该程序只是 Web 服务的另一个客户端。

# ruby - 将方法添加到命名空间中的字符串

> ID：15235199
> 
> 赞同：1
> 
> 时间：2013-03-05T22:14:55.067
> 
> 标签：ruby, metaprogramming

我正在定义一些新方法`String`。我需要确保这些方法与其他库中定义的方法不冲突（作为参考，我创建了一个变形器，然后添加了and `pluralize`）。`singularize``String`

我的第一个想法是将新东西包装在一个模块中，如下所示：

```
module MM
  class String
    def rev
      self.split('').reverse.join('')
    end
  end
end

class Test
  include MM

  def me(s)
    s.rev
  end
end

puts Test.new.me('this is a test') 
```

但这当然行不通。`String#rev`仍然未定义。我的代码中真正拥有的是一个模块`MM`，除了内置类型扩展之外的所有内容都包含在`MM`. 我的目标是拥有类似的`String`方法`rev`，但仅限于该模块内部，.`singularize``pluralize``MM`

这似乎应该是可行的。但不知何故，我错过了让它如此的秘密咒语。

如果有人可以提供一些建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:24:51.913

您正在寻找“改进”。它们是 Ruby 2.0 中的一个实验性功能，所以如果您不使用 2.0，您可能会不走运。我自己还没有使用它们，但是您的示例几乎是改进的规范用例。使用`refine`and`using`关键字来获得你想要的行为：

```
module MM
  refine class String
    def rev
      self.split('').reverse.join('')
    end
  end
end

class Test
  using MM

  def me(s)
    s.rev
  end
end

puts Test.new.me('this is a test') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T01:11:22.747

缺乏改进，您可以扩展单个字符串对象：

```
module StringHelper
  def rev
    self.split('').reverse.join('')
  end
end

class Test
  def me(s)
    s.extend(StringHelper).rev
  end
end 
```

或子类字符串：

```
class StringPlus < String
  def rev
    self.split('').reverse.join('')
  end
  def self.[](s)
    new(s)
  end
end

class Test
  def me(s)
    StringPlus[s].rev
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:34:55.633

那么还有另一种方法可以让你的字符串类分开。在您添加 require 之前，它将不受任何限制。

```
#my_string.rb
class String
  def rev
      self.split('').reverse.join('')
   end
end

#test.rb
class Test
  require 'F:\on going\New Site\Ruby\my_string.rb' # Assuming both these files are in the same folder

  def me(s)
    s.rev
  end
end

puts Test.new.me('this is a test') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T19:08:02.200

作为没有改进的解决方法，我发现这种事情有效：

```
# class String
#   def rev
#     puts "rev: #{self}"
#   end
# end

class String
  unless String.instance_methods.include?(:rev)
    def rev
      self.split('').reverse.join('')
    end
  end
end

class Test
  def me(s)
    s.rev
  end
end

puts Test.new.me('this is a test') 
```

如果您取消注释它的早期定义，`rev`它将被尊重而不是被覆盖。这有点 hacky 并且依赖于文件加载的顺序，但如果加载顺序受到控制，它确实可以工作。

# api - 使用高级 Vimeo API 搜索私人视频

> ID：15235201
> 
> 赞同：0
> 
> 时间：2013-03-05T22:15:00.700
> 
> 标签：api, video, vimeo

使用 Advanced Vimeo API，我如何搜索所有经过身份验证的用户的私人视频？我对用户的私人视频特别感兴趣，其中`embed_privacy`包含`anywhere`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:39:57.883

Vimeo 的搜索不会在网站上或通过 API 公开任何私人视频。

实现这一点的最佳方法是调用 vimeo.videos.getall （请参阅[操场](https://developer.vimeo.com/apis/advanced/methods/vimeo.videos.getAll/playground)）并搜索您端的数据。

# python - 使用 python-opencv 的水平和垂直边缘轮廓

> ID：15235206
> 
> 赞同：3
> 
> 时间：2013-03-05T22:15:37.887
> 
> 标签：python, opencv, computer-vision, edge-detection

我正在尝试检测图像中的车辆（实际上是视频中的一系列帧）。我是opencv和python的新手，在windows 7下工作。

有没有办法获得图像的水平边缘和垂直边缘，然后将得到的图像总结成各自的向量？

是否有可用的python代码或函数。

我看了[这个](https://stackoverflow.com/questions/4295006/horizontal-histogram-in-opencv)和[这个](https://stackoverflow.com/questions/7227074/horizontal-line-detection-with-opencv)，但不知道该怎么做。您可以使用下图进行说明。

**编辑**

我受到以下论文中提出的想法的启发（抱歉，如果您没有访问权限）。

贝特克，M。Haritaoglu, E. & Davis, LS Real-time multiple vehicle detection and tracking from amoving vehicle Machine Vision and Applications, Springer-Verlag, 2000, 12, 69-83

![http://i.stack.imgur.com/y5MXl.jpg](../Images/51951e4e833da271fc143100d67be979.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:18:25.500

我会看一下[此处](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/python/squares.py?rev=2777)发布的 opencv 的正方形示例。它使用精明，然后进行轮廓查找以返回每个正方形的边。您应该能够修改此代码以获得您正在寻找的水平和垂直线。[这](http://opencv.willowgarage.com/documentation/python/imgproc_feature_detection.html#canny)是 canny 的 python 调用文档的链接。它对全方位边缘检测很有帮助。大约一个小时后，我可以回家并给你一个你想要的工作示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T22:28:18.430

通常，用于对象检测的几何方法并不是非常成功，因为您假设的外观模型很容易被遮挡、噪声或方向变化所破坏。

在我看来，机器学习方法通​​常效果更好，并且可能会为您的问题提供更强大的解决方案。由于您似乎正在使用 OpenCV，您可以查看[Casacade Classifiers](http://docs.opencv.org/doc/user_guide/ug_traincascade.html)，OpenCV 为其提供了 Haar 小波和基于局部二进制模式特征的分类器。

我提供的链接是一个教程，其中包含非常完整的步骤，解释了如何使用几个预先编写的实用程序创建分类器。基本上，您将创建一个包含汽车“正面”图像的目录和一个包含典型背景的“负面”图像的目录。实用`opencv_createsamples`程序可用于创建扭曲的训练图像，以从一小组图像中模拟不同的方向和平均强度。然后，您可以使用该实用程序`opencv_traincascade`设置一些命令行参数来选择不同的训练选项，从而为您输出经过训练的分类器。

可以使用带有此训练分类器的 C++ 或 Python 接口执行检测。例如，使用 Python，您可以加载分类器并在图像上执行检测，以获取选择的边界矩形：

```
image = cv2.imread('path/to/image')
cc = cv2.CascadeClassifier('path/to/classifierfile')
objs = cc.detectMultiScale(image) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T23:49:52.600

阅读 Sobel 过滤器。

[http://en.wikipedia.org/wiki/Sobel_operator](http://en.wikipedia.org/wiki/Sobel_operator)

您基本上可以在每个像素处获得垂直和水平渐变。

这是它的 OpenCV 函数。

[http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=sobel#sobel](http://docs.opencv.org/modules/imgproc/doc/filtering.html?highlight=sobel#sobel)

获得此过滤后的图像后，您可以按列/行收集统计信息，并确定其是否为边缘并获取该位置。

# android - 内核如何提示 Android 手机以 USB 大容量存储模式连接？

> ID：15235208
> 
> 赞同：1
> 
> 时间：2013-03-05T22:15:44.863
> 
> 标签：android, linux-kernel, usb

电话正在运行冰淇淋三明治。我想知道内核是如何提示Android HAL/Framework手机以USB Mass Storage Mode连接的？当我说提示时，我的意思是生成一个`uevent`

> 更改@/devices/virtual/switch/usb_connected

这将导致在手机上看到 USB 连接消息。

我目前面临的问题：将USB插入PC中，手机或PC没有反应。如果您进入设置并禁用/启用 USB 调试选项，则会检测到手机。

显然，我所针对的修复程序应该可以在 PC 上检测到手机，而无需用户使用设置。

提前致谢！

# google-app-engine - 在谷歌应用引擎数据存储中持久化数据

> ID：15235211
> 
> 赞同：0
> 
> 时间：2013-03-05T22:15:49.557
> 
> 标签：google-app-engine, jakarta-ee, google-cloud-datastore

我尝试使用 JPA 将数据存储在谷歌应用引擎数据存储中，但遇到了一些麻烦。

我的代码：

```
try {
        for (int i = 1; i <= 10; i++) {
            Employee emp = new Employee();

            emp.setFirstName("John" + i);
            emp.setLastName("Doe" + i);
            emp.setAge(i);

            em.persist(emp);
            em.refresh(emp);
        }

        em.flush();

    } catch (Exception e) {

        e.printStackTrace();
    } finally {
        em.close();
    } 
```

当我启动它时，数据被存储但发生 2 个错误：

javax.persistence.TransactionRequiredException：此操作需要一个事务但它不活动 -> 行 em.flush();

和

java.lang.NullPointerException at org.datanucleus.ObjectManagerImpl.flushInternalWithOrdering(ObjectManagerImpl.java:3887) -> line em.close();

有谁知道如何解决它们？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:24:00.510

尝试：

```
em.getTransaction().begin();
//do all your persist logic
em.getTransaction().commit(); 
```

更多信息：[https ://developers.google.com/appengine/docs/java/datastore/transactions](https://developers.google.com/appengine/docs/java/datastore/transactions)

# javascript - 在嵌套的每个中使用 lodash/下划线

> ID：15235215
> 
> 赞同：0
> 
> 时间：2013-03-05T22:16:14.940
> 
> 标签：javascript, underscore.js, lodash

我正在尝试将此代码块转换为 Lo-Dash：

```
if(!event && callback){
  for(var ev in this._events){
    for (var i = 0; i < this._events[ev].length; i++) {
      if(this._events[ev][i].callback === callback){
        this._events[ev].splice(i, 1);
      }
    }
  }
  return;
} 
```

我已经尝试过了，但我无法让它工作：

```
if(!event && callback){
  _.each(this._events, function(ev){
    _.each(ev, function(trigger, i, ev){
      if(trigger.callback === callback) ev.splice(i, 1);
    });
  });
  return;
} 
```

`this._events`结构是这样的：

```
this._events = {
  ev1: [
    {callback: functions(){....}},
    {callback: functions(){....}}
  ],
  ev2....
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:00:28.093

我不相信转换有任何直接问题，但原始代码似乎有缺陷 - 如果您尝试删除两个连续的函数，则只会删除第一个函数。每次删除某些内容时，都会跳过列表中的以下项目（您必须更聪明地使用索引才能使其工作，除非您出于任何原因对检查回调匹配后的项目无动于衷）。这可以通过对原始代码执行以下操作来解决：

```
if (!event && callback) {
  for (var ev in this._events) {
    for (var i = 0; i < this._events[ev].length; i++) {
      if (this._events[ev][i].callback === callback) {
        this._events[ev].splice(i, 1);
        i--;
      }
    }
  }
  return;
} 
```

虽然它适用于不同的索引操作，但我会考虑采用更实用的编程方法（毕竟这就是 lodash 和 underscore 的用途）：

```
if (!event && callback) {
  this._events = _.map(this._events, function(ev) {
    return _.filter(ev, function(trigger, i, ev) {
      return !(trigger.callback === callback);
    });
  });
  return;
} 
```

函数式编程不是直接操作现有数据，而是强调现有数据的不变性，并且通常会依赖创建新结构来反映对现有数据的更改。因此，不是拼接现有数组，而是使用旧结构生成新结构，并将对旧结构的引用替换为对新结构的引用。

不过，这并不能完全解释函数式方法背后的动机，所以我将给您留下一些想法，说明为什么这可能是一个更好的设计决策。在这种情况下，性能可能会更好（多次拼接一个数组是相当昂贵的）。然而，函数式编程更重要的部分是你不必在变量中处理太多的状态，这可以导致更可靠的代码。这是一个完美的例子 - 操作现有结构的索引比让现有函数为您处理状态（在本例中为映射和过滤器）更难正确执行，这会导致索引错误。

# c++ - C++，定时器，毫秒

> ID：15235218
> 
> 赞同：4
> 
> 时间：2013-03-05T22:16:26.307
> 
> 标签：c++, timer

```
#include <iostream>
#include <conio.h>
#include <ctime>

using namespace std;

double diffclock(clock_t clock1,clock_t clock2)
{
    double diffticks=clock1-clock2;
    double diffms=(diffticks)/(CLOCKS_PER_SEC/1000);
    return diffms;
}
int main()
{
    clock_t start = clock();
    for(int i=0;;i++)
    {

    if(i==10000)break;
    }
    clock_t end = clock();

    cout << diffclock(start,end)<<endl;

    getch();
return 0;
} 
```

所以我的问题来了，它给我返回一个 0，好吧，直截了当，我想检查我的程序运行了多少时间......我在互联网上发现了大量的废话，大多数情况下它与获得 0 的点相同因为开始和结束是一样的

这个问题转到 C++ 记住：<

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T23:09:03.880

这里有几个问题。首先是您在传递给`diffclock()`函数时显然切换了开始和停止时间。第二个问题是优化。任何启用优化的合理智能编译器都会简单地丢弃整个循环，因为它没有任何副作用。但即使你解决了上述问题，程序很可能仍会打印 0。如果你试图想象每秒执行数十亿次操作，抛出复杂的乱序执行、预测和现代 CPU 采用的大量其他技术，即使是 CPU 也可能优化你的循环。但即使没有，您也需要超过 10K 次迭代才能使其运行更长时间。您可能需要您的程序运行一两秒钟才能`clock()`反映任何内容。

但最重要的问题是`clock()`它本身。该功能不适用于任何时间的性能测量。它的作用是为您提供程序使用的处理器时间的**近似值**。除了任何给定实现可能使用的近似方法的模糊性质（因为标准不需要任何特定的东西），POSIX 标准还要求`CLOCKS_PER_SEC`等于`1000000`独立于实际分辨率。换句话说——时钟有多精确并不重要，你的 CPU 以什么频率运行并不重要。简而言之——它是一个完全无用的数字，因此是一个完全无用的功能。它仍然存在的唯一原因可能是出于历史原因。所以，请不要使用它。

为了实现您要查找的内容，人们习惯于通过用于读取它的相应 CPU 指令的名称来读取[CPU 时间戳](http://en.wikipedia.org/wiki/Time_Stamp_Counter)，也称为“RDTSC”。然而，这些天来，这也大多是无用的，因为：

1.  现代操作系统可以轻松地将程序从一个 CPU 迁移到另一个 CPU。您可以想象在另一个 CPU 上运行一秒钟后读取另一个 CPU 上的时间戳没有多大意义。只有在最新的 Intel CPU 中，计数器才会跨 CPU 内核同步。总而言之，仍然可以这样做，但必须格外小心（即一旦可以设置进程的亲和力等）。
2.  经常测量程序的 CPU 指令并不能准确地了解它实际使用了多少时间。这是因为在实际程序中可能存在一些系统调用，其中工作由操作系统内核代表进程执行。在这种情况下，该时间不包括在内。
3.  操作系统也可能长时间暂停进程的执行。尽管执行只需要几条指令，但对用户来说似乎只是一秒钟。所以这样的性能测量可能是无用的。

那么该怎么办？

[`perf`](https://perf.wiki.kernel.org/index.php/Main_Page)在进行分析时，必须使用类似的工具。它可以跟踪多个 CPU 时钟、缓存未命中、已采用的分支、未命中的分支、进程从一个 CPU 移动到另一个 CPU 的次数，等等。它可以用作工具，也可以嵌入到您的应用程序中（类似于[PAPI](http://icl.cs.utk.edu/papi/)）。

如果问题是关于实际花费的时间，人们会使用挂钟。最好是高精度的，也不受 NTP 调整（单调）的影响。无论发生什么，这都能准确显示过去了多少时间。[`clock_gettime()`](http://man7.org/linux/man-pages/man2/clock_getres.2.html)可用于此目的。它是 SUSv2、POSIX.1-2001 标准的一部分。鉴于使用您`getch()`保持终端打开，我假设您使用的是 Windows。不幸的是，你没有`clock_gettime()`，最接近的是性能计数器 API：

```
BOOL QueryPerformanceFrequency(LARGE_INTEGER *lpFrequency);
BOOL QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount); 
```

对于便携式解决方案，最好的选择是[`std::chrono::high_resolution_clock()`](http://en.cppreference.com/w/cpp/chrono/high_resolution_clock). 它是在 C++11 中引入的，但受到大多数工业级编译器（GCC、Clang、MSVC）的支持。

下面是一个如何使用它的例子。请注意，由于我知道我的 CPU 将以比毫秒快的速度执行 10000 个整数增量，因此我将其更改为微秒。我还声明了计数器`volatile`，希望编译器不会优化它。

```
#include <ctime>
#include <chrono>
#include <iostream>

int main()
{
    volatile int i = 0; // "volatile" is to ask compiler not to optimize the loop away.
    auto start = std::chrono::steady_clock::now();
    while (i < 10000) {
        ++i;
    }
    auto end = std::chrono::steady_clock::now();
    auto elapsed = std::chrono::duration_cast<std::chrono::microseconds>(end - start);
    std::cout << "It took me " << elapsed.count() << " microseconds." << std::endl;
} 
```

当我编译并运行它时，它会打印：

```
$ g++ -std=c++11 -Wall -o test ./test.cpp && ./test
It took me 23 microseconds. 
```

希望能帮助到你。祝你好运！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T22:31:50.827

乍一看，您似乎是从较小的值中减去较大的值。你打电话：

```
diffclock( start, end ); 
```

但随后 diffclock 被定义为：

```
 double diffclock( clock_t clock1, clock_t clock2 ) {

        double diffticks = clock1 - clock2;
        double diffms    = diffticks / ( CLOCKS_PER_SEC / 1000 );

        return diffms;
    } 
```

除此之外，它可能与您转换单位的方式有关。使用 1000 转换为毫秒在此页面上有所不同：

[http://en.cppreference.com/w/cpp/chrono/c/clock](http://en.cppreference.com/w/cpp/chrono/c/clock)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-05T22:31:38.573

问题似乎是循环太短了。我在我的系统上尝试了它，它给出了 0 个滴答声。我检查了 diffticks 是什么，它是 0。将循环大小增加到 100000000，所以有一个明显的时间延迟，我得到 -290 作为输出（错误——我认为 diffticks 应该是 clock2-clock1 所以我们应该得到 290而不是-290）。我还尝试在部门中将“1000”更改为“1000.0”，但没有奏效。

使用优化进行编译确实会删除循环，因此您不必使用它，或者使循环“做某事”，例如在循环体中增加一个计数器而不是循环计数器。至少这就是 GCC 所做的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2020-08-19T16:39:34.230

注意：这在 c++11 之后可用。

您可以使用**std::chrono**库。std::chrono 有两个不同的对象。（**时间点**和**持续时间**）。时间点代表时间点和持续时间，正如我们已经知道的那样，该术语代表时间间隔或时间跨度。这个 c++ 库允许我们减去两个时间点来获得在间隔中传递的持续时间。因此，您可以设置起点和终点。使用函数，您还可以将它们转换为适当的单位。

使用**high_resolution_clock**的示例（这是该库提供的三个时钟之一）：

```
#include <chrono> 
using namespace std::chrono; 
```

//在运行函数之前

```
auto start = high_resolution_clock::now(); 
```

//调用函数后

```
auto stop = high_resolution_clock::now(); 
```

减去停止和开始时间点，并使用 duration_cast() 函数将其转换为所需的单位。预定义的单位是纳秒、微秒、毫秒、秒、分钟和小时。

```
auto duration = duration_cast<microseconds>(stop - start);
cout << duration.count() << endl; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-05T22:26:34.477

首先，您应该减去 end - start 反之亦然。
文档说如果值不可用clock（）返回-1，你检查了吗？编译程序时使用什么优化级别？如果启用优化，编译器可以有效地完全消除您的循环。

# jquery - jQuery 只遍历每个列表项一次

> ID：15235221
> 
> 赞同：1
> 
> 时间：2013-03-05T22:16:31.603
> 
> 标签：jquery, each, preventdefault

我有一个每次在页面内滚动时都会执行的函数。该函数中有一个 .each() 函数，用于遍历所有列表项：

```
$('#scroller').on('appear', function() {
    $('#chart li').each(function(ev){
            // Do something
    });
}); 
```

我的问题是我只想遍历这些列表项一次。我尝试返回 false 和 ev.preventDefault，但随后它使 //do something 仅适用于第一个列表项。

我发现[这篇文章](https://stackoverflow.com/questions/3965192/for-loop-inside-jquery-function)几乎是一样的，但是应用这个方法我得到一个“对象[对象数组]没有方法'应用'”错误。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T22:23:16.827

只需在使用变量之前检查您是否已经完成：

```
var hasLooped = false;

$('#scroller').on('appear', function() {
    if(!hasLooped){
        $('#chart li').each(function(ev){
                // Do something
        });

        hasLooped = true;
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:32:37.693

我认为汤姆上面的回答非常直截了当，可以为您提供您想要的东西。我只是提供这个作为替代方案或以其他方式思考。

```
// create a seperate handler for it, and then unbind once it fires.
$('#scroller').on('scroll.onceMe', function() {
       $('#chart li').each(function(ev){
            // Do something
       });
    $('#scroller').unbind("scroll.onceMe");
 }); 
```

或者类似的东西怎么样： - 为它创建一个独特的处理程序。

```
 $('#scroller').one('scroll.onceMe', function() {
       $('#chart li').each(function(ev){
            // Do something
       });
 }); 
```

# drupal - Drupal 7：发布日期的暴露过滤器

> ID：15235224
> 
> 赞同：2
> 
> 时间：2013-03-05T22:16:47.837
> 
> 标签：drupal, drupal-views, drupal-exposed-filter

我在一个网站上有数百篇文章。我使用视图在一个页面上显示摘录和指向它们的链接，并且我还有一个寻呼机，当时显示 10 篇文章。我需要添加一个带有年份 [...,2008,2009...,2013] 的下拉列表。如果您在下拉列表中选择年份，则视图应仅显示该年份发布的文章。例如，如果在 2013 年添加了一篇新文章，下拉列表中的年份应该会自动更新，因此第一年是第一次发表的年份。

请提出可能的解决方案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-06T07:05:42.750

我认为，您需要将暴露过滤器设置为视图列表。配置应该是这样的——

> 过滤条件：日期（节点）；
> 
> 表单元素：选择；
> 
> 过滤粒度：年；
> 
> 日期字段：发布日期；暴露;
> 
> 要公开的过滤器类型：单；
> 
> 运算符：等于；

告诉我它是否有效..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-28T16:49:13.293

如果您想为节点使用 Drupal 内置的“Authored on”字段，这是一种方法。您需要创建一个自定义模块。这是在 Drupal 7 / Views 3 中创建的。我的模块文件在 /sites/all/modules/custom/ViewsYearFilter/ 中。

**ViewsYearFilter.info**

```
name = Views Year Filter
description = Allow a view to filter by post year.
package = tools
core = 7.x

files[] = ViewsYearFilter.inc
files[] = ViewsYearFilter.views.inc 
```

**ViewsYearFilter.module**

```
<?php

/**
 * Implements of hook_views_api().
 */
function ViewsYearFilter_views_api() {
  return array('api' => 3);
} 
```

**ViewsYearFilter.views.inc**

```
<?php

/**
 * Implements of hook_views_data().
 */
function ViewsYearFilter_views_data() {
  return array(
    'node' => array(
      'published_year' => array(
        'group' => t('Content'),
        'title' => t('Year'),
        'help' => t('Filter by years.'),
        'filter' => array('handler' => 'ViewsYearFilter'),
      )
    )
  );
} 
```

**ViewsYearFilter.inc**

```
<?php

/* Allows filtering of posts by year in a Drupal View. */

class ViewsYearFilter extends views_handler_filter_in_operator {

  /**
   * Override parent get_value_options() function. This function returns an array of all valid years from our post type.
   * @return
   *   Return the stored values in $this->value_options if someone expects it.
   */
  function get_value_options() {

    $query = new EntityFieldQuery();
    $query->entityCondition('entity_type', 'node')
    ->propertyCondition('type', 'blog_post') //post type
    ->propertyCondition('status', '1'); //is published

    $results = $query->execute();

    $object_node_ids = array_keys($results['node']);
    $objects = node_load_multiple($object_node_ids);

    foreach ($objects as $blog_post) {
      $values[date('Y', $blog_post->created)] = date('Y', $blog_post->created);
    }

    $this->value_options = $values;
    return $values; //array of year values
  }

  function query() {
    $this->ensure_my_table(); //not sure why/if this is necessary
    $startDate = mktime(0, 0, 0, 1, 1, intval($this->value[0]));
    $endDate = mktime(0, 0, 0, 1, 1, intval($this->value[0] + 1));
    $this->query->add_where_expression($this->options['group'], "node.created >= " . $startDate . " AND node.created <= " . $endDate); //filtering query
  }

} 
```

然后，在您的视图配置页面中，您可以创建一个新的公开过滤器：

抱歉，由于我没有足够的声誉，我实际上无法发布此图片。将有一个名为“内容：年份”的新公开过滤器，您可以在创建并激活新模块后将其添加到视图中。

PS：我的代码基于 Shevchuk 对[这个问题](https://stackoverflow.com/questions/3881718/drupal-views-exposed-filter-of-author-name-as-a-drop-down)的回答。

# facebook - 流 FQL 显示空白消息（这是我在其他墙上的帖子） - 但仅限 1 个应用程序

> ID：15235229
> 
> 赞同：2
> 
> 时间：2013-03-05T22:17:04.763
> 
> 标签：facebook, stream, facebook-fql

这几天我一直在努力解决这个问题。

我使用这样的查询将我的帖子放在墙上：选择 post_id、viewer_id、app_id、source_id、updated_time、created_time、filter_key、attribution、actor_id、target_id、message、attachment、permalink from stream where source_id = 100003203496908 and updated_time >' 1362480430'

根据 App ID 的不同，这种行为会有所不同。这些应用程序*似乎*具有相同的设置，并且用户似乎具有相同的权限。

使用正常运行的应用程序，它只会返回我在墙上的帖子。

由于应用程序无法正常运行，它会将我的帖子返回到我的墙上。但它也会返回一些具有空消息和永久链接的行，如下所示：

```
 (
        [post_id] => 100003203496908_367088630074584
        [viewer_id] => 100003203496908
        [app_id] =>
        [source_id] => 100003203496908
        [updated_time] => 1362487503
        [created_time] => 1362487503
        [filter_key] =>
        [attribution] =>
        [actor_id] => 100003203496908
        [target_id] =>
        [message] =>
        [attachment] => Array
            (
                [description] =>
            )

        [permalink] =>
    ) 
```

通过一些测试，我已经能够确定这些是我在别人的墙上发布的帖子。我认为不应该在这里返回。Post_id 看起来也是假的。

有任何想法吗？我应该去哪里看？任何具有应用程序设置或权限的东西会在一个应用程序中导致这样的事情，而不是在另一个应用程序中？

# algorithm - 为什么约翰逊算法给出最优序列

> ID：15235233
> 
> 赞同：-1
> 
> 时间：2013-03-05T22:17:32.103
> 
> 标签：algorithm, optimization

作业车间调度的约翰逊算法解决了2台机器和N个作业的情况

作业 Pi 有两个操作，持续时间为 Pi1，Pi2，要按顺序在机器 M1，M2 上完成。

```
Step 1\. List A = { 1, 2, …, N }, List L1 = {}, List L2 = {}.
Step 2\. From all available operation durations, pick the minimum.
If the minimum belongs to Pk1,
Remove K from list A; Add K to end of List L1.
If minimum belongs to Pk2,
Remove K from list A; Add K to beginning of List L2.
Step 3\. Repeat Step 2 until List A is empty.
Step 4\. Join List L1, List L2\. This is the optimum sequence. 
```

我不明白为什么这是给出“最佳”答案。这是[维基百科链接](http://en.wikipedia.org/wiki/Job_shop_scheduling)

我认为这是一个反例：

工作组：

(2,3);(4,5);(6,7)

算法给出的最终答案是机器 1 上的 J1,J2,J3(2,4,6)，而机器 2 一直处于空闲状态。相反，如果我们将 J1、J2 安排在机器 1 上，将 J3 安排在机器 2 上，那么我们可以早点完成

谁能解释我做错了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:35:11.877

> 算法给出的最终答案是机器 1 上的 J1,J2,J3(2,4,6)，而机器 2 一直处于空闲状态。相反，如果我们将 J1、J2 安排在机器 1 上，将 J3 安排在机器 2 上，那么我们可以早点完成。

不。关键是工作由两部分组成，第一部分必须在第一台机器上完成，第二部分必须在第一部分完成*后*在第二台机器上完成。

所以在你的例子中，你会得到序列`{ J1, J2, J3 }`，没错，它会被执行

1.  `J1[1]`在 M1 上；2分钟
2.  `J2[1]`在 M1 和`J1[2]`M2 上同时启动；4分钟和3分钟
3.  `J3[1]`在 M1 和`J2[2]`M2 上，开始 - 巧合，因为`J2[1] > J1[2]`- 同时；6分钟和5分钟
4.  `J3[2]`在 M2 上；7 分钟

所以你总共需要`2 + 4 + 6 + 7 = 19`几分钟，这是最快的方法。

目标是最大化 M1 和 M2 上的活动之间的重叠。因此，如果您的作业的第一部分较短，请先完成它们以尽快占用机器 2。如果可能的话，最后有第二部分短的工作，这样机器 2 工作而机器 1 已经完成的时间很短。

# javascript - 当我将 jquery autocomplete minLength 设置为 0 时，它会在用户选择一个对象后继续运行

> ID：15235236
> 
> 赞同：1
> 
> 时间：2013-03-05T22:17:43.480
> 
> 标签：javascript, jquery, ajax, drop-down-menu, autocomplete

我正在使用带有 ajax 的 Jquery 自动完成功能。一切正常，除非我将 minLength 设置为 0。当我从列表中选择一个元素时，自动完成不会停止运行并再次向我显示列表。

这是代码：

```
 $("#id_from").autocomplete({
     source: function (request, response) {
         $.ajax({
             url: "http://127.0.0.1:8000/core/get_from_cities",
                 dataType: "json",
                 data: {term: request.term},
                 success: function (data) {
                     response($.map(data.data, function (item) {
                         return {
                             label: item.value,
                             value: item.value
                         }
                     }));
                 }
             });
         },
         minLength: 0         
     }); 
```

谢谢..

编辑：这是我想出的解决方案：

```
 $("#id_to").focus(function() {
                $( "#id_to" ).autocomplete( "enable" );
            });

            $("#id_ffrom").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "http://127.0.0.1:8000/core/get_from_cities",
                        dataType: "json",
                        data: {term: request.term},
                        success: function (data) {
                            response($.map(data.data, function (item) {
                                return {
                                    label: item.city,
                                    value: item.city,

                                }
                            }));
                        }
                    });
                },
                minLength: 0,
                select: function (event, ui) {
                    $('#id_from_country').val(ui.item.country)
                    $("#id_ffrom").autocomplete( "disable" );

                }

            }); 
```

# python - 永久缓存 Python 类生成的结果

> ID：15235240
> 
> 赞同：5
> 
> 时间：2013-03-05T22:17:59.990
> 
> 标签：python, python-2.7, metaprogramming

我正在做动态类生成，**可以**在“编译”时静态确定。我现在拥有的简单案例或多或少是这样的：

```
class Base(object):
    def __init__(self, **kwargs):
        self.do_something()

def ClassFactory(*args):
    some_pre_processing()
    class GenericChild(Base):
        def __init__(self, **kwargs):
            self.some_processing()
            super(GenericChild, self).__init__(*args, **kwargs)
    return GenericChild

Child1 = ClassFactory(1, 'Child_setting_value1')
Child2 = ClassFactory(2, 'Child_setting_value2')
Child3 = ClassFactory(3, 'Child_setting_value3') 
```

在导入时，Python 解释器似乎编译为字节码，然后在每个 Python 实例中执行一次文件（从而生成`Child1`、`Child2`和）。`Child3`

**有没有办法告诉 Python 编译文件，执行一次以解包`Child`类，然后将其编译到`pyc`文件中，以便解包只发生一次（即使在 Python 脚本的连续执行中）？**

我还有其他更复杂和更广泛的用例，所以简单地通过手写`Child`类来摆脱工厂并不是一个真正的选择。另外，如果可能的话，我想避免额外的预处理器步骤（比如在 C 预处理器中使用 C 风格的宏）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:21:24.037

不，您必须生成 Python 代码，而不是将这些类“烘焙”到 Python 代码。

使用某种形式的字符串模板来生成 Python 源代码，将它们保存到`.py`文件中，然后对它们进行字节编译。

但是，类生成仅在启动时发生一次。产生这些真的有那么大的成本吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:59:26.520

如果没有真正需要将子类分开，并且您只想为这些特定的对象集提供“标准配置”，则可以将 ObjectFactory 设置为存储在其中的配置的类。每个实例都能够使用适当的配置生成 GenericChildren，完全绕过类的运行时生成（以及与之相关的调试难题）。

# jquery - 如何在一页中处理选项卡内的 asx 页面

> ID：15235241
> 
> 赞同：0
> 
> 时间：2013-03-05T22:18:02.693
> 
> 标签：jquery, asp.net

我必须在 aspx 页面中编程选项卡。每个选项卡将包含一个不同的 aspx 页面。我可以用这个 jquery 代码和 Div 标签来做到这一点：

```
// In Default.aspx
<head runat="server">
    <link rel="stylesheet" href="~/Styles/jquery-ui.css" />

    <script src="Scripts/jquery-1.9.1.js"></script>

    <script src="Scripts/jquery-ui.js"></script>

    <link rel="stylesheet" href="/resources/demos/style.css" />

    <script>
        $(function() {
        $( "#tabs" ).tabs();
        });
    </script>

    <script language="javascript">
        $(document).ready(function () {

            $("#tabs-1").load("First.aspx", {}, function (data) {
                // do something
            });

            $("#tabs-2").load("Second.aspx", {}, function (data) {
                // do something
            });

        });
    </script>

</head>
<body>
    <form id="form1" runat="server">
    <div id="tabs">
        <ul>
            <li><a href="#tabs-1">First tab</a></li>
            <li><a href="#tabs-2">Second tab</a></li>
        </ul>
        <div id="tabs-1">
        </div>
        <div id="tabs-2">

        </div>
    </div>
    </form>
</body> 
```

我的问题是包含在选项卡中的 aspx 页面的回发。当 First.aspx 或 Second.aspx 回发时，Defautl.aspx 就会消失，First.aspx 或 Second.asps 会控制屏幕。

一种解决方案是使用 iframe 而不是 Div，但我过去曾遇到过 iframe 的问题，因此更愿意避免使用它们。

有什么方法可以使用选项卡和每个包含 aspx 页面的选项卡？

![在此处输入图像描述](../Images/d977101661c0292c32704618658bb30a.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:30:22.087

你能避免全员回传而使用 Ajax 回传吗？Asp.net ajax 可能会帮助你。否则，您可以在您的 aspx 页面中编写回发处理程序来完成他们的工作，然后重定向回您的标签页，尽管这有点讨厌！

# java - 如何将触摸坐标转换为libgdx中的局部对象坐标？

> ID：15235242
> 
> 赞同：4
> 
> 时间：2013-03-05T22:18:06.803
> 
> 标签：java, android, libgdx, transformation

我想将用户触摸时收到的点坐标转换为本地对象坐标。

触地时，我在屏幕坐标中得到 (x,y)：

```
left-top=(0,0), bottom-right=(SCREEN_WIDTH,SCREEN_HEIGHT). 
```

然后我`camera.unproject(..)`在世界坐标（ViewPort）中获取（x，y），但我不知道如何将获取的点转换为本地对象坐标。我尝试了一些操作（请参阅 中的注释`MyRect.unproject(..)`），但它们都不起作用。

```
public class MyLibgdxGame extends Game implements InputProcessor {
    private MyRect obj;
    ...
    public void render() {
        camera.update();

        Gdx.gl.glClearColor(.1f,.1f,.1f,1);
        Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);

        renderer.setProjectionMatrix(camera.combined);

        renderer.begin(ShapeRenderer.ShapeType.Line);
        renderer.setColor(Color.GREEN);
        renderer.line(0,0, 0, 30);
        renderer.setColor(Color.BLUE);
        renderer.line(0,0, 30, 0);
        renderer.end();

        obj.render(renderer);
    }

    public void resize(int width, int height) {
        float units = 100f;
        float aspectRatio = (float) width / (float) height;
        camera = new OrthographicCamera(units * aspectRatio, units);
        camera.update();
    }

    public boolean touchDown(int screenX, int screenY, int pointer, int button) {
        Gdx.app.log("my", String.format("[Touch] x: %d, y: %d", screenX, screenY));
        Vector3 v = new Vector3(screenX, screenY, 0);
        camera.unproject(v);
        Gdx.app.log("my", String.format("[S to VP] x: %.1f, y: %.1f", v.x, v.y));

        // !! convert world coordinate "v" to local object coordinate
        obj.unproject(v);
        Gdx.app.log("my", String.format("[VP to Object] x: %.1f, y: %.1f", v.x, v.y));

        return false;
    }
    ...
}

public class MyRect {

    private Rectangle rect;
    private float angle;
    private Matrix4 transform;

    public MyRect(float x, float y, float w, float h, float angle) {
        this.rect = new Rectangle(x, y, w, h);
        this.angle = angle;

        transform = new Matrix4().translate(x,y,0).rotate(0,0,1,angle);
    }

    public void render(ShapeRenderer renderer) {

        renderer.identity();
        renderer.setTransformMatrix(transform);

        renderer.begin(ShapeRenderer.ShapeType.Rectangle);
        renderer.setColor(Color.RED);
        renderer.rect(0, 0, rect.width, rect.height);
        renderer.end();

        r.begin(ShapeRenderer.ShapeType.Line);
        r.setColor(Color.GREEN);
        r.line(0,0, 0, 30);
        r.setColor(Color.BLUE);
        r.line(0,0, 30, 0);
        r.end();

        renderer.identity();
    }

    public Vector3 unproject(Vector3 v) {
//      return v.mul(transform); // 1
//      return v.prj(transform); // 2
        return v.rotate(0,0,1,angle).sub(new Vector3(rect.x, rect.y, 0)); //3
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-10T08:31:59.237

你搞错了。

```
camera.unproject(v);
Gdx.app.log("my", String.format("[S to VP] x: %.1f, y: %.1f", v.x, v.y));

// !! convert world coordinate "v" to local object coordinate
obj.unproject(v);
Gdx.app.log("my", String.format("[VP to Object] x: %.1f, y: %.1f", v.x, v.y)); 
```

您所说的“本地坐标”是相机坐标。当您取消投影触摸时，您会将屏幕坐标转换为相机坐标。但是你想要的是世界坐标。无需取消投影您的对象，因为这会给您一个无用的向量。只需将您的相机坐标转换为世界坐标并使用这些坐标：

```
camera.unproject(v);
Gdx.app.log("my", String.format("[S to VP] x: %.1f, y: %.1f", v.x, v.y));
x = camera.position.x-camera.viewportWidth+v.x;
y = camera.position.y-camera.viewportHeight+v.y; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-04T23:28:12.093

最快的方法是`MyRect`扩展`Actor`和使用`Actor.stageToLocalCoordinates()`。如果您不想子类`Actor`化，请获取 libgdx 源并查看上述方法。

[演员（libgdx API）](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/Actor.html#stageToLocalCoordinates%28com.badlogic.gdx.math.Vector2%29)

# ruby-on-rails-3 - 如何从 rails 表单设置两个不同的操作？

> ID：15235245
> 
> 赞同：0
> 
> 时间：2013-03-05T22:18:11.593
> 
> 标签：ruby-on-rails-3, form-for

我有一个创建（和更新）材料的导轨表单。显然，默认情况下，当用户登录并检索材料时，表单会呈现更新操作。但是，我希望有一个“另存为”操作，以防用户想要保存另一个版本的材料。显而易见的方法是在控制器中设置一个发送到“更新”的按钮，另一个发送到“新”的按钮，但我不知道如何执行此操作，因为它似乎取决于 form_for 参数。

**更新**

为了避免使用 Javascript，我尝试将 form_for url 更改为：

```
<%= form_for @material, :url => choose_action_path do |f| %> 
```

然后在控制器中我有：

```
def choose_action
  if params[:save_as] == "Save As"
    redirect_to :action => "create"
  else
    redirect_to :action => "update"
  end
end 
```

但这不起作用。这是一个可行的策略还是很疯狂？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T06:46:42.680

你可能可以用一些 jquery 来做到这一点。

假设您正在处理的模型称为电子邮件。当您编辑电子邮件时，使用创建的表单标签具有操作`action='/emails/:id`和方法`method='post'`。隐藏在表单标签下面的是

```
<form accept-charset="UTF-8" action="/email/1" method="post">
  <div style="margin:0;padding:0">
    <input name="_method" type="hidden" value="put" />
    <input name="utf8" type="hidden" value="&#x2713;" />
    <input name="authenticity_token" type="hidden" value="f755bb0ed134b76c432144748a6d4b7a7ddf2b71" />
  </div> 
```

更多信息可以在这里找到：http: [//guides.rubyonrails.org/form_helpers.html#how-do-forms-with-put-or-delete-methods-work](http://guides.rubyonrails.org/form_helpers.html#how-do-forms-with-put-or-delete-methods-work)

额外的代码块使表单提交了一个 put 请求而不是一个 post，它随后映射到控制器的更新操作。要让它将表单发送到创建操作，您需要发布操作“/email”。换句话说，你想将上面的代码操作成类似

```
<form accept-charset="UTF-8" action="/email" method="post"> 
```

注意删除 div 标签。

所以我的建议是创建一个“另存为”按钮，然后添加一些 jquery，当单击“另存为”按钮时，它会进行这些修改。

这个 stackoverflow 答案可能会帮助您使用 jquery [Jquery 来更改表单操作](https://stackoverflow.com/questions/5451600/jquery-to-change-form-action)

# shell - 使用 .bat 文件时 cmd.exe 不会终止

> ID：15235246
> 
> 赞同：3
> 
> 时间：2013-03-05T22:18:12.707
> 
> 标签：shell, windows-7, cmd, switch-statement, desktop-shortcut

^([上下文：我正在尝试使用[此处](https://stackoverflow.com/a/8163798/93394)和[此处](https://stackoverflow.com/a/14541271/93394)大致描述的相对“开始”路径创建 .bat 文件的快捷方式。])

`cmd.exe`支持`/c`开关。根据文档，这应该会导致它“执行命令然后终止”。

`.bat`但是当命令是文件时，该开关似乎被忽略了。例如，如果您使用以下目标创建快捷方式（对于普通的非 bat 命令）：

```
C:\Windows\System32\cmd.exe /c "START /d C:\temp\ notepad.exe test.txt" 
```

一切都按预期工作：记事本打开，控制台（shell）消失。但是，如果您将上面的命令替换为 .bat 文件，如下所示：

```
C:\Windows\System32\cmd.exe /c "START /d C:\temp\ C:\test.bat" 
```

（其中`test.bat`仅包含“ `notepad.exe test.txt`”）记事本像以前一样打开，但控制台像一个不受欢迎的朋友一样粘在身边。为什么？更重要的是，我如何让它消失？

**更新：**我知道我可以使用 wscript，就像在[这个解决方案中](https://stackoverflow.com/a/12656702/93394)一样，但是我失去了拥有自定义图标的选项（我坚持使用默认的 .vbs 图标）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:21:18.620

该`start`命令开始批处理文件的新进程。原始`cmd.exe`进程随后终止，但留下了新进程，因为它正在等待 notepad.exe 终止。

将您的 bat 文件内容更改为：

```
start "" notepad.exe test.txt 
```

然后您的批处理文件将不会等待记事本退出，然后继续执行。

另一件事要尝试：

```
C:\Windows\System32\cmd.exe /c "START /d C:\temp\ C:\test.bat & exit" 
```

核选项是用您选择的（编译）语言编写一个小程序，启动 .bat 文件然后退出。然后你可以给它一个自定义图标，让它做任何你喜欢的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:34:12.900

您还可以从[http://autoitscript.com](http://autoitscript.com)查看 Autoit作为批处理的替代方案。- Run() 命令可以以更好的可预测性来做这种事情。由于它可以生成可执行文件，因此您可以直接从快捷方式链接它。当然，您还可以做更多的事情，例如以不同的用户身份运行、插入延迟或处理错误，这些都是批处理难以做到的。

您不需要完整的工具包，只需下载中的 Aut2EXE 文件夹即可。

顺便说一句，在没有 UPX 压缩的情况下构建您的 exe，因为这会导致 AV 误报。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-15T10:03:30.683

我有点晚了，但这是答案。

状态的[文档](https://ss64.com/nt/start.html)`start`：

```
Syntax
START "title" [/D path] [options] "command" [parameters]  

    If command is an internal cmd command or a batch file then the command  
    processor is run with the /K switch to cmd.exe. This means that the  
    window will remain after the command has been run. 
```

如果`start`用于执行批处理文件，则打开的 cmd 实例不会关闭。

你也可以`call`改用。
`call C:\test.bat`

# ruby-on-rails - 动态错误消息中的 twitter bootstrap glyphicon 链接

> ID：15235252
> 
> 赞同：0
> 
> 时间：2013-03-05T22:18:33.090
> 
> 标签：ruby-on-rails, twitter-bootstrap

我想在 Rails 应用程序中使用 Twitterbootstrap 附带的字形图标。根据文档，

```
All icons require an <i> tag with a unique class, prefixed with icon-. To use, place the following code just about anywhere:
    <i class="icon-remove"></i> 
```

我使用以下代码生成错误消息，但我不知道如何包含标记。

```
 <ul>
      <% @errors.each do | msg| %>
      <li><%= content_tag :div, msg, :id => "flash", :class => "icon-remove" %></li>
    <% end %>

    </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:45:31.497

您只想将图标标签作为`html_safe`字符串包含在内。例如，如果您想在每个元素的开头使用图标（可能通过将类添加到元素来`li`摆脱正常的列表项标记）：`unstyled``ul`

```
<li><%= content_tag :div, "<i class="icon-remove"></i> #{msg}".html_safe, :class => "flash" %></li> 
```

（另外，请注意，设置`id`like 可能会导致多个元素具有相同的`id`，这是您不应该拥有的。）

# python - 选择排序 Python

> ID：15235264
> 
> 赞同：7
> 
> 时间：2013-03-05T22:19:36.973
> 
> 标签：python, sorting

这似乎是一个简单的问题，但是当我尝试在 Python 中实现选择排序时，我没有得到排序列表。我的实现有问题吗？子集可能是个问题。

```
source = [4,2,1,10,5,3,100]
for i in range(len(source)):
  mini = min(source[i:]) #find minimum element
  min_index = source[i:].index(mini)-1 #find index of minimum element
  source[i:][min_index]= source[i:][0] #replace element at min_index with first element
  source[i:][0] = mini                  #replace first element with min element
print source 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-05T22:29:59.640

我认为有几个问题。

首先，当您执行 source[i:] 时，我相信它会返回请求的子元素的新数组，而不是原始数组的一部分，因此如果您修改它，则不要修改原始数组。其次，你不应该从索引中减去 1。

```
source = [4,2,1,10,5,3,100]
for i in range(len(source)):
    mini = min(source[i:]) #find minimum element
    min_index = source[i:].index(mini) #find index of minimum element
    source[i + min_index] = source[i] #replace element at min_index with first element
    source[i] = mini                  #replace first element with min element
print source 
```

这给出了：

```
[1, 2, 3, 4, 5, 10, 100] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T23:01:20.367

这是我将如何重写您的代码。当然，在 Python 中我只是`list.sort()`用来对列表进行排序，但这里是 Python 中的选择排序。

我们创建了一个生成器表达式，`(value, i)`它从列表中返回一个值及其索引的元组。然后当`min()`求最小值时，它找到最低的元组值；由于值在索引之前的元组中首先出现，因此该值将是重要部分，并且`min()`会找到最低值。（如果有平局，`min()`将使用元组的第二部分，索引，作为平局破坏者。但对于排序，我们不关心平局是如何被打破的。）

现在，我们不再搜索子列表以找到最小值，然后再次搜索以找出索引，而是搜索一次并获得最小值和索引。

但我们实际上并不关心最小值；我们关心索引。所以`min()`完成后，我们只是丢弃实际值但保留索引。将索引调整为在整个列表中正确（而不是在列表的切片中），然后我们可以交换。

我们使用标准的 Python 习惯用法来交换两个值。Python 将构建一个元组对象作为中间对象，然后将该元组解包到左侧。

```
lst = [4,2,1,10,5,3,100]

for i_sortpos in range(len(lst)):
    # Make a generator expression to return (value, i) pairs.
    genexp = ((n, i) for i, n in enumerate(lst[i_sortpos:]))
    # Use genexp with min() to find lowest and its index.
    # (Use '_' for variable name for the actual value; we don't use it.)
    _, i_min = min(genexp)
    # Adjust index to be correct in full list.
    i_min += i_sortpos
    # Swap the number at i_sortpos with the lowest found.
    lst[i_sortpos], lst[i_min] = lst[i_min], lst[i_sortpos]

print(lst) 
```

编辑：这是对上述内容的改进。列表中的切片实际上分配了一个新列表；我们这里的代码不需要一个新的列表，它只需要一个方便的方法来检查一个子列表。该`itertools`模块提供了一个函数 ，`islice()`该函数返回一个迭代器，该迭代器对列表的一部分进行迭代。这避免了在我们检查每个子列表时重复创建和销毁列表。

我相信这是在 Python 中进行选择排序的最有效方法。（你可以去掉我们将生成器表达式绑定到名称的部分`genexp`并节省几微秒......只需调用`min()`一个长的单行代码。但这不值得失去可读性。）

```
import itertools as it

lst = [4,2,1,10,5,3,100]

for i_sortpos in range(len(lst)):
    # Make a generator expression to return (value, i) pairs.
    # Use it.islice() for to look at sublist.
    genexp = ((n, i) for i, n in enumerate(it.islice(lst, i_sortpos, len(lst))))
    # Use genexp with min() to find lowest and its index.
    # (Use '_' for variable name for the actual value; we don't use it.)
    _, i_min = min(genexp)
    # Adjust index to be correct in full list.
    i_min += i_sortpos
    # Swap the number at i_sortpos with the lowest found.
    lst[i_sortpos], lst[i_min] = lst[i_min], lst[i_sortpos]

print(lst) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-01T09:54:08.397

```
def selectionSort(List_):
    for i in range(len(List_)):`
        #track the current smallest value
        smallIndex = i
            #loop from the current smallest value
            for j in range(i+1,len(List_))
                if List_[j] < List_[smallIndex]:
                    #if new value is less that our smallest value,change 
                    #smallest value to this
                    smallIndex = j
            if smallIndex != i:
                #swap the values
                List_[smallIndex],List_[i] = List_[i],List_[smallIndex]
    #return sorted list
    return List_ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-18T21:05:04.563

```
def ss(l):    
    for i in range(0,len(l)):
        d=l.index(min(l[i:]))        
        c=l[i]
        l[i]=min(l[i:])
        l[d]=c
        print(l)  #it prints each step of selection sort
y=[10,9,1,5,0,6]
ss(y) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-01-03T20:07:20.510

```
def selSort(L):
    """
    Find the smallest element in the list and put it (swap it) in the first location, 
    Find the second element and put it (swap it) in the second locaiton, and so on. 

    """
    for i in range(len(L) - 1):
        minIndx = i
        minVal= L[i]
        j = i + 1
        while j < len(L):
            if minVal > L[j]:
                minIndx = j
                minVal= L[j]
            j += 1
        temp = L[i]
        L[i] = L[minIndx]
        L[minIndx] = temp 
    return L 
```

称呼：

```
print( selSort([120,11,0,1,3,2,3,4,5,6,7,8,9,10]) ) 
```

输出

```
[0, 1, 2, 3, 3, 4, 5, 6, 7, 8, 9, 10, 11, 120] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-13T10:36:46.970

```
s = [1,8,4,9,3,6,2]
for i in range(len(s)):
    maxi = max(s[0:len(s)-i])     #find max element
    tempi = s.index(maxi)         # find index of max element
    temp = s[len(s)-1-i]          #assign last element as temp
    s[len(s)-1-i] = maxi          #put max element in last position
    s[tempi] = temp               # put the element initially at last in its new 

print s 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-27T05:13:39.290

找到位置（第一个和最后一个），如果最后一个较低，则交换元素。

```
nums = [4,2,1,10,5,3,100]
def sort(nums):
     ###Find the position and now first 0th element is sorted and rest is unsorted
    #Second iteration first 2 element is sorted
    for i in range(len(nums)-1):
        miniposition = i
        for j in range(i,len(nums)):
            if nums[j] < nums[miniposition]:
                miniposition = j
        temp = nums[i]
        nums[i] = nums[miniposition]
        nums[miniposition] = temp
sort(nums)
print (nums) 
```

第一次迭代（交换 4 和 1） `[1, 2, 4, 10, 5, 3, 100]`

```
[1, 2, 4, 10, 5, 3, 100]
[1, 2, 3, 10, 5, 4, 100]
[1, 2, 3, 4, 5, 10, 100]
[1, 2, 3, 4, 5, 10, 100]
[1, 2, 3, 4, 5, 10, 100] 
```

另一种方式

```
nums = [4,2,1,10,5,3,100]
i = 0
while i<len(nums):
    #smallest element in the sublist
    smallest = min(nums[i:])
    #index of smallest element
    index_of_smallest = nums.index(smallest)
    #swapping
    nums[i],nums[index_of_smallest] = nums[index_of_smallest],nums[i]
    i=i+1
print (nums) 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-07-17T17:47:24.217

提供的解决方案略有不同

```
def selection_sort(l):
i = 0
while i < len(l):
    minium_value = min(l[i:]) # minium value at ith iteration
    minium_value_index = l[i:].index(minium_value) # minium value index at i th iteration

    if minium_value < l[i]: # if the current value already min, skip
        l[i + minium_value_index] = l[i] # put current value in min value's index - swap 1
        l[i] = minium_value # set current value with min value- swap 2
    i += 1

return l 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-08-25T03:20:42.530

def selection_sort_min(): # 排序数

```
for i in range(len(num)-1):
    current_min_index = i
    for j in range(i+1,len(num)):
        if  num[j] < num[current_min_index] :
            current_min_index = j
    num[i],num[current_min_index] = num [current_min_index],num[i]
print(num) 
```

数字 = [23,89,12,0,3,7,33]

selection_sort_min()e

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2016-02-19T21:36:25.117

这是我认为对数字列表进行排序的好方法，希望对您有所帮助：

```
list=[5,4,3,1,6,8,10,9]
listsorted=[]
for i in range(len(list)):
    x=min(list)
    list.remove(x)
    listsorted.append(x)
print listsorted 
```

结果将是 [1, 3, 4, 5, 6, 8, 9, 10]

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2017-10-28T17:54:28.917

我认为这里的“接受”答案没有帮助。如果我们看一下

```
mini = min(source[i:]) #find minimum element
min_index = source[i:].index(mini) #find index of minimum element 
```

这不仅在不必要地创建列表切片方面效率低下，而且不必要地搜索它们。它相当简洁，但我认为这不是最好的解决方案。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-04-16T10:18:37.130

```
def Selection_Sort(Sarray):
    length = len(Sarray)
    i = 0
    j = 0
    for i in range(length):
        j = i+1
        for j in range(length):
            if Sarray[i] < Sarray[j]
                t = Sarray[i]
                Sarray[i] = Sarray[j]
                Sarray[j] = t
        j = j+1
        i = i+1

    return Sarray 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2015-07-16T08:35:53.437

**麻省理工学院在线课程的选择排序代码。**

```
def selSort(L):
    for i in range(len(L) - 1):
        minIndx = i
        minVal = L[i]
        j = i+1
        while j < len(L):
            if minVal > L[j]:
                minIndx = j
                minVal = L[j]
            j += 1
        if minIndx != i:
            temp = L[i]
            L[i] = L[minIndx]
            L[minIndx] = temp 
```

* * *

## 回答 #14

> 赞同：-2
> 
> 时间：2015-08-25T05:07:04.880

```
def selectSort(L):
  for i in range(len(L)):
    print L
    minIndex = i
    minValue = L[i]
    j = i + 1
    while j < len(L):
        if minValue > L[j]:
            minIndex = j
            minValue = L[j]  
        j +=1
    temp = L[i]
    L[i] = L[minIndex]
    L[minIndex] = temp 
```

# php - PHP：仅在If语句中列出数量值大于0的项目

> ID：15235267
> 
> 赞同：1
> 
> 时间：2013-03-05T22:19:52.790
> 
> 标签：php

'你好

我正在尝试从客户填写的“订单”中获取项目，以仅列出客户指定数量值为 1 或更多的项目作为采购订单收据发送，一旦他们生成并通过电子邮件发送点击提交。

这是我到目前为止在这方面的内容：

```
$i = 1;
$imax = 4;

echo "Products<br />";
echo "-------------------------------------------------------------<br />";

while ($i <= $imax) {

$itemqty = ${'qty'.$i};
$itempn = ${'pn'.$i};
$itemdesc = ${'desc'.$i};
$itemprice = ${'value'.$i};
$itemtotalprice = ${'elinetotal'.$i};

    if ($itemqty !== 0) {
            echo $itemqty . " x " . $itemdesc . " (" . $itempn . ") @ $" . $itemprice . " ea. = $" . $itemtotalprice . "<br />";
    }
$i++;
} 
```

它正确列出了所有内容，除了它不忽略值为 0 的项目。它将像这样列出它们：

```
Products
-------------------------------------------------------------
0 x Item #1 Description (HOSE-12) @ $155.00 ea. = $0.00
5 x Item #2 Description (GAUGE-2) @ $51.00 ea. = $255.00
0 x Item #3 Description (PTC) @ $0.70 ea. = $0.00
10 x Item #4 Description (PT-234R) @ $15.94 ea. = $159.40 
```

这可能是最简单的解决方法，但是任何人都可以对此有所了解吗？我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:23:34.483

我最初的猜测是`$itemqty`字符串`'0'`。尝试使用*不等于*运算符，例如

```
if ($itemqty != 0) 
```

而不是*不相同*的运算符，即`!==`

否则，您可以尝试将`$itemqty`分配转换为整数，例如

```
$itemqty = (int) ${'qty'.$i}; 
```

# actionscript-3 - 当用户单击单选按钮时播放声音！闪存 AS3

> ID：15235272
> 
> 赞同：0
> 
> 时间：2013-03-05T22:20:12.087
> 
> 标签：actionscript-3, flash, button, radio

使用单选按钮进行问答游戏，当用户在单击单选按钮时出错时，我想要一个嗡嗡声。我怎么做？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T01:03:45.173

您可以使用 Sound 类加载并播放声音：http: [//help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/Sound.html)

要让它在您单击单选按钮时播放，您可以向单选按钮添加一个侦听器以检查用户何时单击它，然后检查他们单击了哪个答案并在需要时播放声音。

RadioButton 类：[http ://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/controls/RadioButton.html](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/fl/controls/RadioButton.html)

# c++ - 无法在 QStyledItemDelegate 中绘制复选框

> ID：15235273
> 
> 赞同：1
> 
> 时间：2013-03-05T22:20:14.627
> 
> 标签：c++, qt, model-view-controller

我有一个派生视图的`QStyledItemDelegate`派生对象。`QTableView`我进一步根据模型索引数据类型委派绘画和编辑器的创建。对于`bool`s 我想通过一个复选框来表示状态 - 但该复选框从未出现。

这是基本委托绘制函数：

```
void Sy_QtPropertyDelegate::paint( QPainter* painter,
                                   const QStyleOptionViewItem& option,
                                   const QModelIndex& index ) const
{
    painter->save();

    if ( index.column() == 0 ) {
        ...
    } else {
        QVariant var = index.data();
        bool modified = index.data( Sy_QtPropertyModel::ModifiedRole ).toBool();

        //  If the data type is one of our delegates, then push the work onto
        //  that.
        auto it = delegateMap_.find( var.type() );
        if ( it != delegateMap_.end() ) {
            ( *it )->paint( painter, option, index );
        } else if ( var.type() != QVariant::UserType ) {
            ...
        } else {
            ...
        }
    }

    painter->restore();
} 
```

以及`bool`子委托绘制功能：

```
void Sy_boolPD::paint( QPainter* painter,
                       const QStyleOptionViewItem& option,
                       const QModelIndex& index ) const
{
    painter->save();

    bool checked  = index.data().toBool();
    bool modified = index.data( Sy_QtPropertyModel::ModifiedRole ).toBool();

    QStyle* style = Sy_application::style();
    if ( modified ) {
        QStyleOptionViewItemV4 bgOpt( option );
        bgOpt.backgroundBrush = QBrush( Sy_QtPropertyDelegate::ModifiedColour );
        style->drawControl( QStyle::CE_ItemViewItem, &bgOpt, painter );
    }

    QStyleOption butOpt( option );
    butOpt.state = QStyle::State_Enabled;
    butOpt.state |= checked ? QStyle::State_On : QStyle::State_Off;
    style->drawControl( QStyle::CE_CheckBox, &butOpt, painter );

    painter->restore();
} 
```

如果我强制`modified`为真，则背景是表格的颜色已适当更改，并且ing`cout`和成员显示它们是正确的 - 但没有显示复选框！设置为任何其他类型也不会导致任何渲染。`butOpt``rect``state``QStyle::CE_CheckBox`

我经常使用 Qt 的 MVC 框架，但我看不出我在哪里出错了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T19:08:31.327

我所要做的就是查看源代码...

```
case CE_CheckBox:
    if (const QStyleOptionButton *btn = qstyleoption_cast<const QStyleOptionButton *>(option)) {
    ...
    } 
```

传递给该方法的`QStyleOption`I 被强制转换为特定于绘制控件的类型，`CE_CheckBox`需要 a `QStyleOptionButton`，如果强制转换失败，则绘图操作会静默跳过。

# php - 隐藏“从空值创建默认对象”输出

> ID：15235278
> 
> 赞同：0
> 
> 时间：2013-03-05T22:20:33.000
> 
> 标签：php, html, parsing, error-handling

我知道有人问过有关修复此错误的问题，但我不想修复它，我想隐藏它。我知道正在发生的问题，但基本上，我不在乎，因为脚本完全按照我想要的方式工作。

根据用户点击的链接，下一页会解析内容并编辑 HTML。有时，HTML 数据不包含我指定的 div，这对我来说没问题。那么我该如何隐藏呢？例如，使用简单的 HTML 解析器，我有以下代码：

```
$boo->find('div[class*=container]', 0)->innertext = ''; 
```

这就是说所有包含“容器”一词的类都应该将内部文本更改为空。基本上摆脱了我不想要的数据。但是某些页面内容没有任何带有容器的 div，我认为这就是我收到此警告的原因。那么我能做些什么来简单地忽略它呢？有什么方法可以表达一个 if 语句吗？请指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:34:50.547

怎么样

```
$element = $boo->find('div[class*=container]', 0);
if ($element) {
    $element->innertext = '';
} 
```

或者

```
foreach($boo->find('div[class*=container]') as $element) 
       $element->innertext = ''; 
```

# ruby-on-rails - Rake 任务仅导入一行 txt 文件

> ID：15235285
> 
> 赞同：0
> 
> 时间：2013-03-05T22:21:03.207
> 
> 标签：ruby-on-rails, ruby-on-rails-3, import, rake, rake-task

我写了许多简单的 rake 文件来将 txt 文件导入我的 mysql。除了一个模型，一切都完美无缺。我没有错误，所以我不知道发生了什么。

rake 只导入第一行。其他都没有！

顺便说一下，txt 是 UTF8 编码的。

可能是配方关联的 counter_cache 吗？

**导轨 3.1**

**模型：**

```
class Recipe < ActiveRecord::Base
    belongs_to :chef, :counter_cache => true
    belongs_to :category, :counter_cache => true
    belongs_to :cuisine, :counter_cache => true
    belongs_to :festivity, :counter_cache => true
    belongs_to :daily, :counter_cache => true

    after_update :update_counter

    # Setup accessible (or protected) attributes for your model
    attr_accessible :name,
                    :slug,
                    :description,
                    :ingredients,
                    :steps,
                    :...
                    :status_id,
                    :created_at,
                    :updated_at

    STATUS = { 'Não publicada' => 0, 'Publicada' => 1, 'Invisível' => 4 }
    def status
        STATUS.invert[status_id]
    end

    private

    def update_counter
        if category_id_changed?
            Category.increment_counter(:recipes_count, category_id)
            Category.decrement_counter(:recipes_count, category_id_was)
        end
        if cuisine_id_changed?
            Cuisine.increment_counter(:recipes_count, cuisine_id)
            Cuisine.decrement_counter(:recipes_count, cuisine_id_was)
        end
        if festivity_id_changed?
            Festivity.increment_counter(:recipes_count, festivity_id)
            Festivity.decrement_counter(:recipes_count, festivity_id_was)
        end
        if daily_id_changed?
            Daily.increment_counter(:recipes_count, daily_id)
            Daily.decrement_counter(:recipes_count, daily_id_was)
        end
    end
end 
```

**耙文件：**

```
namespace :db do
    desc "import data from files to database"
    task :import_recipe => :environment do
        puts "Importing Recipe..."
        # recipe.txt
        File.open("lib/tasks/data/recipe.txt", "r").each do |line|
            id, name, slug, description, ingredients, steps, other_tips, cook_time, recipe_yield, diet, light, lactose_intolerance, vegetarian, microwave, video_url, chef_id, category_id, cuisine_id, festivity_id, daily_id, likes_count, rating, ratings_count, views_count, comments_count, status_id, created_at, updated_at = line.strip.split("\t")
            d = Recipe.new(
                :id => id,
                :name => name,
                :slug => slug,
                :description => description,
                :ingredients => ingredients,
                :steps => steps,
                :...
                :status_id => status_id,
                :created_at => created_at,
                :updated_at => updated_at
                )
                d.save!
            end
        puts "=========== > FINISHED!"
    end
end 
```

# android - OnClick函数中的Android参数

> ID：15235289
> 
> 赞同：3
> 
> 时间：2013-03-05T22:21:25.030
> 
> 标签：android, onclick, textview

我有一张 16 (4x4) 的桌子`TextViews`。如果单击其中一个，我想更改其颜色并从布尔数组中标记或取消标记。

在我的 .xml 中，`TextViews`看起来像这样：

```
<TextView
    android:id="@+id/bonus0"
    android:layout_width="0dip"
    android:layout_height="50dip"
    android:layout_weight="0.25"
    android:layout_margin="1dip"
    android:background="#FFFFFF"
    android:textIsSelectable="false"
    android:onClick="ClickTurnColor"
    android:clickable="true"
    android:textSize="25sp" 
/> 
```

所以点击`TextView`应该启动该`ClickTurnColor()`功能。在这个函数中，我需要函数中的一些变量`onCreate()`。当我尝试将它们作为函数的参数传递时`ClickTurnColor()`，我得到了错误。

有谁能够帮助我？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:22:53.660

在外面声明你需要的变量`onCreate()`，在里面初始化`onCreate()`，然后在`ClickTurnColor`方法中使用。您必须恢复其方法定义，使其仅接受一个参数（视图）：

```
public void ClickTurnColor (View v)
{
 //implementation
} 
```

另外，请记住，Java 命名约定规定方法应以小写字母开头。

`onCreate()`或者，如果您确实必须将这些变量保留在本地，请采用非 xml 方法并将侦听器设置在内部：

```
button.setOnClickListener (new OnClickListener () {
  @Override
  public void onClick (View v)
  {
    //use your variables here
  }
}); 
```

但是，`final`如果这些变量不是实例变量并且您将它们保留在`onCreate()`.

此外，由于您确实提到您有一个网格，您可以尝试使用 a[`GridView`](https://developer.android.com/reference/android/widget/GridView.html)和使用 an [`OnItemClickListener`](https://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)。它仍然带有我之前提到的警告（使局部变量成为非局部变量或将它们声明为`final`），但根据您的需要，它可能会更干净。

# fortran - 为什么这个 Fortran 随机数生成器会导致分段错误？

> ID：15235290
> 
> 赞同：0
> 
> 时间：2013-03-05T22:21:40.703
> 
> 标签：fortran, fortran90

`ran0`我从文本*Numerical Recipes*中获取了以下功能。我编写了自己的程序`random2`来调用`ran0`.

为什么这段代码会导致分段错误？谢谢你的时间。

```
FUNCTION ran0(idum)
  INTEGER idum,IA,IM,IQ,IR,MASK
  REAL ran0,AM
  PARAMETER (IA=16807,IM=2147483647,AM=1./IM,IQ=127773,IR=2836,MASK=123459876)
  INTEGER k
  idum=ieor(idum,MASK)
  k=idum/IQ
  idum=IA*(idum-k*IQ)-IR*k
  if (idum.lt.0) idum=idum+IM
  ran0=AM*idum
  idum=ieor(idum,MASK)
  return
END FUNCTION

PROGRAM random2
  IMPLICIT NONE
  REAL :: ran0
  PRINT *, ran0(6)
END PROGRAM 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T22:33:39.773

您将常量 6.0 作为 IDUM 虚拟参数传递给您的函数。然后，您（尝试）使用 idum = ieor(...) 等行修改此参数。您实际上是在尝试修改常量。

6.0 的值现在已经固定了一段时间——足够长，以至于大多数程序员都希望在 5.0 和 7.0 之间找到它。请不要尝试更改它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T00:13:59.760

扩展 IanH 的答案，如果你用更现代的 Fortran 部分重写它：

```
module my_subs

contains

FUNCTION ran0(idum)
  INTEGER, intent(inout) :: idum
  INTEGER IA,IM,IQ,IR,MASK
  REAL ran0,AM
  PARAMETER (IA=16807,IM=2147483647,AM=1./IM,IQ=127773,IR=2836,MASK=123459876)
  INTEGER k
  idum=ieor(idum,MASK)
  k=idum/IQ
  idum=IA*(idum-k*IQ)-IR*k
  if (idum.lt.0) idum=idum+IM
  ran0=AM*idum
  idum=ieor(idum,MASK)
  return
END FUNCTION

end module my_subs

PROGRAM random2
  use my_subs
  IMPLICIT NONE
  !REAL :: ran0
  PRINT *, ran0(6)
END PROGRAM 
```

将参数标识为具有`intent(inout)`属性的输入和输出并将子例程放在模块中并使用该模块允许编译器检查参数的一致性，编译器很可能会发现这个问题。例如，gfortran 输出：

```
PRINT *, ran0(6)
              1
Error: Non-variable expression in variable definition context (actual argument to INTENT = OUT/INOUT) at (1) 
```

# bash - 设计用于提取未知文件名部分的 bash 脚本

> ID：15235295
> 
> 赞同：0
> 
> 时间：2013-03-05T22:22:01.273
> 
> 标签：bash

我必须做一个简单的设计，但我不知道怎么做

我有两个文件夹文件夹 A 和文件夹 B。在文件夹 A 内，我有两个名为“file_”和“file_anything”的文件。第二个文件的“任何”部分是一些我不知道的文本（或者对于不同的文件夹可能不同）。我需要做的是将文件夹B的名称更改为任何文本是“任何东西”，而无需特别知道

如果在程序之外有人给我一个指向您用来理解并能够修改或调整解决方案以适应其他情况的主题的链接，我会很感激。我想学习

谢谢

编辑：我需要将此解决方案包含在 bash 脚本（无 perl 函数）中，该脚本将对许多具有相同结构的文件夹重复。例如：

FolderA（带有文件“file_”和“file_manana”）和FolderB---更改为---> FolderA和manana（以前的FolderB）

FolderC（带有文件“file_”和“file_monkey”）和FolderD---更改为---> FolderA和monkey（以前的FolderD）

FolderE（带有文件“file_”和“file_moose”）和FolderF---更改为---> FolderA和moose（以前的FolderF）

很多次有更多的文件夹

编辑2：

好的，我越来越近了。现在的问题是：我这样定义 fn：fn=file_a* 知道该文件夹中只有一个与该指示匹配的文件。我确认这样做 echo $fn。现在我这样做：fn=${fn##*_}。但是，fn 不会转换为“anything”，而是转换为“a*”。我该怎么解决？@大卫扎斯拉夫斯基

编辑 3：谢谢@chepner。BASH_REMATCH 是要走的路。我稍作改动就使用它，因为您编写它的方式对我不起作用

```
for f in FolderA/file_*; do # I assume a single match
[[ $f =~ "file_"(.*) ]]
suffix=${BASH_REMATCH[1]}
mv FolderB "$suffix"
done 
```

注意引号。在它们之间我什至可以包含空格

谢谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:36:54.520

您需要在[Bash 手册](http://linux.die.net/man/1/bash)中查找参数扩展。如果您将 的名称存储`file_anything`在变量中，例如`fn`，您可以使用从文件名`${fn##*_}`中删除最长的前缀匹配`*_`，然后您可以在`mv`命令中使用它来重命名文件夹 B。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T13:22:07.887

我不太明白您的最终结果应该是什么，但是您可以`file_anything`使用以下内容提取尾随部分：

```
$ f="file_manana"
$ [[ $f =~ file_(.*) ]]
$ suffix=${BASH_REMATCH[1]}
$ echo $suffix
manana 
```

所以我认为你想做的是

```
for f in FolderA/file_*; do # I assume a single match
    [[ $f =~ file_(.*) ]]
    suffix=${BASH_REMATCH[1]}
    mv FolderB "$suffix"
done 
```

# ios - 在某个位置拖放图像以及动画/效果

> ID：15235299
> 
> 赞同：0
> 
> 时间：2013-03-05T22:22:19.457
> 
> 标签：ios, ipad, animation, ios6

我正在尝试在 iPad 上创建一个简单的模拟应用程序：在右侧有一把钥匙，我必须将钥匙拖放到屏幕底部中心的锁中：钥匙目前是一个图像并且锁也是一个图像。

我的问题：
1）我怎么知道钥匙在锁的顶部，因此我可以让锁变成绿色，并且如果可能的话，钥匙会随着动画消失？

2）如何移动钥匙（就像它已经从右边的垂直条上分离了一样），当掉在锁上时变成绿色，否则保持不变？

3) 锁打开时的任何动画（这是一个插件查询）？

对于这种模拟，我应该采用什么方法？

到目前为止，我将图像用作按钮，并且 onPress 正在显示一些功能，但我不知道如何处理运动和动画/效果。

请指导我，以便我可以达到上述要求。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:21:23.113

您可以将 UIPanGestureRecognizer 用于拖动手势。在识别器的操作中，您可以检查识别器的状态。

当手势处于开始状态时，获取手势的当前点。然后，使用 hitTest 查看关键图像视图是否在手势开始时位于手指下方。如果是，请存储关键图像的来源，以便您可以添加到它。

使用手势的属性为连续动作的关键图像视图设置动画（移动）。

当手势处于结束状态时，再做一次点击测试，看看你是否超过了锁定。

# perl - 给定与 Perl 的成对关系列表，如何创建唯一集？

> ID：15235301
> 
> 赞同：2
> 
> 时间：2013-03-05T22:22:33.690
> 
> 标签：perl, list, set, unique

背景：我从生物数据的聚类中得到了一些结果，这些结果显示了集群之间共享连接的数量。我想要完成的是将此成对关系列表减少为基于共享连接的唯一标识符集。数据格式很简单，它有三列显示 1) 集群 ID *i*、2) 集群 ID *j*和 3) *i*和*j*之间的共享连接数。实际数据的示例在下面的代码中。

这是我到目前为止的代码：

```
#!/usr/bin/env perl

use v5.10;
use strict;
use warnings;

my %linkage;

while (my $line = <DATA>) {
    my ($i, $j, $score) = split /\s+/, $line;
    if (exists $linkage{$i} && not exists $linkage{$j}) {
        push @{$linkage{$i}}, $j;
    }
    elsif (exists $linkage{$j}) {
        push @{$linkage{$j}}, $i;
    }
    else {
        $linkage{$i} = [$j];
    }
}

for my $key (sort keys %linkage) {
    say join "\t", $key, join ",", @{$linkage{$key}};
}

__DATA__
CL21    CL9     2628
CL36    CL33    2576
CL29    CL59    2384
CL65    CL36    2318
CL65    CL47    2151
CL32    CL17    2147
CL21    CL31    2136
CL23    CL17    2092
CL94    CL59    2091
CL16    CL11    2088 
```

这会产生：

```
CL16    CL11
CL21    CL9,CL31
CL23    CL17
CL29    CL59
CL32    CL17
CL36    CL33,CL65
CL65    CL47
CL94    CL59 
```

这里有两个问题，我想要一些帮助/建议来解决。第一个问题是第二列（即CL17）中仍然存在重复条目，我想减少它。第二个问题是，如果以前曾见过一个标识符，则应该将其添加到现有分组中，而不是开始一个新组（即 CL65）。请注意，我没有在此示例中保留输出中的值，但您可以看到输入按降序排序，因此（对我而言）根据所见内容以这种方式建立分组是有意义的。

期望的输出：

```
CL16,CL11
CL21,CL9,CL31
CL23,CL17,CL32
CL29,CL59,CL94
CL36,CL33,CL65,CL47 
```

我希望从这个期望的输出中可以清楚地看出，每一行都应该是一个唯一的集合（并且在上面的代码/输出中添加了选项卡，以便更容易地查看问题）。如果以前有人问过这样的问题，或者在其他页面上说明过这样的问题，请告诉我（在这种情况下我很抱歉）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:11:53.253

[Graph::UnionFind](http://search.cpan.org/perldoc?Graph%3A%3AUnionFind)模块是为这个问题编写的，计算[集分区](https://en.wikipedia.org/wiki/Partition_of_a_set)。

```
#!/usr/bin/env perl

use v5.10;
use strict;
use warnings;

use Graph::UnionFind;

my $uf = Graph::UnionFind->new;
my %vertex;
while (my $line = <DATA>) {
    my ($i, $j, $score) = split /\s+/, $line;

    ++$vertex{$_} for $i, $j;
    $uf->union($i, $j);
}

my %cluster;
foreach my $v (keys %vertex) {
    my $b = $uf->find($v);
    die "$0: no block for $v" unless defined $b;
    push @{ $cluster{$b} }, $v;
}

say join ",", @$_ for values %cluster;

__DATA__
CL21    CL9     2628
CL36    CL33    2576
CL29    CL59    2384
CL65    CL36    2318
CL65    CL47    2151
CL32    CL17    2147
CL21    CL31    2136
CL23    CL17    2092
CL94    CL59    2091
CL16    CL11    2088 
```

输出：

```
CL9、CL21、CL31
CL33、CL65、CL47、CL36
CL59、CL94、CL29
CL11,CL16
CL17、CL23、CL32
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:52:32.000

The following codes creates the hash in the opposite sense: each identifier is a key, the value is the identifier of the group (by chance equal to one of its members). At the end, the hash is reversed to the structure you tried to build and printed. I am not sure whether the "merging" might occur in your data (imagine `CL9 CL11 3000` as the last line), if not, you can safely remove it.

```
#!/usr/bin/perl
use warnings;
use strict;
use feature qw(say);

my %linkage;

while (my $line = <DATA>) {
    my ($i, $j, $score) = split ' ', $line;
    if (exists $linkage{$i}) {
        if (exists $linkage{$j}) {
            warn "Merging $i and $j\n";
            $linkage{$_} = $linkage{$i} for grep $linkage{$_} eq $linkage{$j}, keys %linkage;
        }
        else {
            warn "Adding $j to $i\n";
            $linkage{$j} = $linkage{$i};
        }
    }
    elsif (exists $linkage{$j}) {
        warn "Adding $i to $j\n";
        $linkage{$i} = $linkage{$j};
    }
    else {
        warn "New $i and $j to $i\n";
        @linkage{$i, $j} = ($i) x 2;
    }
}

my %groups;
for my $key (keys %linkage) {
    push @{ $groups{ $linkage{$key} } }, $key;
}

for my $key (sort keys %groups) {
    say join ',' => @{ $groups{$key} };
} 
```

# ios - iOS 画圈

> ID：15235302
> 
> 赞同：8
> 
> 时间：2013-03-05T22:22:37.170
> 
> 标签：ios, quartz-graphics, geometry, drawrect

我正在尝试在我的 iOS 应用程序中创建以下圆圈。我知道如何制作圆圈，但不完全确定如何沿着弧线获得点。它必须在代码中而不是图像中。下面也是我目前拥有的代码。

![在此处输入图像描述](../Images/ae5053530c2767b6f965d8f0f7d095d8.png)

```
 - (void)drawRect:(CGRect)rect
{
    CGPoint point;
    point.x = self.bounds.origin.x + self.bounds.size.width/2;
    point.y = self.bounds.origin.y + self.bounds.size.height/2;

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextSetLineWidth(context, 2.0);

    CGContextSetStrokeColorWithColor(context, [UIColor blueColor].CGColor);

    CGRect circle = CGRectMake(point.x/2,point.y-point.x/2,point.x,point.x);

    CGContextAddEllipseInRect(context, circle);

    CGContextStrokePath(context);

    for (int i = 0; i<8; i++) {
        CGRect circleMini = CGRectMake(??????,??????,point.x/4,point.x/4);

        CGContextAddEllipseInRect(context, circleMini);
        CGContextStrokePath(context);
    }

} 
```

更新答案

```
 float cita = 0;
for (int i = 0; i<8; i++) {

    CGPoint pointCir = CGPointMake(point.x/2 + radius * cos(cita) , (point.y-point.x/2) + radius * sin(cita) );
    CGRect circleMini = CGRectMake(pointCir.x,pointCir.y,radius/4,radius/4);

    CGContextAddEllipseInRect(context, circleMini);
    CGContextStrokePath(context);
    cita += M_PI / 4.0;
} 
```

![在此处输入图像描述](../Images/e50c28fa8501154bb608a67753f569b8.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T22:31:28.857

如果 (x,y) 是圆心，r 是大圆的半径，则第 i 个外圆的圆心将是：

```
 center(i) = ( x + r * cos(cita) , y + r * sin(cita) ) 
```

从 0 开始 cita 并为下一个圆增加 PI/4 弧度（或 45 度）

**工作实施**

```
CGFloat cita = 0;
CGFloat bigCircleRadius = point.x / 2.0;
CGFloat smallCircleRadius = bigCircleRadius / 4.0;
for (int i = 0; i < 8; i++) {

    CGPoint smallCircleCenter = CGPointMake(point.x  + bigCircleRadius * cos(cita) - smallCircleRadius/2.0 , point.y + bigCircleRadius * sin(cita) - smallCircleRadius / 2.0 );
    CGRect smallCircleRect = CGRectMake(smallCircleCenter.x,smallCircleCenter.y,smallCircleRadius,smallCircleRadius);

    CGContextAddEllipseInRect(context, smallCircleRect);
    CGContextStrokePath(context);
    cita += M_PI / 4.0;
} 
```

编辑：添加了实现和重命名的变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-24T14:01:02.177

```
 - (void)drawRect:(CGRect)rect
{
    const NSUInteger kNumCircles = 8u; ``CGFloat height = CGRectGetHeight(rect);

    CGFloat smallCircleRadius = height / 10.0f;

    CGRect bigCircleRect = CGRectInset(rect, smallCircleRadius / 2.0f, smallCircleRadius / 2.0f);
    CGFloat bigCircleRadius = CGRectGetHeight(bigCircleRect) / 2.0f;

    CGPoint rectCenter = CGPointMake(CGRectGetMidX(rect), CGRectGetMidY(rect));

    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextSetLineWidth(context, 2.0f);

    CGContextSetStrokeColorWithColor(context, [UIColor blueColor].CGColor);

    CGContextAddEllipseInRect(context, bigCircleRect);

    CGContextStrokePath(context);

    CGFloat alpha = 0;

    for (NSUInteger i = 0; i < kNumCircles; i++)
    {
        CGPoint smallCircleCenter = CGPointMake(rectCenter.x  + bigCircleRadius * cos(alpha) - smallCircleRadius/2.0f , rectCenter.y + bigCircleRadius * sin(alpha) - smallCircleRadius / 2.0f );
        CGRect smallCircleRect = CGRectMake(smallCircleCenter.x,smallCircleCenter.y,smallCircleRadius,smallCircleRadius);

        CGContextAddEllipseInRect(context, smallCircleRect);
        CGContextStrokePath(context);
        alpha += M_PI / (kNumCircles / 2.0f);
    }`` `}`
```

# html - 图像周围的神秘填充/边距

> ID：15235305
> 
> 赞同：4
> 
> 时间：2013-03-05T22:22:47.683
> 
> 标签：html, css

请参阅以下 jsFiddle：http: [//jsfiddle.net/Leng/kQvNH/](http://jsfiddle.net/Leng/kQvNH/)

谁能解释为什么每行水平点周围似乎都有大量的填充（上面大约 15 像素，下面大约 4 像素）？图像只有 2px 高。填充从哪里来？

**请注意：**

对我来说，只有在我开始使用 HTML5 标题的文档时**才会**出现这种围绕图像的神秘填充：

```
<!DOCTYPE html>
<html> 
```

*当我使用 -任何其他*- 标题时，图像**正常显示**（无填充），例如 HTML4 或网页的此 XHTML 标题：

 *```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"> 
```

所以这似乎是 HTML5 的不一致。我想切换到标准的 HTML5 标题，但是这个小小的烦恼阻止了我这样做。

感谢您的任何指导。

**解决方案：**

这是带有解决方案的 jsFiddle：http: [//jsfiddle.net/Leng/Sn2PC/](http://jsfiddle.net/Leng/Sn2PC/)

```
img
{
    display:block;
    margin:0 auto;
} 
```

这是基于下面克里斯的回答。

*请注意，设置 font-size:0 或 line-height:0**不是**解决方案，因为这（显然）会混淆字体大小和行高。*

同样，将显示设置为阻止并建立自动边距对于在 HTML4 或 XHTML 中完成正常、居中、未填充的图像不是必需的。

HTML5 已经创建了这个“功能”，其中图像是内联的，并且将根据行高或字体大小进行填充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:27:25.570

我认为这是因为`img`元素是内联的。将`font-size`or设置`line-height`为一些小的东西可以解决这个问题。或者，将图像设置为`display: block`并在其上设置高度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:34:56.023

您的`<img>`标签显示为内联，因此它与普通文本一起使用。只需将容器的 line-height 更改为更接近图像高度和 font-size ( 1px) 即可解决此问题。

因此，为了解释填充，您的图像周围没有填充。它是一个空的文本行，其高度（行高）由用户代理定义。

[在这里摆弄](http://jsfiddle.net/QbkXs/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:29:18.723

你可以添加一个 line-height:2px; #theDiv 风格*

# c# - 使用 WebClient 和 C#，即使响应为 (400) 错误请求，我如何获取返回的数据？

> ID：15235308
> 
> 赞同：12
> 
> 时间：2013-03-05T22:22:55.747
> 
> 标签：c#, webclient, http-status-code-400

我正在使用[Google Translate API](https://developers.google.com/translate/)并尝试捕获出现[错误](https://www.googleapis.com/language/translate/v2?key=INSERT-YOUR-KEY&source=en&target=de&q=Hello%20world)时返回的数据。（仅供参考：我知道 API 密钥是错误的，我只是在测试这个）。

问题在于，您可以通过单击链接看到浏览器显示错误信息，但 C# 抛出 WebException 并且我似乎无法获取响应数据。

这是我的代码：

```
string url = "https://www.googleapis.com/language/translate/v2?key=INSERT-YOUR-KEY&source=en&target=de&q=Hello%20world";
WebClient clnt = new WebClient();

//Get string response
try
{
    strResponse = clnt.DownloadString(url);
    System.Diagnostics.Debug.Print(strResponse);
}
catch (Exception ex)
{
    System.Windows.Forms.MessageBox.Show(ex.Message);
    return null;
} 
```

即使响应是（400）错误请求（或任何其他错误响应），我如何获得返回的 JSON 错误？我是否需要使用 a 以外的其他类`WebClient`？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-05T22:38:38.897

这可能会帮助你

```
catch ( WebException exception )
{
   string responseText;

   using(var reader = new StreamReader(exception.Response.GetResponseStream()))
   {
     responseText = reader.ReadToEnd();
   }
} 
```

这将为您提供 json 文本，然后您可以使用您喜欢的任何方法从 JSON 转换。

检索自：[将 WebClient 错误作为字符串获取](https://stackoverflow.com/questions/7036491/get-webclient-errors-as-string)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:37:29.707

我会捕捉到您收到的特定异常-它将包含有关失败的相关数据。

根据 MSDN，[WebException.Response](http://msdn.microsoft.com/en-us/library/system.net.webexception.response.aspx)将包含从服务器收到的响应。

一旦您能够从此响应对象中检索 JSON 数据，您就需要自己反序列化它。

# java - 如何确定字符串是否不是正则表达式？

> ID：15235309
> 
> 赞同：5
> 
> 时间：2013-03-05T22:23:02.410
> 
> 标签：java, regex

我正在尝试提高某些代码的性能。它看起来像这样：

```
public boolean isImportant(String token) {
    for (Pattern pattern : patterns) {
        return pattern.matches(token).find();
    }
} 
```

我注意到许多模式似乎是没有正则表达式构造的简单字符串文字。所以我想简单地将它们存储在一个单独的列表（importantList）中并进行相等测试，而不是执行更昂贵的模式匹配，如下所示：

```
public boolean isImportant(String token) {
    if (importantList.contains(token)) return true;

    for (Pattern pattern : patterns) {
        return pattern.matches(token).find();
    }        
} 
```

如何以编程方式确定特定字符串是否不包含正则表达式结构？

编辑：我应该补充一点，答案不需要对性能敏感。（即可以使用正则表达式） 我主要关心 isImportant() 的性能，因为它被调用了数百万次，而模式的初始化只进行了一次。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:32:00.387

我通常讨厌这样说的答案，但是...

不要那样做。

它可能不会使代码运行得更快，实际上它甚至可能导致程序花费更多时间。

如果你真的需要优化你的代码，你可以去很多更有效的地方。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T22:32:05.010

这将是困难的。您可以检查是否存在任何正则表达式元字符；这应该是一个很好的近似值：

```
Pattern regex = Pattern.compile("[$^()\\[\\]{}.*+?\\\\]");
Matcher regexMatcher = regex.matcher(subjectString);
regexIsLikely = regexMatcher.find(); 
```

值不值是另一个问题。您确定正则表达式匹配比列表查找慢（尤其是因为在许多情况下您将在此之后进行正则表达式匹配）？我敢打赌，保持正则表达式匹配会快得多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T22:32:26.920

没有办法确定它，因为每个正则表达式模式只不过是一个字符串。此外，现在几乎没有性能差异，因为正则表达式现在很聪明，我很确定，如果模式和源长度相同，那么首先要做的就是权益检查

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:55:28.840

这是错误的

```
 for (Pattern pattern : patterns) 
```

您应该创建一个对所有模式进行 OR 运算的大正则表达式；然后对于每个输入，您只匹配一次。

# git - 如何将 git 提交从 master 移动到不同的现有分支

> ID：15235312
> 
> 赞同：38
> 
> 时间：2013-03-05T22:23:14.057
> 
> 标签：git, branch

`master`我签入了一些应该签入的提交`develop`。我使用什么 git 命令从主分支中删除这些提交并包含在开发分支中？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-06T17:07:46.557

如果我没记错的话，你有两个同步的分支， `master`和`dev`，只是在你提交之前忘记切换分支。

如果是这样，我们有：

```
----------------
git log in dev

xxx
yyy
...
---------------- 
```

和：

```
----------------
git log in master

ccc
bbb
aaa
        <---- here you forgot to switch branch
xxx
yyy
...
---------------- 
```

解决方案是：

首先，请确保：

```
git status -s 
```

返回空结果。

接下来，获取所有新的`master`提交`dev`：

```
git checkout dev
git merge master 
```

现在返回给你`master`：

```
git checkout master 
```

删除不必要的提交：

```
git reset --hard HEAD~3 
```

该数字`~3`是您要删除的提交数。

记住：`git status -s`必须返回空结果。否则，`git reset --hard`可能会导致数据丢失。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-05T22:30:35.743

您可以`cherry-pick`将您的提交提交到您的分支`develop`，然后以交互方式提交：`rebase``master`

1.  `git checkout develop`
2.  `git cherry-pick aabbcc`
3.  `git cherry-pick ddeeff`
4.  ……
5.  `git checkout master`
6.  `git rebase 123456 -i`

`123456`犯错之前的提交在哪里。这将打开一个编辑器，显示每个受变基影响的提交。删除与您要丢弃的提交相对应的行并退出编辑器。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-05T22:30:50.173

为了应对另一个分支，您可以使用樱桃采摘：

```
git cherry-pick <commit> 
```

删除不是那么容易。您可以使用 rebase 和 squash 或编辑提交：

```
git rebase -i <commit>~1 
```

但是我不确定在变基期间选择编辑时是否也可以编辑文件而不是只编辑提交消息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:33:30.180

通常有几种方法可以在 git 中做同样的事情一种可能的方式：

```
git checkout develop
git cherry-pick XXX // XXX being the sha1 of the commit you want to grab
git checkout master
git rebase --interactive HEAD~IDX // IDX being the position of the last "good" commit compared to HEAD 
```

最后一条命令将显示从 HEAD 到最后一次良好提交的所有评论，您所要做的就是删除提交的行以移动到分支开发

# html - CSS - 绝对在固定范围内，滚动溢出和 100% 高度

> ID：15235317
> 
> 赞同：8
> 
> 时间：2013-03-05T22:23:22.127
> 
> 标签：html, css

我正在尝试使用某种可滚动的覆盖来消除网站的其余部分。我似乎无法在我的固定元素中的绝对元素上获得 100% 的高度。

[http://codepen.io/intellix/pen/GBltK](http://codepen.io/intellix/pen/GBltK)

```
section {
  background: red;
  position: fixed;
  top:0;
  right:0;
  bottom:0;
  left:0;
  overflow-x:auto;

}

article {
  background: blue;
  position: absolute;
  top:0;
  width:300px;
  bottom: 0;
  left: 0;
} 
```

如果我设置底部：0；在绝对元素上，当页面不溢出时它会填充高度。当页面溢出时，它会留下一个间隙。

当我在我的绝对元素上使用底部：自动时，它会用溢出填充高度，但会留下一个没有溢出的间隙！

如果您调整窗口大小使内容适合，然后调整大小使内容不适合，您会看到它在这两种情况下都不起作用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T22:41:55.943

I think you want to use min-height and bottom:auto here.

```
article {
  background: blue;
  position: absolute;
  top:0;
  width: 300px;
  bottom: auto;
  min-height: 100%;
  left: 0;
} 
```

The reason you need `min-height:100%;` and can't use `height:100%;` is because when the `section` content in scrollable it's height is actually **greater** than 100%.

Longer explination:

With positioned (`position: relative|fixed|absolute;`) elements, percentage based heights are determined relative to their offset parents. In the case of the `article` element, it's offset parent is the `section` element.

The `section` element uses `top:0px;` and `bottom:0px;` to determine it's height. These values are determined by the height of it's offset parent which is the `html` element

`html` is a special case where `height:100%;` is the size of the view-able window, which is why your scrollable element has a height larger than 100%.

# httpwebrequest - Sitecore 上下文和 HttpWebRequest

> ID：15235318
> 
> 赞同：1
> 
> 时间：2013-03-05T22:23:33.190
> 
> 标签：httpwebrequest, sitecore, sitecore6

是否可以通过 HttpWebRequest 传递 Sitecore 凭据？下面的代码效果很好，除了被调用的 asmx 以匿名用户身份执行。我希望能够将 sitecore 当前用户凭据传递给我正在调用的页面。

```
CookieContainer cookieJar = new CookieContainer();
HttpWebRequest req = (HttpWebRequest)WebRequest.Create("ttp://localhost/file.asmx");
req.Headers.Add("SOAPAction", "\"h_ttp://tempuri.org/Register\"");
req.ContentType = "text/xml;charset=\"utf-8\"";
req.Accept = "text/xml";
req.Method = "POST";
req.ContentLength = 0;
req.CookieContainer = cookieJar;
WebResponse response = req.GetResponse();
Stream responseStream = response.GetResponseStream();
StreamReader respStrm = new StreamReader(response.GetResponseStream(), System.Text.Encoding.ASCII);
string responseITem = respStrm.ReadToEnd();
HttpContext.Current.Response.Write(responseITem);
HttpContext.Current.Response.End(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T07:37:38.223

Sitecore 用户凭据信息存储在 cookie 中。因此，您可以将客户端 cookie 添加到您的 http 请求中：

```
HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(url);
request.CookieContainer = new CookieContainer();
HttpCookieCollection userCookies = Request.Cookies;
for (int userCookieCount = 0; userCookieCount < userCookies.Count; userCookieCount++)
{
    HttpCookie httpCookie = userCookies.Get(userCookieCount);
    Cookie cookie = new Cookie();
    /*  We have to add the target host because the cookie does not contain the domain information.
        In this case, this behaviour is not a security issue, because the target is our own platform.
        Further informations: http://stackoverflow.com/a/460990 
    */
    cookie.Domain = request.RequestUri.Host;
    cookie.Expires = httpCookie.Expires;
    cookie.Name = httpCookie.Name;
    cookie.Path = httpCookie.Path;
    cookie.Secure = httpCookie.Secure;
    cookie.Value = httpCookie.Value;

    request.CookieContainer.Add(cookie);
} 
```

您还可以查看我们的 Sitecore 错误管理器模块。在那里，我们还创建了发送客户端 cookie 的 http 请求（参见第 149-170 行）：

[https://github.com/unic/SitecoreErrorManager/blob/master/Modules.ErrorManager/Controls/BaseError.cs](https://github.com/unic/SitecoreErrorManager/blob/master/Modules.ErrorManager/Controls/BaseError.cs)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T23:07:17.457

您需要将当前用户凭据添加到请求中，以便您可以在 asmx Web 服务中检索它们并使用凭据记录用户以便设置上下文。

```
// add the credentials to the Post method
var credentials = "yourCredentials";
req.ContentLength = credentials.Length;
using (var dataStream = req.GetRequestStream())
{
  dataStream.Write(credentials, 0, credentials.Length);
} 
```

在您的 asmx 网络服务中，您可以仅使用用户名或从请求中检索到的用户名和密码的组合登录。

```
Sitecore.Security.Authentication.AuthenticationManager.Login(userName); 
```

编辑：以纯文本形式发送凭据时，此处存在安全风险，请至少使用 HTTPS 以使其更安全。

# sql - SQL Server 案例语句

> ID：15235320
> 
> 赞同：1
> 
> 时间：2013-03-05T22:23:35.377
> 
> 标签：sql, sql-server

我有一个问题，我想不通，它应该很快，但我还没有看到类似的东西。所以这是我的主要问题，我有一个案例陈述，它定义了一个基于经理的团队，所以它看起来像：

```
"team" = case
    when manager = 'manager1' then 'team1'
    ...
    when manager = 'managerN' then 'teamN'
    else 'Other'
end 
```

然后我想找到一种方法来创建一个新列“proj”，这样它就是项目，除非团队是“其他”，所以我希望它看起来像：

```
"proj" = case
    when team = 'Other' then 'Other'
    else project
end 
```

但在语法不正确或团队不是有效列的情况下，我不断收到错误消息。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:30:57.843

```
Use Northwind
GO

select 

[Hemisphere] = case
    when derived1.Continent = 'Europe' then 'Eastern'
    when derived1.Continent = 'North America' then 'Western'
    when derived1.Continent = 'South America' then 'Western'
    else 'Other Hemisphere'
end 
, derived1.Continent
, derived1.Country
from (

select c.Country , 
[Continent] = case
    when c.Country = 'Germany' then 'Europe'
    when c.Country = 'France' then 'Europe'
    when c.Country = 'Sweden' then 'Europe'
    when c.Country = 'Denmark' then 'Europe'
    when c.Country = 'Finland' then 'Europe'
    when c.Country = 'Switzerland' then 'Europe'
    when c.Country = 'Poland' then 'Europe'
    when c.Country = 'Norway' then 'Europe'
    when c.Country = 'Ireland' then 'Europe'
    when c.Country = 'Austria' then 'Europe'
    when c.Country = 'Italy' then 'Europe'
    when c.Country = 'Portugal' then 'Europe'
    when c.Country = 'Belgium' then 'Europe'
    when c.Country = 'Spain' then 'Europe'
    when c.Country = 'UK' then 'Europe'
    when c.Country = 'Spain' then 'Europe'
    when c.Country = 'Mexico' then 'North America'
    when c.Country = 'USA' then 'North America'
    when c.Country = 'Canada' then 'North America'
    when c.Country = 'Brazil' then 'South America'
    when c.Country = 'Argentina' then 'South America'
    when c.Country = 'Venezuela' then 'South America'
    else 'Other Continent'
end

from [dbo].[Customers] c
) as derived1 
```

# java - 自定义Tomcat日志类需要ServletContext

> ID：15235324
> 
> 赞同：0
> 
> 时间：2013-03-05T22:23:45.637
> 
> 标签：java, tomcat, servlets, java.util.logging

我必须为 Tomcat 使用自定义记录器。扩展`java.util.logging.Handler`我实现了到自定义记录器的桥梁。它通过`WEB-INF/classes/logging.properties`.

但它需要通过战争中的属性文件进行配置。所以我需要 ServletContext 来做`servletContext.getResourceAsStream(iniFileName)`。由于自定义 Logger 是由 java 日志记录机制创建的，因此我无法从 Servlet 构造函数或通过依赖注入获取 ServletContext。

在创建任何 Servlet 之前如何获取 ServletContext？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:40:43.320

创建一个 ServletContextListener 并以编程方式实例化您的处理程序。如果您必须通过 loggin.property 实例化它，您仍然可以通过 logger API 查找您的处理程序实例并随后对其进行配置。

# android - 调用 DatePickerDialog 时应用程序崩溃

> ID：15235326
> 
> 赞同：0
> 
> 时间：2013-03-05T22:23:55.953
> 
> 标签：android, android-intent, nullpointerexception

我开始在开发人员控制台中为我的一个应用程序显示以下 NullPointerException

```
java.lang.NullPointerException at com.lead.soft.deve.myapp.ae.onDateSet(Unknown Source) at
android.app.DatePickerDialog.tryNotifyDateSet(DatePickerDialog.java:148) at 
android.app.DatePickerDialog.onStop(DatePickerDialog.java:155) at 
android.app.Dialog.dismissDialog(Dialog.java:335) at 
android.app.Dialog.dismiss(Dialog.java:311) at 
com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:178) at
android.os.Handler.dispatchMessage(Handler.java:99) at 
android.os.Looper.loop(Looper.java:155) at 
android.app.ActivityThread.main(ActivityThread.java:5454) at 
java.lang.reflect.Method.invokeNative(Native Method) at 
java.lang.reflect.Method.invoke(Method.java:511) at 
com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1029) at 
com.android.internal.os.ZygoteInit.main(ZygoteInit.java:796) at 
dalvik.system.NativeStart.main(Native Method) 
```

我正在使用此代码添加和编辑存储在 App MySQL 数据库中的日期“DOB”，请注意我删除了不适用于我收到的错误的代码

```
package com.leaders.software.development.myleadersbook;
import java.util.Calendar;
import android.app.Activity;
import android.app.DatePickerDialog;
import android.app.DatePickerDialog.OnDateSetListener;
import android.app.Dialog;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.WindowManager;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.DatePicker;
import android.widget.EditText;
import android.widget.Spinner;
import android.widget.TextView;

public class tab2 extends Activity implements View.OnClickListener {
Button ConfirmButton, CallSpouseButton, EmailSpouseButton, HomePhoneButton,
        WorkPhoneButton, CellPhoneButton, EmailAddressButton, SMSButton;

private static final int HELP_ID = Menu.FIRST;
private Long mRowId;
private NotesDbAdapter mDbHelper;
private TextView mdobText;
private TextView mdobDisplay;
private Button mPickdob;
private Calendar dobDate;

static final int DATE_DIALOG_ID = 0;

private TextView activeDateDisplay;
private Calendar activeDate;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    mDbHelper = new NotesDbAdapter(this);
    mDbHelper.open();
    this.getWindow().setSoftInputMode(
            WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
    setContentView(R.layout.tab2);

    mdobText = (TextView) findViewById(R.id.dob);

    /* capture our View elements for the start date function */
    mdobDisplay = (TextView) findViewById(R.id.dob);
    mPickdob = (Button) findViewById(R.id.pickdob);
    /* get the current date */
    dobDate = Calendar.getInstance();
    /* add a click listener to the button */
    mPickdob.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {
            showDateDialog(mdobDisplay, dobDate);
        }
    });

    mRowId = null;
    mRowId = (savedInstanceState == null) ? null
            : (Long) savedInstanceState
                    .getSerializable(NotesDbAdapter.KEY_ROWID);
    if (mRowId == null) {
        Bundle extras = getIntent().getExtras();
        mRowId = extras != null ? extras.getLong(NotesDbAdapter.KEY_ROWID)
                : null;
    }

    populateFields();

private void updateDisplay(TextView dateDisplay, Calendar date) {
    dateDisplay.setText(new StringBuilder()
            // Month is 0 based so add 1
            .append(date.get(Calendar.MONTH) + 1).append("-")
            .append(date.get(Calendar.DAY_OF_MONTH)).append("-")
            .append(date.get(Calendar.YEAR)).append(" "));
}

public void showDateDialog(TextView dateDisplay, Calendar date) {
    activeDateDisplay = dateDisplay;
    activeDate = date;
    showDialog(DATE_DIALOG_ID);
}

private OnDateSetListener dateSetListener = new OnDateSetListener() {
    // @Override
    public void onDateSet(DatePicker view, int year, int monthOfYear,
            int dayOfMonth) {
        activeDate.set(Calendar.YEAR, year);
        activeDate.set(Calendar.MONTH, monthOfYear);
        activeDate.set(Calendar.DAY_OF_MONTH, dayOfMonth);
        updateDisplay(activeDateDisplay, activeDate);
        unregisterDateDisplay();
    }
};

private void unregisterDateDisplay() {
    activeDateDisplay = null;
    activeDate = null;
}

@Override
protected Dialog onCreateDialog(int id) {
    switch (id) {
    case DATE_DIALOG_ID:
        return new DatePickerDialog(this, dateSetListener,
                activeDate.get(Calendar.YEAR),
                activeDate.get(Calendar.MONTH),
                activeDate.get(Calendar.DAY_OF_MONTH));
    }
    return null;
}

@Override
protected void onPrepareDialog(int id, Dialog dialog) {
    super.onPrepareDialog(id, dialog);
    switch (id) {
    case DATE_DIALOG_ID:
        ((DatePickerDialog) dialog).updateDate(
                activeDate.get(Calendar.YEAR),
                activeDate.get(Calendar.MONTH),
                activeDate.get(Calendar.DAY_OF_MONTH));
        break;
    }
}

private void populateFields() {
    if (mRowId != null) {
        Cursor note = mDbHelper.fetchNote(mRowId);
        startManagingCursor(note);
        mdobText.setText(note.getString(note
                .getColumnIndexOrThrow(NotesDbAdapter.KEY_DOB)));

    }
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    saveState();
    outState.putSerializable(NotesDbAdapter.KEY_ROWID, mRowId);
}

@Override
protected void onDestroy() {
    super.onDestroy();
    if (mDbHelper != null) {
        mDbHelper.close();
    }
}

@Override
protected void onPause() {
    super.onPause();
    saveState();
}

@Override
protected void onResume() {
    super.onResume();
    populateFields();

}

private void saveState() {

    String dob = mdobText.getText().toString();

    if (mRowId == null) {
        long id = mDbHelper.createNote(dob);
        if (id > 0) {
            mRowId = id;
        }
    } else {
        mDbHelper.updateNote(mRowId, dob);
    }
}
} 
```

作为在黑暗中的镜头，我将以下内容添加到清单文件中。但仍然没有运气

```
 android:configChanges="orientation" 
```

在我将上述代码添加到我的清单文件后，我在运行 2.3 版的测试手机上不再出现此错误，但其他一些人仍然这样做

会不会是“”之间的空格？

```
.append(date.get(Calendar.YEAR)).append(" ")); 
```

**我也发现这个搜索**

**在活动中添加此代码：**

```
@Override

public void onConfigurationChanged(Configuration newConfig) {
super.onConfigurationChanged(newConfig);
} 
```

**并在清单文件中使用它：**

```
<activity android:name="MyActivity" android:label="@string/app_name" 
android:configChanges="orientation|keyboardHidden"></activity> 
```

**这是一个很好的解决方案吗**

# graphics - DWG 图形文件格式是位图还是矢量？

> ID：15235330
> 
> 赞同：0
> 
> 时间：2013-03-05T22:24:02.563
> 
> 标签：graphics, bitmap, vector-graphics, dwg

DWG 图形文件格式是位图格式还是矢量格式？或者两者都可以？

[DWG 维基百科文章](http://en.wikipedia.org/wiki/Dwg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:35:29.563

DWG 是 cad 文件扩展名，包含以数学方式描述正在建模的对象的数据。CAD 程序使用 DWG 文件中包含的数据来动态生成模型的不同视图（图像）。DWG 文件本身既不是位图也不是矢量图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T19:18:15.853

我将用外行的话重申下面已经写过的内容：

DWG 存储 3D 几何图形，而不是图像。几何是用点、线、多边形等来描述的。

虽然 2D 矢量图像也可以用点、线和多边形（也称为“形状”）来描述，但 3D 几何图形的文件格式从不用于存储 2D 矢量图像。

至于位图，它们是完全不同的鱼缸，DWG 绝对与此无关。

感谢您提出将其作为答案的建议，Rob！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:40:32.283

它不是真正的图像文件。它存储有关 CAD 模型的信息。请参阅此页面以了解复杂的内部：

[http://libdwg.sourceforge.net/en/index.html](http://libdwg.sourceforge.net/en/index.html)

# database - 如何以正确的顺序执行业务对象

> ID：15235331
> 
> 赞同：1
> 
> 时间：2013-03-05T22:24:04.843
> 
> 标签：database, object, uml

假设我有两个业务对象或实体：人员和地址。班级人，班级地址

```
Person *-----* Address 
```

现在，有人填写了 Web 表单并输入了他的个人数据（姓名、姓氏、街道）。所有数据都通过查询字符串正确传输到网络服务器。

现在，我想知道如何使用业务类和方法以正确的方式存储这些数据？哪种方法是正确的？我怎么知道正确的？

第一个选项：

```
$person = new Person(name, surname)  
$person.setAddress(street)
$person.saveToDB();  
// within setAdress an instance of Address-Class -> .setAddress(street){new Address(street)} 
```

或者

第二个选项：

```
$address = new Address(Street)  
$address.setPerson(name,surname)
$address.saveToDB();   
// within setPerson an instance of Person-Class -> setPerson(name,surename){new Person(name,surname)} 
```

我怎么知道正确的顺序？我对此有点困惑！以及如何处理 DB-Insertion，因为我融化了 2 个 BO，并且必须将其保存在数据库中的两个不同表中？我完全搞砸了！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T14:42:14.030

取决于您的域。在某些域中，地址将归个人所有（例如运输系统），而在其他域中，该人将由地址所有（例如地图应用程序）。因此，正确的解决方案取决于您的域。

其次，有许多 orm（对象关系映射）框架可以为您处理所有数据库交互。选择与您的语言和品味相匹配的一种并使用它。

# asp.net - 扩展功能 $("#someId").button('loading') 在 asp.net 中不起作用

> ID：15235334
> 
> 赞同：0
> 
> 时间：2013-03-05T22:24:23.713
> 
> 标签：asp.net, twitter-bootstrap, webforms

我一直无法使用属于 Bootstarp js 文件的任何函数，我在 aspx 页面的头部引用了它。之前引用的 jquery 是最新的（1.9）并且工作正常。

```
<script src="Scripts/jquery-1.9.1.js"></script>
<script src="Scripts/bootstrap.js"></script> 
```

但是当我尝试使用这些组件的扩展功能做某事时，我不断收到“.button 不是功能”错误。可能是什么原因？或者你认为我的代码的哪些部分是相关的？我已经能够在其他页面上运行这些功能，但我能找到的唯一区别是页面有一个表单元素设置为 runat="server"。这可能与它有关吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T14:27:46.793

## 不知道为什么，但从页面中删除表单元素可以解决问题。不加载js文件的表单是什么？

一个 div 的类设置为 ""form-horizantel" 它以某种方式与表单元素冲突。

# html - 只是好奇 Soundcloud.com 中的标题

> ID：15235338
> 
> 赞同：2
> 
> 时间：2013-03-05T22:24:38.340
> 
> 标签：html, google-chrome

有人意识到 的标题`soundcloud.com`略大于网络浏览器上的其他选项卡（特别是`Google Chrome`）。这是在网站内编码的吗？如果是这样怎么办？

的字体粗细`Deadmau5`看起来比文字略大`html - Just curious...`。

![在此处输入图像描述](../Images/8e503ee0eab26258dc625fceeaf6da78.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:50:28.460

出于某种原因， ▶ char 在 char 周围的单词上应用粗体，试试这个：

*   打开控制台（在 chrome 上键入 F12 并单击“控制台”选项卡）
*   类型：`document.title = "aaa - aaa▶aaa aaa - aaa";`

只有第一个和最后一个“aaa”将是正常字体大小。

有关此字符的更多信息：http: [//www.charbase.com/25b6-unicode-black-right-pointing-triangle](http://www.charbase.com/25b6-unicode-black-right-pointing-triangle)

它似乎与其他一些字符相同（例如：▧，◖，◚，...）

但这可能是一个错误，取决于一些想法：

*   操作系统
*   浏览器
*   操作系统使用的字体
*   真型激活

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T23:39:39.740

这可能是因为字体的变化，但简单的方法是使用`Ascii`字符。例如：

✁：`<title>&#9985;</title>`

♛：`<title>&#9819;</title>`

➨：`<title>&#10152;</title>`

试试这个链接中有趣的字符：http: [//nwmtwd.com/misc_character_sets.html](http://nwmtwd.com/misc_character_sets.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:14:40.493

正如有人在评论中指出的那样，这是由文本前面的字符引起的。注意删除时的区别

![在此处输入图像描述](../Images/38693095495fcd0b30fe171d80616c5c.png)

必须有更多的东西然后这个。我使用网络检查器将 SoundCloud 标题中的字符添加到此页面，但它似乎没有相同的效果。

![在此处输入图像描述](../Images/0752a3ec29352067959a69f576f2f0e8.png)

# facebook - 扩展 Facebook auth_token

> ID：15235339
> 
> 赞同：0
> 
> 时间：2013-03-05T22:24:38.787
> 
> 标签：facebook

尝试扩展从 Facebook JS SDK 代码收到的 auth_token 时出现以下错误。

URL : [https://graph.facebook.com/oauth/access_token?client_id=229083900472938&client_secret=XXXXXXXXX&grant_type=fb_exchange_token&fb_exchange_token=AAADQWcCC7moBAPM9OlZCpOYnZBoxWnX7MwpP86HHMQM2QAe1DkW9cAI3AaSxVXEPNo7NOnljYCawSg3pgLWtvRph9dhfgZBqK4vt4YB5ZAYCpaiJu71o](https://graph.facebook.com/oauth/access_token?client_id=229083900472938&client_secret=XXXXXXXXX&grant_type=fb_exchange_token&fb_exchange_token=AAADQWcCC7moBAPM9OlZCpOYnZBoxWnX7MwpP86HHMQM2QAe1DkW9cAI3AaSxVXEPNo7NOnljYCawSg3pgLWtvRph9dhfgZBqK4vt4YB5ZAYCpaiJu71o)

{ "error": { "message": "Cannot access application using the specified access_token", "type": "OAuthException", "code": 1 } }

如果我更改 URL 以包含使用 Graph API 资源管理器生成的令牌，它工作正常。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-24T08:31:51.103

我们在测试我们的应用程序时遇到了这样的问题。Facebook 的测试用户在扩展访问令牌上有一个错误，但真实用户没有。

问题是：我们有国家限制，而测试用户没有国家。

所以也要检查你的应用程序的限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-07T05:53:55.710

我遇到了这个问题，并直接从 FB 工程师那里获得了一些支持。此错误的最可能原因是用户的“人口统计检查”。

我们的应用程序有一个年龄限制，因为它与酒精有关。某些用户的个人资料没有包含足够的信息，无法让 FB 确保他们超过其所在位置的饮酒年龄，因此会话创建失败。为什么这只发生在这个电话上而不是以前的电话上，我不知道。

您的应用程序是否有年龄限制或类似的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T00:30:19.657

使用调试器调试令牌并确保它与上面提供的 APP ID 匹配。

消息很清楚，您使用的令牌不适用于 access_token。

可能是您将令牌与 Graph API Explorer 应用程序或其他应用程序混合在一起。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-03T13:44:54.377

使用以下代码生成代码；获得访问代码后，您可以将其交换为扩展代码。代码的最后一部分显示了如何调试：

```
$app_id = "XXXXXXXXX";
$app_secret = "YYYYYYYYYYYY";
$redirect_url = "http://www.example.com/page.php";
$fb_code = $_REQUEST['code'];

if(!$fb_code)
{ 
    $login_dialog_url= "http://www.facebook.com/dialog/oauth?"
    . "client_id=" .  $app_id 
    . "&redirect_uri=" . urlencode( $redirect_url)
    .  "&scope=read_friendlists,read_stream,xmpp_login,user_online_presence,friends_online_presence,create_event,publish_stream&response_type=code";
    echo("<script>location.href='" . $login_dialog_url . "'</script>");
}
else
{
    $token_url="https://graph.facebook.com/oauth/access_token?"
    . "client_id=" . $app_id 
    . "&redirect_uri=". urlencode($redirect_url)
    . "&client_secret=" . $app_secret
    . "&code=" . $fb_code;
    $response = file_get_contents($token_url);
    parse_str($response, $params);
    $access_token = $params['access_token'];
    echo 'Access Token: '.$access_token.'<br>'; 
```

如果需要，在此处生成扩展代码

```
 if($access_token) 
    {
        $token_url="https://graph.facebook.com/oauth/access_token?"
        . "client_id=" . $app_id 
        . "&redirect_uri=". urlencode($redirect_url)
        . "&client_secret=" . $app_secret
        . "&grant_type=fb_exchange_token"
        . "&fb_exchange_token=" . $access_token;
        $response = file_get_contents($token_url);
        parse_str($response, $params);
        $extended_access_token = $params['access_token'];
        echo 'Extended Access Token: '.$extended_access_token;
    } 
```

在这里调试扩展代码：

```
 $expires = "https://graph.facebook.com/debug_token?input_token=$access_token&access_token=$extended_access_token";
    $response = file_get_contents($expires);
    echo "<pre>";
            print_r(json_decode($response));
    echo "</pre>"; 
```

# php - 输出 在电子邮件中 php

> ID：15235341
> 
> 赞同：2
> 
> 时间：2013-03-05T22:24:54.330
> 
> 标签：php, html, email

如何在使用 php mail() 函数发送的电子邮件中输出主题中断 (<hr>)。在电子邮件中，它显示为 <hr> 本身，而不是主题中断。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:27:06.917

查看示例 4：

[http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)

```
<?php
// multiple recipients
$to  = 'aidan@example.com' . ', '; // note the comma
$to .= 'wez@example.com';

// subject
$subject = 'Birthday Reminders for August';

// message
$message = '
<html>
<head>
  <title>Birthday Reminders for August</title>
</head>
<body>
  <p>Here are the birthdays upcoming in August!</p>
  <table>
    <tr>
      <th>Person</th><th>Day</th><th>Month</th><th>Year</th>
    </tr>
    <tr>
      <td>Joe</td><td>3rd</td><td>August</td><td>1970</td>
    </tr>
    <tr>
      <td>Sally</td><td>17th</td><td>August</td><td>1973</td>
    </tr>
  </table>
</body>
</html>
';

// To send HTML mail, the Content-type header must be set
$headers  = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Additional headers
$headers .= 'To: Mary <mary@example.com>, Kelly <kelly@example.com>' . "\r\n";
$headers .= 'From: Birthday Reminder <birthday@example.com>' . "\r\n";
$headers .= 'Cc: birthdayarchive@example.com' . "\r\n";
$headers .= 'Bcc: birthdaycheck@example.com' . "\r\n";

// Mail it
mail($to, $subject, $message, $headers);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:29:19.760

如果您想在使用 mail() 发送的电子邮件中使用 HTML，则必须添加一个 Content-type 标头以声明该电子邮件应被解析为 HTML。请参阅[http://php.net/manual/en/function.mail.php中的示例 4](http://php.net/manual/en/function.mail.php)

# d3.js - d3 图例，缺少文本标签和重复值

> ID：15235343
> 
> 赞同：1
> 
> 时间：2013-03-05T22:25:00.910
> 
> 标签：d3.js, duplicates, legend, labels, nested

我一直在探索如何在绘图中添加图例并在绘制新类型的转换后更新图例。我遇到了两个我无法解决的问题。

该块在这里 [http://bl.ocks.org/natemiller/df4b96809580fe7d00a6](http://bl.ocks.org/natemiller/df4b96809580fe7d00a6)

示例 JSON 数据集包括几个不同的变量（温度、pH、名称、y 等），我试图开发的是一个图，它改变了在 x 轴上绘制的变量以及确定数据填充的变量单击按钮时的点。到目前为止，我的 x 轴发生了变化，点移动得当，图例颜色也发生了变化。但是，我有两个问题。

1.  我缺少图例文本（标签）。我不清楚为什么没有显示它们，但我认为这是我遗漏的一个小细节。我将不胜感激任何帮助。

2.  正如您在数据集中看到的那样，有几个“样本”来自同一站点，或者具有相同的 pH 值（7.2、8.0、7.2、7.2、8.0、8.0、7.6），或者具有相同的温度（30、25、25 , 30, 30, 25, 25)。因此，当我在此处的代码中生成图例时...

    ```
    varlegend = svg.selectAll('rect')
       .data(data)
       .enter().append("rect")
       .attr('x', width-50)
       .attr('y', function(d,i) {return i*20;})
       .attr('width', 10)
       .attr('height', 10)
       .style('fill', function(d) { 
         return color(d.name);
       }); 
    ```

...并使用 d.name 设置颜色我得到 7 个矩形（每个值一个），当填充颜色由站点或 pH 设置时，我宁愿有 3 个矩形（如果填充由 temp 设置，则有两个）给定一些值是重复的。有没有办法做到这一点？我考虑过 d3.nest，但是当我开始转换时，我不再希望数据按名称嵌套，而是按 pH 值嵌套（因此填充由 d.pH 设置）。我很感激对此的任何评论。我这样做是不是太复杂了？有没有更简单的方法我应该考虑实现同样的目标？

谢谢你的时间和帮助，内特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:52:23.207

2 - 当您提供 .data 值时，您还可以提供一个返回唯一标识值的函数。像这样的东西：

```
varlegend = svg.selectAll('rect')
   .data(data, function(d) { return d.name })
//... 
```

从[selection.data](https://github.com/mbostock/d3/wiki/Selections#wiki-data)的文档中：*“要控制数据如何连接到元素，可以指定一个键函数。这取代了默认的按索引行为”*

1 - 关于未显示的文本，我认为问题是缺少“stroke”属性。你可能已经得到了白底白字。但是，要考虑的另一种方法是使用“g”标签来保存矩形和文本。像这样的东西：

```
var legend = svg.selectAll('.legend')
      .data(data, function(d) { return d.name; })
      .enter().append('g')
      .attr('class', 'legend')
      .attr('ID', function(d) { return d.name })
      .attr("transform", function(d,i) {
        return "translate(" + 800 + "," + i*20 + ")";
      });

legend.append("rect")
      .attr('width', 10).attr('height', 10)
      .style('fill', function(d) { 
        return color(d.name);
      });

legend.append("text")
      .attr('x', 25).attr('y', 10)
      .text(function(d) { return d.name; })
      .attr("font-family","sans-serif")
      .attr("font-size","11px")
      .attr("stroke","black"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T04:21:31.340

问题 1：文本未显示，因为您无法将文本附加到 SVG 中的矩形。也就是说，一个矩形不能像一个容器。你的问题是你已经指定了`legend = svg.selectAll('rect')`，这意味着下面的说法是`legend.append("text")`行不通的。因此，解决方案正如 explunit 建议的那样：将数据加入`g`（组），然后分别将矩形和文本附加到该组。

问题 2：一种方法是首先创建一个删除重复条目的数组，然后将该数组用于您的图例数据连接。这是一个例子：

```
var legendData = d3.values(data.map(function (d) { return d.temp; }))

var unique = legendData.filter(function (elem, pos) {
   return legendData.indexOf(elem) == pos; }) 
```

这是您的`unique`数组，其中包含：`[30, 25]`.

为了缓解头痛，我建议您将所有 .enter() 和 .transition() 放在一个可以传递数据的重绘函数中。因此，您可以首先按 pH 或温度过滤图例数据，然后将新创建的数组传递给重绘函数，图例将转换，同时删除旧的/不需要的元素。有关如何布置重绘功能的信息，请参阅 Mike Bostock 关于[通用更新模式的帖子。](http://bl.ocks.org/mbostock/3808234)

# facebook - 如何使用 FQL 列出我的朋友？

> ID：15235349
> 
> 赞同：4
> 
> 时间：2013-03-05T22:26:10.670
> 
> 标签：facebook, c#-4.0, facebook-c#-sdk, facebook-fql

我正在尝试使用 Facebook-SDK 版本 6.1.4 列出我所有朋友的生日当我使用下面的代码时（即没有 FQL，它运行良好，但我无法获得生日，只有名称和 id 值） .

```
 var client = new FacebookClient(access_token);
    dynamic me = client.Get(myusername);
    client.IsSecureConnection = true;
    friendListData = client.Get("/" + me.id + "/friends?fields=name,id");
    JObject job = JObject.Parse(friendListData.ToString()); 
```

因此，我尝试将代码与 FQL 一起使用，但它会引发异常。

```
 var client = new FacebookClient(access_token);
    client.IsSecureConnection = true;
    dynamic me = client.Get(myusername);
    //var id = me.id;

    Facebook.JsonObject friendListData = new Facebook.JsonObject();
        try
        {
            friendListData = (Facebook.JsonObject)client.Get("fql",
                new
                {
                    q = new
                    {
                        name = "SELECT name, birthday, email, uid FROM user WHERE uid in (SELECT uid2 FROM friend WHERE uid1 = me()) AND birthday_date != 'null' ORDER BY birthday_date"
                    }
                });
        }
        catch (FacebookOAuthException facebookAuth)
        {
    //"(OAuthException - #102) A user access token is required to request this resource."
        } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T00:08:40.760

检查是否正在设置 access_token 并打印它，然后在调试器中检查它。

对于 FQL 调用，

这是基于月份内的常见字母，特别*是 a*、*e*和*u*。从那里可以做 strpos 来匹配这些。

`SELECT name, birthday, email, uid FROM user WHERE uid in (SELECT uid2 FROM friend WHERE uid1 = me()) AND (strpos(lower(birthday),"a") >=0 OR strpos(lower(birthday),"e") >=0 OR strpos(lower(birthday),"u") >=0) ORDER BY birthday_date`

这应该拉出所有`null`不包含任何字母的空值（根据空值的定义，而不是字母本身）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T18:07:10.367

[使用 Windows PowerShell 和http://facebookpsmodule.codeplex.com](http://facebookpsmodule.codeplex.com)很容易做到这一点：

import-module facebook $FB_DefaultExtendedPermissions += "friends_birthday" New-FBConnection Get-FBFriend -Fields name,birthday | 选择姓名，生日

我应该将“friends_birthday”添加到默认权限列表中......

# iframe - 在 Web 上显示 JR 报告

> ID：15235350
> 
> 赞同：0
> 
> 时间：2013-03-05T22:26:17.027
> 
> 标签：iframe, dojo, jasper-reports, jasperserver

我需要在我的 webApp 中显示 jasperreport，我正在使用 rest api 将报告结果（v2_rest）作为 HTML 获取。我可以通过 IFRAME 执行此操作，只需将 iframe src 指向其余 URL。

我想找到一个没有 iframe 的解决方案。我试图将报告结果作为 dojo GET 查询：

```
dojo.xhrGet({
url: ...reportURL...,
handleAs:"text",
load: function(data) {},
error: function(error,params) {}
}); 
```

将其保存到 javascript 变量并用作`<div>`innerHTML。但我总是收到 RequestError: Unable to load ...reportURL... status: 0 作为 GET 响应（正在调用错误函数）。URL 是正确的，因为它同样适用于 iframe。

我还尝试使用与 dojo ContentPane href 相同的 URL。但我得到的结果与 GET 查询相同。

有人可以帮我弄这个吗？也许我需要使用其他解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T15:03:38.373

有一些库可以以编程方式获取报告。你可以使用它们。他们将报告作为文件获取，然后您可以将它们作为文本打开并阅读。那么你可以在任何你想要的地方追加

如果你使用dotnet你可以使用[DotNetJasper](http://freeze.ro/node/7)（这个网站现在有一个sql异常，但我在这里找到了解决方案）
对于java [here an example](http://java.dzone.com/articles/java-reporting-part-2)
for php [using Jasper reports in a PHP website](https://stackoverflow.com/questions/4304023/using-jasper-reports-in-a-php-website)

那我知道的太多了：）

# java - 无法更新单元格（服务器错误）

> ID：15235352
> 
> 赞同：0
> 
> 时间：2013-03-05T22:26:33.423
> 
> 标签：java, javascript, jquery, servlets

我正在使用 Servlet 使用 mysql 数据库数据填充 jsp 页表，并使用 jquery 数据表插件使表可编辑。

但是，表格编辑不起作用，每次我编辑字段并按“Enter”时都会收到错误“无法更新单元格（服务器错误）”。我的 doPost 方法是否还在运行？

这是我的 jquery 脚本：

```
<script type="text/javascript">  
        $(document).ready(function(){
        oTable = $("table#datatables").dataTable({
                "sPaginationType":"full_numbers",
                "aaSorting":[[2, "desc"]],
                "bJQueryUI":true,
                "sDom": '<"top"i><"title">lt<"bottom"pf>'               
                }).makeEditable({
                "sUpdateURL": "/home",
                "aoColumns": [
                 null,  //medical record number
                 {},    //last name; default editing    
                 {},    //first name; default editing
                 {},    //middle name; default editing
                 {},    //date of birth; default editing
                 {      //gender, selection between M and F
                    indicator: 'Saving...',
                    tooltip: 'Click to select gender',
                    loadtext: 'loading...',
                    type: 'select',
                    onblur: 'submit',
                    data: "{'M':'M','F':'F'}"
                 }, 
                 null,  //admission date time
                 null,  //discharge date time
                 null,  //attending physician
                 {}     //room; default editing
                 ]
            });
        });
     </script> 
```

这是我家 Servlet 的 doPost 方法

```
protected void doPost(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
             int id = Integer.parseInt(request.getParameter("id"));
     int columnId = Integer.parseInt(request.getParameter("columnId")); 
     int columnPosition = Integer.parseInt(request.getParameter("columnPosition")); 
     int rowId = Integer.parseInt(request.getParameter("rowId")); 
     String value = request.getParameter("value"); 
     String columnName = request.getParameter("columnName");

     System.out.println(value);         
} 
```

我的 servlet 的 URL 映射是“/home”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T07:13:40.057

> 我的 doPost 方法是否还在运行？

我不确定默认情况下 dataTable 是否发出 POST 请求。可能您需要添加一个方法类型 POST。像`"sServerMethod": "POST"`或`"bServerSide": true,`

参考： [http ://www.datatables.net/release-datatables/examples/server_side/post.html](http://www.datatables.net/release-datatables/examples/server_side/post.html)

[http://www.datatables.net/release-datatables/examples/data_sources/server_side.html](http://www.datatables.net/release-datatables/examples/data_sources/server_side.html)

> "sUpdateURL": "/home"

检查您是否已使用映射映射您的 servlet。

最简单的方法，我建议你`sys out`同时输入`doGet()`and `doPost()`。

现在有了像 Mozilla Firefox 这样的现代浏览器的日子，您可以使用 Firebug 等工具检查 Http 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-25T16:19:35.390

我也遇到过同样的问题。这通常意味着响应不会在 servlet 处结束。尝试只使用“家”。或者，如果您有虚拟名称（可能您正在使用过滤器来过滤所有 servlet，例如以“/scheduler/”开头），请尝试在“home”之前添加它。例如，它看起来像“/scheduler/home”。或者尝试使用提交按钮（action="/home"）创建表单并检查您的“/home”资源是否可访问。

# qt - 创建可以与串行端口通信的 Mac/Windows 应用程序

> ID：15235354
> 
> 赞同：4
> 
> 时间：2013-03-05T22:26:39.260
> 
> 标签：qt, serial-port, cross-platform, qt5

我正在寻找可以在 OSX 和 Windows 上运行的软件，它将命令发送到连接到串行端口的设备。

我的第一个虽然是使用 Adob​​e Air，但没有我可以使用的本机串行端口库，我必须用 serproxy 或类似的东西打包应用程序，然后设置起来会很复杂。

我遇到了一个叫做 Qt 的东西，它看起来像是一个合适的框架，但是，我需要学习一门新语言才能使用它。（这不一定是问题）。Qt 是我最好的选择吗？是否有任何框架具有内置的串行库，可以让我在 HTML/CSS JavaScript 中构建？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:33:23.493

[是的，Qt 是一个不错的选择，并且在http://qt-project.org/wiki/QtSerialPort](http://qt-project.org/wiki/QtSerialPort)上有一个用于与串行端口通信的 Qt5 库插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T02:12:14.983

Real Studio 有一个内置的[Serial](http://docs.realsoftware.com/index.php/Serial)类，可用于与串行和兼容的 USB 设备进行通信。Real Studio 当然可以创建 Windows 和 OS X 应用程序。

# php - JavaScript 获取 URL 中的 PHP 变量

> ID：15235358
> 
> 赞同：0
> 
> 时间：2013-03-05T22:26:52.123
> 
> 标签：php, javascript

你好吗？我需要一些关于 javascript 的帮助

我有这个 WHMCS 代码（[http://docs.whmcs.com/Data_Feeds）：{literal}{/literal](http://docs.whmcs.com/Data_Feeds) }

{literal} => 在 WHMCS Templetes 文件中运行 JavaScript {/literal} => 完成 JavaScript

我需要使用 URL 中的变量更改 value¤cy=1。

例如 index.php?currency=4 有这个代码：{literal}{/literal}

你能帮助我吗？

问候，亚历克斯 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:30:24.200

这样的事情应该这样做：

```
<?php
    $currency = 1;

    if (isset($_REQUEST['currency']) && is_numeric($_REQUEST['currency'])) {
        $currency = intval($_REQUEST['currency']);
    }
?>

<script language="javascript" src="feeds/productsinfo.php?pid=41&get=price&billingcycle=annually&currency=<?= $currency ?>"></script> 
```

# jquery - 这怎么能缩短？

> ID：15235365
> 
> 赞同：0
> 
> 时间：2013-03-05T22:27:44.590
> 
> 标签：jquery, function, mouseover, jquery-hover, mouseout

按 ID 有几个热点。ID 特定的热点在鼠标悬停时显示一个区域（#ID-ed textarea），然后在鼠标移出时隐藏文本区域（注意 CSS display:hidden 比 hide 快得多）。大约有 50 个。我已经详细地写了这个 - 也就是每个人的函数。

想学习一种更好、更明智、更高效、更短的方法来做到这一点。

```
 //// POP 1_1
$('#pop_01_01').hover(
    function() {
    $('#text_01_01.textarea').fadeIn('fast');          
    },
    function() {
    $('#text_01_01.textarea').css({'display':'none'});
    }
);
//// POP 02_01
$('#pop_02_01').hover(
    function() {
    $('#text_02_01.textarea').fadeIn('fast');          
    },
    function() {
    $('#text_02_01.textarea').css({'display':'none'});
    }
);
//// POP 02_01
$('#pop_02_02').hover(
    function() {
    $('#text_02_02.textarea').fadeIn('fast');          
    },
    function() {
    $('#text_02_02.textarea').css({'display':'none'});
    }
);
//// POP 02_03
$('#pop_02_03').hover(
    function() {
    $('#text_02_03.textarea').fadeIn('fast');          
    },
    function() {
    $('#text_02_03.textarea').css({'display':'none'});
    }
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:37:01.073

您可以执行以下操作：

1.  将具有此行为的所有对象组合到一个 jQuery 选择器中，以便它们都可以运行相同的代码。
2.  从选择器中删除，`textarea`因为 id 无论如何都是 unqiue，所以它不是必需的，没有它应该会更快。
3.  从悬停的对象的 id 中提取所需的 id 并获取结束字符，以便您可以使用它来创建所需的其他 id。
4.  使用`.hide()`而不是`.css({'display':'none'});`作为内置快捷方式。

结果代码：

```
$('#pop_01_01, #pop_02_01, #pop_02_02').hover(
    function() {$('#text_' + this.id.substr(-5)).fadeIn('fast');},
    function() {$('#text_' + this.id.substr(-5)).hide();}
); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:43:44.887

If you want to do it the jquery way, consider that:

```
$.fn.makeHover = function() {
    this.each(function() {
        var $el = $(this),
            $textarea = $el.find('textarea');

        $el.hover(
            function() {
                $textarea.fadeIn('fast');
            },
            function() {
                $textarea.hide();
            }
        );
    });
};

$('#pop_01_01, #pop_02_01, #pop_02_02, #pop_02_03').makeHover(); 
```

By the way, I'm also caching `$el` and `$textarea` to avoid going through the DOM all the time (for performance improvement).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:45:33.770

The best way to do this is to reference your items by class instead of id, and store the relevant part (01_01, 01_02, etc) in a data-id attribute instead of in the id.

```
HTML -
<div class="pop" data-id="_01_01"></div>
<div class="pop" data-id="_02_01"></div>
<div class="pop" data-id="_02_02"></div>

<textarea data-id="_01_01"></textarea>
<textarea data-id="_02_01"></textarea>
<textarea data-id="_02_02"></textarea>

//// All pops
$('.pop').hover(
    function(e) {
      var dataid = $(e.target).attr("data-id");
      $('textarea[data-id="'+dataid+'"]').fadeIn('fast');
    },
    function(e) {
      var dataid = $(e.target).attr("data-id");
      $('textarea[data-id="'+dataid+'"]').hide();
    }
); 
```

Something like that should be able to nicely apply to all your elements, doesn't use a bunch of ugly unnecessary ids, and keeps your data clean and separate from your names.

Fiddle here - [http://jsfiddle.net/fGLnB/](http://jsfiddle.net/fGLnB/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:30:50.620

使用这样的功能：

```
function makehover(myid)
{
  $('#pop'+myid).hover(
      function() {
      $('#text'+myid+'.textarea').fadeIn('fast');          
      },
      function() {
      $('#text'+myid+'.textarea').css({'display':'none'});
      }
  ); 
```

然后打电话

```
 makehover('_01_01');
 makehover('_02_01');
 makehover('_02_02'); 
```

或通过 jQuery 调用

```
 $.each(['_01_01','_02_01','_02_02'],function (a,b) { makehover(b); }); 
```

或通过（1.6+ javascript）调用

```
 ['_01_01','_02_01','_02_02'].map(function (a) { makehover(a); return a; }); 
```

等等

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T22:35:37.360

您可以执行以下操作：

```
var hotspots = ['01_01','02_01','02_02'];   
hotspots.forEach(function(i) {
    $('#pop_' + i).hover(
        function() {
        $('#text_' + i + '.textarea').fadeIn('fast');          
        },
        function() {
        $('#text_' + i + '.textarea').css({'display':'none'});
        }
    );
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T22:30:42.120

```
$('#pop_01_01, #pop_02_01, #pop_02_02').hover(
    function(){
        id = $(this).attr('id');
        $('#text'+id.substring(3,id.length)).fadeIn('fast');          
    },
    function(){
        id = $(this).attr('id');
        $('#text'+id.substring(3,id.length)).css({'display':'none'});
    }
); 
```

我省略了“.textarea”类，因为 ID 应该是唯一的，所以没有理由另外使用类

# c# - 涉及同名列的问题

> ID：15235372
> 
> 赞同：0
> 
> 时间：2013-03-05T22:28:20.487
> 
> 标签：c#, .net, sql, sql-server, database

我正在尝试在 C# 中创建一个涉及两个单独表的视图，其中一个字段在两个表中具有相同的名称。无法更改列名，也不能仅为视图创建新的列名。这是因为不能以任何方式修改数据。我收到以下错误：

> 每个视图或函数中的列名必须是唯一的。
> 视图或函数“Testing”中的列名“Child_ID”被指定了多次。

在线搜索显示这是因为所有列都必须是唯一的。但是，当我尝试在每个违规列之前添加相应的表名时，仍然返回错误。有没有办法解决这个问题？我根本无法更改列名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:32:19.747

为什么不使用列[别名](http://msdn.microsoft.com/en-us/library/ms179300%28v=sql.105%29.aspx)？

```
SELECT T1.Child_ID AS T1ChildID, T2.Child_ID AS T2ChildID,... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:33:01.747

好吧，如果`Child_ID`两个表中的值相同（我假设这是来自连接），那么您只需将其中一个排除在外。两者都返回有什么意义？

如果`Child_ID`有*不同的*值，那么首先我质疑它们是否应该被称为相同的东西，但假设有这个原因，请使用别名。

```
SELECT 
  Child_ID_FromTable1 = Table1.Child_ID, 
  Child_ID_FromTable2 = Table2.Child_ID
... 
```

您的查询构建器需要识别多个表具有相同列名的情况，并且：

1.  以某种预先确定的方式自动分配别名（如上所示，这并不难）；
2.  强制用户为一列或两列选择别名；或者，
3.  强制用户选择一个或另一个从输出列表中删除。

# python - Python Robotparser 超时等效项

> ID：15235374
> 
> 赞同：3
> 
> 时间：2013-03-05T22:28:31.540
> 
> 标签：python, python-3.x, robots.txt

Python 3.3.0 中有没有办法设置 robotparser.read() 函数的超时？（如urllib.request中的urlopen）

60 秒的默认超时时间有点过激。

（我正在自学 Python。）

[Python 3.3.0 - 机器人解析器](http://docs.python.org/3.3/library/urllib.robotparser.html?highlight=robotparser#urllib.robotparser.RobotFileParser.read)

[Python 3.3.0 - urllib.request](http://docs.python.org/3.0/library/urllib.request.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T22:34:25.923

不，您必须使用 设置全局默认超时[`socket.setdefaulttimeout()`](http://docs.python.org/3/library/socket.html#socket.setdefaulttimeout)，或者将类子`RobotFileParser`类化以添加自定义超时：

```
from urllib.robotparser import RobotFileParser
import urllib.request

class TimoutRobotFileParser(RobotFileParser):
    def __init__(self, url='', timeout=60):
        super().__init__(url)
        self.timeout = timeout

    def read(self):
        """Reads the robots.txt URL and feeds it to the parser."""
        try:
            f = urllib.request.urlopen(self.url, timeout=self.timeout)
        except urllib.error.HTTPError as err:
            if err.code in (401, 403):
                self.disallow_all = True
            elif err.code >= 400:
                self.allow_all = True
        else:
            raw = f.read()
            self.parse(raw.decode("utf-8").splitlines()) 
```

# java - 在 SQLite 数据库上使用 Java 的 JDBC PreparedStatement 查询 NOT NULL

> ID：15235376
> 
> 赞同：1
> 
> 时间：2013-03-05T22:28:33.603
> 
> 标签：java, sqlite, jdbc, null, prepared-statement

我是 Java 中 PreparedStatement 的新手，我似乎无法找到解决问题的最佳解决方案。我想查询表中为 NULL 或 NOT NULL 的记录。

在阅读[PreparedStatement (Java Platform SE 6)](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)时，我意识到我需要使用[setNull](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setNull%28int,%20int%29)方法，但是我没有看到设置 NOT NULL 的方法？

例如：

```
SELECT * FROM table WHERE column IS NULL 
```

我假设我会做的是：

```
public void query(boolean getNull) {
    String querySql = "SELECT * FROM table WHERE column IS ?";
    sqlStatement = connection.prepareStatement(querySql);
    if(getNull)
        sqlStatement.setNull(1, Types.VARCHAR);
    else
        ???;
} 
```

但是我将如何做 else 语句？没有 setNotNull 方法。我想我可以这样做：

```
public void query(boolean getNull) {
    String querySql = "SELECT * FROM table WHERE column IS ? NULL";
    sqlStatement = connection.prepareStatement(querySql);
    sqlStatement.setString(1, (getNull ? "" : "NOT"));
} 
```

但这似乎很“骇人听闻”。有没有更好的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:59:01.387

? 用于传递参数，而不是构建 SQL。（[部分取自这里](https://stackoverflow.com/questions/12246359/sql-prepared-statement-not-taking-on-both-sides-of-where-clause)）

我建议您仅将参数用于值，而不是字段或`[IS] NULL`（任何类似的东西）。

只需连接字符串。如果您有多个参数，则应查看[`StringBuilder`](http://docs.oracle.com/javase/7/docs/api/java/lang/StringBuilder.html "字符串生成器").

```
public void query(boolean getNull) {
    String querySql = "SELECT * FROM table WHERE column IS ";
    if(getNull) {
        querySql += "NULL";
    } else {
        querySql += "NOT NULL";
    }      
    sqlStatement = connection.prepareStatement(querySql);
} 
```

也可以使用一种可能的方法[`String.format(...)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#format%28java.lang.String,%20java.lang.Object...%29 "Javadoc 字符串")，例如：

```
public void query(boolean getNull) {
    String querySql = String.format("SELECT * FROM table WHERE column IS %s NULL", (getNull ? "" : "NOT")); 
    sqlStatement = connection.prepareStatement(querySql);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:38:24.117

一种方法是查看查询返回的结果集：

```
"SELECT * FROM table WHERE column IS ?" 
```

使用 PreparedStatement 将值设置为 NULL，然后执行查询。您可以使用`resultset.next()`来测试您要查找的内容。

# ios - 如何让 CGContextClip 包含边框像素？

> ID：15235384
> 
> 赞同：1
> 
> 时间：2013-03-05T22:29:17.643
> 
> 标签：ios, core-graphics, clipping

我正在使用 CGMutablePathRef 创建任意多边形，因此我可以使用 CGContextClip 在我的上下文中剪辑进一步的绘图。

这具有不包含路径的“边界”像素的非常烦人和不受欢迎的行为。因此，例如，在我的代码片段中，我将一个矩形剪成两半，然后为每一半着色 - 生成的图像留下一条细线，其中路径的边界没有着色：

![在此处输入图像描述](../Images/8f9eb219be41055922d5d342d437df70.png)

```
 - (void)drawRect:(CGRect)rect
{
    CGContextRef ctxt = UIGraphicsGetCurrentContext();
    CGContextSetFillColorWithColor(ctxt, [UIColor whiteColor].CGColor);
    CGContextFillRect(ctxt, rect);
    CGContextSaveGState(ctxt);

    //Create a path to clip a triangle:
    CGMutablePathRef path = CGPathCreateMutable();
    CGPathMoveToPoint(path, NULL, 0, 0);
    CGPathAddLineToPoint(path, NULL, rect.size.width, 0);
    CGPathAddLineToPoint(path, NULL, 0, rect.size.height);
    CGContextAddPath(ctxt, path);
    CGContextClip(ctxt);

    //Fill the triangle with dark gray:
    CGContextSetFillColorWithColor(ctxt, [UIColor darkGrayColor].CGColor);
    CGContextFillRect(ctxt, rect);
    CGPathRelease(path);

    CGContextRestoreGState(ctxt);

    //Create a path to clip a triangle:
    path = CGPathCreateMutable();
    CGPathMoveToPoint(path, NULL, 0, rect.size.height);
    CGPathAddLineToPoint(path, NULL, rect.size.width, 0);
    CGPathAddLineToPoint(path, NULL, rect.size.width, rect.size.height);
    CGContextAddPath(ctxt, path);
    CGContextClip(ctxt);

    //Fill the triangle with dark Gray:
    CGContextSetFillColorWithColor(ctxt, [UIColor darkGrayColor].CGColor);
    CGContextFillRect(ctxt, rect);
    CGPathRelease(path);

} 
```

**如何以包含“边框”像素的方式剪辑上下文？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:47:01.403

原因可能是因为 Quartz 中的坐标对应于像素之间的“空间”，而不是像素本身。如果你画一条从 (0, 100) 到 (100, 100) 的线，笔画宽度为 1，你会看到它用你选择的颜色的 50% 填充了 Y 偏移 99 和 Y 偏移 100 处的像素，使用其抗锯齿算法。另一方面，如果您从 (0, 100.5) 到 (100, 100.5) 绘制一条线，则只会填充 Y 偏移 100 处的像素，它们将完全填充您选择的颜色。

编辑：要更详细地了解这个特定的接缝，问题是如何完成抗锯齿。LCD 显示器上的抗锯齿通常利用子像素渲染，其中一个像素可以水平分解为三个相邻的子像素，即红色、绿色和蓝色分量。如果部分覆盖的像素位于填充区域的右侧，则可能会优先考虑其红色分量，因为它在物理上更靠近该区域，对于填充区域左侧的绿色分量也是如此。两个多边形都部分覆盖了相同的像素，但他们正在决定如何独立填充它们，因此不能保证生成的颜色将精确地加起来为两个多边形颜色的加权平均值。

# c# - 为什么请求标头上的 ContentType 属性为空？

> ID：15235390
> 
> 赞同：2
> 
> 时间：2013-03-05T22:29:31.487
> 
> 标签：c#, http-headers, asp.net-web-api, httprequest

我正在使用 Fiddler 编写对我的 Web API 服务的调用。呼叫正在通过，我正在控制器中对其进行调试。然而，`Request.Content.Headers.ContentType`是`null`. 但是，当我检查对象时，我可以看到`Content-Type: application/xml;`如下所示：

```
?Request.Content.Headers
{Content-Length: 40039
Content-Type: application/xml;
}
    base {System.Net.Http.Headers.HttpHeaders}: {Content-Length: 40039
Content-Type: application/xml;
}
    Allow: {}
    ContentDisposition: null
    ContentEncoding: {}
    ContentLanguage: {}
    ContentLength: 40039
    ContentLocation: null
    ContentMD5: null
    ContentRange: null
    ContentType: null
    Expires: null
    LastModified: null 
```

我需要做什么才能检查该`ContentType`值并填充它？

**编辑：**这是我的 Post 方法的方法签名：

```
public HttpResponseMessage Post(MyMethodDTO message) 
```

`MyMethodDTO`只是一个简单的 DTO 类，其中的 getter/setter 都是*字符串*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:59:43.227

内容类型中的尾随分号无效。尝试发送：

```
Content-Type: application/xml 
```

反而。

HTTP 规范将媒体类型定义为：

```
media-type     = type "/" subtype *( ";" parameter ) 
```

所以在媒体类型参数之前应该只有一个分号

# batch-file - 遇到错误时停止执行批处理脚本

> ID：15235399
> 
> 赞同：6
> 
> 时间：2013-03-05T22:30:12.417
> 
> 标签：batch-file, batch-processing, dos

所以我正在使用相同的批处理脚本构建多个客户端。如果在构建一个错误时，该过程会停止并继续下一个。因为屏幕上有很多输出，而且我正在做其他事情，所以大多数时候我都错过了构建错误。

如果出现错误，是否有办法停止执行以下任务，并显示弹出消息以引起我的注意？或者至少停止执行，这样当我回到命令窗口时，我可以看到出现故障？

```
@echo off

if "%1"=="?" GOTO HELP

if NOT "%1"=="" set rev=%1
if NOT "%2"=="" set version=%2

@echo on
rem build one 
call perl buildClient.pl -brandName="myBrand" -group="group1" 

rem build two 
call perl buildClient.pl -brandName="myBrand" -group="group2" 

rem build three
call perl buildClient.pl -brandName="myBrand" -group="group3" 

rem build four 
call perl buildClient.pl -brandName="myBrand" -group="group4" 

    @echo off

    goto EXIT

    :HELP
    cls
    echo.
    echo.
    echo usage: buildbrand.bat [revision] [version] [group]
    echo.
    echo        ?           = this help screen
    echo.
    echo        revision    = build version
    echo                      Example: 5.2.31
    echo        group       = group of phones or phone name
    echo                      Example: SonyEricsson\K750
    echo.
    :EXIT
    set version=
    set rev=
    set brandName=
    PAUSE 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-04T12:46:25.597

“检查 if 语句中的错误级别，然后退出 /b（仅退出批处理文件，而不是整个 cmd.exe 进程）以获取 1 或更大的值。”

```
if %errorlevel% neq 0 exit /b %errorlevel% 
```

查看此处了解详细信息：[如何使批处理文件在遇到错误时终止？](https://stackoverflow.com/questions/734598/how-do-i-make-a-batch-file-terminate-upon-encountering-an-error)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-20T09:08:59.850

如果出错则停止执行的正确语法是：

> 如果 ERRORLEVEL 1 退出

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-03-06T11:06:29.633

只是一个提示尝试使用

```
if %ERRORLEVEL% NOT 1 
exit 0 
```

在你的代码中。这应该退出错误。

# java - Java URL 参数用空格替换 %20

> ID：15235400
> 
> 赞同：15
> 
> 时间：2013-03-05T22:30:12.600
> 
> 标签：java, url-encoding

在我的网页中，当提交表单并在文本字段中输入空格时，它在后端 java 代码中被读取为 %20 而不是空格。我可以在后端将 %20 替换回“”，但我认为这不是正确的方法，它可能发生在应用程序的任何地方。

提交表单时有没有更好的方法在前端处理它？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-03-05T22:39:00.970

这没什么不好。这是在 URL 中转义字符的方式。你应该使用[`URLDecoder`](http://docs.oracle.com/javase/6/docs/api/java/net/URLDecoder.html#decode%28java.lang.String,%20java.lang.String%29)，这是特别合适的，因为尽管它的名字，它确实`application/x-www-form-urlencoded`解码：

```
String decoded = URLDecoder.decode(queryString, "UTF-8"); 
```

然后，您将能够构建一个键/值对映射，解析 URL 的查询部分，在 上拆分`&`，并使用`=`将键与值分开（也可能是`null`）。

但是请注意，如果 URL 作为`URI`对象传递，它有一个 nice[`getQuery()`](http://docs.oracle.com/javase/6/docs/api/java/net/URI.html#getQuery%28%29)已经返回未转义的文本。

如果您使用 servlet API，则不必转义任何内容，因为有很好的方法，例如[`getParameterMap()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getParameterMap%28%29).

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-05T22:35:13.380

您可以通过[URLDecoder](http://docs.oracle.com/javase/7/docs/api/java/net/URLDecoder.html)传递它，这样您不仅可以对 %20 的问题进行排序，还可以对其他 URLEncoded 值进行排序[http://docs.oracle.com/javase/7/docs/api/java/net/URLDecoder.html](http://docs.oracle.com/javase/7/docs/api/java/net/URLDecoder.html)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-11-14T17:50:35.597

```
 try {
         String result = URLDecoder.decode(urlString, "UTF-8");
     } catch (UnsupportedEncodingException e) {
         // TODO Auto-generated catch block
         e.printStackTrace();
     } 
```

# uidatepicker - 在后台线程中分配 UIDatePicker？

> ID：15235401
> 
> 赞同：1
> 
> 时间：2013-03-05T22:30:16.377
> 
> 标签：uidatepicker

我试图在一个单独的线程中分配一个 UIDatePicker（iPhone 4 的性能提升），并且由于某种原因，以下代码绘制了一个黑框（日期选择器应该去的地方），大约 20-30 秒后显示日期选择器。

```
@property (nonatomic, strong) dispatch_queue_t backgroundQueue;

    dispatch_async(self.backgroundQueue, ^{
        self.datePicker = [[UIDatePicker alloc] initWithFrame:CGRectMake(0, 0, self.deviceRect.size.width, self.datePicker.frame.size.height)];
        [self.datePicker addTarget:self action:@selector(didSelectDate:) forControlEvents:UIControlEventValueChanged];

        dispatch_async(dispatch_get_main_queue(), ^{
            [self.view addSubview:self.datePicker];
    });

}); 
```

我知道线程代码有效，因为我添加了一个冗长的过程并在完成时添加了一个 UIView 并且一切都按预期显示。我想这样做的原因是因为在 iPhone 4 上，UIDatePicker 在第一次显示时会滞后。您可以通过转到 Apple 日历应用程序并添加日期来看到这一点，在显示 UIDatePicker 之前存在明显的延迟。

# jquery - 带有内容框的双垂直选项卡

> ID：15235404
> 
> 赞同：1
> 
> 时间：2013-03-05T22:30:23.943
> 
> 标签：jquery, html, css

我如何制作这个垂直选项卡，当我单击一个按钮（选项卡）打开另一行选项卡然后才打开内容框？这几乎是[http://jsfiddle.net/2jryD](http://jsfiddle.net/2jryD)的结果，我找不到 1.4.2.min.js 库来链接它。我认为我应该在 html 和 js 中做一些更改，但我不知道是什么....你能帮帮我吗？

JS + 库

```
$(document).ready(function(){
        $("#textExample").verticaltabs({speed: 500,slideShow: false,activeIndex: 2});
        $("#imageExample").verticaltabs({speed: 1000,slideShow: true,slideShowSpeed: 3000,activeIndex: 0,playPausePos: "topRight"});
    }); 
```

html

```
<div class="verticalslider" id="textExample">
        <ul class="verticalslider_tabs">
            <li><a href="#">Lorem Ipsum</a></li>
            <li><a href="#">Praesent Pulvinar</a></li>
            <li><a href="#">Nunc Adipiscing</a></li>
            <li><a href="#">Praesent Dapibus</a></li>                        
        </ul>
        <ul class="verticalslider_contents">
         <li>
            <h2>Praesent Pulvinar</h2>
            <p>Praesent pulvinar, lorem nec ullamcorper semper, ipsum erat vestibulum lacus, in sodales lorem mi in leo. Vestibulum et rhoncus tellus. Curabitur mauris enim, vehicula sit amet euismod a, eleifend at dui. Vivamus sollicitudin, nunc pharetra porttitor lobortis, felis odio hendrerit mi, id ultricies urna enim quis lectus. Suspendisse convallis ipsum egestas velit fermentum ac volutpat dui dictum. </p></li>

        </ul>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T22:02:16.820

[这个例子很好](http://css-tricks.com/organic-tabs/)，只是改变css

```
.mydivContent {
    clear: none;
    margin: 0 0 0 124px;
    padding: 0;
    position: relative;
}

#tab .nav {
    clear: left;
    margin: 0 0 10px;
    overflow: hidden;
    position: absolute;
} 
```

[我让例子](http://jsbin.com/izovak/2/edit)

# java - 使用 selenium webdriver 运行测试

> ID：15235406
> 
> 赞同：0
> 
> 时间：2013-03-05T22:30:28.047
> 
> 标签：java, selenium-webdriver

我是 selenium web 驱动程序的新手。我有一个用 java 编写的测试，将使用 Selenium web 驱动程序进行测试。我将测试类作为 java 应用程序运行。我编写了以下代码片段来获取 ChromeDriver 的实例。我收到以下代码片段的以下消息。

```
 @Override
    public WebDriver get() {
        log.info("Creating Chrome driver");
        try {
            return new ChromeDriver(buildCapabilities());
        } catch (IOException e) {
            throw new ExceptionInInitializerError(e);
        }
    } 
```

还设置了 ChromeDriver 的路径

> 私有静态最终字符串 CHROME_DRIVER = "chromedriver.exe"; URL chromeDriverUrl = getClass().getResource("/" + CHROME_DRIVER); 字符串 pathToChromeDriver = chromeDriverUrl.getPath(); System.setProperty("webdriver.chrome.driver", pathToChromeDriver);

图片： ![在此处输入图像描述](../Images/528e43789a1969d405a52a9437e2ebfc.png)

不明白为什么在 return new ChromeDriver(buildCapabilities()) 代码行上显示以下消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:46:40.793

要使用 chrome 驱动程序，您需要从[这里下载 chrome 驱动程序](https://code.google.com/p/chromedriver/downloads/list)

然后使用 chrome 驱动程序

```
System.setProperty("webdriver.chrome.driver", "C:/Users/Hussain/Desktop/selenium-2.30.0/chromedriver.exe");
        WebDriver driver = new ChromeDriver(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:37:56.510

好吧，对于初学者来说，ChromeDriver（和 FireFox 驱动程序）都是 RemoteWebDriver，而不是 WebDriver。这些类型不兼容。至于为什么你得到一个 Firefox 驱动程序而不是 chrome 驱动程序，我猜你的 buildCapabilities() 函数或你的远程网格正在返回一个 Firefox 驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T05:16:33.727

很简单的改变。将我的项目重新导入 IntelliJ 环境可以解决问题。 ![在 Intellij 中重新导入符号](../Images/265929355bb077647aa96bc78d84cb3d.png)

# javascript - Dojo 小部件 - BuildRendering 和 PostCreate 之间的静默失败

> ID：15235418
> 
> 赞同：0
> 
> 时间：2013-03-05T22:31:08.613
> 
> 标签：javascript, internet-explorer, recursion, dojo, widget

我正在尝试为我的 web 应用程序中的地图开发一个目录样式小部件。这些小部件在 Chrome 和 FireFox 中运行良好，但在 Internet Explorer 8 中却无声无息地失败了（我在开发这个应用程序时已经读过很多次了！）

我正在使用 dojo 框架，我发现它在小部件生命周期的 BuildRendering 和 PostCreate 方法之间失败了。小部件是使用图形结构创建的，因此它是递归的。有谁知道在小部件生命周期的这两种方法之间会导致失败的原因是什么？

我在某些地方读到该模板可能有问题，所以我将它包含在我的 Node 代码之后。

这是小部件的简化版本，因此您可以了解正在发生的事情：

```
define(['dojo/_base/declare', "dijit/_WidgetBase", "dijit/_TemplatedMixin", 
        "dijit/_WidgetsInTemplateMixin", "dojo/text!./templates/_Node.html"], 

function (declare, _WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin, template) {

    var _Node = declare ([_WidgetBase, _TemplatedMixin, _WidgetsInTemplateMixin], { 

        templateString : template,
        _childNodes : [],

        constructor : function (params, srcNodeRef) {
            lang.mixin(this, params);   
            this.inherited(arguments);
        },

        buildRendering: function (){
            this.inherited(arguments);
            // Execution leaves this function but never launches postCreate()
            // buildRendering is not actually there in my code, I just have it here for 
            // debugging this particular problem.
        },

        postCreate : function () { 
            // Execution never reaches this point in IE8 (probably 7 and 9 as well)
            var newParams = {
                "Para1": "Value1",
                "Para2": "Value2"
            }
            var newNode = new Node(newParams, this.containerNode);
            this._childNodes.push(newNode);
        }
    });

    return _Node;

}); 
```

这是它使用的模板：

```
<div>
    <div data-dojo-attach-point="rowNode" data-dojo-attach-event="onclick:_onClick">
        <span data-dojo-attach-point="contentNode">
            <span data-dojo-attach-point="checkContainerNode"></span>
            <img src="${_blankGif}" alt="" data-dojo-attach-point="iconNode">
            <span data-dojo-attach-point="labelNode"></span>
        </span>
    </div>
    <div data-dojo-attach-point="containerNode" style="display: none;"></div>
</div> 
```

所以我的节点遵循这种结构，但就像我说的那样，在 Internet Explorer 中的 buildRendering 和 postCreate 之间默默地失败了。我已经在这上面花了很多时间。我希望有人可以在这里帮我一把。

请不要看太多语法，我复制了粘贴的部分代码，但为了清晰起见，我对其进行了大量修改。

谢谢，

吉尔曼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T00:39:54.027

您不必调用`this.inherited(arguments);`构造函数。Dojo 将自动链接构造函数。

[http://dojotoolkit.org/reference-guide/1.8/dojo/_base/declare.html#id8](http://dojotoolkit.org/reference-guide/1.8/dojo/_base/declare.html#id8)

您还需要添加`this.inherited(arguments);`到`postCreate`.

您的模板没有结束标记`<img>`。

# linux - 系统调用修改

> ID：15235423
> 
> 赞同：0
> 
> 时间：2013-03-05T22:31:25.103
> 
> 标签：linux, kernel, system-calls

我正在做两个系统调用（linux 3.2）。我创建了这两个系统调用，并编译了内核。这两个系统调用需要对文件进行写入和读取。我将修改两个系统调用，read 和 write 来读取这个文件。所以这个文件需要被这四个系统调用（读、写和我的两个系统调用）访问。我的问题是，我可以在哪里以及如何创建此文件以及如何访问和修改它。我将只将此文件用于这些系统调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T11:13:06.257

这实际上是一个非常好的教育问题 - 这里突出显示的答案显示了在哪里/为什么这是一件非常困难和危险的事情。但是，如果您有一个用户空间守护进程等待事件/信号/IO 以指示*它*应该为内核执行读/写，那么“解决方案”很容易。这可以像 /proc 条目一样简单，其中包含用户空间进程读取/轮询/选择的计数/信号量。

解决这个问题是了解任何/许多解决方案中的权衡的好习惯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T11:33:55.880

在 Linux 内核中读取或写入文件被认为是“坏的”。

添加一个在列表中添加/删除名称的系统调用（不一定是 Linux 内核列表，但这也不是一个可怕的想法 - 可能是一个数组等），然后使用用户模式程序将名称设置为文件中的列表。

接下来，我认为将读/写系统调用绑定到分区并不容易。可能更容易处理`open`？

# doctrine-orm - 教义查询，关联多对一

> ID：15235427
> 
> 赞同：1
> 
> 时间：2013-03-05T22:31:35.360
> 
> 标签：doctrine-orm, doctrine, dql

我有 2 个实体：

```
Class A {

    /**
     * @ORM\ManyToOne(...)
     */
    private $b;

    /**
     * @ORM\Column(name="date", type="date")
     */
    private $date;
}

Class B {

    /**
     * @ORM\OneToMany(...)
     */
    private $a;

} 
```

需要一个查询来获取所有实体“B”，即您的“A”具有以下所有日期“日期”到我设置为参数的日期。

现在有这些查询，但没有结果：

> “从实体中选择 b：B b INNER JOIN ba a WHERE a.date > :date”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:37:10.163

您可以执行以下操作：

```
public function myfunction($date){
    $dql = "SELECT b FROM Entity:B as b WHERE b.a IN (".
               "SELECT a.id FROM Entity:A as a WHERE a.date > :date".
           ")";
    $query = $this->getEntityManager()
        ->createQuery($dql)
        ->setParameter('date', $date)
    ;

    return $query->getResult();
} 
```

我在我的一些具有相似结构的实体上进行了测试并且它有效

# php - MYSQL 和 PHP 需要在同一页面上的表中添加回显

> ID：15235428
> 
> 赞同：-1
> 
> 时间：2013-03-05T22:31:36.487
> 
> 标签：php

我需要将 php 页面上的回显添加到我在同一页面上创建的表中，以将其交叉插入到不同的 SQL DB

以下是我的代码

```
<?php
$con = mysql_connect("localhost","****","****");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("****", $con);

$result = mysql_query("SELECT * FROM members
WHERE member_msisdn='$slusername'");
echo "<table border='1'>
<tr>
<th>Membership</th>
<th>Number</th>
<th>Registration Date</th>
<th>End Date</th>
<th>Copy of ID</th>
</tr>";
while($row = mysql_fetch_array($result))
 {
echo "<td><center>" . $row['member_id'] . "</td>";   
echo "<td><font color=blue>" . $row['member_msisdn'] . "</td>";
echo "<td><center>" . $row['asdate'] . "</td>";
echo "<td><center>" . $row['aedate'] . "</td>";
echo "<td><center>" . $row['attid'] . "</td>";
echo "</tr>";
  }
echo "</table>";

mysql_close($con);
?></div>
        <div class="Notes"><strong><br>
          Emergency Contact Numbers:</strong><br>
          <?php
$con = mysql_connect("localhost","****","****");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("****", $con);

$result = mysql_query("SELECT * FROM members a INNER JOIN recipients b ON a.member_id =     
b.member_id WHERE member_msisdn=$slusername");
echo "<table border='1'>
<tr>
<th>Number</th>
<th>Name</th>
<th>Surname</th>
</tr>";
while($row = mysql_fetch_array($result))
 {
echo "<td><font color=blue>" . $row['recipient_msisdn'] . "</td>";
echo "<td>" . $row['recipient_name'] . "</td>";
echo "<td>" . $row['recipient_surname'] . "</td>";
echo "</tr>";
  }
echo "</table>";

mysql_close($con);
?>
        </div>
        <p>
          <label for="member_id"></label>
          <input type="text" name="member_id" id="member_id"> // here i need the    
member_id of members to be printed so i can have it entered into another table on same    
sql DB
        </p>
       <p><br>
        </p>
      </div></td> 
```

基本上在顶部我回显了 member_id 但我需要将它自己输入到表 member_id 中，然后通过放置在 SQL DB 上的操作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T09:35:23.967

好吧，你已经完成了 99% 的工作。这里有一些事情要做：

*   您正在分别打开和关闭数据库连接。我建议你一开始它们一起打开，最后一起关闭它们
*   因此，每种情况下数据库句柄的变量必须不同。我建议`$con1`and `$con2`，但这取决于你。
*   而不是`mysql_select_db`在每个查询之前，只需执行`mysql_query($sql, $con1)`（根据需要替换连接变量）。这使得哪个语句连接到哪个数据库更清楚。

从那里，很容易在最后编写一个额外的查询以再次从第一个数据库中读取，因此您可以将其放入一组`<input>`标记值中。

* * *

另外：如果您尝试将您的“业务逻辑”（它是如何工作的）与您的“视图”（它看起来像什么）分开，您的编码将变得更加容易。一个好的开始（对于您的代码的第一部分）可能如下所示：

```
<?php
// This is the "logic" section, so we indent carefully, and get our
// variables ready for the "view" to consume
$con1 = mysql_connect("localhost", "****", "****");
if (!$con1)
{
  die('Could not connect: ' . mysql_error());
}

// Don't be afraid to wrap lines like this - makes them more readable,
// and means less h-scrolling in your IDE
$result = mysql_query(
    "SELECT * FROM members WHERE member_msisdn='$slusername'",
    $con1
);
?>

<!-- This is our 'view' section, which we write in proper HTML, rather
than blobs of HTML trapped inside our echo statements -->
<table border='1'>
  <tr>
    <th>Membership</th>
    <th>Number</th>
    <th>Registration Date</th>
    <th>End Date</th>
    <th>Copy of ID</th>
  </tr>
  <!-- One useful convention is to use the colon form of loops for views
  - it is generally thought of as neater -->
  <?php while($row = mysql_fetch_array($result)): ?>
    <!-- You forgot to open (tr) -->
    <tr>
      <!-- Note! Always close tags you've opened -->
      <!-- (center) and (font) are deprecated anyway, use CSS instead -->
      <td><center>
        <?php echo $row['member_id'] ?>
      </center></td>
      <td><font color="blue">
        <?php echo $row['member_msisdn'] ?>
      </font></td>
      <td><center>
        <?php echo $row['asdate'] ?>
      </center></td>
      <td><center>
        <?php echo $row['aedate'] ?>
      </center></td>
      <td><center>
        <?php echo $row['attid'] ?>
      </center></td>
    </tr>
  <?php endwhile ?>
</table>

<!-- You can do connection closing and other cleanup here --> 
```

现在，我们在*真正的*HTML 中获得了语法着色的好处，而 PHP 只是为微小的单行语句打开的。干净多了！我也更好地缩进了它，这有助于揭示缺少的开始（tr）和缺少的结束（字体，中心）标签。请参阅我添加的注释的代码。

# asp.net-mvc-4 - 我必须使用 BreezeController 吗？

> ID：15235435
> 
> 赞同：2
> 
> 时间：2013-03-05T22:31:59.190
> 
> 标签：asp.net-mvc-4, asp.net-web-api, breeze

[待办事项列表示例](http://www.breezejs.com/samples/todo-require)使用 BreezeController 来提供 API 。`EFContextProvider`用于提供`Metadata`字符串和方法，如`SaveChanges()`.

问题：它直接与`DbContext`. 我仍然希望能够灵活地返回我自己的视图模型而不是那些域模型。

在常规`ApiController`中，我们可以轻松地返回我们自己的视图模型。但是，如果我转向常规`ApiController`，在调用 api 时，会`breeze`询问`Metadata`由提供的

```
[HttpGet]
public string Metadata() {
    return _contextProvider.Metadata();
} 
```

如果我们使用`BreezeController`.

所以，我的问题是，我们必须使用`BreezeController`吗？我们如何使用它返回自定义的视图模型？或者，如果我们使用常规`ApiController`来获得更大的灵活性，我们如何提供`Metadata`?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T18:10:15.580

“BreezeController”就是任何具有“BreezeController”属性的 API 控制器。

“BreezeController”只是一个 .NET 属性，它帮助 .NET WebApi 通过 OData“语法”提供对查询过滤和排序的支持，以及对实体图和类型标识的 json 序列化支持。类型标识很重要，因此微风可以跟踪其 entityManager 中的实体并合并查询结果并更新关系属性。

仅当您希望服务器提供有关查询可以返回的类型的元数据时，才需要“元数据”方法。也可以在“客户端”提供相同的元数据，这样您就不必实现此方法。微风示例 zip 中的 NoDb 示例包含一个示例。

返回域模型而不是视图模型并没有轻而易举的要求。要么工作。您只需为您使用的任何模型返回的类型提供元数据。如果您想根据一些任意客户端信息执行自定义服务器端逻辑，还请查看 EntityQuery 'withParameters' 方法。

# php - 在第一根针之后和之前将绳子分开。最佳版本

> ID：15235447
> 
> 赞同：0
> 
> 时间：2013-03-05T22:32:30.717
> 
> 标签：php, regex, string, split

我有字符串，字符串可能包含 0 个或多个冒号“：”

我需要拆分这个字符串并获得 2 个变量：

1) `$before`= 第一个冒号之前的字符串
2) `$after`= 第一个冒号之后的字符串

如果字符串不包含冒号， `$before`并且`$after`必须是空字符串

也就是说，从`aa:ss:dd:44`

`$before = aa`和`$after = ss:dd:44`

我有两个想法，如何做到这一点：

1)

```
 $str = "aa:ss:dd:44";

    $before = mb_strstr($str, ":", TRUE, "utf-8");

    $after = mb_substr( mb_strstr($str, ":", FALSE, "utf-8"), 1, mb_strlen($str, "utf-8") , "utf-8" ); 
```

2)

```
 $str = "aa:ss:dd:44";

    preg_match_all("#(^[^:]*):(.*)#u", $str, $matches);

    if (isset($matches[1][0])) {
        $before = $matches[1][0];
    }
    else {
        $before = "";
    }

    if (isset($matches[2][0])) {
        $after = $matches[2][0];
    }
    else {
        $after = "";
    } 
```

但我认为两者都不是最佳的东西，你有更好的主意吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:35:21.233

使用`explode`：

```
$result = explode(':', $string, 2);
if (count($result) == 1) {
    $before = $after = "";
}
else {
    $before = $result[0];
    $after = $result[1];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:37:45.900

这个单线应该工作。

```
list($before, $after) = array_pad(explode(':', $string, 2), 2, ''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:37:48.267

另一种选择是：

```
$before = $after = '';
$str = "aa:ss:dd:44";
$ar_fields = explode( ":", $str, 2 );
if ( count( $ar_fields ) > 1 ) {
    $before = $ar_fields[0];
    $after = $ar_fields[1];
} 
```

# facebook-graph-api - 是否仍然可以使用 Graph API 作为页面发布到粉丝页面？

> ID：15235450
> 
> 赞同：0
> 
> 时间：2013-03-05T22:32:36.780
> 
> 标签：facebook-graph-api, facebook-page

我有代码：

*   请求用户的 manage_pages 和 publish_actions 权限
*   获取用户的长期访问令牌。
*   获取 /me/accounts 以列出此用户是页面管理员的页面
*   获取页面的访问令牌，例如 ID PAGE_ID（我可以使用调试器验证它是否具有相关页面的配置文件 ID 和从不到期，以及 manage_pages 和 publish_actions 权限）
*   （几分钟后）尝试使用该访问令牌发布到 /PAGE_ID/feed

我收到“用户尚未授权应用程序执行此操作”。

对此的大多数讨论早于 offline_access 权限的退休。发布到用户的提要有效，但发布到页面提要却不行。我想知道我的代码是否不好，或者 Facebook 是否已经删除了使用 Graph API 以这种方式发布到粉丝页面（而不是用户）的能力。

有人成功地还在做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:29:10.510

不确定您使用的是哪种语言，尽管这无关紧要，只要您拉出页面令牌就可以了。

您可以通过进入资源管理器[https://developers.facebook.com/tools/explorer/](https://developers.facebook.com/tools/explorer/)和

*   获取页面令牌`/me/accounts`
*   设置`POST`并调用`/PAGE_ID/feed`字段`message`

如果您无法通过第二步，请尝试 `/me`使用页面令牌发出 GET 请求，您应该获取页面而不是用户。

# bash - 为什么这个带有 `while [expr]` 的 bash 脚本不会运行？

> ID：15235455
> 
> 赞同：3
> 
> 时间：2013-03-05T22:33:06.307
> 
> 标签：bash, fibonacci

当我尝试运行脚本时，出现“第 9 行：[2：找不到命令”错误。这是我的第一个 bash 脚本，所以我是一个完整的初学者。

```
#!/bin/bash

num1=0
num2=1

count=2

while [$count -le $1]
do
num3='expr $num1+$num2'
num1=$num2
num2=$num3
count='expr $count+1'

done

echo "Fib Num: $num3" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T22:34:59.903

`[`在和周围添加空格`]`。`[`是一个命令，所以它必须是一个单独的词。来自`man bash`：

```
test expr
[ expr ]
       Return a status of 0 or 1 depending on  the  evaluation  of  the
       conditional  expression expr.  Each operator and operand must be
       a separate argument.  Expressions are composed of the  primaries
       described  above  under  CONDITIONAL EXPRESSIONS. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T22:40:12.143

试试这个：

```
$ cat t.sh 
```

显示：

```
#!/bin/bash

num1=0
num2=1

count=2

while [ $count -le $1 ]; do
  num3=$(expr $num1 + $num2)
  num1=$num2
  num2=$num3
  let count++;
done

echo "Fib Num: $num3" 
```

结果：

```
$ bash t.sh 9
Fib Num: 34 
```

`[`and`]`需要空格，并且命令`expr`应该包含在`$(`and`)`中，而不是单引号。您可能打算使用反引号 (`)，但不要再使用反引号了。

由于您使用的是 bash，因此您也可以简化增加计数，如图所示。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T04:44:22.780

作为参考，这里有一些类似于“通常”的理想答案。

```
#!/usr/bin/env bash

# Bash/ksh93
# Theoretically also zsh/mksh, but both have bugs that break it.
function fib1 {
    # It is critical to validate user input if it will be used in an arithmetic
    # expression.
    [[ $1 == +([[:digit:]]) ]] || return 1

    # Demonstrates an accumulating version to print the intermediary results.
    typeset i=1 f=(0 1)
    while (( i < $1 )); do
        # Don't use expr(1) unless you're coding for Bourne.
        (( f[i] = f[i-1] + f[i++] ))
    done
    echo "${f[@]}"
}

fib1 "$1" 
```

`expr`令人困惑的是，除了损坏的语法之外，即使使用`/bin/bash`shebang ，您也使用了奇怪的东西。您应该阅读 bash 手册，而不是阅读对您提出的任何建议。

```
#!/bin/sh

# POSIX (posh/bash/zsh/all kshes)
# It's easier to write a let wrapper than re-type test expressions repeatedly.
# This emulates let precisely, but it's not important to understand everything
# going on here. Breaks in dash because of its lack of support for the
# otherwise ubiquitously supported comma operator, and busybox because of a bug in
# its environment assignments.
let() {
    IFS=, command eval test '$(($*))' -ne 0
}

fib2() {
    # Uglier validation for POSIX
    case $1 in
        *[^[:digit:]]*|'')
            return 1
    esac

    # Using globals for simplicity
    count=$1 n1=0 n2=1
    while let count-=1; do
        let n1=n2 n2=${n1}+n2
    done

    printf 'Fib Num: %d\n' "$n2"
}

fib2 "$1" 
```

我的算术斐波那契作为一种好奇心有点受欢迎。

```
# Bash/ksh93/zsh
# Could be more elegant but includes bug workarounds for ksh/zsh
 $ a=a[++n%20]=a[n]+a[n-1],a[0] a[n=2]=1; let a a=0; echo "${a[@]}"
0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584

# Less portable because of bugs. Works in Bash.
 $ a=('a[a[n]=a[n-1]+a[n-2],n++/20]' 2 0 1); echo "${a[@]:n=4,a}"
0 1 1 2 3 5 8 13 21 34 55 89 144 233 377 610 987 1597 2584 
```

# c++ - 将高级运算符添加到语法

> ID：15235458
> 
> 赞同：2
> 
> 时间：2013-03-05T22:33:15.147
> 
> 标签：c++, grammar, factorial

我正在使用 c++ 完成 Stroustrups 编程原理和实践。他在本书的前几章中使用了这种语法来构建计算器。练习之一是在计算器中添加一个阶乘运算符。他给了一个提示

> 首先修改语法以考虑更高级别的运算符

什么是高级运算符？（不幸的是他没有解释到书中的那一章，我不知道它是否在其他章节中解释过）

他要求修改的语法是这样的：

```
Expression:
    Term
    Expression "+" Term
    Expression "-" Term
Term:
    Primary
    Term "*" Primary
    Term "/" Primary
    Term "%" Primary
Primary:
    Number
    "(" Expression ")"
Number:
    floating-point-literal 
```

我已经为此苦苦挣扎了一整天，但我一无所获。会很高兴得到一些解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:40:43.057

更高级别的运算符是比其他运算符具有更高优先级的运算符。

这可以添加到您的语法中，就像乘法、除法和模数不同于加法和减法一样。

换句话说，您的解析器应该首先尝试解析阶乘语法，然后是乘法，然后是加法

# jquery - 使用 JSON 内容代理 HTTP POST

> ID：15235460
> 
> 赞同：1
> 
> 时间：2013-03-05T22:33:19.663
> 
> 标签：jquery, asp.net-mvc, json, proxy, cors

我们遇到了一些 CORS 问题，我正在尝试使用服务器代理来解决它，因为这似乎是处理它的最可靠方法。但是我遇到了 POST 请求的主要问题。

代理的一般结构是： `JQuery-based client -> WebServer HttpHandler Proxy -> WebAPI Service`

客户端使用 JSON 有效负载并期望它们作为回报。

示例客户端：

```
ourcompany.datasource.postData({
    data: ko.toJSON(requestObject),
    success: function (response, status) { ourcompany.messenger.success('Thanks for the data!');},
    error: function () { ourcompany.messenger.fail('Oh no!'); }
} 
```

我们也使用 amplify.js，它只是在 jquery 底层对象周围添加了一些包装器。为了完整起见，这里是请求的定义，其余的 jquery.ajax 参数位于：

```
amplify.request.define('postData', 'ajax', {
    url: buildProxyUrl(outCompany.urls.svcData),
    type: 'POST',
    dataType: 'json',
    contentType: 'application/json; charset=utf-8',
    beforeSend: addCustomHeaders,
    decoder: wrapperDecoder
}); 
```

示例 webapi：

```
[HttpPost]
public HttpResponseMessage PostData(PostDataRequest request)
{
      HttpResponseMessage response = null;
      var response = BusinessLayer.DoSomeStuff(request);
      return response;
} 
```

这一切在非代理情况下都可以正常工作。如您所见，我们通过在 WebAPI 端反序列化一些 JSON 来创建一个复杂的 .NET 对象。

代理把这一切都搞砸了。本质上，我无法弄清楚如何在第二个请求中发送原始请求的 JSON 内容，而不会被传输弄乱。当前代码如下所示：

```
private void MakeHttpPostRequest(HttpContext context)
{
    var url = context.Request["url"];
    var req = WebRequest.Create(url);
    req.Method = "POST";
    req.Headers["x-customheader"] = context.Request.Headers["x-customheader"];

    var reqStream = req.GetRequestStream();
    context.Request.InputStream.Position = 0;
    context.Request.InputStream.CopyTo(reqStream);
    reqStream.Close();
    context.Request.InputStream.Close();

    using (var stream = req.GetResponse().GetResponseStream())
    {
        using (var reader = new StreamReader(stream))
        {
            var content = reader.ReadToEnd();
            context.Response.ContentType = "application/json";
            context.Response.Write(content);
        }
    }
} 
```

我尝试了其他几种提取内容并推送到传出请求的方法，但似乎没有任何效果。在最好的情况下，WebAPI 方法被调用，请求对象的值为空。我现在不知道该去哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:41:39.920

您忘记在代理中设置请求 Content-Type 标头。您还忘记正确处理所有 IDisposable 资源：

```
private void MakeHttpPostRequest(HttpContext context)
{
    var url = context.Request["url"];
    var req = (HttpWebRequest)WebRequest.Create(url);
    req.Method = context.Request.HttpMethod;
    req.ContentType = context.Request.ContentType;
    req.Headers["x-customheader"] = context.Request.Headers["x-customheader"];

    using (var reqStream = req.GetRequestStream())
    {
        context.Request.InputStream.Position = 0;
        context.Request.InputStream.CopyTo(reqStream);
    }

    using (var response = (HttpWebResponse)req.GetResponse())
    using (var stream = response.GetResponseStream())
    {
        context.Response.ContentType = response.ContentType;
        stream.CopyTo(context.Response.OutputStream);
    }
} 
```

# intellij-idea - IntelliJ Idea 12 - 防止程序参数打印到控制台

> ID：15235470
> 
> 赞同：0
> 
> 时间：2013-03-05T22:34:07.530
> 
> 标签：intellij-idea

比如我运行 mine.Test 类的时候，控制台的第一行就是这个巨大的字符串，说明控制台的水平滚动条太短了。我怎样才能阻止这个？

```
"C:\Program Files\Java\jdk1.7.0_17\bin\java" -Didea.launcher.port=7536 "-Didea.launcher.bin.path=C:\Program Files (x86)\JetBrains\IntelliJ IDEA 12.0.4\bin" -Dfile.encoding=UTF-8 -classpath "C:\Users\user\mydir\bin;C:\Users\user\mydir\lib\DTNConsoleConnection.jar;C:\Users\user\mydir\lib\ECLA.jar;C:\Users\user\mydir\jars\commons-math3-3.0.jar;C:\Users\user\mydir\jars\guava-12.0.1.jar;C:\Users\user\mydir\jars\mpj.jar;C:\Users\user\mydir\jars\commons-io-2.4.jar;C:\Users\user\mydir\jars\javageom-loweracc.jar;C:\Users\user\mydir\jars\jgrapht-jdk1.6.jar;C:\Users\user\mydir\jars\cplex.jar;C:\Users\user\mydir\jars\trove-3.0.3.jar;C:\Program Files (x86)\JetBrains\IntelliJ IDEA 12.0.4\lib\junit-4.10.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\charsets.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\deploy.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\javaws.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\jce.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\jfr.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\jfxrt.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\jsse.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\management-agent.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\plugin.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\resources.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\rt.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\access-bridge-64.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\dnsns.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\jaccess.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\localedata.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\sunec.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\sunjce_provider.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\sunmscapi.jar;C:\Program Files\Java\jdk1.7.0_17\jre\lib\ext\zipfs.jar;C:\Program Files (x86)\JetBrains\IntelliJ IDEA 12.0.4\lib\idea_rt.jar" com.intellij.rt.execution.application.AppMain mine.Test 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T06:20:21.147

在此行的控制台中右键单击，选择**像这样折叠线**，配置折叠模式。

对我来说，在运行单元测试和 Java 应用程序时，默认情况下会折叠命令行：

![折叠命令行](../Images/2ef98c244f894437175c21f4e5cce371.png)

请注意，您不能完全关闭命令行的打印，您只能将其折叠。

为了避免水平滚动条，您还可以为[控制台启用软包装](http://img22.imageshack.us/img22/240/20130306102142.png)。

# php - php：用链接替换url，除非它是图片标签

> ID：15235473
> 
> 赞同：0
> 
> 时间：2013-03-05T22:34:20.553
> 
> 标签：php, url, preg-replace, image, detect

我使用一个脚本来检测字符串中的 url 并将其替换为锚标记：

```
$string = preg_replace("/([^\w\/])(www\.[a-z0-9\-]+\.[a-z0-9\-]+)/i", "$1http://$2",$mytext);
$string = preg_replace("/([\w]+:\/\/[\w-?&;#~=\.\/\@]+[\w\/])/i","<a target=\"_blank\" href=\"$1\">$1</a>",$string);
$string = preg_replace("/([\w-?&;#~=\.\/]+\@(\[?)[a-zA-Z0-9\-\.]+\.([a-zA-Z]{2,3}|[0-9]{1,3})(\]?))/i","<a href=\"mailto:$1\">$1</a>",$string); 
```

它工作正常，除非它遇到图像标签。例如：

```
<img src="http://www.xx.com/img.jpg" alt=""/> 
```

会变成：

```
<img src="<a href="http://www.xx.com/img.jpg">http://www.xx.com/img.jpg</a>http://www.xx.com/img.jpg" alt=""/> 
```

**如果' src="** ' 就在它之前，我应该如何修改这个 preg_replace 以便不改变 url ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:57:30.773

尝试`/`在每个正则表达式的末尾添加这个：

```
(?<!\.(?:jpe?g|png|gif)) 
```

这应该检查以确保最后一位（扩展部分）不是标准图像格式之一。

# php - 无法使用简单的 HTML 表单更改 MySQL 变量

> ID：15235480
> 
> 赞同：0
> 
> 时间：2013-03-05T22:34:42.587
> 
> 标签：php, mysql, database, variables, webforms

当我尝试此代码时，出现类似错误；

```
Warning: mysql_select_db() [function.mysql-select-db]: Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) in /home/content/28/10527728/html/TestSite/page.php on line 20
Warning: mysql_select_db() [function.mysql-select-db]: A link to the server could not be established in /home/content/28/10527728/html/TestSite/page.php on line 20
Warning: mysql_query() expects parameter 2 to be resource, null given in /home/content/28/10527728/html/TestSite/page.php on line 21
Could not update data: Can't connect to local MySQL server through socket '/var/lib/mysql/mysql.sock' (2) 
```

代码：

```
<?php
 ob_start();
 session_start();
 if(!isset($_SESSION['Username'])){
     header("Location: page.php");
 }    

  if(isset($_POST['update']))
  {
        $Memberid = $_POST['Memberid'];
        $Username = $_POST['Username'];

        $sql = "UPDATE members ".
   "SET Username = $Username ".
   "WHERE Memberid = $Memberid" ;

  mysql_select_db($finalform);
  $retval = mysql_query( $sql, $conn );
  if(! $retval )
  {
    die('Could not update data: ' . mysql_error());
  }
  echo "Updated data successfully\n";
  mysql_close($conn);
        }
  else
  {
  ?> 
```

用于编辑成员表的用户名的 HTML，采用数据库最终形式；

```
 <form method="post" action="<?php $_PHP_SELF ?>">
  <table width="400" border="0" cellspacing="1" cellpadding="2">
  <tr>
  <td width="100">Name</td>
  <td><input name="Username" type="text" id="Username"></td>
  </tr>

  <td width="100"> </td>
  <td>
  <input name="update" type="submit" id="update" value="Update">
  </td>
  </tr>

  </table>
  </form>

  <?php
  } //Curly bracket close from the else from the begining
  ?>

  </body>
  </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:40:02.947

您缺少[mysql_connect()](http://php.net/manual/en/function.mysql-connect.php)函数。你正在关闭`$conn`，所以让我们使用它：

```
$conn = mysql_connect('localhost', 'user', 'pass'); 
```

话虽如此，您真的应该尝试使用[PDO](http://www.php.net/manual/en/book.pdo.php)或类似的替代方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:42:34.537

```
 $conn = mysql_connect( server, username, password ); 
```

IE ：

```
 $conn = mysql_connect( 'localhost', 'userName', 'yourPassword' ); 
```

我同意尝试 PDO，对于立即生效的解决方案，请尝试我的解决方案。

# ruby-on-rails - 简单的表单关联输入：按条件限制选项

> ID：15235481
> 
> 赞同：3
> 
> 时间：2013-03-05T22:34:44.773
> 
> 标签：ruby-on-rails, simple-form

我有一个带有代码的简单表格：

```
<%= simple_form_for @business, :html => {:class => "form-inline"} do |f| %>
<%= f.association :business_type, :as => :collection_select, :input_html => {:class => "input-small"}, :label => "Type of Business"%>
<%= f.button :submit, :class => "primary pull-left" %>
<% end %> 
```

在`business type`模型中，我有以下内容：first_tier、second_tier、third_tier。

我希望选择允许用户选择`business type`模型中的所有选项，除了 first_tier 选项但无法使其工作。

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T00:36:31.423

您可以使用以下方法限制收集选项：

```
f.association :business_type, :as => :collection_select, collection: BusinessType.where('biztype <>?', 1), :input_html => {:class => "input-small"}, :label => "Type of Business" 
```

我不确定您使用什么变量来定义层，但是当它不等于 first_tier 以限制业务类型选项时，该变量只是寻找。[更多信息](https://github.com/plataformatec/simple_form)可以在文档中找到。

# c# - 如何将数字更改为格式化字符串

> ID：15235483
> 
> 赞同：-2
> 
> 时间：2013-03-05T22:34:47.690
> 
> 标签：c#, .net

如何在 C# 中将数字格式化为字符串？

例如，如何获取 34549321 之类的数字并将其显示为 34,549k？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:50:28.553

如果此值来自绑定，则引入一个 Converter 类，该类接受一个数字并返回一个字符串。

转换器教程：[http ://wpftutorial.net/ValueConverters.html](http://wpftutorial.net/ValueConverters.html)

您还可以在绑定表达式中仅使用 StringFormat 来格式化没有转换器的绑定，但这比转换器更受限制。看：

1.  [http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.stringformat.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.stringformat.aspx) - 将 StringFormat 添加到绑定
2.  [http://msdn.microsoft.com/en-us/library/0c899ak8.aspx](http://msdn.microsoft.com/en-us/library/0c899ak8.aspx) - 允许的格式字符串

您可以在 C# 代码中使用 String.Format("",...) 将数字转换为格式化字符串。

对于您的示例（对数字长度的假设过多）：

```
int x = 34549321;
string xs = string.Format("{0:#,##,k}",x);
// Produces xs = 34,549k 
```

# mysql - 似乎没有使用大型数据库中时间戳字段的键

> ID：15235488
> 
> 赞同：1
> 
> 时间：2013-03-05T22:34:59.107
> 
> 标签：mysql, sql, indexing

我有下表 - 它包含大约 100 万行：

```
CREATE TABLE `history` (
   `user` varchar(12) COLLATE latin1_general_ci NOT NULL DEFAULT '',
   `link` text COLLATE latin1_general_ci NOT NULL,
   `query` text COLLATE latin1_general_ci NOT NULL,
   `hits` int(11) DEFAULT NULL,
   `time_of_query` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
   `checked` varchar(30) COLLATE latin1_general_ci DEFAULT NULL,
   `subcorpus` blob,
   `typeOfRestriction` char(10) COLLATE latin1_general_ci DEFAULT NULL,
   `items` blob,
   `textOrSpeaker` char(10) COLLATE latin1_general_ci DEFAULT NULL,
   `simple_query` text COLLATE latin1_general_ci,
   `queryMode` char(10) COLLATE latin1_general_ci DEFAULT NULL,
   KEY `user` (`user`),
   KEY `query` (`query`(256)),
   KEY `checked` (`checked`),
   KEY `time_of_query` (`time_of_query`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci 
```

我最近为此添加了一个键来`time_of_query`加快速度。但是，如下所示，查询中似乎没有使用该键：

```
mysql> explain SELECT * FROM history ORDER BY time_of_query DESC;
+----+-------------+---------+------+---------------+------+---------+------+--------+----------------+
| id | select_type | table   | type | possible_keys | key  | key_len | ref  | rows   | Extra          |
+----+-------------+---------+------+---------------+------+---------+------+--------+----------------+
|  1 | SIMPLE      | history | ALL  | NULL          | NULL | NULL    | NULL | 969083 | Using filesort |
+----+-------------+---------+------+---------------+------+---------+------+--------+----------------+
1 row in set (0.00 sec) 
```

有人可以解释为什么会这样吗？

# c# - 将 vba 转换为 VSTO 并选择使用的单元格

> ID：15235494
> 
> 赞同：0
> 
> 时间：2013-03-05T22:35:23.453
> 
> 标签：c#, vba, vsto

大家好，我正在尝试将一些现有的代码从 VBA 转换为 VSTO，到目前为止我已经非常成功。这是我要转换的代码。

```
this is the vba code

Sub FindUsedRange()
Dim LastRow As Long
Dim FirstRow As Long
Dim LastCol As Integer
Dim FirstCol As Integer

' Find the FIRST real row
FirstRow = ActiveSheet.Cells.Find(What:="*", _
  SearchDirection:=xlNext, _
  SearchOrder:=xlByRows).Row

' Find the FIRST real column
FirstCol = ActiveSheet.Cells.Find(What:="*", _
  SearchDirection:=xlNext, _
  SearchOrder:=xlByColumns).Column

' Find the LAST real row
LastRow = ActiveSheet.Cells.Find(What:="*", _
  SearchDirection:=xlPrevious, _
  SearchOrder:=xlByRows).Row

' Find the LAST real column
LastCol = ActiveSheet.Cells.Find(What:="*", _
  SearchDirection:=xlPrevious, _
  SearchOrder:=xlByColumns).Column

'Select the ACTUAL Used Range as identified by the
'variables identified above
ActiveSheet.Range(Cells(FirstRow, FirstCol), _
    Cells(LastRow, LastCol)).Select
End Sub 
```

但是当我到达这部分时

```
 ActiveSheet.Range(Cells(FirstRow, FirstCol), _
        Cells(LastRow, LastCol)).Select
    End Sub 
```

在.net中我不知道如何处理？有没有人有任何想法，可以指出我正确的方向。

这是我正在构建的插件的 c# 代码，以防有人感兴趣。

```
 using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using Microsoft.Office.Interop.Excel;
//using office.Excel;
namespace ExcelAddIn3.TaskPane
{
    public partial class TaskPaneView : UserControl
    {
        public TaskPaneView()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {

var time = DateTime.Now.ToLongTimeString();

this.label1.Text = time;
System.Array arr;
Microsoft.Office.Interop.Excel.Range  LastRow;
int  firstRow;
Microsoft.Office.Interop.Excel.Range  lastCol;
Microsoft.Office.Interop.Excel.Range  firstCol;

Microsoft.Office.Interop.Excel.Range currentFind = null;
Microsoft.Office.Interop.Excel.Range firstFind = null;
Microsoft.Office.Interop.Excel.Range fruits = ExcelAddIn3.Globals.ThisAddIn.Application.get_Range("A:Z");

Microsoft.Office.Interop.Excel.Worksheet sheet;

firstRow = fruits.Find("*", Type.Missing, Type.Missing,
                                             Type.Missing,
                                             Microsoft.Office.Interop.Excel.XlSearchOrder.xlByRows,
                                             Microsoft.Office.Interop.Excel.XlSearchDirection.xlNext, true,
                                             Type.Missing, Type.Missing).Row;

firstCol = fruits.Find("*", Type.Missing, Type.Missing,
                                             Type.Missing,
                                             Microsoft.Office.Interop.Excel.XlSearchOrder.xlByColumns,
                                             Microsoft.Office.Interop.Excel.XlSearchDirection.xlNext, true,
                                             Type.Missing, Type.Missing);

LastRow = fruits.Find("*", Type.Missing, Type.Missing,
                                            Type.Missing,
                                             Microsoft.Office.Interop.Excel.XlSearchOrder.xlByRows,
                                             Microsoft.Office.Interop.Excel.XlSearchDirection.xlPrevious, true,
                                             Type.Missing, Type.Missing);

lastCol = fruits.Find("*", Type.Missing, Type.Missing,
                                            Type.Missing,
                                             Microsoft.Office.Interop.Excel.XlSearchOrder.xlByColumns,
                                             Microsoft.Office.Interop.Excel.XlSearchDirection.xlPrevious, true,
                                             Type.Missing, Type.Missing);

while (lastCol != null)
{
    if (firstFind == null)
    {
        firstFind = lastCol;
        System.Windows.Forms.MessageBox.Show(LastRow.get_Address() + "last Column.");

    }
    else
    {
        break;
    }
}

firstFind = null;          

 while (LastRow != null)
{
    if (firstFind == null)
    {
        firstFind = LastRow;
        System.Windows.Forms.MessageBox.Show(LastRow.get_Address() + "last row.");

    }
    else
    {
        break;
    }
}
firstFind = null;
while (firstCol != null)
{
    if (firstFind == null)
    {
        firstFind = firstCol;
        System.Windows.Forms.MessageBox.Show(firstCol.get_Address() + "first real column.");

    }
    else
    {
        break; 
    }
}

firstFind = null;
while(firstRow != null){
    if (firstFind == null)
    {

        System.Windows.Forms.MessageBox.Show(firstRow + "first real row.");

    }
    else 
        {

            break;
        }
}

Range currentCells = ExcelAddIn3.Globals.ThisAddIn.Application.get_Range(firstCol, lastCol);
currentCells.Select();

        }
    }
} 
```

现在我目前的解决方案是

```
Range currentCells = ExcelAddIn3.Globals.ThisAddIn.Application.get_Range(firstCol, lastCol);
currentCells.Select(); 
```

然而，这使用地址而不是 vba 代码的序数符号。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T20:27:57.377

在这里找到了更好的解决方案 [http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/afd7f2ab-ee1e-495f-8071-9f2377a603fb](http://social.msdn.microsoft.com/Forums/en-US/vsto/thread/afd7f2ab-ee1e-495f-8071-9f2377a603fb)

```
 private void FindUsedRange()
{
   Excel.Worksheet wks = this.ActiveSheet as Excel.Worksheet;

   if (wks != null)
   {
      wks.UsedRange.Select();
   }
} 
```

这与我使用 VSTO 编写的代码相同。希望它可以帮助别人。

# jquery - jquery ui datepicker - 只读时防止输入选择

> ID：15235499
> 
> 赞同：0
> 
> 时间：2013-03-05T22:35:45.147
> 
> 标签：jquery, jquery-ui, datepicker, enter

Jquery UI datepicker 似乎忽略了输入字段的“只读”属性。

在下面的代码中，我可以通过使用“beforeShow”事件来禁用弹出日历（感谢 StackOverflow 上的另一个答案 - 为了他人的利益而在此处复制）

但是，我无法阻止 Enter 键使用当前日期填充文本框。我尝试拦截“keydown”事件（如下），但没有任何乐趣。:-(

```
<input type="text" class=".input-date" readonly="readonly" />

$(".input-date").datepicker({
    beforeShow: function (input, inst) {
        if ($(input).attr("readonly")) {
            inst.dpDiv = $('<div style="display: none;"></div>');
        }
    }
})
.bind("keydown", function (e) {
    if (e.keyCode == 13 && $(this).attr("readonly") == "readonly") {
        e.preventDefault();
        e.stopPropagation();
        return false;
    }

}) 
```

FWIW：日期字段的“只读”在我的页面上动态打开和关闭，所以我不能不将 datepicker 插件应用于只读字段。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:43:36.003

使用`prop`而不是`attr`检查*readonly*。另外，检查它的真实性：

```
if ($(this).prop("readonly")){
    // do stuff
} 
```

### 更新

用于[`e.which`](http://api.jquery.com/event.which/)检测按下了哪个键。
此外，[`event.stopImmediatePropagation()`](http://api.jquery.com/event.stopImmediatePropagation/)用于停止默认操作：

```
if (e.which == 13 && $(this).prop("readonly")) {
    e.preventDefault();
    e.stopImmediatePropagation();
    return false;
} 
```

### 更新 2

此外，您可能希望`keydown`在激活之前绑定到，`datepicker`因为句柄执行的顺序 - 事件处理程序的执行顺序与它们绑定的顺序相同 - 例如，请参见[这个 SO question](https://stackoverflow.com/questions/2360655/jquery-event-handlers-always-execute-in-order-they-were-bound-any-way-around-t)。
所以你可能应该这样做：

```
$(".input-date").bind("keydown", function (e) {
    if (e.which == 13 && $(this).prop("readonly")) {
        e.preventDefault();
        e.stopImmediatePropagation();
        return false;
    }
}).datepicker({
    beforeShow: function (input, inst) {
        if ($(input).prop("readonly")) {
           inst.dpDiv = $('<div style="display: none;"></div>');
        }
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:37:12.807

你应该使用`.prop()`

```
 <input type="text" class=".input-date" readonly="readonly" />

    $(".input-date").datepicker({
        beforeShow: function (input, inst) {
            if ($(input).prop("readonly")) {
                inst.dpDiv = $('<div style="display: none;"></div>');
            }
        }
    })
    .bind("keydown", function (e) {
        if (e.keyCode == 13 && $(this).prop("readonly") == "readonly") {
            e.preventDefault();
            e.stopPropagation();
            return false;
        }
    }) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T07:53:56.450

如果输入是只读的，您可以将值保存`beforeShow`在 var 中并将其设置回输入：`onSelect`

```
var onShowValue;

$(".input-date").datepicker({
    beforeShow: function (input, inst) {
        if ($(input).prop("readonly")) {
            inst.dpDiv = $('<div style="display: none;"></div>');
        }
        onShowValue = $(input).val();
    },
    onSelect: function (date) {
        if ($(this).prop("readonly")) {
            $(this).val(onShowValue);
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-03T15:05:52.647

好的，我知道这很旧，但是如果其他人（像我一样）出现并且正在研究如何做到这一点，那么[根据 jQuery UI 文档](https://api.jqueryui.com/datepicker/#method-option)，有一种更清洁的方法：

`$("input[readonly='']").datepicker( "option", "disabled", true );`

您必须在切换输入的只读属性的任何代码旁边设置 disabled 属性。在我的例子中，页面加载了已经静态设置的只读元素，所以提供的选择器只是禁用了任何指定为只读的东西。

# c# - 当前线程的 C# JSON 反序列化

> ID：15235500
> 
> 赞同：0
> 
> 时间：2013-03-05T22:35:55.413
> 
> 标签：c#, json, reflection, deserialization

我想在当前线程上做 JSON 序列化，并通过反射反序列化它。

我成功地进行了序列化：

```
Thread t = new Thread(new ThreadStart(empty));
string ser = JsonConvert.SerializeObject(t); 
```

但是我没有成功进行反序列化..

我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:16:53.803

查看您在评论中发布的错误：*“一个类应该有一个默认构造函数、一个带参数的构造函数或一个标有 JsonConstructor 属性的构造函数。”*

System.Threading.Thread 不满足这些要求：它没有默认构造函数，多个构造函数带参数，并且没有一个用 JsonConstructor 属性标记。

您希望通过序列化线程对象来实现什么？

# java - 如何正确编程导弹寻路？

> ID：15235502
> 
> 赞同：0
> 
> 时间：2013-03-05T22:36:05.037
> 
> 标签：java

我目前正在编写塔防，导弹往往会错过敌人，而不是像在桌面塔防中那样跟随/击中敌人。这是因为他们在没有给敌人任何领先的情况下射击，所以当它到达敌人位置时，敌人已经在 3-5 像素之外。我查找了如何解决这个问题，发现我需要使用向量数学来解决这个问题。例如，这个网站[http://www.helixsoft.nl/articles/circle/sincos.htm](http://www.helixsoft.nl/articles/circle/sincos.htm)有一些关于如何编程寻的导弹的代码，但我不确定这是否是我需要解决我的问题的那种数学。

似乎 stackoverflow 上的帖子推荐了一些名为“命令指导”的东西，但不知道这将如何与 2d 游戏一起使用。

所以目前，我很困惑该怎么做。任何方向/指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:50:31.437

那篇文章正是您所需要的，请阅读关于制导导弹的部分并使用反正切函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:01:45.980

听起来您已经有了可以在敌人静止时正确击中敌人的代码，只有在导弹飞行时它们移动的事实才是问题所在。

你为什么不简单地将导弹从当前位置“重新发射”到敌人的新位置，只要敌人迈出一步，或者每 10 个像素左右导弹移动一次。

这将导致导弹“归位”在飞行中的敌人身上，而不是在导弹到达时预测敌人的位置。

不同之处在于“归位”每次都会导致命中，而预测方法将允许敌人在导弹飞行时通过改变行走方向来躲避导弹。您更喜欢哪一个是设计决定，但我认为通常的塔防游戏使用寻的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:14:21.730

您需要“预测”敌人的方向。假设它沿着直线移动，*塔*需要观察它的*目标*的速度和方向。

假设您的塔位于点 (0,0)，并且您收集了目标的两个观测值：

*   (100, 100) 在`t=0`
*   (90, 95) 在`t=1`

**Speed:** First calculate the distance between this two points:

```
 d = sqrt((x2-x1)^2 + (y2 - y1)^2) =
   = sqrt(10^2 + 5^2) = sqrt(125) = 11.18034 
```

So the speed of your target is 11.18034 (since you took the observations in an interval equivalent to one time-unit)

**Angle:** A bit of geometry. The slope of the trajectory is:

```
 m = (y2 - y1) / (x2 - x1) =
   = 5 / 10 = 0.5 
```

So the angle is:

```
 theta = arctan(0.5) = 0.463648 radians (or 26.56 degrees) 
```

With two points and the slope, you can estimate the trajectory of your target:

```
 y - y1 = m * (x - x1)
 ==> y = 0.5 * (x - 100) + 100 =
       = 0.5 * x + 50 
```

All that remains is to calculate the point where your missile can intercept the target. For that you'll need to know the speed of your missile and then calculate the "optimal" interception point. I'll leave you this second step to you. It's simple geometry (and a bit of creativity)

# android - 从片段中更改 Listfragments 选定项目

> ID：15235503
> 
> 赞同：0
> 
> 时间：2013-03-05T22:36:09.220
> 
> 标签：android, android-fragments, android-listfragment, android-fragmentactivity

我在我的应用程序中实现了主/详细流布局。有一个片段活动，一个列表片段和一个片段。

在我的片段中，我有一个上一个/下一个按钮可以在列表片段项目中导航，所以我不必滚动并单击另一个，它用于手机视图，但我希望它也可以在平板电脑上使用。

这是我的[布局](https://docs.google.com/drawings/d/1MJ70by139YoLU1DcteJmICX1tC2LhC_1u2iNNwMQSr8/edit?usp=sharing)图片。

如果我单击上一个或下一个，detailfragment 会将其内容更改为下一个或上一个项目，但在左侧，所选项目不会改变。那么问题是如何告诉左侧片段更改选择？

我使用了这个示例：http: [//developer.android.com/training/basics/fragments/index.html](http://developer.android.com/training/basics/fragments/index.html)

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T00:10:37.437

如果我理解得很好，您想在单击片段上的按钮时更改 ListFragment 上选择的项目。

在我看来，最好的方法是向活动发送一条消息（例如 onPrevButtonClicked() 参见[与活动通信](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)），然后在你的活动中你可以找到类似的片段，`Fragment fragment = (Fragment) getFragmentManager().findFragmentById(R.id.example_fragment);`然后在你的 ListFragment 上调用一个方法这将选择您列表中的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T07:52:35.397

最后我有一个解决方案，我用这段代码让它工作。

```
ListFragment lf = (ListFragment) getFragmentManager().findFragmentById(R.id.list_fragment);     
        slf.getListView().setItemChecked(mCurrentPosition, true); 
```

# angularjs - AngularJS ui-select2占位符未显示在嵌套的ng-repeat中

> ID：15235506
> 
> 赞同：2
> 
> 时间：2013-03-05T22:36:43.727
> 
> 标签：angularjs, angular-ui, jquery-select2

哇，好的。范围的噩梦。

我的输入中的占位符没有显示，它们作为独立输入工作 - 但是一旦将它们添加到列表中，它们就会失去作用域。我已经确定了这个问题 - 但我找不到解决方法 - 我认为如果我能理解这个问题，它将有助于解决我在 Angular 中的许多范围问题。在这种情况下如何管理范围？即使是资源也会有所帮助

HTML

```
<div ng-repeat="region in data.regions">
    <h2> {{region.name}} </h2>
    <input ui-select2="version2" type="hidden" name="keywordsLocal-{{$index}}" class="region-keywords input-xlarge" data-ng-model="data.regions[$index].keywords" required-multiple />
    <select ui-select2 id="copy-{{$index}}" ng-show="region.length > 1" class="input-xlarge" ng-click="_copy($event, $index)" data-ng-model="data.regions[$index].keywords">
        <option value="">Placeholder:</option>
        <option ng-repeat="region in data.regions" value="{{region.keywords}}">{{region.name}}</option>
    </select>
</div> 
```

图片

![在此处输入图像描述](../Images/a997a09849e9b2e535215d252add7087.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T20:09:21.903

我解决了这个问题。在文档中 - 它明确指出 select2 与 ng-options 指令“不兼容”。这让我一整天都感到困惑，因为我的整个应用程序在使用 ng-repeat 时出现问题。

我切换回 ng-options，一切都运行良好。

编辑：添加代码示例

```
<select class='copy' ng-change='_copyKeyword($index)' ng-disabled='max.keywords - keywordsSum() <= data.selected_region_objects.length' ng-model='selectedKeywords' ng-options='region.name for region in data.selected_region_objects | keywordFilter: {name: region.name}' style='width:200px;' ui-select2=''>
    <option value=''>Use same keywords as:</option>
</select> 
```

# ruby-on-rails - 为数据库中的用户设置布尔管理属性的最简单方法？(Ruby on Rails)

> ID：15235507
> 
> 赞同：0
> 
> 时间：2013-03-05T22:36:50.797
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sqlite

我试图让 Active Admin 工作，但不幸的是我可能必须手动执行此操作。

我想将用户 1 设置为管理员。用户模型没有列出 :admin 属性。

它有

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :password, :password_confirmation 
```

有没有办法可以进入数据库并更改用户 1 的管理员值？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:40:22.997

您可以从控制台快速执行此操作：

```
rails console
u = User.find(1) # .first if it's not really id => 1, but the first record
u.admin = true
u.save 
```

那会做到，但它是不可重复的，我不喜欢。但是一次修复它会好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:58:56.823

快速轻松地阅读[第 9.4.1 章 -](http://ruby.railstutorial.org/chapters/updating-showing-and-deleting-users#sec-administrative_users) Michael Hartl 的 Ruby on Rails 教程中的管理用户

# sql - 如何在 SSRS 中使用多值参数

> ID：15235518
> 
> 赞同：1
> 
> 时间：2013-03-05T22:37:32.223
> 
> 标签：sql, reporting-services, reportingservices-2005, multivalue

我有 1 张桌子。1 有 1 个多值参数，列出所有称为 PROPERTIES 的属性。我希望表格一次显示每行 1 个属性。

该表大约有 20 列，自始至终引用不同的数据集。

引用该属性的所有数据集都具有：`WHERE RMPROPID IN (@PROPERTIES)`并且数据集的`@PROPERTIES`值为：（`=JOIN(Parameters!PROPERTIES.Value,",")`这将创建所选属性的列表）

该表有一行，引用不同的数据集。表格数据集是`SelectedProperties`，行上的分组依据是`=Fields!RMPROPID.Value`

数据集`SelectedProperties`如下所示：

```
SELECT
   RMPROPID,
   propname
FROM
   RMPROP
WHERE
   RMPROPID IN (@PROPERTIES) 
```

每当我选择多个属性时，它都不起作用。什么都没有返回。有没有我错过的技巧？我希望 1 行一次引用一个属性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T15:30:08.367

问题是您在将参数传递给查询时重新定义了参数：

您不应该拥有这部分： `=JOIN(Parameters!PROPERTIES.Value,",")`这**不会**创建所选值的列表。它创建一个**单一**的值，它是一个组合所有选定值的字符串。

将上面的位替换为`=Parameters!PROPERTIES.Value`. SSRS 将适当地处理或将多个值放入 SQL 查询中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-24T10:04:24.307

一种性能不佳但可行的方法是使用 varchar(MAX) 并以逗号分隔的方式获取 UID。
然后你可以对它做一个 LIKE ：

```
CREATE FUNCTION [dbo].[tfu_RPT_SEL_Gebaeude]
( 
     --@in_mandant varchar(3) 
    --,@in_sprache varchar(2) 
    --,@in_groups varchar(8000) 
    --,@in_stichtag varchar(50) 
     @Standortkategorie varchar(MAX) 
    ,@Standort varchar(MAX) 
) 
    RETURNS table 
AS 
RETURN 
( 
    SELECT '00000000-0000-0000-0000-000000000001' AS RPT_FID_SK_UID, '00000000-0000-0000-0000-000000000000' AS RPT_FID_SO_UID, '00000000-0000-0000-0000-000000000000' AS RPT_UID, 'Ohne' AS RPT_Name, 999999999 AS RPT_Sort 

    UNION 

    SELECT DISTINCT 
         ISNULL(T_AP_Gebaeude.GB_SK_UID, '00000000-0000-0000-0000-000000000000') AS RPT_FID_SK_UID 
        ,T_AP_Gebaeude.GB_SO_UID AS RPT_FID_SO_UID 
        ,T_AP_Gebaeude.GB_UID AS RPT_UID 
        --,T_AP_Gebaeude.GB_MDT_ID AS RPT_MDT_ID 
        --,ISNULL(GB_Nr, '') + ' - ' + ISNULL(GB_Bezeichnung, '') AS RPT_Name 
        ,T_AP_Gebaeude.GB_Bezeichnung AS RPT_Name 

        --,T_AP_Gebaeude.GB_Bezeichnung AS RPT_Sort 
        ,ROW_NUMBER() OVER (ORDER BY T_AP_Gebaeude.GB_Bezeichnung ASC) AS RPT_Sort 
    FROM T_AP_Gebaeude 

    WHERE (1=1) 
    -- AND (T_AP_Standort.SO_MDT_ID = @in_mandant) 
    AND (T_AP_Gebaeude.GB_Status = 1) 
    AND (T_AP_Gebaeude.GB_DatumBis >= CONVERT(char(8), { fn NOW() }, 112)) 
    AND (T_AP_Gebaeude.GB_DatumVon <= { fn NOW() }) 

    --AND ( ISNULL(T_AP_Gebaeude.GB_SK_UID, '00000000-0000-0000-0000-000000000000') IN (@Standortkategorie) ) 
    AND ',' + @Standortkategorie + ',' LIKE '%,' + ISNULL(CAST(T_AP_Gebaeude.GB_SK_UID AS varchar(36)), '00000000-0000-0000-0000-000000000000') + ',%'

    -- AND ( ISNULL(T_AP_Gebaeude.GB_SO_UID, '00000000-0000-0000-0000-000000000000') IN (@Standort) ) 
    AND ',' + @Standort + ',' LIKE '%,' + ISNULL(CAST(T_AP_Gebaeude.GB_SO_UID AS varchar(36)), '00000000-0000-0000-0000-000000000000') + ',%'

    /*
    AND 
    ( 
        ( @in_groups = '0000') 
        OR 
        ( 
            SELECT 
                ISNULL(SUM(CAST(SOR_IsRead AS int)), 0) AS SOR_IsRead 
            FROM T_SYS_Standortrechte 
            WHERE (1=1) 
            AND T_SYS_Standortrechte.SOR_SO_UID = T_AP_Standort.SO_UID 
            --AND SOR_SO_UID = '274751EB-AED4-4E4C-B6D1-57C4FDBC8925' 

            AND @in_groups LIKE '%,' + CAST(T_SYS_Standortrechte.SOR_GRANTEE_ID AS varchar(36)) + ',%' 
        ) > 0 
    ) 

    AND 
    ( 
        ( @in_groups = '0000') 
        OR 
        ( 
            SELECT 
                ISNULL(SUM(CAST(GBR_IsRead AS int)), 0) AS GBR_IsRead 
            FROM T_SYS_Gebaeuderechte 
            WHERE (1=1) 
            AND T_SYS_Gebaeuderechte.GBR_GB_UID = T_AP_Gebaeude.GB_UID 
            --AND GBR_GB_UID = '274751EB-AED4-4E4C-B6D1-57C4FDBC8925' 

            AND @in_groups LIKE '%,' + CAST(T_SYS_Gebaeuderechte.GBR_GRANTEE_ID AS varchar(36)) + ',%' 
        ) > 0 
    ) 
    */

)

GO 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:52:58.170

您应该能够将索引放在末尾，如下所示：

参数！<ParameterName>.Value(0)

您可以根据您的行回报或类似的东西做一个索引。

更多信息在这里：http: [//msdn.microsoft.com/en-us/library/aa337292 (v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/aa337292(v=sql.90).aspx)

# php - 将数据保存到 MySQL 并使用该数据更新页面而不刷新

> ID：15235523
> 
> 赞同：0
> 
> 时间：2013-03-05T22:38:05.803
> 
> 标签：php, javascript, mysql, ajax, jquery

我正在尝试将评论表单中的数据保存到 MySQL 数据库中，然后使用该评论更新页面，而无需用户刷新。类似于 Facebook 评论的工作方式。

我到处寻找答案，但没有找到适合我需要的答案。

这是将表单数据提交到 php 脚本的 AJAX：

```
var ajaxSubmit = function(formEl) {
    // fetch where we want to submit the form to
    var url = $(formEl).attr('action');

    // fetch the data for the form
    var data = $(formEl).serializeArray();

    // setup the ajax request
    $.ajax({
        url: url,
        data: data,
        dataType: 'json',
        success: function(data) {
            if(rsp.success) {
                alert("Comment Successfully Added!");
        }
    });
  return false;
} 
```

我知道该页面当前不会使用此脚本更新，因为我正在发出警报。但是，当我提交数据时，我将被带到`/ajax/comment.process.php`调用`insertComment()`函数并将评论插入数据库的页面。我现在在`alert()`函数中有这个函数，但`success()`我什至没有得到它。

我想要的是提交评论时，用户不会离开当前页面，它只是更新了他们刚刚提交的内容。

这是代码`/ajax/comment.process.php'`

```
 session_start();

include_once('../classes/comment.class.php');
include_once('../classes/db.class.php');

$user_id = $_SESSION['user_id'];

$db = new DBConnection;
$comments = new Comment($db);

$blog_id = intval($_POST['blogID']);

$addCom = $comments->addComment($user_id);

if($addCom === FALSE) {
    $resp = "<span class='error'>Error adding comment</span>";
} else {

    $resp = $comments->getComments($blog_id);
}

return $resp; 
```

此脚本调用`insertComment()`将评论保存到数据库的函数，然后如果返回 true，它会调用`getComments()`检索特定帖子的评论并将它们存储在数组中的函数。

评论**已**成功保存到数据库，但我被重定向到`ajax/comment.process.php`空白页面。**如何使用他们发布的评论更新当前页面而无需刷新页面？**我认为返回`$resp`变量会做到这一点，然后我可以做一个`foreach()`循环来显示它们，但显然情况并非如此。

**编辑：**我已经实现了下面答案中建议的一切，但我还没有解决这个问题。`/ajax/comment.process.php`即使我有这三件事应该阻止提交表单，该表单仍然被提交`preventDefault();`：`return false;`和`return ajaxSubmit(this);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:54:53.593

在 ajax 中，您可以删除`dataType: 'json',`并删除`if(rsp.success) {`并发出简单的警报

```
$.ajax({
        url: url,
        data: data,
        success: function(data) {
                alert("Comment Successfully Added!");
                alert(data);
        }
}); 
```

在 php 而不是您正在使用的 return 中，使用 echo

```
echo $resp; 
```

至少你会看到是否有错误

之后，您可以开始使用 json 代码

在 php

```
echo json_encode($resp);//as soon as $resp is an array 
```

在ajax中你可以这样提醒`alert(data.keyofthearray)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:56:29.103

为了防止表单提交（正在发生的事情）使用`onsubmit="return ajaxSubmit(this);"`

您的 ajax 代码中也有语法错误。你永远不会关闭`if`块

```
var data = $(formEl).serialize();
$.ajax({
    url: url,
    data: data,
    dataType: 'json',
    success: function(data) {
        if(data.success) {
            alert("Comment Successfully Added!");
        }
    }
}); 
```

# ruby-on-rails-3.2 - Rails 3.2 应用程序 - 我应该使用版本控制 gem（paper_trail 或 vestal_versions）还是手动处理？

> ID：15235524
> 
> 赞同：6
> 
> 时间：2013-03-05T22:38:14.527
> 
> 标签：ruby-on-rails-3.2, gem, database-versioning, paper-trail-gem, vestal-versions

**我的问题：我应该推出自己的模型版本控制还是使用已经存在的版本控制 gem 之一？如果我应该使用 gem，哪个看起来最适合这个应用程序？**

**关于我的应用程序的信息**

我的应用程序是一个简单的清单应用程序。有清单和工作，我使用响应和提交来跟踪用户响应。响应告诉我使用说什么（“完成”，附注“我们需要更多拖把。”），提交告诉我该特定清单何时填写（因为可能有许多提交和给定的响应集清单）。如果有帮助，我将在下面显示我的关联。

```
#checklist.rb
class Checklist < ActiveRecord::Base
  has_many :jobs, :through => :checklists_jobs
  has_many :submissions
end

#job.rb
class Job < ActiveRecord::Base
  has_many :checklists, :through => :checklists_jobs
  has_many :responses
end

#response.rb
class Response < ActiveRecord::Base
  belongs_to :job
  belongs_to :submission
  belongs_to :user
end

#submission.rb
class Submission < ActiveRecord::Base
  belongs_to :user
  belongs_to :checklist
  has_many :responses
end 
```

**我想用版本控制做什么**

我想做的是记录用户对清单上的工作的反应。但我想确保如果清单发生更改，我可以重现原始清单（带有响应信息）。例如，我想确保我可以为所有以前版本的清单回答这个问题：

> “清单是什么样的，三个星期二前的反应是什么？”

如果我更改清单或其任何工作，我不想失去该问题的答案。

我认为最好的方法是使用版本控制（用于作业和清单）。例如，如果管理员更改了作业（名称或描述），那么我不会更新现有作业，而是创建一个新版本并保持旧版本不变。然后我把旧的东西留在原地，把清单指向工作的新版本。

**我应该使用宝石还是自己滚动？**

我试图决定是我应该自己推出（编写代码以增加版本，将所有内容指向版本，并保留以前的版本）还是使用现有的解决方案。两个最好的解决方案似乎是paper_trail 和vestal_versions。我没有足够的声望点来发布两个以上的链接，所以我将链接到 gem 的每个 Railscast（如果你愿意，它会让你到 gem 本身）。[Railscast 255 Undo with paper_trail](http://railscasts.com/episodes/255-undo-with-paper-trail)和[Railscast 177 Model Versioning](http://railscasts.com/episodes/177-model-versioning) - 177 使用vestal_versions。

自己滚动的优点：

*   我需要通过重建清单及其响应来报告所有历史数据。这是该应用程序的主要功能。看起来这对于我提到的宝石来说会很棘手。
*   我将能够报告版本组（“我想查看此作业的任何版本的所有回复”）。这样看起来很容易。

滚动我自己的缺点：

*   这会很棘手，因为我有几个 has_many :through 关联。我必须非常小心地更新所有表并正确连接表。（这也可能是其中一颗宝石的问题）。
*   由于我使用此版本数据进行报告，因此我担心性能问题。解析散列的计算成本似乎很高，而依赖带有索引的平面表似乎非常有效。
*   这两个 gem 似乎更倾向于保留版本历史以进行跟踪，而不是真正用于维护历史信息以用于报告目的。

这似乎很重要，因为无论我决定什么，我基本上都会坚持下去。我认为以后从一种方法切换到另一种方法并不容易。

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-05-10T05:33:45.953

使用 PaperTrail，不要推出自己的解决方案。我强烈不同意理查德的回答。PaperTrail 是一个非常活跃的项目，有很多人为错误修复做出贡献，支持最新的 Rails 和 Ruby 版本，并处理 gem 冲突。

如果你不喜欢 PaperTrail 做某事的方式，你应该分叉它并改变这种行为。如果是一般性改进，请提交拉取请求，以便我们都能从您的工作中受益。不要从头开始重写它，因为您没有事后发现 PaperTrail 提交者已经经历过的错误和极端情况。

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-03-05T22:59:07.677

我的经验是，当您询问有关制作自己的解决方案与使用第三方解决方案的问题时，答案几乎总是“自己动手”。您不仅可以在功能方面完全满足您的需求，而且您无需依赖其他开发人员：

1.  修复他们的错误
2.  支持最新的rails update/ruby update等。
3.  不会以您无法解决的微妙方式与您的应用程序发生某种冲突（需要不同版本的依赖 gem）。

我说如果你有能力，你应该花时间写出你想要的东西。两年后，它将获得丰厚的回报。

# c++ - static 关键字及其在 C++ 中的各种用途

> ID：15235526
> 
> 赞同：258
> 
> 时间：2013-03-05T22:38:26.797
> 
> 标签：c++, static

该关键字`static`在 C++ 中具有多种含义，我觉得这很令人困惑，我永远无法思考它实际上应该如何工作。

据我了解，有`static`存储持续时间，这意味着在全局情况下它会持续整个程序的生命周期，但是当您谈论本地时，这意味着它默认为零初始化。

C++ 标准对带有关键字的类数据成员这么说`static`：

**3.7.1 静态存储时长[basic.stc.static]**

> 3 关键字 static 可用于声明具有静态存储持续时间的局部变量。
> 
> 4 在类定义中应用于类数据成员的关键字 static 给出了数据成员静态存储的持续时间。

*局部变量*是什么意思？那是一个函数局部变量吗？因为还有当你声明一个本地函数时`static`，它只初始化一次，第一次进入这个函数。

它也只讨论了关于类成员的存储持续时间，它不是特定于实例的，这也是一个`static`否的属性？或者是存储时间？

那么`static`文件范围的情况呢？默认情况下是否所有全局变量都被认为具有静态存储持续时间？以下（来自第 3.7.1 节）似乎表明了这一点：

> 1 所有没有动态存储时长、没有线程存储时长、**非本地**变量都有静态存储时长。这些实体的存储应持续整个程序（3.6.2、3.6.3）

与`static`变量的链接有何关系？

这整个`static`关键字是彻头彻尾的混乱，有人可以澄清它英语的不同用途，还告诉我*什么时候*初始化一个`static`类成员？

* * *

## 回答 #1

> 赞同：184
> 
> 时间：2013-03-05T22:46:29.530

# 变量：

`static`*变量存在于定义它的翻译单元*的“生命周期”中，并且：

*   如果它在命名空间范围内（即在函数和类之外），则不能从任何其他翻译单元访问它。这称为“内部链接”或“静态存储持续时间”。（不要在标题中这样做，除了`constexpr`. 其他任何东西，你最终会在每个翻译单元中得到一个单独的变量，这非常令人困惑）
*   如果它*是函数中*的变量，则不能从函数外部访问它，就像任何其他局部变量一样。（这是他们提到的当地人）
*   由于 ，类成员没有限制范围`static`，但可以从类以及实例（如`std::string::npos`）中寻址。[注意：你可以在类中*声明*静态成员，但它们通常仍应在翻译单元（cpp 文件）中*定义*，因此，每个类只有一个]

位置作为代码：

```
static std::string namespaceScope = "Hello";
void foo() {
    static std::string functionScope= "World";
}
struct A {
   static std::string classScope = "!";
}; 
```

在执行翻译单元中的任何函数之前（可能在`main`开始执行之后），该翻译单元中具有静态存储持续时间（命名空间范围）的变量将被“常量初始化”（`constexpr`在可能的情况下，否则为零），然后非本地人*按照它们在翻译单元中定义的顺序*`std::string="HI";`正确地“动态初始化”（对于那些不是 这样的事情`constexpr`）。最后，函数局部静态将在第一次执行“到达”声明它们的行时被初始化。所有`static`变量都以初始化的相反顺序销毁。

获得这一切的最简单方法是将所有未`constexpr`初始化的静态变量设置为函数静态局部变量，这样可以确保在您尝试使用它们时正确初始化所有静态变量/全局变量，从而防止[静态初始化命令惨败](https://stackoverflow.com/questions/3035422/static-initialization-order-fiasco)。

```
T& get_global() {
    static T global = initial_value();
    return global;
} 
```

小心，因为当规范说命名空间范围变量默认具有“静态存储持续时间”时，它们的意思是“翻译单元的生命周期”位，但这并不*意味着*它不能在文件之外访问。

# 职能

明显更直接，`static`通常用作类成员函数，很少用于独立函数。

静态成员函数与常规成员函数的不同之处在于它可以在没有类的实例的情况下调用，并且由于它没有实例，它不能访问类的非静态成员。当您希望为绝对不引用任何实例成员的类或管理`static`成员变量提供函数时，静态变量很有用。

```
struct A {
    A() {++A_count;}
    A(const A&) {++A_count;}
    A(A&&) {++A_count;}
    ~A() {--A_count;}

    static int get_count() {return A_count;}
private:
    static int A_count;
}

int main() {
    A var;

    int c0 = var.get_count(); //some compilers give a warning, but it's ok.
    int c1 = A::get_count(); //normal way
} 
```

自由函数意味着该`static`函数不会被任何其他翻译单元引用，因此链接器可以完全忽略它。这有几个目的：

*   可以在 cpp 文件中使用，以保证该函数永远不会从任何其他文件中使用。
*   可以放在标题中，每个文件都有自己的函数副本。没用，因为 inline 做的事情几乎一样。
*   通过减少工作来加快链接时间
*   可以在每个翻译单元中放置一个同名的函数，它们都可以做不同的事情。例如，您可以`static void log(const char*) {}`在每个 cpp 文件中放置一个，并且它们都可以以不同的方式登录。

* * *

## 回答 #2

> 赞同：71
> 
> 时间：2013-03-05T22:52:20.890

静态存储持续时间意味着变量在程序的整个生命周期中都驻留在内存中的同一位置。

链接与此正交。

**我认为这是您可以做出的最重要的区别。**理解这一点和其余的，以及记住它，应该很容易（不是直接联系@Tony，而是将来可能会读到这个的人）。

关键字`static`可以用来表示内部链接**和**静态存储，但本质上它们是不同的。

> 局部变量是什么意思？那是一个函数局部变量吗？

是的。无论何时初始化变量（第一次调用函数以及执行路径到达声明点时），它都将在程序的生命周期内驻留在内存中的同一位置。在这种情况下，`static`给它静态存储。

> 现在静态和文件范围的情况如何？默认情况下是否所有全局变量都被认为具有静态存储持续时间？

是的，根据定义，所有全局变量都有静态存储持续时间（现在我们已经弄清楚了这意味着什么）。**但是**命名空间范围的变量没有用 声明`static`，因为这会给它们内部链接，所以每个翻译单元都有一个变量。

> 静态与变量的链接有何关系？

它为命名空间范围的变量提供内部链接。它为成员和局部变量提供静态存储持续时间。

让我们扩展这一切：

```
//

static int x; //internal linkage
              //non-static storage - each translation unit will have its own copy of x
              //NOT A TRUE GLOBAL!

int y;        //static storage duration (can be used with extern)
              //actual global
              //external linkage
struct X
{
   static int x;     //static storage duration - shared between class instances 
};

void foo()
{
   static int x;     //static storage duration - shared between calls
} 
```

> 这整个静态关键字是彻头彻尾的混乱

当然，除非你熟悉它。:) 为了避免在语言中添加新的关键字，委员会重新使用了这个，IMO，达到这个效果 - 混淆。它用于表示不同的事物（我可以说，可能是相反的事物）。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2017-04-16T21:06:56.720

为了澄清这个问题，我宁愿将“静态”关键字的用法分为三种不同的形式：

**（一种）。变量**

**（乙）。职能**

**（C）。类的成员变量/函数**

每个子标题的解释如下：

**(A) 变量的“静态”关键字**

这可能有点棘手，但是如果解释和理解得当，它就很简单了。

为了解释这一点，首先了解变量的**范围、持续时间和链接**是非常有用的，没有它们总是很难通过 staic 关键字的模糊概念看到

**1\. 范围**：确定在文件中的什么位置，变量是可访问的。它可以有两种类型：（i）**本地或块范围**。(ii)**全球范围**

**2\. 持续时间**：确定变量的创建和销毁时间。同样它有两种类型：（i）**自动存储持续时间**（对于具有本地或块范围的变量）。(ii)**静态存储持续时间（用于具有全局范围的变量或具有***静态*说明符的局部变量（在函数中或代码块中））。

**3\. 链接**：确定一个变量是否可以在另一个文件中被访问（或链接）。同样（幸运的是）它有两种类型：（i）**内部链接** （对于具有块作用域和全局作用域/文件作用域/全局命名空间作用域的变量）（ii）**外部链接**（对于仅具有全局作用域/文件作用域/的变量）全局命名空间范围）

让我们参考下面的示例，以更好地理解普通的全局和局部变量（没有具有静态存储持续时间的局部变量）：

```
//main file
#include <iostream>

int global_var1; //has global scope
const global_var2(1.618); //has global scope

int main()
{
//these variables are local to the block main.
//they have automatic duration, i.e, they are created when the main() is 
//  executed and destroyed, when main goes out of scope
 int local_var1(23);
 const double local_var2(3.14);

 {
/* this is yet another block, all variables declared within this block are 
 have local scope limited within this block. */
// all variables declared within this block too have automatic duration, i.e, 
/*they are created at the point of definition within this block,
 and destroyed as soon as this block ends */
   char block_char1;
   int local_var1(32) //NOTE: this has been re-declared within the block, 
//it shadows the local_var1 declared outside

 std::cout << local_var1 <<"\n"; //prints 32

  }//end of block
  //local_var1 declared inside goes out of scope

 std::cout << local_var1 << "\n"; //prints 23

 global_var1 = 29; //global_var1 has been declared outside main (global scope)
 std::cout << global_var1 << "\n"; //prints 29
 std::cout << global_var2 << "\n"; //prints 1.618

 return 0;
}  //local_var1, local_var2 go out of scope as main ends
//global_var1, global_var2 go out of scope as the program terminates 
//(in this case program ends with end of main, so both local and global
//variable go out of scope together 
```

现在是联动的概念。当一个文件中定义的全局变量打算在另一个文件中使用时，变量的链接起着重要作用。

全局变量的链接由关键字指定：(i) **static**和 (ii) **extern**

（现在你明白了）

static 关键字可以应用于具有局部和全局范围的变量，在这两种情况下，它们的含义不同。我将首先解释“静态”关键字在具有全局范围的变量中的用法（我还将阐明关键字“外部”的用法），然后再解释具有局部范围的变量。

## **1\. 全局范围变量的静态关键字**

全局变量具有静态持续时间，这意味着当使用它的特定代码块（例如 main() ）结束时它们不会超出范围。根据链接的不同，它们可以仅在声明它们的同一文件内访问（对于静态全局变量），或者在文件外部甚至在声明它们的文件之外访问（外部类型全局变量）

对于具有 extern 说明符的全局变量，并且如果在初始化它的文件之外访问该变量，则必须在使用它的文件中前向声明，就像函数必须前向一样如果它的定义位于与使用它的位置不同的文件中，则声明它。

相反，如果全局变量具有 static 关键字，则不能在已声明它的文件之外使用它。

（请参阅下面的示例以进行说明）

例如：

```
//main2.cpp
 static int global_var3 = 23;  /*static global variable, cannot be                            
                                accessed in anyother file */
 extern double global_var4 = 71; /*can be accessed outside this file                  linked to main2.cpp */
 int main() { return 0; } 
```

main3.cpp

```
//main3.cpp
#include <iostream>

int main()
{
   extern int gloabl_var4; /*this variable refers to the gloabal_var4
                            defined in the main2.cpp file */
  std::cout << global_var4 << "\n"; //prints 71;

  return 0;
} 
```

现在 c++ 中的任何变量都可以是 const 或非常量，对于每个“const-ness”，我们得到两种默认 c++ 链接的情况，以防未指定：

(i)**如果一个全局变量是非常量的，它的链接默认是外部的**，即非常量全局变量可以在另一个.cpp文件中通过使用extern关键字前向声明来访问（换句话说，非常量全局变量具有外部链接（当然具有静态持续时间））。在已定义的原始文件中使用 extern 关键字也是多余的。在这种情况下***，要使外部文件无法访问非常量全局变量，请在变量类型之前使用说明符“静态”***。

(ii)**如果全局变量为 const，则其链接默认为静态**，即 const 全局变量不能在其定义位置以外的文件中访问，（换句话说，const 全局变量具有内部链接（具有静态持续时间）当然））。此外，使用 static 关键字来防止 const 全局变量在另一个文件中被访问是多余的。在这里，***要使 const 全局变量具有外部链接，请在变量类型之前使用说明符“extern”***

这是具有各种链接的全局范围变量的摘要

```
//globalVariables1.cpp 

// defining uninitialized vairbles
int globalVar1; //  uninitialized global variable with external linkage 
static int globalVar2; // uninitialized global variable with internal linkage
const int globalVar3; // error, since const variables must be initialized upon declaration
const int globalVar4 = 23; //correct, but with static linkage (cannot be accessed outside the file where it has been declared*/
extern const double globalVar5 = 1.57; //this const variable ca be accessed outside the file where it has been declared 
```

接下来我们研究上述全局变量在不同文件中访问时的行为。

```
//using_globalVariables1.cpp (eg for the usage of global variables above)

// Forward declaration via extern keyword:
 extern int globalVar1; // correct since globalVar1 is not a const or static
 extern int globalVar2; //incorrect since globalVar2 has internal linkage
 extern const int globalVar4; /* incorrect since globalVar4 has no extern 
                         specifier, limited to internal linkage by
                         default (static specifier for const variables) */
 extern const double globalVar5; /*correct since in the previous file, it 
                           has extern specifier, no need to initialize the
                       const variable here, since it has already been
                       legitimately defined perviously */ 
```

2.  具有本地范围的变量的静态关键字

* * *

**本地范围内变量的静态关键字更新（2019 年 8 月）**

这进一步可以细分为两类：

**(i) 功能块内变量的静态关键字**，以及**(ii) 未命名局部块内变量的静态关键字。**

**(i) 功能块内变量的静态关键字。**

之前，我提到具有局部范围的变量具有自动持续时间，即它们在进入块时存在（无论是普通块，还是功能块），并且在块结束时不再存在，长话短说，***变量具有本地范围的自动持续时间***和自动持续时间变量（和对象）没有链接，这意味着它们在代码块之外不可见。

如果将**静态**说明符应用于功能块中的局部变量，它将**变量的持续时间从自动更改为静态**，并且其生命周期是程序的整个持续时间，这意味着它具有固定的内存位置并且其值仅被初始化如[cpp 参考](https://en.cppreference.com/w/c/language/static_storage_duration)中所述，在程序启动之前一次（初始化不应与赋值混淆）

让我们看一个例子。

```
//localVarDemo1.cpp    
 int localNextID()
{
  int tempID = 1;  //tempID created here
  return tempID++; //copy of tempID returned and tempID incremented to 2
} //tempID destroyed here, hence value of tempID lost

int newNextID()
{
  static int newID = 0;//newID has static duration, with internal linkage
  return newID++; //copy of newID returned and newID incremented by 1
}  //newID doesn't get destroyed here :-)

int main()
{
  int employeeID1 = localNextID();  //employeeID1 = 1
  int employeeID2 = localNextID();  // employeeID2 = 1 again (not desired)
  int employeeID3 = newNextID(); //employeeID3 = 0;
  int employeeID4 = newNextID(); //employeeID4 = 1;
  int employeeID5 = newNextID(); //employeeID5 = 2;
  return 0;
} 
```

看看上述静态局部变量和静态全局变量的标准，人们可能会想问，它们之间的区别是什么。虽然全局变量可以在代码中的任何位置访问（在相同以及不同的翻译单元中，取决于**const**和**extern**），但在功能块中定义的静态变量不能直接访问。变量必须由函数值或引用返回。让我们通过一个例子来证明这一点：

```
//localVarDemo2.cpp 

//static storage duration with global scope 
//note this variable can be accessed from outside the file
//in a different compilation unit by using `extern` specifier
//which might not be desirable for certain use case.
static int globalId = 0;

int newNextID()
{
  static int newID = 0;//newID has static duration, with internal linkage
  return newID++; //copy of newID returned and newID incremented by 1
}  //newID doesn't get destroyed here

int main()
{
    //since globalId is accessible we use it directly
  const int globalEmployee1Id = globalId++; //globalEmployeeId1 = 0;
  const int globalEmployee2Id = globalId++; //globalEmployeeId1 = 1;

  //const int employeeID1 = newID++; //this will lead to compilation error since newID++ is not accessible direcly. 
  int employeeID2 = newNextID(); //employeeID3 = 0;
  int employeeID2 = newNextID(); //employeeID3 = 1;

  return 0;
} 
```

关于选择静态全局和静态局部变量的更多解释可以在[这个stackoverflow线程上找到](https://stackoverflow.com/questions/12186857/on-local-and-global-static-variables-in-c)

**(ii) 未命名本地块中变量的静态关键字。**

一旦本地块超出范围，就不能在块外访问本地块（不是功能块）内的静态变量。这条规则没有任何警告。

```
 //localVarDemo3.cpp 
    int main()
    {

      {
          const static int static_local_scoped_variable {99};
      }//static_local_scoped_variable goes out of scope

      //the line below causes compilation error
      //do_something is an arbitrary function
      do_something(static_local_scoped_variable);
      return 0;
    } 
```

C++11 引入了`constexpr`保证在编译时对表达式求值并允许编译器优化代码的关键字。现在，如果某个范围内的静态 const 变量的值在编译时已知，则代码会以类似于`constexpr`. [这是一个小例子](https://godbolt.org/z/HgNCqJ)

[我还建议读者在这个 stackoverflow 线程](https://stackoverflow.com/questions/41125651/constexpr-vs-static-const-which-one-to-prefer)中查找变量之间`constexpr`的区别。这结束了我对应用于变量的静态关键字的解释。`static const`

**B. 用于函数的“静态”关键字**

就功能而言，static 关键字具有直截了当的含义。这里**指的是函数的链接** 通常在一个cpp文件中声明的所有函数默认都有外部链接，即一个文件中定义的函数可以通过前向声明在另一个cpp文件中使用。

**在函数声明之前使用 static 关键字会限制其与 internal 的链接**，即不能在其定义之外的文件中使用静态函数。

**C. Staitc 关键字用于类的成员变量和函数**

**1.类成员变量的'static'关键字**

我这里直接举个例子

```
#include <iostream>

class DesignNumber
{
  private:

      static int m_designNum;  //design number
      int m_iteration;     // number of iterations performed for the design

  public:
    DesignNumber() {     }  //default constructor

   int  getItrNum() //get the iteration number of design
   {
      m_iteration = m_designNum++;
      return m_iteration;
   }
     static int m_anyNumber;  //public static variable
};
int DesignNumber::m_designNum = 0; // starting with design id = 0
                     // note : no need of static keyword here
                     //causes compiler error if static keyword used
int DesignNumber::m_anyNumber = 99; /* initialization of inclass public 
                                    static member  */
enter code here

int main()
{
   DesignNumber firstDesign, secondDesign, thirdDesign;
   std::cout << firstDesign.getItrNum() << "\n";  //prints 0
   std::cout << secondDesign.getItrNum() << "\n"; //prints 1
   std::cout << thirdDesign.getItrNum() << "\n";  //prints 2

   std::cout << DesignNumber::m_anyNumber++ << "\n";  /* no object
                                        associated with m_anyNumber */
   std::cout << DesignNumber::m_anyNumber++ << "\n"; //prints 100
   std::cout << DesignNumber::m_anyNumber++ << "\n"; //prints 101

   return 0;
} 
```

在此示例中，静态变量 m_designNum 保留其值，并且此单个私有成员变量（因为它是静态的）与对象类型 DesignNumber 的所有变量共享

与其他成员变量一样，类的静态成员变量不与任何类对象关联，这可以通过在主函数中打印 anyNumber 来证明

**类中的 const 与非 const 静态成员变量**

**(i) 非常量类静态成员变量** 在前面的示例中，静态成员（公共和私有）是非常量的。ISO 标准禁止在类中初始化非常量静态成员。因此，与前面的示例一样，它们必须在类定义之后初始化，需要注意的是需要省略 static 关键字

**(ii) 类的 const-static 成员变量** 这很简单，符合其他 const 成员变量初始化的约定，即类的 const 静态成员变量*可以*在声明时初始化，也可以在结束时初始化类声明的一个警告，即在类定义之后初始化时，需要将关键字 const 添加到静态成员中。

但是，我建议在声明时初始化 const 静态成员变量。这符合标准 C++ 约定，使代码看起来更干净

有关类中静态成员变量的更多示例，请查看 learncpp.com [http://www.learncpp.com/cpp-tutorial/811-static-member-variables/的以下链接](http://www.learncpp.com/cpp-tutorial/811-static-member-variables/)

**2.类成员函数的'static'关键字**

就像类的成员变量可以是静态的一样，类的成员函数也可以。类的普通成员函数总是与类类型的对象相关联。相反，类的静态成员函数不与该类的任何对象相关联，即它们没有*this 指针。

其次，由于类的静态成员函数没有 *this 指针，因此可以在主函数中使用类名和作用域解析运算符调用它们（ClassName::functionName();）

第三，类的静态成员函数只能访问类的静态成员变量，因为类的非静态成员变量必须属于类对象。

有关类中静态成员函数的更多示例，请从 learncpp.com 查找以下链接

[http://www.learncpp.com/cpp-tutorial/812-static-member-functions/](http://www.learncpp.com/cpp-tutorial/812-static-member-functions/)

* * *

**2021 年 4 月更新：`static`关键字和 lambda 表达式**

Lambda 表达式遵循正常的名称查找规则，因此范围（本地与全局）和存储类（静态与自动）会影响 lambda 表达式如何使用变量

1.  非静态全局变量可用于局部范围内的 lambda 表达式。

```
 //global member   
    int i=10;

    int main(){
        []{std::cout << i;}();
        //prints 10
    } 
```

2.  出现在相同或不同范围内的 lambda 表达式不能使用非静态局部变量。在这种情况下，正如我们通常习惯的那样，变量必须通过值或引用来捕获

```
 int main(){
        int i{11};
        []{std::cout << i;}(); //compiler error
        [i]{std::cout << i;}(); //capture by value; correct
        //or
        [&i]{std::cout << i;}(); //capture by reference; correct
    } 
```

3.  静态变量局部作用域的静态变量可以被相同或更低/子作用域内的 lambda 表达式捕获

```
 int main(){
        static int i{12};
        []{std::cout << i;}(); //prints 12
        {
             []{std::cout << i;}();//also prints 12
        }
    } 
```

但是，如前所述，无法在范围外访问未命名范围内的静态变量

* * *

## 回答 #4

> 赞同：20
> 
> 时间：2013-03-05T22:52:59.523

其实很简单。如果在函数范围内将变量声明为静态变量，则在对该函数的连续调用之间保留其值。所以：

```
int myFun()
{
static int i=5;
i++;
return i;
}
int main()
{
printf("%d", myFun());
printf("%d", myFun());
printf("%d", myFun());
} 
```

将显示`678`而不是`666`，因为它会记住增加的值。

至于静态成员，它们在类的实例中保留它们的值。所以下面的代码：

```
struct A
{
static int a;
};
int main()
{
A first;
A second;
first.a = 3;
second.a = 4;
printf("%d", first.a);
} 
```

将打印 4，因为 first.a 和 second.a 本质上是相同的变量。至于初始化，看[这个问题。](https://stackoverflow.com/questions/185844/initializing-private-static-members)

* * *

## 回答 #5

> 赞同：12
> 
> 时间：2013-03-05T23:04:58.170

当您在文件范围内声明`static`变量时，该变量仅在*该*特定文件中可用（从技术上讲，是 *translation 单元，但我们不要让这太复杂）。例如：

**a.cpp**

```
static int x = 7;

void printax()
{
    cout << "from a.cpp: x=" << x << endl;
} 
```

**b.cpp**

```
static int x = 9;

void printbx()
{
    cout << "from b.cpp: x=" << x << endl;
} 
```

**主.cpp：**

```
int main(int, char **)
{
    printax(); // Will print 7
    printbx(); // Will print 9

    return 0;
} 
```

对于*局部*变量，`static`意味着该变量将被零初始化*并*在调用之间保留其值：

```
unsigned int powersoftwo()
{
    static unsigned lastpow;

    if(lastpow == 0)
        lastpow = 1;
    else
        lastpow *= 2;

    return lastpow;
}

int main(int, char **)
{
    for(int i = 0; i != 10; i++)
        cout << "2^" << i << " = " << powersoftwo() << endl;
} 
```

对于*类*变量，这意味着该变量只有一个实例在该类的所有成员之间共享。根据权限，可以使用其完全限定名称从类外部访问该变量。

```
class Test
{
private:
    static char *xxx;

public:
    static int yyy;

public:
    Test()
    {        
        cout << this << "The static class variable xxx is at address "
             << static_cast<void *>(xxx) << endl;
        cout << this << "The static class variable yyy is at address "
             << static_cast<void *>(&y) << endl;
    }
};

// Necessary for static class variables.
char *Test::xxx = "I'm Triple X!";
int Test::yyy = 0;

int main(int, char **)
{
    Test t1;
    Test t2;

    Test::yyy = 666;

    Test t3;
}; 
```

将非类函数标记为`static`使该函数只能从该文件访问，而不能从其他文件访问。

**a.cpp**

```
static void printfilename()
{ // this is the printfilename from a.cpp - 
  // it can't be accessed from any other file
    cout << "this is a.cpp" << endl;
} 
```

**b.cpp**

```
static void printfilename()
{ // this is the printfilename from b.cpp - 
  // it can't be accessed from any other file
    cout << "this is b.cpp" << endl;
} 
```

对于类成员函数，将它们标记为`static`意味着不需要在对象的特定实例上调用该函数（即它没有`this`指针）。

```
class Test
{
private:
    static int count;

public:
    static int GetTestCount()
    {
        return count;
    };

    Test()
    {
        cout << this << "Created an instance of Test" << endl;
        count++;
    }

    ~Test()
    {
        cout << this << "Destroyed an instance of Test" << endl;
        count--;
    }
};

int Test::count = 0;

int main(int, char **)
{
    Test *arr[10] = { NULL };

    for(int i = 0; i != 10; i++)
        arr[i] = new Test();

    cout << "There are " << Test::GetTestCount() << " instances of the Test class!" << endl;

    // now, delete them all except the first and last!
    for(int i = 1; i != 9; i++)
        delete arr[i];        

    cout << "There are " << Test::GetTestCount() << " instances of the Test class!" << endl;

    delete arr[0];

    cout << "There are " << Test::GetTestCount() << " instances of the Test class!" << endl;

    delete arr[9];

    cout << "There are " << Test::GetTestCount() << " instances of the Test class!" << endl;

    return 0;
} 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2013-03-05T22:42:51.453

静态变量在类的每个实例之间共享，而不是每个类都有自己的变量。

```
class MyClass
{
    public:
    int myVar; 
    static int myStaticVar;
};

//Static member variables must be initialized. Unless you're using C++11, or it's an integer type,
//they have to be defined and initialized outside of the class like this:
MyClass::myStaticVar = 0;

MyClass classA;
MyClass classB; 
```

“MyClass”的每个实例都有自己的“myVar”，但共享相同的“myStaticVar”。事实上，您甚至不需要 MyClass 的实例来访问“myStaticVar”，您可以像这样在类之外访问它：

```
MyClass::myStaticVar //Assuming it's publicly accessible. 
```

当在函数内部用作局部变量（而不是作为类成员变量）时，静态关键字会做一些不同的事情。它允许您创建一个持久变量，而无需提供全局范围。

```
int myFunc()
{
   int myVar = 0; //Each time the code reaches here, a new variable called 'myVar' is initialized.
   myVar++;

   //Given the above code, this will *always* print '1'.
   std::cout << myVar << std::endl;

   //The first time the code reaches here, 'myStaticVar' is initialized. But ONLY the first time.
   static int myStaticVar = 0;

   //Each time the code reaches here, myStaticVar is incremented.
   myStaticVar++;

   //This will print a continuously incrementing number,
   //each time the function is called. '1', '2', '3', etc...
   std::cout << myStaticVar << std::endl;
} 
```

就持久性而言，它是一个全局变量……但在范围/可访问性方面不是全局的。

您还可以拥有静态成员函数。静态函数基本上是非成员函数，但在类名的命名空间内，并且可以私有访问类的成员。

```
class MyClass
{
    public:
    int Func()
    {
        //...do something...
    }

    static int StaticFunc()
    {
        //...do something...
    }
};

int main()
{
   MyClass myClassA;
   myClassA.Func(); //Calls 'Func'.
   myClassA.StaticFunc(); //Calls 'StaticFunc'.

   MyClass::StaticFunc(); //Calls 'StaticFunc'.
   MyClass::Func(); //Error: You can't call a non-static member-function without a class instance!

   return 0;
} 
```

当你调用一个成员函数时，有一个名为“this”的隐藏参数，它是一个指向调用该函数的类的实例的指针。静态成员函数**没有**那个隐藏参数......它们可以在没有类实例的情况下调用，但也不能访问类的非静态成员变量，因为它们没有“this”指针可以使用。它们不会在任何特定的类实例上被调用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-05T22:52:18.447

我不是 C 程序员，所以我不能正确地为您提供有关在 C 程序中使用静态的信息，但是当涉及到面向对象的编程时，静态基本上声明一个变量、一个函数或一个类是相同的在程序的整个生命周期中。举个例子。

```
class A
{
public:
    A();
    ~A();
    void somePublicMethod();
private:
    void somePrivateMethod();
}; 
```

当您在 Main 中实例化此类时，您会执行类似的操作。

```
int main()
{
   A a1;
   //do something on a1
   A a2;
   //do something on a2
} 
```

这两个类实例完全不同，彼此独立运行。但是，如果您要像这样重新创建 A 类。

```
class A
{
public:
    A();
    ~A();
    void somePublicMethod();
    static int x;
private:
    void somePrivateMethod();
}; 
```

让我们再次回到主线。

```
int main()
{
   A a1;
   a1.x = 1;
   //do something on a1
   A a2;
   a2.x++;
   //do something on a2
} 
```

那么 a1 和 a2 将共享 int x 的同一个副本，因此 a1 中对 x 的任何操作都会直接影响 a2 中 x 的操作。所以如果我要这样做

```
int main()
{
   A a1;
   a1.x = 1;
   //do something on a1
   cout << a1.x << endl; //this would be 1
   A a2;
   a2.x++;
   cout << a2.x << endl; //this would be 2 
   //do something on a2
} 
```

A 类的两个实例共享静态变量和函数。希望这能回答你的问题。我对 C 的有限知识允许我说将函数或变量定义为静态意味着它仅对函数或变量被定义为静态的文件可见。但这最好由 C 人而不是我来回答。C++ 允许使用 C 和 C++ 两种方式将变量声明为静态，因为它与 C 完全向后兼容。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-05T23:06:29.200

> 局部变量是什么意思？那是一个函数局部变量吗？

是 - 非全局的，例如函数局部变量。

> 因为还有当你声明一个本地函数为静态时，它只初始化一次，第一次进入这个函数。

对。

> 它也只谈论关于类成员的存储持续时间，它不是特定于实例的，这也是静态的属性吗？或者是存储时间？

```
class R { static int a; }; // << static lives for the duration of the program 
```

也就是说，所有的`R`share实例`int R::a`都`int R::a`不会被复制。

> 现在静态和文件范围的情况如何？

实际上是一个在适当的地方具有构造函数/析构函数的全局变量——初始化不会推迟到访问。

> 静态与变量的链接有何关系？

对于本地功能，它是外部的。访问：函数可以访问它（当然，除非你返回它）。

对于一个类，它是外部的。访问：标准访问说明符适用（公共、受保护、私有）。

`static`还可以指定内部链接，具体取决于它的声明位置（文件/命名空间）。

> 这整个静态关键字是彻头彻尾的混乱

它在 C++ 中有太多用途。

> 有人可以澄清它的不同用途英语并告诉我何时初始化静态类成员吗？

`main`如果它已加载并具有构造函数，它会在之前自动初始化。这听起来可能是件好事，但是初始化顺序在很大程度上超出了您的控制范围，因此复杂的初始化变得非常难以维护，并且您希望将其最小化——如果您必须有一个静态的，那么函数本地规模会更好地跨库和项目。至于具有静态存储持续时间的数据，您应该尽量减少这种设计，尤其是在可变（全局变量）的情况下。初始化“时间”也因多种原因而变化——加载程序和内核有一些技巧来最小化内存占用和延迟初始化，具体取决于相关数据。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2015-05-08T08:49:27.730

**静态对象：**我们可以使用静态关键字定义类成员静态。当我们将类的成员声明为静态时，这意味着无论创建多少类对象，静态成员都只有一个副本。

静态成员由类的所有对象共享。如果不存在其他初始化，则在创建第一个对象时将所有静态数据初始化为零。我们不能将它放在类定义中，但可以在类外部初始化它，如下例所示，通过重新声明静态变量，使用范围解析运算符 :: 来识别它属于哪个类。

让我们尝试下面的例子来理解静态数据成员的概念：

```
#include <iostream>

using namespace std;

class Box
{
   public:
      static int objectCount;
      // Constructor definition
      Box(double l=2.0, double b=2.0, double h=2.0)
      {
         cout <<"Constructor called." << endl;
         length = l;
         breadth = b;
         height = h;
         // Increase every time object is created
         objectCount++;
      }
      double Volume()
      {
         return length * breadth * height;
      }
   private:
      double length;     // Length of a box
      double breadth;    // Breadth of a box
      double height;     // Height of a box
};

// Initialize static member of class Box
int Box::objectCount = 0;

int main(void)
{
   Box Box1(3.3, 1.2, 1.5);    // Declare box1
   Box Box2(8.5, 6.0, 2.0);    // Declare box2

   // Print total number of objects.
   cout << "Total objects: " << Box::objectCount << endl;

   return 0;
} 
```

当上面的代码被编译并执行时，它会产生以下结果：

```
Constructor called.
Constructor called.
Total objects: 2 
```

**静态函数成员：** 通过将函数成员声明为静态成员，可以使其独立于类的任何特定对象。即使类的对象不存在并且静态函数仅使用类名和范围解析运算符 :: 访问，也可以调用静态成员函数。

静态成员函数只能从类外部访问静态数据成员、其他静态成员函数和任何其他函数。

静态成员函数具有类作用域，它们无权访问类的 this 指针。您可以使用静态成员函数来确定类的某些对象是否已创建。

让我们尝试下面的例子来理解静态函数成员的概念：

```
#include <iostream>

using namespace std;

class Box
{
   public:
      static int objectCount;
      // Constructor definition
      Box(double l=2.0, double b=2.0, double h=2.0)
      {
         cout <<"Constructor called." << endl;
         length = l;
         breadth = b;
         height = h;
         // Increase every time object is created
         objectCount++;
      }
      double Volume()
      {
         return length * breadth * height;
      }
      static int getCount()
      {
         return objectCount;
      }
   private:
      double length;     // Length of a box
      double breadth;    // Breadth of a box
      double height;     // Height of a box
};

// Initialize static member of class Box
int Box::objectCount = 0;

int main(void)
{

   // Print total number of objects before creating object.
   cout << "Inital Stage Count: " << Box::getCount() << endl;

   Box Box1(3.3, 1.2, 1.5);    // Declare box1
   Box Box2(8.5, 6.0, 2.0);    // Declare box2

   // Print total number of objects after creating object.
   cout << "Final Stage Count: " << Box::getCount() << endl;

   return 0;
} 
```

当上面的代码被编译并执行时，它会产生以下结果：

```
Inital Stage Count: 0
Constructor called.
Constructor called.
Final Stage Count: 2 
```

# sql - 选择第一行并用 Proc Sql 合并成一个数据集

> ID：15235528
> 
> 赞同：1
> 
> 时间：2013-03-05T22:38:44.883
> 
> 标签：sql, sas

问题出在 SAS 9.1.3 下，有两个数据集：A 和 B。

集合 A 是包含日期和名称的主要数据集。

```
data Aa;
    input date name $  ;
    datalines;
    20120102 A 
    20110102 B 
    20120102 C 
    20110102 A 
    20120102 B 
    20110102 C 
    ; 
```

集合 B 包含我要合并到集合 A 的数据。

```
data B;
    input date name $  rate;
    datalines;
    20120101 A 0.01
    20120101 B 0.02
    20120101 C 0.03
    20110101 A -0.01
    20110101 B -0.02
    20110101 C -0.03
    ; 
```

我知道 SAS proc sql 中没有 fetch xxx 行，因此我在集合 B 中添加了行数：

```
proc sort data = b; by descending  date  name ;run;
data b1;
    set b;
    ind = _n_;
run; 
```

我想要做的是将B的最新费率合并到A中。我的proc sql是这样的：

```
proc sql;
    create table new as
    select a.*,b.rate
    from Aa a left join b1 b
    on a.name = b.name and a.date>=b.date
    group by b.ind having min(b.ind)=b.ind; 
quit; 
```

但我的结果是这样的：

```
20110102 A .  

20110102 B .  

20110102 C .  

20120102 A -0.01

20120102 B -0.02 

20120102 C -0.03 
```

预期结果是：

```
20110102 A -0.01  

20110102 B -0.02  

20110102 C -0.03  

20120102 A 0.01

20120102 B 0.02 

20120102 C 0.03 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:03:26.433

您不需要向 B 添加行计数器，无论如何您都没有进行并排合并。

我认为这可行（我将 Aa 重命名为 A）：

```
proc sql;
create table C as
select _A.date, _A.name, b.rate from (
    select date, name, max(b_date) as b_date from (
        select a.*, b.rate, b.date as b_date from a
        left join b
        on a.name = b.name
           and a.date gt b.date)
    group by name, date) _A 
    left join b
    on _A.name=b.name
    and _A.b_Date=b.date;
quit; 
```

基本概念是首先构造您的笛卡尔连接，即连接所有可能的行，其中 A.date > B.date，然后根据日期差异最小的行向下过滤，以确定哪一行/日期具有您需要的评分。然后连接回 B 表以获取速率本身。

# objective-c - 如何从两个数组填充表格视图内容？

> ID：15235530
> 
> 赞同：0
> 
> 时间：2013-03-05T22:38:53.477
> 
> 标签：objective-c, c, uitableview, nsmutablearray, nsarray

我正在寻找一种方法来使用来自两个独立（但并行）数组的图像和文本填充表格视图。我一直在尝试从用所有可能的内容实例化的两个可变数组开始，检查模型对象的内容，删除“空白”条目，并将剩下的内容复制到填充表格视图单元格的表格视图属性中。

（`person`从中`profileList`获取初始值的对象是传入的模型对象。）

```
 NSMutableArray *profileList = [@[person.facebook, person.twitter, person.pinterest, person.linkedIn, person.youTube, person.googlePlus, person.flickr] mutableCopy];
    NSMutableArray *buttonList = [@[@"btn-Facebook.png", @"btn-Twittter.png", @"btn-Pinterest.png", @"btn-LinkedIn.png", @"btn-YouTube.png", @"btn-Google+.png", @"btn-Flickr.png"] mutableCopy];
    NSMutableArray *indicesToRemove = [@[] mutableCopy];

    //    for (NSString *index in profileList) {
    //
    //    }
    int i = 0;
    for (NSString *indexContents in profileList) {
        if ([indexContents isEqual: @""]) {
        // [indicesToRemove addObject:[NSString stringWithFormat:@"%d", i]];
            [indicesToRemove addObject:indexContents];
        }
        i++;
    }
    for (NSString *count in indicesToRemove) {
        // [profileList removeObjectAtIndex:[count integerValue]];
        [profileList removeObject:count];
        // [buttonList removeObjectAtIndex:[count integerValue]];
    }

    self.socialMediaProfilesList = (NSArray *)profileList;
    self.socialMediaButtonsList = (NSArray *)buttonList; 
```

这适用于`profileList`但不适用于`buttonList`. （因为后来， in `tableView:cellForRowAtIndexPath:`，`cell.textLabel.text`设置好但`cell.imageView.image`抛出异常。）

正如您可能从注释掉的行中可以看出的那样，我尝试重构此方法以跟踪索引而不是内容，但是我什至无法加载表。

似乎我正在以错误的方式解决这一切，但我想不出更好的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:51:21.810

Ok, pointers :)

*   instead of using fast-enumeration, use a plain for-loop (for (int i=0; i < COUNT; i++))
*   store all indexes in a `NSMutableIndexSet`
*   use `removeObjectsAtIndexes:` to clear out all objects, by calling it on both arrays

**edit**: Or, alternatively, reverse the order of the for-loop ( int=COUNT-1; i >=0; i-- ) and remove the objects from the arrays directly.

# jboss7.x - Jboss AS 7.1 中的 Resteasy 客户端抛出 java.lang.ClassNotFoundException: com.sun.ws.rs.ext.RuntimeDelegateImpl

> ID：15235531
> 
> 赞同：3
> 
> 时间：2013-03-05T22:38:53.960
> 
> 标签：jboss7.x, webservice-client, resteasy

我有一个 RestEasyClient 初始化如下并使用 Jboss AS 7.1 resteasy 模块

```
@PostConstruct
public void initializeClient() {

    log.info("In initializeClient");
    HttpClient httpClient = new DefaultHttpClient();
    ClientExecutor executor = new ApacheHttpClient4Executor(httpClient);
    ResteasyProviderFactory.getInstance().registerProvider(
            ServiceExecutionInterceptor.class);
    clientService = ProxyFactory.create(MyProjectClientService.class,
            getWebserviceURL(), executor);
} 
```

这会在服务器启动期间引发以下错误

```
Caused by: java.lang.ClassNotFoundException: com.sun.ws.rs.ext.RuntimeDelegateImpl from [Module "javax.ws.rs.api:main" from local module loader @5ad557c2 (roots: C:\Program Files\jboss-eap-6.0\modules)]
    at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:190)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassUnchecked(ConcurrentClassLoader.java:468)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:456)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:423)
    at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:398)
    at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:120)
    at java.lang.Class.forName0(Native Method) [rt.jar:1.6.0_32]
    at java.lang.Class.forName(Class.java:169) [rt.jar:1.6.0_32]
    at javax.ws.rs.ext.FactoryFinder.newInstance(FactoryFinder.java:77)
    at javax.ws.rs.ext.FactoryFinder.find(FactoryFinder.java:201)
    at javax.ws.rs.ext.RuntimeDelegate.findDelegate(RuntimeDelegate.java:113) 
```

我的 pom.xml 如下

Pom.xml

```
 <!-- Import the JAX-RS API, we use provided scope as the API is included 
        in JBoss AS 7 -->
    <dependency>
        <groupId>org.jboss.spec.javax.ws.rs</groupId>
        <artifactId>jboss-jaxrs-api_1.1_spec</artifactId>
        <scope>provided</scope>
    </dependency>

    <!-- Resteasy Dependencies -->
    <dependency>
        <groupId>org.jboss.resteasy</groupId>
        <artifactId>resteasy-jaxrs</artifactId>
        <version>${resteasy.version}</version>
        <scope>provided</scope>
        <exclusions>
            <exclusion>
                <groupId>commons-httpclient</groupId>
                <artifactId>commons-httpclient</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.servlet</groupId>
                <artifactId>servlet-api</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.xml.bind</groupId>
                <artifactId>jaxb-api</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.xml.bind</groupId>
                <artifactId>jaxb-impl</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>org.jboss.resteasy</groupId>
        <artifactId>resteasy-jaxb-provider</artifactId>
        <version>${resteasy.version}</version>
        <scope>provided</scope>
        <exclusions>
            <exclusion>
                <groupId>javax.xml.bind</groupId>
                <artifactId>jaxb-api</artifactId>
            </exclusion>
            <exclusion>
                <groupId>com.sun.xml.bind</groupId>
                <artifactId>jaxb-impl</artifactId>
            </exclusion>
            <exclusion>
                <groupId>javax.xml.stream</groupId>
                <artifactId>stax-api</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>org.jboss.resteasy</groupId>
        <artifactId>resteasy-jackson-provider</artifactId>
        <version>${resteasy.version}</version>
        <scope>provided</scope>
        <exclusions>
            <exclusion>
                <groupId>javax.servlet</groupId>
                <artifactId>servlet-api</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.7.2</version>
    </dependency>
            <build>
                <plugins>
        <plugin>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.1.1</version>
            <configuration>
                <!-- Java EE 6 doesn't require web.xml, Maven needs to catch up! -->
                <failOnMissingWebXml>false</failOnMissingWebXml>
                <archive>
                    <manifestEntries>
                        <Dependencies>org.jboss.resteasy.resteasy-jaxrs,
                            org.jboss.resteasy.resteasy-jaxb-provider,
                            org.jboss.resteasy.resteasy-jackson-provider,
                            org.apache.httpcomponents</Dependencies>
                        <version>${project.version}</version>
                    </manifestEntries>
                </archive>
            </configuration>
        </plugin> 
```

请帮助我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T20:40:33.543

我通过在我的战争中使用 jboss-deployment-structure.xml 解决了这个问题，它需要放在 WEB_INF 文件夹中。

```
<?xml version="1.0" encoding="UTF-8"?>
<jboss-deployment-structure>  
  <deployment>
    <dependencies>
      <module name="org.jboss.resteasy.resteasy-jaxrs" services="export" export="true"/>
      <module name="org.jboss.resteasy.resteasy-jaxb-provider" />
      <module name="org.jboss.resteasy.resteasy-jackson-provider" />
      <module name="org.codehaus.jackson.jackson-core-asl"/>
      <module name="org.apache.httpcomponents" services="export" export="true"/>
    </dependencies>
  </deployment>
</jboss-deployment-structure> 
```

还有2种其他方式

1）在 META-INF 文件中添加依赖项，如下所示

```
Dependencies: org.jboss.resteasy.resteasy-jaxrs export services,org.jboss.resteasy.resteasy-jaxb-provider, org.jboss.resteasy.resteasyjackson-provider,org.apache.httpcomponents export services 
```

2) 在配置文件 domain.xml/standalone.xml 中声明它们为全局模块

```
<subsystem xmlns="urn:jboss:domain:ee:1.1">  
<global-modules>  
<module name="org.jboss.resteasy.resteasy-jaxrs" slot="main" /> 
<module name="org.jboss.resteasy.resteasy-jaxb-provider" slot="main" /> 
<module name="org.jboss.resteasy.resteasy-jackson-provider" slot="main" /> 
<module name="org.apache.httpcomponents" slot="main" /> 
<module name="org.codehaus.jackson.jackson-core-asl" slot="main" />  
</global-modules> 
```

# java - 平方数数学方法不起作用（默认构造函数无法处理异常类型）

> ID：15235535
> 
> 赞同：1
> 
> 时间：2013-03-05T22:39:11.177
> 
> 标签：java

我的程序的目标是要求用户输入一个数字，然后使用创建的自定义方法对该数字求平方并输出平方。但是，在尝试此操作时出现了问题。请注意，这是我第一个使用用户输入方法的程序（完全是初学者）

错误代码

> 错误：默认构造函数无法处理 `java.io.IOException`隐式超级构造函数抛出的异常类型。必须定义显式构造函数

代码：

```
import java.io.*;

public class Squareit 
{
    BufferedReader myInput=new BufferedReader(new InputStreamReader(System.in));
    {
        String input;
        int num;
        System.out.println("1-12");
        input = myInput.readLine();
        num = Integer.parseInt(input);
    }

    public void square(int num) 
    {
        int ans = (num * num);
        System.out.println(" is" + ans);
    }

    public static void main(String[] args) throws IOException 
    {
        Squareit t = new Squareit();
        t.square(0);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T22:46:18.907

将整个块移动到构造函数中，而不是作为隐式超级构造函数。

```
private int num;
public SquareIt() throws IOException, NumberFormatException {
  BufferedReader myInput=new BufferedReader (new InputStreamReader (System.in));
  String input;
  System.out.println("1-12");
  input = myInput.readLine();
  num = Integer.parseInt (input);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T22:47:35.347

初始化代码是问题所在。

```
BufferedReader myInput = new BufferedReader (new InputStreamReader (System.in));
{ 
    String input;
    int num;
    System.out.println("1-12");
    input = myInput.readLine();
    num = Integer.parseInt (input);
} 
```

您应该创建一个构造函数。

```
class SquareIt {
    BufferedReader myInput;
    String input;
    int num;
    public SquareIt() throws IOException, NumberFormatException {
        myInput = new BufferedReader (new InputStreamReader (System.in));
        System.out.println("1-12");
        input = myInput.readLine();
        num = Integer.parseInt (input);
    } .... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T22:48:32.417

您正在构造一个 BufferedReader 并在构造函数之外读取它，这可能会引发 IOException。因此，您必须通过将此指令放入构造函数并在其 throws 子句中声明异常来处理此异常：

```
BufferedReader myInput;

public SquareIt() throws IOExcption {
    myInput = new BufferedReader (new InputStreamReader (System.in));
    String input;
    int num;
    System.out.println("1-12");
    input = myInput.readLine();
    num = Integer.parseInt (input);
} 
```

请注意，仅在需要时声明变量并立即初始化它是一个好习惯：

```
public SquareIt() throws IOExcption {
    myInput = new BufferedReader(new InputStreamReader(System.in));
    System.out.println("1-12");
    String input = myInput.readLine();
    int num = Integer.parseInt (input);
} 
```

# php - 重定向不停止重新提交？

> ID：15235536
> 
> 赞同：0
> 
> 时间：2013-03-05T22:39:18.460
> 
> 标签：php, post-redirect-get

# PHP

```
 $thisfile=$_SERVER["REQUEST_URI"];

    if(isset($_POST['comment'])&&!empty($_POST['comment'])){
    if($id!=0){
    $comment=$_POST['comment'];

    if ($comment_query=mysql_query("INSERT INTO `photosite`.`comments` VALUES ('$id', '', '$firstname', '$surname', '$photo_id', '$comment', '$time')")){

    header('Location: photopage.php?photo_id='.$photo_id.'', true, 303);
    exit;

    }else {
    echo 'Could not add comment';
    }
    }else {
    echo'Please Log In to add a Comment';
    }
    } 
```

我不明白为什么我的

```
header('Location: photopage.php?photo_id='.$photo_id.'', true, 303);
    exit; 
```

还在等待用户重新提交数据吗？这链接到同一页面，因为它用于添加评论，因此当用户添加评论时，页面会刷新到同一页面。但是如果再次刷新，内容会重新提交，知道为什么吗？

更新：在同一个文档中的所有这些代码之前，我**确实有一些东西回显。**那是问题吗？

好的，我将表单操作更改为要处理的另一个页面。有以前的东西输出到页面，这是问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:44:00.343

Try

```
...
header('Location: /photopage.php?photo_id='.$photo_id.'', true, 303);
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:55:48.383

```
 header('Location: photopage.php?photo_id='.$photo_id.'&added='.time());
    exit; 
```

应该管用。您提供的代码也应该可以工作。header->location 删除了 POST 内容，因此如果您之后刷新页面，则不应重新提交。

按 BACK 按钮是另一回事，您无法解决这个问题，除非您为每个表单请求使用唯一令牌。

例子：

```
 //check if the token in the session matches the token in the post
 if( isset( $_POST['token'], $_SESSION['token']) 
     && $_SESSION['token'] == $_POST['token'] ){
    //handle your post data
     [...]
 }

 //set the token
 $_SESSION['token'] = sha1(time().mt_rand());

 //process your form
 ?>
 [...]
 <input type='hidden' name='token' value='<?php echo $_SESSION["token"];?>'/>
 [...] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:07:52.233

好的，看来我已经找到了您的问题.. 我认为您的错误报告已关闭，因此您看不到有关标头的警告，“无法修改标头信息 - 标头已发送...”。
您不能发送标头或修改它们，因为已发送，因此您必须打开缓冲。`ob_start()`在您的代码顶部使用。它必须看起来像这样

```
<?php
ob_start();
.. 
```

之前不要使用任何空格`<?php`。

并从您的标头函数中删除参数 true, 303..

```
header('Location: photopage.php?photo_id='.$photo_id);
exit(); 
```

[http://www.php.net/manual/en/function.ob-start.php](http://www.php.net/manual/en/function.ob-start.php)

# php - 对象值神秘地改变了

> ID：15235537
> 
> 赞同：0
> 
> 时间：2013-03-05T22:39:26.293
> 
> 标签：php, laravel

我正在使用 Laravel 框架从 MySQL 数据库中查询一些数据。我不会发布整个查询，因为它很长。

```
$logs = DB::query('SELECT ... FROM .. JOIN ... WHERE .. GROUP BY .. ORDER BY'); 
```

我正在使用简单的 foreach 循环遍历结果并使用 PHPExcel 生成报告，如下所示：

```
foreach($logs as $log):
 ...
endforeach; 
```

在循环内部，我正在计算月份中两个日期之间的差异，如下所示：

```
$cntr_startdate = new DateTime($log->start_date);
$cntr_enddate = new DateTime($log->end_date);                   
$conterm = $cntr_enddate->diff($cntr_startdate);
$cterm = (($conterm->format('%y') * 12) + $conterm->format('%m')); 
```

在下一行之后，$log 对象中的 rate 字段以某种方式损坏并返回像 b、X 和 O.5 之类的垃圾（其余字段保持不变）。

```
$cterm = (($conterm->format('%y') * 12) + $conterm->format('%m')); 
```

什么可能导致数据丢失？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:48:59.450

尝试使用 MySQL TIMESTAMPDIFF 函数，让 MySQL 为您进行计算。无论如何，我认为这会更有效率。

# javascript - JSDoc 3 命名空间问题

> ID：15235542
> 
> 赞同：1
> 
> 时间：2013-03-05T22:39:47.057
> 
> 标签：javascript, jsdoc

这段代码

```
/**
 * * My namespace
 *
 * @namespace
 *
 * @type {Object}
 */
myNamespace = {

};

/**
 * My constructor
 *
 * @constructor
 */
myNamespace.MyConstructor = function () {

};

/**
 * My static class function
 *
 */
myNamespace.MyConstructor.myStaticFunction = function () {

}; 
```

编译并给了我一个不错的 html 文件。但是，`myConstructor`语法将显示为`new MyConstrutor()`而不是 right `new myNamespace.MyConstructor()`。

如果我将评论更改`MyConstructor`为

```
/**
 * My constructor
 *
 * @constructor
 * @memberOf {myNamespace}
 */
myNamespace.MyConstructor = function () {

}; 
```

然后我得到了预期的结果`new myNamespace.MyConstructor()`。然而，现在`myNamespace.MyConstructor.myStaticFunction`它甚至没有出现在文档中，无论我在 3 条评论中的任何一条中尝试了什么样的标签排列，它都不会产生我期望的方式。

我已经尝试让`myStaticFunction`成为`myNamespace`or `MyConstructor`or or的成员`myNamespace.MyConstructor`- 但它不会出现在任何地方的文档中。

我尝试使用旧的 jsdoc-toolkit 2.4 进行编译，没有任何问题，甚至不必使用任何 memberOf 表示法。这里真的很晚了，所以我希望一双新的眼睛可以帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-22T17:42:22.380

我认为应该是

```
* @memberOf myNamespace 
```

（没有大括号）

使用 JSDoc 3.3.0 *@memberOf {myNamespace}*会出错。

# android - 在服务中为 SCREEN_ON / SCREEN_OFF 注册广播接收器

> ID：15235543
> 
> 赞同：1
> 
> 时间：2013-03-05T22:39:50.513
> 
> 标签：android, android-intent, broadcastreceiver

有人可以确认我是否遵循了所需功能的正确设计吗？

当我的应用程序至少在设备上运行一次时，我需要通过广播接收器侦听两种类型的意图，而该设备无法在 AndroidManifest 中注册：

*   android.intent.action.SCREEN_ON
*   android.intent.action.SCREEN_OFF

出于这个原因，我创建了一个服务，它在我的 MainActivity 启动时启动。使用服务的方法`onStartCommand`，我注册了这些广播接收器......

接下来在这些广播接收器中，根据从 SharedPreferences 获取的标志完成一些事情，0（不做任何事情）或 1（做正确的逻辑）

我是否正确理解了服务的生命周期，它不会被 Android 停止/杀死（假设它不会导致任何设备干扰和过载），即使 MainActivity 将从内存/堆栈中删除并且意图将被监听？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:02:01.537

一些东西：

*   而是在服务中注册接收器，`onCreate()`因为此方法仅在创建服务时调用一次。如果您`startService()`多次调用，则会导致更多调用`onStartCommand()`，这意味着您不断地重新制作接收器。

> 请注意，对 Context.startService() 的多次调用不会嵌套（尽管它们确实会导致对 onStartCommand() 的多次相应调用），因此无论启动多少次服务都将停止一次 Context.stopService() 或 stopSelf （） 叫做;

*   确保取消注册您的接收器。我通常这样做`onDestroy()`

另外，关于您的生命周期问题 - 一个正常的服务不应该无缘无故地被杀死，并且应该独立于启动它的 Activity 运行（绑定的服务与我记得的有点不同）但它仍然在 UI 线程和相同的进程中运行（除非您另有说明）。但是，如果经过很长时间并且您的服务不在前台。它有被杀死的可能性。这就是为什么你应该做`onStartCommand()`return `START_STICKY`。如果系统确实杀死了服务，当它可以时，它会重新启动它。如果您的服务在前台，它也可能会被杀死，但这是最后的手段。`START_STICKY`如果您的服务容易出错，可能会很糟糕。例如，我的服务不断崩溃。`START_STICKY`让它在一段时间后重新启动，然后再次崩溃，循环重复。

在正常情况下，您的服务不会被杀死的唯一情况是：

> 如果服务当前正在其 onCreate()、onStartCommand() 或 onDestroy() 方法中执行代码，则托管进程将是前台进程，以确保此代码可以在不被杀死的情况下执行。

# c# - C# 中的 Arduino 数字引脚映射

> ID：15235546
> 
> 赞同：1
> 
> 时间：2013-03-05T22:40:01.863
> 
> 标签：c#, arduino

我正在编写一个将与 Arduino Mega 2560 交互的 C# 应用程序。但我对使用 Arduino 的开发板还是很陌生。

所以我的问题是可以在 C# 应用程序中映射引脚以监视我的数字输入的状态。

例子：

我像这样制作Arduino设置

```
pinMode(22, INPUT)
(...)
pinMode(53, INPUT) 
```

然后在 C# 中，我可以读取特定的引脚以获取其状态。像这样的东西：

```
serialPort1.Read("pin44"); //and with that read I can see if its in HIGH or LOW. 
```

或者

```
private void serialPort1_DataReceived(object sender, SerialDataReceivedEventArgs e)
{
int pinNumber = serialPort1.**ReadPinNumber()**; //I would store the number of which pin is generating the data and do something with it.
} 
```

我不知道我是否足够清楚，但我需要的是不断地从 arduino 接收数据并知道来自哪个引脚，所以我可以根据我的需要做一些事情。

我已经成功了第一部分。我可以接收数据并对其进行处理。但是当涉及到多个引脚时，这是一个棘手的部分。

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T03:31:52.240

不确定你是否能做到这一点，但你能在 Arduino 中做这样的事情吗：

```
int pin7val = 0;     // variable to store the read value

void setup()
{
  Serial.begin(9600);
  pinMode(7, INPUT);      // sets the digital pin 7 as input
}

void loop()
{  
  pin7val = digitalRead(7);   // read the input pin 7
  Serial.write(pin7val + " Pin44");
} 
```

然后在视觉工作室做一些简单的事情，比如

```
string Serial = serialPort1.ReadLine();

if (Serial contains "44")
{
int pin44val = Serial();
} 
```

C# 语法可能并不完全正确，但您明白了。

# sql - 将 concat sql 替换为时间格式

> ID：15235550
> 
> 赞同：0
> 
> 时间：2013-03-05T22:40:11.313
> 
> 标签：sql, peoplesoft

现在我有两个领域：

```
MEETING_TIME_START  |    MEETING_TIME_END
--------------------+--------------------
 9:30:00.000000AM   |   10:50:00.000000AM
11:00:00.000000AM   |   12:20:00.000000PM
11:00:00.000000AM   |   12:20:00.000000PM
10:00:00.000000AM   |   10:50:00.000000AM 
```

我有一个标准来创建一个新字段并重新格式化时间：

```
(SUBSTR((D.MEETING_TIME_START),1,5)%concat '- ' %concat SUBSTR((D.MEETING_TIME_END),1,5)) 
```

结果如下：

```
NEW FIELD
------------
09.30- 10.50
11.00- 12.20
11.00- 12.20
10.00- 10.50 
```

我如何调整我的标准来创建这种格式：

```
PREFERRED OUTPUT
----------------
0930-1050
1100-1220
1100-1220
1000-1050 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:48:13.133

你能试试这个吗？

`(SUBSTR((D.MEETING_TIME_START),1,2) || SUBSTR((D.MEETING_TIME_START),4,2) || '-' || SUBSTR((D.MEETING_TIME_END),1,2) || SUBSTR((D.MEETING_TIME_START),4,2))`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:55:20.397

如果是 MySQL，我会试试这个：

```
CONCAT(SUBSTR(D.MEETING_TIME_START,1,2),SUBSTR(D.MEETING_TIME_START,4,2),'-',SUBSTR(D.MEETING_TIME_END,1,2), SUBSTR(D.MEETING_TIME_END,4,2)) 
```

# jquery - Twitter Bootstrap 下拉触发表单提交（搜索）

> ID：15235554
> 
> 赞同：4
> 
> 时间：2013-03-05T22:40:25.190
> 
> 标签：jquery, twitter-bootstrap

```
<div class="btn-toolbar search-dropdown" style="float:left;margin-right:10px;">
    <div class="btn-group">
        <button class="btn btn-small">All Types</button>
        <button data-toggle="dropdown" class="btn btn-small dropdown-toggle"><span class="caret"></span>
        </button>
        <ul class="dropdown-menu" id="search-type">
            <li>
                <label class="checkbox">
                    <input type="checkbox" name="tv" value="TV">TV</input></label>
            </li>
            <li>
                <label class="checkbox">
                    <input type="checkbox" name="movies" value="Movies">Movies</input></label>
            </li>
        </ul>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-05T23:33:01.237

这是因为`<button>`元素默认提交自己的表单——它们继承了该`type="submit"`属性。

如果您不希望他们这样做，请添加属性`type="button"`，这样它将成为普通按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:15:50.757

如果您不想在单击复选框时关闭下拉框，那么您可以这样做：

```
jQuery(document).ready(function($){

    $('input[type="checkbox"]').on('click',function(event){
        event.stopPropagation();

    });

}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:34:28.817

为下拉切换使用一个`<a>`元素，而不是。`<button>`唯一的缺点是如果混合使用不同的类型，渲染中可能会出现不一致。如果您对此感到担心，请将提交按钮切换为`<a>`也，并使用 javascript onclick 提交表单。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T23:40:33.310

```
<div class="btn-toolbar search-dropdown" style="float:left;margin-right:10px;">
<div class="btn-group">
    <button class="btn btn-small">All Types</button>
    <button data-toggle="dropdown" class="btn btn-small dropdown-toggle"><span class="caret"></span>
    </button>
    <ul class="dropdown-menu" id="search-type">
        <li>
            <label class="checkbox">
                <input type="checkbox" name="tv" value="TV" onclick="search()">TV</input></label>
        </li>
        <li>
            <label class="checkbox">
                <input type="checkbox" name="movies" value="Movies" onclick="search()">Movies</input></label>
        </li>
    </ul>
</div> 
```

# python - 从内部python访问外部类

> ID：15235555
> 
> 赞同：0
> 
> 时间：2013-03-05T22:40:30.433
> 
> 标签：python, class, outer-join

考虑这段代码：

```
class Page(object):
  def __init__(self, name, title):
    self.name   = name
    self.title  = title
    self.selected = False
  def select(self):                 <-- How can I make this method work?
    for Page in Pages:
        Page.selected = False
    self.selected = True
class Website(object):
  def __init__(self):
    self.index    = Page("index", "Home")
    self.settings = Page("settings", "Settings")
    self.users    = Page("users", "Users")
    self.logs     = Page("logs", "Logs")
    self.faq      = Page("faq", "FAQ")
  def __iter__(self):
    return iter([self.index, self.settings, self.users, self.logs, self.faq])
Pages = Website() 
```

我正在尝试做的事情似乎是非法的。不过，我确信有办法做到这一点。看来我可能不得不在某处重写**get方法。**非常感谢您的帮助！

这是我打算使用 Bottlepy 使用这些类的方式：

设置页面：

```
@route('/')
@route('/<selectedPage>')
@route('/<selectedPage>/')
def dynamic_routing(selectedPage='index'):
  for Page in Pages:
     if selectedPage == Page.name:
            Page.select()
  return template('default') 
```

检索页面信息（在 Bottlepy 模板内）：

```
%for Page in Pages:
    %if Page.selected:
        <title>{{Page.title}}</title>                
    %else:
        <title>Page Not Found</title>
    %end
%end 
```

我现在将代码编辑为工作版本。谢谢大家这么快的输入！！！你们真棒！仍然可能不是最好的方法，但我现在想不出另一种方法来解决它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:44:52.010

store a ref to the `pageset` and then loop through the pages in that set

```
class Page(object):
  def __init__(self, name, title, pageset):
    self.name   = name
    self.title  = title
    self.pageset = pageset
  def select(self):
    for page in self.pageset.pages:
        page.select = False
    self.select = True

class Pageset(object):
  def __init__(self):
    self.index    = Page("index", "Home", self )
    self.settings    = Page("settings", "Settings", self )
    self.pages = [ self.index , self.settings , ] 
```

Note that this gives you the ability to have multiple Pagesets , and you're looking at the class instances. Your code above is referencing the classes themselves ( which there's really no reason to do ). i put `self.pages` as an attribute, because you might want to store other data in a pageset .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:45:15.567

You need to rename the `.select` attribute or the `.select()` method, and add a `self` parameter to the method, but otherwise your code will work:

```
class Page(object):
    def __init__(self, name, title):
        self.name   = name
        self.title  = title
        self.selected = False

    def select(self):
        for Page in Pages:
            Page.selected = False
        self.selected = True 
```

With those changes, your code works:

```
>>> Pages = Pages()
>>> Pages.index
<__main__.Page object at 0x10a0b6cd0>
>>> Pages.index.selected
False
>>> Pages.index.select()
>>> Pages.index.selected
True
>>> Pages.faq.select()
>>> Pages.index.selected
False 
```

However, that is not to say that this is a good architecture design. I'd say you need to move the responsibility to select a page to the `Pages` class instead, an most of all avoid replacing the class `Pages` with a global instance `Pages`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:47:04.367

我认为这里最好的解决方案是将您的`select()`方法移至`Pages`类：

```
class Pages(object):
    ...
    def select(self, target):
        for page in self:
           page.select = False
        target.select = True 
```

对我来说，这似乎是一个更合乎逻辑的位置，这意味着`Page`实例不需要知道`Pages`它们所属的实例。

`selected`在保存所选页面的实例上简单地具有一个属性甚至可能更好`Pages`，而不是每个人都`Page`知道它是否被选中，但这取决于设计。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:49:23.440

Pages 对象管理多个单独的 Page 对象。它应该负责将它们全部作为一个集合涉及的事情，例如，在您的示例中，将单个页面标记为选中并取消标记其他页面。

虽然您可能使每个 Page 都知道拥有它的 Pages 对象，但这样做过多可能会很快导致混乱的意大利面条代码。

PS - 尝试想出一些更好的名字，甚至谈论拥有**Page** -s 和**Pages**是不舒服的。

# ios - 相机设置逻辑 iOS

> ID：15235558
> 
> 赞同：2
> 
> 时间：2013-03-05T22:40:53.607
> 
> 标签：ios, camera, avfoundation, avcapturesession, avcapturedevice

尽管我已经多次搜索 SO 并阅读文档`AVCaptureConnection`， `AVCaptureSession`但 我仍然对所有这些 AV 内容感到困惑`AVCaptureVideoPreviewLayer`。说到这个，对我来说就是一大堆抽象的词，没有多大意义。我要求在这里为我阐明这个主题。`AVCaptureDevice``AVCaptureInput/Output`

那么，任何人都可以用*简单的英语*连贯地解释正确设置和使用媒体设备的逻辑吗？什么是 AVCaptureVideoPreviewLayer？什么是 AVCaptureConnection？输入输出？

我想了解制作这些东西的人在制作它时的基本想法。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:03:59.140

我希望我有更多的时间来写一个更彻底的答复。以下是一些简化的基础知识：

为了处理来自硬件、发往屏幕或文件的音频和视频，您需要使用 AVCaptureConnections 设置帮助协调源和目标的 AVCaptureSession。您可以使用会话实例来启动和停止进程，同时设置一些输出属性，例如比特率和质量。您使用 AVCaptureConnection 实例来控制 AVCaptureInputPort 和 AVCaptureOutputPort（或 AVCaptureVideoPreviewLayer）之间的连接，例如监视声音的输入电平或设置视频的方向。

AVCaptureInputPort 是来自 AVCaptureDevice 的不同输入 - 这是您的视频或音频的来源，例如相机或麦克风。您通常会浏览所有可用设备并选择具有您正在寻找的属性的设备，例如它们是音频还是前置摄像头。

AVCaptureOutput 是发送 AV 的地方 - 它可能是一个文件或一个例程，允许您实时处理数据等。

AVCaptureVideoPreviewLayer 是一个 OpenGL 层，经过优化，可以非常快速地渲染所选视频输入设备（前置或后置摄像头）的输出。您通常使用它来向您的用户显示您正在使用的输入 - 有点像相机取景器。

如果你打算使用这些东西，那么你必须阅读 Apple 的[AV Foundation Programming Guide](http://developer.apple.com/library/mac/#documentation/AudioVideo/Conceptual/AVFoundationPG/Articles/04_MediaCapture.html "AV 基础编程指南")

这是一张可能对您有更多帮助的图片（来自上述文档）： ![在此处输入图像描述](../Images/59e718990ef4e4735092440eb5eacf99.png)

更详细的视图：![在此处输入图像描述](../Images/f5faa5da94f9d678bf250463f4a6df8b.png)

# php - 警告：mysqli_num_rows()：提供的参数不是有效的 MySQL 结果

> ID：15235561
> 
> 赞同：-1
> 
> 时间：2013-03-05T22:41:01.353
> 
> 标签：php, mysqli, mysql-num-rows, procedural

编码：

```
 $stmt = mysqli_prepare($link, "SELECT * FROM adm_users WHERE users_username = ? AND users_password = ?");
  mysqli_stmt_bind_param($stmt, 'ss', $user_adm_name, $user_adm_password);
  mysqli_stmt_execute($stmt);
  mysqli_stmt_store_result($stmt);
  mysqli_stmt_fetch($stmt);
  $adm_check_log = mysqli_num_rows($stmt);
  mysqli_stmt_close($stmt); 
```

返回：

> 警告：mysqli_num_rows()：提供的参数不是有效的 MySQL 结果

为什么？有人可以为我解释吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:43:38.873

You should check the return values of your functions!

(As a programmer do this in every situation when you encounter an error)

Seems that something is going wrong with the query. So change the code to something like:

```
$result = mysqli_query(...);

if(!$result) {
    die(mysqli_error($link);
} 
```

Do the same with all of the mysqli functions that you are using.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:44:30.167

That simply means that the value for $stmt that is being passed in here:

```
$adm_check_log = mysqli_num_rows($stmt); 
```

isn't of the correct type. Usually it indicates that you either didn't return anything from your query or there was an error with it.

Try outputting it to see what you get:

```
var_dump($stmt); 
```

* * *

Replace what you have with this. What error is reported?

```
if($stmt = mysqli_prepare($link, "SELECT * FROM adm_users WHERE users_username = ? AND users_password = ?")) {
  $stmt->bind_param("ss", $user_adm_name, $user_adm_password);
  $stmt->execute();
  printf("Error: %d.\n", $stmt->error);
  $stmt->bind_result($foo);
  $stmt->fetch();
  var_dump($foo);
  $stmt->close();
} 
```

# ember.js - Ember.Data 重新加载内容，UI 未更新

> ID：15235574
> 
> 赞同：2
> 
> 时间：2013-03-05T22:42:15.350
> 
> 标签：ember.js, ember-data

我们使用的是 Ember.Data rev 11。我们的关系是这样的：

```
Social.Account = DS.Model.extend({
    name: DS.attr("string"),
    username: DS.attr("string"),
    messages: DS.hasMany("Social.Message"),
});

Social.Message = DS.Model.extend({
    text: DS.attr("string"),
    created: DS.attr("date"),
    account: DS.belongsTo("Social.Account"),
    posts: DS.hasMany("Social.Post")
});

Social.Post = DS.Model.extend({
    text: DS.attr("string"),
    created: DS.attr("date"),
    message: DS.belongsTo("Social.Message"),
}); 
```

用户创建一条消息，然后可以将其发送到多个社交媒体帐户，每个帐户都会生成一个帖子。提交时会创建消息和帖子记录，但我们会在帖子记录中获取从 Twitter 返回的信息。我们当前使用的代码如下所示：

```
saveMessage: function(text){
    var acct = Social.Account.find(this.get("id")),
        msg = Social.store.createRecord(
                    Social.Message,
                    {
                        text: text,
                        account: acct,
                        created: new Date()
                    }
                );

    acct.get("messages").addObject(msg);
    Social.store.commit();

    msg.addObserver('id', this, function(){
        var timeoutID = window.setTimeout(function(){
            msg.reload();
            console.log('reloading');
        }, 5000);
    });

} 
```

一旦我点击提交消息和发布都加载到 UI 中。问题是 Post 缺少 native_url 属性，只有在向 Twitter 发出 http 请求后才能获取该属性。奇怪的是，如果我用警报窗口替换 addObserver 调用的内容，native_url 值就会弹出到位。我不确定为什么，但确实如此。

无论如何，所以我的问题是我必须做什么才能让 Post 对象使用来自服务器的数据进行更新，并使用该新数据更新 UI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T22:56:49.443

如果没有看到你们所有的代码，我不能保证这是解决方案。但是你应该做的一件事是不要依赖`setTimeout`Ember 回调。相反，请使用[Ember.run.later](http://emberjs.com/api/classes/Ember.run.html#method_later)。

```
Ember.run.later(this, function() {
    this.reload();
    console.log('reloading');
}, 5000); 
```

在 Ember 之外异步发生的任何事情都应该包装在 RunLoop 中。因此，如果您的回调是插件的一部分或其他类似的东西，您也可以将它全部包装在[Ember.run](http://emberjs.com/api/classes/Ember.run.html)中。

# python - 在 Google App Engine 上苦苦挣扎

> ID：15235575
> 
> 赞同：0
> 
> 时间：2013-03-05T22:42:22.400
> 
> 标签：python, django, google-app-engine

我正在为 Google App Engine 上的导入而苦苦挣扎。我有一个具有以下（标准）设置的 Django/Python 项目：

```
[myproject]
|
-[myproject]
|
--[app1]
|
--[app2] 
```

第二个`[myproject]`目录（我认为）被认为是项目根目录，并且与项目的顶级目录命名相同。这个结构是由 Django 的`startproject`命令创建的。

说，我有一个我想`MyClass`在其中使用的类。当我使用 GAE SDK 进行本地开发时，我可以：`app1.models``app2.models`

```
from app1.models import MyClass 
```

但是，当我部署到 Google App Engine 时，我需要将该导入改写为：

```
from myproject.app.models import MyClass 
```

否则，GAE 将找不到该类并因错误而中止。另外，在我的`settings.py`本地我可以指`INSTALLED_APPS`：

```
'app1',
'app2',
... 
```

对于 GAE，我需要做：

```
'myproject.app1',
'myproject.app2',
... 
```

对于本地发展，这两种方法都有效。部署到 GAE 时，只有使用完整路径名的方法有效。为什么是这样？？

--

**编辑：**

我尝试了 lucernia 提供的答案，但遇到了各种问题。主要的绊脚石是部署到 GAE 时，如果`app.yaml`不在尝试部署的结构的根目录中，它将无法运行。

我尝试了 Lipis 提到的答案，效果很好。我必须添加以下几行：

```
import sys
sys.path.insert(1, 'myproject') 
```

我`main.py`和`settings.py`. 仅仅添加它`main.py`是不够的。GAE 仍然无法找到我的应用程序。

我以为我很好地阅读了谷歌关于 GAE 的文档，但我要么一定错过了这一点，要么它被埋在某个地方......如果一个人想在 GAE 上运行 Django，这非常重要......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:56:40.923

我以前遇到过同样的问题。GAE 的根页面是您放置`app.yaml`.

因此，您可能将 app.yaml 放在父`myproject`文件夹中，但将 django 项目放在子`myproject`文件夹中。

在这种情况下，当开发服务器使用 django.py runserver 启动时，与使用 dev_appserver.py 和 GAE 运行时启动相比，它将具有不同的行为。

就我而言，我将 app.yaml 与 settings.py 和 wsgi.py、urls.py 放在同一个文件夹中。然后我可以毫无问题地导入我的模块。

```
 myproject
   - admin_system/
        - __init__.py
        - models.py
   - app.yaml
   - wsgi.py
   - urls.py
   - settings.py
   - manager.py 
```

在 settings.py

```
 INSTALLED_APPS = (
'django.contrib.auth',
'django.contrib.contenttypes',
'django.contrib.sessions',
'django.contrib.sites',
'django.contrib.messages',
'django.contrib.staticfiles',
# Uncomment the next line to enable the admin:
'django.contrib.admin',
# Uncomment the next line to enable admin documentation:
'django.contrib.admindocs',

'admin_system', 
```

)

在 wsgi.py

```
import os

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "settings") 
```

然后在开发和 GAE 运行时导入路径将是相同的。

`import admin_system.models`

# 编辑1

将 app.yaml 移动到内部 myproject 文件夹时，内部项目目录将成为 GAE 的工作目录。因此，如果您将 google app engine luncher 指向内部 myproject 文件夹，它应该可以正常工作。

或者为了更简单，您可以删除外部 myproject 文件夹并直接使用内部 myproject 文件夹。

```
[myproject]
|
-[app1]
|
-[app2]
|
-app.yaml
-urls.py
-wsgi.py
-settings.py
-manager.py 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-14T09:43:54.307

经过一番思考，我决定采用 Lipis 在评论中建议的解决方案。这解决了 Google App Engine 中的导入问题，同时允许我保留 Django 设置的默认项目结构`startproject`。

# asp.net - How do I use @reference like @PreviousPageType to reference multiple previous pages?

> ID：15235580
> 
> 赞同：0
> 
> 时间：2013-03-05T22:43:02.130
> 
> 标签：asp.net, cross-page-postback

In ASP.net I have two similar pages that display summary information. I would like to pull from these pages a property value to display detailed information about the selected record in a detail page. I was successful in doing it for just one summary page using the @PreviousPageType reference.

```
 <%@ PreviousPageType VirtualPath="~/SOURCE1.aspx" %> 
```

But It soon appeared that I needed another page as a feeder. Unfortunately from what I have read it seems that you cannot have multiple PreviousPageTypes

According to: [http://msdn.microsoft.com/en-us/library/ms178139%28v=vs.100%29.aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-6](http://msdn.microsoft.com/en-us/library/ms178139%28v=vs.100%29.aspx?cs-save-lang=1&cs-lang=csharp#code-snippet-6) I should be able to do something similar with reference:

```
 <%@ Reference VirtualPath="~/SOURCE1.aspx" %> 
```

I'm not sure how to cast the page though as I'm not sure what 'SourcePage_Aspx is in the code below which incidentally is from the link above.

```
 SourcePage_aspx sourcePage;
    sourcePage = (SourcePage_aspx) PreviousPage;
    Label1.Text = sourcePage.CurrentCity; 
```

I know that to use a reference you have to cast it but, how is this done? Could someone please point me in the correct direction?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T13:51:06.740

此页面包含答案！： http: [//www.codingwith.net/2008/01/using-previouspage-property-with.html](http://www.codingwith.net/2008/01/using-previouspage-property-with.html)

（如果您打算访问解决方案的另一个文件夹中的页面，请不要忘记您的 using 语句，但 intellesense 可能会为您生成它）

我的代码在这里：

```
 if (Page.PreviousPage != null && Page.PreviousPage.IsCrossPagePostBack == true)
                {
                    //make sure to define reference directive on .aspx : <%@ Reference Page="~/SourcePage1.aspx" %>
                    if (PreviousPage is SourcePage1)
                    {
                        ViewState["SessionVariable"] = ((SourcePage1)PreviousPage).PropertyFromPreviousPage1;
                    }
                    //make sure to define reference directive on .aspx : <%@ Reference Page="~/SourcePage2.aspx" %>
                    if (PreviousPage is SourcePage2)
                    {
                        ViewState["SessionVariable"] = ((SourcePage2)PreviousPage).PropertyFromPreviousPage2;
                    }

                } 
```

# php - Adding an where clause breaks the query?

> ID：15235581
> 
> 赞同：0
> 
> 时间：2013-03-05T22:43:02.790
> 
> 标签：php, mysql, sql

I have been trying to debug this for quite a while now with no success.

It seems that my mySQL query breaks as soon as I add a where clause to the below query.

Note this returns no results when it should:

```
SELECT * FROM `workorders` WHERE (`status`='Open') AND 
 `job_site_name` LIKE '%".$searchword."%'  ORDER BY `date_promised` ASC LIMIT 20 
```

This is the same query without the where clause and it returns results as expected, but I need the where `status=Open` as part of the query...

```
SELECT * FROM `workorders` WHERE 
 `job_site_name` LIKE '%".$searchword."%'  ORDER BY `date_promised` ASC LIMIT 20 
```

Furthermore, this works (and shows that the status column exists and works in other cases):

```
SELECT * FROM `workorders` WHERE (`status`='Open') AND `invoice_number` LIKE 
  '%".$searchword."%'  ORDER BY `date_promised` ASC LIMIT 20 
```

I appreciate any assistance in identifying the cause of this problem.

Many thanks in advance!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T22:56:37.517

问题似乎是两个标准都没有满足。如果您需要使用`OR`子句，那么您可以这样做

```
SELECT * 
FROM `workorders` 
WHERE (`status`='Open' 
   OR `job_site_name` LIKE '%".$searchword."%')
ORDER BY `date_promised` ASC 
LIMIT 20 
```

# jquery - Dragging on x-Axis in fullcalendar dayView

> ID：15235583
> 
> 赞同：0
> 
> 时间：2013-03-05T22:43:08.067
> 
> 标签：jquery, fullcalendar

i'm currently customizing a jQuery fullcalendar for my needs. In my calendar, i'm implementing the dayView. Every event has a property "room_id", which refers to a meeting in a specific room.

In weekView, Events can be dragged between days AND time, and this is quite the thing i need for dayView, where the different days correspond to a room_id.

I'm currently trying to understand the source, but 5000 lines are quite a lot :D

What i need to know is: How can i manage to drag events horizontally, like in weekView?

I appreciate any suggestions and solutions :)

# qt - Qt 5.0 Build Warning

> ID：15235584
> 
> 赞同：2
> 
> 时间：2013-03-05T22:43:16.223
> 
> 标签：qt, gcc, fedora

I have installed Qt 5.0 (the whole SDK) on Fedora 17\. I have configured the compiler (GCC) and everything seems to be working fine, except that when I press "Ctrl-R" for having a demo of my GUI coding, I get the following error :

```
make: Entering directory `/home/Nisarg/Documents/Qt Projects/untitled-build-Desktop_Qt_5_0_1_GCC_32bit-Debug'
g++ -Wl,-rpath,/opt/Qt/5.0.1/gcc -Wl,-rpath,/opt/Qt/5.0.1/gcc/lib -o untitled main.o mainwindow.o moc_mainwindow.o   -L/opt/Qt/5.0.1/gcc/lib -lQt5Widgets -lQt5Gui -lQt5Core -lGL -lpthread 
**/usr/bin/ld: cannot find -lGL**
make: Leaving directory `/home/Nisarg/Documents/Qt Projects/untitled-build-Desktop_Qt_5_0_1_GCC_32bit-Debug'
collect2: error: ld returned 1 exit status
make: *** [untitled] Error 1
04:07:17: The process "/usr/bin/make" exited with code 2.
Error while building/deploying project untitled (kit: Desktop Qt 5.0.1 GCC 32bit)
When executing step 'Make'. 
```

(The error above is that a file called -lGL is not found)

How do I go about solving this error ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T02:29:46.480

您需要安装 libGL 开发文件。自从我使用 Fedora 以来已经有一段时间了，但是请检查您的包管理器中是否有一个名为`mesa-libGL-devel`.

# javascript - 向 jQuery 滚动侧边栏添加动画

> ID：15235595
> 
> 赞同：0
> 
> 时间：2013-03-05T22:44:06.303
> 
> 标签：javascript, jquery

我在 jQuery 中使用滚动侧边栏功能，并想为过渡添加动画。如何编辑我的代码以在页面上上下滚动时应用动画来平滑过渡？

这是我的[小提琴](http://jsfiddle.net/cearnhart/4VbDN/5/)

这是我的js：

```
$(function() {

    var $blah   = $("#blah"), 
        $window    = $(window),
        offset     = $blah.offset();

  $window.scroll(function() {
        if ($window.scrollTop() > offset.top) {
   $blah.css('top','120px');
         } else {
   $blah.css('top','440px');
   }
    });

}); 
```

这是我的CSS：

```
#blah {
    display:none;
    top: 320px;
    right: 30px;
    position: fixed;
    margin: 0 20px 0 20px;
    padding: 0px !important;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:41:57.510

尝试使用`.stop().animate()`. `.stop()`我推荐使用before的原因`.animate()`是为了防止效果过度链接。基本上你会指示浏览器“当我滚动时放弃你现在正在做的事情”，然后“开始动画”。

```
$(function () {

    var $blah = $("#blah"),
        $window = $(window),
        offset = $blah.offset();

    $window.scroll(function () {
        if ($window.scrollTop() > offset.top) {
            $blah.stop().animate({
                top: 50
            });
        } else {
            $blah.stop().animate({
                top: 100
            });
        }
    });
}); 
```

在这里看小提琴 - [http://jsfiddle.net/4VbDN/6/](http://jsfiddle.net/4VbDN/6/)

[编辑]：您甚至可以调整动画的持续时间以及分配回调函数，即使`.animation()`被触发。有关更多说明，请查看[.animate() 的 jQuery API](http://api.jquery.com/animate/) :)

# cmd - CMD 似乎无法识别变量

> ID：15235596
> 
> 赞同：0
> 
> 时间：2013-03-05T22:44:09.030
> 
> 标签：cmd, set, session-variables

CMD 似乎没有识别我使用 SET 存储的任何变量。如果我运行这个批处理文件：

```
@ECHO off
SET /P name = What is your name? 
ECHO %name%
PAUSE
ECHO on 
```

我得到以下输出：

```
What is your name? steven
ECHO is off.
Press any key to continue . . . 
```

当我从命令提示符运行第 2 行然后第 3 行时，它只打印：

```
%name% 
```

我有什么配置不正确吗？我认为第 2 行应该创建一个应该在第 3 行中识别的会话变量是否正确？

我搜索了，但我只能找到与 IF 块中的变量扩展相关的答案。这发生在任何 IF/FOR/etc 块之外。

顺便说一下，这是 Windows 7。我不确定从一个版本的 Windows 到另一个版本的 cmd 有多少变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:58:51.213

`set`指令中等号周围不得有任何空格。改变这个

```
SET /P name = What is your name? 
```

进入这个

```
SET /P name=What is your name? 
```

你的问题就会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T09:52:19.643

因为我不能添加任何评论，所以我必须发布一个新的答案。资料：

“set 指令中等号周围不能有任何空格。”

只是部分正确。确切地说，它应该说：等号必须紧跟在变量名之后（在 sricks3 的情况下没有空格）。等号之后的任何内容都将用作变量的输入提示，包括任何空格，因此以下代码也可以正常工作：

```
SET /P name= What is your name? 
```

# jquery - 无法使用 jquery 更改背景图像

> ID：15235602
> 
> 赞同：0
> 
> 时间：2013-03-05T22:44:57.113
> 
> 标签：jquery, html, css

我有一个路径是资源/样式/test.css 的 css 文件和一个路径是资源/图像/字符的图像文件夹。关于使用以下类和 html

```
 .character
{
position:relative;
margin-top:-4.8%;
margin-left:85%;
height:51px;
width:51px;
background-color:#e3f4fd;
background-image:url(../images/characters/9.png);
background-position:center;
background-repeat:repeat-y;
} 
```

html:

```
 <div class="character" style="display:inline-block;">
</div> 
```

它向我显示了所需的图像，但我想使用 jquery 更改此背景图像，并在我的条件下编写以下 url

$('.character', this).css("background-image", "url(../images/characters/8.png)");

屏幕上什么都没有出现..

所以我想问一下 url 应该是什么，以便更改的图像显示在屏幕上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:50:07.660

假设 html 文件位于根目录下，请尝试

```
$('.character', this).css("background-image", "url(resources/images/characters/8.png)"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:47:16.610

我很确定问题出在您的 jQuery 选择器上，请尝试删除上下文参数：

```
$('.character', this) to $('.character') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:47:20.143

对于这种语法，您需要使用 camelCase 属性名称：

改变

```
$('.character', this).css("background-image", "url(../images/characters/8.png)"); 
```

到

```
$('.character', this).css("backgroundImage", "url(../images/characters/8.png)"); 
```

# java - 如何修复我的保存功能？

> ID：15235603
> 
> 赞同：-1
> 
> 时间：2013-03-05T22:45:00.977
> 
> 标签：java, android, file, save

我有一个文件列表，当单击文件时，它的内容会显示在 EditText 中。该文件设置为 currentFile。如果用户在保存旧文件之前尝试打开新文件，则会显示一个保存对话框。对话框上的 OK 按钮应该保存当前的工作文件，而是将其保存为用户试图打开的文件。我的代码中的问题在哪里导致当前文件被保存在试图打开的新文件之上。

```
public boolean exists;
        public File currentFile; 

@Override
        public void onCreate(Bundle icicle) {
                super.onCreate(icicle);
                setContentView(R.layout.main);
                et = (EditTextLineNumbers) findViewById(R.id.ide);
                getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN);
                File dir = new File(Environment.getExternalStorageDirectory() + "/My Webs");
                currentDirectory = dir;

                et.addTextChangedListener(new TextWatcher() {

                    @Override
                    public void onTextChanged(CharSequence s, int start, int before, int count) {

                    }

                    @Override
                    public void beforeTextChanged(CharSequence s, int start, int count,
                            int after) {
                        changed = false;
                    }

                    @Override
                    public void afterTextChanged(Editable s) {
                        changed=true;
                    }
                });
               changed=false;
                if(dir.isDirectory()) {
                    browseToRoot();
                }else{
                    dir.mkdir();
                }
        }

        private void openFile(File aFile){
            String nullChk = et.getText().toString();
            exists = true;
            currentFile = aFile;

        if(!changed || nullChk.matches("")){
             try {
                    et.setText(new Scanner(aFile).useDelimiter("\\Z").next());
                    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
                    e.printStackTrace();
                    }   
             }else{
                AlertDialog.Builder alert = new AlertDialog.Builder(this);

                alert.setTitle("Save first?");
                alert.setMessage("(Will be saved in the current working directory)");

                alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int whichButton) {
                 String temptxt = et.getText().toString();

                if(exists){
                    saveFile(currentFile.getPath(), temptxt);
                }else{
                    saveAs();
                }
                  }
                });
                final File tempFile = aFile;
                alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
                  public void onClick(DialogInterface dialog, int whichButton) {
                      try {
                            et.setText(new Scanner(tempFile).useDelimiter("\\Z").next());
                        } catch (FileNotFoundException e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    changed=false;
                  }
                });

                alert.show();
             }
        }

        private void saveFile(String sFileName, String sBody){
            //Toast.makeText(this, exists +"", Toast.LENGTH_SHORT).show();
            if (exists) {
                try {
                    File tempfile = new File(sFileName);
                    FileWriter writer = new FileWriter(tempfile);
                    writer.write(sBody);
                    writer.flush();
                    writer.close();
                    changed=false;
                    Toast.makeText(this, "Saved", Toast.LENGTH_SHORT).show();
                    return;
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }else{
                Toast.makeText(this, "Save as", Toast.LENGTH_SHORT).show();
                saveAs();
            }

        }

        private void saveAs(){
            AlertDialog.Builder alert = new AlertDialog.Builder(this);

            alert.setTitle("Save as");
            alert.setMessage("(Will be saved in the current working directory)");

            // Set an EditText view to get user input 
            final EditText input = new EditText(this);
            alert.setView(input);

            alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {
              String value = input.getText().toString();
              String tmpText = et.getText().toString();

              try {
                File tempfile = new File(currentDirectory, value);
                FileWriter writer = new FileWriter(tempfile);
                  writer.write(tmpText);
                  writer.flush();
                  writer.close();
                  changed=false; 
                  //itla.notifyDataSetChanged();
                  fill(currentDirectory.listFiles());
            } catch (IOException e) {
                // TODO Auto-generated catch block
            e.printStackTrace();
            }
              }
            });

            alert.setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
              public void onClick(DialogInterface dialog, int whichButton) {

          }
            });
            alert.show();
        }

        /**
         * This function browses up one level
         * according to the field: currentDirectory
         */
        private void upOneLevel(){
                if(this.currentDirectory.getParent() != null && !this.currentDirectory.getPath().equals("/sdcard/My Webs")){
                        this.browseTo(this.currentDirectory.getParentFile());
                }else{
                    //Do nothing
                }

        }

        private void browseTo(final File aDirectory){
                // On relative we display the full path in the title.
                if(this.displayMode == DISPLAYMODE.RELATIVE)
                        this.setTitle(aDirectory.getAbsolutePath() + " :: " +
                                        getString(R.string.app_name));
                if (aDirectory.isDirectory()){
                        this.currentDirectory = aDirectory;
                        fill(aDirectory.listFiles());
                }else{
                    openFile(aDirectory);
                    }
                changed=false;
                    }
        }

        @Override
        protected void onListItemClick(ListView l, View v, int position, long id) {
                super.onListItemClick(l, v, position, id);

                String selectedFileString = this.directoryEntries.get(position)
                                .getText();
                if (selectedFileString.equals(getString(R.string.current_dir))) {
                        // Refresh
                        this.browseTo(this.currentDirectory);
                } else if (selectedFileString.equals(getString(R.string.up_one_level))) {
                        this.upOneLevel();
                } else {
                        File clickedFile = null;
                        switch (this.displayMode) {
                                case RELATIVE:
                                        clickedFile = new File(this.currentDirectory
                                                        .getAbsolutePath()
                                                        + this.directoryEntries.get(position)
                                                                        .getText());
                                        break;
                                case ABSOLUTE:
                                        clickedFile = new File(this.directoryEntries.get(
                                                        position).getText());
                                        break;
                        }
                        if (clickedFile != null)
                            currentFile=clickedFile;
                                this.browseTo(clickedFile);
                }
        }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:14:35.093

第三行`openFile()`：`currentFile`在您有条件地询问用户是否要`currentFile`在打开新文件之前保存之前进行更改。`currentFile` *在您实际打开另一个文件时*更改，而不是之前更改，您甚至不会意外遇到此问题。

# asp.net-mvc-4 - ASP.NET MVC 4：一个控制器路由与其他控制器路由不同

> ID：15235604
> 
> 赞同：0
> 
> 时间：2013-03-05T22:45:03.083
> 
> 标签：asp.net-mvc-4, routing, controller

我已将一个新控制器“LoggingController”添加到已经有多个控制器的 MVC 4 应用程序中。现在我注意到这个控制器的路由行为与已经存在的不同。

例如，以下两个 url 按预期正常工作，并点击了 BlogController 中的“Index”方法。

```
http://localhost:56933/Blog/

http://localhost:56933/Blog/Index 
```

除了我添加的控制器之外，所有其他控制器也是如此：

`http://localhost:56933/Logging/Index`- 正常工作，点击 LoggingController 中的“Index”方法

`http://localhost:56933/Logging/`- 返回“'/' 应用程序中的服务器错误。找不到资源。”

除了显而易见的事情，我应该从哪里开始寻找？

这是来自 LoggingController 的索引签名

```
public ActionResult Index(int? page, string Period, string LoggerProviderName, string LogLevel, int? PageSize) 
```

MapRoute 中没有特定于某个控制器的内容。这是完整的 RouteConfig 供参考：

```
public static void RegisterRoutes(RouteCollection routes)
{
    routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

    routes.MapHttpRoute(
        name: "DefaultApi",
        routeTemplate: "api/{controller}/{id}",
        defaults: new { id = RouteParameter.Optional }
    );

    routes.MapRoute(
    name: "Display",
    url: "Post/{id}/{seofriendly}",
    defaults: new { controller = "Post", action = "Display", id = UrlParameter.Optional, seofriendly = ""}
        );

    routes.MapRoute(
        name: "SEOFriendly",
        url: "{controller}/{action}/{id}/{seofriendly}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional, seofriendly = "" }
    );

    routes.MapRoute(
        name: "SEOFriendlyNoId",
        url: "{controller}/{action}/{seofriendly}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional, seofriendly = "" }
    );

    routes.MapRoute(
        name: "Default",
        url: "{controller}/{action}/{id}",
        defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional }
    );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:53:01.233

您的 Index 方法实际上没有与您的任何可用路由匹配的签名。您必须为您的索引操作提供默认值，或者在路由表的开头添加一个额外的路由来指定这些默认值。例如：

```
routes.MapRoute(
    name: "LoggingDefaults",
    url: "Logging/{Period}/{LoggerProviderName}/{LogLevel}/{page}/{PageSize}",
    defaults: new {controller = "Logging", 
                   action = "Index",
                   page = UrlParameter.Optional,
                   PageSize = UrlParameter.Optional,
                   LoggerProviderName = "SomeProvider",
                   Period = "SomePeriod",
                   LogLevel = "SomeLevel"} 
```

# javascript - 使用 javascript 在窗口中添加地址栏

> ID：15235607
> 
> 赞同：1
> 
> 时间：2013-03-05T22:45:30.660
> 
> 标签：javascript, html, popupwindow

好的，所以我知道如何使用JS弹出一个新窗口，控制打开的窗口的大小，以及在没有地址栏或滚动控件的情况下显示它。

但是假设用户在我的网站上（我们称之为窗口 A），他们点击一个链接，现在他们打开了这个小窗口（我们称之为窗口 B），没有控件或地址栏。

现在我希望他们单击​​一个按钮，该按钮将执行以下两件事之一：

1.  它可以关闭窗口 B，然后在窗口 A 上转到由在窗口 B 上单击的按钮指定的新 URL。
2.  它可以调整窗口 B 的大小（我知道如何使用 javascript 操作调整大小）并添加回地址栏中和滚动的能力（这个，我不知道该怎么做）。

人们是否遵循我在这里尝试实现的目标？如果您需要更好的解释，请询问，我会帮助澄清。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:07:36.313

可以绑定`window.close()`到按钮事件，也可以`window.opener.location`用来改变窗口A的位置：

```
$('#button2').on('click', function () {
    window.opener.location = 'http://yoursite.com/';
    window.close();
}); 
```

JSFiddle： http: [//jsfiddle.net/eCTfF/1/](http://jsfiddle.net/eCTfF/1/) 编辑：要让它工作，你必须去[http://jsfiddle.net/eCTfF/1/show](http://jsfiddle.net/eCTfF/1/show) - 在 JSFiddle iframe 之外。

至于第 2 点，我需要澄清一下你的意思。

# c# - 解析 JSON 对象数组：“最佳重载方法匹配有一些无效参数”

> ID：15235610
> 
> 赞同：14
> 
> 时间：2013-03-05T22:45:37.393
> 
> 标签：c#, .net, json, json.net

我正在使用 JSON.net 来解析我从 PHP 脚本中获取的对象数据。

我能够让它解析数组并将其分解。然后，一旦我尝试解析该数组中的每个对象，我就会收到此错误：

```
Additional information: The best overloaded method match for 
'Newtonsoft.Json.JsonConvert.DeserializeObject(string)' 
has some invalid arguments 
```

这是给我错误的功能：

```
 public void updateSearches()
    {
        var bw = new BackgroundWorker();

        bw.DoWork += (send, args) =>
        {
            WebClient client = new WebClient();
            JSON = client.DownloadString("URL");
            dynObj = JsonConvert.DeserializeObject(JSON);
            foreach (var item in dynObj)
            {
                dynamic search = JsonConvert.DeserializeObject(item);
                foreach (var s in search)
                {
                    joined += string.Join(",", s) + "END OF THE LINE\r\n";
                }
            }
        };

        bw.RunWorkerCompleted += (send, args) =>
        {
            this.mainWindow.richTextBox2.Text += "Got Data!\r\n";
            this.mainWindow.richTextBox2.Text += joined;
        };

        bw.RunWorkerAsync();

    } 
```

我昨晚刚开始学习 C#，所以我对此很陌生。如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-05T22:49:13.333

什么样的对象是'JSON'？您需要传入一个字符串对象才能使 DeserializeObject 方法工作。

# html - Margin collapsing, css

> ID：15235613
> 
> 赞同：0
> 
> 时间：2013-03-05T22:45:47.480
> 
> 标签：html, css

I'm trying to have the header in fixed position.(Header staying fixed in top position and the content goes below) as soon as i put the position fixed the bottom margin collapses.

Any easy fix? I been trying to use clearfix, clear:both ect..

[http://libra-frisk.com/gadjos/](http://libra-frisk.com/gadjos/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:51:10.343

固定定位元素在典型盒子模型的流程之外

您可以在下面的内容上添加 margin-top 或在`body`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:06:18.263

如果你想得到一些东西： ![屏幕](../Images/49f00dbf6ab8adda7acf507f0a84e3e6.png) 你应该使用sliderHolder的更改规则到这个：

```
#sliderHolder {
    margin-top: 158px;
    width: 100%;
    height: 312px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:53:04.843

You could make it absolute position. I'm not sure if that helps because your question is unclear.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T22:57:41.657

如果您希望标题保持固定，请添加以下内容：

```
#sliderHolder {
    width: 100%;
    height: 312px;
    margin-top: 158px;
} 
```

你不需要`clear:both`，因为那是花车。

# javascript - Looking for Windows 8 Metro Style app Calendar control to use in my application

> ID：15235614
> 
> 赞同：-1
> 
> 时间：2013-03-05T22:45:51.340
> 
> 标签：javascript, jquery, windows-8, visual-studio-2012, microsoft-metro

Could you please point me at some existing calendar controls in HTML/JS, which I can imbed into my application?

I design an educational app and I need to use a Calendar like Metro Calendar , I found some Calendars but trail like devExpress. so any suggestions to design a calender like this or are there any samples for calendar control and why most of Jquery calender doesn't compatible with metro.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T03:23:07.260

也许您可以使用可以充当日历的 JavaScript 文件。试试：- [http://javascriptcalendar.org/](http://javascriptcalendar.org/)

# spring - 了解 RESTful Web Service 压力测试结果

> ID：15235615
> 
> 赞同：3
> 
> 时间：2013-03-05T22:45:53.617
> 
> 标签：spring, rest, jmeter, stress-testing, jmeter-plugins

我正在尝试对我的 Spring RESTful Web 服务进行压力测试。

我在 Intel Core 2 Duo 笔记本电脑上运行我的 Tomcat 服务器，内存为 4 GB。我知道它不是真正的服务器机器，但我只有这个，它只是为了学习目的。

对于测试，我在远程机器上运行 JMeter，并通过带有中央无线路由器的私有 WLAN 进行通信。我更喜欢通过无线连接来测试它，因为它可以从移动客户端访问。使用 JMeter，我运行一组 50 个线程，每秒启动一个线程，然后在 50 秒后所有线程都运行。每个线程向服务器重复发送一个 HTTP 请求，其中包含一个要处理的小 JSON 对象，并且在每次迭代中休眠的时间等于 100 毫秒的恒定延迟和具有标准偏差的高斯分布的随机值之和100 毫秒。我为图表使用了一些 JMeter 插件。

结果如下： ![在此处输入图像描述](../Images/95da7111e3d2a068e680548e88aa684f.png)

我不知道为什么 mi hits per second 没有超过 100 的阈值（在图中它们每 10 倍），因为使用这种配置它应该高于这个值（50 线程发送至少 3 次会产生 150 次命中/秒）。我没有从服务器收到任何错误消息，一切似乎都运行良好。我尝试了越来越多的配置，但我无法获得超过 100 次命中/秒。为什么？

[编辑] 很多时候，我注意到从某个时间点开始性能大幅下降而没有任何明显的原因：客户端上没有错误响应消息，只有好的 http 响应消息，而且一切似乎在服务器上也运行良好，但查看报告：

![在此处输入图像描述](../Images/cddc8f9d2916006e70bd337bac61c5f8.png)

正如您所注意到的，在 01:54 和 02:14 之间发生了一些事情：每秒点击次数减少，响应时间增加，这可能是服务器过载，但是 cpu 减少了怎么办？这与拥塞假设不相容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T17:47:35.720

我想注意到您已经很好地选择了要在 Composite Graph 上显示的行。得出一些结论就足够了：

1.  请注意，每秒点击次数与 CPU 使用率完全相关。这意味着您有“CPU-bound”系统，最大性能主要受 CPU 限制。记住这一点非常重要：Hits 花费的服务器资源，而不是活跃用户。您可以完全禁用睡眠定时器，但仍会收到相同的 80-90 Hits/s。
2.  CPU 的最高水平在 80% 左右，所以我假设您在计算机上运行 Windows 操作系统（Win7？）。我曾经看到在 Windows 机器上实现 100% 的 CPU 利用率是不可能的，它只是不允许花费最后的 20%。如果您达到了最大值，那么您会看到安装的容量限制。它只是没有足够的 CPU 资源来处理更多请求。为了解决这个瓶颈，您应该提供更多 CPU（使用具有更高级别 CPU 硬件的另一台服务器），或者将操作系统配置为让您使用高达 100%（我不知道它是否适用），或者优化您的系统（代码, 操作系统设置）花费更少的 CPU 来服务单个请求。
3.  对于第二张图，我假设通过路由器下载了一些东西，或者 JMeter 机器上发生了一些事情。“某事发生”意味着某项任务正在运行。这可能是您的朋友只想做一些“grep error.log”，或者一些计划任务正在运行。要确定这一点，您应该查看降级情况下的路由器资源和 jmeter 机器资源。一定有进程吞噬CPU/DISK/Network。

# performance - SqlAlchemy performance: forbid querying e.g. in template generation?

> ID：15235616
> 
> 赞同：1
> 
> 时间：2013-03-05T22:45:55.123
> 
> 标签：performance, orm, sqlalchemy

I find a lot of performance issues with SqlAlchemy creep into my project when database lookup happens at e.g. the template generation stage.

Is it possible to tell SqlAlchemy that 'data gathering' has finished, and that any further queries to a session (e.g. as a side effect of accessing an instrumented attribute) are to raise an exception?

What other strategies have people used to ensure that an ORM performs well?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:06:16.873

无论您是在模板生成期间还是在此之前进行数据库查找，性能都没有差异 - 关键是要避免用数百个查询锤击数据库，无论这些查询源自何处。

您需要跟踪在每个请求/响应周期中发出的查询数量 - 如果您看到许多查询，您知道您需要优化访问数据的方式。

许多 Web 框架都包含“调试工具栏”功能，例如 Pyramid 和 Flask 就有一个。如果您使用其中一个框架，只需启用它即可。

否则，自己动手并不难：

```
class QueryStats(object):
    def __init__(self):
        self.begin()

    def add_query(self, statement, parameters):
        self.queries += [(statement, parameters)]

    def begin(self):
        self.queries = []

def before_cursor_execute(conn, cursor, statement, parameters, context
    DBSession.stats.add_query(str(statement), str(parameters))

class SessionStatsBase(SessionBase):
    def __init__(self, *args, **kw):
        SessionBase.__init__(self, *args, **kw)
        self.stats = QueryStats()

DBSession = scoped_session(sessionmaker(class_=SessionStatsBase, ...)
event.listen(engine, "before_cursor_execute", before_cursor_execute) 
```

然后，您只需在页面底部打印一长串查询，或者，如果您愿意，如果请求发出的查询超过 100 个，则引发异常。

# iis-6 - redirect in IIS 6.0

> ID：15235617
> 
> 赞同：0
> 
> 时间：2013-03-05T22:45:59.543
> 
> 标签：iis-6, atg-dynamo

How would I redirect requests like [http://www.mydomain.com/test](http://www.mydomain.com/test) to the root [http://www.mydomain.com](http://www.mydomain.com) in IIS 6.0

Is there any way to do this in IIS itself rather then in the code?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T02:58:51.210

当我遇到重定向问题时，尝试查看下面对我有用的帖子

“ [IIS 6 如何从 http://example.com/* 重定向到 http://www.example.com/*](https://stackoverflow.com/questions/1872227/iis-6-how-to-redirect-from-http-example-com-to-http-www-example-com/1872647#1872647) ”

# c# - 如何在 C# 应用程序中使用 DSN 文件？

> ID：15235618
> 
> 赞同：1
> 
> 时间：2013-03-05T22:46:00.883
> 
> 标签：c#, odbc

这是我的旧代码。

```
conn = new System.Data.Odbc.OdbcConnection();
conn.ConnectionString = @"DSN=dBase Files"; 
```

它抛出一个错误：（我认为我的旧代码可能仍然可以在 32 位机器上运行，但我现在在 64 位机器上）

```
"[Error] [IM002] [Microsoft] [ODBC Driver Manager] Data source name not found and no default driver specified" 
```

我的所有搜索都告诉我使用 SysWow64/odbcad32.exe 创建一个 .DSN 文件。现在我创建了 DSN 文件，如何修改这一行 , `conn.ConnectionString = @"DSN=dBase Files";`以指向我保存在磁盘上的 .DSN 文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T22:50:53.127

据我记得，我必须在管理工具下的 ODBC 数据源中设置 DSN，但那是在世纪之交。

这可能会有所帮助：`FILEDSN=c:\myDsnFile.dsn;Uid=myUsername;Pwd=;`

所以像：

```
conn = new System.Data.Odbc.OdbcConnection();
conn.ConnectionString = @"FILEDSN=C:\path\to\dsn\file\here.dsn;Uid=myUsername;Pwd=;"; 
```

从[这里](http://www.connectionstrings.com/dsn)。

# formatting - JSON.Net serialize XML to JSON camel case

> ID：15235619
> 
> 赞同：8
> 
> 时间：2013-03-05T22:46:01.683
> 
> 标签：formatting, xml-serialization, json.net

How do I get JSON.Net to serialize my XML to camel case JSON and without the "@"?

this is what I currently have but it prepends @ to the properties and does not camel case...

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(myXmlString);

string jsonText = Newtonsoft.Json.JsonConvert.SerializeObject(doc, new JsonSerializerSettings()
{
    NullValueHandling = NullValueHandling.Ignore,
    ReferenceLoopHandling = ReferenceLoopHandling.Ignore,
    ContractResolver = new CamelCasePropertyNamesContractResolver()
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T23:24:14.253

制作 XML 数据的模型

例子

```
public class MyClass
    {
        [JsonProperty("@SomeXMLProperty")]
        public string MyString{ get; set; }
    } 
```

然后将 XML 反序列化为您的模型

```
XDocument xmlDocument = XDocument.Parse(xmlData);
string jsonData = JsonConvert.SerializeXNode(xmlDocument);
var myClass = JsonConvert.DeserializeObject<MyClass>(jsonData); 
```

然后只需使用**CamelCasePropertyNamesContractResolver**和**Formatting.Indented**

```
string json = JsonConvert.SerializeObject(rootObject,
                              Newtonsoft.Json.Formatting.Indented,
                              new JsonSerializerSettings { ContractResolver = new Newtonsoft.Json.Serialization.CamelCasePropertyNamesContractResolver() }); 
```

**更新：**

第一个解决方案简单干净（无需编写自定义解析器等）这只是为了删除@符号

```
 var xml = new XmlDocument();
  xml.XmlResolver = null;        
  xml.Load("yourfilehere");

  var json = JsonConvert.SerializeXmlNode(xml, Newtonsoft.Json.Formatting.Indented);

  var withoutATSign = System.Text.RegularExpressions.Regex.Replace(json, "(?<=\")(@)(?!.*\":\\s )", String.Empty, System.Text.RegularExpressions.RegexOptions.IgnoreCase); 
```

如果有人知道这两种情况的更好解决方案，那么第一种情况会很好看。

*WebAPI 添加*

```
var json = GlobalConfiguration.Configuration.Formatters.JsonFormatter;
json.SerializerSettings.Formatting = Newtonsoft.Json.Formatting.Indented; 
json.SerializerSettings.ContractResolver = new CamelCasePropertyNamesContractResolver(); 
```

# html - 如何在固定尺寸外部 div 中包含的内部 div 上获得垂直滚动条？

> ID：15235621
> 
> 赞同：2
> 
> 时间：2013-03-05T22:46:20.433
> 
> 标签：html, css, position, css-position

我正在寻找一个 HTML/CSS 解决方案，其中内部 DIV 具有以下特征：

**一定有：**

*   包含在可变高度同级标题 div 下方的固定高度容器 div 中。
*   填充可用的可变高度，没有 max-height CSS 属性
*   必要时垂直滚动以容纳内容
*   位于 DOCTYPE = HTML 4.01 strict 的文档中（如有必要，最好使用 HTML 5）
*   兼容多浏览器（Chrome、Firefox、IE、Safari、手机浏览器）

**想拥有：**

*   不使用表格
*   不使用 JavaScript

到目前为止，我有以下部分解决方案：

*   仅限 WebKit，带表格：http: [//jsfiddle.net/ksevksev/PBXZG/2/](http://jsfiddle.net/ksevksev/PBXZG/2/)

* * *

**HTML**

```
<div class="parent">
    <table cellspacing="0">
        <tr><td class="header">Heading</td></tr>
        <tr><td class="scrollContainer"><div class="innerScroll">
            Lots of text goes here. Lots of text goes here. Lots of text goes here.
            ...
            Lots of text goes here. Lots of text goes here. Lots of text goes here.
            </div>
        </td></tr>
    </table>
</div> 
```

**CSS**

```
.parent
{
    margin:0px;
    padding:0px;
    height: 400px;
    background-color: orange;
    border: thick purple solid;
}

table
{
    border:green thick solid;
    width:100%;
    height:100%;
    margin:0px;
}

.header
{
    font-weight: bold;
    font-size: 28pt;
    font-family: sans-serif,Arial;
    border:yellow thick solid;
}

.scrollContainer
{
    margin: 0px;
    position: relative;
    border: thick blue solid;
    bottom:0px;
    top:0px;
    left:0px;
    right: 0px;
    height:100%;
}

.innerScroll
{
    overflow-y: auto;
    position: absolute;
    top: 0px;
    bottom: 0px;
    left: 0px;
    right: 0px;
} 
```

* * *

*   带有 jQ​​uery 的多浏览器：http: [//jsfiddle.net/ksevksev/yDJrV/1/](http://jsfiddle.net/ksevksev/yDJrV/1/)

* * *

**HTML**

```
<div class="parent">
    <div class="header">Heading</div>
    <div class="scrollContainer">
        <div class="innerScroll">
            Lots of text goes here. Lots of text goes here. Lots of text goes here.
            ...
            Lots of text goes here. Lots of text goes here. Lots of text goes here.
        </div>
    </div>
</div> 
```

**CSS**

```
.parent
{
    margin:0px;
    padding:0px;
    height: 400px;
    background-color: orange;
    border: thick purple solid;
}
.header
{
    font-weight: bold;
    font-size: 28pt;
    font-family: sans-serif,Arial;
    border:yellow thick solid;
}

.scrollContainer
{
    position: relative;
    border: thick blue solid;
    bottom:0px;
    top:0px;
    left:0px;
    right: 0px;
    height:100%;
}

.innerScroll
{
    position: absolute;
    overflow-y: auto;
    top: 0px;
    bottom: 0px;
    left: 0px;
    right: 0px;
} 
```

**JS**

```
var container = $(".scrollContainer");
var header = $(".header");
var parent = $(".parent");
var containerHeight = parent.innerHeight() - header.outerHeight();
//alert("containerHeight=[" + containerHeight + "]");
container.outerHeight(containerHeight); 
```

* * *

预先感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:27:46.663

如果手动设置标题的高度不是问题，您可以在滚动区域上使用绝对定位并将顶部设置为标题的高度。我很害怕你不会更接近纯 CSS。

[http://jsfiddle.net/Neograph734/yDJrV/2/](http://jsfiddle.net/Neograph734/yDJrV/2/)

```
.parent
{
    margin:0px;
    padding:0px;
    height: 400px;
    background-color: orange;
    border: thick purple solid;
    position: relative;
}
.header
{
    font-weight: bold;
    font-size: 28pt;
    font-family: sans-serif,Arial;
    border:yellow thick solid;
}

.scrollContainer
{
    position: absolute;
    border: thick blue solid;
    bottom:0px;
    top:55px; /* This is the header height */
    left:0px;
    right: 0px;

}

.innerScroll
{
    position: absolute;
    overflow-y: auto;
    top: 0px;
    bottom: 0px;
    left: 0px;
    right: 0px;
    height: 100%;
} 
```

**更新**

如果 javascript 不是问题，你可以使用这个小块 jquery

```
var headerHeight = $('.header').outerHeight();
$('.scrollContainer').css('top', headerHeight); 
```

这里的工作示例：http: [//jsfiddle.net/Neograph734/yDJrV/3/](http://jsfiddle.net/Neograph734/yDJrV/3/)

# ios - 自定义 UITableViewCell 图像直到滚动才显示

> ID：15235625
> 
> 赞同：2
> 
> 时间：2013-03-05T22:46:26.833
> 
> 标签：ios, uitableview, uiimageview

我的自定义`UITableViewCell`图像出现错误，直到`UITableView`滚动后才显示。它不会发生在所有单元格上，只有下一个正在打开或最近一个正在关闭（例如，如果您看到底部的一半单元格，您将无法看到图像，直到您将其一直滚动到视图中）

所以我决定也许我需要做得更好，将我`UIImages`与正确的自定义单元格关联起来。

我创建了一个`UIImageView`名为“firstImageView”，然后进入我的界面构建器并将其与正确的`UIImageView`.

然后在里面`tableview:cellForRowAtIndexPath:`我尝试这样设置

```
myCustomCell.firstImageView.image = [UIImage imageNamed:@"SMILE.png"]; 
```

但是我收到此错误

> 在“UITableViewCell *”类型的对象上找不到属性“firstImageView”

任何帮助，将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:55:47.537

为了解决您对即将发布的图像的错误，这是我的答案：当您得到`UITableViewCell`这样的

```
MyCustomCell *myCustomCell = [self.tableView dequeueReusableCellWithIdentifier:@"myCustomCellIdentifier"]; 
```

您可以实现`-(void)prepareForReuse`覆盖的方法`UITableViewCell`。否则，也可以在您`-(UITableViewCell *)tableView:cellForRowAtIndexPath:`的单元格出列后在您的方法中设置自定义内容。

您可以在此处获取更多信息： [如何使用 prepareForUse-Method](https://stackoverflow.com/questions/9362713/how-to-use-prepareforreuse-method)和[Apple 文档`UITableViewCell`](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html)

解决未知类属性的另一个问题：你的类型是什么`myCustomCell`？在界面生成器中，您必须分配正确的类型，并且您`myCustomCell`还必须是正确的类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-08T11:01:33.170

这里 122,111 是表格视图单元格中图像视图的框架，将其替换为您的 ``UIGraphicsBeginImageContextWithOptions(itemSize, NO,UIScreen.mainScreen.scale); ``˚˚`CGSize itemSize = CGSizeMake(122,111);
CGRect imageRect = CGRectMake(0.0, 0.0, itemSize.width, itemSize.height);
[imageView.image drawInRect:imageRect];
imageView.image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext();`

 `* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:55:00.987

出列单元格时，您是否将其转换为自定义单元格类？

```
MyCustomCellClass *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T08:46:48.473

看起来您创建了一个自定义`UITableViewCell`子类，但您没有使用您在 IB 中分配的标识符（“重用标识符”）将其出列。`

# domain-driven-design - 聚合中的领域驱动设计和本地身份

> ID：15235629
> 
> 赞同：0
> 
> 时间：2013-03-05T22:46:34.417
> 
> 标签：domain-driven-design, aggregate, identity

在领域驱动设计中，有一个聚合根引用了内部实体。

Aggregate Root 是一个具有全局身份的实体（每个人都可以使用它的 id）。聚合根具有指向本地对象（实体）的链接。

假设这里的实体是 Hibernate @Entities（比方说）

假设我们有聚合根“用户”，其中包含“地址”实体作为对象（实际上也是一个实体）

问题是：如何使本地实体仅具有本地身份。我的意思是，没有任何障碍可以阻止任何人通过其 ID 使用本地实体（如地址）。（所以这个身份根本不是本地的，而是全球的）。那么，本地化的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T23:31:08.253

好吧，我不认为这是公共字段或属性或某些访问限制机制的问题，我认为“本地身份”的方式意味着聚合边界之外的对象不能以有意义的方式使用该本地身份或有用的方式（例如，他们不能使用该身份来检索该对象或将其保存到数据库或任何其他操作）。该身份对外部世界没有任何意义，它仅在该聚合中是唯一的。另一个例子，什么可以保证聚合边界之外的对象不会持有对内部对象的引用（这违反了聚合的原则之一），除非这些对象是 VALUE OBJECTS，否则每次都不是这样。如果我想说几句话：不要

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T23:11:18.290

所有实体，包括根，都有一个身份。仅应“全局”使用聚合根的标识这一事实是代码本身无法轻易实施的。特别是在关系数据库中，每条表记录都会有一些键，无论该记录是否存储聚合根、实体或值对象。因此，由开发人员决定哪些数据库身份是域的一部分，哪些不是。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-06T04:52:24.797

聚合根中的实体应该只有本地身份。出于所有意图和目的，数据库表不需要有主键。当聚合体被水合时，应根据它们与 AR 的链接来获取 AR 中的实体。但即使*是*FK 也不需要在本地实体中表示，因为基于本地实体与 AR 的包含，连接是显而易见的。

由于如果表上没有 PK，大多数数据库系统都会抱怨，因此您可以为此添加一个，但您可以在实体设计中忽略它。因此，实体中的 PK 将没有属性。然后有人可以访问该实体的唯一方法是通过数据库，因为您的代码中应该没有办法这样做。

# python - Matplotlib - 在“颜色条”中选择一种与一个值相关的颜色

> ID：15235630
> 
> 赞同：4
> 
> 时间：2013-03-05T22:46:36.080
> 
> 标签：python, matplotlib, colorbar

我想绘制与某些值关联的矩形`(X_i)`。每个矩形都将根据其值 value 具有填充颜色`X_i`。

是否可以使用一个`colorbar`并且还知道哪种颜色与一个值相关联？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T23:45:55.810

```
from matplotlib.pylab import *
import matplotlib.cm as cm
import matplotlib.patches as patches

min_val = 0
max_val = 50

my_cmap = cm.get_cmap('jet') # or any other one
norm = matplotlib.colors.Normalize(min_val, max_val) # the color maps work for [0, 1]

x_i = 15
color_i = my_cmap(norm(x_i)) # returns an rgba value

rect = patches.Rectangle((.5, .5), .25, .25, color=color_i) # make your rectangle

cmmapable = cm.ScalarMappable(norm, my_cmap)
cmmapable.set_array(range(min_val, max_val))

figure()
ax = gca()
ax.add_patch(rect)
colorbar(cmmapable)
show() 
```

还会在图表上为您提供一个颜色条。

# ios - 如何模拟在 UIButton 上突出显示背景图像的时间

> ID：15235632
> 
> 赞同：1
> 
> 时间：2013-03-05T22:46:41.713
> 
> 标签：ios, objective-c, uikit

我创建了一个自定义按钮，因为我希望能够将它组合成多个不同的图像。它实际上继承了 UIControl 而不是 UIButton。这导致了在点击图像时突出显示图像的问题。

因此，我遵循了这个问题中的建议，在 UIImage 上创建了一个类别来模拟标准 UIButton 的突出显示：[How to implement highlighting on UIImage like UIButton does when tapped?](https://stackoverflow.com/questions/4681903/how-to-implement-highlighting-on-uiimage-like-uibutton-does-when-tapped)

我正在根据 UIControlEventTouchDown、UIControlEventTouchUpInside 和 UIControlEventTouchUpOutside 事件触发图像着色。

这*主要是*有效的，除了时间有点不对。使用标准的 UIButton，无论用户点击多长时间或多短，突出显示总是会发生，但在我的实现中，如果用户点击非常快（大多数时候），突出显示不会发生。

我假设这可能是因为在用户向下和向上点击之间屏幕没有重新绘制，但我不完全确定。

我试过的：

*   换出图像后立即调用`setNeedsDisplay`- 无济于事

*   覆盖`touchesBegan`并将`touchesEnded`图像交换代码放在那里 - 无济于事

*   在调用中异步执行图像交换代码`dispatch_async`- 无济于事

在这一点上，我唯一能想到的另一件事是设置一个计时器，如果它检测到用户没有按下超过特定时间段，则在稍微延迟后手动触发图像更改。

这感觉不对，我想知道是否有更好的方法来实现这一点。还有其他一些我应该超越的事件吗？

# java - 当我所做的只是一个列表时，为什么 Hibernate 会删除我的集合条目？

> ID：15235633
> 
> 赞同：6
> 
> 时间：2013-03-05T22:46:42.447
> 
> 标签：java, spring, hibernate, jpa, spring-data-jpa

我似乎有一个相当奇怪的问题。我在 JSP 中显示用户及其角色。出于某种原因，角色仅在页面第一次加载时显示。我刷新页面，角色都从数据库中删除了！

我的设置是标准 Spring MVC、JPA + Hibernate (over Spring Data) 应用程序。（春季 3.2.x，休眠 4.1.8）

我有两个实体 -如下所示（假设 setter 和 getter `User`）`Role`

```
@Entity
public class User {
    @Id
    @GeneratedValue
    private int id;

    private String name;

    @ManyToMany
    @JoinTable(name = "user_role", joinColumns = @JoinColumn(name = "user_id"), inverseJoinColumns = @JoinColumn(name = "role_id"))
    private Set<Role> roles = new HashSet<>();
}

@Entity
public class Role {
    @Id
    private String id;

    private String name;
} 
```

我有一个 Spring Data 存储库，它没有定义任何额外的方法。

```
public interface UserRepository extends CrudRepository<User, Integer> { 
} 
```

我有一个服务和一个控制器，其相关方法如下。

```
// service
@Transactional(readOnly = true)
public Iterable<User> findAll() {
    return userRepository.findAll();
}

// controller
@RequestMapping
public String showUsers(ModelMap model) {
    model.put("users", userService.findAll());

    return "admin/users";
} 
```

在我的 JSP 中，我试图显示所有用户和任何关联的角色。

```
<c:forEach var="user" items="${users}">
    <tr>
        <td>${user.name}</td>
        <td>
           <c:forEach var="role" items="${user.roles}">
                ${role.name}
            </c:forEach>
        </td>
    </tr>
</c:forEach> 
```

就像我之前说的，`user_role`在这个页面被渲染后，我的表中的记录被删除了。

在启用`DEBUG`和`org.hibernate`启用查询日志记录后，这是我在日志中发现的内容：

```
22:36:25 DEBUG Collection dereferenced: [com.adarshr.domain.User.roles#1] [Collections.java:76]
22:36:25 DEBUG Flushed: 0 insertions, 0 updates, 0 deletions to 2 objects [AbstractFlushingEventListener.java:117]
22:36:25 DEBUG Flushed: 0 (re)creations, 0 updates, 1 removals to 1 collections [AbstractFlushingEventListener.java:124]
22:36:25 DEBUG Deleting collection: [com.adarshr.domain.User.roles#1] [AbstractCollectionPersister.java:1124]
22:36:25 DEBUG 
    delete 
    from
        user_role 
    where
        user_id=? [SqlStatementLogger.java:104]
22:36:25 DEBUG Done deleting collection [AbstractCollectionPersister.java:1182] 
```

很明显，这里发生了一些可疑的事情。为什么我的收藏首先被取消引用？

这是我的 JPA 实体管理器工厂定义。

```
<bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
    <property name="dataSource" ref="mainDataSource" />
    <property name="packagesToScan" value="com.adarshr.domain" />
    <property name="persistenceProviderClass" value="org.hibernate.ejb.HibernatePersistence" />
    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
    </property>
    <property name="jpaProperties">
        <value>
            hibernate.dialect=org.hibernate.dialect.MySQL5InnoDBDialect
            hibernate.format_sql=${hibernate.format.sql}
            hibernate.ejb.naming_strategy=org.hibernate.cfg.ImprovedNamingStrategy
            hibernate.show_sql=${hibernate.show.sql}
            hibernate.enable_lazy_load_no_trans=true
        </value>
    </property>
</bean> 
```

我在这里遗漏了一些明显的东西吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T02:58:19.913

由于您发布的代码似乎正确，我在这里猜测。

我建议的第一件事是删除这个初始化（它似乎是唯一删除角色的地方），虽然这本身是一个好主意（见下面的评论）我认为可能会干扰`hibernate.enable_lazy_load_no_trans=true`已知[泄漏连接](https://hibernate.onjira.com/browse/HHH-7524)过去：

```
 private Set<Role> roles = new HashSet<>(); 
```

A second try would be to check if and what changes if you also annotate the inverse side of your ManyToMany relation with mappedBy.

A third attempt would be if eagerly loading the collection fixes the problem (aggravating enable_lazy_load_no_trans position even more), using FetchType, Hibernate.initialize() of whatever you want.

Last one is getting rid of enable_lazy_load_no_trans and use OpenSessionInView

EDIT: ahh, last one, you may* have it this bug (hibernate 4.1.8 and 4.1.9 affected): [https://hibernate.onjira.com/browse/HHH-7971](https://hibernate.onjira.com/browse/HHH-7971)

So having a shot with 4.1.7 could give better results (or maybe worse).

`*` where may is to be intended as: "your case is so similar you are invited to send your code as a test case in the bug report".

# sql - 如何在 Rails 中查询这个？

> ID：15235634
> 
> 赞同：2
> 
> 时间：2013-03-05T22:46:43.820
> 
> 标签：sql, ruby-on-rails, database

我有一个模型`submission`，它**has_many** （和`submissionstate`两个表分别）。`submissions``submissionstates`

`submissionstates`有一个外键`submission_id`和另一`state_id`列（和`updated_at`, `id`）

每次如果 的状态发生变化`submission`，就会在`submissionstates`表中创建一个具有新状态的新条目。

我想显示`state_id`= **0**并且状态是提交的**最新状态的条目。**

例如，a`submission`有两个状态（A（state_id = 0）和 B（state_id = 1）），B 在 A 之后添加。所以我**不**希望这个提交显示在页面上，因为即使它有 A，它不是最新状态（即 B）。

我用了：

```
@submissions = Submission.includes(:submissionstates).where("submissionstates.state_id = 0").all 
```

但结果将包括所有`state_id`= 0 的状态，即使它们不是提交的最新状态。

为了使这项工作，我应该在查询中进行哪些更改？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:13:36.890

这并不能真正回答您的问题，但可以解决您的问题

你说

> 例如，一个提交有两个状态（A（state_id = 0）和B（state_id = 1）），B

这是错误的。状态意味着奇点。即水壶不能既沸腾又冷。考虑将您的州旗移动到提交表中。如果您需要知道状态何时更改，请保留您的提交状态表，但您会将其用于完全不同的目的。

通过这样做，您可以使用

```
@submissions = Submission.where("state" = 0) 
```

然后，您可以根据需要为每个州设置范围，例如

scope :state_0, where(:state => 0) 这让你

```
@submissions = Submission.state_0 
```

这比您的方法更具可扩展性通过保留提交状态表，您仍然可以通过使用该`created_at`字段列出特定提交的状态更改的日期和时间，但这比正常的实时使用更像是审计跟踪

**根据评论更新**

使用单独的提交状态表很好，因为它会为您提供所需的审计跟踪，但您仍应在提交表上保持当前状态。

每次状态更改时更新提交记录非常简单，可以在性能方面实现，这没什么大不了的，尤其是与尝试从 submitstates 表中确定当前状态时将面临的性能问题相比。

我是说你两者都需要。如果您在将当前状态保留在提交表上时遇到问题，请大喊大叫，我会看看我是否可以解决这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:15:47.003

您的数据库结构有问题！

当涉及到关系数据库时，您必须始终记住一件事：**没有一般的或自动的行排序！**

我的意思是：您不能依赖查询输出的顺序。问题是：DBMS 优化您的查询，如果您不调用`ORDER BY`它，则未定义它将返回行的顺序。（即使它看起来总是相同的顺序，它可能会在升级 DBMS 或仅仅因为一袋大米在中国掉下来而改变）。**不要依赖那个！**

所以只有一个合乎逻辑的解决方案：表的第三列`submissionstate`，自动生成的主键或时间戳。如果您不需要创建时间，请使用主键。

然后你的桌子看起来像：

```
id | submission_id | state_id
-----------------------------
1  | 4             | 3
2  | 8             | 3
3  | 4             | 2
4  | 6             | 1
5  | 4             | 5
6  | 8             | 0 
```

如果我理解正确，你想要这些结果：

*   如果你寻找`submission_id = 4`你想收到`state_id = 5`
*   如果你寻找`submission_id = 8`你想收到`state_id = 0`
*   如果你寻找`submission_id = 6`你想收到`state_id = 1`

正确的？

* * *

## 解决方案：

因此，当`id`给出一个字段时，您要查找的查询是：

```
SELECT submission_id, state_id
FROM submissionstates ss
JOIN (
  SELECT MAX(id) as id
  FROM submissionstates ss
  GROUP BY submission_id
) x
ON ss.id = x.id 
```

如果您只想要当前 state_id = 0 的行，则：

```
SELECT submission_id, state_id
FROM submissionstates ss
JOIN (
  SELECT MAX(id) as id
  FROM submissionstates ss
  GROUP BY submission_id
) x
ON ss.id = x.id
WHERE state_id = 0 
```

如果您已经有 created_at 列，请使用它而不是 id 列：

```
SELECT submission_id, state_id
FROM submissionstates ss
JOIN (
  SELECT MAX(created_at) as created_at
  FROM submissionstates ss
  GROUP BY submission_id
) x
ON ss.created_at = x.created_at
WHERE state_id = 0 
```

# jquery - IE 无法识别填充和边框

> ID：15235635
> 
> 赞同：0
> 
> 时间：2013-03-05T22:46:47.347
> 
> 标签：jquery, css

在页面的右侧有一些我用 jQuery 制作的标签（配色、摄影和配套）。但是，我注意到 IE（真是令人惊讶）无法识别`h2`同伴下的表格和表格上的填充和边框。

普通浏览器可以很好地呈现它，只是 IE 会出现问题。

有任何想法吗？

```
<div class="tabbedPanels">
 <ul class="tabs">
  <li class="firstlitab"><a href="#panel1" tabindex="1">COLORWAYS</a></li>
  <li><a href="#panel3" tabindex="3">PHOTOGRAPHY</a></li>
  <li class="lastlitab"><a href="#panel2" tabindex="2">COMPANIONS</a></li>
 </ul>
 <div class="panelContainer">
  <div id="panel1" class="panel">
   <p>content here</p>
  </div> <!-- end panel1 -->

  <div id="panel2" class="panel">                           
   <table class="w_table">
    <h2>Wallpaper</h2>
    <tr>
     <td><a href="#"><img src="images/products/companions/wallpaper1.jpg" /></a></td>
     <td><a href="#"><img src="images/products/companions/wallpaper2.jpg" /></a></td>
     <td><a href="#"><img src="images/products/companions/wallpaper3.jpg" /></a></td>
    </tr>
   </table>
   <table class="pf_table">
    <h2 class="pfh2">Printed Fabrics</h2>
    <tr>
     <td><a href="#"><img src="images/products/companions/printedfabrics1.jpg" /></a></td>
     <td><a href="#"><img src="images/products/companions/printedfabrics2.jpg" /></a></td>
     <td><a href="#"><img src="images/products/companions/printedfabrics3.jpg" /></a></td>
    </tr>
   </table>
   <table class="wf_table">
    <h2 class="wfh2">Woven Fabrics</h2>
    <tr>
     <td><a href="#"><img src="images/products/companions/wovenfabrics1.jpg" /></a></td>
     <td><a href="#"><img src="images/products/companions/wovenfabrics2.jpg" /></a></td>
     <td><a href="#"><img src="images/products/companions/wovenfabrics3.jpg" /></a></td>
    </tr>
   </table>
  </div> <!-- end panel2 -->
  <div id="panel3" class="panel">
   <p>content here</p>
  </div> <!-- end panel3 -->
 </div> <!-- end panelContainer -->
</div> <!-- end tabbedPanels -->

<script>
$(document).ready(function() {

    $('.tabs a').click(function() {
     // save $(this) in a variable for efficiency
     var $this = $(this);

     // hide panels
     $('.panel').hide();
     $('.tabs a.active').removeClass('active');

     // add active state to new tab
     $this.addClass('active').blur();   
     // retrieve href from link (is id of panel to display)
     var panel = $this.attr('href');
     // show panel
     $(panel).fadeIn(250);

     // don't follow link down page
     return(false);
    }); // end click

    // open first tab
    $('.tabs li:eq(2) a').click();
}); // end ready
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:24:25.530

看起来 IE 对 和标签`<h2>`之间的标签不满意。我认为，如果您使用 colspan 和一个类将它们粘贴在另一行以删除 20px 填充，您将获得更一致的渲染。`<table>``<tr>`

当我在 IE 开发者工具中修改源代码时，这有帮助：

```
<table class="w_table">
  <tr>
    <td colSpan="3" style="padding:0px;">
      <h2>Wallpaper</h2>
    </td>
  </tr>
  <tr>
    <td class="firsttd"><a href="#"><img src="images/products/companions/wallpaper1.jpg"></a></td>
    <td><a href="#"><img src="images/products/companions/wallpaper2.jpg"></a></td>
    <td><a href="#"><img src="images/products/companions/wallpaper3.jpg"></a></td>
  </tr>
</table> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T22:54:54.673

现在看看你的代码，我可能会说我最初看到的唯一不合适的地方是你的 h2 标签在 td 标签之外。这可能会敲击填充下方的内容。也可以为表格发布 css 也可能是有益的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T22:55:04.020

你用的是什么版本的IE？IE10上好像没问题

我看不出有什么问题，所以我只是猜测

要删除边框：

```
border:none; 
```

这可能会帮助您提高兼容性

```
padding: 25px; //Firefox, Most browsers
!padding: 16px; //IE7
_padding: 20px; //IE6 
```

它可能适用于 IE9

# c# - 数据库结构，用户 + 用户类型，其中用户可以是多个类型

> ID：15235643
> 
> 赞同：1
> 
> 时间：2013-03-05T22:47:18.997
> 
> 标签：c#, asp.net, sql-server

我目前有一个用户表`tblUser`和一个用户类型表，`tblUserTypes`.

两者之间通过外键链接进行链接`tblUser... fkUserTypeID`。

因此，目前用户只能是一种类型。

但是，在某些情况下，用户可以是多种类型……例如，a`Customer`和`Supplier`.

`tblUser`对我来说显而易见的解决方案是在and之间创建一个新表`tblUserTypes`，`tblUser_UserTypes`这是一个桥接表：

```
[tblUser] ---< [tblUser_UserTypes] >--- [tblUserTypes] 
```

但是，我可以看到由此产生的复杂性......例如，当导出加入其用户类型的用户列表时，通过直接加入，我最终会得到多行这些用户。也许可以使用 PIVOT 查询将每个用户记录带回单行？（更多关于这个）

将用户导入系统似乎也有问题......我目前正在使用`BCP`文件中的（批量复制过程）将用户直接导入用户表......导入文件包含单个字段“用户类型”，它在现有模型，因为每个用户当前只能是一种类型。但是，对于多种用户类型，我看不到直接进入用户表的直接 BCP 是如何工作的。

增加复杂性的是用户类型当前不是固定的......表 tblUserTypes 是动态的......系统的一部分是允许创建任意数量的用户类型。但是，我需要了解某些类型的用户才能在更高级别定义业务逻辑......例如“仅允许该区域中 type=x 的用户”......所以有人建议在用户类型表中有一系列标志定义用户类型是什么类型（例如`IsCustomer`，`IsSupplier`）

这感觉就像一个过于复杂的混乱，我正在为如何前进而失眠。

我很想将用户类型带回表中`tblUser`并完全取消其他两个表......用户表中的一系列复选框（例如`IsCustomer`，`IsSupplier`）......因为这样可以直接导入和导出。但是，用户类型不会是动态的。有趣的是，虽然用户类型不是完全动态的......因为如上所述，当涉及到业务登录时，我需要了解一些用户类型。

嗯，它应该是两者的混合体吗？我是否试图将两个功能合并为一个？也许我可以在用户表中为与业务逻辑相关的类型（例如`IsCustomer`， ）设置复选框/布尔类型，并重命名to`IsSupplier`的上下文或类似的东西。`"User Types"``"User Groups"`

对我来说，一个主要问题是在考虑直接连接将导致用户被复制的结构时对导入、导出和搜索结果的影响......他们所属的每种用户类型对应一行。我必须进行 PIVOT 查询才能将其恢复到每个用户的一条记录，每个用户类型都有一个列，不是吗？一个现实的例子是一个包含 300 万条记录的用户表，一次导入 10,000 条记录……或一次导出 10,000 条记录……或搜索这 300 万条记录以检索 3,000 条匹配项并将其呈现在网页上以分页方式，他们可以浏览搜索结果页面（我`ROWNUM`在搜索查询中使用分页，我不会每次都返回全部内容）。

这是我关于 Stack Overflow 的第一个问题，如果它有点令人费解或者已经列出了答案，我很抱歉......我试图搜索但无法提出处理与用户合作的复杂性的示例多种类型。

哦，以防万一……这是一个使用 SQL Server 的 C# ASP.NET 应用程序。

* * *

**在仔细考虑并阅读回复后，我将一路走来使用桥接表......要求说用户可以是多种类型，所以它就是这样。对现有代码的影响是巨大的，但现在比走下坡路要好。**

我玩弄了表结构，在平面结构中获取数据所需的查询有点繁琐，最终需要动态 SQL（因为用户类型的列表是动态的）我不喜欢但我可以没有看到另一种方法来做到这一点。

在下面的示例中，获取的公司由“事件 ID”过滤，即 fkEventID

**如果有更好的方法来做“扁平化”，我会非常感谢任何帮助:-)**

**直接连接**（如果它们属于一种以上类型，则每个公司多行）

```
select * from tblCompany 
left join tblCompany_CompanyType on fkCompanyID = pkCompanyID
left join tblCompanyType on fkCompanyTypeID = pkCompanyTypeID
where tblCompany.fkEventID = 1 
```

**硬编码数据透视查询**（如果它们属于一种以上类型，则每个公司单行，但公司类型不是动态的）

```
select * from (
select tblCompany.*,tblCompanyType.CompanyType from tblCompany left join
tblCompany_CompanyType on fkCompanyID = pkCompanyID
left join tblCompanyType on fkCompanyTypeID = pkCompanyTypeID
where tblCompany.fkEventID = 1
) AS sourcequery
Pivot (count(CompanyType) for CompanyType IN ([Customer],[Supplier],[Something Else])) as CompanyTypeName 
```

**动态透视查询**（每个公司多行并处理动态公司类型）

```
DECLARE @cols AS NVARCHAR(MAX)
DECLARE @sql  AS NVARCHAR(MAX)

SET @cols = STUFF(
(SELECT N',' + QUOTENAME(CompanyType) AS [text()]
FROM (
select CompanyType from tblCompanyType
where fkEventID = 1
) AS Y
FOR XML PATH('')),
1, 1, N'');

SET @sql = N'SELECT * FROM (
select tblCompany.*,tblCompanyType.CompanyType from tblCompany left join tblCompany_CompanyType on fkCompanyID = pkCompanyID
left join tblCompanyType on fkCompanyTypeID = pkCompanyTypeID
where tblCompany.fkEventID = 1
) AS sourcequery
Pivot (count(CompanyType) for CompanyType IN (' + @cols + ')) as CompanyTypeName
order by pkCompanyID'

EXEC sp_executesql @sql; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T01:06:36.653

您确实在用户和用户类型之间存在多对多关系，我建议您继续以这种方式实现它。

如果您需要在某些情况下看到它变平，您可以使用视图或存储过程来适应它。

如果您想继续使用 BCP 导入，您始终可以将 BCP 导入临时表，然后使用存储的过程来填写您的 3 个表。无论如何，这样做可能更安全。

保持完全实现多对多关系将为您的应用程序提供最大的灵活性，并防止您在获得对新安全角色的新要求时不断修改用户表。

# java - 如何获得 int[][] 维度数组？

> ID：15235650
> 
> 赞同：-2
> 
> 时间：2013-03-05T22:47:41.170
> 
> 标签：java

我想将 matrix[i][j] 获取到我的 int[][] gettwodimensionalArray，我尝试了很多方法，但是当我进行测试时，我的 gettwodimensionaArray 仍然没有从 matrix[i][j] 存储。请帮帮我，谢谢。

这是我的代码样子。

```
 public int[][] gettwodimensionalArray(String file_name) {
    File file = new File(file_name);
    ArrayList<int[]> rows = new ArrayList<int[]>();
    try {
        Scanner scanner = new Scanner(file);
        while (scanner.hasNextLine()) {
            String line = scanner.nextLine();
            String[] s = line.split("\\s+");
            int[] row = new int[s.length];
            for (int i = 0; i < s.length; i++) {
                row[i] = Integer.parseInt(s[i]);
            }
            rows.add(row);
            System.out.println(line);
        }
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }
    int numbOfRow = rows.size();
    // find number of columns by gettting the lenght of one of the rows row

    int keepTrackSizeFirstRow;
    for (int i = 0; i < numbOfRow; i++) {
        if (i == 0) {
            keepTrackSizeFirstRow = rows.get(0).length;

        }
        // compare current row i's array length, to keetracksizefirstrow
    }

    int[][] matrix = new int[numbOfRow][rows.get(0).length];
    // System.out.println(matrix);

    for (int i = 0; i < numbOfRow; i++) {
        // i = row

        for (int j = 0; j < rows.get(i).length; j++) {
            // j = col

            matrix[i][j] = rows.get(i)[j];
            System.out.print(matrix[i][j]);

        }
    }
    return matrix;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:04:41.813

不确定您要做什么。如果您希望输入的每一行都适合数组，您可以声明具有可变大小的数组，如下所示：

```
int[][] matrix = new int[numbOfRow][];
for (int i = 0; i < matrix.length; i++) {
    matrix[i] = new int[rows.get(i).length];
} 
```

相反，如果您希望所有行具有相同的长度，您应该找到输入的最大长度，如下所示：

```
int maxlength = 0;
for (int i = 0; i < rows.size(); i++) {
    maxlength = (rows.get(i).length > maxlength) ? rows.get(i).length : maxlength;
}
int[][] matrix = new int[numbOfRow][maxlength]; 
```

# perl - module vs. dist 共享目录

> ID：15235656
> 
> 赞同：3
> 
> 时间：2013-03-05T22:47:54.387
> 
> 标签：perl, filesystems, perl-module

Perl 模块安装目录中的`dist`和`module`目录的用法有什么区别？[File::Share](https://metacpan.org/module/File%3a%3aShareDir)模块文档讨论了它们，但我并没有真正看到预期用法的差异`auto/share`。由于模块总是以发行版的形式出现，所以它们对我来说似乎是一回事。此外，[shareDir](https://metacpan.org/module/RJBS/Dist-Zilla-4.300029/lib/Dist/Zilla/Plugin/ShareDir.pm) dzil 插件只将这些东西安装到目录中，这似乎是两种选择中比较困难的一种，因为现在我必须要么存储我的发行版的名称，要么获取共享目录的名称。`dist``__PACKAGE__ =~ s/::/-/g`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T13:14:46.880

*由于模块总是以发行版的形式出现，所以它们对我来说似乎是一回事。*

它是逻辑分离，模块不是分布，模块可以移动

以 libwww-perl 发行版为例（它不使用 sharedir :) 它有很多模块，在过去的几年里，它们中的许多模块都被分成了自己的发行版

如果这些模块使用 dist_dir，每个模块都需要更多的编辑

但如果他们使用 module_dir，则无需编辑此问题

*此外，shareDir dzil 插件...*

做一个错误报告:)

# ios - 如何检查本机 iOS 应用程序上的元素

> ID：15235657
> 
> 赞同：5
> 
> 时间：2013-03-05T22:47:56.657
> 
> 标签：ios, inspect

我在 iOS 模拟器上运行 iOS 本机应用程序，并想检查应用程序上的元素以获取 ID。

有谁知道如何做到这一点？

*注意：*请注意，这个问题是针对 iOS 原生应用而不是基于 Web 的应用！

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-05-16T17:18:42.333

听起来您可能正在为您的本机应用程序寻找类似 Firebug 或 Chrome Inspector 的东西？我不确定您所说的“ID”是什么意思。iOS 中的界面元素并没有真正的 ID，就像 DOM 元素有 ID 一样。

您应该查看 Spark Inspector ( [http://www.sparkinspector.com/](http://www.sparkinspector.com/) )，它允许您查看应用程序的视图并在运行时修改它们 - 它可以帮助您查看您正在寻找的内容。全面披露：我是该应用程序的作者 ;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-28T09:38:41.163

有一个名为 Reveal 的新应用程序做得非常出色。您不仅可以检查视图的属性，还可以在“展开”的 3D 视图中查看所有应用程序，更改大小和属性。特别是对于 iOS 7，视图控制器从屏幕的开头（而不是导航栏下方）开始，它可能非常有用。

[您可以在http://revealapp.com](http://revealapp.com)下载试用版并决定您应该获得哪个许可证。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-10T12:51:41.623

有两种最好的方法 -

1.  使用 Apple 的内置工具 Accessibility Inspector，因此您不需要任何其他支持。

2.  由于您将主要将 Xcode 用于您的代码部分，因此可以选择播放 UI 录制，它捕获您在本机应用程序上与之交互的所有操作和元素。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-05T23:07:56.593

您需要检查应用程序的捆绑包。

检查stackoverflow上的这个答案，以获取appID：[https ://stackoverflow.com/a/8883166/933887](https://stackoverflow.com/a/8883166/933887)

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2015-10-05T15:33:38.723

Appium 有一个用于 ios 应用程序的检查器。这是 appium 的链接：http://appium.io/[在](http://appium.io/) 此视频中您可以看到检查器的运行情况：https: [//www.youtube.com/watch?v= jQZTRz2W9xg](https://www.youtube.com/watch?v=jQZTRz2W9xg)

# c# - 使用 Linq 执行具有多个值的包含

> ID：15235661
> 
> 赞同：19
> 
> 时间：2013-03-05T22:48:19.527
> 
> 标签：c#, linq, contains

我有一个药物表，我正在寻找某些药物名称，但我需要搜索多个名称。这是我目前使用它的地方。

```
string[] names = new string[2];
names[0] = "apixaban";
names[1] = "desirudin";

var meds = (from m in Medications where names.Any(m.BrandName.Contains) || names.Any(m.GenericName.Contains) select m); 
```

我所拥有的不起作用，我目前陷入困境。我知道我很接近，但我无法完全弄清楚出了什么问题。

**编辑**

为了澄清起见，如果我要搜索的名称是 desirudin，那么 BrandName 或 Generic 名称会更长，所以我必须在数据库中的字段上包含 contains。

**编辑 2** 这是我收到的错误。

```
Unsupported overload used for query operator 'Any'. 
```

这是我最终得到的

```
var meds = (from m in db.AdmissionMedications where 
(names.Any(n => m.BrandName.Contains(n)) || names.Any(n => m.GenericName.Contains(n))
) select m); 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-05T22:54:21.450

也许像

C# Linq：

```
var meds = (from m in Medications 
            where names.Any(name => name.Equals(m.BrandName) || m.GenericName.Contains(name)) 
            select m); 
```

扩展方法：

```
List<Medication> meds = Medications
    .Where( med =>
        names.Any( name =>
            name.Equals( med.BrandName ) || med.GenericName.Contains( name )
        )
    )
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T23:11:53.173

我想你想试试：

```
var query = Medications.Where(m => names.Contains(m.BrandName) || names.Contains(m.GenericName)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:05:00.990

只需在药物表和名称数组之间进行连接。

```
var query = from m in Medications
            from n in in names
            where m.BrandNames.Any(bn => bn.Contains(n)) || m.GenericNames.Any(gn => gn.Contains(n))
            select m; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T22:53:44.727

If I've understood your right:

```
var meds = Medications.Where(m => names.Contains(m.BrandName) || names.Contains(m.GenericName)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-08T04:25:40.537

```
var x = (from c in Reports where c.HKPlanningQty == xi select c).Select(u=>new {Style=u.Style,QTN=u.HKPlanningQty}).OrderBy(u =>u.Style ).Where(v=>v.Style.Contains("44")||v.Style.Contains("58")); 
```

# jquery - HighCharts 饼图 - 在每个切片内添加文本

> ID：15235666
> 
> 赞同：7
> 
> 时间：2013-03-05T22:49:03.847
> 
> 标签：jquery, highcharts, labels, pie-chart

我正在使用代表资产分配的 HighCharts 创建一个财务饼图。我的目标是创建一个图表，表示每个切片中的实际分配值，但在每张幻灯片内部将基本上显示第二个数据标签，显示各种投资工具的目标百分比。需要注意的是，当前的资产配置可能并不总是与目标配置值相匹配。

除了每张幻灯片中的目标标签外，我已经完成了所有工作。请参阅下图了解我想要完成的任务：

![在此处输入图像描述](../Images/3424c3b6515f4fb3d1291dea92099df0.png)

到目前为止，这是我所拥有的：

```
 var asset_allocation_pie_chart = new Highcharts.Chart({
            chart: { renderTo: 'asset_allocation_bottom_left_div' },
            title: { text: 'Current Asset Allocation', style: { fontSize: '17px', color: entity_color, fontWeight: 'bold', fontFamily: 'Verdana'} },
            subtitle: { text: '(As of ' + effective_date_formatted + ')', style: { fontSize: '15px', color: entity_color, fontFamily: 'Verdana', marginBottom: '10px' }, y: 40 },
            tooltip: { pointFormat: '{series.name}: <b>{point.percentage}%</b>', percentageDecimals: 0 },
            plotOptions: {
                pie: { allowPointSelect: true, cursor: 'pointer', dataLabels: { enabled: true, color: '#000000', connectorWidth: 1, connectorColor: '#000000', formatter: function() { return '<b>' + this.point.name + '</b>:<br/> ' + Math.round(this.percentage) + ' %'; } } }
            },
            series: [{
                type: 'pie',
                name: 'Asset Allocation',
                data: [['Investment Grade Bonds', InvestmentGradeBondPercentage], ['High Yield Bonds', HighYieldBondPercentage], ['Hedged Equity', HedgedEquityPercentage], ['Global Equity', GlobalEquityPercentage], ['Cash', CashPercentage]]
            }],
            exporting: { enabled: false },
            credits: { enabled: false }
       }); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2015-03-15T17:26:03.520

这是用于此的[jsfiddle](http://jsfiddle.net/4RKF4/170/)和用于在内部和外部显示数据标签的代码。

为达到这个

1.  你需要给出两个饼图系列。一个会看前面，另一个会在后面。
2.  如果要模拟它，请更改为`size: '80%'`.
3.  距离：距离的使用是显示数据标签进出，您可以根据您想要的位置进行更改。
4.  allowPointSelect：默认值为 false，但如果使用它，则在单击前面饼图的切片时将显示位于后面的饼图。

代码：

```
 var asset_allocation_pie_chart = new Highcharts.Chart({
        chart: {
            renderTo: 'asset_allocation_bottom_left_div'
        },
        title: {
            text: 'Current Asset Allocation',
            style: {
                fontSize: '17px',
                color: 'red',
                fontWeight: 'bold',
                fontFamily: 'Verdana'
            }
        },
        subtitle: {
            text: '(As of ' + 'dfdf' + ')',
            style: {
                fontSize: '15px',
                color: 'red',
                fontFamily: 'Verdana',
                marginBottom: '10px'
            },
            y: 40
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage}%</b>',
            percentageDecimals: 0
        },
        plotOptions: {
            pie: {
                size: '80%',
                cursor: 'pointer',
                data: [
                    ['Investment Grade Bonds', 100],
                    ['High Yield Bonds', 200],
                    ['Hedged Equity', 300],
                    ['Global Equity', 400],
                    ['Cash', 500]
                ]
            }
        },
        series: [{
                type: 'pie',
                name: 'Asset Allocation',
                dataLabels: {
                    verticalAlign: 'top',
                    enabled: true,
                    color: '#000000',
                    connectorWidth: 1,
                    distance: -30,
                    connectorColor: '#000000',
                    formatter: function() {
                        return Math.round(this.percentage) + ' %';
                    }
                }
            }, {
                type: 'pie',
                name: 'Asset Allocation',
                dataLabels: {
                    enabled: true,
                    color: '#000000',
                    connectorWidth: 1,
                    distance: 30,
                    connectorColor: '#000000',
                    formatter: function() {
                        return '<b>' + this.point.name + '</b>:<br/> ' + Math.round(this.percentage) + ' %';
                    }
                }
            }],
        exporting: {
            enabled: false
        },
        credits: {
            enabled: false
        }
    }); 
```

饼图将如下所示：

![在此处输入图像描述](../Images/bd5f655052807e101300baa91c0abeae.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-27T09:56:30.963

我们可以将负值设置为`distance`内的属性`dataLabels`，这将显示内的文本`slice`

```
plotOptions: {
        pie: {
            dataLabels: {
                distance: -30
            }
        }
} 
```

[演示](http://jsfiddle.net/amitpc/4wnby8pd/3/)

输出 ：

[![饼图距离属性](../Images/8c482660dbb8e59b858fa12df3590965.png)](https://i.stack.imgur.com/vcUcJm.png)

# css - 为什么我的 twitter 和 facebook 按钮之间会出现中断？

> ID：15235667
> 
> 赞同：0
> 
> 时间：2013-03-05T22:49:04.227
> 
> 标签：css, twitter, facebook-like, positioning, twitter-follow

我的网站位于 [http://www.avidest.com/](http://www.avidest.com/)。我已经将一个 facebook like 按钮和一个 twitter 关注按钮放在一起。出于某种原因，FB 按钮出现在 twitter 按钮下方而不是旁边。我不知道为什么。我在 headertext 周围放置了一个边框，以便大家更容易看到它。这是我的CSS：

```
.header {background:url(images/blackwhite10202.png); background-repeat: no-repeat; background-position: center top; padding:0; margin:0 auto; width: 100%; }
.headertop{width: 100%;  background: transparent; height: 30px; min-width: 1020px;  padding-left: 50px; margin: 0 auto;}/*background: #d3e5e8;*/
.topholder1 { background: transparent; margin:0 auto; padding:0; }
.topholder1 .topholder2 { margin: 0 auto; width:1070px;  
.header_text { width:200px; float:right; font:normal 11px Tahoma, Geneva, sans-serif; color:#9a9a9a; padding:6px 450px 10px 200px; margin:0; margin-right: 0px; border: 1px solid black;} 
```

这是html：

```
<div class="header">
<div class="headertop">
  <div class="topholder1"> 
    <div class="topholder2">
        <img src="images/avidestlogo50perresave.png"  border="0" alt="logo" />
        <div class="header_text">

           Twitter button is here
           FB Button is here
       </div>
    </div>
  </div> 
```

如何让两个按钮并排显示？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:01:24.843

的宽度`.header_text`只有 200px，但 fb 小部件是 450px 宽。你必须添加`float:left`到 twitter 小部件。

# android - 动态设置布局

> ID：15235671
> 
> 赞同：0
> 
> 时间：2013-03-05T22:49:23.270
> 
> 标签：android

```
<LinearLayout
    android:id="@+id/LinearLayout1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    tools:context=".MainActivity" > 
```

如何在代码中编写上述 XML？

```
android.widget.LinearLayout.LayoutParams param = new LinearLayout.LayoutParams(
                LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT, 1); 
```

那正确吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:08:33.173

```
//Create the layout params
LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.MATCH_PARENT);

//Create the LinearLayout
LinearLayout ll = new LinearLayout(context);
ll.setOrientation(LinearLayout.VERTICAL); //set orientation
ll.setLayoutParams(params); //asign your layout params 
```

# jquery - jquery masonry wordpress 类别

> ID：15235675
> 
> 赞同：0
> 
> 时间：2013-03-05T22:49:52.023
> 
> 标签：jquery, wordpress, jquery-masonry

所以我有砌体设置它工作，类别工作但它们保持在原始位置但是当我选择一个类别时可能只有一块砖但它停留在底部我需要在帖子不在所选类别中之后重新加载砌体已被隐藏。我尝试了各种不适用的解决方案

第一个解决方案不起作用

```
<script language="javascript" type="text/javascript">  
// This line tells the script to run after the page is loaded,
// As well as allows you to use the `$` function within the script
jQuery(function($) {  
$('#pincontainer').masonry({
    itemSelector: '.pin-gallery', 
});
});
</script> 
```

这在一定程度上确实有效，但容器不会居中并且最后一个 li 浮动页面的左下角，即使有大量空间也尝试了下面

```
 $(document).ready(function() {

  $('#container').masonry({
            $('#container').masonry({
   columnWidth: 320,
   itemSelector: '.brick',
     isFitWidth: true,
  }).imagesLoaded(function() {
   $('#container').masonry('reload');

  });
});

          $('#portfolio-filter').click(function() {

              $('#container ul li').eq(2)
                  .css({'visibility': 'hidden', 'display': 'none'})
                  .removeClass("brick masonry-brick");

              $('#container').masonry('reload');

          });

</script> 
```

砌体停止工作，所以上面可以工作，但我不知道 javascipt/jquery 是如何工作的，所以我不知道代码是否正确

这是我现在拥有的代码，但在选择类别后不会重新加载砌体/重新组织项目 $(document).ready(function() {

```
 $('#container').masonry({
   columnWidth: 320,
   itemSelector: '.brick',
     isFitWidth: true,
  }).imagesLoaded(function() {
   $('#container').masonry('reload');

  });
});
</script> 
```

# java - 未处理的Java异常执行方法的其余部分？

> ID：15235676
> 
> 赞同：2
> 
> 时间：2013-03-05T22:49:55.533
> 
> 标签：java, exception-handling

我正在回答一些基本的 Java 练习测试问题，而在参加测试时，以下问题的正确答案从我身边溜走了。

问题：“如果没有捕获到异常，finally 块将运行并跳过方法的其余部分 - TRUE 还是 FALSE？”

我试图用 ThrowTest 类（粘贴在底部）来证明答案，但我发现 Java 异常处理有点陌生。我按原样编译该类，并将 catch 块的 ArrayIndexOutOfBoundsException 部分注释掉。然后我在不传递输入参数的情况下执行该类，从而创建一个异常（ArrayIndexOutOfBoundsException 异常）。我希望最终的 System.out.println 不会执行，实际上它不会。

我发现如果我取消注释 ArrayIndexOutOfBoundsException 捕获块并重新编译，那么该类会在运行时捕获该特定错误并在底部执行“方法的其余部分”println。那么，我的代码是否证明了“方法的其余部分被跳过”的其余部分，还是我必须从主要方法以外的方法对其进行测试？也许有一种更直接的测试方法。

```
public class ThrowTest 
{

    public static void main(String[] args)
    {
    try
        {
            String anyString = args[0];
            System.out.println("Try  code executes");
        }

    catch(SecurityException e)  //any old exception
        {
            System.err.println ("Error: SecurityException. ");
            e.printStackTrace();
        }

    /* begin comment
    catch(ArrayIndexOutOfBoundsException e)
        {
            System.err.println("Error: Caught ArrayIndexOutOfBoundsException. ");
            e.printStackTrace();    
        }
    end comment */

    finally
        {
            System.out.println("finally block executes!");  
        }

        System.out.println("Rest of method executes!");
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:57:08.437

不管抛出什么异常，`finally`块总是会执行（除非出现任何奇怪的情况，如内存不足），所以给出以下

```
try {
  // do some code
}
catch (SomeException e) {
  // exception handling
}
finally {
  doFinallyStuff();
}

doOtherStuff(); 
```

`doFinallyStuff`将永远在这里执行。但`doOtherStuff`只会在以下条件下执行：

*   不抛出异常
*   `SomeException`被抛出并且 catch 块不会在链上重新抛出异常

`try`如果在该块中抛出另一个未被该`catch`块处理的异常，`doFinallyStuff`仍然会执行，但`doOtherStuff`不会

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:56:23.417

您的代码确实证明一切都按照您的描述进行。当您捕获异常时，随后将执行该方法的其余部分。如果你让方法抛出异常，它的执行会立即停止。无论哪种方式，finally 块都将始终执行。

# c# - 为什么我的对象是指针？

> ID：15235677
> 
> 赞同：-1
> 
> 时间：2013-03-05T22:49:58.300
> 
> 标签：c#, oop

我的问题涉及 C# 中对象的使用。我想我明白发生了什么，但我想知道为什么。由于我不会深入讨论的原因，我想用它的当前数据（当前状态）创建一个对象的临时副本。所以我想我可以创建一个新对象，将其分配给原始对象，然后更改原始对象。那时我会有两个处于不同状态的对象。但是发生的情况是，复制的对象最终看起来与第一个完全一样。这里有一些代码来说明：

```
Order o1 = new Order();
o1.property1 = "test 1";

Order o2 = new Order();
o2 = o1;

o1.property1 = "test 2"; 
```

但在这段代码的末尾，o1 和 o2 都将 property1 设置为“test 2”。我想我意识到所有对象都只是指针，所以如果你改变一个，它就会改变另一个，但我不明白为什么会这样，或者为什么它有用。我在这里缺少一些基本的东西吗？另外，完成我想做的事情的最佳方法是什么？即：存储对象的状态，进行更改，然后在必要时恢复。希望这是有道理的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T23:02:04.053

C# 中的对象变量是对内存中特定对象的*引用（不是指针）。*当你声明

```
Order o2 = new Order(); 
```

您正在堆中创建一个新的 Order 对象，并将对该对象的引用分配给您的 o2 变量。当你然后陈述

```
o2 = o1; 
```

您是在告诉编译器使 o2 成为对 o1 的引用。此时，对原始 o2 对象的引用丢失，并且该对象的内存将在下一次垃圾收集扫描期间被移除。

此后，o1 和 o2 都引用内存中的同一个对象。要将信息从一个对象复制到另一个对象，您需要实现一个过程来实例化一个新的目标对象并将所有数据从一个对象复制到另一个对象。有关更多信息，请参阅 ICloneable 上的 MSDN 文档。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T22:59:50.523

您指的是值类型和引用类型之间的区别。显然你的`Order`对象是一个引用类型，我会假设它是一个类。

类是引用类型，这意味着它们是“指针”。造成这种情况的原因之一是性能，因为您不希望每次分配变量时都复制大量数据。

结构是值类型，在分配它们时会复制到内存中。

您有 2 个解决方案：

*   使用结构而不是类
*   如果非常简单，请使用[MemberwiseClone](http://msdn.microsoft.com/en-us/library/system.object.memberwiseclone.aspx)克隆您的对象，或者如果您需要执行深度克隆，请使用您自己的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T22:56:55.050

这是设计使然。如果您想克隆并保持克隆独立，我建议您在您的类型上实现“克隆”机制。这可以是`ICloneable`甚至只是一个构造函数，它接受一个实例并从中复制值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-05T23:07:45.320

关于你的问题

> 完成我想做的事情的最佳方法是什么？即：存储对象的状态，进行更改，然后在必要时恢复

一个简单的方法是简单地序列化对象，例如使用`XMLSerializer`. 然后，如果您想丢弃更改，只需反序列化原始对象并将修改后的对象替换为原始版本即可。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-05T23:23:15.127

使用结构来完成任务，类是引用类型，结构是值类型。类存储在内存堆上，结构存储在堆栈上。有关更多信息，请搜索 Structs vs Classes 并了解差异

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-05T22:57:36.523

根据定义，对象是一个“指针”；它们包含对您的数据的*引用*，而不是*实际*数据本身。您可以为它分配一个值类型，它会给出保存数据的外观。

如上所述，了解[值类型与引用类型](http://msdn.microsoft.com/en-us/library/t63sy5hs%28v=vs.80%29.aspx)是关键。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-05T23:03:59.787

除了对象引用，Java 没有任何非原始数据类型的概念；因为几乎可以对对象引用所做的任何事情都涉及对所引用的对象`.`（Java 中的运算符）进行操作。尽管 .net 确实具有非原始值类型，但大多数 .net 语言都保持相同运算符的约定（与 C 和 C++ 不同，后者用于`->`访问指向对象的成员并`.`访问结构的成员）`.`用于“取消引用和访问成员”和“访问值类型成员”。

就个人而言，我不喜欢 Java 的“一切都是对象引用”设计，而 .net 决定让值类型和引用类型使用相同的`.`运算符来表示非常不同的事物并没有帮助，但它就是这样。

# javascript - 将内容放在带有类的 div 中

> ID：15235678
> 
> 赞同：0
> 
> 时间：2013-03-05T22:50:02.233
> 
> 标签：javascript, jquery

我有一个简单的问题，我有一个带有一些 id 的 div，里面有一些不同的内容，以一些跨度分隔符结尾，我希望它们放入一个带有类幻灯片的 div，无论如何这里是使它更清晰的结构：

```
<div id="adv">
 content 1 
 <span class="separator"></span>
 content 2
 <span class="separator"></span>
 etc...
</div> 
```

但我希望它具有这种结构：

```
<div id="adv">
 <div class="slide">
  content 1 
  <span class="separator"></span>
 </div>
 <div class="slide">
  content 2 
  <span class="separator"></span>
 </div>
 etc...
</div> 
```

顺便说一句，在带有类分隔符的跨度中不需要，对我来说内容就足够了，在带有类幻灯片的 div 中

谢谢大家的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T23:15:24.927

```
$("#adv").html( 
        $.map(
            $("#adv").html().split('<span class="separator"></span>'),
            function(content) {
                return '<div class="slide">' + content + '<span class="separator"></span></div>';
            }
        ).join("")
    ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:02:57.143

要在第一个中插入新的 div，您可以使用以下内容：

```
$( "#adv" ).append( createNewDiv( "foo" ) );
$( "#adv" ).append( createNewDiv( "bar" ) );

function createNewDiv( content ) {

    var $div = $( '<div class="slide">' + content + '</div>' );
    var $span = $( '<span class="separator"></span>' );

    $div.append( $span );

    return $div;

} 
```

要转换您的代码，您可以使用以下内容：

```
cleanAndBuild( $( '#adv' ) );

function sliceIt( $divToSlide ) {

    var html = $divToSlide.html();
    var sliceStart = 0;
    var i = 0;
    var slices = [];

    while ( true ) {

        // getting the index to slice to.
        var sliceEnd = html.indexOf( '</span>' ) + 7;

        // -1 +7  (-1 not found, 7 of </span> size (in chars)
        if ( sliceEnd == 6 ) {
            break;
        }

        // inserting the new slice
        slices.push( html.substring( sliceStart, sliceEnd ) );

        // removing sliced piece
        html = html.substring( sliceEnd, html.length );

    }

    return slices;

}

function cleanAndBuild( $divToCleanAndBuild ) {

    // getting the slices...
    var slices = sliceIt( $divToCleanAndBuild );

    // cleaning the main container
    $divToCleanAndBuild.html( "" );

    // iterating over the slices, creating a new div, putting the slice inside it and
    // appending it to the container
    slices.forEach( function( el ) {

        var $slideDiv = $( '<div class="slide"></div>' );
        $slideDiv.append( el );
        $divToCleanAndBuild.append( $slideDiv );

    });

} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-05T22:54:57.030

您可以使用 wrap 将 span 元素与 div 一起包装

例如

```
 $(document).ready(function(){
    alert($('#adv').html());
    $('.separator').wrap('<div class="slide">');
    alert($('#adv').html());
}); 
```

让我创建一个快速小提琴并显示所需的结果

# ruby-on-rails-3 - 未在表单上创建嵌套字段

> ID：15235690
> 
> 赞同：0
> 
> 时间：2013-03-05T22:51:17.567
> 
> 标签：ruby-on-rails-3, nested-forms

我正在尝试获取一个项目表格来构建几个（最多 12 个）志愿者时间块的第一个（开始）时间。

`project.rb`

```
class Project < ActiveRecord::Base
  attr_accessible :title, ...
  has_many :vol_times, :dependent => destroy
  accepts_nested_attributes_for :vol_times, :reject_if => lambda { |a| a[:start_time].blank? }, :allow_destroy => true
  ...
end 
```

`vol_time.rb`

```
class Vol_time < ActiveRecord::Base
  attr_accessible :start_time, ...
  belongs_to :project
end 
```

`ProjectsController`

```
class ProjectsController < ApplicationController

  before_filter :signed_in_user, only: :create
  ...
  def new
    @project = Project.new
    @user = current_user
    @project.vol_times.build
  end
  ...
end 
```

`Vol_Times Controller`

```
class Vol_TimesController < ApplicationController
  def new
    @reward = Reward.new
  end
  ...
end 
```

我的观点是这样的……

```
<%= form_for(@project) do |f| %>

<div class="form_field_block">
      <p class="form_label">&nbsp;&nbsp;Project Title</p>
    <%= f.text_field :title, :size => 40, :placeholder => " Project Title...", :class => "frm" %>
</div>
<div class="form_field_block">
  <p class="form_label">&nbsp;&nbsp;Project Sub-title</p>
    <%= f.text_field :sub_title, :size => 40, :placeholder => "  Project Sub-title...", :class => "frm" %>
</div>
<p class="clearing"></p>
<div class="form_field_block">
  <% f.fields_for :vol_times do |builder| %>
    <%= render :partial => 'start_time', :f => builder %>
      <% end %>
</div>    
<p class="clearing"></p>
<%= button_tag "btn_start_project.png", :class => "btn_save" %>
<% end %> 
```

`_partial`看起来像这样...

```
<%= f.label :start_time, "Starting Time" %>
<%= f.text_field :start_time %> 
```

当我查看该页面时，我看到了ERB 的包含`<div>`内容，但没有看到 ERB 的内容，它应该从`_partial`.

任何想法为什么这不起作用？我从 Ryan Bates 的 RailsCast #196 中得到了一般背景 -[这里](http://railscasts.com/episodes/196-nested-model-form-part-1?autoplay=true)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T07:12:11.797

你`=`在`fields_for`. 它应该是

```
<%= f.fields_for :vol_times do |builder| %> 
```

# facebook-graph-api - How to provide "post to my timeline" feature in HTML-based Facebook canvas app?

> ID：15235691
> 
> 赞同：0
> 
> 时间：2013-03-05T22:51:19.120
> 
> 标签：facebook-graph-api, facebook-social-plugins, facebook-timeline

I am having an HTML-based Facebook application, running on Facebook canvas. It is not part of Facebook AppCenter yet.

I am looking for an easy way for the application users to post information about my application - if they would like to - to their timeline. I am not asking for a permission to post on user's timeline (may not be appropriate) - I want instead to make it easy to do that "manually".

When looking at the applications in AppCenter, there is a "Share" link Like here: [https://www.facebook.com/appcenter/texas_holdem?fb_source=appcenter_search](https://www.facebook.com/appcenter/texas_holdem?fb_source=appcenter_search) on the right side...

Clicking on the link leads to what I want to achieve - picture is here - [https://docs.google.com/drawings/d/1xQjdje-0viXdF0mL4Ay3rqayAJ5zQmqPNWW0eqFDq3k/pub?w=960&h=720](https://docs.google.com/drawings/d/1xQjdje-0viXdF0mL4Ay3rqayAJ5zQmqPNWW0eqFDq3k/pub?w=960&h=720) but inside my own HTML-based app.

I reviewed the Social Plugins documentation: [https://developers.facebook.com/docs/plugins/](https://developers.facebook.com/docs/plugins/) , and managed to create a control that helps sending information on my app - but only to specific users!

Yet I failed to find how to implement the "post to my timeline" feature.

Is it something limited to AppCenter applications, or maybe I am missing something simple? What's the closest way to get to what I would like to achieve?

Thanks for any hint.

Max.

# apache-flex - ItemRenderer change background color

> ID：15235694
> 
> 赞同：4
> 
> 时间：2013-03-05T22:51:32.083
> 
> 标签：apache-flex, flex4, flex4.5, background-color, itemrenderer

I have an item renderer that I want to change default colors of:

```
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009"
                xmlns:s="library://ns.adobe.com/flex/spark"
                xmlns:mx="library://ns.adobe.com/flex/mx"
                initialize="init(event)"
                creationComplete="created(event)"
                dataChange="created(event)"
                width="100%"
                maxWidth="{FlexGlobals.topLevelApplication.width}"
                contentBackgroundColor.hovered="0xff0018"
                focusColor="0xff00ff"
                contentBackgroundAlpha="0.8">

        <s:states>
            <s:State name="normal"/>
            <s:State name="hovered"/>
            <s:State name="selected"/>
        </s:states> 
```

The styles in the above code have no effect.

I also tried adding contentBackgroundColor to the List element but that only changed the background of the list and not the items.

css doesn't work either:

```
s|ItemRenderer{
    backgroundColor:#2e2e2e;
} 
```

How can I change background color of the item renderer?

I know I can skin it but that would be an overkill for a simple color change and I am positive that I had it working couple of years back without skinning.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T23:52:51.353

起初这总是有点令人困惑。在我看来，样式名称选择不当。血淋淋的细节都在类的`drawBackground()`方法中`ItemRenderer`。

`contentBackgroundColor`样式是您可以在组件本身上设置的东西，`List`它对渲染器没有影响。它将填充列表的背景颜色，但通常渲染器会占据所有该区域，因此您永远看不到它。例如，如果您的列表很高，但其中只有 1 或 2 个项目（因此底部的空间没有被渲染器覆盖），它将是可见的。

**设置渲染器的背景颜色：**

而不是使用`contentBackgroundColor`，使用`alernatingItemColors`样式。这种风格需要一个值数组。如果您只想要一种颜色，只需将一个元素放入数组中：

```
alternatingItemColors="[#c0c0c0]" 
```

通过查看 中的代码`drawBackground()`，如果要在背景颜色上设置 alpha，则必须自己绘制背景（见下文）。

您可能希望设置的其他背景相关样式：

*   `downColor`
*   `selectionColor`
*   `rollOverColor`

**要绘制自己的背景颜色：**

将`autoDrawBackground`属性设置为 false。这意味着您现在必须为所有各种渲染器状态（“正常”、“选定”、“悬停”等）绘制自己的颜色。幸运的是，您可以在渲染器中使用与上面在您选择的背景对象（`Rect 等）上使用的相同状态语法进行此操作。

```
<s:ItemRenderer autodrawBackground="false">
    <s:states>
        <s:State name="normal"/>
        <s:State name="hovered"/>
        <s:State name="selected"/>
    </s:states>
    <s:Rect id="theBackgroundObject" top="0" bottom="0" left="0" right="0">
        <s:fill>
            <s:SolidColor color="#FF0000" color.hovered="#00FF00"
                alpha="1" alpha.hovered=".5" />
        </s:fill>
    </s:Rect>
</s:ItemRenderer> 
```

# php - How to make a select with 3 tables?

> ID：15235695
> 
> 赞同：0
> 
> 时间：2013-03-05T22:51:47.147
> 
> 标签：php, mysql, select

I have 2 tables: tbImages, tbUsers

tbImages has lots of paths of images with unique ids
tbUsers has lots of users with unique ids...

I will code a page that make a delivery of images...This page will show all images ordering by id... The admin will select 7 images to send it to some user by email... I will have to register when and how many times some user has received that image (a 3rd table maybe)... Here is the problem... I'll have to ORDER images by date of register.. Images already sent have to appear at end of that delivery page...

What is the better way to do this? tbImages has lots of columns one for each user? A 3rd table (tbDelivered) one row each user with column 'images received'? ?How to make this SELECT to show already sent images at end?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:56:30.883

将您与用户 ID 相关联的第三张表`imageID`（关系表）。然后，您可以`JOIN`在查询中使用语句。例如：

```
relational_table
  imageID
  userID
  sendCount 
```

查询可能是：

```
SELECT sendCount
FROM relational_table
WHERE imageID = $imageID
AND userID = $userID 
```

这将使您返回该图像已发送给该用户的次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:45:37.257

您将必须创建一个包含以下内容的第三个表：

*   图像标识
*   用户标识
*   数量

您将创建一个如下所示的 select 语句：

```
SELECT tbImages.imageID, tbDelivered.quantity
FROM tbImages, tbDelivered
WHERE tbImages.imageID = tbDelivered.imageID; 
```

要显示尚未交付的内容，您必须在其末尾添加：

```
AND quantity = 0; 
```

我希望这有帮助

# php - php 和 sql 命令使我的服务器崩溃

> ID：15235698
> 
> 赞同：0
> 
> 时间：2013-03-05T22:51:59.360
> 
> 标签：php, mysql

我正在尝试查询我的数据库以获取我的所有产品，当我这样做时，它会使服务器崩溃，我无法获取信息

```
SELECT categories.category_id, 
       categories.category_name, 
       categories.category_name_fr, 
       subcategories.subcategory_id, 
       subcategories.subcategory_name, 
       subcategories.subcategory_name_fr, 
       suppliers.supplier_id, 
       suppliers.supplier_name, 
       products.product_id, 
       products.product_name, 
       products.product_name_fr, 
       products.product_url 
FROM   categories, 
       subcategories, 
       suppliers, 
       products 
WHERE  products.product_active = 1 
ORDER  BY categories.category_id ASC 
```

我试着放一个 LIMIT 0, 1 但它仍然崩溃了......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:59:42.830

首先，您应该明确指定您的连接和连接条件，因为现在您正在获得所有表的笛卡尔积，这可能不是您想要的。

您应该首先在连接表中列出产品表，因为这是您的`WHERE`子句过滤生效的表。所以像：

```
SELECT categories.category_id, categories.category_name, 
    categories.category_name_fr, subcategories.subcategory_id,
    subcategories.subcategory_name, subcategories.subcategory_name_fr,
    suppliers.supplier_id, suppliers.supplier_name, products.product_id,
    products.product_name, products.product_name_fr, products.product_url
FROM products
INNER JOIN categories ON products.[some field] = categories.[some field]
INNER JOIN subcategories ON categories.[some field] = subcategories.[some field]
INNER JOIN suppliers ON products.[some field] = suppliers.[some field]
WHERE products.product_active = 1
ORDER BY categories.category_id ASC 
```

其次，您需要确保每个列以及连接条件中使用的任何其他列都有一个`products.product_active`索引`categories.category_id`。

第三，作为仅供参考，`LIMIT`条件对此处的查询执行时间没有任何帮助，因为在决定将结果集限制为项目的子集之前，您仍然需要执行连接、过滤和排序。唯一有帮助的地方是通过结果集进行处理（这显然会发生得更快）。

# php - PHP DOMXpath getting nested values

> ID：15235699
> 
> 赞同：0
> 
> 时间：2013-03-05T22:52:12.957
> 
> 标签：php, dom, xpath, domdocument

I'm using DOMDocument and DOMXpath to parse an html page.

The markup is like this:

```
<dl>
  <dt>
   <a href="">name</a>
  </dt>
  <dd>
   <span class="one">one</span>
   <span class="two">two</span>
  </dd>
</dl>
<dl>
  <dt>
   <a href="">name</a>
  </dt>
  <dd>
   <span class="one">one</span>
   <span class="two">two</span>
  </dd>
</dl> 
```

Originally, I only need to get the href value and was able to use:

```
 $doc = new \DOMDocument();
  $doc->loadHTML($html);
  $xpath = new \DOMXPath($doc);
  $res = $xpath->query('//dl/dt/a'); 
```

Then iterate through the results using `->nodeValue` and `->getAttribute('href')`

However, now I want to also get the value within the span tag with a class of value of 'two'.

So I updated my query to `$xpath->query('//dl')`.

The question is, how would I go about getting the href tag and value now and the span value with the class name. Also, any suggestions on how to debug or display paths to query on would be real helpful.

Thank you!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:54:15.987

使用路径直接获取这些值：

```
$res = $xpath->query('//a/@href'); 
```

以及跨度标签中的内容：

```
$res = $xpath->query("//span[@class='two']"); 
```

你可以在这里测试 xpath：[http ://www.xpathtester.com](http://www.xpathtester.com)

# python - TypeError: unsupported operand type(s) for /: 'str' and 'str'

> ID：15235703
> 
> 赞同：22
> 
> 时间：2013-03-05T22:52:41.230
> 
> 标签：python, typeerror, operand

```
name = input('Enter name here:')
pyc = input('enter pyc :')
tpy = input('enter tpy:')
percent = (pyc / tpy) * 100;
print (percent)
input('press enter to quit') 
```

whenever i run this program i get this

```
TypeError: unsupported operand type(s) for /: 'str' and 'str' 
```

what can i do to divide pyc by tpy?

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-05T22:53:43.557

By turning them into integers instead:

```
percent = (int(pyc) / int(tpy)) * 100; 
```

In python 3, the `input()` function returns a string. Always. This is a change from Python 2; the `raw_input()` function was renamed to `input()`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-05T22:53:58.453

The first thing you should do is learn to read error messages. What does it tell you -- that you can't use two strings with the divide operator.

So, ask yourself why they are strings and how do you make them not-strings. They are strings because all input is done via strings. And the way to make then not-strings is to convert them.

One way to convert a string to an integer is to use the [int](http://docs.python.org/2/library/functions.html#int) function. For example:

```
percent = (int(pyc) / int(tpy)) * 100 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T02:49:46.200

我会写：

```
percent = 100
while True:
     try:
        pyc = int(input('enter pyc :'))
        tpy = int(input('enter tpy:'))
        percent = (pyc / tpy) * percent
        break
     except ZeroDivisionError as detail:
        print 'Handling run-time error:', detail 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-06-24T19:32:32.863

forwars=d 斜杠还有另一个错误。

```
if we get this : def get_x(r): return path/'train'/r['fname']
is the same as def get_x(r): return path + 'train' + r['fname'] 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2022-01-10T16:31:38.453

```
name = input ('What is your name?: ')
age = input('How old are you?: ')
date = input ('What year is it?: ')
year = (int(date) - int(age) + 100)

print('You\'ll be 100 in the year ', year)

#That's how I decided to hardcode it. You could get more specific with actual birthdates or else it'll probably be off by a year unless your bday passed. 
```

# r - finding closest date (but not the same date) in R

> ID：15235704
> 
> 赞同：4
> 
> 时间：2013-03-05T22:52:41.207
> 
> 标签：r

To find the closest date, I have:

```
closestDate <- function(searchDate, dateList, roundDown=FALSE) {
              as.Date(sapply(as.Date(searchDate), function(x){
                dist <- abs(x - as.Date(dateList))
                closest <- dateList[which(min(dist) == dist)]
                return(ifelse(roundDown, min(closest), max(closest)))
              }), origin="1970-1-1")
            } 
```

When:

```
> nonNAdays
[1] "2011-08-15" "2011-08-18" "2011-08-19" 
```

I get:

```
> closestDate('2011-08-15', nonNAdays)
[1] "2011-08-15" 
```

I would like for the function to give me the closest date other than the date itself. So in this case, "2011-08-18". How can I alter my code to get this? Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:00:30.707

只需从 dist 计算和选择操作中删除相等的日期*：*

```
 closestDate <- function(searchDate, dateList, roundDown=FALSE) {
           as.Date(sapply(as.Date(searchDate), function(x){
             dist <- abs(x - as.Date(dateList[dateList != searchDate]))
             closest <- dateList[dateList != searchDate][which(min(dist) == dist)]
             return(ifelse(roundDown, min(closest), max(closest)))
           }), origin="1970-1-1")
         }
 nonNAdays <- c("2011-08-15", "2011-08-18", "2011-08-19")
  closestDate('2011-08-15', nonNAdays)
#[1] "2011-08-18" 
```

# .net - svcutil.exe does not handle ws-policy

> ID：15235705
> 
> 赞同：1
> 
> 时间：2013-03-05T22:52:47.600
> 
> 标签：.net, web-services, sap

Svcutil.exe gives this warning:

> The optional WSDL extension element 'Policy' from namespace '[http://schemas.xmlsoap.org/ws/2004/09/policy](http://schemas.xmlsoap.org/ws/2004/09/policy)' was not handled.

and a team member reports a similar Java tool crashes with an exception (I don't have any details).

```
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:p1="urn:mycompany.com:fi:myservice" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" name="MyService" targetNamespace="urn:mycompany.com:fi:myservice">
   <wsp:UsingPolicy wsdl:required="true" />
   <wsp:Policy wsu:Id="OP_DoSomething" />
   <wsdl:portType name="MyPort">
      <wsdl:operation name="DoSomething">
         <wsp:Policy>
            <wsp:PolicyReference URI="#OP_DoSomething" />
         </wsp:Policy>
         <wsdl:input message="p1:MyRequest" />
      </wsdl:operation>
   </wsdl:portType>
</wsdl:definitions> 
```

Removing the policy elements solves the problem. Any ideas why?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T05:36:47.763

WS-Policy 的当前版本是 1.5 版。它使用命名空间`http://www.w3.org/ns/ws-policy`。

请参阅“ [XML 命名空间](http://www.w3.org/TR/ws-policy-primer/#xml-namespaces)”。

* * *

确实，看起来您已经获得了 1.2 版。它使用`http://schemas.xmlsoap.org/ws/2004/09/policy/ws-policy.xsd`. 请参阅[http://schemas.xmlsoap.org/ws/2004/09/policy/](http://schemas.xmlsoap.org/ws/2004/09/policy/)。

# cordova - How to see javascript console output from Windows Phone 8 Emulator or device running Phonegap app

> ID：15235707
> 
> 赞同：6
> 
> 时间：2013-03-05T22:52:59.113
> 
> 标签：cordova, windows-phone-8, phonegap-build

I am developing a mobile app using Phonegap Build to generate for different mobile platforms. I have successfully deployed and debugged my APK file on Android devices using adb tools and ddms. Now on to Windows Phone 8, but I am having trouble figuring out how to debug.

I have a Windows 8 Pro machine and have successfully installed Windows Phone SDK, deployed the XAP file to both the emulator and a Windows Phone 8 device using the Application Deployment tool (got the MS Dev subscription, registered the phone, all that stuff). The app loads but appears to not receive the deviceready event, but I really have no idea because I can't see the console log.

The SDK came with Visual Studio Express, but I don't see how to open an XAP to run it from VS so the output might go to the VS debug windows. Is there any way to see the console.log statements from my XAP from Phonegap Build? or must I create a VS project and compile/run from there?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-25T19:22:18.920

右键单击项目>属性>构建>检查定义调试常量

如果选项被禁用，停止代码执行（`Shift`+ `F5`）

消息应该转到输出窗口。要打开它，请转到查看 > 输出 ( `Alt`+ `2`)

**编辑：**

对于 Visual Studio 2013，似乎以下内容可行。

1.  在**解决方案资源管理器**中选择项目后，在**项目**菜单上单击**属性**。
2.  单击**编译**选项卡。
3.  单击**高级编译选项**按钮打开**高级编译器设置**对话框。
4.  选中**定义调试常量**复选框，然后单击**确定**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-27T15:40:01.273

**在 Visual Studio 2013 中**

要查看 JavaScript 控制台输出，请单击：

`DEBUG`→ `Windows`→`JavaScript Console`

或使用快捷方式打开控制台：

`CTRL + ALT + V, C`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T12:24:36.260

如果您按照此处的说明使用 vs 创建 wp8/cordova 项目[http://docs.phonegap.com/en/2.5.0/guide_getting-started_windows-phone-8_index.md.html#Getting%20Started%20with%20Windows%20Phone %208](http://docs.phonegap.com/en/2.5.0/guide_getting-started_windows-phone-8_index.md.html#Getting%20Started%20with%20Windows%20Phone%208)

您将在 Visual Studio 输出窗口中看到您的 console.log 跟踪。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-22T11:01:21.060

在 Visual Studio 2017 中

单击“调试”>“Windows”>“JavaScript 控制台”。

快捷键 Ctrl + Alt + V, C

# c# - Make text scroll a given amount of times

> ID：15235712
> 
> 赞同：0
> 
> 时间：2013-03-05T22:53:12.743
> 
> 标签：c#, visual-studio-2010, user-interface, timer, horizontal-scrolling

I'm only just getting into GUIs, so please forgive me if I've missed something obvious. Google hasn't helped much I'm afraid.

My base objective is to have Marquee style text scrolling across the screen a set number of times. I've achieved the scrolling aspect utilizing a timer which scrolls a label named "My text here" across the screen (taken from this tutorial: [http://www.youtube.com/watch?v=-y-Z0i-DeAs](http://www.youtube.com/watch?v=-y-Z0i-DeAs) Note: I don't speak the language he does), but I've been unable to get the thing to stop. I'm open to using a different way to achieve the scrolling, but this is the only example I've found so far that worked well with my current level of knowledge of GUIs (basically dragging and dropping).

```
private void timer_Tick(object sender, EventArgs e)
    {
            this.Refresh();
            labelTesting.Left += 5;
            if (labelTesting.Left >= this.Width)
            {
                labelTesting.Left = labelTesting.Width * -1;
            }           
    } 
```

My best guess is that the timer is simply starting the whole process over with each tick. I've tried countering this by having it return after running i times and telling the label what to display, but that's not working. Nor can I seem to find a way to tell the thing to stop.

[http://www.dotnetperls.com/timer](http://www.dotnetperls.com/timer) has an example where a timer is set to run for a given amount of time, but I do not know how to implement that when messing around with GUIs. What would be the best way to implement the feature I desire? Any insight or suggestions would be greatly appreciated.

EDIT: Based on suggestions in the answers and comments I have edited the code to run for what should be 30 seconds before setting itself to a given position. However the text no longer scrolls. I'm going to keep working at it, but more input would be appreciated.

```
 private void timer_Tick(object sender, EventArgs e)
    {
        var time = DateTime.Now;
        if(time < DateTime.Now.AddSeconds(-30)) // you decide when to stop scrolling
        {
            Timer timer = (Timer)sender;

            timer.Stop();
            labelTesting.Left = 0; // or wherever it should be at the end of the scrolling
        }

        this.Refresh();
        labelTesting.Left += 5;
        if (labelTesting.Left >= this.Width)
        {
            labelTesting.Left = labelTesting.Width * -1;
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:30:31.430

您需要停止计时器：

```
private void timer_Tick(object sender, EventArgs e)
{
        if (someConditionToEndScroll) // you decide when to stop scrolling
        {
           Timer timer = (Timer) sender;

           timer.Stop();
           labelTesting.Left = 0; // or wherever it should be at the end of the scrolling
        }

        this.Refresh();
        labelTesting.Left += 5;
        if (labelTesting.Left >= this.Width)
        {
            labelTesting.Left = labelTesting.Width * -1;
        }           
} 
```

# c# - Retrieve WPF Windows and children state and content from a compiled running assembly

> ID：15235714
> 
> 赞同：0
> 
> 时间：2013-03-05T22:53:17.573
> 
> 标签：c#, reverse-engineering

Sorry in advance for the title. I'm just - not - able to find the good terms to ask it.

With Winforms, I know it was possible with some P/Invoke and with Handles to recursively get visual informations from a program.

So, can I 'manually' recompose a screenshot from a WPF application by obtaining informations about the different Windows and children from this application?

That would be the equivalent of using several methods like this one: `static extern bool GetWindowRect(IntPtr hWnd, ref RECT lpRect);` to obtain Windows Forms information.

[EDIT] Actually, I'm trying to hack myself. I'm remotely compiling applications on my server using the CodeDom.Compiler, and I'm curious if it's possible to receive a textual stream (XML or XAML) of what is happening in my app. (I plan on wiring my web application to the server with SignalR.)

What I can do if there's no way to reverse it cleanly:

I can add a method inside the app that will constantly (maybe every 1 second or on a screenshot XOR difference, though it's cpu intensive) check for all windows (controls) informations (ActualHeight/Width and absolute coordinates) and stream it to a socket.

# java - 来自官方来源的最新一期 Java 样式指南/编码标准

> ID：15235717
> 
> 赞同：1
> 
> 时间：2013-03-05T22:53:38.720
> 
> 标签：java, coding-style, code-standards

我正在做一个处于初始阶段的项目，我正在制定一些编码标准和风格指南。我一直在为 Java 开发的一般编码标准、样式指南和最佳实践寻找一些好的资源。

我遇到了 Oracle 的官方编码约定，但它们似乎是从 1999 年开始的，所以我想知道是否有更新的东西。

FWIW，这是我找到的 Oracle 文档的链接： [http ://www.oracle.com/technetwork/java/codeconv-138413.html](http://www.oracle.com/technetwork/java/codeconv-138413.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:58:10.350

您找到的版本是最新的。该文件自 1999 年以来一直没有更新。

还有其他更新的风格指南，但没有来自 Oracle / Sun 的（公开的），也不是“官方的”。

# templates - FOSUserBundle 覆盖模板不适用于 EC2

> ID：15235722
> 
> 赞同：0
> 
> 时间：2013-03-05T22:53:51.027
> 
> 标签：templates, symfony, amazon-ec2, symfony-2.1, fosuserbundle

发生了一件非常奇怪的事情。我正在 OSX（`php 5.4.11`和 OSX 内置 Web 服务器（不是 PHP 的）上开发。我已经在 AWS EC2 上部署了我的代码，修复了权限`setfacl`并在开发模式下运行站点（如在 OSX 上）。

在 EC2 上，我正在运行`php 5.4.12`. 当我检查`config.php`它说`Your configuration looks good to run Symfony`

主页完美加载，但注册页面和登录页面未加载正确的模板（假设我的用户包覆盖了这些模板 - 它正在我的本地服务器上运行）。

最奇怪的是我已经覆盖了用户注册的表单类型，并且我可以看到我的附加字段。只是树枝没有选择正确的模板。

日志文件中没有任何内容可以真正帮助我（即使在调试模式下），error_log 中也没有任何内容。

我不知道去哪里调试这个，因为我不知道模板应该在什么时候被覆盖。

任何帮助，将不胜感激 ;）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:41:00.413

这听起来可能很愚蠢，但是 MacOS 有一个不区分大小写的文件系统，而在 Linux 上它是区分大小写的，所以请检查文件名。

# ravendb - How to use Raven LoadDocument

> ID：15235723
> 
> 赞同：3
> 
> 时间：2013-03-05T22:53:52.290
> 
> 标签：ravendb

I'm having trouble querying RavenDB with even the simplest of queries, probably I'm doing something wrong, but after a few hours I just can't see it anymore. I've googled almost anything I can think of..

I have these entities:

```
 public class User
    {
    public string Id { get; set; }
    public string DisplayName { get; set; }
    public string RealName { get; set; }
    public string Email { get; set; }
    public string PictureUri { get; set; }
    public List<Comment> Comments { get; set; } 

    public List<Role> Roles { get; set; }
 }

public class NewsItem
{
    public string Id { get; set; }
    public string Title { get; set; }
    public string Text { get; set; }
    public DateTime Created { get; set; }
    public string UserId { get; set; }
    public List<Tag> Tags { get; set; }
    public List<Comment> Comments { get; set; }
    public List<WebImage> Images { get; set; } 
 } 
```

I want to query these so I get a list of newsItems, but with the user information alongside it. So I read the docs and tried the LoadDocument feature, the index:

```
public class NewsItemIndexWithComments : AbstractIndexCreationTask<NewsItem, NewsItemIndexWithComments.Result>
{

    public class Result
    {
        public string AuthorName { get; set; }
    }

    public NewsItemIndexWithComments()
    {
        Map = newsItems => from newsItem in newsItems
                           select new
                           {
                               AuthorName = LoadDocument<User>(newsItem.UserId).DisplayName
                           };
    }
} 
```

Which I try to use like:

```
var result = _documentSession.Query<NewsItemIndexWithComments.Result, NewsItemIndexWithComments>().AsProjection<NewsItemIndexWithComments.Result>().ToList(); 
```

Now I get the number of documents in my list, but the AuthorName is always null. If I don't use the AsProjection method, I won't get any results. Can anyone show me a proper example on which I can experiment further?

Thanks.

*_* edit:

That helped a lot, thanks :) Now for step two, I'm sorry if I'm being a bit newbish, but you'll have to start somewhere. In the newsitems there are comments, in these comments there is another reference to the userid. You can probably guess what I want to do: I want the user info for the comments with the comments as well.

new Index:

```
public class NewsItemIndexWithComments : AbstractIndexCreationTask<NewsItem, NewsItemIndexWithComments.Result>
{

    public class Result : NewsItem
    {
        public string AuthorName { get; set; }
        public string AuthorId { get; set; }

    }

    public NewsItemIndexWithComments()
    {
        Map = newsItems => from newsItem in newsItems
                           let user = LoadDocument<User>(newsItem.UserId)
                           select new
                           {
                               AuthorName = user.DisplayName,
                               AuthorId = user.Id,
                           };
        Store(x => x.AuthorName, FieldStorage.Yes);
        Store(x => x.AuthorId, FieldStorage.Yes);
    }
} 
```

Comment class:

```
public class Comment
{
    public string Id { get; set; }
    public string Text { get; set; }
    public string UserId { get; set; }
    public string User { get; set; }
    public DateTime Created { get; set; }
} 
```

How can I query the comments and expand the results for that? Or is it better to create a new index just for the comments and get the user info analog to the solution above?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T23:51:27.163

你快到了，你只需要存储你正在投影的字段。将此添加到索引构造函数中，在地图之后。

```
Store(x=> x.AuthorName, FieldStorage.Yes); 
```

这是因为您希望它返回并可供`AsProjection`查找。如果您只想在 where 或 orderby 中使用作者姓名，则不需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-17T00:15:30.593

如果您只想在 AsProjection 中包含注释，您可以简单地索引整个对象。

请注意，为自定义对象编制索引意味着您无法使用`.Where()`. RavenDB 只能查询展平的结果（整数、小数、字符串、日期）。

例如，为了查询标题，您需要创建一个单独的 Property`public string Title { get; set; }`并将其映射到`Title = newsItem.Title`.

```
public class NewsItemIndexWithComments : AbstractIndexCreationTask<NewsItem, NewsItemIndexWithComments.Result>
{
public class Result : NewsItem
{
    public string AuthorName { get; set; }
    public string AuthorId { get; set; }
    public List<Comment> Comments { get; set; }

}

public NewsItemIndexWithComments()
{
    Map = newsItems => from newsItem in newsItems
                       let user = LoadDocument<User>(newsItem.UserId)
                       select new
                       {
                           AuthorName = user.DisplayName,
                           AuthorId = user.Id,
                           Comments = newsItem.Comments.
                       };
    Store(x => x.AuthorName, FieldStorage.Yes);
    Store(x => x.AuthorId, FieldStorage.Yes);
    Store(x => x.Comments, FieldStorage.Yes);
} 
```

}

# c#-4.0 - Convert to view model, EF Partial Class calculated property using related entities returns 0

> ID：15235725
> 
> 赞同：0
> 
> 时间：2013-03-05T22:54:04.450
> 
> 标签：c#-4.0, entity-framework-5

I am using EF 5 and have a new property that I've defined in a partial class to extend the base database fields. It requires summing data from a related table.

```
[Display(Name = "Qty Allocated")]
        public decimal QtyAllocated
        {
            get { return this.AllocatedContainers == null ? 1 : this.AllocatedContainers.Sum(a => a.AllocatedQty); }
            //get { return 2;}
        } 
```

This property returns the correct value....BUT, if I then use the following method to convert this to a view model, the returned value is 0\. Note the view model inherits from the class:

```
public class InventoryContainerDetailListViewModel : InventoryContainerDetail 
```

Method:

```
 public IEnumerable<InventoryContainerDetailListViewModel> ConvertClassToViewModel(IEnumerable<InventoryContainerDetail> entityList)
{
   IEnumerable<InventoryContainerDetailListViewModel> itemGrid =
        from l in entityList.ToList()
        select new InventoryContainerDetailListViewModel()
        {
            Id = l.Id,
            InventoryContainerHeaderId = l.InventoryContainerHeaderId,
            PONbr = l.ReceiptDetail == null ? (int?)null : l.ReceiptDetail.PODetail.POHeaderId,
            ReceiptDetailId = l.ReceiptDetailId,
            ItemId = l.ItemId,
            ItemDescription = l.Item.ShortDescription,
            QtyInContainer = l.QtyInContainer,
            //QtyAllocated = l.AllocatedContainers == null ? 0 : l.AllocatedContainers.Sum(a => a.AllocatedQty),
            Location = l.InventoryContainerHeader.Location.DisplayLocation
        };

    return itemGrid;
} 
```

In this method, the input parameter entityList does show each item with the correct calculated values, but after the conversion, the value is always 0.

I assume this has something to do with the fact that I am inheriting from the base class, but can someone shed some light on this?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T11:30:20.213

我不认为原因是继承。更可能的原因是`AllocatedContainers`空集合（在创建视图模型实例时没有分配它）。

# javascript - Javascript/jquery淡入淡出效果衰减

> ID：15235726
> 
> 赞同：0
> 
> 时间：2013-03-05T22:54:14.390
> 
> 标签：javascript, jquery, jquery-animate, fadein

这次非常具体，我有以下代码来根据条件循环一些淡入淡出，正如您所看到的动画状态略有不同。

目前它正在产生我想要的效果，但它似乎逐渐变慢，直到大约 3 分钟它完全停止。

我已经到了不能再盯着它看的地步了！谁能给我一些关于如何使它成为一个连续循环的建议？

这是一个小提琴：http: [//jsfiddle.net/CbNc5/](http://jsfiddle.net/CbNc5/)

```
var glimmerLen = 16;
var initiated = false;
var animateLoop = false;
var timeout;

function glimmerAnimate() {
if (!initiated) {
    timeout = window.setTimeout(function() {glimmerAnimate();}, 2500);
    initiated = true;

} else if (!animateLoop && initiated) {
    $("#glimmer li").fadeTo(1500, 0.5, function(){
        glimmerAnimate();
        animateLoop = true;
    });
} else if (animateLoop) {
    var rangeMax = glimmerLen + 1;
    var randObj = Math.floor(Math.random() * rangeMax);

    $("#glimmer-" + randObj).fadeTo(1500, 0.8, function() {
        $("#glimmer-" + randObj).fadeTo(2000, 0.2);
            glimmerAnimate();
    });
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:35:30.807

我已经重写了这个，希望对你有帮助（[http://jsfiddle.net/CbNc5/5/](http://jsfiddle.net/CbNc5/5/)）

```
function fadeLoop(e) {
    $(e).fadeTo(Math.random() * 500, 0.2, function () {
        $(this).fadeTo(Math.random() * 500, 1, function () {
            fadeLoop(this);
        });
    });
}

$('li').each(function () {
    fadeLoop(this);
}); 
```

PS如果你只想要循环不透明度，你可以使用CSS3，会更简单

# linux - 采购环境输出

> ID：15235729
> 
> 赞同：6
> 
> 时间：2013-03-05T22:54:19.890
> 
> 标签：linux, bash, shell, sh

我有一些需要调试的 shell 代码，所以我让代码将其环境转储到一个文件中

```
env > env.txt 
```

并使用我的测试脚本来获取它，test.sh：

```
. ./env.txt
echo $EXAMPLE
echo $EXAMPLE2 
```

env.txt 的内容是：

```
EXAMPLE=sh /hello/command.sh
EXAMPLE2=/just/some/path 
```

但是，env 没有在其值周围加上引号，这往往会导致 $EXAMPLE 出现问题，我收到此错误

test.sh：/hello/command.sh：未找到

很明显它正在尝试运行它而不是设置变量。

您认为解决此问题的最快方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T23:02:14.380

在将输出重定向到文件之前添加双引号：

```
env | sed 's/=\(.*\)/="\1"/' > env.txt 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-06T13:29:29.247

```
while read line; do
    declare "$line"
    # declare -x "$line"
    # export "$line"
done < env.txt 
```

如果要将值导出到环境，请改用`-x`to 选项`declare`或使用`export`命令。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:06:56.243

```
while read line; do
 var="${line%=*}"
 value="${line##*=}"
 eval "$var=\"$value\""
done <env.txt 
```

# exception-handling - AngularJS 中应用程序异常处理的推荐实践

> ID：15235731
> 
> 赞同：33
> 
> 时间：2013-03-05T22:54:49.337
> 
> 标签：exception-handling, angularjs

我目前正在探索在 AngularJS 中处理应用程序范围异常的可能方法。

我们真正想要避免的一件事是将应用程序的多个部分包装在嵌套的 try/catch 块中，但要干净利落地处理事情 - 即抛出异常以响应承诺。

*   有没有人以前讨论过这个问题并有任何建议？
*   关于如何在服务以及控制器/指令中获取异常的任何建议。（见下文 - 广播工作正常，但前提是您可以将侦听器附加到范围）。

**迄今为止的进展**

一些简短的设计目标：

*   允许在其他地方或可能在多个地方处理来自应用程序某一部分的异常（即“向用户显示错误通知”、“禁用小部件”）。
*   提供对常见错误情况的集中管理 - 即登录到服务器、向用户显示通知、重定向到登录。
*   允许从控制器、指令、服务等抛出异常。
*   最终允许本地化消息。

我的团队目前倾向于编写一个服务来处理异常，这将公开一系列简单的调用：

```
exceptionService.warn('exception_token');

exceptionService.crit('another_exception_token'); 
```

然后，该服务将格式化一个“异常”对象并从根范围广播它。这将允许默认处理程序监视任何广播并应用默认操作，并允许在其他范围内设置自定义侦听器，这可以处理更具体的条件 - 即禁用 UI 的一部分。

```
var exception = {
    token: 'exception_token',
    severity': 'crit'
};

// broadcast exception
$rootScope.$broadcast(
'application_exception',
    exception
); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-22T19:18:20.480

我最近也在考虑同样的问题，我突然想到，当涉及到 javascript 中的良好错误处理时，您使用的框架无关紧要，而 Angular 在其他东西上。我最近为一个 AngularJS 项目编写了一个这样的错误处理程序，但我这样做的方式可以在任何框架中使用。

这是完整的代码。您可以直接使用它，也可以根据需要进行修改...

```
 /*
Factory errorFact is to simplify error handling and reporting in other objects.
It supports detailed error output as a text string and into the browser's console.

Usage example:

A function that supports return of an error object would have the following declaration
as its very first line:

var e = errorFact.create("objectName.funcName", arguments);
- in this declaration we specify the full object + method name as the first string parameter,
- and as the second parameter we pass javascript's reserved variable called arguments, which
  provides reference to all of the function's parameters for logging.

When an error occurs, the function would return:

return e.error("Error description text");
 - this line will create and return a complete error context.

When a function that supports return of an error object makes a call into another
function that also supports the error context, then it can return the nested error
result by passing the embedded error to the current error object instead of the error
 text.

 Example:

 var e = errorFact.create("objectName.funcName", arguments);
 var data = callAnotherFunc(...); // calling a function that support an error object;
 if(data.isError){ // If an error was triggered;
    return e.error(data); // return that error from the current context;
 }

 The top-level code that calls an error-returning function would do verification
 and if an error occurred, log all its details into console (typically).

 Example:

 var data = getData(...);
 if(data.isError){
    data.log(); // Output all the error details into the browser's console;
 }
 */

"use strict";

app.factory("errorFact", function(){
    return {
        // creates a new error context;
        create: function(method, args){
            var result = {
                // initiates and returns the error context;
                error: function(msg){
                    this.info.isError = true;
                    if(msg.isError){
                        this.info.details.caller = msg;
                    }else{
                        this.info.details.msg = msg;
                    }
                    return this.info;
                },
                info:
                {
                    isError: false,
                    details: {},
                    log: function(){
                        if(this.isError){
                            console.error(this.format());
                        }
                    },
                    // formats complete error details into a text string;
                    format: function(){
                        if(this.details.caller){
                            var txt = this.details.caller.format();
                            txt += "\nCALLER: " + this.details.method + "(" + this.formatArguments() + ")";
                            return txt;
                        }
                        if(this.details.method){
                            return "Error calling " + this.details.method + "(" + this.formatArguments() + "): " + this.details.msg;
                        }else{
                            return this.details.msg;
                        }
                        return "";
                    },
                    // formats function argument details into a text string;
                    formatArguments: function(){
                        if(!this.details.args){
                            return "";
                        }
                        var params = "";
                        for(var i = 0;i < this.details.args.length;i ++){
                            if(params.length > 0){
                                params += ",";
                            }
                            var p = this.details.args[i];
                            if(p === undefined){
                                params += "undefined";
                            }else{
                                if(p === null){
                                    params += "null";
                                }else{
                                    if(typeof(p) == "object"){
                                        params += "Object";
                                    }else{
                                        params += p;
                                    }
                                }
                            }
                        }
                        return params;
                    }
                }
            };
            if(method){
                result.info.details.method = method;
            }
            if(args){
                result.info.details.args = args;
            }
            return result;
        }
    }
}); 
```

下面是一个工厂，展示了它是如何使用的：

```
 "use strict";

app.factory('moduleFact', ['errorFact', function(errorFact){
    return {
        // Locates existing module and expands its key Id references
        // into corresponding object references:
        // - If 'hintGroupId' is present, property 'hints' is added from
        //   the corresponding hint group.
        // - If 'repModules' is present, properties 'question' and 'refs'
        //   are added.
        // On success, return the expanded module object.
        // On failure, returns an error object.
        //
        // NOTE: Currently supports only the first value in repModules.
        expandModule: function(moduleData, moduleId){
            var e = errorFact.create("moduleFact.expandModule", arguments);
            if(!moduleData || !moduleData.modules || !moduleId){
                return e.error("Invalid parameters passed");
            }
            var mod = this.findModule(moduleData, moduleId);
            if(mod.isError){
                return e.error(mod);
            }
            var src = mod;
            if(mod.repModules){
                var repId = mod.repModules[0];
                if(!repId){
                    return e.error("Invalid repModules encountered");
                }

                ///////////////////////////////////////
                // temporary check to throw a warning:
                if(mod.repModules.length > 1){
                    console.warn("Multiple values in property repModules: " + JSON.stringify(mod.repModules) +
                        ", which is not supported yet (only the first value is used)");
                }
                ///////////////////////////////////////

                src = this.findModule(moduleData, repId);
                if(src.isError){
                    return e.error(src);
                }
            }
            if(src.question){
                mod.question = src.question;
            }else{
                return e.error("Question not specified");
            }
            if(src.refs){
                mod.refs = src.refs;
            }
            if(src.hintGroupId){
                var hg = this.findHintGroup(moduleData, src.hintGroupId);
                if(hg.isError){
                    return e.error(hg);
                }
                mod.hints = hg.hints;
            }
            return mod; // needed extra: expand attribute repModules
        },
        // Expands all the modules and returns the data;
        expandAllModules: function(moduleData){
            var e = errorFact.create("moduleFact.expandAllModules", arguments);
            if(!moduleData || !moduleData.modules){
                return e.error("Invalid parameters passed");
            }
            for(var i = 0;i < moduleData.modules.length;i ++){
                var result = this.expandModule(moduleData, moduleData.modules[i].id);
                if(result.isError){
                    return e.error(result);
                }
            }
            return moduleData;
        },
        // Locates and returns module by its Id;
        findModule: function(moduleData, moduleId){
            var e = errorFact.create("moduleFact.findModule", arguments);
            if(!moduleData || !moduleData.modules || !moduleId){
                return e.error("Invalid parameters passed");
            }
            for(var i = 0;i < moduleData.modules.length;i ++){
                if(moduleData.modules[i].id == moduleId){
                    return moduleData.modules[i];
                }
            }
            return e.error("Module with Id = " + moduleId + " not found");
        },
        // Locates and returns Hint Group by its Id;
        findHintGroup: function(moduleData, hintGroupId){
            var e = errorFact.create("moduleFact.findHintGroup", arguments);
            if(!moduleData || !moduleData.hintGroups || !hintGroupId){
                return e.error("Invalid parameters passed");
            }
            for(var i = 0;i < moduleData.hintGroups.length;i ++){
                if(moduleData.hintGroups[i].id == hintGroupId){
                    return moduleData.hintGroups[i];
                }
            }
            return e.error("Hint Group with Id = " + hintGroupId + " not found");
        }
    }
}]); 
```

因此，当您拥有这样的工厂时，您的高级代码（例如在控制器中）只会记录任何问题，如下例所示：

```
 "use strict";

app.controller('standardsCtrl', ['$scope', 'moduleFact', function($scope, moduleFact){

        var data = ...//getting data;
        var mod = moduleFact.expandAllModules(data);
        if(mod.isError){
            mod.log(); // log all error details into the console;
        }else{
            // use the data
        }
    });

}]); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-18T20:36:43.297

您可以重写 $exceptionHandler 以便将异常传递给您自己的中央服务以获取异常，但 $exceptionHandler 似乎只接收从您的控制器、指令等抛出的异常......但不适用于源自 ajax 调用的异常. 对于这些异常，您可以实现一个拦截器，如本页所述：

已编辑：链接永久失效。
[Archive.org 链接](https://web.archive.org/web/20140816030335/http://espeo.pl/authentication-in-angularjs-application/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-26T08:58:38.320

`centralized error handling function`为您的应用程序创建一个您的意见是什么

所以每当你的前端撕裂（角度，API调用，......）发生错误时，它就会执行，所以`no need to write`你的`error handling` `every time`

所以这是我的代码

```
(function () {
    'use strict';
    angular
        .module('app')
        .factory('$exceptionHandler', ExceptionHandler);

    ExceptionHandler.$inject = ['$injector']; //for minification 

    function ExceptionHandler($injector) {
        var $log, sweetAlert, $translate;

        return function exceptionHandler(exception, cause) {
            // Add DI here to prevent circular dependency
            $log = $log || $injector.get('$log');
            sweetAlert = sweetAlert || $injector.get('sweetAlert'); //19degrees.ngSweetAlert2
            $translate = $translate || $injector.get('$translate');
            // $loggerService = $loggerService || $injector.get('$loggerService');

            var title, message;
            title = $translate.instant('General error title');
            message = $translate.instant('General error message', { exceptionMessage: exception.message });
            sweetAlert.error(title, message);

            $log.error(exception, cause);
            // loggerService.logErrorsToBackend(exception, cause);
        };
    }
})(); 
```

我不确定这种方法是否被认为是最佳实践，但希望它对您有所帮助。

# c++ - 字符串和 unordered_map 运行缓慢

> ID：15235732
> 
> 赞同：1
> 
> 时间：2013-03-05T22:54:52.493
> 
> 标签：c++, stl, unordered-map, istream

这是我的代码中运行非常慢的 2 个函数。基本上我读入文档名称，打开文档，然后一次处理一个单词。我需要将文档拆分成句子，并给每个句子一个哈希表，表示单词在句子中出现的次数。我还需要跟踪所有新词，以及整个文档的哈希表。

当我现在在 10 个文档上运行我的代码时，这些文档总共有 8000 个单词和 2100 个 uniq 单词，运行大约需要 8000 多秒……每个单词几乎 1 秒。

你能告诉我需要多长时间`if(istream.good())`吗？

或者，如果您能知道什么时候延迟了我的代码。如果某个部分不清楚，请告诉我，我会提供帮助。

PS你可以在我有的代码中看到`start = clock()`并`end = clock()`评论它不断返回<1ms。这令人难以置信

```
void  DocProcess::indexString(string sentenceString, hash * sent){

stringstream iss;

string word;
iss.clear();
iss << sentenceString;

while(iss.good())
{

    iss >> word;
    word = formatWord(word);

    std::unordered_map<std::string,int>::const_iterator IsNewWord = words.find(word);

    if(IsNewWord == words.end())
    {
        std::pair<std::string,int> newWordPair (word,0);
        std::pair<std::string,int> newWordPairPlusOne (word,1);

        words.insert(newWordPair);
        sent->insert(newWordPairPlusOne);
    }
    else
    {
        std::pair<std::string,int> newWordPairPlusOne (word,1);
        sent->insert(newWordPairPlusOne);
    }
} 
```

} 无效 DocProcess::indexFile(string iFileName){

```
hash newDocHash;
hash newSentHash;
scoreAndInfo sentenceScore;
scoreAndInfo dummy;

fstream iFile;
fstream dFile;
string word;
string newDoc;
string fullDoc;
int minSentenceLength = 5;
int docNumber = 1;
int runningLength = 0;
int ProcessedWords = 0;
stringstream iss;

iFile.open(iFileName.c_str());

if(iFile.is_open())
{
    while(iFile.good())
    {
        iFile >> newDoc;
        dFile.open(newDoc.c_str());
        DocNames.push_back(newDoc);

        if(dFile.is_open())
        {
            scoreAndInfo documentScore;
            //iss << dFile.rdbuf();
            while(dFile.good())
            {
                //start = clock();
                dFile >> word;
                ++ProcessedWords;

                std::unordered_map<std::string,int>::const_iterator IsStopWord = stopWords.find(word);

                if(runningLength >= minSentenceLength && IsStopWord != stopWords.end() || word[word.length()-1] == '.')
                {

                    /* word is in the stop list, process the string*/
                    documentScore.second.second.append(" "+word);
                    sentenceScore.second.second.append(" "+word);

                    indexString(sentenceScore.second.second, &sentenceScore.second.first);

                    sentenceScore.first=0.0;
                    SentList.push_back(sentenceScore);
                    sentenceScore.second.first.clear(); //Clear hash
                    sentenceScore.second.second.clear(); // clear string
                    //sentenceScore = dummy;
                    runningLength = 0;
                }
                else
                {
                    ++runningLength;
                    sentenceScore.second.second.append(" "+word);
                    documentScore.second.second.append(" "+word);

                }
                //end = clock();
                    system("cls");
                    cout    << "Processing doc number: " << docNumber << endl
                        << "New Word count: " << words.size() << endl
                        << "Total words: " << ProcessedWords << endl;
                        //<< "Last process time****: " << double(diffclock(end,start)) << " ms"<< endl;

            }
            indexString(documentScore.second.second, &documentScore.second.first);
            documentScore.first=0.0;
            DocList.push_back(documentScore);
            dFile.close();
            //iss.clear();
            //documentScore = dummy;
            ++docNumber;
            //end = clock();
            system("cls");
            cout    << "Processing doc number: " << docNumber << endl
                << "Word count: " << words.size();
                //<< "Last process time: " << double(diffclock(end,start)) << " ms"<< endl;

        }
    }

    iFile.close();
}
else{ cout << "Unable to open index file: "<<endl <<iFileName << endl;} 
```

} `

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:58:35.960

你能不试试吗

```
 system("cls"); 
```

在任何循环中？这肯定没有帮助，这是一个昂贵的电话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T00:52:52.277

要快速清除屏幕，而不是`system("cls");`，请尝试`cout << '\f';`。

# c++ - 重载运算符 new / 分配超过对象大小

> ID：15235733
> 
> 赞同：2
> 
> 时间：2013-03-05T22:54:53.363
> 
> 标签：c++, operator-overloading, new-operator

我正在尝试重载我的类的运算符 new，我想为对象的属性和类中未定义的字符向量分配空间。

但是当我实例化一个新对象时，先前对象的字符正在改变。难道我做错了什么？

```
class StringData
{       
public:
    friend class String;
    int refCount;
    int len;
    int maxLen;
    ~StringData()
    {

    }
    StringData()
    {
        maxLen = 1000;
        len = 0;
        refCount = 1;
    }
    StringData(const char * string)
    {
        maxLen = 1000;
        char * data = buffer();

        len = 0;
        while (string[len] != '\0' && len < (maxLen - 1))
        {
            data[len] = string[len];
            len++;
        }
        data[len] = '\0';
        refCount = 1;
    }
    char* buffer()
    {
        return reinterpret_cast<char*>(this + 12);
    }

public:
    void* operator new(size_t size, int maxLen)
    {

        return ::operator new(size + round4(maxLen + 1));

    }
    static int round4(int len)
    {
        return ((((int) (len / 4)) + 1) * 4);
    }

    void operator delete(void* obj)
    {
        ::operator delete(obj); 
    }
    void operator delete(void* obj, int size) throw ()
    {
        ::operator delete(obj); 
    }
}; 
```

我在其他课程中使用它：

```
class String{
public:
    StringData * data;

    String(StringData * data){
        this->data = data;
    }
public:
    String(const char*);
    String(const String&);
    ~String();
    String& operator =(const String);
    String& operator =(const char *);
    int length() const;
    bool operator ==(const String&) const;
    int compare(const String&) const;
    bool operator ==(const char*) const;
    int compare(const char*) const;
    String& operator +(const String&) const;
    String operator +(const char*) const;
    String operator +=(const String&);
    String operator +=(const char*);
    String toLower();
    String toUpper();
    char operator [ ](int) const;
    char& operator [ ](int);
    void print() const; 
```

};

```
String::String(const char * string){
int stringLen = 0;

while (string[stringLen] != '\0')
    stringLen++;

data = new (stringLen + 1) StringData(string); 
```

}

```
String::String(const String& string){

data = string.data;
string.data->refCount++; 
```

}

```
String::~String(){
this->data->refCount--;
if (this->data->refCount == 0)
    delete data; 
```

}

```
String& String::operator=(const String string){
data->refCount--;
if (this->data->refCount == 0)
    delete data;
data = string.data;
string.data->refCount++;
return *this; 
```

}

`void String::print() const{ printf("%s\n", data->buffer()); }`

我的主要功能是：

```
int main(){
String *a = new String("boisahzashdacaraverdeepretaeazuleamarelaecinzaevermelha");
a->print();
String * s = new String("freestepehnoisquevoaashashashhasshashhasssasassadasd");
String * b = new String("kkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkkk");

a->print();
s->print();
return 0; 
```

}

当我执行时，字符串被破坏了：

boisahzashdacaraverdeepretaeazuleamarelaecinzaevermelha

boisahzashdacaraverd

无花果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:56:38.143

这不是一个好主意：

```
return reinterpret_cast<char*>(this + 12); 
```

如果您添加/删除一些成员函数[或创建一个虚拟函数]，它不仅会失败，而且它还取决于`int`.

利用

```
return reinterpret_cast<char*>(this) + sizeof(*this); 
```

[注意 reinterpret_cast<>() 末尾的新位置！！] 第一个版本`12 * sizeof(*this)`向前跳过，而不是`12`字节。[当然，在我的机器上，当我使用 maxLen 的 4* 乘数时，它确实有效——当我删除它时它才开始失败]

这可以简化：

```
((((int) (len / 4)) + 1) * 4); 
```

这是否应该比 maxlen 大 4 倍：

```
(4 * maxLen) 
```

至：

```
4 * (len / 4 + 1); 
```

一旦我知道有关如何测试的评论的答案，我将返回对此答案的编辑。

# class - Scala子类字段仅在成员函数中隐藏超类var

> ID：15235740
> 
> 赞同：1
> 
> 时间：2013-03-05T22:55:20.003
> 
> 标签：class, scala, abstract-class

我很难找到这个错误，似乎类*Icon的字段**pos*隐藏了类*Element*的*pos*字段，仅在*绘图*函数中。

 ***```
case class Vector2(val x: Float, val y: Float) { ... }

abstract class Element(var pos: Vector2) {
    def draw(): Unit
}

class Icon(pos: Vector2, var texture: String) extends Element(pos) {
  override def draw() {
    ...
    GL11.glTranslatef(pos.x, pos.y, 0f)
    ...
  }
} 
```

稍后的：

```
// Create an icon with an initial position
val icon = new Icon(pos = Vector2(40,20), "crosshair")

// Draw all elements
elements.foreach{_.draw()} // => draws icon at (40,20)

// Setting a new position for icon
icon.pos = Vector2(100,200)

// See if it worked
Log.info(icon.pos.toString()) // => this prints Vector2(100,200)

// Draw all elements
elements.foreach{_.draw()} // => still draws icon at (40,20) 
```

我看过[这篇文章](https://stackoverflow.com/questions/6656868/why-cant-i-assign-to-var-in-scala-subclass)并尝试过：

*   在基类中使 var 抽象：这可以防止我为 Element 设置新的 pos
*   重命名构造函数参数（例如_pos）：我不会这样做，因为这会搞砸API
*   覆盖派生类中的 var：只是编译器告诉我不能覆盖可变变量

出路是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:11:32.977

只需明确取消引用`this`：

```
class Icon(pos: Vector2, var texture: String) extends Element(pos) {
  override def draw() {
    ...
    GL11.glTranslatef(this.pos.x, this.pos.y, 0f)
    ...
  }
} 
```

鉴于阴影只发生在 内部`Icon`，其他任何地方（包括在派生类中）您可以继续使用`pos`（不需要`this.pos`）。

**更新**：不用等待，这不起作用！我称之为编译器错误。似乎即使它们不应该（恕我直言）是同一件事，`this.pos`也被视为一样。`pos`不过有一个简单的解决方法：

```
class Icon(pos: Vector2) extends Element(pos) {
  private def self = this
  override def draw() {
    println(self.pos.x, self.pos.y, 0f)
  }
} 
```

* * *

**更新 2**：这是对评论的回复，不适合其他评论。

兰德尔舒尔茨 说：

> 我不相信这是一个错误。

好吧，它看起来确实像是一个错误，或者至少是我想要说明理由的不一致之处。

首先要注意的是，在我上面的工作中，`self eq this`. 它们确实指向相同的引用，此外还具有相同的静态类型。那么为什么会返回两个不同的`self.pos`东西`this.pos`（不管返回的“正确”东西是什么）？换句话说，`self`是 的别名`this`，并且别名的行为必须都相同。

现在，我认为`this.pos`应该表示变量 in`Element`而不是`Icon`构造函数的参数的原因很简单。这个参数前面没有，`val`因此实际上只是一个参数（不是 a `val`）。因此，`Icon`仅由于词法作用域，它才可以在课堂上访问。它**不是**的成员`Icon`，甚至不是私有的（在引擎盖下生成私有字段的事实不会改变语言的语义）。如果`pos`参数不是成员，则没有理由`this.pos`应该退回它。显然，这个论点归结为参数是否也是类的成员。对我来说显然不是，但如果实际上它应该自动成为成员（我仍在查看规范中是否提到这一点），那么`self.pos`返回参数的值而不是当前的值确实是合乎逻辑的基类中 var 的值（但这仍然不能解释如何`self.pos`以及`this.pos`可能意味着不同的事情）。

> 这就是存在自我类型（使用除此之外的名称的（通常）不受约束的种类）存在的原因之一。

嗯，不。自我类型无关紧要。不受约束的自类型只是引入了一个别名，因此别名指向相同的引用`this`（如果不受约束，则具有相同的静态类型）。所以使用别名应该不会改变返回的内容。实际上，它没有：

```
class Icon(pos: Vector2) extends Element(pos) { self =>
  override def draw() {
    println(self.pos.x, self.pos.y, 0f)
  }
}
val icon = new Icon(Vector2(1, 2))
icon.draw() // prints "(1.0,2.0,0.0)" as expected
icon.pos = Vector2(3, 4)
icon.draw() // oops, still prints "(1.0,2.0,0.0)"! 
```

如您所见， self 类型没有帮助：`self.pos`仍然指向参数而不是变量。要解决此问题，您可能会尝试显式键入`self`：`Element`

```
class Icon(pos: Vector2) extends Element(pos) { self: Element => 
```

但这并没有改变任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T00:55:26.327

构造函数参数在类体中是可见的，这就是事情的工作方式。有一个私人 val 影子一个公共 var 是很奇怪的，我同意你，但就是这样。在您展示的特定代码段中，您可以执行以下操作：

```
abstract class Element {
  def pos: Vector2
  def pos_=(x: Vector2): Unit
  def draw(): Unit
} 
```

进而

```
class Icon(var pos: Vector2, var texture: String) extends Element {
  override def draw() {
    ...
    GL11.glTranslatef(pos.x, pos.y, 0f)
    ...
  }
} 
```

但是，如果您只想使用一个值进行初始化，而不是在扩展的任何内容上`Element`声明 a ，这将无济于事。我自己的建议是避免使用构造函数，使用类似的东西，并在正文中初始化。`var``Element``var``initialPos``var`***

# java - 近似合适的图像大小

> ID：15235743
> 
> 赞同：3
> 
> 时间：2013-03-05T22:55:43.180
> 
> 标签：java, c, image, algorithm, pseudocode

我的目标是从给定数量的尺寸中选择最合适的图像尺寸。

给定一些相当随机的分辨率，我想找到一个尺寸尽可能接近我首选尺寸的图像。

假设我想使用尺寸为宽 x 高 ( `preferredImageSize`) 的图像。

示例：320x200

假设我可以使用以下图像尺寸 ( `availableImageSize`) width1 x height1, width2 x height2, ...（可能多达 10 种不同的尺寸）。

示例：474x272、474x310、264x150、226x128、640x365、474x410、480x276、256x144、160x90、320x182、640x365、192x108、240x137、480x276

为了开发一些通用的方法来制作`preferredImageSize`变量，我试图找到一个很好的解决方案，它计算得相当快，但也会产生*在屏幕上看起来不错的*东西。

我将*在屏幕上看起来不错*的图像定义为：

1.  几乎没有升级
2.  尽可能接近给定的纵横比 ( `preferredImageSize.width / preferredImageSize.height`)
3.  可能会大幅缩减
4.  可能会被裁剪/拉伸非常少量

我最初的（相当微不足道的）方法：

遍历可用的图像尺寸一次并找到最小的宽度增量 ( `abs(preferredImageSize.width - availableImageSize.width)`)。然后选择具有最小增量的图像 ( `bestFitWidth`)。

那当然是解决问题的一种方法，但绝对不符合我*在屏幕上看起来不错的*希望。

任何提示，无论是文本、来源还是链接都会很棒。哦，如果您认为我的要求（又名希望）已经导致错误的方向，请继续，让我知道...

* * *

编辑：添加裁剪和拉伸作为选项 - 恐怕这会使问题更难解决。因此，如果需要，请将其排除在等式之外。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:13:46.263

**简单的“如果/那么”方法：**

我会做两件事：

1.  由于您宁愿不放大，但可以缩小尺寸（我发现这是一个不错的选择），因此切勿使用小于目标的源图像，除非没有可用的图像。
2.  由于“大量”缩小是可以的，我会尝试找到一个尽可能匹配纵横比的图像，从可接受的最小图像开始，然后逐渐变大。

把它放在一起，首先从列表中丢弃所有小于目标的图像。然后，从剩下的最小图像开始，检查其与目标的纵横比。如果不匹配是可以接受的（您需要量化），请使用图像，否则转到下一个更大的图像。如果您没有找到任何可接受的，请使用最匹配的那个。

如果您已经丢弃了所有小于目标的图像，那么无论哪种方式，您最终都可能会得到一个看起来很糟糕的图像，但是您应该尝试使用需要更多放大的图像是否更糟，或者是否使用更糟糕的纵横比匹配的图像更糟糕。

您需要考虑的另一件事是您是否要拉伸或裁剪图像以匹配您的目标纵横比。

**更复杂的定量方法：**

不过，最灵活的方法是为自己定义一个“惩罚”函数，该函数取决于大小不匹配和纵横比不匹配，然后找到给您最低“惩罚”的源图像。这是您当前所做的，并且您已将惩罚函数定义为`abs(preferredImageSize.width - availableImageSize.width)`. 您可以使用更复杂的东西，例如：

```
width_diff  = preferredImageSize.width  - availableImageSize.width
height_diff = preferredImageSize.height - availableImageSize.height
if (width_diff > 0) width_penalty = upscale_penalty   * width_diff
               else width_penalty = downscale_penalty * width_diff
if (height_diff > 0) height_penalty = upscale_penalty   * height_diff
                else height_penalty = downscale_penalty * height_diff
aspect_penalty = ((preferredImageSize.width / preferredImageSize.height) - 
                  (availableImageSize.width / availableImageSize.height)) * stretch_penalty;
total_penalty = width_penalty + height_penalty + aspect_penalty; 
```

现在您可以使用 3 个数字`upscale_penalty`, `downscale_penalty`, 并`stretch_penalty`赋予这三个降低质量的操作不同的重要性。只需尝试几种组合，看看哪种效果最好。

# c# - 如何找出被测应用程序中打开窗口的数量

> ID：15235744
> 
> 赞同：1
> 
> 时间：2013-03-05T22:55:44.070
> 
> 标签：c#, ui-automation, coded-ui-tests

我正在使用编码的 ui 来进行自动化我需要计算为测试用例打开了多少个窗口，但不知道该怎么做。已经尝试使用 find 和 get the applicationundertest 并走孩子们，但似乎窗户不属于它。

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:12:36.093

大多数 UI 框架都有一组打开的窗口。

窗体：

```
int count = Application.OpenForms.Count; 
```

> 包含此应用程序拥有的所有当前打开的表单的 FormCollection。

WPF：

```
 int count = Application.Current.Windows.Count; 
```

> 只要在用户界面 (UI) 线程上实例化窗口，就会自动将窗口引用添加到 Windows；不添加由工作线程创建的窗口。Window 引用在其 Closing 事件被处理后且在其 Closed 事件引发之前被自动删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:58:46.550

只需在主实例中创建一个静态 int 并在所有表单构造函数中计数，并在 FormClosing 事件中计数

也许这个简短的代码会有所帮助

```
this.Load += delegate { mainInstance.myCount++; };
this.FormClosing += delegate { mainInstance.myCount--; }; 
```

# azure - 将“已添加”文件夹添加到解决方案？

> ID：15235746
> 
> 赞同：0
> 
> 时间：2013-03-05T22:55:47.043
> 
> 标签：azure, asp.net-mvc-4, visual-studio-2012, solution

我在 MVC4 解决方案中创建了几个 App_LocalResource 文件夹以及许多 resx 文件。但是，当 Web 部署到 Azure 时，它​​们不会在更改集中被识别/找到/列出。没有任何文件夹被推送到 Azure。我无法将它们添加到解决方案中，因为它们已经存在？我通过VS创建了文件夹，所以我想它们包含在创建解决方案中。

我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T03:16:44.433

您需要将每个 .resx 文件的“复制到输出目录”属性设置为“如果较新则复制”或“始终复制”。如果您不更改 App_LocalResources 文件夹中任何 .resx 文件的此属性，则整个文件夹不会显示在生成的云服务包中，也不会出现在 Project/csx/Debug/roles 中/rolename/approot/bin 文件夹，当您在本地调试时。当您在不更改每个 .resx 文件的“复制到输出目录”属性的情况下部署包时，通过 Web 部署上传时，它们不会包含在您的服务包中。

此外，从可维护性的角度来看，我建议研究使用 Azure Tables 而不是 .resx 文件。它们在部署环境中更加灵活，因为如果需要，可以在运行时更改表实体，而无需重新部署。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T10:05:50.463

我`Build Action`将 resx 文件更改为`Content`而不是`Embeded Resource`. `Embeded Resource`将资源编译到您无法以通常方式访问的 dll 中。

# .htaccess - .htaccess 文件不重定向 url

> ID：15235749
> 
> 赞同：0
> 
> 时间：2013-03-05T22:55:49.373
> 
> 标签：.htaccess, cpanel

我有这个 .htaccess 文件，它只是将 URL 从主链接重新路由`http://www.mywebsitename.com/somepage.php?id=some_id`到`http://www.mywebsitename.com/somepage/some_id`

这是代码 -

```
 RewriteEngine on
 RewriteBase /
 RewriteCond %{HTTP_HOST} !^www.ashurocks.in$
 RewriteRule ^(.*)$ http://www.ashurocks.in/$1 [R=301]
 RewriteCond %{REQUEST_FILENAME} !-f
 RewriteCond %{REQUEST_FILENAME} !-d
 RewriteRule ^user/([a-zA-Z0-9]+)$ /user.php?u=$1 [QSA]
 RewriteRule ^group/([a-zA-Z0-9]+)$ /group.php?id=$1 [QSA]
 RewriteRule ^article/([a-zA-Z0-9]+)$ /article.php?id=$1 [QSA] 
```

它工作正常，我能够获得内容。但是现在，它不起作用。每当我访问该 URL`http://www.mywebsitename.com/somepage/some_id`时，它都不会将我重定向到`http://www.mywebsitename.com/somepage.php?id=some_id`.

这个 .htaccess 文件代码有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:15:42.160

好，我知道了。

我只是`Options +FollowSymLinks -MultiViews`在行前使用`RewriteEngine on`它解决了我的问题

# visual-studio-2012 - 在使用 CRM 2011 SDK 在 Visual Studio 2012 中创建 XAML 工作流活动时找不到资源 workflowdesigner.xaml

> ID：15235750
> 
> 赞同：2
> 
> 时间：2013-03-05T22:55:50.373
> 
> 标签：visual-studio-2012, dynamics-crm-2011

我已经为 Visual Studio 2012（终极版）安装了 CRM 2011 SDK 插件，并且正在尝试创建 XAML 工作流活动

我已使用这些说明将 CRM 工作流项目添加到工具箱中[将 Microsoft Dynamics CRM 工作流活动添加到工具箱](http://msdn.microsoft.com/en-us/library/fb513e3f-3ed8-44fe-8d4c-e1a8aef29870#add_to_toolbox)

当我尝试在设计表面上放置工作流时，它会以红色文本显示“无法为工作流生成视图”

将鼠标悬停在文本上会显示一个 System.IOException，上面写着“无法找到资源 workflowdesigner.xaml”

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T22:39:40.677

您可能需要参考 VS 中的程序集。这有点痛苦，但却是一种健康的行为。在 VS12 中（终于，十年后）从另一个项目复制引用和（真的，真的终于）同时引用多个 DLL 变得更容易了。

这是最佳实践，更喜欢行为。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-21T16:03:18.873

Ondra 是正确的，这是最新版本的 SDK 的问题。microsoft.xrm.sdk.workflow.dll 版本 5.0.9690.3448 不起作用，而版本 5.0.9688.1533 不存在此问题。

我在以前没有问题的 XAML 工作流上出现了这个问题，结果证明问题是 SDK 文件的升级。

Visual Studio 2012 Update 2 对此问题没有任何影响。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:47:12.987

我通过将我的 CRM SDK bin 目录（大约 24 个程序集）的内容转储到 C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\PublicAssemblies 来解决这个问题

不优雅，但显然在某个地方存在依赖关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T18:41:03.747

VS 下的此示例（以及整个 CRM 工作流程）仅适用于 CRM SDK 版本 1.0 - 最新版本 1.1 和 VS 2012 版本导致所描述的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-20T07:25:41.690

好的，我也遇到了这个问题，并根据你的提示让它工作，我得到了这个结果：

1.  更改 VisualStudio 版本没有效果。
2.  更改 SDK 版本确实有效！

我正在使用带有 Visual Studio 2015 和 2017 的 7.0.0.43 版本的 CRM 2015 SDK。您可以直接下载它或将 Nuget 用于“Microsoft.CrmSdk.Workflow”和“Microsoft.CrmSdk.CoreAssemblies”

2018 (8.0.0) 和 Dynamics 365 (8.2.0.49) 的 SDK 不起作用。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-05-24T10:28:16.637

Visual Studio 2012 Update 2 也修复了这个问题

# php - file_get_contents 停止在 217 个条目

> ID：15235751
> 
> 赞同：0
> 
> 时间：2013-03-05T22:55:55.287
> 
> 标签：php, sql, file-get-contents

我有以下代码用于从站点中提取数据并将其放入 sql 数据库中。它停止在 217 个条目，但有 619 个不同的页面。无论我回显到屏幕还是将其存储在数据库中，它都会失败。没有错误信息。

知道为什么吗？

```
for($i = 1; $i <= 619; $i++) {

$str = file_get_contents('http://fantasy.mlssoccer.com/web/api/elements/'.$i.'/');
$jsonarray = json_decode($str, true);

//get row data and store in variables
$id = $jsonarray['id'];
$name = addslashes($jsonarray['web_name']);
$team = $jsonarray['team_name'];
$pos = $jsonarray['type_name'];
$flag = $jsonarray['status'];
$cost = ($jsonarray['now_cost']/10);
$ownedby = $jsonarray['selected'];
$balance = $jsonarray['transfers_balance'];

$playerupdate = mysql_query("
INSERT INTO playerprices (id, name, team, pos, flag, cost, ownedby, balance) 
VALUES ('$id', '$name', '$team', '$pos', '$flag', '$cost', '$ownedby', '$balance') 
ON DUPLICATE KEY UPDATE flag = '$flag', cost = '$cost', ownedby = '$ownedby', balance = '$balance'") 
or die (mysql_error());

} 
```

当我只回显第 216-220 页的变量时，它们都工作正常，所以我认为这与这些页面上的数据无关。我看不到任何特殊字符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:59:18.933

要摆脱错误（启用[`display_errors`](http://php.net/manual/en/function.ini-set.php)查看），

> 致命错误：第 5 行 C:\xampp\htdocs\stackoverflow\file_get_contents.php 中的最大执行时间超过 30 秒

尝试将[`max_execution_time`](http://www.php.net/manual/en/info.configuration.php#ini.max-execution-time)时间增加到 5-10 分钟。

```
ini_set('max_execution_time', 1000); //300 seconds = 5 minutes 
```

或者通过[`command line`](http://davidwalsh.name/php-command-line).

> **从命令行**运行 PHP 时，默认设置为**0**。（来源：[`PHP.net`](http://www.php.net/manual/en/info.configuration.php#ini.max-execution-time)，2012）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:14:47.983

如果在您的数据中的任何一点，有一个或多个单引号，您的查询将失败并触发该`die()`语句。您可以清理每个变量以删除或替换这些字符，或者您可以远离已弃用的 mysql_* 函数并使用带有 mySQLi 或 PDO 的参数化查询。这表示：

1.  您不必从输入中清除特殊字符。
2.  您的代码将不太容易受到 SQL 注入的影响。
3.  在最新版本的 PHP 中，您的代码不会生成 E_DEPRECATED 消息。
4.  删除这些函数后，您的代码不会在 PHP 的未来版本中中断。
5.  最重要的是，人们会停止无休止地喋喋不休地谈论您使用的功能，而忽略您的实际问题。

# interpolation - 具有分散数据的二维双三次样条

> ID：15235758
> 
> 赞同：1
> 
> 时间：2013-03-05T22:56:36.067
> 
> 标签：interpolation, spline, alglib

是否有任何库 (DLL) 或 c# 代码允许插入 2D 分散数据？Algib 相当不错，但适用于常规网格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-18T09:45:47.453

[Alglib fastrbf](http://www.alglib.net/interpolation/fastrbf.php) 有 2 种算法：

1.  “RBF-ML 可用于解决两类问题：插值问题和具有可控噪声抑制的平滑问题”
2.  “RBF-QNN 使用自动半径选择。”

（我也没有使用过，而且 [高斯 RBF 往往是病态的](https://scicomp.stackexchange.com/questions/7561/do-rbf-kernel-matrices-tend-to-be-ill-conditioned)，但文档看起来很合理。）

请添加标签“alglib”。

# node.js - 从代理服务器获取响应

> ID：15235763
> 
> 赞同：5
> 
> 时间：2013-03-05T22:56:49.543
> 
> 标签：node.js, node-http-proxy

我使用 node-http-proxy 模块在 node.js 中创建了一个代理服务器。

看起来像这样：

```
var http = require('http'),
httpProxy = require('http-proxy'),
io = require("socket.io").listen(5555);

var proxy = new httpProxy.RoutingProxy();

http.createServer(function (req, res) {
     proxy.proxyRequest(req, res, {
         host: 'localhost',
         port: 1338
     });
}).listen(9000); 
```

因此，我需要在将响应发送回客户端之前从我代理的服务器获取正文并对其进行分析。

但是我找不到可以获取此数据的事件或属性。我试过了：

```
proxy.on('end', function (data) {
    console.log('end');
}); 
```

但我不知道我们如何从中获得哑剧体。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-11-21T11:46:58.290

如果您只想检查响应（只读），您可以使用：

```
proxy.on('proxyRes', function(proxyRes, req, res){

    proxyRes.on('data' , function(dataBuffer){
        var data = dataBuffer.toString('utf8');
        console.log("This is the data from target server : "+ data);
    }); 

}); 
```

但是，请注意，发送响应后会发出“proxyRes”事件。

参考： [https ://github.com/nodejitsu/node-http-proxy/issues/382](https://github.com/nodejitsu/node-http-proxy/issues/382)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-06T06:25:50.820

我找到了答案：我重写了 body 的响应函数 -

```
var http = require('http'),
    httpProxy = require('http-proxy'),
    io = require("socket.io").listen(5555);

var proxy = new httpProxy.RoutingProxy();

http.createServer(function (req, res) {
    console.log(req.url);
    res.oldWrite = res.write;
    res.write = function(data) {
        /* add logic for your data here */
        console.log(data.toString('UTF8'));
        res.oldWrite(data);
    }

    proxy.proxyRequest(req, res, {
        host: 'localhost',
        port: 1338
    });

}).listen(9000); 
```

此代码将控制来自此端点的所有 url 请求和响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-02-11T06:43:01.097

根据@Psycho 的回答，以下代码也可用于修改标头

```
var server = http.createServer(function(req, res) {

res.oldWrite = res.write;
res.write = function(data) {
    console.log(data.toString('UTF8'));
    res.oldWrite(data);
}

res.oldSetHeader = res.setHeader
res.setHeader = function(k,v) {
    console.log(k,v)
    res.oldSetHeader(k,v)
}

proxy.web(req, res, { target: proxyPool[key]}); }) 
```

# installshield-le - 安装 Shield 限量版设置（回滚）

> ID：15235766
> 
> 赞同：0
> 
> 时间：2013-03-05T22:57:01.103
> 
> 标签：installshield-le

我刚刚使用 Install Shield Limited edition 创建了一个安装程序。我的 Install shield 项目编译没有任何错误。但是，当我运行安装文件时，将程序文件复制到目标文件夹后，安装程序开始回滚并删除安装文件夹。

我还没有提出任何自定义操作或定义任何先决条件。

有没有人遇到过这样的问题？

我在安装程序中所做的一切如下：

1.  使用 Install shield 的“Files”选项在“Program files (x86)”目录下创建目录结构。
2.  使用“Internet 信息服务”选项在其下创建网站和应用程序。

我在这篇文章中附上了网络应用程序和网站的设置。

将不胜感激任何投入。

> InstallShield 17:29:09：SetAspversion：机器是 64 位，并且 IIS 在当前选择的模式之外的位模式下运行
> **InstallShield 17:29:09：IISRT 出错：-2172 CustomAction ISIISInstall 返回实际错误代码 1603（注意这一点如果翻译发生在沙箱内，则可能不是 100% 准确）操作于 17:29:09 结束：InstallFinalize。返回值 3.**
> MSI (s) (7C:E0) [17:29:09:312]：用户策略值“DisableRollback”为 0
> MSI (s) (7C:E0) [17:29:09:312]：机器策略值 'DisableRollback' 为 0
> MSI (s) (7C:E0) [17:29:09:319]: 执行 op: Header(Signature=1397708873,Version=500,Timestamp=1113951137,LangId=1033,Platform= 0,ScriptType=2,ScriptMajorVersion=21,ScriptMinorVersion=4,ScriptAttributes=1)
> MSI (s) (7C:E0) [17:29:09:319]：执行操作：DialogInfo(Type=0,Argument=1033)
> MSI (s) (7C:E0) [17:29:09:319] : 执行操作: DialogInfo(Type=1,Argument=MyApplication)
> MSI (s) (7C:E0) [17:29:09:319]: 执行操作: RollbackInfo(,RollbackAction=Rollback,RollbackDescription=回滚操作:, RollbackTemplate= [1](https://i.stack.imgur.com/0TXvm.gif) ,CleanupAction=RollbackCleanup,CleanupDescription=删除备份文件,CleanupTemplate=文件: [1](https://i.stack.imgur.com/0TXvm.gif) ) 操作 17:29:09: 回滚。回滚操作：回滚：ISIISInstall
> MSI (s) (7C:E0) [17:29:09:321]：执行操作：ActionStart(Name=ISIISInstall,,)
> MSI (s) (7C:E0) [17:29:09:321]：执行操作：ProductInfo(ProductKey={95199403-696F-4BF6-A443-19866156E3BD},ProductName=My Application,PackageName=My Application.msi, Language=1033,Version=16777216,Assignment=1,ObsoleteArg=0,ProductIcon=ARPPRODUCTICON.exe,,PackageCode={F3B9DBEB-71D6-42C3-B18C-1C5CCBA647E0},,,InstanceType=0,LUASetting=0,RemoteURTInstalls=0 ,ProductDeploymentFlags=3) 回滚：复制新文件

![网站](../Images/0bb1e2107ed403e1506a7e6b9ea010b2.png) ![在此处输入图像描述](../Images/a6174eb2ec7bedc0e992069920732180.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:24:23.370

终于找到了解决上述问题的方法。

Error with IISRT: -2​​172 是因为在 IIS 中设置了应用程序池（应用程序池）。

名为“启用 32 位应用程序”的属性设置为`False`。当我将其值更改为 时`True`，安装程​​序能够成功完成安装而无需回滚。

问题解决了 ：）

# ruby-on-rails - 使用 capybara、phantomjs 和 rails 在子域上测试 javascript

> ID：15235767
> 
> 赞同：11
> 
> 时间：2013-03-05T22:57:01.230
> 
> 标签：ruby-on-rails, capybara, phantomjs, subdomain

**解决方案**

这行得通。主要的本质是我必须在登录表单中手动设置和登录`Capybara.server_port`。除非在变量中声明，否则不能使用动态子域进行设置。所有网址都必须进行硬编码。`Capybara.app_host``Capybara.app_host`

```
require 'spec_helper'

feature 'customer' do

    let(:user)        {FactoryGirl.create(:user)}
    let(:firm)        {user.firm} 
    let(:customers)   {"http://#{firm.subdomain}.lvh.me:31234/customers"} 
    let(:root_url)    {"http://#{firm.subdomain}.lvh.me:31234/"}
    before(:all) do 
      Capybara.server_port = 31234 
      sub = firm.subdomain
      Capybara.app_host = root_url 
    end
   def sign_in_on_js
    visit root_url
    fill_in "Email", :with => user.email
    fill_in "Password", :with => "password"
    click_button "Sign in"
    page.should have_content("Signed in successfully.") 
   end

  scenario "make new", js: true do
    sign_in_on_js
    visit customers
    page.should have_content("Add new customer")       
    find("#dialog_customer").click
    page.should have_content("Create new customer") 
  end 
end 
```

**原始问题** 我正在 Rails 中制作多租户应用程序。会有很多 javascript。但是，我无法让测试正常工作。

当不运行时，`:js = true` 一切正常。问题出现在像这样的规格中

```
 let(:customers)  {"http://#{firm.subdomain}.lvh.me:3003/customers"} 
 scenario "Statistics select", :js => true do 
   visit customers
   page.should have_content("Add new customer")
 end 
```

capybara 的 poltergeist 网络驱动程序找不到 url 并返回一个空白页面

```
Failure/Error: page.should have_content("Add new customer")
       expected there to be text "Add new customer" in "" 
```

我的 spec_helper.rb 中有这个

```
require 'capybara/rspec'
require 'capybara/poltergeist'
Capybara.javascript_driver = :poltergeist
Capybara.register_driver :poltergeist do |app|
  Capybara::Poltergeist::Driver.new(app, :debug => true)
end 
```

Poltergeist 和 phantomjs 试图交付。我得到这个输出

```
{"name"=>"set_debug", "args"=>[true]}
{"response"=>true}
{"name"=>"visit", "args"=>["http://subdomain2.lvh.me:3003/statistics"]}
poltergeist [1362522132943] state default -> loading
{"response"=>{"status"=>"fail"}} 
```

我是否需要在测试期间运行服务器才能完成这项工作？

我尝试过 selenium 和 capybara-webkit，但 phantomjs 最接近成功。

我也尝试以不同的方式更改主机文件（可能不正确）

欢迎任何有关设置的提示！

**更新**

开始绝望了。我现在启动 Rails 服务器

```
rails s -e test -p 3001 
```

然后运行我的测试。

现在我被重定向到登录页面。我在规格中有这个

```
before(:each) do
  login_as(user, :scope => :user) 
end 
```

我如何在 Rails 测试服务器上登录测试用户，而无需手动完成每个规范的登录过程

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-08T21:47:24.977

Capybara 已经为您启动了一个服务器，引用[文档](https://github.com/jnicklas/capybara/blob/master/README.md#transactions-and-database-setup)：

> 一些 Capybara 驱动程序需要针对实际的 HTTP 服务器运行。Capybara 会处理这个问题，并在与您的测试相同的过程中为您启动一个，但在另一个线程上。Selenium 是这些驱动程序之一，而 RackTest 不是。

在您的测试中，您可以使用`visit`带有相对 url 的方法，例如：

```
visit("/statistics") 
```

Capybara 将把这个请求定向到它刚刚为这个测试启动的服务器。

当您想在测试中使用绝对 url 时，您可以，但您还应该指定服务器正在运行的端口。此端口在测试期间是随机选择的。一些驱动程序有一种方法可用于检索端口号。

例如，当您使用 Capybara-Webkit 驱动程序时：

```
Capybara.current_session.driver.server_port 
```

对于`visit`绝对网址，您可以使用：

```
port_number = Capybara.current_session.driver.server_port
visit("http://127.0.0.1:#{port_number}/statistics") 
```

在测试规范中，一种方法`login_as`可能行不通。您必须通过几个简单的步骤登录。例如：

```
before(:each) do
  visit "/login"
  fill_in "Email", :with => "my@email.com"
  fill_in "Password", :with => "secret"
  click_button "Login"
end 
```

要测试多个子域，您可以设置`Capybara.app_host`. 看看[这个问题](https://stackoverflow.com/questions/6536503/capybara-with-subdomains-default-host)以获得详细的解释。

**更新**

Capybara 2 包含一个[很好的功能](https://github.com/jnicklas/capybara/pull/698)，它会`always_include_port`自动添加服务器正在运行的端口号。

```
Capybara.always_include_port = true 
```

所以而不是

```
visit("http://127.0.0.1:#{port_number}/statistics") 
```

你现在可以使用

```
visit("/statistics") 
```

它会自动连接到`http://127.0.0.1:#{port_number}/statistics`.

如果你想测试多个子域`Capybara.app_host`，你可以使用一个总是解析为 127.0.0.1 的域名`lvh.me`。

例如，如果您指定`Capybara.app_host = "http://example.lvh.me"`它将使用`example`子域运行测试。

# ios - 沿路径的动画 - 过早调用完成方法

> ID：15235769
> 
> 赞同：0
> 
> 时间：2013-03-05T22:57:04.320
> 
> 标签：ios, objective-c, animation, quartz-core

我想沿圆形路径实现动画，并在动画结束后立即触发完成功能。

感谢这篇[文章](https://stackoverflow.com/questions/1886158/how-do-i-translate-parabolically)，我想出了如何使用**CAKeyframeAnimation**和**CGMutablePathRef**沿路径执行动画。

```
CAKeyframeAnimation *pathAnimation = [CAKeyframeAnimation animationWithKeyPath:@"position"];
pathAnimation.calculationMode = kCAAnimationPaced;
pathAnimation.fillMode = kCAFillModeForwards;
pathAnimation.removedOnCompletion = NO;
pathAnimation.duration = 1.0;

CGPoint endPoint = CGPointMake(self.boardReference.view.bounds.size.width/2,self.boardReference.view.bounds.size.height/2);
CGMutablePathRef curvedPath = CGPathCreateMutable();
CGPathMoveToPoint(curvedPath, NULL, self.view.center.x, self.view.center.y);
CGPathAddCurveToPoint(curvedPath, NULL, endPoint.x, self.view.center.y, endPoint.x, self.view.center.y, endPoint.x, endPoint.y);
pathAnimation.path = curvedPath;
CGPathRelease(curvedPath);
[self.view.layer addAnimation:pathAnimation forKey:@"curvedPath"];

[self addNewCardAtPoint:endPoint]; //This should only be launched after the animation has been finished 
```

问题：我的方法*addNewCardAtPoint*只能在动画完成**后调用。**目前该过程没有阻塞，因此该方法或多或少同时被调用。

在第一个视图中， animateWithDuration 函数似乎更适合，因为它为动画和完成动作定义了块。但是简单的将 CAKeyframeAnimation 添加到动画块中，结果基本相同，立即执行完成块。

```
[UIView animateWithDuration:0.8
                 animations:^{
                     NSLog(@"-Animate on curved path to end point-");
                     ... //how perform the same path based animation here?
                 } completion:^(BOOL finished) {
                     [self addNewCardAtPoint:self.view.center];
                 }
 ]; 
```

只有在沿着弯曲路径的动画完成后，如何才能触发完整的功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:20:57.233

当 a`CAAnimation`完成时，它将调用`animationDidStop:finished:`其委托上的方法。

# nsstring - UILabel 检测换行符

> ID：15235770
> 
> 赞同：9
> 
> 时间：2013-03-05T22:57:04.473
> 
> 标签：nsstring, uilabel, line-breaks

我目前正在使用 a`UILabel`来显示多行文本。大多数换行符设置为，`NSLineBreakByWordWrapping`因此标签会自动插入换行符。如何检测这些换行符在哪里？基本上，我想返回一个包含每个`\n`中断的字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T09:39:21.543

这是我检测内部换行符的工作`UILabel`

```
- (int)getLengthForString:(NSString *)str fromFrame:(CGRect)frame withFont:(UIFont *)font
{
    int length = 1;
    int lastSpace = 1;
    NSString *cutText = [str substringToIndex:length];
    CGSize textSize = [cutText sizeWithFont:font constrainedToSize:CGSizeMake(frame.size.width, frame.size.height + 500)];
    while (textSize.height <= frame.size.height)
    {
        NSRange range = NSMakeRange (length, 1);
        if ([[str substringWithRange:range] isEqualToString:@" "])
        {
            lastSpace = length;
        }
        length++;
        cutText = [str substringToIndex:length];
        textSize = [cutText sizeWithFont:font constrainedToSize:CGSizeMake(frame.size.width, frame.size.height + 500)];
    }
    return lastSpace;
}

-(NSString*) getLinebreaksWithString:(NSString*)labelText forWidth:(CGFloat)lblWidth forPoint:(CGPoint)point
{
    //Create Label
    UILabel *label = [[UILabel alloc] init];
    label.text = labelText;
    label.numberOfLines = 0;
    label.lineBreakMode = NSLineBreakByWordWrapping;

    //Set frame according to string
    CGSize size = [label.text sizeWithFont:label.font
                         constrainedToSize:CGSizeMake(lblWidth, MAXFLOAT)
                             lineBreakMode:UILineBreakModeWordWrap];
    [label setFrame:CGRectMake(point.x , point.y , size.width , size.height)];

    //Add Label in current view
    [self.view addSubview:label];

    //Count the total number of lines for the Label which has NSLineBreakByWordWrapping line break mode
    int numLines = (int)(label.frame.size.height/label.font.leading);

    //Getting and dumping lines from text set on the Label
    NSMutableArray *allLines = [[NSMutableArray alloc] init];

    BOOL shouldLoop = YES;
    while (shouldLoop)
    {
        //Getting length of the string from rect with font
        int length = [self getLengthForString:labelText fromFrame:CGRectMake(point.x, point.y, size.width, size.height/numLines) withFont:label.font] + 1;        

        [allLines addObject:[labelText substringToIndex:length]];

        labelText = [labelText substringFromIndex:length];
        if(labelText.length<length)
            shouldLoop = NO;
    }

    [allLines addObject:labelText];
    //NSLog(@"\n\n%@\n",allLines);

    return [allLines componentsJoinedByString:@"\n"];
} 
```

**如何使用**

```
NSString *labelText = @"We are what our thoughts have made us; so take care about what you think. Words are secondary. Thoughts live; they travel far.";

NSString *stringWithLineBreakChar = [self getLinebreaksWithString:labelText forWidth:200 forPoint:CGPointMake(15, 15)];
NSLog(@"\n\n%@",stringWithLineBreakChar); 
```

您只需要设置***getLinebreaksWithString***所需的参数，您将获得一个包含每个“\n”中断的字符串。

**输出** ![NSLog 和模拟器的结果](../Images/0e0f0bccc52527e6afd437d04525a6aa.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-24T14:47:13.820

这是我对这个问题的解决方案。
我遍历提供的字符串中的所有空白字符，将子字符串（从开头到当前空白）设置为我的标签并检查高度的差异。当高度改变时，我插入一个换行符（模拟换行符）。

```
func wordWrapFormattedStringFor(string: String) -> String {
    // Save label state
    let labelHidden = label.isHidden
    let labelText = label.text

    // Set text to current label and size it to fit the content
    label.isHidden = true
    label.text = string
    label.sizeToFit()
    label.layoutIfNeeded()

    // Prepare array with indexes of all whitespace characters
    let whitespaceIndexes: [String.Index] = {
        let whitespacesSet = CharacterSet.whitespacesAndNewlines
        var indexes: [String.Index] = []

        string.unicodeScalars.enumerated().forEach { i, unicodeScalar in
            if whitespacesSet.contains(unicodeScalar) {
                let index = string.index(string.startIndex, offsetBy: i)
                indexes.append(index)
            }
        }

        // We want also the index after the last character so that when we make substrings later we include also the last word
        // This index can only be used for substring to this index (not from or including, since it points to \0)
        let index = string.index(string.startIndex, offsetBy: string.characters.count)
        indexes.append(index)

        return indexes
    }()

    var reformattedString = ""

    let boundingSize = CGSize(width: label.bounds.width, height: CGFloat.greatestFiniteMagnitude)
    let attributes = [NSFontAttributeName: font]

    var runningHeight: CGFloat?
    var previousIndex: String.Index?

    whitespaceIndexes.forEach { index in
        let string = string.substring(to: index)
        let stringHeight = string.boundingRect(with: boundingSize, options: .usesLineFragmentOrigin, attributes: attributes, context: nil).height

        var newString: String = {
            if let previousIndex = previousIndex {
                return string.substring(from: previousIndex)
            } else {
                return string
            }
        }()

        if runningHeight == nil {
            runningHeight = stringHeight
        }

        if runningHeight! < stringHeight {
            // Check that we can create a new index with offset of 1 and that newString does not contain only a whitespace (for example if there are multiple consecutive whitespaces)
            if newString.characters.count > 1 {
                let splitIndex = newString.index(newString.startIndex, offsetBy: 1)
                // Insert a new line between the whitespace and rest of the string
                newString.insert("\n", at: splitIndex)
            }
        }

        reformattedString += newString

        runningHeight = stringHeight
        previousIndex = index
    }

    // Restore label
    label.text = labelText
    label.isHidden = labelHidden

    return reformattedString
} 
```

[图像 - 输出字符串与标签文本的比较。](https://i.stack.imgur.com/k1DaQ.png)

这个解决方案在我的情况下非常有效，希望它有所帮助。

# android - 将服务绑定到 FragmentActivity 或 Fragment？

> ID：15235773
> 
> 赞同：12
> 
> 时间：2013-03-05T22:57:21.497
> 
> 标签：android, service, android-fragments, android-fragmentactivity

将服务绑定到`FragmentActivity`：

```
bindService(Intent, ServiceConnection, int); 
```

或`Fragment`：

```
getActivity().bindService(Intent, ServiceConnection, int); 
```

什么是更好的做法？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-03-05T23:07:33.207

> 将服务绑定到 FragmentActivity... 还是 Fragment 更好

它们和你在这里写的一样。`getActivity()`不是`Fragment`- 它是一个返回`Activity`. 您不能调用`bindService()`.`Fragment`

> 什么是更好的做法？

两者都不。绑定到`Application`通过 获得的对象，`getApplicationContext()`由`ServiceConnection`（或实际上*是*）一个保留的管理`Fragment`。

原因是配置更改。绑定是状态。您需要在配置更改时保持该状态。虽然保留的`Fragment`可以保留，但系统中的和注册它以进行绑定`ServiceConnection`的系统之间存在隐式联系。由于活动可以在配置更改时被销毁和重新创建，所以这里不是一个好的选择。，这是系统全局的，是一个更安全的选择，并且是少数几个选择另一个是明智之举的地方之一恕我直言。`ServiceConnection``Context``Activity``Context``Application``Application``Context`

[这是我的一篇博客文章](http://commonsware.com/blog/2010/09/29/another-use-getapplicationcontext-binding-rotation.html)，从片段之前的时间开始，更多地涉及到这一点。这是一个演示该技术[的示例项目。](https://github.com/commonsguy/cw-omnibus/tree/master/AdvServices/Binding)

# ruby-on-rails - Rails link_to 用于其他用户的帐户

> ID：15235779
> 
> 赞同：0
> 
> 时间：2013-03-05T22:57:52.487
> 
> 标签：ruby-on-rails, link-to

我设置了一个应用程序，用户可以在其中提名一个密钥持有人，该密钥持有人将对其某些帐户具有只读访问权限。keyholder 只是一个 keyholder 布尔字段设置为 true 的用户。他们还有一个 access_id 等于他们可以访问的帐户的 user_id。

现在我要做的是有一个链接，该链接从密钥持有者的帐户指向用户的文件夹，但我很难过如何编写链接。

例如

```
<%= link_to 'Folder', folder_path(current_user.folder) %> 
```

会链接到他们自己的文件夹，但我该怎么做：

```
<%= link_to 'Other User's Folder', folder_path(user.id = access_id) %> 
```

如果你明白我的意思吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:06:12.530

如果我对您的理解正确，您似乎正在寻找：

```
<%= link_to 'Others users folder', folder_path(User.find(current_user.access_id).folder) %> 
```

现在有更好的方法来做到这一点。例如，如果您在 User 模型中定义两个用户之间的关联：

```
belongs_to :access, :class_name => "User" 
```

所以现在 user.access 指向第一个可以访问的用户。因此你可以做

```
<%= link_to 'Others users folder', folder_path(current_user.access.folder) %> 
```

# matlab - 最小化 MATLAB 中公式的误差（最小二乘？）

> ID：15235781
> 
> 赞同：1
> 
> 时间：2013-03-05T22:58:02.093
> 
> 标签：matlab, computer-vision, linear-algebra

我对 MATLAB 或计算数学不太熟悉，所以我想知道如何解决一个涉及平方和的方程，其中每个项都涉及两个向量——一个已知的，一个未知的。这个公式应该代表错误，我需要最小化错误。我想我应该使用最小二乘，但我不太了解它，我想知道什么函数最适合这样做，什么参数可以代表我的方程。我的老师还提到了一些关于取导数的事情，他用导数形成了一个矩阵，这让我更加困惑——我需要取导数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T04:10:53.233

您必须尝试解决的问题是

Min u'u = min \sum_i u_i^2, u=y-Xbeta，其中 u 是误差，y 是您要解释的因变量向量，X 是自变量矩阵，beta 是您要解释的向量想估计。

由于 sum u_i^2 是可微分的（并且是凸的），因此您可以评估此​​表达式的最小值，计算其导数并使其等于零。

如果你这样做，你会发现 beta=inv(X'X)X'y。这可以使用 matlab 函数 regress [http://www.mathworks.com/help/stats/regress.html](http://www.mathworks.com/help/stats/regress.html)或在 Matlab 中编写此公式来计算。但是，您应该小心如何评估逆 (X'X) 请参阅[MATLAB 中最有效的矩阵求逆](https://stackoverflow.com/questions/5004148/most-efficient-matrix-inversion-in-matlab)

# google-apps-script - 在 Google Apps 脚本中，如何为我实现的服务设置 HTTP 响应代码？

> ID：15235783
> 
> 赞同：16
> 
> 时间：2013-03-05T22:58:17.190
> 
> 标签：google-apps-script, http-status-codes

假设我有“服务”返回 XML 文档：

```
function doGet() {
    var result = '<result>42</result>';
    var output = ContentService.createTextOutput(result);
    output.setMimeType(ContentService.MimeType.XML);
    return output;
} 
```

默认情况下，响应的 HTTP 状态代码将为 200。我如何设置不同的值，比如 500（同时仍返回相同的 XML 文档）？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T23:04:07.743

ContentService 目前无法做到这一点。隐式地，只有 200 状态码可以通过脚本的成功完成返回。其他错误代码都是系统级别的，当出现问题时会出现。

如果您对此有很好的用例，请在[问题跟踪器](https://code.google.com/p/google-apps-script-issues/issues/list)中打开功能请求。

# java - 如何在 Java 中使用 LibSVM？

> ID：15235787
> 
> 赞同：4
> 
> 时间：2013-03-05T22:58:46.417
> 
> 标签：java, android, machine-learning, libsvm, rssi

我正在尝试使用蓝牙加密狗实现室内位置跟踪系统。这个想法是带着安卓设备四处走动，并根据房间周围的蓝牙适配器的信号强度计算你在房间中的位置。为了做到这一点，我决定使用机器学习将 RSSI 尽可能地近似为距离，例如米。我大学的一位讲师告诉我，LibSVM 是我正在寻找的东西，所以我一直在阅读。我查看了本[教程](http://lekshmideepu.blogspot.ie/2012/02/libsvm-tutorial.html)，似乎无法理解训练系统所需的数据。我将拥有的数据是：

*   保存在数据库中的每个加密狗的位置（以及 MAC 地址），x 和 y 坐标
*   离我的 Android 设备最近的加密狗的接收信号强度指示器 (RSSI)
*   mac 地址将用于查询数据库中的某些加密狗

我知道数据必须是 SVM 格式，但我有点不确定它在输入数据和输出数据方面应该是什么。下面的示例取自我提到的教程，表明男人是一个阶级，女人是一个阶级。那么在我的情况下，我只有一个类“加密狗”吗？并且所有值加密狗都应该反映我存储在数据库中的值吗？

> 男声：低身材：大收入：好
> 
> 女声：高身材：微薄收入：车费
> 
> 1.  将特征值转换为其数值表示。假设最好的薪水是 5，最差的薪水是 1（或没有薪水 = 0），与其他枚举变量相同。
> 2.  我们有两个班，男人和女人。将类转换为数值：man = 1，woman = -1
> 3.  以 libsvm 数据格式保存：
> 
> [class/target] 1:[firstFeatureValue] 2:[secondFeatureValue] etc. 例如：一个薪水高、声音低、身材矮小的女性会被编码为：-1 1:5 2:1.5 3:1.8
> 
> 通常 SVM 的输入文件格式为
> 
> [标签] [索引1]：[值1] [索引2]：[值2] ... [标签] [索引1]：[值1] [索引2]：[值2] ...

有人可以给我一个我应该瞄准的例子吗？

这对我来说都是全新的，所以任何有助于我前进的有用提示或技巧都会很棒。提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T20:48:53.337

我已经为室内定位实现了 WiFi 指纹识别，所以我知道这里的一些问题。

首先，要确定您的位置，您是在执行指纹识别还是信号强度三边测量（人们错误地称之为三角测量）？三边测量是使多个球体相交以在空间中找到位置的过程。另一方面，指纹识别是一个分类问题，它将信号解析到一个没有计算实际距离的位置。

由于多径衰落等无线问题，三边测量在室内极为困难。这些影响会导致您的信号衰减，进而导致您的距离估计值被关闭。

指纹只是一个分类问题。与三边测量一样，它假设加密狗的位置不会改变。但是，与三边测量不同，它根本不使用距离。

三边测量的优点是，假设距离估计是正确的（实际上很难达到），您将能够在连续（非离散）范围内解析您的位置。由于指纹识别是一个分类问题，它必须分类到一组固定的离散位置中的一个；例如，如果您的蓝牙无线电沿着房间的周边布置，您最终可能会将房间内部离散化为 3x3 可能的位置之一。

如果您要进行指纹识别，那么您将需要收集具有如下特征向量的训练数据：

```
MAC_1:-87, MAC_2:-40, MAC_3:-91, class=location_A
MAC_1:-31, MAC_2:-90, MAC_3:-79, class=location_B 
```

对于房间中的每个位置，您可以从所有可以感应到的可用蓝牙无线电中读取 RSSI。您应该为每个位置至少读取 10 个读数。对于 WiFi，RSSI 值是整数，以分贝为单位，范围为 -100 到 -1（例如，-20 dB 表示您非常靠近收音机）。

现在，当您尝试执行分类时，您将阅读如下内容：

```
MAC_1:-89, MAC_2:-71, MAC_3:-22, class=? 
```

问题是将这些 RSSI 读数分类到其中一个位置。

在我之前的工作中，我使用了朴素贝叶斯分类器而不是 SVM，因为朴素贝叶斯很容易适应缺失的特征（通过允许你给缺失的特征一个小概率质量）。此外，在朴素贝叶斯中，我使用高斯 PDF 函数来计算似然概率 P(location | MAC_i = RSSI_i)，因为所有 RSSI 值都是数字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T20:16:11.953

由于您的输出是实数（距离），我们谈论的是回归问题，而不是分类问题。我不清楚您要查找的值是否是到加密狗的最近距离，或者您的输出是否是到所有加密狗的一组距离。这是你需要首先澄清的事情。

有几种算法可以做到这一点，但既然你问的是 SVM，我会把这个答案的范围仅限于此。我假设您的输出只是一个表示距离的值，如果您期望有一个多维输出并且考虑到 SVR（支持向量回归）只提供一维输出，那么您需要在每个维度上训练一个实例。

libsvm 的参数之一是 svm_type，因为问题是回归问题，您应该使用选项 3 - epsilon-SVR

对于内核类型，我建议考虑 RBF（选项 2 - 径向基函数）

至于您的数据，这是一种可能的安排：

```
| dongle 1           | dongle 2           | dongle 3           | desired output
| x    | y    | RSSI | x    | y    | RSSI | x    | y    | RSSI |   
---------------------------------------------------------------------------------
| 10.0 | 11.1 | 2.3  | 0.0  | 1.1  | 0.3  | 17.0 | 19.1 | 0.3  |     10.3
| 30.0 | 17.1 | 0.3  | 10.0 | 1.1  | 0.9  | 11.0 | 9.1  | 0.2  |     18.7 
```

所以这将转化为（大括号只是为了清楚起见）：

```
[10.3] [1]:[10.0] [2]:[11.1] [3]:[2.3] [4]:[0.0] [5]:[1.1] [6]:[0.3] [7]:[17.0] [8]:[19.1] [9]:[0.3]
[18.7] [1]:[30.0] [2]:[17.1] [3]:[0.3] [4]:[10.0] [5]:[1.1] [6]:[0.9] [7]:[11.0] [8]:[9.1] [9]:[0.2] 
```

始终建议在 [-1, 1] 或 [0, 1] 之间缩放数据。此外，您可以在此处找到一些示例数据[http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/regression.html](http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/datasets/regression.html)

希望这可以帮助

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T01:22:49.827

我认为您不能使用 SVM 来做您所说的事情（计算您在房间中的位置……） SVM 是一种有监督的二进制分类算法。也就是说，如果你给它一些数据和一些正/负类，它会学习一个分类器，可以告诉你新的、未观察到的数据点是正的还是负的。因此，您可以训练一个 SVM 来告诉您一个人是在房间的一侧还是在另一侧（南侧/北侧），而不是他们的实际位置。

看起来你想做的事情根本不需要机器学习。请参阅以下帖子：

*   [http://en.wikipedia.org/wiki/Trilateration](http://en.wikipedia.org/wiki/Trilateration)
*   [使用信号强度的三角测量算法](https://stackoverflow.com/questions/9682776/triangulation-algorithm-using-signal-strength)
*   [Wifi三角测量](https://stackoverflow.com/questions/1009703/wifi-triangulation)
*   [http://www.eetimes.com/design/microwave-rf-design/4019032/Wireless-triangulation-using-RSSI-signals](http://www.eetimes.com/design/microwave-rf-design/4019032/Wireless-triangulation-using-RSSI-signals)

**编辑：鉴于您的澄清，我建议使用[k-最近邻](http://en.wikipedia.org/wiki/K-nearest_neighbor_algorithm)回归。**SVM 绝对不适合你想做的事情；即使使用 SVM 进行回归，它也只能在一维中工作。

您要做的是获取尽可能多的数据（数据 = RSSI，标签 = 距离）并将它们嵌入到度量空间中，可能在您拥有的加密狗数量的维度中。然后，给定一些新数据（RSSI 信号强度），找到空间中最近的邻居并计算距离上的某种平均值。

# php - Internet Explorer IE 8 中的 jQuery 问题

> ID：15235792
> 
> 赞同：1
> 
> 时间：2013-03-05T22:58:58.817
> 
> 标签：php, jquery, internet-explorer-8

我设置了一个全局变量 $category_list，它是一个类别名称数组。

在页脚我有：

```
<?php if ( isset($category_list) ): ?>
    <script type="text/javascript">
        var wordlist = [
            <?php foreach ($category_list as $row) { echo '"' . $row->name . '", '; } ?>
        ];
    </script>  
<?php endif ?> 
```

我有一个带有以下代码的外部 .js 文件：

```
jQuery( ".cats" ).autocomplete({
    source: function(req, responseFn) {
        var matches = new Array();
        var needle = req.term.toLowerCase();

        var len = wordlist.length;
        for(i = 0; i < len; ++i)
        {
            var haystack = wordlist[i].toLowerCase();
            if(haystack.indexOf(needle) == 0 ||
               haystack.indexOf(" " + needle) != -1)
            {
                matches.push(wordlist[i]);
            }
        }
        responseFn( matches );
    }
}); 
```

IE8 中出现错误，因此下拉菜单不起作用：`wordlist[...] is null or not an object`

不知道如何解决这个问题，类别名称的下拉列表在 IE 9、Firefox 和 Chrome 中运行良好，但在 IE8 上却不行，影响了大约 50% 的 IE 用户。我正在使用 Codeigniter 框架。我尝试在外部文件之前加载页脚脚本，但没有任何乐趣。

非常喜欢任何帮助<3

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T23:01:02.253

IE8 不喜欢`,`在数组文字定义中出现尾随。您将不得不重构您的代码以不留下任何代码。

```
<?php 
    $rows = array();
    foreach ($category_list as $row) { $rows[] = '"' . $row->name . '"'; } 
    echo implode(',', $rows);
?> 
```

或者

```
var wordlist = <?php 
    $rows = array();
    foreach ($category_list as $row) { $rows[] = '"' . $row->name . '"'; } 
    echo json_encode($rows);
?>; 
```

# python - 从函数而不是按钮命令调用 Tkinter 帧控制器

> ID：15235794
> 
> 赞同：2
> 
> 时间：2013-03-05T22:59:03.660
> 
> 标签：python, model-view-controller, tkinter

所以我有以下内容，效果很好：

```
import tkinter as tk

class App(tk.Tk):
    def __init__(self, *args, **kwargs):
        tk.Tk.__init__(self, *args, **kwargs)

        container = tk.Frame(self)
        container.pack(side="top", fill="both", expand=True)
        container.grid_rowconfigure(0, weight=1)
        container.grid_columnconfigure(0, weight=1)

        self.frames = {}
        for F in (LoginPage, ProjPage):
            frame = F(container, self)
            self.frames[F] = frame
            frame.grid(row=0, column=0, rowspan=12, columnspan=6, sticky="nsew")

        self.show_frame(LoginPage)

    def show_frame(self, c):
        frame = self.frames[c]
        frame.tkraise()

class LoginPage(tk.Frame):
    def __init__(self, parent, controller):
        tk.Frame.__init__(self, parent)

        Btn = tk.Button(self, text="Sign In", command=lambda: controller.show_frame(ProjPage)) 
```

但我希望最后一个按钮命令位于单独的函数中，因此我可以先进行一些评估：

```
 Btn = tk.Button(self, text="Sign In", command=self.signIn)

    def signIn(self):
        # do some stuff here
        self.controller.show_frame(ProjPage) 
```

这不起作用；无论我尝试通过控制器还是使用 lambda，似乎都没有任何效果 >.< 我没有得到什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T23:05:18.420

您似乎没有`controller`在`self`. 把它放在那里`__init__`，`LoginPage`像这样：

```
self.controller = controller 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-26T17:59:41.343

我的程序有一个页面（主页），其中有 5 个单选按钮和一个“确定”按钮，我还有 5 个其他框架。我希望我的程序在单击“确定”（基于选择的单选按钮）后转到这些帧。

单击“确定”时，它将调用 lambda 并获取所选单选按钮的值，并基于此值找到代表页面名称的字符串 (veg)。

这是代码：

从 tkinter 导入 tkinter 作为 tk 从 win32print 导入 ttk 导入 StartPage

类 KBSapp(tk.Tk): def **init** (self, *args, **kwargs): tk.Tk. **init** (self, *args, **kwargs) tk.Tk.iconbitmap(self,default="icon.ico") tk.Tk.wm_title(self, "蔬菜作物病虫害") container = tk.Frame( self, width=200, height=200, bg='black') container.pack(side="top", fill="both", expand=True) container.grid_rowconfigure(0, weight=1) container.grid_columnconfigure( 0，重量=1)

```
 self.frames = {}

    for F in (StartPage,carrot,celery, potato, wheat, bean):
        frame = F(container, self)
        self.frames[F] = frame
        frame.grid(row=0, column=0, sticky="nsew")

    self.show_frame(StartPage)

def show_frame(self, cont):
    frame = self.frames[cont]
    frame.tkraise( ) 
```

类 StartPage(tk.Frame): def **init** (self, parent, controller): tk.Frame。**初始化**（自己，父母）

```
 label = tk.Label(self, width=0, height=20)
    label.pack()

    button2 = ttk.Button(self, command=lambda : okclick(v) ,text='OK', width=25)
    button2.pack( )

    v = tk.IntVar( )
    self.option1 = ttk.Radiobutton(self,  text="Carrot", variable=v, value=1);self.option1.pack( )
    self.option2 = ttk.Radiobutton(self,  text="Celery", variable=v, value=2);self.option2.pack( )
    self.option3 = ttk.Radiobutton(self,  text="potato", variable=v, value=3);self.option3.pack( )
    self.option4 = ttk.Radiobutton(self,  text="wheat", variable=v, value=4);self.option4.pack( )
    self.option5 = ttk.Radiobutton(self,  text="bean", variable=v, value=5);self.option5.pack( )
    v.set(1)  # initializing the choice 
```

def okclick(v): global veg input1=v.get() if input1==1: veg="carrot" if input1==2: veg='celery' if input1==3: veg='potato' if input1 ==4: veg='wheat' if input1==5: veg='bean' print(veg)

类胡萝卜（tk.Frame）：def **init**（自我，父母，控制器）：tk.Frame。**init** (self, parent) label = tk.Label(self, width=0, height=20) label.pack( ) button3 = ttk.Button(self, command=lambda : controller.show_frame(celery) , text='celery ', width=25) button3.pack( )

芹菜类（tk.Frame）：def **init**（自我，父母，控制器）：tk.Frame。**init** (self, parent) label = tk.Label(self, width=0, height=20) label.pack() button4 = ttk.Button(self, command=lambda : controller.show_frame(potato) , text='potato ', width=25) button4.pack( )

土豆类（tk.Frame）：def **init**（自我，父母，控制器）：tk.Frame。**init** (self, parent) label = tk.Label(self, width=0, height=20) label.pack( ) button4 = ttk.Button(self, command=lambda : controller.show_frame(wheat) , text='wheat ', width=25) button4.pack( )

小麦类（tk.Frame）：def **init**（自我，父母，控制器）：tk.Frame。**init** (self, parent) label = tk.Label(self, width=0, height=20) label.pack( ) button4 = ttk.Button(self, command=lambda : controller.show_frame(bean) , text='bean ', width=25) button4.pack( )

类 bean(tk.Frame): def **init** (self, parent, controller): tk.Frame。**init** (self, parent) label = tk.Label(self, width=0, height=20) label.pack() button4 = ttk.Button(self, command=lambda : controller.show_frame(StartPage) , text='StartPage ', width=25) button4.pack( )

app = KBSapp() app.mainloop()

# javascript - 如何在 jQuery 中使用 next() 来选择 div 中的下一个图像？

> ID：15235797
> 
> 赞同：0
> 
> 时间：2013-03-05T22:59:17.223
> 
> 标签：javascript, jquery, html

我的 HTML：

```
<div class="container"><img src="path" class="A" id="A" /></div>
<div class="container"><img src="path" class="A" id="B" /></div>
<div class="container"><img src="path" class="A" id="C" /></div>
<div class="container"><img src="path" class="A" id="D" /></div>
<div id="Holder"></div>//displays large image
<div id="next">Next</div>//is used to displays next image
<input type="hidden" id="image_holder" /> 
```

我的 jQuery：

```
 /******Place image in large holder********/
$(document).ready(function(){
    var i,a,h;
    h=$('#image_holder');
    i=$('img.A').prop('id');
    a="<img src='my path/" + i + ".jpg' class='C' />";
    $('#Holder').html(a); 
    h.val(i);
});
/*******Next Image*****************/
$(document).ready(function(){
    $('#next').on('click',function(){
        var ih,nxt, 
        ih=$('#image_holder').val()//id of the last image
        nxt=$('#' + ih).next('img.A').prop('id');
        //nxt=$('#' + ih).siblings().next('img.A').prop('id');I have also tried
        //nxt=$('#' + ih).parent().siblings().next('img.A').prop('id');I have also tried
        alert(nxt);
    });
}); 
```

警报给我的只是`undefined`. 我需要第一个图像 id 之后的下一个图像 ID。

当有人单击图像时，它会将图像放置在`<div id="Holder">`. 我想要的是当用户单击下一个按钮时，流程中的下一个图像被放置在持有人中。

有人可以看看我的代码并告诉我我做错了什么或我还没有做什么吗？当我删除时，`.prop('id')`我会`Object Object`进入警报框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:28:21.880

该[`.next()`](http://api.jquery.com/next/)方法获取匹配元素集中每个元素的紧随其后的兄弟。

因为您的每个图像都单独包装在 a 中`<div class="container">`，所以它们没有直接的兄弟姐妹，并且调用`.next()`返回一个空集。当您随后调用时`.prop()`（注意：您应该使用[`.attr()`](http://api.jquery.com/attr/)它来提取 ID），它会返回 undefined，因为它正在对一组空元素进行操作。

要解决此问题，您可以将所有图像放在一个容器中。

```
<div class="container">
    <img src="path" class="A" id="A" />
    <img src="path" class="A" id="B" />
    <img src="path" class="A" id="C" />
    <img src="path" class="A" id="D" />
</div> 
```

**[演示](http://jsfiddle.net/pAKCz/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:28:40.837

`.next()`为您提供下一个兄弟元素，但您的`img`元素都是唯一的子元素。所以你实际上想先上一个层次。您已经接近您的第三个选项，但您需要记住返回一个级别：

```
nxt=$('#' + ih).parent().next('.container').children("img").first().prop('id'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:34:15.347

您需要比预期多一点地遍历 DOM，简单地说：

```
next = $(this).closest('.container').next('.container').find('img'); 
```

`$(this)`当然，起点在哪里（替换为您实际使用的任何选择器）。

参考：

*   [`closest()`](http://api.jquery.com/closest/).
*   [`find()`](http://api.jquery.com/find/).
*   [`next()`](http://api.jquery.com/next/).

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-12-25T23:39:39.700

希望对您有所帮助，我花了一天时间寻找它...问题是（'img'）标签必须用大写（'IMG'）填写，否则jquery将无法识别它。好了！

# xna - XNA 中的缩放问题

> ID：15235800
> 
> 赞同：0
> 
> 时间：2013-03-05T22:59:28.347
> 
> 标签：xna

事情就是这样。我在一个团队中，我们正在尝试开发类似小行星的游戏，而我的游戏部分是与图像相关的所有内容。我明白一切，但缩放。我的问题是，当我缩放图像时，它会从最初分配的位置略微移动。但是，我希望它在缩放后保持在同一个地方。尝试用矩形替换向量，但没有用。这是我的代码：

> 公共类 Game1：Microsoft.Xna.Framework.Game { Texture2D 纹理；
> 
> ```
>  Vector2 position = new Vector2(525, 325);
> 
>     float scale = 0.3f;
> 
>     Texture2D texture2;
> 
>     GraphicsDeviceManager graphics;
> 
>     SpriteBatch spriteBatch;
> 
>     public Game1()
>     {
> 
>         graphics = new GraphicsDeviceManager(this);
>         Content.RootDirectory = "Content";
> 
>         // Frame rate is 30 fps by default for Windows Phone.
>         TargetElapsedTime = TimeSpan.FromTicks(333333);
> 
>         // Extend battery life under lock.
>         InactiveSleepTime = TimeSpan.FromSeconds(1);
>     }
> 
>     /// <summary>
>     /// Allows the game to perform any initialization it needs to before starting to run.
>     /// This is where it can query for any required services and load any non-graphic
>     /// related content.  Calling base.Initialize will enumerate through any components
>     /// and initialize them as well.
>     /// </summary>
>     protected override void Initialize()
>     {
>         // TODO: Add your initialization logic here
> 
>         base.Initialize();
>     }
> 
>     /// <summary>
>     /// LoadContent will be called once per game and is the place to load
>     /// all of your content.
>     /// </summary>
>     protected override void LoadContent()
>     {
>         // Create a new SpriteBatch, which can be used to draw textures.
>         spriteBatch = new SpriteBatch(GraphicsDevice);
> 
>         texture = Content.Load<Texture2D>("Spacenebula_Backround_");
> 
>         texture2 = Content.Load<Texture2D>("PressureSphere");
> 
>         // TODO: use this.Content to load your game content here
>     }
> 
>     /// <summary>
>     /// UnloadContent will be called once per game and is the place to unload
>     /// all content.
>     /// </summary>
>     protected override void UnloadContent()
>     {
>         // TODO: Unload any non ContentManager content here
>     }
> 
>     /// <summary>
>     /// Allows the game to run logic such as updating the world,
>     /// checking for collisions, gathering input, and playing audio.
>     /// </summary>
>     /// <param name="gameTime">Provides a snapshot of timing values.</param>
>     protected override void Update(GameTime gameTime)
>     {
>         // Allows the game to exit
>         if (GamePad.GetState(PlayerIndex.One).Buttons.Back == ButtonState.Pressed)
>             this.Exit();
> 
>         // TODO: Add your update logic here
> 
>         base.Update(gameTime);
>     }
> 
>     /// <summary>
>     /// This is called when the game should draw itself.
>     /// </summary>
>     /// <param name="gameTime">Provides a snapshot of timing values.</param>
>     protected override void Draw(GameTime gameTime)
>     {
>         GraphicsDevice.Clear(Color.CornflowerBlue);
> 
>         spriteBatch.Begin();
> 
>         spriteBatch.Draw(texture, Vector2.Zero, Color.Wheat);
> 
>         spriteBatch.Draw(texture2,position, null, Color.Wheat, 0, new Vector2(0, 0), scale, SpriteEffects.None, 0);
> 
>         spriteBatch.End();
> 
>         // TODO: Add your drawing code here
> 
>         base.Draw(gameTime);
>     }
> } } 
> ```

最小刻度为 0.3f，最大为 1.3f。

当比例为 0.3f 时，如下所示：

![比例 = 0.3f](../Images/e163a27ce892c9f6f8f3a1deec8c4fe7.png)

当比例为 1.3f 时，如下所示：

![比例 = 1.3f](../Images/5b13365ebf0b461055109c02143c0a6c.png)

明白了吗？每次更改比例时，我都需要它位于同一位置。如果有人帮助我，我将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T23:24:37.697

作为 spriteBatch.Draw 方法的一部分，您可以指定图像的原点。（“新向量（0,0）”）

目前，您似乎将其设置为图像的左上角，这意味着任何缩放工作也将从图像的左上角“增长”。

尝试将原点设置为图像的中心。

这将确保图像正确缩放，而不会因缩放而移动/移位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T14:47:57.923

如果您使用碰撞检测，请确保在计算中也使用比例参数。无论您如何缩放，精灵的高度和宽度仍然相同。如果使用圆形碰撞，也可以更改半径。

# php - 使用 php 5.4.3 在 WampServer x86 上安装 OAuth？

> ID：15235805
> 
> 赞同：1
> 
> 时间：2013-03-05T22:59:56.337
> 
> 标签：php, oauth, wampserver

我正在尝试使用 php 5.4.3 在 WampServer x86 上安装 OAuth，并尝试从 pierre 添加扩展，甚至尝试直接从 PECL 安装。这些都在日志中产生了错误，并且没有启用 OAuth。有谁知道我需要使用哪个 dll 版本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T22:59:56.337

我发现适用于该版本的唯一 dll 来自 windows.php.net 目录： http: [//windows.php.net/downloads/pecl/releases/oauth/1.2.3/php_oauth-1.2.3-5.4- ts-vc9-x86.zip](http://windows.php.net/downloads/pecl/releases/oauth/1.2.3/php_oauth-1.2.3-5.4-ts-vc9-x86.zip)

祝所有必须在另一个版本上处理这个问题的人好运……

# jquery - 循环通过节点子节点，用 & 使用 JQuery 清理 HTML

> ID：15235806
> 
> 赞同：0
> 
> 时间：2013-03-05T22:59:58.637
> 
> 标签：jquery, loops, replace, children

在此节点中“清理”HTML 的最佳方法是什么？

我想要：

*   `<p>`将标签包裹在`<div>`（完成）中
*   用标签包裹第一个节点之后的每个`<input>`节点`<label>``<li>`
*   '清理' HTML：删除`<br>`和`&ndash;`

我需要能够处理这两个 HTML 示例中的任何一个：

```
<p>
    <input type="checkbox" protocol="/" rel="TestNote" name="firsttodo" class="function-check" id="id_firsttodo">
    &nbsp;<label for="id_firsttodo">First To-Do</label>
    <br>
    &ndash; 2-List item 1<br>
    &ndash; 2-List Item 2<br>
    &ndash; 2 List Item 3
</p>
<p>
    <input type="checkbox" protocol="/" rel="TestNote" name="ndtodo" class="function-check" id="id_ndtodo">
    &nbsp;<label for="id_ndtodo">2nd To-Do</label>
    <br>
    &ndash; <input type="checkbox" protocol="/" rel="TestNote" name="sttodo" class="function-check" id="id_sttodo">
    &nbsp;<label for="id_sttodo">2)1st To-Do</label>
    <br>
    &ndash; <input type="checkbox" protocol="/" rel="TestNote" name="ndtodo" class="function-check" id="id_ndtodo">
    &nbsp;<label for="id_ndtodo">2)2nd To-Do</label>
</p> 
```

我想要的是：

```
<div class="ToDo"> 
<p>
    <input type="checkbox" protocol="/" rel="TestNote" name="firsttodo" class="function-check" id="id_firsttodo">
    &nbsp;<label for="id_firsttodo">First To-Do</label>
    <li>2-List item 1</li>
    <li>2-List Item 2</li>
    <li>2 List Item 3</li>
</p>
</div>
<div class="ToDo">
<p>
    <input type="checkbox" protocol="/" rel="TestNote" name="ndtodo" class="function-check" id="id_ndtodo">
    &nbsp;<label for="id_ndtodo">2nd To-Do</label>
    <li><input type="checkbox" protocol="/" rel="TestNote" name="sttodo" class="function-check" id="id_sttodo">
    &nbsp;<label for="id_sttodo">2)1st To-Do</label></li>
    <li><input type="checkbox" protocol="/" rel="TestNote" name="ndtodo" class="function-check" id="id_ndtodo">
    &nbsp;<label for="id_ndtodo">2)2nd To-Do</label></li>
</p> 
</div> 
```

到目前为止我的脚本：

```
<script>
$(document).ready(function(){
    $('p').each(function() {
        var L1 = $(this).children();
        for (var i = 2, len = L1.length; i < len; i++) { //skipping #s 0 & 1, want to keep them as is!
            var x = L1[i].nextSibling;
            if (x) {
                $(x).wrapAll('<li />');
            }
        }
        $(this).wrapAll('<div class="ToDo" />');
    })
});
</script> 
```

我相当肯定`removeChild()`会删除节点和它的兄弟姐妹。所以我严重脑死亡。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:53:17.360

看起来你快到了。

[http://jsfiddle.net/RpXBT/](http://jsfiddle.net/RpXBT/)

添加

```
$(this).find('br').remove(); 
```

到最后。还剩下什么？我还删除了`&nbsp;`. 使用 CSS 进行格式化要好得多。

```
label {margin-left: 6px;}

$(this).replace('&nbsp;', ''); 
```

哦，你的 LI 是无效的，除非它们被包装在 UL 中。

这是我得到的最接近的。我今天没时间了。祝你好运。[http://jsfiddle.net/RpXBT/2/](http://jsfiddle.net/RpXBT/2/)

# c# - 将滚动条移动到c#中的某个点

> ID：15235808
> 
> 赞同：-2
> 
> 时间：2013-03-05T22:59:59.897
> 
> 标签：c#, scrollbar, move, point

每个人

我有一个面板，其中包含添加用户的信息 .. 它是可滚动的。有一个名为 add_user onclick 的按钮检查字段验证并将这些用户添加到数据库。

问题是：当按下按钮并出现错误时，将面板滚动到包含这些错误的字段......就像在网站上一样。

谁能给我一个代码...请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:08:46.130

这是一个 WinForms 应用程序吗？还是网站？

在 WinForms 中，如果您为字段提供焦点（通过调用其 Focus() 方法），则会自动将滚动条移动到包含该字段的面板区域。

# java - 如何使用 AJAX 将数组从 Servlet 发送到 Java Script？

> ID：15235809
> 
> 赞同：0
> 
> 时间：2013-03-05T23:00:01.030
> 
> 标签：java, javascript, ajax, servlets

我需要使用 ajax 向 js 发送一个数组，这是我在 java 脚本中使用 ajax 的函数...

```
$.ajax({
    url: "/localizacion/ServletPeticiones",
    type:"Post",
    data:"accion=LatLong_UR",
    dataType: "text",
    success: function(results){
        console.info(results);
        cad=results;   
    }
    }); 
```

我有一个数组`String[][] datos`，我必须使用最后一个函数将此数组从我的 Servlet 发送到 JS。

我怎么能做到这一点？如何使用 js 中的 ajax 功能从我的 Servlet 接收数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:04:25.270

servlet 将返回一个`application/json`响应和一个 JSON 编码的数组（更好的是，您可以使用 a `Map<String, String>`）。有像[Gson](http://code.google.com/p/google-gson/)这样的库可以进行转换：

```
public void doPost(HttpServletRequest request, HttpServletResponse response) {
  response.setContentType("application/json; charset=UTF-8");

  Gson gson = new Gson();
  Map<String, String> datos = getDatos(); // you have to implement this

  response.getWriter().println(gson.toJson(datos));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:03:44.577

您可以尝试使用 JSON .. 您可以使用 google 的 GSON 库将数组转换为 JSON 表示形式并将其发送给您的客户端

在客户端...将 $.ajax 的 dataType 更改为“json”

在成功函数中，您只需将返回的数据用作 javascript 数组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:26:45.453

JSON 将是正确的方法。PHP 具有`json_encode`从数组中很好地为您完成它的功能。另一种方法是手动创建 JSON 字符串，尽管这不是一个好主意。另一方面，只是为了练习和熟悉 JSON，它是可取的，但您最好使用服务器端平台的内置 json 生成功能。

您可能希望从服务器发送正确的标头，以便浏览器能够将其作为 json 数据接收：“ `Content-Type: application/json`”

# session - 记住书签中的变量

> ID：15235810
> 
> 赞同：0
> 
> 时间：2013-03-05T23:00:06.533
> 
> 标签：session, variables, bookmarks, favorites

[解决..飞行员错误]

这就是问题所在。我没有在 pageC 上传递变量

```
header('Location: pageC.php?screenname='.$screenname); 
```

* * *

我将访问者发送到包含变量（屏幕名称）的页面，并根据该变量从数据库中提取附加信息。

IE。 `domain.com/page1.php?screenname=karol`

`page1.php`然后使用会话来存储变量

```
$_SESSION['screenname']=$_GET["screenname"]; 
```

当他们将此页面添加为书签并返回时，它只记住`page1.php`没有变量，当然也没有数据库中的任何内容。

我想设置一些东西来记住返回时的变量

什么方法最好？

* * *

是的..这里有更多

pageA.php 接收变量（屏幕名称）

```
domain.com/pageA.php?screenname=karol 
```

（pageA.php 看起来像这样）

```
session_start(); 
```

`$_SESSION['screenname']=$_GET["screenname"];`

此页面根据 USER_AGENT 确定它是 Android、iPhone 还是标准浏览器

```
header('Location: pageB.php?screenname='.$screenname); 
```

pageB.php（记录网站统计数据的命中 - 这需要在这里）

```
$_SESSION['screenname']=$_GET["screenname"];
header('Location: pageC.php?screenname='.$screenname); 
```

pageC.php 是被添加书签的页面，其开头为：

```
session_start();
$screenname = $_SESSION['screenname'];
header('Location: pageC.php); 
```

如果需要，我如何从 get 中获取变量并在重新访问时仍然保留它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:22:14.147

您确定书签没有与查询字符串一起保存吗？我有很多书签，其中包含很长的变量和值列表作为查询字符串。例如，如果您为他们提供了 yourdomain.com/page1.php?screename=superstar，当他们为页面添加书签时，查询字符串也会自动保存。

我刚刚针对 Chrome 版本 25.0 对其进行了测试。书签保存查询字符串。Mozilla Firefox 18.0 也是如此（该死，这些天他们对版本号发疯了，不是吗？）。IE 9 也是（收藏夹）。我在这里错过了什么吗？

如果担心查询字符串可能会在书签中被修剪，Google 也会使用 # 和其他一些网站。顺便说一句，我们知道 # 是 HTML 中“书签”的真正 McCoy。Hashtagging 不仅在兴起，而且已经与 web 2.0 的其他模式一样成熟。您可能会考虑使用散列解析 url。JavaScript 位置对象有一个密钥哈希，可以原生支持解析它（让它变得轻而易举）。服务器端的 PHP 应该只是字符串操作或使用 url 相关函数的问题。

# c++ - C++ 代码示例：是什么让这个循环如此多次？

> ID：15235811
> 
> 赞同：1
> 
> 时间：2013-03-05T23:00:08.123
> 
> 标签：c++, recursion

我在这里找到了一个代码示例：[N-QUEEN Backtracking problemsolved](http://techmyway.wordpress.com/2011/11/09/small-documented-c-code-for-backtracking-problem-n-queens/)

它显示了这段代码：

```
#include <iostream>
using namespace std;

/** this is the size of chess board */
#define N 8

/** Given a completed board, this prints it to the stdout */
void print_solution(int state[N][N])
{
    int i,j;
    for (i = 0; i < N; ++i)
    {
        for (j = 0; j < N; ++j)
            cout << state[i][j] << " ";
        cout << endl;
    }
    cout << endl;
}

/** return true if placing a queen on [row][col] is acceptable
else return false */
bool accept(int state[N][N], int row, int col)
{
    int i,j;

    /* check the column */
    for (i = 0; i < N; ++i)
    {
        if (state[row][i])
            return false;
    }

    /* check the row */
    for (i = 0; i < N; ++i)
    {
        if (state[i][col])
            return false;
    }

    /* check the upper left diagnol */
    for (i = row, j = col; i >= 0 && j >= 0; i--, j--)
    {
        if (state[i][j])
            return false;
    }

    /* check the lower left diagnol */
    for (i = row, j = col; i < N && j >= 0; ++i, --j)
    {
        if (state[i][j])
            return false;
    }

    /* check the upper right diagnol */
    for (i = row, j = col; i >= 0 && j < N; i--, ++j)
    {
        if (state[i][j])
            return false;
    }

    /* check the lower right diagnol */
    for (i = row, j = col; i < N && j < N; ++i, ++j)
    {
        if (state[i][j])
            return false;
    }

    /* return true if all tests passed */
    return true;
}

void solve_state(int state[N][N], int row)
{

    int i;

    /* if all queens have been placed at non conflicting positions */
    if (row == N)
    {

        print_solution(state);
        return;
    }

    /* Place queens on all positions in a given row and
    check if the state is acceptable
    Continue the process till all possibilities found */
    for(i=0; i<N; ++i){

        if(accept(state, row, i)){
            state[row][i] = 1;
            solve_state(state, row+1);
        }
        state[row][i] = 0;
    }
}

int main()
{
    /* initialise the board */
    int state[N][N] = {0};

    solve_state (state, 0);

    return 0;
} 
```

我在逻辑上相当失败，而且我在尝试学习递归等方面遇到了更大的麻烦。真正让我感到震惊的是，我无法理解为什么这段代码会循环遍历国际象棋问题中 8 个皇后的所有 92 个解决方案。起初我以为它只找到了一个解决方案，但是一旦我测试了代码并且它运行了所有可能的解决方案，我感到很惊讶。

我必须在这里遗漏一些非常基本的东西，因为我什至试图在一个解决方案之后让它“停止”，但我只是失败了。

所以我想我在这里要问的是，为了理解这一点，给定这段代码，如果我只想让它**循环一次，并找到第一个解决方案，需要改变什么？**什么样的魔法让这东西一直循环？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:11:33.517

```
/* Place queens on all positions in a given row and
check if the state is acceptable
Continue the process till all possibilities found */
for(i=0; i<N; ++i){

    if(accept(state, row, i)){
        state[row][i] = 1;
        solve_state(state, row+1);
    }
    state[row][i] = 0;
} 
```

该循环完全按照您的描述进行。您在一行的八列上循环，从而给出了八种可能性。如果要在第一个可接受的状态下停止，则必须更新内部条件并删除递归调用。相反，您可以调用您的`print_solution`函数来打印结果。

这给了你类似的东西：

```
for(i=0; i<N; ++i){

    if(accept(state, row, i)){
        state[row][i] = 1;
        print_solution(state);
        return; // this prevents printing the solution multiple times
                // in case the queen may be placed on other colum on the same row
    }
    state[row][i] = 0;
} 
```

* * *

旁注：对我来说，这段代码是一个 C 代码（在函数开头声明的变量，普通的旧 C 数组，使用`int`where a`bool`可以完成这项工作），唯一的 C++ 部分是函数中`std::cout`和`std::endl`的使用，`print_solution`可以很容易地被旧的`printf`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T01:40:37.787

The first step to understanding a recursive method is to verbalize what the method does, like this:

```
/** solve_state(state, n) finds all possible solutions given a state where
 * the first n rows already have legally placed queens
 */ 
```

Then examine the body of the method and verbalize it:

```
/**
 * if n == N we're done, there is a queen in every row.  print the solution.
 * otherwise for every legal spot in the current row, 
 * put a queen there, and then solve the remaining rows.
 */ 
```

* * *

One very easy way to have the program exit after printing one solution is to throw an exception after printing the solution.

Or, perhaps more elegantly, you could modify solve_state to return 1 when it finds a solution, and stop the recursion that way:

```
int solve_state(int state[N][N], int row)
{
    int i;

    /* if all queens have been placed at non conflicting positions */
    if (row == N)
    {
        print_solution(state);
        return 1; // done!
    }

    /* Place queens on all positions in a given row and
       check if the state is acceptable
       Continue the process till all possibilities found */
    for(i=0; i<N; ++i){
        if(accept(state, row, i)){
            state[row][i] = 1;
            if (solve_state(state, row+1)) return 1;
        }
        state[row][i] = 0;
    }

    return 0; // not yet
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-22T11:51:16.780

也许我的代码会帮助你，我不是最会说英语的人......

```
//coded by SwinGYOu

#include<iostream>
#pragma warning(disable:4996)
using namespace std;

/* this is the size of chess board */
const int boardSize=8;

/* Given a completed board, this prints it to the console */
void print_solution(int board[boardSize][boardSize], int i=0, int j=0){
    if(i==boardSize){ cout<<endl; return; }
    if(j==boardSize){ cout<<endl; print_solution(board, ++i, 0); return; }
    cout<<"[";
    if((i+j)%2)
        putwchar(board[i][j] ? '\u2655' : ' ');
    else
        putwchar(board[i][j] ? '\u265B' : ' ');
    cout<<"]";
    print_solution(board, i, ++j);
}
/* Check up, up left and up right to veritify that there are no other Queens, return true if right */
bool accept(int board[boardSize][boardSize], int row, int col, int rowD=0, int colD=0){
    if(!(rowD||colD)){
        return
            accept(board, row, col, -1, 0)&&
            accept(board, row, col, -1, -1)&&
            accept(board, row, col, -1, 1);
    }
    if(!(row>=0&&col>=0&&row<boardSize&&col<boardSize)){
        return true;
    }
    if(board[row][col]==1) return false;
    return accept(board, row+rowD, col+colD, rowD, colD);
}
/* check and return sultions for every sultion that possible*/
void solve_board(int board[boardSize][boardSize], int row=0, int col=0){
    //if the row befor was the last row of the table, its meants that is a sultion, print it.
    if(row==boardSize){
        print_solution(board);
        return;
    }
    //if col is out of the board, dont run check on it, its not a vaild path.
    if(col==boardSize) return;
    //run for this, if true, go to next row until end of row's or until a not vaild row is given than carry on with checking the next col.
    if(accept(board, row, col)){
        board[row][col]=1;
        solve_board(board, row+1);
    }
    board[row][col]=0;
    //carry on to next spot on the col in the given row.
    solve_board(board, row, col+1);
}

int main(){
    /* Make board */
    int board[boardSize][boardSize]={0};

    solve_board(board);

    return 0;
} 
```

# git - Git 编辑“迷失在太空”

> ID：15235820
> 
> 赞同：4
> 
> 时间：2013-03-05T23:01:05.090
> 
> 标签：git

以下是`gitk`我的存储库的表示：

![Git 存储库的描述](../Images/774e50d06481e2deb60bc9945d373ba4.png)

让我困惑的部分是高亮入口附近的叛逆粉红色三角形。这是一个不在任何分支上的代码星云。储藏室是空的，所以它也没有藏在那里。

我不需要这段代码，但我很担心它仍然潜伏在我已知存储库边缘附近的某个地方。

我怎样才能找到它并根除它？

该问题可能是由于尝试重新设置分支然后尝试通过重置和签出中止该操作而引起的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:41:23.333

这似乎是在您启动 gitk 时隐藏的一些更改，然后从隐藏中删除，然后要求 gitk**更新**显示。

当一个引用被删除（就像从存储中删除一些东西一样）时，引用的提交和其他对象不会立即被 git 删除。相反，这些对象会在 git 的对象存储中保留一段时间，然后才能进行垃圾回收。这也发生在通过执行 rebase 或`commit --amend`. 此外，当使用 gitk 中的**Update** ( `F5`) 命令时，即使不再引用它们也不会导致它从显示中删除提交。

要清理 gitk 中的显示，您可以使用**Reload** ( `Ctrl`+ `F5`) 命令而不是**Update**。至于从最终会自动发生的对象存储中删除那些项目。`git gc`您可以通过使用选项指定日期来强制这种情况更快发生`--prune`，但除非这些对象占用的空间导致您出现问题，否则我不建议您这样做。

# r - 在数据框中将重叠范围合并为唯一组

> ID：15235821
> 
> 赞同：11
> 
> 时间：2013-03-05T23:01:09.707
> 
> 标签：r, dataframe, data.table, range, overlap

我有一个 n 行和 3 的数据框

```
df <- data.frame(start=c(178,400,983,1932,33653),
    end=c(5025,5025, 5535, 6918, 38197),
    group=c(1,1,2,2,3))

df
  start   end group
1   178  5025     1
2   400  5025     1
3   983  5535     2
4  1932  6918     2
5 33653 38197     3 
```

我想创建一个新列`df$group2`，将重叠的组重新分类为相同。例如，`df$group[df$group==1]`从 178 开始，到 5025 结束。这与 重叠`df$group[df$group==2]`，从 983 开始，到 6918 结束。我想创建一个新列，现在将组 1 和 2 分类为组 1（随后将组 3 分类为组2）。

结果：

```
df
  start   end group group2
1   178  5025     1      1
2   400  5025     1      1
3   983  5535     2      1
4  1932  6918     2      1
5 33653 38197     3      2 
```

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-05T23:07:29.247

你需要`IRanges`包：

```
require(IRanges)
ir <- IRanges(df$start, df$end)
df$group2 <- subjectHits(findOverlaps(ir, reduce(ir)))
> df

#  start   end group group2
# 1   178  5025     1      1
# 2   400  5025     1      1
# 3   983  5535     2      1
# 4  1932  6918     2      1
# 5 33653 38197     3      2 
```

要安装`IRanges`，请在 R 中键入以下行：

```
source("http://bioconductor.org/biocLite.R")
biocLite("IRanges") 
```

要了解更多信息（手动等），请访问[**此处**](http://www.bioconductor.org/packages/2.11/bioc/html/IRanges.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-26T21:17:43.747

我认为这是可能的`data.table::foverlaps`：

```
library(data.table)
setDT(df)
setkey(df,start,end)
df[,row_id:=1:nrow(df)]

temp <- foverlaps(df,df)
temp[, `:=`(c("start","end"),list(min(start,i.start),max(end,i.end))),by=row_id]
temp[, `:=`(c("start","end"),list(min(start,i.start),max(end,i.end))),by=i.row_id]
temp2 <- temp[, list(group2=.GRP, row_id=unique(c(row_id,i.row_id))),by=.(start,end)][,.(row_id,group2)]

setkey(df,row_id)
setkey(temp2,row_id)
temp2[df] 
```

# python - 如何忽略python函数中的隐藏文件？

> ID：15235823
> 
> 赞同：13
> 
> 时间：2013-03-05T23:01:19.130
> 
> 标签：python

在使用 os.path.getsize() 和 os.path.isfile 时，我的脚本也返回了我不需要的 .DS_Store 文件。我如何忽略这些？

```
import os

root = "/Users/Siddhartha/Desktop/py scripts"
for item in os.listdir(root):
    if os.path.isfile(os.path.join(root, item)):
        print item 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-05T23:03:52.330

假设您要忽略所有以 开头的文件`.`：

```
import os

root = "/Users/Siddhartha/Desktop/py scripts"
for item in os.listdir(root):
    if not item.startswith('.') and os.path.isfile(os.path.join(root, item)):
        print item 
```

# drupal-7 - 计算字段，Drupal 7，有条件的自动增量

> ID：15235825
> 
> 赞同：0
> 
> 时间：2013-03-05T23:01:21.567
> 
> 标签：drupal-7, computed-field

我有一个为网站创建的“商家”内容类型。Merchant 内容类型有一个名为“City”的选择字段和一个名为“Locality”的文本字段。

我想创建一个“merchant_code”字段，该字段必须类似于“AB-XY-0001”，其中 AB 是城市名称的前两个字母，XY 是地区名称的前两个字母，0001 必须是增量数字，因此 ABCD 市和 XYZ 地区的商家将有各自不同的代码：

```
"AB-XY-0001",
"AB-XY-0002",
"AB-XY-0003"...
"AB-XY-9999",
etc. 
```

PQRS City 和 LMN 地区的商户将有各自不同的代码：

```
"PQ-MN-0001",
"PQ-MN-0002",
"PQ-MN-0003"...
"PQ-MN-9999",
etc.. 
```

我看到有一个串行模块，但该模块仅帮助我为每种内容类型创建自动增量数字，而不是基于该内容类型的其他字段。

如果我创建商户“AB-XY-0001”，然后创建另一个城市 PQRS 和区域 LMN 商户，它将具有“PQ-LM-0002”代码，而不是“PQ-LM-0001”代码。

请帮助我实现这一目标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T00:37:40.307

我编写了一些代码让你知道我会做什么。我没有测试过它，但我认为它应该足以给你一个想法。

```
<?php
static $auto_generate = array(); // keep track of which codes are at what number
$code = '';
$code .= $node->field_city[0]['value'] . '-';
$code .= $node->field_locality[0]['value'];
if($auto_generate[$code])
{
  $auto_generate[$code]++;
}
else
{
  $auto_generate[$code] = 0;
}
$code .= '-' . $auto_generate[$code];
$node->field_merchant[0]['value'] = $code;
?> 
```

# php - PHP 尝试通过 PDO 连接到 Oracle 11g - 未知错误

> ID：15235828
> 
> 赞同：2
> 
> 时间：2013-03-05T23:01:43.030
> 
> 标签：php, oracle, pdo, oracle11g

我正在尝试通过 PDO 连接到 php 中的 Oracle 11g Express Edition 数据库。我已经安装了 xampp，我还有一个（据说）可以工作的 pdo_oci 扩展，它也出现在 phpinfo() 中。我的数据库工作正常，我可以通过 sql 控制台和/或 sql 开发人员连接到它。我已启用扩展 php_pdo_oci.dll

我的代码是：

```
$db_username = "system";
$db_password = "mypass";
$db = "oci:dbname=xe";
$conn = new PDO($db,$db_username,$db_password); 
```

我收到以下错误：

**致命错误：在 ...**

所以这真的说明不了什么。

如果我尝试通过 oci_connect 连接并启用扩展 php_oci8_11g.dll（并禁用 pdo 扩展），则使用以下代码：

```
$conn = oci_connect('system', 'mypass', 'localhost/XE'); 
```

我收到此错误：

**警告：oci_connect() [function.oci-connect]: OCIEnvNlsCreate() 失败。您的系统有问题 - 请检查 PATH 中是否包含带有 Oracle Instant Client 库的目录...**

那么什么是 Oracle Instant Client？我只下载了 Oracle Express Edition，并添加了 ORACLE_HOME 和 LD_LIBRARY_PATH 作为环境变量，还添加了 PATH 的路径。我错过了什么吗？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T11:31:29.743

好的，我想我已经修好了，所以如果其他人需要它：

我下载了 Oracle Instant Client。在此之后，它仍然抱怨我应该将它的位置放在 PATH 中，即使它已经在那里。

因此，我将 Instant Client 中的所有文件（可能您不需要全部，但无论如何）复制到 apache/bin 目录中，瞧，它起作用了。

# html - vbscript 禁用/启用 html 输入

> ID：15235838
> 
> 赞同：-1
> 
> 时间：2013-03-05T23:02:29.743
> 
> 标签：html, vbscript, radio-button, hta

我已经为此工作了几天，但我仍然没有弄清楚。我有一个 HTML 页面，它有两组输入，每组由一个单选按钮和一些文本组成。我需要：

*   页面加载时要禁用的所有文本输入
*   单选按钮 #1 启用它的文本输入并禁用单选按钮 #2 的文本输入
*   单选按钮 #2 启用它的文本输入并禁用单选按钮 #1 的文本输入

这是一些示例代码：

```
<html>

<script type="text/vbscript">
<!--<![CDATA[
function enable()
    if document.GetElementByID("radio1").checked then
        document.GetElementByID("radio2").checked = false
        document.GetElementByID("text1").disabled = false
        document.GetElementByID("text2").disabled = true
    elseif document.GetElementByID("radio2").checked then
        document.GetElementByID("radio1").checked = false
        document.GetElementByID("text1").disabled = true
        document.GetElementByID("text2").disabled = false
    else
        document.GetElementByID("text1").disabled = true
        document.GetElementByID("text2").disabled = true
    end if
end function
-->]]>
</script>

<body onload="enable()">
    <table border=1>
        <tr>
            <td>
                <input type="radio" id="radio1" name="radio1" value="radio1" onclick="enable()">
                <label for="radio1" >
                    Radio 1
                </label>
            </td>
            <td>
                <input type="text" id="text1" name="text1" value="hi">
            </td>
        </tr>
        <tr>
            <td>
                <input type="radio" id="radio2" name="radio2" value="radio2" onclick="enable()">
                <label for="radio2" >
                    Radio 2
                </label>
            </td>
            <td>
                <input type="text" id="text2" name="text2" value="bye">
            </td>
        </tr>
    </table>
</body>

</html> 
```

看起来我可以让它部分工作，但不是全部。最终，这将以 HTA 形式结束。

* * *

编辑：

感谢@kingdomcreation 和@Teemu，我现在有了这个适用于任意数量单选按钮的工作解决方案：

```
<html>

    <script type="text/vbscript">
        <!--<![CDATA[
        function enable(num)
            document.getElementById("text" & num).disabled = false

            for i = 1 to 6
                if document.getElementById("radio" & i).checked = false Then
                    document.getElementById("text" & i).disabled = true
                end if
            next
        end function
        -->]]>
    </script>

    <body>
        <table border=1>
            <tr>
                <td>
                    <input type="radio" id="radio1" name="radio" value="radio1" onClick="enable(1)">
                    <label for="radio1" >
                        Radio 1
                    </label>
                </td>
                <td>
                    <input disabled type="text" id="text1" name="text1" value="hi">
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" id="radio2" name="radio" value="radio2" onClick="enable(2)">
                    <label for="radio2" >
                        Radio 2
                    </label>
                </td>
                <td>
                    <input disabled type="text" id="text2" name="text2" value="there">
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" id="radio3" name="radio" value="radio3" onClick="enable(3)">
                    <label for="radio3" >
                        Radio 3
                    </label>
                </td>
                <td>
                    <input disabled type="text" id="text3" name="text3" value="how">
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" id="radio4" name="radio" value="radio4" onClick="enable(4)">
                    <label for="radio4" >
                        Radio 4
                    </label>
                </td>
                <td>
                    <input disabled type="text" id="text4" name="text4" value="are">
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" id="radio5" name="radio" value="radio5" onClick="enable(5)">
                    <label for="radio5" >
                        Radio 5
                    </label>
                </td>
                <td>
                    <input disabled type="text" id="text5" name="text5" value="you">
                </td>
            </tr>
            <tr>
                <td>
                    <input type="radio" id="radio6" name="radio" value="radio6" onClick="enable(6)">
                    <label for="radio6" >
                        Radio 6
                    </label>
                </td>
                <td>
                    <input disabled type="text" id="text6" name="text6" value="bye">
                </td>
            </tr>
        </table>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T13:34:46.113

这是我制作的一个工作 vbscript 示例，以了解我可以做些什么来使其在 vbscript 中工作（在客户端上）

*   Radio id 可以识别被点击的那个，但要具有类似选项的选项（当一个被点击时，另一个变为未选中），name 属性必须相同。

*   vb代码放在下面

*   函数代码改为vb语法

*   document.GetElementByID 已删除

如果你想做客户端 vbscript，我希望这能澄清一些事情......顺便说一下，它只是 IE appart 中支持向其他浏览器添加扩展的能力。

```
<html>

<body onLoad="enable()">
<table border=1>
    <tr>
        <td>
            <input type="radio" id="radio1" name="radio" value="radio1" onClick="enable()">
            <label for="radio1" >
                Radio 1
            </label>
        </td>
        <td>
            <input type="text" id="text1" name="text1"  disabled value="hi">
        </td>
    </tr>
    <tr>
        <td>
            <input type="radio" id="radio2" name="radio"  value="radio2" onClick="enable()">
            <label for="radio2" >
                Radio 2
            </label>
        </td>
        <td>
            <input type="text" id="text2" name="text2" disabled value="bye">
        </td>
    </tr>
</table>

<script type="text/vbscript">
<!--<![CDATA[
Function enable()
If radio1.checked = true Then
    radio2.checked = false
    text1.disabled = false
    text2.disabled = true
ElseIf radio2.checked = true Then
    radio1.checked = false
    text1.disabled = true
    text2.disabled = false
 Else
    text1.disabled = true
    text2.disabled = true
 End If
End Function
-->]]>
</script>
</body>

</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:06:04.847

您可以在 html 中的输入上编写 disabled 属性，以便默认情况下禁用它们（加载时）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T05:49:48.607

如果你真的只有两个按钮，这可以解决问题。请注意`name`两个单选按钮相同。这样，您可以将单选按钮组合在一起，而无需单独选中/取消选中它们。也`onload()`变得无用。

```
function enable(id)
    document.getElementById("text" & id).disabled = false
    document.getElementById("text" & id * -1).disabled = true
end function

<input id="radio1" name="radio" type="radio" value="radio1" onclick="enable(1)" />
<input id="text1" name="text1" type="text" value="hi" disabled />
                        :
<input id="radio2" name="radio" type="radio" value="radio2" onclick="enable(-1)" />
<input id="text-1" name="text2" type="text" value="bye" disabled /> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T12:59:42.003

我可以提出类似的建议。

```
<html>

<script>
<!--<![CDATA[
function enable(){
    if( document.getElementById("radio1").checked){
        document.getElementById("radio2").checked = false
        document.getElementById("text1").disabled = false
        document.getElementById("text2").disabled = true
    }else if( document.getElementById("radio2").checked){
        document.getElementById("radio1").checked = false
        document.getElementById("text1").disabled = true
        document.getElementById("text2").disabled = false
    }else{
        document.getElementById("text1").disabled = true
        document.getElementById("text2").disabled = true
    }
}
-->]]>
</script>

<body onload="enable()">
    <table border=1>
        <tr>
            <td>
                <input type="radio" id="radio1" name="radio" value="radio1" onclick="enable()">
                <label for="radio1" >
                    Radio 1
                </label>
            </td>
            <td>
                <input type="text" id="text1" name="text1" value="hi">
            </td>
        </tr>
        <tr>
            <td>
                <input type="radio" id="radio2" name="radio" value="radio2" onclick="enable()">
                <label for="radio2" >
                    Radio 2
                </label>
            </td>
            <td>
                <input type="text" id="text2" name="text2" value="bye">
            </td>
        </tr>
    </table>
</body>

</html> 
```

# php - 重新打开页面时，内容不刷新

> ID：15235847
> 
> 赞同：0
> 
> 时间：2013-03-05T23:03:21.703
> 
> 标签：php, html, http, redirect, header

当这个页面打开时，它会在下面的文本框中显示一条记录的内容：

![在此处输入图像描述](../Images/02d387e66c1a768b2c29707789fee351.png)

在我编辑文本并单击将以前的注释替换为当前注释后：

![在此处输入图像描述](../Images/2ec34966ab533c7c464b50105af16b4e.png)

使用以下代码将记录成功存储在数据库中`ModifyNoteScript.php`：

```
$comment_update = mssql_query("UPDATE pmp_property__unit
    SET  
    comments = '$NOTE'
    WHERE 
    communityidy='$COMID' and
    unit='$UNIT'") 
             or die ("Changes to Record could not be Saved."); 

    if (!$comment_update)
    {
        $success=2;
    }
    else
    {
        $success=1;
    }

    header ('Location:ModifyNote.php?unit=' . $UNIT . '&COMID=' . $COMID . '&success=' . $success); 
```

将`header`用户重定向回同一页面并显示此注释：

![在此处输入图像描述](../Images/6ded481450fef39259ad044ce5ab297b.png)

我遇到的问题是：

1.  原来的注释在文本框中消失了，现在文本框是空白的，如上所示
2.  `replace previous note with current` **如果我再次**单击，我会得到与上面相同的结果`#1`，此外，文本框中的任何内容都**不会**保存到数据库中。

这是带有文本框的页面的代码（编辑或删除注释）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<link href="../nav/occupancypop.css" rel="stylesheet" type="text/css"></link>
<script type='text/JavaScript' src='../scw.js'></script></head>
<script type="text/javascript">
<!--
function closewindow() {
parent.location = "occupancy2.php"
}

//-->
</script>

<body>
<div id="maincontentform">
<?php 

include '../Check.php';

  $success = $_GET['success'];
  if($success == 1)
  {
  echo '<span class="style4">*The note has been saved!</span><br />
    <br />'; 
  }
  elseif ($success==2)
  {
    echo '<span class="style4">*There was an error updating the note!</span><br />
    <br />';
  }

//GET the unit and community id
$UNIT = $_GET['unit'];
$COMID = $_GET['comid'];

include '../KiscoCustomConnect.php';

//Get the commnet
$Comment_Query = mssql_query("select top 1 comments from pmp_property__unit where communityidy='$COMID' and unit='$UNIT'");
if (mssql_num_rows($Comment_Query)>0)
{
$Comment=mssql_result($Comment_Query,0,'comments');
}
else
{
$Comment='';
}
?>

<span class="MainTitle">
 Edit or Delete the Note</span>
  <p><br />
  <table width="596" border="0" cellspacing="0" cellpadding="0" id="maintable">
    <tr class="odd">
      <td width="164"><div class="pickform">
        <ul>
          <li> 
            <div align="center">
              <p><strong><img src="../media/_space.gif" alt="" width="135" height="1" /><br />
                Update Notes</strong><br />
  <?php  echo 'for unit ' . $UNIT ?>
            </div>
          </li>
        </ul>
  </div></td>
      <td width="431">
        <form action="ModifyNoteScript.php" method="post"  />
        <input name="Comment" type="hidden" value="<?php echo $Comment; ?>" />
        <input name="UNIT" type="hidden" value="<?php echo $UNIT; ?>" />
        <input name="COMID" type="hidden" value="<?php echo $COMID; ?>" />
        <textarea name="Comment" cols="55" rows="6" class="text1" id="Comment"><?php echo $Comment; ?></textarea>
        <br />
        <input type="submit" name="sendnotify" class="formbutton" id="Submit" value="Replace previous note with current" />
      </form></td>
    </tr>

  </table>
  <blockquote>
    <p><br />

<?php      
  if($success == 3)
  {
 echo '<input type="button" name="Cancel3" class="formbutton2" id="Cancel3" value="Close" onclick="closewindow2();" />';
}
else
{
 echo '<input type="button" name="Cancel3" class="formbutton2" id="Cancel3" value="Close" onclick="closewindow();" />';
}
?>      <br />
      <br />
    </p>
  </blockquote>
</div>
</body>
</html> 
```

我究竟做错了什么？我怀疑它与`header`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:08:28.677

从我看到的情况来看，您在其他情况下设置

```
else
{
   $Comment='';
} 
```

您进入 else 案例的原因如下：

您使用小写来访问**$_GET['comid']**，但是当您将其设置为大写**&COMID=**时。我尝试了以下方法：

```
$arr['a'] = 'a';
echo $arr['A']; //echoes blank (false) 
```

你的情况：

```
$_GET['COMID'] = 'test';
var_dump($_GET['comid']); // results in undefined index comid 
```

所以我会在尝试获取值时将 comid 更改为大写。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:11:46.500

尝试在 $Comment='Test' 中添加一些文本，以便您知道 mssql_num_rows 何时返回 0 行

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T00:01:36.587

```
 $comment_update = mssql_query("UPDATE pmp_property__unit
    SET  
    comments = '$NOTE'
    WHERE 
    communityidy=$COMID and
    unit='$UNIT'") 
             or die ("Changes to Record could not be Saved."); 
```

# android - 增强现实环境中的户外图像处理框架？

> ID：15235852
> 
> 赞同：0
> 
> 时间：2013-03-05T23:03:47.310
> 
> 标签：android, image-processing, frameworks, augmented-reality

我打算写关于增强现实的学士论文。我想构建一个应用程序，它可以拍摄图像，标记其中的对象，并让用户有可能在以后显示标记的对象，例如，当对象在现实生活中不再存在时（所以用户可以启动相机并将对象投影到场景中）因此我必须检查是否已经存在类似的东西 - 我已经看到很多框架使用二维码或向应用程序内的现有对象提供信息，但我找不到适用于我的具体案例的现有应用程序。

你知道类似的东西是否已经存在？非常感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T09:11:01.927

我不确定“在图像中标记对象”是什么意思。你的意思是什么类型的物体？

对于基于标记的 AR，您有几个框架。[Vuforia](http://www.qualcomm.com/solutions/augmented-reality)真的是一个很好的，而且很容易使用。新的 Cloud AR，包括在云端寻找标记，可能与您相关。另一种选择可能是[metaio](http://www.metaio.com/)

对于无标记跟踪，我还不知道有任何框架实现它。如果你想为自己做点什么，我想单眼 SLAM 可能非常相关。但它可能会变得相当复杂。基本上它就是这样工作[的](http://www.youtube.com/watch?v=tXsgB6lRt64)。

# c++ - 找出参数是 constexpr

> ID：15235857
> 
> 赞同：2
> 
> 时间：2013-03-05T23:04:09.927
> 
> 标签：c++

任何 type_traits 或方法都可以找出参数是否为 constexpr？

例子

```
size_t fibo_runtime(size_t num)
{
  //implementation
}

constexpr size_t fibo(size_t num)
{
    return is_constexpr<size_t>::value ? //this type traits looks weird and unreasonable
           (num > 1 ? fibo(num - 1) * num : 1) :
           fibo_runtime(num);
} 
```

constexpr 可以应用于 constexpr 参数，并且该参数在运行时确定。但是，递归在运行时可能不够高效。

无论如何，我们是否必须将 constexpr 函数的运行时实现和编译时间分开？如果我们不能这样做，我们是否可以强制用户不能使用 constexpr 函数进行一些运行时评估？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:23:59.387

`constexpr`常量表达式 ( )的本质是*常量*。所以无论是否运行时评估，它们都不会改变他们的任何行为，并且评估永远不会在运行时完成。

如果您在运行时使用`constexpr`函数（不是简单地直接调用它），那么它将作为普通函数调用，因为表达式在运行时不能被自然解析为常量。

如果您想根据编译时或运行时实现一些不同的实现，它将（如果您实现它）对开发人员来说真的很烦人，因为根据您调用它的方式，该函数不会具有相同的行为！因此很明显，这种行为不能/不会/不应该实施。

如果您想专门用于编译时计算的函数，请使用不同的函数来清楚地说明您的意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-04T07:42:32.613

在函数中，不可能检查参数以查看完整的调用表达式是否为常量表达式。但是您可以在调用站点实现一个宏来测试相同的东西，根据表达式是否为常量表达式来评估`true_type`或在编译时进行评估`false_type`

```
IS_A_CONSTANT_EXPRESSION(  fibo(5)          )    // is constant
IS_A_CONSTANT_EXPRESSION(  fibo(time(NULL)  )    // is not constant 
```

详细信息在[this answer](https://stackoverflow.com/a/40413051/146041) to another question。（我自己的回答，为交叉发帖道歉！）

然后，您可以实现另一个宏，`FIBO( expr )`将其很好地包装起来，并根据需要调用正确的版本。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-06T03:44:20.233

我认为这可能会让你得到你想要的

```
#include <iostream>

template <typename T>
class is_constexpr
{
   typedef char true_type ;
   struct false_type { true_type _[2] ; } ;

   template <typename U>
   static true_type has_constexpr( U & ) ;

   template <typename U>
   static false_type has_constexpr(...) ;

   public:
      enum { value = ( sizeof(has_constexpr<T>(0)) == sizeof(true_type)) } ;
} ;

int main()
{
   constexpr int i = 10 ;
   int k = 20 ;

   std::cout << is_constexpr<decltype(i)>::value << std::endl ;
   std::cout << is_constexpr<decltype(k)>::value << std::endl ;   
} 
```

我使用[Understanding SFINAE](http://debugfailure.wordpress.com/2009/10/06/understanding-sfinae/)作为参考。

做一些更多的研究我认为我对问题的另一部分的答案是肯定的，因为它看起来`constexpr`函数模板[并不总是可用于常量表达式](https://stackoverflow.com/a/5462526/1708801)。所以这导致了一个像这样的解决方案，这个有点人为的例子：

```
template <typename T>
T f2( T num )
{ 
   return num + 1;
}

template <typename T>
constexpr T f1( T num )
{
   return num ;
}

template <typename T>
constexpr T f(T num)
{
   return  is_constexpr<T>::value ? f1(num) : f2(num) ;
} 
```

# sql - 如何在 SQL 中按 MAX() 分组？

> ID：15235861
> 
> 赞同：0
> 
> 时间：2013-03-05T23:04:29.217
> 
> 标签：sql, tsql

桌子：

```
+------------+------------------+
|     Number |       Date       |
+------------+------------------+
|          1 | 1900-01-01       |
|          1 | 2012-01-01       |
|          1 | 2011-01-01       |
|          2 | 1900-01-01       |
|          2 | 2007-01-01       |
+------------+------------------+ 
```

结果需要是：

```
+------------+------------+
|     Number |    Date    |
+------------+------------+
|          1 | 2012-01-01 |
|          2 | 2007-01-01 |
+------------+------------+ 
```

等等...

编辑 -

桌子：

```
+------------+------------------+------------+
|     Number |       Date       |   Field3   |
+------------+------------------+------------+
|          1 | 1900-01-01       |     a      |
|          1 | 2012-01-01       |     b      |
|          1 | 2011-01-01       |     c      |
|          2 | 1900-01-01       |     a      |
|          2 | 2007-01-01       |     b      |
+------------+------------------+------------+ 
```

我想在 GROUP 的日期 = MAX 时选择 DISTINCT 数字。

所以在查询之后我会得到：

```
1...b

2...b 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T23:06:35.620

~~您将需要使用具有以下功能的聚合`max()`函数`GROUP BY`：~~

 ~~```
SELECT number, max(date)
from yourtable
group by number 
```~~ 

~~请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/8e66b/3)~~

根据您的数据库，您可以使用`row_number()`：

```
select number, date
from
(
  select number, date,
    row_number() over(partition by number order by date desc) rn
  from yourtable
) src
where rn = 1 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/7435b/4)。

这也可以使用子查询来编写：

```
select t1.*
from yourtable t1
inner join
(
  SELECT number, max(date) MaxDate
  from yourtable
  group by number
) t2
  on t1.number = t2.number
  and t1.date = t2.maxdate; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/7435b/5)

# wordpress - TinyMCE：在哪里更改“可视”编辑器的 iframe src？

> ID：15235864
> 
> 赞同：2
> 
> 时间：2013-03-05T23:04:36.790
> 
> 标签：wordpress, tinymce

我正在尝试将（商业）fonts.com 字体添加到“可视”html 所见即所得编辑器中。这不起作用，因为“可视”编辑器 iframe 具有`src='javascript:""'`使来自 iframe 内的请求缺少引荐来源标头。但是 fonts.com（和其他 webfont 提供商）需要一个推荐人来验证请求。

解决方案相当简单：使用（最好是空白的）html 页面作为源。类似的东西`blank.html`。我只是没有找到相应的代码行。

**我在哪里更改 iframe src？**（我在 WP 中使用 TinyMCE）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T09:46:31.023

你可以用这个

```
$('#'+tinymce.editors[0].id+'_ifr').attr('src', 'blank.html'); 
```

或者如果您知道您的编辑器 ID

```
$('#'+tinymce.get('your_editor_id')+'_ifr').attr('src', 'blank.html'); 
```

# xcode - 我无法让我的 ipad 1 在管理器中弹出“使用设备进行开发”按钮

> ID：15235867
> 
> 赞同：-1
> 
> 时间：2013-03-05T23:04:52.983
> 
> 标签：xcode

我在让我的 ipad 1 在管理器中弹出“使用设备进行开发”按钮时遇到问题 我的 iphone 5 由于运行最新的 iOS 而工作，但我没有尝试过任何适用于 ipad 1 的操作。在管理器中我的ipad一个弹出，指示灯是绿色的，但我没有按钮说，“使用ipad进行开发”我将界面生成器版本设置为iOS 5.1，开发为之前的版本“Xcode 4.2”保存了它，但仍然没有. 我仍然无法让管理器窗口给我使用设备进行开发的按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:47:51.110

绿灯？您确定您还没有使用此设备进行开发吗？

无论如何，快速谷歌搜索给了我这个：

> 如果该设备过去曾用于开发，则可能不会出现“用于开发”按钮。如果发生这种情况，请单击屏幕底部的“添加到门户”。

[http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/YourFirstAppStoreSubmission/ProvisionYourDevicesforDevelopment/ProvisionYourDevicesforDevelopment.html](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/YourFirstAppStoreSubmission/ProvisionYourDevicesforDevelopment/ProvisionYourDevicesforDevelopment.html)

# javascript - 为 rspec 2.10 Rails 3.1 查看规范测试启用 JavaScript

> ID：15235874
> 
> 赞同：2
> 
> 时间：2013-03-05T23:05:33.147
> 
> 标签：javascript, ruby-on-rails, rspec, capybara

我正在为 Rails 3.2.11 编写 rspec 2.10 视图规范。在我正在测试的视图中，我有一些对其行为至关重要的 JavaScript。[我已经能够在 rspec 控制器测试中启用 JavaScript 测试，但是按照此处的说明](http://www.opinionatedprogrammer.com/2011/02/capybara-and-selenium-with-rspec-and-rails-3/#comment-220)，我对视图规范没有任何运气。总之，您将以下行添加到 spec_helper.rb：

```
require 'capybara/rspec'
require 'capybara/rails' 
```

我在规范中将 Capybara 驱动程序设置为 webkit：

```
Capybara.javascript_driver = :webkit
Capybara.current_driver = Capybara.javascript_driver 
```

我还在我的 Gemfile 中包含了 Capybara-webkit gem，并运行了 bundle install 来安装它。另外，我`, :js => true`在规范块定义之前添加。

然而，当我运行类似的测试时

```
rendered.should have_content('Text in JavaScript button') 
```

我基本上收到一条错误消息，显示呈现的视图在`<script></script>`标签中包含 JavaScript 作为文本。

有没有办法可以为我的 rspec 视图规范启用 JavaScript？我需要进行单元测试，这就是为什么我想在视图规范而不是功能规范中进行测试。另外，我不想使用 Jasmine，因为这个视图规范与 Rails 交互，我想至少模拟这种行为。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T17:25:27.153

我无法找到解决此问题的有效解决方案，因此我只是将单元测试转换为集成/功能测试。

# macos - 在 OS X 中设置桌面壁纸的插件

> ID：15235879
> 
> 赞同：0
> 
> 时间：2013-03-05T23:05:52.513
> 
> 标签：macos, osx-lion

我想要创建的是一个自定义服务，可以在 OS X 中设置桌面壁纸图像。它会从在线服务中提取壁纸图像并将其设置为桌面。我搜索了整个 Apple 文档，看看是否有办法将这样的服务添加到 OS X，但没有提出任何建议。

我想让服务像 iPhoto 一样与 OS X 绑定。

![OSX 桌面首选项窗格](../Images/a63d15758498a14c1d1d51ca09a7b064.png)

这可能吗？如果可以，怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:35:45.487

这可能有点矫枉过正，但是有一项服务可以将*屏幕保护程序*设置为桌面墙纸，因此如果您想编写 0FPS 屏幕保护程序，这可能会奏效：

[http://www.wallsaverapp.com](http://www.wallsaverapp.com)

我还建议搜索有关 Quartz Composer 的提示，因为这是一个 Apple 工具，通常用于插入屏幕保护程序、iTunes 可视化工具等系统服务。

# c++ - 使用 C++11 线程对非常量引用进行无效初始化？

> ID：15235885
> 
> 赞同：18
> 
> 时间：2013-03-05T23:06:11.937
> 
> 标签：c++, c++11

我收到一个错误

> 错误：从“int”类型的右值对“int&”类型的非常量引用的初始化无效</p>

从

```
#include <thread>
#include <iostream>

using namespace std;

void func(int& i){
    cout<<++i<<endl;
}

int main(){
    int x=7;
    thread t(func,x);
    t.join();
    return 0;
} 
```

我明白我做不到，`thread(func, 4)`但我`x`是一个变量，而不是暂时的。

我正在使用带有 -std=c++11 -pthread 的 gcc 4.7

为什么会出现这个错误？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-06T00:20:35.393

构造函数的规范`std::thread`说

> *效果：*构造一个线程类型的对象。新的执行线程执行*INVOKE* `(` *DECAY_COPY* `( std::forward<F>(f)),` *DECAY_COPY* 并在构造线程中评估对*DECAY_COPY*`(std::forward<Args>(args))...)`的调用。

 *其中*DECAY_COPY(x)*表示调用`decay_copy(x)`where 定义为：

```
template <class T> typename decay<T>::type decay_copy(T&& v)
{ return std::forward<T>(v); } 
```

这意味着参数“衰减”并被复制，这意味着它们*按值*转发并失去任何 cv 限定。因为线程运行的目标函数想要*通过引用*获取其参数，所以您会收到一个编译器错误，指出引用无法绑定到按值传递的对象。

这是设计使然，因此默认情况下，局部变量通过`std::thread`值传递（即复制）而不是通过引用传递给 get，因此新线程不会对超出范围的局部变量产生悬空引用，从而导致未定义的行为。

如果您知道通过引用传递变量是安全的，那么您需要明确地这样做，使用`reference_wrapper`不受“衰减”语义影响的 a ，并将通过引用将变量转发给目标对象。您可以创建一个`reference_wrapper`使用`std::ref`.

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-05T23:11:45.720

`x`在`std::ref`创建线程时包裹。

如果每次创建时`std::thread`它都通过引用获取所有变量，想一想会发生什么：如果您传入一个堆栈局部变量，它将是一个悬空引用，如果线程超出自动存储​​的范围，则会导致未定义的行为多变的。这在实践中会发生很多，并导致许多错误。相反，`std::thread`默认情况下（通过完美转发编组）所有参数（包括变量）按值。

可以通过传入 的线程本地左值副本调用您的`std::future`工作函数时静默工作`x`，但这会非常令人困惑：工作任务将编辑`x`您认为您通过引用传递的内容，并且它不会显示在`x`外部的任务。相反，它有助于为您提供该错误消息。你应该感谢你的幸运星！

为了表明你真的不想按值取值，你将它包装在 中`std::ref`，现在它作为引用一直传递给工作函数。在这种情况下，您负责管理引用的生命周期，以便引用的数据至少持续到`std::future`的工作任务需要它的时间。*

# python - Python 3.x 的 PIL.being 是否继续？

> ID：15235894
> 
> 赞同：0
> 
> 时间：2013-03-05T23:06:59.547
> 
> 标签：python, python-imaging-library

我目前正在将 PIL for Python 2.7 用于一个学校项目（一个自动发射的 IR 引导跟踪器哨兵：P）。我正在使用 PIL 来分析图像并指出最温暖的地方（当然，在一定限度内，它不会只对着太阳或最近的灯：P）并自动转向它并拍摄：D。但现在我想知道 PIL 是否已经停产，因为不久前 Python 2.7 发布了 1.1.7 版本。我很快就会迁移到 Python 3，我希望能够将 PIL 与它一起使用。

# ffmpeg - 有没有办法使用带有编解码器 AAC 到 AAC 的 ffmpeg 获得准确的 1 秒剪辑

> ID：15235895
> 
> 赞同：6
> 
> 时间：2013-03-05T23:07:08.917
> 
> 标签：ffmpeg, mp4, aac, m4a

如果我有一个带有视频流和音频流的 .mp4 文件。如果我执行这个命令：

```
ffmpeg -i input.mp4 -ss 00:00:14.000 -t 00:00:01.000 -vn -c:a libfaac audio.m4a 
```

结果是持续时间：00:00:01.02，开始：0.021179。我想确保开始时间从 0 开始，所以我使用以下方法重新采样：

```
ffmpeg -i audio.m4a -ss 00:00:00.000 -t 00:00:01.000 -c:a libfaac audio2.m4a 
```

此命令的结果有 Duration: 00:00:01.02, start: 0.000000。有没有办法让 1 秒作为最终结果，开始值为 0？

我在以前的尝试中使用了标志 -map 0:1 -ab 128k -ar 44100 但它提供了相同的结果。

如果需要，我可以提供 ffmpeg 的完整输出。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T07:43:52.160

我通过选择框架来解决这个问题

```
$ ffmpeg -i input.mp4 -ss 14 -frames 46 -vn pass-1.m4a

$ ffmpeg -i pass-1.m4a -c copy audio.m4a 
```

结果

```
$ ffmpeg -i 音频.m4a
输入#0，mov，mp4，m4a，3gp，3g2，mj2，来自“audio.m4a”：
  元数据：
    主要品牌：M4A
    次要版本：512
    兼容品牌：isomiso2
    编码器：Lavf55.1.100
  持续时间：00:00:01.00，开始：0.000000，比特率：135 kb/s
    流 #0:0(und)：音频：aac (mp4a / 0x6134706D)，48000 Hz，立体声，fltp，
                             125 KB/秒
    元数据：
      handler_name : SoundHandler

```

# c# - 将 XmlElement 反序列化为自定义对象

> ID：15235898
> 
> 赞同：2
> 
> 时间：2013-03-05T23:07:18.717
> 
> 标签：c#, xml-serialization

我有一些需要反序列化为对象的 XML。大多数元素都可以转换为字符串和整数，但有一个元素以数字形式出现，我需要将其转换为三个布尔值。这是转换为布尔值背后的逻辑：

```
switch (_valFromXML)
        {
            case 0:
                _bool1= true;
                break;
            case 1:
                _bool2= true;
                break;
            case 2:
                _bool1= true;
                _bool2= true;
                break;
            case 3:
                _bool3= true;
                break;
            case 4:
                _bool1= true;
                _bool3= true;
                break;
            case 5:
                _bool2= true;
                _bool3= true;
                break;
            case 6:
                _bool1= true;
                _bool2= true;
                _bool3= true;
                break;
        } 
```

我曾尝试创建像本例中那样的隐式运算符，但我看到的唯一被调用的是我的无参数构造函数：

[http://forums.asp.net/t/1187054.aspx](http://forums.asp.net/t/1187054.aspx)

这是被反序列化的属性：

```
private ConvertElement _convertElement;
[XmlElement("ConvertElement", typeof(ConvertElement))]
public ConvertElement ConvertElement
{
    get { return _convertElement; }
    set { _convertElement= value; }
} 
```

我可以整天反序列化为整数，但由于某种原因，我无法将元素转换为自定义类型。这是我试图从元素创建的类：

```
[Serializable]
public class ConvertElement
{
     int _value;
     bool _bool1;
     bool _bool2;
     bool _bool3;

    public static implicit operator int(ConvertElement x)
    {
        return x.Value;
    }
    public static implicit operator ConvertElement(int value)
    {
        return new ConvertElement(value);
    }

    public int Value
    {
        get { return _value; }
        set { _value = value; }
    } 

    public ConvertElement()
    {
    }

    public DocSelection(int value) 
    {
        _value= value;
        switch (_value)
        {
            case 0:
                _bool1= true;
                break;
            case 1:
                _bool2= true;
                break;
            case 2:
                _bool1= true;
                _bool2= true;
                break;
            case 3:
                _bool3= true;
                break;
            case 4:
                _bool1= true;
                _bool3= true;
                break;
            case 5:
                _bool2= true;
                _bool3= true;
                break;
            case 6:
                _bool1= true;
                _bool2= true;
                _bool3= true;
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T00:47:05.410

您可能必须使用该`IXmlSerializable`接口来执行自定义反序列化

例子：

```
public class ConvertElement : IXmlSerializable
{

    private int _value;
    private bool _bool1;
    private bool _bool2;
    private bool _bool3;

    public ConvertElement()
    {
    }

    #region IXmlSerializable implementation

    public void WriteXml(XmlWriter writer)
    {
        writer.WriteValue(_value);
    }

    public void ReadXml(XmlReader reader)
    {
        _value = int.Parse(reader.ReadString());
        DocSelection(_value);
    }

    public XmlSchema GetSchema()
    {
        return null;
    }

    #endregion

    public void DocSelection(int value)
    {
        _value = value;
        switch (_value)
        {
            case 0:
                _bool1 = true;
                break;
            case 1:
                _bool2 = true;
                break;
            case 2:
                _bool1 = true;
                _bool2 = true;
                break;
            case 3:
                _bool3 = true;
                break;
            case 4:
                _bool1 = true;
                _bool3 = true;
                break;
            case 5:
                _bool2 = true;
                _bool3 = true;
                break;
            case 6:
                _bool1 = true;
                _bool2 = true;
                _bool3 = true;
                break;
        }
    } 
```

## 我的测试：

xml:

```
<?xml version="1.0"?>
<TestClass xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <ConvertElement>6</ConvertElement>
</TestClass> 
```

测试类：

```
public class TestClass
{
    private ConvertElement _convertElement;
    [XmlElement("ConvertElement", typeof(ConvertElement))]
    public ConvertElement ConvertElement
    {
        get { return _convertElement; }
        set { _convertElement = value; }
    }
} 
```

连载：

```
TestClass test = new TestClass
{
    ConvertElement = new ConvertElement()
};

XmlSerializer xmlSerializer = new XmlSerializer(typeof(TestClass));
using (FileStream stream = new FileStream("c:\\ConvertElement.xml", FileMode.OpenOrCreate))
{
    xmlSerializer.Serialize(stream, test);
} 
```

反序列化：

```
XmlSerializer xmlSerializer = new XmlSerializer(typeof(TestClass));
using (FileStream stream = new FileStream("c:\\ConvertElement.xml", FileMode.Open))
{
  var result = xmlSerializer.Deserialize(stream);
} 
```

结果：

转换`_value`andd 设置 bool 值

![在此处输入图像描述](../Images/7109cf604fd687d28b8141b8a21dba41.png)

# javascript - jQuery：更新 cookie 中的数组

> ID：15235900
> 
> 赞同：2
> 
> 时间：2013-03-05T23:07:24.557
> 
> 标签：javascript, jquery, json, cookies

`array`- 多维数组：

```
array[0] = [["1","2","3"],["1","2","3"],["1","2","3"]]; 
```

我需要把这个数组放入 cookie ( `$.cookie('myCookie', JSON.stringify(array))`)

现在是有趣的部分：

我需要维护`myCookie`并将新数据放入其中。

如果新生成`array`的有任何新数据（元素），我需要从数组中提取新元素并将它们添加到`myCookie`

最优雅的方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:15:30.417

尝试这样的事情：

```
jQuery(document).ready(function($){
    var a=[];
a[0]= [["1","2","3"],["1","2","3"],["1","2","3"]];
a[1]= [["8","9","9"],["5","6","7"]];

var json_string_old=JSON.stringify(a); 

    //set myCookie
    $.cookie('myCookie',json_string_old); 

    //change the value of the array as per your requirments
   a[1]=[["2","2","2"],["2","2","2"]];
   a[2]=[["4","4","4"],["4","4","4"]];
    //convert it again to JSON String
var json_string_new=JSON.stringify(a);

    //now compafre & update accordingly
    if(json_string_new === json_string_old){
        console.log("same no need to update cookie");
    }else{
        console.log("different ok lets update the cookie");
       $.cookie('myCookie',json_string_new);     
    }    

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:12:06.660

最优雅的方法是按照您最初设置它的方式进行操作 - 用新的数组值覆盖您的 cookie...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:12:57.997

以下是您的操作方法，采用分步格式：

1.  创建您的数组的 JSON 版本`jsonArray`。
2.  拉下JSON格式的cookie
3.  在不反序列化的情况下，将其与`jsonArray`.
4.  如果字符串不相同，请将 cookie 设置为`jsonArray`.
5.  否则，什么也不做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T23:13:48.277

哦，我不知道使用客户端语言在客户端存储上使用 cookie。这真的是为 php 处理的。

你应该在[localStorage](http://www.w3.org/TR/webstorage/)中寻找类似的东西，它更方便。

```
localStorage['item'] = "Hello world";
alert(localStorage['item']); // Hello World

localStorage['item'] += "!!!";
alert(localStorage['item']); // Hello World!!!

localStorage['item'] = "Good bye";
alert(localStorage['item']); // good bye

var obj = {0:{text:"Hello"}, 1:{text:"World"}};
localStorage['item'] = JSON.stringify(obj);
JSON.parse(localStorage['item']); // {0:{text:"Hello"}, 1:{text:"World"}} 
```

`sessionStorage`类似于`localStorage`，但仅在关闭浏览器或选项卡之前持续存在。

* * *

希望这有帮助！

# geometry - 必须彼此保持一定距离的点的最佳位置

> ID：15235904
> 
> 赞同：-1
> 
> 时间：2013-03-05T23:07:36.677
> 
> 标签：geometry

所以我有几个点想放在二维平面上。

我遇到的问题是每个点都有一个特定的距离，它必须与其他每个点放置。我想知道是否有人知道任何方法可以为所有这些点制定满足距离要求的功能布局？

（例如，点 a、b 和 c。a 与 b 的距离必须为 2，与 c 的距离为 3，并且 b 和 c 的距离必须为 4）。

写出来我意识到必须有一些不可能的变化。然而，距离并不是一成不变的，可能会略有不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:39:59.477

这个解决方案可能有点矫枉过正，但它会很好地工作（另外，它很酷）：

从粒子模拟的角度考虑这个问题：将点（以下称为粒子）随机放到 2D 平面上，然后执行质量弹簧模拟以在平面中规则地分布粒子。为此，请使用弹簧连接相邻粒子（4 或 8 个连接的邻居），然后将点之间的所需距离定义为每个弹簧的*静止长度*。

相对距离大于此静止长度的粒子将受到吸引，而相对距离小于静止长度的粒子将受到排斥。对物理系统进行几次迭代，您应该观察到粒子有规律地间隔开，就像电线上的鸟（但在 2D 中）。

谷歌“质量弹簧模拟”和“胡克定律”。[这个链接](http://www.unav.es/adi/UserFiles/File/4000002446/3.%20Mass-Spring%20Models.pdf)很好，这些链接也很好：[链接](http://paulbourke.net/miscellaneous/particle/)、[链接](http://dmg.caup.washington.edu/pdfs/MArch.Thesis.MikeWeller.2011.pdf)、[链接](http://www10.informatik.uni-erlangen.de/Publications/Theses/2010/Czilli_BA_10.pdf)和[链接](http://www.cs.princeton.edu/courses/archive/spr06/cos426/lectures/16-particles.pdf)。这些搜索产生一百万次点击，您甚至可以找到源代码。

正如您可能猜到的那样，我确实认为这是一个编程问题；）

# linux - 在 bash 中使用“declare -a”声明数组有什么好处？

> ID：15235906
> 
> 赞同：3
> 
> 时间：2013-03-05T23:07:45.950
> 
> 标签：linux, arrays, bash, shell

使用 声明数组有什么好处`declare -a`？

例如; using`declare -a foo=(a b c)`比 using 有什么好处`foo=(a b c)`吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:09:55.240

当您`declare`在 bash 中使用变量时，它会成为本地范围。`local`这与使用内置函数相同。在范围界定之外，没有任何好处。必须在 bash 中声明的唯一变量是带有`-A`.

# database - 存储和解析文本日志和报告的理想系统

> ID：15235907
> 
> 赞同：2
> 
> 时间：2013-03-05T23:07:49.683
> 
> 标签：database, text, hadoop, cassandra, hive

我有很多来自运行网络测试的文本报告和日志文件。我想将这些报告和日志存储在数据存储中，我可以在其中解析它们并根据解析的数据运行报告。我还希望这个系统在它接受的报告和日志类型以及它可以用于的数据量和查询/报告方面都是可扩展的。

一位同事建议`Hadoop`可能满足这一需求，我组织中的另一个团队说他们`Cassandra`用于类似的项目（但数据更多，大部分是机器生成的）。我一直在阅读`Hadoop and Cassandra`，我真的不确定使用类似的东西是否会过大，以及每个日志/报告类型具有自定义解析器的关系数据库是否会更加理智。

根据`Hadoop`我`MapReduce`对`Cassandra`. 我也读过一点 about `Hive`，听起来可能有用，但我没有深入研究它。

在我的情况下使用 Hadoop 或 Cassandra（或其他东西）有什么好处（如果有的话）？

任何形式的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T14:43:22.797

这是我从您的问题描述中得到的：

*   您有一些生成日志和文本报告的测试程序。你能大致了解一下这些数据的大小吗？
*   您想在生成这些数据后对其进行分析（即不需要实时分析）
*   您希望在可以摄取和处理的数据大小以及可以执行的查询和分析类型方面具有灵活性

这里有一些关于您提到的工具的见解和注意事项：

*   鉴于已经配置了 Hadoop 集群，Hive 可能是最简单的解决方案：它可以让您将数据视为一组表：SQL 查询、连接等……Hive（大致）与您的集群一样快很大，但您不会立即得到答案：换句话说，您可以将它用于批处理操作，而不是用于交互式 Web 面板之类的东西。

*   Cassandra 对于存储大量数据很有用。它易于扩展，功能强大且相对易于使用。鉴于您的要求，我认为可能需要关注的是，它需要非常彻底地考虑您将用于存储数据的架构：架构将确定您之后可以做什么和不能做什么。因此，如果您想执行更广泛的分析，或以您今天无法想象的新方式读取数据，那么您可能无法做到，因为数据在数据库中的存储方式。

我不太熟悉的其他选项：HBase（基于 HDFS 的数据存储）、Pig（与 Hive 一样，查询被编译到 Hadoop 作业中；改变的是模型：您需要编写“流”而不是 SQL 查询）。

我建议尝试 Hive（或 Pig），也许使用 Amazon EMR 之类的服务（这样您就可以避免 Hadoop 集群设置的麻烦）。

# javascript - GeoJSON 多边形的中心

> ID：15235911
> 
> 赞同：4
> 
> 时间：2013-03-05T23:07:57.553
> 
> 标签：javascript, google-maps, leaflet, geojson

我正在寻找基于[GeoJSON](http://geojson.org/)数据重新定位 JavaScript 地图。我可以从它的数组中计算[多边形](http://geojson.org/geojson-spec.html#polygon)的中心点`coordinates`吗？例如：

```
{
    "data": {
        "type": "Polygon",
        "coordinates": [
            [
                [
                    -9.31640625,
                    43.83452678223682
                ],
                /* etc */
            ]
        ]
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:59:38.143

我想这个问题已经被问过了。

看看[这个问题](https://stackoverflow.com/q/3081021/2110460)。有一个想法可能对你有用。

# structure - 如何将结构动态转换为内部表

> ID：15235913
> 
> 赞同：3
> 
> 时间：2013-03-05T23:08:07.707
> 
> 标签：structure, abap, internal-tables

我正在尝试创建一个方法来导入结构，假设所有结构元素都是平面且数据类型相同。然后我想将它动态转换为具有该类型的表并返回它。我应该从哪里开始？我一直试图让它工作几个小时，但一无所获。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T23:16:30.517

您可以像这样使用`create_dynamic_table`表单`cl_alv_table_create`：

```
* Create dynamic internal table and assign to FS
  CALL METHOD cl_alv_table_create=>create_dynamic_table
    EXPORTING
      it_fieldcatalog  = ifc
      i_length_in_byte = 'X' "added by Paul Robert Oct 28, 2009 17:04
    IMPORTING
      ep_table         = dy_table.
  ASSIGN dy_table->* TO <dyn_table>.
* Create dynamic work area and assign to FS
  CREATE DATA dy_line LIKE LINE OF <dyn_table>.
  ASSIGN dy_line->* TO <dyn_wa>. 
```

[这](http://wiki.sdn.sap.com/wiki/display/ABAP/Dynamic+Internal+table)是一个可以帮助您入门的链接。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T07:46:11.837

**绝对没有必要使用`CL_ALV_TABLE_CREATE`**- 纯粹的矫枉过正。使用[运行时类型服务 (RTTS)](http://help.sap.com/abapdocu_702/en/abenrtti.htm)获取有关您的输入数据的信息（并验证您对组件类型的假设），然后使用[CREATE TABLE 的动态形式](http://help.sap.com/abapdocu_702/en/abapcreate_data_itab.htm)：

```
* asssuming that l_type_name contains the type name of a single element
  CREATE DATA lr_table TYPE STANDARD TABLE OF (l_type_name). 
```

# sql - 无法弄清楚为什么这个查询没有正常运行

> ID：15235916
> 
> 赞同：0
> 
> 时间：2013-03-05T23:08:16.020
> 
> 标签：sql, ms-access

只要条目的 WorkOrderNumber 值相同，我只是试图将员工的姓名连接到一个字段中。

```
$Data = "SELECT tt.WorkOrderNumber AS WN, 
                SUBSTRING(SELECT tt2.AssignedEmp 
                FROM TestTable AS tt2 
                WHERE tt2.WorkOrderNumber=tt.WorkOrderNumber 
                ORDER BY tt2.AssignedEmp) AS emp
                FROM TestTable AS tt"; 
```

每当我运行此查询时，我都会在我的网站上返回：

> 警告：odbc_exec(): SQL 错误：[Microsoft][ODBC Microsoft Access Driver] 此子查询最多可以返回一条记录。

有什么我想念的吗？

为了澄清......我正在拍摄：

假设我有这种形式的数据

```
WorkOrderNumber  AssignedEmp
2012087-28       Jeff      
2012087-28       Bill       
2012087-28       John 
```

我想查询这些数据并得到这样的结果......

```
WorkOrderNumber  Employee            
2012087-28       Jeff,Bill,John 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:10:09.170

这将返回不止一条记录：

```
 SELECT tt2.AssignedEmp 
 FROM TestTable AS tt2 
 WHERE tt2.WorkOrderNumber=tt.WorkOrderNumber 
 ORDER BY tt2.AssignedEmp 
```

这是行不通的。您可以`TOP (1)`对其进行快速而肮脏的修复，但我怀疑您期望此子查询返回的内容没有被返回，因此以这种方式修复它可能是一个坏主意。

# java - Distinct in Select 的帮助

> ID：15235921
> 
> 赞同：-3
> 
> 时间：2013-03-05T23:08:37.817
> 
> 标签：java, sql, select, distinct

我无法弄清楚此 SQL 请求中的错误在哪里，请您帮帮我。我想要显示 projet 的列表 projet.idchef=ac.getid(); 与 RefProjet 不同，

我试试这个方法

```
 rs =c.selection("SELECT distinct Refprojet,idpro,NomProjet  FROM projet,user where projet.iduser=user.id AND projet.IdChef='"+ac.getid()+"'");
     while(rs.next())
     {
             String num =  rs.getString("idpro");
             String nom = rs.getString("NomProjet");
             String ref  = rs.getString("IdProjet");
             jComboBox2.addItem(new RF(nom,ref,num));
     }  } catch (Exception ex) {
             ex.printStackTrace();
        } 
```

我也尝试这种方式

```
...

     rs =c.selection("SELECT Distinct (RefProjet) FROM ( SELECT idpro,NomProjet,RefProjet  from projet  Where projet.idChef='"+ac.getid()+"') as T");
 while(rs.next())
 {
         String num =  rs.getString("idpro");
         String nom = rs.getString("NomProjet");
         String ref  = rs.getString("IdProjet");
         jComboBox2.addItem(new RF(nom,ref,num));
 }  } catch (Exception ex) {
         ex.printStackTrace();
    } 
```

和许多其他但没有任何工作，

我能怎么做 ？！

请帮助并感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:23:13.190

首先尝试使用访问工具（例如 SQL Server Management Studio、SQL Plus 等）调试您的 SQL。一旦你知道你的 SQL 是正确的，然后把它带入 Java 程序。

当您有多个层时，将问题隔离到其中一个层总是好的。在您的情况下，您需要了解问题是出在您的 SQL 中，还是出在您的 Java 编程使用数据访问工具的方式上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T23:27:12.613

```
SELECT refproject,idpro,NomProjet  
FROM projet,user 
where projet.iduser=user.id 
AND projet.IdChef='"+ac.getid()+"'")
AND Refprojet in (select distinct(Refprojet) from project); 
```

# linq - LINQ 不刷新数据

> ID：15235924
> 
> 赞同：0
> 
> 时间：2013-03-05T23:09:03.557
> 
> 标签：linq, asp.net-mvc-4, azure-sql-database, iis-express

我有一个带有 Azure SQL 的 MVC 4 网站，它们的行为很奇怪。当我在本地运行它（IIS Express）时，我对我的数据库有一个 LINQ 查询，即使它发生了变化，它也会返回相同的数据，并且我可以通过单独的查询看到它的不同。我真的很想知道发生了什么事。

我使用的控制器功能是

```
 public int GetNotificationTotalCount(int userId)
    {
        int cnt = 0;
        var tmp = (from entry in _db.NotificationCounts
                   where entry.UserId == userId
                   select entry).FirstOrDefault();

        if (tmp != null) // return zeros
            cnt = tmp.FlagsCount + tmp.RepliesCount;

        return cnt;
    } 
```

，其中*_db*是我的 DataContext 并且 LINQ 返回*IQueryable*。

我知道它会因为*IQueriable*缓存数据，但我正在退出这个函数并且 tmp 对象应该被销毁。或者我认为。

是吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:07:24.110

我假设您的上下文生命周期太长。`DataContext`实例应该是短暂的。该`entry`对象被缓存在其中，因此当您尝试再次获取它时，它会从缓存中取出，除非您明确刷新该对象。

```
public int GetNotificationTotalCount(int userId)
{
    using(var db = new MyDataContext())
    {
        return (from entry in db.NotificationCounts
                where entry.UserId == userId
                select entry.FlagsCount + entry.RepliesCount)
               .FirstOrDefault() ?? 0;
    }
} 
```

# java - 如何将 ArrayList 元素存储到 Java 中的 Array 中？

> ID：15235929
> 
> 赞同：0
> 
> 时间：2013-03-05T23:09:57.017
> 
> 标签：java

我是 Java 新手，想知道是否有人会帮助我解决以下逻辑。我想要做的是遍历一个列表并将每个列表元素存储到数组中。完成后，我想检查数组元素的正确答案。因此，例如输入 3,2,1，则最终得分应为 3。这是代码。

## 代码

```
import java.rmi.RemoteException;
import java.util.ArrayList;
import java.util.List;

public class IterateOverArray {

public static int SCORE = 0;
static List<Integer> list = new ArrayList<Integer>();
static int[] temp;
public static void main(String[] args) throws Exception {

    list.clear();
    list.add(3);
    list.add(2);
    list.add(1);
    getScore();
}

public static void getScore() throws RemoteException {

    temp = new int[3];

    for (Integer value : list) {
        for (int i = 0; i < temp.length; i++) {
            temp[i] += value.intValue();
        }
        if (temp[0] == 3) {
            SCORE++;
        }
        if (temp[1] == 2) {
            SCORE++;
        }
        if (temp[2] == 1) {
            SCORE++;
        }
    }
    System.out.println("total score: " + SCORE); // Final Score should be 3!
}
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:18:42.950

当对算法有疑问时：**心理步骤！**

1.  称呼`getScore()`
2.  新数组`tmp`，所有元素初始化为`0`
3.  `value`第一次迭代，值为`3`
4.  添加`3`到数组中的所有元素（使它们**全部**为 3）
5.  检查数组中的第一个元素是否是`3`--> 是，增加分数
6.  下一次迭代，`value`现在的值`2`
7.  **添加** `2`到数组的所有元素（使所有**元素**`5`）
8.  ...

你在这里看到你的缺陷了吗？

in 的值`tmp`会变得更高，然后永远不会`true`在您的`if`-statements 中评估。你想在你的内部 for 循环中使用`=`而不是吗？`+=`

* * *

这是一个示例实现：

```
static List<Integer> list = new ArrayList<Integer>();
// ...
list.add(3);
list.add(2);
list.add(1);
getScore();

public static void getScore() throws RemoteException {
    if (list.get(0) == 3) {
        SCORE++;
    }
    if (list.get(1) == 2) {
        SCORE++;
    }
    if (list.get(2) == 1) {
        SCORE++;
    }
    System.out.println("total score: " + SCORE);
} 
```

A`List`只是一个*动态增长的*数组。它的行为就像一个数组，您可以通过使用`get(index)`- 方法（这是 using 的“等效” `[index]`）从中获取单个项目。

您根本不需要复制您的内容。但是如果必须使用数组，可以使用[-method](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#toArray%28%29)`List`将 a 转换为数组。[`List.toArray()`](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#toArray%28%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:35:57.273

我只是将正确的答案放在一个数组中，然后在进行时进行比较。无需将事物转换为数组等。

```
int getScore(List<Integer> answers) {
    Integer[] correctAnswers = {3,2,1};
    int score = 0;
    for (int i = 0; i < 3; i++) 
        if (correnctAnswers[i].equals(answers.get(i)))
            score++;
    return score;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:22:57.330

```
package farzi;

import java.util.ArrayList;

public class ArrayListToArray 
{
    public static void main (String args[])
    {
        ArrayList<String> arrList = new ArrayList<String>();
        arrList.add("hussi1");
        arrList.add("hussi2");
        arrList.add("hussi3");
        String[] strArray = new String[arrList.size()];
        arrList.toArray(strArray);
        for(int i=0;i<strArray.length;i++)
        {
            System.out.println(strArray[i]);
        }
    }

} 
```

# android - 将 SQLite 数据库中的地址显示为 android 中 Google Maps 中的精确点

> ID：15235932
> 
> 赞同：0
> 
> 时间：2013-03-05T23:10:11.660
> 
> 标签：android, sqlite, google-maps, addressbook

我目前正在开发一个android应用程序。我`SQLite database`在应用程序中也进行了设置`Google Maps`（即当用户想要查看地图时它会显示地图）。

*   我的问题是我`SQLite database`有 3 列：姓名、手机号码和地址。我的目标是用户在地址栏中输入的内容在`Google Maps`. 例如，如果有人进入：Richard, 0333 1321421, Berlin Street Hawaii。然后在谷歌地图中的那个特定地址上应该会出现一个精确的位置。到目前为止，我还没有弄清楚如何做到这一点。

如果有人能告诉我如何：

1.  将地址条目转换为经度、纬度
2.  在该特定纬度、经度的谷歌地图中显示一个精确点。

此外，是否需要将地址转换为纬度、经度，或者仅使用地址就可以直接在地址上进行精确定位。

任何证明这一点的示例代码都会非常有帮助。我目前正在 eclipse java 中的 Google API 2.2 api level 8 中制作这个应用程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:42:03.413

如您所知，您需要执行两个工作步骤：

1.  将您的文本字符串地址转换为`Latlng`坐标。

2.  `LatLng`使用您在第一步中找到的坐标在地图上显示一个标记。

第一步，您可以在此处找到代码：

[如何从地址中找到纬度和经度？](https://stackoverflow.com/questions/3574644/how-can-i-find-the-latitude-and-longitude-from-address)

对于第二部分，了解您使用的是什么版本的 Google 地图 API 很重要？

**更新：**

[https://github.com/commonsguy/cw-android/blob/master/Maps/NooYawk/src/com/commonsware/android/maps/NooYawk.java](https://github.com/commonsguy/cw-android/blob/master/Maps/NooYawk/src/com/commonsware/android/maps/NooYawk.java)

但请记住，此版本的 Google 地图很快就会被弃用。

# javascript - 快速隐藏 iOS/Android URL 栏

> ID：15235933
> 
> 赞同：0
> 
> 时间：2013-03-05T23:10:14.093
> 
> 标签：javascript, android, ios

我正在尝试在 iOS 上的 Safari 中“隐藏” URL 栏（也适用于 Android 浏览器）。我遇到了许多变体，都在做这样的事情：

```
window.addEventListener("load", function () {
    setTimeout(function () {
        window.scrollTo(0, 1);
    }, 0);
}); 
```

这确实将视口的顶部定位在屏幕的顶部，大约 3-5 秒后，URL 栏确实消失了。但是，如果您查看[Gmail 的移动网站或](https://mail.google.com)[Facebook](https://m.facebook.com/index.php)的移动登录屏幕，您会看到 URL 栏迅速消失（不到 2 秒）。

有谁知道他们在做什么来让 URL 栏快速隐藏起来？

这个问题接近我所追求的，但它并没有完全解决我的问题：[如何在 ipod touch 中隐藏 URL 栏](https://stackoverflow.com/questions/2338638/how-to-hide-url-bar-in-ipod-touch)- 如果你看一下[iUI demo](http://www.iui-js.org/demo)，它似乎也迅速隐藏了 URL 栏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:37:09.653

这能回答安卓的问题吗？

```
$(document).ready(function() { setTimeout(scrollTo,200,0,1) }); 
```

[在 Android Webkit 中隐藏 URL 栏](https://stackoverflow.com/questions/3107812/hide-the-url-bar-in-android-webkit)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T01:13:03.627

在我正在使用的完整测试页面中，我有几段文字可以使文档更长。此文本导致 Safari`Reader`在 URL 栏中显示按钮。好吧，显然，当`Reader`按钮出现时，URL 栏不会像没有该按钮时那样迅速地隐藏*自己*。

我找不到任何可以解释更长等待的东西（我认为这是有道理的），但这里有更多信息：

*   [http://mathiasbynens.be/notes/safari-reader](http://mathiasbynens.be/notes/safari-reader)
*   [https://superuser.com/questions/387572/how-does-safaris-reader-work-and-when-does-it-show-up](https://superuser.com/questions/387572/how-does-safaris-reader-work-and-when-does-it-show-up)

# php - 将 .Toggleclass 一次限制为一个？

> ID：15235934
> 
> 赞同：0
> 
> 时间：2013-03-05T23:10:14.490
> 
> 标签：php, javascript, html, css

目前有这段代码可以在单击图像时交换类，并且它在 PHP Html 循环中为每个内容帖子创建图像按钮，但我想将类交换限制为一次一个，所以如果我点击另一个帖子中的图像，其他帖子的图像将恢复为默认值。有任何想法吗？

```
{LOOP: STORIES}
<script type="text/javascript">

 $("#{STORIES.story_id}6 :image").click(function() {
        widget.toggle();
        $("#{STORIES.story_id}6").toggleClass('buyy');
};
</script>

<span class="buy" id="{STORIES.story_id}6"><input type="image" class="TEST"></input></span>
{/LOOP: STORIES} 
```

# php - FPDF - 它可以处理混合方向（纵向/横向）的原始 PDF 吗？

> ID：15235935
> 
> 赞同：5
> 
> 时间：2013-03-05T23:10:52.943
> 
> 标签：php, fpdf, fpdi

我正在使用 FPDF() 方法（来自 FPDI_Protection.php）导入现有 PDF 并应用密码保护。

我遇到的问题是原始 PDF 混合了纵向和横向页面（8.5“X11”和 11“X8.5”），而导入方法让您定义一次。我可以将新创建​​的 pdf 定义为 11"X11"，这解决了其中一个方向裁剪的问题，但这对于打印目的并不理想，因为 PDF 被缩放并左对齐，导致可读性/打印输出不佳。

在循环遍历原始文档时，是否可以使用任何类型的例程来检测原始尺寸并即时设置新的页面方向？

```
function pdfEncrypt ($origFile, $password, $destFile)  // RESPONSIBLE FOR ADDING PASSWORD PROTECTION TO PDF FILES
{
    require_once('fpdi/FPDI_Protection.php');

    $pdf = new FPDI_Protection();
    // set the format of the destinaton file, in our case 6×9 inch
    $pdf->FPDF('P', 'in', array('11','11'));

    //calculate the number of pages from the original document
    $pagecount = $pdf->setSourceFile($origFile);

    // copy all pages from the old unprotected pdf in the new one
    for ($loop = 1; $loop <= $pagecount; $loop++)
    {
        $tplidx = $pdf->importPage($loop);
        $pdf->addPage();
        $pdf->useTemplate($tplidx);
    }

    // protect the new pdf file, and allow no printing, copy etc and leave only reading allowed
    $pdf->SetProtection(array('print'), $password, '');
    $pdf->Output($destFile, 'F');

    return $destFile;
} 
```

或者，是否有更简单的方法可以使用 php 向现有 pdf 添加密码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T23:21:55.840

好的，我在这个上拉了几天头发。在不知疲倦地搜索与我的问题相关的术语的每一次迭代之后，我能够找到一个实际有效的解决方案实例（我尝试安装 pdflib lite、phpinfo、ghostscript、xpdf 等，以测量尺寸无济于事）。起作用的是这个（你需要[FPDI_Protection 包](http://www.setasign.de/supra/kon2_dl/34141/FPDI_Protection-1.0.4.zip)[免费]）：

```
 $specs = $pdf->getTemplateSize($tplidx);
    $pdf->addPage($specs['h'] > $specs['w'] ? 'P' : 'L'); 
```

完整功能如下：

```
function pdfEncrypt ($origFile, $password, $destFile)  // RESPONSIBLE FOR ADDING PASSWORD PROTECTION TO PDF FILES
{
    require_once('fpdi/FPDI_Protection.php');

    $pdf = new FPDI_Protection();
    // set the format of the destinaton file
    $pdf->FPDF('P', 'in', array('8.5','11'));

    //calculate the number of pages from the original document
    $pagecount = $pdf->setSourceFile($origFile);

    // copy all pages from the old unprotected pdf in the new one
    for ($loop = 1; $loop <= $pagecount; $loop++)
    {

        $tplidx = $pdf->importPage($loop);

        $specs = $pdf->getTemplateSize($tplidx);
        $pdf->addPage($specs['h'] > $specs['w'] ? 'P' : 'L');
        $pdf->useTemplate($tplidx);
    }

    // protect the new pdf file

    $pdf->SetProtection(array('print'), $password, '');
    $pdf->Output($destFile, 'F');

    return $destFile;
} 
```

这两行代码的添加能够检测原始页面是否是横向的，并以相同的方式在输出文件中重新创建页面。哈利路亚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T11:33:27.683

感谢您的发帖，我可以在一分钟内解决我的定位问题！

无论如何，您不需要单独的方向更改特殊的 FPDI_"Protection" 包，工作解决方案只需要 "FPDI" 包（用于 getTemplatesize 函数）。以下是 2012 年 8 月解决方案的链接： [FPDF / FPDI addPage() Orientation](https://stackoverflow.com/questions/12185777/fpdf-fpdi-addpage-orientation)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-13T12:02:17.133

在我的 fpdf_tpl.php (1.6.1) 中，添加页面的方法称为**AddPage**而不是 addPage。看一下，如果您调用 addPage 该方法不会执行并且您无法更改方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-01T11:53:47.137

要使用 getTemplateSize，您只需要[setasign/fpdi](https://packagist.org/packages/setasign/fpdi)包。对于这个包的当前版本（**v2.3.6**），height 和 width 键不再是 'w' 和 'h' 而是 'width' 和 'height'：

（来自 setasign\Fpdi\Fpdi.php）

```
/**
 * Get the size of an imported page or template.
 *
 * Give only one of the size parameters (width, height) to calculate the other one automatically in view to the
 * aspect ratio.
 *
 * @param mixed $tpl The template id
 * @param float|int|null $width The width.
 * @param float|int|null $height The height.
 * @return array|bool An array with following keys: width, height, 0 (=width), 1 (=height), orientation (L or P)
 */
public function getTemplateSize($tpl, $width = null, $height = null)
{
    ...
} 
```

# dita - 如何为嵌套的无序列表使用破折号？

> ID：15235938
> 
> 赞同：1
> 
> 时间：2013-03-05T23:11:20.290
> 
> 标签：dita, dita-ot

**问题：**我想将所有嵌套的无序列表切换为破折号而不是项目符号。

我相信选择这些嵌套列表项的 XPath 表达式是：//ul/li/ul//li

我相信这是修改的适当模板：

```
<xsl:template match="*[contains(@class, ' topic/ul ')]/*[contains(@class, ' topic/li ')]">
    <fo:list-item xsl:use-attribute-sets="ul.li">
        <fo:list-item-label xsl:use-attribute-sets="ul.li__label">
            <fo:block xsl:use-attribute-sets="ul.li__label__content">
                <fo:inline>
                    <xsl:call-template name="commonattributes"/>
                </fo:inline>
                <xsl:call-template name="insertVariable">
                    <xsl:with-param name="theVariableID" select="'Unordered List bullet'"/>
                </xsl:call-template>
            </fo:block>
        </fo:list-item-label>

        <fo:list-item-body xsl:use-attribute-sets="ul.li__body">
            <fo:block xsl:use-attribute-sets="ul.li__content">
                <xsl:apply-templates/>
            </fo:block>
        </fo:list-item-body>

    </fo:list-item>
</xsl:template> 
```

它引用 en.xml 中名为“Unordered List Bullet”的变量：

```
<variable id="Unordered List bullet">&#x2022;</variable> 
```

我尝试包装该变量调用以引用另一个变量“Unordered List Dash”（如果它是嵌套的）。我还是有点挂了。什么是最优雅的方法？我应该为这些嵌套项目设置一个额外的模板吗？

我正在使用 DITA-OT 1.5.4。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T17:39:48.380

当无序列表是任何其他列表类型（包括任务步骤）的子项时，此列表模板覆盖使用破折号格式化所有无序列表项，因此您可能需要在 xsl:when 测试属性中细化 XPath 表达式。

```
 <xsl:template match="*[contains(@class, ' topic/ul ')]/*[contains(@class, ' topic/li ')]">
    <fo:list-item xsl:use-attribute-sets="ul.li">
      <fo:list-item-label xsl:use-attribute-sets="ul.li__label">
        <fo:block xsl:use-attribute-sets="ul.li__label__content">
          <fo:inline>
            <xsl:call-template name="commonattributes"/>
          </fo:inline>
          <xsl:choose>
            <xsl:when test="ancestor::*[contains(@class, ' topic/li ')]">
              <xsl:call-template name="insertVariable">
                <xsl:with-param name="theVariableID" select="'Unordered List dash'"/>
              </xsl:call-template>
            </xsl:when>
            <xsl:otherwise>
              <xsl:call-template name="insertVariable">
                <xsl:with-param name="theVariableID" select="'Unordered List bullet'"/>
              </xsl:call-template>
            </xsl:otherwise>
          </xsl:choose>
        </fo:block>
      </fo:list-item-label>
      <fo:list-item-body xsl:use-attribute-sets="ul.li__body">
        <fo:block xsl:use-attribute-sets="ul.li__content">
          <xsl:apply-templates/>
        </fo:block>
      </fo:list-item-body>
    </fo:list-item>
  </xsl:template> 
```

这是字符串文件中的变量。<`variable id="Unordered List dash">-</variable>`

# sql-server - 如果它是运行总和中的某种类型，则排除记录

> ID：15235939
> 
> 赞同：0
> 
> 时间：2013-03-05T23:11:22.800
> 
> 标签：sql-server, sql-server-2008, tsql, stored-procedures

像这样的表：

```
Description Type    Amount
Record      1       10
Record      2       20
Record      1       5
Record      3       10 
```

如何在我的运行总和中排除某种类型的记录？因此，如果我排除类型 3，我的运行总和变为：

```
Description Type    Amount  RunningSum
Record      1       10      10
Record      2       20      30
Record      1       5       35 
```

我正在使用更新局部变量技术。我有的：

```
DECLARE @Amount DECIMAL(18, 4)

SET @Amount = 0

UPDATE MY_TABLE
SET RunningTotal = @Amount
    ,@Amount = @Amount + ISNULL(Amount, 0) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:21:58.487

看起来像一个简单的`WHERE`条款，不是吗？

```
WHERE [Type] <> 3; 
```

示例（尽管不确定为什么将变量声明为`DECIMAL`）：

```
DECLARE @d TABLE
(
  Description CHAR(6), 
  [Type] INT, -- bad column name choice!
  Amount DECIMAL(18,4), 
  RunningTotal DECIMAL(18,4) NULL
);

INSERT @d VALUES
 ('Record',1,10,NULL),
 ('Record',2,20,NULL),
 ('Record',1,5 ,NULL),
 ('Record',3,10,NULL);

DECLARE @rt DECIMAL(18, 4) = 0; -- calling this @Amount is confusing
                                -- it is storing the running total!

UPDATE @d
  SET @rt = RunningTotal = @rt + Amount
  WHERE [Type] <> 3;

SELECT Description, [Type], Amount, RunningTotal FROM @d; 
```

结果：

```
Description Type Amount  RunningTotal
----------- ---- ------- ------------
Record      1    10.0000      10.0000
Record      2    20.0000      30.0000
Record      1     5.0000      35.0000
Record      3    10.0000         NULL 
```

另请注意，您使用的这种“古怪更新”方法没有记录，不受支持，并且可能会产生不可预测的结果。

[http://sqlperformance.com/running-totals](http://sqlperformance.com/running-totals)

# javascript - 如何让“左键单击”模仿“目标另存为”？

> ID：15235940
> 
> 赞同：2
> 
> 时间：2013-03-05T23:11:31.397
> 
> 标签：javascript, mouseevent

反正有没有用纯 Javascript 完成这项工作？

当人们单击以下内容时：

```
<div id=mydiv">Left click for download</div> 
```

Javascript 的外观如何？我在用着：

```
$('#mydiv').click(function() {
  window.location.href('where_my_File_is.file');
}); 
```

但这只是打开它。有人有一个简单的javascript脚本吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:58:51.517

评论中链接的答案解释了为什么这不能在 Javascript 中完成，而是需要在服务器端完成。这一个特别解释了为什么会这样：

[https://stackoverflow.com/a/5192922/560114](https://stackoverflow.com/a/5192922/560114)

我只是想补充一点，有一种方法可以在客户端启动下载，但它需要使用 Flash，在这里它可能对您没有帮助，因为它的目的是使下载文本文件成为可能您已使用 Javascript 生成：

[https://github.com/dcneiner/Downloadify](https://github.com/dcneiner/Downloadify)

如果它是一个远程文件，那么强制下载的最佳方法是让服务器将其读入内存，然后将其与强制下载所需的标头一起输出。无论是本地还是远程，服务器的标头至少需要包含`Content-Disposition: attachment`. 这是 PHP 中的跨浏览器示例：

[http://davidwalsh.name/php-force-download](http://davidwalsh.name/php-force-download)

# javascript - d3.js 路径上的工具提示

> ID：15235944
> 
> 赞同：2
> 
> 时间：2013-03-05T23:11:40.587
> 
> 标签：javascript, d3.js, tooltip

我读过的很多关于 d3.js 和工具提示的内容都提到了在图表上具有各个点。

相反，我的图表使用一条长路径进行渲染。我想知道如何将鼠标悬停方法应用于这样的路径，然后我会在其中相应地绑定一个工具提示 div

[http://jsfiddle.net/ericps/xJ3Ke/6/](http://jsfiddle.net/ericps/xJ3Ke/6/)

```
svg.append("path")
.attr("class", "area")
.attr("clip-path", "url(#clip)")
.style("fill", "url(#gradient)"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T02:48:26.870

您可以设置一层不可见的对象来表示您想要为其设置工具提示的每个点，并向这些对象添加鼠标交互。

我已经用以下内容更新了你的 jsfiddle -

```
svg.selectAll("circle")
    .data(data)
  .enter().append("circle")
    .attr("r", 5)
    .style("fill","none")
    .style("stroke","none")
    .style("pointer-events","all")
  .append("title")
    .text(function(d) { return "Date: " + formatDate2(d.date) + " Value: " + d.value; }); 
```

这会为每个数据点添加一个圆元素，并为每个圆添加一个标题元素。请注意，`"pointer-events","all"`即使元素不可见，也允许鼠标交互

完整的jsfiddle在这里：http: [//jsfiddle.net/xJ3Ke/9/](http://jsfiddle.net/xJ3Ke/9/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-25T02:10:12.380

下面是我使用的一个简单的 Tooltip 类。

```
/**
 * Tooltip helper.
 *
 * Copyright © 2014 Maciej Nux Jaros.
 * License: CC-BY or MIT.
 */
function Tooltip() {
    var _tooltip = this;
    var _container = null;

    /**
     * Tootltip class name (use if you want more then one tooltip).
     * @type String
     */
    this.className = 'tooltip';
    /**
     * Width of the rect.
     * @type String
     */
    this.width = "100";
    /**
     * Height of the rect.
     * @type String
     */
    this.height = "20";
    /**
     * Tootltip source attribute.
     * @type String
     */
    this.textSourceAttrName = 'data-title';
    /**
     * Style of background rectangle.
     * @type String
     */
    this.rectStyle = "opacity:0.9;fill:#ffffff;fill-opacity:1;stroke:#ffcc00;stroke-width:3;";

    /**
     * Init tooltip elements and append to container.
     * 
     * @param {D3} container D3 container element - e.g. main group (chart container).
     */
    this.init = function(container) {
        _container = container;

        container.append("g")
            .attr("class", _tooltip.className)
            .attr("style", "display:none")
            .append("rect")
                .attr("style", _tooltip.rectStyle)
                .attr("width", _tooltip.width)
                .attr("height", _tooltip.height)
                .attr("rx", "10")
                .attr("ry", "10")
        ;
        container.selectAll("." + _tooltip.className)
            .append("text")
                .attr("x", 5)
                .attr("y", 10)
                .attr("dy", ".35em")
        ;
    };

    /**
     * Show tooltip (title) for given point
     *
     * run e.g. onmouseover
     *
     * @param {Element} point Circle element.
     */
    this.show = function(point) {
        var text = point.getAttribute(_tooltip.textSourceAttrName);
        var x = parseFloat(point.getAttribute('cx')) + 10;
        var y = parseFloat(point.getAttribute('cy')) + 5;
        _container
            .selectAll("." + _tooltip.className)
            .attr("style", "")
            .attr("transform", function() { return "translate(" + x + "," + y + ")"; })
        ;
        _container
            .selectAll("." + _tooltip.className + " text")
            .text(function() { return text; })
        ;
    };

    /**
     * Hide tooltip.
     *
     * run e.g. onmouseout
     */
    this.hide = function() {
        _container
            .selectAll("." + _tooltip.className)
            .attr("style", "display:none")
        ;
    };
} 
```

用法（假设您有X 和 Y 上的`countries`数据系列）：`date``share`

```
// points
for (var i=0; i<countries.length; i++) {
    var points = svg.selectAll(".points" + i)
        .data(countries[i].values)
        .enter()
        .append("g")
            .attr("class", ".points" + i)
    ;
    // visible points
    points
        .append("circle")
            .attr("class", "point")
            .attr("stroke", "none")
            .attr("fill", "black")
            .attr("cx", function(d, i) { return x(d.date) })
            .attr("cy", function(d, i) { return y(d.share) })
            .attr("r", function(d, i) { return 2 })
    ;
    // bigger (almost) invisible points for tooltip
    points
        .append("circle")
            .attr("class", "blank-point")
            .attr("style", "opacity:0.05;fill-opacity:1;")
            .style("fill", function(d) { return color(countries[i].name); })
            .attr("cx", function(d, i) { return x(d.date) })
            .attr("cy", function(d, i) { return y(d.share) })
            .attr("r", function(d, i) { return 6 })
            .attr("data-title", function(d, i) { return formatDate(d.date) +'; '+ d.share })
            .attr("onmouseover", "tooltip.show(this)")
            .attr("onmouseout", "tooltip.hide()")
    ;
}

// prepare tooltip
tooltip.init(svg); 
```

请注意确保在图表上的其他内容之后准备工具提示，否则它将不可见。还要确保图表右侧有足够的空间（例如，将图表的右边距设置为 100 或更多）。

# asp.net - 在 ASP DataList 中为 HeaderTemplate 使用标记

> ID：15235945
> 
> 赞同：0
> 
> 时间：2013-03-05T23:11:45.083
> 
> 标签：asp.net, datalist

是否可以让 DataList 控件使用`<th>`标题模板的标签而不是常规`<td>`单元格？使用中继器控件不是解决方案，因为我需要多列布局。

# assembly - ASM 通过循环更快？

> ID：15235954
> 
> 赞同：3
> 
> 时间：2013-03-05T23:12:14.117
> 
> 标签：assembly

汇编器中的代码循环是否更快/等于/更慢，然后只需编写指令x次，这是需要的吗？还是依赖于代码？但是机器何时执行二进制文件更快：如果 16 位 CPU 直接读取其 16 位还是返回 32 位？

最后；asm中的循环是什么意思？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T23:20:10.743

这取决于。重复一些指令可能会更快。这种技术通常称为[循环展开](http://en.wikipedia.org/wiki/Loop_unwinding)。未展开的循环也可以变得更有效，因为代码会更小，并且许多 CPU 能够并且通常可以识别循环模式并预测它。也可以有一个部分展开的循环。例如，不是直接执行 20 条指令或执行 20 次循环迭代，而是可以执行 5 次循环迭代，每次执行 4 条指令。

通常，如果不知道您的目标是什么架构（即 CPU 的品牌和型号），就很难判断什么是最好的。这就是为什么人们不会真正编写大量汇编代码的原因——分析不同方法的优缺点、执行成本以及为不同的 CPU 品牌和型号生成不同的代码是编译器开发人员要做的事情。然后其他人用他们选择的语言编写代码，编译器为目标平台生成可能的最佳程序集，这在 99% 的情况下都有效。

要回答您的问题，您可能会自己编写这两个版本并分析它们以查看哪一个获胜。或者，您可以用 C 编写代码并为您的平台启用优化（即使用`-O3`、`-march`开关）并查看编译器生成什么——它肯定会做正确的事情。

希望能帮助到你。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:28:40.880

`loop`在 asm 中通常表示分支如果相等或类似的东西。如果您使用的是 HLE 并且不在一个在一条指令中执行比较和分支的平台上工作，则它可能是一个伪指令，相当于 x86`cmpl`和`je`.

MIPS 分支指令：[http ://en.wikibooks.org/wiki/MIPS_Assembly/Control_Flow_Instructions#Branch_Instructions](http://en.wikibooks.org/wiki/MIPS_Assembly/Control_Flow_Instructions#Branch_Instructions)

另请查看以下问题：

*   [什么时候，如果有的话，循环展开仍然有用吗？](https://stackoverflow.com/questions/2349211/when-if-ever-is-loop-unrolling-still-useful)
*   [优化编译器如何决定何时展开循环以及展开循环的程度？](https://stackoverflow.com/questions/7691215/how-do-optimizing-compilers-decide-when-and-how-much-to-unroll-a-loop)
*   [如何向 gcc 提供有关循环计数的提示](https://stackoverflow.com/questions/14256156/how-to-give-hint-to-gcc-about-loop-count)

# codeigniter - 使用 Code Igniter 自定义处理 DB 错误

> ID：15235956
> 
> 赞同：0
> 
> 时间：2013-03-05T23:12:28.307
> 
> 标签：codeigniter

我遇到了一个问题，我的 ci_sessions 表已损坏，并且错误 + 原始 SQL 显示在网站上。

如果我将 db_debug 设置为 false，那么我会得到一个带有 200 响应头的空白屏幕。如何覆盖它以显示友好页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T05:36:50.790

首先，我建议您转向`db_debug`，`false`因为（如您所说）它显示原始 SQL 数据并且在安全性方面并不是很整洁。

也就是说，您可以使用 . 查看 SQL 的任何错误消息`$this->db->_error_message()`。

使用它作为 IF 条件来显示其他页面，或者做其他任何事情。

```
$this->db->get("any table"); // this is where your original db statement goes
if ($this->db->_error_message()) {
    return false;  // you can do this, or show another view, or anything
} 
```

注意：`$this->db->_error_message()`不是官方支持的功能，可能会在未来的 CI 版本中更改。所以在那儿要小心。

# java - 在字符串之前添加空格 - 不像我想象的那样运作

> ID：15235957
> 
> 赞同：2
> 
> 时间：2013-03-05T23:12:32.990
> 
> 标签：java, concatenation

我熟悉串联，这是一个足够简单的概念。我正在尝试使用一个简单的子字符串方法来右对齐几个数字。这是我所拥有的，希望能更好地解释它：

```
String a1 = "    " + "" + a;
String e1 = "    " + "" + e;
String i1 = "    " + "" + i;
String o1 = "    " + "" + o;
String u1 = "    " + "" + u;

System.out.println ("The file contained:");
System.out.println ("A: " +  a1.substring(4));
System.out.println ("E: " +  e1.substring(4));
System.out.println ("I: " +  i1.substring(4));
System.out.println ("O: " +  o1.substring(4));
System.out.println ("U: " +  u1.substring(4)); 
```

我省略了其余的代码，因为它与我的问题无关（并且工作正常）。

我希望这样做是将 a、e、i、o 和 u 与 4 个“空格”连接起来。当我运行程序时，在 a、e、i、o 或 u 之前没有任何空格的迹象。

任何帮助或输入表示赞赏，谢谢。

编辑*：我应该澄清一下。我想要字符串的最后 4 个字符，因此是 a1.substring(4);。

编辑2：我是个白痴。这对我来说是一个非常简单的忽视。使用子字符串右对齐的正确代码：

```
 String a1 = "    " + a;
     String e1 = "    " + e;
     String i1 = "    " + i;
     String o1 = "    " + o;
     String u1 = "    " + u;
  System.out.println ("The file contained:");
  System.out.println ("A: " +  a1.substring(a1.length() - 4));
  System.out.println ("E: " +  e1.substring(e1.length() - 4));
  System.out.println ("I: " +  i1.substring(i1.length() - 4));
  System.out.println ("O: " +  o1.substring(o1.length() - 4));
  System.out.println ("U: " +  u1.substring(u1.length() - 4)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T23:19:28.813

如果你想做的只是整数右对齐，你可以这样做`printf`：

```
int a = 10;
int b = 100;
System.out.printf("A:%20d\n", a);
System.out.printf("B:%20d\n", b); 
```

输出：

```
A:                  10
B:                 100 
```

在有问题的编辑后编辑。

要获取字符串的最后四个字符，请执行

```
s.substring(s.length()-4) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T23:18:50.620

如果您需要使用空格，您可以执行以下操作：

```
String a1 = "    " + a;
String e1 = "    " + e;
String i1 = "    " + i;
String o1 = "    " + o;
String u1 = "    " + u;

System.out.println ("The file contained:");
System.out.println ("A: " +  a1);
System.out.println ("E: " +  e1);
System.out.println ("I: " +  i1);
System.out.println ("O: " +  o1);
System.out.println ("U: " +  u1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:16:35.217

尝试

```
String a1 = "    " + "" + a;
String e1 = "    " + "" + e;
String i1 = "    " + "" + i;
String o1 = "    " + "" + o;
String u1 = "    " + "" + u;

System.out.println ("The file contained:");
System.out.println ("A: " +  a1.substring(0, 4));
System.out.println ("E: " +  e1.substring(0, 4));
System.out.println ("I: " +  i1.substring(0, 4));
System.out.println ("O: " +  o1.substring(0, 4));
System.out.println ("U: " +  u1.substring(0, 4)); 
```

substring(4) 精确打印字符串的第 4 个索引 substring(0,4) 从索引 0 打印到第 4 个。

# ruby-on-rails - 使用 respond_with 服务 404？

> ID：15235959
> 
> 赞同：3
> 
> 时间：2013-03-05T23:12:51.410
> 
> 标签：ruby-on-rails, http-status-codes, respond-with

我正在尝试在 Rails 中提供自定义 404 响应，但我不确定如何将 :status 赋予`respond_with`函数。

我知道`render`，我可以做这样的事情：

```
render :status => :not_found, :json => {:response =>"There weren't any results"} 
```

我怎么能做这样的事情`respond_with`呢？有没有办法设置状态码`respond_with`？

我使用的唯一原因`respond_with`是，据我了解，`respond_with`当您开始使用`respond_to`. 如果这不正确并且我应该使用`render`，请告诉我！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T23:43:17.010

请参阅[文档](http://api.rubyonrails.org/classes/ActionController/Responder.html#label-Custom+options)；作为一种选择`respond_with`。`:status`

```
respond_with(@user, status: :not_found) do |format|
  format.json { response: "There weren't any results" }
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T12:29:05.593

而不是在您的响应中设置特定的 404 状态，您可以只引发一个`ActiveRecord::RecordNotFound`异常并且它具有相同的效果。[在这里检查](https://stackoverflow.com/a/4983354/895789)

# powershell - 在远程计算机上调用 Start-Process "MsiExec.exe" 时出现 PSRemotingTransportException

> ID：15235965
> 
> 赞同：0
> 
> 时间：2013-03-05T23:13:19.777
> 
> 标签：powershell, windows-installer, powershell-remoting

我正在尝试在远程计算机上运行以下命令来卸载以前版本的产品，然后再安装另一个版本。这是使用 MsiExec.exe 进行卸载。

每当我调用 Start-Process 时，该进程实际上会运行并且产品会在远程计算机上卸载，但我会抛出以下异常。如果该产品尚未安装且 Start-Process 行未运行，则远程命令可以正常工作而不会引发异常。（即它实际上搜索注册表，没有找到产品，并返回 -1 而不抛出异常） 问题仅在调用 Start-Process 时出现。

这是我的脚本代码...

```
$UninstallScriptBlock = {
    param ( [string]$InstallerProductName )

    $ErrorActionPreference = "Stop";

    $UninstallRegPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall";
    $ProductCode = Get-ChildItem -Path $UninstallRegPath | foreach { if ($_.GetValue("DisplayName") -eq $InstallerProductName) { [System.IO.Path]::GetFileName($_); } }
    if ([string]::IsNullOrEmpty($ProductCode))
    {
        $UninstallRegPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall";
        $ProductCode = Get-ChildItem -Path $UninstallRegPath | foreach { if ($_.GetValue("DisplayName") -eq $InstallerProductName) { [System.IO.Path]::GetFileName($_); } }
    }
    if ([string]::IsNullOrEmpty($ProductCode))
    {
        return -1;
    }

    $Process = Start-Process -Wait -Passthru -FilePath "MsiExec.exe" -ArgumentList "/X", $ProductCode, "/qn";
    return $Process.ExitCode;
}

[int]$UninstallReturnCode = Invoke-Command -ComputerName $Server -ScriptBlock $UninstallScriptBlock -ArgumentList $InstallerProductName -SessionOption (New-PSSessionOption -OperationTimeout 0); 
```

和抛出的异常......

```
Processing data for a remote command failed with the following error message: The I/O operation has been aborted because of either a thread exit or an application request. For more information, see the about_Remote_Troubleshooting Help topic.
At [Undisclosed]
+     [int]$UninstallReturnCode = Invoke-Command -ComputerName $Server -ScriptBloc ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
+ CategoryInfo          : OperationStopped: ([UndisclosedServerName]:String) [], PSRemotingTransportException
+ FullyQualifiedErrorId : JobFailure
+ PSComputerName        : [UndisclosedServerName] 
```

和格式错误...

```
ErrorCode                   : 995
TransportMessage            : The I/O operation has been aborted because of either a thread exit or an application request.

ErrorRecord                 : Processing data for a remote command failed with the following error message: The I/O
                              operation has been aborted because of either a thread exit or an application request. For
                              more information, see the about_Remote_Troubleshooting Help topic.
StackTrace                  :
WasThrownFromThrowStatement : False
Message                     : Processing data for a remote command failed with the following error message: The I/O
                              operation has been aborted because of either a thread exit or an application request. For
                              more information, see the about_Remote_Troubleshooting Help topic.
Data                        : {}
InnerException              :
TargetSite                  :
HelpLink                    :
Source                      : 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T14:56:45.010

我能找到的最佳答案是我的卸载正在重置 IIS，这导致我的 Powershell Remoting 连接被切断。

这就是我作为解决方法所做的：

1.  从 Start-Process 中删除 -Wait 并立即关闭 Powershell Remoting 会话。
2.  Powershell Remoting 会话关闭后，进入 Start-Sleep 等待卸载完成（猜测卸载需要多长时间加上一些填充）。
3.  阅读卸载日志文件中的文本“删除成功或错误状态：XXXX”。其中 XXXX 是卸载过程的返回码。

# linux - 如何在bash脚本退出时终止ssh隧道子进程

> ID：15235966
> 
> 赞同：6
> 
> 时间：2013-03-05T23:13:22.173
> 
> 标签：linux, bash, shell, ssh, tunnel

我有一个 bash 脚本，它创建 ssh 隧道以安全地连接远程 mysql 服务器，如下所示。

```
ssh -f -N -L  $LOCAL_PORT:localhost:3306 $REMOTE_USER@$REMOTE_IP
mysql -P $LOCAL_PORT -h 127.0.0.1 -u lapl_stg -p${REMOTE_DB_PASS} < ./t1.sql > ./out.txt 
```

在 bash 脚本中打开 ssh 隧道后，在退出 bash 脚本时，我注意到 ssh 隧道子进程仍然存在。

脚本退出后，如果你做netstat，它显示如下。

```
netstat -a -n -p -l
(Not all processes could be identified, non-owned process info
 will not be shown, you would have to be root to see it all.)
Active Internet connections (servers and established)

Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name

tcp        0      0 127.0.0.1:3308          0.0.0.0:*               LISTEN      6402/ssh        
tcp        0      0 10.44.44.11:46836       10.44.44.21:22          ESTABLISHED 6402/ssh        
tcp6       0      0 ::1:3308                :::*                    LISTEN      6402/ssh 
```

如何优雅地终止 ssh 子进程（6402）以在脚本中进行清理？我考虑过使用“killall ssh”，但它可能会杀死其他人意外创建的其他 ssh 进程。

谢谢你。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-06T04:54:23.757

我找到了一种在 SSH 中使用控制套接字的方法。基本上：

```
ssh  -M -f -N -L  $LOCAL_PORT:localhost:3306 $REMOTE_USER@$REMOTE_IP -S /tmp/ssh-control
mysql -P $LOCAL_PORT -h 127.0.0.1 -u lapl_stg -p${REMOTE_DB_PASS} < ./t1.sql > ./out.txt
ssh -S /tmp/ssh-control -O exit $REMOTE_IP 
```

进程在脚本退出时没有被杀死的原因是`-f`传递给 ssh 的原因将它分叉到后台。这是 SSH 隧道在不中断下一行执行的情况下工作所必需的。

# android - 如何从图库小部件中获取选定的图像并显示在另一个活动中？

> ID：15235967
> 
> 赞同：0
> 
> 时间：2013-03-05T23:13:22.627
> 
> 标签：android, image, android-activity, gallery, selected

我正在尝试从 Gallery Widget 加载选定的图像并将其加载到另一个活动中，我将非常感谢帮助！

基本上它是关于拍摄我在画廊中选择的图像并在`OnItemClick`意图中制作，或者我不知道在另一个活动中查看图像。

该类如下所示：

```
public class Motos extends Activity implements OnClickListener, OnItemSelectedListener, OnItemClickListener{

    Gallery g;

Integer[] images = {
        R.drawable.image1,
        R.drawable.image2,
        R.drawable.image3,
        R.drawable.image4 };

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.moto);

    g = (Gallery) findViewById(R.id.gallery1);
    g.setOnItemClickListener(this);
    g.setSpacing(2);

}

public class ImageAdapter extends BaseAdapter {

    public ImageAdapter(Context c) {
        mContext = c;
    }

    public int getCount() {
        return images.length;
    }

    public Object getItem(int position) {
        return images[position];
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        ImageView i = new ImageView(mContext);

        i.setImageResource(images[position]);
        i.setScaleType(ImageView.ScaleType.CENTER_INSIDE);
        //i.setLayoutParams(new Gallery.LayoutParams(136, 88));
        return i;
    }

    private Context mContext;

}

@Override
public void onItemClick(AdapterView parent, View v, int position, long id) {
    // TODO Auto-generated method stub

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:36:56.003

好吧，看起来您可以通过执行以下操作来获取所选图像的资源 ID：

```
@Override
public void onItemClick(AdapterView parent, View v, int position, long id) {
    int selectedId = images[position];  
} 
```

您可以将选定的资源 id 传递给另一个`Activity`，如下所示：

```
Intent intent = new Intent(Vehiculos.this, OtherActivity.class);
intent.putExtra("imageId", selectedId);
startActivity(intent); 
```

然后像这样在你的另一个中检索 id `Activity`：

```
Intent intent = getIntent();
int imageId = intent.getIntExtra("imageId", -1); // -1 would be a default value 
```

这是一个粗略的例子——您可能需要添加一些错误检查。

# javascript - javascript 如何在回调中引用变量？

> ID：15235975
> 
> 赞同：0
> 
> 时间：2013-03-05T23:14:03.640
> 
> 标签：javascript

所以如果我有一些像这样的javascript：

```
Foo.init = function(options) {
  Bar.set_listener('some_event', function() {
    console.log(options);
  });
}; 
```

我使用 Foo.init({whatever: 'hi'}) 之类的选项调用 Foo.init，并且 Bar.set_listener 方法获取回调并存储它，然后在稍后触发 'some_event' 时调用它。 ...

console.log 会打印 undefined 或 {whatever: 'hi'} 吗？答案似乎是 {whatever: 'hi'} 但这让我很困惑。这个回调在调用时如何知道如何引用传递给 Foo.init 的选项变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T23:17:29.153

内部函数引用外部函数中定义的状态的能力称为闭包。这是大多数允许 lambda 或函数值的语言中存在的功能。

它是如何实现的，值得写一篇比 Stack Overflow 回答中真正能说的长得多的帖子。但总而言之，只要存在引用它们的内部函数，Javascript 运行时就会持久保存外部函数中定义的值。

# c# - 捕捉所有异常

> ID：15235977
> 
> 赞同：3
> 
> 时间：2013-03-05T23:14:19.837
> 
> 标签：c#, wcf, exception-handling

我有一个项目可能会在任何函数和对象上抛出异常，有没有办法在整个框架/程序中捕获任何和所有异常，以便我可以记录它们以便以后可以看到它们？我想要调用堆栈和异常消息。我不一定知道异常将在哪里抛出，但我想记录在程序整个生命周期中任何地方发生的任何异常。有没有办法做到这一点？我不想尝试捕捉任何可能的异常抛出函数。程序会因为未处理的异常而中断，但我想先记录它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:17:09.953

是的，有办法做到这一点。在 main 中写下以下几行：

```
// Add the event handler for handling UI thread exceptions to the event.
Application.ThreadException += new ThreadExceptionEventHandler(MainForm_UIThreadException);

// Set the unhandled exception mode to force all Windows Forms errors to go through
// our handler.
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException);

// Add the event handler for handling non-UI thread exceptions to the event. 
AppDomain.CurrentDomain.UnhandledException +=
    new UnhandledExceptionEventHandler(CurrentDomain_UnhandledException); 
```

而不是处理异常

```
private static void MainForm_UIThreadException(object sender, ThreadExceptionEventArgs t)
{
    //do something
}

private static void CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
{
    //do something
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:19:30.103

捕获异常的一个要点是根据抛出的异常类型正确处理它们。通过拥有一个大型异常处理程序，您将无法处理单个异常，而可能只是吞下它们。但这并不是说在所有情况下都不能或不应该这样做。

如果您的项目需要一个大型处理程序，那么您可以简单地处理[AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)事件。即使您在其他地方捕获异常，处理此方法也是一个好主意，以确保您的程序不会在您错过异常时抛出不友好的错误。这假设您正在创建一个`WinForm`.

由于您也在使用`WCF`，因此可以查看[IErrorHandler](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.ierrorhandler.aspx)接口以帮助处理错误消息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T12:33:01.247

> 有没有办法在整个框架/程序中捕获任何和所有异常，以便我可以记录它们以便以后可以看到它们？

捕获所有应用程序类型的所有未处理异常的唯一方法***是***使用已经提到的`AppDomain.CurrentDomain.UnhandledException`. 但是，您不能阻止您的应用程序使用该事件终止（好吧，您可以，但我不会告诉您如何，因为它有点骇人听闻）。

然而，在大多数框架中都有一些方法可以捕获未处理的异常，这使您可以锁定异常并继续前进。既然您提到了 WCF，您可能想了解[IErrorHandler](http://www.bing.com/search?q=ierrorhandler&src=IE-SearchBox&FORM=IE8SRC)

> 我不想尝试捕捉任何可能的异常抛出函数。

我就是这样做的。[不要抓住那个异常](http://www.codeproject.com/Articles/125118/Do-NOT-catch-that-exception)。;)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T23:17:36.113

您可以在应用程序域级别捕获异常 - [App Domain Exception](http://msdn.microsoft.com/en-GB/library/system.appdomain.unhandledexception.aspx)

```
AppDomain currentDomain = AppDomain.CurrentDomain;
currentDomain.UnhandledException += new UnhandledExceptionEventHandler(MyHandler); 
```

如果您阅读链接，它提到一些其他事件可能会导致应用程序域不触发 - 例如 ThreadException - 因此可能需要多个处理程序。

```
Application.ThreadException += new ThreadExceptionEventHandler (ThreadExceptionHandler); 
```

并注意以下几点：（关于 winforms - [SetUnhandledExceptionMode](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.setunhandledexceptionmode.aspx)）

```
Application.SetUnhandledExceptionMode(UnhandledExceptionMode.CatchException); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T23:18:01.963

你总是可以使用[AppDomain.UnhandledException](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)

```
static void Main()
{
    AppDomain currentDomain = AppDomain.CurrentDomain;
    currentDomain.UnhandledException += new UnhandledExceptionEventHandler(AppDomain_UnhandledException);
}

private static void AppDomain_UnhandledException(object sender, UnhandledExceptionEventArgs args) {
    Logger.Log((Exception)args.ExceptionObject);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-05T23:30:55.500

> 有没有办法在整个框架/程序中捕获任何和所有异常，以便我可以记录它们以便以后可以看到它们？

**是**的，有桌面应用程序或 Web 应用程序的处理程序来处理未处理的异常。在桌面应用程序中，该事件称为 UnhandledException。在 Web 应用程序中，它是应用程序入口点（通常是 Global.asax.cs）上的 Application_Error。

> 我不想尝试捕捉任何可能的异常抛出函数。程序会因为未处理的异常而中断，但我想先记录它。

如果您不想捕获异常，您总是可以简单地重新抛出。它将继续冒泡以使程序崩溃。

```
catch(Exception ex)
{
    //logging here
    throw;//rethrow
} 
```

> 我想要调用堆栈和异常消息。

该类`Exception`包含这些。在事件处理程序的情况下，有多种访问方式取决于它是什么类型的应用程序。

# haskell - haskell 按模式打印多个变量

> ID：15235979
> 
> 赞同：0
> 
> 时间：2013-03-05T23:14:23.503
> 
> 标签：haskell

我开始像这样在 Haskell 中写[项目欧拉问题的答案](http://projecteuler.net/)

```
problem1 = ...

problem2 = ... 
```

一起显示它们我一直在使用这样的东西

```
problems x = "print $ zip [1..] [" ++ intercalate "," (take x stringList) ++ "]"
             where
               stringList = map ("fromIntegral problem"++) stringInts
               stringInts = map show [1..]

main = print $ zip [1..] [fromIntegral problem1,fromIntegral problem2,...] (copy-pasta from ghci'ing problems string) 
```

有没有办法在不复制粘贴的情况下做到这一点？

我研究了用 m4 定义宏，但我无法将问题转换为问题 1。m4 也有中缀运算符反引号的问题，例如

```
x `mod` 3 == 0 
```

所以我不得不将整个文档的其余部分包装在 m4 块注释中

我研究了定义 c 预处理器宏，但据我所知，不支持 for 循环（或根本不支持循环）

我希望有一种 Haskell 方法可以做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:31:19.017

你真的需要一次显示它们吗？这似乎不是一件有用的事情，真的。

无论如何，您可以稍微更改界面，而不是`(problem1, problem2, ...) :: (Integral a) => a`do `problem :: (Integral a) => Int -> a`：

```
problem 1 = ...
problem 2 = ... 
```

然后收集所有问题是：

```
problems = zipWith ($) (repeat problem) [1..2]
main = print $ zip [1..] problems 
```

# javascript - 动态创建 div 会触发两次

> ID：15235984
> 
> 赞同：0
> 
> 时间：2013-03-05T23:14:42.690
> 
> 标签：javascript, jquery

我看过类似的帖子，但没有什么对我有 100% 的帮助

我需要在正文的第一个元素之前插入这些 div，当特定的 js 文件加载到页面中时。我希望在加载脚本时触发它，然后在现有的第一个子元素前面添加两个 div。

```
$('<div id="DIV1"><div id="DIV2"></div></div>').prependTo('body:first').index(); 
```

我可以在没有附加函数的 .js 文件中使用上面的代码，它可以工作，但会触发两次。我已经尝试了多种方法来做到这一点，但是我尝试的几乎所有东西都会触发两次，所以我得到了两个 div 而不是 1。

谁能指导我以更好的方式做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T23:27:57.517

您可以使用“原始”javascript：

```
var firstBody = document.querySelectorAll.apply(document,['body'])[0];
var div1 = document.createElement('div'), div2 = document.createElement('div');
div1.innerText = 'DIV #1';
div2.innerText = 'DIV #2';
firstBody.appendChild(div1);
div1.appendChild(div2); 
```

* * *

希望这可以帮助

# android - 可以将位图的动态源设置为 android XML drawable

> ID：15235986
> 
> 赞同：0
> 
> 时间：2013-03-05T23:14:58.223
> 
> 标签：android, xml, android-resources, dynamicresource

XML 代码

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- another items -->
    <item>
       <Bitmap android:src="@drawable/drawable_by_argument"/>
    </item>
</layer-list> 
```

在上面的代码中，我想通过一些参数动态设置 Bitmap android:src 属性。就像是：

Java 代码

```
getResources().getDrawable(R.drawable.back, R.drawable.some_img); 
```

可能吗。如果是，我该怎么做。

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:21:21.587

不。这是不可能的。

XML 不是动态的，它是静态的，并且在编译期间需要大量解析。

# javascript - 如何重置“清除搜索”的下拉值

> ID：15235987
> 
> 赞同：1
> 
> 时间：2013-03-05T23:15:01.630
> 
> 标签：javascript, ruby-on-rails-3, forms, coffeescript

我在搜索表单中有一个下拉菜单和一个清晰的搜索按钮。我希望在单击按钮时清除下拉列表中的选定值。除了我无法清除下拉列表之外，所有包含在下面的咖啡脚本代码都有效。我怎样才能做到这一点？

```
<%= search_form_for @search, :builder => SimpleForm::FormBuilder do |f|%>
  <%= f.input :year_gteq, :collection =>years_options%>

  <%= f.input :year_lteq, :collection =>years_options%>

<%= f.submit "Clear Search", :name => nil, :id => :q_reset, :class => "btn" %> 
```

咖啡脚本

```
$("#q_reset").click ->
    $(".clear-fields").val('')
    $('input:checkbox').removeAttr('checked')
    $('#clear-dropdown-fields').prop('selectedIndex', 0) 
```

这对我有用：

$('表单选择').val('')

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:17:07.520

您可以调用`reset()`表单将字段返回到它们的起始值。

或者您可以设置`selectedIndex`为`0`.

```
$('#clear-dropdown-fields').prop('selectedIndex', 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T07:08:27.680

您对 2 个 dom 元素使用相同的 id，这就是为什么

```
$('#clear-dropdown-fields').prop('selectedIndex', 0) 
```

不适用于第二个下拉菜单。您可以做的是使用类而不是 id 或者只是在表单中查找元素。您也可以使用`val('')`来重置该值。

```
$('form select').val('') 
```

# clojure - 使用 clojure pre-route 设置过滤器不起作用

> ID：15235989
> 
> 赞同：0
> 
> 时间：2013-03-05T23:15:36.840
> 
> 标签：clojure

我已经使用 clojure 的 noir 框架创建了一个 Web 项目，并想尝试使用 pre-route 宏。

这是我的 test.clj

```
(ns website.views.test  
(:require [website.views.common :as common] [noir.content.getting-started])  
(:use [noir.core :only [defpage]])  
(:use [hiccup.core :only [html]])  
(:require noir.core))  

(defn is-admin? [] false)
(pre-route '/admin/*' (when-not (is-admin?) (redirect '/login')))     
(defpage "/login" [] (common/layout [:p "login to website"]))
(defpage "/admin" [] (common/layout [:p "Welcome to admin page"]))        
(defpage "/admin/test1" [] (common/layout [:p "Welcome to admin test1 page"]))        
(defpage "/admin/test2" [] (common/layout [:p "Welcome to admin test2"])) 
```

当我执行“lein run”时，我得到以下堆栈跟踪

```
Caused by: java.lang.RuntimeException: Invalid token: /admin/*'
at clojure.lang.Util.runtimeException(Util.java:170)
at clojure.lang.LispReader.interpretToken(LispReader.java:321)
at clojure.lang.LispReader.read(LispReader.java:206)
at clojure.lang.LispReader$WrappingReader.invoke(LispReader.java:537)
at clojure.lang.LispReader.readDelimitedList(LispReader.java:1126)
at clojure.lang.LispReader$ListReader.invoke(LispReader.java:962)
at clojure.lang.LispReader.read(LispReader.java:180)
at clojure.lang.Compiler.load(Compiler.java:6949)
... 51 more 
```

知道什么可能是导致此异常的原因（当我注释掉预路由宏时不会发生）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T05:06:25.757

`(pre-route '/admin/*' (when-not (is-admin?) (redirect '/login')))`

应该：

`(pre-route "/admin/*" (when-not (is-admin?) (redirect "/login")))`

因为`'`是用于引用的阅读器宏。

# c# - 如何将异步工作作为 Web 服务的一部分？

> ID：15235992
> 
> 赞同：2
> 
> 时间：2013-03-05T23:15:45.727
> 
> 标签：c#, web-services, iis, asynchronous

我正在编写 Web 服务 A 并调用 Web 服务 B。

一旦我验证了 AI 的输入，我想**返回**一个成功代码，**然后**调用 B。

我正在考虑的方法：

*   看看我是否可以生成一个在 A 返回后完成的工作线程。
*   编写代理或服务来调用 B 并使用可靠的队列来传输经过验证的参数。

运行时上下文是由 ASP.NET Web 应用托管的 Service.svc。

我该怎么做？

**更新**：我只想说答案都很有用。我决定标记我使用的那个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T00:08:53.610

Code Project 上的此链接应为您提供[使用 Windows Communication Foundation 创建稳定的异步通信](http://www.codeproject.com/Articles/121345/Asynchronous-Communication-in-a-WCF-Service)所需的所有信息。

一本对这种交流形式进行了大量处理的书：

*   WCF 一步一步
*   多层框架中的 WCF

希望这会有所帮助。我会给你一些例子，但是关于 Code Project 的教程应该提供你所需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T05:00:50.273

> 一旦我验证了 AI 的输入，我想返回一个成功代码，然后调用 B。

在这种情况下，您应该将工作放入持久队列（MSMQ、Azure Bus 等），然后才返回成功代码。另一个系统（不在 ASP.NET 中托管；即 Azure 辅助角色、Win32 服务等）应该从队列中检索工作并调用 B。

这是唯一可靠的方法。Phil Haack 有一篇[很好的博客文章](http://haacked.com/archive/2011/10/16/the-dangers-of-implementing-recurring-background-tasks-in-asp-net.aspx)说明了为什么在 ASP.NET 中同时执行这两个部分是一个坏主意；它归结为回收利用。有关回收触发器的更多信息，请[点击此处](http://www.iis.net/configreference/system.applicationhost/applicationpools/add/recycling)和[此处](http://blogs.msdn.com/b/tess/archive/2006/08/02/asp-net-case-study-lost-session-variables-and-appdomain-recycles.aspx)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T00:59:38.417

你的第二个想法很好。将异步部分发送到 Windows 服务。如果您需要可靠性，请使用消息队列来实现。在任何情况下，您都可以使用 WCF 将请求发送到其他服务。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T01:20:57.690

这个问题并不真正特定于任何特定的服务接口。通常，您的决定取决于您为什么要异步调用某些东西：

1.  如果您只想让客户端对单个长时间运行的方法调用做出快速响应，请调用您的异步方法并立即返回一个令牌（任务 ID 等），该令牌可用于稍后检查任务的进度。
2.  如果您有几个长时间运行的方法要执行，并且您主要想异步调用以通过并行性提高效率，请在一开始就调用任何可以调用的方法，然后继续执行不依赖于先前方法的所有其他方法。等待完成返回结果或启动后续任务所需的任何任务。
3.  在大多数情况下，我会让客户端在带有状态令牌的同步和异步方法之间进行选择；如果他们想继续，他们可以稍后再回来查看，如果在继续之前获得该结果很重要，那么这也是一个选择。

随着每个后续框架版本> 3.5，这些方法变得更加容易，我相信其他答案已经让您深入了解如何在 c# 中启动、继续和/或等待异步任务结果的细节。

# android - 哪里可以找到安卓样本？

> ID：15235997
> 
> 赞同：6
> 
> 时间：2013-03-05T23:15:56.537
> 
> 标签：android, sample

我在谷歌开发者网站上查看了一些 Android 开发中的练习和示例，我发现了这个网页： http: [//developer.android.com/tools/samples/index.html 上面](http://developer.android.com/tools/samples/index.html)写着

> 下载完成后，您可以在以下位置找到所有示例的源代码：/samples/android-

我没找到那个位置！我应该怎么办？如果您知道初学者学习的更好练习方法，请告诉我！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T23:19:28.327

您需要确保已安装 SDK 示例： ![在此处输入图像描述](../Images/7647ecd167b666cc10f4bcc96ba86841.png)

此图像来自 SDK 管理器。一旦您检查了所需 API 的示例并安装了所有内容，您就可以轻松地创建一个 Eclipse 项目：

> 文件 -> 新建 -> 其他 -> Android 示例项目

或者您可以直接导航到路径。您可以从我的屏幕截图中看到，对我来说，`Program Files\Android\android-sdk`样本位于`samples`子目录中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-10T18:47:39.307

最新（也是最方便的方法）是：

1.  打开安卓工作室
2.  如果当前打开了一个项目，请关闭它（文件 -> 关闭项目）
3.  在以下屏幕上选择“导入 Android 代码示例”。

[![在此处输入图像描述](../Images/7da17127665fe097b2ce63150a9ad907.png)](https://i.stack.imgur.com/zwmDe.jpg)

另请参阅[http://developer.android.com/samples/index.html](http://developer.android.com/samples/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T23:20:17.397

它位于您安装 Android SDK 的目录中。如果您在 Windows 上运行，它可能看起来像`C:\android-sdk`. 在它里面有一个子目录叫做`samples`. 那就是他们所在的地方。但是请注意，它们没有预装 SDK，您需要首先通过 Android SDK 实际下载示例。只需启动它，检查您想要的 android 平台的“示例”并开始下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-15T03:44:06.937

在 Win8 上：您使用 Android SDK Manager 导入示例，它们将位于此文件夹中（这是带有 android-sdk 的文件夹）：

C:\Users\YourUserName\AppData\Local\Android\sdk\samples

这对我有用

# c - 在 C 中创建自己的 toUpper 和 toLower

> ID：15235998
> 
> 赞同：-8
> 
> 时间：2013-03-05T23:16:03.327
> 
> 标签：c, tolower, toupper

当我运行和编译代码时，我得到 A 和 Z 以及 a 和 c 都未定义的错误，我该如何解决这个问题？

```
char toUpper ( char c ) {

    if ( C >= a + c <= z) 
        -32;
    return c;

} // ends toUpper

char toLower ( char c ) {

    if ( c >= A + c <= Z ) 
        +32;

} // ends toUpper 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T23:17:10.747

用单引号引用字母以形成字符文字，如下所示：

```
'a' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T23:21:25.647

一个简短的总结：

*   您需要在字符常量周围加上引号。
*   您的函数应返回大小写字符。
*   测试两个条件时，使用`&&`“逻辑与”和`||`“逻辑或”

如果两边都为真，则逻辑 and 为`&&`真。如果 ONE 的一侧为真，则逻辑或为`||`真。

我不是“编辑你的代码来修复它”，因为我很确定你是学习如何编写 C 的人，如果我只是在这里输入“正确的代码”，你只需将其复制并粘贴到你的代码，并且什么都学不到。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T23:22:29.213

您的代码中有两个主要问题。

第一个是您正在使用`a`而不是`'a'`. 当编译器看到`a`它尝试将其解释为标识符时。这意味着它应该引用一个参数、本地、函数名等......你的代码的意图是让它表示字符 a（字母表的第一个字母）。将单引号放在单个字母周围会导致编译器将其解释为字符文字。

第二个问题是您的条件语句不正确。您正在尝试查看`C`is 是否同时大于或等于`'a'`和小于或等于`'z'`。这种类型的布尔比较是用`&&`C 中的运算符完成的。只有当左侧和右侧都为真时才为`&&`真

```
if ( C >= 'a' && c <= 'z') 
```