# StackOverflow 问答 12642000-12642999

# python - Python - 合并时间和日期

> ID：12642005
> 
> 赞同：11
> 
> 时间：2012-09-28T14:29:19.930
> 
> 标签：python, datetime

> **可能重复：**
> [添加 datetime.date 和 datetime.time 对象的 Pythonic 方式](https://stackoverflow.com/questions/8474670/pythonic-way-to-add-datetime-date-and-datetime-time-objects)

这个问题对我来说似乎很简单，但我找不到答案。
我有一个`datetime.date()`我想添加一个`datetime.time()`.

```
>>> import datetime
>>> my_time = datetime.time(9, 30)
>>> my_date = datetime.date(2012, 10, 2) 
```

我试过

```
>>> my_time + my_date 
```

我本来想得到一个

```
datetime.datetime(2012, 10, 2, 9, 30) 
```

但不支持操作数。添加的
最佳方法是什么？`my_time``my_date`

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-09-28T14:30:38.230

`datetime.datetime.combine(datetime.date(2011, 01, 01), datetime.time(10, 23))`

[http://docs.python.org/release/2.6/library/datetime.html#datetime.datetime.combine](http://docs.python.org/release/2.6/library/datetime.html#datetime.datetime.combine)

# c# - 在 MVC4 中更改运行时路由

> ID：12642012
> 
> 赞同：3
> 
> 时间：2012-09-28T14:29:50.523
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4

目前，当我输入`/ru/`时，它将更改为俄语，但如果我进入`/`它将显示俄语资源（意味着设置了 cookie/区域设置），但它不会重定向到`/ru/`. 我真的不能只是重定向它，例如，如果用户打开`/en/item/32`并且他将语言更改为俄语，他需要重定向到`/ru/item/32`，而不是`/ru`.

我`[Localization]`检查 cookie 的数据注释功能

```
public class Localization : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext filterContext)
    {
        if (filterContext.RouteData.Values["lang"] != null && !string.IsNullOrWhiteSpace(filterContext.RouteData.Values["lang"].ToString()))
        {
            // Set from route data
            var lang = filterContext.RouteData.Values["lang"].ToString();
            Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(lang);
        }
        else
        {
            // Set from cookie
            var cookie = filterContext.HttpContext.Request.Cookies["lang"];
            var langHeader = string.Empty;
            if (cookie != null)
            {
                langHeader = cookie.Value;
                Thread.CurrentThread.CurrentUICulture = CultureInfo.CreateSpecificCulture(langHeader);
            }
            else
            {
                // Cookie does not exist, set default
                Thread.CurrentThread.CurrentUICulture = new CultureInfo("en-US");
            }

            filterContext.RouteData.Values["lang"] = langHeader;
        }

        // Update cookie
        HttpCookie _cookie = new HttpCookie("lang", Thread.CurrentThread.CurrentUICulture.Name);
        _cookie.Expires = DateTime.Now.AddYears(1);
        filterContext.HttpContext.Response.SetCookie(_cookie);
        base.OnActionExecuting(filterContext);
    }
} 
```

我的路线是这样配置的

```
public class RouteConfig
{
    public static void RegisterRoutes(RouteCollection routes)
    {
        routes.IgnoreRoute("{resource}.axd/{*pathInfo}");

        routes.MapRoute(
            name: "Localization",
            url: "{lang}/{controller}/{action}/{id}",
            defaults: new { lang = "en", controller = "Home", action = "Index", id = UrlParameter.Optional },
            namespaces: new string[] { "ORMebeles.Controllers" }
        );

        /*
        routes.MapRoute(
            name: "Default",
            url: "{controller}/{action}/{id}",
            defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional },
            namespaces: new string[] { "ORMebeles.Controllers" }
        );
        */
    }
} 
```

那么我怎样才能将`{lang}`属性注入到路由并让它粘在那里呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:33:54.987

您在这里遇到的麻烦是`OnActionExecuting`在根据您的路线评估传入请求之后运行。所以设置`filterContext.RouteData.Values["lang"] = langHeader;`在这种情况下没有效果。

这里有一个很好的（MVC 2）示例，[说明](http://adamyan.blogspot.co.uk/2010/02/aspnet-mvc-2-localization-complete.html)了如何设置多语言站点，尽管此示例未在 url 中使用 lang 变量 - 大约在中途，他们将 ActionLinks 设置为更改文化然后重定向的操作返回上一页。

如果您需要在 URL 中保留 lang 变量，您可以将链接设置为指向当前页面，但使用 HtmlHelper 更改 lang 参数，如下所示：

```
public static MvcHtmlString ChangeLanguageLink(this HtmlHelper html, string text, string lang)
{
    var currentController = html.ViewContext.RouteData.GetRequiredString("controller");
    var currentAction = html.ViewContext.RouteData.GetRequiredString("action");

    return html.ActionLink(text, currentAction, currentController, new { lang }, null);
} 
```

这应该使用您的路线生成一个链接，将用户发送到相同的操作但使用不同的语言 - 您的`Localization`过滤器可以相应地设置当前文化。

如果 url 中没有`lang`指定，并且需要重定向，则可以将 设置`filterContxt.Result`为 a`RedirectResult`与上述类似的参数。

# java - 杰克逊一对一序列化

> ID：12642013
> 
> 赞同：0
> 
> 时间：2012-09-28T14:29:51.033
> 
> 标签：java, json, jackson, cycle, bidirectional-relation

我正在杰克逊寻找一种方法来允许根据根元素对关系进行序列化。例如，我的关系不是真正的父母/孩子。可以查询这两个实体。

```
Address {
    @JsonBackReference
    Company company;
    String line1;
    String city;
    String state;
    String zip;
    String country;
}

Company {
    Address mainAddress;

    List<Address> locations;
    String name;
} 
```

JsonBackReference 使它在序列化为 json 时没有循环引用。但是，这也导致我不知道地址的公司。如果我要上市公司，那么地址会回来，一切都很好。但如果我列出地址，我希望看到公司被序列化。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:15:34.623

您需要使用杰克逊的`@JsonTypeInfo`序列化和反序列化。请查看[Jackson 的文档](http://wiki.fasterxml.com/JacksonPolymorphicDeserialization)以获取更多详细信息。如果您有静态内部类，请尽量避免`1.9.8`使用版本（这有一个错误并导致 StackOverflowError）。

# apache - 如果 URL 包含特定的子字符串，则重定向

> ID：12642014
> 
> 赞同：0
> 
> 时间：2012-09-28T14:29:53.950
> 
> 标签：apache, redirect

如果提供的 url 包含特定的子字符串，我想编写一个 apache 重定向规则来重定向。例如，假设用户使用 url 访问服务器`http://bloop1.toop.com`。我想将它们重定向到`http://bloop2.toop.com`. 从网上环顾四周，我写了一条类似以下的规则：

```
RewwriteRule .+bloop1 http://bloop2.toop.com 
```

但这不起作用。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:32:01.633

您还可以创建 DNS CNAME 条目以将 bloop1.toop.com 子域指向 bloop2.toop.com。如果您要看到该特定子域的大量流量，这可能更可取，因为它将工作负载从您的网络服务器转移到客户端的 DNS 查找。

# iphone - 从 uiwebview 在自定义播放器中启动视频

> ID：12642016
> 
> 赞同：2
> 
> 时间：2012-09-28T14:29:55.887
> 
> 标签：iphone, url, video-player

当用户单击 iphone 中的 uiwebview 中的 clink 时，我想在自定义视频播放器中启动视频。目前，只要点击链接，视频就会在默认播放器中播放。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:03:54.947

请参阅[UIWebViewDelegate 文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/UIWebViewDelegate)，尤其是`webView:shouldStartLoadWithRequest:navigationType:`方法。

您可以使用它来拦截对链接的点击。然后，您将需要确定请求是否针对视频。如果是用于视频，请从方法中返回 NO 以防止 UIWebview 标准行为，而是启动您自己的自定义播放器。

# java - 在 Spring MVC 中发送 HTTP POST 请求

> ID：12642020
> 
> 赞同：1
> 
> 时间：2012-09-28T14:30:02.160
> 
> 标签：java, spring, model-view-controller, http, web-applications

我正在开发一个使用 Spring MVC 的项目，其中一个要求涉及向外部服务发送请求以处理一些事务。现在的问题是外部服务只采用 POST 方法，我到处寻找，找不到将用户作为 POST 请求转发到外部站点的方法（类似于表单提交）。

我们正在尝试做的事情：

1）我的控制器将接收请求并执行一些后端事物并构造一些参数以传递。

2) *通过带有一些参数的HTTP POST方法向外部服务发送请求。（注意。用户的浏览器将显示外部站点的 URL。）

我研究了 Spring MVC 的不同返回类型，但找不到任何合适的东西。

任何建议将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T08:05:13.123

您可以使用[Apache HttpComponents](http://hc.apache.org/)库从您的控制器发送 HTTP 请求。它易于使用，并且有大量的文档和示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:33:22.740

您将无法重定向，因为这意味着`GET`.

由于您的客户端使用的是 Web 浏览器，因此应该可以返回带有表单的 HTML 文档，然后`POST`在页面加载后提交该表单（方法属性为 ）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:45:19.273

假设这不是与 Spring MVC 相关的问题。我认为这与您尝试在 Servlet 中实现此类操作的解决方案相同。

首先，这个外部站点应该是一个异步服务，你不需要从它那里得到响应，对吧？如果是，我认为最简单的解决方案是您可以在 Servlet 或控制器中新建 URLConnection，构造参数并设置 POST 方法，然后发出请求。之后，您可以根据需要回复您的本地页面。

第二种解决方案，需要一个虚拟 JSP 页面。该页面将向外部服务发布表单并根据需要重定向到目标页面。无论您是否使用 javascript，我认为用户都会在浏览器上看到刷新。

# visual-studio-2008 - MC9090 Windows CE 5.0 连接问题

> ID：12642021
> 
> 赞同：0
> 
> 时间：2012-09-28T14:30:09.597
> 
> 标签：visual-studio-2008, windows-ce

环境：MC9090、Windows CE 5.0、.NET3.5 CF、Windows Mobile Center、VS 2008

我正在尝试使用 USB 连接从 VS2008 对 MC9090 执行设备调试。我的应用程序是一个 Web 应用程序，需要 Internet 连接。不幸的是，我只有在设备离开底座时才能连接到互联网，并且一旦将它放在底座内，互联网连接就会断开。简而言之，当设备放在底座上时，您会连接到 Internet 或 USB。

你们中有人遇到过类似的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T15:54:04.470

根据您使用的 PC 操作系统，您将安装 ActiveSync 或 Windows Mobile Device Center (WMDC)。无论哪种情况，您需要做的是找到该应用程序的“连接设置”对话框，并确保标有“我的电脑也已连接”的下拉列表显示“互联网”。从技术上讲，您应该可以将设置保留为“自动”，但某些设备/工作站组合存在问题。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T09:30:38.577

另外值得一提的是，如果您在扫描仪上打开了高级网络功能，您 PC 上的防火墙可以成功阻止任何连接尝试。

# email - Mailchimp 如何识别电子邮件被标记为垃圾邮件？

> ID：12642026
> 
> 赞同：0
> 
> 时间：2012-09-28T14:30:31.157
> 
> 标签：email, newsletter, mailchimp

Mailchimp 是用于发送新闻通讯的在线服务，它统计有多少人将您发送的电子邮件标记为垃圾邮件。有人知道这是如何工作的吗？我之所以问，是因为我正在考虑如何在我的 CMS 中实现它，它也发送时事通讯。感谢您的回复！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:34:22.223

它被称为[FBL](http://en.wikipedia.org/wiki/Feedback_loop_%28email%29)（反馈循环），意味着您在支持 FBL（Yahoo、Hotmail 等）的 ISP 处注册您的 MTA（电子邮件发送服务器）。

您所要做的就是通过他们的表格注册每个可用的 FBL，然后每当有人将从这些服务器发送的电子邮件标记为垃圾邮件（垃圾邮件投诉）时，他们就会向您发送一封电子邮件。

然后，您必须解析这些电子邮件以从中获取信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:32:08.543

您检查过 Mailchimp 支持吗？

[http://kb.mailchimp.com/article/how-spam-filters-think](http://kb.mailchimp.com/article/how-spam-filters-think)

异常高的跳出率是另一个指标。查看您的硬退回邮件，并阅读 SMTP 回复。垃圾邮件过滤器有时会留下很少的线索，说明它们为何阻止您的活动（请参阅：http: [//kb.mailchimp.com/article/why-did-my-email-bounce-smtp-replies](http://kb.mailchimp.com/article/why-did-my-email-bounce-smtp-replies)）。

# c# - 在 C# 中使用 SQL 获取数据库的驱动器号

> ID：12642028
> 
> 赞同：3
> 
> 时间：2012-09-28T14:30:39.507
> 
> 标签：c#, sql-server, smo

我试图找出数据库在服务器上的驱动器。更详细地说，该服务器上有一个服务器“MyServer”和三个数据库。数据库 A 和 B 位于该服务器的“C:\”驱动器上，数据库 C 位于“D:\”驱动器上。我想知道如何使用连接字符串来尝试获取驱动器号，以便当用户从应用程序中选择数据库时，它会告诉他们该数据库位于哪个驱动器上。

目前我正在尝试以下方法，但没有得到正确的响应：

```
Private void GetDriveLetter()
{
   string connectionString = String.Format(DatabaseInfo.CONNECTIONSTRING_TEMPLATE, dbName, server)
   try
   {
     using (SqlConnection cn = new SqlConnection(ConnectionString))
     {
       cn.Open();
       Server srv = new Server(new ServerConnection(cn));
       Database database = new Database(srv, dbName);
       txtDriveLetter.Text = database.PrimaryFilePath;
       cn.Close();
     }
    }
    catch (Exception ex)
    { 
      myException = ex.Message
    }
} 
```

DatabaseInfo 只是我们用来读取 SQL Server 和数据库名称的一个类，而 myException 是一个将异常写入日志文件的函数。我遇到的问题是，无论我做什么，我都会收到一个异常，提示 PrimaryFilePath 从未设置。我做错了什么/错过了什么，或者这不是解决这个问题的正确方法？

编辑：抱歉从未发布异常要完成此操作，请设置属性 PrimaryFilePath。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:33:50.430

您始终可以对`sys`SQL Server 中的目录视图运行查询：

```
SELECT * FROM sys.master_files 
```

这将列出您的数据库、它的`id`名称、它的逻辑名称以及文件在磁盘上的位置。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:33:54.503

您可能应该访问现有的数据库，而不是构建一个新的：

```
Database database = srv.Databases[dbName]; 
```

（当然，如果名称不存在，则需要进行错误处理）。

此外，当然，您应该知道数据库可能包含多个文件，并且这些文件可能位于不同的驱动器上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:37:07.450

如果这是 SQL Server，那么您可以使用

```
SELECT * FROM sys.database_files 
```

获取当前数据库的文件。因此，您的连接字符串应该将您连接到所需的数据库，然后上面的 SQL 将为您提供许多您可能会觉得有用的信息，包括`physical_name`. 从中您可以提取驱动器号。

# python - 合并排序索引错误

> ID：12642031
> 
> 赞同：1
> 
> 时间：2012-09-28T14:30:51.337
> 
> 标签：python, algorithm, mergesort

```
def merge (seq, p, q, r):
    # n1: length of sub-array [p..q]
    n1 = q - p + 1
    # n2: length of sub-array [q+1 ..r]
    n2 = r - q
    # Left and Right arrays
    left_arr = [] 
    right_arr = []
    for i in xrange(0, n1):
        left_arr.append( seq[p+i] )
    for j in xrange(0, n2):
        right_arr.append( seq[q+j+1] )

    j=0
    i=0
    for k in xrange(p,r+1):
        if left_arr[i]<= right_arr[j]:
            seq[k]=left_arr[i]
            i+=1
        else:
            seq[k]=right_arr[j]
            j+=1
    return seq

s = [2,4,5,7,1,2,3,6]
p = 0
q = 3
r = 7
print merge(s,p,q,r) 
```

这个怎么运作：

1.  采用未排序的序列 s 以及必须合并序列的索引号。（p=初始，r=最终，q=中间）

2.  现在，left_arr 和 right_arr 分别是 [p,q], [q+1, r]

3.  我们取 left_arr 和 right_arr 初始值 (i=0, j=0)。我们遍历序列 seq...

4.  在迭代时，我们将 seq 的值替换为排序后的值......

上面的函数能够排序到最后一个数字“7”..最后，它显示“IndexError”。我可以使用异常处理来捕获并修复它，但我认为......对于合并排序，它太多了......任何人都可以帮助我尽可能简单地修复代码。

我正在学习算法..（以下书籍：Thomas H. Cormen 的算法简介）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:38:21.517

问题是在最后一次迭代中 i 将等于 4 并且您试图访问不存在的 left_arr[5] 。当 i 或 j 大于相应数组的大小时，您应该添加停止条件，然后将另一个数组中的所有剩余元素添加到 seq。

这是一个有效的代码：

```
def merge (seq, p, q, r):
    # n1: length of sub-array [p..q]
    n1 = q - p + 1
    # n2: length of sub-array [q+1 ..r]
    n2 = r - q
    # Left and Right arrays
    left_arr = seq[p:n1] #here 
    right_arr = seq[n1:r+1]  #here
    j=0
    i=0
    for k in xrange(p, r+1):
        if left_arr[i]<= right_arr[j]:
            seq[k]=left_arr[i]
            i+=1
            if i > n1-1: #here
                break
        else:
            seq[k]=right_arr[j] #here
            j+=1
            if j > n2-1:
                break
    if i >= len(left_arr): #from here down
        seq[k+1:] = right_arr[j:]
    elif j >= len(right_arr):
        seq[k+1:] = left_arr[i:]

    return seq

s = [2,4,5,7,1,1,1,1]
p = 0
q = 3
r = 7
print merge(s,p,q,r) 
```

我已经用注释标记了我编辑你的代码的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:11:23.833

您的代码的问题在于您正在循环`xrange(p, r+1)`，因此在某些迭代中的循环期间，`i`or`j`的值可能等于`len(left)`or的值，最终`len(right)`导致。`IndexError`

```
def merge(seq,p,q,r):
    left=seq[p:q+1]       #a better way to fetch the list
    right=seq[q+1:]       
    i=0
    j=0
    #you shuldn't loop over the length of seq as that might make the value of either i or j
    # greater than the length of left or right lists respectively.
    # so you should only loop until one of the lists is fully exhausted

    while i<len(left) and j<len(right):
        if left[i] <= right[j] :
            seq[i+j]=left[i]
            i+=1
        else:
            seq[i+j]=right[j]
            j+=1

    #now the while loop is over so either right or left is fully traversed, which can be
    #find out my matching the value of j and i with lenghts of right and left lists respectively

    if j == len(right):
        seq[i+j:]=left[i:]  #if right is fully traversed then paste the remaining left list into seq
    elif i==len(left):      #this is just vice-versa of the above step
        seq[i+j:]=right[j:] 
    print seq

s = [2,4,5,7,1,2,3,6]
p = 0
q = 3
r = 7
merge(s,p,q,r) 
```

**输出：**

```
[1, 2, 2, 3, 4, 5, 6, 7] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:49:33.917

`left_arr`您在迭代和时没有检查数组索引`right_arr`。当另一个数组结束时，您应该合并任一数组的左侧部分。

```
for k in xrange(p,r+1):
    if left_arr[i]<= right_arr[j]:
        seq[k]=left_arr[i]
        i+=1
    else:
        seq[k]=right_arr[j]
        j+=1

    # --------------- add this ----------------
    # if any array ends, merge the left elements of the other array
    if i >= len(left_arr):
        seq[k:] = right_arr[j:]
        break
    elif j >= len(right_arr):
        seq[k:] = left_arr[i:]
        break
    # --------------- end ----------------
return seq 
```

# android - setContentView 花费太多时间

> ID：12642034
> 
> 赞同：3
> 
> 时间：2012-09-28T14:31:15.573
> 
> 标签：android, android-layout, android-mapview, mapactivity

我有 MapView、TextView、3 个 ImageButton 和 1 个简单按钮的活动。首次为此活动调用 setContentView 需要太多时间（接近 10 秒）。这是我的视图代码：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="center_horizontal"
    android:padding="0px" >

    <com.google.android.maps.MapView
        android:id="@+id/map_view"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_below="@+id/txt_route_info"
        android:apiKey="MyAPIKeyGoesHere"
        android:clickable="true"
        android:enabled="true" />

    <Button
        android:id="@+id/btn_accept"
        android:layout_width="fill_parent"
        android:layout_height="55dp"
        android:layout_alignParentBottom="true"
        android:layout_margin="2dip"
        android:enabled="false"
        android:text="@string/btn_accept" />

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/textEdit"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:gravity="center_horizontal"
        android:padding="0px" >

        <TextView
            android:id="@+id/txt_route_info"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal" />
    </LinearLayout>

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textEdit"
        android:layout_centerHorizontal="true"
        android:gravity="center_horizontal"
        android:padding="0px" >

        <ImageButton
            android:id="@+id/btn_zoom_in"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:contentDescription="@string/btn_zoom_in_content_descriptor"
            android:src="@drawable/zoom_in" />

        <ImageButton
            android:id="@+id/btn_zoom_out"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:contentDescription="@string/btn_zoom_out_content_descriptor"
            android:src="@drawable/zoom_out" />

        <ImageButton
            android:id="@+id/btn_my_location"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:contentDescription="@string/btn_my_location_content_descriptor"
            android:src="@drawable/my_location" />
    </LinearLayout>

</RelativeLayout> 
```

我不知道什么会减慢活动加载速度。我已阅读此主题：[setContentView 需要很长时间（10-15 秒）来执行](https://stackoverflow.com/questions/8180072/setcontentview-taking-long-time-10-15-seconds-to-execute) ，但我仍然无法解决我的问题。如果您能给我任何提示或想法，我将不胜感激。

**更新：**

我的活动代码中的 onCreate 方法：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.google_map_view);
    mapView = (MapView) this.findViewById(R.id.map_view);
    mapView.setBuiltInZoomControls(false);

    locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
    if (locationManager == null) {
        this.finish();
        return;
    }

    final MyLocationOverlay myLocationOverlay = new MyLocationOverlay(this, mapView);
    myLocationOverlay.disableCompass();
    myLocationOverlay.enableMyLocation();

    acceptBtn = (Button) findViewById(R.id.btn_accept);
    final View.OnClickListener acceptBtnListener = new AcceptBtnListener();
    acceptBtn.setOnClickListener(acceptBtnListener);

    final ImageButton zoomInBtn = (ImageButton) findViewById(R.id.btn_zoom_in);
    final ImageButton zoomOutBtn = (ImageButton) findViewById(R.id.btn_zoom_out);
    myLocationBtn = (ImageButton) findViewById(R.id.btn_my_location);
    zoomInBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            mapController.zoomIn();
        }
    });

    zoomOutBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            mapController.zoomOut();
        }
    });

    myLocationBtn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            final GeoPoint myLocation = myLocationOverlay.getMyLocation();
            if (myLocation != null) {
                mapController.animateTo(myLocation);
                mapController.setCenter(myLocation);
            } else {
                progressDialog = ProgressDialog.show(GoogleMapActivity.this, "", getString(R.string.dlg_progress_obtaining_location), true);
            }
        }
    });

    mapController = this.mapView.getController();
    mapController.setZoom(MAP_ZOOM_LEVEL);

    final Intent intent = getIntent();
    isInRouteMode = intent.getBooleanExtra("isRouteMode", false);  //activity started to display route?
    if (isInRouteMode) {
        final String fromAddress = intent.getStringExtra("fromAddress");
        final String toAddress = intent.getStringExtra("toAddress");
        final GeoPoint fromPoint;
        final GeoPoint toPoint;
        try {
            fromPoint = getGeoPointByAddressString(fromAddress, this);
            toPoint = getGeoPointByAddressString(toAddress, this);
        } catch (IOException e) {
            Toast.makeText(this, getString(R.string.err_geocoder_not_available),
                    Toast.LENGTH_LONG).show();
            Log.e(CLASSTAG, e.getMessage());
            return;
        }
        new RouteCalculationTask().execute(fromPoint, toPoint);
    } else {  //activity started to select address
        addressItemizedOverlay = new AddressItemizedOverlay(getResources().getDrawable(R.drawable.red_pin));
        mapView.getOverlays().add(addressItemizedOverlay);
        mapView.getOverlays().add(myLocationOverlay);
        mapView.setOnTouchListener(new MapOnTouchListener());
    }
} 
```

以前的活动是只有四个按钮的简单活动，所以我相信它不会减慢这项活动的速度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:33:56.587

你来自什么样的观点？

以前的视图/活动/片段可能会减慢速度，地图视图也可能很慢，尤其是当 GPS 试图同时锁定时

考虑加载对话框

# smooth-streaming - 使用 Microsoft Smooth Streaming 播放分段的存档视频

> ID：12642037
> 
> 赞同：0
> 
> 时间：2012-09-28T14:31:35.767
> 
> 标签：smooth-streaming, smooth-streaming-player

我是平滑流媒体的新手。我可以使用 Microsoft Smooth Streaming 播放器播放跨越多个片段的实时视频。清单似乎包含有关所有段的信息。

但是对于从存档播放，我可以将 HTML 中的 URL 指向其中一个片段中的 ISM，我可以很好地播放那个特定的片段，但我不知道如何播放整个视频快退、快进等

是否可以跨多个细分市场这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T14:28:00.627

为了跨多个片段回放，我最终将存档片段添加到播放器的播放列表中，并使用 player.GoToPlaylistItem() 和 player.SeekToPosition() 在存档中的多个片段之间前进、倒带和播放。

# vb.net - 在 VB.Net 中更新记录时出错

> ID：12642038
> 
> 赞同：0
> 
> 时间：2012-09-28T14:31:41.337
> 
> 标签：vb.net, oledb

在我的表单中，当我修改数据时出现错误，因为 **“没有为命令对象设置命令文本”**

我正在使用 oledb 连接

关注我的代码

```
Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button2.Click    
Try
        sql = "select * from Employee"
        conn = New OleDbConnection(s)
        adapt = New OleDbDataAdapter(sql, conn)
        ds = New DataSet

        usql = "Update Employee set enp_name=?, emp_addr=?, DOB=?, DOJ=?, emp_mob=?, emp_mail=? where ID=?"
        ucmd = New OleDbCommand(isql, conn)

        Dim date1 As Date
        date1 = DateTimePicker1.Value

        p = ucmd.Parameters.Add("@emp_name", OleDbType.Char)
        p.SourceColumn = "emp_name"
        p.SourceVersion = DataRowVersion.Current

        p = ucmd.Parameters.Add("@emp_addr", OleDbType.Char)
        p.SourceColumn = "emp_addr"
        p.SourceVersion = DataRowVersion.Current

        p = ucmd.Parameters.Add("@DOB", OleDbType.DBDate)
        p.SourceColumn = "DOB"
        p.SourceVersion = DataRowVersion.Current

        p = ucmd.Parameters.Add("@DOJ", OleDbType.DBDate)
        p.SourceColumn = "DOJ"
        p.SourceVersion = DataRowVersion.Current

        p = ucmd.Parameters.Add("@emp_mob", OleDbType.Integer)
        p.SourceColumn = "emp_mob"
        p.SourceVersion = DataRowVersion.Current

        p = ucmd.Parameters.Add("@emp_mail", OleDbType.Char)
        p.SourceColumn = "emp_mail"
        p.SourceVersion = DataRowVersion.Current

        p = ucmd.Parameters.Add("@ID", OleDbType.Integer)
        p.SourceColumn = "ID"
        p.SourceVersion = DataRowVersion.Current

        adapt.UpdateCommand = ucmd

        conn.Open()
        If conn.State = ConnectionState.Open Then
            adapt.MissingSchemaAction = MissingSchemaAction.AddWithKey
            adapt.Fill(ds, "ABC")
            'conn.Close()
        End If

        tables = ds.Tables
        table = tables("ABC")
        rows = table.Rows
        cols = table.Columns

        row = rows.Find(TextBox1.Text)
        row.BeginEdit()
        row("ID") = TextBox1.Text
        row("emp_name") = TextBox2.Text
        row("emp_addr") = TextBox3.Text
        row("DOB") = DateTimePicker1.Text
        row("DOJ") = DateTimePicker2.Text
        row("emp_mob") = TextBox4.Text
        row("emp_mail") = TextBox5.Text
        row.EndEdit()
        'conn.Open()
        adapt.Update(ds, "ABC")** Getting error on this line 
    Catch ex As Exception
        MessageBox.Show(ex.ToString)
    End Try
  End Sub 
```

但我没有找到我要去的地方....请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:35:36.340

你没有设置`usql`到`ucmd`任何地方。

```
ucmd.CommandText = usql; 
```

或者更确切地说，在您的构造函数中：

```
ucmd = New OleDbCommand(isql, conn) 
```

`isql`应该是`usql`。`isql`如果您没有收到编译错误，我猜想类中有一个字符串字段。

# ruby-on-rails - Rails 4 + Turbolinks：JS 在头部还是在身体底部？

> ID：12642045
> 
> 赞同：17
> 
> 时间：2012-09-28T14:32:06.697
> 
> 标签：ruby-on-rails, turbolinks

我习惯于将我的 JS 粘贴在我的 body 元素的底部（根据 HTML5Boilerplate），但是由于[TurboLinks （在 Rails 4 中](https://github.com/rails/turbolinks)[默认启用](https://twitter.com/dhh/status/251024691337244672)）会在每个请求时重新加载正文（和标题），这是否有意义从现在开始把我的JS放在头上？在这方面是否有任何体面的指南或最佳实践？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2016-09-28T14:18:07.013

如果您使用的是 Turbolinks 5，您现在可以将 turbolinks 放在身体底部（并遵循 web 开发最佳实践来呈现页面）。这也对 SEO 有所帮助。只需将脚本添加到正文底部并添加

`data-turbolinks-eval="false"`

到您的脚本标签。这将防止 turbolink在初始页面加载*后进行评估。*以下是它是如何完成的`javascript_include_tag`：

`<%= javascript_include_tag 'application', 'data-turbolinks-eval' => 'false'%>`

然后只需使用

`$(document).on('turbolinks:load', function() { // code to be executed when use changes pages });`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-28T14:59:04.457

默认情况下，预编译的 application.js（根据资产管道）也处于打开状态。原因是，即使 js 在页面的其余部分之前加载，由于 js 始终相同，它将从第二个请求开始从缓存中加载，因此没有实际理由在底部提供它身体了。

# javascript - 如何使用 JQuery 移动框架调用 .net 网络服务？

> ID：12642047
> 
> 赞同：0
> 
> 时间：2012-09-28T14:32:08.883
> 
> 标签：javascript, html, jquery-mobile

在我的应用程序中，我需要调用返回 XML 数据的 .NET Web 服务。如何使用 JQuery Mobile 调用 Web 服务以及如何显示响应。指导我你可能的方式。在此先感谢

# c# - 如何将新的 DataRow 添加到 DataTable 中？

> ID：12642049
> 
> 赞同：42
> 
> 时间：2012-09-28T14:32:17.187
> 
> 标签：c#, datagridview, datatable, datarow

我有一个`DataGridView`绑定到一个`DataTable`（`DataTable`绑定到数据库）。我需要`DataRow`在`DataTable`. 我正在尝试使用以下代码：

```
dataGridViewPersons.BindingContext[table].EndCurrentEdit();
DataRow row = table.NewRow();

for (int i = 0; i < 28; i++)
{
    row[i] = i.ToString();
} 
```

但它不起作用，`DataGridView`从未添加过新行。请告诉我，我该如何修复我的代码？

先感谢您。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-09-28T14:34:44.653

您可以尝试使用此代码 - 基于`Rows.Add method`

```
DataTable table = new DataTable();
DataRow row = table.NewRow();
table.Rows.Add(row); 
```

参考：[https](https://docs.microsoft.com/dotnet/api/system.data.datarowcollection.add?view=net-5.0#System_Data_DataRowCollection_Add_System_Data_DataRow) ://docs.microsoft.com/dotnet/api/system.data.datarowcollection.add?view=net-5.0#System_Data_DataRowCollection_Add_System_Data_DataRow _

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2016-11-18T15:50:46.310

我发现[dotnetperls 的例子`DataRow`](https://www.dotnetperls.com/datarow)很有帮助。`DataTable`来自那里的新代码片段：

```
static DataTable GetTable()
{
    // Here we create a DataTable with four columns.
    DataTable table = new DataTable();
    table.Columns.Add("Weight", typeof(int));
    table.Columns.Add("Name", typeof(string));
    table.Columns.Add("Breed", typeof(string));
    table.Columns.Add("Date", typeof(DateTime));

    // Here we add five DataRows.
    table.Rows.Add(57, "Koko", "Shar Pei", DateTime.Now);
    table.Rows.Add(130, "Fido", "Bullmastiff", DateTime.Now);
    table.Rows.Add(92, "Alex", "Anatolian Shepherd Dog", DateTime.Now);
    table.Rows.Add(25, "Charles", "Cavalier King Charles Spaniel", DateTime.Now);
    table.Rows.Add(7, "Candy", "Yorkshire Terrier", DateTime.Now);

    return table;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-11-14T05:55:05.203

//َ用表的结构创建一个新行：

```
DataTable table = new DataTable();
DataRow row = table.NewRow();
table.Rows.Add(row); 
```

//给行的列赋值（这一行应该有28列）：

```
for (int i = 0; i < 28; i++)
{
    row[i] = i.ToString();
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-28T14:35:34.733

您必须[将该行](http://msdn.microsoft.com/en-us/library/5ycd1034%28v=vs.110%29.aspx)显式添加到表中

```
table.Rows.Add(row); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-14T21:54:36.750

如果需要从另一个表中复制，则需要先复制结构：

```
DataTable copyDt = existentDt.Clone();
copyDt.ImportRow(existentDt.Rows[0]); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-28T14:55:24.893

这对我有用：

```
var table = new DataTable();
table.Rows.Add(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-28T14:36:07.977

`table.Rows.add(row);`在你的`for`陈述之后尝试。

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2017-06-20T19:22:07.997

```
 GRV.DataSource = Class1.DataTable;
            GRV.DataBind();

Class1.GRV.Rows[e.RowIndex].Delete();
        GRV.DataSource = Class1.DataTable;
        GRV.DataBind(); 
```

# java - 如何使用嵌入式字体通过 iText 调用 Graphics2D.drawString(...)（DefaultFontMapper？）

> ID：12642051
> 
> 赞同：6
> 
> 时间：2012-09-28T14:32:19.060
> 
> 标签：java, itext

要生成有效的 PDF/X 文档，必须嵌入所有字体。不知何故，我不可能在 Graphics2D 上下文中使用这些字体。

这个单元测试显示了问题（注释行是我做的一些测试）：

```
import java.awt.Font;
import java.awt.Graphics2D;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintStream;
import java.util.Map.Entry;

import org.junit.Test;

import com.itextpdf.awt.DefaultFontMapper;
import com.itextpdf.awt.DefaultFontMapper.BaseFontParameters;
import com.itextpdf.awt.PdfGraphics2D;
import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.Rectangle;
import com.itextpdf.text.pdf.PdfWriter;

public class TestFont
{

    @Test
    public void shouldBeAbleToAddFountsAndDrawOnCanvas() throws FileNotFoundException, DocumentException
    {
        final DefaultFontMapper mapper = new DefaultFontMapper();
        mapper.insertDirectory(".");

        final PrintStream out2 = new PrintStream(System.out);
        for (final Entry<String, BaseFontParameters> entry : mapper.getMapper().entrySet())
        {
            out2.println(String.format("%s: %s", entry.getKey(), entry.getValue().fontName));
        }
        out2.flush();

        final float width = 150;
        final float height = 150;

        final Document document = new Document(new Rectangle(width, height));
        final PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream("fonts.pdf"));
        writer.setPDFXConformance(PdfWriter.PDFX32002);

        document.open();
        final Graphics2D g2d = new PdfGraphics2D(writer.getDirectContent(), width, height, mapper);

        g2d.setFont(new Font("Comicate", Font.PLAIN, 12));

        g2d.drawString("Hello world", 5, 24);

        g2d.dispose();

        document.close();
    }

} 
```

它将抛出一条`PdfXConformanceException`带有消息：“必须嵌入所有字体。这个不是：Helvetica。

我已经浏览了`PdfGraphics2D`该类以检查`setFont()`实现并发现`FontMapper`将使用 a 。我已经将它添加到上面的单元测试中。

```
public void setFont(Font f) {
    if (f == null)
        return;
    if (onlyShapes) {
        font = f;
        return;
    }
    if (f == font)
        return;
    font = f;
    fontSize = f.getSize2D();
    baseFont = getCachedBaseFont(f);
}

private BaseFont getCachedBaseFont(Font f) {
    synchronized (baseFonts) {
        BaseFont bf = (BaseFont)baseFonts.get(f.getFontName());
        if (bf == null) {
            bf = fontMapper.awtToPdf(f);
            baseFonts.put(f.getFontName(), bf);
        }
        return bf;
    }
} 
```

单元测试基于iText in Action 书中的[这个示例](http://itextpdf.com/examples/iia.php?id=261)。[以下](http://itextpdf.com/themes/keyword.php?id=457)是有关 FontMapper 的其他一些示例。

要运行 Unittest，您需要此依赖项：

```
<dependency>
    <groupId>com.itextpdf</groupId>
    <artifactId>itextpdf</artifactId>
    <version>5.3.2</version>
</dependency> 
```

[您在此处](http://www.urbanfonts.com/fonts/Comicate.htm)找到的自定义字体（位于“.”中）。

控制台输出向我显示了这一点（以识别字体名称）：

```
Comicate: ./COMICATE.TTF 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T23:09:54.373

我不确定纠正代码中错误的确切方法，但有一些简单的解决方法：

解决方法 1) 创建一个 BufferedImage 来完成所有图形绘制。然后，您可以使用所有正常`java.awt.Graphics`功能，例如iText`drawString`并且`setColor`无论 iText 是什么，完成后只需将图像绘制到 PDF 即可。警告您在缩放时会降低文本质量，但这里有一个示例：

```
//create doccument and writer    
Rectangle pagesize = new Rectangle(200, 100);
Document document= new Document(pagesize);
PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream("C:\\sample.pdf"));

BufferedImage bf = new BufferedImage(BorderWidth, BorderHeight, BorderWidth);
//Do all graphics code here, draw strings and images etc
    //Some code to set font (java.awt.Font)
    //Some code to draw string
    //Some code to draw image?

//Convert BufferedImage to Image
Image img = (Image)bf;
//draw image to PDF using writer
writer.getDirectContentUnder().addImage(img); 
```

解决方法 2）这使用 iText 功能来绘制字符串，无需创建任何图形对象，通过使用 a 来处理字体`BaseFont`，如下所示：

```
//create doccument and writer    
Rectangle pagesize = new Rectangle(200, 100);
Document document= new Document(pagesize);
PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream("C:\\sample.pdf"));

document.open();
//This sample uses the "GOTHIC.TTF" font file located in the "Template" package
BaseFont bf = BaseFont.createFont(GUI.class.getClass().getResource("/Template/GOTHIC.TTF") + "", BaseFont.WINANSI, BaseFont.EMBEDDED);

//set font type, size and color
Font font = new Font(bf, 13.5f);

PdfContentByte canvas = writer.getDirectContent();

canvas.beginText();
canvas.setFontAndSize(bf, 10);
//Method Usage: showTextAligned(Align, String, x, y, rotation);
canvas.showTextAligned(Element.ALIGN_TOP, "My Text Here", 75, 40, 0);
canvas.endText();

document.close(); 
```

我知道这并没有给出您正在寻找的答案，但是如果您只是绘制少量文本，那么解决方法 2 效果很好，我之前使用过类似于解决方法 2 的东西。如果这没有帮助，那么我相信布鲁诺会有答案。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-23T15:38:36.847

通过定义新的 BaseFont(s) 并实现 FontMapper() 的接口 >>> public BaseFont awtToPdf(java.awt.Font font)。这将应用嵌入到 pdf 中的 awt.font(s)。

在下面的示例中，我“打印”g2D（包括“drawString”方法），在外部类中绘制。结果是仅嵌入了“ArialMT”和“Arial-BoldMT”字体的导出矢量 pdf。

[预览图](http://i.stack.imgur.com/vzyvH.jpg)

```
 PdfWriter pdfWriter = null;
    try {
        pdfWriter = PdfWriter.getInstance(document, new FileOutputStream(file));
        document.open();
        BaseFont fontRegular = BaseFont.createFont("C:\\Windows\\Fonts\\arial_0.ttf", "Cp1251", BaseFont.EMBEDDED);
        BaseFont fontBold = BaseFont.createFont("C:\\Windows\\Fonts\\arialbd_0.ttf", "Cp1251", BaseFont.EMBEDDED);
        FontMapper fontMapper = new FontMapper() {

            @Override
            public java.awt.Font pdfToAwt(BaseFont arg0, int arg1) {
                // TODO Auto-generated method stub
                return null;
            }

            @Override
            public BaseFont awtToPdf(java.awt.Font font) {
                if (font.equals(Fonts.getFontRegular10()) || font.equals(Fonts.getFontRegular12())){
                    return fontRegular;
                }
                else {
                    return fontBold;
                }
            }
        };
        PdfContentByte cb = pdfWriter.getDirectContent();
        PdfTemplate template = cb.createTemplate(MainFrame.getFRAME_WIDTH(), MainFrame.getFRAME_HEIGHT());
        Graphics2D g2D = new PdfGraphics2D(template, MainFrame.getFRAME_WIDTH(), MainFrame.getFRAME_HEIGHT(), fontMapper);
        MainFrame.getPanel().print(g2D);
        g2D.dispose();
        cb.addTemplate(template, 0, 0);
    }
    catch (Exception e1) {
        e1.printStackTrace();
    }
    finally {
        document.close();
    } 
```

# python - Python 3.2 脚本挂在第三个函数上

> ID：12642061
> 
> 赞同：0
> 
> 时间：2012-09-28T14:33:17.257
> 
> 标签：python, python-3.2

我正在尝试制作一个非常简单的 python 脚本，将两个字符放在一起，但是在运行脚本时，它执行脚本用来定义两个字符统计信息的前两个函数，但是当它到达第三个函数时，它只是挂起。

这是代码：

```
#STAPS: Strength Toughness Agility Perception weapon Skill
#A comparative simulator
import random
#Functions used to define character parameters
#Character 1's parameter function

def char1():
    global s1
    global t1
    global a1
    global p1
    global dam1
    global dt1
    global dr1
    global ac1
    global ws1
    s1 = int(input("Char1's Strength? "))
    t1 = int(input("Char1's Toughness? "))
    a1 = int(input("Char1's Agility? "))
    p1 = int(input("Char1's Perception? "))
    dam1 = int(input("Char1's Damage? "))
    dt1 = int(input("Char1's Damage Threshold? "))
    dr1 = int(input("Char1's Damage Resistance? "))
    ac1 = int(input("Char1's Armor Class? "))
    ws1 = int(input("Char1's Weapon Skill? "))

#Character 2's paramter function
def char2():
    global s2
    global t2
    global a2
    global p2
    global dam2
    global dt2
    global dr2
    global ac2
    global ws2
    s2 = int(input("Char2's Strength? "))
    t2 = int(input("Char2's Toughness? "))
    a2 = int(input("Char2's Agility? "))
    p2 = int(input("Char2's Perception? "))
    dam2 = int(input("Char2's Damage? "))
    dt2 = int(input("Char2's Damage Threshold? "))
    dr2 = int(input("Char2's Damage Resistance? "))
    ac2 = int(input("Char2's Armor Class? "))
    ws2 = int(input("Char2's Weapon Skill? "))

#Main battle function. Ordo Xenos calls this "complex and easy to misuse"
#Jury-rigged way of getting names, why did I include them anyways?

def stapsbatt(c1n,c2n,hp1,hp2):
    while hp1 > 0 or hp2 > 0:
    #determines original raw acc
        char1rawacc = ws1 - ac2
    #if statement settles it to minimum 95% acc
    if char1rawacc > 95:
        char1rawacc = 95
    #random int used to determine whether it's a hit or not
    char1hitnum = random.randint(0, 100)
    if char1rawacc > char1hitnum:
        moddam1 = dam1 - dt2
        if moddam1 < 0:
            moddam1 = 0
        rawdam1 = moddam1 * (100 - dr2)
        hp2 = hp2 - rawdam1
    #Now we move on to doing char2's batt calcs
    char2rawacc = ws2 - ac1
    if char2rawacc > 95:
        char2rawacc = 95
    char2hitnum = random.randint(0, 100)
    if char2rawacc > char2hitnum:
        moddam2 = dam2 - dt1
        if moddam2 < 0:
            moddam2 = 0
        rawdam2 = moddam2 * (100 - dr1)
        hp1 = hp1 - rawdam2
    if hp1 == 0:
        print(c2n, "has won!")
    else:
        print(c1n, "has won!")
    char1()
    char2()
    stapsbatt("Character 1", "Character 2",400,30)
    input("Press enter to exit. ") 
```

是的，这段代码完全未经编辑，我意识到我的评论不是很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:36:10.117

首先，您的注释必须与代码处于相同的缩进级别。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:14:35.483

您的代码有一些问题导致它挂起。我建议熟悉 python 调试器，例如[pdb](http://docs.python.org/library/pdb.html)。这将允许您在运行时查看值，逐行执行程序。

除了缩进问题，以下是我发现的问题区域：

1.  在您的 while 循环中，您将`while hp1 > 0 and hp2 > 0`其用作条件。你不想在`or`这里使用，否则它会一直循环，直到*两个*字符都 < 0 hp，所以你应该把它改成`and`.
2.  在计算`rawacc`（对于两个字符）时，您使用了`if char1rawacc > 95`，它实际上*在*`char1rawacc`. 你做了同样的事情`char2rawacc`。将这些切换到`if char1rawacc < 95`和`if char2rawacc < 95`。
3.  作为一种风格说明，如果您将其作为脚本执行，您应该将函数调用放在函数定义本身之外，这样做的一个好方法是在脚本末尾放置一个这样的块：

```
    如果 __name__ == "__main__":
        # 以下内容仅在文件作为脚本运行时才会执行
        char1()
        char2()
        stapsbatt("字符 1", "字符 2", 400, 30)

```

希望这能让你摆脱无限循环！通过这些更改，我让游戏在我的电脑上运行。

现在，正如 Oz123 所提到的，您确实在滥用全局变量。相反，您应该研究创建和传递对象（请参阅 9000 的答案）。例如，您可以为您的角色定义一个类，并创建该类的两个实例（char1 和 char2），并传递给您的战斗函数。这也将使您免于大量冗余代码。这将需要一些重大的重组，但这是值得的。如果您遇到问题，请随时提出一个新问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:09:53.867

您可能正在寻找的问题：

```
while hp1 > 0 or hp2 > 0:
    #determines original raw acc
    char1rawacc = ws1 - ac2 
```

这个循环永远不会结束，因为无论你在里面做什么都不会改变它的条件。可能你想要一个`if`.

其余的：天哪。看到这段代码很痛苦。让我们让它变得更好一点。

`global`除非您有充分的理由这样做，否则不要使用。现在，将其视为纪律问题；随着您作为程序员的进步，您将明白为什么范围分离很重要。

用函数来描述类似的事情*一次*。这就是重点：删除重复的部分，用名称替换它们，用新的“单词”让你的语言更接近你正在解决的问题。

```
def get_character_description(name):
    print "Describe character %s" % name
    # input values here...
    return description

char1 = get_character_description('Liu Kang')
char2 = get_character_description('Sub Zero') 
```

使用数据结构。在这种情况下，将角色的统计数据组合成一个实体。

```
# Use a dict to describe character stats
def get_character_description(name):
    description = {}
    description['name'] = name
    print "Describe character %s" % name
    description['strength'] = int(input("%s's strength?"))
    # input other values here...
    return description

char1 = get_character_description('Pikachu')
if char1['strength'] > 100: ... 
```

当您了解类时，请考虑创建一个自定义类来描述字符：

```
class Character(object):
    def __init__(self, name):
        self.name = name

    def input(self):
        print "Let's define stats of %s" % self.name
        self.strength = int(input("Strength?"))
        # and so on

char1 = Character('J.C. Denton')
if char1.strength > 100: ... 
```

之后，您的代码可能如下所示：

```
char1 = get_character_description('Liu Kang')
char2 = get_character_description('Sub Zero')
if char1.wins_over(char2):
   print char1.name, "has won"
else:
   print char2.name, "has won" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T15:22:55.210

两个不朽的角色（带有“或->和”修复）=>无限循环

```
moddam1 = dam1 - dt2
if moddam1 < 0:
    moddam1 = 0                  # dam1 <= dt2: moddam1 = 0
rawdam1 = moddam1 * (100 - dr2)  # rawdam1 == 0
hp2 = hp2 - rawdam1              # hp2 == const: immortality 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T15:21:00.153

如果它让您感觉更好，那么您的程序似乎没有问题。（没关系，是的，这是 while 语句）

```
Traceback (most recent call last):
  File "C:\Python32\staps.py", line 89, in <module>
    stapsbatt("Character 1", "Character 2",400,30)
  File "C:\Python32\staps.py", line 76, in stapsbatt
    char2hitnum = random.randint(0,100)
  File "C:\Python32\lib\random.py", line 215, in randint
    return self.randrange(a, b+1)
  File "C:\Python32\lib\random.py", line 191, in randrange
    return istart + self._randbelow(width)
  File "C:\Python32\lib\random.py", line 221, in _randbelow
    getrandbits = self.getrandbits
KeyboardInterrupt 
```

它挂在随机模块内，尽管尝试了其他几个功能（`random.randrage(0,100)`和`random.choice(range(0,100))`），但问题仍然存在。奇怪的是，在程序之外调用函数没有问题。

试着清理一下你的代码，看看它是否有所改善。一般来说，你的全局变量应该在开始时声明。另外，我认为您的意思是在这一行中说“和”而不是“或”：`while hp1 > 0 or hp2 > 0:`。在这种情况下使用 OR 意味着 char1 或 char2 是否存在。你只想一直到战斗结束（当然，除非你喜欢打死马）。

# winforms - ClickOnce WinForms 更新和身份验证

> ID：12642063
> 
> 赞同：0
> 
> 时间：2012-09-28T14:33:22.227
> 
> 标签：winforms, clickonce

多年来，我对 ClickOnce 进行了大量研究并使用它，但需要对某些事情给出明确的答案。如果我有一个 WinForms 应用程序利用 ClickOnce 来获取应用程序更新，那么除了 Windows 身份验证之外没有其他身份验证方案有效吗？

例如，如果我有一个远程用户通过 VPN 对域进行了身份验证，但他们的机器***没有***加入域，更新会起作用吗？我相信答案是“不”，因为即使知道他们是通过 VPN 进行身份验证的，他们运行的上下文是“MyHomePC\HomeUser”而*不是*“MyWorkDomain\jsmith”。真的，这一段是次要问题和独特的用例。

简而言之，WinForms 更新的 ClickOnce 是否真的需要 Windows 身份验证？

# java - ObjectOutputStream 永远挂起

> ID：12642066
> 
> 赞同：1
> 
> 时间：2012-09-28T14:33:32.893
> 
> 标签：java, sockets, outputstream, objectoutputstream

我有一个使用 SSLSocket 连接到服务器的客户端。接下来，我尝试创建一个OOS`ObjectOutputStream oos = new ObjectOutputStream(sslsocket.getOutputStream());`

如果服务器端一切正常，这很好。但是，我想在我的客户端放置一些东西来尝试创建 ObjectOutputStream，但如果它在 60 秒内没有发生，请记录错误并继续处理。我没有看到任何超时选项。有什么可以做到这一点的例子吗？

```
 SSLSocket sslsocket;
     try {
            System.setProperty("javax.net.ssl.trustStore", <myKeystore>);
            System.setProperty("javax.net.ssl.trustStorePassword", <myPW>);
            SSLSocketFactory sslsocketfactory = (SSLSocketFactory) SSLSocketFactory.getDefault();
            sslsocket = (SSLSocket) sslsocketfactory.createSocket(InetAddress.getLocalHost(), <myPort>);

     } catch (Throwable e) {
            logger.logError(e.getMessage());
            return null;
     }

      // This is where it hangs forever
      ObjectOutputStream oos = new ObjectOutputStream(sslsocket.getOutputStream());
      oos.flush(); // never gets here
      oos.writeObject(orders);

      ObjectInputStream ois = new ObjectInputStream(sslsocket.getInputStream()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:37:49.180

您必须在 ObjectInputStream 之前创建 ObjectOutputStream。

**编辑：**见下面的评论。真正的问题是缓慢的 SSL 握手，它发生在套接字上的第一个 I/O 中，在此期间执行读取和写入一样。所以解决方案是设置读取超时。

# ruby-on-rails - 太阳黑子 Solr。如何从帖子中搜索评论

> ID：12642067
> 
> 赞同：0
> 
> 时间：2012-09-28T14:33:42.393
> 
> 标签：ruby-on-rails, ruby, solr, sunspot

我不知道如何仅从当前帖子中搜索评论。如果我使用评论

```
searchable :auto_index => true do
    text :description
end 
```

但是，我想从帖子评论中搜索

```
@search = @post.comments.search 
```

我从 DB 获得所有评论，但不仅来自当前帖子。为什么？((

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:49:35.677

您需要指定要搜索的内容。它返回了所有评论，因为没有用于搜索的参数

见[http://railscasts.com/episodes/278-search-with-sunspot](http://railscasts.com/episodes/278-search-with-sunspot)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:12:55.023

在您的模型中：

```
searchable :auto_index => true do
  text :description
  integer :post_id
end 
```

并在控制器中

```
Comment.search do
  fulltext params[:query]         if params[:query].present?
  with :post_id, params[:post_id] if params[:post_id].present?
end 
```

# c# - 将日期转换为显示月份和日期.Net C#

> ID：12642074
> 
> 赞同：1
> 
> 时间：2012-09-28T14:33:57.420
> 
> 标签：c#, asp.net, .net, visual-studio-2010

我在下面有以下行，目前显示为“9/29/2012”

```
<%=Convert.ToDateTime(prs["xDate"].ToString()).ToShortDateString() %> 
```

我需要它像这样显示“Sept 29”，没有年份。我该怎么做才能在 .NET 中实现这一点。

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:36:08.230

请参阅自定义日期和时间格式字符串的文档：http: [//msdn.microsoft.com/en-us/library/8kb3ddd4.aspx](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)。构造适当的字符串，并使用 ToString 的重载：

```
<%=Convert.ToDateTime(prs["xDate"].ToString("format string here")).ToShortDateString() %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:36:25.887

```
Convert.ToDateTime(prs["xDate"].ToString()).ToString("MMM dd") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:37:08.993

`MMM dd`格式代码是您想要的英文日期格式。

```
DateTime.ToString("MMM dd"); 
```

[http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#MMM_Specifier](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#MMM_Specifier)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T14:37:34.807

1 您也可以使用这种格式的`ToString`方法

```
YourDateTime.ToString("MMMM dd"); 
```

在这里你可以找到所有`formats of your ToString()`

链接[http://www.geekzilla.co.uk/View00FF7904-B510-468C-A2C8-F859AA20581F.htm](http://www.geekzilla.co.uk/View00FF7904-B510-468C-A2C8-F859AA20581F.htm)

2 你可以试试`Day property`

```
Console.WriteLine(YourDateTime.Day); 
```

您可以尝试使用 Month 属性

```
Console.WriteLine(YourDateTime.Month); 
```

并连接

# android - TimePickerDialog.OnTimeSetListener

> ID：12642075
> 
> 赞同：0
> 
> 时间：2012-09-28T14:33:59.320
> 
> 标签：android

Ho do I Hour and the Minute Value in the Fragment，我在其中启动了这个 Timepicker：

```
public static class TimePickerFragment extends DialogFragment
implements TimePickerDialog.OnTimeSetListener {

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        // Use the current time as the default values for the picker
        final Calendar c = Calendar.getInstance();
        int hour = c.get(Calendar.HOUR_OF_DAY);
        int minute = c.get(Calendar.MINUTE);

        // Create a new instance of TimePickerDialog and return it
        return new TimePickerDialog(getActivity(), this, hour, minute,
                DateFormat.is24HourFormat(getActivity()));
    }

    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
        // Do something with the time chosen by the user
    }
} 
```

我在片段中使用此代码进行了尝试：

```
TimePickerDialog.OnTimeSetListener mTimeSetListener =
new TimePickerDialog.OnTimeSetListener() {
    @Override
    public void onTimeSet(android.widget.TimePicker view,
            int hourOfDay, int minute) {
        Log.i("",""+hourOfDay+":"+minute);
        textview.setText(""+hourOfDay+":"+minute);
    }
}; 
```

但它确实设置了任何东西

您能帮我从 Timepicker 中获取值吗？

**编辑** 这是片段...

```
public class EditStoreFragment extends SherlockFragment {

private ViewPager awesomePager;
private static int NUM_AWESOME_VIEWS = 9;
AwesomePagerAdapter awesomeAdapter;

TextView textview;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    view = inflater.inflate(R.layout.fragmentview, container, false);

    awesomeAdapter = new AwesomePagerAdapter();
    awesomePager = (ViewPager) view.findViewById(R.id.awesomepager);
    awesomePager.setAdapter(awesomeAdapter);

    //...

    return view;

}

class AwesomePagerAdapter extends PagerAdapter {

    public View v2;
    DialogFragment timepicker;

    @Override
    public int getCount() {
        return NUM_AWESOME_VIEWS;
    }

    /**
     * Create the page for the given position. The adapter is responsible
     * for adding the view to the container given here, although it only
     * must ensure this is done by the time it returns from
     * {@link #finishUpdate()}.
     * 
     * @param container
     *            The containing View in which the page will be shown.
     * @param position
     *            The page position to be instantiated.
     * @return Returns an Object representing the new page. This does not
     *         need to be a View, but can be some other container of the
     *         page.
     */
    @Override
    public Object instantiateItem(View collection, int position) {
        v2 = new View(getActivity().getApplicationContext());
        timepicker = new TimePickerFragment();

        collection.getContext().getSystemService(
                Context.LAYOUT_INFLATER_SERVICE);
        final LayoutInflater inflater = (LayoutInflater) getActivity()
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        switch (position) {
        case 0:

                    //...

            break;
        case 1:

                    //...
            break;

        case 2:
            v2 = inflater.inflate(R.layout.edit_open, (ViewGroup) null,
                    false);

            ((TextView) v2.findViewById(R.id.titel_wt)).setText("MONTAG");

            textview = (TextView) v2.findViewById(R.id.textview);

            textview
                    .setOnClickListener(new View.OnClickListener() {

                        @Override
                        public void onClick(View v) {

                            timepicker.show(getActivity().getSupportFragmentManager(), "timePicker");

                            Log.i("","opentimepicker");

                        }
                    });

            TimePickerDialog.OnTimeSetListener mTimeSetListener =
                new TimePickerDialog.OnTimeSetListener() {
                    @Override
                    public void onTimeSet(android.widget.TimePicker view,
                            int hourOfDay, int minute) {
                        Log.i("",""+hourOfDay+":"+minute);
                        textview.setText(""+hourOfDay+":"+minute);

                        textview.invalidate();
                    }
                };

            break;

        case 3:
            //Like in case 2 but with other textview...

            break;

        case 4:
            //Like in case 2 but with other textview...

            break;

        case 5:
            //Like in case 2 but with other textview...

            break;

        case 6:
            //Like in case 2 but with other textview...

            break;

        case 7:
            //Like in case 2 but with other textview...

            break;

        case 8:
            //Like in case 2 but with other textview...

            break;
        }

        ((ViewPager) collection).addView(v2, 0);
        return v2;
    }

    /**
     * Remove a page for the given position. The adapter is responsible for
     * removing the view from its container, although it only must ensure
     * this is done by the time it returns from {@link #finishUpdate()}.
     * 
     * @param container
     *            The containing View from which the page will be removed.
     * @param position
     *            The page position to be removed.
     * @param object
     *            The same object that was returned by
     *            {@link #instantiateItem(View, int)}.
     */
    @Override
    public void destroyItem(View collection, int position, Object view) {
        ((ViewPager) collection).removeView((View) view);
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view == ((View) object);
    }

    /**
     * Called when the a change in the shown pages has been completed. At
     * this point you must ensure that all of the pages have actually been
     * added or removed from the container as appropriate.
     * 
     * @param container
     *            The containing View which is displaying this adapter's
     *            page views.
     */
    @Override
    public void finishUpdate(View arg0) {
    }

    @Override
    public void restoreState(Parcelable arg0, ClassLoader arg1) {
    }

    @Override
    public Parcelable saveState() {
        return null;
    }

    @Override
    public void startUpdate(View arg0) {
    }

} 
```

}

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T17:34:38.607

此代码将获取`TimePicker`您设置的值并将显示在 TextView 中。

```
tvHora = (TextView) findViewById(R.id.tvHora);

    final Calendar d = Calendar.getInstance();
    hour = d.get(Calendar.HOUR_OF_DAY);
    minute = d.get(Calendar.MINUTE);

    //set current time into textview
    tvHora.setText(new StringBuilder().append(pad(hour)).append(":").append(pad(minute))); 
```

我的文本视图在哪里`tvHora`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:08:08.763

从你的代码中我不太明白你在哪里使用你的`mTimeSetListener`. 这应该有效：

```
public static class TimePickerFragment extends DialogFragment
implements TimePickerDialog.OnTimeSetListener {

private TextView mTextView;

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        mTextView = (TextView) findViewById(...);

        // Use the current time as the default values for the picker
        final Calendar c = Calendar.getInstance();
        int hour = c.get(Calendar.HOUR_OF_DAY);
        int minute = c.get(Calendar.MINUTE);

        // Create a new instance of TimePickerDialog and return it
        return new TimePickerDialog(getActivity(), this, hour, minute,
                DateFormat.is24HourFormat(getActivity()));
    }

    @Override
    public void onTimeSet(android.widget.TimePicker view,
            int hourOfDay, int minute) {
        Log.i("",""+hourOfDay+":"+minute);
        mTextView.setText(""+hourOfDay+":"+minute);
    }
} 
```

# java - 使用注释将一个实体映射到两个不同的表中

> ID：12642076
> 
> 赞同：0
> 
> 时间：2012-09-28T14:34:00.957
> 
> 标签：java, mysql, hibernate

我在以下问题上遇到了很多麻烦。我有一个实体“主页”，我在代码中的两个不同位置使用它。问题是，有必要根据使用的类将此实体映射到不同的表。

如果我们假设我将有两个类 Class1 和 Class2。这两个类都具有“Home”类型的属性。现在我希望class1中的属性映射到表“CLASS1_HOME”，而class2的属性映射到表“CLASS2_HOME”。

我知道这是可能的，例如，对“Home”类使用“MappedSuperClass”并创建另一个类“Second_Home”，它继承了“home”类的所有属性。但我的问题是，如果没有继承，是否有可能，因为 home 的属性不会改变，我认为“继承”解决方案是一种“肮脏”。此外，我只想通过使用注释来做到这一点。

有没有办法按照我描述的那样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:40:17.880

如果您不想使用继承，并且在 CLASS1_HOME 和 CLASS2_HOME 表中以相同的方式保存 HOME，我建议您这样做：

```
public class Home{
boolean Class1;
} 
```

在这种情况下，当您坚持它时，您可以简单地确定这是否适用于 Class1。如果你愿意，根据你数据库中持久化的标志，你可以创建两个视图 CLASS1_Home 和 CLASS2_Home

# c++ - 卡尔达诺在 C++ 中的方法

> ID：12642077
> 
> 赞同：0
> 
> 时间：2012-09-28T14:34:02.517
> 
> 标签：c++

我正在尝试制作一个程序，该程序将使用卡尔达诺的方法计算三次函数的根

这是我的代码：

```
#include<iostream>
#include<cmath>
using namespace std;

int main()
{
    double a, b, c, d, value;
    double f, g, h;
    double i, j, k, l, m, n, p, po;
    double r, s, t, u;
    double x1, x2, x2re, x2im, x3re, x3im, x3;

    cin >> value;
    for(int w=1; w <= value; w++){
       cin >> a >> b >> c >> d;
       cout << "CUBIC EQUATION : " << a << " x^3 + " << b << " x^2 + " << c <<" x + " << d << " = 0" << endl;

       f = ((3*c/a)-((b*b)/(a*a)))/3;
       g = ((2*(b*b*b)/(a*a*a))-(9*b*c/(a*a))+(27*d/a))/27;   
       h = ((g*g)/4)+((f*f*f)/27);

    if(f==0 && g==0 && h==0){     // all roots are real and equal
       x1 = pow((d/a),0.33333333333333333333333333333333);
       x2 = pow((d/a),0.33333333333333333333333333333333);
       x3 = pow((d/a),0.33333333333333333333333333333333);
       cout << "x = " << x1 << endl;
       cout << "x = " << x2 << endl;
       cout << "x = " << x3 << endl;
       }
    else if(h<=0){         // all 3 roots are real
       i = pow((((g*g)/4)-h),0.5);
       j = pow(i,0.33333333333333333333333333333333);
       k = acos((g/(2*i))*-1);
       l = j * -1;
       m = cos(k/3);
       n = sqrt(3) * sin(k/3);
       p = (b/(3*a))*-1;
       x1 = (2*j)*m-(b/(3*a));
       cout << "x = " << x1 << endl;
       x2 = l * (m+n) + p;
       cout << "x = " << x2 << endl;
       x3 = l * (m-n) + p;
       cout << "x = " << x3 << endl;
       }
    else if(h>0){
       r = ((g/2)*-1)+pow(h,0.5);
       s = pow(r,0.33333333333333333333333333333333);
       t = ((g/2)*-1)-pow(h,0.5);
       u = pow((t),0.33333333333333333333333333333333);
       x1 = (s+u) - (b/(3*a));
       cout << "x = " << x1 << endl;
       x2re = (((s+u)*-1)/2) - (b/(3*a));
       x2im = -(s-u)*pow(3,0.5)/2;
       cout << "x = (" << x2re << "," << x2im << ")" << endl;
       x3re = (((s+u)*-1)/2) - (b/(3*a));
       x3im = (s-u)*pow(3,0.5)/2;
       cout << "x = (" << x3re << "," << x3im << ")" << endl;
       }
       }

    return 0;
} 
```

任何人都可以帮助在此代码中实现用户定义的 ComplexNumber 吗？我想使用此链接[http://en.wikipedia.org/wiki/Cubic_function](http://en.wikipedia.org/wiki/Cubic_function)但我无法理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:43:17.590

> 任何人都可以帮助在此代码中实现用户定义的 ComplexNumber 吗？

不要实现用户定义的 ComplexNumber 类型。使用语言提供的那个。只是`#include <complex>`。有了它，您可以简单地通过`complex<double> variable_name`.

**代码注释：**

1.  最好使用`std::sqrt(x)`而不是`std::pow(x, 0.5)`.
2.  如果您使用的是符合 POSIX 的机器，那么您的数学库在 header 中有一个立方根函数 cbrt(double)。（它可能不会导出到 C++ 头文件。）这也比`std::pow(x,0.33333333333333333333333333333333)`.

# jquery - 使用 knockout.js 进行时间注册

> ID：12642088
> 
> 赞同：0
> 
> 时间：2012-09-28T14:35:01.993
> 
> 标签：jquery, knockout.js

我想要完成的是创建一个极其动态的表格（添加、删除行、使某些单元格可单击以注入有意义的信息、进行子选择，其中进行了某个注册，...）。

目前我正在使用纯 jQuery 创建它，但我注意到我已经结合*underscore.js*编写了很多函数和解决方法，以使其正常工作。

可以在这里找到一个非常简化的版本：http: [//jsfiddle.net/KvdM/FxmbB/9/](http://jsfiddle.net/KvdM/FxmbB/9/)。

我从[http://learn.knockoutjs.com/](http://learn.knockoutjs.com/)获取了在线教程。我想知道是否可以使用 knockout.js 和模板制作一种更清洁、更易于维护的解决方案。

用作输入并且需要与放入表中的内容保持同步的 json 现在来自 ASP.NET MVC。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:23:30.660

我想这可能会回答你的问题。恕我直言，淘汰赛是一个更易于维护的解决方案。 [http://jsfiddle.net/photo_tom/eY9w8/7/](http://jsfiddle.net/photo_tom/eY9w8/7/)

# conflict - 管理厨师中的冲突角色

> ID：12642092
> 
> 赞同：3
> 
> 时间：2012-09-28T14:35:19.333
> 
> 标签：conflict, roles, chef-infra

我对厨师比较陌生，所以我可能会遗漏一些非常基本的东西。经过大量搜索，我没有找到我需要的东西，所以这里是：

在 Chef 中，我的角色相互冲突。我需要某种类型的所有服务器都具有角色 A，但具有角色 B 的服务器除外。

我能想到的最好的描述方式是举个例子：

系统日志 1、系统日志 2

网络1、网络2、网络3

数据库 1、数据库 2

邮件1，邮件2

此环境中的每台服务器（数十个）都有一个名为 syslog_client 的角色，但 syslog1 和 syslog2 除外，它们需要具有角色 syslog_server。

syslog-server 和 syslog-client 角色冲突，因为它们以不同的方式配置相同的软件。

这些是角色而不是食谱，因为它们实际上包含多个食谱。

我想过做这样的事情：

角色/base.rb：

```
name "base"
description "base configuration"
override_attributes(
)
default_attributes(
)
run_list(
  "recipe[one]",
  "recipe[two]",
  "recipe[three]",
  "role[uno]"
)

unless node[:roles].include?('syslog_server')
  run_list('role[syslog_client]')
end 
```

问题是此时节点对象不存在。我曾考虑将其移入食谱中，但我也想不出一个好方法来做。我能够在基本配方中使用它：

```
unless node[:roles].include?('syslog_server')
  node[:roles]+=['syslog_client']
end 
```

这会将 syslog_client 添加到角色属性（或不正确），但它从未实际运行 syslog_client 角色。

我已经考虑将 syslog_client 移动到一个独立的配方而不是一个角色中，并将角色属性移动到环境中。这会起作用，因为那样我就可以打电话了`include_recipe "syslog::client"`。问题是我们几乎所有的食谱都是从角色分配的（而不是从其他食谱中分配的），我担心做出这种改变会造成一次性的难以跟踪。除此之外，正如我已经提到的，这些实际上是几个食谱，因此将它们作为一个食谱添加并不理想。

在我目前工作的环境中，我们有许多不同的服务器类型/角色，向它们添加角色 [syslog_client] 是可行的，但并不理想。由于有多个人在此工作，似乎有人会忘记将配方添加到新角色中。

在一个理想的世界里，像我的第一个解决方案这样的东西是可能的，因为这使我们能够尽可能地保持我们的环境一致。不过，我对其他选择持开放态度。

所以总结一下，我认为我需要有人告诉我如何：

1.  使第一个解决方案起作用。仅当不存在另一个角色时才将角色添加到运行列表
2.  如果我不能拥有#1，我想就使用我列出的方式或我没有想到的其他想法来实现这一目标的最佳方式提出意见

如果我遗漏了有关我们厨师设置的任何有用的详细信息，请告诉我。

**免责声明**：上面的示例实际上是我实际尝试实现的非常简化的版本。我什至没有使用 syslog，但它所服务的公司非常注重安全，并且不会对公开发布他们的环境细节感到满意。如果我遗漏了任何内容并且我需要添加更多信息，我将尽可能详细。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:46:35.433

扩展上面所说的创建两个角色的问题。一个客户端和一个服务器

客户端角色包括基础角色和客户端功能。它将通过在所有其他角色中用此角色替换对“base”的引用来应用于所有服务器。这意味着这些角色仍然可以获得基础，但也可以获得客户。

服务器是一个独立的角色，仅适用于那些服务器并且具有基础和服务器角色？

这样，客户端和服务器都可以将基本角色应用于它们，而无需复制基本角色的定义。您仍然可以根据需要管理该基本角色，但在创建角色时使用聚合？

创建新角色时，用户不会从添加 base 开始，而是添加 syslog_client 角色，这也为他们提供了 base。

对我来说，这感觉就像 Chef 在推动你创建角色的方式。我们拥有的是适用于所有服务器的 1 个角色，其中一些适用于 1 个服务器子类型，但不适用于其他服务器。这样一来，我们应用的叶子角色实际上由 4 或 5 个其他角色组成。什么是共同的，以一种无需逻辑即可共享的方式建模？

另一种选择是将客户端配方添加到每个节点，第一个执行步骤是检查节点角色，如果它说服务器基本上只是跳过配方执行？哪个与您要用于添加配方的逻辑相同，但它会存在于配方中并控制执行？

```
unless node[:roles].include?('syslog_server')
   #Do your client install
end 
```

# wcf - 在客户端使用 WCF 可扩展性

> ID：12642093
> 
> 赞同：0
> 
> 时间：2012-09-28T14:35:21.313
> 
> 标签：wcf

我正在使用 Web 应用程序作为客户端来使用代理调用 WCF 方法。

对于客户端对象发出的每个请求，我需要填充几个属性（在请求类中声明）是否可以在进行实际的 Web 服务调用之前挂钩一个方法。

我现在无法修改服务代码，在这种情况下可以利用 WCF 扩展点吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:05:39.783

如果要更改方法*参数*的属性，可以使用 an`IParameterInspector`来执行此操作，因为此时您将获得一个包含要发送到服务器的所有参数的数组。

如果您需要更改请求的其他部分（例如传输或 SOAP 标头），这`IClientMessageInspector`可能是最好的方法。

有关客户端许多扩展点的更多信息，您可以查看[http://blogs.msdn.com/b/carlosfigueira/archive/2011/03/14/wcf-extensibility.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2011/03/14/wcf-extensibility.aspx)上的博客系列。

# java - 在没有文件 I/O 的情况下压缩 Java 中的内容

> ID：12642095
> 
> 赞同：3
> 
> 时间：2012-09-28T14:35:27.267
> 
> 标签：java, compression

我想在不执行任何文件 I/O 而是严格读取字节流的情况下执行 CPU 分析的重复压缩任务。我想在 Java 中做到这一点（我的基准测试的目标）。

有没有人建议如何做到这一点？我使用了使用 ZipEntry 但 ZipEntry 触发文件 I/O 的 Zip API。

非常感谢任何建议或代码示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:38:10.613

> 我使用了使用 ZipEntry 但 ZipEntry 触发文件 I/O 的 Zip API。

`ByteArrayOutputStream`如果您使用 a作为基础输出，我不会期望它：

```
ByteArrayOutputStream baos = new ByteArrayOutputStream();
ZipOutputStream zipStream = new ZipOutputStream(baos);
... write to zipStream ... 
```

同样，包装您的字节数组*以*从`ByteArrayInputStream`.

当然，`ZipOutputStream`如果您想使用 zip 压缩格式创建内容是合适的，这对（或至少处理 :) 多个文件有好处。对于*单个*数据流，您可能希望使用[`DeflaterOutputStream`](http://docs.oracle.com/javase/7/docs/api/java/util/zip/DeflaterOutputStream.html)or [`GZIPOutputStream`](http://docs.oracle.com/javase/7/docs/api/java/util/zip/GZIPOutputStream.html)，再次使用 a`ByteArrayOutputStream`作为基础输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:38:00.177

您可以使用 ByteArrayInputStream 和 ByteArrayOutputStream，而不是使用 FileInputStream 或 FileOutputStream。

# matlab - for i = 1: ... 在 Matlab 中是什么意思？

> ID：12642101
> 
> 赞同：-3
> 
> 时间：2012-09-28T14:35:38.043
> 
> 标签：matlab, for-loop

请注意，下面的代码是从 Matlab 文档中获得的，底部除外。

```
function B = nway(A,n)
% Compute average of every N elements of A and put them in B.

if ((mod(numel(A),n) == 0) && (n>=1 && n<=numel(A)))

B = ones(1,numel(A)/n);
    k = 1;   

    for i = 1 : numel(A)/n
         B(i) = mean(A(k + (0:n-1)));
         k = k + n;

    end 
```

for 循环代码是什么意思，尤其是下面一行？

```
for i = 1 : numel(A)/n 
```

以及如何`i`将其插入其中`B(i)`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:45:13.543

Matlab中的for循环构造为

```
for iterationVariable = listOfValues
    do something
end 
```

将在循环的第一次迭代中`iterationVariable`采用第一列的`listOfValues`值，然后是第二列的值，等等。然后您可以`iterationValue`在计算中使用。

```
for i=1:numel(A)/n 
```

因此会将 的值设置`i`为`1,2,3...`的值`"number of elements of A divided by n"`。

```
B(i) 
```

是一个索引操作，它返回`i`数组的第 th 个元素`B`。

正如@HighPerformanceMark 建议的那样，我非常建议在命令行中尝试这些表达式，或者通过优秀的 Matlab 文档的“入门”部分进行操作。

# perl - 使用 perl 脚本验证收据

> ID：12642102
> 
> 赞同：0
> 
> 时间：2012-09-28T14:35:41.350
> 
> 标签：perl, cordova, in-app-purchase

我必须使用 perl 脚本与 iOS 上的 App Purchase 中的 verifReceipt 交互。我也用 phoneGap 1.5.0

1/ 当我尝试使用外部 url 时它不起作用。2/ 我尝试在 phonegap html 页面和 iTunes 之间使用 perl 脚本接口。我不明白如何发送数据。我试试这个：

```
$val contains JSON object with receiptvalue and password, receiving from phonegap.

my %transformfields = (
            "receipt-data"       => $val,
            );

my $ua = LWP::UserAgent->new;

my $req = POST($urlsend,
    Content_Type => 'application/json ; charset=UTF-8',
    Content => \%transformfields,
    #Content => $val,
    );

my $res = $ua->request($req); 
```

我总是出现这个错误：21002 java.lang.NullPointerException 我不明白这怎么可能用 perl 脚本发送数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T14:43:59.100

我在 json 编码和理解我如何从 phonegap 插件接收数据方面遇到问题。

寻求帮助：Phongap 插件在 Base64 中返回 transactionReceipt。也不要在 Base64 中编码密码。

```
my %transformfields = ("receipt-data" => $val , "password" => $sharedsecretpass ) ;
my $jsonval = encode_json (\%transformfields);

print "Content-Type: text/html \n\n";

#my $urlsend="https://buy.itunes.apple.com/verifyReceipt" ;
my $urlsend="https://sandbox.itunes.apple.com/verifyReceipt" ;

my $req = POST($urlsend,
    Content_Type => 'application/x-www-form-urlencoded ; charset=utf-8',
    Content => $jsonval,
    );

my $ua = LWP::UserAgent->new;
my $res = $ua->request($req);

if ($res->is_success)
{
    #print "cgi Content : " . $res->content . "<br />\n";
    my $retour = decode_json( $res->content );
    if ($retour->{'status'} eq "0")
    {
            print "--OK--<br />\n";
            print $retour->{receipt}->{product_id} . "<br />";
            print $retour->{receipt}->{transaction_id} . "<br />";
            print $retour->{receipt}->{purchase_date} . "<br />";
            print $retour->{receipt}->{expires_date} . "<br />";

            #$res->content
    } 
```

# javascript - 是否有与 Lightbox 等效的“任意 HTML”，具有部分不透明的遮罩？

> ID：12642106
> 
> 赞同：0
> 
> 时间：2012-09-28T14:36:03.893
> 
> 标签：javascript, jquery, html, css

[Lightbox 2](http://lokeshdhakar.com/projects/lightbox2/)很好地展示了一个灯箱，

(a) 适用于图像，但似乎没有记录用于非图像使用，并且

(b) 对 ?div 具有完全的不透明度？覆盖除灯箱之外的所有内容。

我想要一个类似的程序

(a) 适用于任意 HTML，或至少一个包含 CSS 定位的 div、图像和文本的 div，以及

(b) 覆盖 div 的不透明度为 50%，这样背景仍然清晰可见，只是变暗和淡化。

我最好的选择是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:38:11.670

通常不会回答软件建议，但我认为[GreyBox](http://orangoo.com/labs/GreyBox/)适合您。

该页面上的示例说明了一个半透明的叠加层（但是，在大多数情况下很容易更改）并启动它以包含图像、网站等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:42:51.520

[Fancybox](http://fancyapps.com/fancybox/) - 将为您提供该功能集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:49:57.073

(a) 你可以用 iframe 自己解决这个问题。但是，如果您需要一个框架（它不是“程序”），请尝试 dojo。如果你想要干净的 js 代码，你需要阅读一些内容才能让它像你想要的那样运行，对于一个简短的 hack，但是 dojos 对话框也很容易和快速使用。

(b) 如果您不喜欢这种风格，请不要更改您的 javascript 框架。这就像因为您不喜欢标准字体而从 word 更改为 open office。只需在灯箱的 css 文件之后（！）包含这个 css 文件：

```
#lightboxOverlay {
    opacity: 0.5;
} 
```

# ruby-on-rails - 如何创建正确的烹饪网站数据库方案？

> ID：12642114
> 
> 赞同：0
> 
> 时间：2012-09-28T14:36:20.847
> 
> 标签：ruby-on-rails, ruby, database

我想做一个烹饪网站，但不知道正确的是建立数据库。

我的模型是：`Recipe`和`Ingredient`。

配方中的成分应该是自动完成字段。问题是用户可以在那里放置任何文本。（“黄瓜”或“黄瓜”），它将是不同的成分。

我想按成分和链接进行搜索。最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:50:53.987

一个食谱有很多项目，这些项目又保留了对成分、数量和度量类型的引用。所以你可以去：

```
rails generate model Recipe name:string description:text
rails generate model Item recipe:references ingredient:references amount:decimal measure:string 
rails generate model Ingredient name:string 
```

然后添加到您的课程中：

```
class Recipe < ActiveRecord::Base
  has_many :items
  has_many :ingredients, :through => :items

  # this allows things like @recipes = Recipe.using("cucumber")
  scope :using, lambda do |text| 
    joins(:ingredients).where("ingredients.name LIKE ?", "%#{text}%")
  end
end

class Item < ActiveRecord::Base
  belongs_to :recipe
  belongs_to :ingredient

  VALID_MEASURES = %w[oz kg tbsp] # use for "select" tags in forms
  validates :measure, :inclusion => VALID_MEASURES
end

class Ingredient < ActiveRecord::Base
  belongs_to :item
end 
```

从这里你开始构建你的视图，自动完成，无论你的想象力允许。

# actionscript-3 - Adobe AIR 和 PDF 框架

> ID：12642118
> 
> 赞同：0
> 
> 时间：2012-09-28T14:36:52.817
> 
> 标签：actionscript-3, pdf, air

有没有办法在 Adob​​e AIR 中处理 PDF？我不想只是打开它，我需要以编程方式使用它。示例：提取页面、旋转页面、将 gfx 元素添加到页面、阅读注释。我需要一个完整的框架来处理 AIR 中的 PDF。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:43:09.690

试试[PurePDF](http://blog.sephiroth.it/projects/purepdf/)，它是著名的[iText](http://itextpdf.com/) java 和 C# 库的一个端口

这是您在上面描述的 ActionScript 中能够做的最接近的事情。

干杯

# java - 从 wsdl 生成 java 类

> ID：12642119
> 
> 赞同：0
> 
> 时间：2012-09-28T14:36:54.933
> 
> 标签：java, soap, jaxb, wsdl, cxf

我有一个 wsdl，从中我使用 apache cxf 生成了服务器存根。问题是我部署的新 wsdl 与最初的不同，因此旧的肥皂请求不适用于新的。我使用soapUI对其进行测试。新的有这个奇怪的命名空间**init**：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
xmlns:init="http://initiator.clientprovisioning_1_0.mdm.smarttrust.com/">
   <soapenv:Header/>
   <soapenv:Body>
      <init:cpDiscovery.Response> 
```

旧肥皂消息没有这个：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
xmlns:xsd="http://www.w3.org/2001/XMLSchema"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <soapenv:Body>
      <cpDiscovery.Response> 
```

我会提供任何需要的额外信息。我已经尝试解决这个问题 2 天了。请帮忙。

**编辑** 这个**初始化**前缀取决于java包的第一个字母。例如，如果类在 me.mycompany.example 中，前缀是：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:exam="http://example.mycompany.net/">
   <soapenv:Header/>
   <soapenv:Body>
      <exam:cpDiscovery.Response> 
```

**编辑** [http://cxf.apache.org/docs/developing-a-service.html#DevelopingaService-AnnotatingtheCode](http://cxf.apache.org/docs/developing-a-service.html#DevelopingaService-AnnotatingtheCode) 这说明

> targetNamespace 属性 指定定义服务的目标命名空间。如果未指定此属性，则目标命名空间派生自包名称。

我该如何摆脱这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:03:35.193

您已经在描述 SOAP 负载的 XML 模式中引入了一个命名空间。这不应该影响客户端调用您的服务的能力，只要他们可以访问模式文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:47:43.160

“旧”肥皂消息实际上是无效的，并且可能永远不会起作用。根据soap 规范，soap:Body 的子项必须是命名空间限定的。看起来“新”行为是您想要的行为。

# vba - 在 MS Access 2007 中打印报告

> ID：12642123
> 
> 赞同：0
> 
> 时间：2012-09-28T14:37:08.740
> 
> 标签：vba, ms-access-2007

我对 Access 很陌生，在这里需要一些帮助。我正在使用 SQL 2008 Server 作为我的数据库来开发 MS Access 2007（在 VB 中）。

我正在打印已保存在 Button Click 事件中的报告。一切正常，可以打印报告，但在打印报告后，它也在打印包含该按钮的表单。这是我在 Button_click 上编写的代码：

```
DoCmd.OpenReport "ReportName"
DoCmd.PrintOut 
```

有什么建议么 ？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:40:14.043

[DoCmd.OpenReport 方法](http://msdn.microsoft.com/en-us/library/office/bb238032%28v=office.12%29.aspx)

> expression.OpenReport(ReportName, View, FilterName, WhereCondition, WindowMode, OpenArgs)

```
DoCmd.OpenReport, "report", acViewNormal 
```

您不需要 PrintOut。

# r - 后续：在保留格式的同时从R写入excel模板

> ID：12642125
> 
> 赞同：3
> 
> 时间：2012-09-28T14:37:25.477
> 
> 标签：r, excel, format, xlsx

这是两个相关的后续问题，用于[从 R 写入 excel 中的模板，同时保留](https://stackoverflow.com/questions/11228942/write-from-r-into-template-in-excel-while-preserving-formatting?answertab=active#tab-top) 我在新线程中编写的格式，因为我无法在另一个线程中评论答案。

1.  实际上，Joris Meys 的答案/代码（6 月 27 日）对我不起作用，我已经尝试了几次。

    再说一遍：目的是用 R 编写一个 excel 文件，同时使用模板文件中的格式或只是保留它。答案中提到了两种不同的工具：XLConnect 和 xlsx。

    Joris Meys 的回答基于 XLConnect。但是使用完全相同的代码，我的结果是填充了新内容的单元格变成了白色并且没有任何保留的格式。所有其他单元格（没有插入新内容）确实接管了以前的样式。

    我在 WinXP 中使用最新的 RGui（32 位）V. 2.15.1 以及最新版本的 XLConnect 和 xlsx（我还刚刚检查了 R 中的所有其他软件包都是最新的）。

2.  好的，与此相关的第二个问题：该线程提到 xlsx 作为替代方案。这个信息在我看来也是错误的。我检查了网站，开发人员似乎正在研究解决方案。目前我只在 xlsx 中看到了在代码中手动编写格式的可能性，例如：

    ```
    cs2 <- CellStyle(wb) +    
      Font(wb, name="Courier New", isBold=TRUE) +   # add a Font
      Borders(col="blue", position=c("TOP", "BOTTOM"), pen="BORDER_THICK") +  # add borders    
      Alignment(h="ALIGN_RIGHT") 
    ```

    （来源：[http](http://code.google.com/p/rexcel/wiki/LowLevelAPI) ://code.google.com/p/rexcel/wiki/LowLevelAPI ）

    如果有人可以提供一种编写 excel 文件的方法，同时使用 R 保留格式，那将是非常酷的。

编辑：这是代码（仅区别“Sheet1”而不是“aSheet”，但我也尝试了其他变体。

```
require(XLConnect)
wb <- loadWorkbook("test.xlsx", create=TRUE)
setStyleAction(wb,XLC$"STYLE_ACTION.NONE")

Data <- data.frame(
  a = 1:10,
  b = letters[1:10]
)

writeWorksheet(wb,Data,"Sheet1",startRow=1,startCol=1,header=TRUE)

saveWorkbook(wb) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-29T13:12:11.747

**问题一：**

格式化单元格的示例代码：

```
library('xlsx')

# create the workbook 
wb <- createWorkbook()
sheet <- createSheet(wb, sheetName="addDataFrame1")
data <- data.frame(mon=month.abb[1:10], day=1:10, year=2000:2009,
                   date=seq(as.Date("1999-01-01"), by="1 year", length.out=10),
                   bool=c(TRUE, FALSE), log=log(1:10),
                   rnorm=10000*rnorm(10),
                   datetime=seq(as.POSIXct("2011-11-06 00:00:00", tz="GMT"), by="1 hour",
                                length.out=10))
cs1 <- CellStyle(wb) + Font(wb, isItalic=TRUE) # rowcolumns
cs2 <- CellStyle(wb) + Font(wb, color="blue")
cs3 <- CellStyle(wb) + Font(wb, isBold=TRUE) + Border() # header
addDataFrame(data, sheet, startRow=3, startColumn=2, colnamesStyle=cs3,
             rownamesStyle=cs1, colStyle=list('2'=cs2, '3'=cs2))

# save the workbook ...
saveWorkbook(wb, "test.xlsx") 
```

查看输出文件。

**问题2：**

```
cs2 <- CellStyle(wb) +    
  Font(wb, name="Courier New", isBold=TRUE) +   # add a Font
  Borders(col="blue", position=c("TOP", "BOTTOM"), pen="BORDER_THICK") +  # add borders    
  Alignment(h="ALIGN_RIGHT") 
```

您只需将变量放入您在样式中使用的参数中。

# php - 成功插入 MySQL 表后更新页面

> ID：12642126
> 
> 赞同：0
> 
> 时间：2012-09-28T14:37:26.167
> 
> 标签：php, mysql, mysqli, updates

我正在制作一个包含一堆字段的页面，这些字段允许用户输入信息并将其提交到数据库。这个页面叫做'add.php' 我创建了一个'form'标签，并将信息发布到另一个名为'process.php'的页面，在那里收集信息，然后插入到数据库中。我想让用户知道它是否成功，所以我想知道如何在“add.php”页面上告诉用户一些特定的东西。比如“插入成功！” 在页面顶部。

我想在'add.php'中包含'process.php'代码，然后在表单的动作中调用'add.php'，但是第一次加载页面时会调用代码，这会插入一个完全数据库中的空白条目。

我是否应该实现某种仅在单击“提交”按钮后才设置为 true 的标志？还是有另一种方法来更新页面并告诉用户插入的状态？

我可以根据需要粘贴相关代码。:)

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:40:35.013

假设您`post`在表单和 php 中使用该方法，您可以简单地检查是否发布了帖子：

```
if ($_SERVER['REQUEST_METHOD'] === 'POST')
{
  // form was posted, process and display output
}
else
{
  // nothing was posted, normal get request, show form
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:00:01.103

只需检查查询是否运行良好。如果没有抛出异常，它主要有，并添加适当的输出消息。

首先你需要检查和处理错误

```
try
{

} 
catch(Exception $e){
header('Location:oldlocation.php?succ=0')
exit();
}
header('Location:oldlocation.php?succ=0')
exit(); 
```

如果一切顺利，您还可以重定向到新位置（如代码所示）。这必须正确完成，您可以重定向回旧位置，并提供其他数据，例如

```
oldlocation.php?succ=1; 
```

如果出现任何问题重定向到

```
oldlocation.php?succ=0 
```

然后使用 $_GET["succ"] 获取 succ 并打印适当的消息。

如果你得到，评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T17:22:04.083

这就是我要做的......将您的处理数据保存在一个文件中，并在最后包含表单文件

```
//add.php

//if the form is submitted make the database entry
if(isset($_POST['foo']) AND $_POST['foo'] != '')
{
//code to process form submission
$success = 'success!';

}
//include the form
include addform.php 
```

在 addform.php 中放置您的表单。包括一个正在监视 $success 以提醒条目成功的“isset”

```
//addform.php

<?php if(isset($success)){ echo "<h2> Data successfully entered! </h2>";} ?>

<form action='' method='POST'>
<input type='text' name='foo' />
//etc
</form> 
```

因此，一旦您提交表单，代码就会从 add.php 的顶部开始 - 'isset' 看到 $_POST 提交，运行表单提交代码并设置成功变量。然后，它包括表单页面。表单页面有一个“isset”，它正在监视成功变量。当您第一次导航到页面时，或者如果您刷新，add.php 代码将跳过第一个代码块（表单提交内容）并且不会进行数据库提交或设置成功变量。

# sitecore - Sitecore 6.6 和 RenderPartial

> ID：12642127
> 
> 赞同：1
> 
> 时间：2012-09-28T14:37:27.960
> 
> 标签：sitecore, renderpartial

Sitecore 似乎不喜欢使用 Html.RenderPartial。如果我尝试渲染部分视图而不是使用 Sitecore 占位符，我会得到错误：

c:\Sitecore\milwaukeetool\Website\Views\Products\Index.cshtml(13): 错误 CS1502: 'System.Web.WebPages.WebPageExecutingBase.Write(System.Web.WebPages.HelperResult)' 的最佳重载方法有一些无效的论点

有没有人在 Sitecore 6.6 中成功完成了 RenderPartial？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:42:57.630

需要在 RenderPartial 方法中完全限定部分视图的路径，因为如果没有完全限定，Sitecore 似乎会搜索 /Views/Sitecore。

# ruby - Ruby 数组数组和 map 方法

> ID：12642133
> 
> 赞同：2
> 
> 时间：2012-09-28T14:37:37.447
> 
> 标签：ruby, arrays, map

我从一个 CSV 文件开始，我将其读入 CSV::Table，104 列，并希望将其过滤为三个：

```
filtered_data = csv.map { |row| row.fields(:x,:y:,:z) } 
```

然后我想`x`从纪元时间转换为常规格林威治标准时间。我这样做是使用：

```
filtered_data.each do |thing|
  thing[0] = Time.at(thing[0]).to_datetime
end 
```

从而产生：

```
[[converted_x, y,z],[converted_x, y, z]] 
```

是否有另一种使用 map 函数的方法，或者这是首选的解决方案？

* * *

使用杰里米的回答我现在有：

```
filtered_data.map { |x,y,z| [Time.at(x).to_datetime,y,z] } 
```

然后使用拒绝进一步过滤：

```
filtered_data.reject { |x,y,z| [x,y, z == '\\ '] } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:40:47.667

```
filtered_data.map do |x, y, z|
  [Time.at(x).to_datetime, y, z]
end 
```

# asp.net - ASP.NET 静态类和 asp.net 会话

> ID：12642136
> 
> 赞同：12
> 
> 时间：2012-09-28T14:37:46.557
> 
> 标签：asp.net, static-methods, static-classes

是否有人愿意解释或指向解释静态类和方法的范围如何与 ASP.NET 用户会话的范围交互的文章。

这是解释我的问题的更具体的情况：

1.  用户 A 登录到一个 asp.net 网站。
2.  在做某事时，用户 A 使用一种静态方法来初始化一些数据。
3.  用户 B 登录到同一个 asp.net 网站。
4.  用户 B 使用相同的静态方法。

一旦用户 B 击中数据，数据是否已经初始化？

另外，如果用户 A 的 asp.net 会话在用户 B 访问网站之前过期怎么办？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T14:40:07.197

只要进程正在运行，静态数据就会存在。它附加到类型。

如果初始化的数据在静态上下文中，那么当用户 B 点击该方法时，它已经被初始化了。

会话在这里不相关 - 只有过程。

如果进程被回收，则必须重新初始化数据。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T14:53:24.770

检查这些帖子：[为什么我的 ASP.Net 静态函数的“上下文”在用户会话之间交叉？](https://stackoverflow.com/questions/1435068/why-does-my-asp-net-static-functions-context-crossover-between-user-sessions?rq=1)

[静态类的范围是什么？](https://stackoverflow.com/questions/284491/what-is-the-scope-of-a-static-class)

[C# 静态变量 - 范围和持久性](https://stackoverflow.com/questions/5986051/c-sharp-static-variables-scope-and-persistence)

[http://msdn.microsoft.com/en-us/library/ms173138(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms173138(v=vs.100).aspx)

**简而言之：**

一旦用户 B 击中数据，数据是否已经初始化？

是的

另外，如果用户 A 的 asp.net 会话在用户 B 访问网站之前过期怎么办？

用户 B 将访问用户 A 初始化的数据

> 静态数据在 webapp 的整个应用程序域之间共享。它在您的 web 应用程序中服务请求的所有线程之间共享，它不以任何方式绑定到会话/线程/用户，而是绑定到整个 web 应用程序。

# c# - MVC - 使用 C# 用 Json 操作结果填充 ViewBag

> ID：12642143
> 
> 赞同：7
> 
> 时间：2012-09-28T14:38:08.927
> 
> 标签：c#, asp.net-mvc, viewbag, actionresult

我有一个 MVC 网站，后面有 C# 代码。我正在使用一个 ActionResult，它返回 Json。

我试图在 ViewBag 中放一些东西，但它似乎不起作用。

代码如下所示 -

```
 public ActionResult GetStuff(string id)
    {
        ViewBag.Id = id;

        stuff = new StuffFromDatabase(id);

        return this.Json(stuff , JsonRequestBehavior.AllowGet);
    } 
```

“id”没有出现在 ViewBag.Id 中。

我可以这样把 id 放在 ViewBag 中吗？如果没有关于我应该如何做的任何建议？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:53:38.770

另一种解决方案可以是：如果您想在返回 json 结果的发布操作后访问“id”属性，您可以返回一个包含所有所需数据的复杂对象：

```
public ActionResult GetStuff(string id)  
{  
    ViewBag.Id = id;  

    stuff = new StuffFromDatabase(id);  

    return this.Json(new { stuff = stuff, id = id } , JsonRequestBehavior.AllowGet);  
} 
```

之后，在 json 返回值中，您可以访问所有属性，如下例所示：

```
$.post(action, function(returnedJson) {
   var id = returnedJson.id;
   var stuff = returnedJson.stuff;
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T14:52:28.947

ViewBag 仅在服务器端可用。您正在将 json 字符串发送回浏览器，大概浏览器随后会对其进行处理。您必须在 json 响应中发送 id，如下所示：

```
return this.Json(new { Id = id, Data = stuff }, JsonRequestBehaviour.AllowGet); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:51:17.447

你试图`ViewBag.Id`在 Json 结果中设置？`ViewBag`在视图中使用，而不是在`Json`.

**添加**

正如我从评论中看到的那样，然后您尝试在 javascript 中使用它，您可以做这样的事情。尝试这个：

```
return this.Json(new {stuff, id} , JsonRequestBehavior.AllowGet); 
```

然后您可以在 javascript 中访问这些数据。

# c# - LINQ to Entities 无法识别该方法，并且该方法无法转换为存储表达式

> ID：12642150
> 
> 赞同：6
> 
> 时间：2012-09-28T14:38:41.547
> 
> 标签：c#, .net, wpf, entity-framework, linq-to-sql

```
var ps = dbContext.SplLedgers.Select(p => new SplLedgerModel
            {
                Name = p.Name,
                VoucherType = Convert.ToString(((JIMS.VoucherTypes)p.VoucherType))
        }); 
```

我收到以下异常，代码有什么问题。

JIMS.VoucherType 是一个枚举

```
+       $exception  {"LINQ to Entities does not recognize the method 'System.String ToString(System.Object)' method, and this method cannot be translated into a store expression."}    System.Exception {System.NotSupportedException} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T14:44:34.353

您的代码基本上是试图在数据库中找到 Convert.ToString() 方法并且可以理解地失败。

您可以绕过它，例如通过确保查询在选择之前执行，例如

```
var ps = dbContext.SplLedgers.Select(p => new  
    { 
         Name = p.Name, 
         VoucherType = p.VoucherType
    }).ToList().Select(p => new SplLedgerModel( 
    { 
         Name = p.Name, 
         VoucherType = Convert.ToString(((JIMS.VoucherTypes)p.VoucherType)) 
    }); 
```

# java - 用 JMS 模拟串行总线？

> ID：12642151
> 
> 赞同：4
> 
> 时间：2012-09-28T14:38:54.060
> 
> 标签：java, testing, serial-port, messagebroker

我目前正在从事仪表总线项目，我的测试环境包括[com0com](http://com0com.sourceforge.net/)、 hub4com 、[rxtx](http://rxtx.qbang.org/wiki/index.php/Main_Page)以及混合的真实和虚拟设备。
因为我已经收集了足够的数据，所以我想摆脱串行的东西，转而使用纯虚拟 tcp/ip 测试环境。

到目前为止，我已经编写了一个自己的小型代理，它适用于小型/小型设置，但我计划进行全面测试，我不想重新发明轮子。我想在这里使用 JMS，但在过去的 4 年里我没有做太多的 Java 工作，所以我不知道选择哪个提供程序，或者 JMS 是否是这里的正确选择。

我想出了一些模拟 9600 波特的数字（可能不准确）：

```
Devices : 100-250
Messages: 17000+ per sec
MsgSize : max. 300 byte , avg. about 40 byte
Rtt: max. 30 msec 
```

大多数提供商都可以处理这些消息，但我不知道时间限制。我希望有人能给我一些参考信息。还请考虑到我可以降低波特率，这会增加 rtt 并降低 msg 计数。
在我的情况下，不满足 rtt 约束会模仿错误的接线:)

我愿意接受任何建议，可能是设计/实施提示或指出适合此目的的现有项目/软件。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-05T22:38:59.033

作为提供者，您可以使用 ActiveMQ：[http ://activemq.apache.org](http://activemq.apache.org)

# c# - 我应该使用什么来识别等宽数字？

> ID：12642152
> 
> 赞同：0
> 
> 时间：2012-09-28T14:38:54.437
> 
> 标签：c#, opencv, machine-learning, computer-vision, aforge

我必须从视频流中识别图像中的数字，还有更多的东西应该使识别更容易：
1）它是固定字体 6x8，所有符号的宽度都相等
2）我知道数字的确切位置，它们总是矩形, 未旋转/倾斜/缩放，但由于空气传输故障，可能会出现一些失真。
3) 只有数字和 。
4) 数字背景为半黑色（50% 不透明）

我尝试过 tesseract v2 和 v3，但 .NET 包装器并不完美，识别错误非常大，即使我使用自定义字体进行了训练，据我所知，这是因为分辨率小。

我自己制作了非常简单的算法，将图像转换为黑白并计算原始字体图像和流中图像之间的匹配像素，它比 tesseract 表现更好，但我认为更复杂的算法会做得更好。

我尝试使用带有 BackPropagationLearning 的 ActivationNetwork 训练 AForge，但它无法收敛（本文第一部分，只要我不需要缩放和几种字体[http://www.codeproject.com/Articles/11285/Neural- Network-OCR](http://www.codeproject.com/Articles/11285/Neural-Network-OCR)，据我了解，文章中的代码适用于旧版本的 AForge），不好的是，这个项目不再受支持，论坛已关闭，据我所知，谷歌群组也已关闭。

我知道 .NET 有 OpenCV 端口，据我所知，它具有与 AForge 不同的网络方法，所以问题是哪种方法最适合。

那么在这方面是否有任何 .NET 框架可以帮助我，如果它支持多个神经网络实现，那么哪种实现最适合？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:54:20.213

对于固定放大倍率的固定大小字体，您可能可以使用基于模板匹配的不太复杂的 OCR 方法。有关如何使用 OpenCV（不是 .NET，但希望足以让您入门）的示例，请参见[此处](http://docs.opencv.org/2.4.2/doc/tutorials/imgproc/histograms/template_matching/template_matching.html)。基本思想是为每个数字创建一个模板，然后尝试在目标位置匹配所有模板，选择匹配分数最高的那个。因为您知道数字的位置，所以您可以在非常小的区域内搜索每个数字。有关模板匹配背后理论的更多信息，请参阅[这篇](http://en.wikipedia.org/wiki/Cross-correlation)关于互相关的 wiki 文章。

这实际上是简化 OCR 应用程序的基础（通常用于识别特殊的 OCR 字体，例如用于在硅片上打印序列号的 SEMI 标准字体。）生产级算法还可以支持缩放、旋转和平移的容差，但是底层技术几乎相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:43:17.410

试着看看[这个项目](http://www.codeproject.com/Articles/3907/Creating-Optical-Character-Recognition-OCR-applica)和[这个项目](http://www.codeproject.com/Articles/11285/Neural-Network-OCR)。这两个项目都解释了 OCR 的工作原理，并向您展示了如何在 C# 和 .NET 中实现它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-18T17:29:06.910

如果您不是很着急，我建议您首先寻找解决问题的方法。我在[WEKA](http://www.cs.waikato.ac.nz/ml/weka/)方面取得了很好的经验。使用 WEKA，您可以非常快速地测试一堆算法。一旦找到解决问题的算法，您就可以将其移植到 .NET、构建包装器、寻找实现或（如果它是一个简单的算法）在 .NET 中重建它。

# javascript - 禁用数据表中“禁用”分页的点击事件？

> ID：12642154
> 
> 赞同：0
> 
> 时间：2012-09-28T14:39:18.020
> 
> 标签：javascript, jquery, datatables, jquery-events

我正在尝试禁用数据表中“禁用”分页按钮上的点击事件。

我一直在尝试使用此代码

```
$('.dataTables_paginate span.ui-state-disabled').click(function(){return false;}); 
```

但这仅适用于文字导航（即下一个、上一个、第一个、最后一个）而不是编号。我尝试了十几种不同的方式来定位它，但无济于事。数据表 API 中是否有我遗漏的东西，或者有没有人知道如何禁用它？disable 类通过数据表动态应用。

如果你有时间，请帮忙——这让我发疯了！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-22T06:07:42.993

参与为时已晚，但对于其他人，我仅使用 CSS 解决了这个问题

```
a.paginate_button.current {
    pointer-events: none;
} 
```

希望能帮助到你

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:45:52.760

Try adding `e.preventDefault();` to your click function.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:45:02.287

问题是数据表 api 可能有一个分页按钮的单击侦听器，它们将在您的脚本之前执行。

但是：如果您打算停止单击的默认事件，请尝试：

```
$('.dataTables_paginate span.ui-state-disabled').click(function(e){
     e.preventDefault();
}); 
```

# excel - 检查VBA中的列中是否存在值

> ID：12642164
> 
> 赞同：41
> 
> 时间：2012-09-28T14:40:30.377
> 
> 标签：excel, vba, matching

我有一列超过 500 行的数字。我需要使用 VBA 来检查变量 X 是否与列中的任何值匹配。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-09-28T15:37:49.933

范围的查找方法比使用 for 循环手动遍历所有单元格要快。

这是在 vba 中使用 find 方法的示例

```
Sub Find_First()
Dim FindString As String
Dim Rng As Range
FindString = InputBox("Enter a Search value")
If Trim(FindString) <> "" Then
    With Sheets("Sheet1").Range("A:A") 'searches all of column A
        Set Rng = .Find(What:=FindString, _
                        After:=.Cells(.Cells.Count), _
                        LookIn:=xlValues, _
                        LookAt:=xlWhole, _
                        SearchOrder:=xlByRows, _
                        SearchDirection:=xlNext, _
                        MatchCase:=False)
        If Not Rng Is Nothing Then
            Application.Goto Rng, True 'value found
        Else
            MsgBox "Nothing found" 'value not found
        End If
    End With
End If
End Sub 
```

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2012-09-28T23:25:11.843

最简单的就是使用`Match`

```
If Not IsError(Application.Match(ValueToSearchFor, RangeToSearchIn, 0)) Then
    ' String is in range 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2012-09-28T14:52:54.703

如果您想在*没有*VBA 的情况下执行此操作，您可以使用`IF`、`ISERROR`和`MATCH`.

因此，如果所有值都在 A 列中，请在 B 列中输入此公式：

```
=IF(ISERROR(MATCH(12345,A:A,0)),"Not Found","Value found on row " & MATCH(12345,A:A,0)) 
```

这将查找值“12345”（也可以是单元格引用）。如果未找到该值，则`MATCH`返回“#N/A”并`ISERROR`尝试捕捉它。

如果要使用 VBA，最快的方法是使用 FOR 循环：

```
Sub FindMatchingValue()
    Dim i as Integer, intValueToFind as integer
    intValueToFind = 12345
    For i = 1 to 500    ' Revise the 500 to include all of your values
        If Cells(i,1).Value = intValueToFind then 
            MsgBox("Found value on row " & i)
            Exit Sub
        End If
    Next i

    ' This MsgBox will only show if the loop completes with no success
    MsgBox("Value not found in the range!")  
End Sub 
```

您可以在 VBA 中使用工作表函数，但它们很挑剔，有时会引发无意义的错误。`FOR`循环非常简单。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-02-18T11:18:16.713

试试这个：

```
If Application.WorksheetFunction.CountIf(RangeToSearchIn, ValueToSearchFor) = 0 Then
Debug.Print "none"
End If 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-11-18T17:00:51.010

只是为了修改斯科特的答案以使其成为一个函数：

```
Function FindFirstInRange(FindString As String, RngIn As Range, Optional UseCase As Boolean = True, Optional UseWhole As Boolean = True) As Variant

    Dim LookAtWhat As Integer

    If UseWhole Then LookAtWhat = xlWhole Else LookAtWhat = xlPart

    With RngIn
        Set FindFirstInRange = .Find(What:=FindString, _
                                     After:=.Cells(.Cells.Count), _
                                     LookIn:=xlValues, _
                                     LookAt:=LookAtWhat, _
                                     SearchOrder:=xlByRows, _
                                     SearchDirection:=xlNext, _
                                     MatchCase:=UseCase)

        If FindFirstInRange Is Nothing Then FindFirstInRange = False

    End With

End Function 
```

如果未找到该值，则返回 FALSE，如果找到，则返回范围。

您可以选择告诉它区分大小写和/或允许部分单词匹配。

我拿出了 TRIM，因为如果你愿意，你可以事先添加它。

一个例子：

```
MsgBox FindFirstInRange(StringToFind, Range("2:2"), TRUE, FALSE).Address 
```

这会在第二行进行区分大小写的部分单词搜索，并显示一个带有地址的框。以下是相同的搜索，但不区分大小写的全词搜索：

```
MsgBox FindFirstInRange(StringToFind, Range("2:2")).Address 
```

您可以根据自己的喜好轻松调整此功能，或将其从 Variant 更改为布尔值或其他任何值，以加快速度。

请注意，VBA 的 Find 有时比暴力循环或 Match 等其他方法慢，所以不要仅仅因为它是 VBA 的原生方法就认为它是最快的。它更加复杂和灵活，这也可能使其并不总是那么高效。它有一些有趣的怪癖需要注意，比如“Object variable or with block variable not set”[错误](https://stackoverflow.com/questions/22735093/vba-for-excel-throws-object-variable-or-with-block-variable-not-set-when-there)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-05-27T14:11:05.117

修复了@JeffC 在来自@sdanse 的函数中提到的问题：

```
Function FindFirstInRange(FindString As String, RngIn As Range, Optional UseCase As Boolean = True, Optional UseWhole As Boolean = True) As Variant

    Dim LookAtWhat As Integer

    If UseWhole Then LookAtWhat = xlWhole Else LookAtWhat = xlPart

    With RngIn
        Set FindFirstInRange = .Find(What:=FindString, _
                                     After:=.Cells(.Cells.Count), _
                                     LookIn:=xlValues, _
                                     LookAt:=LookAtWhat, _
                                     SearchOrder:=xlByRows, _
                                     SearchDirection:=xlNext, _
                                     MatchCase:=UseCase)

        If FindFirstInRange Is Nothing Then
            FindFirstInRange = False
            Exit Function
        End If

        If IsEmpty(FindFirstInRange) Then
            FindFirstInRange = False
        Else
            FindFirstInRange = True
        End If

    End With

End Function 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2018-05-02T22:19:37.253

尝试添加 WorksheetFunction：

```
If Not IsError(Application.WorksheetFunction.Match(ValueToSearchFor, RangeToSearchIn, 0)) Then
' String is in range 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-09-27T06:41:20.120

```
=IF(COUNTIF($C$2:$C$500,A2)>0,"Exist","Not Exists") 
```

# xslt - 如何获取字符串中char的最后一个索引？

> ID：12642166
> 
> 赞同：3
> 
> 时间：2012-09-28T14:40:39.960
> 
> 标签：xslt, xslt-1.0, indexof

我有以下任务：
有一个包含长字符串的 xml 元素。我需要使用 xsl 将此元素转换为多个 html`<input>`标签。它的工作原理是这样的：如果字符串的长度超过了一个`<input>`字段在不滚动的情况下可以容纳的长度，我会递归地调用相同的模板来创建另一个带有剩余文本的输入字段。

问题是字符串经常在单词的中间被分割，这不是很好。

所以我需要找到最后一个`space`字符的位置，它不大于适合`<input>`标签的子字符串的大小，并且只打印它之前的子字符串。

所以我准备了一个最大长度的子字符串，它可以适合该字段，但我不知道如何获取其中最后一个的索引`space`并将其作为参数传递给函数的下一次调用。

**UPD：**这是我到目前为止所得到的

```
<xsl:template name="multilineInput">
    <xsl:param name="input" select="."/>
    <xsl:param name="maxFirst" select="."/>
    <xsl:param name="firstLineWidth" select="."/>

    <input>
        <xsl:attribute name="readonly">readonly</xsl:attribute>
        <xsl:attribute name="class">input_multiline</xsl:attribute>
        <xsl:attribute name="style">width = "<xsl:value-of select="$firstLineWidth"/>"</xsl:attribute>
        <xsl:attribute name="type">text</xsl:attribute>
        <xsl:attribute name="value"><xsl:value-of select="substring($input, 1, $maxFirst)"/></xsl:attribute>
    </input>

    <xsl:if test="$maxFirst &lt; string-length($input)">
        <xsl:call-template name="multilineInput">
            <xsl:with-param name="input" select="substring($input, $maxFirst+1, string-length($input)-$maxFirst)"/>
            <xsl:with-param name="maxFirst" select="110"/>
            <xsl:with-param name="firstLineWidth" select="'980'"/>
        </xsl:call-template>
    </xsl:if>

</xsl:template> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T02:11:10.673

以下递归模板可用于返回给定分隔符的最后索引：

```
<xsl:template name="last-index-of">
    <xsl:param name="txt"/>
    <xsl:param name="remainder" select="$txt"/>
    <xsl:param name="delimiter" select="' '"/>

    <xsl:choose>
        <xsl:when test="contains($remainder, $delimiter)">
            <xsl:call-template name="last-index-of">
                <xsl:with-param name="txt" select="$txt"/>
                <xsl:with-param name="remainder" select="substring-after($remainder, $delimiter)"/>
                <xsl:with-param name="delimiter" select="$delimiter"/>
            </xsl:call-template>      
        </xsl:when>
        <xsl:otherwise>
            <xsl:variable name="lastIndex" select="string-length(substring($txt, 1, string-length($txt)-string-length($remainder)))+1"/>
            <xsl:choose>
                <xsl:when test="string-length($remainder)=0">
                    <xsl:value-of select="string-length($txt)"/>
                </xsl:when>
                <xsl:when test="$lastIndex>0">
                    <xsl:value-of select="($lastIndex - string-length($delimiter))"/>
                </xsl:when>
                <xsl:otherwise>
                    <xsl:value-of select="0"/>
                </xsl:otherwise>
            </xsl:choose>
        </xsl:otherwise>
    </xsl:choose>
</xsl:template> 
```

可以像这样调用它：

```
<xsl:call-template name="last-index-of">
    <xsl:with-param name="txt" select="'The quick brown fox jumped over the lazy dog.'"/>
    <xsl:with-param name="delimiter" select="' '"></xsl:with-param>
 </xsl:call-template> 
```

并返回：`41`

您可以将模板调用的结果分配给如下变量：

```
<xsl:variable name="last-index">
    <xsl:call-template name="last-index-of">
        <xsl:with-param name="txt" select="'The quick brown fox jumped over the lazy dog.'"/>
        <xsl:with-param name="delimiter" select="' '"></xsl:with-param>
     </xsl:call-template>
</xsl:variable> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T05:19:22.167

**这种转换实现了一个简单而有效的算法：字符串中的最后一个空格是反转字符串中的第一个空格**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="text"/>

 <xsl:template match="/">
     <xsl:call-template name="lastCharIndex">
       <xsl:with-param name="pText" select=
         "'The quick brown fox jumped over the lazy dog.'"/>
     </xsl:call-template>
 </xsl:template>

 <xsl:template name="lastCharIndex">
  <xsl:param name="pText"/>
  <xsl:param name="pChar" select="' '"/>

  <xsl:variable name="vRev">
    <xsl:call-template name="reverse">
     <xsl:with-param name="pStr" select="$pText"/>
    </xsl:call-template>
  </xsl:variable>

  <xsl:value-of select=
  "string-length($pText) - string-length(substring-before($vRev, $pChar))"/>
 </xsl:template>

 <xsl:template name="reverse">
  <xsl:param name="pStr"/>

  <xsl:variable name="vLength" select="string-length($pStr)"/>
  <xsl:choose>
    <xsl:when test="$vLength = 1"><xsl:value-of select="$pStr"/></xsl:when>
    <xsl:otherwise>
      <xsl:variable name="vHalfLength" select="floor($vLength div 2)"/>
      <xsl:variable name="vrevHalf1">
        <xsl:call-template name="reverse">
         <xsl:with-param name="pStr" 
              select="substring($pStr, 1, $vHalfLength)"/>
        </xsl:call-template>
      </xsl:variable>
      <xsl:variable name="vrevHalf2">
        <xsl:call-template name="reverse">
         <xsl:with-param name="pStr" 
              select="substring($pStr, $vHalfLength+1)"/>
        </xsl:call-template>
      </xsl:variable>

      <xsl:value-of select="concat($vrevHalf2, $vrevHalf1)"/>
    </xsl:otherwise>
  </xsl:choose>
 </xsl:template>
</xsl:stylesheet> 
```

**当将此转换应用于任何 XML 文档（未使用）时，将产生所需的正确结果**：

```
41 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:05:17.527

您可以使用 EXSLT`split`模板（[描述](http://www.exslt.org/str/functions/split/index.html)；[实现](http://www.exslt.org/str/functions/split/str.split.template.xsl)）或`tokenize`用空格分割字符串。然后您可以打印除最后一个以外的所有文本节点，和/或使用最后一个文本节点的长度来获取最后一个空格的索引。

另请参阅[此模板](http://www.stylusstudio.com/xsllist/199905/post60130.html)，您可以根据自己的需要进行调整。

# opengl - VAO 如何保持缓冲区绑定？

> ID：12642167
> 
> 赞同：11
> 
> 时间：2012-09-28T14:40:39.610
> 
> 标签：opengl, vertex-buffer

我很难理解 VAO 究竟是如何处理缓冲区映射的。我正在做的事情可以用这个伪代码来描述：

```
SetUp:
  BindVAO
  BindArrayBuffer
  glBufferData(GL_ARRAY_BUFFER, ExpectedMaxCount, NULL, GL_DYNAMIC_DRAW);//Allocate storage
  glEnableVertexAttribArray
  glVertexAttribPointer

  BindElementBuffer
  Allocate storage (no data yet)

  UnbindVAO
  UnbindArrayBuffer
  UnbindElementBuffer

Draw:
  SubArrayAndElementDataIfNeeded
  BindVAO
  DrawElements 
```

1.  当调用 DrawElements 时，OpenGL 使用绑定的 VAO 来解析数组和元素缓冲区绑定是否正确？在 Draw 调用之后，绑定的数组缓冲区为 0，但元素缓冲区仍然是用于 Draw 的缓冲区。

2.  在 VAO 设置期间是否必须分配缓冲内存？如果在设置后调用 BufferData，VAO 会失效吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-28T14:58:54.927

> 我很难理解 VAO 究竟是如何处理缓冲区映射的。

在“缓冲区”周围使用“映射”一词时要非常小心；[在处理缓冲区对象时](http://www.opengl.org/wiki/Buffer_Object#Mapping)具有特定含义，您可能不打算这样做。

> 当调用 DrawElements 时，OpenGL 使用绑定的 VAO 来解析数组和元素缓冲区绑定是否正确？在 Draw 调用之后，绑定的数组缓冲区为 0，但元素缓冲区仍然是用于 Draw 的缓冲区。

一个与另一个无关。顾名思义，顶点数组对象包含从[数组](http://www.opengl.org/wiki/Vertex_Specification#Vertex_Array_Object)中提取顶点数据所需的*所有状态。*当你绑定一个时，所有的状态都会回到上下文中。

调用后“绑定数组缓冲区”为 0 的原因是因为调用*前*为 0 。绘图调用不会改变 OpenGL 状态。

此外，你似乎中了`GL_ARRAY_BUFFER`陷阱。`GL_ARRAY_BUFFER`绑定只与三个函数有关：、[`glVertexAttribPointer`和`glVertexAttribIPointer`（`glVertexAttribLPointer`](http://www.opengl.org/wiki/GLAPI/glVertexAttribPointer)看到一个模式？）。这些是查看该绑定的*唯一函数。*他们所做的是获取在*调用这些函数时*绑定的缓冲区，并将该缓冲区与当前 VAO 相关联。`GL_ARRAY_BUFFER`不是VAO 状态*的*一部分。*只有*当您调用这三个函数之一时，缓冲区对象才会与 VAO 关联。一旦你打了那个电话，你就可以绑定任何你想要的东西`GL_ARRAY_BUFFER`。

`GL_ELEMENT_ARRAY_BUFFER` ***是***VAO 状态的一部分。

> 在 VAO 设置期间是否必须分配缓冲内存？如果在设置后调用 BufferData，VAO 会失效吗？

从技术上讲不是，但是在缓冲区有存储之前不使用它是一种很好的形式。特别是如果它们是静态缓冲区。

# wix - TFS 2010 构建服务器 Wix。仅输出 MSI

> ID：12642170
> 
> 赞同：2
> 
> 时间：2012-09-28T14:40:50.067
> 
> 标签：wix, tfsbuild

我已经设法让构建在我的构建服务器上运行，但现在我遇到的问题是输出文件夹中的输出包含来自所有项目的所有输出，而不仅仅是来自 wix 项目的输出。

知道如何改变这个吗？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:04:20.810

如果您只对将 msi 作为构建输出感兴趣，那么您可以在团队构建中创建一个步骤，将安装程序文件复制到另一个位置，添加到构建项目中的以下构建目标应该会有所帮助。

这将覆盖目标[AfterDropBuild](http://msdn.microsoft.com/en-us/library/aa337604%28v=vs.80%29.aspx)

```
 <Target Name="AfterDropBuild">

    <PropertyGroup>
      <InstallerDir>$(DropLocation)\$(BuildNumber)\Installers</InstallerDir>
    </PropertyGroup>

    <Message Importance="low" Text="InstallerDir=$(InstallerDir)" />
    <MakeDir Directories="$(InstallerDir)" Condition="!Exists('$(InstallerDir)')" />

    <CreateItem Include="$(BinariesRoot)\**\*.msi">
      <Output TaskParameter="Include" ItemName="InstallationFiles"/>
    </CreateItem>

    <Copy SourceFiles="@(InstallationFiles)"
      DestinationFolder="$(InstallerDir)"/>

  </Target> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:10:22.673

我创建了不同的解决方案平台 { Application, Setup } 并将我的 .NET 项目设置为使用应用程序构建，我的 wix 设置为使用设置构建。然后我告诉构建定义以该顺序构建这两个平台。结果是 TFS 将 .NET 代码存档在一个看起来像已部署计算机的应用程序文件夹中，并将 MSI 存档在 setup 文件夹中。

唯一的缺点是当您添加新项目时，您必须选择要在配置管理器中构建的平台。不过，我的开发人员似乎对此并不恼火。

# c++ - 如何使这个演员隐含？

> ID：12642171
> 
> 赞同：2
> 
> 时间：2012-09-28T14:40:54.167
> 
> 标签：c++

我有

```
 class Wrapper : Base
{
Wrapper(WrappedObject& obj)
//...
};

void fun(Base& b); 
```

我希望能够直接`fun`用`WrappedObject`实例调用，这样的隐式转换可能吗？如何？

编辑： http: [//ideone.com/ilfE8](http://ideone.com/ilfE8)我仍然无法让这个例子工作，我需要改变什么？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T14:41:21.877

公开继承：

```
class Wrapper : public Base 
```

事实上，这不是一种`is-a`关系。`private`继承（这是类的默认设置）表示一种`has-a`关系。

```
class Wrapper : Base 
```

相当于

```
class Wrapper : private Base 
```

编辑：根据评论，引用必须是 const 因为将创建一个临时的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T14:49:47.020

`fun`如果确实需要通过非常量引用获取其参数，则无法一步完成。原因是为了调用，您需要从 a`fun`创建一个临时对象，但是这个临时对象不能绑定到非常量引用。`Wrapper``WrappedObject`

如果`fun`可以将其参数作为 const 引用，那么您只需将继承更改`public`为其他答案中所见，并 make`fun`的参数为 const。然后你可以完全按照你的要求去做。

如果`fun`必须通过非常量引用获取其参数，*则必须*创建一个命名的临时对象以传递给它：

```
Wrapper wrap(wrapped_obj);
fun(wrap); 
```

最后请注意，虽然隐式构造函数很方便，但它们通常会抑制代码理解并导致难以发现的错误。请记住，您只编写一次代码，并且明确说明转换（而不是隐式转换构造函数）将导致更易于阅读的代码并使错误更加明显。

编辑：经过进一步检查，我不相信您的原始目标可以在 C++ 中实现。（不）幸运的是，由于规则，它不能使用多个隐式步骤（构造 temp `Wrapper`，隐式转换为`Base`）来调用函数。你必须帮助它。

可能最简单的方法是重载，而替代方法是在对其自身的调用中`fun(const Wrapper& w) { fun(static_cast<const Base&>(w)); }`显式创建一个临时对象，这确实具有对未来读者更加明确的优势。`Wrapper``fun`

# forms - 如何在 Spring Roo 中创建自定义表单和控制器？

> ID：12642172
> 
> 赞同：2
> 
> 时间：2012-09-28T14:41:09.610
> 
> 标签：forms, spring, controller, annotations, spring-roo

我整天都在研究这个问题，我不能说我已经完全理解如何去做了。

到目前为止，我已经创建了一个 Spring Roo 项目以及一堆实体。我想要做的是允许用户通过表单从数据库中检索数据。这意味着我将需要一个用于用户输入的表单以及一个控制器，该控制器将在用户单击“提交”按钮并从数据库中获取信息后处理请求。

到目前为止我在互联网上看到的例子并没有真正帮助。如果有人能解释我如何完成这项任务，我将不胜感激。谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:03:43.787

```
roo>help
roo>web mvc setup
roo>web mvc all --package ~.web 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T18:59:38.767

我有同样的经历，结果发现我已经开始学习 Roo 并试图让它满足我所有的自定义需求，甚至没有完全理解 Spring Web MVC。

我的建议是阅读 Spring web mvc 文档和教程，从头开始创建一个小型 mvc 应用程序，然后再回到 Roo。Roo 很棒，但您需要为所有自定义编写自己的代码。因此，您需要做的就是编写自己的控制器并查看特定要求。

顺便说一句，您是否看到任何可用的查找器是否涵盖了您的要求（从数据库中获取信息）？如果是，您只需使用 Roo 推入正确的查找器，它应该可供所有用户使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T16:38:19.030

一旦 Roo 建立了脚手架，您就可以简单地添加一个新的控制器类，就像 roo 生成的控制器类一样，并对其进行编码以执行您想要的任何操作。Roo 将不理会您的自定义控制器和 jsp 文件。

您可以根据[http://viralpatel.net/blogs/spring-3-mvc-handling-forms/ 之](http://viralpatel.net/blogs/spring-3-mvc-handling-forms/)类的教程创建表单 ，然后在域对象上调用 roo 生成的查找器方法。 [Spring/roo 自定义查找器](https://stackoverflow.com/questions/7838420/spring-roo-custom-finder)可能对此有所帮助。

Roo 不会在finder 方法前面生成表单。

我相信有效地使用 roo 需要对 spring 有扎实的理解。我会学习 Spring 3 mvc 教程（如果您还没有的话）并查看 roo 生成的文件并查找它生成的任何您不理解的内容。

# mysql - 使用 MySql Workbench 时不断出现语法错误

> ID：12642173
> 
> 赞同：0
> 
> 时间：2012-09-28T14:41:10.483
> 
> 标签：mysql, sql, mysql-workbench

我试图在不使用过程或函数的情况下在 MySQL 中运行以下代码。我不断收到语法错误。有没有人看到这段代码有什么问题。我是否能够在不使用过程或函数的情况下运行此代码。

```
DECLARE @Machine varchar(30);
 SET @Machine = @MachineType;

 IF @Machine = 'server' 
THEN SELECT COUNT(*) AS 'Total Servers'
 FROM agentcomputers AS A
 WHERE A.groupid IN('521','637');

 ELSEIF @Machine = 'bdr server'
 THEN SELECT COUNT(*) AS 'Total BDR Servers'
 FROM agentcomputers AS A
 WHERE A.groupid =521;

 ELSEIF @Machine = 'non-bdr server'
 THEN SELECT COUNT(*) AS 'Total Non-BDR Servers'
 FROM agentcomputers AS A
 WHERE A.groupid =637;

ELSEIF @Machine = 'workstation'
 THEN SELECT COUNT(*) AS 'Total Workstations'
 FROM agentcomputers AS A
 WHERE A.groupid =638;

 ELSEIF @Machine = 'laptop'
 THEN SELECT COUNT(*) AS 'Total Laptops'
 FROM agentcomputers AS A
 WHERE A.groupid =650;

 ELSEIF @Machine = 'monitored computer'
 THEN SELECT COUNT(*) AS 'Total Monitored Computers'
 FROM agentcomputers AS A
 WHERE A.groupid =1;

 ELSEIF @Machine = 'new computer'
 THEN SELECT COUNT(*) AS 'Total New Computers'
 FROM agentcomputers AS A
 WHERE A.groupid =648;

ELSEIF @Machine = 'managed service'
 THEN SELECT COUNT(*) AS 'Total Managed Services'
 FROM agentcomputers AS A
 WHERE A.groupid =522;

 ELSEIF @Machine = 'allmachines'
 THEN SELECT COUNT(*) AS 'Total Machines'
 FROM agentcomputers AS A
 WHERE A.groupid IN('1','521','522','637','638','648','650');

 /*
 THESE IF STATEMENTS RETURN THE COUNTS FOR THE MOBIL DEVICES
 */

 ELSEIF @Machine = 'phone'
 THEN SELECT COUNT(*) AS 'Total Mobil Phones'
 FROM mobiledevices AS M
 INNER JOIN mobilemastergroups AS MM
 ON MM.groupID = M.deviceType 
WHERE M.deviceType=2;

 ELSEIF @Machine = 'tablet'
 THEN SELECT COUNT(*) AS 'Total Mobil Tablets'
 FROM mobiledevices AS M
 INNER JOIN mobilemastergroups AS MM
 ON MM.groupID = M.deviceType 
WHERE M.deviceType=3;

 ELSEIF @Machine = 'ios'
 THEN SELECT COUNT(*) AS 'Total Mobil iOS Devices'
 FROM mobiledevices AS M
 INNER JOIN mobilemastergroups AS MM
 ON MM.groupID = M.deviceType 
WHERE M.deviceType=4;

 ELSEIF @Machine = 'android'
 THEN SELECT COUNT(*) AS 'Total Mobil Android Devices'
 FROM mobiledevices AS M
 INNER JOIN mobilemastergroups AS MM
 ON MM.groupID = M.deviceType 
WHERE M.deviceType=5;

ELSEIF @Machine = 'allmobil'
 THEN SELECT COUNT(*) AS 'Total Mobil Devices'
 FROM mobiledevices AS M;

END IF; 
```

# csv - 将带有标题的大型 CSV 文件拆分为每个带有标题的第 n 行的多个 CSV 文件

> ID：12642180
> 
> 赞同：4
> 
> 时间：2012-09-28T14:41:38.507
> 
> 标签：csv, excel, vbscript, vba

我有一个大的 CSV 文件，我想将其拆分为多个 CSV 文件。我已经尝试了许多 VBS 脚本，但我似乎无法得到这个。

这个脚本做了我想做的一些事情，但没有将它们保存为 CSV 文件：

```
Sub Split()
Dim rLastCell As Range
Dim rCells As Range
Dim strName As String
Dim lLoop As Long, lCopy As Long
Dim wbNew As Workbook

With ThisWorkbook.Sheets(1)
    Set rLastCell = .Cells.Find(What:="*", After:=[A1], SearchDirection:=xlPrevious)

    For lLoop = 1 To rLastCell.Row Step 35
        lCopy = lCopy + 1
        Set wbNew = Workbooks.Add
        .Range(.Cells(lLoop, 1), .Cells(lLoop + 35, .Columns.Count)).EntireRow.Copy _
        Destination:=wbNew.Sheets(1).Range("A1")
        wbNew.Close SaveChanges:=True, Filename:="Inventory_" & lLoop + 34
    Next lLoop
End With 
```

结束子

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:58:43.943

在代码中添加了一个 saveas 行来指定文件格式，你应该都设置好了

```
Sub Split()
Dim rLastCell As range
Dim rCells As range
Dim strName As String
Dim lLoop As Long, lCopy As Long
Dim wbNew As Workbook

With ThisWorkbook.Sheets(1)
    Set rLastCell = .Cells.Find(What:="*", After:=[A1], SearchDirection:=xlPrevious)

    For lLoop = 2 To rLastCell.Row Step 35
        lCopy = lCopy + 1
        Set wbNew = Workbooks.Add
        .Cells(1, 1).EntireRow.Copy _
        Destination:=wbNew.Sheets(1).range("A1")
        .range(.Cells(lLoop, 1), .Cells(lLoop + 35, .Columns.Count)).EntireRow.Copy _
        Destination:=wbNew.Sheets(1).range("A2")
        wbNew.SaveAs FileName:="Inventory_" & format(lLoop + 34,"0000") & ".csv", FileFormat:=xlCSV, Local:=True
        wbNew.Close SaveChanges:=False
    Next lLoop
End With

End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T15:02:20.230

在我的头顶上：

```
Const ForReading = 1
Const ForWriting = 2

Set fso = CreateObject("Scripting.FileSystemObject")

maxRows = 35
i = 0
n = 0

Set out = Nothing
Set csv = fso.OpenTextFile("C:\PATH\TO\your.csv", ForReading)
header = csv.ReadLine

Do Until csv.AtEndOfStream
  If i = 0 Then
    If Not out Is Nothing Then out.Close
    Set out = fso.OpenTextFile("out_" & Right("00" & n, 2) & ".csv", ForWriting)
    out.WriteLine(header)
    n = n + 1
  End If
  out.WriteLine(csv.ReadLine)
  i = (i + 1) Mod maxRows
Loop

csv.Close    
If Not out Is Nothing Then out.Close 
```

# jquery - $.extend 是如何工作的？

> ID：12642183
> 
> 赞同：0
> 
> 时间：2012-09-28T14:41:57.530
> 
> 标签：jquery, extend

如果我像这样尝试

`$.extend(function_arguments, defaults_arguments)`

并非所有的 default_arguments 都会被覆盖。例如，如果其中一个是函数（`this`），如果来自 function_arguments 的那个是不同类型的，它将保留在对象中......

$.extend 到底是做什么的？它不应该像 array_merge 一样工作，而是对象？

* * *

好的，要更清楚：

```
....function(args){

  $.extend(args, {
     // here are defaults
     foo: this,
     abc: 1
  });

} 
```

出于某种原因，我得到了“foo”的默认值，即使我在 args 中有它......

如果我反转对象，例如：

```
....function(args){

  $.extend({
     // here are defaults
     foo: this,
     abc: 1
  }, args);

} 
```

我只从 args 获得属性，完全缺少默认值：|

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:50:23.033

你`.extend`的是倒退。默认值*首先*出现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:44:57.113

（我的立场得到纠正，这不是它的工作原理）。仅当后续指定的对象带有相同的属性时，属性才会被覆盖。该函数也不是递归的（因此不会枚举和合并对象的对象属性的属性）您可以根据需要将任意数量的对象属性组合到第一个对象中。那些多个第三、第四等参数只是您想要合并到第一个中的其他对象。

尝试这个：

```
$.extend(args, foo:this, bar:123); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:47:53.627

jQuery 文档上有一个完美的例子：[jQuery.extend](http://api.jquery.com/jQuery.extend/)

# linq - System.Linq.Dynamic 从实体框架 IQueryable 中选择集合内的集合

> ID：12642187
> 
> 赞同：0
> 
> 时间：2012-09-28T14:42:09.017
> 
> 标签：linq, entity-framework, entity-framework-4, linq-to-entities, dynamic-linq

我有一个具有用户->角色关系的 EF 模型。这是我们数据库中的一对多关系。我想从角色记录中选择 ID，从用户记录中选择名称。我想出的方法适用于一对一的关系。我不确定如何在动态 linq 中生成一个列表。也许一个`SelectMany`？

用户表：用户

加入表：User_Role

角色表：角色

```
 //does not select inside a collection of USER_ROLES
 q= query.Select(" new ( ID, (new (USER_ROLES.ID as ID) as USER)")

 //not valid
 //q = query.Select(" new ( ID, (new List<Object> (USER_ROLES.ID as ID) as USER)")   something I figure this would give me a list of User_Role's ID

 //not valid
 //q = query.Select(" new ( ID, (new List<Object> (USER_ROLES.ROLE.ID as ID) as USER)")       something I figure this would give me a list of Role's ID 
```

* * *

更新我越来越近了。我使用了一个selectman，但结果是重复的

```
q = query.SelectMany("USER_ROLES","new (inner as myUSER,outer as myROLE) ").SelectD("new (myROLE.ID as ROLE_ID, new( myROLE.NAME, myUSER.USER.FIRSTNAME,myUSER.USER.ID)as user)") 
```

结果如下所示：

```
 Role->User_Role A-> User A
       User_Role A-> User B    ..notice the repeat of "User_Role A" 
       User_Role A-> User C 
```

它应该是

```
 Role->User Role a -> User A
                         + User B
                         + User C 
```

# internet-explorer - Angular JS ng 风格和 Internet Explorer 8

> ID：12642188
> 
> 赞同：4
> 
> 时间：2012-09-28T14:42:10.063
> 
> 标签：internet-explorer, internet-explorer-8, angularjs

我有一个我似乎无法理解的问题。

在 IE8 中，指令 ng-style 似乎根本不起作用。我用它来设置元素的宽度。在所有其他浏览器上它工作正常。

在 IE8 上，使用蹩脚的 F12 工具检查元素，样式属性完全丢失。

任何人都可以告诉我是否有解决方法？我正在使用的 angularjs 版本是撰写本文时的稳定版本（1.0.2）

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T15:04:28.170

好的，我找到了为什么 {{ }} 在 IE7 中不起作用：您必须填充 JSON.stringify 因为它用于显示对象而 IE7 没有它，如果您显示一个字符串它正在工作：

[http://jsfiddle.net/NLrYx/3/](http://jsfiddle.net/NLrYx/3/)

有关 IE7 兼容的更多信息：http: [//docs.angularjs.org/guide/ie](http://docs.angularjs.org/guide/ie)

JSON 脚本：[https ://github.com/douglascrockford/JSON-js/blob/master/json2.js](https://github.com/douglascrockford/JSON-js/blob/master/json2.js)

# excel - 使用名字的首字母和姓氏从全名创建用户名

> ID：12642189
> 
> 赞同：1
> 
> 时间：2012-09-28T14:42:11.890
> 
> 标签：excel, excel-formula, formula, string-concatenation

我正在尝试使用 Excel 使用一个人的名字和姓氏来创建唯一的用户名。我当前的表格单元格遵循以下格式：

名字中间名（可能的第二个中间名）姓氏

我将如何编写一个公式来创建这个用户名？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T14:54:22.897

这一切都在一个牢房里吗？如果是这样，那么使用 A1 中的数据在 B1 中尝试这个公式

`=PROPER(LEFT(A1)&TRIM(RIGHT(SUBSTITUTE(A1," ",REPT(" ",99)),99)))`

如果您想要有限数量的字符，例如 7 个，请添加另一个 LEFT 函数

`=LEFT(PROPER(LEFT(A1)&TRIM(RIGHT(SUBSTITUTE(A1," ",REPT(" ",99)),99))),7)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-30T13:58:12.927

我是这样做的：

```
=CONCATENATE(LEFT(G2,1),H2) 
```

作为`G2`我有名字`H2`的列和有姓的列。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-24T22:54:04.600

我想要一个如下结构：

约翰·史密斯 = John.S

使用以下公式（如果您想要 J.Smith，可以很容易地反转）：

```
=CONCATENATE((C2), ("."), (LEFT(D2, 1))) 
```

`C2`名字和姓氏在哪里`D2`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-01T21:10:32.640

如果名称出现`[Kent, Clark B]`在一个单元格中。

我使用以下公式得到`"ckent"`：

```
=IFERROR(LOWER(MID(E2, FIND(" ", E2, 1) + 1, 1) & LEFT(E2, FIND(",", E2, 1)-1)), " ") 
```

`E2`名称单元格在哪里。

# matlab - 查找标签 matlab gui

> ID：12642190
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:42:12.903
> 
> 标签：matlab, user-interface, tags

我正在阅读另一个程序员的 Matlab GUI。这真的很复杂。很多轴、条和桌子。当我更深入地查看 .m 文件时，我只是无法在 .fig 布局中找到相应的部分。有什么好办法吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:11:46.767

有[findall](http://www.mathworks.se/help/matlab/ref/findall.html)功能：

> object_handles = findall(handle_list) 返回handle_list 中标识的对象下层次结构中所有对象的句柄，包括隐藏句柄。

例如，您可以调用 findall(gcf, 'Type', 'Text') 来查找所有文本对象等。

此外，还有[findobj](http://www.mathworks.se/help/matlab/ref/findobj.html)：

> 定位具有特定属性的图形对象

# jcarousel - 为什么 jCarousel Next/Prev 按钮在添加项目后未启用

> ID：12642191
> 
> 赞同：1
> 
> 时间：2012-09-28T14:42:14.760
> 
> 标签：jcarousel

最初我在 ul 下有三个 li 项目。使用 ui 创建了一个 jCarousel 实例，它使用三个 li 项目成功显示了轮播。默认情况下，轮播显示三个项目，因此 Next/Prev 按钮被禁用。

现在我使用 $('#mycarousel').data('jcarousel').add(...) 方法在轮播下添加一个新的 li 项目。它显示 li 已添加到具有适当 jcarouselidex 的 ul 下，但轮播的 Next/Prev 按钮仍处于禁用状态，因此我在轮播中看不到它。

注意：如果我创建带有 4 个或更多 li 项目的轮播，则 Next/Prev 按钮将变为启用状态，并且可以正常工作。

我试过的：我看到 Next/Prev 按钮的 div 处于禁用状态，所以在添加新项目后，我启用了 div。Next/Prev 按钮现在已启用，但不执行任何操作。

任何解决方法都将受到高度赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T17:48:25.123

这也让我想通了一些。调用 reload() 函数后，我用数组的新大小调用了 size() 函数。这是一个示例：

```
 carousel = jQuery('#header_selector').data('jcarousel');
            carousel.reset();
            for(n = 0; n < response.images.length; n++) {
                carousel.add(n, '<img src="' + response.images[n] + '" />' );
            }
            carousel.scroll(carousel.first);
            carousel.reload();
            carousel.size(response.images.length); 
```

试一试。

# php - PHP & jQuery 解析数据

> ID：12642192
> 
> 赞同：0
> 
> 时间：2012-09-28T14:42:16.633
> 
> 标签：php, jquery

我从 php 后端收到 jsong 响应，例如

```
 feedback =   {"html":"<form action='someurlonrest' method='post' style='margin-left:100px;' ><div style='padding: 10px;'>Ticket No<input type='text' id='tkt' name='tkt' ><\/div><div style='padding: 10px;'>somthing <input type='text' id='smthing' name='smthing' ><\/div><div style='padding: 10px;'>Query about <input type='text' id='query' name='query' ><\/div><input type='submit' class='classname' ><\/form>"} 
```

为什么每当我尝试做时都会收到未定义的消息

```
alert(feedback.html); 
```

**更新**

```
function get_fb_success(){

    var feedback = $.ajax({
        type: "POST",
        url: "feedback.php",
        async: false
    }).success(function(){
        setTimeout(function(){get_fb_success();}, 100000000000000000);
    }).responseText;
    alert(feedback);
    //$('#log_success').val('');

    $('#log_success').html(feedback.html);
    //$('div.feedback-box-success').html('success feedback');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:51:58.853

两件事情：

通过添加属性通知 jQuery 你期望 JSON 返回，`dataType: 'json'`然后不要忘记将 传递给`response`回调`success`。

在您执行此操作时`$('#log_success').html()`，数据实际上还不可用，因为它是一个异步调用（也许这就是您尝试使用那么长的原因`setTimeout()`？）。改为在成功处理程序中执行此操作：

```
function get_fb_success(){

    // feedback is a jqXHR object, *not* the JSON response!
    var feedback = $.ajax({
        type: "POST",
        url: "feedback.php",
        async: false,
        // Specify datatype
        dataType: 'json',
        success: function(response) {
           // Call .html() in the success() handler
           $('#log_success').html(response.html);
        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:54:55.627

您的问题的答案是您可以看到您正在寻找的对象值。在这里查看小提琴：http: [//jsfiddle.net/aWC8G/](http://jsfiddle.net/aWC8G/)

在此之下，您的 ajax 函数看起来有点奇怪。我认为它应该是这样的：

```
function get_fb_success(){

    var feedback;
    $.ajax({
        type: "POST",
        url: "feedback.php",
        async: false,
        dataType: 'json',
        success:function(data){
            feedback = data;  //assuming you are 
        }
    });
    alert(feedback);
    //$('#log_success').val('');

    $('#log_success').html(feedback.html);
    //$('div.feedback-box-success').html('success feedback');
} 
```

当然不是对服务器的异步调用，如果您想要真正的异步 ajax，请这样做（这应该可以工作，因为您的函数实际上没有返回任何值：

```
function get_fb_success(){

    $.ajax({
        type: "POST",
        url: "feedback.php",
        dataType: 'json',
        success:function(feedback){
            $('#log_success').html(feedback.html);
        }
    });

} 
```

# php - 驱动程序与控制器 (MVC)

> ID：12642194
> 
> 赞同：0
> 
> 时间：2012-09-28T14:42:23.937
> 
> 标签：php, oop, model-view-controller, codeigniter, hmvc

我正在使用 Codeignitor 2.x 并且我最初使用控制器作为模块（尽管不完全是 HMVC），因为我有一个可以调用其他较低级别控制器的顶级控制器。我的想法是，因为这些较低级别的控制器仍在与视图交互，所以它们应该仍然是控制器而不是模型或驱动程序。

然而，我发现控制器的每个实例也会产生一个新的 CI 实例。所以我会为每个请求运行 3 或 4 个 CI 实例。大量的开销，也导致了会话问题。

此后，我将这些较低级别的控制器作为驱动程序移入库中。他们现在在构造方法中捕获 CI 实例，并对其进行修改。这使它非常好用，并且不需要 HMVC 扩展。驱动程序也不能从外部调用，因此它允许我通过特定入口点汇集所有请求。

**我的问题是这在结构上是否正确。** 我一直认为驱动程序应该只修改通过方法调用提供的数据，但是这些驱动程序中的许多会直接从 GET 和 POST 中提取信息，虽然它们不会直接附加到视图，但它们经常访问查看文件，并将处理后的视图传递给 CI 实例进行输出。

[编辑]*更多上下文：* 我创建的驱动程序之一本质上是一个名为“Access”的用户登录驱动程序。它为创建/登录/注销方法调用“用户”模型。驱动程序使用 POST 数据来检查用户模型，然后加载带有错误的正确视图以及所需的任何内容。这个想法是，有 2 行，我可以在整个项目的任何控制器中包含这个驱动程序，因此代码冗余显着减少。同样，我知道驱动程序应该被限制在它们的范围内，但是驱动程序不会修改其范围之外的任何内容，而只是返回它创建的视图。

是否有另一种更符合直接 MVC 的方法来执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:12:38.050

我不能说是对还是错。但如果我是你，我不会那样做。我可能会重构一些代码。我会确保他们不会直接从超全局`$_GET`或`$_POST`超全局中获取和操作数据。相反，将一些数据作为参数传递给函数调用。这将使测试更容易，因为您不必模拟一个`GET`或一个`POST`请求。虽然从技术上讲，您可以从代码中手动设置超全局变量的值，但我不建议这样做。提供数据作为参数会更好，特别是如果您想编写随后执行的测试用例。另外，让库与超出其自身范围的范围进行交互可能会引入一些隐藏的陷阱。

在我看来，库应该是类似于模块的东西，你可以在其中拖放，然后毫不费力地使用它们。如果您的代码确实需要从`$_GET`or中获取或操作值`$_POST`，那么它们可能是模型。此外，您可能想考虑您的代码是否实际上是一个库。问问自己，这段代码在这个应用程序之外有用吗？或者它是否高度依赖并且只能对这个特定的应用程序有用？如果你对后者说是，那么它可能应该是一个模型而不是一个库。最后一件事，您应该将视图留给控制器。只需从库/模型方法返回您需要的数据，然后将其从控制器传递给视图。

# android - 如何在 Android 中更改按钮的背景图像时延迟 4 秒

> ID：12642197
> 
> 赞同：1
> 
> 时间：2012-09-28T14:42:28.333
> 
> 标签：android

我的示例应用程序中有两个按钮，我想以 4 秒的延迟一个接一个地更改按钮的背景图像，到目前为止我已经开发了代码，你可以在下面看到它，但是它让我的应用程序进入睡眠状态并显示没有。

请有人帮助我，我可以这样做。

```
 int m =0;
    int delay = 4;  //Seconds

    while(m < 4)
    {

     // int i = (int) (Math.random() * num + 1);

    if(m==0)
    {
        button1.postDelayed(new Runnable()
        {
            public void run()
            {
            // TODO Auto-generated method stub
            button1.setBackgroundResource(R.drawable.buttonyellow);
            m++;
            }
        }, 1000*delay);

    }

    else if(m==1)
    {
        button2.postDelayed(new Runnable()
        {
            public void run()
            {
                // TODO Auto-generated method stub
                button2.setBackgroundResource(R.drawable.buttonyellow);
                m++;
            }
        }, 1000*delay);

    }

    if(m==2)
    {
        button1.postDelayed(new Runnable()
        {
            public void run()
            {
            // TODO Auto-generated method stub
            button1.setBackgroundResource(R.drawable.buttonblue);
            m++;
            }
        }, 1000*delay);

    }

    else if(m==3)
    {
        button2.postDelayed(new Runnable()
        {
            public void run()
            {
                // TODO Auto-generated method stub
                button2.setBackgroundResource(R.drawable.buttonblue);
                m++;
            }
        }, 1000*delay);

    }

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:50:21.300

`postDelayed`不会延迟当前线程的执行，因此您的线程会`m == 0`反复发布案例。

您可能希望您发布的 Runnable 调用一些方法，该方法不仅设置背景并增加数字，而且再次调用此逻辑（以选择新的 Runnable 发布）。

例如（警告：未经测试的代码）

```
// assuming button1 and button2 are available
new Runnable() {
  private int m = 0;
  private final int delay = 4000;

  @Override
  public void run() {
    if (m == 0) {
      button1.setBackgroundResource(R.drawable.buttonyellow);
      button1.postDelayed(this, delay);
    } else if (m == 1) {
      button2.setBackgroundResource(R.drawable.buttonyellow);
      button2.postDelayed(this, delay);
    }
    // more cases here -- also consider making m wrap around
    m++;
  }
}.run(); 
```

自然这应该在 UI 线程上调用（如果它不在 UI 线程上调用，它应该被分派到 UI 线程`post`或类似）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:53:53.153

```
int mark = 0; 

button2.postDelayed(new Runnable()
    {
        public void run()
        {
            switch(mark++){
                 case 0:button2.setBackgroundResource(R.drawable.buttonyellow); break;
                 case 1:button2.setBackgroundResource(R.drawable.buttongreen); break;
                 ..ect
            }
            if(mark==Max)mark=0;

         button2.postDelayed(this,4000);
        }
    }, 4000); 
```

请注意，这将持续到时间结束，或者当您的应用停止时。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-28T14:53:06.767

您的 while 循环导致您的 UI 线程等待这些操作完成。您最好的两个选择是在新线程中调用它：

```
new Runnable() {
    @Override
    public void run() {
        //Your code
    }
}.run(); 
```

或者将它们嵌入链中：

```
button1.postDelayed(new Runnable()
    {
        public void run()
        {
            button1.setBackgroundResource(R.drawable.buttonyellow);
            button2.postDelayed(new Runnable()
            {
                public void run()
                {
                    button2.setBackgroundResource(R.drawable.buttonyellow);
                    button1.postDelayed(new Runnable()
                    {
                        public void run()
                        {
                            button1.setBackgroundResource(R.drawable.buttonblue);
                            button2.postDelayed(new Runnable()
                            {
                                public void run()
                                {
                                    button2.setBackgroundResource(R.drawable.buttonblue);
                                }
                            }, 1000*delay);
                         }
                    }, 1000*delay);
                }
            }, 1000*delay);
        }
    }, 1000*delay); 
```

# c# - 匹配部分文本

> ID：12642202
> 
> 赞同：0
> 
> 时间：2012-09-28T14:42:50.467
> 
> 标签：c#, sql-server

我需要有关逻辑的想法，该逻辑将匹配比较两个字符串的重复字符集。

`Car is blue and new`vs `Car is blue and old`，会找到 16 个匹配 `Car is , blue`项 vs`Car is blue color`会找到`Car is`匹配项和 `blue`

所以基本上我需要按百分比找出两个字符串（SQL Server 或 C#，最好是 SQL Server）中有多少重复字符是相同的。

我不希望有人给我写代码，但任何想法、链接或类似的东西都会受到欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:59:10.103

这里有点想法，你可以得到一个字符串中所有单词的列表，然后检查它们是否存在于另一个字符串中：

```
string baseStringOne = "Car is blue and new", baseStringTwo = "Car is blue and old"; 
string[] subs = baseStringOne.Split(' '); 
foreach (string sub in subs)
{
  if (baseStringTwo.Contains(sub))
  {
     //Substring found!
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:10:07.567

我想你会发现这些是相关的：
[The diff algorithm](http://en.wikipedia.org/wiki/Diff#Algorithm)
[An implementation for C#](http://www.codeproject.com/Articles/13326/An-O-ND-Difference-Algorithm-for-C)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:26:47.453

您可以通过以下方式获得不同的字符：

```
public static string Common(string s1, string s2)
    {
        return new string((s1.Intersect(s2)).ToArray());
    } 
```

# c# - 在 Asp.Net MVC 中自定义 google ColumnChart

> ID：12642204
> 
> 赞同：1
> 
> 时间：2012-09-28T14:42:55.993
> 
> 标签：c#, asp.net, asp.net-mvc, google-visualization

我试图自定义谷歌柱形图以从控制器添加我自己的数据。我找到了简单的解决方案，但如果有人知道更好的方法，我很乐意修改我的代码。

假设我们从[https://google-developers.appspot.com/chart/interactive/docs/gallery/columnchart复制代码](https://google-developers.appspot.com/chart/interactive/docs/gallery/columnchart)

```
 <script type="text/javascript" src="https://www.google.com/jsapi"></script>
        <script type="text/javascript">
          google.load("visualization", "1", {packages:["corechart"]});
          google.setOnLoadCallback(drawChart);
          function drawChart() {
            var data = google.visualization.arrayToDataTable([
              ['Year', 'Sales', 'Expenses'],
              ['2004',  1000,      400],
              ['2005',  1170,      460],
              ['2006',  660,       1120],
              ['2007',  1030,      540]
            ]);

            var options = {
              title: 'Company Performance',
              hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
            };

            var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
            chart.draw(data, options);
          }
        </script>

    <div id="chart_div" style="width:50%;float:left"></div> 
```

所以我想修改的第一个想法是显示类别名称和订单数量。解决方案很简单，我只是删除了 Expensed 所以它看起来像这样：

```
['Category', 'Orders'],
  ['2004',  1000,],
  ['2005',  1170, ],
  ['2006',  660,  ],
  ['2007',  1030, ] 
```

但这些是硬编码数据，我想从我的数据库中获得我自己的类别名称和订单名称。

我在控制器自定义字符串中创建，然后将其传递给脚本。

控制器：

```
foreach (var d in model.DinerCategoryOrders) // Build  string for google chart js
        { 
          // ['Pre-School', 1000], Template

            GoogleOrdersCount += "['" + d.CategoryName + "', " +  d.OrdersCount + "],";  
        }
        model.OrdersForGoogleChart = "google.visualization.arrayToDataTable([['Category', 'Orders']," + GoogleOrdersCount +" ]);";

 return model; 
```

在视图中

我简单地用我在控制器中构建的字符串替换了数据变量定义：

@Html.Raw(Model.OrdersForGoogleChart)

所以最终构建看起来像这样：

```
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load("visualization", "1", {packages:["corechart"]});
      google.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = @Html.Raw(Model.OrdersForGoogleChart)

        var options = {
          title: 'Company Performance',
          hAxis: {title: 'Year', titleTextStyle: {color: 'red'}}
        };

        var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
        chart.draw(data, options);
      }
    </script> 
```

我发现 Asp.Net MVC 中的 Razor 可以与 js 对话，并且 js 会消化通过 razor 传递的字符串而没有任何问题，这让我很惊讶。

如果您找到更好的解决方案，相信常见问题，请告诉我们！

# simplemodal - simplemodal 跨域问题

> ID：12642206
> 
> 赞同：0
> 
> 时间：2012-09-28T14:43:02.640
> 
> 标签：simplemodal

我正在使用 simplemodal 并且 js 是从另一个站点加载的，所以 window.parent.ModalBox.close(); 和 window.parent.$.ModalBox.close(); 不工作。

我收到这个 javascript 错误“未捕获的类型错误：无法调用未定义的方法‘关闭’”

这适用于 Firefox，但在 Chrome 中存在问题。

chrome 还显示此错误“不安全的 JavaScript 尝试使用 URL 访问框架”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T11:31:59.000

[同源策略](http://code.google.com/p/browsersec/wiki/Part2#Same-origin_policy)不允许跨不同域访问 DOM 属性和方法。您可以使用[postMessage API](http://help.dottoro.com/ljgheukc.php)来启用跨域通信。

# android - “无法打开日志设备‘dev/log/main’”错误？

> ID：12642207
> 
> 赞同：5
> 
> 时间：2012-09-28T14:43:04.510
> 
> 标签：android, logcat, galaxy

我正在使用有根的 Galaxy s2 4.0.3，我最近尝试编写一个 android 应用程序。我尝试在 eclipse 中使用 logcat 并打印了以下回复：

`unable to open log device 'dev/log/main' No such file or directory`

我浏览了论坛上的答案；有些人写来更改文件`init.d`夹中的文件，但我没有这样的文件夹。我不使用华为，所以特殊代码在这里无济于事。我什至尝试在我的设备上安装 logcat 应用程序，但它们也不起作用！

请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T13:11:43.257

拨这个：`*#*#2846579#*#*`

将出现服务菜单。

进入“项目菜单”->“后台设置”->“日志设置”

打开“日志开关”并将其设置为 ON。

打开“日志级别设置”并设置您想要的日志级别。

重启手机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-30T09:25:58.163

重启华为设备就足够了：

```
adb shell
reboot 
```

我想手动重启也可以。

# ios - 生成档案时出错

> ID：12642210
> 
> 赞同：2
> 
> 时间：2012-09-28T14:43:16.287
> 
> 标签：ios, archive, aviary

我正在使用 Xcode 4.2，并且在我的项目中添加了 AviarySDK 2.4.4。应用程序在 Simulator 5.0 和 4.3 中运行良好。我还在具有 ios 4.1 的设备上对其进行了测试。所以我想为我的客户生成 .ipa 文件。但由于某种原因，它无法生成档案。它给出以下错误

"/usr/bin/strip -S /Applications/Projects/AppName/AppName/AviarySDK/Resources/AviarySDKResources.bundle/AviarySDKResources -o /Users/User/Library/Developer/Xcode/DerivedData/WDYWT-avjpbcnwjylobvgevipvsqttnopd/ArchiveIntermediates/WDYWT/安装BuildProductsLocation/Applications/WDYWT.app/AviarySDKResources.bundle/AviarySDKResources

/usr/bin/strip：对于架构 armv7 对象：/Applications/Projects/AppName/AppName/AviarySDK/Resources/AviarySDKResources.bundle/AviarySDKResources 格式错误的对象（未知的加载命令 10）

错误：strip /Applications/Projects/AppName/AppName/AviarySDK/Resources/AviarySDKResources.bundle/AviarySDKResources: /usr/bin/strip 以 1" 退出

任何帮助都会很棒。提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T07:43:53.493

如果您的项目中有重复的调试符号，通常会导致剥离错误。只需尝试以下操作：

**第一种方法：**

1.  转到项目的构建设置
2.  `Strip`在搜索栏中输入。
3.  在下面`Strip Debug Symbols During Copy`，你会找到`Debug`，在那个下面，你会找到`Any SDK`。
4.  选择`NO`，`Any SDK`选择`YES`，然后`Debug`选择`YES`。`Strip Debug Symbols during copy`
5.  在下面一点你会发现`Use Separate Strip`。选择是`.`
6.  检查是否`Strip Style`应该保留`All Symbols`[如果没有，则将其更改为]。

**第二种方法：**

> 由于您的错误还提到了派生数据，因此它们也可能与您的派生数据重复。从派生数据文件夹中删除您的项目文件。如果您不知道派生数据文件夹在哪里，请谷歌它。

我在我当前的项目中使用 aviary。我有一台 Mac Mini 和一台 MacAir [用于在家工作]。我使用上述第一种方法解决了与 aviary 相同的脱衣问题。

我花了一周的时间才弄清楚这一点，因为我是开发中的一个相对新手，而且在 aviary 论坛中也没有提到任何关于这个问题的内容。

PS：

```
MacMini: Xcode 4.5
MacAir: Xcode 4.2 
```

希望这可以帮助

# c# - 将 DependencyProperty 绑定到 Label 的 Text 属性？

> ID：12642217
> 
> 赞同：1
> 
> 时间：2012-09-28T14:43:45.700
> 
> 标签：c#, wpf, binding, dependency-properties

我想将 my 绑定`DependencyProperty`到我的自定义按钮的标签。

这是我的`DependencyProperty`：

```
public static readonly DependencyProperty ButtonTextProperty = DependencyProperty.Register("ButtonText", typeof(string), typeof(MainMenuButton));

public string ButtonText
    {
        get { return (string)GetValue(ButtonTextProperty); }
        set { SetValue(ButtonTextProperty, value); }
    } 
```

这是我将值绑定到标签的尝试：

```
<TextBlock x:Name="lblButtonText" Margin="16,45.2465" TextWrapping="Wrap" Text="{Binding RelativeSource={RelativeSource Mode=Self}, Path=ButtonText}" VerticalAlignment="Center" TextAlignment="Right" Foreground="White" FontSize="17.333" FontWeight="Bold" FontFamily="Segoe UI Semibold" Height="26.053"/> 
```

这种绑定我的 DependencyProperties 的方式在其他情况下工作了几次，但我不知道为什么这次它不起作用？

我怎么解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:54:47.167

您正在将绑定源设置为`Self`, 并且`Self`是`TextBlock`, 并且`TextBlock`没有名为`ButtonText`

您可能希望将绑定源设置`RelativeSource`为类型`MyCustomButton`

```
Text="{Binding Path=ButtonText,
    RelativeSource={RelativeSource AncestorType={x:Type local:MyCustomButton}}}" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:06:39.397

或者，您可以尝试像这样绑定：

首先为您的自定义控件命名：

```
<uc:myControl x:Name="ucName" ButtonText="MyText" .../> 
```

（记得导入 xmlns，在本例中称为 uc）

```
<Window xmlns:uc="NamespaceToMyUc" ...> 
```

然后使用 ElementName 绑定到它：

```
<TextBlock Text="{Binding ElementName=ucName, Path=ButtonText} ... /> 
```

# php - 页面的密码验证不起作用

> ID：12642219
> 
> 赞同：0
> 
> 时间：2012-09-28T14:44:08.970
> 
> 标签：php, arrays, validation, passwords

login.php 表单和 password.php 工作正常，但进入站点的验证不工作

“passwords.php”的代码

```
<?php 
$USERS["username1"] = "password1"; 
$USERS["username2"] = "password2"; 
$USERS["username3"] = "password3"; 

function check_logged(){ 
     global $_SESSION, $USERS; 
     if (!array_key_exists($_SESSION["logged"],$USERS)) { 
          header("Location: login.php"); 
     }; 
}; 
?> 
```

登录.php

```
<?php 
session_start(); 
include("passwords.php"); 
if ($_POST["ac"]=="log") { /// do after login form is submitted  
     if ($USERS[$_POST["username"]]==$_POST["password"]) { /// check if submitted 

          $_SESSION["logged"]=$_POST["username"]; 
     } else { 
          echo 'Incorrect username/password. Please, try again.'; 
     }; 
}; 
if (array_key_exists($_SESSION["logged"],$USERS)) { //// check if user is logged or not  
     echo "You are logged in."; //// if user is logged show a message  
} else { //// if not logged show login form 
     echo '<form action="login.php" method="post"><input type="hidden" name="ac" value="log"> '; 
     echo 'Username: <input type="text" name="username" />'; 
     echo 'Password: <input type="password" name="password" />'; 
     echo '<input type="submit" value="Login" />'; 
     echo '</form>'; 
}; 
?> 
```

我不能让这部分工作

页面验证：

```
<?php 
session_start(); /// initialize session 
include("passwords.php"); 
check_logged(); /// function checks if visitor is logged. 
?> 
```

页面代码在这里

我究竟做错了什么？验证不检查用户是否登录。它只是进入页面。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T14:52:46.993

您应该添加退出；在设置重定向标头后，页面的其余部分不会得到处理。

```
 if (!array_key_exists($_SESSION["logged"],$USERS)) { 
      header("Location: login.php"); 
      exit;
 }; 
```

另外，您是否尝试关闭浏览器以清除所有会话数据并查看您是否仍然登录？

# javascript - canvasContext.fillRect 在 Firefox 中抛出 NS_ERROR_FAILURE 异常

> ID：12642222
> 
> 赞同：3
> 
> 时间：2012-09-28T14:44:16.113
> 
> 标签：javascript, firefox, canvas

我正在尝试在页面顶部绘制一个巨大的画布矩形（某种灯箱背景），代码非常简单：

```
var el = document.createElement('canvas');
el.style.position = 'absolute';
el.style.top  = 0;
el.style.left = 0;
el.style.zIndex = 1000;
el.width  = window.innerWidth + window.scrollMaxX;
el.height = window.innerHeight + window.scrollMaxY;

...
document.body.appendChild(el);

// and later

var ctx = el.getContext("2d");
ctx.fillStyle = "rgba(0, 0, 0, 0.4)";
ctx.fillRect(0, 0, el.width, el.height); 
```

有时（并非总是）最后一行抛出：

> 组件返回失败代码：0x80004005 (NS_ERROR_FAILURE) [nsIDOMCanvasRenderingContext2D.fillRect]

我一直在猜测是否会因为图像大小或画布下方的内容类型（例如嵌入视频播放）而发生这种情况，但显然不是。

因此，我正在寻找有关如何隔离和/或解决此问题的任何想法。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T16:40:32.137

查看[`nsIDOMCanvasRenderingContext2D.fillRect()`实现](https://hg.mozilla.org/releases/mozilla-release/file/a00bd2d09f38/content/canvas/src/nsCanvasRenderingContext2D.cpp#l2194)（并通过它调用的函数） - 没有太多的条件会返回`NS_ERROR_FAILURE`。只有在其中一个`EnsureSurface()`或`mThebes->CopyPath()`失败的情况下才会发生。以下两行`EnsureSurface()`很可能是您的问题的根源：

```
// Check that the dimensions are sane
if (gfxASurface::CheckSurfaceSize(gfxIntSize(mWidth, mHeight), 0xffff)) { 
```

这里检查的内容：

*   画布的宽度和高度都不能超过 65535 像素。
*   在 Mac OS X 上高度不能超过 32767 像素（平台限制）。
*   画布数据 ( `width * height * 4`) 的大小不能超过 2 GB。

如果违反这些条件中的任何一个，`EnsureSurface()`将返回`false`并因此产生您所看到的异常。请注意，以上是可以随时更改的实现细节，您不应依赖它们。但他们可能会让您了解您的代码违反了哪些特定限制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-01T21:17:45.720

您可以应用 try-catch 逻辑。Firefox 似乎是唯一表现得有点奇怪的浏览器。

```
el.width  = window.innerWidth + window.scrollMaxX;
el.height = window.innerHeight + window.scrollMaxY;

// try first to draw something to check that the size is ok
try
{
  var ctx = el.getContext("2d");
  ctx.fillRect(0, 0, 1, 1);
}

// if it fails, decrease the canvas size
catch(err)
{
  el.width = el.width - 1000;
  el.height = el.height - 1000;
} 
```

我还没有找到任何变量来告诉最大画布大小是多少。它因浏览器和设备而异。

检测最大画布大小的唯一跨浏览器方法似乎是减小画布大小的循环，例如。100px，直到它不产生错误。我测试了一个循环，这是检测最大画布大小的相当快的方法。因为其他浏览器在尝试在过大的画布上绘制时不会抛出错误，所以最好尝试绘制例如。红色矩形并读取一个像素并检查它是否为红色。

为了最大限度地提高检测性能：
- 在循环时，画布应该在 DOM 之外以最大限度地提高速度
- 将起始大小设置为众所周知的最大值，这似乎是 32,767 像素（SO：[<canvas> 元素的最大大小](https://stackoverflow.com/questions/6081483/maximum-size-of-a-canvas-element)）
- 你可以创建一个更智能的循环来分叉最大尺寸：例如使用第一个更大的减小步骤（例如 1000 像素），当达到可接受的尺寸时，尝试将尺寸增加 500 像素。如果这是可接受的尺寸，则增加 250 像素，依此类推。这样，应该在最少的试验中找到最大值。

# sql - sql server批量数据库更改，批量数据库更改-最好和最安全的方法

> ID：12642223
> 
> 赞同：1
> 
> 时间：2012-09-28T14:44:25.087
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我们有一个由 5 名开发人员组成的小型开发团队，他们致力于大型企业级 Web 的 asp.net/c# 系统。

我们做了很多数据库更新，包括存储过程的创建和更改以及新表的创建、列的创建、记录插入、记录更新等等。

今天，所有开发人员都将所有更改脚本放在一个大型 sql 更改脚本文件中，该文件可以在我们的测试和生产环境中运行。所以这个单个文件包含存储的 proc 更改和记录插入、更新等。该文件最终可能会很长，因为我们可能每 1 到 2 个月才进行一次测试或生产发布。

我目前面临的问题是：

偶尔在这个大型“批量更改脚本”中的任何给定位置都可能出现脚本错误。例如，对于 proc，可能插入失败或更改失败。

发生这种情况时，很难判断数据库上哪些更改成功以及哪些更改失败。

有时即使一个更改失败，例如代码将继续在整个脚本中执行，有时它会停止执行并且没有进一步运行。

因此，我今天最终手动检查了过程和记录，以查看哪些实际有效，哪些实际无效，这有点费力。

我希望我可以将整个更改脚本汇总到一个大事务中，以便如果发生任何问题，我可以回滚每个更改，但是在 sql server 中使用这样的批处理脚本似乎是不可能的。

所以，然后我尝试在运行脚本之前备份数据库，这样如果发生错误，我可以简单地恢复数据库，修复问题，然后重新运行修复的脚本。然而，为了恢复数据库，我必须关闭我们的数据库镜像，所以这也不是完全理想的。

所以我的问题是，在生产数据库上运行批处理脚本最安全的方法是什么？

有什么方法可以将整个脚本包装在一个我可以回滚我没有看到的事务中？

跟踪和运行单独的脚本文件对我们来说会更好吗，这样如果 1 个文件失败，我们可以将它推到失败的目录中查看并继续运行所有其他文件？

寻求建议和专业知识。

感谢您的时间。马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:13:19.390

批处理脚本应首先在您的 QC 数据库上运行，以便在生产之前发现任何错误。

QC 数据库应与生产相同或尽可能接近相同。

每个脚本都应该捕获错误并使用打印语句报告脚本的名称以及错误的位置，然后如果在应用于生产时发生错误，您至少有脚本的名称和错误的位置脚本内。

如果您的 QC 数据库相同或非常接近，则生产错误应该非常少见。

# php - 在 PHP 中，当一个对象实例化失败时会发生什么？

> ID：12642230
> 
> 赞同：1
> 
> 时间：2012-09-28T14:44:45.827
> 
> 标签：php, class, object, instantiation

```
$someClass sc=new SomeClass(); 
```

我想知道的是，如果构造函数由于某种原因失败（比如可能没有足够的内存），变量 sc 中的内容是什么。我找不到直接的答案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:46:19.197

With your example of memory issue, You get a fatal error and php ceases execution. You never get to the assignment of the varible $sc.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T14:50:36.940

构造函数失败主要有两个原因：

1.  记不清; 不是对象独有的，这会导致致命错误并且您的脚本将无法继续。

2.  [抛出](http://php.net/manual/en/language.exceptions.php)异常；除非使用“try-catch”子句捕获异常，否则您的脚本将停止。

> ```
> try {
>     $sc = new SomeClass(); // exception is thrown inside the constructor
> } catch (Exception $e) {
>     echo "Yikes, object didn't get created; error = {$e->getMessage()}\n";
> } 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:46:46.433

first of all, the syntax for object initiation is incorrect, needs to be `$sc = new SomeClass();` And you would get an memory exhaustion error, and variable `$sc` wouldn't be created.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:47:57.807

当任何其他类型的代码由于某种原因（例如内存不足等）失败时也会发生同样的事情：PHP 运行时发出一个致命错误，仅此而已。对象构造函数并不特殊。

# c# - 使用 c# 和 Visual Studio 设计时数据集访问数据库

> ID：12642231
> 
> 赞同：1
> 
> 时间：2012-09-28T14:44:50.247
> 
> 标签：c#, dataset, visual-studio-2012, strongly-typed-dataset

我见过很多使用 C# 访问数据库的方法，我不知道哪种方法最适合简单的读/写/操作数据。我过去只使用通用 DataSet/DataTable 对象，但我正在尝试使用更多类型安全的结构。我首先在 Visual Studio 中添加数据集 (xsd) 并连接到 SQL Server 后端。

我正在尝试查询在表中搜索给定字符串的列，但该列不是主键（所以我不能使用 .Find()）。我该怎么做呢？我需要使用 LINQ 还是可以使用扩展方法/lambda 表达式？

在更基本的层面上，当使用设计时数据集时，我需要使用表适配器来填充我使用的数据集中的每个表，还是我只是实例化数据集？文档让我有点困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:54:05.410

您可以使用`Linq-To-DataSet`最强大的方式（不是在效率方面，而是在可读性和可维护性方面）来查询`DataSet`.

阅读更多：[查询类型化数据集](http://msdn.microsoft.com/en-us/library/bb399351.aspx)。

您可以选择在 VS 设计器上创建一个`TableAdapter`或仅创建一个。`DataTable`如果添加 TableAdapter VS 也会创建相应的 DataTable。如果只添加 DataTable，则必须提供自己的填充方式。 `TableAdapters`类似于`DataAdapter`ADO.NET 中的 a。

因此，如果您创建了一个名为的 DataSet`DataSet1`并添加了一个选择名为 的表的 TableAdapter ，Visual Studio 将自动在命名空间中`tabData`创建一个名为的 DataTable`tabDataDataTable`和一个`TableAdapter`名为的。`tabDataTableAdapter``DataSet1TableAdapters`

所以你可以用这种方式填写这张表：

```
var dataSet = new DataSet1();
var da = new DataSet1TableAdapters.tabDataTableAdapter();
da.Fill(dataSet.tabData); 
```

假设表有列`Name`，`Age`并且您想要查找名称以开头`"Jon"`且年龄大于 30 的所有行，您可以使用 LINQ `Where`：

```
var jons = dataSet.tabData
                  .Where(r => r.Name.StartsWith("Jon") && r.Age > 30);
foreach (DataSet1.tabDataRow row in jons)
{
    Console.WriteLine("{0} is {1} years old", row.Name, row.Age);
} 
```

请注意，您可以使用安全的 LINQ-To-DataSet 类型（`r.Name`是字符串和`r.Age`int）。

# iphone - 如何设置 UITableViewCell 突出显示的图像

> ID：12642233
> 
> 赞同：0
> 
> 时间：2012-09-28T14:44:52.950
> 
> 标签：iphone, objective-c, ios, xcode, uitableview

每次当用户`cell`在`UITableView`. 你能告诉我，怎么可能做到这一点？

我想这样做是因为我有一个带有图片的自定义单元格，并且每次用户突出显示该单元格时我都想更改图片。

**UPD：**我所说的高亮是指用户只是高亮一个单元格，而不是松开手指。通过选择，我的意思是当 didSelectRowAtIndexPath 被启动时（所以用户在按下它后从单元格中释放手指）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:55:57.480

您如何设想用户会“突出显示”一个单元格而不是“选择”一个单元格？

在 iOS（或任何基于触摸的环境）中，没有仅突出显示一个单元格而不是选择一个单元格的概念。当用户触摸单元格时，您得到的唯一回调是 didSelectRowAtIndexPath：

可能值得在此处阅读[有关表格的文档](http://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITableViewDelegate_Protocol/Reference/Reference.html)。

**更新**：

嗯，好的，在这种情况下，你想像这样设置单元格 imageView 的 highlightImage 属性；

```
cell.imageView.image = [UIImage imageNamed:@"normal_image.png"];
cell.imageView.highlightedImage = [UIImage imageNamed:@"highlighted_image.png"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:59:18.420

我不明白你的问题..你不想使用方法 selectRowAtIndexPath 吗？

如果你想在用户选择一行时执行一个方法：

- 您可以使用方法 selectRowAtIndexPath 并执行您的方法。

您还可以在单​​元格内创建一个不可见的 UIButton ，当单击单元格时，您将单击按钮并执行您的方法。. .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-18T14:56:52.303

从 iOS 6.0 开始，*UITableViewDelegate*有 3 种方法来处理单元格突出显示：

```
- tableView:shouldHighlightRowAtIndexPath:
- tableView:didHighlightRowAtIndexPath:
- tableView:didUnhighlightRowAtIndexPath: 
```

你应该使用它们，就像在这个例子中一样：

```
- (BOOL)tableView:(UITableView*)tableView shouldHighlightRowAtIndexPath:(NSIndexPath*)indexPath
{
    return YES;
}

- (void)tableView:(UITableView*)tableView didHighlightRowAtIndexPath:(NSIndexPath*)indexPath
{
    MyTableViewCell* cell = (MyTableViewCell*)[tableView cellForRowAtIndexPath:indexPath];
    cell.myImageView.image = [UIImage imageNamed:@"myCellHigh"];    
}

- (void)tableView:(UITableView*)tableView didUnhighlightRowAtIndexPath:(NSIndexPath*)indexPath
{
    MyTableViewCell* cell = (MyTableViewCell*)[tableView cellForRowAtIndexPath:indexPath];
    cell.myImageView.image = [UIImage imageNamed:@"myCellUnhigh"];  
} 
```

# django - Django ModelForms：将 ManyToMany 字段显示为单选

> ID：12642243
> 
> 赞同：4
> 
> 时间：2012-09-28T14:45:19.873
> 
> 标签：django, django-forms

在 Django 应用程序中，我有一个模型 Bet，其中包含与 Django 的 User 模型的 ManyToMany 关系：

```
class Bet(models.Model):
    ...
    participants = models.ManyToManyField(User) 
```

用户应该能够使用表格开始新的投注。到目前为止，投注只有两名参与者，其中一名是自己创建投注的用户。这意味着在新投注的表格中，您必须准确选择一位参与者。保存表单数据后，投注创建者被添加为参与者。

我正在为我使用 ModelForm `NewBetForm`：

```
class NewBetForm(forms.ModelForm):
    class Meta:
        model = Bet
        widgets = {
            'participants': forms.Select()
        }

    def save(self, user):
        ... # save user as participant 
```

请注意参与者字段的重新定义小部件，它确保您只能选择一个参与者。

但是，这给了我一个验证错误：

```
Enter a list of values. 
```

我不确定这是从哪里来的。如果我查看开发者工具中的 POST 数据，这似乎与我使用默认小部件并仅选择一个参与者完全一样。`to_python()`但是， ManyToManyField的方法似乎对这些数据有问题。如果我启用 Select 小部件，至少没有创建用户对象。

我知道我可以通过从表单中排除参与者字段并自己定义它来解决这个问题，但是如果仍然可以使用 ModelForm 的容量会更好（毕竟，它只是一个小部件更改）。如果我知道如何，也许我可以以某种方式操纵传递的数据。

谁能告诉我到底是什么问题以及是否有解决问题的好方法？

提前致谢！

**编辑**

正如评论中所建议的：视图的（相关）代码。

```
def new_bet(request):
    if request.method == 'POST':
        form = NewBetForm(request.POST)
        if form.is_valid():
            form.save(request.user)
            ... # success message and redirect
    else:
        form = NewBetForm()
    return render(request, 'bets/new.html', {'form': form}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T23:15:09.577

在挖掘 Django 代码之后，我可以回答我自己的问题。

问题是 Django 的 ModelForm 将`ManyToManyField`模型中`ModelMultipleChoiceField`的 s 映射到表单的 s。这种表单字段期望小部件对象从其`value_from_datadict()`方法返回一个序列。`ModelMultipleChoiceField`（即）的默认小部件`SelectMultiple`覆盖`value_from_datadict()`以从用户提供的数据中返回一个列表。但是如果我使用`Select`小部件，则使用超类的默认`value_from_datadict()`方法，它只是返回一个字符串。`ModelMultipleChoiceField`根本不喜欢那样，因此验证错误。

对于我能想到的解决方案：

1.  通过继承或某些类装饰器覆盖`value_from_datadict()`of 。`Select`
2.  通过创建一个新的表单字段并调整其`save()`方法`ModelForm`以将其数据保存在 m2m 关系中，手动处理 m2m 字段。

秒的解决方案似乎不那么冗长，所以这就是我将要使用的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-19T22:36:39.853

我并不是要恢复已解决的问题，但我正在研究这样的解决方案，并认为我会分享我的代码来帮助他人。

在 j0ker 的回答中，他列出了两种方法来使其正常工作。我使用了方法 1。我从 SelectMultiple 小部件中借用了“value_from_datadict”方法。

表格.py

```
from django.utils.datastructures import MultiValueDict, MergeDict

class M2MSelect(forms.Select):
    def value_from_datadict(self, data, files, name):
        if isinstance(data, (MultiValueDict, MergeDict)):
            return data.getlist(name)
        return data.get(name, None)    

class WindowsSubnetForm(forms.ModelForm):
    port_group = forms.ModelMultipleChoiceField(widget=M2MSelect, required=True, queryset=PortGroup.objects.all())
    class Meta:
        model = Subnet 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:48:38.697

问题是 ManyToMany 是这种关系的错误数据类型。

从某种意义上说，赌注*本身*就是多对多的关系。让参与者成为多对多场是没有意义的。你需要的是两个外键，都给用户：一个给创建者，一个给另一个用户（“接受者”？）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T17:40:07.093

您可以在验证之前（期间）修改提交的值`Form.clean_field_name`。您可以使用此方法将选择的单个值包装在列表中。

```
class NewBetForm(forms.ModelForm):
    class Meta:
        model = Bet
        widgets = {
            'participants': forms.Select()
        }

    def save(self, user):
        ... # save user as participant

    def clean_participants(self):
        data = self.cleaned_data['participants']
        return [data] 
```

我实际上只是在猜测 select 提供的值是什么样的，所以这可能需要一些调整，但我认为它会起作用。

[这是文档。](https://docs.djangoproject.com/en/dev/ref/forms/validation/#cleaning-a-specific-field-attribute)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-23T16:46:21.593

受@Ryan Currah 的启发，我发现这是开箱即用的：

```
class M2MSelect(forms.SelectMultiple):
    def render(self, name, value, attrs=None, choices=()):
        rendered = super(M2MSelect, self).render(name, value=value, attrs=attrs, choices=choices)
        return rendered.replace(u'multiple="multiple"', u'') 
```

显示多对多中的第一个，保存时只剩下选定的值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-09T06:41:21.913

在@Ryan Currah 的启发下，我找到了一种更简单的方法：您只需覆盖 SelectMultiple 类中的“allow_multiple_selected”属性

```
class M2MSelect(forms.SelectMultiple):
    allow_multiple_selected = False

class NewBetForm(forms.ModelForm):
    class Meta:
        model = Bet

    participants = forms.ModelMultipleChoiceField(widget=M2MSelect, required=True, queryset=User.objects.all()) 
```

# php - Facebook Graph API Take Photograph with PHP

> ID：12642244
> 
> 赞同：0
> 
> 时间：2012-09-28T14:45:21.077
> 
> 标签：php, facebook, facebook-graph-api

i've tried to take the user's profile photo with using graph api, i take first name, email,fb id exc true, but i fail on taking the user's profile pictures, tried everything and read everything but failed.

After connecting with facebook, it shows a big question mark in the photo areas in my websites' profile picture area for the profiles..

Also there is no problem about temp_fb_id parametre, its inserting that true too

Here is my codes :

```
// above is the part with sessions getting user id, user email exc.
// $temp_fb_id is the variable that i use for taking the info for user name exc and its working but with photo part, not working , 
 //  img src is showing https://graph.facebook.com//picture?type=square,with a output, big question mark

 $first_name = $user->first_name;
 $last_name = $user->last_name;

 $photo = "https://graph.facebook.com/{$temp_fb_id}/picture?type=square";
 $photothumb = "https://graph.facebook.com/{$temp_fb_id}/picture?type=normal";
 $photolarge = "https://graph.facebook.com/{$temp_fb_id}/picture?type=large";

try {
$fb_insert = "INSERT INTO `members`(`first_name`, `photo_small`, `photo_thumb`, `photo`, `last_name`, `fb_id`) VALUE(:first_name, :photo, :photothumb, :photolarge, :last_name, :temp_fb_id)";
 $fb_insert_do = $db->prepare($fb_insert);
 $fb_insert_do->bindParam(':first_name', $first_name, PDO::PARAM_STR);
 $fb_insert_do->bindParam(':last_name', $last_name, PDO::PARAM_STR);
 $fb_insert_do->bindParam(':photo', $photo, PDO::PARAM_STR);
 $fb_insert_do->bindParam(':photothumb', $photothumb, PDO::PARAM_STR);
 $fb_insert_do->bindParam(':photolarge', $photolarge, PDO::PARAM_STR);
 $fb_insert_do->execute();
 }

 catch(PDOException $e) {
            /* catch and log errors over here. */
        } 
```

Thank You

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:08:45.903

听起来您传递的用户 ID 由于某种原因不正确。您应该将结果与`$user->id`您存储的结果进行比较，`$tmp_fb_id`以确保值相等。您应该能够将这些 url 之一粘贴到`src`标签`img`中并让它呈现照片。您也可以将 id 替换为`$user->username`以查看它是否更好。

一个问题：为什么将这些 URL 存储在数据库中，而不是在运行时从存储的 Id 生成它们？如果 Facebook 决定在未来更改 url 方案以获取个人资料照片，您将必须更新所有数据库记录，而不仅仅是几行代码。

# php - change my account menu position in magento

> ID：12642245
> 
> 赞同：1
> 
> 时间：2012-09-28T14:45:24.413
> 
> 标签：php, magento

I have created custom module which added link in Left navigation menu of My Account Page. Every things is handle By modules Layout.xml. But My Module link is appeared at Last in position i.e after News letter Subscription. I want to add this after "My Order" Menu.

How can I do this. Please help me.

Thanks Pravin

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:14:40.180

在 XML 文件中，您可以将块设置在另一个块之前或之后。

在布局 XML 文件中，将以下属性添加到块中：

```
before="name_of_block" 
```

或者：

```
after="name_of_block" 
```

所以你的行看起来像这样：

```
<block type="some/type" before="some_other_block_name" template="some/path/to/template.phtml" /> 
```

如果您希望它出现在任何其他块之前（或每隔一个块之后），请使用以下命令：

```
before="-" 
```

或者：

```
after="-" 
```

# sql - deleted value of the after delete trigger

> ID：12642246
> 
> 赞同：1
> 
> 时间：2012-09-28T14:45:26.817
> 
> 标签：sql, sql-server-2005

I've got problems with my triggers (add and delete):

```
ALTER TRIGGER [trgAfterShoppingInserted]
ON [ShopingList] AFTER INSERT 
AS BEGIN
   DECLARE @cardId char(6), @points int, @userId int

   SET @cardId = (SELECT cardId FROM inserted)
   SET @points = (SELECT points FROM inserted)
   SET @userId = (SELECT userId from [Card] WHERE id = @cardId)
   IF @userId = 0
   BEGIN
   Update [Card]
   set points = points + @points
   where id =@cardId
   END
   ELSE
   Update [Card]
   set points = points + @points
   where id =@cardId OR
   userId = @userId
END

ALTER TRIGGER [trgAfterShoppingDeleted]
ON [ShopingList] AFTER DELETE 
AS BEGIN
   DECLARE @cardId char(6), @points int, @userId int

   SET @cardId = (SELECT cardId FROM inserted)
   SET @points = (SELECT points FROM inserted)
   SET @userId = (SELECT userId from [Card] WHERE id = @cardId)
   IF @userId = 0
   BEGIN
   Update [Card]
   set points = points - @points
   where id =@cardId
   END
   ELSE
   Update [Card]
   set points = points - @points
   where id =@cardId OR
   userId = @userId
END 
```

The problem is on the `SET @cardId..`

The error is:

> *Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.*

how is it possibile ?

thanks for any help

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:11:59.010

如果您的 insert 或 delete 语句应该插入或删除多行，则这两个触发器都将不起作用。您需要停止假设您的触发器仅处理单行 - 事实并非如此。您需要重写触发器以一次处理多行（在`Inserted`和`Deleted`表中）

作为一个例子 - 你可以重写你的`trgAfterShoppingDeleted`东西是这样的：

```
ALTER TRIGGER [trgAfterShoppingDeleted]
ON [ShopingList] AFTER DELETE 
AS BEGIN
   UPDATE [Card]
   SET points = points - i.points
   FROM Inserted i
   WHERE Card.id = i.id AND i.UserId = 0

   UPDATE [Card]
   SET points = points - @points
   FROM Inserted i
   WHERE i.UserId <> 0 AND (Card.id = i.id OR Card.userId = i.userId)
END 
```

您需要**考虑数据集**- 不要假设触发器伪表中有单行，也不要在触发器中进行 RBAR（逐行处理）处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:52:47.390

`deleted`表包含作为给定`DELETE`语句的一部分被删除的记录，如果`DELETE`条件匹配多条记录，则可以包含多行。

这就是您的情况发生的情况，当您尝试`cardId`从`deleted`包含多条记录的表中进行选择时，select 语句将返回多个值，因此触发器会引发该异常。

# c# - In C#, How to create a define and use a class hierarchy derived from an enum value?

> ID：12642249
> 
> 赞同：0
> 
> 时间：2012-09-28T14:45:32.090
> 
> 标签：c#

Given an enum type:

```
public enum Work
{
    Normal,
    Extended
} 
```

What I would like to do is the following.

```
public abstract class Builder<T>
{
    public static Builder<T> GetBuilder<T> (T work)
    {
        return new Builder<T> ();
    }
}

public class BuilderNormal : Builder<Work.Normal>
{
}

public class BuilderExtended : Builder<Work.Extended>
{
} 
```

I specifically want to avoid using a switch/case in Builder or using a mapping that I would need to maintain when I would add a new enum value to Work, i.e. I could do this

```
public abstract class Builder
{
    public static Builder GetBuilder (Work work)
    {
        switch (work)
        {
            case Work.Normal:
                return new BuilderNormal ();

            case Work.Extended:
                return new BuilderExtended ();

            default:
                throw new ...
        }
    }
} 
```

So, basically, I want to create an instance of a class depending on an enum value and the class must be a child class of an abstract class.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T14:48:13.540

基本上，你不能按照你设计的方式。泛型类型参数始终用于*类型*，而不是*值*。

你当然*可以*做的是维护一个单一`Dictionary<Work, Func<Builder>>`的，让你基本上注册工厂。这将避免 switch 语句，但它仍然是您可能忘记添加值的地方。

我会依靠单元测试来避免这个问题——编写一个测试来检查你是否可以`Builder`为枚举中的每个值创建一个；然后，如果您在未添加映射的情况下向枚举添加值，您的测试将失败。

编辑：另一种选择是向枚举值添加一个属性，以说明哪个构建器类型对应于该值。然后，您需要使用反射提取该类型并以这种方式实例化它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:48:06.810

你可以做一些毫无意义、疯狂而缓慢的事情，比如

```
public abstract class Builder
{
    public static TBuilder GetBuilder<TBuilder>() where TBuilder : Builder
    {
        var ctors = typeof(TBuilder).GetConstructors(
            BindingFlags.Instance | 
            BindingFlags.NonPublic | 
            BindingFlags.Public);

        var matchingCtor = ctors.Single(
            ci =>
                {
                    var paramInfo = ci.GetParameters();

                    if (paramInfo.Length != parameters.Length)
                    {
                        return false;
                    }

                    return !paramInfo.Where((t, i) =>
                        t.ParameterType != parameters[i].GetType()).Any();
                });

        return (TBuilder)matchingCtor.Invoke(parameters);
    }
} 
```

这会给你一种静态的通用实例构造函数，所以你可以这样做，

```
var builderNormal = Builder.GetBuilder<BuilderNormal>(); 
```

但是，为什么不直接调用实例构造函数呢？

# sql-server - Nicer way to add entry into main db table and link table

> ID：12642251
> 
> 赞同：0
> 
> 时间：2012-09-28T14:45:40.013
> 
> 标签：sql-server, asp.net-mvc, asp.net-mvc-3, entity-framework

Hi all the below solution works in that it creates a record in the MeetingRoomRequest table and also adds the associated amenities to that request into the MeetingRoomRequestAmenityLink table. However it just feels a bit clunky, so I was wondering if there is a nicer solution out there (i.e. not having to create 2 context instances) using MVC 3 and Entity Framework??

Please note i've set up the necessary relationships (one to many) in SQL Server and Entity Framework.

Also please note AmenityList is an array of id's (e.g. [1,2,4])

```
private readonly IDataRepository<MeetingRoomRequest> _meetingRoomRequestRepository = new DataRepository<MeetingRoomRequest>();
private readonly IDataRepository<MeetingRoomRequestAmenityLink> _meetingRoomRequestAmenityLinkRepository = new DataRepository<MeetingRoomRequestAmenityLink>();

var meetingRoomRequestToAdd = new MeetingRoomRequest
{
    User = meetingRoomRequestViewModel.User,
    UserEmail = meetingRoomRequestViewModel.UserEmail,
    Title = meetingRoomRequestViewModel.Title,
    Comments = meetingRoomRequestViewModel.Comments,
    StartDateTime = meetingRoomRequestViewModel.StartTime,
    EndDateTime = meetingRoomRequestViewModel.EndTime,
    RequestStatusID = (int)Enums.RequestStatus.New,
    AttendeeCount = meetingRoomRequestViewModel.AttendeeCount,
    AttendeeType = meetingRoomRequestViewModel.AttendeeType,
    OfficeID = meetingRoomRequestViewModel.OfficeId,
    LocationID = meetingRoomRequestViewModel.LocationId, 
};
_meetingRoomRequestRepository.Add(meetingRoomRequestToAdd);
_meetingRoomRequestRepository.SaveChanges();
var meetingRoomRequestAdded = meetingRoomRequestToAdd;

foreach (var item in meetingRoomRequestViewModel.AmenityList)
{
    var meetingRoomRequestAmenityLinkToAdd = new MeetingRoomRequestAmenityLink
    {
        AmenityID = item,
        MeetingRoomRequestID = meetingRoomRequestAdded.MeetingRoomRequestID
    };
    _meetingRoomRequestAmenityLinkRepository.Add(meetingRoomRequestAmenityLinkToAdd);
    _meetingRoomRequestAmenityLinkRepository.SaveChanges();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:22:42.307

您的处理方式看起来是正确的，但是在处理请求的效率方面可以进行一些改进。

1.  由于这些是子/父关系，因此您可以创建父实体，然后在 foreach 循环中附加子实体，然后再调用父实体上的保存更改。EF 将使用父对象的主键（或关联键）自动填充子对象的外键值。
2.  您可以继续使用您的实体，而无需将其保存回变量。EF 的对象跟踪将在您的整个函数中继续跟踪这一点。
3.  通过将 savechanges 移到 foreach 循环之外，您可以减少调用次数。我相信在最后一次调用中会发送相同数量的 SQL，但您可能会看到没有打开/关闭连接的增加。EF 可能还有其他内置效率

**编码**

```
var meetingRoomRequestToAdd = new MeetingRoomRequest
        {
            User = meetingRoomRequestViewModel.User,
            UserEmail = meetingRoomRequestViewModel.UserEmail,
            Title = meetingRoomRequestViewModel.Title,
            Comments = meetingRoomRequestViewModel.Comments,
            StartDateTime = meetingRoomRequestViewModel.StartTime,
            EndDateTime = meetingRoomRequestViewModel.EndTime,
            RequestStatusID = (int)Enums.RequestStatus.New,
            AttendeeCount = meetingRoomRequestViewModel.AttendeeCount,
            AttendeeType = meetingRoomRequestViewModel.AttendeeType,
            OfficeID = meetingRoomRequestViewModel.OfficeId,
            LocationID = meetingRoomRequestViewModel.LocationId, 
        };
        _meetingRoomRequestRepository.Add(meetingRoomRequestToAdd);

        foreach (var item in meetingRoomRequestViewModel.AmenityList)
        {
            meetingRoomRequestToAdd.MeetingRoomRequestAmenityLinks.Add(new MeetingRoomRequestAmenityLink
            {
                AmenityID = item
            });
        }
        _meetingRoomRequestRepository.SaveChanges(); 
```

# javascript - Removing $() jQuery wrapper to just get raw JS element

> ID：12642252
> 
> 赞同：9
> 
> 时间：2012-09-28T14:45:43.553
> 
> 标签：javascript, jquery

Random *just out of curiosity* question:

Let's say for whatever reason I get an element back from a function

```
$(element) 
```

But I want to remove the **$( __ )** jQuery wrapper to leave the regular DOM Element:

```
element 
```

**Is this possible?** (I'm sure it'd be smart to test `$(element).length()` to make sure it isn't more than 1 thing inside beforehand too...

[jsFiddle](http://jsfiddle.net/xHj5d/)

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-28T14:46:16.130

```
var firstElem = $(element)[0]; 
```

or

```
var firstElem = $(element).get(0); 
```

Calling `get()` without an index gives you an array of the elements.

Reference: [jQuery get()](http://api.jquery.com/get/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T14:46:39.687

DOM elements are stored as properties at numeric zero-based indices, so you access them just like you would for any other object.

```
$jqObj[0]; 
```

Or get a full Array of elements using [`toArray()`](http://api.jQuery.com/toArray/)

```
$jqObj.toArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:51:46.563

小提琴：http: [//jsfiddle.net/xHj5d/2/](http://jsfiddle.net/xHj5d/2/)

```
removeJWrapper($('#ohHeyo'));

function removeJWrapper (el) {
    console.log(el[0]);
} 
```

# inheritance - Parametric Polymorphism vs Subtype polymorphism F#

> ID：12642253
> 
> 赞同：2
> 
> 时间：2012-09-28T14:45:44.773
> 
> 标签：inheritance, f#, functional-programming, parametric-polymorphism, subtyping

What is the difference (if any) between these two F# type signatures?

```
UseTheStream<'a when 'a :> Stream> : 'a -> unit 
```

and

```
UseTheStream : (stream : Stream) -> unit 
```

Do they mean the same thing in this case?

msdn says the following about the (:>) Type Constraint

```
type-parameter :> type --   The provided type must be equal to or derived from the type      specified, or, if the type is an interface, the provided type must implement the interface. 
```

This would indicate that the two signatures are saying the same thing. So Functionally, how are they different?

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T14:51:08.540

它们不一样。最重要的是，第一个函数是通用的。在您的示例中，它可能无关紧要，但如果类型参数影响函数的返回类型，它会：

```
let UseTheStream (stream: #Stream) = stream
let UseTheStreamStrict (stream: Stream) = stream

let s1 = new MemoryStream() |> UseTheStream
let s2 = new MemoryStream() |> UseTheStreamStrict 
```

`s1`是`MemoryStream`。`s2`是`Stream`。

注意：`#T`是`'U when 'U :> T`.

# python - 从 xyz 坐标中查找多边形的面积

> ID：12642256
> 
> 赞同：18
> 
> 时间：2012-09-28T14:45:51.790
> 
> 标签：python, 3d, polygon, area

我正在尝试使用该`shapely.geometry.Polygon`模块来查找多边形的面积，但它会在`xy`平面上执行所有计算。这对我的一些多边形来说很好，但其他多边形也有`z`尺寸，所以它并没有完全符合我的要求。

是否有一个包可以从`xyz`坐标中给我一个平面多边形的面积，或者一个包或算法将多边形旋转到`xy`平面以便我可以使用`shapely.geometry.Polygon().area`？

多边形表示为表格中的元组列表`[(x1,y1,z1),(x2,y2,z3),...(xn,yn,zn)]`。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-28T15:53:07.680

[这是计算 3D 平面多边形面积的公式的推导](http://softsurfer.com/Archive/algorithm_0101/algorithm_0101.htm#3D%20Polygons)

这是实现它的 Python 代码：

```
#determinant of matrix a
def det(a):
    return a[0][0]*a[1][1]*a[2][2] + a[0][1]*a[1][2]*a[2][0] + a[0][2]*a[1][0]*a[2][1] - a[0][2]*a[1][1]*a[2][0] - a[0][1]*a[1][0]*a[2][2] - a[0][0]*a[1][2]*a[2][1]

#unit normal vector of plane defined by points a, b, and c
def unit_normal(a, b, c):
    x = det([[1,a[1],a[2]],
             [1,b[1],b[2]],
             [1,c[1],c[2]]])
    y = det([[a[0],1,a[2]],
             [b[0],1,b[2]],
             [c[0],1,c[2]]])
    z = det([[a[0],a[1],1],
             [b[0],b[1],1],
             [c[0],c[1],1]])
    magnitude = (x**2 + y**2 + z**2)**.5
    return (x/magnitude, y/magnitude, z/magnitude)

#dot product of vectors a and b
def dot(a, b):
    return a[0]*b[0] + a[1]*b[1] + a[2]*b[2]

#cross product of vectors a and b
def cross(a, b):
    x = a[1] * b[2] - a[2] * b[1]
    y = a[2] * b[0] - a[0] * b[2]
    z = a[0] * b[1] - a[1] * b[0]
    return (x, y, z)

#area of polygon poly
def area(poly):
    if len(poly) < 3: # not a plane - no area
        return 0

    total = [0, 0, 0]
    for i in range(len(poly)):
        vi1 = poly[i]
        if i is len(poly)-1:
            vi2 = poly[0]
        else:
            vi2 = poly[i+1]
        prod = cross(vi1, vi2)
        total[0] += prod[0]
        total[1] += prod[1]
        total[2] += prod[2]
    result = dot(total, unit_normal(poly[0], poly[1], poly[2]))
    return abs(result/2) 
```

为了测试它，这是一个倾斜的 10x5 正方形：

```
>>> poly = [[0, 0, 0], [10, 0, 0], [10, 3, 4], [0, 3, 4]]
>>> poly_translated = [[0+5, 0+5, 0+5], [10+5, 0+5, 0+5], [10+5, 3+5, 4+5], [0+5, 3+5, 4+5]]
>>> area(poly)
50.0
>>> area(poly_translated)
50.0
>>> area([[0,0,0],[1,1,1]])
0 
```

最初的问题是我过于简单化了。它需要计算垂直于平面的单位向量。面积是其点积和所有叉积总和的一半，而不是叉积所有量值总和的一半。

这可以稍微清理一下（如果有矩阵和向量类，或者行列式/叉积/点积的标准实现，它会更好），但它在概念上应该是合理的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-29T15:02:32.627

这是我使用的最终代码。它没有使用shapely，而是实现了Stoke's theorem直接计算面积。它建立在@Tom Smilack 的答案之上，该答案展示了如何在没有 numpy 的情况下做到这一点。

```
import numpy as np

#unit normal vector of plane defined by points a, b, and c
def unit_normal(a, b, c):
    x = np.linalg.det([[1,a[1],a[2]],
         [1,b[1],b[2]],
         [1,c[1],c[2]]])
    y = np.linalg.det([[a[0],1,a[2]],
         [b[0],1,b[2]],
         [c[0],1,c[2]]])
    z = np.linalg.det([[a[0],a[1],1],
         [b[0],b[1],1],
         [c[0],c[1],1]])
    magnitude = (x**2 + y**2 + z**2)**.5
    return (x/magnitude, y/magnitude, z/magnitude)

#area of polygon poly
def poly_area(poly):
    if len(poly) < 3: # not a plane - no area
        return 0
    total = [0, 0, 0]
    N = len(poly)
    for i in range(N):
        vi1 = poly[i]
        vi2 = poly[(i+1) % N]
        prod = np.cross(vi1, vi2)
        total[0] += prod[0]
        total[1] += prod[1]
        total[2] += prod[2]
    result = np.dot(total, unit_normal(poly[0], poly[1], poly[2]))
    return abs(result/2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-06-24T11:38:01.007

#pythonn 3D 多边形区域代码（优化版）

```
def polygon_area(poly):
    #shape (N, 3)
    if isinstance(poly, list):
        poly = np.array(poly)
    #all edges
    edges = poly[1:] - poly[0:1]
    # row wise cross product
    cross_product = np.cross(edges[:-1],edges[1:], axis=1)
    #area of all triangles
    area = np.linalg.norm(cross_product, axis=1)/2
    return sum(area)

if __name__ == "__main__":
    poly = [[0+5, 0+5, 0+5], [10+5, 0+5, 0+5], [10+5, 3+5, 4+5], [0+5, 3+5, 4+5]]
    print(polygon_area(poly)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-28T09:55:57.857

可以使用 Numpy 作为单线计算 2D 多边形的面积...

```
poly_Area(vertices) = np.sum( [0.5, -0.5] * vertices * np.roll( np.roll(vertices, 1, axis=0), 1, axis=1) ) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-06T22:23:44.930

仅供参考，这是 Mathematica 中的相同算法，带有婴儿单元测试

```
ClearAll[vertexPairs, testPoly, area3D, planeUnitNormal, pairwise];
pairwise[list_, fn_] := MapThread[fn, {Drop[list, -1], Drop[list, 1]}];
vertexPairs[Polygon[{points___}]] := Append[{points}, First[{points}]];
testPoly = Polygon[{{20, -30, 0}, {40, -30, 0}, {40, -30, 20}, {20, -30, 20}}];
planeUnitNormal[Polygon[{points___}]] :=
  With[{ps = Take[{points}, 3]},
   With[{p0 = First[ps]},
    With[{qs = (# - p0) & /@ Rest[ps]},
     Normalize[Cross @@ qs]]]];
area3D[p : Polygon[{polys___}]] :=
  With[{n = planeUnitNormal[p], vs = vertexPairs[p]},
   With[{areas = (Dot[n, #]) & /@ pairwise[vs, Cross]},
    Plus @@ areas/2]];
area3D[testPoly] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-01-09T05:22:37.630

与@Tom Smilack 的答案相同，但在 javascript 中

```
//determinant of matrix a
function det(a) {
  return a[0][0] * a[1][1] * a[2][2] + a[0][1] * a[1][2] * a[2][0] + a[0][2] * a[1][0] * a[2][1] - a[0][2] * a[1][1] * a[2][0] - a[0][1] * a[1][0] * a[2][2] - a[0][0] * a[1][2] * a[2][1];
}
//unit normal vector of plane defined by points a, b, and c
function unit_normal(a, b, c) {
  let x = math.det([
    [1, a[1], a[2]],
    [1, b[1], b[2]],
    [1, c[1], c[2]]
  ]);
  let y = math.det([
    [a[0], 1, a[2]],
    [b[0], 1, b[2]],
    [c[0], 1, c[2]]
  ]);
  let z = math.det([
    [a[0], a[1], 1],
    [b[0], b[1], 1],
    [c[0], c[1], 1]
  ]);
  let magnitude = Math.pow(Math.pow(x, 2) + Math.pow(y, 2) + Math.pow(z, 2), 0.5);
  return [x / magnitude, y / magnitude, z / magnitude];
}
// dot product of vectors a and b
function dot(a, b) {
  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
}
// cross product of vectors a and b
function cross(a, b) {
  let x = (a[1] * b[2]) - (a[2] * b[1]);
  let y = (a[2] * b[0]) - (a[0] * b[2]);
  let z = (a[0] * b[1]) - (a[1] * b[0]);
  return [x, y, z];
}

// area of polygon poly
function area(poly) {
  if (poly.length < 3) {
    console.log("not a plane - no area");
    return 0;
  } else {
    let total = [0, 0, 0]
    for (let i = 0; i < poly.length; i++) {
      var vi1 = poly[i];
      if (i === poly.length - 1) {
        var vi2 = poly[0];
      } else {
        var vi2 = poly[i + 1];
      }
      let prod = cross(vi1, vi2);
      total[0] = total[0] + prod[0];
      total[1] = total[1] + prod[1];
      total[2] = total[2] + prod[2];
    }
    let result = dot(total, unit_normal(poly[0], poly[1], poly[2]));

    return Math.abs(result/2);
  }

}
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-10-26T20:30:35.083

感谢您提供详细的答案，但我有点惊讶没有简单的答案来获得该区域。

因此，我只是发布了一种使用 pyny3d 使用多边形或曲面的 3d 坐标计算面积的简化方法。

```
#Install pyny3d as:
pip install pyny3d

#Calculate area
import numpy as np
import pyny3d.geoms as pyny

coords_3d = np.array([[0,  0, 0],
                           [7,  0, 0],
                           [7, 10, 2],
                           [0, 10, 2]])
polygon = pyny.Polygon(coords_3d)
print(f'Area is : {polygon.get_area()}') 
```

# c# - 为每个 ItemsControl 项动态创建 Silverlight 控件

> ID：12642258
> 
> 赞同：1
> 
> 时间：2012-09-28T14:45:56.767
> 
> 标签：c#, wpf, silverlight, .net-4.0

我想绑定每个对象都有 UIType 的列表（即文本框、复选框、组合等）。它具有对象值属性。

我想将此列表绑定到 ItemControl（ListBox，DataGrid..），其中每个项目将具有与每个对象的特定 UIType 对应的单独模板（例如，组合项目将在行中具有组合，复选框项目将具有复选框） ...

显然 prop Value 将绑定到每个项目的相关属性。

实现这一目标的最透明且不太复杂的方法是什么？

银光 5.

**编辑：（基于雅各布解决方案的工作代码）**

代码：

```
ObservableCollection<UIType> data;

public MainPage()
{
    InitializeComponent();

    data = new ObservableCollection<UIType>() 
    { 
        new UITypeTextBox() { Value = "Value.." }, 
        new UITypeCheckBox(){ Value = true },  
    };

    lb.ItemsSource = data;
}

public class UIType { }
public class UITypeTextBox  : UIType { public object Value { get; set; }}
public class UITypeCheckBox : UIType { public object Value { get; set; } } 
```

xml:

```
<ListBox x:Name="lb">
    <ListBox.Resources>
        <DataTemplate DataType="local:UITypeTextBox">
            <TextBox Text="{Binding Value}" />
        </DataTemplate>
        <DataTemplate DataType="local:UITypeCheckBox">
            <CheckBox IsChecked="{Binding Value}" />
        </DataTemplate>
    </ListBox.Resources>
</ListBox> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:30:34.080

我不确定 Silverlight，但在 WPF 中，您可以使用数据模板来执行此操作。对于每个 UI 类型，您定义一个数据模板，该模板基本上将一个类型映射到一个视图，该视图只是在 XAML 中定义的用户控件。

通常，您将在资源字典中定义数据模板：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:views="clr-namespace:MyApp.Views"
    xmlns:uitypes="clr-namespace:MyApp.UITypes"
    >

    <DataTemplate DataType="{x:Type uitypes:TextBox}">
        <views:TextBoxView />
    </DataTemplate>

    <DataTemplate DataType="{x:Type uitypes:CheckBox}">
        <views:CheckBoxView />
    </DataTemplate>

</ResourceDictionary> 
```

您的视图将是从 UserControl 继承的 XAML 文件。例如，TextBox 视图的 XAML 可能如下所示。

```
<UserControl x:Class="MyApp.Views.TextBox"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
    <Grid>
        <TextBox Text="{Binding Value}" />    
    </Grid>
</UserControl> 
```

当您将 UI 类型添加到 ItemControl 时，WPF（希望是 Silverlight）会自动绘制正确的视图。

# regex - 更好的 bash 脚本来创建目录结构

> ID：12642260
> 
> 赞同：1
> 
> 时间：2012-09-28T14:46:08.500
> 
> 标签：regex, linux, bash, automation, mkdir

我想用纯文本创建文件夹，其结构如下：

```
Folder
| Subfolder
| | Deeper-subfolder
| Subfolder 
```

我考虑过使用类似的基本命令`mkdir`并发现该帖子：[创建目录结构的 Bash 脚本](https://stackoverflow.com/questions/5374382/bash-script-that-creates-a-directory-structure#answer-5374519)，但它仍然需要编写如下结构：

```
Folder
Folder/subfolder
Folder/subfolder/deeper-subfolder
Folder/subfolder 
```

所以我需要更改以下中使用的正则表达式：

```
sed '/^$/d;s/ /\//g' struct.txt | xargs mkdir -p 
```

我可以使用什么 bash 命令来执行此操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T18:19:47.357

使用纯 sed：

```
#!/bin/sed -f

x
G
: loop
s:\([^/]*\)/*\(.*\n\)\([^|]*\)|\s:\2\3\1/:
t loop

s/.*\n//
s:/*$::
h 
```

为此，我们必须使用保持空间（辅助缓冲区）来存储先前的 dir 路径。然后我们可以从保留空间中删除目录并将它们替换到相应的 |s 中。更详细的解释如下：

该脚本对每一行执行。我们要做的第一件事是交换（“x”）保持空间和模式空间。最初，保留空间将为空，但在第一行之后，保留空间将包含先前的目录路径。通过交换它们，我们加载先前的目录并将当前的新目录保存到保持空间中。

接下来，我们将新目录名称附加到先前的目录路径（但两者都将用换行符分隔）。用于此的命令是“G”。

现在我们必须为每个 | 循环 我们发现的性格。要做到这一点是棘手的部分，所以请耐心等待。假设我们在当前模式空间中有以下内容

```
Folder/subdir
| | deeper-subdir 
```

1.  首先，`\([^/]*\)`匹配第一个斜线之前的所有内容并捕获它（即，将其存储在一个“变量”中，`\1`因为它是第一个捕获组而命名）。
2.  然后我们跳过斜杠：`/*`
3.  将所有内容捕获到换行符（包括）并存储到 capture `\2`：`\(.*\n\)`
4.  捕捉前的一切| 字符并存储到捕获中`\3`： `\([^|]*\)`
5.  跳过 | 字符后跟一个空格字符：`|\s`

现在，捕获看起来像这样：

1.  文件夹
2.  子目录\n

我们所要做的就是重新生成重新排列捕获的行并添加另一个斜线，这样它们就变成了：

```
subdir
Folder/| deeper-subdir 
```

之后，我们有一个条件分支命令“t”，如果前一个“s”命令成功，它只会返回到“循环”标签。这意味着当字符串准备好（不再有 |s）时，我们可以退出循环并继续执行代码。

按照示例，下一次迭代包含捕获：

1.  子目录
2.  \n
3.  文件夹/

在循环之后，第一个替换命令删除第一行，其中包含新目录尚未进入的路径（即，新目录比前一个目录“浅”）。

最后一个替换命令从行尾删除所有斜杠，最后一个命令是一个保持命令（“h”），它将当前生成的路径复制到保持空间，因此我们可以为下一行重复所有操作。

希望这会有所帮助=)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:59:43.437

您将无法仅通过更改您提供的 sed 脚本中的正则表达式来做到这一点。原因是在示例中，您引用具有目录结构的文件的每一行都有足够的信息来创建目录。在您的示例中，您需要进行一些数据操作来跟踪父文件夹。这将更加复杂......我们不喜欢引入复杂性，除非我们必须这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:44:42.130

下面的脚本应该做到这一点。

这个想法是维护一个目录名称的“堆栈”，并根据一行有多少管道来推送或弹出。

（此脚本假定输入文件格式正确，并且文件名中不包含任何空行或特殊字符。）

```
#!/bin/bash

file=$1

# helper function to create a directory from an array
mkDirs(){
    IFS=/ dir="$*"
    echo "mkdir -p $dir"
}

declare -a stack=()
while read line
do
    dirName="${line##*| }"
    pipes="${line//[^|]/}"
    num_pipes="${#pipes}"
    diff=$(( ${#stack[@]} - $num_pipes ))
    if [[ "$diff" -ne 0 ]]
    then
        # create the directory
        mkDirs "${stack[@]}"
        while (( "$diff" != 0 ))
        do
            unset stack[${#stack[@]}-1] # pop off stack
            diff=$(( ${#stack[@]} - $num_pipes ))
        done
    fi
    stack=("${stack[@]}" "$dirName") # push on stack
done < "$file"
mkDirs "${stack[@]}" 
```

**例子：**

```
$ cat struct.txt
Folder
| Subfolder
| | Deeper-subfolder
| Subfolder
| | SubSubFolder
| | | Another
| | | | AnotherChild
| | | YetAnother
Folder2

$ run.sh struct.txt
mkdir -p Folder/Subfolder/Deeper-subfolder
mkdir -p Folder/Subfolder/SubSubFolder/Another/AnotherChild
mkdir -p Folder/Subfolder/SubSubFolder/YetAnother
mkdir -p Folder2 
```

# c# - What is wrong with my marshaling for the C# DLL import of this C++ function?

> ID：12642264
> 
> 赞同：0
> 
> 时间：2012-09-28T14:46:22.993
> 
> 标签：c#, c++, marshalling

I am trying to invoke a function in a C++ DLL from C#/.net. I believe there is something wrong with how I am marshaling the data. The function call runs but the return values (the last 7 variables) are all set to 0, and the arrays are set to length of 1 (I assume this is the DLL's intended behavior when it receives data it can't work with).

The C++ DLL is compiled as 32bit.

Here is the C++ header:

```
extern "C" __declspec(dllexport) void __stdcall Merchandize(int SppCode,
                                                                  double DBH, 
                                                                  double TotHt, 
                                                                  double CR, 
                                                                  double BTR,
                                                                  int *minDIBs,     //array
                                                                  int *minLens,     //array
                                                                  int *minVols,     //array
                                                                  int NumProducts, //array length
                                                                  int maxLen,       
                                                                  double trimLen,
                                                                  double stumpHt,
                                                                  int logStep,
                                                                  int *logLens,     //array, understood to be 50
                                                                  double *logSEDs,  //array, understood to be 50
                                                                  double *logVols,  //array, understood to be 50
                                                                  int *logGrades,   //array, understood to be 50
                                                                  int *NumberOfLogs,
                                                                  double *merchHt,
                                                                  int *errorFlag) 
```

And here is the C# dll import:

```
 [DllImport("C:\\Users\\Public\\Documents\\FVSNEMerchandizer.dll")]
      static extern void MerchandizeTree(int SppCode, 
                                            double DBH,
                                            double TotHt,
                                            double CR,
                                            double BTR,
                                            ref int[] minDIBs,
                                            ref int[] minLens, 
                                            ref int[] minVols, 
                                            int NumProducts,
                                            int maxLen, 
                                            double trimLen, 
                                            double stumpHt, 
                                            int logStep,
                                            ref int[] logLens, 
                                            ref double[] logSEDs, 
                                            ref double[] logVols,
                                            ref int[] logProds, 
                                            ref int[] numLogs, 
                                            ref double merchHt,
                                            ref int errorFlag); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:50:40.857

我很确定你不想要数组上的 ref 。这表明 C++ 中的类型例如是 int** 而不是 int*。

此外，如果您减少参数的数量（通过将它们放在某种结构中），您可能会提高代码的整体速度。处理器必须推送大量参数，当您拥有这么多参数时，这会花费大量时间。

# .net - How to handle exception at runtime in R? (R.net with c#)

> ID：12642265
> 
> 赞同：0
> 
> 时间：2012-09-28T14:46:25.907
> 
> 标签：.net, r, c#-4.0, exception, exception-handling

I am currently workin on R.net application using c#.

I am new to R and i am not sure how to handle runtime exceptions in R language? I refered online material on R online but couldnt find useful.

Would try & catch help? or any loop? Please provide me steps.

Please help me. Thanks a lot in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:14:43.453

该功能`tryCatch`是您正在寻找的。它是这样工作的：

```
result = tryCatch({
    expr
}, warning = function(w) {
    warning-handler-code
}, error = function(e) {
    error-handler-code
}, finally {
    cleanup-code
} 
```

`expr`您想尝试运行的某个 R 表达式在哪里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:15:02.573

try catch finally 可能是您想要的。据我所知，r.net 中的错误处理与 c#/.net 中的错误处理相同。

一旦你发现错误，你所做的总是有争议的。Console.Log、EventLog、swallow 等

[尝试 Catch 示例](http://msdn.microsoft.com/en-us/library/dszsf989%28v=vs.100%29.aspx)

# java - getAnnotations() is empty

> ID：12642266
> 
> 赞同：19
> 
> 时间：2012-09-28T14:46:28.767
> 
> 标签：java, annotations

I would like to use annotations in my application. For this reason I create "hello world" for annotations:

follows example:

```
public class HelloAnnotation
{
    @Foo(bar = "Hello World !")
    public String str;

    public static void main(final String[] args) throws Exception
    {
        System.out.println(HelloAnnotation.class.getField("str").getAnnotations().length);
    }
} 
```

And this is the Annotation:

```
import java.lang.annotation.ElementType;
import java.lang.annotation.Target;

@Target(ElementType.FIELD)
public @interface Foo
{
    public String doTestTarget();
} 
```

My problem is now that getAnnotations() in main is empty. What is wrong with my code?

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-09-28T14:48:56.380

将以下内容添加到您的注释中：

```
 @Retention(RetentionPolicy.RUNTIME) 
```

来自[@Retention](http://docs.oracle.com/javase/7/docs/api/java/lang/annotation/RetentionPolicy.html)的javadoc ：

> 保留策略默认为`RetentionPolicy.CLASS`

[来自RetentionPolicy](http://docs.oracle.com/javase/7/docs/api/java/lang/annotation/RetentionPolicy.html)的 javadoc ：

*   `CLASS`
    *   注释将由编译器记录在类文件中，但**不需要在运行时由 VM 保留**。
*   `RUNTIME`
    *   注释将由编译器记录在类文件中，并在运行时由 VM 保留，因此**可以反射性地读取它们**。
*   `SOURCE`
    *   注释将被编译器丢弃。

# sql - 使用 Visual Basic 从列表框中向表中添加记录

> ID：12642271
> 
> 赞同：0
> 
> 时间：2012-09-28T14:46:51.187
> 
> 标签：sql, database, vba, ms-access

我试图让用户双击列表框中的项目，然后将选定的值（以及使用 SQL 的一些相关值）输入到我准备好的表中。

我会发布我拥有的代码，但事实是我什至不知道从哪里开始，所以任何帮助都将不胜感激。

我的列表框 (listResult) 有 3 列我想输入到我的表中（股票转换）。

提前致谢，

鲍勃·P

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:04:48.117

一种可能：

```
Dim qdf As QueryDef

'Temporary query
Set qdf = CurrentDb.CreateQueryDef( _
       "", "Insert Into Table1 (atext,anumber) values ([p1],[p2])")

qdf.Parameters("[p1]") = "abc"
qdf.Parameters("[p2]") = 20
qdf.Execute dbFailOnError 
```

# php - 表达式引擎 2 输出通道字段标题

> ID：12642276
> 
> 赞同：0
> 
> 时间：2012-09-28T14:47:09.063
> 
> 标签：php, codeigniter, expressionengine

嗨，我正在循环通过 EE2 中的通道，并且正在输出所有字段值，但是如何输出我在后端标记的字段标题？

**代码：**

```
<!-- Loop to out put a field called Location -->

{exp:channel:entries channel="vacancies"  disable="pagination|member_data|categories"}
    <p>{vacancy_location}{title}{/vacancy_location}: {vacancy_location}</p>
{/exp:channel:entries} 
```

**期望的输出：**

```
<p>Location: Some Location</p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T15:44:36.923

对我有用的是安装 EE2 附带的 SafeCracker 模块并使用它的 {label:} 标签

[http://expressionengine.com/user_guide/modules/safecracker/index.html#label-my-field-name](http://expressionengine.com/user_guide/modules/safecracker/index.html#label-my-field-name)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:30:07.377

你不能......获得它的唯一方法是从数据库中提取它。您可以为该任务编写一个自定义插件。另一种选择是将字段标签放在全局模板变量中。

**编辑：** 我很快为你创建了插件——你可以在[https://github.com/Stoep/pi.field_information](https://github.com/Stoep/pi.field_information)获取它，将它放在 third_party/field_information/

用法：
{exp:field_information channel="news" field_name="news_content" information="field_label"} {exp:field_information channel="news" field_name="news_content" information="field_instructions"}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:01:10.967

您可能可以通过 SQL 查询标签来完成此操作，但一般来说，分配给后端字段的标签仅供在条目发布/编辑屏幕中使用。将内容输入系统的人看到的这些字段的标签可能不一定是您希望在前端向您的网站访问者显示的相同标签。

就像@stoep 提到的那样，如果在您的模板中编写 SQL 查询标签最终不是一个可行的选择，您可能会更幸运地编写一个自定义插件来处理这个问题。

# ftp - FTP：无法连接到远程服务器

> ID：12642282
> 
> 赞同：0
> 
> 时间：2012-09-28T14:47:38.790
> 
> 标签：ftp

我有一个网站，用于将图像上传到服务器，最终将它们从服务器上传到 FTP 站点。问题是它通过传输获得了一部分 - 它传输了一些文件然后停止并给出错误

```
Unable to connect to the remote server 
```

这只发生在 1 个 ftp 服务器上。我有第二个 ftp 服务器，这个过程可以正常工作，所以我怀疑这是一个代码问题。可能是什么问题？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:53:21.227

一些 FTP 服务器会阻止洪水请求，从而中断连接。您应该尝试使用另一个 FTP 客户端和/或压缩所有文件，发送到服务器并使用 SSH 或其他可用方法从服务器解压缩它们。

注意：推荐 FileZilla 客户端。

# c# - 如何从另一个类访问一个类中的属性

> ID：12642283
> 
> 赞同：0
> 
> 时间：2012-09-28T14:47:39.383
> 
> 标签：c#, asp.net, .net, c#-4.0, constructor

我在“FileData.cs”文件中的构造函数代码：

```
public FileData(BatchData batch)
{
    this._batch = batch;
} 
```

我想从“FileData.cs”文件中访问属性。所以，我使用了以下代码：

```
FileData fd = new FileData(); 
```

它将错误消息显示为“构造函数不接受 0 个参数”。我不知道如何从类中访问属性。给我一个解决方案。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:48:47.123

您没有默认构造函数。您必须包含一个，因为默认情况下编译器不会生成一个。

基本上，由于您使用参数定义了一个显式构造函数，编译器不会生成默认构造函数，因此您的错误。

或者：

```
FileData fd = new FileData(new BatchData()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:49:41.260

您需要显式添加无参数构造函数

```
public FileData()
{
}

public FileData(BatchData batch)
{
    this._batch = batch;
} 
```

考虑到如果`_batch`类实例需要字段才能执行必要的操作，则需要在无参数构造函数上对其进行初始化

```
public FileData()
{
    this._batch = new BatchType;
} 
```

或使用公共财产公开它。

```
public BatchType Batch 
{
     get { return _batch; }
     set {_batch = value }
} 
```

您可以使用自动属性来简化您的代码

```
public BatchType Batch { get; set }

public FileData(BatchData batch)
{
   this.Batch = batch;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:54:39.730

错误消息相当明确。`FileData`不传入任何数据就无法构造对象。您需要在它的构造函数中为其提供一个`BatchData`实例，以便创建一个新的`FileData`. 假设这种行为是有意的，那么您将需要创建 的新实例`BatchData`，或访问现有实例，并使用它来构造对象。

如果问题是你应该能够在`FileData`不需要实例的情况下构造一个实例，`BatchData`那么你需要添加一个`FileData`不带参数的新构造函数。如果您这样做，您帖子中的代码将再次起作用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:55:20.903

1）您应该将参数 BatchData 传递给您的类。

```
BatchData bd = new BatchData();
FileData fd = new FileData(bd); 
```

2) 要访问财产，您可以...

a)...只是公开：

```
class FileData
{
public BatchData _batch;

public FileData(BatchData batch)
{
    this._batch = batch;
}
} 
```

并访问您的财产，例如

```
fd._batch; 
```

b) 或者你可以编写 getter 和 setter

```
class FileData
{
private BatchData _batch {get; set;}

public FileData(BatchData batch)
{
    this._batch = batch;
}
} 
```

并访问

```
BatchData bd = fd.getbd();
fd.setbd(bd); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T14:55:30.937

您应该为 FileData 类定义默认构造函数：

```
public FileData()
    {

    } 
```

对于访问属性：当您定义公共属性时，您可以从 anthor 类访问此属性。

# android - 更改签名密钥，保留包名

> ID：12642293
> 
> 赞同：10
> 
> 时间：2012-09-28T14:48:17.690
> 
> 标签：android, certificate, google-play, signing

我似乎找不到答案：是否可以更改签名密钥但仍使用相同的包名？这样购买我的应用程序的人就可以使用新密钥从同一个 Google Play 页面“重新下载”该应用程序。

这样做的背景是我想将我的签名密钥延长到我现在设定的 25 年以上。也许这已经足够了，但我不想陷入密钥过期的情况。

如果这是不可能的，我可以删除我当前的 Google Play 应用程序并创建一个具有相同包名和另一个密钥的新应用程序吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T14:58:07.467

不可以。如果您的 APK 使用签名进行了签名，并且包含安装在设备上的包名称，则任何后续具有相同包名称的 apk 都必须具有相同的签名。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-01-06T19:21:14.763

**截至 2019 年**

是的，在某些情况下您可以这样做。

如果您已启用`Manage Signing Key by Google`，那么您的签名密钥将由 Google 管理，您可以添加一个额外的 `Upload Key`，您可以在必要时更改/更新。Google 推荐此程序，此程序适用于新应用程序和已发布的应用程序。

如果您自己管理签名密钥，您仍然可以在应用程序的整个生命周期内只升级一次签名密钥。拥有旧密钥的用户将能够使用旧签名密钥来使用和更新应用程序，而新用户将能够使用升级后的密钥。以下是参考文献中引用的内容：

> 在某些情况下，您可以请求应用签名密钥升级。您的新密钥用于签署新的安装和应用更新。您的旧应用签名密钥仍用于为在密钥升级之前安装您的应用的用户签署更新。
> 
> 每个应用程序在其生命周期内只能升级其应用程序签名密钥一次。万一您有多个应用程序使用相同的签名密钥专门在同一进程中运行，您将无法对这些应用程序使用密钥升级。

详细说明[here](https://support.google.com/googleplay/android-developer/answer/7384423)

# android - 清除画布区域

> ID：12642295
> 
> 赞同：3
> 
> 时间：2012-09-28T14:48:27.933
> 
> 标签：android

我制作了一个从 xml 布局中引用的自定义视图。我添加了一个用于清除视图的按钮。现在我想在点击时清除画布区域。我在 xml 布局文件中添加了一个 onClick 事件。现在如何在哪里添加清除整个视图/画布的代码？我刚刚添加了几部分代码。（这并没有清除任何东西）。我按如下顺序添加了我的活动、视图和布局文件。

```
public class CustomViewActivity extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

    }

    public void clearLine(View v) {

    new CustomView(CustomViewActivity.this, null).clearCanvas();        
  } 

}

public class CustomView extends View {

    private Paint paint = new Paint();
      private Path path = new Path();
      public Boolean clearCanvas = false;

      public CustomView(Context context, AttributeSet attrs, int defStyle) {
            super(context, attrs, defStyle);         
        }

    public CustomView(Context context,AttributeSet attrs ) {
        super(context,attrs);
        paint.setAntiAlias(true);
        paint.setColor(Color.BLUE);
        paint.setTextSize(20);
        paint.setStyle(Paint.Style.STROKE);
        paint.setStrokeJoin(Paint.Join.ROUND);
        paint.setStrokeWidth(5f);
    }

    protected void onDraw(Canvas canvas) {
    if(clearCanvas)
        {  // Choose the colour you want to clear with.
            canvas.drawColor(Color.TRANSPARENT, PorterDuff.Mode.CLEAR);
            //canvas.drawColor(0, Mode.CLEAR);
            clearCanvas = false;            
        }

        super.onDraw(canvas);
        canvas.drawText("Hello World", 5, 30, paint);
        canvas.drawPath(path, paint);

    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {

    //int action = event.getAction() & MotionEvent.ACTION_MASK;

       float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
            path.moveTo(eventX, eventY);

            return true;
          case MotionEvent.ACTION_MOVE: 
            path.lineTo(eventX, eventY);
            break;
          case MotionEvent.ACTION_UP:
            // nothing to do 
           break;
          default:
            return false;
        }

        // Schedules a repaint.
        invalidate();
        return true;

    }
    public void clearCanvas(){

            clearCanvas = true;
            postInvalidate();
            //canvas.drawColor(0, Mode.CLEAR);

        }

}

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

           <com.example.CustomViewEvent.CustomView
               android:id="@+id/customView"
               android:layout_width="fill_parent"
               android:layout_height="wrap_content" />

           <Button
               android:id="@+id/button1"
               android:layout_width="wrap_content"
               android:layout_height="wrap_content"
               android:layout_alignParentBottom="true"
               android:layout_centerHorizontal="true"
               android:layout_marginBottom="28dp"
               android:onClick="clearLine"
               android:text="CLEAR" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:53:12.800

您需要做的是在 onDraw 方法中访问画布。

因此，如果您使用全局变量，请在您的按钮单击方法中，将其设置为 true。在 OnDraw 中，您可以检查其状态并在必要时清除画布。（然后将其设置回false，这样它就不会每次都这样做）。

有关用法，请参见下面的代码。

```
public Boolean clearCanvas = false;

protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        if(clearCanvas)
        {  // Choose the colour you want to clear with.
            canvas.drawColor(Color.TRANSPARENT, PorterDuff.Mode.CLEAR);
            clearCanvas = false;
        }
        canvas.drawPath(path, paint);       
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {

    float eventX = event.getX();
        float eventY = event.getY();

        switch (event.getAction()) {
          case MotionEvent.ACTION_DOWN:
            path.moveTo(eventX, eventY);

            return true;
          case MotionEvent.ACTION_MOVE: 
            path.lineTo(eventX, eventY);
            break;
          case MotionEvent.ACTION_UP:
            // nothing to do 
           break;
          default:
            return false;
        }

        // Schedules a repaint.
        invalidate();
        return true;

    }
// this is the method which will be invoked from main activity class for clearing whatever //is in the view/canvas 
         public void clearCanvas(){

            //canvas.drawColor(0, Mode.CLEAR);

            clearCanvas = true;
            invalidate();
        }

} 
```

**编辑：** 查看您的新代码，我发现了一些问题。

我认为它围绕着你没有清除正确观点的事实。

首先，获取现有视图的实例。然后你可以清除它。而不是错误的不存在的实例。

```
 CustomView cv = (CustomView)findViewById(R.id.customView); 
 cv.clearCanvas(); 
```

尝试`invalidate();`其他`postInvalidate();`一个应该工作。

`postInvalidate()`适用于在非 UI 线程上运行时。

# php - 带有提交到 php 的 HTML 表单。显示 php 响应

> ID：12642297
> 
> 赞同：0
> 
> 时间：2012-09-28T14:48:29.873
> 
> 标签：php, html

我正在尝试为我的网站实施“重置密码”页面。到目前为止，我有一个简单的页面，其中有一个表单供用户输入他们的电子邮件地址。提交表单会调用“requestpasswordreset.php”，它会执行诸如检查是否存在使用该电子邮件的用户、发送密码重置电子邮件等操作。

```
<body>
<form name="input" action="requestpasswordreset.php" method="post">
    Email Address: <input type="text" name="email"> </br>
    <input type="submit" value="Submit"></form>
</body> 
```

requestpasswordreset.php 伪代码

```
if no user with email = $_POST['email']
    echo 'No user exists with this email';
else
   ...
   doStuff();
   echo 'Password reset email sent'; 
```

我想知道如何执行以下操作：

如果用户输入了无效的电子邮件地址，表单将保持可见并显示错误消息。

如果请求成功，表单将被隐藏，并会显示一条消息，如“成功”。

在任何一种情况下，重定向到新页面似乎都是不必要/不好的做法？而不仅仅是更新当前的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:51:24.443

如果出现错误，您只需输出相同的 HTML，并从您的 PHP 脚本中添加错误消息。如果成功，您可以将它们重定向到其他地方，或者将它们保留在您认为合适的同一页面上。我可能会将他们带回登录表单，并亲自添加成功消息，以便他们在收到您的电子邮件后轻松登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:51:47.577

为什么不尝试将表单提交到同一页面？然后

```
if (isset($_POST['email']) /** and user exists **/) {
  /** do whatever you need to do **/
} else {
  /** display the form **/
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:53:32.567

重定向或以其他方式进行[回](http://en.wikipedia.org/wiki/Postback)发并不是坏习惯。您正在寻找的解决方案称为 AJAX，两种解决方案同样可行。您可以使用 javascript （可能还有[jquery](http://api.jquery.com/jQuery.post/)）来查询服务器，然后根据服务器的响应隐藏表单/给出错误消息。

如果这是您的问题，您将无法验证或发送电子邮件，而无需仅以 html 和 php 回发。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-28T14:54:17.203

你可以这样做：

在你的 php 代码上：

> 如果（电子邮件错误） echo"window.location.href='yourformpage.php?email=wrong'"; 否则 doStuff();

并在您的表单页面中：

> if(isset($_GET['email']) AND $_GET['email'] == '错误')
> 
> echo "显示错误信息";

# iphone - 将图像从 plist 保存到图库

> ID：12642304
> 
> 赞同：0
> 
> 时间：2012-09-28T14:48:57.453
> 
> 标签：iphone, ios, xcode, ios5, ios6

plist文件存放在其中图片以scroll-view显示，制作按钮“保存”，需要代码帮助。请！！

这样做，即会“保存”按钮，保存我所在的图片。例如：我在5号图片，点击“保存”，5号图片保存到图库，我在21号图片，点击“保存”，21号图片保存到图库

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:56:24.597

如果您想创建一些照片库应用程序，请查看此开源[示例](https://github.com/mwaterfall/MWPhotoBrowser)。

由 Michael Waterfall 创建，其中包括来自存储在服务器或本地的图像的照片库。

从服务器下载 plist 并以所需格式提供画廊应用程序的 url，然后显示示例中给出的画廊视图。

为了将图像保存到用户的相册中，在示例代码中，该类`PhotoBrowserController`处理图库任务，其中包含下一张、当前、上一张照片的索引。

使用图像从保存的缓存中获取图像并将其保存到用户相册中

`UIImageWriteToSavedPhotosAlbum(saveImage,self,nil,nil);`

查看示例应用程序并完成流程，您将了解如何根据您的要求进行修改。

# object - 在学说 2 DQL 中使用对象与标识符

> ID：12642306
> 
> 赞同：3
> 
> 时间：2012-09-28T14:49:01.943
> 
> 标签：object, doctrine-orm, dql, identifier

所以我和我的朋友正在讨论是否在 DQL 中使用 object 或 id 我在互联网上搜索但我在学说文档中找不到任何东西来查看哪个是最佳实践所以问题是这样的想象你有 Category 对象你想要获得价格低于 10 的产品，因此为了获得更好的性能，您在产品存储库中创建 DQL 并传递 $category 对象我的朋友说我们应该传递 $category->getId() 并像这样按 Id 搜索

```
public function findCheapProducts($categoryId){
return $this->createQueryBuilder('p')
            ->where('p.category = :categoryId')
            ->andWhere('p.price < :price')
            ->setParameters(array(
                'categoryId' => $categoryId,
                'price'      => 10
            ));
} 
```

但我说的是这样的

```
public function findCheapProducts(Category $category){
return $this->createQueryBuilder('p')
            ->where('p.category = :categoryId')
            ->andWhere('p.price < :price')
            ->setParameters(array(
                'categoryId' => $category,
                'price'      => 10
            ));
} 
```

我在这里写了代码，所以错误或事情对我来说并不重要目标是看看哪个是通过标识符放置条件的更好方法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-02T18:32:32.203

我根据用户输入混合两者。当我已经有了对象时，我会传递它，如果我只有在表单提交之后的 ID，我会传递 ID，因为加载模型只是为了将它传递给查询构建器是无稽之谈。（ofc。在这种情况下，您需要正确的表单验证以避免错误的 ID）

# php - 将从 AJAX 发送的多个值插入 sql 数据库

> ID：12642317
> 
> 赞同：1
> 
> 时间：2012-09-28T14:49:43.563
> 
> 标签：php, javascript, ajax

嗨，这个代码可以完美地使用价值：

```
 <script type="text/javascript">
    $(document).ready(function() {
    $("input[type=button]").click(function () {
    var textarea_content = $('textarea#wall').val(); // get the content of what user typed    (in textarea) 
    if (textarea_content != '') { // if textarea is not empty 
    var sender =  "<?php echo $_SESSION['user_id'];?>";

     $.ajax({
            type: "POST",
            url: "send_message_function.php",
            data : "action=send&from_id="+sender+"&to_user="+$(this).siblings("input[type=text]").val()+"&message="+textarea_content,
            dataType: "json",
            success: function (data) {
               var  LastID = data["cid"];
               alert("toUser: " + $(this).siblings("input[type=text]").val()+"and text area " + textarea_content + " message id: " + LastID);
                                     }
        });//end success function

        //do something else

        } else {
        alert('Enter some text ! '); // just in case somebody click on share witout writing anything :)
    }
    });//end click function
    });//end ready function
    </script> 
```

和 send_message_function.php ：

```
<?php
 require 'core/functions/init.php';

 $action  = $_POST['action'];
 if($action=="send"){
 $from_id = mysql_real_escape_string($_POST['from_id']);
 $to_id = mysql_real_escape_string($_POST['to_user']);
 $message = strip_tags($_POST['message']);

 $sql = mysql_query("INSERT INTO chat (from_id, to_id, message,   dt)VALUES('$from_id','$to_id','$message',NOW())") or die("0");

 echo json_encode(array("cid"=>(mysql_insert_id()),
                               "from_id"=>''.$message_id.''));
}
    ?> 
```

问题是当我尝试将消息发送给多个用户时。sql 查询尝试在同一行中插入所有用户 ID。我知道我应该做一些循环，但我想不出如何为我想向其发送消息的每个用户运行查询。

```
$(this).siblings("input[type=text]").val() 
```

像这样返回多个用户 ID：113,143,234

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:56:35.080

您不需要循环，只需一个查询即可进行多次插入，如下所示：

```
 $to_id = explode(',', mysql_real_escape_string($_POST['to_user'])); //split the string to an array containing each id

 $sql = mysql_query("INSERT INTO chat (from_id, to_id, message, dt) VALUES('$from_id','$to_id[0]','$message',NOW()), ('$from_id','$to_id[1]','$message',NOW()), ('$from_id','$to_id[2]','$message',NOW()) ") or die("0"); 
```

注意：`$from_id`不应该是主键，否则会出现重复键错误。

编辑：如果你不知道没有。的用户，

```
 $to_id = explode(',', mysql_real_escape_string($_POST['to_user']));

   foreach ($to_id as $v)
     $sql = mysql_query("INSERT INTO chat (from_id, to_id, message, dt) VALUES('$from_id','$v','$message',NOW()) ") or die("0"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:55:19.150

要在一个 SQL 查询中插入多行，请执行以下操作

```
INSERT INTO foo(a, b) VALUES('c', 'd'), ('e', 'f'), ('h', 'i'); 
```

您需要循环构建每个 VALUES 集，但您可以在单个查询中进行插入。

所以像

```
<?php
    $to_id = explode(',', mysql_real_escape_string($_POST['to_user']));

    $sql = 'INSERT INTO chat (from_id, to_id, message) VALUES';
    foreach ($to_id as $id)
    {
        $sql .="('$from_id', '$id', '$message'),";
    }
    rtrim($sql, ','); //strip the final comma
?> 
```

这应该形成一个查询

```
INSERT INTO chat(from_id, to_id, message) VALUES('1', '2', 'hello from php'), ('1', '3', 'hello from php'), ('1', '4', 'hello from php') 
```

这样做意味着只发送一个查询：因此与数据库通信的开销更少，这将加快您的脚本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T14:54:43.583

您需要将用户 ID 字符串拆分为逗号字符，然后对创建的每个值执行查询。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T14:59:20.507

```
$toIDS = explode(',', mysql_real_escape_string($_POST['to_user']));
foreach($toIDS as $ID){
    $query=mysql_query("INSERT INTO foo(a, b) VALUES('c', 'd')");
    echo (mysql_affected_rows()>0)?$ID .'INSERTED':$ID.' NOT INSERTED';
} 
```

# bash - Bash 仅将输出重定向到变量

> ID：12642320
> 
> 赞同：0
> 
> 时间：2012-09-28T14:49:46.363
> 
> 标签：bash, stdout

我有一个功能：

```
function getXpath {
    QUERY=$1
    XMLPATH=$2
    XPATH_QUERY=`echo $XPATH_FORMAT | sed -e "s|{query}|"$QUERY"|g" | sed "s|{file}|"$XMLPATH"|g"`
    xpath $XPATH_QUERY
} 
```

我想这样称呼它：

> value=`getXpath "$2" "$XMLPATH"`

值设置好，问题是结果也在控制台中写入。

我怎样才能只设置为 var 而不是写入控制台？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:05:35.897

```
xpath $XPATH_QUERY 2>/dev/null 
```

# java - XStream 删除集合中不需要的字段

> ID：12642326
> 
> 赞同：2
> 
> 时间：2012-09-28T14:49:59.807
> 
> 标签：java, xml, hibernate, xstream

我有一个对象“角色”，它可以包含几个“特权”，它们也是对象。现在，当我尝试使用 Xstream 序列化 Role 时，我的 xml 看起来像这样：

```
 <role>
    <roleName>Administrator</roleName>
    <privileges class="org.hibernate.collection.PersistentSet">
      <set>
        <privilege>
          <privilegeId>1001</privilegeId>
          <privilegeName>Admin Privilege</privilegeName>
          <privilegeKey>Admin</privilegeKey>
        </privilege>
      </set>
      <initialized>true</initialized>
      <owner class="role" reference="../.."/>
      <cachedSize>-1</cachedSize>
      <rolemodel.valueobject.Role.privileges</role>
      <key class="int">3</key>
      <dirty>false</dirty>
      <storedSnapshot class="map">
        <entry>
          <privilege reference="../../../set/privilege"/>
          <privilege reference="../../../set/privilege"/>
        </entry>
      </storedSnapshot>
    </privileges>
  </role> 
```

我希望它看起来像这样：

```
 <role>
    <roleName>Administrator</roleName>
    <privileges>
          <privilegeId>1001</privilegeId>
          <privilegeName>Admin Privilege</privilegeName>
          <privilegeKey>Admin</privilegeKey>
    </privileges>
  </role> 
```

我如何省略/删除/不包括所有这些附加字段？似乎它们是由休眠添加的“实用程序”字段，因为我没有在我的 hbm.xml 中声明它们。我已经尝试省略它们，将 Privileges 集合添加为隐式以及我在 XStream 页面上找到的其他内容。

**编辑** 我未能按照下面的建议创建 XSLT 模板，但发现自定义转换器是完成这项工作的非常好的简单工具。在此处查看帮助页面 - [http://x-stream.github.io/converter-tutorial.html](http://x-stream.github.io/converter-tutorial.html)。这是我的元帅方法：

```
public void marshal(Object value, HierarchicalStreamWriter writer,
                    MarshallingContext context) {
    Role role = (Role) value;
    writer.startNode("roleId");
    writer.setValue(role.getRoleId().toString());
    writer.endNode();
    writer.startNode("roleName");
    writer.setValue(role.getRoleName());
    writer.endNode();
    writer.startNode("privileges");
    for (Privilege privilege : role.getPrivileges()){
        writer.startNode("privilege");
        writer.setValue(privilege.getPrivilegeName());
        writer.endNode();
    }
    writer.endNode();
} 
```

它产生的xml：

```
 <role>
    <roleId>3</roleId>
    <roleName>Web Administrator</roleName>
    <privileges>
      <privilege>Web Access</privilege>
    </privileges>
  </role> 
```

# web-services - Drupal 7：显示来自 Web 服务的数据

> ID：12642332
> 
> 赞同：2
> 
> 时间：2012-09-28T14:50:26.877
> 
> 标签：web-services, drupal-7

我正在使用 Drupal 7，我需要从 Web 服务中检索数据。由于规定，这些数据不能存储在 Drupal 数据库中。检索这些数据的最佳实践是什么：使用 Java、Drupal 实体或存储在令牌中？

我们目前正在根据存储在数据库中的 ID 进行调用，并显示来自与该 ID 关联的 Web 服务的数据。

问题是这一切都是在 Drupal 之外完成的，我们无法使用 Drupal 来管理任何此类内容。所以我们有许多带有自定义代码的模块来完成从创建表单、预填充表单、绑定到 Drupal 上的用户帐户等所有工作。

我们正处于可以完全重构其工作方式的地步。

您对我们如何改进这一点有什么建议吗？

注意：我们需要存储的数据量会很大。我在想也许我们可以围绕 Web 服务数据创建一个实体，然后通过添加标记作为默认值来显示与字段相关的数据。存储在数据库中的 ID 将更改通过令牌显示的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T09:38:36.413

如果我正确理解您的问题，那么您的重构不应该是将数据存储在 drupal 中。几个月前我需要制作一个定位服务站点，并且需要使用 Google Maps API 来填充缺失的地理位置数据。

像这样的结构怎么样：您使用普通的 drupal 节点和用户制作表单和数据（用户、节点类型等）。然后，使用 hook_node_insert、hook_node_update 和 hook_node_load，您可以强制 drupal 向其他服务提交或检索信息。hook_node_presave 在将用户输入保存到drupal数据库之前清除用户输入非常有用（请注意，插入钩子将在presave之后调用。）。

您仍然可以使用 drupal 创建表单、存储必要的数据等。

另请注意，视图模块不适用于此。检查查看数据源模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-10T15:30:11.520

好吧，我想你当然可以从一个自定义模块开始，创建一个 hook_menu() 和一个 url 来“解析”你通过服务获得的信息。创建额外的表来存储你的数据 - 如果它太大，可能会被序列化. 使用 Schema 模块在模块中正确创建 mymodule.install 文件。

它是 XML 服务吗？使用[cURL](http://php.net/manual/en/book.curl.php)，在此 menu() 的回调中使用 db_query 将数据存储在表中。

从那里我想你可以玩弄所有漂亮的[drupal钩子](http://api.drupal.org/api/drupal)来显示和操作你的数据

# c#-4.0 - 未处理的异常：在单声道上运行时的 System.TypeLoadException，在 .NET 4 上编译

> ID：12642333
> 
> 赞同：0
> 
> 时间：2012-09-28T14:50:29.090
> 
> 标签：c#-4.0, mono

我用 C# 编写了一个小应用程序，它没有问题。目标框架是 .NET 4。

当我在 linux - mono 下运行应用程序时，应用程序启动没有问题。

但是，我似乎对单声道下的线程有问题。

下面的代码：

```
 try
                {
                    Thread oThread = new Thread(new ParameterizedThreadStart(this.SendSms));
                    oThread.IsBackground = true;
                    oThread.Start(_data);

                    while (!oThread.IsAlive)
                    {
                        Console.WriteLine("Sleeping...");
                        Thread.Sleep(1);
                    }

                }
                catch (TypeLoadException tlex)
                {
                    Console.WriteLine("TypeLoadException: " + tlex.Message);

                }
                catch (Exception ex)
                {
                    Console.WriteLine(ex.Message);
                } 
```

它似乎没有到达 SendSms 方法，而是抛出以下错误：

```
Unhandled Exception: system.TypeLoadException: A type load exception has occurred. at System.Threading.Thread.StartUnsafe () [0x00000] in <filename unknown>:0
[ERROR] FATAL UNHANDLED EXCEPTION: System.TypeLoadException: A type load exception has occurred. at System.Threading.Thread.StartUnsafe () [0x00000] in <filename unknown>:0 
```

现在我是 Mono 的新手，所以首先不知道为什么会发生这个未处理的异常，因为参数化线程的代码来自“http://www.mono-project.com/ThreadsBeginnersGuide”。其次，为什么当我放入 catch 时它没有处理（TypeLoadException tlex）

请协助。

谢谢

尼尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-26T13:40:20.767

我在运行 debian 挤压的 Web 服务器上遇到了类似的问题。 [这篇文章](http://picoe.ca/forums/topic/typeloadexception-running-pablodraw-3-1-2-in-ubuntu-12-04-64-bit/)给了我一个线索。

我设置了一个虚拟机并使用 apt-get 安装了整个 monodevelop，它工作正常。因为我不想在生产机器上安装那么多包和依赖项，所以我花了几个小时来隔离丢失的包。

就我而言，它们仅缺少 3 个软件包（libmono-system-xml-linq4.0-cil、libmono-system-componentmodel-dataannotations4.0-cil 和 libmono-system-componentmodel-composition4.0-cil），但当然，这将取决于您的应用程序。

根据错误信息，想出解决办法并不容易！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:48:07.657

可能这个答案可以帮助你..

[Mono-LibreOffice System.TypeLoadException](https://stackoverflow.com/questions/10029620/mono-libreoffice-system-typeloadexception)

您是否尝试过在单声道下编译相同的程序并尝试运行它？

还有你用的是哪个版本的单声道？？可能需要将其更新到最新版本。

> 单--版本

v 2.10 看起来是最新的稳定版本。
[http://www.go-mono.com/mono-downloads/download.html](http://www.go-mono.com/mono-downloads/download.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-02T11:53:45.057

虽然通过安装丢失的包解决了这个问题，但我注意到在通过 Nuget 引用 DLL 时您也可能会收到此错误：Monodevelop 没有将这些 DLL 复制到输出文件夹（即 /bin/Debug），这使我的程序无法运行。调试器甚至无法进入第一行代码！这在 Ubuntu 16.04 上发生在我身上。检查您的输出文件夹，如果您发现某些 DLL 丢失，您应该尝试手动复制它们并查看您的应用程序现在是否运行。

# jboss - JAXB-WS - 使用 @WebMethod 强制字段

> ID：12642335
> 
> 赞同：7
> 
> 时间：2012-09-28T14:50:34.147
> 
> 标签：jboss, annotations, jax-ws

我有一个@WebMethod 调用

```
@WebMethod
public int cancelCampaign(String campaignId, String reason); 
```

我想将campaignId 字段标记为必填项。不知道该怎么做。

我正在使用 JBOSS 7.1 服务器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-08-13T03:07:21.020

我有类似的要求，从 SoapUI 我注意到我得到了

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
     xmlns:bus="http://business.test.com/">
  <soapenv:Header/>
  <soapenv:Body>
     <!-- optional -->
     <bus:addItem>
        <bus:item>
           <id>?</id>
           <!-- optional -->
           <name>?</name>
        </bus:item>
        <!-- optional -->
        <itemType>?</itemType>
     </bus:addItem>
  </soapenv:Body>
</soapenv:Envelope> 
```

代替

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" 
     xmlns:bus="http://business.test.com/">
  <soapenv:Header/>
  <soapenv:Body>
     <bus:addItem>
        <bus:item>
           <id>?</id>
           <name>?</name>
        </bus:item>
        <itemType>?</itemType>
     </bus:addItem>
  </soapenv:Body>
</soapenv:Envelope> 
```

JAX-WS Metro 2.0 RI 中的一个出路是使用注释每个参数

```
@XmlElement( required = true ) 
```

就我而言，我必须对所需的 WebMethod 参数和所有所需的自定义类型的 getter 执行此操作，如下所示：

## 在网络服务中：

```
...
 @WebMethod( operationName = "getItems" )
   @WebResult( name = "item" )
   public List<Item> getItems(
     @WebParam( name = "itemType" ) @XmlElement( required = true ) String itemType );
... 
```

## 在我的 POJO 课程中：

```
@XmlAccessorType(XmlAccessType.FIELD)
public class Item implements Serializable
{
   private static final long serialVersionUID = 1L;

   @XmlElement( required = true )
   private int               id;

   @XmlElement( required = true )
   private String            name;

   /**
    * Default constructor.
    */
   public Item() { }

   /**
    * @return the id
    *
    */       
   public int getId()
   {
      return id;
   }

   /* setter for id */

   /**
    * @return the name
    */
   public String getName()
   {
      return name;
   }

   /* setter for name */

} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T15:17:02.793

做到这一点的唯一方法`JAX-WS`是编写一些包装类来指定注释`required=true`上的标志。`XmlElement`您的请求元素应如下所示：

```
@XmlType(name="YourRequestType", propOrder={"campaignId", "reason"})
public class YourRequest {
    @XmlElement(name="campaignId", required=true)
    private String campaignId;
    @XmlElement(name="reason", required=false)
    private String reason;

    //Getters and setters        

} 
```

您的 Web 方法应如下所示：

```
@WebMethod
public int cancelCampaign(@WebParam(name = "request") YourRequest request) {
   String campaignId = request.getCampaignId();

   return 0;
} 
```

这将告诉在您的for元素`JAXB`中生成。`minOccurs=1``XSD``campaignId`

# xcode - IOS 6 上不显示导航返回按钮

> ID：12642339
> 
> 赞同：1
> 
> 时间：2012-09-28T14:50:42.220
> 
> 标签：xcode, uinavigationcontroller, ios6

当我尝试在 IOS 6 上运行它时，我现在有一个运行良好的应用程序。现在导航控制器上的后退按钮似乎没有出现。我试过了 ：

```
self.navigationItem.hidesBackButton = NO; 
```

在视图中，只有导航标题，但我无法返回上一个视图。有什么建议么 .. ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:59:29.337

你在使用故事板吗？如果是这样，请确保您在导航控制器中嵌入了视图。如果您不使用它，请告诉我。

# winforms - DataGridView 自定义列标题内容（复选框控件）

> ID：12642348
> 
> 赞同：0
> 
> 时间：2012-09-28T14:51:23.303
> 
> 标签：winforms, datagridview, customization

是否可以将“检查所有”功能添加到 WinForms *DataGridView*的*DataGridViewCheckBoxColumn*？

它应该如下所示：

![在此处输入图像描述](../Images/09f642a10dc611e3eb129c78d9347fe1.png)

单击突出显示的复选框应选中/取消选中网格中的所有复选框。

如我所见，列标题只能包含字符串值。有什么解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T14:57:29.130

试试这个：[http ://tech.chitgoks.com/2008/11/17/c-add-select-all-deselect-all-checkbox-in-column-header-in-datagridview-control/](http://tech.chitgoks.com/2008/11/17/c-add-select-all-deselect-all-checkbox-in-column-header-in-datagridview-control/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:53:49.507

最终实现主要是解决方案，由 Samir 在[本文](http://www.codeproject.com/Articles/42437/Toggling-the-States-of-all-CheckBoxes-Inside-a-Dat)中提出。

但是当网格水平滚动条移动时，它需要修复复选框位置。因此，以下是需要更改的方法：

```
private void frmSelectAll_Load(object sender, EventArgs e)
{
    AddHeaderCheckBox();

    HeaderCheckBox.KeyUp += new KeyEventHandler(HeaderCheckBox_KeyUp);
    HeaderCheckBox.MouseClick += new MouseEventHandler(HeaderCheckBox_MouseClick);
    dgvSelectAll.CellValueChanged += new DataGridViewCellEventHandler(dgvSelectAll_CellValueChanged);
    dgvSelectAll.CurrentCellDirtyStateChanged += new EventHandler(dgvSelectAll_CurrentCellDirtyStateChanged);
    dgvSelectAll.CellPainting += new DataGridViewCellPaintingEventHandler(dgvSelectAll_CellPainting);

    BindGridView();

    var checkboxHeaderCellRect = dgvSelectAll.GetCellDisplayRectangle(0, -1, false);
    headerCheckboxRightMargin = (checkboxHeaderCellRect.Width - HeaderCheckBox.Width)/2;
}

private int headerCheckboxRightMargin;

private void ResetHeaderCheckBoxLocation(int ColumnIndex, int RowIndex)
{
    //Get the column header cell bounds
    Rectangle oRectangle = this.dgvSelectAll.GetCellDisplayRectangle(ColumnIndex, RowIndex, false);

    Point oPoint = new Point();

    oPoint.X = oRectangle.Location.X + (oRectangle.Width - headerCheckboxRightMargin - HeaderCheckBox.Width);
    oPoint.Y = oRectangle.Location.Y + (oRectangle.Height - HeaderCheckBox.Height) / 2 + 1;

    if (oPoint.X < oRectangle.X)
    {
        HeaderCheckBox.Visible = false;
    }
    else
    {
        HeaderCheckBox.Visible = true;
    }

    //Change the location of the CheckBox to make it stay on the header
    HeaderCheckBox.Location = oPoint;
} 
```

# google-apps-script - 如何在 48 小时后更改 Google 协作平台访问权限

> ID：12642352
> 
> 赞同：0
> 
> 时间：2012-09-28T14:51:35.940
> 
> 标签：google-apps-script, google-sites

我正在寻找一种功能来通知客户他们有 48 小时的时间下载一组文档，然后在 48 小时后删除客户对 Google 网站的访问权限。定时事件处理程序似乎并没有真正提供此功能？

```
function Remove_people( site_name, client_email ) {
    var domain = "mydomain.com" ;
    var site = SitesApp.getSite(domain, site_name );
    site.removeEditor( client_email );

    // Some counter-timer function??? 

    the_url = site.getUrl();

    //email a link to the client
    MailApp.sendEmail(client_email, 
                    "Your Documents are ready!", 
                    "Your documents are accessible for 48hrs at the url below: \n\n " +
                     the_url + "\n\n",                   
                    {name:"My Name"});*/

    Logger.log("Done!");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T14:59:55.733

您可以将电子邮件地址和时间戳存储在电子表格中或使用 scriptDB。在另一个函数中，根据当前时间检查此时间戳，如果 48 小时已过，则删除用户。您可以让第二个函数在设置为每小时左右运行的定时触发器下运行。

# teamcity - Team City Post Build 事件导致 Team City Build 失败

> ID：12642353
> 
> 赞同：0
> 
> 时间：2012-09-28T14:51:38.523
> 
> 标签：teamcity, xcopy

我有一个 Visual Studio 2010 项目，它有一个复制文件的命令。它在我的机器上运行良好，但导致 Team City 的构建失败。

我尝试按照此讨论 [http://devnet.jetbrains.net/message/5226990;jsessionid=DDE1BE4846DE75E5368364742913503E](http://devnet.jetbrains.net/message/5226990;jsessionid=DDE1BE4846DE75E5368364742913503E)的建议创建 bin 文件夹， 但没有任何乐趣。

这是命令：

mkdir "$(SolutionDir)IL.UserAdmin.Web\bin" xcopy /E /D /Q /Y "$(SolutionDir)Library\Oracle Data Access*.dll" "$(TargetDir)"

这是错误：

c:\WINDOWS\Microsoft.NET\Framework\v4.0.30319\Microsoft.Common.targets(3717, 9): 错误 MSB3073: 命令“mkdir”C:\eBusiness\Dev4.0\UserAdmin\IL.UserAdmin.Web \bin" 2>nul xcopy /E /D /Q /Y "C:\eBusiness\Dev4.0\UserAdmin\Library\Oracle Data Access*.dll" "C:\eBusiness\Dev4.0\UserAdmin\IL. UserAdmin.Web\bin\" 2>nul" 以代码 9009 退出。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:21:14.213

看起来可能在 TeamCity 构建代理环境的路​​径中找不到 xcopy.exe。我会验证 xcopy.exe 是否在构建代理上并且它在路径中。

通过将其添加到构建后步骤以在日志中回显路径，验证运行构建后步骤的环境的路径：

```
SET PATH 
```

如果 xcopy 在机器上但不在回显路径输出中的路径中，那么您需要在构建后步骤中使用完整路径，如下所示：

```
"%SystemRoot%\System32\xcopy.exe" 
```

或者，您可以修复代理上的 PATH 变量以确保 xcopy 在路径中。

# java - 使用 glassfish 部署/运行 java ee 的 dukesbank 示例应用程序

> ID：12642355
> 
> 赞同：0
> 
> 时间：2012-09-28T14:51:45.870
> 
> 标签：java, oracle, jakarta-ee, sample

我正在尝试运行此处的 dukesbank 示例应用程序。

[http://docs.oracle.com/javaee/5/tutorial/doc/bncna.html](http://docs.oracle.com/javaee/5/tutorial/doc/bncna.html)

我正在尝试从那里遵循以下说明：

```
Building, Packaging, and Deploying Duke’s Bank Using Ant

To compile and package the enterprise beans, application client, and web client into dukesbank.ear, go to the tut-install/javaeetutorial5/examples/dukesbank/ directory of the tutorial distribution and execute the command:

ant

Run the following command to deploy dukesbank.ear:

ant deploy

This task calls the create-tables task to initialize the database tables. 
```

1.  我正在使用 ubuntu 12.04。我已经安装了 glassfish 应用程序服务器，并且能够正确启动和停止它。我已经下载了javaeetutorial5。

2.  我在 javaeetutorial5/example/common/admin-passwd.txt 文件中写了 glassfish 的密码。

3.  我已经为 javaeetutorial5/examples/bp-project/build.properties.sample 文件中的参数赋值，然后我将文件重命名为 build.properties。

4.  现在，当我进入终端中的目录 javaeetutorial/example/dukesbank 并输入`"ant"`时，它工作正常。但是当我尝试输入“ `ant run`”时，它给了我以下信息：

    create-tables: [sql] Executing resource: /home/ragini/javaeetutorial5/examples/common/sql/javadb/tutorial.sql [sql] 181 个 SQL 语句中的 181 个成功执行

    ```
     deploy:
             [exec] Deprecated syntax, instead use:
             [exec] asadmin --user admin --passwordfile /home/ragini/javaeetutorial5/examples/common/admin-password.txt --host localhost --port 4848 deploy [options] ...
             [exec] Command deploy failed.
             [exec] Authentication failed for user: admin
             [exec] with password from password file: /home/ragini/javaeetutorial5/examples/common/admin-password.txt
             [exec] (Usually, this means invalid user name and/or password) 
    ```

请注意，在创建表之前，一切都成功执行，然后它给了我显示的错误。**有人可以告诉它实际上想说什么吗？**

我在 javaeetutorial/examples/bp-project/ 中的 build.properties 文件如下所示：

```
# Set the property javaee.home, using the path to your 
# GlassFish installation.
# C:/Program Files/glassfish-v3 is the GlassFish v3 default installation 
# path on Windows.
# 
javaee.home=/usr/local/glassfish-3.1.2.2

# Set the property javaee.tutorial.home to the location where you 
# installed the Java EE Tutorial bundle.
#
javaee.tutorial.home=/home/ragini/javaeetutorial5

# machine name (or the IP address) where the applications will be deployed.
javaee.server.name=localhost

# port number where GlassFish applications are accessed by users
javaee.server.port=8080

# port number where the Admin Console of GlassFish is available

javaee.adminserver.port=4848

# Uncomment the property javaee.server.username, 
# and replace the administrator username of the app-server 
javaee.server.username=admin

# Uncomment the property javaee.server.passwordfile, 
# and replace the following line to point to a file that 
# contains the admin password for your app-server. 
# The file should contain the password in the following line: 
#
# AS_ADMIN_PASSWORD=admin
#
# Notice that the password is adminadmin since this is 
# the default password used by GlassFish.
#
javaee.server.passwordfile=${javaee.tutorial.home}/examples/common/admin-password.txt

appserver.instance=server

# Uncomment and set this property to the location of the browser you 
# choose to launch when an application is deployed.
# On Windows and Mac OS X the OS default browser is used.
#default.browser=/Applications/Firefox.app/Contents/MacOS/firefox-bin

# Database vendor property for db tasks
# JavaDB is the default database vendor. See the settings in javadb.properties
db.vendor=javadb

# Digital certificate properties for mutual authentication
keystore=${javaee.tutorial.home}/examples/jaxws/simpleclient-cert/support/client_keystore.jks
truststore=${javaee.home}/domains/domain1/config/cacerts.jks
keystore.password=changeit
truststore.password=changeit 
```

我很确定 glassfish 的用户名和密码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-14T09:25:42.453

聚会迟到了，但这个答案可能仍然为其他有类似问题的人服务。

简而言之，您似乎试图在与 Ant 脚本不同的 Glassfish 版本上运行本教程。

为了解决这个问题，您必须对 /home/ragini/javaeetutorial5/examples/bp-project/app-server-ant.xml 文件进行调整。

特别是，寻找名称为“*部署*”的目标（在第 367 行附近）并更改

```
<exec executable="${asadmin}" failonerror="${failonerror}">
        <arg line=" deploy "/>
        <arg line=" --user ${javaee.server.username}" />
        <arg line=" --passwordfile ${javaee.server.passwordfile}" />
        <arg line=" --host ${javaee.server.name}" />
        <arg line=" --port ${javaee.adminserver.port}" />
        <arg line=" --name ${module.name}"/>
...
</exec> 
```

至

```
<exec executable="${asadmin}" failonerror="${failonerror}">
        <arg line=" --user ${javaee.server.username}" />
        <arg line=" --passwordfile ${javaee.server.passwordfile}" />
        <arg line=" --host ${javaee.server.name}" />
        <arg line=" --port ${javaee.adminserver.port}" />
        <arg line=" deploy "/>
        <arg line=" --name ${module.name}"/>
...
</exec> 
```

换句话说，这些年来部署命令的指令顺序似乎发生了变化。为了支持其他目标（例如，*undeploy*），您可能需要以类似的方式更改它们的目标。

# r - 带有标签线的自定义轴

> ID：12642363
> 
> 赞同：4
> 
> 时间：2012-09-28T14:52:22.800
> 
> 标签：r, label, line, margin, axis

我不知道如何表达这个问题，但我正在尝试将带有线条的标签添加到基本散点图上的相应点。到目前为止，我有以下内容：

```
example <- data.frame(name=paste("label_",1:200,sep=""),plot=rep(FALSE,200),rank=c(1:200),score=exp(seq(6,0,length.out=200)))
example$plot[c(1:3,7,8,35,37,150:155,183)] <- TRUE

plot(x=example$score,y=example$rank,ylim=rev(range(c(1:nrow(example)))),axes=FALSE,ylab="",xlab="Score",frame.plot=FALSE)
axis(side=1,labels=TRUE)
axis(side=2,labels=example$name[which(example$plot==TRUE)],at=example$rank[which(example$plot==TRUE)],las=1,tick=FALSE)
points(x=example$score[which(example$plot==TRUE)],y=example$rank[which(example$plot==TRUE)],col="Red",cex=1.5,pch=16) 
```

代码给出了以下情节：

![我目前拥有的。](../Images/6d2fc72851c171e4f5c62f37666f5b0a.png)

这对我的目的很有效，除了标签重叠非常严重。我正在寻找一种通用方法来制作如下图：

![我想拥有什么。](../Images/3ec33f9ae50327d6959117e0bfe3b920.png)

代码位于一个函数中，因此它需要适用于通用数据集的任何变化。我正在研究包`safeplot`中的代码`safe`，但到目前为止，我无法复制他们为解决类似问题所做的工作。

我现在也尝试使用包`linestack()`中的功能`vegan`。

```
par(mar=c(5,10,4,2))
plot(x=example$score,y=example$rank,ylim=rev(range(c(1:nrow(example)))),axes=FALSE,ylab="",xlab="Score",frame.plot=FALSE)
axis(side=1,labels=TRUE)
points(x=example$score[which(example$plot==TRUE)],y=example$rank[which(example$plot==TRUE)],col="Red",cex=1.5,pch=16)
linestack(x=example$rank[which(example$plot==TRUE)],labels=example$name[which(example$plot==TRUE)],add=TRUE,side="left",air=1.1,at=0,hoff=2) 
```

但是，`linestack()`只是给了我以下内容：

![在此处输入图像描述](../Images/75afe71451cec84c54a0879a8bd66aa8.png)

我尝试改变所有参数，但无法将标签分开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T14:59:33.287

这里有几个问题，特别是通常你不能在绘图区域之外绘制，因为剪裁会掩盖限制之外的任何东西（即在边距中）。您还需要在该边距中留出大量空间以容纳标签和线条。

虽然这比我现在在 SO 上可以做的工作要大，但我建议您查看**vegan**`linestack()`包中的函数以及它在方法中的使用方式。**`vegan:::plot.prc()`**

 **我最近使用 `linestack() 函数做了一些与您描述的非常相似的事情，以改进**glmnet**包中的一些图。如果您需要更多帮助，请回复评论，我将看到一起破解示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T17:04:07.743

查看`spread.labs`TeachingDemos 包中的`spread.labels`函数和 plotrix 包中的函数，了解选择标签放置位置的方法。

设置`par(xpd=NA)`将允许您使用`text`、`lines`和`segments`其他功能在绘图区域之外进行绘制。

此外，该功能`grconvertX`可能有助于找到标签和线段的水平位置。**

# silverlight - 等效于 Silverlight 项目中的 automapper

> ID：12642365
> 
> 赞同：2
> 
> 时间：2012-09-28T14:52:26.960
> 
> 标签：silverlight, reference, automapper

我有一个 Silverlight 5 项目。我想用 nugget 或添加对他的 ddl 的引用来安装 automapper。但他告诉我，只有具有 Silverlight 运行时的包才能添加到 Silverlight。

有替代方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:44:07.750

我听说过关于[Value Injecter](http://valueinjecter.codeplex.com/releases/view/60311)的好消息，他们有一个 Silverlight 库。

这是一个简单的例子：

```
 public class Source
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    public class Target
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    var s = new Source { Id = 3, Name = "Bill" };
    var t = new Target();

    t.InjectFrom(s); 
```

**注意**：[不会有 Silverlight 5 对 automapper 的支持](https://github.com/AutoMapper/AutoMapper/issues/180)：

> 我刚刚放弃了所有 Silverlight。老实说，支持太烦人了。随意在我放弃之前分叉代码，但这对我来说工作量太大了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T20:24:48.900

我们在 Silverlight 和服务器端代码中都使用[Emit Mapper 。](http://emitmapper.codeplex.com/ "发射映射器")目前没有大问题。

# java - 如何在 *ComponentUI 类（Swing 应用程序）中设置默认首选大小（重新定义 UI）？

> ID：12642369
> 
> 赞同：1
> 
> 时间：2012-09-28T14:52:32.977
> 
> 标签：java, swing, resize, jbutton, look-and-feel

我扩展了系统外观以绘制自定义`JButton`。

```
UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
UIManager.put("ButtonUI", "com.my.package.MyButtonUI"); 
```

与`com.my.package.MyButtonUI`：

```
public class MyButtonUI extends BasicButtonUI {

    public static final int BTN_HEIGHT = 24;
    private static final MyButtonUI INSTANCE = new MyButtonUI ();

    public static ComponentUI createUI(JComponent b) {
        return INSTANCE;
    }

    @Override
    public void paint(Graphics g, JComponent c) {
        AbstractButton b = (AbstractButton) c;
        Graphics2D g2d = (Graphics2D) g;
        GradientPaint gp;
        if (b.isEnabled()) {
            gp = new GradientPaint(0, 0, Color.red, 0, BTN_HEIGHT * 0.6f, Color.gray, true);
        } else {
            gp = new GradientPaint(0, 0, Color.black, 0, BTN_HEIGHT * 0.6f, Color.blue, true);
        }
        g2d.setPaint(gp);
        g2d.fillRect(0, 0, b.getWidth(), BTN_HEIGHT);
        super.paint(g, b);
    }

    @Override
    public void update(Graphics g, JComponent c) {
        AbstractButton b = (AbstractButton) c;
        b.setForeground(Color.white);
        paint(g, b);
    }
} 
```

现在我想在这些按钮上添加该约束：我希望按钮的大小为 70x24，除非`setPreferredSize()`在客户端代码中调用了 a。我怎样才能做到这一点？

注意：如果我`setPreferredSize()`在`MyButtonUI.update()`方法中放了 a ，它会覆盖 client `setPreferredSize()`，那么我所有的按钮都会得到相同的大小。

谢谢你。

**编辑：**

感谢 Guillaume，我像这样覆盖`getPreferredSize()`了 (in `MyButtonUI`)：

```
@Override
public Dimension getPreferredSize(JComponent c) {
    AbstractButton button = (AbstractButton) c;
    int width = Math.max(button.getWidth(), BUTTON_WIDTH);
    int height = Math.max(button.getHeight(), BUTTON_HEIGHT);
    return new Dimension(width, height);
} 
```

它工作正常。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T14:58:07.623

只需覆盖`getPreferredSize()`类中的方法`MyButtonUI`。如果程序员自愿将首选大小设置为其他值，则不会调用您的代码。这是 JComponent 的默认行为。

见代码`getPreferredSize()`：

```
public Dimension getPreferredSize() {
    if (isPreferredSizeSet()) {
        return super.getPreferredSize();
    }
    Dimension size = null;
    if (ui != null) {
        size = ui.getPreferredSize(this);
    }
    return (size != null) ? size : super.getPreferredSize();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:55:01.243

为什么不在按钮的构造函数中将首选大小设置为 70x24，设置该首选项。如果客户端再次调用 setPreferredSize，它将覆盖它。

# c# - 将参数后面的代码传递给 Ext.Net 控件

> ID：12642371
> 
> 赞同：1
> 
> 时间：2012-09-28T14:52:37.737
> 
> 标签：c#, ext.net

我在控制背后的代码中有一个变量。我想将此值传递给 Web 控件中的 Ext.Net 控件。在我的实例中，我有一个 ext.multicombo，我想将一个值传递给它的工具提示。

代码背后：

```
protected override void OnPreRender(EventArgs e)
{
this.MaxFuelFilter = System.Configuration.ConfigurationManager.AppSettings["MyVariable"]; 
} 
```

控件.aspx

```
<ext:multicombo ID="ddlFlightNumber" runat="server" ClientID="ddlFlightNumber" IndicatorTip="blah blah blah  <%=MyVariable%> blah blah blah"></ext:multicombo> 
```

我该怎么做这样的事情？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T01:34:45.287

有几个问题：

您使用的语法不适用于 ASP.NET 控件。这是 ASP.NET 的限制，与 Ext.NET 无关。

这不是有效的 ASP.NET 语法：

```
PropertyName="foo foo <%=MyVariable%>" 
```

而且，这不是有效的 ASP.NET 语法：

```
PropertyName="<%=MyVariable%>" 
```

要将值传递给属性，您需要使用`<%# %>`DataBinding 语法。

虽然，这也不是有效的 ASP.NET 语法：

```
PropertyName="foo foo <%# MyVariable %>" 
```

该属性必须只包含数据绑定变量/脚本，例如

```
PropertyName="<%# MyVariable%>" 
```

并且...您必须在控件上调用 .DataBind()，例如

```
this.MyControl1.DataBind(); 
```

或者，使用 Ext.NET 控件，您可以设置`.AutoDataBind="true"`属性，DataBinding 将自动为您处理，例如

```
<ext:TextField runat="server" PropertyName="<%# MyVariable%>" AutoDataBind="true" /> 
```

上面的自定义属性自动序列化为 JavaScript，现在可供该控件（和其他）的客户端实例使用。然后，您可以从其他 JavaScript 代码调用该属性。

对于您的场景，我建议您利用`<AfterRender>`监听器`<ext:MultiCombo>`来获取属性值并设置其他内容。以下示例演示了完整的场景 ( `myVar`)，还演示了另一种基本技术 ( `myVar2`)，用于将 JavaScript 变量从服务器端传递到客户端。

**例子**

```
<%@ Page Language="C#" %>

<%@ Register assembly="Ext.Net" namespace="Ext.Net" tagprefix="ext" %>

<script runat="server">
    string myVar;
    string myVar2;

    protected void Page_Load(object sender, EventArgs e)
    {
        myVar = "Label 1";
        myVar2 = "Label 2";
    }
</script>

<!DOCTYPE html>

<html>
<head runat="server">
    <title>Ext.NET Example</title>
</head>
<body>
    <form runat="server">
        <ext:ResourceManager runat="server" />

        <ext:TextField 
            ID="TextField1" 
            runat="server" 
            MyVar="<%# myVar %>"
            AutoDataBind="true" 
            FieldLabel="Testing">
            <Listeners>
                <AfterRender Handler="this.setFieldLabel(this.myVar);" />
            </Listeners>
        </ext:TextField>

        <ext:TextField 
            ID="TextField2" 
            runat="server" 
            MyVar="<%# myVar2 %>"
            AutoDataBind="true" 
            FieldLabel="Testing">
            <Listeners>
                <AfterRender Handler="this.setFieldLabel(myVar2);" />
            </Listeners>
        </ext:TextField>

        <script type="text/javascript">
            var myVar2 = "<%= myVar2 %>";
        </script>
    </form>
</body>
</html> 
```

您应该能够调整上述内容以使用您的自定义控件。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T14:55:11.827

在哪里`MyVariable`定义？如果它是页面类的一个`public`或`protected`成员并且在页面生命周期中足够早地初始化（`Page_Init`也许？也许`Page_Load`但我会仔细检查并测试它）那么这种方法应该有效。

# select - 如何在 FilteringSelect 框中刷新 Dojo ItemFileReadStore

> ID：12642376
> 
> 赞同：1
> 
> 时间：2012-09-28T14:52:57.077
> 
> 标签：select, dojo, refresh, store

我希望能够强制刷新此 Dojo ItemFileReadStore。有什么想法我该怎么做吗？

```
 existingCasesStore = new dojo.data.ItemFileReadStore({ url: "some url here" });
            existingCasesStore.fetch();

            // Creates the Choose Existing list box
            new dojo.form.FilteringSelect({
                store: existingCasesStore,
                autocomplete: true,
                maxHeight: "300",
                required: false,
                id: "choose_existing_select_id",
                onChange: function(selected) {
                    utils.setStatusMessage("case_info_status", "", "&nbsp;");
                }
            }, "choose_existing_select_id"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T19:45:52.650

尝试实现以下

[http://dojotoolkit.org/reference-guide/1.8/dojo/data/ItemFileReadStore.html#reloading-refreshing-itemfilereadstore-from-a-data-object-dojo-toolkit-1-4](http://dojotoolkit.org/reference-guide/1.8/dojo/data/ItemFileReadStore.html#reloading-refreshing-itemfilereadstore-from-a-data-object-dojo-toolkit-1-4)

基本上，关闭商店，以便在`fetch`下次读取项目时调用新的

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T16:22:20.970

mschr,

感谢您的提示..这是我为使其工作所做的工作。

```
existingCasesStore.close();
existingCasesStore = new dojo.data.ItemFileReadStore({ data: testData });
existingCasesStore.fetch();
dijit.byId('choose_existing_select_id').set("store", existingCasesStore); 
```

# android - 在android中从JSON生成listview

> ID：12642382
> 
> 赞同：7
> 
> 时间：2012-09-28T14:53:24.117
> 
> 标签：android, json, listview

我对 Android 完全陌生，目前正试图从从我的服务器中提取的 JSON 数组生成列表视图，我已经阅读了很多没有运气的教程，有一种独特的方法可以做到这一点。能否请您指出一些好的开始资源。

我已阅读[此](http://www.josecgomez.com/2010/05/03/android-putting-custom-objects-in-listview/)页面，但是我坚持使用以下代码：

```
import josecgomez.com.android.dev.webservice.objects.alerts; 
```

给我“”作为没有识别的资源：

```
public class AlertsAdapter extends ArrayAdapter<alerts> 
```

谢谢，任何帮助都非常感谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-05T05:41:50.997

`JSON`&`listview`会这样工作..

**1.显示项目列表**

Android SDK 使用名为 android.app.ListActivity 的超类提供了一种快速显示数据列表的便捷方式。这个 Activity 已经提供了一个 ContentView，配置了`ListView`，可以使用并填充数据。

现在需要为 ListView 提供要显示的数据，以及将这些数据映射到行的方法。ListAdaptor 提供了这种机制，并使用 setListAdaptor 在 ListActivity 的底层 ListView 上进行设置。

一个 Android SDK 提供的适配器`(ArrayAdaptor)`，它知道如何处理任意数据`ListViews`的数组（Android SDK 还附带了其他几个`ListAdaptors`，例如光标适配器，它可以在将本地数据存储连接到 ListView 时提供帮助）。您还需要为适配器提供可用于将元素呈现到每一行的布局。在下面的示例中，我们使用的是 Android SDK 提供的布局，simple_list_item_1，它是一个单一的文本标签——非常适合放置我们的单个字符串：

```
String[] elements = {"Line 1", "Line 2"};
setListAdapter(new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, elements)); 
```

**2.自定义每个列表项的外观**

为了实现这一点，您必须超越内置布局和 ArrayAdaptor 并实现自己的。

首先创建一个可用于将作者和内容保存为字符串的类 ABC。然后使用一些测试数据创建并填充一个对象，以在自定义列表项中显示：

```
public class ABC {
    String userId;
    String pwd;
} 
```

在其中创建一个布局 XML 文件`/res/layout/list_item.xml`以定义两个`TextViews`以在不同的行上显示内容和作者。为了将它们一个一个显示在另一个之上，请使用 LinearLayout，配置为垂直渲染其中的每个元素`(android:orientation="vertical")`。

创建 XML 文件后，Android Eclipse 插件会自动将其作为参考添加到生成的 R 文件中。此 R 文件保存在项目的 /gen 文件夹下，充当 XML 元素和 Java 代码之间的桥梁。它允许您的 Java 代码引用在 /res 文件夹下创建的 XML 元素和文件。您刚刚创建的文件现在可以像`R.layout.list_item`在 Java 代码中一样被引用，接下来您将在自定义列表适配器中执行此操作。

创建一个名为`ListAdaptor`which subclasses的私有类（在 Activity 内部） `ArrayAdaptor`。此类应用于存储正在显示的 ArrayList，并提供一种将对象映射到`TextViews`您在上面的布局中创建的方法。

此映射覆盖 ListAdaptor，并应返回一个 View 对象，该对象填充了请求位置的数据内容。

自定义 abcListAdaptor 的完整实现如下：

```
private class abcListAdaptor extends ArrayAdapter<abc> {  
    private ArrayList<abc> abc;  
    public abcListAdaptor(Context context, int textViewResourceId, ArrayList<abc> items) {  
        super(context, textViewResourceId, items);  
        this.abc = items;  
    }  

    @Override  
    public View getView(int position, View convertView, ViewGroup parent) {  
        View v = convertView;  

        if (v == null) {  
            LayoutInflater vi = (LayoutInflater) getSystemService                          
(Context.LAYOUT_INFLATER_SERVICE);  
            v = vi.inflate(R.layout.list_item, null);  
        }  

        abc o = abc.get(position);  
        TextView tt = (TextView) v.findViewById(R.id.uid);  
        TextView bt = (TextView) v.findViewById(R.id.pwd);  
        tt.setText(o.userid);  
        bt.setText(o.pwd);  
        return v;  
    }  
} 
```

现在可以调整 onCreate 方法以将自定义列表适配器与创建的测试数据一起使用，如下所示：

```
public void onCreate(Bundle savedInstanceState) {  
super.onCreate(savedInstanceState);  
abc a = new abc();  
a.userid = "tech";  
a.pwd = "android";  
ArrayList<abc> items = new ArrayList<abc>();  
items.add(a);  
abcListAdaptor adaptor = new abcListAdaptor(this,R.layout.list_item, items);  
setListAdapter(adaptor);  
} 
```

**3.访问远程服务和解析数据**

Android SDK 包含旨在简化对基于 HTTP 的 API 的访问的软件包。Apache HTTP 类已包含在内，可以在`org.apache.http package`. 您将使用这些类以及这些`org.json`类来解析从服务器返回的数据。

我们可以在 Activity 中创建一个私有方法来发出请求，解析结果并返回一个`ArrayList`对象。下面列出的代码发出请求并查找结果`JSON array`，它被迭代以提取每个 text 和 from_user 元素。

```
ArrayList<abc> getDetail= new ArrayList<abc>();  
    try {  
        HttpClient hc = new DefaultHttpClient();  
        HttpGet get = new  
        HttpGet("<a href="http://your URL"></a>");  
        HttpResponse rp = hc.execute(get);  

        if(rp.getStatusLine().getStatusCode() == HttpStatus.SC_OK) {  
            String result = EntityUtils.toString(rp.getEntity());  
            JSONObject root = new JSONObject(result);  
            JSONArray sessions = root.getJSONArray("results");  

            for (int i = 0; i < sessions.length(); i++) {  
                JSONObject session = sessions.getJSONObject(i);  
                abc a = new abc();  
                a.uid = session.getString("user");  
                a.pwd = session.getString("password");  
                getDetail.add(a);  
            }  
        }  
    } 

    catch (Exception e) {  
        Log.e("Activity", "Error loading JSON", e);  
    } 
```

现在，在 onCreate 方法中构造自定义列表适配器时，将之前使用的虚拟数据替换为对 load 方法的调用。

```
abcListAdaptor adaptor = new abcListAdaptor(this,R.layout.list_item, load()); 
```

**4.创建响应式用户界面**

当前状态下的代码可能会导致出现应用程序无响应 (ANR) 对话框，提示用户退出您的应用程序。这可能是由于在诸如`onCreate`.

不应在主应用程序线程（驱动用户界面事件循环）上执行长时间运行的任务。相反，它们应该被派生到子线程中来执行工作。

虽然 Java 的`Thread`类可以用于此任务，但有一个复杂之处在于，一旦长时间运行的任务完成，它通常希望更改用户界面以报告结果（即显示从请求中加载的列表） .

用户界面元素只能从主线程更改其状态，因为 Android UI 工具包不是线程安全的，因此后台线程需要向主线程发送消息以操作 UI。

值得庆幸的是，Android SDK 提供了一个方便的类 AsyncTask，它为异步任务与 UI 线程安全交互提供了一种简单的机制。这是通过继承 AsyncTask 并重写 doInBackground 方法来执行长时间运行的任务，然后重写 onPostExecute 来对 UI 执行任何操作来实现的。

当 AsyncTask 创建（它必须在 UI 线程上创建）并执行时，doInBackground 方法在后台线程上被调用。完成后，将在主 UI 线程上调用回 onPostExecute 方法。

要在您的应用程序中使用它，您需要在 Activity（如自定义适配器类）中实现一个名为 MyTask 的私有类，它是 AsyncTask 的子类。您可以使用之前加载方法的内容覆盖 doInBackground 方法。

您无需返回 ArrayList，而是在 Activity 中维护一个实例变量，以便可以在私有类之间共享数据。然后在 onPostExecute 中，您可以使用数据设置列表适配器，就像之前在 onCreate 中所做的那样。onCreate 方法现在只需创建 MyTask 对象并调用 execute 方法。

****listView**的**最佳站点**是[this](http://www.vogella.com/articles/AndroidListView/article.html)和[this](http://developer.android.com/guide/topics/ui/layout/listview.html)。**

 **--

问候

**技术结束**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T14:57:27.327

您需要将 JSON 对象的重要元素存储到您自己创建的新对象中。

假设您的 JSON 对象为您提供包含姓名、日期和电话号码的键，您需要一个包含此类信息的对象。

您的列表视图将采用您的新类型的数组适配器，列表视图的每个单元格将包含填充有您的对象信息的 UI 元素（例如文本视图）

这至少是一个 3 步过程，您需要单独解决每个步骤的解决方案

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-04T12:29:01.227

> 在您的活动中尝试此代码首先将 json 数据解析为字符串数组，然后在您的活动的 xml 中设置您的 Listview 适配器

```
try
   {

   JSONArray jArray = new JSONArray(result);
   JSONObject jObj=new JSONObject ();
   String[] data=new String[jArray.length()]

       for(int i=0;i<jArray.length();i++)
       {
          jObj= jArray.getJSONObject(i);
          data[i]=json_data.getString("value");

       }

       GameAdapter adapter = new GameAdapter(this, R.layout.listview_item_row, data);
       listView1 = (ListView)findViewById(R.id.listView1);
       listView1.setAdapter(adapter);
}
catch(Exception e)
{
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-01T18:47:14.880

我找到了关于这个主题的一个很好的[资源。](http://www.sitepoint.com/loading-twitter-data-into-android-with-lists/)现在我有我的 Json 数据列表。强烈推荐给所有新手。谢谢你们的帮助。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-01T12:51:37.680

我建议您按照以下步骤操作：

1.  从网络获取数据并存储
2.  将存储的数据传递给适配器
3.  将适配器设置为您的列表

在第一步中，我建议您使用`AsyncTask`类获取数据，它允许执行后台操作并在 UI 线程上发布结果，而无需操作线程和/或处理程序。其次，你必须根据你得到的 JSON 结构来解析你的内容。最后，将您的数据传递给适配器以填充您的列表。**

# linux - 如何调用写入 proc 文件的内核模块？

> ID：12642389
> 
> 赞同：0
> 
> 时间：2012-09-28T14:53:41.240
> 
> 标签：linux, kernel, kernel-module, proc

我从这个网址复制并粘贴了代码：http: [//linux.die.net/lkmpg/x769.html](http://linux.die.net/lkmpg/x769.html)

我替换了过时的 &proc_root 愚蠢并注释掉了“Our_Proc_File->owner = THIS_MODULE;” 考虑到它在构建时给我带来了麻烦。

然后我制作了一个适当的 makefile，编译了 .ko 并使用 insmod 完成了任务。

两个问题：

1.  如何从 procfile 中读取？

2.  另外，我看到文件的条目是在模块加载时创建的，但是这个文件是什么时候写的？

*奖金* 这些问题可能源于对 proc 的误解。我的印象是，在读取文件时会写入 proc“文件”以提供最新信息。

1.  那是错的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:47:53.630

1.  与`read(2)`. `cat`可以从外壳为您执行此操作。
2.  绝不。读取文件时会动态创建内容。这就是我们为文件指定读取回调的原因。

# c# - 以每行 3 个为一组定位标签和文本框的算法

> ID：12642391
> 
> 赞同：0
> 
> 时间：2012-09-28T14:53:46.173
> 
> 标签：c#, winforms, controls, alignment

根据 XML 文件的内容，程序在运行时必须动态创建文本框和标签。我想在组框中按以下方式组织此控件：

```
[label1] [textbox1]  [label2] [texbox2] [label3] [textbox]
[label4] [textbox4]  [label5] [textbox5] [...] 
```

所以。

但我不知道如何计算`X`和`Y`值。我尝试了几种解决方案，但没有运气。在我当前的实现下方，每行放置标签和文本框：

```
[label1] [texbox1]
[labe2] [texbox2] 
```

所以。

```
 //list the disiciplanas from XML file
            //into combobox control.
            for (int i = 0,
                label_X = 20, label_Y = 20,
                textbox_X = 74, textbox_Y = 20,
                len = materias[0].ChildNodes.Count,
                line = 0, tmp_pos = 20;

                i < len;

                i++,
                tab_index++,
                line++,
                tmp_pos += 20
                )
            {
                XmlNode materia = materias[0].ChildNodes[i];
                Point label_position, textbox_position;
                Label label = new Label();
                TextBox textbox = new TextBox();

#if DEBUG_
                if (line == 3)
                {
                    label_X = 200 + tmp_pos;
                    label_Y = 25 + tmp_pos;
                }
                else
                {
                    label_X += 10;
                }

                textbox_Y = label_Y;

#else
                label_Y += 20;
                textbox_Y = label_Y;
#endif

                label.Text = "foo";

                textbox.Size = new Size(48, 20);
                textbox.Name = String.Format("nota{0}", fo.Name);

                label_position = new Point();
                label_position.X = label_X;
                label_position.Y = label_Y;

                textbox_position = new Point();
                textbox_position.X = textbox_X;
                textbox_position.Y = textbox_Y;

                label.Location = label_position;
                textbox.Location = textbox_position;
                textbox.Left = 150;
                textbox.TabIndex = tab_index;

                notas_panel.Controls.Add(label);
                notas_panel.Controls.Add(textbox);
            } 
```

我希望这很清楚。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:12:27.857

最简单的方法是不计算它们。

创建一个面板并摆脱它的边框。在面板上创建动态控件并将面板设置为 Dock Top，然后在面板上调用`BringToFront()`（或者`SendToBack()`我可能永远记不起它们在运行时帮助停靠的方式。）。

当您创建下一批时，所有控件都具有相同的位置，但它们的父面板会自动放置在前一个面板的下方。

结果应如下所示： ![在此处输入图像描述](../Images/a7778631c942cd80771e750fc4feba3c.png)

```
 public partial class Form1 : Form
{
    List<Int32> Children;
    public Form1()
    {
        InitializeComponent();
        Children = new List<int>();
        Children.AddRange(Enumerable.Range(0, 20));
        ShowChildren();
    }

    private void ShowChildren()
    {
        for (int i = 0; i < Children.Count; i += 3)
        {
            AddRow(i, Children);
        }
    }

    private void AddRow(int startIndex, List<Int32> Nodes)
    {
        int NodesOnThisRow = 3;
        if (Nodes.Count - startIndex < 3)
            NodesOnThisRow = Nodes.Count - startIndex;
        Panel newPanel = new Panel();
        newPanel.Height = 25;
        int x = 8;
        for (int i = 0; i < NodesOnThisRow; i++)
        {
            Label L = new Label();
            TextBox T = new TextBox();
            //You could dock these left so they just appear one after the other, or since there
            //is only 3 you could just hard code the 3 x values, or calc them
            L.Left = x;
            T.Left = x + 120;
            L.Text = Nodes[startIndex + i].ToString();
            T.Text = Nodes[startIndex + i].ToString();
            x += 250;
            newPanel.Controls.Add(L);
            newPanel.Controls.Add(T);
        }
        groupBox1.Controls.Add(newPanel);
        newPanel.Dock = DockStyle.Top;
        newPanel.BringToFront();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T15:29:34.520

```
public IEnumerable<Point> GetLocations(int numCols,int colWidth,int rowHeight)
{
    int x = 0, y = 0;
    while (true)
    {
        for (int i = 0; i < numCols; i++)
        {
            yield return new Point(x, y);
            x += colWidth;
        }
        x = 0;
        y += rowHeight;
    }
} 
```

你可以像这样使用它

```
foreach (Point p in GetLocations(3, 100, 32).Take(12))
{
    Console.WriteLine(p);
} 
```

# c# - 我可以在静态类中有非静态数据成员吗？

> ID：12642392
> 
> 赞同：-5
> 
> 时间：2012-09-28T14:53:45.577
> 
> 标签：c#, static, static-methods, static-members

我想知道在静态类中是否所有的方法和数据成员都应该是静态的，或者我可以找到一个非静态成员吗​​？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T14:55:09.013

从[谷歌](https://www.google.co.uk/search?sourceid=chrome&ie=UTF-8&q=static%20class%20c#)[返回的第一个链接](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.80%29.aspx)

> 静态类的主要特点是：
> 
> *   它们只包含静态成员。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T14:56:34.000

所有成员都是静态的。当然是，因为如果你不能从那个类中实例化一个对象，为什么会有任何非静态成员呢？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T15:18:42.513

您可以拥有一个具有静态和非静态方法的非静态类，但静态类只能具有静态方法。

# php - 为什么 !in_array() 不能正常工作？还是我的逻辑有缺陷？

> ID：12642393
> 
> 赞同：3
> 
> 时间：2012-09-28T14:53:48.360
> 
> 标签：php, arrays, simplexml

这是我正在尝试做的似乎不起作用的基本逻辑。

1.  遍历字母表数组
2.  对于每个字母，循环通过 XML，如果程序名称以当前字母开头，并且主要不在输出数组中，则输出带有 XML 中一些数据的链接
3.  每当链接输出时，将主要添加到输出数组中，这样我们就不会输出双精度数

问题是，即使主要是在数组中的行：

```
if (!in_array($program->Program, $majors)) { 
```

总是返回真，导致双打被输出。

目前在页面上，在它输出的每个链接之后，我还输出整个数组以直观地确认主要存在于数组中，当您到达主要 WBAN 的页面底部时，您可以在第一个输出中查看在它上面的数组中，看到它在数组中不存在，所以它输出但是，下一个链接输出也是 WBAN，你可以在上面的数组中看到它已经存在，所以 if 应该返回 false 和不输出...

我的逻辑一定是有缺陷的地方——我试过移动 array_push 并且不能让它正常工作——我需要新鲜的眼睛。

另外 - 如果我错了，请纠正我，但我不能从 XML 中清除重复的原因是因为完整的 XML 节点不是重复的 - 只是主要的。

例如，这里是 XML - 只有 Program 和 MajorDescription 会被复制，所以完整的 XML 节点不会被认为是重复的？：

```
<ProgramList>
    <MajorDescription>WEB ANIMATION AND DESIGN</MajorDescription>
    <Program>WBAN</Program>
    <ProgramLocations>
        <ProgramLocation>
            <Campus>Barrie</Campus>
        </ProgramLocation>
    </ProgramLocations>
    <Term>201310</Term>
</ProgramList> 
```

完整代码：

```
<?php 
$majors = array();
foreach ($alphabet as $l){
    $upper = strtoupper($l);                            

    foreach ($listxml->ProgramList as $program) {
        $letter = substr($program->MajorDescription, 0, 1);
        if (strcasecmp($letter, $l) == 0) {
            $count1++;
            $noprograms = false;
        }                               
    }

    if ($count1 == 0) {
        echo "<div id='$l' class='letter noprograms'>"; 
    } else {
        echo "<div id='$l' class='letter'>";
    }                           

    echo "<h2>$upper</h2>";

    foreach ($listxml->ProgramList as $program) {                             
        $letter = substr($program->MajorDescription, 0, 1);                

        if (strcasecmp($letter, $l) == 0) { 

            foreach ($majors as $major){
                echo "<p>".$major."</p>";
            }                  
            //this is where the problem is - this is always coming back true even if the major is in the array 
            if (!in_array($program->Program, $majors)) {                                    
                echo "<a href='../program/?major=".$program->Program."' class='programLink'>".$program->Program." - ".strtoupper($program->MajorDescription)."</a> - <a target='_BLANK' href='http://www.ontariocolleges.ca/SearchResults/GEORGIAN/_/N-1z1419r?Ntt=".rawurlencode($program->MajorDescription)."&Ns1=Program_Title_SORT&Ns2=0&Qo=20&SearchWithin=on'>Apply Now</a><br />";                                                                                                           
                array_push($majors, $program->Program);
            }                                                                       
            $count++;                                   
        }                               
    }
    if ($count == 0) {
        echo "<em class='noprograms'>No Programs</em><br />";
    }
    echo "</div>";                      
    $count = 0;
    $count1 = 0;
}

if ($noprograms) {
    echo '<div id="noprograms"><em>No results. Try broadening the search filters.</em></div>';
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:03:12.627

您必须将节点转换为字符串值：

```
if (!in_array((string)$program->Program, $majors)) { 
```

和：

```
array_push($majors, (string)$program->Program); 
```

这是您在使用 SimpleXML 时必须习惯的事情之一；将变量隐式转换为字符串的函数不需要这种特殊处理，但是如果您真的很偏执，我建议您将所有内容都转换为 ;-)

例如，`substr()`不需要强制转换，因为它希望第一个参数无论如何都是一个字符串，它会自动强制转换它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:14:13.370

 ~~~~```
if (!in_array($program->Program, $majors, true)) {
                                          ^^^^ 
```~~ 

`in_array`有一个严格的参数，你应该在处理对象时使用它（就像你一样）。

另一种选择是[`SplObjectStorage`](http://php.net/SplObjectStorage).

```
$majors = new SplObjectStorage;

$majors->containts($program->Program);

$majors->attach($program->Program); 
```

~~最后是关键变体：~~

 ~~```
$programName = (string) $program->Program;

isset($majors[$programName]);

$majors[$programName] = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:07:35.967

不确定，但我认为您在这部分可能有问题：

```
foreach ($listxml->ProgramList as $program) {                             
    $letter = substr($program->MajorDescription, 0, 1);                

    if (strcasecmp($letter, $l) == 0) { 

        foreach ($majors as $major){
            echo "<p>".$major."</p>";
        }                  
        //this is where the problem is - this is always coming back true even if the major is in the array 
        if (!in_array($program->Program, $majors)) {                                    
            echo "<a href='../program/?major=".$program->Program."' class='programLink'>".$program->Program." - ".strtoupper($program->MajorDescription)."</a> - <a target='_BLANK' href='http://www.ontariocolleges.ca/SearchResults/GEORGIAN/_/N-1z1419r?Ntt=".rawurlencode($program->MajorDescription)."&Ns1=Program_Title_SORT&Ns2=0&Qo=20&SearchWithin=on'>Apply Now</a><br />";                                                                                                           
            array_push($majors, $program->Program);
        }                                                                       
        $count++;                                   
    }                               
} 
```

对于中的每个元素，`$listxml->ProgramList`您将打印所有`$majors`.

你应该尝试把

```
 foreach ($majors as $major){
            echo "<p>".$major."</p>";
        } 
```

循环之后的`foreach ($listxml->ProgramList as $program) {`循环。

你也做了两次同样的测试：

```
foreach ($listxml->ProgramList as $program) {                             
    $letter = substr($program->MajorDescription, 0, 1);                

    if (strcasecmp($letter, $l) == 0) { 
```

也许您可以通过将两个块放在一起来优化您的脚本？~~~~

# jquery - jquery切换幻灯片和切换旋转动画

> ID：12642394
> 
> 赞同：0
> 
> 时间：2012-09-28T14:53:48.200
> 
> 标签：jquery, animation, rotation

当它被按下时我有一个按钮我希望它为打开的段落设置动画并将按钮旋转 45 度，然后当您再次单击它时，关闭该段落并再向前移动 45 度。我正在使用切换幻灯片来打开和关闭段落，它工作正常。我不太确定如何将旋转动画添加到函数中。理想情况下，如果可能的话，我希望只使用 jquery 而没有 css 转换来进行旋转。但是，如果在 jquery 中使用 css 是不可能的，但我只希望它是一个功能。现在这就是我所拥有的，并提前感谢您帮助我解决这个问题：

```
<script type="text/javascript">
$("#effects_of_yoga_info").click(function () {
  $("p#effects_of_yoga_text").slideToggle("fast");
});
</script> 
```

effects_of_yoga_info 是我想在这里旋转的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:40:24.600

尝试这个。我把它放在一起并进行了测试。

```
$(document).ready(function() {
    $('#effects_of_yoga_info').click(function() {
        var info = $(this);
        var rotation = parseInt(info.data('rotation'));

        $('p#effects_of_yoga_text').animate({
            height: 'toggle'
        },{
            step: function(now, fx) {
                var t = fx.start == 100 ? 100 - fx.now : fx.now;
                info.css('transform', 'rotate('+ (rotation + ((t / 100) * 45)) +'deg)');
            },
            complete: function() {
                info.data('rotation', rotation + 45);   
            },
            duration: 'fast'    
        });

    }).data('rotation', 0);
}); 
```

# android - 如何在 GridView 中以正常大小显示一组图像

> ID：12642399
> 
> 赞同：1
> 
> 时间：2012-09-28T14:54:06.793
> 
> 标签：android, gridview, imageview

如果我有一组相同大小的图像 211px x 165px ，如何在保持高度和宽度之间的原始比例的情况下使用网格视图显示它们。需要在每行中显示两个项目。我已经可以做到这一点，但图像看起来是垂直拉伸的。这是我得到的截图。请注意，`gridview`单元格比图像大 ![在此处输入图像描述](../Images/ddd4af5251fb5f276205ac4c4239560c.png)

**`gridview`布局 ：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/bg"
    android:orientation="vertical" >

    <include
        android:id="@+id/include1"
        layout="@layout/header" />
    <GridView
        android:id="@+id/gvCategory"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_margin="0dp"
        android:background="@drawable/bg"
        android:gravity="right"
        android:horizontalSpacing="5dp"
        android:numColumns="2"
        android:padding="0dp"
        android:verticalSpacing="5dp" >
    </GridView>

</LinearLayout> 
```

gridview 单元格布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/include21nh"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <FrameLayout
        android:id="@+id/include21"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@drawable/btn"
        android:padding="5dp" >

        <ImageView
            android:id="@+id/imgCategoryImage"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:scaleType="centerInside"
            android:src="@drawable/img1" />

        <TextView
            android:id="@+id/txtCategoryName"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_gravity="bottom"
            android:background="@drawable/transparent_fading"
            android:gravity="right"
            android:padding="15dp"
            android:text="Crispy Chicken and Sandwich"
            android:textColor="#ffffff"
            android:textSize="17sp" />

    </FrameLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:29:31.870

您应该`android:scaleType="centerInside"`在`ImageView`代表`GridView`. 正如文档所说：

> CENTER_INSIDE - 统一缩放图像（保持图像的纵横比），使图像的两个尺寸（宽度和高度）都等于或小于视图的相应尺寸（减去填充）。

[你可以在这里](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)找到更多信息。希望这可以帮助。

# iphone - 无法再访问带有标签的对象

> ID：12642400
> 
> 赞同：0
> 
> 时间：2012-09-28T14:54:07.777
> 
> 标签：iphone, ios, tags

我创建了一个自定义对象，我想用标签访问它。我以前为非自定义 NSObject 做过一百万次，它曾经可以工作，但不适用于我的自定义 NSObject。有什么我想念的吗？

```
 dataSplash* splashO = [[dataSplash alloc]initWithFrame:CGRectMake....;
    splashO.tag = 201;
    [self.view addSubview:splash0]; 
```

我尝试以联系方式访问它开始

```
-(void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{

    UITouch *touch = [touches anyObject];
    int tagOfView = touch.view.tag ;
    ....
} 
```

它总是说标签为零。

# css - 如何在css中强烈强制行高，没有延伸？

> ID：12642405
> 
> 赞同：6
> 
> 时间：2012-09-28T14:54:32.303
> 
> 标签：css

我如何在 CSS 中强制行高，这样没有大字母会拉伸行高。相反，它们应该夹在上面的行之下，甚至与上面的行合并。

默认情况下， CSS`line-height`似乎像 MS Word 的“至少”行高选项一样工作。我想让它像 MS Word 的“完全”选项一样工作。

例如：

*   [http://jsfiddle.net/DUpgN/](http://jsfiddle.net/DUpgN/)

在那里，线条的高度不同，因为其中一行有一些更大的字母。无论如何，我希望所有线条都具有相同的高度。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T15:38:27.123

> 字形（字符的视觉表示）在内嵌框中垂直居中。如果行高大于内容高度，则在顶部添加一半作为空格；底部也添加了相同的数量。

您的示例中的主要非粗体文本就是这种情况。

> 当在不可替换的内联元素上设置时，它指定用于计算周围行框高度的高度。

因此，在粗体文本中，您仍然会*比*字体大小高 8.5 像素，这会导致问题。

**您可以通过设置小于**字体大小的 line-height 来防止它（[查看此演示](http://jsfiddle.net/gionaf/mM4tR/)）。因为它是一个内联元素，所以`overflow:hidden;`它仍然是可见的，但它不会在文本的其余行高上添加任何像素。

据我所知，不可能“拉伸”字母，除非您使用一些 CSS3 属性等`transform:scale(value)`。

[参考](http://reference.sitepoint.com/css/line-height)

* * *

代码：

```
<p>ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac <b>ac</b>
ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac ac</p> 
```

​ CSS：

```
p {
    line-height:17px;        
    font-size:15px;
    width:150px;
}
b {
    font-size:25px;
    line-height:1px; 
}​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:33:01.263

不确定这是否是您的目标，但这会剪切任何大于行高的文本。

```
b {
    display:inline-block;
    overflow:hidden;
    vertical-align:top;
   } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:10:53.723

也许添加

```
display:inline-block;
height:13px; 
```

到 b 标签

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-28T15:01:29.373

没门。您可以考虑放大行高，例如 30px，您将获得所有行的相同高度。

# javascript - JavaScript 函数未在 Chrome 中执行

> ID：12642412
> 
> 赞同：0
> 
> 时间：2012-09-28T14:54:50.617
> 
> 标签：javascript, google-chrome, wamp

我有这个代码：

```
function changeLogo() { var changeLogo = $("#logo").css("z-index", "8"); }
function delay() { setTimeout("changeLogo()",470) }; 
```

执行于：`bodyonLoad="delay()"`

这适用于所有浏览器 - 但是 - 出于某种奇怪的原因，在我桌面上的 Google Chrome 中，该功能将无法加载。我知道这不是 Chrome 问题（它可以在我的 Chrome 笔记本电脑上运行），也不能是 WAMP，因为它可以在其他浏览器中运行。有没有人知道为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:00:31.637

您应该在 setTimeout 中传递函数 changeLogo 的引用。

```
function changeLogo() {
     var changeLogo = $("#logo").css("z-index", "8");
}
function delay() {
    setTimeout(changeLogo, 470)
}; 
```

建议：我建议你不要使用相同的变量名（changeLogo）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:04:00.267

我建议你尝试在这样的正文末尾添加一个脚本

```
</body>
<script type="text/javascript>
    setTimeout("changeLogo()", 470);
</script> 
```

或尝试使用 jquery

```
 $(document).ready( function(){
    setTimeout("changeLogo()", 470);
}); 
```

# php - 如何禁止来自我网站以外的位置的表单帖子？

> ID：12642414
> 
> 赞同：1
> 
> 时间：2012-09-28T14:54:52.223
> 
> 标签：php, csrf

我有简单的形式

```
<form name="blabla" action="path.php" >bla bla bla </form> 
```

表单操作的路径当然是可见的，但是我如何保护其他表单可以从另一个 Web 服务器访问我的表单操作。

因为有人从另一个位置使用此表单操作在我的数据库中插入了一条新记录。

我该如何保护它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:05:43.383

使用会话 - 在您的表单页面中生成一个随机值，并将该值放入隐藏字段并将其保存在 $_SESSION 中，然后在表单提交时检查表单中的值是否与会话数据中的值匹配。这也有助于对抗 CSRF（虽然不完全）

您还可以使用 $_SERVER['HTTP_REFERER'] 值。它不是必需的标头，并且某些浏览器不会在完全有效的使用下发送它（并且它很容易被恶意用户欺骗），因此它不是完全万无一失的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T14:58:57.623

我建议确保（以某种方式）该帖子来自您的网站。

使用 cookie、会话或其他方法来确保它（例如检查页面引荐来源 [这**并不**总是可靠的]）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:28:27.097

我通常会添加一个 $token 值，就像本[指南](http://phpsec.org/projects/guide/2.html#2.4)提到的那样。

例如：

```
<?php #your validator
start_session();

if(isset($_POST['foo']...isset($_POST['bar']){#Required Sent Values
    if(isset($_SESSION['token']) && $_POST['token'] === $_SESSION['token']){#Check Token
        #Check If Things Are Valid
    }else{
        #Error
    }
}
?>

<?php #Your form page
    $token = md5(uniqid(rand(), true));
    $_SESSION['token'] = $token;
?>
<form action="">
    <input type="hidden" name="token" value="<?php echo $token; ?>" />
</form> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T15:05:49.437

您可以测试 http 主机标头，该标头设置在以下 PHP 超全局...

```
$_SERVER['HTTP_HOST']; 
```

...但是可以在客户端上伪造标头。

您真正追求的是跨站点请求伪造保护，这通常涉及将安全令牌注入表单数据，然后将其与您在服务器上为用户存储的令牌（例如会话数据）进行比较。

Symfony2 的优秀表单 api 免费为您执行此操作，也有执行此操作的库，或者您可以自己滚动。什么都适合。

[http://www.serversidemagazine.com/php/php-security-measures-against-csrf-attacks/](http://www.serversidemagazine.com/php/php-security-measures-against-csrf-attacks/)

# git - gitignore 不工作（“.foo”模式与“test.foo”文件名不匹配）

> ID：12642417
> 
> 赞同：0
> 
> 时间：2012-09-28T14:55:00.463
> 
> 标签：git, github

我在目录中有一个 .gitignore 文件（不是根目录）

```
.ascii 
```

但是当我即将提交更改时，这些文件一直显示为未跟踪。

```
Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   new file:   test.ascii 
```

我确定这些文件与忽略文件位于同一目录中。为什么忽略文件中的规则不起作用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T14:56:22.443

`.ascii`不匹配`test.ascii`。您想在扩展名前加上通配符：`*.ascii`.

# java - 需要关于客户杆显示的帮助，我无法通过串口 COM1 向它发送命令

> ID：12642433
> 
> 赞同：0
> 
> 时间：2012-09-28T14:55:49.247
> 
> 标签：java, serial-port

我被分配了一个任务来与行显示或客户显示其型号 VFD220E 其波特率 9600 N 8 1 和 20 个字符 2 行显示进行通信。我有手册，但是当我尝试发送命令时。它没有捡起它，它只是像字符串一样打印。任何帮助将提前非常感谢。下面是我的代码。

```
 CommPortIdentifier portIdentifier = CommPortIdentifier.getPortIdentifier("COM1");
  if (portIdentifier.isCurrentlyOwned())
  {
      System.out.println("Port in use!");
  }
  else {
  System.out.println(portIdentifier.getName());

  SerialPort serialPort = (SerialPort) portIdentifier.open("ListPortClass", 300);
  int b = serialPort.getBaudRate();
  System.out.println(Integer.toString(b));
  serialPort.setSerialPortParams(9600, SerialPort.DATABITS_8, SerialPort.STOPBITS_1,    SerialPort.PARITY_NONE);

  OutputStream mOutputToPort = serialPort.getOutputStream();
  InputStream mInputFromPort = serialPort.getInputStream();
  String ESC=" 1B  51  41  ";//hex codes
  String CR="0D";//hex codes
  String mValue = ESC+" Testing Phase"+CR;//to display on top line.
  String clear ="0C";
  System.out.println("beginning to Write . \r\n");
  mOutputToPort.write(clear.getBytes());
  mOutputToPort.write( mValue.getBytes());
  mOutputToPort.flush();
  System.out.println("Command Written to Port. \r\n");
  mOutputToPort.flush();
  System.out.println("Waiting for Reply \r\n");
  //Thread.sleep(500);
  byte mBytesIn [] = new byte[20];
  mInputFromPort.read(mBytesIn);
  mInputFromPort.read(mBytesIn);
  String value = new String(mBytesIn);
  System.out.println("Response from Serial Device: "+value);
  mOutputToPort.close();
  mInputFromPort.close();
  serialPort.close(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T19:30:36.517

您似乎将控制命令作为文本发送。您不能只写`" 1B 51 41 "`为字符串并将它们发送到显示器。String 的 getBytes() 方法为您提供 UTF-8 字符串的字节表示，而不是字节 0x1B、0x51 和 0x41。

您必须将实际字节值 0x1B、0x51 和 0x41 发送到显示器。通过发送字节或在您的字符串中使用转义序列，即十进制表示法`\027\081\065`。

有关十六进制和十进制表示法的一些常用命令，请参阅此[链接](http://www.seetron.com/vfd220.html)。

# c++ - OpenGL 的列主要顺序

> ID：12642434
> 
> 赞同：1
> 
> 时间：2012-09-28T14:55:51.747
> 
> 标签：c++, matrix-multiplication

我正在编写用于 opengl 图形的数学类，它使用列主矩阵排序。这是家庭作业。

对于 mat3（我的矩阵 3x3 类）以及其他矩阵类，我想出了使用联合表示法来描述矩阵数据。现在我担心我的排序是错误的（例如行专业而不是列专业）。

```
#define real float
union
{
    real _data[9];
    struct
    { 
        real _11; real _12; real _13;
        real _21; real _22; real _23;
        real _31; real _32; real _33;
    };
    struct
    { 
        real _a; real _b; real _c;
        real _d; real _e; real _f;
        real _g; real _h; real _i;
    };

}; 
```

我是否应该按如下方式编写第二个结构：

```
struct
{ 
    real _a; real _d; real _g;
    real _b; real _e; real _h;
    real _c; real _f; real _i;
}; 
```

此外，我应该按如下方式编写第一个结构：

```
struct
{ 
    real _11; real _21; real _31;
    real _12; real _22; real _32;
    real _13; real _23; real _33;
}; 
```

这会影响矩阵乘法或其他数学运算（行列式、逆运算、转置...）的顺序吗？例如，目前，我的 mat3 乘法函数如下所示：

```
mat3 operator * ( const mat3 & l, const mat3 & r )
{
    // matrix matrix multiply
    return mat3(
        ( (l._11 * r._11) + (l._12 * r._21) + (l._13 * r._31) ), 
        ( (l._11 * r._12) + (l._12 * r._22) + (l._13 * r._32) ), 
        ( (l._11 * r._13) + (l._12 * r._23) + (l._13 * r._33) ),

        ( (l._21 * r._11) + (l._22 * r._21) + (l._23 * r._31) ),
        ( (l._21 * r._12) + (l._22 * r._22) + (l._23 * r._32) ),
        ( (l._21 * r._13) + (l._22 * r._23) + (l._23 * r._33) ),

        ( (l._31 * r._11) + (l._32 * r._21) + (l._33 * r._31) ),
        ( (l._31 * r._12) + (l._32 * r._22) + (l._33 * r._32) ),
        ( (l._31 * r._13) + (l._32 * r._23) + (l._33 * r._33) )
    );
} 
```

据我了解，这个问题让很多人感到困惑。我认为在阅读了有关该主题的教科书之后会出现混淆，然后不得不坐在 IDE 前编写课程，这两个主题很少被涵盖在一起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:07:26.243

从数学上讲，矩阵乘法的工作方式相同，与列/行的主要顺序无关。列/行主要排序影响的是您如何*创建*这些矩阵。例如，如何构建旋转矩阵。

此外：

> 我应该按如下方式编写第一个结构吗

整个列/行的主要内容仅对值*数组*很重要。列/行的主要问题是关于如何将矩阵存储为数组。如果您有一个包含 9 个值的数组，并且 3x3 矩阵以行优先形式存储，那么第 2 列、第 1 行的索引将是从零开始的索引 1。在列优先存储中，第 2 列、第 1 行索引将是 3。

所以看看你的工会。联合的重点是以不同的方式访问同一个浮点数。该`_21`成员应该是第二列，第一行。如果是这种情况，那么您有责任确保它映射到数组的正确部分。如果数组应该是列优先的，那么`_21`应该映射到与`_data[3]`. 如果它是行专业的，它应该映射到`_data[1]`.

# asp.net-mvc - UrlHelper.IsLocalUrl 方法对于非 ASCII 字符串总是返回“false”

> ID：12642436
> 
> 赞同：3
> 
> 时间：2012-09-28T14:56:08.587
> 
> 标签：asp.net-mvc

我最近检测到，如果在参数中检测到非 ASCII 字符，该`UrlHelper.IsLocalUrl`方法总是返回。**`false`**`url`

例子：

```
var isLocal = UrlHelper.IsLocalUrl("контакты"); //false 
```

这是一个错误，还是“设计使然”？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-05T21:15:45.623

最新可用的实现是检查这些条件：

*   url 以 or 开头，`"/"`后面不跟`"/"`or`"\"`
*   或者 url 以开头`"~"`并且后跟`"/"`

因此，传递给此方法的所有 url 必须以`"/"`or开头`"~/"`。

此外，如果您想知道，它不会考虑当前主机并检查诸如此类`http`的方案。

**更新：** 这是`UrlHelper.IsLocalUrl` [http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/600963a4df15#src/System.Web.WebPages/RequestExtensions.cs使用的实现的链接](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/600963a4df15#src/System.Web.WebPages/RequestExtensions.cs)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:15:12.097

可能是因为 RFC 中的 URL 是由 US-ASCII 代码集定义的，带有保留字符。
您可以在此处阅读有关 URL 规范的信息：[http ://www.ietf.org/rfc/rfc1738.txt](http://www.ietf.org/rfc/rfc1738.txt)

以及来自上述网站/文件的报价：

> URL 仅使用 US-ASCII 编码字符集的图形可打印字符编写。US-ASCII 中不使用八位字节 80-FF 十六进制，八位字节 00-1F 和 7F 十六进制表示控制字符；这些必须被编码。

简而言之，我的猜测是“设计使然”。

注意：RFC 是由 IETF 制定的，它制定了一些技术的标准，例如 URL。

# jquery - 如何在 Ruby on Rails 中创建 ajax 条件确认？

> ID：12642438
> 
> 赞同：1
> 
> 时间：2012-09-28T14:56:22.380
> 
> 标签：jquery, ruby-on-rails-3

我如何使 :confirm=>"Are you sure" 有条件？我有这个代码

```
<div id="container"><%= form_for @question,:remote=>true,:html=>{:name=>"question"} do |f|%>
    <p>
        <div class ="row">
        <%= label_tag(:topic,@displayquestion.question_text,:class=>"form-label")%>
        </div>
    </p>
    <p>
    <label>
    <%= f.radio_button(:answer, "1") %>
    <%= label_tag(:choice1,@displayquestion.choice1,:class=>"form-label")%>
    </label>
    </p>
    <p>
    <label>
    <%= f.radio_button(:answer, "2") %>
    <%= label_tag(:choice2,@displayquestion.choice2,:class=>"form-label")%>
    </label>
    </p>
    <p>
    <label>
    <%= f.radio_button(:answer, "3") %>
    <%= label_tag(:choice3,@displayquestion.choice3,:class=>"form-label")%>
    </label>
    </p>
    <p>
    <label>
    <%= f.radio_button(:answer, "4") %>
    <%= label_tag(:choice4,@displayquestion.choice4,:class=>"form-label")%>
    </label>
    </p>
    <%= f.submit(:value=>next,:class =>"button",:disable_with=>'loading') %>
<% end %></div> 
```

我想让它只有在没有选择单选按钮时才会提示。我有这个 jQuery 代码，如果没有选择单选按钮，它将提示用户。

```
$(document).ready(function(){

   $("#container").on("click", ".edit_question", function(event){

     if (!$("input[@name='question[answer]']:checked").val()) {
       confirm('Are sure you want to submit a blank answer?');
    }

   if (!$("input[@name='answer[]']:checked").val()) {
       confirm('Are sure you want to submit a blank answer?');
    }

}
);
}); 
```

问题是即使我点击取消，也发送了ajax请求，如何拦截ajax请求调用jQuery代码？

谢谢指点！我是这样做的，它有效！

```
$(document).ready(function(){

   $("#container").on("submit", ".edit_question", function(event){
    var reply = true;
     if (!$("input[@name='question[answer]']:checked").val()) {
       reply=confirm('Are sure you want to submit a blank answer?');
    }

   if (!$("input[@name='answer[]']:checked").val()) {
       reply=confirm('Are sure you want to submit a blank answer?');
    }
   return reply;
}
);
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:12:12.333

您的 click 函数需要返回 false 才能取消页面提交。Confirm() 返回一个布尔值，true 表示确定，false 表示取消。

例子：

```
$("#container").on("click", ".edit_question", function(event){

    if (!$("input[@name='question[answer]']:checked").val()
        || !$("input[@name='answer[]']:checked").val()  ) {
        return confirm('Are sure you want to submit a blank answer?');
    }
    return true;
} 
```

# logging - Log4J 警告：初始化 log4j 系统

> ID：12642442
> 
> 赞同：0
> 
> 时间：2012-09-28T14:56:35.440
> 
> 标签：logging, log4j

我正在学习 log4j。但是，我收到这个错误，不确定我是否遗漏了什么。我把所有的罐子都准备好了。

```
public class LoggingDemo {
    private static final Logger logger = LoggerFactory.getLogger(LoggingDemo.class);

    public static void main(String[] args) {
        logger.info("Starting App....");
        System.out.println("Testing log4j.......");
        logger.info("Terminating App!");
    }

} 
```

![在此处输入图像描述](../Images/2382ae505662b9adc113c120c2bd3c2f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:13:45.803

当我创建一个新项目时，我总是得到这个。您需要创建一个 log4j.properties 文件并将其添加到您的类路径中。[请参阅手册http://logging.apache.org/log4j/1.2/manual.html](http://logging.apache.org/log4j/1.2/manual.html)的配置部分

或者只是将您的代码更改为：

```
public class LoggingDemo {
    private static final Logger logger = LoggerFactory.getLogger(LoggingDemo.class);

    public static void main(String[] args) {
        BasicConfigurator.configure();
        logger.info("Starting App....");
        System.out.println("Testing log4j.......");
        logger.info("Terminating App!");
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:14:22.733

我想到了。我缺少一个 log4j.properties 文件。有同样问题的人应该在 src 文件夹中创建一个 log4j.properties 文件，其内容如下。

**输出到控制台**

```
# Root logger option
log4j.rootLogger=INFO, stdout

# Direct log messages to stdout
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.Target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %c{1}:%L - %m%n 
```

![在此处输入图像描述](../Images/5544701f220e4b4e3fbb10f64398bdba.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-10T04:44:04.367

当出现错误时，请初始化 log4j，这意味着项目类路径中的“log4j.properties”文件不可用。

您需要创建一个 log4j.properties 文件并将其添加到您的类路径中。

或者您可以传递 JVM 参数，如下所示

-Dlog4j.configuration=文件:.\log4j.properties

因此 JVM 将从指定的属性初始化 log4j。

在 log4j 文件中，您可以指定以下内容

# 根记录器配置。WARN，它是 log4j 级别，ConsoleAppender 是将输出打印到控制台的附加程序。

log4j.rootLogger=警告，ConsoleAppender

似乎问题与[如何正确初始化 log4j 重复？](https://stackoverflow.com/questions/1140358/how-to-initialize-log4j-properly?s=2|2.9929)

# javascript - 通过javascript设置页面横向

> ID：12642443
> 
> 赞同：2
> 
> 时间：2012-09-28T14:56:52.400
> 
> 标签：javascript, jquery, css, printing

我正在尝试通过 javascript 以横向格式打印页面。我在[HTML 的横向打印](https://stackoverflow.com/questions/138422/landscape-printing-from-html)中找到了一些解决方案，但这些不符合我的需要。

CSS 片段`@media print{@page {size: landscape}}`工作正常，但我不知道如何使它从 javascript/jquery 工作。我尝试通过 javascript 执行此操作的原因是因为我想要 2 个用于打印的按钮。一个普通的打印按钮可以像显示的那样打印内容，第二个按钮可以稍微改变页面并以横向模式打印。

简而言之：我想将页面方向（或在 CSS 中称为大小）更改为 javascript 中的横向，但 javascript 旋转不会这样做，因为它也会旋转页面上的文本。有没有办法在不使用不同的布局/CSS制作单独的页面的情况下实现我想要做的事情？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:11:00.857

您可以在另一个样式表上移动该规则并在单击时动态添加它：

```
$("#printLandscape").on('click',function () {
    $('head').append('<link href="printLandscape.css" title="printLandscape" rel="stylesheet" />');
}); 
```

我假设您的“以横向模式打印”按钮有一个`printLandscape`ID。

*现在，为了确保即使在*第一次单击按钮后用户也能够以正常模式打印，您可以向“以正常模式打印”按钮添加另一个侦听器：

```
$("#printNormal").on('click',function () {
    $('link[title="printLandscape"]').attr('disabled', 'disabled').remove();
}); 
```

为此，您必须将 a 设置`title`为横向样式表（在这种情况下我称之为`printLandscape`）

# objective-c - 使用 CFNetwork 与 FTP 的连接崩溃

> ID：12642451
> 
> 赞同：3
> 
> 时间：2012-09-28T14:57:24.020
> 
> 标签：objective-c, ios, xcode, ftp, cfnetwork

我想使用 CFNetwork 从我的 FTP 下载文件。

每次我运行我的 iOS 应用程序（iOS 6.0 SDK）时，以下代码都会崩溃。调试器只是说“（lldb）”

[http://pastebin.com/5XQD9ih1](http://pastebin.com/5XQD9ih1)

我发现如果我为 inputStream 或 outputStream 设置委托，应用程序就会崩溃。所以它与代表有关。但是没有任何错误消息我不知道如何开始搜索问题？有任何想法吗 ？

# python - Python "if" evaluates both hand sides of "and"?

> ID：12642455
> 
> 赞同：0
> 
> 时间：2012-09-28T14:57:38.810
> 
> 标签：python

Can anybody tell me why the following fails:

```
teststr = "foo"
if not teststr.isdigit() and int(teststr) != 1:
   pass 
```

with:

```
ValueError: invalid literal for int() with base 10: 'foo' 
```

In C if the first part in an `&&` test fails the right hand side is not evaluated anymore. Is this different in Python?

EDIT: I am being stupid. The `and` should be an `or` of course.....

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T14:59:42.410

`not teststr.isdigit()` is True, so the first test doesn't fail.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T15:00:48.713

```
if not teststr.isdigit() and int(teststr) != 1: 
```

is evaluated as

```
if ((not teststr.isdigit()) and (int(teststr) != 1)): 
```

well, but `teststr` is not a digit, so `isdigit()` is false, so `(not isdigit())` is true. And for `True and B`, you have to eval B. That's why it tries the cast to int.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:00:31.597

`if not teststr.isdigit()` is True, so then it needs to evaluate `int(teststr)` to complete the requirements of the `and` - hence the exception.

Instead of pre-checking data, utilise EAFP - and use something like the following...

```
try:
    val = int(teststr)
    if val != 1:
        raise ValueError("wasn't equal to 1")
except (ValueError, TypeError) as e:
    pass # wasn't the right format, or not equal to one - so handle
# carry on here... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T15:08:08.150

The code you probably want to use would probably be

```
try:
    int(teststr)
except ValueError:
    print "Not numeric!" 
```

It's generally more pythonic to try something and catch exceptions rather than use type-checking methods like you did.

# javascript - 如何使用 Chrome 的开发工具更改局部变量的值？

> ID：12642456
> 
> 赞同：11
> 
> 时间：2012-09-28T14:57:40.557
> 
> 标签：javascript, debugging, google-chrome-devtools

我正在使用 Chrome 的 (v21) 开发工具来调试大型 javascript 应用程序。在单步执行代码时，我想更改本地（函数范围）变量的值。我该怎么做呢？

我试过了：

1.  单击“范围”窗口中的变量并对其进行编辑，然后按 Enter。Scope 窗口中的值按预期更改，但是当我进入下一行时，该变量会恢复为旧值。
2.  在控制台中输入“variable = 123”。按 Enter 后，控制台“结果”是我输入的值，但变量本身的值没有变化。如果我然后输入“变量”并按 Enter，控制台将返回原始值；Scope 窗口也仍然显示原始值。

同样，这是一个局部的、函数范围的变量，并且当前执行行位于定义变量的同一范围内。

这个[另一个问题](https://stackoverflow.com/questions/11929215/change-local-variable-or-function-parameter-in-google-chrome)本质上是重复的，但没有得到任何有用的答案（可能是因为它写得不好）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T12:03:50.183

此功能尚未实现。这样做是绝对合理的，希望它很快会在 V8-protocol-devtools 中实现。

# java - 基于字符串加载图片

> ID：12642457
> 
> 赞同：1
> 
> 时间：2012-09-28T14:57:46.400
> 
> 标签：java, android, string, image

我的最终目标是：我有两个微调器`spinner1, spinner2`，每个都有自己的值。一张图片，名为`image`. 有字符串，名为`start, end, file`. 一键，`button`。

我的代码如下所示：

```
@Override
public void onClick(View v) {
    start = sStart.getSelectedItem().toString();
    end = sEnd.getSelectedItem().toString();
    if (start.equals(end)) {
        Toast.makeText(this, "You cannot end where you start.",
                Toast.LENGTH_SHORT).show();
        works = false;
    }
    if (works) {
        start = start.replace(" ","_");
        end = end.replace(" ","_");
        file = "@drawable/" + start + end + ".gif";
    }
} 
```

文件名与内容`start + end + ".gif"`完全匹配，所以我想将图像设置为与字符串内容对应的文件名。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:10:07.853

我做了什么（或多或少，我面前没有我的代码），我把我的图像文件放在资产中，然后我创建了我的方法：

```
InputStream stream = context.getAssets().open(filename);
Bitmap bmp = BitmapFactory.decodeStream(new BufferedInputStream(stream)); 
```

这从资产中读取文件并将其转换为位图

你也可以使用 context.getResources() 但我不记得下一步该做什么

# c# - 加载图像显示 ASP.NET 中的所有服务器端请求以及客户端请求

> ID：12642458
> 
> 赞同：1
> 
> 时间：2012-09-28T14:57:47.517
> 
> 标签：c#, javascript, jquery, asp.net

在我们的项目中，我们有所有类型的按钮和链接，如链接按钮、图像按钮、普通按钮和 HTML 按钮，我想在页面要加载时显示加载图像，但如果发生任何验证错误，则在保存页面时显示一段时间然后加载图像正在显示，如果我单击 HTML 锚标记，那么它也会显示我正在加载消息。我在大型项目中工作，所以我想在母版页 ASP.NET 上一次绑定所有事件。

代码：

```
<style type="text/css">
    #dvLoading {
    background: url(/images/activity.gif) no-repeat center center;
    height: 100px;
    width: 300px;
    position: fixed;
    z-index: 1000;
    left: 50%;
    top: 50%;
    margin: -25px 0 0 -25px;
    }
</style>

<div id="dvLoading" style="display:none;"></div>

<script type="text/javascript">
    $("a").click(function(event) {
        //$('#dvLoading').toggle('slow');
        $('#dvLoading').slideDown();
    });
    $("input:image").click(function(event){ 
        //$('#dvLoading').toggle('slow');
        $('#dvLoading').slideDown();
    });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:40:19.107

您是否尝试在表单提交上注册您的脚本？

```
StringBuilder sb = new StringBuilder();
sb.Append(" if (typeof(ValidatorOnSubmit) == 'function' && ValidatorOnSubmit() == false) {\n");
sb.Append("     return false; \n");
sb.Append(" } \n");
sb.Append(" $('#dvLoading').slideDown(); \n");

Page.ClientScript.RegisterOnSubmitStatement(typeof(Page), "displayLoadingPanelOnFormSumbit", sb.ToString()); 
```

# debugging - Tcl 程序的行为根据“puts”语句而改变

> ID：12642460
> 
> 赞同：0
> 
> 时间：2012-09-28T14:57:56.470
> 
> 标签：debugging, crash, tcl, puts

主要问题：

**一个`puts`语句（仍然是硬编码的字符串）如何影响程序流程？**

* * *

我将直接研究不完整的代码片段，原因将在后面解释。

```
proc bgerror { error } {
    puts "Background error: $error"
    exit 1
} 
```

运行我的 Tcl 程序，我得到：

```
Background error: can't read "YPE(PROCESS)": no such variable 
```

很公平，我想；一定是在`$`某处弄脏了一个或括号。为了找到问题，我把`puts`语句放在各处，然后重新运行程序。

然而，这一次，我的程序崩溃了：

```
9526:   tclsh testProgram
 fffffd7ffeafebba waitid   (0, 253d, fffffd7fffdf4950, 3)
 fffffd7ffeaeff9d waitpid () + 7d
 fffffd7ffe635132 __1cPGetPstackOutput6Fiiipci_v_ () + b2
 fffffd7ffe634bfb App_CoreSignalHandler () + 76b
 fffffd7ffeafb7b6 __sighndlr () + 6
 fffffd7ffeaf0b82 call_user_handler () + 252
 fffffd7ffeaf0d68 sigacthandler (b, fffffd7fffdfa500, fffffd7fffdfa1a0) + a8
 --- called from signal handler with signal 11 (SIGSEGV) --- 
```

哎哟。

最终，我注意到了一件非常奇怪的事情：

```
proc OnNewState { } {
    puts "foobar"
    # ...
} 
```

*随着*声明，我得到了`puts`崩溃。*没有*它，我会得到原始错误。（嗯？！）我来回翻转了很多次，以确保它是确定性的——而且确实如此。

现在，我一头扎进不完整的代码片段的原因是我想把注意力集中在抽象上，而不是细节上。

（完整的代码复杂且不透明，主要使用我公司的基础设施库，因此无论如何简化它以使其易于理解是不切实际的。此外，我已经*知道*问题源于其中一个基础设施库，因为问题消失了当我删除一些与 TCP 发布者/订阅者堆栈库相关的代码时。）

**一个`puts`语句（仍然是硬编码的字符串）如何影响程序流程？**

即使我开始深入研究相关库的 C 源代码，我也不知道要寻找什么。

希望有经验的Tcl'ers能有所启发...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T08:07:59.983

首先，您提供的证据告诉我们您在一个带有 SIGSEGV 处理程序的上下文中，并且它是由自定义代码设置的（Tcl 没有设置 SIGSEGV 处理程序）。

Tcl 的`puts`命令只会通过生成错误来影响控制流，并且如果您传递错误数量的参数、无效参数或在 I/O 层中遇到问题（例如，如果您关闭了`stdout`通道），它会影响控制流。一个简单`puts "foobar"`的调用肯定是有效的，所以问题出在通道层。或者你有一个非标准的`puts`；如果您的自定义代码替换了标准版本，那么几乎任何事情都可能发生。

那么可能会发生什么？好吧，在这个阶段，我最初的怀疑是您的程序中的其他地方存在内存损坏，并且这以某种方式影响了`stdout`通道的内部。如果我是对的，你会发现很难找到这个。***非本地崩溃总是难以追踪***。我建议您使用关闭该信号处理程序的某种组合，附加`gdb`以便您可以看到崩溃*真正*发生的位置，并使用`valgrind`以确保正确处理内存（如果幸运的话，`valgrind`将指出问题出在哪里直接关掉）。

# c# - 由于高速网络，应用程序在获取进程输出时卡住

> ID：12642467
> 
> 赞同：0
> 
> 时间：2012-09-28T14:58:27.560
> 
> 标签：c#, winforms

我有一个应用程序捕获（使用wireshark）数据包，我希望选择在我的表单上显示正在接收的数据包数量。

代码：

```
public class Tshark
{
    public int _interfaceNumber;
    public string _pcapPath;
    public int _packetsCount;
    public string _packet;
    public delegate void dlgPackProgress(int progress);
    public event dlgPackProgress evePacketProgress;

    public Tshark(int interfaceNumber, string pcapPath)
    {
        _interfaceNumber = interfaceNumber;
        _pcapPath = pcapPath;
    }

    public void startTheCapture()
    {
        Process _tsharkProcess1 = new Process();
        _tsharkProcess1.StartInfo.FileName = @"C:\Program Files\Wireshark\tshark.exe";
        _tsharkProcess1.StartInfo.Arguments = string.Format(" -i " + _interfaceNumber + " -V -x -w " + _pcapPath);
        //_tsharkProcess1.StartInfo.Arguments = string.Format(" -i " + _interfaceNumber + " -c " + int.MaxValue + " -w " + _pcapPath);
        _tsharkProcess1.OutputDataReceived += new DataReceivedEventHandler(process_OutputDataReceived);
        _tsharkProcess1.StartInfo.RedirectStandardOutput = true;
        _tsharkProcess1.StartInfo.UseShellExecute = false;
        _tsharkProcess1.StartInfo.CreateNoWindow = true;
        _tsharkProcess1.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
        _tsharkProcess1.Start();

        StreamReader myStreamReader = _tsharkProcess1.StandardOutput;

        while (!myStreamReader.EndOfStream)
        {
            _packet = myStreamReader.ReadLine();

            //if (_packet.StartsWith("Frame Number: "))
            //{
            //    string[] arr = _packet.Split(' ');
            //    _test = int.Parse(arr[2]);
            //    _packetsCount++;
            //}

            OnPacketProgress(_packetsCount++);
        }

        _tsharkProcess1.WaitForExit();
    }

    private void OnPacketProgress(int packet)
    {
        var handler = evePacketProgress;
        if (handler != null)
        {
            handler(packet);
        }
    }

    public void killProcess()
    {
        foreach (Process prc in System.Diagnostics.Process.GetProcessesByName("tshark"))
        {
            prc.Kill();
            prc.WaitForExit();
        }
    }

    private void process_OutputDataReceived(object sender, DataReceivedEventArgs arg)
    {
        string srt = arg.Data; //arg.Data contains the output data from the process...            
    }
} 
```

这个类启动 Tshark 并从主窗体开始捕获我有这个 ProgressChanged，它对类属性进行采样，以便在我的窗体上显示数据包编号，问题是，例如，如果我的网络上有很高的速度（BitTorrent 下载）我的表格卡住了，也许我可以通过每隔几秒钟对类属性进行采样来解决这个问题？

```
private void bgWSniffer_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    tshark = e.UserState as Tshark;
    lbl.Text = tshark._packetsCount.ToString();
    lbl.Text = tshark._packet;
} 
```

我知道有问题的行是 OnPacketProgress(_packetsCount++);

我开始捕获的开始按钮：

```
private void btnStartCapture_Click(object sender, EventArgs e)
{
    lblStatusSnifferTab2.Text = "Listening on ip address " + lblIpAddressSnifferTab2.Text;
    timerSniffer.Start();
    btnStartTabSniffer.Enabled = false;
    btnStopTabSniffer.Enabled = true;
    groupBoxSelectTabSniffer.Enabled = false;
    groupBoxOptionsSnifferTab.Enabled = false;
    groupBoxCaptureFilesTabSniffer.Enabled = false;
    groupBoxStopCaptureSnifferTab.Enabled = false;
    bgWorker = new BackgroundWorker();
    bgWorker.WorkerReportsProgress = true;
    bgWorker.ProgressChanged += new ProgressChangedEventHandler(bgWSniffer_ProgressChanged);
    bgWorker.DoWork += new DoWorkEventHandler(
        (s3, e3) =>
        {
            tshark = new Tshark(2, pcapFilePathSniffer);                    

            tshark.evePacketProgress += new Tshark.dlgPackProgress(
                (packet) =>
                {
                    bgWorker.ReportProgress(packet, tshark);
                });

            tshark.startTheCapture();
        });

    bgWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(
        (s3, e3) =>
        {
            groupBoxSelectTabSniffer.Enabled = true;
            groupBoxCaptureFilesTabSniffer.Enabled = true;
        });

    bgWorker.RunWorkerAsync();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:03:33.753

一种解决方案是（使用毫秒，以便您可以进行精细控制，如果您想要的只是秒，您可以使用 TotalSeconds）：

```
 DateTime lastUpdate = DateTime.MinValue;

    while (!myStreamReader.EndOfStream)
    {
        _packet = myStreamReader.ReadLine();

        //if (_packet.StartsWith("Frame Number: "))
        //{
        //    string[] arr = _packet.Split(' ');
        //    _test = int.Parse(arr[2]);
        //    _packetsCount++;
        //}

        // If more than one second
        if((DateTime.Now - lastUpdate).TotalMilliseconds > 1000)
        {
            lastUpdate = DateTime.Now;
            OnPacketProgress(_packetsCount++);
        }
    } 
```

另外，我注意到的另一件事是，您在调用 OnPacketProgress 时使用后增量。这将传递 _packetsCount 的当前值，然后在 OnPacketProgress 返回后将其递增。你应该仔细检查这是否是你想要的。

# .net - 使用 NServiceBus FileShareDataBus 时清理文件

> ID：12642468
> 
> 赞同：3
> 
> 时间：2012-09-28T14:58:30.340
> 
> 标签：.net, nservicebus

我在 NServiceBus 3 中使用 FileShareDataBus。是否支持清理数据总线文件？

如果不是，那么实现这一点的最佳实践是什么（比如如何确保文件不是错误队列中消息的一部分）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T19:52:25.330

鉴于不可能知道一条消息在错误队列中停留多长时间，我通常会在相当长的一段时间后清除（Max(SLA) + x 天）

# ios - 我在哪里可以获得用于 http 直播的 mediastreamsegmenter？

> ID：12642469
> 
> 赞同：2
> 
> 时间：2012-09-28T14:58:32.283
> 
> 标签：ios, http-live-streaming

我似乎找不到 OSX Lion 的 mediastreamsegmenter 或 mediafilesegmenter 命令行实用程序。我安装了 Xcode 4.5，但它不在 /usr/bin 中

很多谷歌搜索结果都说去 connect.apple.com 并搜索“http live streaming”，但这只会产生这样的结果：

![在此处输入图像描述](../Images/dfb0ffb67c21564a441bef074b5f0b60.png)

[Apple Http live Streaming](https://developer.apple.com/streaming/)站点右侧的[开发者工具链接产生了相同的结果。](https://developer.apple.com/downloads/index.action?=http%20)这是这些命令行实用程序的替代品吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-05-06T15:52:24.090

要在页面上查看此下载，需要遵循三件重要的事情。

1.  您必须是付费 iOS 开发者计划会员
2.  [https://developer.apple.com/downloads/index.action?=http%20live%20streaming%20tools](https://developer.apple.com/downloads/index.action?=http%20live%20streaming%20tools)
3.  您必须使用 Safari 浏览器

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-20T03:52:46.110

我的开发者订阅已失效。更新后，我可以看到该工具。

# android - 如何显示来自arraylist的订单列表？

> ID：12642470
> 
> 赞同：2
> 
> 时间：2012-09-28T14:58:35.093
> 
> 标签：android, arraylist, android-arrayadapter

我有一个数组列表中的订单列表。我的问题是，虽然我可以调用它，但我无法显示 arraylist 的所有元素。

我想在单击特定按钮（例如查看我的订单）和新的意图/不同的类后显示它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:32:16.257

您必须为此使用列表视图。您可以使用 visibility:hidden 创建您的列表视图，并为您的按钮实现一个 onclickListener，这会将列表视图的可见性设置为可见。

要填充列表视图，请参阅：[使用 ArrayList 填充 ListView？](https://stackoverflow.com/questions/5070830/populating-a-listview-using-arraylist)

要使列表视图可见：

```
ListView lv = findViewById(R.id.listView);
lv .setVisibility(View.GONE); 
```

# iphone - 目标 c 中未调用 CallEventhandler

> ID：12642471
> 
> 赞同：1
> 
> 时间：2012-09-28T14:58:40.837
> 
> 标签：iphone

我必须在通话结束时获得通话状态，但我的事件没有被调用，就像行总是返回 false

[callCenter setCallEventHandler: ^(CTCall* call)

这是我的代码

```
CTCallCenter *callCenter = [[CTCallCenter alloc] init];
callCenter.callEventHandler=^(CTCall* call)
{

    if(call.callState == CTCallStateDialing)
    {
        //The call state, before connection is established, when the user initiates the call.
        NSLog(@"Call is dailing");
    }
    if(call.callState == CTCallStateIncoming)
    {
        //The call state, before connection is established, when a call is incoming but not yet answered by the user.
        NSLog(@"Call is Coming");
    }

    if(call.callState == CTCallStateConnected)
    {
        //The call state when the call is fully established for all parties involved.
        NSLog(@"Call Connected");
    }   

    if(call.callState == CTCallStateDisconnected)
    {
        //The call state Ended.
        NSLog(@"Call Ended");
    }

}; 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:04:12.427

你的代码看起来不错；但是，如果您的应用在调用事件期间暂停，则不会调用您的事件处理程序。

来源：[CTCallCenter 类参考](https://developer.apple.com/library/ios/#documentation/NetworkingInternet/Reference/CTCallCenter/Reference/Reference.html)

> 如果您的应用程序在调用事件发生时处于活动状态，则系统会立即将该事件分派给您的处理程序。但是，调用事件也可能在您的应用程序暂停时发生。当它被挂起时，您的应用程序不会收到呼叫事件。当您的应用程序恢复活动状态时，它会为每个更改状态的调用接收一个调用事件 - 无论您的应用程序暂停时调用经历了多少状态更改。当您的应用程序返回活动状态时，发送到您的处理程序的单个调用事件描述了当时调用的状态。

# forms - Symfony2 复选框选择字段：禁用一个复选框

> ID：12642473
> 
> 赞同：1
> 
> 时间：2012-09-28T14:58:50.050
> 
> 标签：forms, symfony

我的任务是禁用表单选择字段中的某些复选框，而有些则不禁用。有没有一种简单的方法可以在不重写选择字段布局的情况下实现这一目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:38:51.240

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-08-10T15:47:33.220

我想澄清有关 Flavien 解决方案的一些信息，但我没有足够的声誉在他的帖子下发表评论。

 ~~~~```
$builder->add('myChoice', 'choice', array('attr'=>array('disabled'=>'disabled'))); 
```~~  ~~'disabled'=>'disabled' 的使用是错误的（因为正确的部分是错误的）。它可以工作，但禁用（左）接受布尔值，应该接收真或假。在这种情况下，它确实有效，因为除了 0 之外的任何东西都是真的。

我为什么要解释这个？因为也许有人想在不同的地方使用相同的表单并且只禁用一个输入（实际上使其只读）。因此，他将向“禁用”参数提供一个变量，如果该变量不是布尔值，它将始终导致禁用输入。

tl;博士

```
 $builder->add('myChoice', 'choice', array('attr'=>array('disabled'=>true))); 
```

或者

```
$builder->add('myChoice', 'choice', array('attr'=>array('disabled'=>false))); 
```~~~~

# css - CSS动画。从[显示无；宽度：0]到[显示内联；宽度：自动]

> ID：12642476
> 
> 赞同：2
> 
> 时间：2012-09-28T14:58:56.313
> 
> 标签：css, animation, width

我在另一个跨度内有一个隐藏的跨度。当我将鼠标悬停在外部跨度上时，我想为隐藏的跨度设置动画以滑出并显示。

```
<span class="outer">Things: <span class="number">5 <span class="details">[3 widgets, 2 spanners]</span></span></span> 
```

CSS：

```
.outer {
    border: 1px solid grey;
    border-radius: 4px;
    padding: 7px;
    margin: 1em;
    font-family: Verdana;
}

.number {
    background-color: green;
    color: white;
    padding: 3px 7px;
    border-radius: 4px;
}

.details {
    display: none;       
}

.outer:hover .details {
    display: inline;  
} 
```

这是我在没有动画的情况下工作的示例：http: [//jsfiddle.net/QSQBV/13/](http://jsfiddle.net/QSQBV/13/)

我希望隐藏的跨度从 0 增长到宽度“自动”或淡入。

- 编辑 -

好吧，我对jsFiddle很烂，我想我忘了保存它什么的，反正旧链接没有显示我想要的效果。新更新的链接确实显示了效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:53:33.353

您需要`background-color`为不透明度提供 a 才能正常工作。

这是你需要的吗？JSFiddle 链接：http: [//jsfiddle.net/QSQBV/73/](http://jsfiddle.net/QSQBV/73/)

编辑：根据您的要求更新 JSFiddle。希望这是你需要的！我用了`div`而不是`span`

# javascript - 如何使用 IWebBrowser2 修复应用程序中的 javascript 错误？

> ID：12642479
> 
> 赞同：2
> 
> 时间：2012-09-28T14:58:58.000
> 
> 标签：javascript, c++, windows, iwebbrowser2

我有一个 C++ 应用程序，它使用 IWebBrowser2 接口来呈现一些在线 html 页面。问题是，当访问某个链接时，我收到一个 javascript 错误，尽管如果我使用 Internet Explorer 访问同一页面，页面加载时不会出现错误。我的应用程序中收到的错误是“对象不支持此操作”

我可以通过使用 put_Silent() 方法并将其设置为 VARIANT_TRUE 来隐藏错误，但这不是解决方案，因为显示的内容不正确。

我知道 IWebBrowser2 正在使用 Internet Explorer 引擎加载页面，所以我想有一种方法可以解决这个问题，因为页面在 IE 中加载正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T22:07:02.800

您可能必须实现[IDocHostShowUI::ShowMessage](http://msdn.microsoft.com/en-us/library/aa753271%28v=vs.85%29.aspx)。

> 当您的应用程序托管浏览器控件时，您可以将 Windows Internet Explorer 消息框标题（用于 Microsoft JScript 警报等）替换为自定义标题

我想你会想要返回 S_FALSE。

> S_FALSE 主机未显示其 UI。MSHTML 显示其消息框。

# shell - 在 Emacs 中调整终端大小

> ID：12642493
> 
> 赞同：9
> 
> 时间：2012-09-28T14:59:30.790
> 
> 标签：shell, emacs, ansi-term

假设我有一个 Emacs 窗口（即 Emacs 称为帧的细分）运行一个像素宽的`M-x ansi-term`缓冲区（例如 running `zsh`） 。`~500`然后我运行几个 shell 命令，输出被包装以适合这些`500`像素。

假设我现在使这个窗口或缓冲区更宽（例如`1000`像素），可能是因为我杀死了框架中的其他窗口，从而为我的`ansi-term`窗口提供了更多空间。

有没有办法让我的`ansi-term`窗口中的旧输出调整大小以利用新的窗口大小？（即使线条更宽并根据新窗口大小重新包装它们）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-16T18:55:23.690

不，通常不会，因为生成输出的程序（可能已经）格式化了自身以适应打印时有效的显示宽度，并且在调整大小时不再运行。

但是，如果它*仍在*运行，它将获得调整自身大小的选项（a `SIGWINCH`）。您可以使用例如`links`/`elinks`浏览器对此进行测试。这是 ANSI 终端模式的真正“用例”：使用“curses”或类似系统来移动光标的程序。

正如@user2491 指出的那样，`shell-mode`确实使用自动换行处理基于文本（基于流）的输出，但代价是无法运行“诅咒”类型的程序。它旨在让您的会话更像是一个文本文件，而不是“真正的终端”。</p>

# ssl - 安全性 JDBC 和 Google Apps 脚本

> ID：12642496
> 
> 赞同：4
> 
> 时间：2012-09-28T14:59:35.470
> 
> 标签：ssl, jdbc, google-apps-script

我有一个关于 JDBC 服务的安全相关问题。

Google Scripts 和远程数据库之间的 JDBC 连接有多安全？有什么方法可以配置 SSL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T08:18:53.967

由于无法访问 Java 信任库以生成客户端证书，因此我看不出这怎么可能。

至于连接的安全性，如果您使用防火墙规则只允许 Google 服务器连接到您的 jdbc 端口：

```
nslookup -q=TXT _netblocks.google.com 8.8.8.8 
```

在您的 mysql 服务器上，将用户的主机组件设置为也只允许这些 IP 范围，并设置一个安全的证书大小密码以防万一。

中间人攻击将是您唯一真正的安全问题，现在不确定 MIM 攻击的可能性有多大......

# wpf - 使用 WPF 绘图时如何摆脱这些“尖峰”视觉伪影？

> ID：12642502
> 
> 赞同：4
> 
> 时间：2012-09-28T14:59:51.540
> 
> 标签：wpf, drawing, visual-artifacts

我目前正在为地图应用程序绘制一些图块（小方形图像）。

我正在使用 WPF 在这些图块上绘制形状。

我有一个地理空间坐标列表，这些坐标组成了绘制的多边形。

构成这些多边形的地理空间坐标被转换为像素坐标。

瓷砖是在不同的细节层次上创建的。

在大多数这些细节层次上，绘图都很好。但在某些级别，视觉伪影以尖峰或线条的形式出现。

这是一个示例，这些图像具有三个不同的细节级别，一个显示问题，两个显示问题没有发生的两侧。

此图像是最高细节级别，还可以：

![好的图片](../Images/e3484ef5572c485bce5b1d70f9e47933.png)

此图像处于中等细节级别，并显示了尖峰（85 号公路沿线的尖峰最容易发现）：

![坏形象](../Images/90f582e085b31b36bb2ec31802ba0612.png)

此图像的细节级别最低，还可以：

![在此处输入图像描述](../Images/cd59f72df8b60841e193853075e244f6.png)

当多边形中的两条线彼此靠近和/或形成一个密集点（收敛）时，就会出现尖峰。

我们已经检查了源数据并且这些工件不存在（这也可以通过它在大多数时间正确呈现的事实得到证实）。

下一个怀疑是坐标转换过程，但我们再次检查了它，生成的点不应该以这种方式绘制。

这让 WPF 成为罪魁祸首，让我们陷入困境，因为我们不能像使用自己的代码那样简单地解决问题。

你们以前见过这种东西吗？

修复会很棒;）

目前看来，我们要么不得不忍受这个问题，要么改用 Direct2D。我们已经放弃了 GDI+ 渲染，因为它在一个进程中是单线程的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T09:49:43.407

解决方案是将 Pen 对象上的 LineJoin 属性更改为“Round”。

[http://msdn.microsoft.com/en-us/library/system.windows.media.pen.linejoin.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.pen.linejoin.aspx)

[http://msdn.microsoft.com/en-us/library/system.windows.media.penlinejoin.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.penlinejoin.aspx)

非常感谢 Moozhe 在评论中提供了这个答案。

# java - 理解 Java 中的数学公式

> ID：12642504
> 
> 赞同：-1
> 
> 时间：2012-09-28T14:59:57.847
> 
> 标签：java, pi

在经历了相当大的休息后，我只是想回到 Java 语言的编程方式，所以我决定编写一个程序来计算 PI 到用户输入的数字：

例如，他们输入 5，它将返回 3.14159。

经过一番搜索，我遇到了 Leibnez 公式，但不知道如何在代码中实现。这似乎是一个反复出现的问题，所以我想纠正它。任何人都有任何资源来演示如何编写数学公式？

例如，解释 1e6 的东西等等？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:25:06.553

作为起点，您可以使用此代码，它实现了此处描述的和符号[Leibniz formula for π](http://en.wikipedia.org/wiki/Leibniz_formula_for_%CF%80)

```
public class PI {
    public static void main( String[] args) {
        double PI4 = 1.0;
        for ( int i = 1 ; i <= 50 ; i++ ) {
            double nom = Math.pow( -1, i );
            double denom = 2 * i + 1;
            PI4 += nom / denom;
        }
        System.out.println( "result=" + PI4 * 4 );
    }

} 
```

50 次迭代后，结果为 3.1611986129870506

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:08:14.337

我建议您在线阅读一个好的数学教程，以便您首先了解数学。然后一个好的基本编程教程应该可以完成这项工作。

[Stack Exchange 的数学部分](https://math.stackexchange.com/)也是数学概念的一个很好的参考。

# jsf - Primefaces & jqplot - 在轴上显示日期

> ID：12642507
> 
> 赞同：3
> 
> 时间：2012-09-28T15:00:01.523
> 
> 标签：jsf, primefaces, jqplot

我正在尝试在 PrimeFaces 3.4 的折线图上使用扩展器属性。我需要使用扩展器用日期/时间值格式化 x 轴。在没有扩展器的情况下执行此操作不是一个选项，因为数据点太多，如果我使用默认的 PF lineChart 属性，标签只会覆盖。当我设置如下所示的代码时，我得到一个没有显示值的 x 轴；我只能看到x轴。查看图片了解更多详情。如何进行设置，以便 x 轴以 hh:mm 格式显示时间？

![图表显示](../Images/a49ee2cce905aaa079f8b93dc7eba524.png)

XHTML 代码

```
<script type="text/javascript" src="#{request.contextPath}/js/plugins/jqplot.dateAxisRenderer.min.js"></script>
<script type="text/javascript" src="#{request.contextPath}/js/plugins/jqplot.canvasAxisTickRenderer.min.js"></script>
<script type="text/javascript">
 function loginRateChartExt() {
  this.cfg.axes = { 
   yaxis: {
    numberTicks: 10,
    label: 'Logins per minute ->',
    labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
    labelOptions: { fontFamily: 'Verdana', fontSize: '8pt' },
   },
   xaxis: { 
    renderer: $.jqplot.DateAxisRenderer,
    rendererOptions: { tickRenderer:$.jqplot.CanvasAxisTickRenderer },
    tickOptions: { formatString:'%H:%M' },
    label: 'Time of day ->',
    labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
    labelOptions: { fontFamily: 'Verdana', fontSize: '8pt' }
   }
  }; 
 }
</script>
<p:lineChart id="loginRateChart" value="#{loginRateBean.chartModel}" extender="loginRateChartExt" /> 
```

豆码

```
for(int i = 0; i < workerBean.getSize(); i++) { // worker bean has the data
  for (String key : workerBean.getValueKeys()) { // each key refers to a series
    // chartSeriesMap is a map that contains all the series
    // workerBean.getKeyAt(i) returns Date
    // workerBean.getValueAt(i, key) returns a Number
    chartSeriesMap.get(key).set(workerBean.getKeyAt(i), workerBean.getValueAt(i, key).floatValue());
  }
}
for (String string : workerBean.getValueKeys()) {
 chartModel.addSeries(chartSeriesMap.get(string));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T19:49:44.127

**要实现它，您必须使用.getTime()**将日期值设置为 LONG ；

```
serie.set(registro.getDataAfericao().getTime(), registro.getValor()); 
```

欲了解更多信息： http: [//forum.primefaces.org/viewtopic.php?f=3 &t=23891&start=10](http://forum.primefaces.org/viewtopic.php?f=3&t=23891&start=10)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:08:19.160

将 min 属性添加到扩展器似乎可以解决显示问题。我在stackoverflow的另一个问题上看到了这一点（下面的链接）。有人知道这是否是解决方法吗？

[jqPlot DateAxis tickInterval 不起作用](https://stackoverflow.com/questions/8467233/jqplot-dateaxis-tickinterval-not-working)

# spring - 无法在课堂上注入 Spring-bean

> ID：12642515
> 
> 赞同：1
> 
> 时间：2012-09-28T15:00:31.997
> 
> 标签：spring, javabeans, autowired

我有以下课程：

```
@Component("persistenceJPAConfig")
public class JPAPersistenceConfig {...} 
```

使用 Spring，我可以通过在我想要使用 JPAPersistenceConfig - 类的目标类中添加一个带有 @Autowired-annotation 的方法来“注入”类。我工作正常，课程本身很好。

问题是我必须在运行时创建一个类（编写源代码并编译它），它也必须使用 bean。

我也添加了自动连线方法，但它一直为空。

```
@org.springframework.stereotype.Component("Customers")
public class Customers  {
    public Customers() {
    }
    private org.product.server.database.JPAPersistenceConfig persistenceJPAConfig; 

    @org.springframework.beans.factory.annotation.Autowired 
    public void setPersistenceJPAConfig(org.product.server.database.JPAPersistenceConfig persistenceJPAConfig) {
        this.persistenceJPAConfig = persistenceJPAConfig;
    }  
    public void someMethod() {
        this.persistenceJPAConfig.getClassByName(...)
        // Throws nullpointer
    }
} 
```

我是否也必须用 @Component 标记生成的文件，以便它成为 Spring 中的“托管 bean”？它是如何在运行时在 Spring 中注册的？

拼命地你的:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:32:28.283

您可以在运行时注册 bean：

```
DefaultListableBeanFactory beanFactory = (DefaultListableBeanFactory) applicationContext.getBeanFactory();
beanFactory.registerBeanDefinition("myClass", BeanDefinitionBuilder.rootBeanDefinition(MyClass.class.getName()).getBeanDefinition()); 
```

如果你的类有自动装配的属性，它们也会被注入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:37:21.893

除了@vacuum 所说的之外，您还可以使用 注释生成的类`@Component`并在运行时对其进行扫描以生成具有其依赖项的 bean `ClassPathScanningCandidateComponentProvider`，请看[这里](https://stackoverflow.com/questions/259140/scanning-java-annotations-at-runtime/1415338#1415338)

# asp.net - FormsAuthenticationTicket 不存储 UserData

> ID：12642516
> 
> 赞同：2
> 
> 时间：2012-09-28T15:00:36.100
> 
> 标签：asp.net, forms-authentication

我对 .NET 比较陌生，正在尝试弄清楚 FormsAuthentication。我经历了几个不同的教程，每次遇到同样的问题。由于某种原因，UserData 没有存储在票证中。当我在 Global.aspx.cs 中的票证上设置中断时，UserName 在那里，但 UserData 是一个空字符串，当它被指定为 1 时，版本设置为 2。另一个奇怪的事情是每个经过身份验证的用户都被允许当 web.config 指定只有管理员可以访问我的 Admin_Content 文件夹中的页面。

登录.aspx

```
UserFull user = ManageUsers.login(loginTemplate.UserName, loginTemplate.Password);
if (user != null)
{
    string[] roles = { user.role };

    FormsAuthenticationTicket authTicket = new FormsAuthenticationTicket(
        1,
        userName,
        DateTime.Now,
        DateTime.Now.AddDays(30),
        true,
        roles[0],
        FormsAuthentication.FormsCookiePath
    );

    string encryptedTicket = FormsAuthentication.Encrypt(authTicket);
    FormsAuthentication.SetAuthCookie(encryptedTicket, true);

    Response.Redirect("Admin_Content/Admin.aspx");
 } 
```

Global.aspx.cs Application_AuthenticateRequest

```
if (HttpContext.Current.User != null)
{
    if (HttpContext.Current.User.Identity.IsAuthenticated)
    {
        if (HttpContext.Current.User.Identity is FormsIdentity)
        {
            FormsIdentity id = (FormsIdentity)HttpContext.Current.User.Identity;
            FormsAuthenticationTicket ticket = (id.Ticket);
            if (!string.IsNullOrEmpty(ticket.UserData))
            {
                string userData = ticket.UserData;
                string[] roles = userData.Split(',');
                HttpContext.Current.User = new System.Security.Principal.GenericPrincipal(id, roles);
            }
        }
    }
} 
```

主 web.config

```
<configuration>
<system.web>
  <compilation debug="true" targetFramework="4.0" />
  <roleManager enabled="true"></roleManager>
  <authentication mode="Forms">
    <forms name="AOTMP_Demo" loginUrl="Login.aspx"
    protection="All" path="/" cookieless="UseCookies"/>
  </authentication>
  <authorization>
    <allow users="*"/>
  </authorization>
</system.web>
<configuration> 
```

Admin_Content 文件夹的 web.config

```
<configuration>  
  <system.web>
    <authorization>
      <allow roles="Administrator"/>
      <deny users="?"/>
    </authorization>
  </system.web>
</configuration> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T04:16:58.220

你不应该这样做......因为它会创建一个新的授权票。

```
FormsAuthentication.SetAuthCookie(); 
```

而是明确设置 cookie

```
var cookie = new HttpCookie(FormsAuthentication.FormsCookieName, encryptedTicket);
cookie.Expires = authTicket.Expiration;
Request.Cookies.Add(cookie); 
```

然后它将在 global.asax 中可用

```
var userData = ((FormsIdentity)HttpContext.Current.User.Identity).Ticket.UserData; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-04T21:44:28.570

尝试改变

```
string encryptedTicket = FormsAuthentication.Encrypt(authTicket);
FormsAuthentication.SetAuthCookie(encryptedTicket, true); 
```

至

```
HttpCookie cookie = new HttpCookie(FormsAuthentication.FormsCookieName, FormsAuthentication.Encrypt(authTicket));
Response.Cookies.Add(cookie); 
```

我相信`FormsAuthentication.SetAuthCookie`已经在`FormsAuthentication.Encrypt`内部调用，所以你可能会收到一个格式错误的 cookie。

# javascript - 向多个选择元素问题添加新选项

> ID：12642519
> 
> 赞同：1
> 
> 时间：2012-09-28T15:00:51.347
> 
> 标签：javascript

我有一个表格，用户可以在其中选择他们想要停留的几个位置，他们必须指定他们将在每个位置的时间，但首先，他们必须输入他们将在每个位置的一般天数，例如，如果我想在第一个位置 2 天和第二个位置 3 天在两个位置，我必须先输入 5 天，然后选择我想要停留的位置，为每个位置指定我有多少天想在那里。问题是，为了防止用户为某个位置输入错误的天数，我为每个位置创建了一个选择元素，因此当用户输入一般天数时，我用该信息填充选择元素（选项从 1到天数），这工作得很好，

```
function fillUpSelects2(start, top, who) {

    var optionArray = new Array();

    // create the new options
    for (var i = 1; i <= top; i++) {
        optionArray.push(new Option(i, i));
    }

    // get all the select elements
    var selects = jQuery("select.estanciaselect");

    // loop through the selects to change their content
    for (var i = 0; i < selects.length; i++) {

        // if selects[i] is not the one who triggered the change event
        if (selects[i].getAttribute('id') != who) {

            // then I erase all its options
            selects[i].options.length = 0;

            //and here is where it is supposed to add the new options
            for (var j = 0; j < optionArray.length; j++) {
               selects[i].options[selects[i].options.length] = optionArray[j];
            }
        }
    }
} 
```

好吧，当我运行它时，所有选择最终都是空的，但最后一个被正确填满

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:03:10.567

如果您使用的是 jQuery，您不妨使用它来追加它们：

```
for (var i = 1; i <= top; i++) {
    $(".selects").prepend($("<option>")
                              .val(i)       // Might have to use .attr("value", i) instead
                              .html(i));
} 
```

这是一个 jsFiddle，演示了您可以使用的两个选项（包括上面的一个），但还有更多：

[http://jsfiddle.net/tRHYk/](http://jsfiddle.net/tRHYk/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T06:05:35.543

以下是有关如何将项目添加到多选的方法（尽管不是您问题的直接答案）

```
<script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        var o = new Option("option text", "value");
        $(o).html("option text");
        $("#leftValues").append(o);

    });
</script>

<select id="leftValues" size="5" multiple></select> 
```

请参阅[使用 jQuery 向 <select> 添加选项？](https://stackoverflow.com/questions/740195/adding-options-to-a-select-using-jquery-javascript)也

# delphi - 如果我在“with”子句中创建一个对象，我还需要释放它吗？

> ID：12642524
> 
> 赞同：1
> 
> 时间：2012-09-28T15:01:11.083
> 
> 标签：delphi, delphi-7, pascal, with-statement

在我的资料中，我经常看到并使用这样的结构：

```
with TSQLDataSet.Create(nil) do try
  //Dosomething, get a result from a query.    
finally
  Free;
end; 
```

但我也经常看到施工：

```
with TSQLDataSet.Create(nil) do begin
  //Dosomething, get a result from a query.    
end; 
```

如果我创建带有结构的对象，我需要释放它们还是在 with 块的末尾自动释放它们？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T15:02:48.847

您需要手动释放对象。在块的末尾自动释放它们是*不*`with`正确的。这适用*于一般*情况。如果有什么特别之处`TSQLDataSet`，我不知道。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T15:04:44.843

你需要`free`。

因为`Class.Create`只是一个表达式，Delphi 无法知道结果值来自哪个表达式。

您可以只阅读 VCL 源代码 - 总是有明确`.Free`的 .

您可以想到非对象示例：

```
var r: record .... end;
with r do begin
...
end; 
```

如果 Delphi 最后试图释放所有东西`with`- 那么它会尝试`free`非对象吗？

```
with SomeObjectFactory.GetMeAnObject do begin
...
end; 
```

在这里，您不是通过构造函数创建对象，而是通过某个函数创建对象。`TLabel.Font`并且这个函数与or没有什么不同`TDataSet.FieldByName`。Delphi 是否应该`free`在这里？

为了避免冒险的猜测并保持一致 -`with`是公正的`with`。它只是一个别名。而已。它是在 1974 年设计的，并没有克隆最新的 .Net/Scala`Using(x){..}`结构的功能。

* * *

你*可能*看到的是这样的结构

```
with TForm.Create(Application) do ...;
with TLabel.Create(MainForm.Panel1) do ...; 
```

这是非常不同的 - 它确实将新创建的控件插入为属于所有者。当它是d 本身时，所有者将`free`拥有它所有的组件。`free`但这不使用`Create(nil)`. 当它仍然存在时 - 然后在`with`块内你会看到一些显式调用，将对象绑定到某个容器/父级（尽管在`.Create`和绑定之间发生异常的情况下这是非常脆弱的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T06:03:57.903

Delphi（Object pascal）、C、C++ 和更多非托管代码的第三代语言将内存回收的责任交给了程序员。因此，无论哪种情况，您都必须确保在代码中的任何位置释放获得的内存。

您给出的第一个示例假定您创建的对象在 end 语句之后不需要处于活动状态。第二个示例假定对象已创建并传递给 End 语句后要使用的其他对象。所以使用对象应该处理内存的释放。

在 Java VM 或 .Net 应用程序等托管代码环境中，内存由环境处理。当没有对分配的内存块的引用时，环境会感知并在它适合环境时释放它。

# ajax - 从 XMLHttpRequest responseText 获取纯文本

> ID：12642525
> 
> 赞同：5
> 
> 时间：2012-09-28T15:01:14.337
> 
> 标签：ajax, struts2

谁能告诉我如何从 AJAX 响应中提取 Struts 动作类返回的字符串？下面是我的代码片段：

**JS调用**：

```
 xmlhttp=new XMLHttpRequest();
    xmlhttp.open('POST', 'getMessage.do', false);
    xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xmlhttp.send();
    alert(xmlhttp.responseText); 
```

**Struts.xml**

```
 <action name="getMessage" class="SampleAction" method="getMessage"/> 
```

**行动**

```
 public String getMessage() {
    String msg = null;
    HttpSession hSession = this.request.getSession(false);
    if(null != hSession) {
        if(null != hSession.getAttribute("user")) {
            User user = (User) hSession.getAttribute("user");
            if(null != user.account) {
                msg =  user.account.getMessage(); //Sample message
            }
        }
    }
    return msg;
} 
```

当我打印响应文本（使用警报）时，它会打印包含所有 HTML 信息的消息。实际消息以粗体突出显示

**响应消息**

html>head>title>Apache Tomcat/5.0.28 - 错误报告/title>style>!-- {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size :22px;} H2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} H3 {font-family:Tahoma,Arial,sans-serif;颜色：白色；背景颜色：#525D76；字体大小：14px；} 正文 {字体系列：Tahoma，Arial，无衬线；颜色：黑色；背景颜色：白色；} B {字体系列：Tahoma ,Arial,sans-serif;color:white;background-color:#525D76;} P {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;}A {颜色：黑色；}A.name {颜色：黑色；}HR {颜色：#525D76；}-->/style> /head>body>>HTTP 状态 404 - 未为操作 com.sample.SampleAction$$ 定义结果EnhancerByCGLIB$69b4e30e 和结果**示例消息**HR size="1" noshade="noshade">p>b>type/b> 状态报告/p>p>b>message u>No result defined for action com.sample.SampleAction$$EnhancerByCGLIB$$69b4e30e and result**示例消息**/u>/p>p>b>description/b> u>请求的资源（未为操作 com.sample.SampleAction$$EnhancerByCGLIB$$69b4e30e 和结果**示例消息**定义结果）不可用。/u> /p>HR size="1" noshade="noshade">h3>Apache Tomcat/5.0.28/h3>/body>html>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:28:18.810

这样做的方法是这样的..

**AJAX 调用**

```
var xmlhttp;
if (window.XMLHttpRequest) { // code for IE7+, Firefox, Chrome, Opera, Safari
xmlhttp = new XMLHttpRequest();
}
else { // code for IE6, IE5
xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
}
xmlhttp.onreadystatechange = function() {
if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
 alert(xmlhttp.responseText);
}
}
xmlhttp.open("POST", "URL");
xmlhttp.send(); 
```

**行动**

```
public String execute() throws Exception {
      try{
            PrintWriter outWriter = null;
            StringBuffer msg= new StringBuffer("");
            HttpServletResponse httpResponse = ServletActionContext.getResponse();
            try {
                outWriter = httpResponse.getWriter();
                                        msg.append("String to be sent to View");
                    }

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            finally{

                if(outWriter!=null){
                    httpResponse.setContentType("text/html");
                    outWriter.println(msg.toString());
                    outWriter.flush();
                    outWriter.close();
                }
            }

        }catch (Exception e) {
            throw new Exception(e);
        }
        return null;
        } 
```

**在 STRUTS.XML 中定义的操作**

```
<action name="MYActionName" class="MYActionNameBean"    method="execute">
            <result type="stream">
                    <param name="contentType">text/html</param>
                    <param name="inputName">inputStream</param>
            </result>
        </action> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:06:04.070

该`plainText`属性按原样返回服务器响应，不进行任何转换。因此，如果 url 请求应该返回 html 格式的页面，您将在获得的字符串值中看到所有标记`plainText`

如果您希望只有文本，您的 Web 服务器应用程序应该为您的请求返回纯文本格式的响应

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:17:48.803

尝试：

```
var OriginalString = xmlhttp.responseText;
var StrippedString = OriginalString.replace(/(<([^>]+)>)/ig,"");
alert(StrippedString); 
```

[资源](http://css-tricks.com/snippets/javascript/strip-html-tags-in-javascript/)

# entity-framework - EmitMapper + EF。集合映射问题

> ID：12642527
> 
> 赞同：3
> 
> 时间：2012-09-28T15:01:26.537
> 
> 标签：entity-framework, emitmapper

源类：

```
public class Page  : EntityBase 
{
    public Page()
    {
        this.Articles = new List<Article>();
    }

    public virtual ICollection<Article> Articles { get; set; }
}

public class Article : EntityBase 
{
    public Article()
    {
        this.Pages = new List<Page>();
    }

    public virtual ICollection<Page> Pages { get; set; }
} 
```

目标类别

```
public class EditPageModel : ModelBase 
{
    public string Title { get; set; }
    public List<Article> Articles { get; set; }

    public override ModelBase Initialize(EntityBase entity)
    {
        return ObjectMapperManager.DefaultInstance.GetMapper<Page, EditPageModel>().Map((Page)entity);
    }
} 
```

当我使用

```
var model = (EditPageModel)new EditPageModel().Initialize(entity); 
```

我有一个错误

> 无法将“System.Data.Entity.DynamicProxies.Article_2F97D0440149ED4566ED7675640D475A23EB97002CFD5941610DD0C9BCE74E55”类型的对象转换为“System.Collections.Generic.ICollection`1[SomeProject.Dal.Models.Articles.Article]”类型的对象。

使用 AutoMapper 可以正常工作。

# vb.net - 如何将 powerpoint 宏应用于我当前正在查看的幻灯片？

> ID：12642533
> 
> 赞同：1
> 
> 时间：2012-09-28T15:02:05.023
> 
> 标签：vb.net, macros, powerpoint

我在 VB 中的 powerpoint 中工作，我正在尝试编写一个简单的宏，它只在我当前正在编辑的幻灯片上调整任何图像的大小和居中。我已经成功编写了图像大小和居中的代码，但它只适用于我演示文稿的第一张幻灯片，即使我目前正在查看和编辑另一张幻灯片。如何将代码应用于我正在查看的幻灯片？

代码如下：

```
Dim shp As Shape
Dim sld as Slide

Dim x As Integer
Dim y As Integer

With ActivePresentation.PageSetup
x = .SlideWidth / 2
y = .SlideHeight / 2
End With

For Each sld In ActiveWindow.Selection.SlideRange
For Each shp In sld.Shapes

If shp.Type = msoPicture Then
shp.Height = y * 2 

shp.Width = x * 2

shp.Left = x - (shp.Width / 2)
shp.Top = y - (shp.Height / 2)
End If

Next
Next

End Sub 
```

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T21:48:08.590

单步执行您的代码，看看这行之后会发生什么：

如果 shp.Type = msoPicture 则

在幻灯片 1 之后执行以下行吗？我猜你的形状是 msoPlaceholder 而不是 msoPicture，所以你的大小调整代码永远不会触发。

试试这个：

```
Dim shp As Shape
Dim sld As Slide

Dim x As Integer
Dim y As Integer

With ActivePresentation.PageSetup
x = .SlideWidth / 2
y = .SlideHeight / 2
End With

For Each sld In ActiveWindow.Selection.SlideRange
For Each shp In sld.Shapes

If shp.Type = msoPicture Then
shp.Height = y * 2

shp.Width = x * 2

shp.Left = x - (shp.Width / 2)
shp.Top = y - (shp.Height / 2)
End If

If shp.Type = msoPlaceholder Then
    If shp.PlaceholderFormat.ContainedType = msoPicture Then
        shp.Height = y * 2
        shp.Width = x * 2
        shp.Left = x - (shp.Width / 2)
        shp.Top = y - (shp.Height / 2)
    End If
End If

Next
Next 
```

# mysql - MySQL：数据库已更改

> ID：12642538
> 
> 赞同：0
> 
> 时间：2012-09-28T15:02:35.257
> 
> 标签：mysql, spring

我正在关注这个 Spring 教程：[Spring Tutorial Link](http://www.javacodegeeks.com/2012/09/spring-persistence-layer-writing.html)

我正在尝试使用 MySQL 命令：使用“数据库名称”，我得到响应“数据库已更改。

```
mysql> use timesheet
No connection. Trying to reconnect...
Connection id:    8
Current database: *** NONE ***

Database changed
mysql> use timesheet
Database changed 
```

“使用 DBName”有什么作用？为什么我收到“数据库已更改”的消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:04:28.080

那是指您当前连接的“活动”数据库。默认情况下，在语句之后运行的任何查询都`use`将引用该数据库中的对象。

“数据库已更改”实际上并不意味着数据库本身的任何内容都已更改，只是您的连接中的一个参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:04:27.863

您正在“更改”要操作的数据库。`use DBName`告诉数据库“我现在所做的一切，我都想对 DBName 数据库做”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:05:09.290

“use”关键字定义了您当前正在针对哪个数据库编写 SQL。您收到消息“数据库已更改”，因为此时您正在编写 SQL 的数据库已更改。

更多描述可用[http://www.1keydata.com/sql/sql-use.html](http://www.1keydata.com/sql/sql-use.html)

# .net - 此服务的 IIS 或 selfhost？

> ID：12642541
> 
> 赞同：1
> 
> 时间：2012-09-28T15:02:40.553
> 
> 标签：.net, wcf, iis, iis-7, self-hosting

**你好，**

我有一个复杂的分层 WCF 服务，它实际上包含 4 个不同的服务，其中 3 个使用常规 BasicHTTPBinding，最后一个使用 netTCPBinding。

这是som facs：

1.  启动时加载数据
2.  从不回收或重新启动（24/7 运行）
3.  5000 个 Windows 客户端
4.  回调以使客户保持最新状态
5.  缓存数据以加快响应速度
6.  使用 userPassword 和活动目录自定义登录
7.  消息检查员
8.  可以在同一台计算机上托管此服务的多个实例（包含 4 个服务）
9.  在 TCP 服务上为 WCF 使用 profobuf 以获得性能
10.  不压缩数据
11.  活动目录通信
12.  证书
13.  自定义/常规性能计数器

该服务已经在 IIS7 中托管了一段时间，但为了消除 WAS 开销并获得性能，我现在还创建了一个 Windows 服务来托管它。

但我有几个问题：

1.  WCF 是否会完全正常运行，例如崩溃限制？
2.  服务卡顿了怎么处理？我需要它尽快重启

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T17:52:13.047

在服务中右键单击服务并选择属性。第二个是带有很多选项的恢复选项卡。将有一些挂起服务无法恢复。但它应该感觉到崩溃。

# ckeditor - ckeditor：保护区域

> ID：12642545
> 
> 赞同：0
> 
> 时间：2012-09-28T15:02:56.230
> 
> 标签：ckeditor

我有一个来自数据库的文本并放入 ckeditor 编辑器。我想在我的文本中保护一个区域。

例子：

```
<div class="editable">aaaaa</div>
<div class="non-editable">bbbbb</div>
<div class="editable">aaaaa</div> 
```

我的愿望是`div`with 类`non-editable`就像一个只读文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:43:35.820

我有同样的问题，我为它写了一个插件。您可以在此答案中找到插件：
[如何阻止对 CKEDITOR textarea 中某些部分内容的编辑？](https://stackoverflow.com/a/11370552/751619)

您需要调整一些东西，例如类以确保它们在您的 HTML 和插件代码中匹配，因为插件代码会检查受保护的类并阻止对受保护类中元素的任何更改。

我在插件代码中放了很多文档来解释它是如何工作的。最好从答案中包含的 HTML 开始，以便您可以获得工作版本，然后修改 HTML 以满足您的需要。

# iphone - 特殊字符的 ASCII 字符串编码问题

> ID：12642546
> 
> 赞同：0
> 
> 时间：2012-09-28T15:03:02.887
> 
> 标签：iphone, ios, utf-8, ascii

在我的应用程序中，我使用 ASCII 字符串编码将 NSString 转换为 NSData。对于以下情况，我无法将字符串转换为数据，因为它包含一些特殊字符。我能够使用 UTF 8 正确编码，但我需要使用 ascii，因为服务器也配置为使用 ASCII。

NSData *ldata=[@"CASTAÑO" dataUsingEncoding:NSASCIIStringEncoding];

请帮我解决这个问题。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:13:17.533

你的意思是你想在你的 NSData 中将“CASTAÑO”转换为“CASTANO”吗？

使用[dataUsingEncoding:allowLossyConversion:](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html#//apple_ref/occ/instm/NSString/dataUsingEncoding%3aallowLossyConversion%3a)

如：

```
NSData *ldata=[@"CASTAÑO" dataUsingEncoding:NSASCIIStringEncoding
                       allowLossyConversion:YES]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T19:54:27.577

使用 MIME 传输数据怎么样？MIME 是使用 ASCII 字符对各种文件类型进行编码的标准方法。它通常用于使用不支持任何非 ASCII 数据的 SMTP 协议发送非 ASCII 电子邮件。

有一些类别可以扩展 NSData/NSString 以使用 MIME 对数据进行编码（这将导致 ASCII 字符。）我认为这不是您的即时解决方案，但根据您的限制（仅限 ASCII 服务器），MIME 应该是最佳解决方案。

请参阅： http: [//www.mulle-kybernetik.com/software/EDFrameworks/download.html#EDMessage](http://www.mulle-kybernetik.com/software/EDFrameworks/download.html#EDMessage) 和 [http://bitbucket.org/portablek/mimekit/overview](http://bitbucket.org/portablek/mimekit/overview)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T07:08:45.097

即使服务器配置为使用 ASCII，我也能够使用 NSISOLatin1StringEncoding 对数据进行编码和解码。

NSData *ldata=[@"CASTAÑO" dataUsingEncoding:NSISOLatin1StringEncoding];

特殊字符 'Ñ' 是扩展的 ascii 字符，不会被 ASCII 编码。

# python - Python：在类函数下返回项目列表

> ID：12642547
> 
> 赞同：0
> 
> 时间：2012-09-28T15:03:04.993
> 
> 标签：python

我是python初学者，有一个问题..

我有一个类函数看起来像：

```
class Example(A):
    def __init__(self, ID, name, products, itemlist):
        A.__init__(self, itemID, name)
        self.products = products
        self.itemlist = itemlist
    def get_items_list(self):
        return self.itemlist 
```

假设我已经写了

```
Example('SomeID', 'Somename', products, [('a', 1), ('b', 1), ('c', 1)]) 
```

那么当我这样做的时候

```
get_items_list() 
```

我的代码返回

```
bound method Compound.get_items_str of SomeID, Somename, <__main__.Products object at 0x102d2e4d0>> 
```

而不是我提供的项目清单...

任何答案都将不胜感激，并为我的错误找借口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:07:28.503

看起来你没有像这个问题那样调用方法。

检查您的代码，看看是否有

```
youclass.get_items_list 
```

代替

```
yourclass.get_items_list() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:08:46.973

试着这样说：

```
>>> example_instance = Example('SomeID', 'Somename', products, [('a', 1), ('b', 1), ('c', 1)])
>>> example_instance.get_items_list() 
```

顺便说一句，我建议查看[有关类的 Python 文档](http://docs.python.org/tutorial/classes.html)

# windows-store-apps - Windows 8 Metro 应用程序中的 RichTextBlockOverflow.HasOverflowContent 始终为 false

> ID：12642552
> 
> 赞同：3
> 
> 时间：2012-09-28T15:03:21.597
> 
> 标签：windows-store-apps, richtextblock, richtextblockoverflow

因为您必须在 Windows 8 Metro Apps 中支持多种屏幕分辨率，所以我想拆分我的 RichTextBlock 以显示将在 RichTextBlockOverflow 控件（或多个控件，取决于我必须显示多少文本）中被截断的文本。为了确定我是否必须显示额外的 RichTextBlockOverflow-Control，我检查了我的 RichTextBlocks 的 HasOverflowContent-Property。但它总是返回 false。

它非常容易重现：

*   创建一个新的“Windows 应用商店 -> 空白应用程序”
*   将 MainPage.xaml 的 xaml 替换为以下代码：

    ```
    <StackPanel Orientation="Horizontal" Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <RichTextBlock x:Name="test1" Width="100" Height="300" OverflowContentTarget="{Binding ElementName=test}">
            <Paragraph>
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
                lkj halks dflkjha skld fkla hsdkl hfakl dsflk hasdkl fakl hsdklf halks dflka jhsdhfklaj hsdklf jhakls dflkaj hsdlkfjh alks dflkajh s
            </Paragraph>
        </RichTextBlock>
        <RichTextBlockOverflow x:Name="test" Width="100" Height="300" />

    </StackPanel> 
    ```

然后转到文件后面的代码 (MainPage.xaml.cs) 并用该代码替换构造函数：

```
public MainPage()
{
    this.InitializeComponent();
    if (test.HasOverflowContent)
    {
        // Will never be entered
    }
    if (test1.HasOverflowContent)
    {
        // Will never be entered
    }
} 
```

在 this.InitializeComponent() 中设置断点，看看 HasOverflowContent 永远不会为真。

我究竟做错了什么？或者它是.NET 中的一个错误？

任何帮助将不胜感激；）

和我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:25:18.833

尝试使用不同的事件，将您的代码放入`Page_Loaded`我能够开始`HasOverflowContent`工作的事件中。

# f# - F# 选项相当于 C# 的 ?? 操作员

> ID：12642554
> 
> 赞同：23
> 
> 时间：2012-09-28T15:03:32.003
> 
> 标签：f#, option

我正在寻找一种方法来获取 F# 选项的值，或者如果它是 None 则使用默认值。这似乎很常见，我不敢相信预定义的东西不存在。这是我现在的做法：

```
// val getOptionValue : Lazy<'a> -> Option<'a> -> 'a    
let getOptionValue (defaultValue : Lazy<_>) = function Some value -> value | None -> defaultValue.Force () 
```

我（有点）在寻找相当于 C# 的 F# ？操作员：

```
string test = GetString() ?? "This will be used if the result of GetString() is null."; 
```

Option 模块中没有任何功能可以完成我认为非常基本的任务。我错过了什么？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-09-28T15:08:49.687

您正在寻找[`defaultArg` ^([MSDN])](http://msdn.microsoft.com/en-us/library/ee340463.aspx) ( `'T option -> 'T -> 'T`)。

它通常用于为可选参数提供默认值：

```
type T(?arg) =
  member val Arg = defaultArg arg 0

let t1 = T(1) 
let t2 = T() //t2.Arg is 0 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-08-29T05:52:24.740

您可以轻松创建自己的操作员来做同样的事情。

```
let (|?) = defaultArg 
```

您的 C# 示例将变为

```
let getString() = (None:string option) 
let test = getString() |? "This will be used if the result of getString() is None.";;

val getString : unit -> string option 
val test : string = "This will be used if the result of getString() is None." 
```

这是一篇更详细[的博客文章。](https://troykershaw.com/null-coalescing-operator-in-fsharp-but-for-options/)

编辑：尼康三世为操作员提供了更好的实现，所以我更新了它。

# javascript - IE 用户的 Javascript 在其他浏览器中执行，但不是 IE

> ID：12642557
> 
> 赞同：0
> 
> 时间：2012-09-28T15:03:39.460
> 
> 标签：javascript, internet-explorer

从[this previous question](https://stackoverflow.com/questions/4411551/if-browser-is-internet-explorer-run-an-alternative-script-instead)我发现下面的代码可以确定用户是否有IE，然后运行特定于他们的js-code。但是当我在我的网站上使用代码时，效果却相反。在其他浏览器上，代码会被触发，而在 IE 上则不会。我究竟做错了什么？

```
<![if !IE]>

<script type="text/javascript">
$(document).ready(function() {
$(".box.2").fadeOut(1500);
});
</script>

<![endif]> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T15:04:44.427

删除`!`前面的`IE`- 它颠倒了测试的意义，意味着*不要*在 IE 上这样做！

为确保其他浏览器忽略该文本，请编写如下注释：

```
<!--[if IE]>
...
<![endif]--> 
```

注意：在完全 HTML5 模式下使用 IE 10 时，Microsoft 已放弃对条件注释的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:06:15.193

更改`<![if !IE]>`为`<![if IE]>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:06:20.670

这很合乎逻辑：当您检查时`<![if !IE]>`，您的分支是`!IE`，而不是 Internet Explorer，只需删除`!`:`<![if IE]>`就可以了。就像我可以发布这个答案一样，输入了足够数量的字符

# php - 在打印页面中显示背景颜色

> ID：12642559
> 
> 赞同：0
> 
> 时间：2012-09-28T15:03:42.433
> 
> 标签：php, javascript, css, printing

我正在使用 javascript:print() 在 PHP 脚本中进行打印。我在其中添加了背景颜色。实际上它将是动态背景颜色。在看到打印预览时，背景颜色不会出现。请任何人帮助解决这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:05:54.683

您无法通过 javascript 控制它。

用户可以在打印机对话框中启用背景图像或颜色的打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:17:44.680

尽管@Jan. 的答案是正确的，并且您不应该弄乱用户的偏好和设置，但在技术上是可行的。

只需在所有内容后面放置一个元素，然后在其中放置一个具有所需背景颜色的图像，该背景颜色可以拉伸到 100% 宽度和 100% 高度。使用 javascript / css 这将非常容易。

它会惹恼（委婉地说......）打印页面的人......

# c++ - 在几何库中分离算法和数据（需要三次调度？）

> ID：12642561
> 
> 赞同：4
> 
> 时间：2012-09-28T15:03:58.510
> 
> 标签：c++, downcast, double-dispatch

我在设计处理几何的应用程序部分时遇到问题。特别是，我希望有一个层次结构的类和交叉的单独方法。

**问题**

层次结构将是这样的：

*   几何学
    *   网
    *   参数
        *   盒子
        *   领域

相交方法类似于：

```
namespace intersections
{
  bool intersection( const Box &, const Box &);
  bool intersection( const Box &, const Sphere &);
} 
```

这很简单。现在问题出现了，当我想将所有几何图形一起存储在一个结构中时，例如一个`std::vector`（或 KD-Tree，或其他）。

为此，我需要使用`std::vector<Geometry*>`. 但是，从这个向量中读取会得到`Geometry*`对象，因此我无法调用适当的交集函数。

问题示例：

```
std::vector<Geometry*> arrGeometry;

// add the elements
arrGeometry.push( new Box() );
arrGeometry.push( new Sphere() );

// ... some more code

// try to intersect them?
Geometry* g1 = arrGeometry[0];
Geometry* g2 = arrGeometry[1];
bool intersecting = intersections::intersection( g1, g2 ); //< As expected, this does
                                                          // not work 
```

如果我在几何对象中实现算法，问题可以通过访问者和一些非常奇怪的函数调用弹跳来解决。

但是，我想将交集算法保留在几何类之外。原因是：

*   避免决定哪个应该拥有所有权（例如，你在哪里实现盒子和球体之间的交集，在`Box`还是在`Sphere`？）

*   为了避免使几何对象混乱，可以对几何做所有的事情，这是相当多的（仅举几例：体素化它，计算交叉点，应用构造几何运算符......）。因此，在这里将逻辑与数据分离是非常可取的。

另一方面，我需要有一个层次结构而不是模板，因为对于某些事情，可以抽象出特定的几何图形......（例如，将其存储在 a`std::vector`或 KD-Tree 或......）。

你会如何解决这个问题？有没有适合这个的设计模式？我尝试查看一些库，但最终我更加困惑，我已经...

最简单的方法（有时使用）是使用 RTTI（或伪造它）和向下转换，但这并不完全可维护......（添加新几何意味着通过所有代码更改大量 switch 语句）。

有什么想法吗？

非常感谢你提前。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T12:31:53.857

我想到了另一种解决方案，如果您担心速度，这具有 O(1) 复杂性，但您可能需要为模式几何类型自动生成 c++ 代码的程序。您可以制作交集函数数组（伪代码，我手头没有任何编译器）：

```
enum GeometryType
{
    TypeMesh,
    TypeParamBox,
    TypeParamSphere,
    MaxType,
};

bool intersection( const Mesh*, const Mesh* );
bool intersection( const Mesh*, const Box* );
bool intersection( const Mesh*, const Sphere* );

bool intersection( const Box*, const Mesh* );
bool intersection( const Box*, const Box* );
bool intersection( const Box*, const Sphere* );

bool intersection( const Sphere*, const Mesh* );
bool intersection( const Sphere*, const Box* );
bool intersection( const Sphere*, const Sphere* );

template<class T1,class T2>
bool t_intersection( const Geometry* first, const Geometry* second )
{
    return intersection( static_cast<const T1*>( first ), static_cast<const T1*>( second ) );
}

typedef bool (*uni_intersect)( const Geometry*, const Geometry* );

const uni_intersect IntersectionArray[] = // 2D array all possible combinations
{
    t_intersection<Mesh,Mesh>,
    t_intersection<Mesh,Box>,
    t_intersection<Mesh,Sphere>,

    t_intersection<Box,Mesh>,
    t_intersection<Box,Box>,
    t_intersection<Box,Sphere>,

    t_intersection<Sphere,Mesh>,
    t_intersection<Sphere,Box>,
    t_intersection<Sphere,Sphere>,
};

bool main_intersection( const Geometry* first, const Geometry* second )
{
    const unsigned index = (unsigned)(first->Type) * (unsigned)MaxType + (unsigned)(second->Type);
    return IntersectionArray[ index ]( first, second );
} 
```

或替代方案：

```
const uni_intersect IntersectionArray[] = // 2D array all possible combinations
{
    t_intersection<Mesh,Mesh>,
    t_intersection<Mesh,Box>,
    t_intersection<Mesh,Sphere>,

    nullptr, // skip mirrored functions
    t_intersection<Box,Box>,
    t_intersection<Box,Sphere>,

    nullptr,
    nullptr,
    t_intersection<Sphere,Sphere>,
};

bool main_intersection( const Geometry* first, const Geometry* second )
{
    const unsigned Type1 = unsigned(first->Type);
    const unsigned Type2 = unsigned(second->Type);
    unsigned index;
    if( Type1 < Type2 )
        index = Type1 * (unsigned)MaxType + Type2;
    else
        index = Type1 + Type2 * (unsigned)MaxType;

    return IntersectionArray[ index ]( first, second );
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:49:16.060

这个问题与[此](https://stackoverflow.com/a/12566646/1569168)类似。

```
class Geometry
{
public:
    enum eType
    {
        TypeMesh,
        TypeParamBox,
        TypeParamSphere,
    };

    Geometry( eType t ): Type( t ) { }
    ~Geometry() { }

    const eType Type;
};

class Mesh : public Geometry
{
public:
    Mesh(): Geometry( TypeMesh ) { }
};

class Parametric : public Geometry
{
public:
    Parametric( eType t ): Geometry( TypeMesh ) { }
};

class Box : public Parametric
{
public:
    Box(): Parametric( TypeParamBox ) { }
};

class Sphere : public Parametric
{
public:
    Sphere(): Parametric( TypeParamSphere ) { }
};

namespace intersections
{
    bool intersection( const Geometry* first, const Geometry* second );
    template <typename T>
    bool t_intersection( const T* first, const Geometry* second );

    bool intersection( const Box*, const Box* );
    bool intersection( const Box*, const Sphere* );
    bool intersection( const Sphere*, const Box* );
    bool intersection( const Sphere*, const Sphere* );
}

void foo_test()
{
    std::vector<Geometry*> arrGeometry;

    // add the elements
    arrGeometry.push_back( new Box() );
    arrGeometry.push_back( new Sphere() );

    // ... some more code

    // try to intersect them?
    Geometry* g1 = arrGeometry[0];
    Geometry* g2 = arrGeometry[1];
    bool intersecting = intersections::intersection( g1, g2 );
}

bool intersections::intersection( const Geometry* first, const Geometry* second )
{
    switch( first->Type )
    {
    case Geometry::TypeParamBox: return t_intersection( static_cast<const Box*>( first ), second );
    case Geometry::TypeParamSphere: return t_intersection( static_cast<const Sphere*>( first ), second );
    default: return false;
    }
}

template <typename T>
bool intersections::t_intersection( const T* first, const Geometry* second )
{
    switch( second->Type )
    {
    case Geometry::TypeParamBox: return intersection( first, static_cast<const Box*>( second ) );
    case Geometry::TypeParamSphere: return intersection( first, static_cast<const Sphere*>( second ) );
    default: return false;
    }
} 
```

或者，如果您不使用继承：

```
struct Mesh{};

struct Box{};

struct Sphere{};

enum GeometryType
{
    TypeMesh,
    TypeParamBox,
    TypeParamSphere
};

struct Geometry
{
    GeometryType Type;

    union
    {
        Mesh* pMesh;
        Box* pBox;
        Sphere* pSphere;
    } Ptr;
};

namespace intersections
{
    bool intersection( const Geometry* first, const Geometry* second );
    template <typename T>
    bool t_intersection( const T* first, const Geometry* second );

    bool intersection( const Box*, const Box* );
    bool intersection( const Box*, const Sphere* );
    bool intersection( const Sphere*, const Box* );
    bool intersection( const Sphere*, const Sphere* );
}

void foo_test()
{
    std::vector<Geometry*> arrGeometry;

    // add the elements
//  arrGeometry.push_back( new Box() );
//  arrGeometry.push_back( new Sphere() );

    // ... some more code

    // try to intersect them?
    Geometry* g1 = arrGeometry[0];
    Geometry* g2 = arrGeometry[1];
    bool intersecting = intersections::intersection( g1, g2 );
}

bool intersections::intersection( const Geometry* first, const Geometry* second )
{
    switch( first->Type )
    {
    case TypeParamBox: return t_intersection( first->Ptr.pBox, second );
    case TypeParamSphere: return t_intersection( first->Ptr.pSphere, second );
    default: return false;
    }
}

template <typename T>
bool intersections::t_intersection( const T* first, const Geometry* second )
{
    switch( second->Type )
    {
    case TypeParamBox: return intersection( first, second->Ptr.pBox );
    case TypeParamSphere: return intersection( first, second->Ptr.pSphere );
    default: return false;
    }
} 
```

注意：如果您知道一种几何图形的类型，则可以使用模板函数：

```
Box* pBox;
Geometry* pUnknownGeometry;
bool intersecting = intersections::t_intersection( pBox, pUnknownGeometry ); 
```

注意2：您可以编写相同的函数，如下所示：

```
bool intersection( const Box* first, const Sphere* second );

bool intersection( const Sphere* first, const Box* second )
{
    return intersection( second, first );
} 
```

编辑：

如果您将问题减少到双重调度，则可以使用[此](https://stackoverflow.com/q/12582040/1569168)技术。

对于交集，将层次结构视为：

> *   几何学
>     *   网
>     *   盒子
>     *   领域

以及其他操作：

> *   几何学
>     *   网
>     *   参数
>         *   盒子
>         *   领域

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:43:55.660

您如何将您的相交算法表示为可以决定的类，它们是否可以处理他们获得的几何图形集，并且您提供具有原始接口的相交代理。这看起来像这样：

```
class IIntersection
{
   public:
     bool intersection( const Geometry &, const Geometry &);
     bool accept( const Geometry &, const Geometry &);
}

class IntersectionBoxSphere : public IIntersection
{
public:
   bool intersection( const Geometry &, const Geometry &);
   bool accept( const Geometry & a, const Geometry &b)
   {
      return ((dynamic_cast<Box>(a) != NULL || dynamic_cast<Box>(b) != NULL)
              (dynamic_cast<Sphere>(a) != NULL || dynamic_cast<Sphere>(b) != NULL))
   }
}

class IntersectionBoxbox  : public IIntersection
...
    /**collect some where all algorithms*/
    IIntersection* myintersections[2];
    myintersections[0] = new IntersectionBoxSphere()
    myintersections[1] = new IntersectionBoxbox()
...
/**decide here which to use */
bool intersection( const Geometry &a, const Geometry &b)
{
    for ( i ... )
     if (myintersections[i]->appect(a,b))
       return myintersections[i]->intersection(a,b)
} 
```

# jquery - jQuery扫描具有特定类的所有项目的UL结构

> ID：12642570
> 
> 赞同：1
> 
> 时间：2012-09-28T15:04:24.693
> 
> 标签：jquery, traversal

我有一个类似于以下的 ul>li 结构：

```
<ul id="node">
    <li><a data-name="One">One</a>
        <ul>
            <li><a data-name="Two">Two</a></li>
            <li><a class="me" data-name="Three">Three</a>
                <ul>
                    <li><a data-name="Four">Four</a></li>
                    <li><a class="me" data-name="Five">Five</a></li>
                </ul>
            </li>
        </ul>
    </li>
</ul> 
```

我需要遍历它并`<a>`使用类 me 从每个元素中获取 data-name 属性，这将产生一个数组：

```
items = {"Three","Five"} 
```

**新问题：**

如果我想从那里开始`Three`，只知道`data-name`要遍历的属性是`Three`并且只从那里向下遍历——即结果只会是`Five`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:05:39.763

```
var items = $('ul#node a.me').map(function(){
   return $(this).attr('data-name');
}); 
```

或者

```
var items = [];
$('ul#node a.me').each(function(){
   items.push($(this).data('name'));
}); 
```

[演示](http://jsfiddle.net/dystroy/dvAmj/)

**新问题 ：**

```
var items = [];
$('ul#node a[data-name="Three"]').parent().children().find('a.me').each(function(){
    items.push($(this).data('name'));
}); 
```

而[新的演示](http://jsfiddle.net/dystroy/fGEPs/)......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:08:36.983

你可以使用`map`方法。

```
var items = $('ul a.me').map(function(){
    return this.dataset.name
}).get() 
```

[http://jsfiddle.net/ZGMSw/](http://jsfiddle.net/ZGMSw/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:09:31.503

```
$('a.me').each (function () { alert ( $(this).attr('data-name')); } ); 
```

# javascript - 通过Javascript按下回车按钮时调用函数

> ID：12642571
> 
> 赞同：9
> 
> 时间：2012-09-28T15:04:25.690
> 
> 标签：javascript, html

我有一个问题，我想在文本框中调用一个函数，当我按下回车键时，这是我的代码

```
<input  type="text" value="DIGITE O LOCAL" onclick="this.select()" size="20" id="endereco"> 
```

我想放一些类似的东西`onenterpress="doSomething()"`

我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-09-28T15:06:09.840

如果你想使用突兀的 Javascript：

```
<input type="text" value="DIGITE O LOCAL" onclick="this.select()" 
onKeyDown="if(event.keyCode==13) alert(5);" size="20" id="endereco"> 
```

不显眼地处理这个：

```
document.getElementById('endereco').onkeydown = function(event) {
    if (event.keyCode == 13) {
        alert('5');
    }
} 
```

您最好的选择是使用后一种方法。从长远来看，它将有助于可维护性。

**参考**：[http ://en.wikipedia.org/wiki/Unobtrusive_JavaScript](http://en.wikipedia.org/wiki/Unobtrusive_JavaScript)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T15:07:56.417

**HTML**

```
<input  type="text" value="DIGITE O LOCAL" onkeypress="doSomething(this, event)" onclick="this.select()" size="20" id="endereco"> 
```

**JS**

```
function doSomething(element, e) {
    var charCode;

    if(e && e.which){
        charCode = e.which;
    }else if(window.event){
        e = window.event;
        charCode = e.keyCode;
    }

    if(charCode == 13) {
        // Do your thing here with element
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-01T18:53:18.360

Daniel Li 的[回答](https://stackoverflow.com/a/12642602/1258041)是最巧妙的解决方案，但您可能会遇到 IE 和 event.keyCode 返回 undefined 的问题，就像我过去遇到的那样。要绕过这个检查 window.event

```
document.getElementById('endereco').onkeydown = function(event){
    var e = event || window.event;
    if(e.keyCode == 13){
        alert('5');
    }
}​ 
```

# c - C中静态函数和非静态函数的区别

> ID：12642574
> 
> 赞同：8
> 
> 时间：2012-09-28T15:04:33.733
> 
> 标签：c

我正在 VxWorks 上开发一个嵌入式应用程序。

我知道静态函数仅在定义的文件中调用，而非静态函数在源项目的任何文件中调用。

我想知道静态和非静态函数在执行时间和内存方面是否存在差异

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-28T15:06:40.560

绝对没有性能差异。`static`关键字对函数所做的唯一事情是赋予它们内部[链接](http://publications.gbdirect.co.uk/c_book/chapter4/linkage.html)，这意味着它们只能在定义它们的文件中访问。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:07:27.317

执行时间或运行时内存要求没有差异。

一些（很多？）链接器会发现更容易发现未使用的静态函数并删除它们，因此它们 *可能会*鼓励更小的代码大小。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T15:08:23.527

这取决于你的编译器。静态函数理论上可以更好地优化，因为编译器会知道它们被调用的所有地方。您应该能够从编译器中获得汇编列表，并自己找出它们是否更有效。

# windows - 以编程方式更改 Internet Explorer 设置

> ID：12642575
> 
> 赞同：3
> 
> 时间：2012-09-28T15:04:40.267
> 
> 标签：windows, security, internet-explorer, winapi

在 Internet Explorer 中，**Internet 选项 -> 高级**我们有多个设置**复选框**。

我想以编程方式管理所有这些。

我查看了 Internet Explorer API，但没有找到太多。

**编辑**

我要特别取消选中这两个复选框

![在此处输入图像描述](../Images/98c6cc894d00ba21c9f180dbf73ac0ee.png)

请建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:06:31.370

您很可能需要更改注册表设置才能以编程方式更改这些字段。你可以开始探索这个键：

```
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:10:55.283

您将不得不操作注册表项，因为大多数这些设置很可能存储在注册表中。

例如，要以编程方式访问注册表，您可以使用[RegistryKey](http://msdn.microsoft.com/en-us/library/microsoft.win32.registrykey%28v=vs.100%29.aspx)类。

# ruby-on-rails-3 - Heroku 应用程序是否有请求超时？

> ID：12642586
> 
> 赞同：0
> 
> 时间：2012-09-28T15:05:24.990
> 
> 标签：ruby-on-rails-3, heroku, timeout, background-process

我目前正在开发一个涉及大量发送电子邮件的 Rails 应用程序。在我的本地服务器中，当我尝试一次发送 500 封电子邮件时，它工作正常（尽管有点滞后）。但是，一旦我将应用程序推送到 Heroku 并尝试再次发送 500 封电子邮件，它就会显示应用程序错误！我尝试查看日志，它说请求超时，但它在我的本地主机上运行良好！我该如何解决这个错误？附带说明一下，有没有办法将该方法推送到后台进程，这样就不会导致任何超时？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:46:32.733

如果应用程序在 30 秒内未发送任何内容，则请求超时：
[https ://devcenter.heroku.com/articles/http-routing#timeouts](https://devcenter.heroku.com/articles/http-routing#timeouts)

# c++ - 写入（增强 asio）TCP 套接字：一个接一个或同时写入

> ID：12642588
> 
> 赞同：1
> 
> 时间：2012-09-28T15:05:29.920
> 
> 标签：c++, networking, tcp, boost-asio

我有一个 TCP 服务器，我必须同时向多个套接字发送数据。我正在使用 boost 来做到这一点。

当我需要向多个套接字发送数据时，我会`boost::asio::async_write`使用我想要发送的任何数据调用每个套接字。

`boost::asio::async_write`我想知道在一个套接字上调用并等待回调（然后在下一个套接字上调用它......）是否会有任何区别和优势

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T18:21:19.437

等待来自 async_write 的回调只会引入（基本上是随机的）延迟，但根本不会给您带来任何好处。

唯一的例外是如果底层协议没有任何拥塞控制 - 即，当使用 UDP 时，您可能希望在应用程序中实现某种拥塞控制，但即使这样等待 async_write 回调也不是一个好方法想法（因为这只是告诉您数据已传递给操作系统）。

但是当您使用 TCP 时，等待回调不会提供任何好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:56:36.413

请注意，我不是网络专家，所以如果我在这里有任何问题，请随时发表评论。

**异步：**

*   **进行异步调用的优点**是在调用后立即返回控制。因此，当我们等待验证调用状态时，我们可以做其他更有成效的事情或让出 CPU。这使得异步系统高效。

*   **缺点**是很难进行异步调用。它们不需要锁和机制来通信调用结果。这可能很难实现。

**同步：**

*   **进行同步调用的优点**是它们更容易实现和理解。

*   **缺点**是它们会阻塞直到获得结果。这会使系统变得非常缓慢并且可能出现死锁。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-02T14:23:07.283

当操作发生错误或将所有数据写入套接字时， *WriteHandler*是可运行的。`async_write`因此，跨不同套接字发出多个异步写入可能会提高速度。但是，正确管理*缓冲区*需要格外小心。

*   如果缓冲区由 a 管理`shared_ptr`，则只需将 绑定`shared_ptr`到每个*WriteHandler*。
*   如果缓冲区不是由智能指针管理的，则需要一种机制来检测何时调用了最后一个*WriteHandler*。考虑将挂起的写入处理程序的计数存储到一个`pending_writes_`变量中，并让每个*WriteHandler*递减`pending_writes_`。一旦`pending_writes_`达到零，缓冲区就可以重新用于其他操作。要序列化对 的修改`pending_writes_`，请将每个*WriteHandler*包装在[`strand`](http://www.boost.org/doc/libs/1_45_0/doc/html/boost_asio/reference/io_service__strand.html).

# cocos2d-iphone - 无法使用 Cocos2d 使 OpenGL ES 'draw' 函数正常工作（+ C99 错误）

> ID：12642589
> 
> 赞同：2
> 
> 时间：2012-09-28T15:05:31.823
> 
> 标签：cocos2d-iphone

我正在尝试从**Cocos2d for iPhone 0.99 Beginner's Guide**中编译一些示例代码：

```
-(void)draw
{
    if(isSelected)
    {
        [self.mySprite setOpacity:100];
        glColor4f(255 / 255.0f, 0 / 255.0f, 0 / 255.0f, 255 / 255.0f);
        glPointSize( 30.0 );
        ccDrawPoint( self.mySprite.position);
    }
    [super draw];
} 
```

除此之外，当 isSelected = YES 时，实际上并没有在精灵顶部绘制矩形高光，gl 函数也给我警告：

*   函数“glPointSize”的隐式声明在 C99 中无效
*   函数“glColor4f”的隐式声明在 C99 中无效

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T12:41:40.023

您使用的是 Cocos2D 2.x 吗？尝试`ccDrawColor4F`代替`glColor4f`和`ccPointSize`代替`glPointSize`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T14:29:21.603

确保#import

您可以使用： **ccDrawSolidRect** (<#CGPoint origin#>, <#CGPoint destination#>, <#ccColor4F color#>)

与使用 ccDrawPoint() 相比，这可能是一种更简洁的方法来突出显示矩形。

希望这可以帮助。

# ios - RevMob 不工作

> ID：12642599
> 
> 赞同：1
> 
> 时间：2012-09-28T15:06:04.257
> 
> 标签：ios, revmob

当我尝试显示全屏广告时，我收到以下消息：

“[RevMob] 此设备没有可用的广告。”

之前效果很好，现在广告不显示了。有谁能够帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-09T17:23:32.157

这可能是由于您的设备缺少广告而发生的，这应该是一个暂时的问题。

在较新的 skd 版本上，消息已更改为以下内容：

[RevMob] 目前此设备/国家/地区没有可用的广告

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T10:21:50.177

添加一个正确的 key ，检查拼写， App ID 。

# actionscript-3 - 使用 Flex 3 在会话中划分 dataGrid

> ID：12642608
> 
> 赞同：0
> 
> 时间：2012-09-28T15:06:40.123
> 
> 标签：actionscript-3, apache-flex, datagrid, actionscript, flex3

所以，我想要的是制作一个分成几部分的dataGrid，如下所示：

```
Column 1    Column 2    Column 3    Column N
data1_r1    data2_r1    data3_r1    data4_r1
data1_r2    data2_r2    data3_r2    data4_r2
data1_r3    data2_r3    data3_r3    data4_r3
                  Session 2         
data1_r5    data2_r5    data3_r5    data4_r5
data1_r6    data2_r6    data3_r6    data4_r6
data1_r7    data2_r7    data3_r7    data4_r7
                  Session 3 
```

基本上我想要的是那个。会话是动态的（我不知道每个会话之前有多少寄存器，也不知道会有多少会话，但我可以计算执行时间）。

*   我还可以将每个会话分成一个单独的 ArrayCollection
*   我可以将它们全部放入一个 ArrayCollection
*   我也可以（如有必要）在它们之间放置一个寄存器，如示例所示。例如，就像“会话 2”是 dataProvider.getItemAt(3) 对象，会话 3 是 dataProvider.getItemAt(7)。

是否有可能，如果我应该寻找什么来帮助我解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:47:40.040

您可以考虑将 AdvancedDataGrid 与分层数据一起使用。 [更多信息在这里](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7bf4.html)。

对于您的情况，我认为您需要一个“会话”对象；这可以像这样的对象一样简单：

```
package com.something.something
{
    import mx.collections.ArrayCollection;

    public class SessionObject
    {
        public function SessionObject()
        {
        }

        public var label :String;
        public var children :ArrayCollection 
    }
} 
```

会话对象内的“Children”集合的每个元素都将代表您的一个子行。从概念上讲，它们是这样的对象：

```
package com.something.something
{
    import mx.collections.ArrayCollection;

    public class SessionData
    {
        public function SessionData()
        {
        }

        public var column1 :String;
        public var column2 :String;
        public var column3 :String;
        public var column4 :String;
    }
} 
```

然后显示如下：

```
<mx:AdvancedDataGrid width="100%" height="100%">
    <mx:dataProvider>
        <mx:HierarchicalData source="{dpHierarchy}"/>
    </mx:dataProvider>
    <mx:columns>
        <mx:AdvancedDataGridColumn dataField="label"/>
        <mx:AdvancedDataGridColumn dataField="column1 "/>
        <mx:AdvancedDataGridColumn dataField="column2" />
        <mx:AdvancedDataGridColumn dataField="column3"/>
        <mx:AdvancedDataGridColumn dataField="column4"/>
    </mx:columns>
</mx:AdvancedDataGrid> 
```

如果您在编译时确实有未知数量的列，事情会变得更加困难；但如果需要，您可以在运行时“即时”在 ActionScript 中创建列数组。

# c - C中的rand()/srand()函数是如何实现的

> ID：12642610
> 
> 赞同：2
> 
> 时间：2012-09-28T15:06:41.277
> 
> 标签：c, random

> **可能重复：**
> [rand() 是如何工作的？有一定的倾向吗？有没有更好用的东西？](https://stackoverflow.com/questions/3539398/how-does-rand-work-does-it-have-certain-tendencies-is-there-something-better)

我知道如何实现它。但是，我想了解 rand 在内部的行为方式以及为什么有必要为 rand 函数初始化“种子”值。

或者说——rand 函数如何使用种子值来生成随机数？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:09:41.393

有关更详细的说明，请参阅[Wikipedia 。](http://en.wikipedia.org/wiki/Linear_congruential_generator)

> 线性同余生成器 (LCG) 代表了最古老和最著名的伪随机数生成器算法之一。 [1] 它们背后的理论很容易理解，并且易于实现且速度快。
> 
> 生成器由递归关系定义：
> 
> X_{n+1} = ( a * X_n + c ) mod m

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T15:11:02.743

确切的实现细节取决于实现者。但是 GNU 实现（glibc）像这样实现 rand()：http: [//sourceware.org/git/ ?p=glibc.git;a=blob;f=stdlib/random_r.c;hb=glibc-2.15#l361](http://sourceware.org/git/?p=glibc.git;a=blob;f=stdlib/random_r.c;hb=glibc-2.15#l361)

评论很好地解释了它。

```
/* If we are using the trivial TYPE_0 R.N.G., just do the old linear
    congruential bit.  Otherwise, we do our fancy trinomial stuff,
    which is the same in all the other cases due to all the global
    variables that have been set up.  The basic operation is to add
    the number at the rear pointer into the one at the front
    pointer.  Then both pointers are advanced to the next location
    cyclically in the table.  The value returned is the sum generated, 
    reduced to 31 bits by throwing away the "least random" low bit.    
    Note: The code takes advantage of the fact that both the front and 
    rear pointers can't wrap on the same call by not testing the rear  
    pointer if the front one has wrapped.  Returns a 31-bit random number. */ 
```

关于您为什么总是**需要**种子值的问题：计算机科学中没有真正的随机数。计算机（在计算理论中）是完全确定性的机器。他们无法执行任何操作，其结果取决于机会。

只有伪随机数生成器可以生成看起来随机的数字流，但它们仍然是确定性计算的结果。这就是您需要种子值的原因：每个种子产生不同的数字序列。当你使用相同的种子时，你会得到相同的伪随机数序列。

可以利用 RNG 在获得相同种子时始终返回相同序列的行为：例如，经典的空间模拟[Elite](http://en.wikipedia.org/wiki/Elite_%28video_game%29)能够将具有数百个行星的巨大宇宙存储在一个整数中。它是怎么做到的？整个宇宙是随机生成的。重新创建 Universe 所需的所有数据都是种子值，这总是导致生成完全相同的 Universe。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T15:11:20.313

大多数`rand`实现都是[LCG](http://en.wikipedia.org/wiki/Linear_congruential_generator)，它使用基本数学来执行混合。像大多数 PRNG 一样，它需要随机种子部分消除其通过使用固定和可预测的数学函数创建的确定性性质（这有好有坏，取决于它的预期用途）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-28T15:12:21.030

如果您对`rand()`在实践中使用哪些算法来实现感兴趣， [C 的 rand() 使用了哪些常用算法？](https://stackoverflow.com/questions/1026327/what-common-algorithms-are-used-for-cs-rand)可能会感兴趣。glibc 的实现以及一些解释其他算法的文章的链接。

至于为什么必须设置种子的问题，种子是防止随机数生成器每次都产生相同的数字序列的原因。由于没有真正的随机数生成器，如果你调用5 次`srand(constant)`，`rand()`你得到的 5 个“随机”数总是相同的。但是，如果您使用每次`rand()`使用不同的值进行播种（默认值是我认为自 Unix 纪元以来的秒数），那么您将不会遇到此问题。

# android - 调整“animateTo”位置

> ID：12642611
> 
> 赞同：0
> 
> 时间：2012-09-28T15:06:44.527
> 
> 标签：android, android-mapview

我在我的 上显示了一个兴趣点`mapview`，当它被点击时，我会触发一个`animateTo`以将其置于屏幕中央。但是，我点击后弹出的注释有时太高并被截断屏幕顶部。我想`mapview`稍微向下移动，以便将整个视图显示给用户，而无需他们进一步向下移动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:40:35.517

这将为您提供当前缩放级别下屏幕中心每个像素的纬度值：

```
pixelValueY = projection.fromPixels(mapView.getwidth()/2 ,mapView.getHeight()/2).getLatitudeE6() -  projection.fromPixels(mapView.getwidth()/2 ,mapView.getHeight()/2 +1).getLatitudeE6(); 
```

现在假设您要将地图向下移动 20 个像素，只需将上述值添加到原始中心位置的纬度：

```
mapController.animateTo(new GeoPoint(originalCenterLat + 20 * pixelValueY , originalCenterLon)); 
```

祝你好运

# c# - Castle Windsor ASP.NET MVC 4 和 Web API 相同的应用程序。仅当 MVC 控制器没有依赖项时？

> ID：12642613
> 
> 赞同：5
> 
> 时间：2012-09-28T15:06:57.003
> 
> 标签：c#, asp.net, asp.net-mvc-4, asp.net-web-api, castle-windsor

[这篇文章](http://nikosbaxevanis.com/2012/07/16/using-the-web-api-dependency-resolver-with-castle-windsor-scoped-lifetime)是使用 Castle Windsor 做 Web API 的一个很好的起点，但是如果我创建一个简单的 MVC 控制器呢？它仅在注入没有依赖关系时才有效。

添加这个，即：

```
public class HomeController : Controller
{
    private readonly IValuesRepository repository;

    public HomeController(IValuesRepository repository)
    {
        this.repository = repository;
    }

    public ActionResult Index()
    {
        return View();
    }
} 
```

导致以下错误：

> 为此对象定义的无参数构造函数

有没有办法在使用 Castle Windsor 的同一应用程序中拥有 MVC 和 Web API 逻辑？

设置`DependencyResolver.SetResolver(...)`后`application_start`，我没有注意到我的应用程序有任何改进。

如你看到的。

![WebApiScopedLifetimeDependencyResolverSample.Windsor.WindsorDependencyResolver 类型似乎没有实现](../Images/73569796a063db04af80f862b694ea70.png)

实现服务定位器：

```
internal sealed class WindsorDependencyResolver
    : ServiceLocatorImplBase, IDependencyResolver
{
    private readonly IWindsorContainer container;

    public WindsorDependencyResolver(
        IWindsorContainer container)
    {
        if (container == null)
        {
            throw new ArgumentNullException("container");
        }

        this.container = container;
    }

    public object GetService(Type t)
    {
        return this.container.Kernel.HasComponent(t)
             ? this.container.Resolve(t) : null;
    }

    public IEnumerable<object> GetServices(Type t)
    {
        return this.container.ResolveAll(t)
            .Cast<object>().ToArray();
    }

    public IDependencyScope BeginScope()
    {
        return new WindsorDependencyScope(this.container);
    }

    public void Dispose()
    {
    }

    protected override object DoGetInstance(
        Type serviceType, string key)
    {
        if (key != null)
            return container.Resolve(key, serviceType);
        return container.Resolve(serviceType);
    }

    protected override IEnumerable<object> DoGetAllInstances(
        Type serviceType)
    {
        return (object[])container.ResolveAll(serviceType);
    } 
```

带我回到了起点。

**终于解决了。**

这是其他人的解决方案

* * *

在 application_start...

```
//mvc
DependencyResolver.SetResolver(
    new WindsorMvcDependencyResolver(container));

// web api:
var httpDependencyResolver = 
    new WindsorHttpDependencyResolver(container);

GlobalConfiguration.Configuration.DependencyResolver =
    httpDependencyResolver;

internal class WindsorMvcDependencyResolver
    : WindsorDependencyScope, IDependencyResolver
{
    private readonly IWindsorContainer container;

    public WindsorMvcDependencyResolver(
        IWindsorContainer container) : base(container)
    {
        this.container = container;
    }
}

internal sealed class WindsorHttpDependencyResolver
    : IDependencyResolver
{
    private readonly IWindsorContainer container;

    public WindsorHttpDependencyResolver(
        IWindsorContainer container)
    {
        if (container == null)
        {
            throw new ArgumentNullException("container");
        }

        this.container = container;
    }

    public object GetService(Type t)
    {
        return this.container.Kernel.HasComponent(t)
             ? this.container.Resolve(t) : null;
    }

    public IEnumerable<object> GetServices(Type t)
    {
        return this.container.ResolveAll(t)
            .Cast<object>().ToArray();
    }

    public IDependencyScope BeginScope()
    {
        return new WindsorDependencyScope(this.container);
    }

    public void Dispose()
    {
    }
}

internal class WindsorDependencyScope : IDependencyScope
{
    private readonly IWindsorContainer container;
    private readonly IDisposable scope;

    public WindsorDependencyScope(
        IWindsorContainer container)
    {
        if (container == null)
        {
            throw new ArgumentNullException("container");
        }

        this.container = container;
        this.scope = container.BeginScope();
    }

    public object GetService(Type t)
    {
        return this.container.Kernel.HasComponent(t) 
            ? this.container.Resolve(t) : null;
    }

    public IEnumerable<object> GetServices(Type t)
    {
        return this.container.ResolveAll(t)
            .Cast<object>().ToArray();
    }

    public void Dispose()
    {
        this.scope.Dispose();
    }
} 
```

以及 mvc 和 web api 控制器的注册

```
container.Register(Classes
    .FromAssemblyContaining<HomeController>()
    .BasedOn<Controller>()
    .LifestylePerWebRequest());

container.Register(Classes
    .FromAssemblyContaining<ValuesController>()
    .BasedOn<IHttpController>()
    .LifestyleScoped()); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T09:39:57.670

微软似乎提倡将 Web API 与 MVC 应用程序放在同一个项目中（由他们使用的模板引起）。但是，我不会将 Web API 和 MVC 应用程序混合到同一个项目/网站中。需求和 (DI) 配置很可能需要不同，这将使尝试使用单个容器配置解决此问题的一切变得复杂。

因此，尽管完全可以让 MVC 和 Web API 在同一个应用程序中运行，并且可以使用单个容器，但我的建议是：不要这样做。不仅从技术角度，而且从功能角度。Web API 是一种 Web 服务。您也不会在同一个项目中将 MVC 与 WCF 混合使用。

但如果你真的想要，你只需要注册`System.Web.Mvc.DependencyResolver.SetResolver`（对于 MVC）和`System.Web.Http.HttpConfiguration.DependencyResolver`（对于 Web API）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T04:55:59.590

如果您正在实现 IDependencyResolver 接口并将其与 Application_Start 中的框架连接起来，WindsorDependencyScope 将起作用：[DependencyResolver.SetResolver()](http://msdn.microsoft.com/en-us/library/gg416564%28v=vs.98%29.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-05T15:27:40.487

为了让它在**Owin Startup**上工作，我覆盖`DependencyResolver`了`HttpConfiguration`

```
[assembly: OwinStartup(typeof(YourCompany.API.Startup))]
namespace YourCompany.API
{
    public partial class Startup
    {
        public void Configuration(IAppBuilder app)
        {
            HttpConfiguration config = new HttpConfiguration();
            var dependencyResolver = new WindsorHttpDependencyResolver(container);
            config.DependencyResolver = dependencyResolver;
            // ....... 
            // ....... 
        }
    }
} 
```

# python - 尝试复制目录中的所有 Excel 文件，但没有任何反应，也没有调用错误

> ID：12642614
> 
> 赞同：0
> 
> 时间：2012-09-28T15:07:00.870
> 
> 标签：python, batch-file, copy, shutil

我正在编写一个 python 脚本来将目录树中的所有 Excel 文件复制到另一个目录。直截了当，对吧？

好吧，由于某种原因，shutil.copy（或 copy2，或 copyfile）什么都不做，甚至不吐出错误消息。有任何想法吗？

```
def goFunc(self, event):
    print "Starting Go"
    for (path, dirs, files) in os.walk(self.path):
        print path
        print dirs
        print files
        for every_file in files:
            filename = str(path) + str(every_file)
            print filename
            if filename.endswith('.xlsx'):
                print "Copying " + filename + " to " + str(self.path2)
                shutil.copyfile(filename, str(self.path2))
    print "All DONE!" 
```

所以，除了复制步骤之外，我添加了一个尝试，似乎问题出在那个步骤：

```
def goFunc(self, event):
    print "Starting Go"
    for (path, dirs, files) in os.walk(self.path):
        print path
        print dirs
        print files
        for every_file in files:
            filename = str(path) +'/' + str(every_file)
            print filename
            if filename.endswith('.xlsx'):
                print "Copying " + filename + " to " + str(self.path2)
                try:
                    shutil.copyfile(filename, str(self.path2))
                except:
                    print "Something went wrong"
                    pass
    print "All DONE!" 
```

现在输出是：

```
Starting Go
/Users/laptop/Desktop
[u'test']
[u'.DS_Store', u'.localized', u'Maytag.xlsx', u'mer.xlsx']
/Users/laptop/Desktop/.DS_Store
/Users/laptop/Desktop/.localized
/Users/laptop/Desktop/Maytag.xlsx
Copying /Users/laptop/Desktop/Maytag.xlsx to /Users/laptop/test
Something went wrong
/Users/laptop/Desktop/mer.xlsx
Copying /Users/laptop/Desktop/mer.xlsx to /Users/laptop/test
Something went wrong
/Users/laptop/Desktop/test
[]
[]
All DONE! 
```

由于某种原因，这些文件仍未被复制。

解决方案：

看起来我需要将文件名添加到目的地。现在它就像一个魅力！感谢大家的时间和帮助。

```
def goFunc(self, event):
    print "Starting Go"
    for (path, dirs, files) in os.walk(self.path):
        print path
        print dirs
        print files
        for every_file in files:
            filename = str(path) +'/' + str(every_file)
            print filename
            if filename.endswith('.xlsx'):
                print "Copying " + filename + " to " + str(self.path2) + '/' + str(every_file)
                try:
                    shutil.copyfile(filename, str(self.path2)+'/'+ str(every_file))
                except:
                    print "Something went wrong"
                    pass
print "All DONE!" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:13:53.290

你可以（ab）使用`shutil.copytree`

```
import shutil
import os.path

src = '/home/jon/Development/number5'
dst = '/home/jon/tmpso'

def not_xlsx(path, names):
    return {name for name in names if os.path.isfile(name) and not name.endswith('.xlsx')}

shutil.copytree(src, dst, ignore=not_xlsx) 
```

`fnmatch`如果您想要更复杂的通配符/等...匹配（可能类似于），您也可以查看该模块：

```
def not_xlsx(path, names):
    actual_files = filter(os.path.isfile, names)
    return set(actual_files).difference(fnmatch.filter(actual_files, '*.xlsx')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:21:23.433

使用 th方法很好，但它也会返回and之类的`os.walk`东西，所以要小心。这是一个应该的类方法：`[]``.`

```
def goFunc(self, event):
    '''this should be enough to copy files that end with xlsx'''
    print "Starting Go"
    for file in os.listdir(Yourdir):
        if file.endswith('.xlsx'):
                print "Copying " + filename + " to " + str(self.path2)
                shutil.copyfile(filename, self.path2)
    print "All DONE!" 
```

好的，不要重新发明轮子：

```
dirs=[o for o in os.listdir(TopOfTree) if os.path.isdir(o)]
for dir in dirs:
    goFunc(event) 
```

请参阅此处[获取当前目录中所有子目录的列表](https://stackoverflow.com/questions/973473/getting-a-list-of-all-subdirectories-in-the-current-directory)

# multithreading - 对 Web 应用程序的多个线程请求的线程排序

> ID：12642615
> 
> 赞同：0
> 
> 时间：2012-09-28T15:07:01.543
> 
> 标签：multithreading, spring-mvc, struts

我正在支持由其他人编写的 Web 应用程序，但我看到了一些有趣的行为。该应用程序使用 struts、spring mvc 和 tomcat 作为应用服务器。

Web 应用程序由某个第三方显示在框架中，并通过链接访问。

单击链接时，两个请求会在两个线程上发送到 tomcat。一个线程应该对用户进行身份验证并初始化数据。另一个线程使用初始化的数据来渲染屏幕。

**问题：** 有时依赖线程首先启动，导致屏幕上显示错误。但是由于初始化线程仍在处理中，并且在依赖线程之后完成，结果将返回给用户，并在屏幕上显示适当的数据。问题是在初始化线程运行时显示错误。

**问题：** 这种行为是 struts 或 Spring MVC 中固有的吗？我在应用程序中没有看到导致此行为的任何内容。

我个人希望只启动一个线程并在同步调用中进行初始化和显示。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:10:08.263

这称为竞争条件。当您开始处理线程时非常常见。它与您正在做的事情无关，但是在运行代码的非常随机的行为以及线程决定触发的任何方式中，它们就是这样做的。

# drupal - 在drupal中将权重字段添加到捆绑包

> ID：12642617
> 
> 赞同：1
> 
> 时间：2012-09-28T15:07:12.950
> 
> 标签：drupal, sorting, bundle, drupal-views, entities

现在，我不太确定实体和捆绑包周围的词汇，所以很抱歉，但这是我的问题。

我有很多内容类型，在一个视图中，我想先按内容类型对节点进行排序，然后按日期排序

但是没有任何意义的排序价值——我想将内容类型排序为定制的顺序“衣服、动物、饮料、人”——即不按字母顺序排列。

我尝试使用全局 php 将这些排序为定制的顺序 - 它工作正常。IE

```
$myarray=array("films","shoes","people","animals"); 
```

这是设置代码，然后对于每一行，views php 允许您这样排序：

```
$pos1=array_search($row1->type, $myarray);
$pos2=array_search($row2->type, $myarray);
return $pos1-$pos2; 
```

它有效，但我不能将它与日期排序结合起来，无论如何开销一定很糟糕。

所以，我的问题是，有没有一种方法可以在我认为可能是捆绑级别（！？）的内容类型中添加一个加权字段，以允许我按内容类型对视图中的数据进行排序，在定制订单（非字母顺序）。

呸。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T15:28:54.270

在 MySQL 中，有一种按给定列表顺序排序的方法。请参阅[MySQL 按某些列表排序](https://stackoverflow.com/questions/6810793/mysql-sort-by-some-list)

要在 Drupal 中执行此操作，您可以尝试在 a 中添加类似这样的内容`hook_views_query_alter`：

```
$query->orderby[0] = "FIELD(node.type, 'films', 'shoes', 'people', 'animal') ASC"; 
```

如[https://drupal.stackexchange.com/questions/35543/syntax-for-the-various-query-modifiers中所述](https://drupal.stackexchange.com/questions/35543/syntax-for-the-various-query-modifiers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-22T12:55:44.373

In case anyone comes across this, nmc's solution is good, but I couldnt get it to work (my fault surely) so I used hook_views_pre_render:

```
function MYMODULE_views_pre_render(&$view){

if($view->name=='entries_for_a_journal') {

    $entryitemarray=array();

foreach($view->result as $entryitem){
    $entryitemarray[$entryitem->node_type][]=$entryitem;
    }
$listoftypes=array('destination','tourplan','packing_list','diary','accomodation','eatinganddrinking','placesofinterest','knowledge','recipe','peopleimet','usefulcontacts');

foreach($listoftypes as $typename){
foreach($entryitemarray[$typename] as $newviewentry){
$newviewresult[]=$newviewentry;

}

}

    $view->result=$newviewresult;  

}

} 
```

# facebook - Facebook API 限制没有访问令牌的图形/图片调用

> ID：12642622
> 
> 赞同：2
> 
> 时间：2012-09-28T15:07:27.970
> 
> 标签：facebook, facebook-graph-api

在没有访问令牌的情况下，应用程序或 IP 对 graph.facebook.com/{facebookid}/picture 的调用量是否存在 API 限制？如果是这样，它是什么样的限制？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:34:35.990

如果您担心限制，请限制您的 API 调用：

```
https://graph.facebook.com/picture?ids=FBID1,FBID2,...FBIDn&redirect=false 
```

您将获得一个 json 对象，其中包含每个 id 的 ID 和图片 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:09:32.553

来自 Facebook 速率限制、限制和禁用

为什么我的应用程序获得速率限制？为了优化我们的 API 和调用它们的应用程序的性能，我们对进行未优化查询、过于频繁地请求数据或在没有访问令牌的情况下生成大量请求的应用程序进行速率限制。这最大限度地减少了一个应用程序对其他应用程序的性能产生负面影响的可能性。

Facebook 为开发人员提供了一种工具，可以更好地了解他们是否受到限制以及原因。要访问此工具，请单击 Developer 应用程序中的 Statistics 链接，然后单击 Throttling 选项卡。

所有生产应用程序都应使用访问令牌、应用程序密码或会话密码对其请求进行签名。详细了解如何使用 OAuth 2.0 访问令牌或更旧的身份验证方法对调用进行签名。

[https://www.facebook.com/help/?page=100502990045478](https://www.facebook.com/help/?page=100502990045478)

# python - python中全局变量的频率？

> ID：12642624
> 
> 赞同：9
> 
> 时间：2012-09-28T15:07:33.203
> 
> 标签：python

Stack Overflow 有很多关于 python 中的全局变量的问题，这似乎给来自其他语言的人带来了一些困惑。范围界定规则并不像许多其他背景的人所期望的那样工作。

同时，代码的组织不是在类级别上，而是在模块级别上。因此，当所有东西都不一定包含在类中时，本来可以在成员变量中找到的状态可以放在模块级变量中。

所以我的问题是两部分：

1）我是否应该避免使用全局变量（特别是在函数中设置它们并使用 global 关键字）？

2) 如果#1 是肯定的，是否有预期使用它们的常见模式？

我在一个有很多不同语言的地方工作，我想减少混乱并确保 pythonistas 以后不会讨厌我。

感谢您的任何建设性意见。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T15:24:51.060

我强烈建议您阅读这篇题为[Singletons and their Problems in Python 的](http://lucumr.pocoo.org/2009/7/24/singletons-and-their-problems-in-python/)博文。它让我重新思考我对全局变量的使用。一些选择引用：

> 但要小心。仅仅因为你没有实现单例设计模式并不意味着你避免了单例的核心问题。单例的核心问题是全局共享状态。单例只不过是一个美化的全局变量，在像 Java 这样的语言中，有很多原因可以让你使用像单例这样的东西。在 Python 中，我们为单例提供了一些不同的东西，它有一个非常纯真的名字，隐藏了血腥的细节：模块。
> 
> 没错，Python 模块是单例的。它与单例模式有相同的问题，只是它有点糟糕。

以下是具有此类共享状态可能导致的问题的一个示例：

> 为了不谈论无关紧要的事情，让我们看一下标准库中的一个模块，mimetypes 模块。
> 
> 看一看：

```
inited = False

def init(files=None):
    global inited
    db = MimeTypes()
    ... 
```

> 这是来自 Python 附带的 mimetypes 模块的实际代码，只是删除了更多血腥的细节。关键是，有共享状态。共享状态是一个布尔标志，如果模块已初始化，则为 True，否则为 False。现在这种特殊情况可能不是那么有问题（相信我，确实如此），因为 mimetypes 会自行初始化，但您可以看到 init 函数有一个 files 参数。如果将文件列表传递给该函数，它将使用来自这些文件的 mime 信息重新初始化内存中的 mime 数据库。现在想象一下，如果你有两个库用两个不同的源初始化 mimetypes 会发生什么……</p>

这是一个足够常见的模式，我自己已经完成了......但例如更好的方法是：`init`返回实现所有方法的类的实例，并且代码的其他部分可以`init`获取具有不干扰前者的不同参数的不同实例。“缺点”是您必须将此实例传递给任何不想初始化新实例的代码，但“缺点”的优点是它使您的依赖关系变得显而易见。

无论如何，简而言之，我会尽量避免它，但如果你对具有隐式单例的代码感到满意，那就去吧。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:28:39.067

我对你的另一个问题发表了评论，所以这是我的 2 美分：

Python 是面向对象的，但您不必使用它。但是，如果您选择这样做，您可以利用 Class 的这种机制来保存一些属性：

```
class Config():
"""
hold some vars for example.
"""
def __init__(self):
    self.CONFIG_LOG_FILE_DIR='/tmp2/ozn/venus_mon_log/'
    self.DATE_FORMAT="%Y%m%d"
    #self.FILE_NAME_BASE_TEMPLATE=eval('datetime.datetime.now().strftime(self.DATE_FORMAT)')+'-venus_utilization.log'
    self.FILE_NAME_BASE_TEMPLATE='venus_utilization.log'
    self.FILE_NAME=self.CONFIG_LOG_FILE_DIR+self.FILE_NAME_BASE_TEMPLATE
    self.MAX_FILE_SIZE=1024*1024*50 # in Byte, 50 in MB. 
```

您可以创建一个实例，让您访问属性：

```
 cfg = Config() 
```

然后使用以下命令访问它们：

```
 cfg.MAX_FILE_SIZE 
```

甚至改变它们：

```
 cfg.MAX_FILE_SIZE=50000 
   cfg.MAX_FILE_SIZE=calculateNewSize() 
```

等等...您还可以执行以下操作：

```
 # this will print all items that an instance has    
 if options.debug:
    print "DEBUG INFO:"
    for k,v in vars(cfg).iteritems():
        print k,v 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T15:17:33.760

简而言之，是的，您应该避免使用`global`关键字。它可能在语言中是有原因的，但我通常认为它是一种代码味道——如果你有一些想要保持的状态，请将它封装在一个类中。这远没有使用`global`.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-28T15:10:15.497

全局变量并不是真正的禁忌，只是你必须记住在使用它们之前在你的函数中将它们声明为全局变量。在我看来，这实际上使它们更加清晰，因为用户看到您明确使用了全局变量。

我会更害怕非 pythonistas 不理解 python 全局变量，修改你的代码并且不添加正确的全局声明。

# parsing - Scala --- 在解析器中使用“[”“]”时出错

> ID：12642628
> 
> 赞同：0
> 
> 时间：2012-09-28T15:07:57.160
> 
> 标签：parsing, scala

这是我的解析器

```
def assstm: Parser[Any] = indexop ~ ":=" ~ expression ~ ";"
def indexop: Parser[Any] = ident ~ "[" ~ expression ~ "]" 
```

myArray[5] 存在错误：= 5

```
``('' expected but `[' found 
```

但是有了这个解析器

```
def assstm: Parser[Any] = indexop ~ ":=" ~ expression ~ ";"
def indexop: Parser[Any] = "[" ~ expression ~ "]" 
```

我用 [5] := 5 测试，没有错误。

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:13:09.533

我们需要您的更多语法片段来完全回答您的问题。但是，这看起来像是一个回溯问题：您可能已经定义了一个测试多个备选方案的规则，每个备选方案使用`ident`: 一个 where`ident`必须后跟括号，以及您的`assstm`规则。

使用`ident`和括号的规则可能会引发[错误](http://www.scala-lang.org/api/current/scala/util/parsing/combinator/Parsers%24Error.html)（而不是[失败](http://www.scala-lang.org/api/current/scala/util/parsing/combinator/Parsers%24Failure.html)），从而中止解析器的运行。

# ios - 社会框架ios5

> ID：12642629
> 
> 赞同：7
> 
> 时间：2012-09-28T15:08:01.403
> 
> 标签：ios

当我在 ios5 上使用 facebook 的社交框架运行我的应用程序时，它会崩溃，我可以理解。如果设备是ios6，有没有办法导入它？

我试过这个，ver_float 是 ios 版本：

```
if (ver_float >= 6.0) {
    #import <Social/Social.h>
} 
```

但是，如果我从代码页顶部删除 #import，应用程序将无法运行。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-09-28T16:09:59.003

只需确保在 Build Phases 下将 Social.framework 设置为可选。

# jquery - 带有 Jquery 的模态 PDF IFRAME

> ID：12642630
> 
> 赞同：0
> 
> 时间：2012-09-28T15:08:04.877
> 
> 标签：jquery, pdf, iframe, modal-dialog

所以这是我的脚本，完美运行，没有问题。现在我为什么要在此处发布此内容，主要是为了增强它并使其变得更好，而且我认为这可以帮助其他人！查询！这是一个工作示例[http://jsfiddle.net/cornelas/4eUgf/2/](http://jsfiddle.net/cornelas/4eUgf/2/)

```
 $(document).ready(function() {
        $('.select').click(function () {
        $('.pdf_grey').fadeIn('slow');
        $('.select').hide();
        $('.deselect').show();
   });
     $('.deselect').click(function() {
        $('.pdf_grey').fadeOut('slow');
        $('.select').show();
        $('.deselect').hide();
    });
        $('.pdf_grey').css({'opacity' : 0.8});
    });
    $(document).mouseup(function (e)
{
    var container = $(".pdf_grey");
var deselect = $(".deselect");
var select = $(".select");

    if (container.has(e.target).length === 0)
    {
        container.hide();
       deselect.hide();
       select.show();
    }
}); 
```

这是我的 HTML

### 现场手册

预览最小化 | 下载

```
<div class="pdf_grey">
<span class="deselect top_inf"><h3>Close<h3></span><br>
<iframe id="manual" style="border:1px solid #666CCC" title=" Manual" src="Images/pdf/UserMaual.pdf" frameborder="1" scrolling="auto" height="600" width="850" ></iframe>
</div>
</div>  
</div> 
```

最后和 CSS

```
.pdf_grey {
position: absolute;
left: 500px;
top: 100px;
display: none;
padding: 25px;
background: #333;
}
.deselect {
    display: none;
    cursor: pointer;
}
.select {
    cursor: pointer;
    color: #666;

}
.select:hover {
    color: red;

} 
```

如果你注意到我写了这个脚本，它专门针对类 PDF 灰色，并且它会显示设置为隐藏的类，那么 div 包含一个加载 PDF 的 iframe。我认为这是在不更改页面的情况下加载 pdf 的一种非常简单的酷方法。现在.. 百万美元的问题，我该如何做，这样如果有任何一个 pdf 类，它将加载它隐藏的内容。如您所见，我不想疯狂设置课程。我想在 ahref 或我们必须设置一个加载 Iframe 的类的东西。谢谢大家的帮助，当我的脚本完成后，我会与任何帮助命名的人一起发布我的脚本，我看到的所有模态都是蹩脚的，而且反应迟钝。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:50:09.940

您需要查看提供源 URL 的 .load 函数。您需要做的就是想办法将源代码保存为变量并将其修补到加载函数中。如果您要单击缩略图，则： 然后每当单击 .pdf 时，首先保存 src： var src=$(this).parent('a').attr('src'); 然后，您可以使用 .load 并使用 src 变量定位 iframe。查看 .load 的 API 文档时应该会很清楚。关于加载到 iframe 中的几件事：iframe 用于外部 html 文档，而 object 标记用于外部文件，例如 flash、PDF、视频等。您可能需要查看 object 标记。

iframe 很难设置任何错误处理，因此如果您的 PDF 未加载，显示错误可能会非常困难。有一些解决方法，但我没有见过好的解决方法，它们主要依靠设置计时器来查看 iframe 是否已加载，并且某些站点/pdf 可能需要很长时间才能加载，从而导致错误错误。

由于浏览器需要插件，因此 Pdf 很难使用。没有安装 PDF 阅读器的用户怎么办，在这种情况下也无法进行错误检查。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:34:25.357

请参阅此处的示例[http://jsfiddle.net/cornelas/4eUgf/4/](http://jsfiddle.net/cornelas/4eUgf/4/) Iframe 现在基于链接而不是显示加载页面的 iframe 的链接！

```
 $(document).ready(function() {
        $("a.select").live('click', function (e) {
           e.preventDefault();
           var href = this.href;
          $("#manual").attr("src", href);
        });
    $('.full').css({'opacity' : .7});

    $('.select').click(function () {
        $('.pdf_grey').fadeIn('slow');
        $('.full').fadeIn('slow');
        $('.select').hide();
        $('.deselect').show();
    });
    $('.deselect').click(function() {
        $('.pdf_grey').fadeOut('slow');
        $('.full').fadeOut('slow');
        $('.select').show();
        $('.deselect').hide();
    });

    });
    $(document).mouseup(function (e)
{
    var container = $(".pdf_grey");
    var bkg = $(".full");
    var deselect = $(".deselect");
    var select = $(".select");

    if (container.has(e.target).length === 0)
    {
        container.hide();
        deselect.hide();
        select.show();
        bkg.hide();
    }
});

    <div class="full">
    <div class="pdf_grey">
    <span class="deselect top_inf"><h3>Close<h3></span><br>
    <iframe id="manual" style="border:1px solid #666CCC" title=" Manual" src="" frameborder="1" scrolling="auto" height="600" width="850" ></iframe>
    </div>
    </div>
    <div id="wrapper">
    <p class="1">
    <h3>Site Manual</h3><a href="http://www.ntxmsk.com/pdf/nwpt.pdf#zoom=100" class="select">Preview</span><span class="deselect">Minimize</span> | <a href="Images/pdf/Site_Help_Manual_2012.zip">Download</a><br>
        </p>
    <p class="2">
    <h3>Site Manual</h3><a href="http://www.ntxmsk.com/pdf/HIPPA.pdf#zoom=100" class="select">Preview</span><span class="deselect">Minimize</span> | <a href="Images/pdf/Site_Help_Manual_2012.zip">Download</a>
        </p>
    <div class="topdiv">

    </div>    
    </div>

        body {
        padding:0px;
        margin: 0px;
        }
        .full {
        background: #000;
         width: 100%;
    height: 100%;
    position: absolute;
    z-index: 5;
    display: none;
    }
    .red {
    background: red;
    width: 10%;
    height: 25%;
    }
    .pdf_grey {
    position: absolute;
    left: 25%;
    top: 15%;
    display: none;
    padding: 25px;
    background: #333;

    }
    .deselect {
        display: none;
        cursor: pointer;
    }
        .select {
        cursor: pointer;
        color: #666;

    }
    .select:hover {
        color: red;

    } 
```

# c# - C# - 字符串格式：双倍固定宽度

> ID：12642642
> 
> 赞同：2
> 
> 时间：2012-09-28T15:09:00.733
> 
> 标签：c#, double, fixed-width, custom-formatting

如何`String.Format`在 C# 中使用双打显示如下：

价值观：

```
-1.0
1.011
100.155
1000.25
11000.52221 
```

显示字符串：

```
-1.00
1.011
100.2
 1000
11001 
```

重点是我的宽度无论如何都固定为 5 个字符。我真的不在乎右边显示了多少小数位。如果小数点左侧有 4 个或更多数字，我希望删除小数点右侧的所有内容（包括小数点本身）。

这似乎应该是一种非常标准的做法。但是我没有太多运气找到有效的答案。

**对上面的显示字符串进行了一些更正，我确实想要四舍五入。**

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-26T05:04:23.090

通常这条规则适用于交易所市场，我将其开发如下：

```
if (number < 1)
   cell.Value = number.ToString("0.00000");
else if (number < 10)
   cell.Value = number.ToString("0.0000");
else if (number < 100)
   cell.Value = number.ToString("00.000");
else if (number < 1000)
   cell.Value = number.ToString("000.00");
else if (number < 10000)
   cell.Value = number.ToString("0000.0");
else if (number < 100000)
   cell.Value = number.ToString("00000"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T15:22:29.703

```
public string FormatNumber(double number)
{
    string stringRepresentation = number.ToString();

    if (stringRepresentation.Length > 5)
        stringRepresentation = stringRepresentation.Substring(0, 5);

    if (stringRepresentation.Length == 5 && stringRepresentation.EndsWith("."))
        stringRepresentation = stringRepresentation.Substring(0, 4);

    return stringRepresentation.PadLeft(5);
} 
```

编辑：刚刚意识到这不会在必要时在小数点末尾填充零（如在您的第一个示例中），但应该为您提供根据需要完成它的工具。

EDITx2：鉴于您打算进行舍入的最新添加，它变得更加复杂。首先，您必须检查*是否*有小数位以及小数点在什么位置。然后你必须将它四舍五入到那个小数位，然后可能会遍历输出。请注意，根据您的算法，您可能会在四舍五入的数字上得到一些不正确的结果（例如，`-10.9999`可能会变成`-11.00`或`-11`取决于您的实现）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:29:00.230

如果要在很多地方经常使用它，请在 Double 上创建一个扩展方法。

```
using System;

public static class DoubleExtensionMethods
{
    public static string FormattedTo5(this double number)
    {
        string numberAsText = number.ToString();

        if (numberAsText.Length > 5)
        {
            numberAsText = numberAsText.Substring(0, 5);
        }

        return numberAsText.TrimEnd('.').PadLeft(5);
    }
} 
```

用法将是：

```
double myDouble = 12345.6789D;

string formattedValue = myDouble.FormattedTo5(); 
```

# c++ - UDP Boost ASIO 异步客户端挂起

> ID：12642643
> 
> 赞同：2
> 
> 时间：2012-09-28T15:09:06.313
> 
> 标签：c++, boost, udp, boost-asio, udpclient

我正在尝试使用 boost asio 制作一个玩具异步回显客户端。由于某种原因，它在第二个请求/回复周期中被阻塞，同时等待 send_=true，但在接收回显之前（没有服务器崩溃）。

```
/*
UDP asynchronous clint using boost asio library
 */
#include <cstdlib>
#include <iostream>
#include <algorithm>

#include <boost/array.hpp>
#include <boost/asio.hpp>
#include <boost/lexical_cast.hpp>
#include <boost/thread.hpp>
#include <boost/bind.hpp>
#include <boost/chrono/duration.hpp>

#include "dbook/test/tools.hpp"

using boost::asio::ip::udp;

const size_t N_MESSAGES = 1024;

class udp_client {
public:
  udp_client(const std::string& host,const std::string& service)
    :io_service_(),
     socket_(io_service_),
     replied_(false),
     sent_(false)
  {
    socket_.open(boost::asio::ip::udp::v4());
    udp::resolver resolver(io_service_);
    udp::resolver::query query(udp::v4(), host,  service);
    endpoint_ = *resolver.resolve(query);

  }
  ~udp_client() {
    socket_.close();
  }

  bool sent() {
    return sent_;
  }

  void send(const int r) {
    replied_ = false;
    sent_ = false;

    memcpy(&send_buf_[0],&r,sizeof(int));
    std::cout << "prepare sending" << std::endl;

    socket_.async_send_to(boost::asio::buffer(send_buf_), endpoint_,
              boost::bind(&udp_client::handle_send, this,
                      boost::asio::placeholders::error,
                      boost::asio::placeholders::bytes_transferred));
    io_service_.run_one();

    std::cout << "after run_one" << std::endl;

  }

  bool replied() {
    return replied_;
  }

  int reply() {
    return *reinterpret_cast<int*>(&recv_buf_[0]);
  }

private:
  void handle_send(const boost::system::error_code& error,
           std::size_t size)
  {
    if (error) {
      //missing error propagation to main thread
      std::cerr << "ERROR: Client error while sending (error code = " << error << "): "  << std::endl;
      std::cerr << "ERROR: Recovering..." << std::endl;

    } else {
      sent_ = true;
      std::cout << "sent" << std::endl;
      socket_.async_receive_from(boost::asio::buffer(recv_buf_), endpoint_,
                 boost::bind(&udp_client::handle_receive, this,
                         boost::asio::placeholders::error,
                         boost::asio::placeholders::bytes_transferred));
      io_service_.run_one();

    }
  }

  void handle_receive(const boost::system::error_code& error,
              std::size_t size) {
    if (error) {
      //missing error propagation to main thread
      std::cerr << "ERROR: Client error while receiving (error code = " << error << ")" << std::endl;
      std::cerr << "ERROR: Recovering..." << std::endl;

    } else {
      std::cout << "received" << std::endl;

      replied_ = true;
    }
  }

private:
  boost::asio::io_service io_service_;
  udp::socket socket_;
  udp::endpoint endpoint_;
  volatile bool replied_;
  volatile bool sent_;
  volatile int reply_;
  boost::array<char, sizeof(int)> send_buf_;
  boost::array<char, sizeof(int)> recv_buf_;

};

int main(int argc, char* argv[]) {

  if (argc != 3) {
    std::cerr << "Usage: udp_echo_client <host> <port>" << std::endl;
    return 1;
  }

  try {
    udp_client c(argv[1],argv[2]);

    for(size_t i=0; i != N_MESSAGES; ++i) {
      int r = rand();
      c.send(r);

      //here we could put a tiemeout
      while (!c.sent()) {
    boost::this_thread::sleep(boost::posix_time::milliseconds(10)); 
      }

      //here we could put a tiemeout
      while (!c.replied()) {
    boost::this_thread::sleep(boost::posix_time::milliseconds(10)); 
      }
      int resp = c.reply();

      std::cout << "sent= " << r << ", received= " << resp << std::endl;
      assert(r == resp);
    }

  } catch (std::exception& e) {
    std::cerr << "ERROR: " << e.what() << std::endl;
  }

  return 0;
} 
```

我得到的日志是：

```
$ ./bin/udp_echo_client localhost 11111
prepare sending
sent
received
after run_one
sent= 16807, received= 16807
prepare sending
after run_one 
```

我想这是我对如何使用 boost asio 缺乏了解。所以，如果有人能解释为什么程序会这样，我将不胜感激:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-02T14:18:43.900

按照建议宣传我的评论：

通常，您需要不断地轮询`io_service`（或更恰当地说，只需调用`io_service::run`。在这种特殊情况下，您需要在完成`io_service::reset()`后调用`io_service::run_one()`。

# php - 非常简单的购物车，移除按钮

> ID：12642644
> 
> 赞同：1
> 
> 时间：2012-09-28T15:09:07.253
> 
> 标签：php, html, mysql, cart, shopping

我正在编写将遍历一组页面的销售软件，在某些页面上列出要出售的项目，当您单击购买时，它基本上只是将一个隐藏变量传递到下一页以设置为会话变量，然后当你到最后它调用被报告给数据库。但是我的雇主希望我加入一个购物车，这个购物车应该显示你所购买的商品名称、sku 和价格，以及一个删除按钮，这样执行脚本的人就不需要返回整个事情删除一个项目。目前，我将购物车设置为显示所有内容，这相当简单。但我不知道如何让删除按钮工作。这是购物车的代码：

```
 $total = 0;
    //TEST CODE:
    $_SESSION['itemname-addon'] = "Test addon";
    $_SESSION ['price-addon'] = 10.00;
    $_SESSION ['sku-addon'] = "1234h";

    $_SESSION['itemname-addon1'] = "Test addon1";
    $_SESSION ['price-addon1'] = 99.90;
    $_SESSION ['sku-addon1'] = "1111";

    $_SESSION['itemname-addon2'] = "Test addon2";
    $_SESSION ['price-addon2'] = 19.10;
    $_SESSION ['sku-addon2'] = "123";
    //end test code

    $items = Array
    (
            "0"=> Array
            (
                "name" => $_SESSION['itemname-mo'],
                "price" => $_SESSION ['price-mo'],
                "sku" => $_SESSION ['sku-mo']
            ),
            "1" => Array
            (
                "name" => $_SESSION['itemname-addon'],
                "price" => $_SESSION ['price-addon'],
                "sku" => $_SESSION ['sku-addon']
            ),
            "2" => Array
            (
                "name" => $_SESSION['itemname-addon1'],
                "price" => $_SESSION ['price-addon1'],
                "sku" => $_SESSION ['sku-addon1']
            ),
            "3" => Array
            (
                "name" => $_SESSION['itemname-addon2'],
                "price" => $_SESSION ['price-addon2'],
                "sku" => $_SESSION ['sku-addon2']
            )

        );

    $a_length = count($items);

    for($x = 0; $x<$a_length; $x++){
    $total +=$items[$x]['price']; 
    }
    $formattedtotal = number_format($total,2,'.','');
    for($i = 0; $i < $a_length; $i++){
    $name = $items[$i]['name'];
    $price = $items[$i]['price'];
    $sku = $items[$i]['sku'];
    displaycart($name,$price,$sku);
    }
    echo "<br />
    <b>Sub Total:</b> 
    $$formattedtotal";

        function displaycart($name,$price,$sku){

            if($name != null || $price != null || $sku != null){

            if ($name == "no sale" || $price == "no sale" || $sku == "no sale"){
            echo ""; 
            }
            else{
                $formattedprice = number_format($price,2,'.','');
                echo "$name: $$formattedprice ($sku)";
                echo "<form action=\"\" method=\"post\">";
                echo "<button type=\"submit\" />Remove</button><br />";
                echo "</form>";
            }

            }
        } 
```

所以在这一点上，我不确定从这里到哪里去删除按钮。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:27:02.173

您可以在会话变量上使用数组，以便您可以将格式更改为

```
$_SESSION[items][] = ("name"=>$name, "sku"=>$sku, "price"->$price) 
```

在你`function displaycart()`添加元素

```
echo "<input type='hidden' name='delete_sku' value='$sku'>\n"; 
```

那么当你删除你时：

```
$delete_sku = $_POST[delete_sku]; // the posted ID sent from delete form
$i = 0;
foreach ($_SESSION[items] as $item) {
    if ($item['sku'] == $delete_sku) {
        unset ($_SESSION[$i]);  // remove the item from the session array
    }
    $i++;
}
print_r ($_SESSION); 
```

# c# - 获取命令绑定的点击位置

> ID：12642645
> 
> 赞同：6
> 
> 时间：2012-09-28T15:09:07.750
> 
> 标签：c#, wpf, mvvm, command

我想要做的是一个用户控件，其中包含一个带有网格的部分，单击网格时会发生一些事情。我需要点击发生的像素的位置，并且我正在做所有这种 MVVM 样式。我知道如何在 ViewModel 上提示操作：

```
<Grid>
 <Grid.InputBindings>
   <MouseBinding Gesture="LeftClick" Command="{Binding MinimapClick}"/>
 </Grid.InputBindings>
</Grid> 
```

我现在的问题是我不知道如何检索坐标......有什么想法吗？我感谢您的帮助！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-01T06:30:33.777

KDiTraglia为我提供[了正确的指针](https://stackoverflow.com/a/12642787/3195477)......无论如何，我在定义动作和绑定到我的 ViewModel 时遇到了一些问题。如果其他人有问题，我会发布我的解决方案。这是我在 xaml 中所做的：

```
<Grid Width="100" Height="100" Grid.Column="2" Grid.Row="2" x:Name="TargetGrid">
    <Grid>
        <Grid.InputBindings>
            <MouseBinding Gesture="LeftClick" Command="{Binding Path=TargetClick}" CommandParameter="{Binding ElementName=TargetGrid}" />
        </Grid.InputBindings>
    </Grid>
</Grid> 
```

我创建了 UserControl 并将其绑定到 ViewModel。在 ViewModel 中，我实现并创建了以下命令：

```
public class PositioningCommand : ICommand
{
    public PositioningCommand()
    {
    }

    public void Execute(object parameter)
    {
        Point mousePos = Mouse.GetPosition((IInputElement)parameter);
        Console.WriteLine("Position: " + mousePos.ToString());
    }

    public bool CanExecute(object parameter) { return true; }

    public event EventHandler CanExecuteChanged;
}

public PositioningCommand TargetClick
{
    get;
    internal set;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T15:17:18.210

这个怎么样？

```
private void MinimapClick(object parameter)
{
    Point mousePos = Mouse.GetPosition(myWindow);
} 
```

如果您没有对窗口的引用，您可以将其作为参数发送（或使用您想要的任何参考点）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-19T19:42:01.290

我有一个相关的问题 - 我想为我的**ContextMenu**捕获点击事件的鼠标位置。问题： CommandParameter ElementName 无法识别我的菜单的*父级（图像控件）。*

作为参考，在将菜单添加到命名空间*之前*，我收到的绑定错误是：

```
 System.Windows.Data Error: 4 : Cannot find source for binding with reference 'ElementName=imgArena'. BindingExpression:(no path); DataItem=null; target element is 'MenuItem' (Name='mnuAddItem'); target property is 'CommandParameter' (type 'Object') 
```

显然 WPF 上下文菜单与您的控件属于不同的可视化树，这使得绑定非常令人沮丧。

经过一番研究，我发现了这个简单的修复，我将它放在后面代码的构造函数中：

```
 NameScope.SetNameScope(mnuGrid, NameScope.GetNameScope(this)); 
```

其中“mnuGrid”是我的上下文菜单的名称。

在我这样做之后，我能够将我的控制作为参数传递给我的命令，就像上面的 Beta Vulgaris 所做的那样。

作为参考，我的 XAML 如下所示：

```
 <Image Name="imgArena" >
        <Image.ContextMenu>
            <ContextMenu Name="mnuGrid">
                <MenuItem Header="Place _Entry" Name="mnuAddItem"
                    Command="{Binding AddEntryCmd}" 
                    CommandParameter="{Binding ElementName=imgArena}" />
            </ContextMenu>
        <Image.ContextMenu>
    </Image> 
```

# asp.net - 从另一个项目使用 WCF 服务

> ID：12642647
> 
> 赞同：0
> 
> 时间：2012-09-28T15:09:20.233
> 
> 标签：asp.net, wcf

我正在执行以下步骤。

1.  使用 WCF 服务库创建 WCF 服务

2.  通过在项目中按 F5 运行和测试 WCF 服务（它运行良好）

3.  在 Visual Studio 的同一解决方案中创建另一个项目

4.  将服务引用添加到我之前在步骤 1 中创建的 WCF 服务

但是，新项目无法识别我在步骤 1 中创建的 WCF 服务。如何使用在不同项目中创建的 WCF 服务？当从同一个项目调用相同的服务调用时，它可以正常工作。我在使用 HelloWorld2 时遇到了一条红线；

```
 using HelloWorld2; 

namespace WebApplication1
{
public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
       // Helloworld2 client = new Helloworld2();

        // Use the 'client' variable to call operations on the service.
       // Name person = new Name();
       // person.First = "Adam";
       // person.Last = "Smith";

       // Response.Write(person.First);

    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:19:39.690

是否从同一个项目调用服务并不重要。

您能否检查 Fiddler 并查看正在发送的 HTTP 流量？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T14:46:08.493

这是因为我错过了添加引用的代码

ServiceReference2.Helloworld2Client cc = new ServiceReference2.Helloworld2Client(); ServiceReference2.Name person = new ServiceReference2.Name();

# r - 在R中如何获取英文错误消息

> ID：12642651
> 
> 赞同：16
> 
> 时间：2012-09-28T15:09:31.960
> 
> 标签：r, bioconductor

我正在尝试一些关于生物导体的教程；但我收到错误消息，我想搜索/提交；不幸的是，由于 R 安装在以法语配置的系统上，R 以法语向我返回消息；我怎么会有这些英文信息。

我的系统：运行 gnome 3 的 Ubuntu 10.04；R 版本是最后一个 (2.15.1) Bioconductor 已更新到 2.10，

并且我尝试下载/使用数据集 GSE20986（但我在遵循“R in a nutshell”中给出的过程时遇到了另一个数据集 GSE2034 的类似错误）；对于你们这些说法语的人，我得到的错误信息是：

```
> getGEOSuppFiles("GSE20986")
[1] "ftp://ftp.ncbi.nlm.nih.gov/pub/geo/DATA/supplementary/series/GSE20986/"
Erreur dans scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  : 
  la ligne 1 n'avait pas 6 éléments 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:31:37.530

我认为您需要`LANGUAGE`在启动**R**时设置环境变量。尝试像这样启动**R**：

```
$ LANGUAGE=en R 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T16:23:15.450

一般来说，在linux上，在命令行尝试

```
locale -a 
```

获取语​​言环境列表，也许你想要 en_US.utf8，然后

```
LC_ALL=en_US.utf8 R 
```

但通常最好选择“C”语言环境，这是普通的旧文本。

```
LC_ALL=C R 
```

在 R 会话中，`Sys.setlocale("LC_ALL", "en_US.utf8")`或来自`Sys.getlocale()`系统支持并从`locale -a`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-13T08:25:16.593

对我来说`R`：

```
Sys.setlocale("LC_MESSAGES", "C") 
```

Ubuntu 16.04
R 版本 3.4.3 (2017-11-30) -- “吃风筝的树”

对我来说`Sys.setenv(LANGUAGE='en')`也没有工作。

# ruby - 我们如何调试使用 Grape API 编写的 API？

> ID：12642654
> 
> 赞同：5
> 
> 时间：2012-09-28T15:09:44.210
> 
> 标签：ruby

我已经使用 Grape API 构建了我的 API，想知道如何调试它...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:43:56.340

您可以使用 Rack 或 Rails 为 Grape API 编写测试，这将帮助您验证输出是否符合您的预期。

[https://github.com/intridea/grape#writing-tests](https://github.com/intridea/grape#writing-tests)

我不确定它是否适用于 Sinatra/Grape，但你也可以添加[Simplecov](https://github.com/colszowka/simplecov)以确保你已经覆盖了你的基础。

如果您已经编写了测试但仍有问题，您能否提供有关您遇到的错误的更多详细信息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-15T06:18:30.777

1.安装 RubyMine 并转到“运行”->“编辑配置”。2.单击窗口左下角的加号并选择所需的配置。3\. 在顶部的“名称”文本框中命名您的配置并编辑您想要更改的任何默认设置。4\. 应用断点并使用调试器模式运行您的服务器。你已准备好出发 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-28T18:38:29.357

看看[racksh gem](https://github.com/sickill/racksh)。它允许你启动一个类似于`bundle exec rails console`Rails 的开发控制台。

# ruby-on-rails - Rails：全局关闭 ajax 格式的布局？

> ID：12642665
> 
> 赞同：3
> 
> 时间：2012-09-28T15:10:20.527
> 
> 标签：ruby-on-rails, ajax

在具有可以正常加载或从 ajax ( `jQuery.load()`) 加载的页面的应用程序中，如何正确设置 rails 格式？现在，我在每个操作中都使用以下代码：

```
def show
  respond_to do |format|
    format.html { render layout: !request.xhr? }
  end
end 
```

有没有办法让这个全局化，而不必在每个动作中都写出来？

**编辑**：

我尝试按照评论中的建议将其放入 an`after_filter`中，但这给了我一个错误`Render and/or redirect were called multiple times in this action.`

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T16:30:49.880

您可以在控制器顶部执行以下操作：

```
layout :set_layout

def set_layout
  request.xhr? ? false : 'your_layout' # layout is false for ajax requests
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-26T18:00:15.840

想必大家都知道吧。缺少“？” request.xhr? 之后的字符。尝试这个。

```
layout :set_layout

def set_layout
  request.xhr? ? false : 'your_layout'
end 
```

# c# - 如何使用 xpo (devexpress) 从数据库中获取数据？

> ID：12642668
> 
> 赞同：0
> 
> 时间：2012-09-28T15:10:21.197
> 
> 标签：c#, asp.net, devexpress, xpo

我是 devexpress 的新手，我遇到了一些困难。

我已经用 Visual Studio 创建了一个项目“.net empty c#”。我想用“devexpress xpo”连接我的数据库“mysql”。
我创建了一个“dxperience orm 数据模型向导”来连接我的数据库。最后，我有一个“connectionHelper.cs”（几乎没有静态方法）和一个以我的表名称命名的类。

但我不明白，如何使用 connectionHelper 在数据库中连接、读取、写入……？我阅读了 devexpress 的文档，但我没有相同的结果。

先感谢您

类连接助手：

```
using DevExpress.Xpo;
using DevExpress.Data.Filtering;
namespace ProduWebEmpty.produweb
{
    public static class ConnectionHelper
    {
        public const string ConnectionString = @"XpoProvider=MySql;server=localhost;user id=root; password=; database=web;persist security info=true;CharSet=utf8;";
        public static void Connect(DevExpress.Xpo.DB.AutoCreateOption autoCreateOption)
        {
            XpoDefault.DataLayer = XpoDefault.GetDataLayer(ConnectionString, autoCreateOption);
            XpoDefault.Session = null;
        }
        public static DevExpress.Xpo.DB.IDataStore GetConnectionProvider(DevExpress.Xpo.DB.AutoCreateOption autoCreateOption)
        {
            return XpoDefault.GetConnectionProvider(ConnectionString, autoCreateOption);
        }
        public static DevExpress.Xpo.DB.IDataStore GetConnectionProvider(DevExpress.Xpo.DB.AutoCreateOption autoCreateOption, out IDisposable[] objectsToDisposeOnDisconnect)
        {
            return XpoDefault.GetConnectionProvider(ConnectionString, autoCreateOption, out objectsToDisposeOnDisconnect);
        }
        public static IDataLayer GetDataLayer(DevExpress.Xpo.DB.AutoCreateOption autoCreateOption)
        {
            return XpoDefault.GetDataLayer(ConnectionString, autoCreateOption);
        }
    }
} 
```

authentification.cs 类（authentification 是我的表名进入我的数据库）

```
using DevExpress.Xpo;
using DevExpress.Data.Filtering;
namespace ProduWebEmpty.produweb
{
    public partial class authentification
    {
        public authentification(Session session) : base(session) { }
        public authentification() : base(Session.DefaultSession) { }
        public override void AfterConstruction() { base.AfterConstruction(); }
    }
} 
```

authentification.designer.cs 类：

```
using DevExpress.Xpo;
using DevExpress.Data.Filtering;
namespace ProduWebEmpty.produweb
{

    public partial class authentification : XPLiteObject
    {
        int fId;
        [Key(true)]
        public int Id
        {
            get { return fId; }
            set { SetPropertyValue<int>("Id", ref fId, value); }
        }
        string fPseudo;
        [Size(255)]
        public string Pseudo
        {
            get { return fPseudo; }
            set { SetPropertyValue<string>("Pseudo", ref fPseudo, value); }
        }
        string fMotDePasse;
        [Size(255)]
        public string MotDePasse
        {
            get { return fMotDePasse; }
            set { SetPropertyValue<string>("MotDePasse", ref fMotDePasse, value); }
        }
        string fEmail;
        [Size(255)]
        public string Email
        {
            get { return fEmail; }
            set { SetPropertyValue<string>("Email", ref fEmail, value); }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-05T14:50:24.460

**连接到您的数据库：**

```
IDataLayer db_layer = XpoDefault.GetDataLayer(new SqlConnection(@sqlCon_str),
    DevExpress.Xpo.DB.AutoCreateOption.DatabaseAndSchema);
    Session session =new Session(db_layer);

mypersistent record =new mypersistent(session){
property1="string property",
property2=123456
};
record.Save(); // save new record(line) to Database With Unique Oid 
```

**读书：**

```
//if you know the Unique_Oid so:
mypersistent record=session.FindObject<mypersistent>(CriteriaOperator.Parse("Oid = ?",Unique_Oid );

Console.WriteLine(string.Format("property1 = {0} , property2={1}",record.property1,record.property2)); 
```

**否则你可以阅读一个集合：**

```
XpCursor collection=new XpCursor(session,typeof(mypersistent),CriteriaOperator.Parse("property1 = '?'","string property");

foreach(mypersistent p in collection) { /* .... */ } 
```

**删除：**

```
//after getting record from database (above) 

record.Delete(); 
```

**更新**

```
//Update

record.property1="Hello";
record.Save(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T17:12:23.447

[您可以按照如何在 ASP.NET (Web) 应用程序](http://www.devexpress.com/Support/Center/Question/Details/K18061)知识库文章中使用 XPO 中列出的说明开始。

“示例”部分中提供的示例说明了主要的实际应用场景。

# html - 为什么这个按钮在 html 中没有正确对齐？

> ID：12642669
> 
> 赞同：0
> 
> 时间：2012-09-28T15:10:38.467
> 
> 标签：html, web

我有以下用于提交按钮的 html 片段：

```
<input style="height: 30px; width: 120px" type="submit" align="right" name="" value="Submit"> 
```

但它根本没有向右对齐（或者我想要的中间）。对齐标签似乎没有做任何事情，为什么会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:12:43.613

[元素](http://www.w3.org/TR/html5/the-input-element.html#the-input-element)没有`align` **属性**。_ 在想知道为什么标记不能按预期工作之前，您应该使用[验证器。](http://validator.w3.org/)[`input`](http://www.w3.org/TR/html5/the-input-element.html#the-input-element)

使用[CSS](http://www.w3.org/wiki/Web_Standards_Curriculum#CSS)进行演示。

您可能想[`text-align`](http://www.w3.org/wiki/CSS/Properties/text-align)在父元素上使用或[`float`](http://www.w3.org/wiki/CSS/Properties/float)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:13:23.720

HTML的`align`属性在很久以前就被弃用了。作为一种好的做法，所有样式都应该由 CSS 而不是 HTML 来完成，例如：

```
<input style="height: 30px; width: 120px; float: right" type="submit" name="" value="Submit"> 
```

甚至更好的做法 - 避免内联 CSS

```
<style>
input[type=submit] { height: 30px; width: 120px; float: right; }
</style>

<input type="submit" name="" value="Submit" /> 
```

# sql - 获取需要满足多个外部表条件的表行

> ID：12642674
> 
> 赞同：0
> 
> 时间：2012-09-28T15:10:57.223
> 
> 标签：sql, sql-server, foreign-keys

> **可能重复：**
> [如何选择多个连接表值符合选择条件的行？](https://stackoverflow.com/questions/4047314/how-to-select-rows-where-multiple-joined-table-values-meet-selection-criteria)

我有一个`Users`表，还有一个`Optons`表，其中包含每个用户的一些选项。每个用户可以选择多个选项。

这是表格的样子：

```
-- this is where user names are stored
create table Users 
(
    ID int, 
    UserName varchar(255)
)

-- this table contains options 
-- (one flag per row)
create table Options
(
    ID NOT NULL AUTO_INCREMENT int, 
    Flag int, 
    User_ID int // foreign key
) 
```

我想获得所有设置了两个特定选项的用户，但**前提**是它们都设置了。

例如，这将返回设置了任何选项的用户：

```
-- find all users with flags 1 and 2 set
select u.UserName from Users u 
    inner join Options o on o.User_ID = u.ID
    where o.Flag in (1, 2) 
```

如何让它返回表中有两个条目（用于标志 1 和 2）的所有用户`Options`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:13:10.880

您的查询几乎是正确的，但您需要计算记录的实例数，并且应该等于`where`子句中的参数数。

```
SELECT u.UserName 
FROM Users u 
     INNER JOIN Options o 
        ON o.User_ID = u.ID
WHERE o.Flag in (1, 2)
GROUP BY u.UserName 
HAVING COUNT(o.Flag) = 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:30:17.377

只是把它扔在那里：

```
SELECT DISTINCT u.UserName 
FROM Users u 
JOIN Options o ON u.User_ID = o.ID AND o.Flag=1
JOIN Options p ON u.User_ID = p.ID AND p.Flag=2 
```

# html - 为什么非 ie 浏览器使用 !important 读取 IE 条件？

> ID：12642675
> 
> 赞同：-3
> 
> 时间：2012-09-28T15:11:00.047
> 
> 标签：html, css, internet-explorer, cross-browser

当使用带有 !important 的 IE 条件（例如下面的代码）时，无论浏览器如何，背景都默认为带有 !important**的背景色，****即使在 IE 条件**中也是如此。

如何重写此代码，以便浏览器接受小于 IE9 的背景颜色和 IE9 和其他浏览器中的图像（高度/宽度：100%，无重复）？

注意：我计划在默认情况下**主题自动设置颜色或图像**的 Wordpress 站点中使用它，因此我必须使用 !important 来覆盖默认主题样式。

```
body {
<!--[if lt IE 9]>
background-color:#c1beb2 !important;
background:#c1beb2 !important;
<![endif]-->
<!--[if gte IE 9]>
background-image: url("http://example.com/wp-content/example.png") !important;
background-position:left bottom;
background-size: 100% 100%;
background-repeat: no-repeat;
<![endif]-->
<![if !IE]>
background-image: url("http://example.com/wp-content/example.png") !important;
background-position:left bottom;
background-size: 100% 100%;
background-repeat: no-repeat;
<![endif]>
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T15:14:32.487

条件注释用于 HTML，而不是 CSS。

也就是说，在您的 HTML 中链接到 IE 特定样式表，如下所示：

```
<!--[if lte IE 9]> 
<link rel="stylesheet" href="/ie.css" type="text/css" media="no title" charset="utf-8" />
<![endif]--> 
```

这是正确的方法。如果您不想创建一个完整的其他 IE 特定样式表，您可以依赖[CSS IE Hacks](http://www.webdevout.net/css-hacks#in_css)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:18:14.527

好的，等一下。据我所知，这些（！）浏览器开关在 css 中不起作用。因此，您需要像这样在 html 中进行切换部分：

```
<!--[if lt IE 9]>
  <link rel="stylesheet" type="text/css" href="IE9.css">
<![endif]-->
<!--[if gte IE 9]>
  <link rel="stylesheet" type="text/css" href="IEgte9.css">
<![endif]--> 
```

然而，这是一种糟糕的风格。通常，您不希望浏览器具有单独的样式。在极少数情况下，您也需要。检查 html5 样板以获取有关此的一些信息。

# linux - Shell 脚本在执行时不执行任何操作

> ID：12642677
> 
> 赞同：0
> 
> 时间：2012-09-28T15:11:03.580
> 
> 标签：linux, bash, shell, unix, aix

我真的是 shell 脚本的新手，我不确定我的代码有什么问题。基本上，我的代码读取文本文件以获取电子邮件地址、目录位置并将其保存在数组中。如果文件系统超出磁盘使用量，它将发送通知电子邮件并将日志文件移动到备份文件夹。但是它什么也没做，有人可以告诉我为什么它不起作用吗？提前致谢

```
#!/bin/sh
counter=0
logloc=/home/temp/ServerLogs
backup=/home/work/test
## Reads the location of the file systems that needs to be investigated from location.txt
## and save it into an array
while read -r line; do
   Unix_Array[${counter}]=$line;
   let counter=counter+1;
done < location.txt
## Reads Email recipients and save it into an array
num=0
while read -r line; do
    Email_list[${num}]=$line;
    let num=num+1;
done < email.txt
## Checking one file system per loop
for ((i=0;i > counter; i++))
    do
    deletestatus=false;
    ## usage returns how much the file system is full. Ex. 50% => 50
    usage=$(df -P ${Unix_Array[$i]} | grep ${Unix_Array[$i]} | awk '{ print $5}' | sed 's/%//g')
    #if usage is greater than 80%, send email
    if [$usage -gt 80];
        then
        for ((j=0;j > num; j++))
        do
            echo ${Unix_Array[$i]} " is " $usage "% full, the logs that are 7 days older has been removed" |  mail - s "Log notification" ${Email_list[$j]} 
        done
        deletestatus=true;
    elif [$usage -gt 50];
        then
        ## if free space is greater 50 and less than 80, it will not send email
        deletestatus=true;
    else
        ## Safety net
        deletestatus=false;
    fi
    if [$deletestatus];
            then
        ##Moving Files that are older than 7 days
        $(find /home/songja/ServerLogs -type f -name 'SystemOut_*' -mtime +2 -exec mv {} /home/songja/test \;)
        ## Deleting files that are older than 7 days
        $(find . $logloc . - name 'SystemOut_*' -mtime +2 -delete)
     fi
done 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:17:34.910

```
for ((i=0;i > counter; i++)) 
```

那永远不会循环。`i<counter`有更好的机会。另一个`for`循环也一样。

除此之外，循环内的测试需要空格。

```
if [ $foo -gt 42 ] ; 
#   ^  important 
```

# c# - 在 Word 2007 中重新创建控件时出现错误代码 800A1066

> ID：12642680
> 
> 赞同：0
> 
> 时间：2012-09-28T15:11:09.547
> 
> 标签：c#, vsto, word-2007

我正在使用 .dotm 文件开发 Word 2007 文档级加载项。它是一个文档，主要由文档窗格上的按钮控制，用于创建和销毁文档的某些部分。创建的一些东西是内容控件。

一个这样的按钮是一个切换按钮，它需要删除并重新添加大约 10 个字符和一个内容控件。我的问题是，每当我尝试重新创建内容控件时，Word 都会引发 COMException，并显示消息“命令失败”和错误代码 -2146824090（或 0x800a1066）。

谷歌搜索此错误代码表明这是与使用`Open`或`SaveAs`方法与 Word 文档或网络驱动器上的文档交互相关的安全相关异常（请参阅[此处](http://www.adras.com/Urgent-help-needed-opening-word-document-from-asp.t4537-105.html)、[此处](http://social.msdn.microsoft.com/Forums/en-HK/worddev/thread/a6b1cfc2-1de0-46e0-ae9b-b91acb158ffe)和[此处](http://forums.asp.net/t/1481428.aspx/1)的帖子）。这根本不适合我正在做的事情。

这是我用来删除控件的代码：

```
LevelControl.LockContentControl = false;
LevelControl.Delete(true);
LevelControl = null; // probably not needed 
```

这是娱乐代码：

```
DropDownListContentControl LevelControl = this.Controls.AddDropDownListContentControl(r, "SectionLevel"); 
```

这是我最初用于创建控件的同一行代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:11:09.547

我的问题的原因是放错了范围对象。我无意中将范围放在另一个内容控件中，该控件仍然包含占位符文本。不幸的是，错误消息没有说明这一点。

要确定您是否犯了同样的错误，请尝试`r.Select()`在最后调用而不是任何可能导致此异常的操作，并查看光标所在的位置。请确保执行此操作时文档不限于在字段中编辑 ( `Review>Protect Document>Restrict Editing and Formatting`)，否则它可能会在您看到之前自动移动到文档的开头或内容控件。

# .net - .NET 模块不处理非 aspx 请求

> ID：12642686
> 
> 赞同：1
> 
> 时间：2012-09-28T15:11:33.337
> 
> 标签：.net, iis-7, web-config

我有一个问题我一直在努力解决一段时间。我有一个用于自定义重定向的模块。这个想法是，如果用户发出请求并获得 404，则通过我的模块处理错误，在数据库表中进行查找，如果找到请求的 URL 的重定向，则重定向用户。

问题是这不适用于不以 .aspx 结尾的请求。我在集成模式下运行应用程序，我认为在集成模式下所有请求都通过管道并由模块处理。

真正奇怪的是，我的模块的 BeginRequest 函数确实会针对这些请求（以及 global.asax 中的相应函数）被触发，但错误函数不会被触发。

在我的 web.config 文件中，我将 runAllManagedModulesForAllRequests 设置为 true。我的 .NET 版本是 4.0，我的 IIS 版本是 7.0。

# php - 在zend框架中使用yaml

> ID：12642687
> 
> 赞同：0
> 
> 时间：2012-09-28T15:11:36.020
> 
> 标签：php, zend-framework, yaml

我希望在 zend 框架内为静态对象创建自己的 yaml 文件。我不想替换 application.ini 文件。

我在 configs 中添加了以下文件

应用程序/reports.yaml

```
reportInfo:
  team_a:
    some_var: some_var
    some_var_1: some_var1
  team_b:
    some_var: some_var
    some_var_1: some_var1 
```

如何在索引控制器中获取 reportInfo 的值？

```
$reportInfo = Zend_Get_YAML ('configs/reports.yaml') // or something similar this is a guess
print_r($reportInfo); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:57:55.387

你试过什么？

您可以使用[Zend_Config_Yaml](http://framework.zend.com/manual/1.12/en/zend.config.adapters.yaml.html)或 sfYaml::dump 或[新的 yaml 组件来完成](http://symfony.com/doc/2.0/components/yaml.html)

在你的控制器中试试这个：

```
$config = Zend_Config_Yaml::decode(file_get_contents(
    APPLICATION_PATH . '/configs/reports.yaml',
));
print_r($config); 
```

# objective-c - HTTP POST 目标 C

> ID：12642688
> 
> 赞同：1
> 
> 时间：2012-09-28T15:11:37.657
> 
> 标签：objective-c, web-services, curl

我正在尝试通过 http 发帖但没有成功这是我的代码

```
NSError *error;
NSHTTPURLResponse *response;

NSData *posting =
[NSJSONSerialization dataWithJSONObject:[input createJsonDictionary]
                                options:0
                                  error:&error];
NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@", kURL]];
NSMutableURLRequest *urlRequest = [NSMutableURLRequest requestWithURL:url];

[urlRequest setHTTPMethod:@"POST"];
[urlRequest setValue:@"application/json"
  forHTTPHeaderField:@"Content-Type"];
[urlRequest setValue:[NSString stringWithFormat:@"AuthToken %@",token]
  forHTTPHeaderField:@"Authorization"];
[urlRequest setHTTPBody:posting];

NSData *urlResponse =
[NSData dataWithData:[NSURLConnection sendSynchronousRequest:urlRequest
                                           returningResponse:&response error:&error]];
NSDictionary *jsonDictionary =
[NSJSONSerialization JSONObjectWithData:urlResponse
                                options:0
                                  error:&error];

NSLog(@"status code: %i", [response statusCode]);

NSLog(@"URL: %@", [urlRequest URL]);
NSLog(@"header: %@ \n method: %@", [urlRequest allHTTPHeaderFields], [urlRequest HTTPMethod]);
NSLog(@"body: %@\n", [[NSString alloc] initWithData:[urlRequest HTTPBody] encoding:NSUTF8StringEncoding]); 
```

在 NSLog 我得到状态码 500，有一个错误。但是当我尝试使用 cURL 执行相同的命令时

```
curl --request POST -H "Content-Type: application/json" 
-H "Authorization: AuthToken TOKEN" --data '{"DATA"}' -sL 
-w "\\n%{http_code} %{url_effective}\\n" https://URL.com 
```

我返回状态码 201，成功。我的代码似乎有些不对劲。同样在 urlRequest 的 NSLogs 中，它们等于 curl 命令中的内容。有什么我做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:48:19.187

代替

```
NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@", kURL]]; 
```

尝试

```
NSString *urlText = [NSString stringWithFormat:@"%@", kURL];
urlText = [urlText stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];
NSURL *url = [NSURL URLWithString:urlText]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T14:14:59.057

找到了我自己的答案。问题是我的代码正在同步调用服务器，而服务器没有设置为进行同步 Web 调用。相反，我必须使用 NSURLConnection 的即时变量并异步调用“sendAsynchronousRequest:queue:completionHandler:”，并使用方法 start/cancel 和即时变量。

# go - golang TLS 是否支持 IE8？

> ID：12642689
> 
> 赞同：5
> 
> 时间：2012-09-28T15:11:39.330
> 
> 标签：go

最新的 Chrome/IE9/Firefox 一切正常。IE8 抱怨该页面无法显示，并且看起来连接已中止。这是快速测试代码。

```
package main

import (
    "time"
    "fmt"
    "net/http"
)

type Handler struct {
}

func (this *Handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Hello, %q", r.URL.Path)
}

func main() {
    handler := &Handler{}
    ss := &http.Server{
        Addr: ":443",
        Handler: handler,
        ReadTimeout: 10 * time.Second,
        WriteTimeout: 10 * time.Second,
        MaxHeaderBytes: 1 << 20,
    }
    ss.ListenAndServeTLS("cert.pem", "key.pem")
} 
```

请注意，“cert.pem”和“key.pem”是由“crypto/tls/generate_cert.go”生成的。我尝试了一个真正的证书，它也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:19:17.933

TLS 是一个*标准，*所以没有“IE8 的 TLS”之类的东西。

我想问题是 IE8 不信任您的（据说是自签名的）证书。所以我认为你可以在 SO 上的[这个帖子](https://stackoverflow.com/q/681695/720999)中找到答案。

您也可以拥有正确签名的证书，但运行此 IE8 实例的计算机上的证书存储没有导入您的 CA 的证书（或证书的整个信任链，如果您的证书已由从属 CA 签名）导入并因此受信任. 在这种情况下，您应该这样做——获取您的 CA（或整个 CA 链，如果有）的证书并将其导入客户端计算机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T15:49:10.410

*由于 OP 没有给出正确的答案，因此从问题中移出*

这个问题可以通过这个补丁解决，“0001-Allow-SSLv2-compatible-client-hello-so-SSLv2-compati.patch”，问题[http://code.google.com/p/go/issues/detail ?id=3930](http://code.google.com/p/go/issues/detail?id=3930)。

但是，此修订版[http://code.google.com/p/go/source/detail?r=8048fe8f6f4b](http://code.google.com/p/go/source/detail?r=8048fe8f6f4b)并没有解决问题。

# google-api - 页面加载后初始化 Google 地球插件会导致页面为空

> ID：12642699
> 
> 赞同：0
> 
> 时间：2012-09-28T15:12:24.293
> 
> 标签：google-api, google-earth-plugin, google-loader

我正在构建一个依赖于 Google Earth 插件的页面。该页面是使用 require.js 和主干构建的。我想在页面的给定部分被导航到时初始化谷歌地球插件（例如触发特定的主干路由）。

但是，如果在页面加载后（通过`google.load('earth', '1');`）初始化 google earth 插件，则页面内容将替换为生成的脚本标记 - 例如：

```
<script src="https://www.google.com/uds/?file=earth&amp;v=1" type="text/javascript"></script>
<script src="https://www.google.com/uds/api/earth/1.1/109c7b2bae7fe6cc34ea875176165d81/default.I.js" type="text/javascript"></script> 
```

页面消失。

有没有办法在页面加载后初始化插件，还是我需要求助于 HEAD 中的一些代码来初始化东西，然后只`google.earth.createInstance`在我准备好显示它时调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:29:41.463

就在发布之后，我终于在[这里](https://stackoverflow.com/questions/6978242/how-to-load-googles-custom-search-enginecse-js-apis-after-page-loads#answer-7015191)找到了答案：

```
google.load(
    'earth',
    '1',
    {
        'callback': function()
        {
            // what was in the google.setOnLoadCallback 
            // in the GE plugin examples 
        }
    }
); 
```

（假设您已经包含了`<script>`指向[https://www.google.com/jsapi](https://www.google.com/jsapi)的标签）。传入回调作为第三个参数的一部分，`google.load`显然阻止它将脚本标签写入您的文档并覆盖那里的任何其他内容！

# c# - 如何最小化 DataGridView 中的一组行以减少它们占用的空间？

> ID：12642700
> 
> 赞同：0
> 
> 时间：2012-09-28T15:12:24.790
> 
> 标签：c#, datagrid, datagridview, grouping

我的问题`DataGridView`在于有很多重复或非常相似的数据，一旦开始有数百行，它就会变得非常笨拙。

我四处寻找一些允许分组的自定义控件，但我发现这些控件要么花钱，要么太旧，要么太复杂而不能保证为这件事切换，或者不能与我现有的代码库一起使用（不兼容的类型等）

最好我能用常规的`DataGridView`. 我想要一个菜单​​项按钮，单击该按钮时，会获取选定的行并将它们变成一行（同时保留数据并提供某种行被压缩的视觉提示）。再次单击时，该行将被恢复。

有谁知道一个优雅的方式来完成这个？我想我可以拥有一`List`组`DataGridViewRow`s 和一些保存相应索引的方法或类似的东西，但我想知道是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:39:57.333

由于您不想使用 3rd 方控件或自定义控件，因此穷人的解决方案很简单。

假设您的数据如下所示：

```
public class CustomData
{
    public int Id { get; set; }
    public string Type { get; set; }
    public string Name { get; set; }
} 
```

您可能向用户显示的内容可能是这样的：

```
List<CustomData> data = new List<CustomData>()
                                        {
                                            new CustomData { Id = 1, Name = "Test", Type = "Group1"},
                                            new CustomData { Id = 2, Name = "Test", Type = "Group1"},
                                            new CustomData { Id = 3, Name = "Test", Type = "Group1"},
                                            new CustomData { Id = 4, Name = "Test", Type = "Group2"},
                                            new CustomData { Id = 5, Name = "Test", Type = "Group2"},
                                            new CustomData { Id = 6, Name = "Test", Type = "Group2"},
                                            new CustomData { Id = 7, Name = "Test", Type = "Group3"},
                                            new CustomData { Id = 8, Name = "Test", Type = "Group3"},
                                            new CustomData { Id = 9, Name = "Test", Type = "Group3"},
                                        };
var dataDisplayedToUser = data.GroupBy(g => g.Type).Select(p => p.Key); 
```

在这种情况下将是：

```
Group1
Group2
Group3 
```

当用户想要双击网格中的一行时，您可以向他们展示另一个具有以下数据子集的模态数据网格。

```
string dataValue = theGroupTheUserSelected // from your grid
var specificData = data.Where(f => f.Type == theGroupTheUserSelected); 
```

您最终会向用户显示更少的数据，这更容易理解并且更容易理解。

# mysql - 用另一个查询结果更新行

> ID：12642702
> 
> 赞同：3
> 
> 时间：2012-09-28T15:12:32.287
> 
> 标签：mysql

假设我有一个这样设置的数据库，我想通过将优先级更改为最后一个数字 + 1 来将 Milk 移动到最后。

```
编号 | 项目 | 优先
---|--------|----------   
[...]
26 | 牛奶 | 1
27 | 鸡蛋 | 2
28 | 火腿 | 3

```

所以我需要运行这样的东西

```
UPDATE shopping SET priority = (SELECT priority FROM shopping ORDER BY priority DESC LIMIT 1) + 1 WHERE id = '26' 
```

最后得到这样的东西

```
编号 | 项目 | 优先
---|--------|----------   
[...]
27 | 鸡蛋 | 2
28 | 火腿 | 3
26 | 牛奶 | 4

```

*我该如何正确地*做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:35:14.670

```
UPDATE `shopping` s, (
    SELECT
        MAX(`priority`) AS 'maxPriority',
        MAX(`id`) AS 'maxId'
    FROM `shopping`
) t
SET
    s.`priority` = t.`maxPriority` + 1,
    s.`id` = t.`maxId` + 1
WHERE s.`id`=26
AND s.`priority` != t.`maxPriority`
# this ensures that it's not the one that's
# already holding the max priority 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:40:50.833

您的要求可能是：

```
UPDATE shopping SET priority = (select max(priority)+1) where id=26; 
```

但这不起作用，您必须在此处对请求、来源和详细信息进行相同的更改：

[http://the-stickman.com/uncategorized/mysql-update-with-select-on-the-same-table-in-the-same-query/](http://the-stickman.com/uncategorized/mysql-update-with-select-on-the-same-table-in-the-same-query/)

# plsql - PLSQL 命令插入到 select from 给出唯一约束错误

> ID：12642703
> 
> 赞同：1
> 
> 时间：2012-09-28T15:12:32.297
> 
> 标签：plsql

我是 plsql 的新手，这个命令搞砸了一些事情：

```
insert into coffee_tea_join_table 
select coffee_id, 16 
from coffee_tea_join_table 
where tea_id = 6; 
```

这会返回一个

> “原因：java.sql.SQLException：ORA-00001：违反唯一约束”错误。

coffee_tea_join_table 只有两列，coffee_id 和一个 tea_id。

看起来该语句想要再次插入来自它选择的同一个表的内容。我猜它会查找对应tea_id = 6 的coffee_id 表，但为什么那里有'16' 静态值？没有“16”列...

如果它找到了一个tea_id = 6 的coffee_id，那么为什么将它再次插入同一个表中是有意义的呢？也许这就是违反约束的原因？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T18:44:35.327

首先，在检查查询提取了多少记录之后，我建议查看表的唯一索引和主键。我希望你只得到 1 条记录。如果很多 - 考虑触发器。可能其中一些会覆盖您的 16（例如，从错误的顺序）。无论如何，请向我们提供带有触发器的表的 ddl。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T15:05:45.413

如果我们首先假设表 coffee_tea_join_table 有两列 coffee_id 和 tea_id，并且该表对这两个表有一个组合唯一约束。SQL 正在创建一条tea_id = 16 和 cofee_id 的新记录，与 tea_id = 6 的记录相同。然后，​​由于您已经有一条 tea_id = 16 和 cofee_id = 相同的 cofee_id 值的记录，导致此错误作为 tea_id = 6 的记录。

如果这对您没有帮助，那么您需要挖掘表定义，包括表的唯一约束。

# android - Android：有没有办法以编程方式获取已定义字符串数组的名称值？

> ID：12642704
> 
> 赞同：2
> 
> 时间：2012-09-28T15:12:34.320
> 
> 标签：android, android-xml, arrays

我有一个 arrays.xml 文件，其中包含很多字符串数组元素，可在我的应用程序中与 Spinners 一起使用。我需要通过 Web 服务调用为每个选择发送一个特定的值。Web 服务获取描述所代表的数据库值，而不是描述本身，所以我这样设置字符串数组：

```
<string-array name="collection_method">
    <item name="blank"></item>
    <item name="P">Prepaid</item>
    <item name="C">Collect</item>
    <item name="T">Third Party</item>
    <item name="D">Cash On Delivery</item>
</string-array> 
```

我的问题是：有没有办法以编程方式获取字符串数组元素的名称值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:33:59.527

如果我使用 Spinner 正确理解，您可以绑定 2 个数组，一个用于条目，一个用于值，这个类似的问题描述了此方法及其替代方法：

[Android - 将 Spinner 配置为使用数组](https://stackoverflow.com/questions/1587028/android-configure-spinner-to-use-array)

编辑：再次查看链接的问题是不对的，但是您仍然可以使用双数组，您只需要获取微调器的选定索引并使用以下命令查找另一个数组中的值：-

```
String value = getResources().getStringArray(R.id.value_array)[selectedIndex]; 
```

# java - 如何从头开始为捆绑包使用 org.apache.felix.scr 注释？

> ID：12642706
> 
> 赞同：3
> 
> 时间：2012-09-28T15:12:35.853
> 
> 标签：java, maven, osgi, apache-felix, bnd

我已经开始为 apache felix 开发一个包，并使用 ops4j pax 插件进行了开发。

我已经创建了项目结构，`pax-create-project`并在其中做了正常的`pax-create-bundle`. 然后，您将获得使用 maven 构建整个事物的初始项目结构。这里重要的部分是，你的包有它自己的 pom( `bundlename/pom.xml`) 和 bnd 文件( `bundlename/osgi.bnd`)，但是配置`maven-bundle-plugin`已经在`poms/compiled/pom.xml`. 捆绑元数据配置在下，`poms/compiled/pom.xml`但标准激活器配置在上述`osgi.bnd`文件下。bnd 文件中的默认值为`Bundle-Activator: ${bundle.namespace}.internal.ExampleActivator`.

现在我想开始使用注释，`org.apache.felix.scr`所以我将它包含在依赖项下的捆绑包自己的 pom 中：

```
<dependency>
  <groupId>org.apache.felix</groupId>
  <artifactId>org.apache.felix.scr</artifactId>
  <version>1.6.0</version>
</dependency> 
```

我为服务创建了我的界面：

```
package namespace;

public interface Sample {
  void sayHello();
} 
```

以及带有以下注释的实现`org.apache.felix.scr`：

```
package namespace.internal;

import org.apache.felix.scr.annotations.Activate;
import org.apache.felix.scr.annotations.Component;
import org.apache.felix.scr.annotations.Deactivate;
import namespace.Sample;

@Component
@Service
public class SampleImpl implements Sample{

  @Activate
  void start(){
    System.out.println("Started SampleImpl.");
  }

  @Deactivate
  void stop(){
    System.out.println("Stopped SampleImpl.");
  }

  @Override
  public void sayHello() {
    System.out.println("Hello!");
  }
} 
```

`osgi.bnd`为了启动组件，我需要在文件中放置什么？我不得不删除上面提到的默认条目，因为我不再使用 BundleActivator。

现在问题来了：我需要对上述任何文件做什么才能`mvn clean install pax:provision`启动一个 felix 环境来启动我的包并让我看到*任何*打印输出？我已经查看了我正在启动的 Apache 日志服务的日志输出，它只是告诉我：

```
2012.09.28 16:52:44 INFO - Bundle: namespace - BundleEvent STARTED
2012.09.28 16:52:44 INFO - Bundle: namespace - BundleEvent RESOLVED 
```

任何提示都非常感谢。或者链接，我已经搜索了几个小时来找到一个完整的指南来使用 scr 和捆绑的 maven 插件。

问候，谢尔斯基

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T11:11:10.247

这是我对这个主题的 coderwall 文章的修改：http: [//coderwall.com/p/q39uxq](http://coderwall.com/p/q39uxq "http://coderwall.com/kjellski")

首先从 poms/compiled/pom.xml 中配置子模块的通用编译配置。在 maven-bundle-plugin 已经存在的地方添加插件：

```
<plugin>
    <groupId>org.apache.felix</groupId>
    <artifactId>maven-scr-plugin</artifactId>
    <version><timeofwriting:1.8.0></version>
    <executions>
        <execution>
            <id>generate-scr-scrdescriptor</id>
            <goals>
                <goal>scr</goal>
            </goals>
        </execution>
    </executions>
</plugin> 
```

在同一个文件中，在 poms/compiled/pom.xml 下，查看 maven-bundle-plugin 的说明并在 <_include> 语句下添加：

```
<Service-Component>
    OSGI-INF/serviceComponents.xml
</Service-Component> 
```

现在依赖子项目中的注释来使用它们：

```
<dependency>
    <groupId>org.apache.felix</groupId>
    <artifactId>org.apache.felix.scr</artifactId>
    <version><timeofwriting:1.6.0></version>
</dependency>
<dependency>
    <groupId>org.apache.felix</groupId>
    <artifactId>
        org.apache.felix.scr.annotations
    </artifactId>
    <version><timeofwriting:1.7.0></version>
</dependency> 
```

现在用注解*@Component*和*@Service*定义你的**组件**。当您不希望包含任何内容时，就像在任何 api 包中一样，只需在 osgi.bnd 文件中插入“Service-Component: *”。这将导致捆绑插件停止抱怨不包含任何项目的缺少 OSGI.INF。

 **希望这可以帮助某人；）

干杯，凯尔斯基**

# python - 使用 mod_fcgid 编写 Python Web 应用程序的简单解决方案？

> ID：12642707
> 
> 赞同：1
> 
> 时间：2012-09-28T15:12:36.760
> 
> 标签：python, mod-fcgid

在具有 mod_fcgid（不是 mod_wsgi）的共享 Apache 服务器上，我想用 Python 而不是 PHP 编写简单的 Web 应用程序。

我做了很多阅读和测试，但由于共享服务器的限制（“pip：找不到命令”，“[me]不在sudoers文件中”，“easy_install [app]：无法打开 /usr/local/include/python2.6/pyconfig.h”等）

mod_fcgid 不是在共享服务器上编写 Python 应用程序的正确解决方案，所以我浪费了我的时间，应该从一开始就转移到支持 Python 的主机上吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:42:47.950

[`sys.path`Python 可以使用它在/中找到的任何包/模块`$PYTHONPATH`。](http://docs.python.org/tutorial/modules.html#the-module-search-path)只需安装到备用位置并确保在其中指定它。

# php - include('file.php') 和 include 'file.php' 有什么区别

> ID：12642709
> 
> 赞同：4
> 
> 时间：2012-09-28T15:12:38.103
> 
> 标签：php, syntax

两者都`include('file.php')`工作`include 'file.php'`并且似乎可以互换。

有谁知道这两种语法之间是否有任何区别？表现？在特定版本中引入？

我知道如果你要写`include $_SERVER['DOCUMENT_ROOT'] . '/file.php';`它可能看起来更清晰`include($_SERVER['DOCUMENT_ROOT'] . '/file.php');`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:13:52.847

没有区别。这些是“语言结构”。从语法上讲，这意味着它们可以带或不带大括号使用。一个例子是`echo`声明。

`echo("hello");`并且`echo "hello";`是相同的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:13:27.247

没有区别，因为`include`它是一种不需要括号的语言结构，就像`echo`.

另请参阅：[包括](http://sg.php.net/manual/en/function.include.php#example-139)- 向上滚动一点

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:22:24.163

# windows - 批处理脚本变量中的转义引号

> ID：12642712
> 
> 赞同：3
> 
> 时间：2012-09-28T15:12:44.977
> 
> 标签：windows, escaping, batch-file

如何转义变量中的引号以与另一个变量进行比较。

示例：脚本输出““test.exe”的输出正常”（不带引号）

在批处理脚本中，我将输出保存在批处理脚本的变量中，然后想与保存的变量进行比较。

```
set ouputTest1 = "The output of "test.exe" is OK"

test.exe -p 75 > temp.txt
set /p TESTOUTPUT=< temp.txt
if %TESTOUTPUT% == %ouputTest1% 
```

问题在于 outputTest1 变量和字符串中的引号。我尝试使用这样的双引号：

```
set ouputTest1 = "The output of ""test.exe"" is OK" 
```

但没有运气。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T19:03:30.320

您的代码存在三个问题：

## 问题 1：

脚本行，`set ouputTest1 = "The output of "test.exe" is OK"`不创建名为`outputTest1`;的变量 相反，它创建了一个名为`outputTest1<space>`. 这就是为什么`%outputTest1%`总是空的原因。

## 问题2：

在“set”语句中，等号之后的*所有内容都被赋值——包括空格和外引号。*在您的情况下，变量的内容最终是`<space>"The output of "test.exe" is OK"`.

## 问题 3：

最后，您需要更改 IF 比较。正确的做法如下：

```
set "ouputTest1=The output of "test.exe" is OK"

test.exe -p 75 > temp.txt
set /p TESTOUTPUT=< temp.txt
if "%TESTOUTPUT%" == "%ouputTest1%" echo Equal 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T16:32:23.750

使用延迟扩展似乎可以解决这个问题，无论是否带有引号（`c`并且`d`未引用）：

```
@echo off
setlocal disabledelayedexpansion

set a="The output of "test.exe" is OK"
set b="The output of "test.exe" is OK"

set "c=The output of "test.exe" is NOT OK"
set "d=The output of "test.exe" is NOT OK"

setlocal enabledelayedexpansion
if !a!==!b! echo a and b match!
if !c!==!d! echo c and d match!

endlocal 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T18:24:31.197

wmz 提出的答案似乎是一个可靠的答案，但我认为我仍然可以提供这种替代方案，以供考虑。

为了比较，您可以将比较字符串写入另一个文件并比较文件，而不是将输出（即您的 temp.txt）读入变量中。类似于以下内容：

```
echo The output of "test.exe" is OK>temp-expected.txt
fc temp.txt temp.expected.txt >NUL
if "%ERRORLEVEL%"=="0" ( echo YAY ) else ( echo BOO ) 
```

# ios - 将多个移动应用程序与一个 Facebook 页面关联

> ID：12642714
> 
> 赞同：0
> 
> 时间：2012-09-28T15:12:52.107
> 
> 标签：ios, facebook

当您在 facebook 中创建移动应用程序时，它允许您将其与 facebook 页面相关联。我希望能够将我所有的移动应用程序与一个 Facebook 页面相关联。乍一看，这似乎是不可能的。是否每个人都为每个移动应用程序创建一个新的 Facebook 页面，或者有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T15:10:38.840

不，每个应用 ID 有一个“应用页面” - 无法让单个应用页面代表多个应用。

# timeout - 如何区分期望脚本正常返回还是超时

> ID：12642716
> 
> 赞同：0
> 
> 时间：2012-09-28T15:12:55.943
> 
> 标签：timeout, return-value, expect

我有以下可能会正常返回或超时返回的期望命令。有没有办法区分这两种情况？

```
/usr/bin/expect -c 'expect "\n" {set timeout 60; eval spawn ./bin/stop.sh; interact }' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T10:19:43.620

您可以预期关键字“超时”和“eof”表示返回的衍生进程，例如。期望 { 超时 {action} eof {other action} }

# java - 如何对链表进行排序 ?

> ID：12642720
> 
> 赞同：5
> 
> 时间：2012-09-28T15:13:15.100
> 
> 标签：java, sorting, linked-list, comparable

我需要按字符串的长度对 LinkedList 的字符串进行排序，但希望保持相同长度字符串的顺序（未按字典顺序排序）。

样本输入：

```
this
is
just
a
test 
```

样本输出：

```
a
is
this
just
test 
```

我正在尝试使用 a`Comparable<LinkedList<String>>`和 a`compareTo`方法来做到这一点，但我没有得到正确的输出（我的仍然按字典顺序排序）

```
public class Q3_sorting implements Comparable<LinkedList<String>> {
    Scanner keyboardScanner = null;
    LinkedList<String> fileList = new LinkedList<String>(); 
```

// [...] 这里有一些代码

```
public int compareTo(LinkedList<String> o) {
        // TODO Auto-generated method stub
        o = fileList;

        for (int i = 0; i < fileList.size() -1; i++) {
            if (fileList.get(i).length() == o.get(i+1).length()) {
                return 0;
            }
            if (fileList.get(i).length() > o.get(i+1).length()) {
                return -1;
            }
            if (fileList.get(i).length() < o.get(i+1).length()) {
                return 1;
            }

        } 
```

然后
`Q3_sorting sort = new Q3_sorting(args);`
`Collections.sort(sort.fileList);` 我在我的主要方法中使用。然后我把清单打印出来......

但我得到这个作为输出：

```
a
is
just
test
this 
```

我将如何纠正这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T15:18:18.890

您应该创建一个比较器：

```
public class Q3_sorting implements Comparator<String> {
public int compare(String a, String b) {
 return a.length() - b.length();
} 
```

然后用方法排序：

```
Collections.sort(list, new Q3_sorting()); 
```

请注意，您要做的是对列表中的字符串进行排序。通过实现 List 的比较器（或可比较的，因为它在这里工作的目的相同），您告诉 JVM 是您想要比较不同的 List。

您也可以通过在类中实现一个 Comparable 来实现您的目标以进行排序，但只要 String 是最终的，您就不能这样做，因此您不能扩展。因此，除了实现比较器之外别无他法，这也更简单:)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T15:17:56.883

使用`Collections.sort(list, comparator)`过载。你需要一个`Comparator<String>`不是一个`Comparator<LinkedList<String>>`。请注意， Collections.sort 的 javadoc 保证了稳定的排序（保持相等字符串的顺序，根据您的比较器相等均值相等）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T15:20:17.317

您正在排序字符串，而不是字符串列表。为此，您需要定义 a`Comparator<String>`以按长度比较两个字符串，如下所示：

```
public class ByLength implements Comparator<String> {
  @Override
  public int compare(String a, String b) {
    return a.length() - b.length();
  }
} 
```

然后，要对列表进行排序，您需要调用：

```
Collections.sort(sort.fileList, new ByLength()); 
```

另请注意，排序 a`LinkedList`效率非常低，您应该使用 a`ArrayList`代替。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-28T15:17:56.177

不幸的是，字符串没有一个属性来表示它们在链表中的位置。因此，您需要创建一个自定义数据对象来跟踪该信息。要么为链表编写你自己的自定义排序方法，然后调用它而不是 Collections.sort()。

# javascript - iOS6 - 有没有办法清除添加到主屏幕的 webapp 的缓存 ajax POST 请求？

> ID：12642726
> 
> 赞同：9
> 
> 时间：2012-09-28T15:13:27.030
> 
> 标签：javascript, jquery, ajax, ios6

iOS6 ajax POST 请求缓存正在成为我们 webApp 的一个大问题。我们的大多数用户都已将应用程序添加到主屏幕。自从升级以来，大多数对后端的 POST 请求都无法正常工作，并且 6 天前的数据已经过时并且还在增加。我们知道解决此问题的两种解决方法，一种是通过添加时间戳或一些随机输入来更改每个 POST 请求，使其不同，第二种是禁用网络服务器上的缓存。

以下帖子详细介绍了这两种解决方法： [iOS 6 上的 Safari 是否缓存 $.ajax 结果？](https://stackoverflow.com/questions/12506897/ios6-safari-caching-ajax-results/)

如果在 iOS6 升级之前（或之后）设置，关闭网络服务器上的缓存可以解决问题。但是，似乎自升级以来发出的任何 POST 请求，直到我们从添加到主屏幕的应用程序中关闭缓存时，仍会被缓存！我们找不到清除它们的方法。删除主屏幕应用程序并重新启动设备并不能解决问题！除了关闭网络服务器上的缓存之外，我们唯一的选择是更改我们的 URL 或为每个请求添加时间戳。

除了恢复到工厂，有谁知道清除主屏幕应用程序缓存的方法？请提供详细信息。

警告任何通过在他们的请求中添加时间戳而不关闭服务器上的缓存来实现解决方法的人。如果您的应用程序被添加到主屏幕，现在每个帖子响应都将被缓存并且它似乎不会过期。除非有人有办法清除它，否则这看起来像是潜在的内存泄漏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T14:10:00.700

根据我的经验，解决这个缓存问题的唯一方法是采用 Google 的方法并在 url 中添加每个请求的 id。然后，您可以为您的服务器使用 mod_rewrite 或其他此类引擎，以使您的后端脚本透明。

# javascript - 骨干和 requireJS - 依赖关系在哪里

> ID：12642734
> 
> 赞同：0
> 
> 时间：2012-09-28T15:14:07.900
> 
> 标签：javascript, backbone.js, requirejs

我试图了解 TodoMVC 的 Backbone + RequireJS 版本。我不明白为什么在 main.js 文件中，主干包不是依赖项？

```
// Require.js allows us to configure shortcut alias
require.config({
    // The shim config allows us to configure dependencies for
    // scripts that do not call define() to register a module
    shim: {
        'underscore': {
            exports: '_'
        },
        'backbone': {
            deps: [
                'underscore',
                'jquery'
            ],
            exports: 'Backbone'
        }
    },
    paths: {
        jquery: 'lib/jquery/jquery.min',
        underscore: '../../../assets/lodash.min',
        backbone: 'lib/backbone/backbone',
        text: 'lib/require/text'
    }
});

require([
    'views/app',
    'routers/router' // <--views/app.js and routers/router.js are the only dependencies
], function( AppView, Workspace ) {
    // Initialize routing and start Backbone.history()
    new Workspace();
    Backbone.history.start(); // <--Here we use Backbone variable. Where do the writer tell the page about the backbone dependency??

    // Initialize the application view
    new AppView();
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:34:42.293

Backbone 由 shim 配置导出为全局，因此无需定义依赖项，因为它已经在全局命名空间中可用。

有关详细信息，请参阅[http://requirejs.org/docs/api.html#config-shim](http://requirejs.org/docs/api.html#config-shim)

# java - 调用 MessageDigest.getInstance("SHA256") 时出现异常

> ID：12642742
> 
> 赞同：20
> 
> 时间：2012-09-28T15:14:33.673
> 
> 标签：java, cryptography, sha256

我的代码在 Android 上运行良好。当我用 JRE 1.6 将它移植到我的 Windows 64 位机器上时，代码不起作用。

当我运行以下代码行时：

```
final MessageDigest digest = MessageDigest.getInstance("SHA256") 
```

我得到以下异常：

> java.security.NoSuchAlgorithmException：SHA256 MessageDigest 在 sun.security.jca.GetInstance.getInstance(Unknown Source) at java.security.Security.getImpl(Unknown Source) at java.security.MessageDigest.getInstance(Unknown Source) 不可用

我在 Internet 上发现有人声称可以将 SHA256 与 Sun JRE 附带的标准加密提供程序一起使用，有人说我需要使用另一个提供程序，例如 Bouncy Castle。

我宁愿不使用不同的提供商。有可能让它工作吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-09-28T15:20:36.830

当您对可以为 JCA 服务使用哪些算法存有疑问时，您的第一站应该是 JCA[标准算法名称文档](http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html)。在符合 JCA 的 JVM 中， [MessageDigest服务](http://docs.oracle.com/javase/6/docs/technotes/guides/security/StandardNames.html#MessageDigest)**保证**支持的算法有：

*   `MD2`
*   `MD5`
*   `SHA-1`
*   `SHA-256`
*   `SHA-384`
*   `SHA-512`

提供者为这些算法提供别名是很常见的，这就是为什么它可能会与 Bouncy Castle 一起使用，但如果可以最大限度地提高可移植性，您应该坚持使用这些别名。

如果您将代码更改为以下内容，它将按预期工作：

```
final MessageDigest digest = MessageDigest.getInstance("SHA-256"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T15:21:42.603

SHA-256 应该是 getInstance() 的参数

[消息摘要支持的算法列表的链接](https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#AppA)

# doctrine-orm - 无法更新“OneToMany”子级

> ID：12642745
> 
> 赞同：0
> 
> 时间：2012-09-28T15:14:38.460
> 
> 标签：doctrine-orm, zend-framework2

我在更新实体时遇到问题。

每个用户只能在一个组中。

用户的架构是：

*   ID INT
*   用户名 STRING
*   group_id INT 默认 NULL

组的架构是：

*   ID INT
*   名称字符串

**组.php**

```
class Group {
    /**
     * @ORM\OneToMany(targetEntity="Saprizo\Entity\User", mappedBy="group", cascade={"all"})
     */
    protected $users;

    public function setUsers($users) {
        foreach ($users as $user) {
            $user->setGroup($this);
        }
        $this->users = $users;
    }
} 
```

**用户.php**

```
class User {
    /**
     * @ORM\ManyToOne(targetEntity="SaprizoStatistics\Entity\Group", inversedBy="users", cascade={"all"})
     * @ORM\JoinColumn(name="group_id", referencedColumnName="id", nullable=true)
     */
    protected $group;

} 
```

当我尝试将新用户添加到组时

```
$group->setUsers(array($user1, $user2));
$em->persist($group);
$em->flush(); 
```

它保存所有值。

但是当我尝试从组中删除所有用户时

```
$group->setUsers(array());
$em->persist($group);
$em->flush(); 
```

它什么也不做。据我了解，在设置一个空数组并将其保存后 user1 和 user2 的 group_id 列应更改为`null`.

教义注释中的错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T21:56:02.527

这不是 Doctrine 注释中的错误。您永远不会从组中删除旧用户。将它们添加到组后，您需要手动删除它们。只是改变你的`setUsers()`方法。

```
public function setUsers($users) {
    //Remove old users first
    foreach ($this->users as $user) {
        $user->setGroup(null);
    }
    //Now we can add the new ones and replace the array
    foreach ($users as $user) {
        $user->setGroup($this);
    }
    $this->users = $users;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-30T14:57:25.313

如果您查看您的 setUsers 函数，您会注意到，当您传递一个 emtpy 数组时（就像您在尝试删除所有用户时所做的那样），简单地跳过了 foreach 循环并维护了用户实体的 group_id。

尽管 mbinette 的回答是正确的，但我建议制作一个单独的函数来删除用户。根据 mbinette 的建议，在添加新用户时，您必须添加阵列中的所有用户，因为您首先将它们全部删除。

```
public function removeUsers() {
    foreach ($this->users as $user) {
        $user->setGroup(null);
    }
} 
```

# java - RequestMappings 根本不起作用

> ID：12642748
> 
> 赞同：0
> 
> 时间：2012-09-28T15:14:41.303
> 
> 标签：java, spring, tomcat, spring-mvc

网页.xml：

```
 <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>WEB-INF/spring-servlet.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping> 
```

我已将此附加到 web.xml

```
 <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>classpath:applicationContext.xml</param-value>
    </context-param>
    <jsp-config>
        <jsp-property-group>
            <url-pattern>*.jsp</url-pattern>
            <page-encoding>utf-8</page-encoding>
        </jsp-property-group>
    </jsp-config> 
```

现在 applciationContext.xml 包含这个

```
<mvc:annotation-driven/>
<context:component-scan base-package="com.myCorectBasePackage"/> 
```

控制器看起来像这样：

```
@RequestMapping(value = "/Home", method = RequestMethod.GET)
    public String getHome(Model model) {
        model.addAttribute("data", "myData");
        System.out.println("wtf");
        return "index";
    } 
```

但网址正在解析为 404 ：

```
http://localhost:8080/myWar/Home 
```

失败！

服务器日志看起来不错

```
INFO: Deploying configuration descriptor ws.xml from C:\Users\myProfile\.IntelliJIdea11\system\tomcat\Unnamed_myWar_2\conf\Catalina\localhost
Sep 28, 2012 4:21:18 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["http-bio-8080"]
Sep 28, 2012 4:21:18 PM org.apache.coyote.AbstractProtocol start
INFO: Starting ProtocolHandler ["ajp-bio-8009"]
Sep 28, 2012 4:21:18 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 3324 ms
Connected to server 
```

@Vacumn 这是自动生成的部署描述符

```
<Context antiJARLocking="true" docBase="E:\jetbrains-workspace\myWar\target\myWar" path="/myWar" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:44:24.480

如果您有注释驱动的控制器，您可能会这样做

```
<context:component-scan base-package="com.package1, com.package2"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:41:52.657

将您的 XML 配置文件定义为`context-param`而不是`init-param`

```
<context-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/spring-servlet.xml</param-value>
</context-param> 
```

我希望您将 InternalResourceViewResolver 条目添加到 spring 配置中：

```
<bean id="viewResolver"
           class="org.springframework.web.servlet.view.InternalResourceViewResolver" >
           <property name="prefix">
              <value>/WEB-INF/pages/</value>
           </property>
           <property name="suffix">
              <value>.jsp</value>
           </property>
        </bean> 
```

# facebook - 是否可以以编程方式从 FB 洞察中获取 Facebook Open Graph 应用程序的动态、Ticker、Timeline Impressions 和其他值

> ID：12642753
> 
> 赞同：2
> 
> 时间：2012-09-28T15:14:54.943
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我一直在尝试从 Facebook 洞察力编写代码中获取 Facebook Open Graph 应用程序的已发布操作、总展示次数、总推荐次数、Feed 展示次数、代码展示次数、时间轴展示次数和其他值。

我只能获取有限的参数值。

应用用户：

```
application_active_users/
application_active_users_locale/
application_active_users_city/
application_active_users_country/
application_active_users_gender/
application_active_users_age/
application_active_users_gender_age/
application_installed_users/
application_installed_users_locale/
application_installed_users_city/
application_installed_users_country/
application_installed_users_gender/
application_installed_users_age/
application_installed_users_gender_age/
application_installation_adds/
application_installation_adds_unique/
application_installation_removes/
application_installation_removes_unique/
application_permission_views_top/
application_permission_views_top_unique/
application_permission_grants_top/
application_permission_grants_top_unique/ 
```

申请内容：

```
application_comment_adds/
application_comment_adds_unique/
application_photos/
application_photos_unique/
application_shares/
application_shares_unique/ 
```

API 性能：

```
application_api_calls/
application_api_calls_top/
application_api_calls_unique/
application_api_errors/
application_api_errors_rate/
application_api_errors_top/
application_api_time_average 
```

我的问题是：

*   Facebook Insights 是否存在不允许我们获取这些信息的限制？
*   有没有其他方法可以获取此信息？

# android - Android appWidgetProvider onEnabled 从未在平板电脑上调用过

> ID：12642754
> 
> 赞同：4
> 
> 时间：2012-09-28T15:14:57.543
> 
> 标签：android, android-intent, widget, appwidgetprovider

**场景一：**

1.  设备已加载
2.  我添加第一个小部件
3.  **OneX** -> 调用 onEnabled | **Galaxy Tab** -> 不调用 onEnabled。

**场景二：**

1.  设备已在屏幕上使用小部件启动。
2.  **OneX** -> 调用 onEnabled | **Galaxy Tab** -> Calls onEnabled

但是当用户在屏幕上放置一个时必须调用它（场景 1），否则有什么意义。当然，您不必重新启动设备即可调用 onEnabled。

它很重要，因为我附加了一个警报管理器以每 2 秒更新一次我的小部件：

```
 AlarmManager alarmManager = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);

    Calendar calendar = Calendar.getInstance();
    calendar.setTimeInMillis(System.currentTimeMillis());
    calendar.add(Calendar.SECOND, 1);
    alarmManager.setRepeating(AlarmManager.RTC, calendar.getTimeInMillis(), 1000, createClockTickIntent(context)); 
```

有一个类似的问题没有有效的解决方案：[AppWidgetProvider: not called onEnabled method](https://stackoverflow.com/questions/5483651/appwidgetprovider-not-called-onenabled-method)

无需注册这些意图，这样做也无济于事。

我的问题是为什么 onEnabled 不调用，我该如何调用它。

它在谷歌文档上说：**ACTION_APPWIDGET_ENABLED：**

> 当 AppWidget 的实例第一次添加到主机时发送。如果安装了带有此提供程序实例的 AppWidgetHost，则会在启动时发送此广播。

基本上确认它应该在两种情况下都有效

这是触发**onEnabled()的意图**

> 在实例化此提供程序的 AppWidget 时调用以响应 ACTION_APPWIDGET_ENABLED 广播。重写此方法以实现您自己的 AppWidget 功能。

它适用于手机而不是平板电脑的事实很奇怪。这是 android 3.2 的问题吗？有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-08T10:36:42.973

在多次尝试找出它为什么会这样后，我做不到。

它要么是与 android 相关的问题，要么是与设备相关的问题，其中启用了小部件的广播永远不会发送。

使用警报管理器更新小部件的唯一解决方法是从它自己的方法初始化警报管理器，然后从`onEnabled`AND调用它`onUpdate`。因此，当它低于 时`onEnabled`，它将被 覆盖`onUpdate`，当小部件去更新自身时（在应用程序调用它时）。并且在场景`onEnabled`中确实有效，它只会在调用 onUpdate 时用新实例替换现有的警报管理器。

根据您在 onEnabled 中尝试执行的操作，可能不是理想的解决方案，但我能找到的唯一解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-08T06:33:30.960

我还发现这非常不可靠，并使用广播侦听器解决了这个问题，用于启动完成事件。您还可以尝试其他回调（如 onUpdate()）

# r - 将连续 NA 减少为单个 NA 的最佳方法

> ID：12642756
> 
> 赞同：11
> 
> 时间：2012-09-28T15:15:08.190
> 
> 标签：r

我需要将向量中的连续 NA 减少为单个 NA，而不触及其他值。
因此，例如，给定一个像这样的向量：

```
NA NA  8  7 NA NA NA NA NA  3  3 NA -1  4 
```

我需要得到的是以下结果：

```
NA  8  7 NA  3  3 NA -1  4 
```

目前，我正在使用以下功能：

```
reduceConsecutiveNA2One <- function(vect){
  enc <- rle(is.na(vect))

  # helper func
  tmpFun <- function(i){
    if(enc$values[i]){
      data.frame(L=c(enc$lengths[i]-1, 1), V=c(TRUE,FALSE))
    }else{
      data.frame(L=enc$lengths[i], V=enc$values[i])
    }
  }

  Df <- do.call(rbind.data.frame,lapply(1:length(enc$lengths),FUN=tmpFun))

  return(vect[rep.int(!Df$V,Df$L)])
} 
```

它似乎工作正常，但可能有一种更简单/更快的方法来完成这项任务。

有什么建议么 ？

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T15:41:10.403

这是一个想法：

```
x <- c(NA, NA,8,7,NA, NA, NA, NA, NA, 3, 3, NA, -1,  4)

x[!(is.na(x) & diff(c(FALSE, is.na(x)))==0)]
# [1] NA  8  7 NA  3  3 NA -1  4

## It also works for length-one vectors
x <- NA
x[!(is.na(x) & diff(c(FALSE, is.na(x)))==0)]
# [1] NA 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:25:32.573

也许这可能有用

```
x <- c(NA, NA,8,7,NA, NA, NA, NA, NA, 3, 3, NA, -1,  4)
c(x[rowSums(is.na(embed(x,2)))!=2], x[length(x)])
[1] NA  8  7 NA  3  3 NA -1  4 
```

如果您想要一个功能，请尝试：

```
myfun <- function(x){
  if(length(x)==1) {
    return(x)
  }
  else{
    return(c(x[rowSums(is.na(embed(x,2)))!=2], x[length(x)]))
  }
}

> myfun(x)
[1] NA  8  7 NA  3  3 NA -1  4
> y <- c(x, NA, NA, NA, 3)
> y
 [1] NA NA  8  7 NA NA NA NA NA  3  3 NA -1  4 NA NA NA  3
> myfun(y)
 [1] NA  8  7 NA  3  3 NA -1  4 NA  3
> myfun(NA)
[1] NA
> myfun(1)
[1] 1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T17:59:31.583

一个有趣的小练习，使用`head`and `tail`：

```
merge.na <- function(x) c(head(x, 1), tail(x, -1)[!(is.na(tail(x, -1)) &
                                                    is.na(head(x, -1)))]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T15:57:24.443

不像其他响应那么酷，而是使用不同的方法`rle`：

```
x <- c(NA, NA,  8,  7, NA, NA, NA, NA, NA,  3,  3, NA, -1,  4)
x[is.na(x)] <- 999
y <- rle(x)
y[[1]][y[[2]]==999] <- 1
y[[2]][y[[2]]==999] <- NA
rep(y[[2]], y[[1]])

#per Dason's Suggestion:
inverse.rle(y) 
```

让我感到惊讶的是，`rle`没有将 NA 组合在一起。它这样做：

```
> rle(x)
Run Length Encoding
  lengths: int [1:13] 1 1 1 1 1 1 1 1 1 2 ...
  values : num [1:13] NA NA 8 7 NA NA NA NA NA 3 ... 
```

因此需要重新编码为 999

# php - PHP 和 Javascript 聊天室的 sql 数据库中的时间戳关闭

> ID：12642773
> 
> 赞同：2
> 
> 时间：2012-09-28T15:16:01.663
> 
> 标签：php, javascript, sql, timezone, chatroom

基本上我一直在尝试按照教程来创建一个聊天室。

[Ajax 网络聊天教程](http://tutorialzine.com/2010/10/ajax-web-chat-php-mysql/)

除了时间显示不正确而且我不知道从哪里开始之外，我已经完成了所有工作。

步骤 1\. 聊天立即显示用户的线路（使用 javascript 的 Date() 正确显示，因此用户认为系统快速且快速）

第 2 步。然后它进入数据库并存储聊天线，其中列 'ts' 将 current_timestamp 存储为时间戳。

第 3 步。之后，Ajax 从数据库中抓取聊天行并刷新聊天以显示“真实”聊天行，即使代码应该将其转换为用户的时区，它也显示不正确。这是让您了解我所在位置的代码。

Grab Time from chat database: // 返回聊天创建的 GMT (UTC) 时间：

```
 $chat->time = array( 
            'hours'     => gmdate('h',strtotime($chat->ts)),
            'minutes'   => gmdate('i',strtotime($chat->ts))
        ); 
```

然后将其发送到 javascript 以更新聊天室的聊天行

// 所有时间都显示在用户的时区 var d = new Date();

```
 if(params.time) {
        // PHP returns the time in UTC (GMT). We use it to feed the date
        // object and later output it in the user's timezone. JavaScript
        // internally converts it for us.

        d.setUTCHours(params.time.hours,params.time.minutes);
    }
    params.time = (d.getHours() < 10 ? '0' : '' ) + d.getHours()+':'+
                  (d.getMinutes() < 10 ? '0':'') + d.getMinutes(); 
```

示例：用户提交聊天线..

Javascript 打印 11:07...

SQL 将 current_timestamp 保存为 8:07 ...

PHP 从数据库中抓取并将其转换为 12:07

d.setUTCHours = 1348834072033

最后 params.time 使用 javascript 打印到 8:07

我不认为我错过了其他任何东西。任何人都可以帮忙吗？这几天想弄清楚这件事真的很糟糕。Javascript很好......我认为SQL正在做它应该做的事情并将其转换为通用时间或格林威治标准时间？:P 和 PHP 很接近了.. 休息了一个小时，但是 javascript 没有做它应该做的事情:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:27:24.067

这里有，什么，三个不同的系统？Web 浏览器、数据库和 Web 服务器（运行 PHP），对吗？

它们是同步的吗？它们是否正确配置？这是你应该开始的地方。

[http://en.wikipedia.org/wiki/Ntpd](http://en.wikipedia.org/wiki/Ntpd)

[https://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html](https://dev.mysql.com/doc/refman/5.5/en/time-zone-support.html)

[http://php.net/manual/en/datetime.configuration.php](http://php.net/manual/en/datetime.configuration.php)

# javascript - 表单域中的自动前进

> ID：12642774
> 
> 赞同：1
> 
> 时间：2012-09-28T15:16:02.810
> 
> 标签：javascript, html, input, tabs

我有一个简单的脚本，在输入一个字符后，它会自动将光标移到我的 html 表单中的下一个字段......它非常适合。这是简单的代码：

```
function autotab(current,to)
{
if (current.getAttribute && current.value.length==current.getAttribute("maxlength")) 
{   
        to.focus()          
    }
} 
```

然后当然我使用 onkeyup 来推进它，像这样：

```
<input onkeyup="autotab(this, document.jumble.w1b)" type="text"> 
```

再一次，效果很好。但是，当我执行 Shift+Tab 以返回一个框时，它会在我输入任何内容之前自动前进。

有没有人有如何使 Shift+Tab 工作的代码示例？我尝试过尝试使用键码来检测移位和制表符的不同变体，但它似乎不起作用。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:25:43.913

你应该防止 to.focus 在 jsfiddle 的情况`shift + tab` [下](http://jsfiddle.net/veF2x/1/)

```
 function autotab(event, current,to)  {
       event = event || window.event;       
       if(event.keyCode < 65  ||  event.keyCode > 90){
         return ;
       }
       if (current.getAttribute && current.value.length==current.getAttribute("maxlength")) 
       {   
         to.focus()          
       }
    } 
```

编辑：在自动选项卡中添加事件作为第一个参数：`<input onkeyup="autotab(event, this, document.jumble.w1b)" type="text">`

# iphone - 为什么 UIScrollView 会自动重置其 zoomScale 属性？

> ID：12642776
> 
> 赞同：5
> 
> 时间：2012-09-28T15:16:09.347
> 
> 标签：iphone, objective-c, ios, uiscrollview, uikit

我有一个扩展的 UIScrollView，它直接取自 Apple 文档示例项目“ZoomingPDFViewer”

如果你得到这个项目，你会注意到它的 UIScrollView 扩展类“PDFScrollView”在你运行它时有一个明显的错误（在 sim 和设备上）

如果您将缩放缩放得足够远，您最终会达到 StoryBoard 设置的缩放比例限制......但是，您可以重新捏合并继续超过限制。

我一直在尝试在我自己的项目中实现这个类，这个错误也随之而来。

出于某种原因，在缩放结束后，UIScrollView 的 zoomScale 属性被任意设置回 1.0，因此您可以有效地将缩放缩放到无穷大......请记住，重置的 zoomScale 不会影响内容......所以您可以继续缩小，直到演示中的 PDF 只是屏幕上的一个像素。

我以前从未见过这种情况，而且我之前做过大量的自定义 UIScrollViews。

我已经尝试了几个步骤来解决它，但似乎没有任何效果。有谁知道什么会导致 UIScrollView 以这种方式重置它的 zoomScale ？

我认为这可能是因为在缩放期间正在删除和添加子视图，但我在滚动视图中放置了一个虚拟视图作为锚点，但这也不起作用。

就像我说的.. ZoomingPDFViewer 是我正在使用的确切代码，使用 iOS 6.0

任何想法，将不胜感激。下面的示例代码

```
- (void)scrollViewDidEndZooming:(UIScrollView *)scrollView withView:(UIView *)view atScale:(float)scale
{
NSLog(@"Ending Zoom %0.2f %0.2f", [self zoomScale], scale);

// Set the new scale factor for the TiledPDFView.
_PDFScale *= scale;

// Calculate the new frame for the new TiledPDFView.
CGRect pageRect = CGPDFPageGetBoxRect(_PDFPage, kCGPDFMediaBox);
pageRect.size = CGSizeMake(pageRect.size.width*_PDFScale, pageRect.size.height*_PDFScale);

// Create a new TiledPDFView based on new frame and scaling.
TiledPDFView *tiledPDFView = [[TiledPDFView alloc] initWithFrame:pageRect scale:_PDFScale];
[tiledPDFView setPage:_PDFPage];

// Add the new TiledPDFView to the PDFScrollView.
[self addSubview:tiledPDFView];
self.tiledPDFView = tiledPDFView;

NSLog(@"End of end zoom %0.2f", [self zoomScale]);

} 
```

这是最终滚动委托...这两个日志都会产生一个缩放比例，这正是您所期望的...所以... 1.0 以外的任何数字，假设您实际缩放。

然后 layoutSubviews 被调用..

```
// Use layoutSubviews to center the PDF page in the view.
- (void)layoutSubviews 
{
[super layoutSubviews];

// Center the image as it becomes smaller than the size of the screen.

CGSize boundsSize = self.bounds.size;
CGRect frameToCenter = self.tiledPDFView.frame;

// a bunch of code that sets frameToCenter

self.tiledPDFView.frame = frameToCenter;
self.backgroundImageView.frame = frameToCenter;

/*
 To handle the interaction between CATiledLayer and high resolution screens, set the tiling view's contentScaleFactor to 1.0.
 If this step were omitted, the content scale factor would be 2.0 on high resolution screens, which would cause the CATiledLayer to ask for tiles of the wrong scale.
 */
self.tiledPDFView.contentScaleFactor = 1.0;

NSLog(@"Subviews Layed Out %0.2f", [self zoomScale]);
} 
```

此时，无论如何，zoomScale 都会报告为 1.0……这会在 End Zoom 委托方法报告正确的缩放比例后 0.003 秒跟踪。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T16:03:37.270

是的，这发生在 iOS 3 左右的某个时候。`zoomScale`总是*相*对于滚动视图的当前状态，而不是全局测量。每次缩放后，您需要重新计算相对于当前整体缩放比例的最小和最大缩放比例。

这是我过去使用的一些代码。它应该为您提供该过程的要点：

在早期，获取您需要的值：

```
- (void) viewDidLoad
{
    [super viewDidLoad];
    ...
    // Squirrel away min and max zoom values from nib
    sMinZoomScale = self.scrollView.minimumZoomScale; // the very minimum
    sMaxZoomScale = self.scrollView.maximumZoomScale; // the very maximum
    sGlobalZoomScale = 1.0f;  // we're currently at 100% size
    ...
} 
```

然后剩下的（`self.navigationView`是scrollView的内容视图）：

```
- (void) scrollViewDidEndZooming:(UIScrollView *)scrollView
                        withView:(UIView *)view
                         atScale:(CGFloat)scale
{
    // after a zoom, change the resolution of our map
    sGlobalZoomScale *= scale;
    // Peg the scale to minZoom and maxZoom, in case of rounding errors
    sGlobalZoomScale = MIN(MAX(sMinZoomScale, sGlobalZoomScale), sMaxZoomScale);
    self.navigationView.globalZoomScale = sGlobalZoomScale;
    self.navigationView.globalScaleTransform = self.globalScaleTransform;
    [self updateResolution];

    // throw out all tiles so they'll reload at the new resolution
    [self.navigationView setNeedsDisplay];
}

// By the time we get here, the scrollview's applied a fake scale and translate transform, and
//   altered the scrollview's zoom scale. BUT, the navigationview is as it ever was.
- (void) updateResolution
{
    CGFloat zoomScale = [self.scrollView zoomScale];

    CGSize oldContentViewSize = self.navigationView.frame.size;    
    // zooming properly resets contentsize as it happens.
    CGSize newContentSize = self.scrollView.contentSize;

    CGPoint newContentOffset = self.scrollView.contentOffset;
    CGFloat xMult = newContentSize.width / oldContentViewSize.width;
    CGFloat yMult = newContentSize.height / oldContentViewSize.height;

    newContentOffset.x *= xMult;
    newContentOffset.y *= yMult;

    CGFloat currentMinZoom = self.scrollView.minimumZoomScale;
    CGFloat currentMaxZoom = self.scrollView.maximumZoomScale;

    CGFloat newMinZoom = currentMinZoom / zoomScale;
    CGFloat newMaxZoom = currentMaxZoom / zoomScale;

        // Reset zoom scales temporarily so we can patch up the revised content view
    // don't call our own set..zoomScale, 'cause they eventually call this method.  Infinite recursion is uncool.  
    [self.scrollView setMinimumZoomScale:1.0f];
    [self.scrollView setMaximumZoomScale:1.0f];
    [self.scrollView setZoomScale:1.0f animated:NO];

    [self.navigationView setFrame:CGRectMake(0.0f, 0.0f, newContentSize.width, newContentSize.height)];
    [self.scrollView setContentSize:newContentSize];
    [self.scrollView setContentOffset:newContentOffset animated:NO];

    [self.scrollView setMinimumZoomScale:newMinZoom];
    [self.scrollView setMaximumZoomScale:newMaxZoom];
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T16:04:20.197

这里的问题是，在 Apple 的示例代码中，他们正在返回一个要缩放的视图，因为该视图`- (UIView *)viewForZoomingInScrollView:`不断被重新实例化。不久之后，返回值是另一个对象，UIScrollView 将其解释为缩放比例的重置，从而允许您滚动到无穷大。

我（尚）不知道如何正确修复 Apple 的示例代码，但一个可行的解决方案将涉及将 UIScrollView 固定到永远不会重置的虚拟视图，然后手动缩放其他所有内容。

# excel - Excel 2010 形状自定义右键单击上下文菜单

> ID：12642777
> 
> 赞同：0
> 
> 时间：2012-09-28T15:16:15.477
> 
> 标签：excel, vba

好的，我已经搜索了几个小时了。我只是想找到 excel 形状（例如矩形和自由形式）的右键单击上下文菜单的控件索引名称。

我有以下代码，我要做的就是在用户右键单击形状时删除所有默认菜单项。

这里：

```
For Each ShapeCommandBar In Application.CommandBars("Name of Shapes Context Menu").Controls
    ShapeCommandBar.Delete
Next ShapeCommandBar 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T16:08:37.793

仅供参考，Shapes 的上下文菜单显然无法通过 VBA 访问，因此我不得不为自定义文件编写自己的 XML。

解释的文章在这里：http: [//msdn.microsoft.com/en-us/library/office/gg469862.aspx](http://msdn.microsoft.com/en-us/library/office/gg469862.aspx)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-28T17:13:10.737

我相信它被称为“形状”。

# jquery - 单击 div 以显示和隐藏 jquery 中的其他 div

> ID：12642779
> 
> 赞同：1
> 
> 时间：2012-09-28T15:16:48.117
> 
> 标签：jquery

html代码：

```
<div id="all"> </div>
<div id="div1"> </div>
<div id="div2"> </div>
<div id="div3"> </div>
<div id="div4"> </div>
<div id="div5"> </div> 
```

jQuery代码：

这适用于“div1”和“all”之间的切换。如果我想单击#div1 并仅显示“全部”并隐藏其他，当单击“全部”时，显示所有 div。

```
 $(function () {
         $("#div1, #all").on('click', function () 
         {
             $("#div1, #all").not(this).show();
             $(this).hide(); 
         });
     }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:21:26.020

这是你需要做的，使用 jQuery 提供的可爱的选择器

```
$(function () {
    $('div[id^="div"]').click(function() {
        $(this).siblings().filter(':not(#all)').hide();
    });

    $('#all').click(function() {
        $('div[id^="div"]').show();
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:23:51.890

尝试使用以下方法`class`。

**HTML：**

```
<div id="all"> </div>
<div class="myDivs"> </div>
<div class="myDivs"> </div>
<div class="myDivs"> </div>
<div class="myDivs"> </div>
<div class="myDivs"> </div> 
```

**JS：**

```
$(function () {
    $('.myDivs').click (function () {
        $('.myDivs').not(this).hide();
    });

    $('#all').click (function () {
        $('.myDivs').show();
    });
}); 
```

**编辑：**即兴使用 2 个处理程序

**演示：http:** [//jsfiddle.net/Fsg9y/2/](http://jsfiddle.net/Fsg9y/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:18:43.763

您可以通过 foreach 函数并提供父节点的 ID 来执行此操作：

```
$('div').each( function() {} ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T15:26:06.727

您可以使用以下内容：

[http://jsfiddle.net/sAW36/](http://jsfiddle.net/sAW36/)

```
(function($) {
    $('div[id^=div]').click(function(){
        var id = $(this).attr('id');
        $.each($('div[id^=div]'), function() {
            if ($(this).attr('id') == id) return true;
            $(this).hide();
        });
    });

    $('div#all').click(function() {
        $('div[id^=div]').show();
    });
})(jQuery);​ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T15:29:31.283

我假设您的 div 实际上不会被命名为“div1”、div2 等。在这种情况下，您可以这样做：

```
$(function(){
    $("div").click(function(){
        if ($(this).attr("id") === "all"){
            $(this).siblings().show();
        }
        else{
           $(this).siblings().not("#all").hide();
        }
    });       
});​ 
```

[http://jsfiddle.net/mPdCb/1](http://jsfiddle.net/mPdCb/1)

# lotus-notes - 加密的电子邮件提供虚假表单 Notes api

> ID：12642781
> 
> 赞同：1
> 
> 时间：2012-09-28T15:16:56.797
> 
> 标签：lotus-notes, lotus-domino, lotus, lotusscript, lotus-formula

我已经向 Lotus notes 收件箱发送了一封加密的电子邮件，如果我从本地访问该电子邮件，则为真，如果同一电子邮件运行不同的系统，则为假。是设置问题吗？我的代码看起来像 logger.debug("This Email is encrypted? "+document.isEncrypted()); 我的本地记录器正在打印“此电子邮件已加密？是的”如果我在其他系统中运行相同的电子邮件，它会打印“此电子邮件已加密？错误”这是文档属性。字段名称：加密。数据类型：文本数据长度：1 字节序列号：1 重复项 ID：0 字段标志：摘要

“1”

我不知道我的代码在不同的地方表现不同。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T21:19:25.690

isEncrypted() 属性与 Encrypt 字段无关。该字段只是一个 UI 开关。isEncrypted() 属性基于 $Seal 项目，如果消息为 MIME 格式，则基于 SMIME 内容。

有两个问题可能与您所看到的有关：

*   您是否使用两个不同的 Notes ID 文件来阅读消息？
*   您是否在两个系统上使用相同版本的 Lotus Notes？

如果您在 Notes API 中打开一条加密消息，并且您当前的 Notes ID 文件包含用于解密该消息的正确私钥，那么该消息将自动解密。这发生在 LotusScrpt 和 Java API 的下一层，因此这些 API 看到文档未加密并返回 false。但显然 IBM 在 8.5.2 版本中改变了这一点。这是一个[链接](http://www-10.lotus.com/ldd/nd85forum.nsf/0/9F0CB892F4C44C248525795D003FE35C?OpenDocument&ca=drs-fo)，报告在 8.5.2 中 isEncrypted() 将返回 true。似乎 IBM 已经修复了代码，因此即使自动解密已经完成，它现在也知道正确的答案。

当然，如果您在 Notes API 中使用不包含用于解密消息的正确私钥的 Notes ID 文件打开加密消息，IsEncrypted() 将始终返回 true。

# iphone - *.dbf 文件阅读器 iphone

> ID：12642785
> 
> 赞同：1
> 
> 时间：2012-09-28T15:17:15.010
> 
> 标签：iphone, ios, ipad, foxpro

有谁知道用于管理（读取） *.dbf 文件的 iOS 库？[在github](https://github.com/davbeck/DBF-Reader)上找到了一个 dbf-reader，但它适用于 MAC OS；任何其他起点？

# symfony - Symfony2 捆绑多个企业网站的最佳实践

> ID：12642786
> 
> 赞同：1
> 
> 时间：2012-09-28T15:17:15.663
> 
> 标签：symfony, bundle, vendor

我正在做一个项目......创建一个将在多个 sf2 实例中使用的包。我想知道最好的做法是什么？让它进入 src/ 或 vendor/ 并放在我们的 git 服务器上？我尝试在供应商中创建一个但没有成功，但我总是遇到错误，例如无法注册。

最好的做法是什么？如果是供应商目录...您知道在哪里可以找到有关正确设置的指南吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:49:16.943

可能你应该检查这个[http://getcomposer.org/doc/05-repositories.md](http://getcomposer.org/doc/05-repositories.md) 。你不需要在 composer packagist 上发布它。据我所知，您可以将 tha bundle 放在 src 中，以防您需要对整个项目进行轻松修改。如果您想要更多控制，那么您只需要在 composer 中设置正确的规则，以便将它放在 /vendor 以供任何想要使用它的人使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T10:38:13.653

最佳实践答案是使用 'composer.json'、'/vendors' 和 symfony 文档来创建存储在版本控制中的工作包。根据你的说法，你似乎很接近。然后通过'/src'覆盖捆绑包，以对运行捆绑包的多个应用程序中的每一个进行较小的捆绑包调整。这将使一切保持清洁和可管理。

# iphone - 在加载时更改 tableview 框架的最佳位置

> ID：12642788
> 
> 赞同：0
> 
> 时间：2012-09-28T15:17:19.563
> 
> 标签：iphone, ios, xcode, cocoa-touch

我正在使用自定义阴影图像，我需要将表格视图移动 11 个点。

这是我的做法：

```
self.frontTableView.frame = CGRectMake(self.frontTableView.frame.origin.x, 
self.frontTableView.frame.origin.y+11,
self.frontTableView.frame.size.width, 
self.frontTableView.frame.size.height); 
```

我在 numberOfSections 方法中使用它，这可能不是最好的地方 - 因为当视图消失并再次出现时，我的 tableView 保持原样。

那么更改tableview框架的最佳位置在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:38:47.573

我会在 nib 本身或在`viewDidLoad`任何委托方法中执行此操作，您不知道何时或多少次将被调用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-28T15:24:29.810

使用这个方法：

```
-(void)viewDidLoad
{
   [super viewDidLoad];
   self.frontTableView = [UITableView new];
   self.frontTableView.frame = CGRectMake(self.frontTableView.frame.origin.x, 
   self.frontTableView.frame.origin.y+11,
   self.frontTableView.frame.size.width, 
   self.frontTableView.frame.size.height);
      //other custom methods . . . 
} 
```

如果在执行过程中对tableview进行了一些更改，不要忘记调用方法[self reload frontTableView]；

# java - 简单快速的 JTree 单元格编辑器

> ID：12642792
> 
> 赞同：6
> 
> 时间：2012-09-28T15:17:38.017
> 
> 标签：java, swing, jtree, tablecelleditor

我有一个带有自定义 TreeModel 和自定义 TreeRenderer 的 JTree。树模型包含一堆不同类型的对象。其中一种类型的显示方式与其他类型不同： 显示的文本是对象的两个字段的串联。当我编辑单元格时，我想用编辑后的文本更新这些字段之一。到目前为止，我让它工作得很好。

我的问题：当编辑时显示的文本是 2 个字段的完整连接值时，即使您实际上只是在编辑其中一个字段，也会令人困惑。所以我只想在用户开始编辑时显示您正在编辑的一个字段的内容。

我试图用一个自定义的 CellEditor 来做到这一点，我看到了它应该工作的方式，在我的情况下，这种方法似乎有点矫枉过正。我只想在多种情况下更改显示的文本，所以我自然想实现它，而不是整个 CellEditor 用于我的 Tree 的全部内容。

有没有更快更简单的方法来做到这一点，还是我必须使用自定义编辑器？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T10:37:23.980

没有办法绕过自定义编辑器，它是可能的最短解决方案:-) 此外，您需要在*数据*领域中使用一些方法来适当地解释编辑值并自行更新，例如自定义节点。

Fi（稍后会评论它，我在这台机器上的蹩脚的 Firefox 把我逼疯了）

```
/**
 * Basic code stolen from @trashgod at
* @see http://stackoverflow.com/a/11113648/230513
*/
public class TreeEditDemo extends JPanel {

    private JTree tree;
    private DefaultMutableTreeNode root;
    private DefaultTreeCellEditor editor;

    public TreeEditDemo() {
        super.setLayout(new GridLayout());
        root = new DefaultMutableTreeNode("Nodes");
        root.add(new MyResourceNode(new Resource("one", "first")));
        root.add(new MyResourceNode(new Resource("two", "first")));
        tree = new JTree(root);
        tree.setEditable(true);
        editor = new MyTreeCellEditor(tree,
            (DefaultTreeCellRenderer) tree.getCellRenderer());
        tree.setCellEditor(editor);
        this.add(new JScrollPane(tree));
    }

    private static class MyTreeCellEditor extends DefaultTreeCellEditor {

        public MyTreeCellEditor(JTree tree, DefaultTreeCellRenderer renderer) {
            super(tree, renderer);
        }

        @Override
        public Component getTreeCellEditorComponent(JTree tree, Object value,
                boolean isSelected, boolean expanded, boolean leaf, int row) {
            if (value instanceof MyResourceNode) {
                value = ((MyResourceNode) value).getName();
            }
            return super.getTreeCellEditorComponent(tree, value, isSelected, expanded,
                    leaf, row);
        }

        @Override
        public boolean isCellEditable(EventObject e) {
            return super.isCellEditable(e)
                && ((TreeNode) lastPath.getLastPathComponent()).isLeaf();
        }
    }

    public static class MyResourceNode extends DefaultMutableTreeNode {

        /**
         * @param resource
         */
        public MyResourceNode(Resource resource) {
            super(resource);
        }

        @Override
        public void setUserObject(Object userObject) {
            if (userObject instanceof String) {
                setName((String) userObject);
            } else if (userObject instanceof Resource) {
                super.setUserObject(userObject);
            }    
        }

        public void setName(String name) {
            if (getUserObject() != null) {
                getUserObject().setName(name);
            }
        }

        public String getName() {
            if (getUserObject() != null) {
                return getUserObject().getName();
            }
            return null;
        }

        @Override
        public Resource getUserObject() {
            return (Resource) super.getUserObject();
        }

    }
    private static class Resource {

        String name;
        private String category;

        public Resource(String name, String category) {
            this.name = name;
            this.category = category;
        }

        public void setName(String name) {
            this.name = name;
        }

        public String getName() {
            return name;
        }
        @Override
        public String toString() {
            // BEWARE: don't do this in production code!
            return name + " (" + category + ")";
        }
    }

    private void display() {
        JFrame f = new JFrame("TreeEditorDemo");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        f.add(this);
        f.pack();
        f.setLocationRelativeTo(null);
        f.setVisible(true);
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TreeEditDemo().display();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T17:46:42.037

需要自定义编辑器。`MyTreeCellEditor`，如图所示[，](https://stackoverflow.com/a/11113648/230513)显示了一种方法。它更新 a 的任意属性`userObject`，该属性被命名`Resource`并保存在 a 中`DefaultMutableTreeNode`。由于属性是文本，它也使用`DefaultTreeCellRenderer`. 您的自定义`TreeModel`可能管理一个类似`userObject`的，它是您的“不同类型的对象”的父级。

# python - 关于 Python 可执行文件中缺少 GTK 图标的警告

> ID：12642804
> 
> 赞同：2
> 
> 时间：2012-09-28T15:18:01.293
> 
> 标签：python, gtk, pygtk, pyinstaller

在我使用 Python 和 PyGTK 编写的可执行应用程序中，弹出 FileChooserDialog 给我这个警告：

```
GtkWarning: Could not find the icon 'gtk-file'.
The 'hicolor' theme was not found either, perhaps you need to install it.
You can get a copy from:
        http://icon-theme.freedesktop.org/releases 
```

该链接将我带到似乎是为 Linux 编写的存档。这个警告不会抑制我的程序的运行，但它很烦人，我认为它让我的用户感到困惑。当我从源代码运行应用程序时不会发生这种情况，只有当我首先使用 pyinstaller 将其构建为可执行文件时。有谁知道我如何找到这个图标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-08T17:46:27.843

我解决了，但是……不合逻辑……我想。

从理论上讲，**`pygtk`**默认情况下应该嵌入完整的图标集，所以真正奇怪的是“为什么会记录这些警告？”。

解决方案（适用于我的四个项目）：

1.  在项目的根目录中，应该存在一个**`share`**文件夹（如果没有，请创建它），您必须创建这些额外的子文件夹：

    `YourProjectRoot / share / icons /`**`hicolor /`**

2.  下载[gnome 的官方二进制图标主题](ftp://ftp.gnome.org/pub/gnome/binaries/win32/gnome-icon-theme/2.24/gnome-icon-theme_2.24.0-1_win32.zip)（12 MB ZIP 文件）

3.  解压缩存档，`gnome-icon-theme_2.24.0-1_win32.zip/share/icons/gnome/`找到文件**`index.theme`**并将其复制到**`hicolor /`**您创建的文件夹中。

就这样

# android - Android从webservice asynctask nullpointer中检索数据

> ID：12642819
> 
> 赞同：0
> 
> 时间：2012-09-28T15:19:15.120
> 
> 标签：android, web-services, android-asynctask

这是我的代码：

[http://pastie.org/4856109](http://pastie.org/4856109)

我想要实现的是，我想将从我的内部 AsyncTask 检索到的所有数据放在名为节点的 main_activity 变量中......

列表节点是我想在其中放置所有检索到的数据的变量......关于我如何存储检索到的数据以在类中使用的任何建议。

如果我运行这段代码，LogCat 会给我这个：

> 09-28 23:00:24.978：电子/下载（1200）：java.lang.NullPointerException
> 
> > 09-28 23:00:25.158：D/gralloc_goldfish(1200)：没有检测到 GPU 仿真的仿真器。
> > 
> > > 09-28 23:00:25.608：D/JSONClient(1200)：“http://10.0.2.2/thesis/displayV.php”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:32:26.403

你打电话时：

```
readWebpage(null); 
```

这会进行**异步**调用以填充您的`nodes`对象。但是，您的主线程将立即继续到这一行：

```
textView.setText((nodes.isEmpty())?"true":"false"); 
```

由于`nodes`仍`null`处于这一点（因为您的 AsyncTask 尚未完成），那么您将获得`NullPointerException`您正在经历的。

正如@njzk2 所说，您应该将您的 UI 操作移至`onPostExecute()`：

```
@Override
protected void onPostExecute(String result) {
    textView.setText((nodes.isEmpty())?"true":"false");
} 
```

# haskell - 为什么解析带有减号的字符串会失败？

> ID：12642820
> 
> 赞同：3
> 
> 时间：2012-09-28T15:19:15.693
> 
> 标签：haskell, parsec

为什么会失败？

```
data Value = Num Integer
           | Str String

let numberOrString = (liftM Num (try int) <|> liftM Str (many1 (noneOf " "))
parse (numberOrString >> space)  "" "123-4 " 
```

`>> space`是必需的。否则解析器将在之后停止`123`

预期结果：

```
parse numberOrString "" "1234"
-> Num 1234

parse numberOrString "" "12-34"
-> Str "12-34" 
```

结果：

```
parse numberOrString "" "1234-34 "
-> Left (line 1, column 5):
   unexpected "-"
   expecting digit or space 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:46:23.410

您没有给出`int`解析器组合器的定义，但让我们假设它本质上需要一个或多个数字，可选地在前面加上一个“-”（但只在前面！）。现在让我们来看看你的`numberOrString`解析器。

它解析一个整数文字，或者解析一个非空格字符的字符串。在您的示例字符串上，解析器的第一个分支将成功，因为它会看到一串数字。它将在“-”字符之前停止，因为那不是数字。现在，`numberOrString >> space`将失败，因为在数字之后，我们期望下一个字符是空格，而“-”不是。

您实际上已将解析器应用于由*两个*整数文字组成的字符串，一个正数和一个负数（或两个由“-”分隔的正数，具体取决于您的语法）。这也是`numberOfString`单独应用解析器只消耗“1234”的原因，因为这是它可以解析的最大整数字面量。

**编辑：**我猜你想要的是`try int`如果在一个主要是数字的字符串中有任何非数字字符，那么你想要失败。同样，这实际上取决于您对 的定义`int`，但它可能被定义为解析器，该解析器可以成功处理任何至少一位数字且后面没有字母字符的字符串。的通常定义`int`将在后跟非字母数字字符的数字字符串上成功，例如“-”，即使没有任何中间空格字符，因为这使得两个整数文字和中缀运算符之间的空格是可选的。此外，它还允许您成功解析“123)”，而无需编写“123 )”。

# string - “<-”在列表理解中是什么意思？

> ID：12642823
> 
> 赞同：-2
> 
> 时间：2012-09-28T15:19:37.503
> 
> 标签：string, haskell, variable-assignment, list-comprehension, operator-keyword

在这段代码中：

```
[x | temp <- str, x <- isVowel temp] 
```

我想知道是什么

*   `<-`运营商做
*   `<- str`运营商做

`isVowel`如果其参数是元音，则返回 true。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T16:00:12.917

你是对的，这`<-`有点像一个任务。

有关更多信息，[这里是](http://learnyouahaskell.com/starting-out#im-a-list-comprehension)学习列表推导的绝佳资源。

> 列表推导与集合推导非常相似。我们现在将坚持获取前 10 个偶数。我们可以使用的列表推导是**[x*2 | x <- [1..10]]**。x 是从 [1..10] 中提取的，对于 [1..10] 中的每个元素（我们已经绑定到 x），我们得到那个元素，只是加倍。

然而，这还不是全部：

*   `<-`也用于[do 表示法](http://learnyouahaskell.com/a-fistful-of-monads#do-notation)：

    > 在 do 表达式中，每一行都是一个单值。为了检查它的结果，我们使用“<-”。

*   `<-`甚至在[monad 理解](http://eprints.nottingham.ac.uk/237/)中使用（虽然这不是很有帮助，因为 monad 理解不再在标准的 Haskell 中，我相信）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T17:31:19.063

在列表推导中，`<-`基本上是“foreach”。每个`pattern <- list`子句都对其 : 进行迭代`list`：提取每个连续的元素，并将其绑定到 中的变量名称，以`pattern`用于其余子句以及结果表达式。

所以，这很像分配。与命令式语言的主要概念区别在于没有修改或更新变量的概念：想法是您正在使用不可变值，这些值在每次迭代时都新“绑定”到它们的名称。

请注意，多个`pattern <- list`子句的行为类似于嵌套的 for 循环。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T07:39:50.547

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T21:27:08.340

**我肯定是错的**，但我一直认为这样`<-`读

 **```
[x | temp <- str, x <- isVowel temp] 
```

就像`temp` **其中** `str`可以帮助您使用变量命名约定一样。因此，考虑到引用透明度，它可能读作...*返回* `x` **in** `isVowel` **in** `str`的列表。**

# vb.net - VB.net 在窗体中心绘制矩形

> ID：12642825
> 
> 赞同：1
> 
> 时间：2012-09-28T15:19:48.550
> 
> 标签：vb.net, winforms, drawing

早安社区

我想在表单的中心准确地绘制一个矩形。另外，我想在这个矩形下画一些文字。

对于我认为没有问题的文本，我使用以下代码：

```
Dim sf As New StringFormat
        sf.LineAlignment = StringAlignment.Center
        sf.Alignment = StringAlignment.Center

        ' Line with the problem
        e.Graphics.FillRectangle(Brushes.Beige, CInt(Local_Form.Width / 2), CInt(Local_Form.Height / 2), 200, 100)

        e.Graphics.DrawString(Local_Text, _
                              New Font(MyCloud.Settings.Settings_Forms.Font.Name, 30), _
                              Brushes.GreenYellow, _
                              Local_Form.Width / 2, Local_Form.Height / 2, sf) 
```

![在此处输入图像描述](../Images/eca8599a876e2fefd85e3298674d3c72.png)

但是，我对矩形有问题。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:44:12.367

两件事，第一是您将矩形的左上角设置为中心，您需要从顶部和左侧位置减去一半宽度和一半高度。此外，您应该使用[`ClientRectangle`](http://msdn.microsoft.com/en-us/library/vstudio/system.windows.forms.control.clientrectangle%28v=vs.100%29.aspx)来获得没有 Chrome 的实际工作表面。

```
e.Graphics.FillRectangle(Brushes.Beige, CInt(Local_Form.ClientRectangle.Width / 2) - 100, CInt(Local_Form.ClientRectangle.Height / 2) - 50, 200, 100) 
```

# java - 导入 Java 项目以在 Java 动态 Web 项目中使用

> ID：12642826
> 
> 赞同：1
> 
> 时间：2012-09-28T15:19:58.877
> 
> 标签：java, eclipse, dynamic, import, project

在我的 Java 动态 Web 项目中，我正在使用构建路径导入另一个 Java 项目，这样我就可以查询类并使用 Java 反射。在编写我的课程时，我最初通过将其作为 Java 应用程序运行来对其进行测试，并且它可以工作。但是，我现在使用同一个类作为动态 Web 项目的一部分，它似乎无法访问导入的 Java 项目。我尝试将它导入到我在 Eclipse 中的项目引用中，但它仍然无法正常工作并输出以下错误：

```
HTTP Status 500 - javax.servlet.ServletException: java.lang.NoClassDefFoundError: com/q1labs/qa/selenium/widgets/WidgetHandler

--------------------------------------------------------------------------------

type Exception report

message javax.servlet.ServletException: java.lang.NoClassDefFoundError: com/q1labs/qa/selenium/widgets/WidgetHandler

description The server encountered an internal error (javax.servlet.ServletException: java.lang.NoClassDefFoundError: com/q1labs/qa/selenium/widgets/WidgetHandler) that prevented it from fulfilling this request.

exception 

org.apache.jasper.JasperException: javax.servlet.ServletException: java.lang.NoClassDefFoundError: com/q1labs/qa/selenium/widgets/WidgetHandler
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:455)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause 

javax.servlet.ServletException: java.lang.NoClassDefFoundError: com/q1labs/qa/selenium/widgets/WidgetHandler
org.apache.jasper.runtime.PageContextImpl.doHandlePageException(PageContextImpl.java:911)
org.apache.jasper.runtime.PageContextImpl.handlePageException(PageContextImpl.java:840)
org.apache.jsp.UpdatingDb_jsp._jspService(UpdatingDb_jsp.java:98)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)

root cause 

java.lang.NoClassDefFoundError: com/q1labs/qa/selenium/widgets/WidgetHandler
com.q1labs.qa.xmlgenerator.controller.updatedb.DbUpdateScript.updateObjectTypes(DbUpdateScript.java:40)
com.q1labs.qa.xmlgenerator.controller.updatedb.DbUpdateScript.updateDb(DbUpdateScript.java:31)
org.apache.jsp.UpdatingDb_jsp._jspService(UpdatingDb_jsp.java:88)
org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
javax.servlet.http.HttpServlet.service(HttpServlet.java:722) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T15:31:35.137

检查您的**项目属性 > 部署程序集**配置。转到**添加**并选择**项目**>*下一步*，然后选择您的项目。现在这将只包括您项目的类。如果您的 Java 项目包含外部或其他 JAR 引用，您还必须通过将它们复制到您的`WEB-INF/lib`或将它们添加为外部 JAR 手动将它们包含在新的 Web 项目中。如果您执行第二个，请不要忘记在*Order & Export*选项卡中标记它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:30:32.453

你能打开部署的war文件并检查这个类文件是否位于 WEB-INF/classes 中吗？如果是这种情况，请检查您`source tab`的构建路径

# c++-cli - 在类中覆盖 wndproc

> ID：12642828
> 
> 赞同：0
> 
> 时间：2012-09-28T15:20:13.903
> 
> 标签：c++-cli, wndproc

我遇到了我无法解决的问题，所以也许我会在这里碰碰运气。我在我的应用程序中覆盖 WndProc，如下所示：

```
#include "stdafx.h"
#include <Windows.h>
#using <System.Windows.Forms.dll>
#using <System.Drawing.dll>
#using <System.dll>

using namespace System;
using namespace System::ComponentModel;
using namespace System::Collections;
using namespace System::Windows::Forms;
using namespace System::Drawing;

namespace EXAMPLE
{
    public ref class Form1: public System::Windows::Forms::Form
    {
        public:
        Form1()
        {
            this->AutoScaleDimensions = System::Drawing::SizeF(6, 13);
            this->AutoScaleMode = System::Windows::Forms::AutoScaleMode::Font;
            this->ClientSize = System::Drawing::Size(GetSystemMetrics(SM_CXSCREEN)/2, GetSystemMetrics(SM_CYSCREEN)/2);
            this->FormBorderStyle = System::Windows::Forms::FormBorderStyle::Sizable;
            this->Name = L"Test";
            this->Text = L"Test";
            this->ResumeLayout(false);
        }
        protected:  virtual void WndProc(System::Windows::Forms::Message% m) override 
        {
            //Do stuff in here
            Form::WndProc(m);
        }
   };
}
[STAThreadAttribute]
int main()
{
    Application::Run(gcnew projector_fixer::Form1() );
    return 0;
} 
```

这很好用，但是因为我想让我的 main 尽可能干净，所以我决定创建“控制器类”，通过与 main 连接来处理所有事情。因此，例如，我不会在EXAMPLE命名空间中包含mouse_click的事件，而是在我的“控制器类”构造函数中包含被点击的对象并在这个类中处理它。这很容易，但是当想要覆盖 wndproc 时，我意识到我不知道该怎么做。我想它可能看起来像这样：

```
inside main

myclass ^MYCLASS=gcnew myclass(//some way to send wndproc override to function//);

MYCLASS.h

#pragma once

ref class MYCLASS
{
public:
    MYCLASS();
    overriden_wndproc(System::Windows::Forms::Message% m);
};

MYCLASS.cpp

MYCLASS::MYCLASS(//some way to send wndproc override to function//)
{
     overriden_wndproc=//some way to send wndproc override to function//;
}
MYCLASS::overriden_wndproc(System::Windows::Forms::Message% m)
{
     //Do stuff in here
     Form::WndProc(m);
} 
```

请注意，这只是我对看起来合乎逻辑的猜测版本。所有帮助将不胜感激。

彼得

我正在添加整个 wndproc，因为我坚信事件引发可能会变得棘手，因为我在我的函数中使用了 break。

```
protected:  virtual void WndProc(System::Windows::Forms::Message% m) override 
{
    System::Diagnostics::Debug::WriteLine(m);
    switch(hZoomSwitch)
    {
        case 0:
        {
            hScrollBar1->Value=0;
            hTimer->Stop();
            hZoomSwitch=2;
            break;
        }
        case 1:
        {
            hTimer->Start();
            hZoomSwitch=2;
            break;
        }
    }
    switch(vZoomSwitch)
    {
        case 0:
        {
            vScrollBar1->Value=0;
            vTimer->Stop();
            vZoomSwitch=2;
            break;
        }
        case 1:
        {
            vTimer->Start();
            vZoomSwitch=2;
            break;
        }
    }
    Form::WndProc(m);
} 
```

# c - 我可以在 C 结构中定义函数吗？

> ID：12642830
> 
> 赞同：58
> 
> 时间：2012-09-28T15:20:23.400
> 
> 标签：c, function, structure

我正在尝试将一些 C++ 代码转换为 C，但我遇到了一些问题。如何在结构内部定义函数？

像这样：

```
 typedef struct  {
    double x, y, z;
    struct Point *next;
    struct Point *prev;
    void act() {sth. to do here};
} Point; 
```

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-09-28T15:22:59.983

不，您不能`struct`在 C中的 a 中定义函数。

虽然你可以在 a 中拥有一个函数指针，`struct`但拥有一个函数指针与 C++ 中的成员函数非常不同，即没有`this`指向包含`struct`实例的隐式指针。

人为示例（在线演示[http://ideone.com/kyHlQ](http://ideone.com/kyHlQ)）：

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

struct point
{
    int x;
    int y;
    void (*print)(const struct point*);
};

void print_x(const struct point* p)
{
    printf("x=%d\n", p->x);
}

void print_y(const struct point* p)
{
    printf("y=%d\n", p->y);
}

int main(void)
{
    struct point p1 = { 2, 4, print_x };
    struct point p2 = { 7, 1, print_y };

    p1.print(&p1);
    p2.print(&p2);

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-28T15:29:45.743

不过，您可以在结构中拥有一个函数指针。但不是这样

你可以这样定义

**例子：**

```
typedef struct cont_func 
{
    int var1;
    int (*func)(int x, int y);
    void *input;
} cont_func;

int max (int x, int y)
{
    return (x > y) ? x : y;
}

int main () {
   struct cont_func T;

   T.func = max;
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-09-28T15:24:14.647

`C`不允许在`struct`. 您可以在结构中定义函数指针，如下所示：

```
typedef struct  {
  double x, y, z;
  struct Point *next;
  struct Point *prev;
  void (*act)();
} Point; 
```

每当您实例化`struct`.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-09-28T15:23:39.920

不，不可能在 C 中的结构内声明函数。

这是 C 和 C++ 之间的根本区别之一。

看到这个线程：[https ://web.archive.org/web/20121024233849/http://forums.devshed.com/c-programming-42/declaring-function-in-structure-in-c-545529.html](https://web.archive.org/web/20121024233849/http://forums.devshed.com/c-programming-42/declaring-function-in-structure-in-c-545529.html)

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-28T15:25:27.450

这个想法是在结构内放置一个指向函数的指针。然后在结构之外声明该函数。这与 C++ 中的类不同，其中函数在类中声明。

例如：从这里窃取代码：[https ://web.archive.org/web/20121024233849/http://forums.devshed.com/c-programming-42/declaring-function-in-structure-in-c- 545529.html](https://web.archive.org/web/20121024233849/http://forums.devshed.com/c-programming-42/declaring-function-in-structure-in-c-545529.html)

```
struct t {
    int a;
    void (*fun) (int * a);
} ;

void get_a (int * a) {
    printf (" input : ");
    scanf ("%d", a);
}

int main () {
    struct t test;
    test.a = 0;

    printf ("a (before): %d\n", test.a);
    test.fun = get_a;
    test.fun(&test.a);
    printf ("a (after ): %d\n", test.a);

    return 0;
} 
```

where `test.fun = get_a;`将函数分配给结构中的指针，并`test.fun(&test.a);`调用它。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-28T15:27:28.483

您只能在不同于 C++ 的 C 编程语言的结构中定义函数指针。

# html - 从不断变化的 id 中获取值

> ID：12642835
> 
> 赞同：0
> 
> 时间：2012-09-28T15:20:42.293
> 
> 标签：html, selenium, selenium-ide

我有许多测试可以验证搜索结果的排序顺序。除了一个特定的搜索之外，所有这些都可以正常工作。

问题在于，对于此搜索，每一行都有一个自动生成的 ID 编号，每次搜索时都会更改。

我可以做这个：

```
storeText | css=search_result_row_23668680919600 > td.normal.description | N1 
```

如果我正确地运行测试，那么它就会成功。但是，如果出现尾部，它会在任何后续时间运行，因为该行中的数字每次都会更改。

HTML 看起来像这样

```
<tr id="search_result_row_23668680919600">
 <td class="description">
   <a class="searchresultitem" href="/itemid"> Start of desription</a>
     <br>
       Rest of description
 </td> 
```

当每次运行搜索时该 id 更改时，如何使用该 id 获取该描述文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:11:26.707

与其取整个 id 值，不如取它的静态部分。

```
driver.findElement(By.cssSelector("tr[id*='search_result_row_']>td[class='description']")).getText(); 
```

每次都会返回**td的内容。**存储所有这些值，然后使用您的逻辑进行排序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T21:51:24.117

您可以尝试使用 xpath 定位器与 css 定位器

# solr - Solr 搜索在 2 个字段上进行减法

> ID：12642842
> 
> 赞同：0
> 
> 时间：2012-09-28T15:21:20.793
> 
> 标签：solr, field, subtraction

我想在 solr 中搜索大于特定数字的 2 个索引字段的减法。

例如，假设我有一个带有 field`(int) start`和 field的索引表`(int) end`，我希望 solr 找到所有带有`end-start > 100`.

如何用 solr 构造这样的查询？

像这样的东西：`?q=sub(end,start):[* TO *]`？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T09:30:24.793

您只需在索引时添加另一个字段减法，`end-start`然后使用`subtraction:[100 TO *]`

# ssrs-2008 - 有没有一种简单的方法可以在 SSRS 设计模式下重新排列 tablix 列？

> ID：12642844
> 
> 赞同：73
> 
> 时间：2012-09-28T15:21:24.290
> 
> 标签：ssrs-2008, reporting-services, ssrs-tablix

我有一个 SSRS 报告，它在 tablix 中包含 20 多列。我们的用户已经确定数据没问题，但他们希望列移动（*叹气！*）。

重新排列列似乎应该很容易（将第 3 列移动到第 1 列，交换第 4 列和第 5 列等）。但是，拖放似乎不起作用，唯一的解决方案似乎是删除原始列并将其重新插入到正确的位置（并重新应用已为该列创建的任何表达式和格式）。

有没有更简单的方法来做到这一点？请注意，我不需要编程解决方案，而只需要在设计模式下更改一次。

* * *

## 回答 #1

> 赞同：122
> 
> 时间：2014-04-12T19:39:54.983

有一种方法可以通过设计器移动列：

1.  在目标位置插入要移动的空白列数
2.  shift-左键单击要移动的单元格（不是标题列）
3.  右键单击并选择剪切命令
4.  右键单击目标列的顶部并选择粘贴
5.  删除现在空的旧列

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2012-09-30T22:23:45.390

如果您可以阅读 XML（只需了解标签的开始和/或结束位置等）​​，您就可以轻松完成任务。您可以采取以下一系列步骤：

1.  首先通过将原始报告复制到另一个文件来备份原始报告。
2.  在解决方案资源管理器中右键单击您的报告，然后选择“查看代码”
3.  这将打开报告的 RDL --- 不要害怕它只是一个简单的 xml 文件
4.  现在在 RDL 文件中找到“Tablix1”标签——查找 `<Tablix Name="Tablix1"> ....</Tablix >`
5.  您现在需要查找`<Textbox Name="...">...</Texbox>`嵌套在标签中的不同“”`<TablixCells><TablixCell><CellContents>....`标签
6.  现在，您可以通过简单地重新排列这些列的顺序轻松地重新排列报告的列，`<Textbox...>...</Texbox>`您将获得具有新列顺序的新报告。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-09-07T04:32:26.570

实际上，您需要移动（剪切和粘贴）`<TablixCell>`列的整个元素（以及之间的所有内容`<TablixCell>`，`</TablixCell>`包括`<TablixCell>`and`</TablixCell>`标记本身）。

例如，要重新排列下面示例中的列以使“产品 ID”列位于“产品名称”列**之前**，您将选择并剪切“产品名称”单元元素周围的整个部分（从第一个`<TablixCell>`到第first `</TablixCell>`) 然后将其粘贴到“ProductID”列**之后**`</TablixCell>`。
请注意，Tablix 中定义的每一行都有一套完整的`<TablixCell>`元素；每一个都在一个单独的`<TablixRow>`元素中。如果您保留默认标题列（设置列名的位置），则第一个`<TablixRow>`定义标题行，第二个定义列中的数据，它是您要编辑的数据。重新排列数据列后，您需要对标题列执行相同的操作（如果有），或者只需使用设计器重命名列以匹配列中的数据。

确实，这太复杂了，只需使用设计器在您希望将列移动到的位置插入新列，使用该列的正确数据源设置它，然后删除原始列，移动列可能更容易. 对于下面的示例，您将在**Product ID**之后插入一个新列，将其设置为**ProductName**数据源列（在标题行中将其设置为“Product Name”），然后删除左侧的原始**Product Name列。**

```
...
<TablixCell>
  <CellContents>
    <Textbox Name="ProductName">
      <CanGrow>true</CanGrow>
      <KeepTogether>true</KeepTogether>
      <Paragraphs>
        <Paragraph>
          <TextRuns>
            <TextRun>
              <Value>=Fields!ProductName.Value</Value>
              <Style />
            </TextRun>
          </TextRuns>
          <Style />
        </Paragraph>
      </Paragraphs>
      <rd:DefaultName>ProductName</rd:DefaultName>
      <Style>
        <Border>
          <Color>LightGrey</Color>
          <Style>Solid</Style>
        </Border>
        <PaddingLeft>2pt</PaddingLeft>
        <PaddingRight>2pt</PaddingRight>
        <PaddingTop>2pt</PaddingTop>
        <PaddingBottom>2pt</PaddingBottom>
      </Style>
    </Textbox>
  </CellContents>
</TablixCell>
<TablixCell>
  <CellContents>
    <Textbox Name="ProductID">
      <CanGrow>true</CanGrow>
      <KeepTogether>true</KeepTogether>
      <Paragraphs>
        <Paragraph>
          <TextRuns>
            <TextRun>
              <Value>=Fields!ProductID.Value</Value>
              <Style />
            </TextRun>
          </TextRuns>
          <Style />
        </Paragraph>
      </Paragraphs>
      <rd:DefaultName>ProductID</rd:DefaultName>
      <Style>
        <Border>
          <Color>LightGrey</Color>
          <Style>Solid</Style>
        </Border>
        <PaddingLeft>2pt</PaddingLeft>
        <PaddingRight>2pt</PaddingRight>
        <PaddingTop>2pt</PaddingTop>
        <PaddingBottom>2pt</PaddingBottom>
      </Style>
    </Textbox>
  </CellContents>
</TablixCell>
... 
```

剪切/粘贴后，您将得到：

```
...
<TablixCell>
  <CellContents>
    <Textbox Name="ProductID">
      <CanGrow>true</CanGrow>
      <KeepTogether>true</KeepTogether>
      <Paragraphs>
        <Paragraph>
          <TextRuns>
            <TextRun>
              <Value>=Fields!ProductID.Value</Value>
              <Style />
            </TextRun>
          </TextRuns>
          <Style />
        </Paragraph>
      </Paragraphs>
      <rd:DefaultName>ProductID</rd:DefaultName>
      <Style>
        <Border>
          <Color>LightGrey</Color>
          <Style>Solid</Style>
        </Border>
        <PaddingLeft>2pt</PaddingLeft>
        <PaddingRight>2pt</PaddingRight>
        <PaddingTop>2pt</PaddingTop>
        <PaddingBottom>2pt</PaddingBottom>
      </Style>
    </Textbox>
  </CellContents>
</TablixCell>
<TablixCell>
  <CellContents>
    <Textbox Name="ProductName">
      <CanGrow>true</CanGrow>
      <KeepTogether>true</KeepTogether>
      <Paragraphs>
        <Paragraph>
          <TextRuns>
            <TextRun>
              <Value>=Fields!ProductName.Value</Value>
              <Style />
            </TextRun>
          </TextRuns>
          <Style />
        </Paragraph>
      </Paragraphs>
      <rd:DefaultName>ProductName</rd:DefaultName>
      <Style>
        <Border>
          <Color>LightGrey</Color>
          <Style>Solid</Style>
        </Border>
        <PaddingLeft>2pt</PaddingLeft>
        <PaddingRight>2pt</PaddingRight>
        <PaddingTop>2pt</PaddingTop>
        <PaddingBottom>2pt</PaddingBottom>
      </Style>
    </Textbox>
  </CellContents>
</TablixCell>
... 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-07T20:35:58.733

在 RDL 中工作的另一个注意事项：
如果您弄错了，报告将显示错误消息并且不会显示数据。

除非您熟悉 RDL（报表定义语言，一种 XML），否则这些类型的错误在处理有时会导致报表无法使用时会非常令人沮丧。

使用上面提到的设计器中的添加新列和删除旧列的方法要安全得多。这使您远离 RDL，从而减少损坏报告的机会。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-06T17:01:13.443

我今天遇到这种情况，因为我试图通过拖动 tablix 的列标题来重新排序列，它不起作用！但是，我发现可以拖动一个单元格并（小心地）将其放在另一个单元格上，然后单元格交换。这样，您可以通过交换标题和内容单元格来重新排列列，而无需创建新的空列，如果您不希望报表正文宽度增加并在 PDF 渲染中产生空页面，这会更好，当然它可以修复再次。要拖动单元格，请单击单元格但不要进入编辑模式，然后将鼠标悬停在边框周围并在获得“移动”光标后拖动。这适用于 Visual Studio 2017 可用的报表设计器。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-13T13:43:58.957

我的解决方案：

```
using System;
using System.IO;
using System.Linq;
using System.Xml;

namespace MoveSsrsColumns
{
    class TablixColumnReorderer
    {
        readonly XmlDocument _xData = new XmlDocument();
        readonly XmlNamespaceManager _nsManager;
        readonly XmlElement _tablixNode;

        public TablixColumnReorderer(string rdlFileName, string tablixName)
        {
            using (var fs = new FileStream(rdlFileName, FileMode.Open))
            using (var xr = XmlReader.Create(fs))
                _xData.Load(xr);
            _nsManager = new XmlNamespaceManager(_xData.NameTable);
            _nsManager.AddNamespace("def", "http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition");
            _tablixNode =
                _xData.SelectNodes(string.Format(TablixXPath, tablixName)_nsManager)
                ?.Cast<XmlElement>().FirstOrDefault()
                ?? throw new ApplicationException("Tablix node notfound");
        }

        const string TablixXPath = @"
            /def:Report
                /def:ReportSections
                    /def:ReportSection
                        /def:Body
                            /def:ReportItems
                                /def:Tablix[@Name='{0}']";

        const string SearchColumnXPath = @"
            def:TablixBody
                /def:TablixRows
                    /def:TablixRow
                        /def:TablixCells
                            /def:TablixCell
                                /def:CellContents
                                    /def:*[@Name='{0}']";

        const string ParentTablixCellXPath = "parent::def:CellContents/parent::def:TablixCell";

        int FindColumn(string columnControlName)
        {
            var columnControl = _tablixNode
                .SelectNodes(string.Format(SearchColumnXPath, columnControlName), _nsManager)
                ?.Cast<XmlElement>()
                .Single();
            if (columnControl==null)
                throw new ArgumentException($"Column with control {columnControlName} notfound");
            if (!(columnControl.SelectSingleNode(ParentTablixCellXPath, _nsManager) is XmlElement tablixCell))
                throw new ArgumentException($"Tablix cell for column with control {columnControlName} notfound");
            var columnIndex = ((XmlElement) tablixCell.ParentNode)
                ?.ChildNodes
                .Cast<XmlElement>()
                .TakeWhile(e=>e!=tablixCell)
                .Count() ?? -1;
            if (columnIndex==-1)
                throw new ArgumentException($"Cannot get index for column with control {columnControlName}");
            return columnIndex;
        }

        public void SetPosition(string sourceColumnControlName, string destinationColumnControlName)
        {
            SetPosition(FindColumn(sourceColumnControlName), FindColumn(destinationColumnControlName));
        }

        public void SetPosition(string sourceColumnControlName, int destinationColumnIndex)
        {
            SetPosition(FindColumn(sourceColumnControlName), destinationColumnIndex);
        }

        public void SetPosition(int sourceColumnIndex, string destinationColumnControlName)
        {
            SetPosition(sourceColumnIndex, FindColumn(destinationColumnControlName));
        }

        const string TablixCellsXPath = "def:TablixBody/def:TablixColumns";
        const string TablixRowCellsXPath = "def:TablixBody/def:TablixRows/def:TablixRow/def:TablixCells";
        public void SetPosition(int sourceColumnIndex, int destinationColumnIndex)
        {
            var tablixColumnsNode = _tablixNode
                .SelectSingleNode(TablixCellsXPath, _nsManager) as XmlElement
                ?? throw new ApplicationException("TablixColumns node notfound");
            tablixColumnsNode.InsertBefore(
                tablixColumnsNode.ChildNodes[sourceColumnIndex],
                tablixColumnsNode.ChildNodes[destinationColumnIndex]
            );
            var tablixRowsCells = _tablixNode
                .SelectNodes(TablixRowCellsXPath, _nsManager)
                ?.Cast<XmlElement>()
                ?? throw new ApplicationException("Tablix rows cells notfound");
            foreach (var cells in tablixRowsCells)
                cells.InsertBefore(
                    cells.ChildNodes[sourceColumnIndex],
                    cells.ChildNodes[destinationColumnIndex]
                );
        }

        public void Save(string rdlFileName)
        {
            using (var fs = new FileStream(rdlFileName, FileMode.Create))
            using (var xw = XmlWriter.Create(fs, new XmlWriterSettings
            {
                Indent = true,
                IndentChars = "  "
            }))
                _xData.Save(xw);
        }
    }
} 
```

用法：

```
public static void Main(string[] args)
{
    var tcr = new TablixColumnReorderer("myreport.rdl", "Tablix1");
    tcr.SetPosition("bill_number", 0);
    tcr.SetPosition("account", 1);
    tcr.SetPosition("to_date", 2);
    tcr.Save("myreport#2.rdl");
    Console.WriteLine("done");
    Console.ReadKey(true);
} 
```

# ios - UIView 翻转过渡时烦人的 Flash

> ID：12642847
> 
> 赞同：0
> 
> 时间：2012-09-28T15:21:39.487
> 
> 标签：ios, graphics

我正在尝试使用 UIView.transitionFromView:toView: 在视图 A-1 和背面视图 A-2 之间进行翻转过渡。这些视图有许多同级视图，并且由于我不希望整个超级视图旋转，因此我将一个临时容器视图插入到视图层次结构中，该视图足够大以包含 A-1 和 A-2 并插入 A-1在过渡之前立即进入。

问题是视图 A-1 在过渡开始后立即消失，并带有难看的闪光，这很难看。我认为当我将它插入临时容器视图时它可能会消失（因为将它添加到容器中会隐式地将其从其正常的超级视图中删除），但据我所知，它不会在那时发生。我正在使用的代码如下所示：

```
[container addSubview:fromView];
[self.view addSubview:container];

[UIView transitionFromView:fromView toView:toView duration:2
                   options:UIViewAnimationOptionTransitionFlipFromRight
                   ... ]; 
```

我在完成例程中解开并删除了容器，我没有在这里显示，因为在代码执行之前会出现闪存问题。

我是否必须在 CALayer 级别执行此操作以避免此问题？我是否误解了视图到视图的转换应该如何工作？任何想法将不胜感激，霍华德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T13:59:40.650

知道了！我应该知道，因为我过去曾被这个咬过（并且愚蠢地认为我再也不会犯同样的错误了。:-) 这都是关于那个神奇的“重绘时刻”的事情——在插入临时容器之后进入层次结构并将“fromView”移动到容器中，您需要调用

```
[self performSelector:@selector(doAnimation:) withObject:transitionInfo afterDelay(0)] 
```

回到主运行循环，以便更新的层次结构可以在您实际执行动画之前重绘自身。“transitionInfo”参数只是一个字典，用于将“fromView”和“toView”参数传递给动画例程。

霍华德

# java - 图像未加载

> ID：12642852
> 
> 赞同：1
> 
> 时间：2012-09-28T15:22:07.053
> 
> 标签：java, image, swing, frame, paintcomponent

框架窗口正在启动，但没有加载背景和前景图像，并且窗口框架大小也非常小。请帮我修复错误。

这是发布的代码

# 水族馆.java

```
import java.awt.*;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.awt.image.BufferedImage;
import java.awt.image.ImageObserver;
import java.util.Vector;

public class Aquarium extends Frame implements Runnable
{
    Image aquariumImage,memoryImage;
    BufferedImage bImage;
    Graphics memoryGraphics;
    Image [] fishImages=new Image[2];
    MediaTracker tracker;
    int numberFishes=12;
    Vector<Fish> fishes=new Vector<Fish>();
    Thread thread;
    boolean runOk=true;
    int sleepTime=110;
    Fish fish;

    Aquarium()
    {

        //set the title and assign tracker object
        setTitle("The Aquarium ");
        tracker=new MediaTracker(this);

        //add images to the tracker object to trace it

        fishImages[0]=Toolkit.getDefaultToolkit().getImage("src\fish1.gif");

        tracker.addImage(fishImages[0], 0);

        System.out.println("fish 1 size "+Toolkit.getDefaultToolkit().getImage("src\fish1.gif").getWidth(null));
        fishImages[1]=Toolkit.getDefaultToolkit().getImage("src\fish2.gif");

        tracker.addImage(fishImages[1], 0);
        aquariumImage =Toolkit.getDefaultToolkit().getImage("src\bubbles.gif");

        tracker.addImage(aquariumImage,0);

        setResizable(true);

        setVisible(true);

        //assign memory to the graphics and anotherImage object

        int dx=getSize().width;
        int dy=getSize().height;
        System.out.println("x value is "+dx+ " dy value is "+ dy);

        bImage=new BufferedImage(dx, dy,BufferedImage.TYPE_INT_ARGB);

        try
        {
        memoryGraphics=bImage.getGraphics();

        }
        catch(Exception exc)
        {
            System.out.println(exc.getCause());
            System.out.println(exc.getStackTrace());
        }
        //create a new thread and start the thread

        thread=new Thread();
        thread.start();

        try
        {
            tracker.waitForID(0);
        }
        catch (Exception ex) {
            System.out.println(ex.getMessage());
        }

        setSize(aquariumImage.getWidth(this),aquariumImage.getHeight(this));

        this.addWindowListener(new WindowAdapter() {
            public void windowClosing(WindowEvent we)
            {
                System.exit(0);
                runOk=false;
            }
        });
    }

    public static void main(String ar[])
    {
        new Aquarium();
    }

    @Override
    public void run() 
    {

        //draw 4 edges of rectangle

        Rectangle edges=new Rectangle(0+getInsets().left,0+getInsets().top,
                                        getSize().width-(getInsets().left+getInsets().right),
                                        getSize().height-(getInsets().top+getInsets().bottom));

        //add fishes to the fishes vector

        for (int loopIndex=0; loopIndex<numberFishes;loopIndex++)
        {
            fishes.add(new Fish(fishImages[0],fishImages[1],edges,this));
            try
            {
                Thread.sleep(20);
            }
            catch (Exception e) {
                System.out.println(e.getMessage());

            }
        }

        while(runOk)
        {
            for(int loopIndex=0; loopIndex < numberFishes; loopIndex++)
            {
                fish=(Fish)fishes.elementAt(loopIndex);
                fish.swim();
            }

            try
            {
                Thread.sleep(sleepTime);
            }
            catch (Exception e) {
                System.out.println(e.getMessage());
            }
            repaint();
        }

    }
    public void update(Graphics g)
    {
        memoryGraphics.drawImage(aquariumImage, 0, 0, this);

        for(int loopIndex=0;loopIndex<numberFishes;loopIndex++)
        {
            ((Fish)fishes.elementAt(loopIndex)).drawFishImage(memoryGraphics);
        }
        g.drawImage(bImage, 0, 0, this);
    }
} 
```

# 鱼.java

```
import java.awt.*;
import java.util.Random;

public class Fish {

    Component tank;
    Image image1,image2;
    Point location,velocity;
    Rectangle edges;
    Random random;

    public Fish(Image image1,Image image2, Rectangle edges,Component tank) {
        random = new Random(System.currentTimeMillis());
        this.tank=tank;
        this.image1=image1;
        this.image2=image2;
        this.edges=edges;           
        this.location=new Point(100+ (Math.abs(random.nextInt())%300),
            100+Math.abs(random.nextInt())%100));    
        this.velocity=new Point(random.nextInt()%8,random.nextInt()%8);
    }

    public void swim() {

        //determine the optimum velocity to make the fish swim

        if(random.nextInt()%7<=1) {
            velocity.x += random.nextInt() % 4 ;
            velocity.x = Math.min(velocity.x, 8);
            velocity.x = Math.max(velocity.x, -8);
            velocity.y += random.nextInt() % 4;             
            velocity.y =  Math.min(velocity.y, 8);
            velocity.y = Math.max(velocity.y, -8);
        }

        //add the velocity to the location of the fish to make it move

        location.x += velocity.x;
        location.y += velocity.y;

        if(location.x < edges.x) {
            location.x=edges.x;
            velocity.x = -velocity.x;
        }

        if((location.x + image1.getWidth(tank)) > (edges.x + edges.width)) {
            location.x = edges.x + edges.width - image1.getWidth(tank);
            velocity.x = -velocity.x;
        }

        if(location.y < edges.y) {
            location.y = edges.y;
            velocity.y = -velocity.y;
        }

        if((location.y + image1.getHeight(tank)) > (edges.y + edges.height)) {
            location.y = edges.y + edges.height - image1.getHeight(tank);
            velocity.y = -velocity.y;
        }
    }

    public void drawFishImage(Graphics g) {
        if(velocity.x < 0) {
                g.drawImage(image1,location.x,location.y,tank);             
        }           
        else {
            g.drawImage(image2, location.x, location.y, tank);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T22:39:52.207

我很抱歉这么说，但你的代码有很多问题......

让我们从：

*   不要覆盖`paint`顶级容器的任何方法。首先，没有一个顶级容器是双缓冲的。
*   使用轻量级组件而不是重量级组件（使用`JFrame`代替`Frame`，使用`JPanel`代替`Panel`）...
*   出于与上述相同的原因，`JPanel`用作您的绘画表面而不是......`Frame`
*   如前所述，您的线程代码什么也没做（`new Thread().start()`）。
*   你没有绘制代码​​来将鱼实际绘制到屏幕上（是的，你的鱼有绘制代码​​，但没有调用它）。
*   您的随机数生成器不起作用。我让所有的鱼在同一个地方游来游去……
*   你的图像加载代码是错误的。[`ImageIO`](http://docs.oracle.com/javase/tutorial/2d/images/loadimage.html)改为使用
*   不要直接存储矩形引用。问题是，如果调整窗口大小，鱼可以游泳的可用范围将会改变，即使它们被包含在水族箱的范围内，水族箱的位置也可能发生了变化。
*   如前所述，您的图像路径不正确。您永远不会包含`src`在任何路径中。一旦部署，`src`路径将不再存在。

这是我的看法...

![鱼腥味](../Images/6ebb46c8cee971af423f69183ddb1c53.png)

## 水族馆

```
public class Aquarium extends JPanel {

    public static final int NUMNBER_OF_FISHIES = 12;

    private BufferedImage masterFish;
    private Vector<Fish> fishes = new Vector<Fish>(NUMNBER_OF_FISHIES);
    private int sleepTime = 110;

    public Aquarium() {

        //set the title and assign tracker object

        try {
            masterFish = ImageIO.read(getClass().getResource("/gnome_panel_fish.png"));
        } catch (IOException iOException) {
            iOException.printStackTrace();
        }

        // This is a little cheat which means you only ever need one fish image
        // Basically it will flip the master along it's horizontal axies ;)
        BufferedImage flippedMaster = new BufferedImage(masterFish.getWidth(), masterFish.getHeight(), masterFish.getType());
        Graphics2D g2d = flippedMaster.createGraphics();
        g2d.setTransform(AffineTransform.getScaleInstance(-1, 1));
        g2d.drawImage(masterFish, -masterFish.getWidth(), 0, this);
        g2d.dispose();

        for (int index = 0; index < NUMNBER_OF_FISHIES; index++) {
            fishes.add(new Fish(masterFish, flippedMaster, this));
        }

        Thread background = new Thread(new Background());
        background.setDaemon(true);
        background.start();

    }

    public static void main(String ar[]) {

        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {

                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException classNotFoundException) {
                } catch (InstantiationException instantiationException) {
                } catch (IllegalAccessException illegalAccessException) {
                } catch (UnsupportedLookAndFeelException unsupportedLookAndFeelException) {
                }

                JFrame frame = new JFrame("The Aquarium ");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new Aquarium());
                frame.setSize(400, 400);
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

            }
        });
    }

    @Override
    protected void paintComponent(Graphics g) {

        super.paintComponent(g);

        for (Fish fish : fishes) {
            fish.drawFishImage(g);
        }

    }

    protected class Background implements Runnable {

        @Override
        public void run() {

            while (true) {

                for (Fish fish : fishes) {
                    fish.swim();
                }

                try {
                    Thread.sleep(sleepTime);
                } catch (Exception e) {
                    System.out.println(e.getMessage());
                }
                repaint();
            }
        }
    }
} 
```

## 鱼

```
public class Fish {

    private Component tank;
    private Image image1, image2;
    private Point location, velocity;
    private Random random;

    public Fish(Image image1, Image image2, Component tank) {
        random = new Random();
        this.tank = tank;
        this.image1 = image1;
        this.image2 = image2;
        this.location = new Point(
                        100 + (Math.abs(random.nextInt()) % 300),
                        100 + Math.abs(random.nextInt()) % 100);
        this.velocity = new Point(random.nextInt() % 8, random.nextInt() % 8);
        System.out.println(location);
    }

    public void swim() {

        Rectangle edges = tank.getBounds();

        //determine the optimum velocity to make the fish swim

        if (random.nextInt() % 7 <= 1) {
            velocity.x += random.nextInt() % 4;
            velocity.x = Math.min(velocity.x, 8);
            velocity.x = Math.max(velocity.x, -8);
            velocity.y += random.nextInt() % 4;
            velocity.y = Math.min(velocity.y, 8);
            velocity.y = Math.max(velocity.y, -8);
        }

        //add the velocity to the location of the fish to make it move

        location.x += velocity.x;
        location.y += velocity.y;

        if (location.x < edges.x) {
            location.x = edges.x;
            velocity.x = -velocity.x;
        }

        if ((location.x + image1.getWidth(tank)) > (edges.x + edges.width)) {
            location.x = edges.x + edges.width - image1.getWidth(tank);
            velocity.x = -velocity.x;
        }

        if (location.y < edges.y) {
            location.y = edges.y;
            velocity.y = -velocity.y;
        }

        if ((location.y + image1.getHeight(tank)) > (edges.y + edges.height)) {
            location.y = edges.y + edges.height - image1.getHeight(tank);
            velocity.y = -velocity.y;
        }
    }

    public void drawFishImage(Graphics g) {
        if (velocity.x < 0) {
            g.drawImage(image1, location.x, location.y, tank);
        } else {
            g.drawImage(image2, location.x, location.y, tank);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T17:14:18.573

在您的代码存在的几个问题中，有两个比较突出：

*   您创建了一个“方法什么都不做并返回”`Thread`的新方法。`Runnable`相反，在构造函数中提供您的实现：

    ```
    //create a new thread and start the thread
    thread = new Thread(this);
    thread.start(); 
    ```

*   您已标记您的问题[swing](/questions/tagged/swing "显示标记为“摇摆”的问题")，其对象应*仅*在[事件调度线程](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html)上构造和操作。代替`Runnable`，使用 的实例`javax.Swing.Timer`，如图[所示](https://stackoverflow.com/a/8616169/230513)。

附录：您的绘图表面应`JComponent`为`JPanel`. 由于它本身不包含任何组件，因此您可以按照[此处](https://stackoverflow.com/a/10110232/230513)`getPreferredSize()`所示和封闭的方式覆盖以获取正确的尺寸。`pack()``Window`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:27:12.097

这是因为您似乎正在使用相对路径。作为测试，使用硬编码路径。一旦它工作，你可以改变它的上下文。

# scala - 当我使用 (...)(...) 函数时参数太多

> ID：12642855
> 
> 赞同：2
> 
> 时间：2012-09-28T15:22:25.663
> 
> 标签：scala

在学习了不同的编程语言（主要是解释性的）之后，我正在学习 Scala。我正在做以下练习，但出现错误。

```
def sum(f: Int => Int)(a: Int, b: Int): Int = {
    def loop(a: Int, acc: Int): Int = {
      if (a >= b) acc
      else loop(a+1, f(a) + acc)
    }
    loop(a, 0)
 }
 sum(x => x * x, 2, 4) //Too many arguments 
```

我看不出那里有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:25:08.327

如果你用多个括号（多个参数列表）声明你的函数，你还必须这样调用它（咖喱形式）：

```
sum(x => x * x)(2, 4) 
```

请参阅[Scala中的多个参数列表和每个列表的多个参数之间有什么区别？](https://stackoverflow.com/q/6803211/1374678)了解更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T15:24:33.663

该函数必须以显式柯里化形式调用（必须有更好的名称），因为它是这样定义的：

```
sum(x => x * x)(2, 4)

//def sum (f: Int => Int) (a: Int, b: Int):
//    sum (x => x * x)    (2,      4) 
```

但这也很简洁，因为一次只需要评估柯里化形式的一部分：

```
val sumOfSquares = sum(x => x * x)
val s = someOfSquares(2,4) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T15:24:27.927

您已经定义`sum`了[两个参数列表](http://docs.scala-lang.org/style/declarations.html#multiple_parameter_lists)，但试图只用一个来调用它。

调用它的语法正确的方法是`sum(x => x * x)(2, 4)`

# javascript - jQuery - 让 .animate 和 .html 玩得很好

> ID：12642859
> 
> 赞同：0
> 
> 时间：2012-09-28T15:22:45.893
> 
> 标签：javascript, jquery, html, internet-explorer-8

我试图不嵌套这些语句：

```
$('#capePowerpoint').animate({"right": "+=498px"}, 1000);
$('#capePowerPointContainer').html(capTabArray[capTabCounter][capabilitiesCounter]);
$('#capePowerpoint').animate({"right": "-=996px"}, 0);
$('#capePowerpoint').animate({"right": "+=498px"}, 1000); 
```

如果我注释掉 .html 行或 .animate 行，它们可以正常工作，但是当我尝试像这样组合它们时，它们只会从 div 中删除所有内容。而不是将 div 滚动到屏幕上替换它，然后从另一侧滚动回来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:24:58.793

您需要在`animate`调用中声明回调方法！

```
$('#capePowerpoint').animate({"right": "+=498px"}, {duration:1000,complete:function(){
    $('#capePowerPointContainer').html(capTabArray[capTabCounter][capabilitiesCounter]);
    $('#capePowerpoint').animate({"right": "-=996px"}, {duration:0,complete:function(){
        $('#capePowerpoint').animate({"right": "+=498px"}, 1000);
    });
}); 
```

查看更多：[http ://api.jquery.com/animate/](http://api.jquery.com/animate/)

如果你太喜欢 jQuery`animate`方法，像我一样（我讨厌它），请参阅 GreenSock 的 TweenLite 库：

[http://www.greensock.com/v12/](http://www.greensock.com/v12/)

编辑：您应该保存元素而不是到处查询

```
var cape = $('#capePowerpoint'), container = $('#capePowerPointContainer');
cape.animate({"right": "+=498px"}, {duration:1000,complete:function(){
    container.html(capTabArray[capTabCounter][capabilitiesCounter]);
    cape.animate({"right": "-=996px"}, {duration:0,complete:function(){
        cape.animate({"right": "+=498px"}, 1000);
    });
}); 
```

# java - 在调试期间禁用/防止编辑（Eclipse）

> ID：12642864
> 
> 赞同：2
> 
> 时间：2012-09-28T15:23:02.150
> 
> 标签：java, eclipse, debugging, editor

**一些背景信息：**
我目前正在使用 Eclipse Juno 调试一个用 java 编写的游戏。该游戏使用“wasd”进行导航。
当我调试这个游戏（带有一些断点）时，经常会发生，我在我的源文件中写“wwww”。这真的很烦人。

**所以这是我的问题：**
如何在调试期间禁用/防止编辑？（就像在 Visual Studio 中一样）。
我查看了“文本编辑器设置”和“调试设置”，但找不到该选项。

如果没有这样的选项，是否有一个 Eclipse 插件可以为我做到这一点？

最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T12:23:52.380

据我所知，没有办法完全做到这一点。您最好的选择是不要将文本光标留在源代码中，方法是单击源代码外部（在任何其他 Eclipse 面板上）并从那里调试游戏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-10T00:44:34.163

如果您喜欢 VIM，另一种选择是使用 vrapper。与普通模式下的 VIM 类似，默认情况下会禁用编辑。

github链接：[https ://github.com/vrapper/vrapper](https://github.com/vrapper/vrapper)

# entity-framework - 带实体框架的 SSIS

> ID：12642866
> 
> 赞同：0
> 
> 时间：2012-09-28T15:23:16.753
> 
> 标签：entity-framework, ssis, ssis-data-flow

我正在使用非规范化的 Access DB 并将其移动到基于 EF 4 的 SQL 中的规范化表中。

假设我在 Access DB 中有以下内容

```
-------------------
|  NAME  | FRUIT  |
-------------------
| John   | Apple  |
| Jane   | Apple  |
| Mark   | Orange |
| Nancy  | Orange |
| Jim    | Apple  |
------------------- 
```

我在 SQL 中创建以下两个数据库

名称：

```
-------------------------------
|   ID   |  Name  |  FruitID  |
-------------------------------
|    1   |  John  |     1     |
|    2   |  Jane  |     1     |
|    3   |  Mark  |     2     |
|    4   |  Nancy |     2     |
|    5   |  Jim   |     1     |
------------------------------- 
```

tbl水果：

```
--------------------
|   ID   |  Fruit  |
--------------------
|    1   |  Apple  |
|    2   |  Orange |
-------------------- 
```

在我的数据流中，我可以使用派生列提取名称（表实际上更大，我正在做一些数据类型转换）。但是，如何从派生列获取输出，并将每一行的输出与 fruits 表的正确 ID 匹配，从而产生需要插入 tblNames 数据库的正确输出？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:50:13.193

假设在填充 tblNames 的数据流之前已经填充了 tblFruits，您需要将[查找转换](http://msdn.microsoft.com/en-us/library/ms141821.aspx)添加到序列中，以便您可以检索给定水果的正确 tblFruits.ID。

您没有指定您使用的是哪个版本的 SSIS，但需要注意的是它希望始终在目标表中找到匹配项。在 2005 年，找不到匹配项与表不存在或您缺乏权限的错误相同，这很痛苦。2008+ 允许您识别在目标表中未找到匹配项的行。

使用查找时要记住的最重要的事情是，您应该只拉回您需要的列。表格选择器很方便，但不要偷懒并单击它。它会消耗比你需要的更多的资源，而你所知道的只是“SSIS 速度太慢而且是垃圾”。

其他有用且未经询问的建议是不要在派生列中执行太多操作。相反，请使用具有紧密焦点的多个派生列。听起来违反直觉，但 SSIS 引擎可以通过这种方式更好地并行化操作。

*   [通过将同步转换拆分为多个任务来提高管道的吞吐量](http://sqlcat.com/sqlcat/b/technicalnotes/archive/2010/08/18/increasing-throughput-of-pipelines-by-splitting-synchronous-transformations-into-multiple-tasks.aspx)
*   [调查：组件的不同组合会影响 Dataflow 性能吗？](http://sqlblog.com/blogs/jamie_thomson/archive/2011/01/12/investigation-can-different-combinations-of-components-effect-dataflow-performance.aspx)

我不确定 EF 标签是如何应用的，但也许我错过了问题的一些细微差别。

# .net - 未部署网络时无法访问 ClickOnce 数据目录

> ID：12642867
> 
> 赞同：0
> 
> 时间：2012-09-28T15:23:18.237
> 
> 标签：.net, deployment, windows-7, clickonce, appdomain

我正在测试我的 clickonce 部署（WPF、.Net 4），但我似乎无法访问数据目录。该应用程序已安装并且可以脱机运行，因此我需要一种在 !ApplicationDeployment.IsNetworkDeployed 时访问数据目录的方法

我的清单是正确的，并且数据文件被标记为这样。该文件确实被复制到 C:\Users\MyUserAccount\AppData\Local\Apps\2.0\Data... 的 Data 目录中（Windows 7）

我试过了：

```
Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData) 
```

和

```
Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData) 
```

...这两个函数都不返回任何内容，也不会抛出任何错误。我可以检索应用程序的 BaseDirectory，但这无助于我获取数据文件。

数据文件是[posdm.exe](http://msdn.microsoft.com/en-us/library/aa459292%28v=winembedded.11%29.aspx)。我需要一个 .Net 的 POS 实用程序，以便我可以在连接到 POS 机的硬件上设置默认值。我只需要弄清楚如何从已安装的数据目录中访问它。

**编辑**

似乎它与我创建的单独 AppDomain 有关。它没有从主 AppDomain 中提取 ApplicationDeployment 属性

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T12:59:53.730

我已将应用程序主 AppDomain 变量传递给我创建的单独 AppDomain。我创建的 AppDomain 与主 AppDomain 的值不同：

```
ApplicationDeployment.CurrentDeployment.DataDirectory
ApplicationDeployment.IsNetworkDeployed 
```

# javascript - HTML/Javascript Checkbox 在检查后取消选中一次无法正常工作

> ID：12642871
> 
> 赞同：0
> 
> 时间：2012-09-28T15:23:49.407
> 
> 标签：javascript, checkbox

我有一段代码在循环中的表格中创建复选框并调用它们的 onclick 函数。在 onclick 函数中，我尝试填充一个全局数组，该数组将成为表格选中复选框的位置持有者。此外，如果选中一行，我必须对该行的文本字段中的数字求和（我将其添加到变量百分比中），如果变量超过 100，我必须提醒用户并要求他在复选框中输入值使得总和小于 100。

发生的事情是，当百分比> 100 时，它会引发警报（我已添加）。如果有 3 个复选框的值为 34、56、10，并且如果这 3 个被选中，它让我提交一个提交按钮。但是如果我返回并取消选中 10 的行，它会发出警报说 percantage 是 110（应该是 90）

我该如何解决这个问题？

代码：

```
 var tabId = document.getElementById("AmnestyTransTbl");
    var tabrows = tabId.getElementsByTagName('tr');

    var percentage = 0,
        c, n;
    var ar = [];
    for (var i = 1, c = 2; i <= tabrows.length - 3; i++, c = c + 2) {
        // Create CheckBox
        ar[i] = c;
        var checkBox = document.createElement("input");
        checkBox.setAttribute("type", "checkbox");
        checkBox.id = 'CB'.concat(i);
        checkBox.onclick = function () {

            var tabId1 = document.getElementById("AmnestyTransTbl");
            var rowInd = getRowIndex(this);

            CBValue[rowInd] = this.checked;
            n = ar[rowInd - 1];
            percentage = (parseInt(percentage) + parseInt(tabId1.getElementsByTagName("input")[n].value));
            if (parseInt(percentage) > 100) {
                alert("Amnesty Percentage," + percentage + ", greater than 0!. Plesase check again.");
                this.checked = false;
            }
            if (this.checked == false) percentage = parseInt(percentage) - parseInt(tabId1.getElementsByTagName("input")[n].value);
        }
    }
    var td = document.createElement("td");
    td.appendChild(checkBox);
    tabrows[i + 1].cells[1].appendChild(td);
    }

    function getRowIndex(el) {
        while ((el = el.parentNode) && el.nodeName.toLowerCase() != 'tr');
        if (el) return el.rowIndex;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:47:39.900

试试这个代码......

```
 var tabId = document.getElementById("AmnestyTransTbl");
    var tabrows = tabId.getElementsByTagName('tr');

    var percentage = 0,
        c, n;
    var ar = [];
    for (var i = 1, c = 2; i <= tabrows.length - 3; i++, c = c + 2) {
        // Create CheckBox
        ar[i] = c;
        var checkBox = document.createElement("input");
        checkBox.setAttribute("type", "checkbox");
        checkBox.id = 'CB'.concat(i);
        checkBox.onclick = function () {

            var tabId1 = document.getElementById("AmnestyTransTbl");
            var rowInd = getRowIndex(this);

            CBValue[rowInd] = this.checked;
            n = ar[rowInd - 1];
            if (this.checked == false)
                percentage = parseInt(percentage) - parseInt(tabId1.getElementsByTagName("input")[n].value);
            else
                percentage = (parseInt(percentage) + parseInt(tabId1.getElementsByTagName("input")[n].value));
            if (parseInt(percentage) > 100) {
                alert("Amnesty Percentage," + percentage + ", greater than 0!. Plesase check again.");
                this.checked = false;
            }

        }
    }
    var td = document.createElement("td");
    td.appendChild(checkBox);
    tabrows[i + 1].cells[1].appendChild(td);
    }

    function getRowIndex(el) {
        while ((el = el.parentNode) && el.nodeName.toLowerCase() != 'tr');
        if (el) return el.rowIndex;
    } 
```

# c++ - 预处理器字符串化宏不起作用

> ID：12642873
> 
> 赞同：0
> 
> 时间：2012-09-28T15:23:57.703
> 
> 标签：c++, c-preprocessor

我在让这个 COMPARE 宏工作时遇到问题。关于如何解决的任何想法？

它有点像人造样本——我想让它尽可能小。

```
#include <iostream>
#include <string.h>

enum rqtypes {Unknown, Monitor, Query, Snapshot };

class base {
public:
   base() : type(Unknown) {}
   rqtypes type;
};

class CBMonitorDeviceRequest : public base
{
public:
   CBMonitorDeviceRequest() : dn(0) {}
   char* dn;
};

//I want the equivalent of:
//        case MonitorDeviceRequestID:
//           CBMonitorDeviceRequest* pthis = static_cast<CBMonitorDeviceRequest*>(thisrq);
//           if(pthis && strcmp(pthis->dn1, "1234") == 0)
//              return 0;
//           else
//              return -1;
//           break;

int main(int argc, char* argv[])
{
   CBMonitorDeviceRequest* ptr = new CBMonitorDeviceRequest;
   ptr->type = Monitor;
   ptr->dn = new char(strlen("1234") + 1);
   strcpy(ptr->dn, "1234");

#define COMPARE(id, thismsg) case id##ID: { \
   CB##id * pthis = static_cast<CB##id *>(thismsg); \
   if(pthis && strcmp(pthis->dn, "1234") == 0) \
      std::cout << "found"; \
   else \
      std::cout << "not found"; \
     break;  } \

   switch(ptr->type){
      COMPARE(Monitor, ptr);
   }

#undef COMPARE

    return 0;
} 
```

我得到例如：

```
(46) : error C2065: 'MonitorID' : undeclared identifier
(46) : error C2051: case expression not constant
(46) : error C2065: 'CBMonitor' : undeclared identifier
(46) : error C2065: 'pthis' : undeclared identifier
(46) : error C2061: syntax error : identifier 'CBMonitor'
(46) : error C2065: 'pthis' : undeclared identifier
(46) : error C2065: 'pthis' : undeclared identifier
(46) : error C2227: left of '->dn' must point to class/struct/union/generic type 
```

使用 gcc -EI get: # 30 "macro_fun2.cpp" int main(int argc, char* argv[]) { CBMonitorDeviceRequest* ptr = new CBMonitorDeviceRequest; ptr->type = 监视器；ptr->dn = new char(strlen("1234") + 1); strcpy（ptr->dn，“1234”）；# 45 "macro_fun2.cpp" switch(ptr->type){ case MonitorID: { CBMonitor * pthis = static_cast(ptr); if(pthis && strcmp(pthis->dn, "1234") == 0) Monitor = Query; 否则监视器=快照；休息; }; }

返回0；}

```
*** By the way I changed code to to avoid the massive printing of iostream by preprocessor - otherwise -E printing would have been huge.

#define COMPARE(id, thismsg) case id##ID: { \
   CB##id * pthis = static_cast<CB##id *>(thismsg); \
   if(pthis && strcmp(pthis->dn, "1234") == 0) \
      id = Query; \
   else \
      id =  Snapshot; \
     break;  } \ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:27:04.367

我想你想要`CB##id`，不是`CBid##`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T15:34:07.917

`id##ID`将扩展为`MonitorID`未定义的 。您要么想在 的定义中重命名`Monitor`为，要么将其更改为。`MonitorID``rqtypes``id`

`CB##id`将扩展为`CBMonitor`，也未定义。您要么想重命名`class CBMonitorDeviceRequest`为`class CBMonitor`，要么将其更改为`CB##id##DeviceRequest`。

除此之外，我看不到任何明显的问题。当然，除了内存泄漏。你为什么不使用`std::string`你的字符串？

# workflow-foundation-4 - 带有 net.tcp 接收活动的 msmq 前面的工作流

> ID：12642875
> 
> 赞同：0
> 
> 时间：2012-09-28T15:24:07.923
> 
> 标签：workflow-foundation-4

我有一个由 msmq 消息启动的工作流，它进行一些处理，然后调用初始化关联并等待接收活动。所以工作流已经有一个 msmq 端点，是否可以添加一个 net.tcp 端点，允许客户端与接收活动相关联？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:56:04.080

不，您将无法做到这一点，因为服务作为一个整体是通过特定协议公开的，而不仅仅是一个操作，就像任何其他标准 SOAP 服务一样。

但是，您可以做的是让基于 MSMQ 的工作流启动另一个具有 的工作流服务，`Receive`正确初始化相关性，然后与另一个`Receive`等待另一个使用者一起返回睡眠状态。

此外，我相信无论如何这是一种更好的方法，因为 MSMQ 服务只是用作协调器然后开始工作。

# wcf - 防止 WCF 编码字符串作为响应？

> ID：12642877
> 
> 赞同：1
> 
> 时间：2012-09-28T15:24:13.133
> 
> 标签：wcf, html-encode

是否可以覆盖 WCF 中的设置以防止响应字符串中的 HTML 编码字符？

我有一个由第三方工具通过 SOAP 调用调用的简单服务。响应对象有一个由包含 XML 的字符串组成的属性。当 WCF 打包响应时，它变为：

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<HttpPostResponse xmlns="http://ws.lenderprise.com">
  <HttpPostResult>
    &lt;STAT xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; &gt;
      &lt;RESPONSE Attr1=&quot;1&quot; 
             Attr2=&quot;ABC&quot; 
      &lt;/RESPONSE&gt;
    &lt;/STAT&gt;
  </HttpPostResult>
</HttpPostResponse> 
```

是否可以不对包含的字符串进行编码？

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<HttpPostResponse xmlns="http://ws.lenderprise.com">
  <HttpPostResult>
    <STAT xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" >
      <RESPONSE Attr1="1" 
             Attr2="ABC"> 
      </RESPONSE>
    </STAT>
  </HttpPostResult>
</HttpPostResponse> 
```

我知道这仍然让我无法确保处理任何嵌入的字符，这仍然意味着接收端的考虑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T16:07:21.483

如果要返回 XML 而不是字符串，则可以使用`XElement`或`XmlElement`作为返回类型。在这种情况下，它不会像字符串那样被编码。

# android - 保存并打开图片

> ID：12642882
> 
> 赞同：0
> 
> 时间：2012-09-28T15:24:28.860
> 
> 标签：android, bitmap, filepath, android-sdcard

我制作了一个保存系统，在其中保存图片，然后关闭应用程序，然后找到文件夹。我想打开图片，但是图片打开很慢。当我重置电话三星银河 w 时，这张图片打开得非常快（1 秒）。我的代码有什么问题？

```
private String mImagePath = Environment.getExternalStorageDirectory() + "/anppp";
private File file;

public void save()  {

    File dirPath = new File(Environment.getExternalStorageDirectory().toString() + "/anppp");
    dirPath.mkdirs();
    Calendar currentDate = Calendar.getInstance();
    SimpleDateFormat formatter= new SimpleDateFormat("yyyyMMMddHmmss");
    String dateNow = formatter.format(currentDate.getTime());
    file = new File(mImagePath + "/"+"ProPaint-" + dateNow +".jpg");
    FileOutputStream fos=null;

    try {

        if(!file.exists())
            file.createNewFile();

        fos = new FileOutputStream(file);
        mBitmap.compress(Bitmap.CompressFormat.JPEG, 100, fos);
        fos.close();

    } catch (FileNotFoundException e) {
        Log.e("Panel", "FileNotFoundException", e);
    } catch (IOException e) {
        Log.e("Panel", "IOEception", e);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T17:26:18.147

不知道这是否真的能解决您的问题，但您应该将`fos.close()`调用移至一个`finally`块以确保它执行。如果上面的某些行`fos.close()`抛出异常，下面的代码将被忽略，并且`FileOutputStream`将保持打开状态，给你带来各种麻烦。当它在`finally`块中时，无论情况如何，它都会执行。希望这可以帮助。

# android - 需要一个应用程序/应用程序来测量页面在 Android、iPhone 和 iPad 设备上的加载时间

> ID：12642885
> 
> 赞同：0
> 
> 时间：2012-09-28T15:24:40.793
> 
> 标签：android, iphone, client-side, performance-testing

我需要帮助识别可以安装在不同设备（iPAD、iPhone、Android）上的任何工具，并测量该设备上任何应用程序的页面加载时间/页面渲染时间。如果该工具为页面加载/渲染时间生成不同类型的图形/图表，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:41:50.347

谷歌分析[可以为您衡量这一点](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1205784)。这可能是您最好的选择，尤其是对于 iOS 设备。考虑`setSiteSpeedSampleRate()`将抽样率从浏览量的 1% 提高到 100% 以进行测试。

# c++ - C++ DWORD* 到 BYTE*

> ID：12642886
> 
> 赞同：0
> 
> 时间：2012-09-28T15:24:41.933
> 
> 标签：c++, optimization

我的问题，我正在尝试将 DWORD 类型的动态内存数组转换为 BYTE。很公平，我可以循环遍历这个并将 DWORD 转换为每个条目的 BYTE。

但他们是一种更快的方法吗？获取指向 DWORD 数据的指针并将整段数据转换为指向 BYTE 数据的指针？比如使用memcpy操作？

我觉得这是不可能的，我不是要求答案，只是对我的方法有经验的意见，因为我已经尝试过测试这两种方法，但似乎无法在我的第二个解决方案上找到解决方案。

感谢您的任何输入，再次没有答案，只是朝着正确的方向前进。这也不是一个家庭作业问题，我觉得必须提及。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T15:31:01.513

这实际上取决于您最终要达到的目标。如果你有，例如：

```
DWORD *x;
x = new DWORD[100];

// x gets filled in somehow 
```

而且您只想单独处理每个 DWORD 的每个字节，然后执行您建议的操作（即使用例如 memcpy）可能是一种选择。但是，您可以使用 reinterpret_cast 将数组作为 BYTE 数组处理，例如

```
BYTE *y = reinterpret_cast<BYTE *>(x); 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:28:52.217

如果您`static_cast<BYTE*>(array_ptr)`不关心字节顺序，则可以这样做可能会交换字节顺序（如果您使用的是小字节序），如果您确实关心字节顺序，则需要事先进行字节交换（有一个[x86 固有](http://msdn.microsoft.com/en-us/library/a3140177%28v=vs.80%29.aspx)的字节交换）。

如果您需要一个副本，那么只需分配足够的空间并`memcpy`使用 endian fixup 执行一个或一个复制循环。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T15:28:00.487

```
DWORD array[10];
BYTE* byteArray = array;
byteArray[0] .... 
```

像这样？

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-28T15:28:07.937

如果 DWORD 和 BYTE 长度相同，则可以。否则，不，您将需要单独调整每个元素的大小。

# ios - 使用 ABRecord 和 ARC 的潜在泄漏

> ID：12642892
> 
> 赞同：0
> 
> 时间：2012-09-28T15:25:02.763
> 
> 标签：ios, memory-leaks, ios6, clang-static-analyzer

我有这个代码：

```
- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker 
      shouldContinueAfterSelectingPerson:(ABRecordRef)personRecord
                                property:(ABPropertyID)property
                              identifier:(ABMultiValueIdentifier)identifier
{
    //TODO: release phoneNumberProperty when done
    ABMultiValueRef phoneNumberProperty = ABRecordCopyValue(personRecord, kABPersonPhoneProperty);
    int selectedPhNum = ABMultiValueGetIndexForIdentifier(phoneNumberProperty, identifier);//Turns identifier into index
    NSString *txtNum = (NSString *)CFBridgingRelease(ABMultiValueCopyValueAtIndex(phoneNumberProperty, selectedPhNum));
    //NSLog(@"Selected ph num = %@", txtNum);
    [[self toTextField] setText:txtNum];
    phoneNumberProperty = nil;
    [self dismissViewControllerAnimated:YES completion:NULL]; 
```

静态分析仪说有潜在的泄漏。我知道我需要释放 phoneNumberProperty 但如何？我正在使用 ARC，所以 [phoneNumberProperty release] 不起作用。将其设置为零，它仍然会抱怨。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:34:09.353

使用 CFRelease 函数释放您的 ABMultiValueRef 变量：

```
...
if (phoneNumberProperty)
    CFRelease(phoneNumberProperty); 
```

# timezone - 为什么第一个 Joda DateTime 实例获得非 UTC 年表？

> ID：12642897
> 
> 赞同：3
> 
> 时间：2012-09-28T15:25:24.180
> 
> 标签：timezone, equals, jodatime, utc

`date1`并且`date2`由于年表不同而在这里不相等：

```
val formatter = ISODateTimeFormat.dateTimeNoMillis
val date1 = formatter.parseDateTime("2012-01-03T00:00:00Z")
val date2 = new DateTime(2012, 1, 3, 0, 0, DateTimeZone.UTC)
println(date1.getChronology) // ISOChronology[Europe/Bucharest]
println(date2.getChronology) // ISOChronology[UTC]
assert(date1 === date2)      // fails 
```

在这里他们是平等的：

```
val formatter = ISODateTimeFormat.dateTimeNoMillis
val date1 = formatter.withZone(DateTimeZone.UTC).parseDateTime("2012-01-03T00:00:00Z")
val date2 = new DateTime(2012, 1, 3, 0, 0, DateTimeZone.UTC)
println(date1.getChronology) // ISOChronology[UTC]
println(date2.getChronology) // ISOChronology[UTC]
assert(date1 === date2)      // succeeds 
```

我知道`DateTime`实例应该具有相同的年表才能被视为平等，但我希望字符串中的 Z 指示符会使格式化程序`date1`在 UTC 年表中解析。我很确定我对 和 之间的区别感到困惑`Chronology`，`DateTimeZone`所以如果有人能指出我正在混淆的确切内容，我将不胜感激。

顺便说一句，代码在 Scala 中，断言来自 ScalaTest，但这不应该有任何区别。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T19:40:33.580

除非进一步配置，否则解析将在默认时区创建日期时间。考虑到“Z”，但随后会根据需要调整时间以匹配您的时区（布加勒斯特）。

```
val date1 = formatter.withOffsetParsed().parseDateTime("2012-01-03T00:00:00Z") 
```

添加`withOffsetParsed()`以获得您想要的行为。

# ironpython - WinForms UI 自动化：在 VisualUIAVerify 中找不到可见的 Ribon

> ID：12642902
> 
> 赞同：1
> 
> 时间：2012-09-28T15:25:33.380
> 
> 标签：ironpython, white-framework, microsoft-ui-automation

尝试了每个列出的选项，但在使用白色的窗格控件中找不到功能区。尽管 VisualUIAVerify 将其显示在树中。

```
"window" "Test 0.0.1" "MainForm"
  |--"pane" "Dock Top" "_MainForm_Toolbars_Dock_Area_Top"
    |--"" "Ribbon" ""
      |--"tab" "Ribbon Tabs" ""
        |--"tab item" "Tools" "" 
```

我想自动单击选项卡项“工具”。但只能找到一个“窗格”

```
import clr
import sys
sys.path.append(r"C:\TEMP\white")
clr.AddReference("White.Core")
clr.AddReference("White.NUnit")
from White.NUnit import *
from White import *
from White.Core import *
from White.Core.Configuration import *
from White.Core.UIItems import *
from White.Core.UIItems.WindowItems import *
from White.Core.UIItems.ListBoxItems import *
from White.Core.UIItems.Container import *
from White.Core.UIItems.Finders import *
from White.Core.Factory import *
from White.Core.Finder import *
from White.Core.AutomationElementSearch import *
from White.Core.WindowsAPI import *

from System.Diagnostics import Process
wp= Process();
wp.StartInfo.FileName = r"c:\TEMP\gui\TestShell.exe";
wp.StartInfo.Arguments = r"TestShell.taco -e DBA -s qa";        
wp.Start();
wapp = Application.Attach( wp );
wnds=Application.GetWindows(wapp)
wnd=wnds[0]

#test
>wnd.Name
"Test 0.0.1" 
```

我什至可以单击选项卡工具提供的坐标（IronPython）。

```
def click(cp,mouse,x,y):
    cp = wnd.Bounds.TopLeft;
    cp.Offset(x, y);
    mouse = Desktop.Instance.Mouse;
    mouse.Location = cp;
    mouse.Click(cp);

cp = wnd.Bounds.TopLeft;
mouse = Desktop.Instance.Mouse;
mouse.Location = cp;
mouse.Click(cp);
click(cp,mouse,120,50) #tools 
```

进入窗格：

```
pn=wnd.GetElement(SearchCriteria.ByAutomationId("_MainForm_Toolbars_Dock_Area_Top")); 
```

系找丝带

```
rbn=pn.GetElement(SearchCriteria.ByAutomationId("Ribbon")); 
```

或找到所有孩子

```
pn.FindAll(TreeScope.Children,  Condition.TrueCondition) 
```

似乎没有任何效果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:18:17.640

您看到的不一致可能是由于 UIA Verify 使用 UIA 库的本机 COM 版本，而 white 仍然使用旧的托管库。

以我的经验，本机库往往比旧的托管库更快、更稳定、更兼容，因此您应该考虑将代码转换为使用它（或者如果您感觉很慷慨，请[在 GitHub 上为 white](https://github.com/TestStack/White)贡献代码更新它）。

自从我自己完成迁移已经有一段时间了，所以我不记得具体细节了，但基本上你需要生成一个互操作 DLL，它允许你的 .NET 应用程序调用本机 UIA 方法。然后，您可以选择创建自己的包装库，或者可能使用下面提到的其中之一。

我建议参考这些以帮助进行过渡：

[UI 自动化 COM 到 .NET 适配器](http://uiacomwrapper.codeplex.com/)- 为 COM API 创建包装器的早期尝试。我在直接使用它时遇到了麻烦，但最初看一看很有帮助。还可以搜索一些 MSDN 支持论坛帖子，这些帖子是由这个包装器的开发人员制作的关于 COM API 的。不幸的是，由于我的 StackOverflow 代表（长期潜伏者，第一次回答者），我无法链接到他们。

[UIA 验证源代码](http://uiautomationverify.codeplex.com/SourceControl/changeset/view/94877)- 您可以看到他们的源代码中有一个 UIAComWrapper 用于访问 COM 接口。您还可以查看该项目，了解他们如何生成互操作 DLL。

# svn - svn co 不会在较早的版本中停止 HEAD

> ID：12642903
> 
> 赞同：0
> 
> 时间：2012-09-28T15:25:33.653
> 
> 标签：svn

我正在尝试检查我的 svn 存储库（ubuntu svn 服务器和 ubuntu 客户端）。

我为新结帐做了一个 svn co，它达到了修订版 11111，但 HEAD 修订版是 12145 在其他系统（Windows）上，我的 svn 浏览器看到所有修订版并将 12145 视为 HEAD

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T15:36:30.507

哈哈！问题解决了！

我已经从托管 svn repo 的计算机上复制了这台计算机。因此，当我尝试访问 repo 时，复制的 repo 仍在运行。

复制的 repo 的主要版本是在 2012 年 8 月 27 日创建的，实际上与服务器在 AWS 中创建的日期相匹配。

所以最后，SVN 被证明是在做它应该做的事情。

# c# - 看不出为什么这个简单的 if 语句返回 null？

> ID：12642906
> 
> 赞同：1
> 
> 时间：2012-09-28T15:25:59.987
> 
> 标签：c#, string, if-statement, shorthand-if

或者如果 if 语句不返回 null - 为什么不能分配这个特定的属性。

例子：

```
String stringParam = "some string";

MyClass myclass = new MyClass();

myclass.MyProperty = MyMethod(out stringParam ) ? stringParam : String.Empty; 
```

在上述行之后直接命中断点 - 我评估 MyProperty - 它为空！？

我已经三次检查了 MyMethod 的返回，它是真的（返回类型是布尔值）。并且 stringParam 正在 MyMethod 中更新。

假设我刚才所说的在某种程度上是不准确或错误的 - MyProperty 至少应该等于 String.Empty。如果 MyMethod 为真，但我的字符串正在更新 - MyProperty 应该等于“某个字符串”。

为什么它是空的？

在 MyClass 声明中，没有关于访问修饰符的复杂性。这很简单：

```
public class MyClass()
{
public String MyProperty;
} 
```

注意：虽然我在命名等方面对代码进行了一些简化和修改——这段代码在语法上与我的代码相同。

**我试过的**

我为此改变了语法，令人惊讶的是（对我来说）它起作用了！？

```
if(MyMethod(out stringParam)) { myclass.MyProperty = stringParam; } 
```

在评估时，myclass.MyProperty 现在等于预期的更新的 stringParam。

我很想解释为什么。内联 if 语句在输出参数方面的行为是否不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T17:14:41.573

如果你可以改变`MyMethod`，试试这个：

```
public bool MyMethod(ref string parameter)
{
    // Do something with parameter here...
    return true;
} 
```

然后打电话

```
var stringParam = "some string";
var myClass = new MyClass();

myClass.MyProperty = MyMethod(ref stringParam) ? stringParam : string.Empty; 
```

# html - 我需要查看 HTML 图像地图区域

> ID：12642912
> 
> 赞同：3
> 
> 时间：2012-09-28T15:26:23.960
> 
> 标签：html, map, styles, area

我试图在我的图像上设置一个地图区域，但我希望它是一个八边形，所以我真的需要看看我在画什么。

不幸的是，我无法设置区域标签的样式，以便我可以看到映射发生的位置。这让我很难画出这些区域，我每次都必须用鼠标跟随它才能知道它从哪里开始和在哪里结束。

有没有更好的办法 ？我发布这个带有矩形的示例只是为了简单起见，我只是想通过插件或任何东西来查看它。

```
<img src="img/myimg.png" usemap="#mapid" />
<map id="mapid" name="mapid">
<area id="myarea" shape="rect" coords="960, 0, 600, 500" href="#"/>
</map> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T16:04:08.123

我找到了一个在线图像地图编辑器，可以帮助您：

[http://www.maschek.hu/imagemap](http://www.maschek.hu/imagemap)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T16:06:17.670

绘制坐标的工具有很多，以下是我常用的四种。

1.  如果使用 MS Windows，MS Paint 会在状态栏显示坐标。
2.  使用在线工具，例如[http://www.image-maps.com/](http://www.image-maps.com/)
3.  使用编辑器，例如 Adob​​e Dreamweaver
4.  使用 FireBug ( [http://getfirebug.com/](http://getfirebug.com/) )

希望有帮助:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-22T10:23:51.653

> 我使用以下网站获取坐标
> 
> [http://imagemap-generator.dariodomi.de/](http://imagemap-generator.dariodomi.de/)

```
<map name="planetmap">

<area alt="facebook" coords="334,280,41" shape="circle" href="https://www.facebook.com/" target="_blank" />

<area alt="Twitter" coords="438,280,41" shape="circle" href="https://twitter.com/" target="_blank" />

<area alt="Gogle Plus" coords="541,280,39" shape="circle" href="https://plus.google.com/" target="_blank" />

<area alt="linkedin" coords="645,280,39" shape="circle" href="https://in.linkedin.com/" target="_blank" />

<area alt="youtube" coords="751,280,41" shape="circle" href="https://www.youtube.com/" target="_blank" />
</map> 
```

> 为了您更好，我将链接作为参考，您可以从那里找到什么是 HTML 图像映射以及我们如何使用它

[图片地图详情](http://developerstips.com/image-map-html/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-30T11:22:08.433

您可以将该区域包裹在一个跨度中并设置其样式以获取高度、宽度、背景和位置。

# wcf - 如何将 includeExceptionDetailInFaults 添加到由 scvutil 生成的 app.config

> ID：12642913
> 
> 赞同：1
> 
> 时间：2012-09-28T15:26:25.017
> 
> 标签：wcf

我有以下由 scvutil 生成的 app.config。我是 WCF 的新手，我一直在尝试调试和出错，并希望将 includeExceptionDetailInFaults=true 添加到此文件中，但没有得到任何结果。有人能告诉我要添加什么吗，我试过添加服务行为，但一直出错。

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
<system.serviceModel>
    <bindings>
        <basicHttpBinding>
            <binding name="BasicHttpBinding_IService1" closeTimeout="00:01:00"
                openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
                allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard"
                maxBufferSize="65536" maxBufferPoolSize="524288" maxReceivedMessageSize="65536"
                messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered"
                useDefaultWebProxy="true">
                <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                    maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                <security mode="None">
                    <transport clientCredentialType="None" proxyCredentialType="None"
                        realm="" />
                    <message clientCredentialType="UserName" algorithmSuite="Default" />
                </security>
            </binding>
        </basicHttpBinding>
    </bindings>
    <client>
        <endpoint address="http://localhost:8084/Service1.svc" binding="basicHttpBinding"
            bindingConfiguration="BasicHttpBinding_IService1" contract="IService1"
            name="BasicHttpBinding_IService1" />
    </client>
</system.serviceModel> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T16:09:56.880

`includeExceptionDetailInFaults`是一个**服务器**属性¹，它并不真正适用于客户端。如果要设置该属性，则需要更改服务器端，而不是客户端（或由`svcutil`.

* * *

¹该属性也可以在客户端上设置，但仅适用于*双工*合同，其中客户端充当服务。由于您使用`basicHttpBinding`的是 ，因此您的情况并非如此。

# php - str_replace 你能解释一下为什么会这样吗？

> ID：12642914
> 
> 赞同：1
> 
> 时间：2012-09-28T15:26:29.253
> 
> 标签：php

你能帮我理解这段代码吗？

```
 $turl = get_bloginfo('home');

  if ( $lang_current == "en" OR "ru" ) {
    $location = str_replace ($turl,$turl."/".$lang_current,$location);
  }

return $location; 
```

我不明白为什么，即使`$lang_current == "ka"`为什么我仍然激活 str_replace？

我希望此代码 str_replace 仅在语言为 en 或 ru 时才起作用，如果使用任何其他语言，我只需要它来返回 $location ...但这不是发生的事情！这让我发疯，因为我不明白。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T15:27:53.070

“ru”总是正确的......你需要把

```
 if ( $lang_current == "en" OR $lang_current == "ru" ) { 
```

或者：

```
 if ( in_array( $lang_current, array ( "en", "ru" ) ) ) { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T15:30:15.617

字符串 "ru" 将评估为 1 (true)，因为您没有将字符串与任何内容进行比较。本质上，您正在执行以下操作：

```
if ( ($lang_current == "en") OR ("ru") ) { 
```

您需要在 OR 操作数的两侧与 $lang_current 进行比较：

```
if ( $lang_current == "en" OR $lang_current == "ru" ) { 
```

# ios - 带有浮点缓冲区 AudioUnit 的 FFT 输出

> ID：12642916
> 
> 赞同：4
> 
> 时间：2012-09-28T15:26:37.267
> 
> 标签：ios, core-audio, audiounit, accelerate-framework

我对 vDSP_zrip 和 AudioUnit 的使用和配置有疑问。事实上，我将 AudioUnit 配置为将打包数据保存为浮点数。我创建了一个循环缓冲区，当这个缓冲区已满时，我计算一个 fft。我有结果，但我不明白为什么 fft 输出不好（参见图）

音频单元配置：

```
// describe format
AudioStreamBasicDescription audioFormat;
audioFormat.mSampleRate       = 44100;
audioFormat.mFormatID         = kAudioFormatLinearPCM;
audioFormat.mFormatFlags      = kAudioFormatFlagsNativeEndian|kAudioFormatFlagIsPacked|kAudioFormatFlagIsFloat|kAudioFormatFlagIsNonInterleaved;
audioFormat.mFramesPerPacket  = 1;
audioFormat.mChannelsPerFrame = 1; // mono
audioFormat.mBitsPerChannel   = sizeof(float) * 8;
audioFormat.mBytesPerFrame    = audioFormat.mChannelsPerFrame * sizeof(float);
audioFormat.mBytesPerPacket   = audioFormat.mFramesPerPacket * audioFormat.mBytesPerFrame; 
```

循环缓冲区：

```
_audioSample = new AudioSample(8192, 44100);
// in recording callback :
for(int i = 0; i < bufferList.mNumberBuffers; ++i)
{
    if(!status)
    {
        if(_sample->needData())
            _sample->put((float*)bufferList.mBuffers[i].mData,
                    bufferList.mBuffers[i].mDataByteSize);
        [...]
    }
} 
```

vDSP 调用：

```
 // get a split complex vector (real signal divided into an even-odd config
  vDSP_ctoz((COMPLEX *)sample.get(), 2, &_complex, 1, _fftsize);
  vDSP_fft_zrip(_fftsetup, &_complex, 1, _log2n, kFFTDirection_Forward);
  // scale (from vDSP reference)
  float scale = 1.0 / (2.0 * _samples);
  vDSP_vsmul(_complex.realp, 1, &scale, _complex.realp, 1, _fftsize);
  vDSP_vsmul(_complex.imagp, 1, &scale, _complex.imagp, 1, _fftsize);
  _complex.imagp[0] = 0.0; 
```

在哪里`_fftsize = _audioSample.capacity()/2`

![数字](../Images/ae1805c4e011dddeffb8765fb5228337.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T17:00:21.347

您的输出看起来很合理，因此我将您的问题解释为“如何清理这些结果？”

1）您可能正在使用矩形窗口

这意味着您没有进行任何[窗口化](http://en.wikipedia.org/wiki/Window_function)，这会在您的结果中引入一些噪音。vDSP 带有一些用于执行窗口化的函数，您可以像这样使用它们：

```
// N = number of samples in your buffer
int N = _audioSample.capacity();

// allocate space for a hamming window
float * hammingWindow = (float *) malloc(sizeof(float) * N);

// generate the window values and store them in the hamming window buffer
vDSP_hamm_window(hammingWindow, N, 0); 
```

然后，每当您要进行 FFT 时，首先对样本进行窗口化（如在调用 vDSP_ctoz 之前执行此操作）：

```
 vDSP_vmul(sample.get(), 1, hammingWindow, 1, sample.get(), 1, N); 
```

2）您可能希望对结果运行幅度函数

这将为您提供类似于您在标准 FFT 条形图音乐可视化工具中看到的结果。在 FFT*之后*执行此操作：

```
vDSP_zvmags(&_complex, 1, &_complex.realp, 1, _fftsize); 
```

之后，_complex.realp 将是一个浮点值数组，表示每个 FFT bin 的大小。

# shopify - 通过 api 添加产品时，所有可能的变量是什么？api 仅显示示例

> ID：12642917
> 
> 赞同：0
> 
> 时间：2012-09-28T15:26:37.007
> 
> 标签：shopify

通过 api 添加产品时，是否有人有所有可能变量的链接或示例。或者也许最好说接受的键=值对。

docs api 有这个和那个的弱例子，但没有明确的数组显示所有接受的参数。

[http://api.shopify.com/product.html#create](http://api.shopify.com/product.html#create)

这是我从 api 示例和反复试验*中*拼凑出来的。

```
$array = array(
        'id' => $item->store_id,
        'title' => $this->sanitize( $item->name ),
        'body_html' => $this->sanitize( $item->romance_copy ),
        'vendor' => $item->brand,
        'product_type' => $item->ware_desc, // may not be correct
        'tags' => $item->keyword,
        'images' => array(),
        'metafields' => array(),
        // http://wiki.shopify.com/Variant#variant.id
        'variants' => array( // Single variant is required for each product.
            array( 
                'id' => $item->store_id,
                'option1' => 'First',
                'price' => $item->price_msrp,
                // 'compare_at_price' => '',
                // 'available' => '',
                'inventory_quantity' => $item->inventory_quantity,
                // 'weight' => '',
                'sku' => $item->direct_sku,
                // 'requires_shipping' => '',
                // 'taxable' => '',
                ),
            )
        ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:11:04.557

进一步查看产品文档页面（例如[这个](http://api.shopify.com/product.html#show)）对 GET 调用的响应。那里返回的所有内容都可以编辑，除了`id`、`created_at`和`updated_at`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T18:27:22.070

他们的 wiki 上似乎有更多信息：

[http://wiki.shopify.com/Product_%28API%29](http://wiki.shopify.com/Product_%28API%29)
[http://wiki.shopify.com/Product](http://wiki.shopify.com/Product)
[http://wiki.shopify.com/Product_Variant_(API)](http://wiki.shopify.com/Product_Variant_(API))

编辑：
根据[大卫的回答](https://stackoverflow.com/a/12648799/22417)，您应该能够通过将所有内容包含在一个 JSON 对象中来在一个请求中发布所有产品详细信息。

# asp.net - 使用 GET 方法

> ID：12642923
> 
> 赞同：-2
> 
> 时间：2012-09-28T15:27:09.940
> 
> 标签：asp.net, webforms, get

我有一个带有一个表单（即向页面提交数据的元素）和几个 ASP 控件的页面。ASP 控件必须用`form`标记包装`runat="server"`，尽管它们与提交数据无关，而且无关`form`标记比无用更糟糕。这`form`必须包含所有控件，这意味着它还将包含执行有用工作的实际表单的标签。

这`form`有一个方法`get`和一个not-this-page 的动作，它们都不能很好地与ASP 配合使用。我尝试在 ASP 样板中嵌套正确的表单标签，但浏览器不会接受它，可能是因为它被规范明确禁止。这个表单的字段是通过Javascript生成的，所以不能变成ASP控件。

可以解决这个问题的事情：

*   每页有多个无用的 ASP 表单，因此它们的范围很窄。（ASP 禁止）
*   嵌套表单，使功能性表单仍然存在（HTML 禁止）
*   一种新的控件，可以代替空洞的 ASP `form`，而不会将无用的杂物倾倒到标记中。（这可能吗？）
*   从有用的表单中删除标签并在回发时手动检查 POST 数据，以确定应该作为 GET 提交的内容，然后重定向。在每个页面上都有一个有用的表格。
*   半自动执行上述操作的复杂系统，考虑到表单字段不是 ASP 控件，这可能是不切实际的。
*   完全放弃 ASP 控件。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T13:04:39.533

一个新的事件处理程序：

```
public void GetRequest(object sender, CommandEventArgs e)
{
    string url = string.IsNullOrEmpty(e.CommandArgument as string)
        ? Request.Url.AbsolutePath
        : (string)e.CommandArgument;

    var query = Request.Form.ToDictionary()
        .Where(kv => kv.Key.StartsWith(e.CommandName + "$"))
        .Select(kv => string.Format("{0}={1}",
            Server.UrlEncode(kv.Key.Substring(kv.Key.IndexOf("$") + 1)),
            Server.UrlEncode(kv.Value)));

    string destination = string.Format("http://{0}{1}{2}{3}",
        Request.Url.Authority,
        Page.ResolveUrl(url),
        query.Any() ? "?" : "",
        string.Join("&", query));

    Response.Redirect(destination);
} 
```

在 aspx 中：

```
<div class="form" id="filters-form">
    <div><input type="hidden" name="filters$OrderBy" value="<%= Orderings.ToSortString() %>" /></div>
    <fieldset id="filters"><!-- Will be filled in by javascript --></fieldset>
    <fieldset id="controls">
        <div>
            <button type="button" id="add-filter">New Filter</button>
            <asp:Button runat="server" Text="Apply Filters" OnCommand="GetRequest" CommandName="filters" />
        </div>
    </fieldset>
</div> 
```

# r - FPC 包：具有二项式/多项式分类变量的 Flexmixedruns

> ID：12642925
> 
> 赞同：2
> 
> 时间：2012-09-28T15:27:12.010
> 
> 标签：r

我正在使用包中的`flexmixedruns`函数，当我尝试运行该函数`fpc`时得到一个 。`flexmix error`

我的数据集既有连续数据又有分类数据，但我的大多数分类数据只有 2 个级别（`"Y"`或`"N"`）。我的一些变量有几个级别。我想知道我是否收到错误，因为该函数将我所有的分类变量都视为多项分布。

有没有人有使用此功能的经验？

### 可重现的例子

```
#####  check for fpc package
required.packages <- c("fpc")
new.packages <- 
  required.packages[!(required.packages %in% installed.packages()[,"Package"])] 
if(length(new.packages)) install.packages(new.packages)
rm(required.packages, new.packages)

library(fpc)

#####  create data set
df <- matrix(
  data=c("widget1", "widget2", "widget3", "widget4", "widget5", "widget6",
                    58, 18, 31, 130, 40, 31, 
                    70, 19, 44, 120, 57, 50,
                    "1E6", "1E5", "1E4", "1E6", "1E5", "1E4",
                    "Y", "Y", "N", "N", "N", "Y",
                    "N", "Y", "N", "Y", "N", "Y"), 
             nrow=6, ncol=6)

df <- as.data.frame(x=df)
row.names(df) <- df[, 1]
df <- df[, -1]
colnames(df) <- c("cont1", "cont2", "multi1", "bin1", "bin2")

df$cont1 <- as.numeric(df$cont1)
df$cont2 <- as.numeric(df$cont2)

#####  model
mdl <-
  flexmixedruns(x=df, xvarsorted=TRUE, continuous=2, discrete=3, simruns=5,
                n.cluster=3, recode=TRUE) 
```

### 错误信息

```
Error in summary(flexout[[optimalk]]) : 
    error in evaluating the argument 'object' in selecting a method for function 'summary': Error in flexout[[optimalk]] : attempt to select less than one element 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-10T01:46:54.533

如果没有更详细的调试，就无法确定。确保加载了方法包，即

```
library(methods) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-07T21:44:19.373

问题是数据格式。该函数最初似乎无法处理因子数据，尽管文档说它可以对可以转换为因子变量的分类数据进行任何处理。

```
df$multi1 = as.numeric(df$multi1)
df$bin1 = as.numeric(df$bin1)
df$bin2 = as.numeric(df$bin2)

mdl <-flexmixedruns(x=df, xvarsorted=TRUE, continuous=2, discrete=3, simruns=5,
                n.cluster=3, recode=TRUE)

summary(df)
     cont1       cont2         multi1       bin1          bin2    
 Min.   :1   Min.   :1.0   Min.   :1   Min.   :1.0   Min.   :1.0  
 1st Qu.:2   1st Qu.:2.0   1st Qu.:1   1st Qu.:1.0   1st Qu.:1.0  
 Median :3   Median :3.5   Median :2   Median :1.5   Median :1.5  
 Mean   :3   Mean   :3.5   Mean   :2   Mean   :1.5   Mean   :1.5  
 3rd Qu.:4   3rd Qu.:5.0   3rd Qu.:3   3rd Qu.:2.0   3rd Qu.:2.0  
 Max.   :5   Max.   :6.0   Max.   :3   Max.   :2.0   Max.   :2.0 

# k=  3  new best fit found in run  1 
# Nonoptimal or repeated fit found in run  2 
# k=  3  new best fit found in run  3 
# Nonoptimal or repeated fit found in run  4 
# Nonoptimal or repeated fit found in run  5 
# k=  3  BIC=  216462.2 
```

# python - 遍历元组以计算列表中的值

> ID：12642929
> 
> 赞同：1
> 
> 时间：2012-09-28T15:27:24.847
> 
> 标签：python, tuples

我有一本包含多个基因的字典。tuple(zip()) 给出每个位点的核苷酸。例如（A，A，A），（T，T，G）等。我正在尝试计算每个位点的核苷酸数量。这样站点 1 显示了 3 个 A，站点 2 显示了 2 个 T 和 1 G。当我运行我的代码时，它只添加到 A 而没有其他内容。

```
List = tuple(zip(*myDict.values()))

A = 0
T = 0
G = 0
C = 0

site = 0

for value in List:
    site +=1
    if 'A':
        A += 1
    elif 'T':
        T += 1
    elif 'G':
        G += 1
    else:
        C =+ 1

print 'Site:', site
print 'A:', A
print 'T:', T
print 'G:', G
print 'C:', C 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T15:31:13.243

您可以（再次）最好地使用`collections.Counter()`：

```
[Counter(site) for site in zip(*myDict.values())] 
```

这将创建每个站点的基因计数列表。

示范：

```
>>> from collections import Counter
>>> myDict = {'abc':'AGCTAC', 'def': 'AGGTAC', 'ghi':'AGGTAG'}
>>> result = [Counter(site) for site in zip(*myDict.values())]
>>> result
[Counter({'A': 3}), Counter({'G': 3}), Counter({'G': 2, 'C': 1}), Counter({'T': 3}), Counter({'A': 3}), Counter({'C': 2, 'G': 1})]
>>> result[0]  # genes at site 0
Counter({'A': 3})
>>> result[2]  # genes at site 2
Counter({'G': 2, 'C': 1}) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-28T15:29:58.007

使用`Counter()`：

```
>>> from collections import Counter
>>> lis=[('A', 'A', 'A'), ('T', 'T', 'G')]
>>> Counter(y for x in lis for y in x)
Counter({'A': 3, 'T': 2, 'G': 1}) 
```

或者，正如@Steven Rumbalski 建议的那样，使用`itertools.chain()`而不是生成器表达式：

```
>>> from itertools import chain
>>> Counter(chain(*lis))
Counter({'A': 3, 'T': 2, 'G': 1}) 
```

对于各个站点的单独柜台，请参见 Martijn Pieters 的[回答](https://stackoverflow.com/a/12642997/846892)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-09-28T15:30:19.633

ITEM

```
for value in List:
    site +=1
    if value == 'A':
        A += 1
    elif value == 'T':
        T += 1
    elif value == 'G':
        G += 1
    else:
        C +=1 
```

但是有更好的方法；查看其他答案。

此外，你不应该打电话给你的名单`List`；大写名称保留给类。`list`也不好，因为它隐藏了内置的`list()`.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-28T15:29:53.660

```
A = List.count("A")
B = List.count("C")
... 
```

顺便说一句，列表是一个可怕的变量名

# wxpython - 从列表框选择创建播放列表并使用 VLC 播放？

> ID：12642938
> 
> 赞同：0
> 
> 时间：2012-09-28T15:28:03.990
> 
> 标签：wxpython, vlc

在一个愚蠢的小问题上需要一些提示/帮助。

我在列表框中有一个文件列表。我想从列表中选择文件，将它们添加到播放列表中并使用 VLC 播放。但我不知道如何开始。

任何帮助将不胜感激。

问候，莫辛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T15:35:04.627

使用 Python 的 subprocess 模块并传递文件的名称以在命令行上播放：

[http://mailman.videolan.org/pipermail/vlc/2006-January/012703.html](http://mailman.videolan.org/pipermail/vlc/2006-January/012703.html)

该链接显示了如何处理电影，但我怀疑音乐的工作方式相同。

如果您使用的是 wxPython，则需要将其放入事件处理程序中：

```
import subprocess

subprocess.Popen("path/to/vla.exe mp3_1 mp3_2") 
```

如果你想创建一个播放列表，看起来 VLC 使用类似 XML 的格式：

[http://wiki.videolan.org/XSPF](http://wiki.videolan.org/XSPF)

我会使用 Python 的 XML 库来创建 XML。我更喜欢第 3 方[lxml](http://lxml.de/)之一。

# python - 与 memcached 和 django 的缓存混淆

> ID：12642941
> 
> 赞同：0
> 
> 时间：2012-09-28T15:28:11.027
> 
> 标签：python, django, memcached

我正在为我的 django 项目中的某些模型缓存一堆查询。似乎缓存本身正在工作，但是当我想通过添加新模型对象来进行测试时，我注意到在创建模型之后，查询列表已更新为包含新模型，这应该是不正确的，因为缓存超时设置为 1 unix 小时。

我们不是应该等1个小时才能看到新模型吗？这是代码：

```
def home(request, filterBy = 'all', sortBy = 'popularity'):
    if not cache.get('home' + filterBy + sortBy):
        models = Model.objects.with_rankings(filterBy, sortBy, request)
        cache.set('home' + filterBy + sortBy, models, 3600) # 1 hour
    else:
        models = cache.get('home' + filterBy + sortBy) 
```

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:55:09.973

请记住，`cache.get(key)`如果缓存中没有值，则返回 None 而不是 False 或其他任何值。而且您不是在检查它，您只是在检查返回值是否为真。Empty QuerySet 也是错误的，可能是您的情况。

它应该是（也是一个缓存少）：

```
def home(request, filterBy = 'all', sortBy = 'popularity'):
    models = cache.get('home' + filterBy + sortBy)
    if models is None:
        models = Model.objects.with_rankings(filterBy, sortBy, request)
        cache.set('home' + filterBy + sortBy, models, 3600) # 1 hour 
```

# ruby - 引用对象上的方法

> ID：12642946
> 
> 赞同：0
> 
> 时间：2012-09-28T15:28:33.617
> 
> 标签：ruby

我之前问过一个类似的问题：[引用方法？](https://stackoverflow.com/questions/11856978/reference-to-a-method)

但现在我想弄清楚如何用这段代码做到这一点：

```
arr0 = [1,2,3]
arr1 = [2,3,4,5]
arr1.reject! {|x|
    arr0.include? x
} 
```

显然`{|x| arr0.include? x}`可以简化为`arr0.include?`. 但我不知道如何获得这个方法参考。

编辑：我对如何使用更简单的语法在 Ruby 中减去数组不感兴趣。我正在寻找一种方法来获取对方法的引用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T16:22:02.803

```
arr1.reject!(&arr0.method(:include?)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T16:21:28.193

Ruby 中的每个对象都有一个`method`方法：

```
m = [1,2,3].method(:include?) #reference to the include? method of this array.
p m.call(1) #call the method with an argument ; => true 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T16:36:45.367

```
arr0 = [1,2,3]
arr1 = [2,3,4,5]

m = arr0.method(:include?)
arr1.reject!(&m) #=> [4, 5] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T15:33:11.550

你可以这样做

```
arr1 - arr0 
```

你不能用椒盐卷饼冒号来做到这一点，因为你有一个论点。

# ruby-on-rails - 使用acts_as_taggable_on 向大量对象添加N 个标签

> ID：12642950
> 
> 赞同：1
> 
> 时间：2012-09-28T15:28:46.610
> 
> 标签：ruby-on-rails, ruby, bulk, acts-as-taggable-on

我在 Rails (Ruby 1.9.3) 项目上使用acts_as_taggable_on gem。我向我的管理员提供了一个表单，以将 1..n 标记添加到资源列表（假设是客户端）。

我没有找到批量执行此操作的方法。现在我在每个客户端上循环并添加一个标签然后保存对象。当我在 X 千个客户端上尝试时，这对服务器造成了很大的伤害，最终造成了超时。

我想知道是否有办法将标签应用于 ActiveRecord 集合或其他东西。如果记录在案，我深​​表歉意，但我在任何地方都找不到这样做的人。

我可以通过自己执行自定义 SQL 查询来了解如何破解它，但我更愿意避免像这样破解 gem，ofc。

现在我正在做这样的事情

像这样的东西

```
# Client.selection returns a clients collection
Client.selection.each do |client|
  tags_to_add.each{|a| client.tag_list << a}
  tags_to_remove.each{|a| client.tag_list.remove(a)}
  client.save
end 
```

非常感谢您的时间。

额外：好吧，我也需要能够将 1..n 个标签删除到一个集合中！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T15:52:57.733

直接使用标记模型。可以使用以下内容（假设可标记对象属于同一类）

```
Tagging.transaction do
  client_ids.each do |cid|
    tag_ids.each do |tid|
      values = ["Client".inspect, cid, tid].join(", ")
      Tagging.connection.execute "INSERT INTO taggings (taggable_type, taggable_id, tag_id) VALUES (#{values}) ON DUPLICATE KEY UPDATE id=id"
    end
  end
end 
```

删除就简单多了

```
Taggings.where(:taggable_type => "Client", :taggable_id => client_ids, :tag_id => tag_ids).delete_all 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T09:52:19.337

受 Saverio answser 的启发，我终于用**add_tags**和**remove_tags**方法扩展了 ActiveRecord::Relation。

这是一个例子：

```
# Our ActiveRecord::Relation
clients = Client.where('created_at > ?', Time.now - 2.months)
# Our tags
tags_to_add = ['here','a','bunch','of','tags']
tags_to_remove = ['useless','now']
# Adding and removing tags
# (You can specify the tagging context as a second parameter) 
clients.add_tags(tags_to_add).remove_tags(tags_to_add, 'jobs') 
```

我为该补丁创建了一个[Github 存储库，希望对您有所帮助！](https://github.com/xumi/ActsAsTaggableOnActiveRecordRelation)

谢谢您的帮助！

# playframework - 对 play 框架中的模块进行小改动

> ID：12642953
> 
> 赞同：1
> 
> 时间：2012-09-28T15:28:59.037
> 
> 标签：playframework

我在谷歌应用引擎中使用securesocial模块。因为 html 电子邮件不起作用（只有文本电子邮件），所以我需要进行修复。解决方法是将 sendActivationEmail.html 替换为新文件 sendActivationEmail.txt。如果 html 文件完全存在，播放邮件程序将首先将其拾取。做这个的最好方式是什么？

我有一个方法，但它涉及使用我所有模块的本地副本。我用：

```
rm modules/* # remove module link files
play deps --forceCopy # copy external modules into ./modules/... 
```

然后我在我的应用程序的主目录中自定义本地版本。附带说明，我将 rm 命令放在配置脚本中，并且只签入 sendActivationEmail.txt。

这是最好的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T13:18:07.347

鉴于您需要一个模块的自定义版本，最好的办法是复制它并将其附加到应用程序的源代码（同时仍将其保留为模块），这样您就可以随意修改它。

如果需要，这将更容易添加进一步的更改。

# android - 通过我的 android 应用程序连接到 ftp 服务器

> ID：12642966
> 
> 赞同：1
> 
> 时间：2012-09-28T15:29:43.330
> 
> 标签：android, apache

我用谷歌搜索了很多，我找到了一些连接我的 ftp 服务器的方法：最好的方法是使用 apache 包。我正在使用此代码并从许多站点读取它，但不幸的是，此代码对我不起作用：

```
public class ApacheFTPClient extends Activity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        FTPClient mFTP = new FTPClient();
        try {
            // Connect to FTP Server
            mFTP.connect("192.168.1.110");
            mFTP.login("user", "password");
            mFTP.setFileType(FTP.BINARY_FILE_TYPE);
            mFTP.enterLocalPassiveMode();

            // Prepare file to be uploaded to FTP Server
            File file = new File("/path/to/filetotranfer");
            FileInputStream ifile = new FileInputStream(file);

            // Upload file to FTP Server
            mFTP.storeFile("filetotranfer",ifile);
            mFTP.disconnect();          
        } catch (SocketException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

但我得到以下错误：

```
09-28 18:48:12.018: E/AndroidRuntime(591): FATAL EXCEPTION: main
09-28 18:48:12.018: E/AndroidRuntime(591): android.os.NetworkOnMainThreadException
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1084)
09-28 18:48:12.018: E/AndroidRuntime(591):  at libcore.io.BlockGuardOs.connect(BlockGuardOs.java:74)
09-28 18:48:12.018: E/AndroidRuntime(591):  at libcore.io.IoBridge.connectErrno(IoBridge.java:127)
09-28 18:48:12.018: E/AndroidRuntime(591):  at libcore.io.IoBridge.connect(IoBridge.java:112)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:192)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.net.Socket.startupSocket(Socket.java:566)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.net.Socket.tryAllAddresses(Socket.java:127)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.net.Socket.<init>(Socket.java:177)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.net.Socket.<init>(Socket.java:149)
09-28 18:48:12.018: E/AndroidRuntime(591):  at org.jibble.simpleftp.SimpleFTP.connect(SimpleFTP.java:68)
09-28 18:48:12.018: E/AndroidRuntime(591):  at my.time.tick2.Main$8.onClick(Main.java:1585)
09-28 18:48:12.018: E/AndroidRuntime(591):  at com.android.internal.app.AlertController$AlertParams$3.onItemClick(AlertController.java:924)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.widget.AdapterView.performItemClick(AdapterView.java:292)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.widget.AbsListView.performItemClick(AbsListView.java:1058)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.widget.AbsListView$PerformClick.run(AbsListView.java:2514)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.widget.AbsListView$1.run(AbsListView.java:3168)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.os.Handler.handleCallback(Handler.java:605)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.os.Handler.dispatchMessage(Handler.java:92)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.os.Looper.loop(Looper.java:137)
09-28 18:48:12.018: E/AndroidRuntime(591):  at android.app.ActivityThread.main(ActivityThread.java:4340)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.lang.reflect.Method.invokeNative(Native Method)
09-28 18:48:12.018: E/AndroidRuntime(591):  at java.lang.reflect.Method.invoke(Method.java:511)
09-28 18:48:12.018: E/AndroidRuntime(591):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
09-28 18:48:12.018: E/AndroidRuntime(591):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
09-28 18:48:12.018: E/AndroidRuntime(591):  at dalvik.system.NativeStart.main(Native Method) 
```

问题是什么？我的 ftp 服务器运行良好，我可以从任何地方使用匿名或服务器中的任何用户名访问它。我的 ftp 服务器没问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-08T09:16:01.717

正如 njzk2 所说，我将代码放在 asynctasc 中，我的问题就解决了。谢谢大家

# sql - SQL 语句 - 按另一个表排序

> ID：12642969
> 
> 赞同：0
> 
> 时间：2012-09-28T15:29:48.293
> 
> 标签：sql, database, ms-access, asp-classic

我正在尝试构建一个 SQL 语句，它从一个表中提取记录，但按另一个表对它们进行排序。Main - 是我的主要产品表 MainCategory - 是产品的类别

每个产品都可以属于多个类别 - 所以在 Main 我有一个名为 CategoryIds 的字段，其中包含该产品所属的所有类别的 ID。（我现在知道这是错误的做法）

表格布局：

![在此处输入图像描述](../Images/5b698cd8407732bed8d41cbf161460fc.png)

所以基本上当我点击一个类别时，例如品牌，我希望能够对每个类别中的产品进行排序以按我想要的顺序显示 - 这就是我创建表 CatSort 的原因，我可以将 CategoryId 与 ProductId 一起放在那里DisOrder 是它们的显示方式。

所以在我的页面上的 SQL 语句：

```
Select * 
From Main  
Where CategoryIds = '11' OR 
      CategoryIds LIKE '11,%' OR 
      CategoryIds LIKE '%, 11,%' OR 
      CategoryIds LIKE '%, 11' 
```

提取类别“品牌”中的所有产品，但我如何扩展该 SQL 语句以按 CatSort 对它们进行排序，请记住，并非该类别中的所有记录都将在 CatSort 中（或者如果它们会更好？他们只有当他们实际将它们排序为他们喜欢的顺序时才会添加到 CatSort。但是如果将新产品添加到该类别，它不会自动添加到 CatSort。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T16:13:17.033

根本问题是，在查询 Main 时，由于 Main 中的一条记录可以有多个类别，因此排序顺序可能有多个值。

以下查询将起作用：

```
Select * 
From Main
     Left outer join CatSort on CatSort.ProdId = Main.Id
Where CategoryIds = '11' OR 
      CategoryIds LIKE '11,%' OR 
      CategoryIds LIKE '%, 11,%' OR 
      CategoryIds LIKE '%, 11' 
```

它会做它被要求做的事情，**但是**如果有多个排序顺序，那么主记录将出现在每个排序顺序位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-18T12:54:03.767

通过按照建议规范化类别和产品表之间的关系来解决

# mysql - 优化 SELECT {OTHER_COLUMNS} IN MAX....GROUP BY 语句

> ID：12642978
> 
> 赞同：1
> 
> 时间：2012-09-28T15:30:03.187
> 
> 标签：mysql, join, group-by, max, subquery

如果您发出这样的查询，我很熟悉 MySQL 遇到的问题：

```
SELECT `user_log`.`USER_NAME`, MAX(`user_log`.`ACCESS_DATE_TIME`), `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION`  
    FROM `user_log` 
    GROUP BY `user_log`.`USER_NAME` 
    ORDER BY `user_log`.`ACCESS_DATE_TIME` DESC 
```

这不会像您想的那样返回与 MAX ACCESS_DATE_TIME 关联的 COMPUTER_NAME 和 LOCATION。它将返回由您的 GROUP BY 列（所有 USER_NAME）定义的集合中的第一个值。

因此，为了解决这个问题，我正在尝试构建一个链接 MAX...GROUP BY sql 的查询，其中一个选择我需要的所有列，其中 USER_NAME 和 ACCESS_DATE_TIME 属于获取用户 MAX 的集合...GROUP 语句。

这就是我所拥有的->

```
SELECT `user_log`.`USER_NAME`, `user_log`.`ACCESS_DATE_TIME`, `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION` 
FROM `user_log`.`user_log` 
JOIN (SELECT `user_log`.`USER_NAME`, MAX(`user_log`.`ACCESS_DATE_TIME`) as sub_max 
    FROM `user_log` 
    GROUP BY `USER_NAME` 
    ORDER BY sub_max DESC) as sub
WHERE (`user_log`.`USER_NAME` = sub.`USER_NAME` AND `user_log`.`ACCESS_DATE_TIME` = sub.sub_max) 
```

但是，它不是很快......有没有更好的方法来做到这一点？我敢肯定，现在有人想出了一些东西……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:44:26.080

将性能与临时表进行比较（未经测试）：

```
CREATE TEMPORARY TABLE `user_log_temp` ENGINE=memory
SELECT `user_log`.`USER_NAME`, MAX(`user_log`.`ACCESS_DATE_TIME`) as sub_max 
FROM `user_log` 
GROUP BY `USER_NAME`;

SELECT `user_log`.`USER_NAME`, `user_log`.`ACCESS_DATE_TIME`, `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION` 
FROM `user_log`.`user_log` 
JOIN `user_log_temp` as sub 
  ON `user_log`.`USER_NAME` = sub.`USER_NAME`
  AND `user_log`.`ACCESS_DATE_TIME` = sub.sub_max;

DROP TABLE `user_log_temp`; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T16:52:34.570

这就是我最终实施的 ->

使用 MAX...GROUP BY 关系创建表 ->

```
CREATE TABLE `user_log_max`
   SELECT
     `USER_NAME`, 
      /* Alias this calculated value as ACCESS_DATE_TIME */
      MAX(`ACCESS_DATE_TIME`) AS `ACCESS_DATE_TIME` 
   FROM `user_log`
   GROUP BY `USER_NAME` 
```

获取所有数据 ->

```
SELECT DISTINCT `user_log`.`COMPUTER_NAME`, `user_log`.`LOCATION`, `user_log`.`USER_NAME`, `user_log`.`ACCESS_DATE_TIME` 
FROM `user_log`, `user_log_max`
WHERE `user_log_max`.`USER_NAME` = `user_log`.`USER_NAME` AND `user_log_max`.`ACCESS_DATE_TIME ` = `user_log`.`ACCESS_DATE_TIME` 
```

确保添加正确的索引，否则它仍然会很慢。

如果你愿意，你也可以在完成后放下桌子，因为随着时间的推移它不会是相关的 ->

```
DROP TABLE `user_log_max` 
```

# c - 在 C 中初始化结构时出错

> ID：12642979
> 
> 赞同：0
> 
> 时间：2012-09-28T15:30:03.313
> 
> 标签：c

尝试编译使用结构的 C 源文件时出现错误。我在 Ubuntu 12.04 LTS 上使用 gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3。

这是代码：

```
/* struct.c: Illustrates structures */
#include <stdio.h>
#include <string.h>

struct Hitter {
    char last[16];
    char first[11];
    int home_runs;
};

int main() {
    struct Hitter h1 = {"McGwire", "Mark", 70};
    struct Hitter h2;
    strcpy(h2.last, "Sosa");
    strcpy(h2.first, "Sammy");
    h2.home_runs = h1.home_runs - 4;
    printf("#1 == {%s, %s, %d}\n",
           h1.last, h1.first, h1.home_runs);
    printf("#2 == {%s, %s, %d}\n",
           h2.last, h2.first, h2.home_runs);
    return 0;
} 
```

这是错误：

```
$ gcc -o struct struct.c
struct.c: In function `main':
struct.c:12:9: error: parameter `h1' is initialized
struct.c:14:2: error: expected declaration specifiers before `strcpy'
struct.c:15:2: error: expected declaration specifiers before `strcpy'
struct.c:16:2: error: expected declaration specifiers before `h2'
struct.c:18:2: error: expected declaration specifiers before `printf'
struct.c:21:2: error: expected declaration specifiers before `printf'
struct.c:23:2: error: expected declaration specifiers before `return'
struct.c:24:1: error: expected declaration specifiers before `}' token
struct.c:13:16: error: declaration for parameter `h2' but no such parameter
struct.c:12:16: error: declaration for parameter `h1' but no such parameter
struct.c:24:1: error: expected `{' at end of input 
```

以上代码来自 Chuck Allison 的 CD 培训课程“Thinking in C”。我知道那是一张非常旧的 CD，而且我确信结构的语法一定已经改变，但我不知道它现在可能是什么。感谢您的帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:45:38.897

一旦我遇到了类似的情况，结果发现我试图编译的文件有不正确的行尾。例如，您从磁盘获取的文件可能以 CR + LF 作为行尾，而预期只有 LF。这可以通过在大多数文本编辑器中显示不可见字符的选项来发现。

# java - 使用 OAuth 令牌查看 Vimeo 私人视频

> ID：12642980
> 
> 赞同：60
> 
> 时间：2012-09-28T15:30:08.127
> 
> 标签：java, oauth, vimeo, http-status-code-401, scribe

任何人都可以使用 scribe 在 Vimeo API 中提供帮助吗？我的目标是访问私人视频（我上传的），而不必强制用户输入密码（这个过程应该在后台完成）。

根据我的理解/从研究中得出的结论是必要的：

1.  使用 oAuth 协议并通过以下链接请求应用程序授权：

    `https://vimeo.com/oauth/authorize?oauth_token=XXXX`

    该操作成功执行，响应数据被发送到回调 URL，类似于：

    `http://127.0.0.1:8001/XPTO.html?oauth_token=AUTH_TOKEN_EXAMPLE&oauth_verifier=VERIFIIER__EXAMPLE"`

2.  [根据 Brad Dougherty](http://vimeo.com/forums/api/topic:28279)（Vimeo API 员工）的说法，有可能做这样的事情

    > 如果您自己完成 OAuth 流程，则可以保存该令牌并使用它进行调用。

我正在使用这段代码：

```
service = new ServiceBuilder().provider(VimeoApi.class)
                .apiKey("API_KEY_EXAMPLE")
                .apiSecret("API_SECRET_EXAMPLE")
                .build();

OAuthRequest request = new OAuthRequest(Verb.GET,
        "http://vimeo.com/api/rest/v2?video_id=50305416");

request.addQuerystringParameter("format", "json");
request.addQuerystringParameter("method", "vimeo.videos.getInfo");

String oauth_verifier=VERIFIER__EXAMPLE;
Verifier verifier = new Verifier(oauth_verifier);

//I've tried differents combination to create this token
//I believe that my problem is HERE
//One unsuccessfully try: Token requestToken = service.getRequestToken();
Token requestToken = new Token(
        AUTH_TOKEN_EXAMPLE,
        API_SECRET_EXAMPLE);

Token token = service.getAccessToken(requestToken, verifier);

service.signRequest(token, request); 
Response response = request.send(); 
```

我有以下错误：

> 响应正文不正确。无法从中提取令牌和秘密：'401 Unauthorized - Invalid signature - 传递的 oauth_signature 无效。'

什么在逃避我？这是正确的做法，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-21T02:09:30.137

将视频保密的另一种方法是在*“隐私/设置”*中将选项“**仅限有密码的人**”更改为**“从 Vimeo.com 隐藏此视频”**和**“仅在我选择的网站上”**。

您可能会从中受益的原因是您可以控制可以嵌入视频的网站。如果您想要在您的网站上而不是其他地方显示您的视频，您甚至可以在您的应用程序中使用嵌入的普通 iframe 并跳过整个 API 调用。但是如果你仍然需要通过API进行调用，至少你没有密码问题。

这不会直接回答您的问题，而是解决问题的另一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-01T15:38:35.417

首先注意发布视频所需的权限，因此在尝试对它们进行身份验证之前。第二个想法是将所有内容存储在内存或本地存储中。您可以向其插入属性以直接启动视频

# c - WM_DEVMODECHANGE 的设备名称应该是窄的还是宽的？

> ID：12642984
> 
> 赞同：2
> 
> 时间：2012-09-28T15:30:16.627
> 
> 标签：c, winapi, unicode

我注意到 没有`A`/`W`变体`WM_DEVMODECHANGE`，但它在`LPARAM`. 我没有看到任何文档（我可以找到）说明这个字符串是窄的还是宽的。

有谁知道什么是适合的`LPARAM`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T16:17:00.120

`WM_DEVMODECHANGE`只是一个数字，而且只有其中一个。获得窄字符串还是宽字符串取决于窗口是否为 Unicode。这取决于您如何创建它，使用 CreateWindowExA 或 CreateWindowExW()。稍后您可以使用 IsWindowUnicode() 找到一些内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T09:23:14.037

从您的评论到汉斯的回答，您正在发送消息。此消息通常与 一起发送`SendMessageTimeout`。现在，`SendMessageTimeout`有两个版本，`SendMessageTimeoutW`和`SendMessageTimeoutA`。调用`SendMessageTimeoutW`时，必须提供 Unicode 文本，调用`SendMessageTimeoutA`时提供 ANSI 文本。

因此，数据类型的区分不是通过具有两个消息标识符来进行的，而是基于用于发送数据的函数。

`SendMessageW`使用/ `SendMessageA`、`PostMessageW`/等时完全相同`PostMessageA`。

如果您调用`SendMessageTimeoutW`, using `HWND_BROADCAST`then 您可以预期 ANSI 和 Unicode 窗口都会收到您的消息。消息传递系统确保将您发送的数据转换为接收消息的窗口的适当编码。

# java - 更改网络后如何解决“无法创建 PoolableConnectionFactory”异常？

> ID：12642986
> 
> 赞同：0
> 
> 时间：2012-09-28T15:30:16.710
> 
> 标签：java, mysql, struts2

我正在使用 struts 2 开发一个 web 应用程序，并且我正在使用 gradle 来完成该`tomcatRunWar`任务。

由于我下班将笔记本带回家，因此出现以下异常：

```
org.apache.tomcat.dbcp.dbcp.SQLNestedException: Cannot create 
PoolableConnectionFactory (Access denied for user 'vfsalesuser'@'192.168.2.110' 
(using password: YES)) 
```

MYSQL-Server 和 Web 应用程序都运行在同一台机器上。我没有更改任何应用程序代码或其配置。

我也试过

```
GRANT ALL PRIVILEGES ON *.* TO 'vfsalesuser'@'192.168.2.110';
FLUSH PRIVILEGES; 
```

还是不行。

有谁知道我该如何解决这个问题？

**更新：**当我禁用我的主界面时，它会一直工作，直到我再次启用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:37:15.840

家庭和工作中的 DHCP 服务器可能会为您提供不同的 IP/主机名地址，并且您在代码/配置中的某处硬编码了工作中收到的 IP 地址。Tomcat 可能会尝试在不存在的 IP 上打开套接字，因此会出现错误。

您可以尝试在配置中搜索 IP 地址或主机名，并将它们更改为 127.0.0.1/localhost，从而确保始终在本地计算机上打开套接字。

一些日志和配置在这里会有所帮助。

# windows-8 - 如果不是视觉树的一部分，Canvas 就没有父级？

> ID：12642990
> 
> 赞同：0
> 
> 时间：2012-09-28T15:30:34.193
> 
> 标签：windows-8, microsoft-metro, c++-cx

我正在为 Windows 8 Metro 编写应用程序，但在理解 Canvas 的子父关系如何工作时遇到了问题。似乎当我将一个画布添加到另一个画布的子画布时，子画布的 ->parent 属性等于 null ，直到将父画布添加到可视树中。下面是一些显示问题的示例代码。

```
Xaml::Controls::Canvas^ testCanvas = ref new Xaml::Controls::Canvas();
Xaml::Controls::Canvas^ childCanvas = ref new Xaml::Controls::Canvas();
testCanvas->Children->Append(childCanvas);

int size = testCanvas->Children->Size; // size will be equal to 1
if(!childCanvas->Parent)
{
// this code is executed because ->Parent is null. Why is parent here null??
}
aCanvasThatIsPartOfTheVisualTree->Children->Append(testCanvas);
if(!childCanvas->Parent)
{
// this code does not get executed because ->Parent is not null, now that testCanvas is part of the visual tree.
} 
```

我也尝试使用 VisualTreeHelper 来获取父级：

```
Xaml::Controls::Canvas^ theParent = (Xaml::Controls::Canvas^)VisualTreeHelper::GetParent(childCanvas); 
```

并且行为仍然存在：在将 testCanvas 添加到可视化树之前 theParent 为空，并且在将 testCanvas 添加到可视化树后不为空。

如果这不是一个错误，有人可以告诉我如何在父级不属于可视化树的情况下获取子画布的父级吗？如果是错误，是否有任何已知的解决方法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T15:38:44.407

如果您将其名称分开，`VisualTreeHelper`您将看到它是“Visual Tree”助手。这意味着它正在获取元素的视觉父级。如果它当前不是可视化树的一部分，那么它将没有由`VisualTreeHelper`.

从[这里](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.media.visualtreehelper.getparent.aspx)（上`VisualTreeHelper.GetParent`）：

> 在可视化树中返回对象的父对象。

从[这里](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.frameworkelement.parent.aspx)（`FrameworkElement.Parent`从哪些控件获取其`Parent`属性）：

> 如果对象已实例化，但未附加到最终连接到页面对象根的对象，则 Parent 可以为 null。在默认的 Windows 运行时类中，如果 FrameworkElement 的父类不为 null，则它也可以是 FrameworkElement 的子类。但是自定义类可能会引入一个内容模型，而这种假设不成立。

# css - 使用图标字体（Font Awesome）看起来有点模糊而且太粗

> ID：12642991
> 
> 赞同：24
> 
> 时间：2012-09-28T15:30:37.183
> 
> 标签：css, fonts, font-awesome

我正在使用 Font Awesome 在我的网站上创建图标，虽然它们在带有 Retina 显示屏的 iPod Touch 上看起来很棒，但在我的 iMac 上它们看起来有点模糊且不太明确。

这是一张图片来演示：

![在此处输入图像描述](../Images/9bd6b17f3077e1fc8e4089397ec1deb1.png)

如您所见，Retina Display iPod Touch 上的字体看起来非常漂亮和清晰，但在 iMac 上，它有点蹩脚。

这是什么原因造成的？这与**抗锯齿**有关吗？对此我能做些什么吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-30T20:01:01.307

像这样的问题可能与抗锯齿或暗示有关。如果字体希望在较小的尺寸下看起来不错，则需要在某种网格上对齐。GitHub 的人写了一篇很棒的[博客文章](https://github.com/blog/1135-the-making-of-octicons)，介绍了他们如何在自定义字体中管理清洁度。

我会尝试在网格上对齐它并跟随 GitHub 人的脚步。他们在图标上做得很好。

另外：iPod Touch 和 iMac 之间的图标数字大小是否不同，或者这是不同 DPI 设置的副作用？这也可能是字体渲染的一个问题。

如果可能，请尝试使用您的 DPI 设置。我不使用 Mac，所以我不知道如何在其中更改这些设置。不过，它仍然无法解决底层网格问题。你能编辑有问题的字体吗？

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-09-30T20:04:35.637

添加到@sporkbox 的答案中，如果您特别关心 Webkit 浏览器，可以选择使用以下 CSS 选项：

```
font-smooth: auto | never | always | <absolute-size> | length | initial | inherit
-webkit-font-smoothing : none | subpixel-antialiased | antialiased 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-23T14:25:33.823

我发现一些浏览器试图通过使线条变粗来模拟粗体字体，从而导致类似于您所描述的情况。你确定这出现在你拥有的地方`font-weight: normal;`吗？

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-29T15:12:15.067

最佳跨浏览器解决方案是：

```
.your_font_class{
  -moz-osx-font-smoothing: grayscale;
  -webkit-font-smoothing: antialiased;
  text-rendering: optimizeLegibility;
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-06-17T09:40:54.087

有一个奇怪的技巧有时会起作用，试试：

```
-webkit-transform:rotateZ(0);
-moz-transform:rotateZ(0);
-o-transform:rotateZ(0);
transform:rotateZ(0); 
```

如果您有一个块居中，请尝试检查左偏移量是否为整数。您可以使用 Javascript 来检查和修复它。如果你愿意，我可以帮助你。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-19T14:50:30.627

-webkit-透视：1000；

为我修好了

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-02-26T22:50:33.983

之前提到的一些解决方案有点/有点成功，但对我来说修复它的是删除（注释掉）font-awesome.css（和font-awesome.min.css）中“fa”类的字体大小继承：

```
font-size: inherit; 
```

该类的最终结果如下所示：

```
.fa {
  display: inline-block;
  font: normal normal normal 14px/1 FontAwesome;
  /* font-size: inherit; */
  text-rendering: auto;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
} 
```

除此之外，我不得不调整大图标，因为通过注释掉“fa-lg”类中的这一行，它们被推得太远了：

```
vertical-align:-15% 
```

这个类看起来像这样

```
.fa-lg {
  font-size: 1.33333333em;
  line-height: 0.75em;
  /* vertical-align: -15%; */
} 
```

我正在使用 Font Awesome 4.7.0

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-12-30T13:54:05.317

使用 css 字体平滑：

```
-webkit-font-smoothing: antialiased; 
```

# javascript - 在 jQuery 中定位包含跨度的问题

> ID：12642999
> 
> 赞同：0
> 
> 时间：2012-09-28T15:31:13.807
> 
> 标签：javascript, jquery, datatables

我遇到了一些奇怪的麻烦（我在数据表中），目标是包含页码的跨度。这是我正在运行的 html。

```
<span>
    <span class="target_me fg-button ui-button ui-state-default ui-state-disabled">1</span>
    <span class="target_me fg-button ui-button ui-state-default">2</span>
</span> 
```

但是当我将点击事件放在每个号码上并调用时

```
alert($(this).parent().html()) 
```

它呈现上面的整个代码，而不仅仅是初始跨度。这仅呈现页码“2”或“1”。

```
alert($(this).html()) 
```

有人知道为什么会这样吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T15:34:54.817

你得到的正是你所要求的。如果您只想要 的标签`this`，请尝试：

```
alert( $(this).wrap('<div>').parent().html() );
$(this).unwrap(); 
```

一种较短的技术涉及在 DOM 之外进行克隆：

```
alert( $('<div>').append($(this).clone()).html() ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T15:35:11.540

这是预期的行为。当您使用`$(this).parent().html()`它时，它会`span`在您的代码中获得第一个。（下面是大写的那个）

```
<SPAN>
    <span class="target_me fg-button ui-button ui-state-default ui-state-disabled">1</span>
    <span class="target_me fg-button ui-button ui-state-default">2</span>
</SPAN> 
```

它自然会打印其中的所有 HTML ..

当您调用`$(this).html()`它时，它会获取您单击的 SPAN。在这种情况下，您会根据单击的数字获得 1 或 2。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T15:38:29.523

我想你想要这个：

```
alert(this.outerHTML) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T15:34:20.567

```
alert($(this).parent().html()) 
```

这将转到`<span>`标签并警告其中的 HTML。

`$(this).html()`单击某个项目时，将在单个跨度内呈现 HTML，因此 1 和 2 符合预期。

你想达到什么目的？